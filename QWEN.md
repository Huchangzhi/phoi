# PH code(原名phoi) - 适合OI的在线C++编辑器

## 项目概述

PH code(原名phoi)是一个专为信息学竞赛（OI）设计的在线C++编辑器，支持在手机等移动设备上编写和运行C++代码。该项目使用Flask作为后端框架，结合HTML、CSS和JavaScript构建了一个功能丰富的在线代码编辑和调试环境。

项目的主要特点包括：
- 移动友好的代码编辑器，带虚拟键盘
- 代码高亮显示
- 与Rextester API集成，支持在线编译和执行C++代码
- 虚拟文件系统，支持文件管理和持久化存储
- 插件中心，支持代码补全、洛谷题库等功能扩展
- CPH插件，用于管理编程竞赛题目和测试用例

## 项目结构

```
E:\AI\phoi\
├── app.py          # Flask后端应用，使用Rextester API
├── app_local.py    # 本地执行版本（有安全风险，建议容器内部署）
├── static/         # 静态资源文件
│   ├── autocomplete.js   # 代码补全功能
│   ├── cph.js           # CPH插件功能
│   ├── luogu.js         # 洛谷题库功能
│   ├── script.js        # 主要前端JavaScript逻辑
│   ├── style.css        # 样式文件
│   ├── cph.png          # CPH插件图标
│   ├── debug.png        # 调试图标
│   ├── ext.png          # 扩展图标
│   ├── file.png         # 文件图标
│   ├── logo.png         # Logo图标
│   └── Luogu.png        # 洛谷图标
├── templates/      # HTML模板
│   ├── index.html  # 主页面
│   └── easyrun.html # 简易运行页面
├── image.png       # 项目图片
├── logo.png        # 项目Logo
├── README.md       # 项目说明
├── LICENSE         # 许可证
└── QWEN.md         # 项目上下文文件
```

## 核心功能

### 1. 代码编辑
- 支持全屏和3行预览两种编辑模式
- 语法高亮显示
- 虚拟键盘支持，适合移动设备使用
- 代码自动缩进和括号配对
- 行号显示
- Monaco Editor作为代码编辑器

### 2. 代码执行
- 通过Rextester API进行C++代码编译和执行
- 支持标准输入
- 结果在输出面板中显示
- 本地执行版本（app_local.py）支持资源限制（时间、内存）

### 3. 虚拟文件系统
- 基于浏览器本地存储的虚拟文件系统
- 支持文件的创建、编辑、删除和下载
- 文件持久化存储

### 4. 插件系统
- 代码补全插件（支持C++关键字和函数）
- 洛谷题库插件（查看洛谷主题库）
- CPH插件（编程竞赛助手，管理题目和测试用例）

### 5. 移动端适配
- 响应式设计，适配手机屏幕
- 虚拟键盘便于移动端输入
- 移动端专用的滚动按钮

## 技术栈

- **后端**: Python Flask
- **前端**: HTML5, CSS3, JavaScript
- **API**: Rextester在线编译服务
- **代码编辑器**: Monaco Editor
- **代码补全**: 自定义实现
- **虚拟文件系统**: 浏览器本地存储

## 构建和运行

### 依赖安装
```sh
pip install flask requests
```

### 运行方式
对于使用Rextester的版本：
```sh
python app.py
```

对于使用本地执行的版本（有安全风险，建议在容器内部署）：
```sh
python app_local.py
```

应用启动后，默认在 `http://0.0.0.0:5000` 端口监听，支持局域网内设备访问。

## 安全措施

- 黑名单过滤：禁止使用危险函数如`system()`、`exec()`、`fork()`等
- 禁止文件操作：阻止文件读写操作
- 本地执行版本：设置了时间和内存限制，防止恶意代码消耗过多资源

## 开发约定

- 代码风格：遵循JavaScript和Python的通用编码规范
- 本地存储：使用localStorage保存代码和设置
- 插件机制：模块化设计，便于功能扩展
- 错误处理：前端和后端都有适当的错误处理和用户提示

## 部署

项目可以部署在任何支持Python Flask的服务器上。对于生产环境，建议：
- 使用反向代理（如Nginx）
- 配置SSL证书
- 设置适当的防火墙规则
- 使用容器化部署（如Docker）以提高安全性
- 对于本地执行版本，特别注意安全风险，建议在隔离环境中运行