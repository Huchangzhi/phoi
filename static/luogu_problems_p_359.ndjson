{"pid": "P8275", "type": "P", "difficulty": 7, "samples": [["6\n1 3 1 2 1 10", "115"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "USACO", "2022", "区间 DP", "动态规划优化"], "title": "[USACO22OPEN] 262144 Revisited P", "background": "", "description": "Bessie 喜欢在她的手机上下载游戏玩，尽管她确实发现对于她的大蹄子来说使用小触摸屏相当麻烦。\n\n她对目前正在玩的游戏特别着迷。游戏从 $N$ 个 $1\\ldots 10^6$ 范围内的正整数组成的序列 $a_1,a_2,\\ldots,a_N$（$2\\le N\\le 262,144$）开始。在一次行动中，Bessie 可以取两个相邻的数字并将它们替换为一个大于两数最大值的数字（例如，她可以将相邻的一对数 $(5,7)$ 替换为 $8$）。游戏在 $N-1$ 次行动后结束，此时只剩下一个数字。游戏目标是**最小化**这个最终的数字。\n\nBessie 知道这个游戏对你来说太容易了。所以你的任务不仅仅是在 $a$ 上以最优方式玩游戏，而是在 $a$ 的每个连续子段上玩游戏。\n\n输出 $a$ 的所有 $\\frac{N(N+1)}{2}$ 个连续子段的最小最终数字之和。", "inputFormat": "输入的第一行包含 $N$。\n\n第二行包含 $N$ 个空格分隔的整数，表示输入的序列。", "outputFormat": "输出一行，包含所求的和。", "hint": "共有 $\\frac{6\\cdot 7}{2}=21$ 个连续子段。例如，连续子段 $[1,3,1,2,1]$ 的最小可能的最终数字是 $5$，可以通过以下操作序列达到：\n```\n初始     -> [1,3,1,2,1]\n合并 1&3 -> [4,1,2,1]\n合并 2&1 -> [4,1,3]\n合并 1&3 -> [4,4]\n合并 4&4 -> [5]\n```\n\n以下是每个连续子段的最小可能的最终数字：\n\n```\nfinal(1:1) = 1\nfinal(1:2) = 4\nfinal(1:3) = 5\nfinal(1:4) = 5\nfinal(1:5) = 5\nfinal(1:6) = 11\nfinal(2:2) = 3\nfinal(2:3) = 4\nfinal(2:4) = 4\nfinal(2:5) = 5\nfinal(2:6) = 11\nfinal(3:3) = 1\nfinal(3:4) = 3\nfinal(3:5) = 4\nfinal(3:6) = 11\nfinal(4:4) = 2\nfinal(4:5) = 3\nfinal(4:6) = 11\nfinal(5:5) = 1\nfinal(5:6) = 11\nfinal(6:6) = 10\n```\n\n【测试点性质】\n\n- 测试点 2-3 满足 $N\\le 300$。\n- 测试点 4-5 满足 $N\\le 3000$。\n- 测试点 6-8 中，输入的序列中所有数的值不超过 $40$。\n- 测试点 9-11 中，输入的序列是不下降的。\n- 测试点 12-23 没有额外限制。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO22OPEN] 262144 Revisited P", "background": "", "description": "Bessie 喜欢在她的手机上下载游戏玩，尽管她确实发现对于她的大蹄子来说使用小触摸屏相当麻烦。\n\n她对目前正在玩的游戏特别着迷。游戏从 $N$ 个 $1\\ldots 10^6$ 范围内的正整数组成的序列 $a_1,a_2,\\ldots,a_N$（$2\\le N\\le 262,144$）开始。在一次行动中，Bessie 可以取两个相邻的数字并将它们替换为一个大于两数最大值的数字（例如，她可以将相邻的一对数 $(5,7)$ 替换为 $8$）。游戏在 $N-1$ 次行动后结束，此时只剩下一个数字。游戏目标是**最小化**这个最终的数字。\n\nBessie 知道这个游戏对你来说太容易了。所以你的任务不仅仅是在 $a$ 上以最优方式玩游戏，而是在 $a$ 的每个连续子段上玩游戏。\n\n输出 $a$ 的所有 $\\frac{N(N+1)}{2}$ 个连续子段的最小最终数字之和。", "inputFormat": "输入的第一行包含 $N$。\n\n第二行包含 $N$ 个空格分隔的整数，表示输入的序列。", "outputFormat": "输出一行，包含所求的和。", "hint": "共有 $\\frac{6\\cdot 7}{2}=21$ 个连续子段。例如，连续子段 $[1,3,1,2,1]$ 的最小可能的最终数字是 $5$，可以通过以下操作序列达到：\n```\n初始     -> [1,3,1,2,1]\n合并 1&3 -> [4,1,2,1]\n合并 2&1 -> [4,1,3]\n合并 1&3 -> [4,4]\n合并 4&4 -> [5]\n```\n\n以下是每个连续子段的最小可能的最终数字：\n\n```\nfinal(1:1) = 1\nfinal(1:2) = 4\nfinal(1:3) = 5\nfinal(1:4) = 5\nfinal(1:5) = 5\nfinal(1:6) = 11\nfinal(2:2) = 3\nfinal(2:3) = 4\nfinal(2:4) = 4\nfinal(2:5) = 5\nfinal(2:6) = 11\nfinal(3:3) = 1\nfinal(3:4) = 3\nfinal(3:5) = 4\nfinal(3:6) = 11\nfinal(4:4) = 2\nfinal(4:5) = 3\nfinal(4:6) = 11\nfinal(5:5) = 1\nfinal(5:6) = 11\nfinal(6:6) = 10\n```\n\n【测试点性质】\n\n- 测试点 2-3 满足 $N\\le 300$。\n- 测试点 4-5 满足 $N\\le 3000$。\n- 测试点 6-8 中，输入的序列中所有数的值不超过 $40$。\n- 测试点 9-11 中，输入的序列是不下降的。\n- 测试点 12-23 没有额外限制。\n", "locale": "zh-CN"}}}
{"pid": "P8276", "type": "P", "difficulty": 7, "samples": [["9 10\n1 2\n2 3\n3 4\n4 7\n3 5\n1 6\n6 8\n8 9\n9 6\n7 2\n4\n1 5\n1 2\n1 6\n2 4", "BHHB"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["USACO", "2022", "拓扑排序", "启发式合并"], "title": "[USACO22OPEN] Hoof and Brain P", "background": "", "description": "给定一个包含 $N$ 个结点和 $M$ 条边的有向图（$2 \\leq N \\leq 10^5$, $1 \\leq M \\leq 2 \\cdot 10^5$），Farmer John 的奶牛们喜欢玩以下的双人游戏。\n\n在图中的不同结点上放置两个指示物（可以用一些与奶牛相关的物品代替指示物）。每一回合，一名玩家，脑，选择一个需要沿某一条出边移动的指示物。另一名玩家，蹄，选择沿着哪条出边移动该指示物。两个指示物在任何时刻不允许处于同一个结点上。如果在某些时刻蹄不能做出合法的行动，则脑获胜。如果游戏可以无限进行下去，则蹄获胜。\n\n给定 $Q$ 个询问（$1 \\leq Q \\leq 10^5$），包含两个指示物所在的初始结点。对于每个询问，输出哪名玩家获胜。", "inputFormat": "输入的第一行包含 $N$ 和 $M$。\n\n以下 $M$ 行每行包含两个整数 $a$ 和 $b$，表示一条从 $a$ 连向 $b$ 的边。\n\n图中不包含自环或重边。\n\n下一行包含 $Q$。\n\n最后 $Q$ 行每行包含两个整数 $x$ 和 $y$，满足 $1\\le x,y\\le N$ 以及 $x\\neq y$，表示指示物所在的初始结点。\n", "outputFormat": "输出一个长为 $Q$ 的字符串，其中字符 B 表示脑获胜，H 表示蹄获胜。\n\n**注意：本题的时间限制为 4 秒，通常限制的两倍。**", "hint": "【数据范围】\n\n脑可以通过选择结点 $5$ 赢得第一局游戏；此时蹄将没有合法的行动。\n\n脑可以通过选择结点 $4$ 然后选择结点 $7$ 赢得最后一局游戏；此时蹄没有合法的行动。\n\n蹄赢得其他局游戏。\n\n【测试点性质】\n\n- 测试点 2-3 满足 $N\\le 100$，$M\\le 200$。\n- 测试点 4-9 满足 $N\\le 5000$。\n- 测试点 10-21 没有额外限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO22OPEN] Hoof and Brain P", "background": "", "description": "给定一个包含 $N$ 个结点和 $M$ 条边的有向图（$2 \\leq N \\leq 10^5$, $1 \\leq M \\leq 2 \\cdot 10^5$），Farmer John 的奶牛们喜欢玩以下的双人游戏。\n\n在图中的不同结点上放置两个指示物（可以用一些与奶牛相关的物品代替指示物）。每一回合，一名玩家，脑，选择一个需要沿某一条出边移动的指示物。另一名玩家，蹄，选择沿着哪条出边移动该指示物。两个指示物在任何时刻不允许处于同一个结点上。如果在某些时刻蹄不能做出合法的行动，则脑获胜。如果游戏可以无限进行下去，则蹄获胜。\n\n给定 $Q$ 个询问（$1 \\leq Q \\leq 10^5$），包含两个指示物所在的初始结点。对于每个询问，输出哪名玩家获胜。", "inputFormat": "输入的第一行包含 $N$ 和 $M$。\n\n以下 $M$ 行每行包含两个整数 $a$ 和 $b$，表示一条从 $a$ 连向 $b$ 的边。\n\n图中不包含自环或重边。\n\n下一行包含 $Q$。\n\n最后 $Q$ 行每行包含两个整数 $x$ 和 $y$，满足 $1\\le x,y\\le N$ 以及 $x\\neq y$，表示指示物所在的初始结点。\n", "outputFormat": "输出一个长为 $Q$ 的字符串，其中字符 B 表示脑获胜，H 表示蹄获胜。\n\n**注意：本题的时间限制为 4 秒，通常限制的两倍。**", "hint": "【数据范围】\n\n脑可以通过选择结点 $5$ 赢得第一局游戏；此时蹄将没有合法的行动。\n\n脑可以通过选择结点 $4$ 然后选择结点 $7$ 赢得最后一局游戏；此时蹄没有合法的行动。\n\n蹄赢得其他局游戏。\n\n【测试点性质】\n\n- 测试点 2-3 满足 $N\\le 100$，$M\\le 200$。\n- 测试点 4-9 满足 $N\\le 5000$。\n- 测试点 10-21 没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P8277", "type": "P", "difficulty": 6, "samples": [["5\n1 5 3 4 2\nUDUD", "4"], ["5\n1 5 3 4 2\nUUDD", "3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "USACO", "树状数组", "2022", "动态规划优化"], "title": "[USACO22OPEN] Up Down Subsequence P", "background": "", "description": "Farmer John 的 $N$ 头奶牛（$2 \\leq N \\leq 3\\cdot 10^5$），编号为 $1 \\ldots N$，排列成 $1\\ldots N$ 的一个排列 $p_1,p_2,\\ldots,p_N$。另外给定一个长为 $N-1$ 的字符串，由字母 U 和 D 组成。请求出最大的 $K\\le N-1$，使得存在 $p$ 的一个子序列 $a_0,a_1,\\ldots,a_{K}$，满足对于所有 $1\\le j\\le K$，当字符串中第 $j$ 个字母是 U 时 $a_{j - 1} < a_j$，当字符串中的第 $j$ 个字母是 D 时 $a_{j - 1} > a_j$。\n", "inputFormat": "输入的第一行包含 $N$。\n\n第二行包含 $p_1,p_2,\\ldots,p_N$。\n\n最后一行包含给定的字符串。", "outputFormat": "输出 $K$ 的最大可能值。", "hint": "【样例解释 1】\n\n我们可以选择 $[a_0,a_1,a_2,a_3,a_4]=[p_1,p_2,p_3,p_4,p_5]$；整个排列与给定的字符串相一致。\n\n【样例解释 2】\n\n我们可以选择 $[a_0,a_1,a_2,a_3]=[p_1,p_3,p_4,p_5]$。\n\n【测试点性质】\n\n- 测试点 3-4 满足 $N\\le 500$。\n- 测试点 5-8 满足 $N\\le 5000$。\n- 测试点 9-12 中，字符串中的 U 均在 D 之前。\n- 测试点 13-22 没有额外限制。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO22OPEN] Up Down Subsequence P", "background": "", "description": "Farmer John 的 $N$ 头奶牛（$2 \\leq N \\leq 3\\cdot 10^5$），编号为 $1 \\ldots N$，排列成 $1\\ldots N$ 的一个排列 $p_1,p_2,\\ldots,p_N$。另外给定一个长为 $N-1$ 的字符串，由字母 U 和 D 组成。请求出最大的 $K\\le N-1$，使得存在 $p$ 的一个子序列 $a_0,a_1,\\ldots,a_{K}$，满足对于所有 $1\\le j\\le K$，当字符串中第 $j$ 个字母是 U 时 $a_{j - 1} < a_j$，当字符串中的第 $j$ 个字母是 D 时 $a_{j - 1} > a_j$。\n", "inputFormat": "输入的第一行包含 $N$。\n\n第二行包含 $p_1,p_2,\\ldots,p_N$。\n\n最后一行包含给定的字符串。", "outputFormat": "输出 $K$ 的最大可能值。", "hint": "【样例解释 1】\n\n我们可以选择 $[a_0,a_1,a_2,a_3,a_4]=[p_1,p_2,p_3,p_4,p_5]$；整个排列与给定的字符串相一致。\n\n【样例解释 2】\n\n我们可以选择 $[a_0,a_1,a_2,a_3]=[p_1,p_3,p_4,p_5]$。\n\n【测试点性质】\n\n- 测试点 3-4 满足 $N\\le 500$。\n- 测试点 5-8 满足 $N\\le 5000$。\n- 测试点 9-12 中，字符串中的 U 均在 D 之前。\n- 测试点 13-22 没有额外限制。\n", "locale": "zh-CN"}}}
{"pid": "P8278", "type": "P", "difficulty": 2, "samples": [["2\n5\n10 -1 20 -1 30\n6\n-1 -1 -1 -1 -1 -1", "10 5 5 5 5\n1 1 4 5 1 4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144]}, "tags": ["洛谷原创", "Special Judge", "O2优化", "前缀和", "洛谷月赛"], "title": "「MCOI-08」Fill In", "background": "$$\\begin{aligned}\\text{sdjvlajdiofjoiw{\\color{1f1e33}n}eglaj}\\\\\\text{pcji{\\color{1f1e33}2}gweiruitowoeuri}\\\\\\text{cnvak{\\color{1f1e33}5}jflkjweirqoiru}\\\\\\text{rrrwei{\\color{1f1e33}f}dlskfjqfafdfaff}\\\\\\text{nmslfjwiejfijlxkjfq{\\color{1f1e33}b}el}\\\\\\text{mmm{\\color{1f1e33}b}fsfmkdfmksld}\\\\\\text{erjf{\\color{1f1e33}n}kerjkwerjkwjeri}\\\\\\text{sdfafafaf{\\color{1f1e33}r}fxvzxvzvzx}\\end{aligned}$$", "description": "Dream 有一个长度为 $n$（$1\\le n\\le 10^5$）的正整数数组 $a_1,a_2,\\dots,a_n$，其中对于 $i=1,2,\\dots,n$，满足 $1\\le a_i\\le 1000$。\n\n他计算了前缀和数组 $p_i=a_1+a_2+\\dots+a_i$，保证对于 **原前缀和数组** 有任意 $1 \\le i <n$ 都有 $p_i<p_{i+1}$。\n\n现在 Tommy 偷走了这个数组以及将 $p$ 的若干个元素替代为 $-1$。给定当前的 $p$ 数组，请恢复任意一组合法 $a_1,a_2,\\dots,a_n$，可证明一定存在一个数组 $a_i$ 满足要求。", "inputFormat": "本题有多组数据，第一行一个正整数 $t$，为数据组数。接下来 $t$ 组数据，其中对于每一组数据：\n\n第一行一个整数 $n$。\n\n第二行 $n$ 个整数 $p_i$ 代表前缀和序列。", "outputFormat": "对于每一组数据：\n\n一行 $n$ 个整数代表一组满足要求的 $a_i$。\n", "hint": "#### 样例 1 解释\n\n输出的序列 $a_i$ 一定满足要求：\n\n- $p_1=10=a_1$；\n- $p_3=20=a_1+a_2+a_3$；\n- $p_5=30=a_1+a_2+a_3+a_4+a_5$。\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1\\le n,\\sum n\\le 10^5$，并保证存在至少一个合法 $a$ 数组。\n\n - Subtask 1（50 pts）：对于 $i=1,2,\\dots,n$，$p_i\\neq -1$；\n - Subtask 2（30 pts）：保证不存在 $i$ 使得 $p_i=p_{i+1}=-1$；\n - Subtask 3（20 pts）：无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-08」Fill In", "background": "$$\\begin{aligned}\\text{sdjvlajdiofjoiw{\\color{1f1e33}n}eglaj}\\\\\\text{pcji{\\color{1f1e33}2}gweiruitowoeuri}\\\\\\text{cnvak{\\color{1f1e33}5}jflkjweirqoiru}\\\\\\text{rrrwei{\\color{1f1e33}f}dlskfjqfafdfaff}\\\\\\text{nmslfjwiejfijlxkjfq{\\color{1f1e33}b}el}\\\\\\text{mmm{\\color{1f1e33}b}fsfmkdfmksld}\\\\\\text{erjf{\\color{1f1e33}n}kerjkwerjkwjeri}\\\\\\text{sdfafafaf{\\color{1f1e33}r}fxvzxvzvzx}\\end{aligned}$$", "description": "Dream 有一个长度为 $n$（$1\\le n\\le 10^5$）的正整数数组 $a_1,a_2,\\dots,a_n$，其中对于 $i=1,2,\\dots,n$，满足 $1\\le a_i\\le 1000$。\n\n他计算了前缀和数组 $p_i=a_1+a_2+\\dots+a_i$，保证对于 **原前缀和数组** 有任意 $1 \\le i <n$ 都有 $p_i<p_{i+1}$。\n\n现在 Tommy 偷走了这个数组以及将 $p$ 的若干个元素替代为 $-1$。给定当前的 $p$ 数组，请恢复任意一组合法 $a_1,a_2,\\dots,a_n$，可证明一定存在一个数组 $a_i$ 满足要求。", "inputFormat": "本题有多组数据，第一行一个正整数 $t$，为数据组数。接下来 $t$ 组数据，其中对于每一组数据：\n\n第一行一个整数 $n$。\n\n第二行 $n$ 个整数 $p_i$ 代表前缀和序列。", "outputFormat": "对于每一组数据：\n\n一行 $n$ 个整数代表一组满足要求的 $a_i$。\n", "hint": "#### 样例 1 解释\n\n输出的序列 $a_i$ 一定满足要求：\n\n- $p_1=10=a_1$；\n- $p_3=20=a_1+a_2+a_3$；\n- $p_5=30=a_1+a_2+a_3+a_4+a_5$。\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1\\le n,\\sum n\\le 10^5$，并保证存在至少一个合法 $a$ 数组。\n\n - Subtask 1（50 pts）：对于 $i=1,2,\\dots,n$，$p_i\\neq -1$；\n - Subtask 2（30 pts）：保证不存在 $i$ 使得 $p_i=p_{i+1}=-1$；\n - Subtask 3（20 pts）：无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P8279", "type": "P", "difficulty": 4, "samples": [["1\n4\n-1 34 367 -1\n3178 -1 -1 3333", "3 33 333 3333"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["洛谷原创", "Special Judge", "O2优化", "位运算", "构造", "洛谷月赛"], "title": "「MCOI-08」Fill In REMATCH", "background": "", "description": "Dream 有一个长度为 $n$（$1\\le n\\le 10^5$）的整数数组 $a_1,a_2,\\dots,a_n$，其中对于 $i=1,2,\\dots,n$，满足 $0\\le a_i<2^{60}$。\n\n他计算了前缀异或数组 $p_i=a_1\\oplus a_2\\oplus\\dots\\oplus a_i$ 以及后缀异或数组 $s_i=a_i\\oplus a_{i+1}\\oplus\\dots\\oplus a_n$。\n\n现在 Tommy **一共**将 $p$ 和 $s$ 的 $n$ 个元素换成 $-1$。给定当前的 $p$ 与 $s$ 数组，请恢复任意一组可能为原数组的 $a_1,a_2,\\dots,a_n$。\n\n保证存在一组合法解。", "inputFormat": "本题有多组数据，第一行一个正整数 $t$，为数据组数。接下来 $t$ 组数据，其中对于每一组数据：\n\n第一行一个正整数 $n$（$1\\le n\\le 10^5$）。 \n\n接下来 $n$ 个整数 $p_1,p_2,\\dots,p_n$。  \n\n接下来 $n$ 个整数 $s_1,s_2,\\dots,s_n$。  ", "outputFormat": "对于每一组数据：\n\n输出 $n$ 个非负整数 $a_1,a_2,\\dots,a_n$，满足以上条件。", "hint": "对于 $100\\%$ 的数据，$1\\le n,\\sum n\\le 10^5$，$\\sum [p_i=-1]+\\sum [s_i=-1]=n$，**保证有合法解。**\n\n - Subtask 1（10 pts）：$n\\le 4$，$p_i,s_i<2$；\n - Subtask 2（10 pts）：$n\\le 100$；\n - Subtask 3（20 pts）：$p_i,s_i<2$；\n - Subtask 4（60 pts）：无特殊限制。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-08」Fill In REMATCH", "background": "", "description": "Dream 有一个长度为 $n$（$1\\le n\\le 10^5$）的整数数组 $a_1,a_2,\\dots,a_n$，其中对于 $i=1,2,\\dots,n$，满足 $0\\le a_i<2^{60}$。\n\n他计算了前缀异或数组 $p_i=a_1\\oplus a_2\\oplus\\dots\\oplus a_i$ 以及后缀异或数组 $s_i=a_i\\oplus a_{i+1}\\oplus\\dots\\oplus a_n$。\n\n现在 Tommy **一共**将 $p$ 和 $s$ 的 $n$ 个元素换成 $-1$。给定当前的 $p$ 与 $s$ 数组，请恢复任意一组可能为原数组的 $a_1,a_2,\\dots,a_n$。\n\n保证存在一组合法解。", "inputFormat": "本题有多组数据，第一行一个正整数 $t$，为数据组数。接下来 $t$ 组数据，其中对于每一组数据：\n\n第一行一个正整数 $n$（$1\\le n\\le 10^5$）。 \n\n接下来 $n$ 个整数 $p_1,p_2,\\dots,p_n$。  \n\n接下来 $n$ 个整数 $s_1,s_2,\\dots,s_n$。  ", "outputFormat": "对于每一组数据：\n\n输出 $n$ 个非负整数 $a_1,a_2,\\dots,a_n$，满足以上条件。", "hint": "对于 $100\\%$ 的数据，$1\\le n,\\sum n\\le 10^5$，$\\sum [p_i=-1]+\\sum [s_i=-1]=n$，**保证有合法解。**\n\n - Subtask 1（10 pts）：$n\\le 4$，$p_i,s_i<2$；\n - Subtask 2（10 pts）：$n\\le 100$；\n - Subtask 3（20 pts）：$p_i,s_i<2$；\n - Subtask 4（60 pts）：无特殊限制。\n", "locale": "zh-CN"}}}
{"pid": "P8280", "type": "P", "difficulty": 5, "samples": [["2\n5 2\n1 2\n2 1\n1 2 1 4\n5 2\n1 2\n1 1\n1 2 1 4", "4\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["洛谷原创", "O2优化", "树形 DP", "洛谷月赛", "状压 DP"], "title": "「MCOI-08」Photoelectric Effect", "background": "", "description": "有一棵 $n$（$1\\le n\\le 10^5$）个点的树以及 $k$（$2\\le k\\le 5$）个颜色，根节点为 $1$。同时，给定一个颜色合并函数 $a\\otimes b$，满足当 $1\\le a,b\\le k$，有 $1\\le a\\otimes b\\le k$。\n\n请问有多少个方案对所有点染色，使得当点对 $u,v$ 之间没有祖先关系，有：\n\n - $u$ 和 $v$ 最近公共祖先的颜色为点 $u$ 的颜色和点 $v$ 的颜色之并。\n\n答案对 $10^9+7$ 取模。\n", "inputFormat": "本题有多组数据，第一行一个正整数 $t$（$1\\le t\\le 10^3$），为数据组数。接下来 $t$ 组数据，其中对于每一组数据：\n\n第一行两个正整数 $n,k$。  \n\n接下来 $k$ 行，每行 $k$ 个正整数。第 $i$ 行第 $j$ 个数为 $i\\otimes j$ 的值。\n\n接下来 $n-1$ 个正整数 $f_2,f_3,\\dots,f_n$，其中 $f_i$ 是 $i$ 的父亲节点。", "outputFormat": "对于每一组数据：\n\n输出一个整数，表示答案。", "hint": "#### 样例 1 解释\n\n树的形态如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/twht22a6.png)\n\n设 $w_i$ 为第 $i$ 个点的点权，则有如下 $4$ 种分配方式：\n\n- $w_i=\\{1,1,1,1,1\\}$；\n- $w_i=\\{2,2,2,1,1\\}$；\n- $w_i=\\{2,1,1,2,2\\}$；\n- $w_i=\\{1,2,2,2,2\\}$。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n对于 $100\\%$ 的数据，$1\\le n,\\sum n\\le10^5$，$2\\le k\\le 5$，$1\\le f_i<i$。\n\n对于 $100\\%$ 的数据，$1\\le t\\le 1000$。\n\n - Subtask 1（5 pts）：$n\\le5$；\n - Subtask 2（11 pts）：树上任何节点孩子个数至多为 $2$；\n - Subtask 3（23 pts）：树上任何节点孩子个数至多为 $3$；\n - Subtask 4（13 pts）：$k=2$；\n - Subtask 5（17 pts）：$k\\le3$； \n - Subtask 6（31 pts）：无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-08」Photoelectric Effect", "background": "", "description": "有一棵 $n$（$1\\le n\\le 10^5$）个点的树以及 $k$（$2\\le k\\le 5$）个颜色，根节点为 $1$。同时，给定一个颜色合并函数 $a\\otimes b$，满足当 $1\\le a,b\\le k$，有 $1\\le a\\otimes b\\le k$。\n\n请问有多少个方案对所有点染色，使得当点对 $u,v$ 之间没有祖先关系，有：\n\n - $u$ 和 $v$ 最近公共祖先的颜色为点 $u$ 的颜色和点 $v$ 的颜色之并。\n\n答案对 $10^9+7$ 取模。\n", "inputFormat": "本题有多组数据，第一行一个正整数 $t$（$1\\le t\\le 10^3$），为数据组数。接下来 $t$ 组数据，其中对于每一组数据：\n\n第一行两个正整数 $n,k$。  \n\n接下来 $k$ 行，每行 $k$ 个正整数。第 $i$ 行第 $j$ 个数为 $i\\otimes j$ 的值。\n\n接下来 $n-1$ 个正整数 $f_2,f_3,\\dots,f_n$，其中 $f_i$ 是 $i$ 的父亲节点。", "outputFormat": "对于每一组数据：\n\n输出一个整数，表示答案。", "hint": "#### 样例 1 解释\n\n树的形态如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/twht22a6.png)\n\n设 $w_i$ 为第 $i$ 个点的点权，则有如下 $4$ 种分配方式：\n\n- $w_i=\\{1,1,1,1,1\\}$；\n- $w_i=\\{2,2,2,1,1\\}$；\n- $w_i=\\{2,1,1,2,2\\}$；\n- $w_i=\\{1,2,2,2,2\\}$。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n对于 $100\\%$ 的数据，$1\\le n,\\sum n\\le10^5$，$2\\le k\\le 5$，$1\\le f_i<i$。\n\n对于 $100\\%$ 的数据，$1\\le t\\le 1000$。\n\n - Subtask 1（5 pts）：$n\\le5$；\n - Subtask 2（11 pts）：树上任何节点孩子个数至多为 $2$；\n - Subtask 3（23 pts）：树上任何节点孩子个数至多为 $3$；\n - Subtask 4（13 pts）：$k=2$；\n - Subtask 5（17 pts）：$k\\le3$； \n - Subtask 6（31 pts）：无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P8281", "type": "P", "difficulty": 7, "samples": [["3 3\n1 2\n2 3\n3 1", "1 2 3"], ["4 6\n1 3\n1 4\n2 1\n2 3\n3 4\n4 2", "1 3 4 2"], ["5 8\n1 2\n2 3\n3 4\n4 1\n2 5\n4 5\n5 1\n5 3", "1 2 3 4 5\n1 2 5 3 4"], ["5 10\n1 2\n1 3\n2 3\n2 4\n3 4\n3 5\n4 1\n4 5\n5 1\n5 2", "1 2 3 4 5\n1 3 5 2 4"], ["6 15\n1 3\n1 4\n1 5\n2 1\n2 3\n2 4\n3 1\n3 4\n4 2\n4 6\n5 2\n5 3\n6 1\n6 2\n6 3", "1 5 2 3 4 6\n1 5 2 4 6 3\n1 5 3 4 6 2"], ["6 15\n1 3\n1 5\n2 1\n2 4\n3 1\n3 2\n3 4\n3 5\n3 6\n4 6\n5 1\n5 4\n5 6\n6 3\n6 5", "1 3 2 4 6 5\n1 5 4 6 3 2"], ["6 16\n1 3\n1 6\n2 3\n2 4\n2 6\n3 1\n3 6\n4 2\n4 3\n4 5\n4 6\n5 2\n5 6\n6 1\n6 3\n6 5", "1 6 5 2 4 3"], ["6 21\n1 2\n1 5\n1 6\n2 1\n2 3\n2 4\n2 5\n3 1\n3 2\n3 4\n3 6\n4 1\n4 2\n4 6\n5 1\n5 2\n5 4\n5 6\n6 2\n6 3\n6 4", "1 2 5 4 6 3\n1 2 5 6 3 4\n1 5 2 3 6 4\n1 5 2 4 6 3\n1 5 4 6 2 3\n1 5 4 6 3 2\n1 5 6 2 3 4\n1 5 6 3 2 4\n1 5 6 3 4 2\n1 5 6 4 2 3\n1 6 3 2 5 4\n1 6 3 4 2 5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["搜索", "洛谷原创", "O2优化", "剪枝", "洛谷月赛"], "title": "「MCOI-08」Fast Enumeration", "background": "", "description": "Technoblade 将 Skyblock 抽象为一张 $n$（$n\\le 50$）节点 $m$ 条边的简单有向图。他需要求出该图 **所有** 哈密尔顿回路，即所有排列 $p_1,p_2,\\dots,p_n$ 使得 $p_1=1$ 并且 $p_1\\to p_2\\to \\dots\\to p_{n-1}\\to p_n\\to p_1$ 为一个合法路径。\n\n**数据保证哈密尔顿回路数量非零并小于 $10^4$**。\n\n**数据从所有合法数据随机采样。**", "inputFormat": "第一行两个正整数 $n,m$。\n\n接下来 $m$ 行，每行两个正整数 $u,v$。", "outputFormat": "输出若干行；每行输出 $n$ 个正整数，为一个哈密尔顿回路。按照递增字典序输出。", "hint": "#### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/lth4lrb1.png)\n\n有 $1$ 个哈密尔顿回路：\n\n - $1\\to2\\to3\\to1$。\n\n#### 样例 2 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/if0vz8gm.png)\n\n有 $1$ 个哈密尔顿回路：\n\n - $1\\to3\\to4\\to2\\to1$。\n\n#### 样例 3 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/dv1tul62.png)\n\n有 $2$ 个哈密尔顿回路：\n\n - $1\\to2\\to3\\to4\\to5\\to1$；\n - $1\\to2\\to5\\to3\\to4\\to1$。\n\n#### 样例 4 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wggv2mfd.png)\n\n有 $2$ 个哈密尔顿回路：\n\n - $1\\to2\\to3\\to4\\to5\\to1$；\n - $1\\to3\\to5\\to2\\to4\\to1$。\n\n#### 样例 5 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cfi80wob.png)\n\n有 $3$ 个哈密尔顿回路：\n\n - $1\\to5\\to2\\to3\\to4\\to6\\to1$；\n - $1\\to5\\to2\\to4\\to6\\to3\\to1$；\n - $1\\to5\\to3\\to4\\to6\\to2\\to1$。\n\n#### 样例 6 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wqd9tpl8.png)\n\n有 $2$ 个哈密尔顿回路：\n\n - $1\\to3\\to2\\to4\\to6\\to5\\to1$；\n - $1\\to5\\to4\\to6\\to3\\to2\\to1$。\n\n#### 样例 7 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jff0k373.png)\n\n有 $1$ 个哈密尔顿回路：\n\n - $1\\to6\\to5\\to2\\to4\\to3\\to1$。\n\n#### 样例 8 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x2j19zoc.png)\n\n有 $12$ 个哈密尔顿回路：\n\n - $1\\to2\\to5\\to4\\to6\\to3\\to1$；\n - $1\\to2\\to5\\to6\\to3\\to4\\to1$；\n - $1\\to5\\to2\\to3\\to6\\to4\\to1$；\n - $1\\to5\\to2\\to4\\to6\\to3\\to1$；\n - $1\\to5\\to4\\to6\\to2\\to3\\to1$；\n - $1\\to5\\to4\\to6\\to3\\to2\\to1$；\n - $1\\to5\\to6\\to2\\to3\\to4\\to1$；\n - $1\\to5\\to6\\to3\\to2\\to4\\to1$；\n - $1\\to5\\to6\\to3\\to4\\to2\\to1$；\n - $1\\to5\\to6\\to4\\to2\\to3\\to1$；\n - $1\\to6\\to3\\to2\\to5\\to4\\to1$；\n - $1\\to6\\to3\\to4\\to2\\to5\\to1$。\n\n#### 数据规模与约定\n\n对于固定 $n$ 和 $P$，任意一张 $m$ 条边的图权重为 $\\left(\\frac{1}{P}\\right)^m\\left(\\frac{P-1}{P}\\right)^{n^2-n-m}$。\n\n - Subtask 1（1 pts）：为样例。\n - Subtask 2（16 pts）：$n=15$。\n - Subtask 3（20 pts）：$n=30$。\n - Subtask 4（26 pts）：$n=40$。\n - Subtask 5（37 pts）：$n=50$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-08」Fast Enumeration", "background": "", "description": "Technoblade 将 Skyblock 抽象为一张 $n$（$n\\le 50$）节点 $m$ 条边的简单有向图。他需要求出该图 **所有** 哈密尔顿回路，即所有排列 $p_1,p_2,\\dots,p_n$ 使得 $p_1=1$ 并且 $p_1\\to p_2\\to \\dots\\to p_{n-1}\\to p_n\\to p_1$ 为一个合法路径。\n\n**数据保证哈密尔顿回路数量非零并小于 $10^4$**。\n\n**数据从所有合法数据随机采样。**", "inputFormat": "第一行两个正整数 $n,m$。\n\n接下来 $m$ 行，每行两个正整数 $u,v$。", "outputFormat": "输出若干行；每行输出 $n$ 个正整数，为一个哈密尔顿回路。按照递增字典序输出。", "hint": "#### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/lth4lrb1.png)\n\n有 $1$ 个哈密尔顿回路：\n\n - $1\\to2\\to3\\to1$。\n\n#### 样例 2 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/if0vz8gm.png)\n\n有 $1$ 个哈密尔顿回路：\n\n - $1\\to3\\to4\\to2\\to1$。\n\n#### 样例 3 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/dv1tul62.png)\n\n有 $2$ 个哈密尔顿回路：\n\n - $1\\to2\\to3\\to4\\to5\\to1$；\n - $1\\to2\\to5\\to3\\to4\\to1$。\n\n#### 样例 4 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wggv2mfd.png)\n\n有 $2$ 个哈密尔顿回路：\n\n - $1\\to2\\to3\\to4\\to5\\to1$；\n - $1\\to3\\to5\\to2\\to4\\to1$。\n\n#### 样例 5 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cfi80wob.png)\n\n有 $3$ 个哈密尔顿回路：\n\n - $1\\to5\\to2\\to3\\to4\\to6\\to1$；\n - $1\\to5\\to2\\to4\\to6\\to3\\to1$；\n - $1\\to5\\to3\\to4\\to6\\to2\\to1$。\n\n#### 样例 6 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wqd9tpl8.png)\n\n有 $2$ 个哈密尔顿回路：\n\n - $1\\to3\\to2\\to4\\to6\\to5\\to1$；\n - $1\\to5\\to4\\to6\\to3\\to2\\to1$。\n\n#### 样例 7 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jff0k373.png)\n\n有 $1$ 个哈密尔顿回路：\n\n - $1\\to6\\to5\\to2\\to4\\to3\\to1$。\n\n#### 样例 8 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x2j19zoc.png)\n\n有 $12$ 个哈密尔顿回路：\n\n - $1\\to2\\to5\\to4\\to6\\to3\\to1$；\n - $1\\to2\\to5\\to6\\to3\\to4\\to1$；\n - $1\\to5\\to2\\to3\\to6\\to4\\to1$；\n - $1\\to5\\to2\\to4\\to6\\to3\\to1$；\n - $1\\to5\\to4\\to6\\to2\\to3\\to1$；\n - $1\\to5\\to4\\to6\\to3\\to2\\to1$；\n - $1\\to5\\to6\\to2\\to3\\to4\\to1$；\n - $1\\to5\\to6\\to3\\to2\\to4\\to1$；\n - $1\\to5\\to6\\to3\\to4\\to2\\to1$；\n - $1\\to5\\to6\\to4\\to2\\to3\\to1$；\n - $1\\to6\\to3\\to2\\to5\\to4\\to1$；\n - $1\\to6\\to3\\to4\\to2\\to5\\to1$。\n\n#### 数据规模与约定\n\n对于固定 $n$ 和 $P$，任意一张 $m$ 条边的图权重为 $\\left(\\frac{1}{P}\\right)^m\\left(\\frac{P-1}{P}\\right)^{n^2-n-m}$。\n\n - Subtask 1（1 pts）：为样例。\n - Subtask 2（16 pts）：$n=15$。\n - Subtask 3（20 pts）：$n=30$。\n - Subtask 4（26 pts）：$n=40$。\n - Subtask 5（37 pts）：$n=50$。\n", "locale": "zh-CN"}}}
{"pid": "P8282", "type": "P", "difficulty": 7, "samples": [["5 4 4000000 9000000 13 0\n3000000 0\n1000000 1000000\n2000000 4000000\n6000000 8000000\n7000000 10000000\n5000000 0\n4000000 2000000\n6000000 6000000\n10000000 10000000", "1\n4\n4000000.0000000000 0.0000000000\n3000000.0000000000 2000000.0000000000\n4000000.0000000000 6000000.0000000000\n9000000.0000000000 10000000.0000000000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "Special Judge", "O2优化", "凸包", "洛谷月赛"], "title": "「MCOI-08 / AC6-M12」Weapons of Mass Destruction", "background": "Garuda Team, I've got some good news. \n\nThe chemical agent used as a catalyst for their WMD is being transported to our shores from the Estovakian mainland. \n\nThis catalyst has already been carried into the outskirts of Gracemeria. \n\nAs a measure of caution against any attempts to destroy it, it has been concealed at Fort Norton in Gracemeria's north. \n\nIf we start advancing again, the enemy will most likely bring the catalyst into Gracemeria at a faster pace. \n\nIf in fact weapons of mass destruction are used on the population of Gracemeria, the resulting devastation can't be expressed in enough words. \n\nIt will lead to unspeakable tragedies. \n\nWe've used this intelligence to come up with a solid proposal on how to prevent this scorched earth policy from being executed in our capital.\n\nJust a minute ago, we received a letter of approval for our prevention plan from the Joint Chiefs of Staff. \n\nThe proposal we put on the table for our scorched earth prevention policy is really quite simple. \n\nWhile the enemy transport unit is stationed at Fort Norton, **we'll ambush them.** \n\nWe like to call it our tactic for pre-emptive victory. \n\nThe enemy has loaded this catalyst into their transport vehicles and is able to send them into Gracemeria at any time. \n\nThis plan will be carried out by a handful of our top pilots under absolute secrecy. \n\n**Fly through Fort Norton's canyon at an extremely low altitude to avoid radar detection, and take out those transport vehicles.** \n\nWe've determined that a high-risk mission of this magnitude could not be executed by anyone other than Garuda Team. \n\nWe're counting on a flawless execution here.\n\n$$_{{\\frac{\\large\\text{ACE COMBAT }\\Large6}{\\tiny{\\text{F i r e s\\quad O f\\quad L i b e r a t i o n}}}}}\\\\ \\text{Mission 12} \\\\\\Large\\text{Weapons of Mass Destruction}\\\\\\tiny -\\textit{ Boiling Point }-$$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3e1iqxjw.png)", "description": "为了摧毁敌方装载有 WMD 催化剂的车队，你需要在超低空穿过 Fort Norton 的峡谷以接近他们。\n\nFort Norton 抽象为**平面上两个关于 $y$（$y\\in[0,10^7]$）的线性分段函数** $A(y):y\\mapsto x$ 以及 $B(y):y\\mapsto x$，其中对于任意实数 $y\\in [0,10^7]$，**满足 $A(y) \\le B(y)$**。\n\n你和你的 F-15E 抽象为一质点，**初始位置是 $(X_1,0)$**，保证 $A(0)\\leq X_1\\leq B(0)$；**同时具有初速度 $(v_0,\\theta_0)$，表示初速的大小和方向**。\n\n为了避免敌方发现，你不能大功率开动发动机。你的动力刚好足够在保持平飞的时候保持匀速。\n\n当然你可以转向。由于你是 Ace Combat 的主角，你的转向全部用 PSM 完成。具体来说，你的飞行轨迹应为一条由若干线段组成的折线。但是在转向中会受到阻力。**如果方向改变后的角与改变前的角的差的绝对值为 $\\alpha$，则速度大小会减小 $\\alpha$**。如果你不改变方向，那么你会一直做匀速直线运动。\n\n由于 Ghost Eye 很着急完成任务，所以**你的 $y$ 坐标必须随时间递增**。\n\n同时，你需要保证在任意时刻，你所在的位置 $(x,y)$ 满足 $A(y)\\le x\\le B(y)$。\n\nPSM 转向的过载很大，因此你需要保证**转向次数不超过 $\\bf 3\\times 10^6$**。~~否则你就会像 Prez 一样 g-LOC 并一头栽在仪表盘上。~~\n\n求任何一个转向方案，使得你运动到 $(X_2,10^7)$ 上（**即，速度不能在运动过程中变为 $\\bf0$ 或负数**），同时转向次数不超过 $3\\times 10^6$。类似的，保证 $A(10^7)\\leq X_2\\leq B(10^7)$。", "inputFormat": "第一行四个整数 $n,m,X_1,X_2$ 和两个实数 $v_0,\\theta_0$。\n\n**保证 $v_0\\pm 10^{-6}$ 范围内解存在性不变。**\n\n接下来 $n$ 行，每行两个整数 $x,y$，保证 $y$ 递增，第一个 $y$ 是 $0$，最后一个 $y$ 是 $10^7$。把这些点依次用线段连接起来即得到函数 $A$。\n\n接下来 $m$ 行，每行两个整数 $p,q$ 表示函数 $B$，与 $A$ 的输入方式同理。", "outputFormat": "先输出一行 `1`。\n\n然后由于这个点的运动轨迹一定是一条折线，所以你需要在下一行输出端点数 $K$；接下来输出 $K$ 行，每行两个实数表示这个端点的坐标。假设你给出的点列是 $C:\\{(s_1,t_1),(s_2,t_2),\\cdots,(s_K,t_K)\\}$，那么表示 $\\forall i\\in [1,K)$，$C_iC_{i+1}$ 之间连线，得到的折线就是你给出的运动轨迹。\n\n你需要保证：\n\n- $C_1$ 与 $X_1$ 重合，$C_K$ 与 $X_2$ 重合；\n- **$C$ 中 $y$ 坐标单调；**\n- 对于任意 $1\\leq i<K$，有 $t_i<t_{i+1}$；\n- 对于任意折线上的点 $(x,y)$，满足 $A(y)-10^{-6}\\leq x\\leq B(y)+10^{-6}$；\n- 运动过程中速度大于 $0$；\n- $K\\leq 3\\times10^6$。\n\n如果你正确输出了一种符合上述要求的方案，即被判为 Accepted。否则判为 Wrong Answer。如果有不止一种方案，输出任意一种皆可。\n\n**本题开启 Special Judge。**", "hint": "样例解释（缩小 $10^6$ 倍）：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5g98x901.png)\n\n**注意质点在运动过程中可以碰到边界，也可以沿着边界运动一段。**\n\n---\n\n对于 $100\\%$ 的数据，保证 $2\\leq n,m\\leq 10^6$，$0\\leq x,y,p,q\\leq 10^7$，$x_1\\leq X_1\\leq p_1$，$x_n\\leq X_2\\leq p_m$，$0\\leq \\theta_0<\\pi$，$0\\leq v_0\\leq 10^9$。\n\n对于 $100\\%$ 的数据，实数精度不超过 $12$ 位。\n\n对于 $100\\%$ 的数据，**保 证 有 解**。\n\n\n- Subtask 1（3 pts）：$n,m\\leq 6$；$v_0\\ge 50$。\n- Subtask 2（8 pts）：$n,m\\leq 6$。\n- Subtask 3（17 pts）：$n,m\\leq 200$。\n- Subtask 4（13 pts）：$n,m\\leq 1500$。\n- Subtask 5（17 pts）：$n,m\\leq 5000$。\n- Subtask 6（19 pts）：$n,m\\leq 10^5$。\n- Subtask 7（23 pts）：无特殊限制。\n\n**请注意浮点数输出效率。**\n\n---\n\nidea：Sol1，solution：Sol1 & w33z8kqrqk8zzzx33，code：Sol1，data：w33z8kqrqk8zzzx33", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-08 / AC6-M12」Weapons of Mass Destruction", "background": "Garuda Team, I've got some good news. \n\nThe chemical agent used as a catalyst for their WMD is being transported to our shores from the Estovakian mainland. \n\nThis catalyst has already been carried into the outskirts of Gracemeria. \n\nAs a measure of caution against any attempts to destroy it, it has been concealed at Fort Norton in Gracemeria's north. \n\nIf we start advancing again, the enemy will most likely bring the catalyst into Gracemeria at a faster pace. \n\nIf in fact weapons of mass destruction are used on the population of Gracemeria, the resulting devastation can't be expressed in enough words. \n\nIt will lead to unspeakable tragedies. \n\nWe've used this intelligence to come up with a solid proposal on how to prevent this scorched earth policy from being executed in our capital.\n\nJust a minute ago, we received a letter of approval for our prevention plan from the Joint Chiefs of Staff. \n\nThe proposal we put on the table for our scorched earth prevention policy is really quite simple. \n\nWhile the enemy transport unit is stationed at Fort Norton, **we'll ambush them.** \n\nWe like to call it our tactic for pre-emptive victory. \n\nThe enemy has loaded this catalyst into their transport vehicles and is able to send them into Gracemeria at any time. \n\nThis plan will be carried out by a handful of our top pilots under absolute secrecy. \n\n**Fly through Fort Norton's canyon at an extremely low altitude to avoid radar detection, and take out those transport vehicles.** \n\nWe've determined that a high-risk mission of this magnitude could not be executed by anyone other than Garuda Team. \n\nWe're counting on a flawless execution here.\n\n$$_{{\\frac{\\large\\text{ACE COMBAT }\\Large6}{\\tiny{\\text{F i r e s\\quad O f\\quad L i b e r a t i o n}}}}}\\\\ \\text{Mission 12} \\\\\\Large\\text{Weapons of Mass Destruction}\\\\\\tiny -\\textit{ Boiling Point }-$$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3e1iqxjw.png)", "description": "为了摧毁敌方装载有 WMD 催化剂的车队，你需要在超低空穿过 Fort Norton 的峡谷以接近他们。\n\nFort Norton 抽象为**平面上两个关于 $y$（$y\\in[0,10^7]$）的线性分段函数** $A(y):y\\mapsto x$ 以及 $B(y):y\\mapsto x$，其中对于任意实数 $y\\in [0,10^7]$，**满足 $A(y) \\le B(y)$**。\n\n你和你的 F-15E 抽象为一质点，**初始位置是 $(X_1,0)$**，保证 $A(0)\\leq X_1\\leq B(0)$；**同时具有初速度 $(v_0,\\theta_0)$，表示初速的大小和方向**。\n\n为了避免敌方发现，你不能大功率开动发动机。你的动力刚好足够在保持平飞的时候保持匀速。\n\n当然你可以转向。由于你是 Ace Combat 的主角，你的转向全部用 PSM 完成。具体来说，你的飞行轨迹应为一条由若干线段组成的折线。但是在转向中会受到阻力。**如果方向改变后的角与改变前的角的差的绝对值为 $\\alpha$，则速度大小会减小 $\\alpha$**。如果你不改变方向，那么你会一直做匀速直线运动。\n\n由于 Ghost Eye 很着急完成任务，所以**你的 $y$ 坐标必须随时间递增**。\n\n同时，你需要保证在任意时刻，你所在的位置 $(x,y)$ 满足 $A(y)\\le x\\le B(y)$。\n\nPSM 转向的过载很大，因此你需要保证**转向次数不超过 $\\bf 3\\times 10^6$**。~~否则你就会像 Prez 一样 g-LOC 并一头栽在仪表盘上。~~\n\n求任何一个转向方案，使得你运动到 $(X_2,10^7)$ 上（**即，速度不能在运动过程中变为 $\\bf0$ 或负数**），同时转向次数不超过 $3\\times 10^6$。类似的，保证 $A(10^7)\\leq X_2\\leq B(10^7)$。", "inputFormat": "第一行四个整数 $n,m,X_1,X_2$ 和两个实数 $v_0,\\theta_0$。\n\n**保证 $v_0\\pm 10^{-6}$ 范围内解存在性不变。**\n\n接下来 $n$ 行，每行两个整数 $x,y$，保证 $y$ 递增，第一个 $y$ 是 $0$，最后一个 $y$ 是 $10^7$。把这些点依次用线段连接起来即得到函数 $A$。\n\n接下来 $m$ 行，每行两个整数 $p,q$ 表示函数 $B$，与 $A$ 的输入方式同理。", "outputFormat": "先输出一行 `1`。\n\n然后由于这个点的运动轨迹一定是一条折线，所以你需要在下一行输出端点数 $K$；接下来输出 $K$ 行，每行两个实数表示这个端点的坐标。假设你给出的点列是 $C:\\{(s_1,t_1),(s_2,t_2),\\cdots,(s_K,t_K)\\}$，那么表示 $\\forall i\\in [1,K)$，$C_iC_{i+1}$ 之间连线，得到的折线就是你给出的运动轨迹。\n\n你需要保证：\n\n- $C_1$ 与 $X_1$ 重合，$C_K$ 与 $X_2$ 重合；\n- **$C$ 中 $y$ 坐标单调；**\n- 对于任意 $1\\leq i<K$，有 $t_i<t_{i+1}$；\n- 对于任意折线上的点 $(x,y)$，满足 $A(y)-10^{-6}\\leq x\\leq B(y)+10^{-6}$；\n- 运动过程中速度大于 $0$；\n- $K\\leq 3\\times10^6$。\n\n如果你正确输出了一种符合上述要求的方案，即被判为 Accepted。否则判为 Wrong Answer。如果有不止一种方案，输出任意一种皆可。\n\n**本题开启 Special Judge。**", "hint": "样例解释（缩小 $10^6$ 倍）：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5g98x901.png)\n\n**注意质点在运动过程中可以碰到边界，也可以沿着边界运动一段。**\n\n---\n\n对于 $100\\%$ 的数据，保证 $2\\leq n,m\\leq 10^6$，$0\\leq x,y,p,q\\leq 10^7$，$x_1\\leq X_1\\leq p_1$，$x_n\\leq X_2\\leq p_m$，$0\\leq \\theta_0<\\pi$，$0\\leq v_0\\leq 10^9$。\n\n对于 $100\\%$ 的数据，实数精度不超过 $12$ 位。\n\n对于 $100\\%$ 的数据，**保 证 有 解**。\n\n\n- Subtask 1（3 pts）：$n,m\\leq 6$；$v_0\\ge 50$。\n- Subtask 2（8 pts）：$n,m\\leq 6$。\n- Subtask 3（17 pts）：$n,m\\leq 200$。\n- Subtask 4（13 pts）：$n,m\\leq 1500$。\n- Subtask 5（17 pts）：$n,m\\leq 5000$。\n- Subtask 6（19 pts）：$n,m\\leq 10^5$。\n- Subtask 7（23 pts）：无特殊限制。\n\n**请注意浮点数输出效率。**\n\n---\n\nidea：Sol1，solution：Sol1 & w33z8kqrqk8zzzx33，code：Sol1，data：w33z8kqrqk8zzzx33", "locale": "zh-CN"}}}
{"pid": "P8283", "type": "P", "difficulty": 7, "samples": [["5 10 2\n0000000001000020000300004", "4834712607666044912"], ["20 100 16500242824326557842\n0000500006000070000800000000010000200003000040000000001000020000300004000090000:0000;0000<0000=0000>", "5449866856465492064"]], "limits": {"time": [1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["洛谷原创", "O2优化", "线性基", "洛谷月赛"], "title": "「MCOI-08」Dantalion", "background": "And thus it is Tairitsu's turn to gain  the upper hand.", "description": "给定一个长为 $n$（$1\\le n\\le 6\\times 10^5$）的非负整数序列 $a_0,a_1,\\dots,a_{n-1}$（$0\\le a_i<2^{30}$）。\n\n有 $q$ 个问询（$1\\le q\\le 10^6$）。\n\n每次问询两个整数 $l,r$（$0\\le l\\le r<n$），有多少对整数 $x,y$ 满足：\n\n - $l\\le x\\le y\\le r$；\n - $\\forall i,j\\in S\\ :i\\oplus j\\in S$，其中 $S:=\\{a_k\\}_{k=x}^y$。\n \nTip: 本题总时限较大，故请减少无意义提交量（如高复杂度暴力或是直接提交所给尚需完善的代码等）。", "inputFormat": "由于本题数据较多，您不需要输入输出，请完善以下程序中的 `init(int, int, vector<int>)` 和 `solve(int, int)` 函数，并提交。正解不依赖于其模板。\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nvoid init(int n, int q, vector<int> a) {\n  // implement...\n}\n\nlong long solve(int l, int r) {\n  // implement...\n}\n\nint main() {\n  int n, q;\n  uint64_t s;\n  cin >> n >> q >> s;\n  string r;\n  cin >> r;\n  vector<int> a(n);\n  for (int i = 0; i < n; i++)\n    for (int s = 5 * i; s < 5 * i + 5; s++)\n      a[i] = (a[i] * 64 + (int)(r[s]) - (int)('0'));\n  init(n, q, a);\n  uint64_t state = 0;\n  auto splitmix64 = [&](uint64_t v) {\n    uint64_t z = (v + 0x9e3779b97f4a7c15);\n    z = (z ^ (z >> 30)) * 0xbf58476d1ce4e5b9;\n    z = (z ^ (z >> 27)) * 0x94d049bb133111eb;\n    return z ^ (z >> 31);\n  };\n  mt19937_64 rng(s);\n  for (int i = 0; i < q; i++) {\n    int l = (rng() ^ state) % n;\n    int r = (rng() ^ state) % n;\n    long long ans = solve(min(l, r), max(l, r));\n    state = splitmix64(state + ans);\n    if ((i + 1) % (1 << 15) == 0)\n      cout << state << endl;\n  }\n  cout << state << endl;\n}\n```\n", "outputFormat": "", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1\\leq n\\le 6\\times 10^5,1\\le q\\leq 10^6$，$0 \\le a_i < 2^{30}$，$0 \\le l \\le r < n$。\n\n对于 $100\\%$ 的数据，输入合法。\n\n- Subtask 1（5 pts,~~Tutorial~~）：$1\\le n,q\\le 10^2$。\n- Subtask 2（7 pts,~~Tutorial~~）：$1\\leq n,q\\leq 10^3$\n- Subtask 3（11 pts,~~PST 5.0~~）：$1\\leq n,q\\leq 10^4$。\n- Subtask 4（17 pts,~~PRS 8.2~~）：$1\\leq n,q\\leq 10^5$。\n- Subtask 5（61 pts,~~FTR 10.8~~）：$1\\leq n\\le 6\\times 10^5,1\\le q\\leq 10^6$。\n\n为什么要多个 $1$ 分呢，因为谱师打本曲时性了 $1$ Lost.\n\nIdea: Powerless; Solution: ccz181078&noip&w33z; Code: w33z; Data: w33z\n\nThis problem was added on 2022.4.10. Thanks for their help.\n\nThe data was strengthened on 2022.4.27 by w33z.\n\n2022.4.10 - 2022.5.4 : 25 days 1st kill (水军带你飞).\n\n2022.4.10 - 2022.5.17 : 38 days 2nd kill (WhisperingSnowflakes).\n\n2022.4.10 - 2022.6.9 : 61 days 3rd kill (Verdandi).", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-08」Dantalion", "background": "And thus it is Tairitsu's turn to gain  the upper hand.", "description": "给定一个长为 $n$（$1\\le n\\le 6\\times 10^5$）的非负整数序列 $a_0,a_1,\\dots,a_{n-1}$（$0\\le a_i<2^{30}$）。\n\n有 $q$ 个问询（$1\\le q\\le 10^6$）。\n\n每次问询两个整数 $l,r$（$0\\le l\\le r<n$），有多少对整数 $x,y$ 满足：\n\n - $l\\le x\\le y\\le r$；\n - $\\forall i,j\\in S\\ :i\\oplus j\\in S$，其中 $S:=\\{a_k\\}_{k=x}^y$。\n \nTip: 本题总时限较大，故请减少无意义提交量（如高复杂度暴力或是直接提交所给尚需完善的代码等）。", "inputFormat": "由于本题数据较多，您不需要输入输出，请完善以下程序中的 `init(int, int, vector<int>)` 和 `solve(int, int)` 函数，并提交。正解不依赖于其模板。\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nvoid init(int n, int q, vector<int> a) {\n  // implement...\n}\n\nlong long solve(int l, int r) {\n  // implement...\n}\n\nint main() {\n  int n, q;\n  uint64_t s;\n  cin >> n >> q >> s;\n  string r;\n  cin >> r;\n  vector<int> a(n);\n  for (int i = 0; i < n; i++)\n    for (int s = 5 * i; s < 5 * i + 5; s++)\n      a[i] = (a[i] * 64 + (int)(r[s]) - (int)('0'));\n  init(n, q, a);\n  uint64_t state = 0;\n  auto splitmix64 = [&](uint64_t v) {\n    uint64_t z = (v + 0x9e3779b97f4a7c15);\n    z = (z ^ (z >> 30)) * 0xbf58476d1ce4e5b9;\n    z = (z ^ (z >> 27)) * 0x94d049bb133111eb;\n    return z ^ (z >> 31);\n  };\n  mt19937_64 rng(s);\n  for (int i = 0; i < q; i++) {\n    int l = (rng() ^ state) % n;\n    int r = (rng() ^ state) % n;\n    long long ans = solve(min(l, r), max(l, r));\n    state = splitmix64(state + ans);\n    if ((i + 1) % (1 << 15) == 0)\n      cout << state << endl;\n  }\n  cout << state << endl;\n}\n```\n", "outputFormat": "", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1\\leq n\\le 6\\times 10^5,1\\le q\\leq 10^6$，$0 \\le a_i < 2^{30}$，$0 \\le l \\le r < n$。\n\n对于 $100\\%$ 的数据，输入合法。\n\n- Subtask 1（5 pts,~~Tutorial~~）：$1\\le n,q\\le 10^2$。\n- Subtask 2（7 pts,~~Tutorial~~）：$1\\leq n,q\\leq 10^3$\n- Subtask 3（11 pts,~~PST 5.0~~）：$1\\leq n,q\\leq 10^4$。\n- Subtask 4（17 pts,~~PRS 8.2~~）：$1\\leq n,q\\leq 10^5$。\n- Subtask 5（61 pts,~~FTR 10.8~~）：$1\\leq n\\le 6\\times 10^5,1\\le q\\leq 10^6$。\n\n为什么要多个 $1$ 分呢，因为谱师打本曲时性了 $1$ Lost.\n\nIdea: Powerless; Solution: ccz181078&noip&w33z; Code: w33z; Data: w33z\n\nThis problem was added on 2022.4.10. Thanks for their help.\n\nThe data was strengthened on 2022.4.27 by w33z.\n\n2022.4.10 - 2022.5.4 : 25 days 1st kill (水军带你飞).\n\n2022.4.10 - 2022.5.17 : 38 days 2nd kill (WhisperingSnowflakes).\n\n2022.4.10 - 2022.6.9 : 61 days 3rd kill (Verdandi).", "locale": "zh-CN"}}}
{"pid": "P8284", "type": "P", "difficulty": 2, "samples": [["4\n1 1\n97 0\n17 1\n5 2", "5 or more\n1\n2\n3\n4\n5\nImpossible\nImpossible\nImpossible"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学"], "title": "「DAOI R1」Concert", "background": "> $ \\texttt{I want to be an artist.} $", "description": "$ \\texttt{Erinyes} $ 的学校将举办一场音乐会，但是他若想加入其中就必须经过一场考核，试题如下：\n\n给定两个整数 $ n,k $，表示有 $ n $ 个同学，你需要给每位同学分发一个数字，即对于整数 $ n $ 构造一个序列 $ a $。\n\n同学得到的数字必须满足如下性质：\n\n- 对于每个 $ i\\;(1 \\leq i \\leq n-1) $，满足 $ a_i=\\gcd(a_{i+1},a_{i+2},\\dots,a_{n-1},a_n) $。\n- 对于每个 $ i\\;(1 \\leq i \\leq n) $，满足 $ 1 \\leq a_i \\leq 10^5 $。\n- 对于每个 $ i\\;(1 \\leq i \\leq 10^5) $，$ a_i $ 至多在序列中出现 $ k $ 次。\n\n但这对 $ \\texttt{Erinyes} $ 来说太简单了，所以他决定专心准备节目，而这个问题则将交给你。\n\n你的任务是输出这样的序列的个数 $ l $ 以及所有这样的序列。但是由于答案可能会很大，所以我们对输出做了如下规定：\n\n- 对于 $ l=0 $，输出 ```Impossible```。\n- 对于 $ 1 \\leq l \\leq 4 $，输出序列实际个数，接下来 $ l $ 行，每行一个序列，表示你所构造的序列。\n- 对于 $ l \\geq 5 $，输出 ```5 or more```，接下来五行，每行一个序列，表示你所构造的序列中字典序最小的五个。\n- 你必须按照字典序输出。", "inputFormat": "第一行读入一个整数 $ t $，表示有 $ t $ 组数据。\n\n对于每组数据，读入两个整数 $ n,k $。", "outputFormat": "对于每组数据，第一行输出一个整数或一个字符串。倘若可以构造，接下来每行输出一个你所构造的字符串。", "hint": "### 样例解释\n对于第一组数据，可以发现此方案是最优解。\n\n对于第二组数据，无论如何也无法构造出正确的序列。\n\n对于第三组数据，无论如何也无法构造出正确的序列。\n\n对于第四组数据，无论如何也无法构造出正确的序列。\n\n### 数据规模\n对于 $ 100\\% $ 的数据，$ 1 \\leq t \\leq 100,1 \\leq n \\leq 10^5,0 \\leq k \\leq 10^5 $", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DAOI R1」Concert", "background": "> $ \\texttt{I want to be an artist.} $", "description": "$ \\texttt{Erinyes} $ 的学校将举办一场音乐会，但是他若想加入其中就必须经过一场考核，试题如下：\n\n给定两个整数 $ n,k $，表示有 $ n $ 个同学，你需要给每位同学分发一个数字，即对于整数 $ n $ 构造一个序列 $ a $。\n\n同学得到的数字必须满足如下性质：\n\n- 对于每个 $ i\\;(1 \\leq i \\leq n-1) $，满足 $ a_i=\\gcd(a_{i+1},a_{i+2},\\dots,a_{n-1},a_n) $。\n- 对于每个 $ i\\;(1 \\leq i \\leq n) $，满足 $ 1 \\leq a_i \\leq 10^5 $。\n- 对于每个 $ i\\;(1 \\leq i \\leq 10^5) $，$ a_i $ 至多在序列中出现 $ k $ 次。\n\n但这对 $ \\texttt{Erinyes} $ 来说太简单了，所以他决定专心准备节目，而这个问题则将交给你。\n\n你的任务是输出这样的序列的个数 $ l $ 以及所有这样的序列。但是由于答案可能会很大，所以我们对输出做了如下规定：\n\n- 对于 $ l=0 $，输出 ```Impossible```。\n- 对于 $ 1 \\leq l \\leq 4 $，输出序列实际个数，接下来 $ l $ 行，每行一个序列，表示你所构造的序列。\n- 对于 $ l \\geq 5 $，输出 ```5 or more```，接下来五行，每行一个序列，表示你所构造的序列中字典序最小的五个。\n- 你必须按照字典序输出。", "inputFormat": "第一行读入一个整数 $ t $，表示有 $ t $ 组数据。\n\n对于每组数据，读入两个整数 $ n,k $。", "outputFormat": "对于每组数据，第一行输出一个整数或一个字符串。倘若可以构造，接下来每行输出一个你所构造的字符串。", "hint": "### 样例解释\n对于第一组数据，可以发现此方案是最优解。\n\n对于第二组数据，无论如何也无法构造出正确的序列。\n\n对于第三组数据，无论如何也无法构造出正确的序列。\n\n对于第四组数据，无论如何也无法构造出正确的序列。\n\n### 数据规模\n对于 $ 100\\% $ 的数据，$ 1 \\leq t \\leq 100,1 \\leq n \\leq 10^5,0 \\leq k \\leq 10^5 $", "locale": "zh-CN"}}}
{"pid": "P8285", "type": "P", "difficulty": 5, "samples": [["2\n4\n2 0 2 2\n3\n5 0 7", "YES\nNO"]], "limits": {"time": [1000, 1000, 1000], "memory": [131072, 131072, 131072]}, "tags": ["数学", "排序", "分类讨论"], "title": "「DAOI R1」Magic", "background": "> $ \\text{-1,-1,+2} $", "description": "乔木 来到了大魔王的面前，他决定使用魔法击败魔王。\n\n给定一个整数 $n$，表示有 $n$ 个魔法阵，在每个魔法阵上都存在着一定的魔力值 $a_i$。\n\n你每次可以选择三个魔法阵 $i,j,k\\;(i,j,k$ 互不相同且 $a_i>0$，$a_j>0)$，然后 乔木 将会让第 $i$ 个魔法阵和第 $j$ 个魔法阵上的魔力值 $a_i,a_j$ 分别减 $1$，并让第 $k$ 个魔法阵上的魔力值 $a_k$ 加 $2$，我们将这称之为一次操作。\n\n乔木 想要将所有的魔力汇聚到一起以发挥最大的威力。他想知道在经过若干次操作后，能否让其中 $n-1$ 个魔法阵上的魔力值为 $0$，并使汇聚的那一个魔法阵的魔力值为原魔法阵的所有魔力值之和。", "inputFormat": "**本题包含多组数据。**\n\n一行输入一个数 $T$，表示数据组数。\n\n接下来对于每组数据，先输入一个正整数 $n$，然后依次输入 $n$ 个整数，第 $i$ 个整数代表 $a_i$。", "outputFormat": "对于每组数据输出一行，若可以实现，则输出 `YES`，否则输出 `NO`。", "hint": "### 样例解释\n- 对于第一组数据，可以将 $a_1$ 和 $a_3$ 对 $a_4$ 进行两次操作。\n- 对于第二组数据，可以证明不行。\n\n### 数据范围\n- 对于 $5\\%$ 的数据：$1\\le n\\le2$，$0\\le a_i\\le10^3$。\n- 对于 $20\\%$ 的数据：$1\\le n\\le10$，$0\\le a_i\\le10^3$。\n- 对于 $100\\%$ 的数据：$1\\le \\sum{n}\\le2\\times10^{6}$，$0\\le a_i\\le10^{9}$。\n\n对于所有数据，保证 $1\\le T\\le100$ 且 $\\sum\\limits_{i=1}^{n} a_i \\ge1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DAOI R1」Magic", "background": "> $ \\text{-1,-1,+2} $", "description": "乔木 来到了大魔王的面前，他决定使用魔法击败魔王。\n\n给定一个整数 $n$，表示有 $n$ 个魔法阵，在每个魔法阵上都存在着一定的魔力值 $a_i$。\n\n你每次可以选择三个魔法阵 $i,j,k\\;(i,j,k$ 互不相同且 $a_i>0$，$a_j>0)$，然后 乔木 将会让第 $i$ 个魔法阵和第 $j$ 个魔法阵上的魔力值 $a_i,a_j$ 分别减 $1$，并让第 $k$ 个魔法阵上的魔力值 $a_k$ 加 $2$，我们将这称之为一次操作。\n\n乔木 想要将所有的魔力汇聚到一起以发挥最大的威力。他想知道在经过若干次操作后，能否让其中 $n-1$ 个魔法阵上的魔力值为 $0$，并使汇聚的那一个魔法阵的魔力值为原魔法阵的所有魔力值之和。", "inputFormat": "**本题包含多组数据。**\n\n一行输入一个数 $T$，表示数据组数。\n\n接下来对于每组数据，先输入一个正整数 $n$，然后依次输入 $n$ 个整数，第 $i$ 个整数代表 $a_i$。", "outputFormat": "对于每组数据输出一行，若可以实现，则输出 `YES`，否则输出 `NO`。", "hint": "### 样例解释\n- 对于第一组数据，可以将 $a_1$ 和 $a_3$ 对 $a_4$ 进行两次操作。\n- 对于第二组数据，可以证明不行。\n\n### 数据范围\n- 对于 $5\\%$ 的数据：$1\\le n\\le2$，$0\\le a_i\\le10^3$。\n- 对于 $20\\%$ 的数据：$1\\le n\\le10$，$0\\le a_i\\le10^3$。\n- 对于 $100\\%$ 的数据：$1\\le \\sum{n}\\le2\\times10^{6}$，$0\\le a_i\\le10^{9}$。\n\n对于所有数据，保证 $1\\le T\\le100$ 且 $\\sum\\limits_{i=1}^{n} a_i \\ge1$。", "locale": "zh-CN"}}}
{"pid": "P8286", "type": "P", "difficulty": 5, "samples": [["5 3\n9 7 2 5 6\n1 2 1\n2 6 8\n3 3 4", "3\n16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "堆", "O2优化"], "title": "「DAOI R1」Ciky", "background": "> \n> She is Mine.\n>\n", "description": "深秋，落叶纷纷，瞳可开心了。\n\n$ \\texttt{Augen} $ 带着小朋友们一起在树林里捡了很多金黄的叶子。\n\n他们捡的所有叶子都是正多边形，现在 $ \\texttt{Augen} $ 准备把它们制作成标本装订成册送给瞳。\n\n制作一个标本，需要沿一片叶子的边缘画上颜色，每一片叶子边缘的颜色不能相同。同时，每一个标本都有相对应的美丽程度。\n\n将标本装订成册时，需满足以下条件：\n\n- 第 $i$ 片叶子的周长不能大于第 $i+1$ 片叶子；\n- 第 $i$ 片叶子的美丽程度不能大于第 $i+1$ 片叶子。\n\n $ \\texttt{Augen} $ 拥有 $n$ 支不同颜色的笔，每支还可以画 $a_i$ 的长度。\n\n$m$ 片叶子，第 $i$ 片叶子为正 $k_i$ 边形，每条边长 $b_i$ ，每片叶子的美丽程度$c_i$ 。\n\n更简单地说，即，只有满足 $k_i*b_i \\leq a_j$ 的情况下，可以用第 $j$ 支画笔，画第 $i$ 片叶子。\n\n特别地，在一片叶子被第 $i$ 支画笔画完过后，它的周长会变成 $a_i$。一个画笔最多画一片叶子。\n\n $ \\texttt{Augen} $ 希望能更多的送出标本或者使得制作出来的标本美丽程度总和最大。\n \n **注意：两个小问相互独立。**\n \n ", "inputFormat": "第一行两个整数，$n,m$ 。\n\n第二行共 $n$ 个整数，第 $i$ 个整数表示 $a_i$ 。\n\n第三行共 $m$ 个整数，第 $i$ 个整数表示 $b_i$ 。\n\n第四行共 $m$ 个整数，第 $i$ 个整数表示 $c_i$ 。\n\n第五行共 $m$ 个整数，第 $i$ 个整数表示 $k_i$ 。\n", "outputFormat": "共两行 。\n\n第一行，一个整数，表示册子中标本的个数的最大值 。\n\n第二行，一个整数，表示制作出来的标本美丽程度的最大值 。\n\n**注意：第二问并未要求将标本装入册子。**", "hint": "#### 样例解释\n对于第一个问题，用第 $4$ 个画笔画第 $1$ 个叶子，用第 $5$ 个画笔画第 $2$ 个叶子，用第 $1$ 个画笔画第 $3$ 个叶子，画出的叶子周长为 $5,6,9$，可画 $3$ 片。\n\n对于第二问，可以用同样的方法画，美丽度为 $2+6+8=16$\n\n### 数据规模\n**本题采用捆绑测试**\n\n| Subtask | $n$ | $m$  | 分值 |\n| :----------: | :----------:  | :----------: | :----------: |\n| $0$ | $\\le10$ | $\\le10$ | $10$ |\n| $1$ | $\\le10^3$ | $\\le10^3$  | $20$ |\n| $2$ | $\\le10^6$ | $\\leq 10^6$  | $70$ |\n\n对于 $100\\%$ 的数据，$1 \\leq n,m \\leq 10^6,3\\leq k_i \\leq 10^6,1 \\leq a_i \\leq 10^9,1 \\leq b_i,c_i \\leq 10^6$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DAOI R1」Ciky", "background": "> \n> She is Mine.\n>\n", "description": "深秋，落叶纷纷，瞳可开心了。\n\n$ \\texttt{Augen} $ 带着小朋友们一起在树林里捡了很多金黄的叶子。\n\n他们捡的所有叶子都是正多边形，现在 $ \\texttt{Augen} $ 准备把它们制作成标本装订成册送给瞳。\n\n制作一个标本，需要沿一片叶子的边缘画上颜色，每一片叶子边缘的颜色不能相同。同时，每一个标本都有相对应的美丽程度。\n\n将标本装订成册时，需满足以下条件：\n\n- 第 $i$ 片叶子的周长不能大于第 $i+1$ 片叶子；\n- 第 $i$ 片叶子的美丽程度不能大于第 $i+1$ 片叶子。\n\n $ \\texttt{Augen} $ 拥有 $n$ 支不同颜色的笔，每支还可以画 $a_i$ 的长度。\n\n$m$ 片叶子，第 $i$ 片叶子为正 $k_i$ 边形，每条边长 $b_i$ ，每片叶子的美丽程度$c_i$ 。\n\n更简单地说，即，只有满足 $k_i*b_i \\leq a_j$ 的情况下，可以用第 $j$ 支画笔，画第 $i$ 片叶子。\n\n特别地，在一片叶子被第 $i$ 支画笔画完过后，它的周长会变成 $a_i$。一个画笔最多画一片叶子。\n\n $ \\texttt{Augen} $ 希望能更多的送出标本或者使得制作出来的标本美丽程度总和最大。\n \n **注意：两个小问相互独立。**\n \n ", "inputFormat": "第一行两个整数，$n,m$ 。\n\n第二行共 $n$ 个整数，第 $i$ 个整数表示 $a_i$ 。\n\n第三行共 $m$ 个整数，第 $i$ 个整数表示 $b_i$ 。\n\n第四行共 $m$ 个整数，第 $i$ 个整数表示 $c_i$ 。\n\n第五行共 $m$ 个整数，第 $i$ 个整数表示 $k_i$ 。\n", "outputFormat": "共两行 。\n\n第一行，一个整数，表示册子中标本的个数的最大值 。\n\n第二行，一个整数，表示制作出来的标本美丽程度的最大值 。\n\n**注意：第二问并未要求将标本装入册子。**", "hint": "#### 样例解释\n对于第一个问题，用第 $4$ 个画笔画第 $1$ 个叶子，用第 $5$ 个画笔画第 $2$ 个叶子，用第 $1$ 个画笔画第 $3$ 个叶子，画出的叶子周长为 $5,6,9$，可画 $3$ 片。\n\n对于第二问，可以用同样的方法画，美丽度为 $2+6+8=16$\n\n### 数据规模\n**本题采用捆绑测试**\n\n| Subtask | $n$ | $m$  | 分值 |\n| :----------: | :----------:  | :----------: | :----------: |\n| $0$ | $\\le10$ | $\\le10$ | $10$ |\n| $1$ | $\\le10^3$ | $\\le10^3$  | $20$ |\n| $2$ | $\\le10^6$ | $\\leq 10^6$  | $70$ |\n\n对于 $100\\%$ 的数据，$1 \\leq n,m \\leq 10^6,3\\leq k_i \\leq 10^6,1 \\leq a_i \\leq 10^9,1 \\leq b_i,c_i \\leq 10^6$", "locale": "zh-CN"}}}
{"pid": "P8287", "type": "P", "difficulty": 4, "samples": [["3 3 1\n1 2\n2 3\n3 1\n1\n", "1\n"], ["5 4 2\n1 2\n2 3\n3 4\n2 5\n1 5\n", "Poor D!\n"], ["15 15 2\n2 1\n2 3\n2 9\n5 9\n4 5\n5 7\n6 7\n7 8\n7 11\n11 10\n10 9\n10 14\n14 15\n11 12\n12 13\n4 15\n", "3\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["二分", "并查集", "O2优化", "广度优先搜索 BFS", "Tarjan"], "title": "「DAOI R1」Flame", "background": ">尝尝天堂里的苹果有什么了不起，我要尝尝地狱里的苹果。", "description": "黑暗里有黑色的火焰，只有目光敏锐的人才可以捕捉到,\n\n借着这点卑微之光,走进地狱深处......\n\n欢迎来到地狱的审判之地。\n\n$ \\texttt{hhpq.} $ 将 D 押入了地狱的审判之地，D 必须在业火之城成功生成一座业火监狱之前逃离，所以他想知道还有多少秒时间。\n\n在这座业火之城中，共有 $n$ 个祭坛，共有 $m$ 条可以蔓延火苗的业火之路，且业火之路是双向连通。\n\n已知在这一座业火之城共有 $k$ 个火种已被点燃的业火祭坛，且从第一秒开始，火种将开始从被点燃的业火祭坛向可以蔓延且未被点燃的业火祭坛蔓延。\n\n当祭坛被点燃后，则会瞬间激活，和与之有路的祭坛连接业火圣壁。\n\n当存在一片由业火圣壁构成的封闭图形时，则业火监狱生成成功。\n\n### 简化题意\n给出一个 $n$ 个点，$m$ 条边的无向图，每一个点有一个标记，初始有 $k$ 个点的标记为 `1`（将给出这 $k$ 个点的编号），其余的点标记为 `0`。\n\n每一秒，对于每个标记为 `1` 的点，与它**有边相连**的点的标记都会变成 `1`。\n\n求最少需要多少秒，图中标记为 `1` 的点与其相邻的边可以构成一个简单环。\n\n**换言之，求最少多少秒后存在一个由 `1` 构成的集合形成简单环。**", "inputFormat": "第一行三个正整数：$n,m,k$；\n\n下面 $m$ 行，每行两个正整数：$x,y$（第 $x$ 座业火祭坛与第 $y$ 座业火祭坛有业火之路连接）；\n\n最后一行 $k$ 个正整数：已被点燃（拥有火种）的祭坛编号。", "outputFormat": "若可以逃离，输出 D 还有多少时间。\n\n反之若无法生成业火监狱，输出 ``` Poor D! ```。\n", "hint": "### 样例解释\n\n#### 样例1解释\n\n当时间到第一秒时，祭坛 $1$ 的火焰将蔓延到祭坛 $2$ 和 $3$，此时已经构成一个封闭图形了，故答案为 $1$。\n\n#### 样例2解释\n\n可以证明到此时是无法产生简单环的。\n\n### 数据规模\n\n| Subtask | $n\\leq$ | $m\\leq$ | $k\\leq$ | 分值 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $0$ | $10^6$ | $n-1$ | $10^4$ | $5$ |\n| $1$ | $10^6$ | $2\\times10^6$ | $1$ | $10$|\n| $2$ | $10$ | $45$ | $1$ | $5$ |\n| $3$ | $200$ | $500$ | $10$ | $10$ |\n| $4$| $2\\times 10^3$ | $5\\times 10^3$ | $50$ | $10$ |\n| $5$ | $5\\times10^5$ | $6\\times10^5$ | $500$ | $30$ |\n| $6$ | $10^6$ | $2\\times10^6$ | $10^4$ | $30$ |\n\n### 保证与约定\n\n保证数据无重边和自环；\n\n保证数据给定的图是一张无向连通图。\n\n### 帮助\n\n输入量较大，建议使用较为快速的读入方式。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DAOI R1」Flame", "background": ">尝尝天堂里的苹果有什么了不起，我要尝尝地狱里的苹果。", "description": "黑暗里有黑色的火焰，只有目光敏锐的人才可以捕捉到,\n\n借着这点卑微之光,走进地狱深处......\n\n欢迎来到地狱的审判之地。\n\n$ \\texttt{hhpq.} $ 将 D 押入了地狱的审判之地，D 必须在业火之城成功生成一座业火监狱之前逃离，所以他想知道还有多少秒时间。\n\n在这座业火之城中，共有 $n$ 个祭坛，共有 $m$ 条可以蔓延火苗的业火之路，且业火之路是双向连通。\n\n已知在这一座业火之城共有 $k$ 个火种已被点燃的业火祭坛，且从第一秒开始，火种将开始从被点燃的业火祭坛向可以蔓延且未被点燃的业火祭坛蔓延。\n\n当祭坛被点燃后，则会瞬间激活，和与之有路的祭坛连接业火圣壁。\n\n当存在一片由业火圣壁构成的封闭图形时，则业火监狱生成成功。\n\n### 简化题意\n给出一个 $n$ 个点，$m$ 条边的无向图，每一个点有一个标记，初始有 $k$ 个点的标记为 `1`（将给出这 $k$ 个点的编号），其余的点标记为 `0`。\n\n每一秒，对于每个标记为 `1` 的点，与它**有边相连**的点的标记都会变成 `1`。\n\n求最少需要多少秒，图中标记为 `1` 的点与其相邻的边可以构成一个简单环。\n\n**换言之，求最少多少秒后存在一个由 `1` 构成的集合形成简单环。**", "inputFormat": "第一行三个正整数：$n,m,k$；\n\n下面 $m$ 行，每行两个正整数：$x,y$（第 $x$ 座业火祭坛与第 $y$ 座业火祭坛有业火之路连接）；\n\n最后一行 $k$ 个正整数：已被点燃（拥有火种）的祭坛编号。", "outputFormat": "若可以逃离，输出 D 还有多少时间。\n\n反之若无法生成业火监狱，输出 ``` Poor D! ```。\n", "hint": "### 样例解释\n\n#### 样例1解释\n\n当时间到第一秒时，祭坛 $1$ 的火焰将蔓延到祭坛 $2$ 和 $3$，此时已经构成一个封闭图形了，故答案为 $1$。\n\n#### 样例2解释\n\n可以证明到此时是无法产生简单环的。\n\n### 数据规模\n\n| Subtask | $n\\leq$ | $m\\leq$ | $k\\leq$ | 分值 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $0$ | $10^6$ | $n-1$ | $10^4$ | $5$ |\n| $1$ | $10^6$ | $2\\times10^6$ | $1$ | $10$|\n| $2$ | $10$ | $45$ | $1$ | $5$ |\n| $3$ | $200$ | $500$ | $10$ | $10$ |\n| $4$| $2\\times 10^3$ | $5\\times 10^3$ | $50$ | $10$ |\n| $5$ | $5\\times10^5$ | $6\\times10^5$ | $500$ | $30$ |\n| $6$ | $10^6$ | $2\\times10^6$ | $10^4$ | $30$ |\n\n### 保证与约定\n\n保证数据无重边和自环；\n\n保证数据给定的图是一张无向连通图。\n\n### 帮助\n\n输入量较大，建议使用较为快速的读入方式。", "locale": "zh-CN"}}}
{"pid": "P8288", "type": "P", "difficulty": 6, "samples": [["3 0\n2 2 1\n2 3 1\n2 1 1\n", "3"], ["4 1\n3 2 1\n3 1 3\n3 4 2\n3 3 2\n1 2 1 3\n", "7"]], "limits": {"time": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["并查集", "树形 DP", "拓扑排序", "基环树"], "title": "「DAOI R1」Fireworks", "background": "> 俯首，满城灯火交辉。\n> \n> 回眸，漫天流星逆飞。", "description": "人们以前通常会放烟花，而每个烟花都有它本身的美观度。\n\n$ \\texttt{Iratis} $ 想要在户外放烟花，但是有烟花之间有一些关系：\n\n- 关系一：对于烟花 $ x $ ，有一个对应烟花 $ a_x $ ，若烟花 $ x $ 与烟花 $ a_x $ 一起燃放，就会使烟花 $ x $ 的美观度减少 $ b_x $ 。\n\n- 关系二：有一些烟花是一个系列，必须同时燃放，其中有一个是主烟花，**每个烟花只会属于一个系列**。\n\n特别地，若有一系列 $ S_1 $ （主烟花为 $ p_1 $ ） 。 $ p_1 $ 关系一所对应的烟花为系列 $ S_2 $ 中的烟花。而 $ S_1 $ 系列中的其他烟花与非 $ S_1,S_2 $ 系列中的烟花形成关系一。**那么对于这条关系一，它不会降低美观度。**\n\n$ \\texttt{Iratis} $ 家里有 $ n $ 个烟花，他希望选择其中的一些烟花燃放，使得这些**烟花的美观度总和**最大。", "inputFormat": "第一行包含两个整数 $ n,m $，分别描述烟花的个数和和关系二的个数。\n\n接下来 $ n $ 行，每行三个整数 $ v_i,a_i,b_i $ ，分别是这个烟花的美观度、关系一对应的烟花、关系一降低的美观度。\n\n最后 $ m $ 行，每行先读入两个数 $ p_i,k_i $，然后是 $ k_i $ 个数，表示这 $ k_i $ 个烟花是一个系列，编号为 $ p_i $ 的烟花为主烟花。", "outputFormat": "输出一行一个整数，表示烟花的美观度总和。", "hint": "### 样例解释\n#### 样例1解释\n\n烟花 $ 1,2,3 $ 一起燃放，最大美观度为 $ 2+2+2-1-1-1=3 $ 。\n\n#### 样例2解释\n\n烟花 $ 1,3,4 $ 一起燃放。\n\n由于 $ 1,3 $ 为同一系列且 $ 1 $ 为主烟花，所以 $ 3 $ 烟花的关系一不会生效。\n\n故总的美观度为 $ 3 \\times 3-2=7 $ 。\n\n### 数据规模\n\n**本题采用捆绑测试**\n\n| Subtask | $ m $  | 分值 |\n| :----------: | :----------: | :----------: |\n| $ 0 $ | $ =0 $ | $ 30 $ |\n| $ 1 $ | 无特殊限制 | $ 70 $ |\n\n对于 $ 100\\% $ 的数据，满足 $ 0 \\leq m \\leq n \\leq 5 \\times 10^5,0 \\leq b_i \\leq v_i \\leq 10^{12},1 \\leq a_i \\leq n,a_i \\neq i $ 。 ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DAOI R1」Fireworks", "background": "> 俯首，满城灯火交辉。\n> \n> 回眸，漫天流星逆飞。", "description": "人们以前通常会放烟花，而每个烟花都有它本身的美观度。\n\n$ \\texttt{Iratis} $ 想要在户外放烟花，但是有烟花之间有一些关系：\n\n- 关系一：对于烟花 $ x $ ，有一个对应烟花 $ a_x $ ，若烟花 $ x $ 与烟花 $ a_x $ 一起燃放，就会使烟花 $ x $ 的美观度减少 $ b_x $ 。\n\n- 关系二：有一些烟花是一个系列，必须同时燃放，其中有一个是主烟花，**每个烟花只会属于一个系列**。\n\n特别地，若有一系列 $ S_1 $ （主烟花为 $ p_1 $ ） 。 $ p_1 $ 关系一所对应的烟花为系列 $ S_2 $ 中的烟花。而 $ S_1 $ 系列中的其他烟花与非 $ S_1,S_2 $ 系列中的烟花形成关系一。**那么对于这条关系一，它不会降低美观度。**\n\n$ \\texttt{Iratis} $ 家里有 $ n $ 个烟花，他希望选择其中的一些烟花燃放，使得这些**烟花的美观度总和**最大。", "inputFormat": "第一行包含两个整数 $ n,m $，分别描述烟花的个数和和关系二的个数。\n\n接下来 $ n $ 行，每行三个整数 $ v_i,a_i,b_i $ ，分别是这个烟花的美观度、关系一对应的烟花、关系一降低的美观度。\n\n最后 $ m $ 行，每行先读入两个数 $ p_i,k_i $，然后是 $ k_i $ 个数，表示这 $ k_i $ 个烟花是一个系列，编号为 $ p_i $ 的烟花为主烟花。", "outputFormat": "输出一行一个整数，表示烟花的美观度总和。", "hint": "### 样例解释\n#### 样例1解释\n\n烟花 $ 1,2,3 $ 一起燃放，最大美观度为 $ 2+2+2-1-1-1=3 $ 。\n\n#### 样例2解释\n\n烟花 $ 1,3,4 $ 一起燃放。\n\n由于 $ 1,3 $ 为同一系列且 $ 1 $ 为主烟花，所以 $ 3 $ 烟花的关系一不会生效。\n\n故总的美观度为 $ 3 \\times 3-2=7 $ 。\n\n### 数据规模\n\n**本题采用捆绑测试**\n\n| Subtask | $ m $  | 分值 |\n| :----------: | :----------: | :----------: |\n| $ 0 $ | $ =0 $ | $ 30 $ |\n| $ 1 $ | 无特殊限制 | $ 70 $ |\n\n对于 $ 100\\% $ 的数据，满足 $ 0 \\leq m \\leq n \\leq 5 \\times 10^5,0 \\leq b_i \\leq v_i \\leq 10^{12},1 \\leq a_i \\leq n,a_i \\neq i $ 。 ", "locale": "zh-CN"}}}
{"pid": "P8289", "type": "P", "difficulty": 4, "samples": [["5\n#define BEGIN {\n#define END }\n#define INTEGER int\nclass C BEGIN INTEGER x; END;\nINTEGER main() BEGIN C c; END\n", "\n\n\nclass C { int x; };\nint main() { C c; }\n"], ["见附件中的 preprocessor/preprocessor2.in", "见附件中的 preprocessor/preprocessor2.ans"], ["见附件中的 preprocessor/preprocessor3.in", "见附件中的 preprocessor/preprocessor3.ans"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["模拟", "字符串", "搜索", "各省省选", "2022", "O2优化", "深度优先搜索 DFS"], "title": "[省选联考 2022] 预处理器", "background": "", "description": "宏是 C/C++ 语言的一项特性，它根据预先定义的规则进行文本替换（也被称为 “宏展开”），能够实现定义常量、简化代码重复输入等功能。例如：\n\n```cpp\n#define PI 3.14159\ndouble area = PI * r * r;\n```\n\n以上代码经过宏展开后变为：\n\n```cpp\n\ndouble area = 3.14159 * r * r;\n```\n\n其中，宏定义命令变成了空行，而其他行中的宏被展开成了规则定义的文本。\n\nC/C++ 语言代码在编译时对宏的处理由**预处理器**完成。你的任务是实现一个简化版的预处理器，要求如下：\n\n- 代码由**行**组成，每行除行末的换行符外，均由可打印 ASCII 字符（ASCII 码范围 $32\\sim 126$）组成。每行要么是**预处理命令**（以 `#` 开头），要么是**普通文本**（其他情况）。\n\n- 预处理器逐行处理代码，\n\t- 如果是预处理命令，执行该命令，并输出一个空行。\n    - 如果是普通文本，对其进行宏展开并输出结果。\n- 预处理命令有两种，分别是宏定义命令 `#define` 和取消宏定义命令 `#undef`。\n\t- 宏定义命令的格式为 `#define <name> <content>`，其中第一部分 `#define` 是命令名，第二部分 `<name>` 是要定义的宏的名字，第三部分 `<content>` 是要定义的宏的展开内容。\n    - 取消宏定义命令的格式为 `#undef <name>`，其中第一部分 `#undef` 是命令名，第二部分 `<name>` 是要取消的宏的名字。\n    \n    以上两种预处理命令中，相邻两部分之间都严格用一个空格分隔。`<name>` 是由大小写字母和数字以及下划线组成的**标识符**（一个或多个字符），`<content>` 可以包含任意可打印 ASCII 字符（零个或多个字符）。一个宏定义的**有效范围**是从它定义所在行开始到后续最近的宏名匹配的取消定义所在行为止（如果没有对应的取消定义，则有效范围一直覆盖到文件结束）。\n    \n对普通文本进行宏展开时，将一行文本中每段**连续极长**的大小写字母和数字以及下划线视为标识符（而不是其中一部分），其余为**其他字符**。从左到右依次对文本中的标识符进行宏展开：\n    \n1. 如果该标识符是有效的宏名，则用对应的展开内容替换它，此时该宏名进入正在展开的状态，直到本流程结束；否则原样保留宏名。例如，若宏 `A` 定义为 `b`，则文本 `A` 展开结果为 `b`（发生替换），文本 `B` 展开结果仍然为 `B`（未定义，不替换），文本 `AA` 展开结果仍然为 `AA`（`AA` 是不同于 `A` 的另一个标识符，未定义），而文本 `A*B` 展开结果为 `b*B`。\n    \n2. 替换发生后，如果展开内容中包含标识符，重复应用以上的展开操作，称为 “多次展开”。例如，若宏 `A` 定义为 `B`，宏 `B` 定义为 `c`，则文本 `A` 的展开结果为 `c`。\n    \n3. 如果待展开的宏名与正在进行展开的某个宏名相同，称为 “递归展开”，此时该宏名不再展开。本规则用来防止无限递归展开。例如，若宏 `A` 定义为 `B+a`，宏 `B` 定义为 `A+b`，则文本 `A` 展开结果为 `A+b+a`，由于最初的 `A` 处于正在展开状态，因此 `A+b+a` 里的 `A` 不再展开。\n\n4. 其他字符原样保留。\n\n注意：出于简化的目的，本题的要求与 C/C++ 语言标准里的描述不完全一致，请以上面的要求为准。最明显的区别是本题只有标识符和其他字符两类词法单元，没有数值、字符串、注释等。", "inputFormat": "输入的第一行包含一个正整数 $n$，表示要处理的代码行数。\n\n接下来的 $n$ 行是要处理的代码。", "outputFormat": "输出 $n$ 行，为输入逐行预处理后的结果。", "hint": "**【数据范围】**\n\n对 $20\\%$ 的数据，不会出现宏定义命令 `#define` 和宏取消定义命令 `#undef`。\n\n对另外 $20\\%$ 的数据，不会出现多次展开的情况，且不会出现宏取消定义命令 `#undef`。\n\n对另外 $20\\%$ 的数据，不会出现多次展开的情况。\n\n对另外 $20\\%$ 的数据，不会出现递归展开的情况。\n\n对其余数据，无特殊限制。\n\n对 $100\\%$ 的数据，$n \\leq 100$，输入的每行字符数都不超过 $100$，且保证输出的每行字符数都不超过 $1000$（字符数均不计行末换行符）。保证输入数据中的预处理命令都是合法的，包含但不限于：\n\n- `#` 字符只会出现在预处理命令所在行的第一个字符的位置，其他任何位置（包括预处理命令和普通文本）都不会出现 `#` 字符。\n- 宏定义和取消定义命令的格式是正确的，严格遵循题面所描述的格式。\n- 同一个宏在取消定义之前不会被再次定义。\n- 要取消定义的宏在之前被定义过且还没有被取消过。\n\n也就是说，**你不需要做任何语法和语义的错误检查**。\n\n**【提示】**\n\n本题进行输入时建议使用 C++ 语言的按行读入字符串功能，示例如下：\n\n```cpp\n#include <iostream>\n#include <string>\nusing namespace std;\nstring line;\n// 从 cin 读入一行，放入 line 中（换行符被舍弃）\ngetline(cin, line);\n```\n\n也可以使用 C 语言提供的 `fgets` 函数，示例如下：\n\n```cpp\n#include <stdio.h>\n#define MAX_LEN 200\nchar line[MAX_LEN];\n// 从 stdin 读入一行，放入 line 中（包含换行符）\nfgets(line, MAX_LEN, stdin);\n```\n\n**注意**：在读取行数 $n$ 之后可能需要额外读取一行以忽略其后的换行符。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[省选联考 2022] 预处理器", "background": "", "description": "宏是 C/C++ 语言的一项特性，它根据预先定义的规则进行文本替换（也被称为 “宏展开”），能够实现定义常量、简化代码重复输入等功能。例如：\n\n```cpp\n#define PI 3.14159\ndouble area = PI * r * r;\n```\n\n以上代码经过宏展开后变为：\n\n```cpp\n\ndouble area = 3.14159 * r * r;\n```\n\n其中，宏定义命令变成了空行，而其他行中的宏被展开成了规则定义的文本。\n\nC/C++ 语言代码在编译时对宏的处理由**预处理器**完成。你的任务是实现一个简化版的预处理器，要求如下：\n\n- 代码由**行**组成，每行除行末的换行符外，均由可打印 ASCII 字符（ASCII 码范围 $32\\sim 126$）组成。每行要么是**预处理命令**（以 `#` 开头），要么是**普通文本**（其他情况）。\n\n- 预处理器逐行处理代码，\n\t- 如果是预处理命令，执行该命令，并输出一个空行。\n    - 如果是普通文本，对其进行宏展开并输出结果。\n- 预处理命令有两种，分别是宏定义命令 `#define` 和取消宏定义命令 `#undef`。\n\t- 宏定义命令的格式为 `#define <name> <content>`，其中第一部分 `#define` 是命令名，第二部分 `<name>` 是要定义的宏的名字，第三部分 `<content>` 是要定义的宏的展开内容。\n    - 取消宏定义命令的格式为 `#undef <name>`，其中第一部分 `#undef` 是命令名，第二部分 `<name>` 是要取消的宏的名字。\n    \n    以上两种预处理命令中，相邻两部分之间都严格用一个空格分隔。`<name>` 是由大小写字母和数字以及下划线组成的**标识符**（一个或多个字符），`<content>` 可以包含任意可打印 ASCII 字符（零个或多个字符）。一个宏定义的**有效范围**是从它定义所在行开始到后续最近的宏名匹配的取消定义所在行为止（如果没有对应的取消定义，则有效范围一直覆盖到文件结束）。\n    \n对普通文本进行宏展开时，将一行文本中每段**连续极长**的大小写字母和数字以及下划线视为标识符（而不是其中一部分），其余为**其他字符**。从左到右依次对文本中的标识符进行宏展开：\n    \n1. 如果该标识符是有效的宏名，则用对应的展开内容替换它，此时该宏名进入正在展开的状态，直到本流程结束；否则原样保留宏名。例如，若宏 `A` 定义为 `b`，则文本 `A` 展开结果为 `b`（发生替换），文本 `B` 展开结果仍然为 `B`（未定义，不替换），文本 `AA` 展开结果仍然为 `AA`（`AA` 是不同于 `A` 的另一个标识符，未定义），而文本 `A*B` 展开结果为 `b*B`。\n    \n2. 替换发生后，如果展开内容中包含标识符，重复应用以上的展开操作，称为 “多次展开”。例如，若宏 `A` 定义为 `B`，宏 `B` 定义为 `c`，则文本 `A` 的展开结果为 `c`。\n    \n3. 如果待展开的宏名与正在进行展开的某个宏名相同，称为 “递归展开”，此时该宏名不再展开。本规则用来防止无限递归展开。例如，若宏 `A` 定义为 `B+a`，宏 `B` 定义为 `A+b`，则文本 `A` 展开结果为 `A+b+a`，由于最初的 `A` 处于正在展开状态，因此 `A+b+a` 里的 `A` 不再展开。\n\n4. 其他字符原样保留。\n\n注意：出于简化的目的，本题的要求与 C/C++ 语言标准里的描述不完全一致，请以上面的要求为准。最明显的区别是本题只有标识符和其他字符两类词法单元，没有数值、字符串、注释等。", "inputFormat": "输入的第一行包含一个正整数 $n$，表示要处理的代码行数。\n\n接下来的 $n$ 行是要处理的代码。", "outputFormat": "输出 $n$ 行，为输入逐行预处理后的结果。", "hint": "**【数据范围】**\n\n对 $20\\%$ 的数据，不会出现宏定义命令 `#define` 和宏取消定义命令 `#undef`。\n\n对另外 $20\\%$ 的数据，不会出现多次展开的情况，且不会出现宏取消定义命令 `#undef`。\n\n对另外 $20\\%$ 的数据，不会出现多次展开的情况。\n\n对另外 $20\\%$ 的数据，不会出现递归展开的情况。\n\n对其余数据，无特殊限制。\n\n对 $100\\%$ 的数据，$n \\leq 100$，输入的每行字符数都不超过 $100$，且保证输出的每行字符数都不超过 $1000$（字符数均不计行末换行符）。保证输入数据中的预处理命令都是合法的，包含但不限于：\n\n- `#` 字符只会出现在预处理命令所在行的第一个字符的位置，其他任何位置（包括预处理命令和普通文本）都不会出现 `#` 字符。\n- 宏定义和取消定义命令的格式是正确的，严格遵循题面所描述的格式。\n- 同一个宏在取消定义之前不会被再次定义。\n- 要取消定义的宏在之前被定义过且还没有被取消过。\n\n也就是说，**你不需要做任何语法和语义的错误检查**。\n\n**【提示】**\n\n本题进行输入时建议使用 C++ 语言的按行读入字符串功能，示例如下：\n\n```cpp\n#include <iostream>\n#include <string>\nusing namespace std;\nstring line;\n// 从 cin 读入一行，放入 line 中（换行符被舍弃）\ngetline(cin, line);\n```\n\n也可以使用 C 语言提供的 `fgets` 函数，示例如下：\n\n```cpp\n#include <stdio.h>\n#define MAX_LEN 200\nchar line[MAX_LEN];\n// 从 stdin 读入一行，放入 line 中（包含换行符）\nfgets(line, MAX_LEN, stdin);\n```\n\n**注意**：在读取行数 $n$ 之后可能需要额外读取一行以忽略其后的换行符。", "locale": "zh-CN"}}}
{"pid": "P8290", "type": "P", "difficulty": 6, "samples": [["3 1\n2 3\n3 5\n4 6\n1 2\n1 3\n", "14\n78\n"], ["见附件中的 tree/tree2.in", "见附件中的 tree/tree2.ans"], ["见附件中的 tree/tree3.in", "见附件中的 tree/tree3.ans"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "各省省选", "2022", "Special Judge", "O2优化", "树形 DP", "拉格朗日插值法"], "title": "[省选联考 2022] 填树", "background": "原题时限为 2s。", "description": "有一棵 $n$ 个节点的无根树，刚开始树上每个节点的权值均为 $0$。KK 想对这棵树进行一些修改，他会任选一个节点作为初始的当前节点，然后重复以下动作：\n\n1. 将当前节点 $i$ 的权值修改为一个**正整数** $x$，需满足 $l_i \\leq x \\leq r_i$。其中 $l_i, r_i$ 是输入中给出的两个正整数。\n2. 结束修改过程，或移动到一个与当前节点相邻的权值为 $0$ 的节点（如果不存在这样的节点，则必须结束修改过程）。\n\n现在 KK 有两个问题：\n\n1. 在修改结束后，可以得到多少棵不同的树，满足树上**非零权值**的最大值和最小值的差小于等于 $K$？其中 $K$ 是输入中给出的一个正整数。\n\n2. 这些满足条件的树的权值之和为多少？（树的权值定义为这棵树上所有节点的权值之和）\n\n你需要输出这两个问题的答案模 $10^9 + 7$。我们认为两棵树不同当且仅当至少存在一个节点的权值不同。\n\n温馨提示：\n\n1. KK 至少会修改一个节点（初始节点）。\n2. 实质上 KK 会修改树上的任意一条路径，最后需要满足这条路径上的点的权值最大值和最小值之差小于等于 $K$。", "inputFormat": "第一行两个正整数 $n, K$，表示节点数和权值差的最大值。\n\n接下来 $n$ 行，每行两个正整数 $l_i, r_i$，表示第 $i$ 个节点修改后权值的最小值和最大值。\n\n接下来 $n - 1$ 行，每行两个正整数 $u_i, v_i$，表示节点 $u_i$ 和 $v_i$ 之间有一条边。数据保证形成一棵树。", "outputFormat": "输出两行，每行一个整数，分别表示第一问和第二问的答案模 $10^9 + 7$ 的值。注意，如果你不打算回答第二问，请在第二行任意输出一个整数。如果输出文件只有一行，则可能会因格式不符合要求被判 $0$ 分。", "hint": "**【样例解释 #1】**\n\n| | $1$ | $2$ | $3$ | $4$ | $5$ | $6$ | $7$ | $8$ | $9$ | $10$ | $11$ | $12$ | $13$ | $14$ |\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n| 节点 $1$ | $2$ | $3$ | $2$ | $3$ | $3$ | $3$ | $3$ | $3$ | $0$ | $0$ | $0$ | $0$ | $0$ | $0$ |\n| 节点 $2$ | $0$ | $0$ | $3$ | $3$ | $4$ | $0$ | $4$ | $3$ | $3$ | $4$ | $5$ | $0$ | $0$ | $0$ |\n| 节点 $3$ | $0$ | $0$ | $0$ | $0$ | $0$ | $4$ | $4$ | $4$ | $0$ | $0$ | $0$ | $4$ | $5$ | $6$ |\n\n表格中列出了全部 $14$ 棵满足条件的树，将这些树的权值加起来为 $78$。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 200$，$1 \\leq l_i \\leq r_i \\leq {10}^9$，$1 \\leq K \\leq {10}^9$。\n\n| 测试点 | $n \\leq $ | $r_i, K \\leq$ | 其他限制 |\n|:-:|:-:|:-:|:-:|\n| $1$ | $5$ | $10$ | 无 |\n| $2$ | $30$ | $10^9$ | 无 |\n| $3$ | $30$ | $10^9$ | 无 |\n| $4$ | $30$ | $500$ | 无 |\n| $5$ | $200$ | $200000$ | 无 |\n| $6$ | $200$ | $200000$ | 无 |\n| $7$ | $200$ | $10^9$ | A |\n| $8$ | $200$ | $10^9$ | A |\n| $9$ | $200$ | $10^9$ | 无 |\n| $10$ | $200$ | $10^9$ | 无 |\n\n特殊限制 A：所有点构成一条链, 编号为 $i$ 的点和编号为 $i + 1$ 的点之间有连边\n\n**【评分方式】**\n\n本题共 $10$ 个测试点，每个测试点 $10$ 分。其中回答正确第一问可得 $7$ 分，回答正确第二问可得 $3$ 分。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[省选联考 2022] 填树", "background": "原题时限为 2s。", "description": "有一棵 $n$ 个节点的无根树，刚开始树上每个节点的权值均为 $0$。KK 想对这棵树进行一些修改，他会任选一个节点作为初始的当前节点，然后重复以下动作：\n\n1. 将当前节点 $i$ 的权值修改为一个**正整数** $x$，需满足 $l_i \\leq x \\leq r_i$。其中 $l_i, r_i$ 是输入中给出的两个正整数。\n2. 结束修改过程，或移动到一个与当前节点相邻的权值为 $0$ 的节点（如果不存在这样的节点，则必须结束修改过程）。\n\n现在 KK 有两个问题：\n\n1. 在修改结束后，可以得到多少棵不同的树，满足树上**非零权值**的最大值和最小值的差小于等于 $K$？其中 $K$ 是输入中给出的一个正整数。\n\n2. 这些满足条件的树的权值之和为多少？（树的权值定义为这棵树上所有节点的权值之和）\n\n你需要输出这两个问题的答案模 $10^9 + 7$。我们认为两棵树不同当且仅当至少存在一个节点的权值不同。\n\n温馨提示：\n\n1. KK 至少会修改一个节点（初始节点）。\n2. 实质上 KK 会修改树上的任意一条路径，最后需要满足这条路径上的点的权值最大值和最小值之差小于等于 $K$。", "inputFormat": "第一行两个正整数 $n, K$，表示节点数和权值差的最大值。\n\n接下来 $n$ 行，每行两个正整数 $l_i, r_i$，表示第 $i$ 个节点修改后权值的最小值和最大值。\n\n接下来 $n - 1$ 行，每行两个正整数 $u_i, v_i$，表示节点 $u_i$ 和 $v_i$ 之间有一条边。数据保证形成一棵树。", "outputFormat": "输出两行，每行一个整数，分别表示第一问和第二问的答案模 $10^9 + 7$ 的值。注意，如果你不打算回答第二问，请在第二行任意输出一个整数。如果输出文件只有一行，则可能会因格式不符合要求被判 $0$ 分。", "hint": "**【样例解释 #1】**\n\n| | $1$ | $2$ | $3$ | $4$ | $5$ | $6$ | $7$ | $8$ | $9$ | $10$ | $11$ | $12$ | $13$ | $14$ |\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n| 节点 $1$ | $2$ | $3$ | $2$ | $3$ | $3$ | $3$ | $3$ | $3$ | $0$ | $0$ | $0$ | $0$ | $0$ | $0$ |\n| 节点 $2$ | $0$ | $0$ | $3$ | $3$ | $4$ | $0$ | $4$ | $3$ | $3$ | $4$ | $5$ | $0$ | $0$ | $0$ |\n| 节点 $3$ | $0$ | $0$ | $0$ | $0$ | $0$ | $4$ | $4$ | $4$ | $0$ | $0$ | $0$ | $4$ | $5$ | $6$ |\n\n表格中列出了全部 $14$ 棵满足条件的树，将这些树的权值加起来为 $78$。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 200$，$1 \\leq l_i \\leq r_i \\leq {10}^9$，$1 \\leq K \\leq {10}^9$。\n\n| 测试点 | $n \\leq $ | $r_i, K \\leq$ | 其他限制 |\n|:-:|:-:|:-:|:-:|\n| $1$ | $5$ | $10$ | 无 |\n| $2$ | $30$ | $10^9$ | 无 |\n| $3$ | $30$ | $10^9$ | 无 |\n| $4$ | $30$ | $500$ | 无 |\n| $5$ | $200$ | $200000$ | 无 |\n| $6$ | $200$ | $200000$ | 无 |\n| $7$ | $200$ | $10^9$ | A |\n| $8$ | $200$ | $10^9$ | A |\n| $9$ | $200$ | $10^9$ | 无 |\n| $10$ | $200$ | $10^9$ | 无 |\n\n特殊限制 A：所有点构成一条链, 编号为 $i$ 的点和编号为 $i + 1$ 的点之间有连边\n\n**【评分方式】**\n\n本题共 $10$ 个测试点，每个测试点 $10$ 分。其中回答正确第一问可得 $7$ 分，回答正确第二问可得 $3$ 分。", "locale": "zh-CN"}}}
{"pid": "P8291", "type": "P", "difficulty": 7, "samples": [["2\n4 15\nbuiltin_clz\nbuiltin_ctz\njinkela\nOrzTourist\nbuiltin_clz MengXin QiuZhu\nbuiltin_ctz builtin_clz louxia\njinkela builtin_ctz louxia\nbuiltin_ctz builtin_clz loushang\nbuiltin_clz BieMoZheng YaoXueShu\nOrzTourist builtin_clz louxia\nOrzTourist OrzTourist louxia\nbuiltin_clz Iam Angry!\nbuiltin_clz builtin_clz loushang\nbuiltin_clz builtin_clz louxia\nbuiltin_clz builtin_clz loushang\nbuiltin_clz builtin_clz louxia\nbuiltin_ctz Xue Shu\njinkela Xue Shu\nOrzTourist Xue Shu\n1 9\nbuiltin_clz\nbuiltin_clz builtin_clz loushang\nbuiltin_clz builtin_clz loushang\nbuiltin_clz builtin_clz louxia\nbuiltin_clz builtin_clz Loushang\nbuiltin_clz builtin_clz LOUSHANG\nbuiltin_clz Builtin_clz loushang\nbuiltin_clz loushang louxia\nbuiltin_clz builtin_clz builtin_clz\nbuiltin_clz loushang builtin_clz\n", "9\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15\n3\n8 1 2 7 9 3 6 4 5\n"], ["见附件中的 community/community2.in", "见附件中的 community/community2.ans"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["各省省选", "2022", "网络流", "Special Judge", "O2优化"], "title": "[省选联考 2022] 学术社区", "background": "**小 I 的温馨提示：在题目描述中有形式化的题面，你可以选择跳过题目背景。同时请仔细将本题的除题目背景以外的所有内容进行完整阅读后再进行做题。**\n\n小 I 是一个喜欢 OI 的选手，不过，与其说小 I 喜欢 OI，不如说小 I 喜欢的是他最经常使用的 OJ——FCCOJ——上的趣味功能：学术社区。虽说名字叫学术社区，但小 I 和网友们能够谈论的东西远不止学术。每天学术社区里总会出现不少吸引小 I 注意的帖子。今天小 I 在学术社区冲浪时发现了一个这样的帖子：\n\n> `builtin_clz`：萌新求助，学术社区这题，本机 AC 提交 RE\n> \n> `builtin_ctz`：`builtin_clz` 楼下\n> \n> `jinkela`：`builtin_ctz` 楼下\n> \n> `builtin_ctz`：`builtin_clz` 楼上\n> \n> `builtin_clz`：能不能别魔怔了，大家正经回答问题\n> \n> `OrzTourist`：`builtin_clz` 楼下\n> \n> `OrzTourist`：`OrzTourist` 楼下\n> \n> `builtin_clz`：怎么没有人回答问题，我生气了！\n> \n> `builtin_clz`：`builtin_clz` 楼上\n> \n> `builtin_clz`：`builtin_clz` 楼下\n> \n> `builtin_clz`：`builtin_clz` 楼上\n> \n> `builtin_clz`：`builtin_clz` 楼下\n> \n> ……\n\n虽然这个名叫 `builtin_clz` 的网友因为没有人回答他的学术问题被激怒了，但这个有趣的发言方式让小 I 乐呵了许久，这说明人类的悲欢并不相通。不过当小 I 刷新界面想要往下浏览大家的回复时，却发现学术社区的管理员因为这个帖子过于灌水把它删除了。\n\n为了恢复这个有趣的帖子，小 I 对着网页缓存倒腾了许久，还原出了这个帖子的每条消息。然而因为神秘原因，消息的顺序被打乱了，且缓存中没有每条消息发送的时间，因而小 I 没有办法还原原始帖子中消息的顺序。\n\n秉承 “遇到困难睡大觉” 精神的小 I 决定随便给帖子里的消息排个顺序，不过深受 “`XXX` 楼上” “`XXX` 楼下” 这种发言形式吸引的小 I 还是希望重排之后有尽可能多的这种形式的消息的表达是符合帖子的实际情况的。然而小 I 是一个只会水社区不会做题的 OI 选手，所以小 I 求助于你。\n\n当然了，小 I 知道直接将帖子中的原始信息丢给你对你来说是不方便的，所以他对信息进行了一些规范化处理，详见题目描述中的形式化题意。**同时由于学术社区的特殊规定，帖子中的消息满足一定特殊限制，详见题目描述最后。**", "description": "**以下涉及的所有字符串判等操作都对大小写敏感，例如 `1oushang`、`Loushang`、`LOUSHANG` 是互不相同的字符串。**\n\n小 I 正在整理学术社区中的一个帖子。帖子中一共有 $N$ 个网友发过消息，他们的网名分别为 $n_1, n_2, \\ldots, n_N$。帖子中总共有 $M$ 条消息，对于第 $i$ 条消息，我们用三个字符串 $s_{i,1}, s_{i,2}, s_{i,3}$ 构成的三元组描述它，其中 $s_{i,1}$ 表示这条消息发出者的网名，而 $s_{i,2}$ 和 $s_{i,3}$ 描述这条消息的内容。\n\n对于第 $i$ 条消息，我们通过如下方式定义其属于**楼下型消息**、**楼上型消息**、**学术型消息**中的哪一种：\n\n- 若字符串 $s_{i, 3}$ 为 `louxia`，且 $s_{i, 2}$ 恰好与给出的某个网名相同（注意 $s_{i,2} = s_{i,1}$ 是允许的），则称这条消息是**楼下型消息**，$s_{i,2}$ 对应这条消息提到的网友；\n- 若字符串 $s_{i,3}$ 为 `loushang`，且 $s_{i,2}$ 恰好与给出的某个网名相同（注意 $s_{i,2} = s_{i,1}$ 是允许的），则称这条消息是**楼上型消息**，$s_{i,2}$ 对应这条消息提到的网友；\n- 若以上两个条件都不满足，则称这条消息是**学术消息**。\n\n定义一个对所有消息的重排方案为一个 $1$ 到 $M$ 的排列 $a_1, a_2, a_3, \\ldots, a_M$，表示第一条消息是 $(s_{a_1,1}, s_{a_1,2}, s_{a_1,3})$，第二条消息是 $(s_{a_2,1}, s_{a_2,2}, s_{a_2,3})$，依此类推。\n\n对于一个重排方案 $a_1, a_2, a_3, \\ldots, a_M$ 中的第 $i$（$1 \\le i \\le M$）条消息 $(s_{a_i,1}, s_{a_i,2}, s_{a_i,3})$，如下定义其是否是**符合实际情况的**：\n\n- 若这条消息是**楼下型消息**，则这条消息是**符合实际情况的**当且仅当 $i \\ne 1$ 且 $s_{a_{i - 1}, 1} = s_{a_i, 2}$，即上一条消息存在且它的发出者与这条消息提到的网友一致。\n- 若这条消息是**楼上型消息**，则这条消息是**符合实际情况的**当且仅当 $i \\ne M$ 且 $s_{a_{i + 1}, 1} = s_{a_i, 2}$，即下一条消息存在且它的发出者与这条消息提到的网友一致。\n- 若这条消息是**学术消息**，则无论如何这条消息一定不是符合实际情况的，这是因为小 I 只想灌水不想学术。\n\n在以上定义下，小 I 希望找到一个重排方案，使得该重排方案中符合实际情况的消息数量最多。你需要帮他找到这个方案以及这个方案中符合实际情况的消息数量。\n\n**为了方便你的解题，小 I 还告诉了你帖子中消息的一个特殊限制：因为学术社区会禁言在社区中只灌水不学术的人，所以在小 I 给出的帖子里，每一个在帖子中发过言的人都一定会在帖子中发出至少一条学术消息。**", "inputFormat": "**本题有多组测试数据**。第一行一个整数 $T$ 表示测试数据组数，接下来分别输入 $T$ 组数据。\n\n对于每组测试数据，第一行两个整数 $N, M$ 分别表示帖子中发过消息的网友数量以及帖子的消息数量。\n\n接下来 $N$ 行每行一个字符串 $n$ 表示在帖子中发过消息的一个网友的网名。保证每个测试数据中输入的 $N$ 个网友的网名两两不同。\n\n接下来 $M$ 行每行三个字符串 $s_1, s_2, s_3$ 描述一条消息，相邻的字符串之间用一个空格分隔，其中 $s_1$ 一定与输入中某个网友的网名相等。\n\n输入的所有字符串仅由大小写英文字母、下划线（`_`）、英文问号（`?`）、英文感叹号（`!`）和英文句号（`.`）构成，且长度不超过 $12$。\n\n对于每组测试数据，保证输入的 $N$ 个网名都发出过至少一条消息，**且至少发出过一条学术消息**。\n\n同一组测试数据中可能存在多条消息内容完全一致，此时应将他们视为**多条**消息。", "outputFormat": "对于每组测试数据输出两行。\n\n第一行输出一个非负整数表示所有重排方案中最大的符合实际情况的消息数量。\n\n第二行输出 $M$ 个整数 $a_1, a_2, \\ldots, a_m$，表示符合实际情况的消息最多的重排方案。\n\n若有多种合法的重排方案，**输出任意一个即可**。", "hint": "**【样例解释 #1】**\n\n第一个测试数据与题目背景中给出的例子基本一致，而不同的点在于：为了满足每个人至少发出一条学术消息的要求，在该组数据输入的最后有几条额外的学术消息。\n\n第二个测试数据中，输入的前两条消息是楼上型消息，第三条消息是楼下型消息，其他消息是学术消息。\n\n**【样例 #3】**\n\n见附件中的 `community/community3.in` 与 `community/community3.ans`。\n\n该组样例满足数据范围中的特殊性质 A、特殊性质 B、特殊性质 C。\n\n**【样例 #4】**\n\n见附件中的 `community/community4.in` 与 `community/community4.ans`。\n\n该组样例满足数据范围中的特殊性质 C。\n\n**【数据范围】**\n\n设 $\\sum M$ 为单个测试点中所有测试数据的 $M$ 的和。\n\n对于所有测试点，$1 \\le T \\le 100$，$1 \\le N \\le M \\le 77777$，$1 \\le \\sum M \\le 2.5 \\times {10}^5$。\n\n| $T \\le$ | $M \\le$ | $\\sum M \\le$ | 测试点编号 | 特殊性质 A | 特殊性质 B | 特殊性质 C |\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n| $5$ | $10$ | $50$ | $1$ | 无 | 无 | 无 |\n| $10$ | $16$ | $160$ | $2$ | 无 | 无 | 无 |\n| $30$ | $2222$ | $15000$ | $3 \\sim 4$ | 有 | 有 | 有 |\n| $30$ | $2222$ | $15000$ | $5 \\sim 6$ | 有 | 无 | 有 |\n| $30$ | $2222$ | $15000$ | $7 \\sim 9$ | 无 | 有 | 有 |\n| $30$ | $2222$ | $15000$ | $10 \\sim 11$ | 无 | 无 | 有 |\n| $30$ | $2222$ | $15000$ | $12 \\sim 13$ | 无 | 无 | 无 |\n| $100$ | $77777$ | $2.5 \\times {10}^5$ | $14 \\sim 15$ | 有 | 有 | 有 |\n| $100$ | $77777$ | $2.5 \\times {10}^5$ | $16$ | 有 | 无 | 有 |\n| $100$ | $77777$ | $2.5 \\times {10}^5$ | $17 \\sim 19$ | 无 | 有 | 有 |\n| $100$ | $77777$ | $2.5 \\times {10}^5$ | $20 \\sim 22$ | 无 | 无 | 有 |\n| $100$ | $77777$ | $2.5 \\times {10}^5$ | $23 \\sim 25$ | 无 | 无 | 无 |\n\n**注意：为了阅读方便，测试点编号在表格中的第四列。**\n\n特殊性质 A：没有楼上型消息。**注意：这不意味着 $\\bm{s_3}$ 不等于 `loushang`。**\n\n特殊性质 B：对于每组测试数据，存在一个重排方案，使得每一条楼上型消息和楼下型消息都是符合实际情况的。\n\n特殊性质 C：对于每组测试数据，若存在一条消息是 $s_1$ $s_2$ `loushang`，其中 $s_1, s_2$ 为任意字符串，则该组数据中一定不存在一条消息是 $s_2$ $s_1$ `louxia`。\n\n**【评分方式】**\n\n若一个测试点内所有测试数据的符合实际情况的消息数量都正确，你将获得该测试点 $50 \\%$ 的分数；在此基础上，若一个测试点内所有测试数据的重排方案都正确，你将获得该测试点的所有分数。需要注意的是，**如果你只希望获得 $\\bm{50 \\%}$ 的分数，你也要保证在每组测试数据的第二行输出一个 $\\bm{1}$ 到 $\\bm{M}$ 的排列，否则实际分数与期望分数可能出现偏差**。\n\n**【提示】**\n\n因为这对你可能很重要，所以小 I 再一次强调：**因为学术社区会禁言在社区中只灌水不学术的人，所以在小 I 给出的帖子里，每一个在帖子中发过言的人都一定会在帖子中发出至少一条学术消息**。\n\n本题输入规模较大，请使用较为快速的输入方式。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[省选联考 2022] 学术社区", "background": "**小 I 的温馨提示：在题目描述中有形式化的题面，你可以选择跳过题目背景。同时请仔细将本题的除题目背景以外的所有内容进行完整阅读后再进行做题。**\n\n小 I 是一个喜欢 OI 的选手，不过，与其说小 I 喜欢 OI，不如说小 I 喜欢的是他最经常使用的 OJ——FCCOJ——上的趣味功能：学术社区。虽说名字叫学术社区，但小 I 和网友们能够谈论的东西远不止学术。每天学术社区里总会出现不少吸引小 I 注意的帖子。今天小 I 在学术社区冲浪时发现了一个这样的帖子：\n\n> `builtin_clz`：萌新求助，学术社区这题，本机 AC 提交 RE\n> \n> `builtin_ctz`：`builtin_clz` 楼下\n> \n> `jinkela`：`builtin_ctz` 楼下\n> \n> `builtin_ctz`：`builtin_clz` 楼上\n> \n> `builtin_clz`：能不能别魔怔了，大家正经回答问题\n> \n> `OrzTourist`：`builtin_clz` 楼下\n> \n> `OrzTourist`：`OrzTourist` 楼下\n> \n> `builtin_clz`：怎么没有人回答问题，我生气了！\n> \n> `builtin_clz`：`builtin_clz` 楼上\n> \n> `builtin_clz`：`builtin_clz` 楼下\n> \n> `builtin_clz`：`builtin_clz` 楼上\n> \n> `builtin_clz`：`builtin_clz` 楼下\n> \n> ……\n\n虽然这个名叫 `builtin_clz` 的网友因为没有人回答他的学术问题被激怒了，但这个有趣的发言方式让小 I 乐呵了许久，这说明人类的悲欢并不相通。不过当小 I 刷新界面想要往下浏览大家的回复时，却发现学术社区的管理员因为这个帖子过于灌水把它删除了。\n\n为了恢复这个有趣的帖子，小 I 对着网页缓存倒腾了许久，还原出了这个帖子的每条消息。然而因为神秘原因，消息的顺序被打乱了，且缓存中没有每条消息发送的时间，因而小 I 没有办法还原原始帖子中消息的顺序。\n\n秉承 “遇到困难睡大觉” 精神的小 I 决定随便给帖子里的消息排个顺序，不过深受 “`XXX` 楼上” “`XXX` 楼下” 这种发言形式吸引的小 I 还是希望重排之后有尽可能多的这种形式的消息的表达是符合帖子的实际情况的。然而小 I 是一个只会水社区不会做题的 OI 选手，所以小 I 求助于你。\n\n当然了，小 I 知道直接将帖子中的原始信息丢给你对你来说是不方便的，所以他对信息进行了一些规范化处理，详见题目描述中的形式化题意。**同时由于学术社区的特殊规定，帖子中的消息满足一定特殊限制，详见题目描述最后。**", "description": "**以下涉及的所有字符串判等操作都对大小写敏感，例如 `1oushang`、`Loushang`、`LOUSHANG` 是互不相同的字符串。**\n\n小 I 正在整理学术社区中的一个帖子。帖子中一共有 $N$ 个网友发过消息，他们的网名分别为 $n_1, n_2, \\ldots, n_N$。帖子中总共有 $M$ 条消息，对于第 $i$ 条消息，我们用三个字符串 $s_{i,1}, s_{i,2}, s_{i,3}$ 构成的三元组描述它，其中 $s_{i,1}$ 表示这条消息发出者的网名，而 $s_{i,2}$ 和 $s_{i,3}$ 描述这条消息的内容。\n\n对于第 $i$ 条消息，我们通过如下方式定义其属于**楼下型消息**、**楼上型消息**、**学术型消息**中的哪一种：\n\n- 若字符串 $s_{i, 3}$ 为 `louxia`，且 $s_{i, 2}$ 恰好与给出的某个网名相同（注意 $s_{i,2} = s_{i,1}$ 是允许的），则称这条消息是**楼下型消息**，$s_{i,2}$ 对应这条消息提到的网友；\n- 若字符串 $s_{i,3}$ 为 `loushang`，且 $s_{i,2}$ 恰好与给出的某个网名相同（注意 $s_{i,2} = s_{i,1}$ 是允许的），则称这条消息是**楼上型消息**，$s_{i,2}$ 对应这条消息提到的网友；\n- 若以上两个条件都不满足，则称这条消息是**学术消息**。\n\n定义一个对所有消息的重排方案为一个 $1$ 到 $M$ 的排列 $a_1, a_2, a_3, \\ldots, a_M$，表示第一条消息是 $(s_{a_1,1}, s_{a_1,2}, s_{a_1,3})$，第二条消息是 $(s_{a_2,1}, s_{a_2,2}, s_{a_2,3})$，依此类推。\n\n对于一个重排方案 $a_1, a_2, a_3, \\ldots, a_M$ 中的第 $i$（$1 \\le i \\le M$）条消息 $(s_{a_i,1}, s_{a_i,2}, s_{a_i,3})$，如下定义其是否是**符合实际情况的**：\n\n- 若这条消息是**楼下型消息**，则这条消息是**符合实际情况的**当且仅当 $i \\ne 1$ 且 $s_{a_{i - 1}, 1} = s_{a_i, 2}$，即上一条消息存在且它的发出者与这条消息提到的网友一致。\n- 若这条消息是**楼上型消息**，则这条消息是**符合实际情况的**当且仅当 $i \\ne M$ 且 $s_{a_{i + 1}, 1} = s_{a_i, 2}$，即下一条消息存在且它的发出者与这条消息提到的网友一致。\n- 若这条消息是**学术消息**，则无论如何这条消息一定不是符合实际情况的，这是因为小 I 只想灌水不想学术。\n\n在以上定义下，小 I 希望找到一个重排方案，使得该重排方案中符合实际情况的消息数量最多。你需要帮他找到这个方案以及这个方案中符合实际情况的消息数量。\n\n**为了方便你的解题，小 I 还告诉了你帖子中消息的一个特殊限制：因为学术社区会禁言在社区中只灌水不学术的人，所以在小 I 给出的帖子里，每一个在帖子中发过言的人都一定会在帖子中发出至少一条学术消息。**", "inputFormat": "**本题有多组测试数据**。第一行一个整数 $T$ 表示测试数据组数，接下来分别输入 $T$ 组数据。\n\n对于每组测试数据，第一行两个整数 $N, M$ 分别表示帖子中发过消息的网友数量以及帖子的消息数量。\n\n接下来 $N$ 行每行一个字符串 $n$ 表示在帖子中发过消息的一个网友的网名。保证每个测试数据中输入的 $N$ 个网友的网名两两不同。\n\n接下来 $M$ 行每行三个字符串 $s_1, s_2, s_3$ 描述一条消息，相邻的字符串之间用一个空格分隔，其中 $s_1$ 一定与输入中某个网友的网名相等。\n\n输入的所有字符串仅由大小写英文字母、下划线（`_`）、英文问号（`?`）、英文感叹号（`!`）和英文句号（`.`）构成，且长度不超过 $12$。\n\n对于每组测试数据，保证输入的 $N$ 个网名都发出过至少一条消息，**且至少发出过一条学术消息**。\n\n同一组测试数据中可能存在多条消息内容完全一致，此时应将他们视为**多条**消息。", "outputFormat": "对于每组测试数据输出两行。\n\n第一行输出一个非负整数表示所有重排方案中最大的符合实际情况的消息数量。\n\n第二行输出 $M$ 个整数 $a_1, a_2, \\ldots, a_m$，表示符合实际情况的消息最多的重排方案。\n\n若有多种合法的重排方案，**输出任意一个即可**。", "hint": "**【样例解释 #1】**\n\n第一个测试数据与题目背景中给出的例子基本一致，而不同的点在于：为了满足每个人至少发出一条学术消息的要求，在该组数据输入的最后有几条额外的学术消息。\n\n第二个测试数据中，输入的前两条消息是楼上型消息，第三条消息是楼下型消息，其他消息是学术消息。\n\n**【样例 #3】**\n\n见附件中的 `community/community3.in` 与 `community/community3.ans`。\n\n该组样例满足数据范围中的特殊性质 A、特殊性质 B、特殊性质 C。\n\n**【样例 #4】**\n\n见附件中的 `community/community4.in` 与 `community/community4.ans`。\n\n该组样例满足数据范围中的特殊性质 C。\n\n**【数据范围】**\n\n设 $\\sum M$ 为单个测试点中所有测试数据的 $M$ 的和。\n\n对于所有测试点，$1 \\le T \\le 100$，$1 \\le N \\le M \\le 77777$，$1 \\le \\sum M \\le 2.5 \\times {10}^5$。\n\n| $T \\le$ | $M \\le$ | $\\sum M \\le$ | 测试点编号 | 特殊性质 A | 特殊性质 B | 特殊性质 C |\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n| $5$ | $10$ | $50$ | $1$ | 无 | 无 | 无 |\n| $10$ | $16$ | $160$ | $2$ | 无 | 无 | 无 |\n| $30$ | $2222$ | $15000$ | $3 \\sim 4$ | 有 | 有 | 有 |\n| $30$ | $2222$ | $15000$ | $5 \\sim 6$ | 有 | 无 | 有 |\n| $30$ | $2222$ | $15000$ | $7 \\sim 9$ | 无 | 有 | 有 |\n| $30$ | $2222$ | $15000$ | $10 \\sim 11$ | 无 | 无 | 有 |\n| $30$ | $2222$ | $15000$ | $12 \\sim 13$ | 无 | 无 | 无 |\n| $100$ | $77777$ | $2.5 \\times {10}^5$ | $14 \\sim 15$ | 有 | 有 | 有 |\n| $100$ | $77777$ | $2.5 \\times {10}^5$ | $16$ | 有 | 无 | 有 |\n| $100$ | $77777$ | $2.5 \\times {10}^5$ | $17 \\sim 19$ | 无 | 有 | 有 |\n| $100$ | $77777$ | $2.5 \\times {10}^5$ | $20 \\sim 22$ | 无 | 无 | 有 |\n| $100$ | $77777$ | $2.5 \\times {10}^5$ | $23 \\sim 25$ | 无 | 无 | 无 |\n\n**注意：为了阅读方便，测试点编号在表格中的第四列。**\n\n特殊性质 A：没有楼上型消息。**注意：这不意味着 $\\bm{s_3}$ 不等于 `loushang`。**\n\n特殊性质 B：对于每组测试数据，存在一个重排方案，使得每一条楼上型消息和楼下型消息都是符合实际情况的。\n\n特殊性质 C：对于每组测试数据，若存在一条消息是 $s_1$ $s_2$ `loushang`，其中 $s_1, s_2$ 为任意字符串，则该组数据中一定不存在一条消息是 $s_2$ $s_1$ `louxia`。\n\n**【评分方式】**\n\n若一个测试点内所有测试数据的符合实际情况的消息数量都正确，你将获得该测试点 $50 \\%$ 的分数；在此基础上，若一个测试点内所有测试数据的重排方案都正确，你将获得该测试点的所有分数。需要注意的是，**如果你只希望获得 $\\bm{50 \\%}$ 的分数，你也要保证在每组测试数据的第二行输出一个 $\\bm{1}$ 到 $\\bm{M}$ 的排列，否则实际分数与期望分数可能出现偏差**。\n\n**【提示】**\n\n因为这对你可能很重要，所以小 I 再一次强调：**因为学术社区会禁言在社区中只灌水不学术的人，所以在小 I 给出的帖子里，每一个在帖子中发过言的人都一定会在帖子中发出至少一条学术消息**。\n\n本题输入规模较大，请使用较为快速的输入方式。", "locale": "zh-CN"}}}
{"pid": "P8292", "type": "P", "difficulty": 6, "samples": [["5\n10 2 10 5 46\n4\n2 2 5\n2 2 23\n1 3\n1 23", "27\n16\n0\n16"], ["见附件中的 card/card2.in", "见附件中的 card/card2.ans"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["各省省选", "2022", "O2优化", "容斥原理", "快速沃尔什变换 FWT"], "title": "[省选联考 2022] 卡牌", "background": "", "description": "小 A 有 $n$ 张卡牌，编号为 $1, 2, \\ldots, n$。每张卡牌上写着一个正整数，第 $i$ 张卡牌上的正整数为 $s_i$。\n\n现在有 $m$ 轮游戏，第 $i$ 轮游戏会给出 $c_i$ 个质数，小 A 需要选择任意多张卡牌，使得这些卡牌上面的正整数的乘积能被该轮游戏给出的每个质数整除。\n\n这当然难不倒小 A，于是他开始思考一个更难的问题，对于每一轮游戏，他有多少种卡牌的选法。\n\n这给小 A 整不会了，于是他只能来求助你，你只需要告诉他答案模 $998244353$ 的值即可。两种选法 A 和 B 互不相同当且仅当存在一张卡牌在 A 中被选择但在 B 中未被选择或者存在一张卡牌在 B 中被选择但在 A 中未被选择。注意：牌面上的数字相同但编号不相同的两张卡牌被视为不同的卡牌。", "inputFormat": "第一行一个正整数 $n$，表示卡牌数量。\n\n第二行 $n$ 个正整数 $s_i$，表示每张卡牌上写的数字。\n\n第三行一个正整数 $m$，表示游戏轮数。\n\n接下来 $m$ 行，每行第一个正整数 $c_i$，表示该轮游戏给出的质数个数，接下来 $c_i$ 个质数 $p_{i, j}$，表示该轮游戏给出的所有质数。数据保证 $\\sum_i c_i \\le 18000$，即所有 $c_i$ 之和不超过 $18000$。", "outputFormat": "输出 $m$ 行，每行一个整数，第 $i$ 行表示第 $i$ 轮游戏的方案数模 $998244353$ 的值。", "hint": "**【样例解释 #1】**\n\n第一轮游戏：除了以下 $5$ 种方案外其它方案都可行：什么都不选、选 $2$、选 $5$、选 $46$、选 $2$ 和 $46$。所以答案为 $2^5 - 5 = 27$。\n\n第二轮游戏：只要选了 $46$，其它卡牌选不选均可，所以答案为 $2^4 = 16$。\n\n**【数据范围】**\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le {10}^6$，$1 \\le s_i \\le 2000$，$1 \\le m \\le 1500$，$1 \\le c_i, \\sum_i c_i \\le 18000$，$2 \\le p_{i, j} \\le 2000$。\n\n| 测试点 | $n \\le$ | $m \\le$ | $\\sum_i c_i \\le$ | 其他限制 |\n|:-:|:-:|:-:|:-:|:-:|\n| $1 \\sim 2$ | $10$ | $10$ | $20$ | $s_i \\le 30$ |\n| $3 \\sim 5$ | $10$ | $20$ | $50$ | 无 |\n| $6 \\sim 8$ | ${10}^6$ | $1500$ | $10000$ | $s_i \\le 30$ |\n| $9 \\sim 11$ | $10000$ | $1000$ | $5000$ | $s_i \\le 500$ |\n| $12 \\sim 13$ | $1000$ | $100$ | $1000$ | 无 |\n| $14 \\sim 17$ | $5000$ | $600$ | $7000$ | 无 |\n| $18 \\sim 20$ | ${10}^6$ | $1500$ | $18000$ | 无 |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[省选联考 2022] 卡牌", "background": "", "description": "小 A 有 $n$ 张卡牌，编号为 $1, 2, \\ldots, n$。每张卡牌上写着一个正整数，第 $i$ 张卡牌上的正整数为 $s_i$。\n\n现在有 $m$ 轮游戏，第 $i$ 轮游戏会给出 $c_i$ 个质数，小 A 需要选择任意多张卡牌，使得这些卡牌上面的正整数的乘积能被该轮游戏给出的每个质数整除。\n\n这当然难不倒小 A，于是他开始思考一个更难的问题，对于每一轮游戏，他有多少种卡牌的选法。\n\n这给小 A 整不会了，于是他只能来求助你，你只需要告诉他答案模 $998244353$ 的值即可。两种选法 A 和 B 互不相同当且仅当存在一张卡牌在 A 中被选择但在 B 中未被选择或者存在一张卡牌在 B 中被选择但在 A 中未被选择。注意：牌面上的数字相同但编号不相同的两张卡牌被视为不同的卡牌。", "inputFormat": "第一行一个正整数 $n$，表示卡牌数量。\n\n第二行 $n$ 个正整数 $s_i$，表示每张卡牌上写的数字。\n\n第三行一个正整数 $m$，表示游戏轮数。\n\n接下来 $m$ 行，每行第一个正整数 $c_i$，表示该轮游戏给出的质数个数，接下来 $c_i$ 个质数 $p_{i, j}$，表示该轮游戏给出的所有质数。数据保证 $\\sum_i c_i \\le 18000$，即所有 $c_i$ 之和不超过 $18000$。", "outputFormat": "输出 $m$ 行，每行一个整数，第 $i$ 行表示第 $i$ 轮游戏的方案数模 $998244353$ 的值。", "hint": "**【样例解释 #1】**\n\n第一轮游戏：除了以下 $5$ 种方案外其它方案都可行：什么都不选、选 $2$、选 $5$、选 $46$、选 $2$ 和 $46$。所以答案为 $2^5 - 5 = 27$。\n\n第二轮游戏：只要选了 $46$，其它卡牌选不选均可，所以答案为 $2^4 = 16$。\n\n**【数据范围】**\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le {10}^6$，$1 \\le s_i \\le 2000$，$1 \\le m \\le 1500$，$1 \\le c_i, \\sum_i c_i \\le 18000$，$2 \\le p_{i, j} \\le 2000$。\n\n| 测试点 | $n \\le$ | $m \\le$ | $\\sum_i c_i \\le$ | 其他限制 |\n|:-:|:-:|:-:|:-:|:-:|\n| $1 \\sim 2$ | $10$ | $10$ | $20$ | $s_i \\le 30$ |\n| $3 \\sim 5$ | $10$ | $20$ | $50$ | 无 |\n| $6 \\sim 8$ | ${10}^6$ | $1500$ | $10000$ | $s_i \\le 30$ |\n| $9 \\sim 11$ | $10000$ | $1000$ | $5000$ | $s_i \\le 500$ |\n| $12 \\sim 13$ | $1000$ | $100$ | $1000$ | 无 |\n| $14 \\sim 17$ | $5000$ | $600$ | $7000$ | 无 |\n| $18 \\sim 20$ | ${10}^6$ | $1500$ | $18000$ | 无 |", "locale": "zh-CN"}}}
{"pid": "P8293", "type": "P", "difficulty": 7, "samples": [["2 0 1\n()()\n1 3\n", "1\n"], ["2 1 0\n()()\n1 3\n", "1\n"], ["见附件中的 bracket/bracket3.in", "见附件中的 bracket/bracket3.ans"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["贪心", "树形数据结构", "各省省选", "2022", "O2优化"], "title": "[省选联考 2022] 序列变换", "background": "", "description": "你手里有一个长度为 $2 n$ 的合法括号序列 $s$。$s$ 的每一个左括号有一个权值。\n\n在你眼中，不同的括号序列带来的视觉美感不尽相同。因此，你对具有某一种结构的括号序列特别喜欢，而讨厌具有其他一些结构的括号序列。你希望对 $s$ 进行一些变换，以消除掉一些自己不喜欢的结构。\n\n具体而言，形如 $\\texttt{(A()B)}$（其中 $\\texttt{A}$、$\\texttt{B}$ 均为合法括号序列，下同）的结构是你喜欢的，\n而形如 $\\texttt{(A)(B)}$ 的结构是你不喜欢的。你有两种操作来改变括号之间的位置。\n\n这两种操作如下：\n- 操作 1：交换形如 $\\texttt{p(A)(B)q}$ 的串中 $\\texttt{A}$ 和 $\\texttt{B}$ 之间的两个括号，变换为 $\\texttt{p(A()B)q}$（其中 $\\texttt{p}$、$\\texttt{q}$ 为任意串，可以为空，但不一定分别为合法括号序列，下同），它的代价为 $x$ 乘 $\\texttt{(A)}$ 中第一个左括号的权值加上 $y$ 乘 $\\texttt{(B)}$ 中第一个左括号的权值，其中 $x, y \\in \\{0, 1\\}$；\n- 操作 2：交换形如 $\\texttt{pABq}$ 的串中的 $\\texttt{A}$ 和 $\\texttt{B}$，变换为 $\\texttt{pBAq}$，这个操作不需要代价。\n\n注意：交换的时候所有左括号的权值是跟着这个括号一起交换的。\n\n你现在想知道的是，将 $s$ 变换为一个不包含你不喜欢的结构的括号序列至少需要多少代价？", "inputFormat": "第一行三个整数 $n, x, y$。\n\n第二行一个长度为 $2n$ 的合法括号序列，表示 $s$。\n\n第三行 $n$ 个正整数，其中第 $i$ 个表示左数第 $i$ 个左括号的权值。", "outputFormat": "一行一个整数，表示把 $s$ 变换为一个不包含你不喜欢的结构的括号序列至少需要的代价。", "hint": "**【样例解释 #1】**\n\n最优方案是先使用操作 2 交换两对括号，然后使用操作 1（此时 $\\texttt{A}$、$\\texttt{B}$、$\\texttt{p}$、$\\texttt{q}$ 都是空串）交换中间的两个括号，代价为 $\\texttt{B}$ 左边那个括号的权值，也就是 $1$。最后得到括号序列 $\\texttt{(())}$，不包含你不喜欢的结构。\n\n**【样例解释 #2】**\n\n最优方案是直接使用操作 1，因为此时计算代价的方式不同了，这次只算 $\\texttt{A}$ 左边的那个括号的权值作为代价。\n\n**【数据范围】**\n\n保证 $2 \\le n \\le 400000$，$0 \\le x, y \\le 1$。\n\n保证所有的权值在 $[1, {10}^7]$ 之内。\n\n| 测试点编号 | 特殊限制 |\n|:-:|:-:|\n| $1 \\sim 3$ | $n \\leq 8$ |\n| $4 \\sim 5$ | 所有权值均相等 |\n| $6 \\sim 8$ | $n \\leq 20$ |\n| $9 \\sim 12$ | $x = 0$，$y = 1$ |\n| $13 \\sim 16$ | $n \\le 2000$ |\n| $17 \\sim 25$ | 无特殊限制 |\n\n**【提示】**\n\n称一个字符串 $s$ 为合法括号序列，当且仅当 $s$ 仅由数量相等的字符 $\\texttt{(}$ 和 $\\texttt{)}$ 组成，且对于 $s$ 的每一个前缀而言，其中 $\\texttt{(}$ 的数量均不少于 $\\texttt{)}$ 的数量。特别地，空串也是合法括号序列。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[省选联考 2022] 序列变换", "background": "", "description": "你手里有一个长度为 $2 n$ 的合法括号序列 $s$。$s$ 的每一个左括号有一个权值。\n\n在你眼中，不同的括号序列带来的视觉美感不尽相同。因此，你对具有某一种结构的括号序列特别喜欢，而讨厌具有其他一些结构的括号序列。你希望对 $s$ 进行一些变换，以消除掉一些自己不喜欢的结构。\n\n具体而言，形如 $\\texttt{(A()B)}$（其中 $\\texttt{A}$、$\\texttt{B}$ 均为合法括号序列，下同）的结构是你喜欢的，\n而形如 $\\texttt{(A)(B)}$ 的结构是你不喜欢的。你有两种操作来改变括号之间的位置。\n\n这两种操作如下：\n- 操作 1：交换形如 $\\texttt{p(A)(B)q}$ 的串中 $\\texttt{A}$ 和 $\\texttt{B}$ 之间的两个括号，变换为 $\\texttt{p(A()B)q}$（其中 $\\texttt{p}$、$\\texttt{q}$ 为任意串，可以为空，但不一定分别为合法括号序列，下同），它的代价为 $x$ 乘 $\\texttt{(A)}$ 中第一个左括号的权值加上 $y$ 乘 $\\texttt{(B)}$ 中第一个左括号的权值，其中 $x, y \\in \\{0, 1\\}$；\n- 操作 2：交换形如 $\\texttt{pABq}$ 的串中的 $\\texttt{A}$ 和 $\\texttt{B}$，变换为 $\\texttt{pBAq}$，这个操作不需要代价。\n\n注意：交换的时候所有左括号的权值是跟着这个括号一起交换的。\n\n你现在想知道的是，将 $s$ 变换为一个不包含你不喜欢的结构的括号序列至少需要多少代价？", "inputFormat": "第一行三个整数 $n, x, y$。\n\n第二行一个长度为 $2n$ 的合法括号序列，表示 $s$。\n\n第三行 $n$ 个正整数，其中第 $i$ 个表示左数第 $i$ 个左括号的权值。", "outputFormat": "一行一个整数，表示把 $s$ 变换为一个不包含你不喜欢的结构的括号序列至少需要的代价。", "hint": "**【样例解释 #1】**\n\n最优方案是先使用操作 2 交换两对括号，然后使用操作 1（此时 $\\texttt{A}$、$\\texttt{B}$、$\\texttt{p}$、$\\texttt{q}$ 都是空串）交换中间的两个括号，代价为 $\\texttt{B}$ 左边那个括号的权值，也就是 $1$。最后得到括号序列 $\\texttt{(())}$，不包含你不喜欢的结构。\n\n**【样例解释 #2】**\n\n最优方案是直接使用操作 1，因为此时计算代价的方式不同了，这次只算 $\\texttt{A}$ 左边的那个括号的权值作为代价。\n\n**【数据范围】**\n\n保证 $2 \\le n \\le 400000$，$0 \\le x, y \\le 1$。\n\n保证所有的权值在 $[1, {10}^7]$ 之内。\n\n| 测试点编号 | 特殊限制 |\n|:-:|:-:|\n| $1 \\sim 3$ | $n \\leq 8$ |\n| $4 \\sim 5$ | 所有权值均相等 |\n| $6 \\sim 8$ | $n \\leq 20$ |\n| $9 \\sim 12$ | $x = 0$，$y = 1$ |\n| $13 \\sim 16$ | $n \\le 2000$ |\n| $17 \\sim 25$ | 无特殊限制 |\n\n**【提示】**\n\n称一个字符串 $s$ 为合法括号序列，当且仅当 $s$ 仅由数量相等的字符 $\\texttt{(}$ 和 $\\texttt{)}$ 组成，且对于 $s$ 的每一个前缀而言，其中 $\\texttt{(}$ 的数量均不少于 $\\texttt{)}$ 的数量。特别地，空串也是合法括号序列。", "locale": "zh-CN"}}}
{"pid": "P8294", "type": "P", "difficulty": 7, "samples": [["3\n2 1 3\n1 1", "7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["各省省选", "2022", "O2优化", "树形 DP", "凸完全单调性（wqs 二分）"], "title": "[省选联考 2022] 最大权独立集问题", "background": "", "description": "小 E 喜欢出最大权独立集问题。\n\n接下来，他还想了 $n$ 道最大权独立集问题。\n\n小 E 有 $n$ 个 AI，编号为 $1 \\sim n$。\n\n开始时第 $i$ 个 AI 里面存有 $d_i$ 道小 E 事先出好的最大权独立集问题。\n\n有些 AI 之间可以互相通信，对于所有的 $2 \\leq i \\leq n$ ，第 $i$ 个 AI 可以和第 $c_i$ 个 AI 互相通信。其中 $c_i < i$，且相同的 $c_i$ 出现不超过 $2$ 次。所以，这些 AI 连成了一个二叉树的形状。此外，其他对 AI 不可以互相通信。\n\n小 E 需要暂时断开这些 AI 之间的连接。他只能逐一断开 AI 之间的连接。两个原本能够互相通信的 AI 在断开它们之间的连接之前，会互相交换存在里面的所有题目，具体请见样例。\n\n小 E 希望在断掉所有连接之后，参与交换的题目数量最少。\n他想叫你帮他解决这个问题，还说如果你成功解决了这个问题，那么在出那些最大权独立集问题的时候，他会帮你提交一份标程代码。", "inputFormat": "第一行一个正整数 $n$。\n\n第二行 $n$ 个整数，第 $i$ 个表示 $d_i$。\n\n第三行 $n - 1$ 个正整数，第 $i$ 个表示 $c_{i+1}$。", "outputFormat": "一行一个整数表示答案。", "hint": "**【样例解释 #1】**\n\n一种最优的方案是：断开 $1$ 号与 $2$ 号 AI 之间的连接，这样需要交换 $2 + 1 = 3$ 道题；然后断开 $1$ 号与 $3$ 号 AI 之间的连接，这样需要交换 $1 + 3 = 4$ 道题。所以答案是 $7$。\n\n**【数据范围】**\n\n保证 $1 \\le c_i \\le i$，且相同的 $c_i$ 最多出现两次。\n\n保证 $1 \\le d_i \\le {10}^9$。\n\n| 测试点编号 | $n \\leq$ |\n|:-:|:-:|\n| $1 \\sim 3$ | $10$ |\n| $4 \\sim 7$ | $100$ |\n| $8 \\sim 11$ | $500$ |\n| $12 \\sim 16$ | $1000$ |\n| $17 \\sim 25$ | $5000$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[省选联考 2022] 最大权独立集问题", "background": "", "description": "小 E 喜欢出最大权独立集问题。\n\n接下来，他还想了 $n$ 道最大权独立集问题。\n\n小 E 有 $n$ 个 AI，编号为 $1 \\sim n$。\n\n开始时第 $i$ 个 AI 里面存有 $d_i$ 道小 E 事先出好的最大权独立集问题。\n\n有些 AI 之间可以互相通信，对于所有的 $2 \\leq i \\leq n$ ，第 $i$ 个 AI 可以和第 $c_i$ 个 AI 互相通信。其中 $c_i < i$，且相同的 $c_i$ 出现不超过 $2$ 次。所以，这些 AI 连成了一个二叉树的形状。此外，其他对 AI 不可以互相通信。\n\n小 E 需要暂时断开这些 AI 之间的连接。他只能逐一断开 AI 之间的连接。两个原本能够互相通信的 AI 在断开它们之间的连接之前，会互相交换存在里面的所有题目，具体请见样例。\n\n小 E 希望在断掉所有连接之后，参与交换的题目数量最少。\n他想叫你帮他解决这个问题，还说如果你成功解决了这个问题，那么在出那些最大权独立集问题的时候，他会帮你提交一份标程代码。", "inputFormat": "第一行一个正整数 $n$。\n\n第二行 $n$ 个整数，第 $i$ 个表示 $d_i$。\n\n第三行 $n - 1$ 个正整数，第 $i$ 个表示 $c_{i+1}$。", "outputFormat": "一行一个整数表示答案。", "hint": "**【样例解释 #1】**\n\n一种最优的方案是：断开 $1$ 号与 $2$ 号 AI 之间的连接，这样需要交换 $2 + 1 = 3$ 道题；然后断开 $1$ 号与 $3$ 号 AI 之间的连接，这样需要交换 $1 + 3 = 4$ 道题。所以答案是 $7$。\n\n**【数据范围】**\n\n保证 $1 \\le c_i \\le i$，且相同的 $c_i$ 最多出现两次。\n\n保证 $1 \\le d_i \\le {10}^9$。\n\n| 测试点编号 | $n \\leq$ |\n|:-:|:-:|\n| $1 \\sim 3$ | $10$ |\n| $4 \\sim 7$ | $100$ |\n| $8 \\sim 11$ | $500$ |\n| $12 \\sim 16$ | $1000$ |\n| $17 \\sim 25$ | $5000$ |", "locale": "zh-CN"}}}
