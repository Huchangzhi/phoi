{"pid": "P3369", "type": "P", "difficulty": 5, "samples": [["10\n1 106465\n4 1\n1 317721\n1 460929\n1 644985\n1 84185\n1 89851\n6 81968\n1 492737\n5 493598", "106465\n84185\n492737"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["平衡树", "模板题"], "title": "【模板】普通平衡树", "background": null, "description": "您需要动态地维护一个可重集合 $M$，并且提供以下操作：\n\n1. 向 $M$ 中插入一个数 $x$。\n2. 从 $M$ 中删除一个数 $x$（若有多个相同的数，应只删除一个）。\n3. 查询 $M$ 中有多少个数比 $x$ 小，并且将得到的答案加一。\n4. 查询如果将 $M$ 从小到大排列后，排名位于第 $x$ 位的数。\n5. 查询 $M$ 中 $x$ 的前驱（前驱定义为小于 $x$，且最大的数）。\n6. 查询 $M$ 中 $x$ 的后继（后继定义为大于 $x$，且最小的数）。\n\n对于操作 $3,5,6$，**不保证**当前可重集中存在数 $x$。\n\n对于操作 $5,6$，保证答案一定存在。", "inputFormat": "第一行为 $n$，表示操作的个数，下面 $n$ 行每行有两个数 $\\text{opt}$ 和 $x$，$\\text{opt}$ 表示操作的序号（$ 1 \\leq \\text{opt} \\leq 6 $）。", "outputFormat": "对于操作 $3,4,5,6$ 每行输出一个数，表示对应答案。", "hint": "**【数据范围】** \n\n对于 $100\\%$ 的数据，$1\\le n \\le 10^5$，$|x| \\le 10^7$。\n\n来源：Tyvj1728，原名：普通平衡树。\n\n在此鸣谢！", "locale": "zh-CN", "translations": {"en": {"title": "【Template】Ordinary Balanced Tree", "background": "", "description": "You need to dynamically maintain a multiset $M$ and support the following operations:\n\n1. Insert a number $x$ into $M$.\n2. Delete a number $x$ from $M$ (if there are multiple equal numbers, delete only one).\n3. Query how many numbers in $M$ are less than $x$, and then add one to the result (i.e., the rank of $x$).\n4. Query the number whose rank is $x$ when $M$ is sorted in ascending order.\n5. Query the predecessor of $x$ in $M$ (the predecessor is defined as the maximum number that is less than $x$).\n6. Query the successor of $x$ in $M$ (the successor is defined as the minimum number that is greater than $x$).\n\nFor operations 3, 5, and 6, it is **not guaranteed** that $x$ exists in the current multiset.\n\nFor operations 5 and 6, the answer is guaranteed to exist.", "inputFormat": "The first line contains $n$, the number of operations. Each of the next $n$ lines contains two integers $\\text{opt}$ and $x$, where $\\text{opt}$ denotes the operation index ($1 \\leq \\text{opt} \\leq 6$).", "outputFormat": "For operations 3, 4, 5, and 6, output one integer per line, the corresponding answer.", "hint": "Constraints\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 10^5$, $|x| \\le 10^7$.\n\nSource: Tyvj1728, originally titled: Ordinary Balanced Tree.\n\nSpecial thanks!\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】普通平衡树", "background": null, "description": "您需要动态地维护一个可重集合 $M$，并且提供以下操作：\n\n1. 向 $M$ 中插入一个数 $x$。\n2. 从 $M$ 中删除一个数 $x$（若有多个相同的数，应只删除一个）。\n3. 查询 $M$ 中有多少个数比 $x$ 小，并且将得到的答案加一。\n4. 查询如果将 $M$ 从小到大排列后，排名位于第 $x$ 位的数。\n5. 查询 $M$ 中 $x$ 的前驱（前驱定义为小于 $x$，且最大的数）。\n6. 查询 $M$ 中 $x$ 的后继（后继定义为大于 $x$，且最小的数）。\n\n对于操作 $3,5,6$，**不保证**当前可重集中存在数 $x$。\n\n对于操作 $5,6$，保证答案一定存在。", "inputFormat": "第一行为 $n$，表示操作的个数，下面 $n$ 行每行有两个数 $\\text{opt}$ 和 $x$，$\\text{opt}$ 表示操作的序号（$ 1 \\leq \\text{opt} \\leq 6 $）。", "outputFormat": "对于操作 $3,4,5,6$ 每行输出一个数，表示对应答案。", "hint": "**【数据范围】** \n\n对于 $100\\%$ 的数据，$1\\le n \\le 10^5$，$|x| \\le 10^7$。\n\n来源：Tyvj1728，原名：普通平衡树。\n\n在此鸣谢！", "locale": "zh-CN"}}}
{"pid": "P3370", "type": "P", "difficulty": 2, "samples": [["5\nabc\naaaa\nabc\nabcc\n12345", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["字符串", "哈希 hashing", "模板题"], "title": "【模板】字符串哈希", "background": "", "description": "如题，给定 $N$ 个字符串（第 $i$ 个字符串长度为 $M_i$，字符串内包含数字、大小写字母，大小写敏感），请求出 $N$ 个字符串中共有多少个不同的字符串。\n\n\n**友情提醒：如果真的想好好练习哈希的话，请自觉。**\n", "inputFormat": "第一行包含一个整数 $N$，为字符串的个数。\n\n接下来 $N$ 行每行包含一个字符串，为所提供的字符串。\n", "outputFormat": "输出包含一行，包含一个整数，为不同的字符串个数。\n", "hint": "### 数据范围\n\n对于 $30\\%$ 的数据：$N\\leq 10$，$M_i≈6$，$M_{\\max}\\leq 15$。\n\n对于 $70\\%$ 的数据：$N\\leq 1000$，$M_i≈100$，$M_{\\max}\\leq 150$。\n\n对于 $100\\%$ 的数据：$N\\leq 10000$，$M_i≈1000$，$M_{\\max}\\leq 1500$。\n\n### 样例说明\n\n样例中第一个字符串 $\\tt{abc}$ 和第三个字符串 $\\tt{abc}$ 是一样的，所以所提供字符串的集合为 $\\{\\tt{aaaa},\\tt{abc},\\tt{abcc},\\tt{12345}\\}$，故共计 $4$ 个不同的字符串。\n\n### 拓展阅读\n\n以下的一些试题从不同层面体现出了字符串哈希算法的正确性分析。\n\n- [P12197 Hash Killer I](https://www.luogu.com.cn/problem/P12197)\n- [P12198 Hash Killer II](https://www.luogu.com.cn/problem/P12198)\n- [P12199 （目前无解）Hash Killer III](https://www.luogu.com.cn/problem/P12199)\n- [P12200 Hash Killer Extra](https://www.luogu.com.cn/problem/P12200)\n- [P12201 Hash Killer Phantasm](https://www.luogu.com.cn/problem/P12201)\n- [P7350 「MCOI-04」Dream and Strings](https://www.luogu.com.cn/problem/P7350)", "locale": "zh-CN", "translations": {"en": {"title": "[Template] String Hash", "background": "", "description": "As stated, given $N$ strings (the length of the $i$-th string is $M_i$, and each string contains digits and letters in both cases; it is case-sensitive), find how many distinct strings there are among the $N$ strings.\n\n**Friendly reminder: if you really want to practice hashing seriously, please be self-disciplined.**", "inputFormat": "The first line contains an integer $N$, the number of strings.\n\nThe next $N$ lines each contain one string, the provided strings.", "outputFormat": "Output one line containing one integer, the number of distinct strings.", "hint": "### Constraints\n\nFor $30\\%$ of the testdata: $N \\leq 10$, $M_i \\approx 6$, $M_{\\max} \\leq 15$.\n\nFor $70\\%$ of the testdata: $N \\leq 1000$, $M_i \\approx 100$, $M_{\\max} \\leq 150$.\n\nFor $100\\%$ of the testdata: $N \\leq 10000$, $M_i \\approx 1000$, $M_{\\max} \\leq 1500$.\n\n### Sample Explanation\n\nIn the sample, the first string $\\tt{abc}$ and the third string $\\tt{abc}$ are the same, so the set of provided strings is $\\{\\tt{aaaa}, \\tt{abc}, \\tt{abcc}, \\tt{12345}\\}$, hence there are $4$ distinct strings.\n\n### Further Reading\n\nThe following problems reflect the correctness analysis of string hashing from different aspects.\n\n- [P12197 Hash Killer I](https://www.luogu.com.cn/problem/P12197)\n- [P12198 Hash Killer II](https://www.luogu.com.cn/problem/P12198)\n- [P12199 (currently unsolved) Hash Killer III](https://www.luogu.com.cn/problem/P12199)\n- [P12200 Hash Killer Extra](https://www.luogu.com.cn/problem/P12200)\n- [P12201 Hash Killer Phantasm](https://www.luogu.com.cn/problem/P12201)\n- [P7350 「MCOI-04」Dream and Strings](https://www.luogu.com.cn/problem/P7350)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】字符串哈希", "background": "", "description": "如题，给定 $N$ 个字符串（第 $i$ 个字符串长度为 $M_i$，字符串内包含数字、大小写字母，大小写敏感），请求出 $N$ 个字符串中共有多少个不同的字符串。\n\n\n**友情提醒：如果真的想好好练习哈希的话，请自觉。**\n", "inputFormat": "第一行包含一个整数 $N$，为字符串的个数。\n\n接下来 $N$ 行每行包含一个字符串，为所提供的字符串。\n", "outputFormat": "输出包含一行，包含一个整数，为不同的字符串个数。\n", "hint": "### 数据范围\n\n对于 $30\\%$ 的数据：$N\\leq 10$，$M_i≈6$，$M_{\\max}\\leq 15$。\n\n对于 $70\\%$ 的数据：$N\\leq 1000$，$M_i≈100$，$M_{\\max}\\leq 150$。\n\n对于 $100\\%$ 的数据：$N\\leq 10000$，$M_i≈1000$，$M_{\\max}\\leq 1500$。\n\n### 样例说明\n\n样例中第一个字符串 $\\tt{abc}$ 和第三个字符串 $\\tt{abc}$ 是一样的，所以所提供字符串的集合为 $\\{\\tt{aaaa},\\tt{abc},\\tt{abcc},\\tt{12345}\\}$，故共计 $4$ 个不同的字符串。\n\n### 拓展阅读\n\n以下的一些试题从不同层面体现出了字符串哈希算法的正确性分析。\n\n- [P12197 Hash Killer I](https://www.luogu.com.cn/problem/P12197)\n- [P12198 Hash Killer II](https://www.luogu.com.cn/problem/P12198)\n- [P12199 （目前无解）Hash Killer III](https://www.luogu.com.cn/problem/P12199)\n- [P12200 Hash Killer Extra](https://www.luogu.com.cn/problem/P12200)\n- [P12201 Hash Killer Phantasm](https://www.luogu.com.cn/problem/P12201)\n- [P7350 「MCOI-04」Dream and Strings](https://www.luogu.com.cn/problem/P7350)", "locale": "zh-CN"}}}
{"pid": "P3371", "type": "P", "difficulty": 3, "samples": [["4 6 1\n1 2 2\n2 3 2\n2 4 1\n1 3 5\n3 4 3\n1 4 4", "0 2 4 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["图论", "O2优化", "最短路", "模板题"], "title": "【模板】单源最短路径（弱化版）", "background": "本题测试数据为随机数据，在考试中可能会出现构造数据让 SPFA 不通过，如有需要请移步 [P4779](https://www.luogu.com.cn/problem/P4779)。", "description": "如题，给出一个有向图，请输出从某一点出发到所有点的最短路径长度。", "inputFormat": "第一行包含三个整数 $n,m,s$，分别表示点的个数、有向边的个数、出发点的编号。\n\n接下来 $m$ 行每行包含三个整数 $u,v,w$，表示一条 $u \\to v$ 的，长度为 $w$ 的边。", "outputFormat": "输出一行 $n$ 个整数，第 $i$ 个表示 $s$ 到第 $i$ 个点的最短路径，若不能到达则输出 $2^{31}-1$。", "hint": "【数据范围】    \n对于 $20\\%$ 的数据：$1\\le n \\le 5$，$1\\le m \\le 15$；  \n对于 $40\\%$ 的数据：$1\\le n \\le 100$，$1\\le m \\le 10^4$；   \n对于 $70\\%$ 的数据：$1\\le n \\le 1000$，$1\\le m \\le 10^5$；   \n对于 $100\\%$ 的数据：$1 \\le n \\le 10^4$，$1\\le m \\le 5\\times 10^5$，$1\\le u,v\\le n$，$w\\ge 0$，$\\sum w< 2^{31}$，保证数据随机。\n\n**Update 2022/07/29：两个点之间可能有多条边，敬请注意。**\n\n对于真正 $100\\%$ 的数据，请移步 [P4779](https://www.luogu.com.cn/problem/P4779)。请注意，该题与本题数据范围略有不同。\n\n\n样例说明：\n\n![](https://cdn.luogu.com.cn/upload/pic/7641.png)\n\n图片 1 到 3 和 1 到 4 的文字位置调换", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Single-Source Shortest Path (Weakened Version)", "background": "The testdata for this problem is random. In exams, there may be adversarial testdata that makes SPFA fail; if needed, please refer to [P4779](https://www.luogu.org/problemnew/show/P4779).", "description": "As stated, given a directed graph, output the shortest path length from a specified vertex to every vertex.", "inputFormat": "The first line contains three integers $n, m, s$, denoting the number of vertices, the number of directed edges, and the index of the source vertex.\n\nEach of the next $m$ lines contains three integers $u, v, w$, denoting a directed edge $u \\to v$ with length $w$.", "outputFormat": "Output $n$ integers on one line. The $i$-th integer is the shortest path distance from $s$ to vertex $i$. If a vertex is unreachable, output $2^{31} - 1$.", "hint": "- Constraints  \n  For $20\\%$ of the testdata: $1 \\le n \\le 5$, $1 \\le m \\le 15$;  \n  For $40\\%$ of the testdata: $1 \\le n \\le 100$, $1 \\le m \\le 10^4$;  \n  For $70\\%$ of the testdata: $1 \\le n \\le 1000$, $1 \\le m \\le 10^5$;  \n  For $100\\%$ of the testdata: $1 \\le n \\le 10^4$, $1 \\le m \\le 5 \\times 10^5$, $1 \\le u, v \\le n$, $w \\ge 0$, $\\sum w < 2^{31}$; the testdata is guaranteed to be random.\n\n- Update 2022/07/29: There may be multiple edges between two vertices. Please take note.\n\n- For the full $100\\%$ testdata, please refer to [P4779](https://www.luogu.org/problemnew/show/P4779). Note that its constraints differ slightly from this problem.\n\nSample note:\n\n![](https://cdn.luogu.com.cn/upload/pic/7641.png)\n\nIn the image, the text positions for \"1 to 3\" and \"1 to 4\" are swapped.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】单源最短路径（弱化版）", "background": "本题测试数据为随机数据，在考试中可能会出现构造数据让 SPFA 不通过，如有需要请移步 [P4779](https://www.luogu.com.cn/problem/P4779)。", "description": "如题，给出一个有向图，请输出从某一点出发到所有点的最短路径长度。", "inputFormat": "第一行包含三个整数 $n,m,s$，分别表示点的个数、有向边的个数、出发点的编号。\n\n接下来 $m$ 行每行包含三个整数 $u,v,w$，表示一条 $u \\to v$ 的，长度为 $w$ 的边。", "outputFormat": "输出一行 $n$ 个整数，第 $i$ 个表示 $s$ 到第 $i$ 个点的最短路径，若不能到达则输出 $2^{31}-1$。", "hint": "【数据范围】    \n对于 $20\\%$ 的数据：$1\\le n \\le 5$，$1\\le m \\le 15$；  \n对于 $40\\%$ 的数据：$1\\le n \\le 100$，$1\\le m \\le 10^4$；   \n对于 $70\\%$ 的数据：$1\\le n \\le 1000$，$1\\le m \\le 10^5$；   \n对于 $100\\%$ 的数据：$1 \\le n \\le 10^4$，$1\\le m \\le 5\\times 10^5$，$1\\le u,v\\le n$，$w\\ge 0$，$\\sum w< 2^{31}$，保证数据随机。\n\n**Update 2022/07/29：两个点之间可能有多条边，敬请注意。**\n\n对于真正 $100\\%$ 的数据，请移步 [P4779](https://www.luogu.com.cn/problem/P4779)。请注意，该题与本题数据范围略有不同。\n\n\n样例说明：\n\n![](https://cdn.luogu.com.cn/upload/pic/7641.png)\n\n图片 1 到 3 和 1 到 4 的文字位置调换", "locale": "zh-CN"}}}
{"pid": "P3372", "type": "P", "difficulty": 4, "samples": [["5 5\n1 5 4 2 3\n2 2 4\n1 2 3 2\n2 3 4\n1 1 5 1\n2 1 4", "11\n8\n20"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["线段树", "模板题"], "title": "【模板】线段树 1", "background": "", "description": "如题，已知一个数列 $\\{a_i\\}$，你需要进行下面两种操作：\n\n1. 将某区间每一个数加上 $k$。\n2. 求出某区间每一个数的和。\n", "inputFormat": "第一行包含两个整数 $n, m$，分别表示该数列数字的个数和操作的总个数。\n\n第二行包含 $n$ 个用空格分隔的整数 $a_i$，其中第 $i$ 个数字表示数列第 $i$ 项的初始值。\n\n接下来 $m$ 行每行包含 $3$ 或 $4$ 个整数，表示一个操作，具体如下：\n\n1. `1 x y k`：将区间 $[x, y]$ 内每个数加上 $k$。\n2. `2 x y`：输出区间 $[x, y]$ 内每个数的和。", "outputFormat": "输出包含若干行整数，即为所有操作 2 的结果。", "hint": "对于 $15\\%$ 的数据：$n \\le 8$，$m \\le 10$。  \n对于 $35\\%$ 的数据：$n \\le {10}^3$，$m \\le {10}^4$。    \n对于 $100\\%$ 的数据：$1 \\le n, m \\le {10}^5$，$a_i,k$ 为正数，且任意时刻数列的和不超过 $2\\times 10^{18}$。\n\n**【样例解释】**\n\n![](https://cdn.luogu.com.cn/upload/pic/2251.png)", "locale": "zh-CN", "translations": {"en": {"title": "【Template】Segment Tree 1", "background": "", "description": "As stated, given a sequence $\\{a_i\\}$, you need to perform the following two operations:\n1. Add $k$ to every number in a given interval.\n2. Find the sum of all numbers in a given interval.", "inputFormat": "The first line contains two integers $n, m$, representing the number of elements in the sequence and the total number of operations.\n\nThe second line contains $n$ space-separated integers $a_i$, where the $i$-th integer is the initial value of the $i$-th element.\n\nEach of the next $m$ lines contains $3$ or $4$ integers representing an operation, as follows:\n1. `1 x y k`: add $k$ to every number in the interval $[x, y]$.\n2. `2 x y`: output the sum of all numbers in the interval $[x, y]$.", "outputFormat": "Output several lines of integers, which are the results of all type 2 operations.", "hint": "For 15% of the testdata: $n \\le 8$, $m \\le 10$.\nFor 35% of the testdata: $n \\le {10}^3$, $m \\le {10}^4$.\nFor 100% of the testdata: $1 \\le n, m \\le {10}^5$, $a_i, k$ are positive, and the sum of the sequence at any time does not exceed $2\\times 10^{18}$.\n\nSample Explanation.\n\n![](https://cdn.luogu.com.cn/upload/pic/2251.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】线段树 1", "background": "", "description": "如题，已知一个数列 $\\{a_i\\}$，你需要进行下面两种操作：\n\n1. 将某区间每一个数加上 $k$。\n2. 求出某区间每一个数的和。\n", "inputFormat": "第一行包含两个整数 $n, m$，分别表示该数列数字的个数和操作的总个数。\n\n第二行包含 $n$ 个用空格分隔的整数 $a_i$，其中第 $i$ 个数字表示数列第 $i$ 项的初始值。\n\n接下来 $m$ 行每行包含 $3$ 或 $4$ 个整数，表示一个操作，具体如下：\n\n1. `1 x y k`：将区间 $[x, y]$ 内每个数加上 $k$。\n2. `2 x y`：输出区间 $[x, y]$ 内每个数的和。", "outputFormat": "输出包含若干行整数，即为所有操作 2 的结果。", "hint": "对于 $15\\%$ 的数据：$n \\le 8$，$m \\le 10$。  \n对于 $35\\%$ 的数据：$n \\le {10}^3$，$m \\le {10}^4$。    \n对于 $100\\%$ 的数据：$1 \\le n, m \\le {10}^5$，$a_i,k$ 为正数，且任意时刻数列的和不超过 $2\\times 10^{18}$。\n\n**【样例解释】**\n\n![](https://cdn.luogu.com.cn/upload/pic/2251.png)", "locale": "zh-CN"}}}
{"pid": "P3373", "type": "P", "difficulty": 4, "samples": [["5 5 38\n1 5 4 2 3\n2 1 4 1\n3 2 5\n1 2 4 2\n2 3 5 5\n3 1 4", "17\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["线段树", "O2优化", "模板题"], "title": "【模板】线段树 2", "background": "", "description": "如题，已知一个数列 $a$，你需要进行下面三种操作：\n\n- 将某区间每一个数乘上 $x$；\n- 将某区间每一个数加上 $x$；\n- 求出某区间每一个数的和。", "inputFormat": "第一行包含三个整数 $n,q,m$，分别表示该数列数字的个数、操作的总个数和模数。\n\n第二行包含 $n$ 个用空格分隔的整数，其中第 $i$ 个数字表示数列第 $i$ 项的初始值 $a_i$。\n\n接下来 $q$ 行每行包含若干个整数，表示一个操作，具体如下：\n\n操作 $1$： 格式：`1 x y k`  含义：将区间 $[x,y]$ 内每个数乘上 $k$。\n\n操作 $2$： 格式：`2 x y k`  含义：将区间 $[x,y]$ 内每个数加上 $k$。\n\n操作 $3$： 格式：`3 x y`  含义：输出区间 $[x,y]$ 内每个数的和对 $m$ 取模所得的结果。", "outputFormat": "输出包含若干行整数，即为所有操作 $3$ 的结果。", "hint": "【数据范围】\n\n对于 $30\\%$ 的数据：$n \\le 8$，$q \\le 10$。  \n对于 $70\\%$ 的数据：$n \\le 10^3 $，$q \\le 10^4$。  \n对于 $100\\%$ 的数据：$1 \\le n \\le 10^5$，$1 \\le q \\le 10^5,1\\le a_i,k\\le 10^4$。\n\n除样例外，$m = 571373$。\n\n（数据已经过加强 ^\\_^）\n\n样例说明：\n\n ![](https://cdn.luogu.com.cn/upload/pic/2255.png) \n\n故输出应为 $17$、$2$（$40 \\bmod 38 = 2$）。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Segment Tree 2", "background": "", "description": "As stated, given a sequence $a$, you need to perform the following three operations:\n\n- Multiply every number in a given interval by $x$.\n- Add $x$ to every number in a given interval.\n- Find the sum of every number in a given interval.", "inputFormat": "The first line contains three integers $n, q, m$, representing the number of elements in the sequence, the total number of operations, and the modulus.\n\nThe second line contains $n$ space-separated integers, where the $i$-th number is the initial value $a_i$ of the $i$-th element.\n\nEach of the next $q$ lines contains several integers describing an operation, as follows:\n\nOperation 1: Format: `1 x y k`  Meaning: multiply every number in the interval $[x,y]$ by $k$.\n\nOperation 2: Format: `2 x y k`  Meaning: add $k$ to every number in the interval $[x,y]$.\n\nOperation 3: Format: `3 x y`  Meaning: output the sum of every number in the interval $[x,y]$ modulo $m$.", "outputFormat": "Output several lines of integers, which are the results of all operation 3.", "hint": "Constraints:\n\nFor $30\\%$ of the testdata: $n \\le 8$, $q \\le 10$.\nFor $70\\%$ of the testdata: $n \\le 10^3$, $q \\le 10^4$.\nFor $100\\%$ of the testdata: $1 \\le n \\le 10^5$, $1 \\le q \\le 10^5$, $1 \\le a_i, k \\le 10^4$.\n\nExcept for the samples, $m = 571373$.\n\n(The testdata has been strengthened ^\\_^.)\n\nSample explanation:\n\n![](https://cdn.luogu.com.cn/upload/pic/2255.png)\n\nTherefore, the outputs should be $17$ and $2$ ($40 \\bmod 38 = 2$).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】线段树 2", "background": "", "description": "如题，已知一个数列 $a$，你需要进行下面三种操作：\n\n- 将某区间每一个数乘上 $x$；\n- 将某区间每一个数加上 $x$；\n- 求出某区间每一个数的和。", "inputFormat": "第一行包含三个整数 $n,q,m$，分别表示该数列数字的个数、操作的总个数和模数。\n\n第二行包含 $n$ 个用空格分隔的整数，其中第 $i$ 个数字表示数列第 $i$ 项的初始值 $a_i$。\n\n接下来 $q$ 行每行包含若干个整数，表示一个操作，具体如下：\n\n操作 $1$： 格式：`1 x y k`  含义：将区间 $[x,y]$ 内每个数乘上 $k$。\n\n操作 $2$： 格式：`2 x y k`  含义：将区间 $[x,y]$ 内每个数加上 $k$。\n\n操作 $3$： 格式：`3 x y`  含义：输出区间 $[x,y]$ 内每个数的和对 $m$ 取模所得的结果。", "outputFormat": "输出包含若干行整数，即为所有操作 $3$ 的结果。", "hint": "【数据范围】\n\n对于 $30\\%$ 的数据：$n \\le 8$，$q \\le 10$。  \n对于 $70\\%$ 的数据：$n \\le 10^3 $，$q \\le 10^4$。  \n对于 $100\\%$ 的数据：$1 \\le n \\le 10^5$，$1 \\le q \\le 10^5,1\\le a_i,k\\le 10^4$。\n\n除样例外，$m = 571373$。\n\n（数据已经过加强 ^\\_^）\n\n样例说明：\n\n ![](https://cdn.luogu.com.cn/upload/pic/2255.png) \n\n故输出应为 $17$、$2$（$40 \\bmod 38 = 2$）。", "locale": "zh-CN"}}}
{"pid": "P3374", "type": "P", "difficulty": 4, "samples": [["5 5\n1 5 4 2 3\n1 1 3\n2 2 5\n1 3 -1\n1 4 2\n2 1 4", "14\n16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["树状数组", "模板题"], "title": "【模板】树状数组 1", "background": null, "description": "如题，已知一个数列，你需要进行下面两种操作：\n\n- 将某一个数加上 $x$；\n\n- 求出某区间每一个数的和。", "inputFormat": "第一行包含两个正整数 $n,m$，分别表示该数列数字的个数和操作的总个数。   \n \n第二行包含 $n$ 个用空格分隔的整数，其中第 $i$ 个数字表示数列第 $i$ 项的初始值。\n\n接下来 $m$ 行每行包含 $3$ 个整数，表示一个操作，具体如下：\n\n- `1 x k`  含义：将第 $x$ 个数加上 $k$；\n\n- `2 x y`  含义：输出区间 $[x,y]$ 内每个数的和。", "outputFormat": "输出包含若干行整数，即为所有操作 $2$ 的结果。", "hint": "【数据范围】\n\n对于 $30\\%$ 的数据，$1 \\le n \\le 8$，$1\\le m \\le 10$；   \n对于 $70\\%$ 的数据，$1\\le n,m \\le 10^4$；   \n对于 $100\\%$ 的数据，$1\\le n,m \\le 5\\times 10^5$，$1\\le x\\le y\\le n$，$-2^{31}\\le k<2^{31}$。\n\n数据保证对于任意时刻，$a$ 的任意子区间（包括长度为 $1$ 和 $n$ 的子区间）和均在 $[-2^{31}, 2^{31})$ 范围内。\n\n\n样例说明：\n\n ![](https://cdn.luogu.com.cn/upload/pic/2256.png) \n\n故输出结果 $14$ 和 $16$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Fenwick Tree 1", "background": "", "description": "As stated, given a sequence, you need to perform the following two operations:\n\n- Add $x$ to a certain number.\n- Find the sum of all numbers in a given interval.", "inputFormat": "The first line contains two positive integers $n, m$, representing the number of elements in the sequence and the total number of operations.\n\nThe second line contains $n$ space-separated integers, where the $i$-th number is the initial value of the $i$-th element of the sequence.\n\nEach of the next $m$ lines contains $3$ integers describing an operation, as follows:\n\n- `1 x k` Meaning: add $k$ to the $x$-th number.\n- `2 x y` Meaning: output the sum of all numbers in the interval $[x, y]$.", "outputFormat": "Output several lines of integers, which are the results of all type `2` operations.", "hint": "Constraints\n\nFor $30\\%$ of the testdata, $1 \\le n \\le 8$, $1 \\le m \\le 10$.\nFor $70\\%$ of the testdata, $1 \\le n, m \\le 10^4$.\nFor $100\\%$ of the testdata, $1 \\le n, m \\le 5 \\times 10^5$.\n\nIt is guaranteed that at any time, the sum of any subarray of $a$ (including subarrays of length $1$ and length $n$) lies in the range $[-2^{31}, 2^{31})$.\n\nSample explanation:\n\n![](https://cdn.luogu.com.cn/upload/pic/2256.png)\n\nTherefore, the output is $14$ and $16$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】树状数组 1", "background": null, "description": "如题，已知一个数列，你需要进行下面两种操作：\n\n- 将某一个数加上 $x$；\n\n- 求出某区间每一个数的和。", "inputFormat": "第一行包含两个正整数 $n,m$，分别表示该数列数字的个数和操作的总个数。   \n \n第二行包含 $n$ 个用空格分隔的整数，其中第 $i$ 个数字表示数列第 $i$ 项的初始值。\n\n接下来 $m$ 行每行包含 $3$ 个整数，表示一个操作，具体如下：\n\n- `1 x k`  含义：将第 $x$ 个数加上 $k$；\n\n- `2 x y`  含义：输出区间 $[x,y]$ 内每个数的和。", "outputFormat": "输出包含若干行整数，即为所有操作 $2$ 的结果。", "hint": "【数据范围】\n\n对于 $30\\%$ 的数据，$1 \\le n \\le 8$，$1\\le m \\le 10$；   \n对于 $70\\%$ 的数据，$1\\le n,m \\le 10^4$；   \n对于 $100\\%$ 的数据，$1\\le n,m \\le 5\\times 10^5$，$1\\le x\\le y\\le n$，$-2^{31}\\le k<2^{31}$。\n\n数据保证对于任意时刻，$a$ 的任意子区间（包括长度为 $1$ 和 $n$ 的子区间）和均在 $[-2^{31}, 2^{31})$ 范围内。\n\n\n样例说明：\n\n ![](https://cdn.luogu.com.cn/upload/pic/2256.png) \n\n故输出结果 $14$ 和 $16$。", "locale": "zh-CN"}}}
{"pid": "P3375", "type": "P", "difficulty": 4, "samples": [["ABABABC\nABA\n", "1\n3\n0 0 1 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["字符串", "O2优化", "KMP 算法", "模板题"], "title": "【模板】KMP", "background": null, "description": "给出两个字符串 $s_1$ 和 $s_2$，若 $s_1$ 的区间 $[l, r]$ 子串与 $s_2$ 完全相同，则称 $s_2$ 在 $s_1$ 中出现了，其出现位置为 $l$。  \n现在请你求出 $s_2$ 在 $s_1$ 中所有出现的位置。\n\n定义一个字符串 $s$ 的 border 为 $s$ 的一个**非 $s$ 本身**的子串 $t$，满足 $t$ 既是 $s$ 的前缀，又是 $s$ 的后缀。  \n对于 $s_2$，你还需要求出对于其每个前缀 $s'$ 的最长 border $t'$ 的长度。", "inputFormat": "第一行为一个字符串，即为 $s_1$。  \n第二行为一个字符串，即为 $s_2$。", "outputFormat": "首先输出若干行，每行一个整数，**按从小到大的顺序**输出 $s_2$ 在 $s_1$ 中出现的位置。  \n最后一行输出 $|s_2|$ 个整数，第 $i$ 个整数表示 $s_2$ 的长度为 $i$ 的前缀的最长 border 长度。", "hint": "### 样例 1 解释\n\n ![](https://cdn.luogu.com.cn/upload/pic/2257.png)。\n \n对于 $s_2$ 长度为 $3$ 的前缀 `ABA`，字符串 `A` 既是其后缀也是其前缀，且是最长的，因此最长 border 长度为 $1$。\n\n\n### 数据规模与约定\n\n**本题采用多测试点捆绑测试，共有 4 个子任务**。\n\n- Subtask 0（30 points）：$|s_1| \\leq 15$，$|s_2| \\leq 5$。\n- Subtask 1（40 points）：$|s_1| \\leq 10^4$，$|s_2| \\leq 10^2$。\n- Subtask 2（30 points）：无特殊约定。\n- Subtask 3（0 points）：Hack。\n\n对于全部的测试点，保证 $1 \\leq |s_1|,|s_2| \\leq 10^6$，$s_1, s_2$ 中均只含大写英文字母。", "locale": "zh-CN", "translations": {"en": {"title": "【Template】KMP", "background": "", "description": "Given two strings $s_1$ and $s_2$, if the substring of $s_1$ on the interval $[l, r]$ is exactly the same as $s_2$, then $s_2$ is said to occur in $s_1$, and its occurrence position is $l$.  \nNow please find all occurrence positions of $s_2$ in $s_1$.\n\nDefine the border of a string $s$ as a substring $t$ of $s$ that is **not the whole $s$**, and satisfies that $t$ is both a prefix and a suffix of $s$.  \nFor $s_2$, you also need to compute, for each of its prefixes $s'$, the length of the longest border $t'$.", "inputFormat": "The first line contains a string, which is $s_1$.  \nThe second line contains a string, which is $s_2$.", "outputFormat": "First output several lines, each with an integer, output the occurrence positions of $s_2$ in $s_1$ in increasing order.  \nThe last line outputs $|s_2|$ integers, where the $i$-th integer denotes the length of the longest border of the prefix of $s_2$ with length $i$.", "hint": "### Explanation for Sample 1\n\n![](https://cdn.luogu.com.cn/upload/pic/2257.png).\n\nFor the length-$3$ prefix `ABA` of $s_2$, the string `A` is both its suffix and its prefix, and it is the longest one, so the longest border length is $1$.\n\n### Constraints and Notes\n\nThis problem uses bundled test points, with 4 subtasks.\n\n- Subtask 0 (30 points): $|s_1| \\leq 15$, $|s_2| \\leq 5$.\n- Subtask 1 (40 points): $|s_1| \\leq 10^4$, $|s_2| \\leq 10^2$.\n- Subtask 2 (30 points): No special constraints.\n- Subtask 3 (0 points): Hack.\n\nFor all test points, it is guaranteed that $1 \\leq |s_1|, |s_2| \\leq 10^6$, and both $s_1$ and $s_2$ contain only uppercase English letters.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】KMP", "background": null, "description": "给出两个字符串 $s_1$ 和 $s_2$，若 $s_1$ 的区间 $[l, r]$ 子串与 $s_2$ 完全相同，则称 $s_2$ 在 $s_1$ 中出现了，其出现位置为 $l$。  \n现在请你求出 $s_2$ 在 $s_1$ 中所有出现的位置。\n\n定义一个字符串 $s$ 的 border 为 $s$ 的一个**非 $s$ 本身**的子串 $t$，满足 $t$ 既是 $s$ 的前缀，又是 $s$ 的后缀。  \n对于 $s_2$，你还需要求出对于其每个前缀 $s'$ 的最长 border $t'$ 的长度。", "inputFormat": "第一行为一个字符串，即为 $s_1$。  \n第二行为一个字符串，即为 $s_2$。", "outputFormat": "首先输出若干行，每行一个整数，**按从小到大的顺序**输出 $s_2$ 在 $s_1$ 中出现的位置。  \n最后一行输出 $|s_2|$ 个整数，第 $i$ 个整数表示 $s_2$ 的长度为 $i$ 的前缀的最长 border 长度。", "hint": "### 样例 1 解释\n\n ![](https://cdn.luogu.com.cn/upload/pic/2257.png)。\n \n对于 $s_2$ 长度为 $3$ 的前缀 `ABA`，字符串 `A` 既是其后缀也是其前缀，且是最长的，因此最长 border 长度为 $1$。\n\n\n### 数据规模与约定\n\n**本题采用多测试点捆绑测试，共有 4 个子任务**。\n\n- Subtask 0（30 points）：$|s_1| \\leq 15$，$|s_2| \\leq 5$。\n- Subtask 1（40 points）：$|s_1| \\leq 10^4$，$|s_2| \\leq 10^2$。\n- Subtask 2（30 points）：无特殊约定。\n- Subtask 3（0 points）：Hack。\n\n对于全部的测试点，保证 $1 \\leq |s_1|,|s_2| \\leq 10^6$，$s_1, s_2$ 中均只含大写英文字母。", "locale": "zh-CN"}}}
{"pid": "P3376", "type": "P", "difficulty": 5, "samples": [["4 5 4 3\n4 2 30\n4 3 20\n2 3 20\n2 1 30\n1 3 30\n", "50\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["网络流", "O2优化", "模板题"], "title": "【模板】网络最大流", "background": "", "description": "如题，给出一个网络图，以及其源点和汇点，求出其网络最大流。\n", "inputFormat": "第一行包含四个正整数 $n,m,s,t$，分别表示点的个数、有向边的个数、源点序号、汇点序号。\n\n接下来 $m$ 行每行包含三个正整数 $u_i,v_i,w_i$，表示第 $i$ 条有向边从 $u_i$ 出发，到达 $v_i$，边权为 $w_i$（即该边最大流量为 $w_i$）。", "outputFormat": "一行，包含一个正整数，即为该网络的最大流。\n", "hint": "#### 样例输入输出 1 解释\n\n ![](https://cdn.luogu.com.cn/upload/pic/2262.png) \n\n题目中存在 $3$ 条路径：\n\n- $4\\to 2\\to 3$，该路线可通过 $20$ 的流量。\n- $4\\to 3$，可通过 $20$ 的流量。\n- $4\\to 2\\to 1\\to 3$，可通过 $10$ 的流量（边 $4\\to 2$ 之前已经耗费了 $20$ 的流量）。\n\n故流量总计 $20+20+10=50$。输出 $50$。\n\n---\n\n#### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，保证 $n\\leq10$，$m\\leq25$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n\\leq200$，$1 \\leq m\\leq 5000$，$0 \\leq w\\lt 2^{31}$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Network Maximum Flow", "background": "", "description": "As stated, given a network graph and its source and sink, compute the maximum flow of this network.", "inputFormat": "The first line contains four positive integers $n, m, s, t$, denoting the number of vertices, the number of directed edges, the index of the source, and the index of the sink, respectively.\n\nEach of the next $m$ lines contains three positive integers $u_i, v_i, w_i$, meaning that the $i$-th directed edge goes from $u_i$ to $v_i$ with capacity $w_i$ (i.e., the maximum flow on this edge is $w_i$).", "outputFormat": "One line containing a single positive integer, which is the maximum flow of the network.", "hint": "#### Explanation for Sample Input/Output 1\n\n![](https://cdn.luogu.com.cn/upload/pic/2262.png)\n\nThere are $3$ paths in the figure:\n\n- $4 \\to 2 \\to 3$, which can carry a flow of $20$.\n- $4 \\to 3$, which can carry a flow of $20$.\n- $4 \\to 2 \\to 1 \\to 3$, which can carry a flow of $10$ (edge $4 \\to 2$ has already used $20$ units of flow beforehand).\n\nTherefore, the total flow is $20 + 20 + 10 = 50$. Output $50$.\n\n---\n\n#### Constraints\n\n- For $30\\%$ of the testdata, it is guaranteed that $n \\le 10$, $m \\le 25$.\n- For $100\\%$ of the testdata, it is guaranteed that $1 \\le n \\le 200$, $1 \\le m \\le 5000$, $0 \\le w < 2^{31}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】网络最大流", "background": "", "description": "如题，给出一个网络图，以及其源点和汇点，求出其网络最大流。\n", "inputFormat": "第一行包含四个正整数 $n,m,s,t$，分别表示点的个数、有向边的个数、源点序号、汇点序号。\n\n接下来 $m$ 行每行包含三个正整数 $u_i,v_i,w_i$，表示第 $i$ 条有向边从 $u_i$ 出发，到达 $v_i$，边权为 $w_i$（即该边最大流量为 $w_i$）。", "outputFormat": "一行，包含一个正整数，即为该网络的最大流。\n", "hint": "#### 样例输入输出 1 解释\n\n ![](https://cdn.luogu.com.cn/upload/pic/2262.png) \n\n题目中存在 $3$ 条路径：\n\n- $4\\to 2\\to 3$，该路线可通过 $20$ 的流量。\n- $4\\to 3$，可通过 $20$ 的流量。\n- $4\\to 2\\to 1\\to 3$，可通过 $10$ 的流量（边 $4\\to 2$ 之前已经耗费了 $20$ 的流量）。\n\n故流量总计 $20+20+10=50$。输出 $50$。\n\n---\n\n#### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，保证 $n\\leq10$，$m\\leq25$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n\\leq200$，$1 \\leq m\\leq 5000$，$0 \\leq w\\lt 2^{31}$。\n", "locale": "zh-CN"}}}
{"pid": "P3377", "type": "P", "difficulty": 5, "samples": [["5 5\n1 5 4 2 3\n1 1 5\n1 2 5\n2 2\n1 4 2\n2 2", "1\n2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["可并堆", "模板题"], "title": "【模板】可并堆 1", "background": null, "description": "如题，一开始有 $n$ 个小根堆，每个堆包含且仅包含一个数。接下来需要支持两种操作：\n\n1. `1 x y`：将第 $x$ 个数和第 $y$ 个数所在的小根堆合并（若第 $x$ 或第 $y$ 个数已经被删除或第 $x$ 和第 $y$ 个数在同一个堆内，则无视此操作）。\n\n2. `2 x`：输出第 $x$ 个数所在的堆最小数，并将这个最小数删除（若有多个最小数，优先删除先输入的；若第 $x$ 个数已经被删除，则输出 $-1$ 并无视删除操作）。", "inputFormat": "第一行包含两个正整数 $n, m$，分别表示一开始小根堆的个数和接下来操作的个数。\n\n第二行包含 $n$ 个正整数，其中第 $i$ 个正整数表示第 $i$ 个小根堆初始时包含且仅包含的数。\n\n接下来 $m$ 行每行 $2$ 个或 $3$ 个正整数，表示一条操作，格式如下：\n\n操作 $1$：`1 x y`\n\n操作 $2$：`2 x`", "outputFormat": "输出包含若干行整数，分别依次对应每一个操作 $2$ 所得的结果。", "hint": "**【数据规模】**\n\n对于 $30\\%$ 的数据：$n\\le 10$，$m\\le 10$。  \n对于 $70\\%$ 的数据：$n\\le 10^3$，$m\\le 10^3$。  \n对于 $100\\%$ 的数据：$n\\le 10^5$，$m\\le 10^5$，初始时小根堆中的所有数都在 `int` 范围内。\n\n**【样例解释】**\n\n初始状态下，五个小根堆分别为：$\\{1\\}$、$\\{5\\}$、$\\{4\\}$、$\\{2\\}$、$\\{3\\}$。\n\n第一次操作，将第 $1$ 个数所在的小根堆与第 $5$ 个数所在的小根堆合并，故变为四个小根堆：$\\{1,3\\}$、$\\{5\\}$、$\\{4\\}$、$\\{2\\}$。\n\n第二次操作，将第 $2$ 个数所在的小根堆与第 $5$ 个数所在的小根堆合并，故变为三个小根堆：$\\{1,3,5\\}$、$\\{4\\}$、$\\{2\\}$。\n\n第三次操作，将第 $2$ 个数所在的小根堆的最小值输出并删除，故输出 $1$，第一个数被删除，三个小根堆为：$\\{3,5\\}$、$\\{4\\}$、$\\{2\\}$。\n\n第四次操作，将第 $4$ 个数所在的小根堆与第 $2$ 个数所在的小根堆合并，故变为两个小根堆：$\\{2,3,5\\}$、$\\{4\\}$。\n\n第五次操作，将第 $2$ 个数所在的小根堆的最小值输出并删除，故输出 $2$，第四个数被删除，两个小根堆为：$\\{3,5\\}$、$\\{4\\}$。\n\n故输出依次为 $1$、$2$。", "locale": "zh-CN", "translations": {"en": {"title": "【Template】Meldable Heap 1", "background": "", "description": "As stated, initially there are $n$ min-heaps, each containing exactly one number. Afterwards, you need to support two types of operations:\n\n1. `1 x y`: Merge the min-heap containing the $x$-th number and the min-heap containing the $y$-th number (if the $x$-th or $y$-th number has already been deleted, or if the $x$-th and $y$-th numbers are in the same heap, ignore this operation).\n\n2. `2 x`: Output the minimum number in the heap containing the $x$-th number, and delete this minimum number (if there are multiple minimum numbers, delete the one that was inserted earlier; if the $x$-th number has already been deleted, output $-1$ and ignore the deletion).", "inputFormat": "The first line contains two positive integers $n, m$, representing the initial number of min-heaps and the number of subsequent operations, respectively.\n\nThe second line contains $n$ positive integers, where the $i$-th integer is the only number initially contained in the $i$-th min-heap.\n\nEach of the next $m$ lines contains $2$ or $3$ positive integers, representing one operation in the following formats:\n\nOperation 1: `1 x y`\n\nOperation 2: `2 x`", "outputFormat": "The output contains several lines of integers, each corresponding to the result of an operation of type `2`, in order.", "hint": "【Constraints】\n\nFor $30\\%$ of the testdata: $n \\le 10$, $m \\le 10$.  \nFor $70\\%$ of the testdata: $n \\le 10^3$, $m \\le 10^3$.  \nFor $100\\%$ of the testdata: $n \\le 10^5$, $m \\le 10^5$, and all initial numbers in the min-heaps are within the `int` range.\n\n【Sample Explanation】\n\nInitially, the five min-heaps are: $\\{1\\}$, $\\{5\\}$, $\\{4\\}$, $\\{2\\}$, $\\{3\\}$.\n\nIn the first operation, merge the heap containing the $1$-st number with the heap containing the $5$-th number, resulting in four min-heaps: $\\{1,3\\}$, $\\{5\\}$, $\\{4\\}$, $\\{2\\}$.\n\nIn the second operation, merge the heap containing the $2$-nd number with the heap containing the $5$-th number, resulting in three min-heaps: $\\{1,3,5\\}$, $\\{4\\}$, $\\{2\\}$.\n\nIn the third operation, output and delete the minimum of the heap containing the $2$-nd number, so output $1$; the first number is deleted, and the three min-heaps become: $\\{3,5\\}$, $\\{4\\}$, $\\{2\\}$.\n\nIn the fourth operation, merge the heap containing the $4$-th number with the heap containing the $2$-nd number, resulting in two min-heaps: $\\{2,3,5\\}$, $\\{4\\}$.\n\nIn the fifth operation, output and delete the minimum of the heap containing the $2$-nd number, so output $2$; the fourth number is deleted, and the two min-heaps become: $\\{3,5\\}$, $\\{4\\}$.\n\nTherefore, the outputs are $1$ and $2$ in order.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】可并堆 1", "background": null, "description": "如题，一开始有 $n$ 个小根堆，每个堆包含且仅包含一个数。接下来需要支持两种操作：\n\n1. `1 x y`：将第 $x$ 个数和第 $y$ 个数所在的小根堆合并（若第 $x$ 或第 $y$ 个数已经被删除或第 $x$ 和第 $y$ 个数在同一个堆内，则无视此操作）。\n\n2. `2 x`：输出第 $x$ 个数所在的堆最小数，并将这个最小数删除（若有多个最小数，优先删除先输入的；若第 $x$ 个数已经被删除，则输出 $-1$ 并无视删除操作）。", "inputFormat": "第一行包含两个正整数 $n, m$，分别表示一开始小根堆的个数和接下来操作的个数。\n\n第二行包含 $n$ 个正整数，其中第 $i$ 个正整数表示第 $i$ 个小根堆初始时包含且仅包含的数。\n\n接下来 $m$ 行每行 $2$ 个或 $3$ 个正整数，表示一条操作，格式如下：\n\n操作 $1$：`1 x y`\n\n操作 $2$：`2 x`", "outputFormat": "输出包含若干行整数，分别依次对应每一个操作 $2$ 所得的结果。", "hint": "**【数据规模】**\n\n对于 $30\\%$ 的数据：$n\\le 10$，$m\\le 10$。  \n对于 $70\\%$ 的数据：$n\\le 10^3$，$m\\le 10^3$。  \n对于 $100\\%$ 的数据：$n\\le 10^5$，$m\\le 10^5$，初始时小根堆中的所有数都在 `int` 范围内。\n\n**【样例解释】**\n\n初始状态下，五个小根堆分别为：$\\{1\\}$、$\\{5\\}$、$\\{4\\}$、$\\{2\\}$、$\\{3\\}$。\n\n第一次操作，将第 $1$ 个数所在的小根堆与第 $5$ 个数所在的小根堆合并，故变为四个小根堆：$\\{1,3\\}$、$\\{5\\}$、$\\{4\\}$、$\\{2\\}$。\n\n第二次操作，将第 $2$ 个数所在的小根堆与第 $5$ 个数所在的小根堆合并，故变为三个小根堆：$\\{1,3,5\\}$、$\\{4\\}$、$\\{2\\}$。\n\n第三次操作，将第 $2$ 个数所在的小根堆的最小值输出并删除，故输出 $1$，第一个数被删除，三个小根堆为：$\\{3,5\\}$、$\\{4\\}$、$\\{2\\}$。\n\n第四次操作，将第 $4$ 个数所在的小根堆与第 $2$ 个数所在的小根堆合并，故变为两个小根堆：$\\{2,3,5\\}$、$\\{4\\}$。\n\n第五次操作，将第 $2$ 个数所在的小根堆的最小值输出并删除，故输出 $2$，第四个数被删除，两个小根堆为：$\\{3,5\\}$、$\\{4\\}$。\n\n故输出依次为 $1$、$2$。", "locale": "zh-CN"}}}
{"pid": "P3378", "type": "P", "difficulty": 3, "samples": [["5\n1 2\n1 5\n2\n3\n2\n", "2\n5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["堆", "O2优化", "模板题"], "title": "【模板】堆", "background": "", "description": "给定一个数列，初始为空，请支持下面三种操作：\n\n1. 给定一个整数 $x$，请将 $x$ 加入到数列中。\n2. 输出数列中最小的数。\n3. 删除数列中最小的数（如果有多个数最小，只删除 $1$ 个）。\n\n\n", "inputFormat": "第一行是一个整数，表示操作的次数 $n$。  \n接下来 $n$ 行，每行表示一次操作。每行首先有一个整数 $op$ 表示操作类型。\n- 若 $op = 1$，则后面有一个整数 $x$，表示要将 $x$ 加入数列。\n- 若 $op = 2$，则表示要求输出数列中的最小数。\n- 若 $op = 3$，则表示删除数列中的最小数。如果有多个数最小，只删除 $1$ 个。", "outputFormat": "对于每个操作 $2$，输出一行一个整数表示答案。", "hint": "**【数据规模与约定】**\n- 对于 $30\\%$ 的数据，保证 $n \\leq 15$。\n- 对于 $70\\%$ 的数据，保证 $n \\leq 10^4$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 10^6$，$1 \\leq x \\lt 2^{31}$，$op \\in \\{1, 2, 3\\}$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Heap", "background": "", "description": "Given a sequence that is initially empty, support the following three operations:\n1. Given an integer $x$, insert $x$ into the sequence.\n2. Output the smallest number in the sequence.\n3. Delete the smallest number in the sequence (if multiple numbers are smallest, delete only $1$).", "inputFormat": "The first line contains an integer $n$ representing the number of operations.  \nThen follow $n$ lines, each describing one operation. Each line first contains an integer $op$ indicating the operation type.\n- If $op = 1$, then an integer $x$ follows, meaning to insert $x$ into the sequence.\n- If $op = 2$, it means to output the smallest number in the sequence.\n- If $op = 3$, it means to delete the smallest number in the sequence. If multiple numbers are smallest, delete only $1$.", "outputFormat": "For each operation $2$, output one line with one integer representing the answer.", "hint": "**Constraints**\n- For $30\\%$ of the testdata, it is guaranteed that $n \\leq 15$.\n- For $70\\%$ of the testdata, it is guaranteed that $n \\leq 10^4$.\n- For $100\\%$ of the testdata, it is guaranteed that $1 \\leq n \\leq 10^6$, $1 \\leq x \\lt 2^{31}$, $op \\in \\{1, 2, 3\\}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】堆", "background": "", "description": "给定一个数列，初始为空，请支持下面三种操作：\n\n1. 给定一个整数 $x$，请将 $x$ 加入到数列中。\n2. 输出数列中最小的数。\n3. 删除数列中最小的数（如果有多个数最小，只删除 $1$ 个）。\n\n\n", "inputFormat": "第一行是一个整数，表示操作的次数 $n$。  \n接下来 $n$ 行，每行表示一次操作。每行首先有一个整数 $op$ 表示操作类型。\n- 若 $op = 1$，则后面有一个整数 $x$，表示要将 $x$ 加入数列。\n- 若 $op = 2$，则表示要求输出数列中的最小数。\n- 若 $op = 3$，则表示删除数列中的最小数。如果有多个数最小，只删除 $1$ 个。", "outputFormat": "对于每个操作 $2$，输出一行一个整数表示答案。", "hint": "**【数据规模与约定】**\n- 对于 $30\\%$ 的数据，保证 $n \\leq 15$。\n- 对于 $70\\%$ 的数据，保证 $n \\leq 10^4$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 10^6$，$1 \\leq x \\lt 2^{31}$，$op \\in \\{1, 2, 3\\}$。", "locale": "zh-CN"}}}
{"pid": "P3379", "type": "P", "difficulty": 3, "samples": [["5 5 4\n3 1\n2 4\n5 1\n1 4\n2 4\n3 2\n3 5\n1 2\n4 5", "4\n4\n1\n4\n4\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "最近公共祖先 LCA", "模板题"], "title": "【模板】最近公共祖先（LCA）", "background": null, "description": "如题，给定一棵有根多叉树，请求出指定两个点直接最近的公共祖先。", "inputFormat": "第一行包含三个正整数 $N,M,S$，分别表示树的结点个数、询问的个数和树根结点的序号。\n\n接下来 $N-1$ 行每行包含两个正整数 $x, y$，表示 $x$ 结点和 $y$ 结点之间有一条直接连接的边（数据保证可以构成树）。\n\n接下来 $M$ 行每行包含两个正整数 $a, b$，表示询问 $a$ 结点和 $b$ 结点的最近公共祖先。", "outputFormat": "输出包含 $M$ 行，每行包含一个正整数，依次为每一个询问的结果。", "hint": "对于 $30\\%$ 的数据，$N\\leq 10$，$M\\leq 10$。\n\n对于 $70\\%$ 的数据，$N\\leq 10000$，$M\\leq 10000$。\n\n对于 $100\\%$ 的数据，$1 \\leq N,M\\leq 5\\times10^5$，$1 \\leq x, y,a ,b \\leq N$，**不保证** $a \\neq b$。\n\n\n样例说明：\n\n该树结构如下：\n\n ![](https://cdn.luogu.com.cn/upload/pic/2282.png) \n\n第一次询问：$2, 4$ 的最近公共祖先，故为 $4$。\n\n第二次询问：$3, 2$ 的最近公共祖先，故为 $4$。\n\n第三次询问：$3, 5$ 的最近公共祖先，故为 $1$。\n\n第四次询问：$1, 2$ 的最近公共祖先，故为 $4$。\n\n第五次询问：$4, 5$ 的最近公共祖先，故为 $4$。\n\n故输出依次为 $4, 4, 1, 4, 4$。\n\n\n2021/10/4 数据更新 @fstqwq：应要求加了两组数据卡掉了暴力跳。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Lowest Common Ancestor (LCA)", "background": "", "description": "As stated, given a rooted multi-branch tree, find the lowest common ancestor of the specified two nodes.", "inputFormat": "The first line contains three positive integers $N,M,S$, which denote the number of nodes in the tree, the number of queries, and the index of the root node, respectively.\n\nEach of the next $N-1$ lines contains two positive integers $x, y$, indicating that there is a directly connected edge between node $x$ and node $y$ (the testdata guarantees the edges form a tree).\n\nEach of the next $M$ lines contains two positive integers $a, b$, asking for the lowest common ancestor of node $a$ and node $b$.", "outputFormat": "Output $M$ lines, each containing one positive integer, which are the answers to the queries in order.", "hint": "Constraints:\n\n- For $30\\%$ of the testdata, $N\\leq 10$, $M\\leq 10$.\n- For $70\\%$ of the testdata, $N\\leq 10000$, $M\\leq 10000$.\n- For $100\\%$ of the testdata, $1 \\leq N,M\\leq 5\\times10^5$, $1 \\leq x, y,a ,b \\leq N$, and it is not guaranteed that $a \\neq b$.\n\nSample explanation:\n\nThe tree structure is as follows:\n\n![](https://cdn.luogu.com.cn/upload/pic/2282.png)\n\n- First query: the lowest common ancestor of $2, 4$ is $4$.\n- Second query: the lowest common ancestor of $3, 2$ is $4$.\n- Third query: the lowest common ancestor of $3, 5$ is $1$.\n- Fourth query: the lowest common ancestor of $1, 2$ is $4$.\n- Fifth query: the lowest common ancestor of $4, 5$ is $4$.\n\nTherefore, the outputs are $4, 4, 1, 4, 4$ in order.\n\n2021/10/4 testdata update @fstqwq: Added two more sets of testdata to block brute-force jumping.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】最近公共祖先（LCA）", "background": null, "description": "如题，给定一棵有根多叉树，请求出指定两个点直接最近的公共祖先。", "inputFormat": "第一行包含三个正整数 $N,M,S$，分别表示树的结点个数、询问的个数和树根结点的序号。\n\n接下来 $N-1$ 行每行包含两个正整数 $x, y$，表示 $x$ 结点和 $y$ 结点之间有一条直接连接的边（数据保证可以构成树）。\n\n接下来 $M$ 行每行包含两个正整数 $a, b$，表示询问 $a$ 结点和 $b$ 结点的最近公共祖先。", "outputFormat": "输出包含 $M$ 行，每行包含一个正整数，依次为每一个询问的结果。", "hint": "对于 $30\\%$ 的数据，$N\\leq 10$，$M\\leq 10$。\n\n对于 $70\\%$ 的数据，$N\\leq 10000$，$M\\leq 10000$。\n\n对于 $100\\%$ 的数据，$1 \\leq N,M\\leq 5\\times10^5$，$1 \\leq x, y,a ,b \\leq N$，**不保证** $a \\neq b$。\n\n\n样例说明：\n\n该树结构如下：\n\n ![](https://cdn.luogu.com.cn/upload/pic/2282.png) \n\n第一次询问：$2, 4$ 的最近公共祖先，故为 $4$。\n\n第二次询问：$3, 2$ 的最近公共祖先，故为 $4$。\n\n第三次询问：$3, 5$ 的最近公共祖先，故为 $1$。\n\n第四次询问：$1, 2$ 的最近公共祖先，故为 $4$。\n\n第五次询问：$4, 5$ 的最近公共祖先，故为 $4$。\n\n故输出依次为 $4, 4, 1, 4, 4$。\n\n\n2021/10/4 数据更新 @fstqwq：应要求加了两组数据卡掉了暴力跳。", "locale": "zh-CN"}}}
{"pid": "P3380", "type": "P", "difficulty": 6, "samples": [["9 6\n4 2 2 1 9 4 0 1 1\n2 1 4 3\n3 4 10\n2 1 4 3\n1 2 5 9\n4 3 9 5\n5 2 8 5", "2\n4\n3\n4\n9"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["线段树", "平衡树", "树状数组", "树套树", "分块", "模板题"], "title": "【模板】树套树", "background": "", "description": "您需要写一种数据结构（可参考题目标题），来维护一个有序数列，其中需要提供以下操作：\n\n1. 查询 $k$ 在区间内的排名；\n2. 查询区间内排名为 $k$ 的值；\n3. 修改某一位置上的数值；\n4. 查询 $k$ 在区间内的前驱（前驱定义为严格小于 $x$，且最大的数，**若不存在输出 `-2147483647`**）；\n5. 查询 $k$ 在区间内的后继（后继定义为严格大于 $x$，且最小的数，**若不存在输出 `2147483647`**）。\n\n对于一组元素，一个数的排名被定义为严格比它小的元素个数加一，而排名为 $k$ 的数被定义为“将元素从小到大排序后排在第 $k$ 位的元素值”。", "inputFormat": "第一行两个数 $n,m$，表示长度为 $n$ 的有序序列和 $m$ 个操作。\n\n第二行有 $n$ 个数，表示有序序列。\n\n下面有 $m$ 行，$opt$ 表示操作标号。\n\n若 $opt=1$，则为操作 $1$，之后有三个数 $l~r~k$，表示查询 $k$ 在区间 $[l,r]$ 的排名。\n\n若 $opt=2$，则为操作 $2$，之后有三个数 $l~r~k$，表示查询区间 $[l,r]$ 内排名为    $k$ 的数。\n\n若 $opt=3$，则为操作 $3$，之后有两个数 $pos~k$，表示将 $pos$ 位置的数修改为 $k$。\n\n若 $opt=4$，则为操作 $4$，之后有三个数 $l~r~k$，表示查询区间 $[l,r]$ 内 $k$ 的前驱。\n\n若 $opt=5$，则为操作 $5$，之后有三个数 $l~r~k$，表示查询区间 $[l,r]$ 内 $k$ 的后继。", "outputFormat": "对于操作 $1,2,4,5$，各输出一行，表示查询结果。", "hint": "$1\\le n,m\\le5\\times 10^4$，序列中的值在任何时刻 $\\in[0,10^8]$。\n\n题目来源：bzoj3196 / Tyvj1730，在此鸣谢。\n\n此数据为洛谷原创。**（特别提醒：此数据不保证操作 4、5 一定存在，故请务必考虑不存在的情况。）**", "locale": "zh-CN", "translations": {"en": {"title": "【Template】Tree of Trees", "background": "", "description": "You need to implement a data structure (you may refer to the problem title) to maintain a sequence, supporting the following operations:\n1. Query the rank of $k$ within a range.\n2. Query the value whose rank is $k$ within a range.\n3. Modify the value at a certain position.\n4. Query the predecessor of $k$ within a range (the predecessor is defined as the largest number that is strictly less than $k$, and if it does not exist, output **`-2147483647`**).\n5. Query the successor of $k$ within a range (the successor is defined as the smallest number that is strictly greater than $k$, and if it does not exist, output **`2147483647`**).\n\nFor a set of elements, the rank of a number is defined as the count of elements strictly smaller than it plus one, and the number with rank $k$ is defined as “the element that would be at position $k$ after sorting the elements in ascending order.”", "inputFormat": "The first line contains two integers $n, m$, denoting a sequence of length $n$ and $m$ operations.\n\nThe second line contains $n$ integers, representing the sequence.\n\nThe next $m$ lines each contain an operation, where $opt$ denotes the operation id.\n\nIf $opt=1$, it is operation 1. Then there are three integers $l~r~k$, meaning: query the rank of $k$ in the range $[l,r]$.\n\nIf $opt=2$, it is operation 2. Then there are three integers $l~r~k$, meaning: query the number whose rank is $k$ in the range $[l,r]$.\n\nIf $opt=3$, it is operation 3. Then there are two integers $pos~k$, meaning: modify the value at position $pos$ to $k$.\n\nIf $opt=4$, it is operation 4. Then there are three integers $l~r~k$, meaning: query the predecessor of $k$ in the range $[l,r]$.\n\nIf $opt=5$, it is operation 5. Then there are three integers $l~r~k$, meaning: query the successor of $k$ in the range $[l,r]$.", "outputFormat": "For operations $1, 2, 4, 5$, output one line for each query, representing the result.", "hint": "Constraints: $1\\le n,m\\le 5\\times 10^4$, and the values in the sequence are always in $[0, 10^8]$ at any time.\n\nProblem source: bzoj3196 / Tyvj1730, with thanks.\n\nThis testdata is original to Luogu. Special reminder: this testdata does not guarantee that the answers for operations 4 and 5 always exist, so please be sure to handle the nonexistence cases.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】树套树", "background": "", "description": "您需要写一种数据结构（可参考题目标题），来维护一个有序数列，其中需要提供以下操作：\n\n1. 查询 $k$ 在区间内的排名；\n2. 查询区间内排名为 $k$ 的值；\n3. 修改某一位置上的数值；\n4. 查询 $k$ 在区间内的前驱（前驱定义为严格小于 $x$，且最大的数，**若不存在输出 `-2147483647`**）；\n5. 查询 $k$ 在区间内的后继（后继定义为严格大于 $x$，且最小的数，**若不存在输出 `2147483647`**）。\n\n对于一组元素，一个数的排名被定义为严格比它小的元素个数加一，而排名为 $k$ 的数被定义为“将元素从小到大排序后排在第 $k$ 位的元素值”。", "inputFormat": "第一行两个数 $n,m$，表示长度为 $n$ 的有序序列和 $m$ 个操作。\n\n第二行有 $n$ 个数，表示有序序列。\n\n下面有 $m$ 行，$opt$ 表示操作标号。\n\n若 $opt=1$，则为操作 $1$，之后有三个数 $l~r~k$，表示查询 $k$ 在区间 $[l,r]$ 的排名。\n\n若 $opt=2$，则为操作 $2$，之后有三个数 $l~r~k$，表示查询区间 $[l,r]$ 内排名为    $k$ 的数。\n\n若 $opt=3$，则为操作 $3$，之后有两个数 $pos~k$，表示将 $pos$ 位置的数修改为 $k$。\n\n若 $opt=4$，则为操作 $4$，之后有三个数 $l~r~k$，表示查询区间 $[l,r]$ 内 $k$ 的前驱。\n\n若 $opt=5$，则为操作 $5$，之后有三个数 $l~r~k$，表示查询区间 $[l,r]$ 内 $k$ 的后继。", "outputFormat": "对于操作 $1,2,4,5$，各输出一行，表示查询结果。", "hint": "$1\\le n,m\\le5\\times 10^4$，序列中的值在任何时刻 $\\in[0,10^8]$。\n\n题目来源：bzoj3196 / Tyvj1730，在此鸣谢。\n\n此数据为洛谷原创。**（特别提醒：此数据不保证操作 4、5 一定存在，故请务必考虑不存在的情况。）**", "locale": "zh-CN"}}}
{"pid": "P3381", "type": "P", "difficulty": 5, "samples": [["4 5 4 3\n4 2 30 2\n4 3 20 3\n2 3 20 1\n2 1 30 9\n1 3 40 5", "50 280"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["网络流", "O2优化", "费用流", "模板题"], "title": "【模板】最小费用最大流", "background": "", "description": "\n给出一个包含 $n$ 个点和 $m$ 条边的有向图（下面称其为网络） $G=(V,E)$，该网络上所有点分别编号为 $1 \\sim n$，所有边分别编号为 $1\\sim m$，其中该网络的源点为 $s$，汇点为 $t$，网络上的每条边 $(u,v)$ 都有一个流量限制 $w(u,v)$ 和单位流量的费用 $c(u,v)$。\n\n你需要给每条边 $(u,v)$ 确定一个流量 $f(u,v)$，要求：\n\n1.  $0 \\leq f(u,v) \\leq w(u,v)$（每条边的流量不超过其流量限制）；\n2. $\\forall p \\in \\{V \\setminus \\{s,t\\}\\}$，$\\sum_{(i,p) \\in E}f(i,p)=\\sum_{(p,i)\\in E}f(p,i)$（除了源点和汇点外，其他各点流入的流量和流出的流量相等）；\n3. $\\sum_{(s,i)\\in E}f(s,i)=\\sum_{(i,t)\\in E}f(i,t)$（源点流出的流量等于汇点流入的流量）。\n\n定义网络 $G$ 的流量 $F(G)=\\sum_{(s,i)\\in E}f(s,i)$，网络 $G$ 的费用 $C(G)=\\sum_{(i,j)\\in E} f(i,j) \\times c(i,j)$。\n\n你需要求出该网络的**最小费用最大流**，即在 $F(G)$ 最大的前提下，使 $C(G)$ 最小。", "inputFormat": "输入第一行包含四个整数 $n,m,s,t$，分别代表该网络的点数 $n$，网络的边数 $m$，源点编号 $s$，汇点编号 $t$。\n\n接下来 $m$ 行，每行四个整数 $u_i,v_i,w_i,c_i$，分别代表第 $i$ 条边的起点，终点，流量限制，单位流量费用。", "outputFormat": "输出两个整数，分别为该网络的最大流 $F(G)$，以及在 $F(G)$ 最大的前提下，该网络的最小费用 $C(G)$。", "hint": "对于 $100\\%$ 的数据，$1 \\leq n \\leq 5\\times 10^3$，$1 \\leq m \\leq 5 \\times 10^4$，$1 \\leq s,t \\leq n$，$u_i \\neq v_i$，$0 \\leq w_i,c_i \\leq 10^3$，且该网络的最大流和最小费用 $\\leq 2^{31}-1$。\n\n输入数据随机生成。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Minimum Cost Maximum Flow", "background": "", "description": "Given a directed graph (hereinafter referred to as a network) $G=(V,E)$ with $n$ vertices and $m$ edges. The vertices are numbered $1 \\sim n$, and the edges are numbered $1 \\sim m$. The source of the network is $s$, and the sink is $t$. Each edge $(u,v)$ has a capacity limit $w(u,v)$ and a unit cost $c(u,v)$.\n\nYou need to assign a flow $f(u,v)$ to each edge $(u,v)$ such that:\n1. $0 \\leq f(u,v) \\leq w(u,v)$ (the flow on each edge does not exceed its capacity limit);\n2. $\\forall p \\in \\{V \\setminus \\{s,t\\}\\}$, $\\sum_{(i,p) \\in E} f(i,p) = \\sum_{(p,i) \\in E} f(p,i)$ (for all vertices except the source and the sink, the total inflow equals the total outflow);\n3. $\\sum_{(s,i) \\in E} f(s,i) = \\sum_{(i,t) \\in E} f(i,t)$ (the total flow leaving the source equals the total flow entering the sink).\n\nDefine the network flow $F(G)=\\sum_{(s,i)\\in E} f(s,i)$ and the network cost $C(G)=\\sum_{(i,j)\\in E} f(i,j) \\times c(i,j)$.\n\nYou need to find the minimum-cost maximum flow of the network, that is, maximize $F(G)$ and, subject to that, minimize $C(G)$.", "inputFormat": "The first line contains four integers $n,m,s,t$, representing the number of vertices, the number of edges, the index of the source, and the index of the sink, respectively.\n\nEach of the next $m$ lines contains four integers $u_i,v_i,w_i,c_i$, representing the start vertex, end vertex, capacity limit, and unit cost of the $i$-th edge.", "outputFormat": "Output two integers: the maximum flow $F(G)$ and, subject to $F(G)$ being maximum, the minimum cost $C(G)$.", "hint": "Constraints:\n\nFor $100\\%$ of the testdata, $1 \\leq n \\leq 5 \\times 10^3$, $1 \\leq m \\leq 5 \\times 10^4$, $1 \\leq s,t \\leq n$, $u_i \\neq v_i$, $0 \\leq w_i,c_i \\leq 10^3$, and the network’s maximum flow and minimum cost $\\leq 2^{31}-1$.\n\nThe testdata is randomly generated.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】最小费用最大流", "background": "", "description": "\n给出一个包含 $n$ 个点和 $m$ 条边的有向图（下面称其为网络） $G=(V,E)$，该网络上所有点分别编号为 $1 \\sim n$，所有边分别编号为 $1\\sim m$，其中该网络的源点为 $s$，汇点为 $t$，网络上的每条边 $(u,v)$ 都有一个流量限制 $w(u,v)$ 和单位流量的费用 $c(u,v)$。\n\n你需要给每条边 $(u,v)$ 确定一个流量 $f(u,v)$，要求：\n\n1.  $0 \\leq f(u,v) \\leq w(u,v)$（每条边的流量不超过其流量限制）；\n2. $\\forall p \\in \\{V \\setminus \\{s,t\\}\\}$，$\\sum_{(i,p) \\in E}f(i,p)=\\sum_{(p,i)\\in E}f(p,i)$（除了源点和汇点外，其他各点流入的流量和流出的流量相等）；\n3. $\\sum_{(s,i)\\in E}f(s,i)=\\sum_{(i,t)\\in E}f(i,t)$（源点流出的流量等于汇点流入的流量）。\n\n定义网络 $G$ 的流量 $F(G)=\\sum_{(s,i)\\in E}f(s,i)$，网络 $G$ 的费用 $C(G)=\\sum_{(i,j)\\in E} f(i,j) \\times c(i,j)$。\n\n你需要求出该网络的**最小费用最大流**，即在 $F(G)$ 最大的前提下，使 $C(G)$ 最小。", "inputFormat": "输入第一行包含四个整数 $n,m,s,t$，分别代表该网络的点数 $n$，网络的边数 $m$，源点编号 $s$，汇点编号 $t$。\n\n接下来 $m$ 行，每行四个整数 $u_i,v_i,w_i,c_i$，分别代表第 $i$ 条边的起点，终点，流量限制，单位流量费用。", "outputFormat": "输出两个整数，分别为该网络的最大流 $F(G)$，以及在 $F(G)$ 最大的前提下，该网络的最小费用 $C(G)$。", "hint": "对于 $100\\%$ 的数据，$1 \\leq n \\leq 5\\times 10^3$，$1 \\leq m \\leq 5 \\times 10^4$，$1 \\leq s,t \\leq n$，$u_i \\neq v_i$，$0 \\leq w_i,c_i \\leq 10^3$，且该网络的最大流和最小费用 $\\leq 2^{31}-1$。\n\n输入数据随机生成。", "locale": "zh-CN"}}}
{"pid": "P3382", "type": "P", "difficulty": 3, "samples": [["3 -0.9981 0.5\n1 -3 -3 1", "-0.41421"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["二分", "三分", "Special Judge"], "title": "三分", "background": "本题可能存在严重精度问题，部分数据下难以通过。本题数据较水，仅供参考。", "description": "如题，给出一个 $N$ 次函数，保证在范围 $[l, r]$ 内存在一点 $x$，使得 $[l, x]$ 上单调增，$[x, r]$ 上单调减。试求出 $x$ 的值。", "inputFormat": "第一行一次包含一个正整数 $N$ 和两个实数 $l, r$，含义如题目描述所示。\n\n第二行包含 $N + 1$ 个实数，从高到低依次表示该 $N$ 次函数各项的系数。", "outputFormat": "输出为一行，包含一个实数，即为 $x$ 的值。若你的答案满足以下二者之一，则算正确：\n- 你的答案 $x'$ 与标准答案 $x$ 的相对或绝对误差不超过 $10^{-5}$。\n- 你的答案 $x'$ 与标准答案 $x$ 对应的函数值，即 $f(x') $ 和 $f(x)$ 的相对或绝对误差不超过 $10^{-5}$。\n\n", "hint": "对于 $100\\%$ 的数据，$6 \\le N \\le 13$，函数系数均在 $[-100,100]$ 内且至多 $15$ 位小数，$|l|,|r|\\leq 10$ 且至多 $15$ 位小数。$l\\leq r$。\n\n**【样例解释】**\n\n ![](https://cdn.luogu.com.cn/upload/pic/2297.png) \n\n如图所示，红色段即为该函数 $f(x) = x^3 - 3 x^2 - 3x + 1$ 在区间 $[-0.9981, 0.5]$ 上的图像。\n\n当 $x = -0.41421$ 时图像位于最高点，故此时函数在 $[l, x]$ 上单调增，$[x, r]$ 上单调减，故 $x = -0.41421$，输出 $-0.41421$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Ternary Search", "background": "This problem may have severe precision issues and can be hard to pass on some testdata. The testdata is relatively weak and is for reference only.", "description": "As stated, you are given an $N$-th degree polynomial. It is guaranteed that within the interval $[l, r]$ there exists a point $x$ such that the function is monotonically increasing on $[l, x]$ and monotonically decreasing on $[x, r]$. Find the value of $x$.", "inputFormat": "The first line contains a positive integer $N$ and two real numbers $l, r$, as described above.\n\nThe second line contains $N + 1$ real numbers, representing the coefficients of the $N$-th degree polynomial from highest degree to lowest.", "outputFormat": "Output one line containing a real number, which is the value of $x$. Your answer is considered correct if it satisfies either of the following:\n- Your answer $x'$ has a relative or absolute error not exceeding $10^{-5}$ compared to the standard answer $x$.\n- The function values corresponding to your answer and the standard answer, that is, $f(x')$ and $f(x)$, have a relative or absolute error not exceeding $10^{-5}$.", "hint": "For $100\\%$ of the testdata, $6 \\le N \\le 13$, the coefficients of the polynomial are in $[-100, 100]$ with up to $15$ decimal places, $|l|, |r| \\le 10$ with up to $15$ decimal places, and $l \\le r$.\n\nSample Explanation:\n\n![](https://cdn.luogu.com.cn/upload/pic/2297.png)\n\nAs shown in the figure, the red segment is the graph of the function $f(x) = x^3 - 3 x^2 - 3x + 1$ on the interval $[-0.9981, 0.5]$.\n\nWhen $x = -0.41421$, the graph reaches its highest point, so the function is monotonically increasing on $[l, x]$ and monotonically decreasing on $[x, r]$. Therefore $x = -0.41421$, and the output is $-0.41421$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "三分", "background": "本题可能存在严重精度问题，部分数据下难以通过。本题数据较水，仅供参考。", "description": "如题，给出一个 $N$ 次函数，保证在范围 $[l, r]$ 内存在一点 $x$，使得 $[l, x]$ 上单调增，$[x, r]$ 上单调减。试求出 $x$ 的值。", "inputFormat": "第一行一次包含一个正整数 $N$ 和两个实数 $l, r$，含义如题目描述所示。\n\n第二行包含 $N + 1$ 个实数，从高到低依次表示该 $N$ 次函数各项的系数。", "outputFormat": "输出为一行，包含一个实数，即为 $x$ 的值。若你的答案满足以下二者之一，则算正确：\n- 你的答案 $x'$ 与标准答案 $x$ 的相对或绝对误差不超过 $10^{-5}$。\n- 你的答案 $x'$ 与标准答案 $x$ 对应的函数值，即 $f(x') $ 和 $f(x)$ 的相对或绝对误差不超过 $10^{-5}$。\n\n", "hint": "对于 $100\\%$ 的数据，$6 \\le N \\le 13$，函数系数均在 $[-100,100]$ 内且至多 $15$ 位小数，$|l|,|r|\\leq 10$ 且至多 $15$ 位小数。$l\\leq r$。\n\n**【样例解释】**\n\n ![](https://cdn.luogu.com.cn/upload/pic/2297.png) \n\n如图所示，红色段即为该函数 $f(x) = x^3 - 3 x^2 - 3x + 1$ 在区间 $[-0.9981, 0.5]$ 上的图像。\n\n当 $x = -0.41421$ 时图像位于最高点，故此时函数在 $[l, x]$ 上单调增，$[x, r]$ 上单调减，故 $x = -0.41421$，输出 $-0.41421$。\n", "locale": "zh-CN"}}}
{"pid": "P3383", "type": "P", "difficulty": 2, "samples": [["100 5\n1\n2\n3\n4\n5", "2\n3\n5\n7\n11"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "O2优化", "素数判断,质数,筛法", "模板题"], "title": "【模板】线性筛素数", "background": "本题已更新，从判断素数改为了查询第 $k$ 小的素数。  \n\n提示：本题输入输出、运算数据量较大。\n\n- 对于 C++ 语言，如果你使用 `cin` 来输入输出，建议使用 `std::ios::sync_with_stdio(0)` 来加速，同时使用 `'\\n'` 换行输出。\n- 对于 Java 语言，使用线性筛并且优化输入输出，也可以在规定时限内通过本题，但是时限可能较紧张。\n- 对于 Python 语言，语言性能差异较大，需要使用到 `numpy` 库的数组以替代列表，且使用埃氏筛法，依然可以在合适的时间和内存消耗下通过本题。", "description": "如题，给定一个范围 $n$，有 $q$ 个询问，每次输出第 $k$ 小的素数。\n", "inputFormat": "第一行包含两个正整数 $n,q$，分别表示查询的范围和查询的个数。\n\n接下来 $q$ 行每行一个正整数 $k$，表示查询第 $k$ 小的素数。", "outputFormat": "输出 $q$ 行，每行一个正整数表示答案。", "hint": "【数据范围】  \n对于 $100\\%$ 的数据，$n = 10^8$，$1 \\le q \\le 10^6$，保证查询的素数不大于 $n$。\n\nData by NaCly\\_Fish.\n", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Linear Sieve for Primes", "background": "This problem has been updated: it now asks for querying the $k$-th smallest prime instead of primality testing.\n\nHint: The input/output and computation workload can be large.\n\n- For C++: if you use `cin` for I/O, consider `std::ios::sync_with_stdio(0)` for acceleration, and use `'\\n'` for newlines.\n- For Java: using a linear sieve with optimized I/O can pass within the time limit, though it may be tight.\n- For Python: performance varies widely by implementation; using arrays from the `numpy` library instead of lists, together with the Sieve of Eratosthenes, can still pass within reasonable time and memory limits.", "description": "Given an upper bound $n$ and $q$ queries, for each query output the $k$-th smallest prime number.", "inputFormat": "The first line contains two positive integers $n, q$, representing the query range and the number of queries.\n\nEach of the next $q$ lines contains a positive integer $k$, asking for the $k$-th smallest prime.", "outputFormat": "Output $q$ lines, each containing a single integer as the answer.", "hint": "Constraints  \nFor $100\\%$ of the testdata, $n = 10^8$, $1 \\le q \\le 10^6$, and it is guaranteed that the requested primes do not exceed $n$.\n\nData by NaCly\\_Fish.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】线性筛素数", "background": "本题已更新，从判断素数改为了查询第 $k$ 小的素数。  \n\n提示：本题输入输出、运算数据量较大。\n\n- 对于 C++ 语言，如果你使用 `cin` 来输入输出，建议使用 `std::ios::sync_with_stdio(0)` 来加速，同时使用 `'\\n'` 换行输出。\n- 对于 Java 语言，使用线性筛并且优化输入输出，也可以在规定时限内通过本题，但是时限可能较紧张。\n- 对于 Python 语言，语言性能差异较大，需要使用到 `numpy` 库的数组以替代列表，且使用埃氏筛法，依然可以在合适的时间和内存消耗下通过本题。", "description": "如题，给定一个范围 $n$，有 $q$ 个询问，每次输出第 $k$ 小的素数。\n", "inputFormat": "第一行包含两个正整数 $n,q$，分别表示查询的范围和查询的个数。\n\n接下来 $q$ 行每行一个正整数 $k$，表示查询第 $k$ 小的素数。", "outputFormat": "输出 $q$ 行，每行一个正整数表示答案。", "hint": "【数据范围】  \n对于 $100\\%$ 的数据，$n = 10^8$，$1 \\le q \\le 10^6$，保证查询的素数不大于 $n$。\n\nData by NaCly\\_Fish.\n", "locale": "zh-CN"}}}
{"pid": "P3384", "type": "P", "difficulty": 5, "samples": [["5 5 2 24\n7 3 7 8 0 \n1 2\n1 5\n3 1\n4 1\n3 4 2\n3 2 2\n4 5\n1 5 1 3\n2 1 3", "2\n21"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["线段树", "树状数组", "树链剖分", "模板题"], "title": "【模板】重链剖分 / 树链剖分", "background": "", "description": "如题，已知一棵包含 $N$ 个结点的树（连通且无环），每个节点上包含一个数值，需要支持以下操作：\n\n- `1 x y z`，表示将树从 $x$ 到 $y$ 结点最短路径上所有节点的值都加上 $z$。\n\n- `2 x y`，表示求树从 $x$ 到 $y$ 结点最短路径上所有节点的值之和。\n\n- `3 x z`，表示将以 $x$ 为根节点的子树内所有节点值都加上 $z$。\n\n- `4 x`，表示求以 $x$ 为根节点的子树内所有节点值之和。", "inputFormat": "第一行包含 $4$ 个正整数 $N,M,R,P$，分别表示树的结点个数、操作个数、根节点序号和取模数（**即所有的输出结果均对此取模**）。\n\n接下来一行包含 $N$ 个非负整数，分别依次表示各个节点上初始的数值。\n\n接下来 $N-1$ 行每行包含两个整数 $x,y$，表示点 $x$ 和点 $y$ 之间连有一条边（保证无环且连通）。\n\n接下来 $M$ 行每行包含若干个正整数，每行表示一个操作。", "outputFormat": "输出包含若干行，分别依次表示每个操作 $2$ 或操作 $4$ 所得的结果（**对 $P$ 取模**）。", "hint": "**【数据规模】**\n\n对于 $30\\%$ 的数据： $1 \\leq N \\leq 10$，$1 \\leq M \\leq 10$；\n\n对于 $70\\%$ 的数据： $1 \\leq N \\leq {10}^3$，$1 \\leq M \\leq {10}^3$；\n\n对于 $100\\%$ 的数据： $1\\le N \\leq {10}^5$，$1\\le M \\leq {10}^5$，$1\\le R\\le N$，$1\\le P \\le 2^{30}$。所有输入的数均在 `int` 范围内。\n\n**【样例说明】**\n\n树的结构如下：\n\n![](https://cdn.luogu.com.cn/upload/pic/2319.png)\n\n各个操作如下：\n\n![](https://cdn.luogu.com.cn/upload/pic/2320.png)\n\n故输出应依次为 $2$ 和 $21$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Heavy-Light Decomposition / Tree Chain Decomposition", "background": "", "description": "As stated, given a tree with $N$ nodes (connected and acyclic), each node stores a value. Support the following operations:\n\n- `1 x y z`: add $z$ to the value of every node on the shortest path from $x$ to $y$ in the tree.\n- `2 x y`: query the sum of values of all nodes on the shortest path from $x$ to $y$ in the tree.\n- `3 x z`: add $z$ to the value of every node in the subtree rooted at $x$.\n- `4 x`: query the sum of values of all nodes in the subtree rooted at $x$.", "inputFormat": "The first line contains $4$ positive integers $N, M, R, P$, representing the number of nodes in the tree, the number of operations, the index of the root, and the modulus, respectively (i.e., all outputs are taken modulo this).\n\nThe next line contains $N$ non-negative integers, representing the initial value at each node in order.\n\nThe next $N-1$ lines each contain two integers $x, y$, indicating an edge between nodes $x$ and $y$ (guaranteed acyclic and connected).\n\nThe next $M$ lines each contain several positive integers; each line represents one operation.", "outputFormat": "Output several lines, each being the result of operation type `2` or `4` (taken modulo $P$), in order.", "hint": "**[Constraints]**\n\nFor $30\\%$ of the testdata: $1 \\leq N \\leq 10$, $1 \\leq M \\leq 10$.\n\nFor $70\\%$ of the testdata: $1 \\leq N \\leq {10}^3$, $1 \\leq M \\leq {10}^3$.\n\nFor $100\\%$ of the testdata: $1 \\le N \\le {10}^5$, $1 \\le M \\le {10}^5$, $1 \\le R \\le N$, $1 \\le P \\le 2^{30}$. All input numbers are within the `int` range.\n\n**[Sample Explanation]**\n\nThe structure of the tree is as follows:\n\n![](https://cdn.luogu.com.cn/upload/pic/2319.png)\n\nThe operations are as follows:\n\n![](https://cdn.luogu.com.cn/upload/pic/2320.png)\n\nTherefore, the outputs should be $2$ and $21$ in order.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】重链剖分 / 树链剖分", "background": "", "description": "如题，已知一棵包含 $N$ 个结点的树（连通且无环），每个节点上包含一个数值，需要支持以下操作：\n\n- `1 x y z`，表示将树从 $x$ 到 $y$ 结点最短路径上所有节点的值都加上 $z$。\n\n- `2 x y`，表示求树从 $x$ 到 $y$ 结点最短路径上所有节点的值之和。\n\n- `3 x z`，表示将以 $x$ 为根节点的子树内所有节点值都加上 $z$。\n\n- `4 x`，表示求以 $x$ 为根节点的子树内所有节点值之和。", "inputFormat": "第一行包含 $4$ 个正整数 $N,M,R,P$，分别表示树的结点个数、操作个数、根节点序号和取模数（**即所有的输出结果均对此取模**）。\n\n接下来一行包含 $N$ 个非负整数，分别依次表示各个节点上初始的数值。\n\n接下来 $N-1$ 行每行包含两个整数 $x,y$，表示点 $x$ 和点 $y$ 之间连有一条边（保证无环且连通）。\n\n接下来 $M$ 行每行包含若干个正整数，每行表示一个操作。", "outputFormat": "输出包含若干行，分别依次表示每个操作 $2$ 或操作 $4$ 所得的结果（**对 $P$ 取模**）。", "hint": "**【数据规模】**\n\n对于 $30\\%$ 的数据： $1 \\leq N \\leq 10$，$1 \\leq M \\leq 10$；\n\n对于 $70\\%$ 的数据： $1 \\leq N \\leq {10}^3$，$1 \\leq M \\leq {10}^3$；\n\n对于 $100\\%$ 的数据： $1\\le N \\leq {10}^5$，$1\\le M \\leq {10}^5$，$1\\le R\\le N$，$1\\le P \\le 2^{30}$。所有输入的数均在 `int` 范围内。\n\n**【样例说明】**\n\n树的结构如下：\n\n![](https://cdn.luogu.com.cn/upload/pic/2319.png)\n\n各个操作如下：\n\n![](https://cdn.luogu.com.cn/upload/pic/2320.png)\n\n故输出应依次为 $2$ 和 $21$。", "locale": "zh-CN"}}}
{"pid": "P3385", "type": "P", "difficulty": 3, "samples": [["2\n3 4\n1 2 2\n1 3 4\n2 3 1\n3 1 -3\n3 3\n1 2 3\n2 3 4\n3 1 -8\n", "NO\nYES\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["图论", "O2优化", "负权环", "模板题"], "title": "【模板】负环", "background": "", "description": "给定一个 $n$ 个点的有向图，请求出图中是否存在**从顶点 $1$ 出发能到达**的负环。\n\n负环的定义是：一条边权之和为负数的回路。", "inputFormat": "**本题单测试点有多组测试数据**。\n\n输入的第一行是一个整数 $T$，表示测试数据的组数。对于每组数据的格式如下：\n\n第一行有两个整数，分别表示图的点数 $n$ 和接下来给出边信息的条数 $m$。\n\n接下来 $m$ 行，每行三个整数 $u, v, w$。\n\n- 若 $w \\geq 0$，则表示存在一条从 $u$ 至 $v$ 边权为 $w$ 的边，还存在一条从 $v$ 至 $u$ 边权为 $w$ 的边。\n- 若 $w < 0$，则只表示存在一条从 $u$ 至 $v$ 边权为 $w$ 的边。", "outputFormat": "对于每组数据，输出一行一个字符串，若所求负环存在，则输出 `YES`，否则输出 `NO`。", "hint": "#### 数据规模与约定\n\n对于全部的测试点，保证：\n\n- $1 \\leq n \\leq 2 \\times 10^3$，$1 \\leq m \\leq 3 \\times 10^3$。\n- $1 \\leq u, v \\leq n$，$-10^4 \\leq w \\leq 10^4$。\n- $1 \\leq T \\leq 10$。\n\n#### 提示\n\n请注意，$m$ **不是**图的边数。", "locale": "zh-CN", "translations": {"en": {"title": "【Template】Negative Cycle", "background": "", "description": "Given a directed graph with $n$ vertices, determine whether there exists a negative cycle that is **reachable from vertex $1$**.\n\nA negative cycle is defined as a cycle whose sum of edge weights is negative.", "inputFormat": "This problem contains multiple groups of testdata in a single test point.\n\nThe first line contains an integer $T$, representing the number of groups of testdata. For each group, the format is as follows:\n\nThe first line contains two integers, the number of vertices $n$ and the number of lines $m$ of edge information that follow.\n\nThen follow $m$ lines, each with three integers $u, v, w$.\n\n- If $w \\geq 0$, then there exists an edge from $u$ to $v$ with weight $w$, and also an edge from $v$ to $u$ with weight $w$.\n- If $w < 0$, then there exists only an edge from $u$ to $v$ with weight $w$.", "outputFormat": "For each group of testdata, output one line containing a string. Print `YES` if such a negative cycle exists, otherwise print `NO`.", "hint": "#### Constraints and Conventions\n\nFor all test points, it is guaranteed that:\n\n- $1 \\leq n \\leq 2 \\times 10^3$, $1 \\leq m \\leq 3 \\times 10^3$.\n- $1 \\leq u, v \\leq n$, $-10^4 \\leq w \\leq 10^4$.\n- $1 \\leq T \\leq 10$.\n\n#### Hint\n\nPlease note that $m$ is **not** the number of edges of the graph.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】负环", "background": "", "description": "给定一个 $n$ 个点的有向图，请求出图中是否存在**从顶点 $1$ 出发能到达**的负环。\n\n负环的定义是：一条边权之和为负数的回路。", "inputFormat": "**本题单测试点有多组测试数据**。\n\n输入的第一行是一个整数 $T$，表示测试数据的组数。对于每组数据的格式如下：\n\n第一行有两个整数，分别表示图的点数 $n$ 和接下来给出边信息的条数 $m$。\n\n接下来 $m$ 行，每行三个整数 $u, v, w$。\n\n- 若 $w \\geq 0$，则表示存在一条从 $u$ 至 $v$ 边权为 $w$ 的边，还存在一条从 $v$ 至 $u$ 边权为 $w$ 的边。\n- 若 $w < 0$，则只表示存在一条从 $u$ 至 $v$ 边权为 $w$ 的边。", "outputFormat": "对于每组数据，输出一行一个字符串，若所求负环存在，则输出 `YES`，否则输出 `NO`。", "hint": "#### 数据规模与约定\n\n对于全部的测试点，保证：\n\n- $1 \\leq n \\leq 2 \\times 10^3$，$1 \\leq m \\leq 3 \\times 10^3$。\n- $1 \\leq u, v \\leq n$，$-10^4 \\leq w \\leq 10^4$。\n- $1 \\leq T \\leq 10$。\n\n#### 提示\n\n请注意，$m$ **不是**图的边数。", "locale": "zh-CN"}}}
{"pid": "P3386", "type": "P", "difficulty": 4, "samples": [["1 1 1\n1 1\n", "1"], ["4 2 7\n3 1\n1 2\n3 2\n1 1\n4 2\n4 1\n1 1\n", "2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "二分图", "模板题"], "title": "【模板】二分图最大匹配", "background": "", "description": "给定一个二分图，其左部点的个数为 $n$，右部点的个数为 $m$，边数为 $e$，求其最大匹配的边数。\n\n左部点从 $1$ 至 $n$ 编号，右部点从 $1$ 至 $m$ 编号。", "inputFormat": "输入的第一行是三个整数，分别代表 $n$，$m$ 和 $e$。\n\n接下来 $e$ 行，每行两个整数 $u, v$，表示存在一条连接左部点 $u$ 和右部点 $v$ 的边。", "outputFormat": "输出一行一个整数，代表二分图最大匹配的边数。", "hint": "#### 数据规模与约定\n\n对于全部的测试点，保证：\n- $1 \\leq n, m \\leq 500$。\n- $1 \\leq e \\leq 5 \\times 10^4$。\n- $1 \\leq u \\leq n$，$1 \\leq v \\leq m$。\n\n**不保证给出的图没有重边**。\n", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Maximum Bipartite Matching", "background": "", "description": "Given a bipartite graph with $n$ left vertices, $m$ right vertices, and $e$ edges, find the size of its maximum matching.\n\nThe left vertices are numbered from $1$ to $n$, and the right vertices are numbered from $1$ to $m$.", "inputFormat": "The first line contains three integers, representing $n$, $m$, and $e$.\n\nThe next $e$ lines each contain two integers $u, v$, indicating that there is an edge connecting left vertex $u$ and right vertex $v$.", "outputFormat": "Output a single integer on one line, representing the size of the maximum matching of the bipartite graph.", "hint": "#### Constraints\n\nFor all test points, it is guaranteed that:\n- $1 \\leq n, m \\leq 500$.\n- $1 \\leq e \\leq 5 \\times 10^4$.\n- $1 \\leq u \\leq n$, $1 \\leq v \\leq m$.\n\nThe given graph is not guaranteed to be free of multiple edges.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】二分图最大匹配", "background": "", "description": "给定一个二分图，其左部点的个数为 $n$，右部点的个数为 $m$，边数为 $e$，求其最大匹配的边数。\n\n左部点从 $1$ 至 $n$ 编号，右部点从 $1$ 至 $m$ 编号。", "inputFormat": "输入的第一行是三个整数，分别代表 $n$，$m$ 和 $e$。\n\n接下来 $e$ 行，每行两个整数 $u, v$，表示存在一条连接左部点 $u$ 和右部点 $v$ 的边。", "outputFormat": "输出一行一个整数，代表二分图最大匹配的边数。", "hint": "#### 数据规模与约定\n\n对于全部的测试点，保证：\n- $1 \\leq n, m \\leq 500$。\n- $1 \\leq e \\leq 5 \\times 10^4$。\n- $1 \\leq u \\leq n$，$1 \\leq v \\leq m$。\n\n**不保证给出的图没有重边**。\n", "locale": "zh-CN"}}}
{"pid": "P3387", "type": "P", "difficulty": 4, "samples": [["2 2\n1 1\n1 2\n2 1", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["图论", "拓扑排序", "强连通分量", "Tarjan", "模板题"], "title": "【模板】缩点", "background": "", "description": "给定一个 $n$ 个点 $m$ 条边有向图，每个点有一个权值，求一条路径，使路径经过的点权值之和最大。你只需要求出这个权值和。\n\n允许多次经过一条边或者一个点，但是，重复经过的点，权值只计算一次。\n", "inputFormat": "第一行两个正整数 $n,m$。\n\n第二行 $n$ 个整数，其中第 $i$ 个数 $a_i$ 表示点 $i$ 的点权。\n\n第三至 $m+2$ 行，每行两个整数 $u,v$，表示一条 $u\\rightarrow v$ 的有向边。\n", "outputFormat": "共一行，最大的点权之和。\n", "hint": "对于 $100\\%$ 的数据，$1\\le n \\le 10^4$，$1\\le m \\le 10^5$，$0\\le a_i\\le 10^3$。\n\n- 2024-11-1 添加了 [hack 数据](https://www.luogu.com.cn/discuss/964940)；", "locale": "zh-CN", "translations": {"en": {"title": "[Template] SCC Condensation", "background": "", "description": "Given a directed graph with $n$ vertices and $m$ edges, each vertex has a weight. Find a path such that the sum of the weights of the vertices visited is maximized. You only need to output this sum.\n\nYou are allowed to traverse an edge or a vertex multiple times. However, if a vertex is visited repeatedly, its weight is counted only once.", "inputFormat": "The first line contains two positive integers $n, m$.\n\nThe second line contains $n$ integers, where the $i$-th number $a_i$ is the weight of vertex $i$.\n\nLines 3 through $m+2$ each contain two integers $u, v$, indicating a directed edge $u \\rightarrow v$.", "outputFormat": "Output a single line with the maximum sum of vertex weights.", "hint": "Constraints: For $100\\%$ of the testdata, $1 \\le n \\le 10^4$, $1 \\le m \\le 10^5$, $0 \\le a_i \\le 10^3$.\n\n- 2024-11-1 Added [hack testdata](https://www.luogu.com.cn/discuss/964940).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】缩点", "background": "", "description": "给定一个 $n$ 个点 $m$ 条边有向图，每个点有一个权值，求一条路径，使路径经过的点权值之和最大。你只需要求出这个权值和。\n\n允许多次经过一条边或者一个点，但是，重复经过的点，权值只计算一次。\n", "inputFormat": "第一行两个正整数 $n,m$。\n\n第二行 $n$ 个整数，其中第 $i$ 个数 $a_i$ 表示点 $i$ 的点权。\n\n第三至 $m+2$ 行，每行两个整数 $u,v$，表示一条 $u\\rightarrow v$ 的有向边。\n", "outputFormat": "共一行，最大的点权之和。\n", "hint": "对于 $100\\%$ 的数据，$1\\le n \\le 10^4$，$1\\le m \\le 10^5$，$0\\le a_i\\le 10^3$。\n\n- 2024-11-1 添加了 [hack 数据](https://www.luogu.com.cn/discuss/964940)；", "locale": "zh-CN"}}}
{"pid": "P3388", "type": "P", "difficulty": 4, "samples": [["6 7\n1 2\n1 3\n1 4\n2 5\n3 5\n4 5\n5 6", "1 \n5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["Tarjan", "双连通分量", "模板题"], "title": "【模板】割点（割顶）", "background": "割点", "description": "给出一个 $n$ 个点，$m$ 条边的无向图，求图的割点。", "inputFormat": "第一行输入两个正整数 $n,m$。\n\n下面 $m$ 行每行输入两个正整数 $x,y$ 表示 $x$ 到 $y$ 有一条边。", "outputFormat": "第一行输出割点个数。\n\n第二行按照节点编号从小到大输出节点，用空格隔开。", "hint": "对于全部数据，$1\\leq n \\le 2\\times 10^4$，$1\\leq m \\le 1 \\times 10^5$。\n\n点的编号均大于 $0$ 小于等于 $n$。\n\n**Tarjan 图不一定连通。**", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Articulation Points (Cut Vertices)", "background": "Articulation points.", "description": "Given an undirected graph with $n$ vertices and $m$ edges, find all articulation points of the graph.", "inputFormat": "The first line contains two positive integers $n$ and $m$.\nEach of the next $m$ lines contains two positive integers $x$ and $y$, indicating there is an edge between $x$ and $y$.", "outputFormat": "On the first line, output the number of articulation points.\nOn the second line, output the vertices in increasing order of their indices, separated by spaces.", "hint": "For all testdata, $1\\leq n \\le 2\\times 10^4$, $1\\leq m \\le 1 \\times 10^5$. \nVertex indices are greater than $0$ and at most $n$. \nThe graph is not necessarily connected.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】割点（割顶）", "background": "割点", "description": "给出一个 $n$ 个点，$m$ 条边的无向图，求图的割点。", "inputFormat": "第一行输入两个正整数 $n,m$。\n\n下面 $m$ 行每行输入两个正整数 $x,y$ 表示 $x$ 到 $y$ 有一条边。", "outputFormat": "第一行输出割点个数。\n\n第二行按照节点编号从小到大输出节点，用空格隔开。", "hint": "对于全部数据，$1\\leq n \\le 2\\times 10^4$，$1\\leq m \\le 1 \\times 10^5$。\n\n点的编号均大于 $0$ 小于等于 $n$。\n\n**Tarjan 图不一定连通。**", "locale": "zh-CN"}}}
