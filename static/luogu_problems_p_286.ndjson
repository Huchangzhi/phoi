{"pid": "P6790", "type": "P", "difficulty": 7, "samples": [["4 5\n1 2\n1 3\n2 3\n2 4\n3 4", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["树形数据结构", "2020", "各省省选", "陕西", "组合数学", "广义串并联图"], "title": "[SNOI2020] 生成树", "background": "", "description": "给定无向连通图 $G$，已知 $G$ 在删掉一条边后是一颗仙人掌（仙人掌：不存在两个拥有公共边的简单环的无向联通图），求 $G$ 的生成树个数。结果对 $998244353$ 取模。", "inputFormat": "第一行两个整数 $n,m$，表示图 $G$ 的点数和边数。\n\n接下来 $m$ 行，每行两个用空格分隔的正整数 $u,v(1 \\le u,v  \\le n)$，表示边 $(u,v)\\in G$。", "outputFormat": "输出一行一个整数，表示图 $G$ 的生成树个数对 $998244353$ 取模的结果。", "hint": "对于所有数据，$1 \\le n \\le m \\le2 \\times 10^5$。\n\n- 对于 $10\\%$ 的数据，$1 \\le n=m \\le 2000$。\n- 对于另外 $40\\%$ 的数据，$1 \\le n,m \\le 10^5$ 且 $G$ 本身是仙人掌。\n- 对于余下 $50\\%$ 的数据，无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[SNOI2020] 生成树", "background": "", "description": "给定无向连通图 $G$，已知 $G$ 在删掉一条边后是一颗仙人掌（仙人掌：不存在两个拥有公共边的简单环的无向联通图），求 $G$ 的生成树个数。结果对 $998244353$ 取模。", "inputFormat": "第一行两个整数 $n,m$，表示图 $G$ 的点数和边数。\n\n接下来 $m$ 行，每行两个用空格分隔的正整数 $u,v(1 \\le u,v  \\le n)$，表示边 $(u,v)\\in G$。", "outputFormat": "输出一行一个整数，表示图 $G$ 的生成树个数对 $998244353$ 取模的结果。", "hint": "对于所有数据，$1 \\le n \\le m \\le2 \\times 10^5$。\n\n- 对于 $10\\%$ 的数据，$1 \\le n=m \\le 2000$。\n- 对于另外 $40\\%$ 的数据，$1 \\le n,m \\le 10^5$ 且 $G$ 本身是仙人掌。\n- 对于余下 $50\\%$ 的数据，无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P6791", "type": "P", "difficulty": 7, "samples": [["3\n1 5\n2 5\n1 10", "2\n3\n4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "博弈论", "2020", "各省省选", "陕西"], "title": "[SNOI2020] 取石子", "background": "", "description": "甲乙两个人玩取石子游戏。他们面前有一堆共 $n$ 个石子，然后由甲先手，两人轮流从中取走石子：甲第一次取走的个数不能超过 $k$，接下来每个人取走的个数不能超过上一个人刚刚取走个数的 $2$ 倍。每人每次必须至少取一个石子。取走最后一个石子的人失败，另一方获胜。现在已知 $k$，请你求出在 $1$ 到 $N$ 中有多少整数 $n$ 使得甲在 $n$ 颗石子的游戏中有必胜策略。", "inputFormat": "**多组数据。**\n\n第一行一个正整数 $T$ 表示数据组数。\n\n接下来 $T$ 行每行两个用空格隔开的整数 $k,N$，表示一组询问。", "outputFormat": "输出 $T$ 行，按照输入顺序，每行一个整数表示答案。", "hint": "#### 样例说明\n\n对于样例 $1$，当 $k=1$ 时：\n\n- 如果 $n=1$，甲只能取走唯一一颗石子从而失败。\n- 如果 $n=2$，甲取走一颗石子，乙只能取走最后一颗石子，甲获胜。\n- 如果 $n=3$，甲只能取走一颗石子，乙再取走一颗石子，甲只能取走最后一颗石子从而失败。\n- 如果 $n=4$，甲只能取走一颗石子，乙再取走两颗石子，甲只能取走最后一颗石子从而失败。\n- 如果 $n=5$，甲只能取走一颗石子，乙只能取走一颗或两颗石子，甲总能再留给乙留下最后一颗石子从而获胜。\n\n#### 数据说明与提示\n\n对于所有数据，$1 \\le T \\le 10^5,k,N \\le 10^{18}$。\n\n- 对于 $10\\%$ 的数据，$T,N \\le 500$。\n- 对于另外 $20\\%$ 的数据，$T,N \\le 10^5$。\n- 对于另外 $20\\%$ 的数据，$T \\le 3,N \\le 3 \\times 10^6$。\n- 对于另外 $20\\%$ 的数据，$k=1$。\n- 对于余下 $30\\%$ 的数据，无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[SNOI2020] 取石子", "background": "", "description": "甲乙两个人玩取石子游戏。他们面前有一堆共 $n$ 个石子，然后由甲先手，两人轮流从中取走石子：甲第一次取走的个数不能超过 $k$，接下来每个人取走的个数不能超过上一个人刚刚取走个数的 $2$ 倍。每人每次必须至少取一个石子。取走最后一个石子的人失败，另一方获胜。现在已知 $k$，请你求出在 $1$ 到 $N$ 中有多少整数 $n$ 使得甲在 $n$ 颗石子的游戏中有必胜策略。", "inputFormat": "**多组数据。**\n\n第一行一个正整数 $T$ 表示数据组数。\n\n接下来 $T$ 行每行两个用空格隔开的整数 $k,N$，表示一组询问。", "outputFormat": "输出 $T$ 行，按照输入顺序，每行一个整数表示答案。", "hint": "#### 样例说明\n\n对于样例 $1$，当 $k=1$ 时：\n\n- 如果 $n=1$，甲只能取走唯一一颗石子从而失败。\n- 如果 $n=2$，甲取走一颗石子，乙只能取走最后一颗石子，甲获胜。\n- 如果 $n=3$，甲只能取走一颗石子，乙再取走一颗石子，甲只能取走最后一颗石子从而失败。\n- 如果 $n=4$，甲只能取走一颗石子，乙再取走两颗石子，甲只能取走最后一颗石子从而失败。\n- 如果 $n=5$，甲只能取走一颗石子，乙只能取走一颗或两颗石子，甲总能再留给乙留下最后一颗石子从而获胜。\n\n#### 数据说明与提示\n\n对于所有数据，$1 \\le T \\le 10^5,k,N \\le 10^{18}$。\n\n- 对于 $10\\%$ 的数据，$T,N \\le 500$。\n- 对于另外 $20\\%$ 的数据，$T,N \\le 10^5$。\n- 对于另外 $20\\%$ 的数据，$T \\le 3,N \\le 3 \\times 10^6$。\n- 对于另外 $20\\%$ 的数据，$k=1$。\n- 对于余下 $30\\%$ 的数据，无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P6792", "type": "P", "difficulty": 7, "samples": [["5 7\n2 -4 6 -5 5\n1 1 5\n0 1 5 -4\n1 1 5\n0 3 4 -1\n1 1 5\n0 1 3 -1\n1 1 5", "6\n7\n10\n11"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2020", "线段树", "各省省选", "O2优化", "陕西", "吉司机线段树 segment tree beats"], "title": "[SNOI2020] 区间和", "background": "", "description": "有一个长度为 $n$ 的整数数列 $a_1,a_2,\\cdots,a_n$（可能含有负数）。现在对其进行 $q$ 次操作，每次操作是以下二者之一：\n\n- `0 l r x` 表示对于 $[l,r]$，将 $a_i$ 赋值为 $\\max(a_i,x)$；\n- `1 l r` 求区间 $[l,r]$ 的最大子段和。即：$\\max(0, \\max_{l\\le u\\le v\\le r} (\\sum_{i=u}^v a_i))$。", "inputFormat": "第一行两个正整数 $n,q$，分别表示序列长度和操作次数；\n\n第二行 $n$ 个正整数 $a_1,a_2,\\cdots,a_n$ 表示初始的序列；\n\n接下来 $q$ 行，每行形如 `0 l r x` 或 `1 l r` 表示一次操作。", "outputFormat": "对于每个形如 `1 l r` 的操作，输出一行一个整数表示答案。", "hint": "#### 样例说明\n\n对于样例 $1$：\n\n- 第 $1$ 次询问时序列为 $2,-4,6,-5,5$，最大子段和为 $6$；\n- 第 $2$ 次询问时序列为 $2,-4,6,-4,5$，最大子段和为 $7$；\n- 第 $3$ 次询问时序列为 $2,-4,6,-1,5$，最大子段和为 $10$；\n- 第 $4$ 次询问时序列为 $2,-1,6,-1,5$，最大子段和为 $11$。\n\n#### 数据规模与约定\n\n对于所有数据，$1\\le n\\le10^5, 1\\le q\\le 2\\times 10^5, |a_i|, |x|\\le 10^9$。\n\n- 对于 $10\\%$ 的数据，$n,q \\le 200$；\n- 对于另外 $10\\%$ 的数据，$n,q \\le 2000$；\n- 对于另外 $25\\%$ 的数据，每次操作 $0$ 均满足 $l=r$（即，只有单点修改）；\n- 对于另外 $20\\%$ 的数据，每次操作 $1$ 均满足 $l=1,r=n$（即，只有全局询问）；\n- 对于余下 $35\\%$ 的数据，无特殊限制。\n\n**有来自出题人的 3 个 hack 数据点**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[SNOI2020] 区间和", "background": "", "description": "有一个长度为 $n$ 的整数数列 $a_1,a_2,\\cdots,a_n$（可能含有负数）。现在对其进行 $q$ 次操作，每次操作是以下二者之一：\n\n- `0 l r x` 表示对于 $[l,r]$，将 $a_i$ 赋值为 $\\max(a_i,x)$；\n- `1 l r` 求区间 $[l,r]$ 的最大子段和。即：$\\max(0, \\max_{l\\le u\\le v\\le r} (\\sum_{i=u}^v a_i))$。", "inputFormat": "第一行两个正整数 $n,q$，分别表示序列长度和操作次数；\n\n第二行 $n$ 个正整数 $a_1,a_2,\\cdots,a_n$ 表示初始的序列；\n\n接下来 $q$ 行，每行形如 `0 l r x` 或 `1 l r` 表示一次操作。", "outputFormat": "对于每个形如 `1 l r` 的操作，输出一行一个整数表示答案。", "hint": "#### 样例说明\n\n对于样例 $1$：\n\n- 第 $1$ 次询问时序列为 $2,-4,6,-5,5$，最大子段和为 $6$；\n- 第 $2$ 次询问时序列为 $2,-4,6,-4,5$，最大子段和为 $7$；\n- 第 $3$ 次询问时序列为 $2,-4,6,-1,5$，最大子段和为 $10$；\n- 第 $4$ 次询问时序列为 $2,-1,6,-1,5$，最大子段和为 $11$。\n\n#### 数据规模与约定\n\n对于所有数据，$1\\le n\\le10^5, 1\\le q\\le 2\\times 10^5, |a_i|, |x|\\le 10^9$。\n\n- 对于 $10\\%$ 的数据，$n,q \\le 200$；\n- 对于另外 $10\\%$ 的数据，$n,q \\le 2000$；\n- 对于另外 $25\\%$ 的数据，每次操作 $0$ 均满足 $l=r$（即，只有单点修改）；\n- 对于另外 $20\\%$ 的数据，每次操作 $1$ 均满足 $l=1,r=n$（即，只有全局询问）；\n- 对于余下 $35\\%$ 的数据，无特殊限制。\n\n**有来自出题人的 3 个 hack 数据点**", "locale": "zh-CN"}}}
{"pid": "P6793", "type": "P", "difficulty": 6, "samples": [["5 3\naabaa\nababa", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["字符串", "2020", "各省省选", "后缀自动机 SAM", "树形 DP", "陕西", "后缀数组 SA"], "title": "[SNOI2020] 字符串", "background": "", "description": "有两个长度为 $n$ 的由小写字母组成的字符串 $a,b$，取出他们所有长为 $k$ 的子串（各有 $n-k+1$ 个），这些子串分别组成集合 $A,B$。现在要修改 $A$ 中的串，使得 $A$ 和 $B$ 完全相同。可以任意次选择修改 $A$ 中一个串的一段后缀，花费为这段后缀的长度。总花费为每次修改花费之和，求总花费的最小值。", "inputFormat": "第一行两个整数 $n,k$ 表示字符串长度和子串长度；   \n第二行一个小写字母字符串 $a$；   \n第三行一个小写字母字符串 $b$。", "outputFormat": "输出一行一个整数表示总花费的最小值。", "hint": "#### 样例说明\n\n对于样例 $1$，所有子串为：$A = \\{aab,aba,baa\\}, B = \\{aba, bab, aba\\}$。可以看出有一对 $aba$ 是相同的，另外要把 $aab$ 改成 $aba$（花费 $2$），$baa$ 改成 $bab$（花费 $1$），总花费为 $3$。\n\n#### 数据规模与约定\n\n对于所有数据，$1\\le k\\le n\\le 1.5\\times 10^5$。\n\n- 对于 $10\\%$ 的数据，$n \\le 11$；\n- 对于另外 $20\\%$ 的数据，$n \\le 200$；\n- 对于另外 $20\\%$ 的数据，$n \\le 2000$；\n- 对于另外 $10\\%$ 的数据，字符串的每一位在小写字母中均匀随机；\n- 对于余下 $40\\%$ 的数据，无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[SNOI2020] 字符串", "background": "", "description": "有两个长度为 $n$ 的由小写字母组成的字符串 $a,b$，取出他们所有长为 $k$ 的子串（各有 $n-k+1$ 个），这些子串分别组成集合 $A,B$。现在要修改 $A$ 中的串，使得 $A$ 和 $B$ 完全相同。可以任意次选择修改 $A$ 中一个串的一段后缀，花费为这段后缀的长度。总花费为每次修改花费之和，求总花费的最小值。", "inputFormat": "第一行两个整数 $n,k$ 表示字符串长度和子串长度；   \n第二行一个小写字母字符串 $a$；   \n第三行一个小写字母字符串 $b$。", "outputFormat": "输出一行一个整数表示总花费的最小值。", "hint": "#### 样例说明\n\n对于样例 $1$，所有子串为：$A = \\{aab,aba,baa\\}, B = \\{aba, bab, aba\\}$。可以看出有一对 $aba$ 是相同的，另外要把 $aab$ 改成 $aba$（花费 $2$），$baa$ 改成 $bab$（花费 $1$），总花费为 $3$。\n\n#### 数据规模与约定\n\n对于所有数据，$1\\le k\\le n\\le 1.5\\times 10^5$。\n\n- 对于 $10\\%$ 的数据，$n \\le 11$；\n- 对于另外 $20\\%$ 的数据，$n \\le 200$；\n- 对于另外 $20\\%$ 的数据，$n \\le 2000$；\n- 对于另外 $10\\%$ 的数据，字符串的每一位在小写字母中均匀随机；\n- 对于余下 $40\\%$ 的数据，无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P6794", "type": "P", "difficulty": 7, "samples": [["4 9\n1 3 2\n0 0 4 2\n3 1 1\n0 2 4 3\n3 3 1\n0 4 4 4\n3 5 1\n2 6 1 4\n1 7 4\n3 8 1", "0\n0\n4\n4"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2020", "线段树", "各省省选", "陕西", "可持久化线段树", "可持久化"], "title": "[SNOI2020] 水池", "background": null, "description": "有一个长条形的水池，可以划分成 $n$ 格。其中第 $i$ 格和 $i+1$ 格之间相邻，由一块高度为 $h_i$ 的可调节挡板隔开。第 $1$ 格左侧和第 $n$ 格右侧是无限高的池壁。初始时水池中没有水。现在进行 $q$ 次操作，操作有以下四种：\n\n- `0 i x h` 在第 $x$ 格灌水直到该格的水面高度不低于 $h$（若当前水面高度已经达到 $h$ 则无事发生）；\n- `1 i x` 打开第 $x$ 格底部的排水口直到该格的水流干，再关闭排水口；\n- `2 i x h` 将第 $x$ 格右侧的挡板高度增加到 $h$（不改变现有水面，保证挡板高度不会下降）；\n- `3 i x` 查询第 $x$ 格的水面高度。\n\n其中，$i$ 表示这次操作是基于第 $i$ 次操作之后的情况，$i=0$ 表示基于初始状态。也就是说，这个问题要求对操作可持久化。", "inputFormat": "第一行两个自然数 $n,q$，表示水池格数和操作次数。   \n接下来一行 $n - 1$ 个正整数 $h_i$ 表示挡板的初始高度。   \n接下来 $q$ 行每行一个正整数表示一次操作。", "outputFormat": "对每个操作 $3$ 输出一行一个整数表示答案。", "hint": "#### 样例说明\n\n对于样例 $1$：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0zot45nm.png)\n\n#### 数据规模与约定\n\n对于所有数据，$1\\le n,q\\le 2\\times 10^5, 0\\le h_i\\le 10^9$。\n\n- 对于 $10\\%$ 的数据，$n \\le 500$；\n- 对于另外 $20\\%$，没有操作 $1$，且 $i$ 从 $0$ 开始连续增长（不需要可持久化）；\n-  对于另外 $20\\%$，没有操作 $1$；\n- 对于另外 $20\\%$，且 $i$ 从 $0$ 开始连续增长（不需要可持久化）；\n- 对于余下 $30\\%$ 的数据，无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[SNOI2020] 水池", "background": null, "description": "有一个长条形的水池，可以划分成 $n$ 格。其中第 $i$ 格和 $i+1$ 格之间相邻，由一块高度为 $h_i$ 的可调节挡板隔开。第 $1$ 格左侧和第 $n$ 格右侧是无限高的池壁。初始时水池中没有水。现在进行 $q$ 次操作，操作有以下四种：\n\n- `0 i x h` 在第 $x$ 格灌水直到该格的水面高度不低于 $h$（若当前水面高度已经达到 $h$ 则无事发生）；\n- `1 i x` 打开第 $x$ 格底部的排水口直到该格的水流干，再关闭排水口；\n- `2 i x h` 将第 $x$ 格右侧的挡板高度增加到 $h$（不改变现有水面，保证挡板高度不会下降）；\n- `3 i x` 查询第 $x$ 格的水面高度。\n\n其中，$i$ 表示这次操作是基于第 $i$ 次操作之后的情况，$i=0$ 表示基于初始状态。也就是说，这个问题要求对操作可持久化。", "inputFormat": "第一行两个自然数 $n,q$，表示水池格数和操作次数。   \n接下来一行 $n - 1$ 个正整数 $h_i$ 表示挡板的初始高度。   \n接下来 $q$ 行每行一个正整数表示一次操作。", "outputFormat": "对每个操作 $3$ 输出一行一个整数表示答案。", "hint": "#### 样例说明\n\n对于样例 $1$：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0zot45nm.png)\n\n#### 数据规模与约定\n\n对于所有数据，$1\\le n,q\\le 2\\times 10^5, 0\\le h_i\\le 10^9$。\n\n- 对于 $10\\%$ 的数据，$n \\le 500$；\n- 对于另外 $20\\%$，没有操作 $1$，且 $i$ 从 $0$ 开始连续增长（不需要可持久化）；\n-  对于另外 $20\\%$，没有操作 $1$；\n- 对于另外 $20\\%$，且 $i$ 从 $0$ 开始连续增长（不需要可持久化）；\n- 对于余下 $30\\%$ 的数据，无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P6795", "type": "P", "difficulty": 7, "samples": [["4 1\n2", "8\n2 1 3 4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "2020", "各省省选", "Special Judge", "陕西", "构造"], "title": "[SNOI2020] 排列", "background": "", "description": "有一个 $n$ 阶排列 $p$，其前 $k$ 位 $p_1,p_2,\\cdots,p_k$ 已经确定了。\n\n定义排列 $p$ 中，$[l,r]$ 是一个值域连续段当且仅当：\n\n$$\\max(p_l, p_{l+1}, \\dots, p_r) - \\min(p_l, p_{l+1}, \\dots, p_r) = r-l$$\n\n$p$ 中值域连续段个数即所有 $1 \\le l \\le r \\le n$ 中值域连续段的总数。\n\n请你求出：所有可能的排列 $p$ 中，值域连续段个数的最大值，以及任意一种方案。", "inputFormat": "第一行两个整数 $n,k$，分别表示排列的阶数和以及确定的位数。    \n接下来一行由空格分隔的 $k$ 个正整数 $p_i$，表示排列一直的部分。（$k=0$ 则此行为空）", "outputFormat": "输出第一行一个整数表示值域连续段个数的最大值。    \n第二行 $n$ 个正整数表示任意一种方案。", "hint": "#### 样例说明\n\n对于样例 $1$，最优解为 $2,1,3,4$，有 $8$ 个值域连续段（$[1], [2], [3], [4], [1,2], [3,4], [1,3], [1,4]$）。$2,3,4,1$ 为另一个最优解。\n\n#### 数据规模与约定\n\n对于所有数据，$1\\le n\\le 2\\times 10^5, 0\\le k\\le n$。\n\n- 对于 $10\\%$ 的数据，$n \\le 10$；\n- 对于另外 $20\\%$ 的数据，$n \\le 22$；\n- 对于另外 $10\\%$ 的数据，$k \\le 1$；\n- 对于另外 $20\\%$ 的数据，$k=n$；\n- 对于余下 $40\\%$ 的数据，无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[SNOI2020] 排列", "background": "", "description": "有一个 $n$ 阶排列 $p$，其前 $k$ 位 $p_1,p_2,\\cdots,p_k$ 已经确定了。\n\n定义排列 $p$ 中，$[l,r]$ 是一个值域连续段当且仅当：\n\n$$\\max(p_l, p_{l+1}, \\dots, p_r) - \\min(p_l, p_{l+1}, \\dots, p_r) = r-l$$\n\n$p$ 中值域连续段个数即所有 $1 \\le l \\le r \\le n$ 中值域连续段的总数。\n\n请你求出：所有可能的排列 $p$ 中，值域连续段个数的最大值，以及任意一种方案。", "inputFormat": "第一行两个整数 $n,k$，分别表示排列的阶数和以及确定的位数。    \n接下来一行由空格分隔的 $k$ 个正整数 $p_i$，表示排列一直的部分。（$k=0$ 则此行为空）", "outputFormat": "输出第一行一个整数表示值域连续段个数的最大值。    \n第二行 $n$ 个正整数表示任意一种方案。", "hint": "#### 样例说明\n\n对于样例 $1$，最优解为 $2,1,3,4$，有 $8$ 个值域连续段（$[1], [2], [3], [4], [1,2], [3,4], [1,3], [1,4]$）。$2,3,4,1$ 为另一个最优解。\n\n#### 数据规模与约定\n\n对于所有数据，$1\\le n\\le 2\\times 10^5, 0\\le k\\le n$。\n\n- 对于 $10\\%$ 的数据，$n \\le 10$；\n- 对于另外 $20\\%$ 的数据，$n \\le 22$；\n- 对于另外 $10\\%$ 的数据，$k \\le 1$；\n- 对于另外 $20\\%$ 的数据，$k=n$；\n- 对于余下 $40\\%$ 的数据，无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P6796", "type": "P", "difficulty": 5, "samples": [["3\n1 + 2 * 3", "22"], ["6\n1 * 1 * 4 * 5 * 1 * 4", "414"], ["3\n16 + 750 + 7", "3069"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP"], "title": "「StOI-2」好多表达式", "background": "本题为 [StOI](https://www.luogu.com.cn/team/24701) 第二场公开赛 [StOI Round2](https://www.luogu.com.cn/contest/32483) 之第一题.\n\n__注意:如果这个数是一个多位数，不会将它拆开__ By LHQing ,14:09\n\n:)", "description": "给定一个仅由数字、`+`、`*` 组成的表达式，请求出它的所有子表达式运算值之和对 $998,244,353$ 取模的结果。\n\n一个表达式的子表达式定义为 `一段连续的数字与其中的运算符构成的表达式` 。\n\n如果您仍然无法理解，**可以参看样例解释**。", "inputFormat": "第一行一个正整数 $n$ ，表示表达式中数字的个数。\n\n接下来一行是这个由 $n$ 个正整数与 $n-1$ 个运算符组成的表达式，其中数字与运算符中间有空格隔开。", "outputFormat": "输出一个数，表示最终的答案。", "hint": "## 样例解释\n\n所给定的表达式共有六个子表达式：\n$1$、$2$、$3$、$1+2$、$2 \\times 3$、$1+2 \\times 3$ ，值分别为 $1$、$2$、$3$、$3$、$6$、$7$ ，和为 $22$ 。\n\n---\n\n## 数据范围\n\n对于 $20\\%$ 的数据：$1 \\leq n \\leq 1000$ 。   \n对于另 $20\\%$ 的数据：不存在 `+` 。  \n对于另 $20\\%$ 的数据：仅存在一个 `+` 。   \n对于另 $20\\%$ 的数据：仅存在一个 `*` 。   \n对于 $100\\%$ 的数据：$1 \\leq n \\leq 10^{5}$ ，所有数字均不大于 $10^{9}$ ，运算符只包含 `+` 、`*` 。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「StOI-2」好多表达式", "background": "本题为 [StOI](https://www.luogu.com.cn/team/24701) 第二场公开赛 [StOI Round2](https://www.luogu.com.cn/contest/32483) 之第一题.\n\n__注意:如果这个数是一个多位数，不会将它拆开__ By LHQing ,14:09\n\n:)", "description": "给定一个仅由数字、`+`、`*` 组成的表达式，请求出它的所有子表达式运算值之和对 $998,244,353$ 取模的结果。\n\n一个表达式的子表达式定义为 `一段连续的数字与其中的运算符构成的表达式` 。\n\n如果您仍然无法理解，**可以参看样例解释**。", "inputFormat": "第一行一个正整数 $n$ ，表示表达式中数字的个数。\n\n接下来一行是这个由 $n$ 个正整数与 $n-1$ 个运算符组成的表达式，其中数字与运算符中间有空格隔开。", "outputFormat": "输出一个数，表示最终的答案。", "hint": "## 样例解释\n\n所给定的表达式共有六个子表达式：\n$1$、$2$、$3$、$1+2$、$2 \\times 3$、$1+2 \\times 3$ ，值分别为 $1$、$2$、$3$、$3$、$6$、$7$ ，和为 $22$ 。\n\n---\n\n## 数据范围\n\n对于 $20\\%$ 的数据：$1 \\leq n \\leq 1000$ 。   \n对于另 $20\\%$ 的数据：不存在 `+` 。  \n对于另 $20\\%$ 的数据：仅存在一个 `+` 。   \n对于另 $20\\%$ 的数据：仅存在一个 `*` 。   \n对于 $100\\%$ 的数据：$1 \\leq n \\leq 10^{5}$ ，所有数字均不大于 $10^{9}$ ，运算符只包含 `+` 、`*` 。", "locale": "zh-CN"}}}
{"pid": "P6797", "type": "P", "difficulty": 5, "samples": [["4 4 3 1\n1 2 3 3\n3 2 1 4\n2 1 3 3\n3 4 2 1\n3 4 2 4\n1 4 1 2\n1 2 2 4", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400, 358400]}, "tags": ["动态规划 DP", "线段树", "堆", "O2优化"], "title": "「StOI-2」不朽的逃亡者", "background": null, "description": "巴尔博亚要逃遁到不朽的事业——发现太平洋。\n\n现在巴尔博亚在一个矩阵的 $(1,1)$ 位置，太平洋在 $(n,m)$ ， $(i,j)$ 位置的危险值为 $d_{i,j}$ 。他现在抓到了 $k$ 个印第安人，第 $i$ 个人对 $[ax_i,ay_i]  [bx_i,by_i]$ 的**范围**（ 以 $(ax_i,ay_i)$ 为左上角坐标，以 $(bx_i,by_i)$ 为右下角坐标的矩形 ）有了解，如果带上这个人，这一范围不会有危险。\n\n由于时间紧迫，巴尔博亚走四联通方向，必须只走 $n+m-1$ 个位置到达太平洋。\n\n现在巴尔博亚希望最多带上的人数不超过 $w$ ，同时使危险值之和最小，求最小值。", "inputFormat": "第一行 $4$ 个正整数，$n$ , $m$ , $k$ , $w$ , 含义如题。\n\n接下来是一个 $n$ 行 $m$ 列的矩阵，含义如题。\n\n接下来 $k$ 行，每行 $4$ 个正整数，分别是 $ax_i$ ，$bx_i$ ， $ay_i$ , $by_i$ ，含义如题。", "outputFormat": "一个正整数，表示最小值。", "hint": "## 样例解释\n\n选择第二人。\n\n路径：`(1,1)->(2,1)->(3,1)->(4,1)->(4,2)->(4,3)->(4,4)`\n\n危险值: 没有受到保护的 `(4,3)`与`(4,4)` ，为 $2+1=3$。\n\n## 数据范围\n\n#### 本题采用捆绑测试。\n子任务 $1$（$10$ 分）：$1 \\leq n,m,k,w \\leq 4$。   \n子任务 $2$（$20$ 分） : $1 \\leq n,m,k,w \\leq 20$。  \n子任务 $3$（$20$ 分）：$1 \\leq n,m,k,w \\leq 50$。  \n子任务 $4$（$20$ 分）：所有 $d_{i,j}$ 均相同。  \n子任务 $5$（$30$ 分） : 无特殊性质。 \n\n对于所有数据：$1\\leq n,m,k \\leq 200$，$1 \\leq w \\leq 100$，$0 \\leq d_{i,j} \\leq 10^8$，$1 \\leq ax_i \\leq bx_i \\leq n$ ，$1\\leq ay_i \\leq by_i \\leq m$ 。\n\n\n注意：输入顺序与题目略有不同", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「StOI-2」不朽的逃亡者", "background": null, "description": "巴尔博亚要逃遁到不朽的事业——发现太平洋。\n\n现在巴尔博亚在一个矩阵的 $(1,1)$ 位置，太平洋在 $(n,m)$ ， $(i,j)$ 位置的危险值为 $d_{i,j}$ 。他现在抓到了 $k$ 个印第安人，第 $i$ 个人对 $[ax_i,ay_i]  [bx_i,by_i]$ 的**范围**（ 以 $(ax_i,ay_i)$ 为左上角坐标，以 $(bx_i,by_i)$ 为右下角坐标的矩形 ）有了解，如果带上这个人，这一范围不会有危险。\n\n由于时间紧迫，巴尔博亚走四联通方向，必须只走 $n+m-1$ 个位置到达太平洋。\n\n现在巴尔博亚希望最多带上的人数不超过 $w$ ，同时使危险值之和最小，求最小值。", "inputFormat": "第一行 $4$ 个正整数，$n$ , $m$ , $k$ , $w$ , 含义如题。\n\n接下来是一个 $n$ 行 $m$ 列的矩阵，含义如题。\n\n接下来 $k$ 行，每行 $4$ 个正整数，分别是 $ax_i$ ，$bx_i$ ， $ay_i$ , $by_i$ ，含义如题。", "outputFormat": "一个正整数，表示最小值。", "hint": "## 样例解释\n\n选择第二人。\n\n路径：`(1,1)->(2,1)->(3,1)->(4,1)->(4,2)->(4,3)->(4,4)`\n\n危险值: 没有受到保护的 `(4,3)`与`(4,4)` ，为 $2+1=3$。\n\n## 数据范围\n\n#### 本题采用捆绑测试。\n子任务 $1$（$10$ 分）：$1 \\leq n,m,k,w \\leq 4$。   \n子任务 $2$（$20$ 分） : $1 \\leq n,m,k,w \\leq 20$。  \n子任务 $3$（$20$ 分）：$1 \\leq n,m,k,w \\leq 50$。  \n子任务 $4$（$20$ 分）：所有 $d_{i,j}$ 均相同。  \n子任务 $5$（$30$ 分） : 无特殊性质。 \n\n对于所有数据：$1\\leq n,m,k \\leq 200$，$1 \\leq w \\leq 100$，$0 \\leq d_{i,j} \\leq 10^8$，$1 \\leq ax_i \\leq bx_i \\leq n$ ，$1\\leq ay_i \\leq by_i \\leq m$ 。\n\n\n注意：输入顺序与题目略有不同", "locale": "zh-CN"}}}
{"pid": "P6798", "type": "P", "difficulty": 7, "samples": [["5 3 0\n5 3 4 2 1\n1 2\n1 3\n2 4\n2 5\n1 3 5\n2 4 1\n1 3 4", "42\n48\n52"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "倍增", "前缀和"], "title": "「StOI-2」简单的树", "background": "", "description": "给定一棵以 $1$ 为根，由 $n$ 个点组成的有根树，每个点有点权 $c_{i}$ 。\n\n定义每个点的 $val$ 值为：以它为根的子树内所有 $c_{i}$ 的最大值。\n\n定义函数 $f(x,y)$ 表示将 $c_{x}$ 改为 $y$ 后整棵树的 $val$ 值之和。\n\n现在请您回答 $q$ 组询问，每次询问给定 $3$ 个量 $(l,r,a)$ ，请求出 $\\sum\\limits_{i=l}^{r}{f(a,i)}$ 对 $998,244,353$ 取模的结果。", "inputFormat": "**本题强制在线**\n\n第一行三个正整数，$n$、$q$ 和 $opt$，分别表示树的点数、询问数和控制强制在线的量。\n\n第二行 $n$ 个正整数，表示每个点的点权。\n\n接下来 $n-1$ 行，每行两个正整数 $u_{i}$ 和 $v_{i}$，表示树的每一条边。\n\n接下来 $q$ 行，每行三个正整数 $l',r',a'$ ，请计算出真实的 $l,r,a$ 后完成询问。\n\n- $l = (( l' + opt \\times lastans )\\bmod n )$ $+ 1$\n- $r = (( r' + opt \\times lastans )\\bmod n )$ $+ 1$\n- $a = (( a' + opt \\times lastans )\\bmod n )$ $+ 1$\n\n其中 $lastans$ 表示上一组询问的答案，初始为 $0$ 。\n\n如果此时出现 $l > r$ 的情况，请交换 $l$ 和 $r$ 。", "outputFormat": "对于每组询问，输出最终的答案。", "hint": "## 样例解释\n\n真实的 $(l,r,a)$ 为：\n\n- $(2,4,1)$\n- $(3,5,2)$\n- $(2,4,5)$\n\n---\n\n## 数据范围\n\n对于 $10\\%$ 的数据：$1 \\leq n,q \\leq 100 $ 。   \n对于 $20\\%$ 的数据：$1 \\leq n,q \\leq 3000 $ 。   \n对于另 $20\\%$ 的数据：$1 \\leq l',r',c_{i} \\leq 2 $ 。   \n对于另 $20\\%$ 的数据：$l'=r'$ 。   \n对于前 $80\\%$ 的数据：$opt=0$ 。   \n对于 $100\\%$ 的数据：$1 \\leq n,q \\leq 5 \\times 10^{5} ，1 \\leq c_{i} , a' , l' , r' \\leq n$ 。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「StOI-2」简单的树", "background": "", "description": "给定一棵以 $1$ 为根，由 $n$ 个点组成的有根树，每个点有点权 $c_{i}$ 。\n\n定义每个点的 $val$ 值为：以它为根的子树内所有 $c_{i}$ 的最大值。\n\n定义函数 $f(x,y)$ 表示将 $c_{x}$ 改为 $y$ 后整棵树的 $val$ 值之和。\n\n现在请您回答 $q$ 组询问，每次询问给定 $3$ 个量 $(l,r,a)$ ，请求出 $\\sum\\limits_{i=l}^{r}{f(a,i)}$ 对 $998,244,353$ 取模的结果。", "inputFormat": "**本题强制在线**\n\n第一行三个正整数，$n$、$q$ 和 $opt$，分别表示树的点数、询问数和控制强制在线的量。\n\n第二行 $n$ 个正整数，表示每个点的点权。\n\n接下来 $n-1$ 行，每行两个正整数 $u_{i}$ 和 $v_{i}$，表示树的每一条边。\n\n接下来 $q$ 行，每行三个正整数 $l',r',a'$ ，请计算出真实的 $l,r,a$ 后完成询问。\n\n- $l = (( l' + opt \\times lastans )\\bmod n )$ $+ 1$\n- $r = (( r' + opt \\times lastans )\\bmod n )$ $+ 1$\n- $a = (( a' + opt \\times lastans )\\bmod n )$ $+ 1$\n\n其中 $lastans$ 表示上一组询问的答案，初始为 $0$ 。\n\n如果此时出现 $l > r$ 的情况，请交换 $l$ 和 $r$ 。", "outputFormat": "对于每组询问，输出最终的答案。", "hint": "## 样例解释\n\n真实的 $(l,r,a)$ 为：\n\n- $(2,4,1)$\n- $(3,5,2)$\n- $(2,4,5)$\n\n---\n\n## 数据范围\n\n对于 $10\\%$ 的数据：$1 \\leq n,q \\leq 100 $ 。   \n对于 $20\\%$ 的数据：$1 \\leq n,q \\leq 3000 $ 。   \n对于另 $20\\%$ 的数据：$1 \\leq l',r',c_{i} \\leq 2 $ 。   \n对于另 $20\\%$ 的数据：$l'=r'$ 。   \n对于前 $80\\%$ 的数据：$opt=0$ 。   \n对于 $100\\%$ 的数据：$1 \\leq n,q \\leq 5 \\times 10^{5} ，1 \\leq c_{i} , a' , l' , r' \\leq n$ 。", "locale": "zh-CN"}}}
{"pid": "P6799", "type": "P", "difficulty": 6, "samples": [["5 3\n1 2\n2 3\n2 4\n1 5\n1 5\n2 3\n2 4", "6"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "树状数组", "O2优化"], "title": "「StOI-2」独立集", "background": "", "description": "一棵由 $n$ 个点组成的无根树，给定 $m$ 条树上的路径，请求出由这 $m$ 条路径组成的`独立集`方案总数。\n\n由于这个答案可能很大，您只需求出它对 $998,244,353$ 取模的结果即可。\n\n所谓`独立集`，就是一个路径集合，满足这个集合中**不存在**一对在树上有交点的路径。特殊的，空集和只包括一条路径的集合也是独立集。\n\n", "inputFormat": "第一行两个正整数，$n$ 和 $m$ ，表示点数和路径数。    \n接下来 $n-1$ 行，每行两个正整数 $u_{i}$ 和 $v_{i}$ ，表示树的每条边。   \n接下来 $m$ 行，每行两个正整数 $a_{i}$ 和 $b_{i}$ ，表示给定的每条路径。", "outputFormat": "输出一个正整数，表示最终的答案。", "hint": "**请注意常数因子对程序执行效率的影响**\n\n## 样例解释\n\n\n总共有 $2^3=8$ 个集合。\n\n有两个集合 { {2,3} ，{2,4} } 与 { {1,5} ，{2,3} ，{2,4} } 不符合要求。\n\n故样例答案为 $8-2=6$ 。\n\n## 数据范围\n\n对于 $10\\%$ 的数据：$1 \\leq n \\leq 10$ ，$1 \\leq m \\leq 10$。   \n对于 $20\\%$ 的数据：$1 \\leq n \\leq 100$ ，$1 \\leq m \\leq 100$ 。   \n对于另 $30\\%$ 的数据：$1 \\leq m \\leq 15$ 。   \n对于另 $10\\%$ 的数据：$1 \\leq n,m \\leq 10^{5}$。    \n对于另 $20\\%$ 的数据：$u_{i}=i,v_{i}=i+1$。   \n对于 $100\\%$ 的数据：$1\\leq n,m \\leq 5 \\times 10^{5}$ 。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「StOI-2」独立集", "background": "", "description": "一棵由 $n$ 个点组成的无根树，给定 $m$ 条树上的路径，请求出由这 $m$ 条路径组成的`独立集`方案总数。\n\n由于这个答案可能很大，您只需求出它对 $998,244,353$ 取模的结果即可。\n\n所谓`独立集`，就是一个路径集合，满足这个集合中**不存在**一对在树上有交点的路径。特殊的，空集和只包括一条路径的集合也是独立集。\n\n", "inputFormat": "第一行两个正整数，$n$ 和 $m$ ，表示点数和路径数。    \n接下来 $n-1$ 行，每行两个正整数 $u_{i}$ 和 $v_{i}$ ，表示树的每条边。   \n接下来 $m$ 行，每行两个正整数 $a_{i}$ 和 $b_{i}$ ，表示给定的每条路径。", "outputFormat": "输出一个正整数，表示最终的答案。", "hint": "**请注意常数因子对程序执行效率的影响**\n\n## 样例解释\n\n\n总共有 $2^3=8$ 个集合。\n\n有两个集合 { {2,3} ，{2,4} } 与 { {1,5} ，{2,3} ，{2,4} } 不符合要求。\n\n故样例答案为 $8-2=6$ 。\n\n## 数据范围\n\n对于 $10\\%$ 的数据：$1 \\leq n \\leq 10$ ，$1 \\leq m \\leq 10$。   \n对于 $20\\%$ 的数据：$1 \\leq n \\leq 100$ ，$1 \\leq m \\leq 100$ 。   \n对于另 $30\\%$ 的数据：$1 \\leq m \\leq 15$ 。   \n对于另 $10\\%$ 的数据：$1 \\leq n,m \\leq 10^{5}$。    \n对于另 $20\\%$ 的数据：$u_{i}=i,v_{i}=i+1$。   \n对于 $100\\%$ 的数据：$1\\leq n,m \\leq 5 \\times 10^{5}$ 。", "locale": "zh-CN"}}}
{"pid": "P6800", "type": "P", "difficulty": 6, "samples": [["3 3 3\n3 3 3", "9 39 273"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "模板题"], "title": "【模板】Chirp Z-Transform", "background": "", "description": "给定一个 $n$ 项多项式 $P(x)$ 以及 $c, m$，请计算 $P(c^0),P(c^1),\\dots,P(c^{m-1})$。所有答案都对 $998244353$ 取模。", "inputFormat": "第一行三个正整数 $n,c,m$。  \n第二行 $n$ 个非负整数 $a_0,a_1,\\dots,a_{n-1}$，由低到高表示 $P(x)$ 的系数。\n", "outputFormat": "一行 $m$ 个正整数，第 $i$ 个数表示 $P(c^{i-1})$。", "hint": "对于 $100\\%$ 的数据，$1\\le n,m\\le 10^6,0\\le c,a_i<998244353$.", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】Chirp Z-Transform", "background": "", "description": "给定一个 $n$ 项多项式 $P(x)$ 以及 $c, m$，请计算 $P(c^0),P(c^1),\\dots,P(c^{m-1})$。所有答案都对 $998244353$ 取模。", "inputFormat": "第一行三个正整数 $n,c,m$。  \n第二行 $n$ 个非负整数 $a_0,a_1,\\dots,a_{n-1}$，由低到高表示 $P(x)$ 的系数。\n", "outputFormat": "一行 $m$ 个正整数，第 $i$ 个数表示 $P(c^{i-1})$。", "hint": "对于 $100\\%$ 的数据，$1\\le n,m\\le 10^6,0\\le c,a_i<998244353$.", "locale": "zh-CN"}}}
{"pid": "P6801", "type": "P", "difficulty": 4, "samples": [["2\n1 2\n1 2", "12"]], "limits": {"time": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2020", "CEOI（中欧）", "扫描线", "单调栈"], "title": "[CEOI 2020] 花式围栏", "background": "0.1s，32MB", "description": "众所周知，Balázs 拥有整个城镇中最漂亮的围栏。围栏由 $N$ 个部分组成，每个部分均为矩形，且相邻的两个部分间均紧密相连。第 $i$ 部分矩形的高度为 $h_i$，宽度为 $w_i$，我们需要找到满足如下条件的花式矩形：\n\n- 矩形的每条边均是水平的或竖直的，且每条边的长度为整数。\n- 矩形与地面的距离为整数。\n- 矩形与围栏第一部分的左侧边的距离为整数。\n- 矩形完整包含在围栏中。\n\n现在你需要求出花式矩形的总数。因为这个数字可能很大，请输出其对 $10^9+7$ 取模后的结果。", "inputFormat": "输入第一行包含一个整数 $N$，代表围栏由 $N$ 部分组成。\n\n第二行 $N$ 个整数，第 $i$ 个整数为第 $i$ 个矩形的高度 $h_i$。\n\n第三行 $N$ 个整数，第 $i$ 个整数为第 $i$ 个矩形的宽度 $w_i$。", "outputFormat": "输出花式矩形数对 $10^9+7$ 取模后的结果。", "hint": "### 样例解释 1\n\n围栏形状如下所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/o0w99om5.png)\n\n形状如下的矩形有 $5$ 个：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qvrh1vbs.png)\n\n形状如下的矩形有 $3$ 个：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/hx15etpn.png)\n\n形状如下的矩形有 $1$ 个：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/s01bhzfn.png)\n\n形状如下的矩形有 $2$ 个：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ee3kec7y.png)\n\n形状如下的矩形有 $1$ 个：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/n26e8gyi.png)\n\n### 样例 2\n\n见附加文件。\n\n### 子任务\n\n所有测试点均满足：$1 \\leq N \\leq 10^5$，$1 \\leq h_i,w_i \\leq 10^9$。\n\n各子任务的约束条件如下：\n\n| 子任务编号 | 分值 | 约束                                                         |\n| ---------- | ---- | ------------------------------------------------------------ |\n| $1$        | $0$  | 样例                                                         |\n| $2$        | $12$ | $N \\leq 50$，且 $\\forall i \\in [1,N]$，$h_i \\leq 50$ 且 $w_i=1$ |\n| $3$        | $13$ | $\\forall i \\in [1,N]$，$h_i=1$ 或 $h_i=2$                    |\n| $4$        | $15$ | 所有的 $h_i$ 均相等                                          |\n| $5$        | $15$ | $\\forall i \\in [1,N-1]$，$h_i \\leq h_{i+1}$                  |\n| $6$        | $18$ | $N \\leq 1000$                                                |\n| $7$        | $27$ | 无特殊约束                                                   |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CEOI 2020] 花式围栏", "background": "0.1s，32MB", "description": "众所周知，Balázs 拥有整个城镇中最漂亮的围栏。围栏由 $N$ 个部分组成，每个部分均为矩形，且相邻的两个部分间均紧密相连。第 $i$ 部分矩形的高度为 $h_i$，宽度为 $w_i$，我们需要找到满足如下条件的花式矩形：\n\n- 矩形的每条边均是水平的或竖直的，且每条边的长度为整数。\n- 矩形与地面的距离为整数。\n- 矩形与围栏第一部分的左侧边的距离为整数。\n- 矩形完整包含在围栏中。\n\n现在你需要求出花式矩形的总数。因为这个数字可能很大，请输出其对 $10^9+7$ 取模后的结果。", "inputFormat": "输入第一行包含一个整数 $N$，代表围栏由 $N$ 部分组成。\n\n第二行 $N$ 个整数，第 $i$ 个整数为第 $i$ 个矩形的高度 $h_i$。\n\n第三行 $N$ 个整数，第 $i$ 个整数为第 $i$ 个矩形的宽度 $w_i$。", "outputFormat": "输出花式矩形数对 $10^9+7$ 取模后的结果。", "hint": "### 样例解释 1\n\n围栏形状如下所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/o0w99om5.png)\n\n形状如下的矩形有 $5$ 个：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qvrh1vbs.png)\n\n形状如下的矩形有 $3$ 个：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/hx15etpn.png)\n\n形状如下的矩形有 $1$ 个：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/s01bhzfn.png)\n\n形状如下的矩形有 $2$ 个：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ee3kec7y.png)\n\n形状如下的矩形有 $1$ 个：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/n26e8gyi.png)\n\n### 样例 2\n\n见附加文件。\n\n### 子任务\n\n所有测试点均满足：$1 \\leq N \\leq 10^5$，$1 \\leq h_i,w_i \\leq 10^9$。\n\n各子任务的约束条件如下：\n\n| 子任务编号 | 分值 | 约束                                                         |\n| ---------- | ---- | ------------------------------------------------------------ |\n| $1$        | $0$  | 样例                                                         |\n| $2$        | $12$ | $N \\leq 50$，且 $\\forall i \\in [1,N]$，$h_i \\leq 50$ 且 $w_i=1$ |\n| $3$        | $13$ | $\\forall i \\in [1,N]$，$h_i=1$ 或 $h_i=2$                    |\n| $4$        | $15$ | 所有的 $h_i$ 均相等                                          |\n| $5$        | $15$ | $\\forall i \\in [1,N-1]$，$h_i \\leq h_{i+1}$                  |\n| $6$        | $18$ | $N \\leq 1000$                                                |\n| $7$        | $27$ | 无特殊约束                                                   |", "locale": "zh-CN"}}}
{"pid": "P6802", "type": "P", "difficulty": 6, "samples": [["5\n1 3 3 6\n5 1 5 3\n3 3 6 5\n2 1 4 1\n2 3 4 2", "2 1 1 3\n2 3 2 1\n3 3 2 3\n5 1 4 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2020", "Special Judge", "O2优化", "CEOI（中欧）"], "title": "[CEOI 2020] 道路", "background": "0.3s，32MB", "description": "Treeland 政府准备建立一个全新的道路网。Treeland 共有 $2N$ 个城市，目前已经修建了 $N$ 条道路，每条道路都是一条连接两个城市的线段。这 $N$ 条道路两两没有交点（包括端点处）。你现在需要再修建 $N-1$ 条道路，要求：\n\n1. 每条道路都是一条连接两个城市的线段。\n2. 道路只能在端点处相交。\n3. 对于任意两个城市，均能通过该路网相互抵达。", "inputFormat": "输入第一行包含一个整数 $N$。\n\n接下来 $N$ 行，每行包含四个整数 $x_1,y_1,x_2,y_2$，表示 $(x_1,y_1)$ 和 $(x_2,y_2)$ 两座城市间存在一条道路直接相连。", "outputFormat": "输出 $N-1$ 行。\n\n每行包含四个整数 $x_1,y_1,x_2,y_2$，代表新修一条连接 $(x_1,y_1)$ 和 $(x_2,y_2)$ 两座城市间的道路。\n\n如果存在多种方案，任意输出一种即可。", "hint": "### 样例解释\n\n下图中，实线表示已经修建的道路，虚线代表新修道路。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qxnetdvo.png)\n\n### 子任务\n\n所有数据均满足：$2 \\leq N \\leq 10^5$，$-10^7 \\leq x_1,y_1,x_2,y_2 \\leq 10^7$。\n\n各子任务的约束条件如下：\n\n| 子任务编号 | 分值 | 约束                                 |\n| ---------- | ---- | ------------------------------------ |\n| $1$        | $0$  | 样例                                 |\n| $2$        | $15$ | 输入的所有线段均为竖直线段           |\n| $3$        | $15$ | 任意两条输入线段互相平行             |\n| $4$        | $15$ | 输入的所有线段均为水平线段或竖直线段 |\n| $5$        | $15$ | $N \\leq 10^4$                        |\n| $6$        | $40$ | 无特殊约束                           |\n\n注意实际评测分值分配与上述约定不同。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CEOI 2020] 道路", "background": "0.3s，32MB", "description": "Treeland 政府准备建立一个全新的道路网。Treeland 共有 $2N$ 个城市，目前已经修建了 $N$ 条道路，每条道路都是一条连接两个城市的线段。这 $N$ 条道路两两没有交点（包括端点处）。你现在需要再修建 $N-1$ 条道路，要求：\n\n1. 每条道路都是一条连接两个城市的线段。\n2. 道路只能在端点处相交。\n3. 对于任意两个城市，均能通过该路网相互抵达。", "inputFormat": "输入第一行包含一个整数 $N$。\n\n接下来 $N$ 行，每行包含四个整数 $x_1,y_1,x_2,y_2$，表示 $(x_1,y_1)$ 和 $(x_2,y_2)$ 两座城市间存在一条道路直接相连。", "outputFormat": "输出 $N-1$ 行。\n\n每行包含四个整数 $x_1,y_1,x_2,y_2$，代表新修一条连接 $(x_1,y_1)$ 和 $(x_2,y_2)$ 两座城市间的道路。\n\n如果存在多种方案，任意输出一种即可。", "hint": "### 样例解释\n\n下图中，实线表示已经修建的道路，虚线代表新修道路。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qxnetdvo.png)\n\n### 子任务\n\n所有数据均满足：$2 \\leq N \\leq 10^5$，$-10^7 \\leq x_1,y_1,x_2,y_2 \\leq 10^7$。\n\n各子任务的约束条件如下：\n\n| 子任务编号 | 分值 | 约束                                 |\n| ---------- | ---- | ------------------------------------ |\n| $1$        | $0$  | 样例                                 |\n| $2$        | $15$ | 输入的所有线段均为竖直线段           |\n| $3$        | $15$ | 任意两条输入线段互相平行             |\n| $4$        | $15$ | 输入的所有线段均为水平线段或竖直线段 |\n| $5$        | $15$ | $N \\leq 10^4$                        |\n| $6$        | $40$ | 无特殊约束                           |\n\n注意实际评测分值分配与上述约定不同。", "locale": "zh-CN"}}}
{"pid": "P6803", "type": "P", "difficulty": 6, "samples": [["3 1\n1 2\n2 3", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2020", "CEOI（中欧）", "矩阵加速", "树形 DP"], "title": "[CEOI 2020] 星际迷航", "background": "原时空限制：0.2s，32m", "description": "星际联邦由 $N$ 颗行星组成，分别编号为 $1 \\sim N$。一些行星间由星际通道相连。通过这些星际通道，飞船可以在短时间内往返于各星球之间。整个星际联邦中恰好有 $N-1$ 条星际通道，并且通过这些星际通道，任意两颗行星之间均能相互抵达。\n\n除了我们所处的宇宙之外，还有 $D$ 个平行宇宙，这些平行宇宙是我们的宇宙的完全复刻，它们的行星，星际通道都和我们的完全相同。我们将这些平行宇宙编号为 $1 \\sim D$（我们的宇宙编号为 $0$），记第 $i$ 个宇宙的第 $x$ 颗行星为 $P_{x}^i$。通过星门，我们可以在这些平行宇宙间穿梭。$\\forall i \\in [0,D)$，我们将选择一个 $A_i$ 和一个 $B_i$（要求 $1 \\leq A_i,B_i \\leq N$），在 $P_{A_i}^i$ 和 $P_{B_i}^{i+1}$ 之间搭建一个**单向**（只能从 $P_{A_i}^i$ 前往 $P_{B_i}^{i+1}$）星门。\n\n当所有的星门都准备就绪后，联邦星舰 Batthyány 号将会开始它的处女航，它目前正环绕着 $P_1^0$ 行星。Ágnes 舰长准备和 Gábor 中尉玩这样一个游戏：两个人交替选择星舰接下来前往的目的地，要求该目的地可以通过星际通道或星门直接抵达。他们希望每次前往的星球都是之前未抵达过的。即，如果星舰抵达了 $P_{x}^i$，他们将不再经过这个星球（但是可以抵达 $x$ 在其他平行宇宙中的相应星球）。由 Ágnes 舰长作为先手开始游戏，Gábor 中尉作为后手，当一位玩家在他的回合中，不能选择一个合法的目的地时，他就输掉了游戏。\n\n舰长和中尉都是绝对聪明的，他们知道所有星际通道和星门的排布方案，并且他们每次都按照最优方案行动。你需要求出，有多少种布置星门的方案，使得作为先手的 Ágnes 舰长必胜？两种布置星门的方案是不同的，当且仅当存在一个整数 $i$，使得 $A_i$ 或 $B_i$ 不同。", "inputFormat": "第一行两个整数 $N,D$，分别代表星际联邦拥有的行星数和平行宇宙的数量。\n\n接下来 $N-1$ 行，每行两个整数 $u,v$，表示 $\\forall i \\in [0,D]$，$P_u^i,P_v^i$ 之间有星际通道相连。", "outputFormat": "输出能使舰长必胜的星门布置方案数对 $10^9+7$ 取模的结果。", "hint": "### 样例解释\n\n共有 $3 \\times 3=9$ 种本质不同的布置星门的方案，下面列出四种舰长必胜的情况。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/vblsc4g6.png)\n\n### 子任务\n\n所有数据均满足：$1 \\leq N \\leq 10^5$，$1 \\leq D \\leq 10^{18}$，$1 \\leq u,v \\leq N$。\n\n各子任务的约束条件如下：\n\n| 子任务编号 | 分值 | 约束                         |\n| ---------- | ---- | ---------------------------- |\n| $1$        | $0$  | 样例                         |\n| $2$        | $7$  | $N=2$                        |\n| $3$        | $8$  | $N \\leq 100$，$D=1$          |\n| $4$        | $15$ | $N \\leq 1000$，$D=1$         |\n| $5$        | $15$ | $D=1$                        |\n| $6$        | $20$ | $N \\leq 1000$，$D \\leq 10^5$ |\n| $7$        | $20$ | $D \\leq 10^5$                |\n| $8$        | $15$ | 无特殊约束                   |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CEOI 2020] 星际迷航", "background": "原时空限制：0.2s，32m", "description": "星际联邦由 $N$ 颗行星组成，分别编号为 $1 \\sim N$。一些行星间由星际通道相连。通过这些星际通道，飞船可以在短时间内往返于各星球之间。整个星际联邦中恰好有 $N-1$ 条星际通道，并且通过这些星际通道，任意两颗行星之间均能相互抵达。\n\n除了我们所处的宇宙之外，还有 $D$ 个平行宇宙，这些平行宇宙是我们的宇宙的完全复刻，它们的行星，星际通道都和我们的完全相同。我们将这些平行宇宙编号为 $1 \\sim D$（我们的宇宙编号为 $0$），记第 $i$ 个宇宙的第 $x$ 颗行星为 $P_{x}^i$。通过星门，我们可以在这些平行宇宙间穿梭。$\\forall i \\in [0,D)$，我们将选择一个 $A_i$ 和一个 $B_i$（要求 $1 \\leq A_i,B_i \\leq N$），在 $P_{A_i}^i$ 和 $P_{B_i}^{i+1}$ 之间搭建一个**单向**（只能从 $P_{A_i}^i$ 前往 $P_{B_i}^{i+1}$）星门。\n\n当所有的星门都准备就绪后，联邦星舰 Batthyány 号将会开始它的处女航，它目前正环绕着 $P_1^0$ 行星。Ágnes 舰长准备和 Gábor 中尉玩这样一个游戏：两个人交替选择星舰接下来前往的目的地，要求该目的地可以通过星际通道或星门直接抵达。他们希望每次前往的星球都是之前未抵达过的。即，如果星舰抵达了 $P_{x}^i$，他们将不再经过这个星球（但是可以抵达 $x$ 在其他平行宇宙中的相应星球）。由 Ágnes 舰长作为先手开始游戏，Gábor 中尉作为后手，当一位玩家在他的回合中，不能选择一个合法的目的地时，他就输掉了游戏。\n\n舰长和中尉都是绝对聪明的，他们知道所有星际通道和星门的排布方案，并且他们每次都按照最优方案行动。你需要求出，有多少种布置星门的方案，使得作为先手的 Ágnes 舰长必胜？两种布置星门的方案是不同的，当且仅当存在一个整数 $i$，使得 $A_i$ 或 $B_i$ 不同。", "inputFormat": "第一行两个整数 $N,D$，分别代表星际联邦拥有的行星数和平行宇宙的数量。\n\n接下来 $N-1$ 行，每行两个整数 $u,v$，表示 $\\forall i \\in [0,D]$，$P_u^i,P_v^i$ 之间有星际通道相连。", "outputFormat": "输出能使舰长必胜的星门布置方案数对 $10^9+7$ 取模的结果。", "hint": "### 样例解释\n\n共有 $3 \\times 3=9$ 种本质不同的布置星门的方案，下面列出四种舰长必胜的情况。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/vblsc4g6.png)\n\n### 子任务\n\n所有数据均满足：$1 \\leq N \\leq 10^5$，$1 \\leq D \\leq 10^{18}$，$1 \\leq u,v \\leq N$。\n\n各子任务的约束条件如下：\n\n| 子任务编号 | 分值 | 约束                         |\n| ---------- | ---- | ---------------------------- |\n| $1$        | $0$  | 样例                         |\n| $2$        | $7$  | $N=2$                        |\n| $3$        | $8$  | $N \\leq 100$，$D=1$          |\n| $4$        | $15$ | $N \\leq 1000$，$D=1$         |\n| $5$        | $15$ | $D=1$                        |\n| $6$        | $20$ | $N \\leq 1000$，$D \\leq 10^5$ |\n| $7$        | $20$ | $D \\leq 10^5$                |\n| $8$        | $15$ | 无特殊约束                   |", "locale": "zh-CN"}}}
{"pid": "P6804", "type": "P", "difficulty": 6, "samples": [["6 5 11 4\n2 42 1000 54 68 234\n0 1\n2 0\n3 4\n3 5\n3 5\n1 3\n5 3\n0 5\n3 0\n1 3\n3 5\n0 3 4\n3 0 8\n0 5 5\n3 0 11", "26\n0\n1000000000\n14"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2020", "交互题", "Special Judge", "CEOI（中欧）"], "title": "[CEOI 2020] 权力药水", "background": "3s，256MB", "description": "很久以前，在萨满之岛上，所有人都住在一个如天一样高的豆茎上。每位萨满都有一个独一无二的编号，编号的范围在 $0$ 和 $N-1$ 之间。第 $i$ 位萨满居住的高度用 $H_i$ 表示。定义两位萨满间的距离为其高度差的绝对值。\n\n所有的萨满之间本来和谐共处，直到一天权力药水的配方被盗。为了掩盖他的行径，那位小偷给整座岛施加了诅咒，大多数居民不再彼此信任了。\n\n虽然情况非常复杂，但是经过调查，某组织还是获得了如下信息：\n\n- 诅咒刚生效时，所有的萨满停止彼此信任。\n- 诅咒本身是不稳定的，在每天将要结束时（准确来说是午夜），某一对萨满将会建立信任或是停止信任。\n- 不幸地是，一位萨满在任意时刻最多信任 $D$ 位萨满。\n\n该组织还重建了萨满间的信任变化日志，该日志记录了在每个半夜，哪对萨满的信任关系发生了变化（从不信任到信任，或是从信任到不信任）。\n\n该组织的成员相信，小偷还向一位邪恶的萨满通过隔空传话的方式泄露了配方。为了避免被发现，他们俩都各自拜访了一位信任的萨满的家，在拜访的过程中，小偷透过窗户向邪恶的萨满泄露配方。需要注意的是，那位信任的朋友当时不必在家中，事实上，两位萨满可能互相前往对方的家。毕竟萨满都很奇怪。\n\n幸运的是，因为萨满们的听力有限，声音并不能传出太远，这意味着两位朋友（小偷的朋友和邪恶的萨满的朋友）之间的距离必须尽可能近。\n\n现在该组织决定让你来协助调查。他们想要验证自己的猜想：当小偷为 $x$，邪恶的萨满为 $y$，泄露配方的日子为 $v$ 时，隔空传话的声音需要行进的最小值是多少？也即，你需要在第 $v$ 天时，在 $x$ 信任的所有萨满中找到一位萨满 $x'$，在 $y$ 信任的所有萨满中找到一位萨满 $y'$，使 $x'$ 和 $y'$ 间的距离最小。\n\n你已经获得了求出答案所需的所有信息，但你需要**实时**回答每一组询问。", "inputFormat": "**仅提供 IO 交互**。\n\n输入第一行包含四个整数 $N,D,U,Q$，分别代表萨满的数量，一位萨满最多信任的朋友数，日志包含的天数，以及需要回答的询问数。\n\n下一行包含 $N$ 个整数，两两间以一个空格隔开。其中第 $i$ 个整数代表第 $i-1$ 只萨满居住的高度 $H_{i-1}$。\n\n接下来 $U$ 行，第 $i$ 行包含两个整数 $A_i,B_i$，代表编号为 $A_i$ 和 $B_i$ 的萨满在第 $i-1$ 天结束的时候，他们之间的信任状态发生了变化。即，如果 $A_i$ 和 $B_i$ 在第 $i-1$ 天互相信任，则他们自第 $i$ 天起不再互相信任，反之同理。\n\n接下来你需要回答 $Q$ 组询问。询问必须实时回答，即你必须回答完一组询问后才能读入下一组询问。\n\n每组询问包含三个整数 $x,y,v$，代表小偷为 $x$，邪恶的萨满为 $y$，泄露配方的日子为第 $v$ 天。", "outputFormat": "对于每组询问，你需要在第 $v$ 天时，在 $x$ 信任的所有萨满中找到一位萨满 $x'$，在 $y$ 信任的所有萨满中找到一位萨满 $y'$，使 $x'$ 和 $y'$ 间的距离最小，并输出这个最小值。\n\n特别地，\n\n- 若存在一位萨满同时被 $x$ 和 $y$ 信任，输出 $0$。\n- 若 $x$ 或 $y$ 在第 $v$ 天无信任的朋友，输出 $1000000000$（$10^9$）。\n\n在回答完一组询问后，你需要立刻刷新缓冲区。\n\n对于 C++ 选手，可以通过 `fflush(stdout);` 或 `cout.flush()` 来刷新缓冲区。", "hint": "### 样例解释\n\n下面是询问的情况：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/gdrha1bp.png)\n\n下面是每一天时信任关系的变化情况：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/uulqejgp.png)\n\n### 子任务\n\n所有数据均满足：$2 \\leq N \\leq 10^5$，$1 \\leq D \\leq 500$，$0 \\leq U \\leq 2 \\times 10^5$，$1 \\leq Q \\leq 5 \\times 10^4$。\n\n各子任务的约束条件如下：\n\n| 子任务编号 | 分值 | 约束                                    |\n| ---------- | ---- | --------------------------------------- |\n| $1$        | $0$  | 样例                                    |\n| $2$        | $17$ | $Q,U \\leq 10^3$                         |\n| $3$        | $14$ | 所有询问均满足 $v=U$                  |\n| $4$        | $18$ | $\\forall i \\in [0,N)$，$H_i\\in \\{0,1\\}$ |\n| $5$        | $21$ | $U,N \\leq 10^4$                         |\n| $6$        | $30$ | 无特殊约束                              |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CEOI 2020] 权力药水", "background": "3s，256MB", "description": "很久以前，在萨满之岛上，所有人都住在一个如天一样高的豆茎上。每位萨满都有一个独一无二的编号，编号的范围在 $0$ 和 $N-1$ 之间。第 $i$ 位萨满居住的高度用 $H_i$ 表示。定义两位萨满间的距离为其高度差的绝对值。\n\n所有的萨满之间本来和谐共处，直到一天权力药水的配方被盗。为了掩盖他的行径，那位小偷给整座岛施加了诅咒，大多数居民不再彼此信任了。\n\n虽然情况非常复杂，但是经过调查，某组织还是获得了如下信息：\n\n- 诅咒刚生效时，所有的萨满停止彼此信任。\n- 诅咒本身是不稳定的，在每天将要结束时（准确来说是午夜），某一对萨满将会建立信任或是停止信任。\n- 不幸地是，一位萨满在任意时刻最多信任 $D$ 位萨满。\n\n该组织还重建了萨满间的信任变化日志，该日志记录了在每个半夜，哪对萨满的信任关系发生了变化（从不信任到信任，或是从信任到不信任）。\n\n该组织的成员相信，小偷还向一位邪恶的萨满通过隔空传话的方式泄露了配方。为了避免被发现，他们俩都各自拜访了一位信任的萨满的家，在拜访的过程中，小偷透过窗户向邪恶的萨满泄露配方。需要注意的是，那位信任的朋友当时不必在家中，事实上，两位萨满可能互相前往对方的家。毕竟萨满都很奇怪。\n\n幸运的是，因为萨满们的听力有限，声音并不能传出太远，这意味着两位朋友（小偷的朋友和邪恶的萨满的朋友）之间的距离必须尽可能近。\n\n现在该组织决定让你来协助调查。他们想要验证自己的猜想：当小偷为 $x$，邪恶的萨满为 $y$，泄露配方的日子为 $v$ 时，隔空传话的声音需要行进的最小值是多少？也即，你需要在第 $v$ 天时，在 $x$ 信任的所有萨满中找到一位萨满 $x'$，在 $y$ 信任的所有萨满中找到一位萨满 $y'$，使 $x'$ 和 $y'$ 间的距离最小。\n\n你已经获得了求出答案所需的所有信息，但你需要**实时**回答每一组询问。", "inputFormat": "**仅提供 IO 交互**。\n\n输入第一行包含四个整数 $N,D,U,Q$，分别代表萨满的数量，一位萨满最多信任的朋友数，日志包含的天数，以及需要回答的询问数。\n\n下一行包含 $N$ 个整数，两两间以一个空格隔开。其中第 $i$ 个整数代表第 $i-1$ 只萨满居住的高度 $H_{i-1}$。\n\n接下来 $U$ 行，第 $i$ 行包含两个整数 $A_i,B_i$，代表编号为 $A_i$ 和 $B_i$ 的萨满在第 $i-1$ 天结束的时候，他们之间的信任状态发生了变化。即，如果 $A_i$ 和 $B_i$ 在第 $i-1$ 天互相信任，则他们自第 $i$ 天起不再互相信任，反之同理。\n\n接下来你需要回答 $Q$ 组询问。询问必须实时回答，即你必须回答完一组询问后才能读入下一组询问。\n\n每组询问包含三个整数 $x,y,v$，代表小偷为 $x$，邪恶的萨满为 $y$，泄露配方的日子为第 $v$ 天。", "outputFormat": "对于每组询问，你需要在第 $v$ 天时，在 $x$ 信任的所有萨满中找到一位萨满 $x'$，在 $y$ 信任的所有萨满中找到一位萨满 $y'$，使 $x'$ 和 $y'$ 间的距离最小，并输出这个最小值。\n\n特别地，\n\n- 若存在一位萨满同时被 $x$ 和 $y$ 信任，输出 $0$。\n- 若 $x$ 或 $y$ 在第 $v$ 天无信任的朋友，输出 $1000000000$（$10^9$）。\n\n在回答完一组询问后，你需要立刻刷新缓冲区。\n\n对于 C++ 选手，可以通过 `fflush(stdout);` 或 `cout.flush()` 来刷新缓冲区。", "hint": "### 样例解释\n\n下面是询问的情况：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/gdrha1bp.png)\n\n下面是每一天时信任关系的变化情况：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/uulqejgp.png)\n\n### 子任务\n\n所有数据均满足：$2 \\leq N \\leq 10^5$，$1 \\leq D \\leq 500$，$0 \\leq U \\leq 2 \\times 10^5$，$1 \\leq Q \\leq 5 \\times 10^4$。\n\n各子任务的约束条件如下：\n\n| 子任务编号 | 分值 | 约束                                    |\n| ---------- | ---- | --------------------------------------- |\n| $1$        | $0$  | 样例                                    |\n| $2$        | $17$ | $Q,U \\leq 10^3$                         |\n| $3$        | $14$ | 所有询问均满足 $v=U$                  |\n| $4$        | $18$ | $\\forall i \\in [0,N)$，$H_i\\in \\{0,1\\}$ |\n| $5$        | $21$ | $U,N \\leq 10^4$                         |\n| $6$        | $30$ | 无特殊约束                              |", "locale": "zh-CN"}}}
{"pid": "P6805", "type": "P", "difficulty": 6, "samples": [["7 3\n1 2\n2 4\n4 5\n5 6\n5 7\n3 4\n1 4\n2 2 4\n1 1", "-1\n10\n8"]], "limits": {"time": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2020", "CEOI（中欧）"], "title": "[CEOI 2020] 春季大扫除", "background": "0.3s，128MB", "description": "春季大扫除也许是我们一生中最无聊的事情之一。当然，对于 Flóra 和她的母亲而言，今年的春季大扫除要有意思得多。因为她们在地毯下发现了一张已被灰尘覆盖的树形地图。\n\n这棵树有 $N$ 个节点，节点从 $1$ 到 $N$ 进行编号，这 $N$ 个点通过 $N-1$ 条边相连。这些边上都积累了过多的灰尘，因此 Flóra 的母亲准备对这棵树进行清理。\n\n清理这棵树的过程是这样的：Flóra 的母亲每次在这棵树上选择两个叶子节点（定义一棵树的叶子节点为只与恰好一个点直接相连的点），并对这两个叶子点路径上的所有边进行清理。如果这条路径上有 $d$ 条边，则清理的费用为 $d$。当这棵树上的所有边都被清理后，这棵树的清理过程就完成了。清理这棵树的总费用即为各次清理的费用之和。\n\n因为她想保护这棵树的叶子节点，因此对于每个叶子节点，她最多只会选择一次。\n\nFlóra 认为原来的树过于简单，她决定对原始的树进行一些改造。在第 $i$ 次改造中，她在原始的树的基础上添加了 $D_i$ 个叶子节点。具体来说，她会在原始的树上选择一个节点，并在该点与新的叶子节点之间连接一条边。需要注意的是，在添加新的叶子节点的过程中，原来的一些节点将不再是叶子节点。\n\n现在你需要帮助 Flóra 求出清理改造后的树的最小费用。", "inputFormat": "输入第一行包含两个数 $N,Q$，分别代表原始的树上的节点数，以及 Flóra 准备对原始的树进行的改造次数。\n\n接下来 $N-1$ 行，每行两个整数 $u,v$，表示在原始的树上 $u,v$ 两个节点间有一条边相连。\n\n接下来 $Q$ 行，每行第一个整数 $D_i$，表示 Flóra 准备在第 $i$ 次改造中添加 $D_i$ 个叶子节点。接下来 $D_i$ 个整数，第 $j$ 个整数 $a_j$ 表示 Flóra 准备在 $a_j$ 号点上添加一个叶子节点。同一个点上可能会添加多个叶子节点。\n\n每次改造过程是独立的，即在一轮改造后，Flóra 会在原始的树上重新开始改造过程。", "outputFormat": "对于每次改造，你需要输出一个整数，表示清理这棵改造后的树的最小费用。\n\n特别地，若这棵树不能被完全清理，输出 $-1$。", "hint": "### 样例解释\n\n下面展示的是第二次改造后的树：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9rj8iovq.png)\n\n一种最优的清理方案是清理 $1-6$，$A-7$，$B-3$ 这三条路径上的所有边。\n\n### 子任务\n\n所有测试点均满足：$3 \\leq N \\leq 10^5$，$1 \\leq Q \\leq 10^5$，$\\sum D_i \\leq 10^5$，$1 \\leq u,v \\leq N$，$1 \\leq a_j \\leq N$。\n\n各子任务的约束条件如下：\n\n| 子任务编号 | 分值 | 约束                                                         |\n| ---------- | ---- | ------------------------------------------------------------ |\n| $1$        | $0$  | 样例                                                         |\n| $2$        | $9$  | $Q=1$，$\\forall i \\in [2,N]$，都存在一条连接 $1$ 和 $i$ 的边，且 Flóra 不会在 $1$ 号点上添加叶子节点 |\n| $3$        | $9$  | $Q=1$，$\\forall i \\in [1,N)$，$i$ 和 $i+1$ 之间有边相连，且 Flóra 不会在 $1$ 号点或 $N$ 号点上添加叶子节点 |\n| $4$        | $16$ | $N \\leq 2 \\times 10^4$，$Q \\leq 300$                         |\n| $5$        | $19$ | 原始的树是一棵以 $1$ 号点为根的满二叉树，即每个非叶子节点均有恰好两个子节点，且各叶子节点到根节点间的距离相等 |\n| $6$        | $17$ | $\\forall i \\in [1,Q]$，$D_i=1$                               |\n| $7$        | $30$ | 无特殊约束                                                   |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CEOI 2020] 春季大扫除", "background": "0.3s，128MB", "description": "春季大扫除也许是我们一生中最无聊的事情之一。当然，对于 Flóra 和她的母亲而言，今年的春季大扫除要有意思得多。因为她们在地毯下发现了一张已被灰尘覆盖的树形地图。\n\n这棵树有 $N$ 个节点，节点从 $1$ 到 $N$ 进行编号，这 $N$ 个点通过 $N-1$ 条边相连。这些边上都积累了过多的灰尘，因此 Flóra 的母亲准备对这棵树进行清理。\n\n清理这棵树的过程是这样的：Flóra 的母亲每次在这棵树上选择两个叶子节点（定义一棵树的叶子节点为只与恰好一个点直接相连的点），并对这两个叶子点路径上的所有边进行清理。如果这条路径上有 $d$ 条边，则清理的费用为 $d$。当这棵树上的所有边都被清理后，这棵树的清理过程就完成了。清理这棵树的总费用即为各次清理的费用之和。\n\n因为她想保护这棵树的叶子节点，因此对于每个叶子节点，她最多只会选择一次。\n\nFlóra 认为原来的树过于简单，她决定对原始的树进行一些改造。在第 $i$ 次改造中，她在原始的树的基础上添加了 $D_i$ 个叶子节点。具体来说，她会在原始的树上选择一个节点，并在该点与新的叶子节点之间连接一条边。需要注意的是，在添加新的叶子节点的过程中，原来的一些节点将不再是叶子节点。\n\n现在你需要帮助 Flóra 求出清理改造后的树的最小费用。", "inputFormat": "输入第一行包含两个数 $N,Q$，分别代表原始的树上的节点数，以及 Flóra 准备对原始的树进行的改造次数。\n\n接下来 $N-1$ 行，每行两个整数 $u,v$，表示在原始的树上 $u,v$ 两个节点间有一条边相连。\n\n接下来 $Q$ 行，每行第一个整数 $D_i$，表示 Flóra 准备在第 $i$ 次改造中添加 $D_i$ 个叶子节点。接下来 $D_i$ 个整数，第 $j$ 个整数 $a_j$ 表示 Flóra 准备在 $a_j$ 号点上添加一个叶子节点。同一个点上可能会添加多个叶子节点。\n\n每次改造过程是独立的，即在一轮改造后，Flóra 会在原始的树上重新开始改造过程。", "outputFormat": "对于每次改造，你需要输出一个整数，表示清理这棵改造后的树的最小费用。\n\n特别地，若这棵树不能被完全清理，输出 $-1$。", "hint": "### 样例解释\n\n下面展示的是第二次改造后的树：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9rj8iovq.png)\n\n一种最优的清理方案是清理 $1-6$，$A-7$，$B-3$ 这三条路径上的所有边。\n\n### 子任务\n\n所有测试点均满足：$3 \\leq N \\leq 10^5$，$1 \\leq Q \\leq 10^5$，$\\sum D_i \\leq 10^5$，$1 \\leq u,v \\leq N$，$1 \\leq a_j \\leq N$。\n\n各子任务的约束条件如下：\n\n| 子任务编号 | 分值 | 约束                                                         |\n| ---------- | ---- | ------------------------------------------------------------ |\n| $1$        | $0$  | 样例                                                         |\n| $2$        | $9$  | $Q=1$，$\\forall i \\in [2,N]$，都存在一条连接 $1$ 和 $i$ 的边，且 Flóra 不会在 $1$ 号点上添加叶子节点 |\n| $3$        | $9$  | $Q=1$，$\\forall i \\in [1,N)$，$i$ 和 $i+1$ 之间有边相连，且 Flóra 不会在 $1$ 号点或 $N$ 号点上添加叶子节点 |\n| $4$        | $16$ | $N \\leq 2 \\times 10^4$，$Q \\leq 300$                         |\n| $5$        | $19$ | 原始的树是一棵以 $1$ 号点为根的满二叉树，即每个非叶子节点均有恰好两个子节点，且各叶子节点到根节点间的距离相等 |\n| $6$        | $17$ | $\\forall i \\in [1,Q]$，$D_i=1$                               |\n| $7$        | $30$ | 无特殊约束                                                   |", "locale": "zh-CN"}}}
{"pid": "P6806", "type": "P", "difficulty": 7, "samples": [["8 8 5\nP 1 2\nR 4 8\nQ 2 3\nB 3 6\nK 5 5", "0 0\n2 2\n2 5\n2 2\n7 393"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2020", "CEOI（中欧）"], "title": "[CEOI 2020] 象棋世界", "background": "1.3s，64MB", "description": "象棋世界是一个 $R$ 行 $C$ 列的棋盘，其中 $R \\geq C$。所有的行依此编号为 $1$ 到 $R$，所有的列依此编号为 $1$ 到 $C$。\n\n在象棋世界里，共有五种棋子：兵，车，象，后，王。与现实世界不同的是，骑士精神在象棋世界中已经死亡，因此象棋世界里找不到马。\n\n象棋世界里，每种棋子可以按如下规则进行一步移动：\n\n- 兵只能向行号增大的方向走一步（从第 $r$ 行到第 $r+1$ 行），且其所处的列不变。\n- 车只能沿水平方向或竖直方向移动。\n- 象只能沿对角线方向移动。\n- 后可以沿水平方向，竖直方向，或对角线方向移动。\n- 王可以向与之相邻的八个格子移动。\n\n为了方便你理解，我们在下图给出了每种棋子的合法移动范围。其中 X 代表该棋子能移动到的位置。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wgweh8tf.png)\n\n最近一段时间，象棋世界发生了不少诡异的事情：某些棋子可能会被不明来源的力量所劫持，随后从象棋世界中消失。在这种情况下，所有棋子都希望能尽快前往他们想要到达的目的地，他们还想知道，在走的步数最少的前提下，到达目的地的方案数有多少。两种方案是不同的，当且仅当这两种方案中有一步经过的格子不同。\n\n在本题中，你需要解决下面这个问题：某个棋子将从第 $1$ 行的第 $c_1$ 列出发，到达第 $R$ 行的第 $c_R$ 列。现在给出这个棋子的类型，以及 $c_1,c_R$ 的值，你需要求出，这个棋子最少需要走多少步，以及在步数最少的前提下，行走方案有多少种。", "inputFormat": "第一行包含三个整数 $R,C,Q$，表示象棋世界中棋盘的行数，列数，以及需要回答的询问数。\n\n接下来 $Q$ 行，包含一个字母 $T$，代表棋子种类，以及两个整数 $c_1,c_R$，代表起点为第 $1$ 行的第 $c_1$ 列，终点为第 $R$ 行的第 $c_R$ 列。\n\n各字母与棋子种类对应关系如下所示：\n\n| 字母         | 棋子种类 |\n| ------------ | -------- |\n| $\\texttt{P}$ | 兵       |\n| $\\texttt{R}$ | 车       |\n| $\\texttt{B}$ | 象       |\n| $\\texttt{Q}$ | 后       |\n| $\\texttt{K}$ | 王       |", "outputFormat": "对于每个询问，输出两个整数，第一个整数代表从起点到终点需要走的最少步数，第二个整数代表在步数最少的前提下，从起点到终点的方案数。\n\n因为方案数可能很大，请输出其对 $10^9+7$ 取模后的结果。\n\n特别地，若无法从起点到达终点，请输出一行 `0 0`。", "hint": "所有测试点均满足：$1 \\leq Q \\leq 1000$，$2 \\leq C \\leq 1000$，$C \\leq R \\leq 10^9$，$T \\in \\{\\texttt{P},\\texttt{R},\\texttt{Q},\\texttt{B},\\texttt{K}\\}$，$1 \\leq c_1,c_R \\leq C$。\n\n各子任务的约束条件如下：\n\n| 子任务编号 | 分值 | 约束                                         |\n| ---------- | ---- | -------------------------------------------- |\n| $1$        | $0$  | 样例                                         |\n| $2$        | $8$  | $T \\in \\{\\texttt{P},\\texttt{R},\\texttt{Q}\\}$ |\n| $3$        | $15$ | $T=\\texttt{B}$，$C,R \\leq 100$               |\n| $4$        | $22$ | $T=\\texttt{B}$                               |\n| $5$        | $5$  | $T=\\texttt{K}$，$C,R \\leq 100$，$Q \\leq 50$  |\n| $6$        | $8$  | $T=\\texttt{K}$，$C,R \\leq 100$               |\n| $7$        | $15$ | $T=\\texttt{K}$，$C \\leq 100$                 |\n| $8$        | $20$ | $T=\\texttt{K}$                               |\n| $9$        | $7$  | 无特殊约束                                   |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CEOI 2020] 象棋世界", "background": "1.3s，64MB", "description": "象棋世界是一个 $R$ 行 $C$ 列的棋盘，其中 $R \\geq C$。所有的行依此编号为 $1$ 到 $R$，所有的列依此编号为 $1$ 到 $C$。\n\n在象棋世界里，共有五种棋子：兵，车，象，后，王。与现实世界不同的是，骑士精神在象棋世界中已经死亡，因此象棋世界里找不到马。\n\n象棋世界里，每种棋子可以按如下规则进行一步移动：\n\n- 兵只能向行号增大的方向走一步（从第 $r$ 行到第 $r+1$ 行），且其所处的列不变。\n- 车只能沿水平方向或竖直方向移动。\n- 象只能沿对角线方向移动。\n- 后可以沿水平方向，竖直方向，或对角线方向移动。\n- 王可以向与之相邻的八个格子移动。\n\n为了方便你理解，我们在下图给出了每种棋子的合法移动范围。其中 X 代表该棋子能移动到的位置。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wgweh8tf.png)\n\n最近一段时间，象棋世界发生了不少诡异的事情：某些棋子可能会被不明来源的力量所劫持，随后从象棋世界中消失。在这种情况下，所有棋子都希望能尽快前往他们想要到达的目的地，他们还想知道，在走的步数最少的前提下，到达目的地的方案数有多少。两种方案是不同的，当且仅当这两种方案中有一步经过的格子不同。\n\n在本题中，你需要解决下面这个问题：某个棋子将从第 $1$ 行的第 $c_1$ 列出发，到达第 $R$ 行的第 $c_R$ 列。现在给出这个棋子的类型，以及 $c_1,c_R$ 的值，你需要求出，这个棋子最少需要走多少步，以及在步数最少的前提下，行走方案有多少种。", "inputFormat": "第一行包含三个整数 $R,C,Q$，表示象棋世界中棋盘的行数，列数，以及需要回答的询问数。\n\n接下来 $Q$ 行，包含一个字母 $T$，代表棋子种类，以及两个整数 $c_1,c_R$，代表起点为第 $1$ 行的第 $c_1$ 列，终点为第 $R$ 行的第 $c_R$ 列。\n\n各字母与棋子种类对应关系如下所示：\n\n| 字母         | 棋子种类 |\n| ------------ | -------- |\n| $\\texttt{P}$ | 兵       |\n| $\\texttt{R}$ | 车       |\n| $\\texttt{B}$ | 象       |\n| $\\texttt{Q}$ | 后       |\n| $\\texttt{K}$ | 王       |", "outputFormat": "对于每个询问，输出两个整数，第一个整数代表从起点到终点需要走的最少步数，第二个整数代表在步数最少的前提下，从起点到终点的方案数。\n\n因为方案数可能很大，请输出其对 $10^9+7$ 取模后的结果。\n\n特别地，若无法从起点到达终点，请输出一行 `0 0`。", "hint": "所有测试点均满足：$1 \\leq Q \\leq 1000$，$2 \\leq C \\leq 1000$，$C \\leq R \\leq 10^9$，$T \\in \\{\\texttt{P},\\texttt{R},\\texttt{Q},\\texttt{B},\\texttt{K}\\}$，$1 \\leq c_1,c_R \\leq C$。\n\n各子任务的约束条件如下：\n\n| 子任务编号 | 分值 | 约束                                         |\n| ---------- | ---- | -------------------------------------------- |\n| $1$        | $0$  | 样例                                         |\n| $2$        | $8$  | $T \\in \\{\\texttt{P},\\texttt{R},\\texttt{Q}\\}$ |\n| $3$        | $15$ | $T=\\texttt{B}$，$C,R \\leq 100$               |\n| $4$        | $22$ | $T=\\texttt{B}$                               |\n| $5$        | $5$  | $T=\\texttt{K}$，$C,R \\leq 100$，$Q \\leq 50$  |\n| $6$        | $8$  | $T=\\texttt{K}$，$C,R \\leq 100$               |\n| $7$        | $15$ | $T=\\texttt{K}$，$C \\leq 100$                 |\n| $8$        | $20$ | $T=\\texttt{K}$                               |\n| $9$        | $7$  | 无特殊约束                                   |", "locale": "zh-CN"}}}
{"pid": "P6807", "type": "P", "difficulty": 3, "samples": [["5 10\n2 2 1 4 3 2 5 4 2 3", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2010", "BalticOI（波罗的海）"], "title": "[BalticOI 2010] Matching Bins (Day2)", "background": "", "description": "给定一行 $N$ 个整数 $A_1,A_2,\\dots,A_N$。 $M=\\max\\{A_1,A_2,\\dots A_N\\}$。\n\n你需要找到一个最大的整数 $K$，使得从左至右共 $K$ 个数都小于接下来的 $K$ 个数。", "inputFormat": "输入第一行两个整数 $M,N$，表示数列中的最大数和数的个数。\n\n第二行 $N$ 个整数 $A_1,A_2,\\dots,A_N$。", "outputFormat": "输出一行一个整数，为最大的 $K$。", "hint": "对于 $100\\%$ 的数据，保证 $1\\le M\\le 2\\times 10^3$，$1\\le N\\le 2\\times 10^4$，$1\\le A_i\\le M$。\n\n----\n\n**题目译自 [BalticOI 2010](https://www.luogu.com.cn/problem/U125995) [Day2](https://boi.cses.fi/files/boi2010_day2.pdf) *T1 Matching Bins***。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 2010] Matching Bins (Day2)", "background": "", "description": "给定一行 $N$ 个整数 $A_1,A_2,\\dots,A_N$。 $M=\\max\\{A_1,A_2,\\dots A_N\\}$。\n\n你需要找到一个最大的整数 $K$，使得从左至右共 $K$ 个数都小于接下来的 $K$ 个数。", "inputFormat": "输入第一行两个整数 $M,N$，表示数列中的最大数和数的个数。\n\n第二行 $N$ 个整数 $A_1,A_2,\\dots,A_N$。", "outputFormat": "输出一行一个整数，为最大的 $K$。", "hint": "对于 $100\\%$ 的数据，保证 $1\\le M\\le 2\\times 10^3$，$1\\le N\\le 2\\times 10^4$，$1\\le A_i\\le M$。\n\n----\n\n**题目译自 [BalticOI 2010](https://www.luogu.com.cn/problem/U125995) [Day2](https://boi.cses.fi/files/boi2010_day2.pdf) *T1 Matching Bins***。", "locale": "zh-CN"}}}
{"pid": "P6808", "type": "P", "difficulty": 5, "samples": [["4\n1 3 4 4", "4 9"], ["5\n3 3 3 3 3", "3 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2010", "BalticOI（波罗的海）"], "title": "[BalticOI 2010] Candies (Day2)", "background": null, "description": "给定一个长度为 $N$ 的序列 $B_1,B_2,\\dots,B_N$。\n\n一个整数 $M$ 能够被表示出来当且仅当从序列中任取 $K$ 个数 $A_1,A_2,\\dots,A_K$，使得 $\\sum_{i=1}^{K}A_i=M$。\n\n你需要修改序列中的一个数 $P$，使得尽可能多的整数能够被表示出来。", "inputFormat": "输入第一行一个整数 $N$。\n\n第二行 $N$ 个整数 $B_1,B_2,\\dots,B_N$。", "outputFormat": "输出一行两个整数 $P,Q$，以一个空格隔开。\n\n表示序列中的一个数字 $P$ 修改成 $Q$。\n\n如果有多种方案，则输出的 $P$ 尽可能小。 $P$ 最小时如有多种方案，则输出的 $Q$ 尽可能小。", "hint": "对于 $100\\%$ 的数据，保证 $2\\le N\\le 100$，$1\\le B_i\\le 7000$。\n\n\n**题目译自 [BalticOI 2010](https://www.luogu.com.cn/problem/U126003) [Day2](https://boi.cses.fi/files/boi2010_day2.pdf) *T2 Candies***。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 2010] Candies (Day2)", "background": null, "description": "给定一个长度为 $N$ 的序列 $B_1,B_2,\\dots,B_N$。\n\n一个整数 $M$ 能够被表示出来当且仅当从序列中任取 $K$ 个数 $A_1,A_2,\\dots,A_K$，使得 $\\sum_{i=1}^{K}A_i=M$。\n\n你需要修改序列中的一个数 $P$，使得尽可能多的整数能够被表示出来。", "inputFormat": "输入第一行一个整数 $N$。\n\n第二行 $N$ 个整数 $B_1,B_2,\\dots,B_N$。", "outputFormat": "输出一行两个整数 $P,Q$，以一个空格隔开。\n\n表示序列中的一个数字 $P$ 修改成 $Q$。\n\n如果有多种方案，则输出的 $P$ 尽可能小。 $P$ 最小时如有多种方案，则输出的 $Q$ 尽可能小。", "hint": "对于 $100\\%$ 的数据，保证 $2\\le N\\le 100$，$1\\le B_i\\le 7000$。\n\n\n**题目译自 [BalticOI 2010](https://www.luogu.com.cn/problem/U126003) [Day2](https://boi.cses.fi/files/boi2010_day2.pdf) *T2 Candies***。", "locale": "zh-CN"}}}
{"pid": "P6809", "type": "P", "difficulty": 7, "samples": [["3 5\n24531\n46631\n34310", ".XXX.\n.XX..\nXX...\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2010", "提交答案", "Special Judge", "BalticOI（波罗的海）"], "title": "[BalticOI 2010] Mines (Day2)", "background": "**本题为提交答案题，输入公开，请见题目附件。**", "description": "给定一个 $H\\times W$ 的矩阵 A，矩阵 A 中的每个数都等于矩阵 B 中相同位置四周八个方向的 `X` 加上该位置的 `X` 的个数。\n\n请构造任意一种由 `.` 和 `X` 组成的满足题意的 $H\\times W$ 的矩阵 B.", "inputFormat": "输入第一行一个整数 $H,W$，表示矩阵的规格。\n\n接下来的 $H$ 行，每行 $W$ 个整数，表示矩阵 A。", "outputFormat": "输出共 $H$ 行，每行 $W$ 个字符 `.` 或 `X`，表示一种满足条件的矩阵 B。**本题使用 SPJ。**", "hint": "对于 $100\\%$ 的数据，保证 $1\\le H,W\\le 600$，始终有方案存在。\n\n**题目译自 [BalticOI 2010](https://www.luogu.com.cn/problem/U126003) [Day2](https://boi.cses.fi/files/boi2010_day2.pdf) *T3 Mines***。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 2010] Mines (Day2)", "background": "**本题为提交答案题，输入公开，请见题目附件。**", "description": "给定一个 $H\\times W$ 的矩阵 A，矩阵 A 中的每个数都等于矩阵 B 中相同位置四周八个方向的 `X` 加上该位置的 `X` 的个数。\n\n请构造任意一种由 `.` 和 `X` 组成的满足题意的 $H\\times W$ 的矩阵 B.", "inputFormat": "输入第一行一个整数 $H,W$，表示矩阵的规格。\n\n接下来的 $H$ 行，每行 $W$ 个整数，表示矩阵 A。", "outputFormat": "输出共 $H$ 行，每行 $W$ 个字符 `.` 或 `X`，表示一种满足条件的矩阵 B。**本题使用 SPJ。**", "hint": "对于 $100\\%$ 的数据，保证 $1\\le H,W\\le 600$，始终有方案存在。\n\n**题目译自 [BalticOI 2010](https://www.luogu.com.cn/problem/U126003) [Day2](https://boi.cses.fi/files/boi2010_day2.pdf) *T3 Mines***。", "locale": "zh-CN"}}}
