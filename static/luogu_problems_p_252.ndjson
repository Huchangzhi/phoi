{"pid": "P6095", "type": "P", "difficulty": 6, "samples": [["4 2\n4321", "32"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "二分", "各省省选", "江苏", "后缀数组 SA"], "title": "[JSOI2015] 串分割", "background": "JYY 每天都会在地铁上度过很长的时间。\n\n为了打发时间，JYY 随手写下了一个很长的环形的数字字符串，并且陷入了沉思。", "description": "JYY 写下了一个长度为 $N$ 的，仅包含 `1`，`2`，……，`9` 这 $9$ 种不同字符的环形字符串 $S$。JYY 希望把 $S$ 进行 $K$ 次切割，并分成 $K$ 个非空的子串。对于每一个子串，由于其仅包含数字，我们可以将其看成一个十进制数——因此\n经过 $K$ 次切割，JYY 可以得到 $K$ 个不同的十进制数。JYY 希望他得到的这 $K$ 个数中，最大的那一个尽量小。", "inputFormat": "第一行包含两个整数 $N$ 和 $K$。\n\n第二行包含一个长度为 $N$ 的字符串 $S$。", "outputFormat": "输出一行包含一个正整数，表示最佳分割方案中，JYY 所得到的那 $K$ 个数中，最大的那一个。\n\n", "hint": "对于 $100\\%$ 的数据，$3\\leq N\\leq 2\\times 10^5$，$2\\leq K\\leq N$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2015] 串分割", "background": "JYY 每天都会在地铁上度过很长的时间。\n\n为了打发时间，JYY 随手写下了一个很长的环形的数字字符串，并且陷入了沉思。", "description": "JYY 写下了一个长度为 $N$ 的，仅包含 `1`，`2`，……，`9` 这 $9$ 种不同字符的环形字符串 $S$。JYY 希望把 $S$ 进行 $K$ 次切割，并分成 $K$ 个非空的子串。对于每一个子串，由于其仅包含数字，我们可以将其看成一个十进制数——因此\n经过 $K$ 次切割，JYY 可以得到 $K$ 个不同的十进制数。JYY 希望他得到的这 $K$ 个数中，最大的那一个尽量小。", "inputFormat": "第一行包含两个整数 $N$ 和 $K$。\n\n第二行包含一个长度为 $N$ 的字符串 $S$。", "outputFormat": "输出一行包含一个正整数，表示最佳分割方案中，JYY 所得到的那 $K$ 个数中，最大的那一个。\n\n", "hint": "对于 $100\\%$ 的数据，$3\\leq N\\leq 2\\times 10^5$，$2\\leq K\\leq N$。", "locale": "zh-CN"}}}
{"pid": "P6096", "type": "P", "difficulty": 5, "samples": [["2 5\nA B C D E\n4 A B C D\n3 C D E\nA D", "1\n3"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "各省省选", "江苏", "最短路"], "title": "[JSOI2015] 地铁线路", "background": "", "description": "JSOI 王国的地铁又涨价了！正在 JSOI 旅游的 JYY 非常不开心。这次票价改革后，乘客并不是按照乘坐的距离收费，而是按照换乘次数进行收费的！JYY 也要按此更新他的线路搜索软件了。JYY 心想，在支付同样票价的前提下，岂不\n是坐的站数越多，自己就赚的越多嘛！于是 JYY 希望开发一个线路搜索软件，使得自己总能够“赚”的最多！\n\nJSOI 地铁一共有 $N$ 条线路 $S$ 个车站。第 $i$ 条地铁线路包含 $L_i$ 个站。所有地铁线路都是一条从首发站到终点站的直线型线路（不存在例如北京地铁 2 号线或者 10 号线那样奇葩的环线）。同时，每一条地铁线路都是双向运行的。如果有不同的线路经过同一个地铁站，那么乘客就可以在那个地铁站进行换乘。根据 JSOI 地铁的最新收费方式，每当乘客进入一列正在运行的地铁列车，都需要支付 $1$ 的费用。因此，假设乘客一共换乘了 $x$ 次，那么就需要总共支付 $x+1$ 的乘车费用。由于地铁线路都是双向运行的，因此在任意一站都可以换乘该线地铁反方向运行的列车。不过，需要注意的是，即使是换乘同样线路的反方向列车，也是需要付费的（因为总是需要先下车，再重新上车的）。\n\nJYY现在要从 $A$ 站坐地铁前往 $B$ 站。假设对于任意一条地铁线路，相邻两站间地铁的运行时间均为 $1$ 分钟，并且列车停站和换乘均不耗时间，JYY想知道\n\n1. 他最少需要支付的票价是多少钱；\n2. 在支付最少票价的前提下，他最多可以乘坐多少分钟的地铁。", "inputFormat": "第一行包含两个正整数 $N$ 和 $S$。\n\n第二行包含 $S$ 个由空格隔开的字符串，表示 $S$ 个站点的站名。\n\n接下来 $N$ 行，每行描述一条地铁线路。对于其中第 $i$ 行，首先包含一个正整数 $L_i$，接下来 $L_i$ 个字符串，表示这条地铁线路上的站点名称。一条线路允许多次停靠同一个站点。\n\n第 $N+3$ 行，包含两个不同的字符串 $A$ 和 $B$，表示 JYY 目前在 $A$ 站，希望坐地铁前往 $B$ 站。", "outputFormat": "第一行包含一个整数 $C$，表示 JYY 最少需要支付的乘车费用。\n\n第二行包含一个整数 $T$，表示 JYY 在花费 $C$ 的前提下，可以乘坐地铁的最长时间。\n\n如果不存在两个站点之间的路线，第一行输出`-1`，第二行输出 `0`。", "hint": "对于 $100\\%$ 的数据，$2\\leq N\\leq 4\\times 10^5$，$S\\leq 3\\times 10^5$，$\\sum L_i\\leq 8\\times 10^5$。\n\n保证输入所有字符串的长度不超过 $40$，且仅包含字母、数字以及横线 `-`。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2015] 地铁线路", "background": "", "description": "JSOI 王国的地铁又涨价了！正在 JSOI 旅游的 JYY 非常不开心。这次票价改革后，乘客并不是按照乘坐的距离收费，而是按照换乘次数进行收费的！JYY 也要按此更新他的线路搜索软件了。JYY 心想，在支付同样票价的前提下，岂不\n是坐的站数越多，自己就赚的越多嘛！于是 JYY 希望开发一个线路搜索软件，使得自己总能够“赚”的最多！\n\nJSOI 地铁一共有 $N$ 条线路 $S$ 个车站。第 $i$ 条地铁线路包含 $L_i$ 个站。所有地铁线路都是一条从首发站到终点站的直线型线路（不存在例如北京地铁 2 号线或者 10 号线那样奇葩的环线）。同时，每一条地铁线路都是双向运行的。如果有不同的线路经过同一个地铁站，那么乘客就可以在那个地铁站进行换乘。根据 JSOI 地铁的最新收费方式，每当乘客进入一列正在运行的地铁列车，都需要支付 $1$ 的费用。因此，假设乘客一共换乘了 $x$ 次，那么就需要总共支付 $x+1$ 的乘车费用。由于地铁线路都是双向运行的，因此在任意一站都可以换乘该线地铁反方向运行的列车。不过，需要注意的是，即使是换乘同样线路的反方向列车，也是需要付费的（因为总是需要先下车，再重新上车的）。\n\nJYY现在要从 $A$ 站坐地铁前往 $B$ 站。假设对于任意一条地铁线路，相邻两站间地铁的运行时间均为 $1$ 分钟，并且列车停站和换乘均不耗时间，JYY想知道\n\n1. 他最少需要支付的票价是多少钱；\n2. 在支付最少票价的前提下，他最多可以乘坐多少分钟的地铁。", "inputFormat": "第一行包含两个正整数 $N$ 和 $S$。\n\n第二行包含 $S$ 个由空格隔开的字符串，表示 $S$ 个站点的站名。\n\n接下来 $N$ 行，每行描述一条地铁线路。对于其中第 $i$ 行，首先包含一个正整数 $L_i$，接下来 $L_i$ 个字符串，表示这条地铁线路上的站点名称。一条线路允许多次停靠同一个站点。\n\n第 $N+3$ 行，包含两个不同的字符串 $A$ 和 $B$，表示 JYY 目前在 $A$ 站，希望坐地铁前往 $B$ 站。", "outputFormat": "第一行包含一个整数 $C$，表示 JYY 最少需要支付的乘车费用。\n\n第二行包含一个整数 $T$，表示 JYY 在花费 $C$ 的前提下，可以乘坐地铁的最长时间。\n\n如果不存在两个站点之间的路线，第一行输出`-1`，第二行输出 `0`。", "hint": "对于 $100\\%$ 的数据，$2\\leq N\\leq 4\\times 10^5$，$S\\leq 3\\times 10^5$，$\\sum L_i\\leq 8\\times 10^5$。\n\n保证输入所有字符串的长度不超过 $40$，且仅包含字母、数字以及横线 `-`。", "locale": "zh-CN"}}}
{"pid": "P6097", "type": "P", "difficulty": 6, "samples": [["2\n1 0 2 1\n2 0 2 1", "2 0 6 3"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["O2优化", "快速沃尔什变换 FWT", "快速莫比乌斯变换 FMT", "集合幂级数，子集卷积", "模板题"], "title": "【模板】子集卷积", "background": "这是一道模板题。", "description": "给定两个长度为 $2^n$ 的序列 $a_0,a_1,\\cdots,a_{2^n-1}$ 和 $b_0,b_1,\\cdots,b_{2^n-1}$，你需要求出一个序列 $c_0,c_1,\\cdots,c_{2^n-1}$，其中 $c_k$ 满足：\n\n$$c_k=\\sum_{\\substack{{i \\& j=0}\\\\{i~\\mid~ j=k}}} a_i b_j$$\n\n其中$~\\mid~$表示按位或，$\\&$表示按位与。\n\n答案对 $10^9+9$ 取模。", "inputFormat": "第一行输入一个正整数 $n$ ，表示集合的大小。\n\n第二行有 $2^n$ 个整数，描述了 $a$。\n\n第三行有 $2^n$ 个整数，描述了 $b$。", "outputFormat": "输出一行 $2^n$ 个整数，表示 $c$。", "hint": "对于所有数据，$1\\le n\\le 20$，$0\\le a_i,b_i< 10^9+9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】子集卷积", "background": "这是一道模板题。", "description": "给定两个长度为 $2^n$ 的序列 $a_0,a_1,\\cdots,a_{2^n-1}$ 和 $b_0,b_1,\\cdots,b_{2^n-1}$，你需要求出一个序列 $c_0,c_1,\\cdots,c_{2^n-1}$，其中 $c_k$ 满足：\n\n$$c_k=\\sum_{\\substack{{i \\& j=0}\\\\{i~\\mid~ j=k}}} a_i b_j$$\n\n其中$~\\mid~$表示按位或，$\\&$表示按位与。\n\n答案对 $10^9+9$ 取模。", "inputFormat": "第一行输入一个正整数 $n$ ，表示集合的大小。\n\n第二行有 $2^n$ 个整数，描述了 $a$。\n\n第三行有 $2^n$ 个整数，描述了 $b$。", "outputFormat": "输出一行 $2^n$ 个整数，表示 $c$。", "hint": "对于所有数据，$1\\le n\\le 20$，$0\\le a_i,b_i< 10^9+9$。", "locale": "zh-CN"}}}
{"pid": "P6098", "type": "P", "difficulty": 5, "samples": [["5 5\n1 2 4 8 16\n1 2\n1 3\n3 4\n3 5\n2 1 5\n1 1 16\n2 3 5\n2 1 5\n2 1 3\n", "21\n20\n4\n20\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2019", "线段树", "USACO", "树状数组", "树链剖分"], "title": "[USACO19FEB] Cow Land G", "background": "Cow Land 是一个特殊的奶牛游乐园，奶牛们可以在那里漫步，吃美味的草，并参观不同的景点（尤其过山车特别受欢迎）。", "description": "Cow Land 总共有 $ N $ 个不同的景点（ $ 2 \\leq N \\leq 10^5 $ ）。 一共有 $ n-1 $ 条道路连接任意两个景点，这意味着任意两个景点间只有一条简单路径。\n\n每个景点 $ i $ 都有一个享受值 $ e_i $ ，这个值可能会改变。因为一些景点在早上更有吸引力，而其他景点在下午则更能吸引游客。\n\n从景点 $ i $ 到景点 $ j $ 的奶牛们可以欣赏从景点 $ i $ 到景点 $ j $ 的路上的所有景观。这条路线的享受值为景点 $ i $ 到景点 $ j $ 的路上的所有景点（包括景点 $ i $ 和景点 $ j $ ）的享受值按位进行异或运算的结果。\n\n请帮助奶牛确定他们前往 Cow Land 旅行时计划的路线的享受值。", "inputFormat": "输入的第一行包含两个整数， $ N,Q $（$1 \\leq Q \\leq 10^5$）。\n\n接下来一行包含 $ N $ 个整数，其中第 $ i $ 个整数 $ e_i $ 代表景点 $ i $ 的享受值。\n\n接下来 $ N-1 $ 行，每行包含两个整数 $ a,b $ ，表示景点 $ a $ 和景点 $ b $ 之间有一条道路相连。\n\n最后 $ Q $ 行，每行包含 3 个整数，表示一个操作，具体内容如下：\n\n1. `1 i v`，表示将 $ e_i $ 修改为 $ v $ 。\n2. `2 i j`，表示询问从景点 $ i $ 到景点 $ j $ 的路线的享受值为多少。", "outputFormat": "对于每个 2 操作，输出对应查询的结果。", "hint": "子任务：对于 $ 50\\% $ 的数据，没有修改操作。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19FEB] Cow Land G", "background": "Cow Land is a special cow amusement park where cows can walk around, eat tasty grass, and visit different attractions (especially the roller coasters, which are very popular).", "description": "Cow Land has a total of $N$ different attractions ($2 \\leq N \\leq 10^5$). There are $N-1$ roads connecting pairs of attractions, which means there is exactly one simple path between any two attractions.\n\nEach attraction $i$ has an enjoyment value $e_i$, and this value may change. This is because some attractions are more appealing in the morning, while others are more appealing in the afternoon.\n\nCows traveling from attraction $i$ to attraction $j$ can enjoy all the sights along the path from $i$ to $j$. The enjoyment value of this route is the bitwise XOR of the enjoyment values of all attractions on the path from $i$ to $j$ (including attraction $i$ and attraction $j$).\n\nPlease help the cows determine the enjoyment value of the routes they plan to take during their trip to Cow Land.", "inputFormat": "The first line contains two integers $N, Q$ ($1 \\leq Q \\leq 10^5$).\n\nThe next line contains $N$ integers, where the $i$-th integer $e_i$ represents the enjoyment value of attraction $i$.\n\nThe next $N-1$ lines each contain two integers $a, b$, indicating that there is a road connecting attraction $a$ and attraction $b$.\n\nThe last $Q$ lines each contain 3 integers, describing an operation as follows.\n\n1. `1 i v`, meaning to change $e_i$ to $v$.\n2. `2 i j`, meaning to ask what the enjoyment value of the route from attraction $i$ to attraction $j$ is.", "outputFormat": "For each operation of type 2, output the answer to the corresponding query.", "hint": "Subtasks: For $50\\%$ of the testdata, there are no update operations.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19FEB] Cow Land G", "background": "Cow Land 是一个特殊的奶牛游乐园，奶牛们可以在那里漫步，吃美味的草，并参观不同的景点（尤其过山车特别受欢迎）。", "description": "Cow Land 总共有 $ N $ 个不同的景点（ $ 2 \\leq N \\leq 10^5 $ ）。 一共有 $ n-1 $ 条道路连接任意两个景点，这意味着任意两个景点间只有一条简单路径。\n\n每个景点 $ i $ 都有一个享受值 $ e_i $ ，这个值可能会改变。因为一些景点在早上更有吸引力，而其他景点在下午则更能吸引游客。\n\n从景点 $ i $ 到景点 $ j $ 的奶牛们可以欣赏从景点 $ i $ 到景点 $ j $ 的路上的所有景观。这条路线的享受值为景点 $ i $ 到景点 $ j $ 的路上的所有景点（包括景点 $ i $ 和景点 $ j $ ）的享受值按位进行异或运算的结果。\n\n请帮助奶牛确定他们前往 Cow Land 旅行时计划的路线的享受值。", "inputFormat": "输入的第一行包含两个整数， $ N,Q $（$1 \\leq Q \\leq 10^5$）。\n\n接下来一行包含 $ N $ 个整数，其中第 $ i $ 个整数 $ e_i $ 代表景点 $ i $ 的享受值。\n\n接下来 $ N-1 $ 行，每行包含两个整数 $ a,b $ ，表示景点 $ a $ 和景点 $ b $ 之间有一条道路相连。\n\n最后 $ Q $ 行，每行包含 3 个整数，表示一个操作，具体内容如下：\n\n1. `1 i v`，表示将 $ e_i $ 修改为 $ v $ 。\n2. `2 i j`，表示询问从景点 $ i $ 到景点 $ j $ 的路线的享受值为多少。", "outputFormat": "对于每个 2 操作，输出对应查询的结果。", "hint": "子任务：对于 $ 50\\% $ 的数据，没有修改操作。", "locale": "zh-CN"}}}
{"pid": "P6099", "type": "P", "difficulty": 4, "samples": [["5\n4\n5\n2\n3\n1", "4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2019", "二分", "USACO", "栈"], "title": "[USACO19FEB] Dishwashing G", "background": "Bessie 和 Elsie 正在帮助 Farmer John 洗碗，这是一个比人们想象的更复杂的过程。", "description": "两头奶牛决定 Bessie 负责涂肥皂，Elsie 负责冲洗。\n\n刚开始的时候，$N$ 个脏盘子（保证是从 $1$ 到 $N$ 的一个排列）堆在 Bessie 那里，而 Elsie 这边的堆是空的。而在她们俩之间，则有一张专门放涂过肥皂的盘子的桌子。\n\n每个冲洗步骤需要执行以下两个操作之一：\n\n- Bessie 从脏盘子堆顶取出一个盘子，涂上肥皂，然后放在桌子上。将这个盘子放在桌子上时，Bessie 只能放在现有的非空盘堆的顶端，或是在最右边新增一个盘堆。\n- Elsie 从桌子最左边的盘堆的顶端拿起盘子，将它冲洗后放在干净的盘堆顶端。\n\n她们希望干净的盘堆能按编号排序，编号最小的在底端，编号最大的在顶端。然而她们发现有的时候这并不可能做到。现在给定脏盘子的堆叠顺序，请你求出一个最大前缀，使得该前缀的所有盘子洗干净后，能按上面的要求堆叠。", "inputFormat": "第一行一个整数 $N$（$1 \\leq N \\leq 10^5$）。\n\n接下来 $N$ 行，每行一个整数，代表 Bessie 的脏盘子堆的堆叠顺序。输入的第一个盘子在堆的顶部。", "outputFormat": "输出该序列的最大前缀长度，使得该前缀的所有盘子洗干净后，能按小号在下，大号在上的规则堆叠。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19FEB] Dishwashing G", "background": "Bessie and Elsie are helping Farmer John wash dishes, which is a more complicated process than people might think.", "description": "The two cows decide that Bessie will apply soap, and Elsie will do the rinsing.\n\nAt the beginning, $N$ dirty dishes (guaranteed to be a permutation of $1$ to $N$) are stacked on Bessie's side, while Elsie's stack is empty. Between them, there is a table specifically used to hold soaped dishes.\n\nEach rinsing step must perform one of the following two operations:\n\n- Bessie takes the top dish from the dirty stack, applies soap, and then places it onto the table. When placing this dish on the table, Bessie may only place it on top of an existing non-empty stack of dishes, or start a new stack on the far right.\n- Elsie takes the top dish from the leftmost stack on the table, rinses it, and then places it on top of the clean stack.\n\nThey want the clean stack to be sorted by label, with the smallest label at the bottom and the largest label at the top. However, they find that sometimes this is not possible. Now, given the stacking order of the dirty dishes, find the maximum prefix such that after washing all dishes in this prefix, they can be stacked according to the requirement above.", "inputFormat": "The first line contains an integer $N$ ($1 \\leq N \\leq 10^5$).\n\nThe next $N$ lines each contain one integer, representing the stacking order of Bessie's dirty dish stack. The first dish given in the input is at the top of the stack.", "outputFormat": "Output the length of the maximum prefix of the sequence such that after washing all dishes in this prefix, they can be stacked with smaller labels at the bottom and larger labels at the top.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19FEB] Dishwashing G", "background": "Bessie 和 Elsie 正在帮助 Farmer John 洗碗，这是一个比人们想象的更复杂的过程。", "description": "两头奶牛决定 Bessie 负责涂肥皂，Elsie 负责冲洗。\n\n刚开始的时候，$N$ 个脏盘子（保证是从 $1$ 到 $N$ 的一个排列）堆在 Bessie 那里，而 Elsie 这边的堆是空的。而在她们俩之间，则有一张专门放涂过肥皂的盘子的桌子。\n\n每个冲洗步骤需要执行以下两个操作之一：\n\n- Bessie 从脏盘子堆顶取出一个盘子，涂上肥皂，然后放在桌子上。将这个盘子放在桌子上时，Bessie 只能放在现有的非空盘堆的顶端，或是在最右边新增一个盘堆。\n- Elsie 从桌子最左边的盘堆的顶端拿起盘子，将它冲洗后放在干净的盘堆顶端。\n\n她们希望干净的盘堆能按编号排序，编号最小的在底端，编号最大的在顶端。然而她们发现有的时候这并不可能做到。现在给定脏盘子的堆叠顺序，请你求出一个最大前缀，使得该前缀的所有盘子洗干净后，能按上面的要求堆叠。", "inputFormat": "第一行一个整数 $N$（$1 \\leq N \\leq 10^5$）。\n\n接下来 $N$ 行，每行一个整数，代表 Bessie 的脏盘子堆的堆叠顺序。输入的第一个盘子在堆的顶部。", "outputFormat": "输出该序列的最大前缀长度，使得该前缀的所有盘子洗干净后，能按小号在下，大号在上的规则堆叠。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6100", "type": "P", "difficulty": 5, "samples": [["3 2\n1 1 4 4\n3 3 7 6\n2 2 8 7", "26"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "2019", "USACO", "差分"], "title": "[USACO19FEB] Painting the Barn G", "background": "", "description": "Farmer John 不太擅长多任务处理。他经常分心，很难完成一些长期的项目。目前，他正在谷仓的一侧刷油漆，但他一直忙着在很小的区域涂抹油漆，然后由于抚育母牛的需要而陷入困境，使谷仓的某些部分比其他部分涂有更多的油漆。\n\n我们将谷仓的墙描述为一个 X-Y 平面，每次涂油漆的区域都是一个矩形。FJ 在这个平面上绘制了 $N$ 个矩形，每个矩形的边均与坐标轴平行。因此我们用矩形的左下角和右上角坐标来描述一个矩形。\n\nFJ 想在谷仓里涂几层油漆，这样就不需要在不久的将来再次重新涂油漆。但是，他不想浪费时间涂过多的油漆。事实证明，$K$ 层涂料是最佳用量。但是因为涂油漆的面积太小了，FJ 并不太高兴。他决定最多再绘制两个**不相交**的矩形（这里的相交指两个矩形交的面积大于零，即如果两个矩形仅共用一条边或一个点，则不视为相交）来增加面积。当然不绘制新矩形或仅绘制一个新矩形也是允许的。", "inputFormat": "第一行两个整数 $N,K$（$1 \\leq N,K \\leq 10^5$）。\n\n接下来 $N$ 行，每行四个整数 $x_1,y_1,x_2,y_2$（$0 \\leq x_1,y_1,x_2,y_2 \\leq 200$），描述一个矩形。其左下角坐标为 $(x_1,y_1)$，右上角坐标为 $x_2,y_2$。保证所有矩形面积为正，即其不会退化为线段或点。\n\n和现有的矩形一样，新绘制的矩形，其左下角和右上角坐标也必须是整数，且坐标必须在 $0 \\sim 200$ 之间，面积也必须为正。", "outputFormat": "输出被涂油漆恰好 $K$ 次区域的最大面积。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO19FEB] Painting the Barn G", "background": "", "description": "Farmer John 不太擅长多任务处理。他经常分心，很难完成一些长期的项目。目前，他正在谷仓的一侧刷油漆，但他一直忙着在很小的区域涂抹油漆，然后由于抚育母牛的需要而陷入困境，使谷仓的某些部分比其他部分涂有更多的油漆。\n\n我们将谷仓的墙描述为一个 X-Y 平面，每次涂油漆的区域都是一个矩形。FJ 在这个平面上绘制了 $N$ 个矩形，每个矩形的边均与坐标轴平行。因此我们用矩形的左下角和右上角坐标来描述一个矩形。\n\nFJ 想在谷仓里涂几层油漆，这样就不需要在不久的将来再次重新涂油漆。但是，他不想浪费时间涂过多的油漆。事实证明，$K$ 层涂料是最佳用量。但是因为涂油漆的面积太小了，FJ 并不太高兴。他决定最多再绘制两个**不相交**的矩形（这里的相交指两个矩形交的面积大于零，即如果两个矩形仅共用一条边或一个点，则不视为相交）来增加面积。当然不绘制新矩形或仅绘制一个新矩形也是允许的。", "inputFormat": "第一行两个整数 $N,K$（$1 \\leq N,K \\leq 10^5$）。\n\n接下来 $N$ 行，每行四个整数 $x_1,y_1,x_2,y_2$（$0 \\leq x_1,y_1,x_2,y_2 \\leq 200$），描述一个矩形。其左下角坐标为 $(x_1,y_1)$，右上角坐标为 $x_2,y_2$。保证所有矩形面积为正，即其不会退化为线段或点。\n\n和现有的矩形一样，新绘制的矩形，其左下角和右上角坐标也必须是整数，且坐标必须在 $0 \\sim 200$ 之间，面积也必须为正。", "outputFormat": "输出被涂油漆恰好 $K$ 次区域的最大面积。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6101", "type": "P", "difficulty": 2, "samples": [["nzhtl1477\n15\n", "2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["洛谷月赛"], "title": "[EER2] 出言不逊", "background": "你出言不逊是！！", "description": "珂愛想出公开赛，但每次都被拒绝。\n\n珂愛很生气，于是学会了出言不逊。\n\n珂愛用一个字符串 $S$ 存储了她想说的话，但这句话太逊了。为了出言不逊，珂愛要对字符串进行操作。每次操作，珂愛可以选择一个字符 $c$，若 $c$ 在字符串 $S$ 中出现了 $x$ 次，则珂愛会将 $x$ 个字符 $c$ 补到 $S$ 的尾部。\n\n珂愛认为，这个字符串长度至少为 $L$ 时，她才能出言不逊。珂愛想要知道，她至少需要操作多少次，才能让这个字符串的长度**大于等于** $L$。\n\n如果你不告诉珂愛，珂愛会对你出言不逊。", "inputFormat": "第一行一个字符串 $S$。\n\n第二行一个正整数 $L$。\n\n意义见题目描述。", "outputFormat": "一行一个整数，表示最小操作次数。", "hint": "### 样例解释\n\n第一次操作，选择字符 `7`，字符串变为 `nzhtl147777`，长度为 $11$。\n\n第二次操作，选择字符 `7`，字符串变为 `nzhtl1477777777`，长度为 $15$。\n\n### 限制与约定\n\n对于 $100\\%$ 的数据，$1\\leq |S|\\leq 10^6$，$1\\leq L\\lt 2^{64}$，$S$ 中只可能出现大、小写英文字母和数字，共 $62$ 种不同字符。\n\n$|S|$ 表示字符串 $S$ 的长度。\n\n本题共有 $4$ 个子任务，每个子任务的限制如下：\n\n子任务 1（$15$ 分）：保证 $|S|=L-1$。\n\n子任务 2（$20$ 分）：保证 $S$ 中只出现字符 `d`。\n\n子任务 3（$30$ 分）：$L\\leq 10^6$。\n\n子任务 4（$35$ 分）：没有特殊限制。\n\n### 提示\n\n**请注意 $L$ 的上限**。\n\n**数据在 Windows 下生成，请注意每行的行末是 `\\r\\n` 而非 `\\n`。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[EER2] 出言不逊", "background": "你出言不逊是！！", "description": "珂愛想出公开赛，但每次都被拒绝。\n\n珂愛很生气，于是学会了出言不逊。\n\n珂愛用一个字符串 $S$ 存储了她想说的话，但这句话太逊了。为了出言不逊，珂愛要对字符串进行操作。每次操作，珂愛可以选择一个字符 $c$，若 $c$ 在字符串 $S$ 中出现了 $x$ 次，则珂愛会将 $x$ 个字符 $c$ 补到 $S$ 的尾部。\n\n珂愛认为，这个字符串长度至少为 $L$ 时，她才能出言不逊。珂愛想要知道，她至少需要操作多少次，才能让这个字符串的长度**大于等于** $L$。\n\n如果你不告诉珂愛，珂愛会对你出言不逊。", "inputFormat": "第一行一个字符串 $S$。\n\n第二行一个正整数 $L$。\n\n意义见题目描述。", "outputFormat": "一行一个整数，表示最小操作次数。", "hint": "### 样例解释\n\n第一次操作，选择字符 `7`，字符串变为 `nzhtl147777`，长度为 $11$。\n\n第二次操作，选择字符 `7`，字符串变为 `nzhtl1477777777`，长度为 $15$。\n\n### 限制与约定\n\n对于 $100\\%$ 的数据，$1\\leq |S|\\leq 10^6$，$1\\leq L\\lt 2^{64}$，$S$ 中只可能出现大、小写英文字母和数字，共 $62$ 种不同字符。\n\n$|S|$ 表示字符串 $S$ 的长度。\n\n本题共有 $4$ 个子任务，每个子任务的限制如下：\n\n子任务 1（$15$ 分）：保证 $|S|=L-1$。\n\n子任务 2（$20$ 分）：保证 $S$ 中只出现字符 `d`。\n\n子任务 3（$30$ 分）：$L\\leq 10^6$。\n\n子任务 4（$35$ 分）：没有特殊限制。\n\n### 提示\n\n**请注意 $L$ 的上限**。\n\n**数据在 Windows 下生成，请注意每行的行末是 `\\r\\n` 而非 `\\n`。**", "locale": "zh-CN"}}}
{"pid": "P6102", "type": "P", "difficulty": 3, "samples": [["2\n1 2\n", "30\n"], ["6\n1 1 4 5 1 4\n", "3944\n"], ["7\n1 9 1 9 8 1 0\n", "12892\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["位运算", "洛谷月赛"], "title": "[EER2] 谔运算", "background": "在某个谔谔的一天中，CYJian 做到一道谔运算的谔谔题，CYJian 发现他不会做，于是决心从头开始研究令人谔谔的谔运算。", "description": "首先，CYJian 写出了一个长度为 $n$ 的数列 $a$。\n\n然后他灵光一动，写出了下面这个谔谔的式子：\n\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{n}\\sum_{k=1}^{n}\\sum_{l=1}^{n} (a_i\\ {\\rm or}\\ a_j)\\ {\\rm xor}\\ (a_k\\ {\\rm and}\\ a_l)$$\n\nCYJian 觉得这个是一个谔运算的简单式子，摁计算器花了 $114514{\\rm s}$ 就算出来了答案。\n\n为了证明你吊打 $114514$ 个 CYJian，请你在 $1{\\rm s}$ 内算出来这个式子的值吧。你只需要给出答案对 $2^{32}$ 取模的值即可。", "inputFormat": "第一行一个正整数 $n$ 表示数列的长度。\n\n第二行 $n$ 个非负整数，第 $i$ 个数表示 $a_i$。", "outputFormat": "一行一个非负整数，表示题目描述中给出式子的值。", "hint": "样例一解释：\n\n$(1\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 1) = 0$\n\n$(1\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 2) = 1$\n\n$(1\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 1) = 1$\n\n$(1\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 2) = 3$\n\n$(1\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 1) = 2$\n\n$(1\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 2) = 3$\n\n$(1\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 1) = 3$\n\n$(1\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 2) = 1$\n\n$(2\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 1) = 2$\n\n$(2\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 2) = 3$\n\n$(2\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 1) = 3$\n\n$(2\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 2) = 1$\n\n$(2\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 1) = 3$\n\n$(2\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 2) = 2$\n\n$(2\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 1) = 2$\n\n$(2\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 2) = 0$\n\n对所有结果求和，即可得到答案为 $30$。\n\n---\n\n**本题采用捆绑测试。**\n\n对于 $100\\%$ 的测试点：$1 \\leq n \\leq 5 \\times 10^5$，$0 \\leq a_i \\leq 2^{32}-1$。\n\n本题共 $6$ 个子任务，各子任务的分值及约定如下：\n\n子任务 $1$（$1$ 分）：为样例一。\n\n子任务 $2$（$14$ 分）：$1 \\leq n \\leq 80$。\n\n子任务 $3$（$25$ 分）：$0 \\leq a_i \\leq 80$。\n\n子任务 $4$（$30$ 分）：$0 \\leq a_i \\leq 5000$。\n\n子任务 $5$（$25$ 分）：$1 \\leq n \\leq 1000$。\n\n子任务 $6$（$5$ 分）：无特殊限制。\n\n---\n\n#### 友情提示\n\n请注意数据范围。\n\n**如果您不知道上面的谔运算是什么，请参考[这里](https://www.luogu.com.cn/paste/oe4a9czd)**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[EER2] 谔运算", "background": "在某个谔谔的一天中，CYJian 做到一道谔运算的谔谔题，CYJian 发现他不会做，于是决心从头开始研究令人谔谔的谔运算。", "description": "首先，CYJian 写出了一个长度为 $n$ 的数列 $a$。\n\n然后他灵光一动，写出了下面这个谔谔的式子：\n\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{n}\\sum_{k=1}^{n}\\sum_{l=1}^{n} (a_i\\ {\\rm or}\\ a_j)\\ {\\rm xor}\\ (a_k\\ {\\rm and}\\ a_l)$$\n\nCYJian 觉得这个是一个谔运算的简单式子，摁计算器花了 $114514{\\rm s}$ 就算出来了答案。\n\n为了证明你吊打 $114514$ 个 CYJian，请你在 $1{\\rm s}$ 内算出来这个式子的值吧。你只需要给出答案对 $2^{32}$ 取模的值即可。", "inputFormat": "第一行一个正整数 $n$ 表示数列的长度。\n\n第二行 $n$ 个非负整数，第 $i$ 个数表示 $a_i$。", "outputFormat": "一行一个非负整数，表示题目描述中给出式子的值。", "hint": "样例一解释：\n\n$(1\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 1) = 0$\n\n$(1\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 2) = 1$\n\n$(1\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 1) = 1$\n\n$(1\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 2) = 3$\n\n$(1\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 1) = 2$\n\n$(1\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 2) = 3$\n\n$(1\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 1) = 3$\n\n$(1\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 2) = 1$\n\n$(2\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 1) = 2$\n\n$(2\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 2) = 3$\n\n$(2\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 1) = 3$\n\n$(2\\ {\\rm or}\\ 1)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 2) = 1$\n\n$(2\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 1) = 3$\n\n$(2\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (1\\ {\\rm and}\\ 2) = 2$\n\n$(2\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 1) = 2$\n\n$(2\\ {\\rm or}\\ 2)\\ {\\rm xor}\\ (2\\ {\\rm and}\\ 2) = 0$\n\n对所有结果求和，即可得到答案为 $30$。\n\n---\n\n**本题采用捆绑测试。**\n\n对于 $100\\%$ 的测试点：$1 \\leq n \\leq 5 \\times 10^5$，$0 \\leq a_i \\leq 2^{32}-1$。\n\n本题共 $6$ 个子任务，各子任务的分值及约定如下：\n\n子任务 $1$（$1$ 分）：为样例一。\n\n子任务 $2$（$14$ 分）：$1 \\leq n \\leq 80$。\n\n子任务 $3$（$25$ 分）：$0 \\leq a_i \\leq 80$。\n\n子任务 $4$（$30$ 分）：$0 \\leq a_i \\leq 5000$。\n\n子任务 $5$（$25$ 分）：$1 \\leq n \\leq 1000$。\n\n子任务 $6$（$5$ 分）：无特殊限制。\n\n---\n\n#### 友情提示\n\n请注意数据范围。\n\n**如果您不知道上面的谔运算是什么，请参考[这里](https://www.luogu.com.cn/paste/oe4a9czd)**。", "locale": "zh-CN"}}}
{"pid": "P6103", "type": "P", "difficulty": 4, "samples": [["4", "9"], ["7", "140"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["O2优化", "洛谷月赛"], "title": "[EER2] 直接自然溢出啥事没有", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/hu0gfpdv.png)", "description": "给定一个整数 $n$，问有多少个长度为 $n$ 的字符串，满足这个字符串是一个“程序片段”。\n\n具体定义如下：\n\n单个分号 `;` 是一个“语句”。\n\n空串 ` ` 是一个“程序片段”。\n\n如果字符串 `A` 是“程序片段”，字符串 `B` 是“语句”，则 `AB` 是“程序片段”。\n\n如果字符串 `A` 是“程序片段”，则 `{A}` 是“语句块”。\n\n如果字符串 `A` 是“语句块”，则 `A` 是“语句”，`[]A` 和 `[]()A` 都是“函数”。\n\n如果字符串 `A` 是“函数”，则 `(A)` 是“函数”，`A` 和 `A()` 都是“值”。\n\n如果字符串 `A` 是“值”，则 `(A)` 是“值”，`A;` 是“语句”。\n\n**注意：`A` 是 `B` 并不代表 `B` 是 `A`**。", "inputFormat": "一行，一个整数 $n$。", "outputFormat": "一行，一个整数，表示答案对 $18\\,446\\,744\\,073\\,709\\,551\\,616$（$2^{64}$） 取模的结果。", "hint": "### 样例一解释\n\n合法的“程序片段”有：`;;;;`，`;;{}`，`;{;}`，`;{};`，`{;;}`，`{;};`，`{{}}`，`{};;`，`{}{}`。\n\n注意：本题采用**捆绑测试**，只有当你通过一个 subtask 中的所有测试点后，你才能拿到这个 subtask 的分数。\n\n子任务 1（$20$ 分）：$n\\leq 10$。\n\n子任务 2（$20$ 分）：$n\\leq 100$。\n\n子任务 3（$20$ 分）：$n\\leq 2500$。\n\n子任务 4（$40$ 分）：没有特殊限制。\n\n对于 $100\\%$ 的数据，$0\\leq n\\leq 10^4$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[EER2] 直接自然溢出啥事没有", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/hu0gfpdv.png)", "description": "给定一个整数 $n$，问有多少个长度为 $n$ 的字符串，满足这个字符串是一个“程序片段”。\n\n具体定义如下：\n\n单个分号 `;` 是一个“语句”。\n\n空串 ` ` 是一个“程序片段”。\n\n如果字符串 `A` 是“程序片段”，字符串 `B` 是“语句”，则 `AB` 是“程序片段”。\n\n如果字符串 `A` 是“程序片段”，则 `{A}` 是“语句块”。\n\n如果字符串 `A` 是“语句块”，则 `A` 是“语句”，`[]A` 和 `[]()A` 都是“函数”。\n\n如果字符串 `A` 是“函数”，则 `(A)` 是“函数”，`A` 和 `A()` 都是“值”。\n\n如果字符串 `A` 是“值”，则 `(A)` 是“值”，`A;` 是“语句”。\n\n**注意：`A` 是 `B` 并不代表 `B` 是 `A`**。", "inputFormat": "一行，一个整数 $n$。", "outputFormat": "一行，一个整数，表示答案对 $18\\,446\\,744\\,073\\,709\\,551\\,616$（$2^{64}$） 取模的结果。", "hint": "### 样例一解释\n\n合法的“程序片段”有：`;;;;`，`;;{}`，`;{;}`，`;{};`，`{;;}`，`{;};`，`{{}}`，`{};;`，`{}{}`。\n\n注意：本题采用**捆绑测试**，只有当你通过一个 subtask 中的所有测试点后，你才能拿到这个 subtask 的分数。\n\n子任务 1（$20$ 分）：$n\\leq 10$。\n\n子任务 2（$20$ 分）：$n\\leq 100$。\n\n子任务 3（$20$ 分）：$n\\leq 2500$。\n\n子任务 4（$40$ 分）：没有特殊限制。\n\n对于 $100\\%$ 的数据，$0\\leq n\\leq 10^4$。", "locale": "zh-CN"}}}
{"pid": "P6104", "type": "P", "difficulty": 5, "samples": [["5 2 0\n3 5 8 14 16\n2 3\n1 3\n", "41\n32\n"], ["4 2 1\n2 3 5 8\n1 2\n12 9\n", "14\n28\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 700], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["洛谷月赛"], "title": "[EER2] 相同的数字", "background": "", "description": "每天早上在黑板上会写有 $n$ 个固定的数字，但是这些数字太无序了，所以每天晚上兔子想把他们变成相同的数字。\n\n有两种操作 :\n\n* 选择一个下标 $k$，将 $a_k$ 替换为 $a_k+1$。一次操作花费 $c_1$ 的时间。\n\n* 选择一个下标 $k$，将 $a_k$ 替换为大于 $a_k$ 的最小质数。一次操作花费 $c_2$ 的时间。\n\n兔子很懒，所以他不想花费太多的时间，你需要帮他计算出将所有数变相同的最小时间。\n\n总共会有 $q$ 天。兔子每天的状态不同，所以每一天会有不同的 $c_1$ 和 $c_2$。但是黑板上的数不会变。\n\n第一天花费的时间当然会影响第二天的状态。每天真实的 $c_1 = c'_1\\oplus\n (T \\times (lastans \\bmod 2^{17}))$，$c_2 = c'_2 \\oplus\n (T\\times (lastans \\bmod 2^{17}))$。其中 $\\oplus$ 为 $\\operatorname{xor}$ 运算，$lastans$ 为上一次的答案，最初 $lastans = 0$。", "inputFormat": "第一行三个整数 $n, q, T$，表示黑板上数的个数、总天数和一个参数。\n\n第二行 $n$ 个整数 $a_i$，表示黑板上的数。\n\n接下来 $q$ 行，每行两个整数 $c'_1, c'_2$，表示每天操作花费的参数。", "outputFormat": "共 $q$ 行，每行一个整数，表示一天的最小时间。", "hint": "对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^5$，$1 \\leq a_i \\leq 10^7$，$0 \\leq T \\leq 1$，$1 \\leq q \\leq 10^6$，$1 \\leq c_1, c_2, c'_1, c'_2< 2^{17}$。\n\n| 测试点编号 | 分值 | $n\\leq$ | $a_i\\leq$ | $T=$ | $q\\leq$ |特殊性质|\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $10$ | $100$ | $100$ | $0$ | $5$ |  所有 $a_i$ 都是质数，$c_1, c_2\\leq 10^4$|\n| $2$ | $10$ | $10^5$ | $10^5$ | $0$ | $5$ | |\n| $3$ | $25$ | $10^5$ | $10^7$ | $0$ | $5$ |  |\n| $4$ | $10$ | $10^5$ | $10^7$ | $1$ | $5$ | 所有 $a_i$ 都是质数||\n| $5$ | $20$ | $10^5$ | $10^7$ | $0$ | $10^5$ |  |\n| $6$ | $22$ | $10^5$ | $10^7$ | $1$ | $10^6$ | |\n|$7$ | $\\color{red}3$ | $10^5$ | $10^7$ | $1$ | $10^6$ | $\\color{red}{时限}$ $\\color{red}{700ms}$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[EER2] 相同的数字", "background": "", "description": "每天早上在黑板上会写有 $n$ 个固定的数字，但是这些数字太无序了，所以每天晚上兔子想把他们变成相同的数字。\n\n有两种操作 :\n\n* 选择一个下标 $k$，将 $a_k$ 替换为 $a_k+1$。一次操作花费 $c_1$ 的时间。\n\n* 选择一个下标 $k$，将 $a_k$ 替换为大于 $a_k$ 的最小质数。一次操作花费 $c_2$ 的时间。\n\n兔子很懒，所以他不想花费太多的时间，你需要帮他计算出将所有数变相同的最小时间。\n\n总共会有 $q$ 天。兔子每天的状态不同，所以每一天会有不同的 $c_1$ 和 $c_2$。但是黑板上的数不会变。\n\n第一天花费的时间当然会影响第二天的状态。每天真实的 $c_1 = c'_1\\oplus\n (T \\times (lastans \\bmod 2^{17}))$，$c_2 = c'_2 \\oplus\n (T\\times (lastans \\bmod 2^{17}))$。其中 $\\oplus$ 为 $\\operatorname{xor}$ 运算，$lastans$ 为上一次的答案，最初 $lastans = 0$。", "inputFormat": "第一行三个整数 $n, q, T$，表示黑板上数的个数、总天数和一个参数。\n\n第二行 $n$ 个整数 $a_i$，表示黑板上的数。\n\n接下来 $q$ 行，每行两个整数 $c'_1, c'_2$，表示每天操作花费的参数。", "outputFormat": "共 $q$ 行，每行一个整数，表示一天的最小时间。", "hint": "对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^5$，$1 \\leq a_i \\leq 10^7$，$0 \\leq T \\leq 1$，$1 \\leq q \\leq 10^6$，$1 \\leq c_1, c_2, c'_1, c'_2< 2^{17}$。\n\n| 测试点编号 | 分值 | $n\\leq$ | $a_i\\leq$ | $T=$ | $q\\leq$ |特殊性质|\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $10$ | $100$ | $100$ | $0$ | $5$ |  所有 $a_i$ 都是质数，$c_1, c_2\\leq 10^4$|\n| $2$ | $10$ | $10^5$ | $10^5$ | $0$ | $5$ | |\n| $3$ | $25$ | $10^5$ | $10^7$ | $0$ | $5$ |  |\n| $4$ | $10$ | $10^5$ | $10^7$ | $1$ | $5$ | 所有 $a_i$ 都是质数||\n| $5$ | $20$ | $10^5$ | $10^7$ | $0$ | $10^5$ |  |\n| $6$ | $22$ | $10^5$ | $10^7$ | $1$ | $10^6$ | |\n|$7$ | $\\color{red}3$ | $10^5$ | $10^7$ | $1$ | $10^6$ | $\\color{red}{时限}$ $\\color{red}{700ms}$ |", "locale": "zh-CN"}}}
{"pid": "P6105", "type": "P", "difficulty": 6, "samples": [["7 9\n1 2\n1 3\n1 0\n1 14\n2 14\n2 13\n1 1\n", "EE\n5\n8\n8\n8\n5\n7\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2010", "O2优化", "洛谷月赛", "Ynoi"], "title": "[Ynoi2010] y-fast trie", "background": "谔谔我\n\n本题读入量约 6 MB，输出量约 5 MB，请选择适合的输入输出方法", "description": "给定一个常数 $C$，你需要维护一个集合 $S$，支持 $n$ 次操作：\n\n- 操作1：给出 $x$，插入一个元素 $x$，保证之前集合中没有 $x$ 这个元素\n- 操作2：给出 $x$，删除一个元素 $x$，保证之前集合中存在 $x$ 这个元素\n\n每次操作结束后，需要输出 $\\max\\limits_{\\substack{ i, j \\in S \\\\ i \\ne j }} \\bigl( (i+j) \\bmod C \\bigr)$，即从 $S$ 集合中选出两个不同的元素，其的和 $\\bmod~C$ 的最大值，如果 $S$ 集合中不足两个元素，则输出 `EE`。\n\n本题强制在线，每次的 $x$ 需要 $\\operatorname{xor}$ 上次答案 ，如果之前没有询问或者输出了 `EE`，则上次答案为 $0$。", "inputFormat": "第一行两个整数 $n, C$。\n\n接下来 $n$ 行，每行有两个整数 $1~x$ 或 $2~x$，表示第一类或第二类操作。", "outputFormat": "输出 $n$ 行，第 $i$ 行表示第 $i$ 次操作结束后的答案。", "hint": "Idea：zhouwc，Solution：ccz181078&nzhtl1477，Code：ccz181078&nzhtl1477，Data：nzhtl1477\n\n注意：本题采用**捆绑测试**，只有当你通过一个 subtask 中的所有测试点后，你才能拿到这个 subtask 的分数。\n\n对于其中 $1\\%$ 的数据，为样例 1。\n\n对于另外 $9\\%$ 的数据，集合中元素个数 $\\le 1$。\n\n对于另外 $19\\%$ 的数据，$n\\leq 500$。\n\n对于另外 $19\\%$ 的数据，$n\\leq 10^4$。\n\n对于另外 $19\\%$ 的数据，$1\\leq n,C \\leq 10^5$。\n\n对于 $100\\%$ 的数据，$1\\leq n \\leq 5\\times 10^5$，$1\\leq C\\leq 1073741823$，$0\\leq x\\leq 1073741823$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2010] y-fast trie", "background": "谔谔我\n\n本题读入量约 6 MB，输出量约 5 MB，请选择适合的输入输出方法", "description": "给定一个常数 $C$，你需要维护一个集合 $S$，支持 $n$ 次操作：\n\n- 操作1：给出 $x$，插入一个元素 $x$，保证之前集合中没有 $x$ 这个元素\n- 操作2：给出 $x$，删除一个元素 $x$，保证之前集合中存在 $x$ 这个元素\n\n每次操作结束后，需要输出 $\\max\\limits_{\\substack{ i, j \\in S \\\\ i \\ne j }} \\bigl( (i+j) \\bmod C \\bigr)$，即从 $S$ 集合中选出两个不同的元素，其的和 $\\bmod~C$ 的最大值，如果 $S$ 集合中不足两个元素，则输出 `EE`。\n\n本题强制在线，每次的 $x$ 需要 $\\operatorname{xor}$ 上次答案 ，如果之前没有询问或者输出了 `EE`，则上次答案为 $0$。", "inputFormat": "第一行两个整数 $n, C$。\n\n接下来 $n$ 行，每行有两个整数 $1~x$ 或 $2~x$，表示第一类或第二类操作。", "outputFormat": "输出 $n$ 行，第 $i$ 行表示第 $i$ 次操作结束后的答案。", "hint": "Idea：zhouwc，Solution：ccz181078&nzhtl1477，Code：ccz181078&nzhtl1477，Data：nzhtl1477\n\n注意：本题采用**捆绑测试**，只有当你通过一个 subtask 中的所有测试点后，你才能拿到这个 subtask 的分数。\n\n对于其中 $1\\%$ 的数据，为样例 1。\n\n对于另外 $9\\%$ 的数据，集合中元素个数 $\\le 1$。\n\n对于另外 $19\\%$ 的数据，$n\\leq 500$。\n\n对于另外 $19\\%$ 的数据，$n\\leq 10^4$。\n\n对于另外 $19\\%$ 的数据，$1\\leq n,C \\leq 10^5$。\n\n对于 $100\\%$ 的数据，$1\\leq n \\leq 5\\times 10^5$，$1\\leq C\\leq 1073741823$，$0\\leq x\\leq 1073741823$。", "locale": "zh-CN"}}}
{"pid": "P6106", "type": "P", "difficulty": 7, "samples": [["2\n1 1 4 4\n2 1 4 3\n4\n1 1 6 6\n1 1 3 3\n2 1 3 3\n1 2 2 4", "1\n0.6\n0.4\n0"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2010", "平衡树", "Special Judge", "O2优化", "扫描线", "Ynoi"], "title": "[Ynoi2010] Self Adjusting Top Tree", "background": "", "description": "平面上有 $n$ 条线段。\n\n共 $m$ 次询问，每次询问给出一个边平行于坐标轴的矩形，问 每条与矩形有交的线段与矩形的交的长度之和 与 所有线段的长度之和 的 比值，要求输出与标准答案的相对误差或绝对误差不超过 $10^{-6}$。\n\n线段以 $x_1\\;y_1\\;x_2\\;y_2$ 的形式给出，表示以 $(x_1,y_1),(x_2,y_2)$ 为端点的线段，保证任意两条线段没有交点或重合部分，且 $x_1\\ne x_2,y_1\\ne y_2$。\n\n矩形以 $x_1\\;y_1\\;x_2\\;y_2$ 的形式给出，表示矩形 $\\{(x,y)|x_1\\le x\\le x_2,y_1\\le y\\le y_2\\}$，保证 $x_1< x_2, y_1< y_2$。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行四个由空格分隔的整数 $x1,y1,x2,y2$，表示线段。\n\n接下来一行一个整数 $m$。\n\n接下来 $m$ 行，每行四个由空格分隔的整数 $x1,y1,x2,y2$，表示询问的矩形。", "outputFormat": "对每个询问，输出一行，一个介于 $0$ 和 $1$ 之间的十进制小数，表示答案", "hint": "Idea：nzhtl1477&ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 10^5, 1\\le x_1,y_1,x_2,y_2\\le 10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2010] Self Adjusting Top Tree", "background": "", "description": "平面上有 $n$ 条线段。\n\n共 $m$ 次询问，每次询问给出一个边平行于坐标轴的矩形，问 每条与矩形有交的线段与矩形的交的长度之和 与 所有线段的长度之和 的 比值，要求输出与标准答案的相对误差或绝对误差不超过 $10^{-6}$。\n\n线段以 $x_1\\;y_1\\;x_2\\;y_2$ 的形式给出，表示以 $(x_1,y_1),(x_2,y_2)$ 为端点的线段，保证任意两条线段没有交点或重合部分，且 $x_1\\ne x_2,y_1\\ne y_2$。\n\n矩形以 $x_1\\;y_1\\;x_2\\;y_2$ 的形式给出，表示矩形 $\\{(x,y)|x_1\\le x\\le x_2,y_1\\le y\\le y_2\\}$，保证 $x_1< x_2, y_1< y_2$。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行四个由空格分隔的整数 $x1,y1,x2,y2$，表示线段。\n\n接下来一行一个整数 $m$。\n\n接下来 $m$ 行，每行四个由空格分隔的整数 $x1,y1,x2,y2$，表示询问的矩形。", "outputFormat": "对每个询问，输出一行，一个介于 $0$ 和 $1$ 之间的十进制小数，表示答案", "hint": "Idea：nzhtl1477&ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 10^5, 1\\le x_1,y_1,x_2,y_2\\le 10^6$。", "locale": "zh-CN"}}}
{"pid": "P6107", "type": "P", "difficulty": 7, "samples": [["6\n1 2 5 4 3 6\n4\n1 8\n3 6\n5 10\n2 7", "3\n0\n1\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2010", "O2优化", "Ynoi"], "title": "[Ynoi2010] Worst Case Top Tree", "background": "", "description": "给定序列 $a_0,a_1,a_2\\dots,a_n,a_{n+1}$；\n\n满足 $a_0=a_{n+1}=+\\infty$，$a_1,a_2,\\dots,a_n$ 在输入中给出；\n\n对 $1\\le x \\le n$，称 $\\max_{0\\le i<x,a_i\\ge a_x} i$ 和 $x$ 是**相邻**的，且 $\\min_{x<i\\le n+1,a_i>a_x} i$ 和 $x$ 是**相邻**的；\n\n如果 $x$ 和 $y$ 相邻，则 $y$ 和 $x$ 也相邻；\n\n如果 $0\\le b_1,b_2,b_3,b_4,b_5,b_6\\le n+1$，且 $b_i$ 和 $b_{i+1}$ 相邻，$b_1$ 和 $b_6$ 相邻，$b_i$ 互不相同，则称集合 $\\{b_1,b_2,b_3,b_4,b_5,b_6\\}$ 是一个六元环（即判断两个六元环是否相同时，不考虑 $b_i$ 的顺序）。\n\n共有 $m$ 次修改操作，每次修改操作给出 $x\\;y$，将 $a_x$ 改为 $a_x+y$；\n\n每次修改后要求输出六元环的个数；", "inputFormat": "第一行一个整数 $n$；\n\n第二行 $n$ 个整数表示 $a_1\\;a_2\\;\\dots\\;a_n$；\n\n第三行一个整数 $m$；\n\n接下来 $m$ 行，每行两个整数 $x\\;y$ 表示一次修改操作。", "outputFormat": "共 $m$ 行，每行一个整数，表示每次修改后的六元环个数。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078&zx2003，Data：nzhtl1477&zx2003\n\n对于 $100\\%$ 的数据，以上提到的所有数值为整数，且 $1\\le n,m\\le 5\\cdot 10^5;\\;1\\le x\\le n;\\;1\\le a_i,y\\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2010] Worst Case Top Tree", "background": "", "description": "给定序列 $a_0,a_1,a_2\\dots,a_n,a_{n+1}$；\n\n满足 $a_0=a_{n+1}=+\\infty$，$a_1,a_2,\\dots,a_n$ 在输入中给出；\n\n对 $1\\le x \\le n$，称 $\\max_{0\\le i<x,a_i\\ge a_x} i$ 和 $x$ 是**相邻**的，且 $\\min_{x<i\\le n+1,a_i>a_x} i$ 和 $x$ 是**相邻**的；\n\n如果 $x$ 和 $y$ 相邻，则 $y$ 和 $x$ 也相邻；\n\n如果 $0\\le b_1,b_2,b_3,b_4,b_5,b_6\\le n+1$，且 $b_i$ 和 $b_{i+1}$ 相邻，$b_1$ 和 $b_6$ 相邻，$b_i$ 互不相同，则称集合 $\\{b_1,b_2,b_3,b_4,b_5,b_6\\}$ 是一个六元环（即判断两个六元环是否相同时，不考虑 $b_i$ 的顺序）。\n\n共有 $m$ 次修改操作，每次修改操作给出 $x\\;y$，将 $a_x$ 改为 $a_x+y$；\n\n每次修改后要求输出六元环的个数；", "inputFormat": "第一行一个整数 $n$；\n\n第二行 $n$ 个整数表示 $a_1\\;a_2\\;\\dots\\;a_n$；\n\n第三行一个整数 $m$；\n\n接下来 $m$ 行，每行两个整数 $x\\;y$ 表示一次修改操作。", "outputFormat": "共 $m$ 行，每行一个整数，表示每次修改后的六元环个数。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078&zx2003，Data：nzhtl1477&zx2003\n\n对于 $100\\%$ 的数据，以上提到的所有数值为整数，且 $1\\le n,m\\le 5\\cdot 10^5;\\;1\\le x\\le n;\\;1\\le a_i,y\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P6108", "type": "P", "difficulty": 6, "samples": [["4 4\n1 2 4 1\n2 1 3\n1 1 2 2\n2 1 4", "388206138\n339680376"], ["10 20\n1 4 4 520968631\n1 4 7 988452236\n1 4 9 355405133\n2 9 10\n2 2 8\n1 3 5 400339337\n2 3 8\n2 6 7\n2 4 10\n2 7 9\n1 3 8 387471594\n1 2 4 559944503\n2 1 8\n1 4 7 108832063\n2 5 9\n2 4 8\n1 3 8 622785003\n2 9 10\n1 2 7 252591713\n1 5 6 666406180", "570099967\n274921471\n285269733\n0\n571283655\n970723747\n401326984\n17519114\n844628984\n570099967"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2009", "O2优化", "Ynoi"], "title": "[Ynoi2009] rprsvq", "background": "", "description": "你有一个长度为 $n$ 的序列 $v_1, v_2, \\dots, v_n$，初值全都为 $0$。\n\n你要进行 $m$ 次操作：\n\n- 操作 1：给出 $l,r,a$，将 $v_l,v_{l+1},\\dots ,v_r$ 的值加上 $a$。\n- 操作 2：给出 $l,r$，求在$v_l,v_{l+1}, \\dots ,v_r$ 中选出一个非空的子序列，求所有方案中选出的子序列的方差之和，答案对 $998244353$ 取模。\n\n一个序列 $a_1,a_2, \\dots, a_n$ 的方差定义为令 $\\bar{a}=\\frac{1}{n}\\sum_{i=1}^n a_i$，则方差为 $\\frac{1}{n}\\sum_{i=1}^n (a_i-\\bar{a})^2$。", "inputFormat": "第一行两个整数 $n, m$。\n\n接下来 $m$ 行，每行有四个整数 $1~l~r~a$ 或三个整数 $2~l~r$，表示第一类或第二类操作，保证 $0\\leq a< 998244353$。\n", "outputFormat": "对每个第二类操作，输出一行表示答案。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n对于 $10\\%$ 的数据，$n\\leq 10, m\\leq 1000$。\n\n对于 $20\\%$ 的数据，$n\\leq 16, m\\leq 1000$。\n\n对于 $30\\%$ 的数据，$n\\leq 100, m\\leq 10^3$。\n\n对于 $50\\%$ 的数据，$n, m\\leq 10^3$。\n\n对于另外$10\\%$的数据，$n\\leq 10^5$，保证首先是第一类操作，然后是第二类操作。\n\n对于 $80\\%$ 的数据，$n, m\\leq 10^5$。\n\n对于 $100\\%$ 的数据，$1\\leq n \\leq 5\\times 10^6,1\\leq m\\leq 10^5$。\n\n对于第一个测试数据的第一个询问，序列是 $\\{0,1,1\\}$，所有的子序列中只有 $\\{0,1\\}, \\{0,1\\}$ 和 $\\{0,1,1\\}$ 方差不为 $0$，分别是 $\\frac{1}{4}, \\frac{1}{4}, \\frac{2}{9}$，总和为 $\\frac{13}{18}$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2009] rprsvq", "background": "", "description": "You have a sequence $v_1, v_2, \\dots, v_n$ of length $n$, with all initial values equal to $0$.\n\nYou need to perform $m$ operations:\n\n- Operation 1: Given $l, r, a$, add $a$ to $v_l, v_{l+1}, \\dots, v_r$.\n- Operation 2: Given $l, r$, choose a non-empty subsequence from $v_l, v_{l+1}, \\dots, v_r$. For all possible choices, compute the sum of variances of the chosen subsequences. Output the answer modulo $998244353$.\n\nThe variance of a sequence $a_1, a_2, \\dots, a_n$ is defined as follows. Let $\\bar{a}=\\frac{1}{n}\\sum_{i=1}^n a_i$, then the variance is $\\frac{1}{n}\\sum_{i=1}^n (a_i-\\bar{a})^2$.", "inputFormat": "The first line contains two integers $n, m$.\n\nThe next $m$ lines describe the operations. Each line contains either four integers $1~l~r~a$ or three integers $2~l~r$, representing an operation of the first type or the second type. It is guaranteed that $0\\leq a< 998244353$.", "outputFormat": "For each operation of the second type, output one line containing the answer.", "hint": "Idea: ccz181078, Solution: ccz181078, Code: ccz181078, Data: ccz181078.\n\nConstraints:\n\nFor $10\\%$ of the testdata, $n\\leq 10, m\\leq 1000$.\n\nFor $20\\%$ of the testdata, $n\\leq 16, m\\leq 1000$.\n\nFor $30\\%$ of the testdata, $n\\leq 100, m\\leq 10^3$.\n\nFor $50\\%$ of the testdata, $n, m\\leq 10^3$.\n\nFor another $10\\%$ of the testdata, $n\\leq 10^5$, and it is guaranteed that all operations of the first type come first, followed by operations of the second type.\n\nFor $80\\%$ of the testdata, $n, m\\leq 10^5$.\n\nFor $100\\%$ of the testdata, $1\\leq n \\leq 5\\times 10^6, 1\\leq m\\leq 10^5$.\n\nFor the first query in the first testdata, the sequence is $\\{0,1,1\\}$. Among all subsequences, only $\\{0,1\\}$, $\\{0,1\\}$, and $\\{0,1,1\\}$ have non-zero variance, which are $\\frac{1}{4}, \\frac{1}{4}, \\frac{2}{9}$ respectively. Their total sum is $\\frac{13}{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2009] rprsvq", "background": "", "description": "你有一个长度为 $n$ 的序列 $v_1, v_2, \\dots, v_n$，初值全都为 $0$。\n\n你要进行 $m$ 次操作：\n\n- 操作 1：给出 $l,r,a$，将 $v_l,v_{l+1},\\dots ,v_r$ 的值加上 $a$。\n- 操作 2：给出 $l,r$，求在$v_l,v_{l+1}, \\dots ,v_r$ 中选出一个非空的子序列，求所有方案中选出的子序列的方差之和，答案对 $998244353$ 取模。\n\n一个序列 $a_1,a_2, \\dots, a_n$ 的方差定义为令 $\\bar{a}=\\frac{1}{n}\\sum_{i=1}^n a_i$，则方差为 $\\frac{1}{n}\\sum_{i=1}^n (a_i-\\bar{a})^2$。", "inputFormat": "第一行两个整数 $n, m$。\n\n接下来 $m$ 行，每行有四个整数 $1~l~r~a$ 或三个整数 $2~l~r$，表示第一类或第二类操作，保证 $0\\leq a< 998244353$。\n", "outputFormat": "对每个第二类操作，输出一行表示答案。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n对于 $10\\%$ 的数据，$n\\leq 10, m\\leq 1000$。\n\n对于 $20\\%$ 的数据，$n\\leq 16, m\\leq 1000$。\n\n对于 $30\\%$ 的数据，$n\\leq 100, m\\leq 10^3$。\n\n对于 $50\\%$ 的数据，$n, m\\leq 10^3$。\n\n对于另外$10\\%$的数据，$n\\leq 10^5$，保证首先是第一类操作，然后是第二类操作。\n\n对于 $80\\%$ 的数据，$n, m\\leq 10^5$。\n\n对于 $100\\%$ 的数据，$1\\leq n \\leq 5\\times 10^6,1\\leq m\\leq 10^5$。\n\n对于第一个测试数据的第一个询问，序列是 $\\{0,1,1\\}$，所有的子序列中只有 $\\{0,1\\}, \\{0,1\\}$ 和 $\\{0,1,1\\}$ 方差不为 $0$，分别是 $\\frac{1}{4}, \\frac{1}{4}, \\frac{2}{9}$，总和为 $\\frac{13}{18}$。\n", "locale": "zh-CN"}}}
{"pid": "P6109", "type": "P", "difficulty": 7, "samples": [["5 5 5\n1 1 4 5 4\n4 1 4 1 10\n1 3 3 3 3\n1 1 5 5 8\n2 4 4 5 8\n2 1 2 1\n4 1 5 4\n1 2 3 5\n2 1 5 3\n1 3 5 5\n", "12\n22\n20\n22\n20\n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2009", "O2优化", "洛谷月赛", "Ynoi"], "title": "[Ynoi2009] rprmq1", "background": "我谔谔\n\n本题读入量约 13 MB，输出量约 7 MB，请选择合适的输入输出方法", "description": "有一个 $n \\times n$ 的矩阵 $a$，初始全是 $0$，有 $m$ 次修改操作和 $q$ 次查询操作，先进行所有修改操作，然后进行所有查询操作。\n\n一次修改操作会给出 $l_1,l_2,r_1,r_2,x$，代表把所有满足 $l_1 \\le i \\le r_1$ 且 $l_2 \\le j \\le r_2$ 的 $a_{i,j}$ 元素加上一个值 $x$。\n\n一次查询操作会给出 $l_1,l_2,r_1,r_2$，代表查询所有满足 $l_1 \\le i \\le r_1$ 且 $l_2 \\le j \\le r_2$ 的 $a_{i,j}$ 元素的最大值。", "inputFormat": "第一行三个由空格分隔的整数 $n,m,q$。\n\n之后 $m$ 行，每行给出五个整数 $l_1,l_2,r_1,r_2,x$，表示一次修改操作。\n\n之后 $q$ 行，每行给出四个整数 $l_1,l_2,r_1,r_2$，表示一次查询操作。", "outputFormat": "输出 $q$ 行，对每次查询操作输出一行一个数表示答案。", "hint": "Idea：apiadu，Solution：ccz181078，Code：apiadu，Data：apiadu&nzhtl1477\n\n注意：本题采用**捆绑测试**，只有当你通过一个 subtask 中的所有测试点后，你才能拿到这个 subtask 的分数。\n\n对于其中 $1\\%$ 的数据，为样例 1。\n\n对于另外 $9\\%$ 的数据，$n=1$。\n\n对于另外 $19\\%$ 的数据，$n,m\\leq 500$。\n\n对于另外 $19\\%$ 的数据，$n\\leq 2000$，$q\\leq 2\\times 10^5$。\n\n对于另外 $19\\%$ 的数据，$m,q\\leq 2000$。\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 5\\times 10^4$，$1\\leq q \\leq 5\\times 10^5$，$1\\leq x\\leq 2147483647$，$1\\leq l_1\\leq r_1\\leq n$，$1\\leq l_2\\leq r_2\\leq n$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2009] rprmq1", "background": "我谔谔\n\n本题读入量约 13 MB，输出量约 7 MB，请选择合适的输入输出方法", "description": "有一个 $n \\times n$ 的矩阵 $a$，初始全是 $0$，有 $m$ 次修改操作和 $q$ 次查询操作，先进行所有修改操作，然后进行所有查询操作。\n\n一次修改操作会给出 $l_1,l_2,r_1,r_2,x$，代表把所有满足 $l_1 \\le i \\le r_1$ 且 $l_2 \\le j \\le r_2$ 的 $a_{i,j}$ 元素加上一个值 $x$。\n\n一次查询操作会给出 $l_1,l_2,r_1,r_2$，代表查询所有满足 $l_1 \\le i \\le r_1$ 且 $l_2 \\le j \\le r_2$ 的 $a_{i,j}$ 元素的最大值。", "inputFormat": "第一行三个由空格分隔的整数 $n,m,q$。\n\n之后 $m$ 行，每行给出五个整数 $l_1,l_2,r_1,r_2,x$，表示一次修改操作。\n\n之后 $q$ 行，每行给出四个整数 $l_1,l_2,r_1,r_2$，表示一次查询操作。", "outputFormat": "输出 $q$ 行，对每次查询操作输出一行一个数表示答案。", "hint": "Idea：apiadu，Solution：ccz181078，Code：apiadu，Data：apiadu&nzhtl1477\n\n注意：本题采用**捆绑测试**，只有当你通过一个 subtask 中的所有测试点后，你才能拿到这个 subtask 的分数。\n\n对于其中 $1\\%$ 的数据，为样例 1。\n\n对于另外 $9\\%$ 的数据，$n=1$。\n\n对于另外 $19\\%$ 的数据，$n,m\\leq 500$。\n\n对于另外 $19\\%$ 的数据，$n\\leq 2000$，$q\\leq 2\\times 10^5$。\n\n对于另外 $19\\%$ 的数据，$m,q\\leq 2000$。\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 5\\times 10^4$，$1\\leq q \\leq 5\\times 10^5$，$1\\leq x\\leq 2147483647$，$1\\leq l_1\\leq r_1\\leq n$，$1\\leq l_2\\leq r_2\\leq n$。\n", "locale": "zh-CN"}}}
{"pid": "P6111", "type": "P", "difficulty": 3, "samples": [["4 3\n1 2 3\n2 3 2\n2 4 4\n1 2\n4 1\n3 1", "3\n0\n2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["搜索", "2018", "USACO", "并查集", "深度优先搜索 DFS"], "title": "[USACO18JAN] MooTube S", "background": "*本题与 [金组同名题目](/problem/P4185) 在题意上一致，唯一的差别是数据范围。*", "description": "在业余时间，Farmer John 创建了一个新的视频共享服务，他将其命名为 MooTube。在 MooTube 上，Farmer John 的奶牛可以录制，分享和发现许多有趣的视频。他的奶牛已经发布了 $N$ 个视频（$1 \\leq N \\leq 5000$），为了方便将其编号为  $1 \\ldots N$ 。然而，FJ 无法弄清楚如何帮助他的奶牛找到他们可能喜欢的新视频。\n\nFJ 希望为每个 MooTube 视频创建一个“推荐视频”列表。这样，奶牛将被推荐与他们已经观看过的视频最相关的视频。\n\nFJ 设计了一个“相关性”度量标准，顾名思义，它确定了两个视频相互之间的相关性。他选择 $N-1$ 对视频并手动计算其之间的相关性。然后，FJ 将他的视频建成一棵树，其中每个视频是节点，并且他手动将 $N-1$ 对视频连接。为了方便，FJ 选择了 $N-1$ 对，这样任意视频都可以通过一条连通路径到达任意其他视频。 FJ 决定将任意一对视频的相关性定义为沿此路径的任何连接的最小相关性。\n\nFarmer John 想要选择一个 $K$ 值，以便在任何给定的 MooTube 视频旁边，推荐所有其他与该视频至少有 $K$ 相关的视频。然而，FJ 担心会向他的奶牛推荐太多的视频，这可能会分散他们对产奶的注意力！因此，他想设定适当的 $K$ 值。 Farmer John希望得到您的帮助，回答有关 $K$ 值的推荐视频的一些问题。", "inputFormat": "第一行输入包含 $N$ 和 $Q$（$1 \\leq Q \\leq 5000$）。\n\n接下来的 $N-1$ 行描述了 FJ 手动比较的一对视频。 每行包括三个整数  $p_i$，$q_i$ 和 $r_i$（$1 \\leq p_i, q_i \\leq N$，$1 \\leq r_i \\leq 10^9$），表示视频 $p_i$ 和 $q_i$ 已连接并且相关性为 $r_i$。\n\n接下来的 $Q$ 行描述了 Farmer John 的 $Q$ 个问题。每行包含两个整数，$k_i$ 和 $v_i$（$1 \\leq k_i \\leq 10^9$，$1 \\leq v_i \\leq N$），表示 FJ 的第 $i$ 个问题询问中当 $K = k_i$ 时，第 $v_i$ 个视频推荐列表中将推荐的视频数。", "outputFormat": "输出 $Q$ 行。在第 $i$ 行，输出 FJ 的第 $i$ 个问题的答案。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO18JAN] MooTube S", "background": "*本题与 [金组同名题目](/problem/P4185) 在题意上一致，唯一的差别是数据范围。*", "description": "在业余时间，Farmer John 创建了一个新的视频共享服务，他将其命名为 MooTube。在 MooTube 上，Farmer John 的奶牛可以录制，分享和发现许多有趣的视频。他的奶牛已经发布了 $N$ 个视频（$1 \\leq N \\leq 5000$），为了方便将其编号为  $1 \\ldots N$ 。然而，FJ 无法弄清楚如何帮助他的奶牛找到他们可能喜欢的新视频。\n\nFJ 希望为每个 MooTube 视频创建一个“推荐视频”列表。这样，奶牛将被推荐与他们已经观看过的视频最相关的视频。\n\nFJ 设计了一个“相关性”度量标准，顾名思义，它确定了两个视频相互之间的相关性。他选择 $N-1$ 对视频并手动计算其之间的相关性。然后，FJ 将他的视频建成一棵树，其中每个视频是节点，并且他手动将 $N-1$ 对视频连接。为了方便，FJ 选择了 $N-1$ 对，这样任意视频都可以通过一条连通路径到达任意其他视频。 FJ 决定将任意一对视频的相关性定义为沿此路径的任何连接的最小相关性。\n\nFarmer John 想要选择一个 $K$ 值，以便在任何给定的 MooTube 视频旁边，推荐所有其他与该视频至少有 $K$ 相关的视频。然而，FJ 担心会向他的奶牛推荐太多的视频，这可能会分散他们对产奶的注意力！因此，他想设定适当的 $K$ 值。 Farmer John希望得到您的帮助，回答有关 $K$ 值的推荐视频的一些问题。", "inputFormat": "第一行输入包含 $N$ 和 $Q$（$1 \\leq Q \\leq 5000$）。\n\n接下来的 $N-1$ 行描述了 FJ 手动比较的一对视频。 每行包括三个整数  $p_i$，$q_i$ 和 $r_i$（$1 \\leq p_i, q_i \\leq N$，$1 \\leq r_i \\leq 10^9$），表示视频 $p_i$ 和 $q_i$ 已连接并且相关性为 $r_i$。\n\n接下来的 $Q$ 行描述了 Farmer John 的 $Q$ 个问题。每行包含两个整数，$k_i$ 和 $v_i$（$1 \\leq k_i \\leq 10^9$，$1 \\leq v_i \\leq N$），表示 FJ 的第 $i$ 个问题询问中当 $K = k_i$ 时，第 $v_i$ 个视频推荐列表中将推荐的视频数。", "outputFormat": "输出 $Q$ 行。在第 $i$ 行，输出 FJ 的第 $i$ 个问题的答案。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6112", "type": "P", "difficulty": 6, "samples": [["4", "9"], ["7", "140"], ["8923", "424180943"], ["114514", "552971057"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "数学", "递推", "O2优化", "生成函数"], "title": "直接自然溢出啥事没有 加强版", "background": "[原题链接](https://www.luogu.com.cn/problem/P6103)    \n本题与原题的区别，只有模数和数据范围不同。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/hu0gfpdv.png)", "description": "给定一个正整数 $n$，问有多少个长度为 $n$ 的字符串，满足这个字符串是一个「程序片段」。\n\n具体定义如下：\n\n单个分号 `;` 是一个「语句」。\n\n空串 是一个「程序片段」。\n\n如果字符串 `A` 是「程序片段」，字符串 `B` 是「语句」，则 `AB` 是「程序片段」。\n\n如果字符串 `A` 是「程序片段」，则 `{A}` 是「语句块」。\n\n如果字符串 `A` 是「语句块」，则 `A` 是「语句」，`[]A` 和 `[]()A` 都是「函数」。\n\n如果字符串 `A` 是「函数」，则 `(A)` 是「函数」，`A` 和 `A()` 都是「值」。\n\n如果字符串 `A` 是「值」，则 `(A)` 是「值」，`A;` 是「语句」。\n\n**注意：`A` 是 `B` 并不代表 `B` 是 `A`。**", "inputFormat": "输入一行一个正整数 $n$。", "outputFormat": "输出一行一个整数表示答案，作为良心出题人，你只需要对 $998244353$ 取模。", "hint": "【样例一解释】  \n合法的「程序片段」有：`;;;;`，`;;{}`，`;{;}`，`;{};`，`{;;}`，`{;};`，`{{}}`，`{};;`，`{}{}`。\n\n【数据范围】  \n对于 $30\\%$ 的数据，$1\\le n \\le 10^5$；   \n对于 $100\\%$ 的数据，$1\\le n \\le 10^7$。  ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "直接自然溢出啥事没有 加强版", "background": "[原题链接](https://www.luogu.com.cn/problem/P6103)    \n本题与原题的区别，只有模数和数据范围不同。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/hu0gfpdv.png)", "description": "给定一个正整数 $n$，问有多少个长度为 $n$ 的字符串，满足这个字符串是一个「程序片段」。\n\n具体定义如下：\n\n单个分号 `;` 是一个「语句」。\n\n空串 是一个「程序片段」。\n\n如果字符串 `A` 是「程序片段」，字符串 `B` 是「语句」，则 `AB` 是「程序片段」。\n\n如果字符串 `A` 是「程序片段」，则 `{A}` 是「语句块」。\n\n如果字符串 `A` 是「语句块」，则 `A` 是「语句」，`[]A` 和 `[]()A` 都是「函数」。\n\n如果字符串 `A` 是「函数」，则 `(A)` 是「函数」，`A` 和 `A()` 都是「值」。\n\n如果字符串 `A` 是「值」，则 `(A)` 是「值」，`A;` 是「语句」。\n\n**注意：`A` 是 `B` 并不代表 `B` 是 `A`。**", "inputFormat": "输入一行一个正整数 $n$。", "outputFormat": "输出一行一个整数表示答案，作为良心出题人，你只需要对 $998244353$ 取模。", "hint": "【样例一解释】  \n合法的「程序片段」有：`;;;;`，`;;{}`，`;{;}`，`;{};`，`{;;}`，`{;};`，`{{}}`，`{};;`，`{}{}`。\n\n【数据范围】  \n对于 $30\\%$ 的数据，$1\\le n \\le 10^5$；   \n对于 $100\\%$ 的数据，$1\\le n \\le 10^7$。  ", "locale": "zh-CN"}}}
{"pid": "P6113", "type": "P", "difficulty": 6, "samples": [["10 10\n4 3\n3 1\n4 7\n2 10\n2 9\n3 10\n5 9\n4 6\n1 10\n1 7\n", "4\n7 9 10 6 0 4 1 0 2 3 "]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["Special Judge", "一般图的最大匹配", "线性代数", "模板题"], "title": "【模板】一般图最大匹配", "background": "模板题，无背景。", "description": "给出一张 $n$ 个点 $m$ 条边的无向图，求该图的最大匹配。", "inputFormat": "第一行两个正整数 $n$ 和 $m$，分别表示图的点数和边数。\n\n接下来 $m$ 行，每行两个正整数 $u$ 和 $v$，表示图中存在一条连接 $u$ 和 $v$ 的无向边。", "outputFormat": "第一行一个整数，表示最大匹配数。\n\n第二行 $n$ 个整数，第 $i$ 个数表示与结点 $i$ 匹配的结点编号，若该结点无匹配则输出 $0$。\n\n如有多解输出任意解即可。", "hint": "对于 $50\\%$ 的数据，$n\\le500$。\n\n对于 $100\\%$ 的数据，$2\\le n\\le10^3$，$1\\le m\\le5\\times10^4$。\n\n本题有 5 组 extra test。\n\n####  提示\n为了方便你调试你的程序，出题人在[这里](https://www.luogu.com.cn/paste/vf7dlo6r)为你提供了一个~~写的很丑的~~数据生成器。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】一般图最大匹配", "background": "模板题，无背景。", "description": "给出一张 $n$ 个点 $m$ 条边的无向图，求该图的最大匹配。", "inputFormat": "第一行两个正整数 $n$ 和 $m$，分别表示图的点数和边数。\n\n接下来 $m$ 行，每行两个正整数 $u$ 和 $v$，表示图中存在一条连接 $u$ 和 $v$ 的无向边。", "outputFormat": "第一行一个整数，表示最大匹配数。\n\n第二行 $n$ 个整数，第 $i$ 个数表示与结点 $i$ 匹配的结点编号，若该结点无匹配则输出 $0$。\n\n如有多解输出任意解即可。", "hint": "对于 $50\\%$ 的数据，$n\\le500$。\n\n对于 $100\\%$ 的数据，$2\\le n\\le10^3$，$1\\le m\\le5\\times10^4$。\n\n本题有 5 组 extra test。\n\n####  提示\n为了方便你调试你的程序，出题人在[这里](https://www.luogu.com.cn/paste/vf7dlo6r)为你提供了一个~~写的很丑的~~数据生成器。", "locale": "zh-CN"}}}
{"pid": "P6114", "type": "P", "difficulty": 6, "samples": [["ababa\n", "3\n"], ["bbababaabaaabaaaab\n", "23\n"]], "limits": {"time": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["字符串", "Lyndon 分解", "模板题"], "title": "【模板】Lyndon 分解", "background": "", "description": "这是一道模板题。\n\n读入一个由小写英文字母组成的字符串 $s$ ，请把这个字符串分成若干部分 $s=s_1s_2s_3\\cdots s_m$，使得每个 $s_i$ 都是 [$\\text{Lyndon Word}$](https://en.wikipedia.org/wiki/Lyndon_word)，且 $\\forall 1\\le i<m:s_i\\ge s_{i+1}$。输出 $s_1$ 到 $s_m$ 这些串长度的右端点的位置。位置编号为 $1$ 到 $n$。\n\n一个字符串 $s$ 是一个 $\\text{Lyndon Word}$，当且仅当 $s$ 是其所有后缀中最小的字符串。\n\n为了减小输出量，你只需要输出所有右端点的异或和。", "inputFormat": "一行一个长度为 $n$ 的仅包含小写英文字母的字符串 $s$。", "outputFormat": "一行一个整数，表示所有右端点的异或和。", "hint": "第一组样例的答案为 `2 4 5`。\n\n第二组样例的答案为 `1 2 4 6 9 13 18`。\n\n- 对于 $20\\%$ 的数据，保证 $1\\le n\\le 1000$；\n- 对于 $100\\%$ 的数据，保证 $1\\le n\\le 5\\times 10^6+1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】Lyndon 分解", "background": "", "description": "这是一道模板题。\n\n读入一个由小写英文字母组成的字符串 $s$ ，请把这个字符串分成若干部分 $s=s_1s_2s_3\\cdots s_m$，使得每个 $s_i$ 都是 [$\\text{Lyndon Word}$](https://en.wikipedia.org/wiki/Lyndon_word)，且 $\\forall 1\\le i<m:s_i\\ge s_{i+1}$。输出 $s_1$ 到 $s_m$ 这些串长度的右端点的位置。位置编号为 $1$ 到 $n$。\n\n一个字符串 $s$ 是一个 $\\text{Lyndon Word}$，当且仅当 $s$ 是其所有后缀中最小的字符串。\n\n为了减小输出量，你只需要输出所有右端点的异或和。", "inputFormat": "一行一个长度为 $n$ 的仅包含小写英文字母的字符串 $s$。", "outputFormat": "一行一个整数，表示所有右端点的异或和。", "hint": "第一组样例的答案为 `2 4 5`。\n\n第二组样例的答案为 `1 2 4 6 9 13 18`。\n\n- 对于 $20\\%$ 的数据，保证 $1\\le n\\le 1000$；\n- 对于 $100\\%$ 的数据，保证 $1\\le n\\le 5\\times 10^6+1$。", "locale": "zh-CN"}}}
{"pid": "P6115", "type": "P", "difficulty": 7, "samples": [["5 2 1\n1 0\n998244352 0\n998244352 1\n998244352 1", "44"], ["233 2 3\n1 0\n998244352 0 0 0\n0 998244349 4 0\n0 8 998244337 8", "193416411"], ["114514 7 7\n1 9 8 2 6 4 7\n9 1 8 2 7 6 5 3\n2 8 4 6 2 9 4 5\n1 9 2 6 0 8 1 7\n1 9 1 9 8 1 0 7\n1 1 4 5 1 4 4 4\n4 4 4 4 4 4 4 4\n9 9 8 2 4 4 3 5\n1 9 8 6 0 6 0 4", "565704112"]], "limits": {"time": [7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "倍增", "O2优化", "矩阵加速", "矩阵乘法", "快速傅里叶变换 FFT", "模板题"], "title": "【模板】整式递推", "background": "话说上次菜菜的 NaCly\\_Fish 想教后辈做常系数线性齐次递推，奈何智商不够，见识短浅，被机房同学轮番吊打。\n\n之后她又听说了整式递推这种东西，便去请教中国队长 $\\mathsf E \\color{red}\\mathsf{ntropyIncreaser}$。然而 $\\mathsf E \\color{red}\\mathsf{ntropyIncreaser}$ 觉得这个东西太简单了，只回应了一句：“你不看候选队论文么？”\n\nNaCly\\_Fish 终于找来论文，但她完全看不懂。于是她只能找又强又热心的你来教她这个问题。", "description": "对于无限数列 $a$，已知 $\\forall n \\ge m$ 都满足\n$$\\sum_{k=0}^m a_{n-k} P_k(n) = 0$$\n其中 $P_k$ 为不超过 $d$ 次的多项式。  \n给定所有 $P_k$ 的系数，和 $\\{ a_i \\}_{i=0}^{m-1} $，求 $a_n$。\n\n由于答案可能很大，所以要对 $998244353$ 取模。", "inputFormat": "第一行三个正整数 $n,m,d$。  \n第二行 $m$ 个非负整数，表示 $\\{ a_i \\}_{i=0}^{m-1} $。  \n接下来 $m+1$ 行，每行 $d+1$ 个非负整数；第 $k+3$ 行由低到高地给出 $P_k$ 的系数。 ", "outputFormat": "输出一行一个整数，表示答案。", "hint": "【样例一解释】  \n这里的递推式就是 $a_n \\equiv (n-1)(a_{n-1}+a_{n-2}) \\pmod{998244353}$，容易计算得 $a_5 \\equiv 44 \\pmod{998244353}$。\n\n【数据范围】  \n对于 $30\\%$ 的数据，$1\\le n \\le 10^6$。  \n对于 $100\\%$ 的数据，$1\\le m,d \\le 7$，$1 \\le n \\le 6 \\times 10^8$。\n\n所有输入不超过 $6 \\times 10^8$。  \n$\\forall x \\in [m,n] \\cap \\mathbb Z \\text{ s.t. } P_0(x) \\not \\equiv 0 \\pmod{998244353}$。\n\n欢迎加入 $\\mathsf E \\color{red}\\mathsf{ntropyIncreaser}$ 粉丝群：747262201", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】整式递推", "background": "话说上次菜菜的 NaCly\\_Fish 想教后辈做常系数线性齐次递推，奈何智商不够，见识短浅，被机房同学轮番吊打。\n\n之后她又听说了整式递推这种东西，便去请教中国队长 $\\mathsf E \\color{red}\\mathsf{ntropyIncreaser}$。然而 $\\mathsf E \\color{red}\\mathsf{ntropyIncreaser}$ 觉得这个东西太简单了，只回应了一句：“你不看候选队论文么？”\n\nNaCly\\_Fish 终于找来论文，但她完全看不懂。于是她只能找又强又热心的你来教她这个问题。", "description": "对于无限数列 $a$，已知 $\\forall n \\ge m$ 都满足\n$$\\sum_{k=0}^m a_{n-k} P_k(n) = 0$$\n其中 $P_k$ 为不超过 $d$ 次的多项式。  \n给定所有 $P_k$ 的系数，和 $\\{ a_i \\}_{i=0}^{m-1} $，求 $a_n$。\n\n由于答案可能很大，所以要对 $998244353$ 取模。", "inputFormat": "第一行三个正整数 $n,m,d$。  \n第二行 $m$ 个非负整数，表示 $\\{ a_i \\}_{i=0}^{m-1} $。  \n接下来 $m+1$ 行，每行 $d+1$ 个非负整数；第 $k+3$ 行由低到高地给出 $P_k$ 的系数。 ", "outputFormat": "输出一行一个整数，表示答案。", "hint": "【样例一解释】  \n这里的递推式就是 $a_n \\equiv (n-1)(a_{n-1}+a_{n-2}) \\pmod{998244353}$，容易计算得 $a_5 \\equiv 44 \\pmod{998244353}$。\n\n【数据范围】  \n对于 $30\\%$ 的数据，$1\\le n \\le 10^6$。  \n对于 $100\\%$ 的数据，$1\\le m,d \\le 7$，$1 \\le n \\le 6 \\times 10^8$。\n\n所有输入不超过 $6 \\times 10^8$。  \n$\\forall x \\in [m,n] \\cap \\mathbb Z \\text{ s.t. } P_0(x) \\not \\equiv 0 \\pmod{998244353}$。\n\n欢迎加入 $\\mathsf E \\color{red}\\mathsf{ntropyIncreaser}$ 粉丝群：747262201", "locale": "zh-CN"}}}
