{"pid": "P6055", "type": "P", "difficulty": 6, "samples": [["50\n", "104527\n"], ["200\n", "6664993\n"], ["500000\n", "835964450\n"], ["10000000\n", "503290049"], ["100000000", "712748411\n"], ["1000000000", "845640070\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "杜教筛"], "title": "[RC-02] GCD", "background": "小 A：数论题真是无聊呢，一天到晚枚举二元组、三元组，太无聊了。\n\n小 B：对呀对呀，都是套路。\n\n小 A：要不我们试试枚举四元组？\n\n小 B：......\n\n于是就有了这道题。\n", "description": "给出 $N$，求：\n\n$$\n\\sum_{i=1}^N\\sum_{j=1}^N\\sum_{p=1}^{\\lfloor\\frac{N}{j}\\rfloor}\\sum_{q=1}^{\\lfloor\\frac{N}{j}\\rfloor}[\\gcd(i,j)=1][\\gcd(p,q)=1]\n$$\n\n答案模 $998244353$。\n\n$[]$ 是条件表达式。当括号里面的式子成立时值为 $1$，否则为 $0$。", "inputFormat": "仅一行一个整数，为 $N$。", "outputFormat": "输出一个整数，为所求答案模上 $998244353$ 的值。", "hint": "对于所有数据，保证 $1\\le N\\le 2\\times10^9$，所有测试点的时限均为 $1\\text{s}$，空间限制均为 $500\\text{MB}$。\n\n| 测试点编号 | $N$               |\n| ---------- | ----------------- |\n| $1$          | $\\le 100$         |\n| $2$          | $\\le 400$         |\n| $3,4,5,6$ | $\\le10^6$ |\n| $7,8$       | $\\le 2\\times10^7$ |\n| $9$          | $\\le 2\\times10^8$ |\n| $10$         | $\\le 2\\times10^9$ |\n\n这题其实可以搞一个测试点多组数据，但良心的出题人为了多给你们一点部分分，就决定只来一组数据。\n\nidea 源自 @Fee_cle6418，题目的题面，标算，数据源自 @FangZeLi。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[RC-02] GCD", "background": "小 A：数论题真是无聊呢，一天到晚枚举二元组、三元组，太无聊了。\n\n小 B：对呀对呀，都是套路。\n\n小 A：要不我们试试枚举四元组？\n\n小 B：......\n\n于是就有了这道题。\n", "description": "给出 $N$，求：\n\n$$\n\\sum_{i=1}^N\\sum_{j=1}^N\\sum_{p=1}^{\\lfloor\\frac{N}{j}\\rfloor}\\sum_{q=1}^{\\lfloor\\frac{N}{j}\\rfloor}[\\gcd(i,j)=1][\\gcd(p,q)=1]\n$$\n\n答案模 $998244353$。\n\n$[]$ 是条件表达式。当括号里面的式子成立时值为 $1$，否则为 $0$。", "inputFormat": "仅一行一个整数，为 $N$。", "outputFormat": "输出一个整数，为所求答案模上 $998244353$ 的值。", "hint": "对于所有数据，保证 $1\\le N\\le 2\\times10^9$，所有测试点的时限均为 $1\\text{s}$，空间限制均为 $500\\text{MB}$。\n\n| 测试点编号 | $N$               |\n| ---------- | ----------------- |\n| $1$          | $\\le 100$         |\n| $2$          | $\\le 400$         |\n| $3,4,5,6$ | $\\le10^6$ |\n| $7,8$       | $\\le 2\\times10^7$ |\n| $9$          | $\\le 2\\times10^8$ |\n| $10$         | $\\le 2\\times10^9$ |\n\n这题其实可以搞一个测试点多组数据，但良心的出题人为了多给你们一点部分分，就决定只来一组数据。\n\nidea 源自 @Fee_cle6418，题目的题面，标算，数据源自 @FangZeLi。", "locale": "zh-CN"}}}
{"pid": "P6056", "type": "P", "difficulty": 1, "samples": [["980 20 2\n0.0005 0.00001", "955 43 2"], ["1400000000 1 10\n0.000000003 0.001", "1386791252 13205592 3157"], ["1919 810 1\n0.00001 0.1", "1903 745 81"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["洛谷月赛"], "title": "[加油武汉] SIR 模型", "background": "SIR 模型将总人口分为以下三类：\n\n- 易感者（susceptibles），其数量记为 $s(t)$，表示 $t$ 时刻未染病但有可能被该类疾病传染的人数；\n- 染病者（infectives），其数量记为 $i(t)$，表示 $t$ 时刻已被感染成为病人而且具有传染力的人数；\n- 恢复者（recovered），其数量记为 $r(t)$，表示 $t$ 时刻已从染病者中移出的人数。\n\n设总人口为 $N(t)$，则有 $N(t)=s(t)+i(t)+r(t)$。  \n\nSIR 模型的建立基于以下三个假设：  \n\n1. 不考虑人口的出生、死亡、流动等种群动力因素。人口始终保持一个常数，即 $N(t) \\equiv K$。  \n2. 一个病人一旦与易感者接触就必然具有一定的传染力。假设 $t$ 时刻单位时间内，一个病人能传染的易感者数目与此环境内易感者总数 $s(t)$ 成正比，比例系数为 $\\beta$，从而在 $t$ 时刻单位时间内被所有病人传染的人数为 $\\beta s(t)i(t)$。  \n3. $t$ 时刻，单位时间内从染病者中移出的人数与病人数量成正比，比例系数为 $\\gamma$，单位时间内移出者的数量为 $\\gamma i(t)$。", "description": "我们将这个模型简化一下，初始有感染者 $I$ 人和易感者 $S$ 人，对于每一天当前有 $I_i$ 个感染者、$S_i$ 个易感者、$R_i$ 个恢复者，则每天会有 $\\lceil \\beta S_iI_i \\rceil$ 人被感染（由易感者变成感染者），有 $\\lceil \\gamma I_i \\rceil$ 人被治愈（由感染者变成恢复者） 。\n\n其中 $\\beta$ 为感染系数，$\\gamma$ 为恢复系数，$\\lceil \\rceil$ 为向上取整符号。 \n\n求 $n$ 天后，有多少易感者 $S$，感染者 $I$，和恢复者 $R$ 。\n\n注：感染者和恢复者都是每天结算的，结算的结果只和当天开始的时候的值有关，即感染者当天恢复不影响他当天感染别人。\n\n若计算被感染人数超过易感者人数则全员被感染。", "inputFormat": "第一行三个正整数，分别表示第 $0$ 天易感者人数 $S_0$ 和感染者人数 $I_0$，以及天数 $n$（刚开始恢复者数 $R_0=0$）。\n\n第二行两个浮点数，分别表示感染系数 $\\beta$ 和恢复系数 $\\gamma$。", "outputFormat": "一行三个整数，分别表示 $n$ 天后的易感者人数 $S$ 、感染者人数 $I$ 和恢复者 $R$。", "hint": "对于 $30\\%$ 的数据，$n=1$。  \n对于另外 $30\\%$ 的数据，$S_0, R_0\\le 10^4$。  \n对于 $100\\%$ 的数据，$1 \\le S_0+R_0\\le 2\\times 10^9, 0 < \\beta, \\gamma < 1, 1 \\le n \\le 100$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[加油武汉] SIR 模型", "background": "SIR 模型将总人口分为以下三类：\n\n- 易感者（susceptibles），其数量记为 $s(t)$，表示 $t$ 时刻未染病但有可能被该类疾病传染的人数；\n- 染病者（infectives），其数量记为 $i(t)$，表示 $t$ 时刻已被感染成为病人而且具有传染力的人数；\n- 恢复者（recovered），其数量记为 $r(t)$，表示 $t$ 时刻已从染病者中移出的人数。\n\n设总人口为 $N(t)$，则有 $N(t)=s(t)+i(t)+r(t)$。  \n\nSIR 模型的建立基于以下三个假设：  \n\n1. 不考虑人口的出生、死亡、流动等种群动力因素。人口始终保持一个常数，即 $N(t) \\equiv K$。  \n2. 一个病人一旦与易感者接触就必然具有一定的传染力。假设 $t$ 时刻单位时间内，一个病人能传染的易感者数目与此环境内易感者总数 $s(t)$ 成正比，比例系数为 $\\beta$，从而在 $t$ 时刻单位时间内被所有病人传染的人数为 $\\beta s(t)i(t)$。  \n3. $t$ 时刻，单位时间内从染病者中移出的人数与病人数量成正比，比例系数为 $\\gamma$，单位时间内移出者的数量为 $\\gamma i(t)$。", "description": "我们将这个模型简化一下，初始有感染者 $I$ 人和易感者 $S$ 人，对于每一天当前有 $I_i$ 个感染者、$S_i$ 个易感者、$R_i$ 个恢复者，则每天会有 $\\lceil \\beta S_iI_i \\rceil$ 人被感染（由易感者变成感染者），有 $\\lceil \\gamma I_i \\rceil$ 人被治愈（由感染者变成恢复者） 。\n\n其中 $\\beta$ 为感染系数，$\\gamma$ 为恢复系数，$\\lceil \\rceil$ 为向上取整符号。 \n\n求 $n$ 天后，有多少易感者 $S$，感染者 $I$，和恢复者 $R$ 。\n\n注：感染者和恢复者都是每天结算的，结算的结果只和当天开始的时候的值有关，即感染者当天恢复不影响他当天感染别人。\n\n若计算被感染人数超过易感者人数则全员被感染。", "inputFormat": "第一行三个正整数，分别表示第 $0$ 天易感者人数 $S_0$ 和感染者人数 $I_0$，以及天数 $n$（刚开始恢复者数 $R_0=0$）。\n\n第二行两个浮点数，分别表示感染系数 $\\beta$ 和恢复系数 $\\gamma$。", "outputFormat": "一行三个整数，分别表示 $n$ 天后的易感者人数 $S$ 、感染者人数 $I$ 和恢复者 $R$。", "hint": "对于 $30\\%$ 的数据，$n=1$。  \n对于另外 $30\\%$ 的数据，$S_0, R_0\\le 10^4$。  \n对于 $100\\%$ 的数据，$1 \\le S_0+R_0\\le 2\\times 10^9, 0 < \\beta, \\gamma < 1, 1 \\le n \\le 100$。", "locale": "zh-CN"}}}
{"pid": "P6057", "type": "P", "difficulty": 4, "samples": [["5 3\n1 5\n2 5\n3 5", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["组合数学", "洛谷月赛"], "title": "[加油武汉] 七步洗手法", "background": "现在正处于疫情防控的关键时期，大家要经常洗手，防止接触感染。\n\n[正确的洗手方法](https://dxy.com/column/4473)", "description": "给定一张含有 $n$ 个点的无向完全图，其中 $m$ 条边是白边，其余是黑边。\n\n现在需要你求出同色的三元环（或者说，三角形）的个数。", "inputFormat": "第一行整数 $n,m$，意义如题。\n\n剩下的 $m$ 行每行两个整数 $u,v$，代表白边的两个端点。保证给出的白边没有重边和自环。", "outputFormat": "一行一个整数，为答案。", "hint": " - 对于 $20\\%$ 的数据，满足 $n \\leq 200$；\n - 对于 $50\\%$ 的数据，满足 $n \\leq 2000$；\n - 对于 $100\\%$ 的数据，满足 $1 \\leq n \\leq 10^5,1 \\leq m \\leq 3\\times 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[加油武汉] 七步洗手法", "background": "现在正处于疫情防控的关键时期，大家要经常洗手，防止接触感染。\n\n[正确的洗手方法](https://dxy.com/column/4473)", "description": "给定一张含有 $n$ 个点的无向完全图，其中 $m$ 条边是白边，其余是黑边。\n\n现在需要你求出同色的三元环（或者说，三角形）的个数。", "inputFormat": "第一行整数 $n,m$，意义如题。\n\n剩下的 $m$ 行每行两个整数 $u,v$，代表白边的两个端点。保证给出的白边没有重边和自环。", "outputFormat": "一行一个整数，为答案。", "hint": " - 对于 $20\\%$ 的数据，满足 $n \\leq 200$；\n - 对于 $50\\%$ 的数据，满足 $n \\leq 2000$；\n - 对于 $100\\%$ 的数据，满足 $1 \\leq n \\leq 10^5,1 \\leq m \\leq 3\\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P6058", "type": "P", "difficulty": 4, "samples": [["11 2\n1 2 2\n1 3 3\n2 4 1\n3 5 2\n4 6 2\n4 7 3\n5 8 1\n6 9 3\n6 10 25\n8 11 4\n", "66"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["二分", "最近公共祖先 LCA", "洛谷月赛"], "title": "[加油武汉] 体温调查", "background": "在疫情扩散后，疾控中心的医护人员对来自武汉的人员进行了家庭访问，对体温进行测量。医护人员从疾控中心出发，按照一定顺序对所有家庭进行访问，然后汇总数据。 \n\n家庭列表上记录着类似于`A街道B小区C号楼D户`一样的住址，按照字典顺序排列，因此每个区域中的家庭在列表中总是相邻的。医护人员在访问完某个区域（比如B1小区）的所有家庭后，需要将数据送至上一层（比如A街道）的管理机构中，然后继续访问（比如B2小区）中的家庭。\n\n也就是说，医护人员的移动路径类似一颗**树**，其中树根代表疾控中心，树叶代表家庭，而中间的结点代表一层一层的管理区域。结点的孩子代表下一层的区域（或者家庭），是有序的。从根到某个家庭的路径上所有的点正好组成了这个家庭的地址。 \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6zfh4ofj.png)\n\n如图，4家的地址分别为（按顺序）\n- A1-B1-C1-Z1\n- A1-B1-C1-Z2\n- A1-B1-Z3\n- A2-B2-C3-Z4\n\n箭头仅代表归属关系，所有路均可双向通行。\n\n本质上，题目给出的树就是住址构成的 **字典树**/**Trie树** 。", "description": "给出一颗树，根结点编号为$1$。有一名医护人员从根出发，沿着树边移动，去每个叶子采集信息，最后返回根。他的采集顺序是固定的，每当走到一个结点$u$，他会先走向编号最小的孩子，并访问完其中所有的家庭并回到$u$，然后再走向编号第二小的孩子，依此直到访问完$u$子树中所有的家庭返回上一层。可以发现访问叶子的顺序也正好是家庭住址列表上的顺序。\n\n沿着树边移动需要一定时间，为了节约时间，可以将家庭列表分成连续的$k$段，并让$k$个医护人员同时从根出发，每人访问一个区间中的家庭然后返回。请你计算出统计完所有家庭的体温所需要的最短时间。", "inputFormat": "第一行两个整数$n, k$，分别表示树中的结点数和医护人员数。\n\n接下来$n-1$行，每行三个整数$u, v, w$，表示一条从$u$到$v$，经过花费时间$w$的边。", "outputFormat": "一行一个整数，表示统计完所有家庭的最短时间。", "hint": "对 $30\\%$ 的数据，$1 \\le n \\le 20$\n\n对另外 $10 \\%$ 的数据，$k = 1$\n\n对另外 $20 \\%$ 的数据，$k = 2$\n\n对 $100\\%$ 的数据，$1 \\le n \\le 2*10^5, 1 \\le k \\le m, 1 \\le u, v \\le n, 0 \\le w \\le 10^9$，$m$为叶子数。\n\n### 样例说明\n图示见题目背景。\n\n第一个人的路径为RT->Z1->Z2->RT，耗时66。\n\n第二个人的路径为RT->Z3->Z4->RT，耗时32。\n\n让一个人访问Z2，另一个人访问Z1、Z3、Z4的方案是不合法的。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[加油武汉] 体温调查", "background": "在疫情扩散后，疾控中心的医护人员对来自武汉的人员进行了家庭访问，对体温进行测量。医护人员从疾控中心出发，按照一定顺序对所有家庭进行访问，然后汇总数据。 \n\n家庭列表上记录着类似于`A街道B小区C号楼D户`一样的住址，按照字典顺序排列，因此每个区域中的家庭在列表中总是相邻的。医护人员在访问完某个区域（比如B1小区）的所有家庭后，需要将数据送至上一层（比如A街道）的管理机构中，然后继续访问（比如B2小区）中的家庭。\n\n也就是说，医护人员的移动路径类似一颗**树**，其中树根代表疾控中心，树叶代表家庭，而中间的结点代表一层一层的管理区域。结点的孩子代表下一层的区域（或者家庭），是有序的。从根到某个家庭的路径上所有的点正好组成了这个家庭的地址。 \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6zfh4ofj.png)\n\n如图，4家的地址分别为（按顺序）\n- A1-B1-C1-Z1\n- A1-B1-C1-Z2\n- A1-B1-Z3\n- A2-B2-C3-Z4\n\n箭头仅代表归属关系，所有路均可双向通行。\n\n本质上，题目给出的树就是住址构成的 **字典树**/**Trie树** 。", "description": "给出一颗树，根结点编号为$1$。有一名医护人员从根出发，沿着树边移动，去每个叶子采集信息，最后返回根。他的采集顺序是固定的，每当走到一个结点$u$，他会先走向编号最小的孩子，并访问完其中所有的家庭并回到$u$，然后再走向编号第二小的孩子，依此直到访问完$u$子树中所有的家庭返回上一层。可以发现访问叶子的顺序也正好是家庭住址列表上的顺序。\n\n沿着树边移动需要一定时间，为了节约时间，可以将家庭列表分成连续的$k$段，并让$k$个医护人员同时从根出发，每人访问一个区间中的家庭然后返回。请你计算出统计完所有家庭的体温所需要的最短时间。", "inputFormat": "第一行两个整数$n, k$，分别表示树中的结点数和医护人员数。\n\n接下来$n-1$行，每行三个整数$u, v, w$，表示一条从$u$到$v$，经过花费时间$w$的边。", "outputFormat": "一行一个整数，表示统计完所有家庭的最短时间。", "hint": "对 $30\\%$ 的数据，$1 \\le n \\le 20$\n\n对另外 $10 \\%$ 的数据，$k = 1$\n\n对另外 $20 \\%$ 的数据，$k = 2$\n\n对 $100\\%$ 的数据，$1 \\le n \\le 2*10^5, 1 \\le k \\le m, 1 \\le u, v \\le n, 0 \\le w \\le 10^9$，$m$为叶子数。\n\n### 样例说明\n图示见题目背景。\n\n第一个人的路径为RT->Z1->Z2->RT，耗时66。\n\n第二个人的路径为RT->Z3->Z4->RT，耗时32。\n\n让一个人访问Z2，另一个人访问Z1、Z3、Z4的方案是不合法的。", "locale": "zh-CN"}}}
{"pid": "P6059", "type": "P", "difficulty": 5, "samples": [["5\n1 2 3 4 5", "698771051 399297745 349385527 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "洛谷月赛"], "title": "[加油武汉] 居家隔离", "background": "为了防止感染，大家要自觉做到居家隔离，少外出少与外人接触。", "description": "居家久了，你需要给自己找点娱乐。于是你看到这么一个游戏：\n给定一个 $n$ 元集合 $ \\{a_1,a_2,a_3....a_n \\}$，元素各不相同。\n\n游戏总共会进行 $n$ 轮，每轮系统会从集合中随机挑出一个元素，记作 $x$。你可以有如下两种选择：\n\n1. 取走 $x$，那么 $x$ 将会是你的最终得分。\n2. 舍弃 $x$，此时 $x$ 将会永久的从这个集合中删去，并且进入下一轮。\n\n请注意，若是集合中仅剩唯一一个元素时，该元素无法被舍弃。\n\n由于你很懒，所以你指定了一个很咸鱼的策略：\n\n对于前 $k$ 轮，将得到的数全部舍弃，并且记录下得到的数中的最大值，记作 $y$。\n\n在第 $k$ 轮之后，执行如下策略：\n\n若是取得的 $x > y$，则直接取走 $x$。反之不断舍弃，直到找到了一个满足要求的 $x$ 或是仅剩一个元素。\n\n现在你希望知道，对于 $1$ 到 $n-1$ 的每一个 $k$，你期望下的得分是多少。\n\n所有数请对 $998244353$ 取模。", "inputFormat": "第一行一个整数 $n$，表示集合中元素个数。\n\n第二行共 $n$ 个整数，描述集合中的每一个元素。", "outputFormat": "一行，总共 $n-1$ 个数，第 $i$ 个数表示当 $k=i$ 时，期望得分。\n\n设答案化为最简分式后的形式为 $\\frac{a}{b}$，其中 $a$ 和 $b$ 互质。输出整数 $x$ 使得 $bx\\equiv a \\pmod{998244353}$ 且 $0\\leq x < 998244353$。可以证明这样的整数 $x$ 是唯一的。", "hint": "**样例解释**\n\n答案输出的四个数应该分别是 $\\frac{39}{10}, \\frac{19}{5} ,\\frac{69}{20}, 3$，但在模意义下除以一个数相当于乘这个数在模意义下的逆元，因此输出为这些数。举例来说 $\\frac{39}{10}\\equiv 39\\cdot 10^{-1}\\equiv 39\\cdot 299473306\\equiv 698771051\\pmod{998244353}$。\n\n提示：如果你不知道如何对一个分数取余，请点这里：<https://www.luogu.com.cn/problem/P2613>\n\n\n - 对于 $40\\%$ 的数据，满足 $2 \\leq n \\leq 10$；\n - 对于 $60\\%$ 的数据，满足集合为 $[1,n]$ 中所有正整数；\n - 对于 $100\\%$ 的数据，满足 $2 \\leq n \\leq 1000$，集合中所有数字不超过 $10000$。", "locale": "zh-CN", "translations": {"en": {"title": "[Cheer Up Wuhan] Home Quarantine", "background": "To prevent infection, everyone should consciously stay in home quarantine, go out less, and have less contact with outsiders.", "description": "After staying at home for a long time, you need to find some entertainment. Then you see the following game:\n\nYou are given a set with $n$ elements $\\{a_1,a_2,a_3....a_n\\}$, and all elements are distinct.\n\nThe game consists of $n$ rounds in total. In each round, the system randomly picks an element from the set, denoted as $x$. You have two choices:\n\n1. Take $x$, then $x$ will be your final score.\n2. Discard $x$. In this case, $x$ will be permanently removed from the set, and the game proceeds to the next round.\n\nNote that if there is only one element left in the set, that element cannot be discarded.\n\nSince you are lazy, you choose a very “slacker” strategy:\n\nFor the first $k$ rounds, discard all numbers you get, and record the maximum among them, denoted as $y$.\n\nAfter round $k$, use the following strategy:\n\nIf the obtained $x > y$, take $x$ immediately. Otherwise, keep discarding until you find an $x$ that satisfies the condition, or until only one element remains.\n\nNow you want to know, for each $k$ from $1$ to $n-1$, what your expected score is.\n\nAll numbers should be taken modulo $998244353$.", "inputFormat": "The first line contains an integer $n$, the number of elements in the set.\n\nThe second line contains $n$ integers, describing each element in the set.", "outputFormat": "Output one line with $n-1$ numbers in total. The $i$-th number represents the expected score when $k=i$.\n\nLet the answer in lowest terms be $\\frac{a}{b}$, where $a$ and $b$ are coprime. Output the integer $x$ such that $bx\\equiv a \\pmod{998244353}$ and $0\\leq x < 998244353$. It can be proven that such an integer $x$ is unique.", "hint": "**Sample Explanation**\n\nThe four numbers that should be output are $\\frac{39}{10}, \\frac{19}{5} ,\\frac{69}{20}, 3$, but under modulo arithmetic, dividing by a number is equivalent to multiplying by its modular inverse, so the output is these values modulo $998244353$. For example, $\\frac{39}{10}\\equiv 39\\cdot 10^{-1}\\equiv 39\\cdot 299473306\\equiv 698771051\\pmod{998244353}$.\n\nHint: If you do not know how to take a fraction modulo a number, click here: <https://www.luogu.com.cn/problem/P2613>.\n\n- For $40\\%$ of the testdata, $2 \\leq n \\leq 10$.\n- For $60\\%$ of the testdata, the set is all positive integers in $[1,n]$.\n- For $100\\%$ of the testdata, $2 \\leq n \\leq 1000$, and all numbers in the set are at most $10000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[加油武汉] 居家隔离", "background": "为了防止感染，大家要自觉做到居家隔离，少外出少与外人接触。", "description": "居家久了，你需要给自己找点娱乐。于是你看到这么一个游戏：\n给定一个 $n$ 元集合 $ \\{a_1,a_2,a_3....a_n \\}$，元素各不相同。\n\n游戏总共会进行 $n$ 轮，每轮系统会从集合中随机挑出一个元素，记作 $x$。你可以有如下两种选择：\n\n1. 取走 $x$，那么 $x$ 将会是你的最终得分。\n2. 舍弃 $x$，此时 $x$ 将会永久的从这个集合中删去，并且进入下一轮。\n\n请注意，若是集合中仅剩唯一一个元素时，该元素无法被舍弃。\n\n由于你很懒，所以你指定了一个很咸鱼的策略：\n\n对于前 $k$ 轮，将得到的数全部舍弃，并且记录下得到的数中的最大值，记作 $y$。\n\n在第 $k$ 轮之后，执行如下策略：\n\n若是取得的 $x > y$，则直接取走 $x$。反之不断舍弃，直到找到了一个满足要求的 $x$ 或是仅剩一个元素。\n\n现在你希望知道，对于 $1$ 到 $n-1$ 的每一个 $k$，你期望下的得分是多少。\n\n所有数请对 $998244353$ 取模。", "inputFormat": "第一行一个整数 $n$，表示集合中元素个数。\n\n第二行共 $n$ 个整数，描述集合中的每一个元素。", "outputFormat": "一行，总共 $n-1$ 个数，第 $i$ 个数表示当 $k=i$ 时，期望得分。\n\n设答案化为最简分式后的形式为 $\\frac{a}{b}$，其中 $a$ 和 $b$ 互质。输出整数 $x$ 使得 $bx\\equiv a \\pmod{998244353}$ 且 $0\\leq x < 998244353$。可以证明这样的整数 $x$ 是唯一的。", "hint": "**样例解释**\n\n答案输出的四个数应该分别是 $\\frac{39}{10}, \\frac{19}{5} ,\\frac{69}{20}, 3$，但在模意义下除以一个数相当于乘这个数在模意义下的逆元，因此输出为这些数。举例来说 $\\frac{39}{10}\\equiv 39\\cdot 10^{-1}\\equiv 39\\cdot 299473306\\equiv 698771051\\pmod{998244353}$。\n\n提示：如果你不知道如何对一个分数取余，请点这里：<https://www.luogu.com.cn/problem/P2613>\n\n\n - 对于 $40\\%$ 的数据，满足 $2 \\leq n \\leq 10$；\n - 对于 $60\\%$ 的数据，满足集合为 $[1,n]$ 中所有正整数；\n - 对于 $100\\%$ 的数据，满足 $2 \\leq n \\leq 1000$，集合中所有数字不超过 $10000$。", "locale": "zh-CN"}}}
{"pid": "P6060", "type": "P", "difficulty": 6, "samples": [["1\n5 2", "15"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "多项式", "数论", "O2优化", "洛谷月赛", "整除分块"], "title": "[加油武汉] 传染病研究", "background": "", "description": "在得知 W 市爆发的肺炎之后，科学家们立刻投入了紧锣密鼓的研究之中。\n\n（下面的部分非严谨科学，大家做题以外切勿当真）\n\n假设某种病毒在第 $x$ 天的传播能力为 $D(x)$，该函数的含义为 $x$ 的约数个数。例如 $D(6)=4, D(7)=2$。\n\n现在给定你总的传播天数 $n$ 和一个影响常数 $k$，你需要计算 $\\sum_{i=1}^n D(i^k)$ 也就是 $D(1^k)+D(2^k)+D(3^k)+ \\cdots +D(n^k)\n$。\n\n由于答案可能很大，请对 $998244353$ 取模。", "inputFormat": "本题有多组数据。\n\n第一行一个整数 $T$，表示数据组数。\n\n接下来每行两个整数 $n,k$，意义如题所示。", "outputFormat": "共 $T$ 行，表示每组数据的答案。", "hint": " - 对于 $20\\%$ 的数据，满足 $1\\leq T\\leq 10,1\\leq n\\leq 100,1\\leq k\\leq 6$；\n - 存在另外 $30\\%$ 的数据，满足 $1 \\leq T \\leq 10^4, 1\\leq n \\leq 10^7,k=1$；\n - 对于 $100\\%$ 的数据，满足 $1 \\leq T \\leq 10^4, 1\\leq n,k \\leq 10^7$。\n\n【样例解释】\n\n$D(1^2)+D(2^2)+D(3^2)+D(4^2)+D(5^2)$  \n$=D(1)+D(4)+D(9)+D(16)+D(25)$  \n$=(1)+(3)+(3)+(5)+(3)$  \n\n1 有约数 1 个：1；  \n4 有约数 3 个：1，2，4；  \n9 有约数 3 个：1，3，9；  \n16 有约数 5 个：1，2，4，8，16；  \n25 有约数 3 个：1，5，25；\n\n一共有15个  \n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[加油武汉] 传染病研究", "background": "", "description": "在得知 W 市爆发的肺炎之后，科学家们立刻投入了紧锣密鼓的研究之中。\n\n（下面的部分非严谨科学，大家做题以外切勿当真）\n\n假设某种病毒在第 $x$ 天的传播能力为 $D(x)$，该函数的含义为 $x$ 的约数个数。例如 $D(6)=4, D(7)=2$。\n\n现在给定你总的传播天数 $n$ 和一个影响常数 $k$，你需要计算 $\\sum_{i=1}^n D(i^k)$ 也就是 $D(1^k)+D(2^k)+D(3^k)+ \\cdots +D(n^k)\n$。\n\n由于答案可能很大，请对 $998244353$ 取模。", "inputFormat": "本题有多组数据。\n\n第一行一个整数 $T$，表示数据组数。\n\n接下来每行两个整数 $n,k$，意义如题所示。", "outputFormat": "共 $T$ 行，表示每组数据的答案。", "hint": " - 对于 $20\\%$ 的数据，满足 $1\\leq T\\leq 10,1\\leq n\\leq 100,1\\leq k\\leq 6$；\n - 存在另外 $30\\%$ 的数据，满足 $1 \\leq T \\leq 10^4, 1\\leq n \\leq 10^7,k=1$；\n - 对于 $100\\%$ 的数据，满足 $1 \\leq T \\leq 10^4, 1\\leq n,k \\leq 10^7$。\n\n【样例解释】\n\n$D(1^2)+D(2^2)+D(3^2)+D(4^2)+D(5^2)$  \n$=D(1)+D(4)+D(9)+D(16)+D(25)$  \n$=(1)+(3)+(3)+(5)+(3)$  \n\n1 有约数 1 个：1；  \n4 有约数 3 个：1，2，4；  \n9 有约数 3 个：1，3，9；  \n16 有约数 5 个：1，2，4，8，16；  \n25 有约数 3 个：1，5，25；\n\n一共有15个  \n", "locale": "zh-CN"}}}
{"pid": "P6061", "type": "P", "difficulty": 6, "samples": [["3 3\n30 25 30\n1 2 3\n2 3 5\n3 1 10", "18"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["O2优化", "最短路", "洛谷月赛"], "title": "[加油武汉] 疫情调查", "background": null, "description": "W 市爆发了严重的肺炎疫情。为了应对疫情，W 市需要对下属每一个社区进行巡回调查。\n\nW 市共有 $n$ 个街区，街区之间由 $m$ 条不相同的有向道路相连，没有任何一条道路是自己通向自己的，并且是保证弱连通的。通过每条道路需要消耗一定的燃油费用。\n\n现在你需要派出一些工作人员来寻访每个街区。对于每个工作人员，你需要给他分派一些街区，之后工作人员会按照给定的顺序在这些街区反复循环，每周循环一次。请注意，工作人员只会检查你给他分配的街区，在分配的街区之间经过的街区，工作人员并不会下车。同时为了防止人员浪费，任何一个街区只能接受一位工作人员的检查。当然，如果必要，他也会经过重复的街区。\n\n工作人员的花费是这样的：若是某个工作人员只分配到了一个街区 $u$，那么他需要每周消耗 $a_u$ 的停留费用。若是被分配到了多于一个的街区，那么他的花费就是环绕这些点一圈最后回到起点的道路燃油费用之和。\n\n现在你需要知道，在工作人员数量无限的情况下，每周最少需要多少费用可以将整个 W 市完全巡查。", "inputFormat": "第一行两个整数 $n,m$，意义如题。\n\n第二行 $n$ 个整数，为数组 $a$。\n\n接下来 $m$ 行，每行三个整数 $u_i,v_i,w_i$ 表示存在一条连接 $u_i,v_i$ 的**有向边**，通行时付出的代价为 $w_i$。", "outputFormat": "一个整数，表示答案。", "hint": "对于所有的数据 $1\\leq n\\leq 500,1\\leq m\\leq \\min\\{5000,n\\times(n-1)\\},0\\leq a_i,w_i\\leq 10^9$，保证图弱连通，无自环、无重边。\n\n对于不同的测试点，我们有如下约束：\n\n| 测试点编号 | $n\\leq$ | $m\\leq$ | 特殊性质 |\n| :-: | :-: | :-: | :-: |\n| $1\\sim 6$ | $15$ | $100$ | $\\times$ |\n| $7\\sim 10$ | $500$ | $5000$ | 对于所有的 $w_i=0$ |\n| $11\\sim 14$ | $500$ | $500$ | $n=m$ 且所有的节点出度为 $1$ |\n| $15\\sim 20$ | $500$ | $5000$ | $\\times$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[加油武汉] 疫情调查", "background": null, "description": "W 市爆发了严重的肺炎疫情。为了应对疫情，W 市需要对下属每一个社区进行巡回调查。\n\nW 市共有 $n$ 个街区，街区之间由 $m$ 条不相同的有向道路相连，没有任何一条道路是自己通向自己的，并且是保证弱连通的。通过每条道路需要消耗一定的燃油费用。\n\n现在你需要派出一些工作人员来寻访每个街区。对于每个工作人员，你需要给他分派一些街区，之后工作人员会按照给定的顺序在这些街区反复循环，每周循环一次。请注意，工作人员只会检查你给他分配的街区，在分配的街区之间经过的街区，工作人员并不会下车。同时为了防止人员浪费，任何一个街区只能接受一位工作人员的检查。当然，如果必要，他也会经过重复的街区。\n\n工作人员的花费是这样的：若是某个工作人员只分配到了一个街区 $u$，那么他需要每周消耗 $a_u$ 的停留费用。若是被分配到了多于一个的街区，那么他的花费就是环绕这些点一圈最后回到起点的道路燃油费用之和。\n\n现在你需要知道，在工作人员数量无限的情况下，每周最少需要多少费用可以将整个 W 市完全巡查。", "inputFormat": "第一行两个整数 $n,m$，意义如题。\n\n第二行 $n$ 个整数，为数组 $a$。\n\n接下来 $m$ 行，每行三个整数 $u_i,v_i,w_i$ 表示存在一条连接 $u_i,v_i$ 的**有向边**，通行时付出的代价为 $w_i$。", "outputFormat": "一个整数，表示答案。", "hint": "对于所有的数据 $1\\leq n\\leq 500,1\\leq m\\leq \\min\\{5000,n\\times(n-1)\\},0\\leq a_i,w_i\\leq 10^9$，保证图弱连通，无自环、无重边。\n\n对于不同的测试点，我们有如下约束：\n\n| 测试点编号 | $n\\leq$ | $m\\leq$ | 特殊性质 |\n| :-: | :-: | :-: | :-: |\n| $1\\sim 6$ | $15$ | $100$ | $\\times$ |\n| $7\\sim 10$ | $500$ | $5000$ | 对于所有的 $w_i=0$ |\n| $11\\sim 14$ | $500$ | $500$ | $n=m$ 且所有的节点出度为 $1$ |\n| $15\\sim 20$ | $500$ | $5000$ | $\\times$ |", "locale": "zh-CN"}}}
{"pid": "P6062", "type": "P", "difficulty": 6, "samples": [["4 4\n*.*.\n.***\n***.\n..*.", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2005", "USACO", "图论建模", "二分图"], "title": "[USACO05JAN] Muddy Fields G", "background": "", "description": "大雨侵袭了奶牛们的牧场。\n\n牧场是一个 $R \\times C$ 的矩形，其中 $1 \\leq R,C \\leq 50$。大雨将没有长草的土地弄得泥泞不堪，可是小心的奶牛们不想在吃草的时候弄脏她们的蹄子。为了防止她们的蹄子被弄脏，约翰决定在泥泞的牧场里放置一些木板。每一块木板的宽度为 $1$ 个单位，长度任意，每一个板必须放置在平行于牧场的泥地里。 \n\n约翰想使用最少的木板覆盖所有的泥地．一个木板可以重叠在另一个木板上，但是不能放在草地上。", "inputFormat": "第一行两个整数 $R,C$。\n\n接下来 $R$ 行，每行 $C$ 个字符，描述牧场，其中 `*` 为泥地，`.` 为草地。", "outputFormat": "输出一个整数，最少需要多少木板。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO05JAN] Muddy Fields G", "background": "", "description": "大雨侵袭了奶牛们的牧场。\n\n牧场是一个 $R \\times C$ 的矩形，其中 $1 \\leq R,C \\leq 50$。大雨将没有长草的土地弄得泥泞不堪，可是小心的奶牛们不想在吃草的时候弄脏她们的蹄子。为了防止她们的蹄子被弄脏，约翰决定在泥泞的牧场里放置一些木板。每一块木板的宽度为 $1$ 个单位，长度任意，每一个板必须放置在平行于牧场的泥地里。 \n\n约翰想使用最少的木板覆盖所有的泥地．一个木板可以重叠在另一个木板上，但是不能放在草地上。", "inputFormat": "第一行两个整数 $R,C$。\n\n接下来 $R$ 行，每行 $C$ 个字符，描述牧场，其中 `*` 为泥地，`.` 为草地。", "outputFormat": "输出一个整数，最少需要多少木板。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6063", "type": "P", "difficulty": 4, "samples": [["4 5\n5 8 7 7\n5 2 1 5\n7 1 7 1\n8 9 6 9\n9 8 9 9", "12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2005", "USACO"], "title": "[USACO05JAN] The Wedding Juicer G", "background": "", "description": "约翰的奶牛们找到了一份不错的兼职一设计冲压式榨汁机．榨汁机设计如下：\n\n一个 $W \\times H$ 的底座（$3\\leq W,H \\leq 300$），每一个 $1 \\times 1$ 的方格上都放有一个高度为 $B$（$1 \\leq B \\leq 10^9$）的柱子，用来榨汁。假设柱子之间都被完美地粘合了，这样水不会顺着柱子与柱子之间的空隙流走。\n\n但是约翰一直不知道，这么一个榨汁机，到底能装多少果汁？假设榨汁机周围没有任何东西，也就是说，边界上的水都会流走，有些榨汁机则根本不能装下任何的果汁。", "inputFormat": "第一行两个整数 $W$ 和 $H$。\n\n接下来 $H$ 行，每行 $W$ 个数字，代表了高度。", "outputFormat": "输出最多能装多少果汁。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO05JAN] The Wedding Juicer G", "background": "", "description": "约翰的奶牛们找到了一份不错的兼职一设计冲压式榨汁机．榨汁机设计如下：\n\n一个 $W \\times H$ 的底座（$3\\leq W,H \\leq 300$），每一个 $1 \\times 1$ 的方格上都放有一个高度为 $B$（$1 \\leq B \\leq 10^9$）的柱子，用来榨汁。假设柱子之间都被完美地粘合了，这样水不会顺着柱子与柱子之间的空隙流走。\n\n但是约翰一直不知道，这么一个榨汁机，到底能装多少果汁？假设榨汁机周围没有任何东西，也就是说，边界上的水都会流走，有些榨汁机则根本不能装下任何的果汁。", "inputFormat": "第一行两个整数 $W$ 和 $H$。\n\n接下来 $H$ 行，每行 $W$ 个数字，代表了高度。", "outputFormat": "输出最多能装多少果汁。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6064", "type": "P", "difficulty": 4, "samples": [["5 3\n2\n0\n3\n1\n4", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2005", "USACO"], "title": "[USACO05JAN] Naptime G", "background": null, "description": "贝茜是一只非常缺觉的奶牛．她的一天被平均分割成 $N$ 段（$3 \\leq N \\leq 3830$），但是她要用其中的 $B$ 段时间（$2 \\leq B \\lt N$）睡觉。每段时间都有一个效用值 $U_i$（$0 \\leq U_i \\leq 2 \\times 10^5$），只有当她睡觉的时候，才会发挥效用。\n\n有了闹钟的帮助，贝茜可以选择任意的时间入睡，当然，她只能在时间划分的边界处入睡、醒来。\n\n贝茜想使所有睡觉效用的总和最大。不幸的是，每一段睡眠的第一个时间阶段都是“入睡”阶段，而且不记入效用值。\n\n时间阶段是不断循环的圆（一天一天是循环的嘛），假如贝茜在时间 $N$ 和时间 $1$ 睡觉，那么她将得到时间 $1$ 的效用值。", "inputFormat": "第一行两个整数 $N,B$。\n\n接下来 $N$ 行，每行一个整数，表示第 $i$ 个时段的效用值。", "outputFormat": "输出最大效用值。", "hint": "从第 $4$ 个时段入睡，到第 $1$ 个时段结束醒来。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO05JAN] Naptime G", "background": null, "description": "贝茜是一只非常缺觉的奶牛．她的一天被平均分割成 $N$ 段（$3 \\leq N \\leq 3830$），但是她要用其中的 $B$ 段时间（$2 \\leq B \\lt N$）睡觉。每段时间都有一个效用值 $U_i$（$0 \\leq U_i \\leq 2 \\times 10^5$），只有当她睡觉的时候，才会发挥效用。\n\n有了闹钟的帮助，贝茜可以选择任意的时间入睡，当然，她只能在时间划分的边界处入睡、醒来。\n\n贝茜想使所有睡觉效用的总和最大。不幸的是，每一段睡眠的第一个时间阶段都是“入睡”阶段，而且不记入效用值。\n\n时间阶段是不断循环的圆（一天一天是循环的嘛），假如贝茜在时间 $N$ 和时间 $1$ 睡觉，那么她将得到时间 $1$ 的效用值。", "inputFormat": "第一行两个整数 $N,B$。\n\n接下来 $N$ 行，每行一个整数，表示第 $i$ 个时段的效用值。", "outputFormat": "输出最大效用值。", "hint": "从第 $4$ 个时段入睡，到第 $1$ 个时段结束醒来。", "locale": "zh-CN"}}}
{"pid": "P6065", "type": "P", "difficulty": 2, "samples": [["7", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2005", "USACO"], "title": "[USACO05JAN] Sumsets S", "background": "", "description": "给出一个整数 $N$，将 $N$ 分解为若干个 $2$ 的次幂的和，共有多少种方法？", "inputFormat": "输入一个整数 $N$（$1 \\leq N \\leq 10^6$）。", "outputFormat": "输出方案数对 $10^9$ 取模的结果。", "hint": "所有合法方案如下：\n- 1+1+1+1+1+1+1\n- 1+1+1+1+1+2\n- 1+1+1+2+2\n- 1+1+1+4\n- 1+2+2+2\n- 1+2+4", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO05JAN] Sumsets S", "background": "", "description": "给出一个整数 $N$，将 $N$ 分解为若干个 $2$ 的次幂的和，共有多少种方法？", "inputFormat": "输入一个整数 $N$（$1 \\leq N \\leq 10^6$）。", "outputFormat": "输出方案数对 $10^9$ 取模的结果。", "hint": "所有合法方案如下：\n- 1+1+1+1+1+1+1\n- 1+1+1+1+1+2\n- 1+1+1+2+2\n- 1+1+1+4\n- 1+2+2+2\n- 1+2+4", "locale": "zh-CN"}}}
{"pid": "P6066", "type": "P", "difficulty": 4, "samples": [["4 5\n1 2\n1 4\n2 3\n2 4\n3 4", "1\n2\n3\n4\n2\n1\n4\n3\n2\n4\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2005", "USACO", "Special Judge", "深度优先搜索 DFS", "欧拉回路", "栈"], "title": "[USACO05JAN] Watchcow S", "background": "", "description": "Farmer John 有 $N$ 个农场（$2 \\leq N \\leq 10^4$），这些农场由 $M$ 条道路连接（$1 \\leq M \\leq 5 \\times 10^4$）。不保证没有重边。\n\nBassie 从 $1$ 号农场开始巡逻，每条路必须从两个方向各走**恰好一遍**，最后回到 $1$ 号农场。\n\n请输出一条满足上述要求的路径。\n\n保证这样的路径存在。如果有多条路径，任意输出一条即可。", "inputFormat": "第一行两个整数 $N,M$。\n\n接下来 $M$ 行，每行两个整数 $u,v$，描述一条 $u$ 到 $v$ 的道路。", "outputFormat": "输出经过的农场，一行一个。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO05JAN] Watchcow S", "background": "", "description": "Farmer John 有 $N$ 个农场（$2 \\leq N \\leq 10^4$），这些农场由 $M$ 条道路连接（$1 \\leq M \\leq 5 \\times 10^4$）。不保证没有重边。\n\nBassie 从 $1$ 号农场开始巡逻，每条路必须从两个方向各走**恰好一遍**，最后回到 $1$ 号农场。\n\n请输出一条满足上述要求的路径。\n\n保证这样的路径存在。如果有多条路径，任意输出一条即可。", "inputFormat": "第一行两个整数 $N,M$。\n\n接下来 $M$ 行，每行两个整数 $u,v$，描述一条 $u$ 到 $v$ 的道路。", "outputFormat": "输出经过的农场，一行一个。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6067", "type": "P", "difficulty": 3, "samples": [["5\n1\n5\n3\n2\n4", "40"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2005", "USACO", "前缀和"], "title": "[USACO05JAN] Moo Volume S", "background": "", "description": "Farmer John 的农场上有 $N$ 头奶牛（$1 \\leq N \\leq 10^5$），第 $i$ 头奶牛的位置为 $x_i$（$0 \\leq x_i \\leq 10^9$）。\n\n奶牛很健谈，每头奶牛都和其他 $N-1$ 头奶牛聊天。第 $i$ 头奶牛和第 $j$ 头奶牛聊天时，音量为 $|x_i-x_j|$。\n\n请您求出所有奶牛聊天音量的总和。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行一个整数 $x_i$。", "outputFormat": "输出总音量。\n\n**保证答案在 64 位带符号整数的表示范围内。**", "hint": "- 子任务 1（原测试数据，1 分）：$N \\leq 10^4$；\n- 子任务 2（99 分）：无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO05JAN] Moo Volume S", "background": "", "description": "Farmer John 的农场上有 $N$ 头奶牛（$1 \\leq N \\leq 10^5$），第 $i$ 头奶牛的位置为 $x_i$（$0 \\leq x_i \\leq 10^9$）。\n\n奶牛很健谈，每头奶牛都和其他 $N-1$ 头奶牛聊天。第 $i$ 头奶牛和第 $j$ 头奶牛聊天时，音量为 $|x_i-x_j|$。\n\n请您求出所有奶牛聊天音量的总和。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行一个整数 $x_i$。", "outputFormat": "输出总音量。\n\n**保证答案在 64 位带符号整数的表示范围内。**", "hint": "- 子任务 1（原测试数据，1 分）：$N \\leq 10^4$；\n- 子任务 2（99 分）：无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P6068", "type": "P", "difficulty": 2, "samples": [["3\n12\n27\n5\n", "2\n3\n-1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "枚举"], "title": "『MdOI R1』GCD? GCD!", "background": "", "description": "灵喜欢 $\\mathrm{gcd}$，也就是 **最大公约数**。如果你不知道什么叫做最大公约数，你可以访问 [最大公约数 - OI Wiki](https://oi-wiki.org/math/gcd/)。\n\n灵给了你一个正整数 $n$，要你把它分成三个 **互不相等的** 正整数 $a,b,c$ 之和，使得 $\\mathrm{gcd}(a,b,c)$ 最大。", "inputFormat": "**本题有多组数据**。\n\n第一行一个正整数 $T$，表示数据组数。\n\n接下来 $T$ 行，每行一个正整数 $n$。", "outputFormat": "对于每组数据，一行一个整数，表示答案，即最大的 $\\mathrm{gcd}(a,b,c)$ 。 \n\n特别地，如果 $n$ 无法分成三个互不相等的正整数之和，请输出 `-1`。", "hint": "【样例解释】\n\n将 $12$ 分成 $2+4+6$，可以证明 $\\gcd(2,4,6)=2$ 为可能达到的最大值。\n\n将 $27$ 分成 $3+6+18$，可以证明 $\\gcd(3,6,18)=3$ 为可能达到的最大值。\n\n$5$ 无法分成三个互不相等的正整数之和，输出 `-1`。\n\n---\n\n【数据范围】\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | $n\\leq$ | 分值 |\n| :--------: | :-----: | :--: |\n|     1      |  $50$   |  17  |\n|     2      |  $500$  |  19  |\n|     3      | $10^5$  |  23  |\n|     4      | $10^9$  |  41  |\n\n对于 $100\\%$ 的数据，$1\\le T \\le 100$，$1\\le n\\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『MdOI R1』GCD? GCD!", "background": "", "description": "灵喜欢 $\\mathrm{gcd}$，也就是 **最大公约数**。如果你不知道什么叫做最大公约数，你可以访问 [最大公约数 - OI Wiki](https://oi-wiki.org/math/gcd/)。\n\n灵给了你一个正整数 $n$，要你把它分成三个 **互不相等的** 正整数 $a,b,c$ 之和，使得 $\\mathrm{gcd}(a,b,c)$ 最大。", "inputFormat": "**本题有多组数据**。\n\n第一行一个正整数 $T$，表示数据组数。\n\n接下来 $T$ 行，每行一个正整数 $n$。", "outputFormat": "对于每组数据，一行一个整数，表示答案，即最大的 $\\mathrm{gcd}(a,b,c)$ 。 \n\n特别地，如果 $n$ 无法分成三个互不相等的正整数之和，请输出 `-1`。", "hint": "【样例解释】\n\n将 $12$ 分成 $2+4+6$，可以证明 $\\gcd(2,4,6)=2$ 为可能达到的最大值。\n\n将 $27$ 分成 $3+6+18$，可以证明 $\\gcd(3,6,18)=3$ 为可能达到的最大值。\n\n$5$ 无法分成三个互不相等的正整数之和，输出 `-1`。\n\n---\n\n【数据范围】\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | $n\\leq$ | 分值 |\n| :--------: | :-----: | :--: |\n|     1      |  $50$   |  17  |\n|     2      |  $500$  |  19  |\n|     3      | $10^5$  |  23  |\n|     4      | $10^9$  |  41  |\n\n对于 $100\\%$ 的数据，$1\\le T \\le 100$，$1\\le n\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P6069", "type": "P", "difficulty": 4, "samples": [["4 32\n3 7 -5 -1\n", "1\n"], ["5 18\n1 4 3 6 9\n", "1\n"], ["6 679\n5 83 56 20 54 111\n", "3\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "二分", "前缀和", "双指针 two-pointer"], "title": "『MdOI R1』Group", "background": "此题为比赛时的数据。\n\n然鹅后来 yummy 觉得没这个必要，于是放弃加强。\n\n**存在不使用 `long double` 和 `__int128` 的写法。**", "description": "为了让我们团队的同学更加团结，我们需要让各个成员的水平尽量平均。这时，就需要有人对自己产生一些改变。\n\n我们的团队有 $n$ 个同学，第 $i$ 个同学的水平值是一个整数 $a_i$。\n\n我们认为当整组同学水平值的 **方差** **不超过 $m$** 的时候，这组同学就是团结的。  \n\n请问至少要让几个同学改变自己的水平值（可以改成任意一个 **实数**），这个团队才可以做到团结？\n\n为避免读入时的精度误差，本题输入的 $m$ 是 **实际值的 $n$ 倍**，这个值是一个整数。\n\n---\n\n如果你不知道什么叫做方差，以下是方差的基本概念：\n\n方差是衡量一组数据 **波动程度** 的指标。\n\n设长度为 $n$ 的序列 $a_{1\\dots n}$ 的平均数为 $p$，则该序列的方差 $S$ 为：\n\n$$\nS=\\frac{1}{n} \\sum_{i=1}^n(a_i-p)^2\n$$", "inputFormat": "第一行，整数 $n,m$，分别表示同学的人数和方差上限的 $n$ 倍。\n\n第二行，$n$ 个整数 $a_{1\\cdots n}$，表示每个同学的水平值。", "outputFormat": "第一行，一个整数 $t$，表示最少要改变水平值的人数。", "hint": "【样例 1 解释】   \n\n这组样例中，$n=4$，真实的 $m=\\dfrac{32}{n}=8$。\n\n一开始，所有同学水平值 $a_i$ 的平均数为 $1$，方差为：\n\n$$S=\\dfrac{1}{4}[(3-1)^2+(7-1)^2+(-5-1)^2+(-1-1)^2]=20$$\n\n把第 $3$ 个同学的水平值改成 $3$ 后，平均数为 $3$，方差为：\n\n$$S=\\dfrac{1}{4}[(3-3)^2+(7-3)^2+(3-3)^2+(-1-3)^2]=8$$\n\n只改变了 $1$ 人的水平值，即满足了题目要求。\n\n【样例 2 解释】\n\n这组样例中，$n=5$，真实的 $m=\\dfrac{18}{n}=3.6$。\n\n一开始，所有同学水平值 $a_i$ 的平均数为 $4.6$，方差为 $7.44$：\n\n把第 $5$ 个同学的水平值改成 $3.5$ 后，平均数为 $3.5$，**方差为 $2.6$。**\n\n只改变了 $1$ 人的水平值，即满足了题目要求。\n\n---\n\n【数据范围】   \n\n|子任务编号|$n\\leq$|分值|\n|:-:|:-:|:-:|\n|1|$16$|15|\n|2|$300$|17|\n|3|$10^3$|20|\n|4|$5\\times 10^3$|7|\n|5|$10^4$|8|\n|6|$2\\times 10^5$|33|\n\n对于所有测试点，$1\\leq n\\leq 2\\times 10^5$，$1\\leq m\\leq 10^{18}$，$0\\leq |a_i|\\leq 10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『MdOI R1』Group", "background": "此题为比赛时的数据。\n\n然鹅后来 yummy 觉得没这个必要，于是放弃加强。\n\n**存在不使用 `long double` 和 `__int128` 的写法。**", "description": "为了让我们团队的同学更加团结，我们需要让各个成员的水平尽量平均。这时，就需要有人对自己产生一些改变。\n\n我们的团队有 $n$ 个同学，第 $i$ 个同学的水平值是一个整数 $a_i$。\n\n我们认为当整组同学水平值的 **方差** **不超过 $m$** 的时候，这组同学就是团结的。  \n\n请问至少要让几个同学改变自己的水平值（可以改成任意一个 **实数**），这个团队才可以做到团结？\n\n为避免读入时的精度误差，本题输入的 $m$ 是 **实际值的 $n$ 倍**，这个值是一个整数。\n\n---\n\n如果你不知道什么叫做方差，以下是方差的基本概念：\n\n方差是衡量一组数据 **波动程度** 的指标。\n\n设长度为 $n$ 的序列 $a_{1\\dots n}$ 的平均数为 $p$，则该序列的方差 $S$ 为：\n\n$$\nS=\\frac{1}{n} \\sum_{i=1}^n(a_i-p)^2\n$$", "inputFormat": "第一行，整数 $n,m$，分别表示同学的人数和方差上限的 $n$ 倍。\n\n第二行，$n$ 个整数 $a_{1\\cdots n}$，表示每个同学的水平值。", "outputFormat": "第一行，一个整数 $t$，表示最少要改变水平值的人数。", "hint": "【样例 1 解释】   \n\n这组样例中，$n=4$，真实的 $m=\\dfrac{32}{n}=8$。\n\n一开始，所有同学水平值 $a_i$ 的平均数为 $1$，方差为：\n\n$$S=\\dfrac{1}{4}[(3-1)^2+(7-1)^2+(-5-1)^2+(-1-1)^2]=20$$\n\n把第 $3$ 个同学的水平值改成 $3$ 后，平均数为 $3$，方差为：\n\n$$S=\\dfrac{1}{4}[(3-3)^2+(7-3)^2+(3-3)^2+(-1-3)^2]=8$$\n\n只改变了 $1$ 人的水平值，即满足了题目要求。\n\n【样例 2 解释】\n\n这组样例中，$n=5$，真实的 $m=\\dfrac{18}{n}=3.6$。\n\n一开始，所有同学水平值 $a_i$ 的平均数为 $4.6$，方差为 $7.44$：\n\n把第 $5$ 个同学的水平值改成 $3.5$ 后，平均数为 $3.5$，**方差为 $2.6$。**\n\n只改变了 $1$ 人的水平值，即满足了题目要求。\n\n---\n\n【数据范围】   \n\n|子任务编号|$n\\leq$|分值|\n|:-:|:-:|:-:|\n|1|$16$|15|\n|2|$300$|17|\n|3|$10^3$|20|\n|4|$5\\times 10^3$|7|\n|5|$10^4$|8|\n|6|$2\\times 10^5$|33|\n\n对于所有测试点，$1\\leq n\\leq 2\\times 10^5$，$1\\leq m\\leq 10^{18}$，$0\\leq |a_i|\\leq 10^6$。", "locale": "zh-CN"}}}
{"pid": "P6070", "type": "P", "difficulty": 4, "samples": [["4 14 3\n1 1 1\n1 2 1\n1 3 1\n2 1 1\n2 2 3\n2 3 3\n2 4 2\n3 1 1\n3 2 3\n3 3 3\n3 4 2\n4 2 2\n4 3 2\n4 4 2\n", "3\n"], ["3 1 2\n1 1 1\n", "-1\n"], ["4 5 1\n1 1 5\n2 2 -3\n2 3 -4\n3 3 1\n4 4 2\n", "15\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["模拟", "O2优化", "差分"], "title": "『MdOI R1』Decrease", "background": "", "description": "给定一个 $n \\times n$ 的矩阵，你可以进行若干次操作。\n\n每次操作，你可以将一个 $k \\times k$ 的 **连续** 子矩阵里的所有数全都加上 $1$ 或者全都减去 $1$。\n\n初始时，矩阵中有 $m$ 个位置上的数不为 $0$，其它位置上的数均为 $0$。\n\n请你求出至少需要多少次操作，可以将矩形中所有数都变为 $0$。", "inputFormat": "第一行三个整数 $n,m,k$，分别表示矩阵大小，非 $0$ 格数和每次修改的连续子矩阵大小。\n\n接下来 $m$ 行，每行三个整数 $x,y,z$，表示初始时矩阵的第 $x$ 行第 $y$ 列上的数为 $z$。\n\n", "outputFormat": "一行一个整数，表示最少操作次数。\n\n特别地，如果无法使矩阵中所有数都变为 $0$，输出 `-1`。  ", "hint": "【样例 1 解释】:  \n\n给出的矩阵为：  \n\n```plain\n1 1 1 0\n1 3 3 2\n1 3 3 2\n0 2 2 2\n```\n\n具体步骤：  \n\n先将以第一行第一列为左上角的连续子矩阵执行 **减 1 操作** 一次；\n\n再将以第二行第二列为左上角的连续子矩阵执行 **减 1 操作** 两次。\n\n总共三次。\n\n```plain\n1 1 1 0  0 0 0 0  0 0 0 0  0 0 0 0\n1 3 3 2  0 2 2 2  0 1 1 1  0 0 0 0\n1 3 3 2  0 2 2 2  0 1 1 1  0 0 0 0\n0 2 2 2  0 2 2 2  0 1 1 1  0 0 0 0\n```\n\n【样例 2 解释】：  \n\n给出的矩阵为：  \n\n```plain\n1 0 0\n0 0 0\n0 0 0\n```\n\n只通过 $2\\times 2$ 的连续子矩阵操作不可能使得所有格子上的数都变为 $0$。\n\n【数据范围】   \n\n**本题采用捆绑测试。**\n\n| 子任务编号 |    $n\\leq$     | $k\\leq$ | 分值 |\n| :--------: | :------------: | :-----: | :--: |\n|     1      |     $10^3$     |   $1$   |  11  |\n|     2      |      $20$      |  $20$   |  14  |\n|     3      |     $100$      |  $100$  |  17  |\n|     4      |     $10^3$     | $10^3$  |  34  |\n|     5      | $5\\times 10^3$ | $10^3$  |  24  |\n\n对于所有数据，$1\\leq n\\leq 5\\times 10^3$，$1\\leq m\\leq \\min(n^2,5\\times 10^5)$，$1\\leq k\\leq \\min(n,10^3)$，$1\\leq x,y\\leq n$，每对 $(x,y)$ 至多出现一次，$1 \\le |z| \\leq 10^9$。\n\n数据保证如果有解，答案不超过 $2^{63}-1$。\n\n---\n\n【提示】\n\n本题读入量较大，建议使用较快的读入方式。  ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『MdOI R1』Decrease", "background": "", "description": "给定一个 $n \\times n$ 的矩阵，你可以进行若干次操作。\n\n每次操作，你可以将一个 $k \\times k$ 的 **连续** 子矩阵里的所有数全都加上 $1$ 或者全都减去 $1$。\n\n初始时，矩阵中有 $m$ 个位置上的数不为 $0$，其它位置上的数均为 $0$。\n\n请你求出至少需要多少次操作，可以将矩形中所有数都变为 $0$。", "inputFormat": "第一行三个整数 $n,m,k$，分别表示矩阵大小，非 $0$ 格数和每次修改的连续子矩阵大小。\n\n接下来 $m$ 行，每行三个整数 $x,y,z$，表示初始时矩阵的第 $x$ 行第 $y$ 列上的数为 $z$。\n\n", "outputFormat": "一行一个整数，表示最少操作次数。\n\n特别地，如果无法使矩阵中所有数都变为 $0$，输出 `-1`。  ", "hint": "【样例 1 解释】:  \n\n给出的矩阵为：  \n\n```plain\n1 1 1 0\n1 3 3 2\n1 3 3 2\n0 2 2 2\n```\n\n具体步骤：  \n\n先将以第一行第一列为左上角的连续子矩阵执行 **减 1 操作** 一次；\n\n再将以第二行第二列为左上角的连续子矩阵执行 **减 1 操作** 两次。\n\n总共三次。\n\n```plain\n1 1 1 0  0 0 0 0  0 0 0 0  0 0 0 0\n1 3 3 2  0 2 2 2  0 1 1 1  0 0 0 0\n1 3 3 2  0 2 2 2  0 1 1 1  0 0 0 0\n0 2 2 2  0 2 2 2  0 1 1 1  0 0 0 0\n```\n\n【样例 2 解释】：  \n\n给出的矩阵为：  \n\n```plain\n1 0 0\n0 0 0\n0 0 0\n```\n\n只通过 $2\\times 2$ 的连续子矩阵操作不可能使得所有格子上的数都变为 $0$。\n\n【数据范围】   \n\n**本题采用捆绑测试。**\n\n| 子任务编号 |    $n\\leq$     | $k\\leq$ | 分值 |\n| :--------: | :------------: | :-----: | :--: |\n|     1      |     $10^3$     |   $1$   |  11  |\n|     2      |      $20$      |  $20$   |  14  |\n|     3      |     $100$      |  $100$  |  17  |\n|     4      |     $10^3$     | $10^3$  |  34  |\n|     5      | $5\\times 10^3$ | $10^3$  |  24  |\n\n对于所有数据，$1\\leq n\\leq 5\\times 10^3$，$1\\leq m\\leq \\min(n^2,5\\times 10^5)$，$1\\leq k\\leq \\min(n,10^3)$，$1\\leq x,y\\leq n$，每对 $(x,y)$ 至多出现一次，$1 \\le |z| \\leq 10^9$。\n\n数据保证如果有解，答案不超过 $2^{63}-1$。\n\n---\n\n【提示】\n\n本题读入量较大，建议使用较快的读入方式。  ", "locale": "zh-CN"}}}
{"pid": "P6071", "type": "P", "difficulty": 6, "samples": [["5 4\n3 1 2\n1 5 1\n2 3 3\n3 4 4\n2 3 5\n2 1 7\n0 7 7\n5 5 2", "3\n2\n6\n0"], ["10 10\n2 1 9907\n3 2 8329\n4 2 8402\n5 4 3636\n6 4 8747\n7 4 3080\n8 6 780\n9 6 5414\n10 9 3545\n2 10 10\n26107 26106 26101\n4 9 10\n14171 14166 14169\n8958 8949 8949\n36008 36014 36013\n11485 11485 11472\n3 9 9\n30888 30894 30895\n8404 8404 8411\n", "26108\n0\n14161\n8959\n36015\n11482\n0\n30892\n8402\n0\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["最近公共祖先 LCA", "可持久化线段树"], "title": "『MdOI R1』Treequery", "background": "", "description": "给定一棵 $n$ 个点的无根树，边有边权。\n\n令 $E(x,y)$ 表示树上 $x,y$ 之间的简单路径上的所有边的集合，特别地，当 $x=y$ 时，$E(x,y) = \\varnothing$。\n\n你需要 **实时** 回答 $q$ 个询问，每个询问给定 $p,l,r$，请你求出集合 $\\bigcap_{i=l}^r E(p,i)$ 中所有边的边权和，即 $E(p, l\\dots r)$ 的交所包含的边的边权和。\n\n通俗的讲，你需要求出 $p$ 到 $[l,r]$ 内每一个点的简单路径的公共部分长度。\n\n", "inputFormat": "第一行两个整数 $n,q$，表示树的结点数和询问数。\n\n接下来 $n-1$ 行，每行三个整数 $x,y,w$，表示 $x$ 与 $y$ 之间有一条权值为 $w$ 的边。\n\n接下来 $q$ 行，每行三个整数 $p_0,l_0,r_0$。第 $i$ 个询问的 $p,l,r$ 分别为 $p_0,l_0,r_0$ 异或上 $lastans$ 的值，其中 $lastans$ 是上次询问的答案，初始时为 $0$。", "outputFormat": "对于每个询问，一行一个整数，表示答案。", "hint": "【样例 1 说明】\n\n样例中的树如图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g6l15zpv.png)\n\n下面解释中的询问参数均为异或 $lastans$ 之后得到的真实值。\n\n对于第一个询问，$p=2$，$l=3$，$r=5$，$\\bigcap_{i=3}^5 E(2,i)$ 为边 $(2,3)$，长度为 $3$。\n\n对于第二个询问，$p=1$，$l=2$，$r=4$，$\\bigcap_{i=2}^4 E(1,i)$ 为边 $(1,3)$，长度为 $2$；\n\n对于第三个询问，$p=2$，$l=5$，$r=5$，$\\bigcap_{i=5}^5 E(2,i)$ 为边集 $\\{(2,3),(3,1),(1,5)\\}$，长度为 $6$；\n\n对于第四个询问，$p=3$，$l=3$，$r=4$，$\\bigcap_{i=3}^4 E(3,i)=\\varnothing$，长度为 $0$。\n\n\n---\n\n【数据范围】\n\n**本题采用捆绑测试。**\n\n| 子任务编号 |   $n,q\\leq$    | 特殊性质 | 分值 |\n| :--------: | :------------: | :------: | :--: |\n|     1      |     $10^5$     |  $l=r$   |  8   |\n|     2      |     $10^5$     |  $p=1$   |  20  |\n|     3      |     $10^3$     |    无    |  20  |\n|     4      |     $10^5$     |    无    |  26  |\n|     5      | $2\\times 10^5$ |    无    |  26  |\n\n对于 $100\\%$ 的数据，$1\\leq n,q\\leq 2\\times 10^5$，$1\\leq x,y,p\\leq n$，$1\\leq l\\leq r\\leq n$，$1\\leq w\\leq 10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "\"MdOI R1\" Treequery", "background": "", "description": "Given an undirected tree with $n$ nodes, where each edge has a weight.\n\nLet $E(x,y)$ denote the set of all edges on the simple path between $x$ and $y$ in the tree. In particular, when $x=y$, $E(x,y)=\\varnothing$.\n\nYou need to answer $q$ queries **online**. Each query gives $p,l,r$. Please compute the sum of edge weights of all edges in the set $\\bigcap_{i=l}^r E(p,i)$, i.e. the sum of edge weights contained in the intersection of $E(p, l\\dots r)$.\n\nIn simple terms, you need to find the length of the common part of the simple paths from $p$ to every node in $[l,r]$.", "inputFormat": "The first line contains two integers $n,q$, representing the number of nodes in the tree and the number of queries.\n\nThe next $n-1$ lines each contain three integers $x,y,w$, indicating that there is an edge between $x$ and $y$ with weight $w$.\n\nThe next $q$ lines each contain three integers $p_0,l_0,r_0$. For the $i$-th query, the actual $p,l,r$ are obtained by XOR-ing $p_0,l_0,r_0$ with $lastans$, respectively, where $lastans$ is the answer to the previous query and is initially $0$.", "outputFormat": "For each query, output one integer per line, representing the answer.", "hint": "[Sample 1 Explanation]\n\nThe tree in the sample is shown in the figure:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g6l15zpv.png)\n\nIn the explanations below, all query parameters are the real values after XOR with $lastans$.\n\nFor the first query, $p=2$, $l=3$, $r=5$, and $\\bigcap_{i=3}^5 E(2,i)$ is the edge $(2,3)$, with total length $3$.\n\nFor the second query, $p=1$, $l=2$, $r=4$, and $\\bigcap_{i=2}^4 E(1,i)$ is the edge $(1,3)$, with total length $2$.\n\nFor the third query, $p=2$, $l=5$, $r=5$, and $\\bigcap_{i=5}^5 E(2,i)$ is the edge set $\\{(2,3),(3,1),(1,5)\\}$, with total length $6$.\n\nFor the fourth query, $p=3$, $l=3$, $r=4$, $\\bigcap_{i=3}^4 E(3,i)=\\varnothing$, and the total length is $0$.\n\n---\n\n[Constraints]\n\n**This problem uses bundled testdata.**\n\n| Subtask ID | $n,q\\leq$ | Special Property | Score |\n| :--------: | :-------: | :--------------: | :---: |\n| 1 | $10^5$ | $l=r$ | 8 |\n| 2 | $10^5$ | $p=1$ | 20 |\n| 3 | $10^3$ | None | 20 |\n| 4 | $10^5$ | None | 26 |\n| 5 | $2\\times 10^5$ | None | 26 |\n\nFor $100\\%$ of the data, $1\\leq n,q\\leq 2\\times 10^5$, $1\\leq x,y,p\\leq n$, $1\\leq l\\leq r\\leq n$, and $1\\leq w\\leq 10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "『MdOI R1』Treequery", "background": "", "description": "给定一棵 $n$ 个点的无根树，边有边权。\n\n令 $E(x,y)$ 表示树上 $x,y$ 之间的简单路径上的所有边的集合，特别地，当 $x=y$ 时，$E(x,y) = \\varnothing$。\n\n你需要 **实时** 回答 $q$ 个询问，每个询问给定 $p,l,r$，请你求出集合 $\\bigcap_{i=l}^r E(p,i)$ 中所有边的边权和，即 $E(p, l\\dots r)$ 的交所包含的边的边权和。\n\n通俗的讲，你需要求出 $p$ 到 $[l,r]$ 内每一个点的简单路径的公共部分长度。\n\n", "inputFormat": "第一行两个整数 $n,q$，表示树的结点数和询问数。\n\n接下来 $n-1$ 行，每行三个整数 $x,y,w$，表示 $x$ 与 $y$ 之间有一条权值为 $w$ 的边。\n\n接下来 $q$ 行，每行三个整数 $p_0,l_0,r_0$。第 $i$ 个询问的 $p,l,r$ 分别为 $p_0,l_0,r_0$ 异或上 $lastans$ 的值，其中 $lastans$ 是上次询问的答案，初始时为 $0$。", "outputFormat": "对于每个询问，一行一个整数，表示答案。", "hint": "【样例 1 说明】\n\n样例中的树如图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g6l15zpv.png)\n\n下面解释中的询问参数均为异或 $lastans$ 之后得到的真实值。\n\n对于第一个询问，$p=2$，$l=3$，$r=5$，$\\bigcap_{i=3}^5 E(2,i)$ 为边 $(2,3)$，长度为 $3$。\n\n对于第二个询问，$p=1$，$l=2$，$r=4$，$\\bigcap_{i=2}^4 E(1,i)$ 为边 $(1,3)$，长度为 $2$；\n\n对于第三个询问，$p=2$，$l=5$，$r=5$，$\\bigcap_{i=5}^5 E(2,i)$ 为边集 $\\{(2,3),(3,1),(1,5)\\}$，长度为 $6$；\n\n对于第四个询问，$p=3$，$l=3$，$r=4$，$\\bigcap_{i=3}^4 E(3,i)=\\varnothing$，长度为 $0$。\n\n\n---\n\n【数据范围】\n\n**本题采用捆绑测试。**\n\n| 子任务编号 |   $n,q\\leq$    | 特殊性质 | 分值 |\n| :--------: | :------------: | :------: | :--: |\n|     1      |     $10^5$     |  $l=r$   |  8   |\n|     2      |     $10^5$     |  $p=1$   |  20  |\n|     3      |     $10^3$     |    无    |  20  |\n|     4      |     $10^5$     |    无    |  26  |\n|     5      | $2\\times 10^5$ |    无    |  26  |\n\n对于 $100\\%$ 的数据，$1\\leq n,q\\leq 2\\times 10^5$，$1\\leq x,y,p\\leq n$，$1\\leq l\\leq r\\leq n$，$1\\leq w\\leq 10^4$。", "locale": "zh-CN"}}}
{"pid": "P6072", "type": "P", "difficulty": 6, "samples": [["9\n1 2 1\n1 3 7\n2 4 8\n3 5 3\n4 6 3\n3 7 3\n7 8 5\n7 9 2\n", "21\n"], ["3\n1 2 2\n2 3 1\n", "2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 3000, 3000, 3000, 3000, 3500, 3500, 3500, 3500, 3500, 3500], "memory": [250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000, 250000]}, "tags": ["莫队", "O2优化", "分治", "字典树 Trie"], "title": "『MdOI R1』Path", "background": "", "description": "给定一棵 $n$ 个点的无根树，边有边权。\n\n令 $V(x,y),E(x,y)$ 分别表示树上 $x,y$ 之间的简单路径上的所有点的集合和所有边的集合，特别地，当 $x=y$ 时，$V(x,y) = \\{x\\}$，$E(x,y) = \\varnothing$。\n\n再令边集 $E$ 的权值 $f(E)$ 为 $E$ 中所有边的权值的 **异或和**，当 $E = \\varnothing$ 时，$f(E) = 0$。\n\n现在，要你求出\n$$\n\\max_{1\\le x,y,u,v \\le n,V(x,y)\\cap V(u,v) = \\varnothing}(f(E(x,y)) + f(E(u,v)))\n$$\n通俗的讲，你要选择两条简单路径，满足没有重合的点，且边权异或和之和最大。", "inputFormat": "第一行一个整数 $n$，表示树上点的个数。\n\n接下来 $n-1$ 行，每行三个整数 $x,y,w$，表示编号为 $x$ 和 $y$ 的点之间有一条权值为 $w$ 的边。", "outputFormat": "一行一个整数，表示答案。", "hint": "【样例 1 解释】\n\n样例中的树如图所示，选择标红色和蓝色的两条路径，满足没有重合的点，且边权异或和之和最大，为 $(7\\oplus 1\\oplus 8)+(5\\oplus 2)=21$（其中 $\\oplus$ 表示异或运算）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jen9sxcf.png)\n\n【样例 2 解释】\n\n样例中的树如图所示，为一条链的形状，选择标红色和蓝色的两条路径，蓝色路径退化成了一个点，使异或和之和达到最大值 $2+0=2$。注意红色路径并不能延申到 $3$，否则蓝色路径将无法存在。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1xzo1lh2.png)\n\n---\n\n【数据范围】\n\n**本题采用捆绑测试。**\n\n| 子任务编号 |    $n\\leq$     |  特殊性质   | 分值 | 时限 |\n| :--------: | :------------: | :---------: | :--: | :--: |\n|     1      |      $50$      |     无      |  12  |  1s  |\n|     2      | $2\\times 10^3$ |     无      |  28  |  2s  |\n|     3      | $2\\times 10^4$ | $y = x + 1$ |  20  |  3s  |\n|     4      | $3\\times 10^4$ |     无      |  40  | 3.5s |\n\n对于 $100\\%$ 的数据，$2\\leq n\\leq 3\\times 10^4$，$1\\leq x,y\\leq n$，$0\\leq w\\leq 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "\"MdOI R1\" Path", "background": "", "description": "You are given an undirected tree with $n$ nodes, and each edge has a weight.\n\nLet $V(x,y)$ and $E(x,y)$ denote the set of all nodes and the set of all edges on the simple path between $x$ and $y$ in the tree. In particular, when $x=y$, $V(x,y)=\\{x\\}$ and $E(x,y)=\\varnothing$.\n\nDefine the weight $f(E)$ of an edge set $E$ as the **bitwise XOR sum** of the weights of all edges in $E$. When $E=\\varnothing$, $f(E)=0$.\n\nNow, you need to compute\n$$\n\\max_{1\\le x,y,u,v \\le n,V(x,y)\\cap V(u,v) = \\varnothing}(f(E(x,y)) + f(E(u,v)))\n$$\nIn plain words, you need to choose two simple paths such that they do not share any common nodes, and the sum of their edge-weight XOR values is as large as possible.", "inputFormat": "The first line contains an integer $n$, the number of nodes in the tree.\n\nThe next $n-1$ lines each contain three integers $x,y,w$, indicating that there is an edge of weight $w$ between nodes $x$ and $y$.", "outputFormat": "Output one integer on a single line, the answer.", "hint": "[Sample 1 Explanation]\n\nThe tree in the sample is shown in the figure. Choose the two paths marked in red and blue. They have no common nodes, and the sum of XOR values is maximized, which is $(7\\oplus 1\\oplus 8)+(5\\oplus 2)=21$ (where $\\oplus$ denotes the XOR operation).\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jen9sxcf.png)\n\n[Sample 2 Explanation]\n\nThe tree in the sample is shown in the figure. It is a chain. Choose the red and blue paths; the blue path degenerates into a single node, making the maximum sum of XOR values $2+0=2$. Note that the red path cannot be extended to $3$, otherwise the blue path would not be possible.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1xzo1lh2.png)\n\n---\n\n[Constraints]\n\n**This problem uses bundled testdata.**\n\n| Subtask ID |    $n\\leq$     | Special Property | Score | Time Limit |\n| :--------: | :------------: | :--------------: | :---: | :--------: |\n|     1      |      $50$      |       None       |  12   |    1s      |\n|     2      | $2\\times 10^3$ |       None       |  28   |    2s      |\n|     3      | $2\\times 10^4$ | $y = x + 1$      |  20   |    3s      |\n|     4      | $3\\times 10^4$ |       None       |  40   |   3.5s     |\n\nFor $100\\%$ of the testdata, $2\\leq n\\leq 3\\times 10^4$, $1\\leq x,y\\leq n$, $0\\leq w\\leq 10^9$.\n\n# Input Format\n\nThe first line contains an integer $n$, the number of nodes in the tree.\n\nThe next $n-1$ lines each contain three integers $x,y,w$, indicating that there is an edge of weight $w$ between nodes $x$ and $y$.\n\n# Output Format\n\nOutput one integer on a single line, the answer.\n\n# Hint\n\n[Sample 1 Explanation]\n\nThe tree in the sample is shown in the figure. Choose the two paths marked in red and blue. They have no common nodes, and the sum of XOR values is maximized, which is $(7\\oplus 1\\oplus 8)+(5\\oplus 2)=21$ (where $\\oplus$ denotes the XOR operation).\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jen9sxcf.png)\n\n[Sample 2 Explanation]\n\nThe tree in the sample is shown in the figure. It is a chain. Choose the red and blue paths; the blue path degenerates into a single node, making the maximum sum of XOR values $2+0=2$. Note that the red path cannot be extended to $3$, otherwise the blue path would not be possible.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1xzo1lh2.png)\n\n---\n\n[Constraints]\n\n**This problem uses bundled testdata.**\n\n| Subtask ID |    $n\\leq$     | Special Property | Score | Time Limit |\n| :--------: | :------------: | :--------------: | :---: | :--------: |\n|     1      |      $50$      |       None       |  12   |    1s      |\n|     2      | $2\\times 10^3$ |       None       |  28   |    2s      |\n|     3      | $2\\times 10^4$ | $y = x + 1$      |  20   |    3s      |\n|     4      | $3\\times 10^4$ |       None       |  40   |   3.5s     |\n\nFor $100\\%$ of the testdata, $2\\leq n\\leq 3\\times 10^4$, $1\\leq x,y\\leq n$, $0\\leq w\\leq 10^9$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "『MdOI R1』Path", "background": "", "description": "给定一棵 $n$ 个点的无根树，边有边权。\n\n令 $V(x,y),E(x,y)$ 分别表示树上 $x,y$ 之间的简单路径上的所有点的集合和所有边的集合，特别地，当 $x=y$ 时，$V(x,y) = \\{x\\}$，$E(x,y) = \\varnothing$。\n\n再令边集 $E$ 的权值 $f(E)$ 为 $E$ 中所有边的权值的 **异或和**，当 $E = \\varnothing$ 时，$f(E) = 0$。\n\n现在，要你求出\n$$\n\\max_{1\\le x,y,u,v \\le n,V(x,y)\\cap V(u,v) = \\varnothing}(f(E(x,y)) + f(E(u,v)))\n$$\n通俗的讲，你要选择两条简单路径，满足没有重合的点，且边权异或和之和最大。", "inputFormat": "第一行一个整数 $n$，表示树上点的个数。\n\n接下来 $n-1$ 行，每行三个整数 $x,y,w$，表示编号为 $x$ 和 $y$ 的点之间有一条权值为 $w$ 的边。", "outputFormat": "一行一个整数，表示答案。", "hint": "【样例 1 解释】\n\n样例中的树如图所示，选择标红色和蓝色的两条路径，满足没有重合的点，且边权异或和之和最大，为 $(7\\oplus 1\\oplus 8)+(5\\oplus 2)=21$（其中 $\\oplus$ 表示异或运算）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jen9sxcf.png)\n\n【样例 2 解释】\n\n样例中的树如图所示，为一条链的形状，选择标红色和蓝色的两条路径，蓝色路径退化成了一个点，使异或和之和达到最大值 $2+0=2$。注意红色路径并不能延申到 $3$，否则蓝色路径将无法存在。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1xzo1lh2.png)\n\n---\n\n【数据范围】\n\n**本题采用捆绑测试。**\n\n| 子任务编号 |    $n\\leq$     |  特殊性质   | 分值 | 时限 |\n| :--------: | :------------: | :---------: | :--: | :--: |\n|     1      |      $50$      |     无      |  12  |  1s  |\n|     2      | $2\\times 10^3$ |     无      |  28  |  2s  |\n|     3      | $2\\times 10^4$ | $y = x + 1$ |  20  |  3s  |\n|     4      | $3\\times 10^4$ |     无      |  40  | 3.5s |\n\n对于 $100\\%$ 的数据，$2\\leq n\\leq 3\\times 10^4$，$1\\leq x,y\\leq n$，$0\\leq w\\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P6073", "type": "P", "difficulty": 7, "samples": [["1\n5\n2\n2\n3", "1\n33\n"], ["2\n2\n4 2\n18 7", "440891256\n841247136"], ["4\n2\n4 2\n20 9", "65\n429844531\n"], ["5\n2\n4 2\n30 12", "58\n475486366\n"]], "limits": {"time": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "数学", "组合数学", "Stirling 数", "生成函数", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "『MdOI R1』Epic Convolution", "background": "小 Q 是神仙，尤其喜欢多项式。\n\n这天小 K 问了道题：\n\n给定长度 $n$ 的序列 $g,h$，求 $f$ 满足 $f_n=\\sum\\limits_{k=0}^{n}g_kh_{n-k}$。\n\n小 Q 对小 K 说：你这个菜鸡，这不随便卷一下就行了吗，你 FFT 怎么学的了。\n\n然后小 K 花了一个月学习 FFT 和 NTT。又跑过去问小 Q 一道题：\n\n给定长度 $n$ 的序列 $g,h$，求 $f$ 满足 $f_n=\\sum\\limits_{k=0}^{n}\\binom{n}{k}g_kh_{n-k}$。\n\n小 Q 对小 K 说：你这个菜鸡，这不随便卷一下就行了吗，你 FFT 怎么学的了。\n\n然后小 K 又花了一个月学习 FFT 和 NTT。又跑过去问小 Q 一道题：\n\n给定长度 $n$ 的序列 $g,h$，求 $f$ 满足 $f_n=\\sum\\limits_{k=0}^{n}k^ng_kh_{n-k}$。\n\n小 Q 对小 K 说：你这个菜鸡，这不随便卷一下就行了吗，你 FFT 怎么学的了。\n\n然后他仔细看了一遍，傻眼了，发现他不会这道题。\n\n为了吊打小 K，你需要告诉他 $4$ 个特殊情况的做法。", "description": "给定特定的序列 $g,h$，求 $f_n$ 满足 $f_n=\\sum\\limits_{k=0}^{n}k^ng_kh_{n-k}$。\n\n本题有五个子任务，前四个子任务给定不同形式的 $g,h$，需要求出 $f_n$，第五个子任务不依赖于这个等式，但是形式上与此相似。\n\n**注意，本题所有输出请对 $998244353$（$119\\times 2^{23}+1$，一个质数）取模。**\n\n---\n\n**Subtask 1（4 pts）：**\n\n给定一个 $n$，你需要回答 $q$ 组询问，每组询问给定一个整数 $m$。\n\n每组询问的 $g$ 和 $h$ 如下所示（$0\\leq k\\leq n$）：\n\n$$g_k=\\begin{cases}1,&k<m\\\\0,&k\\geq m\\end{cases}$$\n\n$$h_k=1$$\n\n你需要回答出 $f_n$ 的值。\n\n---\n\n**Subtask 2,3（16,16 pts）：**\n\n这两个子任务给定的序列 $g,h$ 形式相同，但数据范围不同，请仔细阅读数据范围。\n\n你需要回答 $q$ 组询问，每组询问给定两个整数 $n,m$。\n\n每组询问的 $g$ 和 $h$ 如下所示（$0\\leq k\\leq n$）：\n\n$$g_k=\\frac{1}{(k+m+1)!}$$\n\n$$h_k=\\begin{cases}0,&k<m\\\\\\frac{(-1)^{k-m}}{(k-m)!},&k\\geq m\\end{cases}$$\n\n你需要回答出 $f_n$ 的值。\n\n---\n\n**Subtask 4（32 pts）：**\n\n你需要回答 $q$ 组询问，每组询问给定两个整数 $n,m$。\n\n每组询问的 $g$ 和 $h$ 如下所示（$0\\leq k\\leq n$）：\n\n$$g_k=\\frac{k^m}{k!}$$\n\n$$h_k=\\frac{(-1)^k}{k!}$$\n\n你需要回答出 $f_n$ 的值。\n\n---\n\n**Subtask 5（32 pts）：**\n\n你需要回答 $q$ 组询问，每组询问给定两个整数 $n,m$。\n\n**注意下面 $n,m$ 的含义，不要看反。**\n\n$$\\sum\\limits_{k=0}^{m}(k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\sum\\limits_{i=0}^{m-k}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}$$\n\n你需要回答出上面这个式子的值。\n\n与前四个 Subtask 相似之处是，求和的一开始是幂的形式。", "inputFormat": "第一行一个整数 $op$，表示子任务编号。\n\n若 $op=1$：  \n\n第二行一个整数 $n$，第三行一个整数 $q$；  \n\n接下来 $q$ 行，每行一个整数 $m$。\n\n若 $op\\in \\{2,3,4,5\\}$： \n\n第二行一个整数 $q$；  \n\n接下来 $q$ 行：每行两个整数 $n,m$。  \n\n所有变量含义见题目描述。", "outputFormat": "对于每组询问，一行一个整数，表示答案。", "hint": "### 样例解释 1\n\n在这组样例中，需要解决第一个子任务，$n=5,\\ \\ q=2$。\n\n第一组询问中，$m=2$，则（省略了 $0$ 的加数项）：\n\n$$[g_0\\ \\ g_1\\ \\ g_2\\ \\ g_3\\ \\ g_4\\ \\ g_5]=[1\\ \\ 1\\ \\ 0\\ \\ 0\\ \\ 0\\ \\ 0] $$\n\n$$[h_0\\ \\ h_1\\ \\ h_2\\ \\ h_3\\ \\ h_4\\ \\ h_5]=[1\\ \\ 1\\ \\ 1\\ \\ 1\\ \\ 1\\ \\ 1] $$\n\n$$f_5=1^5\\times g_1h_4=1$$\n\n第二组询问中，$m=3$，则：\n\n$$[g_0\\ \\ g_1\\ \\ g_2\\ \\ g_3\\ \\ g_4\\ \\ g_5]=[1\\ \\ 1\\ \\ 1\\ \\ 0\\ \\ 0\\ \\ 0]$$\n\n$$[h_0\\ \\ h_1\\ \\ h_2\\ \\ h_3\\ \\ h_4\\ \\ h_5]=[1\\ \\ 1\\ \\ 1\\ \\ 1\\ \\ 1\\ \\ 1]$$\n\n$$f_5=1^5\\times g_1h_4+2^5\\times g_2h_3=33$$\n\n------\n\n### 样例解释 2\n\n在这组样例中，需要解决第二个子任务，$q=2$。\n\n第一组询问中，$n=4,\\ \\ m=2$，则：\n\n$$[g_0\\ \\ g_1\\ \\ g_2\\ \\ g_3\\ \\ g_4]=[\\dfrac{1}{6}\\ \\ \\dfrac{1}{24}\\ \\ \\dfrac{1}{120}\\ \\ \\dfrac{1}{720}\\ \\ \\dfrac{1}{5040}] $$\n\n$$[h_0\\ \\ h_1\\ \\ h_2\\ \\ h_3\\ \\ h_4]=[0\\ \\ 0\\ \\ 1\\ \\ -1\\ \\ \\dfrac{1}{2}] $$\n\n$$f_4=1^4\\times g_1h_3+2^4\\times g_2h_2=\\dfrac{11}{120} $$\n\n$f_4=\\dfrac{11}{120}$ 对 $998244353$ 取模后等于 $440891256$。\n\n第二组询问范围过大，不进行样例解释。\n\n------\n\n### 样例解释 3\n\n在这组样例中，需要解决第四个子任务，$q=2$。\n\n第一组询问中，$n=4,\\ \\ m=2$，则：\n\n$$[g_0\\ \\ g_1\\ \\ g_2\\ \\ g_3\\ \\ g_4]=[0\\ \\ \\ 1\\ \\ \\ 2\\ \\ \\ \\dfrac{3}{2}\\ \\ \\dfrac{2}{3}] $$\n\n$$[h_0\\ \\ h_1\\ \\ h_2\\ \\ h_3\\ \\ h_4]=[1\\ \\ -1\\ \\ \\dfrac{1}{2}\\ \\ -\\dfrac{1}{6}\\ \\ \\dfrac{1}{24}] $$\n\n$$f_4=1^4\\times g_1h_3+2^4\\times g_2h_2+3^4\\times g_3h_1+4^4\\times g_4h_0=65 $$\n\n第二组询问范围过大，不进行样例解释。\n\n---\n\n### 样例解释 4\n\n在这组样例中，需要解决第五个子任务，$q=2$。\n\n第一组询问中，$n=4,\\ \\ m=2$，则枚举 $k,i$：\n\n$$k=0,\\ \\ i=0:\\ \\ (k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}=\\dfrac{1}{2} $$\n\n$$k=0,\\ \\ i=1:\\ \\ (k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}=9 $$\n\n$$k=0,\\ \\ i=2:\\ \\ (k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}=36 $$\n\n$$k=1,\\ \\ i=0:\\ \\ (k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}=-64 $$\n\n$$k=1\\ \\ i=1:\\ \\ (k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}=-288 $$\n\n$$k=2\\ \\ i=0:\\ \\ (k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}=\\dfrac{729}{2} $$\n\n全部相加，结果为 $58$。\n\n第二组询问范围过大，不进行样例解释。\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试，不同 Subtask 的题意不同。**\n\n| 子任务编号 |    $q\\leq$     |    $n\\leq$     |    $m\\leq$     | 分值 |\n| :--------: | :------------: | :------------: | :------------: | :--: |\n|     1      | $5\\times 10^5$ |     $10^5$     | $\\min(10^5,n)$ |  4   |\n|     2      | $5\\times 10^5$ |     $2\\times 10^5$     |      $20$      |  16  |\n|     3      |      $20$      |  $998244352$   |      $20$      |  16  |\n|     4(31-40)      | $5\\times 10^5$ | $2\\times 10^5$ |      $10$      |  32  |\n|     4(51-60)      | $20$ | $10^{10^5}$ |      $10$      |  32  |\n|     5      | $5\\times 10^5$ | $2\\times 10^3$ | $2\\times 10^3$ |  32  |\n\n所有输入均为正整数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『MdOI R1』Epic Convolution", "background": "小 Q 是神仙，尤其喜欢多项式。\n\n这天小 K 问了道题：\n\n给定长度 $n$ 的序列 $g,h$，求 $f$ 满足 $f_n=\\sum\\limits_{k=0}^{n}g_kh_{n-k}$。\n\n小 Q 对小 K 说：你这个菜鸡，这不随便卷一下就行了吗，你 FFT 怎么学的了。\n\n然后小 K 花了一个月学习 FFT 和 NTT。又跑过去问小 Q 一道题：\n\n给定长度 $n$ 的序列 $g,h$，求 $f$ 满足 $f_n=\\sum\\limits_{k=0}^{n}\\binom{n}{k}g_kh_{n-k}$。\n\n小 Q 对小 K 说：你这个菜鸡，这不随便卷一下就行了吗，你 FFT 怎么学的了。\n\n然后小 K 又花了一个月学习 FFT 和 NTT。又跑过去问小 Q 一道题：\n\n给定长度 $n$ 的序列 $g,h$，求 $f$ 满足 $f_n=\\sum\\limits_{k=0}^{n}k^ng_kh_{n-k}$。\n\n小 Q 对小 K 说：你这个菜鸡，这不随便卷一下就行了吗，你 FFT 怎么学的了。\n\n然后他仔细看了一遍，傻眼了，发现他不会这道题。\n\n为了吊打小 K，你需要告诉他 $4$ 个特殊情况的做法。", "description": "给定特定的序列 $g,h$，求 $f_n$ 满足 $f_n=\\sum\\limits_{k=0}^{n}k^ng_kh_{n-k}$。\n\n本题有五个子任务，前四个子任务给定不同形式的 $g,h$，需要求出 $f_n$，第五个子任务不依赖于这个等式，但是形式上与此相似。\n\n**注意，本题所有输出请对 $998244353$（$119\\times 2^{23}+1$，一个质数）取模。**\n\n---\n\n**Subtask 1（4 pts）：**\n\n给定一个 $n$，你需要回答 $q$ 组询问，每组询问给定一个整数 $m$。\n\n每组询问的 $g$ 和 $h$ 如下所示（$0\\leq k\\leq n$）：\n\n$$g_k=\\begin{cases}1,&k<m\\\\0,&k\\geq m\\end{cases}$$\n\n$$h_k=1$$\n\n你需要回答出 $f_n$ 的值。\n\n---\n\n**Subtask 2,3（16,16 pts）：**\n\n这两个子任务给定的序列 $g,h$ 形式相同，但数据范围不同，请仔细阅读数据范围。\n\n你需要回答 $q$ 组询问，每组询问给定两个整数 $n,m$。\n\n每组询问的 $g$ 和 $h$ 如下所示（$0\\leq k\\leq n$）：\n\n$$g_k=\\frac{1}{(k+m+1)!}$$\n\n$$h_k=\\begin{cases}0,&k<m\\\\\\frac{(-1)^{k-m}}{(k-m)!},&k\\geq m\\end{cases}$$\n\n你需要回答出 $f_n$ 的值。\n\n---\n\n**Subtask 4（32 pts）：**\n\n你需要回答 $q$ 组询问，每组询问给定两个整数 $n,m$。\n\n每组询问的 $g$ 和 $h$ 如下所示（$0\\leq k\\leq n$）：\n\n$$g_k=\\frac{k^m}{k!}$$\n\n$$h_k=\\frac{(-1)^k}{k!}$$\n\n你需要回答出 $f_n$ 的值。\n\n---\n\n**Subtask 5（32 pts）：**\n\n你需要回答 $q$ 组询问，每组询问给定两个整数 $n,m$。\n\n**注意下面 $n,m$ 的含义，不要看反。**\n\n$$\\sum\\limits_{k=0}^{m}(k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\sum\\limits_{i=0}^{m-k}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}$$\n\n你需要回答出上面这个式子的值。\n\n与前四个 Subtask 相似之处是，求和的一开始是幂的形式。", "inputFormat": "第一行一个整数 $op$，表示子任务编号。\n\n若 $op=1$：  \n\n第二行一个整数 $n$，第三行一个整数 $q$；  \n\n接下来 $q$ 行，每行一个整数 $m$。\n\n若 $op\\in \\{2,3,4,5\\}$： \n\n第二行一个整数 $q$；  \n\n接下来 $q$ 行：每行两个整数 $n,m$。  \n\n所有变量含义见题目描述。", "outputFormat": "对于每组询问，一行一个整数，表示答案。", "hint": "### 样例解释 1\n\n在这组样例中，需要解决第一个子任务，$n=5,\\ \\ q=2$。\n\n第一组询问中，$m=2$，则（省略了 $0$ 的加数项）：\n\n$$[g_0\\ \\ g_1\\ \\ g_2\\ \\ g_3\\ \\ g_4\\ \\ g_5]=[1\\ \\ 1\\ \\ 0\\ \\ 0\\ \\ 0\\ \\ 0] $$\n\n$$[h_0\\ \\ h_1\\ \\ h_2\\ \\ h_3\\ \\ h_4\\ \\ h_5]=[1\\ \\ 1\\ \\ 1\\ \\ 1\\ \\ 1\\ \\ 1] $$\n\n$$f_5=1^5\\times g_1h_4=1$$\n\n第二组询问中，$m=3$，则：\n\n$$[g_0\\ \\ g_1\\ \\ g_2\\ \\ g_3\\ \\ g_4\\ \\ g_5]=[1\\ \\ 1\\ \\ 1\\ \\ 0\\ \\ 0\\ \\ 0]$$\n\n$$[h_0\\ \\ h_1\\ \\ h_2\\ \\ h_3\\ \\ h_4\\ \\ h_5]=[1\\ \\ 1\\ \\ 1\\ \\ 1\\ \\ 1\\ \\ 1]$$\n\n$$f_5=1^5\\times g_1h_4+2^5\\times g_2h_3=33$$\n\n------\n\n### 样例解释 2\n\n在这组样例中，需要解决第二个子任务，$q=2$。\n\n第一组询问中，$n=4,\\ \\ m=2$，则：\n\n$$[g_0\\ \\ g_1\\ \\ g_2\\ \\ g_3\\ \\ g_4]=[\\dfrac{1}{6}\\ \\ \\dfrac{1}{24}\\ \\ \\dfrac{1}{120}\\ \\ \\dfrac{1}{720}\\ \\ \\dfrac{1}{5040}] $$\n\n$$[h_0\\ \\ h_1\\ \\ h_2\\ \\ h_3\\ \\ h_4]=[0\\ \\ 0\\ \\ 1\\ \\ -1\\ \\ \\dfrac{1}{2}] $$\n\n$$f_4=1^4\\times g_1h_3+2^4\\times g_2h_2=\\dfrac{11}{120} $$\n\n$f_4=\\dfrac{11}{120}$ 对 $998244353$ 取模后等于 $440891256$。\n\n第二组询问范围过大，不进行样例解释。\n\n------\n\n### 样例解释 3\n\n在这组样例中，需要解决第四个子任务，$q=2$。\n\n第一组询问中，$n=4,\\ \\ m=2$，则：\n\n$$[g_0\\ \\ g_1\\ \\ g_2\\ \\ g_3\\ \\ g_4]=[0\\ \\ \\ 1\\ \\ \\ 2\\ \\ \\ \\dfrac{3}{2}\\ \\ \\dfrac{2}{3}] $$\n\n$$[h_0\\ \\ h_1\\ \\ h_2\\ \\ h_3\\ \\ h_4]=[1\\ \\ -1\\ \\ \\dfrac{1}{2}\\ \\ -\\dfrac{1}{6}\\ \\ \\dfrac{1}{24}] $$\n\n$$f_4=1^4\\times g_1h_3+2^4\\times g_2h_2+3^4\\times g_3h_1+4^4\\times g_4h_0=65 $$\n\n第二组询问范围过大，不进行样例解释。\n\n---\n\n### 样例解释 4\n\n在这组样例中，需要解决第五个子任务，$q=2$。\n\n第一组询问中，$n=4,\\ \\ m=2$，则枚举 $k,i$：\n\n$$k=0,\\ \\ i=0:\\ \\ (k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}=\\dfrac{1}{2} $$\n\n$$k=0,\\ \\ i=1:\\ \\ (k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}=9 $$\n\n$$k=0,\\ \\ i=2:\\ \\ (k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}=36 $$\n\n$$k=1,\\ \\ i=0:\\ \\ (k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}=-64 $$\n\n$$k=1\\ \\ i=1:\\ \\ (k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}=-288 $$\n\n$$k=2\\ \\ i=0:\\ \\ (k+1)^m\\dfrac{(k+1)^{n+1}}{(k+1)!}\\dfrac{\\binom{2n+1}{i}(-1)^{m-k}}{(m-k-i)!(k+1)^i}=\\dfrac{729}{2} $$\n\n全部相加，结果为 $58$。\n\n第二组询问范围过大，不进行样例解释。\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试，不同 Subtask 的题意不同。**\n\n| 子任务编号 |    $q\\leq$     |    $n\\leq$     |    $m\\leq$     | 分值 |\n| :--------: | :------------: | :------------: | :------------: | :--: |\n|     1      | $5\\times 10^5$ |     $10^5$     | $\\min(10^5,n)$ |  4   |\n|     2      | $5\\times 10^5$ |     $2\\times 10^5$     |      $20$      |  16  |\n|     3      |      $20$      |  $998244352$   |      $20$      |  16  |\n|     4(31-40)      | $5\\times 10^5$ | $2\\times 10^5$ |      $10$      |  32  |\n|     4(51-60)      | $20$ | $10^{10^5}$ |      $10$      |  32  |\n|     5      | $5\\times 10^5$ | $2\\times 10^3$ | $2\\times 10^3$ |  32  |\n\n所有输入均为正整数。", "locale": "zh-CN"}}}
{"pid": "P6074", "type": "P", "difficulty": 6, "samples": [["3 1\n2 3 3\n6 6 6\n1 2\n2 3", "0.42"], ["9 2\n9 4 4 1 6 5 1 9 5\n8 3 3 1 5 4 1 8 4\n1 2\n2 3\n3 4\n3 5\n1 6\n6 7\n7 8\n6 9", "1.15"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["点分治", "树形 DP", "分数规划", "树链剖分"], "title": "最小路径", "background": "", "description": "一棵 $n$ 个点的树，每个点两个点权 $a_i$ 和 $b_i$，找一条长度为 $m$ 的简单路径，使 $\\frac{\\sum a_i}{\\sum b_i}$ 最小。无解输出 $-1$。", "inputFormat": "第一行两个正整数 $n$ 和 $m$。  \n第二行 $n$ 个正整数 $a_i$。  \n第三行 $n$ 个正整数 $b_i$。  \n以下 $n-1$ 行，每行两个正整数 $u,v$，为一条边的两个端点。", "outputFormat": "输出最小值，**保留两位小数**。", "hint": "subtask 1 $20$：$n\\le 100$，$m\\le n$，$1\\le a_i,b_i\\le 2000$。\n\nsubtask 2 $40$：$n\\le 10^4$，$m\\le n$，$1\\le a_i,b_i\\le 2000$。\n\nsubtask 3 $40$：$n\\le 2\\times 10^5$，$m\\le n$，$1\\le a_i,b_i\\le 2000$。\n\n对于 $100\\%$ 的数据，$1\\le n\\le 2\\times 10^5$，$1\\le m\\le n$，$1\\le a_i,b_i\\le 2000$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "最小路径", "background": "", "description": "一棵 $n$ 个点的树，每个点两个点权 $a_i$ 和 $b_i$，找一条长度为 $m$ 的简单路径，使 $\\frac{\\sum a_i}{\\sum b_i}$ 最小。无解输出 $-1$。", "inputFormat": "第一行两个正整数 $n$ 和 $m$。  \n第二行 $n$ 个正整数 $a_i$。  \n第三行 $n$ 个正整数 $b_i$。  \n以下 $n-1$ 行，每行两个正整数 $u,v$，为一条边的两个端点。", "outputFormat": "输出最小值，**保留两位小数**。", "hint": "subtask 1 $20$：$n\\le 100$，$m\\le n$，$1\\le a_i,b_i\\le 2000$。\n\nsubtask 2 $40$：$n\\le 10^4$，$m\\le n$，$1\\le a_i,b_i\\le 2000$。\n\nsubtask 3 $40$：$n\\le 2\\times 10^5$，$m\\le n$，$1\\le a_i,b_i\\le 2000$。\n\n对于 $100\\%$ 的数据，$1\\le n\\le 2\\times 10^5$，$1\\le m\\le n$，$1\\le a_i,b_i\\le 2000$。", "locale": "zh-CN"}}}
