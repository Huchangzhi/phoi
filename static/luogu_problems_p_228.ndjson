{"pid": "P5611", "type": "P", "difficulty": 7, "samples": [["6 5\n-1 1 -4 5 -1 4\n1 1 4 5\n1 1 4 514\n2 3 3 3\n1 6 -1 5\n2 5 2 5", "0\n0\n0\n9\n5"]], "limits": {"time": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2013", "O2优化", "Ynoi"], "title": "[Ynoi2013] D2T2", "background": "", "description": "给一个长为 $n$ 的序列，有 $m$ 次查询操作。\n\n查询操作形如 $l\\;r\\;L\\;R$，表示将序列中值在 $[L,R]$ 内的位置保留不变，其他的位置变成 $0$ 时，序列中 $[l,r]$ 区间内的最大子段和，这个子段可以是空的。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示这个序列。\n\n之后 $m$ 行，每行四个整数 $l\\;r\\;L\\;R$ 表示一次查询操作。\n", "outputFormat": "输出 $m$ 行，每行一个整数表示答案。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：ccz181078，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\leq n,m \\le 10^5$，序列中所有数的绝对值 $\\le 10^9$。\n\n第四组查询中，值域限制是 $[-1,5]$，序列为 `-1 1 0 5 -1 4`，区间 $[1,6]$ 的最大子段为 $[2,6]$，和为 $9$。\n\n第五组查询中，值域限制是 $[2,5]$，序列为 `0 0 0 5 0 4`，区间 $[2,5]$ 的最大子段为 $[4,4]$（并列），和为 $5$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2013] D2T2", "background": "", "description": "Given a sequence of length $n$, there are $m$ query operations.\n\nEach query is in the form $l\\;r\\;L\\;R$. It means: keep the positions whose values are in $[L,R]$ unchanged, and set all other positions to $0$. Then, compute the maximum subarray sum within the interval $[l,r]$ of the resulting sequence. This subarray is allowed to be empty.", "inputFormat": "The first line contains two integers $n,m$.\n\nThe second line contains $n$ integers representing the sequence.\n\nThen follow $m$ lines, each containing four integers $l\\;r\\;L\\;R$, representing one query operation.", "outputFormat": "Output $m$ lines, each containing one integer representing the answer.", "hint": "Idea: nzhtl1477, Solution: ccz181078, Code: ccz181078, Data: nzhtl1477.\n\nConstraints: for $100\\%$ of the testdata, $1\\leq n,m \\le 10^5$, and the absolute value of every number in the sequence is $\\le 10^9$.\n\nIn the fourth group of queries, the value range limit is $[-1,5]$, and the sequence becomes `-1 1 0 5 -1 4`. The maximum subarray in interval $[1,6]$ is $[2,6]$, with sum $9$.\n\nIn the fifth group of queries, the value range limit is $[2,5]$, and the sequence becomes `0 0 0 5 0 4`. The maximum subarray in interval $[2,5]$ is $[4,4]$ (tied), with sum $5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2013] D2T2", "background": "", "description": "给一个长为 $n$ 的序列，有 $m$ 次查询操作。\n\n查询操作形如 $l\\;r\\;L\\;R$，表示将序列中值在 $[L,R]$ 内的位置保留不变，其他的位置变成 $0$ 时，序列中 $[l,r]$ 区间内的最大子段和，这个子段可以是空的。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示这个序列。\n\n之后 $m$ 行，每行四个整数 $l\\;r\\;L\\;R$ 表示一次查询操作。\n", "outputFormat": "输出 $m$ 行，每行一个整数表示答案。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：ccz181078，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\leq n,m \\le 10^5$，序列中所有数的绝对值 $\\le 10^9$。\n\n第四组查询中，值域限制是 $[-1,5]$，序列为 `-1 1 0 5 -1 4`，区间 $[1,6]$ 的最大子段为 $[2,6]$，和为 $9$。\n\n第五组查询中，值域限制是 $[2,5]$，序列为 `0 0 0 5 0 4`，区间 $[2,5]$ 的最大子段为 $[4,4]$（并列），和为 $5$。", "locale": "zh-CN"}}}
{"pid": "P5612", "type": "P", "difficulty": 7, "samples": [["5 3\n1 4 2 8 3\n2 1 3\n1 2 4 5\n3 1 2", "6"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000]}, "tags": ["2013", "O2优化", "Ynoi"], "title": "[Ynoi2013] Ynoi", "background": null, "description": "维护一个由 $n$ 个非负整数构成的序列 $a_1,a_2,a_3,\\ldots,a_n$，支持三种操作：\n\n1. 给定区间 $[l,r]$，将对应区间内的数异或上 $x$。\n2. 给定区间 $[l,r]$，将对应区间内的数从小到大排序。\n3. 给定区间 $[l,r]$，求区间内的数的异或和。", "inputFormat": "第一行 $n,m$ 两个整数。\n\n第二行 $n$ 个整数 $a_i$，表示原序列。\n\n接下来 $m$ 行，每行三个整数 $opt,l,r$（$opt\\in\\{2,3\\}$）或四个整数\n $opt,l,r,x$（$opt=1$）表示对应的操作。", "outputFormat": "对每个操作 $3$，输出一行，表示对应的答案。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078&nzhtl1477，Data：ccz181078\n\n### 样例解释\n\n原序列为 $1\\ 4\\ 2\\ 8\\ 3$。\n\n将区间 $[1,3]$ 排序，得到 $[1\\ 2\\ 4]\\ 8\\ 3$。\n\n将区间 $[2,4]$ 与 $5$ 按位取异或，$2\\ \\mathrm{xor}\\ 5 = 7$，$4\\  \\mathrm{xor}\\ 5 = 1$，$8\\ \\mathrm{xor}\\ 5 = 13$，得到 $1\\ [7\\ 1\\ 13]\\ 3$。\n\n查询区间 $[1,2]$ 的异或和，$[1\\ 7]\\ 1\\ 13\\ 3$，$1\\ \\mathrm{xor}\\ 7 = 6$。\n\n### 数据范围\n\n$1 \\le n,m \\le 10^5$，$0 \\le a_i,x<10^8$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2013] Ynoi", "background": "", "description": "Maintain a sequence $a_1,a_2,a_3,\\ldots,a_n$ consisting of $n$ non-negative integers, and support three operations:\n\n1. Given an interval $[l,r]$, apply XOR with $x$ to every number in this interval.\n2. Given an interval $[l,r]$, sort the numbers in this interval in non-decreasing order.\n3. Given an interval $[l,r]$, compute the XOR sum of the numbers in this interval.", "inputFormat": "The first line contains two integers $n,m$.\n\nThe second line contains $n$ integers $a_i$, representing the original sequence.\n\nThe next $m$ lines describe the operations. Each line contains three integers $opt,l,r$ ($opt\\in\\{2,3\\}$), or four integers $opt,l,r,x$ ($opt=1$), representing the corresponding operation.", "outputFormat": "For each operation $3$, output one line with the corresponding answer.", "hint": "Idea: ccz181078, Solution: ccz181078, Code: ccz181078&nzhtl1477, Data: ccz181078.\n\n### Sample Explanation\n\nThe original sequence is $1\\ 4\\ 2\\ 8\\ 3$.\n\nSort the interval $[1,3]$, getting $[1\\ 2\\ 4]\\ 8\\ 3$.\n\nApply bitwise XOR with $5$ to the interval $[2,4]$: $2\\ \\mathrm{xor}\\ 5 = 7$, $4\\  \\mathrm{xor}\\ 5 = 1$, $8\\ \\mathrm{xor}\\ 5 = 13$, getting $1\\ [7\\ 1\\ 13]\\ 3$.\n\nQuery the XOR sum of the interval $[1,2]$: $[1\\ 7]\\ 1\\ 13\\ 3$, $1\\ \\mathrm{xor}\\ 7 = 6$.\n\n### Constraints\n\n$1 \\le n,m \\le 10^5$, $0 \\le a_i,x<10^8$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2013] Ynoi", "background": null, "description": "维护一个由 $n$ 个非负整数构成的序列 $a_1,a_2,a_3,\\ldots,a_n$，支持三种操作：\n\n1. 给定区间 $[l,r]$，将对应区间内的数异或上 $x$。\n2. 给定区间 $[l,r]$，将对应区间内的数从小到大排序。\n3. 给定区间 $[l,r]$，求区间内的数的异或和。", "inputFormat": "第一行 $n,m$ 两个整数。\n\n第二行 $n$ 个整数 $a_i$，表示原序列。\n\n接下来 $m$ 行，每行三个整数 $opt,l,r$（$opt\\in\\{2,3\\}$）或四个整数\n $opt,l,r,x$（$opt=1$）表示对应的操作。", "outputFormat": "对每个操作 $3$，输出一行，表示对应的答案。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078&nzhtl1477，Data：ccz181078\n\n### 样例解释\n\n原序列为 $1\\ 4\\ 2\\ 8\\ 3$。\n\n将区间 $[1,3]$ 排序，得到 $[1\\ 2\\ 4]\\ 8\\ 3$。\n\n将区间 $[2,4]$ 与 $5$ 按位取异或，$2\\ \\mathrm{xor}\\ 5 = 7$，$4\\  \\mathrm{xor}\\ 5 = 1$，$8\\ \\mathrm{xor}\\ 5 = 13$，得到 $1\\ [7\\ 1\\ 13]\\ 3$。\n\n查询区间 $[1,2]$ 的异或和，$[1\\ 7]\\ 1\\ 13\\ 3$，$1\\ \\mathrm{xor}\\ 7 = 6$。\n\n### 数据范围\n\n$1 \\le n,m \\le 10^5$，$0 \\le a_i,x<10^8$。", "locale": "zh-CN"}}}
{"pid": "P5613", "type": "P", "difficulty": 1, "samples": [["10 5 0", "2"], ["31 4 2\n8 13", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "2019", "洛谷原创", "O2优化", "洛谷月赛"], "title": "[MtOI2019] 黑蚊子多", "background": "", "description": "Hikari 的面前有 $n(1\\leq n\\leq 1000)$ 级台阶，每 $1s$ 她可以向上跳 $m(1\\leq m\\leq n)$ 级台阶。（不在中间的台阶上停留）\n\n台阶上有 $k(k\\leq 10)$ 个特殊的平台 $a_i$，Hikari 在该平台 **停留** 时会使得 $m$ 增加 $1$。\n\n请问 Hikari 到达台阶顶部花费的时间。", "inputFormat": "共 $2$ 行。\n\n第 $1$ 行输入 $3$ 个非负整数 $n,m,k$。\n\n第 $2$ 行输入 $k$ 个正整数，第 $i$ 个正整数表示 $a_i$，保证输入的 $a_i$ 单调递增。", "outputFormat": "共 $1$ 行，输出 $1$ 个正整数表示花费的时间。", "hint": "### 子任务\n\n对于 $60\\%$ 的数据，$k=0$。\n\n对于 $100\\%$ 的数据，$1\\leq m\\leq n\\leq 1000$，$k\\leq 10$。\n\n### 题目来源\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22614) T1\n\n出题人：disangan233\n", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2019] Too Many Black Mosquitoes", "background": "", "description": "There are $n(1\\leq n\\leq 1000)$ steps in front of Hikari. Every $1s$, she can jump upward by $m(1\\leq m\\leq n)$ steps (she does not stop on the steps in between).\n\nThere are $k(k\\leq 10)$ special platforms $a_i$ on the steps. When Hikari **stops** on such a platform, $m$ increases by $1$.\n\nAsk for the time Hikari spends to reach the top of the steps.", "inputFormat": "There are $2$ lines in total.\n\nThe first line contains $3$ non-negative integers $n, m, k$.\n\nThe second line contains $k$ positive integers. The $i$-th positive integer is $a_i$. It is guaranteed that the input $a_i$ are strictly increasing.", "outputFormat": "There is $1$ line in total. Output $1$ positive integer, the time spent.", "hint": "### Subtasks\n\nFor $60\\%$ of the testdata, $k = 0$.\n\nFor $100\\%$ of the testdata, $1\\leq m\\leq n\\leq 1000$, $k\\leq 10$.\n\n### Source\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22614) T1\n\nProblem setter: disangan233.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2019] 黑蚊子多", "background": "", "description": "Hikari 的面前有 $n(1\\leq n\\leq 1000)$ 级台阶，每 $1s$ 她可以向上跳 $m(1\\leq m\\leq n)$ 级台阶。（不在中间的台阶上停留）\n\n台阶上有 $k(k\\leq 10)$ 个特殊的平台 $a_i$，Hikari 在该平台 **停留** 时会使得 $m$ 增加 $1$。\n\n请问 Hikari 到达台阶顶部花费的时间。", "inputFormat": "共 $2$ 行。\n\n第 $1$ 行输入 $3$ 个非负整数 $n,m,k$。\n\n第 $2$ 行输入 $k$ 个正整数，第 $i$ 个正整数表示 $a_i$，保证输入的 $a_i$ 单调递增。", "outputFormat": "共 $1$ 行，输出 $1$ 个正整数表示花费的时间。", "hint": "### 子任务\n\n对于 $60\\%$ 的数据，$k=0$。\n\n对于 $100\\%$ 的数据，$1\\leq m\\leq n\\leq 1000$，$k\\leq 10$。\n\n### 题目来源\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22614) T1\n\n出题人：disangan233\n", "locale": "zh-CN"}}}
{"pid": "P5614", "type": "P", "difficulty": 3, "samples": [["5 200\n21 84 198\n38 47 102\n44 47 132 \n63 150 166\n76 79 132", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2019", "洛谷原创", "O2优化", "枚举", "洛谷月赛"], "title": "[MtOI2019] 膜Siyuan", "background": "你强归你强，$\\mathsf S\\mathsf{\\color{red} iyuan}$ 比你强。——$\\mathsf S \\mathsf{\\color{red} iyuan}$\n\ndisangan233 最近发现了一款 OIer 们的游戏：[膜 $\\color{black} \\mathsf S \\mathsf{\\color{red} iyuan}$](https://lmoliver.github.io/mosiyuan/index.html)。\n\n他被里面的「真理 IV」所困惑，于是他找到了你寻求帮助。\n", "description": "给你 $1$ 个正整数 $M$，$n(n\\leq 5)$ 个正整数 $3$ 元组 $\\{a_i,b_i,c_i\\}(a_i,b_i,c_i\\leq M\\leq 2000)$，请你求出所有满足\n\n$$\n\\forall i\\leq n ,s.t.~|a_i-x|\\oplus |b_i-y|\\oplus |c_i-z| = 9\n$$\n\n的**有序**正整数 $3$ 元组 $\\{x,y,z\\}(x,y,z \\leq M)$的个数。\n\n其中，$\\forall$ 表示 \"对于所有\"，$s.t.$ 表示 \"使得\"，$A \\oplus B \\oplus C$ 表示 $A,B,C$ 的异或和。\n\n对于 C++，`A^B^C` 或 `A xor B xor C` 即为 $A \\oplus B \\oplus C$ 的答案 。\n\n这里提供一份模板：\n\n```cpp\nif ((a ^ b ^ c) == 9) \n{\n\tYour code here...\n}\n```\n\n对于 $2$ 个有序 $3$ 元组 $A,B$，如果 $x_A \\not =x_B$ 或 $y_A \\not =y_B$ 或 $z_A \\not =z_B$，$A,B$ 即被视为是不同的。\n", "inputFormat": "共 $n+1$ 行。\n\n第 $1$ 行输入 $2$ 个正整数 $n$，$M$。\n\n接下来 $n$ 行第 $i$ 行输入 $3$ 个正整数 $a_i,b_i,c_i$。", "outputFormat": "共 $1$ 行，输出 $1$ 个非负整数表示所求答案。", "hint": "#### 样例解释 $1$\n\n所有满足条件的 $\\{x,y,z\\}$ 有： \n\n$\\{88,88,120\\}$，$\\{88,104,104\\}$，$\\{120,120,120\\}$ 和 $\\{120,136,104\\}$。\n\n共 $4$ 个。\n\n### 子任务\n\n对于 $10\\%$ 的数据，保证与样例完全一致。\n\n对于 $60\\%$ 的数据，保证 $M\\leq 200$。\n\n对于所有数据，保证 $a_i,b_i,c_i\\leq M\\leq 2000$，$n\\leq 5$。\n\n\n### 题目来源\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22614) T2\n\n出题人：disangan233\n\n验题人：Studying Father\n", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2019] Mo Siyuan", "background": "You are strong if you are strong, but $\\mathsf S\\mathsf{\\color{red} iyuan}$ is stronger than you. ——$\\mathsf S \\mathsf{\\color{red} iyuan}$.\n\nRecently, disangan233 found a game for OIers: [Mo $\\color{black} \\mathsf S \\mathsf{\\color{red} iyuan}$](https://lmoliver.github.io/mosiyuan/index.html).\n\nHe was confused by “Truth IV” in it, so he came to you for help.", "description": "You are given $1$ positive integer $M$ and $n$ $(n\\leq 5)$ positive-integer triples $\\{a_i,b_i,c_i\\}$ $(a_i,b_i,c_i\\leq M\\leq 2000)$. Please find the number of all **ordered** positive-integer triples $\\{x,y,z\\}$ $(x,y,z \\leq M)$ that satisfy:\n\n$$\n\\forall i\\leq n ,s.t.~|a_i-x|\\oplus |b_i-y|\\oplus |c_i-z| = 9\n$$\n\nHere, $\\forall$ means “for all”, $s.t.$ means “such that”, and $A \\oplus B \\oplus C$ is the XOR of $A,B,C$.\n\nIn C++, `A^B^C` or `A xor B xor C` is exactly the value of $A \\oplus B \\oplus C$.\n\nA template is provided here:\n\n```cpp\nif ((a ^ b ^ c) == 9) \n{\n\tYour code here...\n}\n```\n\nFor two ordered triples $A,B$, if $x_A \\not =x_B$ or $y_A \\not =y_B$ or $z_A \\not =z_B$, then $A$ and $B$ are considered different.", "inputFormat": "There are $n+1$ lines in total.\n\nThe first line contains $2$ positive integers $n$ and $M$.\n\nIn the next $n$ lines, the $i$-th line contains $3$ positive integers $a_i,b_i,c_i$.", "outputFormat": "There is $1$ line in total. Output $1$ non-negative integer, which is the required answer.", "hint": "#### Sample Explanation 1\n\nAll $\\{x,y,z\\}$ that satisfy the conditions are:\n\n$\\{88,88,120\\}$, $\\{88,104,104\\}$, $\\{120,120,120\\}$, and $\\{120,136,104\\}$.\n\nThere are $4$ in total.\n\n### Subtasks\n\nFor $10\\%$ of the data, it is guaranteed to be exactly the same as the sample.\n\nFor $60\\%$ of the data, it is guaranteed that $M\\leq 200$.\n\nFor all data, it is guaranteed that $a_i,b_i,c_i\\leq M\\leq 2000$ and $n\\leq 5$.\n\n### Source\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22614) T2.\n\nProblem setter: disangan233.\n\nProblem tester: Studying Father.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2019] 膜Siyuan", "background": "你强归你强，$\\mathsf S\\mathsf{\\color{red} iyuan}$ 比你强。——$\\mathsf S \\mathsf{\\color{red} iyuan}$\n\ndisangan233 最近发现了一款 OIer 们的游戏：[膜 $\\color{black} \\mathsf S \\mathsf{\\color{red} iyuan}$](https://lmoliver.github.io/mosiyuan/index.html)。\n\n他被里面的「真理 IV」所困惑，于是他找到了你寻求帮助。\n", "description": "给你 $1$ 个正整数 $M$，$n(n\\leq 5)$ 个正整数 $3$ 元组 $\\{a_i,b_i,c_i\\}(a_i,b_i,c_i\\leq M\\leq 2000)$，请你求出所有满足\n\n$$\n\\forall i\\leq n ,s.t.~|a_i-x|\\oplus |b_i-y|\\oplus |c_i-z| = 9\n$$\n\n的**有序**正整数 $3$ 元组 $\\{x,y,z\\}(x,y,z \\leq M)$的个数。\n\n其中，$\\forall$ 表示 \"对于所有\"，$s.t.$ 表示 \"使得\"，$A \\oplus B \\oplus C$ 表示 $A,B,C$ 的异或和。\n\n对于 C++，`A^B^C` 或 `A xor B xor C` 即为 $A \\oplus B \\oplus C$ 的答案 。\n\n这里提供一份模板：\n\n```cpp\nif ((a ^ b ^ c) == 9) \n{\n\tYour code here...\n}\n```\n\n对于 $2$ 个有序 $3$ 元组 $A,B$，如果 $x_A \\not =x_B$ 或 $y_A \\not =y_B$ 或 $z_A \\not =z_B$，$A,B$ 即被视为是不同的。\n", "inputFormat": "共 $n+1$ 行。\n\n第 $1$ 行输入 $2$ 个正整数 $n$，$M$。\n\n接下来 $n$ 行第 $i$ 行输入 $3$ 个正整数 $a_i,b_i,c_i$。", "outputFormat": "共 $1$ 行，输出 $1$ 个非负整数表示所求答案。", "hint": "#### 样例解释 $1$\n\n所有满足条件的 $\\{x,y,z\\}$ 有： \n\n$\\{88,88,120\\}$，$\\{88,104,104\\}$，$\\{120,120,120\\}$ 和 $\\{120,136,104\\}$。\n\n共 $4$ 个。\n\n### 子任务\n\n对于 $10\\%$ 的数据，保证与样例完全一致。\n\n对于 $60\\%$ 的数据，保证 $M\\leq 200$。\n\n对于所有数据，保证 $a_i,b_i,c_i\\leq M\\leq 2000$，$n\\leq 5$。\n\n\n### 题目来源\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22614) T2\n\n出题人：disangan233\n\n验题人：Studying Father\n", "locale": "zh-CN"}}}
{"pid": "P5615", "type": "P", "difficulty": 5, "samples": [["5\n1\n2\n3\n4\n5\n\n", "0\n0\n0\n937500007\n562500005"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "数学", "2019", "洛谷原创", "O2优化", "洛谷月赛"], "title": "[MtOI2019] 时间跳跃", "background": "就算知道方法，也绝对不能去改变过去，绝不能将存在的可能性转变为既定的现实，未来是没有人能预测的，是无法重来的，正因如此人们才能接受各种痛苦，不幸与飞来横祸，迈步前进。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tz4v415b.png)", "description": "因为某些原因，Rintaro 欠了 Mayuri 一根香蕉。\n\n为了封上 Mayuri 的嘴，Rintaro 与 Mayuri 约定，只要 Mayuri 答对这个问题，Mayuri 想要多少香蕉都没问题：\n\n---\n\n机关有 $N$ 条秘密通道，第 $i$ 条秘密通道的长度为 $i$，机关会从 $2^n$ 种选择方式种**等概率**随机选出一些秘密通道，如果选出来的这些秘密通道能组成一个凸多边形，那么这个方案的权值就是选出的秘密通道数量，否则权值为 $0$。\n\n那么请你求出选出来秘密通道的权值的期望模 $10^9+7$ 的值。（两种选择秘密通道的方案不同当且仅当存在一个秘密通道，在一个方案中被选择，而在另一个方案中未被选择。注意，空集也算一个方案。）\n\n---\n\nKurisu：这不就只要...\n\nRintaro：助手你闭嘴！\n\nMayuri 在纸上画呀画，结果啥也没画出来，于是 Mayuri 就只能找你帮忙了。", "inputFormat": "输入共 $T+1$ 行。\n\n第一行一个正整数 $T$ 表示有 $T$ 次询问。\n\n接下来 $T$ 行，每行一个正整数表示这一次询问的 $N$。", "outputFormat": "你的输出应该包含一共 $T$ 行，第 $i$ 行一个非负整数表示询问的期望值模 $10^9+7$ 的值。", "hint": "#### 样例解释 1\n\n容易发现，当 $n$ 小于等于 $3$ 的时候是一定无法组成合法的多边形的。\n\n当 $n=4$ 的时候选出来的边长为这些集合的时候是权值不为 $0$ 的：\n\n$\\{1,2,3,4\\}$，$\\{2,3,4\\}$。\n\n答案就是 $\\frac{7}{16} \\equiv 937500007\\ (\\bmod 1000000007)$\n\n当 $n=5$ 的时候选出来的边长为这些集合的时候是权值不为 $0$ 的：\n\n$\\{1,2,3,4\\}$，$\\{2,3,4\\}$，$\\{1,2,3,5\\}$，$\\{2,3,4,5\\}$\n\n$\\{1,3,4,5\\}$，$\\{1,2,4,5\\}$，$\\{2,4,5\\}$，$\\{3,4,5\\}$，$\\{1,2,3,4,5\\}$。\n\n答案就是 $\\frac{34}{32} \\equiv 562500005\\ (\\bmod 1000000007)$\n\n### 子任务\n\n本题采用捆绑测试。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 5000$，$1\\leq T \\leq 5000$\n\n本题共 $5$ 个子任务，各子任务的分值和限制如下：\n\n子任务 $1$（$20$分）：$1 \\leq n \\leq 10$。\n\n子任务 $2$（$30$分）：$1 \\leq n \\leq 20$。\n\n子任务 $3$（$15$分）：$1 \\leq n \\leq 50$。\n\n子任务 $4$（$15$分）：$1 \\leq n \\leq 300$。\n\n子任务 $5$（$20$分）：无特殊限制。\n\n### 题目来源\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22840) T3\n\n出题人：CYJian \n\n验题人：suwAKow\n", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2019] Time Jump", "background": "Even if you know the method, you must never change the past. You must never turn a possible existence into a fixed reality. No one can predict the future, and it cannot be redone. Precisely because of this, people can accept all kinds of pain, misfortune, and sudden disasters, and keep moving forward.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tz4v415b.png)", "description": "For some reason, Rintaro owes Mayuri one banana.\n\nTo shut Mayuri up, Rintaro makes a deal with Mayuri: as long as Mayuri answers this question correctly, Mayuri can have as many bananas as she wants:\n\n---\n\nThere are $N$ secret passages in the mechanism. The length of the $i$-th secret passage is $i$. The mechanism will randomly choose some secret passages from the $2^n$ possible selection plans with **equal probability**. If the selected secret passages can form a convex polygon, then the weight of this plan is the number of selected secret passages; otherwise, the weight is $0$.\n\nNow please compute the expected value of the weight of the selected secret passages modulo $10^9+7$. (Two selection plans are different if and only if there exists a secret passage that is selected in one plan but not selected in the other. Note that the empty set is also a plan.)\n\n---\n\nKurisu: Then isn’t this just...\n\nRintaro: Assistant, shut up!\n\nMayuri drew and drew on the paper, but ended up drawing nothing. So Mayuri can only ask you for help.", "inputFormat": "The input has $T+1$ lines in total.\n\nThe first line contains a positive integer $T$, meaning there are $T$ queries.\n\nThe next $T$ lines each contain one positive integer, representing $N$ for this query.", "outputFormat": "Your output should contain exactly $T$ lines. The $i$-th line contains a non-negative integer representing the expected value for the query modulo $10^9+7$.", "hint": "#### Sample Explanation 1\n\nIt is easy to see that when $n$ is less than or equal to $3$, it is impossible to form a valid polygon.\n\nWhen $n=4$, the following sets of chosen side lengths have non-zero weight:\n\n$\\{1,2,3,4\\}$, $\\{2,3,4\\}$.\n\nThe answer is $\\frac{7}{16} \\equiv 937500007\\ (\\bmod 1000000007)$.\n\nWhen $n=5$, the following sets of chosen side lengths have non-zero weight:\n\n$\\{1,2,3,4\\}$, $\\{2,3,4\\}$, $\\{1,2,3,5\\}$, $\\{2,3,4,5\\}$\n\n$\\{1,3,4,5\\}$, $\\{1,2,4,5\\}$, $\\{2,4,5\\}$, $\\{3,4,5\\}$, $\\{1,2,3,4,5\\}$.\n\nThe answer is $\\frac{34}{32} \\equiv 562500005\\ (\\bmod 1000000007)$.\n\n### Subtasks\n\nThis problem uses bundled testdata.\n\nFor $100\\%$ of the data, $1\\leq n\\leq 5000$, $1\\leq T \\leq 5000$.\n\nThere are $5$ subtasks in total. The score and limits of each subtask are as follows:\n\nSubtask $1$ ($20$ points): $1 \\leq n \\leq 10$.\n\nSubtask $2$ ($30$ points): $1 \\leq n \\leq 20$.\n\nSubtask $3$ ($15$ points): $1 \\leq n \\leq 50$.\n\nSubtask $4$ ($15$ points): $1 \\leq n \\leq 300$.\n\nSubtask $5$ ($20$ points): no special restrictions.\n\n### Source\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22840) T3\n\nProblem setter: CYJian\n\nChecker: suwAKow\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2019] 时间跳跃", "background": "就算知道方法，也绝对不能去改变过去，绝不能将存在的可能性转变为既定的现实，未来是没有人能预测的，是无法重来的，正因如此人们才能接受各种痛苦，不幸与飞来横祸，迈步前进。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tz4v415b.png)", "description": "因为某些原因，Rintaro 欠了 Mayuri 一根香蕉。\n\n为了封上 Mayuri 的嘴，Rintaro 与 Mayuri 约定，只要 Mayuri 答对这个问题，Mayuri 想要多少香蕉都没问题：\n\n---\n\n机关有 $N$ 条秘密通道，第 $i$ 条秘密通道的长度为 $i$，机关会从 $2^n$ 种选择方式种**等概率**随机选出一些秘密通道，如果选出来的这些秘密通道能组成一个凸多边形，那么这个方案的权值就是选出的秘密通道数量，否则权值为 $0$。\n\n那么请你求出选出来秘密通道的权值的期望模 $10^9+7$ 的值。（两种选择秘密通道的方案不同当且仅当存在一个秘密通道，在一个方案中被选择，而在另一个方案中未被选择。注意，空集也算一个方案。）\n\n---\n\nKurisu：这不就只要...\n\nRintaro：助手你闭嘴！\n\nMayuri 在纸上画呀画，结果啥也没画出来，于是 Mayuri 就只能找你帮忙了。", "inputFormat": "输入共 $T+1$ 行。\n\n第一行一个正整数 $T$ 表示有 $T$ 次询问。\n\n接下来 $T$ 行，每行一个正整数表示这一次询问的 $N$。", "outputFormat": "你的输出应该包含一共 $T$ 行，第 $i$ 行一个非负整数表示询问的期望值模 $10^9+7$ 的值。", "hint": "#### 样例解释 1\n\n容易发现，当 $n$ 小于等于 $3$ 的时候是一定无法组成合法的多边形的。\n\n当 $n=4$ 的时候选出来的边长为这些集合的时候是权值不为 $0$ 的：\n\n$\\{1,2,3,4\\}$，$\\{2,3,4\\}$。\n\n答案就是 $\\frac{7}{16} \\equiv 937500007\\ (\\bmod 1000000007)$\n\n当 $n=5$ 的时候选出来的边长为这些集合的时候是权值不为 $0$ 的：\n\n$\\{1,2,3,4\\}$，$\\{2,3,4\\}$，$\\{1,2,3,5\\}$，$\\{2,3,4,5\\}$\n\n$\\{1,3,4,5\\}$，$\\{1,2,4,5\\}$，$\\{2,4,5\\}$，$\\{3,4,5\\}$，$\\{1,2,3,4,5\\}$。\n\n答案就是 $\\frac{34}{32} \\equiv 562500005\\ (\\bmod 1000000007)$\n\n### 子任务\n\n本题采用捆绑测试。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 5000$，$1\\leq T \\leq 5000$\n\n本题共 $5$ 个子任务，各子任务的分值和限制如下：\n\n子任务 $1$（$20$分）：$1 \\leq n \\leq 10$。\n\n子任务 $2$（$30$分）：$1 \\leq n \\leq 20$。\n\n子任务 $3$（$15$分）：$1 \\leq n \\leq 50$。\n\n子任务 $4$（$15$分）：$1 \\leq n \\leq 300$。\n\n子任务 $5$（$20$分）：无特殊限制。\n\n### 题目来源\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22840) T3\n\n出题人：CYJian \n\n验题人：suwAKow\n", "locale": "zh-CN"}}}
{"pid": "P5616", "type": "P", "difficulty": 6, "samples": [["3 998244353\n1 2 3", "24"], ["10 998244353\n1 2 3 4 5 6 7 8 9 10", "516032"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "数学", "2019", "洛谷原创", "O2优化", "期望", "洛谷月赛"], "title": "[MtOI2019] 恶魔之树", "background": "在 Kirito 和 Eugeo 还没有与 Alice 前往北之洞窟的时候，Eugeo 每天只能用龙骨斧砍恶魔之树——基家斯西达……\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/95swctde.png)\n\n~~请忽略bilibili的水印~~", "description": "Kirito 和 Eugeo 每天砍树觉得很无聊，于是开始比谁砍出好声音的次数多。渐渐地，他们发现这样也没有意思了，于是在这个基础上改了一点：\n\n每个人去砍树前，会随机得到一个长度为 $n$ 的数列 $s_1, s_2, \\dots, s_n$ 。最初每个人的得分都是 $1$，当第 $i$ 次砍出了一个好声音时，得分就变成了原来的得分与 $s_i$ 的最小公倍数，也就是常说的 ${\\rm lcm}$。\n\n现在 Kirito 已经得到了一个长度为 $n$ 的数列 $s_1, s_2, \\ldots, s_n$ 。他想知道，如果每一次砍出好声音的概率是 $50\\%$ 时他的期望得分。\n\n由于 Kirito 不想看到小数，所以请你告诉 Kirito 答案乘 $2^n$ 对 $p$ 取模的值。", "inputFormat": "共 $2$ 行。\n\n第 $1$ 行包含 $2$ 个正整数 $n$ 和 $p$ ，代表数列的长度和给定的模数。**保证模数为质数**\n\n第 $2$ 行包含 $n$ 个正整数，第 $i$ 个数代表 $s_i$。", "outputFormat": "共 $1$ 行，包含 $1$ 个正整数，代表得分的期望值乘 $2^n$ 对 $p$ 取模的结果。\n", "hint": "#### 样例解释 1\n\n一共有 $8$ 种情况：\n\n- 没有出现好声音，得分为 $1$，概率为 $\\frac{1}{8}$。\n\n- 只有第一次出现了好声音，得分为 $1$，概率为 $\\frac{1}{8}$。\n\n- 只有第二次出现了好声音，得分为 $2$，概率为 $\\frac{1}{8}$。\n\n- 只有第三次出现了好声音，得分为 $3$，概率为 $\\frac{1}{8}$。\n\n- 只有第三次没有出现好声音，得分为 $\\operatorname{lcm}(1, 2)=2$，概率为 $\\frac{1}{8}$。\n\n- 只有第二次没有出现好声音，得分为 $\\operatorname{lcm}(1, 3)=3$，概率为 $\\frac{1}{8}$。\n\n- 只有第一次没有出现好声音，得分为 $\\operatorname{lcm}(2, 3)=6$，概率为 $\\frac{1}{8}$。\n\n- 每一次都砍出了好声音，得分为 $\\operatorname{lcm}(1, 2, 3)=6$，概率为 $\\frac{1}{8}$。\n\n所以期望值为 $\\frac{1}{8}+\\frac{1}{8}+\\frac{2}{8}+\\frac{3}{8}+\\frac{2}{8}+\\frac{3}{8}+\\frac{6}{8}+\\frac{6}{8}=3$\n\n乘上 $2^3$ 得到答案为 $24$。\n\n### 子任务\n\n本题采用捆绑测试。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 3\\times 10^5$，$10^7 \\leq p \\leq 1.1 \\times 10^9$且$p$为质数，$1\\leq s_i\\leq 300$。\n\n本题共 $7$ 个子任务，各子任务的分值和限制如下：\n\n子任务 $1$（$3$ 分）：$n=1$。\n\n子任务 $2$（$7$ 分）：$n=18$。\n\n子任务 $3$（$10$ 分）：$n=100$，$s$ 中不同的正整数不超过 $18$ 个。\n\n子任务 $4$（$20$ 分）：$n=100$，不存在 $1\\leq i \\neq j \\leq n$，使得 $s_i=s_j$。且保证数据随机。\n\n子任务 $5$（$20$ 分）：$1\\leq s_1, s_2, \\ldots, s_n \\leq 100$。\n\n子任务 $6$（$20$ 分）：$1\\leq n \\leq 10^4$。\n\n子任务 $7$（$20$ 分）：无特殊限制。\n\n------\n\n谨以此题庆祝刀剑10周年。~~好像晚了几个月...~~\n\n\n### 题目来源\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22840) T4\n\n出题人：CYJian \n\n验题人：suwAKow\n", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2019] Demon Tree.", "background": "Before Kirito and Eugeo went with Alice to the Northern Cave, Eugeo could only chop the Demon Tree—Gigas Cedar—every day with the Dragon Bone Axe...\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/95swctde.png)\n\n~~Please ignore bilibili’s watermark.~~", "description": "Kirito and Eugeo felt bored chopping trees every day, so they started competing to see who could produce more “good sounds” while chopping. Gradually, they found this was still not interesting, so they changed the rules a bit based on that:\n\nBefore each person chops the tree, they will randomly get a sequence $s_1, s_2, \\dots, s_n$ of length $n$. At the beginning, everyone’s score is $1$. When a “good sound” occurs on the $i$-th chop, the score becomes the least common multiple of the original score and $s_i$, which is commonly called ${\\rm lcm}$.\n\nNow Kirito has obtained a sequence $s_1, s_2, \\ldots, s_n$ of length $n$. He wants to know his expected score if the probability of getting a “good sound” on each chop is $50\\%$.\n\nSince Kirito does not want to see decimals, please tell Kirito the value of the answer multiplied by $2^n$ modulo $p$.", "inputFormat": "There are $2$ lines in total.\n\nThe $1$-st line contains $2$ positive integers $n$ and $p$, representing the length of the sequence and the given modulus. **It is guaranteed that the modulus is a prime number.**\n\nThe $2$-nd line contains $n$ positive integers. The $i$-th number represents $s_i$.", "outputFormat": "There is $1$ line in total, containing $1$ positive integer, representing the expected score multiplied by $2^n$ modulo $p$.", "hint": "#### Sample Explanation 1\n\nThere are $8$ possible cases in total:\n\n- No “good sound” occurs, the score is $1$, and the probability is $\\frac{1}{8}$.\n\n- Only the first time has a “good sound”, the score is $1$, and the probability is $\\frac{1}{8}$.\n\n- Only the second time has a “good sound”, the score is $2$, and the probability is $\\frac{1}{8}$.\n\n- Only the third time has a “good sound”, the score is $3$, and the probability is $\\frac{1}{8}$.\n\n- Only the third time does not have a “good sound”, the score is $\\operatorname{lcm}(1, 2)=2$, and the probability is $\\frac{1}{8}$.\n\n- Only the second time does not have a “good sound”, the score is $\\operatorname{lcm}(1, 3)=3$, and the probability is $\\frac{1}{8}$.\n\n- Only the first time does not have a “good sound”, the score is $\\operatorname{lcm}(2, 3)=6$, and the probability is $\\frac{1}{8}$.\n\n- Every time produces a “good sound”, the score is $\\operatorname{lcm}(1, 2, 3)=6$, and the probability is $\\frac{1}{8}$.\n\nSo the expected value is $\\frac{1}{8}+\\frac{1}{8}+\\frac{2}{8}+\\frac{3}{8}+\\frac{2}{8}+\\frac{3}{8}+\\frac{6}{8}+\\frac{6}{8}=3$.\n\nAfter multiplying by $2^3$, the answer is $24$.\n\n### Subtasks\n\nThis problem uses bundled test.\n\nFor $100\\%$ of the data, $1\\leq n\\leq 3\\times 10^5$, $10^7 \\leq p \\leq 1.1 \\times 10^9$ and $p$ is a prime number, and $1\\leq s_i\\leq 300$.\n\nThis problem has $7$ subtasks. The score and constraints of each subtask are as follows:\n\nSubtask $1$ ($3$ points): $n=1$.\n\nSubtask $2$ ($7$ points): $n=18$.\n\nSubtask $3$ ($10$ points): $n=100$, and the number of distinct positive integers in $s$ is at most $18$.\n\nSubtask $4$ ($20$ points): $n=100$, and there do not exist $1\\leq i \\neq j \\leq n$ such that $s_i=s_j$. It is also guaranteed that the testdata is random.\n\nSubtask $5$ ($20$ points): $1\\leq s_1, s_2, \\ldots, s_n \\leq 100$.\n\nSubtask $6$ ($20$ points): $1\\leq n \\leq 10^4$.\n\nSubtask $7$ ($20$ points): No special constraints.\n\n------\n\nThis problem is dedicated to celebrating the 10th anniversary of Sword Art Online. ~~Seems like it is a few months late...~~\n\n### Source\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22840) T4\n\nProblem setter: CYJian.\n\nProblem reviewer: suwAKow.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2019] 恶魔之树", "background": "在 Kirito 和 Eugeo 还没有与 Alice 前往北之洞窟的时候，Eugeo 每天只能用龙骨斧砍恶魔之树——基家斯西达……\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/95swctde.png)\n\n~~请忽略bilibili的水印~~", "description": "Kirito 和 Eugeo 每天砍树觉得很无聊，于是开始比谁砍出好声音的次数多。渐渐地，他们发现这样也没有意思了，于是在这个基础上改了一点：\n\n每个人去砍树前，会随机得到一个长度为 $n$ 的数列 $s_1, s_2, \\dots, s_n$ 。最初每个人的得分都是 $1$，当第 $i$ 次砍出了一个好声音时，得分就变成了原来的得分与 $s_i$ 的最小公倍数，也就是常说的 ${\\rm lcm}$。\n\n现在 Kirito 已经得到了一个长度为 $n$ 的数列 $s_1, s_2, \\ldots, s_n$ 。他想知道，如果每一次砍出好声音的概率是 $50\\%$ 时他的期望得分。\n\n由于 Kirito 不想看到小数，所以请你告诉 Kirito 答案乘 $2^n$ 对 $p$ 取模的值。", "inputFormat": "共 $2$ 行。\n\n第 $1$ 行包含 $2$ 个正整数 $n$ 和 $p$ ，代表数列的长度和给定的模数。**保证模数为质数**\n\n第 $2$ 行包含 $n$ 个正整数，第 $i$ 个数代表 $s_i$。", "outputFormat": "共 $1$ 行，包含 $1$ 个正整数，代表得分的期望值乘 $2^n$ 对 $p$ 取模的结果。\n", "hint": "#### 样例解释 1\n\n一共有 $8$ 种情况：\n\n- 没有出现好声音，得分为 $1$，概率为 $\\frac{1}{8}$。\n\n- 只有第一次出现了好声音，得分为 $1$，概率为 $\\frac{1}{8}$。\n\n- 只有第二次出现了好声音，得分为 $2$，概率为 $\\frac{1}{8}$。\n\n- 只有第三次出现了好声音，得分为 $3$，概率为 $\\frac{1}{8}$。\n\n- 只有第三次没有出现好声音，得分为 $\\operatorname{lcm}(1, 2)=2$，概率为 $\\frac{1}{8}$。\n\n- 只有第二次没有出现好声音，得分为 $\\operatorname{lcm}(1, 3)=3$，概率为 $\\frac{1}{8}$。\n\n- 只有第一次没有出现好声音，得分为 $\\operatorname{lcm}(2, 3)=6$，概率为 $\\frac{1}{8}$。\n\n- 每一次都砍出了好声音，得分为 $\\operatorname{lcm}(1, 2, 3)=6$，概率为 $\\frac{1}{8}$。\n\n所以期望值为 $\\frac{1}{8}+\\frac{1}{8}+\\frac{2}{8}+\\frac{3}{8}+\\frac{2}{8}+\\frac{3}{8}+\\frac{6}{8}+\\frac{6}{8}=3$\n\n乘上 $2^3$ 得到答案为 $24$。\n\n### 子任务\n\n本题采用捆绑测试。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 3\\times 10^5$，$10^7 \\leq p \\leq 1.1 \\times 10^9$且$p$为质数，$1\\leq s_i\\leq 300$。\n\n本题共 $7$ 个子任务，各子任务的分值和限制如下：\n\n子任务 $1$（$3$ 分）：$n=1$。\n\n子任务 $2$（$7$ 分）：$n=18$。\n\n子任务 $3$（$10$ 分）：$n=100$，$s$ 中不同的正整数不超过 $18$ 个。\n\n子任务 $4$（$20$ 分）：$n=100$，不存在 $1\\leq i \\neq j \\leq n$，使得 $s_i=s_j$。且保证数据随机。\n\n子任务 $5$（$20$ 分）：$1\\leq s_1, s_2, \\ldots, s_n \\leq 100$。\n\n子任务 $6$（$20$ 分）：$1\\leq n \\leq 10^4$。\n\n子任务 $7$（$20$ 分）：无特殊限制。\n\n------\n\n谨以此题庆祝刀剑10周年。~~好像晚了几个月...~~\n\n\n### 题目来源\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22840) T4\n\n出题人：CYJian \n\n验题人：suwAKow\n", "locale": "zh-CN"}}}
{"pid": "P5617", "type": "P", "difficulty": 7, "samples": [["8 5 2\n1 3 7 11 15 21 27 33", "62.83185307"], ["8 5 8\n1 3 7 11 15 21 27 33", "686.19551835"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "数学", "计算几何", "2019", "洛谷原创", "Special Judge", "O2优化", "洛谷月赛"], "title": "[MtOI2019] 不可视境界线", "background": "「爆ぜろリアル！弾けろシナプス！パニッシュメント......ディス、ワールド！」  \n「爆裂吧，现实！粉碎吧，精神！放逐这个世界！」  \n", "description": "Rikka 坚信，她的父亲在「不可视境界线」中，等待着她的到来。在 Rikka 的梦里，「不可视境界线」出现了，那是 $n$ 个圆组成的图形。\n\n具体地，有一个平面直角坐标系，坐标系的 $x$ 轴上有 $n$ 个点，第 $i$ 个点的坐标为 $(x_i,0)$。\n\nRikka 以每一个点作为圆心，作了 $n$ 个半径为 $r$ 的圆。她本想让你帮她计算这 $n$ 个圆的面积并，但是这个问题太简单了。\n\n在一番思考后，Rikka 想让你计算出选出 $k$ 个圆后（即删除 $n-k$ 个圆），圆的面积并的最大值。\n\n对于所有数据，有 $n,k\\leq 10^5$，$r\\leq 10^4$，$0\\leq x_i\\leq 10^9$，$x_i$ 为整数且不重复。保证输入的 $x_i$ 单调递增。\n\n因为答案太大了，Rikka 考虑到你的电脑无法保持高精度，所以只要你的答案与标准答案的 **相对误差** 小于 $5\\times 10^{-8}$，你的答案即被视为是正确的。\n\n经过误差分析，本题保证使用原生 `cmath` 函数不会出错，请注意控制程序精度误差。\n", "inputFormat": "共 $2$ 行。\n\n第 $1$ 行输入 $3$ 个整数 $n$，$k$，$r$。\n\n第 $2$ 行输入 $n$ 个整数 $x_1\\ldots x_n$。\n", "outputFormat": "一行 $1$ 个实数，表示所求答案，保证答案小于 $10^{14}$。\n", "hint": "#### 样例解释 1\n\n显然，可以选出 $5$ 个不相交的半径为 $2$ 的圆。\n\n### 子任务\n\n对于 $100\\%$ 的数据，$n,k\\leq 10^5$，$r\\leq 10^4$，$0\\leq x_i\\leq 10^9$。\n\n本题采用捆绑测试，共有 $7$ 个子任务，各子任务的分值和限制如下：\n\n子任务 $1$（$11$ 分）：$k=n$。\n\n子任务 $2$（$13$ 分）：$n,k,r \\leq 100$。\n\n子任务 $3$（$6$ 分）：$n,k \\leq 1000$，$r\\leq 20$。\n\n子任务 $4$（$15$ 分）：$n,k,r \\leq 2000$，保证数据随机生成。\n\n子任务 $5$（$23$ 分）：$r\\leq 20$。\n\n子任务 $6$（$12$ 分）：$k\\leq 20$，$x_n \\leq kr$。\n\n子任务 $7$（$20$ 分）：无特殊限制。\n\n### 题目来源\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22840) T5\n\n出题人：disangan233\n\n验题人：suwAKow，_sys\n", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2019] Invisible Boundary Line", "background": "「爆ぜろリアル！弾けろシナプス！パニッシュメント......ディス、ワールド！」  \n「Explode, reality! Shatter, mind! Banish this world!」", "description": "Rikka firmly believes that her father is waiting for her inside the “Invisible Boundary Line”. In Rikka’s dream, the “Invisible Boundary Line” appeared as a figure made up of $n$ circles.\n\nSpecifically, there is a Cartesian coordinate system. On the $x$-axis, there are $n$ points, and the $i$-th point is $(x_i,0)$.\n\nUsing each point as a center, Rikka drew $n$ circles with radius $r$. She originally wanted you to help her compute the union area of these $n$ circles, but that problem is too easy.\n\nAfter some thought, Rikka wants you to compute the maximum possible union area of the circles after selecting $k$ circles (i.e., deleting $n-k$ circles).\n\nFor all testdata, $n,k\\leq 10^5$, $r\\leq 10^4$, $0\\leq x_i\\leq 10^9$, $x_i$ are integers and pairwise distinct. It is guaranteed that the input $x_i$ are strictly increasing.\n\nBecause the answer is very large, and Rikka thinks your computer cannot maintain high precision, your answer will be considered correct as long as its **relative error** is less than $5\\times 10^{-8}$ compared to the standard answer.\n\nAfter error analysis, this problem guarantees that using the native `cmath` functions will not cause issues. Please pay attention to controlling precision errors in your program.", "inputFormat": "There are $2$ lines in total.\n\nLine $1$ contains $3$ integers $n$, $k$, and $r$.\n\nLine $2$ contains $n$ integers $x_1\\ldots x_n$.", "outputFormat": "Output one real number in one line, representing the required answer. It is guaranteed that the answer is less than $10^{14}$.", "hint": "#### Sample Explanation 1\n\nObviously, you can choose $5$ non-overlapping circles with radius $2$.\n\n### Subtasks\n\nFor $100\\%$ of the testdata, $n,k\\leq 10^5$, $r\\leq 10^4$, $0\\leq x_i\\leq 10^9$.\n\nThis problem uses bundled tests. There are $7$ subtasks, and the score and constraints of each subtask are as follows:\n\nSubtask $1$ ($11$ points): $k=n$.\n\nSubtask $2$ ($13$ points): $n,k,r \\leq 100$.\n\nSubtask $3$ ($6$ points): $n,k \\leq 1000$, $r\\leq 20$.\n\nSubtask $4$ ($15$ points): $n,k,r \\leq 2000$, and the testdata are guaranteed to be randomly generated.\n\nSubtask $5$ ($23$ points): $r\\leq 20$.\n\nSubtask $6$ ($12$ points): $k\\leq 20$, $x_n \\leq kr$.\n\nSubtask $7$ ($20$ points): no special constraints.\n\n### Source\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22840) T5\n\nProblem setter: disangan233\n\nProblem reviewer: suwAKow, _sys\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2019] 不可视境界线", "background": "「爆ぜろリアル！弾けろシナプス！パニッシュメント......ディス、ワールド！」  \n「爆裂吧，现实！粉碎吧，精神！放逐这个世界！」  \n", "description": "Rikka 坚信，她的父亲在「不可视境界线」中，等待着她的到来。在 Rikka 的梦里，「不可视境界线」出现了，那是 $n$ 个圆组成的图形。\n\n具体地，有一个平面直角坐标系，坐标系的 $x$ 轴上有 $n$ 个点，第 $i$ 个点的坐标为 $(x_i,0)$。\n\nRikka 以每一个点作为圆心，作了 $n$ 个半径为 $r$ 的圆。她本想让你帮她计算这 $n$ 个圆的面积并，但是这个问题太简单了。\n\n在一番思考后，Rikka 想让你计算出选出 $k$ 个圆后（即删除 $n-k$ 个圆），圆的面积并的最大值。\n\n对于所有数据，有 $n,k\\leq 10^5$，$r\\leq 10^4$，$0\\leq x_i\\leq 10^9$，$x_i$ 为整数且不重复。保证输入的 $x_i$ 单调递增。\n\n因为答案太大了，Rikka 考虑到你的电脑无法保持高精度，所以只要你的答案与标准答案的 **相对误差** 小于 $5\\times 10^{-8}$，你的答案即被视为是正确的。\n\n经过误差分析，本题保证使用原生 `cmath` 函数不会出错，请注意控制程序精度误差。\n", "inputFormat": "共 $2$ 行。\n\n第 $1$ 行输入 $3$ 个整数 $n$，$k$，$r$。\n\n第 $2$ 行输入 $n$ 个整数 $x_1\\ldots x_n$。\n", "outputFormat": "一行 $1$ 个实数，表示所求答案，保证答案小于 $10^{14}$。\n", "hint": "#### 样例解释 1\n\n显然，可以选出 $5$ 个不相交的半径为 $2$ 的圆。\n\n### 子任务\n\n对于 $100\\%$ 的数据，$n,k\\leq 10^5$，$r\\leq 10^4$，$0\\leq x_i\\leq 10^9$。\n\n本题采用捆绑测试，共有 $7$ 个子任务，各子任务的分值和限制如下：\n\n子任务 $1$（$11$ 分）：$k=n$。\n\n子任务 $2$（$13$ 分）：$n,k,r \\leq 100$。\n\n子任务 $3$（$6$ 分）：$n,k \\leq 1000$，$r\\leq 20$。\n\n子任务 $4$（$15$ 分）：$n,k,r \\leq 2000$，保证数据随机生成。\n\n子任务 $5$（$23$ 分）：$r\\leq 20$。\n\n子任务 $6$（$12$ 分）：$k\\leq 20$，$x_n \\leq kr$。\n\n子任务 $7$（$20$ 分）：无特殊限制。\n\n### 题目来源\n\n[MtOI2019 Extra Round](https://www.luogu.org/contest/22840) T5\n\n出题人：disangan233\n\n验题人：suwAKow，_sys\n", "locale": "zh-CN"}}}
{"pid": "P5618", "type": "P", "difficulty": 6, "samples": [["3 3\n1 2\n2 1\n3 1 2\nQ 1 3\nC 1 2 2 2 3\nQ 2 3", "7\n5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2015", "各省省选", "山东"], "title": "[SDOI2015] 道路修建", "background": "", "description": "某国有 $2N$ 个城市，这 $2N$ 个城市构成了一个 $2$ 行 $N$ 列的方格网。现在该国政府有一个旅游发展计划，这个计划需要选定 $L$、$R$ 两列 $(L \\leq  R)$，修建若干条专用道路，使得这两列之间（包括这两列）的所有 $2(R-L+1)$ 个城市中每个城市可以只通过专用道路就可以到达这 $2(R-L+1)$ 个城市中的任何一个城市。这种专用道路只能在同一行相邻两列的城市或者同一列的两个城市之间修建，且修建需要花费一定的费用。\n\n由于该国政府决定尽量缩减开支，因此政府决定，选定 $L$、$R$ 后，只修建 $2(R-L+1)-1$ 条专用道路，使得这些专用道路构成一个树结构。现在你需要帮助该国政府写一个程序，完成这个任务。具体地，该任务包含 $M$ 个操作，每个操作的格式如下：\n\n1. ``C x0 y0 x1 y1 w``：由于重新对第 $x_0$ 行第 $y_0$ 列的城市和第 $x_1$ 行第 $y_1$ 列的城市之间的情况进行了考察，它们之间修建一条专用道路的花费变成了 $w$；\n\n2. ``Q L R``：若政府选定的两列分别为 $L$、$R$，询问政府的最小开支。", "inputFormat": "第一行，两个整数 $N$、$M$。  \n\n第二行，$N-1$ 个整数，其中第 $i$ 个整数表示初始时第 $1$ 行第 $i$ 列的城市和第 $1$ 行第 $i+1$ 列的城市之间修建一条专用道路的费用。  \n\n第三行，$N-1$ 个整数，其中第 $i$ 个整数表示初始时第 $2$ 行第 $i$ 列的城市和第 $2$ 行第 $i+1$ 列的城市之间修建一条专用道路的费用。  \n\n第四行，$N$ 个整数，其中第 $i$个整数表示初始时第 $1$ 行第 $i$ 列的城市和第 $2$ 行第 $i$ 列的城市之间修建一条专用道路的费用。  \n接下来的 $M$ 行，每行一个操作。", "outputFormat": "对于每个询问操作，输出一行，表示你计算出的政府的最小开支。", "hint": "对于全部的数据，$1 \\leq N, M \\leq 60000$，任何时刻任何一条专用道路的修建费用不超过 $10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2015] Road Construction", "background": "", "description": "A certain country has $2N$ cities. These $2N$ cities form a $2$-row, $N$-column grid. The government now has a tourism development plan: it needs to choose two columns $L$ and $R$ $(L \\leq R)$, and build some dedicated roads so that among all $2(R-L+1)$ cities between these two columns (including these two columns), every city can reach any other of these $2(R-L+1)$ cities using only the dedicated roads.\n\nA dedicated road can only be built between two cities in the same row and adjacent columns, or between the two cities in the same column, and building a road costs some amount.\n\nSince the government wants to reduce expenses as much as possible, after choosing $L$ and $R$, it will build only $2(R-L+1)-1$ dedicated roads, so that these roads form a tree structure. Now you need to help the government write a program to complete this task.\n\nSpecifically, the task contains $M$ operations, each in one of the following formats:\n\n1. `C x0 y0 x1 y1 w`: Because the situation between the city at row $x_0$, column $y_0$ and the city at row $x_1$, column $y_1$ has been re-evaluated, the cost to build a dedicated road between them becomes $w$.\n\n2. `Q L R`: If the government chooses columns $L$ and $R$, ask for the minimum total expense.", "inputFormat": "The first line contains two integers $N$ and $M$.\n\nThe second line contains $N-1$ integers. The $i$-th integer indicates the initial cost to build a dedicated road between the city at row $1$, column $i$ and the city at row $1$, column $i+1$.\n\nThe third line contains $N-1$ integers. The $i$-th integer indicates the initial cost to build a dedicated road between the city at row $2$, column $i$ and the city at row $2$, column $i+1$.\n\nThe fourth line contains $N$ integers. The $i$-th integer indicates the initial cost to build a dedicated road between the city at row $1$, column $i$ and the city at row $2$, column $i$.\n\nThe next $M$ lines each contain one operation.", "outputFormat": "For each query operation, output one line containing the minimum expense you computed for the government.", "hint": "For all testdata, $1 \\leq N, M \\leq 60000$, and at any time, the construction cost of any dedicated road does not exceed $10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2015] 道路修建", "background": "", "description": "某国有 $2N$ 个城市，这 $2N$ 个城市构成了一个 $2$ 行 $N$ 列的方格网。现在该国政府有一个旅游发展计划，这个计划需要选定 $L$、$R$ 两列 $(L \\leq  R)$，修建若干条专用道路，使得这两列之间（包括这两列）的所有 $2(R-L+1)$ 个城市中每个城市可以只通过专用道路就可以到达这 $2(R-L+1)$ 个城市中的任何一个城市。这种专用道路只能在同一行相邻两列的城市或者同一列的两个城市之间修建，且修建需要花费一定的费用。\n\n由于该国政府决定尽量缩减开支，因此政府决定，选定 $L$、$R$ 后，只修建 $2(R-L+1)-1$ 条专用道路，使得这些专用道路构成一个树结构。现在你需要帮助该国政府写一个程序，完成这个任务。具体地，该任务包含 $M$ 个操作，每个操作的格式如下：\n\n1. ``C x0 y0 x1 y1 w``：由于重新对第 $x_0$ 行第 $y_0$ 列的城市和第 $x_1$ 行第 $y_1$ 列的城市之间的情况进行了考察，它们之间修建一条专用道路的花费变成了 $w$；\n\n2. ``Q L R``：若政府选定的两列分别为 $L$、$R$，询问政府的最小开支。", "inputFormat": "第一行，两个整数 $N$、$M$。  \n\n第二行，$N-1$ 个整数，其中第 $i$ 个整数表示初始时第 $1$ 行第 $i$ 列的城市和第 $1$ 行第 $i+1$ 列的城市之间修建一条专用道路的费用。  \n\n第三行，$N-1$ 个整数，其中第 $i$ 个整数表示初始时第 $2$ 行第 $i$ 列的城市和第 $2$ 行第 $i+1$ 列的城市之间修建一条专用道路的费用。  \n\n第四行，$N$ 个整数，其中第 $i$个整数表示初始时第 $1$ 行第 $i$ 列的城市和第 $2$ 行第 $i$ 列的城市之间修建一条专用道路的费用。  \n接下来的 $M$ 行，每行一个操作。", "outputFormat": "对于每个询问操作，输出一行，表示你计算出的政府的最小开支。", "hint": "对于全部的数据，$1 \\leq N, M \\leq 60000$，任何时刻任何一条专用道路的修建费用不超过 $10^4$。", "locale": "zh-CN"}}}
{"pid": "P5619", "type": "P", "difficulty": 5, "samples": [["2 1\n1 2\n2 1\n1", "14445614"], ["5 3\n4 4 3 4 5\n1 2\n3 2\n2 4\n5 4\n3\n2\n1", "16251447"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "洛谷原创"], "title": "[DBOI2019] 持矢", "background": "```cpp\n吾射不亦精乎？\n——doby\n```", "description": "$doby$是一个弓箭手，他很喜欢拿箭。\n\n这天，他来到一个射箭场，发现射箭场老板放好了$n$个靶子（从$1-n$标号），中间画了$n-1$条线，使得这$n$格靶子和$n-1$条线组成了一个**根为**$1$的树。每个靶子上都有分数。\n\n他为了历练自己，选择了一个点（称为父点），然后对它子树（包括它）的每个靶子射一次，每个靶子射中概率为$50\\%$。每次射完一个子树，他获得的总分为射中的所有靶子的分数之**积**。\n\n现在他想知道，选择不同的点作为父点，他期望总分为多少？由于总分可能很大，你需要把结果对$19260817$（质数）取模。", "inputFormat": "输入两个正整数，靶子总数$n$和询问次数$m$。\n\n接下来一行，$n$个正整数，表示编号为$1-n$的靶子的分数。\n\n接下来$n-1$行，每行两个数$u,v$，描述树的一条无向边。\n\n接下来$m$行，每行一个正整数$x(1\\leq x\\leq n)$，表示询问以靶子$x$为父节点时，$doby$期望获得的总分。", "outputFormat": "输出一行，一个正整数$out$。\n\n为了减少输出，定义$out$为对于每组询问，期望获得的总分之和。由于是期望，需要你在计算$\\frac{a}{b}$时，将其改为$a*b^{-1} mod (19260817)$。你需要把输出$out$也对$19260817$取模。", "hint": "### 注意：由于模数较大，请注意求逆元时中间结果的溢出。\n\n如果你不需要卡常，使用快速幂求逆元就够用了。\n\n【样例#$1$说明】\n\n答案为$\\frac{5}{4}$，可能的总分有$0$，$1$，$2$。\n\n【样例#$2$说明】\n\n答案分别为$9630410$、$10834247$、$15047607$，即$\\frac{3}{2}$、$\\frac{599}{16}$、$\\frac{2999}{32}$。\n\n$Subtask$ #$1$（$10$分）： \n\n$1\\leq n,m\\leq 10$。\n\n$Subtask$ #$2$（$40$分）： \n\n$1\\leq n,m\\leq 10^5$。\n\n$Subtask$ #$3$（$50$分）： \n\n$1\\leq n,m\\leq 2 \\times 10^6$。\n\n所有测试点的时间限制统一为$1.5s$，内存限制统一为$125M$。\n\n### 题目提供者：$1jia1$", "locale": "zh-CN", "translations": {"en": {"title": "[DBOI2019] Holding Arrows", "background": "```cpp\nIs my shooting not precise?\n——doby\n```", "description": "$doby$ is an archer, and he really likes holding arrows.\n\nOne day, he came to an archery range and found that the owner had set up $n$ targets (numbered from $1-n$). Between them, $n-1$ lines were drawn so that the $n$ targets and the $n-1$ lines form a tree rooted at $1$. Each target has a score value.\n\nTo train himself, he chooses a node (called the parent node), then shoots once at every target in its subtree (including itself). Each target is hit with probability $50\\%$. After finishing shooting a subtree, the total score he gets is the product of the scores of all targets that were hit.\n\nNow he wants to know: if he chooses different nodes as the parent node, what is his expected total score? Since the total score may be very large, you need to take the result modulo $19260817$ (a prime).", "inputFormat": "The first line contains two positive integers $n$ and $m$, the number of targets and the number of queries.\n\nThe next line contains $n$ positive integers, representing the scores of targets numbered $1-n$.\n\nThe next $n-1$ lines each contain two integers $u,v$, describing an undirected edge of the tree.\n\nThe next $m$ lines each contain one positive integer $x(1\\leq x\\leq n)$, meaning a query for the expected total score that $doby$ obtains when target $x$ is chosen as the parent node.", "outputFormat": "Output one line with one positive integer $out$.\n\nTo reduce output, define $out$ as the sum of the expected total scores over all queries. Since this is an expectation, when computing $\\frac{a}{b}$, you should compute it as $a*b^{-1} mod (19260817)$. You also need to take $out$ modulo $19260817$.", "hint": "### Note: Since the modulus is large, be careful about overflow of intermediate results when computing modular inverses.\n\nIf you do not need extreme optimization, using fast exponentiation to compute modular inverses is enough.\n\n[Sample #$1$ Explanation]\n\nThe answer is $\\frac{5}{4}$. The possible total scores are $0$, $1$, and $2$.\n\n[Sample #$2$ Explanation]\n\nThe answers are $9630410$, $10834247$, and $15047607$, i.e. $\\frac{3}{2}$, $\\frac{599}{16}$, and $\\frac{2999}{32}$.\n\n$Subtask$ #$1$ ($10$ points):\n\n$1\\leq n,m\\leq 10$.\n\n$Subtask$ #$2$ ($40$ points):\n\n$1\\leq n,m\\leq 100000$.\n\n$Subtask$ #$3$ ($50$ points):\n\n$1\\leq n,m\\leq 2000000$.\n\nFor all test points, the time limit is $1.5s$, and the memory limit is $125M$.\n\n### Problem setter: $1jia1$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[DBOI2019] 持矢", "background": "```cpp\n吾射不亦精乎？\n——doby\n```", "description": "$doby$是一个弓箭手，他很喜欢拿箭。\n\n这天，他来到一个射箭场，发现射箭场老板放好了$n$个靶子（从$1-n$标号），中间画了$n-1$条线，使得这$n$格靶子和$n-1$条线组成了一个**根为**$1$的树。每个靶子上都有分数。\n\n他为了历练自己，选择了一个点（称为父点），然后对它子树（包括它）的每个靶子射一次，每个靶子射中概率为$50\\%$。每次射完一个子树，他获得的总分为射中的所有靶子的分数之**积**。\n\n现在他想知道，选择不同的点作为父点，他期望总分为多少？由于总分可能很大，你需要把结果对$19260817$（质数）取模。", "inputFormat": "输入两个正整数，靶子总数$n$和询问次数$m$。\n\n接下来一行，$n$个正整数，表示编号为$1-n$的靶子的分数。\n\n接下来$n-1$行，每行两个数$u,v$，描述树的一条无向边。\n\n接下来$m$行，每行一个正整数$x(1\\leq x\\leq n)$，表示询问以靶子$x$为父节点时，$doby$期望获得的总分。", "outputFormat": "输出一行，一个正整数$out$。\n\n为了减少输出，定义$out$为对于每组询问，期望获得的总分之和。由于是期望，需要你在计算$\\frac{a}{b}$时，将其改为$a*b^{-1} mod (19260817)$。你需要把输出$out$也对$19260817$取模。", "hint": "### 注意：由于模数较大，请注意求逆元时中间结果的溢出。\n\n如果你不需要卡常，使用快速幂求逆元就够用了。\n\n【样例#$1$说明】\n\n答案为$\\frac{5}{4}$，可能的总分有$0$，$1$，$2$。\n\n【样例#$2$说明】\n\n答案分别为$9630410$、$10834247$、$15047607$，即$\\frac{3}{2}$、$\\frac{599}{16}$、$\\frac{2999}{32}$。\n\n$Subtask$ #$1$（$10$分）： \n\n$1\\leq n,m\\leq 10$。\n\n$Subtask$ #$2$（$40$分）： \n\n$1\\leq n,m\\leq 10^5$。\n\n$Subtask$ #$3$（$50$分）： \n\n$1\\leq n,m\\leq 2 \\times 10^6$。\n\n所有测试点的时间限制统一为$1.5s$，内存限制统一为$125M$。\n\n### 题目提供者：$1jia1$", "locale": "zh-CN"}}}
{"pid": "P5620", "type": "P", "difficulty": 5, "samples": [["5 5 7\n3 1 1 2 2\n5 4 2 5 4\n1 2 2 2 4\n-1 2 2 4 4\n2 2 2 4 3\n7 1 4 3 4\n0 1 3 5 4", "21\n8\n40"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "洛谷原创"], "title": "[DBOI2019] 捡币", "background": "> 众所周知，以津真天世界第一可爱。\n> ——1jia1\n\n你正在打不氪金手游 yys，这时家长进来了，于是你装作在打数据结构题。\n\n![](https://cdn.luogu.com.cn/upload/pic/71004.png)", "description": "由于你在 $n$ 次十连抽后没钱了，于是你应以津真天的邀请去参加一个活动。\n\n这个活动是在一个 $n\\times n$ 的矩形区域中进行的，进行若干秒。第 $i$ 秒，主办方会在这个矩形中选择一块小的区域，在每格上面分别撒币。\n\n捡币的规则是这样的：从左上角 $(1,1)$ 出发，走一条抵达  $(n,n)$ 的路径，每次只能从当前格子下面或右边的格子走，并捡起这个区域的金币。\n\n你需要知道，在某一秒某个矩形区域中拥有最多金币的格子有多少金币，某个矩形区域中的金币总数，以及第 $m$ 秒后（如果有撒币操作则先撒币）开始最多能捡多少币。捡币过程中，场上金币数量不会变化，你可以认为这是在 1s 内完成的。", "inputFormat": "第一行，输入整数 $n,m,Q\\ (m\\leq\\text{撒币操作数量})$。\n\n接下来 $Q$ 行，输入五个整数 $u,x1,y1,x2,y2$。（$0<x1\\leq x2\\leq n$，$0<y1\\leq y2\\leq n$，$-1\\leq u\\leq10$）。\n\n- 若 $u>0$，则代表撒币操作，指左上、右下端点分别为 $(x1,y1),(x2,y2)$ 的矩形撒了 $u$ 元的币，撒币的时间依次增加（也就是说第一次撒币操作在第一秒，第二次撒币操作在第二秒，……）。\n- 若 $u=0$，则为查大操作，指询问直到上一次撒币操作后，两端点为 $(x1,y1),(x2,y2)$ 的矩形中最大的金币值为多少。（具体意思见题目描述）\n- 若 $u=-1$，则为查和操作，指询问直到上一次撒币操作后，两端点为 $(x1,y1),(x2,y2)$ 的矩形中金币值的总和。", "outputFormat": "输出若干行。\n\n前面几行输出一个整数，即每次查询的结果。\n\n最后一行输出你在第$m$秒时，撒完币后捡币能获得的最多的金币。", "hint": "【样例 #1 说明】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ngd0lgmf.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/b3aeyq7f.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/c45m09ft.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jrgxj4ty.png)\n\n### 数据范围及约定\n\n- Subtask #1（$20$分）：$1\\leq n\\leq 10$, $1\\leq Q\\leq 1000$。\n- Subtask #2（$20$分）：$1\\leq n\\leq 1000$, $1\\leq Q\\leq 10$。\n- Subtask #3（$20$分）：$1\\leq n\\leq 100$, $1\\leq Q\\leq 1000$。\n- Subtask #4（$40$分）：$1\\leq n\\leq 1000$, $1\\leq Q\\leq 10000$。\n\n", "locale": "zh-CN", "translations": {"en": {"title": "[DBOI2019] Coin Picking.", "background": "> As everyone knows, Itsumade is the cutest in the world.\n> ——1jia1\n\nYou are playing the non-pay-to-win mobile game yys. At this moment, your parents walk in, so you pretend you are working on a data structure problem.\n\n![](https://cdn.luogu.com.cn/upload/pic/71004.png)", "description": "After $n$ ten-pulls, you have run out of money, so you accept Itsumade’s invitation to join an event.\n\nThis event takes place in an $n \\times n$ rectangular area and lasts for several seconds. At second $i$, the organizer chooses a small sub-rectangle inside it and drops coins onto each cell in that sub-rectangle.\n\nThe rules for picking coins are as follows: start from the top-left corner $(1,1)$ and walk along a path that reaches $(n,n)$. Each move can only go to the cell below or to the cell on the right of the current cell, and you pick up the coins in the visited cells.\n\nYou need to find: at some moment, within a given rectangular area, how many coins are on the cell with the most coins; the total number of coins in a given rectangular area; and after second $m$ (if there is a coin-dropping operation at that time, drop coins first), the maximum number of coins you can pick up. During the picking process, the amount of coins on the board does not change; you may assume this is completed within $1$ second.", "inputFormat": "The first line contains integers $n, m, Q\\ (m\\leq\\text{number of coin-dropping operations})$.\n\nThe next $Q$ lines each contain five integers $u, x1, y1, x2, y2$ ($0 < x1 \\leq x2 \\leq n$, $0 < y1 \\leq y2 \\leq n$, $-1 \\leq u \\leq 10$).\n\n- If $u > 0$, it is a coin-dropping operation: $u$ coins are added to every cell in the rectangle with top-left and bottom-right corners $(x1,y1)$ and $(x2,y2)$. The time of coin-dropping operations increases in order (that is, the first coin-dropping operation happens at the first second, the second at the second second, ...).\n- If $u = 0$, it is a max query operation: ask, after the most recent coin-dropping operation, what is the maximum coin value among all cells in the rectangle with corners $(x1,y1)$ and $(x2,y2)$. (See the description for the exact meaning.)\n- If $u = -1$, it is a sum query operation: ask, after the most recent coin-dropping operation, what is the total sum of coin values of all cells in the rectangle with corners $(x1,y1)$ and $(x2,y2)$.", "outputFormat": "Output several lines.\n\nThe first several lines each output one integer, which is the answer to each query.\n\nThe last line outputs the maximum number of coins you can obtain by picking coins after dropping coins at second $m$.", "hint": "【Sample #1 Explanation】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ngd0lgmf.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/b3aeyq7f.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/c45m09ft.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jrgxj4ty.png)\n\n### Constraints and Notes\n\n- Subtask #1 ($20$ points): $1 \\leq n \\leq 10$, $1 \\leq Q \\leq 1000$.\n- Subtask #2 ($20$ points): $1 \\leq n \\leq 1000$, $1 \\leq Q \\leq 10$.\n- Subtask #3 ($20$ points): $1 \\leq n \\leq 100$, $1 \\leq Q \\leq 1000$.\n- Subtask #4 ($40$ points): $1 \\leq n \\leq 1000$, $1 \\leq Q \\leq 10000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[DBOI2019] 捡币", "background": "> 众所周知，以津真天世界第一可爱。\n> ——1jia1\n\n你正在打不氪金手游 yys，这时家长进来了，于是你装作在打数据结构题。\n\n![](https://cdn.luogu.com.cn/upload/pic/71004.png)", "description": "由于你在 $n$ 次十连抽后没钱了，于是你应以津真天的邀请去参加一个活动。\n\n这个活动是在一个 $n\\times n$ 的矩形区域中进行的，进行若干秒。第 $i$ 秒，主办方会在这个矩形中选择一块小的区域，在每格上面分别撒币。\n\n捡币的规则是这样的：从左上角 $(1,1)$ 出发，走一条抵达  $(n,n)$ 的路径，每次只能从当前格子下面或右边的格子走，并捡起这个区域的金币。\n\n你需要知道，在某一秒某个矩形区域中拥有最多金币的格子有多少金币，某个矩形区域中的金币总数，以及第 $m$ 秒后（如果有撒币操作则先撒币）开始最多能捡多少币。捡币过程中，场上金币数量不会变化，你可以认为这是在 1s 内完成的。", "inputFormat": "第一行，输入整数 $n,m,Q\\ (m\\leq\\text{撒币操作数量})$。\n\n接下来 $Q$ 行，输入五个整数 $u,x1,y1,x2,y2$。（$0<x1\\leq x2\\leq n$，$0<y1\\leq y2\\leq n$，$-1\\leq u\\leq10$）。\n\n- 若 $u>0$，则代表撒币操作，指左上、右下端点分别为 $(x1,y1),(x2,y2)$ 的矩形撒了 $u$ 元的币，撒币的时间依次增加（也就是说第一次撒币操作在第一秒，第二次撒币操作在第二秒，……）。\n- 若 $u=0$，则为查大操作，指询问直到上一次撒币操作后，两端点为 $(x1,y1),(x2,y2)$ 的矩形中最大的金币值为多少。（具体意思见题目描述）\n- 若 $u=-1$，则为查和操作，指询问直到上一次撒币操作后，两端点为 $(x1,y1),(x2,y2)$ 的矩形中金币值的总和。", "outputFormat": "输出若干行。\n\n前面几行输出一个整数，即每次查询的结果。\n\n最后一行输出你在第$m$秒时，撒完币后捡币能获得的最多的金币。", "hint": "【样例 #1 说明】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ngd0lgmf.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/b3aeyq7f.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/c45m09ft.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jrgxj4ty.png)\n\n### 数据范围及约定\n\n- Subtask #1（$20$分）：$1\\leq n\\leq 10$, $1\\leq Q\\leq 1000$。\n- Subtask #2（$20$分）：$1\\leq n\\leq 1000$, $1\\leq Q\\leq 10$。\n- Subtask #3（$20$分）：$1\\leq n\\leq 100$, $1\\leq Q\\leq 1000$。\n- Subtask #4（$40$分）：$1\\leq n\\leq 1000$, $1\\leq Q\\leq 10000$。\n\n", "locale": "zh-CN"}}}
{"pid": "P5621", "type": "P", "difficulty": 6, "samples": [["5\n1 9 3 6 233\n0 8 3 7 666\n-3 9 4 2 810\n2 3 3 3 -100\n1 8 8 9 603", "1269"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "2019", "洛谷原创", "cdq 分治", "动态规划优化"], "title": "[DBOI2019] 德丽莎世界第一可爱", "background": ">众所周知，德丽莎世界第一可爱。\n>\n>——zhengrunzhe\n\n\n你正在打崩坏 3，突然家长来了，于是你装作在打数据结构题。\n\n![神恩颂歌](https://cdn.luogu.com.cn/upload/pic/70922.png)", "description": "有 $n$ 个崩坏兽，每个崩坏兽有五个属性值：health 生命力，energy 能量力，attack 攻击力，defense 防御力， collapse 崩坏能。对于第 $i$ 只崩坏兽，以上五种属性分别以首字母记为 $H_i$、$E_i$、$A_i$、$D_i$ 和 $C_i$。\n\n德丽莎可以任选一只崩坏兽展开攻击。假如她干掉了崩坏兽 $i$ 那么她会收获 $C_i$ 的可爱值。由于德丽莎越战越勇，她打的下一只崩坏兽 $j$ 需要满足 $H_j \\ge H_i, E_j \\ge E_i,  A_j \\ge A_i, D_j \\ge D_i$。\n\n请你帮帮德丽莎计算一下她能够获得的最大可爱值。", "inputFormat": "第一行一个正整数 $n$。\n\n接下来 $n$ 行，第 $i+1$ 行五个整数 $H_i, E_i, A_i, D_i,C_i$，代表着第 $i$ 只崩坏兽的属性值。", "outputFormat": "一行一个整数，代表最大可爱值（必须击杀至少一只崩坏兽），答案保证不会超过 long long 范围（$2^{63}-1$）。", "hint": "| Subtask 编号 | $n \\le$ | 分值 |\n|:-:|:-:|:-:|\n| $1$ | $100$ | $20$ |\n| $2$ | $10^4$ | $20$ |\n| $3$ | $5 \\times 10^4$ | $60$ |\n\n对于 $100\\%$ 的数据，满足 $1\\leq n\\leq 50000, -10^9\\le H_i,E_i,A_i,D_i,C_i\\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[DBOI2019] Theresa Is the Cutest in the World", "background": ">As everyone knows, Theresa is the cutest in the world.\n>\n>——zhengrunzhe\n\nYou are playing Honkai Impact 3, and suddenly your parents come in, so you pretend you are working on a data structure problem.\n\n![Divine Prayer](https://cdn.luogu.com.cn/upload/pic/70922.png)", "description": "There are $n$ Honkai beasts. Each Honkai beast has five attributes: health, energy, attack, defense, and collapse energy. For the $i$-th Honkai beast, denote these five attributes by their initials as $H_i$, $E_i$, $A_i$, $D_i$, and $C_i$.\n\nTheresa may choose any Honkai beast to attack first. If she kills Honkai beast $i$, she gains $C_i$ cuteness points. Since Theresa gets stronger as she fights, the next Honkai beast $j$ she fights must satisfy $H_j \\ge H_i$, $E_j \\ge E_i$, $A_j \\ge A_i$, and $D_j \\ge D_i$.\n\nPlease help Theresa compute the maximum total cuteness points she can obtain.", "inputFormat": "The first line contains a positive integer $n$.\n\nThe next $n$ lines: on line $i+1$, there are five integers $H_i, E_i, A_i, D_i, C_i$, representing the attribute values of the $i$-th Honkai beast.", "outputFormat": "Output one integer, representing the maximum cuteness points (she must kill at least one Honkai beast). The answer is guaranteed not to exceed the range of long long ($2^{63}-1$).", "hint": "| Subtask ID | $n \\le$ | Score |\n|:-:|:-:|:-:|\n| $1$ | $100$ | $20$ |\n| $2$ | $10^4$ | $20$ |\n| $3$ | $5 \\times 10^4$ | $60$ |\n\nFor $100\\%$ of the testdata, it holds that $1 \\le n \\le 50000$, and $-10^9 \\le H_i, E_i, A_i, D_i, C_i \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[DBOI2019] 德丽莎世界第一可爱", "background": ">众所周知，德丽莎世界第一可爱。\n>\n>——zhengrunzhe\n\n\n你正在打崩坏 3，突然家长来了，于是你装作在打数据结构题。\n\n![神恩颂歌](https://cdn.luogu.com.cn/upload/pic/70922.png)", "description": "有 $n$ 个崩坏兽，每个崩坏兽有五个属性值：health 生命力，energy 能量力，attack 攻击力，defense 防御力， collapse 崩坏能。对于第 $i$ 只崩坏兽，以上五种属性分别以首字母记为 $H_i$、$E_i$、$A_i$、$D_i$ 和 $C_i$。\n\n德丽莎可以任选一只崩坏兽展开攻击。假如她干掉了崩坏兽 $i$ 那么她会收获 $C_i$ 的可爱值。由于德丽莎越战越勇，她打的下一只崩坏兽 $j$ 需要满足 $H_j \\ge H_i, E_j \\ge E_i,  A_j \\ge A_i, D_j \\ge D_i$。\n\n请你帮帮德丽莎计算一下她能够获得的最大可爱值。", "inputFormat": "第一行一个正整数 $n$。\n\n接下来 $n$ 行，第 $i+1$ 行五个整数 $H_i, E_i, A_i, D_i,C_i$，代表着第 $i$ 只崩坏兽的属性值。", "outputFormat": "一行一个整数，代表最大可爱值（必须击杀至少一只崩坏兽），答案保证不会超过 long long 范围（$2^{63}-1$）。", "hint": "| Subtask 编号 | $n \\le$ | 分值 |\n|:-:|:-:|:-:|\n| $1$ | $100$ | $20$ |\n| $2$ | $10^4$ | $20$ |\n| $3$ | $5 \\times 10^4$ | $60$ |\n\n对于 $100\\%$ 的数据，满足 $1\\leq n\\leq 50000, -10^9\\le H_i,E_i,A_i,D_i,C_i\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5622", "type": "P", "difficulty": 6, "samples": [["4 7\n1 1 2\n1 1 3\n1 3 4\n2 1 1\n2 1 2\n3 1 4\n3 3 4", "3\n0"], ["4 8\n2 1 629\n3 3 1\n2 4 923\n1 4 2\n2 4 542\n2 1 918\n1 2 3\n3 4 3\n", "0\n5\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "洛谷原创", "动态树 LCT"], "title": "[DBOI2019] 巫女的职责", "background": "作为八重村的巫女，樱承担着守卫村庄的责任，村子里受到了崩坏的威胁，八重樱，出击！\n\n![bachongyingyingying](http://i0.hdslb.com/bfs/article/81e9465c02e29053f9fbe7c70d3c2644691abda2.png)", "description": "八重古村有 $n$ 座房屋，一开始所有的房子之间都没有路，随着古村的发展，慢慢会出现连接两栋房屋的双向道路。\n\n村民们原本过着无忧无虑的幸福生活，直到与文明作对——崩坏来了，慢慢地，某栋房屋也许会在遭受崩坏兽的侵袭，每只崩坏兽都有着一定的崩坏能，每户人家也许会存在着多只崩坏兽。\n\n樱来了，她接受了驱魔委托，每个委托都是从驱逐某个房子到另一个房子的崩坏兽，樱只能走已有的路，由于这样的路径也许有很多条，聪明的樱只会选择在它们所有路径中都会走过的某些点，即必经点，每次委托樱会在两点间的所有必经点驱魔。", "inputFormat": "第一行两个整数：$n,m$ 表示房屋数和事件数\n\n接下来 $m$ 行，每行三个正整数：$opt,x,y$\n\n$opt=1 $时，表示房子 $x$ 和房子 $y$ 间修了一条双向道路(保证没有重边，但不保证没有自环，如有请忽略。)\n\n$opt=2$ 时，表示房子 $x$ 来了一只崩坏能为 $y$ 的崩坏兽\n\n$opt=3$ 时，表示樱完成了一次从 $x$ 到 $y$ 的驱魔委托(不保证 $x$ 与 $y$ 连通，不连通输出 $0$ 即可)\n\n强制在线：记上次$3$的答案为 $\\text{lastans}$，初值为 $0$，实际上的$x,y$ 用函数解码：\n```cpp\ninline const void decode(int &x)\n{\n\tx^=lastans%n;\n\tif (x>n)x%=n;\n\tif (!x)x=1;\n}\n```", "outputFormat": "对于每个 $3$ 事件，输出一行一个数表示樱清除的崩坏能的值，答案保证在 $[0,2^{63})$", "hint": "【样例 $1$ 说明】\n\n第四个事件使 $1$ 号房屋有 $1$ 点的崩坏能。\n\n第五个事件使 $1$ 号房屋增加了 $2$ 点的崩坏能，此时其崩坏能值为 $3$。\n\n第六个事件显然答案为 $3$，更新 $\\text{lastans}=3$ 。\n\n第七个事件真实的 $x=1$，$y=3$，由于第六个事件已经在 $1$ 驱魔，所以没有崩坏能。\n\n$Subtask$ #$1$（$20$ 分）： \n\n$1\\leq n,m\\leq 100000$。\n\n$Subtask$ #$2$（$70$ 分）： \n\n$1\\leq n,m\\leq 200000$。\n\n$Subtask$ #$3$（$10$ 分）： \n\n$1\\leq n,m\\leq 500000$。\n\n所有测试点的时间限制统一为 $1.5 \\text s$，内存限制统一为 $125 \\text{MiB}$。\n\n### 题目提供者：[$\\color{red}{zhengrunzhe}$](https://www.luogu.org/space/show?uid=14374)", "locale": "zh-CN", "translations": {"en": {"title": "[DBOI2019] The Miko’s Duty.", "background": "As the miko of Yae Village, Sakura takes on the responsibility of guarding the village. The village is threatened by the Honkai. Yae Sakura, sortie!\n\n![bachongyingyingying](http://i0.hdslb.com/bfs/article/81e9465c02e29053f9fbe7c70d3c2644691abda2.png)", "description": "There are $n$ houses in the ancient Yae Village. At the beginning, there are no roads between any houses. As the village develops, undirected roads connecting two houses will gradually be built.\n\nThe villagers originally lived a carefree and happy life, until they went against civilization—the Honkai came. Gradually, some house may be attacked by Honkai beasts. Each Honkai beast has a certain amount of Honkai energy, and there may be multiple Honkai beasts in a single house.\n\nSakura has arrived. She accepts exorcism commissions. Each commission is to drive out the Honkai beasts from one house to another house. Sakura can only walk along existing roads. Since there may be many different paths, the smart Sakura will only choose some nodes that are passed by on all possible paths between them, i.e. mandatory nodes. For each commission, Sakura exorcises on all mandatory nodes on all paths between the two given houses.", "inputFormat": "The first line contains two integers: $n,m$, representing the number of houses and the number of events.\n\nThe next $m$ lines each contain three positive integers: $opt,x,y$.\n\nWhen $opt=1$, it means an undirected road is built between house $x$ and house $y$ (it is guaranteed that there are no multiple edges, but self-loops are not forbidden; if there is one, ignore it).\n\nWhen $opt=2$, it means a Honkai beast with Honkai energy $y$ comes to house $x$.\n\nWhen $opt=3$, it means Sakura completes an exorcism commission from $x$ to $y$ (it is not guaranteed that $x$ and $y$ are connected; if they are not connected, just output $0$).\n\nForced online: let the answer of the last type $3$ event be $\\text{lastans}$, with initial value $0$. The actual $x,y$ are decoded by the following function:\n```cpp\ninline const void decode(int &x)\n{\n\tx^=lastans%n;\n\tif (x>n)x%=n;\n\tif (!x)x=1;\n}\n```", "outputFormat": "For each type $3$ event, output one number per line representing the amount of Honkai energy cleared by Sakura. The answer is guaranteed to be in $[0,2^{63})$.", "hint": "[Sample $1$ Explanation]\n\nThe 4th event makes house $1$ have $1$ point of Honkai energy.\n\nThe 5th event increases the Honkai energy of house $1$ by $2$, so its Honkai energy becomes $3$.\n\nFor the 6th event, the answer is clearly $3$, and update $\\text{lastans}=3$.\n\nIn the 7th event, the real $x=1$, $y=3$. Since the 6th event has already exorcised at $1$, there is no Honkai energy.\n\n$Subtask$ #$1$ ($20$ points):\n\n$1\\leq n,m\\leq 100000$.\n\n$Subtask$ #$2$ ($70$ points):\n\n$1\\leq n,m\\leq 200000$.\n\n$Subtask$ #$3$ ($10$ points):\n\n$1\\leq n,m\\leq 500000$.\n\nFor all test points, the time limit is $1.5 \\text s$, and the memory limit is $125 \\text{MiB}$.\n\n### Problem Provider: [$\\color{red}{zhengrunzhe}$](https://www.luogu.org/space/show?uid=14374)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[DBOI2019] 巫女的职责", "background": "作为八重村的巫女，樱承担着守卫村庄的责任，村子里受到了崩坏的威胁，八重樱，出击！\n\n![bachongyingyingying](http://i0.hdslb.com/bfs/article/81e9465c02e29053f9fbe7c70d3c2644691abda2.png)", "description": "八重古村有 $n$ 座房屋，一开始所有的房子之间都没有路，随着古村的发展，慢慢会出现连接两栋房屋的双向道路。\n\n村民们原本过着无忧无虑的幸福生活，直到与文明作对——崩坏来了，慢慢地，某栋房屋也许会在遭受崩坏兽的侵袭，每只崩坏兽都有着一定的崩坏能，每户人家也许会存在着多只崩坏兽。\n\n樱来了，她接受了驱魔委托，每个委托都是从驱逐某个房子到另一个房子的崩坏兽，樱只能走已有的路，由于这样的路径也许有很多条，聪明的樱只会选择在它们所有路径中都会走过的某些点，即必经点，每次委托樱会在两点间的所有必经点驱魔。", "inputFormat": "第一行两个整数：$n,m$ 表示房屋数和事件数\n\n接下来 $m$ 行，每行三个正整数：$opt,x,y$\n\n$opt=1 $时，表示房子 $x$ 和房子 $y$ 间修了一条双向道路(保证没有重边，但不保证没有自环，如有请忽略。)\n\n$opt=2$ 时，表示房子 $x$ 来了一只崩坏能为 $y$ 的崩坏兽\n\n$opt=3$ 时，表示樱完成了一次从 $x$ 到 $y$ 的驱魔委托(不保证 $x$ 与 $y$ 连通，不连通输出 $0$ 即可)\n\n强制在线：记上次$3$的答案为 $\\text{lastans}$，初值为 $0$，实际上的$x,y$ 用函数解码：\n```cpp\ninline const void decode(int &x)\n{\n\tx^=lastans%n;\n\tif (x>n)x%=n;\n\tif (!x)x=1;\n}\n```", "outputFormat": "对于每个 $3$ 事件，输出一行一个数表示樱清除的崩坏能的值，答案保证在 $[0,2^{63})$", "hint": "【样例 $1$ 说明】\n\n第四个事件使 $1$ 号房屋有 $1$ 点的崩坏能。\n\n第五个事件使 $1$ 号房屋增加了 $2$ 点的崩坏能，此时其崩坏能值为 $3$。\n\n第六个事件显然答案为 $3$，更新 $\\text{lastans}=3$ 。\n\n第七个事件真实的 $x=1$，$y=3$，由于第六个事件已经在 $1$ 驱魔，所以没有崩坏能。\n\n$Subtask$ #$1$（$20$ 分）： \n\n$1\\leq n,m\\leq 100000$。\n\n$Subtask$ #$2$（$70$ 分）： \n\n$1\\leq n,m\\leq 200000$。\n\n$Subtask$ #$3$（$10$ 分）： \n\n$1\\leq n,m\\leq 500000$。\n\n所有测试点的时间限制统一为 $1.5 \\text s$，内存限制统一为 $125 \\text{MiB}$。\n\n### 题目提供者：[$\\color{red}{zhengrunzhe}$](https://www.luogu.org/space/show?uid=14374)", "locale": "zh-CN"}}}
{"pid": "P5623", "type": "P", "difficulty": 5, "samples": [["3\n15 2 3\n10 2 5\n416873881340965120 2 7", "6 9\n10\n8507630225817856 19446011944726528 22224013651116032 12699436372066304 8293509467471872 4739148267126784 1354042362036224 3094953970368512 1768545125924864 32339110874054656 5279854836580352 1508529953308672 3448068464705536 3940649673949184 288230376151711744\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "Special Judge"], "title": "[Celeste-A] Sever the Skyline", "background": "> 废弃的城市里充满了机关和陷阱，而今晚，我们将\n\n> ——划破这城市的天际线", "description": "Madeline 来到了被废弃的城市，这座城市里满是机关，还有一台不知所谓的机器在向外发射着光信号。\n\n通过 Madeline 强大的观察力，她发现光信号其实对应着某种冲刺顺序，按照顺序冲刺之后，她发现她冲刺的轨迹构成了这座废弃城市的天际线。\n\n多年以后，当 Madeline 回忆她登山的旅途时，已经不记得这座城市的天际线长什么样了，只记得所有建筑高度的和为 $n$，并且每座建筑的高度可以表示为 $p^iq^j$，$p,q$ 为素数且 $i,j \\geq 0,i+j\\geq 1$。\n\nMadeline 知道，这座城市的天际线是很有美感的，不存在两座建筑使得它们的高度成**整倍数**关系(1倍也是整倍数)，例如若存在一座高度为 $2$ 的建筑，就一定不能存在高度为 $4$ 的建筑。\n\n由于 Madeline 的记忆相当模糊，所以她可能要求你多次对于一个特定的记忆给出一个合法的天际线。", "inputFormat": "第一行为一个整数 $T$，表示 Madeline 的询问次数。\n\n接下来 $T$ 行，一行三个整数 $n,p,q$，分别表示本次回忆中建筑高度的和与题目描述中所述的 $p,q$。", "outputFormat": "对于每组回忆输出一行若干个整数，以空格分隔，表示一组合法的天际线。\n\n每组数据保证有解，若有多组合法的解，请输出任意一组。\n\n**请不要在行末增加多余空格，否则会 WA。(即，行末无空格)**", "hint": "对于前 $30\\%$ 的数据，保证 $n \\leq 100$，\n\n对于另外 $20\\%$ 的数据，保证 $p,q \\leq 3$\n\n对于 $100\\%$ 的数据，保证 $1 < n \\leq 10^{18}, p,q \\leq 40, p < q, T \\leq 10000$\n\n对于最后 $30\\%$ 的数据，采用捆绑测试，仅当您通过了所有测试点才能得分。\n\n保证数据的生成方式为：\n\n均匀随机两个质数 $p,q$，随机选择若干个 $p^iq^j$，保证它们不成倍数，将 $p^iq^j$ 的和作为 $n$，若这组数据满足当前数据点的要求，则保留，若不满足，则重新生成。\n\n对于最后 $30\\%$ 数据点，对于 $n$ 要求 $n > 10^{17}$。\n\n对于最后 $30\\%$ 数据点中的部分测试点，要求至少选出 $4$ 个 $p^iq^j$ 来组成 $n$。\n\n**本题 spj 认可的格式为：行末无空格，每组输出行末换行。**\n\n**若格式不正确，您可能会获得 UKE**", "locale": "zh-CN", "translations": {"en": {"title": "[Celeste-A] Sever the Skyline", "background": "> The abandoned city is full of mechanisms and traps, and tonight, we will.\n\n> —Sever the skyline of this city.", "description": "Madeline arrived at an abandoned city. The city is full of mechanisms, and there is also a machine of unknown purpose emitting light signals outward.\n\nWith Madeline’s strong observation skills, she discovered that the light signals actually correspond to some dash order. After dashing in that order, she found that her dash trail formed the skyline of this abandoned city.\n\nMany years later, when Madeline looked back on her mountain-climbing journey, she no longer remembered what the skyline of that city looked like. She only remembered that the sum of all building heights is $n$, and that each building’s height can be written as $p^iq^j$, where $p, q$ are prime numbers and $i, j \\geq 0, i + j \\geq 1$.\n\nMadeline knows that the skyline of this city is aesthetically pleasing: there do not exist two buildings whose heights are in an **integer multiple** relationship (a multiple of 1 also counts). For example, if there is a building of height $2$, then there must not be a building of height $4$.\n\nBecause Madeline’s memory is quite vague, she may ask you multiple times to provide a valid skyline for a specific memory.", "inputFormat": "The first line contains an integer $T$, indicating the number of queries from Madeline.\n\nThe next $T$ lines each contain three integers $n, p, q$, representing, respectively, the sum of building heights in this memory and the $p, q$ described in the statement.", "outputFormat": "For each memory, output one line containing several integers separated by spaces, representing one valid skyline.\n\nIt is guaranteed that each test case has a solution. If there are multiple valid solutions, output any one.\n\n**Do not add extra spaces at the end of the line, otherwise you will get WA. (That is, no trailing spaces at the end of the line.)**", "hint": "For the first $30\\%$ of the testdata, it is guaranteed that $n \\leq 100$.\n\nFor another $20\\%$ of the testdata, it is guaranteed that $p, q \\leq 3$.\n\nFor $100\\%$ of the testdata, it is guaranteed that $1 < n \\leq 10^{18}$, $p, q \\leq 40$, $p < q$, and $T \\leq 10000$.\n\nFor the last $30\\%$ of the testdata, bundled tests are used: you will score only if you pass all test points.\n\nIt is guaranteed that the testdata is generated as follows:\n\nUniformly randomly choose two primes $p, q$, randomly select several $p^iq^j$ and ensure they are not multiples of each other, take the sum of these $p^iq^j$ as $n$. If this data satisfies the requirements of the current test point, keep it; otherwise, regenerate.\n\nFor the last $30\\%$ of the test points, $n$ is required to satisfy $n > 10^{17}$.\n\nFor some test points in the last $30\\%$ of the test points, it is required to select at least $4$ such $p^iq^j$ to form $n$.\n\n**The format accepted by the SPJ is: no trailing spaces at the end of the line, and each output line ends with a newline.**\n\n**If the format is incorrect, you may receive UKE.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Celeste-A] Sever the Skyline", "background": "> 废弃的城市里充满了机关和陷阱，而今晚，我们将\n\n> ——划破这城市的天际线", "description": "Madeline 来到了被废弃的城市，这座城市里满是机关，还有一台不知所谓的机器在向外发射着光信号。\n\n通过 Madeline 强大的观察力，她发现光信号其实对应着某种冲刺顺序，按照顺序冲刺之后，她发现她冲刺的轨迹构成了这座废弃城市的天际线。\n\n多年以后，当 Madeline 回忆她登山的旅途时，已经不记得这座城市的天际线长什么样了，只记得所有建筑高度的和为 $n$，并且每座建筑的高度可以表示为 $p^iq^j$，$p,q$ 为素数且 $i,j \\geq 0,i+j\\geq 1$。\n\nMadeline 知道，这座城市的天际线是很有美感的，不存在两座建筑使得它们的高度成**整倍数**关系(1倍也是整倍数)，例如若存在一座高度为 $2$ 的建筑，就一定不能存在高度为 $4$ 的建筑。\n\n由于 Madeline 的记忆相当模糊，所以她可能要求你多次对于一个特定的记忆给出一个合法的天际线。", "inputFormat": "第一行为一个整数 $T$，表示 Madeline 的询问次数。\n\n接下来 $T$ 行，一行三个整数 $n,p,q$，分别表示本次回忆中建筑高度的和与题目描述中所述的 $p,q$。", "outputFormat": "对于每组回忆输出一行若干个整数，以空格分隔，表示一组合法的天际线。\n\n每组数据保证有解，若有多组合法的解，请输出任意一组。\n\n**请不要在行末增加多余空格，否则会 WA。(即，行末无空格)**", "hint": "对于前 $30\\%$ 的数据，保证 $n \\leq 100$，\n\n对于另外 $20\\%$ 的数据，保证 $p,q \\leq 3$\n\n对于 $100\\%$ 的数据，保证 $1 < n \\leq 10^{18}, p,q \\leq 40, p < q, T \\leq 10000$\n\n对于最后 $30\\%$ 的数据，采用捆绑测试，仅当您通过了所有测试点才能得分。\n\n保证数据的生成方式为：\n\n均匀随机两个质数 $p,q$，随机选择若干个 $p^iq^j$，保证它们不成倍数，将 $p^iq^j$ 的和作为 $n$，若这组数据满足当前数据点的要求，则保留，若不满足，则重新生成。\n\n对于最后 $30\\%$ 数据点，对于 $n$ 要求 $n > 10^{17}$。\n\n对于最后 $30\\%$ 数据点中的部分测试点，要求至少选出 $4$ 个 $p^iq^j$ 来组成 $n$。\n\n**本题 spj 认可的格式为：行末无空格，每组输出行末换行。**\n\n**若格式不正确，您可能会获得 UKE**", "locale": "zh-CN"}}}
{"pid": "P5624", "type": "P", "difficulty": 6, "samples": [["5 2\n1 2 3 4 5\n1 2\n2 3", "5\n7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["O2优化"], "title": "[Celeste-A] Black Moonrise", "background": "> 幽灵\n>\n> 不属于这个世界\n> \n>但因这个世界而诞生\n>\n>潜藏在秩序之外\n>\n>$$\n>\n> 醒来吧，我的心是堡垒\\\\\n>\n>在梦中我易受伤害", "description": "在 Madeline 的梦境中，城市的边境是由大大小小的宇宙碎片构成的。\n\n每个宇宙碎片都有一定的能量值，由于碎片的大小有一定的差异，因此它们的能量值也有大有小。\n\nMadeline 很享受在碎片之间穿梭，她每次都会选择两个宇宙碎片，并获得它们能量值的最大公约数的愉悦值。注意这两个宇宙碎片可以相同。\n\n宇宙碎片构成了一段序列 $a_1,a_2,\\cdots,a_n$，每次 Madeline 都会选择它的一个区间，对于这个区间里面的任意两个宇宙碎片 $(u,v)$，她都会进行一次穿梭。**注意这里的 $(u,v)$ 是有序对。**\n\n形式化地，Madeline 每次获得的愉悦值为\n\n$$\\sum_{i=l}^r\\sum_{j=l}^r \\gcd(a_i,a_j)$$\n\n当 Madeline 从她的梦中被唤醒时，她发现所有的宇宙碎片都消失了。她不记得在梦中每次穿梭时获得的愉悦值是多少，只依稀记得她选择的区间了。\n\n于是她找到了你——一个信息学大佬，请你根据她每次选择的区间，还原她当时的愉悦值。", "inputFormat": "第一行两个正整数 $n,q$，分别表示碎片个数以及询问数。\n\n第二行有 $n$ 个正整数 $a_1,a_2,\\cdots,a_n$，表示每个碎片的能量值。\n\n接下来 $q$ 行，每行两个整数 $l_i,r_i$，表示第 $i$ 次询问 Madeline 选择的区间。", "outputFormat": "对于每个询问输出一行，表示在这次询问中，Madeline 获得的愉悦值的总和。", "hint": "- 对于 $10\\%$ 的数据，满足 $n,q\\leq 200$；\n- 对于 $20\\%$ 的数据，满足 $n,q\\leq 2250$；\n- 对于 $40\\%$ 的数据，满足 $n,q\\leq 4000$；\n- 对于 $100\\%$ 的数据，满足 $n,q,a_i\\leq 10^5$。\n\n**保证数列和询问均为随机生成。**", "locale": "zh-CN", "translations": {"en": {"title": "[Celeste-A] Black Moonrise", "background": "> Ghosts.\n>\n> They do not belong to this world.\n>\n> Yet they were born because of this world.\n>\n> Hidden beyond order.\n>\n> $$\n>\n> Wake up, my heart is a fortress\\\\\n>\n> In dreams I am easily hurt", "description": "In Madeline’s dream, the border of the city is made up of cosmic fragments of various sizes.\n\nEach cosmic fragment has an energy value. Because the fragments vary in size, their energy values can be large or small.\n\nMadeline enjoys moving between fragments. Each time, she chooses two cosmic fragments and gains a happiness value equal to the greatest common divisor of their energy values. Note that the two fragments can be the same.\n\nThe cosmic fragments form a sequence $a_1,a_2,\\cdots,a_n$. Each time, Madeline chooses an interval of this sequence, and for any two cosmic fragments $(u,v)$ inside this interval, she will move between them once. **Note that $(u,v)$ here is an ordered pair.**\n\nFormally, the happiness value Madeline gains each time is\n\n$$\\sum_{i=l}^r\\sum_{j=l}^r \\gcd(a_i,a_j)$$\n\nWhen Madeline is awakened from her dream, she finds that all cosmic fragments have disappeared. She cannot remember the happiness value she got from each move in the dream, and only vaguely remembers the intervals she chose.\n\nSo she comes to you, an informatics expert, and asks you to restore the happiness value she obtained at that time based on the intervals she chose each time.", "inputFormat": "The first line contains two positive integers $n,q$, representing the number of fragments and the number of queries.\n\nThe second line contains $n$ positive integers $a_1,a_2,\\cdots,a_n$, representing the energy value of each fragment.\n\nThe next $q$ lines each contain two integers $l_i,r_i$, representing the interval Madeline chose in the $i$-th query.", "outputFormat": "For each query, output one line representing the total sum of happiness values Madeline obtains in that query.", "hint": "- For $10\\%$ of the testdata, $n,q\\leq 200$.\n- For $20\\%$ of the testdata, $n,q\\leq 2250$.\n- For $40\\%$ of the testdata, $n,q\\leq 4000$.\n- For $100\\%$ of the testdata, $n,q,a_i\\leq 10^5$.\n\n**It is guaranteed that both the sequence and the queries are generated randomly.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Celeste-A] Black Moonrise", "background": "> 幽灵\n>\n> 不属于这个世界\n> \n>但因这个世界而诞生\n>\n>潜藏在秩序之外\n>\n>$$\n>\n> 醒来吧，我的心是堡垒\\\\\n>\n>在梦中我易受伤害", "description": "在 Madeline 的梦境中，城市的边境是由大大小小的宇宙碎片构成的。\n\n每个宇宙碎片都有一定的能量值，由于碎片的大小有一定的差异，因此它们的能量值也有大有小。\n\nMadeline 很享受在碎片之间穿梭，她每次都会选择两个宇宙碎片，并获得它们能量值的最大公约数的愉悦值。注意这两个宇宙碎片可以相同。\n\n宇宙碎片构成了一段序列 $a_1,a_2,\\cdots,a_n$，每次 Madeline 都会选择它的一个区间，对于这个区间里面的任意两个宇宙碎片 $(u,v)$，她都会进行一次穿梭。**注意这里的 $(u,v)$ 是有序对。**\n\n形式化地，Madeline 每次获得的愉悦值为\n\n$$\\sum_{i=l}^r\\sum_{j=l}^r \\gcd(a_i,a_j)$$\n\n当 Madeline 从她的梦中被唤醒时，她发现所有的宇宙碎片都消失了。她不记得在梦中每次穿梭时获得的愉悦值是多少，只依稀记得她选择的区间了。\n\n于是她找到了你——一个信息学大佬，请你根据她每次选择的区间，还原她当时的愉悦值。", "inputFormat": "第一行两个正整数 $n,q$，分别表示碎片个数以及询问数。\n\n第二行有 $n$ 个正整数 $a_1,a_2,\\cdots,a_n$，表示每个碎片的能量值。\n\n接下来 $q$ 行，每行两个整数 $l_i,r_i$，表示第 $i$ 次询问 Madeline 选择的区间。", "outputFormat": "对于每个询问输出一行，表示在这次询问中，Madeline 获得的愉悦值的总和。", "hint": "- 对于 $10\\%$ 的数据，满足 $n,q\\leq 200$；\n- 对于 $20\\%$ 的数据，满足 $n,q\\leq 2250$；\n- 对于 $40\\%$ 的数据，满足 $n,q\\leq 4000$；\n- 对于 $100\\%$ 的数据，满足 $n,q,a_i\\leq 10^5$。\n\n**保证数列和询问均为随机生成。**", "locale": "zh-CN"}}}
{"pid": "P5625", "type": "P", "difficulty": 6, "samples": [["4 3 2\n0 3 4 1\n0 2 3 3\n2\n", "16"], ["8 9 6\n0 1 1 1\n0 2 2 9\n0 3 3 2\n0 4 4 6\n0 5 5 0\n0 6 6 8\n0 7 7 1\n0 8 8 7\n2\n", "1"], ["10 15 14\n2\n0 6 6 439\n0 3 8 1865\n2\n0 7 10 11371\n2\n1 1\n2\n2\n1 3\n2\n0 5 8 7784\n2\n0 4 7 8497\n2\n", "155712307\n76042715\n719747106\n76042715\n76042715\n74890016\n76042715\n719747106"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化"], "title": "[Celeste-A] Good Karma", "background": "> \"我们永远不会忘记在这里的时光\"\n\n> \"再也没有其他地方能让我感到平静。谢谢。\"\n\n> \"很遗憾，Oshiro 先生，山庄要关门了。\"\n\n> \"我会赶上他们，直到这里的一切都井然有序……\"\n\n> \"在离开这个山庄之后，我应该去哪儿呢？\"", "description": "天空度假山庄是位于 Celeste 山半山腰上的一座山庄，这里已经被废弃许久。\n\n当 Madeline 来到这座山庄之时，这里只剩下了一个幽灵，Oshiro 先生，独自管理这座山庄。\n\n因为山庄有着神奇的魔力，里面凝聚着许多 Oshiro 先生不好的想法。\n\n一个想法可能包含 $k$ 种不好的念头，诸如山庄倒闭，无人问津，无人体谅等等，每种念头对于 Oshiro 先生的重要度是不一样的，具体来讲，第 $i$ 种不好的念头对 Oshiro 先生的重要程度为 $2^{i-1}$。\n\n有时，Oshiro 先生会抓起一堆糟糕的想法进行回忆，Oshiro 会一个一个挨着观看这些想法，并获得其中不好的念头。特别地，当 Oshiro 先生**两次看到同一种不好的念头**时，他就会认为这种念头没什么，下一瞬间就会**忘记自己曾经看到过这种念头**。\n\n一次回忆对 Oshiro 先生的重要程度为 Oshiro 在看完这些想法之后**记住的念头**的重要程度和。\n\n自然，在天空度假山庄里，Oshiro 先生对 Madeline 大吐苦水。\n\n多年以后，当 Madeline 回忆她的登山之旅的时候，已经不记得 Oshiro 每个想法对于他的重要程度了，她只记得 Oshiro 先生的某几次回忆的重要程度以及天空度假山庄之中不好的想法的数量与每种想法中可能的不好的念头的数量。\n\n你能帮助她找出有多少种合法的想法序列满足 Oshiro 先生的每次回忆吗？\n\n特别地，一个想法也可能是一团浆糊，即里面什么都没有。", "inputFormat": "第一行为三个整数 $n,q,k$，表示不好的想法的数量，Madeline 告诉了你 $q$ 条信息，以及每个想法中可能存在的不好的念头的数量。\n\n接下来 $q$ 行，一行一条信息，首先是信息的类型 $op$。\n\n若 $op = 0$， 则接下来是三个整数 $l,r,val$，表示 Madeline 想起在某次回忆中 Oshiro 先生抓起编号在 $[l,r]$ 区间的想法回忆，回忆结束后重要度是 $val$。\n\n若 $op = 1$，则接下来是一个整数 $cnt$，表示 Madeline 纠正了**第 $cnt$ 条 $op = 0$ 的说法**，第 $cnt$ 条说法是她错误回忆起来的，保证第 $cnt$ 条说法存在并且没有被纠正过。(你可以认为，被纠正的说法就不再存在了)\n\n若 $op = 2$，则你需要输出一个整数，表示有多少种合法的想法序列满足当前 Oshiro 先生的每次回忆，对 $998244353$ 取模。", "outputFormat": "对于每次 $op = 2$，输出方案数，对 $998244353$ 取模。", "hint": "对于 $10\\%$ 的数据, $ n,k\\leq 5,q \\leq 15$\n\n对于 $30\\%$ 的数据, $ n,q\\leq 1000 $\n\n对于额外 $10\\%$ 的数据, $ k=1 $\n\n对于额外 $15\\%$ 的数据，不存在1操作\n\n对于 $75\\%$ 的数据, $n\\leq 30000,q\\leq 80000,k \\leq 20$\n\n对于 $100\\%$ 的数据, $ n\\leq 2 * 10^5,q\\leq 10^6,k\\leq 30,0 \\leq val < 2^k$", "locale": "zh-CN", "translations": {"en": {"title": "[Celeste-A] Good Karma", "background": "> \"We will never forget the time we spent here.\"\n\n> \"There is nowhere else that can make me feel at peace. Thank you.\"\n\n> \"I am sorry, Mr. Oshiro, but the resort is going to close.\"\n\n> \"I will catch up to them, until everything here is in order...\"\n\n> \"After leaving this resort, where should I go?\"", "description": "The Celestial Resort is a resort located halfway up Celeste Mountain, and it has been abandoned for a long time.\n\nWhen Madeline arrives at the resort, there is only one ghost left, Mr. Oshiro, managing it alone.\n\nBecause the resort has some magical power, it gathers many of Mr. Oshiro’s bad thoughts.\n\nA thought may contain $k$ kinds of bad ideas, such as the resort shutting down, nobody visiting, nobody understanding him, and so on. The importance of each kind of bad idea to Mr. Oshiro is different. Specifically, the importance of the $i$-th kind of bad idea is $2^{i-1}$.\n\nSometimes, Mr. Oshiro grabs a pile of bad thoughts to recall. Oshiro watches these thoughts one by one and gains the bad ideas in them. In particular, when Mr. Oshiro **sees the same kind of bad idea twice**, he will think this idea is nothing, and in the next moment he will **forget that he has ever seen this idea**.\n\nThe importance of one recall is the sum of the importance of the bad ideas that Oshiro **still remembers** after he finishes watching these thoughts.\n\nNaturally, in the Celestial Resort, Mr. Oshiro complains a lot to Madeline.\n\nMany years later, when Madeline recalls her climbing trip, she no longer remembers how important each thought was to Oshiro. She only remembers the importance of some of Mr. Oshiro’s recalls, as well as the number of bad thoughts in the Celestial Resort and the number of possible bad ideas in each thought.\n\nCan you help her find how many legal thought sequences satisfy every recall of Mr. Oshiro?\n\nIn particular, a thought can also be a complete mess, meaning it contains nothing.", "inputFormat": "The first line contains three integers $n,q,k$, representing the number of bad thoughts, the number of pieces of information Madeline tells you ($q$), and the number of possible bad ideas in each thought.\n\nThe next $q$ lines each contain one piece of information, starting with the type $op$.\n\nIf $op = 0$, then three integers $l,r,val$ follow, meaning Madeline remembers that in some recall Mr. Oshiro grabbed the thoughts with indices in the interval $[l,r]$ to recall, and after the recall the importance was $val$.\n\nIf $op = 1$, then one integer $cnt$ follows, meaning Madeline corrected **the $cnt$-th statement with $op = 0$**. The $cnt$-th statement is something she remembered wrongly. It is guaranteed that this $cnt$-th statement exists and has not been corrected before. (You may assume that a corrected statement no longer exists.)\n\nIf $op = 2$, you need to output one integer, representing how many legal thought sequences satisfy all current recalls of Mr. Oshiro, modulo $998244353$.", "outputFormat": "For each $op = 2$, output the number of valid sequences modulo $998244353$.", "hint": "For $10\\%$ of the testdata, $n,k \\leq 5, q \\leq 15$.\n\nFor $30\\%$ of the testdata, $n,q \\leq 1000$.\n\nFor an additional $10\\%$ of the testdata, $k = 1$.\n\nFor an additional $15\\%$ of the testdata, there is no operation of type $1$.\n\nFor $75\\%$ of the testdata, $n \\leq 30000, q \\leq 80000, k \\leq 20$.\n\nFor $100\\%$ of the testdata, $n \\leq 2 * 10^5, q \\leq 10^6, k \\leq 30, 0 \\leq val < 2^k$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Celeste-A] Good Karma", "background": "> \"我们永远不会忘记在这里的时光\"\n\n> \"再也没有其他地方能让我感到平静。谢谢。\"\n\n> \"很遗憾，Oshiro 先生，山庄要关门了。\"\n\n> \"我会赶上他们，直到这里的一切都井然有序……\"\n\n> \"在离开这个山庄之后，我应该去哪儿呢？\"", "description": "天空度假山庄是位于 Celeste 山半山腰上的一座山庄，这里已经被废弃许久。\n\n当 Madeline 来到这座山庄之时，这里只剩下了一个幽灵，Oshiro 先生，独自管理这座山庄。\n\n因为山庄有着神奇的魔力，里面凝聚着许多 Oshiro 先生不好的想法。\n\n一个想法可能包含 $k$ 种不好的念头，诸如山庄倒闭，无人问津，无人体谅等等，每种念头对于 Oshiro 先生的重要度是不一样的，具体来讲，第 $i$ 种不好的念头对 Oshiro 先生的重要程度为 $2^{i-1}$。\n\n有时，Oshiro 先生会抓起一堆糟糕的想法进行回忆，Oshiro 会一个一个挨着观看这些想法，并获得其中不好的念头。特别地，当 Oshiro 先生**两次看到同一种不好的念头**时，他就会认为这种念头没什么，下一瞬间就会**忘记自己曾经看到过这种念头**。\n\n一次回忆对 Oshiro 先生的重要程度为 Oshiro 在看完这些想法之后**记住的念头**的重要程度和。\n\n自然，在天空度假山庄里，Oshiro 先生对 Madeline 大吐苦水。\n\n多年以后，当 Madeline 回忆她的登山之旅的时候，已经不记得 Oshiro 每个想法对于他的重要程度了，她只记得 Oshiro 先生的某几次回忆的重要程度以及天空度假山庄之中不好的想法的数量与每种想法中可能的不好的念头的数量。\n\n你能帮助她找出有多少种合法的想法序列满足 Oshiro 先生的每次回忆吗？\n\n特别地，一个想法也可能是一团浆糊，即里面什么都没有。", "inputFormat": "第一行为三个整数 $n,q,k$，表示不好的想法的数量，Madeline 告诉了你 $q$ 条信息，以及每个想法中可能存在的不好的念头的数量。\n\n接下来 $q$ 行，一行一条信息，首先是信息的类型 $op$。\n\n若 $op = 0$， 则接下来是三个整数 $l,r,val$，表示 Madeline 想起在某次回忆中 Oshiro 先生抓起编号在 $[l,r]$ 区间的想法回忆，回忆结束后重要度是 $val$。\n\n若 $op = 1$，则接下来是一个整数 $cnt$，表示 Madeline 纠正了**第 $cnt$ 条 $op = 0$ 的说法**，第 $cnt$ 条说法是她错误回忆起来的，保证第 $cnt$ 条说法存在并且没有被纠正过。(你可以认为，被纠正的说法就不再存在了)\n\n若 $op = 2$，则你需要输出一个整数，表示有多少种合法的想法序列满足当前 Oshiro 先生的每次回忆，对 $998244353$ 取模。", "outputFormat": "对于每次 $op = 2$，输出方案数，对 $998244353$ 取模。", "hint": "对于 $10\\%$ 的数据, $ n,k\\leq 5,q \\leq 15$\n\n对于 $30\\%$ 的数据, $ n,q\\leq 1000 $\n\n对于额外 $10\\%$ 的数据, $ k=1 $\n\n对于额外 $15\\%$ 的数据，不存在1操作\n\n对于 $75\\%$ 的数据, $n\\leq 30000,q\\leq 80000,k \\leq 20$\n\n对于 $100\\%$ 的数据, $ n\\leq 2 * 10^5,q\\leq 10^6,k\\leq 30,0 \\leq val < 2^k$", "locale": "zh-CN"}}}
{"pid": "P5626", "type": "P", "difficulty": 3, "samples": [["4", "5"], ["5", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "排序"], "title": "【AFOI-19】数码排序", "background": "小L从虚拟世界里出来啦！\n\n---\n\n**加强版[链接](https://www.luogu.org/problem/P5634)**", "description": "逃出来的同时，也有一部分数码逃了出来，吵着闹着让小L帮他们排序\n\n虚拟世界的数码都是不可见的\n\n小L目前只会选择排序，插入排序，冒泡排序，归并排序\n\n所以小L想问他在最坏情况下最少需要几次比较，才能使序列有序\n\n-------\n\n[排序的模板代码](https://www.luogu.org/paste/fdtepscp)", "inputFormat": "输入仅有一行，给定一个正整数 $n$，表示序列的长度", "outputFormat": "输出最小的比较次数", "hint": "- **样例$1$解释**\n\n长度为$4$的序列归并调用，分成$2$组，一组$2$个元素。$2$个元素分别比较一次， 合并时最坏比较$3$次，所以是$3+1+1=5$。\n\n- **数据范围**\n\n对于$10\\%$的数据，$n \\leq 1000$\n\n对于$30\\%$的数据，$n \\leq 1000000$\n\n对于$100\\%$的数据，$n \\leq 10^{16}$\n\n**数据保证随机**\n", "locale": "zh-CN", "translations": {"en": {"title": "[AFOI-19] Digital Sorting", "background": "Little L has come out of the virtual world!\n\n---\n\n**Enhanced version [link](https://www.luogu.org/problem/P5634)**", "description": "While escaping, some “digits” also escaped. They kept making noise and asked Little L to help sort them.\n\nThe digits in the virtual world are invisible.\n\nLittle L currently only knows selection sort, insertion sort, bubble sort, and merge sort.\n\nSo Little L wants to ask: in the worst case, what is the minimum number of comparisons needed to make the sequence sorted?\n\n-------\n\n[Template code for sorting](https://www.luogu.org/paste/fdtepscp)", "inputFormat": "There is only one line of input: a positive integer $n$, representing the length of the sequence.", "outputFormat": "Output the minimum number of comparisons.", "hint": "- **Sample $1$ Explanation**\n\nFor a sequence of length $4$, merge sort splits it into $2$ groups, with $2$ elements in each group. The $2$ elements in each group are compared once. During merging, the worst case needs $3$ comparisons, so the total is $3+1+1=5$.\n\n- **Constraints**\n\nFor $10\\%$ of the testdata, $n \\leq 1000$.\n\nFor $30\\%$ of the testdata, $n \\leq 1000000$.\n\nFor $100\\%$ of the testdata, $n \\leq 10^{16}$.\n\n**The testdata is guaranteed to be random.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【AFOI-19】数码排序", "background": "小L从虚拟世界里出来啦！\n\n---\n\n**加强版[链接](https://www.luogu.org/problem/P5634)**", "description": "逃出来的同时，也有一部分数码逃了出来，吵着闹着让小L帮他们排序\n\n虚拟世界的数码都是不可见的\n\n小L目前只会选择排序，插入排序，冒泡排序，归并排序\n\n所以小L想问他在最坏情况下最少需要几次比较，才能使序列有序\n\n-------\n\n[排序的模板代码](https://www.luogu.org/paste/fdtepscp)", "inputFormat": "输入仅有一行，给定一个正整数 $n$，表示序列的长度", "outputFormat": "输出最小的比较次数", "hint": "- **样例$1$解释**\n\n长度为$4$的序列归并调用，分成$2$组，一组$2$个元素。$2$个元素分别比较一次， 合并时最坏比较$3$次，所以是$3+1+1=5$。\n\n- **数据范围**\n\n对于$10\\%$的数据，$n \\leq 1000$\n\n对于$30\\%$的数据，$n \\leq 1000000$\n\n对于$100\\%$的数据，$n \\leq 10^{16}$\n\n**数据保证随机**\n", "locale": "zh-CN"}}}
{"pid": "P5627", "type": "P", "difficulty": 4, "samples": [["2\n", "5"], ["5\n", "447"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学"], "title": "【AFOI-19】sum与prod", "background": "SY终于整理好了她凌乱的被子，刚来到教室的她就收到了QM传来的一张字条。。。\n\nTo: Dear SY\n\n&nbsp;&nbsp;&nbsp;&nbsp;你看看我昨晚梦到的式子，解出来给你糖吃。\n\nFrom: Your QM。\n\nSY自然是无法拒绝 $C_{6}H_{12}O_{6}$ 的诱惑啦，不过她看到字条背面花里胡哨的式子时傻眼了。。但是SY还是很想吃糖。", "description": "求\n\n$$\\sum_{i=1}^{2^{n}}\\log_{2}{(\\prod_{j = 1}^{i}lowbit(j))}$$\n\n的结果\n\n其中 $lowbit(x)$ 意指` x&(~x+1)` 的结果。", "inputFormat": "一行，一个整数n。", "outputFormat": "一行，一个整数，为答案模 $10^9+7$ 的结果。", "hint": "对于前 $20\\%$ 的数据，有 $1 \\leq n \\leq 60$ 。\n\n对于前 $50\\%$ 的数据，有 $1 \\leq n \\leq 10^4$ 。\n\n对于前 $100\\%$ 的数据，有 $1 \\leq n \\leq 2^{62}$ 。", "locale": "zh-CN", "translations": {"en": {"title": "[AFOI-19] sum and prod", "background": "SY finally tidied up her messy quilt. As soon as she arrived in the classroom, she received a note from QM...\n\nTo: Dear SY\n\n&nbsp;&nbsp;&nbsp;&nbsp;Take a look at the formula I dreamed of last night. Solve it and I will give you candy.\n\nFrom: Your QM.\n\nSY, of course, could not resist the temptation of $C_{6}H_{12}O_{6}$. But when she saw the fancy formula on the back of the note, she was stunned... Still, SY really wanted to eat candy.", "description": "Find the value of\n\n$$\\sum_{i=1}^{2^{n}}\\log_{2}{(\\prod_{j = 1}^{i}lowbit(j))}$$\n\nwhere $lowbit(x)$ means the result of ` x&(~x+1)`.", "inputFormat": "One line containing an integer $n$.", "outputFormat": "One line containing one integer, the answer modulo $10^9+7$.", "hint": "For the first $20\\%$ of the testdata, $1 \\leq n \\leq 60$.\n\nFor the first $50\\%$ of the testdata, $1 \\leq n \\leq 10^4$.\n\nFor the full $100\\%$ of the testdata, $1 \\leq n \\leq 2^{62}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【AFOI-19】sum与prod", "background": "SY终于整理好了她凌乱的被子，刚来到教室的她就收到了QM传来的一张字条。。。\n\nTo: Dear SY\n\n&nbsp;&nbsp;&nbsp;&nbsp;你看看我昨晚梦到的式子，解出来给你糖吃。\n\nFrom: Your QM。\n\nSY自然是无法拒绝 $C_{6}H_{12}O_{6}$ 的诱惑啦，不过她看到字条背面花里胡哨的式子时傻眼了。。但是SY还是很想吃糖。", "description": "求\n\n$$\\sum_{i=1}^{2^{n}}\\log_{2}{(\\prod_{j = 1}^{i}lowbit(j))}$$\n\n的结果\n\n其中 $lowbit(x)$ 意指` x&(~x+1)` 的结果。", "inputFormat": "一行，一个整数n。", "outputFormat": "一行，一个整数，为答案模 $10^9+7$ 的结果。", "hint": "对于前 $20\\%$ 的数据，有 $1 \\leq n \\leq 60$ 。\n\n对于前 $50\\%$ 的数据，有 $1 \\leq n \\leq 10^4$ 。\n\n对于前 $100\\%$ 的数据，有 $1 \\leq n \\leq 2^{62}$ 。", "locale": "zh-CN"}}}
{"pid": "P5628", "type": "P", "difficulty": 5, "samples": [["6 0\n1 3\n3 2\n5 4\n3 4\n4 6", "19"], ["5 1\n1 2\n2 3\n3 4\n4 5", "20"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "容斥原理"], "title": "【AFOI-19】面基", "background": "一伙人吃完午饭准备看考场，IY ，SY，QM，MY 和 UU 早就约好在当天下午面基。然后众人一致同意把安排行程的锅甩到了 IY 身上。\n\n（IY：？？？？为什么是我）\n\n（QM：给你吃糖）\n\n（IY：好的没问题，包在我身上。）", "description": "IY 所在的城市有 $n$ 个路口，$n-1$ 条道路把各个路口连接起来，道路是双向的。换言之， IY 所在的城市构成了一棵树。两个不相同路口的距离定义为其简单路径上的道路条数，一个路口与自己的距离为$0$。\n\n我们再定义一条道路的重要度。若一条道路无法使用，会导致有 $t$ 对路口无法相互抵达，则$t$就是该道路的重要度。如下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ap2etu10.png)\n\n(3,4)之间的道路的重要度就为$9$。因为(1,4)(2,4)(3,4)(1,5)(2,5)(3,5)(1,6)(2,6)(3,6)要相互抵达都要经过这条边。\n\nIY 得到了一个很不好的消息，有一个路口正在施工（但是 IY 不知道施工的位置）。施工的范围影响到了距施工点距离为 $k$ 的地方，距离施工点距离小于等于 $k$ 的路口已经全部关闭了。这使得一行人不能经过受影响的路口和与这些路口直接相连的道路。\n\nIY 不得不考虑到最坏的情况，由于他不知道施工的位置，所以他想知道，施工所影响道路的重要度的总和最大是多少。", "inputFormat": "第一行两个数 $n, k$\n\n接下来的$n-1$行，每行两个数 $u,v$ 来描述一条道路。表示 $u$ 路口与 $v$ 路口直接相连。", "outputFormat": "一个数，表示 所影响道路的重要度的总和的最大值。", "hint": "- **样例解释**\n\n样例$1$：就是题面中的图例，若施工位置在 $3$ 或 $4$ 号路口，则会影响的道路重要度总和为$19$。找不出比 $19$ 更大的值。\n\n样例$2$：满足成链的特殊性质。\n\n- **数据范围**\n\n对于前 $20\\%$测试点，$n \\le 100,0 \\le k \\le 7$\n\n对于前 $40\\%$ 的数据 ：保证数据随机\n\n特殊地：第三个测试点仅有$k==0$\n\n对于 $100\\%$的数据：$n \\le 30000,0 \\le k \\le 200$\n\n特殊地：第十个测试点由树退化成了一条链", "locale": "zh-CN", "translations": {"en": {"title": "[AFOI-19] Meetup", "background": "After lunch, a group of people planned to go check the exam venue. IY, SY, QM, MY, and UU had already agreed to meet up that afternoon. Then everyone unanimously decided to dump the responsibility of planning the trip onto IY.\n\n(IY: ???? Why me?)\n\n(QM: I’ll give you candy.)\n\n(IY: Okay, no problem. Leave it to me.)", "description": "The city where IY lives has $n$ intersections, and $n - 1$ roads connect these intersections. The roads are bidirectional. In other words, the city forms a tree. The distance between two different intersections is defined as the number of roads on the simple path between them, and the distance from an intersection to itself is $0$.\n\nWe also define the importance of a road. If a road becomes unusable and this causes $t$ pairs of intersections to be unable to reach each other, then $t$ is the importance of that road. As shown in the figure below:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ap2etu10.png)\n\nThe importance of the road between $(3,4)$ is $9$. This is because for $(1,4)$, $(2,4)$, $(3,4)$, $(1,5)$, $(2,5)$, $(3,5)$, $(1,6)$, $(2,6)$, $(3,6)$ to reach each other, they all must pass through this edge.\n\nIY received some very bad news: one intersection is under construction (but IY does not know where). The construction affects the area within distance $k$ from the construction point, and all intersections whose distance to the construction point is less than or equal to $k$ have been completely closed. This means the group cannot pass through the affected intersections or the roads directly connected to these intersections.\n\nIY has to consider the worst case. Since he does not know the construction location, he wants to know what the maximum possible total importance of the affected roads is.", "inputFormat": "The first line contains two integers $n, k$.\n\nThe next $n - 1$ lines each contain two integers $u, v$, describing a road, meaning that intersection $u$ is directly connected to intersection $v$.", "outputFormat": "Output one integer, representing the maximum value of the total importance of the affected roads.", "hint": "- **Sample Explanation**\n\nSample $1$: This is the example shown in the statement. If the construction location is at intersection $3$ or $4$, then the total importance of the affected roads is $19$. No value larger than $19$ can be found.\n\nSample $2$: It satisfies the special property of being a chain.\n\n- **Constraints**\n\nFor the first $20\\%$ testdata, $n \\le 100, 0 \\le k \\le 7$.\n\nFor the first $40\\%$ of the data: the data is guaranteed to be random.\n\nSpecially, the third test point has only $k == 0$.\n\nFor $100\\%$ of the data: $n \\le 30000, 0 \\le k \\le 200$.\n\nSpecially, the tenth test point degenerates from a tree into a chain.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【AFOI-19】面基", "background": "一伙人吃完午饭准备看考场，IY ，SY，QM，MY 和 UU 早就约好在当天下午面基。然后众人一致同意把安排行程的锅甩到了 IY 身上。\n\n（IY：？？？？为什么是我）\n\n（QM：给你吃糖）\n\n（IY：好的没问题，包在我身上。）", "description": "IY 所在的城市有 $n$ 个路口，$n-1$ 条道路把各个路口连接起来，道路是双向的。换言之， IY 所在的城市构成了一棵树。两个不相同路口的距离定义为其简单路径上的道路条数，一个路口与自己的距离为$0$。\n\n我们再定义一条道路的重要度。若一条道路无法使用，会导致有 $t$ 对路口无法相互抵达，则$t$就是该道路的重要度。如下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ap2etu10.png)\n\n(3,4)之间的道路的重要度就为$9$。因为(1,4)(2,4)(3,4)(1,5)(2,5)(3,5)(1,6)(2,6)(3,6)要相互抵达都要经过这条边。\n\nIY 得到了一个很不好的消息，有一个路口正在施工（但是 IY 不知道施工的位置）。施工的范围影响到了距施工点距离为 $k$ 的地方，距离施工点距离小于等于 $k$ 的路口已经全部关闭了。这使得一行人不能经过受影响的路口和与这些路口直接相连的道路。\n\nIY 不得不考虑到最坏的情况，由于他不知道施工的位置，所以他想知道，施工所影响道路的重要度的总和最大是多少。", "inputFormat": "第一行两个数 $n, k$\n\n接下来的$n-1$行，每行两个数 $u,v$ 来描述一条道路。表示 $u$ 路口与 $v$ 路口直接相连。", "outputFormat": "一个数，表示 所影响道路的重要度的总和的最大值。", "hint": "- **样例解释**\n\n样例$1$：就是题面中的图例，若施工位置在 $3$ 或 $4$ 号路口，则会影响的道路重要度总和为$19$。找不出比 $19$ 更大的值。\n\n样例$2$：满足成链的特殊性质。\n\n- **数据范围**\n\n对于前 $20\\%$测试点，$n \\le 100,0 \\le k \\le 7$\n\n对于前 $40\\%$ 的数据 ：保证数据随机\n\n特殊地：第三个测试点仅有$k==0$\n\n对于 $100\\%$的数据：$n \\le 30000,0 \\le k \\le 200$\n\n特殊地：第十个测试点由树退化成了一条链", "locale": "zh-CN"}}}
{"pid": "P5629", "type": "P", "difficulty": 5, "samples": [["2 3 3 3\n0 20\n6 6 6\n1 1\n2 2\n1 2\n", "0\n1\n1\n"], ["6 3 3 3\n6 5 10 15 19 7\n2 5 10\n1 6\n1 4\n4 6\n", "3\n3\n2\n"]], "limits": {"time": [2000, 2000, 2000, 3000, 2000, 3000, 2000, 2000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["线段树", "ST 表", "字典树 Trie"], "title": "【AFOI-19】区间与除法", "background": "SY 好不容易才解出QM给她的数学题，在恰午饭的时候，QM 向她的脑洞里塞了个幻想的泡泡……SY 戳开一看，又是长长的一串数字!\n\nSY 实在是不想思考了，她决定用小学的除法消灭她脑洞里的数字.", "description": "定义 $op$ 操作意义为将当前数除以 $d$ 并向下取整.\n\nSY 现在有 $m$ 个“原数”，若一个数经过若干次 $op$ 操作(包括 $0$ 次)后能变为这个“原数”，那么这个数是可以被这个“原数”所消灭的。注意，“原数”是不会被消耗的.\n\n现在 SY 想问你,对于一个区间 $[l,r]$，在消灭最多个数的前提下最少需要多少个“原数”？", "inputFormat": "第一行 $4$ 个数,分别是 $n,m,d,q$,分别表示数列 $\\{a\\}$ 元素个数，SY 拥有的 “原数” 个数，$op$ 操作参数，询问个数。\n\n第二行为 $\\{a\\}$ 数列，即需要被消灭的数列。\n\n第三行为 $m$ 个“原数”。\n\n接下来 $q$ 行，每行两个数 $l$ 和 $r$，表示询问区间为 $[l,r]$。", "outputFormat": "按照询问顺序，每一行输出一个整数表示答案.", "hint": "#### 样例解释：\n\n**#样例1** ： $20$ 经过一次 $op$ 操作（除以 $3$ 向下取整）可以变成 $6$，而 $0$ 不能经过若干次 $op$ 操作变成 $6$ 。\n\n所以区间 $[1,1]$ 最多消灭 $0$ 个数，消灭最多数前提下最少需要 $0$ 个 \"原数\"，区间 $[1,2],[2,2]$ 最多消灭 $1$ 个数，消灭最多数前提下最少需要 $1$ 个 \"原数\" 。\n\n**#样例2** ： $2$ 能消灭 $\\{6,19,7\\}$ ， $5$ 能消灭 $\\{5,15\\}$ ， $10$ 能消灭 $\\{10\\}$ ， 所以区间 $[1,6],[1,4]$ 最少能用所有 \"原数\" 全部消灭，区间 $[4,6]$ 能用 $2,5$ 全部消灭。\n\n#### 数据范围：\n\n对于 $30\\%$ 的数据：$n\\le100,m\\leq10, d=2, q\\le 10$\n\n对于 $100\\%$ 的数据：$n\\le5\\times 10^{5},m\\leq60,2\\leq d\\leq10,q\\le10^{6},0\\le a_i,b_i< 2^{63}$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/t7pn0p1n.png)\n\n特殊性质：数据经过构造。", "locale": "zh-CN", "translations": {"en": {"title": "[AFOI-19] Intervals and Division", "background": "SY finally managed to solve the math problem QM gave her. Right at lunchtime, QM stuffed an imaginary bubble into her mind… SY popped it and saw yet another long string of numbers!\n\nSY really does not want to think anymore, so she decides to use elementary-school division to wipe out the numbers in her head.", "description": "Define the operation $op$ as: divide the current number by $d$ and take the floor.\n\nSY now has $m$ “original numbers”. If a number can become an “original number” after performing the $op$ operation some number of times (including $0$ times), then this number can be wiped out by that “original number”. Note that “original numbers” will not be consumed.\n\nNow SY asks you: for an interval $[l,r]$, under the condition that you wipe out as many numbers as possible, what is the minimum number of “original numbers” needed?", "inputFormat": "The first line contains $4$ numbers $n,m,d,q$, representing the number of elements in the sequence $\\{a\\}$, the number of “original numbers” SY has, the parameter of the $op$ operation, and the number of queries.\n\nThe second line contains the sequence $\\{a\\}$, i.e., the numbers that need to be wiped out.\n\nThe third line contains $m$ “original numbers”.\n\nThe next $q$ lines each contain two numbers $l$ and $r$, indicating the query interval $[l,r]$.", "outputFormat": "In the order of the queries, output one integer per line as the answer.", "hint": "#### Sample Explanation:\n\n**Sample 1**: $20$ can become $6$ after one $op$ operation (divide by $3$ and take the floor), but $0$ cannot become $6$ after any number of $op$ operations.\n\nSo for interval $[1,1]$, at most $0$ numbers can be wiped out; under the condition of wiping out the maximum number of numbers, the minimum number of “original numbers” needed is $0$. For intervals $[1,2]$ and $[2,2]$, at most $1$ number can be wiped out; under that condition, the minimum number of “original numbers” needed is $1$.\n\n**Sample 2**: $2$ can wipe out $\\{6,19,7\\}$, $5$ can wipe out $\\{5,15\\}$, and $10$ can wipe out $\\{10\\}$. So for intervals $[1,6]$ and $[1,4]$, you can use all “original numbers” to wipe out everything. For interval $[4,6]$, you can use $2,5$ to wipe out everything.\n\n#### Constraints:\n\nFor $30\\%$ of the testdata: $n\\le100,m\\leq10, d=2, q\\le 10$.\n\nFor $100\\%$ of the testdata: $n\\le5\\times 10^{5},m\\leq60,2\\leq d\\leq10,q\\le10^{6},0\\le a_i,b_i< 2^{63}$.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/t7pn0p1n.png)\n\nSpecial property: the testdata is constructed.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【AFOI-19】区间与除法", "background": "SY 好不容易才解出QM给她的数学题，在恰午饭的时候，QM 向她的脑洞里塞了个幻想的泡泡……SY 戳开一看，又是长长的一串数字!\n\nSY 实在是不想思考了，她决定用小学的除法消灭她脑洞里的数字.", "description": "定义 $op$ 操作意义为将当前数除以 $d$ 并向下取整.\n\nSY 现在有 $m$ 个“原数”，若一个数经过若干次 $op$ 操作(包括 $0$ 次)后能变为这个“原数”，那么这个数是可以被这个“原数”所消灭的。注意，“原数”是不会被消耗的.\n\n现在 SY 想问你,对于一个区间 $[l,r]$，在消灭最多个数的前提下最少需要多少个“原数”？", "inputFormat": "第一行 $4$ 个数,分别是 $n,m,d,q$,分别表示数列 $\\{a\\}$ 元素个数，SY 拥有的 “原数” 个数，$op$ 操作参数，询问个数。\n\n第二行为 $\\{a\\}$ 数列，即需要被消灭的数列。\n\n第三行为 $m$ 个“原数”。\n\n接下来 $q$ 行，每行两个数 $l$ 和 $r$，表示询问区间为 $[l,r]$。", "outputFormat": "按照询问顺序，每一行输出一个整数表示答案.", "hint": "#### 样例解释：\n\n**#样例1** ： $20$ 经过一次 $op$ 操作（除以 $3$ 向下取整）可以变成 $6$，而 $0$ 不能经过若干次 $op$ 操作变成 $6$ 。\n\n所以区间 $[1,1]$ 最多消灭 $0$ 个数，消灭最多数前提下最少需要 $0$ 个 \"原数\"，区间 $[1,2],[2,2]$ 最多消灭 $1$ 个数，消灭最多数前提下最少需要 $1$ 个 \"原数\" 。\n\n**#样例2** ： $2$ 能消灭 $\\{6,19,7\\}$ ， $5$ 能消灭 $\\{5,15\\}$ ， $10$ 能消灭 $\\{10\\}$ ， 所以区间 $[1,6],[1,4]$ 最少能用所有 \"原数\" 全部消灭，区间 $[4,6]$ 能用 $2,5$ 全部消灭。\n\n#### 数据范围：\n\n对于 $30\\%$ 的数据：$n\\le100,m\\leq10, d=2, q\\le 10$\n\n对于 $100\\%$ 的数据：$n\\le5\\times 10^{5},m\\leq60,2\\leq d\\leq10,q\\le10^{6},0\\le a_i,b_i< 2^{63}$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/t7pn0p1n.png)\n\n特殊性质：数据经过构造。", "locale": "zh-CN"}}}
{"pid": "P5630", "type": "P", "difficulty": 6, "samples": [["5 7 1 1\n1 3 1\n2 1 5\n4 2 3\n2 5 4\n5 1 2\n3 5 7\n4 1 6\n2\n3 5\n1 4", "15\n7\n15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["图论", "生成树", "最近公共祖先 LCA"], "title": "【AFOI-19】跳闸", "background": "面基完毕后已经是晚上了，IY 和 SY在机房划水写板子。\n\n然后机房跳闸了。\n\n然后他们核善的信息老师叫他们修闸。\n\nIY 和 SY 迫于威胁不得不修闸。\n\n于是有了下面这一幕。", "description": "IY 和 SY 发现总闸的电路已经完全损坏了，于是他们不得不重新设置一个电路。\n\n机房里有 $n$ 个电流传导节点，每个节点可以用电线连向其他节点。**相通的节点可以互相传递电流**。\n\n由于预留空间的问题，导致有些节点是不能直接连接的。现在 IY 和 SY 知道有 $m$ 组节点可以直接连接，并且知道连接这一组节点需要的电线长度。\n\n光有电流传导节点肯定不行。SY 掏出了她珍藏已久的电源发生器。电源发生器可以附着在结点上，给那个节点供电。但是电源发生器也有一些缺陷，**它只能附着在 $s$ 号节点上，且只有 $k$ 个接口，也就是说附着的节点只能连 $k$ 条电线**，而且由于联动原因，**只有发生器所有的接口都连上电线，发生器才会供电**。\n\n**IY 和 SY 的目标是让所有节点都可以被供电**。他们需要电线，然而电线越长，其价格就以指数倍增长。**所以他们都想让最长的电线尽量短。**\n\nSY 接下了铺设电线的任务，IY 则被分配去买电线，**他需要知道他总共要买多长的电线**。由于 SY 忙于铺设电路，**所以 IY 还要回答 SY 的每个询问：让 $u$ 结点和 $v$ 结点相通所需要的电线的总长度为多少**。但是 IY 太弱了，他根本不知道这些答案是多少。\n\n请你帮助弱弱的 IY 回答这些问题。作为奖励，这道题他会给你满分哦。", "inputFormat": "第一行四个数$n,m,k,s$，表示有$n$个节点，$m$组可以直接连接的节点，电源发生器有$k$个接口，电源发生器附着在 $s$ 节点上。\n\n下面的 $m$ 行，每行三个数 $u,v,w$，表示 $u$ 和 $v$ 节点可以用电线直接相连，在这两个节点之间铺设电线，需要的电线长度为 $w$ 。\n\n再下面一行有一个数 $q$，表示 SY 有 $q$ 个询问。\n\n下面的 $q$ 行每行两个数 $u,v$，表示 SY 询问 IY ： 让$u$ 结点和 $v$ 结点相通需要多长的电线。", "outputFormat": "第一行输出一个数，代表所有电线的总长度。\n\n下面的 $q$ 行，每行一个数，表示对 SY 每个询问的回答。\n\n**可能存在无解的情况，如果无解，则输出\"can not fix it.\"**，然后什么都不要输出。", "hint": "- **样例解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/irpqvatr.png)\n\n如图，发生器附着在节点$1$上且只能连一条电线，其中红线表示连的电线，可以看出这样连是最优的。\n\n- **数据范围**\n\n对于$30\\%$ 的数据：$n \\le 10, m \\le 30, q \\le 10$\n\n对于$50\\%$ 的数据：$n \\le 2000, m \\le 20000, q \\le 2000$\n\n对于$100\\%$ 的数据：$n \\le 30000, m \\le 500000, q \\le 30000, 1 \\le s \\le n, 1 \\le k \\le 150$\n\n对于$100\\%$ 的数据：满足连接两组不同的节点所需电线长度不同（即边权全部不相等），保证运算过程中不会爆$int$\n\n- **出题人的温馨提醒**\n\n题目要满足最长的电线尽量短，在此基础上还要满足次长的电线尽量短，以此类推。\n\n不保证没有重边，但是保证边数足够，不会选择重边。\n\n保证没有自环，保证数据全随机。", "locale": "zh-CN", "translations": {"en": {"title": "[AFOI-19] Power Outage", "background": "After the meetup, it was already night. IY and SY were slacking off in the computer lab, writing code templates.\n\nThen the lab’s power tripped.\n\nThen their “kind” IT teacher told them to fix the breaker.\n\nIY and SY, forced by threats, had to fix it.\n\nSo the following scene happened.", "description": "IY and SY found that the main breaker circuit was completely damaged, so they had to rebuild a circuit.\n\nThere are $n$ current-conducting nodes in the lab. Each node can be connected to other nodes by wires. **Nodes that are connected can transmit current to each other.**\n\nBecause of reserved-space limitations, some nodes cannot be connected directly. Now IY and SY know there are $m$ pairs of nodes that can be connected directly, and they also know the wire length needed to connect each pair.\n\nHaving only conducting nodes is not enough. SY took out her long-kept power generator. The generator can be attached to a node and supply power to that node. However, the generator has some limitations: **it can only be attached to node $s$, and it has only $k$ ports, meaning the attached node can connect to at most $k$ wires**. Also, due to linkage effects, **the generator will supply power only if all its ports are connected to wires**.\n\n**IY and SY’s goal is to make every node receive power.** They need wires, but the longer the wire, the price grows exponentially. **So they want to make the longest wire as short as possible.**\n\nSY is responsible for laying the wires, and IY is assigned to buy the wires, **so he needs to know the total length of wire he has to buy.** Since SY is busy building the circuit, **IY also has to answer each of SY’s queries: what is the total wire length required to make node $u$ and node $v$ connected.** But IY is too weak and does not know the answers.\n\nPlease help the weak IY answer these questions. As a reward, this problem will give you full marks.", "inputFormat": "The first line contains four integers $n, m, k, s$, meaning there are $n$ nodes, $m$ pairs of nodes that can be directly connected, the power generator has $k$ ports, and the generator is attached to node $s$.\n\nThe next $m$ lines each contain three integers $u, v, w$, meaning $u$ and $v$ can be directly connected by a wire, and the required wire length between them is $w$.\n\nThe next line contains an integer $q$, meaning SY has $q$ queries.\n\nThe next $q$ lines each contain two integers $u, v$, meaning SY asks IY: how long a wire (in total) is needed to make node $u$ and node $v$ connected.", "outputFormat": "Output one integer on the first line, representing the total length of all wires.\n\nThen output $q$ lines, each containing one integer, representing the answer to each of SY’s queries.\n\n**There may be cases with no solution. If there is no solution, output \"can not fix it.\"**, and output nothing else.", "hint": "- **Sample Explanation**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/irpqvatr.png)\n\nAs shown, the generator is attached to node $1$ and can connect to only one wire. The red line is the chosen wire. You can see that this is optimal.\n\n- **Constraints**\n\nFor $30\\%$ of the testdata: $n \\le 10, m \\le 30, q \\le 10$.\n\nFor $50\\%$ of the testdata: $n \\le 2000, m \\le 20000, q \\le 2000$.\n\nFor $100\\%$ of the testdata: $n \\le 30000, m \\le 500000, q \\le 30000, 1 \\le s \\le n, 1 \\le k \\le 150$.\n\nFor $100\\%$ of the testdata: the wire lengths required to connect any two different pairs of nodes are all different (i.e. all edge weights are distinct), and it is guaranteed that no $int$ overflow will occur during computation.\n\n- **A Warm Reminder from the Problem Setter**\n\nThe problem requires making the longest wire as short as possible; on this basis, make the second longest wire as short as possible, and so on.\n\nMultiple edges are not ruled out, but the number of edges is sufficient, and no multiple edge will be chosen.\n\nIt is guaranteed that there are no self-loops, and the data is fully random.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【AFOI-19】跳闸", "background": "面基完毕后已经是晚上了，IY 和 SY在机房划水写板子。\n\n然后机房跳闸了。\n\n然后他们核善的信息老师叫他们修闸。\n\nIY 和 SY 迫于威胁不得不修闸。\n\n于是有了下面这一幕。", "description": "IY 和 SY 发现总闸的电路已经完全损坏了，于是他们不得不重新设置一个电路。\n\n机房里有 $n$ 个电流传导节点，每个节点可以用电线连向其他节点。**相通的节点可以互相传递电流**。\n\n由于预留空间的问题，导致有些节点是不能直接连接的。现在 IY 和 SY 知道有 $m$ 组节点可以直接连接，并且知道连接这一组节点需要的电线长度。\n\n光有电流传导节点肯定不行。SY 掏出了她珍藏已久的电源发生器。电源发生器可以附着在结点上，给那个节点供电。但是电源发生器也有一些缺陷，**它只能附着在 $s$ 号节点上，且只有 $k$ 个接口，也就是说附着的节点只能连 $k$ 条电线**，而且由于联动原因，**只有发生器所有的接口都连上电线，发生器才会供电**。\n\n**IY 和 SY 的目标是让所有节点都可以被供电**。他们需要电线，然而电线越长，其价格就以指数倍增长。**所以他们都想让最长的电线尽量短。**\n\nSY 接下了铺设电线的任务，IY 则被分配去买电线，**他需要知道他总共要买多长的电线**。由于 SY 忙于铺设电路，**所以 IY 还要回答 SY 的每个询问：让 $u$ 结点和 $v$ 结点相通所需要的电线的总长度为多少**。但是 IY 太弱了，他根本不知道这些答案是多少。\n\n请你帮助弱弱的 IY 回答这些问题。作为奖励，这道题他会给你满分哦。", "inputFormat": "第一行四个数$n,m,k,s$，表示有$n$个节点，$m$组可以直接连接的节点，电源发生器有$k$个接口，电源发生器附着在 $s$ 节点上。\n\n下面的 $m$ 行，每行三个数 $u,v,w$，表示 $u$ 和 $v$ 节点可以用电线直接相连，在这两个节点之间铺设电线，需要的电线长度为 $w$ 。\n\n再下面一行有一个数 $q$，表示 SY 有 $q$ 个询问。\n\n下面的 $q$ 行每行两个数 $u,v$，表示 SY 询问 IY ： 让$u$ 结点和 $v$ 结点相通需要多长的电线。", "outputFormat": "第一行输出一个数，代表所有电线的总长度。\n\n下面的 $q$ 行，每行一个数，表示对 SY 每个询问的回答。\n\n**可能存在无解的情况，如果无解，则输出\"can not fix it.\"**，然后什么都不要输出。", "hint": "- **样例解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/irpqvatr.png)\n\n如图，发生器附着在节点$1$上且只能连一条电线，其中红线表示连的电线，可以看出这样连是最优的。\n\n- **数据范围**\n\n对于$30\\%$ 的数据：$n \\le 10, m \\le 30, q \\le 10$\n\n对于$50\\%$ 的数据：$n \\le 2000, m \\le 20000, q \\le 2000$\n\n对于$100\\%$ 的数据：$n \\le 30000, m \\le 500000, q \\le 30000, 1 \\le s \\le n, 1 \\le k \\le 150$\n\n对于$100\\%$ 的数据：满足连接两组不同的节点所需电线长度不同（即边权全部不相等），保证运算过程中不会爆$int$\n\n- **出题人的温馨提醒**\n\n题目要满足最长的电线尽量短，在此基础上还要满足次长的电线尽量短，以此类推。\n\n不保证没有重边，但是保证边数足够，不会选择重边。\n\n保证没有自环，保证数据全随机。", "locale": "zh-CN"}}}
