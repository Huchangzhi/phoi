{"pid": "P4279", "type": "P", "difficulty": 5, "samples": [["2\n3\n3 5 1\n1\n1", "John\nBrother"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["博弈论", "2008", "各省省选", "上海"], "title": "[SHOI2008] 小约翰的游戏", "background": "", "description": "小约翰经常和他的哥哥玩一个非常有趣的游戏：桌子上有 $n$ 堆石子，小约翰和他的哥哥轮流取石子，每个人取的时候，可以随意选择一堆石子，在这堆石子中取走任意多的石子，但不能一粒石子也不取，我们规定取到最后一粒石子的人算输。\n\n小约翰相当固执，他坚持认为先取的人有很大的优势，所以他总是先取石子，而他的哥哥就聪明多了，他从来没有在游戏中犯过错误。小约翰一怒之前请你来做他的参谋。自然，你应该先写一个程序，预测一下谁将获得游戏的胜利。", "inputFormat": "本题的输入由多组数据组成，第一行包括一个整数 $T$（$1 \\leq T \\leq 500$），表示输入总共有 $T$ 组数据。\n\n每组数据的第一行包括一个整数 $N$（$1 \\leq N \\leq 50$），表示共有 $N$ 堆石子，接下来有 $N$ 个不超过 $5000$ 的整数，分别表示每堆石子的数目。", "outputFormat": "对于每组数据，如果约翰能赢得比赛，则输出 `John`，否则输出 `Brother`，请注意单词的大小写。", "hint": "- 对于 $40\\%$ 的数据，$T \\leq 250$；\n- 对于 $100\\%$ 的数据，$T \\leq 500$。", "locale": "zh-CN", "translations": {"en": {"title": "[SHOI2008] Little John's Game", "background": "", "description": "Little John often plays a very interesting game with his older brother: On the table there are $n$ heaps of stones. Little John and his brother take turns removing stones. On each turn, a player may choose any heap and remove any positive number of stones from that heap, but may not take zero stones. We stipulate that the player who takes the last stone loses.\n\nLittle John is quite stubborn. He insists that the first player has a big advantage, so he always moves first. His brother is much smarter and has never made a mistake in the game. In anger, Little John asks you to be his adviser. Naturally, you should first write a program to predict who will win the game.", "inputFormat": "The input consists of multiple test cases. The first line contains an integer $T$ ($1 \\leq T \\leq 500$), indicating there are $T$ test cases.\n\nFor each test case, the first line contains an integer $N$ ($1 \\leq N \\leq 50$), indicating there are $N$ heaps of stones. Then follow $N$ integers, each not exceeding $5000$, representing the number of stones in each heap.", "outputFormat": "For each test case, if John can win the game, output `John`; otherwise output `Brother`. Please pay attention to letter case.", "hint": "- For $40\\%$ of the testdata, $T \\leq 250$.\n- For $100\\%$ of the testdata, $T \\leq 500$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SHOI2008] 小约翰的游戏", "background": "", "description": "小约翰经常和他的哥哥玩一个非常有趣的游戏：桌子上有 $n$ 堆石子，小约翰和他的哥哥轮流取石子，每个人取的时候，可以随意选择一堆石子，在这堆石子中取走任意多的石子，但不能一粒石子也不取，我们规定取到最后一粒石子的人算输。\n\n小约翰相当固执，他坚持认为先取的人有很大的优势，所以他总是先取石子，而他的哥哥就聪明多了，他从来没有在游戏中犯过错误。小约翰一怒之前请你来做他的参谋。自然，你应该先写一个程序，预测一下谁将获得游戏的胜利。", "inputFormat": "本题的输入由多组数据组成，第一行包括一个整数 $T$（$1 \\leq T \\leq 500$），表示输入总共有 $T$ 组数据。\n\n每组数据的第一行包括一个整数 $N$（$1 \\leq N \\leq 50$），表示共有 $N$ 堆石子，接下来有 $N$ 个不超过 $5000$ 的整数，分别表示每堆石子的数目。", "outputFormat": "对于每组数据，如果约翰能赢得比赛，则输出 `John`，否则输出 `Brother`，请注意单词的大小写。", "hint": "- 对于 $40\\%$ 的数据，$T \\leq 250$；\n- 对于 $100\\%$ 的数据，$T \\leq 500$。", "locale": "zh-CN"}}}
{"pid": "P4280", "type": "P", "difficulty": 5, "samples": [["5 4\n4 2 -1 -1 3", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2008", "各省省选", "树状数组", "安徽", "前缀和"], "title": "[AHOI2008] 逆序对", "background": "", "description": "暑假到了，小可可和伙伴们来到海边度假，距离海滩不远的地方有个小岛，叫做欢乐岛，整个岛是一个大游乐园，里面有很多很好玩的益智游戏。碰巧岛上正在举行“解谜题赢取免费门票”的活动，只要猜出来迷题，那么小可可和他的朋友就能在欢乐岛上免费游玩两天。\n\n迷题是这样的：给出一串全部是正整数的数字，这些正整数都在一个范围内选取，谁能最快求出这串数字中“逆序对”的个数，那么大奖就是他的啦！\n\n当然、主办方不可能就这么简单的让迷题被解开，数字串都是被处理过的，一部分数字被故意隐藏起来，这些数字均用-1来代替，想要获得大奖就必须求出被处理的数字串中最少能有多少个逆序对。小可可很想获得免费游玩游乐园的机会，你能帮助他吗？\n\n注：“逆序对”就是如果有两个数A和B，A在B左边且A大于B，我们就称这两个数为一个“逆序对”，例如：4 2 1 3 3里面包含了5个逆序对：(4, 2)、(4, 1)、(4, 3)、(4, 3)、(2, 1)。\n\n    假设这串数字由5个正整数组成，其中任一数字N均在1～4之间，数字串中一部分数字被“-1”替代后，如：4 2 -1 -1 3 ，那么这串数字，可能是4 2 1 3 3，也可能是4 2 4 4 3，也可能是别的样子。你要做的就是根据已知的数字，推断出这串数字里最少能有多少个逆序对。", "inputFormat": "第一行两个正整数N和K；\n\n第二行N个整数，每个都是-1或是一个在1~K之间的数（N<=10000，K<=100）。", "outputFormat": "一个正整数，即这些数字里最少的逆序对个数。", "hint": "100%的数据中，N<=10000，K<=100。\n\n60%的数据中，N<=100。\n\n40%的数据中，-1出现不超过两次。", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2008] Inversions", "background": "", "description": "The summer vacation has arrived. Keke and friends are on a beach holiday. Not far from the shore lies a small island called Happy Island. The whole island is a big amusement park with many fun puzzle games. By chance, the island is running an event: “Solve puzzles to win free tickets.” If you solve the puzzle, Keke and friends can play on Happy Island for two days for free.\n\nThe puzzle is: given a sequence of positive integers, all chosen from within a certain range, whoever can find the number of “inversion pairs” in the sequence the fastest wins the prize.\n\nOf course, the organizer will not make it that easy. The sequence has been processed: some numbers are deliberately hidden and replaced by −1. To win the prize, you must find the minimum possible number of inversion pairs that the processed sequence can have. Keke really wants that free chance to play. Can you help?\n\nNote: An “inversion pair” means that if there are two numbers A and B, A is to the left of B and A > B, then (A, B) is an inversion pair. For example: in 4 2 1 3 3, there are 5 inversion pairs: (4, 2), (4, 1), (4, 3), (4, 3), (2, 1).\n\nSuppose the sequence has 5 positive integers, and each number N is between $1$ and $4$. After replacing some numbers by “−1”, e.g., 4 2 −1 −1 3, the original sequence could be 4 2 1 3 3, or 4 2 4 4 3, or something else. Your task is to infer, based on the known numbers, the minimum possible number of inversion pairs in the sequence.", "inputFormat": "The first line contains two positive integers $N$ and $K$.\n\nThe second line contains $N$ integers, each either $-1$ or a number in $1$ to $K$. ($N \\le 10000$, $K \\le 100$.)", "outputFormat": "A single positive integer: the minimum number of inversion pairs in the sequence.", "hint": "- For 100% of the testdata, $N \\le 10000$, $K \\le 100$.\n- For 60% of the testdata, $N \\le 100$.\n- For 40% of the testdata, $-1$ appears no more than twice.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2008] 逆序对", "background": "", "description": "暑假到了，小可可和伙伴们来到海边度假，距离海滩不远的地方有个小岛，叫做欢乐岛，整个岛是一个大游乐园，里面有很多很好玩的益智游戏。碰巧岛上正在举行“解谜题赢取免费门票”的活动，只要猜出来迷题，那么小可可和他的朋友就能在欢乐岛上免费游玩两天。\n\n迷题是这样的：给出一串全部是正整数的数字，这些正整数都在一个范围内选取，谁能最快求出这串数字中“逆序对”的个数，那么大奖就是他的啦！\n\n当然、主办方不可能就这么简单的让迷题被解开，数字串都是被处理过的，一部分数字被故意隐藏起来，这些数字均用-1来代替，想要获得大奖就必须求出被处理的数字串中最少能有多少个逆序对。小可可很想获得免费游玩游乐园的机会，你能帮助他吗？\n\n注：“逆序对”就是如果有两个数A和B，A在B左边且A大于B，我们就称这两个数为一个“逆序对”，例如：4 2 1 3 3里面包含了5个逆序对：(4, 2)、(4, 1)、(4, 3)、(4, 3)、(2, 1)。\n\n    假设这串数字由5个正整数组成，其中任一数字N均在1～4之间，数字串中一部分数字被“-1”替代后，如：4 2 -1 -1 3 ，那么这串数字，可能是4 2 1 3 3，也可能是4 2 4 4 3，也可能是别的样子。你要做的就是根据已知的数字，推断出这串数字里最少能有多少个逆序对。", "inputFormat": "第一行两个正整数N和K；\n\n第二行N个整数，每个都是-1或是一个在1~K之间的数（N<=10000，K<=100）。", "outputFormat": "一个正整数，即这些数字里最少的逆序对个数。", "hint": "100%的数据中，N<=10000，K<=100。\n\n60%的数据中，N<=100。\n\n40%的数据中，-1出现不超过两次。", "locale": "zh-CN"}}}
{"pid": "P4281", "type": "P", "difficulty": 4, "samples": [["6 4  \n1 2  \n2 3  \n2 4 \n4 5\n5 6\n4 5 6\n6 3 1\n2 4 4 \n6 6 6", "5 2\n2 5\n4 1\n6 0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2008", "倍增", "各省省选", "安徽", "最近公共祖先 LCA", "树链剖分"], "title": "[AHOI2008] 紧急集合 / 聚会", "background": "", "description": "欢乐岛上有个非常好玩的游戏，叫做“紧急集合”。在岛上分散有 $n$ 个等待点，有 $n-1$ 条道路连接着它们，每一条道路都连接某两个等待点，且通过这些道路可以走遍所有的等待点，通过道路从一个点到另一个点要花费一个游戏币。\n\n参加游戏的人三人一组，开始的时候，所有人员均任意分散在各个等待点上（每个点同时允许多个人等待），每个人均带有足够多的游戏币（用于支付使用道路的花费）、地图（标明等待点之间道路连接的情况）以及对话机（用于和同组的成员联系）。当集合号吹响后，每组成员之间迅速联系，了解到自己组所有成员所在的等待点后，迅速在 $n$ 个等待点中确定一个集结点，组内所有成员将在该集合点集合，集合所用花费最少的组将是游戏的赢家。\n\n小可可和他的朋友邀请你一起参加这个游戏，由你来选择集合点，聪明的你能够完成这个任务，帮助小可可赢得游戏吗？\n", "inputFormat": "第一行两个正整数 $n$ 和 $m$，分别表示等待点的个数（等待点也从 $1$ 到 $n$ 进行编号）和获奖所需要完成集合的次数。\n\n随后 $n-1$ 行，每行两个正整数 $a,b$，表示编号为 $a$ 和编号为 $b$ 的等待点之间有一条路。\n\n随后 $m$ 行，每行用三个正整数 $x,y,z$，表示某次集合前小可可、小可可的朋友以及你所在等待点的编号。", "outputFormat": "输出共 $m$ 行，每行两个用空格隔开的整数 $p,c$。其中第 $i$ 行表示第 $i$ 次集合点选择在编号为 $p$ 的等待点，集合总共的花费是 $c$ 个游戏币。", "hint": "对于 $40\\%$ 的数据，$n\\leq2\\times10^3$，$m\\leq2\\times 10^3$。\n\n对于 $100\\%$ 的数据，$1\\leq x,y,z\\leq n\\leq 5\\times10^5$，$1\\leq m\\leq 5\\times 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2008] Emergency Assembly / Gathering", "background": "", "description": "On Happy Island there is a fun game called \"Emergency Assembly.\" There are $n$ waiting points scattered around the island, connected by $n-1$ roads. Each road connects two waiting points, and by these roads one can reach all waiting points. Moving along a road from one point to another costs one game coin.\n\nPlayers participate in teams of three. At the start, all players are arbitrarily located at various waiting points (each point may have multiple players waiting at the same time). Every player carries enough game coins (to pay the road costs), a map (showing the road connections between the waiting points), and a communicator (to contact their teammates). When the assembly signal sounds, teammates quickly contact each other, learn the waiting points of all members in their team, and then promptly choose one meeting point among the $n$ waiting points. All team members will gather at that meeting point. The team with the smallest total cost of gathering will be the winner.\n\nXiao Keke and friends invite you to join the game, and you are in charge of choosing the meeting point. Can you smartly complete this task and help Xiao Keke win?", "inputFormat": "The first line contains two positive integers $n$ and $m$, denoting the number of waiting points (waiting points are numbered from $1$ to $n$) and the number of gatherings that must be completed to win a prize.\n\nThen follow $n-1$ lines. Each of these lines contains two positive integers $a, b$, indicating there is a road between waiting point $a$ and waiting point $b$.\n\nThen follow $m$ lines. Each line contains three positive integers $x, y, z$, indicating, before a particular gathering, the waiting points occupied by Xiao Keke, Xiao Keke’s friend, and you, respectively.", "outputFormat": "Output $m$ lines. Each line should contain two integers $p, c$ separated by a space. The $i$-th line indicates that for the $i$-th gathering, the chosen meeting point is the waiting point numbered $p$, and the total cost of gathering is $c$ game coins.", "hint": "- For $40\\%$ of the testdata, $n \\leq 2 \\times 10^3$, $m \\leq 2 \\times 10^3$.\n- For $100\\%$ of the testdata, $1 \\leq x, y, z \\leq n \\leq 5 \\times 10^5$, $1 \\leq m \\leq 5 \\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2008] 紧急集合 / 聚会", "background": "", "description": "欢乐岛上有个非常好玩的游戏，叫做“紧急集合”。在岛上分散有 $n$ 个等待点，有 $n-1$ 条道路连接着它们，每一条道路都连接某两个等待点，且通过这些道路可以走遍所有的等待点，通过道路从一个点到另一个点要花费一个游戏币。\n\n参加游戏的人三人一组，开始的时候，所有人员均任意分散在各个等待点上（每个点同时允许多个人等待），每个人均带有足够多的游戏币（用于支付使用道路的花费）、地图（标明等待点之间道路连接的情况）以及对话机（用于和同组的成员联系）。当集合号吹响后，每组成员之间迅速联系，了解到自己组所有成员所在的等待点后，迅速在 $n$ 个等待点中确定一个集结点，组内所有成员将在该集合点集合，集合所用花费最少的组将是游戏的赢家。\n\n小可可和他的朋友邀请你一起参加这个游戏，由你来选择集合点，聪明的你能够完成这个任务，帮助小可可赢得游戏吗？\n", "inputFormat": "第一行两个正整数 $n$ 和 $m$，分别表示等待点的个数（等待点也从 $1$ 到 $n$ 进行编号）和获奖所需要完成集合的次数。\n\n随后 $n-1$ 行，每行两个正整数 $a,b$，表示编号为 $a$ 和编号为 $b$ 的等待点之间有一条路。\n\n随后 $m$ 行，每行用三个正整数 $x,y,z$，表示某次集合前小可可、小可可的朋友以及你所在等待点的编号。", "outputFormat": "输出共 $m$ 行，每行两个用空格隔开的整数 $p,c$。其中第 $i$ 行表示第 $i$ 次集合点选择在编号为 $p$ 的等待点，集合总共的花费是 $c$ 个游戏币。", "hint": "对于 $40\\%$ 的数据，$n\\leq2\\times10^3$，$m\\leq2\\times 10^3$。\n\n对于 $100\\%$ 的数据，$1\\leq x,y,z\\leq n\\leq 5\\times10^5$，$1\\leq m\\leq 5\\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P4282", "type": "P", "difficulty": 2, "samples": [["3\n3 2 5\n1 1 2\n+\n0 0 3", "2 0 0\n\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "高精度", "2008", "各省省选", "安徽", "进制"], "title": "[AHOI2008] 计算器", "background": "", "description": "小可可在欢乐岛的快乐旅程还在继续，他想买一些纪念品带回去给同学们，于是来到了礼品部，在这里他发现了一个有趣的计算器.\n\n这个计算器是一种特殊的、支持变进制整数加减运算的计算器（所谓变进制，就是每一位的进制可以不同。例如，如果最低位是 $3$ 进制，次低位是 $5$ 进制，那么这种情况的 $42$ 转化成十进制就是 $4\\times 3+2=14$）。\n\n店主看小可可对这个计算器非常感兴趣，于是他问小可可：“小朋友，如果我告诉你这个计算器最多可以支持 $N$ 位的变进制整数，且每一位的进制分别是 $x_1,x_2,\\ldots,x_n$，那么你知道它能表示的最大整数 $M$ 是多少吗?”，小可可想了想说到：“它所能表示的最大的整数 $M$ 是 $(x_1\\times x_2\\times \\cdots\\times x_n)-1$。”\n\n店主非常高兴，说道：“你真是个聪明的孩子，如果我告诉你两个长度为 $N$ 的变进制整数 $A,B$，你按照我的要求来计算 $(A＋B)\\bmod(M+1)$ 或 $(A-B)\\bmod(M+1)$，答案还是用相同的变进制来表示，如果你算对了，那么我就把这个计算器送给你。”\n\n这下把小可可难住了，但是他非常想要这个计算器，聪明的你能够帮助小可可吗?", "inputFormat": "第一行包含一个整数 $N$，表示计算器所支持的变进制数的长度。\n\n第二行包含 $N$ 个整数 $x_1,x_2,\\ldots,x_N$，表示第 $1\\sim n$ 位的进制（从最高位到最低位）。\n\n第三行包含 $N$ 个整数 $A_1,A_2,\\ldots,A_N$，表示第一个运算数。\n\n第四行包含一个字符 $op$，表示需要实现的运算类型。\n\n第五行包含 $N$ 个整数 $B_1,B_2,\\ldots,B_N$，表示第二个运算数。", "outputFormat": "若 $op$ 为 `＋`，则输出 $(A+B)\\bmod(M+1)$ 的值，否则输出 $(A-B)\\bmod(M+1)$ 的值，每一位之间用一个空格隔开，注意高位补零，最高位之前和最低位之后不要有空格。", "hint": "$100\\%$ 的数据中，$1\\le N \\le 10^5$，$1 < x_1,x_2,\\ldots x_N<100$。\n\n$30\\%$ 的数据中，$N \\le 9$，$x_1 = x_2 =\\ldots = x_N =10$。", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2008] Calculator", "background": "", "description": "Keke’s happy journey on Joy Island continues. He wants to buy some souvenirs for his classmates, so he goes to the gift shop and finds an interesting calculator.\n\nThis calculator is a special one that supports addition and subtraction of mixed-radix integers (mixed-radix means each digit can have a different base. For example, if the least significant digit uses base $3$ and the next digit uses base $5$, then $42$ in this system converts to decimal as $4\\times 3+2=14$).\n\nThe shopkeeper notices Keke’s interest and asks: “Kid, if I tell you this calculator supports mixed-radix integers of up to $N$ digits, and the bases for each digit are $x_1,x_2,\\ldots,x_n$, do you know the maximum integer $M$ it can represent?” Keke thinks for a while and answers: “The maximum integer $M$ it can represent is $(x_1\\times x_2\\times \\cdots\\times x_n)-1$.”\n\nThe shopkeeper is very happy and says: “You are a smart kid. If I give you two mixed-radix integers $A$ and $B$ of length $N$, compute $(A + B)\\bmod(M+1)$ or $(A - B)\\bmod(M+1)$ as required, and give the answer in the same mixed-radix system. If you get it right, I will give you this calculator.”\n\nThis stumps Keke, but he really wants the calculator. Can you help him?", "inputFormat": "- The first line contains an integer $N$, the length of the mixed-radix numbers supported by the calculator.\n- The second line contains $N$ integers $x_1,x_2,\\ldots,x_N$, the bases of digits $1\\sim N$ (from the most significant digit to the least significant digit).\n- The third line contains $N$ integers $A_1,A_2,\\ldots,A_N$, representing the first operand.\n- The fourth line contains a character $op$, representing the operation type.\n- The fifth line contains $N$ integers $B_1,B_2,\\ldots,B_N$, representing the second operand.", "outputFormat": "If $op$ is '+', output $(A+B)\\bmod(M+1)$. Otherwise, output $(A-B)\\bmod(M+1)$. Separate digits with a single space, pad with leading zeros to $N$ digits, and do not print extra spaces before the most significant digit or after the least significant digit.", "hint": "Constraints:\n- For $100\\%$ of the testdata, $1\\le N \\le 10^5$, $1 < x_1,x_2,\\ldots,x_N<100$.\n- For $30\\%$ of the testdata, $N \\le 9$, and $x_1 = x_2 = \\ldots = x_N = 10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2008] 计算器", "background": "", "description": "小可可在欢乐岛的快乐旅程还在继续，他想买一些纪念品带回去给同学们，于是来到了礼品部，在这里他发现了一个有趣的计算器.\n\n这个计算器是一种特殊的、支持变进制整数加减运算的计算器（所谓变进制，就是每一位的进制可以不同。例如，如果最低位是 $3$ 进制，次低位是 $5$ 进制，那么这种情况的 $42$ 转化成十进制就是 $4\\times 3+2=14$）。\n\n店主看小可可对这个计算器非常感兴趣，于是他问小可可：“小朋友，如果我告诉你这个计算器最多可以支持 $N$ 位的变进制整数，且每一位的进制分别是 $x_1,x_2,\\ldots,x_n$，那么你知道它能表示的最大整数 $M$ 是多少吗?”，小可可想了想说到：“它所能表示的最大的整数 $M$ 是 $(x_1\\times x_2\\times \\cdots\\times x_n)-1$。”\n\n店主非常高兴，说道：“你真是个聪明的孩子，如果我告诉你两个长度为 $N$ 的变进制整数 $A,B$，你按照我的要求来计算 $(A＋B)\\bmod(M+1)$ 或 $(A-B)\\bmod(M+1)$，答案还是用相同的变进制来表示，如果你算对了，那么我就把这个计算器送给你。”\n\n这下把小可可难住了，但是他非常想要这个计算器，聪明的你能够帮助小可可吗?", "inputFormat": "第一行包含一个整数 $N$，表示计算器所支持的变进制数的长度。\n\n第二行包含 $N$ 个整数 $x_1,x_2,\\ldots,x_N$，表示第 $1\\sim n$ 位的进制（从最高位到最低位）。\n\n第三行包含 $N$ 个整数 $A_1,A_2,\\ldots,A_N$，表示第一个运算数。\n\n第四行包含一个字符 $op$，表示需要实现的运算类型。\n\n第五行包含 $N$ 个整数 $B_1,B_2,\\ldots,B_N$，表示第二个运算数。", "outputFormat": "若 $op$ 为 `＋`，则输出 $(A+B)\\bmod(M+1)$ 的值，否则输出 $(A-B)\\bmod(M+1)$ 的值，每一位之间用一个空格隔开，注意高位补零，最高位之前和最低位之后不要有空格。", "hint": "$100\\%$ 的数据中，$1\\le N \\le 10^5$，$1 < x_1,x_2,\\ldots x_N<100$。\n\n$30\\%$ 的数据中，$N \\le 9$，$x_1 = x_2 =\\ldots = x_N =10$。", "locale": "zh-CN"}}}
{"pid": "P4283", "type": "P", "difficulty": 3, "samples": [["3 CAT\n3 TAC\n5 CATCH", "8\n\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2008", "各省省选", "安徽"], "title": "[AHOI2008] Y型项链", "background": null, "description": "欢乐岛上众多新奇的游乐项目让小可可他们玩的非常开心。现在他们正在玩比赛串项链的游戏，谁串的最快就能得到优厚的奖品。\n\n这可不是普通的项链，而是一种 Y 型项链，项链的最中间有一颗大珍珠作为结合点，从大珍珠上连出来 3 条由各种宝石串起来的链子。\n\n比赛的规则是这样的：每次可以从三条链子中某一条的末端取下来一个宝石，或者安上去一个宝石，称为一次操作，经过若干次操作，最终使得三条链子完全相同。想要赢得比赛，那么只能使用尽量少的操作次数。\n\n假设每种宝石都有无数多个以供使用，且链子足够长。你能帮助小可可赢得比赛吗？\n\n注：由于对 Y 型项链的宝石数没有特殊的要求，所以即使你把所有宝石都取下来，也是一个可以接受的方案（三根没有串宝石的绳子也是完全一样的）。", "inputFormat": "一共有 $3$ 行，表示 Y 型项链的三条链子，每行开始有一个整数 $N$ ，表示初始时这条链子上串有 $N$ 个宝石，随后是一个空格，然后是 $N$ 个大写字母，表示这个链子上的宝石，每个字母表示一种不同的宝石，这个字符串最左边的字符表示的是离大珍珠最近的那个宝石，而最右边的表示的是在链子末端的宝石。", "outputFormat": "只有一个整数，表示所需要的最少的操作次数。", "hint": "对于 $50\\%$ 的数据，$N\\leq 20$。\n\n对于 $100\\%$ 的数据，$1\\le N\\le 50$。", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2008] Y-shaped Necklace", "background": "", "description": "The many novel attractions on Happy Island make Xiao Keke and friends very happy. They are now competing in a necklace-threading game; whoever finishes the fastest wins a generous prize.\n\nThis is not an ordinary necklace, but a Y-shaped necklace. At the very center there is a big pearl serving as the junction, and from it extend 3 chains strung with various gemstones.\n\nThe rules are as follows: each time, you may either take one gemstone off from the end of one of the three chains, or attach one gemstone to the end of one of the three chains. This counts as one operation. After a number of operations, the goal is to make the three chains exactly the same. To win, you must use as few operations as possible.\n\nAssume there are infinitely many of each type of gemstone available, and the chains are long enough. Can you help Xiao Keke win?\n\nNote: Because there is no special requirement on the number of gemstones on the Y-shaped necklace, removing all gemstones is also an acceptable plan (three strings without gemstones are identical).", "inputFormat": "There are $3$ lines, describing the three chains of the Y-shaped necklace. Each line begins with an integer $N$, indicating the number of gemstones initially on this chain, followed by a space, and then $N$ uppercase letters representing the gemstones on this chain. Each letter denotes a type of gemstone. The leftmost character of the string is the gemstone closest to the big pearl, and the rightmost character is the gemstone at the end of the chain.", "outputFormat": "Output a single integer: the minimum number of operations required.", "hint": "For $50\\%$ of the testdata, $N\\leq 20$.\n\nFor $100\\%$ of the testdata, $1\\le N\\le 50$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2008] Y型项链", "background": null, "description": "欢乐岛上众多新奇的游乐项目让小可可他们玩的非常开心。现在他们正在玩比赛串项链的游戏，谁串的最快就能得到优厚的奖品。\n\n这可不是普通的项链，而是一种 Y 型项链，项链的最中间有一颗大珍珠作为结合点，从大珍珠上连出来 3 条由各种宝石串起来的链子。\n\n比赛的规则是这样的：每次可以从三条链子中某一条的末端取下来一个宝石，或者安上去一个宝石，称为一次操作，经过若干次操作，最终使得三条链子完全相同。想要赢得比赛，那么只能使用尽量少的操作次数。\n\n假设每种宝石都有无数多个以供使用，且链子足够长。你能帮助小可可赢得比赛吗？\n\n注：由于对 Y 型项链的宝石数没有特殊的要求，所以即使你把所有宝石都取下来，也是一个可以接受的方案（三根没有串宝石的绳子也是完全一样的）。", "inputFormat": "一共有 $3$ 行，表示 Y 型项链的三条链子，每行开始有一个整数 $N$ ，表示初始时这条链子上串有 $N$ 个宝石，随后是一个空格，然后是 $N$ 个大写字母，表示这个链子上的宝石，每个字母表示一种不同的宝石，这个字符串最左边的字符表示的是离大珍珠最近的那个宝石，而最右边的表示的是在链子末端的宝石。", "outputFormat": "只有一个整数，表示所需要的最少的操作次数。", "hint": "对于 $50\\%$ 的数据，$N\\leq 20$。\n\n对于 $100\\%$ 的数据，$1\\le N\\le 50$。", "locale": "zh-CN"}}}
{"pid": "P4284", "type": "P", "difficulty": 6, "samples": [["3\n1 2 50\n1 3 50\n50 0 0", "1.000000"], ["5\n1 2 90\n1 3 80\n1 4 70\n1 5 60\n100 10 20 30 40", "4.300000"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2014", "各省省选", "上海", "连通块", "概率论", "期望"], "title": "[SHOI2014] 概率充电器", "background": null, "description": "著名的电子产品品牌 SHOI 刚刚发布了引领世界潮流的下一代电子产品——概率充电器：\n\n“采用全新纳米级加工技术，实现元件与导线能否通电完全由真随机数决定！SHOI 概率充电器，您生活不可或缺的必需品！能充上电吗？现在就试试看吧！”\n\nSHOI 概率充电器由 $n-1$ 条导线连通了 $n$ 个充电元件。进行充电时，每条导线是否可以导电以概率决定，每一个充电元件自身是否直接进行充电也由概率决定。随后电能可以从直接充电的元件经过通电的导线使得其他充电元件进行间接充电。\n\n作为 SHOI 公司的忠实客户，你无法抑制自己购买 SHOI 产品的冲动。在排了一个星期的长队之后终于入手了最新型号的 SHOI 概率充电器。你迫不及待地将 SHOI 概率充电器插入电源——这时你突然想知道，进入充电状态的元件个数的期望是多少呢？", "inputFormat": "第一行一个整数 $n$。概率充电器的充电元件个数。充电元件由 $1 \\sim n$ 编号。\n\n之后的 $n-1$ 行每行三个整数 $a, b, p$，描述了一根导线连接了编号为 $a$ 和 $b$ 的充电元件，通电概率为 $p\\%$。\n\n第 $n+1$ 行 $n$ 个整数 $q_i$。表示 $i$ 号元件直接充电的概率为 $q_i\\%$。", "outputFormat": "输出一行一个实数，为能进入充电状态的元件个数的期望，四舍五入到小数点后 $6$ 位小数。", "hint": "对于 $30\\%$ 的数据，$n \\leq 5 \\times 10^3$。\n\n对于 $100\\%$ 的数据，$n \\leq 5 \\times 10^5$，$0 \\leq p,q_i \\leq 100$。", "locale": "zh-CN", "translations": {"en": {"title": "[SHOI2014] Probability Charger", "background": "", "description": "The famous electronics brand SHOI has just released the next-generation product leading the global trend — the Probability Charger:\n\n“Using brand-new nano-scale fabrication technology, whether components and wires conduct is determined entirely by true random numbers! The SHOI Probability Charger, an indispensable necessity in your life! Can it charge? Try it now!”\n\nThe SHOI Probability Charger connects $n$ charging components with $n-1$ wires. During charging, whether each wire can conduct is decided by probability, and whether each component charges directly is also decided by probability. Then electric energy can travel from components that charge directly, through conducting wires, to make other components charge indirectly.\n\nAs a loyal customer of SHOI, you cannot resist the impulse to buy SHOI products. After waiting in a long line for a week, you finally get the latest model of the SHOI Probability Charger. You eagerly plug it into the power source — and suddenly wonder: what is the expected number of components that enter the charging state?", "inputFormat": "The first line contains an integer $n$, the number of charging components. The components are numbered $1 \\sim n$.\n\nEach of the next $n-1$ lines contains three integers $a, b, p$, describing a wire connecting components $a$ and $b$, with conduction probability $p\\%$.\n\nThe $(n+1)$-th line contains $n$ integers $q_i$, meaning that component $i$ charges directly with probability $q_i\\%$.", "outputFormat": "Output one real number: the expected number of components that enter the charging state, rounded to 6 decimal places.", "hint": "- Constraints:\n  - For $30\\%$ of the testdata, $n \\leq 5 \\times 10^3$.\n  - For $100\\%$ of the testdata, $n \\leq 5 \\times 10^5$, $0 \\leq p, q_i \\leq 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SHOI2014] 概率充电器", "background": null, "description": "著名的电子产品品牌 SHOI 刚刚发布了引领世界潮流的下一代电子产品——概率充电器：\n\n“采用全新纳米级加工技术，实现元件与导线能否通电完全由真随机数决定！SHOI 概率充电器，您生活不可或缺的必需品！能充上电吗？现在就试试看吧！”\n\nSHOI 概率充电器由 $n-1$ 条导线连通了 $n$ 个充电元件。进行充电时，每条导线是否可以导电以概率决定，每一个充电元件自身是否直接进行充电也由概率决定。随后电能可以从直接充电的元件经过通电的导线使得其他充电元件进行间接充电。\n\n作为 SHOI 公司的忠实客户，你无法抑制自己购买 SHOI 产品的冲动。在排了一个星期的长队之后终于入手了最新型号的 SHOI 概率充电器。你迫不及待地将 SHOI 概率充电器插入电源——这时你突然想知道，进入充电状态的元件个数的期望是多少呢？", "inputFormat": "第一行一个整数 $n$。概率充电器的充电元件个数。充电元件由 $1 \\sim n$ 编号。\n\n之后的 $n-1$ 行每行三个整数 $a, b, p$，描述了一根导线连接了编号为 $a$ 和 $b$ 的充电元件，通电概率为 $p\\%$。\n\n第 $n+1$ 行 $n$ 个整数 $q_i$。表示 $i$ 号元件直接充电的概率为 $q_i\\%$。", "outputFormat": "输出一行一个实数，为能进入充电状态的元件个数的期望，四舍五入到小数点后 $6$ 位小数。", "hint": "对于 $30\\%$ 的数据，$n \\leq 5 \\times 10^3$。\n\n对于 $100\\%$ 的数据，$n \\leq 5 \\times 10^5$，$0 \\leq p,q_i \\leq 100$。", "locale": "zh-CN"}}}
{"pid": "P4285", "type": "P", "difficulty": 6, "samples": [["3\nAB BC CA BA CB AC", "7"], ["2\nAB BA CA BC CB AC", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["递推", "2008", "各省省选", "递归", "上海", "线性递推"], "title": "[SHOI2008] 汉诺塔", "background": null, "description": "汉诺塔由三根柱子（分别用 A、B、C 表示）和 $n$ 个大小互不相同的空心盘子组成。一开始 $n$ 个盘子都摞在柱子 A 上，大的在下面，小的在上面，形成了一个塔状的锥形体。\n\n对汉诺塔的一次合法的操作是指：从一根柱子的最上层拿一个盘子放到另一根柱子的最上层，同时要保证被移动的盘子一定放在比它更大的盘子上面（如果移动到空柱子上就不需要满足这个要求）。我们可以用两个字母来描述一次操作：第一个字母代表起始柱子，第二个字母代表目标柱子。例如，AB 就是把柱子 A 最上面的那个盘子移到柱子B。汉诺塔的游戏目标是将所有的盘子从柱子 A 移动到柱子 B 或柱子 C 上面。\n\n有一种非常简洁而经典的策略可以帮助我们完成这个游戏。首先，在任何操作执行之前，我们以任意的次序为六种操作（AB、AC、BA、BC、CA 和 CB）赋予不同的优先级，然后，我们总是选择符合以下两个条件的操作来移动盘子，直到所有的盘子都从柱子 A 移动到另一根柱子：\n\n1. 这种操作是所有合法操作中优先级最高的；\n2. 这种操作所要移动的盘子不是上一次操作所移动的那个盘子。\n\n可以证明，上述策略一定能完成汉诺塔游戏。现在你的任务就是假设给定了每种操作的优先级，计算按照上述策略操作汉诺塔移动所需要的步骤数。\n\n![](https://cdn.luogu.com.cn/upload/pic/21997.png)", "inputFormat": "输入有两行。第一行为一个整数 $n(1≤n≤30)$，代表盘子的个数。第二行是一串大写的 ABC 字符，代表六种操作的优先级，靠前的操作具有较高的优先级。每种操作都由一个空格隔开。", "outputFormat": "只需输出一个数，这个数表示移动的次数。我们保证答案不会超过 $10^{18}$。", "hint": "对于 $20\\%$ 的数据，$n≤10$。  \n对于 $100\\%$ 的数据，$1\\le n≤30$。", "locale": "zh-CN", "translations": {"en": {"title": "[SHOI2008] Towers of Hanoi", "background": "# Description\n\nThe Towers of Hanoi consists of three pegs (denoted A, B, C) and $n$ disks of distinct sizes. Initially, all $n$ disks are stacked on peg A, with larger disks below smaller ones, forming a conical tower.\n\nA legal move is: take the top disk from one peg and place it on top of another peg, with the constraint that the moved disk must be placed on a larger disk (this constraint is waived if the target peg is empty). We can describe a move with two letters: the first letter is the source peg, and the second is the destination peg. For example, AB means moving the top disk from peg A to peg B. The goal of the game is to move all disks from peg A onto either peg B or peg C.\n\nThere is a concise and classic strategy to complete this game. Before any move, assign distinct priorities, in any order, to the six possible moves: AB, AC, BA, BC, CA, CB. Then, repeatedly choose the move that satisfies both conditions below, until all disks have been moved from peg A to another peg:\n(1) Among all legal moves, it has the highest priority.\n(2) The disk to be moved is not the same disk that was moved in the previous step.\n\nIt can be proven that this strategy will always complete the Towers of Hanoi. Your task is: given the priority of each move, compute the number of steps needed under the strategy above.\n\n![](https://cdn.luogu.com.cn/upload/pic/21997.png)", "description": "The Towers of Hanoi consists of three pegs (denoted A, B, C) and $n$ disks of distinct sizes. Initially, all $n$ disks are stacked on peg A, with larger disks below smaller ones, forming a conical tower.\n\nA legal move is: take the top disk from one peg and place it on top of another peg, with the constraint that the moved disk must be placed on a larger disk (this constraint is waived if the target peg is empty). We can describe a move with two letters: the first letter is the source peg, and the second is the destination peg. For example, AB means moving the top disk from peg A to peg B. The goal of the game is to move all disks from peg A onto either peg B or peg C.\n\nThere is a concise and classic strategy to complete this game. Before any move, assign distinct priorities, in any order, to the six possible moves: AB, AC, BA, BC, CA, CB. Then, repeatedly choose the move that satisfies both conditions below, until all disks have been moved from peg A to another peg:\n(1) Among all legal moves, it has the highest priority.\n(2) The disk to be moved is not the same disk that was moved in the previous step.\n\nIt can be proven that this strategy will always complete the Towers of Hanoi. Your task is: given the priority of each move, compute the number of steps needed under the strategy above.\n\n![](https://cdn.luogu.com.cn/upload/pic/21997.png)\n\n# Description", "inputFormat": "The input consists of two lines.\n- The first line contains an integer $n$ ($1 \\le n \\le 30$), the number of disks.\n- The second line contains the six moves as a permutation of AB, AC, BA, BC, CA, CB, separated by spaces, where earlier moves have higher priority.", "outputFormat": "Output a single integer: the number of moves. It is guaranteed that the answer does not exceed $10^{18}$.", "hint": "- For 20% of the testdata, $n \\le 10$.\n- For 100% of the testdata, $n \\le 30$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SHOI2008] 汉诺塔", "background": null, "description": "汉诺塔由三根柱子（分别用 A、B、C 表示）和 $n$ 个大小互不相同的空心盘子组成。一开始 $n$ 个盘子都摞在柱子 A 上，大的在下面，小的在上面，形成了一个塔状的锥形体。\n\n对汉诺塔的一次合法的操作是指：从一根柱子的最上层拿一个盘子放到另一根柱子的最上层，同时要保证被移动的盘子一定放在比它更大的盘子上面（如果移动到空柱子上就不需要满足这个要求）。我们可以用两个字母来描述一次操作：第一个字母代表起始柱子，第二个字母代表目标柱子。例如，AB 就是把柱子 A 最上面的那个盘子移到柱子B。汉诺塔的游戏目标是将所有的盘子从柱子 A 移动到柱子 B 或柱子 C 上面。\n\n有一种非常简洁而经典的策略可以帮助我们完成这个游戏。首先，在任何操作执行之前，我们以任意的次序为六种操作（AB、AC、BA、BC、CA 和 CB）赋予不同的优先级，然后，我们总是选择符合以下两个条件的操作来移动盘子，直到所有的盘子都从柱子 A 移动到另一根柱子：\n\n1. 这种操作是所有合法操作中优先级最高的；\n2. 这种操作所要移动的盘子不是上一次操作所移动的那个盘子。\n\n可以证明，上述策略一定能完成汉诺塔游戏。现在你的任务就是假设给定了每种操作的优先级，计算按照上述策略操作汉诺塔移动所需要的步骤数。\n\n![](https://cdn.luogu.com.cn/upload/pic/21997.png)", "inputFormat": "输入有两行。第一行为一个整数 $n(1≤n≤30)$，代表盘子的个数。第二行是一串大写的 ABC 字符，代表六种操作的优先级，靠前的操作具有较高的优先级。每种操作都由一个空格隔开。", "outputFormat": "只需输出一个数，这个数表示移动的次数。我们保证答案不会超过 $10^{18}$。", "hint": "对于 $20\\%$ 的数据，$n≤10$。  \n对于 $100\\%$ 的数据，$1\\le n≤30$。", "locale": "zh-CN"}}}
{"pid": "P4286", "type": "P", "difficulty": 6, "samples": [["1 2\n-9 -6\n5 1\n3\n0 16\n-16 -12\n17 -6", "0.00"], ["2 3\n12 4\n16 17\n3 9\n4\n1 0\n4 19\n19 14\n6 12\n3\n10 10\n5 3\n18 2", "2.94"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2008", "各省省选", "上海"], "title": "[SHOI2008] 安全的航线", "background": "", "description": "在设计航线的时候，安全是一个很重要的问题。首先，最重要的是应采取一切措施确保飞行不会发生任何事故，但同时也需要做好最坏的打算，一旦事故发生，就要确保乘客有尽量高的生还几率。\n\n当飞机迫降到海上的时候，最近的陆地就是一个关键的因素。航线中最危险的地方就是距离最近的陆地最远的地方，我们称这种点为这条航线“孤地点”。孤地点到最近陆地的距离被称为“孤地距离”。作为航空公司的高级顾问，你接受的第一个任务就是尽量找出一条航线的孤地点，并计算这条航线的孤地距离。\n\n为了简化问题，我们认为地图是一个二维平面，陆地可以用多边形近似，飞行线路为一条折线。航线的起点和终点都在陆地上，但中间的转折点是可能在海上（如下图所示，方格标示出了孤地点）。\n\n![](https://cdn.luogu.com.cn/upload/pic/15457.png)", "inputFormat": "输入的第一行包括两个整数C和N（1≤C≤20，2≤N≤20），分别代表陆地的数目的航线的转折点的数目。\n\n接下来有N行，每行有两个整数x,y。(x,y)表示一个航线转折点的坐标，第一个转折点为航线的起点，最后一个转折点为航线的终点。\n\n接下来的输入将用来描述C块大陆。每块输入由一个正整数M开始（M≤30），M表示多边形的顶点个数，接下来的M行，每行会包含两个整数x,y，(x,y)表示多边形的一个顶点坐标，我们保证这些顶点以顺时针或逆时针给出了该多边形的闭包，不会出现某些边相交的情况。此外我们也保证输入数据中任何两块大陆不会相交。\n\n输入的所有坐标将保证在-10,000到10,000的范围之间。", "outputFormat": "输出一个浮点数，表示航线的孤地距离，数据保留2位小数。", "hint": "对于50%的数据，1≤C≤2，2≤N≤5;\n\n对于100%的数据，1≤C≤20，2≤N≤20。", "locale": "zh-CN", "translations": {"en": {"title": "[SHOI2008] Safe Air Route", "background": "", "description": "When designing air routes, safety is a crucial concern. First, the most important thing is to take every measure to ensure that no accident occurs during flight. At the same time, we must also prepare for the worst: if an accident happens, passengers should have the highest possible chance of survival.\n\nWhen a plane makes an emergency landing on the sea, the nearest land becomes a key factor. The most dangerous location along a route is the point that is farthest from the nearest land; we call such a point the route’s “isolation point.” The distance from the isolation point to the closest land is called the “isolation distance.” As a senior consultant for an airline, your first task is to find a route’s isolation point as best as possible and compute this route’s isolation distance.\n\nTo simplify the problem, we consider the map as a 2D plane, land masses are approximated by polygons, and the flight route is a polyline. The start and end points of the route lie on land, but intermediate turning points may be on the sea (as shown in the figure below; the grid marks the isolation point).\n\n![](https://cdn.luogu.com.cn/upload/pic/15457.png)", "inputFormat": "The first line contains two integers $C$ and $N$ ($1 \\le C \\le 20$, $2 \\le N \\le 20$), representing the number of land masses and the number of turning points of the route, respectively.\n\nThen there are $N$ lines, each containing two integers $x, y$. The pair $(x, y)$ is the coordinate of a turning point of the route. The first turning point is the start of the route, and the last turning point is the end of the route.\n\nThe next part of the input describes the $C$ land masses. Each land mass starts with a positive integer $M$ ($M \\le 30$), the number of vertices of the polygon. The following $M$ lines each contain two integers $x, y$, which are the coordinates of a polygon vertex. We guarantee that these vertices are given in clockwise or counterclockwise order and form a simple closed polygon (no edges intersect). We also guarantee that any two land masses do not intersect.\n\nAll coordinates are within the range from −10,000 to 10,000.", "outputFormat": "Output a floating-point number representing the route’s “isolation distance,” rounded to exactly 2 decimal places.", "hint": "For 50% of the testdata, $1 \\le C \\le 2$, $2 \\le N \\le 5$.  \nFor 100% of the testdata, $1 \\le C \\le 20$, $2 \\le N \\le 20$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SHOI2008] 安全的航线", "background": "", "description": "在设计航线的时候，安全是一个很重要的问题。首先，最重要的是应采取一切措施确保飞行不会发生任何事故，但同时也需要做好最坏的打算，一旦事故发生，就要确保乘客有尽量高的生还几率。\n\n当飞机迫降到海上的时候，最近的陆地就是一个关键的因素。航线中最危险的地方就是距离最近的陆地最远的地方，我们称这种点为这条航线“孤地点”。孤地点到最近陆地的距离被称为“孤地距离”。作为航空公司的高级顾问，你接受的第一个任务就是尽量找出一条航线的孤地点，并计算这条航线的孤地距离。\n\n为了简化问题，我们认为地图是一个二维平面，陆地可以用多边形近似，飞行线路为一条折线。航线的起点和终点都在陆地上，但中间的转折点是可能在海上（如下图所示，方格标示出了孤地点）。\n\n![](https://cdn.luogu.com.cn/upload/pic/15457.png)", "inputFormat": "输入的第一行包括两个整数C和N（1≤C≤20，2≤N≤20），分别代表陆地的数目的航线的转折点的数目。\n\n接下来有N行，每行有两个整数x,y。(x,y)表示一个航线转折点的坐标，第一个转折点为航线的起点，最后一个转折点为航线的终点。\n\n接下来的输入将用来描述C块大陆。每块输入由一个正整数M开始（M≤30），M表示多边形的顶点个数，接下来的M行，每行会包含两个整数x,y，(x,y)表示多边形的一个顶点坐标，我们保证这些顶点以顺时针或逆时针给出了该多边形的闭包，不会出现某些边相交的情况。此外我们也保证输入数据中任何两块大陆不会相交。\n\n输入的所有坐标将保证在-10,000到10,000的范围之间。", "outputFormat": "输出一个浮点数，表示航线的孤地距离，数据保留2位小数。", "hint": "对于50%的数据，1≤C≤2，2≤N≤5;\n\n对于100%的数据，1≤C≤20，2≤N≤20。", "locale": "zh-CN"}}}
{"pid": "P4287", "type": "P", "difficulty": 6, "samples": [["16\nggabaabaabaaball", "12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["字符串", "2011", "各省省选", "上海", "回文自动机 PAM", "Manacher 算法"], "title": "[SHOI2011] 双倍回文", "background": "", "description": "记字符串 $w$ 的倒置为 $w^{\\mathsf R}$。例如$\\tt (abcd)^{\\mathsf R}=dcba$，$\\tt (abba)^{\\mathsf R}=abba$。\n\n对字符串 $x$，如果 $x$ 满足 $x^{\\mathsf R}=x$，则称之为回文。例如 $\\tt abba$ 是一个回文，而 $\\tt abed$ 不是。\n\n如果 $x$ 能够写成 $ww^{\\mathsf R} ww^{\\mathsf R}$ 形式，则称它是一个“双倍回文”。换句话说，若要 $x$ 是双倍回文，它的长度必须是 $4$ 的倍数，而且 $x$，$x$ 的前半部分，$x$ 的后半部分都要是回文。例如 $\\tt abbaabba$ 是一个双倍回文，而 $\\tt abaaba$ 不是，因为它的长度不是 $4$ 的倍数。\n\n- $x$ 的子串是指在 $x$ 中连续的一段字符所组成的字符串。例如 $\\tt be$ 是 $\\tt abed$ 的子串，而 $\\tt ac$ 不是。\n- $x$ 的回文子串，就是指满足回文性质的 $x$ 的子串。\n- $x$ 的双倍回文子串，就是指满足双倍回文性质的 $x$ 的子串。\n\n你的任务是，对于给定的字符串，计算它的最长双倍回文子串的长度。", "inputFormat": "输入分为两行。\n\n第一行为一个整数，表示字符串的长度。  \n第二行有个连续的小写的英文字符，表示字符串的内容。", "outputFormat": "输出文件只有一行即输入数据中字符串的最长双倍回文子串的长度，如果双倍回文子串不存在，则输出 $0$。", "hint": "### 数据范围及约定\n\n对于全部数据，$1\\le N \\le 500000$。", "locale": "zh-CN", "translations": {"en": {"title": "[SHOI2011] Double Palindrome", "background": "", "description": "Let the reversal of a string $w$ be denoted by $w^{\\mathsf R}$. For example, $\\tt (abcd)^{\\mathsf R}=dcba$, $\\tt (abba)^{\\mathsf R}=abba$.\n\nFor a string $x$, if $x$ satisfies $x^{\\mathsf R}=x$, it is called a palindrome. For example, $\\tt abba$ is a palindrome, while $\\tt abed$ is not.\n\nIf $x$ can be written in the form $ww^{\\mathsf R} ww^{\\mathsf R}$, it is called a \"double palindrome\". In other words, for $x$ to be a double palindrome, the length of $x$ must be a multiple of $4$, and $x$, its first half, and its second half must all be palindromes. For example, $\\tt abbaabba$ is a double palindrome, while $\\tt abaaba$ is not, because its length is not a multiple of $4$.\n\n- A substring of $x$ is a string formed by a consecutive segment of characters in $x$. For example, $\\tt be$ is a substring of $\\tt abed$, while $\\tt ac$ is not.\n- A palindromic substring of $x$ is a substring of $x$ that is a palindrome.\n- A double palindromic substring of $x$ is a substring of $x$ that is a double palindrome.\n\nYour task is to compute the length of the longest double palindromic substring of the given string.", "inputFormat": "The input consists of two lines.\n\n- The first line contains an integer $N$, the length of the string.\n- The second line contains a string of lowercase English letters, which is the content of the string.", "outputFormat": "Output a single line: the length of the longest double palindromic substring of the input string. If no double palindromic substring exists, output $0$.", "hint": "Constraints\n\nFor all testdata, $1 \\le N \\le 500000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SHOI2011] 双倍回文", "background": "", "description": "记字符串 $w$ 的倒置为 $w^{\\mathsf R}$。例如$\\tt (abcd)^{\\mathsf R}=dcba$，$\\tt (abba)^{\\mathsf R}=abba$。\n\n对字符串 $x$，如果 $x$ 满足 $x^{\\mathsf R}=x$，则称之为回文。例如 $\\tt abba$ 是一个回文，而 $\\tt abed$ 不是。\n\n如果 $x$ 能够写成 $ww^{\\mathsf R} ww^{\\mathsf R}$ 形式，则称它是一个“双倍回文”。换句话说，若要 $x$ 是双倍回文，它的长度必须是 $4$ 的倍数，而且 $x$，$x$ 的前半部分，$x$ 的后半部分都要是回文。例如 $\\tt abbaabba$ 是一个双倍回文，而 $\\tt abaaba$ 不是，因为它的长度不是 $4$ 的倍数。\n\n- $x$ 的子串是指在 $x$ 中连续的一段字符所组成的字符串。例如 $\\tt be$ 是 $\\tt abed$ 的子串，而 $\\tt ac$ 不是。\n- $x$ 的回文子串，就是指满足回文性质的 $x$ 的子串。\n- $x$ 的双倍回文子串，就是指满足双倍回文性质的 $x$ 的子串。\n\n你的任务是，对于给定的字符串，计算它的最长双倍回文子串的长度。", "inputFormat": "输入分为两行。\n\n第一行为一个整数，表示字符串的长度。  \n第二行有个连续的小写的英文字符，表示字符串的内容。", "outputFormat": "输出文件只有一行即输入数据中字符串的最长双倍回文子串的长度，如果双倍回文子串不存在，则输出 $0$。", "hint": "### 数据范围及约定\n\n对于全部数据，$1\\le N \\le 500000$。", "locale": "zh-CN"}}}
{"pid": "P4288", "type": "P", "difficulty": 6, "samples": [["2\n1 0\n-1 0\n0\n2", "0.500"], ["3\n1 1\n-1 -1\n0 0\n45\n7", "0.202"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2014", "各省省选", "上海"], "title": "[SHOI2014] 信号增幅仪", "background": "", "description": "无线网络基站在理想状况下有效信号覆盖范围是个圆形。而无线基站的功\n耗与圆的半径的平方成正比。现给出平面上若干网络用户的位置，请你选择一\n个合适的位置建设无线基站 ……\n\n就在你拿起键盘准备开始敲代码的时候，你的好朋友发明家SHTSC 突然出\n现了。SHTSC 刚刚完成了他的新发明——无线信号增幅仪。增幅仪能够在不增\n加无线基站功耗的前提下，使得有效信号的覆盖范围在某一特定方向上伸长若\n干倍。即：使用了增幅仪的无线基站覆盖范围是个椭圆，其功耗正比于半短轴\n长的平方。\n\n现给出平面上若干网络用户的位置，请你选择一个合适的位置建设无线基\n站，并在增幅仪的帮助下使所有的用户都能接收到信号，且无线基站的功耗最\n小。\n\n注意：由于SHTSC 增幅仪的工作原理依赖地磁场，增幅的方向是恒定的。", "inputFormat": "第一行一个整数：n。平面内的用户个数。之后的n 行每行两个整数x, y，表示一个用户的位置。\n\n第n+2 行一个整数：a。表示增幅仪的增幅方向，单位是度。表示增幅仪的\n方向是从x 正方向逆时针转a 度。\n\n第n+3 行一个整数：p。表示增幅仪的放大倍数。", "outputFormat": "输出一行一个实数，为能够覆盖所有用户的最小椭圆的半短轴长，四舍五入到三位小数。", "hint": "- 对于10%的数据，保证最优方案的中心在原点。\n- 对于20%的数据，保证点是随机生成的。\n- 对于30%的数据，n≤100。\n- 对于50%的数据，n≤5000。\n- 对于100%的数据，n≤50000，0≤a<180，1≤p≤100，|x|,|y|≤$2×10^8$。", "locale": "zh-CN", "translations": {"en": {"title": "[SHOI2014] Signal Amplifier", "background": "", "description": "In ideal conditions, the effective coverage area of a wireless base station is a circle, and the power consumption is proportional to the square of the circle’s radius. Given the positions of several network users on the plane, you are to choose a suitable location to build a wireless base station...\n\nJust as you are about to start coding, your good friend, the inventor SHTSC, shows up. SHTSC has just completed his new invention — a wireless signal amplifier. Without increasing the base station’s power consumption, the amplifier can extend the effective signal coverage by a certain multiple in a specific direction. That is, a base station using the amplifier has an elliptical coverage area, and its power consumption is proportional to the square of the length of the semi-minor axis.\n\nGiven the positions of several network users on the plane, choose a suitable location to build a base station and, with the help of the amplifier, ensure that all users can receive the signal while minimizing the base station’s power consumption.\n\nNote: Because the working principle of SHTSC’s amplifier depends on the geomagnetic field, the amplification direction is fixed.", "inputFormat": "The first line contains an integer n, the number of users on the plane. The next n lines each contain two integers x, y, representing a user’s position.\n\nThe (n+2)-th line contains an integer a, representing the amplifier’s direction in degrees. It is measured counterclockwise from the positive x-axis.\n\nThe (n+3)-th line contains an integer p, representing the amplifier’s magnification factor.", "outputFormat": "Output a single real number: the length of the semi-minor axis of the smallest ellipse that can cover all users, rounded to three decimal places.", "hint": "- For 10% of the testdata, it is guaranteed that the optimal center is at the origin.\n- For 20% of the testdata, the points are randomly generated.\n- For 30% of the testdata, $n \\le 100$.\n- For 50% of the testdata, $n \\le 5000$.\n- For 100% of the testdata, $n \\le 50000$, $0 \\le a < 180$, $1 \\le p \\le 100$, $|x|, |y| \\le $ $2×10^8$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SHOI2014] 信号增幅仪", "background": "", "description": "无线网络基站在理想状况下有效信号覆盖范围是个圆形。而无线基站的功\n耗与圆的半径的平方成正比。现给出平面上若干网络用户的位置，请你选择一\n个合适的位置建设无线基站 ……\n\n就在你拿起键盘准备开始敲代码的时候，你的好朋友发明家SHTSC 突然出\n现了。SHTSC 刚刚完成了他的新发明——无线信号增幅仪。增幅仪能够在不增\n加无线基站功耗的前提下，使得有效信号的覆盖范围在某一特定方向上伸长若\n干倍。即：使用了增幅仪的无线基站覆盖范围是个椭圆，其功耗正比于半短轴\n长的平方。\n\n现给出平面上若干网络用户的位置，请你选择一个合适的位置建设无线基\n站，并在增幅仪的帮助下使所有的用户都能接收到信号，且无线基站的功耗最\n小。\n\n注意：由于SHTSC 增幅仪的工作原理依赖地磁场，增幅的方向是恒定的。", "inputFormat": "第一行一个整数：n。平面内的用户个数。之后的n 行每行两个整数x, y，表示一个用户的位置。\n\n第n+2 行一个整数：a。表示增幅仪的增幅方向，单位是度。表示增幅仪的\n方向是从x 正方向逆时针转a 度。\n\n第n+3 行一个整数：p。表示增幅仪的放大倍数。", "outputFormat": "输出一行一个实数，为能够覆盖所有用户的最小椭圆的半短轴长，四舍五入到三位小数。", "hint": "- 对于10%的数据，保证最优方案的中心在原点。\n- 对于20%的数据，保证点是随机生成的。\n- 对于30%的数据，n≤100。\n- 对于50%的数据，n≤5000。\n- 对于100%的数据，n≤50000，0≤a<180，1≤p≤100，|x|,|y|≤$2×10^8$。", "locale": "zh-CN"}}}
{"pid": "P4289", "type": "P", "difficulty": 4, "samples": [["1111\n0000\n1110\n0010 \n\n1010\n0101\n1010\n0101", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2008", "河南", "各省省选", "哈希 hashing", "进制", "队列"], "title": "[HAOI2008] 移动玩具", "background": "", "description": "在一个 $4 \\times 4$ 的方框内摆放了若干个相同的玩具，某人想将这些玩具重新摆放成为他心中理想的状态。规定移动时只能将玩具向上下左右四个方向移动，并且移动的位置不能有玩具。请你用最少的移动次数将初始的玩具状态移动到某人心中的目标状态。", "inputFormat": "前四行表示玩具的初始状态，每行四个数字 $1$ 或 $0$，$1$ 表示方格中放置了玩具，$0$ 表示没有放置玩具。接着是一个空行。接下来四行表示玩具的目标状态，每行四个数字 $1$ 或 $0$，意义同上。", "outputFormat": "一个整数，所需要的最少移动次数。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[HAOI2008] Moving Toys", "background": "", "description": "In a $4 \\times 4$ grid, several identical toys are placed. Someone wants to rearrange these toys into his ideal state. Each move can only shift a toy up, down, left, or right, and the destination position must be empty. Please transform the initial state into the target state using the fewest number of moves.", "inputFormat": "The first four lines describe the initial state of the toys, each line containing four numbers $1$ or $0$. Here, $1$ means a toy is placed in the cell, and $0$ means the cell is empty. Then there is a blank line. The next four lines describe the target state, each line containing four numbers $1$ or $0$, with the same meaning as above.", "outputFormat": "Output a single integer: the minimum number of moves required.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HAOI2008] 移动玩具", "background": "", "description": "在一个 $4 \\times 4$ 的方框内摆放了若干个相同的玩具，某人想将这些玩具重新摆放成为他心中理想的状态。规定移动时只能将玩具向上下左右四个方向移动，并且移动的位置不能有玩具。请你用最少的移动次数将初始的玩具状态移动到某人心中的目标状态。", "inputFormat": "前四行表示玩具的初始状态，每行四个数字 $1$ 或 $0$，$1$ 表示方格中放置了玩具，$0$ 表示没有放置玩具。接着是一个空行。接下来四行表示玩具的目标状态，每行四个数字 $1$ 或 $0$，意义同上。", "outputFormat": "一个整数，所需要的最少移动次数。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4290", "type": "P", "difficulty": 4, "samples": [["1 1 1 1\nII\nWW\nWW\nIG\nIIII\n", "IN\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2008", "河南", "各省省选", "枚举", "区间 DP"], "title": "[HAOI2008] 玩具取名", "background": "", "description": "某人有一套玩具，并想法给玩具命名。首先他选择 `W, I, N, G` 四个字母中的任意一个字母作为玩具的基本名字。然后他会根据自己的喜好，将名字中任意一个字母用 `W, I, N, G` 中任意两个字母代替，使得自己的名字能够扩充得很长。\n\n现在，他想请你猜猜某一个很长的名字，最初可能是由哪几个字母变形过来的。", "inputFormat": "第一行四个整数 $W, I, N, G$。表示每一个字母能由几种两个字母所替代。\n\n接下来 $W$ 行，每行两个字母,表示 `W` 可以用这两个字母替代。\n\n接下来 $I$ 行，每行两个字母，表示 `I` 可以用这两个字母替代。\n\n接下来 $N$ 行，每行两个字母，表示 `N` 可以用这两个字母替代。\n\n接下来 $G$ 行，每行两个字母，表示 `G` 可以用这两个字母替代。\n\n最后一行一个长为 $L$ 的字符串。表示这个玩具的名字。", "outputFormat": "一行字符串，该名字可能由哪些字母变形而得到。（按照 `W, I, N, G` 的顺序输出）\n\n如果给的名字不能由任何一个字母变形而得到则输出 `The name is wrong!`。", "hint": "### 数据规模与约定\n\n- $30\\%$ 数据满足 $L \\leq 20$，$W, I, N, G \\leq 6$；\n- $100\\%$ 数据满足 $L \\leq 200$，$W, I, N, G \\leq 16$。", "locale": "zh-CN", "translations": {"en": {"title": "[HAOI2008] Toy Naming", "background": "", "description": "Someone has a set of toys and wants to give them names. First, he chooses any one letter from `W, I, N, G` as the base name of a toy. Then, according to his preference, he can replace any letter in the current name with any allowed pair of letters from `W, I, N, G`, so that the name can grow very long.\n\nNow, given a very long name, he wants you to guess which initial letters it could have been derived from.", "inputFormat": "The first line contains four integers $W, I, N, G$, indicating how many different pairs of letters each letter can be replaced by.\n\nThe next $W$ lines each contain two letters, indicating that `W` can be replaced by these two letters.\n\nThe next $I$ lines each contain two letters, indicating that `I` can be replaced by these two letters.\n\nThe next $N$ lines each contain two letters, indicating that `N` can be replaced by these two letters.\n\nThe next $G$ lines each contain two letters, indicating that `G$ can be replaced by these two letters.\n\nThe last line contains a string of length $L$, representing the toy’s name.", "outputFormat": "Output a single line string listing the letters from which the given name could have been derived (in the order `W, I, N, G`). If the given name cannot be derived from any letter, output `The name is wrong!`.", "hint": "Constraints\n\n- $30\\%$ of the testdata satisfies $L \\leq 20$, $W, I, N, G \\leq 6$.\n- $100\\%$ of the testdata satisfies $L \\leq 200$, $W, I, N, G \\leq 16$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HAOI2008] 玩具取名", "background": "", "description": "某人有一套玩具，并想法给玩具命名。首先他选择 `W, I, N, G` 四个字母中的任意一个字母作为玩具的基本名字。然后他会根据自己的喜好，将名字中任意一个字母用 `W, I, N, G` 中任意两个字母代替，使得自己的名字能够扩充得很长。\n\n现在，他想请你猜猜某一个很长的名字，最初可能是由哪几个字母变形过来的。", "inputFormat": "第一行四个整数 $W, I, N, G$。表示每一个字母能由几种两个字母所替代。\n\n接下来 $W$ 行，每行两个字母,表示 `W` 可以用这两个字母替代。\n\n接下来 $I$ 行，每行两个字母，表示 `I` 可以用这两个字母替代。\n\n接下来 $N$ 行，每行两个字母，表示 `N` 可以用这两个字母替代。\n\n接下来 $G$ 行，每行两个字母，表示 `G` 可以用这两个字母替代。\n\n最后一行一个长为 $L$ 的字符串。表示这个玩具的名字。", "outputFormat": "一行字符串，该名字可能由哪些字母变形而得到。（按照 `W, I, N, G` 的顺序输出）\n\n如果给的名字不能由任何一个字母变形而得到则输出 `The name is wrong!`。", "hint": "### 数据规模与约定\n\n- $30\\%$ 数据满足 $L \\leq 20$，$W, I, N, G \\leq 6$；\n- $100\\%$ 数据满足 $L \\leq 200$，$W, I, N, G \\leq 16$。", "locale": "zh-CN"}}}
{"pid": "P4291", "type": "P", "difficulty": 5, "samples": [["20\n+ADAM 1000000\n+BOB 1000000\n+TOM 2000000\n+CATHY 10000000\n?TOM\n?1\n+DAM 100000\n+BOB 1200000\n+ADAM 900000\n+FRANK 12340000\n+LEO 9000000\n+KAINE 9000000\n+GRACE 8000000\n+WALT 9000000\n+SANDY 8000000\n+MICK 9000000\n+JACK 7320000\n?2\n?5\n?KAINE", "2\nCATHY TOM ADAM BOB\nCATHY LEO KAINE WALT MICK GRACE SANDY JACK TOM BOB\nWALT MICK GRACE SANDY JACK TOM BOB ADAM DAM\n4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "字符串", "2008", "河南", "各省省选", "平衡树", "哈希 hashing"], "title": "[HAOI2008] 排名系统", "background": null, "description": "排名系统通常要应付三种请求：上传一条新的得分记录、查询某个玩家的当前排名以及返回某个区段内的排名记录。当某个玩家上传自己最新的得分记录时，他原有的得分记录会被删除。为了减轻服务器负担，在返回某个区段内的排名记录时，最多返回 $10$ 条记录。", "inputFormat": "第一行是一个整数 $n(10\\le n\\le250000)$ 表示请求总数目。接下来 $n$行，每行包含了一个请求。请求的具体格式如下：\n- `+Name Score` 上传最新得分记录。`Name` 表示玩家名字，由大写英文字母组成，不超过 $10$ 个字符。`Score` 为最多 $8$ 位的正整数。\n- `?Name` 查询玩家排名。该玩家的得分记录必定已经在前面上传。如果两个玩家的得分相同，则先得到该得分的玩家排在前面。\n- `?Index` 返回自第 `Index` 名开始的最多 $10$ 名玩家名字。`Index` 必定合法，即不小于 $1$，也不大于当前有记录的玩家总数。", "outputFormat": "- 对于 `?Name` 格式的请求，应输出一个整数表示该玩家当前的排名；\n- 对于 `?Index` 格式的请求，应在一行中依次输出从第 `Index` 名开始的最多 $10$ 名玩家姓名，用一个空格分隔。", "hint": "- 对于 $20\\%$ 的数据，$N\\le100$；\n- 对于 $100\\%$ 的数据，$N\\le2.5\\times10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[HAOI2008] Ranking System", "background": "", "description": "A ranking system typically needs to handle three types of requests: uploading a new score record, querying a player's current rank, and returning the ranking records within a segment. When a player uploads their latest score record, their previous score record is deleted. To reduce server load, when returning a segment of the ranking, at most $10$ records are returned.", "inputFormat": "The first line contains an integer $n(10\\le n\\le250000)$ denoting the total number of requests. The next $n$ lines each contain one request. The specific formats are as follows:\n- `+Name Score` Upload the latest score record. `Name` denotes the player's name, consisting of uppercase English letters, no more than $10$ characters. `Score` is a positive integer with at most $8$ digits.\n- `?Name` Query the player's rank. This player's score record must have been uploaded earlier. If two players have the same score, the one who obtained that score earlier ranks ahead.\n- `?Index` Return up to $10$ player names starting from rank `Index`. `Index` is guaranteed to be valid, i.e., not less than $1$ and not greater than the current number of players with records.", "outputFormat": "- For requests of the form `?Name`, output a single integer denoting that player's current rank.\n- For requests of the form `?Index`, output in one line the names of up to $10$ players starting from rank `Index`, separated by a space.", "hint": "- For $20\\%$ of the testdata, $N\\le100$.\n- For $100\\%$ of the testdata, $N\\le2.5\\times10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HAOI2008] 排名系统", "background": null, "description": "排名系统通常要应付三种请求：上传一条新的得分记录、查询某个玩家的当前排名以及返回某个区段内的排名记录。当某个玩家上传自己最新的得分记录时，他原有的得分记录会被删除。为了减轻服务器负担，在返回某个区段内的排名记录时，最多返回 $10$ 条记录。", "inputFormat": "第一行是一个整数 $n(10\\le n\\le250000)$ 表示请求总数目。接下来 $n$行，每行包含了一个请求。请求的具体格式如下：\n- `+Name Score` 上传最新得分记录。`Name` 表示玩家名字，由大写英文字母组成，不超过 $10$ 个字符。`Score` 为最多 $8$ 位的正整数。\n- `?Name` 查询玩家排名。该玩家的得分记录必定已经在前面上传。如果两个玩家的得分相同，则先得到该得分的玩家排在前面。\n- `?Index` 返回自第 `Index` 名开始的最多 $10$ 名玩家名字。`Index` 必定合法，即不小于 $1$，也不大于当前有记录的玩家总数。", "outputFormat": "- 对于 `?Name` 格式的请求，应输出一个整数表示该玩家当前的排名；\n- 对于 `?Index` 格式的请求，应在一行中依次输出从第 `Index` 名开始的最多 $10$ 名玩家姓名，用一个空格分隔。", "hint": "- 对于 $20\\%$ 的数据，$N\\le100$；\n- 对于 $100\\%$ 的数据，$N\\le2.5\\times10^5$。", "locale": "zh-CN"}}}
{"pid": "P4292", "type": "P", "difficulty": 7, "samples": [["4 \n2 3 \n1 2 1 \n1 3 2 \n1 4 3", "2.500"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2010", "线段树", "点分治", "单调队列", "分治", "树链剖分", "WC"], "title": "[WC2010] 重建计划", "background": "", "description": "X 国遭受了地震的重创, 导致全国的交通近乎瘫痪，重建家园的计划迫在眉睫。X 国由 $N$ 个城市组成, 重建小组提出，仅需建立 $N-1$ 条道路即可使得任意两个城市互相可达。于是，重建小组很快提出了一个包含 $N-1$ 条道路的方案，并满足城市之间两两可达，他们还计算评估了每条道路 $e$ 建设之后可以带来的价值 $v(e)$。  \n\n由于重建计划复杂而艰难，经费也有一定限制。因此，政府要求第一期重建工程修建的道路数目为 $k$ 条，但需满足 $L \\leq k \\leq U$，即不应少于$L$ 条，但不超过 $U$ 条。同时，为了最大化利用率，要求建设的这些道路恰好组成一条简单路径，即所建设的 $k$ 条路径可以构成一个排列 $e_1 = (p_1, q_1), e_2 = (p_2, q_2), \\cdots , e_k = (p_k, q_k)$， 对于 $1 \\leq i < k$， 有$(q_i = p_{i+1})$。 \n\n重建小组打算修改他们的原有方案以满足要求，即在原有的 $N-1$ 条道路中寻找一条路径 $S$ 作为新的方案，使得新方案中的道路平均价值\n\n$$AvgValue = \\frac{\\sum _{e \\in S} v(e)}{|S|}$$\n\n最大。这里 $v(e)$ 表示道路 $e$ 的价值，$|S|$ 表示新方案中道路的条数。请你帮助重建小组寻找一个最优方案。  注: 在本题中 $L$ 和 $U$ 的设置将保证有解。\n", "inputFormat": "第一行包含一个正整数 $N$ ，表示 X 国的城市个数。 \n\n第二行包含两个正整数 $L,U$，表示政府要求的第一期重建方案中修建道路数的上下限。  \n\n接下来的 $N-1$ 行描述重建小组的原有方案，每行三个正整数 $a_i, b_i, v_i$，分别表示道路 $(a_i, b_i)$，其价值为 $v_i$ 。其中城市由$1 \\cdots N$标号。", "outputFormat": "仅包含一行，为一个实数 $AvgValue$，即最大平均价值。\n\n小数点后保留三位。", "hint": "新方案中选择路径 $(3, 1), (1, 4)$ 可以得到的平均价值为 $2.5$，为最大平均价值。\n\n对于20%的数据，$N \\leq 5 000$;  \n\n另有30%的数据，$N \\leq 100 000$， 原有方案恰好为一条路径(链); \n\n对于100%的数据，$N \\leq 100 000, 1 \\leq L \\leq U \\leq N-1, v_i \\leq 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "[WC2010] Reconstruction Plan", "background": "", "description": "Country X was heavily hit by an earthquake, which almost paralyzed nationwide transportation, and the reconstruction plan is urgent. Country X consists of $N$ cities. The reconstruction team proposed that building only $N - 1$ roads would make any two cities mutually reachable. Thus, they quickly proposed a plan containing $N - 1$ roads that ensures pairwise reachability between cities, and they also evaluated the value $v(e)$ that each road $e$ would bring after construction.\n\nDue to the complexity and difficulty of the reconstruction plan, and with limited funds, the government requires that the number of roads to be built in the first phase be $k$, with $L \\leq k \\leq U$, i.e., no fewer than $L$ roads and no more than $U$ roads. Meanwhile, to maximize utilization, the selected roads must form exactly one simple path, i.e., the $k$ roads can be arranged as a sequence $e_1 = (p_1, q_1), e_2 = (p_2, q_2), \\cdots, e_k = (p_k, q_k)$ such that for $1 \\leq i < k$ we have $(q_i = p_{i+1})$.\n\nThe reconstruction team plans to modify their original plan to meet the requirement, that is, find a path $S$ among the original $N - 1$ roads as the new plan, so that the average value of the new plan\n$$AvgValue = \\frac{\\sum_{e \\in S} v(e)}{|S|}$$\nis maximized. Here $v(e)$ denotes the value of road $e$, and $|S|$ is the number of roads in the new plan. Please help the reconstruction team find an optimal plan. Note: In this problem, $L$ and $U$ are set to guarantee a solution.", "inputFormat": "The first line contains a positive integer $N$, the number of cities in Country X.\n\nThe second line contains two positive integers $L, U$, the lower and upper bounds on the number of roads to be built in the first-phase plan.\n\nEach of the next $N - 1$ lines describes the original plan of the reconstruction team, with three positive integers $a_i, b_i, v_i$, indicating a road $(a_i, b_i)$ whose value is $v_i$. Cities are numbered $1 \\cdots N$.", "outputFormat": "Output a single line containing a real number AvgValue, the maximum average value.\n\nKeep three digits after the decimal point.", "hint": "In the new plan, selecting the path $(3, 1), (1, 4)$ yields an average value of $2.5$, which is the maximum average value.\n\nFor 20% of the testdata, $N \\leq 5000$.\n\nFor another 30% of the testdata, $N \\leq 100000$, and the original plan is exactly a path (chain).\n\nFor 100% of the testdata, $N \\leq 100000$, $1 \\leq L \\leq U \\leq N - 1$, and $v_i \\leq 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[WC2010] 重建计划", "background": "", "description": "X 国遭受了地震的重创, 导致全国的交通近乎瘫痪，重建家园的计划迫在眉睫。X 国由 $N$ 个城市组成, 重建小组提出，仅需建立 $N-1$ 条道路即可使得任意两个城市互相可达。于是，重建小组很快提出了一个包含 $N-1$ 条道路的方案，并满足城市之间两两可达，他们还计算评估了每条道路 $e$ 建设之后可以带来的价值 $v(e)$。  \n\n由于重建计划复杂而艰难，经费也有一定限制。因此，政府要求第一期重建工程修建的道路数目为 $k$ 条，但需满足 $L \\leq k \\leq U$，即不应少于$L$ 条，但不超过 $U$ 条。同时，为了最大化利用率，要求建设的这些道路恰好组成一条简单路径，即所建设的 $k$ 条路径可以构成一个排列 $e_1 = (p_1, q_1), e_2 = (p_2, q_2), \\cdots , e_k = (p_k, q_k)$， 对于 $1 \\leq i < k$， 有$(q_i = p_{i+1})$。 \n\n重建小组打算修改他们的原有方案以满足要求，即在原有的 $N-1$ 条道路中寻找一条路径 $S$ 作为新的方案，使得新方案中的道路平均价值\n\n$$AvgValue = \\frac{\\sum _{e \\in S} v(e)}{|S|}$$\n\n最大。这里 $v(e)$ 表示道路 $e$ 的价值，$|S|$ 表示新方案中道路的条数。请你帮助重建小组寻找一个最优方案。  注: 在本题中 $L$ 和 $U$ 的设置将保证有解。\n", "inputFormat": "第一行包含一个正整数 $N$ ，表示 X 国的城市个数。 \n\n第二行包含两个正整数 $L,U$，表示政府要求的第一期重建方案中修建道路数的上下限。  \n\n接下来的 $N-1$ 行描述重建小组的原有方案，每行三个正整数 $a_i, b_i, v_i$，分别表示道路 $(a_i, b_i)$，其价值为 $v_i$ 。其中城市由$1 \\cdots N$标号。", "outputFormat": "仅包含一行，为一个实数 $AvgValue$，即最大平均价值。\n\n小数点后保留三位。", "hint": "新方案中选择路径 $(3, 1), (1, 4)$ 可以得到的平均价值为 $2.5$，为最大平均价值。\n\n对于20%的数据，$N \\leq 5 000$;  \n\n另有30%的数据，$N \\leq 100 000$， 原有方案恰好为一条路径(链); \n\n对于100%的数据，$N \\leq 100 000, 1 \\leq L \\leq U \\leq N-1, v_i \\leq 10^6$。", "locale": "zh-CN"}}}
{"pid": "P4293", "type": "P", "difficulty": 6, "samples": [["4  \n1.0 2.0 \n3.0 1.0 \n5.0 4.0 \n2.0 2.0", "3 2 \n3  \n1 3 2"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["计算几何", "2010", "Special Judge", "凸包", "WC"], "title": "[WC2010] 能量场", "background": "\n官方spj：https://www.luogu.org/paste/03wjc4ne\n\nspj provider: @hehezhou ", "description": "物理学家栋栋最近在研究一个能量场。在这个能量场中有n个粒子，每个粒子都有两个属性：质量m和结合系数c。  \n\n栋栋发现，在这个能量场中，每个粒子都有两极，N极和S极。两个粒子相遇时，符合“同极相斥，异极相吸”的原则，只能是一个粒子的N极和另一个粒子的S极连接到一起。当质量为ma，结合系数为ca的粒子a的N极与另一个质量为mb，结合系数为cb的粒子b的S极直接连接时，可以产生大小为  $m_a m_b (c_a - c_b)$  的结合能量。    \n\n请解决以下两个问题：  \n1. 在能量场的n个粒子中哪两个粒子直接连接的能量最大。  \n2. 栋栋发明了一种方法，能选择其中的任意k个粒子p1, p2, …, pk，将pi的 N极与pi+1的S极连接(1 ≤ i < k)， pk的N极与p1的S极连接， 其中p1, p2, …, pk两两不同。k可以在1至n中任意取值，如使用栋栋的这种方法连接，选择哪些粒子可以得到最大的能量。", "inputFormat": "第一行包含一个整数n，表示粒子的个数。 \n\n 接下来n行，每行两个实数，第i+1行的两个实数表示第i个粒子的质量mi和结合系数ci。(0< mi, ci <10^5)", "outputFormat": "第一行包含两个整数a, b，表示将粒子a的N极与粒子b的S极连接可以得到最大的能量。  \n\n第二行包含一个整数k，表示第二问中要得到最大的能量需要多少个粒子。 第三行包含k个整数，表示p1, p2, …, pk，即第二问中的最优方案。", "hint": "【样例说明】  \n对于第一问，第三个粒子的N极与第二个粒子的S极连接，能得到的能量为$5\\times3\\times(4-1) = 45$。  \n\n对于第二问，顺次连接1, 3, 2号粒子，能量为  $1\\times5\\times(2-4) + 5\\times3\\times(4-1) + 3\\times1\\times(1-2) = 32$。 \n\n【数据规模】  \n\n10%的数据，n ≤ 8； \n\n20%的数据，n ≤ 15； \n\n40%的数据，n ≤ 1 000；\n\n50%的数据，n ≤ 5 000； \n\n100%的数据，n ≤ 50 000。 \n\n【评分标准】  \n\n此题可能有多解，如果用你的解产生的能量与参考答案的绝对误差或相对误差小于10–5，则得满分。否则不得分。  对于本题，每问的分数各占50%。如果你的输出任何一问的格式或结果不正确，则不得分；否则如果其中的一问正确，则得到该测试点50%的分数；如果两问都正确，得到该测试点100%的分数。", "locale": "zh-CN", "translations": {"en": {"title": "[WC2010] Energy Field", "background": "Official SPJ: https://www.luogu.org/paste/03wjc4ne.\n\nSPJ provider: @hehezhou.", "description": "Physicist Dongdong is studying an energy field. In this field, there are n particles, and each particle has two attributes: mass m and bonding coefficient c.\n\nDongdong discovers that each particle has two poles, an N pole and an S pole. When two particles meet, they follow the rule “like poles repel, unlike poles attract,” and only the N pole of one particle can connect to the S pole of another. When the N pole of particle a with mass $m_a$ and coefficient $c_a$ directly connects to the S pole of particle b with mass $m_b$ and coefficient $c_b$, the produced binding energy is $m_a m_b (c_a - c_b)$.\n\nPlease solve the following two problems:\n1. Among the n particles, determine which ordered pair of particles, when directly connected (N of a to S of b), yields the maximum energy.\n2. Dongdong invents a method that selects any k particles $p1, p2, \\dots, pk$, connects the N pole of $p_i$ to the S pole of $p_{i+1}$ for $1 \\le i < k$, and connects the N pole of $p_k$ to the S pole of $p1$, where $p1, p2, \\dots, pk$ are pairwise distinct. The value of k can be any integer from 1 to n. Using this method, choose the particles to obtain the maximum total energy.", "inputFormat": "The first line contains an integer n, the number of particles.\n\nThe next n lines each contain two real numbers. In line $i+1$, the two real numbers denote the mass $m_i$ and bonding coefficient $c_i$ of particle i. $(0 < m_i, c_i < 10^5)$.", "outputFormat": "The first line contains two integers a and b, indicating that connecting the N pole of particle a to the S pole of particle b yields the maximum energy.\n\nThe second line contains an integer k, the number of particles needed to achieve the maximum total energy in problem 2. The third line contains k integers, denoting $p1, p2, \\dots, pk$, i.e., the optimal sequence in problem 2.", "hint": "Sample Explanation:\n- For the first problem, connecting the N pole of the third particle to the S pole of the second particle yields energy $5\\times3\\times(4-1) = 45$.\n- For the second problem, connecting particles 1, 3, 2 in order yields energy $1\\times5\\times(2-4) + 5\\times3\\times(4-1) + 3\\times1\\times(1-2) = 32$.\n\nConstraints:\n- For 10% of the testdata, $n \\le 8$.\n- For 20% of the testdata, $n \\le 15$.\n- For 40% of the testdata, $n \\le 1000$.\n- For 50% of the testdata, $n \\le 5000$.\n- For 100% of the testdata, $n \\le 50000$.\n\nScoring:\n- This problem may have multiple correct outputs. If the absolute error or relative error of your energy compared to the reference answer is less than $10^{-5}$, you receive full score; otherwise, you receive zero.\n- Each of the two problems is worth 50%. If the format or result of any one problem is incorrect, you receive zero; otherwise, if only one problem is correct, you receive 50% of the points for that test point; if both are correct, you receive 100% of the points for that test point.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[WC2010] 能量场", "background": "\n官方spj：https://www.luogu.org/paste/03wjc4ne\n\nspj provider: @hehezhou ", "description": "物理学家栋栋最近在研究一个能量场。在这个能量场中有n个粒子，每个粒子都有两个属性：质量m和结合系数c。  \n\n栋栋发现，在这个能量场中，每个粒子都有两极，N极和S极。两个粒子相遇时，符合“同极相斥，异极相吸”的原则，只能是一个粒子的N极和另一个粒子的S极连接到一起。当质量为ma，结合系数为ca的粒子a的N极与另一个质量为mb，结合系数为cb的粒子b的S极直接连接时，可以产生大小为  $m_a m_b (c_a - c_b)$  的结合能量。    \n\n请解决以下两个问题：  \n1. 在能量场的n个粒子中哪两个粒子直接连接的能量最大。  \n2. 栋栋发明了一种方法，能选择其中的任意k个粒子p1, p2, …, pk，将pi的 N极与pi+1的S极连接(1 ≤ i < k)， pk的N极与p1的S极连接， 其中p1, p2, …, pk两两不同。k可以在1至n中任意取值，如使用栋栋的这种方法连接，选择哪些粒子可以得到最大的能量。", "inputFormat": "第一行包含一个整数n，表示粒子的个数。 \n\n 接下来n行，每行两个实数，第i+1行的两个实数表示第i个粒子的质量mi和结合系数ci。(0< mi, ci <10^5)", "outputFormat": "第一行包含两个整数a, b，表示将粒子a的N极与粒子b的S极连接可以得到最大的能量。  \n\n第二行包含一个整数k，表示第二问中要得到最大的能量需要多少个粒子。 第三行包含k个整数，表示p1, p2, …, pk，即第二问中的最优方案。", "hint": "【样例说明】  \n对于第一问，第三个粒子的N极与第二个粒子的S极连接，能得到的能量为$5\\times3\\times(4-1) = 45$。  \n\n对于第二问，顺次连接1, 3, 2号粒子，能量为  $1\\times5\\times(2-4) + 5\\times3\\times(4-1) + 3\\times1\\times(1-2) = 32$。 \n\n【数据规模】  \n\n10%的数据，n ≤ 8； \n\n20%的数据，n ≤ 15； \n\n40%的数据，n ≤ 1 000；\n\n50%的数据，n ≤ 5 000； \n\n100%的数据，n ≤ 50 000。 \n\n【评分标准】  \n\n此题可能有多解，如果用你的解产生的能量与参考答案的绝对误差或相对误差小于10–5，则得满分。否则不得分。  对于本题，每问的分数各占50%。如果你的输出任何一问的格式或结果不正确，则不得分；否则如果其中的一问正确，则得到该测试点50%的分数；如果两问都正确，得到该测试点100%的分数。", "locale": "zh-CN"}}}
{"pid": "P4294", "type": "P", "difficulty": 6, "samples": [["4 4\n0 1 1 0\n2 5 5 1\n1 5 5 1\n0 1 1 0", "6\nxoox\n___o\n___o\nxoox"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2008", "Special Judge", "最短路", "进制", "WC", "状压 DP"], "title": "[WC2008] 游览计划", "background": "UPD：\n\n- @panda_2134 提供 Special Judge；\n\n- @yzy1 提供了[两组 hack 数据](https://www.luogu.com.cn/discuss/527294)，即不算分的 subtask1；\n\n- @kradcigam [完善](https://www.luogu.com.cn/discuss/873182)了 Special Judge。", "description": "从未来过绍兴的小 D 有幸参加了 Winter Camp 2008，他被这座历史名城的秀丽风景所吸引，强烈要求游览绍兴及其周边的所有景点。\n\n主办者将绍兴划分为 $N$ 行 $M$ 列 $(N×M)$ 个分块，如下图（$8\\times8$）：\n\n![](https://cdn.luogu.com.cn/upload/pic/15472.png)\n\n景点含于方块内，且一个方块至多有一个景点。无景点的方块视为路。\n\n为了保证安全与便利，主办方依据路况和治安状况，在非景点的一些方块内安排不同数量的志愿者；在景点内聘请导游（导游不是志愿者）。在选择旅游方案时，保证任意两个景点之间，存在一条路径，在这条路径所经过的每一个方块都有志愿者或者该方块为景点。既能满足选手们游览的需要，又能够让志愿者的总数最少。\n\n例如，在上面的例子中，在每个没有景点的方块中填入一个数字，表示控制该方块最少需要的志愿者数目：\n\n![](https://cdn.luogu.com.cn/upload/pic/15473.png)\n\n图中用深色标出的方块区域就是一种可行的志愿者安排方案，一共需要 $20$ 名志愿者。由图可见，两个相邻的景点是直接（有景点内的路）连通的（如沈园和八字桥）。\n\n现在，希望你能够帮助主办方找到一种最好的安排方案。", "inputFormat": "第一行有两个整数，$N$ 和 $M$，描述方块的数目。\n\n接下来 $N$ 行，每行有 $M$ 个非负整数，如果该整数为 $0$，则该方块为一个景点；否则表示控制该方块至少需要的志愿者数目。相邻的整数用（若干个）空格隔开，行首行末也可能有多余的空格。", "outputFormat": "由 $N+1$ 行组成。第一行为一个整数，表示你所给出的方案中安排的志愿者总数目。\n\n接下来 $N$ 行，每行 $M$ 个字符，描述方案中相应方块的情况：\n\n- `_`（下划线）表示该方块没有安排志愿者；\n- `o`（小写英文字母 o）表示该方块安排了志愿者；\n- `x`（小写英文字母 x）表示该方块是一个景点；\n\n注：请注意输出格式要求，如果缺少某一行或者某一行的字符数目和要求不一致（任何一行中，多余的空格都不允许出现），都可能导致该测试点不得分。", "hint": "所有的 $10$ 组数据中 $N,M$，以及景点数 $K$ 的范围规定如下：\n\n::cute-table{tuack}\n\n|测试点编号| $N$ | $M$ | $K$ |\n|:-:|:-:|:-:|:-:|\n| 1|$\\le  2$|$\\le  2$|$\\le  2$|\n| 2|$\\le  4$|$\\le  5$|$\\le  4$|\n| 3|$\\le  2$|$\\le 10$|$\\le  3$|\n| 4|$\\le  6$|$\\le  7$|$\\le  5$|\n| 5|$\\le  8$|$\\le  9$|$\\le  7$|\n| 6|$\\le 10$|$\\le  9$|$\\le 10$|\n| 7|$\\le  9$|$\\le 10$|$\\le 10$|\n| 8|$\\le 10$|$\\le 10$|$\\le  3$|\n| 9|$\\le 10$|$\\le 10$|$\\le 10$|\n|10|$\\le 10$|$\\le 10$|$\\le 10$| ![](https://cdn.luogu.com.cn/upload/pic/15474.png)\n\n输入文件中的所有整数均不小于 $0$ 且不超过 $2^{16}$。", "locale": "zh-CN", "translations": {"en": {"title": "[WC2008] Sightseeing Plan", "background": "UPD:\n\n- @panda_2134 provided the Special Judge.\n- @yzy1 provided [two sets of hack testdata](https://www.luogu.com.cn/discuss/527294), i.e., the non-scoring subtask1.\n- @kradcigam [improved](https://www.luogu.com.cn/discuss/873182) the Special Judge.", "description": "Little D, who has never been to Shaoxing, was lucky to attend Winter Camp 2008. He was captivated by the beautiful scenery of this historic city and strongly requested to visit all scenic spots in and around Shaoxing.\n\nThe organizers divide Shaoxing into $N$ rows and $M$ columns, i.e., an $(N \\times M)$ grid, as in the figure ($8 \\times 8$):\n\n![](https://cdn.luogu.com.cn/upload/pic/15472.png)\n\nEach scenic spot lies within a cell, and each cell contains at most one scenic spot. A cell without a scenic spot is considered a road.\n\nFor safety and convenience, based on road and security conditions, the organizers place different numbers of volunteers in some non-scenic cells; in scenic cells they hire tour guides (guides are not volunteers). When choosing a touring plan, we must ensure that between any two scenic spots there exists a path such that every cell on this path either has volunteers or is itself a scenic spot. The plan should meet contestants’ touring needs while minimizing the total number of volunteers.\n\nFor example, in the example above, each non-scenic cell is assigned a number indicating the minimum number of volunteers needed to control that cell:\n\n![](https://cdn.luogu.com.cn/upload/pic/15473.png)\n\nThe dark-shaded region shows one feasible volunteer arrangement, requiring a total of $20$ volunteers. As can be seen, two adjacent scenic spots are directly connected (via roads inside the scenic spots), e.g., 沈园 and 八字桥.\n\nNow, please help the organizers find the best arrangement.", "inputFormat": "The first line contains two integers, $N$ and $M$, describing the number of cells.\n\nThe next $N$ lines each contain $M$ nonnegative integers. If an integer is $0$, then the corresponding cell is a scenic spot; otherwise, it is the minimum number of volunteers required to control that cell. Adjacent integers are separated by one or more spaces; there may also be extra spaces at the beginning or end of a line.", "outputFormat": "Output $N+1$ lines. The first line is a single integer, the total number of volunteers in your plan.\n\nThen output $N$ lines, each containing $M$ characters, describing the status of each cell in your plan:\n- `_` (underscore) means no volunteers are placed in that cell.\n- `o` (lowercase letter o) means volunteers are placed in that cell.\n- `x` (lowercase letter x) means that cell is a scenic spot.\n\nNote: Please strictly follow the output format. If any line is missing, or if any line contains an incorrect number of characters (and no extra spaces are allowed on any line), that test point may receive no score.", "hint": "Constraints (across all $10$ groups of testdata) on $N$, $M$, and the number of scenic spots $K$ are as follows:\n\n| Test case ID | $N$        | $M$        | $K$        |\n|:-:|:-:|:-:|:-:|\n| 1  | $ \\le 2 $  | $ \\le 2 $  | $ \\le 2 $  |\n| 2  | $ \\le 4 $  | $ \\le 5 $  | $ \\le 4 $  |\n| 3  | $ \\le 2 $  | $ \\le 10 $ | $ \\le 3 $  |\n| 4  | $ \\le 6 $  | $ \\le 7 $  | $ \\le 5 $  |\n| 5  | $ \\le 8 $  | $ \\le 9 $  | $ \\le 7 $  |\n| 6  | $ \\le 10 $ | $ \\le 9 $  | $ \\le 10 $ |\n| 7  | $ \\le 9 $  | $ \\le 10 $ | $ \\le 10 $ |\n| 8  | $ \\le 10 $ | $ \\le 10 $ | $ \\le 3 $  |\n| 9  | $ \\le 10 $ | $ \\le 10 $ | $ \\le 10 $ |\n| 10 | $ \\le 10 $ | $ \\le 10 $ | $ \\le 10 $ |\n\n![](https://cdn.luogu.com.cn/upload/pic/15474.png)\n\nAll integers in the input file are between $0$ and $2^{16}$, inclusive.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[WC2008] 游览计划", "background": "UPD：\n\n- @panda_2134 提供 Special Judge；\n\n- @yzy1 提供了[两组 hack 数据](https://www.luogu.com.cn/discuss/527294)，即不算分的 subtask1；\n\n- @kradcigam [完善](https://www.luogu.com.cn/discuss/873182)了 Special Judge。", "description": "从未来过绍兴的小 D 有幸参加了 Winter Camp 2008，他被这座历史名城的秀丽风景所吸引，强烈要求游览绍兴及其周边的所有景点。\n\n主办者将绍兴划分为 $N$ 行 $M$ 列 $(N×M)$ 个分块，如下图（$8\\times8$）：\n\n![](https://cdn.luogu.com.cn/upload/pic/15472.png)\n\n景点含于方块内，且一个方块至多有一个景点。无景点的方块视为路。\n\n为了保证安全与便利，主办方依据路况和治安状况，在非景点的一些方块内安排不同数量的志愿者；在景点内聘请导游（导游不是志愿者）。在选择旅游方案时，保证任意两个景点之间，存在一条路径，在这条路径所经过的每一个方块都有志愿者或者该方块为景点。既能满足选手们游览的需要，又能够让志愿者的总数最少。\n\n例如，在上面的例子中，在每个没有景点的方块中填入一个数字，表示控制该方块最少需要的志愿者数目：\n\n![](https://cdn.luogu.com.cn/upload/pic/15473.png)\n\n图中用深色标出的方块区域就是一种可行的志愿者安排方案，一共需要 $20$ 名志愿者。由图可见，两个相邻的景点是直接（有景点内的路）连通的（如沈园和八字桥）。\n\n现在，希望你能够帮助主办方找到一种最好的安排方案。", "inputFormat": "第一行有两个整数，$N$ 和 $M$，描述方块的数目。\n\n接下来 $N$ 行，每行有 $M$ 个非负整数，如果该整数为 $0$，则该方块为一个景点；否则表示控制该方块至少需要的志愿者数目。相邻的整数用（若干个）空格隔开，行首行末也可能有多余的空格。", "outputFormat": "由 $N+1$ 行组成。第一行为一个整数，表示你所给出的方案中安排的志愿者总数目。\n\n接下来 $N$ 行，每行 $M$ 个字符，描述方案中相应方块的情况：\n\n- `_`（下划线）表示该方块没有安排志愿者；\n- `o`（小写英文字母 o）表示该方块安排了志愿者；\n- `x`（小写英文字母 x）表示该方块是一个景点；\n\n注：请注意输出格式要求，如果缺少某一行或者某一行的字符数目和要求不一致（任何一行中，多余的空格都不允许出现），都可能导致该测试点不得分。", "hint": "所有的 $10$ 组数据中 $N,M$，以及景点数 $K$ 的范围规定如下：\n\n::cute-table{tuack}\n\n|测试点编号| $N$ | $M$ | $K$ |\n|:-:|:-:|:-:|:-:|\n| 1|$\\le  2$|$\\le  2$|$\\le  2$|\n| 2|$\\le  4$|$\\le  5$|$\\le  4$|\n| 3|$\\le  2$|$\\le 10$|$\\le  3$|\n| 4|$\\le  6$|$\\le  7$|$\\le  5$|\n| 5|$\\le  8$|$\\le  9$|$\\le  7$|\n| 6|$\\le 10$|$\\le  9$|$\\le 10$|\n| 7|$\\le  9$|$\\le 10$|$\\le 10$|\n| 8|$\\le 10$|$\\le 10$|$\\le  3$|\n| 9|$\\le 10$|$\\le 10$|$\\le 10$|\n|10|$\\le 10$|$\\le 10$|$\\le 10$| ![](https://cdn.luogu.com.cn/upload/pic/15474.png)\n\n输入文件中的所有整数均不小于 $0$ 且不超过 $2^{16}$。", "locale": "zh-CN"}}}
{"pid": "P4295", "type": "P", "difficulty": 6, "samples": [["2 2", "3"], ["2 3", "21"], ["3 5", "58871587162270592645034001\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["高精度", "2003", "四川", "各省省选", "前缀和", "差分"], "title": "[SCOI2003] 严格N元树", "background": "", "description": "如果一棵树的所有非叶节点都恰好有 $n$ 个儿子，那么我们称它为严格 $n$ 元树。如果该树中最底层的节点深度为 $d$（根的深度为 $0$），那么我们称它为一棵深度为 $d$ 的严格 $n$ 元树。例如，深度为２的严格２元树有三个，如下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/um9mtoxb.png)\n \n给出 $n,d$，编程数出深度为 $d$ 的 $n$ 元树数目。", "inputFormat": "仅包含两个整数 $n,d(0<n \\le 32,0 \\le d \\le 16)$。输入数据保证你不需要考虑某一层多于 $1024$ 个节点的树（即 $nd \\le 1024$）。提示：答案保证不超过 $200$ 位十进制数。", "outputFormat": "仅包含一个数，即深度为 $d$ 的 $n$ 元树的数目。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2003] Strict N-ary Tree", "background": "", "description": "If every non-leaf node of a tree has exactly $n$ children, we call it a strict $n$-ary tree. If the deepest nodes in the tree have depth $d$ (the root has depth $0$), then we call it a strict $n$-ary tree of depth $d$. For example, there are three strict $2$-ary trees of depth $2$, as shown below:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/um9mtoxb.png)\n\nGiven $n, d$, write a program to count the number of strict $n$-ary trees of depth $d$.", "inputFormat": "Contains only two integers $n, d$ ($0 < n \\le 32$, $0 \\le d \\le 16$). The testdata guarantees that you do not need to consider trees with more than $1024$ nodes on any level (i.e., $n^d \\le 1024$).", "outputFormat": "Contains only one number, which is the number of strict $n$-ary trees of depth $d$.", "hint": "The answer is guaranteed to be at most $200$ decimal digits.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2003] 严格N元树", "background": "", "description": "如果一棵树的所有非叶节点都恰好有 $n$ 个儿子，那么我们称它为严格 $n$ 元树。如果该树中最底层的节点深度为 $d$（根的深度为 $0$），那么我们称它为一棵深度为 $d$ 的严格 $n$ 元树。例如，深度为２的严格２元树有三个，如下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/um9mtoxb.png)\n \n给出 $n,d$，编程数出深度为 $d$ 的 $n$ 元树数目。", "inputFormat": "仅包含两个整数 $n,d(0<n \\le 32,0 \\le d \\le 16)$。输入数据保证你不需要考虑某一层多于 $1024$ 个节点的树（即 $nd \\le 1024$）。提示：答案保证不超过 $200$ 位十进制数。", "outputFormat": "仅包含一个数，即深度为 $d$ 的 $n$ 元树的数目。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4296", "type": "P", "difficulty": 5, "samples": [["12", "1\n5\n7\n11"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2007", "各省省选", "数论", "安徽", "枚举", "优先队列"], "title": "[AHOI2007] 密码箱", "background": "", "description": "在一次偶然的情况下，小可可得到了一个密码箱，听说里面藏着一份古代流传下来的藏宝图，只要能破解密码就能打开箱子，而箱子背面刻着的古代图标，就是对密码的提示。\n\n经过艰苦的破译，小可可发现，这些图标表示一个数以及这个数与密码的关系。假设这个数是 $n$，密码为 $x$，那么可以得到如下表述： 密码 $x$ 大于等于 $0$，且小于 $n$，而 $x$ 的平方除以 $n$，得到的余数为 $1$。 小可可知道满足上述条件的 $x$ 可能不止一个，所以一定要把所有满足条件的 $x$ 计算出来，密码肯定就在其中。计算的过程是很艰苦的，你能否编写一个程序来帮助小可可呢？", "inputFormat": "一行，一个数字 $n$（$1 \\leq n \\leq 2 \\times 10^9$）。", "outputFormat": "你的程序需要找到所有满足前面所描述条件的 $x$，如果不存在这样的 $x$，你的程序只需输出一行 `None`，否则请按照从小到大的顺序输出这些 $x$，每行一个数。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2007] Password Box", "background": "", "description": "By chance, Little Keke obtained a password box said to contain an ancient treasure map. The box can be opened by cracking the password, and the ancient symbols engraved on the back of the box serve as hints.\n\nAfter painstaking deciphering, Little Keke discovered that these symbols describe a number and its relation to the password. Suppose this number is $n$, and the password is $x$. Then we have: the password $x$ is greater than or equal to $0$ and less than $n$, and the remainder of $x^2$ divided by $n$ is $1$. Little Keke knows there may be more than one $x$ that satisfies these conditions, so she must compute all such $x$; the correct password is among them. The computation is arduous—can you write a program to help?", "inputFormat": "One line containing an integer $n$ ($1 \\leq n \\leq 2 \\times 10^9$).", "outputFormat": "Find all $x$ that satisfy the conditions described above. If no such $x$ exists, output a single line `None`. Otherwise, output these $x$ in increasing order, one per line.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2007] 密码箱", "background": "", "description": "在一次偶然的情况下，小可可得到了一个密码箱，听说里面藏着一份古代流传下来的藏宝图，只要能破解密码就能打开箱子，而箱子背面刻着的古代图标，就是对密码的提示。\n\n经过艰苦的破译，小可可发现，这些图标表示一个数以及这个数与密码的关系。假设这个数是 $n$，密码为 $x$，那么可以得到如下表述： 密码 $x$ 大于等于 $0$，且小于 $n$，而 $x$ 的平方除以 $n$，得到的余数为 $1$。 小可可知道满足上述条件的 $x$ 可能不止一个，所以一定要把所有满足条件的 $x$ 计算出来，密码肯定就在其中。计算的过程是很艰苦的，你能否编写一个程序来帮助小可可呢？", "inputFormat": "一行，一个数字 $n$（$1 \\leq n \\leq 2 \\times 10^9$）。", "outputFormat": "你的程序需要找到所有满足前面所描述条件的 $x$，如果不存在这样的 $x$，你的程序只需输出一行 `None`，否则请按照从小到大的顺序输出这些 $x$，每行一个数。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4297", "type": "P", "difficulty": 7, "samples": [["2\n1 0 1 0\n2 2 10 9\n10 1 2\n2 1\n3", "8"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2006", "NOI", "O2优化", "最近公共祖先 LCA", "状压 DP"], "title": "[NOI2006] 网络收费", "background": "noi2006 day1t1", "description": "网络已经成为当今世界不可或缺的一部分。每天都有数以亿计的人使用网络进行学习、科研、娱乐等活动。然而，不可忽视的一点就是网络本身有着庞大的运行费用。所以，向使用网络的人进行适当的收费是必须的，也是合理的。\n\nMY 市 NS 中学就有着这样一个教育网络。网络中的用户一共有 $2^N$ 个，编号依次为 $1,2,3,\\cdots,2^N$。这些用户之间是用路由点和网线组成的。用户、路由点与网线共同构成一个满二叉树结构。树中的每一个叶子结点都是一个用户，每一个非叶子结点（灰色）都是一个路由点，而每一条边都是一条网线（见下图，用户结点中的数字为其编号）。\n\n![](https://cdn.luogu.com.cn/upload/pic/12807.png)\n\nMY 网络公司的网络收费方式比较奇特，称为“配对收费”。即对于每两个用户 $i,j$ $(1\\leq i<j\\leq 2^N)$ 进行收费。由于用户可以自行选择两种付费方式 A、B 中的一种，所以网络公司向学校收取的费用与每一位用户的付费方式有关。该费用等于每两位不同用户配对产生费用之和。\n\n为了描述方便，首先定义这棵网络树上的一些概念：\n\n- 祖先：根结点没有祖先，非根结点的祖先包括它的父亲以及它的父亲的祖先；\n- 管辖叶结点：叶结点本身不管辖任何叶结点，非叶结点管辖它的左儿子所管辖的叶结点与它的右儿子所管辖的叶结点；\n- 距离：在树上连接两个点之间的用边最少的路径所含的边数。\n\n对于任两个用户 $i,j$ $(1\\leq i<j\\leq2^N)$，首先在树上找到与它们距离最近的公共祖先：路由点 $P$，然后观察 $P$ 所管辖的叶结点（即用户）中选择付费方式 A 与 B 的人数，分别记为 $n_A$ 与 $n_B$，接着按照网络管理条例第 X 章第 Y 条第 Z 款进行收费（如下表），其中 $F_{i,j}$ 为 $i$ 和 $j$ 之间的流量，且为已知量。\n\n![](https://cdn.luogu.com.cn/upload/pic/12809.png)\n\n由于最终所付费用与付费方式有关，所以 NS 中学的用户希望能够自行改变自己的付费方式以减少总付费。然而，由于网络公司已经将每个用户注册时所选择的付费方式记录在案，所以对于用户 $i$，如果他/她想改变付费方式（由 A 改为 B 或由 B 改为 A），就必须支付 $C_i$ 元给网络公司以修改档案（修改付费方式记录）。\n\n现在的问题是，给定每个用户注册时所选择的付费方式以及 $C_i$，试求这些用户应该如何选择自己的付费方式以使得 NS 中学支付给网络公司的总费用最少（更改付费方式费用 + 配对收费的费用）。", "inputFormat": "输入文件中第一行有一个正整数 $N$。\n\n第二行有 $2^N$ 个整数，依次表示 $1,2,\\cdots,2^N$ 号用户注册时的付费方式，每一个数字若为 `0`，则表示对应用户的初始付费方式为 A，否则该数字为 `1`，表示付费方式为 B。\n\n第三行有 $2^N$ 个整数，表示每一个用户修改付费方式需要支付的费用，依次为 $C_1,C_2,\\cdots,C_{2^N}$。\n\n以下 $2^N-1$ 行描述给定的两两用户之间的流量表 $F$，总共的第 $i+3$ 行第 $j$ 列的整数为 $F_{i,j+i}$。（$1\\leq i<2^N,1\\leq j\\leq2^N-i$）\n\n所有变量的含义可以参见题目描述。", "outputFormat": "你的程序只需要向输出文件输出一个整数，表示 NS 中学支付给网络公司的最小总费用。（单位：元）", "hint": "【样例说明】\n\n将 $1$ 号用户的付费方式由 B 改为 A，NS 中学支付给网络公司的费用达到最小。\n\n【数据范围】\n\n$40\\%$ 的数据中 $N\\leq4$；\n\n$80\\%$ 的数据中 $N\\leq7$；\n\n$100\\%$ 的数据中 $N\\leq10,0\\leq F_{i,j}\\leq500,0\\leq C_i\\leq500000$。", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2006] Network Charging", "background": "NOI2006 Day 1 T1.", "description": "The network has become an indispensable part of today’s world. Hundreds of millions of people use the network every day for learning, research, entertainment, and more. However, it is important to note that the network itself has huge operating costs. Therefore, it is necessary and reasonable to charge users appropriately.\n\nNS Middle School in MY City has such an educational network. There are $2^N$ users in the network, numbered $1, 2, 3, \\cdots, 2^N$. These users are connected by router nodes and network cables. The users, router nodes, and network cables together form a full binary tree. Every leaf node of the tree is a user, every non-leaf node (gray) is a router node, and every edge is a network cable (see the figure; the numbers in user nodes are their IDs).\n\nMY Network Company uses an unusual pricing model called “paired charging.” That is, fees are charged for every pair of users $i, j$ with $1 \\leq i < j \\leq 2^N$. Since each user can independently choose one of the two payment plans A or B, the fee the company charges the school depends on each user’s plan. The total fee equals the sum of the fees generated by all pairs of distinct users.\n\nFor convenience, we first define some concepts on this network tree:\n\n- Ancestor: The root node has no ancestors. For a non-root node, its ancestors include its parent and all ancestors of its parent.\n- Covered leaf nodes: A leaf node covers no leaf nodes. A non-leaf node covers the leaf nodes covered by its left child and the leaf nodes covered by its right child.\n- Distance: The number of edges on a shortest path connecting two nodes in the tree.\n\nFor any two users $i, j$ with $1 \\leq i < j \\leq 2^N$, first find their nearest common ancestor (LCA) in the tree: router node $P$. Then, among the leaf nodes (i.e., users) covered by $P$, count how many chose plan A and how many chose plan B, denoted $n_A$ and $n_B$, respectively. Next, the fee is charged according to Article X, Section Y, Clause Z of the Network Management Regulations (see the table below), where $F_{i,j}$ is the traffic between $i$ and $j$, and $F_{i,j}$ is known.\n\nSince the final amount paid depends on the choice of payment plans, users at NS Middle School hope to change their plans to reduce the total payment. However, since the network company has recorded the plan each user chose at registration, user $i$ must pay $C_i$ yuan to the company to modify the record (switch plan A to B or B to A).\n\nNow the problem: given each user’s initial plan and the values $C_i$, determine how these users should choose their plans to minimize the total fee NS Middle School pays to the network company (switching fees + paired charging fees).", "inputFormat": "The first line contains a positive integer $N$.\n\nThe second line contains $2^N$ integers, giving the initial plan of users $1, 2, \\cdots, 2^N$. If a number is `0`, the corresponding user’s initial plan is A; otherwise the number is `1`, meaning plan B.\n\nThe third line contains $2^N$ integers, the switching fee for each user, namely $C_1, C_2, \\cdots, C_{2^N}$.\n\nThe next $2^N - 1$ lines describe the traffic table $F$ between every pair of users. Specifically, in the overall line $i + 3$, the integer in column $j$ equals $F_{i, j + i}$, for $1 \\leq i < 2^N$ and $1 \\leq j \\leq 2^N - i$.\n\nSee the problem statement for the meaning of all variables.", "outputFormat": "Output a single integer: the minimum total fee (in yuan) that NS Middle School pays to the network company.", "hint": "Sample Explanation:\nChanging user $1$ from plan B to plan A yields the minimum total payment.\n\nConstraints:\n- In $40\\%$ of the testdata, $N \\leq 4$.\n- In $80\\%$ of the testdata, $N \\leq 7$.\n- In $100\\%$ of the testdata, $N \\leq 10$, $0 \\leq F_{i,j} \\leq 500$, $0 \\leq C_i \\leq 500000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2006] 网络收费", "background": "noi2006 day1t1", "description": "网络已经成为当今世界不可或缺的一部分。每天都有数以亿计的人使用网络进行学习、科研、娱乐等活动。然而，不可忽视的一点就是网络本身有着庞大的运行费用。所以，向使用网络的人进行适当的收费是必须的，也是合理的。\n\nMY 市 NS 中学就有着这样一个教育网络。网络中的用户一共有 $2^N$ 个，编号依次为 $1,2,3,\\cdots,2^N$。这些用户之间是用路由点和网线组成的。用户、路由点与网线共同构成一个满二叉树结构。树中的每一个叶子结点都是一个用户，每一个非叶子结点（灰色）都是一个路由点，而每一条边都是一条网线（见下图，用户结点中的数字为其编号）。\n\n![](https://cdn.luogu.com.cn/upload/pic/12807.png)\n\nMY 网络公司的网络收费方式比较奇特，称为“配对收费”。即对于每两个用户 $i,j$ $(1\\leq i<j\\leq 2^N)$ 进行收费。由于用户可以自行选择两种付费方式 A、B 中的一种，所以网络公司向学校收取的费用与每一位用户的付费方式有关。该费用等于每两位不同用户配对产生费用之和。\n\n为了描述方便，首先定义这棵网络树上的一些概念：\n\n- 祖先：根结点没有祖先，非根结点的祖先包括它的父亲以及它的父亲的祖先；\n- 管辖叶结点：叶结点本身不管辖任何叶结点，非叶结点管辖它的左儿子所管辖的叶结点与它的右儿子所管辖的叶结点；\n- 距离：在树上连接两个点之间的用边最少的路径所含的边数。\n\n对于任两个用户 $i,j$ $(1\\leq i<j\\leq2^N)$，首先在树上找到与它们距离最近的公共祖先：路由点 $P$，然后观察 $P$ 所管辖的叶结点（即用户）中选择付费方式 A 与 B 的人数，分别记为 $n_A$ 与 $n_B$，接着按照网络管理条例第 X 章第 Y 条第 Z 款进行收费（如下表），其中 $F_{i,j}$ 为 $i$ 和 $j$ 之间的流量，且为已知量。\n\n![](https://cdn.luogu.com.cn/upload/pic/12809.png)\n\n由于最终所付费用与付费方式有关，所以 NS 中学的用户希望能够自行改变自己的付费方式以减少总付费。然而，由于网络公司已经将每个用户注册时所选择的付费方式记录在案，所以对于用户 $i$，如果他/她想改变付费方式（由 A 改为 B 或由 B 改为 A），就必须支付 $C_i$ 元给网络公司以修改档案（修改付费方式记录）。\n\n现在的问题是，给定每个用户注册时所选择的付费方式以及 $C_i$，试求这些用户应该如何选择自己的付费方式以使得 NS 中学支付给网络公司的总费用最少（更改付费方式费用 + 配对收费的费用）。", "inputFormat": "输入文件中第一行有一个正整数 $N$。\n\n第二行有 $2^N$ 个整数，依次表示 $1,2,\\cdots,2^N$ 号用户注册时的付费方式，每一个数字若为 `0`，则表示对应用户的初始付费方式为 A，否则该数字为 `1`，表示付费方式为 B。\n\n第三行有 $2^N$ 个整数，表示每一个用户修改付费方式需要支付的费用，依次为 $C_1,C_2,\\cdots,C_{2^N}$。\n\n以下 $2^N-1$ 行描述给定的两两用户之间的流量表 $F$，总共的第 $i+3$ 行第 $j$ 列的整数为 $F_{i,j+i}$。（$1\\leq i<2^N,1\\leq j\\leq2^N-i$）\n\n所有变量的含义可以参见题目描述。", "outputFormat": "你的程序只需要向输出文件输出一个整数，表示 NS 中学支付给网络公司的最小总费用。（单位：元）", "hint": "【样例说明】\n\n将 $1$ 号用户的付费方式由 B 改为 A，NS 中学支付给网络公司的费用达到最小。\n\n【数据范围】\n\n$40\\%$ 的数据中 $N\\leq4$；\n\n$80\\%$ 的数据中 $N\\leq7$；\n\n$100\\%$ 的数据中 $N\\leq10,0\\leq F_{i,j}\\leq500,0\\leq C_i\\leq500000$。", "locale": "zh-CN"}}}
{"pid": "P4298", "type": "P", "difficulty": 7, "samples": [["4 4\n1 2\n3 4\n3 2\n4 2", "2\n1010\n1011"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2008", "网络流", "Special Judge", "二分图", "构造", "CTSC/CTS"], "title": "[CTSC2008] 祭祀", "background": "", "description": "在遥远的东方，有一个神秘的民族，自称 Y 族。他们世代居住在水面上，奉龙王为神。每逢重大庆典，Y 族都会在水面上举办盛大的祭祀活动。我们可以把 Y 族居住地水系看成一个由岔口和河道组成的网络。每条河道连接着两个岔口，并且水在河道内按照一个固定的方向流动。显然，水系中不会有环流（下图描述一个环流的例子）。\n\n ![](https://cdn.luogu.com.cn/upload/pic/15479.png)\n\n由于人数众多的原因，Y 族的祭祀活动会在多个岔口上同时举行。出于对龙王的尊重，这些祭祀地点的选择必须非常慎重。准确地说，Y 族人认为，如果水流可以从一个祭祀点流到另外一个祭祀点，那么祭祀就会失去它神圣的意义。族长希望在保持祭祀神圣性的基础上，选择尽可能多的祭祀的地点。", "inputFormat": "第一行包含两个用空格隔开的整数 $N$、$M$，分别表示岔口和河道的数目，岔口从 $1$ 到 $N$ 编号。\n\n接下来 $M$ 行，每行包含两个用空格隔开的整数 $u$、$v$，描述一条连接岔口 $u$ 和岔口 $v$ 的河道，水流方向为自 $u$ 向 $v$。", "outputFormat": "第一行包含一个整数 $K$，表示最多能选取的祭祀点的个数。\n\n接下来一行输出一种可行的选取方案。对于每个岔口依次输出一个整数，如果在该岔口设置了祭祀点，那么输出一个 `1`，否则输出一个 `0`。应确保你输出的 `1` 的个数最多，且中间没有空格。\n\n接下来一行输出，在选择最多祭祀点的前提下，每个岔口是否能够设置祭祀点。对于每个岔口依次输出一个整数，如果在该岔口能够设置祭祀点，那么输出一个 `1`，否则输出一个 `0`。\n\n注意：多余的空格和换行可能会导致你的答案被判断为错误答案。", "hint": "$N \\le 100, M \\le 1000$\n\n在样例给出的水系中，不存在一种方法能够选择三个或者三个以上的祭祀点。包含两个祭祀点的测试点的方案有两种：\n\n选择岔口 $1$ 与岔口 $3$（如样例输出第二行），选择岔口 $1$ 与岔口 $4$。\n\n水流可以从任意岔口流至岔口 $2$。如果在岔口 $2$ 建立祭祀点，那么任意其他岔口都不能建立祭祀点但是在最优的一种祭祀点的选取方案中我们可以建立两个祭祀点，所以岔口 $2$ 不能建立祭祀点。对于其他岔口至少存在一个最优方案选择该岔口为祭祀点，所以输出为 `1011`。\n\n感谢@ACdreamer 提供SPJ", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2008] Ritual", "background": "", "description": "In the distant East, there is a mysterious people who call themselves the Y tribe. They have lived on the water for generations and worship the Dragon King as their deity. On major festivals, the Y tribe holds grand ritual ceremonies on the water. We can regard the water system of their habitat as a network composed of junctions and rivers. Each river connects two junctions, and water flows along each river in a fixed direction. Clearly, there is no circular flow in the water system (the figure below shows an example of a circular flow).\n\n![](https://cdn.luogu.com.cn/upload/pic/15479.png)\n\nBecause of their large population, the rituals will be held simultaneously at multiple junctions. Out of respect for the Dragon King, the selection of ritual locations must be very cautious. Specifically, the Y tribespeople believe that if water can flow from one ritual point to another ritual point, the ritual loses its sacred meaning. The chief wants to select as many ritual locations as possible while maintaining sacredness.", "inputFormat": "The first line contains two integers $N$ and $M$ separated by a space, representing the numbers of junctions and rivers, respectively. Junctions are numbered from $1$ to $N$.\n\nEach of the next $M$ lines contains two integers $u$ and $v$ separated by a space, describing a river connecting junction $u$ and junction $v$, with water flowing from $u$ to $v$.", "outputFormat": "The first line contains an integer $K$, the maximum number of junctions that can be selected as ritual points.\n\nThe next line outputs one feasible selection scheme. For each junction in order, output an integer: output `1` if a ritual point is set at this junction, otherwise output `0`. The number of `1`s must be maximum, and there should be no spaces between them.\n\nThe next line outputs, under the premise of selecting the maximum number of ritual points, whether each junction can be chosen as a ritual point in some optimal scheme. For each junction in order, output an integer: output `1` if this junction can be chosen as a ritual point in at least one optimal scheme, otherwise output `0`.\n\nNote: Extra spaces and line breaks may cause your answer to be judged as a Wrong Answer.", "hint": "$N \\le 100$, $M \\le 1000$.\n\nIn the sample water system, there is no way to select three or more ritual points. There are two solutions that contain two ritual points:\n- Choose junction $1$ and junction $3$ (as in the second line of the sample output).\n- Choose junction $1$ and junction $4$.\n\nWater can flow from any junction to junction $2$. If a ritual point is set at junction $2$, then no other junction can host a ritual point. However, in an optimal selection scheme we can set two ritual points, so junction $2$ cannot be chosen as a ritual point. For every other junction, there exists at least one optimal scheme that chooses it, so the output is `1011`.\n\nThanks to @ACdreamer for providing the SPJ.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2008] 祭祀", "background": "", "description": "在遥远的东方，有一个神秘的民族，自称 Y 族。他们世代居住在水面上，奉龙王为神。每逢重大庆典，Y 族都会在水面上举办盛大的祭祀活动。我们可以把 Y 族居住地水系看成一个由岔口和河道组成的网络。每条河道连接着两个岔口，并且水在河道内按照一个固定的方向流动。显然，水系中不会有环流（下图描述一个环流的例子）。\n\n ![](https://cdn.luogu.com.cn/upload/pic/15479.png)\n\n由于人数众多的原因，Y 族的祭祀活动会在多个岔口上同时举行。出于对龙王的尊重，这些祭祀地点的选择必须非常慎重。准确地说，Y 族人认为，如果水流可以从一个祭祀点流到另外一个祭祀点，那么祭祀就会失去它神圣的意义。族长希望在保持祭祀神圣性的基础上，选择尽可能多的祭祀的地点。", "inputFormat": "第一行包含两个用空格隔开的整数 $N$、$M$，分别表示岔口和河道的数目，岔口从 $1$ 到 $N$ 编号。\n\n接下来 $M$ 行，每行包含两个用空格隔开的整数 $u$、$v$，描述一条连接岔口 $u$ 和岔口 $v$ 的河道，水流方向为自 $u$ 向 $v$。", "outputFormat": "第一行包含一个整数 $K$，表示最多能选取的祭祀点的个数。\n\n接下来一行输出一种可行的选取方案。对于每个岔口依次输出一个整数，如果在该岔口设置了祭祀点，那么输出一个 `1`，否则输出一个 `0`。应确保你输出的 `1` 的个数最多，且中间没有空格。\n\n接下来一行输出，在选择最多祭祀点的前提下，每个岔口是否能够设置祭祀点。对于每个岔口依次输出一个整数，如果在该岔口能够设置祭祀点，那么输出一个 `1`，否则输出一个 `0`。\n\n注意：多余的空格和换行可能会导致你的答案被判断为错误答案。", "hint": "$N \\le 100, M \\le 1000$\n\n在样例给出的水系中，不存在一种方法能够选择三个或者三个以上的祭祀点。包含两个祭祀点的测试点的方案有两种：\n\n选择岔口 $1$ 与岔口 $3$（如样例输出第二行），选择岔口 $1$ 与岔口 $4$。\n\n水流可以从任意岔口流至岔口 $2$。如果在岔口 $2$ 建立祭祀点，那么任意其他岔口都不能建立祭祀点但是在最优的一种祭祀点的选取方案中我们可以建立两个祭祀点，所以岔口 $2$ 不能建立祭祀点。对于其他岔口至少存在一个最优方案选择该岔口为祭祀点，所以输出为 `1011`。\n\n感谢@ACdreamer 提供SPJ", "locale": "zh-CN"}}}
