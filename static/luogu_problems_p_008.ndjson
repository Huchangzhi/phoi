{"pid": "P3028", "type": "P", "difficulty": 2, "samples": [["4 \n3 5 \n4 8 \n1 2 \n5 10 \n", "3 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2010", "USACO"], "title": "[USACO10OCT] Soda Machine G", "background": "", "description": "To meet the ever-growing demands of his N (1 &amp;lt;= N &amp;lt;= 50,000) cows, Farmer John has bought them a new soda machine. He wants to figure out the perfect place to install the machine.\n\nThe field in which the cows graze can be represented as a one-dimensional number line. Cow i grazes in the range A\\_i..B\\_i (1 &amp;lt;= A\\_i &amp;lt;= B\\_i; A\\_i &amp;lt;= B\\_i &amp;lt;= 1,000,000,000) (a range that includes its endpoints), and FJ can place the soda machine at any integer point in the range 1..1,000,000,000.  Since cows are extremely lazy and try to move as little as possible, each cow would like to have the soda machine installed within her grazing range.\n\nSadly, it is not always possible to satisfy every cow's desires. Thus FJ would like to know the largest number of cows that can be satisfied.\n\nTo demonstrate the issue, consider four cows with grazing ranges 3..5, 4..8, 1..2, and 5..10; below is a schematic of their grazing ranges:\n\n```cpp\n\n         1   2   3   4   5   6   7   8   9  10  11  12  13\n         |---|---|---|---|---|---|---|---|---|---|---|---|-...\n                 aaaaaaaaa\n                     bbbbbbbbbbbbbbbbb\n         ccccc           ddddddddddddddddddddd\n```\nAs can be seen, the first, second and fourth cows share the point 5, but the third cow's grazing range is disjoint.  Thus, a maximum of 3 cows can have the soda machine within their grazing range.\n\n\n有N个人要去膜拜JZ，他们不知道JZ会出现在哪里，因此每个人有一个活动范围，只要JZ出现在这个范围内就能被膜拜，\n\n伟大的JZ当然希望膜拜他的人越多越好，但是JZ不能分身，因此只能选择一个位置出现，他最多可以被多少人膜拜呢，\n\n这个简单的问题JZ当然交给你了\n", "inputFormat": "\\* Line 1: A single integer: N\n\n\\* Lines 2..N+1: Line i+1 contains two space-separated integers: A\\_i and B\\_i\n", "outputFormat": "\\* Line 1: A single integer representing the largest number of cows whose grazing intervals can all contain the soda machine.\n", "hint": "If the soda machine is placed at location 5, cows 1, 2, and 4 can be satisfied. It is impossible to satisfy all four cows.\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO10OCT] Soda Machine G", "background": "", "description": "To meet the ever-growing demands of his $N$ ($1 \\le N \\le 50{,}000$) cows, Farmer John has bought them a new soda machine. He wants to figure out the perfect place to install the machine.\n\nThe field in which the cows graze can be represented as a one-dimensional number line. Cow $i$ grazes in the range $A_i..B_i$ ($1 \\le A_i \\le B_i$; $A_i \\le B_i \\le 1{,}000{,}000{,}000$), where the range includes its endpoints, and FJ can place the soda machine at any integer point in the range $1..1{,}000{,}000{,}000$. Since cows are extremely lazy and try to move as little as possible, each cow would like to have the soda machine installed within her grazing range.\n\nSadly, it is not always possible to satisfy every cow's desires. Thus FJ would like to know the largest number of cows that can be satisfied.\n\nTo demonstrate the issue, consider four cows with grazing ranges $3..5$, $4..8$, $1..2$, and $5..10$; below is a schematic of their grazing ranges:\n\n```cpp\n\n         1   2   3   4   5   6   7   8   9  10  11  12  13\n         |---|---|---|---|---|---|---|---|---|---|---|---|-...\n                 aaaaaaaaa\n                     bbbbbbbbbbbbbbbbb\n         ccccc           ddddddddddddddddddddd\n```\n\nAs can be seen, the first, second, and fourth cows share the point $5$, but the third cow's grazing range is disjoint. Thus, a maximum of $3$ cows can have the soda machine within their grazing range.\n\nThere are $N$ people who want to worship JZ. They do not know where JZ will appear, so each person has an activity range. As long as JZ appears within this range, that person can worship him. The great JZ certainly hopes that as many people as possible will worship him. However, JZ cannot be in multiple places at once and can choose only one position to appear. What is the maximum number of people who can worship him?", "inputFormat": "- Line 1: A single integer $N$.\n- Lines $2..N+1$: Line $i+1$ contains two space-separated integers $A_i$ and $B_i$.", "outputFormat": "- Line 1: A single integer representing the largest number of cows whose grazing intervals can all contain the soda machine.", "hint": "If the soda machine is placed at location $5$, cows $1$, $2$, and $4$ can be satisfied. It is impossible to satisfy all four cows.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO10OCT] Soda Machine G", "background": "", "description": "To meet the ever-growing demands of his N (1 &amp;lt;= N &amp;lt;= 50,000) cows, Farmer John has bought them a new soda machine. He wants to figure out the perfect place to install the machine.\n\nThe field in which the cows graze can be represented as a one-dimensional number line. Cow i grazes in the range A\\_i..B\\_i (1 &amp;lt;= A\\_i &amp;lt;= B\\_i; A\\_i &amp;lt;= B\\_i &amp;lt;= 1,000,000,000) (a range that includes its endpoints), and FJ can place the soda machine at any integer point in the range 1..1,000,000,000.  Since cows are extremely lazy and try to move as little as possible, each cow would like to have the soda machine installed within her grazing range.\n\nSadly, it is not always possible to satisfy every cow's desires. Thus FJ would like to know the largest number of cows that can be satisfied.\n\nTo demonstrate the issue, consider four cows with grazing ranges 3..5, 4..8, 1..2, and 5..10; below is a schematic of their grazing ranges:\n\n```cpp\n\n         1   2   3   4   5   6   7   8   9  10  11  12  13\n         |---|---|---|---|---|---|---|---|---|---|---|---|-...\n                 aaaaaaaaa\n                     bbbbbbbbbbbbbbbbb\n         ccccc           ddddddddddddddddddddd\n```\nAs can be seen, the first, second and fourth cows share the point 5, but the third cow's grazing range is disjoint.  Thus, a maximum of 3 cows can have the soda machine within their grazing range.\n\n\n有N个人要去膜拜JZ，他们不知道JZ会出现在哪里，因此每个人有一个活动范围，只要JZ出现在这个范围内就能被膜拜，\n\n伟大的JZ当然希望膜拜他的人越多越好，但是JZ不能分身，因此只能选择一个位置出现，他最多可以被多少人膜拜呢，\n\n这个简单的问题JZ当然交给你了\n", "inputFormat": "\\* Line 1: A single integer: N\n\n\\* Lines 2..N+1: Line i+1 contains two space-separated integers: A\\_i and B\\_i\n", "outputFormat": "\\* Line 1: A single integer representing the largest number of cows whose grazing intervals can all contain the soda machine.\n", "hint": "If the soda machine is placed at location 5, cows 1, 2, and 4 can be satisfied. It is impossible to satisfy all four cows.\n", "locale": "zh-CN"}}}
{"pid": "P3029", "type": "P", "difficulty": 3, "samples": [["6 \n25 7 \n26 1 \n15 1 \n22 3 \n20 1 \n30 1 \n", "4 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "USACO", "离散化", "队列", "双指针 two-pointer"], "title": "[USACO11NOV] Cow Lineup S", "background": "", "description": "Farmer John has hired a professional photographer to take a picture of some of his cows.  Since FJ's cows represent a variety of different breeds, he would like the photo to contain at least one cow from each distinct breed present in his herd.\n\nFJ's N cows are all standing at various positions along a line, each described by an integer position (i.e., its x coordinate) as well as an integer breed ID.  FJ plans to take a photograph of a contiguous range of cows along the line.  The cost of this photograph is equal its size -- that is, the difference between the maximum and minimum x coordinates of the cows in the range of the photograph.\n\nPlease help FJ by computing the minimum cost of a photograph in which there is at least one cow of each distinct breed appearing in FJ's herd.\n", "inputFormat": "\\* Line 1: The number of cows, N (1 <= N <= 50,000). \n\n\\* Lines 2..1+N: Each line contains two space-separated positive integers specifying the x coordinate and breed ID of a single cow.  Both numbers are at most 1 billion.\n", "outputFormat": "\\* Line 1: The smallest cost of a photograph containing each distinct breed ID.\n", "hint": "There are 6 cows, at positions 25,26,15,22,20,30, with respective breed IDs 7,1,1,3,1,1.\n\n\nThe range from x=22 up through x=26 (of total size 4) contains each of the distinct breed IDs 1, 3, and 7 represented in FJ's herd.\n", "locale": "en", "translations": {"en": {"title": "[USACO11NOV] Cow Lineup S", "background": "", "description": "Farmer John has hired a professional photographer to take a picture of some of his cows.  Since FJ's cows represent a variety of different breeds, he would like the photo to contain at least one cow from each distinct breed present in his herd.\n\nFJ's N cows are all standing at various positions along a line, each described by an integer position (i.e., its x coordinate) as well as an integer breed ID.  FJ plans to take a photograph of a contiguous range of cows along the line.  The cost of this photograph is equal its size -- that is, the difference between the maximum and minimum x coordinates of the cows in the range of the photograph.\n\nPlease help FJ by computing the minimum cost of a photograph in which there is at least one cow of each distinct breed appearing in FJ's herd.\n", "inputFormat": "\\* Line 1: The number of cows, N (1 <= N <= 50,000). \n\n\\* Lines 2..1+N: Each line contains two space-separated positive integers specifying the x coordinate and breed ID of a single cow.  Both numbers are at most 1 billion.\n", "outputFormat": "\\* Line 1: The smallest cost of a photograph containing each distinct breed ID.\n", "hint": "There are 6 cows, at positions 25,26,15,22,20,30, with respective breed IDs 7,1,1,3,1,1.\n\n\nThe range from x=22 up through x=26 (of total size 4) contains each of the distinct breed IDs 1, 3, and 7 represented in FJ's herd.\n", "locale": "en"}, "zh-CN": {"title": "[USACO11NOV] Cow Lineup S", "background": null, "description": "农民约翰雇佣了一位专业摄影师来拍摄他的一些奶牛。由于约翰的奶牛代表了多种不同的品种，他希望照片中至少包含他牛群中每种不同品种的一头奶牛。\n\n约翰的 $N$ 头奶牛都站在一条线上的不同位置，每头奶牛的位置由一个整数（即其 $x$ 坐标）和一个整数品种 ID 描述。约翰计划拍摄一段连续的奶牛范围。该照片的成本等于其大小——即照片中奶牛的最大和最小 $x$ 坐标之间的差。\n\n请帮助约翰计算出一张照片的最小成本，其中至少包含约翰牛群中每种不同品种的一头奶牛。", "inputFormat": "* 第 $1$ 行：奶牛的数量 $N$（$1 \\leq N \\leq 50,000$）。\n* 第 $2$ 行到第 $1+N$ 行：每行包含两个用空格分隔的正整数，分别指定一头奶牛的 $x$ 坐标和品种 ID。这两个数字的最大值为 $10^9$。", "outputFormat": "* 第 $1$ 行：包含每种不同品种 ID 的照片的最小成本。", "hint": "有 $6$ 头奶牛，位置分别为 $25$、$26$、$15$、$22$、$20$、$30$，品种 ID 分别为 $7$、$1$、$1$、$3$、$1$、$1$。\n\n从 $x=22$ 到 $x=26$ 的范围（总大小为 $4$）包含了约翰的牛群中每种不同的品种 ID：$1$、$3$ 和 $7$。", "locale": "zh-CN"}}}
{"pid": "P3030", "type": "P", "difficulty": 3, "samples": [["3 6 \n3 \n3 \n1 \n", "5 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2011", "USACO", "深度优先搜索 DFS", "记忆化搜索"], "title": "[USACO11NOV] Tile Exchanging S", "background": "", "description": "Farmer John wants to remodel the floor of his barn using a collection of square tiles he recently purchased from the local square mart store (which of course, only sells square objects).  Unfortunately, he didn't measure the size of the barn properly before making his purchase, so now he needs to exchange some of his tiles for new square tiles of different sizes.\n\nThe N square tiles previously purchased by FJ have side lengths A\\_1...A\\_N. He would like to exchange some of these with new square tiles so that the total sum of the areas of the his tiles is exactly M.  Square mart is currently offering a special deal: a tile of side length A\\_i can be exchanged for a new tile of side length B\\_i for a cost of\n\n|A\\_i-B\\_i|\\*|A\\_i-B\\_i| units. However, this deal only applies to \npreviously-purchased tiles -- FJ is not allowed to exchange a tile that he has already obtained via exchanging some other tile (i.e., a size-3 tile cannot be exchanged for a size-2 tile, which is then exchanged for a size-1 tile).\n\nPlease determine the minimum amount of money required to exchange tiles so that the sum of the areas of the tiles becomes M.  Output -1 if it is impossible to obtain an area of M.\n\n", "inputFormat": "\\* Line 1: Two space-separated integers, N (1<=N<=10) and M \n\n(1<=M<=10,000). \n\n\\* Lines 2..1+N: Each line contains one of the integers A\\_1 through A\\_N, describing the side length of an input square\n\n(1<=A\\_i<=100). \n\n", "outputFormat": "\\* Line 1: The minimum cost of exchanging tiles to obtain M units of total area, or -1 if this is impossible.\n", "hint": "There are 3 tiles.  Two are squares of side length 3, and one is a square with side length 1.  We would like to exchange these to make a total area of 6.\n\n\nExchange one of the side-3 squares for a side-2 square, and another side-3 square for a side-1 square.  This gives the desired area of 4+1+1=6 and costs 4+1=5 units.\n\n感谢 wjcwinmt 提供翻译\n", "locale": "en", "translations": {"en": {"title": "[USACO11NOV] Tile Exchanging S", "background": "", "description": "Farmer John wants to remodel the floor of his barn using a collection of square tiles he recently purchased from the local square mart store (which of course, only sells square objects).  Unfortunately, he didn't measure the size of the barn properly before making his purchase, so now he needs to exchange some of his tiles for new square tiles of different sizes.\n\nThe N square tiles previously purchased by FJ have side lengths A\\_1...A\\_N. He would like to exchange some of these with new square tiles so that the total sum of the areas of the his tiles is exactly M.  Square mart is currently offering a special deal: a tile of side length A\\_i can be exchanged for a new tile of side length B\\_i for a cost of\n\n|A\\_i-B\\_i|\\*|A\\_i-B\\_i| units. However, this deal only applies to \npreviously-purchased tiles -- FJ is not allowed to exchange a tile that he has already obtained via exchanging some other tile (i.e., a size-3 tile cannot be exchanged for a size-2 tile, which is then exchanged for a size-1 tile).\n\nPlease determine the minimum amount of money required to exchange tiles so that the sum of the areas of the tiles becomes M.  Output -1 if it is impossible to obtain an area of M.\n\n", "inputFormat": "\\* Line 1: Two space-separated integers, N (1<=N<=10) and M \n\n(1<=M<=10,000). \n\n\\* Lines 2..1+N: Each line contains one of the integers A\\_1 through A\\_N, describing the side length of an input square\n\n(1<=A\\_i<=100). \n\n", "outputFormat": "\\* Line 1: The minimum cost of exchanging tiles to obtain M units of total area, or -1 if this is impossible.\n", "hint": "There are 3 tiles.  Two are squares of side length 3, and one is a square with side length 1.  We would like to exchange these to make a total area of 6.\n\n\nExchange one of the side-3 squares for a side-2 square, and another side-3 square for a side-1 square.  This gives the desired area of 4+1+1=6 and costs 4+1=5 units.\n\n感谢 wjcwinmt 提供翻译\n", "locale": "en"}, "zh-CN": {"title": "[USACO11NOV] Tile Exchanging S", "background": "", "description": "农夫 John 想用他最近从当地的方形商店购买的一批方形瓷砖来重新装修他的谷仓地板（当然，该商店只出售方形物品）。不幸的是，他在购买之前没有正确测量谷仓的大小，所以现在他需要将一些瓷砖换成不同尺寸的新方形瓷砖。\n\nFJ 之前购买的 N 块方形瓷砖的边长为 $A_1...A_N$。他希望用新方形瓷砖替换其中的一些，以便他的瓷砖总面积正好为 $M$。方形商店目前提供一个特别优惠：边长为 $A_i$ 的瓷砖可以以 $|A_i-B_i| \\times |A_i-B_i|$ 单位的成本换成边长为 $B_i$ 的新瓷砖。然而，这个优惠仅适用于之前购买的瓷砖——FJ 不允许将已经通过交换获得的瓷砖再次交换（即，不能将一块边长为 3 的瓷砖换成边长为 2 的瓷砖，然后再换成边长为 1 的瓷砖）。\n\n请确定需要多少最少的钱来交换瓷砖，使瓷砖的总面积变为 $M$。如果无法获得面积为 $M$，则输出 -1。", "inputFormat": "* 第 1 行：两个以空格分隔的整数，$N$（$1 \\leq N \\leq 10$）和 $M$（$1 \\leq M \\leq 10,000$）。\n\n* 第 2 行到第 $1+N$ 行：每行包含一个整数 $A_1$ 到 $A_N$，描述输入方形的边长（$1 \\leq A_i \\leq 100$）。", "outputFormat": "* 第 1 行：交换瓷砖以获得 $M$ 单位总面积的最低成本，如果不可能则输出 -1。", "hint": "有 3 块瓷砖。两块是边长为 3 的正方形，一块是边长为 1 的正方形。我们希望通过交换这些瓷砖使总面积为 6。\n\n将一块边长为 3 的正方形换成边长为 2 的正方形，另一块边长为 3 的正方形换成边长为 1 的正方形。这将得到期望的面积 $4+1+1=6$，成本为 $4+1=5$ 单位。\n\n感谢 wjcwinmt 提供翻译。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P3031", "type": "P", "difficulty": 4, "samples": [["4 6 \n10 \n5 \n6 \n2 \n", "7 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "USACO", "树状数组", "前缀和"], "title": "[USACO11NOV] Above the Median G", "background": "", "description": "Farmer John has lined up his N (1 <= N <= 100,000) cows in a row to measure their heights; cow i has height H\\_i (1 <= H\\_i <= 1,000,000,000) nanometers--FJ believes in precise measurements! He wants to take a picture of some contiguous subsequence of the cows to submit to a bovine photography contest at the county fair.\n\nThe fair has a very strange rule about all submitted photos: a photograph is only valid to submit if it depicts a group of cows whose median height is at least a certain threshold X (1 <= X <= 1,000,000,000).\n\nFor purposes of this problem, we define the median of an array A[0...K] to be A[ceiling(K/2)] after A is sorted, where ceiling(K/2) gives K/2 rounded up to the nearest integer (or K/2 itself, it K/2 is an integer to begin with). For example the median of {7, 3, 2, 6} is 6, and the median of {5, 4, 8} is 5.\n\nPlease help FJ count the number of different contiguous subsequences of his cows that he could potentially submit to the photography contest.\n\n给出一串数字，问中位数大于等于X的连续子串有几个。（这里如果有偶数个数，定义为偏大的那一个而非中间取平均）\n", "inputFormat": "\\* Line 1: Two space-separated integers: N and X.\n\n\\* Lines 2..N+1: Line i+1 contains the single integer H\\_i.\n", "outputFormat": "\\* Line 1: The number of subsequences of FJ's cows that have median at least X. Note this may not fit into a 32-bit integer.\n", "hint": "FJ's four cows have heights 10, 5, 6, 2. We want to know how many contiguous subsequences have median at least 6.\n\n\nThere are 10 possible contiguous subsequences to consider. Of these, only 7 have median at least 6. They are {10}, {6}, {10, 5}, {5, 6}, {6, 2}, {10, 5, 6}, {10, 5, 6, 2}.\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO11NOV] Above the Median G", "background": "", "description": "Farmer John has lined up his N (1 <= N <= 100,000) cows in a row to measure their heights; cow i has height H\\_i (1 <= H\\_i <= 1,000,000,000) nanometers—FJ believes in precise measurements. He wants to take a picture of some contiguous subsequence of the cows to submit to a bovine photography contest at the county fair.\n\nThe fair has a very strange rule about all submitted photos: a photograph is only valid to submit if it depicts a group of cows whose median height is at least a certain threshold X (1 <= X <= 1,000,000,000).\n\nFor the purposes of this problem, we define the median of an array A[0...K] to be A[ceiling(K/2)] after A is sorted, where ceiling(K/2) gives K/2 rounded up to the nearest integer (or K/2 itself, if K/2 is an integer to begin with). For example, the median of {7, 3, 2, 6} is 6, and the median of {5, 4, 8} is 5.\n\nPlease help FJ count the number of different contiguous subsequences of his cows that he could potentially submit to the photography contest.\n\nGiven a sequence of numbers, count how many contiguous subsequences have a median greater than or equal to X. For an even count, the median is defined as the higher middle value rather than the average.", "inputFormat": "- Line 1: Two space-separated integers: N and X.\n- Lines 2..N+1: Line i+1 contains the single integer H\\_i.", "outputFormat": "- Line 1: The number of subsequences of FJ's cows that have median at least X. Note this may not fit into a 32-bit integer.", "hint": "FJ's four cows have heights 10, 5, 6, 2. We want to know how many contiguous subsequences have median at least 6.\n\nThere are 10 possible contiguous subsequences to consider. Of these, only 7 have median at least 6. They are {10}, {6}, {10, 5}, {5, 6}, {6, 2}, {10, 5, 6}, {10, 5, 6, 2}.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO11NOV] Above the Median G", "background": "", "description": "Farmer John has lined up his N (1 <= N <= 100,000) cows in a row to measure their heights; cow i has height H\\_i (1 <= H\\_i <= 1,000,000,000) nanometers--FJ believes in precise measurements! He wants to take a picture of some contiguous subsequence of the cows to submit to a bovine photography contest at the county fair.\n\nThe fair has a very strange rule about all submitted photos: a photograph is only valid to submit if it depicts a group of cows whose median height is at least a certain threshold X (1 <= X <= 1,000,000,000).\n\nFor purposes of this problem, we define the median of an array A[0...K] to be A[ceiling(K/2)] after A is sorted, where ceiling(K/2) gives K/2 rounded up to the nearest integer (or K/2 itself, it K/2 is an integer to begin with). For example the median of {7, 3, 2, 6} is 6, and the median of {5, 4, 8} is 5.\n\nPlease help FJ count the number of different contiguous subsequences of his cows that he could potentially submit to the photography contest.\n\n给出一串数字，问中位数大于等于X的连续子串有几个。（这里如果有偶数个数，定义为偏大的那一个而非中间取平均）\n", "inputFormat": "\\* Line 1: Two space-separated integers: N and X.\n\n\\* Lines 2..N+1: Line i+1 contains the single integer H\\_i.\n", "outputFormat": "\\* Line 1: The number of subsequences of FJ's cows that have median at least X. Note this may not fit into a 32-bit integer.\n", "hint": "FJ's four cows have heights 10, 5, 6, 2. We want to know how many contiguous subsequences have median at least 6.\n\n\nThere are 10 possible contiguous subsequences to consider. Of these, only 7 have median at least 6. They are {10}, {6}, {10, 5}, {5, 6}, {6, 2}, {10, 5, 6}, {10, 5, 6, 2}.\n", "locale": "zh-CN"}}}
{"pid": "P3032", "type": "P", "difficulty": 5, "samples": [["000000000 \n001000100 \n000000000 \n000110000 \n000111000 \n000000000 \n000000000 \n000000000 \n000000000 \n", "3 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2011", "USACO", "启发式迭代加深搜索 IDA*", "A*  算法", "状压 DP"], "title": "[USACO11NOV] Binary Sudoku G", "background": null, "description": "农夫约翰的奶牛们喜欢玩一款有趣的“数独”变体游戏。这款游戏和标准数独一样，包含一个 $9 \\times 9$ 的网格，且网格被划分为 $3 \\times 3$ 的子网格。不过，奶牛们的版本只使用二进制数字（$0$ 和 $1$）：\n\n```\n000 000 000\n001 000 100\n000 000 000\n000 110 000\n000 111 000\n000 000 000\n000 000 000\n000 000 000\n000 000 000\n```\n\n二进制数独的目标是尽可能少地翻转比特位，使得九行中的每一行、九列中的每一列，以及九个 $3 \\times 3$ 子网格中的每一个都具有偶校验（即包含偶数个 $1$）。对于上面的示例，只需 $3$ 次翻转就能得到一个有效的解：\n\n```\n000 000 000\n001 000 100\n001 000 100\n000 110 000\n000 110 000\n000 000 000\n000 000 000\n000 000 000\n000 000 000\n```\n\n给定二进制数独棋盘的初始状态，请帮助奶牛们确定解决该问题所需的最少翻转次数。\n\n**【简化题意】**\n\n给出一个 $9 \\times 9$ 的 01 矩阵，问最少修改几个数能使每行、每列以及每个九宫格中 $1$ 的个数均为偶数。", "inputFormat": "第 $1$ 至 $9$ 行：每行包含一个 $9$ 位的二进制字符串，对应初始棋盘的一行。", "outputFormat": "第 $1$ 行：一个整数，表示使每一行、每一列和每一个子网格都具有偶校验所需的最少翻转次数。", "hint": "样例输入中的数独棋盘与题目描述中的示例一致。\n\n三次翻转即可解决该谜题。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO11NOV] Binary Sudoku G", "background": "", "description": "Farmer John's cows like to play an interesting variant of the popular game of \"Sudoku\". Their version involves a 9 x 9 grid of 3 x 3 subgrids, just like regular Sudoku. The cows' version, however, uses only binary digits:\n\n000 000 000\n001 000 100\n000 000 000\n000 110 000\n000 111 000\n000 000 000\n000 000 000\n000 000 000\n000 000 000\n\nThe goal of binary Sudoku is to toggle as few bits as possible so that each of the nine rows, each of the nine columns, and each of the nine 3 x 3 subgrids has even parity (i.e., contains an even number of 1s). For the example above, a set of 3 toggles gives a valid solution:\n\n000 000 000\n001 000 100\n001 000 100\n000 110 000\n000 110 000\n000 000 000\n000 000 000\n000 000 000\n000 000 000\n\nGiven the initial state of a binary Sudoku board, please help the cows determine the minimum number of toggles required to solve it. In other words, given a 9 x 9 binary matrix, find the minimum number of entries to flip so that each row, each column, and each 3 x 3 subgrid contains an even number of 1s.", "inputFormat": "* Lines 1..9: Each line contains a 9-digit binary string corresponding to one row of the initial game board.", "outputFormat": "* Line 1: The minimum number of toggles required to make every row, column, and subgrid have even parity.", "hint": "The Sudoku board in the sample input is the same as in the problem text above.\n\nThree toggles suffice to solve the puzzle.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO11NOV] Binary Sudoku G", "background": null, "description": "农夫约翰的奶牛们喜欢玩一款有趣的“数独”变体游戏。这款游戏和标准数独一样，包含一个 $9 \\times 9$ 的网格，且网格被划分为 $3 \\times 3$ 的子网格。不过，奶牛们的版本只使用二进制数字（$0$ 和 $1$）：\n\n```\n000 000 000\n001 000 100\n000 000 000\n000 110 000\n000 111 000\n000 000 000\n000 000 000\n000 000 000\n000 000 000\n```\n\n二进制数独的目标是尽可能少地翻转比特位，使得九行中的每一行、九列中的每一列，以及九个 $3 \\times 3$ 子网格中的每一个都具有偶校验（即包含偶数个 $1$）。对于上面的示例，只需 $3$ 次翻转就能得到一个有效的解：\n\n```\n000 000 000\n001 000 100\n001 000 100\n000 110 000\n000 110 000\n000 000 000\n000 000 000\n000 000 000\n000 000 000\n```\n\n给定二进制数独棋盘的初始状态，请帮助奶牛们确定解决该问题所需的最少翻转次数。\n\n**【简化题意】**\n\n给出一个 $9 \\times 9$ 的 01 矩阵，问最少修改几个数能使每行、每列以及每个九宫格中 $1$ 的个数均为偶数。", "inputFormat": "第 $1$ 至 $9$ 行：每行包含一个 $9$ 位的二进制字符串，对应初始棋盘的一行。", "outputFormat": "第 $1$ 行：一个整数，表示使每一行、每一列和每一个子网格都具有偶校验所需的最少翻转次数。", "hint": "样例输入中的数独棋盘与题目描述中的示例一致。\n\n三次翻转即可解决该谜题。", "locale": "zh-CN"}}}
{"pid": "P3033", "type": "P", "difficulty": 5, "samples": [["3 \n4 5 10 5 \n6 2 6 12 \n8 3 8 5 \n", "2 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "USACO", "二分图"], "title": "[USACO11NOV] Cow Steeplechase G", "background": "", "description": "Farmer John has a brilliant idea for the next great spectator sport: Cow Steeplechase! As everyone knows, regular steeplechase involves a group of horses that race around a course filled with obstacles they must jump over. FJ figures the same contest should work with highly-trained cows, as long as the obstacles are made short enough.\n\nIn order to design his course, FJ makes a diagram of all the $N$ possible obstacles he could potentially build. Each one is represented by a line segment in the 2D plane that is parallel to the horizontal or vertical axis. Obstacle i has distinct endpoints $(X1_i, Y1_i)$ and $(X2_i, Y2_i)$. An example is as follows:\n```none\n   --+-------   \n-----+-----\n  ---+---     |\n     |     |  |\n   --+-----+--+-   |\n     |     |  |  | |\n     |   --+--+--+-+-\n           |  |  | |\n              |\n```\nFJ would like to build as many of these obstacles as possible, subject to the constraint that no two of them intersect. Starting with the diagram above, FJ can build $7$ obstacles:\n```none\n   ----------   \n-----------\n  -------     |\n           |  |\n           |  |    |\n           |  |  | |\n           |  |  | |\n           |  |  | |\n              |\n```\n\nTwo segments are said to intersect if they share any point in common, even an endpoint of one or both of the segments. FJ is certain that no two horizontal segments in the original input diagram will intersect, and that similarly no two vertical segments in the input diagram will intersect.\n\nPlease help FJ determine the maximum number of obstacles he can build.", "inputFormat": "The first line contains $N$.\n\nThe following $N$ lines contain four space-separated integers representing an obstacle: $X1_i$, $Y1_i$, $X2_i$, and $Y2_i$.", "outputFormat": "Output the maximum number of non-crossing segments FJ can choose.", "hint": "**[Sample Explanation]**\n\nThere are three potential obstacles. The first is a horizontal segment connecting $(4, 5)$ to $(10, 5)$; the second and third are vertical segments connecting $(6, 2)$ to $(6, 12)$ and $(8, 3)$ to $(8, 5)$.\n\nThe optimal solution is to choose both vertical segments.\n\n**[Data Range]**\n\nFor $100\\%$ of the data, $1\\le N\\le250,1\\le X1_i,Y1_i,X2_i,Y2_i\\le10^9$.", "locale": "en", "translations": {"en": {"title": "[USACO11NOV] Cow Steeplechase G", "background": "", "description": "Farmer John has a brilliant idea for the next great spectator sport: Cow Steeplechase! As everyone knows, regular steeplechase involves a group of horses that race around a course filled with obstacles they must jump over. FJ figures the same contest should work with highly-trained cows, as long as the obstacles are made short enough.\n\nIn order to design his course, FJ makes a diagram of all the $N$ possible obstacles he could potentially build. Each one is represented by a line segment in the 2D plane that is parallel to the horizontal or vertical axis. Obstacle i has distinct endpoints $(X1_i, Y1_i)$ and $(X2_i, Y2_i)$. An example is as follows:\n```none\n   --+-------   \n-----+-----\n  ---+---     |\n     |     |  |\n   --+-----+--+-   |\n     |     |  |  | |\n     |   --+--+--+-+-\n           |  |  | |\n              |\n```\nFJ would like to build as many of these obstacles as possible, subject to the constraint that no two of them intersect. Starting with the diagram above, FJ can build $7$ obstacles:\n```none\n   ----------   \n-----------\n  -------     |\n           |  |\n           |  |    |\n           |  |  | |\n           |  |  | |\n           |  |  | |\n              |\n```\n\nTwo segments are said to intersect if they share any point in common, even an endpoint of one or both of the segments. FJ is certain that no two horizontal segments in the original input diagram will intersect, and that similarly no two vertical segments in the input diagram will intersect.\n\nPlease help FJ determine the maximum number of obstacles he can build.", "inputFormat": "The first line contains $N$.\n\nThe following $N$ lines contain four space-separated integers representing an obstacle: $X1_i$, $Y1_i$, $X2_i$, and $Y2_i$.", "outputFormat": "Output the maximum number of non-crossing segments FJ can choose.", "hint": "**[Sample Explanation]**\n\nThere are three potential obstacles. The first is a horizontal segment connecting $(4, 5)$ to $(10, 5)$; the second and third are vertical segments connecting $(6, 2)$ to $(6, 12)$ and $(8, 3)$ to $(8, 5)$.\n\nThe optimal solution is to choose both vertical segments.\n\n**[Data Range]**\n\nFor $100\\%$ of the data, $1\\le N\\le250,1\\le X1_i,Y1_i,X2_i,Y2_i\\le10^9$.", "locale": "en"}, "zh-CN": {"title": "[USACO11NOV] Cow Steeplechase G", "background": null, "description": "Farmer John 有个绝妙的主意——举办一场盛大的奶牛跨栏大赛！众所周知，一般的跨栏比赛是让马匹在充满障碍物的赛道上比赛。而 FJ 认为，只要把障碍物做得足够矮，这个比赛同样适用于训练有素的奶牛。\n\n为了设计赛道，FJ 绘制了所有 $N$ 个可能的障碍物摆放的示意图。每个障碍物在二维平面上用一条平行于横轴或纵轴的线段表示。障碍物 $i$ 的端点为 $(X1_i, Y1_i)$ 和 $(X2_i, Y2_i)$。以下是一个示例：\n```none\n   --+-------   \n-----+-----\n  ---+---     |\n     |     |  |\n   --+-----+--+-   |\n     |     |  |  | |\n     |   --+--+--+-+-\n           |  |  | |\n              |\n```\n约翰希望在满足**任意两个障碍物不相交**的条件下尽可能多地建造障碍物。以上图为例，最多可以建造 $7$ 个障碍物：\n```none\n   ----------   \n-----------\n  -------     |\n           |  |\n           |  |    |\n           |  |  | |\n           |  |  | |\n           |  |  | |\n              |\n```\n当两条线段存在任何公共点（包括端点重合）时即视为相交。题目保证初始示意图中任意两条水平线段不会相交，任意两条垂直线段也不会相交。\n\n请帮助 FJ 计算一下他最多能建造多少个障碍物。", "inputFormat": "第 $1$ 行输入一个整数：N。\n\n第 $2\\sim N+1$ 行：第 $i+1$ 行包含四个用空格分隔的整数，表示一个障碍物：$X1_i, Y1_i, X2_i$, 和 $Y2_i$。", "outputFormat": "输出一个数，约翰农夫可以选择的最大不相交线段数量。", "hint": "**【样例解释】**\n\n共有三个潜在的障碍物：第一个是连接 $(4,5)$ 到 $(10,5)$ 的水平线段；第二、三个分别是连接 $(6,2)$ 到 $(6,12)$ 和 $(8,3)$ 到 $(8,5)$ 的垂直线段。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le N\\le250,1\\le X1_i,Y1_i,X2_i,Y2_i\\le10^9$。", "locale": "zh-CN"}}}
{"pid": "P3034", "type": "P", "difficulty": 5, "samples": [["5 \n10 \n20 \n30 \n40 \n50 \n20 \n10 \n30 \n40 \n50 \n30 \n10 \n20 \n40 \n50 \n40 \n10 \n20 \n30 \n50 \n50 \n10 \n20 \n30 \n40 \n", "10 \n20 \n30 \n40 \n50 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "USACO", "排序"], "title": "[USACO11DEC] Cow Photography G/S", "background": "", "description": "The cows are in a particularly mischievous mood today!  All Farmer John wants to do is take a photograph of the cows standing in a line, but they keep moving right before he has a chance to snap the picture.\n\nSpecifically, each of FJ's N (1 <= N <= 20,000) cows has a unique integer ID number.  FJ wants to take a picture of the cows standing in a line in a very specific ordering, represented by the contents of an array A[1...N], where A[j] gives the ID number of the jth cow in the ordering.  He arranges the cows in this order, but just before he can press the button on his camera to snap the picture, a group of zero or more cows (not necessarily a contiguous group) moves to a set of new positions in the lineup.  More precisely, a group of zero or more cows steps away from the line, with the remaining cows shifting over to close the resulting gaps in the lineup.  The cows who stepped away then re-insert themselves at different positions in the lineup (not necessarily at the locations they originally occupied).  Frustrated but not deterred, FJ again arranges his cows according to the ordering in A, but again, right before he can snap a picture, a different group of zero or more cows moves to a set of new positions in the lineup.\n\nThe process above repeats for a total of five photographs before FJ gives up.  Given the contents of each photograph, see if you can reconstruct the original intended ordering A.  Each photograph shows an ordering of the cows that differs from A in that some group of zero or more cows has moved. However, a cow only moves in at most one photograph: if a cow is part of the group that moves in one photograph, she will not actively move in any of the other four photographs (although she could end up at a different index as a consequence of other cows around her moving, of course).\n\nFarmer John居然拍了五张照片，每张表示初始化牛位置的移动后的状态。然后求出FJ这五头牛初始化的样子。\n", "inputFormat": "\\* Line 1: The number of cows, N (1 <= N <= 20,000). \n\n\\* Lines 2..5N+1: The next 5N lines describe five orderings, each one a block of N contiguous lines.  Each line contains the ID of a cow, an integer in the range 0...1,000,000,000.\n", "outputFormat": "\\* Lines 1..N: The intended ordering A, one ID per line. \n\n", "hint": "There are 5 cows, with IDs 10, 20, 30, 40, and 50.  In each of the 5 photos, a different cow moves to the front of the line (at most one cow moves in each photo here, but it is possible in other inputs that multiple cows could move in a particular photo).\n\n\nThe correct original ordering A[1..5] is 10, 20, 30, 40, 50.\n\n", "locale": "en", "translations": {"en": {"title": "[USACO11DEC] Cow Photography G/S", "background": "", "description": "The cows are in a particularly mischievous mood today!  All Farmer John wants to do is take a photograph of the cows standing in a line, but they keep moving right before he has a chance to snap the picture.\n\nSpecifically, each of FJ's N (1 <= N <= 20,000) cows has a unique integer ID number.  FJ wants to take a picture of the cows standing in a line in a very specific ordering, represented by the contents of an array A[1...N], where A[j] gives the ID number of the jth cow in the ordering.  He arranges the cows in this order, but just before he can press the button on his camera to snap the picture, a group of zero or more cows (not necessarily a contiguous group) moves to a set of new positions in the lineup.  More precisely, a group of zero or more cows steps away from the line, with the remaining cows shifting over to close the resulting gaps in the lineup.  The cows who stepped away then re-insert themselves at different positions in the lineup (not necessarily at the locations they originally occupied).  Frustrated but not deterred, FJ again arranges his cows according to the ordering in A, but again, right before he can snap a picture, a different group of zero or more cows moves to a set of new positions in the lineup.\n\nThe process above repeats for a total of five photographs before FJ gives up.  Given the contents of each photograph, see if you can reconstruct the original intended ordering A.  Each photograph shows an ordering of the cows that differs from A in that some group of zero or more cows has moved. However, a cow only moves in at most one photograph: if a cow is part of the group that moves in one photograph, she will not actively move in any of the other four photographs (although she could end up at a different index as a consequence of other cows around her moving, of course).\n\nFarmer John居然拍了五张照片，每张表示初始化牛位置的移动后的状态。然后求出FJ这五头牛初始化的样子。\n", "inputFormat": "\\* Line 1: The number of cows, N (1 <= N <= 20,000). \n\n\\* Lines 2..5N+1: The next 5N lines describe five orderings, each one a block of N contiguous lines.  Each line contains the ID of a cow, an integer in the range 0...1,000,000,000.\n", "outputFormat": "\\* Lines 1..N: The intended ordering A, one ID per line. \n\n", "hint": "There are 5 cows, with IDs 10, 20, 30, 40, and 50.  In each of the 5 photos, a different cow moves to the front of the line (at most one cow moves in each photo here, but it is possible in other inputs that multiple cows could move in a particular photo).\n\n\nThe correct original ordering A[1..5] is 10, 20, 30, 40, 50.\n\n", "locale": "en"}, "zh-CN": {"title": "[USACO11DEC] Cow Photography G/S", "background": "", "description": "今天的奶牛们特别调皮！Farmer John 想做的只是给排成一排的奶牛拍照，但是在他拍下照片之前，奶牛们一直在移动。\n\n具体地说，FJ 有 $N$ 头奶牛（$1 \\leq N \\leq 20\\,000$），每头奶牛都有一个唯一确定的编号。FJ 想要以一个特定的顺序拍下一张奶牛排成一排的照片，这个顺序用数组 $A[1 \\ldots N]$ 表示，其中 $A[i]$ 代表排在 $i$ 位置的奶牛的编号。\n\n他按照这样的顺序将奶牛们排列好，但在他按下快门之前，有些奶牛（可能是零头或任意多头奶牛，位置也不一定连续）将移到一个新的位置。更准确地说，一些奶牛离开队列，剩下的奶牛靠拢，这些离开的奶牛再将自己重新插入到队列中的任意位置（不一定是他们之前的位置）。FJ 感到非常沮丧，他再次按照 $A$ 数组的顺序重新安排了队列。但在他再次按下快门之前，又有一些奶牛移动到了新的位置。\n\n就这样，FJ 拍了五张照片。给出每张照片拍摄的内容（即 FJ 按下快门时奶牛的顺序），请你尝试推算出 FJ 最初为奶牛们排的顺序（即 $A$ 数组）。由于可能有奶牛移动，照片显示的顺序与原来的顺序可能有所不同。但是，一头奶牛最多只会移动一次：即如果一头奶牛在拍其中一张照片时移动了，它在拍其他四张照片的时候都不会移动。当然，由于其他奶牛也在移动，它在不同照片中的顺序并不一定相同。", "inputFormat": "第一行包含一个整数 $N$。\n\n接下来 $5N$ 行，每 $N$ 行描述了一张照片中各奶牛的顺序。每行包含一个奶牛的编号，保证所有编号都是不超过 $1\\,000\\,000\\,000$ 的非负整数。", "outputFormat": "输出 $N$ 行，每行一个整数 $A[i]$，即 FJ 最初为奶牛排好的顺序。\n\n## 样例解释\n\nFJ 拍的五张照片分别为：\n\n- `10 20 30 40 50`\n- `20 10 30 40 50`\n- `30 10 20 40 50`\n- `40 10 20 30 50`\n- `50 10 20 30 40`", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3035", "type": "P", "difficulty": 3, "samples": [["6 12 \n1 \n2 \n11 \n8 \n4 \n12 \n2 \n3 \n4 \n4 \n8 \n9 \n15 \n16 \n17 \n18 \n19 \n19 \n", "9 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2011", "USACO"], "title": "[USACO11DEC] Umbrellas for Cows S", "background": null, "description": "今天是一个雨天！农夫约翰有 $N (1 \\le N \\le 5,000) $ 头奶牛，编号为 $1,2,\\cdots ,N$，它们并不特别喜欢淋湿。奶牛们站在一排没有屋顶的牛棚里，这些牛棚沿着一条数轴排列。牛棚的 $X$ 坐标从 $1$ 到 $M (1 \\le M \\le 10^5)$。牛 $i$ 站在坐标为 $X_i (1 \\le X_i \\le M)$ 的牛棚里。没有两头奶牛挤在同一个牛棚。\n\n为了保护奶牛免受雨淋，农夫约翰想为它们购买雨伞。一把雨伞覆盖的范围从 $X_i$ 到 $X_j (X_i \\le X_j)$ ，其宽度为 $X_j - X_i + 1$。购买宽度为 $W$ 的雨伞需要花费 $C_W (1 <= C_W <= 10^6)$ 元。大雨伞并不一定比小雨伞贵。\n\n请你帮农夫约翰找到购买一组雨伞以保护每头奶牛免受雨淋的最低成本。注意，最优方案中的雨伞集合可能会有一定程度的重叠。", "inputFormat": "第 $1$ 行，是两个用空间分隔的整数：$N$ 和 $M$。\n\n接下来 $N$ 行，每行包含一个整数，第 $i+1$ 行的数表示 $X_i$，为第 $i$ 头奶牛所在的点的坐标值。\n\n接下来 $M$ 行，第 $N+j+1$ 行包含一个整数：$C_j$。", "outputFormat": "仅一行，一个整数，表示最低的成本。", "hint": "样例解释：\n\n共有 $12$ 个牛棚，其中第 $1,2,4,8,11$ 和 $12$ 号牛棚有牛。覆盖一个摊位的伞要花费 $2$，覆盖两个摊位的伞要花费 $3$，以此类推。通过购买一个宽度 $4$ 的伞、一个宽度为 $1$ 的伞和一个宽度为 $2$ 的伞，可以以 $4 + 2 + 3 = 9$ 的成本覆盖所有牛：\n\n| 牛棚  |<  |<  |<  |<  |<  |<  |<  |<  |<  |<  |<  |\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|U |< |< |< |  |  |  |U |  |  |U |< |\n|C |C |  |C |  |  |  |C |  |  |C |C |\n|1 |2 |3 |4 |5 |6 |7 |8 |9 |10|11|12|\n\n\n\n其中 $C$ 代表一头牛，$U$ 代表伞。", "locale": "zh-CN", "translations": {"en": {"title": null, "background": null, "description": "Today is a rainy day!Farmer John's $N (1 \\le N \\le 5,000)$ cows, numbered $1,2,\\cdots ,N$, are not particularly fond of getting wet. The cows are standing in roofless stalls arranged on a number line. The stalls span X-coordinates from $1$ to $M (1 <= M <= 100,000)$. Cow $i$ stands at a stall on coordinate $X_i (1 \\le X_i \\le M)$. No two cows share stalls.\n\nIn order to protect the cows from the rain, Farmer John wants to buy them umbrellas. An umbrella that spans coordinates $X_i$ to $X_j$ $(X_i \\le X_j)$ has a width of $X_j - X_i + 1$. It costs $C_W (1 \\le C_W \\le 1,000,000)$ to buy an umbrella of width $W$.  Larger umbrellas do not necessarily cost more than smaller umbrellas.\n\nHelp Farmer John find the minimum cost it takes to purchase a set of umbrellas that will protect every cow from the rain.  Note that the set of umbrellas in an optimal solution might overlap to some extent.", "inputFormat": "- Line $1$: Two space-separated integers: $N$ and $M$.\n\n- Lines $2$ to $N+1$: Line $i+1$ contains a single integer: $X_i$.\n\n- Lines $N+2$ to $N+M+1$: Line $N+j+1$ contains a single integer: $C_j$.", "outputFormat": "- Line 1: A single integer that is the minimum cost needed to purchase umbrellas for all the cows.", "hint": "There are $12$ stalls, and stalls $1, 2, 4, 8, 11$ and $12$ contain cows. An umbrella covering one stall costs $2$, an umbrella covering two stalls costs $3$, and so on.\n\n\nBy purchasing a size $4$ umbrella, a size $1$ umbrella, and a size $2$ umbrella, it is possible to cover all the cows at a cost of $4+2+3=9$:\n\n```plain\nUUUUUUUUUU           U        UUUU\n\nC  C     C           C        C  C\n\n|--|--|--|--|--|--|--|--|--|--|--| \n1  2  3  4  5  6  7  8  9  10 11 12\n```\n\nC represents a cow and U represents a part of an umbrella.", "locale": "en"}, "zh-CN": {"title": "[USACO11DEC] Umbrellas for Cows S", "background": null, "description": "今天是一个雨天！农夫约翰有 $N (1 \\le N \\le 5,000) $ 头奶牛，编号为 $1,2,\\cdots ,N$，它们并不特别喜欢淋湿。奶牛们站在一排没有屋顶的牛棚里，这些牛棚沿着一条数轴排列。牛棚的 $X$ 坐标从 $1$ 到 $M (1 \\le M \\le 10^5)$。牛 $i$ 站在坐标为 $X_i (1 \\le X_i \\le M)$ 的牛棚里。没有两头奶牛挤在同一个牛棚。\n\n为了保护奶牛免受雨淋，农夫约翰想为它们购买雨伞。一把雨伞覆盖的范围从 $X_i$ 到 $X_j (X_i \\le X_j)$ ，其宽度为 $X_j - X_i + 1$。购买宽度为 $W$ 的雨伞需要花费 $C_W (1 <= C_W <= 10^6)$ 元。大雨伞并不一定比小雨伞贵。\n\n请你帮农夫约翰找到购买一组雨伞以保护每头奶牛免受雨淋的最低成本。注意，最优方案中的雨伞集合可能会有一定程度的重叠。", "inputFormat": "第 $1$ 行，是两个用空间分隔的整数：$N$ 和 $M$。\n\n接下来 $N$ 行，每行包含一个整数，第 $i+1$ 行的数表示 $X_i$，为第 $i$ 头奶牛所在的点的坐标值。\n\n接下来 $M$ 行，第 $N+j+1$ 行包含一个整数：$C_j$。", "outputFormat": "仅一行，一个整数，表示最低的成本。", "hint": "样例解释：\n\n共有 $12$ 个牛棚，其中第 $1,2,4,8,11$ 和 $12$ 号牛棚有牛。覆盖一个摊位的伞要花费 $2$，覆盖两个摊位的伞要花费 $3$，以此类推。通过购买一个宽度 $4$ 的伞、一个宽度为 $1$ 的伞和一个宽度为 $2$ 的伞，可以以 $4 + 2 + 3 = 9$ 的成本覆盖所有牛：\n\n| 牛棚  |<  |<  |<  |<  |<  |<  |<  |<  |<  |<  |<  |\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|U |< |< |< |  |  |  |U |  |  |U |< |\n|C |C |  |C |  |  |  |C |  |  |C |C |\n|1 |2 |3 |4 |5 |6 |7 |8 |9 |10|11|12|\n\n\n\n其中 $C$ 代表一头牛，$U$ 代表伞。", "locale": "zh-CN"}}}
{"pid": "P3036", "type": "P", "difficulty": 5, "samples": [["4 0 0 7 2\n3 2\n0 2\n1 6\n3 0", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2016", "USACO", "图论建模", "最短路"], "title": "[USACO16DEC] Lasers and Mirrors G", "background": "", "description": "For some reason, Farmer John's cows always seem to be running laser light shows.\n\nFor their latest show, the cows have procured a large powerful laser -- so large,in fact, that they cannot seem to move it easily from the location where it was delivered. They would like to somehow send the light from the laser to the barn on the other side of FJ's property.  Both the laser and the barn can be considered to be located at points in the 2D plane on a map of FJ's farm.  The cows plan to point the laser so that it sends a beam of light out either horizontally or vertically (i.e.,  aligned with the x or y axes).  They will then bounce this beam off a number of mirrors to direct it to the barn.\n\nOn the farm there are $N$ fence posts ($1 \\leq N \\leq 100,000$) located at distinct 2D points (also distinct from the laser and the barn) at which the cows can mount mirrors.  The cows can choose not to mount a mirror on a fence post, in which case the laser would simply pass straight over the top of the post without changing direction.  If the cows do mount a mirror on a fence post, they align it diagonally like / or \\ so that it will re-direct a horizontal beam of light in a vertical direction or vice versa.\n\nPlease compute the minimum possible number of mirrors the cows need to use in order to re-direct the laser to the barn.\n", "inputFormat": "The first line of input contains 5 space-separated integers: $N, x_L, y_L, x_B, y_B$, where $(x_L, y_L)$ is the location of the laser and $(x_B, y_B)$ is the location of the barn.  All coordinates are between $0$ and $1,000,000,000$.\n\nThe next $N$ lines each contain the $x$ and $y$ locations of a fence post, both integers in the range $0 \\ldots 1,000,000,000$.", "outputFormat": "Please output the minimum number of mirrors needed to direct the laser to the barn, or -1 if this is impossible to do.", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO16DEC] Lasers and Mirrors G", "background": "", "description": "For some reason, Farmer John's cows always seem to be running laser light shows.\n\nFor their latest show, the cows have procured a large powerful laser -- so large,in fact, that they cannot seem to move it easily from the location where it was delivered. They would like to somehow send the light from the laser to the barn on the other side of FJ's property.  Both the laser and the barn can be considered to be located at points in the 2D plane on a map of FJ's farm.  The cows plan to point the laser so that it sends a beam of light out either horizontally or vertically (i.e.,  aligned with the x or y axes).  They will then bounce this beam off a number of mirrors to direct it to the barn.\n\nOn the farm there are $N$ fence posts ($1 \\leq N \\leq 100,000$) located at distinct 2D points (also distinct from the laser and the barn) at which the cows can mount mirrors.  The cows can choose not to mount a mirror on a fence post, in which case the laser would simply pass straight over the top of the post without changing direction.  If the cows do mount a mirror on a fence post, they align it diagonally like / or \\ so that it will re-direct a horizontal beam of light in a vertical direction or vice versa.\n\nPlease compute the minimum possible number of mirrors the cows need to use in order to re-direct the laser to the barn.\n", "inputFormat": "The first line of input contains 5 space-separated integers: $N, x_L, y_L, x_B, y_B$, where $(x_L, y_L)$ is the location of the laser and $(x_B, y_B)$ is the location of the barn.  All coordinates are between $0$ and $1,000,000,000$.\n\nThe next $N$ lines each contain the $x$ and $y$ locations of a fence post, both integers in the range $0 \\ldots 1,000,000,000$.", "outputFormat": "Please output the minimum number of mirrors needed to direct the laser to the barn, or -1 if this is impossible to do.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO16DEC] Lasers and Mirrors G", "background": "", "description": "出于某种原因，Farmer John 的奶牛似乎总是在举办激光表演。\n\n在它们的最新表演中，奶牛们获得了一台大型强力激光器——事实上，这台激光器太大，以至于它们无法轻易从交付地点移动它。它们希望以某种方式将激光器的光束发送到 Farmer John 的农场另一边的谷仓。激光器和谷仓都可以被视为位于 Farmer John 农场地图的二维平面中的点。奶牛们计划将激光器指向水平或垂直方向（即与 $x$ 轴或 $y$ 轴对齐），然后通过多次反射镜将光束引导到谷仓。\n\n农场上有 $N$ 个栅栏柱（$1 \\leq N \\leq 100,000$），位于与激光器和谷仓不同的二维点上，奶牛们可以在这些栅栏柱上安装反射镜。奶牛们可以选择不在栅栏柱上安装反射镜，在这种情况下，激光器会直接穿过栅栏柱而不改变方向。如果奶牛们在栅栏柱上安装反射镜，它们会将其对角线对齐，例如 / 或 \\，以便将水平光束重新定向为垂直方向，反之亦然。\n\n请计算奶牛们将激光器引导到谷仓所需的最少反射镜数量。", "inputFormat": "输入的第一行包含 $5$ 个用空格分隔的整数：$N, x_L, y_L, x_B, y_B$，其中 $(x_L, y_L)$ 是激光器的位置，$(x_B, y_B)$ 是谷仓的位置。所有坐标都在 $0$ 到 $1,000,000,000$ 之间。\n\n接下来的 $N$ 行每行包含一个栅栏柱的 $x$ 和 $y$ 位置，这两个整数都在 $0 \\ldots 1,000,000,000$ 范围内。", "outputFormat": "请输出将激光器引导到谷仓所需的最少反射镜数量，如果无法实现，则输出 -1。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3037", "type": "P", "difficulty": 6, "samples": [["4 5 \n1 2 1 \n3 4 1 \n1 3 2 \n1 4 2 \n2 3 2 \n", "4 3 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["图论", "2011", "USACO", "生成树"], "title": "[USACO11DEC] Simplifying the Farm G", "background": null, "description": "农夫约翰在一所夜校学习算法课程，他刚刚学会了最小生成树。现在约翰意识到他的农场设计得不够高效，他想简化农场的布局。\n约翰的农场可以看做一个图，农田代表图中顶点，田间小路代表图中的边，每条边有一定的长度。约翰注意到，农场中最多有三条小路有着相同的长度。约翰想删除一些小路使得农场成为一棵树，使得两块农田间只有一条路径。但是约翰想把农场设计成最小生成树，也就是农场道路的总长度最短。\n请帮助约翰找出最小生成树的总长度，同时请计算出总共有多少种最小生成树？", "inputFormat": "第 $1$ 行：两个整数 $N$ 和 $M(1 \\le N \\le 4\\times 10^4; 1 \\le M \\le 10^5)$，分别表示农场图中顶点和边的数量。顶点编号为 $1 \\sim N$。\n第 $2$ 行到第 $M+1$ 行：每行三个整数 $a_i, b_i$ 和 $n_i(1 \\le a_i, b_i \\le N; 1 \\le n_i \\le 10^6)$，表示一条从顶点 $a_i$ 到顶点 $b_i$、长度为 $n_i$ 的边。任何边长度值 $n_i$ 最多出现三次。", "outputFormat": "第 $1$ 行：输出两个整数，分别表示最小生成树的总边长度和不同最小生成树的数量（结果对 $10^9+7$ 取模）。", "hint": "样例解释：\n\n选择两条长度为 $1$ 的边和任意一条长度为 $2$ 的边，就能得到总长度为 $4$ 的最小生成树。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO11DEC] Simplifying the Farm G", "background": null, "description": "Farmer John has been taking an evening algorithms course at his local university, and he has just learned about minimum spanning trees.  However, Farmer John now realizes that the design of his farm is not as efficient as it could be, and he wants to simplify the layout of his farm.\n\nThe farm is currently arranged like a graph, with vertices representing fields and edges representing pathways between these fields, each having an associated length.  Farmer John notes that for each distinct length, at most three pathways on his farm share this length.  FJ would like to remove some of the pathways on his farm so that it becomes a tree -- that is, so that there is one unique route between any pair of fields.  Moreover, Farmer John would like this to be a minimum spanning tree -- a tree having the smallest possible sum of edge lengths.\n\nHelp Farmer John compute not only the sum of edge lengths in a minimum spanning tree derived from his farm graph, but also the number of different possible minimum spanning trees he can create.", "inputFormat": "Line $1$: Two integers $N$ and $M (1 \\le N \\le 4\\times 10^4; 1 \\le M \\le 10^5)$, representing  the number of vertices and edges in the farm graph, respectively.  Vertices are numbered as $1 \\ldots N$.\n\nLines $2 \\ldots M+1$: Three integers $a_i$, $b_i$ and $n\\_i$ $(1 \\le a_i, b_i \\le N; 1 \\le n_i \\le 10^6)$  representing an edge from vertex $a_i$ to $b_i$ with length $n_i$.  No edge length $n_i$ will occur more than three times.", "outputFormat": "Line $1$: Two integers representing the length of the minimal spanning tree and the number of minimal spanning trees (mod $10^9+7$).", "hint": "Picking both edges with length $1$ and any edge with length $2$ yields a minimum spanning tree of length $4$.", "locale": "en"}, "zh-CN": {"title": "[USACO11DEC] Simplifying the Farm G", "background": null, "description": "农夫约翰在一所夜校学习算法课程，他刚刚学会了最小生成树。现在约翰意识到他的农场设计得不够高效，他想简化农场的布局。\n约翰的农场可以看做一个图，农田代表图中顶点，田间小路代表图中的边，每条边有一定的长度。约翰注意到，农场中最多有三条小路有着相同的长度。约翰想删除一些小路使得农场成为一棵树，使得两块农田间只有一条路径。但是约翰想把农场设计成最小生成树，也就是农场道路的总长度最短。\n请帮助约翰找出最小生成树的总长度，同时请计算出总共有多少种最小生成树？", "inputFormat": "第 $1$ 行：两个整数 $N$ 和 $M(1 \\le N \\le 4\\times 10^4; 1 \\le M \\le 10^5)$，分别表示农场图中顶点和边的数量。顶点编号为 $1 \\sim N$。\n第 $2$ 行到第 $M+1$ 行：每行三个整数 $a_i, b_i$ 和 $n_i(1 \\le a_i, b_i \\le N; 1 \\le n_i \\le 10^6)$，表示一条从顶点 $a_i$ 到顶点 $b_i$、长度为 $n_i$ 的边。任何边长度值 $n_i$ 最多出现三次。", "outputFormat": "第 $1$ 行：输出两个整数，分别表示最小生成树的总边长度和不同最小生成树的数量（结果对 $10^9+7$ 取模）。", "hint": "样例解释：\n\n选择两条长度为 $1$ 的边和任意一条长度为 $2$ 的边，就能得到总长度为 $4$ 的最小生成树。", "locale": "zh-CN"}}}
{"pid": "P3038", "type": "P", "difficulty": 5, "samples": [["4 6 \n1 4 \n2 4 \n3 4 \nP 2 3 \nP 1 3 \nQ 3 4 \nP 1 4 \nQ 2 4 \nQ 1 4 \n", "2 \n1 \n2 \n\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "线段树", "USACO", "树链剖分"], "title": "[USACO11DEC] Grass Planting G", "background": "", "description": "Farmer John has N barren pastures (2 <= N <= 100,000) connected by N-1 bidirectional roads, such that there is exactly one path between any two pastures.  Bessie, a cow who loves her grazing time, often complains about how there is no grass on the roads between pastures.  Farmer John loves Bessie very much, and today he is finally going to plant grass on the roads.  He will do so using a procedure consisting of M steps (1 <= M <= 100,000).\n\nAt each step one of two things will happen:\n\n- FJ will choose two pastures, and plant a patch of grass along each road in between the two pastures, or,\n\n- Bessie will ask about how many patches of grass on a particular road, and Farmer John must answer her question.\n\nFarmer John is a very poor counter -- help him answer Bessie's questions!\n", "inputFormat": "\\* Line 1: Two space-separated integers N and M\n\n\\* Lines 2..N: Two space-separated integers describing the endpoints of a road.\n\n\\* Lines N+1..N+M: Line i+1 describes step i. The first character of the line is either P or Q, which describes whether or not FJ is planting grass or simply querying. This is followed by two space-separated integers A\\_i and B\\_i (1 <= A\\_i, B\\_i <= N) which describe FJ's action or query.\n", "outputFormat": "\\* Lines 1..???: Each line has the answer to a query, appearing in the same order as the queries appear in the input.\n", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO11DEC] Grass Planting G", "background": "", "description": "Farmer John has N barren pastures (2 <= N <= 100,000) connected by N-1 bidirectional roads, such that there is exactly one path between any two pastures.  Bessie, a cow who loves her grazing time, often complains about how there is no grass on the roads between pastures.  Farmer John loves Bessie very much, and today he is finally going to plant grass on the roads.  He will do so using a procedure consisting of M steps (1 <= M <= 100,000).\n\nAt each step one of two things will happen:\n\n- FJ will choose two pastures, and plant a patch of grass along each road in between the two pastures, or,\n\n- Bessie will ask about how many patches of grass on a particular road, and Farmer John must answer her question.\n\nFarmer John is a very poor counter -- help him answer Bessie's questions!\n", "inputFormat": "\\* Line 1: Two space-separated integers N and M\n\n\\* Lines 2..N: Two space-separated integers describing the endpoints of a road.\n\n\\* Lines N+1..N+M: Line i+1 describes step i. The first character of the line is either P or Q, which describes whether or not FJ is planting grass or simply querying. This is followed by two space-separated integers A\\_i and B\\_i (1 <= A\\_i, B\\_i <= N) which describe FJ's action or query.\n", "outputFormat": "\\* Lines 1..???: Each line has the answer to a query, appearing in the same order as the queries appear in the input.\n", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO11DEC] Grass Planting G", "background": null, "description": "给出一棵有 $n$ 个节点的树，有 $m$ 个如下所示的操作：\n\n- 将两个节点之间的**路径上的边**的权值均加一。\n\n- 查询两个节点之间的**那一条边**的权值，保证两个节点直接相连。\n\n初始边权均为 $0$。", "inputFormat": "第一行两个整数 $n,m$，含义如上。\n\n接下来 $n-1$ 行，每行两个整数 $u,v$，表示 $u,v$ 之间有一条边。\n\n接下来 $m$ 行，每行格式为 `op u v`，$op=\\texttt{P}$ 代表第一个操作，$op=\\texttt{Q}$ 代表第二个操作。", "outputFormat": "若干行。对于每个查询操作，输出一行整数，代表查询的答案。", "hint": "对于 $100\\%$ 的数据，$2\\le n\\le 10^5$，$1\\le m\\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P3039", "type": "P", "difficulty": 6, "samples": [["4 \n2 2 \n2 4 \n2 1 \n1 3 \n", "12 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "USACO"], "title": "[USACO12JAN] Delivery Route S", "background": null, "description": "FJ 有 $N\\ (1 \\le N \\le 100)$ 个农场，每个农场具有独立的整数坐标 $(x_i, y_i)\\ (1 \\le x_i,y_i \\le 10^6)$。他需要一个物资配送路线，从第 $1$ 个农场出发，依次经过农场 $1$，农场 $2$，农场 $3$……，最后从农场 $N$ 回到农场 $1$。\n\nFJ 每次只能朝东南西北四个方向行走，每行走一个单位长度需要 $1$ 分钟，除了农场 $1$，其他农场能且仅能到达一次。\n\n请计算 FJ 的最小时间花费。", "inputFormat": "第一行一个正整数 $N$。\n\n下面 $N$ 行，每行两个正整数 $x_i,y_i$。", "outputFormat": "一行一个整数表示答案。", "hint": "样例中的最优方案是 $1 \\to 2 \\to 3 \\to 4 \\to 1$，需要 $12$ 分钟。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO12JAN] Delivery Route S", "background": null, "description": "After several years of record milk production, Farmer John now operates an entire network of N farms (1 <= N <= 100). Farm i is located at position (x_i, y_i) in the 2D plane, distinct from all other farms, with both x_i and y_i being integers.\n\nFJ needs your help planning his daily delivery route to bring supplies to the N farms. Starting from farm 1, he plans to visit the farms sequentially (farm 1, then farm 2, then farm 3, etc.), finally returning to farm 1 after visiting farm N. It tames FJ one minute to make a single step either north, south, east, or west. Furthermore, FJ wants to visit each farm exactly once during his entire journey (except farm 1, which he visits twice of course).\n\nPlease help FJ determine the minimum amount of time it will take him to complete his entire delivery route.", "inputFormat": "* Line 1: The number of farms, N.\n\n* Lines 2..1+N: Line i+1 contains two space-separated integers, x_i and y_i (1 <= x_i, y_i <= 1,000,000).", "outputFormat": "* Line 1: The minimum number of minutes FJ needs to complete his delivery route, or -1 if it is impossible to find a feasible delivery route that visits every farm exactly once (except farm 1).", "hint": "FJ can complete his delivery route in 12 minutes: 2 minutes to go from farm 1 to farm 2, 5 minutes to go from farm 2 to farm 3 (circumventing farm 1), 3 minutes to go from farm 3 to farm 4, and then 2 minutes to return to farm 1.", "locale": "en"}, "zh-CN": {"title": "[USACO12JAN] Delivery Route S", "background": null, "description": "FJ 有 $N\\ (1 \\le N \\le 100)$ 个农场，每个农场具有独立的整数坐标 $(x_i, y_i)\\ (1 \\le x_i,y_i \\le 10^6)$。他需要一个物资配送路线，从第 $1$ 个农场出发，依次经过农场 $1$，农场 $2$，农场 $3$……，最后从农场 $N$ 回到农场 $1$。\n\nFJ 每次只能朝东南西北四个方向行走，每行走一个单位长度需要 $1$ 分钟，除了农场 $1$，其他农场能且仅能到达一次。\n\n请计算 FJ 的最小时间花费。", "inputFormat": "第一行一个正整数 $N$。\n\n下面 $N$ 行，每行两个正整数 $x_i,y_i$。", "outputFormat": "一行一个整数表示答案。", "hint": "样例中的最优方案是 $1 \\to 2 \\to 3 \\to 4 \\to 1$，需要 $12$ 分钟。", "locale": "zh-CN"}}}
{"pid": "P3040", "type": "P", "difficulty": 3, "samples": [["8 \n14 \n2 \n5 \n15 \n8 \n9 \n20 \n4 \n", "26 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "USACO"], "title": "[USACO12JAN] Bale Share S", "background": "", "description": "FJ 有 $n$ 包干草，第 $i$ 干草的重量是 $s_i$，他想尽可能平均地将干草分给三个农场。\n\n他希望分配后的干草重量最大值尽可能地小，比如，$b_1,b_2,b_3$ 是分配后的三个值，假设 $b_1 \\ge b_2 \\ge b_3$，则他希望 $b_1$ 的值尽可能地小。\n\n请计算 $b_1$ 的最小值。\n", "inputFormat": "第一行一个正整数 $n$。  \n接下来 $n$ 行，每行一个正整数表示重量。", "outputFormat": "输出一行一个整数表示答案。", "hint": "【样例解释】  \n一种满足要求的分配方案是：  \n农场 1: $2,9,15$，$b_1 = 26$   \n农场 2: $4,8,14$，$b_2 = 26$   \n农场 3: $5,20$，$b_3 = 25$   \n\n【数据范围】  \n对于 $100\\%$ 的数据，$1\\le n \\le 20$，$1 \\le s_i \\le 100$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO12JAN] Bale Share S", "background": "", "description": "FJ has $n$ hay bales, and the weight of the $i$-th bale is $s_i$. He wants to distribute the hay as evenly as possible among three farms.\n\nHe wants the maximum total weight after distribution to be as small as possible. For example, let $b_1, b_2, b_3$ be the total weights assigned to the three farms after distribution. Assume $b_1 \\ge b_2 \\ge b_3$. He wants the value of $b_1$ to be as small as possible.\n\nPlease compute the minimal possible value of $b_1$.", "inputFormat": "The first line contains a positive integer $n$.  \nEach of the next $n$ lines contains a positive integer representing a weight.", "outputFormat": "Output a single line containing one integer, the answer.", "hint": "[Sample Explanation]  \nOne valid distribution is:  \nFarm 1: $2,9,15$, $b_1 = 26$.  \nFarm 2: $4,8,14$, $b_2 = 26$.  \nFarm 3: $5,20$, $b_3 = 25$.\n\nConstraints  \nFor $100\\%$ of the testdata, $1 \\le n \\le 20$, $1 \\le s_i \\le 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO12JAN] Bale Share S", "background": "", "description": "FJ 有 $n$ 包干草，第 $i$ 干草的重量是 $s_i$，他想尽可能平均地将干草分给三个农场。\n\n他希望分配后的干草重量最大值尽可能地小，比如，$b_1,b_2,b_3$ 是分配后的三个值，假设 $b_1 \\ge b_2 \\ge b_3$，则他希望 $b_1$ 的值尽可能地小。\n\n请计算 $b_1$ 的最小值。\n", "inputFormat": "第一行一个正整数 $n$。  \n接下来 $n$ 行，每行一个正整数表示重量。", "outputFormat": "输出一行一个整数表示答案。", "hint": "【样例解释】  \n一种满足要求的分配方案是：  \n农场 1: $2,9,15$，$b_1 = 26$   \n农场 2: $4,8,14$，$b_2 = 26$   \n农场 3: $5,20$，$b_3 = 25$   \n\n【数据范围】  \n对于 $100\\%$ 的数据，$1\\le n \\le 20$，$1 \\le s_i \\le 100$。", "locale": "zh-CN"}}}
{"pid": "P3041", "type": "P", "difficulty": 6, "samples": [["3 7 \nABA \nCB \nABACB \n", "4 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2012", "USACO", "O2优化", "AC 自动机"], "title": "[USACO12JAN] Video Game G", "background": "", "description": "Bessie 在玩一款游戏，该游戏只有三个技能键 `A`，`B`，`C` 可用，但这些键可用形成 $n$ 种特定的组合技。第 $i$ 个组合技用一个字符串 $s_i$ 表示。\n\nBessie 会输入一个长度为 $k$ 的字符串 $t$，而一个组合技每在 $t$ 中出现一次，Bessie 就会获得一分。$s_i$ 在 $t$ 中出现一次指的是 $s_i$ 是 $t$ 从某个位置起的连续子串。如果 $s_i$ 从 $t$ 的多个位置起都是连续子串，那么算作 $s_i$ 出现了多次。\n\n若 Bessie 输入了恰好 $k$ 个字符，则她最多能获得多少分？", "inputFormat": "输入的第一行是两个整数，分别表示组合技个数 $n$ 和 Bessie 输入的字符数 $k$。\n\n接下来 $n$ 行，每行一个字符串 $s_i$，表示一种组合技。", "outputFormat": "输出一行一个整数表示答案。", "hint": "#### 样例 1 解释\n\nBessie 如果输入 `ABACBCB`，则 `ABA` 出现了一次，`ABACB` 出现了一次，`CB` 出现了两次，共得到 $4$ 分。可以证明这是最优的输入。\n\n#### 数据规模与约定\n\n对于全部的测试点，保证：\n\n- $1 \\leq n \\leq 20$，$1 \\leq k \\leq 10^3$。\n- $1 \\leq |s_i| \\leq 15$。其中 $|s_i|$ 表示字符串 $s_i$ 的长度。\n- $s$ 中只含大写字母 `A`，`B`，`C`。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO12JAN] Video Game G", "background": "", "description": "Bessie is playing a game with only three skill keys `A`, `B`, `C` available, and these keys can form $n$ specific combos. The $i$-th combo is represented by a string $s_i$.\n\nBessie will input a string $t$ of length $k$, and each time a combo appears in $t$, Bessie scores one point. An occurrence of $s_i$ in $t$ means that $s_i$ is a contiguous substring of $t$ starting at some position. If $s_i$ is a contiguous substring starting at multiple positions in $t$, it is counted multiple times.\n\nIf Bessie inputs exactly $k$ characters, what is the maximum score she can get?", "inputFormat": "The first line contains two integers, the number of combos $n$ and the number of characters Bessie inputs $k$.\n\nThen $n$ lines follow, each containing a string $s_i$ representing a combo.", "outputFormat": "Output a single integer representing the answer.", "hint": "Sample 1 Explanation.\n\nIf Bessie inputs `ABACBCB`, then `ABA` appears once, `ABACB` appears once, and `CB` appears twice, for a total of $4$ points. This can be proven optimal.\n\nConstraints\n\nFor all testdata, it is guaranteed that:\n- $1 \\le n \\le 20$, $1 \\le k \\le 10^3$.\n- $1 \\le |s_i| \\le 15$. Here $|s_i|$ denotes the length of string $s_i$.\n- All strings contain only the uppercase letters `A`, `B`, `C`.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO12JAN] Video Game G", "background": "", "description": "Bessie 在玩一款游戏，该游戏只有三个技能键 `A`，`B`，`C` 可用，但这些键可用形成 $n$ 种特定的组合技。第 $i$ 个组合技用一个字符串 $s_i$ 表示。\n\nBessie 会输入一个长度为 $k$ 的字符串 $t$，而一个组合技每在 $t$ 中出现一次，Bessie 就会获得一分。$s_i$ 在 $t$ 中出现一次指的是 $s_i$ 是 $t$ 从某个位置起的连续子串。如果 $s_i$ 从 $t$ 的多个位置起都是连续子串，那么算作 $s_i$ 出现了多次。\n\n若 Bessie 输入了恰好 $k$ 个字符，则她最多能获得多少分？", "inputFormat": "输入的第一行是两个整数，分别表示组合技个数 $n$ 和 Bessie 输入的字符数 $k$。\n\n接下来 $n$ 行，每行一个字符串 $s_i$，表示一种组合技。", "outputFormat": "输出一行一个整数表示答案。", "hint": "#### 样例 1 解释\n\nBessie 如果输入 `ABACBCB`，则 `ABA` 出现了一次，`ABACB` 出现了一次，`CB` 出现了两次，共得到 $4$ 分。可以证明这是最优的输入。\n\n#### 数据规模与约定\n\n对于全部的测试点，保证：\n\n- $1 \\leq n \\leq 20$，$1 \\leq k \\leq 10^3$。\n- $1 \\leq |s_i| \\leq 15$。其中 $|s_i|$ 表示字符串 $s_i$ 的长度。\n- $s$ 中只含大写字母 `A`，`B`，`C`。", "locale": "zh-CN"}}}
{"pid": "P3042", "type": "P", "difficulty": 6, "samples": [["2 2 0 \nTT \n1 0 0 0 0 0 0 1 \n0 1 1 1 0 0 1 0 \n", "TB \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2012", "USACO", "连通块", "队列"], "title": "[USACO12JAN] Cow Run G", "background": "", "description": "Farmer John and Bessie have devised a new exercise game for the cows.  The cows are running on a circular track of length M (2 <= M <= 1,000,000,000) starting from the same position.  The game proceeds in N (1 <= N <= 14) rounds using a deck of 8N cards each with a number X\\_i (0 <= X\\_i < M) written on it.\n\nEach round FJ moves the top 8 cards into a separate pile and selects either the top 4 or bottom 4 cards for Bessie to play with.  Bessie then chooses either the top 2 cards or bottom 2 cards of the 4 cards FJ selected.  After this FJ calls out the number on the top card, X\\_top, and the cows run a distance of R \\* X\\_top, where R is the total distance the cows have run so far.  Bessie then calls out the number on the bottom card, X\\_bottom, and the cows run a distance of X\\_bottom.\n\nFJ is concerned that after the exercise the cows will be too tired to get back to the beginning of the track if they end up too far away.  He believes if the cows end up more than a distance of K (0 <= K <= floor(M/2)) from their starting position they won't be able to get back home.\n\nIt is guaranteed that if FJ plays correctly, he will always be able to ensure the cows can come home, irrespective of the moves made by Bessie! For each round, your task is to determine which half of the cards FJ should choose such that no matter what Bessie does from that point on, FJ can always get the cows home.  Bessie will then make the move provided in the input and you can then continue onto the next round.  Note that even though Bessie's moves are provided to you in the input, you are to specify moves for FJ that would have worked no matter what Bessie chooses (so it is effectively as if FJ does not really know what Bessie will do during her moves).\n", "inputFormat": "\\* Line 1: Three space-separated integers N, M, K\n\n\\* Line 2: A string N characters.  If the ith character is 'T' it means Bessie will select the top 2 cards in the ith round.  Otherwise the ith character will be 'B' to indicate Bessie will select the bottom 2 cards in the ith round.\n\n\\* Lines 3..2+N: Each line contains eight integers representing the 8 cards to be used that round from top to bottom.\n", "outputFormat": "\\* Line 1: A string of N characters where the ith character is 'T' if FJ should choose the top 4 cards or 'B' if FJ should choose the bottom 4 cards in the ith round.  If there are multiple ways to get the cows home, choose the lexicographically first (that is, the string that is alphabetically smallest).\n", "hint": "The cows must end up exactly where they started to be able to come home. Note that FJ is not aware of what choices Bessie is going to make beforehand.  If FJ did know, he could have chosen the bottom half each time.\n", "locale": "en", "translations": {"en": {"title": "[USACO12JAN] Cow Run G", "background": "", "description": "Farmer John and Bessie have devised a new exercise game for the cows.  The cows are running on a circular track of length M (2 <= M <= 1,000,000,000) starting from the same position.  The game proceeds in N (1 <= N <= 14) rounds using a deck of 8N cards each with a number X\\_i (0 <= X\\_i < M) written on it.\n\nEach round FJ moves the top 8 cards into a separate pile and selects either the top 4 or bottom 4 cards for Bessie to play with.  Bessie then chooses either the top 2 cards or bottom 2 cards of the 4 cards FJ selected.  After this FJ calls out the number on the top card, X\\_top, and the cows run a distance of R \\* X\\_top, where R is the total distance the cows have run so far.  Bessie then calls out the number on the bottom card, X\\_bottom, and the cows run a distance of X\\_bottom.\n\nFJ is concerned that after the exercise the cows will be too tired to get back to the beginning of the track if they end up too far away.  He believes if the cows end up more than a distance of K (0 <= K <= floor(M/2)) from their starting position they won't be able to get back home.\n\nIt is guaranteed that if FJ plays correctly, he will always be able to ensure the cows can come home, irrespective of the moves made by Bessie! For each round, your task is to determine which half of the cards FJ should choose such that no matter what Bessie does from that point on, FJ can always get the cows home.  Bessie will then make the move provided in the input and you can then continue onto the next round.  Note that even though Bessie's moves are provided to you in the input, you are to specify moves for FJ that would have worked no matter what Bessie chooses (so it is effectively as if FJ does not really know what Bessie will do during her moves).\n", "inputFormat": "\\* Line 1: Three space-separated integers N, M, K\n\n\\* Line 2: A string N characters.  If the ith character is 'T' it means Bessie will select the top 2 cards in the ith round.  Otherwise the ith character will be 'B' to indicate Bessie will select the bottom 2 cards in the ith round.\n\n\\* Lines 3..2+N: Each line contains eight integers representing the 8 cards to be used that round from top to bottom.\n", "outputFormat": "\\* Line 1: A string of N characters where the ith character is 'T' if FJ should choose the top 4 cards or 'B' if FJ should choose the bottom 4 cards in the ith round.  If there are multiple ways to get the cows home, choose the lexicographically first (that is, the string that is alphabetically smallest).\n", "hint": "The cows must end up exactly where they started to be able to come home. Note that FJ is not aware of what choices Bessie is going to make beforehand.  If FJ did know, he could have chosen the bottom half each time.\n", "locale": "en"}, "zh-CN": {"title": "[USACO12JAN] Cow Run G", "background": "", "description": "农夫 John 和 Bessie 为奶牛们设计了一种新的运动游戏。奶牛们从同一位置开始，在一个长度为 $M$ 的圆形跑道上奔跑，其中 $2 \\leq M \\leq 1,000,000,000$。游戏进行 $N$ 轮（$1 \\leq N \\leq 14$），使用一副 $8N$ 张的牌，每张牌上写有一个数字 $X_i$，其中 $0 \\leq X_i < M$。\n\n每一轮，FJ 将顶部的 8 张牌移到一个单独的牌堆中，并选择顶部 4 张或底部 4 张牌供 Bessie 使用。然后 Bessie 从 FJ 选择的 4 张牌中选择顶部 2 张或底部 2 张牌。之后，FJ 报出顶部牌上的数字 $X_{\\text{top}}$，奶牛们跑 $R \\times X_{\\text{top}}$ 的距离，其中 $R$ 是奶牛们到目前为止跑过的总距离。接着 Bessie 报出底部牌上的数字 $X_{\\text{bottom}}$，奶牛们再跑 $X_{\\text{bottom}}$ 的距离。\n\nFJ 担心在运动后，奶牛们会太累而无法回到跑道的起点，如果它们离起点的距离超过 $K$，它们就无法回家，其中 $0 \\leq K \\leq \\lfloor \\frac{M}{2} \\rfloor$。\n\n可以保证，如果 FJ 正确地进行游戏，他总能确保奶牛们能够回家，无论 Bessie 做出什么选择！对于每一轮，你的任务是确定 FJ 应该选择哪一半的牌，以便无论 Bessie **从那时起**做出什么选择，FJ 总能让奶牛们回家。Bessie 将根据输入提供的选择进行移动，然后你可以继续进行下一轮。注意，尽管 Bessie 的选择在输入中提供给你，但你需要为 FJ 指定无论 Bessie 选择什么都能奏效的策略（因此实际上 FJ 并不知道 Bessie 在她的回合中会做什么）。\n", "inputFormat": "\\* 第 1 行：三个用空格分隔的整数 $N$、$M$、$K$。\n\n\\* 第 2 行：一个长度为 $N$ 的字符串。如果第 $i$ 个字符是 'T'，表示 Bessie 在第 $i$ 轮中选择顶部 2 张牌。否则，第 $i$ 个字符将是 'B'，表示 Bessie 选择底部 2 张牌。\n\n\\* 第 3 行到第 $2+N$ 行：每行包含 8 个整数，表示该轮从顶部到底部使用的 8 张牌。\n", "outputFormat": "\\* 第 1 行：一个长度为 $N$ 的字符串，其中第 $i$ 个字符是 'T'，如果 FJ 应该在第 $i$ 轮中选择顶部 4 张牌；如果 FJ 应该选择底部 4 张牌，则为 'B'。如果有多种方法可以让奶牛们回家，选择字典序最小的（即字母顺序最小的字符串）。\n", "hint": "奶牛们必须准确地回到起点才能回家。注意，FJ 事先不知道 Bessie 会做出什么选择。如果 FJ 知道，他每次都可以选择底部一半。\n（由 ChatGPT 4o 翻译）", "locale": "zh-CN"}}}
{"pid": "P3043", "type": "P", "difficulty": 5, "samples": [["5 4 \n1 2 \n3 2 \n4 5 \n4 5 \n", "6 \n"], ["6 5\n1 2\n2 3\n3 4\n1 4\n2 4", "0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2012", "USACO", "连通块"], "title": "[USACO12JAN] Bovine Alliance G", "background": null, "description": "给出 $N$ 个点 $M$ 条边的（没有自环但可能有重边的）无向图，要求给每个点分配 $0$ 条或 $1$ 条与它相邻的边，使得每条边被分配恰好一次，求方案数。答案对 $10^9+7$ 取模。", "inputFormat": "第一行两个正整数 $N,M$，其中 $1 \\le M < N \\le 10^5$。\n\n下面 $M$ 行，每行两个正整数 $u,v$ 表示一条无向边 $(u,v)$，其中 $1 \\le u,v \\le N$。", "outputFormat": "一行一个整数表示答案。", "hint": "样例 $1$ 的 $6$ 种方案如下。\n\n$4$ 个数分别代表第 $1\\sim 4$ 条边被分配给了哪个点：\n\n```plain\n{2, 3, 4, 5} \n{2, 3, 5, 4} \n{1, 3, 4, 5} \n{1, 3, 5, 4} \n{1, 2, 4, 5} \n{1, 2, 5, 4} \n```", "locale": "zh-CN", "translations": {"en": {"title": "[USACO12JAN] Bovine Alliance G", "background": null, "description": "Bessie and her bovine pals from nearby farms have finally decided that they are going to start connecting their farms together by trails in an effort to form an alliance against the farmers. The cows in each of the N (1 <= N <= 100,000) farms were initially instructed to build a trail to exactly one other farm, for a total of N trails. However months into the project only M (1 <= M < N) of these trails had actually been built.\n\nArguments between the farms over which farms already built a trail now threaten to split apart the cow alliance. To ease tension, Bessie wishes to calculate how many ways the M trails that exist so far could have been built. For example, if there is a trail connecting farms 3 and 4, then one possibility is that farm 3 built the trail, and the other possibility is that farm 4 built the trail. Help Bessie by calculating the number of different assignments of trails to the farms that built them, modulo 1,000,000,007. Two assignments are considered different if there is at least one trail built by a different farm in each assignment.", "inputFormat": "* Line 1: Two space-separated integers N and M\n\n* Lines 2..1+M: Line i+1 describes the ith trail. Each line contains two space-separated integers u_i and v_i (1 <= u_i, v_i <= N, u_i != v_i) describing the pair of farms connected by the trail.", "outputFormat": "* Line 1: A single line containing the number of assignments of trails to farms, taken modulo 1,000,000,007. If no assignment satisfies the above conditions output 0.", "hint": "Note that there can be two trails between the same pair of farms.\n\nThere are 6 possible assignments. Letting {a,b,c,d} mean that farm 1 builds trail a, farm 2 builds trail b, farm 3 builds trail c, and farm 4 builds trail d, the assignments are:\n\n```plain\n{2, 3, 4, 5} \n{2, 3, 5, 4} \n{1, 3, 4, 5} \n{1, 3, 5, 4} \n{1, 2, 4, 5} \n{1, 2, 5, 4} \n```", "locale": "en"}, "zh-CN": {"title": "[USACO12JAN] Bovine Alliance G", "background": null, "description": "给出 $N$ 个点 $M$ 条边的（没有自环但可能有重边的）无向图，要求给每个点分配 $0$ 条或 $1$ 条与它相邻的边，使得每条边被分配恰好一次，求方案数。答案对 $10^9+7$ 取模。", "inputFormat": "第一行两个正整数 $N,M$，其中 $1 \\le M < N \\le 10^5$。\n\n下面 $M$ 行，每行两个正整数 $u,v$ 表示一条无向边 $(u,v)$，其中 $1 \\le u,v \\le N$。", "outputFormat": "一行一个整数表示答案。", "hint": "样例 $1$ 的 $6$ 种方案如下。\n\n$4$ 个数分别代表第 $1\\sim 4$ 条边被分配给了哪个点：\n\n```plain\n{2, 3, 4, 5} \n{2, 3, 5, 4} \n{1, 3, 4, 5} \n{1, 3, 5, 4} \n{1, 2, 4, 5} \n{1, 2, 5, 4} \n```", "locale": "zh-CN"}}}
{"pid": "P3044", "type": "P", "difficulty": 5, "samples": [["5 6 3 \n1 \n2 \n3 \n1 2 1 \n1 5 2 \n3 2 3 \n3 4 5 \n4 2 7 \n4 5 10 \n", "12 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "USACO"], "title": "[USACO12FEB] Relocation S", "background": "", "description": "Farmer John is moving!  He is trying to find the best place to build a new farm so as to minimize the amount of travel he needs to do each day.\n\nThe region to which FJ plans to move has N towns (1 <= N <= 10,000).  There are M bi-directional roads (1 <= M <= 50,000) connecting certain pairs of towns.  All towns are reachable from each-other via some combination of roads.  FJ needs your help selecting the best town as the home for his new farm.\n\nThere are markets in K of the towns (1 <= K <= 5) that FJ wants to visit every day.  In particular, every day he plans to leave his new farm, visit the K towns with markets, and then return to his farm.  FJ can visit the markets in any order he wishes.  When selecting a town in which to build his new farm, FJ wants to choose only from the N-K towns that do not have markets, since housing prices are lower in those towns.\n\nPlease help FJ compute the minimum distance he will need to travel during his daily schedule, if he builds his farm in an optimal location and chooses his travel schedule to the markets as smartly as possible.\n\nFJ决定搬家，重新建设农场，以便最小化他每天的行程。\n\n\nFJ搬往的区域有N(1 <= N <= 10,000)个城镇，共有M (1 <= M <= 50,000)条双向道路连接某些城镇，所有城镇都能找到互通路线。\n\n\n有K (1 <= K <= 5)个城镇建有市场，FJ每天离开新农场后，都要光顾这K个城镇，并返回农场。FJ希望建设农场的城镇不包含市场。\n\n\n请帮助FJ选择最佳城镇建设农场，使得他每天的行程最小。\n", "inputFormat": "\\* Line 1: Three space-separated integers, N, M, and K.\n\n\\* Lines 2..1+K: Line i+1 contains an integer in the range 1...N identifying the town containing the ith market.  Each market is in a different town.\n\n\\* Lines 2+K..1+K+M: Each line contains 3 space-separated integers, i, j (1 <= i,j <= N), and L (1 <= L <= 1000), indicating the presence of a road of length L from town i to town j.\n", "outputFormat": "\\* Line 1: The minimum distance FJ needs to travel during his daily routine, if he builds his farm in an optimal location.\n", "hint": "There are 5 towns, with towns 1, 2, and 3 having markets.  There are 6 roads.\n\n\nFJ builds his farm in town 5.  His daily schedule takes him through towns 5-1-2-3-2-1-5, for a total distance of 12.\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO12FEB] Relocation S", "background": "", "description": "Farmer John is moving and wants to build a new farm so that his daily travel distance is minimized.\n\nThe region has $N$ towns ($1 \\le N \\le 10{,}000$). There are $M$ bidirectional roads ($1 \\le M \\le 50{,}000$) connecting certain pairs of towns, and every town is reachable from every other town by some combination of roads. There are markets in $K$ towns ($1 \\le K \\le 5$) that FJ wants to visit every day. Each day, he will leave his new farm, visit all $K$ market towns in any order he chooses, and then return to his farm.\n\nWhen choosing a town for his new farm, FJ will only consider the $N - K$ towns that do not have markets, since housing prices are lower in those towns.\n\nPlease compute the minimum total distance FJ needs to travel in his daily routine if he builds his farm in an optimal town and plans his route to the markets optimally.", "inputFormat": "- Line 1: Three space-separated integers $N$, $M$, and $K$.\n- Lines $2 \\ldots 1+K$: Line $i+1$ contains an integer in the range $1 \\ldots N$ identifying the town containing the $i$-th market. Each market is in a different town.\n- Lines $2+K \\ldots 1+K+M$: Each line contains three space-separated integers $i$, $j$ ($1 \\le i, j \\le N$), and $L$ ($1 \\le L \\le 1000$), indicating a bidirectional road of length $L$ between towns $i$ and $j$.", "outputFormat": "- Line 1: The minimum distance FJ needs to travel during his daily routine, if he builds his farm in an optimal location.", "hint": "There are $5$ towns, with towns $1$, $2$, and $3$ having markets. There are $6$ roads. FJ builds his farm in town $5$. His daily route is $5$-$1$-$2$-$3$-$2$-$1$-$5$, for a total distance of $12$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO12FEB] Relocation S", "background": "", "description": "Farmer John is moving!  He is trying to find the best place to build a new farm so as to minimize the amount of travel he needs to do each day.\n\nThe region to which FJ plans to move has N towns (1 <= N <= 10,000).  There are M bi-directional roads (1 <= M <= 50,000) connecting certain pairs of towns.  All towns are reachable from each-other via some combination of roads.  FJ needs your help selecting the best town as the home for his new farm.\n\nThere are markets in K of the towns (1 <= K <= 5) that FJ wants to visit every day.  In particular, every day he plans to leave his new farm, visit the K towns with markets, and then return to his farm.  FJ can visit the markets in any order he wishes.  When selecting a town in which to build his new farm, FJ wants to choose only from the N-K towns that do not have markets, since housing prices are lower in those towns.\n\nPlease help FJ compute the minimum distance he will need to travel during his daily schedule, if he builds his farm in an optimal location and chooses his travel schedule to the markets as smartly as possible.\n\nFJ决定搬家，重新建设农场，以便最小化他每天的行程。\n\n\nFJ搬往的区域有N(1 <= N <= 10,000)个城镇，共有M (1 <= M <= 50,000)条双向道路连接某些城镇，所有城镇都能找到互通路线。\n\n\n有K (1 <= K <= 5)个城镇建有市场，FJ每天离开新农场后，都要光顾这K个城镇，并返回农场。FJ希望建设农场的城镇不包含市场。\n\n\n请帮助FJ选择最佳城镇建设农场，使得他每天的行程最小。\n", "inputFormat": "\\* Line 1: Three space-separated integers, N, M, and K.\n\n\\* Lines 2..1+K: Line i+1 contains an integer in the range 1...N identifying the town containing the ith market.  Each market is in a different town.\n\n\\* Lines 2+K..1+K+M: Each line contains 3 space-separated integers, i, j (1 <= i,j <= N), and L (1 <= L <= 1000), indicating the presence of a road of length L from town i to town j.\n", "outputFormat": "\\* Line 1: The minimum distance FJ needs to travel during his daily routine, if he builds his farm in an optimal location.\n", "hint": "There are 5 towns, with towns 1, 2, and 3 having markets.  There are 6 roads.\n\n\nFJ builds his farm in town 5.  His daily schedule takes him through towns 5-1-2-3-2-1-5, for a total distance of 12.\n", "locale": "zh-CN"}}}
{"pid": "P3045", "type": "P", "difficulty": 6, "samples": [["4 1 7 \n3 2 \n2 2 \n8 1 \n4 3 \n", "3 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["贪心", "2012", "USACO", "堆", "凸完全单调性（wqs 二分）", "反悔贪心"], "title": "[USACO12FEB] Cow Coupons G", "background": "Subtask 0 为原数据，Subtask 1,2 为 hack 数据。", "description": "FJ 准备买一些新奶牛。市场上有 $N$ 头奶牛，第 $i$ 头奶牛价格为 $P_i$。FJ 有 $K$ 张优惠券，使用优惠券购买第 $i$ 头奶牛时价格会降为 $C_i$，当然每头奶牛只能使用一次优惠券。FJ 想知道花不超过 $M$ 的钱最多可以买多少奶牛？", "inputFormat": "第一行包含三个整数 $N$，$K$ 和 $M$（含义见题目描述），以空格分隔。\n\n接下来 $N$ 行，第 $i+1$ 行包含两个整数 $P_i$ 和 $C_i$，以空格分隔。", "outputFormat": "输出仅一行，包含一个整数，为 FJ 花不超过 $M$ 的钱可以买的奶牛的最大数量。", "hint": "### 样例描述\n\n市场上有 $4$ 头奶牛，FJ 有 $1$ 张优惠券，可以花不超过 $7$ 元钱来买牛。\n\nFJ 使用唯一的 $1$ 张优惠券来买第三头牛，然后原价买入了第一、二头牛，总花费 $3+2+1=6$。\n\n### 数据范围\n\n- $1 \\le K \\le N \\le 5 \\times 10^4$\n- $1 \\le C_i \\le P_i \\le 10^9$\n- $1 \\le M \\le 10^{14}$", "locale": "zh-CN", "translations": {"en": {"title": "", "background": "", "description": "Farmer John needs new cows! There are N cows for sale (1 <= N <= 50,000), and FJ has to spend no more than his budget of M units of money (1 <= M <= 10^14).  Cow i costs P\\_i money (1 <= P\\_i <= 10^9), but FJ has K coupons (1 <= K <= N), and when he uses a coupon on cow i, the cow costs C\\_i instead (1 <= C\\_i <= P\\_i). FJ can only use one coupon per cow, of course.\n\nWhat is the maximum number of cows FJ can afford? ", "inputFormat": "\\* Line 1: Three space-separated integers: N, K, and M.\n\n\\* Lines 2..N+1: Line i+1 contains two integers: P\\_i and C\\_i.\n", "outputFormat": "\\* Line 1: A single integer, the maximum number of cows FJ can afford.\n", "hint": "FJ has 4 cows, 1 coupon, and a budget of 7.\n\n\nFJ uses the coupon on cow 3 and buys cows 1, 2, and 3, for a total cost of 3 + 2 + 1 = 6.\n", "locale": "en"}, "zh-CN": {"title": "[USACO12FEB] Cow Coupons G", "background": "Subtask 0 为原数据，Subtask 1,2 为 hack 数据。", "description": "FJ 准备买一些新奶牛。市场上有 $N$ 头奶牛，第 $i$ 头奶牛价格为 $P_i$。FJ 有 $K$ 张优惠券，使用优惠券购买第 $i$ 头奶牛时价格会降为 $C_i$，当然每头奶牛只能使用一次优惠券。FJ 想知道花不超过 $M$ 的钱最多可以买多少奶牛？", "inputFormat": "第一行包含三个整数 $N$，$K$ 和 $M$（含义见题目描述），以空格分隔。\n\n接下来 $N$ 行，第 $i+1$ 行包含两个整数 $P_i$ 和 $C_i$，以空格分隔。", "outputFormat": "输出仅一行，包含一个整数，为 FJ 花不超过 $M$ 的钱可以买的奶牛的最大数量。", "hint": "### 样例描述\n\n市场上有 $4$ 头奶牛，FJ 有 $1$ 张优惠券，可以花不超过 $7$ 元钱来买牛。\n\nFJ 使用唯一的 $1$ 张优惠券来买第三头牛，然后原价买入了第一、二头牛，总花费 $3+2+1=6$。\n\n### 数据范围\n\n- $1 \\le K \\le N \\le 5 \\times 10^4$\n- $1 \\le C_i \\le P_i \\le 10^9$\n- $1 \\le M \\le 10^{14}$", "locale": "zh-CN"}}}
{"pid": "P3046", "type": "P", "difficulty": 5, "samples": [["4 \n0 0 \n0 1 \n1 0 \n1 1 \n", "4 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "USACO", "离散化", "枚举"], "title": "[USACO12FEB] Symmetry G", "background": "", "description": "After taking a modern art class, Farmer John has become interested in finding geometric patterns in everything around his farm.  He carefully plots the locations of his N cows (2 <= N <= 1000), each one occupying a distinct point in the 2D plane, and he wonders how many different lines of symmetry exist for this set of points.  A line of symmetry, of course, is a line across which the points on both sides are mirror images of each-other.\n\nPlease help FJ answer this most pressing geometric question.\n\n\n", "inputFormat": "\\* Line 1: The single integer N.\n\n\\* Lines 2..1+N: Line i+1 contains two space-separated integers representing the x and y coordinates of the ith cow (-10,000 <= x,y <= 10,000).\n", "outputFormat": "\\* Line 1: The number of different lines of symmetry of the point set.\n", "hint": "The 4 cows form the corners of a square. \n\nThere are 4 lines of symmetry -- one vertical, one horizontal, and two diagonal.\n", "locale": "en", "translations": {"en": {"title": "[USACO12FEB] Symmetry G", "background": "", "description": "After taking a modern art class, Farmer John has become interested in finding geometric patterns in everything around his farm.  He carefully plots the locations of his N cows (2 <= N <= 1000), each one occupying a distinct point in the 2D plane, and he wonders how many different lines of symmetry exist for this set of points.  A line of symmetry, of course, is a line across which the points on both sides are mirror images of each-other.\n\nPlease help FJ answer this most pressing geometric question.\n\n\n", "inputFormat": "\\* Line 1: The single integer N.\n\n\\* Lines 2..1+N: Line i+1 contains two space-separated integers representing the x and y coordinates of the ith cow (-10,000 <= x,y <= 10,000).\n", "outputFormat": "\\* Line 1: The number of different lines of symmetry of the point set.\n", "hint": "The 4 cows form the corners of a square. \n\nThere are 4 lines of symmetry -- one vertical, one horizontal, and two diagonal.\n", "locale": "en"}, "zh-CN": {"title": "[USACO12FEB] Symmetry G", "background": "", "description": "在上了一门现代艺术课后，Farmer John 对在农场周围寻找几何图案产生了兴趣。他仔细地绘制了他的 N 头奶牛的位置（2 <= N <= 1000），每头奶牛占据二维平面中的一个不同的点，他想知道这些点集有多少条不同的对称轴。当然，对称轴是指在这条线上，两侧的点是彼此的镜像。\n\n请帮助 FJ 解答这个最紧迫的几何问题。\n\n\n", "inputFormat": "\\* 第 1 行：一个整数 N。\n\n\\* 第 2 行到第 1+N 行：第 i+1 行包含两个用空格分隔的整数，表示第 i 头奶牛的 x 和 y 坐标 (-10,000 <= x,y <= 10,000)。\n", "outputFormat": "\\* 第 1 行：点集的不同对称轴的数量。\n", "hint": "这 4 头奶牛形成一个正方形的四个角。\n\n有 4 条对称轴——一条垂直的，一条水平的，以及两条对角线。\n（由 ChatGPT 4o 翻译）", "locale": "zh-CN"}}}
{"pid": "P3047", "type": "P", "difficulty": 4, "samples": [["6 2 \n5 1 \n3 6 \n2 4 \n2 1 \n3 2 \n1 \n2 \n3 \n4 \n5 \n6 \n", "15 \n21 \n16 \n10 \n8 \n11 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2012", "USACO", "树形 DP"], "title": "[USACO12FEB] Nearby Cows G", "background": null, "description": "FJ 注意到了他的奶牛经常在附近的田地移动。考虑到这个事情，他想要在每个田地里种足够的草，不仅是为了最初在那块地里的奶牛，也是为了从附近田地来的奶牛。\n\n特别地，FJ 的农场由 $N(1 \\leq N \\leq 100000)$ 个田地组成，某些田地之间由双向道路连接（一共有 $N-1$ 条）。对于田地 $i$，它是 $C_i$ 头奶牛的家，尽管奶牛有时能经过最多 $K$ 条边去到其它田地。\n\nFJ 想在任意一个田地 $i$ 中种足够的草去喂养最大数量的奶牛 $M_i$（最终可能到这块地的奶牛），即仅经过最多 $K(1 \\leq K \\leq 20)$ 条边到达这里的奶牛。给定农场的结构和每一个田地的奶牛数量 $C_i$，请求出对于任意一个 $i$ 求出对应的 $M_i$。", "inputFormat": "第一行两个正整数 $n,k$。\n\n接下来 $n-1$ 行，每行两个正整数 $u,v$，表示 $u,v$ 之间有一条边。\n\n最后 $n$ 行，每行一个非负整数 $C_i$。", "outputFormat": "输出 $n$ 行，第 $i$ 行一个整数表示 $m_i$。", "hint": "【样例解释】  \n有 $6$ 个田地，道路连接了 $(5,1),(3,6),(2,4),(2,1),(3,2)$。第 $i$ 个田地有 $C_i=i$ 头奶牛。有 $M_1=15$ 头奶牛与田地 $1$ 的距离不超过 $2$，等等。\n\n【数据范围】  \n对于 $100\\%$ 的数据：$1 \\le N \\le 10^5$，$1 \\le K \\le 20$，$0 \\le C_i \\le 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "P3047 - [USACO12FEB] Nearby Cows G", "background": null, "description": "Farmer John has noticed that his cows often move between nearby fields. Taking this into account, he wants to plant enough grass in each of his fields not only for the cows situated initially in that field, but also for cows visiting from nearby fields.\n\nSpecifically, FJ's farm consists of $N$ fields $(1 \\leq N \\leq 100,000)$, where some pairs of fields are connected with bi-directional trails ($N-1$ of them in total). FJ has designed the farm so that between any two fields $i$ and $j$, there is a unique path made up of trails connecting between $i$ and $j$. Field $i$ is home to $C_i$ cows, although cows sometimes move to a different field by crossing up to $K$ trails $(1 \\leq K \\leq 20)$.\n\nFJ wants to plant enough grass in each field $i$ to feed the maximum number of cows $M_i$ that could possibly end up in that field -- that is, the number of cows that can potentially reach field $i$ by following at most $K$ trails. Given the structure of FJ's farm and the value of $C_i$ for each field $i$, please help FJ compute $M_i$ for every field $i$.", "inputFormat": "* Line $1$: Two space-separated integers, $N$ and $K$.\n\n* Lines $2$ to $N$: Each line contains two space-separated integers, $i$ and $j$ $(1 \\leq i,j \\leq N)$ indicating that fields $i$ and $j$ are directly connected by a trail.\n\n* Lines $N+1$ to $2N$: Line $N+i$ contains the integer $C_i$. $(0 \\leq C_i \\leq 1000)$", "outputFormat": "* Lines $1$ to $N$: Line $i$ should contain the value of $M_i$.", "hint": "There are $6$ fields, with trails connecting $(5,1)$, $(3,6)$, $(2,4)$, $(2,1)$, and $(3,2)$. Field $i$ has $C_i = i$ cows.\n\nField $1$ has $M_1 = 15$ cows within a distance of $2$ trails, etc.", "locale": "en"}, "zh-CN": {"title": "[USACO12FEB] Nearby Cows G", "background": null, "description": "FJ 注意到了他的奶牛经常在附近的田地移动。考虑到这个事情，他想要在每个田地里种足够的草，不仅是为了最初在那块地里的奶牛，也是为了从附近田地来的奶牛。\n\n特别地，FJ 的农场由 $N(1 \\leq N \\leq 100000)$ 个田地组成，某些田地之间由双向道路连接（一共有 $N-1$ 条）。对于田地 $i$，它是 $C_i$ 头奶牛的家，尽管奶牛有时能经过最多 $K$ 条边去到其它田地。\n\nFJ 想在任意一个田地 $i$ 中种足够的草去喂养最大数量的奶牛 $M_i$（最终可能到这块地的奶牛），即仅经过最多 $K(1 \\leq K \\leq 20)$ 条边到达这里的奶牛。给定农场的结构和每一个田地的奶牛数量 $C_i$，请求出对于任意一个 $i$ 求出对应的 $M_i$。", "inputFormat": "第一行两个正整数 $n,k$。\n\n接下来 $n-1$ 行，每行两个正整数 $u,v$，表示 $u,v$ 之间有一条边。\n\n最后 $n$ 行，每行一个非负整数 $C_i$。", "outputFormat": "输出 $n$ 行，第 $i$ 行一个整数表示 $m_i$。", "hint": "【样例解释】  \n有 $6$ 个田地，道路连接了 $(5,1),(3,6),(2,4),(2,1),(3,2)$。第 $i$ 个田地有 $C_i=i$ 头奶牛。有 $M_1=15$ 头奶牛与田地 $1$ 的距离不超过 $2$，等等。\n\n【数据范围】  \n对于 $100\\%$ 的数据：$1 \\le N \\le 10^5$，$1 \\le K \\le 20$，$0 \\le C_i \\le 1000$。", "locale": "zh-CN"}}}
{"pid": "P3048", "type": "P", "difficulty": 5, "samples": [["7 3 \n", "10110 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "USACO", "组合数学", "位运算"], "title": "[USACO12FEB] Cow IDs S", "background": "", "description": "\nBeing a secret computer geek, Farmer John labels all of his cows with binary numbers. However, he is a bit superstitious, and only labels cows with binary numbers that have exactly K \"1\" bits $(1 \\le K \\le 10)$. The leading bit of each label is always a \"1\" bit, of course. FJ assigns labels in increasing numeric order, starting from the smallest possible valid label -- a K-bit number consisting of all \"1\" bits. Unfortunately, he loses track of his labeling and needs your help: please determine the Nth label he should assign $(1 \\le N \\le 10^7)$.", "inputFormat": "\n* Line $1$: Two space-separated integers, $N$ and $K$.", "outputFormat": "", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO12FEB] Cow IDs S", "background": "", "description": "\nBeing a secret computer geek, Farmer John labels all of his cows with binary numbers. However, he is a bit superstitious, and only labels cows with binary numbers that have exactly K \"1\" bits $(1 \\le K \\le 10)$. The leading bit of each label is always a \"1\" bit, of course. FJ assigns labels in increasing numeric order, starting from the smallest possible valid label -- a K-bit number consisting of all \"1\" bits. Unfortunately, he loses track of his labeling and needs your help: please determine the Nth label he should assign $(1 \\le N \\le 10^7)$.", "inputFormat": "\n* Line $1$: Two space-separated integers, $N$ and $K$.", "outputFormat": "", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO12FEB] Cow IDs S", "background": null, "description": "作为一个神秘的电脑极客，Farmer John 使用二进制数字给他的所有奶牛编号。但是，他有一点儿迷信，因此他只会使用包含 $K$ 个 \"1\" 的二进制数字给奶牛编号。当然，每个编号的前导位始终是 \"1\"。\n\nFJ 从最小的编号，也就是由 $K$ 个 \"1\" 组成的二进制数开始，以递增的顺序给每头奶牛分配编号。非常不幸的是，他忘记了奶牛们的编号。现在，请你帮他确定第 $N$ 个编号。", "inputFormat": "* 第 $1$ 行：两个用空格隔开的整数，$N$ 和 $K$。", "outputFormat": "* 第 $1$ 行：一个二进制数，代表第 $N$ 个二进制编码。", "hint": "对于 $100\\%$ 的数据：\n\n$1 \\le N \\le 10^7$，$1 \\le K \\le 10$。", "locale": "zh-CN"}}}
{"pid": "P3049", "type": "P", "difficulty": 4, "samples": [["4 100 200 1 \n1 4 \n2 3 \n3 2 \n4 0 \n", "210 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "USACO"], "title": "[USACO12MAR] Landscaping S", "background": "*本题与 [2016 年公开赛白金组同名题目](/problem/P2748) 在题意上一致，唯一的差别是数据范围。*", "description": "Farmer John 打算修建一座花园，他需要移动不少泥土。\n\n花园由 $N$ 个花坛组成（$1 \\leq N \\leq 100$），其中花坛 $i$ 包含 $A_i$ 单位的泥土。FJ 希望花坛 $i$ 包含 $B_i$ 单位的泥土，保证 $0 \\leq A_i,B_i \\leq 10$。\n\n为了达到这个目标，他可以做这几件事情：\n\n- 购买一单位的泥土，放在指定的花坛中，费用为 $X$。\n- 从任意一个花坛中移走一单位泥土，费用为 $Y$。\n- 从花坛 $i$ 运送一单位泥土到花坛 $j$，费用为 $Z|i-j|$。\n\n请你帮 FJ 计算移动泥土的最小开销。", "inputFormat": "第一行四个整数 $N,X,Y,Z$（$0 \\leq X,Y,Z \\leq 1000$）。\n\n接下来 $N$ 行，第 $i$ 行两个整数 $A_i,B_i$。", "outputFormat": "输出移动泥土的最小开销。", "hint": "按下面的方案，最小花费为 $210$，可以证明不存在开销更小的方案。\n\n- 移除 $4$ 号花坛的一单位泥土，花费 $200$。\n- 将 $4$ 号花坛的三单位泥土移到 $1$ 号花坛，花费 $3 \\times 3=9$。\n- 将 $3$ 号花坛的一单位泥土移到 $2$ 号花坛，花费 $1 \\times 1=1$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO12MAR] Landscaping S", "background": "*This problem has the same statement as the [problem of the same name in the 2016 Open Contest Platinum](/problem/P2748), with the only difference being the testdata constraints.*", "description": "Farmer John (FJ) plans to build a garden and needs to move quite a bit of soil.\n\nThe garden consists of $N$ flowerbeds ($1 \\leq N \\leq 100$), where flowerbed $i$ contains $A_i$ units of soil. FJ wants flowerbed $i$ to contain $B_i$ units of soil, and it is guaranteed that $0 \\leq A_i, B_i \\leq 10$.\n\nTo achieve this goal, he can do the following:\n\n- Buy one unit of soil and place it in a specified flowerbed, at a cost of $X$.\n- Remove one unit of soil from any flowerbed, at a cost of $Y$.\n- Transport one unit of soil from flowerbed $i$ to flowerbed $j$, at a cost of $Z|i-j|$.\n\nPlease help FJ compute the minimum cost to move the soil.", "inputFormat": "The first line contains four integers $N, X, Y, Z$ ($0 \\leq X, Y, Z \\leq 1000$).\n\nThe next $N$ lines each contain two integers $A_i, B_i$ for the $i$-th line.", "outputFormat": "Output the minimum cost to move the soil.", "hint": "With the following plan, the minimum cost is $210$, and you can prove that no cheaper plan exists.\n\n- Remove one unit of soil from flowerbed $4$, costing $200$.\n- Move three units of soil from flowerbed $4$ to flowerbed $1$, costing $3 \\times 3=9$.\n- Move one unit of soil from flowerbed $3$ to flowerbed $2$, costing $1 \\times 1=1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO12MAR] Landscaping S", "background": "*本题与 [2016 年公开赛白金组同名题目](/problem/P2748) 在题意上一致，唯一的差别是数据范围。*", "description": "Farmer John 打算修建一座花园，他需要移动不少泥土。\n\n花园由 $N$ 个花坛组成（$1 \\leq N \\leq 100$），其中花坛 $i$ 包含 $A_i$ 单位的泥土。FJ 希望花坛 $i$ 包含 $B_i$ 单位的泥土，保证 $0 \\leq A_i,B_i \\leq 10$。\n\n为了达到这个目标，他可以做这几件事情：\n\n- 购买一单位的泥土，放在指定的花坛中，费用为 $X$。\n- 从任意一个花坛中移走一单位泥土，费用为 $Y$。\n- 从花坛 $i$ 运送一单位泥土到花坛 $j$，费用为 $Z|i-j|$。\n\n请你帮 FJ 计算移动泥土的最小开销。", "inputFormat": "第一行四个整数 $N,X,Y,Z$（$0 \\leq X,Y,Z \\leq 1000$）。\n\n接下来 $N$ 行，第 $i$ 行两个整数 $A_i,B_i$。", "outputFormat": "输出移动泥土的最小开销。", "hint": "按下面的方案，最小花费为 $210$，可以证明不存在开销更小的方案。\n\n- 移除 $4$ 号花坛的一单位泥土，花费 $200$。\n- 将 $4$ 号花坛的三单位泥土移到 $1$ 号花坛，花费 $3 \\times 3=9$。\n- 将 $3$ 号花坛的一单位泥土移到 $2$ 号花坛，花费 $1 \\times 1=1$。", "locale": "zh-CN"}}}
{"pid": "P3050", "type": "P", "difficulty": 6, "samples": [["2 2 1 3 100 \n", "28 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "USACO"], "title": "[USACO12MAR] Large Banner G", "background": null, "description": "给定 $M,N,L,H$。求有多少对整点 $A(x_A,y_A),B(x_B,y_B)$ 满足：\n\n* $0\\leq x_A,x_B\\leq M,0\\leq y_A,y_B\\leq N$\n* 线段 $AB$ 上没有其它整点。\n* 线段的长度 $|AB|$ 满足 $L\\leq |AB|\\leq H$。\n\n答案对给定的 $P$ 取模（$P$ 不一定是质数）。", "inputFormat": "一行五个整数 $M,N,L,H,P$。", "outputFormat": "一行一个整数，表示答案对 $P$ 取模的结果。", "hint": "$1\\leq N,M\\leq 10^5,1\\leq L\\leq H\\leq 1.5\\times 10^5,1\\leq P\\leq 10^9.$", "locale": "zh-CN", "translations": {"en": {"title": null, "background": null, "description": "Bessie is returning from a long trip abroad to the Isle of Guernsey, and Farmer John wants to mount a nice \"Welcome Home\" banner for her arrival. Farmer John's field has integer dimensions $M \\times N (1 \\leq M, N \\leq 10^5)$, and he has installed a post at every possible point in the field with integer coordinates (if we assign a coordinate system to the field so that $(0,0)$ is in the lower-left corner and $(M,N)$ is in the upper-right corner). Of these $(M+1) \\times (N+1)$ points, Farmer John must pick two as the endpoints of the banner.\n\nFarmer John, being the perfectionist that he is, insists that the banner must be completely straight. This means that, for the two posts he chooses, there cannot be any other post on the line segment that the banner will form between them. Additionally, Farmer John wants the banner to have length at least $L$ and at most $H (1 \\leq  L \\leq  H \\leq  1.5\\times 10^5)$. Farmer John needs your help to figure out how many possible ways he can hang the banner. The banner is reversible, so switching the two endpoints of the banner counts as the same way to hang the banner. As this number may be very large, Farmer John simply wants to know what it is modulo $B(1\\leq B\\leq 10^9)$.\n\nConsider the example below, with $M = N=2$ :\n\n$$\n\\begin{matrix}\n*&*&*\\\\\n*&*&*\\\\\n*&*&*\\\\\n\\end{matrix}\n$$\n\nFarmer John wants the length of the banner to be between $1$ and $3$ inclusive. Any choice of posts satisfies this length requirement, but note that eight pairs cannot be picked:\n\n$(0, 0)$ and $(2, 0)$: $(1, 0)$ is on the line segment between them\n\n$(0, 1)$ and $(2, 1)$: $(1, 1)$ is on the line segment between them\n\n$(0, 2)$ and $(2, 2)$: $(1, 2)$ is on the line segment between them\n\n$(0, 0)$ and $(2, 2)$: $(1, 1)$ is on the line segment between them\n\n$(0, 0)$ and $(0, 2)$: $(0, 1)$ is on the line segment between them\n\n$(1, 0)$ and $(1, 2)$: $(1, 1)$ is on the line segment between them\n\n$(2, 0)$ and $(2, 2)$: $(2, 1)$ is on the line segment between them\n\n$(0, 2)$ and $(2, 0)$: $(1, 1)$ is on the line segment between them\n\nTherefore, there are a total of $\\binom 9 2-8=28$ possible locations.", "inputFormat": "Line 1: Five space-separated integers: $M, N, L, H\n$ and $B$.", "outputFormat": "Line 1: One integer denoting the number of possible banners (modulo $B$).", "hint": null, "locale": "en"}, "zh-CN": {"title": "[USACO12MAR] Large Banner G", "background": null, "description": "给定 $M,N,L,H$。求有多少对整点 $A(x_A,y_A),B(x_B,y_B)$ 满足：\n\n* $0\\leq x_A,x_B\\leq M,0\\leq y_A,y_B\\leq N$\n* 线段 $AB$ 上没有其它整点。\n* 线段的长度 $|AB|$ 满足 $L\\leq |AB|\\leq H$。\n\n答案对给定的 $P$ 取模（$P$ 不一定是质数）。", "inputFormat": "一行五个整数 $M,N,L,H,P$。", "outputFormat": "一行一个整数，表示答案对 $P$ 取模的结果。", "hint": "$1\\leq N,M\\leq 10^5,1\\leq L\\leq H\\leq 1.5\\times 10^5,1\\leq P\\leq 10^9.$", "locale": "zh-CN"}}}
{"pid": "P3051", "type": "P", "difficulty": 5, "samples": [["4 \n7 1 \n3 4 \n9 2 \n1 13 \n", "13 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "贪心", "2012", "USACO"], "title": "[USACO12MAR] Haybale Restacking G", "background": "", "description": "Farmer John has just ordered a large number of bales of hay.  He would like to organize these into $N$ piles ($1 \\le N \\le 100{,}000$) arranged in a circle, where pile $i$ contains $B_i$ bales of hay. Unfortunately, the truck driver delivering the hay was not listening carefully when Farmer John provided this information, and only remembered to leave the hay in $N$ piles arranged in a circle. After delivery, Farmer John notes that pile $i$ contains $A_i$ bales of hay.  Of course, the $A_i$'s and the $B_i$'s have the same sum.\n\nFarmer John would like to move the bales of hay from their current configuration (described by the $A_i$'s) into his desired target configuration (described by the $B_i$'s).  It takes him $x$ units of work to move one hay bale from one pile to a pile that is $x$ steps away around the circle. Please help him compute the minimum amount of work he will need to spend.", "inputFormat": "* Line $1$: The single integer $N$.\n\n* Lines $2\\cdots1+N$: Line $i+1$ contains the two integers $A_i$ and $B_i$ ($1 \\le A_i, B_i \\le 1000$).", "outputFormat": "", "hint": "There are $4$ piles around a circle.  Initially, the piles contain $7$, $3$, $9$, and $1$ bales of hay. Farmer John would like to move them so the piles contain $1$, $4$, $2$, and $13$ bales of hay.\n\nA minimum of $13$ units of work is required (move $6$ bales from pile $1$ to pile $4$, move $1$ bale from pile $3$ to pile $2$, and move $6$ bales from pile $3$ to pile $4$).", "locale": "en", "translations": {"en": {"title": "[USACO12MAR] Haybale Restacking G", "background": "", "description": "Farmer John has just ordered a large number of bales of hay.  He would like to organize these into $N$ piles ($1 \\le N \\le 100{,}000$) arranged in a circle, where pile $i$ contains $B_i$ bales of hay. Unfortunately, the truck driver delivering the hay was not listening carefully when Farmer John provided this information, and only remembered to leave the hay in $N$ piles arranged in a circle. After delivery, Farmer John notes that pile $i$ contains $A_i$ bales of hay.  Of course, the $A_i$'s and the $B_i$'s have the same sum.\n\nFarmer John would like to move the bales of hay from their current configuration (described by the $A_i$'s) into his desired target configuration (described by the $B_i$'s).  It takes him $x$ units of work to move one hay bale from one pile to a pile that is $x$ steps away around the circle. Please help him compute the minimum amount of work he will need to spend.", "inputFormat": "* Line $1$: The single integer $N$.\n\n* Lines $2\\cdots1+N$: Line $i+1$ contains the two integers $A_i$ and $B_i$ ($1 \\le A_i, B_i \\le 1000$).", "outputFormat": "", "hint": "There are $4$ piles around a circle.  Initially, the piles contain $7$, $3$, $9$, and $1$ bales of hay. Farmer John would like to move them so the piles contain $1$, $4$, $2$, and $13$ bales of hay.\n\nA minimum of $13$ units of work is required (move $6$ bales from pile $1$ to pile $4$, move $1$ bale from pile $3$ to pile $2$, and move $6$ bales from pile $3$ to pile $4$).", "locale": "en"}, "zh-CN": {"title": "[USACO12MAR] Haybale Restacking G", "background": null, "description": "Farmer John 刚订购了大量干草捆。他希望把这些干草分成 $N$ 堆（$1 \\le N \\le 100{,}000$）围成一个圆，其中第 $i$ 堆应包含 $B_i$ 捆干草。不幸的是，运送干草的卡车司机在 John 提供这些信息时没有认真听，只记得把干草分成围成一圈的 $N$ 堆。送达后，John 发现第 $i$ 堆包含 $A_i$ 捆干草。显然，所有 $A_i$ 与所有 $B_i$ 的总和相同。\n\nFarmer John 想把当前的分法（由 $A_i$ 描述）调整为目标分法（由 $B_i$ 描述）。将一捆干草从某一堆搬到沿圆周相距 $x$ 个位置的另一堆需要 $x$ 个单位的工作量。请帮助他计算所需的最小总工作量。", "inputFormat": "第 $1$ 行：一个整数 $N$。\n\n第 $2\\cdots1+N$ 行：第 $i+1$ 行包含两个整数 $A_i$ 和 $B_i$（$1 \\le A_i, B_i \\le 1000$）。", "outputFormat": null, "hint": "圆周上共有 $4$ 堆。初始时，各堆分别包含 $7$、$3$、$9$、$1$ 捆干草。约翰希望将其调整为各堆分别包含 $1$、$4$、$2$、$13$ 捆干草。\n\n所需最小工作量为 $13$（从第 $1$ 堆移动 $6$ 捆到第 $4$ 堆，从第 $3$ 堆移动 $1$ 捆到第 $2$ 堆，从第 $3$ 堆再移动 $6$ 捆到第 $4$ 堆）。", "locale": "zh-CN"}}}
{"pid": "P3052", "type": "P", "difficulty": 2, "samples": [["4 10 \n5 \n6 \n3 \n7 \n", "3 "]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2012", "USACO", "深度优先搜索 DFS", "状压 DP"], "title": "[USACO12MAR] Cows in a Skyscraper G", "background": null, "description": "A little known fact about Bessie and friends is that they love stair climbing races.  A better known fact is that cows really don't like going down stairs.  So after the cows finish racing to the top of their favorite skyscraper, they had a problem.  Refusing to climb back down using the stairs, the cows are forced to use the elevator in order to get back to the ground floor.\n\nThe elevator has a maximum weight capacity of $W$ ($1 <= W <= 100,000,000$) pounds and cow $i$ weighs $C_i$ ($1 <= C_i <= W$) pounds.  Please help Bessie figure out how to get all the N ($1 <= N <= 18$) of the cows to the ground floor using the least number of elevator rides.  The sum of the weights of the cows on each elevator ride must be no larger than W.", "inputFormat": "\\* Line $1$: $N$ and $W$ separated by a space.\n\n\\* Lines $2$ ~ $N+1$: Line $i+1$ contains the integer $C_i$, giving the weight of one of the cows.", "outputFormat": "\\* A single integer, $R$, indicating the minimum number of elevator rides needed.", "hint": "There are four cows weighing 5, 6, 3, and 7 pounds.  The elevator has a maximum weight capacity of 10 pounds.\n\n\nWe can put the cow weighing 3 on the same elevator as any other cow but the other three cows are too heavy to be combined.  For the solution above, elevator ride 1 involves cow #1 and #3, elevator ride 2 involves cow #2, and elevator ride 3 involves cow #4.  Several other solutions are possible for this input.", "locale": "en", "translations": {"en": {"title": "[USACO12MAR] Cows in a Skyscraper G", "background": null, "description": "A little known fact about Bessie and friends is that they love stair climbing races.  A better known fact is that cows really don't like going down stairs.  So after the cows finish racing to the top of their favorite skyscraper, they had a problem.  Refusing to climb back down using the stairs, the cows are forced to use the elevator in order to get back to the ground floor.\n\nThe elevator has a maximum weight capacity of $W$ ($1 <= W <= 100,000,000$) pounds and cow $i$ weighs $C_i$ ($1 <= C_i <= W$) pounds.  Please help Bessie figure out how to get all the N ($1 <= N <= 18$) of the cows to the ground floor using the least number of elevator rides.  The sum of the weights of the cows on each elevator ride must be no larger than W.", "inputFormat": "\\* Line $1$: $N$ and $W$ separated by a space.\n\n\\* Lines $2$ ~ $N+1$: Line $i+1$ contains the integer $C_i$, giving the weight of one of the cows.", "outputFormat": "\\* A single integer, $R$, indicating the minimum number of elevator rides needed.", "hint": "There are four cows weighing 5, 6, 3, and 7 pounds.  The elevator has a maximum weight capacity of 10 pounds.\n\n\nWe can put the cow weighing 3 on the same elevator as any other cow but the other three cows are too heavy to be combined.  For the solution above, elevator ride 1 involves cow #1 and #3, elevator ride 2 involves cow #2, and elevator ride 3 involves cow #4.  Several other solutions are possible for this input.", "locale": "en"}, "zh-CN": {"title": "[USACO12MAR] Cows in a Skyscraper G", "background": null, "description": "一个鲜为人知的事实是，Bessie 和她的朋友们喜欢爬楼梯比赛。一个更为人知的事实是，奶牛们真的不喜欢下楼梯。因此，当奶牛们比赛到达她们最喜欢的摩天大楼的顶层后，她们遇到了一个问题。拒绝使用楼梯下楼，奶牛们被迫使用电梯返回地面层。\n\n电梯的最大载重量为 $W$ 磅 $(1 \\leq W \\leq 100,000,000)$，奶牛 $i$ 的体重为 $C_i$ 磅 $(1 \\leq C_i \\leq W)$。请帮助 Bessie 找出如何用最少的电梯次数将所有 $N$ 头奶牛 $(1 \\leq N \\leq 18)$ 送到地面层。每次电梯的总重量不能超过 $W$。", "inputFormat": "\\* 第 1 行：用空格分隔的 $N$ 和 $W$。\n\n\\* 第 2 行到第 $1+N$ 行：第 $i+1$ 行包含一个整数 $C_i$，表示一头奶牛的体重。", "outputFormat": "\\* 一个整数 $R$，表示所需的最少电梯次数。", "hint": "有四头奶牛，体重分别为 5、6、3 和 7 磅。电梯的最大载重量为 10 磅。\n\n\n我们可以将体重为 3 的奶牛与其他任何一头奶牛放在同一个电梯上，但其他三头奶牛太重，无法组合在一起。对于上述解决方案，电梯行程 1 包括奶牛 #1 和 #3，电梯行程 2 包括奶牛 #2，电梯行程 3 包括奶牛 #4。对于此输入，还有其他几种可能的解决方案。\n（由 ChatGPT 4o 翻译）", "locale": "zh-CN"}}}
{"pid": "P3053", "type": "P", "difficulty": 5, "samples": [["12 3 5 \n0 0 \n1 0 \n2 0 \n3 0 \n3 1 \n0 1 \n0 2 \n0 3 \n0 4 \n1 4 \n2 4 \n3 4 \n2 1 \n2 2 \n1 2 \n2 3 \n3 3 \n4 3 \n4 4 \n4 2 \n", "5 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2012", "USACO", "枚举", "最短路"], "title": "[USACO12OPEN] Unlocking Blocks S", "background": "", "description": "A little-known fact about cows is that they love puzzles! For Bessie's birthday, Farmer John gives her an interesting mechanical puzzle for her to solve.  The puzzle consists of three solid objects, each of which is built from 1x1 unit squares glued together.  Each of these objects is a \"connected\" shape,  in the sense that you can get from one square on the object to any other square on the object by stepping north, south, east, or west, through squares on the object.\n\nAn object can be moved by repeatedly sliding it either north, south, east, or west one unit.  The goal of the puzzle is to move the objects so that they are separated -- where their bounding boxes no longer share any positive overlap with each-other.  Given the shapes and locations of the three objects, your task is to help Bessie decide what is the minimum number of individual slides required to separate the objects.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/flelqdzu.png)\n\n", "inputFormat": "\\* Line 1: Three space-separated integers: N1, N2, and N3, describing respectively the number of unit squares making up objects 1, 2, and 3.\n\n\\* Lines 2..1+N1: Each of these lines describes the (x,y) location of the south-west corner of single square that is part of object 1.  All coordinates lie in the range 0..9.\n\n\\* Lines 2+N1..1+N1+N2: Each of these lines describes the (x,y) location of the south-west corner of single square that is part of object 2.  All coordinates lie in the range 0..9.\n\n\\* Lines 2+N1+N2..1+N1+N2+N3: Each of these lines describes the (x,y) location of the south-west corner of single square that is part of object 3.  All coordinates lie in the range 0..9.\n\n\n第1行：三个整数N1,N2,N3，表示组成模块1,2,3的小正方体数目。\n\n\n第2行到第N1+1行：读入一对坐标（x，y），每对坐标表示组成模块1的一个小正方体西南角落的位置。所有坐标在0..9之间。\n\n\n第N1+2行到第N1+N2+1行：读入一对坐标（x，y），每对坐标表示组成模块2的一个小正方体西南角落的位置。所有坐标在0..9之间。\n\n\n第N1+N2+2行到第N1+N2+N3+…\n", "outputFormat": "\\* Line 1: The minimum number of moves necessary to separate the three objects, or -1 if the objects cannot be separated.\n", "hint": "Object 1 is made from 12 squares, object 2 is made from 3 squares, and object 3 is made from 5 squares.  The shapes of the objects are those in the figure above.\n\n\nIf we slide object 3 to the east by one position, then slide object 2 north by one position, then slide object 1 west by three positions, then the bounding boxes of the three objects will no longer share any overlap in common.\n\n模块1由12块小正方体制造，模块2由3块小正方体制造，模块3由5块小正方体制造。最后的图像在如上。（吃图？！）\n\n```cpp\nA：模块1方块 B：模块2方块 C：模块3方块 *：啥都木有\nA A A A C\nA * C C C\nA B B * C\nA * B A *\nA A A A *\n```\n假如我们把模块3向东移一个单位，然后把模块2向北移一个单位，然后把模块1向西移三个单位，就满足了条件。\n\n感谢 @姚起龙 提供翻译\n", "locale": "en", "translations": {"en": {"title": "[USACO12OPEN] Unlocking Blocks S", "background": "", "description": "A little-known fact about cows is that they love puzzles! For Bessie's birthday, Farmer John gives her an interesting mechanical puzzle for her to solve.  The puzzle consists of three solid objects, each of which is built from 1x1 unit squares glued together.  Each of these objects is a \"connected\" shape,  in the sense that you can get from one square on the object to any other square on the object by stepping north, south, east, or west, through squares on the object.\n\nAn object can be moved by repeatedly sliding it either north, south, east, or west one unit.  The goal of the puzzle is to move the objects so that they are separated -- where their bounding boxes no longer share any positive overlap with each-other.  Given the shapes and locations of the three objects, your task is to help Bessie decide what is the minimum number of individual slides required to separate the objects.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/flelqdzu.png)\n\n", "inputFormat": "\\* Line 1: Three space-separated integers: N1, N2, and N3, describing respectively the number of unit squares making up objects 1, 2, and 3.\n\n\\* Lines 2..1+N1: Each of these lines describes the (x,y) location of the south-west corner of single square that is part of object 1.  All coordinates lie in the range 0..9.\n\n\\* Lines 2+N1..1+N1+N2: Each of these lines describes the (x,y) location of the south-west corner of single square that is part of object 2.  All coordinates lie in the range 0..9.\n\n\\* Lines 2+N1+N2..1+N1+N2+N3: Each of these lines describes the (x,y) location of the south-west corner of single square that is part of object 3.  All coordinates lie in the range 0..9.\n\n\n第1行：三个整数N1,N2,N3，表示组成模块1,2,3的小正方体数目。\n\n\n第2行到第N1+1行：读入一对坐标（x，y），每对坐标表示组成模块1的一个小正方体西南角落的位置。所有坐标在0..9之间。\n\n\n第N1+2行到第N1+N2+1行：读入一对坐标（x，y），每对坐标表示组成模块2的一个小正方体西南角落的位置。所有坐标在0..9之间。\n\n\n第N1+N2+2行到第N1+N2+N3+…\n", "outputFormat": "\\* Line 1: The minimum number of moves necessary to separate the three objects, or -1 if the objects cannot be separated.\n", "hint": "Object 1 is made from 12 squares, object 2 is made from 3 squares, and object 3 is made from 5 squares.  The shapes of the objects are those in the figure above.\n\n\nIf we slide object 3 to the east by one position, then slide object 2 north by one position, then slide object 1 west by three positions, then the bounding boxes of the three objects will no longer share any overlap in common.\n\n模块1由12块小正方体制造，模块2由3块小正方体制造，模块3由5块小正方体制造。最后的图像在如上。（吃图？！）\n\n```cpp\nA：模块1方块 B：模块2方块 C：模块3方块 *：啥都木有\nA A A A C\nA * C C C\nA B B * C\nA * B A *\nA A A A *\n```\n假如我们把模块3向东移一个单位，然后把模块2向北移一个单位，然后把模块1向西移三个单位，就满足了条件。\n\n感谢 @姚起龙 提供翻译\n", "locale": "en"}, "zh-CN": {"title": "[USACO12OPEN] Unlocking Blocks S", "background": "", "description": "一个鲜为人知的事实是，奶牛非常喜欢解谜！为了庆祝贝西的生日，农夫约翰给了她一个有趣的机械谜题让她来解决。这个谜题由三个实心物体组成，每个物体都是由 1x1 的单位正方形粘合在一起构成的。每个物体都是一个「连通」的形状，也就是说，你可以通过在物体上的正方形向北、南、东或西移动，从物体上的一个正方形到达另一个正方形。\n\n一个物体可以通过不断地向北、南、东或西滑动一个单位来移动。谜题的目标是移动这些物体，使它们分开——即它们的边界框不再有任何正重叠。给定三个物体的形状和位置，你的任务是帮助贝西决定分开这些物体所需的最少滑动次数。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/flelqdzu.png)\n\n", "inputFormat": "\\* 第 1 行：三个用空格分隔的整数 $N_1$，$N_2$ 和 $N_3$，分别表示组成物体 1、2 和 3 的单位正方形的数量。\n\n\\* 第 2 行到第 $1+N_1$ 行：每行描述一个 (x,y) 坐标，表示组成物体 1 的一个单位正方形的西南角的位置。所有坐标都在 0 到 9 的范围内。\n\n\\* 第 $2+N_1$ 行到第 $1+N_1+N_2$ 行：每行描述一个 (x,y) 坐标，表示组成物体 2 的一个单位正方形的西南角的位置。所有坐标都在 0 到 9 的范围内。\n\n\\* 第 $2+N_1+N_2$ 行到第 $1+N_1+N_2+N_3$ 行：每行描述一个 (x,y) 坐标，表示组成物体 3 的一个单位正方形的西南角的位置。所有坐标都在 0 到 9 的范围内。\n", "outputFormat": "\\* 第 1 行：分开三个物体所需的最少移动次数，或者如果物体无法分开则输出 -1。\n", "hint": "物体 1 由 12 个正方形组成，物体 2 由 3 个正方形组成，物体 3 由 5 个正方形组成。物体的形状如上图所示。\n\n如果我们将物体 3 向东滑动一个位置，然后将物体 2 向北滑动一个位置，然后将物体 1 向西滑动三个位置，那么三个物体的边界框将不再有任何重叠。\n\n物体 1 由 12 块小正方体制成，物体 2 由 3 块小正方体制成，物体 3 由 5 块小正方体制成。最后的图像如上所示。（吃图？！）\n\n```cpp\nA：物体 1 方块 B：物体 2 方块 C：物体 3 方块 *：什么都没有\nA A A A C\nA * C C C\nA B B * C\nA * B A *\nA A A A *\n```\n假如我们把物体 3 向东移一个单位，然后把物体 2 向北移一个单位，然后把物体 1 向西移三个单位，就满足了条件。\n\n感谢 @姚起龙 提供翻译\n（由 ChatGPT 4o 翻译）", "locale": "zh-CN"}}}
{"pid": "P3054", "type": "P", "difficulty": 4, "samples": [["4 2 100 \n20 \n100 \n70 \n1 \n", "4 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "USACO"], "title": "[USACO12OPEN] Running Laps S", "background": "", "description": "Bored with horse racing, Farmer John decides to investigate the feasibility of cow racing as a sport.  He sets up his N cows (1 <= N <= 100,000) to run a race of L laps around a circular track of length C.  The cows all start at the same point on the track and run at different speeds, with the race ending when the fastest cow has run the total distance of LC.\n\nFJ notices several occurrences of one cow overtaking another, and wonders how many times this sort of \"crossing event\" happens during the entire race.  More specifically, a crossing event is defined by a pair of cows (x,y) and a time t (less than or equal to the ending time of the race), where cow x crosses in front of cow y at time t.  Please help FJ count the total number of crossing events during the entire race.\n\n有n头牛要在长为c的跑道上跑l圈，每头牛有一个速度s\\_i. 某头牛跑完时，所有的牛都停下来，问此之前发生了多少次超越。\n", "inputFormat": "\\* Line 1: Three space-separated integers: N, L, and C.  (1 <= L,C <= 25,000).\n\n\\* Lines 2..1+N: Line i+1 contains the speed of cow i, an integer in the range 1..1,000,000.\n", "outputFormat": "\\* Line 1: The total number of crossing events during the entire race.\n", "hint": "There are 4 cows running 2 laps on a circular track of length 100.  The speeds of the cows are 20, 100, 70, and 1.\n\n\nThe race lasts 2 units of time, since this is the time it takes the fastest cow (cow 2) to finish.  Within that time, there are 4 crossing events: cow 2 overtakes cows 1 and 4, and cow 3 overtakes cows 1 and 4.\n", "locale": "en", "translations": {"en": {"title": "[USACO12OPEN] Running Laps S", "background": "", "description": "Bored with horse racing, Farmer John decides to investigate the feasibility of cow racing as a sport.  He sets up his N cows (1 <= N <= 100,000) to run a race of L laps around a circular track of length C.  The cows all start at the same point on the track and run at different speeds, with the race ending when the fastest cow has run the total distance of LC.\n\nFJ notices several occurrences of one cow overtaking another, and wonders how many times this sort of \"crossing event\" happens during the entire race.  More specifically, a crossing event is defined by a pair of cows (x,y) and a time t (less than or equal to the ending time of the race), where cow x crosses in front of cow y at time t.  Please help FJ count the total number of crossing events during the entire race.\n\n有n头牛要在长为c的跑道上跑l圈，每头牛有一个速度s\\_i. 某头牛跑完时，所有的牛都停下来，问此之前发生了多少次超越。\n", "inputFormat": "\\* Line 1: Three space-separated integers: N, L, and C.  (1 <= L,C <= 25,000).\n\n\\* Lines 2..1+N: Line i+1 contains the speed of cow i, an integer in the range 1..1,000,000.\n", "outputFormat": "\\* Line 1: The total number of crossing events during the entire race.\n", "hint": "There are 4 cows running 2 laps on a circular track of length 100.  The speeds of the cows are 20, 100, 70, and 1.\n\n\nThe race lasts 2 units of time, since this is the time it takes the fastest cow (cow 2) to finish.  Within that time, there are 4 crossing events: cow 2 overtakes cows 1 and 4, and cow 3 overtakes cows 1 and 4.\n", "locale": "en"}, "zh-CN": {"title": "[USACO12OPEN] Running Laps S", "background": null, "description": "农夫约翰让他的 $n$（$1 \\le n \\le 100,000$）头牛在长度为 $c$ 的跑道上进行跑 $l$ 圈的比赛，所有牛从同一起点，以不同的速度开始跑。直到当跑得最快的那一头牛跑完 $l$ 圈时，所有牛才同时停下。\n\n约翰发现在跑圈过程中发生了几次“超越事件”。其定义是：在比赛结束前某时刻，奶牛 $x$ 已经超越了奶牛 $y$ **整整一圈**，则称做一次“超越事件”。（注：**至少一圈**，超越了 $\\frac{1}{2}$ 圈，或者超越了 $\\frac{1}{4}$ 圈等等都不算。且对于同一对奶牛 $(x,y)$ 不会重复计算次数。）\n\n约翰想知道比赛过程中发生了多少次“超越事件”。\n\n（注：可能原文章表达有误或某些其他原因，各种翻译方式过来的题意都有问题，给人误导很大，这里是根据题目数据和样例解释写的正确的题意，而不是原文）", "inputFormat": "第一行：三个整数：$n,l,c$（$1 \\le l,c \\le 25,000$）。\n\n第二行到第 $n+1$ 行：每行一个整数 $v_i$，表示奶牛 $i$ 的速度（$1 \\le v_i \\le 1,000,000$）。", "outputFormat": "第一行：一个整数，表示总共发生的“超越事件”的次数。\n\n感谢@远藤沙椰 提供的翻译", "hint": null, "locale": "zh-CN"}}}
{"pid": "P3055", "type": "P", "difficulty": 5, "samples": [["2 10 6 1 \n2 3 \n2 1 \n6 1 \n2 4 \n1 1 \n2 0 \n3 1 \n1 3 \n5 4 \n3 0 \n0 1 \n3 2 \n6 1 \n \n", "1 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "USACO"], "title": "[USACO12OPEN] Tied Down G", "background": "", "description": "As we all know, Bessie the cow likes nothing more than causing mischief on the farm.  To keep her from causing too much trouble, Farmer John decides to tie Bessie down to a fence with a long rope.  When viewed from above, the fence consists of N posts (1 <= N <= 10) that are arranged along vertical line, with Bessie's position (bx, by) located to the right of this vertical line.  The rope FJ uses to tie down Bessie is described by a sequence of M line segments (3 <= M <= 10,000), where the first segment starts at Bessie's position and the last ends at Bessie's position. No fence post lies on any of these line segments.  However, line segments may cross, and multiple line segments may overlap at their endpoints.\n\nHere is an example of the scene, viewed from above:\n\n![](https://cdn.luogu.com.cn/upload/pic/41461.png)\n\nTo help Bessie escape, the rest of the cows have stolen a saw from the barn.  Please determine the minimum number of fence posts they must cut through and remove in order for Bessie to be able to pull free (meaning she can run away to the right without the rope catching on any of the fence posts). \n\nAll (x,y) coordinates in the input (fence posts, Bessie, and line segment endpoints) lie in the range 0..10,000.  All fence posts have the same x coordinate, and bx is larger than this value. \n\n牛被拴着。平面上有n个柱子，x坐标相等，且都小于牛的x坐标。牛在由m条边形成的闭合多边形组成的绳子上。问最少要锯掉几个柱子牛才能逃脱。\n", "inputFormat": "\\* Line 1: Four space-separated integers: N, M, bx, by.\n\n\\* Lines 2..1+N: Line i+1 contains the space-separated x and y\n\ncoordinates of fence post i.\n\n\\* Lines 2+N..2+N+M: Each of these M+1 lines contains, in sequence, the space-separated x and y coordinates of a point along the rope. The first and last points are always the same as Bessie's location (bx, by).\n", "outputFormat": "\\* Line 1: The minimum number of posts that need to be removed in order for Bessie to escape by running to the right.\n", "hint": "There are two posts at (2,3) and (2,1).  Bessie is at (6,1).  The rope goes from (6,1) to (2,4) to (1,1), and so on, ending finally at (6,1). The shape of the rope is the same as in the figure above.\n\n\nRemoving either post 1 or post 2 will allow Bessie to escape.\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO12OPEN] Tied Down G", "background": "", "description": "As we all know, Bessie the cow likes nothing more than causing mischief on the farm. To keep her from causing too much trouble, Farmer John ties Bessie to a fence with a long rope. Viewed from above, the fence consists of $N$ posts with $1 \\le N \\le 10$, arranged along a vertical line, with Bessie’s position $(b_x, b_y)$ located to the right of this vertical line. The rope that ties Bessie is described by a sequence of $M$ line segments with $3 \\le M \\le 10{,}000$, where the polyline starts and ends at Bessie’s position. No fence post lies on any rope segment. However, segments may cross, and multiple segments may overlap at their endpoints.\n\nHere is an example of the scene, viewed from above:\n![](https://cdn.luogu.com.cn/upload/pic/41461.png)\n\nTo help Bessie escape, the other cows have stolen a saw. Determine the minimum number of fence posts they must cut and remove so that Bessie can pull free, meaning she can run to the right without the rope catching on any fence post.\n\nAll $(x, y)$ coordinates in the input (fence posts, Bessie, and rope endpoints) lie in the range $0 \\ldots 10{,}000$. All fence posts share the same $x$ coordinate, and $b_x$ is larger than this value.", "inputFormat": "- Line 1: Four space-separated integers: $N$, $M$, $b_x$, $b_y$.\n- Lines $2 \\ldots 1+N$: Line $i+1$ contains the space-separated $x$ and $y$ coordinates of fence post $i$.\n- Lines $2+N \\ldots 2+N+M$: Each of these $M+1$ lines gives, in order, the space-separated $x$ and $y$ coordinates of a point along the rope. The first and last points are both Bessie’s location $(b_x, b_y)$.", "outputFormat": "- Line 1: The minimum number of posts that need to be removed for Bessie to escape by running to the right.", "hint": "There are two posts at (2, 3) and (2, 1). Bessie is at (6, 1). The rope goes from (6, 1) to (2, 4) to (1, 1), and so on, finally ending at (6, 1). The shape of the rope is the same as in the figure above.\n\nRemoving either post 1 or post 2 will allow Bessie to escape.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO12OPEN] Tied Down G", "background": "", "description": "As we all know, Bessie the cow likes nothing more than causing mischief on the farm.  To keep her from causing too much trouble, Farmer John decides to tie Bessie down to a fence with a long rope.  When viewed from above, the fence consists of N posts (1 <= N <= 10) that are arranged along vertical line, with Bessie's position (bx, by) located to the right of this vertical line.  The rope FJ uses to tie down Bessie is described by a sequence of M line segments (3 <= M <= 10,000), where the first segment starts at Bessie's position and the last ends at Bessie's position. No fence post lies on any of these line segments.  However, line segments may cross, and multiple line segments may overlap at their endpoints.\n\nHere is an example of the scene, viewed from above:\n\n![](https://cdn.luogu.com.cn/upload/pic/41461.png)\n\nTo help Bessie escape, the rest of the cows have stolen a saw from the barn.  Please determine the minimum number of fence posts they must cut through and remove in order for Bessie to be able to pull free (meaning she can run away to the right without the rope catching on any of the fence posts). \n\nAll (x,y) coordinates in the input (fence posts, Bessie, and line segment endpoints) lie in the range 0..10,000.  All fence posts have the same x coordinate, and bx is larger than this value. \n\n牛被拴着。平面上有n个柱子，x坐标相等，且都小于牛的x坐标。牛在由m条边形成的闭合多边形组成的绳子上。问最少要锯掉几个柱子牛才能逃脱。\n", "inputFormat": "\\* Line 1: Four space-separated integers: N, M, bx, by.\n\n\\* Lines 2..1+N: Line i+1 contains the space-separated x and y\n\ncoordinates of fence post i.\n\n\\* Lines 2+N..2+N+M: Each of these M+1 lines contains, in sequence, the space-separated x and y coordinates of a point along the rope. The first and last points are always the same as Bessie's location (bx, by).\n", "outputFormat": "\\* Line 1: The minimum number of posts that need to be removed in order for Bessie to escape by running to the right.\n", "hint": "There are two posts at (2,3) and (2,1).  Bessie is at (6,1).  The rope goes from (6,1) to (2,4) to (1,1), and so on, ending finally at (6,1). The shape of the rope is the same as in the figure above.\n\n\nRemoving either post 1 or post 2 will allow Bessie to escape.\n", "locale": "zh-CN"}}}
{"pid": "P3056", "type": "P", "difficulty": 2, "samples": [["())( \n", "2 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "贪心", "2012", "USACO", "前缀和", "栈"], "title": "[USACO12NOV] Clumsy Cows S", "background": null, "description": "奶牛 Bessie 正试图在她的新笔记本电脑上输入一个平衡的括号字符串，但由于她的蹄子很大（因此非常笨拙），她不断地输入错误的字符。 请通过计算要使该字符串变为平衡，最少需要反转多少个字符（例如，将左括号变为右括号，或反之）来帮助她。\n\n对于“括号字符串平衡”有几种定义方法。 或许最简单的定义是，字符串中的 `(` 和 `)` 总数必须相同，并且对于字符串的任何前缀，`(` 的数量必须不少于 `)` 的数量。 例如，以下字符串都是平衡的：\n\n`()`\n\n`(())`\n\n`()(()())`\n\n而以下则不平衡：\n\n`)(`\n\n`())(`\n\n`((())))`", "inputFormat": "一个只包含`(`和`)`的字符串，长度为偶数，最多 $100000$ 个字符。", "outputFormat": "一个整数，表示要将该字符串变为平衡字符串，最少需要反转的括号数量。", "hint": "### 样例解释\n\n最后一个括号必须被反转，两个中间的右括号中也必须有一个被反转。", "locale": "zh-CN", "translations": {"en": {"title": null, "background": null, "description": "Bessie the cow is trying to type a balanced string of parentheses into her new laptop, but she is sufficiently clumsy (due to her large hooves) that she keeps mis-typing characters.  Please help her by computing the minimum number of characters in the string that one must reverse (e.g., changing a left parenthesis to a right parenthesis, or vice versa) so that the string would become balanced.\n\nThere are several ways to define what it means for a string of parentheses to be \"balanced\".  Perhaps the simplest definition is that there must be the same total number of `(`s and `)`s, and for any prefix of the string, there must be at least as many `(`s as `)`s.  For example, the following strings are all balanced:\n\n`()`\n\n`(())`\n\n`()(()())`\n\nwhile these are not:\n\n`)(`\n\n`())(`\n\n`((())))`", "inputFormat": "Line 1: A string of parentheses of even length at most $100000$ characters.", "outputFormat": "Line 1: A single integer giving the minimum number of parentheses that must be toggled to convert the string into a balanced string.", "hint": "The last parenthesis must be toggled, and so must one of the two middle right parentheses.", "locale": "en"}, "zh-CN": {"title": "[USACO12NOV] Clumsy Cows S", "background": null, "description": "奶牛 Bessie 正试图在她的新笔记本电脑上输入一个平衡的括号字符串，但由于她的蹄子很大（因此非常笨拙），她不断地输入错误的字符。 请通过计算要使该字符串变为平衡，最少需要反转多少个字符（例如，将左括号变为右括号，或反之）来帮助她。\n\n对于“括号字符串平衡”有几种定义方法。 或许最简单的定义是，字符串中的 `(` 和 `)` 总数必须相同，并且对于字符串的任何前缀，`(` 的数量必须不少于 `)` 的数量。 例如，以下字符串都是平衡的：\n\n`()`\n\n`(())`\n\n`()(()())`\n\n而以下则不平衡：\n\n`)(`\n\n`())(`\n\n`((())))`", "inputFormat": "一个只包含`(`和`)`的字符串，长度为偶数，最多 $100000$ 个字符。", "outputFormat": "一个整数，表示要将该字符串变为平衡字符串，最少需要反转的括号数量。", "hint": "### 样例解释\n\n最后一个括号必须被反转，两个中间的右括号中也必须有一个被反转。", "locale": "zh-CN"}}}
{"pid": "P3057", "type": "P", "difficulty": 4, "samples": [["3 1 2 \n((( \n()( \n(() \n", "5 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "USACO"], "title": "[USACO12NOV] Distant Pastures S", "background": "", "description": "Farmer John's farm is made up of an N x N grid of pastures, where each pasture contains one of two different types of grass.  To specify these two types of grass, we use the characters ( and ), so for example FJ's farm might look like the following grid:\n\n(()) \n)()( \n)((( \n))))\nWhen Bessie the cow travels around the farm, it takes her A units of time to move from a pasture to an adjacent pasture (one step north, south, east, or west) with the same grass type, or B units of time to move to an adjacent pasture with a different grass type.  Whenever Bessie travels from one pasture to a distant pasture, she always uses a sequence of steps that takes the minimum amount of time.  Please compute the greatest amount of time Bessie will ever need to take while traveling between some pair of pastures on the farm.\n\n给出一个n\\*n的括号矩阵，从一个点走到相邻的同字符点需付出A的代价，到不同字符点需付出B的代价。求所有点对之间最短路的最大值。\n", "inputFormat": "\\* Line 1: Three integers: N (1 <= N <= 30), A (0 <= A <= 1,000,000), and B (0 <= B <= 1,000,000).\n\n\\* Lines 1..N+1: Each line contains a string of parentheses of length N.  Collectively, these N lines form an N x N grid of\n\nparentheses.\n", "outputFormat": "\\* Line 1: A single integer specifying the maximum amount of time Bessie can spend traveling between a pair of pastures (given that she always follows a route that takes a minimum amount of time).\n", "hint": "It takes Bessie 5 units of time to travel between the upper-left corner and the lower-right corner of the grid.  No other pair of pastures causes her to travel for more time than this.\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO12NOV] Distant Pastures S", "background": "", "description": "Farmer John's farm is made up of an $N \\times N$ grid of pastures, where each pasture contains one of two different types of grass. To specify these two types of grass, we use the characters ( and ), so for example FJ's farm might look like the following grid:\n(())\n)()(\n)((( \n))))\nWhen Bessie the cow travels around the farm, it takes her $A$ units of time to move from a pasture to an adjacent pasture (one step north, south, east, or west) with the same grass type, or $B$ units of time to move to an adjacent pasture with a different grass type. Whenever Bessie travels from one pasture to a distant pasture, she always uses a sequence of steps that takes the minimum amount of time. Please compute the greatest amount of time Bessie will ever need to take while traveling between some pair of pastures on the farm.", "inputFormat": "- Line 1: Three integers: $N$ ($1 \\le N \\le 30$), $A$ ($0 \\le A \\le 1{,}000{,}000$), and $B$ ($0 \\le B \\le 1{,}000{,}000$).\n- Lines 2..$N+1$: Each of the next $N$ lines contains a string of parentheses of length $N$. Together, these $N$ lines form an $N \\times N$ grid of parentheses.", "outputFormat": "- Line 1: A single integer specifying the maximum amount of time Bessie can spend traveling between a pair of pastures (given that she always follows a route that takes a minimum amount of time).", "hint": "It takes Bessie 5 units of time to travel between the upper-left corner and the lower-right corner of the grid. No other pair of pastures causes her to travel for more time than this.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO12NOV] Distant Pastures S", "background": "", "description": "Farmer John's farm is made up of an N x N grid of pastures, where each pasture contains one of two different types of grass.  To specify these two types of grass, we use the characters ( and ), so for example FJ's farm might look like the following grid:\n\n(()) \n)()( \n)((( \n))))\nWhen Bessie the cow travels around the farm, it takes her A units of time to move from a pasture to an adjacent pasture (one step north, south, east, or west) with the same grass type, or B units of time to move to an adjacent pasture with a different grass type.  Whenever Bessie travels from one pasture to a distant pasture, she always uses a sequence of steps that takes the minimum amount of time.  Please compute the greatest amount of time Bessie will ever need to take while traveling between some pair of pastures on the farm.\n\n给出一个n\\*n的括号矩阵，从一个点走到相邻的同字符点需付出A的代价，到不同字符点需付出B的代价。求所有点对之间最短路的最大值。\n", "inputFormat": "\\* Line 1: Three integers: N (1 <= N <= 30), A (0 <= A <= 1,000,000), and B (0 <= B <= 1,000,000).\n\n\\* Lines 1..N+1: Each line contains a string of parentheses of length N.  Collectively, these N lines form an N x N grid of\n\nparentheses.\n", "outputFormat": "\\* Line 1: A single integer specifying the maximum amount of time Bessie can spend traveling between a pair of pastures (given that she always follows a route that takes a minimum amount of time).\n", "hint": "It takes Bessie 5 units of time to travel between the upper-left corner and the lower-right corner of the grid.  No other pair of pastures causes her to travel for more time than this.\n", "locale": "zh-CN"}}}
{"pid": "P3058", "type": "P", "difficulty": 4, "samples": [["(()) \n", "6 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "USACO"], "title": "[USACO12NOV] Balanced Cow Breeds G/S", "background": "", "description": "Farmer John usually brands his cows with a circular mark, but his branding iron is broken, so he instead must settle for branding each cow with a mark in the shape of a parenthesis -- (.  He has two breeds of cows on his farm: Holsteins and Guernseys.  He brands each of his cows with a\n\nparenthesis-shaped mark.  Depending on which direction the cow is facing, this might look like either a left parenthesis or a right parenthesis.\n\nFJ's N cows are all standing in a row, each facing an arbitrary direction, so the marks on the cows look like a string of parentheses of length N. Looking at this lineup, FJ sees a remarkable pattern: if he scans from left to right through just the Holsteins (in the order they appear in the sequence), this gives a balanced string of parentheses; moreover, the same is true for the Guernseys!  To see if this is truly a rare event, please help FJ compute the number of possible ways he could assign breeds to his N cows so that this property holds.\n\nThere are several ways to define what it means for a string of parentheses to be \"balanced\".  Perhaps the simplest definition is that there must be the same total number of ('s and )'s, and for any prefix of the string, there must be at least as many ('s as )'s.  For example, the following strings are all balanced:\n\n() \n(()) \n()(()()) \n\nwhile these are not:\n\n)( \n())( \n((()))) \n\n给一个只有左右括号的字符串，然后用 `H`、`G` 两种字符来标记这个序列，所有标记 `H` 的括号可以组成一个正确的括号序列，所有 `G` 标记的括号也组成一个正确的括号序列，然后输出这种标记方案的总数 $\\operatorname{mod} 2012$ 的值。", "inputFormat": "\\* Line 1: A string of parentheses of length N (1 <= N <= 1000).\n", "outputFormat": "\\* Line 1: A single integer, specifying the number of ways FJ can assign breeds to cows so that the Holsteins form a balanced subsequence of parentheses, and likewise for the Guernseys. Since the answer might be a very large number, please print the remainder of this number when divided by 2012 (i.e., print the number mod 2012).  Breed assignments involving only one breed type are valid.\n", "hint": "The following breed assignments work:\n\n(()) \nHHHH\n(()) \nGGGG\n(()) \nHGGH\n(()) \nGHHG\n(()) \nHGHG\n(()) \nGHGH\n \n感谢@CREEPER\\_ 提供翻译\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO12NOV] Balanced Cow Breeds G/S", "background": "", "description": "Farmer John usually brands his cows with a circular mark, but his branding iron is broken, so he instead must settle for branding each cow with a mark in the shape of a parenthesis — (. He has two breeds of cows on his farm: Holsteins and Guernseys. He brands each of his cows with a parenthesis-shaped mark. Depending on which direction the cow is facing, this might look like either a left parenthesis or a right parenthesis.\n\nFJ’s N cows are all standing in a row, each facing an arbitrary direction, so the marks on the cows look like a string of parentheses of length N. Looking at this lineup, FJ sees a remarkable pattern: if he scans from left to right through just the Holsteins (in the order they appear in the sequence), this gives a balanced string of parentheses; moreover, the same is true for the Guernseys. To see if this is truly a rare event, please help FJ compute the number of possible ways he could assign breeds to his N cows so that this property holds.\n\nThere are several ways to define what it means for a string of parentheses to be \"balanced\". Perhaps the simplest definition is that there must be the same total number of (’s and )’s, and for any prefix of the string, there must be at least as many (’s as )’s. For example, the following strings are all balanced:\n()\n(())\n()(()())\nwhile these are not:\n)(\n())(\n((())))\n\nGiven a string consisting only of left and right parentheses, label the sequence with two characters, H and G, such that the parentheses labeled H form a correct (balanced) parentheses sequence and the parentheses labeled G also form a correct parentheses sequence. Output the total number of such labeling schemes $\\operatorname{mod} 2012$.", "inputFormat": "- Line 1: A string of parentheses of length $N$ ($1 \\le N \\le 1000$).", "outputFormat": "- Line 1: A single integer, specifying the number of ways FJ can assign breeds to cows so that the Holsteins form a balanced subsequence of parentheses, and likewise for the Guernseys. Since the answer might be a very large number, please print the remainder of this number when divided by 2012 (i.e., print the number mod 2012). Breed assignments involving only one breed type are valid.", "hint": "The following breed assignments work:\n(())\nHHHH\n(())\nGGGG\n(())\nHGGH\n(())\nGHHG\n(())\nHGHG\n(())\nGHGH\n\nThanks to @CREEPER_ for providing the translation.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO12NOV] Balanced Cow Breeds G/S", "background": "", "description": "Farmer John usually brands his cows with a circular mark, but his branding iron is broken, so he instead must settle for branding each cow with a mark in the shape of a parenthesis -- (.  He has two breeds of cows on his farm: Holsteins and Guernseys.  He brands each of his cows with a\n\nparenthesis-shaped mark.  Depending on which direction the cow is facing, this might look like either a left parenthesis or a right parenthesis.\n\nFJ's N cows are all standing in a row, each facing an arbitrary direction, so the marks on the cows look like a string of parentheses of length N. Looking at this lineup, FJ sees a remarkable pattern: if he scans from left to right through just the Holsteins (in the order they appear in the sequence), this gives a balanced string of parentheses; moreover, the same is true for the Guernseys!  To see if this is truly a rare event, please help FJ compute the number of possible ways he could assign breeds to his N cows so that this property holds.\n\nThere are several ways to define what it means for a string of parentheses to be \"balanced\".  Perhaps the simplest definition is that there must be the same total number of ('s and )'s, and for any prefix of the string, there must be at least as many ('s as )'s.  For example, the following strings are all balanced:\n\n() \n(()) \n()(()()) \n\nwhile these are not:\n\n)( \n())( \n((()))) \n\n给一个只有左右括号的字符串，然后用 `H`、`G` 两种字符来标记这个序列，所有标记 `H` 的括号可以组成一个正确的括号序列，所有 `G` 标记的括号也组成一个正确的括号序列，然后输出这种标记方案的总数 $\\operatorname{mod} 2012$ 的值。", "inputFormat": "\\* Line 1: A string of parentheses of length N (1 <= N <= 1000).\n", "outputFormat": "\\* Line 1: A single integer, specifying the number of ways FJ can assign breeds to cows so that the Holsteins form a balanced subsequence of parentheses, and likewise for the Guernseys. Since the answer might be a very large number, please print the remainder of this number when divided by 2012 (i.e., print the number mod 2012).  Breed assignments involving only one breed type are valid.\n", "hint": "The following breed assignments work:\n\n(()) \nHHHH\n(()) \nGGGG\n(()) \nHGGH\n(()) \nGHHG\n(()) \nHGHG\n(()) \nGHGH\n \n感谢@CREEPER\\_ 提供翻译\n", "locale": "zh-CN"}}}
{"pid": "P3059", "type": "P", "difficulty": 6, "samples": [["3 14 \n)()((())))(()) \n()(()()()((()) \n)))(()()))(()) \n", "3 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "USACO"], "title": "[USACO12NOV] Concurrently Balanced Strings G", "background": null, "description": "农夫约翰养了一只非常特殊的奶牛品种，以其独特的外貌而闻名，每只奶牛的皮上都有一个巨大的圆形斑点（根据奶牛的朝向不同，这可能看起来像左括号或右括号）。\n\n一天早上，约翰把他的奶牛们分成了 $K$ 行，每行 $N$ 头奶牛（$1 \\leq K \\leq 10, 1 \\leq N \\leq 50,000$）。由于奶牛们朝向任意方向，所以这个队列可以用 $K$ 个长度为 $N$ 的括号字符串 $S_1,..., S_k$ 来描述。约翰非常激动地注意到他的牛群中有一些“并发平衡”的范围，其中范围 $i...j$ 的奶牛只有在每个字符串 $S_1,..., S_k$ 在该范围内都是平衡的情况下才能同时平衡（我们将在下面定义单个括号字符串平衡的含义）。例如，如果 $K = 3$ ，我们有\n\n- $S_1 = \\texttt{)()((())))(())}$\n- $S_2 = \\texttt{()(()()()((())}$\n- $S_3 = \\texttt{)))(()()))(())}$\n\n那么范围 $[3...8]$ 是并发平衡的，因为 $S_1[3...8] = \\texttt{((()))}$ ，$S_2[3...8] = \\texttt{()()()}$ ，$S_3[3...8] = \\texttt{(()())}$ 。范围 $[10...13]$ 和 $[11...12]$ 也是并发平衡的。\n\n给定 $K$ 个长度为 $N$ 的括号字符串，帮助约翰计算范围 $(i,j)$ 的数量，使得范围 $i...j$ 在 $K$ 个字符串中都是并发平衡的。\n\n对于单个括号字符串的“平衡”的定义有几种方式。也许最简单的定义是括号的数量必须相等，并且对于字符串的任何前缀，左括号的数量必须至少和右括号的数量一样多。例如，以下字符串都是平衡的：\n\n- $\\texttt{()}$\n- $\\texttt{(())}$\n- $\\texttt{()(()())}$\n\n而这些字符串则不是平衡的：\n\n- $\\texttt{)(}$\n- $\\texttt{())(}$\n- $\\texttt{((())))}$\n\n给出 $K$ 个长度为 $N$ 的括号序列，问有多少个区间在 $K$ 个序列中对应的子串均平衡。", "inputFormat": "第一行：两个整数 $K$ 和 $N$。\n\n第二行至第 $K+1$ 行：每行包含一个长度为 $N$ 的括号字符串。", "outputFormat": "第一行：一个整数，表示并发平衡的范围的数量。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "[USACO12NOV] Concurrently Balanced Strings G", "background": "", "description": "Farmer John raises a very special breed of cows known for their distinctive appearance, where each cow has a huge circular spot on its hide that, depending on the cow’s orientation, may look like a left parenthesis or a right parenthesis.\n\nOne morning, John arranges his cows into $K$ rows, each with $N$ cows ($1 \\leq K \\leq 10, 1 \\leq N \\leq 50{,}000$). Since the cows face arbitrary directions, this formation can be described by $K$ parenthesis strings $S_1, ..., S_k$ of length $N$. John is excited to notice that his herd has some “concurrently balanced” ranges, where the range $i...j$ is concurrently balanced only if in each string $S_1, ..., S_k$ the substring over that range is balanced (we will define the meaning of a single parenthesis string being balanced below). For example, if $K = 3$, we have\n\n- $S_1 = \\texttt{)()((())))(())}$\n- $S_2 = \\texttt{()(()()()((())}$\n- $S_3 = \\texttt{)))(()()))(())}$\n\nThen the range $[3...8]$ is concurrently balanced because $S_1[3...8] = \\texttt{((()))}$, $S_2[3...8] = \\texttt{()()()}$, and $S_3[3...8] = \\texttt{(()())}$. The ranges $[10...13]$ and $[11...12]$ are also concurrently balanced.\n\nGiven $K$ parenthesis strings of length $N$, help John count the number of pairs $(i, j)$ such that the range $i...j$ is concurrently balanced across all $K$ strings.\n\nThere are several equivalent ways to define “balanced” for a single parenthesis string. Perhaps the simplest is that the total numbers of parentheses must be equal, and for any prefix of the string, the number of left parentheses must be at least as many as the number of right parentheses. For example, the following strings are balanced:\n\n- $\\texttt{()}$\n- $\\texttt{(())}$\n- $\\texttt{()(()())}$\n\nAnd these strings are not balanced:\n\n- $\\texttt{)(}$\n- $\\texttt{())(}$\n- $\\texttt{((())))}$\n\nGiven $K$ sequences of length $N$ consisting of parentheses, how many intervals are there such that the corresponding substrings are balanced in all $K$ sequences?", "inputFormat": "The first line contains two integers $K$ and $N$.\n\nThe second through the $(K+1)$-th lines: each line contains a parenthesis string of length $N$.", "outputFormat": "The first line contains a single integer, the number of concurrently balanced ranges.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO12NOV] Concurrently Balanced Strings G", "background": null, "description": "农夫约翰养了一只非常特殊的奶牛品种，以其独特的外貌而闻名，每只奶牛的皮上都有一个巨大的圆形斑点（根据奶牛的朝向不同，这可能看起来像左括号或右括号）。\n\n一天早上，约翰把他的奶牛们分成了 $K$ 行，每行 $N$ 头奶牛（$1 \\leq K \\leq 10, 1 \\leq N \\leq 50,000$）。由于奶牛们朝向任意方向，所以这个队列可以用 $K$ 个长度为 $N$ 的括号字符串 $S_1,..., S_k$ 来描述。约翰非常激动地注意到他的牛群中有一些“并发平衡”的范围，其中范围 $i...j$ 的奶牛只有在每个字符串 $S_1,..., S_k$ 在该范围内都是平衡的情况下才能同时平衡（我们将在下面定义单个括号字符串平衡的含义）。例如，如果 $K = 3$ ，我们有\n\n- $S_1 = \\texttt{)()((())))(())}$\n- $S_2 = \\texttt{()(()()()((())}$\n- $S_3 = \\texttt{)))(()()))(())}$\n\n那么范围 $[3...8]$ 是并发平衡的，因为 $S_1[3...8] = \\texttt{((()))}$ ，$S_2[3...8] = \\texttt{()()()}$ ，$S_3[3...8] = \\texttt{(()())}$ 。范围 $[10...13]$ 和 $[11...12]$ 也是并发平衡的。\n\n给定 $K$ 个长度为 $N$ 的括号字符串，帮助约翰计算范围 $(i,j)$ 的数量，使得范围 $i...j$ 在 $K$ 个字符串中都是并发平衡的。\n\n对于单个括号字符串的“平衡”的定义有几种方式。也许最简单的定义是括号的数量必须相等，并且对于字符串的任何前缀，左括号的数量必须至少和右括号的数量一样多。例如，以下字符串都是平衡的：\n\n- $\\texttt{()}$\n- $\\texttt{(())}$\n- $\\texttt{()(()())}$\n\n而这些字符串则不是平衡的：\n\n- $\\texttt{)(}$\n- $\\texttt{())(}$\n- $\\texttt{((())))}$\n\n给出 $K$ 个长度为 $N$ 的括号序列，问有多少个区间在 $K$ 个序列中对应的子串均平衡。", "inputFormat": "第一行：两个整数 $K$ 和 $N$。\n\n第二行至第 $K+1$ 行：每行包含一个长度为 $N$ 的括号字符串。", "outputFormat": "第一行：一个整数，表示并发平衡的范围的数量。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P3060", "type": "P", "difficulty": 6, "samples": [["15 \n1 \n2 \n1 \n4 \n4 \n6 \n7 \n5 \n9 \n9 \n11 \n12 \n13 \n14 \n( \n) \n) \n( \n) \n) \n( \n) \n( \n( \n( \n) \n) \n) \n( \n", "3 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2012", "USACO", "点分治"], "title": "[USACO12NOV] Balanced Trees G", "background": null, "description": "Farmer John 对之前解决平衡括号串问题的经历非常着迷，现在 Farmer John 想请你帮忙解决最后一个问题。\n\nFJ 的农场是由 $N$ 个牧场组成的一棵大树，每个牧场都被他标记为了 `(` 或 `)`。例如：\n```\n'('--'('--')'--'('--')'\n |         |\n')'       ')'--'('--'(' \n |              |\n')'            '('--')'--')'--')'--'('\n```\n\n由于农场是一棵树，这意味着某些牧场之间通过路径连接，任意两个牧场之间有且只有一条唯一的路径。\n\nFJ 相信，这些路径中的某些路径代表了一串平衡括号字符串。具体来说，他想知道在所有由树中路径表示的平衡字符串中，最大嵌套深度是多少。\n\n一个平衡括号字符串的嵌套深度是指该字符串所有前缀中左括号比右括号多出的最大数目。\n\n例如，字符串 `()()()` 的嵌套深度为 $1$，而字符串 ((()))() 的嵌套深度为 $3$。我们可以通过计算每个前缀中左括号的超出数量来清楚地看到这一点：\n```\n((()))()\n12321010\n```\n对于上面的示例，拥有最大嵌套深度的字符串是 ((()))，其深度为 $3$，可以通过如下的从 $A$ 到 $B$ 的路径获得：\n```\n'('--'('--')'--'('--')' \n|         | \n')'       ')'--'('--'(' < A \n|              | \n')'            '('--')'--')'--')'--'(' \n^C                            ^B \n```\n\n注意：最深的字符串与最长的平衡字符串不同。例如，从 $A$ 到 $C$ 的路径 `(())(())` 的长度为 $8$，然而，它不是拥有最大嵌套深度的字符串。\n\n你的任务是，输出树中拥有最大嵌套深度的路径的嵌套深度。", "inputFormat": "第 $1$ 行包含一个整数 $N$，表示树中节点的数量。\n\n第 $2\\sim N$ 行，第 $i+1$ 行包含一个整数 $p_{i+1}$（$1\\le p_{i+1}\\le i$），表示节点 $i+1$ 和节点 $p_{i+1}$ 之间有一条边。\n\n第 $N+1\\sim 2N$ 行：第 $N+i$ 行包含一个字符 `(` 或 `)`，表示节点 $i$ 对应的标记。", "outputFormat": "输出包含一行。输出一个整数，表示树中拥有最大嵌套深度的路径的嵌套深度。", "hint": "### 【样例说明】\n题目样例中的树形图如下所示：\n\n```\n1'('--4'('--6')'--7'('--8')' \n|     |\n2')'  5')'--9'('--10'(' \n|           |\n3')'       11'('--12')'--13')'--14')'--15'(' \n```\n### 【数据范围】\n对于 $100\\%$ 的数据，$1\\le N\\le40000$。\n\n翻译 & 格式修复 by FakzianQwQ。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO12NOV] Balanced Trees G", "background": null, "description": "Fascinated by his experience with balanced parentheses so far, Farmer John is curious if you can help him solve one final problem. As it turns out, FJ's farm is in the shape of a giant tree of N pastures $(1\\le N\\le40,000)$, each of which he has labeled with either `(` or `)`. For example:\n```\n'('--'('--')'--'('--')'\n |         |\n')'       ')'--'('--'(' \n |              |\n')'            '('--')'--')'--')'--'('\n```\n\nRecall that since his farm is a tree, this means that certain pairs of pastures are connected by corridors so that there is one unique path between any given pair of pastures. FJ believes that some of these paths represent balanced strings of parentheses. In particular, he would like to know, among all such balanced strings represented by paths through the tree, what is the maximum nesting depth one can find. The nesting depth of a balanced string of parentheses is the maximum, over all prefixes of the string, of the excess number of `(`'s within the prefix. For example, the string `()()()` has nesting depth $1$, but the string `((()))()` has nesting depth $3$, as we can see clearly if we count excess `(`'s for every prefix of the string:\n```\n((()))()\n12321010\n```\n\nFor the example farm above, the deepest string is `((()))` with a depth of $3$, and can be obtained by taking the path from $A$ to $B$ below:\n```\n'('--'('--')'--'('--')' \n|         | \n')'       ')'--'('--'(' < A \n|              | \n')'            '('--')'--')'--')'--'(' \n^C                            ^B\n```\n\nNote that this is different than the longest balanced string; for instance `(())(())`, starting at $A$ and ending at $C$, has length $8$.\n\nYour task is to output the nesting depth of the deepest balanced path in the tree.", "inputFormat": "\\* Line $1$: A single integer $N$, the number of nodes in the tree.\n\n\\* Lines $2\\dots N$: Line $i+1$: A single integer $p_{i+1}(1\\le p_{i+1}\\le i)$, denoting an edge between nodes $i+1$ and $p_{i+1}$ in the tree.\n\n\\* Lines $N+1\\dots 2N$: Line $N+i$: Either `(` or `)`, the label of node $i$.", "outputFormat": "\\* Line $1$: A single integer, giving the maximum nesting depth of a balanced path.", "hint": "This is the example from the problem description, with the following node labels:\n```\n1'('--4'('--6')'--7'('--8')' \n|     |\n2')'  5')'--9'('--10'(' \n|           |\n3')'       11'('--12')'--13')'--14')'--15'(' \n```", "locale": "en"}, "zh-CN": {"title": "[USACO12NOV] Balanced Trees G", "background": null, "description": "Farmer John 对之前解决平衡括号串问题的经历非常着迷，现在 Farmer John 想请你帮忙解决最后一个问题。\n\nFJ 的农场是由 $N$ 个牧场组成的一棵大树，每个牧场都被他标记为了 `(` 或 `)`。例如：\n```\n'('--'('--')'--'('--')'\n |         |\n')'       ')'--'('--'(' \n |              |\n')'            '('--')'--')'--')'--'('\n```\n\n由于农场是一棵树，这意味着某些牧场之间通过路径连接，任意两个牧场之间有且只有一条唯一的路径。\n\nFJ 相信，这些路径中的某些路径代表了一串平衡括号字符串。具体来说，他想知道在所有由树中路径表示的平衡字符串中，最大嵌套深度是多少。\n\n一个平衡括号字符串的嵌套深度是指该字符串所有前缀中左括号比右括号多出的最大数目。\n\n例如，字符串 `()()()` 的嵌套深度为 $1$，而字符串 ((()))() 的嵌套深度为 $3$。我们可以通过计算每个前缀中左括号的超出数量来清楚地看到这一点：\n```\n((()))()\n12321010\n```\n对于上面的示例，拥有最大嵌套深度的字符串是 ((()))，其深度为 $3$，可以通过如下的从 $A$ 到 $B$ 的路径获得：\n```\n'('--'('--')'--'('--')' \n|         | \n')'       ')'--'('--'(' < A \n|              | \n')'            '('--')'--')'--')'--'(' \n^C                            ^B \n```\n\n注意：最深的字符串与最长的平衡字符串不同。例如，从 $A$ 到 $C$ 的路径 `(())(())` 的长度为 $8$，然而，它不是拥有最大嵌套深度的字符串。\n\n你的任务是，输出树中拥有最大嵌套深度的路径的嵌套深度。", "inputFormat": "第 $1$ 行包含一个整数 $N$，表示树中节点的数量。\n\n第 $2\\sim N$ 行，第 $i+1$ 行包含一个整数 $p_{i+1}$（$1\\le p_{i+1}\\le i$），表示节点 $i+1$ 和节点 $p_{i+1}$ 之间有一条边。\n\n第 $N+1\\sim 2N$ 行：第 $N+i$ 行包含一个字符 `(` 或 `)`，表示节点 $i$ 对应的标记。", "outputFormat": "输出包含一行。输出一个整数，表示树中拥有最大嵌套深度的路径的嵌套深度。", "hint": "### 【样例说明】\n题目样例中的树形图如下所示：\n\n```\n1'('--4'('--6')'--7'('--8')' \n|     |\n2')'  5')'--9'('--10'(' \n|           |\n3')'       11'('--12')'--13')'--14')'--15'(' \n```\n### 【数据范围】\n对于 $100\\%$ 的数据，$1\\le N\\le40000$。\n\n翻译 & 格式修复 by FakzianQwQ。", "locale": "zh-CN"}}}
{"pid": "P3061", "type": "P", "difficulty": 6, "samples": [["10 4 \n0 0 10 0 \n10 0 10 10 \n0 0 0 10 \n10 10 0 10 \n8 8 9 8 \n9 8 8 9 \n8 9 8 8 \n2 7 3 2 \n3 2 7 5 \n7 5 2 7 \n15 3 \n1 4 \n4 5 \n7 1 \n", "2 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["计算几何", "2012", "USACO"], "title": "[USACO12DEC] Crazy Fences S", "background": null, "description": "在访问了一个现代美术馆后，约翰农夫决定移动 $N$ 个在他的牧场之间的栅栏来\n\n\n重新设计他的农场。每个栅栏用一个 2D 平面的线段来描述。两个栅栏只有在他们的端点才会相遇。每个栅栏在两个端点接触其他的两个栅栏。\n\n\n约翰农夫有 $C$ 头牛在他的农场。每头牛住在 2D 平面的不在任何栅栏的一个点，并且没有两头牛在同一个点。如果两头牛可以不接触任何栅栏地走到一起，他们就是在同一个社区。请确定最大的社区的牛的数量。", "inputFormat": "第一行包含两个整数 $N$ 和 $C$。\n\n接下来 $N$ 行，每行包含四个整数 $x_1,y_1,x_2,y_2$，表示一个栅栏的两个端点为 $(x_1,y_1)$ 和 $(x_2,y_2)$。所有坐标都是 $0...1,000,000$ 范围内的整数。\n\n接下来 $C$ 行，每行包含两个整数 $x,y$，表示一头牛的所在位置为 $(x,y)$。所有坐标都是 $0...1,000,000$ 范围内的整数。", "outputFormat": "输出最大社区的牛的数量。", "hint": "奶牛 $2$ 和 $4$ 在一个社区中。\n\n奶牛 $1$ 和 $3$ 各自在一个社区中。\n\n最大社区的牛的数量为 $2$。", "locale": "zh-CN", "translations": {"en": {"title": "P3061 [USACO12DEC] Crazy Fences S", "background": null, "description": "After visiting a modern art museum, Farmer John decides to re-design his farm by moving all of the $N$ ($1 \\le N \\le 1000$) fences between his pastures! Each fence is describe by a line segment in the 2D plane. If two fences meet, they do so only at their endpoints. Each fence touches exactly two other fences, one at both endpoints.\n\nFJ has $C$ cows ($1 \\le C \\le 1000$) on his farm. Each cow resides at a point in the 2D plane that is not on any fence, and no two cows reside at the same point. Two cows are said to be in the same community if one could walk to the other without touching any fences. Please help FJ determine the size of the largest community.", "inputFormat": "Line $1$: Two space-separated integers $N$ and $C$.\n\nLines $2...N+1$: Each line contains four integers: $x_1$, $y_1$, $x_2$, $y_2$, indicating a fence from point $(x_1,y_1)$ to point $(x_2,y_2)$. All coordinates are integers in the range $0..1,000,000$.\n\nLines $2+N...1+N+C$: Each line contains two integers $x$ and $y$ describing the location of a cow. All coordinates are integers in the range $0..1,000,000$.", "outputFormat": "Line $1$: The number of cows in the largest community.", "hint": "There are $10$ fences and $4$ cows. The fences form a square containing two triangles.\n\nCows $2$ and $4$ belong to the same community. Cows $1$ and $3$ are each members of a community of size $1$.", "locale": "en"}, "zh-CN": {"title": "[USACO12DEC] Crazy Fences S", "background": null, "description": "在访问了一个现代美术馆后，约翰农夫决定移动 $N$ 个在他的牧场之间的栅栏来\n\n\n重新设计他的农场。每个栅栏用一个 2D 平面的线段来描述。两个栅栏只有在他们的端点才会相遇。每个栅栏在两个端点接触其他的两个栅栏。\n\n\n约翰农夫有 $C$ 头牛在他的农场。每头牛住在 2D 平面的不在任何栅栏的一个点，并且没有两头牛在同一个点。如果两头牛可以不接触任何栅栏地走到一起，他们就是在同一个社区。请确定最大的社区的牛的数量。", "inputFormat": "第一行包含两个整数 $N$ 和 $C$。\n\n接下来 $N$ 行，每行包含四个整数 $x_1,y_1,x_2,y_2$，表示一个栅栏的两个端点为 $(x_1,y_1)$ 和 $(x_2,y_2)$。所有坐标都是 $0...1,000,000$ 范围内的整数。\n\n接下来 $C$ 行，每行包含两个整数 $x,y$，表示一头牛的所在位置为 $(x,y)$。所有坐标都是 $0...1,000,000$ 范围内的整数。", "outputFormat": "输出最大社区的牛的数量。", "hint": "奶牛 $2$ 和 $4$ 在一个社区中。\n\n奶牛 $1$ 和 $3$ 各自在一个社区中。\n\n最大社区的牛的数量为 $2$。", "locale": "zh-CN"}}}
{"pid": "P3062", "type": "P", "difficulty": 3, "samples": [["3 20 5 \n7 \n0 \n100 \n", "57.5 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "USACO"], "title": "[USACO12DEC] Wifi Setup S", "background": "", "description": "Farmer John's N cows (1 <= N <= 2000) are all standing at various positions along the straight path from the barn to the pasture, which we can think of as a one-dimensional number line.  Since his cows like to stay in email contact with each-other, FJ wants to install Wifi base stations at various positions so that all of the cows have wireless coverage.\n\nAfter shopping around, FJ learns that the cost of a Wifi base station depends on distance it can transmit: a base station of power r costs A + B\\*r, where A is a fixed cost for installing the base station and B is a cost per unit of transmission distance.  If FJ installs such a device at position x, then it can transmit data to any cow located in the range x-r ... x+r.  A base station with transmission power of r=0 is allowed, but this only provides coverage to a cow located at the same position as the transmitter.\n\nGiven the values of A and B, as well as the locations of FJ's cows, please determine the least expensive way FJ can provide wireless coverage for all his cows.\n\n给出在同一条直线上的n个点和两个数A，B，现在要在这条直线上放置若干个信号塔，每个信号塔有一个r值，假设它的位置是x，则它能覆盖的范围是x-r~x+r，放置一个信号塔的花费是A+B\\*r，问要覆盖所有的点最小的花费是多少。\n", "inputFormat": "\\* Line 1: Three space-separated integers: N A B (0 <= A, B <= 1000).\n\n\\* Lines 2..1+N: Each line contains an integer in the range\n\n0..1,000,000 describing the location of one of FJ's cows.\n", "outputFormat": "\\* Line 1: The minimum cost of providing wireless coverage to all cows.\n", "hint": "There are 3 cows at positions 7, 0, and 100.  Installation of a base station of power r costs 20 + 5\\*r.\n\n\nThe optimal solution is to build a base station at position 3.5 (with power 3.5) and another at position 100 (with power 0).  The first base station covers cows 1 and 2, and the second covers cow 3.\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO12DEC] Wifi Setup S", "background": "", "description": "Farmer John’s $N$ cows ($1 \\le N \\le 2000$) stand at various positions along a straight path, which we can regard as a one-dimensional number line. Since his cows want to stay in email contact with each other, FJ plans to install Wifi base stations at positions of his choosing so that all cows have wireless coverage.\n\nThe cost of a Wifi base station depends on its transmission distance: a base station with power $r$ costs $A + B \\times r$, where $A$ is the fixed installation cost and $B$ is the cost per unit distance. If a base station is installed at position $x$, it provides coverage to any cow located in the interval $[x - r, x + r]$. A base station with $r = 0$ is allowed, but it only covers a cow located exactly at $x$.\n\nGiven $A$, $B$, and the locations of FJ’s cows, determine the minimum total cost to provide wireless coverage for all cows. Base stations may be placed at any real position on the line.", "inputFormat": "- Line 1: Three space-separated integers $N$, $A$, $B$, where $1 \\le N \\le 2000$ and $0 \\le A, B \\le 1000$.\n- Lines $2$ to $N + 1$: Each line contains an integer in $[0, 1{,}000{,}000]$ describing the location of one cow.", "outputFormat": "- Line 1: The minimum total cost to provide wireless coverage to all cows.", "hint": "There are $3$ cows at positions $7$, $0$, and $100$. Installing a base station of power $r$ costs $20 + 5 \\times r$.\n\nAn optimal solution is to build one base station at position $3.5$ (power $r = 3.5$) and another at position $100$ (power $r = 0$). The first base station covers cows $1$ and $2$, and the second covers cow $3$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO12DEC] Wifi Setup S", "background": "", "description": "Farmer John's N cows (1 <= N <= 2000) are all standing at various positions along the straight path from the barn to the pasture, which we can think of as a one-dimensional number line.  Since his cows like to stay in email contact with each-other, FJ wants to install Wifi base stations at various positions so that all of the cows have wireless coverage.\n\nAfter shopping around, FJ learns that the cost of a Wifi base station depends on distance it can transmit: a base station of power r costs A + B\\*r, where A is a fixed cost for installing the base station and B is a cost per unit of transmission distance.  If FJ installs such a device at position x, then it can transmit data to any cow located in the range x-r ... x+r.  A base station with transmission power of r=0 is allowed, but this only provides coverage to a cow located at the same position as the transmitter.\n\nGiven the values of A and B, as well as the locations of FJ's cows, please determine the least expensive way FJ can provide wireless coverage for all his cows.\n\n给出在同一条直线上的n个点和两个数A，B，现在要在这条直线上放置若干个信号塔，每个信号塔有一个r值，假设它的位置是x，则它能覆盖的范围是x-r~x+r，放置一个信号塔的花费是A+B\\*r，问要覆盖所有的点最小的花费是多少。\n", "inputFormat": "\\* Line 1: Three space-separated integers: N A B (0 <= A, B <= 1000).\n\n\\* Lines 2..1+N: Each line contains an integer in the range\n\n0..1,000,000 describing the location of one of FJ's cows.\n", "outputFormat": "\\* Line 1: The minimum cost of providing wireless coverage to all cows.\n", "hint": "There are 3 cows at positions 7, 0, and 100.  Installation of a base station of power r costs 20 + 5\\*r.\n\n\nThe optimal solution is to build a base station at position 3.5 (with power 3.5) and another at position 100 (with power 0).  The first base station covers cows 1 and 2, and the second covers cow 3.\n", "locale": "zh-CN"}}}
{"pid": "P3063", "type": "P", "difficulty": 4, "samples": [["3 3 15 \n1 2 10 3 \n3 2 10 2 \n1 3 14 1 \n", "27 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["图论", "2012", "USACO", "最短路"], "title": "[USACO12DEC] Milk Routing S", "background": "", "description": "Farmer John's farm has an outdated network of M pipes (1 <= M <= 500) for pumping milk from the barn to his milk storage tank.  He wants to remove and update most of these over the next year, but he wants to leave exactly one path worth of pipes intact, so that he can still pump milk from the barn to the storage tank.\n\nThe pipe network is described by N junction points (1 <= N <= 500), each of which can serve as the endpoint of a set of pipes.  Junction point 1 is the barn, and junction point N is the storage tank.  Each of the M bi-directional pipes runs between a pair of junction points, and has an associated latency (the amount of time it takes milk to reach one end of the pipe from the other) and capacity (the amount of milk per unit time that can be pumped through the pipe in steady state).  Multiple pipes can connect between the same pair of junction points.\n\nFor a path of pipes connecting from the barn to the tank, the latency of the path is the sum of the latencies of the pipes along the path, and the capacity of the path is the minimum of the capacities of the pipes along the path (since this is the \"bottleneck\" constraining the overall rate at which milk can be pumped through the path).  If FJ wants to send a total of X units of milk through a path of pipes with latency L and capacity C, the time this takes is therefore L + X/C.\n\nGiven the structure of FJ's pipe network, please help him select a single path from the barn to the storage tank that will allow him to pump X units of milk in a minimum amount of total time.\n\n\n", "inputFormat": "\\* Line 1: Three space-separated integers: N M X (1 <= X <= 1,000,000).\n\n\\* Lines 2..1+M: Each line describes a pipe using 4 integers: I J L C. I and J (1 <= I,J <= N) are the junction points at both ends of the pipe.  L and C (1 <= L,C <= 1,000,000) give the latency and capacity of the pipe.\n\n\n第1行：三个空格分隔的整数:N M X(1<=X<=1000000)。\n\n\n第2行到第M+1行：每一行描述一条管道，有4个整数：I J L C。I和J(1<=I,J<=N)是这条管道连接的两个点。L和C(1<=L，C<=1000000)是这条管道的延迟和容量。\n", "outputFormat": "\\* Line 1: The minimum amount of time it will take FJ to send milk along a single path, rounded down to the nearest integer.\n\n第1行:约翰沿着一条路径送牛奶花费的最少的时间，向下取整到最近的整数。\n", "hint": "FJ wants to send 15 units of milk through his pipe network.  Pipe #1 connects junction point 1 (the barn) to junction point 2, and has a latency of 10 and a capacity of 3.  Pipes #2 and #3 are similarly defined.\n\n\nThe path 1->3 takes 14 + 15/1 = 29 units of time.  The path 1->2->3 takes 20 + 15/2 = 27.5 units of time, and is therefore optimal.\n\n\n约翰想要通过管网运送15个单位的牛奶。管道1连接节点1（谷仓）和节点2，延迟为10，容量为3。管道2和管道3也以相似的方式来定义。\n\n\n路径1->3花费14+15/1=29个单位的时间。路径1->2->3花费20+15/2=27.5个单位的时间，用时最少。\n", "locale": "en", "translations": {"en": {"title": "[USACO12DEC] Milk Routing S", "background": "", "description": "Farmer John's farm has an outdated network of M pipes (1 <= M <= 500) for pumping milk from the barn to his milk storage tank.  He wants to remove and update most of these over the next year, but he wants to leave exactly one path worth of pipes intact, so that he can still pump milk from the barn to the storage tank.\n\nThe pipe network is described by N junction points (1 <= N <= 500), each of which can serve as the endpoint of a set of pipes.  Junction point 1 is the barn, and junction point N is the storage tank.  Each of the M bi-directional pipes runs between a pair of junction points, and has an associated latency (the amount of time it takes milk to reach one end of the pipe from the other) and capacity (the amount of milk per unit time that can be pumped through the pipe in steady state).  Multiple pipes can connect between the same pair of junction points.\n\nFor a path of pipes connecting from the barn to the tank, the latency of the path is the sum of the latencies of the pipes along the path, and the capacity of the path is the minimum of the capacities of the pipes along the path (since this is the \"bottleneck\" constraining the overall rate at which milk can be pumped through the path).  If FJ wants to send a total of X units of milk through a path of pipes with latency L and capacity C, the time this takes is therefore L + X/C.\n\nGiven the structure of FJ's pipe network, please help him select a single path from the barn to the storage tank that will allow him to pump X units of milk in a minimum amount of total time.\n\n\n", "inputFormat": "\\* Line 1: Three space-separated integers: N M X (1 <= X <= 1,000,000).\n\n\\* Lines 2..1+M: Each line describes a pipe using 4 integers: I J L C. I and J (1 <= I,J <= N) are the junction points at both ends of the pipe.  L and C (1 <= L,C <= 1,000,000) give the latency and capacity of the pipe.\n\n\n第1行：三个空格分隔的整数:N M X(1<=X<=1000000)。\n\n\n第2行到第M+1行：每一行描述一条管道，有4个整数：I J L C。I和J(1<=I,J<=N)是这条管道连接的两个点。L和C(1<=L，C<=1000000)是这条管道的延迟和容量。\n", "outputFormat": "\\* Line 1: The minimum amount of time it will take FJ to send milk along a single path, rounded down to the nearest integer.\n\n第1行:约翰沿着一条路径送牛奶花费的最少的时间，向下取整到最近的整数。\n", "hint": "FJ wants to send 15 units of milk through his pipe network.  Pipe #1 connects junction point 1 (the barn) to junction point 2, and has a latency of 10 and a capacity of 3.  Pipes #2 and #3 are similarly defined.\n\n\nThe path 1->3 takes 14 + 15/1 = 29 units of time.  The path 1->2->3 takes 20 + 15/2 = 27.5 units of time, and is therefore optimal.\n\n\n约翰想要通过管网运送15个单位的牛奶。管道1连接节点1（谷仓）和节点2，延迟为10，容量为3。管道2和管道3也以相似的方式来定义。\n\n\n路径1->3花费14+15/1=29个单位的时间。路径1->2->3花费20+15/2=27.5个单位的时间，用时最少。\n", "locale": "en"}, "zh-CN": {"title": "[USACO12DEC] Milk Routing S", "background": null, "description": "约翰农场的牛奶输送网络由 $M$ 条管道（$1\\le M\\le 500$）组成，这些管道用于将牛奶从牛棚输送到牛奶储存罐。他计划在未来一年内移除并更新大部分管道，但希望保留一条完整的管道路径，以便仍能将牛奶从牛棚输送到储存罐。\n\n该管道网络由 $N$ 个连接点（$1\\le N\\le 500$）描述，每个连接点可以作为一组管道的端点。连接点 $1$ 是牛棚，连接点 $N$ 是储存罐。每条双向管道连接一对连接点，并具有相关的延迟（牛奶从管道一端到达另一端所需的时间）和容量（在稳定状态下每单位时间可以通过管道输送的牛奶量）。同一对连接点之间可以有多条管道连接。\n\n对于从牛棚到储存罐的管道路径，路径的延迟是路径上各管道延迟的总和，路径的容量是路径上各管道容量的最小值（因为这是限制牛奶通过路径的整体速率的「瓶颈」）。如果约翰想通过一条延迟为 $L$、容量为 $C$ 的管道路径输送总量为 $X$ 的牛奶，则所需时间为 $L + X\\div C$。\n\n给定约翰的管道网络结构，请帮助他选择一条从牛棚到储存罐的路径，使他能够在最短的总时间内输送 $X$ 单位的牛奶。", "inputFormat": "第 $1$ 行：\\\n三个用空格分隔的整数：$N$ $M$ $X$ ($1\\le X\\le 10^6$)。\n\n第 $2$ 行到第 $M+1$ 行：\\\n每行描述一条管道，包含 $4$ 个整数：$I$ $J$ $L$ $C$。\\\n$I$ 和 $J$ ($1\\le I, J\\le N$) 是管道连接的两个连接点。\\\n$L$ 和 $C$ ($1\\le L, C\\le 10^6$) 分别是管道的延迟和容量。", "outputFormat": "仅有一行、一个整数：\\\n约翰沿着一条路径送牛奶所花费的最少时间（**向下取整到最近的整数**）。", "hint": "约翰想通过他的管道网络输送 $15$ 单位的牛奶。管道 $1$ 连接连接点 $1$（牛棚）和连接点 $2$，延迟为 $10$，容量为 $3$。管道 $2$ 和 $3$ 也以类似的方式定义。\n\n\n路径 $1\\to3$ 需要 $14 + 15\\div1 = 29$ 单位的时间。路径 $1\\to 2\\to 3$ 需要 $20 + 15\\div2 = 27.5$ 单位的时间，因此是最优的。\n（由 ChatGPT 4o 翻译）", "locale": "zh-CN"}}}
{"pid": "P3064", "type": "P", "difficulty": 5, "samples": [["5 3 \n2 \n1 \n2 \n", "YES \n1 \n1 \n3 \n2 \n3 \n1 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "USACO"], "title": "[USACO12DEC] Gangs of Istanbull/Cowstantinople G", "background": "", "description": "Life is tough on the farm, and when life is tough you have to get tough. The cows have formed gangs (conveniently numbered 1 to M).  The gangs coexisted in peace for a while, but now things are really getting out of control!\n\nThe cows are competing over control of a great grazing field.  This conflict happens over a series of minutes.  Each minute a single cow walks into the field.  If the field is empty the new cow's gang is considered to take control of the field.  If the field is already controlled by the new cow's gang then the cow just starts grazing.  Otherwise, a single cow from the controlling gang that is grazing confronts the new cow.\n\nThese confrontations between two cows start with some arguing and inevitably end up with the pair coming to realize how much more more alike than different they are.  The cows, seeing the error in their ways, leave the gang and the field and get a cold glass of soy milk at FJ's tavern.  If after this confrontation the field is empty than no gang controls the field.\n\nBessie realizes how these confrontations will occur.  She knows how many cows are in each gang.  Bessie really wants her gang to control the field after the conflict is over and all cows are either on the field or at FJ's tavern.  Help Bessie determine if it is possible for her gang, labeled 1, to control the field in the end.\n\nIf it is possible, Bessie wants to know the maximum number of cows from her gang that could be on the field at the end.  Output this number and the lexicographically earliest ordering of cows that results in this number of cows from Bessie's gang at the end.  An ordering X is said to be lexicographically earlier than Y if there is some k such that X[k] < Y[k] and X[i] = Y[i] for i < k.\n\nn头牛结成了m个帮派，现在它们争夺一块草地。每个单位时间内会有一头牛来。如果草地上还没有牛或者只有自己帮派的牛，他会留在这里。但如果已经有别的帮派的牛，它们会打一架，这使得当前牛和草地上的一头牛去找农夫思考人生。问如何安排来的牛的编号顺序，能使一  号帮派最后有最多的牛留在草地上，如果不为0，还要输出字典序最小的一组方案。\n", "inputFormat": "\\* Line 1: N (1 <= N <= 100) and M (1 <= M <= N) separated by a space. The total number of cows in all the gangs will be N.  The total number of gangs is M.\n\n\\* Lines 2..1+M: The (1+i)th line indicates how many members are in gang i.  Each gang has at least 1 member.\n", "outputFormat": "\\* Line 1: Output YES on a single line if Bessie's gang can control the field after the conflict.  Otherwise output NO on a single line.\n\n\\* Line 2: If Bessie's gang can control the field after the conflict output the maximum number of cows that could be on the field on a single line.\n\n\\* Lines 3..2+N: On the (i+2)th line output the index of the gang of the cow that appears in the ith minute in the\n\nlexicographically earliest ordering that leaves the maximum number of cows on the field after the conflict.\n", "hint": "There are 5 cows and 3 gangs.  Bessie's gang (gang 1) has 2 members, gang 2 has 1 member, and gang 3 has 2 members.\n\n\nOnly one cow from Bessie's gang can end up on the field. \n\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO12DEC] Gangs of Istanbull/Cowstantinople G", "background": "", "description": "Life is tough on the farm, and when life is tough you have to get tough. The cows have formed gangs (conveniently numbered $1$ to $M$). The gangs coexisted in peace for a while, but now things are really getting out of control.\n\nThe cows are competing for control of a great grazing field. This conflict happens over a series of minutes. Each minute a single cow walks into the field. If the field is empty, the new cow’s gang is considered to take control of the field. If the field is already controlled by the new cow’s gang, then the cow just starts grazing. Otherwise, a single cow from the controlling gang that is grazing confronts the new cow.\n\nThese confrontations between two cows start with some arguing and inevitably end with the pair realizing how much more alike than different they are. The cows, seeing the error in their ways, leave the gang and the field and get a cold glass of soy milk at FJ’s tavern. If, after this confrontation, the field is empty, then no gang controls the field.\n\nBessie realizes how these confrontations will occur. She knows how many cows are in each gang. Bessie really wants her gang to control the field after the conflict is over and all cows are either on the field or at FJ’s tavern. Help Bessie determine if it is possible for her gang, labeled $1$, to control the field in the end.\n\nIf it is possible, Bessie wants to know the maximum number of cows from her gang that could be on the field at the end. Output this number and the lexicographically earliest ordering of cows that results in this number of cows from Bessie’s gang at the end. An ordering $X$ is said to be lexicographically earlier than $Y$ if there is some $k$ such that $X[k] < Y[k]$ and $X[i] = Y[i]$ for all $i < k$.\n\nThere are $N$ cows split into $M$ gangs, and they are fighting over a pasture. Each unit of time, one cow arrives. If the pasture is empty or currently controlled by the arriving cow’s own gang, the cow stays. Otherwise, the arriving cow and one grazing cow from the controlling gang fight, and both leave to reflect at Farmer John’s tavern. Determine an arrival order of cow gang indices that maximizes the number of gang $1$ cows remaining on the field at the end. If this maximum is not $0$, also output the lexicographically smallest such ordering.", "inputFormat": "- Line $1$: Two integers $N$ and $M$ ($1 \\le N \\le 100$, $1 \\le M \\le N$). The total number of cows across all gangs is $N$. The total number of gangs is $M$.\n- Lines $2$ to $1+M$: The $(1+i)$-th line contains the number of members in gang $i$. Each gang has at least $1$ member.", "outputFormat": "- Line $1$: Output YES if Bessie’s gang can control the field after the conflict; otherwise, output NO.\n- Line $2$: If YES, output the maximum number of cows from Bessie’s gang that could be on the field at the end.\n- Lines $3$ to $2+N$: If YES, output the lexicographically earliest ordering that achieves this maximum. On the $(i+2)$-th line, output the index of the gang of the cow that appears in the $i$-th minute.", "hint": "There are $5$ cows and $3$ gangs. Bessie’s gang (gang $1$) has $2$ members, gang $2$ has $1$ member, and gang $3$ has $2$ members.\n\nOnly one cow from Bessie’s gang can end up on the field.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO12DEC] Gangs of Istanbull/Cowstantinople G", "background": "", "description": "Life is tough on the farm, and when life is tough you have to get tough. The cows have formed gangs (conveniently numbered 1 to M).  The gangs coexisted in peace for a while, but now things are really getting out of control!\n\nThe cows are competing over control of a great grazing field.  This conflict happens over a series of minutes.  Each minute a single cow walks into the field.  If the field is empty the new cow's gang is considered to take control of the field.  If the field is already controlled by the new cow's gang then the cow just starts grazing.  Otherwise, a single cow from the controlling gang that is grazing confronts the new cow.\n\nThese confrontations between two cows start with some arguing and inevitably end up with the pair coming to realize how much more more alike than different they are.  The cows, seeing the error in their ways, leave the gang and the field and get a cold glass of soy milk at FJ's tavern.  If after this confrontation the field is empty than no gang controls the field.\n\nBessie realizes how these confrontations will occur.  She knows how many cows are in each gang.  Bessie really wants her gang to control the field after the conflict is over and all cows are either on the field or at FJ's tavern.  Help Bessie determine if it is possible for her gang, labeled 1, to control the field in the end.\n\nIf it is possible, Bessie wants to know the maximum number of cows from her gang that could be on the field at the end.  Output this number and the lexicographically earliest ordering of cows that results in this number of cows from Bessie's gang at the end.  An ordering X is said to be lexicographically earlier than Y if there is some k such that X[k] < Y[k] and X[i] = Y[i] for i < k.\n\nn头牛结成了m个帮派，现在它们争夺一块草地。每个单位时间内会有一头牛来。如果草地上还没有牛或者只有自己帮派的牛，他会留在这里。但如果已经有别的帮派的牛，它们会打一架，这使得当前牛和草地上的一头牛去找农夫思考人生。问如何安排来的牛的编号顺序，能使一  号帮派最后有最多的牛留在草地上，如果不为0，还要输出字典序最小的一组方案。\n", "inputFormat": "\\* Line 1: N (1 <= N <= 100) and M (1 <= M <= N) separated by a space. The total number of cows in all the gangs will be N.  The total number of gangs is M.\n\n\\* Lines 2..1+M: The (1+i)th line indicates how many members are in gang i.  Each gang has at least 1 member.\n", "outputFormat": "\\* Line 1: Output YES on a single line if Bessie's gang can control the field after the conflict.  Otherwise output NO on a single line.\n\n\\* Line 2: If Bessie's gang can control the field after the conflict output the maximum number of cows that could be on the field on a single line.\n\n\\* Lines 3..2+N: On the (i+2)th line output the index of the gang of the cow that appears in the ith minute in the\n\nlexicographically earliest ordering that leaves the maximum number of cows on the field after the conflict.\n", "hint": "There are 5 cows and 3 gangs.  Bessie's gang (gang 1) has 2 members, gang 2 has 1 member, and gang 3 has 2 members.\n\n\nOnly one cow from Bessie's gang can end up on the field. \n\n", "locale": "zh-CN"}}}
{"pid": "P3065", "type": "P", "difficulty": 5, "samples": [["4\nomm\nmoo\nmom\nommnom\n", "2\nomm\nmom\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "2012", "USACO", "拓扑排序", "Tarjan", "字典树 Trie"], "title": "[USACO12DEC] First! G", "background": null, "description": "Bessie 一直在研究字符串。她发现，通过改变字母表的顺序，她可以按改变后的字母表来排列字符串（字典序大小排列）。\n\n例如，Bessie 发现，对于字符串 $\\texttt{omm},\\texttt{moo},\\texttt{mom}$ 和 $\\texttt{ommnom}$，她可以使用标准字母表使 $\\texttt{mom}$ 排在第一个（即字典序最小），她也可以使用字母表 $\\texttt{abcdefghijklonmpqrstuvwxyz}$ 使得 $\\texttt{omm}$ 排在第一个。然而，Bessie 想不出任何方法（改变字母表顺序）使得 $\\texttt{moo}$ 或 $\\texttt{ommnom}$ 排在第一个。\n\n接下来让我们通过重新排列字母表的顺序来计算输入中有哪些字符串可以排在第一个（即字典序最小），从而帮助 Bessie。\n\n要计算字符串 $X$ 和字符串 $Y$ 按照重新排列过的字母表顺序来排列的顺序，先找到它们第一个不同的字母 $X_i$ 与 $Y_i$，按重排后的字母表顺序比较，若 $X_i$ 比 $Y_i$ 先，则 $X$ 的字典序比 $Y$ 小，即 $X$ 排在 $Y$ 前；若没有不同的字母，则比较 $X$ 与 $Y$ 长度，若 $X$ 比 $Y$ 短，则 $X$ 的字典序比 $Y$ 小，即 $X$ 排在 $Y$ 前。", "inputFormat": "第 $1$ 行：一个数字 $N$（$1\\le N \\le 30,000$），表示 Bessie 正在研究字符串的数量。\n\n第 $2\\sim N+1$ 行：每行包含一个非空字符串。所有字符串包含的字符总数不会超过 $300,000$。输入中的所有字符都是小写字母，即 $a\\sim z$。输入不包含重复的字符串。", "outputFormat": "第 $1$ 行：一个数字 $K$，表示按重排的字母表顺序排列后可以排在第一个的字符串数量。\n\n第 $2\\sim K+1$ 行：第 $i+1$ 行包含第 $i$ 个按重排的字母表顺序排列后可以排在第一个的字符串。字符串应该按照它们在输入中的顺序来输出。", "hint": "样例即题目描述中给出的例子，只有 $\\texttt{omm}$ 和 $\\texttt{mom}$ 在各自特定的字典序下可以被排列在第一个。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO12DEC] First! G", "background": null, "description": "Bessie has been playing with strings again. She found that by changing the order of the alphabet she could make some strings come before all the others lexicographically (dictionary ordering).\n\nFor instance Bessie found that for the strings `omm`, `moo`, `mom`, and `ommnom` she could make `mom` appear first using the standard alphabet and that she could make `omm` appear first using the alphabet `abcdefghijklonmpqrstuvwxyz`. However, Bessie couldn't figure out any way to make `moo` or `ommnom` appear first.\n\nHelp Bessie by computing which strings in the input could be lexicographically first by rearranging the order of the alphabet. To compute if string $X$ is lexicographically before string $Y$ find the index of the first character in which they differ, $j$. If no such index exists then $X$ is lexicographically before $Y$ if $X$ is shorter than $Y$. Otherwise $X$ is lexicographically before $Y$ if $X_j$ occurs earlier in the alphabet than $Y_j$.", "inputFormat": "\\* Line $1$: A single line containing $N (1 \\le N \\le 30,000)$, the number of strings Bessie is playing with.\n\n\\* Lines $2\\sim 1+N$: Each line contains a non-empty string. The total number of characters in all strings will be no more than $300,000$. All characters in input will be lowercase characters `a` through `z`. Input will contain no duplicate strings.", "outputFormat": "\\* Line $1$: A single line containing $K$, the number of strings that could be lexicographically first.\n\n\\* Lines $2 \\sim 1+K$: The $(1+i)$ th line should contain the ith string that could be lexicographically first. Strings should be output in the same order they were given in the input.", "hint": "The example from the problem statement.\n\nOnly `omm` and `mom` can be ordered first.", "locale": "en"}, "zh-CN": {"title": "[USACO12DEC] First! G", "background": null, "description": "Bessie 一直在研究字符串。她发现，通过改变字母表的顺序，她可以按改变后的字母表来排列字符串（字典序大小排列）。\n\n例如，Bessie 发现，对于字符串 $\\texttt{omm},\\texttt{moo},\\texttt{mom}$ 和 $\\texttt{ommnom}$，她可以使用标准字母表使 $\\texttt{mom}$ 排在第一个（即字典序最小），她也可以使用字母表 $\\texttt{abcdefghijklonmpqrstuvwxyz}$ 使得 $\\texttt{omm}$ 排在第一个。然而，Bessie 想不出任何方法（改变字母表顺序）使得 $\\texttt{moo}$ 或 $\\texttt{ommnom}$ 排在第一个。\n\n接下来让我们通过重新排列字母表的顺序来计算输入中有哪些字符串可以排在第一个（即字典序最小），从而帮助 Bessie。\n\n要计算字符串 $X$ 和字符串 $Y$ 按照重新排列过的字母表顺序来排列的顺序，先找到它们第一个不同的字母 $X_i$ 与 $Y_i$，按重排后的字母表顺序比较，若 $X_i$ 比 $Y_i$ 先，则 $X$ 的字典序比 $Y$ 小，即 $X$ 排在 $Y$ 前；若没有不同的字母，则比较 $X$ 与 $Y$ 长度，若 $X$ 比 $Y$ 短，则 $X$ 的字典序比 $Y$ 小，即 $X$ 排在 $Y$ 前。", "inputFormat": "第 $1$ 行：一个数字 $N$（$1\\le N \\le 30,000$），表示 Bessie 正在研究字符串的数量。\n\n第 $2\\sim N+1$ 行：每行包含一个非空字符串。所有字符串包含的字符总数不会超过 $300,000$。输入中的所有字符都是小写字母，即 $a\\sim z$。输入不包含重复的字符串。", "outputFormat": "第 $1$ 行：一个数字 $K$，表示按重排的字母表顺序排列后可以排在第一个的字符串数量。\n\n第 $2\\sim K+1$ 行：第 $i+1$ 行包含第 $i$ 个按重排的字母表顺序排列后可以排在第一个的字符串。字符串应该按照它们在输入中的顺序来输出。", "hint": "样例即题目描述中给出的例子，只有 $\\texttt{omm}$ 和 $\\texttt{mom}$ 在各自特定的字典序下可以被排列在第一个。", "locale": "zh-CN"}}}
{"pid": "P3066", "type": "P", "difficulty": 5, "samples": [["4 5 \n1 4 \n2 3 \n1 5 \n", "3 \n2 \n1 \n1 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "USACO", "O2优化", "差分"], "title": "[USACO12DEC] Running Away From the Barn G", "background": "", "description": "给定一颗 $n$ 个点的有根树，边有边权，节点从 $1$ 至 $n$ 编号，$1$ 号节点是这棵树的根。\n\n再给出一个参数 $t$，对于树上的每个节点 $u$，请求出 $u$ 的子树中有多少节点满足该节点到 $u$ 的距离不大于 $t$。", "inputFormat": "输入的第一行是两个整数，分别表示节点数 $n$ 和给出的参数 $t$。\n\n第 $2$ 到第 $n$ 行，每行两个整数，第 $i$ 行的整数 $p_i, w_i$ 表示节点 $i$ 的父节点为 $p_i$，连结 $i$ 与 $p_i$ 的边的边权为 $w_i$。", "outputFormat": "输出 $n$ 行，每行一个整数，第 $i$ 行的整数表示 $i$ 的子树内到 $i$ 的距离不大于 $t$ 的节点个数。", "hint": "#### 数据规模与约定\n\n对于全部的测试点，保证：\n\n- $1 \\leq n \\leq 2 \\times 10^5$，$1 \\leq t \\leq 10^{18}$。\n- $1 \\leq p_i \\lt i$，$1 \\leq w_i \\leq 10^{12}$。\n\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO12DEC] Running Away From the Barn G", "background": "", "description": "Given a rooted tree with $n$ nodes and weighted edges. Nodes are numbered from $1$ to $n$, and node $1$ is the root.\n\nGiven a parameter $t$, for each node $u$, find how many nodes in the subtree of $u$ have distance to $u$ not greater than $t$.", "inputFormat": "The first line contains two integers, the number of nodes $n$ and the parameter $t$.\n\nFor each $i$ from $2$ to $n$, the $i$-th line contains two integers $p_i, w_i$, meaning the parent of node $i$ is $p_i$, and the weight of the edge connecting $i$ and $p_i$ is $w_i$.", "outputFormat": "Output $n$ lines. The $i$-th line contains an integer, the number of nodes in the subtree of $i$ whose distance to $i$ is at most $t$.", "hint": "#### Constraints\n\n- $1 \\leq n \\leq 2 \\times 10^5$, $1 \\leq t \\leq 10^{18}$.\n- $1 \\leq p_i \\lt i$, $1 \\leq w_i \\leq 10^{12}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO12DEC] Running Away From the Barn G", "background": "", "description": "给定一颗 $n$ 个点的有根树，边有边权，节点从 $1$ 至 $n$ 编号，$1$ 号节点是这棵树的根。\n\n再给出一个参数 $t$，对于树上的每个节点 $u$，请求出 $u$ 的子树中有多少节点满足该节点到 $u$ 的距离不大于 $t$。", "inputFormat": "输入的第一行是两个整数，分别表示节点数 $n$ 和给出的参数 $t$。\n\n第 $2$ 到第 $n$ 行，每行两个整数，第 $i$ 行的整数 $p_i, w_i$ 表示节点 $i$ 的父节点为 $p_i$，连结 $i$ 与 $p_i$ 的边的边权为 $w_i$。", "outputFormat": "输出 $n$ 行，每行一个整数，第 $i$ 行的整数表示 $i$ 的子树内到 $i$ 的距离不大于 $t$ 的节点个数。", "hint": "#### 数据规模与约定\n\n对于全部的测试点，保证：\n\n- $1 \\leq n \\leq 2 \\times 10^5$，$1 \\leq t \\leq 10^{18}$。\n- $1 \\leq p_i \\lt i$，$1 \\leq w_i \\leq 10^{12}$。\n\n", "locale": "zh-CN"}}}
{"pid": "P3067", "type": "P", "difficulty": 5, "samples": [["4 \n1 \n2 \n3 \n4 \n", "3 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2012", "USACO", "折半搜索 meet in the middle"], "title": "[USACO12OPEN] Balanced Cow Subsets G", "background": "", "description": "Farmer John's owns N cows (2 <= N <= 20), where cow i produces M(i) units of milk each day (1 <= M(i) <= 100,000,000).  FJ wants to streamline the process of milking his cows every day, so he installs a brand new milking machine in his barn.  Unfortunately, the machine turns out to be far too sensitive: it only works properly if the cows on the left side of the barn have the exact same total milk output as the cows on the right side of the barn!\n\nLet us call a subset of cows \"balanced\" if it can be partitioned into two groups having equal milk output.  Since only a balanced subset of cows can make the milking machine work, FJ wonders how many subsets of his N cows are balanced.  Please help him compute this quantity.\n", "inputFormat": "\\* Line 1: The integer N.\n\n\\* Lines 2..1+N: Line i+1 contains M(i). \n\n", "outputFormat": "\\* Line 1: The number of balanced subsets of cows.\n", "hint": "There are 4 cows, with milk outputs 1, 2, 3, and 4.\n\n\nThere are three balanced subsets: the subset {1,2,3}, which can be partitioned into {1,2} and {3}, the subset {1,3,4}, which can be partitioned into {1,3} and {4}, and the subset {1,2,3,4} which can be partitioned into {1,4} and {2,3}.\n", "locale": "en", "translations": {"en": {"title": "[USACO12OPEN] Balanced Cow Subsets G", "background": "", "description": "Farmer John's owns N cows (2 <= N <= 20), where cow i produces M(i) units of milk each day (1 <= M(i) <= 100,000,000).  FJ wants to streamline the process of milking his cows every day, so he installs a brand new milking machine in his barn.  Unfortunately, the machine turns out to be far too sensitive: it only works properly if the cows on the left side of the barn have the exact same total milk output as the cows on the right side of the barn!\n\nLet us call a subset of cows \"balanced\" if it can be partitioned into two groups having equal milk output.  Since only a balanced subset of cows can make the milking machine work, FJ wonders how many subsets of his N cows are balanced.  Please help him compute this quantity.\n", "inputFormat": "\\* Line 1: The integer N.\n\n\\* Lines 2..1+N: Line i+1 contains M(i). \n\n", "outputFormat": "\\* Line 1: The number of balanced subsets of cows.\n", "hint": "There are 4 cows, with milk outputs 1, 2, 3, and 4.\n\n\nThere are three balanced subsets: the subset {1,2,3}, which can be partitioned into {1,2} and {3}, the subset {1,3,4}, which can be partitioned into {1,3} and {4}, and the subset {1,2,3,4} which can be partitioned into {1,4} and {2,3}.\n", "locale": "en"}, "zh-CN": {"title": "[USACO12OPEN] Balanced Cow Subsets G", "background": "", "description": "我们定义一个奶牛集合 $S$ 是平衡的，当且仅当满足以下两个条件：\n\n- $S$ 非空。\n- $S$ 可以被**划分**成两个集合 $A,B$，满足 $A$ 里的奶牛产奶量之和等于 $B$ 里的奶牛产奶量之和。划分的含义是，$A\\cup B=S$ 且 $A\\cap B=\\varnothing$。\n\n现在给定大小为 $n$ 的奶牛集合 $S$，询问它有多少个子集是平衡的。请注意，奶牛之间是互不相同的，但是它们的产奶量可能出现相同。", "inputFormat": "第一行一个整数 $n$，表示奶牛的数目。\n\n第 $2$ 至 $n+1$ 行，每行一个数 $a_i$，表示每头奶牛的产奶量。", "outputFormat": "输出一个数表示方案总数。\n\n### 样例解释\n\n共存在三种方案。集合 $\\{1,2,3\\}$ 可以划分为 $\\{1,2\\}$ 与 $\\{3\\}$；集合 $\\{1,3,4\\}$ 可以划分为 $\\{1,3\\}$ 与 $\\{4\\}$；集合 $\\{1,2,3,4\\}$ 可以划分为 $\\{1,4\\}$ 与 $\\{2,3\\}$，共 $3$ 种子集。", "hint": "对于全部数据，保证 $1\\le n\\le 20$，$1\\le a_i\\le 10^8$。", "locale": "zh-CN"}}}
{"pid": "P3068", "type": "P", "difficulty": 3, "samples": [["10 4 \n2 1 3 \n2 3 4 \n6 1 2 3 4 6 7 \n4 4 3 2 1 \n", "4 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "USACO", "枚举", "前缀和"], "title": "[USACO13JAN] Party Invitations S", "background": "", "description": "Farmer John is throwing a party and wants to invite some of his cows to show them how much he cares about his herd.  However, he also wants to invite the smallest possible number of cows, remembering all too well the disaster that resulted the last time he invited too many cows to a party.\n\nAmong FJ's cows, there are certain groups of friends that are hard to separate.  For any such group (say, of size k), if FJ invites at least k-1 of the cows in the group to the party, then he must invite the final cow as well, thereby including the entire group.  Groups can be of any size and may even overlap with each-other, although no two groups contain exactly the same set of members.  The sum of all group sizes is at most 250,000.\n\nGiven the groups among FJ's cows, please determine the minimum number of cows FJ can invite to his party, if he decides that he must definitely start by inviting cow #1 (his cows are conveniently numbered 1..N, with N at most 1,000,000).\n\n", "inputFormat": "\\* Line 1: Two space-separated integers: N (the number of cows), and G (the number of groups).\n\n\\* Lines 2..1+G: Each line describes a group of cows.  It starts with an integer giving the size S of the group, followed by the S cows in the group (each an integer in the range 1..N).\n\n", "outputFormat": "\\* Line 1: The minimum number of cows FJ can invite to his party.\n\n\n", "hint": "There are 10 cows and 4 groups.  The first group contains cows 1 and 3, and so on.\n\n\nIn addition to cow #1, FJ must invite cow #3 (due to the first group constraint), cow #4 (due to the second group constraint), and also cow #2 (due to the final group constraint).\n\n", "locale": "en", "translations": {"en": {"title": "[USACO13JAN] Party Invitations S", "background": "", "description": "Farmer John is throwing a party and wants to invite some of his cows to show them how much he cares about his herd.  However, he also wants to invite the smallest possible number of cows, remembering all too well the disaster that resulted the last time he invited too many cows to a party.\n\nAmong FJ's cows, there are certain groups of friends that are hard to separate.  For any such group (say, of size k), if FJ invites at least k-1 of the cows in the group to the party, then he must invite the final cow as well, thereby including the entire group.  Groups can be of any size and may even overlap with each-other, although no two groups contain exactly the same set of members.  The sum of all group sizes is at most 250,000.\n\nGiven the groups among FJ's cows, please determine the minimum number of cows FJ can invite to his party, if he decides that he must definitely start by inviting cow #1 (his cows are conveniently numbered 1..N, with N at most 1,000,000).\n\n", "inputFormat": "\\* Line 1: Two space-separated integers: N (the number of cows), and G (the number of groups).\n\n\\* Lines 2..1+G: Each line describes a group of cows.  It starts with an integer giving the size S of the group, followed by the S cows in the group (each an integer in the range 1..N).\n\n", "outputFormat": "\\* Line 1: The minimum number of cows FJ can invite to his party.\n\n\n", "hint": "There are 10 cows and 4 groups.  The first group contains cows 1 and 3, and so on.\n\n\nIn addition to cow #1, FJ must invite cow #3 (due to the first group constraint), cow #4 (due to the second group constraint), and also cow #2 (due to the final group constraint).\n\n", "locale": "en"}, "zh-CN": {"title": "[USACO13JAN] Party Invitations S", "background": "", "description": "农夫约翰要举办一个聚会，他要邀请一些奶牛来参加。在约翰的奶牛朋友圈中，有一些奶牛是好基友，对于每一个奶牛朋友圈，没有一个完全与之相同的，假设这个奶牛朋友圈有 $k$ 头奶牛，如果约翰已经邀请了 $k-1$ 头，那么剩下的那头牛也得邀请。约翰想让你告诉他，他最少需要邀请多少头奶牛？我们假设 $1$ 号奶牛已经被邀请了。", "inputFormat": "第一行 $N$ 和 $G$ 表示共有 $N$ 头奶牛和 $G$ 个朋友圈。\n\n接下来 $G$ 行，每行开头输入一个整数 $k$，表示朋友圈里有 $k$ 头牛，接着输入 $k$ 个整数，表示朋友圈里的牛。", "outputFormat": "一行，一个整数，表示约翰最少需要邀请的牛的头数。", "hint": "$1 \\leq  N\\leq10^6$。\n\n设所有的奶牛朋友圈的大小之和为 $M$，则 $1 \\leq  M\\leq2.5\\times10^5$。", "locale": "zh-CN"}}}
{"pid": "P3069", "type": "P", "difficulty": 4, "samples": [["9 1 \n2 \n7 \n3 \n7 \n7 \n3 \n7 \n5 \n7 \n", "4 \n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [129000, 129000, 129000, 129000, 129000, 129000, 129000, 129000, 129000, 129000]}, "tags": ["2013", "USACO", "树状数组", "单调队列", "队列", "双指针 two-pointer"], "title": "[USACO13JAN] Cow Lineup G", "background": null, "description": "Farmer John (FJ) 的 $N (1 \\le N \\le 10^5)$ 只奶牛排成了一队，每只牛都用编上了一个“血统编号”，该编号为范围 $0$ 至 $10^9$ 的整数。血统相同的奶牛有相同的编号，也就是可能有多头奶牛是相同的“血统编号”。\n\nFJ 觉得如果连续排列的一段奶牛有相同的血统编号的话，奶牛们看起来会更具有威猛。为了创造这样的连续段，约翰最多能选出 $k$ 种血统的奶牛，并把他们全部从队列中赶走。\n\n请帮助 FJ 计算这样做能得到的由相同血统编号的牛构成的连续段的长度最大是多少？", "inputFormat": "第 $1$ 行：两个用空格隔开的整数 $N$ 和 $K$。\n\n第 $2$ 到 $1+N$ 行：第 $i+1$ 行包含品种 ID $B(i)$。", "outputFormat": "第 1 行：FJ 能创造出的具有相同品种 ID 的连续奶牛块的最大长度。", "hint": "有 $9$ 头牛排成一队，品种 ID 分别为 $2, 7, 3, 7, 7, 3, 7, 5, 7$。FJ 希望从这队中移除最多 1 种品种 ID。\n\n通过移除所有品种 ID 为 $3$ 的奶牛，队伍变为 $2, 7, 7, 7, 7, 5, 7$。在这个新的队伍中，有一个由 $4$ 头品种 ID 相同（均为 $7$）的奶牛组成的连续块。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO13JAN] Cow Lineup G", "background": "", "description": "Farmer John (FJ) has $N$ cows ($1 \\le N \\le 100\\,000$) standing in a row. Each cow has an integer breed ID in the range $0 \\ldots 1\\,000\\,000\\,000$; the breed ID of the $i$-th cow is $B(i)$. Multiple cows may share the same breed ID.\n\nFJ may choose up to $K$ breed IDs and remove from the lineup all cows having those IDs. Determine the maximum possible length of a contiguous block of cows in which all remaining cows have the same breed ID.", "inputFormat": "- Line 1: Two space-separated integers $N$ and $K$.\n- Lines 2 to $1+N$: Line $i+1$ contains $B(i)$.", "outputFormat": "- Line 1: The maximum size of a contiguous block of cows with identical breed IDs that FJ can obtain.", "hint": "There are 9 cows in the lineup with breed IDs 2, 7, 3, 7, 7, 3, 7, 5, 7. FJ would like to remove up to 1 breed ID.\n\nBy removing all cows with breed ID 3, the lineup becomes 2, 7, 7, 7, 7, 5, 7. In this new lineup, there is a contiguous block of 4 cows with the same breed ID (7).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO13JAN] Cow Lineup G", "background": null, "description": "Farmer John (FJ) 的 $N (1 \\le N \\le 10^5)$ 只奶牛排成了一队，每只牛都用编上了一个“血统编号”，该编号为范围 $0$ 至 $10^9$ 的整数。血统相同的奶牛有相同的编号，也就是可能有多头奶牛是相同的“血统编号”。\n\nFJ 觉得如果连续排列的一段奶牛有相同的血统编号的话，奶牛们看起来会更具有威猛。为了创造这样的连续段，约翰最多能选出 $k$ 种血统的奶牛，并把他们全部从队列中赶走。\n\n请帮助 FJ 计算这样做能得到的由相同血统编号的牛构成的连续段的长度最大是多少？", "inputFormat": "第 $1$ 行：两个用空格隔开的整数 $N$ 和 $K$。\n\n第 $2$ 到 $1+N$ 行：第 $i+1$ 行包含品种 ID $B(i)$。", "outputFormat": "第 1 行：FJ 能创造出的具有相同品种 ID 的连续奶牛块的最大长度。", "hint": "有 $9$ 头牛排成一队，品种 ID 分别为 $2, 7, 3, 7, 7, 3, 7, 5, 7$。FJ 希望从这队中移除最多 1 种品种 ID。\n\n通过移除所有品种 ID 为 $3$ 的奶牛，队伍变为 $2, 7, 7, 7, 7, 5, 7$。在这个新的队伍中，有一个由 $4$ 头品种 ID 相同（均为 $7$）的奶牛组成的连续块。", "locale": "zh-CN"}}}
{"pid": "P3070", "type": "P", "difficulty": 5, "samples": [["5 4 \nXX.S \n.S.. \nSXSS \nS.SX \n..SX \n", "3 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "USACO", "广度优先搜索 BFS", "状压 DP"], "title": "[USACO13JAN] Island Travels G", "background": null, "description": "农夫约翰带着奶牛去海边度假了。\n\n奶牛们住在 $N$ 个岛屿上（$1 \\le N \\le 15$），这些岛屿位于 $R \\times C$ 的方格矩阵中（$1 \\le R,C \\le 50$）。\n\n岛屿是标记为 `X` 的方格，如果两个 `X` 共享一条边，则这两个 `X` 是相连的。（因此，共享一个角的两个 `X` 不一定相连）\n\n然后，贝茜来晚了，所以她要和约翰一起乘坐直升飞机过去。\n\n她可以选择任何一个岛屿并首先到达该岛。\n\n她想看望每头奶牛至少一次，因此，她需要在岛屿之间旅行，直到她去过每个岛屿至少一次为止。\n\n由于约翰的直升飞机燃料快用完了，所以直到奶牛们玩够了回家之前，他都不想动用这架飞机。\n\n幸运的是有一些方格区域是浅水区，用 `S` 表示。\n\n贝茜可以在浅水区沿四个基本方向游动，以便在各岛之间穿行。\n\n她还可以在岛屿和浅水区之间沿四个基本方向行进，反之亦然。\n\n请求出贝茜为了成功抵达所有岛屿所需要的最短游泳距离。\n\n游泳距离是指贝茜在行进过程中到达标有 `S` 的方格区域的次数。\n\n看完该地区的地图后，贝茜知道自己一定能成功抵达所有岛屿。", "inputFormat": "第一行包含两个整数 $R$ 和 $C$。\n\n接下来 $R$ 行，每行包含 $C$ 个字符用来描述方格矩阵。字符 . 表示深水方格区域，`X` 表示岛屿方格区域，`S` 表示浅水方格区域。", "outputFormat": "输出贝茜为了成功抵达所有岛屿所需要的最短游泳距离。", "hint": "贝茜可以在左上角岛屿着陆，然后按照右、下、下、右、右、下、下的方式行进，抵达所有岛屿。\n\n期间共处于 `S` 方格中 $3$ 次。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO13JAN] Island Travels G", "background": "", "description": "Farmer John has taken the cows to a vacation out on the ocean! The cows are living on N (1 <= N <= 15) islands, which are located on an R x C grid (1 <= R, C <= 50). An island is a maximal connected group of squares on the grid that are marked as 'X', where two 'X's are connected if they share a side. (Thus, two 'X's sharing a corner are not necessarily connected.)\n\nBessie, however, is arriving late, so she is coming in with FJ by helicopter. Thus, she can first land on any of the islands she chooses. She wants to visit all the cows at least once, so she will travel between islands until she has visited all N of the islands at least once.\n\nFJ's helicopter doesn't have much fuel left, so he doesn't want to use it until the cows decide to go home. Fortunately, some of the squares in the grid are shallow water, which is denoted by 'S'. Bessie can swim through these squares in the four cardinal directions (north, east, south, west) in order to travel between the islands. She can also travel (in the four cardinal directions) between an island and shallow water, and vice versa.\n\nFind the minimum distance Bessie will have to swim in order to visit all of the islands. (The distance Bessie will have to swim is the number of distinct times she is on a square marked 'S'.) After looking at a map of the area, Bessie knows this will be possible.\n\nYou are given an R x C map with three types of terrain: 'S', 'X', and '.'. Adjacency and movement are all 4-connected. Let 'X' be land, and an 'X' connected component be an island; 'S' is shallow water; '.' is deep water. Initially, you may land on any land square. You can walk on land and swim in shallow water. Land and shallow water are mutually passable in the four cardinal directions, but you may never enter deep water. Your goal is to move by walking and swimming so that you visit every island at least once. Question: what is the minimum number of shallow water squares you must pass through? It is guaranteed that a solution exists.", "inputFormat": "* Line 1: Two space-separated integers: R and C.\n* Lines 2..R+1: Line i+1 contains C characters giving row i of the grid. Deep water squares are marked as '.', island squares are marked as 'X', and shallow water squares are marked as 'S'.", "outputFormat": "* Line 1: A single integer representing the minimum distance Bessie has to swim to visit all islands.", "hint": "There are three islands with shallow water paths connecting some of them.\n\nBessie can travel from the island in the top left to the one in the middle, swimming 1 unit, and then travel from the middle island to the one in the bottom right, swimming 2 units, for a total of 3 units.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO13JAN] Island Travels G", "background": null, "description": "农夫约翰带着奶牛去海边度假了。\n\n奶牛们住在 $N$ 个岛屿上（$1 \\le N \\le 15$），这些岛屿位于 $R \\times C$ 的方格矩阵中（$1 \\le R,C \\le 50$）。\n\n岛屿是标记为 `X` 的方格，如果两个 `X` 共享一条边，则这两个 `X` 是相连的。（因此，共享一个角的两个 `X` 不一定相连）\n\n然后，贝茜来晚了，所以她要和约翰一起乘坐直升飞机过去。\n\n她可以选择任何一个岛屿并首先到达该岛。\n\n她想看望每头奶牛至少一次，因此，她需要在岛屿之间旅行，直到她去过每个岛屿至少一次为止。\n\n由于约翰的直升飞机燃料快用完了，所以直到奶牛们玩够了回家之前，他都不想动用这架飞机。\n\n幸运的是有一些方格区域是浅水区，用 `S` 表示。\n\n贝茜可以在浅水区沿四个基本方向游动，以便在各岛之间穿行。\n\n她还可以在岛屿和浅水区之间沿四个基本方向行进，反之亦然。\n\n请求出贝茜为了成功抵达所有岛屿所需要的最短游泳距离。\n\n游泳距离是指贝茜在行进过程中到达标有 `S` 的方格区域的次数。\n\n看完该地区的地图后，贝茜知道自己一定能成功抵达所有岛屿。", "inputFormat": "第一行包含两个整数 $R$ 和 $C$。\n\n接下来 $R$ 行，每行包含 $C$ 个字符用来描述方格矩阵。字符 . 表示深水方格区域，`X` 表示岛屿方格区域，`S` 表示浅水方格区域。", "outputFormat": "输出贝茜为了成功抵达所有岛屿所需要的最短游泳距离。", "hint": "贝茜可以在左上角岛屿着陆，然后按照右、下、下、右、右、下、下的方式行进，抵达所有岛屿。\n\n期间共处于 `S` 方格中 $3$ 次。", "locale": "zh-CN"}}}
{"pid": "P3071", "type": "P", "difficulty": 5, "samples": [["10 4 \nA 6 \nL 2 4 \nA 5 \nA 2 \n", "1 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "线段树", "USACO", "单调队列", "离散化", "队列"], "title": "[USACO13JAN] Seating G", "background": null, "description": "为了赚些外快，奶牛们在她们的牛棚里开了一家专门供应奶昔的餐厅。餐厅有一排 $N$ 个座位，编号从 $1$ 到 $N$（$1 \\le N \\le 5\\times 10^5$）。初始时，所有座位都是空的。\n\n在这一天中，会按顺序发生 $M$ 个事件（$1 \\le M \\le 3\\times 10^5$）。每个事件是以下两种之一：\n\n1.  一个规模为 $p$ 的团队到达（$1 \\le p \\le N$）。Bessie 希望将这个团队安排在一个连续的 $p$ 个空座位上。如果可能，她会将其安排在起始位置编号最小的那个连续空位区间。如果不可能，则该团队会被拒之门外。\n2.  给定一个范围 $[a, b]$（$1 \\le a \\le b \\le N$），该范围内的所有座位上的奶牛都会离开。\n\n请帮助 Bessie 统计这一天中被拒之门外的团队数量。", "inputFormat": "第 1 行：两个用空格隔开的整数 $N$ 和 $M$。\n\n第 $2$ 到 $M+1$ 行：每行描述一个事件，格式为 `A p`（表示一个规模为 $p$ 的团队到达）或 `L a b`（表示 $[a, b]$ 范围内的所有奶牛离开）。", "outputFormat": "第 $1$ 行：被拒之门外的团队数量。", "hint": "样例解释：\n\n共有 $10$ 个座位和 $4$ 个事件。首先，一个 $6$ 头奶牛的团队到达。然后座位 $2$ 到 $4$ 上的所有奶牛离开。接着，一个 $5$ 头奶牛的团队到达，之后是一个 $2$ 头奶牛的团队。\n\n团队 #3 被拒之门外。所有其他团队都得到了安排。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO13JAN] Seating G", "background": "", "description": "To earn some extra money, the cows have opened a restaurant in their barn specializing in milkshakes. The restaurant has $N$ seats in a row, numbered $1$ to $N$ ($1 \\le N \\le 500\\,000$). Initially, all seats are empty.\n\nThroughout the day, there are $M$ events that happen in sequence ($1 \\le M \\le 300\\,000$). Each event is one of the following:\n\n1. A party of size $p$ arrives ($1 \\le p \\le N$). Bessie wants to seat the party in a contiguous block of $p$ empty seats. If this is possible, she seats them in the block whose starting position has the smallest index. If it is impossible, the party is turned away.\n2. A range $[a, b]$ is given ($1 \\le a \\le b \\le N$), and everybody in that range of seats leaves.\n\nPlease help Bessie count the total number of parties that are turned away over the course of the day.", "inputFormat": "- Line 1: Two space-separated integers $N$ and $M$.\n- Lines $2$ to $M+1$: Each line describes a single event, either of the form \"A p\" (a party of size $p$ arrives) or \"L a b\" (all cows in the range $[a, b]$ leave).", "outputFormat": "- Line 1: The number of parties that are turned away.", "hint": "There are 10 seats and 4 events. First, a party of 6 cows arrives. Then all cows in seats 2..4 depart. Next, a party of 5 arrives, followed by a party of 2.\n\nParty #3 is turned away. All other parties are seated.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO13JAN] Seating G", "background": null, "description": "为了赚些外快，奶牛们在她们的牛棚里开了一家专门供应奶昔的餐厅。餐厅有一排 $N$ 个座位，编号从 $1$ 到 $N$（$1 \\le N \\le 5\\times 10^5$）。初始时，所有座位都是空的。\n\n在这一天中，会按顺序发生 $M$ 个事件（$1 \\le M \\le 3\\times 10^5$）。每个事件是以下两种之一：\n\n1.  一个规模为 $p$ 的团队到达（$1 \\le p \\le N$）。Bessie 希望将这个团队安排在一个连续的 $p$ 个空座位上。如果可能，她会将其安排在起始位置编号最小的那个连续空位区间。如果不可能，则该团队会被拒之门外。\n2.  给定一个范围 $[a, b]$（$1 \\le a \\le b \\le N$），该范围内的所有座位上的奶牛都会离开。\n\n请帮助 Bessie 统计这一天中被拒之门外的团队数量。", "inputFormat": "第 1 行：两个用空格隔开的整数 $N$ 和 $M$。\n\n第 $2$ 到 $M+1$ 行：每行描述一个事件，格式为 `A p`（表示一个规模为 $p$ 的团队到达）或 `L a b`（表示 $[a, b]$ 范围内的所有奶牛离开）。", "outputFormat": "第 $1$ 行：被拒之门外的团队数量。", "hint": "样例解释：\n\n共有 $10$ 个座位和 $4$ 个事件。首先，一个 $6$ 头奶牛的团队到达。然后座位 $2$ 到 $4$ 上的所有奶牛离开。接着，一个 $5$ 头奶牛的团队到达，之后是一个 $2$ 头奶牛的团队。\n\n团队 #3 被拒之门外。所有其他团队都得到了安排。", "locale": "zh-CN"}}}
{"pid": "P3072", "type": "P", "difficulty": 5, "samples": [["8 \n10005 200003 \n10005 200004 \n10008 200004 \n10005 200005 \n10006 200003 \n10007 200003 \n10007 200004 \n10006 200005 \n", "14 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "线段树", "USACO", "深度优先搜索 DFS"], "title": "[USACO13FEB] Perimeter S", "background": "征求翻译。如果你能提供翻译或者题意简述，请直接发讨论，感谢你的贡献。\n", "description": "Farmer John has arranged N hay bales (1 <= N <= 50,000) in the middle of one of his fields.  If we think of the field as a 1,000,000 x 1,000,000 grid of 1 x 1 square cells, each hay bale occupies exactly one of these cells (no two hay bales occupy the same cell, of course).\n\nFJ notices that his hay bales all form one large connected region, meaning that starting from any bale, one can reach any other bale by taking a series of steps either north, south, east, or west onto directly adjacent bales.  The connected region of hay bales may however contain \"holes\" -- empty regions that are completely surrounded by hay bales.\n\nPlease help FJ determine the perimeter of the region formed by his hay bales.  Note that holes do not contribute to the perimeter.\n", "inputFormat": "\\* Line 1: The number of hay bales, N.\n\n\\* Lines 2..1+N: Each line contains the (x,y) location of a single hay bale, where x and y are integers both in the range\n\n1..1,000,000. Position (1,1) is the lower-left cell in FJ's field, and position (1000000,1000000) is the upper-right cell.\n", "outputFormat": "\\* Line 1: The perimeter of the connected region of hay bales.\n", "hint": "The connected region consisting of hay bales looks like this:\n\nXX\nX XX\nXXX\n\nThe length of the perimeter of the connected region is 14 (for example, the left side of the region contributes a length of 3 to this total).  Observe that the hole in the middle does not contribute to this number.\n", "locale": "en", "translations": {"en": {"title": "[USACO13FEB] Perimeter S", "background": "征求翻译。如果你能提供翻译或者题意简述，请直接发讨论，感谢你的贡献。\n", "description": "Farmer John has arranged N hay bales (1 <= N <= 50,000) in the middle of one of his fields.  If we think of the field as a 1,000,000 x 1,000,000 grid of 1 x 1 square cells, each hay bale occupies exactly one of these cells (no two hay bales occupy the same cell, of course).\n\nFJ notices that his hay bales all form one large connected region, meaning that starting from any bale, one can reach any other bale by taking a series of steps either north, south, east, or west onto directly adjacent bales.  The connected region of hay bales may however contain \"holes\" -- empty regions that are completely surrounded by hay bales.\n\nPlease help FJ determine the perimeter of the region formed by his hay bales.  Note that holes do not contribute to the perimeter.\n", "inputFormat": "\\* Line 1: The number of hay bales, N.\n\n\\* Lines 2..1+N: Each line contains the (x,y) location of a single hay bale, where x and y are integers both in the range\n\n1..1,000,000. Position (1,1) is the lower-left cell in FJ's field, and position (1000000,1000000) is the upper-right cell.\n", "outputFormat": "\\* Line 1: The perimeter of the connected region of hay bales.\n", "hint": "The connected region consisting of hay bales looks like this:\n\nXX\nX XX\nXXX\n\nThe length of the perimeter of the connected region is 14 (for example, the left side of the region contributes a length of 3 to this total).  Observe that the hole in the middle does not contribute to this number.\n", "locale": "en"}, "zh-CN": {"title": "[USACO13FEB] Perimeter S", "background": null, "description": "农夫约翰已经在他的一片田地中间放置了 $n$ 个干草堆。我们可以认为这片田地是由 $10^6 \\times 10^6$ 个小方格组成的矩阵，每个干草堆占据一个小方格（当然，没有两堆干草占据同一个格子）。\n\nFJ 注意到他的干草堆组成了一个大的连通块，这就意味着从任何一个草堆走起，可以通过相邻草堆走若干步到达其他任意的草堆。这个连通块的内部可能包含若干个“洞”——被干草堆完全包围的空白格子。\n\n请帮助FJ计算整个连通块的周长。计算周长时请不要考虑“洞”。", "inputFormat": "第 $1$ 行：干草堆的数量 $n$。\n\n第 $2 \\sim n + 1$ 行：每行两个数，表示干草堆的坐标 $(x, y)$。", "outputFormat": "连通块的周长 $p$。", "hint": "对所有的数据，满足 $1 \\leq n \\leq 5 \\times 10^4$，$1 \\leq x, y \\leq 10^6$。", "locale": "zh-CN"}}}
{"pid": "P3073", "type": "P", "difficulty": 4, "samples": [["5 \n0 0 0 3 3 \n0 0 0 0 3 \n0 9 9 3 3 \n9 9 9 3 3 \n9 9 9 9 3 \n", "3 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2013", "二分", "USACO", "并查集", "排序", "生成树"], "title": "[USACO13FEB] Tractor S", "background": "", "description": "One of Farmer John's fields is particularly hilly, and he wants to purchase a new tractor to drive around on it.  The field is described by an N x N grid of non-negative integer elevations (1 <= N <= 500).  A tractor capable of moving from one grid cell to an adjacent cell (one step north, east, south, or west) of height difference D costs exactly D units of money.\n\nFJ would like to pay enough for his tractor so that, starting from some grid cell in his field, he can successfully drive the tractor around to visit at least half the grid cells in the field (if the number of total cells in the field is odd, he wants to visit at least half the cells rounded up).  Please help him compute the minimum cost necessary for buying a tractor capable of this task.\n", "inputFormat": "\\* Line 1: The value of N.\n\n\\* Lines 2..1+N: Each line contains N space-separated non-negative integers (each at most 1 million) specifying a row of FJ's field.\n\n\n\n\n", "outputFormat": "\\* Line 1: The minimum cost of a tractor that is capable of driving around at least half of FJ's field.\n\n\n", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO13FEB] Tractor S", "background": "", "description": "One of Farmer John's fields is particularly hilly, and he wants to purchase a new tractor to drive around on it.  The field is described by an N x N grid of non-negative integer elevations (1 <= N <= 500).  A tractor capable of moving from one grid cell to an adjacent cell (one step north, east, south, or west) of height difference D costs exactly D units of money.\n\nFJ would like to pay enough for his tractor so that, starting from some grid cell in his field, he can successfully drive the tractor around to visit at least half the grid cells in the field (if the number of total cells in the field is odd, he wants to visit at least half the cells rounded up).  Please help him compute the minimum cost necessary for buying a tractor capable of this task.\n", "inputFormat": "\\* Line 1: The value of N.\n\n\\* Lines 2..1+N: Each line contains N space-separated non-negative integers (each at most 1 million) specifying a row of FJ's field.\n\n\n\n\n", "outputFormat": "\\* Line 1: The minimum cost of a tractor that is capable of driving around at least half of FJ's field.\n\n\n", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO13FEB] Tractor S", "background": null, "description": "FJ 有块农田太崎岖了，他要买一辆新拖拉机才能在这里巡视。这块农田由 $N \\times N$ 个格子的非负整数表示高度（$1 \\le N \\le 500$）。拖拉机从当前格子走到相邻格子（东、南、西、北四个方向）的代价为高度差 $D$，则 FJ 驶过这两个格子的拖拉机最少也要值 $D$ 块钱。\n\nFJ 愿意花足够的钱买一辆新的拖拉机使得他能以最小的高度差走遍所有格子的一半（如果格子总数是奇数，那么一半的值为四舍五入的值）。因为 FJ 很懒，所以他找到你帮他编程计算他最小需要花多少钱买到符合这些要求的拖拉机。", "inputFormat": "第一行为一个整数 $N$。\n\n第 $2$ 到 $N+1$ 行每行包含 $N$ 个非负整数（不超过 $10^6$），表示当前格子的高度。", "outputFormat": "共一行，表示 FJ 买拖拉机要花的最小价钱。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P3074", "type": "P", "difficulty": 3, "samples": [["3 1 \n10 \n5 \n6 \n3 2 \n", "11 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2013", "USACO", "枚举", "拓扑排序"], "title": "[USACO13FEB] Milk Scheduling S", "background": null, "description": "农夫约翰有 $N$ 头奶牛（$1 \\leq N \\leq 10^4$），编号为 $1$ 到 $N$。每头奶牛 $i$ 挤奶需要 $T_i$ 单位时间。由于牛棚的布局限制，某些奶牛必须在其他奶牛之前完成挤奶。例如，若奶牛 $A$ 必须在奶牛 $B$ 之前挤奶，则必须先将奶牛 $A$ 完全挤奶完成后，才能开始给奶牛 $B$ 挤奶。\n\n为了尽快完成挤奶，约翰雇用了大量工人，可以同时为任意多头奶牛挤奶。但由于存在先后顺序约束，整个挤奶过程仍需遵循特定顺序。请计算挤奶过程的最短总时间。", "inputFormat": "- 第一行：两个整数 $N$（奶牛数量）和 $M$（约束条件数量，$1 \\leq M \\leq 5\\times 10^4$）。\n- 第 $2$ 至 $N+1$ 行：每行一个整数 $T_i$，表示第 $i$ 头奶牛的挤奶时间（$1 \\leq T_i \\leq 10^5$）。\n- 第 $N+2$ 至 $N+M+1$ 行：每行两个整数 $A$ 和 $B$，表示奶牛 $A$ 必须完全挤奶后，才能开始挤奶牛 $B$。所有约束条件不会形成循环，保证有解。", "outputFormat": "- **一行**：输出完成所有挤奶的最短总时间。", "hint": "共有 $3$ 头奶牛，挤奶时间分别为 $10,5,6$。奶牛 $3$ 必须在奶牛 $2$ 之前完成挤奶。  \n\n初始时，奶牛 $1$ 和 $3$ 可同时挤奶（耗时 $10$ 和 $6$）。奶牛 $3$ 完成后，开始挤奶牛 $2$（总耗时 $6 + 5 = 11$）。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO13FEB] Milk Scheduling S", "background": "", "description": "Farmer John has $N$ cows ($1 \\leq N \\leq 10^4$), numbered from $1$ to $N$. Milking cow $i$ takes $T_i$ units of time. Due to the barn layout, some cows must finish milking before others can start. For example, if cow $A$ must be milked before cow $B$, then cow $A$ must be completely milked before starting cow $B$.\n\nTo finish as quickly as possible, John has hired many workers and can milk any number of cows simultaneously. However, the precedence constraints must still be respected. Compute the minimum total time to finish all milking.", "inputFormat": "- The first line: two integers $N$ (number of cows) and $M$ (number of constraints, $1 \\leq M \\leq 5\\times 10^4$).\n- Lines $2$ through $N+1$: each line contains one integer $T_i$, the milking time of cow $i$ ($1 \\leq T_i \\leq 10^5$).\n- Lines $N+2$ through $N+M+1$: each line contains two integers $A$ and $B$, meaning cow $A$ must be completely milked before starting cow $B$. All constraints are acyclic, so a solution is guaranteed.", "outputFormat": "- One line: the minimum total time to complete all milking.", "hint": "There are $3$ cows with milking times $10, 5, 6$. Cow $3$ must finish before cow $2$.  \n\nInitially, cows $1$ and $3$ can be milked simultaneously (taking $10$ and $6$). After cow $3$ finishes, start cow $2$ (total time $6 + 5 = 11$).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO13FEB] Milk Scheduling S", "background": null, "description": "农夫约翰有 $N$ 头奶牛（$1 \\leq N \\leq 10^4$），编号为 $1$ 到 $N$。每头奶牛 $i$ 挤奶需要 $T_i$ 单位时间。由于牛棚的布局限制，某些奶牛必须在其他奶牛之前完成挤奶。例如，若奶牛 $A$ 必须在奶牛 $B$ 之前挤奶，则必须先将奶牛 $A$ 完全挤奶完成后，才能开始给奶牛 $B$ 挤奶。\n\n为了尽快完成挤奶，约翰雇用了大量工人，可以同时为任意多头奶牛挤奶。但由于存在先后顺序约束，整个挤奶过程仍需遵循特定顺序。请计算挤奶过程的最短总时间。", "inputFormat": "- 第一行：两个整数 $N$（奶牛数量）和 $M$（约束条件数量，$1 \\leq M \\leq 5\\times 10^4$）。\n- 第 $2$ 至 $N+1$ 行：每行一个整数 $T_i$，表示第 $i$ 头奶牛的挤奶时间（$1 \\leq T_i \\leq 10^5$）。\n- 第 $N+2$ 至 $N+M+1$ 行：每行两个整数 $A$ 和 $B$，表示奶牛 $A$ 必须完全挤奶后，才能开始挤奶牛 $B$。所有约束条件不会形成循环，保证有解。", "outputFormat": "- **一行**：输出完成所有挤奶的最短总时间。", "hint": "共有 $3$ 头奶牛，挤奶时间分别为 $10,5,6$。奶牛 $3$ 必须在奶牛 $2$ 之前完成挤奶。  \n\n初始时，奶牛 $1$ 和 $3$ 可同时挤奶（耗时 $10$ 和 $6$）。奶牛 $3$ 完成后，开始挤奶牛 $2$（总耗时 $6 + 5 = 11$）。", "locale": "zh-CN"}}}
{"pid": "P3075", "type": "P", "difficulty": 5, "samples": [["3 2 \n1 1 2 \n1 1 2 \n2 2 4 \n", "4 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "USACO"], "title": "[USACO13FEB] Partitioning the Farm G", "background": "", "description": "Farmer John's farm is divided into an N x N square grid of pastures (2 <= N <= 15). Right now, there is a fence around the outside of the farm, but cows can move freely from pasture to pasture.\n\nFarmer John has decided to build fences to separate the cows from each other. Because of zoning laws, each fence must be a horizontal or vertical line going across the entire farm and fences cannot go through pastures. Farmer John only has enough money to build at most K fences (1 <= K <= 2N - 2).\n\nFarmer John wants to build the fences in order to minimize the size of the largest resulting group of cows (two cows are in the same group if they can reach each other without going through any fences). Given the current number of cows in each pasture, help Farmer John compute the size of the largest group of cows if he builds the fences optimally.\n\n给出一个n\\*n的矩阵，用k条水平或竖直直线分割矩阵，最小化区域和最大值。\n", "inputFormat": "\\* Line 1: Two integers, N and K\n\n\\* Lines 2..1+N: There are N numbers per line, describing the cows in each pasture for one row of the farm (there are at least 0 and at most 1000 cows in each pasture)\n", "outputFormat": "\\* Line 1: The minimum possible size of the largest group of cows.\n", "hint": "Farmer John should build fences between columns 2 and 3 and between rows 2 and 3, which creates 4 groups each with 4 cows.\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO13FEB] Partitioning the Farm G", "background": "", "description": "Farmer John's farm is divided into an $N \\times N$ square grid of pastures ($2 \\le N \\le 15$). Right now, there is a fence around the outside of the farm, but cows can move freely from pasture to pasture.\n\nFarmer John has decided to build fences to separate the cows from each other. Because of zoning laws, each fence must be a horizontal or vertical line that goes across the entire farm, and fences cannot go through pastures. Farmer John only has enough money to build at most $K$ fences ($1 \\le K \\le 2N - 2$).\n\nFarmer John wants to build the fences to minimize the size of the largest resulting group of cows (two cows are in the same group if they can reach each other without going through any fences). Given the current number of cows in each pasture, help Farmer John compute the size of the largest group of cows if he builds the fences optimally.\n\nGiven an $N \\times N$ matrix, use $K$ horizontal or vertical lines to partition the matrix and minimize the maximum sum over all regions.", "inputFormat": "- Line 1: Two integers, $N$ and $K$.\n- Lines $2..1+N$: There are $N$ numbers per line, describing the cows in each pasture for one row of the farm (there are at least $0$ and at most $1000$ cows in each pasture).", "outputFormat": "- Line 1: The minimum possible size of the largest group of cows.", "hint": "Farmer John should build fences between columns 2 and 3 and between rows 2 and 3, which creates 4 groups each with 4 cows.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO13FEB] Partitioning the Farm G", "background": "", "description": "Farmer John's farm is divided into an N x N square grid of pastures (2 <= N <= 15). Right now, there is a fence around the outside of the farm, but cows can move freely from pasture to pasture.\n\nFarmer John has decided to build fences to separate the cows from each other. Because of zoning laws, each fence must be a horizontal or vertical line going across the entire farm and fences cannot go through pastures. Farmer John only has enough money to build at most K fences (1 <= K <= 2N - 2).\n\nFarmer John wants to build the fences in order to minimize the size of the largest resulting group of cows (two cows are in the same group if they can reach each other without going through any fences). Given the current number of cows in each pasture, help Farmer John compute the size of the largest group of cows if he builds the fences optimally.\n\n给出一个n\\*n的矩阵，用k条水平或竖直直线分割矩阵，最小化区域和最大值。\n", "inputFormat": "\\* Line 1: Two integers, N and K\n\n\\* Lines 2..1+N: There are N numbers per line, describing the cows in each pasture for one row of the farm (there are at least 0 and at most 1000 cows in each pasture)\n", "outputFormat": "\\* Line 1: The minimum possible size of the largest group of cows.\n", "hint": "Farmer John should build fences between columns 2 and 3 and between rows 2 and 3, which creates 4 groups each with 4 cows.\n", "locale": "zh-CN"}}}
{"pid": "P3076", "type": "P", "difficulty": 5, "samples": [["2 10 \n0 9 \n6 5 \n", "12 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2013", "USACO"], "title": "[USACO13FEB] Taxi G", "background": null, "description": "Bessie is running a taxi service for the other cows on the farm.  The cows have been gathering at different locations along a fence of length M (1 <= M <= 1,000,000,000).  Unfortunately, they have grown bored with their current locations and each wish to go somewhere else along the fence.  Bessie must pick up each of her friends at their starting positions and drive them to their destinations.  Bessie's car is small so she can only transport one cow in her car at a time.  Cows can enter and exit the car instantaneously.\n\nTo save gas, Bessie would like to minimize the amount she has to drive.  Given the starting and ending positions of each of the N cows (1 <= N <= 100,000), determine the least amount of driving Bessie has to do.  Bessie realizes that to save the most gas she may need to occasionally drop a cow off at a position other than her destination.\n\nBessie starts at the leftmost point of the fence, position 0, and must finish her journey at the rightmost point on the fence, position M.\n\n长度为 $M(1 \\le M \\le 10^9) $ 的栅栏上，有 $N(1 \\le N \\le 10^5)$ 头牛需要坐车前往别的地方，起点和终点分别为 $a_i$ 和 $b_i(0 \\le a_i,b_i \\le M)$ 。现在一辆出租车从最左端 $0$ 出发，要运送完所有牛，最后到达最右端 $M$ ，求最小路程。出租车只能一次载一只牛。\n\n**注意：你可以中途将所载的牛放下去，再载别的牛，可以通过样例二辅助理解。**", "inputFormat": "\\* Line 1: N and M separated by a space.\n\n\\* Lines 2..1+N: The (i+1)th line contains two space separated\n\nintegers, s\\_i and t\\_i (0 <= s\\_i, t\\_i <= M), indicating the starting position and destination position of the ith cow.", "outputFormat": "\\* Line 1: A single integer indicating the total amount of driving Bessie must do.  Note that the result may not fit into a 32 bit integer.", "hint": "There are two cows waiting to be transported along a fence of length 10. The first cow wants to go from position 0 (where Bessie starts) to position 9.  The second cow wishes to go from position 6 to position 5.\n\n\nBessie picks up the first cow at position 0 and drives to position 6. There she drops off the first cow, delivers the second cow to her destination and returns to pick up the first cow.  She drops off the first cow and then drives the remainder of the way to the right side of the fence.", "locale": "zh-CN", "translations": {"en": {"title": "[USACO13FEB] Taxi G", "background": "", "description": "Bessie runs a taxi service for the other cows along a fence of length $M$ ($1 \\le M \\le 10^9$). There are $N$ cows ($1 \\le N \\le 10^5$). Cow $i$ starts at position $a_i$ and wants to go to position $b_i$ ($0 \\le a_i, b_i \\le M$). Bessie starts at the leftmost point, position $0$, must finish at the rightmost point, position $M$, and wants to minimize the total distance she drives.\n\nBessie’s car can carry only one cow at a time. Cows can enter and exit the car instantaneously. To save gas, Bessie may drop a cow off at an intermediate position before reaching that cow’s destination.\n\nDetermine the minimum total distance Bessie must drive to complete all rides and end at position $M$.", "inputFormat": "- Line 1: $N$ and $M$ separated by a space.\n- Lines $2..1+N$: The $(i+1)$‑th line contains two space‑separated integers, $s\\_i$ and $t\\_i$ ($0 \\le s\\_i, t\\_i \\le M$), indicating the starting position and destination position of the $i$‑th cow.", "outputFormat": "- Line 1: A single integer indicating the total amount of driving Bessie must do. Note that the result may not fit into a 32‑bit integer.", "hint": "There are two cows waiting along a fence of length $10$. The first cow wants to go from position $0$ (where Bessie starts) to position $9$. The second cow wishes to go from position $6$ to position $5$.\n\nBessie picks up the first cow at position $0$ and drives to position $6$. There she drops off the first cow, delivers the second cow to her destination, and returns to pick up the first cow. She then drops off the first cow and drives the rest of the way to position $10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO13FEB] Taxi G", "background": null, "description": "Bessie is running a taxi service for the other cows on the farm.  The cows have been gathering at different locations along a fence of length M (1 <= M <= 1,000,000,000).  Unfortunately, they have grown bored with their current locations and each wish to go somewhere else along the fence.  Bessie must pick up each of her friends at their starting positions and drive them to their destinations.  Bessie's car is small so she can only transport one cow in her car at a time.  Cows can enter and exit the car instantaneously.\n\nTo save gas, Bessie would like to minimize the amount she has to drive.  Given the starting and ending positions of each of the N cows (1 <= N <= 100,000), determine the least amount of driving Bessie has to do.  Bessie realizes that to save the most gas she may need to occasionally drop a cow off at a position other than her destination.\n\nBessie starts at the leftmost point of the fence, position 0, and must finish her journey at the rightmost point on the fence, position M.\n\n长度为 $M(1 \\le M \\le 10^9) $ 的栅栏上，有 $N(1 \\le N \\le 10^5)$ 头牛需要坐车前往别的地方，起点和终点分别为 $a_i$ 和 $b_i(0 \\le a_i,b_i \\le M)$ 。现在一辆出租车从最左端 $0$ 出发，要运送完所有牛，最后到达最右端 $M$ ，求最小路程。出租车只能一次载一只牛。\n\n**注意：你可以中途将所载的牛放下去，再载别的牛，可以通过样例二辅助理解。**", "inputFormat": "\\* Line 1: N and M separated by a space.\n\n\\* Lines 2..1+N: The (i+1)th line contains two space separated\n\nintegers, s\\_i and t\\_i (0 <= s\\_i, t\\_i <= M), indicating the starting position and destination position of the ith cow.", "outputFormat": "\\* Line 1: A single integer indicating the total amount of driving Bessie must do.  Note that the result may not fit into a 32 bit integer.", "hint": "There are two cows waiting to be transported along a fence of length 10. The first cow wants to go from position 0 (where Bessie starts) to position 9.  The second cow wishes to go from position 6 to position 5.\n\n\nBessie picks up the first cow at position 0 and drives to position 6. There she drops off the first cow, delivers the second cow to her destination and returns to pick up the first cow.  She drops off the first cow and then drives the remainder of the way to the right side of the fence.", "locale": "zh-CN"}}}
{"pid": "P3077", "type": "P", "difficulty": 5, "samples": [["3 2 4 \n1 \n1 \n5 \n2 \n2 \n1 1 \n2 1 \n3 1 \n2 2 \n", "8 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2013", "USACO"], "title": "[USACO13FEB] Route Design G", "background": "", "description": "After escaping from the farm, Bessie has decided to start a travel agency along the Amoozon river.  There are several tourist sites located on both sides of the river, each with an integer value indicating how interesting the tourist site is.\n\nTourist sites are connected by routes that cross the river (i.e., there are no routes connecting a site with a site on the same side of the river).  Bessie wants to design a tour for her customers and needs your help.  A tour is a sequence of tourist sites with adjacent sites connected by a route. In order to best serve her customers she wants to find the route that maximizes the sum of the values associated with each visited site.\n\nHowever, Bessie may be running several of these tours at the same time.  Therefore it's important that no two routes on a tour\n\nintersect.  Two routes (a <-> x) and (b <-> y) intersect if and only if (a < b and y < x) or (b < a and x < y) or (a = b and x = y).\n\nHelp Bessie find the best tour for her agency.  Bessie may start and end at any site on either side of the Amoozon.\n\n河左岸有n个点，右岸有m个点，各有权值。有R条跨河的桥，求一条不交叉的路径使得点权和最大。\n\n(a <-> b) 与 (x <-> y) 交叉指(a < b and y < x) or (b < a and x < y) or (a = b and x = y)。\n", "inputFormat": "\\* Line 1: Three space separated integers N (1 <= N <= 40,000), M (1 <= M <= 40,000), and R (0 <= R <= 100,000) indicating\n\nrespectively the number of sites on the left side of the river, the number of sites on the right side of the river, and the number of routes.\n\n\\* Lines 2..N+1: The (i+1)th line has a single integer, L\\_i (0 <= L\\_i <= 40,000), indicating the value of the ith tourist site on the left side of the river.\n\n\\* Lines N+2..N+M+1: The (i+N+1)th line has a single integer, R\\_i (0 <= R\\_i <= 40,000), indicating the value of the ith tourist site on the right side of the river.\n\n\\* Lines N+M+2..N+M+R+1: Each line contains two space separated integers I (1 <= I <= N) and J (1 <= J <= M) indicating there is a bidirectional route between site I on the left side of the river and site J on the right side of the river.\n", "outputFormat": "\\* Line 1: A single integer indicating the maximum sum of values attainable on a tour.\n", "hint": "There are three sites on the left side of the Amoozon with values 1, 1, and 5.  There are two sites on the right side of the Amoozon with values 2 and 2.  There are four routes connecting sites on both sides of the river.\n\n\nThe optimal tour goes from site 1 on the left, site 1 on the right, and ends at site 3 on the left.  These respectively have values 1, 2, and 5 giving a total value of the trip of 8.\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO13FEB] Route Design G", "background": "", "description": "After escaping from the farm, Bessie has decided to start a travel agency along the Amoozon river. There are several tourist sites located on both sides of the river, each with an integer value indicating how interesting the tourist site is.\n\nTourist sites are connected by routes that cross the river (i.e., there are no routes connecting a site with a site on the same side of the river). Bessie wants to design a tour for her customers and needs your help. A tour is a sequence of tourist sites with adjacent sites connected by a route. In order to best serve her customers, she wants to find the route that maximizes the sum of the values associated with each visited site.\n\nHowever, Bessie may be running several of these tours at the same time. Therefore, it is important that no two routes on a tour intersect. Two routes (a <-> x) and (b <-> y) intersect if and only if (a < b and y < x) or (b < a and x < y) or (a = b and x = y).\n\nHelp Bessie find the best tour for her agency. Bessie may start and end at any site on either side of the Amoozon.\n\nThere are N sites on the left bank and M on the right bank, each with a weight. There are R bridges that cross the river. Find a non-crossing path that maximizes the sum of the site weights.\n\n(a <-> b) and (x <-> y) intersect if and only if (a < b and y < x) or (b < a and x < y) or (a = b and x = y).", "inputFormat": "- Line 1: Three space-separated integers N (1 <= N <= 40,000), M (1 <= M <= 40,000), and R (0 <= R <= 100,000) indicating respectively the number of sites on the left side of the river, the number of sites on the right side of the river, and the number of routes.\n- Lines 2..N+1: The (i+1)-th line has a single integer, L_i (0 <= L_i <= 40,000), indicating the value of the i-th tourist site on the left side of the river.\n- Lines N+2..N+M+1: The (i+N+1)-th line has a single integer, R_i (0 <= R_i <= 40,000), indicating the value of the i-th tourist site on the right side of the river.\n- Lines N+M+2..N+M+R+1: Each line contains two space-separated integers I (1 <= I <= N) and J (1 <= J <= M) indicating there is a bidirectional route between site I on the left side of the river and site J on the right side of the river.", "outputFormat": "- Line 1: A single integer indicating the maximum sum of values attainable on a tour.", "hint": "There are three sites on the left side of the Amoozon with values 1, 1, and 5. There are two sites on the right side of the Amoozon with values 2 and 2. There are four routes connecting sites on both sides of the river.\n\nThe optimal tour goes from site 1 on the left, site 1 on the right, and ends at site 3 on the left. These respectively have values 1, 2, and 5, giving a total value of the trip of 8.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO13FEB] Route Design G", "background": "", "description": "After escaping from the farm, Bessie has decided to start a travel agency along the Amoozon river.  There are several tourist sites located on both sides of the river, each with an integer value indicating how interesting the tourist site is.\n\nTourist sites are connected by routes that cross the river (i.e., there are no routes connecting a site with a site on the same side of the river).  Bessie wants to design a tour for her customers and needs your help.  A tour is a sequence of tourist sites with adjacent sites connected by a route. In order to best serve her customers she wants to find the route that maximizes the sum of the values associated with each visited site.\n\nHowever, Bessie may be running several of these tours at the same time.  Therefore it's important that no two routes on a tour\n\nintersect.  Two routes (a <-> x) and (b <-> y) intersect if and only if (a < b and y < x) or (b < a and x < y) or (a = b and x = y).\n\nHelp Bessie find the best tour for her agency.  Bessie may start and end at any site on either side of the Amoozon.\n\n河左岸有n个点，右岸有m个点，各有权值。有R条跨河的桥，求一条不交叉的路径使得点权和最大。\n\n(a <-> b) 与 (x <-> y) 交叉指(a < b and y < x) or (b < a and x < y) or (a = b and x = y)。\n", "inputFormat": "\\* Line 1: Three space separated integers N (1 <= N <= 40,000), M (1 <= M <= 40,000), and R (0 <= R <= 100,000) indicating\n\nrespectively the number of sites on the left side of the river, the number of sites on the right side of the river, and the number of routes.\n\n\\* Lines 2..N+1: The (i+1)th line has a single integer, L\\_i (0 <= L\\_i <= 40,000), indicating the value of the ith tourist site on the left side of the river.\n\n\\* Lines N+2..N+M+1: The (i+N+1)th line has a single integer, R\\_i (0 <= R\\_i <= 40,000), indicating the value of the ith tourist site on the right side of the river.\n\n\\* Lines N+M+2..N+M+R+1: Each line contains two space separated integers I (1 <= I <= N) and J (1 <= J <= M) indicating there is a bidirectional route between site I on the left side of the river and site J on the right side of the river.\n", "outputFormat": "\\* Line 1: A single integer indicating the maximum sum of values attainable on a tour.\n", "hint": "There are three sites on the left side of the Amoozon with values 1, 1, and 5.  There are two sites on the right side of the Amoozon with values 2 and 2.  There are four routes connecting sites on both sides of the river.\n\n\nThe optimal tour goes from site 1 on the left, site 1 on the right, and ends at site 3 on the left.  These respectively have values 1, 2, and 5 giving a total value of the trip of 8.\n", "locale": "zh-CN"}}}
{"pid": "P3078", "type": "P", "difficulty": 3, "samples": [["5 \n2 \n4 \n1 \n2 \n3 \n", "6 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2013", "USACO", "差分"], "title": "[USACO13MAR] Poker Hands S", "background": "", "description": "Bessie and her friends are playing a unique version of poker involving a deck with N (1 <= N <= 100,000) different ranks, conveniently numbered 1..N (a normal deck has N = 13). In this game, there is only one type of hand the cows can play: one may choose a card labeled i and a card labeled j and play one card of every value from i to j.  This type of hand is called a \"straight\".\n\nBessie's hand currently holds a\\_i cards of rank i (0 <= a\\_i <= 100000). Help her find the minimum number of hands she must play to get rid of all her cards.\n", "inputFormat": "\\* Line 1: The integer N.\n\n\\* Lines 2..1+N: Line i+1 contains the value of a\\_i.\n", "outputFormat": "\\* Line 1: The minimum number of straights Bessie must play to get rid of all her cards.\n", "hint": "Bessie can play a straight from 1 to 5, a straight from 1 to 2, a straight from 4 to 5, two straights from 2 to 2, and a straight from 5 to 5, for a total of 6 rounds necessary to get rid of all her cards.\n", "locale": "en", "translations": {"en": {"title": "[USACO13MAR] Poker Hands S", "background": "", "description": "Bessie and her friends are playing a unique version of poker involving a deck with N (1 <= N <= 100,000) different ranks, conveniently numbered 1..N (a normal deck has N = 13). In this game, there is only one type of hand the cows can play: one may choose a card labeled i and a card labeled j and play one card of every value from i to j.  This type of hand is called a \"straight\".\n\nBessie's hand currently holds a\\_i cards of rank i (0 <= a\\_i <= 100000). Help her find the minimum number of hands she must play to get rid of all her cards.\n", "inputFormat": "\\* Line 1: The integer N.\n\n\\* Lines 2..1+N: Line i+1 contains the value of a\\_i.\n", "outputFormat": "\\* Line 1: The minimum number of straights Bessie must play to get rid of all her cards.\n", "hint": "Bessie can play a straight from 1 to 5, a straight from 1 to 2, a straight from 4 to 5, two straights from 2 to 2, and a straight from 5 to 5, for a total of 6 rounds necessary to get rid of all her cards.\n", "locale": "en"}, "zh-CN": {"title": "[USACO13MAR] Poker Hands S", "background": "", "description": "Bessie 和她的朋友们正在玩一种独特的扑克牌游戏，这个游戏使用一副有 $N$ 种不同牌面（$1 \\leq N \\leq 100,000$）的牌组，牌面被方便地编号为 $1$ 到 $N$（普通的牌组有 $N = 13$）。在这个游戏中，牛们只能打出一种牌型：可以选择一张标号为 $i$ 的牌和一张标号为 $j$ 的牌，并打出从 $i$ 到 $j$ 的所有牌。这种牌型称为「顺子」。\n\nBessie 的手牌中当前持有 $a_i$ 张牌面为 $i$ 的牌（$0 \\leq a_i \\leq 100000$）。帮助她找到必须打出的最少顺子数目以清空她所有的牌。\n", "inputFormat": "\\* 第 1 行：整数 $N$。\n\n\\* 第 2 行到第 $1+N$ 行：第 $i+1$ 行包含 $a_i$ 的值。\n", "outputFormat": "\\* 第 1 行：Bessie 必须打出的最少顺子数目以清空她所有的牌。\n", "hint": "Bessie 可以打出一个从 1 到 5 的顺子，一个从 1 到 2 的顺子，一个从 4 到 5 的顺子，两个从 2 到 2 的顺子，以及一个从 5 到 5 的顺子，总共需要 6 轮来清空她所有的牌。\n（由 ChatGPT 4o 翻译）", "locale": "zh-CN"}}}
{"pid": "P3079", "type": "P", "difficulty": 5, "samples": [["3 \n2 0 8 9 \n10 2 11 3 \n4 2 6 5 \n", "2 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "USACO"], "title": "[USACO13MAR] Farm Painting S", "background": "", "description": "After several harsh winters, Farmer John has decided it is time to re-paint his farm.  The farm consists of N fenced enclosures (1 <= N <= 50,000), each of which can be described by a rectangle in the 2D plane whose sides are parallel to the x and y axes.  Enclosures may be contained within other enclosures, but no two fences intersect, so if two enclosures cover the same area of the 2D plane, one must be contained within the other.\n\nFJ figures that an enclosure contained within another enclosure will not be visible to the outside world, so he only wants to re-paint enclosures that are themselves not contained within any other enclosures.  Please help FJ determine the total number of enclosures he needs to paint.\n\n经过几个严冬，农场主约翰决定是重新粉刷农场的时候了。该农场由$n$个围栏围成（$1<=n=50000$），每一个都可以用二维平面上的矩形来描述，其两侧平行于x和y轴。牛圈可能包含在其他牛圈中，但没有两个栅栏相交（不同牛圈的边不会有接触）。因此如果两个牛圈覆盖了二维平面的同一区域，那么一个必须包含在另一个内。\n\nFJ知道，被其他牛圈包含的牛圈是不会被外面的人看到的。众所周知，FJ非常懒，所以他只想刷露在外面的牛圈，请帮助他求出总共需要刷的牛圈的个数。\n", "inputFormat": "\\* Line 1: The number of enclosures, N.\n\n\\* Lines 2..1+N: Each line describes an enclosure by 4 space-separated integers x1, y1, x2, and y2, where (x1,y1) is the lower-left corner of the enclosure and (x2,y2) is the upper-right corner. All coordinates are in the range 0..1,000,000.\n\n第一行 一个数，牛圈的总数$n$\n\n第二到$n+1$行 每行四个数，起点坐标$x1,y1$和终点坐标$x2,y2$\n", "outputFormat": "\\* Line 1: The number of enclosures that are not contained within other enclosures.\n\nFJ总共需要刷的牛圈的个数\n", "hint": "There are three enclosures.  The first has corners (2,0) and (8,9), and so on.\n\n\nEnclosure 3 is contained within enclosure 1, so there are two enclosures not contained within other enclosures.\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO13MAR] Farm Painting S", "background": "", "description": "After several harsh winters, Farmer John has decided it is time to repaint his farm. The farm consists of $N$ fenced enclosures ($1 \\le N \\le 50000$), each represented by a rectangle in the 2D plane whose sides are parallel to the $x$ and $y$ axes. Enclosures may be nested (one fully contained within another), but no two fences intersect or touch. Therefore, if two enclosures cover the same region of the 2D plane, one must be contained within the other.\n\nFarmer John figures that an enclosure contained within another will not be visible from the outside world, so he only wants to repaint enclosures that are not contained within any other enclosures. Please determine the total number of enclosures he needs to paint.", "inputFormat": "- Line 1: The number of enclosures, $N$.\n- Lines 2..$N+1$: Each line describes an enclosure with four space-separated integers $x_1$, $y_1$, $x_2$, and $y_2$, where $(x_1, y_1)$ is the lower-left corner and $(x_2, y_2)$ is the upper-right corner. All coordinates are in the range 0..1,000,000.", "outputFormat": "- Line 1: The number of enclosures that are not contained within any other enclosures.", "hint": "There are three enclosures. The first has corners $(2, 0)$ and $(8, 9)$, and so on. Enclosure 3 is contained within enclosure 1, so there are two enclosures not contained within other enclosures.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO13MAR] Farm Painting S", "background": "", "description": "After several harsh winters, Farmer John has decided it is time to re-paint his farm.  The farm consists of N fenced enclosures (1 <= N <= 50,000), each of which can be described by a rectangle in the 2D plane whose sides are parallel to the x and y axes.  Enclosures may be contained within other enclosures, but no two fences intersect, so if two enclosures cover the same area of the 2D plane, one must be contained within the other.\n\nFJ figures that an enclosure contained within another enclosure will not be visible to the outside world, so he only wants to re-paint enclosures that are themselves not contained within any other enclosures.  Please help FJ determine the total number of enclosures he needs to paint.\n\n经过几个严冬，农场主约翰决定是重新粉刷农场的时候了。该农场由$n$个围栏围成（$1<=n=50000$），每一个都可以用二维平面上的矩形来描述，其两侧平行于x和y轴。牛圈可能包含在其他牛圈中，但没有两个栅栏相交（不同牛圈的边不会有接触）。因此如果两个牛圈覆盖了二维平面的同一区域，那么一个必须包含在另一个内。\n\nFJ知道，被其他牛圈包含的牛圈是不会被外面的人看到的。众所周知，FJ非常懒，所以他只想刷露在外面的牛圈，请帮助他求出总共需要刷的牛圈的个数。\n", "inputFormat": "\\* Line 1: The number of enclosures, N.\n\n\\* Lines 2..1+N: Each line describes an enclosure by 4 space-separated integers x1, y1, x2, and y2, where (x1,y1) is the lower-left corner of the enclosure and (x2,y2) is the upper-right corner. All coordinates are in the range 0..1,000,000.\n\n第一行 一个数，牛圈的总数$n$\n\n第二到$n+1$行 每行四个数，起点坐标$x1,y1$和终点坐标$x2,y2$\n", "outputFormat": "\\* Line 1: The number of enclosures that are not contained within other enclosures.\n\nFJ总共需要刷的牛圈的个数\n", "hint": "There are three enclosures.  The first has corners (2,0) and (8,9), and so on.\n\n\nEnclosure 3 is contained within enclosure 1, so there are two enclosures not contained within other enclosures.\n", "locale": "zh-CN"}}}
{"pid": "P3080", "type": "P", "difficulty": 4, "samples": [["4 \n-2 \n-12 \n3 \n7 \n", "50 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2013", "USACO", "区间 DP"], "title": "[USACO13MAR] The Cow Run G/S", "background": null, "description": "农夫约翰的牧场围栏上出现了一个洞，有 $N$（$1\\le N\\le 1000$）只牛从这个洞逃出了牧场。这些出逃的奶牛很狂躁，他们在外面到处搞破坏，每分钟每头牛都会给约翰带来 $1$ 美元的损失。约翰必须用缰绳套住所有的牛，以停止他们搞破坏。\n\n幸运的是，奶牛们都在牧场外一条笔直的公路上，牧场的大门恰好位于公里的 $0$ 点处。约翰知道每头牛距离牧场大门的距离 $P_i$（$-5\\times10^5\\le P_i\\le5\\times 10^5, P_i\\ne0$）。\n\n约翰从农场大门出发，每分钟移动一个单位距离，每到一头牛所在的地点，约翰就会给它套上缰绳，套缰绳不花时间。按怎样的顺序去给牛套缰绳才能使约翰损失的费用最少？", "inputFormat": "第一行：奶牛的数目，$N$。\n\n第二至 $N+1$ 行：第 $i+1$ 行包含整数 $P_i$。", "outputFormat": "一行，表示约翰最小的损失。", "hint": "四头奶牛所在坐标分别为 $-2, -12, 3, 7$。\n\n\n最优的访问顺序为 $-2, 3, 7, -12$。 FJ 在第 $2$ 分钟到达了位置 $-2$，在这个位置的奶牛造成了 $2$ 美元的损失。\n\n然后他去了距离为 $5$ 的位置 $3$，这头牛总共造成了 $2+5 = 7$ 美元的损失。\n\n他又花了 $4$ 分钟到达了 $7$，这里造成了 $7 + 4 = 11 $ 美元的损失。\n\n最后他用 $19$ 分钟到达了位置 $-12$，损失了 $11 + 19 = 30$ 美元。\n\n总的损失为 $2 + 7 + 11 + 30 = 50$ 美元。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO13MAR] The Cow Run G/S", "background": "", "description": "Farmer John forgot to repair a hole in his fence, and his $N$ cows ($1 \\le N \\le 1000$) escaped. Each minute a cow is outside the fence, she causes one dollar of damage. Farmer John must visit each cow to install a halter that calms the cow and stops the damage.\n\nThe cows are positioned at distinct locations along a straight road outside the farm. Farmer John knows the position $P_i$ of each cow $i$ (relative to the gate at position $0$ where he starts), with $-500000 \\le P_i \\le 500000$ and $P_i \\ne 0$.\n\nFarmer John moves at one unit of distance per minute, and installing a halter is instantaneous. Determine the order in which he should visit the cows to minimize the total damage, and compute the minimum total damage cost.", "inputFormat": "- Line 1: An integer $N$, the number of cows.\n- Lines $2..N+1$: Line $i+1$ contains an integer $P_i$.", "outputFormat": "- Line 1: A single integer, the minimum total damage cost.", "hint": "Four cows are at positions $-2$, $-12$, $3$, and $7$.\n\nThe optimal visit order is $-2$, $3$, $7$, $-12$. Farmer John arrives at position $-2$ in $2$ minutes, causing $2$ dollars of damage for that cow.\n\nHe then travels to position $3$ (distance $5$), where the cumulative damage for that cow is $2 + 5 = 7$ dollars.\n\nHe spends $4$ more minutes to get to $7$ at a cost of $7 + 4 = 11$ dollars for that cow.\n\nFinally, he spends $19$ minutes to go to $-12$ with a cost of $11 + 19 = 30$ dollars.\n\nThe total damage is $2 + 7 + 11 + 30 = 50$ dollars.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO13MAR] The Cow Run G/S", "background": null, "description": "农夫约翰的牧场围栏上出现了一个洞，有 $N$（$1\\le N\\le 1000$）只牛从这个洞逃出了牧场。这些出逃的奶牛很狂躁，他们在外面到处搞破坏，每分钟每头牛都会给约翰带来 $1$ 美元的损失。约翰必须用缰绳套住所有的牛，以停止他们搞破坏。\n\n幸运的是，奶牛们都在牧场外一条笔直的公路上，牧场的大门恰好位于公里的 $0$ 点处。约翰知道每头牛距离牧场大门的距离 $P_i$（$-5\\times10^5\\le P_i\\le5\\times 10^5, P_i\\ne0$）。\n\n约翰从农场大门出发，每分钟移动一个单位距离，每到一头牛所在的地点，约翰就会给它套上缰绳，套缰绳不花时间。按怎样的顺序去给牛套缰绳才能使约翰损失的费用最少？", "inputFormat": "第一行：奶牛的数目，$N$。\n\n第二至 $N+1$ 行：第 $i+1$ 行包含整数 $P_i$。", "outputFormat": "一行，表示约翰最小的损失。", "hint": "四头奶牛所在坐标分别为 $-2, -12, 3, 7$。\n\n\n最优的访问顺序为 $-2, 3, 7, -12$。 FJ 在第 $2$ 分钟到达了位置 $-2$，在这个位置的奶牛造成了 $2$ 美元的损失。\n\n然后他去了距离为 $5$ 的位置 $3$，这头牛总共造成了 $2+5 = 7$ 美元的损失。\n\n他又花了 $4$ 分钟到达了 $7$，这里造成了 $7 + 4 = 11 $ 美元的损失。\n\n最后他用 $19$ 分钟到达了位置 $-12$，损失了 $11 + 19 = 30$ 美元。\n\n总的损失为 $2 + 7 + 11 + 30 = 50$ 美元。", "locale": "zh-CN"}}}
{"pid": "P3081", "type": "P", "difficulty": 6, "samples": [["4 \n0 0 5 6 \n1 0 2 1 \n7 2 8 5 \n3 0 7 7 \n", "3 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "USACO", "平衡树", "扫描线", "李超线段树"], "title": "[USACO13MAR] Hill Walk G", "background": "", "description": "There are N hills (1 <= N <= 100,000). Each hill takes the form of a line segment from (x1, y1) to (x2, y2) where x1 < x2 and y1 < y2. None of these segments intersect or touch, even at their endpoints, and furthermore, the first hill satisfies (x1, y1) = (0,0).\n\nBessie the cow starts at (0,0) on the first hill. Whenever Bessie is on a hill, she climbs up until she reaches the end. Then she jumps off the edge. If she lands on another hill, she continues walking on that hill; otherwise, she falls very far until she lands safely on a cushion of pillows at y = -infinity.  Each hill (x1, y1) -> (x2, y2) should be regarded as containing the point (x1, y1) but not containing the point (x2, y2), so that Bessie will land on the hill if she falls on it from above at a position with x = x1, but she will not land on the hill if she falls on it from above at x = x2.\n\nPlease count the total number of hills that Bessie touches at some point during her walk.\n\n有 $N(1 \\le N \\le 10 ^ 5)$座小山，每座山所占的区域用直线 $(x1, y1)$ 到 $(x2, y2)$ 来表示（$x1 < x2$ 并且 $y1 < y2$）。也就是说这些山用笛卡尔坐标系里的线段来表示，这些用于表示小山的线段都没有任何交点，第一座山的一端位于 $(x1, y1) = (0,0)$。\n\n\n贝西从 $(0,0)$ 开始在第一座山上漫步，一旦贝西到了一座山，她会一直走到该山的终点，这时，她会从边缘处起跳，如果她降落到另一座山上，她会继续在新的山上漫步。贝西起跳后沿 $y$ 轴方向下落，如果贝西不能降落到一座山上，她会一直下落，直到到达 $y$ 轴的负无穷大位置（$y = -\\infin$）。\n\n\n每座用线段表示的山 $(x1, y1) \\to (x2, y2)$ 包含 $(x1, y1)$ 这个点，但不包含 $(x2, y2)$，请计算出贝西总共在多少座山上漫步了。\n", "inputFormat": "\\* Line 1: The number of hills, N.\n\n\\* Lines 2..1+N: Line i+1 contains four integers (x1,y1,x2,y2)\n\ndescribing hill i.  Each integer is in the range\n\n0..1,000,000,000.\n", "outputFormat": "\\* Line 1: The number of hills Bessie touches on her journey.\n", "hint": "There are four hills.  The first hill runs from (0,0) to (5,6), and so on.\n\n\nBessie walks on hills #1, #4, and finally #3.\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO13MAR] Hill Walk G", "background": "", "description": "There are $N$ hills ($1 \\le N \\le 10^5$). Each hill is a line segment from $(x1, y1)$ to $(x2, y2)$ with $x1 < x2$ and $y1 < y2$. No two segments intersect or touch, even at their endpoints. The first hill satisfies $(x1, y1) = (0, 0)$.\n\nBessie the cow starts at $(0, 0)$ on the first hill. While on a hill, she climbs up until she reaches the end, then she jumps off the edge. She falls straight down at a fixed $x$. If she lands on another hill, she continues walking on that hill; otherwise, she keeps falling until she lands safely at $y = -\\infty$.\n\nEach hill $(x1, y1) \\to (x2, y2)$ contains the point $(x1, y1)$ but does not contain the point $(x2, y2)$. Therefore, Bessie will land on the hill if she falls on it from above at $x = x1$, but she will not land on the hill if she falls on it from above at $x = x2$.\n\nPlease count the total number of hills that Bessie touches at some point during her walk.", "inputFormat": "* Line 1: The number of hills, $N$.\n* Lines 2..$1+N$: Line $i+1$ contains four integers $(x1, y1, x2, y2)$ describing hill $i$. Each integer is in the range $0..1{,}000{,}000{,}000$.", "outputFormat": "* Line 1: The number of hills Bessie touches on her journey.", "hint": "There are four hills. The first hill runs from $(0, 0)$ to $(5, 6)$, and so on. Bessie walks on hills #1, #4, and finally #3.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO13MAR] Hill Walk G", "background": "", "description": "There are N hills (1 <= N <= 100,000). Each hill takes the form of a line segment from (x1, y1) to (x2, y2) where x1 < x2 and y1 < y2. None of these segments intersect or touch, even at their endpoints, and furthermore, the first hill satisfies (x1, y1) = (0,0).\n\nBessie the cow starts at (0,0) on the first hill. Whenever Bessie is on a hill, she climbs up until she reaches the end. Then she jumps off the edge. If she lands on another hill, she continues walking on that hill; otherwise, she falls very far until she lands safely on a cushion of pillows at y = -infinity.  Each hill (x1, y1) -> (x2, y2) should be regarded as containing the point (x1, y1) but not containing the point (x2, y2), so that Bessie will land on the hill if she falls on it from above at a position with x = x1, but she will not land on the hill if she falls on it from above at x = x2.\n\nPlease count the total number of hills that Bessie touches at some point during her walk.\n\n有 $N(1 \\le N \\le 10 ^ 5)$座小山，每座山所占的区域用直线 $(x1, y1)$ 到 $(x2, y2)$ 来表示（$x1 < x2$ 并且 $y1 < y2$）。也就是说这些山用笛卡尔坐标系里的线段来表示，这些用于表示小山的线段都没有任何交点，第一座山的一端位于 $(x1, y1) = (0,0)$。\n\n\n贝西从 $(0,0)$ 开始在第一座山上漫步，一旦贝西到了一座山，她会一直走到该山的终点，这时，她会从边缘处起跳，如果她降落到另一座山上，她会继续在新的山上漫步。贝西起跳后沿 $y$ 轴方向下落，如果贝西不能降落到一座山上，她会一直下落，直到到达 $y$ 轴的负无穷大位置（$y = -\\infin$）。\n\n\n每座用线段表示的山 $(x1, y1) \\to (x2, y2)$ 包含 $(x1, y1)$ 这个点，但不包含 $(x2, y2)$，请计算出贝西总共在多少座山上漫步了。\n", "inputFormat": "\\* Line 1: The number of hills, N.\n\n\\* Lines 2..1+N: Line i+1 contains four integers (x1,y1,x2,y2)\n\ndescribing hill i.  Each integer is in the range\n\n0..1,000,000,000.\n", "outputFormat": "\\* Line 1: The number of hills Bessie touches on her journey.\n", "hint": "There are four hills.  The first hill runs from (0,0) to (5,6), and so on.\n\n\nBessie walks on hills #1, #4, and finally #3.\n", "locale": "zh-CN"}}}
{"pid": "P3082", "type": "P", "difficulty": 5, "samples": [["ababaa \naba \n", "1 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["字符串", "动态规划 DP", "2013", "USACO", "AC 自动机", "KMP 算法"], "title": "[USACO13MAR] Necklace G", "background": null, "description": "奶牛贝茜将串起 $N$ 颗刻有字母的宝石，打算制作一条时尚项链。\n\n贝茜对自己的物品很爱惜，她不想与目前住在谷仓另一侧的另一头牛分享这条项链。那头牛的名字是一个长度为 $M$ 的字符串，贝茜需要确保这个长度为 $M$ 的字符串不会作为连续子字符串出现在她项链字符串的任何位置（否则那头牛可能会误以为这条项链是给她的）。贝茜决定移除项链中部分石头，以确保另一头奶牛的名字不会作为子串出现。请帮助贝茜确定必须移除的最小石头数量。", "inputFormat": "第 $1$ 行：描述贝茜初始项链的长度为 $N$ 的字符串；每个字符在 `a` 到 `z` 范围内。\n\n第 $2$ 行：描述牛棚中另一头奶牛的长度为 $M$ 的名字，同样由 `a` 到 `z` 的字符组成。", "outputFormat": "第 $1$ 行：从贝茜项链中移除最少数量的宝石，使其不再包含另一头奶牛名字的子串。", "hint": "至少 $20\\%$ 的测试用例中，$N\\le 20$。\n\n至少 $60\\%$ 的测试用例中，$N\\le 1000，M\\le 100$。\n\n所有测试用例中，$N\\le 10000，M\\le 1000$。\n\n所有测试用例中，$M\\le N$。\n\n样例解释：修改后的项链应为 `abbaa`。\n\n---\n\n更新于 $\\text{2022.7.29}$：新增一组 Hack 数据。\n\n本题中文题面由 [ChampionCyan](https://www.luogu.com.cn/user/1036180) 提供。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO13MAR] Necklace G", "background": "", "description": "Bessie the cow will string together $N$ lettered gems to make a fashionable necklace.\n\nBessie takes good care of her belongings and does not want to share this necklace with another cow currently living on the other side of the barn. That cow’s name is a string of length $M$, and Bessie needs to ensure that this length-$M$ string does not appear as a contiguous substring anywhere in her necklace string (otherwise that cow might mistakenly think the necklace is for her). Bessie decides to remove some gems from the necklace to ensure the other cow’s name does not appear as a substring. Please help Bessie determine the minimum number of gems that must be removed.", "inputFormat": "Line 1: A string of length $N$ describing Bessie’s initial necklace; each character is in the range `a` to `z`.\n\nLine 2: A string of length $M$ describing the other cow’s name in the barn, also consisting of characters `a` to `z`.", "outputFormat": "Line 1: The minimum number of gems to remove from Bessie’s necklace so that it no longer contains the other cow’s name as a substring.", "hint": "At least 20% of the test cases have $N \\le 20$.\n\nAt least 60% of the test cases have $N \\le 1000, M \\le 100$.\n\nFor all test cases, $N \\le 10000, M \\le 1000$.\n\nFor all test cases, $M \\le N$.\n\nSample explanation: The modified necklace should be `abbaa`.\n\nUpdated on $\\text{2022.7.29}$: An additional set of hack testdata was added.\n\nThe Chinese statement for this problem was provided by [ChampionCyan](https://www.luogu.com.cn/user/1036180).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO13MAR] Necklace G", "background": null, "description": "奶牛贝茜将串起 $N$ 颗刻有字母的宝石，打算制作一条时尚项链。\n\n贝茜对自己的物品很爱惜，她不想与目前住在谷仓另一侧的另一头牛分享这条项链。那头牛的名字是一个长度为 $M$ 的字符串，贝茜需要确保这个长度为 $M$ 的字符串不会作为连续子字符串出现在她项链字符串的任何位置（否则那头牛可能会误以为这条项链是给她的）。贝茜决定移除项链中部分石头，以确保另一头奶牛的名字不会作为子串出现。请帮助贝茜确定必须移除的最小石头数量。", "inputFormat": "第 $1$ 行：描述贝茜初始项链的长度为 $N$ 的字符串；每个字符在 `a` 到 `z` 范围内。\n\n第 $2$ 行：描述牛棚中另一头奶牛的长度为 $M$ 的名字，同样由 `a` 到 `z` 的字符组成。", "outputFormat": "第 $1$ 行：从贝茜项链中移除最少数量的宝石，使其不再包含另一头奶牛名字的子串。", "hint": "至少 $20\\%$ 的测试用例中，$N\\le 20$。\n\n至少 $60\\%$ 的测试用例中，$N\\le 1000，M\\le 100$。\n\n所有测试用例中，$N\\le 10000，M\\le 1000$。\n\n所有测试用例中，$M\\le N$。\n\n样例解释：修改后的项链应为 `abbaa`。\n\n---\n\n更新于 $\\text{2022.7.29}$：新增一组 Hack 数据。\n\n本题中文题面由 [ChampionCyan](https://www.luogu.com.cn/user/1036180) 提供。", "locale": "zh-CN"}}}
{"pid": "P3083", "type": "P", "difficulty": 3, "samples": [["4 3 3 \n2 4 \n3 1 \n4 2 \n1 3 \nL L R \n", "4 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "2013", "倍增", "USACO"], "title": "[USACO13OPEN] Luxury River Cruise S", "background": null, "description": "农民约翰正带着贝西和其他奶牛们进行一次巡航！他们航行在一个有 $N$ 个港口（$1 \\le N\\le10^3$）的河网中，港口编号为 $1,2,3\\dots N$，贝西从港口 $1$ 出发。每个港口恰好有两条流出的河道，直接通向其他港口，并且这些河道只能单向航行。  \n\n在每个港口，导游会选择走左边的河道或右边的河道继续向下游航行，但他们会一遍又一遍地重复相同的选择顺序。更具体地说，导游事先选定了一个长度为 $M$ 的方向序列（$1\\le M\\le500$），每个方向要么是左，要么是右，然后将这个序列重复 $K$ 次（$1\\le k\\le10^9$），请帮她计算出她最终会停在哪个港口。", "inputFormat": "第 $1$ 行：三个用空格隔开的整数 $N,M,K$。  \n\n第 $2$ 行到第 $N+1$ 行中，第 $i+1$ 行包含两个用空格隔开的整数，分别表示港口 $i$ 的左边河道和右边河道通向的港口编号。  \n\n第 $N+2$ 行：M 个用空格隔开的字符，每个字符是 L 或 R。L 表示选择左边的河道，R 表示选择右边的河道。", "outputFormat": "输出一个整数，表示贝西的巡航最终停靠的港口编号。", "hint": "样例中在执行完第一遍方向序列后，贝西到达港口 $2$（路径：$1 \\to 2 \\to 3 \\to 2$）；\n\n第二遍结束后，她到达港口 $3$（路径：$2 \\to 3 \\to 4 \\to 3$）；\n\n最终结束时，她到达港口 $4$（路径：$3 \\to 4 \\to 1 \\to 4$）。\n\n感谢 @[fkxr](https://www.luogu.com.cn/user/995934) 提供翻译", "locale": "zh-CN", "translations": {"en": {"title": "[USACO13OPEN] Luxury River Cruise S", "background": "", "description": "Farmer John is taking Bessie and the other cows on a cruise! They are sailing on a river network with $N$ ports ($1 \\le N \\le 10^3$), numbered $1, 2, 3, \\dots, N$, and Bessie starts at port $1$. Each port has exactly two outgoing rivers that lead directly to other ports, and these rivers can be traversed only in one direction.\n\nAt each port, the guide chooses to take the left river or the right river to continue downstream, and they repeat the same sequence of choices over and over. More specifically, the guide has fixed in advance a direction sequence of length $M$ ($1 \\le M \\le 500$), each direction being either left or right, and then repeats this sequence $K$ times ($1 \\le K \\le 10^9$). Please help compute the port where Bessie finally stops.", "inputFormat": "Line $1$: Three space-separated integers $N$, $M$, $K$.\n\nLines $2$ to $N+1$: Line $i+1$ contains two space-separated integers, the indices of the ports reached by taking the left and right rivers from port $i$.\n\nLine $N+2$: $M$ space-separated characters, each either L or R. L means take the left river, and R means take the right river.", "outputFormat": "Output a single integer, the index of the port where Bessie’s cruise ends.", "hint": "In the sample, after finishing the first pass of the direction sequence, Bessie arrives at port $2$ (path: $1 \\to 2 \\to 3 \\to 2$)；  \nafter the second pass, she arrives at port $3$ (path: $2 \\to 3 \\to 4 \\to 3$)；  \nfinally, she ends at port $4$ (path: $3 \\to 4 \\to 1 \\to 4$).\n\nThanks to @[fkxr](https://www.luogu.com.cn/user/995934) for the translation.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO13OPEN] Luxury River Cruise S", "background": null, "description": "农民约翰正带着贝西和其他奶牛们进行一次巡航！他们航行在一个有 $N$ 个港口（$1 \\le N\\le10^3$）的河网中，港口编号为 $1,2,3\\dots N$，贝西从港口 $1$ 出发。每个港口恰好有两条流出的河道，直接通向其他港口，并且这些河道只能单向航行。  \n\n在每个港口，导游会选择走左边的河道或右边的河道继续向下游航行，但他们会一遍又一遍地重复相同的选择顺序。更具体地说，导游事先选定了一个长度为 $M$ 的方向序列（$1\\le M\\le500$），每个方向要么是左，要么是右，然后将这个序列重复 $K$ 次（$1\\le k\\le10^9$），请帮她计算出她最终会停在哪个港口。", "inputFormat": "第 $1$ 行：三个用空格隔开的整数 $N,M,K$。  \n\n第 $2$ 行到第 $N+1$ 行中，第 $i+1$ 行包含两个用空格隔开的整数，分别表示港口 $i$ 的左边河道和右边河道通向的港口编号。  \n\n第 $N+2$ 行：M 个用空格隔开的字符，每个字符是 L 或 R。L 表示选择左边的河道，R 表示选择右边的河道。", "outputFormat": "输出一个整数，表示贝西的巡航最终停靠的港口编号。", "hint": "样例中在执行完第一遍方向序列后，贝西到达港口 $2$（路径：$1 \\to 2 \\to 3 \\to 2$）；\n\n第二遍结束后，她到达港口 $3$（路径：$2 \\to 3 \\to 4 \\to 3$）；\n\n最终结束时，她到达港口 $4$（路径：$3 \\to 4 \\to 1 \\to 4$）。\n\n感谢 @[fkxr](https://www.luogu.com.cn/user/995934) 提供翻译", "locale": "zh-CN"}}}
{"pid": "P3084", "type": "P", "difficulty": 6, "samples": [["5 3 \n1 4 \n2 5 \n3 4 \n", "1 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "线段树", "USACO", "单调队列", "差分约束", "队列"], "title": "[USACO13OPEN] Photo G", "background": "", "description": "Farmer John has decided to assemble a panoramic photo of a lineup of his $N$ cows ($1 \\le N \\le 2 \\times 10^5$), which, as always, are conveniently numbered from $1...N$. Accordingly, he snapped $M$ ($1 \\le M \\le 1 \\times 10^5$) photos, each covering a contiguous range of cows: photo $i$ contains cows $a_i$ through $b_i$ inclusive. The photos collectively may not necessarily cover every single cow.\n\nAfter taking his photos, FJ notices a very interesting phenomenon: each photo he took contains exactly one cow with spots! FJ was aware that he had some number of spotted cows in his herd, but he had never actually counted them. Based on his photos, please determine the maximum possible number of spotted cows that could exist in his herd. Output $-1$ if there is no possible assignment of spots to cows consistent with FJ's photographic results.", "inputFormat": "Line $1$: Two integers $N$ and $M$.\n\nLines $2...M+1$: Line $i+1$ contains $a_i$ and $b_i$.", "outputFormat": "Line $1$: The maximum possible number of spotted cows on FJ's farm, or $-1$ if there is no possible solution.", "hint": "There are $5$ cows and $3$ photos. The first photo contains cows $1$ through $4$, etc.\n\nFrom the last photo, we know that either cow $3$ or cow $4$ must be spotted. By choosing either of these, we satisfy the first two photos as well.", "locale": "en", "translations": {"en": {"title": "[USACO13OPEN] Photo G", "background": "", "description": "Farmer John has decided to assemble a panoramic photo of a lineup of his $N$ cows ($1 \\le N \\le 2 \\times 10^5$), which, as always, are conveniently numbered from $1...N$. Accordingly, he snapped $M$ ($1 \\le M \\le 1 \\times 10^5$) photos, each covering a contiguous range of cows: photo $i$ contains cows $a_i$ through $b_i$ inclusive. The photos collectively may not necessarily cover every single cow.\n\nAfter taking his photos, FJ notices a very interesting phenomenon: each photo he took contains exactly one cow with spots! FJ was aware that he had some number of spotted cows in his herd, but he had never actually counted them. Based on his photos, please determine the maximum possible number of spotted cows that could exist in his herd. Output $-1$ if there is no possible assignment of spots to cows consistent with FJ's photographic results.", "inputFormat": "Line $1$: Two integers $N$ and $M$.\n\nLines $2...M+1$: Line $i+1$ contains $a_i$ and $b_i$.", "outputFormat": "Line $1$: The maximum possible number of spotted cows on FJ's farm, or $-1$ if there is no possible solution.", "hint": "There are $5$ cows and $3$ photos. The first photo contains cows $1$ through $4$, etc.\n\nFrom the last photo, we know that either cow $3$ or cow $4$ must be spotted. By choosing either of these, we satisfy the first two photos as well.", "locale": "en"}, "zh-CN": {"title": "[USACO13OPEN] Photo G", "background": null, "description": "农夫约翰决定给站在一条线上的 $N$（$1 \\le N \\le 2 \\times 10^5$）头奶牛制作一张全家福照片，$N$ 头奶牛编号 $1$ 到 $N$。\n\n\n于是约翰拍摄了 $M$（$1 \\le M \\le 1 \\times 10^5$）张照片，每张照片都覆盖了连续一段奶牛：第 $i$ 张照片中包含了编号 $a_i$ 到 $b_i$ 的奶牛。但是这些照片不一定把每一只奶牛都拍了进去。\n\n\n在拍完照片后，约翰发现了一个有趣的事情：每张照片中都**有且仅有**一只身上带有斑点的奶牛。约翰意识到他的牛群中有一些斑点奶牛，但他从来没有统计过它们的数量。\n\n根据照片，请你帮约翰估算在他的牛群中最多可能有多少只斑点奶牛。如果无解，输出“-1”。", "inputFormat": "第一行包含两个整数 $N$ 和 $M$。\n\n接下来 $M$ 行，每行包含两个整数 $a_i$ 和 $b_i$。", "outputFormat": "输出斑点牛的最大可能数量。\n\n如果不存在可能解，则输出 $−1$。", "hint": "从最后一张照片可以得出奶牛 $3$ 或 $4$ 中，必须有一头斑点牛。\n\n无论哪头是斑点牛，都能使得前两张照片得到满足。", "locale": "zh-CN"}}}
{"pid": "P3085", "type": "P", "difficulty": 6, "samples": [["7 \n1 2 0 \n3 1 1 \n2 4 0 \n5 2 0 \n6 3 1 \n5 7 1 \n", "1 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "USACO", "点分治", "分治"], "title": "[USACO13OPEN] Yin and Yang G", "background": "", "description": "Farmer John is planning his morning walk on the farm. The farm is structured like a tree: it has $N$ barns $(1 \\le N \\le 100,000)$ which are connected by $N-1$ edges such that he can reach any barn from any other. Farmer John wants to choose a path which starts and ends at two different barns, such that he does not traverse any edge twice. He worries that his path might be a little long, so he also wants to choose another \"rest stop\" barn located on this path (which is distinct from the start or the end).\n\nAlong each edge is a herd of cows, either of the Charcolais (white hair) or the Angus (black hair) variety. Being the wise man that he is, Farmer John wants to balance the forces of yin and yang that weigh upon his walk. To do so, he wishes to choose a path such that he will pass by an equal number of Charcolais herds and Angus herds-- both on the way from the start to his rest stop, and on the way from the rest stop to the end.\n\nFarmer John is curious how many different paths he can choose that are \"balanced\" as described above.  Two paths are different only if they consist of different sets of edges; a path should be counted only once even if there are multiple valid \"rest stop\" locations along the path that make it balanced.\n\nPlease help determine the number of paths Farmer John can choose!", "inputFormat": "* Line 1: The integer N.\n\n* Lines $2$ ~ $N$: Three integers $a_i$, $b_i$ and $t_i$, representing the two barns that edge i connects. $t_i$ is $0$ if the herd along that edge is Charcolais, and $1$ if the  herd is Angus.", "outputFormat": "* Line $1$: One integer, representing the number of possible paths Farmer John can choose from.", "hint": "There are $7$ barns and $6$ edges. The edges from $1$ to $2$,$2$ to $4$ and $2$ to $5$ have Charcolais herds along them.\n\nNo path of length $2$ can have a suitable rest stop on it, so we can only consider paths of length $4$. The only path that has a suitable rest stop is $3-1-2-5-7$, with a rest stop at $2$.", "locale": "en", "translations": {"en": {"title": "[USACO13OPEN] Yin and Yang G", "background": "", "description": "Farmer John is planning his morning walk on the farm. The farm is structured like a tree: it has $N$ barns $(1 \\le N \\le 100,000)$ which are connected by $N-1$ edges such that he can reach any barn from any other. Farmer John wants to choose a path which starts and ends at two different barns, such that he does not traverse any edge twice. He worries that his path might be a little long, so he also wants to choose another \"rest stop\" barn located on this path (which is distinct from the start or the end).\n\nAlong each edge is a herd of cows, either of the Charcolais (white hair) or the Angus (black hair) variety. Being the wise man that he is, Farmer John wants to balance the forces of yin and yang that weigh upon his walk. To do so, he wishes to choose a path such that he will pass by an equal number of Charcolais herds and Angus herds-- both on the way from the start to his rest stop, and on the way from the rest stop to the end.\n\nFarmer John is curious how many different paths he can choose that are \"balanced\" as described above.  Two paths are different only if they consist of different sets of edges; a path should be counted only once even if there are multiple valid \"rest stop\" locations along the path that make it balanced.\n\nPlease help determine the number of paths Farmer John can choose!", "inputFormat": "* Line 1: The integer N.\n\n* Lines $2$ ~ $N$: Three integers $a_i$, $b_i$ and $t_i$, representing the two barns that edge i connects. $t_i$ is $0$ if the herd along that edge is Charcolais, and $1$ if the  herd is Angus.", "outputFormat": "* Line $1$: One integer, representing the number of possible paths Farmer John can choose from.", "hint": "There are $7$ barns and $6$ edges. The edges from $1$ to $2$,$2$ to $4$ and $2$ to $5$ have Charcolais herds along them.\n\nNo path of length $2$ can have a suitable rest stop on it, so we can only consider paths of length $4$. The only path that has a suitable rest stop is $3-1-2-5-7$, with a rest stop at $2$.", "locale": "en"}, "zh-CN": {"title": "[USACO13OPEN] Yin and Yang G", "background": null, "description": "农夫约翰正计划在农场进行晨间散步。农场结构如同一棵树：\n拥有 $N$ 个谷仓$（1 \\leq N \\leq 100,000）$，这些谷仓通过 $N-1$ 条边相连，\n使得他可以从任意谷仓到达其他任何谷仓。农夫约翰希望选择一条\n起始于不同谷仓的路径，且不重复经过任何边。他担心路径可能过长，\n因此还想在这条路径上选择一个\"休息站\"谷仓（该谷仓不能是起点或终点）。\n\n每条边上都有一群牛，要么是夏洛莱牛（白毛），要么是安格斯牛（黑毛）。\n作为智者，农夫约翰希望平衡影响他散步的阴阳之力。为此，他需要选择这样一条路径：\n从起点到休息站经过的夏洛莱牛群与安格斯牛群数量相等，\n同时从休息站到终点经过的两种牛群数量也相等。\n\n农夫约翰想知道有多少条符合上述\"平衡\"条件的路径可供选择。\n两条路径仅当其边集不同时才被视为不同；即使某条路径上有多个\n符合条件的休息站位置，该路径也应只被计数一次。\n\n请帮助计算农夫约翰可以选择的路径数量！", "inputFormat": "* 第 $1$ 行: 整数 $N$\n\n* 第 $2$ ~ $N$ 行: 三个整数 $a_i$ , $b_i$ 和 $t_i$，表示边 $i$ 连接的两个谷仓。\n\n* $t_i$为 $0$ 表示该边上的牛群是夏洛莱牛，$1$ 表示是安格斯牛。", "outputFormat": "* 第 $1$ 行: 一个整数，表示农夫约翰可以选择的可能路径数量", "hint": "共有 $7$ 个谷仓和 $6$ 条边。连接 $1-2$、$2-4$ 和 $2-5$ 的边上有夏洛莱牛群。\n\n\n长度为 $2$ 的路径上不可能存在合适的休息站，因此我们只能考虑\n长度为 $4$ 的路径。唯一符合条件的路径是 $3-1-2-5-7$，休息站设在 $2$ 号谷仓。", "locale": "zh-CN"}}}
{"pid": "P3086", "type": "P", "difficulty": 6, "samples": [["15 \n............... \n............... \n...*******..... \n.*....*.......* \n.*......*....*. \n....*.......... \n...*...****.... \n............... \n..**.*..*..*... \n...*...**.*.... \n*..*...*....... \n............... \n.....*..*...... \n.........*..... \n............... \n", "3888 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "USACO", "枚举"], "title": "[USACO13OPEN] Figure Eight G", "background": "", "description": "Farmer John's cows recently received a large piece of marble, which, unfortunately, has a number of imperfections.  To describe these, we can represent the piece of marble by an N by N square grid (5 <= N <= 300), where the character '\\*' represents an imperfection and '.' represents a flawless section of the marble.\n\nThe cows want to carve a number \"8\" in this piece of marble (cows are quite fond of the number \"8\" since they have cloven hooves on each of their four feet, so they can effectively count up to 8 using their \"toes\"). However, the cows need your help to determine the optimally placed figure eight in the piece of marble.  Here are a few properties that define a valid figure eight:\n\n\\* A figure eight consists of two rectangles, a top and a bottom. \\* Both the top and bottom have at least one cell in their interior. \\* The bottom edge of the top rectangle is a (not necessarily proper) subset of the top edge of the bottom rectangle.\n\n\\* The figure eight can only be carved from flawless regions of the piece of marble.\n\nThe aesthetic score of a figure eight is equal to the product of the areas enclosed by its two rectangles.  The cows wish to maximize this score.\n\n```cpp\n............... \n............... \n...*******..... \n.*....*.......* \n.*......*....*. \n....*.......... \n...*...****.... \n............... \n..**.*..*..*... \n...*...**.*.... \n*..*...*....... \n............... \n.....*..*...... \n.........*..... \n............... \n```\nFor example, given this piece of marble \n\nthe optimally placed eight is:\n\n```cpp\n..88888888888.. \n..8.........8.. \n..8*******..8.. \n.*8...*.....8.* \n.*8.....*...8*. \n..8.*.......8.. \n..8*...****.8.. \n.88888888888888 \n.8**.*..*..*..8 \n.8.*...**.*...8 \n*8.*...*......8 \n.8............8 \n.8...*..*.....8 \n.8.......*....8 \n.88888888888888 \n```\nThe top rectangle has area 6x9=54, and the bottom rectangle has area 12x6=72.  Thus, its aesthetic score is 54x72=3888.\n\n农民约翰的奶牛最近收到了一大块大理石，不幸的是，它有许多缺陷.。为了描述这些，我们可以用n个正方形网格来表示一块大理石（5 < n = n = 300），其中字符“\\*”表示一个不完美和“。\n\n\n母牛想雕刻一个号码“8”在这一块大理石（牛很喜欢数字“8”，因为他们对他们的每一个四英尺，有偶蹄有效地数到8，用“脚”）。然而，奶牛需要你的帮助，以确定最佳放置在图八块大理石。这里有一些属性定义一个有效的数字八：\n\n\n图八包括两个矩形，一个顶部和一个底部。顶部和底部至少有一个单元在其内部。顶部矩形的底部边缘是底部矩形顶部边缘的一个（不一定是适当的）子集.。\n\n\n图八只能刻在大理石的无瑕疵区域。\n\n\n图八的美学得分等于其两个矩形所包围的区域的乘积.。奶牛希望最大限度地提高这一成绩。\n", "inputFormat": "\\* Line 1: A single integer N, indicating the side length of the marble.\n\n\\* Lines 2..N+1: Each line describes a row of the marble, and contains N characters which are each either '\\*' (an imperfection) or '.' (a flawless section).\n\n第1行：一个整数n，表示大理石的边长。\n\n\n行2 N + 1：每行描述了一排大理石，并包含n个字符，每个都是“\\*”（缺陷）或'.' (完整)。\n", "outputFormat": "\\* Line 1: The highest aesthetic score of any figure eight which doesn't use any imperfect squares of the marble.  If no figure eight is attainable, then output -1.\n", "hint": "顶部的矩形面积6X9 = 54，和底部矩形面积12x6 = 72。因此，它的审美评分54x72 = 3888。\n\n\n给出一个n×n的区域，其中有一些位置有瑕疵。现在要在没有瑕疵的位置中雕一个8”出来。\n\n\n“8”字的定义为两个矩形框，框内面积均大于0，且一个矩形框的底边是是另一个矩形框的顶边的子集。\n\n\n最大化两矩形框内面积的积。\n\n\n感谢 @3505515693qq 提供翻译\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO13OPEN] Figure Eight G", "background": "", "description": "Farmer John's cows recently received a large piece of marble which, unfortunately, has a number of imperfections. We can represent the piece of marble by an N by N square grid (where 5 <= N <= 300), where the character '*' represents an imperfection and '.' represents a flawless section of the marble.\n\nThe cows want to carve a number \"8\" in this piece of marble. However, they need your help to determine the optimally placed figure eight. A valid figure eight is defined by the following properties:\n- A figure eight consists of two rectangles, a top one and a bottom one.\n- Both the top and bottom rectangles have at least one cell in their interior.\n- The bottom edge of the top rectangle is a (not necessarily proper) subset of the top edge of the bottom rectangle.\n- The figure eight can only be carved from flawless regions of the marble.\n\nThe aesthetic score of a figure eight is equal to the product of the areas enclosed by its two rectangles. The goal is to maximize this score.", "inputFormat": "- Line 1: A single integer N, the side length of the marble.\n- Lines 2..N+1: Each line describes a row of the marble and contains N characters, each either '*' (an imperfection) or '.' (a flawless section).", "outputFormat": "- Line 1: The highest aesthetic score of any figure eight that does not use any imperfect squares of the marble. If no figure eight is attainable, output -1.", "hint": "For example, given this piece of marble:\n```cpp\n............... \n............... \n...*******..... \n.*....*.......* \n.*......*....*. \n....*.......... \n...*...****.... \n............... \n..**.*..*..*... \n...*...**.*.... \n*..*...*....... \n............... \n.....*..*...... \n.........*..... \n............... \n```\nthe optimally placed eight is:\n```cpp\n..88888888888.. \n..8.........8.. \n..8*******..8.. \n.*8...*.....8.* \n.*8.....*...8*. \n..8.*.......8.. \n..8*...****.8.. \n.88888888888888 \n.8**.*..*..*..8 \n.8.*...**.*...8 \n*8.*...*......8 \n.8............8 \n.8...*..*.....8 \n.8.......*....8 \n.88888888888888 \n```\nThe top rectangle has area $6 \\times 9 = 54$, and the bottom rectangle has area $12 \\times 6 = 72$. Thus, its aesthetic score is $54 \\times 72 = 3888$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO13OPEN] Figure Eight G", "background": "", "description": "Farmer John's cows recently received a large piece of marble, which, unfortunately, has a number of imperfections.  To describe these, we can represent the piece of marble by an N by N square grid (5 <= N <= 300), where the character '\\*' represents an imperfection and '.' represents a flawless section of the marble.\n\nThe cows want to carve a number \"8\" in this piece of marble (cows are quite fond of the number \"8\" since they have cloven hooves on each of their four feet, so they can effectively count up to 8 using their \"toes\"). However, the cows need your help to determine the optimally placed figure eight in the piece of marble.  Here are a few properties that define a valid figure eight:\n\n\\* A figure eight consists of two rectangles, a top and a bottom. \\* Both the top and bottom have at least one cell in their interior. \\* The bottom edge of the top rectangle is a (not necessarily proper) subset of the top edge of the bottom rectangle.\n\n\\* The figure eight can only be carved from flawless regions of the piece of marble.\n\nThe aesthetic score of a figure eight is equal to the product of the areas enclosed by its two rectangles.  The cows wish to maximize this score.\n\n```cpp\n............... \n............... \n...*******..... \n.*....*.......* \n.*......*....*. \n....*.......... \n...*...****.... \n............... \n..**.*..*..*... \n...*...**.*.... \n*..*...*....... \n............... \n.....*..*...... \n.........*..... \n............... \n```\nFor example, given this piece of marble \n\nthe optimally placed eight is:\n\n```cpp\n..88888888888.. \n..8.........8.. \n..8*******..8.. \n.*8...*.....8.* \n.*8.....*...8*. \n..8.*.......8.. \n..8*...****.8.. \n.88888888888888 \n.8**.*..*..*..8 \n.8.*...**.*...8 \n*8.*...*......8 \n.8............8 \n.8...*..*.....8 \n.8.......*....8 \n.88888888888888 \n```\nThe top rectangle has area 6x9=54, and the bottom rectangle has area 12x6=72.  Thus, its aesthetic score is 54x72=3888.\n\n农民约翰的奶牛最近收到了一大块大理石，不幸的是，它有许多缺陷.。为了描述这些，我们可以用n个正方形网格来表示一块大理石（5 < n = n = 300），其中字符“\\*”表示一个不完美和“。\n\n\n母牛想雕刻一个号码“8”在这一块大理石（牛很喜欢数字“8”，因为他们对他们的每一个四英尺，有偶蹄有效地数到8，用“脚”）。然而，奶牛需要你的帮助，以确定最佳放置在图八块大理石。这里有一些属性定义一个有效的数字八：\n\n\n图八包括两个矩形，一个顶部和一个底部。顶部和底部至少有一个单元在其内部。顶部矩形的底部边缘是底部矩形顶部边缘的一个（不一定是适当的）子集.。\n\n\n图八只能刻在大理石的无瑕疵区域。\n\n\n图八的美学得分等于其两个矩形所包围的区域的乘积.。奶牛希望最大限度地提高这一成绩。\n", "inputFormat": "\\* Line 1: A single integer N, indicating the side length of the marble.\n\n\\* Lines 2..N+1: Each line describes a row of the marble, and contains N characters which are each either '\\*' (an imperfection) or '.' (a flawless section).\n\n第1行：一个整数n，表示大理石的边长。\n\n\n行2 N + 1：每行描述了一排大理石，并包含n个字符，每个都是“\\*”（缺陷）或'.' (完整)。\n", "outputFormat": "\\* Line 1: The highest aesthetic score of any figure eight which doesn't use any imperfect squares of the marble.  If no figure eight is attainable, then output -1.\n", "hint": "顶部的矩形面积6X9 = 54，和底部矩形面积12x6 = 72。因此，它的审美评分54x72 = 3888。\n\n\n给出一个n×n的区域，其中有一些位置有瑕疵。现在要在没有瑕疵的位置中雕一个8”出来。\n\n\n“8”字的定义为两个矩形框，框内面积均大于0，且一个矩形框的底边是是另一个矩形框的顶边的子集。\n\n\n最大化两矩形框内面积的积。\n\n\n感谢 @3505515693qq 提供翻译\n", "locale": "zh-CN"}}}
{"pid": "P3087", "type": "P", "difficulty": 5, "samples": [["3 7 \nFarmer John has no large brown noisy cow. \nFarmer John has no small white silent cow. \nFarmer John has no large spotted noisy cow. \n", "small spotted noisy \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "USACO", "进制"], "title": "[USACO13NOV] Farmer John has no Large Brown Cow S", "background": "", "description": "Farmer John likes to collect as many different types of cows as possible. In fact, he has collected almost every conceivable type of cow, except for a few, written on a short list of N lines (1 <= N <= 100).  The list looks like this:\n\nFarmer John has no large brown noisy cow.\n\nFarmer John has no small white silent cow.\n\nFarmer John has no large spotted noisy cow.\n\nEach item in the list describes a missing cow in terms of a short list of adjectives, and each item contains the same number of adjectives (3, in this case).  The number of adjectives per line will be in the range 2..30.\n\nFarmer John has a cow fitting every other possible adjective combination not on his list.  In this example, the first adjective can be large or small, the second can be brown, white, or spotted, and the third can be noisy or silent.  This gives 2 x 3 x 2 = 12 different combinations, and Farmer John has a cow fitting each one, except for those specifically mentioned on his list.  In this example, a large, white, noisy cow is one of his 9 cows.  Farmer John is certain that he has at most 1,000,000,000 cows.\n\nIf Farmer John lists his cows in alphabetical order, what is the Kth cow in this list?\n\nPartial credit opportunities: In the 10 test cases for this problem, cases 1..4 involve at most two adjectives per line in Farmer John's list.  In cases 1..6, each adjective will have exactly two possible settings (in all other cases, each adjective will have between 1 and N possible settings).\n\nFJ喜欢收集不同的奶牛，他将未有的N(1 <= N <= 100)头奶牛用如下的形式描述：\n\n\nFarmer John has no large brown noisy cow.\n\n\nFarmer John has no small white silent cow.\n\n\nFarmer John has no large spotted noisy cow.\n\n\n每一行，描述一头FJ未有的牛。\n\n\n每一行都含有相同个数的形容词，每行的形容词个数范围为2..30。\n\n\n在以上给出的列表中，每行共有3个形容词，第一个形容词有两种（large和small），第二个形容词有3种（brown,white和spotted），第三个形容词有2种（noisy和silent）。\n\n\n所以共可以组成12头不同的奶牛，除了列表给出的3头，他已经拥有了其他9头。FJ最多有1,000,000,000头牛。\n\n\n若将FJ已经拥有的牛按形容词的字典序排序，请问他已有的第K头牛是哪一头。\n", "inputFormat": "\\* Line 1: Two integers, N and K.\n\n\\* Lines 2..1+N: Each line is a sentence like \"Farmer John has no large spotted noisy cow.\".  Each adjective in the sentence will be a string of at most 10 lowercase letters.  You know you have reached the end of the sentence when you see the string \"cow.\" ending with a period.\n", "outputFormat": "\\* Line 1: The description of the Kth cow on the farm.\n", "hint": "The input matches the sample given in the problem statement above.  Farmer John would like to know the 7th cow on his farm, when listed in alphabetical order.\n\n\nFarmer john has cows matching the following descriptions, listed in alphabetical order:\n\nlarge brown silent\n\nlarge spotted silent\n\nlarge white noisy\n\nlarge white silent\n\nsmall brown noisy\n\nsmall brown silent\n\nsmall spotted noisy\n\nsmall spotted silent\n\nsmall white noisy\n\nThe 7th cow in this list is described as \"small spotted noisy\".\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO13NOV] Farmer John has no Large Brown Cow S", "background": "", "description": "Farmer John likes to collect as many different types of cows as possible. In fact, he has collected almost every possible type of cow, except for a few, written on a short list of N lines (1 <= N <= 100). The list looks like this:\nFarmer John has no large brown noisy cow.\nFarmer John has no small white silent cow.\nFarmer John has no large spotted noisy cow.\nEach item in the list describes a missing cow using a short list of adjectives, and each item contains the same number of adjectives (3 in this case). The number of adjectives per line will be in the range 2..30.\nFarmer John has a cow matching every other possible adjective combination not on his list. In this example, the first adjective can be large or small, the second can be brown, white, or spotted, and the third can be noisy or silent. This gives 2 x 3 x 2 = 12 different combinations, and Farmer John has a cow for each one, except for those specifically mentioned on his list. In this example, a large white noisy cow is one of his 9 cows. Farmer John is certain that he has at most 1,000,000,000 cows.\nIf Farmer John lists his cows in alphabetical order, what is the K-th cow in this list?\nPartial credit opportunities: In the 10 test cases for this problem, cases 1..4 involve at most two adjectives per line in Farmer John’s list. In cases 1..6, each adjective will have exactly two possible settings (in all other cases, each adjective will have between 1 and N possible settings).", "inputFormat": "* Line 1: Two integers, N and K.\n* Lines 2..1+N: Each line is a sentence like \"Farmer John has no large spotted noisy cow.\". Each adjective in the sentence is a string of at most 10 lowercase letters. You know you have reached the end of the sentence when you see the string \"cow.\" ending with a period.", "outputFormat": "* Line 1: The description of the K-th cow on the farm.", "hint": "The input matches the sample given in the problem statement above. Farmer John would like to know the 7th cow on his farm, when listed in alphabetical order.\nFarmer John has cows matching the following descriptions, listed in alphabetical order:\nlarge brown silent\nlarge spotted silent\nlarge white noisy\nlarge white silent\nsmall brown noisy\nsmall brown silent\nsmall spotted noisy\nsmall spotted silent\nsmall white noisy\nThe 7th cow in this list is described as \"small spotted noisy\".\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO13NOV] Farmer John has no Large Brown Cow S", "background": "", "description": "Farmer John likes to collect as many different types of cows as possible. In fact, he has collected almost every conceivable type of cow, except for a few, written on a short list of N lines (1 <= N <= 100).  The list looks like this:\n\nFarmer John has no large brown noisy cow.\n\nFarmer John has no small white silent cow.\n\nFarmer John has no large spotted noisy cow.\n\nEach item in the list describes a missing cow in terms of a short list of adjectives, and each item contains the same number of adjectives (3, in this case).  The number of adjectives per line will be in the range 2..30.\n\nFarmer John has a cow fitting every other possible adjective combination not on his list.  In this example, the first adjective can be large or small, the second can be brown, white, or spotted, and the third can be noisy or silent.  This gives 2 x 3 x 2 = 12 different combinations, and Farmer John has a cow fitting each one, except for those specifically mentioned on his list.  In this example, a large, white, noisy cow is one of his 9 cows.  Farmer John is certain that he has at most 1,000,000,000 cows.\n\nIf Farmer John lists his cows in alphabetical order, what is the Kth cow in this list?\n\nPartial credit opportunities: In the 10 test cases for this problem, cases 1..4 involve at most two adjectives per line in Farmer John's list.  In cases 1..6, each adjective will have exactly two possible settings (in all other cases, each adjective will have between 1 and N possible settings).\n\nFJ喜欢收集不同的奶牛，他将未有的N(1 <= N <= 100)头奶牛用如下的形式描述：\n\n\nFarmer John has no large brown noisy cow.\n\n\nFarmer John has no small white silent cow.\n\n\nFarmer John has no large spotted noisy cow.\n\n\n每一行，描述一头FJ未有的牛。\n\n\n每一行都含有相同个数的形容词，每行的形容词个数范围为2..30。\n\n\n在以上给出的列表中，每行共有3个形容词，第一个形容词有两种（large和small），第二个形容词有3种（brown,white和spotted），第三个形容词有2种（noisy和silent）。\n\n\n所以共可以组成12头不同的奶牛，除了列表给出的3头，他已经拥有了其他9头。FJ最多有1,000,000,000头牛。\n\n\n若将FJ已经拥有的牛按形容词的字典序排序，请问他已有的第K头牛是哪一头。\n", "inputFormat": "\\* Line 1: Two integers, N and K.\n\n\\* Lines 2..1+N: Each line is a sentence like \"Farmer John has no large spotted noisy cow.\".  Each adjective in the sentence will be a string of at most 10 lowercase letters.  You know you have reached the end of the sentence when you see the string \"cow.\" ending with a period.\n", "outputFormat": "\\* Line 1: The description of the Kth cow on the farm.\n", "hint": "The input matches the sample given in the problem statement above.  Farmer John would like to know the 7th cow on his farm, when listed in alphabetical order.\n\n\nFarmer john has cows matching the following descriptions, listed in alphabetical order:\n\nlarge brown silent\n\nlarge spotted silent\n\nlarge white noisy\n\nlarge white silent\n\nsmall brown noisy\n\nsmall brown silent\n\nsmall spotted noisy\n\nsmall spotted silent\n\nsmall white noisy\n\nThe 7th cow in this list is described as \"small spotted noisy\".\n", "locale": "zh-CN"}}}
{"pid": "P3088", "type": "P", "difficulty": 4, "samples": [["6 4 \n10 3 \n6 2 \n5 3 \n9 7 \n3 6 \n11 2 \n", "2 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "二分", "USACO", "单调队列", "排序", "队列", "ST 表"], "title": "[USACO13NOV] Crowded Cows S", "background": "", "description": "Farmer John's $N$ cows ($1 \\le N \\le 50,000$) are grazing along a one-dimensional fence. Cow $i$ is standing at location $x_i$ and has height $h_i$ ($1 \\le x_i,h_i \\le 1,000,000,000$).\n\nA cow feels \"crowded\" if there is another cow at least twice her height within distance $D$ on her left, and also another cow at least twice her height within distance $D$ on her right ($1 \\le D \\le 1,000,000,000$). Since crowded cows produce less milk, Farmer John would like to count the number of such cows. Please help him.", "inputFormat": "* Line $1$: Two integers, $N$ and $D$.\n\n* Lines $2..1+N$: Line $i+1$ contains the integers $x_i$ and $h_i$. The locations of all $N$ cows are distinct.", "outputFormat": "* Line $1$: The number of crowded cows.", "hint": "There are $6$ cows, with a distance threshold of $4$ for feeling crowded. Cow #1 lives at position $x=10$ and has height $h=3$, and so on.\n\nThe cows at positions $x=5$ and $x=6$ are both crowded.", "locale": "en", "translations": {"en": {"title": "[USACO13NOV] Crowded Cows S", "background": "", "description": "Farmer John's $N$ cows ($1 \\le N \\le 50,000$) are grazing along a one-dimensional fence. Cow $i$ is standing at location $x_i$ and has height $h_i$ ($1 \\le x_i,h_i \\le 1,000,000,000$).\n\nA cow feels \"crowded\" if there is another cow at least twice her height within distance $D$ on her left, and also another cow at least twice her height within distance $D$ on her right ($1 \\le D \\le 1,000,000,000$). Since crowded cows produce less milk, Farmer John would like to count the number of such cows. Please help him.", "inputFormat": "* Line $1$: Two integers, $N$ and $D$.\n\n* Lines $2..1+N$: Line $i+1$ contains the integers $x_i$ and $h_i$. The locations of all $N$ cows are distinct.", "outputFormat": "* Line $1$: The number of crowded cows.", "hint": "There are $6$ cows, with a distance threshold of $4$ for feeling crowded. Cow #1 lives at position $x=10$ and has height $h=3$, and so on.\n\nThe cows at positions $x=5$ and $x=6$ are both crowded.", "locale": "en"}, "zh-CN": {"title": "[USACO13NOV] Crowded Cows S", "background": null, "description": "FJ 有 $N(1\\le N\\le50000)$ 头奶牛沿着一维的栅栏吃草，第 $i$ 头奶牛在目标点 $x_i$ ，它的身高是 $h_i (1 \\le x_i,h_i\\le10^9)$。\n\n当一头奶牛左边 $D(1\\le D\\le10^9)$ 距离内且右边 $D$ 距离内有身高至少是它的两倍的奶牛，它就会觉得拥挤。\n\n请计算觉得拥挤的奶牛的数量。", "inputFormat": "第一行两个整数 $N,D$。\n\n接下来 $N$ 行，每行两个整数 $x_i,h_i$。保证 $x_i$ 互不相同。", "outputFormat": "一行一个整数，表示觉得拥挤的奶牛的数量。", "hint": "共有 $6$ 头奶牛，拥挤感知距离为 $4$。$1$ 号奶牛位于位置 $10$，身高为 $3$，依此类推。\n\n位于位置 $5$ 和位置 $6$ 的两头奶牛处于拥挤状态。", "locale": "zh-CN"}}}
{"pid": "P3089", "type": "P", "difficulty": 5, "samples": [["6 \n5 6 \n1 1 \n10 5 \n7 6 \n4 8 \n8 10 \n", "25 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "2013", "USACO", "枚举", "双指针 two-pointer"], "title": "[USACO13NOV] Pogo-Cow S", "background": "", "description": "In an ill-conceived attempt to enhance the mobility of his prize cow Bessie, Farmer John has attached a pogo stick to each of Bessie's legs. Bessie can now hop around quickly throughout the farm, but she has not yet learned how to slow down.\n\nTo help train Bessie to hop with greater control, Farmer John sets up a practice course for her along a straight one-dimensional path across his farm.  At various distinct positions on the path, he places N targets on which Bessie should try to land (1 <= N <= 1000).  Target i is located at position x(i), and is worth p(i) points if Bessie lands on it.  Bessie starts at the location of any target of her choosing and is allowed to move in only one direction, hopping from target to target.  Each hop must cover at least as much distance as the previous hop, and must land on a target.\n\nBessie receives credit for every target she touches (including the initial target on which she starts).  Please compute the maximum number of points she can obtain.\n\nFJ给奶牛贝西的脚安装上了弹簧，使它可以在农场里快速地跳跃，但是它还没有学会如何降低速度。\n\n\nFJ觉得让贝西在一条直线的一维线路上进行练习，他在不同的目标点放置了N (1 <= N <= 1000)个目标点，目标点i在目标点x(i)，该点得分为p(i)。贝西开始时可以选择站在一个目标点上，只允许朝一个方向跳跃，从一目标点跳到另外一个目标点，每次跳跃的距离至少和上一次跳跃的距离相等，并且必须跳到一个目标点。\n\n\n每跳到一个目标点，贝西可以拿到该点的得分，请计算他的最大可能得分。\n", "inputFormat": "\\* Line 1: The integer N.\n\n\\* Lines 2..1+N: Line i+1 contains x(i) and p(i), each an integer in the range 0..1,000,000.\n", "outputFormat": "\\* Line 1: The maximum number of points Bessie can receive.\n", "hint": "There are 6 targets.  The first is at position x=5 and is worth 6 points, and so on.\n\n\nBessie hops from position x=4 (8 points) to position x=5 (6 points) to position x=7 (6 points) to position x=10 (5 points).\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO13NOV] Pogo-Cow S", "background": "", "description": "In an ill-conceived attempt to enhance the mobility of his prize cow Bessie, Farmer John has attached a pogo stick to each of Bessie's legs. Bessie can now hop around quickly throughout the farm, but she has not yet learned how to slow down.\n\nTo help train Bessie to hop with greater control, Farmer John sets up a practice course for her along a straight one-dimensional path across his farm. At various distinct positions on the path, he places N targets (1 ≤ N ≤ 1000) on which Bessie should try to land. Target i is located at position x(i), and is worth p(i) points if Bessie lands on it. Bessie starts at the location of any target of her choosing and is allowed to move in only one direction, hopping from target to target. Each hop must cover at least as much distance as the previous hop, and must land on a target.\n\nBessie receives credit for every target she touches (including the initial target on which she starts). Please compute the maximum number of points she can obtain.", "inputFormat": "* Line 1: The integer N.\n* Lines 2..1+N: Line i+1 contains x(i) and p(i), each an integer in the range 0..1,000,000.", "outputFormat": "* Line 1: The maximum number of points Bessie can receive.", "hint": "There are 6 targets. The first is at position x = 5 and is worth 6 points, and so on.\n\nBessie hops from position x = 4 (8 points) to position x = 5 (6 points) to position x = 7 (6 points) to position x = 10 (5 points).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO13NOV] Pogo-Cow S", "background": "", "description": "In an ill-conceived attempt to enhance the mobility of his prize cow Bessie, Farmer John has attached a pogo stick to each of Bessie's legs. Bessie can now hop around quickly throughout the farm, but she has not yet learned how to slow down.\n\nTo help train Bessie to hop with greater control, Farmer John sets up a practice course for her along a straight one-dimensional path across his farm.  At various distinct positions on the path, he places N targets on which Bessie should try to land (1 <= N <= 1000).  Target i is located at position x(i), and is worth p(i) points if Bessie lands on it.  Bessie starts at the location of any target of her choosing and is allowed to move in only one direction, hopping from target to target.  Each hop must cover at least as much distance as the previous hop, and must land on a target.\n\nBessie receives credit for every target she touches (including the initial target on which she starts).  Please compute the maximum number of points she can obtain.\n\nFJ给奶牛贝西的脚安装上了弹簧，使它可以在农场里快速地跳跃，但是它还没有学会如何降低速度。\n\n\nFJ觉得让贝西在一条直线的一维线路上进行练习，他在不同的目标点放置了N (1 <= N <= 1000)个目标点，目标点i在目标点x(i)，该点得分为p(i)。贝西开始时可以选择站在一个目标点上，只允许朝一个方向跳跃，从一目标点跳到另外一个目标点，每次跳跃的距离至少和上一次跳跃的距离相等，并且必须跳到一个目标点。\n\n\n每跳到一个目标点，贝西可以拿到该点的得分，请计算他的最大可能得分。\n", "inputFormat": "\\* Line 1: The integer N.\n\n\\* Lines 2..1+N: Line i+1 contains x(i) and p(i), each an integer in the range 0..1,000,000.\n", "outputFormat": "\\* Line 1: The maximum number of points Bessie can receive.\n", "hint": "There are 6 targets.  The first is at position x=5 and is worth 6 points, and so on.\n\n\nBessie hops from position x=4 (8 points) to position x=5 (6 points) to position x=7 (6 points) to position x=10 (5 points).\n", "locale": "zh-CN"}}}
{"pid": "P3090", "type": "P", "difficulty": 3, "samples": [["10 3 \n3 2 2 4 \n2 1 0 1 \n1 1 1 7 \n", "5 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "2013", "USACO", "并查集"], "title": "[USACO13NOV] Empty Stalls G", "background": "Farmer John's new barn consists of a huge circle of $N$ stalls ($2 \\le N \\le 3{,}000{,}000$), numbered $0..N-1$, with stall $N-1$ being adjacent to stall $0$.\n\nAt the end of each day, FJ's cows arrive back at the barn one by one, each with a preferred stall they would like to occupy. However, if a cow's preferred stall is already occupied by another cow, she scans forward sequentially from this stall until she finds the first unoccupied stall, which she then claims. If she scans past stall $N-1$, she continues scanning from stall $0$.\n\nGiven the preferred stall of each cow, determine the smallest index of a stall that remains unoccupied after all the cows have returned to the barn. Notice that the answer does not depend on the order in which the cows return.\n\nTo avoid reading huge amounts of input, the input is specified concisely using $K$ lines ($1 \\le K \\le 10{,}000$), each of the form:\nX Y A B\n\nOne such line specifies preferences for $X \\times Y$ cows in total: $X$ cows prefer each of the stalls $f(1), \\dots, f(Y)$, where $f(i) = (A i + B) \\bmod N$. The values of $A$ and $B$ lie in the range $0 \\dots 1{,}000{,}000{,}000$.\n\nNote: The standard memory limit is 64 MB.", "description": "Farmer John's new barn consists of a huge circle of $N$ stalls ($2 \\le N \\le 3{,}000{,}000$), numbered $0..N-1$, with stall $N-1$ being adjacent to stall $0$.\n\nAt the end of each day, FJ's cows arrive back at the barn one by one, each with a preferred stall they would like to occupy. However, if a cow's preferred stall is already occupied by another cow, she scans forward sequentially from this stall until she finds the first unoccupied stall, which she then claims. If she scans past stall $N-1$, she continues scanning from stall $0$.\n\nGiven the preferred stall of each cow, determine the smallest index of a stall that remains unoccupied after all the cows have returned to the barn. Notice that the answer does not depend on the order in which the cows return.\n\nTo avoid reading huge amounts of input, the input is specified concisely using $K$ lines ($1 \\le K \\le 10{,}000$), each of the form:\nX Y A B\n\nOne such line specifies preferences for $X \\times Y$ cows in total: $X$ cows prefer each of the stalls $f(1), \\dots, f(Y)$, where $f(i) = (A i + B) \\bmod N$. The values of $A$ and $B$ lie in the range $0 \\dots 1{,}000{,}000{,}000$.\n\nNote: The standard memory limit is 64 MB.\n\n", "inputFormat": "- Line 1: Two space-separated integers $N$ and $K$.\n- Lines $2..1+K$: Each line contains integers $X$ $Y$ $A$ $B$, interpreted as above. The total number of cows specified by all lines will be at most $N-1$. Multiple lines may add cows preferring the same stall.", "outputFormat": "- Line 1: The minimum index of an unoccupied stall.", "hint": "There are 10 stalls in the barn, numbered $0..9$. The second line of input states that 3 cows prefer stall $(2 \\cdot 1 + 4) \\bmod 10 = 6$, and 3 cows prefer stall $(2 \\cdot 2 + 4) \\bmod 10 = 8$. The third line states that 2 cows prefer stall $(0 \\cdot 1 + 1) \\bmod 10 = 1$. Line four specifies that 1 cow prefers stall $(1 \\cdot 1 + 7) \\bmod 10 = 8$ (so a total of 4 cows prefer this stall).\n\nAll stalls will end up occupied except stall 5.\n\nTranslated by ChatGPT 5", "locale": "en", "translations": {"en": {"title": "[USACO13NOV] Empty Stalls G", "background": "Farmer John's new barn consists of a huge circle of $N$ stalls ($2 \\le N \\le 3{,}000{,}000$), numbered $0..N-1$, with stall $N-1$ being adjacent to stall $0$.\n\nAt the end of each day, FJ's cows arrive back at the barn one by one, each with a preferred stall they would like to occupy. However, if a cow's preferred stall is already occupied by another cow, she scans forward sequentially from this stall until she finds the first unoccupied stall, which she then claims. If she scans past stall $N-1$, she continues scanning from stall $0$.\n\nGiven the preferred stall of each cow, determine the smallest index of a stall that remains unoccupied after all the cows have returned to the barn. Notice that the answer does not depend on the order in which the cows return.\n\nTo avoid reading huge amounts of input, the input is specified concisely using $K$ lines ($1 \\le K \\le 10{,}000$), each of the form:\nX Y A B\n\nOne such line specifies preferences for $X \\times Y$ cows in total: $X$ cows prefer each of the stalls $f(1), \\dots, f(Y)$, where $f(i) = (A i + B) \\bmod N$. The values of $A$ and $B$ lie in the range $0 \\dots 1{,}000{,}000{,}000$.\n\nNote: The standard memory limit is 64 MB.", "description": "Farmer John's new barn consists of a huge circle of $N$ stalls ($2 \\le N \\le 3{,}000{,}000$), numbered $0..N-1$, with stall $N-1$ being adjacent to stall $0$.\n\nAt the end of each day, FJ's cows arrive back at the barn one by one, each with a preferred stall they would like to occupy. However, if a cow's preferred stall is already occupied by another cow, she scans forward sequentially from this stall until she finds the first unoccupied stall, which she then claims. If she scans past stall $N-1$, she continues scanning from stall $0$.\n\nGiven the preferred stall of each cow, determine the smallest index of a stall that remains unoccupied after all the cows have returned to the barn. Notice that the answer does not depend on the order in which the cows return.\n\nTo avoid reading huge amounts of input, the input is specified concisely using $K$ lines ($1 \\le K \\le 10{,}000$), each of the form:\nX Y A B\n\nOne such line specifies preferences for $X \\times Y$ cows in total: $X$ cows prefer each of the stalls $f(1), \\dots, f(Y)$, where $f(i) = (A i + B) \\bmod N$. The values of $A$ and $B$ lie in the range $0 \\dots 1{,}000{,}000{,}000$.\n\nNote: The standard memory limit is 64 MB.\n\n", "inputFormat": "- Line 1: Two space-separated integers $N$ and $K$.\n- Lines $2..1+K$: Each line contains integers $X$ $Y$ $A$ $B$, interpreted as above. The total number of cows specified by all lines will be at most $N-1$. Multiple lines may add cows preferring the same stall.", "outputFormat": "- Line 1: The minimum index of an unoccupied stall.", "hint": "There are 10 stalls in the barn, numbered $0..9$. The second line of input states that 3 cows prefer stall $(2 \\cdot 1 + 4) \\bmod 10 = 6$, and 3 cows prefer stall $(2 \\cdot 2 + 4) \\bmod 10 = 8$. The third line states that 2 cows prefer stall $(0 \\cdot 1 + 1) \\bmod 10 = 1$. Line four specifies that 1 cow prefers stall $(1 \\cdot 1 + 7) \\bmod 10 = 8$ (so a total of 4 cows prefer this stall).\n\nAll stalls will end up occupied except stall 5.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO13NOV] Empty Stalls G", "background": null, "description": "约翰的谷仓中有 $N(2 \\le N \\le 3\\times 10^{6})$ 个房间，编号 $0$ 到 $N-1$，这些房间排布成环状,编号 $0$ 的和编号 $N-1$ 的相邻。\n\n每天傍晚，奶牛们一只一只排队回到谷仓，每头奶牛都有一个喜欢的房间，但是，如果它喜欢的房间已被其他奶牛占了，它会向前挨个探索其他房间（如果它探索过了 $N-1$ 号房间，它会继续探索 $0$ 号房间，以此继续下去）直到探到第一个没有被占用的房间，这时它会宣布占用这个房间。\n\n告诉你每头奶牛喜欢的房间，当所有奶牛都找到房间后，剩下的没被占用的房间中，编号最小的是哪个。很明显，问题的答案与奶牛进入谷仓的顺序无关。\n\n为避免输入内容过多。本题的输入数据采用一种简洁的方式：一共 $K(1 \\le K \\le 10^{4})$ 行，每行格式如下：\n\n> $X\\ Y\\ A\\ B$\n\n表示有 $Y$ 批奶牛，每批 $X$ 头，也就是总共 $X\\times Y$ 只奶牛喜欢的房间号。$Y$ 批奶牛编号 $1$ 到 $Y$，第 $i$ 批 $X$ 头奶牛喜欢的房间号为$(A \\times i+B) \\bmod N$。\n\n$A$ 和 $B$ 的取值范围为 $0\\dots 10^{9}$。\n\n注意，只有 64M 的空间。", "inputFormat": "第一行，两个用空格隔开的整数,$N$ 和 $K$。\n\n第二行到第 $K+1$ 行，每行包含四个整数 $X,Y,A,B$，解释看题目描述。牛的总数最多为 $N-1$ ，可以向同一个牛栏中添加牛。", "outputFormat": "一行一个整数，表示最小的移动次数。", "hint": "谷仓里有 $10$ 个牛栏，编号为 $0$ 到 $9$。输入的第二行表示有 $3$ 头牛喜欢牛栏 $(2 \\times 1 + 4) \\bmod 10 = 6$，另有 $3$ 头牛喜欢牛栏 $(2 \\times 2 + 4) \\bmod 10 = 8$。第三行表示有 $2$ 头牛喜欢牛栏 $(0\\times 1 + 1) \\bmod 10 = 1$。第四行表示有 $1$ 头牛喜欢牛栏 $(1 \\times 1 + 7) \\bmod 10 = 8$（所以总共有 $4$ 头牛喜欢这个牛栏）。\n\n除了牛栏 $5$ 之外，其他所有牛栏最后都会被占用。", "locale": "zh-CN"}}}
{"pid": "P3091", "type": "P", "difficulty": 6, "samples": [["4 5 \n0 10 \n0 -10 \n10 0 \n-10 0 \n", "4 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "USACO"], "title": "[USACO13NOV] Line of Sight G", "background": "", "description": "Farmer John's N cows (1 <= N <= 50,000) are located at distinct points in his two-dimensional pasture.  In the middle of the pasture is a large circular grain silo.  Cows on opposite sides of the silo cannot see each-other, since the silo blocks their view.  Please determine the number of pairs of cows that can see each-other via a direct line of sight.\n\nThe grain silo is centered at the origin (0,0) and has radius R.  No cow is located on or inside the circle corresponding to the silo, and no two cows lie on a tangent line to the silo.  The value of R is in the range 1..1,000,000, and each cow lives at a point with integer coordinates in the range -1,000,000..+1,000,000.\n\n给定平面上的 $N$ 个点，求有多少点对能互相看见而不被以原点为圆心，$R$ 为半径的圆挡住。\n\n题目保证不存在圆上或圆内的点，也不存在连接两点的线段为圆的切线。\n\n$1\\le N\\le50000$\n\n$1\\le R\\le10^6$ \n\n$|x|,|y|\\le10^6$", "inputFormat": "\\* Line 1: Two integers: N and R.\n\n\\* Lines 2..1+N: Each line contains two integers specifying the (x,y) coordinates of a cow.\n", "outputFormat": "\\* Line 1: The number of pairs of cows who can see each-other.\n", "hint": "There are 4 cows at positions (0,10), (0,-10), (10,0), and (-10,0).  The silo is centered at (0,0) and has radius 5.\n\n\nAll 6 pairs of cows can see each-other, except for the pairs situated on opposite sides of the silo: the cows at (-10,0) and (10,0) cannot see each-other, and the cows at (0,-10) and (0,10) cannot see each-other.\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO13NOV] Line of Sight G", "background": "", "description": "Farmer John's $N$ cows ($1 \\le N \\le 50000$) are located at distinct points in his two-dimensional pasture. In the middle of the pasture is a large circular grain silo. Cows on opposite sides of the silo cannot see each other, since the silo blocks their view. Please determine the number of pairs of cows that can see each other via a direct line of sight.\n\nThe grain silo is centered at the origin $(0, 0)$ and has radius $R$. No cow is located on or inside the circle corresponding to the silo, and no two cows lie on a tangent line to the silo. The value of $R$ is in the range $1..1{,}000{,}000$, and each cow lives at a point with integer coordinates in the range $-1{,}000{,}000..+1{,}000{,}000$.\n\nEquivalent statement: Given $N$ points on the plane, count the number of pairs that can see each other without being blocked by a circle centered at the origin with radius $R$. It is guaranteed that no point lies on or inside the circle, and no segment connecting two points is tangent to the circle.\n\nConstraints:\n$1 \\le N \\le 50000$.\n$1 \\le R \\le 10^6$.\n$|x|, |y| \\le 10^6$.", "inputFormat": "- Line 1: Two integers $N$ and $R$.\n- Lines $2..N+1$: Each line contains two integers specifying the coordinates $(x, y)$ of a cow.", "outputFormat": "- Line 1: The number of pairs of cows that can see each other.", "hint": "There are 4 cows at positions $(0, 10)$, $(0, -10)$, $(10, 0)$, and $(-10, 0)$. The silo is centered at $(0, 0)$ and has radius $5$.\n\nAll 6 pairs of cows can see each other, except for the pairs situated on opposite sides of the silo: the cows at $(-10, 0)$ and $(10, 0)$ cannot see each other, and the cows at $(0, -10)$ and $(0, 10)$ cannot see each other.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO13NOV] Line of Sight G", "background": "", "description": "Farmer John's N cows (1 <= N <= 50,000) are located at distinct points in his two-dimensional pasture.  In the middle of the pasture is a large circular grain silo.  Cows on opposite sides of the silo cannot see each-other, since the silo blocks their view.  Please determine the number of pairs of cows that can see each-other via a direct line of sight.\n\nThe grain silo is centered at the origin (0,0) and has radius R.  No cow is located on or inside the circle corresponding to the silo, and no two cows lie on a tangent line to the silo.  The value of R is in the range 1..1,000,000, and each cow lives at a point with integer coordinates in the range -1,000,000..+1,000,000.\n\n给定平面上的 $N$ 个点，求有多少点对能互相看见而不被以原点为圆心，$R$ 为半径的圆挡住。\n\n题目保证不存在圆上或圆内的点，也不存在连接两点的线段为圆的切线。\n\n$1\\le N\\le50000$\n\n$1\\le R\\le10^6$ \n\n$|x|,|y|\\le10^6$", "inputFormat": "\\* Line 1: Two integers: N and R.\n\n\\* Lines 2..1+N: Each line contains two integers specifying the (x,y) coordinates of a cow.\n", "outputFormat": "\\* Line 1: The number of pairs of cows who can see each-other.\n", "hint": "There are 4 cows at positions (0,10), (0,-10), (10,0), and (-10,0).  The silo is centered at (0,0) and has radius 5.\n\n\nAll 6 pairs of cows can see each-other, except for the pairs situated on opposite sides of the silo: the cows at (-10,0) and (10,0) cannot see each-other, and the cows at (0,-10) and (0,10) cannot see each-other.\n", "locale": "zh-CN"}}}
{"pid": "P3092", "type": "P", "difficulty": 5, "samples": [["3 6 \n12 \n15 \n10 \n6 \n3 \n3 \n2 \n3 \n7 \n", "12 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "二分", "USACO", "单调队列", "前缀和", "状压 DP"], "title": "[USACO13NOV] No Change G", "background": "", "description": "Farmer John is at the market to purchase supplies for his farm. He has in his pocket $K$ coins ($1 \\leq K \\leq 16$), each with value in the range $1...100,000,000$. FJ would like to make a sequence of $N$ purchases ($1 \\leq N \\leq 100,000$), where the ith purchase costs $c(i)$ units of money ($1 \\leq c(i) \\leq 10,000$). As he makes this sequence of purchases, he can periodically stop and pay, with a single coin, for all the purchases made since his last payment (of course, the single coin he uses must be large enough to pay for all of these). Unfortunately, the vendors at the market are completely out of change, so whenever FJ uses a coin that is larger than the amount of money he owes, he sadly receives no changes in return!\n\nPlease compute the maximum amount of money FJ can end up with after making his $N$ purchases in sequence. Output $-1$ if it is impossible for FJ to make all of his purchases.", "inputFormat": "Line $1$: Two integers, $K$ and $N$.\n\nLines $2...1+K$: Each line contains the amount of money of one of FJ's coins.\n\nLines $2+K...1+N+K$: These $N$ lines contain the costs of FJ's intended purchases.", "outputFormat": "Line $1$: The maximum amount of money FJ can end up with, or $-1$ if FJ cannot complete all of his purchases.", "hint": "FJ has $3$ coins of values $12$, $15$, and $10$. He must make purchases in sequence of value $6$, $3$, $3$, $2$, $3$, and $7$.\n\nFJ spends his 10-unit coin on the first two purchases, then the 15-unit coin on the remaining purchases. This leaves him with the 12-unit coin.", "locale": "en", "translations": {"en": {"title": "[USACO13NOV] No Change G", "background": "", "description": "Farmer John is at the market to purchase supplies for his farm. He has in his pocket $K$ coins ($1 \\leq K \\leq 16$), each with value in the range $1...100,000,000$. FJ would like to make a sequence of $N$ purchases ($1 \\leq N \\leq 100,000$), where the ith purchase costs $c(i)$ units of money ($1 \\leq c(i) \\leq 10,000$). As he makes this sequence of purchases, he can periodically stop and pay, with a single coin, for all the purchases made since his last payment (of course, the single coin he uses must be large enough to pay for all of these). Unfortunately, the vendors at the market are completely out of change, so whenever FJ uses a coin that is larger than the amount of money he owes, he sadly receives no changes in return!\n\nPlease compute the maximum amount of money FJ can end up with after making his $N$ purchases in sequence. Output $-1$ if it is impossible for FJ to make all of his purchases.", "inputFormat": "Line $1$: Two integers, $K$ and $N$.\n\nLines $2...1+K$: Each line contains the amount of money of one of FJ's coins.\n\nLines $2+K...1+N+K$: These $N$ lines contain the costs of FJ's intended purchases.", "outputFormat": "Line $1$: The maximum amount of money FJ can end up with, or $-1$ if FJ cannot complete all of his purchases.", "hint": "FJ has $3$ coins of values $12$, $15$, and $10$. He must make purchases in sequence of value $6$, $3$, $3$, $2$, $3$, and $7$.\n\nFJ spends his 10-unit coin on the first two purchases, then the 15-unit coin on the remaining purchases. This leaves him with the 12-unit coin.", "locale": "en"}, "zh-CN": {"title": "[USACO13NOV] No Change G", "background": null, "description": "Farmer John 到商场购物，他的钱包里有 $K(1\\le K\\le 16)$ 个硬币，面值的范围是 $[1,10^8]$。\n\nFJ 想按顺序买 $N$ 个物品 $(1\\le N\\le 10^5)$，第 $i$ 个物品需要花费 $c_i$ 块钱，$(1\\le c_i \\le 10^4)$。\n\n在依次进行的购买 $N$ 个物品的过程中，FJ 可以随时停下来付款，每次付款只用一个硬币，支付购买的内容是从上一次支付后开始到现在的这些所有物品（前提是该硬币足以支付这些物品的费用）。不幸的是，商场的收银机坏了，如果FJ支付的硬币面值大于所需的费用，他不会得到任何找零。\n\n请计算出在购买完 $N$ 个物品后，FJ 最多剩下多少钱。如果无法完成购买，输出 $-1$。", "inputFormat": "第 $1$ 行两个整数，$K$ 和 $N$。\n\n第 $2$ 行到第 $K+1$ 行每行包含 FJ 的一个硬币的金额。\n\n第 $K+2$ 行到第 $N+K+1$ 行共 $N$ 行，每行包含 FJ 的准备购买的物品的成本。（注：即 $c_i$。）", "outputFormat": "第 $1$ 行：FJ 最终能剩余的最大金额；若无法完成所有购买，则输出 $-1$。", "hint": "**样例说明**\n\nFJ 拥有三枚面值分别为 $12$、$15$ 和 $10$ 的硬币。他需要按顺序完成价值 $6$、$3$、$3$、$2$、$3$ 和 $7$ 的购买。\n\nFJ 用 $10$ 面值的硬币支付前两次购买（$6+3$），随后用 $15$ 面值的硬币支付剩余购买（$3+2+3+7$），最终剩下 $12$ 面值的硬币。", "locale": "zh-CN"}}}
{"pid": "P3093", "type": "P", "difficulty": 3, "samples": [["4 \n10 3 \n7 5 \n8 1 \n2 1 \n", "25 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "递推", "2013", "USACO", "优先队列", "反悔贪心"], "title": "[USACO13DEC] Milk Scheduling S", "background": null, "description": "FJ 有 $N$（$1 \\le N \\le 10,000$）头牛要挤牛奶，为每头牛挤牛奶需要花费 $1$ 单位时间。\n\n奶牛很厌烦等待，奶牛 $i$ 在它的截止时间 $d_i$（$1 \\le d_i \\le 10,000$）前能挤出 $g_i$（$1 \\le g_i \\le 1000$）加仑的牛奶，否则将不能挤出牛奶。时间 $t$ 开始时为 $0$，即在时间 $t=x$ 之前，最多可以给 $x$ 头奶牛挤牛奶。\n\n\n请计算 FJ 的最大挤奶量。", "inputFormat": "第一行一个整数 $N$。\n\n第 $2$ 至第 $(N+1)$ 行，第 $(i+1)$ 行两个整数 $g_i$ 和 $d_i$。", "outputFormat": "一行一个整数，表示 FJ 最多能得到多少加仑的牛奶。", "hint": "有 $4$ 头奶牛。第一头奶牛如果在时刻 $3$ 之前（不包含时刻 $3$）被挤可以产出 $10$ 加仑牛奶，其它奶牛以此类推。\n\nFJ 在 $0$ 时刻开始给奶牛 $3$ 挤牛奶（放弃在奶牛 $4$ 的时间限制之前给它挤牛奶，因为和奶牛 $3$ 冲突），消耗 $1$ 单位时间并得到 $8$ 加仑的牛奶；在时刻 $1$ 给奶牛 $1$ 挤牛奶，在时刻 $2$ 给奶牛 $2$ 挤牛奶。\n\n一共获得 $8+10+7=25$ 加仑的牛奶。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO13DEC] Milk Scheduling S", "background": null, "description": "Farmer John has $N$ cows that need to be milked ($1 \\le N \\le 10,000$), each of which takes only one unit of time to milk.\n\nBeing impatient animals, some cows will refuse to be milked if Farmer John waits too long to milk them. More specifically, cow $i$ produces $g_i$ gallons of milk ($1 \\le g_i \\le 1000$), but only if she is milked before a deadline at time $d_i$ ($1 \\le d_i \\le 10,000$). Time starts at $t=0$, so at most $x$ total cows can be milked prior to a deadline at time $t=x$.\n\nPlease help Farmer John determine the maximum amount of milk that he can obtain if he milks the cows optimally.", "inputFormat": "* Line $1$: The value of $N$.\n\n* Lines $2\\dots 1+N$: Line $i+1$ contains the integers $g_i$ and $d_i$.", "outputFormat": "* Line $1$: The maximum number of gallons of milk Farmer John can obtain.", "hint": "There are $4$ cows. The first produces $10$ gallons of milk if milked by time $3$, and so on.\n\nFarmer John milks cow $3$ first, giving up on cow $4$ since she cannot be milked by her deadline due to the conflict with cow $3$. Farmer John then milks cows $1$ and $2$.", "locale": "en"}, "zh-CN": {"title": "[USACO13DEC] Milk Scheduling S", "background": null, "description": "FJ 有 $N$（$1 \\le N \\le 10,000$）头牛要挤牛奶，为每头牛挤牛奶需要花费 $1$ 单位时间。\n\n奶牛很厌烦等待，奶牛 $i$ 在它的截止时间 $d_i$（$1 \\le d_i \\le 10,000$）前能挤出 $g_i$（$1 \\le g_i \\le 1000$）加仑的牛奶，否则将不能挤出牛奶。时间 $t$ 开始时为 $0$，即在时间 $t=x$ 之前，最多可以给 $x$ 头奶牛挤牛奶。\n\n\n请计算 FJ 的最大挤奶量。", "inputFormat": "第一行一个整数 $N$。\n\n第 $2$ 至第 $(N+1)$ 行，第 $(i+1)$ 行两个整数 $g_i$ 和 $d_i$。", "outputFormat": "一行一个整数，表示 FJ 最多能得到多少加仑的牛奶。", "hint": "有 $4$ 头奶牛。第一头奶牛如果在时刻 $3$ 之前（不包含时刻 $3$）被挤可以产出 $10$ 加仑牛奶，其它奶牛以此类推。\n\nFJ 在 $0$ 时刻开始给奶牛 $3$ 挤牛奶（放弃在奶牛 $4$ 的时间限制之前给它挤牛奶，因为和奶牛 $3$ 冲突），消耗 $1$ 单位时间并得到 $8$ 加仑的牛奶；在时刻 $1$ 给奶牛 $1$ 挤牛奶，在时刻 $2$ 给奶牛 $2$ 挤牛奶。\n\n一共获得 $8+10+7=25$ 加仑的牛奶。", "locale": "zh-CN"}}}
{"pid": "P3094", "type": "P", "difficulty": 3, "samples": [["3 3 1 3 \n3 1 10 \n1 3 10 \n1 2 7 \n3 2 \n2 3 \n1 2 \n", "2 \n24 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "USACO"], "title": "[USACO13DEC] Vacation Planning S", "background": "", "description": "有N(1 <= N <= 200)个农场，用1..N编号。航空公司计划在农场间建立航线。对于任意一条航线，选择农场1..K中的农场作为枢纽(1 <= K <= 100, K <= N)。\n\n\n当前共有M (1 <= M <= 10,000)条单向航线连接这些农场，从农场u\\_i 到农场 v\\_i, 将花费 d\\_i美元。(1 <= d\\_i <= 1,000,000).\n\n\n航空公司最近收到Q (1 <= Q <= 10,000)个单向航行请求。第i个航行请求是从农场a\\_i到农场 b\\_i，航行必须经过至少一个枢纽农场（可以是起点或者终点农场），因此可能会多次经过某些农场。\n\n\n请计算可行航行请求的数量，及完成所有可行请求的总费用。\n", "inputFormat": "\\* Line 1: Four integers: N, M, K, and Q.\n\n\\* Lines 2..1+M: Line i+1 contains u\\_i, v\\_i, and d\\_i for flight i.\n\n\\* Lines 2+M..1+M+Q: Line 1+M+i describes the ith trip in terms of a\\_i and b\\_i\n", "outputFormat": "\\* Line 1: The number of trips (out of Q) for which a valid route is possible.\n\n\\* Line 2: The sum, over all trips for which a valid route is possible, of the minimum possible route cost.\n", "hint": "There are three farms (numbered 1..3); farm 1 is a hub.  There is a $10 flight from farm 3 to farm 1, and so on.  We wish to look for trips from farm 3 to farm 2, from 2->3, and from 1->2.\n\n\nThe trip from 3->2 has only one possible route, of cost 10+7.  The trip from 2->3 has no valid route, since there is no flight leaving farm 2.  The trip from 1->2 has only one valid route again, of cost 7.\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO13DEC] Vacation Planning S", "background": "", "description": "There are $N$ farms numbered $1..N$ with $1 \\le N \\le 200$. The airline plans to set up flight routes between the farms. Among these farms, those numbered $1..K$ are designated as hub farms, where $1 \\le K \\le 100$ and $K \\le N$.\n\nThere are currently $M$ directed flights ($1 \\le M \\le 10{,}000$). Each flight goes from farm $u_i$ to farm $v_i$ and costs $d_i$ dollars, with $1 \\le d_i \\le 1{,}000{,}000$.\n\nThe airline has received $Q$ ($1 \\le Q \\le 10{,}000$) directed trip requests. The $i$th request is to travel from farm $a_i$ to farm $b_i$. A valid trip must pass through at least one hub farm (it may be the starting or ending farm). The route may visit the same farm multiple times.\n\nCompute the number of trip requests for which a valid route exists, and the total cost to complete all valid requests, where each valid request is taken with its minimum possible route cost.", "inputFormat": "* Line 1: Four integers: $N$, $M$, $K$, and $Q$.\n* Lines $2..1+M$: Line $i+1$ contains $u_i$, $v_i$, and $d_i$ for flight $i$.\n* Lines $2+M..1+M+Q$: Line $1+M+i$ describes the $i$th trip in terms of $a_i$ and $b_i$.", "outputFormat": "* Line 1: The number of trips (out of $Q$) for which a valid route is possible.\n* Line 2: The sum, over all trips for which a valid route is possible, of the minimum possible route cost.", "hint": "There are three farms (numbered $1..3$); farm $1$ is a hub. There is a 10-dollar flight from farm $3$ to farm $1$, and so on. We wish to look for trips from $3 \\to 2$, from $2 \\to 3$, and from $1 \\to 2$.\n\nThe trip from $3 \\to 2$ has only one possible route, with cost $10+7$. The trip from $2 \\to 3$ has no valid route, since there is no flight leaving farm $2$. The trip from $1 \\to 2$ has only one valid route again, with cost $7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO13DEC] Vacation Planning S", "background": "", "description": "有N(1 <= N <= 200)个农场，用1..N编号。航空公司计划在农场间建立航线。对于任意一条航线，选择农场1..K中的农场作为枢纽(1 <= K <= 100, K <= N)。\n\n\n当前共有M (1 <= M <= 10,000)条单向航线连接这些农场，从农场u\\_i 到农场 v\\_i, 将花费 d\\_i美元。(1 <= d\\_i <= 1,000,000).\n\n\n航空公司最近收到Q (1 <= Q <= 10,000)个单向航行请求。第i个航行请求是从农场a\\_i到农场 b\\_i，航行必须经过至少一个枢纽农场（可以是起点或者终点农场），因此可能会多次经过某些农场。\n\n\n请计算可行航行请求的数量，及完成所有可行请求的总费用。\n", "inputFormat": "\\* Line 1: Four integers: N, M, K, and Q.\n\n\\* Lines 2..1+M: Line i+1 contains u\\_i, v\\_i, and d\\_i for flight i.\n\n\\* Lines 2+M..1+M+Q: Line 1+M+i describes the ith trip in terms of a\\_i and b\\_i\n", "outputFormat": "\\* Line 1: The number of trips (out of Q) for which a valid route is possible.\n\n\\* Line 2: The sum, over all trips for which a valid route is possible, of the minimum possible route cost.\n", "hint": "There are three farms (numbered 1..3); farm 1 is a hub.  There is a $10 flight from farm 3 to farm 1, and so on.  We wish to look for trips from farm 3 to farm 2, from 2->3, and from 1->2.\n\n\nThe trip from 3->2 has only one possible route, of cost 10+7.  The trip from 2->3 has no valid route, since there is no flight leaving farm 2.  The trip from 1->2 has only one valid route again, of cost 7.\n", "locale": "zh-CN"}}}
{"pid": "P3095", "type": "P", "difficulty": 5, "samples": [["5 3 5 \n3 \n1 \n2 \n1 \n2 \n3 \n4 \n5 \n", "4 \n5 \n3 \n1 \n2 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "USACO"], "title": "[USACO13DEC] The Bessie Shuffle S", "background": null, "description": "贝西正在练习她的洗牌方法。她已经掌握了一种针对 $m$ 张牌（$2 \\le m \\le 10^5$）的贝西洗牌法——这种洗牌会让原本从上往下第 $i$ 张牌变成从上往下第 $p_i$ 张牌。\n\n现在贝西要在更大的牌堆上练习洗牌。她有一副标号为 $1 \\sim n$ 的 $n$ 张牌（$m \\le n \\le 10^5$）。她的洗牌方式是：每次取出最上面的 $m$ 张牌进行贝西洗牌，然后将洗好的牌放回牌堆顶部。接着她移除最上面的一张牌并面朝下放置。她重复这个过程，将顶部的牌依次叠放，直到牌堆用完。当剩余牌数不足 $m$ 张时，她不再进行贝西洗牌，但仍会将最上面的牌叠放到其他牌上。\n\n已知牌堆初始是按升序排列的（$1$ 在最上面，$n$在最下面）。给定贝西洗牌法的描述，请帮助贝西计算最终牌堆中 $Q$ 个指定位置（$1 \\le Q \\le N$ 且 $Q \\le 5000$）上的牌面数字。", "inputFormat": "第 $1$ 行三个空格分隔的整数 $n,m,Q$。\n\n接下来 $m$ 行分别表示贝西洗牌中第 $i$ 张牌的新位置 $p_i$（从上往下数，$1 \\le p_i \\le m$）。\n\n最后 $Q$ 行，每行包含一个整数 $q_i$，表示查询第 $q_i$ 张牌上最后得到的数字（从上往下数，$1 \\le q_i \\le N$）。", "outputFormat": "输出一共 $Q$ 行，对于每组数据，输出第 $q_i$ 张牌上最后得到的数字。", "hint": "贝西有一副初始顺序为 $[1,2,3,4,5]$ 的 $5$ 张牌。她的洗牌针对 $3$ 张牌，效果是将顶牌移到底部。共有 $5$ 个查询分别询问牌堆的每个位置。\n\n\n洗牌过程如下：\n\n$[1,2,3,4,5] \\to [2,3,1,4,5]$（将 $2$ 面朝下放置）  \n$[3,1,4,5] \\to [1,4,3,5]$（将 $1$ 面朝下放置）  \n$[4,3,5] \\to [3,5,4]$（将 $3$ 面朝下放置）  \n$[5,4]$（将 $5$ 面朝下放置）  \n$[4]$（将 $4$ 面朝下放置）\n\n最终牌堆顺序为 $[4,5,3,1,2]$。\n\nTranslate by @[Moya_Rao](https://www.luogu.com.cn/user/814130)", "locale": "zh-CN", "translations": {"en": {"title": null, "background": null, "description": "Bessie is practicing her card tricks.  She has already mastered the Bessie-shuffle -- a shuffle on $M$ ($2 \\le M \\le 100,000$) cards that reorganizes the cards so the i-th card from the top is now the $p_i$-th card from the top.\n\nNow Bessie is practicing shuffles on larger decks.  She has a deck of $N$ cards ($M \\le N \\le 100,000$) conveniently labeled $1$ to $N$.  She shuffles this deck by taking the first $M$ cards and performing the Bessie-shuffle on them, placing the shuffled cards back on top of the deck.She then removes the top card from the deck and places it face down.  She repeats this process, placing the top cards successively on top of each other, until she is out of cards.  When Bessie has less than $M$ cards left, she no longer performs the Bessie-shuffle, but continues to place the top card on top of the others.\n\nBessie knows that the deck initially started in sorted order, with $1$ on top, $2$ next, and $N$ on the bottom.  Given the description of the Bessie-shuffle, help Bessie compute which cards end up located at $Q$ different specified positions ($1 \\le Q \\le N, Q \\le 5,000$) in the deck.", "inputFormat": "Line $1$: A single line containing $N$, $M$ and $Q$ separated by a space.\n\nLines $2 \\dots 1+M$: Line $i+1$ indicates the position from the top, $p_i$, of the $i$-th card in the Bessie-shuffle ($1 \\le p_i \\le M$).\n\nLines $2+M \\dots 1+M+Q$: Line $i+1+M$ contains a single integer $q_i$.\n\ndescribing the $i$-th query.  \nYou are to compute the label on the card located in position $q_i$ from the top ($1 \\le q_i \\le N$).", "outputFormat": "Lines $1 \\dots Q$: On the $i$-th line, print a single integer indicating the card at position $q_i$ from the top.", "hint": "Bessie has a deck of $5$ cards initially ordered as $[1, 2, 3, 4, 5]$.  Her shuffle is on $3$ cards and has the effect of moving the top card to the bottom.  \nThere are $5$ queries querying each position in the deck.\n\n\nThe shuffle proceeds as:\n\n```cpp\n[1, 2, 3, 4, 5] -> [2, 3, 1, 4, 5] (put 2 face down) \n[3, 1, 4, 5] -> [1, 4, 3, 5] (put 1 face down) \n[4, 3, 5] -> [3, 5, 4] (put 3 face down) \n[5, 4] (put 5 face down) \n[4] (put 4 face down) \n```\nThis produces the final order of $[4, 5, 3, 1, 2]$.", "locale": "en"}, "zh-CN": {"title": "[USACO13DEC] The Bessie Shuffle S", "background": null, "description": "贝西正在练习她的洗牌方法。她已经掌握了一种针对 $m$ 张牌（$2 \\le m \\le 10^5$）的贝西洗牌法——这种洗牌会让原本从上往下第 $i$ 张牌变成从上往下第 $p_i$ 张牌。\n\n现在贝西要在更大的牌堆上练习洗牌。她有一副标号为 $1 \\sim n$ 的 $n$ 张牌（$m \\le n \\le 10^5$）。她的洗牌方式是：每次取出最上面的 $m$ 张牌进行贝西洗牌，然后将洗好的牌放回牌堆顶部。接着她移除最上面的一张牌并面朝下放置。她重复这个过程，将顶部的牌依次叠放，直到牌堆用完。当剩余牌数不足 $m$ 张时，她不再进行贝西洗牌，但仍会将最上面的牌叠放到其他牌上。\n\n已知牌堆初始是按升序排列的（$1$ 在最上面，$n$在最下面）。给定贝西洗牌法的描述，请帮助贝西计算最终牌堆中 $Q$ 个指定位置（$1 \\le Q \\le N$ 且 $Q \\le 5000$）上的牌面数字。", "inputFormat": "第 $1$ 行三个空格分隔的整数 $n,m,Q$。\n\n接下来 $m$ 行分别表示贝西洗牌中第 $i$ 张牌的新位置 $p_i$（从上往下数，$1 \\le p_i \\le m$）。\n\n最后 $Q$ 行，每行包含一个整数 $q_i$，表示查询第 $q_i$ 张牌上最后得到的数字（从上往下数，$1 \\le q_i \\le N$）。", "outputFormat": "输出一共 $Q$ 行，对于每组数据，输出第 $q_i$ 张牌上最后得到的数字。", "hint": "贝西有一副初始顺序为 $[1,2,3,4,5]$ 的 $5$ 张牌。她的洗牌针对 $3$ 张牌，效果是将顶牌移到底部。共有 $5$ 个查询分别询问牌堆的每个位置。\n\n\n洗牌过程如下：\n\n$[1,2,3,4,5] \\to [2,3,1,4,5]$（将 $2$ 面朝下放置）  \n$[3,1,4,5] \\to [1,4,3,5]$（将 $1$ 面朝下放置）  \n$[4,3,5] \\to [3,5,4]$（将 $3$ 面朝下放置）  \n$[5,4]$（将 $5$ 面朝下放置）  \n$[4]$（将 $4$ 面朝下放置）\n\n最终牌堆顺序为 $[4,5,3,1,2]$。\n\nTranslate by @[Moya_Rao](https://www.luogu.com.cn/user/814130)", "locale": "zh-CN"}}}
{"pid": "P3096", "type": "P", "difficulty": 5, "samples": [["3 3 1 2 \n1 2 10 \n2 3 10 \n2 1 5 \n2 \n1 3 \n3 1 \n", "1 \n20 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2013", "USACO"], "title": "[USACO13DEC] Vacation Planning G", "background": "", "description": "Air Bovinia operates flights connecting the N farms that the cows live on (1 <= N <= 20,000). As with any airline, K of these farms have been designated as hubs (1 <= K <= 200, K <= N).\n\nCurrently, Air Bovinia offers M one-way flights (1 <= M <= 20,000), where flight i travels from farm u\\_i to farm v\\_i and costs d\\_i (1 <= d\\_i <= 10,000) dollars.  As with any other sensible airline, for each of these flights, at least one of u\\_i and v\\_i is a hub.  There is at most one direct flight between two farms in any given direction, and no flight starts and ends at the same farm.\n\nBessie is in charge of running the ticketing services for Air Bovinia. Unfortunately, while she was away chewing on delicious hay for a few hours, Q one-way travel requests for the cows' holiday vacations were received (1 <= Q <= 50,000), where the ith request is from farm a\\_i to farm b\\_i.\n\nAs Bessie is overwhelmed with the task of processing these tickets, please help her compute whether each ticket request can be fullfilled, and its minimum cost if it can be done.\n\nTo reduce the output size, you should only output the total number of ticket requests that are possible, and the minimum total cost for them. Note that this number might not fit into a 32-bit integer.\n\n是n个点m条有向边，求两两之间的最短路，要求路径上必须经过编号1~k的至少一个点\n", "inputFormat": "\\* Line 1: The integers N, M, K, and Q.\n\n\\* Lines 2..M + 1: Line i+1 contains u\\_i, v\\_i, and d\\_i. (1 <= u\\_i, v\\_i <= N, u\\_i != v\\_i)\n\n\\* Lines M + 2..M + K + 1: Each of these lines contains the ID of a single hub (in the range 1..N).\n\n\\* Lines M + K + 2..M + K + Q + 1: Two numbers per line, indicating a request for a ticket from farm a\\_i to b\\_i. (1 <= a\\_i, b\\_i <= N, a\\_i != b\\_i)\n", "outputFormat": "\\* Line 1: The number of ticket requests that can be fullfilled.\n\n\\* Line 2: The minimum total cost of fulling the possible ticket requests\n", "hint": "For the first flight, the only feasible route is 1->2->3, costing 20. There are no flights leaving farm 3, so the poor cows are stranded there.\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO13DEC] Vacation Planning G", "background": "", "description": "Air Bovinia operates flights connecting the $N$ farms that the cows live on ($1 \\le N \\le 20{,}000$). As with any airline, $K$ of these farms have been designated as hubs ($1 \\le K \\le 200$, $K \\le N$).\n\nCurrently, Air Bovinia offers $M$ one-way flights ($1 \\le M \\le 20{,}000$), where flight $i$ travels from farm $u_i$ to farm $v_i$ and costs $d_i$ dollars ($1 \\le d_i \\le 10{,}000$). As with any other sensible airline, for each of these flights, at least one of $u_i$ and $v_i$ is a hub. There is at most one direct flight between two farms in any given direction, and no flight starts and ends at the same farm.\n\nBessie is in charge of running the ticketing services for Air Bovinia. Unfortunately, while she was away chewing on delicious hay for a few hours, $Q$ one-way travel requests for the cows' holiday vacations were received ($1 \\le Q \\le 50{,}000$), where the $i$th request is from farm $a_i$ to farm $b_i$.\n\nAs Bessie is overwhelmed with the task of processing these tickets, please help her compute whether each ticket request can be fulfilled, and its minimum cost if it can be done.\n\nTo reduce the output size, you should only output the total number of ticket requests that are possible, and the minimum total cost for them. Note that this number might not fit into a $32$-bit integer.\n\nIn other words, given a directed graph with $N$ nodes and $M$ edges, for each query find the shortest path whose route must pass through at least one node with an index in $1..K$.", "inputFormat": "- Line $1$: The integers $N$, $M$, $K$, and $Q$.\n- Lines $2..M+1$: Line $i+1$ contains $u_i$, $v_i$, and $d_i$. ($1 \\le u_i, v_i \\le N$, $u_i \\ne v_i$.)\n- Lines $M+2..M+K+1$: Each of these lines contains the ID of a single hub (in the range $1..N$).\n- Lines $M+K+2..M+K+Q+1$: Two numbers per line, indicating a request for a ticket from farm $a_i$ to $b_i$. ($1 \\le a_i, b_i \\le N$, $a_i \\ne b_i$.)", "outputFormat": "- Line $1$: The number of ticket requests that can be fulfilled.\n- Line $2$: The minimum total cost of fulfilling the possible ticket requests.", "hint": "For the first flight, the only feasible route is $1 \\to 2 \\to 3$, costing $20$. There are no flights leaving farm $3$, so the poor cows are stranded there.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO13DEC] Vacation Planning G", "background": "", "description": "Air Bovinia operates flights connecting the N farms that the cows live on (1 <= N <= 20,000). As with any airline, K of these farms have been designated as hubs (1 <= K <= 200, K <= N).\n\nCurrently, Air Bovinia offers M one-way flights (1 <= M <= 20,000), where flight i travels from farm u\\_i to farm v\\_i and costs d\\_i (1 <= d\\_i <= 10,000) dollars.  As with any other sensible airline, for each of these flights, at least one of u\\_i and v\\_i is a hub.  There is at most one direct flight between two farms in any given direction, and no flight starts and ends at the same farm.\n\nBessie is in charge of running the ticketing services for Air Bovinia. Unfortunately, while she was away chewing on delicious hay for a few hours, Q one-way travel requests for the cows' holiday vacations were received (1 <= Q <= 50,000), where the ith request is from farm a\\_i to farm b\\_i.\n\nAs Bessie is overwhelmed with the task of processing these tickets, please help her compute whether each ticket request can be fullfilled, and its minimum cost if it can be done.\n\nTo reduce the output size, you should only output the total number of ticket requests that are possible, and the minimum total cost for them. Note that this number might not fit into a 32-bit integer.\n\n是n个点m条有向边，求两两之间的最短路，要求路径上必须经过编号1~k的至少一个点\n", "inputFormat": "\\* Line 1: The integers N, M, K, and Q.\n\n\\* Lines 2..M + 1: Line i+1 contains u\\_i, v\\_i, and d\\_i. (1 <= u\\_i, v\\_i <= N, u\\_i != v\\_i)\n\n\\* Lines M + 2..M + K + 1: Each of these lines contains the ID of a single hub (in the range 1..N).\n\n\\* Lines M + K + 2..M + K + Q + 1: Two numbers per line, indicating a request for a ticket from farm a\\_i to b\\_i. (1 <= a\\_i, b\\_i <= N, a\\_i != b\\_i)\n", "outputFormat": "\\* Line 1: The number of ticket requests that can be fullfilled.\n\n\\* Line 2: The minimum total cost of fulling the possible ticket requests\n", "hint": "For the first flight, the only feasible route is 1->2->3, costing 20. There are no flights leaving farm 3, so the poor cows are stranded there.\n", "locale": "zh-CN"}}}
{"pid": "P3097", "type": "P", "difficulty": 5, "samples": [["5 3 \n1 \n2 \n3 \n4 \n5 \n5 2 \n2 7 \n1 10 \n", "32 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "线段树", "USACO"], "title": "[USACO13DEC] Optimal Milking G", "background": "", "description": "Farmer John has recently purchased a new barn containing N milking machines (1 <= N <= 40,000), conveniently numbered 1..N and arranged in a row.\n\nMilking machine i is capable of extracting M(i) units of milk per day (1 <= M(i) <= 100,000).  Unfortunately, the machines were installed so close together that if a machine i is in use on a particular day, its two neighboring machines cannot be used that day (endpoint machines have only one neighbor, of course).  Farmer John is free to select different subsets of machines to operate on different days.\n\nFarmer John is interested in computing the maximum amount of milk he can extract over a series of D days (1 <= D <= 50,000).  At the beginning of each day, he has enough time to perform maintenance on one selected milking machine i, thereby changing its daily milk output M(i) from that day forward. Given a list of these daily modifications, please tell Farmer John how much milk he can produce over D days (note that this number might not fit into a 32-bit integer).", "inputFormat": "\\* Line 1: The values of N and D.\n\n\\* Lines 2..1+N: Line i+1 contains the initial value of M(i).\n\n\\* Lines 2+N..1+N+D: Line 1+N+d contains two integers i and m,\n\nindicating that Farmer John updates the value of M(i) to m at the beginning of day d.", "outputFormat": "\\* Line 1: The maximum total amount of milk FJ can produce over D days.", "hint": "There are 5 machines, with initial milk outputs 1,2,3,4,5.  On day 1, machine 5 is updated to output 2 unit of milk, and so on.\n\n\nOn day one, the optimal amount of milk is 2+4 = 6 (also achievable as 1+3+2).  On day two, the optimal amount is 7+4 = 11.  On day three, the optimal amount is 10+3+2=15.", "locale": "en", "translations": {"en": {"title": "[USACO13DEC] Optimal Milking G", "background": "", "description": "Farmer John has recently purchased a new barn containing N milking machines (1 <= N <= 40,000), conveniently numbered 1..N and arranged in a row.\n\nMilking machine i is capable of extracting M(i) units of milk per day (1 <= M(i) <= 100,000).  Unfortunately, the machines were installed so close together that if a machine i is in use on a particular day, its two neighboring machines cannot be used that day (endpoint machines have only one neighbor, of course).  Farmer John is free to select different subsets of machines to operate on different days.\n\nFarmer John is interested in computing the maximum amount of milk he can extract over a series of D days (1 <= D <= 50,000).  At the beginning of each day, he has enough time to perform maintenance on one selected milking machine i, thereby changing its daily milk output M(i) from that day forward. Given a list of these daily modifications, please tell Farmer John how much milk he can produce over D days (note that this number might not fit into a 32-bit integer).", "inputFormat": "\\* Line 1: The values of N and D.\n\n\\* Lines 2..1+N: Line i+1 contains the initial value of M(i).\n\n\\* Lines 2+N..1+N+D: Line 1+N+d contains two integers i and m,\n\nindicating that Farmer John updates the value of M(i) to m at the beginning of day d.", "outputFormat": "\\* Line 1: The maximum total amount of milk FJ can produce over D days.", "hint": "There are 5 machines, with initial milk outputs 1,2,3,4,5.  On day 1, machine 5 is updated to output 2 unit of milk, and so on.\n\n\nOn day one, the optimal amount of milk is 2+4 = 6 (also achievable as 1+3+2).  On day two, the optimal amount is 7+4 = 11.  On day three, the optimal amount is 10+3+2=15.", "locale": "en"}, "zh-CN": {"title": "[USACO13DEC] Optimal Milking G", "background": null, "description": "### 题目描述\n\nFarmer John 最近购买了一个新谷仓，内有 $N(1\\le N \\le 40000)$ 台挤奶机，从左到右编号为 $1 \\sim N$。\n\n第 $i$ 台挤奶机当天可以产出 $M_i$ 单位的牛奶。不幸的是，这些机器安装得过于紧密，导致如果某一天使用了机器 $i$，与其相邻的两台机器当天就无法使用。Farmer John 可以自由安排使用哪些机器。\n\nFarmer John 想知道在 $D(1\\le D \\le 50000)$ 天内能产出的最大牛奶量。在每一天开始时，Farmer John 会对一台挤奶机进行维护，即改变一台机器的 $M_i$ 值。给定维护列表，求这 $D$ 天内最多能生产多少单位的牛奶。注意，$32$ 位整型可能不适合用于储存答案。", "inputFormat": "第一行两个正整数 $N,D$。\n\n第 $2 \\sim N + 1$ 行，每行一个正整数 $M_i$。\n\n对于接下来的第 $d$ 行，每行两个正整数 $i, m$，表示在第 $d$ 天开始时有一次操作 $M_i \\gets m$。", "outputFormat": "一行一个正整数，表示答案。", "hint": "初始状态下有 $5$ 台挤奶机，$M_i$ 分别为 $1, 2, 3, 4, 5$。第 $1$ 天开始时，$M_5$ 被更新为 $2$，以此类推。\n\n- 第 $1$ 天，$M_i$ 分别为 $1, 2, 3, 4, 2$，可以选择机器 $2, 4$ 以获得当天 $2 + 4 = 6$ 单位的牛奶，或选择机器 $1, 3, 5$ 得到相同的答案（$1 + 3 + 2 = 6$）。\n- 第 $2$ 天，$M_i$ 分别为 $1, 7, 3, 4, 2$，选择机器 $2, 4$ 以获得当天 $7 + 4 = 11$ 单位的牛奶。\n- 第 $3$ 天，$M_i$ 分别为 $10, 7, 3, 4, 2$，选择机器 $1, 3, 5$ 以获得当天 $10 + 3 + 2 = 15$ 单位的牛奶。\n\n总产奶量为 $6 + 11 + 15 = 32$ 单位。", "locale": "zh-CN"}}}
{"pid": "P3098", "type": "P", "difficulty": 6, "samples": [["5 3 5 \n3 \n1 \n2 \n1 \n2 \n3 \n4 \n5 \n", "4 \n5 \n3 \n1 \n2 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "倍增", "USACO", "并查集", "广度优先搜索 BFS", "图论建模"], "title": "[USACO13DEC] The Bessie Shuffle G", "background": null, "description": "贝西有一种独门的洗牌方法，称为 A 类洗牌法；\n\nA 类洗牌法的具体过程：将一堆共 $M$（$2 \\le M \\le 10 ^ 5$）张从上到下编号 $1, 2, \\cdots, M$ 的纸牌，从上到下第 $i$ 张牌洗到位置 $p _ i$。\n\n例如，$M=3，p = \\{3, 1, 2\\}$，则执行一次 A 类洗牌法后，从上到下将变为 $2, 3, 1$，即牌 $1$ 放到位置 $3$，牌 $2$ 放到位置 $1$，牌 $3$ 放到位置 $2$。\n\n\n贝西现在要练习另外一种洗牌方法，称为 B 类洗牌法。\n\n\nB 类洗牌法的具体过程： \n\n有一堆 $N$（$M \\le N \\le 10 ^ 9$）张编号为 $1, 2, \\cdots, N$ 的牌，并按从上到下 $1$ 到 $N$ 的顺序堆放。另有一个牌堆用来辅助洗牌，称为临时堆，开始时为空。\n\n1. 将最上面 $M$ 张牌进行一次 A 类洗牌法；\n2. 将最上面的一张牌放到临时堆的最上方；\n3. 重复前两个操作，直到原先的堆没有牌为止。\n\n\n以上过程中，当原先堆的牌不足 $M$ 张的时候，将不进行 A 类洗牌法，而是将最上面的牌依次放到临时堆上。\n\n\n给定 $N, M$ 和排列 $p$。现在有 $Q$（$1 \\le Q \\le \\min(N, 5000)$）个询问，请求出对其做一次 B 类洗牌法后临时堆中 $q_i$ 位置上的牌的编号。\n\n$50\\%$ 的数据中，$N \\le 10 ^ 5$。", "inputFormat": "* 第 $1$ 行：一行包含 $N$、$M$ 和 $Q$，用空格分隔。\n\n* 第 $2$ 行至第 $M+1$ 行：第 $i+1$ 行表示在贝西洗牌中，第 $i$ 张牌距顶部的位置 $P_i(1\\le P_i\\le M)$。\n\n* 第 $M+2$ 行至第 $M+Q+1$ 行：第 $M+i+1$ 行包含一个整数 $q_i$\n\n对于第 $i$ 个查询。你需要计算从顶部起第 $q_i$ 个位置 $(1\\le q_i\\le N)$ 的卡片上的编号。", "outputFormat": "* 第 $1$ 行至第 $Q$ 行：在第 $i$ 行，打印一个整数，表示从顶部开始第 $q_i$ 张牌的编号。", "hint": "贝西的五张牌刚开始顺序为 [1, 2, 3, 4, 5]。她一次洗三张牌，效果是将第一张牌放到底部。以上五个问题询问了每一张牌的位置。\n\n\n洗牌的顺序是:\n\n```plain\n[1, 2, 3, 4, 5] -> [2, 3, 1, 4, 5] (将2正面向下放置)\n[3, 1, 4, 5] -> [1, 4, 3, 5] (将1正面向下放置) \n[4, 3, 5] -> [3, 5, 4] (将3正面向下放置) \n[5, 4] (将5正面向下放置) \n[4] (将4正面向下放置) \n```\n这就形成了最终的顺序：[4, 5, 3, 1, 2]", "locale": "zh-CN", "translations": {"en": {"title": "[USACO13DEC] The Bessie Shuffle G", "background": "", "description": "Bessie has a unique shuffling method, called the A-shuffle (also called the Bessie-shuffle).\n\nA-shuffle: Take a stack of $M$（$2 \\le M \\le 10 ^ 5$） cards labeled from top to bottom $1, 2, \\cdots, M$. Move the $i$-th card from the top to position $p _ i$ from the top.\n\nFor example, $M=3，p = \\{3, 1, 2\\}$, after performing one A-shuffle, from top to bottom it becomes $2, 3, 1$, i.e., card $1$ goes to position $3$, card $2$ goes to position $1$, card $3$ goes to position $2$.\n\nNow Bessie practices another method, called the B-shuffle.\n\nB-shuffle process:\n\nThere is a stack of $N$（$M \\le N \\le 10 ^ 9$） cards labeled $1, 2, \\cdots, N$, initially stacked in order from top to bottom $1$ to $N$. There is also an auxiliary stack used during shuffling, called the temporary pile, which starts empty.\n\n1. Apply one A-shuffle to the top $M$ cards.\n2. Move the top card to the top of the temporary pile, face down.\n3. Repeat the previous two operations until the original pile is empty.\n\nDuring this process, when the original pile has fewer than $M$ cards remaining, do not perform the A-shuffle; instead, keep moving the top card to the temporary pile one by one.\n\nGiven $N$, $M$ and the permutation $p$, there are $Q$（$1 \\le Q \\le \\min(N, 5000)$） queries. After performing one B-shuffle, for each query, find the label of the card at position $q _ i$ in the temporary pile.\n\nConstraints:\n- $2 \\le M \\le 10 ^ 5$.\n- $M \\le N \\le 10 ^ 9$.\n- $1 \\le Q \\le \\min(N, 5000)$.\n- $1 \\le P[i] \\le M$.\n- $1 \\le q _ i \\le N$.\n- $50\\%$ of test cases have $N \\le 10 ^ 5$.", "inputFormat": "* Line 1: A single line containing $N$, $M$ and $Q$ separated by a space.\n* Lines 2..1+M: Line $i+1$ indicates the position from the top, $P[i]$, of the $i$-th card in the Bessie-shuffle ($1 \\le P[i] \\le M$).\n* Lines 2+M..1+M+Q: Line $i+1+M$ contains a single integer $q_i$ describing the $i$-th query. You are to compute the label on the card located in position $q_i$ from the top ($1 \\le q_i \\le N$).", "outputFormat": "* Lines 1..Q: On line $i$, print a single integer indicating the card at position $q_i$ from the top.", "hint": "Bessie has a deck of 5 cards initially ordered as [1, 2, 3, 4, 5]. Her shuffle is on 3 cards and has the effect of moving the top card to the bottom. There are 5 queries, one for each position in the deck.\n\nThe shuffle proceeds as:\n\n```plain\n[1, 2, 3, 4, 5] -> [2, 3, 1, 4, 5] (put 2 face down) \n[3, 1, 4, 5] -> [1, 4, 3, 5] (put 1 face down) \n[4, 3, 5] -> [3, 5, 4] (put 3 face down) \n[5, 4] (put 5 face down) \n[4] (put 4 face down) \n```\nThis produces the final order of [4, 5, 3, 1, 2].\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO13DEC] The Bessie Shuffle G", "background": null, "description": "贝西有一种独门的洗牌方法，称为 A 类洗牌法；\n\nA 类洗牌法的具体过程：将一堆共 $M$（$2 \\le M \\le 10 ^ 5$）张从上到下编号 $1, 2, \\cdots, M$ 的纸牌，从上到下第 $i$ 张牌洗到位置 $p _ i$。\n\n例如，$M=3，p = \\{3, 1, 2\\}$，则执行一次 A 类洗牌法后，从上到下将变为 $2, 3, 1$，即牌 $1$ 放到位置 $3$，牌 $2$ 放到位置 $1$，牌 $3$ 放到位置 $2$。\n\n\n贝西现在要练习另外一种洗牌方法，称为 B 类洗牌法。\n\n\nB 类洗牌法的具体过程： \n\n有一堆 $N$（$M \\le N \\le 10 ^ 9$）张编号为 $1, 2, \\cdots, N$ 的牌，并按从上到下 $1$ 到 $N$ 的顺序堆放。另有一个牌堆用来辅助洗牌，称为临时堆，开始时为空。\n\n1. 将最上面 $M$ 张牌进行一次 A 类洗牌法；\n2. 将最上面的一张牌放到临时堆的最上方；\n3. 重复前两个操作，直到原先的堆没有牌为止。\n\n\n以上过程中，当原先堆的牌不足 $M$ 张的时候，将不进行 A 类洗牌法，而是将最上面的牌依次放到临时堆上。\n\n\n给定 $N, M$ 和排列 $p$。现在有 $Q$（$1 \\le Q \\le \\min(N, 5000)$）个询问，请求出对其做一次 B 类洗牌法后临时堆中 $q_i$ 位置上的牌的编号。\n\n$50\\%$ 的数据中，$N \\le 10 ^ 5$。", "inputFormat": "* 第 $1$ 行：一行包含 $N$、$M$ 和 $Q$，用空格分隔。\n\n* 第 $2$ 行至第 $M+1$ 行：第 $i+1$ 行表示在贝西洗牌中，第 $i$ 张牌距顶部的位置 $P_i(1\\le P_i\\le M)$。\n\n* 第 $M+2$ 行至第 $M+Q+1$ 行：第 $M+i+1$ 行包含一个整数 $q_i$\n\n对于第 $i$ 个查询。你需要计算从顶部起第 $q_i$ 个位置 $(1\\le q_i\\le N)$ 的卡片上的编号。", "outputFormat": "* 第 $1$ 行至第 $Q$ 行：在第 $i$ 行，打印一个整数，表示从顶部开始第 $q_i$ 张牌的编号。", "hint": "贝西的五张牌刚开始顺序为 [1, 2, 3, 4, 5]。她一次洗三张牌，效果是将第一张牌放到底部。以上五个问题询问了每一张牌的位置。\n\n\n洗牌的顺序是:\n\n```plain\n[1, 2, 3, 4, 5] -> [2, 3, 1, 4, 5] (将2正面向下放置)\n[3, 1, 4, 5] -> [1, 4, 3, 5] (将1正面向下放置) \n[4, 3, 5] -> [3, 5, 4] (将3正面向下放置) \n[5, 4] (将5正面向下放置) \n[4] (将4正面向下放置) \n```\n这就形成了最终的顺序：[4, 5, 3, 1, 2]", "locale": "zh-CN"}}}
{"pid": "P3099", "type": "P", "difficulty": 5, "samples": [["4 \n0 0 \n0 2 \n2 0 \n2 2 \n1 1 \n1 10 \n-10 3 \n10 3 \n", "1 2 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2014", "USACO", "排序", "凸包"], "title": "[USACO14JAN] Cow Curling G", "background": "", "description": "Cow curling is a popular cold-weather sport played in the Moolympics.\n\nLike regular curling, the sport involves two teams, each of which slides N heavy stones (3 <= N <= 50,000) across a sheet of ice.  At the end of the game, there are 2N stones on the ice, each located at a distinct 2D point.\n\nScoring in the cow version of curling is a bit curious, however.  A stone is said to be \"captured\" if it is contained inside a triangle whose corners are stones owned by the opponent (a stone on the boundary of such a triangle also counts as being captured).  The score for a team is the number of opponent stones that are captured.\n\nPlease help compute the final score of a cow curling match, given the locations of all 2N stones.\n\n\n", "inputFormat": "\\* Line 1: The integer N.\n\n\\* Lines 2..1+N: Each line contains 2 integers specifying the x and y coordinates of a stone for team A (each coordinate lies in the range -40,000 .. +40,000).\n\n\\* Lines 2+N..1+2N: Each line contains 2 integers specifying the x and y coordinates of a stone for team B (each coordinate lies in the range -40,000 .. +40,000).\n\n\n", "outputFormat": "\\* Line 1: Two space-separated integers, giving the scores for teams A and B.\n\n\n", "hint": "Each team owns 4 stones.  Team A has stones at (0,0), (0,2), (2,0), and (2,2), and team B has stones at (1,1), (1,10), (-10,3), and (10,3).\n\n\nTeam A captures their opponent's stone at (1,1).  Team B captures their opponent's stones at (0,2) and (2,2).\n", "locale": "en", "translations": {"en": {"title": "[USACO14JAN] Cow Curling G", "background": "", "description": "Cow curling is a popular cold-weather sport played in the Moolympics.\n\nLike regular curling, the sport involves two teams, each of which slides N heavy stones (3 <= N <= 50,000) across a sheet of ice.  At the end of the game, there are 2N stones on the ice, each located at a distinct 2D point.\n\nScoring in the cow version of curling is a bit curious, however.  A stone is said to be \"captured\" if it is contained inside a triangle whose corners are stones owned by the opponent (a stone on the boundary of such a triangle also counts as being captured).  The score for a team is the number of opponent stones that are captured.\n\nPlease help compute the final score of a cow curling match, given the locations of all 2N stones.\n\n\n", "inputFormat": "\\* Line 1: The integer N.\n\n\\* Lines 2..1+N: Each line contains 2 integers specifying the x and y coordinates of a stone for team A (each coordinate lies in the range -40,000 .. +40,000).\n\n\\* Lines 2+N..1+2N: Each line contains 2 integers specifying the x and y coordinates of a stone for team B (each coordinate lies in the range -40,000 .. +40,000).\n\n\n", "outputFormat": "\\* Line 1: Two space-separated integers, giving the scores for teams A and B.\n\n\n", "hint": "Each team owns 4 stones.  Team A has stones at (0,0), (0,2), (2,0), and (2,2), and team B has stones at (1,1), (1,10), (-10,3), and (10,3).\n\n\nTeam A captures their opponent's stone at (1,1).  Team B captures their opponent's stones at (0,2) and (2,2).\n", "locale": "en"}, "zh-CN": {"title": "[USACO14JAN] Cow Curling G", "background": null, "description": "奶牛冰壶是一项在 Moolympics 中流行的寒冷天气运动。\n\n与常规冰壶类似，这项运动涉及两支队伍，每队向冰面投掷 $N$ 个重石（$3\\leq N\\leq 50,000$）。比赛结束时，冰面上有 $2N$ 个石头，每个石头位于不同的二维坐标点。\n\n然而，奶牛冰壶的计分方式有些特别。如果一个石头被包含在由对手的三个石头构成的三角形内部（在三角形边界上的石头也算被捕获），则该石头被称为“被捕获”。一个队伍的得分是被捕获的对手石头的数量。\n\n请计算一场奶牛冰壶比赛的最终得分，给定所有 $2N$ 个石头的位置。", "inputFormat": "- 第 $1$ 行：整数 $N$。\n\n- 第 $2$ 到 $1+N$ 行：每行包含 $2$ 个整数，指定队伍 $A$ 的石头的 $x$ 和 $y$ 坐标（每个坐标的范围是 $-40,000$ 到 $+40,000$）。\n\n- 第 $2+N$ 到 $1+2N$ 行：每行包含 $2$ 个整数，指定队伍 B 的石头的 $x$ 和 $y$ 坐标（每个坐标的范围是 $-40,000$ 到 $+40,000$）。", "outputFormat": "- 第 $1$ 行：两个空格分隔的整数，分别给出队伍 A 和队伍 B 的得分。", "hint": "每队拥有 $4$ 个石头。队伍 A 的石头在 $(0,0)$、$(0,2)$、$(2,0)$ 和 $(2,2)$，队伍 B 的石头在 $(1,1)$、$(1,10)$、$(-10,3)$ 和 $(10,3)$。\n\n队伍 A 捕获了对手在 $(1,1)$ 的石头。队伍 B 捕获了对手在 $(0,2)$ 和 $(2,2)$ 的石头。\n\n---\n\n翻译来自 DeepSeek", "locale": "zh-CN"}}}
{"pid": "P3100", "type": "P", "difficulty": 5, "samples": [["3 6 \nRSRSSS \nRSRSSS \nRSRSSS \n", "3 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "USACO", "枚举"], "title": "[USACO14JAN] Building a Ski Course G", "background": "", "description": "Farmer John is helping to turn his large field into a ski course for the upcoming winter Moolympics.  The field has dimensions M x N (1 <= M,N <= 100), and its intended final composition is described by an M x N grid of characters like this:\n\nRSRSSS\nRSRSSS\nRSRSSS\nEach character describes how the snow in a unit square of the field should be groomed: either 'R' for 'rough' or 'S' for 'smooth' (the Moolympics organizers think that a course is more interesting if it has a mixture of rough and smooth patches).\n\nTo build the desired course, Farmer John plans to modify his tractor so that it can stamp any B x B patch of the field (B <= M, B <= N) with either entirely smooth snow or entirely rough snow.  Since it takes a long time to reset the tractor between each of these stamps, FJ wants to make B as large as possible.  With B = 1, he can clearly create the desired ski course by stamping each individual square with either R or S, as intended.  However, for larger values of B, it may no longer be possible to create the desired course design.  Every unit square of the course must at some point be stamped by FJ's tractor; it cannot be left in its default state.\n\nPlease help FJ determine the largest possible value of B he can successfully use.\n\n滑雪场的设计图是一个M\\*NM x N (1 <= M,N <= 100)的矩阵，每个格子里用一个字母R（表示粗糙）或者S（表示平整）。\n\n\n比如：\n\n\nRSRSSS\n\nRSRSSS\n\nRSRSSS\n\n农民约翰的拖拉机每次可以将一块B\\*B (B <= M, B <= N)的区域全部标记B\\*B (B <= M, B <= N)的R或者S，他希望B能够尽量地大。一个格子可以被多次标记，下一次标记能够覆盖前一次标记，每个格子可以都至少被标记一次。\n", "inputFormat": "\\* Line 1: Two space-separated integers M and N.\n\n\\* Lines 2..M+1: M lines of exactly N characters (each R or S), describing the desired ski course design.\n", "outputFormat": "\\* Line 1: The maximum value of B Farmer John can use to create the desired course pattern.\n", "hint": "FJ can stamp a rough patch spanning columns 1-3, followed by a smooth patch spanning columns 2-4, then a rough patch spanning columns 3-5, and finally a smooth patch spanning columns 4-6.\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO14JAN] Building a Ski Course G", "background": "", "description": "Farmer John is helping to turn his large field into a ski course for the upcoming winter Moolympics. The field has dimensions $M \\times N$ with $1 \\le M, N \\le 100$, and its intended final composition is described by an $M \\times N$ grid of characters like this:\n\nRSRSSS\nRSRSSS\nRSRSSS\n\nEach character describes how the snow in a unit square of the field should be groomed: either 'R' for rough or 'S' for smooth (the Moolympics organizers think that a course is more interesting if it has a mixture of rough and smooth patches).\n\nTo build the desired course, Farmer John plans to modify his tractor so that it can stamp any $B \\times B$ patch of the field (with $B \\le M$, $B \\le N$) with either entirely smooth snow or entirely rough snow. Since it takes a long time to reset the tractor between each of these stamps, FJ wants to make $B$ as large as possible. With $B = 1$, he can clearly create the desired ski course by stamping each individual square with either 'R' or 'S', as intended. However, for larger values of $B$, it may no longer be possible to create the desired course design. Every unit square must be stamped at least once; it cannot be left in its default state. Stamps may overlap, and later stamps overwrite earlier ones.\n\nPlease help FJ determine the largest possible value of $B$ he can successfully use.", "inputFormat": "* Line 1: Two space-separated integers $M$ and $N$.\n* Lines 2..$M+1$: $M$ lines of exactly $N$ characters (each 'R' or 'S'), describing the desired ski course design.", "outputFormat": "* Line 1: The maximum value of $B$ Farmer John can use to create the desired course pattern.", "hint": "FJ can stamp a rough patch spanning columns 1-3, followed by a smooth patch spanning columns 2-4, then a rough patch spanning columns 3-5, and finally a smooth patch spanning columns 4-6.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO14JAN] Building a Ski Course G", "background": "", "description": "Farmer John is helping to turn his large field into a ski course for the upcoming winter Moolympics.  The field has dimensions M x N (1 <= M,N <= 100), and its intended final composition is described by an M x N grid of characters like this:\n\nRSRSSS\nRSRSSS\nRSRSSS\nEach character describes how the snow in a unit square of the field should be groomed: either 'R' for 'rough' or 'S' for 'smooth' (the Moolympics organizers think that a course is more interesting if it has a mixture of rough and smooth patches).\n\nTo build the desired course, Farmer John plans to modify his tractor so that it can stamp any B x B patch of the field (B <= M, B <= N) with either entirely smooth snow or entirely rough snow.  Since it takes a long time to reset the tractor between each of these stamps, FJ wants to make B as large as possible.  With B = 1, he can clearly create the desired ski course by stamping each individual square with either R or S, as intended.  However, for larger values of B, it may no longer be possible to create the desired course design.  Every unit square of the course must at some point be stamped by FJ's tractor; it cannot be left in its default state.\n\nPlease help FJ determine the largest possible value of B he can successfully use.\n\n滑雪场的设计图是一个M\\*NM x N (1 <= M,N <= 100)的矩阵，每个格子里用一个字母R（表示粗糙）或者S（表示平整）。\n\n\n比如：\n\n\nRSRSSS\n\nRSRSSS\n\nRSRSSS\n\n农民约翰的拖拉机每次可以将一块B\\*B (B <= M, B <= N)的区域全部标记B\\*B (B <= M, B <= N)的R或者S，他希望B能够尽量地大。一个格子可以被多次标记，下一次标记能够覆盖前一次标记，每个格子可以都至少被标记一次。\n", "inputFormat": "\\* Line 1: Two space-separated integers M and N.\n\n\\* Lines 2..M+1: M lines of exactly N characters (each R or S), describing the desired ski course design.\n", "outputFormat": "\\* Line 1: The maximum value of B Farmer John can use to create the desired course pattern.\n", "hint": "FJ can stamp a rough patch spanning columns 1-3, followed by a smooth patch spanning columns 2-4, then a rough patch spanning columns 3-5, and finally a smooth patch spanning columns 4-6.\n", "locale": "zh-CN"}}}
{"pid": "P3101", "type": "P", "difficulty": 5, "samples": [["3 5 10 \n20 21 18 99 5 \n19 22 20 16 17 \n18 17 40 60 80 \n1 0 0 0 0 \n0 0 0 0 0 \n0 0 0 0 1 \n", "24 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "二分", "USACO", "并查集", "Kruskal 重构树"], "title": "[USACO14JAN] Ski Course Rating G", "background": null, "description": "冬季 Moolympics 运动会的越野滑雪场地被描述为一个 $M\\times N(1\\le M,N\\le 500)$ 的网格，每个海拔的数值在 $0$ 到 $10^9$ 之间。\n\n网格中的一些格子被标记为该场地的起点。Moolympics 的组织者想要为每个格子设定一个难度评级。一个起点 $P$ 的难度评级是最小的整数 $D$，满足当一头奶牛从 $P$ 出发，在只能到达相邻的格子，且此格子与当前格子的海拔之差的绝对值不超过 $D$ 才能前往的情况下，至少能到达 $T(1\\le T\\le M\\times N)$ 个格子。两个格子相邻当且仅当一个格子向北、向南、向东或向西走能直接到达另一个格子。\n\n请帮助组织者们为每个起点计算难度评级。", "inputFormat": "第一行三个整数 $M,N,T$。\n\n接下来 $M$ 行，每行输入 $N$ 个整数，表示海拔。\n\n接下来 $M$ 行，每行输入 $N$ 个整数，每个整数为 $0$ 或 $1$，为 $1$ 则表示此网格是一个起点。", "outputFormat": "输出一行一个整数，表示所有起点的难度评级的和（注意到每一个难度评级都在 32-bit 整数的范围内，但是难度评级的和可能不在此范围中）。", "hint": "滑雪场地被描述为一个 $3\\times 5$ 的海拔网格，左上角和右下角的格子被标记为起点。对于每一个起点，我们要能够到达至少 $10$ 个格子。\n\n左上角起点的难度评级是 $4$，右下角起点的难度评级是 $20$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO14JAN] Ski Course Rating G", "background": null, "description": "The cross-country skiing course at the winter Moolympics is described by an M x N grid of elevations (1 <= M,N <= 500), each elevation being in the range 0 .. 1,000,000,000.\n\nSome of the cells in this grid are designated as starting points for the course. The organizers of the Moolympics want to assign a difficulty rating to each starting point. The difficulty level of a starting point P should be the minimum possible value of D such that a cow can successfully reach at least T total cells of the grid (1 <= T <= MN), if she starts at P and can only move from cell to adjacent cell if the absolute difference in elevation between the cells is at most D. Two cells are adjacent if one is directly north, south, east, or west of the other.\n\nPlease help the organizers compute the difficulty rating for each starting point.", "inputFormat": "\\* Line 1: The integers M, N, and T.\n\n\\* Lines 2..1+M: Each of these M lines contains N integer elevations.\n\n\\* Lines 2+M..1+2M: Each of these M lines contains N values that are either 0 or 1, with 1 indicating a cell that is a starting point.", "outputFormat": "\\* Line 1: The sum of difficulty ratings of all starting points (note that this may not fit into a 32-bit integer, even though individual difficulty ratings will).", "hint": "The ski course is described by a 3 x 5 grid of elevations. The upper-left and lower-right cells are designated as starting points. From each starting point, we must be able to reach at least 10 cells.\n\nThe difficulty rating of the upper-left starting point is 4, and for the lower-right it is 20.", "locale": "en"}, "zh-CN": {"title": "[USACO14JAN] Ski Course Rating G", "background": null, "description": "冬季 Moolympics 运动会的越野滑雪场地被描述为一个 $M\\times N(1\\le M,N\\le 500)$ 的网格，每个海拔的数值在 $0$ 到 $10^9$ 之间。\n\n网格中的一些格子被标记为该场地的起点。Moolympics 的组织者想要为每个格子设定一个难度评级。一个起点 $P$ 的难度评级是最小的整数 $D$，满足当一头奶牛从 $P$ 出发，在只能到达相邻的格子，且此格子与当前格子的海拔之差的绝对值不超过 $D$ 才能前往的情况下，至少能到达 $T(1\\le T\\le M\\times N)$ 个格子。两个格子相邻当且仅当一个格子向北、向南、向东或向西走能直接到达另一个格子。\n\n请帮助组织者们为每个起点计算难度评级。", "inputFormat": "第一行三个整数 $M,N,T$。\n\n接下来 $M$ 行，每行输入 $N$ 个整数，表示海拔。\n\n接下来 $M$ 行，每行输入 $N$ 个整数，每个整数为 $0$ 或 $1$，为 $1$ 则表示此网格是一个起点。", "outputFormat": "输出一行一个整数，表示所有起点的难度评级的和（注意到每一个难度评级都在 32-bit 整数的范围内，但是难度评级的和可能不在此范围中）。", "hint": "滑雪场地被描述为一个 $3\\times 5$ 的海拔网格，左上角和右下角的格子被标记为起点。对于每一个起点，我们要能够到达至少 $10$ 个格子。\n\n左上角起点的难度评级是 $4$，右下角起点的难度评级是 $20$。", "locale": "zh-CN"}}}
{"pid": "P3102", "type": "P", "difficulty": 5, "samples": [["ABABA \n", "8 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "2014", "USACO", "区间 DP"], "title": "[USACO14FEB] Secret Code S", "background": "", "description": "Farmer John has secret message that he wants to hide from his cows; the message is a string of length at least 2 containing only the characters A..Z.\n\nTo encrypt his message, FJ applies a sequence of \"operations\" to it, where an operation applied to a string S first shortens S by removing either some (but not all) of the initial characters or some (but not all) of the final characters from S, after which the original string S is attached either at the beginning or end.  For example, a single operation to the string ABC could result in eight possible strings:\n\nAABC\nABABC\nBCABC\nCABC\nABCA\nABCAB\nABCBC\nABCC\nGiven the final encrypted string, please count the number of possible ways FJ could have produced this string using one or more repeated operations applied to some source string.  Operations are treated as being distinct even if they give the same encryption of FJ's message.  For example, there are four distinct separate ways to obtain AAA from AA.\n\nPrint your answer out modulo 2014.\n\n农民约翰收到一条的消息，记该消息为长度至少为2，只由大写字母组成的字符串S，他通过一系列操作对S进行加密。\n\n\n他的操作为，删除S的前面或者后面的若干个字符（但不删光整个S），并将剩下的部分连接到原字符串S的前面或者后面。如对于S=‘ABC’，共有8总可能的操作结果：\n\n\nAABC\n\nABABC\n\nBCABC\n\nCABC\n\nABCA\n\nABCAB\n\nABCBC\n\nABCC\n\n给出加密后的目标字符串，请计算共有多少种加密的方案。\n\n\n对于同字符的字符串，加密方案不止一种，比如把AA加密成AAA，共有4种加密方案。将你的答案mod 2014后输出。\n", "inputFormat": "\\* Line 1: A single encrypted string of length at most 100.\n", "outputFormat": "\\* Line 1: The number of ways FJ could have produced this string with one or more successive operations applied to some initial string of length at least 2, written out modulo 2014.  If there are no such ways, output zero.\n", "hint": "Here are the different ways FJ could have produced ABABA:\n\n1. Start with ABA -> AB+ABA\n\n2. Start with ABA -> ABA+BA\n\n3. Start with AB -> AB+A -> AB+ABA\n\n4. Start with AB -> AB+A -> ABA+BA\n\n5. Start with BA -> A+BA -> AB+ABA\n\n6. Start with BA -> A+BA -> ABA+BA\n\n7. Start with ABAB -> ABAB+A\n\n8. Start with BABA -> A+BABA\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO14FEB] Secret Code S", "background": "", "description": "Farmer John has a secret message he wants to hide from his cows; the message is a string S of length at least 2 containing only the uppercase letters A–Z.\n\nTo encrypt S, FJ applies one or more operations. In a single operation on a string S, he first shortens S by removing some (but not all) of the initial characters or some (but not all) of the final characters of S, after which the original string S is attached either to the beginning or the end. For example, applying a single operation to S = ABC can yield the following eight strings:\n\nAABC\nABABC\nBCABC\nCABC\nABCA\nABCAB\nABCBC\nABCC\n\nGiven the final encrypted string, please count the number of possible ways FJ could have produced this string using one or more operations applied to some source string. Operations are treated as distinct even if they give the same encryption of FJ’s message. For example, there are four distinct ways to obtain AAA from AA. Print your answer modulo 2014.", "inputFormat": "- Line 1: A single encrypted string of length at most 100.", "outputFormat": "- Line 1: The number of ways FJ could have produced this string with one or more successive operations applied to some initial string of length at least 2, written modulo 2014. If there are no such ways, output 0.", "hint": "Here are the different ways FJ could have produced ABABA:\n\n1. Start with ABA -> AB+ABA.\n2. Start with ABA -> ABA+BA.\n3. Start with AB -> AB+A -> AB+ABA.\n4. Start with AB -> AB+A -> ABA+BA.\n5. Start with BA -> A+BA -> AB+ABA.\n6. Start with BA -> A+BA -> ABA+BA.\n7. Start with ABAB -> ABAB+A.\n8. Start with BABA -> A+BABA.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO14FEB] Secret Code S", "background": "", "description": "Farmer John has secret message that he wants to hide from his cows; the message is a string of length at least 2 containing only the characters A..Z.\n\nTo encrypt his message, FJ applies a sequence of \"operations\" to it, where an operation applied to a string S first shortens S by removing either some (but not all) of the initial characters or some (but not all) of the final characters from S, after which the original string S is attached either at the beginning or end.  For example, a single operation to the string ABC could result in eight possible strings:\n\nAABC\nABABC\nBCABC\nCABC\nABCA\nABCAB\nABCBC\nABCC\nGiven the final encrypted string, please count the number of possible ways FJ could have produced this string using one or more repeated operations applied to some source string.  Operations are treated as being distinct even if they give the same encryption of FJ's message.  For example, there are four distinct separate ways to obtain AAA from AA.\n\nPrint your answer out modulo 2014.\n\n农民约翰收到一条的消息，记该消息为长度至少为2，只由大写字母组成的字符串S，他通过一系列操作对S进行加密。\n\n\n他的操作为，删除S的前面或者后面的若干个字符（但不删光整个S），并将剩下的部分连接到原字符串S的前面或者后面。如对于S=‘ABC’，共有8总可能的操作结果：\n\n\nAABC\n\nABABC\n\nBCABC\n\nCABC\n\nABCA\n\nABCAB\n\nABCBC\n\nABCC\n\n给出加密后的目标字符串，请计算共有多少种加密的方案。\n\n\n对于同字符的字符串，加密方案不止一种，比如把AA加密成AAA，共有4种加密方案。将你的答案mod 2014后输出。\n", "inputFormat": "\\* Line 1: A single encrypted string of length at most 100.\n", "outputFormat": "\\* Line 1: The number of ways FJ could have produced this string with one or more successive operations applied to some initial string of length at least 2, written out modulo 2014.  If there are no such ways, output zero.\n", "hint": "Here are the different ways FJ could have produced ABABA:\n\n1. Start with ABA -> AB+ABA\n\n2. Start with ABA -> ABA+BA\n\n3. Start with AB -> AB+A -> AB+ABA\n\n4. Start with AB -> AB+A -> ABA+BA\n\n5. Start with BA -> A+BA -> AB+ABA\n\n6. Start with BA -> A+BA -> ABA+BA\n\n7. Start with ABAB -> ABAB+A\n\n8. Start with BABA -> A+BABA\n", "locale": "zh-CN"}}}
{"pid": "P3103", "type": "P", "difficulty": 6, "samples": [["3 \n2 5 \n3 10 \n1 5 \n", "19 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "USACO", "平衡树"], "title": "[USACO14FEB]Airplane Broading G", "background": "", "description": "FJ's cows have decided to take a vacation, and have miraculously managed to find an airline willing to sell them tickets. When they arrive at the airport and start boarding their plane, they face an interesting problem, however.\n\nThe airplane has $N$ seats, which we model as the points $x=1$ through $x=N$ on the number line. All N cows $(1 \\le N \\le 200,000)$ are standing in line waiting to get to their seats. Cow $N$ is at position $x=0$, Cow $N-1$ is at position $x=-1$, and so on. Cow i has been assigned to Seat $S_i$, where $S_1$,...,$S_N$ is a permutation of $1$,...,$N$.\n\nAt each time step, each cow takes a step to the right if she can. When cow $i$ reaches her seat $S_i$, she will stop to put her baggage in the overhead bin, which takes $T_i$ seconds, and then sit down. For those $T_i$ steps, the cow behind her (if there is one) is blocked from moving forward. If there is a line of cows behind her, the line is effectively blocked as well.\n\nHow long will it take for all the cows to sit down?\n\nThe sum of $T_i$ for all cows will be less than $1,000,000,000$.", "inputFormat": "* Line $1$: A single integer, $N$.\n\n* Lines $2$..$N+1$: Two space-separated integers, $S_i$ and $T_i$.", "outputFormat": "* Line $1$: A single line indicating the amount of time it takes to seat all cows.", "hint": "Initially, the cows are situated like this:\n\ncows -> $123$\n\n$123$ <- seats\n\nwith cow $1$ trying to get to seat $2$, cow $2$ trying to get to seat $3$, and cow $3$ trying to get to seat $1$.\n\nAfter one step, they will all move $1$ to the right and cow $3$ will reach her seat:\n\n```123 123``` Cow $3$ takes $5$ seconds to sit down, at which point she effectively disappears.\n\n```12 123``` It takes $3$ more seconds for cows $1$ and $2$ to reach their desired seats:\n\n```12 123``` It takes $5$ seconds for cow $1$ to sit down and $10$ seconds for cow $2$ to sit down, so that's $10$ seconds total.\n\nIn total this took $1 + 5 + 3 + 10 = 19$ seconds.", "locale": "en", "translations": {"en": {"title": "[USACO14FEB]Airplane Broading G", "background": "", "description": "FJ's cows have decided to take a vacation, and have miraculously managed to find an airline willing to sell them tickets. When they arrive at the airport and start boarding their plane, they face an interesting problem, however.\n\nThe airplane has $N$ seats, which we model as the points $x=1$ through $x=N$ on the number line. All N cows $(1 \\le N \\le 200,000)$ are standing in line waiting to get to their seats. Cow $N$ is at position $x=0$, Cow $N-1$ is at position $x=-1$, and so on. Cow i has been assigned to Seat $S_i$, where $S_1$,...,$S_N$ is a permutation of $1$,...,$N$.\n\nAt each time step, each cow takes a step to the right if she can. When cow $i$ reaches her seat $S_i$, she will stop to put her baggage in the overhead bin, which takes $T_i$ seconds, and then sit down. For those $T_i$ steps, the cow behind her (if there is one) is blocked from moving forward. If there is a line of cows behind her, the line is effectively blocked as well.\n\nHow long will it take for all the cows to sit down?\n\nThe sum of $T_i$ for all cows will be less than $1,000,000,000$.", "inputFormat": "* Line $1$: A single integer, $N$.\n\n* Lines $2$..$N+1$: Two space-separated integers, $S_i$ and $T_i$.", "outputFormat": "* Line $1$: A single line indicating the amount of time it takes to seat all cows.", "hint": "Initially, the cows are situated like this:\n\ncows -> $123$\n\n$123$ <- seats\n\nwith cow $1$ trying to get to seat $2$, cow $2$ trying to get to seat $3$, and cow $3$ trying to get to seat $1$.\n\nAfter one step, they will all move $1$ to the right and cow $3$ will reach her seat:\n\n```123 123``` Cow $3$ takes $5$ seconds to sit down, at which point she effectively disappears.\n\n```12 123``` It takes $3$ more seconds for cows $1$ and $2$ to reach their desired seats:\n\n```12 123``` It takes $5$ seconds for cow $1$ to sit down and $10$ seconds for cow $2$ to sit down, so that's $10$ seconds total.\n\nIn total this took $1 + 5 + 3 + 10 = 19$ seconds.", "locale": "en"}, "zh-CN": {"title": "[USACO14FEB] Airplane Boarding G", "background": null, "description": "想象一下飞机有 $N$ 个座位，$N$ 个座位相当于数轴上的 $1$ 至 $N$ 共 $N$ 个整点，第 $1$ 个座位在整点1处，第 $2$ 个座位在整点2处，……，第 $N$ 个座位在整点 $N$ 处。\n\n\n有 $N$ 个奶牛排好队要登机，第 $N$ 头奶牛在数轴的整点 $0$ 处，第 $N−1$ 头奶牛在数轴的整点 $−1$ 处，……，第 $1$ 头奶牛在数轴的整点 $−N+1$ 处。第 $i$ 头奶牛的座位号是 $S_i$。注意：每头奶牛都有唯一的一个座位，不会出现多头奶牛有相同的座位号。\n\n\n在每一秒钟，奶牛会向右移动一步到达下一个整点，前提是没有奶牛挡住它。当第 $i$ 头奶牛到达它的座位 $S_i$ 时，它需要花费 $T_i$ 秒去把行李放到头顶的行李架上，然后坐到自己的位置上，在此过程中，由于飞机通道很窄，所以在第 $i$ 头奶牛坐到自己座位之前，在它左边的所有奶牛都不能动，要等奶牛 $i$ 放好行李坐好后才能动。\n\n\n现在的问题是，至少要多少秒之后，所有的奶牛都能做到自己的座位上？", "inputFormat": "第一行：一个整数 $N (1 \\le N \\le 2 \\times 10^5)$。\n\n第 $2$ 行到第 $N+1$ 行：每行两个整数 $S_i, T_i$。\n\n保证 $S_1 \\sim S_n$ 是 $1 \\sim n$ 的排列，所有 $T_i$ 之和 $\\le 10^9$。", "outputFormat": "一行一个整数，表示使所有的奶牛都能做到自己的座位上的最短时间。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P3104", "type": "P", "difficulty": 5, "samples": [["4 \n1 \n2 \n2 \n1 \n3 \n", "3 \n1 \n4 \n5 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "图论", "贪心", "2014", "二分", "USACO", "生成树"], "title": "[USACO14MAR] Counting Friends G", "background": null, "description": "FJ 的 $N(2 \\le N \\le 500)$ 头奶牛加入了社交网络“牛书”。\n\n每一头奶牛在牛书上都有一个或多个朋友，于是 FJ 做了一个列表，列出了每头奶牛的朋友数量。但在这一过程中，他错误地将一个额外的数加入了列表（所以最终的列表包含 $N+1$ 个数，而不是预期的 $N$ 个数）。\n\n请帮助 FJ 找出哪一个数可能是错误的那个数。", "inputFormat": "第 $1$ 行：一个整数 $N$。\n\n第 $2$ 至 $N+2$ 行：共 $N+1$ 个数，每一行表示一头奶牛的朋友数量，也有可能是错误的那个数。", "outputFormat": "第 $1$ 行：一个整数 $K$，表示有多少个数可能是错误的（若 $K=0$，表示移出任意一个数都无法产生一个可行的朋友配对）。\n\n第 $2$ 至 $K+1$ 行：每一行包括一个 FJ 列表的编号，对应的数可能是那个错误的数。也就是说，这个数字被移除可使得剩余的 $N$ 个数字成为一组合法的朋友关系。**编号按从小到大顺序输出。**", "hint": "#### 样例解释\n\nFJ 有四头奶牛。其中两头有一个朋友，两头有两个朋友，一头有三个朋友（当然，其中一个数字是错误的，不应出现在列表上）。\n\n移除 FJ 列表上的第一个数字，余下的序列是 $2,2,1,3$，是合法的。如果我们把四头奶牛命名为 $A,B,C,D$，就有 $(A,B),(A,C),(A,D),(B,C)$ 的配对方式符合要求。同样的，移除列表中的第四、第五个数字，也可以形成合法的朋友关系，移除数字 $2$ 则无法形成合法的朋友关系。容易发现，若移除了数字 $2$，剩余的数字为奇数，显然无法形成合法的朋友关系。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO14MAR] Counting Friends G", "background": "", "description": "FJ’s $N(2 \\le N \\le 500)$ cows have joined the social network \"Cowbook\".\n\nEach cow has one or more friends on Cowbook, so FJ made a list of each cow’s number of friends. During this process, however, he mistakenly included one extra number in the list (so the final list contains $N+1$ numbers, instead of the expected $N$).\n\nPlease help FJ determine which numbers could be the erroneous one.", "inputFormat": "Line 1: An integer $N$.\n\nLines 2 to $N+2$: A total of $N+1$ integers, each line giving the number of friends of a cow, possibly including the erroneous one.", "outputFormat": "Line 1: An integer $K$, the number of values that could be erroneous (if $K=0$, it means that removing any single number cannot produce a feasible friendship configuration).\n\nLines 2 to $K+1$: Each line contains an index in FJ’s list whose number could be the erroneous one. That is, removing that number makes the remaining $N$ numbers form a valid set of friendships. Output the indices in increasing order.", "hint": "Sample explanation:\n\nFJ has four cows. Two of them have one friend, two have two friends, and one has three friends (of course, one of these numbers is wrong and should not be on the list).\n\nIf we remove the first number in FJ’s list, the remaining sequence is $2, 2, 1, 3$, which is valid. If we name the four cows $A, B, C, D$, then the pairings $(A,B),(A,C),(A,D),(B,C)$ satisfy the requirements. Similarly, removing the fourth or fifth number also yields a valid friendship configuration. However, removing a $2$ cannot yield a valid configuration. It is easy to see that if a $2$ is removed, the sum of the remaining numbers is odd, which clearly cannot form a valid friendship configuration.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO14MAR] Counting Friends G", "background": null, "description": "FJ 的 $N(2 \\le N \\le 500)$ 头奶牛加入了社交网络“牛书”。\n\n每一头奶牛在牛书上都有一个或多个朋友，于是 FJ 做了一个列表，列出了每头奶牛的朋友数量。但在这一过程中，他错误地将一个额外的数加入了列表（所以最终的列表包含 $N+1$ 个数，而不是预期的 $N$ 个数）。\n\n请帮助 FJ 找出哪一个数可能是错误的那个数。", "inputFormat": "第 $1$ 行：一个整数 $N$。\n\n第 $2$ 至 $N+2$ 行：共 $N+1$ 个数，每一行表示一头奶牛的朋友数量，也有可能是错误的那个数。", "outputFormat": "第 $1$ 行：一个整数 $K$，表示有多少个数可能是错误的（若 $K=0$，表示移出任意一个数都无法产生一个可行的朋友配对）。\n\n第 $2$ 至 $K+1$ 行：每一行包括一个 FJ 列表的编号，对应的数可能是那个错误的数。也就是说，这个数字被移除可使得剩余的 $N$ 个数字成为一组合法的朋友关系。**编号按从小到大顺序输出。**", "hint": "#### 样例解释\n\nFJ 有四头奶牛。其中两头有一个朋友，两头有两个朋友，一头有三个朋友（当然，其中一个数字是错误的，不应出现在列表上）。\n\n移除 FJ 列表上的第一个数字，余下的序列是 $2,2,1,3$，是合法的。如果我们把四头奶牛命名为 $A,B,C,D$，就有 $(A,B),(A,C),(A,D),(B,C)$ 的配对方式符合要求。同样的，移除列表中的第四、第五个数字，也可以形成合法的朋友关系，移除数字 $2$ 则无法形成合法的朋友关系。容易发现，若移除了数字 $2$，剩余的数字为奇数，显然无法形成合法的朋友关系。", "locale": "zh-CN"}}}
{"pid": "P3105", "type": "P", "difficulty": 5, "samples": [["5 \n8 W \n11 S \n3 W \n10 W \n5 S \n", "7 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "USACO", "枚举", "哈希 hashing", "前缀和"], "title": "[USACO14OPEN] Fair Photography S", "background": "", "description": "FJ's N cows (2 <= N <= 100,000) are standing at various positions along a long one-dimensional fence.  The ith cow is standing at position x\\_i (an integer in the range 0...1,000,000,000) and is either a plain white cow or a spotted cow.  No two cows occupy the same position, and there is at least one white cow.\n\n\nFJ wants to take a photo of a contiguous interval of cows for the county fair, but in fairness to his different cows, he wants to ensure there are equal numbers of white and spotted cows in the photo.  FJ wants to determine the maximum size of such a fair photo, where the size of a photo is the difference between the maximum and minimum positions of the cows in the photo.\n\n\nTo give himself an even better chance of taking a larger photo, FJ has with him a bucket of paint that he can use to paint spots on an arbitrary subset of his white cows of his choosing, effectively turning them into spotted cows.  Please determine the largest size of a fair photo FJ can take, given that FJ has the option of painting some of his white cows (of course, he does not need to paint any of the white cows if he decides this is better).\n", "inputFormat": "\\* Line 1: The integer N.\n\n\\* Lines 2..1+N: Line i+1 contains x\\_i and either W (for a white cow) or S (for a spotted cow).\n", "outputFormat": "\\* Line 1: The maximum size of a fair photo FJ can take, after possibly painting some of his white cows to make them spotted.\n", "hint": "There are 5 cows.  One of them is a white cow at position 8, and so on.\n\n\nFJ takes a photo of the cows from positions 3 to positions 10.  There are 4 cows in this range -- 3 white and 1 spotted -- so he needs to paint one of the white cows to make it spotted.\n", "locale": "en", "translations": {"en": {"title": "[USACO14OPEN] Fair Photography S", "background": "", "description": "FJ's N cows (2 <= N <= 100,000) are standing at various positions along a long one-dimensional fence.  The ith cow is standing at position x\\_i (an integer in the range 0...1,000,000,000) and is either a plain white cow or a spotted cow.  No two cows occupy the same position, and there is at least one white cow.\n\n\nFJ wants to take a photo of a contiguous interval of cows for the county fair, but in fairness to his different cows, he wants to ensure there are equal numbers of white and spotted cows in the photo.  FJ wants to determine the maximum size of such a fair photo, where the size of a photo is the difference between the maximum and minimum positions of the cows in the photo.\n\n\nTo give himself an even better chance of taking a larger photo, FJ has with him a bucket of paint that he can use to paint spots on an arbitrary subset of his white cows of his choosing, effectively turning them into spotted cows.  Please determine the largest size of a fair photo FJ can take, given that FJ has the option of painting some of his white cows (of course, he does not need to paint any of the white cows if he decides this is better).\n", "inputFormat": "\\* Line 1: The integer N.\n\n\\* Lines 2..1+N: Line i+1 contains x\\_i and either W (for a white cow) or S (for a spotted cow).\n", "outputFormat": "\\* Line 1: The maximum size of a fair photo FJ can take, after possibly painting some of his white cows to make them spotted.\n", "hint": "There are 5 cows.  One of them is a white cow at position 8, and so on.\n\n\nFJ takes a photo of the cows from positions 3 to positions 10.  There are 4 cows in this range -- 3 white and 1 spotted -- so he needs to paint one of the white cows to make it spotted.\n", "locale": "en"}, "zh-CN": {"title": "[USACO14OPEN] Fair Photography S", "background": null, "description": "FJ 的 $N$ 头奶牛站在一条长长的一维栅栏的不同位置上。第 $i$ 头奶牛站在位置非负整数 $x_i$ 上，并且要么是纯白色奶牛，要么是斑点奶牛。没有两头奶牛占据相同的位置，并且至少有一头白色奶牛。\n\nFJ 想为县集市拍摄一张连续区间内的奶牛照片，但为了公平对待他的不同奶牛，他希望确保照片中白色奶牛和斑点奶牛的数量相等。FJ 想要确定这样一张公平照片的最大尺寸，其中照片的尺寸是照片中奶牛的最大位置和最小位置之间的差。\n\n为了给自己更大的机会拍摄更大的照片，FJ 带了一桶油漆，他可以用来在他选择的任意一部分白色奶牛上画上斑点，有效地将它们变成斑点奶牛。请确定 FJ 可以拍摄的公平照片的最大尺寸，前提是 FJ 可以选择给一些白色奶牛涂上斑点（当然，如果他认为这样更好，他不需要给任何白色奶牛涂上斑点）。", "inputFormat": "第 $1$ 行，表示整数 $N$。\n\n第 $2$ 到 $N+1$ 行，其中第 $i+1$ 行包含 $x_i$ 和 `W`（表示白色奶牛）或 `S`（表示斑点奶牛）。", "outputFormat": "输出 $1$ 行，表示 FJ 在可能给一些白色奶牛涂上斑点后可以拍摄的公平照片的最大尺寸。", "hint": "样例 $1$ 解释：\n\n有 $5$ 头奶牛。其中一头是位于位置 $8$ 的白色奶牛，依此类推。\n\nFJ 拍摄了从位置 $3$ 到位置 $10$ 的奶牛照片。在这个范围内有 $4$ 头奶牛——$3$ 头白色和 $1$ 头斑点——所以他需要将其中一头白色奶牛涂成斑点。\n\n数据约定:\n\n$0 \\le x_i \\le 10^9$\n\n$2 \\le N \\le 100000$\n\n（由 ChatGPT 4o 翻译）", "locale": "zh-CN"}}}
{"pid": "P3106", "type": "P", "difficulty": 5, "samples": [["5 7 \n3 4 7 1 \n1 3 2 20 \n1 4 17 18 \n4 5 25 3 \n1 2 10 1 \n3 5 4 14 \n2 4 6 5 \n", "1 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "USACO", "最短路"], "title": "[USACO14OPEN] Dueling GPSs S", "background": "", "description": "Farmer John has recently purchased a new car online, but in his haste he accidentally clicked the \"Submit\" button twice when selecting extra features for the car, and as a result the car ended up equipped with two GPS navigation systems!  Even worse, the two systems often make conflicting decisions about the route that FJ should take.\n\nThe map of the region in which FJ lives consists of N intersections (2 <= N <= 10,000) and M directional roads (1 <= M <= 50,000).  Road i connects intersections A\\_i (1 <= A\\_i <= N) and B\\_i (1 <= B\\_i <= N). Multiple roads could connect the same pair of intersections, and a bi-directional road (one permitting two-way travel) is represented by two separate directional roads in opposite orientations.  FJ's house is located at intersection 1, and his farm is located at intersection N.  It is possible to reach the farm from his house by traveling along a series of directional roads.\n\nBoth GPS units are using the same underlying map as described above; however, they have different notions for the travel time along each road. Road i takes P\\_i units of time to traverse according to the first GPS unit, and Q\\_i units of time to traverse according to the second unit (each travel time is an integer in the range 1..100,000).\n\nFJ wants to travel from his house to the farm.  However, each GPS unit complains loudly any time FJ follows a road (say, from intersection X to intersection Y) that the GPS unit believes not to be part of a shortest route from X to the farm (it is even possible that both GPS units can complain, if FJ takes a road that neither unit likes).\n\nPlease help FJ determine the minimum possible number of total complaints he can receive if he chooses his route appropriately.  If both GPS units complain when FJ follows a road, this counts as +2 towards the total.\n", "inputFormat": "\\* Line 1: The integers N and M.\n\nLine i describes road i with four integers: A\\_i B\\_i P\\_i Q\\_i.\n", "outputFormat": "\\* Line 1: The minimum total number of complaints FJ can receive if he routes himself from his house to the farm optimally.\n", "hint": "There are 5 intersections and 7 directional roads.  The first road connects from intersection 3 to intersection 4; the first GPS thinks this road takes 7 units of time to traverse, and the second GPS thinks it takes 1 unit of time, etc.\n\n\nIf FJ follows the path 1 -> 2 -> 4 -> 5, then the first GPS complains on the 1 -> 2 road (it would prefer the 1 -> 3 road instead).  However, for the rest of the route 2 -> 4 -> 5, both GPSs are happy, since this is a shortest route from 2 to 5 according to each GPS.\n", "locale": "en", "translations": {"en": {"title": "[USACO14OPEN] Dueling GPSs S", "background": "", "description": "Farmer John has recently purchased a new car online, but in his haste he accidentally clicked the \"Submit\" button twice when selecting extra features for the car, and as a result the car ended up equipped with two GPS navigation systems!  Even worse, the two systems often make conflicting decisions about the route that FJ should take.\n\nThe map of the region in which FJ lives consists of N intersections (2 <= N <= 10,000) and M directional roads (1 <= M <= 50,000).  Road i connects intersections A\\_i (1 <= A\\_i <= N) and B\\_i (1 <= B\\_i <= N). Multiple roads could connect the same pair of intersections, and a bi-directional road (one permitting two-way travel) is represented by two separate directional roads in opposite orientations.  FJ's house is located at intersection 1, and his farm is located at intersection N.  It is possible to reach the farm from his house by traveling along a series of directional roads.\n\nBoth GPS units are using the same underlying map as described above; however, they have different notions for the travel time along each road. Road i takes P\\_i units of time to traverse according to the first GPS unit, and Q\\_i units of time to traverse according to the second unit (each travel time is an integer in the range 1..100,000).\n\nFJ wants to travel from his house to the farm.  However, each GPS unit complains loudly any time FJ follows a road (say, from intersection X to intersection Y) that the GPS unit believes not to be part of a shortest route from X to the farm (it is even possible that both GPS units can complain, if FJ takes a road that neither unit likes).\n\nPlease help FJ determine the minimum possible number of total complaints he can receive if he chooses his route appropriately.  If both GPS units complain when FJ follows a road, this counts as +2 towards the total.\n", "inputFormat": "\\* Line 1: The integers N and M.\n\nLine i describes road i with four integers: A\\_i B\\_i P\\_i Q\\_i.\n", "outputFormat": "\\* Line 1: The minimum total number of complaints FJ can receive if he routes himself from his house to the farm optimally.\n", "hint": "There are 5 intersections and 7 directional roads.  The first road connects from intersection 3 to intersection 4; the first GPS thinks this road takes 7 units of time to traverse, and the second GPS thinks it takes 1 unit of time, etc.\n\n\nIf FJ follows the path 1 -> 2 -> 4 -> 5, then the first GPS complains on the 1 -> 2 road (it would prefer the 1 -> 3 road instead).  However, for the rest of the route 2 -> 4 -> 5, both GPSs are happy, since this is a shortest route from 2 to 5 according to each GPS.\n", "locale": "en"}, "zh-CN": {"title": "[USACO14OPEN] Dueling GPSs S", "background": null, "description": "农夫约翰最近在网上购买了一辆新车，但由于匆忙，他在选择汽车的额外功能时不小心点击了两次“提交” 按钮，结果车上配备了两个 GPS 导航系统！更糟糕的是，这两个系统经常对约翰应该走的路线做出相互矛盾的决定。\n\n约翰所在地区的地图由 $N$ 个交叉路口 $(2 \\le N \\le 10,000)$ 和 $M$ 条单向道路 $(1 \\le M \\le 50,000)$ 组成。道路 $i$ 连接交叉路口 $A_i(1 \\le A_i \\le N)$ 和 $B_i(1 \\le B_i \\le N)$。同一对交叉路口之间可能有多条道路连接，双向道路（允许双向通行）由两个相反方向的单向道路表示。约翰的家位于交叉路口 $1$，他的农场位于交叉路口 $N$。可以通过沿着一系列单向道路从他的家到达农场。\n\n两个 GPS 单元使用的是上述相同的基础地图；然而，它们对每条道路的行驶时间有不同的看法。第一个 GPS 单元认为，道路 $i$ 需要 $P_i$ 个时间单位来行驶，而第二个单元认为，道路 $i$ 需要 $Q_i$ 个时间单位来行驶（每个行驶时间是范围在 $1$ 到 $10^5$ 的整数）。\n\n约翰想从家里到农场。然而，每当约翰走一条（比如，从交叉路口 $X$ 到交叉路口 $Y$）GPS 单元认为不是从 $X$ 到农场的最短路线的一部分的道路时， GPS 单元就会大声抱怨（如果约翰走的道路两个 GPS 单元都不喜欢，两个 GPS 单元都会抱怨）。\n\n请帮助约翰确定如果他适当地选择路线，他可以收到的最少总抱怨次数。如果约翰走的道路让两个 GPS 单元都抱怨，这将计为两次抱怨。", "inputFormat": "第 $1$ 行：整数 $N$ 和 $M$。\n\n接下来 $M$ 行，第 $i+1$ 行描述道路 $i$，有四个整数：$A_i,B_i,P_i,Q_i$。", "outputFormat": "共一行，如果约翰从家到农场的路线选择最优，他可以收到的最少总抱怨次数。", "hint": "有 $5$ 个交叉路口和 $7$ 条单向道路。第一条道路从交叉路口 $3$ 连接到交叉路口 $4$；第一个 GPS 认为这条路需要 $7$ 个时间单位来行驶，而第二个 GPS 认为需要 $1$ 个时间单位，等等。\n\n如果约翰走 $1 \\to 2 \\to 4 \\to 5$ 的路径，那么第一个 GPS 会在 $1 \\to 2$ 的道路上抱怨（它更喜欢 $1 \\to 3$ 的道路）。然而，对于路径的其余部分 $2 \\to 4 \\to 5$，两个 GPS 都很满意，因为这对于每个 GPS 来说都是从 $2$ 到 $5$ 的最短路径。", "locale": "zh-CN"}}}
{"pid": "P3107", "type": "P", "difficulty": 6, "samples": [["110 133 \n", "14 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "USACO", "数位 DP"], "title": "[USACO14OPEN] Odometer S", "background": "", "description": "Farmer John's cows are on a road trip!  The odometer on their car displays an integer mileage value, starting at X (100 <= X <= 10^18) miles at the beginning of their trip and ending at Y (X <= Y <= 10^18) miles at the end of their trip.  Whenever the odometer displays an 'interesting' number (including at the start and end of the trip) the cows will moo.  A number is 'interesting' if when you look at all its digits except for leading zeros, at least half of these should be the same.  For example, the numbers 3223 and 110 are interesting, while the numbers 97791 and 123 are not.\n\nHelp FJ count how many times the cows will moo during the trip.", "inputFormat": "\\* Line 1: The first line will contain two integers, X and Y, separated by a space.\n", "outputFormat": "\\* Line 1: A single integer containing how many times the cows will moo during the trip.\n", "hint": "The trip starts with the odometer at 110 and ends at 133. \n\nThe cows moo when the odometer reads 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 121, 122, 131, and 133. \n\n", "locale": "en", "translations": {"en": {"title": "[USACO14OPEN] Odometer S", "background": "", "description": "Farmer John's cows are on a road trip!  The odometer on their car displays an integer mileage value, starting at X (100 <= X <= 10^18) miles at the beginning of their trip and ending at Y (X <= Y <= 10^18) miles at the end of their trip.  Whenever the odometer displays an 'interesting' number (including at the start and end of the trip) the cows will moo.  A number is 'interesting' if when you look at all its digits except for leading zeros, at least half of these should be the same.  For example, the numbers 3223 and 110 are interesting, while the numbers 97791 and 123 are not.\n\nHelp FJ count how many times the cows will moo during the trip.", "inputFormat": "\\* Line 1: The first line will contain two integers, X and Y, separated by a space.\n", "outputFormat": "\\* Line 1: A single integer containing how many times the cows will moo during the trip.\n", "hint": "The trip starts with the odometer at 110 and ends at 133. \n\nThe cows moo when the odometer reads 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 121, 122, 131, and 133. \n\n", "locale": "en"}, "zh-CN": {"title": "[USACO14OPEN] Odometer S", "background": "", "description": "农夫约翰的奶牛们正在进行一次公路旅行！他们的车上的里程表显示一个整数的里程值，旅行开始时为 $X$（$100 \\leq X \\leq 10^{18}$）英里，结束时为 $Y$（$X \\leq Y \\leq 10^{18}$）英里。每当里程表显示一个“有趣”的数字时（包括旅行的开始和结束），奶牛们就会哞叫。如果一个数字在去掉前导零后，其至少一半的数字是相同的，那么这个数字就是“有趣”的。例如，数字 3223 和 110 是有趣的，而数字 97791 和 123 则不是。\n\n帮助农夫约翰计算在旅行中奶牛们会哞叫多少次。", "inputFormat": "* 第 1 行：第一行包含两个整数 $X$ 和 $Y$，用空格分隔。", "outputFormat": "* 第 1 行：一个整数，表示旅行中奶牛们会哞叫的次数。", "hint": "旅行开始时里程表为 110，结束时为 133。\n\n当里程表显示 110、111、112、113、114、115、116、117、118、119、121、122、131 和 133 时，奶牛们会哞叫。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P3108", "type": "P", "difficulty": 6, "samples": [["4 1 2 \n-2 1 \\ \n2 1 / \n2 2 \\ \n-2 2 / \n", "2 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2014", "线段树", "USACO", "前缀和"], "title": "[USACO14OPEN] Cow Optics G", "background": null, "description": "农场主约翰的牛想在谷仓里面举办舞会，用激光灯来表演。但不幸的是唯一的激光灯离谷仓太远，并且搬不动，所以牛们想用镜子来反射激光，使得激光照到谷仓。\n\n激光的位置在 $(0,0)$，指向为北方（即 y 轴正方向），谷仓在位置 $(Bx,By)$。已经有 $N$ 头奶牛拿着镜子分散在农场的各个位置 $(1 \\le N \\le 100,000)$，镜子与原点之间的夹角为 45 度。例如一个这样（“\\”）的镜子可以把从下方射来的光线反射成向左的光线。\n\nBessie 在启动激光的前一刻意识到计划有缺陷，所以她自己又拿着一面镜子出去了，恰好使得激光照到谷仓。\n\n请计算 Bessie 可能站在的位置的总数。\n\n坐标范围：-1,000,000,000 到 1,000,000,000，数据保证初始时激光光束不会反射回 $(0,0)$ 位置。同一点上不可能有多头牛，Bessie 不能站在其他牛的位置。", "inputFormat": "第一行三个整数：$N$，$Bx$，$By$。\n\n第 $2∼N+1$行：每行两个整数表示牛的位置，一个字符（“/”或“\\\\”）表示镜子怎么放置的。", "outputFormat": "Bessie 所有可能站在的位置总数。", "hint": "样例中 Bessie 可能站在 $(0,1)$ 或者 $(0,2)$。\n\n感谢 @SystemLLH 提供翻译。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO14OPEN] Cow Optics G", "background": null, "description": "Farmer John's cows would like to host a dance party in their barn, complete with a laser light show. Unfortunately, the only working laser they have found is located far away from the barn and too heavy to move, so they plan to re-direct the laser light to the barn using a series of mirrors.\n\nThe layout of the farm has the laser at position $(0,0)$ pointing north (in the positive y direction), and the barn at $(Bx, By)$; we can think of both the laser and the barn as points in the 2D plane. There are already $N$ cows $(1 \\le N \\le 100,000)$ scattered throughout the farm holding mirrors that are aligned at angles of 45 degrees to the axes. For example, a mirror aligned like \\ will take a beam of light entering from below and reflect it to the left. We can also think of the mirrors as being located at points in the 2D plane.\n\nJust before pressing the big red button to activate the laser, Bessie noticed a major flaw in the plan: the laser cannot hit the barn with the mirrors in their current configuration! As a result, she plans to run out onto the field, and hold up one more mirror (placed once again at a 45 degree angle) in order to redirect the laser onto the barn. Please count the number of locations in the field where Bessie can stand to accomplish this goal.\n\nAll coordinates are integers between $-1,000,000,000$ and $1,000,000,000$. It is guaranteed that any mirrors to be placed will be in this range as well. The cows running the laser insist that the beam should never come back to $(0,0)$ after leaving this location (and with the mirrors in their initial configuration, it is guaranteed that this will not happen). No two cows occupy the same point in space, and Bessie cannot locate herself at the same position as an existing cow.", "inputFormat": "Line 1: The integers $N$, $Bx$, and $By$.\n\nLines 2...$N + 1$: Line $i+1$ describes the ith mirror with 3 elements: its $(x,y)$ location, and its orientation (either '\\\\' or '/').", "outputFormat": "where Bessie can stand to redirect the laser to the barn.", "hint": "A mirror at $(0,1)$ or $(0,2)$ placed in either direction would do the trick.", "locale": "en"}, "zh-CN": {"title": "[USACO14OPEN] Cow Optics G", "background": null, "description": "农场主约翰的牛想在谷仓里面举办舞会，用激光灯来表演。但不幸的是唯一的激光灯离谷仓太远，并且搬不动，所以牛们想用镜子来反射激光，使得激光照到谷仓。\n\n激光的位置在 $(0,0)$，指向为北方（即 y 轴正方向），谷仓在位置 $(Bx,By)$。已经有 $N$ 头奶牛拿着镜子分散在农场的各个位置 $(1 \\le N \\le 100,000)$，镜子与原点之间的夹角为 45 度。例如一个这样（“\\”）的镜子可以把从下方射来的光线反射成向左的光线。\n\nBessie 在启动激光的前一刻意识到计划有缺陷，所以她自己又拿着一面镜子出去了，恰好使得激光照到谷仓。\n\n请计算 Bessie 可能站在的位置的总数。\n\n坐标范围：-1,000,000,000 到 1,000,000,000，数据保证初始时激光光束不会反射回 $(0,0)$ 位置。同一点上不可能有多头牛，Bessie 不能站在其他牛的位置。", "inputFormat": "第一行三个整数：$N$，$Bx$，$By$。\n\n第 $2∼N+1$行：每行两个整数表示牛的位置，一个字符（“/”或“\\\\”）表示镜子怎么放置的。", "outputFormat": "Bessie 所有可能站在的位置总数。", "hint": "样例中 Bessie 可能站在 $(0,1)$ 或者 $(0,2)$。\n\n感谢 @SystemLLH 提供翻译。", "locale": "zh-CN"}}}
{"pid": "P3109", "type": "P", "difficulty": 6, "samples": [["6 2 \n0 \n1 \n2 \n3 \n3 \n4 01234 \n5 91234 \n", "19 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2014", "线段树", "USACO", "树形 DP", "容斥原理", "字典树 Trie"], "title": "[USACO14OPEN] Code Breaking G", "background": null, "description": "有一棵 $N$ $(1 \\leq N \\leq 2\\times 10^4)$ 个节点的有根树，每个节点可以填 $0\\sim9$。\n\n有 $M$ $(1 \\leq M \\leq 5\\times 10^4)$ 个限制，限制了从 $X$ 开始往祖先跳的的包含 $X$ 的 $5$ 个节点（保证 $X$ 上面一定存在这样一条路径,也就是说 $X$ 的深度至少为 $5$），一定不是 $ABCDE$。\n\n请你求出，根据这 $M$ 个限制，共有多少种给这棵树全部填上数的方案一定是**不可能**的。", "inputFormat": "第 $1$ 行：两个用空格分隔的整数 $N$ 和 $M$。\n\n第 $2\\sim N$ 行：第 $i+1$ 行包含一个整数 $p_i$，表示树中节点 $i$ 的父节点，满足 $0\\leq p_i<i$。\n\n第 $N+1\\sim N+M$ 行：第 $N+i$ 行描述第 $i$ 个禁止出现的序列。该行包含用空格分隔的 $v_i$ 和 $s_i$，其中 $v_i$ 是该序列的起始节点，$s_i$ 是一个 $5$ 位字符串，已知从 $v_i$ 开始向上遍历树得到的 $5$ 个节点的数字序列，不能等于 $s_i$ 对应的序列。题目保证从 $v_i$ 向上至少有 $5$ 个节点。", "outputFormat": "一行一个整数，表示被排除的不合法配置数量，结果对 $1234567$ 取模。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": null, "background": null, "description": "The cows keep getting in trouble by taking rides on Farmer John's tractor, so he has hidden the keys to the tractor in a fancy new safe in his office. Undeterred, the cows have vowed to try and break into this safe.\n\nThe safe is protected by a rather complicated passcode system. The passcode entry system is arranged as a rooted tree of $N$ $(1 \\leq N \\leq 20,000)$ nodes, each of which requires a digit between $0$ and $9$. The nodes are indexed $0 \\dots N-1$.\n\nThe only information that the cows have is that certain sequences of length $5$ do not occur along particular paths upwards through the tree.\n\nGiven $M$ $(1 \\leq M \\leq 50,000)$ length-$5$ sequences, together with their starting nodes in the tree, help the cows figure out how many passcodes have been ruled out. You should compute your answer modulo $1234567$.", "inputFormat": "Line $1$: Two space-separated integers, $N$ and $M$.\n\nLines $2\\dots N$: Line $i+1$ contains a single integer $p(i)$, denoting the parent of node i in the tree $(0 \\leq p(i) < i)$.\n\nLines $N+1\\dots N+M$: Line $N+i$ describes the ith sequence known not to occur in the code.  The line will contain $v(i)$ and $s(i)$ separated by a space, where $v(i)$ is the starting node of the sequence, and $s(i)$ is a $5$-digit string known not to occur starting at $v(i)$ and proceeding upward in the tree. It is guaranteed that the root is at least $4$ steps upward from $v(i)$.", "outputFormat": "Line $1$: A single integer giving the number of ruled-out configurations,modulo $1234567$.", "hint": null, "locale": "en"}, "zh-CN": {"title": "[USACO14OPEN] Code Breaking G", "background": null, "description": "有一棵 $N$ $(1 \\leq N \\leq 2\\times 10^4)$ 个节点的有根树，每个节点可以填 $0\\sim9$。\n\n有 $M$ $(1 \\leq M \\leq 5\\times 10^4)$ 个限制，限制了从 $X$ 开始往祖先跳的的包含 $X$ 的 $5$ 个节点（保证 $X$ 上面一定存在这样一条路径,也就是说 $X$ 的深度至少为 $5$），一定不是 $ABCDE$。\n\n请你求出，根据这 $M$ 个限制，共有多少种给这棵树全部填上数的方案一定是**不可能**的。", "inputFormat": "第 $1$ 行：两个用空格分隔的整数 $N$ 和 $M$。\n\n第 $2\\sim N$ 行：第 $i+1$ 行包含一个整数 $p_i$，表示树中节点 $i$ 的父节点，满足 $0\\leq p_i<i$。\n\n第 $N+1\\sim N+M$ 行：第 $N+i$ 行描述第 $i$ 个禁止出现的序列。该行包含用空格分隔的 $v_i$ 和 $s_i$，其中 $v_i$ 是该序列的起始节点，$s_i$ 是一个 $5$ 位字符串，已知从 $v_i$ 开始向上遍历树得到的 $5$ 个节点的数字序列，不能等于 $s_i$ 对应的序列。题目保证从 $v_i$ 向上至少有 $5$ 个节点。", "outputFormat": "一行一个整数，表示被排除的不合法配置数量，结果对 $1234567$ 取模。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P3110", "type": "P", "difficulty": 3, "samples": [["4 4 5 8 8 \n1 4 \n2 3 \n3 4 \n4 7 \n2 5 \n5 6 \n6 8 \n7 8 ", "22 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "USACO", "广度优先搜索 BFS", "最短路"], "title": "[USACO14DEC] Piggy Back S", "background": "", "description": "Bessie and her sister Elsie graze in different fields during the day, and in the evening they both want to walk back to the barn to rest. Being clever bovines, they come up with a plan to minimize the total amount of energy they both spend while walking.\n\nBessie spends B units of energy when walking from a field to an adjacent field, and Elsie spends E units of energy when she walks to an adjacent field.  However, if Bessie and Elsie are together in the same field, Bessie can carry Elsie on her shoulders and both can move to an adjacent field while spending only P units of energy (where P might be considerably less than B+E, the amount Bessie and Elsie would have spent individually walking to the adjacent field).  If P is very small, the most energy-efficient solution may involve Bessie and Elsie traveling to a common meeting field, then traveling together piggyback for the rest of the journey to the barn.  Of course, if P is large, it may still make the most sense for Bessie and Elsie to travel\n\nseparately.  On a side note, Bessie and Elsie are both unhappy with the term \"piggyback\", as they don't see why the pigs on the farm should deserve all the credit for this remarkable form of\n\ntransportation.\n\nGiven B, E, and P, as well as the layout of the farm, please compute the minimum amount of energy required for Bessie and Elsie to reach the barn.\n\n", "inputFormat": "INPUT: (file piggyback.in) \n\nThe first line of input contains the positive integers B, E, P, N, and M.  All of these are at most 40,000.  B, E, and P are described above. N is the number of fields in the farm (numbered 1..N, where N >= 3), and M is the number of connections between fields.  Bessie and Elsie start in fields 1 and 2, respectively.  The barn resides in field N. \n\nThe next M lines in the input each describe a connection between a pair of different fields, specified by the integer indices of the two fields.  Connections are bi-directional.  It is always possible to travel from field 1 to field N, and field 2 to field N, along a series of such connections.\n", "outputFormat": "OUTPUT: (file piggyback.out) \n\nA single integer specifying the minimum amount of energy Bessie and\n\nElsie collectively need to spend to reach the barn.  In the example\n\nshown here, Bessie travels from 1 to 4 and Elsie travels from 2 to 3\n\nto 4.  Then, they travel together from 4 to 7 to 8.\n", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO14DEC] Piggy Back S", "background": "", "description": "Bessie and her sister Elsie graze in different fields during the day, and in the evening they both want to walk back to the barn to rest. Being clever bovines, they come up with a plan to minimize the total amount of energy they both spend while walking.\n\nBessie spends B units of energy when walking from a field to an adjacent field, and Elsie spends E units of energy when she walks to an adjacent field.  However, if Bessie and Elsie are together in the same field, Bessie can carry Elsie on her shoulders and both can move to an adjacent field while spending only P units of energy (where P might be considerably less than B+E, the amount Bessie and Elsie would have spent individually walking to the adjacent field).  If P is very small, the most energy-efficient solution may involve Bessie and Elsie traveling to a common meeting field, then traveling together piggyback for the rest of the journey to the barn.  Of course, if P is large, it may still make the most sense for Bessie and Elsie to travel\n\nseparately.  On a side note, Bessie and Elsie are both unhappy with the term \"piggyback\", as they don't see why the pigs on the farm should deserve all the credit for this remarkable form of\n\ntransportation.\n\nGiven B, E, and P, as well as the layout of the farm, please compute the minimum amount of energy required for Bessie and Elsie to reach the barn.\n\n", "inputFormat": "INPUT: (file piggyback.in) \n\nThe first line of input contains the positive integers B, E, P, N, and M.  All of these are at most 40,000.  B, E, and P are described above. N is the number of fields in the farm (numbered 1..N, where N >= 3), and M is the number of connections between fields.  Bessie and Elsie start in fields 1 and 2, respectively.  The barn resides in field N. \n\nThe next M lines in the input each describe a connection between a pair of different fields, specified by the integer indices of the two fields.  Connections are bi-directional.  It is always possible to travel from field 1 to field N, and field 2 to field N, along a series of such connections.\n", "outputFormat": "OUTPUT: (file piggyback.out) \n\nA single integer specifying the minimum amount of energy Bessie and\n\nElsie collectively need to spend to reach the barn.  In the example\n\nshown here, Bessie travels from 1 to 4 and Elsie travels from 2 to 3\n\nto 4.  Then, they travel together from 4 to 7 to 8.\n", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO14DEC] Piggy Back S", "background": "", "description": "Bessie 和 Elsie 在不同的区域放牧，他们希望花费最小的能量返回谷仓。从一个区域走到一个相连区域，Bessie 要花费 $B$ 单位的能量，Elsie要花费 $E$ 单位的能量。\n\n如果某次他们两走到同一个区域，Bessie 可以背着 Elsie 走路，花费 $P$ 单位的能量走到另外一个相连的区域。当然，存在 $P>B+E$ 的情况。\n\n相遇后，他们可以一直背着走，也可以独立分开。\n\nBessie 从 $1$ 号区域出发，Elsie 从 $2$ 号区域出发，两个人都要返回到位于 $n$ 号区域的谷仓。", "inputFormat": "第一行输入 5 个整数 $B,E,P,n,m$。$B,E,P$ 的含义如上文所述。\n$n$ 表示农场中区域的数量，$m$ 表示连接两个区域的道路的数量。\n\n接下来 $m$ 行，每行两个整数 $x,y$，描述一条 $x$ 区域和 $y$ 区域之间的双向边。数据保证图是连通的。", "outputFormat": "一行一个整数，表示 Bessie 和 Elsie 能量花费总和的最小值。", "hint": "$1 \\leq B,E,P,n,m \\leq 4 \\times 10^4$。\n\n#### 样例解释：\nBessie 从 1 走到 4，Elsie 从 2 走到 3 再走到 4。然后，两个人一起从 4 走到 7，再走到 8。", "locale": "zh-CN"}}}
{"pid": "P3111", "type": "P", "difficulty": 3, "samples": [["5 3 \n0 1 \n1 2 \n2 3 \n3 2 \n6 1 \n\n \n\n", " \n\n3 \n\n \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "2014", "USACO", "排序", "广度优先搜索 BFS"], "title": "[USACO14DEC] Cow Jog S", "background": "", "description": " \n\nThe cows are out exercising their hooves again!  There are N cows\n\njogging on an infinitely-long single-lane track (1 <= N <= 100,000).\n\nEach cow starts at a distinct position on the track, and some cows jog\n\nat different speeds.\n\n\n \n\nWith only one lane in the track, cows cannot pass each other.  When a\n\nfaster cow catches up to another cow, she has to slow down to avoid\n\nrunning into the other cow, becoming part of the same running group.\n\n \n\nThe cows will run for T minutes (1 <= T <= 1,000,000,000).  Please\n\nhelp Farmer John determine how many groups will be left at this time.\n\nTwo cows should be considered part of the same group if they are at\n\n\nthe same position at the end of T minutes. \n\n有N (1 <= N <= 100,000)头奶牛在一个单人的超长跑道上慢跑，每头牛的起点位置都不同。由于是单人跑道，所有他们之间不能相互超越。当一头速度快的奶牛追上另外一头奶牛的时候，他必须降速成同等速度。我们把这些跑走同一个位置而且同等速度的牛看成一个小组。\n\n\n请计算T (1 <= T <= 1,000,000,000)时间后，奶牛们将分为多少小组。\n\n", "inputFormat": "INPUT: (file cowjog.in) \n\nThe first line of input contains the two integers N and T.\n\n\nThe following N lines each contain the initial position and speed of a\n\nsingle cow.  Position is a nonnegative integer and speed is a positive\n\ninteger; both numbers are at most 1 billion.  All cows start at\n\ndistinct positions, and these will be given in increasing order in\n\nthe input.\n\n\n ", "outputFormat": "OUTPUT: (file cowjog.out) \n\nA single integer indicating how many groups remain after T minutes.\n\n", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[USACO14DEC] Cow Jog S", "background": "", "description": "There are $N$ cows jogging on an infinitely long single-lane track, where $1 \\le N \\le 100000$. Each cow starts at a distinct position on the track, and some cows jog at different speeds.\n\nSince the track has only one lane, cows cannot pass each other. When a faster cow catches up to a slower cow, she must slow down to avoid running into her, becoming part of the same running group.\n\nThe cows will run for $T$ minutes, where $1 \\le T \\le 1000000000$. Please determine how many groups remain at that time. Two cows are considered part of the same group if they are at the same position at the end of $T$ minutes.", "inputFormat": "- The first line contains two integers $N$ and $T$.\n- Each of the following $N$ lines contains two integers: the initial position and speed of a single cow. The position is a nonnegative integer and the speed is a positive integer; both are at most $10^9$. All cows start at distinct positions, given in increasing order.", "outputFormat": "Output a single integer indicating how many groups remain after $T$ minutes.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO14DEC] Cow Jog S", "background": "", "description": " \n\nThe cows are out exercising their hooves again!  There are N cows\n\njogging on an infinitely-long single-lane track (1 <= N <= 100,000).\n\nEach cow starts at a distinct position on the track, and some cows jog\n\nat different speeds.\n\n\n \n\nWith only one lane in the track, cows cannot pass each other.  When a\n\nfaster cow catches up to another cow, she has to slow down to avoid\n\nrunning into the other cow, becoming part of the same running group.\n\n \n\nThe cows will run for T minutes (1 <= T <= 1,000,000,000).  Please\n\nhelp Farmer John determine how many groups will be left at this time.\n\nTwo cows should be considered part of the same group if they are at\n\n\nthe same position at the end of T minutes. \n\n有N (1 <= N <= 100,000)头奶牛在一个单人的超长跑道上慢跑，每头牛的起点位置都不同。由于是单人跑道，所有他们之间不能相互超越。当一头速度快的奶牛追上另外一头奶牛的时候，他必须降速成同等速度。我们把这些跑走同一个位置而且同等速度的牛看成一个小组。\n\n\n请计算T (1 <= T <= 1,000,000,000)时间后，奶牛们将分为多少小组。\n\n", "inputFormat": "INPUT: (file cowjog.in) \n\nThe first line of input contains the two integers N and T.\n\n\nThe following N lines each contain the initial position and speed of a\n\nsingle cow.  Position is a nonnegative integer and speed is a positive\n\ninteger; both numbers are at most 1 billion.  All cows start at\n\ndistinct positions, and these will be given in increasing order in\n\nthe input.\n\n\n ", "outputFormat": "OUTPUT: (file cowjog.out) \n\nA single integer indicating how many groups remain after T minutes.\n\n", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3112", "type": "P", "difficulty": 5, "samples": [["4 10 \n9 4 1 \n3 3 5 \n5 5 10 \n4 4 5 ", "2 "]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "贪心", "2014", "USACO", "状压 DP"], "title": "[USACO14DEC] Guard Mark G", "background": null, "description": "Farmer John and his herd are playing frisbee.  Bessie throws thefrisbee down the field, but it's going straight to Mark the field handon the other team!  Mark has height $H$ ($1 \\le H \\le 10^9$), butthere are $N$ cows on Bessie's team gathered around Mark ($2 \\le N \\le 20$).They can only catch the frisbee if they can stack up to be at least ashigh as Mark.  Each of the $N$ cows has a height, weight, and strength.A cow's strength indicates the maximum amount of total weight of thecows that can be stacked above her. \n \n Given these constraints, Bessie wants to know if it is possible forher team to build a tall enough stack to catch the frisbee, and if so,what is the maximum safety factor of such a stack.  The safety factorof a stack is the amount of weight that can be added to the top of thestack without exceeding any cow's strength.", "inputFormat": "INPUT: (file guard.in) \n\nThe first line of input contains $N$ and $H$.\n\nThe next N lines of input each describe a cow, giving its height,weight, and strength.  All are positive integers at most $1$ billion.", "outputFormat": "OUTPUT: (file guard.out) \n\n If Bessie's team can build a stack tall enough to catch the frisbee, please output the maximum achievable safety factor for such a stack. \n\nOtherwise output \"Mark is too tall\" (without the quotes).", "hint": null, "locale": "en", "translations": {"en": {"title": "[USACO14DEC] Guard Mark G", "background": null, "description": "Farmer John and his herd are playing frisbee.  Bessie throws thefrisbee down the field, but it's going straight to Mark the field handon the other team!  Mark has height $H$ ($1 \\le H \\le 10^9$), butthere are $N$ cows on Bessie's team gathered around Mark ($2 \\le N \\le 20$).They can only catch the frisbee if they can stack up to be at least ashigh as Mark.  Each of the $N$ cows has a height, weight, and strength.A cow's strength indicates the maximum amount of total weight of thecows that can be stacked above her. \n \n Given these constraints, Bessie wants to know if it is possible forher team to build a tall enough stack to catch the frisbee, and if so,what is the maximum safety factor of such a stack.  The safety factorof a stack is the amount of weight that can be added to the top of thestack without exceeding any cow's strength.", "inputFormat": "INPUT: (file guard.in) \n\nThe first line of input contains $N$ and $H$.\n\nThe next N lines of input each describe a cow, giving its height,weight, and strength.  All are positive integers at most $1$ billion.", "outputFormat": "OUTPUT: (file guard.out) \n\n If Bessie's team can build a stack tall enough to catch the frisbee, please output the maximum achievable safety factor for such a stack. \n\nOtherwise output \"Mark is too tall\" (without the quotes).", "hint": null, "locale": "en"}, "zh-CN": {"title": "[USACO14DEC] Guard Mark G", "background": null, "description": "农夫约翰和他的牛群正在玩飞盘。贝茜将飞盘扔向场地，但它正好飞向对方队伍的场地工马克！马克的身高为 $H$（$1 \\leq H \\leq 10^9$），但贝茜队伍中有 $N$ 头牛围在马克周围（$2 \\leq N \\leq 20$）。只有当它们堆叠起来的高度至少和马克一样高时，它们才能接住飞盘。每头牛都有一个高度、重量和力量。牛的力量表示可以堆叠在她上面的牛的总重量的最大值。\n\n在这些限制条件下，贝茜想知道她的队伍是否可以搭建一个足够高的堆叠来接住飞盘，如果可以，那么这种堆叠的最大安全系数是多少。堆叠的安全系数是指在不超过任何牛的力量的情况下，可以添加到堆叠顶部的重量。", "inputFormat": "输入：（文件 guard.in）\n\n输入的第一行包含 $N$ 和 $H$。\n\n接下来的 $N$ 行输入每行描述一头牛，给出它的高度、重量和力量。所有值都是不超过 10 亿的正整数。", "outputFormat": "输出：（文件 guard.out）\n\n如果贝茜的队伍可以搭建一个足够高的堆叠来接住飞盘，请输出这种堆叠的最大可实现安全系数。\n\n否则输出“Mark is too tall”（不带引号）。", "hint": "题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P3113", "type": "P", "difficulty": 5, "samples": [["5 5 \n-4 4 \n-5 -3 \n-1 5 \n-3 4 \n0 5 \nQ 1 5 \nU 4 0 1 \nU 4 -1 1 \nQ 2 4 \nQ 1 4 \n", "11 \n8 \n8 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "动态规划 DP", "2014", "线段树", "USACO", "枚举"], "title": "[USACO14DEC] Marathon G", "background": "", "description": "An avid marathon runner herself, Bessie enjoys creating marathon courses for her fellow cows to run.  She has most recently designed a route specified by N checkpoints (1 <= N <= 100,000) that must be visited in sequence.\n\n\nUnfortunately, Bessie realizes that the other cows may not have the stamina to run the full route. She therefore wants to know how long certain sub-routes take to run, where a sub-route is a contiguous subsequence of the checkpoints from the full route.  To make matters more complicated, Bessie knows that the other cows, being lazy, might choose to skip one checkpoint any time they run a sub-route -- whichever one results in a minimum total travel time.  They are not allowed to skip the first or last checkpoints in a sub-route, however.\n\n \nIn order to build the best possible marathon course, Bessie wants to investigate the ramifications of making changes to the checkpoint locations in her current course.  Please help her determine how certain changes to checkpoint locations will affect the time required to run different sub-routes (taking into account that the cows might choose to omit one checkpoint any time they run a sub-route).\n\n \nSince the course is set in a downtown area with a grid of streets, the distance between two checkpoints at locations (x1, y1) and (x2, y2) is given by |x1-x2| + |y1-y2|. ", "inputFormat": "\nINPUT: (file marathon.in) \n\nThe first line gives N and Q (1 <= Q <= 100,000). \n\nThe next N lines contain (x, y) locations of N checkpoints in the \n\nsequence they must be visited along the route.  All coordinates are in the range -1000 .. 1000.\n\n\nThe next Q lines consist of updates and queries, one per line, to be processed in the order they are given. Lines will either take the form \"U I X Y\" or \"Q I J\".  A line of the form \"U I X Y\" indicates that the location of checkpoint I (1 <= I <= N) is to be changed to location (X, Y).  A line of the form \"Q I J\" asks for the minimum travel time of the sub-route from checkpoint I to checkpoint J (I <= J), given that the cows choose to skip one checkpoint along this sub-route (but not the endpoints I and J).\n\n", "outputFormat": " \nOUTPUT: (file marathon.out) \n\nFor each sub-route length request, output on a single line the desired length. \n\n", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO14DEC] Marathon G", "background": "", "description": "An avid marathon runner herself, Bessie enjoys creating marathon courses for her fellow cows to run.  She has most recently designed a route specified by N checkpoints (1 <= N <= 100,000) that must be visited in sequence.\n\n\nUnfortunately, Bessie realizes that the other cows may not have the stamina to run the full route. She therefore wants to know how long certain sub-routes take to run, where a sub-route is a contiguous subsequence of the checkpoints from the full route.  To make matters more complicated, Bessie knows that the other cows, being lazy, might choose to skip one checkpoint any time they run a sub-route -- whichever one results in a minimum total travel time.  They are not allowed to skip the first or last checkpoints in a sub-route, however.\n\n \nIn order to build the best possible marathon course, Bessie wants to investigate the ramifications of making changes to the checkpoint locations in her current course.  Please help her determine how certain changes to checkpoint locations will affect the time required to run different sub-routes (taking into account that the cows might choose to omit one checkpoint any time they run a sub-route).\n\n \nSince the course is set in a downtown area with a grid of streets, the distance between two checkpoints at locations (x1, y1) and (x2, y2) is given by |x1-x2| + |y1-y2|. ", "inputFormat": "\nINPUT: (file marathon.in) \n\nThe first line gives N and Q (1 <= Q <= 100,000). \n\nThe next N lines contain (x, y) locations of N checkpoints in the \n\nsequence they must be visited along the route.  All coordinates are in the range -1000 .. 1000.\n\n\nThe next Q lines consist of updates and queries, one per line, to be processed in the order they are given. Lines will either take the form \"U I X Y\" or \"Q I J\".  A line of the form \"U I X Y\" indicates that the location of checkpoint I (1 <= I <= N) is to be changed to location (X, Y).  A line of the form \"Q I J\" asks for the minimum travel time of the sub-route from checkpoint I to checkpoint J (I <= J), given that the cows choose to skip one checkpoint along this sub-route (but not the endpoints I and J).\n\n", "outputFormat": " \nOUTPUT: (file marathon.out) \n\nFor each sub-route length request, output on a single line the desired length. \n\n", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO14DEC] Marathon G", "background": "", "description": "贝茜自己是一名狂热的马拉松跑者，她喜欢为她的牛朋友们设计马拉松路线。最近，她设计了一条由 $N$ 个检查点组成的路线，这些检查点必须按顺序访问。\n\n不幸的是，贝茜意识到其他牛可能没有足够的耐力跑完整条路线。因此，她想知道某些子路线需要多长时间，其中子路线是完整路线中连续的一段。更复杂的是，贝茜知道其他牛可能会因为懒惰而选择在跑子路线时跳过一个检查点——无论哪个检查点能使总旅行时间最短。然而，他们不允许跳过子路线的第一个或最后一个检查点。\n\n为了构建最佳的马拉松路线，贝茜想研究对当前路线中的检查点位置进行更改的影响。请帮助她确定对检查点位置的某些更改将如何影响跑不同子路线所需的时间（考虑到牛可能会在跑子路线时选择省略一个检查点）。\n\n由于路线设置在市中心的街道网格中，位于 $(x_1,y_1)$ 和 $(x_2,y_2)$ 的两个检查点之间的距离由 $\\lvert x_1-x_2\\rvert+\\lvert y_1-y_2\\rvert$ 给出。", "inputFormat": "第一行给出 $N$ 和 $Q$。\n\n接下来的 $N$ 行包含 $N$ 个检查点的 $(x,y)$ 位置，按照路线中必须访问的顺序给出。所有坐标的范围为 $-1000$ 到 $1000$。\n\n接下来的 $Q$ 行由更新和查询组成，每行一个操作，按给定顺序处理。这些行的形式要么是 `U I X Y`，要么是 `Q I J`。  \n形式为 `U I X Y` 的行表示检查点 $I$ 的位置要更改为 $(X,Y)$。  \n形式为 `Q I J` 的行要求输出从检查点 $I$ 到检查点 $J$ 的子路线的最短旅行时间，前提是牛选择在此子路线中跳过一个检查点（但不能是端点 $I$ 和 $J$）。", "outputFormat": "对于每个子路线长度请求，在单独一行输出所需的长度。", "hint": "对于 $100\\%$ 的数据，$1\\le N, Q\\le10^5,1\\le I\\le N$。  \n（本题由 ChatGPT 4o 翻译）", "locale": "zh-CN"}}}
{"pid": "P3114", "type": "P", "difficulty": 5, "samples": [["3 \n-2 1 3 \n-3 2 3 \n-5 100 1 \n", "2 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "线段树", "USACO", "离散化"], "title": "[USACO15JAN] Stampede S", "background": "", "description": "Farmer John's N cows (1 <= N <= 50,000) appear to be stampeding along the road at the front of FJ's farm, but they are actually just running in a foot race to see which cow is the fastest.\n\nViewed from above, each cow is represented by a unit-length horizontal line segment, specified by the coordinates of its left corner point at time t=0.  For example, (-3,6) would specify a cow who at time t=0 is represented by the segment from (-3,6) to (-2,6).  Each cow is moving to the right (in the +x direction) at a certain rate, specified by the integer amount of time it takes her to move 1 unit to the right.\n\nFJ is not particularly thrilled that his cows are outside running instead of in the barn producing milk.  He plans to admonish them with a stern lecture after the race ends.  In order to determine which of his cows are participating in the race, FJ situates himself at (0,0) and looks along a ray extending in the +y direction.  As the race unfolds, FJ sees a cow if she is ever the first cow visible along this ray.  That is, a cow might not be visible if another cow is \"in front\" of her during the entire time she crosses FJ's line of sight.\n\nPlease compute the number of cows FJ can see during the entire race.", "inputFormat": "INPUT:\n\nThe first line of the input contains N.  Each of the following N lines describes a cow with three integers x y r, corresponding to a cow whose left endpoint is at (x,y) at time t=0, moving to the right at a continuous speed of 1 unit of distance every r units of time.  The value of x is in the range -1000..-1, the value of y is in the range 1..1,000,000 (and distinct for every cow, to prevent any possible collisions), and the value of r is in the range 1..1,000,000. ", "outputFormat": "OUTPUT:\n\nA single integer, specifying the number of cows FJ can see during the entire race (from t=0 onward). \n\n", "hint": "SOLUTION NOTES:\n\nFJ can see cows 1 and 2 but not cow 3.\n\n", "locale": "en", "translations": {"en": {"title": "[USACO15JAN] Stampede S", "background": "", "description": "Farmer John's N cows (1 <= N <= 50,000) appear to be stampeding along the road at the front of FJ's farm, but they are actually just running in a foot race to see which cow is the fastest.\n\nViewed from above, each cow is represented by a unit-length horizontal line segment, specified by the coordinates of its left corner point at time t=0.  For example, (-3,6) would specify a cow who at time t=0 is represented by the segment from (-3,6) to (-2,6).  Each cow is moving to the right (in the +x direction) at a certain rate, specified by the integer amount of time it takes her to move 1 unit to the right.\n\nFJ is not particularly thrilled that his cows are outside running instead of in the barn producing milk.  He plans to admonish them with a stern lecture after the race ends.  In order to determine which of his cows are participating in the race, FJ situates himself at (0,0) and looks along a ray extending in the +y direction.  As the race unfolds, FJ sees a cow if she is ever the first cow visible along this ray.  That is, a cow might not be visible if another cow is \"in front\" of her during the entire time she crosses FJ's line of sight.\n\nPlease compute the number of cows FJ can see during the entire race.", "inputFormat": "INPUT:\n\nThe first line of the input contains N.  Each of the following N lines describes a cow with three integers x y r, corresponding to a cow whose left endpoint is at (x,y) at time t=0, moving to the right at a continuous speed of 1 unit of distance every r units of time.  The value of x is in the range -1000..-1, the value of y is in the range 1..1,000,000 (and distinct for every cow, to prevent any possible collisions), and the value of r is in the range 1..1,000,000. ", "outputFormat": "OUTPUT:\n\nA single integer, specifying the number of cows FJ can see during the entire race (from t=0 onward). \n\n", "hint": "SOLUTION NOTES:\n\nFJ can see cows 1 and 2 but not cow 3.\n\n", "locale": "en"}, "zh-CN": {"title": "[USACO15JAN] Stampede S", "background": "", "description": "FJ 的 $N$ 头奶牛（$1 \\leq N \\leq 50,000$）看似在农场前的路上狂奔，实际上它们正在进行一场赛跑。\n\n从上方俯视，每头牛在时间 $t = 0$ 时被表示为一个单位长度的水平线段，其左端点坐标为 $(x, y)$。例如，$(-3, 6)$ 表示一头在 $t = 0$ 时从 $(-3, 6)$ 延伸到 $(-2, 6)$ 的奶牛。每头牛以一定速度向右（$+x$ 方向）移动，该速度由移动 1 单位距离所需的整数时间 $r$ 描述。\n\nFJ 并不满意他的奶牛在外赛跑而不在牛棚产奶。他计划在比赛结束后训斥参赛的奶牛。为了确定哪些奶牛参赛，FJ 站在 $(0, 0)$ 处并沿 $+y$ 方向的射线观察。当一头牛在某个时刻成为这条射线上首个可见的牛时，FJ 就会看到它。如果一头牛在穿过 FJ 视线期间始终被其他牛\"挡住\"，则她不可见。\n\n请计算 FJ 在整个比赛过程中能看到的奶牛数量。", "inputFormat": "第一行包含 $N$。接下来 $N$ 行每行描述一头牛，包含三个整数 $x$ $y$ $r$，分别表示：左端点初始坐标为 $(x, y)$，以每移动 1 单位距离需要 $r$ 单位时间的速度向右移动。$x$ 的取值范围为 $-1000$ 到 $-1$，$y$ 的取值范围为 $1$ 到 $1,000,000$（所有牛的 $y$ 值互不相同以避免碰撞），$r$ 的取值范围为 $1$ 到 $1,000,000$。", "outputFormat": "一个整数，表示 FJ 能看到的奶牛数量。", "hint": "FJ 可以看到牛 1 和 2，但看不到牛 3。", "locale": "zh-CN"}}}
{"pid": "P3115", "type": "P", "difficulty": 5, "samples": [["3 4 3 \n3 5 \n1 2 3 4 5 \n2 3 \n3 5 4 \n1 2 \n1 5 \n", "2 2 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "USACO", "最短路"], "title": "[USACO15JAN] Cow Routing S", "background": "", "description": "Tired of the cold winter weather on her farm, Bessie the cow plans to fly to a warmer destination for vacation. Unfortunately, she discovers that only one airline, Air Bovinia, is willing to sell tickets to cows, and that these tickets are somewhat complicated in structure.\n\nAir Bovinia owns N planes (1 <= N <= 1000), each of which flies on a specific \"route\" consisting of two or more cities.  For example, one plane might fly on a route that starts at city 1, then flies to city 5, then flies to city 2, and then finally flies to city 8. No city appears multiple times in a route. If Bessie chooses to utilize a route, she can board at any city along the route and then disembark at any city later along the route. She does not need to board at the first city or disembark at the last city. Each route has a certain cost, which Bessie must pay if she uses any part of the route, irrespective of the number of cities she visits along the route. If Bessie uses a route multiple times during her travel (that is, if she leaves the route and later comes back to use it from antoher city), she must pay for it each time it is used.\n\nBessie would like to find the cheapest way to travel from her farm (in city A) to her tropical destination (city B). Please help her decide what is the minimum cost she must pay, and also the smallest number of individual flights she must use take to achieve this minimum cost.\n", "inputFormat": "The first line of input contains A, B, and N, separated by spaces.\n\nThe next 2N lines describe the available routes, in two lines per route. The first line contains the cost of using the route (an integer in the range 1..1,000,000,000), and the number of cities along the route (an integer in the range 1..100).  The second line contains a list of the cities in order along the route.  Each city is identified by an integer in the range 1..1000. Note that the cost of an itinerary can easily add up to more than can fit into a 32-bit integer, so you should probably use 64-bit integers (e.g., \"long long\" integers in C/C++).\n", "outputFormat": "Output the minimum cost of an itinerary that Bessie can use to travel from city A to city B, as well as the minimum number of individual flights required to achieve this minimum cost. If there is no solution, output \"-1 -1\" (quotes for clarity) on a single line.\n", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO15JAN] Cow Routing S", "background": "", "description": "Tired of the cold winter weather on her farm, Bessie the cow plans to fly to a warmer destination for vacation. Unfortunately, she discovers that only one airline, Air Bovinia, is willing to sell tickets to cows, and that these tickets are somewhat complicated in structure.\n\nAir Bovinia owns N planes (1 <= N <= 1000), each of which flies on a specific \"route\" consisting of two or more cities.  For example, one plane might fly on a route that starts at city 1, then flies to city 5, then flies to city 2, and then finally flies to city 8. No city appears multiple times in a route. If Bessie chooses to utilize a route, she can board at any city along the route and then disembark at any city later along the route. She does not need to board at the first city or disembark at the last city. Each route has a certain cost, which Bessie must pay if she uses any part of the route, irrespective of the number of cities she visits along the route. If Bessie uses a route multiple times during her travel (that is, if she leaves the route and later comes back to use it from antoher city), she must pay for it each time it is used.\n\nBessie would like to find the cheapest way to travel from her farm (in city A) to her tropical destination (city B). Please help her decide what is the minimum cost she must pay, and also the smallest number of individual flights she must use take to achieve this minimum cost.\n", "inputFormat": "The first line of input contains A, B, and N, separated by spaces.\n\nThe next 2N lines describe the available routes, in two lines per route. The first line contains the cost of using the route (an integer in the range 1..1,000,000,000), and the number of cities along the route (an integer in the range 1..100).  The second line contains a list of the cities in order along the route.  Each city is identified by an integer in the range 1..1000. Note that the cost of an itinerary can easily add up to more than can fit into a 32-bit integer, so you should probably use 64-bit integers (e.g., \"long long\" integers in C/C++).\n", "outputFormat": "Output the minimum cost of an itinerary that Bessie can use to travel from city A to city B, as well as the minimum number of individual flights required to achieve this minimum cost. If there is no solution, output \"-1 -1\" (quotes for clarity) on a single line.\n", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO15JAN] Cow Routing S", "background": "", "description": "Bessie 对她农场那寒冷的天气感到厌烦，于是她准备坐飞机到一个更温暖的地方度假。不幸的是，她发现只有一个航空公司：Air Bovinia，愿意卖票给牛，并且这些票的结构有些复杂。\n\nAir Bovinia 拥有 $n$ 架飞机，每架飞机都有一个经过两个及以上的城市的特殊航线。举个例子：一架飞机可以从城市 $1$ 出发，然后飞往城市 $5$，再飞到城市 $2$，最后飞到城市 $8$。注意**航线是单向的**。任何城市都不会在同一条航线上出现多次。如果 Bessie 选择了一条航线，那么她可以从航线上的任意一个城市上飞机，然后在途中任意一个城市下飞机。他不必从航线的起点上飞机，再从航线的终点下飞机。每条航线都有一个确定的花费，只要它搭乘了这个航班，她就必须支付这个航班的全额花费，不论她途经了几个城市。如果 Bessie 多次搭乘了某个航班，那么每次搭乘 Bessie 都必须支付航班的花费。\n\nBessie 想要找到从她农场所在的城市（城市 $A$）到她目的地所在城市（城市 $B$）最便宜的路线。请你告诉她他最少要花多少钱，并告诉她在此基础上她最少要**经过几段航线**，也即经过的城市数量 $-1$（包括起点和终点）。", "inputFormat": "第一行三个整数 $A,B,n$。\n\n接下来 $2n$ 行，每两行描述一次航班。第一行包括航线的花费 $cost$ 与经过的城市数 $len$。第二行 $len$ 个整数，表示航班依次经过的城市。", "outputFormat": "一行两个整数，输出 Bessie 旅行最少要花的钱以及在此基础上最少的经过航线数量。\n\n如果 Bessie 不能从她的农场到达她的目的地，则输出 `-1 -1`。", "hint": "$1\\le n\\le 1000$，$1\\le cost\\le 10^9$，$1\\le len\\le 100$。城市的编号均不超过 $1000$。\n\n可能需要开 `long long`。", "locale": "zh-CN"}}}
{"pid": "P3116", "type": "P", "difficulty": 4, "samples": [["3 3 \n1 3 1 2 \n1 2 1 2 \n2 3 1 2 \n", "2 "]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2015", "USACO", "拓扑排序"], "title": "[USACO15JAN] Meeting Time S", "background": "", "description": "Bessie and her sister Elsie want to travel from the barn to their favorite field, such that they leave at exactly the same time from the barn, and also arrive at exactly the same time at their favorite field.\n\nThe farm is a collection of N fields (1 <= N <= 100) numbered 1..N, where field 1 contains the barn and field N is the favorite field. The farm is built on the side of a hill, with field X being higher in elevation than field Y if X < Y.  An assortment of M paths connect pairs of fields.  However, since each path is rather steep, it can only be followed in a downhill direction. For example, a path connecting field 5 with field 8 could be followed in the 5 -> 8 direction but not the other way, since this would be uphill.  Each pair of fields is connected by at most one path, so M <= N(N-1)/2.\n\nIt might take Bessie and Elsie different amounts of time to follow a path; for example, Bessie might take 10 units of time, and Elsie 20. Moreover, Bessie and Elsie only consume time when traveling on paths between fields -- since they are in a hurry, they always travel through a field in essentially zero time, never waiting around anywhere.\n\nPlease help determine the shortest amount of time Bessie and Elsie must take in order to reach their favorite field at exactly the same moment.\n", "inputFormat": "The first input line contains N and M, separated by a space.\n\nEach of the following M lines describes a path using four integers A B C D, where A and B (with A < B) are the fields connected by the path, C is the time required for Bessie to follow the path, and D is the time required for Elsie to follow the path.  Both C and D are in the range 1..100.\n", "outputFormat": "A single integer, giving the minimum time required for Bessie and Elsie to travel to their favorite field and arrive at the same moment.\n\nIf this is impossible, or if there is no way for Bessie or Elsie to reach the favorite field at all, output the word IMPOSSIBLE on a single line.\n", "hint": "SOLUTION NOTES:\n\nBessie is twice as fast as Elsie on each path, but if Bessie takes the path 1->2->3 and Elsie takes the path 1->3 they will arrive at the same time.\n\n", "locale": "en", "translations": {"en": {"title": "[USACO15JAN] Meeting Time S", "background": "", "description": "Bessie and her sister Elsie want to travel from the barn to their favorite field, such that they leave at exactly the same time from the barn, and also arrive at exactly the same time at their favorite field.\n\nThe farm is a collection of N fields (1 <= N <= 100) numbered 1..N, where field 1 contains the barn and field N is the favorite field. The farm is built on the side of a hill, with field X being higher in elevation than field Y if X < Y.  An assortment of M paths connect pairs of fields.  However, since each path is rather steep, it can only be followed in a downhill direction. For example, a path connecting field 5 with field 8 could be followed in the 5 -> 8 direction but not the other way, since this would be uphill.  Each pair of fields is connected by at most one path, so M <= N(N-1)/2.\n\nIt might take Bessie and Elsie different amounts of time to follow a path; for example, Bessie might take 10 units of time, and Elsie 20. Moreover, Bessie and Elsie only consume time when traveling on paths between fields -- since they are in a hurry, they always travel through a field in essentially zero time, never waiting around anywhere.\n\nPlease help determine the shortest amount of time Bessie and Elsie must take in order to reach their favorite field at exactly the same moment.\n", "inputFormat": "The first input line contains N and M, separated by a space.\n\nEach of the following M lines describes a path using four integers A B C D, where A and B (with A < B) are the fields connected by the path, C is the time required for Bessie to follow the path, and D is the time required for Elsie to follow the path.  Both C and D are in the range 1..100.\n", "outputFormat": "A single integer, giving the minimum time required for Bessie and Elsie to travel to their favorite field and arrive at the same moment.\n\nIf this is impossible, or if there is no way for Bessie or Elsie to reach the favorite field at all, output the word IMPOSSIBLE on a single line.\n", "hint": "SOLUTION NOTES:\n\nBessie is twice as fast as Elsie on each path, but if Bessie takes the path 1->2->3 and Elsie takes the path 1->3 they will arrive at the same time.\n\n", "locale": "en"}, "zh-CN": {"title": "[USACO15JAN] Meeting Time S", "background": null, "description": "$\\texttt{Bessie}$ 和她的妹妹 $\\texttt{Elsie}$ 想从粮仓去她们最喜欢的田地，也就是能够使她们一起从粮仓离开，并且能同一时间到达的田地。\n\n这个农场是由 $N$ 块 $(1\\leq N\\leq 100)$ 编号为 $1\\cdots N$ 的田地构成的，第一块田地就是粮仓，并且第 $N$ 块田地是她们最喜欢的田地。\n\n这个农场建在山的一边，所以，如果 $X < Y$ 的话则满足第 $X$ 块田地的高度要高于第 $Y$ 块田地的高度。在这之中，有 $M$ 条交错纵横的路径将不同的田地连接起来。\n\n不过，显而易见的是，因为每条路都太陡了，所以这些小路只能沿着从高到低的方向走。例如，一条连接第 $5$ 块田地和 $8$ 块田地的小路只能沿着 $5\\to 8$ 的方向走，而不能沿着其他方向，因为那样会成为上坡路。每两块田地最多只能有一条路径相连接，所以只算有效路径的话，一定有 $M \\leq \\dfrac{N(N-1)}{2}$。\n\n有可能的是，$\\texttt{Bessie}$ 和 $\\texttt{Elsie}$ 两个人走同一条小路会耗费不同的时间；比如，通过同一条小路，$\\texttt{Bessie}$ 可能会耗费 $10$ 个单位的时间，而 $\\texttt{Elsie}$ 会耗费 $20$ 个单位的时间。\n\n此外，$\\texttt{Bessie}$ 和 $\\texttt{Elsie}$ 只会在通过连接两块田地的小路时耗费时间——因为她们太匆忙了，在穿过田地时不会耗费任何时间，也从来不在任何地方停下来等待。\n\n现在，请你判断出，能够满足使 $\\texttt{Bessie}$ 和 $\\texttt{Elsie}$ 同时出发并且同时到达她们喜欢的田地的最短的时间。", "inputFormat": "第一行输入 $N$ 和 $M$，中间用空格分开。\n\n接下来的 $M$ 行，每行有四个整数 $A,B,C,D$，其中，$A$ 和$B$ 代表着两块用这条小路连接的田地，$C$ 代表 $\\texttt{Bessie}$ 通过这条小路的时间，而 $D$ 代表 $\\texttt{Elsie}$ 通过这条小路的时间。$C$ 和 $D$ 均在 $1\\cdots100$ 的范围之内。", "outputFormat": "一个整数，输出的是能够使两人同时出发并且同时到达目的地的最短时间，如果没有满足条件的答案，则输出 `IMPOSSIBLE`。", "hint": "$\\texttt{Bessie}$ 在每一条路都比 $\\texttt{Elsie}$ 快两倍。\n\n如果 $\\texttt{Bessie}$ 经过 $1\\to 2\\to 3$ 的路线，$\\texttt{Elsie}$ 经过 $1\\to 3$ 的路线，他们可以同时到达。", "locale": "zh-CN"}}}
{"pid": "P3117", "type": "P", "difficulty": 5, "samples": [["5 \n1 1 H \n2 2 H \n3 3 G \n4 4 H \n6 6 H \n", "2 \n1 "]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "USACO", "单调队列", "离散化", "前缀和", "扫描线"], "title": "[USACO15JAN] Cow Rectangles G", "background": "", "description": "The locations of Farmer John's N cows (1 <= N <= 500) are described by distinct points in the 2D plane.  The cows belong to two different breeds: Holsteins and Guernseys.  Farmer John wants to build a rectangular fence with sides parallel to the coordinate axes enclosing only Holsteins, with no Guernseys (a cow counts as enclosed even if it is on the boundary of the fence).  Among all such fences, Farmer John wants to build a fence enclosing the maximum number of Holsteins.  And among all these fences, Farmer John wants to build a fence of minimum possible area.  Please determine this area.  A fence of zero width or height is allowable.\n", "inputFormat": "The first line of input contains N.  Each of the next N lines describes a cow, and contains two integers and a character. The integers indicate a point (x,y) (0 <= x, y <= 1000) at which the cow is located. The character is H or G, indicating the cow's breed.  No two cows are located at the same point, and there is always at least one Holstein.\n", "outputFormat": "Print two integers. The first line should contain the maximum number of Holsteins that can be enclosed by a fence containing no Guernseys, and second line should contain the minimum area enclosed by such a fence.", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO15JAN] Cow Rectangles G", "background": "", "description": "The locations of Farmer John's N cows (1 <= N <= 500) are described by distinct points in the 2D plane.  The cows belong to two different breeds: Holsteins and Guernseys.  Farmer John wants to build a rectangular fence with sides parallel to the coordinate axes enclosing only Holsteins, with no Guernseys (a cow counts as enclosed even if it is on the boundary of the fence).  Among all such fences, Farmer John wants to build a fence enclosing the maximum number of Holsteins.  And among all these fences, Farmer John wants to build a fence of minimum possible area.  Please determine this area.  A fence of zero width or height is allowable.\n", "inputFormat": "The first line of input contains N.  Each of the next N lines describes a cow, and contains two integers and a character. The integers indicate a point (x,y) (0 <= x, y <= 1000) at which the cow is located. The character is H or G, indicating the cow's breed.  No two cows are located at the same point, and there is always at least one Holstein.\n", "outputFormat": "Print two integers. The first line should contain the maximum number of Holsteins that can be enclosed by a fence containing no Guernseys, and second line should contain the minimum area enclosed by such a fence.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO15JAN] Cow Rectangles G", "background": "", "description": "农夫约翰的 $N$ 头牛（$1 \\leq N \\leq 500$）的位置由二维平面上互不相同的点描述。这些牛分为两个品种：Holsteins 和 Guernseys。农夫约翰希望建造一个边与坐标轴平行的矩形围栏，仅包含 Holsteins 且不包含任何 Guernseys（即使牛位于围栏边界上也视为被包含）。在所有满足条件的围栏中，农夫约翰希望选择包含最多 Holsteins 的围栏。若存在多个这样的围栏，则选择其中面积最小的一个。请确定这个面积。允许围栏的宽度或高度为零。", "inputFormat": "第一行输入包含 $N$。接下来的 $N$ 行每行描述一头牛，包含两个整数和一个字符。整数表示牛所在点的坐标 $(x, y)$（$0 \\leq x, y \\leq 1000$），字符为 H 或 G 表示牛的品种。没有两头牛位于同一位置，且至少存在一头 Holstein。", "outputFormat": "输出两个整数。第一行应包含不包含任何 Guernseys 的围栏能包围的最大 Holsteins 数量，第二行应包含满足该条件的围栏的最小面积。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3118", "type": "P", "difficulty": 5, "samples": [["4 100 \n50 3 15 30 55 \n40 2 0 65 \n30 2 20 90 \n20 1 0 \n", "3 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "USACO", "O2优化", "状压 DP"], "title": "[USACO15JAN] Moovie Mooving G", "background": null, "description": "Bessie is out at the movies.  Being mischievous as always, she has decided to hide from Farmer John for $L$ ($1 \\le L \\le 10^8$) minutes, during which time she wants to watch movies continuously. She has $N$ ($1 \\le N \\le 20$) movies to choose from, each of which has a certain duration and a set of showtimes during the day.  Bessie may enter and exit a movie at any time during one if its showtimes, but she does not want to ever visit the same movie twice, and she cannot switch to another showtime of the same movie that overlaps the current showtime.\n\nHelp Bessie by determining if it is possible for her to achieve her goal of watching movies continuously from time $0$ through time $L$.  If it is, determine the minimum number of movies she needs to see to achieve this goal (Bessie gets confused with plot lines if she watches too many movies).", "inputFormat": "The first line of input contains $N$ and $L$.\n\nThe next $N$ lines each describe a movie.  They begin with its integer duration, $D$ ($1 \\le D \\le L$) and the number of showtimes, $C$ ($1 \\le C \\le 1000$).  The remaining $C$ integers on the same line are each in the range $0 \\dots L$, and give the starting time of one of the showings of the movie.  Showtimes are distinct, in the range $0 \\dots L$, and given in increasing order.", "outputFormat": "A single integer indicating the minimum number of movies that Bessie needs to see to achieve her goal. If this is impossible output $-1$ instead.", "hint": "Bessie should attend the first showing of the fourth movie from time $0$ to time $20$.  Then she watches the first showing of the first movie from time $20$ to time $65$.  Finally she watches the last showing of the second movie from time $65$ to time $100$.", "locale": "en", "translations": {"en": {"title": "[USACO15JAN] Moovie Mooving G", "background": null, "description": "Bessie is out at the movies.  Being mischievous as always, she has decided to hide from Farmer John for $L$ ($1 \\le L \\le 10^8$) minutes, during which time she wants to watch movies continuously. She has $N$ ($1 \\le N \\le 20$) movies to choose from, each of which has a certain duration and a set of showtimes during the day.  Bessie may enter and exit a movie at any time during one if its showtimes, but she does not want to ever visit the same movie twice, and she cannot switch to another showtime of the same movie that overlaps the current showtime.\n\nHelp Bessie by determining if it is possible for her to achieve her goal of watching movies continuously from time $0$ through time $L$.  If it is, determine the minimum number of movies she needs to see to achieve this goal (Bessie gets confused with plot lines if she watches too many movies).", "inputFormat": "The first line of input contains $N$ and $L$.\n\nThe next $N$ lines each describe a movie.  They begin with its integer duration, $D$ ($1 \\le D \\le L$) and the number of showtimes, $C$ ($1 \\le C \\le 1000$).  The remaining $C$ integers on the same line are each in the range $0 \\dots L$, and give the starting time of one of the showings of the movie.  Showtimes are distinct, in the range $0 \\dots L$, and given in increasing order.", "outputFormat": "A single integer indicating the minimum number of movies that Bessie needs to see to achieve her goal. If this is impossible output $-1$ instead.", "hint": "Bessie should attend the first showing of the fourth movie from time $0$ to time $20$.  Then she watches the first showing of the first movie from time $20$ to time $65$.  Finally she watches the last showing of the second movie from time $65$ to time $100$.", "locale": "en"}, "zh-CN": {"title": "[USACO15JAN] Moovie Mooving G", "background": "", "description": "Bessie 正在外看电影。调皮的她想在 $L$（$1 \\leq L \\leq 100,000,000$）分钟内连续观看电影来躲避农夫 John。她有 $N$（$1 \\leq N \\leq 20$）部电影可选，每部电影有特定时长和多个放映场次。Bessie 可以在电影放映期间的任意时刻入场或离场，但不能重复观看同一部电影，也不能切换到同一部电影时间重叠的场次。\n\n请判断 Bessie 是否能从时间 $0$ 到时间 $L$ 连续观看电影。若可行，求出达成目标所需观看的最小电影数量（过多电影会让 Bessie 混淆剧情）。", "inputFormat": "第一行输入包含 $N$ 和 $L$。\n\n接下来 $N$ 行描述每部电影：每行以整数时长 $D$（$1 \\leq D \\leq L$）和场次数 $C$（$1 \\leq C \\leq 1000$）开头，随后给出 $C$ 个按升序排列的场次开始时间（范围 $0$ 至 $L$，且互不重复）。", "outputFormat": "输出达成目标所需的最小电影数量。若不可能则输出 $-1$。", "hint": "Bessie 可以观看第四部电影的首场（时间 $0$ 至 $20$），接着观看第一部电影的首场（时间 $20$ 至 $65$），最后观看第二部电影的末场（时间 $65$ 至 $100$）。", "locale": "zh-CN"}}}
{"pid": "P3119", "type": "P", "difficulty": 5, "samples": [["7 10 \n1 2 \n3 1 \n2 5 \n2 4 \n3 7 \n3 5 \n3 6 \n6 5 \n7 2 \n4 7 \n\n", "6 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2015", "USACO", "拓扑排序", "强连通分量", "Tarjan"], "title": "[USACO15JAN] Grass Cownoisseur G", "background": "", "description": "In an effort to better manage the grazing patterns of his cows, Farmer John has installed one-way cow paths all over his farm. The farm consists of N fields, conveniently numbered 1..N, with each one-way cow path connecting a pair of fields. For example, if a path connects from field X to field Y, then cows are allowed to travel from X to Y but not from Y to X.\n\nBessie the cow, as we all know, enjoys eating grass from as many fields as possible. She always starts in field 1 at the beginning of the day and visits a sequence of fields, returning to field 1 at the end of the day. She tries to maximize the number of distinct fields along her route, since she gets to eat the grass in each one (if she visits a field multiple times, she only eats the grass there once).\n\nAs one might imagine, Bessie is not particularly happy about the one-way restriction on FJ's paths, since this will likely reduce the number of distinct fields she can possibly visit along her daily route.  She wonders how much grass she will be able to eat if she breaks the rules and follows up to one path in the wrong direction. Please compute the maximum number of distinct fields she can visit along a route starting and ending at field 1, where she can follow up to one path along the route in the wrong direction.  Bessie can only travel backwards at most once in her journey.  In particular, she cannot even take the same path backwards twice.", "inputFormat": "The first line of input contains N and M, giving the number of fields and the number of one-way paths (1 <= N, M <= 100,000). \n\nThe following M lines each describe a one-way cow path.  Each line contains two distinct field numbers X and Y, corresponding to a cow path from X to Y.  The same cow path will never appear more than once.", "outputFormat": "A single line indicating the maximum number of distinct fields Bessie can visit along a route starting and ending at field 1, given that she can follow at most one path along this route in the wrong direction.", "hint": "SOLUTION NOTES:\n\nHere is an ASCII drawing of the sample input:\n\n```cpp\nv---3-->6\n7   | \\ |\n^\\  v  \\|\n| \\ 1   |\n|   |   v\n|   v   5\n4<--2---^\n```\n\nBessie can visit pastures 1, 2, 4, 7, 2, 5, 3, 1 by traveling backwards on the path between 5 and 3.  When she arrives at 3 she cannot reach 6 without following another backwards path.", "locale": "en", "translations": {"en": {"title": "[USACO15JAN] Grass Cownoisseur G", "background": "", "description": "In an effort to better manage the grazing patterns of his cows, Farmer John has installed one-way cow paths all over his farm. The farm consists of N fields, conveniently numbered 1..N, with each one-way cow path connecting a pair of fields. For example, if a path connects from field X to field Y, then cows are allowed to travel from X to Y but not from Y to X.\n\nBessie the cow, as we all know, enjoys eating grass from as many fields as possible. She always starts in field 1 at the beginning of the day and visits a sequence of fields, returning to field 1 at the end of the day. She tries to maximize the number of distinct fields along her route, since she gets to eat the grass in each one (if she visits a field multiple times, she only eats the grass there once).\n\nAs one might imagine, Bessie is not particularly happy about the one-way restriction on FJ's paths, since this will likely reduce the number of distinct fields she can possibly visit along her daily route.  She wonders how much grass she will be able to eat if she breaks the rules and follows up to one path in the wrong direction. Please compute the maximum number of distinct fields she can visit along a route starting and ending at field 1, where she can follow up to one path along the route in the wrong direction.  Bessie can only travel backwards at most once in her journey.  In particular, she cannot even take the same path backwards twice.", "inputFormat": "The first line of input contains N and M, giving the number of fields and the number of one-way paths (1 <= N, M <= 100,000). \n\nThe following M lines each describe a one-way cow path.  Each line contains two distinct field numbers X and Y, corresponding to a cow path from X to Y.  The same cow path will never appear more than once.", "outputFormat": "A single line indicating the maximum number of distinct fields Bessie can visit along a route starting and ending at field 1, given that she can follow at most one path along this route in the wrong direction.", "hint": "SOLUTION NOTES:\n\nHere is an ASCII drawing of the sample input:\n\n```cpp\nv---3-->6\n7   | \\ |\n^\\  v  \\|\n| \\ 1   |\n|   |   v\n|   v   5\n4<--2---^\n```\n\nBessie can visit pastures 1, 2, 4, 7, 2, 5, 3, 1 by traveling backwards on the path between 5 and 3.  When she arrives at 3 she cannot reach 6 without following another backwards path.", "locale": "en"}, "zh-CN": {"title": "[USACO15JAN] Grass Cownoisseur G", "background": "", "description": "为了更好地管理牛群的放牧路线，Farmer John 在他的农场中安装了若干单向牛道。农场由 $N$ 块草场组成，编号为 $1$ 到 $N$，每条单向牛道连接一对草场。例如，若存在一条从草场 $X$ 到 $Y$ 的路径，则牛可以从 $X$ 前往 $Y$，但不能从 $Y$ 返回 $X$。\n\n众所周知，Bessie 喜欢尽可能多地品尝不同草场的牧草。她每天从草场 $1$ 出发，访问一系列草场后返回草场 $1$。她试图最大化沿途经过的不同草场数量（重复访问的草场只算一次）。\n\n由于单向路径的限制，Bessie 担心这会减少她每日路线中可以访问的草场数量。她想知道如果她违反规则，在路线中最多逆向通过某条道路一次，最多能品尝多少草场的牧草。请计算她从草场 $1$ 出发并返回的情况下，最多能访问的不同草场数量。注意 Bessie 在整个旅程中最多只能逆向通过一条道路，且同一条路径不能逆向两次。", "inputFormat": "第一行包含两个整数 $N$ 和 $M$，表示草场数量和单向牛道数量（$1 \\leq N, M \\leq 100,000$）。\n\n接下来 $M$ 行每行描述一条单向牛道，包含两个不同的整数 $X$ 和 $Y$，表示从 $X$ 到 $Y$ 的单向路径。保证每条路径不会重复出现。", "outputFormat": "输出一行，表示 Bessie 在最多逆向通过一条道路的情况下，从草场 $1$ 出发并返回时能访问的最大不同草场数量。", "hint": "**样例解析：**\n\n以下是样例输入的 ASCII 图示：\n\n```\nv---3-->6\n7   | \\ |\n^\\  v  \\|\n| \\ 1   |\n|   |   v\n|   v   5\n4<--2---^\n```\n\nBessie 可以通过逆向路径 $5\\to 3$ 访问草场 $1, 2, 4, 7, 2, 5, 3, 1$。到达草场 $3$ 后，若不再次逆向其他路径则无法前往 $6$。", "locale": "zh-CN"}}}
{"pid": "P3120", "type": "P", "difficulty": 5, "samples": [["4 4 4 \n1 1 1 1 \n1 3 2 1 \n1 2 4 1 \n1 1 1 1 \n", "5 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2015", "线段树", "USACO", "cdq 分治", "前缀和"], "title": "[USACO15FEB] Cow Hopscotch G", "background": "", "description": "Just like humans enjoy playing the game of Hopscotch, Farmer John's cows have invented a variant of the game for themselves to play.  Being played by clumsy animals weighing nearly a ton, Cow Hopscotch almost always ends in disaster, but this has surprisingly not deterred the cows from attempting to play nearly every afternoon.\n\nThe game is played on an R by C grid (2 <= R <= 750, 2 <= C <= 750), where each square is labeled with an integer in the range 1..K (1 <= K <= R\\*C).  Cows start in the top-left square and move to the bottom-right square by a sequence of jumps, where a jump is valid if and only if\n\n1) You are jumping to a square labeled with a different integer than your current square,\n\n2) The square that you are jumping to is at least one row below the current square that you are on, and\n\n3) The square that you are jumping to is at least one column to the right of the current square that you are on.\n\nPlease help the cows compute the number of different possible sequences of valid jumps that will take them from the top-left square to the bottom-right square.", "inputFormat": "The first line contains the integers R, C, and K.\n\nThe next R lines will each contain C integers, each in the range 1..K.", "outputFormat": "Output the number of different ways one can jump from the top-left square to the bottom-right square, mod 1000000007.", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO15FEB] Cow Hopscotch G", "background": "", "description": "Just like humans enjoy playing the game of Hopscotch, Farmer John's cows have invented a variant of the game for themselves to play.  Being played by clumsy animals weighing nearly a ton, Cow Hopscotch almost always ends in disaster, but this has surprisingly not deterred the cows from attempting to play nearly every afternoon.\n\nThe game is played on an R by C grid (2 <= R <= 750, 2 <= C <= 750), where each square is labeled with an integer in the range 1..K (1 <= K <= R\\*C).  Cows start in the top-left square and move to the bottom-right square by a sequence of jumps, where a jump is valid if and only if\n\n1) You are jumping to a square labeled with a different integer than your current square,\n\n2) The square that you are jumping to is at least one row below the current square that you are on, and\n\n3) The square that you are jumping to is at least one column to the right of the current square that you are on.\n\nPlease help the cows compute the number of different possible sequences of valid jumps that will take them from the top-left square to the bottom-right square.", "inputFormat": "The first line contains the integers R, C, and K.\n\nThe next R lines will each contain C integers, each in the range 1..K.", "outputFormat": "Output the number of different ways one can jump from the top-left square to the bottom-right square, mod 1000000007.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO15FEB] Cow Hopscotch G", "background": "", "description": "与人类喜欢玩跳格子游戏类似，Farmer John 的奶牛们也发明了自己的游戏版本。尽管体重接近一吨的笨拙动物玩这个游戏几乎总会以灾难收场，但这意料之外地没有阻止奶牛们每天下午尝试玩耍的热情。\n\n游戏在一个 $R$ 行 $C$ 列的网格上进行（$2 \\leq R, C \\leq 750$），每个格子标有 $1$ 到 $K$ 的整数（$1 \\leq K \\leq R \\times C$）。奶牛从左上角的格子出发，通过一系列合法跳跃到达右下角的格子。一次跳跃被定义为合法当且仅当满足以下条件：\n\n1. 目标格子的标签数字与当前格子不同；\n2. 目标格子所在行至少比当前格子多一行；\n3. 目标格子所在列至少比当前格子多一列。\n\n请帮助奶牛计算从左上角到右下角的不同合法跳跃序列总数。", "inputFormat": "第一行包含三个整数 $R$, $C$, $K$。\n\n接下来 $R$ 行，每行包含 $C$ 个整数，表示网格的标签（范围 $1$ 到 $K$）。", "outputFormat": "输出从左上角到右下角的不同跳跃路径数量，结果对 $1000000007$ 取模。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3121", "type": "P", "difficulty": 5, "samples": [["begintheescapexecutionatthebreakofdawn \n2 \nescape \nexecution \n", "beginthatthebreakofdawn \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2015", "USACO", "哈希 hashing", "栈", "AC 自动机"], "title": "[USACO15FEB] Censoring G", "background": "", "description": "FJ 把杂志上所有的文章摘抄了下来并把它变成了一个长度不超过 $10^5$ 的字符串 $s$。他有一个包含 $n$ 个单词的列表，列表里的 $n$ 个单词记为 $t_1 \\cdots t_n$。他希望从 $s$ 中删除这些单词。\n\nFJ 每次在 $s$ 中找到最早出现的列表中的单词（最早出现指该单词的开始位置最小），然后从 $s$ 中删除这个单词。他重复这个操作直到 $s$ 中没有列表里的单词为止。注意删除一个单词后可能会导致 $s$ 中出现另一个列表中的单词。\n\nFJ 注意到列表中的单词不会出现一个单词是另一个单词子串的情况，这意味着每个列表中的单词在 $s$ 中出现的开始位置是互不相同的。\n\n请帮助 FJ 完成这些操作并输出最后的 $s$。", "inputFormat": "第一行是一个字符串，表示文章 $s$。\n\n第二行有一个整数，表示单词列表的单词个数 $n$。\n\n第 $3$ 到第 $(n + 2)$ 行，每行一个字符串，第 $(i + 2)$ 行的字符串 $t_i$ 表示第 $i$ 个单词。", "outputFormat": "输出一行一个字符串，表示操作结束后的 $s$。", "hint": "#### 数据规模与约定\n\n对于全部的测试点，保证：\n\n- $1 \\leq |s|, \\sum\\limits_{i = 1}^n |t_i|, n \\leq 10^5$。\n- 字符串均只含小写字母。\n- 操作结束后 $s$ 不会被删成空串。\n- 对于所有的 $i \\neq j$，$t_i$ 不是 $t_j$ 的子串。\n\n其中对于一个字符串 $x$，约定 $|x|$ 表示 $x$ 的长度。\n\n---\n\n#### 提示\n\n操作过程中 $s$ 有可能某一个前缀子串被完全删除，请格外注意这一点。\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO15FEB] Censoring G", "background": "", "description": "FJ copied all the articles from a magazine and turned them into a string $s$ of length at most $10^5$. He has a list of $n$ words, denoted by $t_1 \\cdots t_n$. He wants to delete these words from $s$.\n\nEach time, FJ finds in $s$ the earliest occurrence of any word from the list (the earliest occurrence means the smallest starting position), and then deletes that word from $s$. He repeats this operation until no listed word remains in $s$. Note that deleting a word may cause another listed word to appear in $s$.\n\nFJ noticed that within the list, no word is a substring of another, which implies that the starting positions of occurrences of listed words in $s$ are pairwise distinct.\n\nPlease help FJ perform these operations and output the final $s$.", "inputFormat": "The first line contains a string, the article $s$.\n\nThe second line contains an integer, the number of words in the list $n$.\n\nLines $3$ through $(n + 2)$ each contain a string; the string on line $(i + 2)$, $t_i$, denotes the $i$-th word.", "outputFormat": "Output a single line containing the string $s$ after all operations.", "hint": "#### Constraints\n\nFor all test points, it is guaranteed that:\n\n- $1 \\leq |s|, \\sum\\limits_{i = 1}^n |t_i|, n \\leq 10^5$.\n- All strings contain only lowercase letters.\n- After the operations finish, $s$ will not become an empty string.\n- For all $i \\neq j$, $t_i$ is not a substring of $t_j$.\n\nHere, for a string $x$, $|x|$ denotes its length.\n\n---\n\n#### Hint\n\nDuring the process, a prefix of $s$ may be completely deleted; pay special attention to this.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO15FEB] Censoring G", "background": "", "description": "FJ 把杂志上所有的文章摘抄了下来并把它变成了一个长度不超过 $10^5$ 的字符串 $s$。他有一个包含 $n$ 个单词的列表，列表里的 $n$ 个单词记为 $t_1 \\cdots t_n$。他希望从 $s$ 中删除这些单词。\n\nFJ 每次在 $s$ 中找到最早出现的列表中的单词（最早出现指该单词的开始位置最小），然后从 $s$ 中删除这个单词。他重复这个操作直到 $s$ 中没有列表里的单词为止。注意删除一个单词后可能会导致 $s$ 中出现另一个列表中的单词。\n\nFJ 注意到列表中的单词不会出现一个单词是另一个单词子串的情况，这意味着每个列表中的单词在 $s$ 中出现的开始位置是互不相同的。\n\n请帮助 FJ 完成这些操作并输出最后的 $s$。", "inputFormat": "第一行是一个字符串，表示文章 $s$。\n\n第二行有一个整数，表示单词列表的单词个数 $n$。\n\n第 $3$ 到第 $(n + 2)$ 行，每行一个字符串，第 $(i + 2)$ 行的字符串 $t_i$ 表示第 $i$ 个单词。", "outputFormat": "输出一行一个字符串，表示操作结束后的 $s$。", "hint": "#### 数据规模与约定\n\n对于全部的测试点，保证：\n\n- $1 \\leq |s|, \\sum\\limits_{i = 1}^n |t_i|, n \\leq 10^5$。\n- 字符串均只含小写字母。\n- 操作结束后 $s$ 不会被删成空串。\n- 对于所有的 $i \\neq j$，$t_i$ 不是 $t_j$ 的子串。\n\n其中对于一个字符串 $x$，约定 $|x|$ 表示 $x$ 的长度。\n\n---\n\n#### 提示\n\n操作过程中 $s$ 有可能某一个前缀子串被完全删除，请格外注意这一点。\n", "locale": "zh-CN"}}}
{"pid": "P3122", "type": "P", "difficulty": 6, "samples": [["3 4 \n0 0 \n0 1 \n1 0 \n2 2 2 3 \n1 1 1 \n2 2 2 3 \n2 0 1 1 \n", "YES \nNO \nNO \n\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["计算几何", "2015", "USACO", "cdq 分治", "凸包"], "title": "[USACO15FEB] Fencing the Herd G", "background": "", "description": "Farmer John 需要你帮助他决定在哪里建造形状是一条无限长的直线的栅栏来限制他的牛的活动。他选出了几个可能的建造栅栏的位置，你需要帮助他判断哪些栅栏是有用的。一个栅栏是有用的当且仅当所有奶牛都在栅栏的同一侧。（如果有牛群在栅栏所在的直线上，那么栅栏是没用的），Farmer John 将会多次询问你一个栅栏是否有用，如果这个栅栏是有用的，需要输出 `YES`，反之输出 `NO`。\n\n另外，Farmer John 也可能会带来一些新的奶牛加入这个牛群。一头牛加入之后，以后的所有询问中，这头牛也需要与其它的牛在栅栏的同一侧。\n", "inputFormat": "\n第一行，两个正整数 $n,q$，表示初始时牛群的数量与询问个数；\n\n后 $n$ 行，每行两个整数 $x,y$，表示一个牛群的初始位置；\n\n后 $q$ 行，每行多个整数，表示一次询问，询问的格式如下：\n\n- 1 $x$ $y$：表示一个新的牛群加入了牧场，驻留在 $(x,y)$ 上；\n- 2 $A$ $B$ $C$：表示 Farmer John 询问栅栏 $Ax+By=C$ 是否有用。", "outputFormat": "对于每个 $2$ 类型的询问，如果栅栏有用，输出 `YES`，否则输出 `NO`。\n", "hint": "直线 $2x+2y=3$ 使得初始的三个牛群都在同侧；然而在该栅栏另一侧的牛群 $(1,1)$ 的加入使得它没有用了。\n\n直线 $y=1$ 没用因为牛群 $(0,1)$，$(1,1)$ 恰好在它上面。\n\n---\n\n对于 $100\\%$ 的数据，保证 $1\\leq n\\leq 10^5$，$1\\leq q\\leq 10^5$，所有牛群的坐标都各不相同且满足 $-10^9\\leq x,y\\leq 10^9$，$-10^9\\leq A,B\\leq 10^9$，$-10^{18}\\leq C\\leq 10^{18}$。\n\n数据保证不存在栅栏满足 $A=B=0$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO15FEB] Fencing the Herd G", "background": "", "description": "Farmer John needs your help deciding where to build a fence shaped as an infinitely long straight line to restrict the movement of his cows. He has selected several candidate positions for building the fence, and you need to determine which fences are useful. A fence is useful if and only if all cows lie on the same side of the fence. If any cow lies exactly on the fence line, then the fence is useless. Farmer John will ask you multiple times whether a fence is useful; for each query, output YES if the fence is useful, otherwise output NO.\n\nAdditionally, Farmer John may bring in new cows to join the herd. After a cow joins, it must be considered in all subsequent queries and must also lie on the same side of the fence as the other cows.", "inputFormat": "The first line contains two positive integers $n, q$, the initial number of cows and the number of queries.\n\nThe next $n$ lines each contain two integers $x, y$, the initial positions of the cows.\n\nThe next $q$ lines each describe a query in one of the following formats:\n- 1 $x$ $y$: a new cow joins the pasture at $(x, y)$.\n- 2 $A$ $B$ $C$: Farmer John asks whether the fence $Ax + By = C$ is useful.", "outputFormat": "For each query of type $2$, output YES if the fence is useful, otherwise output NO.", "hint": "The line $2x + 2y = 3$ places all three initial cows on the same side; however, adding the cow $(1, 1)$ on the other side makes it useless.\n\nThe line $y = 1$ is useless because cows $(0, 1)$ and $(1, 1)$ lie exactly on it.\n\n---\n\nConstraints.\n\nFor $100\\%$ of the testdata, it is guaranteed that $1 \\leq n \\leq 10^5$, $1 \\leq q \\leq 10^5$, all cows have distinct coordinates and satisfy $-10^9 \\leq x, y \\leq 10^9$, $-10^9 \\leq A, B \\leq 10^9$, $-10^{18} \\leq C \\leq 10^{18}$.\n\nIt is guaranteed that there is no fence with $A = B = 0$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO15FEB] Fencing the Herd G", "background": "", "description": "Farmer John 需要你帮助他决定在哪里建造形状是一条无限长的直线的栅栏来限制他的牛的活动。他选出了几个可能的建造栅栏的位置，你需要帮助他判断哪些栅栏是有用的。一个栅栏是有用的当且仅当所有奶牛都在栅栏的同一侧。（如果有牛群在栅栏所在的直线上，那么栅栏是没用的），Farmer John 将会多次询问你一个栅栏是否有用，如果这个栅栏是有用的，需要输出 `YES`，反之输出 `NO`。\n\n另外，Farmer John 也可能会带来一些新的奶牛加入这个牛群。一头牛加入之后，以后的所有询问中，这头牛也需要与其它的牛在栅栏的同一侧。\n", "inputFormat": "\n第一行，两个正整数 $n,q$，表示初始时牛群的数量与询问个数；\n\n后 $n$ 行，每行两个整数 $x,y$，表示一个牛群的初始位置；\n\n后 $q$ 行，每行多个整数，表示一次询问，询问的格式如下：\n\n- 1 $x$ $y$：表示一个新的牛群加入了牧场，驻留在 $(x,y)$ 上；\n- 2 $A$ $B$ $C$：表示 Farmer John 询问栅栏 $Ax+By=C$ 是否有用。", "outputFormat": "对于每个 $2$ 类型的询问，如果栅栏有用，输出 `YES`，否则输出 `NO`。\n", "hint": "直线 $2x+2y=3$ 使得初始的三个牛群都在同侧；然而在该栅栏另一侧的牛群 $(1,1)$ 的加入使得它没有用了。\n\n直线 $y=1$ 没用因为牛群 $(0,1)$，$(1,1)$ 恰好在它上面。\n\n---\n\n对于 $100\\%$ 的数据，保证 $1\\leq n\\leq 10^5$，$1\\leq q\\leq 10^5$，所有牛群的坐标都各不相同且满足 $-10^9\\leq x,y\\leq 10^9$，$-10^9\\leq A,B\\leq 10^9$，$-10^{18}\\leq C\\leq 10^{18}$。\n\n数据保证不存在栅栏满足 $A=B=0$。", "locale": "zh-CN"}}}
{"pid": "P3123", "type": "P", "difficulty": 3, "samples": [["10\nB 2\nE 5\nS 7\nI 10\nO 16\nM 19\nB 3\nG 1\nI 9\nM 2", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2015", "USACO", "枚举"], "title": "[USACO15OPEN] Bessie Goes Moo S", "background": "", "description": "Farmer John and Bessie the cow love to exchange math puzzles in their free time.\n\nThe last puzzle FJ gave Bessie was quite difficult and she failed to solve it.\n\nNow she wants to get even with FJ by giving him a challenging puzzle.\n\nBessie gives FJ the expression $(B+E+S+S+I+E)(G+O+E+S)(M+O+O)$, containing the seven variables $B,E,S,I,G,O,M$ (the \"$O$\" is a variable, not a zero).  For each variable, she gives FJ a list of up to 500 integer values the variable can possibly take.\n\nShe asks FJ to count the number of different ways he can assign values to the variables so the entire expression evaluates to a multiple of 7.\n\nNote that the answer to this problem can be too large to fit into a 32-bit integer, so you probably want to use 64-bit integers (e.g., \"long long\"s in C or C++).", "inputFormat": "The first line of the input contains an integer $N$.  The next $N$ lines each contain a variable and a possible value for that variable.  \n\nEach variable will appear in this list at least once and at most 500 times. No possible value will be listed more than once for the same variable. All possible values will be in the range $-10^5$ to $10^5$.\n", "outputFormat": "Print a single integer, giving the number of ways FJ can assign values to variables so the expression above evaluates to a multiple of 7.\n", "hint": "The two possible assignments are\n\n\n(B,E,S,I,G,O,M) = (2, 5, 7, 9,  1, 16, 19) -> 51,765\n\n(B,E,S,I,G,O,B) = (2, 5, 7, 9,  1, 16, 2 ) -> 34,510\n", "locale": "en", "translations": {"en": {"title": "[USACO15OPEN] Bessie Goes Moo S", "background": "", "description": "Farmer John and Bessie the cow love to exchange math puzzles in their free time.\n\nThe last puzzle FJ gave Bessie was quite difficult and she failed to solve it.\n\nNow she wants to get even with FJ by giving him a challenging puzzle.\n\nBessie gives FJ the expression $(B+E+S+S+I+E)(G+O+E+S)(M+O+O)$, containing the seven variables $B,E,S,I,G,O,M$ (the \"$O$\" is a variable, not a zero).  For each variable, she gives FJ a list of up to 500 integer values the variable can possibly take.\n\nShe asks FJ to count the number of different ways he can assign values to the variables so the entire expression evaluates to a multiple of 7.\n\nNote that the answer to this problem can be too large to fit into a 32-bit integer, so you probably want to use 64-bit integers (e.g., \"long long\"s in C or C++).", "inputFormat": "The first line of the input contains an integer $N$.  The next $N$ lines each contain a variable and a possible value for that variable.  \n\nEach variable will appear in this list at least once and at most 500 times. No possible value will be listed more than once for the same variable. All possible values will be in the range $-10^5$ to $10^5$.\n", "outputFormat": "Print a single integer, giving the number of ways FJ can assign values to variables so the expression above evaluates to a multiple of 7.\n", "hint": "The two possible assignments are\n\n\n(B,E,S,I,G,O,M) = (2, 5, 7, 9,  1, 16, 19) -> 51,765\n\n(B,E,S,I,G,O,B) = (2, 5, 7, 9,  1, 16, 2 ) -> 34,510\n", "locale": "en"}, "zh-CN": {"title": "[USACO15OPEN] Bessie Goes Moo S", "background": null, "description": "Farmer John 和奶牛 Bessie 喜欢在空闲时间互相出数学谜题。\n\n上一次 FJ 给 Bessie 出的谜题非常难，她没能解出来。\n\n现在，她想通过给 FJ 出一个有挑战性的谜题来报复他。\n\nBessie 给 FJ 的表达式是 $(B+E+S+S+I+E)(G+O+E+S)(M+O+O)$，其中包含七个变量 $B,E,S,I,G,O,M$（\"$O$\" 是一个变量，不是零）。对于每个变量，她给 FJ 提供了一个最多包含 500 个整数值的列表，表示该变量可能取的值。\n\n她要求 FJ 计算有多少种不同的方式可以为这些变量赋值，使得整个表达式的值是 7 的倍数。\n\n注意，这个问题的答案可能太大，无法用 32 位整数表示，因此你可能需要使用 64 位整数（例如，C 或 C++ 中的 \"long long\"）。", "inputFormat": "输入的第一行包含一个整数 $N$。接下来的 $N$ 行每行包含一个变量及其可能的值。\n\n每个变量在这个列表中至少出现一次，最多出现 500 次。对于同一个变量，不会列出重复的可能值。所有可能的值都在 $-10^5$ 到 $10^5$ 的范围内。", "outputFormat": "输出一个整数，表示 FJ 可以为变量赋值的方式数，使得上述表达式的值是 7 的倍数。", "hint": "两种可能的赋值方式是：\n\n$(B,E,S,I,G,O,M) = (2, 5, 7, 9, 1, 16, 19)$ -> 51,765\n\n$(B,E,S,I,G,O,M) = (2, 5, 7, 9, 1, 16, 2)$ -> 34,510", "locale": "zh-CN"}}}
{"pid": "P3124", "type": "P", "difficulty": 5, "samples": [["5 7\n8 1\n1 4\n3 8\n12 15\n20 20", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2015", "USACO", "排序"], "title": "[USACO15OPEN] Trapped in the Haybales S", "background": "", "description": "Farmer John has received a shipment of $N$ large hay bales ($1 \\le N \\le 100,000$), and placed them at various locations along the road connecting the barn with his house.  Each bale $j$ has a size $S_j$ and a distinct position $P_j$ giving its location along the one-dimensional road. Bessie the cow is currently located at position $B$, where there is no hay bale.\n\nBessie the cow can move around freely along the road, even up to the position at which a bale is located, but she cannot cross through this position.  As an exception, if she runs in the same direction for $D$ units of distance, she builds up enough speed to break through and permanently eliminate any hay bale of size strictly less than $D$. Of course, after doing this, she might open up more space to allow her to make a run at other hay bales, eliminating them as well.\n\nFJ is currently re-painting his house and his barn, and wants to make sure Bessie cannot reach either one (cows and fresh paint do not make a good combination!)  Accordingly, FJ wants to make sure Bessie never breaks through the leftmost or rightmost hay bale, so she stays effectively trapped within the hay bales.  FJ has the ability to add hay to a single bale of his choosing to help keep Bessie trapped.  Please help him determine the minimum amount of extra size he needs to add to some bale to ensure Bessie stays trapped.", "inputFormat": "The first line of input contains $N$ as well as Bessie's initial position $B$. Each of the next $N$ lines describes a bale, and contains two integers giving its size and position.  All sizes and positions are in the range $1\\ldots 10^9$.\n", "outputFormat": "Print a single integer, giving the minimum amount of hay FJ needs to add to prevent Bessie from escaping.  Print -1 if it is impossible to prevent Bessie's escape.\n", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO15OPEN] Trapped in the Haybales S", "background": "", "description": "Farmer John has received a shipment of $N$ large hay bales ($1 \\le N \\le 100,000$), and placed them at various locations along the road connecting the barn with his house.  Each bale $j$ has a size $S_j$ and a distinct position $P_j$ giving its location along the one-dimensional road. Bessie the cow is currently located at position $B$, where there is no hay bale.\n\nBessie the cow can move around freely along the road, even up to the position at which a bale is located, but she cannot cross through this position.  As an exception, if she runs in the same direction for $D$ units of distance, she builds up enough speed to break through and permanently eliminate any hay bale of size strictly less than $D$. Of course, after doing this, she might open up more space to allow her to make a run at other hay bales, eliminating them as well.\n\nFJ is currently re-painting his house and his barn, and wants to make sure Bessie cannot reach either one (cows and fresh paint do not make a good combination!)  Accordingly, FJ wants to make sure Bessie never breaks through the leftmost or rightmost hay bale, so she stays effectively trapped within the hay bales.  FJ has the ability to add hay to a single bale of his choosing to help keep Bessie trapped.  Please help him determine the minimum amount of extra size he needs to add to some bale to ensure Bessie stays trapped.", "inputFormat": "The first line of input contains $N$ as well as Bessie's initial position $B$. Each of the next $N$ lines describes a bale, and contains two integers giving its size and position.  All sizes and positions are in the range $1\\ldots 10^9$.\n", "outputFormat": "Print a single integer, giving the minimum amount of hay FJ needs to add to prevent Bessie from escaping.  Print -1 if it is impossible to prevent Bessie's escape.\n", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO15OPEN] Trapped in the Haybales S", "background": "", "description": "FJ 收到了 $N$ 捆干草，并将它们放置在连接房屋与谷仓的道路上。第 $j$ 捆干草的大小为 $S_j$，位置为 $P_j$。Bessie 一开始在 $B$ 处，不与任何一捆干草的位置重合。\n\nBessie 可以在干草捆之间任意移动（也可以到达干草捆所在的位置），但不能越过干草捆。但凡事总有例外：当 Bessie 进行了长度为 $D$ 的冲刺后，她就可以击碎一捆大小严格小于 $D$ 的干草，这意味着这捆干草不复存在。\n\n由于某些原因，FJ 希望把 Bessie 困在最左边与最右边的干草捆之间。为此，他希望将某一捆干草的大小增加一些。如果可能把 Bessie 困住，请输出他最少需要增加多少干草；否则输出 `-1`。\n\n$1 \\leqslant N \\leqslant 10^5$，$1 \\leqslant S_i, P_i, B \\leqslant 10^9$。", "inputFormat": "第一行，两个整数 $N, B$，分别表示干草捆数量与 Bessie 所在位置。\n\n接下来 $N$ 行，第 $i$ 行为两个整数 $S_i, P_i$，分别表示第 $i$ 捆干草的大小与位置。", "outputFormat": "如果可能把 Bessie 困住，输出一行一个整数，表示最少需要增加多少干草；否则输出 `-1`。\n\nTranslated by [KHIN](/user/236807).", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3125", "type": "P", "difficulty": 5, "samples": [["5 2\n4 1 2\n1 3 1 3 4\n6 2 2 5\n5 2 2 5\n2 2 3 4", "7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2015", "USACO", "最短路"], "title": "[USACO15OPEN] Bessie's Birthday Buffet S", "background": "", "description": "For Bessie the cow’s birthday, Farmer John has given her free reign over one of his best fields to eat grass.\n\nThe field is covered in $N$ patches of grass ($1 \\le N \\le 1000$), conveniently numbered $1\\ldots N$, that each have a distinct quality value.  If Bessie eats grass of quality $Q$, she gains $Q$ units of energy.  Each patch is connected to up to 10 neighboring patches via bi-directional paths, and it takes Bessie $E$ units of energy to move between adjacent patches ($1 \\le E \\le 1,000,000$).\n\nBessie can choose to start grazing in any patch she wishes, and she wants to stop grazing once she has accumulated a maximum amount of energy.\n\nUnfortunately, Bessie is a picky bovine, and once she eats grass of a certain quality, she’ll never eat grass at or below that quality level again!  She is still happy to walk through patches without eating their grass; in fact, she might find it beneficial to walk through a patch of high-quality grass without eating it, only to return later for a tasty snack.\n\nPlease help determine the maximum amount of energy Bessie can accumulate.", "inputFormat": "The first line of input contains $N$ and $E$.  Each of the remaining $N$ lines describe a patch of grass.  They contain two integers $Q$ and $D$ giving the quality of the patch (in the range $1\\ldots 1,000,000$) and its number of neighbors.  The remaining $D$ numbers on the line specify the neighbors.", "outputFormat": "Please output the maximum amount of energy Bessie can accumulate.", "hint": "Bessie starts at patch 4 gaining 5 units of energy from the grass there. She then takes the path to patch 5 losing 2 units of energy during her travel. She refuses to eat the lower quality grass at patch 5 and travels to patch 3 again losing 2 units of energy.  Finally she eats the grass at patch 3 gaining 6 units of energy for a total of 7 energy.\n\nNote that the sample case above is different from test case 1 when you submit.", "locale": "en", "translations": {"en": {"title": "[USACO15OPEN] Bessie's Birthday Buffet S", "background": "", "description": "For Bessie the cow’s birthday, Farmer John has given her free reign over one of his best fields to eat grass.\n\nThe field is covered in $N$ patches of grass ($1 \\le N \\le 1000$), conveniently numbered $1\\ldots N$, that each have a distinct quality value.  If Bessie eats grass of quality $Q$, she gains $Q$ units of energy.  Each patch is connected to up to 10 neighboring patches via bi-directional paths, and it takes Bessie $E$ units of energy to move between adjacent patches ($1 \\le E \\le 1,000,000$).\n\nBessie can choose to start grazing in any patch she wishes, and she wants to stop grazing once she has accumulated a maximum amount of energy.\n\nUnfortunately, Bessie is a picky bovine, and once she eats grass of a certain quality, she’ll never eat grass at or below that quality level again!  She is still happy to walk through patches without eating their grass; in fact, she might find it beneficial to walk through a patch of high-quality grass without eating it, only to return later for a tasty snack.\n\nPlease help determine the maximum amount of energy Bessie can accumulate.", "inputFormat": "The first line of input contains $N$ and $E$.  Each of the remaining $N$ lines describe a patch of grass.  They contain two integers $Q$ and $D$ giving the quality of the patch (in the range $1\\ldots 1,000,000$) and its number of neighbors.  The remaining $D$ numbers on the line specify the neighbors.", "outputFormat": "Please output the maximum amount of energy Bessie can accumulate.", "hint": "Bessie starts at patch 4 gaining 5 units of energy from the grass there. She then takes the path to patch 5 losing 2 units of energy during her travel. She refuses to eat the lower quality grass at patch 5 and travels to patch 3 again losing 2 units of energy.  Finally she eats the grass at patch 3 gaining 6 units of energy for a total of 7 energy.\n\nNote that the sample case above is different from test case 1 when you submit.", "locale": "en"}, "zh-CN": {"title": "[USACO15OPEN] Bessie's Birthday Buffet S", "background": null, "description": "为了庆祝奶牛 Bessie 的生日，Farmer John 允许她在他最好的草地上自由吃草。\n\n这片草地被划分为 $N$ 块草皮（$1 \\le N \\le 1000$），编号为 $1\\ldots N$，每块草皮都有一个独特的质量值。如果 Bessie 吃了质量为 $Q$ 的草，她会获得 $Q$ 单位的能量。每块草皮通过双向路径与最多 10 个相邻草皮相连，Bessie 在相邻草皮之间移动需要消耗 $E$ 单位的能量（$1 \\le E \\le 1,000,000$）。\n\nBessie 可以选择从任意一块草皮开始吃草，她希望在积累最大能量后停止吃草。\n\n不幸的是，Bessie 是一头挑剔的牛，一旦她吃了某种质量的草，她就再也不会吃质量等于或低于该水平的草了！她仍然乐意在不吃草的情况下穿过草皮；事实上，她可能会发现穿过一块高质量草皮而不吃草是有益的，只是为了稍后再回来享用美味的小吃。\n\n请帮助确定 Bessie 能够积累的最大能量。", "inputFormat": "输入的第一行包含 $N$ 和 $E$。接下来的 $N$ 行描述每块草皮。每行包含两个整数 $Q$ 和 $D$，分别表示草皮的质量（范围为 $1\\ldots 1,000,000$）和它相邻的草皮数量。该行剩下的 $D$ 个数字指定了它相邻的草皮的编号。", "outputFormat": "请输出 Bessie 能够积累的最大能量。", "hint": "Bessie 从草皮 4 开始，获得 5 单位的能量。然后她沿着路径移动到草皮 5，在移动过程中消耗了 2 单位的能量。她拒绝吃草皮 5 上质量较低的草，并继续移动到草皮 3，再次消耗了 2 单位的能量。最后，她吃了草皮 3 上的草，获得了 6 单位的能量，总共积累了 7 单位的能量。\n\n请注意，上述样例与提交时的测试用例 1 不同。", "locale": "zh-CN"}}}
{"pid": "P3126", "type": "P", "difficulty": 5, "samples": [["4\nABCD\nBXZX\nCDXB\nWCBA", "12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "动态规划 DP", "2015", "USACO", "枚举"], "title": "[USACO15OPEN] Palindromic Paths G", "background": "", "description": "Farmer John's farm is in the shape of an $N \\times N$ grid of fields ($1 \\le N \\le 500$), each labeled with a letter in the alphabet.  For example:\n\n```cpp\nABCD\nBXZX\nCDXB\nWCBA\n```\nEach day, Bessie the cow walks from the upper-left field to the lower-right field, each step taking her either one field to the right or one field downward. Bessie keeps track of the string that she generates during this process, built from the letters she walks across. She gets very disoriented, however, if this string is a palindrome (reading the same forward as backward), since she gets confused about which direction she had walked. Please help Bessie determine the number of distinct routes she can take that  correspond to palindromes. Different ways of obtaining the same palindrome count multiple times. Please print your answer modulo 1,000,000,007.", "inputFormat": "The first line of input contains $N$, and the remaining $N$ lines contain the $N$ rows of the grid of fields. Each row contains $N$ characters that are in the range A..Z.", "outputFormat": "Please output the number of distinct palindromic routes Bessie can take, modulo 1,000,000,007.", "hint": "Bessie can make the following palindromes\n\n1 x \"ABCDCBA\"\n\n1 x \"ABCWCBA\"\n\n6 x \"ABXZXBA\"\n\n4 x \"ABXDXBA\"\n", "locale": "en", "translations": {"en": {"title": "[USACO15OPEN] Palindromic Paths G", "background": "", "description": "Farmer John's farm is in the shape of an $N \\times N$ grid of fields ($1 \\le N \\le 500$), each labeled with a letter in the alphabet.  For example:\n\n```cpp\nABCD\nBXZX\nCDXB\nWCBA\n```\nEach day, Bessie the cow walks from the upper-left field to the lower-right field, each step taking her either one field to the right or one field downward. Bessie keeps track of the string that she generates during this process, built from the letters she walks across. She gets very disoriented, however, if this string is a palindrome (reading the same forward as backward), since she gets confused about which direction she had walked. Please help Bessie determine the number of distinct routes she can take that  correspond to palindromes. Different ways of obtaining the same palindrome count multiple times. Please print your answer modulo 1,000,000,007.", "inputFormat": "The first line of input contains $N$, and the remaining $N$ lines contain the $N$ rows of the grid of fields. Each row contains $N$ characters that are in the range A..Z.", "outputFormat": "Please output the number of distinct palindromic routes Bessie can take, modulo 1,000,000,007.", "hint": "Bessie can make the following palindromes\n\n1 x \"ABCDCBA\"\n\n1 x \"ABCWCBA\"\n\n6 x \"ABXZXBA\"\n\n4 x \"ABXDXBA\"\n", "locale": "en"}, "zh-CN": {"title": "[USACO15OPEN] Palindromic Paths G", "background": "", "description": "Farmer John 的农场是一个 $N \\times N$ 的网格（$1 \\le N \\le 500$），每个格子标有一个字母。例如：\n\n```\nABCD\nBXZX\nCDXB\nWCBA\n```\n\n每天，奶牛 Bessie 从左上角的格子走到右下角的格子，每一步只能向右或向下移动一个格子。Bessie 会记录下她走过的路径所生成的字符串，这个字符串由她经过的格子上的字母组成。然而，如果这个字符串是一个回文串（即正读和反读相同），她会感到非常困惑，因为她会分不清自己走过的方向。请帮助 Bessie 计算她可以走的不同路径中，对应回文串的数量。即使生成相同回文串的方式不同，也需要分别计数。请输出答案对 1,000,000,007 取模的结果。", "inputFormat": "输入的第一行包含 $N$，接下来的 $N$ 行包含网格的 $N$ 行。每行包含 $N$ 个字符，字符范围为 A..Z。", "outputFormat": "请输出 Bessie 可以走的不同回文路径的数量，对 1,000,000,007 取模。", "hint": "Bessie 可以生成以下回文串：\n\n- 1 个 \"ABCDCBA\"\n- 1 个 \"ABCWCBA\"\n- 6 个 \"ABXZXBA\"\n- 4 个 \"ABXDXBA\"", "locale": "zh-CN"}}}
{"pid": "P3127", "type": "P", "difficulty": 5, "samples": [["5\n8 1\n1 4\n8 8\n7 15\n4 20", "14"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2015", "USACO", "并查集", "离散化", "枚举"], "title": "[USACO15OPEN] Trapped in the Haybales G", "background": "", "description": "Farmer John has received a shipment of N large hay bales ($1 \\le N \\le 100,000$), and placed them at various locations along the road leading to his barn. Unfortunately, he completely forgets that Bessie the cow is out grazing along the road, and she may now be trapped within the bales! Each bale $j$ has a size $S_j$ and a position $P_j$ giving its location along the one-dimensional road.  Bessie the cow can move around freely along the road, even up to the position at which a bale is located, but she cannot cross through this position.  As an exception, if she runs in the same direction for $D$ units of distance, she builds up enough speed to break through and permanently eliminate any hay bale of size strictly less than $D$.  Of course, after doing this, she might open up more space to allow her to make a run at other hay bales, eliminating them as well.\n\nBessie can escape to freedom if she can eventually break through either the  leftmost or rightmost hay bale.  Please compute the total area of the road consisting of real-valued starting positions from which Bessie cannot escape.\n\n", "inputFormat": "The first line of input contains $N$.  Each of the next $N$ lines describes a bale, and contains two integers giving its size and position, each in the range $1\\ldots 10^9$. All positions are distinct.\n", "outputFormat": "Print a single integer, giving the area of the road from which Bessie cannot escape.", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO15OPEN] Trapped in the Haybales G", "background": "", "description": "Farmer John has received a shipment of N large hay bales ($1 \\le N \\le 100,000$), and placed them at various locations along the road leading to his barn. Unfortunately, he completely forgets that Bessie the cow is out grazing along the road, and she may now be trapped within the bales! Each bale $j$ has a size $S_j$ and a position $P_j$ giving its location along the one-dimensional road.  Bessie the cow can move around freely along the road, even up to the position at which a bale is located, but she cannot cross through this position.  As an exception, if she runs in the same direction for $D$ units of distance, she builds up enough speed to break through and permanently eliminate any hay bale of size strictly less than $D$.  Of course, after doing this, she might open up more space to allow her to make a run at other hay bales, eliminating them as well.\n\nBessie can escape to freedom if she can eventually break through either the  leftmost or rightmost hay bale.  Please compute the total area of the road consisting of real-valued starting positions from which Bessie cannot escape.\n\n", "inputFormat": "The first line of input contains $N$.  Each of the next $N$ lines describes a bale, and contains two integers giving its size and position, each in the range $1\\ldots 10^9$. All positions are distinct.\n", "outputFormat": "Print a single integer, giving the area of the road from which Bessie cannot escape.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO15OPEN] Trapped in the Haybales G", "background": "", "description": "Farmer John 收到了一批 $N$ 个大型干草捆（$1 \\le N \\le 100,000$），并将它们放置在他通往谷仓的道路上的不同位置。不幸的是，他完全忘记了奶牛 Bessie 正在这条路上吃草，她现在可能被困在这些干草捆之间了！每个干草捆 $j$ 有一个大小 $S_j$ 和一个位置 $P_j$，表示它在这条一维道路上的位置。Bessie 可以在道路上自由移动，甚至可以移动到干草捆所在的位置，但她无法穿过这个位置。唯一的例外是，如果她朝同一方向连续移动 $D$ 单位的距离，她将获得足够的速度，能够突破并永久消除任何大小严格小于 $D$ 的干草捆。当然，在突破之后，她可能会打开更多的空间，从而有机会突破其他干草捆，并继续消除它们。\n\n如果 Bessie 最终能够突破最左侧或最右侧的干草捆，她就可以成功逃脱。请计算道路中所有无法逃脱的实数起始位置的总面积。", "inputFormat": "输入的第一行包含 $N$。接下来的 $N$ 行描述每个干草捆，每行包含两个整数，分别表示干草捆的大小和位置，范围均为 $1 \\ldots 10^9$。所有位置均不相同。", "outputFormat": "输出一个整数，表示 Bessie 无法逃脱的道路总面积。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3128", "type": "P", "difficulty": 4, "samples": [["5 10\n3 4\n1 5\n4 2\n5 4\n5 4\n5 4\n3 5\n4 3\n4 3\n1 3\n3 5\n5 4\n1 5\n3 4", "9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "USACO", "最近公共祖先 LCA", "树链剖分", "差分"], "title": "[USACO15DEC] Max Flow P", "background": "", "description": "Farmer John has installed a new system of $N-1$ pipes to transport milk between the $N$ stalls in his barn ($2 \\leq N \\leq 50,000$), conveniently numbered $1 \\ldots N$. Each pipe connects a pair of stalls, and all stalls are connected to each-other via paths of pipes.\n\nFJ is pumping milk between $K$ pairs of stalls ($1 \\leq K \\leq 100,000$). For the $i$th such pair,  you are told two stalls $s_i$ and $t_i$, endpoints of a path along which milk is being pumped at a unit rate. FJ is concerned that some stalls might end up overwhelmed with all the milk being pumped through them, since a stall can serve as a waypoint along many of the $K$ paths along which milk is being pumped. Please help him determine the maximum amount of milk being pumped through any stall. If milk is being pumped along a path from $s_i$ to $t_i$, then it counts as being pumped through the endpoint stalls $s_i$ and $t_i$, as well as through every stall along the path between them.", "inputFormat": "The first line of the input contains $N$ and $K$.\n\nThe next $N-1$ lines each contain two integers $x$ and $y$ ($x \\ne y$) describing a pipe between stalls $x$ and $y$.\n\nThe next $K$ lines each contain two integers $s$ and $t$ describing the endpoint stalls of a path through which milk is being pumped.\n", "outputFormat": "An integer specifying the maximum amount of milk pumped through any stall in the barn.", "hint": "$2 \\le N \\le 5 \\times 10^4,1 \\le K \\le 10^5$", "locale": "en", "translations": {"en": {"title": "[USACO15DEC] Max Flow P", "background": "", "description": "Farmer John has installed a new system of $N-1$ pipes to transport milk between the $N$ stalls in his barn ($2 \\leq N \\leq 50,000$), conveniently numbered $1 \\ldots N$. Each pipe connects a pair of stalls, and all stalls are connected to each-other via paths of pipes.\n\nFJ is pumping milk between $K$ pairs of stalls ($1 \\leq K \\leq 100,000$). For the $i$th such pair,  you are told two stalls $s_i$ and $t_i$, endpoints of a path along which milk is being pumped at a unit rate. FJ is concerned that some stalls might end up overwhelmed with all the milk being pumped through them, since a stall can serve as a waypoint along many of the $K$ paths along which milk is being pumped. Please help him determine the maximum amount of milk being pumped through any stall. If milk is being pumped along a path from $s_i$ to $t_i$, then it counts as being pumped through the endpoint stalls $s_i$ and $t_i$, as well as through every stall along the path between them.", "inputFormat": "The first line of the input contains $N$ and $K$.\n\nThe next $N-1$ lines each contain two integers $x$ and $y$ ($x \\ne y$) describing a pipe between stalls $x$ and $y$.\n\nThe next $K$ lines each contain two integers $s$ and $t$ describing the endpoint stalls of a path through which milk is being pumped.\n", "outputFormat": "An integer specifying the maximum amount of milk pumped through any stall in the barn.", "hint": "$2 \\le N \\le 5 \\times 10^4,1 \\le K \\le 10^5$", "locale": "en"}, "zh-CN": {"title": "[USACO15DEC] Max Flow P", "background": "", "description": "Farmer John 在他的谷仓中安装了 $N-1$ 条管道，用于在 $N$ 个牛棚之间运输牛奶（$2 \\leq N \\leq 50,000$），牛棚方便地编号为 $1 \\ldots N$。每条管道连接一对牛棚，所有牛棚通过这些管道相互连接。\n\nFJ 正在 $K$ 对牛棚之间泵送牛奶（$1 \\leq K \\leq 100,000$）。对于第 $i$ 对牛棚，你被告知两个牛棚 $s_i$ 和 $t_i$，这是牛奶以单位速率泵送的路径的端点。FJ 担心某些牛棚可能会因为过多的牛奶通过它们而不堪重负，因为一个牛棚可能会作为许多泵送路径的中转站。请帮助他确定通过任何一个牛棚的最大牛奶量。如果牛奶沿着从 $s_i$ 到 $t_i$ 的路径泵送，那么它将被计入端点牛棚 $s_i$ 和 $t_i$，以及它们之间路径上的所有牛棚。", "inputFormat": "输入的第一行包含 $N$ 和 $K$。\n\n接下来的 $N-1$ 行每行包含两个整数 $x$ 和 $y$（$x \\ne y$），描述连接牛棚 $x$ 和 $y$ 的管道。\n\n接下来的 $K$ 行每行包含两个整数 $s$ 和 $t$，描述牛奶泵送路径的端点牛棚。", "outputFormat": "输出一个整数，表示通过谷仓中任何一个牛棚的最大牛奶量。", "hint": "$2 \\le N \\le 5 \\times 10^4,1 \\le K \\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P3129", "type": "P", "difficulty": 5, "samples": [["4\n1\n8\n4\n3", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2015", "线段树", "USACO"], "title": "[USACO15DEC] High Card Low Card P", "background": "", "description": "Bessie the cow is a hu e fan of card games, which is quite surprising, given her lack of opposable thumbs. Unfortunately, none of the other cows in the herd are good opponents. They are so bad, in fact, that they always play in a completely predictable fashion! Nonetheless, it can still be a challenge for Bessie to figure out how to win.\n\nBessie and her friend Elsie are currently playing a simple card game where they take a deck of $2N$ cards, conveniently numbered $1 \\ldots 2N$, and divide them into $N$ cards for Bessie and $N$ cards for Elsie. The two then play $N$ rounds, where in each round Bessie and Elsie both play a single card. Initially, the player who plays the highest card earns a point. However, at one point  during the game, Bessie can decide to switch the rules so that for the rest of the game, the player who plays the lowest card wins a point.  Bessie can choose not to use this option, leaving the entire game in \"high card wins\" mode, or she can even invoke the option right away, making the entire game follow the \"low card wins\" rule.\n\nGiven that Bessie can predict the order in which Elsie will play her cards, please determine the maximum number of points Bessie can win.", "inputFormat": "The first line of input contains the value of N ($2 \\leq N \\leq 50,000$).\n\nThe next N lines contain the cards that Elsie will play in each of the successive rounds of the game.  Note that it is easy to determine Bessie's cards from this information.", "outputFormat": "Output a single line giving the maximum number of points Bessie can score.\n", "hint": "Here, Bessie must have cards 2, 5, and 6, and 7 in her hand, and she can use these to win at most 3 points.  For example, she can defeat the 1 card and then switch the rules to \"low card wins\", after which she can win two more rounds.", "locale": "en", "translations": {"en": {"title": "[USACO15DEC] High Card Low Card P", "background": "", "description": "Bessie the cow is a hu e fan of card games, which is quite surprising, given her lack of opposable thumbs. Unfortunately, none of the other cows in the herd are good opponents. They are so bad, in fact, that they always play in a completely predictable fashion! Nonetheless, it can still be a challenge for Bessie to figure out how to win.\n\nBessie and her friend Elsie are currently playing a simple card game where they take a deck of $2N$ cards, conveniently numbered $1 \\ldots 2N$, and divide them into $N$ cards for Bessie and $N$ cards for Elsie. The two then play $N$ rounds, where in each round Bessie and Elsie both play a single card. Initially, the player who plays the highest card earns a point. However, at one point  during the game, Bessie can decide to switch the rules so that for the rest of the game, the player who plays the lowest card wins a point.  Bessie can choose not to use this option, leaving the entire game in \"high card wins\" mode, or she can even invoke the option right away, making the entire game follow the \"low card wins\" rule.\n\nGiven that Bessie can predict the order in which Elsie will play her cards, please determine the maximum number of points Bessie can win.", "inputFormat": "The first line of input contains the value of N ($2 \\leq N \\leq 50,000$).\n\nThe next N lines contain the cards that Elsie will play in each of the successive rounds of the game.  Note that it is easy to determine Bessie's cards from this information.", "outputFormat": "Output a single line giving the maximum number of points Bessie can score.\n", "hint": "Here, Bessie must have cards 2, 5, and 6, and 7 in her hand, and she can use these to win at most 3 points.  For example, she can defeat the 1 card and then switch the rules to \"low card wins\", after which she can win two more rounds.", "locale": "en"}, "zh-CN": {"title": "[USACO15DEC] High Card Low Card P", "background": "", "description": "奶牛 Bessie 是卡牌游戏的狂热爱好者，这相当令人惊讶，因为她没有灵活的手指。不幸的是，牛群中的其他奶牛都不是好的对手。事实上，她们的表现非常糟糕，总是以完全可预测的方式出牌！尽管如此，对 Bessie 来说，如何获胜仍然是一个挑战。\n\nBessie 和她的朋友 Elsie 正在玩一个简单的卡牌游戏。她们拿一副 $2N$ 张牌，方便地编号为 $1 \\ldots 2N$，并将其分成 $N$ 张牌给 Bessie 和 $N$ 张牌给 Elsie。然后，两人进行 $N$ 轮游戏，每轮 Bessie 和 Elsie 各打出一张牌。最初，打出更高牌的玩家得一分。然而，在游戏中的某个时刻，Bessie 可以决定改变规则，使得在接下来的游戏中，打出更低牌的玩家得一分。Bessie 可以选择不使用这个选项，让整个游戏保持在“高牌获胜”模式，或者她也可以立即启用这个选项，让整个游戏遵循“低牌获胜”的规则。\n\n已知 Bessie 可以预测 Elsie 出牌的顺序，请确定 Bessie 可以获得的最大分数。", "inputFormat": "输入的第一行包含 $N$ 的值（$2 \\leq N \\leq 50,000$）。\n\n接下来的 $N$ 行包含 Elsie 在游戏每轮中将要打出的牌。注意，从这些信息中可以很容易地确定 Bessie 手中的牌。", "outputFormat": "输出一行，表示 Bessie 可以获得的最大分数。", "hint": "在这里，Bessie 手中的牌必须是 2、5、6 和 7，她最多可以利用这些牌赢得 3 分。例如，她可以先击败 1 这张牌，然后将规则切换为“低牌获胜”，之后她可以再赢得两轮。", "locale": "zh-CN"}}}
{"pid": "P3130", "type": "P", "difficulty": 4, "samples": [["4 5\n3 1 2 4\nM 3 4\nS 1 3\nP 2 3 1\nM 3 4\nS 1 3", "2\n6\n3\n8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "线段树", "USACO"], "title": "[USACO15DEC] Counting Haybale P", "background": "", "description": "Farmer John is trying to hire contractors to help rearrange his farm, but so far all of them have quit when they saw the complicated sequence of instructions FJ wanted them to follow.  Left to complete the project by himself, he realizes that indeed, he has made the project perhaps more  complicated than necessary.  Please help him follow his instructions to  complete the farm upgrade.\n\nFJ's farm consists of $N$ fields in a row, conveniently numbered $1 \\ldots N$. In each field there can be any number of haybales.  Farmer John's instructions contain three types of entries:\n\n1) Given a contiguous interval of fields, add a new haybale to each field.\n\n2) Given a contiguous interval of fields, determine the minimum number of haybales in a field within that interval.\n\n3) Given a contiguous interval of fields, count the total number of haybales  inside that interval.", "inputFormat": "The first line contains two positive integers, $N$ ($1 \\leq N \\leq 200,000$) and $Q$ ($1 \\leq Q \\leq 100,000$).\n\nThe next line contains $N$ nonnegative integers, each at most 100,000, indicating how many haybales are initially in each field.\n\nEach of the next $Q$ lines contains a single uppercase letter, either M, P or S, followed by either two positive integers $A$ and $B$ ($1 \\leq A \\leq B \\leq N$), or three positive integers $A$, $B$, and $C$ ($1 \\leq A \\leq B \\leq N$; $1 \\leq C \\leq 100,000$).  There will be three positive integers if and only if the uppercase letter is P.\n\nIf the letter is M, print the minimum number of haybales in the interval of fields from $A \\ldots B$.\n\nIf the letter is P, put $C$ new haybales in each field in the interval of fields from $A \\ldots B$.\n\nIf the letter is S, print the total number of haybales found within interval of fields from $A \\ldots B$.", "outputFormat": "A line in the output should appear in response to every 'M' or 'S' entry in FJ's instructions.", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO15DEC] Counting Haybale P", "background": "", "description": "Farmer John is trying to hire contractors to help rearrange his farm, but so far all of them have quit when they saw the complicated sequence of instructions FJ wanted them to follow.  Left to complete the project by himself, he realizes that indeed, he has made the project perhaps more  complicated than necessary.  Please help him follow his instructions to  complete the farm upgrade.\n\nFJ's farm consists of $N$ fields in a row, conveniently numbered $1 \\ldots N$. In each field there can be any number of haybales.  Farmer John's instructions contain three types of entries:\n\n1) Given a contiguous interval of fields, add a new haybale to each field.\n\n2) Given a contiguous interval of fields, determine the minimum number of haybales in a field within that interval.\n\n3) Given a contiguous interval of fields, count the total number of haybales  inside that interval.", "inputFormat": "The first line contains two positive integers, $N$ ($1 \\leq N \\leq 200,000$) and $Q$ ($1 \\leq Q \\leq 100,000$).\n\nThe next line contains $N$ nonnegative integers, each at most 100,000, indicating how many haybales are initially in each field.\n\nEach of the next $Q$ lines contains a single uppercase letter, either M, P or S, followed by either two positive integers $A$ and $B$ ($1 \\leq A \\leq B \\leq N$), or three positive integers $A$, $B$, and $C$ ($1 \\leq A \\leq B \\leq N$; $1 \\leq C \\leq 100,000$).  There will be three positive integers if and only if the uppercase letter is P.\n\nIf the letter is M, print the minimum number of haybales in the interval of fields from $A \\ldots B$.\n\nIf the letter is P, put $C$ new haybales in each field in the interval of fields from $A \\ldots B$.\n\nIf the letter is S, print the total number of haybales found within interval of fields from $A \\ldots B$.", "outputFormat": "A line in the output should appear in response to every 'M' or 'S' entry in FJ's instructions.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO15DEC] Counting Haybale P", "background": null, "description": "Farmer John 正在尝试雇佣承包商来帮助他重新安排农场，但到目前为止，所有承包商在看到 FJ 希望他们遵循的复杂指令序列后都辞职了。FJ 不得不自己完成这个项目，他意识到自己可能把项目搞得比必要的还要复杂。请帮助他按照指令完成农场的升级。\n\nFJ 的农场由一排 $N$ 个田地组成，编号为 $1 \\ldots N$。每个田地里可以有任意数量的干草堆。Farmer John 的指令包含三种类型的条目：\n\n1) 给定一个连续的田地区间，向每个田地添加 $C$ 个新的干草堆。\n\n2) 给定一个连续的田地区间，确定该区间内田地中干草堆的最小数量。\n\n3) 给定一个连续的田地区间，计算该区间内干草堆的总数。", "inputFormat": "第一行包含两个正整数，$N$（$1 \\leq N \\leq 200,000$）和 $Q$（$1 \\leq Q \\leq 100,000$）。\n\n第二行包含 $N$ 个非负整数，每个整数最多为 $100,000$，表示每个田地中初始的干草堆数量。\n\n接下来的 $Q$ 行每行包含一个大写字母，可能是 M、P 或 S，后跟两个正整数 $A$ 和 $B$（$1 \\leq A \\leq B \\leq N$），或者三个正整数 $A$、$B$ 和 $C$（$1 \\leq A \\leq B \\leq N$；$1 \\leq C \\leq 100,000$）。只有当大写字母是 P 时，才会有三个正整数。\n\n如果字母是 M，输出从 $A \\ldots B$ 的田地区间内干草堆的最小数量。\n\n如果字母是 P，向从 $A \\ldots B$ 的田地区间内的每个田地添加 $C$ 个新的干草堆。\n\n如果字母是 S，输出从 $A \\ldots B$ 的田地区间内干草堆的总数。", "outputFormat": "对于 FJ 指令中的每一个 'M' 或 'S' 条目，输出一行相应的结果。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P3131", "type": "P", "difficulty": 2, "samples": [["7\n3\n5\n1\n6\n2\n14\n10", "5"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2016", "USACO", "前缀和"], "title": "[USACO16JAN] Subsequences Summing to Sevens S", "background": "", "description": "Farmer John's $N$ cows are standing in a row, as they have a tendency to do from time to time.  Each cow is labeled with a distinct integer ID number so FJ can tell them apart. FJ would like to take a photo of a contiguous group of cows but, due to a traumatic  childhood incident involving the numbers $1 \\ldots 6$, he only wants to take a picture of a group of cows if their IDs add up to a multiple of 7.\n\nPlease help FJ determine the size of the largest group he can photograph.", "inputFormat": "The first line of input contains $N$ ($1 \\leq N \\leq 50,000$).  The next $N$ lines each contain the $N$ integer IDs of the cows (all are in the range $0 \\ldots 1,000,000$).\n", "outputFormat": "Please output the number of cows in the largest consecutive group whose IDs sum to a multiple of 7. If no such group exists, output 0.", "hint": "In this example, $5+1+6+2+14 = 28$.", "locale": "en", "translations": {"en": {"title": "[USACO16JAN] Subsequences Summing to Sevens S", "background": "", "description": "Farmer John's $N$ cows are standing in a row, as they have a tendency to do from time to time.  Each cow is labeled with a distinct integer ID number so FJ can tell them apart. FJ would like to take a photo of a contiguous group of cows but, due to a traumatic  childhood incident involving the numbers $1 \\ldots 6$, he only wants to take a picture of a group of cows if their IDs add up to a multiple of 7.\n\nPlease help FJ determine the size of the largest group he can photograph.", "inputFormat": "The first line of input contains $N$ ($1 \\leq N \\leq 50,000$).  The next $N$ lines each contain the $N$ integer IDs of the cows (all are in the range $0 \\ldots 1,000,000$).\n", "outputFormat": "Please output the number of cows in the largest consecutive group whose IDs sum to a multiple of 7. If no such group exists, output 0.", "hint": "In this example, $5+1+6+2+14 = 28$.", "locale": "en"}, "zh-CN": {"title": "[USACO16JAN] Subsequences Summing to Sevens S", "background": "", "description": "Farmer John 的 $N$ 头奶牛站成一排，这是它们时不时会做的事情。每头奶牛都有一个独特的整数 ID 编号，以便 Farmer John 能够区分它们。Farmer John 希望为一组连续的奶牛拍照，但由于童年时与数字 $1 \\ldots 6$ 相关的创伤事件，他只希望拍摄一组奶牛，如果它们的 ID 加起来是 7 的倍数。\n\n请帮助 Farmer John 确定他可以拍摄的最大奶牛组的大小。", "inputFormat": "输入的第一行包含 $N$（$1 \\leq N \\leq 50,000$）。接下来的 $N$ 行每行包含一头奶牛的整数 ID（所有 ID 都在 $0 \\ldots 1,000,000$ 范围内）。", "outputFormat": "请输出 ID 之和为 7 的倍数的最大连续奶牛组中的奶牛数量。如果不存在这样的组，则输出 0。", "hint": "在这个例子中，$5+1+6+2+14 = 28$。", "locale": "zh-CN"}}}
{"pid": "P3132", "type": "P", "difficulty": 5, "samples": [["5\n8\n10\n3\n11\n1", "3.0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "贪心", "2016", "二分", "USACO", "单调队列"], "title": "[USACO16JAN] Angry Cows G", "background": "", "description": "Bessie the cow has designed what she thinks will be the next big hit video game: \"Angry Cows\".  The premise,  which she believes is completely original, is that the player shoots a cow with a slingshot  into a one-dimensional scene consisting of a set of hay bales located at various points on a number line; the cow lands with sufficient force to detonate the hay bales in close proximity to her landing site, which in turn might set of a chain reaction that causes additional hay bales to explode.  The goal is to use a single cow to start a chain reaction that detonates all the hay bales.\n\nThere are $N$ hay bales located at distinct integer positions $x_1, x_2, \\ldots, x_N$ on the number line.  If a cow is launched with power $R$ landing at position $x$, this will causes a blast of \"radius $R$\", engulfing all hay bales within the range $x-R \\ldots x+R$.  These hay bales then themselves explode (all simultaneously), each with a blast radius of $R-1$.  Any not-yet-exploded bales caught in these blasts then all explode (all simultaneously) with blast radius $R-2$, and so on.\n\nPlease determine the minimum amount of power $R$ with which a single cow may be launched so that, if it lands at an appropriate location, it will cause subsequent detonation of every single hay bale in the scene.", "inputFormat": "The first line of input contains $N$ ($2 \\leq N \\leq 50,000$).  The remaining\n\n$N$ lines all  contain integers $x_1 \\ldots x_N$ (each in the range $0 \\ldots 1,000,000,000$).\n", "outputFormat": "Please output the minimum power $R$ with which a cow must be launched in order to detonate all the hay bales.  Answers should be rounded and printed to exactly 1 decimal point.\n", "hint": "In this example, a cow launched with power 3 at, say, location 5, will cause immediate detonation of  hay bales at positions 3 and 8. These then explode (simultaneously) each with blast radius 2, engulfing bales at positions 1 and 10, which next explode (simultaneously) with blast radius 1, engulfing the final bale at position 11, which finally explodes with blast radius 0.", "locale": "en", "translations": {"en": {"title": "[USACO16JAN] Angry Cows G", "background": "", "description": "Bessie the cow has designed what she thinks will be the next big hit video game: \"Angry Cows\".  The premise,  which she believes is completely original, is that the player shoots a cow with a slingshot  into a one-dimensional scene consisting of a set of hay bales located at various points on a number line; the cow lands with sufficient force to detonate the hay bales in close proximity to her landing site, which in turn might set of a chain reaction that causes additional hay bales to explode.  The goal is to use a single cow to start a chain reaction that detonates all the hay bales.\n\nThere are $N$ hay bales located at distinct integer positions $x_1, x_2, \\ldots, x_N$ on the number line.  If a cow is launched with power $R$ landing at position $x$, this will causes a blast of \"radius $R$\", engulfing all hay bales within the range $x-R \\ldots x+R$.  These hay bales then themselves explode (all simultaneously), each with a blast radius of $R-1$.  Any not-yet-exploded bales caught in these blasts then all explode (all simultaneously) with blast radius $R-2$, and so on.\n\nPlease determine the minimum amount of power $R$ with which a single cow may be launched so that, if it lands at an appropriate location, it will cause subsequent detonation of every single hay bale in the scene.", "inputFormat": "The first line of input contains $N$ ($2 \\leq N \\leq 50,000$).  The remaining\n\n$N$ lines all  contain integers $x_1 \\ldots x_N$ (each in the range $0 \\ldots 1,000,000,000$).\n", "outputFormat": "Please output the minimum power $R$ with which a cow must be launched in order to detonate all the hay bales.  Answers should be rounded and printed to exactly 1 decimal point.\n", "hint": "In this example, a cow launched with power 3 at, say, location 5, will cause immediate detonation of  hay bales at positions 3 and 8. These then explode (simultaneously) each with blast radius 2, engulfing bales at positions 1 and 10, which next explode (simultaneously) with blast radius 1, engulfing the final bale at position 11, which finally explodes with blast radius 0.", "locale": "en"}, "zh-CN": {"title": "[USACO16JAN] Angry Cows G", "background": "", "description": "奶牛 Bessie 设计了一款她认为将成为下一个热门视频游戏的游戏：“愤怒的奶牛”。她认为这个游戏的设定是完全原创的：玩家用弹弓将一头奶牛射入一个一维场景中，场景由数轴上不同位置的干草堆组成；奶牛以足够的力量落地，引爆她着陆点附近的干草堆，这可能会引发连锁反应，导致更多的干草堆爆炸。目标是用一头奶牛引发连锁反应，引爆所有干草堆。\n\n有 $N$ 个干草堆位于数轴上不同的整数位置 $x_1, x_2, \\ldots, x_N$。如果一头奶牛以威力 $R$ 被发射到位置 $x$，这将引发一个“半径为 $R$”的爆炸，吞噬 $x-R \\ldots x+R$ 范围内的所有干草堆。这些干草堆随后会同时爆炸，每个爆炸的半径为 $R-1$。任何尚未爆炸的干草堆如果被这些爆炸波及，则会同时爆炸，爆炸半径为 $R-2$，依此类推。\n\n请确定发射一头奶牛所需的最小威力 $R$，使得如果它落在适当的位置，将引发所有干草堆的爆炸。", "inputFormat": "输入的第一行包含 $N$（$2 \\leq N \\leq 50,000$）。接下来的 $N$ 行每行包含一个整数 $x_1 \\ldots x_N$（每个整数都在 $0 \\ldots 1,000,000,000$ 范围内）。", "outputFormat": "请输出发射奶牛所需的最小威力 $R$，以便引爆所有干草堆。答案应四舍五入并精确到小数点后一位。", "hint": "在这个例子中，一头奶牛以威力 $3$ 发射到位置 $5$，将立即引爆位置 $3$ 和 $8$ 的干草堆。这些干草堆随后同时爆炸，每个爆炸的半径为 $2$，吞噬位置 $1$ 和 $10$ 的干草堆，这些干草堆接下来同时爆炸，爆炸半径为 $1$，吞噬位置 $11$ 的最后一个干草堆，该干草堆最终以爆炸半径 $0$ 爆炸。", "locale": "zh-CN"}}}
{"pid": "P3133", "type": "P", "difficulty": 3, "samples": [["2 7\n3 0\n5 0\nNN\nNWWWWWN", "28"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2016", "USACO"], "title": "[USACO16JAN] Radio Contact G", "background": "", "description": "Farmer John has lost his favorite cow bell, and Bessie the cow has agreed to help him find it!  They both fan out and search the farm along different paths, but stay in contact via radio so they can keep in touch with each-other. Unfortunately, the batteries in their radios are running low, so they want to plan their movements so as to conserve power, by trying to stay always within a short distance apart.\n\nFarmer John starts at location ($f_x, f_y$) and plans to follow a path consisting of  $N$ steps, each of which is either 'N' (north), 'E' (east), 'S' (south), or 'W' west.  Bessie starts at location ($b_x, b_y$) and follows a similar path consisting of $M$ steps.  Both paths may share points in common.  At each time step, Farmer John can either stay put at his current location, or take one step forward along his path, in whichever direction happens to be next (assuming he has not yet reached the final location in his path). Bessie can make a similar choice.  At each time step (excluding the first step where they start at their initial locations), their radios consume energy equal to the square of the distance between them.\n\nPlease help FJ and Bessie plan a joint movement strategy  that will minimize the total amount of energy consumed up to and including the final step where both of them first reach the final locations on their respective paths.", "inputFormat": "The first line of input contains $N$ and $M$ ($1 \\leq N, M \\leq 1000$). The second line contains integers $f_x$ and $f_y$, and the third line contains $b_x$ and $b_y$ ($0 \\leq f_x, f_y, b_x, b_y \\leq 1000$). The next line contains a string of length $N$ describing FJ's path, and the final line contains a string of length $M$ describing Bessie's path.\n\nIt is guranteed that Farmer John and Bessie's coordinates are always in the range ($0 \\leq x,y \\leq 1000$) throughout their journey. Note that East points in the positive x direction and North points in the positive y direction.", "outputFormat": "Output a single integer specifying the minimum energy FJ and Bessie can use during their travels.", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO16JAN] Radio Contact G", "background": "", "description": "Farmer John has lost his favorite cow bell, and Bessie the cow has agreed to help him find it!  They both fan out and search the farm along different paths, but stay in contact via radio so they can keep in touch with each-other. Unfortunately, the batteries in their radios are running low, so they want to plan their movements so as to conserve power, by trying to stay always within a short distance apart.\n\nFarmer John starts at location ($f_x, f_y$) and plans to follow a path consisting of  $N$ steps, each of which is either 'N' (north), 'E' (east), 'S' (south), or 'W' west.  Bessie starts at location ($b_x, b_y$) and follows a similar path consisting of $M$ steps.  Both paths may share points in common.  At each time step, Farmer John can either stay put at his current location, or take one step forward along his path, in whichever direction happens to be next (assuming he has not yet reached the final location in his path). Bessie can make a similar choice.  At each time step (excluding the first step where they start at their initial locations), their radios consume energy equal to the square of the distance between them.\n\nPlease help FJ and Bessie plan a joint movement strategy  that will minimize the total amount of energy consumed up to and including the final step where both of them first reach the final locations on their respective paths.", "inputFormat": "The first line of input contains $N$ and $M$ ($1 \\leq N, M \\leq 1000$). The second line contains integers $f_x$ and $f_y$, and the third line contains $b_x$ and $b_y$ ($0 \\leq f_x, f_y, b_x, b_y \\leq 1000$). The next line contains a string of length $N$ describing FJ's path, and the final line contains a string of length $M$ describing Bessie's path.\n\nIt is guranteed that Farmer John and Bessie's coordinates are always in the range ($0 \\leq x,y \\leq 1000$) throughout their journey. Note that East points in the positive x direction and North points in the positive y direction.", "outputFormat": "Output a single integer specifying the minimum energy FJ and Bessie can use during their travels.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO16JAN] Radio Contact G", "background": "", "description": "FJ 失去了他最喜欢的牛铃，而 Bessie 已经同意帮助他找到它！他们用不同的路径搜索农场，通过无线电保持联系。\n\n不幸的是，无线电中的电池电量不足，所以他们设法尽可能保持两者位置的距离最小，以节省电量。\n\nFJ 从位置$(f_x,f_y)$ 开始，并计划遵循由 $N$ 步组成的路径.Bessie 从位置 $(b_x,b_y)$ 开始，并遵循由 $M$ 步组成的路径。每个步骤都是 `N`（北），`E`（东），`S`（南），或`W`（西）。其中，东方向为 $x$ 轴正方向，北方向为 $y$ 轴正方向。两个路径可以经过相同的点。\n\n在每个时间段，FJ 可以不移动，也可以沿着他的道路前进一步。无论哪个方向恰好在下一个（假设他还没有到达他的路径的最后位置）。Bessie 可以做出类似的选择。\n\n在每个时间点（不包括从初始位置开始的第一步），他们的无线电消耗的能量等于它们之间距离的平方。\n\n请帮助 FJ 和 Bessie 计划行动策略，使双方达到各自终点时，最大限度地减少消耗的能量总量。输出所消耗的最小的能量。", "inputFormat": "第一行两个整数 $N$ 和 $M$ $(1\\le N,M\\le 1000)$。\n\n第二行两个整数 $f_x$ 和 $f_y$。\n\n第三行两个整数 $b_x$ 和 $b_y$ $(0\\le f_x,f_y,b_x,b_y\\le 1000)$。\n\n下一行为一个长度为 $N$ 的字符串，描述 FJ 的路径。\n\n最后一行为一个长度 $M$ 的字符串，描述 Bessie 的路径。", "outputFormat": "共一行一个整数，表示最小能量。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3134", "type": "P", "difficulty": 4, "samples": [["4\n0 0\n0 10\n1 10\n1 0", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2016", "USACO", "哈希 hashing"], "title": "[USACO16JAN] Lights Out G", "background": "", "description": "Farmer John has installed a fancy new milking machine in his barn, but it draws so much power that it occasionally causes the power to go out! This happens so often that Bessie has memorized a map of the barn, making it easier for her to find the exit of the barn in the dark. She is curious though about the impact of power loss on her ability to exit the barn quickly. For example, she wonders how much farther she might need to walk find the exit in the dark.\n\n\nThe barn is described by a simple (non self-intersecting) polygon with integer  vertices $(x_1, y_1) \\ldots (x_n, y_n)$ listed in clockwise order.  Its edges alternate between horizontal (parallel to the x-axis) and vertical (parallel to the y-axis); the first edge can be of either type. The exit is located at\n\n$(x_1, y_1)$.  Bessie starts inside the barn located at some vertex  $(x_i, y_i)$ for $i > 1$.  She can walk only around the perimeter of the barn, either clockwise or counterclockwise, Her goal is to travel a minimum distance to reach the exit. This is relatively easy to do with the lights on, of course, since she will travel either  clockwise or counterclockwise from her current location to the  exit -- whichever direction is shorter.\n\n\nOne day, the lights go out, causing Bessie to panic and forget which vertex she is standing at.  Fortunately, she still remembers the exact map of the barn, so she can possibly figure out her position by walking around and using her sense of touch.  Whenever she is standing at a vertex (including at her initial vertex), she can feel the exact interior angle at that vertex, and she can tell if that vertex is the exit.  When she walks along an edge of the barn, she can determine the exact length of the edge after walking along the entire edge.  Bessie decides on the following strategy: she will move clockwise around the perimeter of the barn until she has felt enough angles and edges to deduce the vertex at which she is currently located.  At that point, she can easily figure out how to get to the exit by traveling a minimum amount of remaining distance, either by continuing to move clockwise or by switching direction and moving counter-clockwise.\n\n\nPlease help Bessie determine the largest amount by which her travel distance will increase in the worst case (over all possibilities for her starting vertex) for travel in the dark versus in a lit barn.\n", "inputFormat": "The first line of the input contains $N$ ($4 \\leq N \\leq 200$).  Each of the next $N$ lines contains two integers, describing the points $(x_i, y_i)$ in clockwise order around the barn.  These integers are in the range $-100,000 \\ldots 100,000$.\n", "outputFormat": "Output the largest amount that Bessie's travel distance will increase in the\n\nworst case starting position using the strategy in the problem statement.\n", "hint": "In this example, Bessie can feel that she is initially standing at a 90-degree angle, but she cannot tell if she is initially standing at vertex 2, 3, or 4.\n\nAfter taking a step along one edge in the clockwise direction, Bessie either reaches the exit or can uniquely determine her location based on the length of this edge. The distances she obtains are:\n\nIf starting at vertex 2: she travels 12 units in the dark (1 unit to reach vertex 3, then 11 units to continue to the exit). She only needs to travel 10 units in a lit barn. This is an extra distance of 2 for this vertex.\n\nIf starting at vertex 3: she travels 11 units in both cases.\n\nIf starting at vertex 4: she travels 1 unit in both cases.\n\nThe worst-case difference over all starting points is therefore 12 - 10 = 2.  That is, Bessie can guarantee that using her strategy, no matter where she starts, she will travel at most 2 extra units of distance farther in the dark than in the light.\n", "locale": "en", "translations": {"en": {"title": "[USACO16JAN] Lights Out G", "background": "", "description": "Farmer John has installed a fancy new milking machine in his barn, but it draws so much power that it occasionally causes the power to go out! This happens so often that Bessie has memorized a map of the barn, making it easier for her to find the exit of the barn in the dark. She is curious though about the impact of power loss on her ability to exit the barn quickly. For example, she wonders how much farther she might need to walk find the exit in the dark.\n\n\nThe barn is described by a simple (non self-intersecting) polygon with integer  vertices $(x_1, y_1) \\ldots (x_n, y_n)$ listed in clockwise order.  Its edges alternate between horizontal (parallel to the x-axis) and vertical (parallel to the y-axis); the first edge can be of either type. The exit is located at\n\n$(x_1, y_1)$.  Bessie starts inside the barn located at some vertex  $(x_i, y_i)$ for $i > 1$.  She can walk only around the perimeter of the barn, either clockwise or counterclockwise, Her goal is to travel a minimum distance to reach the exit. This is relatively easy to do with the lights on, of course, since she will travel either  clockwise or counterclockwise from her current location to the  exit -- whichever direction is shorter.\n\n\nOne day, the lights go out, causing Bessie to panic and forget which vertex she is standing at.  Fortunately, she still remembers the exact map of the barn, so she can possibly figure out her position by walking around and using her sense of touch.  Whenever she is standing at a vertex (including at her initial vertex), she can feel the exact interior angle at that vertex, and she can tell if that vertex is the exit.  When she walks along an edge of the barn, she can determine the exact length of the edge after walking along the entire edge.  Bessie decides on the following strategy: she will move clockwise around the perimeter of the barn until she has felt enough angles and edges to deduce the vertex at which she is currently located.  At that point, she can easily figure out how to get to the exit by traveling a minimum amount of remaining distance, either by continuing to move clockwise or by switching direction and moving counter-clockwise.\n\n\nPlease help Bessie determine the largest amount by which her travel distance will increase in the worst case (over all possibilities for her starting vertex) for travel in the dark versus in a lit barn.\n", "inputFormat": "The first line of the input contains $N$ ($4 \\leq N \\leq 200$).  Each of the next $N$ lines contains two integers, describing the points $(x_i, y_i)$ in clockwise order around the barn.  These integers are in the range $-100,000 \\ldots 100,000$.\n", "outputFormat": "Output the largest amount that Bessie's travel distance will increase in the\n\nworst case starting position using the strategy in the problem statement.\n", "hint": "In this example, Bessie can feel that she is initially standing at a 90-degree angle, but she cannot tell if she is initially standing at vertex 2, 3, or 4.\n\nAfter taking a step along one edge in the clockwise direction, Bessie either reaches the exit or can uniquely determine her location based on the length of this edge. The distances she obtains are:\n\nIf starting at vertex 2: she travels 12 units in the dark (1 unit to reach vertex 3, then 11 units to continue to the exit). She only needs to travel 10 units in a lit barn. This is an extra distance of 2 for this vertex.\n\nIf starting at vertex 3: she travels 11 units in both cases.\n\nIf starting at vertex 4: she travels 1 unit in both cases.\n\nThe worst-case difference over all starting points is therefore 12 - 10 = 2.  That is, Bessie can guarantee that using her strategy, no matter where she starts, she will travel at most 2 extra units of distance farther in the dark than in the light.\n", "locale": "en"}, "zh-CN": {"title": "[USACO16JAN] Lights Out G", "background": "", "description": "Farmer John 在他的谷仓里安装了一个非常不错的新挤奶机，但是这台挤奶机耗电太多了，有时候会让谷仓直接停电！这种事发生的太频繁了，以至于 Bessie 直接把谷仓的地图背过了，以便于可以在黑暗中找到谷仓的出口。她对于停电对于她快速离开谷仓的能力的影响非常好奇。比如说，她想知道她在黑暗中需要走多远来找到谷仓的出口。\n\n谷仓里的路可以被描述为是一个简单的用几个顶点来表示的多边形，这些顶点可以按照顺时针被表示为 $(x_1, y_1) \\cdots (x_n, y_n)$（保证这些顶点连成的线没有交叉的情况）。这些点构成的边在水平轴（平行于 $x$ 轴）和竖直轴（平行于 $y$ 轴）之间交替出现。第一条边可以是任意一种类型。谷仓出口在坐标 $(x_1, y_1)$ 。Bessie 从谷仓内任意一个点 $(x_i, y_i)$ 开始走。她只可以沿着这些边走，要不然是顺时针，要不然就是逆时针，她的目标就是以最短距离抵达出口。当然，如果灯亮着的话这个事还算相对简单，因为她要不然顺时针要不然逆时针走，无所谓哪个方向的路程更短一点。\n\n一天，谷仓突然停电了，导致 Bessie 受到惊吓、忘记了她站在哪个顶点。幸亏她还记得谷仓的准确地图，所以她可以四处走走，用她的触觉来弄清楚她的位置。不管什么时候，只要她站在一个顶点，那么她就可以感受到她在这个点的朝向角度，弄清楚这个点是不是出口。当她沿着谷仓的一个边走完的时候，她可以算出精确的边长。Bessie 决定用这么一个策略：她会顺时针沿着谷仓周围的边走，直到她知道了足够的角度和边、可以推断出她目前在的是哪个顶点。在那个顶点，她就可以轻易地弄清楚怎样以最短距离到达出口（要不然继续沿着顺时针走，要不然倒回去沿着逆时针走）。\n\n请帮助 Bessie 算出在起点可以是任何一个顶点情况下，在最坏的情况下，她在黑暗中和亮着灯的时候到达出口的距离的差值（即找到差值的最大值）。", "inputFormat": "第一行包括一个数字 $N (4 \\leqslant N \\leqslant 200)$ ，接下来 $N$ 行，每行包括两个数字，沿着顺时针表示顶点 $(x_i, y_i)$，$x_i, y_i \\in [-10^5, 10^5]$ 。", "outputFormat": "输出 Bessie 在最坏的情况下，她在黑暗中和亮着灯的时候到达出口的距离的差值（即找到差值的最大值）。", "hint": "在这个样例中，Bessie 开始可以感觉到她沿着 $90 \\degree$ 角站着，但是她辨别不出来她是在 $2, 3, 4$ 中的哪一个顶点。\n\n在走了一条边以后，Bessie 要不然到了出口要不然就可以根据她走过的距离推断出她的位置。情况如下：\n\n如果她从 $2$ 号点开始走，她需要在黑暗中走 $12$ 个单位，包括一个单位到达第三个点、十一个单位离开谷仓。同时，如果亮着灯，她可以只走 $10$ 个单位就离开谷仓。差值是 $2$ 。\n\n如果从 $3$ 号点开始，她两种情况都要走 $11$ 个单位。\n\n如果从 $4$ 号点开始，她两种情况都要走 $1$ 个单位。\n\n所以最坏情况差值是 $2$ 。", "locale": "zh-CN"}}}
{"pid": "P3135", "type": "P", "difficulty": 3, "samples": [["5 6\n......\n..X..X\nX..X..\n......\n..X...", "16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2016", "USACO", "枚举"], "title": "[USACO16JAN] Fort Moo P", "background": "", "description": "Bessie is building a fort with her friend Elsie. Like any good fort, this one needs to start with a sturdy frame. Bessie wants to build a frame in the shape of a one-meter-wide rectangular outline, atop which she will build the fort.\n\nBessie has already chosen a site on which to build the fort -- a piece of land measuring $N$ meters by $M$ meters ($1 \\leq N, M \\leq 200$). Unfortunately, the  site has some swampy areas that cannot be used to support the frame.  Please help Bessie determine the largest area she can cover with her fort (the area of the rectangle supported by the frame), such that the frame avoids sitting on any of the swampy areas.", "inputFormat": "Line 1 contains integers $N$ and $M$.\n\nThe next $N$ lines each contain $M$ characters, forming a grid describing the site.  A character of '.' represents normal grass, while 'X' represents a swampy spot.", "outputFormat": "A single integer representing the maximum area that Bessie can cover with her fort.", "hint": "In the example, the placement of the optimal frame is indicated by 'f's below:\n\n```cpp\n.ffff.\n.fX.fX\nXf.Xf.\n.ffff.\n..X...\n```", "locale": "en", "translations": {"en": {"title": "[USACO16JAN] Fort Moo P", "background": "", "description": "Bessie is building a fort with her friend Elsie. Like any good fort, this one needs to start with a sturdy frame. Bessie wants to build a frame in the shape of a one-meter-wide rectangular outline, atop which she will build the fort.\n\nBessie has already chosen a site on which to build the fort -- a piece of land measuring $N$ meters by $M$ meters ($1 \\leq N, M \\leq 200$). Unfortunately, the  site has some swampy areas that cannot be used to support the frame.  Please help Bessie determine the largest area she can cover with her fort (the area of the rectangle supported by the frame), such that the frame avoids sitting on any of the swampy areas.", "inputFormat": "Line 1 contains integers $N$ and $M$.\n\nThe next $N$ lines each contain $M$ characters, forming a grid describing the site.  A character of '.' represents normal grass, while 'X' represents a swampy spot.", "outputFormat": "A single integer representing the maximum area that Bessie can cover with her fort.", "hint": "In the example, the placement of the optimal frame is indicated by 'f's below:\n\n```cpp\n.ffff.\n.fX.fX\nXf.Xf.\n.ffff.\n..X...\n```", "locale": "en"}, "zh-CN": {"title": "[USACO16JAN] Fort Moo P", "background": "", "description": "Bessie 正在和她的朋友 Elsie 一起建造一个堡垒。像任何好的堡垒一样，这个堡垒需要一个坚固的框架。Bessie 想要建造一个一米宽的矩形轮廓框架，然后在这个框架上建造堡垒。\n\nBessie 已经选择了一个建造堡垒的地点——一块 $N$ 米乘 $M$ 米的土地（$1 \\leq N, M \\leq 200$）。不幸的是，这块地有一些沼泽区域，不能用来支撑框架。请帮助 Bessie 确定她可以用堡垒覆盖的最大面积（由框架支撑的矩形的面积），使得框架不会坐落在任何沼泽区域上。", "inputFormat": "第 1 行包含整数 $N$ 和 $M$。\n\n接下来的 $N$ 行每行包含 $M$ 个字符，形成一个描述地点的网格。字符 '.' 表示普通草地，而 'X' 表示沼泽区域。", "outputFormat": "一个整数，表示 Bessie 可以用堡垒覆盖的最大面积。", "hint": "在示例中，最优框架的位置由下面的 `f` 表示：\n\n```\n.ffff.\n.fX.fX\nXf.Xf.\n.ffff.\n..X...\n```", "locale": "zh-CN"}}}
{"pid": "P3136", "type": "P", "difficulty": 5, "samples": [["7 4\n0 10\n10 10\n10 5\n3 5\n3 12\n6 12\n6 3", "1"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2016", "USACO", "cdq 分治"], "title": "[USACO16JAN] Mowing the Field P", "background": "", "description": "Farmer John is quite reliable in all aspects of managing his farm, except one: he is terrible at mowing the grass in a timely fashion.   He only manages to move the mowing machine once per day, in fact. On day 1, he starts at position $(x_1, y_1)$ and on day $d$ he mows along a straight segment to the position $(x_d, y_d)$, moving either horizontally or vertically on the 2D map of his farm; that is, either  $x_d = x_{d-1}$, or $y_d = y_{d-1}$.  FJ alternates between horizontal and vertical moves on successive days.\n\n\nSo slow is FJ's progress that some of the grass he mows might grow back before he is finished with all his mowing. Any section of grass that is cut in day $d$ will reappear on day $d + T$, so if FJ's mowing path crosses a path he cut at least $T$ days earlier, he will end up cutting grass at the same point again.  In an effort to try and reform his poor mowing strategy, FJ would like to count the number of times this happens.\n\nPlease count the number of times FJ's mowing path crosses over an earlier segment on which grass has already grown back.  You should only count \"perpendicular\" crossings, defined as a point in common between a horizontal and a vertical segment that is an endpoint of neither.", "inputFormat": "The first line of input contains $N$ ($2 \\leq N \\leq 100,000$) and $T$ ($1 \\leq T \\leq N$, $T$ even).\n\nThe next $N$ lines describe the position of the mower on days $1 \\ldots N$.  The $i$-th of these lines contains integers $x_i$ and $y_i$ (nonnegative integers each at most 1,000,000,000).\n", "outputFormat": "Please output a count of the number of crossing points described above, where FJ re-cuts a point of grass that had grown back after being cut earlier.\n", "hint": "Here, FJ crosses on day 7 a segment of grass he cut on day 2, which counts. The other intersections do not count.\n\nNote: This problem has expanded limits: 5 seconds per test case (10 for Python and Java), and 512 MB of memory.\n", "locale": "en", "translations": {"en": {"title": "[USACO16JAN] Mowing the Field P", "background": "", "description": "Farmer John is quite reliable in all aspects of managing his farm, except one: he is terrible at mowing the grass in a timely fashion.   He only manages to move the mowing machine once per day, in fact. On day 1, he starts at position $(x_1, y_1)$ and on day $d$ he mows along a straight segment to the position $(x_d, y_d)$, moving either horizontally or vertically on the 2D map of his farm; that is, either  $x_d = x_{d-1}$, or $y_d = y_{d-1}$.  FJ alternates between horizontal and vertical moves on successive days.\n\n\nSo slow is FJ's progress that some of the grass he mows might grow back before he is finished with all his mowing. Any section of grass that is cut in day $d$ will reappear on day $d + T$, so if FJ's mowing path crosses a path he cut at least $T$ days earlier, he will end up cutting grass at the same point again.  In an effort to try and reform his poor mowing strategy, FJ would like to count the number of times this happens.\n\nPlease count the number of times FJ's mowing path crosses over an earlier segment on which grass has already grown back.  You should only count \"perpendicular\" crossings, defined as a point in common between a horizontal and a vertical segment that is an endpoint of neither.", "inputFormat": "The first line of input contains $N$ ($2 \\leq N \\leq 100,000$) and $T$ ($1 \\leq T \\leq N$, $T$ even).\n\nThe next $N$ lines describe the position of the mower on days $1 \\ldots N$.  The $i$-th of these lines contains integers $x_i$ and $y_i$ (nonnegative integers each at most 1,000,000,000).\n", "outputFormat": "Please output a count of the number of crossing points described above, where FJ re-cuts a point of grass that had grown back after being cut earlier.\n", "hint": "Here, FJ crosses on day 7 a segment of grass he cut on day 2, which counts. The other intersections do not count.\n\nNote: This problem has expanded limits: 5 seconds per test case (10 for Python and Java), and 512 MB of memory.\n", "locale": "en"}, "zh-CN": {"title": "[USACO16JAN] Mowing the Field P", "background": null, "description": "Farmer John 在管理农场的各个方面都相当可靠，除了一件事：他非常不擅长及时修剪草地。事实上，他每天只能移动一次割草机。在第 1 天，他从位置 $(x_1, y_1)$ 开始，在第 $d$ 天，他沿着一条直线段移动到位置 $(x_d, y_d)$，在农场的二维地图上，他要么水平移动，要么垂直移动；也就是说，要么 $x_d = x_{d-1}$，要么 $y_d = y_{d-1}$。FJ 在连续的日子里交替进行水平和垂直移动。\n\nFJ 的进展非常缓慢，以至于在他完成所有修剪之前，一些被他修剪过的草可能会重新长出来。任何在第 $d$ 天被修剪的草会在第 $d + T$ 天重新长出来，因此如果 FJ 的修剪路径与至少 $T$ 天前修剪过的路径交叉，他将再次在同一位置修剪草地。为了尝试改进他糟糕的修剪策略，FJ 想要计算这种情况发生的次数。\n\n请计算 FJ 的修剪路径与之前已经重新长草的路径交叉的次数。你只需计算“垂直”交叉，定义为水平线段和垂直线段之间的共同点，且该点不是任何线段的端点。\n\n\n----------------------------\n\n### 形式化题意\n\n现给出 $n$ 个点，其中，第 $i$ 个点和第 $i+1$ 个点相连必定构成一条水平或竖直的线段，记为线段 $i$。显然线段 $i$ 必定与线段 $i+1$ 共用一个端点。\n\n额外保证线段 $i$ 必定与线段 $i+1$ 垂直。\n\n对于某条线段 $d$，你需要统计出线段 $1\\cdots d-T$ 中有多少条与线段 $d$ 相交且垂直，记为 $f_d$。\n\n输出 $ans$，其中 $ans=\\sum_{i=1}^{n-1} f_i$。", "inputFormat": "输入的第一行包含 $N$（$2 \\leq N \\leq 100,000$）和 $T$（$1 \\leq T \\leq N$，$T$ 为偶数）。\n\n接下来的 $N$ 行描述了割草机在第 $1$ 到第 $N$ 天的位置。第 $i$ 行包含整数 $x_i$ 和 $y_i$（每个为非负整数，且不超过 $1,000,000,000$）。", "outputFormat": "请输出上述交叉点的数量，即 FJ 重新修剪已经重新长草的点的次数。", "hint": "在这里，FJ 在第 7 天与他在第 2 天修剪的草地路径交叉，这算作一次。其他交叉点不算。\n\n注意：本题有扩展的限制：每个测试用例 5 秒（Python 和 Java 为 10 秒），内存限制为 512 MB。", "locale": "zh-CN"}}}
{"pid": "P3137", "type": "P", "difficulty": 4, "samples": [["10\n1\n0\n0\n2\n0\n0\n1\n2\n2\n2", "33"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2016", "USACO", "枚举"], "title": "[USACO16FEB] Circular Barn S", "background": "*本题与 [金组同名题目](/problem/P6170) 在题意上一致，唯一的差别是数据范围。*", "description": "作为当代建筑的爱好者，Farmer John 建造了一个圆形新谷仓，谷仓内部 $n$ 个房间排成环形（$3 \\leq n \\leq 1000$），按顺时针顺序编号为 $1\\ldots n$，每个房间都有通往与其相邻的左右房间的门，还有一扇门通往外面。\n\n现在 FJ 有 $n$ 头奶牛，他的目标是让每个房间恰好有一头奶牛。然而不幸的是，现在奶牛们随意呆在某个房间里，第 $i$ 个房间里有 $c_i$ 头奶牛。保证 $\\sum c_i =n$。\n\nFJ 决定采用这样的方法来解决这个问题：让某些奶牛**顺时针**穿过某些房间到达指定的位置。如果一头奶牛穿过了 $d$ 扇门，他消耗的能量为 $d^2$。你需要帮 FJ 算出所有奶牛消耗的能量和最小值是多少。", "inputFormat": "第一行一个整数 $n$，接下来 $n$ 行，第 $i$ 行一个整数 $c_i$。", "outputFormat": "输出所有奶牛最小消耗能量和。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[USACO16FEB] Circular Barn S", "background": "*This problem has the same statement as the [problem with the same name in Gold](/problem/P6170); the only difference is the constraints.*", "description": "As an enthusiast of modern architecture, Farmer John built a new circular barn. Inside the barn, $n$ rooms are arranged in a ring ($3 \\leq n \\leq 1000$), numbered in clockwise order $1\\ldots n$. Each room has doors to its two adjacent rooms, as well as a door to the outside.\n\nFJ has $n$ cows, and his goal is to have exactly one cow in each room. Unfortunately, the cows are currently scattered arbitrarily: room $i$ contains $c_i$ cows. It is guaranteed that $\\sum c_i =n$.\n\nFJ decides to solve this by letting some cows move **clockwise** through rooms to their designated positions. If a cow passes through $d$ doors, it expends $d^2$ energy. You need to compute the minimal possible total energy expended by all cows.", "inputFormat": "The first line contains an integer $n$. The next $n$ lines each contain one integer $c_i$, where the $i$-th line contains $c_i$.", "outputFormat": "Output the minimal total energy expended by all cows.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO16FEB] Circular Barn S", "background": "*本题与 [金组同名题目](/problem/P6170) 在题意上一致，唯一的差别是数据范围。*", "description": "作为当代建筑的爱好者，Farmer John 建造了一个圆形新谷仓，谷仓内部 $n$ 个房间排成环形（$3 \\leq n \\leq 1000$），按顺时针顺序编号为 $1\\ldots n$，每个房间都有通往与其相邻的左右房间的门，还有一扇门通往外面。\n\n现在 FJ 有 $n$ 头奶牛，他的目标是让每个房间恰好有一头奶牛。然而不幸的是，现在奶牛们随意呆在某个房间里，第 $i$ 个房间里有 $c_i$ 头奶牛。保证 $\\sum c_i =n$。\n\nFJ 决定采用这样的方法来解决这个问题：让某些奶牛**顺时针**穿过某些房间到达指定的位置。如果一头奶牛穿过了 $d$ 扇门，他消耗的能量为 $d^2$。你需要帮 FJ 算出所有奶牛消耗的能量和最小值是多少。", "inputFormat": "第一行一个整数 $n$，接下来 $n$ 行，第 $i$ 行一个整数 $c_i$。", "outputFormat": "输出所有奶牛最小消耗能量和。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3138", "type": "P", "difficulty": 3, "samples": [["7\n7 3\n5 5\n7 13\n3 1\n11 7\n5 3\n9 1", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2016", "线段树", "USACO", "枚举", "前缀和"], "title": "[USACO16FEB] Load Balancing S", "background": "*本题与 [白金组同名题目](/problem/P6172) 在题意上一致，唯一的差别是数据范围。*", "description": "Farmer John 的 $N$ 头奶牛（$1 \\leq N \\leq 1000$）散布在整个农场上。整个农场是一个无限大的二维平面，第 $i$ 头奶牛的坐标是 $(x_i,y_i)$（保证 $x_i,y_i$ 均为正奇数，且 $x_i,y_i \\leq 10^6$），且没有任意两头奶牛在同一位置上。\n\nFJ 希望修建一条竖直方向的栅栏，它的方程是 $x=a$，他还希望修建一条水平方向的栅栏，它的方程是 $y=b$。为了防止栅栏经过奶牛，$a,b$ 均要求是偶数。容易发现，这两个栅栏会在 $(a,b)$ 处相交，将整个农场分割为四个区域。\n\nFJ 希望这四个区域内的奶牛数量较为均衡，尽量避免一个区域奶牛多而另一个区域奶牛少的情况。令 $M$ 为四个区域里奶牛最多区域的奶牛数量，请帮 FJ 求出 $M$ 的最小值。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行两个整数 $x_i,y_i$，描述第 $i$ 头奶牛的位置。", "outputFormat": "输出 $M$ 的最小值。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[USACO16FEB] Load Balancing S", "background": "*This problem has the same statement as the [problem with the same name in the Platinum division](/problem/P6172); the only difference is in the constraints.*", "description": "Farmer John has $N$ cows ($1 \\leq N \\leq 1000$) scattered across his farm. The farm is an infinite 2D plane, and the $i$-th cow is located at $(x_i, y_i)$ (it is guaranteed that $x_i$ and $y_i$ are positive odd integers, and $x_i, y_i \\leq 10^6$). No two cows are at the same position.\n\nFJ wants to build a vertical fence with equation $x = a$, and a horizontal fence with equation $y = b$. To ensure the fences do not pass through any cow, both $a$ and $b$ must be even. It is easy to see that these two fences intersect at $(a, b)$, partitioning the farm into four regions.\n\nFJ wants the number of cows in the four regions to be as balanced as possible, avoiding the situation where one region has many cows while another has few. Let $M$ be the maximum number of cows among the four regions. Please help FJ find the minimum possible value of $M$.", "inputFormat": "The first line contains an integer $N$.\n\nThe next $N$ lines each contain two integers $x_i, y_i$, describing the position of the $i$-th cow.", "outputFormat": "Output the minimum possible value of $M$.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO16FEB] Load Balancing S", "background": "*本题与 [白金组同名题目](/problem/P6172) 在题意上一致，唯一的差别是数据范围。*", "description": "Farmer John 的 $N$ 头奶牛（$1 \\leq N \\leq 1000$）散布在整个农场上。整个农场是一个无限大的二维平面，第 $i$ 头奶牛的坐标是 $(x_i,y_i)$（保证 $x_i,y_i$ 均为正奇数，且 $x_i,y_i \\leq 10^6$），且没有任意两头奶牛在同一位置上。\n\nFJ 希望修建一条竖直方向的栅栏，它的方程是 $x=a$，他还希望修建一条水平方向的栅栏，它的方程是 $y=b$。为了防止栅栏经过奶牛，$a,b$ 均要求是偶数。容易发现，这两个栅栏会在 $(a,b)$ 处相交，将整个农场分割为四个区域。\n\nFJ 希望这四个区域内的奶牛数量较为均衡，尽量避免一个区域奶牛多而另一个区域奶牛少的情况。令 $M$ 为四个区域里奶牛最多区域的奶牛数量，请帮 FJ 求出 $M$ 的最小值。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行两个整数 $x_i,y_i$，描述第 $i$ 头奶牛的位置。", "outputFormat": "输出 $M$ 的最小值。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3139", "type": "P", "difficulty": 3, "samples": [["14 50 2 32", "18"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2016", "USACO", "剪枝", "记忆化搜索"], "title": "[USACO16FEB] Milk Pails S", "background": "", "description": "Farmer John has received an order for exactly $M$ units of milk ($1 \\leq M \\leq 200$) that he needs to fill right away.  Unfortunately, his fancy milking machine has just become broken, and all he has are two milk pails of integer sizes $X$ and $Y$ ($1 \\leq X, Y \\leq 100$) with which he can measure milk.  Both pails are initially empty.  Using these two pails, he can perform up to $K$ of the following types of operations ($1 \\leq K \\leq 100$):\n\n- He can fill either pail completely to the top.\n\n- He can empty either pail.\n\n- He can pour the contents of one pail into the other, stopping when the former becomes empty or the latter becomes full (whichever of these happens first).\n\nAlthough FJ realizes he may not be able to end up with exactly $M$ total units of milk in the two pails, please help him compute the minimum amount of error between $M$ and the total amount of milk in the two pails.  That is, please compute the minimum value of $|M-M'|$ such that FJ can construct $M'$ units of milk collectively between the two pails.", "inputFormat": "The first, and only line of input, contains $X$, $Y$, $K$, and $M$.\n", "outputFormat": "Output the smallest distance from $M$ to an amount of milk FJ can produce.\n", "hint": "In two steps FJ can be left with the following quanities in his pails\n\n\n```cpp\n(0, 0) = 0 units\n(14, 0) = 14 units\n(0, 50) = 50 units\n(0, 14) = 14 units\n(14, 36) = 50 units\n(14, 50) = 64 units\n```\n\nThe closest we can come to 32 units is 14 for a difference of 18.  Note that it would require an extra step to pour out the first pail to end up with (0, 36).\n", "locale": "en", "translations": {"en": {"title": "[USACO16FEB] Milk Pails S", "background": "", "description": "Farmer John has received an order for exactly $M$ units of milk ($1 \\leq M \\leq 200$) that he needs to fill right away.  Unfortunately, his fancy milking machine has just become broken, and all he has are two milk pails of integer sizes $X$ and $Y$ ($1 \\leq X, Y \\leq 100$) with which he can measure milk.  Both pails are initially empty.  Using these two pails, he can perform up to $K$ of the following types of operations ($1 \\leq K \\leq 100$):\n\n- He can fill either pail completely to the top.\n\n- He can empty either pail.\n\n- He can pour the contents of one pail into the other, stopping when the former becomes empty or the latter becomes full (whichever of these happens first).\n\nAlthough FJ realizes he may not be able to end up with exactly $M$ total units of milk in the two pails, please help him compute the minimum amount of error between $M$ and the total amount of milk in the two pails.  That is, please compute the minimum value of $|M-M'|$ such that FJ can construct $M'$ units of milk collectively between the two pails.", "inputFormat": "The first, and only line of input, contains $X$, $Y$, $K$, and $M$.\n", "outputFormat": "Output the smallest distance from $M$ to an amount of milk FJ can produce.\n", "hint": "In two steps FJ can be left with the following quanities in his pails\n\n\n```cpp\n(0, 0) = 0 units\n(14, 0) = 14 units\n(0, 50) = 50 units\n(0, 14) = 14 units\n(14, 36) = 50 units\n(14, 50) = 64 units\n```\n\nThe closest we can come to 32 units is 14 for a difference of 18.  Note that it would require an extra step to pour out the first pail to end up with (0, 36).\n", "locale": "en"}, "zh-CN": {"title": "[USACO16FEB] Milk Pails S", "background": "", "description": "Farmer John 接到了一份需要立即完成的订单，要求他提供恰好 $M$ 单位的牛奶（$1 \\leq M \\leq 200$）。不幸的是，他先进的挤奶机刚刚坏了，现在他只有两个容量为整数 $X$ 和 $Y$（$1 \\leq X, Y \\leq 100$）的牛奶桶可以用来量取牛奶。两个桶最初都是空的。使用这两个桶，他可以执行最多 $K$ 次以下类型的操作（$1 \\leq K \\leq 100$）：\n\n- 他可以将任意一个桶完全装满。\n\n- 他可以将任意一个桶完全倒空。\n\n- 他可以将一个桶中的牛奶倒入另一个桶，直到前者被倒空或后者被装满（以先发生的情况为准）。\n\n尽管 FJ 意识到他可能无法最终在两个桶中得到恰好 $M$ 单位的牛奶，但请帮助他计算 $M$ 与两个桶中牛奶总量之间的最小误差。也就是说，请计算 $|M-M'|$ 的最小值，其中 $M'$ 是 FJ 可以在两个桶中共同构造的牛奶量。", "inputFormat": "输入的第一行也是唯一一行包含 $X$、$Y$、$K$ 和 $M$。", "outputFormat": "输出 $M$ 与 FJ 可以生产的牛奶量之间的最小误差。", "hint": "在两步操作中，FJ 可以在他的桶中留下以下数量的牛奶：\n\n```\n(0, 0) = 0 单位  \n(14, 0) = 14 单位  \n(0, 50) = 50 单位  \n(0, 14) = 14 单位  \n(14, 36) = 50 单位  \n(14, 50) = 64 单位  \n```\n\n最接近 32 单位的是 14 单位，误差为 18。注意，要倒空第一个桶以得到 (0, 36) 需要额外的步骤。", "locale": "zh-CN"}}}
{"pid": "P3140", "type": "P", "difficulty": 4, "samples": [["6 2\n2\n5\n4\n2\n6\n2", "14"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2016", "USACO"], "title": "[USACO16FEB] Circular Barn Revisited G", "background": "", "description": "After the last debacle involving Farmer John's circular barn, one would think he had learned his lesson about non-traditional architecture.  However, he thinks he can still make his circular barn (from the preceding problem) function properly by allowing multiple cows into each room.  To recap, the barn consists of a ring of $n$ rooms,  numbered clockwise from $1 \\ldots n$ around the perimeter of the barn ($3 \\leq n \\leq 100$).  Each room has doors to its two neighboring rooms, and also a door opening to the exterior of the barn.\n\nFarmer John wants exactly $r_i$ cows to end up in room $i$ ($1 \\leq r_i \\leq 1,000,000$). To herd the cows into the barn in an orderly fashion, he plans to unlock $k$ exterior doors ($1 \\leq k \\leq 7$), allowing the cows to enter through only those doors. Each cow then walks clockwise through the rooms until she reaches a suitable destination.  Farmer John wants to unlock the exterior doors that will cause his cows to collectively walk a minimum total amount of distance after entering the barn (they can initially line up however they like outside the $k$ unlocked doors; this does not contribute to the total distance in question).  Please determine the minimum total distance his cows will need to walk, if he chooses the best $k$ such doors to unlock.", "inputFormat": "The first line of input contains $n$ and $k$.  Each of the remaining $n$ lines contain $r_1 \\ldots r_n$.\n", "outputFormat": "Please write out the minimum amount of distance the cows need to travel.\n", "hint": "Farmer John can unlock doors 2 and 5.  11 cows enter at door 2 and walk a total distance of 8 to get to rooms 2, 3, and 4.  10 cows enter at door 5 and walk a total distance of 6 to get to rooms 5, 6 and 1.\n", "locale": "en", "translations": {"en": {"title": "[USACO16FEB] Circular Barn Revisited G", "background": "", "description": "After the last debacle involving Farmer John's circular barn, one would think he had learned his lesson about non-traditional architecture.  However, he thinks he can still make his circular barn (from the preceding problem) function properly by allowing multiple cows into each room.  To recap, the barn consists of a ring of $n$ rooms,  numbered clockwise from $1 \\ldots n$ around the perimeter of the barn ($3 \\leq n \\leq 100$).  Each room has doors to its two neighboring rooms, and also a door opening to the exterior of the barn.\n\nFarmer John wants exactly $r_i$ cows to end up in room $i$ ($1 \\leq r_i \\leq 1,000,000$). To herd the cows into the barn in an orderly fashion, he plans to unlock $k$ exterior doors ($1 \\leq k \\leq 7$), allowing the cows to enter through only those doors. Each cow then walks clockwise through the rooms until she reaches a suitable destination.  Farmer John wants to unlock the exterior doors that will cause his cows to collectively walk a minimum total amount of distance after entering the barn (they can initially line up however they like outside the $k$ unlocked doors; this does not contribute to the total distance in question).  Please determine the minimum total distance his cows will need to walk, if he chooses the best $k$ such doors to unlock.", "inputFormat": "The first line of input contains $n$ and $k$.  Each of the remaining $n$ lines contain $r_1 \\ldots r_n$.\n", "outputFormat": "Please write out the minimum amount of distance the cows need to travel.\n", "hint": "Farmer John can unlock doors 2 and 5.  11 cows enter at door 2 and walk a total distance of 8 to get to rooms 2, 3, and 4.  10 cows enter at door 5 and walk a total distance of 6 to get to rooms 5, 6 and 1.\n", "locale": "en"}, "zh-CN": {"title": "[USACO16FEB] Circular Barn Revisited G", "background": "", "description": "在上一次涉及 Farmer John 的圆形谷仓的惨败之后，人们可能会认为他已经吸取了关于非传统建筑的教训。然而，他认为通过允许每间房间进入多头奶牛，仍然可以让他那个圆形谷仓（来自之前的问题）正常运作。回顾一下，谷仓由 $n$ 个房间组成，这些房间顺时针编号为 $1 \\ldots n$，围绕谷仓的周边排列（$3 \\leq n \\leq 100$）。每个房间都有通往两个相邻房间的门，还有一扇门通向谷仓的外部。\n\nFarmer John 希望最终有恰好 $r_i$ 头奶牛进入房间 $i$（$1 \\leq r_i \\leq 1,000,000$）。为了让奶牛有序地进入谷仓，他计划解锁 $k$ 扇外部门（$1 \\leq k \\leq 7$），只允许奶牛通过这些门进入。每头奶牛随后顺时针穿过房间，直到到达合适的目的地。Farmer John 希望解锁那些能让他的奶牛在进入谷仓后总共行走的距离最小的外部门（它们最初可以在 $k$ 扇解锁的门外任意排列；这不会计入总距离）。请确定如果他选择最佳的 $k$ 扇门解锁，他的奶牛需要行走的最小总距离。", "inputFormat": "输入的第一行包含 $n$ 和 $k$。接下来的 $n$ 行每行包含 $r_1 \\ldots r_n$。", "outputFormat": "请输出奶牛需要行走的最小距离。", "hint": "Farmer John 可以解锁门 2 和门 5。11 头奶牛从门 2 进入，总共行走 8 的距离到达房间 2、3 和 4。10 头奶牛从门 5 进入，总共行走 6 的距离到达房间 5、6 和 1。", "locale": "zh-CN"}}}
{"pid": "P3141", "type": "P", "difficulty": 5, "samples": [["15 15 5 2\n2\n5\n10\n6\n4\n11\n3", "44"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2016", "USACO", "生成树"], "title": "[USACO16FEB] Fenced In P", "background": "*本题和 [金组同名题目](/problem/P6171) 在题意上一致，唯一的不同是数据范围。*", "description": "Farmer John 意识到他的奶牛最近患上了一种恐惧症（害怕过于开阔的空间）。为了减少放牧的恐惧，FJ 决定在牧场中建一些水平和竖直方向的栅栏来将牧场分成若干个小区域。\n\n整个牧场是一个矩形，两个角的坐标分别为 $(0,0)$ 和 $(A,B)$。FJ 在 $a_1,\\ldots ,a_n$ 这 $n$ 个两两不同的位置建造了竖直方向的栅栏，每个栅栏从 $(a_i,0)$ 到 $(a_i,B)$；FJ 在 $b_1,\\ldots ,b_m$ 这 $m$ 个两两不同的位置建造了水平方向的栅栏，每个栅栏从 $(0,b_i)$ 到 $(A,b_i)$。竖直方向的栅栏和水平方向的栅栏两两相交，将整个牧场分割成 $(n+1)(m+1)$ 个区域。\n\n不幸的是，FJ 忘记了在栅栏上开门，奶牛都只能被困在一个个的小区域里！他想通过去掉一些栅栏来解决这个问题。他一次可以选择两个相邻的区域，将隔离这两个区域的栅栏去掉。FJ 的目标是让奶牛能够抵达牧场的任意一个地方。\n\n这是一个例子：\n\n```plain\n+---+--+\n|   |  |\n+---+--+\n|   |  |\n|   |  |\n+---+--+\n```\n\n去掉一些栅栏后的效果是这样的：\n\n```plain\n+---+--+\n|      |\n+---+  +\n|      |\n|      |\n+---+--+\n```\n\n为了降低工程量，FJ 当然希望拆除的栅栏长度最短。", "inputFormat": "第一行四个整数 $A,B,n,m$，保证 $1 \\leq n,m \\leq 2.5 \\times 10^5$，$1 \\leq A,B \\leq 10^9$。\n\n接下来 $n$ 行，第 $i$ 行一个整数 $a_i$，保证 $0 \\lt a_i \\lt A$。\n\n接下来 $m$ 行，第 $i$ 行一个整数 $b_i$，保证 $0 \\lt b_i \\lt B$。", "outputFormat": "输出拆除栅栏的最小长度。**答案需要用 64 位带符号整数存储。**", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[USACO16FEB] Fenced In P", "background": "This problem has the same statement as the problem with the same name in the Gold division (/problem/P6171); the only difference is the Constraints.", "description": "Farmer John has realized that his cows have recently developed a phobia of overly open spaces. To reduce their fear while grazing, FJ decides to build some horizontal and vertical fences in the pasture to divide it into smaller regions.\n\nThe entire pasture is a rectangle with corners at $(0, 0)$ and $(A, B)$. FJ builds vertical fences at $n$ distinct positions $a_1, \\ldots, a_n$, each from $(a_i, 0)$ to $(a_i, B)$; he builds horizontal fences at $m$ distinct positions $b_1, \\ldots, b_m$, each from $(0, b_i)$ to $(A, b_i)$. The vertical and horizontal fences intersect pairwise, dividing the entire pasture into $(n+1)(m+1)$ regions.\n\nUnfortunately, FJ forgot to add gates in the fences, so the cows are trapped in individual small regions. He can fix this by removing some fences. Each time, he can choose two adjacent regions and remove the fence that separates them. FJ’s goal is to allow the cows to reach any location in the pasture.\n\nHere is an example:\n\n```plain\n+---+--+\n|   |  |\n+---+--+\n|   |  |\n|   |  |\n+---+--+\n```\n\nAfter removing some fences:\n\n```plain\n+---+--+\n|      |\n+---+  +\n|      |\n|      |\n+---+--+\n```\n\nTo minimize the work, FJ wants the total length of removed fences to be as small as possible.", "inputFormat": "The first line contains four integers $A, B, n, m$, with $1 \\leq n, m \\leq 2.5 \\times 10^5$ and $1 \\leq A, B \\leq 10^9$.\n\nThe next $n$ lines each contain an integer $a_i$, with $0 \\lt a_i \\lt A$.\n\nThe next $m$ lines each contain an integer $b_i$, with $0 \\lt b_i \\lt B$.", "outputFormat": "Output the minimum total length of fences to remove. The answer needs to be stored in a 64-bit signed integer.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO16FEB] Fenced In P", "background": "*本题和 [金组同名题目](/problem/P6171) 在题意上一致，唯一的不同是数据范围。*", "description": "Farmer John 意识到他的奶牛最近患上了一种恐惧症（害怕过于开阔的空间）。为了减少放牧的恐惧，FJ 决定在牧场中建一些水平和竖直方向的栅栏来将牧场分成若干个小区域。\n\n整个牧场是一个矩形，两个角的坐标分别为 $(0,0)$ 和 $(A,B)$。FJ 在 $a_1,\\ldots ,a_n$ 这 $n$ 个两两不同的位置建造了竖直方向的栅栏，每个栅栏从 $(a_i,0)$ 到 $(a_i,B)$；FJ 在 $b_1,\\ldots ,b_m$ 这 $m$ 个两两不同的位置建造了水平方向的栅栏，每个栅栏从 $(0,b_i)$ 到 $(A,b_i)$。竖直方向的栅栏和水平方向的栅栏两两相交，将整个牧场分割成 $(n+1)(m+1)$ 个区域。\n\n不幸的是，FJ 忘记了在栅栏上开门，奶牛都只能被困在一个个的小区域里！他想通过去掉一些栅栏来解决这个问题。他一次可以选择两个相邻的区域，将隔离这两个区域的栅栏去掉。FJ 的目标是让奶牛能够抵达牧场的任意一个地方。\n\n这是一个例子：\n\n```plain\n+---+--+\n|   |  |\n+---+--+\n|   |  |\n|   |  |\n+---+--+\n```\n\n去掉一些栅栏后的效果是这样的：\n\n```plain\n+---+--+\n|      |\n+---+  +\n|      |\n|      |\n+---+--+\n```\n\n为了降低工程量，FJ 当然希望拆除的栅栏长度最短。", "inputFormat": "第一行四个整数 $A,B,n,m$，保证 $1 \\leq n,m \\leq 2.5 \\times 10^5$，$1 \\leq A,B \\leq 10^9$。\n\n接下来 $n$ 行，第 $i$ 行一个整数 $a_i$，保证 $0 \\lt a_i \\lt A$。\n\n接下来 $m$ 行，第 $i$ 行一个整数 $b_i$，保证 $0 \\lt b_i \\lt B$。", "outputFormat": "输出拆除栅栏的最小长度。**答案需要用 64 位带符号整数存储。**", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3142", "type": "P", "difficulty": 3, "samples": [["6\n1 1\n7 8\n10 9\n8 12\n4 100\n50 7", "12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2016", "USACO", "枚举", "排序"], "title": "[USACO16OPEN] Field Reduction S", "background": "", "description": "Farmer John's $N$ cows ($5 \\leq N \\leq 50,000$) are all located at distinct positions in his two-dimensional field.  FJ wants to enclose all of the cows with a rectangular fence whose sides are parallel to the x and y axes, and he wants this fence to be as small as possible so that it contains every cow (cows on the boundary are allowed).\n\nFJ is unfortunately on a tight budget due to low milk production last quarter. He would therefore like to build an even smaller fenced enclosure if possible, and he is willing to sell up to three cows from his herd to make this possible.\n\nPlease help FJ compute the smallest possible area he can enclose with his fence after removing up to three cows from his herd (and thereafter building the tightest enclosing fence for the remaining cows).\n\nFor this problem, please treat cows as points and the fence as a collection of four line segments (i.e., don't think of the cows as \"unit squares\").  Note that the answer can be zero, for example if all remaining cows end up standing  in a common vertical or horizontal line.", "inputFormat": "The first line of input contains $N$.  The next $N$ lines each contain two integers specifying the location of a cow.  Cow locations are positive integers in the range $1 \\ldots 40,000$.\n", "outputFormat": "Write a single integer specifying the minimum area FJ can enclose with his fence after removing up to three carefully-chosen cows from his herd.\n", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO16OPEN] Field Reduction S", "background": "", "description": "Farmer John's $N$ cows ($5 \\leq N \\leq 50,000$) are all located at distinct positions in his two-dimensional field.  FJ wants to enclose all of the cows with a rectangular fence whose sides are parallel to the x and y axes, and he wants this fence to be as small as possible so that it contains every cow (cows on the boundary are allowed).\n\nFJ is unfortunately on a tight budget due to low milk production last quarter. He would therefore like to build an even smaller fenced enclosure if possible, and he is willing to sell up to three cows from his herd to make this possible.\n\nPlease help FJ compute the smallest possible area he can enclose with his fence after removing up to three cows from his herd (and thereafter building the tightest enclosing fence for the remaining cows).\n\nFor this problem, please treat cows as points and the fence as a collection of four line segments (i.e., don't think of the cows as \"unit squares\").  Note that the answer can be zero, for example if all remaining cows end up standing  in a common vertical or horizontal line.", "inputFormat": "The first line of input contains $N$.  The next $N$ lines each contain two integers specifying the location of a cow.  Cow locations are positive integers in the range $1 \\ldots 40,000$.\n", "outputFormat": "Write a single integer specifying the minimum area FJ can enclose with his fence after removing up to three carefully-chosen cows from his herd.\n", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO16OPEN] Field Reduction S", "background": "", "description": "Farmer John 的 $N$ 头奶牛（$5 \\leq N \\leq 50,000$）都位于他二维牧场中的不同位置。FJ 希望用一个边平行于 $x$ 轴和 $y$ 轴的矩形围栏围住所有的奶牛，并且他希望这个围栏尽可能小，以便能够包含每头奶牛（允许奶牛位于边界上）。\n\n不幸的是，由于上个季度牛奶产量低，FJ 的预算非常紧张。因此，他希望如果可能的话，建造一个更小的围栏，并且他愿意从他的牛群中出售最多三头奶牛来实现这一目标。\n\n请帮助 FJ 计算在从他的牛群中移除最多三头奶牛后，他可以用围栏围住的最小可能面积（然后为剩余的奶牛建造最紧密的围栏）。\n\n对于这个问题，请将奶牛视为点，将围栏视为四条线段的集合（即不要将奶牛视为“单位正方形”）。请注意，答案可能为零，例如如果所有剩余的奶牛最终站在一条共同的垂直线或水平线上。", "inputFormat": "输入的第一行包含 $N$。接下来的 $N$ 行每行包含两个整数，表示一头奶牛的位置。奶牛的位置是范围在 $1 \\ldots 40,000$ 的正整数。", "outputFormat": "输出一个整数，表示 FJ 在从他的牛群中精心选择移除最多三头奶牛后，可以用围栏围住的最小面积。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3143", "type": "P", "difficulty": 3, "samples": [["7 3\n10\n5\n1\n12\n9\n5\n14", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "贪心", "2016", "USACO", "枚举", "双指针 two-pointer"], "title": "[USACO16OPEN] Diamond Collector S", "background": "", "description": "Bessie the cow, always a fan of shiny objects, has taken up a hobby of mining diamonds in her spare time!  She has collected $N$ diamonds ($N \\leq 50,000$) of varying sizes, and she wants to arrange some of them in a pair of  display cases in the barn.\n\n\nSince Bessie wants the diamonds in each of the two cases to be relatively similar in  size, she decides that she will not include two diamonds in the same case if their sizes differ by more than $K$ (two diamonds can be displayed together in the same case if their sizes differ by exactly $K$).  Given $K$, please help Bessie determine the maximum number of diamonds she can display in both cases together.", "inputFormat": "The first line of the input file contains $N$ and $K$ ($0 \\leq K \\leq 1,000,000,000$).\n\nThe next $N$ lines each contain an integer giving the size of one of the diamonds.  All sizes will be positive and will not exceed $1,000,000,000$.\n", "outputFormat": "Output a single positive integer, telling the maximum number of diamonds that Bessie can showcase in total in both the cases.", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO16OPEN] Diamond Collector S", "background": "", "description": "Bessie the cow, always a fan of shiny objects, has taken up a hobby of mining diamonds in her spare time!  She has collected $N$ diamonds ($N \\leq 50,000$) of varying sizes, and she wants to arrange some of them in a pair of  display cases in the barn.\n\n\nSince Bessie wants the diamonds in each of the two cases to be relatively similar in  size, she decides that she will not include two diamonds in the same case if their sizes differ by more than $K$ (two diamonds can be displayed together in the same case if their sizes differ by exactly $K$).  Given $K$, please help Bessie determine the maximum number of diamonds she can display in both cases together.", "inputFormat": "The first line of the input file contains $N$ and $K$ ($0 \\leq K \\leq 1,000,000,000$).\n\nThe next $N$ lines each contain an integer giving the size of one of the diamonds.  All sizes will be positive and will not exceed $1,000,000,000$.\n", "outputFormat": "Output a single positive integer, telling the maximum number of diamonds that Bessie can showcase in total in both the cases.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO16OPEN] Diamond Collector S", "background": null, "description": "奶牛 Bessie 一直喜欢闪闪发光的物体，她最近在业余时间开始了一项爱好——挖掘钻石！她收集了 $N$ 颗大小各不相同的钻石（$N \\leq 50,000$），并希望将它们中的一部分放在谷仓里的两个展示柜中展示。\n\n由于 Bessie 希望每个展示柜中的钻石大小相对接近，她决定如果两颗钻石的大小相差超过 $K$，就不能将它们放在同一个展示柜中（如果两颗钻石的大小相差恰好为 $K$，则可以将它们一起展示在同一个展示柜中）。给定 $K$，请帮助 Bessie 确定她可以在两个展示柜中一起展示的最大钻石数量。", "inputFormat": "输入文件的第一行包含 $N$ 和 $K$（$0 \\leq K \\leq 10^9$）。\n\n接下来的 $N$ 行每行包含一个整数，表示一颗钻石的大小。所有钻石的大小均为正数且不超过 $10^9$。", "outputFormat": "输出一个正整数，表示 Bessie 可以在两个展示柜中一起展示的最大钻石数量。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P3144", "type": "P", "difficulty": 3, "samples": [["4 3\n1 2\n2 3\n3 4\n3\n4\n1\n2", "YES\nNO\nYES\nYES"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2016", "USACO", "并查集"], "title": "[USACO16OPEN] Closing the Farm S", "background": "*本题和 [金组同名题目](/problem/P6121) 在题意上一致，唯一的不同是数据范围。*", "description": "FJ 和他的奶牛们正在计划离开小镇做一次长的旅行，同时 FJ 想临时地关掉他的农场以节省一些金钱。\n\n这个农场一共有被用 $M$ 条双向道路连接的 $N$ 个谷仓（$1 \\leq N,M \\leq 3000$）。为了关闭整个农场，FJ 计划每一次关闭掉一个谷仓。当一个谷仓被关闭了，所有的连接到这个谷仓的道路都会被关闭，而且再也不能够被使用。\n\nFJ 现在正感兴趣于知道在每一个时间（这里的“时间”指在每一次关闭谷仓之前的时间）时他的农场是否是“全连通的”——也就是说从任意的一个开着的谷仓开始，能够到达另外的一个谷仓。注意自从某一个时间之后，可能整个农场都开始不会是“全连通的”。", "inputFormat": "输入第一行两个整数 $N,M$。\n\n接下来 $M$ 行，每行两个整数 $u,v$（$1 \\leq u,v \\leq N$），描述一条连接 $u,v$ 两个农场的路。\n\n最后 $N$ 行每行一个整数，表示第 $i$ 个被关闭的农场编号。", "outputFormat": "输出 $N$ 行，每行包含 `YES` 或 `NO`，表示某个时刻农场是否是全连通的。\n\n第一行输出最初的状态，第 $i$ 行（$2 \\leq i \\leq N$）输出第 $i-1$ 个农场被关闭后的状态。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[USACO16OPEN] Closing the Farm S", "background": "This problem has the same statement as the problem with the same name in the Gold division, with the only difference being the constraints. See [the problem with the same name in the Gold division](/problem/P6121).", "description": "FJ and his cows are planning to leave town for a long trip, and FJ wants to temporarily shut down his farm to save some money.\n\nThe farm has $N$ barns connected by $M$ bidirectional roads ($1 \\leq N,M \\leq 3000$). To close the entire farm, FJ plans to close one barn at a time. When a barn is closed, all roads incident to that barn are closed and can no longer be used.\n\nFJ is interested in knowing, at each time (here, “time” means the moment just before each barn is closed), whether his farm is “fully connected” — that is, from any open barn, it is possible to reach any other open barn. Note that from some time onward, the entire farm may cease to be fully connected.\n\n# Description", "inputFormat": "The first line contains two integers $N,M$.\n\nThe next $M$ lines each contain two integers $u,v$ ($1 \\leq u,v \\leq N$), describing a road connecting barns $u$ and $v$.\n\nThe last $N$ lines each contain one integer, where the $i$-th line gives the index of the $i$-th barn to be closed.", "outputFormat": "Output $N$ lines, each containing `YES` or `NO`, indicating whether the farm is fully connected at that time.\n\nPrint the initial status on the first line. On line $i$ ($2 \\leq i \\leq N$), print the status after the $(i-1)$-th barn has been closed.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO16OPEN] Closing the Farm S", "background": "*本题和 [金组同名题目](/problem/P6121) 在题意上一致，唯一的不同是数据范围。*", "description": "FJ 和他的奶牛们正在计划离开小镇做一次长的旅行，同时 FJ 想临时地关掉他的农场以节省一些金钱。\n\n这个农场一共有被用 $M$ 条双向道路连接的 $N$ 个谷仓（$1 \\leq N,M \\leq 3000$）。为了关闭整个农场，FJ 计划每一次关闭掉一个谷仓。当一个谷仓被关闭了，所有的连接到这个谷仓的道路都会被关闭，而且再也不能够被使用。\n\nFJ 现在正感兴趣于知道在每一个时间（这里的“时间”指在每一次关闭谷仓之前的时间）时他的农场是否是“全连通的”——也就是说从任意的一个开着的谷仓开始，能够到达另外的一个谷仓。注意自从某一个时间之后，可能整个农场都开始不会是“全连通的”。", "inputFormat": "输入第一行两个整数 $N,M$。\n\n接下来 $M$ 行，每行两个整数 $u,v$（$1 \\leq u,v \\leq N$），描述一条连接 $u,v$ 两个农场的路。\n\n最后 $N$ 行每行一个整数，表示第 $i$ 个被关闭的农场编号。", "outputFormat": "输出 $N$ 行，每行包含 `YES` 或 `NO`，表示某个时刻农场是否是全连通的。\n\n第一行输出最初的状态，第 $i$ 行（$2 \\leq i \\leq N$）输出第 $i-1$ 个农场被关闭后的状态。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3145", "type": "P", "difficulty": 4, "samples": [["6\n4 2\n8 10\n1 1\n9 12\n14 7\n2 3", "107"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2016", "USACO", "枚举", "排序", "ST 表"], "title": "[USACO16OPEN] Splitting the Field G", "background": "", "description": "Farmer John's $N$ cows ($3 \\leq N \\leq 50,000$) are all located at distinct positions in his two-dimensional field.  FJ wants to enclose all of the cows with a rectangular fence whose sides are parallel to the x and y axes, and hewants this fence to be as small as possible so that it contains every cow (cowson the boundary are allowed).\n\nFJ is unfortunately on a tight budget due to low milk production last quarter.He would therefore like to enclose a smaller area to reduce maintenance costs,and the only way he can see to do this is by building two enclosures instead of one.  Please help him compute how much less area he needs to enclose, in total,by using two enclosures instead of one. Like the original enclosure, the two enclosures must collectively contain all the cows (with cows on boundaries allowed), and they must have sides parallel to the x and y axes.  The two enclosures are not allowed to overlap -- not even on their boundaries. Note that enclosures of zero area are legal, for example if an enclosure has zero width and/or zero height.", "inputFormat": "The first line of input contains $N$.  The next $N$ lines each contain two integers specifying the location of a cow. Cow locations are positive integers in the range $1 \\ldots 1,000,000,000$.", "outputFormat": "Write a single integer specifying amount of total area FJ can save by using two enclosures instead of one.", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO16OPEN] Splitting the Field G", "background": "", "description": "Farmer John's $N$ cows ($3 \\leq N \\leq 50,000$) are all located at distinct positions in his two-dimensional field.  FJ wants to enclose all of the cows with a rectangular fence whose sides are parallel to the x and y axes, and hewants this fence to be as small as possible so that it contains every cow (cowson the boundary are allowed).\n\nFJ is unfortunately on a tight budget due to low milk production last quarter.He would therefore like to enclose a smaller area to reduce maintenance costs,and the only way he can see to do this is by building two enclosures instead of one.  Please help him compute how much less area he needs to enclose, in total,by using two enclosures instead of one. Like the original enclosure, the two enclosures must collectively contain all the cows (with cows on boundaries allowed), and they must have sides parallel to the x and y axes.  The two enclosures are not allowed to overlap -- not even on their boundaries. Note that enclosures of zero area are legal, for example if an enclosure has zero width and/or zero height.", "inputFormat": "The first line of input contains $N$.  The next $N$ lines each contain two integers specifying the location of a cow. Cow locations are positive integers in the range $1 \\ldots 1,000,000,000$.", "outputFormat": "Write a single integer specifying amount of total area FJ can save by using two enclosures instead of one.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO16OPEN] Splitting the Field G", "background": "", "description": "Farmer John 的 $N$ 头奶牛（$3 \\leq N \\leq 50,000$）位于他二维牧场的不同位置。FJ 想要用一个与 x 轴和 y 轴平行的矩形围栏将所有奶牛围住，并且他希望这个围栏尽可能小，以便它包含每一头奶牛（允许奶牛位于边界上）。\n\n由于上季度牛奶产量低，FJ 的预算紧张。因此，他希望围住更小的区域以减少维护成本，而他唯一能想到的方法就是建造两个围栏而不是一个。请帮助他计算使用两个围栏而不是一个围栏总共可以减少多少面积。与原始围栏一样，这两个围栏必须共同包含所有奶牛（允许奶牛位于边界上），并且它们的边必须与 $x$ 轴和 $y$ 轴平行。这两个围栏不允许重叠——即使在它们的边界上也不行。注意，零面积的围栏是合法的，例如如果一个围栏的宽度和/或高度为零。", "inputFormat": "输入的第一行包含 $N$。接下来的 $N$ 行每行包含两个整数，指定一头奶牛的位置。奶牛的位置是 $1 \\ldots 1,000,000,000$ 范围内的正整数。", "outputFormat": "输出一个整数，表示 FJ 通过使用两个围栏而不是一个围栏总共可以减少的面积。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3146", "type": "P", "difficulty": 4, "samples": [["4\n1\n1\n1\n2", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "贪心", "2016", "USACO", "区间 DP"], "title": "[USACO16OPEN] 248 G", "background": "", "description": "Bessie likes downloading games to play on her cell phone, even though she  doesfind the small touch screen rather cumbersome to use with her large hooves.\n\nShe is particularly intrigued by the current game she is playing.The game starts with a sequence of $N$ positive integers ($2 \\leq N\\leq 248$), each in the range $1 \\ldots 40$. In one move, Bessie cantake two adjacent numbers with equal values and replace them a singlenumber of value one greater (e.g., she might replace two adjacent 7s with an 8).  The goal is to maximize the value of the largest numberpresent in the sequence at the end of the game.  Please help Bessiescore as highly as possible!\n", "inputFormat": "The first line of input contains $N$, and the next $N$ lines give the sequence of $N$ numbers at the start of the game.\n", "outputFormat": "Please output the largest integer Bessie can generate.\n", "hint": "In this example shown here, Bessie first merges the second and third 1s to obtain the sequence 1 2 2, and then she merges the 2s into a 3. Note that it is not optimal to join the first two 1s.\n", "locale": "en", "translations": {"en": {"title": "[USACO16OPEN] 248 G", "background": "", "description": "Bessie likes downloading games to play on her cell phone, even though she  doesfind the small touch screen rather cumbersome to use with her large hooves.\n\nShe is particularly intrigued by the current game she is playing.The game starts with a sequence of $N$ positive integers ($2 \\leq N\\leq 248$), each in the range $1 \\ldots 40$. In one move, Bessie cantake two adjacent numbers with equal values and replace them a singlenumber of value one greater (e.g., she might replace two adjacent 7s with an 8).  The goal is to maximize the value of the largest numberpresent in the sequence at the end of the game.  Please help Bessiescore as highly as possible!\n", "inputFormat": "The first line of input contains $N$, and the next $N$ lines give the sequence of $N$ numbers at the start of the game.\n", "outputFormat": "Please output the largest integer Bessie can generate.\n", "hint": "In this example shown here, Bessie first merges the second and third 1s to obtain the sequence 1 2 2, and then she merges the 2s into a 3. Note that it is not optimal to join the first two 1s.\n", "locale": "en"}, "zh-CN": {"title": "[USACO16OPEN] 248 G", "background": null, "description": "贝西喜欢在手机上下载游戏来玩，尽管她确实觉得对于自己巨大的蹄子来说，小小的触摸屏用起来相当笨拙。\n\n她对当前正在玩的这个游戏特别感兴趣。游戏开始时给定一个包含 $N$ 个正整数的序列（$2 \\leq N \\leq 248$），每个数的范围在 $1 \\ldots 40$ 之间。在一次操作中，贝西可以选择两个相邻且相等的数，将它们替换为一个比原数大 $1$ 的数（例如，她可以将两个相邻的 `7` 替换为一个 `8`）。游戏的目标是最大化最终序列中的最大数值。请帮助贝西获得尽可能高的分数！", "inputFormat": "第一行输入包含 $N$，接下来的 $N$ 行给出游戏开始时序列的 $N$ 个数字。", "outputFormat": "请输出贝西能生成的最大整数。", "hint": "在示例中，贝西首先合并第二个和第三个 `1`，得到序列 `1 2 2`，然后将两个 `2` 合并为 `3`。注意，合并前两个 `1` 并不是最优策略。", "locale": "zh-CN"}}}
{"pid": "P3147", "type": "P", "difficulty": 5, "samples": [["4\n1\n1\n1\n2", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "贪心", "2016", "倍增", "USACO"], "title": "[USACO16OPEN] 262144 P", "background": "", "description": "Bessie likes downloading games to play on her cell phone, even though she  doesfind the small touch screen rather cumbersome to use with her large hooves.\n\n\nShe is particularly intrigued by the current game she is playing.The game starts with a sequence of $N$ positive integers ($2 \\leq N\\leq 262,144$), each in the range $1 \\ldots 40$.  In one move, Bessiecan take two adjacent numbers with equal values and replace them asingle number of value one greater (e.g., she might replace twoadjacent 7s with an 8). The goal is to maximize the value of thelargest number present in the sequence at the end of the game.  Pleasehelp Bessie score as highly as possible!", "inputFormat": "The first line of input contains $N$, and the next $N$ lines give the sequence\n\nof $N$ numbers at the start of the game.\n", "outputFormat": "Please output the largest integer Bessie can generate.\n", "hint": "In this example shown here, Bessie first merges the second and third 1s to obtain the sequence 1 2 2, and then she merges the 2s into a 3. Note that it is not optimal to join the first two 1s.", "locale": "en", "translations": {"en": {"title": "[USACO16OPEN] 262144 P", "background": "", "description": "Bessie likes downloading games to play on her cell phone, even though she  doesfind the small touch screen rather cumbersome to use with her large hooves.\n\n\nShe is particularly intrigued by the current game she is playing.The game starts with a sequence of $N$ positive integers ($2 \\leq N\\leq 262,144$), each in the range $1 \\ldots 40$.  In one move, Bessiecan take two adjacent numbers with equal values and replace them asingle number of value one greater (e.g., she might replace twoadjacent 7s with an 8). The goal is to maximize the value of thelargest number present in the sequence at the end of the game.  Pleasehelp Bessie score as highly as possible!", "inputFormat": "The first line of input contains $N$, and the next $N$ lines give the sequence\n\nof $N$ numbers at the start of the game.\n", "outputFormat": "Please output the largest integer Bessie can generate.\n", "hint": "In this example shown here, Bessie first merges the second and third 1s to obtain the sequence 1 2 2, and then she merges the 2s into a 3. Note that it is not optimal to join the first two 1s.", "locale": "en"}, "zh-CN": {"title": "[USACO16OPEN] 262144 P", "background": "", "description": "贝西喜欢在手机上下载游戏来玩，尽管她确实觉得对于自己巨大的蹄子来说，小小的触摸屏用起来相当笨拙。\n\n她对当前正在玩的这个游戏特别感兴趣。游戏开始时给定一个包含 $N$ 个正整数的序列（$2 \\leq N \\leq 262,144$），每个数的范围在 $1 \\ldots 40$ 之间。在一次操作中，贝西可以选择两个相邻且相等的数，将它们替换为一个比原数大 1 的数（例如，她可以将两个相邻的 7 替换为一个 8）。游戏的目标是最大化最终序列中的最大数值。请帮助贝西获得尽可能高的分数！", "inputFormat": "第一行输入包含 $N$，接下来的 $N$ 行给出游戏开始时序列的 $N$ 个数字。", "outputFormat": "请输出贝西能生成的最大整数。", "hint": "在示例中，贝西首先合并第二个和第三个 1，得到序列 1 2 2，然后将两个 2 合并为 3。注意，合并前两个 1 并不是最优策略。", "locale": "zh-CN"}}}
{"pid": "P3148", "type": "P", "difficulty": 7, "samples": [["5\n5 5\naaaaa\n..a..\nbbabb\n..a..\naaaaa\n3 5\n..abb\n..a..\naaaaa\n5 2\na.\na.\naa\na.\na.\n1 2\nbb\n1 5\nbbabb\n2 5\naaaaa\n..a..", "3"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["模拟", "2016", "二分", "USACO", "O2优化", "哈希 hashing", "前缀和"], "title": "[USACO16OPEN] Bull in a China Shop P", "background": null, "description": "Farmer John has decided his home needs more decoration. Visiting the local china shop, he finds a delicate glass cow figurine that he decides to purchase, knowing that it will fit perfectly on the mantel above his fireplace.\n\nThe shape of the cow figurine is described by an $N \\times M$ grid of characters like the one below ($3 \\leq N, M \\leq 500$), where lowercase letter characters are each part of the figurine (indicating different colors) and '.' characters are not.\n\n```\n...............\n...............\nx..x...........\nxxxx...........\nxxxxaaaaaaa...\n.xx.aaaaaaaaa..\n....aaaaaaa.aa.\n....ll...ll....\n....vv...vv....\n...............\n```\n\nUnfortunately, right before FJ can make his purchase, a bull runs through the shop and breaks not only FJ's figurine, but many of the other glass objects on the shelves as well! FJ's figurine breaks into 3 pieces, which quickly become lost among $K$ total pieces lying on the ground ($4 \\leq K \\leq 100$). Each of the $K$ pieces is described by a grid of characters, just like the original figurine.\n\nPlease help FJ determine how many sets of 3 pieces (out of the $K$ on the floor) could be glued back together to mend his broken figurine.\n\nThe pieces on the ground might have been flipped vertically or horizontally, or rotated by some multiple of 90 degrees. Therefore, given the original grid as well as $K$ grids describing pieces, you want to find sets of 3 pieces that can be joined together to form the original picture, allowing the pieces to be translated, flipped, or rotated multiples of 90 degrees. When then superimposed, the 3 pieces should exactly form the original picture, with each colored square in the original picture represented in exactly one of the pieces.", "inputFormat": "The first line contains a single integer $K$. Following that will be $K + 1$ piece descriptions. The first description will describe the original glass cow, the following $K$ descriptions will be of the broken pieces.\n\nEach description begins with a line containing two integers $R$ and $C$ ($1 \\le R, C \\le 500$).  The following $R$ lines contain $C$ lowercase alphabet characters describing the color of each cell. Each piece will be horizontally/vertically connected and have at least one non-empty cell.", "outputFormat": "Output the number of triples $i, j, k$ ($i < j < k$) such that pieces $i$, $j$, and $k$ can be arranged to form the original glass cow.", "hint": "The three solutions use pieces $(0, 1, 2)$, $(0, 2, 4)$, $(1, 3, 4)$.\n\nNote that this problem has a time limit of 6 seconds per test case (and twice that for Java and Python submissions).", "locale": "en", "translations": {"en": {"title": "[USACO16OPEN] Bull in a China Shop P", "background": null, "description": "Farmer John has decided his home needs more decoration. Visiting the local china shop, he finds a delicate glass cow figurine that he decides to purchase, knowing that it will fit perfectly on the mantel above his fireplace.\n\nThe shape of the cow figurine is described by an $N \\times M$ grid of characters like the one below ($3 \\leq N, M \\leq 500$), where lowercase letter characters are each part of the figurine (indicating different colors) and '.' characters are not.\n\n```\n...............\n...............\nx..x...........\nxxxx...........\nxxxxaaaaaaa...\n.xx.aaaaaaaaa..\n....aaaaaaa.aa.\n....ll...ll....\n....vv...vv....\n...............\n```\n\nUnfortunately, right before FJ can make his purchase, a bull runs through the shop and breaks not only FJ's figurine, but many of the other glass objects on the shelves as well! FJ's figurine breaks into 3 pieces, which quickly become lost among $K$ total pieces lying on the ground ($4 \\leq K \\leq 100$). Each of the $K$ pieces is described by a grid of characters, just like the original figurine.\n\nPlease help FJ determine how many sets of 3 pieces (out of the $K$ on the floor) could be glued back together to mend his broken figurine.\n\nThe pieces on the ground might have been flipped vertically or horizontally, or rotated by some multiple of 90 degrees. Therefore, given the original grid as well as $K$ grids describing pieces, you want to find sets of 3 pieces that can be joined together to form the original picture, allowing the pieces to be translated, flipped, or rotated multiples of 90 degrees. When then superimposed, the 3 pieces should exactly form the original picture, with each colored square in the original picture represented in exactly one of the pieces.", "inputFormat": "The first line contains a single integer $K$. Following that will be $K + 1$ piece descriptions. The first description will describe the original glass cow, the following $K$ descriptions will be of the broken pieces.\n\nEach description begins with a line containing two integers $R$ and $C$ ($1 \\le R, C \\le 500$).  The following $R$ lines contain $C$ lowercase alphabet characters describing the color of each cell. Each piece will be horizontally/vertically connected and have at least one non-empty cell.", "outputFormat": "Output the number of triples $i, j, k$ ($i < j < k$) such that pieces $i$, $j$, and $k$ can be arranged to form the original glass cow.", "hint": "The three solutions use pieces $(0, 1, 2)$, $(0, 2, 4)$, $(1, 3, 4)$.\n\nNote that this problem has a time limit of 6 seconds per test case (and twice that for Java and Python submissions).", "locale": "en"}, "zh-CN": {"title": "[USACO16OPEN] Bull in a China Shop P", "background": "", "description": "Farmer John 决定给他的家增添一些装饰。在当地的瓷器店里，他发现了一尊精致的玻璃牛雕像，决定购买它，因为它完美地适合放在壁炉上方的壁炉架上。\n\n牛雕像的形状由一个 $N \\times M$ 的字符网格描述（$3 \\leq N, M \\leq 500$），其中小写字母字符代表雕像的各个部分（表示不同的颜色），而 '.' 字符则不代表雕像部分。\n\n```cpp\n...............\n...............\nx..x...........\nxxxx...........\nxxxxaaaaaaa...\n.xx.aaaaaaaaa..\n....aaaaaaa.aa.\n....ll...ll....\n....vv...vv....\n...............\n```\n\n不幸的是，就在 FJ 准备购买之前，一头公牛冲进了商店，不仅撞碎了 FJ 的雕像，还撞碎了许多其他货架上的玻璃制品！FJ 的雕像碎成了 3 块，并迅速混入了地上的 $K$ 块碎片中（$4 \\leq K \\leq 100$）。每一块碎片都由一个字符网格描述，就像原来的雕像一样。\n\n请帮助 FJ 确定有多少组 3 块碎片（地上的 $K$ 块中）可以粘合在一起修复他破碎的雕像。\n\n地上的碎片可能被垂直或水平翻转，或者旋转了 90 度的倍数。因此，给定原始网格以及描述碎片的 $K$ 个网格，你需要找到可以组合成原始图片的 3 块碎片，允许碎片被平移、翻转或旋转 90 度的倍数。当这 3 块碎片叠加在一起时，它们应该准确地形成原始图片，且原始图片中的每个彩色方块都恰好出现在一块碎片中。", "inputFormat": "第一行包含一个整数 $K$。接下来是 $K + 1$ 个碎片的描述。第一个描述是原始玻璃牛的描述，接下来的 $K$ 个描述是破碎的碎片。\n\n每个描述以两个整数 $R$ 和 $C$（$1 \\le R, C \\le 500$）开始。接下来的 $R$ 行包含 $C$ 个小写字母字符，描述每个单元格的颜色。每块碎片在水平/垂直方向上都是连通的，并且至少有一个非空单元格。", "outputFormat": "输出满足条件的三元组 $i, j, k$（$i < j < k$）的数量，使得碎片 $i$、$j$ 和 $k$ 可以排列成原始玻璃牛。", "hint": "三个解决方案使用了碎片 $(0, 1, 2)$、$(0, 2, 4)$ 和 $(1, 3, 4)$。\n\n请注意，这个问题每个测试用例的时间限制为 6 秒（Java 和 Python 提交的时间限制为 12 秒）。\n\n备注：原文“输入格式”部分中 $R, C$ 的范围是 $1 \\leq R, C \\leq 100$，而实际数据与之不符，疑为笔误。", "locale": "zh-CN"}}}
{"pid": "P3149", "type": "P", "difficulty": 5, "samples": [["5 2\n1 5 3 4 2\n3\n4", "5\n4\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["树状数组", "离散化", "洛谷原创"], "title": "排序", "background": "", "description": "有 $n$ 个人依次站在小 A 面前。小 A 会依次对这 $n$ 个人进行 $m$ 次操作。\n\n每次操作选择一个位置 $k$，将这 $n$ 个人中的所有身高小于等于当前 $k$ 位置的人的身高的人从队伍里拎出，然后按照身高从矮到高的顺序从左到右依次插入到 这些人原本的位置当中。\n\n小 A 对这 $n$ 个人身高构成的序列的逆序对很感兴趣。现在小 A 想要知道每一次操作后这个序列的逆序对数。\n\n----\n\nUpdate（2021-01-17）：$a$ 序列中的逆序对的定义是满足 $i < j$ 且 $a_i > a_j$ 的数对 $(i, j)$。", "inputFormat": "第一行两个整数 $n$ 和 $m$，表示人数和操作数。\n\n接下来一行 $n$ 个整数 $a_i$，表示初始状态从左到右每个人的身高。\n\n接下来 $m$ 行每行一个数，表示这次操作的 $k$。", "outputFormat": "输出共 $m + 1$ 行，第一行表示未操作时的逆序对数量。\n\n除第一行外第 $i$ 行表示第 $i - 1$ 次操作后序列的逆序对数。", "hint": "**【样例解释 #1】**\n\n第一次操作后序列为 $1, 5, 2, 4, 3$。\n\n第二次操作后序列为 $1, 5, 2, 3, 4$。\n\n**【数据范围】**\n\n对于 $100 \\%$ 的数据，$1 \\le n,m \\le 3 \\times {10}^5$，$1 \\le k \\le n$，$1 \\le a_i \\le {10}^9$。", "locale": "zh-CN", "translations": {"en": {"title": "Sorting", "background": "", "description": "There are $n$ people standing in front of Xiao A in order. Xiao A will perform $m$ operations on these $n$ people, one after another.\n\nIn each operation, choose a position $k$. Take out from the line all people whose heights are less than or equal to the height of the person currently at position $k$. Then, sort these extracted people by height in increasing order (from shortest to tallest), and put them back into the line at the same set of positions they originally occupied, filling those positions from left to right.\n\nXiao A is interested in the number of inversions of the sequence formed by these $n$ heights. Now Xiao A wants to know the inversion count of this sequence after each operation.\n\n----\nUpdate (2021-01-17): In the $a$ sequence, an inversion is a pair $(i, j)$ such that $i < j$ and $a_i > a_j$.", "inputFormat": "The first line contains two integers $n$ and $m$, the number of people and the number of operations.\n\nThe next line contains $n$ integers $a_i$, representing the heights from left to right in the initial state.\n\nEach of the next $m$ lines contains one integer, the $k$ for that operation.", "outputFormat": "Output $m + 1$ lines. The first line is the number of inversions before any operation.\n\nFor $i \\ge 2$, line $i$ is the inversion count after the $(i - 1)$-th operation.", "hint": "[Sample Explanation #1]\nAfter the first operation, the sequence is $1, 5, 2, 4, 3$.\nAfter the second operation, the sequence is $1, 5, 2, 3, 4$.\n\nConstraints\nFor $100 \\%$ of the testdata, $1 \\le n,m \\le 3 \\times 10^5$, $1 \\le k \\le n$, $1 \\le a_i \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "排序", "background": "", "description": "有 $n$ 个人依次站在小 A 面前。小 A 会依次对这 $n$ 个人进行 $m$ 次操作。\n\n每次操作选择一个位置 $k$，将这 $n$ 个人中的所有身高小于等于当前 $k$ 位置的人的身高的人从队伍里拎出，然后按照身高从矮到高的顺序从左到右依次插入到 这些人原本的位置当中。\n\n小 A 对这 $n$ 个人身高构成的序列的逆序对很感兴趣。现在小 A 想要知道每一次操作后这个序列的逆序对数。\n\n----\n\nUpdate（2021-01-17）：$a$ 序列中的逆序对的定义是满足 $i < j$ 且 $a_i > a_j$ 的数对 $(i, j)$。", "inputFormat": "第一行两个整数 $n$ 和 $m$，表示人数和操作数。\n\n接下来一行 $n$ 个整数 $a_i$，表示初始状态从左到右每个人的身高。\n\n接下来 $m$ 行每行一个数，表示这次操作的 $k$。", "outputFormat": "输出共 $m + 1$ 行，第一行表示未操作时的逆序对数量。\n\n除第一行外第 $i$ 行表示第 $i - 1$ 次操作后序列的逆序对数。", "hint": "**【样例解释 #1】**\n\n第一次操作后序列为 $1, 5, 2, 4, 3$。\n\n第二次操作后序列为 $1, 5, 2, 3, 4$。\n\n**【数据范围】**\n\n对于 $100 \\%$ 的数据，$1 \\le n,m \\le 3 \\times {10}^5$，$1 \\le k \\le n$，$1 \\le a_i \\le {10}^9$。", "locale": "zh-CN"}}}
{"pid": "P3150", "type": "P", "difficulty": 3, "samples": [["5\n1\n3\n7\n20\n5", "zs wins\nzs wins\nzs wins\npb wins\nzs wins\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["博弈论"], "title": "pb的游戏（1）", "background": "有一天 pb 和 zs 玩游戏  你需要帮 zs 求出每局的胜败情况。", "description": "游戏规则是这样的：\n\n- 先手对给出的数进行分割，分割成两个正整数之和，接着后手选择上一轮分割出的两个数中的其中一个再次进行分割。两人轮流操作，直到一方无法操作，另一方胜利。\n\n现在要你求出 $N$ 次游戏的胜败。\n\n我们认为双方绝顶聪明。每局由 pb 先进行分割。如果 pb 存在必胜策略，输出 `pb wins`；否则输出 `zs wins`。", "inputFormat": "第一行一个数 $N$，表示数据组数。\n\n之后 $N$ 行，每行一个数 $M$，表示每局初始的数。", "outputFormat": "共 $N$ 行，每行一串字符，表示游戏结果。", "hint": "对于全部数据，$1<N<50$，$1\\le M\\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "pb's Game (1)", "background": "One day pb and zs played a game. You need to help zs determine the winner of each round.", "description": "The rules are as follows:\n- The first player splits the given number into the sum of two positive integers. Then the second player chooses one of the two numbers produced in the previous move and splits it again. The two players take turns. When a player cannot make a move, the other player wins.\n\nNow you need to determine the winner for $N$ games.\n\nWe assume both players play optimally. In each game, pb moves first. If pb has a winning strategy, output `pb wins`; otherwise output `zs wins`.", "inputFormat": "The first line contains an integer $N$, the number of test cases.\n\nThen follow $N$ lines. Each line contains an integer $M$, the initial number for that game.", "outputFormat": "Output $N$ lines. Each line contains a string indicating the game result.", "hint": "Constraints: For all testdata, $1 < N < 50$, $1 \\le M \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "pb的游戏（1）", "background": "有一天 pb 和 zs 玩游戏  你需要帮 zs 求出每局的胜败情况。", "description": "游戏规则是这样的：\n\n- 先手对给出的数进行分割，分割成两个正整数之和，接着后手选择上一轮分割出的两个数中的其中一个再次进行分割。两人轮流操作，直到一方无法操作，另一方胜利。\n\n现在要你求出 $N$ 次游戏的胜败。\n\n我们认为双方绝顶聪明。每局由 pb 先进行分割。如果 pb 存在必胜策略，输出 `pb wins`；否则输出 `zs wins`。", "inputFormat": "第一行一个数 $N$，表示数据组数。\n\n之后 $N$ 行，每行一个数 $M$，表示每局初始的数。", "outputFormat": "共 $N$ 行，每行一串字符，表示游戏结果。", "hint": "对于全部数据，$1<N<50$，$1\\le M\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P3152", "type": "P", "difficulty": 2, "samples": [["2", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "递归"], "title": "正整数序列", "background": null, "description": "kkk 制造了一个序列，这个序列里的数全是由正整数构成的。你别认为她的数列很神奇——其实就是 $1, 2, …, n$ 而已。当然，$n$ 是给定的。kkk 的同学 lzn 认为 $0$ 是一个好数字（看上去很饱满有木有），所以他机智的趁 kkk 不在把这个序列全变成了 $0$（其实只是准备窝）~\n\n可是 kkk 突然回来了！于是 lzn 的计划破灭了。但是他并不甘心，就和 kkk 说：我可以每次从这个序列中选取一些数，然后一起减去一个相同的数（当然也是正整数）。然后经过有(wu)限(qiong)次这样的操作后，这个序列就可以全变成 $0$。\n\nkkk 当然不信咯，于是 lzn 就求出了他最少要做几次这样的操作，才能使这个序列全部变成 $0$。", "inputFormat": "一个正整数 $n$。", "outputFormat": "输出最少操作次数，如果无解输出 ```-1```。", "hint": "**数据范围**\n\n对于全部数据，$1 \\le n \\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "Sequence of Positive Integers", "background": "", "description": "kkk made a sequence consisting entirely of positive integers. Don’t think it’s anything magical — it’s just $1, 2, …, n$, and $n$ is given. kkk’s classmate lzn thinks $0$ is a nice number (it looks very round), so when kkk wasn’t around, he cleverly changed the whole sequence into $0$ (well, he was just getting ready to do so).\n\nBut kkk suddenly came back! lzn’s plan failed. Unwilling to give up, he told kkk: each time, I can select some numbers from this sequence and subtract the same positive integer from all of them. After a finite number of such operations, the entire sequence can become $0$.\n\nkkk didn’t believe it, so lzn calculated the minimum number of such operations needed to make the entire sequence become $0$.", "inputFormat": "A positive integer $n$.", "outputFormat": "Output the minimum number of operations. If there is no solution, output ```-1```.", "hint": "Constraints\n\nFor all testdata, $1 \\le n \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "正整数序列", "background": null, "description": "kkk 制造了一个序列，这个序列里的数全是由正整数构成的。你别认为她的数列很神奇——其实就是 $1, 2, …, n$ 而已。当然，$n$ 是给定的。kkk 的同学 lzn 认为 $0$ 是一个好数字（看上去很饱满有木有），所以他机智的趁 kkk 不在把这个序列全变成了 $0$（其实只是准备窝）~\n\n可是 kkk 突然回来了！于是 lzn 的计划破灭了。但是他并不甘心，就和 kkk 说：我可以每次从这个序列中选取一些数，然后一起减去一个相同的数（当然也是正整数）。然后经过有(wu)限(qiong)次这样的操作后，这个序列就可以全变成 $0$。\n\nkkk 当然不信咯，于是 lzn 就求出了他最少要做几次这样的操作，才能使这个序列全部变成 $0$。", "inputFormat": "一个正整数 $n$。", "outputFormat": "输出最少操作次数，如果无解输出 ```-1```。", "hint": "**数据范围**\n\n对于全部数据，$1 \\le n \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P3153", "type": "P", "difficulty": 6, "samples": [["3 0\nYYY\nYYY\nYYY", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2009", "重庆", "二分", "各省省选", "网络流"], "title": "[CQOI2009] 跳舞", "background": "", "description": "一次舞会有 $n$ 个男孩和 $n$ 个女孩。\n\n每首曲子开始时，所有男孩和女孩恰好配成 $n$ 对跳交谊舞。每个男孩都不会和同一个女孩跳两首（或更多）舞曲。\n\n有一些男孩女孩相互喜欢，而其他相互不喜欢（不会“单向喜欢”）。每个男孩最多只愿意和 $k$ 个不喜欢的女孩跳舞，而每个女孩也最多只愿意和 $k$ 个不喜欢的男孩跳舞。\n\n给出每对男孩女孩是否相互喜欢的信息，舞会最多能有几首舞曲？", "inputFormat": "第一行包含两个整数 $n$ 和 $k$。\n\n以下 $n$ 行每行包含 $n$ 个字符，每个字符只可能是 `Y` 或 `N`。第 $(i + 1)$ 行的第 $j$ 个字符为 `Y` 当且仅当男孩 $i$ 和女孩 $j$ 相互喜欢。\n", "outputFormat": "一行一个整数代表舞曲数目的最大值。", "hint": "#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，保证 $1\\leq n\\leq 50$，$0\\leq k\\leq 30$。", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2009] Dancing", "background": "", "description": "There are $n$ boys and $n$ girls at a party.\n\nAt the start of each song, all boys and girls are paired into exactly $n$ couples to dance ballroom. No boy ever dances two (or more) songs with the same girl.\n\nSome boy–girl pairs mutually like each other, while others mutually do not; there are no \"one-way likes.\" Each boy is willing to dance with at most $k$ girls he does not like, and each girl is willing to dance with at most $k$ boys she does not like.\n\nGiven the mutual-like information for every boy–girl pair, what is the maximum number of songs the party can have?", "inputFormat": "The first line contains two integers $n$ and $k$.\n\nEach of the next $n$ lines contains $n$ characters, and each character is either `Y` or `N`. The $j$-th character on line $(i + 1)$ is `Y` if and only if boy $i$ and girl $j$ mutually like each other.", "outputFormat": "Output a single integer on one line, representing the maximum number of songs.", "hint": "Constraints\n- For $100\\%$ of the testdata, it is guaranteed that $1 \\le n \\le 50$, $0 \\le k \\le 30$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2009] 跳舞", "background": "", "description": "一次舞会有 $n$ 个男孩和 $n$ 个女孩。\n\n每首曲子开始时，所有男孩和女孩恰好配成 $n$ 对跳交谊舞。每个男孩都不会和同一个女孩跳两首（或更多）舞曲。\n\n有一些男孩女孩相互喜欢，而其他相互不喜欢（不会“单向喜欢”）。每个男孩最多只愿意和 $k$ 个不喜欢的女孩跳舞，而每个女孩也最多只愿意和 $k$ 个不喜欢的男孩跳舞。\n\n给出每对男孩女孩是否相互喜欢的信息，舞会最多能有几首舞曲？", "inputFormat": "第一行包含两个整数 $n$ 和 $k$。\n\n以下 $n$ 行每行包含 $n$ 个字符，每个字符只可能是 `Y` 或 `N`。第 $(i + 1)$ 行的第 $j$ 个字符为 `Y` 当且仅当男孩 $i$ 和女孩 $j$ 相互喜欢。\n", "outputFormat": "一行一个整数代表舞曲数目的最大值。", "hint": "#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，保证 $1\\leq n\\leq 50$，$0\\leq k\\leq 30$。", "locale": "zh-CN"}}}
{"pid": "P3154", "type": "P", "difficulty": 5, "samples": [["6\n5 6 7 7 8 8", "121"]], "limits": {"time": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2009", "重庆", "各省省选", "剪枝", "前缀和"], "title": "[CQOI2009] 循环赛", "background": "", "description": "$n$ 支队伍比赛，每两支队伍比赛一次，平 $1$ 胜 $3$ 负 $0$。\n\n给出队伍的最终得分，求有多少种可能的分数表。\n\n```平1胜3负0```指：\n\n- 若两支队伍打平，则各得到 $1$ 分；\n- 否则，胜利的队伍得到 $3$ 分，被打败的队伍得到 $0$ 分。\n", "inputFormat": "第一行包含一个正整数 $n$，表示队伍的个数。第二行包含 $n$ 个非负整数，即每支队伍的得分。\n", "outputFormat": "输出仅一行，即可能的分数表数目。保证至少存在一个可能的分数表。\n", "hint": "所有数据满足 $n\\le 8$。", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2009] Round-robin Tournament", "background": "", "description": "$n$ teams play a round-robin: every pair of teams plays exactly once, and a draw gives $1$, a win $3$, and a loss $0$ points.\n\nGiven the teams’ final scores, find how many possible scoreboards there are.\n\n```平1胜3负0``` means:\n- If two teams draw, each receives $1$ point.\n- Otherwise, the winner receives $3$ points, and the defeated team receives $0$ points.", "inputFormat": "The first line contains a positive integer $n$, the number of teams. The second line contains $n$ non-negative integers, the score of each team.", "outputFormat": "Output a single line: the number of possible scoreboards. It is guaranteed that at least one possible scoreboard exists.", "hint": "All testdata satisfy $n \\le 8$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2009] 循环赛", "background": "", "description": "$n$ 支队伍比赛，每两支队伍比赛一次，平 $1$ 胜 $3$ 负 $0$。\n\n给出队伍的最终得分，求有多少种可能的分数表。\n\n```平1胜3负0```指：\n\n- 若两支队伍打平，则各得到 $1$ 分；\n- 否则，胜利的队伍得到 $3$ 分，被打败的队伍得到 $0$ 分。\n", "inputFormat": "第一行包含一个正整数 $n$，表示队伍的个数。第二行包含 $n$ 个非负整数，即每支队伍的得分。\n", "outputFormat": "输出仅一行，即可能的分数表数目。保证至少存在一个可能的分数表。\n", "hint": "所有数据满足 $n\\le 8$。", "locale": "zh-CN"}}}
{"pid": "P3155", "type": "P", "difficulty": 4, "samples": [["5 3\n0\n1\n0\n1 4\n2 5\n4 5\n3 5", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2009", "重庆", "各省省选", "树形 DP"], "title": "[CQOI2009] 叶子的染色", "background": "", "description": "给一棵 $m$ 个结点的无根树，你可以选择一个度数大于 $1$ 的结点作为根，然后给一些结点（根、内部结点和叶子均可）着以黑色或白色。\n\n你的着色方案应该保证根结点到每个叶子的简单路径上都至少包含一个有色结点（哪怕是这个叶子本身）。 \n\n对于每个叶结点 $u$，定义 $c_u$ 为从根结点到 $u$ 的简单路径上最后一个有色结点的颜色。给出每个 $c_u$ 的值，设计着色方案，使得着色结点的个数尽量少。", "inputFormat": "第一行包含两个整数 $m,n$，其中 $n$ 是叶子的个数，$m$ 是结点总数。结点编号为 $1,2,\\ldots,m$，其中编号 $1,2,\\ldots ,n$ 是叶子。\n\n以下 $n$ 行每行一个 $0$ 或 $1$ 的整数（$0$ 表示黑色，$1$ 表示白色），依次为 $c_1,c_2,\\ldots,c_n$。\n\n以下 $m-1$ 行每行两个整数 $a,b$，表示结点 $a$ 和 $b$ 有边相连。", "outputFormat": "仅一个数，即着色结点数的最小值。\n", "hint": "#### 数据规模与约定\n对于全部的测试点，保证 $1\\le m\\le 10^4$，$1\\le n\\le 5021$，$1\\le a < b \\le m$。", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2009] Coloring the Leaves", "background": "", "description": "Given an unrooted tree with $m$ nodes, you may choose any node with degree greater than $1$ as the root, and then color some nodes (the root, internal nodes, and leaves are all allowed) black or white.\n\nYour coloring must ensure that on the simple path from the root to each leaf, there is at least one colored node (possibly the leaf itself).\n\nFor each leaf node $u$, define $c_u$ as the color of the last colored node on the simple path from the root to $u$. Given all values of $c_u$, design a coloring scheme that minimizes the number of colored nodes.", "inputFormat": "The first line contains two integers $m, n$, where $n$ is the number of leaves and $m$ is the total number of nodes. Nodes are numbered $1, 2, \\ldots, m$, and nodes $1, 2, \\ldots, n$ are leaves.\n\nEach of the next $n$ lines contains an integer $0$ or $1$ ($0$ means black, $1$ means white), in order $c_1, c_2, \\ldots, c_n$.\n\nEach of the next $m-1$ lines contains two integers $a, b$, indicating that nodes $a$ and $b$ are connected by an edge.", "outputFormat": "Output a single integer: the minimum number of colored nodes.", "hint": "#### Constraints\nFor all testdata, it is guaranteed that $1 \\le m \\le 10^4$, $1 \\le n \\le 5021$, $1 \\le a < b \\le m$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2009] 叶子的染色", "background": "", "description": "给一棵 $m$ 个结点的无根树，你可以选择一个度数大于 $1$ 的结点作为根，然后给一些结点（根、内部结点和叶子均可）着以黑色或白色。\n\n你的着色方案应该保证根结点到每个叶子的简单路径上都至少包含一个有色结点（哪怕是这个叶子本身）。 \n\n对于每个叶结点 $u$，定义 $c_u$ 为从根结点到 $u$ 的简单路径上最后一个有色结点的颜色。给出每个 $c_u$ 的值，设计着色方案，使得着色结点的个数尽量少。", "inputFormat": "第一行包含两个整数 $m,n$，其中 $n$ 是叶子的个数，$m$ 是结点总数。结点编号为 $1,2,\\ldots,m$，其中编号 $1,2,\\ldots ,n$ 是叶子。\n\n以下 $n$ 行每行一个 $0$ 或 $1$ 的整数（$0$ 表示黑色，$1$ 表示白色），依次为 $c_1,c_2,\\ldots,c_n$。\n\n以下 $m-1$ 行每行两个整数 $a,b$，表示结点 $a$ 和 $b$ 有边相连。", "outputFormat": "仅一个数，即着色结点数的最小值。\n", "hint": "#### 数据规模与约定\n对于全部的测试点，保证 $1\\le m\\le 10^4$，$1\\le n\\le 5021$，$1\\le a < b \\le m$。", "locale": "zh-CN"}}}
{"pid": "P3156", "type": "P", "difficulty": 1, "samples": [["10 3\n1 9 2 60 8 17 11 4 5 14\n1 5 9\n", "1\n8\n5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "【深基15.例1】询问学号", "background": "", "description": "有 $n(n \\le 2 \\times 10^6)$ 名同学陆陆续续进入教室。我们知道每名同学的学号（在 $1$ 到 $10^9$ 之间），按进教室的顺序给出。上课了，老师想知道第 $i$ 个进入教室的同学的学号是什么（最先进入教室的同学 $i=1$），询问次数不超过 $10^5$ 次。", "inputFormat": "第一行 $2$ 个整数 $n$ 和 $m$，表示学生个数和询问次数。\n\n第二行 $n$ 个整数，表示按顺序进入教室的学号。\n\n第三行 $m$ 个整数，表示询问第几个进入教室的同学。", "outputFormat": "输出 $m$ 个整数表示答案，用换行隔开。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 15. Example 1] Query Student ID Numbers", "background": "", "description": "There are $n(n \\le 2 \\times 10^6)$ students entering the classroom one after another. We know each student’s ID number (between $1$ and $10^9$), given in the order they enter the classroom. Class starts, and the teacher wants to know what the ID number of the $i$-th student who entered the classroom is (the first student to enter has $i=1$). The number of queries does not exceed $10^5$.", "inputFormat": "The first line contains $2$ integers $n$ and $m$, representing the number of students and the number of queries.\n\nThe second line contains $n$ integers, representing the ID numbers in the order they enter the classroom.\n\nThe third line contains $m$ integers, representing queries asking for which student (by entry order) to check.", "outputFormat": "Output $m$ integers as the answers, separated by newlines.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基15.例1】询问学号", "background": "", "description": "有 $n(n \\le 2 \\times 10^6)$ 名同学陆陆续续进入教室。我们知道每名同学的学号（在 $1$ 到 $10^9$ 之间），按进教室的顺序给出。上课了，老师想知道第 $i$ 个进入教室的同学的学号是什么（最先进入教室的同学 $i=1$），询问次数不超过 $10^5$ 次。", "inputFormat": "第一行 $2$ 个整数 $n$ 和 $m$，表示学生个数和询问次数。\n\n第二行 $n$ 个整数，表示按顺序进入教室的学号。\n\n第三行 $m$ 个整数，表示询问第几个进入教室的同学。", "outputFormat": "输出 $m$ 个整数表示答案，用换行隔开。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3157", "type": "P", "difficulty": 6, "samples": [["5 4\n1\n5\n3\n4\n2\n5\n1\n4\n2", "5\n2\n2\n1"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2011", "重庆", "各省省选", "树状数组", "cdq 分治", "树套树", "可持久化线段树", "分块", "整体二分"], "title": "[CQOI2011] 动态逆序对", "background": "", "description": "对于序列 $a$，它的逆序对数定义为集合  \n$$\\{(i,j)| i<j \\wedge a_i > a_j \\}$$\n中的元素个数。  \n\n现在给出 $1\\sim n$ 的一个排列，按照某种顺序依次删除 $m$ 个元素，你的任务是在每次删除一个元素**之前**统计整个序列的逆序对数。\n", "inputFormat": "第一行包含两个整数 $n$ 和 $m$，即初始元素的个数和删除的元素个数。  \n以下 $n$ 行，每行包含一个 $1 \\sim n$ 之间的正整数，即初始排列。  \n接下来 $m$ 行，每行一个正整数，依次为每次删除的元素。\n", "outputFormat": "输出包含 $m$ 行，依次为删除每个元素之前，逆序对的个数。\n", "hint": "【数据范围】   \n对于 $100\\%$ 的数据，$1\\le n \\le 10^5$，$1\\le m \\le 50000$。\n\n【样例解释】  \n删除每个元素之前的序列依次为：  \n$$1,5,3,4,2$$  \n$$1,3,4,2$$  \n$$3,4,2$$  \n$$3,2$$  ", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2011] Dynamic Inversions", "background": "", "description": "For a sequence $a$, its number of inversions is defined as the size of the set  \n$$\\{(i,j)\\mid i<j \\wedge a_i > a_j \\}.$$\nYou are given a permutation of $1\\sim n$. According to some order, $m$ elements are deleted one by one. Your task is to count the number of inversions of the entire sequence before each deletion.", "inputFormat": "The first line contains two integers $n$ and $m$, which are the initial number of elements and the number of deletions.  \nThe next $n$ lines each contain a positive integer between $1 \\sim n$, which is the initial permutation.  \nThen the next $m$ lines each contain a positive integer, in order, which is the element to delete at each step.", "outputFormat": "Output $m$ lines, where the $i$-th line is the number of inversions before deleting the $i$-th element.", "hint": "Constraints  \nFor $100\\%$ of the testdata, $1 \\le n \\le 10^5$, $1 \\le m \\le 50000$.\n\nSample Explanation  \nThe sequences before each deletion are:  \n$$1,5,3,4,2$$  \n$$1,3,4,2$$  \n$$3,4,2$$  \n$$3,2$$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2011] 动态逆序对", "background": "", "description": "对于序列 $a$，它的逆序对数定义为集合  \n$$\\{(i,j)| i<j \\wedge a_i > a_j \\}$$\n中的元素个数。  \n\n现在给出 $1\\sim n$ 的一个排列，按照某种顺序依次删除 $m$ 个元素，你的任务是在每次删除一个元素**之前**统计整个序列的逆序对数。\n", "inputFormat": "第一行包含两个整数 $n$ 和 $m$，即初始元素的个数和删除的元素个数。  \n以下 $n$ 行，每行包含一个 $1 \\sim n$ 之间的正整数，即初始排列。  \n接下来 $m$ 行，每行一个正整数，依次为每次删除的元素。\n", "outputFormat": "输出包含 $m$ 行，依次为删除每个元素之前，逆序对的个数。\n", "hint": "【数据范围】   \n对于 $100\\%$ 的数据，$1\\le n \\le 10^5$，$1\\le m \\le 50000$。\n\n【样例解释】  \n删除每个元素之前的序列依次为：  \n$$1,5,3,4,2$$  \n$$1,3,4,2$$  \n$$3,4,2$$  \n$$3,2$$  ", "locale": "zh-CN"}}}
{"pid": "P3158", "type": "P", "difficulty": 6, "samples": [["4 2 2\n3 1", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2011", "重庆", "各省省选", "容斥原理"], "title": "[CQOI2011] 放棋子", "background": "", "description": "在一个 $m$ 行 $n$ 列的棋盘里放一些彩色的棋子，使得每个格子最多放一个棋子，且不同颜色的棋子不能在同一行或者同一列，有多少种方法？\n\n例如，$n=m=3$，有两个白棋子和一个灰棋子，下面左边两种方法都是合法的，但右边两种都是非法的。\n\n![](https://cdn.luogu.com.cn/upload/pic/28150.png)", "inputFormat": "输入第一行为两个整数 $n,m,c$，即行数、列数和棋子的颜色数。\n\n第二行包含 $c$ 个正整数，即每个颜色的棋子数。", "outputFormat": "输出仅一行，即方案总数除以 $10^9+9$ 的余数。", "hint": "对于 $100\\%$ 的测试数据，满足 $1\\le n,m\\le 30$，$1\\le c\\le 10$，$\\texttt{总棋子数}\\le n\\times m$。", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2011] Placing Pieces", "background": "", "description": "On an $m$-row by $n$-column board, place some colored pieces so that each cell contains at most one piece, and pieces of different colors cannot lie in the same row or the same column. How many ways are there?\n\nFor example, when $n=m=3$, there are two white pieces and one gray piece. The two arrangements on the left below are valid, while the two on the right are invalid.\n\n![](https://cdn.luogu.com.cn/upload/pic/28150.png)", "inputFormat": "The first line contains three integers $n,m,c$, which are the numbers of rows, columns, and colors.\n\nThe second line contains $c$ positive integers, which are the number of pieces of each color.", "outputFormat": "Output a single line: the remainder when the total number of arrangements is divided by $10^9+9$.", "hint": "For $100\\%$ of the testdata, $1\\le n,m\\le 30$, $1\\le c\\le 10$, and the total number of pieces $\\le n\\times m$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2011] 放棋子", "background": "", "description": "在一个 $m$ 行 $n$ 列的棋盘里放一些彩色的棋子，使得每个格子最多放一个棋子，且不同颜色的棋子不能在同一行或者同一列，有多少种方法？\n\n例如，$n=m=3$，有两个白棋子和一个灰棋子，下面左边两种方法都是合法的，但右边两种都是非法的。\n\n![](https://cdn.luogu.com.cn/upload/pic/28150.png)", "inputFormat": "输入第一行为两个整数 $n,m,c$，即行数、列数和棋子的颜色数。\n\n第二行包含 $c$ 个正整数，即每个颜色的棋子数。", "outputFormat": "输出仅一行，即方案总数除以 $10^9+9$ 的余数。", "hint": "对于 $100\\%$ 的测试数据，满足 $1\\le n,m\\le 30$，$1\\le c\\le 10$，$\\texttt{总棋子数}\\le n\\times m$。", "locale": "zh-CN"}}}
{"pid": "P3159", "type": "P", "difficulty": 6, "samples": [["3 3\n110\n000\n001\n000\n110\n100\n222\n222\n222", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "重庆", "各省省选", "网络流", "费用流"], "title": "[CQOI2012] 交换棋子", "background": "", "description": "有一个 $n$ 行 $m$ 列的黑白棋盘，你每次可以交换两个相邻格子（**相邻是指有公共边或公共顶点**）中的棋子，最终达到目标状态。要求第 $i$ 行第 $j$ 列的格子只能参与 $m_{i,j}$ 次交换。", "inputFormat": "第一行包含两个整数 $n,m$。以下 $n$ 行为初始状态，每行为一个包含 $m$ 个字符的 $01$ 串，其中 $0$ 表示黑色棋子，$1$ 表示白色棋子。以下 $n$ 行为目标状态，格式同初始状态。以下 $n$ 行每行为一个包含 $m$ 个 $0\\sim9$ 数字的字符串，表示每个格子参与交换的次数上限。\n", "outputFormat": "输出仅一行，为最小交换总次数。如果无解，输出 $-1$。", "hint": "### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq20$。", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2012] Swap Pieces", "background": "", "description": "There is a black-and-white board with $n$ rows and $m$ columns. Each time, you may swap the pieces in two adjacent cells (**adjacent means sharing an edge or a vertex**) to reach a target state. The cell at row $i$, column $j$ may participate in at most $m_{i,j}$ swaps.", "inputFormat": "The first line contains two integers $n, m$.  \nThe next $n$ lines describe the initial state; each line is a binary string of length $m$, where $0$ denotes a black piece and $1$ denotes a white piece.  \nThe next $n$ lines describe the target state in the same format as the initial state.  \nThe next $n$ lines each contain a string of $m$ digits from '0' to '9', representing the upper bound on the number of times each cell may participate in swaps.", "outputFormat": "Output a single line with the minimum total number of swaps. If there is no solution, output $-1$.", "hint": "### Constraints\n\nFor $100\\%$ of the testdata, $1 \\le n, m \\le 20$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2012] 交换棋子", "background": "", "description": "有一个 $n$ 行 $m$ 列的黑白棋盘，你每次可以交换两个相邻格子（**相邻是指有公共边或公共顶点**）中的棋子，最终达到目标状态。要求第 $i$ 行第 $j$ 列的格子只能参与 $m_{i,j}$ 次交换。", "inputFormat": "第一行包含两个整数 $n,m$。以下 $n$ 行为初始状态，每行为一个包含 $m$ 个字符的 $01$ 串，其中 $0$ 表示黑色棋子，$1$ 表示白色棋子。以下 $n$ 行为目标状态，格式同初始状态。以下 $n$ 行每行为一个包含 $m$ 个 $0\\sim9$ 数字的字符串，表示每个格子参与交换的次数上限。\n", "outputFormat": "输出仅一行，为最小交换总次数。如果无解，输出 $-1$。", "hint": "### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq20$。", "locale": "zh-CN"}}}
{"pid": "P3160", "type": "P", "difficulty": 6, "samples": [["3 2\nX.\n..\n.X", "60"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2012", "重庆", "各省省选", "容斥原理", "状压 DP"], "title": "[CQOI2012] 局部极小值", "background": "", "description": "有一个 $n$ 行 $m$ 列的整数矩阵，其中 $1$ 到 $n\\times m$ 之间的每个整数恰好出现一次。\n\n如果一个格子比所有相邻格子（相邻是指有公共边或公共顶点）都小，我们说这个格子是局部极小值。给出所有局部极小值的位置，你的任务是判断有多少个可能的矩阵。\n\n答案对 $12{,}345{,}678$ 取模。", "inputFormat": "输入第一行包含两个整数 $n$ 和 $m$，即行数和列数。\n\n以下 $n$ 行每行 $m$ 个字符，第 $(i + 1)$ 行的第 $j$ 个字符代表第 $i$ 列的第 $j$ 个格子是否是局部极小值，该字符只可能是 `X` 或 `.`，其中 `X` 表示局部极小值，`.` 表示非局部极小值。", "outputFormat": "输出仅一行，为可能的矩阵总数除以 $12345678$ 的余数。", "hint": "#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，保证 $1\\le n\\le4$，$1\\le m\\le7$。", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2012] Local Minima", "background": "", "description": "There is an $n$ by $m$ integer matrix in which each integer between $1$ and $n \\times m$ appears exactly once.\n\nIf a cell is smaller than all of its adjacent cells (adjacent means sharing a side or a vertex), we say this cell is a local minimum. Given the positions of all local minima, your task is to determine how many matrices are possible.\n\nOutput the answer modulo $12{,}345{,}678$.", "inputFormat": "The first line contains two integers $n$ and $m$, the number of rows and columns.\n\nEach of the next $n$ lines contains $m$ characters. For each $i$ from $1$ to $n$, the $ (i + 1) $-th line’s $j$-th character represents whether the cell at row $i$ and column $j$ is a local minimum. Each character is either `X` or `.`, where `X` denotes a local minimum and `.` denotes a non-local minimum.", "outputFormat": "Output a single line containing the number of possible matrices modulo $12{,}345{,}678$.", "hint": "- Constraints  \n  - For $100\\%$ of the testdata, $1 \\le n \\le 4$, $1 \\le m \\le 7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2012] 局部极小值", "background": "", "description": "有一个 $n$ 行 $m$ 列的整数矩阵，其中 $1$ 到 $n\\times m$ 之间的每个整数恰好出现一次。\n\n如果一个格子比所有相邻格子（相邻是指有公共边或公共顶点）都小，我们说这个格子是局部极小值。给出所有局部极小值的位置，你的任务是判断有多少个可能的矩阵。\n\n答案对 $12{,}345{,}678$ 取模。", "inputFormat": "输入第一行包含两个整数 $n$ 和 $m$，即行数和列数。\n\n以下 $n$ 行每行 $m$ 个字符，第 $(i + 1)$ 行的第 $j$ 个字符代表第 $i$ 列的第 $j$ 个格子是否是局部极小值，该字符只可能是 `X` 或 `.`，其中 `X` 表示局部极小值，`.` 表示非局部极小值。", "outputFormat": "输出仅一行，为可能的矩阵总数除以 $12345678$ 的余数。", "hint": "#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，保证 $1\\le n\\le4$，$1\\le m\\le7$。", "locale": "zh-CN"}}}
{"pid": "P3161", "type": "P", "difficulty": 6, "samples": [["2\n5 1 8\n7 15 3", "11"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "贪心", "2012", "重庆", "各省省选"], "title": "[CQOI2012] 模拟工厂", "background": "", "description": "有一个称为“模拟工厂”的游戏是这样的：在时刻 $0$，工厂的生产力等于 $1$。在每个时刻，你可以提高生产力或者生产商品。如果选择提高生产力，在下一个时刻时工厂的生产力加 $1$；如果选择生产商品，则下一个时刻你所拥有的商品数量增加 $p$，其中 $p$ 是本时刻工厂的生产力。  \n\n有 $n$ 个订单，可以选择接受或者不接受。第 $i$ 个订单 $(t_i, g_i, m_i)$ 要求在时刻 $t_i$ 给买家提供 $g_i$ 个商品，事成之后商品数量减少 $g_i$，而收入增加 $m_i$ 元。如果接受订单 $i$，则必须恰好在时刻 $t_i$ 交易，不能早也不能晚。同一时刻可以接受多个订单，但每个订单只能被接受一次。要求最后的总收入最大。  \n\n例如，如果一共有两个订单 $(5,1,8)$ 和 $(7,15,3)$，用如下策略是最优的：时刻 $0$, $1$, $2$ 提高生产力（时刻 $3$ 的生产力为 $4$），然后在时刻 $3$，$4$ 生产商品，则在时刻 $5$ 时将拥有 $8$ 个商品。此时接受第 $1$ 个订单（还会剩下 $7$ 个商品），并且在时刻 $5$，$6$ 继续生产商品，则在时刻 $7$ 时拥有 $7+4+4=15$ 个商品，正好满足订单 $2$。", "inputFormat": "输入第一行包含一个整数 $n$，即订单数目。以下 $n$ 行每行三个整数 $t_i, g_i, m_i$。", "outputFormat": "输出仅一行，为最大总收入。输出保证在 $32$ 位带符号整数范围内。", "hint": "**【数据范围】**\n\n| 编号 | $n \\le$ | $t_i \\le$ | $g_i \\le$ | $m_i \\le$ |\n|:-:|:-:|:-:|:-:|:-:|\n| $1 \\sim 3$ | $5$ | $100$ | $10000$ | $10000$ |\n| $4 \\sim 6$ | $10$ | $100$ | $10000$ | $10000$ |\n| $7 \\sim 10$ | $15$ | $100000$ | $10^9$ | $10^9$ |", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2012] Simulated Factory", "background": "", "description": "There is a game called “Simulated Factory” as follows: at time $0$, the factory’s productivity equals $1$. At each time, you may either increase productivity or produce goods. If you choose to increase productivity, then at the next time the factory’s productivity increases by $1$; if you choose to produce goods, then at the next time your number of goods increases by $p$, where $p$ is the factory’s productivity at the current time.\n\nThere are $n$ orders, and you may choose to accept or reject each one. The $i$-th order $(t_i, g_i, m_i)$ requires delivering $g_i$ goods to the buyer at time $t_i$. After completion, your goods decrease by $g_i$, and your revenue increases by $m_i$ yuan. If you accept order $i$, you must transact exactly at time $t_i$, neither earlier nor later. Multiple orders may be accepted at the same time, but each order can be accepted at most once. Maximize the final total revenue.\n\nFor example, if there are two orders $(5,1,8)$ and $(7,15,3)$, the following strategy is optimal: at times $0$, $1$, $2$ increase productivity (so the productivity at time $3$ is $4$), then at times $3$ and $4$ produce goods; at time $5$ you will have $8$ goods. Accept order $1$ at this time (you will still have $7$ goods left), and continue producing goods at times $5$ and $6$; then at time $7$ you will have $7+4+4=15$ goods, exactly meeting order $2$.", "inputFormat": "The first line contains an integer $n$, the number of orders. Each of the following $n$ lines contains three integers $t_i, g_i, m_i$.", "outputFormat": "Output a single line with the maximum total revenue. The answer is guaranteed to fit in the 32-bit signed integer range.", "hint": "Constraints\n\n| Index | $n \\le$ | $t_i \\le$ | $g_i \\le$ | $m_i \\le$ |\n|:-:|:-:|:-:|:-:|:-:|\n| $1 \\sim 3$ | $5$ | $100$ | $10000$ | $10000$ |\n| $4 \\sim 6$ | $10$ | $100$ | $10000$ | $10000$ |\n| $7 \\sim 10$ | $15$ | $100000$ | $10^9$ | $10^9$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2012] 模拟工厂", "background": "", "description": "有一个称为“模拟工厂”的游戏是这样的：在时刻 $0$，工厂的生产力等于 $1$。在每个时刻，你可以提高生产力或者生产商品。如果选择提高生产力，在下一个时刻时工厂的生产力加 $1$；如果选择生产商品，则下一个时刻你所拥有的商品数量增加 $p$，其中 $p$ 是本时刻工厂的生产力。  \n\n有 $n$ 个订单，可以选择接受或者不接受。第 $i$ 个订单 $(t_i, g_i, m_i)$ 要求在时刻 $t_i$ 给买家提供 $g_i$ 个商品，事成之后商品数量减少 $g_i$，而收入增加 $m_i$ 元。如果接受订单 $i$，则必须恰好在时刻 $t_i$ 交易，不能早也不能晚。同一时刻可以接受多个订单，但每个订单只能被接受一次。要求最后的总收入最大。  \n\n例如，如果一共有两个订单 $(5,1,8)$ 和 $(7,15,3)$，用如下策略是最优的：时刻 $0$, $1$, $2$ 提高生产力（时刻 $3$ 的生产力为 $4$），然后在时刻 $3$，$4$ 生产商品，则在时刻 $5$ 时将拥有 $8$ 个商品。此时接受第 $1$ 个订单（还会剩下 $7$ 个商品），并且在时刻 $5$，$6$ 继续生产商品，则在时刻 $7$ 时拥有 $7+4+4=15$ 个商品，正好满足订单 $2$。", "inputFormat": "输入第一行包含一个整数 $n$，即订单数目。以下 $n$ 行每行三个整数 $t_i, g_i, m_i$。", "outputFormat": "输出仅一行，为最大总收入。输出保证在 $32$ 位带符号整数范围内。", "hint": "**【数据范围】**\n\n| 编号 | $n \\le$ | $t_i \\le$ | $g_i \\le$ | $m_i \\le$ |\n|:-:|:-:|:-:|:-:|:-:|\n| $1 \\sim 3$ | $5$ | $100$ | $10000$ | $10000$ |\n| $4 \\sim 6$ | $10$ | $100$ | $10000$ | $10000$ |\n| $7 \\sim 10$ | $15$ | $100000$ | $10^9$ | $10^9$ |", "locale": "zh-CN"}}}
{"pid": "P3162", "type": "P", "difficulty": 6, "samples": [["3 5\n-1 3\n0 1\n2 3\n4 2\n5 2", "2.0000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "贪心", "2012", "重庆", "各省省选", "排序"], "title": "[CQOI2012] 组装", "background": "", "description": "数轴上有 $m$ 个生产车间可以生产零件。一共有 $n$ 种零件，编号为 $1\\sim n$。第 $i$ 个车间的坐标为 $x_i$ ，生产第 $p_i$ 种零件（$1\\le p_i\\le n$）。你需要在数轴上的某个位置修建一个组装车间，把这些零件组装起来。为了节约运输成本，你需要最小化 $cost_1+cost_2+\\ldots+cost_n$，其中 $cost_x$ 表示生产第 $x$ 种零件的车间中，到组装车间距离的平方的最小值。", "inputFormat": "输入第一行为两个整数 $n$, $m$ ，即零件的种类数和生产车间的个数。以下 $m$ 行每行两个整数 $x_i$ 和 $p_i$（$1\\le p_i\\le n$）。输入按照生产车间从左到右的顺序排列（即 $x_i\\le x_{i+1}$ 。注意车间位置可以重复）。输入保证每种零件都有车间生产。", "outputFormat": "输出仅一行，即组装车间的最优位置（可以和某个生产车间重合），四舍五入保留四位小数。输入保证最优位置惟一。\n", "hint": "- 测试点 $1 \\sim 4$，满足 $n\\le 15$，$m\\le 25$，$x_i\\le100$；\n- 测试点 $5 \\sim 10$，满足 $n\\le 10^4,m\\le 10^5,x_i\\le10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2012] Assembly", "background": "", "description": "There are $m$ production workshops on the number line that can produce parts. There are $n$ types of parts, numbered $1 \\sim n$. The $i$-th workshop is located at coordinate $x_i$ and produces part type $p_i$ ($1 \\le p_i \\le n$). You need to build an assembly workshop at some position on the number line to assemble these parts. To minimize transportation cost, you need to minimize $\\,$ $cost_1 + cost_2 + \\ldots + cost_n$, where $cost_x$ denotes the minimum squared distance from the assembly workshop to any workshop that produces part type $x$.", "inputFormat": "The first line contains two integers $n$, $m$, the number of part types and the number of production workshops. Each of the following $m$ lines contains two integers $x_i$ and $p_i$ ($1 \\le p_i \\le n$). The input is ordered from left to right by workshop position (i.e., $x_i \\le x_{i+1}$; note that positions may repeat). It is guaranteed that every part type has at least one workshop producing it.", "outputFormat": "Output a single line: the optimal location of the assembly workshop (it may coincide with a production workshop), rounded to four decimal places. It is guaranteed that the optimal location is unique.", "hint": "- Test points 1–4: $n \\le 15$, $m \\le 25$, $x_i \\le 100$.\n- Test points 5–10: $n \\le 10^4$, $m \\le 10^5$, $x_i \\le 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2012] 组装", "background": "", "description": "数轴上有 $m$ 个生产车间可以生产零件。一共有 $n$ 种零件，编号为 $1\\sim n$。第 $i$ 个车间的坐标为 $x_i$ ，生产第 $p_i$ 种零件（$1\\le p_i\\le n$）。你需要在数轴上的某个位置修建一个组装车间，把这些零件组装起来。为了节约运输成本，你需要最小化 $cost_1+cost_2+\\ldots+cost_n$，其中 $cost_x$ 表示生产第 $x$ 种零件的车间中，到组装车间距离的平方的最小值。", "inputFormat": "输入第一行为两个整数 $n$, $m$ ，即零件的种类数和生产车间的个数。以下 $m$ 行每行两个整数 $x_i$ 和 $p_i$（$1\\le p_i\\le n$）。输入按照生产车间从左到右的顺序排列（即 $x_i\\le x_{i+1}$ 。注意车间位置可以重复）。输入保证每种零件都有车间生产。", "outputFormat": "输出仅一行，即组装车间的最优位置（可以和某个生产车间重合），四舍五入保留四位小数。输入保证最优位置惟一。\n", "hint": "- 测试点 $1 \\sim 4$，满足 $n\\le 15$，$m\\le 25$，$x_i\\le100$；\n- 测试点 $5 \\sim 10$，满足 $n\\le 10^4,m\\le 10^5,x_i\\le10^5$。", "locale": "zh-CN"}}}
{"pid": "P3163", "type": "P", "difficulty": 6, "samples": [["4 0 1 1 2 3 1\nXOXX\nOXOX\nXOXO\nXXOX\n4 0 2 1 1 3 2\nXNXO\nNXOX\nXOXO\nOXOX\n", "Yes\nNo\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "重庆", "各省省选", "网络流"], "title": "[CQOI2014] 危桥", "background": "", "description": "Alice 和 Bob 居住在一个由 $N$ 座岛屿组成的国家，岛屿被编号为 $0$ 到 $N-1$。某些岛屿之间有桥相连，桥上的道路是双向的，但一次只能供一人通行。其中一些桥由于年久失修成为危桥，最多只能通行两次。\n\nAlice 希望在岛屿 $a_1$ 和 $a_2$ 之间往返 $a_n$ 次（从 $a1$ 到 $a2$ 再从 $a2$ 到 $a1$ 算一次往返）。同时，Bob 希望在岛屿 $b_1$ 和 $b_2$ 之间往返 $b_n$ 次。这个过程中，所有危桥最多通行两次，其余的桥可以无限次通行。请问 Alice 和 Bob 能完成他们的愿望吗？\n", "inputFormat": "本题有多组测试数据。\n\n每组数据第一行包含七个空格隔开的整数，分别为$N$、$a_1$、$a_2$、$a_n$、$b_1$、$b_2$、$b_n$。  \n接下来是一个 $N$ 行 $N$ 列的对称矩阵，由大写字母组成。矩阵的 $i$ 行 $j$ 列描述编号 $i-1$ 和 $j-1$ 的岛屿间的连接情况，若为 “`O`” 则表示有危桥相连：为 “`N`” 表示有普通的桥相连：为 “`X`” 表示没有桥相连。", "outputFormat": "对于每组测试数据输出一行，如果他们都能完成愿望输出 “Yes”，否则输出 “No”（不含引号）。\n", "hint": "对于所有数据，$4 \\leq N\\leq 50,\\ 0 \\leq a_1, a_2, b_1, b_2 \\leq N-1,\\ 1 \\leq a_n, b_n \\leq 50$。", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2014] Dangerous Bridges", "background": "", "description": "Alice and Bob live in a country consisting of $N$ islands, numbered from $0$ to $N-1$. Some pairs of islands are connected by bridges. The roads on the bridges are bidirectional, but only one person can pass at a time. Some bridges have become dangerous due to age and can be used at most twice.\n\nAlice wants to make $a_n$ round trips between islands $a_1$ and $a_2$ (a round trip means going from $a_1$ to $a_2$ and then back from $a_2$ to $a_1$). Meanwhile, Bob wants to make $b_n$ round trips between islands $b_1$ and $b_2$. During the whole process, each dangerous bridge can be used at most twice in total, while the other bridges can be used infinitely many times. Can Alice and Bob fulfill their wishes?", "inputFormat": "There are multiple test cases.\n\nFor each test case, the first line contains seven space-separated integers: $N$, $a_1$, $a_2$, $a_n$, $b_1$, $b_2$, $b_n$.  \nThen follows an $N$-by-$N$ symmetric matrix of uppercase letters. The entry at row $i$ and column $j$ describes the connection between islands numbered $i-1$ and $j-1$: if it is `O`, there is a dangerous bridge; if it is `N`, there is a normal bridge; if it is `X`, there is no bridge.", "outputFormat": "For each test case, output one line. Output “Yes” if they can both fulfill their wishes, otherwise output “No” (without quotes).", "hint": "Constraints: For all testdata, $4 \\leq N \\leq 50$, $0 \\leq a_1, a_2, b_1, b_2 \\leq N-1$, $1 \\leq a_n, b_n \\leq 50$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2014] 危桥", "background": "", "description": "Alice 和 Bob 居住在一个由 $N$ 座岛屿组成的国家，岛屿被编号为 $0$ 到 $N-1$。某些岛屿之间有桥相连，桥上的道路是双向的，但一次只能供一人通行。其中一些桥由于年久失修成为危桥，最多只能通行两次。\n\nAlice 希望在岛屿 $a_1$ 和 $a_2$ 之间往返 $a_n$ 次（从 $a1$ 到 $a2$ 再从 $a2$ 到 $a1$ 算一次往返）。同时，Bob 希望在岛屿 $b_1$ 和 $b_2$ 之间往返 $b_n$ 次。这个过程中，所有危桥最多通行两次，其余的桥可以无限次通行。请问 Alice 和 Bob 能完成他们的愿望吗？\n", "inputFormat": "本题有多组测试数据。\n\n每组数据第一行包含七个空格隔开的整数，分别为$N$、$a_1$、$a_2$、$a_n$、$b_1$、$b_2$、$b_n$。  \n接下来是一个 $N$ 行 $N$ 列的对称矩阵，由大写字母组成。矩阵的 $i$ 行 $j$ 列描述编号 $i-1$ 和 $j-1$ 的岛屿间的连接情况，若为 “`O`” 则表示有危桥相连：为 “`N`” 表示有普通的桥相连：为 “`X`” 表示没有桥相连。", "outputFormat": "对于每组测试数据输出一行，如果他们都能完成愿望输出 “Yes”，否则输出 “No”（不含引号）。\n", "hint": "对于所有数据，$4 \\leq N\\leq 50,\\ 0 \\leq a_1, a_2, b_1, b_2 \\leq N-1,\\ 1 \\leq a_n, b_n \\leq 50$。", "locale": "zh-CN"}}}
{"pid": "P3164", "type": "P", "difficulty": 6, "samples": [["4 4", "0 1 0 0\n1 1 1 0\n0 0 0 1\n1 1 0 1\n\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "重庆", "各省省选", "Special Judge", "高斯消元"], "title": "[CQOI2014] 和谐矩阵", "background": "", "description": "我们称一个由 $0$ 和 $1$ 组成的矩阵是和谐的，当且仅当每个元素都有偶数个相邻的 $1$。一个元素相邻的元素包括它本身，及他上下左右的 $4$ 个元素（如果存在）。给定矩阵的行数和列数，请计算并输出一个和谐的矩阵。注意：所有元素为 $0$ 的矩阵是不允许的。\n", "inputFormat": "输入一行，包含两个空格分隔的整数 $m$ 和 $n$，分别表示矩阵的行数和列数。\n", "outputFormat": "输出包含 $m$ 行，每行 $n$ 个空格分隔整数（$0$ 或 $1$），为所求矩阵。测试数据保证有解。\n", "hint": "数据范围\n\n$1\\le n,m\\le 40$。\n\n感谢@miaomiao 提供spj。\n", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2014] Harmonious Matrix", "background": "", "description": "We call a matrix composed of $0$ and $1$ harmonious if and only if every element has an even number of adjacent $1$'s. The neighbors of an element include the element itself and its four neighbors above, below, left, and right (if they exist). Given the number of rows and columns of the matrix, compute and output a harmonious matrix. Note: the all-zero matrix is not allowed.", "inputFormat": "The input consists of one line containing two space-separated integers $m$ and $n$, denoting the number of rows and columns of the matrix.", "outputFormat": "Output $m$ lines, each containing $n$ space-separated integers ($0$ or $1$), forming the required matrix. The testdata guarantees that a solution exists.", "hint": "Constraints\n\n$1\\le n,m\\le 40$.\n\nThanks to @miaomiao for providing the SPJ.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2014] 和谐矩阵", "background": "", "description": "我们称一个由 $0$ 和 $1$ 组成的矩阵是和谐的，当且仅当每个元素都有偶数个相邻的 $1$。一个元素相邻的元素包括它本身，及他上下左右的 $4$ 个元素（如果存在）。给定矩阵的行数和列数，请计算并输出一个和谐的矩阵。注意：所有元素为 $0$ 的矩阵是不允许的。\n", "inputFormat": "输入一行，包含两个空格分隔的整数 $m$ 和 $n$，分别表示矩阵的行数和列数。\n", "outputFormat": "输出包含 $m$ 行，每行 $n$ 个空格分隔整数（$0$ 或 $1$），为所求矩阵。测试数据保证有解。\n", "hint": "数据范围\n\n$1\\le n,m\\le 40$。\n\n感谢@miaomiao 提供spj。\n", "locale": "zh-CN"}}}
{"pid": "P3165", "type": "P", "difficulty": 6, "samples": [["6\n3 4 5 1 6 2", "4 6 4 5 6 6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "重庆", "各省省选", "平衡树"], "title": "[CQOI2014] 排序机械臂", "background": null, "description": "为了把工厂中高低不等的物品按从低到高排好序，工程师发明了一种排序机械臂。它遵循一个简单的排序规则，第一次操作找到高度最低的物品的位置 $P_1$，并把左起第一个物品至 $P_1$ 间的物品 (即区间 $[1,P_1]$ 间的物品) 反序；第二次找到第二低的物品的位置 $P_2$，并把左起第二个至 $P_2$ 间的物品 (即区间 $[2,P_2]$ 间的物品) 反序……最终所有的物品都会被排好序。\n\n![样例说明](https://cdn.luogu.com.cn/upload/pic/15642.png)\n\n上图给出有六个物品的示例，第一次操作前，高度最低的物品在位置 $4$，于是把第一至第四的物品反序；第二次操作前，第二低的物品在位罝六，于是把第二至六的物品反序……\n\n你的任务便是编写一个程序，确定一个操作序列，即每次操作前第 $i$ 低的物品所在位置 $P_i$，以便机械臂工作。需要注意的是，如果有高度相同的物品，必须保证排序后它们的相对位置关系与初始时相同。", "inputFormat": "第一行包含正整数 $n$，表示需要排序的物品数量。\n\n第二行包含 $n$ 个空格分隔的整数 $P_i$，表示每个物品的高度。", "outputFormat": "输出一行包含 $n$ 个空格分隔的整数 $P_i$。", "hint": "$N \\le 100000$\n\n$P_i \\le 10^7$", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2014] Sorting Robotic Arm", "background": "", "description": "To sort items of varying heights in nondecreasing order, engineers invented a sorting robotic arm. It follows a simple rule: in the first operation, find the position $P_1$ of the lowest item and reverse the items from the first item from the left up to $P_1$ (i.e., reverse the subarray $[1, P_1]$); in the second operation, find the position $P_2$ of the second lowest item and reverse the items from the second item from the left up to $P_2$ (i.e., reverse the subarray $[2, P_2]$); and so on. Eventually, all items will be sorted.\n\n![样例说明](https://cdn.luogu.com.cn/upload/pic/15642.png)\n\nThe figure above shows an example with six items. Before the first operation, the lowest item is at position $4$, so the first through fourth items are reversed. Before the second operation, the second lowest item is at position $6$, so the second through sixth items are reversed.\n\nYour task is to write a program to determine the sequence of operations, namely, the position $P_i$ of the $i$-th lowest item before each operation, so the robotic arm can execute them. Note that if there are items with equal height, their relative order must remain the same after sorting.", "inputFormat": "The first line contains a positive integer $n$, the number of items to sort.\n\nThe second line contains $n$ space-separated integers $P_i$, the height of each item.", "outputFormat": "Output one line containing $n$ space-separated integers $P_i$.", "hint": "$N \\le 100000$\n\n$P_i \\le 10^7$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2014] 排序机械臂", "background": null, "description": "为了把工厂中高低不等的物品按从低到高排好序，工程师发明了一种排序机械臂。它遵循一个简单的排序规则，第一次操作找到高度最低的物品的位置 $P_1$，并把左起第一个物品至 $P_1$ 间的物品 (即区间 $[1,P_1]$ 间的物品) 反序；第二次找到第二低的物品的位置 $P_2$，并把左起第二个至 $P_2$ 间的物品 (即区间 $[2,P_2]$ 间的物品) 反序……最终所有的物品都会被排好序。\n\n![样例说明](https://cdn.luogu.com.cn/upload/pic/15642.png)\n\n上图给出有六个物品的示例，第一次操作前，高度最低的物品在位置 $4$，于是把第一至第四的物品反序；第二次操作前，第二低的物品在位罝六，于是把第二至六的物品反序……\n\n你的任务便是编写一个程序，确定一个操作序列，即每次操作前第 $i$ 低的物品所在位置 $P_i$，以便机械臂工作。需要注意的是，如果有高度相同的物品，必须保证排序后它们的相对位置关系与初始时相同。", "inputFormat": "第一行包含正整数 $n$，表示需要排序的物品数量。\n\n第二行包含 $n$ 个空格分隔的整数 $P_i$，表示每个物品的高度。", "outputFormat": "输出一行包含 $n$ 个空格分隔的整数 $P_i$。", "hint": "$N \\le 100000$\n\n$P_i \\le 10^7$", "locale": "zh-CN"}}}
{"pid": "P3166", "type": "P", "difficulty": 4, "samples": [["2 2", "76"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2014", "重庆", "各省省选", "最大公约数 gcd", "排列组合"], "title": "[CQOI2014] 数三角形", "background": "", "description": "给定一个 $N\\times M$ 的网格，请计算三点都在格点上的三角形共有多少个。注意三角形的三点不能共线。", "inputFormat": "输入一行，包含两个空格分隔的正整数 $M$ 和 $N$。", "outputFormat": "输出一个正整数，为所求三角形数量。\n", "hint": "#### 数据规模与约定\n\n对于全部的测试点，保证 $1\\le N,M\\le1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2014] Counting Triangles", "background": "", "description": "Given an $N \\times M$ grid, compute how many triangles have all three vertices at grid points. Note that the three points of a triangle must not be collinear.", "inputFormat": "The input consists of one line containing two space-separated positive integers $M$ and $N$.", "outputFormat": "Output a single positive integer, which is the number of such triangles.", "hint": "Constraints\n\nFor all test points, $1 \\le N, M \\le 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2014] 数三角形", "background": "", "description": "给定一个 $N\\times M$ 的网格，请计算三点都在格点上的三角形共有多少个。注意三角形的三点不能共线。", "inputFormat": "输入一行，包含两个空格分隔的正整数 $M$ 和 $N$。", "outputFormat": "输出一个正整数，为所求三角形数量。\n", "hint": "#### 数据规模与约定\n\n对于全部的测试点，保证 $1\\le N,M\\le1000$。", "locale": "zh-CN"}}}
{"pid": "P3167", "type": "P", "difficulty": 5, "samples": [["*aca?ctc\n6\nacaacatctc\nacatctc\naacacatctc\naggggcaacacctc\naggggcaacatctc\naggggcaacctct", "YES\r\nYES\r\nYES\r\nYES\r\nYES\r\nNO"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "2014", "重庆", "各省省选", "哈希 hashing", "AC 自动机"], "title": "[CQOI2014] 通配符匹配", "background": null, "description": "几乎所有操作系统的命令行界面（CLI）中都支持文件名的通配符匹配以方便用户。最常见的通配符有两个，一个是星号（```*```），可以匹配 0 个及以上的任意字符；另一个是问号（```?```），可以匹配恰好一个任意字符。现在需要你编写一个程序，对于给定的文件名列表和一个包含通配符的字符串，判断哪些文件可以被匹配。", "inputFormat": "第一行是一个由小写字母和上述通配符组成的字符串。第二行包含一个整数 $n$，表示文件个数。接下来 $n$ 行，每行为一个仅包含小写字母字符串，表示文件名列表。", "outputFormat": "输出 $n$ 行，每行为 ``YES`` 或 ``NO``，表示对应文件能否被通配符匹配。", "hint": "对于 $100 \\%$ 的数据\n\n- 字符串长度不超过 $100000$\n- $1 \\le n \\le 100$\n- 通配符个数不超过 $10$", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2014] Wildcard Matching", "background": "", "description": "Almost all operating systems' command-line interfaces (CLI) support wildcard matching for filenames to help users. The two most common wildcards are: an asterisk (```*```), which matches any sequence of characters of length 0 or more; and a question mark (```?```), which matches exactly one arbitrary character. You are to write a program that, given a list of filenames and a pattern string containing wildcards, determines which files can be matched.", "inputFormat": "The first line is a string consisting of lowercase letters and the above wildcards. The second line contains an integer $n$, indicating the number of files. The next $n$ lines each contain a string consisting only of lowercase letters, representing the list of filenames.", "outputFormat": "Output $n$ lines, each being ``YES`` or ``NO``, indicating whether the corresponding file can be matched by the pattern.", "hint": "For $100 \\%$ of the testdata:\n\n- String length does not exceed 100000.\n- $1 \\le n \\le 100$.\n- The number of wildcards does not exceed 10.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2014] 通配符匹配", "background": null, "description": "几乎所有操作系统的命令行界面（CLI）中都支持文件名的通配符匹配以方便用户。最常见的通配符有两个，一个是星号（```*```），可以匹配 0 个及以上的任意字符；另一个是问号（```?```），可以匹配恰好一个任意字符。现在需要你编写一个程序，对于给定的文件名列表和一个包含通配符的字符串，判断哪些文件可以被匹配。", "inputFormat": "第一行是一个由小写字母和上述通配符组成的字符串。第二行包含一个整数 $n$，表示文件个数。接下来 $n$ 行，每行为一个仅包含小写字母字符串，表示文件名列表。", "outputFormat": "输出 $n$ 行，每行为 ``YES`` 或 ``NO``，表示对应文件能否被通配符匹配。", "hint": "对于 $100 \\%$ 的数据\n\n- 字符串长度不超过 $100000$\n- $1 \\le n \\le 100$\n- 通配符个数不超过 $10$", "locale": "zh-CN"}}}
{"pid": "P3168", "type": "P", "difficulty": 5, "samples": [["4 3\n1 2 6\n2 3 3\n1 3 2\n3 3 4\n3 1 3 2\n1 1 3 4\n2 2 4 3", "2\n8\n11"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2015", "重庆", "线段树", "各省省选", "可持久化线段树", "可持久化"], "title": "[CQOI2015] 任务查询系统", "background": "", "description": "最近实验室正在为其管理的超级计算机编制一套任务管理系统，而你被安排完成其中的查询部分。  \n\n超级计算机中的任务用三元组 $(s_i, e_i, p_i)$ 描述，$(s_i, e_i, p_i)$ 表示任务从第 $s_i$ 秒开始，在第 $e_i$ 秒后结束（第 $s_i$ 秒和 $e_i$ 秒任务也在运行），其优先级为 $p_i$。同一时间可能有多个任务同时执行，它们的优先级可能相同，也可能不同。  \n\n调度系统会经常向查询系统询问，第 $x_i$ 秒正在运行的任务中，优先级最小的 $k_i$ 个任务（即将任务按照优先级从小到大排序后取前 $k_i$ 个）的优先级之和是多少。  \n\n特别的，如果 $k_i$ 大于第 $x_i$ 秒正在运行的任务总数，则直接回答第 $x_i$ 秒正在运行的任务优先级之和。上述所有参数均为整数，时间的范围在 $[1, n]$ 之间。\n", "inputFormat": "输入文件第一行包含两个空格分开的正整数 $m$ 和 $n$，分别表示任务总数和时间范围。  \n\n接下来 $m$ 行，每行包含三个空格分开的正整数 $s_i,e_i,p_i$（$s_i \\le e_i$），描述一个任务。  \n\n接下来 $n$ 行，每行包含四个空格分开的整数 $x_i,a_i,b_i,c_i$，描述一次查询。  \n\n**本题强制在线**。查询的参数 $k_i$ 需要由公式 $k_i = 1 +(a_i \\times \\text{pre}+b_i) \\bmod c_i$ 计算得到。其中 $\\text{pre}$ 表示上一次查询的结果，定义初始 $\\text{pre} = 1$ 。\n", "outputFormat": "输出共 $n$ 行，每行一个整数，表示查询结果。\n", "hint": "【样例解释】\n\n$k_1 = (1\\times 1 + 3)\\bmod 2 + 1 = 1$；\n\n$k_2 = (1\\times 2+3)\\bmod 4 + 1 = 2$；\n\n$k_3 = (2 \\times 8+4)\\bmod 3+1 = 3$。\n\n【数据范围】\n \n对于 $100\\%$ 的数据，$1\\le m,n,c_i \\le 10 ^ 5$，$0 \\le a _ i, b _ i \\le 10 ^ 5$，$1\\leq s_i\\leq e_i\\leq n$，$1\\le p_i \\le 10^7$，$x_i$ 为 $1$ 到 $n$ 的一个排列。\n\n\n注：2024-12-28 加入一个 hack 数据，[帖子链接](https://www.luogu.com.cn/discuss/1025247)。", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2015] Task Query System", "background": "", "description": "The laboratory is building a task management system for its supercomputer, and you are assigned to implement the query component.\n\nEach task in the supercomputer is described by a triple $(s_i, e_i, p_i)$, meaning it runs from second $s_i$ through second $e_i$ inclusive (the task is running at both second $s_i$ and second $e_i$), and its priority is $p_i$. Multiple tasks may run at the same time, and their priorities may be the same or different.\n\nThe scheduler frequently asks the query system: among the tasks running at second $x_i$, what is the sum of priorities of the smallest $k_i$ tasks (i.e., sort tasks by priority in ascending order and take the first $k_i$)?\n\nIn particular, if $k_i$ is larger than the number of tasks running at second $x_i$, return the sum of priorities of all tasks running at second $x_i$. All parameters are integers, and the time range is within $[1, n]$.", "inputFormat": "The first line contains two space-separated positive integers $m$ and $n$, the number of tasks and the time range, respectively.\n\nThe next $m$ lines each contain three space-separated positive integers $s_i, e_i, p_i$ ($s_i \\le e_i$), describing one task.\n\nThe next $n$ lines each contain four space-separated integers $x_i, a_i, b_i, c_i$, describing one query.\n\nThis problem is online. The parameter $k_i$ is computed by $k_i = 1 + (a_i \\times \\text{pre} + b_i) \\bmod c_i$, where $\\text{pre}$ denotes the previous query’s result, with initial $\\text{pre} = 1$.", "outputFormat": "Output $n$ lines, each containing one integer, the result of each query.", "hint": "[Sample explanation]\n\n$k_1 = (1\\times 1 + 3)\\bmod 2 + 1 = 1$.\n\n$k_2 = (1\\times 2+3)\\bmod 4 + 1 = 2$.\n\n$k_3 = (2 \\times 8+4)\\bmod 3+1 = 3$.\n\nConstraints\n\nFor $100\\%$ of the testdata, $1 \\le m, n, c_i \\le 10^5$, $0 \\le a_i, b_i \\le 10^5$, $1 \\le s_i \\le e_i \\le n$, $1 \\le p_i \\le 10^7$, and the $x_i$ form a permutation of $1$ to $n$.\n\nNote: On 2024-12-28 a hack testdata was added, [post link](https://www.luogu.com.cn/discuss/1025247).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2015] 任务查询系统", "background": "", "description": "最近实验室正在为其管理的超级计算机编制一套任务管理系统，而你被安排完成其中的查询部分。  \n\n超级计算机中的任务用三元组 $(s_i, e_i, p_i)$ 描述，$(s_i, e_i, p_i)$ 表示任务从第 $s_i$ 秒开始，在第 $e_i$ 秒后结束（第 $s_i$ 秒和 $e_i$ 秒任务也在运行），其优先级为 $p_i$。同一时间可能有多个任务同时执行，它们的优先级可能相同，也可能不同。  \n\n调度系统会经常向查询系统询问，第 $x_i$ 秒正在运行的任务中，优先级最小的 $k_i$ 个任务（即将任务按照优先级从小到大排序后取前 $k_i$ 个）的优先级之和是多少。  \n\n特别的，如果 $k_i$ 大于第 $x_i$ 秒正在运行的任务总数，则直接回答第 $x_i$ 秒正在运行的任务优先级之和。上述所有参数均为整数，时间的范围在 $[1, n]$ 之间。\n", "inputFormat": "输入文件第一行包含两个空格分开的正整数 $m$ 和 $n$，分别表示任务总数和时间范围。  \n\n接下来 $m$ 行，每行包含三个空格分开的正整数 $s_i,e_i,p_i$（$s_i \\le e_i$），描述一个任务。  \n\n接下来 $n$ 行，每行包含四个空格分开的整数 $x_i,a_i,b_i,c_i$，描述一次查询。  \n\n**本题强制在线**。查询的参数 $k_i$ 需要由公式 $k_i = 1 +(a_i \\times \\text{pre}+b_i) \\bmod c_i$ 计算得到。其中 $\\text{pre}$ 表示上一次查询的结果，定义初始 $\\text{pre} = 1$ 。\n", "outputFormat": "输出共 $n$ 行，每行一个整数，表示查询结果。\n", "hint": "【样例解释】\n\n$k_1 = (1\\times 1 + 3)\\bmod 2 + 1 = 1$；\n\n$k_2 = (1\\times 2+3)\\bmod 4 + 1 = 2$；\n\n$k_3 = (2 \\times 8+4)\\bmod 3+1 = 3$。\n\n【数据范围】\n \n对于 $100\\%$ 的数据，$1\\le m,n,c_i \\le 10 ^ 5$，$0 \\le a _ i, b _ i \\le 10 ^ 5$，$1\\leq s_i\\leq e_i\\leq n$，$1\\le p_i \\le 10^7$，$x_i$ 为 $1$ 到 $n$ 的一个排列。\n\n\n注：2024-12-28 加入一个 hack 数据，[帖子链接](https://www.luogu.com.cn/discuss/1025247)。", "locale": "zh-CN"}}}
{"pid": "P3169", "type": "P", "difficulty": 6, "samples": [["3\n2\n2", "10536"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "递推", "2015", "重庆", "各省省选", "矩阵加速"], "title": "[CQOI2015] 多项式", "background": "", "description": "在学习完二项式定理后，数学老师给出了一道题目：已知整数 $n,t$ 和 $a_k$（$0\\le k\\le n$），求 $b_k$（$0\\le k\\le n$）的表达式使得:\n\n$$\n\\sum_{k=0}^n a_kx^k=\\sum_{k=0}^nb_k(x-t)^k\n$$\n\n同学们很快算出了答案。见大家这么快就搞定了，老师便布置了一个更 BT 的作业：计算某个 $b_k$ 的具体数值！接着便在黑板上写下了 $n,t$ 的数值，由于 $a_k$ 实在太多，不能全写在黑板上，老师只给出了一个 $a_k$ 的递推式，让学生自行计算:\n\n$$\na_k=\n\\begin{cases}\n(1234\\cdot a_{k-1}+5678)\\bmod 3389 & k\\gt 0 \\\\\n1 & k=0 \\\\\n\\end{cases}\n$$\n\n正在学习信息竞赛的你觉得这个作业实在不适合手工完成，便敲起了代码……\n", "inputFormat": "输入文件共三行，第一行为一个正整数 $n$，第二行为一个非负整数 $t$，第三行为一个非负整数 $m$。\n", "outputFormat": "输出一行，为 $b_m$ 的值。", "hint": "数据范围：\n\n对于 $20\\%$ 的数据，$t=0$。\n\n对于另外 $30\\%$ 的数据，$n\\le 10^5$。\n\n对于 $100\\%$ 的数据，$0\\lt n\\le 10^{3000}$，$0\\le t\\le 10^4$，$0\\le n-m\\le 5$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2015] Polynomial", "background": "", "description": "After learning the binomial theorem, the math teacher gave a problem: given integers $n, t$ and $a_k$ ($0\\le k\\le n$), find the expressions for $b_k$ ($0\\le k\\le n$) such that:\n\n$$\n\\sum_{k=0}^n a_kx^k=\\sum_{k=0}^nb_k(x-t)^k\n$$\n\nThe students quickly worked out the answer. Seeing everyone finish so fast, the teacher assigned an even more brutal task: compute the specific value of some $b_k$. Then the teacher wrote the values of $n, t$ on the blackboard. Since there were too many $a_k$ to write out, the teacher only provided a recurrence for $a_k$ and asked the students to compute it themselves:\n\n$$\na_k=\n\\begin{cases}\n(1234\\cdot a_{k-1}+5678)\\bmod 3389 & k\\gt 0 \\\\\n1 & k=0 \\\\\n\\end{cases}\n$$\n\nAs someone learning competitive programming, you feel this homework is not suitable for manual calculation, so you start coding.", "inputFormat": "The input consists of three lines. The first line contains a positive integer $n$. The second line contains a non-negative integer $t$. The third line contains a non-negative integer $m$.", "outputFormat": "Output one line containing the value of $b_m$.", "hint": "Constraints:\n\n- For 20% of the testdata, $t=0$.\n- For another 30% of the testdata, $n\\le 10^5$.\n- For 100% of the testdata, $0\\lt n\\le 10^{3000}$, $0\\le t\\le 10^4$, $0\\le n-m\\le 5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2015] 多项式", "background": "", "description": "在学习完二项式定理后，数学老师给出了一道题目：已知整数 $n,t$ 和 $a_k$（$0\\le k\\le n$），求 $b_k$（$0\\le k\\le n$）的表达式使得:\n\n$$\n\\sum_{k=0}^n a_kx^k=\\sum_{k=0}^nb_k(x-t)^k\n$$\n\n同学们很快算出了答案。见大家这么快就搞定了，老师便布置了一个更 BT 的作业：计算某个 $b_k$ 的具体数值！接着便在黑板上写下了 $n,t$ 的数值，由于 $a_k$ 实在太多，不能全写在黑板上，老师只给出了一个 $a_k$ 的递推式，让学生自行计算:\n\n$$\na_k=\n\\begin{cases}\n(1234\\cdot a_{k-1}+5678)\\bmod 3389 & k\\gt 0 \\\\\n1 & k=0 \\\\\n\\end{cases}\n$$\n\n正在学习信息竞赛的你觉得这个作业实在不适合手工完成，便敲起了代码……\n", "inputFormat": "输入文件共三行，第一行为一个正整数 $n$，第二行为一个非负整数 $t$，第三行为一个非负整数 $m$。\n", "outputFormat": "输出一行，为 $b_m$ 的值。", "hint": "数据范围：\n\n对于 $20\\%$ 的数据，$t=0$。\n\n对于另外 $30\\%$ 的数据，$n\\le 10^5$。\n\n对于 $100\\%$ 的数据，$0\\lt n\\le 10^{3000}$，$0\\le t\\le 10^4$，$0\\le n-m\\le 5$。\n", "locale": "zh-CN"}}}
{"pid": "P3170", "type": "P", "difficulty": 7, "samples": [["4 4\n....\n#...\n....\n..#.", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "搜索", "2015", "重庆", "各省省选", "记忆化搜索", "哈希 hashing", "轮廓线 DP"], "title": "[CQOI2015] 标识设计", "background": "", "description": "一家名字缩写为 LLL 的公司正在设计 logo，他们的初步方案是在一张方格上放置 $3$ 个 L 形的图案以及一些额外的装饰性图形，例如：![](https://cdn.luogu.com.cn/upload/pic/15558.png)  （灰色区域表示装饰性图形）。\n\n$3$ 个 L 图案和装饰性图形均放置在方格之中，且必须占满方格。L 的横竖笔画长短均可，但长度必须大于 $0$（即不能退化为一条线段）。另外，为了使 L 图案醒目且容易辨别，设计师规定 $3$ 个 L 形图案之间不能有重叠或交叉的部分。当然，L 形图案也不能穿过装饰图形或与之重叠。\n\n现在设计师已经确定了所有装饰性图形的位置，希望你计算一下放置不同的 L 形图案总共可以设计出多少个 logo。\n", "inputFormat": "第一行包含两个空格分开的正整数 $n$ 和 $m$，分别表示方格的行数和列数。\n\n接下来 $n$ 行，每行 $m$ 个字符，第 $(i + 1)$ 行第 $j$ 个字符代表第 $i$ 行第 $j$ 列的图形，该字符只可能为 `.` 或 `#`。`#` 表示该方格为装饰性图形，`.` 表示可以放置 L 图案的空白区域。", "outputFormat": "输出一个整数，为可能的logo总数。\n", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $2\\le n,m\\leq 30$。", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2015] Logo Design", "background": "", "description": "A company abbreviated as LLL is designing a logo. Their initial plan is to place $3$ L-shaped patterns and some extra decorative shapes on a square grid, for example: ![](https://cdn.luogu.com.cn/upload/pic/15558.png) (the gray area denotes decorative shapes).\n\nThe $3$ L-shaped patterns and the decorative shapes are all placed on the grid, and together they must cover the entire grid. The horizontal and vertical strokes of each L may have any positive length, but each length must be greater than $0$ (i.e., an L cannot degenerate into a straight line segment). In addition, to keep the L patterns clear and recognizable, the $3$ L-shaped patterns must not overlap or cross each other. Of course, an L-shaped pattern also cannot pass through or overlap any decorative shape.\n\nNow that the designer has fixed the positions of all decorative shapes, please compute how many different logos can be designed by placing the L-shaped patterns.", "inputFormat": "The first line contains two space-separated positive integers $n$ and $m$, the numbers of rows and columns of the grid.\n\nThe next $n$ lines each contain $m$ characters. In the $(i + 1)$-th line, the $j$-th character denotes the cell at row $i$, column $j$. Each character is either `.` or `#`. `#` means the cell is a decorative shape, and `.` means it is an empty cell where an L-shaped pattern may be placed.", "outputFormat": "Output a single integer, the total number of possible logos.", "hint": "Constraints\n\nFor $100\\%$ of the testdata, $2\\le n,m\\leq 30$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2015] 标识设计", "background": "", "description": "一家名字缩写为 LLL 的公司正在设计 logo，他们的初步方案是在一张方格上放置 $3$ 个 L 形的图案以及一些额外的装饰性图形，例如：![](https://cdn.luogu.com.cn/upload/pic/15558.png)  （灰色区域表示装饰性图形）。\n\n$3$ 个 L 图案和装饰性图形均放置在方格之中，且必须占满方格。L 的横竖笔画长短均可，但长度必须大于 $0$（即不能退化为一条线段）。另外，为了使 L 图案醒目且容易辨别，设计师规定 $3$ 个 L 形图案之间不能有重叠或交叉的部分。当然，L 形图案也不能穿过装饰图形或与之重叠。\n\n现在设计师已经确定了所有装饰性图形的位置，希望你计算一下放置不同的 L 形图案总共可以设计出多少个 logo。\n", "inputFormat": "第一行包含两个空格分开的正整数 $n$ 和 $m$，分别表示方格的行数和列数。\n\n接下来 $n$ 行，每行 $m$ 个字符，第 $(i + 1)$ 行第 $j$ 个字符代表第 $i$ 行第 $j$ 列的图形，该字符只可能为 `.` 或 `#`。`#` 表示该方格为装饰性图形，`.` 表示可以放置 L 图案的空白区域。", "outputFormat": "输出一个整数，为可能的logo总数。\n", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $2\\le n,m\\leq 30$。", "locale": "zh-CN"}}}
{"pid": "P3171", "type": "P", "difficulty": 6, "samples": [["7 10\n1 2 2\n1 5 2\n2 4 1\n2 3 3\n3 7 1\n4 5 4\n4 3 1\n4 6 1\n5 6 2\n6 7 1\n1\n100\n20\n50\n20\n60\n1", "70"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "重庆", "各省省选", "网络流", "最短路"], "title": "[CQOI2015] 网络吞吐量", "background": "路由是指通过计算机网络把信息从源地址传输到目的地址的活动，也是计算机网络设计中的重点和难点。网络中实现路由转发的硬件设备称为路由器。为了使数据包最快的到达目的地，路由器需要选择最优的路径转发数据包。例如在常用的路由算法 OSPF (开放式最短路径优先) 中，路由器会使用经典的 Dijkstra 算法计算最短路径，然后尽量沿最短路径转发数据包。\n", "description": "现在，若已知一个计算机网络中各路由器间的连接情况，以及各个路由器的最大吞吐量（即每秒能转发的数据包数量），网络中的路由器使用 $1$ 到 $n$ 编号，假设所有数据包一定沿最短路径转发，试计算从路由器 $1$ 到路由器 $n$ 的网络的最大吞吐量。计算中忽略转发及传输的时间开销，不考虑链路的带宽限制，即认为数据包可以瞬间通过网络。路由器 $1$ 到路由器 $n$ 作为起点和终点，自身的吞吐量不用考虑，网络上也不存在将 $1$ 和 $n$ 直接相连的链路。\n", "inputFormat": "输入的第一行是用空格隔开的两个整数，分别代表路由器的数量 $n$ 和链路的数量 $m$。\n\n第 $2$ 到第 $(m + 1)$  行，每行三个整数 $u, v, w$，代表存在一条连结路由器 $u$ 和路由器 $v$  的距离为 $w$ 的双向链路。\n\n第 $(m + 2)$ 到第 $(n + m + 1)$  行，每行一个整数，第 $(i + m + 1)$ 行的整数代表路由器 $i$ 的吞吐量 $c_i$。\n", "outputFormat": "输出一行一个整数，代表网络的最大吞吐量。\n", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 500$，$1 \\leq m \\leq 10^5$，$1 \\leq w, c_i \\leq 10^9$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2015] Network Throughput", "background": "Routing is the activity of transferring information from a source address to a destination address through a computer network, and it is both a key and difficult part of network design. The hardware device that performs routing and forwarding in a network is called a router. To deliver packets to their destinations as quickly as possible, routers need to choose optimal paths to forward packets. For example, in the commonly used routing algorithm OSPF (Open Shortest Path First), routers use the classic Dijkstra algorithm to compute shortest paths and then forward packets along the shortest paths whenever possible.", "description": "Now, given the connectivity between routers in a computer network and the maximum throughput of each router (i.e., the number of packets it can forward per second), with routers numbered from $1$ to $n$, assume all packets are forwarded strictly along shortest paths. Compute the maximum throughput from router $1$ to router $n$. Ignore the time overhead of forwarding and transmission, and do not consider link bandwidth limits, i.e., assume packets can traverse the network instantaneously. Routers $1$ and $n$ serve as the source and destination, and their own throughputs are not considered. There is also no link that directly connects $1$ and $n$.", "inputFormat": "The first line contains two integers separated by a space, representing the number of routers $n$ and the number of links $m$.\n\nLines $2$ to $(m + 1)$ each contain three integers $u, v, w$, indicating there is an undirected link connecting routers $u$ and $v$ with distance $w$.\n\nLines $(m + 2)$ to $(n + m + 1)$ each contain one integer. The integer on line $(i + m + 1)$ represents the throughput $c_i$ of router $i$.", "outputFormat": "Output a single line containing one integer, representing the maximum throughput of the network.", "hint": "Constraints\n\nFor $100\\%$ of the testdata, it is guaranteed that $1 \\leq n \\leq 500$, $1 \\leq m \\leq 10^5$, and $1 \\leq w, c_i \\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2015] 网络吞吐量", "background": "路由是指通过计算机网络把信息从源地址传输到目的地址的活动，也是计算机网络设计中的重点和难点。网络中实现路由转发的硬件设备称为路由器。为了使数据包最快的到达目的地，路由器需要选择最优的路径转发数据包。例如在常用的路由算法 OSPF (开放式最短路径优先) 中，路由器会使用经典的 Dijkstra 算法计算最短路径，然后尽量沿最短路径转发数据包。\n", "description": "现在，若已知一个计算机网络中各路由器间的连接情况，以及各个路由器的最大吞吐量（即每秒能转发的数据包数量），网络中的路由器使用 $1$ 到 $n$ 编号，假设所有数据包一定沿最短路径转发，试计算从路由器 $1$ 到路由器 $n$ 的网络的最大吞吐量。计算中忽略转发及传输的时间开销，不考虑链路的带宽限制，即认为数据包可以瞬间通过网络。路由器 $1$ 到路由器 $n$ 作为起点和终点，自身的吞吐量不用考虑，网络上也不存在将 $1$ 和 $n$ 直接相连的链路。\n", "inputFormat": "输入的第一行是用空格隔开的两个整数，分别代表路由器的数量 $n$ 和链路的数量 $m$。\n\n第 $2$ 到第 $(m + 1)$  行，每行三个整数 $u, v, w$，代表存在一条连结路由器 $u$ 和路由器 $v$  的距离为 $w$ 的双向链路。\n\n第 $(m + 2)$ 到第 $(n + m + 1)$  行，每行一个整数，第 $(i + m + 1)$ 行的整数代表路由器 $i$ 的吞吐量 $c_i$。\n", "outputFormat": "输出一行一个整数，代表网络的最大吞吐量。\n", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 500$，$1 \\leq m \\leq 10^5$，$1 \\leq w, c_i \\leq 10^9$。\n", "locale": "zh-CN"}}}
{"pid": "P3172", "type": "P", "difficulty": 6, "samples": [["2 2 2 4", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["递推", "2015", "重庆", "各省省选", "最大公约数 gcd", "莫比乌斯反演"], "title": "[CQOI2015] 选数", "background": "", "description": "我们知道，从区间 $[L,H]$（$L$ 和 $H$ 为整数）中选取 $N$ 个整数，总共有 $(H-L+1)^N$ 种方案。小 z 很好奇这样选出的数的最大公约数的规律，他决定对每种方案选出的 $N$ 个整数都求一次最大公约数，以便进一步研究。然而他很快发现工作量太大了，于是向你寻求帮助。你的任务很简单，小 z 会告诉你一个整数 $K$，你需要回答他最大公约数刚好为 $K$ 的选取方案有多少个。\n\n由于方案数较大，你只需要输出其除以 $10^9+7$ 的余数即可。", "inputFormat": "输入一行，包含四个空格分开的正整数，依次为 $N,K,L,H$。\n", "outputFormat": "输出一个整数，为所求方案数除以 $10^9 + 7$ 的余数。\n", "hint": "#### 样例 1 解释\n\n所有可能的选择方案：$(2, 2), (2, 3), (2, 4), (3, 2), (3, 3), (3, 4), (4, 2), (4, 3), (4, 4)$。\n\n其中最大公约数等于 $2$ 的只有 $3$ 组：$(2, 2), (2, 4), (4, 2)$。\n#### 数据规模与约定\n对于 $100\\%$ 的数据，$1\\le N,K\\le 10^9$，$1\\le L\\le H\\le 10^9$，$H-L\\le 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2015] Choosing Numbers", "background": "", "description": "We know that selecting $N$ integers from the interval $[L, H]$ (where $L$ and $H$ are integers) yields $(H - L + 1)^N$ schemes. Little z is curious about the pattern of the greatest common divisor of the numbers selected in this way. He decides to compute the greatest common divisor of the $N$ integers for every scheme for further study. However, he soon finds the workload too large, so he asks for your help. Your task is simple: Little z will give you an integer $K$, and you need to answer how many selection schemes have their greatest common divisor exactly equal to $K$.\n\nSince the number of schemes can be large, you only need to output the remainder modulo $10^9+7$.", "inputFormat": "The input consists of one line containing four space-separated positive integers, in order: $N, K, L, H$.", "outputFormat": "Output a single integer, which is the remainder of the required count modulo $10^9+7$.", "hint": "Sample 1 Explanation.\n\nAll possible selection schemes: $(2, 2), (2, 3), (2, 4), (3, 2), (3, 3), (3, 4), (4, 2), (4, 3), (4, 4)$.\n\nAmong them, those with greatest common divisor equal to $2$ are only $3$ groups: $(2, 2), (2, 4), (4, 2)$.\n\nConstraints.\n\nFor $100\\%$ of the testdata, $1\\le N, K\\le 10^9$, $1\\le L\\le H\\le 10^9$, $H - L\\le 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2015] 选数", "background": "", "description": "我们知道，从区间 $[L,H]$（$L$ 和 $H$ 为整数）中选取 $N$ 个整数，总共有 $(H-L+1)^N$ 种方案。小 z 很好奇这样选出的数的最大公约数的规律，他决定对每种方案选出的 $N$ 个整数都求一次最大公约数，以便进一步研究。然而他很快发现工作量太大了，于是向你寻求帮助。你的任务很简单，小 z 会告诉你一个整数 $K$，你需要回答他最大公约数刚好为 $K$ 的选取方案有多少个。\n\n由于方案数较大，你只需要输出其除以 $10^9+7$ 的余数即可。", "inputFormat": "输入一行，包含四个空格分开的正整数，依次为 $N,K,L,H$。\n", "outputFormat": "输出一个整数，为所求方案数除以 $10^9 + 7$ 的余数。\n", "hint": "#### 样例 1 解释\n\n所有可能的选择方案：$(2, 2), (2, 3), (2, 4), (3, 2), (3, 3), (3, 4), (4, 2), (4, 3), (4, 4)$。\n\n其中最大公约数等于 $2$ 的只有 $3$ 组：$(2, 2), (2, 4), (4, 2)$。\n#### 数据规模与约定\n对于 $100\\%$ 的数据，$1\\le N,K\\le 10^9$，$1\\le L\\le H\\le 10^9$，$H-L\\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P3173", "type": "P", "difficulty": 4, "samples": [["6 4\n2\n1\n3\n1\n4\n4\n1\n2", "42"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "递推", "2009", "河南", "各省省选", "排序", "前缀和", "双指针 two-pointer"], "title": "[HAOI2009] 巧克力", "background": null, "description": "有一块 $n \\times m$ 的矩形巧克力，准备将它切成 $n \\times m$ 块。巧克力上共有 $n-1$ 条横线和 $m-1$ 条竖线，你每次可以沿着其中的一条横线或竖线将巧克力切开，无论切割的长短，沿着每条横线切一次的代价依次为 $y_1,y_2,\\cdots,y_{n-1}$，而沿竖线切割的代价依次为 $x_1,x_2,\\cdots,x_{m-1}$。\n\n例如，对于下图 $6 \\times 4$ 的巧克力，我们先沿着三条横线切割，需要 $3$ 刀，得到 $4$ 条巧克力，然后再将这 $4$ 条巧克力沿竖线切割，每条都需要 $5$ 刀，则最终所花费的代价为 $y_1+y_2+y_3+4 \\times (x_1+x_2+x_3+x_4+x_5)$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/s0j2oloj.png)\n\n\n当然，上述简单切法不见得是最优切法，那么怎样切割该块巧克力，花费的代价最少呢？", "inputFormat": "第一行为两个整数 $n$ 和 $m$；\n\n接下来 $n-1$ 行，每行一个整数，分别代表 $y_1,y_2,\\cdots,y_{n-1}$；\n\n接下来 $m-1$ 行，每行一个整数，分别代表 $x_1,x_2,\\cdots,x_{m-1}$。", "outputFormat": "输出一整数，为切割巧克力的最小代价。", "hint": "$30\\%$ 的数据，$n \\leq 100,m \\leq 100$；\n\n$100\\%$ 的数据，$n \\leq 10000,m \\leq 10000$；", "locale": "zh-CN", "translations": {"en": {"title": "[HAOI2009] Chocolate", "background": "", "description": "There is a rectangular chocolate bar of size $n \\times m$, to be cut into $n \\times m$ pieces. There are $n-1$ horizontal lines and $m-1$ vertical lines on the bar. Each time, you may cut along one of these horizontal or vertical lines. Regardless of the cut length, the costs of cutting along the horizontal lines in order are $y_1,y_2,\\cdots,y_{n-1}$, and along the vertical lines in order are $x_1,x_2,\\cdots,x_{m-1}$.\n\nFor the $6 \\times 4$ chocolate shown below, suppose we first cut along the three horizontal lines, requiring $3$ cuts, producing $4$ chocolate strips. Then we cut these $4$ strips along the vertical lines, each requiring $5$ cuts. The total cost is $y_1+y_2+y_3+4 \\times (x_1+x_2+x_3+x_4+x_5)$.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/s0j2oloj.png)\n\nOf course, the simple method above is not necessarily optimal. How should we cut this chocolate bar to minimize the total cost?", "inputFormat": "The first line contains two integers $n$ and $m$.\n\nThe next $n-1$ lines each contain one integer, representing $y_1,y_2,\\cdots,y_{n-1}$.\n\nThe next $m-1$ lines each contain one integer, representing $x_1,x_2,\\cdots,x_{m-1}$.", "outputFormat": "Output a single integer, the minimum cost to cut the chocolate.", "hint": "For $30\\%$ of the testdata, $n \\leq 100,m \\leq 100$.\n\nFor $100\\%$ of the testdata, $n \\leq 10000,m \\leq 10000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HAOI2009] 巧克力", "background": null, "description": "有一块 $n \\times m$ 的矩形巧克力，准备将它切成 $n \\times m$ 块。巧克力上共有 $n-1$ 条横线和 $m-1$ 条竖线，你每次可以沿着其中的一条横线或竖线将巧克力切开，无论切割的长短，沿着每条横线切一次的代价依次为 $y_1,y_2,\\cdots,y_{n-1}$，而沿竖线切割的代价依次为 $x_1,x_2,\\cdots,x_{m-1}$。\n\n例如，对于下图 $6 \\times 4$ 的巧克力，我们先沿着三条横线切割，需要 $3$ 刀，得到 $4$ 条巧克力，然后再将这 $4$ 条巧克力沿竖线切割，每条都需要 $5$ 刀，则最终所花费的代价为 $y_1+y_2+y_3+4 \\times (x_1+x_2+x_3+x_4+x_5)$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/s0j2oloj.png)\n\n\n当然，上述简单切法不见得是最优切法，那么怎样切割该块巧克力，花费的代价最少呢？", "inputFormat": "第一行为两个整数 $n$ 和 $m$；\n\n接下来 $n-1$ 行，每行一个整数，分别代表 $y_1,y_2,\\cdots,y_{n-1}$；\n\n接下来 $m-1$ 行，每行一个整数，分别代表 $x_1,x_2,\\cdots,x_{m-1}$。", "outputFormat": "输出一整数，为切割巧克力的最小代价。", "hint": "$30\\%$ 的数据，$n \\leq 100,m \\leq 100$；\n\n$100\\%$ 的数据，$n \\leq 10000,m \\leq 10000$；", "locale": "zh-CN"}}}
{"pid": "P3174", "type": "P", "difficulty": 4, "samples": [["13 12 \n1 2 \n1 5 \n1 6 \n3 2 \n4 2 \n5 7 \n5 8 \n7 9 \n7 10 \n7 11 \n8 12 \n8 13 ", "11"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2009", "河南", "各省省选", "树形 DP"], "title": "[HAOI2009] 毛毛虫", "background": "感谢由@ScanfN 提供的两组 hack 数据。", "description": "对于一棵树，我们可以将某条链和与该链相连的边抽出来，看上去就象成一个毛毛虫，点数越多，毛毛虫就越大。例如下图左边的树（图 $1$）抽出一部分就变成了右边的一个毛毛虫了（图 $2$）。\n\n![](https://cdn.luogu.com.cn/upload/pic/7967.png)\n", "inputFormat": "输入中第一行两个整数 $N, M$，分别表示树中结点个数和树的边数。\n\n接下来 $M$ 行，每行两个整数 $a, b$ 表示点 $a$ 和点 $b$ 有边连接（$a, b \\le N$）。你可以假定没有一对相同的 $(a, b)$ 会出现一次以上。", "outputFormat": "输出一行一个整数 , 表示最大的毛毛虫的大小。\n", "hint": "对于 $40\\%$ 的数据，$1\\leq N \\le 50000$。\n\n对于 $100\\%$ 的数据，$1\\leq N \\le 300000$。", "locale": "zh-CN", "translations": {"en": {"title": "[HAOI2009] Caterpillar", "background": "Thanks to @ScanfN for providing two sets of hack testdata.", "description": "For a tree, we can extract some path together with the edges incident to that path; it looks like a caterpillar. The more vertices it contains, the larger the caterpillar. For example, extracting part of the tree on the left (Figure $1$) yields the caterpillar on the right (Figure $2$).\n\n![](https://cdn.luogu.com.cn/upload/pic/7967.png)", "inputFormat": "The first line contains two integers $N, M$, denoting the number of vertices and the number of edges in the tree.\n\nThe next $M$ lines each contain two integers $a, b$, indicating that there is an edge between vertices $a$ and $b$ ($a, b \\le N$). You may assume that no identical pair $(a, b)$ appears more than once.", "outputFormat": "Output a single integer on one line, representing the size of the largest caterpillar.", "hint": "For $40\\%$ of the testdata, $1\\leq N \\le 50000$.\n\nFor $100\\%$ of the testdata, $1\\leq N \\le 300000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HAOI2009] 毛毛虫", "background": "感谢由@ScanfN 提供的两组 hack 数据。", "description": "对于一棵树，我们可以将某条链和与该链相连的边抽出来，看上去就象成一个毛毛虫，点数越多，毛毛虫就越大。例如下图左边的树（图 $1$）抽出一部分就变成了右边的一个毛毛虫了（图 $2$）。\n\n![](https://cdn.luogu.com.cn/upload/pic/7967.png)\n", "inputFormat": "输入中第一行两个整数 $N, M$，分别表示树中结点个数和树的边数。\n\n接下来 $M$ 行，每行两个整数 $a, b$ 表示点 $a$ 和点 $b$ 有边连接（$a, b \\le N$）。你可以假定没有一对相同的 $(a, b)$ 会出现一次以上。", "outputFormat": "输出一行一个整数 , 表示最大的毛毛虫的大小。\n", "hint": "对于 $40\\%$ 的数据，$1\\leq N \\le 50000$。\n\n对于 $100\\%$ 的数据，$1\\leq N \\le 300000$。", "locale": "zh-CN"}}}
{"pid": "P3175", "type": "P", "difficulty": 6, "samples": [["2\n0.25 0.25 0.25 0.25", "2.6666666667"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "河南", "各省省选", "Special Judge", "容斥原理", "快速沃尔什变换 FWT"], "title": "[HAOI2015] 按位或", "background": "", "description": "刚开始你有一个数字 $0$，每一秒钟你会随机选择一个 $[0,2^n-1]$ 的数字，与你手上的数字进行或（C++,C 的 `|`，pascal 的 `or`）操作。选择数字 $i$ 的概率是 $p_i$。保证 $0\\leq p_i \\leq 1$，$\\sum p_i=1$ 。问期望多少秒后，你手上的数字变成 $2^n-1$。\n", "inputFormat": "第一行输入 $n$ 表示 $n$ 个元素，第二行输入 $2^n$ 个数，第 $i$ 个数表示选到 $i-1$ 的概率。\n", "outputFormat": "仅输出一个数表示答案，绝对误差或相对误差不超过 $10^{-6}$ 即可算通过。如果无解则要输出 `INF`。", "hint": "对于 $100\\%$ 的数据，$n\\leq 20$。\n\n以下为 spj 源代码。\n\n```cpp\n//liuchenrui \n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<string>\n#include<cmath>\n#define AC {fclose(fstd),fclose(fuser);return 0;}\n#define WA {fclose(fstd),fclose(fuser);return 1;}\n#define PE {fclose(fstd),fclose(fuser);return 5;}\n#define eps 1e-6\nint main(int const argc, char*const argv[]){\n    FILE *fstd,*fuser;\n    fstd=fopen(argv[2],\"r\");\n    fuser=fopen(argv[3],\"r\");\n    //fstd=fopen(\"x1.in\",\"r\");\n    //fuser=fopen(\"x2.in\",\"r\");\n    char s[30],t[30];\n    if(fscanf(fuser,\"%s\",s+1)==-1)WA;\n    fscanf(fstd,\"%s\",t+1);\n    if(s[1]=='I' && t[1]=='I')AC;\n    if(s[1]=='I' || t[1]=='I')WA;\n    double p,q;\n    sscanf(s+1,\"%lf\",&p);\n    sscanf(t+1,\"%lf\",&q);\n    if(fabs(p-q)<eps)AC\n    else{\n        if(fabs(p-q)/q<eps)AC;\n        if(fabs(q-p)/q<eps)AC;\n        if(fabs(p-q)/p<eps)AC;\n        if(fabs(q-p)/p<eps)AC;\n    }\n    WA;\n}\n\n```", "locale": "zh-CN", "translations": {"en": {"title": "[HAOI2015] Bitwise OR", "background": "", "description": "Initially, you have the number $0$. Every second, you randomly choose a number from $[0,2^n-1]$ and apply bitwise OR with your current number (C++, C: `|`, Pascal: `or`). The probability of choosing number $i$ is $p_i$. It is guaranteed that $0\\leq p_i \\leq 1$, $\\sum p_i=1$. Find the expected number of seconds until your current number becomes $2^n-1$.", "inputFormat": "The first line contains $n$, the number of elements. The second line contains $2^n$ numbers; the $i$-th number is the probability of selecting $i-1$.", "outputFormat": "Output a single number representing the answer. An absolute or relative error not exceeding $10^{-6}$ is accepted. If there is no solution, output `INF`.", "hint": "For $100\\%$ of the testdata, $n\\leq 20$.\n\nThe following is the SPJ source code.\n\n```cpp\n//liuchenrui \n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<string>\n#include<cmath>\n#define AC {fclose(fstd),fclose(fuser);return 0;}\n#define WA {fclose(fstd),fclose(fuser);return 1;}\n#define PE {fclose(fstd),fclose(fuser);return 5;}\n#define eps 1e-6\nint main(int const argc, char*const argv[]){\n    FILE *fstd,*fuser;\n    fstd=fopen(argv[2],\"r\");\n    fuser=fopen(argv[3],\"r\");\n    //fstd=fopen(\"x1.in\",\"r\");\n    //fuser=fopen(\"x2.in\",\"r\");\n    char s[30],t[30];\n    if(fscanf(fuser,\"%s\",s+1)==-1)WA;\n    fscanf(fstd,\"%s\",t+1);\n    if(s[1]=='I' && t[1]=='I')AC;\n    if(s[1]=='I' || t[1]=='I')WA;\n    double p,q;\n    sscanf(s+1,\"%lf\",&p);\n    sscanf(t+1,\"%lf\",&q);\n    if(fabs(p-q)<eps)AC\n    else{\n        if(fabs(p-q)/q<eps)AC;\n        if(fabs(q-p)/q<eps)AC;\n        if(fabs(p-q)/p<eps)AC;\n        if(fabs(q-p)/p<eps)AC;\n    }\n    WA;\n}\n\n```\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HAOI2015] 按位或", "background": "", "description": "刚开始你有一个数字 $0$，每一秒钟你会随机选择一个 $[0,2^n-1]$ 的数字，与你手上的数字进行或（C++,C 的 `|`，pascal 的 `or`）操作。选择数字 $i$ 的概率是 $p_i$。保证 $0\\leq p_i \\leq 1$，$\\sum p_i=1$ 。问期望多少秒后，你手上的数字变成 $2^n-1$。\n", "inputFormat": "第一行输入 $n$ 表示 $n$ 个元素，第二行输入 $2^n$ 个数，第 $i$ 个数表示选到 $i-1$ 的概率。\n", "outputFormat": "仅输出一个数表示答案，绝对误差或相对误差不超过 $10^{-6}$ 即可算通过。如果无解则要输出 `INF`。", "hint": "对于 $100\\%$ 的数据，$n\\leq 20$。\n\n以下为 spj 源代码。\n\n```cpp\n//liuchenrui \n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<string>\n#include<cmath>\n#define AC {fclose(fstd),fclose(fuser);return 0;}\n#define WA {fclose(fstd),fclose(fuser);return 1;}\n#define PE {fclose(fstd),fclose(fuser);return 5;}\n#define eps 1e-6\nint main(int const argc, char*const argv[]){\n    FILE *fstd,*fuser;\n    fstd=fopen(argv[2],\"r\");\n    fuser=fopen(argv[3],\"r\");\n    //fstd=fopen(\"x1.in\",\"r\");\n    //fuser=fopen(\"x2.in\",\"r\");\n    char s[30],t[30];\n    if(fscanf(fuser,\"%s\",s+1)==-1)WA;\n    fscanf(fstd,\"%s\",t+1);\n    if(s[1]=='I' && t[1]=='I')AC;\n    if(s[1]=='I' || t[1]=='I')WA;\n    double p,q;\n    sscanf(s+1,\"%lf\",&p);\n    sscanf(t+1,\"%lf\",&q);\n    if(fabs(p-q)<eps)AC\n    else{\n        if(fabs(p-q)/q<eps)AC;\n        if(fabs(q-p)/q<eps)AC;\n        if(fabs(p-q)/p<eps)AC;\n        if(fabs(q-p)/p<eps)AC;\n    }\n    WA;\n}\n\n```", "locale": "zh-CN"}}}
{"pid": "P3176", "type": "P", "difficulty": 6, "samples": [["123\n3", "394608467"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2015", "河南", "各省省选", "矩阵乘法"], "title": "[HAOI2015] 数字串拆分", "background": "", "description": "你有一个长度为 $n$ 的数字串 $s_0$。\n\n定义 $f(s)$ 为将 $s$ 拆分成若干个 $1 \\sim m$ 的数的和的方案数，比如 $m=2$ 时，$f(4)=5$，分别为 $4=1+1+1+1=1+1+2=1+2+1=2+1+1=2+2$。\n\n定义 $g(s)$ 为将 $s$ 这个数字串分割成若干个数字（允许前导 $0$），设他们的和为 $x$，则 $g(s)$ 为所有情况下 $f(x)$ 之和。比如 $g(123)=f(1+2+3)+f(1+23)+f(12+3)+f(123)$。\n\n给定 $s_0$ 和 $m$，求 $g(s)$。\n\n答案对 $998,244,353$ 取模。", "inputFormat": "第一行有一个字符串。代表 $s_0$。\n\n第二行有一个整数，代表 $m$。", "outputFormat": "仅输出一个数表示答案。", "hint": "#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，保证 $1\\le|s_0|\\le 500$， $1\\le m\\le 5$，$s_0$ 中只有数字字符。", "locale": "zh-CN", "translations": {"en": {"title": "[HAOI2015] Digit String Partition", "background": "", "description": "You have a digit string $s_0$ of length $n$.\n\nDefine $f(s)$ as the number of ways to split $s$ into a sum of numbers in the range $1 \\sim m$. For example, when $m=2$, $f(4)=5$, namely $4=1+1+1+1=1+1+2=1+2+1=2+1+1=2+2$.\n\nDefine $g(s)$ as follows: split the digit string $s$ into several numbers (leading $0$ are allowed), let their sum be $x$, then $g(s)$ is the sum of $f(x)$ over all such cases. For example, $g(123)=f(1+2+3)+f(1+23)+f(12+3)+f(123)$.\n\nGiven $s_0$ and $m$, compute $g(s_0)$.\n\nTake the answer modulo $998,244,353$.", "inputFormat": "The first line contains a string, which represents $s_0$.\n\nThe second line contains an integer, which represents $m$.", "outputFormat": "Output a single integer representing the answer.", "hint": "#### Constraints and Conventions\n\n- For $100\\%$ of the testdata, it is guaranteed that $1 \\le |s_0| \\le 500$, $1 \\le m \\le 5$, and $s_0$ contains only digit characters.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HAOI2015] 数字串拆分", "background": "", "description": "你有一个长度为 $n$ 的数字串 $s_0$。\n\n定义 $f(s)$ 为将 $s$ 拆分成若干个 $1 \\sim m$ 的数的和的方案数，比如 $m=2$ 时，$f(4)=5$，分别为 $4=1+1+1+1=1+1+2=1+2+1=2+1+1=2+2$。\n\n定义 $g(s)$ 为将 $s$ 这个数字串分割成若干个数字（允许前导 $0$），设他们的和为 $x$，则 $g(s)$ 为所有情况下 $f(x)$ 之和。比如 $g(123)=f(1+2+3)+f(1+23)+f(12+3)+f(123)$。\n\n给定 $s_0$ 和 $m$，求 $g(s)$。\n\n答案对 $998,244,353$ 取模。", "inputFormat": "第一行有一个字符串。代表 $s_0$。\n\n第二行有一个整数，代表 $m$。", "outputFormat": "仅输出一个数表示答案。", "hint": "#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，保证 $1\\le|s_0|\\le 500$， $1\\le m\\le 5$，$s_0$ 中只有数字字符。", "locale": "zh-CN"}}}
{"pid": "P3177", "type": "P", "difficulty": 5, "samples": [["3 1\n1 2 1\n1 3 2", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "2015", "河南", "各省省选", "树形 DP"], "title": "[HAOI2015] 树上染色", "background": "", "description": "有一棵点数为 $n$ 的树，树边有边权。给你一个在 $0 \\sim n$ 之内的正整数 $k$ ，你要在这棵树中选择 $k$ 个点，将其染成黑色，并将其他的 $n-k$ 个点染成白色。将所有点染色后，你会获得黑点两两之间的距离加上白点两两之间的距离的和的收益。问收益最大值是多少。", "inputFormat": "第一行包含两个整数 $n,k$。\n\n第二到 $n$ 行每行三个正整数 $u, v, w$，表示该树中存在一条长度为 $w$ 的边 $(u, v)$。输入保证所有点之间是联通的。", "outputFormat": "输出一个正整数，表示收益的最大值。\n", "hint": "对于 $100\\%$ 的数据，$0 \\leq k \\leq n \\leq 2000$，$1 \\leq w \\leq 10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "[HAOI2015] Tree Coloring", "background": "", "description": "There is a tree with $n$ nodes, and each edge has a weight. You are given a positive integer $k$ in $0 \\sim n$. You need to choose $k$ nodes and color them black, and color the remaining $n - k$ nodes white. After coloring all nodes, you gain a profit equal to the sum of pairwise distances among black nodes plus the sum of pairwise distances among white nodes. What is the maximum possible profit?", "inputFormat": "The first line contains two integers $n, k$.\n\nLines $2$ to $n$ each contain three positive integers $u, v, w$, indicating that there is an edge $(u, v)$ of length $w$ in the tree. The input guarantees that all nodes are connected.", "outputFormat": "Output a single positive integer, the maximum profit.", "hint": "For $100\\%$ of the testdata, $0 \\leq n, k \\leq 2000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HAOI2015] 树上染色", "background": "", "description": "有一棵点数为 $n$ 的树，树边有边权。给你一个在 $0 \\sim n$ 之内的正整数 $k$ ，你要在这棵树中选择 $k$ 个点，将其染成黑色，并将其他的 $n-k$ 个点染成白色。将所有点染色后，你会获得黑点两两之间的距离加上白点两两之间的距离的和的收益。问收益最大值是多少。", "inputFormat": "第一行包含两个整数 $n,k$。\n\n第二到 $n$ 行每行三个正整数 $u, v, w$，表示该树中存在一条长度为 $w$ 的边 $(u, v)$。输入保证所有点之间是联通的。", "outputFormat": "输出一个正整数，表示收益的最大值。\n", "hint": "对于 $100\\%$ 的数据，$0 \\leq k \\leq n \\leq 2000$，$1 \\leq w \\leq 10^4$。", "locale": "zh-CN"}}}
{"pid": "P3178", "type": "P", "difficulty": 5, "samples": [["5 5\n1 2 3 4 5\n1 2\n1 4\n2 3\n2 5\n3 3\n1 2 1\n3 5\n2 1 2\n3 3", "6\n9\n13"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "河南", "线段树", "各省省选", "深度优先搜索 DFS", "树链剖分"], "title": "[HAOI2015] 树上操作", "background": "", "description": "有一棵点数为 $N$ 的树，以点 $1$ 为根，且树有点权。然后有 $M$ 个操作，分为三种：\n- 操作 $1$：把某个节点 $x$ 的点权增加 $a$。\n- 操作 $2$：把某个节点 $x$ 为根的子树中所有点的点权都增加 $a$。\n- 操作 $3$：询问某个节点 $x$ 到根的路径中所有点的点权和。\n", "inputFormat": "第一行包含两个整数 $N,M$。表示点数和操作数。  \n接下来一行 $N$ 个整数，表示树中节点的初始权值。  \n接下来 $N-1$ 行每行两个正整数 $\\mathit{from},\\mathit{to}$， 表示该树中存在一条边 $(\\mathit{from},\\mathit{to})$。  \n再接下来 $M$ 行，每行分别表示一次操作。其中第一个数表示该操作的种类，之后接这个操作的参数。\n", "outputFormat": "对于每个询问操作，输出该询问的答案。答案之间用换行隔开。\n", "hint": "对于 $100\\%$ 的数据，$1\\le N,M\\le10^5$，且所有输入数据的绝对值都不会超过 $10^6$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[HAOI2015] Operations on a Tree", "background": "", "description": "There is a tree with $N$ nodes, rooted at node $1$, and each node has a weight. There are $M$ operations of three types:\n- Operation $1$: increase the weight of node $x$ by $a$.\n- Operation $2$: increase the weight of every node in the subtree rooted at node $x$ by $a$.\n- Operation $3$: query the sum of weights of all nodes on the path from node $x$ to the root.", "inputFormat": "The first line contains two integers $N, M$, representing the number of nodes and the number of operations.  \nThe next line contains $N$ integers, representing the initial weights of the nodes.  \nEach of the next $N-1$ lines contains two positive integers $\\mathit{from}, \\mathit{to}$, indicating that there is an edge $(\\mathit{from}, \\mathit{to})$ in the tree.  \nThen there are $M$ lines, each describing one operation. The first number indicates the type of the operation, followed by the parameters of that operation.", "outputFormat": "For each query operation, output the answer. Print each answer on a new line.", "hint": "For $100\\%$ of the testdata, $1 \\le N, M \\le 10^5$, and the absolute values of all input numbers do not exceed $10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HAOI2015] 树上操作", "background": "", "description": "有一棵点数为 $N$ 的树，以点 $1$ 为根，且树有点权。然后有 $M$ 个操作，分为三种：\n- 操作 $1$：把某个节点 $x$ 的点权增加 $a$。\n- 操作 $2$：把某个节点 $x$ 为根的子树中所有点的点权都增加 $a$。\n- 操作 $3$：询问某个节点 $x$ 到根的路径中所有点的点权和。\n", "inputFormat": "第一行包含两个整数 $N,M$。表示点数和操作数。  \n接下来一行 $N$ 个整数，表示树中节点的初始权值。  \n接下来 $N-1$ 行每行两个正整数 $\\mathit{from},\\mathit{to}$， 表示该树中存在一条边 $(\\mathit{from},\\mathit{to})$。  \n再接下来 $M$ 行，每行分别表示一次操作。其中第一个数表示该操作的种类，之后接这个操作的参数。\n", "outputFormat": "对于每个询问操作，输出该询问的答案。答案之间用换行隔开。\n", "hint": "对于 $100\\%$ 的数据，$1\\le N,M\\le10^5$，且所有输入数据的绝对值都不会超过 $10^6$。\n", "locale": "zh-CN"}}}
{"pid": "P3179", "type": "P", "difficulty": 7, "samples": [["3\n2\n2\n1 2\n2\n2 3", "Yes\nNo"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "博弈论", "2015", "河南", "各省省选", "SG 函数"], "title": "[HAOI2015] 数组游戏", "background": null, "description": "有一个长度为 $n$ 的数组，甲乙两人在上面进行这样一个游戏：首先，数组上有一些格子是白的，有一些是黑的。然后两人轮流进行操作。\n\n每次操作选择一个白色的格子，假设它的下标为 $x$。接着，选择一个大小在 $1\\ldots \\lfloor\\dfrac{n}{x}\\rfloor$ 之间的整数 $k$，然后将下标为 $x,2\\times x,\\ldots ,k\\times x$ 的格子都进行颜色翻转。不能操作的人输。\n\n现在甲（先手）有一些询问。每次他会给你一个数组的初始状态，你要求出对于这种初始状态他是否有必胜策略。", "inputFormat": "第一行包含一个整数 $n$，表示数组的长度。\n\n第二行包含一个整数 $k$，表示询问的个数。\n\n接下来 $2\\times k$ 行，每两行表示一次询问。\n\n在这两行中，第一行一个正整数 $w$，表示数组中有多少个格子是白色的，第二行则有 $w$ 个 $1$ 到 $n$ 之间的正整数，表示白色格子的对应下标。", "outputFormat": "对于每个询问，输出一行一个字符串，若先手必胜输出 `Yes`，否则输出 `No`。", "hint": "#### 样例输入输出 1 解释\n\n在第一个询问中，甲选择点 $1$，然后将格子 $1\\times 1$ 和 $2\\times 1$ 翻过来即可。\n\n第二个询问中，无论甲选择哪个点，都只能翻掉一个格子。乙只需翻掉另一个格子就行了。\n\n#### 数据规模与约定\n\n对于 $30 \\%$ 的数据，$n \\leq 20$；    \n对于 $50 \\%$ 的数据，$n \\leq 10^6$；    \n对于 $70 \\%$ 的数据，$n \\leq 10^7$；    \n对于 $100 \\%$ 的数据，$n \\leq 10^9$，$k,w \\leq 100$，不会有格子在同一次询问中多次出现。", "locale": "zh-CN", "translations": {"en": {"title": "[HAOI2015] Array Game", "background": "", "description": "There is an array of length $n$. Two players, A and B, play the following game on it: initially, some cells in the array are white and some are black. The players take turns.\n\nOn each turn, the current player chooses a white cell with index $x$. Then they choose an integer $k$ between $1 \\ldots \\lfloor \\dfrac{n}{x} \\rfloor$, and flip the colors of all cells with indices $x, 2\\times x, \\ldots, k\\times x$. The player who cannot make a move loses.\n\nNow A (the first player) has several queries. For each query, you are given an initial state of the array. You need to determine whether A has a winning strategy for that initial state.", "inputFormat": "The first line contains an integer $n$, the length of the array.\n\nThe second line contains an integer $k$, the number of queries.\n\nThe next $2\\times k$ lines describe the queries, two lines per query.\n\nIn these two lines, the first line contains a positive integer $w$, the number of white cells in the array. The second line contains $w$ integers between $1$ and $n$, inclusive, which are the indices of the white cells.", "outputFormat": "For each query, output one line with a string: output `Yes` if the first player has a winning strategy, otherwise output `No`.", "hint": "#### Explanation for Sample Input/Output 1\n\nIn the first query, A chooses index $1$ and flips cells $1\\times 1$ and $2\\times 1$.\n\nIn the second query, no matter which index A chooses, they can flip only one cell. B can then flip the other cell.\n\n#### Constraints\n\nFor $30\\%$ of the testdata, $n \\leq 20$.\n\nFor $50\\%$ of the testdata, $n \\leq 10^6$.\n\nFor $70\\%$ of the testdata, $n \\leq 10^7$.\n\nFor $100\\%$ of the testdata, $n \\leq 10^9$, $k, w \\leq 100$, and no cell appears more than once within a single query.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HAOI2015] 数组游戏", "background": null, "description": "有一个长度为 $n$ 的数组，甲乙两人在上面进行这样一个游戏：首先，数组上有一些格子是白的，有一些是黑的。然后两人轮流进行操作。\n\n每次操作选择一个白色的格子，假设它的下标为 $x$。接着，选择一个大小在 $1\\ldots \\lfloor\\dfrac{n}{x}\\rfloor$ 之间的整数 $k$，然后将下标为 $x,2\\times x,\\ldots ,k\\times x$ 的格子都进行颜色翻转。不能操作的人输。\n\n现在甲（先手）有一些询问。每次他会给你一个数组的初始状态，你要求出对于这种初始状态他是否有必胜策略。", "inputFormat": "第一行包含一个整数 $n$，表示数组的长度。\n\n第二行包含一个整数 $k$，表示询问的个数。\n\n接下来 $2\\times k$ 行，每两行表示一次询问。\n\n在这两行中，第一行一个正整数 $w$，表示数组中有多少个格子是白色的，第二行则有 $w$ 个 $1$ 到 $n$ 之间的正整数，表示白色格子的对应下标。", "outputFormat": "对于每个询问，输出一行一个字符串，若先手必胜输出 `Yes`，否则输出 `No`。", "hint": "#### 样例输入输出 1 解释\n\n在第一个询问中，甲选择点 $1$，然后将格子 $1\\times 1$ 和 $2\\times 1$ 翻过来即可。\n\n第二个询问中，无论甲选择哪个点，都只能翻掉一个格子。乙只需翻掉另一个格子就行了。\n\n#### 数据规模与约定\n\n对于 $30 \\%$ 的数据，$n \\leq 20$；    \n对于 $50 \\%$ 的数据，$n \\leq 10^6$；    \n对于 $70 \\%$ 的数据，$n \\leq 10^7$；    \n对于 $100 \\%$ 的数据，$n \\leq 10^9$，$k,w \\leq 100$，不会有格子在同一次询问中多次出现。", "locale": "zh-CN"}}}
{"pid": "P3180", "type": "P", "difficulty": 6, "samples": [["10 12\n1 10 4 5 2 10 1 8 4 8\n1 2\n1 3\n1 4\n2 5\n4 6\n4 7\n7 8\n2 9\n8 10\n1 6\n8 10\n4 7\n10\n0 3 9\n1 7 6\n0 5 2\n1 10 9\n0 5 7\n1 7 4\n0 7 3\n1 2 7\n0 3 4\n0 3 8", "0\r\n1\r\n0\r\n1\r\n0\r\n1\r\n0\r\n2\r\n0\r\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2016", "河南", "各省省选", "仙人掌"], "title": "[HAOI2016] 地图", "background": "", "description": "一天 rin 来到了一个遥远的都市。这个都市有 $n$ 个建筑，编号从 $1$ 到 $n$，其中市中心编号为 $1$，这个都市有 $m$ 条双向通行的街道，每条街道连接着两个建筑，其中某些街道首尾相连连接成了一个环。\n\nrin 通过长时间的走访，已经清楚了这个都市的两个特点：\n1. 从市中心出发可以到达所有的建筑物。\n2. 任意一条街道最多存在与一个简单环中。令 rin 心花怒放的是，每个建筑物都会有拉面售卖。拉面有很多不同的种类，但对于 rin 而言只有油腻程度的不同，因此我们把油腻程度相同的拉面看做同一种拉面。\n\n由于不同建筑物的拉面的油腻程度可能不同，我们用一个正整数来表示拉面的油腻程度。\n\n要知道，拉面可是 rin 的最爱，但是现在到了下班高峰期，都市的交通变得非常的堵塞。 rin 只能通过没有被堵死的街道通行，去品尝所在建筑物的拉面。\n\n现在 rin 想知道，如果她正在编号为 $x$ 的建筑物，那么在从市中心到 $x$ 的所有简单路径经过的街道都被堵死的情况下，rin 可以品尝到的拉面中（注意没有出现的拉面是不能算在里面的）：\n\n1. 油腻程度 $\\leq y$ 且品尝次数为奇数次的拉面有多少种？\n2. 油腻程度 $\\leq y$ 且品尝次数为偶数次的拉面有多少种？", "inputFormat": "第一行两个正整数 $n, m$，含义如题所示。\n\n第二行一共 $N$ 个正整数，第 $i$ 个数 $A_i$ 表示第 $i$ 个建筑物出售的拉面的油腻程度。\n\n接下来 $M$ 行，每行两个正整数 $x, y$，表示在建筑物 $x, y$ 之间有一条双向通行的街道。数据保证 $1 \\leq x < y \\leq N$。\n\n接下来一行一个正整数 $Q$，表示询问个数。\n\n接下来 $Q$ 行每行三个非负整数 $ty, x, y$，$ty=0$ 时表示询问偶数，$ty=1$ 表示询问奇数。\n\n$N \\leq 100000, M \\leq 150000, Q \\leq 100000, A_i \\leq 10^6$。\n\n提示：请注意数据范围中的 $\\leq$，特殊条件中提到的??均为询问中的 $y$，对于所有的数据，有 $y \\leq 10^6$。\n", "outputFormat": "一共 $Q$ 行，对于每个询问输出一个答案。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[HAOI2016] Map", "background": "", "description": "One day, rin came to a distant metropolis. The city has $n$ buildings, numbered $1$ to $n$, with the city center being building $1$. There are $m$ bidirectional streets, each connecting two buildings, and some streets connect end to end to form a cycle.\n\nAfter long observation, rin has learned two facts about this city:\n1. From the city center, all buildings are reachable.\n2. Any street belongs to at most one simple cycle.\n\nEvery building sells ramen. There are many kinds of ramen, but for rin only the greasiness level matters, so we treat ramen with the same greasiness level as the same type. We use a positive integer to denote the greasiness level.\n\nIt is rush hour, and traffic is very jammed. rin can only travel along streets that are not blocked.\n\nNow rin wants to know: if she is at building $x$, and all streets lying on every simple path from the city center to $x$ are blocked, then among the ramen she can taste (note that types that do not appear at all must not be counted):\n1. How many types have greasiness $\\leq y$ and appear an odd number of times?\n2. How many types have greasiness $\\leq y$ and appear an even number of times? Here “even” means a positive even number of occurrences; types with zero occurrences are not counted.\n\nConstraints:\n- $n \\leq 100000$, $m \\leq 150000$, $Q \\leq 100000$, $A_i \\leq 10^6$.", "inputFormat": "- The first line contains two positive integers $n, m$.\n- The second line contains $n$ positive integers; the $i$-th number $A_i$ is the greasiness level of the ramen sold at building $i$.\n- The next $m$ lines each contain two positive integers $x, y$, meaning there is a bidirectional street between buildings $x$ and $y$. It is guaranteed that $1 \\leq x < y \\leq n$.\n- The next line contains a single positive integer $Q$, the number of queries.\n- The next $Q$ lines each contain three non-negative integers $ty, x, y$. When $ty = 0$, it asks for the count of types with an even number of occurrences; when $ty = 1$, it asks for the count of types with an odd number of occurrences.", "outputFormat": "Output $Q$ lines. For each query, output a single integer: the answer to that query.", "hint": "Please pay attention to the $\\leq$ in Constraints. The $y$ mentioned above is the $y$ in the queries. For all testdata, $y \\leq 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HAOI2016] 地图", "background": "", "description": "一天 rin 来到了一个遥远的都市。这个都市有 $n$ 个建筑，编号从 $1$ 到 $n$，其中市中心编号为 $1$，这个都市有 $m$ 条双向通行的街道，每条街道连接着两个建筑，其中某些街道首尾相连连接成了一个环。\n\nrin 通过长时间的走访，已经清楚了这个都市的两个特点：\n1. 从市中心出发可以到达所有的建筑物。\n2. 任意一条街道最多存在与一个简单环中。令 rin 心花怒放的是，每个建筑物都会有拉面售卖。拉面有很多不同的种类，但对于 rin 而言只有油腻程度的不同，因此我们把油腻程度相同的拉面看做同一种拉面。\n\n由于不同建筑物的拉面的油腻程度可能不同，我们用一个正整数来表示拉面的油腻程度。\n\n要知道，拉面可是 rin 的最爱，但是现在到了下班高峰期，都市的交通变得非常的堵塞。 rin 只能通过没有被堵死的街道通行，去品尝所在建筑物的拉面。\n\n现在 rin 想知道，如果她正在编号为 $x$ 的建筑物，那么在从市中心到 $x$ 的所有简单路径经过的街道都被堵死的情况下，rin 可以品尝到的拉面中（注意没有出现的拉面是不能算在里面的）：\n\n1. 油腻程度 $\\leq y$ 且品尝次数为奇数次的拉面有多少种？\n2. 油腻程度 $\\leq y$ 且品尝次数为偶数次的拉面有多少种？", "inputFormat": "第一行两个正整数 $n, m$，含义如题所示。\n\n第二行一共 $N$ 个正整数，第 $i$ 个数 $A_i$ 表示第 $i$ 个建筑物出售的拉面的油腻程度。\n\n接下来 $M$ 行，每行两个正整数 $x, y$，表示在建筑物 $x, y$ 之间有一条双向通行的街道。数据保证 $1 \\leq x < y \\leq N$。\n\n接下来一行一个正整数 $Q$，表示询问个数。\n\n接下来 $Q$ 行每行三个非负整数 $ty, x, y$，$ty=0$ 时表示询问偶数，$ty=1$ 表示询问奇数。\n\n$N \\leq 100000, M \\leq 150000, Q \\leq 100000, A_i \\leq 10^6$。\n\n提示：请注意数据范围中的 $\\leq$，特殊条件中提到的??均为询问中的 $y$，对于所有的数据，有 $y \\leq 10^6$。\n", "outputFormat": "一共 $Q$ 行，对于每个询问输出一个答案。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3181", "type": "P", "difficulty": 6, "samples": [["aabb\nbbaa", "10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["字符串", "2016", "河南", "各省省选", "后缀数组 SA"], "title": "[HAOI2016] 找相同字符", "background": "", "description": "给定两个字符串，求出在两个字符串中各取出一个子串使得这两个子串相同的方案数。两个方案不同当且仅当这两个子串中有一个位置不同。\n", "inputFormat": "两行，两个字符串 $s_1,s_2$，长度分别为 $n_1,n_2$。\n", "outputFormat": "输出一个整数表示答案。\n", "hint": "$1\\le n_1,n_2\\le 2\\times 10^5$，字符串中只有小写字母。", "locale": "zh-CN", "translations": {"en": {"title": "[HAOI2016] Find Identical Characters", "background": "", "description": "Given two strings, count the number of ways to take one substring from each string such that the two substrings are equal. Two ways are different if and only if at least one of the substrings has a different position.", "inputFormat": "Two lines: two strings $s_1, s_2$, of lengths $n_1, n_2$, respectively.", "outputFormat": "Output a single integer representing the answer.", "hint": "$1 \\le n_1, n_2 \\le 2 \\times 10^5$, and the strings contain only lowercase letters.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HAOI2016] 找相同字符", "background": "", "description": "给定两个字符串，求出在两个字符串中各取出一个子串使得这两个子串相同的方案数。两个方案不同当且仅当这两个子串中有一个位置不同。\n", "inputFormat": "两行，两个字符串 $s_1,s_2$，长度分别为 $n_1,n_2$。\n", "outputFormat": "输出一个整数表示答案。\n", "hint": "$1\\le n_1,n_2\\le 2\\times 10^5$，字符串中只有小写字母。", "locale": "zh-CN"}}}
{"pid": "P3182", "type": "P", "difficulty": 3, "samples": [["2\n0 1\n1 0", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["高精度", "递推", "2016", "河南", "各省省选"], "title": "[HAOI2016] 放棋子", "background": "", "description": "给你一个 $N\\times N$ 的矩阵，每行有一个障碍，数据保证任意两个障碍不在同一行，任意两个障碍不在同一列，要求你在这个矩阵上放 $N$ 枚棋子（障碍的位置不能放棋子），要求你放 $N$ 个棋子也满足每行只有一枚棋子，每列只有一枚棋子的限制，求有多少种方案。\n", "inputFormat": "第一行一个 $N$，接下来一个 $N \\times N$ 的矩阵。$N\\leq 200$，0 表示没有障碍，1 表示有障碍。\n", "outputFormat": "一个整数，即合法的方案数。\n", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[HAOI2016] Placing Pieces", "background": "", "description": "Given an $N\\times N$ matrix. Each row contains exactly one obstacle; it is guaranteed that no two obstacles are in the same row or the same column. You need to place $N$ pieces on this matrix (you cannot place a piece on a cell with an obstacle) such that each row contains exactly one piece and each column contains exactly one piece. Find the number of valid arrangements.", "inputFormat": "The first line contains an integer $N$, followed by an $N \\times N$ matrix. $N\\leq 200$. $0$ denotes no obstacle, and $1$ denotes an obstacle.", "outputFormat": "A single integer, the number of valid arrangements.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HAOI2016] 放棋子", "background": "", "description": "给你一个 $N\\times N$ 的矩阵，每行有一个障碍，数据保证任意两个障碍不在同一行，任意两个障碍不在同一列，要求你在这个矩阵上放 $N$ 枚棋子（障碍的位置不能放棋子），要求你放 $N$ 个棋子也满足每行只有一枚棋子，每列只有一枚棋子的限制，求有多少种方案。\n", "inputFormat": "第一行一个 $N$，接下来一个 $N \\times N$ 的矩阵。$N\\leq 200$，0 表示没有障碍，1 表示有障碍。\n", "outputFormat": "一个整数，即合法的方案数。\n", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3183", "type": "P", "difficulty": 3, "samples": [["10 16\n1 2\n1 4\n1 10\n2 3\n2 5\n4 3\n4 5\n4 8\n6 5\n7 6\n7 9\n8 5\n9 8\n10 6\n10 7\n10 9", "9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "搜索", "图论", "2016", "河南", "各省省选", "记忆化搜索", "拓扑排序"], "title": "[HAOI2016] 食物链", "background": "", "description": " ![](https://cdn.luogu.com.cn/upload/pic/13153.png) \n\n如图所示为某生态系统的食物网示意图，据图回答第 1 小题  \n现在给你 $n$ 个物种和 $m$ 条能量流动关系，求其中的食物链条数。物种的名称为从 $1$ 到 $n$ 编号 $M$ 条能量流动关系形如 $a_1,b_1,a_2,b_2,a_3,b_3,\\ldots,a_{m-1},b_{m-1},a_m,b_m$。其中 $a_i$ 和 $b_i$ 表示能量从物种 $a_i$ 流向物种 $b_i$，注意单独的一种孤立生物不算一条食物链。\n", "inputFormat": "第一行两个整数 $n, m$，接下来 $m$ 行每行两个整数 $a_i$ 和 $b_i$ 描述 $m$ 条能量流动关系。", "outputFormat": "一个整数即食物网中的食物链条数。", "hint": "数据保证输入数据符合生物学特点，且不会有重复的能量流动关系出现，题目保证答案不会爆 `int`。\n\n对于 $100 \\%$ 的数据，$1 \\leq N \\leq 100000$，$0 \\leq m \\leq 200000$。", "locale": "zh-CN", "translations": {"en": {"title": "[HAOI2016] Food Chain", "background": "", "description": "![](https://cdn.luogu.com.cn/upload/pic/13153.png)\n\nThe figure shows a schematic food web of an ecosystem. You are given $n$ species and $m$ energy-flow relations; compute the number of food chains. Species are labeled from $1$ to $n$. The $m$ energy-flow relations are given as pairs $a_1, b_1, a_2, b_2, a_3, b_3, \\ldots, a_{m-1}, b_{m-1}, a_m, b_m$, where $a_i$ and $b_i$ mean that energy flows from species $a_i$ to species $b_i$. Note that a single isolated species does not count as a food chain.", "inputFormat": "The first line contains two integers $n, m$. The next $m$ lines each contain two integers $a_i$ and $b_i$ describing the $m$ energy-flow relations.", "outputFormat": "Output a single integer: the number of food chains in the food web.", "hint": "The testdata guarantee that the input conforms to biological properties, and there are no duplicate energy-flow relations. The answer is guaranteed not to overflow a 32-bit signed int.\n\nConstraints: for $100\\%$ of the testdata, $1 \\leq n \\leq 100000$, $0 \\leq m \\leq 200000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HAOI2016] 食物链", "background": "", "description": " ![](https://cdn.luogu.com.cn/upload/pic/13153.png) \n\n如图所示为某生态系统的食物网示意图，据图回答第 1 小题  \n现在给你 $n$ 个物种和 $m$ 条能量流动关系，求其中的食物链条数。物种的名称为从 $1$ 到 $n$ 编号 $M$ 条能量流动关系形如 $a_1,b_1,a_2,b_2,a_3,b_3,\\ldots,a_{m-1},b_{m-1},a_m,b_m$。其中 $a_i$ 和 $b_i$ 表示能量从物种 $a_i$ 流向物种 $b_i$，注意单独的一种孤立生物不算一条食物链。\n", "inputFormat": "第一行两个整数 $n, m$，接下来 $m$ 行每行两个整数 $a_i$ 和 $b_i$ 描述 $m$ 条能量流动关系。", "outputFormat": "一个整数即食物网中的食物链条数。", "hint": "数据保证输入数据符合生物学特点，且不会有重复的能量流动关系出现，题目保证答案不会爆 `int`。\n\n对于 $100 \\%$ 的数据，$1 \\leq N \\leq 100000$，$0 \\leq m \\leq 200000$。", "locale": "zh-CN"}}}
{"pid": "P3184", "type": "P", "difficulty": 2, "samples": [["4 6\n3 2 7 5\n2 3\n2 4\n2 5\n2 7\n4 6\n8 10", "2\n2\n3\n4\n1\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2016", "线段树", "二分", "USACO", "树状数组", "离散化", "排序", "前缀和"], "title": "[USACO16DEC] Counting Haybales S", "background": "", "description": "Farmer John has just arranged his $N$ haybales ($1 \\leq N \\leq 100,000$) at various points along the one-dimensional road running across his farm.  To make sure they are spaced out appropriately, please help him answer $Q$ queries ($1 \\leq Q \\leq 100,000$), each asking for the number of haybales within a specific interval along the road.", "inputFormat": "The first line contains $N$ and $Q$.\n\nThe next line contains $N$ distinct integers, each in the range $0 \\ldots 1,000,000,000$, indicating that there is a haybale at each of those locations.\n\nEach of the next $Q$ lines contains two integers $A$ and $B$($0 \\leq A \\leq B \\leq 1,000,000,000$) giving a query for the number of haybales between $A$ and $B$, inclusive.", "outputFormat": "You should write $Q$ lines of output.  For each query, output the number of haybales in its respective interval.", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO16DEC] Counting Haybales S", "background": "", "description": "Farmer John has just arranged his $N$ haybales ($1 \\leq N \\leq 100,000$) at various points along the one-dimensional road running across his farm.  To make sure they are spaced out appropriately, please help him answer $Q$ queries ($1 \\leq Q \\leq 100,000$), each asking for the number of haybales within a specific interval along the road.", "inputFormat": "The first line contains $N$ and $Q$.\n\nThe next line contains $N$ distinct integers, each in the range $0 \\ldots 1,000,000,000$, indicating that there is a haybale at each of those locations.\n\nEach of the next $Q$ lines contains two integers $A$ and $B$($0 \\leq A \\leq B \\leq 1,000,000,000$) giving a query for the number of haybales between $A$ and $B$, inclusive.", "outputFormat": "You should write $Q$ lines of output.  For each query, output the number of haybales in its respective interval.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO16DEC] Counting Haybales S", "background": "", "description": "Farmer John 刚刚将他的 $N$ 个干草捆（$1 \\leq N \\leq 100,000$）安排在他农场的一维道路上的各个位置。为了确保它们之间的间距合适，请帮助他回答 $Q$ 个查询（$1 \\leq Q \\leq 100,000$），每个查询询问在道路的特定区间内有多少个干草捆。", "inputFormat": "第一行包含 $N$ 和 $Q$。\n\n第二行包含 $N$ 个不同的整数，每个整数的范围在 $0 \\ldots 1,000,000,000$ 之间，表示每个位置上有一个干草捆。\n\n接下来的 $Q$ 行每行包含两个整数 $A$ 和 $B$（$0 \\leq A \\leq B \\leq 1,000,000,000$），表示一个查询，询问在 $A$ 到 $B$（包括 $A$ 和 $B$）的区间内有多少个干草捆。", "outputFormat": "你需要输出 $Q$ 行。对于每个查询，输出其对应区间内的干草捆数量。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3185", "type": "P", "difficulty": 6, "samples": [["2\n4\n1 0 1 5000\n3\n0 0 1", "0 2 3\n1\n-1 -1 -1\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["博弈论", "2007", "各省省选", "湖南", "枚举"], "title": "[HNOI2007] 分裂游戏", "background": "", "description": "聪聪和睿睿最近迷上了一款叫做分裂的游戏。\n\n该游戏的规则是： 共有 $n$ 个瓶子， 标号为 $0, 1, \\ldots, n-1$，第 $i$ 个瓶子中装有 $p_i$ 颗巧克力豆，两个人轮流取豆子，每一轮每人选择 $3$ 个瓶子，标号为 $i,j,k$, 并要保证 $i \\lt j, j \\leq k$，且第 $i$ 个瓶子中至少要有 $1$ 颗巧克力豆，随后这个人从第 $i$ 个瓶子中拿走一颗豆子并在 $j,k$ 中各放入一粒豆子（$j$ 可能等于 $k$） 。如果轮到某人而他无法按规则取豆子，那么他将输掉比赛。胜利者可以拿走所有的巧克力豆！\n\n两人最后决定由聪聪先取豆子，为了能够得到最终的巧克力豆，聪聪自然希望赢得比赛。他思考了一下，发现在有的情况下，先拿的人一定有办法取胜，但是他不知道对于其他情况是否有必胜策略，更不知道第一步该如何取。他决定偷偷请教聪明的你，希望你能告诉他，在给定每个瓶子中的最初豆子数后是否能让自己得到所有巧克力豆，他还希望你告诉他第一步该如何取，并且为了必胜，第一步有多少种取法？ \n", "inputFormat": "输入文件第一行是一个整数 $t$，表示测试数据的组数。\n\n每组测试数据的第一行是瓶子的个数 $n$，接下来的一行有 $n$ 个由空格隔开的非负整数，表示每个瓶子中的豆子数。", "outputFormat": "对于每组测试数据，输出包括两行，第一行为用一个空格两两隔开的三个整数，表示要想赢得游戏，第一步应该选取的 $3$ 个瓶子的编号 $i,j,k$，如果有多组符合要求的解，那么输出字典序最小的一组。如果无论如何都无法赢得游戏，那么输出用一个空格两两隔开的三个 $-1$。\n\n第二行表示要想确保赢得比赛，第一步有多少种不同的取法。", "hint": "$1 \\leq t \\leq 10$，$2 \\leq n \\leq 21$，$0 \\leq p_i \\leq 10^4$，", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2007] Split Game", "background": "", "description": "Congcong and Ruirui have become obsessed with a game called Split.\n\nThe rules are as follows: There are $n$ bottles labeled $0, 1, \\ldots, n-1$. Bottle $i$ initially contains $p_i$ chocolate beans. The two players take turns. On each turn, a player chooses three bottles with indices $i, j, k$ such that $i \\lt j$ and $j \\leq k$, and bottle $i$ must contain at least $1$ bean. The player removes one bean from bottle $i$ and adds one bean to each of bottles $j$ and $k$ (note that $j$ may equal $k$). If it is a player’s turn and they cannot make a move following the rules, they lose. The winner takes all the chocolate beans.\n\nCongcong moves first. He wants to know whether he can force a win given the initial numbers of beans in each bottle. He also wants you to tell him how to play the first move, and, to ensure victory, how many different first moves there are.", "inputFormat": "The first line of input contains an integer $t$, the number of test cases.\n\nFor each test case, the first line contains the number of bottles $n$. The next line contains $n$ space-separated non-negative integers, the number of beans in each bottle.", "outputFormat": "For each test case, output two lines. The first line contains three integers separated by single spaces, representing the indices $i, j, k$ that should be chosen on the first move to guarantee a win. If there are multiple valid answers, output the lexicographically smallest triple. If it is impossible to win no matter what, output three $-1$ separated by single spaces.\n\nThe second line contains the number of distinct first moves that ensure a win.", "hint": "Constraints: $1 \\leq t \\leq 10$, $2 \\leq n \\leq 21$, $0 \\leq p_i \\leq 10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2007] 分裂游戏", "background": "", "description": "聪聪和睿睿最近迷上了一款叫做分裂的游戏。\n\n该游戏的规则是： 共有 $n$ 个瓶子， 标号为 $0, 1, \\ldots, n-1$，第 $i$ 个瓶子中装有 $p_i$ 颗巧克力豆，两个人轮流取豆子，每一轮每人选择 $3$ 个瓶子，标号为 $i,j,k$, 并要保证 $i \\lt j, j \\leq k$，且第 $i$ 个瓶子中至少要有 $1$ 颗巧克力豆，随后这个人从第 $i$ 个瓶子中拿走一颗豆子并在 $j,k$ 中各放入一粒豆子（$j$ 可能等于 $k$） 。如果轮到某人而他无法按规则取豆子，那么他将输掉比赛。胜利者可以拿走所有的巧克力豆！\n\n两人最后决定由聪聪先取豆子，为了能够得到最终的巧克力豆，聪聪自然希望赢得比赛。他思考了一下，发现在有的情况下，先拿的人一定有办法取胜，但是他不知道对于其他情况是否有必胜策略，更不知道第一步该如何取。他决定偷偷请教聪明的你，希望你能告诉他，在给定每个瓶子中的最初豆子数后是否能让自己得到所有巧克力豆，他还希望你告诉他第一步该如何取，并且为了必胜，第一步有多少种取法？ \n", "inputFormat": "输入文件第一行是一个整数 $t$，表示测试数据的组数。\n\n每组测试数据的第一行是瓶子的个数 $n$，接下来的一行有 $n$ 个由空格隔开的非负整数，表示每个瓶子中的豆子数。", "outputFormat": "对于每组测试数据，输出包括两行，第一行为用一个空格两两隔开的三个整数，表示要想赢得游戏，第一步应该选取的 $3$ 个瓶子的编号 $i,j,k$，如果有多组符合要求的解，那么输出字典序最小的一组。如果无论如何都无法赢得游戏，那么输出用一个空格两两隔开的三个 $-1$。\n\n第二行表示要想确保赢得比赛，第一步有多少种不同的取法。", "hint": "$1 \\leq t \\leq 10$，$2 \\leq n \\leq 21$，$0 \\leq p_i \\leq 10^4$，", "locale": "zh-CN"}}}
{"pid": "P3186", "type": "P", "difficulty": 7, "samples": [["17 18\n74 82 82 76 101 114 97 97 92 77 86 92 77 81 121 75 83\n89 82 74 61 67 74 77 90 75 83 119 125 121 138 175 124 81\n69 64 64 69 69 75 75 69 72 108 160 162 166 178 193 145 82\n57 64 75 99 110 122 117 75 64 81 119 110 119 127 137 91 61\n70 97 113 113 114 148 170 127 78 72 82 72 89 96 96 78 72\n69 128 123 92 72 108 161 141 72 61 69 72 110 102 75 70 65\n69 141 118 75 59 75 130 123 83 72 89 108 166 156 108 97 72\n92 148 108 69 64 78 130 130 78 66 72 83 158 167 138 138 72\n85 143 80 66 72 80 141 121 72 66 64 80 72 92 150 150 74\n83 146 92 75 78 85 146 134 66 75 72 75 66 61 107 146 69\n82 139 89 69 69 78 141 141 64 75 64 69 72 64 93 144 82\n96 148 104 82 83 95 148 148 70 69 69 69 64 69 113 155 78\n91 143 104 78 84 104 141 127 72 86 128 114 61 72 128 146 69\n101 145 96 61 70 102 139 117 80 97 175 175 114 120 132 97 76\n119 170 127 75 81 124 141 104 75 84 152 169 139 135 103 57 55\n101 172 162 115 119 142 127 70 75 72 110 104 87 84 57 53 32\n78 110 154 154 132 116 80 57 91 99 81 70 53 50 48 18 14\n72 80 107 99 83 81 69 64 77 87 76 70 55 53 48 18 10", "2\n03"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2007", "各省省选", "湖南"], "title": "[HNOI2007] 所罗门的咒语", "background": null, "description": "所罗门的宝藏被一个强大的咒语封印着，只有用特殊的咒语才能打开。为了给后来人留下一线开启的希望，所罗门将开启宝藏的咒语隐藏在巨大的所罗门广场。\n\n所罗门广场由边长为 $1$ 米的正方形大理石板铺成，据说由于所罗门魔法的作用，在每个雷电交加的黎明，广场上的每块大理石板会发出不同的微弱的光芒，而那些亮度大于某个值的大理石板作为一个整体来看，就是开启所罗门宝藏的咒语，但由于年久失修，有的大理石板可能产生错误的亮度。\n\n图 1 为在一个雷电交加的黎明从太空看所罗门广场的一个实例。通过所罗门的藏书可以知道，开启所罗门宝藏的咒语是由 $15$ 种字符 `0`, `1`, `2`, `3`, `4`, `5`, `6`, `7`, `8`, `9`, `A`, `D`, `E`, `L`, `X` 中的若干个组成的长度小于 $10$ 的符号串，这些符号按照从左到右的顺序大致排成一行，如图 1 所示。\n\n现已在一个雷电交加的黎明搜集到所罗门广场上各块大理石板的亮度，亮度值用 $0$ 到 $255$ 的整数来度量，你能破译出开启所罗门宝藏的咒语么？\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pko6syac.png)", "inputFormat": "第一行包含用一个空格隔开的 $2$ 个整数 $L$ 和 $H$，其中 $L$ 表示所罗门广场包含的大理石板的列数，$5 \\le L \\le 100$，$H$ 表示所罗门广场包含的大理石板的行数，$5 \\le H \\le 100$。\n\n接下来的 $H$ 行，每行有 $L$ 个由一个空格隔开的整数，不妨记接下来的第 $i$ 行，第 $j$ 列的整数为 $V_{ij}$，则有 $0 \\le V_{ij} \\le 255$。", "outputFormat": "第一行为正整数 $t$，表示咒语的长度。第二行为一个长度为 $t$ 的字符串，表示识别出的咒语。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2007] Solomon's Spell", "background": "", "description": "Solomon's treasure is sealed by a powerful spell, and only a special incantation can open it. To leave a glimmer of hope for future generations, Solomon hid the incantation needed to open the treasure within the vast Solomon Square.\n\nSolomon Square is paved with square marble slabs with side length $1$ meter. It is said that due to Solomon's magic, at every lightning-filled dawn, each marble slab emits a faint light of varying intensity. Those slabs whose brightness exceeds a certain threshold, when viewed as a whole, form the incantation to open Solomon's treasure. However, due to years of disrepair, some slabs may have incorrect brightness.\n\nFigure 1 shows an example view of Solomon Square from space during a lightning-filled dawn. According to Solomon's books, the incantation to open the treasure consists of several of the 15 characters `0`, `1`, `2`, `3`, `4`, `5`, `6`, `7`, `8`, `9`, `A`, `D`, `E`, `L`, `X`, forming a string of length less than $10$. These symbols are roughly arranged in a single line from left to right, as shown in Figure 1.\n\nThe brightness of each marble slab on Solomon Square has been collected during a lightning-filled dawn. The brightness values are measured by integers from $0$ to $255$. Can you decipher the incantation that opens Solomon's treasure?\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pko6syac.png)", "inputFormat": "The first line contains two integers $L$ and $H$ separated by a space, where $L$ is the number of columns of marble slabs in Solomon Square, $5 \\le L \\le 100$, and $H$ is the number of rows, $5 \\le H \\le 100$.\n\nThe next $H$ lines each contain $L$ integers separated by a space. Let the integer in the $i$-th line and the $j$-th column be $V_{ij}$, then $0 \\le V_{ij} \\le 255$.", "outputFormat": "The first line contains a positive integer $t$, indicating the length of the incantation. The second line contains a string of length $t$, representing the recognized incantation.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2007] 所罗门的咒语", "background": null, "description": "所罗门的宝藏被一个强大的咒语封印着，只有用特殊的咒语才能打开。为了给后来人留下一线开启的希望，所罗门将开启宝藏的咒语隐藏在巨大的所罗门广场。\n\n所罗门广场由边长为 $1$ 米的正方形大理石板铺成，据说由于所罗门魔法的作用，在每个雷电交加的黎明，广场上的每块大理石板会发出不同的微弱的光芒，而那些亮度大于某个值的大理石板作为一个整体来看，就是开启所罗门宝藏的咒语，但由于年久失修，有的大理石板可能产生错误的亮度。\n\n图 1 为在一个雷电交加的黎明从太空看所罗门广场的一个实例。通过所罗门的藏书可以知道，开启所罗门宝藏的咒语是由 $15$ 种字符 `0`, `1`, `2`, `3`, `4`, `5`, `6`, `7`, `8`, `9`, `A`, `D`, `E`, `L`, `X` 中的若干个组成的长度小于 $10$ 的符号串，这些符号按照从左到右的顺序大致排成一行，如图 1 所示。\n\n现已在一个雷电交加的黎明搜集到所罗门广场上各块大理石板的亮度，亮度值用 $0$ 到 $255$ 的整数来度量，你能破译出开启所罗门宝藏的咒语么？\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pko6syac.png)", "inputFormat": "第一行包含用一个空格隔开的 $2$ 个整数 $L$ 和 $H$，其中 $L$ 表示所罗门广场包含的大理石板的列数，$5 \\le L \\le 100$，$H$ 表示所罗门广场包含的大理石板的行数，$5 \\le H \\le 100$。\n\n接下来的 $H$ 行，每行有 $L$ 个由一个空格隔开的整数，不妨记接下来的第 $i$ 行，第 $j$ 列的整数为 $V_{ij}$，则有 $0 \\le V_{ij} \\le 255$。", "outputFormat": "第一行为正整数 $t$，表示咒语的长度。第二行为一个长度为 $t$ 的字符串，表示识别出的咒语。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P3187", "type": "P", "difficulty": 6, "samples": [["6\n1.0 3.00000\n1 4.00000\n2.0000 1\n3 0.0000\n3.00000 6\n6.0 3.0", "18.00000\n3.00000 0.00000\n6.00000 3.00000\n3.00000 6.00000\n0.00000 3.00000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2007", "各省省选", "湖南", "Special Judge", "枚举", "凸包", "旋转卡壳"], "title": "[HNOI2007] 最小矩形覆盖", "background": "", "description": "给定一些点的坐标，求能够覆盖所有点的最小面积的矩形，输出所求矩形的面积和四个顶点坐标。", "inputFormat": "第一行为一个整数 $n$，从第 $2$ 至第 $n+1$ 行每行有两个浮点数（精确到至多五位小数，不使用科学计数法），表示一个顶点的 $x$ 和 $y$ 坐标。", "outputFormat": "第一行为一个浮点数，表示所求矩形的面积，接下来 $4$ 行每行表示一个顶点坐标，**按逆时针**输出顶点坐标。", "hint": "$3 \\le n \\le 50000$，坐标范围 $\\in [0,10]$。保证覆盖所有点所需要的最小矩形面积至少是 $0.1$。\n\n如果你的矩形面积为 $S'$，正确答案为 $S$，那么当 $\\frac{|S'-S|}{\\max\\{1,S\\}}<10^{-4}$，且所有点满足在矩形内或者到矩形的距离 $<10^{-4}$ 时，你的答案会被判定为正确（你可以忽略这段话，简而言之你的答案只要不是有特别大的精度误差就可以通过）。\n\n感谢 @intruder 提供题目简述\n", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2007] Minimum Rectangle Cover", "background": "", "description": "Given the coordinates of several points, find the rectangle with the minimum area that covers all the points. Output the area of the rectangle and the coordinates of its four vertices.", "inputFormat": "The first line contains an integer $n$. From line $2$ to line $n+1$, each line contains two floating-point numbers (with up to five decimal places, not in scientific notation), representing the $x$ and $y$ coordinates of a point.", "outputFormat": "The first line contains a floating-point number, which is the area of the rectangle. The next $4$ lines each contain the coordinates of a vertex, output in **counterclockwise** order.", "hint": "$3 \\le n \\le 50000$, coordinate range $\\in [0, 10]$. It is guaranteed that the minimum rectangle area needed to cover all points is at least $0.1$.\n\nIf your rectangle area is $S'$, and the correct answer is $S$, then your answer will be judged correct when $\\frac{|S' - S|}{\\max\\{1, S\\}} < 10^{-4}$, and all points are inside the rectangle or have distance $< 10^{-4}$ to the rectangle (you can ignore this paragraph; in short, your answer will pass as long as the numerical error is not particularly large).\n\nThanks to @intruder for providing the problem summary.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2007] 最小矩形覆盖", "background": "", "description": "给定一些点的坐标，求能够覆盖所有点的最小面积的矩形，输出所求矩形的面积和四个顶点坐标。", "inputFormat": "第一行为一个整数 $n$，从第 $2$ 至第 $n+1$ 行每行有两个浮点数（精确到至多五位小数，不使用科学计数法），表示一个顶点的 $x$ 和 $y$ 坐标。", "outputFormat": "第一行为一个浮点数，表示所求矩形的面积，接下来 $4$ 行每行表示一个顶点坐标，**按逆时针**输出顶点坐标。", "hint": "$3 \\le n \\le 50000$，坐标范围 $\\in [0,10]$。保证覆盖所有点所需要的最小矩形面积至少是 $0.1$。\n\n如果你的矩形面积为 $S'$，正确答案为 $S$，那么当 $\\frac{|S'-S|}{\\max\\{1,S\\}}<10^{-4}$，且所有点满足在矩形内或者到矩形的距离 $<10^{-4}$ 时，你的答案会被判定为正确（你可以忽略这段话，简而言之你的答案只要不是有特别大的精度误差就可以通过）。\n\n感谢 @intruder 提供题目简述\n", "locale": "zh-CN"}}}
{"pid": "P3188", "type": "P", "difficulty": 5, "samples": [["4 10\n8 9\n5 8\n4 6\n2 5\n4 13\n8 9\n5 8\n4 6\n2 5\n16 75594681\n393216 5533\n2 77\n32768 467\n29360128 407840\n112 68\n24576 372\n768 60\n33554432 466099\n16384 318\n33554432 466090\n2048 111\n24576 350\n9216 216\n12582912 174768\n16384 295\n1024 76\n-1 -1", "14\n19\n1050650"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2007", "各省省选", "湖南", "背包 DP", "进制"], "title": "[HNOI2007] 梦幻岛宝珠", "background": "", "description": "给你 $n$ 颗宝石，每颗宝石都有重量和价值。要你从这些宝石中选取一些宝石，保证总重量不超过 $W$，且总价值最大，并输出最大的总价值。\n", "inputFormat": "输入文件中包含多组数据。每组数据的格式如下：\n\n第一行是两个正整数 $n$ 和 $W$，分别表示宝石的数目和最多能带走的宝石重量。\n\n接下来的 $n$ 行，每行有两个正整数 $w_i,v_i$，分别表示第 $i$ 颗宝石的重量和价值。\n\n最后一组数据的后面有两个 $-1$，表示文件的结束。这两个 $-1$ 并不代表一组数据，你不需对这组数据输出结果。  \n\n输入文件中数据的组数不超过 $20$。\n", "outputFormat": "对于输入的每组数据，输出一个整数 $c$，表示小 P 最多能带走的宝石的总价值。  \n每个结果整数 $c$ 单独占一行。\n", "hint": "### 数据范围及约定\n\n对于 $100\\%$ 的数据，$1\\le n \\le 100$，$1\\le W,w_i,v_i \\le 2^{30}$。  \n保证每个 $w_i$ 能写成 $a \\times 2^b\\space (a,b \\in \\mathbb N)$ 的形式，$a \\leq 10$ , $b \\leq 30$，且答案不超过 $2^{30}$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2007] Dream Island Orbs", "background": "", "description": "You are given $n$ gems, each with a weight and a value. Choose some of these gems so that the total weight does not exceed $W$, and the total value is maximized. Output the maximum total value.", "inputFormat": "The input contains multiple test cases. Each test case is formatted as follows:\n\nThe first line contains two positive integers $n$ and $W$, representing the number of gems and the maximum total weight you can carry.\n\nThe next $n$ lines each contain two positive integers $w_i, v_i$, representing the weight and value of the $i$-th gem.\n\nAfter the last test case, there are two $-1$ indicating the end of file. These two $-1$ do not represent a test case, and you should not output a result for them.  \nThe number of test cases in the input file does not exceed $20$.", "outputFormat": "For each test case, output an integer $c$, the maximum total value of the gems you can carry.  \nPrint each integer $c$ on a separate line.", "hint": "### Constraints\n\nFor $100\\%$ of the testdata, $1\\le n \\le 100$, $1\\le W,w_i,v_i \\le 2^{30}$.  \nIt is guaranteed that each $w_i$ can be written as $a \\times 2^b\\space (a,b \\in \\mathbb N)$ with $a \\leq 10$, $b \\leq 30$, and the answer does not exceed $2^{30}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2007] 梦幻岛宝珠", "background": "", "description": "给你 $n$ 颗宝石，每颗宝石都有重量和价值。要你从这些宝石中选取一些宝石，保证总重量不超过 $W$，且总价值最大，并输出最大的总价值。\n", "inputFormat": "输入文件中包含多组数据。每组数据的格式如下：\n\n第一行是两个正整数 $n$ 和 $W$，分别表示宝石的数目和最多能带走的宝石重量。\n\n接下来的 $n$ 行，每行有两个正整数 $w_i,v_i$，分别表示第 $i$ 颗宝石的重量和价值。\n\n最后一组数据的后面有两个 $-1$，表示文件的结束。这两个 $-1$ 并不代表一组数据，你不需对这组数据输出结果。  \n\n输入文件中数据的组数不超过 $20$。\n", "outputFormat": "对于输入的每组数据，输出一个整数 $c$，表示小 P 最多能带走的宝石的总价值。  \n每个结果整数 $c$ 单独占一行。\n", "hint": "### 数据范围及约定\n\n对于 $100\\%$ 的数据，$1\\le n \\le 100$，$1\\le W,w_i,v_i \\le 2^{30}$。  \n保证每个 $w_i$ 能写成 $a \\times 2^b\\space (a,b \\in \\mathbb N)$ 的形式，$a \\leq 10$ , $b \\leq 30$，且答案不超过 $2^{30}$。\n", "locale": "zh-CN"}}}
{"pid": "P3189", "type": "P", "difficulty": 0, "samples": [["10 12 3 2 3 5 2 3\n0 0 0 1 0 1 1 1 9 1 1 1\n1 1 2 1 1 1 0 0 8 2 1 8\n1 0 1 0 1 6 1 1 0 0 1 1\n1 1 2 1 2 1 1 1 3 1 1 1\n0 1 0 1 1 1 2 1 6 0 2 1\n1 1 0 1 0 1 1 2 1 1 1 0\n1 0 1 1 1 0 1 0 1 1 0 1\n1 1 0 1 1 1 9 0 0 1 1 1\n0 0 1 0 1 2 1 9 1 1 0 1\n0 1 1 1 1 1 9 1 1 1 1 1", "59"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2007", "各省省选", "湖南", "枚举", "概率论"], "title": "[HNOI2007] 海盗分宝", "background": "", "description": "据说，加勒比海盗每次抢劫完，如果有金银珠宝等贵重物品，都会以特殊的仪式分宝。\n\n他们首先将珠宝装在一个个边长为 $1$ 的土陶立方体中，并在盖子上标记出珠宝的价值 $v$。然后将这些盒子排列成一个长为 $l$，宽为 $w$ 的矩形（如果珠宝不够，可能会用空的土陶盒占据空位，并在盖子上标记价值为 $0$），第 $i$ 行第 $j$ 列的土陶盒上标记的价值为 $v_{i,j}$（其中 $0<i\\leq w$，$0<j\\leq l$，**左下角的土陶盒所在位置为第一行第一列**）。\n\n海盗们按照功劳的大小，决定分宝的顺序，被轮到选取珠宝的海盗将被发给一个底面为 $m\\times n$ 的矩形，高为 $h$ 的木箱子，并要求用这个木箱子来装所选土陶盒，最后盖上木箱盖子。\n\n土陶盒的选取需要分批选取，要求每批土陶盒为一个等同于木箱底面的紧挨着的矩形区域，且木箱长为 $m$ 的边必须与土陶盒摆成矩形时长为 $w$ 的边平行。被选走的土陶盒所在位置在被选走后马上由空土陶盒填充。海盗从土陶盒摆成的矩形底部正中出发，即从第一行的第  $\\lfloor \\frac{w}{2} \\rfloor$ 列的土陶盒的右下角出发，向上沿着据土陶盒摆成的矩形区域的最左边 $\\lfloor \\frac{w}{2} \\rfloor$ 的直线前进。\n\n如图中粗线箭头所示。设第 $k$ 批被选取的区域的最小角为第 $i_k$ 行第 $j_k$ 列的土陶盒，$j_k$ 必须满足 $\\lfloor \\frac{m}{2}+j_k-\\frac{w}{2}\\rfloor \\leq a$，其中 $k\\geq 1$，且当 $j_k=j_{k-1}$ 的时候，$i_k$ 必须满足 $i_k-i_{k-1}\\geq d_1$，当 $j_k\\neq j_{k-1}$ 时，$i_k$ 必须满足 $i_k-i_{k-1}\\geq d_2$，其中 $k\\geq 2$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tft6e873.png)", "inputFormat": "第一行包括八个正整数，这些正整数之间用一个空格隔开，这八个正整数依次为 $l,w,m,n,h,a,d_1,d_2$。从第二行到第 $l+1$ 行，每行有 $w$ 个整数，不妨将输入中第 $i+1$ 行，第 $j$ 列的整数记做 $v_{i,j}$（$1\\leq j\\leq w$，$1\\leq i\\leq l$），分别表示土陶盒上标记的珠宝价值，同一行的整数之间用一个空格隔开。\n\n需注意的是：**输入时 $v_{i,j}$ 是从左上角的土陶盒开始，但在求解时左下角的那个土陶盒为第 $1$ 行第 $1$ 列的土陶盒。**\n", "outputFormat": "输出文件中的第一行为一个整数，是最多能得到的珠宝总价值 $T$。\n", "hint": "$d_1,d_2\\geq n$，$1\\leq l,w,a,d_1,d_2\\leq 2\\times 10^3$，$1\\leq m,n\\leq 200$，$1\\leq h\\leq 20$，$0\\leq v_{i,j}\\leq 255$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2007] Pirates Dividing the Treasure", "background": "", "description": "It is said that after each raid, if there are valuables such as gold, silver, and jewels, the Caribbean pirates divide the loot with a special ceremony.\n\nThey first pack the jewels into earthenware cubes with side length $1$, and mark the value $v$ of the jewels on the lid. Then they arrange these boxes into a rectangle of length $l$ and width $w$ (if the jewels are not enough, empty earthenware boxes may be used to fill the empty positions and are marked with value $0$). The value marked on the box at row $i$ and column $j$ is $v_{i,j}$ (where $0 < i \\leq l$, $0 < j \\leq w$; the box at the lower-left corner is at row $1$, column $1$).\n\nAccording to their contributions, the pirates decide an order for picking treasures. The pirate whose turn it is will be given a wooden crate with a base of $m \\times n$ and height $h$, and is required to fill the crate with the selected earthenware boxes, then close the crate lid.\n\nThe boxes must be selected in batches. Each batch must be a contiguous rectangular region equal to the crate’s base, and the side of the crate of length $m$ must be parallel to the side of the arranged rectangle that has length $w$. The positions of the selected boxes are immediately filled with empty boxes after removal. The pirate starts from the exact center of the bottom edge of the arranged rectangle, i.e., from the lower-right corner of the box at row $1$ and column $\\lfloor \\frac{w}{2} \\rfloor$, and proceeds upward along the vertical line that is the left edge of column $\\lfloor \\frac{w}{2} \\rfloor$ of the arranged rectangle.\n\nAs shown by the bold arrows in the figure. Let the lower-left corner of the $k$-th selected region be the box at row $i_k$, column $j_k$. The index $j_k$ must satisfy $\\lfloor \\frac{m}{2} + j_k - \\frac{w}{2} \\rfloor \\leq a$, where $k \\geq 1$. Moreover, when $j_k = j_{k-1}$, $i_k$ must satisfy $i_k - i_{k-1} \\geq d_1$; when $j_k \\neq j_{k-1}$, $i_k$ must satisfy $i_k - i_{k-1} \\geq d_2$, where $k \\geq 2$.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tft6e873.png)", "inputFormat": "The first line contains eight positive integers separated by single spaces: $l, w, m, n, h, a, d_1, d_2$. From the second line to line $l + 1$, each line contains $w$ integers. Denote the integer in row $i + 1$, column $j$ by $v_{i,j}$ ($1 \\leq j \\leq w$, $1 \\leq i \\leq l$), representing the jewel value marked on the box lid. The integers on the same line are separated by single spaces.\n\nNote: In the input, $v_{i,j}$ starts from the top-left box, but for the problem definition the box at the lower-left corner is at row $1$, column $1$.", "outputFormat": "Output a single integer on the first line: the maximum total jewel value $T$ that can be obtained.", "hint": "$d_1, d_2 \\geq n$, $1 \\leq l, w, a, d_1, d_2 \\leq 2 \\times 10^3$, $1 \\leq m, n \\leq 200$, $1 \\leq h \\leq 20$, $0 \\leq v_{i,j} \\leq 255$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2007] 海盗分宝", "background": "", "description": "据说，加勒比海盗每次抢劫完，如果有金银珠宝等贵重物品，都会以特殊的仪式分宝。\n\n他们首先将珠宝装在一个个边长为 $1$ 的土陶立方体中，并在盖子上标记出珠宝的价值 $v$。然后将这些盒子排列成一个长为 $l$，宽为 $w$ 的矩形（如果珠宝不够，可能会用空的土陶盒占据空位，并在盖子上标记价值为 $0$），第 $i$ 行第 $j$ 列的土陶盒上标记的价值为 $v_{i,j}$（其中 $0<i\\leq w$，$0<j\\leq l$，**左下角的土陶盒所在位置为第一行第一列**）。\n\n海盗们按照功劳的大小，决定分宝的顺序，被轮到选取珠宝的海盗将被发给一个底面为 $m\\times n$ 的矩形，高为 $h$ 的木箱子，并要求用这个木箱子来装所选土陶盒，最后盖上木箱盖子。\n\n土陶盒的选取需要分批选取，要求每批土陶盒为一个等同于木箱底面的紧挨着的矩形区域，且木箱长为 $m$ 的边必须与土陶盒摆成矩形时长为 $w$ 的边平行。被选走的土陶盒所在位置在被选走后马上由空土陶盒填充。海盗从土陶盒摆成的矩形底部正中出发，即从第一行的第  $\\lfloor \\frac{w}{2} \\rfloor$ 列的土陶盒的右下角出发，向上沿着据土陶盒摆成的矩形区域的最左边 $\\lfloor \\frac{w}{2} \\rfloor$ 的直线前进。\n\n如图中粗线箭头所示。设第 $k$ 批被选取的区域的最小角为第 $i_k$ 行第 $j_k$ 列的土陶盒，$j_k$ 必须满足 $\\lfloor \\frac{m}{2}+j_k-\\frac{w}{2}\\rfloor \\leq a$，其中 $k\\geq 1$，且当 $j_k=j_{k-1}$ 的时候，$i_k$ 必须满足 $i_k-i_{k-1}\\geq d_1$，当 $j_k\\neq j_{k-1}$ 时，$i_k$ 必须满足 $i_k-i_{k-1}\\geq d_2$，其中 $k\\geq 2$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tft6e873.png)", "inputFormat": "第一行包括八个正整数，这些正整数之间用一个空格隔开，这八个正整数依次为 $l,w,m,n,h,a,d_1,d_2$。从第二行到第 $l+1$ 行，每行有 $w$ 个整数，不妨将输入中第 $i+1$ 行，第 $j$ 列的整数记做 $v_{i,j}$（$1\\leq j\\leq w$，$1\\leq i\\leq l$），分别表示土陶盒上标记的珠宝价值，同一行的整数之间用一个空格隔开。\n\n需注意的是：**输入时 $v_{i,j}$ 是从左上角的土陶盒开始，但在求解时左下角的那个土陶盒为第 $1$ 行第 $1$ 列的土陶盒。**\n", "outputFormat": "输出文件中的第一行为一个整数，是最多能得到的珠宝总价值 $T$。\n", "hint": "$d_1,d_2\\geq n$，$1\\leq l,w,a,d_1,d_2\\leq 2\\times 10^3$，$1\\leq m,n\\leq 200$，$1\\leq h\\leq 20$，$0\\leq v_{i,j}\\leq 255$。", "locale": "zh-CN"}}}
{"pid": "P3190", "type": "P", "difficulty": 7, "samples": [["4 4\n100 300 -400 400\n-100 1000 1000 1000\n-100 -100 -100 -100\n-100 -100 -100 1000", "4000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2007", "各省省选", "湖南", "轮廓线 DP"], "title": "[HNOI2007] 神奇游乐园", "background": "", "description": "经历了一段艰辛的旅程后，主人公小 P 乘坐飞艇返回。在返回的途中，小 P 发现在漫无边际的沙漠中，有一块狭长的绿地特别显眼。往下仔细一看，才发现这是一个游乐场，专为旅途中疲惫的人设计。\n\n娱乐场可以看成是一块大小为 $n\\times m$ 的区域，且这个 $n\\times m$ 的区域被分成 $n\\times m$ 个小格子，每个小格子中就有一个娱乐项目。\n\n然而，小 P 并不喜欢其中的所有娱乐项目，于是，他给每个项目一个满意度。满意度为正时表示小 P 喜欢这个项目，值越大表示越喜欢。为负时表示他不喜欢，这个负数的绝对值越大表示他越不喜欢。为 $0$ 时表示他对这个项目没有喜恶。\n\n小 P 决定将飞艇停在某个小格中，然后每步他可以移动到相邻的上下左右四个格子的某个格子中。\n\n小 P 希望找一条路径，从飞艇所在格出发，最后又回到这个格子。\n\n小 P 有一个习惯，从不喜欢浪费时间。因此，他希望经过每个格子都是有意义的：他到一个地方后，就一定要感受以下那里的惊险和刺激，不管自己是不是喜欢那里的娱乐项目。而且，除了飞艇所在格，其他的格子他不愿意经过两次。小 P 希望自己至少要经过四个格子。\n\n在满足这些条件的情况下，小 P 希望自己玩过的娱乐项目的满意度之和最高。你能帮他找到这个最高的满意度之和吗？", "inputFormat": "第一行为两个正整数 $n$ 和 $m$，表示游乐场的大小为 $n\\times m$。\n\n接下来的 $n$ 行，每行有 $m$ 个整数，第 $(i + 1)$ 行的第 $j$ 个数表示游乐场的第 $i$ 行第 $j$ 列的小格子中的娱乐项目的满意度 $a_{i,j}$。同一行的两个整数之间用空格隔开。", "outputFormat": "仅一行为一个整数，表示最高的满意度之和。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $2\\leq n\\leq 100$，$2\\leq m\\leq 6$，$-10^3\\leq a_{i,j}\\leq 10^3$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2007] Magical Amusement Park", "background": "", "description": "After a tough journey, the protagonist Xiao P returns by airship. On the way back, he notices a long and narrow green patch standing out in the boundless desert. Looking closer, he realizes it is an amusement park designed for weary travelers.\n\nThe amusement park can be regarded as an area of size $n\\times m$, and this $n\\times m$ area is divided into $n\\times m$ small grid cells, with one attraction in each cell.\n\nHowever, Xiao P does not like all the attractions, so he assigns a satisfaction score to each one. A positive satisfaction means Xiao P likes this attraction, and the larger the value, the more he likes it. A negative value means he dislikes it, and the larger the absolute value, the more he dislikes it. A value of $0$ means he is neutral.\n\nXiao P decides to park the airship in some cell, and at each step he can move to one of the four adjacent cells: up, down, left, or right.\n\nXiao P wants to find a path that starts from the cell where the airship is parked and finally returns to that same cell.\n\nXiao P has a habit of not wasting time. Therefore, he wants every visited cell to be meaningful: whenever he reaches a place, he must experience the thrill there, whether or not he likes that attraction. Moreover, except for the cell where the airship is parked, he is unwilling to pass through any other cell twice. Xiao P wants to visit at least four cells.\n\nUnder these conditions, Xiao P hopes the sum of the satisfaction scores of the attractions he experiences is as large as possible. Can you help him find this maximum sum?", "inputFormat": "The first line contains two positive integers $n$ and $m$, indicating the amusement park has size $n\\times m$.\n\nThe next $n$ lines each contain $m$ integers. In the $(i + 1)$-th line, the $j$-th number represents the satisfaction score $a_{i,j}$ of the attraction in row $i$, column $j$ of the amusement park. Two integers in the same line are separated by a space.", "outputFormat": "A single line containing one integer, the maximum possible sum of satisfaction scores.", "hint": "#### Constraints\n\nFor $100\\%$ of the data, it is guaranteed that $2\\leq n\\leq 100$, $2\\leq m\\leq 6$, $-10^3\\leq a_{i,j}\\leq 10^3$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2007] 神奇游乐园", "background": "", "description": "经历了一段艰辛的旅程后，主人公小 P 乘坐飞艇返回。在返回的途中，小 P 发现在漫无边际的沙漠中，有一块狭长的绿地特别显眼。往下仔细一看，才发现这是一个游乐场，专为旅途中疲惫的人设计。\n\n娱乐场可以看成是一块大小为 $n\\times m$ 的区域，且这个 $n\\times m$ 的区域被分成 $n\\times m$ 个小格子，每个小格子中就有一个娱乐项目。\n\n然而，小 P 并不喜欢其中的所有娱乐项目，于是，他给每个项目一个满意度。满意度为正时表示小 P 喜欢这个项目，值越大表示越喜欢。为负时表示他不喜欢，这个负数的绝对值越大表示他越不喜欢。为 $0$ 时表示他对这个项目没有喜恶。\n\n小 P 决定将飞艇停在某个小格中，然后每步他可以移动到相邻的上下左右四个格子的某个格子中。\n\n小 P 希望找一条路径，从飞艇所在格出发，最后又回到这个格子。\n\n小 P 有一个习惯，从不喜欢浪费时间。因此，他希望经过每个格子都是有意义的：他到一个地方后，就一定要感受以下那里的惊险和刺激，不管自己是不是喜欢那里的娱乐项目。而且，除了飞艇所在格，其他的格子他不愿意经过两次。小 P 希望自己至少要经过四个格子。\n\n在满足这些条件的情况下，小 P 希望自己玩过的娱乐项目的满意度之和最高。你能帮他找到这个最高的满意度之和吗？", "inputFormat": "第一行为两个正整数 $n$ 和 $m$，表示游乐场的大小为 $n\\times m$。\n\n接下来的 $n$ 行，每行有 $m$ 个整数，第 $(i + 1)$ 行的第 $j$ 个数表示游乐场的第 $i$ 行第 $j$ 列的小格子中的娱乐项目的满意度 $a_{i,j}$。同一行的两个整数之间用空格隔开。", "outputFormat": "仅一行为一个整数，表示最高的满意度之和。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $2\\leq n\\leq 100$，$2\\leq m\\leq 6$，$-10^3\\leq a_{i,j}\\leq 10^3$。", "locale": "zh-CN"}}}
{"pid": "P3191", "type": "P", "difficulty": 6, "samples": [["5 5\nXXXXX\nX...D\nXX.XX\nX..XX\nXXDXX", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["搜索", "2007", "二分", "各省省选", "网络流", "湖南"], "title": "[HNOI2007] 紧急疏散（EVACUATE）", "background": null, "description": "发生了火警，所有人员需要紧急疏散！\n\n假设这个房间是一个 $N \\times M$ 的矩形区域。每个格子有三个状态：\n\n- 一块空地，可以通行，用 `.` 表示。\n- 一面墙，不可以通行，用 `X` 表示。\n- 一扇门，人们可以从这里撤出房间，用 `D` 表示。\n\n已知门一定在房间的边界上，并且边界上不会有空地。\n\n最初，每块空地上都有一个人。疏散开始后，每块空地上就没有人数限制了（也就是说每块空地可以同时站无数个人）。\n\n在疏散的时候，每一秒钟每个人都可以向上 / 下 / 左 / 右四个方向移动一格，当然他也可以站着不动。\n\n由于门很窄，每一秒钟只能有一个人移动到门的位置，一旦移动到门的位置，就表示他已经安全撤离了。\n\n现在的问题是：如果希望所有的人安全撤离，最短需要多少时间？或者告知根本不可能。", "inputFormat": "输入文件第一行是由空格隔开的一对正整数 $N,M$（$3 \\le N,M \\le 20$）。\n\n下面 $N$ 行 $M$ 列是一个 $N\\times M$ 的字符矩阵（其中的元素可为字符 `.`、`X` 或 `D`，且字符间无空格），描述这个房间中每个格子的状态。", "outputFormat": "只有一个整数 $K$，表示让所有人安全撤离的最短时间。\n\n如果不可能让所有人安全撤离，那么输出 `impossible`。", "hint": "Update on 2015.1.12：新加数据一组。鸣谢：1756500824\n\n对于 C++ 语言，请使用 `scanf` 读入字符矩阵！", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2007] Emergency Evacuation (EVACUATE)", "background": "", "description": "A fire has broken out, and everyone must evacuate immediately.\n\nAssume the room is an $N \\times M$ rectangular area. Each cell is one of the following:\n- An empty cell, passable, denoted by `.`.\n- A wall, impassable, denoted by `X`.\n- A door, through which people can leave the room, denoted by `D`.\n\nDoors are guaranteed to be on the boundary of the room, and there is no empty cell on the boundary.\n\nInitially, each empty cell contains exactly one person. After the evacuation starts, there is no capacity limit per empty cell (that is, any number of people may stand on the same empty cell simultaneously).\n\nDuring the evacuation, in each second, each person may move one cell up, down, left, or right; they may also stay in place.\n\nBecause a door is narrow, in any one second at most one person can move onto a door cell. Once a person moves onto a door cell, they are considered safely evacuated.\n\nQuestion: if we want everyone to evacuate safely, what is the minimum time required? Or state that it is impossible.", "inputFormat": "The first line contains a pair of space-separated positive integers $N, M$ ($3 \\le N, M \\le 20$).\n\nThe next $N$ lines, each containing $M$ characters, form an $N \\times M$ character matrix (each character is one of `.`/`X`/`D`, with no spaces between characters), describing the state of every cell in the room.", "outputFormat": "Output a single integer $K$, the minimum time required for everyone to evacuate safely.\n\nIf it is impossible for everyone to evacuate safely, output `impossible`.", "hint": "Update on 2015.1.12: Added one new set of testdata. Thanks to: 1756500824.\n\nFor the C++ language, please use scanf to read the character matrix.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2007] 紧急疏散（EVACUATE）", "background": null, "description": "发生了火警，所有人员需要紧急疏散！\n\n假设这个房间是一个 $N \\times M$ 的矩形区域。每个格子有三个状态：\n\n- 一块空地，可以通行，用 `.` 表示。\n- 一面墙，不可以通行，用 `X` 表示。\n- 一扇门，人们可以从这里撤出房间，用 `D` 表示。\n\n已知门一定在房间的边界上，并且边界上不会有空地。\n\n最初，每块空地上都有一个人。疏散开始后，每块空地上就没有人数限制了（也就是说每块空地可以同时站无数个人）。\n\n在疏散的时候，每一秒钟每个人都可以向上 / 下 / 左 / 右四个方向移动一格，当然他也可以站着不动。\n\n由于门很窄，每一秒钟只能有一个人移动到门的位置，一旦移动到门的位置，就表示他已经安全撤离了。\n\n现在的问题是：如果希望所有的人安全撤离，最短需要多少时间？或者告知根本不可能。", "inputFormat": "输入文件第一行是由空格隔开的一对正整数 $N,M$（$3 \\le N,M \\le 20$）。\n\n下面 $N$ 行 $M$ 列是一个 $N\\times M$ 的字符矩阵（其中的元素可为字符 `.`、`X` 或 `D`，且字符间无空格），描述这个房间中每个格子的状态。", "outputFormat": "只有一个整数 $K$，表示让所有人安全撤离的最短时间。\n\n如果不可能让所有人安全撤离，那么输出 `impossible`。", "hint": "Update on 2015.1.12：新加数据一组。鸣谢：1756500824\n\n对于 C++ 语言，请使用 `scanf` 读入字符矩阵！", "locale": "zh-CN"}}}
{"pid": "P3192", "type": "P", "difficulty": 7, "samples": [["0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 2 0 0 0 0 0\n0 0 0 0 0 0 0 2 0 2 0 0 0 0 0\n0 0 0 0 0 0 2 1 1 2 0 0 0 0 0\n0 0 0 0 0 0 0 1 2 1 0 0 0 0 0\n0 0 0 0 0 0 2 1 1 1 1 2 0 0 0\n0 0 0 0 0 0 0 1 0 1 0 1 0 0 0\n0 0 0 0 0 0 2 2 0 1 1 0 2 0 0\n0 0 0 0 0 0 0 0 0 2 0 2 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0", "3 2\n10 9\n10 11"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2007", "各省省选", "湖南"], "title": "[HNOI2007] 胜负一子", "background": "", "description": "五子棋是一种流传很广的棋类游戏，在一个 $15\\times 15$ 的棋盘上，对弈双方执黑白棋子（类似于围棋），执黑子者先下，凡落下的棋子不能被提起，即不存在挪子和吃子的情况。\n\n为了简化问题，假设黑方不存在“禁手”，“禁手”是五子棋术语，指禁止走棋子的地方。当某选手的棋子在横、竖、$45$ 度斜线方向、$135$ 度斜线方向之一先出现相连的 $5$ 个棋子时，该选手获胜。\n\n先考虑轮到黑棋走的一盘残局，请给出黑棋获胜的最少步数和在该步数下能获胜的所有不同的下一步走法。", "inputFormat": "共有 $15$ 行，每行有 $15$ 个由一个空格隔开的整数。第 $i$ 行，第 $j$ 列的整数记做 $v_{i,j}$，用 $v_{i,j}=0,1,2$ 表示第 $i$ 行，第 $j$ 列的位置为空、为黑子、为白子，从左上角开始，按从左至右，自上而下的顺序输入，即输入的第 $1$ 行第 $1$ 列整数 $v_{1,1}$ 表示第 $1$ 行第 $1$ 列位置的状态，输入的第 $15$ 行第 $15$ 列整数 $v_{15,15}$ 表示第 $15$ 行第 $15$ 列位置的状态。", "outputFormat": "第一行为两个整数 $a$ 和 $b$，其中：$a$ 表示黑棋获胜的最少步数，$b$ 表示黑棋在 $a$ 步获胜的所有不同的下一步走法的种数。\n\n从第二行到第 $b+1$ 行，每行有两个整数，分别表示黑棋在 $a$ 步获胜的一种下一步走法落子位置的行数 $i$ 和列数 $j$，要求这些走法按照 $15\\times i+j$ 的大小从小到大排列。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2007] A Single Stone Decides the Game", "background": "", "description": "Gomoku is a widely played board game. On a $15\\times 15$ board, two players play with black and white stones (similar to Go). Black moves first. Once a stone is placed, it cannot be lifted; that is, there are no moving or capturing moves.\n\nTo simplify the problem, assume there are no “forbidden moves” for Black. “Forbidden moves” is a Gomoku term referring to places where a move is not allowed. When a player first forms a connected line of $5$ stones in one of the horizontal, vertical, $45$-degree diagonal, or $135$-degree diagonal directions, that player wins.\n\nConsider an endgame position with Black to move. Please output the minimum number of moves for Black to win and all distinct next moves that allow Black to win in that number of moves.", "inputFormat": "There are $15$ lines, each containing $15$ integers separated by a space. Let the integer in the $i$-th row and the $j$-th column be $v_{i,j}$. Use $v_{i,j}=0,1,2$ to indicate that the position at row $i$, column $j$ is empty, has a black stone, or has a white stone, respectively. Input is given from the top-left corner, in left-to-right and top-to-bottom order. That is, the first integer $v_{1,1}$ represents the state of row $1$, column $1$, and the last integer $v_{15,15}$ represents the state of row $15$, column $15$.", "outputFormat": "The first line contains two integers $a$ and $b$, where $a$ is the minimum number of moves for Black to win, and $b$ is the number of distinct next moves by which Black can win in $a$ moves.\n\nFrom the second line to the $(b+1)$-th line, each line contains two integers that represent a row $i$ and a column $j$ for one such next move by Black that leads to a win in $a$ moves. These moves must be sorted in ascending order by $15\\times i+j$.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2007] 胜负一子", "background": "", "description": "五子棋是一种流传很广的棋类游戏，在一个 $15\\times 15$ 的棋盘上，对弈双方执黑白棋子（类似于围棋），执黑子者先下，凡落下的棋子不能被提起，即不存在挪子和吃子的情况。\n\n为了简化问题，假设黑方不存在“禁手”，“禁手”是五子棋术语，指禁止走棋子的地方。当某选手的棋子在横、竖、$45$ 度斜线方向、$135$ 度斜线方向之一先出现相连的 $5$ 个棋子时，该选手获胜。\n\n先考虑轮到黑棋走的一盘残局，请给出黑棋获胜的最少步数和在该步数下能获胜的所有不同的下一步走法。", "inputFormat": "共有 $15$ 行，每行有 $15$ 个由一个空格隔开的整数。第 $i$ 行，第 $j$ 列的整数记做 $v_{i,j}$，用 $v_{i,j}=0,1,2$ 表示第 $i$ 行，第 $j$ 列的位置为空、为黑子、为白子，从左上角开始，按从左至右，自上而下的顺序输入，即输入的第 $1$ 行第 $1$ 列整数 $v_{1,1}$ 表示第 $1$ 行第 $1$ 列位置的状态，输入的第 $15$ 行第 $15$ 列整数 $v_{15,15}$ 表示第 $15$ 行第 $15$ 列位置的状态。", "outputFormat": "第一行为两个整数 $a$ 和 $b$，其中：$a$ 表示黑棋获胜的最少步数，$b$ 表示黑棋在 $a$ 步获胜的所有不同的下一步走法的种数。\n\n从第二行到第 $b+1$ 行，每行有两个整数，分别表示黑棋在 $a$ 步获胜的一种下一步走法落子位置的行数 $i$ 和列数 $j$，要求这些走法按照 $15\\times i+j$ 的大小从小到大排列。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3193", "type": "P", "difficulty": 5, "samples": [["4 3 100\n111", "81"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["递推", "2008", "各省省选", "湖南", "矩阵乘法", "KMP 算法"], "title": "[HNOI2008] GT考试", "background": "", "description": "阿申准备报名参加 GT 考试，准考证号为 $N$ 位数$X_1,X_2…X_n\\ (0\\le X_i\\le 9)$，他不希望准考证号上出现不吉利的数字。\n他的不吉利数字$A_1,A_2,\\cdots, A_m\\ (0\\le A_i\\le 9)$ 有 $M$ 位，不出现是指 $X_1,X_2\\cdots X_n$ 中没有一段恰好等于 $A_1,A_2,\\cdots ,A_m$，$A_1$ 和 $X_1$ 可以为 $0$。", "inputFormat": "第一行输入 $N,M,K$ 接下来一行输入 $M$ 位的数。", "outputFormat": "阿申想知道不出现不吉利数字的号码有多少种，输出模 $K$ 取余的结果。", "hint": "### 数据范围及约定\n\n对于全部数据，$N\\leq10^9$，$M\\leq 20$，$K\\leq10000$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2008] GT Exam", "background": "", "description": "Ashen is preparing to register for the GT Exam. His examinee number is an $N$-digit sequence $X_1,X_2…X_n\\ (0\\le X_i\\le 9)$, and he does not want any unlucky number to appear in it.\nHis unlucky number is an $M$-digit sequence $A_1,A_2,\\cdots, A_m\\ (0\\le A_i\\le 9)$. “Does not appear” means that in $X_1,X_2\\cdots X_n$ there is no contiguous segment exactly equal to $A_1,A_2,\\cdots ,A_m$. Both $A_1$ and $X_1$ may be $0$.", "inputFormat": "The first line contains $N,M,K$. The next line contains an $M$-digit number.", "outputFormat": "Ashen wants to know how many examinee numbers do not contain the unlucky number. Output the result modulo $K$.", "hint": "### Constraints\n\nFor all testdata, $N\\leq10^9$, $M\\leq 20$, $K\\leq10000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2008] GT考试", "background": "", "description": "阿申准备报名参加 GT 考试，准考证号为 $N$ 位数$X_1,X_2…X_n\\ (0\\le X_i\\le 9)$，他不希望准考证号上出现不吉利的数字。\n他的不吉利数字$A_1,A_2,\\cdots, A_m\\ (0\\le A_i\\le 9)$ 有 $M$ 位，不出现是指 $X_1,X_2\\cdots X_n$ 中没有一段恰好等于 $A_1,A_2,\\cdots ,A_m$，$A_1$ 和 $X_1$ 可以为 $0$。", "inputFormat": "第一行输入 $N,M,K$ 接下来一行输入 $M$ 位的数。", "outputFormat": "阿申想知道不出现不吉利数字的号码有多少种，输出模 $K$ 取余的结果。", "hint": "### 数据范围及约定\n\n对于全部数据，$N\\leq10^9$，$M\\leq 20$，$K\\leq10000$。", "locale": "zh-CN"}}}
{"pid": "P3194", "type": "P", "difficulty": 5, "samples": [["3\n-1 0\n1 0\n0 0", "1 2"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["计算几何", "2008", "各省省选", "湖南", "栈", "凸包"], "title": "[HNOI2008] 水平可见直线", "background": "", "description": "在 $x-y$ 直角坐标平面上有 $n$ 条直线 $L_1,L_2,…L_n$，若在 $y$ 值为正无穷大处往下看，能见到 $L_i$ 的某个子线段，则称 $L_i$ 为可见的，否则 $L_i$ 为被覆盖的。\n例如，对于直线:\n$L_1:y=x$;\n$L_2:y=-x$;\n$L_3:y=0$;\n则 $L_1$ 和 $L_2$ 是可见的，$L_3$ 是被覆盖的。给出 $n$ 条直线，表示成 $y=Ax+B$ 的形式($|A|,|B| \\le 500000$)，且 $n$ 条直线两两不重合，求出所有可见的直线。", "inputFormat": "第一行为 $N$ ($0<N\\leq50000$)，接下来的 $N$ 行输入 $A_i,B_i$", "outputFormat": "从小到大输出可见直线的编号，两两中间用空格隔开，最后一个数字后面也必须有个空格。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2008] Horizontally Visible Lines", "background": "", "description": "On the $x-y$ Cartesian coordinate plane, there are $n$ lines $L_1, L_2, \\dots, L_n$. If, when looking downward from $y = +\\infty$, some subsegment of $L_i$ is visible, we say that $L_i$ is visible; otherwise, $L_i$ is covered.\nFor example, for the lines:\n$L_1: y = x$;\n$L_2: y = -x$;\n$L_3: y = 0$;\nthen $L_1$ and $L_2$ are visible, and $L_3$ is covered. Given $n$ lines in the form $y = A x + B$ ($|A|, |B| \\le 500000$), and no two lines coincide, find all visible lines.", "inputFormat": "The first line contains $N$ ($0 < N < 50000$). The next $N$ lines each contain $A_i, B_i$.", "outputFormat": "Output the indices of the visible lines in increasing order, separated by spaces. There must also be a space after the last number.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2008] 水平可见直线", "background": "", "description": "在 $x-y$ 直角坐标平面上有 $n$ 条直线 $L_1,L_2,…L_n$，若在 $y$ 值为正无穷大处往下看，能见到 $L_i$ 的某个子线段，则称 $L_i$ 为可见的，否则 $L_i$ 为被覆盖的。\n例如，对于直线:\n$L_1:y=x$;\n$L_2:y=-x$;\n$L_3:y=0$;\n则 $L_1$ 和 $L_2$ 是可见的，$L_3$ 是被覆盖的。给出 $n$ 条直线，表示成 $y=Ax+B$ 的形式($|A|,|B| \\le 500000$)，且 $n$ 条直线两两不重合，求出所有可见的直线。", "inputFormat": "第一行为 $N$ ($0<N\\leq50000$)，接下来的 $N$ 行输入 $A_i,B_i$", "outputFormat": "从小到大输出可见直线的编号，两两中间用空格隔开，最后一个数字后面也必须有个空格。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3195", "type": "P", "difficulty": 6, "samples": [["5 4\n3\n4\n2\n1\n4", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2008", "各省省选", "单调队列", "湖南", "斜率优化"], "title": "[HNOI2008] 玩具装箱", "background": null, "description": "P 教授要去看奥运，但是他舍不下他的玩具，于是他决定把所有的玩具运到北京。他使用自己的压缩器进行压缩，其可以将任意物品变成一维，再放到一种特殊的一维容器中。\n\nP 教授有编号为 $1 \\cdots n$ 的 $n$ 件玩具，第 $i$ 件玩具经过压缩后的一维长度为 $C_i$。\n\n为了方便整理，P 教授要求：\n\n- 在一个一维容器中的玩具编号是连续的。\n\n- 同时如果一个一维容器中有多个玩具，那么两件玩具之间要加入一个单位长度的填充物。形式地说，如果将第 $i$ 件玩具到第 $j$ 个玩具放到一个容器中，那么容器的长度将为 $x=j-i+\\sum\\limits_{k=i}^{j}C_k$。\n\n制作容器的费用与容器的长度有关，根据教授研究，如果容器长度为 $x$，其制作费用为 $(x-L)^2$。其中 $L$ 是一个常量。P 教授不关心容器的数目，他可以制作出任意长度的容器，甚至超过 $L$。但他希望所有容器的总费用最小。", "inputFormat": "第一行有两个整数，用一个空格隔开，分别代表 $n$ 和 $L$。\n\n第 $2$ 到 第 $(n + 1)$ 行，每行一个整数，第 $(i + 1)$ 行的整数代表第 $i$ 件玩具的长度 $C_i$。", "outputFormat": "输出一行一个整数，代表所有容器的总费用最小是多少。", "hint": "对于全部的测试点，$1 \\leq n \\leq 5 \\times 10^4$，$1 \\leq L \\leq 10^7$，$1 \\leq C_i \\leq 10^7$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2008] Toy Packing", "background": "", "description": "Professor P is going to watch the Olympics, but he cannot part with his toys, so he decides to ship all his toys to Beijing. He uses his own compressor, which can compress any item into a lump and then place it into a special one-dimensional container.\n\nProfessor P has $n$ toys numbered $1 \\cdots n$. After compression, the one-dimensional length of the $i$-th toy is $C_i$.\n\nTo organize them conveniently, Professor P requires:\n- The toy indices in a one-dimensional container must be consecutive.\n- Additionally, if a container holds more than one toy, a unit-length filler must be added between any two adjacent toys. Formally, if toys $i$ through $j$ are placed in one container, the container length is $x=j-i+\\sum\\limits_{k=i}^{j}C_k$.\n\nThe manufacturing cost of a container depends on its length. According to the professor’s study, if a container has length $x$, its cost is $(x-L)^2$, where $L$ is a constant. Professor P does not care about the number of containers; he can make containers of any length, even exceeding $L$. He wants the total cost of all containers to be minimized.", "inputFormat": "The first line contains two integers separated by a space, denoting $n$ and $L$.\n\nLines $2$ to $(n + 1)$ each contain one integer. Line $(i + 1)$ contains the length $C_i$ of the $i$-th toy.", "outputFormat": "Output a single integer on one line, the minimum possible total cost of all containers.", "hint": "For all test points, $1 \\leq n \\leq 5 \\times 10^4$, $1 \\leq L \\leq 10^7$, $1 \\leq C_i \\leq 10^7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2008] 玩具装箱", "background": null, "description": "P 教授要去看奥运，但是他舍不下他的玩具，于是他决定把所有的玩具运到北京。他使用自己的压缩器进行压缩，其可以将任意物品变成一维，再放到一种特殊的一维容器中。\n\nP 教授有编号为 $1 \\cdots n$ 的 $n$ 件玩具，第 $i$ 件玩具经过压缩后的一维长度为 $C_i$。\n\n为了方便整理，P 教授要求：\n\n- 在一个一维容器中的玩具编号是连续的。\n\n- 同时如果一个一维容器中有多个玩具，那么两件玩具之间要加入一个单位长度的填充物。形式地说，如果将第 $i$ 件玩具到第 $j$ 个玩具放到一个容器中，那么容器的长度将为 $x=j-i+\\sum\\limits_{k=i}^{j}C_k$。\n\n制作容器的费用与容器的长度有关，根据教授研究，如果容器长度为 $x$，其制作费用为 $(x-L)^2$。其中 $L$ 是一个常量。P 教授不关心容器的数目，他可以制作出任意长度的容器，甚至超过 $L$。但他希望所有容器的总费用最小。", "inputFormat": "第一行有两个整数，用一个空格隔开，分别代表 $n$ 和 $L$。\n\n第 $2$ 到 第 $(n + 1)$ 行，每行一个整数，第 $(i + 1)$ 行的整数代表第 $i$ 件玩具的长度 $C_i$。", "outputFormat": "输出一行一个整数，代表所有容器的总费用最小是多少。", "hint": "对于全部的测试点，$1 \\leq n \\leq 5 \\times 10^4$，$1 \\leq L \\leq 10^7$，$1 \\leq C_i \\leq 10^7$。", "locale": "zh-CN"}}}
{"pid": "P3196", "type": "P", "difficulty": 6, "samples": [["4 5\n1 2\n1 4\n2 4\n2 3\n3 4", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2008", "各省省选", "湖南", "广度优先搜索 BFS", "哈希 hashing", "弦图"], "title": "[HNOI2008] 神奇的国度", "background": "", "description": "K国是一个热衷三角形的国度,连人的交往也只喜欢三角原则.他们认为三角关系:即AB相互认识,BC相互认识,CA相互认识,是简洁高效的.为了巩固三角关系,K国禁止四边关系,五边关系等等的存在.\n\n所谓N边关系,是指N个人 A1A2...An之间仅存在N对认识关系:(A1A2)(A2A3)...(AnA1),而没有其它认识关系.比如四边关系指ABCD四个人 AB,BC,CD,DA相互认识,而AC,BD不认识.全民比赛时,为了防止做弊，规定任意一对相互认识的人不得在一队，国王相知道，最少可以分多少支队。\n", "inputFormat": "第一行两个整数N，M。1<=N<=10000,1<=M<=1000000.表示有N个人，M对认识关系. 接下来M行每行输入一对朋友\n", "outputFormat": "输出一个整数，最少可以分多少队\n", "hint": "一种方案(1,3)(2)(4)\n", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2008] A Magical Country", "background": "", "description": "Country K is obsessed with triangles; even interpersonal relationships follow a triangle principle. They consider a triangle relationship—namely, $A B$, $B C$, and $C A$ are mutually acquainted—to be simple and efficient. To reinforce triangle relationships, Country K forbids the existence of four-cycle relationships, five-cycle relationships, and so on.\n\nAn $N$-cycle relationship means that among $N$ people $A_1, A_2, \\ldots, A_n$, there exist exactly $N$ acquaintance pairs: $(A_1, A_2)$, $(A_2, A_3)$, $\\ldots$, $(A_n, A_1)$, and no other acquaintance pairs among them. For example, a four-cycle relationship means that among $A, B, C, D$, the pairs $(A, B)$, $(B, C)$, $(C, D)$, $(D, A)$ are mutually acquainted, while $(A, C)$ and $(B, D)$ are not acquainted.\n\nDuring a national contest, to prevent cheating, it is required that any two people who are acquainted must not be placed on the same team. The king wants to know the minimum number of teams needed.", "inputFormat": "The first line contains two integers $N$ and $M$ ($1 \\le N \\le 10000$, $1 \\le M \\le 1000000$), indicating there are $N$ people and $M$ acquaintance pairs. The next $M$ lines each contain one pair of friends.", "outputFormat": "Output a single integer: the minimum number of teams.", "hint": "One possible arrangement: (1, 3) (2) (4).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2008] 神奇的国度", "background": "", "description": "K国是一个热衷三角形的国度,连人的交往也只喜欢三角原则.他们认为三角关系:即AB相互认识,BC相互认识,CA相互认识,是简洁高效的.为了巩固三角关系,K国禁止四边关系,五边关系等等的存在.\n\n所谓N边关系,是指N个人 A1A2...An之间仅存在N对认识关系:(A1A2)(A2A3)...(AnA1),而没有其它认识关系.比如四边关系指ABCD四个人 AB,BC,CD,DA相互认识,而AC,BD不认识.全民比赛时,为了防止做弊，规定任意一对相互认识的人不得在一队，国王相知道，最少可以分多少支队。\n", "inputFormat": "第一行两个整数N，M。1<=N<=10000,1<=M<=1000000.表示有N个人，M对认识关系. 接下来M行每行输入一对朋友\n", "outputFormat": "输出一个整数，最少可以分多少队\n", "hint": "一种方案(1,3)(2)(4)\n", "locale": "zh-CN"}}}
{"pid": "P3197", "type": "P", "difficulty": 3, "samples": [["2 3\n", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2008", "各省省选", "湖南", "O2优化", "组合数学", "容斥原理"], "title": "[HNOI2008] 越狱", "background": "", "description": "监狱有 $n$ 个房间，每个房间关押一个犯人，有 $m$ 种宗教，每个犯人会信仰其中一种。如果相邻房间的犯人的宗教相同，就可能发生越狱，求有多少种状态可能发生越狱。\n\n答案对 $100,003$ 取模。", "inputFormat": "输入只有一行两个整数，分别代表宗教数 $m$ 和房间数 $n$。", "outputFormat": "输出一行一个整数代表答案。", "hint": "#### 样例输入输出 1 解释\n\n| 状态编号 | 1 号房间 | 2 号房间 | 3 号房间 |\n| :--------: | :--------: | :-------: | :--------: |\n| 1 | 信仰 1 | 信仰 1 | 信仰 1 |\n| 2 | 信仰 1 | 信仰 1 | 信仰 2 |\n| 3 | 信仰 1 | 信仰 2 | 信仰 2 |\n| 4 | 信仰 2 | 信仰 1 | 信仰 1 |\n| 5 | 信仰 2 | 信仰 2 | 信仰 2 |\n| 6 | 信仰 2 | 信仰 2 | 信仰 1 |\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1 \\le m \\le 10^8$，$1 \\le n \\le 10^{12}$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2008] Prison Break", "background": "", "description": "There are $n$ rooms in the prison, with one prisoner in each room. There are $m$ religions, and each prisoner believes in exactly one of them. If prisoners in adjacent rooms have the same religion, a prison break may occur. Count how many states may lead to a prison break.\n\nOutput the answer modulo $100{,}003$.", "inputFormat": "The input contains a single line with two integers, the number of religions $m$ and the number of rooms $n$.", "outputFormat": "Output a single integer on one line representing the answer.", "hint": "#### Sample Input/Output 1 Explanation\n\n| State ID | Room 1 | Room 2 | Room 3 |\n| :--------: | :--------: | :-------: | :--------: |\n| 1 | Religion 1 | Religion 1 | Religion 1 |\n| 2 | Religion 1 | Religion 1 | Religion 2 |\n| 3 | Religion 1 | Religion 2 | Religion 2 |\n| 4 | Religion 2 | Religion 1 | Religion 1 |\n| 5 | Religion 2 | Religion 2 | Religion 2 |\n| 6 | Religion 2 | Religion 2 | Religion 1 |\n\n#### Constraints\n\nFor $100\\%$ of the testdata, it is guaranteed that $1 \\le m \\le 10^8$, $1 \\le n \\le 10^{12}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2008] 越狱", "background": "", "description": "监狱有 $n$ 个房间，每个房间关押一个犯人，有 $m$ 种宗教，每个犯人会信仰其中一种。如果相邻房间的犯人的宗教相同，就可能发生越狱，求有多少种状态可能发生越狱。\n\n答案对 $100,003$ 取模。", "inputFormat": "输入只有一行两个整数，分别代表宗教数 $m$ 和房间数 $n$。", "outputFormat": "输出一行一个整数代表答案。", "hint": "#### 样例输入输出 1 解释\n\n| 状态编号 | 1 号房间 | 2 号房间 | 3 号房间 |\n| :--------: | :--------: | :-------: | :--------: |\n| 1 | 信仰 1 | 信仰 1 | 信仰 1 |\n| 2 | 信仰 1 | 信仰 1 | 信仰 2 |\n| 3 | 信仰 1 | 信仰 2 | 信仰 2 |\n| 4 | 信仰 2 | 信仰 1 | 信仰 1 |\n| 5 | 信仰 2 | 信仰 2 | 信仰 2 |\n| 6 | 信仰 2 | 信仰 2 | 信仰 1 |\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1 \\le m \\le 10^8$，$1 \\le n \\le 10^{12}$。", "locale": "zh-CN"}}}
{"pid": "P3198", "type": "P", "difficulty": 6, "samples": [["5 0.3\n3\n5\n6\n2\n4", "0.000000\n0.000000\n0.000000\n1.968750\n2.976000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2008", "各省省选", "湖南", "Special Judge"], "title": "[HNOI2008] 遥远的行星", "background": null, "description": "直线上 $N$ 颗行星，$X=i$ 处有行星 $i$，行星 $J$ 受到行星 $I$ 的作用力，当且仅当 $i \\le A J$，此时 $J$ 受到作用力的大小为$F_{i->j}=\\frac{M_i \\times M_j}{j-i}$。\n\n其中 $A$ 为很小的常量，故直观上说每颗行星都只受到距离遥远的行星的作用。\n请计算每颗行星的受力，只要结果的相对误差不超过 5% 即可.", "inputFormat": "第一行两个整数 $N$ 和 $A$。  \n接下来 $N$ 行输入 $N$ 个行星的质量 $M_i$", "outputFormat": "$N$ 行，依次输出各行星的受力情况", "hint": "$1 \\le N \\le 10^5$  \n$0.01 < A \\le 0.35$  \n$0 \\le M_i \\le 10^7$", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2008] Distant Planets", "background": "", "description": "There are $N$ planets on a line; planet $i$ is located at position $X = i$. Planet $J$ is affected by the force from planet $I$ if and only if $i \\le A J$. In this case, the magnitude of the force on $J$ is $F_{i->j}=\\frac{M_i \\times M_j}{j-i}$.\n\nHere $A$ is a very small constant, so intuitively each planet is only affected by planets that are far away. Compute the force on each planet. The answer is accepted if the relative error does not exceed 5%.", "inputFormat": "The first line contains an integer $N$ and a real number $A$.  \nThe next $N$ lines contain the masses $M_i$ of the $N$ planets.", "outputFormat": "Output $N$ lines, the force on each planet in order.", "hint": "$1 \\le N \\le 10^5$.  \n$0.01 < A \\le 0.35$.  \n$0 \\le M_i \\le 10^7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2008] 遥远的行星", "background": null, "description": "直线上 $N$ 颗行星，$X=i$ 处有行星 $i$，行星 $J$ 受到行星 $I$ 的作用力，当且仅当 $i \\le A J$，此时 $J$ 受到作用力的大小为$F_{i->j}=\\frac{M_i \\times M_j}{j-i}$。\n\n其中 $A$ 为很小的常量，故直观上说每颗行星都只受到距离遥远的行星的作用。\n请计算每颗行星的受力，只要结果的相对误差不超过 5% 即可.", "inputFormat": "第一行两个整数 $N$ 和 $A$。  \n接下来 $N$ 行输入 $N$ 个行星的质量 $M_i$", "outputFormat": "$N$ 行，依次输出各行星的受力情况", "hint": "$1 \\le N \\le 10^5$  \n$0.01 < A \\le 0.35$  \n$0 \\le M_i \\le 10^7$", "locale": "zh-CN"}}}
{"pid": "P3199", "type": "P", "difficulty": 5, "samples": [["4 5\n1 2 5\n2 3 5\n3 1 5\n2 4 3\n4 1 3", "3.66666667"], ["2 2\n1 2 -2.9\n2 1 -3.1", "-3.00000000"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2009", "各省省选", "湖南", "深度优先搜索 DFS", "分数规划"], "title": "[HNOI2009] 最小圈", "background": "", "description": "考虑带权有向图 $G=(V,E)$ 以及 $w:E\\rightarrow \\R$，每条边 $e=(i,j)$（$i\\neq j$，$i, j\\in V$）的权值定义为 $w_{i,j}$。设 $n=|V|$。\n\n$c=(c_1,c_2,\\cdots,c_k)$（$c_i\\in V$）是 $G$ 中的一个圈当且仅当 $(c_i,c_{i+1})$（$1\\le i<k$）和 $(c_k,c_1)$ 都在 $E$ 中。称 $k$ 为圈 $c$ 的长度，同时记 $c_{k+1}=c_1$，并定义圈 $c=(c_1,c_2,\\cdots,c_k)$ 的平均值为\n$$\n\\mu(c)= \\frac 1 k \\sum\\limits_{i=1}^{k} w_{c_i,c_{i+1}}\n$$\n即 $c$ 上所有边的权值的平均值。设 $\\mu'(G)=\\min_c\\mu(c)$ 为 $G$ 中所有圈 $c$ 的平均值的最小值。\n\n给定图 $G=(V,E)$ 以及 $w:E\\rightarrow \\R$，求出 $G$ 中所有圈 $c$ 的平均值的最小值 $\\mu'(G)$。\n", "inputFormat": "第一行两个正整数，分别为 $n$ 和 $m$，并用一个空格隔开。其中 $n=|V|$，$m=|E|$ 分别表示图中有 $n$ 个点 和 $m$ 条边。\n\n接下来 $m$ 行，每行三个数 $i,j,w_{i,j}$，表示有一条边 $(i,j)$ 且该边的权值为 $w_{i,j}$，注意边权可以是实数。输入数据保证图 $G=(V,E)$ 连通，存在圈且有一个点能到达其他所有点。\n", "outputFormat": "一个实数 $\\mu'(G)$，要求精确到小数点后 $8$ 位。\n", "hint": "对于 $100\\%$ 的数据，$2\\leq n\\le 3000$，$1\\leq m\\le 10000$，$|w_{i,j}| \\le 10^7$，$1\\leq i, j\\leq n$ 且 $i\\neq j$。\n\n------------\n提示：本题存在 $O(nm)$ 的做法，但是 $O(nm\\log n)$ 的做法也可以通过。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2009] Minimum Mean Cycle", "background": "", "description": "Consider a weighted directed graph $G=(V,E)$ and $w: E \\rightarrow \\mathbb{R}$. Each edge $e=(i,j)$ ($i \\neq j$, $i, j \\in V$) has weight $w_{i,j}$. Let $n = |V|$.\n\nA sequence $c=(c_1, c_2, \\cdots, c_k)$ ($c_i \\in V$) is a cycle in $G$ if and only if $(c_i, c_{i+1})$ ($1 \\le i < k$) and $(c_k, c_1)$ are both in $E$. We call $k$ the length of cycle $c$, and set $c_{k+1} = c_1$. The average value of cycle $c=(c_1, c_2, \\cdots, c_k)$ is defined as\n$$\n\\mu(c)= \\frac 1 k \\sum\\limits_{i=1}^{k} w_{c_i,c_{i+1}}.\n$$\nLet $\\mu'(G)=\\min_c \\mu(c)$ be the minimum average value over all cycles $c$ in $G$.\n\nGiven $G=(V,E)$ and $w: E \\rightarrow \\mathbb{R}$, compute the minimum average value $\\mu'(G)$ over all cycles $c$ in $G$.", "inputFormat": "The first line contains two positive integers $n$ and $m$, separated by a space. Here $n = |V|$ and $m = |E|$ denote the number of vertices and edges, respectively.\n\nThe next $m$ lines each contain three numbers $i, j, w_{i,j}$, indicating there is an edge $(i, j)$ with weight $w_{i,j}$. Note that edge weights can be real numbers. The input guarantees that the graph $G=(V,E)$ is connected, contains at least one cycle, and there exists a vertex that can reach all other vertices.", "outputFormat": "Output a real number $\\mu'(G)$, printed with $8$ digits after the decimal point.", "hint": "- Constraints: For $100\\%$ of the testdata, $2 \\le n \\le 3000$, $1 \\le m \\le 10000$, $|w_{i,j}| \\le 10^7$, $1 \\le i, j \\le n$ and $i \\neq j$.\n- Note: There exists an $O(nm)$ solution; an $O(nm \\log n)$ solution also passes.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2009] 最小圈", "background": "", "description": "考虑带权有向图 $G=(V,E)$ 以及 $w:E\\rightarrow \\R$，每条边 $e=(i,j)$（$i\\neq j$，$i, j\\in V$）的权值定义为 $w_{i,j}$。设 $n=|V|$。\n\n$c=(c_1,c_2,\\cdots,c_k)$（$c_i\\in V$）是 $G$ 中的一个圈当且仅当 $(c_i,c_{i+1})$（$1\\le i<k$）和 $(c_k,c_1)$ 都在 $E$ 中。称 $k$ 为圈 $c$ 的长度，同时记 $c_{k+1}=c_1$，并定义圈 $c=(c_1,c_2,\\cdots,c_k)$ 的平均值为\n$$\n\\mu(c)= \\frac 1 k \\sum\\limits_{i=1}^{k} w_{c_i,c_{i+1}}\n$$\n即 $c$ 上所有边的权值的平均值。设 $\\mu'(G)=\\min_c\\mu(c)$ 为 $G$ 中所有圈 $c$ 的平均值的最小值。\n\n给定图 $G=(V,E)$ 以及 $w:E\\rightarrow \\R$，求出 $G$ 中所有圈 $c$ 的平均值的最小值 $\\mu'(G)$。\n", "inputFormat": "第一行两个正整数，分别为 $n$ 和 $m$，并用一个空格隔开。其中 $n=|V|$，$m=|E|$ 分别表示图中有 $n$ 个点 和 $m$ 条边。\n\n接下来 $m$ 行，每行三个数 $i,j,w_{i,j}$，表示有一条边 $(i,j)$ 且该边的权值为 $w_{i,j}$，注意边权可以是实数。输入数据保证图 $G=(V,E)$ 连通，存在圈且有一个点能到达其他所有点。\n", "outputFormat": "一个实数 $\\mu'(G)$，要求精确到小数点后 $8$ 位。\n", "hint": "对于 $100\\%$ 的数据，$2\\leq n\\le 3000$，$1\\leq m\\le 10000$，$|w_{i,j}| \\le 10^7$，$1\\leq i, j\\leq n$ 且 $i\\neq j$。\n\n------------\n提示：本题存在 $O(nm)$ 的做法，但是 $O(nm\\log n)$ 的做法也可以通过。", "locale": "zh-CN"}}}
{"pid": "P3200", "type": "P", "difficulty": 4, "samples": [["3 10", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2009", "各省省选", "湖南", "素数判断,质数,筛法", "Catalan 数", "栈"], "title": "[HNOI2009] 有趣的数列", "background": null, "description": "我们称一个长度为 $2n$ 的数列是有趣的，当且仅当该数列满足以下三个条件：\n\n- 它是从 $1 \\sim 2n$ 共 $2n$ 个整数的一个排列 $\\{a_n\\}_{n=1}^{2n}$；\n\n- 所有的奇数项满足 $a_1<a_3< \\dots < a_{2n-1}$，所有的偶数项满足 $a_2<a_4< \\dots <a_{2n}$；\n\n- 任意相邻的两项 $a_{2i-1}$ 与 $a_{2i}$ 满足：$a_{2i-1}<a_{2i}$。\n\n对于给定的 $n$，请求出有多少个不同的长度为 $2n$ 的有趣的数列。  \n因为最后的答案可能很大，所以只要求输出答案对 $p$ 取模。", "inputFormat": "一行两个正整数 $n,p$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "【数据范围】   \n对于 $50\\%$ 的数据，$1\\le n \\le 1000$；  \n对于 $100\\%$ 的数据，$1\\le n \\le 10^6$，$1\\le p \\le 10^9$。\n\n【样例解释】   \n对应的 $5$ 个有趣的数列分别为$(1,2,3,4,5,6),(1,2,3,5,4,6),(1,3,2,4,5,6),(1,3,2,5,4,6),(1,4,2,5,3,6)$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2009] Interesting Sequence", "background": "", "description": "We call a sequence of length $2n$ interesting if and only if it satisfies the following three conditions:\n- It is a permutation of the $2n$ integers from $1$ to $2n$, written as $a_1, a_2, \\dots, a_{2n}$.\n- All odd-indexed terms satisfy $a_1 < a_3 < \\dots < a_{2n-1}$, and all even-indexed terms satisfy $a_2 < a_4 < \\dots < a_{2n}$.\n- For every adjacent pair $a_{2i-1}$ and $a_{2i}$, it holds that $a_{2i-1} < a_{2i}$.\n\nFor a given $n$, find the number of different interesting sequences of length $2n$. Since the answer can be large, output the answer modulo $p$.", "inputFormat": "One line with two positive integers $n, p$.", "outputFormat": "Output a single integer on one line, the answer.", "hint": "Constraints  \nFor $50\\%$ of the testdata, $1 \\le n \\le 1000$.  \nFor $100\\%$ of the testdata, $1 \\le n \\le 10^6$, $1 \\le p \\le 10^9$.\n\nSample explanation  \nThe $5$ interesting sequences are (1, 2, 3, 4, 5, 6), (1, 2, 3, 5, 4, 6), (1, 3, 2, 4, 5, 6), (1, 3, 2, 5, 4, 6), (1, 4, 2, 5, 3, 6).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2009] 有趣的数列", "background": null, "description": "我们称一个长度为 $2n$ 的数列是有趣的，当且仅当该数列满足以下三个条件：\n\n- 它是从 $1 \\sim 2n$ 共 $2n$ 个整数的一个排列 $\\{a_n\\}_{n=1}^{2n}$；\n\n- 所有的奇数项满足 $a_1<a_3< \\dots < a_{2n-1}$，所有的偶数项满足 $a_2<a_4< \\dots <a_{2n}$；\n\n- 任意相邻的两项 $a_{2i-1}$ 与 $a_{2i}$ 满足：$a_{2i-1}<a_{2i}$。\n\n对于给定的 $n$，请求出有多少个不同的长度为 $2n$ 的有趣的数列。  \n因为最后的答案可能很大，所以只要求输出答案对 $p$ 取模。", "inputFormat": "一行两个正整数 $n,p$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "【数据范围】   \n对于 $50\\%$ 的数据，$1\\le n \\le 1000$；  \n对于 $100\\%$ 的数据，$1\\le n \\le 10^6$，$1\\le p \\le 10^9$。\n\n【样例解释】   \n对应的 $5$ 个有趣的数列分别为$(1,2,3,4,5,6),(1,2,3,5,4,6),(1,3,2,4,5,6),(1,3,2,5,4,6),(1,4,2,5,3,6)$。", "locale": "zh-CN"}}}
{"pid": "P3201", "type": "P", "difficulty": 5, "samples": [["4 3\n1 2 2 1\n2\n1 2 1\n2\n", "3\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2009", "线段树", "各省省选", "平衡树", "湖南", "枚举", "线段树合并", "启发式合并"], "title": "[HNOI2009] 梦幻布丁", "background": "", "description": "$n$ 个布丁摆成一行，进行 $m$ 次操作。每次将某个颜色的布丁全部变成另一种颜色的，然后再询问当前一共有多少段颜色。\n\n例如，颜色分别为 $1,2,2,1$ 的四个布丁一共有 $3$ 段颜色.", "inputFormat": "第一行是两个整数，分别表示布丁个数 $n$ 和操作次数 $m$。  \n第二行有 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个布丁的颜色 $a_i$。  \n接下来 $m$ 行，每行描述一次操作。每行首先有一个整数 $op$ 表示操作类型：\n- 若 $op = 1$，则后有两个整数 $x, y$，表示将颜色 $x$ 的布丁全部变成颜色 $y$。\n- 若 $op = 2$，则表示一次询问。", "outputFormat": "对于每次询问，输出一行一个整数表示答案。", "hint": "### 样例 1 解释\n初始时布丁颜色依次为 $1, 2, 2, 1$，三段颜色分别为 $[1, 1], [2, 3], [4, 4]$。  \n一次操作后，布丁的颜色变为 $1, 1, 1, 1$，只有 $[1, 4]$ 一段颜色。\n\n### 数据规模与约定\n\n对于全部的测试点，保证 $1 \\leq n, m \\leq 10^5$，$1 \\leq a_i ,x, y \\leq 10^6$。\n\n### 提示\n\n请注意，**不保证**颜色的编号不大于 $n$，也**不保证** $x \\neq y$，$m$ **不是**颜色的编号上限。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2009] Dream Pudding", "background": "", "description": "There are $n$ puddings in a line, and we will perform $m$ operations. An operation may recolor all puddings of one color into another color, or ask how many color segments there are at the moment.\n\nFor example, four puddings with colors $1, 2, 2, 1$ have $3$ color segments.", "inputFormat": "The first line contains two integers, the number of puddings $n$ and the number of operations $m$.  \nThe second line contains $n$ integers; the $i$-th integer is the color $a_i$ of the $i$-th pudding.  \nThen there are $m$ lines, each describing one operation. Each line starts with an integer $op$ indicating the type:\n- If $op = 1$, then two integers $x, y$ follow, meaning recolor all puddings of color $x$ to color $y$.\n- If $op = 2$, it denotes a query.", "outputFormat": "For each query, output one integer on a single line, indicating the answer.", "hint": "Sample 1 Explanation  \nInitially the colors are $1, 2, 2, 1$, and the three color segments are $[1, 1], [2, 3], [4, 4]$.  \nAfter one operation, the colors become $1, 1, 1, 1$, leaving only one segment $[1, 4]$.\n\nConstraints  \nFor all test points, it is guaranteed that $1 \\leq n, m \\leq 10^5$, $1 \\leq a_i, x, y \\leq 10^6$.\n\nNotes  \nPlease note that it is **not guaranteed** that color IDs are at most $n$, it is also **not guaranteed** that $x \\neq y$, and $m$ is **not** an upper bound on color IDs.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2009] 梦幻布丁", "background": "", "description": "$n$ 个布丁摆成一行，进行 $m$ 次操作。每次将某个颜色的布丁全部变成另一种颜色的，然后再询问当前一共有多少段颜色。\n\n例如，颜色分别为 $1,2,2,1$ 的四个布丁一共有 $3$ 段颜色.", "inputFormat": "第一行是两个整数，分别表示布丁个数 $n$ 和操作次数 $m$。  \n第二行有 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个布丁的颜色 $a_i$。  \n接下来 $m$ 行，每行描述一次操作。每行首先有一个整数 $op$ 表示操作类型：\n- 若 $op = 1$，则后有两个整数 $x, y$，表示将颜色 $x$ 的布丁全部变成颜色 $y$。\n- 若 $op = 2$，则表示一次询问。", "outputFormat": "对于每次询问，输出一行一个整数表示答案。", "hint": "### 样例 1 解释\n初始时布丁颜色依次为 $1, 2, 2, 1$，三段颜色分别为 $[1, 1], [2, 3], [4, 4]$。  \n一次操作后，布丁的颜色变为 $1, 1, 1, 1$，只有 $[1, 4]$ 一段颜色。\n\n### 数据规模与约定\n\n对于全部的测试点，保证 $1 \\leq n, m \\leq 10^5$，$1 \\leq a_i ,x, y \\leq 10^6$。\n\n### 提示\n\n请注意，**不保证**颜色的编号不大于 $n$，也**不保证** $x \\neq y$，$m$ **不是**颜色的编号上限。", "locale": "zh-CN"}}}
{"pid": "P3202", "type": "P", "difficulty": 6, "samples": [["3\n10 2\n4 5 10 6 6 9 4 7 9 8\n3 1\n6 4 0\n4 2\n3 0 6 3", "6\nimpossible\n4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2009", "各省省选", "湖南"], "title": "[HNOI2009] 通往城堡之路", "background": null, "description": "听说公主被关押在城堡里，彭大侠下定决心：不管一路上有多少坎坷，不管城堡中的看守有多少厉害，不管救了公主之后公主会不会再被抓走，不管公主是否漂亮、是否会钟情于自己，他将义无反顾地朝着城堡前进。\n\n可是，通往城堡的路上出现了一些情况。抽象地说，假象地图在二维平面的第一象限。在每个横轴的 $x$ 位置上有一个高为 $h_x$ 的支撑点，如果彭大侠没有跳到支撑点上，那么他就会掉下去，牺牲在路途。\n\n开始时彭大侠在起点 $(1,h_1)$ 处，而城堡的入口在 $(n,h_n)$ 处。彭大侠每次可以从支撑点 $(x,h_x)$ 跳到支撑点 $(x+1,h_{x+1})$。但是彭大侠每次的跳跃能量只有 $d$，也就是说，每次跳跃必须满足条件 $|h_{x+1}-h_x| \\le d$。换句话说，如果两个相邻支撑点的纵向落差大于 $d$，那么彭大侠就无法跳跃了！幸运的是，彭大侠还有一个杀手锏。\n\n在起点处，他可以花一个金币，把某个支撑点升高 $1$ 个单位，或者降低 $1$ 个单位。但是，起点处和城堡入口处的支撑点高度不能改变，并且一旦离开起点彭大侠就无法使用该杀手锏。\n\n彭大侠被告知 $100$ 个金币可兑换一单位生命。于是他希望通过少花金币来保存更多单位的生命。\n\n他终于找到了你这位热心的高手，请你帮他规划一下以便耗费尽量少的金币来到达城堡。", "inputFormat": "文件第一行包含一个整数 $m(m \\le 5)$，表示问题求解次数。接下来的 $2m$ 行依次表示每次求解的输入数据块。每个输入数据块占 $2$ 行，其中第一行包含两个整数 $n$ 和 $d$，分别表示从起点到城堡入口处必须经过的支撑点数和每次跳跃允许的最大纵向落差，$n$ 和 $d$ 之间用空格隔开，输入数据保证 $2 \\le n \\le 5000，0 \\le d \\le 10^9$；第二行包含用空格隔开的 $n$ 个非负整数 $h_1, h_2,\\dots , h_n$，其中 $h_i(1 \\le i \\le n)$ 表示第 $i$ 个支撑点的高度，特别地，$h_1$ 表示彭大侠出发时所在支撑点的高度，$h_n$ 表示城堡入口所在支撑点的高度，输入数据保证对所有 $1 \\le i \\le n$ 有 $0 \\le h_i \\le 10^9$。", "outputFormat": "有 $m$ 行，第 $I(1 \\le I \\le m)$ 行表示第 $I$ 次求解时彭大侠到达城堡必须耗费的最少金币数量。若无论怎样使用杀手锏他都无法到达城堡，则输出 `impossible`。输入数据保证答案在 int64 范围之内。", "hint": "对样例中的第一个输入数据块，$d=2$，把第三个支撑点降低 $3$ 个单位，把第六个支撑点降低 $1$ 个单位，把第七个支撑点升高 $2$ 个单位，原序列变成：`4 5 7 6 6 8 6 7 9 8`，这时任意相邻支撑点的纵向落差没有超过 $2$，彭大侠可以到达城堡！\n\n对样例中的第二个输入数据块，$d=1$，这时不管怎样调节第二个支撑点的高度，都无法使任意相邻支撑点的纵向落差不超过 $1$。\n\n对样例中的第三个输入数据块，$d=2$，这时，把第二个支撑点升高 $1$ 个单位，把第三个支撑点降低 $3$ 个单位就满足条件了。\n\n【数据规模】\n\n对于 $20\\%$ 的数据，$n \\le 100$；\n\n对于 $40\\%$ 的数据，$n \\le 1000$；\n\n对于 $100\\%$ 的数据，$n \\le 5000$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2009] The Road to the Castle", "background": "", "description": "It is said that the princess is imprisoned in the castle. Peng the Hero is determined: no matter how many obstacles lie ahead, no matter how powerful the guards in the castle are, no matter whether the princess might be captured again after being rescued, and no matter whether the princess is beautiful or will fall for him, he will march toward the castle without hesitation.\n\nHowever, something has happened on the road to the castle. Abstractly, imagine the map lies in the first quadrant of the 2D plane. At each horizontal position $x$ there is a support point of height $h_x$. If Peng the Hero fails to land on a support point, he will fall and perish on the way.\n\nInitially, Peng the Hero is at the starting point $(1, h_1)$, and the castle entrance is at $(n, h_n)$. Each time, Peng the Hero can jump from support point $(x, h_x)$ to support point $(x+1, h_{x+1})$. But each jump only has energy $d$, that is, every jump must satisfy $|h_{x+1} - h_x| \\le d$. In other words, if the vertical difference between two adjacent support points is greater than $d$, Peng the Hero cannot jump! Fortunately, he has a trump card.\n\nAt the starting point, he can spend one coin to increase the height of some support point by $1$ unit, or decrease it by $1$ unit. However, the heights of the support points at the starting point and at the castle entrance cannot be changed, and once he leaves the start, Peng the Hero can no longer use this trump card.\n\nPeng the Hero is told that $100$ coins can be exchanged for one unit of life. Therefore, he wants to save as many units of life as possible by spending as few coins as possible.\n\nHe finally found you, a helpful expert. Please help him plan so that he reaches the castle while spending the fewest coins.", "inputFormat": "The first line contains an integer $m$ ($m \\le 5$), the number of test cases. The following $2m$ lines describe the input data blocks for each test case in order. Each test case occupies $2$ lines:\n- The first line contains two integers $n$ and $d$, representing the number of support points that must be traversed from the start to the castle entrance, and the maximum allowed vertical difference per jump, respectively, separated by a space. It is guaranteed that $2 \\le n \\le 5000$, $0 \\le d \\le 10^9$.\n- The second line contains $n$ non-negative integers $h_1, h_2, \\dots, h_n$ separated by spaces, where $h_i$ ($1 \\le i \\le n$) is the height of the $i$-th support point. In particular, $h_1$ is the height at the start and $h_n$ is the height at the castle entrance. It is guaranteed that for all $1 \\le i \\le n$, $0 \\le h_i \\le 10^9$.", "outputFormat": "Output $m$ lines. The $I$-th line ($1 \\le I \\le m$) contains the minimum number of coins Peng the Hero must spend to reach the castle in the $I$-th test case. If he cannot reach the castle no matter how he uses the trump card, output `impossible`. It is guaranteed that the answer fits within the int64 range.", "hint": "For the first sample input block, $d = 2$. Lower the third support point by $3$ units, lower the sixth by $1$ unit, and raise the seventh by $2$ units. The sequence becomes: `4 5 7 6 6 8 6 7 9 8`. Now the vertical difference between any adjacent support points does not exceed $2$, so Peng the Hero can reach the castle!\n\nFor the second sample input block, $d = 1$. No matter how you adjust the height of the second support point, you cannot make every adjacent vertical difference at most $1$.\n\nFor the third sample input block, $d = 2$. Raising the second support point by $1$ unit and lowering the third by $3$ units suffices.\n\nConstraints\n\n- For $20\\%$ of the testdata, $n \\le 100$.\n- For $40\\%$ of the testdata, $n \\le 1000$.\n- For $100\\%$ of the testdata, $n \\le 5000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2009] 通往城堡之路", "background": null, "description": "听说公主被关押在城堡里，彭大侠下定决心：不管一路上有多少坎坷，不管城堡中的看守有多少厉害，不管救了公主之后公主会不会再被抓走，不管公主是否漂亮、是否会钟情于自己，他将义无反顾地朝着城堡前进。\n\n可是，通往城堡的路上出现了一些情况。抽象地说，假象地图在二维平面的第一象限。在每个横轴的 $x$ 位置上有一个高为 $h_x$ 的支撑点，如果彭大侠没有跳到支撑点上，那么他就会掉下去，牺牲在路途。\n\n开始时彭大侠在起点 $(1,h_1)$ 处，而城堡的入口在 $(n,h_n)$ 处。彭大侠每次可以从支撑点 $(x,h_x)$ 跳到支撑点 $(x+1,h_{x+1})$。但是彭大侠每次的跳跃能量只有 $d$，也就是说，每次跳跃必须满足条件 $|h_{x+1}-h_x| \\le d$。换句话说，如果两个相邻支撑点的纵向落差大于 $d$，那么彭大侠就无法跳跃了！幸运的是，彭大侠还有一个杀手锏。\n\n在起点处，他可以花一个金币，把某个支撑点升高 $1$ 个单位，或者降低 $1$ 个单位。但是，起点处和城堡入口处的支撑点高度不能改变，并且一旦离开起点彭大侠就无法使用该杀手锏。\n\n彭大侠被告知 $100$ 个金币可兑换一单位生命。于是他希望通过少花金币来保存更多单位的生命。\n\n他终于找到了你这位热心的高手，请你帮他规划一下以便耗费尽量少的金币来到达城堡。", "inputFormat": "文件第一行包含一个整数 $m(m \\le 5)$，表示问题求解次数。接下来的 $2m$ 行依次表示每次求解的输入数据块。每个输入数据块占 $2$ 行，其中第一行包含两个整数 $n$ 和 $d$，分别表示从起点到城堡入口处必须经过的支撑点数和每次跳跃允许的最大纵向落差，$n$ 和 $d$ 之间用空格隔开，输入数据保证 $2 \\le n \\le 5000，0 \\le d \\le 10^9$；第二行包含用空格隔开的 $n$ 个非负整数 $h_1, h_2,\\dots , h_n$，其中 $h_i(1 \\le i \\le n)$ 表示第 $i$ 个支撑点的高度，特别地，$h_1$ 表示彭大侠出发时所在支撑点的高度，$h_n$ 表示城堡入口所在支撑点的高度，输入数据保证对所有 $1 \\le i \\le n$ 有 $0 \\le h_i \\le 10^9$。", "outputFormat": "有 $m$ 行，第 $I(1 \\le I \\le m)$ 行表示第 $I$ 次求解时彭大侠到达城堡必须耗费的最少金币数量。若无论怎样使用杀手锏他都无法到达城堡，则输出 `impossible`。输入数据保证答案在 int64 范围之内。", "hint": "对样例中的第一个输入数据块，$d=2$，把第三个支撑点降低 $3$ 个单位，把第六个支撑点降低 $1$ 个单位，把第七个支撑点升高 $2$ 个单位，原序列变成：`4 5 7 6 6 8 6 7 9 8`，这时任意相邻支撑点的纵向落差没有超过 $2$，彭大侠可以到达城堡！\n\n对样例中的第二个输入数据块，$d=1$，这时不管怎样调节第二个支撑点的高度，都无法使任意相邻支撑点的纵向落差不超过 $1$。\n\n对样例中的第三个输入数据块，$d=2$，这时，把第二个支撑点升高 $1$ 个单位，把第三个支撑点降低 $3$ 个单位就满足条件了。\n\n【数据规模】\n\n对于 $20\\%$ 的数据，$n \\le 100$；\n\n对于 $40\\%$ 的数据，$n \\le 1000$；\n\n对于 $100\\%$ 的数据，$n \\le 5000$。", "locale": "zh-CN"}}}
{"pid": "P3203", "type": "P", "difficulty": 6, "samples": [["4\n1 2 1 1\n3\n1 1\n2 1 1\n1 1", "2\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2010", "各省省选", "湖南", "动态树 LCT", "分块"], "title": "[HNOI2010] 弹飞绵羊", "background": "", "description": "某天，Lostmonkey 发明了一种超级弹力装置，为了在他的绵羊朋友面前显摆，他邀请小绵羊一起玩个游戏。  \n\n游戏一开始，Lostmonkey 在地上沿着一条直线摆上 $n$ 个装置，每个装置设定初始弹力系数 $k_i$，当绵羊达到第 $i$ 个装置时，它会往后弹 $k_i$ 步，达到第 $i+k_i$ 个装置，若不存在第 $i+k_i$ 个装置，则绵羊被弹飞。  \n\n绵羊想知道当它从第 $i$ 个装置起步时，被弹几次后会被弹飞。为了使得游戏更有趣，Lostmonkey 可以修改某个弹力装置的弹力系数，任何时候弹力系数均为正整数。\n", "inputFormat": "第一行包含一个整数 $n$，表示地上有 $n$ 个装置，装置的编号从 $0 \\sim n-1$。\n\n接下来一行有 $n$ 个正整数，依次为那 $n$ 个装置的初始弹力系数。\n\n第三行有一个正整数 $m$，表示操作次数。接下来 $m$ 行每行至少有两个数 $i,j$。  \n\n- 若 $i=1$，你要输出从编号为 $j$ 的装置出发被弹几次后被弹飞  \n\n- 若 $i=2$，则还会再输入一个正整数 $k$，表示编号为 $j$ 的弹力装置的系数被修改成 $k$。", "outputFormat": "对于每个 $i=1$ 的操作，输出一行一个整数表示答案。\n", "hint": "【数据范围】   \n对于 $20\\%$ 的数据，$1 \\le n,m \\le 10^4$；   \n对于 $100\\%$ 的数据，$1\\le n \\le 2\\times 10^5$，$1\\le m \\le 10^5$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2010] Bouncing Sheep", "background": "", "description": "One day, Lostmonkey invented a super elastic device. To show off in front of his sheep friends, he invited a little sheep to play a game.\n\nAt the start of the game, Lostmonkey places $n$ devices along a straight line on the ground. Each device has an initial elasticity coefficient $k_i$. When the sheep reaches the $i$-th device, it will bounce forward $k_i$ steps, reaching the $(i + k_i)$-th device. If the $(i + k_i)$-th device does not exist, the sheep will be launched away.\n\nThe sheep wants to know, starting from the $i$-th device, after how many bounces it will be launched away. To make the game more interesting, Lostmonkey may modify the elasticity coefficient of any device, and the coefficients are positive integers at all times.", "inputFormat": "The first line contains an integer $n$, indicating there are $n$ devices on the ground, numbered from $0 \\sim n-1$.\n\nThe next line contains $n$ positive integers, which are the initial elasticity coefficients of the $n$ devices in order.\n\nThe third line contains a positive integer $m$, the number of operations. Each of the next $m$ lines contains at least two integers $i, j$.  \n- If $i = 1$, you should output after how many bounces the sheep starting from device $j$ will be launched away.  \n- If $i = 2$, there will be one more positive integer $k$, meaning the coefficient of device $j$ is updated to $k$.", "outputFormat": "For each operation with $i = 1$, output one line containing a single integer representing the answer.", "hint": "Constraints  \nFor $20\\%$ of the testdata, $1 \\le n, m \\le 10^4$.  \nFor $100\\%$ of the testdata, $1 \\le n \\le 2 \\times 10^5$, $1 \\le m \\le 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2010] 弹飞绵羊", "background": "", "description": "某天，Lostmonkey 发明了一种超级弹力装置，为了在他的绵羊朋友面前显摆，他邀请小绵羊一起玩个游戏。  \n\n游戏一开始，Lostmonkey 在地上沿着一条直线摆上 $n$ 个装置，每个装置设定初始弹力系数 $k_i$，当绵羊达到第 $i$ 个装置时，它会往后弹 $k_i$ 步，达到第 $i+k_i$ 个装置，若不存在第 $i+k_i$ 个装置，则绵羊被弹飞。  \n\n绵羊想知道当它从第 $i$ 个装置起步时，被弹几次后会被弹飞。为了使得游戏更有趣，Lostmonkey 可以修改某个弹力装置的弹力系数，任何时候弹力系数均为正整数。\n", "inputFormat": "第一行包含一个整数 $n$，表示地上有 $n$ 个装置，装置的编号从 $0 \\sim n-1$。\n\n接下来一行有 $n$ 个正整数，依次为那 $n$ 个装置的初始弹力系数。\n\n第三行有一个正整数 $m$，表示操作次数。接下来 $m$ 行每行至少有两个数 $i,j$。  \n\n- 若 $i=1$，你要输出从编号为 $j$ 的装置出发被弹几次后被弹飞  \n\n- 若 $i=2$，则还会再输入一个正整数 $k$，表示编号为 $j$ 的弹力装置的系数被修改成 $k$。", "outputFormat": "对于每个 $i=1$ 的操作，输出一行一个整数表示答案。\n", "hint": "【数据范围】   \n对于 $20\\%$ 的数据，$1 \\le n,m \\le 10^4$；   \n对于 $100\\%$ 的数据，$1\\le n \\le 2\\times 10^5$，$1\\le m \\le 10^5$。\n", "locale": "zh-CN"}}}
{"pid": "P3204", "type": "P", "difficulty": 6, "samples": [["10 3 3", "1"], ["5 2 3", "3"], ["10 2 4", "81"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2010", "各省省选", "湖南", "矩阵加速", "进制", "状压 DP"], "title": "[HNOI2010] 公交线路", "background": null, "description": "小 Z 所在的城市有 $N$ 个公交车站，排列在一条长 $(N-1)\\  \\rm km$ 的直线上，从左到右依次编号为 $1$ 到 $N$，相邻公交车站间的距离均为 $1 \\ \\rm km$。作为公交车线路的规划者，小 Z 调查了市民的需求，决定按下述规则设计线路：\n\n1. 设共 $K$ 辆公交车，则 $1$ 到 $K$ 号站作为始发站，$N-K+1$ 到 $N$ 号台作为终点站。\n2. 每个车站必须被一辆且仅一辆公交车经过（始发站和终点站也算被经过）。\n3. 公交车只能从编号较小的站台驶往编号较大的站台。\n4. 一辆公交车经过的相邻两个站台间距离不得超过 $P \\ \\rm km$。\n\n在最终设计线路之前，小 Z 想知道有多少种满足要求的方案。由于答案可能很大，你只需求出答案对 $30031$ 取模的结果。", "inputFormat": "仅一行包含三个正整数 $N$、$K$、$P$，分别表示公交车站数、公交车数、相邻站台的距离限制。", "outputFormat": "仅包含一个整数，表示满足要求的方案数对 $30031$ 取模的结果。", "hint": "【样例说明】\n\n样例一的可行方案如下：$(1,4,7,10)$，$(2,5,8)$，$(3,6,9)$。\n\n样例二的可行方案如下：$(1,3,5)$，$(2,4)(1,3,4)$，$(2,5)(1,4)$，$(2,3,5)$。\n\n对于 $100 \\%$ 的数据，$1 \\le N \\le 10^9$，$1 < P \\le 10$，$K<N$，$1<K \\le P$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2010] Bus Routes", "background": "", "description": "There are $N$ bus stops in Xiao Z’s city, arranged on a straight line of length $(N-1)\\  \\rm km$, numbered from left to right as $1$ to $N$. The distance between any two adjacent bus stops is $1 \\ \\rm km$. As the planner of bus routes, Xiao Z decides to design the routes according to the following rules:\n\n1. Suppose there are $K$ buses. Then stops $1$ to $K$ serve as the starting stops, and stops $N-K+1$ to $N$ serve as the terminal stops.\n2. Each stop must be visited by exactly one bus (starting and terminal stops are also considered visited).\n3. A bus may only travel from a lower-numbered stop to a higher-numbered stop.\n4. For any single bus, the distance between two consecutive stops it visits must not exceed $P \\ \\rm km$.\n\nBefore finalizing the design, Xiao Z wants to know how many valid plans satisfy the rules. Since the answer can be large, output the result modulo $30031$.", "inputFormat": "A single line contains three positive integers $N$, $K$, and $P$, representing the number of bus stops, the number of buses, and the distance limit between consecutive stops, respectively.", "outputFormat": "Output a single integer: the number of valid plans modulo $30031$.", "hint": "Sample explanation:\n\n- Sample 1 has the following valid plan: $(1,4,7,10)$, $(2,5,8)$, $(3,6,9)$.\n- Sample 2 has the following valid plans: $(1,3,5)$, $(2,4)$; $(1,3,4)$, $(2,5)$; $(1,4)$, $(2,3,5)$.\n\nConstraints:\n\nFor $100\\%$ of the testdata, $1 \\le N \\le 10^9$, $1 < P \\le 10$, $K < N$, $1 < K \\le P$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2010] 公交线路", "background": null, "description": "小 Z 所在的城市有 $N$ 个公交车站，排列在一条长 $(N-1)\\  \\rm km$ 的直线上，从左到右依次编号为 $1$ 到 $N$，相邻公交车站间的距离均为 $1 \\ \\rm km$。作为公交车线路的规划者，小 Z 调查了市民的需求，决定按下述规则设计线路：\n\n1. 设共 $K$ 辆公交车，则 $1$ 到 $K$ 号站作为始发站，$N-K+1$ 到 $N$ 号台作为终点站。\n2. 每个车站必须被一辆且仅一辆公交车经过（始发站和终点站也算被经过）。\n3. 公交车只能从编号较小的站台驶往编号较大的站台。\n4. 一辆公交车经过的相邻两个站台间距离不得超过 $P \\ \\rm km$。\n\n在最终设计线路之前，小 Z 想知道有多少种满足要求的方案。由于答案可能很大，你只需求出答案对 $30031$ 取模的结果。", "inputFormat": "仅一行包含三个正整数 $N$、$K$、$P$，分别表示公交车站数、公交车数、相邻站台的距离限制。", "outputFormat": "仅包含一个整数，表示满足要求的方案数对 $30031$ 取模的结果。", "hint": "【样例说明】\n\n样例一的可行方案如下：$(1,4,7,10)$，$(2,5,8)$，$(3,6,9)$。\n\n样例二的可行方案如下：$(1,3,5)$，$(2,4)(1,3,4)$，$(2,5)(1,4)$，$(2,3,5)$。\n\n对于 $100 \\%$ 的数据，$1 \\le N \\le 10^9$，$1 < P \\le 10$，$K<N$，$1<K \\le P$。", "locale": "zh-CN"}}}
{"pid": "P3205", "type": "P", "difficulty": 4, "samples": [["4\n1701 1702 1703 1704", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2010", "各省省选", "湖南", "区间 DP"], "title": "[HNOI2010] 合唱队", "background": null, "description": "为了在即将到来的晚会上有更好的演出效果，作为 AAA 合唱队负责人的小 A 需要将合唱队的人根据他们的身高排出一个队形。假定合唱队一共 $n$ 个人，第 $i$ 个人的身高为 $h_i$ 米（$1000 \\le h_i \\le 2000$），并已知任何两个人的身高都不同。假定最终排出的队形是 $A$ 个人站成一排，为了简化问题，小 A 想出了如下排队的方式：他让所有的人先按任意顺序站成一个初始队形，然后从左到右按以下原则依次将每个人插入最终排出的队形中：\n\n- 第一个人直接插入空的当前队形中。\n\n- 对从第二个人开始的每个人，如果他比前面那个人高（$h$ 较大），那么将他插入当前队形的最右边。如果他比前面那个人矮（$h$ 较小），那么将他插入当前队形的最左边。\n\n当 $n$ 个人全部插入当前队形后便获得最终排出的队形。\n\n例如，有 $6$ 个人站成一个初始队形，身高依次为 $1850, 1900, 1700, 1650, 1800, 1750$，  \n那么小 A 会按以下步骤获得最终排出的队形：\n\n- $1850$。\n\n- $1850, 1900$，因为 $1900 > 1850$。\n\n- $1700, 1850, 1900$，因为 $1700 < 1900$。\n\n- $1650, 1700, 1850, 1900$，因为 $1650 < 1700$。\n\n- $1650, 1700, 1850, 1900, 1800$，因为 $1800 > 1650$。\n\n- $1750, 1650, 1700, 1850, 1900, 1800$，因为 $1750 < 1800$。\n\n因此，最终排出的队形是 $1750, 1650, 1700, 1850, 1900, 1800$。\n\n小 A 心中有一个理想队形，他想知道多少种初始队形可以获得理想的队形。\n\n请求出答案对 $19650827$ 取模的值。", "inputFormat": "第一行一个整数 $n$。  \n第二行 $n$ 个整数，表示小 A 心中的理想队形。", "outputFormat": "输出一行一个整数，表示答案 $\\bmod 19650827$ 的值。", "hint": "对于 $30\\%$ 的数据，$n \\le 100$。  \n对于 $100\\%$ 的数据，$n \\le 1000$，$1000 \\le h_i \\le 2000$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2010] Choir", "background": "", "description": "To achieve a better performance at the upcoming gala, Xiao A, the leader of the AAA choir, needs to arrange the choir members into a lineup based on their heights. Suppose there are $n$ people in total, the $i$-th person’s height is $h_i$ meters ($1000 \\le h_i \\le 2000$), and any two people have different heights. Suppose the final lineup consists of $n$ people standing in one row. To simplify the process, Xiao A came up with the following method: he first lets everyone stand in an initial lineup in an arbitrary order, and then, from left to right, inserts each person into the final lineup according to these rules:\n\n- The first person is directly inserted into the empty current lineup.\n\n- For each person starting from the second, if he is taller than the person immediately before him in the initial lineup ($h$ is larger), insert him at the right end of the current lineup. If he is shorter ($h$ is smaller), insert him at the left end.\n\nAfter all $n$ people have been inserted into the current lineup, the final lineup is obtained.\n\nFor example, there are $6$ people in the initial lineup, with heights $1850, 1900, 1700, 1650, 1800, 1750$.  \nThen Xiao A will obtain the final lineup step by step as follows:\n\n- 1850.\n\n- 1850, 1900, because $1900 > 1850$.\n\n- 1700, 1850, 1900, because $1700 < 1900$.\n\n- 1650, 1700, 1850, 1900, because $1650 < 1700$.\n\n- 1650, 1700, 1850, 1900, 1800, because $1800 > 1650$.\n\n- 1750, 1650, 1700, 1850, 1900, 1800, because $1750 < 1800$.\n\nTherefore, the final lineup is 1750, 1650, 1700, 1850, 1900, 1800.\n\nXiao A has an ideal lineup in mind and wants to know how many initial lineups can result in that ideal lineup.\n\nCompute the answer modulo $19650827$.", "inputFormat": "The first line contains an integer $n$.  \nThe second line contains $n$ integers, representing Xiao A’s ideal lineup.", "outputFormat": "Output one line with a single integer, which is the value of the answer $\\bmod 19650827$.", "hint": "For 30% of the testdata, $n \\le 100$.  \nFor 100% of the testdata, $n \\le 1000$, $1000 \\le h_i \\le 2000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2010] 合唱队", "background": null, "description": "为了在即将到来的晚会上有更好的演出效果，作为 AAA 合唱队负责人的小 A 需要将合唱队的人根据他们的身高排出一个队形。假定合唱队一共 $n$ 个人，第 $i$ 个人的身高为 $h_i$ 米（$1000 \\le h_i \\le 2000$），并已知任何两个人的身高都不同。假定最终排出的队形是 $A$ 个人站成一排，为了简化问题，小 A 想出了如下排队的方式：他让所有的人先按任意顺序站成一个初始队形，然后从左到右按以下原则依次将每个人插入最终排出的队形中：\n\n- 第一个人直接插入空的当前队形中。\n\n- 对从第二个人开始的每个人，如果他比前面那个人高（$h$ 较大），那么将他插入当前队形的最右边。如果他比前面那个人矮（$h$ 较小），那么将他插入当前队形的最左边。\n\n当 $n$ 个人全部插入当前队形后便获得最终排出的队形。\n\n例如，有 $6$ 个人站成一个初始队形，身高依次为 $1850, 1900, 1700, 1650, 1800, 1750$，  \n那么小 A 会按以下步骤获得最终排出的队形：\n\n- $1850$。\n\n- $1850, 1900$，因为 $1900 > 1850$。\n\n- $1700, 1850, 1900$，因为 $1700 < 1900$。\n\n- $1650, 1700, 1850, 1900$，因为 $1650 < 1700$。\n\n- $1650, 1700, 1850, 1900, 1800$，因为 $1800 > 1650$。\n\n- $1750, 1650, 1700, 1850, 1900, 1800$，因为 $1750 < 1800$。\n\n因此，最终排出的队形是 $1750, 1650, 1700, 1850, 1900, 1800$。\n\n小 A 心中有一个理想队形，他想知道多少种初始队形可以获得理想的队形。\n\n请求出答案对 $19650827$ 取模的值。", "inputFormat": "第一行一个整数 $n$。  \n第二行 $n$ 个整数，表示小 A 心中的理想队形。", "outputFormat": "输出一行一个整数，表示答案 $\\bmod 19650827$ 的值。", "hint": "对于 $30\\%$ 的数据，$n \\le 100$。  \n对于 $100\\%$ 的数据，$n \\le 1000$，$1000 \\le h_i \\le 2000$。", "locale": "zh-CN"}}}
{"pid": "P3206", "type": "P", "difficulty": 6, "samples": [["5 5 3\n1 2 1\n2 3 2\n3 4 3\n4 5 4\n5 1 5\n1 6\n1 1\n5 3", "14\n10\n9"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2010", "各省省选", "湖南", "cdq 分治", "分治", "生成树", "动态树 LCT", "线段树分治"], "title": "[HNOI2010] 城市建设", "background": "", "description": "PS 国是一个拥有诸多城市的大国。国王 Louis 为城市的交通建设可谓绞尽脑汁。Louis 可以在某些城市之间修建道路，在不同的城市之间修建道路需要不同的花费。\n\nLouis 希望建造最少的道路使得国内所有的城市连通。但是由于某些因素，城市之间修建道路需要的花费会随着时间而改变。Louis 会不断得到某道路的修建代价改变的消息。他希望每得到一条消息后能立即知道使城市连通的最小花费总和。Louis 决定求助于你来完成这个任务。\n", "inputFormat": "第一行包含三个整数 $n,m,q$，分别表示城市的数目，可以修建的道路个数，及收到的消息个数。\n\n接下来 $m$ 行，第 $i+1$ 行有三个用空格隔开的整数 $x_i,y_i,z_i$，表示在城市 $x_i$ 与城市 $y_i$ 之间修建道路的代价为 $z_i$。接下来 $q$ 行，每行包含两个数 $k,d$，表示输入的第 $k$ 个道路的修建代价修改为 $d$（即将 $z_k$ 修改为 $d$）。", "outputFormat": "输出包含 $q$ 行，第 $i$ 行输出得知前 $i$ 条消息后使城市连通的最小花费总和。", "hint": "### 数据规模与约定\n- 对于 $20\\%$ 的数据，$n\\le 10^3$，$m,q\\le 6\\times 10^3$。\n- 对于另外 $20\\%$ 的数据，$n\\le 10^3$，$m\\le 5\\times 10^4$，$q\\le 8\\times 10^3$。修改后的代价不会比之前的代价低。\n- 对于 $100\\%$ 的数据，$1\\le n\\le 2\\times 10^4$，$1\\le m,q\\le 5\\times 10^4$，$1\\le x_i,y_i\\le n$，$0\\le z_i\\le 5\\times 10^7$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2010] City Construction", "background": "", "description": "The PS Kingdom is a large country with many cities. King Louis has racked his brains over urban transportation. Louis can build roads between certain pairs of cities, and building roads between different pairs costs different amounts.\n\nLouis wants to build the fewest roads so that all cities in the country are connected. However, due to certain factors, the cost to build roads between cities changes over time. Louis will continuously receive notifications that the construction cost of some road has changed. He hopes that after receiving each notification, he can immediately know the minimal total cost to connect all cities. Louis has decided to ask you for help with this task.", "inputFormat": "The first line contains three integers $n, m, q$, representing the number of cities, the number of roads that can be built, and the number of notifications, respectively.\n\nThe next $m$ lines: on the $(i + 1)$-th line there are three integers $x_i, y_i, z_i$, meaning the cost to build a road between city $x_i$ and city $y_i$ is $z_i$. Then the next $q$ lines: each line contains two integers $k, d$, meaning the construction cost of the $k$-th road is updated to $d$ (that is, set $z_k$ to $d$).", "outputFormat": "Output contains $q$ lines. On the $i$-th line, output the minimal total cost to make all cities connected after processing the first $i$ notifications.", "hint": "Constraints\n- For $20\\%$ of the testdata, $n \\le 10^3$, $m, q \\le 6 \\times 10^3$.\n- For another $20\\%$ of the testdata, $n \\le 10^3$, $m \\le 5 \\times 10^4$, $q \\le 8 \\times 10^3$. The updated cost will not be lower than the previous cost.\n- For $100\\%$ of the testdata, $1 \\le n \\le 2 \\times 10^4$, $1 \\le m, q \\le 5 \\times 10^4$, $1 \\le x_i, y_i \\le n$, $0 \\le z_i \\le 5 \\times 10^7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2010] 城市建设", "background": "", "description": "PS 国是一个拥有诸多城市的大国。国王 Louis 为城市的交通建设可谓绞尽脑汁。Louis 可以在某些城市之间修建道路，在不同的城市之间修建道路需要不同的花费。\n\nLouis 希望建造最少的道路使得国内所有的城市连通。但是由于某些因素，城市之间修建道路需要的花费会随着时间而改变。Louis 会不断得到某道路的修建代价改变的消息。他希望每得到一条消息后能立即知道使城市连通的最小花费总和。Louis 决定求助于你来完成这个任务。\n", "inputFormat": "第一行包含三个整数 $n,m,q$，分别表示城市的数目，可以修建的道路个数，及收到的消息个数。\n\n接下来 $m$ 行，第 $i+1$ 行有三个用空格隔开的整数 $x_i,y_i,z_i$，表示在城市 $x_i$ 与城市 $y_i$ 之间修建道路的代价为 $z_i$。接下来 $q$ 行，每行包含两个数 $k,d$，表示输入的第 $k$ 个道路的修建代价修改为 $d$（即将 $z_k$ 修改为 $d$）。", "outputFormat": "输出包含 $q$ 行，第 $i$ 行输出得知前 $i$ 条消息后使城市连通的最小花费总和。", "hint": "### 数据规模与约定\n- 对于 $20\\%$ 的数据，$n\\le 10^3$，$m,q\\le 6\\times 10^3$。\n- 对于另外 $20\\%$ 的数据，$n\\le 10^3$，$m\\le 5\\times 10^4$，$q\\le 8\\times 10^3$。修改后的代价不会比之前的代价低。\n- 对于 $100\\%$ 的数据，$1\\le n\\le 2\\times 10^4$，$1\\le m,q\\le 5\\times 10^4$，$1\\le x_i,y_i\\le n$，$0\\le z_i\\le 5\\times 10^7$。", "locale": "zh-CN"}}}
{"pid": "P3207", "type": "P", "difficulty": 5, "samples": [["1\n8 3 5 2 7 4", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2010", "并查集", "各省省选", "湖南", "置换"], "title": "[HNOI2010] 物品调度", "background": "", "description": "现在找工作不容易，Lostmonkey 费了好大劲才得到 fsk 公司基层流水线操作员的职位。流水线上有 $n$ 个位置，从 $0$ 到 $n - 1$ 依次编号，一开始 $0$ 号位置是空的，其它的位置 $i$ 上有编号为 $i$ 的盒子。Lostmonkey 要按照以下规则重新排列这些盒子。\n\n规则由五个数描述，$q, p, m, d, s$，$s$ 表示空位的最终位置。\n\n首先生成一个序列 $c$，$c_0=0$，$c_{i+1}=(c_i\\times q+p)\\bmod m$。\n\n接下来从第一个盒子开始依次生成每个盒子的最终位置 $pos_i$，$pos_i=(c_i+d\\times x_i+y_i)\\bmod n$，$x_i,y_i$ 是为了让第 $i$ 个盒子不与之前的盒子位置相同的由你设定的非负整数，且 $pos_i$ 还不能为 $s$。\n\n如果有多个序列 $x,y$ 满足要求，你需要选择 $y$ 的字典序最小的，当 $y$ 相同时选择 $x$ 字典序最小的。这样你得到了所有盒子的最终位置，现在你每次可以把某个盒子移动到空位上，移动后原盒子所在的位置成为空位。\n\n问把所有的盒子移动到最终位置所需的最少步数。", "inputFormat": "第一行包含一个整数 $t$，表示数据组数。\n\n接下来 $t$ 行，每行六个数，$n, s, q, p, m, d$ 意义如上所述。", "outputFormat": "对于每组数据输出一个数占一行，表示最少移动步数。\n", "hint": "**【样例解释】**\n\n第 $1$ 个到第 $7$ 个盒子的最终位置依次是：$[2, 5, 6, 4, 1, 0, 7]$。\n\n**【数据范围】**\n\n对于 $30 \\%$ 的数据，$n \\le 100$，  \n对于 $100 \\%$ 的数据，$1 \\le t \\le 20$，$1 \\le n \\le 100000$，$0 \\le s < n$。\n\n其余所有数字均为不超过 $100000$ 的正整数。\n\n**【提示】**\n\n计算过程可能超过整型范围。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2010] Item Scheduling", "background": "", "description": "Finding a job is not easy. Lostmonkey finally managed to get an entry-level assembly line operator position at fsk. There are $n$ positions on the line, numbered from $0$ to $n - 1$. Initially, position $0$ is empty, and each other position $i$ holds a box numbered $i$. Lostmonkey needs to rearrange these boxes according to the following rules.\n\nThe rules are determined by five numbers, $q, p, m, d, s$, where $s$ is the final position of the empty slot.\n\nFirst, generate a sequence $c$ with $c_0=0$, and $c_{i+1}=(c_i\\times q+p)\\bmod m$.\n\nNext, starting from the first box, generate the final position $pos_i$ for each box in order: $pos_i=(c_i+d\\times x_i+y_i)\\bmod n$, where $x_i, y_i$ are non-negative integers chosen by you so that the $i$-th box does not share the same position as any previous box, and $pos_i$ must not be $s$.\n\nIf there are multiple sequences $x, y$ that satisfy the requirements, you must choose the one with the lexicographically smallest $y$. If $y$ is the same, choose the lexicographically smallest $x$. In this way, you obtain the final positions for all boxes. Each move allows you to move any box into the empty slot; after moving, the original position of that box becomes the empty slot.\n\nFind the minimum number of moves required to move all boxes to their final positions.", "inputFormat": "The first line contains an integer $t$, the number of test cases.\n\nThen follow $t$ lines. Each line contains six numbers, $n, s, q, p, m, d$, as described above.", "outputFormat": "For each test case, output one number on a single line, the minimum number of moves.", "hint": "[Sample Explanation]\n\nThe final positions of boxes $1$ through $7$ are: $[2, 5, 6, 4, 1, 0, 7]$.\n\nConstraints\n\n- For $30\\%$ of the testdata, $n \\le 100$.\n- For $100\\%$ of the testdata, $1 \\le t \\le 20$, $1 \\le n \\le 100000$, $0 \\le s < n$.\n- All other numbers are positive integers not exceeding $100000$.\n\nAdditional Hint\n\nThe computation may exceed the integer range.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2010] 物品调度", "background": "", "description": "现在找工作不容易，Lostmonkey 费了好大劲才得到 fsk 公司基层流水线操作员的职位。流水线上有 $n$ 个位置，从 $0$ 到 $n - 1$ 依次编号，一开始 $0$ 号位置是空的，其它的位置 $i$ 上有编号为 $i$ 的盒子。Lostmonkey 要按照以下规则重新排列这些盒子。\n\n规则由五个数描述，$q, p, m, d, s$，$s$ 表示空位的最终位置。\n\n首先生成一个序列 $c$，$c_0=0$，$c_{i+1}=(c_i\\times q+p)\\bmod m$。\n\n接下来从第一个盒子开始依次生成每个盒子的最终位置 $pos_i$，$pos_i=(c_i+d\\times x_i+y_i)\\bmod n$，$x_i,y_i$ 是为了让第 $i$ 个盒子不与之前的盒子位置相同的由你设定的非负整数，且 $pos_i$ 还不能为 $s$。\n\n如果有多个序列 $x,y$ 满足要求，你需要选择 $y$ 的字典序最小的，当 $y$ 相同时选择 $x$ 字典序最小的。这样你得到了所有盒子的最终位置，现在你每次可以把某个盒子移动到空位上，移动后原盒子所在的位置成为空位。\n\n问把所有的盒子移动到最终位置所需的最少步数。", "inputFormat": "第一行包含一个整数 $t$，表示数据组数。\n\n接下来 $t$ 行，每行六个数，$n, s, q, p, m, d$ 意义如上所述。", "outputFormat": "对于每组数据输出一个数占一行，表示最少移动步数。\n", "hint": "**【样例解释】**\n\n第 $1$ 个到第 $7$ 个盒子的最终位置依次是：$[2, 5, 6, 4, 1, 0, 7]$。\n\n**【数据范围】**\n\n对于 $30 \\%$ 的数据，$n \\le 100$，  \n对于 $100 \\%$ 的数据，$1 \\le t \\le 20$，$1 \\le n \\le 100000$，$0 \\le s < n$。\n\n其余所有数字均为不超过 $100000$ 的正整数。\n\n**【提示】**\n\n计算过程可能超过整型范围。", "locale": "zh-CN"}}}
{"pid": "P3208", "type": "P", "difficulty": 7, "samples": [["3 3 3\n0 0 0\n0 4 5\n0 5 3\n", "0 0 2\n2 2 1\n1 0 0\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2010", "各省省选", "湖南", "枚举", "剪枝", "图论建模", "2-SAT", "构造", "bitset"], "title": "[HNOI2010] 矩阵", "background": "", "description": "小 Z 近日闲来无事，便研究起矩阵来。他先写了一个 $N\\times M$ 的矩阵，每个格子里填入了一个小于 $P$ 的非负整数，然后他对于每个 $2\\times 2$ 的子矩阵，算出了其中数的和。\n\n譬如 $N=3, M=3, P=3$，小 Z 写的矩阵如下：\n\n$$ A = \\begin{pmatrix} 0 & 1 & 2 \\\\ 1 & 2 & 0 \\\\ 2 & 0 & 1 \\end{pmatrix} $$\n\n共有 $4$ 个 $2\\times 2$ 的子矩阵，容易算出它们的和如下：\n\n$$ A = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 4 & 5 \\\\ 0 & 5 & 3 \\end{pmatrix} $$\n\n(第一行和第一列的 $0$ 是为了格式美观而添加进去的)\n\n现在小 Z 想试一试能不能根据这些和推算出原矩阵。由于小 Z 的数学并不好，因此这个任务就交给你了。\n\n当然，小 Z 早就发现了，解很可能不唯一，譬如下面的矩阵算出的和与 $A$ 相同：\n\n$$ A = \\begin{pmatrix} 0 & 2 & 1 \\\\ 0 & 2 & 0 \\\\ 2 & 1 & 0 \\end{pmatrix} $$\n\n示意图在有多个矩阵满足要求的情况下请你输出字典序最小的那一个。\n\n字典序的比较方式如下：对于两个解矩阵 $X$ 和 $Y$，找到 $X$ 和 $Y$ 不同的位置中行数最小的那一个格子，若有多个则取列数最小的那个格子，该位置较小的矩阵字典序较小。\n\n譬如上述的矩阵 $A$ 和 $B$，第一个不同的格子应是第一行第二个格子，而 $A[1][2] < B[1][2]$，故矩阵 $A$ 的字典序比 $B$ 小。\n\n另外，小 Z 的数学还没有差到加法都做错，因此保证输入数据都是有解的。\n", "inputFormat": "第一行包含三个正整数 $N, M, P$ 表示矩阵的行数列数以及每个数的范围，接下来 $N$ 行每行包含 $M$ 个非负整数，其中第 $i$ 行第 $j$ 个数表示以格子 $(i,j)$ 为右下角的 $2 \\times 2$ 子矩阵中的数的和。保证第一行与第一列的数均为 $0$，且每个和都不超过 $4 (P-1)$。\n", "outputFormat": "包含 $N$ 行，每行 $M$ 个整数，描述你求出的矩阵，相邻的整数用空格分开。（行末不要有多余空格）\n", "hint": "$1 \\le N, M \\le 200$\n\n$2 \\le P \\le 10$\n\n感谢 @ASC\\_8384 提供题面\n", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2010] Matrix", "background": "", "description": "Xiao Z has recently been studying matrices. He first wrote an $N\\times M$ matrix where each cell contains a non-negative integer less than $P$. Then, for every $2\\times 2$ submatrix, he computed the sum of its four numbers.\n\nFor example, when $N=3, M=3, P=3$, the matrix he wrote is:\n\n$$ A = \\begin{pmatrix} 0 & 1 & 2 \\\\ 1 & 2 & 0 \\\\ 2 & 0 & 1 \\end{pmatrix} $$\n\nThere are $4$ submatrices of size $2\\times 2$, and their sums are:\n\n$$ A = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 4 & 5 \\\\ 0 & 5 & 3 \\end{pmatrix} $$\n\n(The zeros in the first row and first column are added only for formatting.)\n\nNow Xiao Z wants to see whether he can reconstruct the original matrix from these sums. Since his math is not very good, he asks you to do it.\n\nOf course, the solution may not be unique. For example, the following matrix produces the same sums as above:\n\n$$ A = \\begin{pmatrix} 0 & 2 & 1 \\\\ 0 & 2 & 0 \\\\ 2 & 1 & 0 \\end{pmatrix} $$\n\nIf multiple matrices satisfy the requirement, output the lexicographically smallest one.\n\nLexicographic order is defined as follows: for two solution matrices $X$ and $Y$, find the cell with the smallest row index where they differ; if there are multiple such cells, take the one with the smallest column index. The matrix with the smaller value at that cell is lexicographically smaller.\n\nFor the two example matrices above, the first differing cell is the second cell in the first row, and since the first matrix has a smaller value there, it is lexicographically smaller.\n\nAlso, it is guaranteed that the input is solvable.", "inputFormat": "The first line contains three positive integers $N, M, P$, denoting the number of rows and columns of the matrix and the value range of each number. Then follow $N$ lines, each containing $M$ non-negative integers. In the $i$-th line, the $j$-th number is the sum of the $2 \\times 2$ submatrix whose bottom-right corner is cell $(i, j)$. The numbers in the first row and the first column are guaranteed to be $0$, and each sum does not exceed $4 (P-1)$.", "outputFormat": "Output $N$ lines, each containing $M$ integers describing the matrix you reconstructed, with adjacent integers separated by single spaces. Do not print trailing spaces at the end of a line.", "hint": "$1 \\le N, M \\le 200$.\n\n$2 \\le P \\le 10$.\n\nThanks to @ASC\\_8384 for providing the problem statement.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2010] 矩阵", "background": "", "description": "小 Z 近日闲来无事，便研究起矩阵来。他先写了一个 $N\\times M$ 的矩阵，每个格子里填入了一个小于 $P$ 的非负整数，然后他对于每个 $2\\times 2$ 的子矩阵，算出了其中数的和。\n\n譬如 $N=3, M=3, P=3$，小 Z 写的矩阵如下：\n\n$$ A = \\begin{pmatrix} 0 & 1 & 2 \\\\ 1 & 2 & 0 \\\\ 2 & 0 & 1 \\end{pmatrix} $$\n\n共有 $4$ 个 $2\\times 2$ 的子矩阵，容易算出它们的和如下：\n\n$$ A = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 4 & 5 \\\\ 0 & 5 & 3 \\end{pmatrix} $$\n\n(第一行和第一列的 $0$ 是为了格式美观而添加进去的)\n\n现在小 Z 想试一试能不能根据这些和推算出原矩阵。由于小 Z 的数学并不好，因此这个任务就交给你了。\n\n当然，小 Z 早就发现了，解很可能不唯一，譬如下面的矩阵算出的和与 $A$ 相同：\n\n$$ A = \\begin{pmatrix} 0 & 2 & 1 \\\\ 0 & 2 & 0 \\\\ 2 & 1 & 0 \\end{pmatrix} $$\n\n示意图在有多个矩阵满足要求的情况下请你输出字典序最小的那一个。\n\n字典序的比较方式如下：对于两个解矩阵 $X$ 和 $Y$，找到 $X$ 和 $Y$ 不同的位置中行数最小的那一个格子，若有多个则取列数最小的那个格子，该位置较小的矩阵字典序较小。\n\n譬如上述的矩阵 $A$ 和 $B$，第一个不同的格子应是第一行第二个格子，而 $A[1][2] < B[1][2]$，故矩阵 $A$ 的字典序比 $B$ 小。\n\n另外，小 Z 的数学还没有差到加法都做错，因此保证输入数据都是有解的。\n", "inputFormat": "第一行包含三个正整数 $N, M, P$ 表示矩阵的行数列数以及每个数的范围，接下来 $N$ 行每行包含 $M$ 个非负整数，其中第 $i$ 行第 $j$ 个数表示以格子 $(i,j)$ 为右下角的 $2 \\times 2$ 子矩阵中的数的和。保证第一行与第一列的数均为 $0$，且每个和都不超过 $4 (P-1)$。\n", "outputFormat": "包含 $N$ 行，每行 $M$ 个整数，描述你求出的矩阵，相邻的整数用空格分开。（行末不要有多余空格）\n", "hint": "$1 \\le N, M \\le 200$\n\n$2 \\le P \\le 10$\n\n感谢 @ASC\\_8384 提供题面\n", "locale": "zh-CN"}}}
{"pid": "P3209", "type": "P", "difficulty": 6, "samples": [["2\n6 9\n1 4\n1 5\n1 6\n2 4\n2 5\n2 6\n3 4\n3 5\n3 6\n1 4 2 5 3 6\n5 5\n1 2\n2 3\n3 4\n4 5\n5 1\n1 2 3 4 5", "NO\nYES"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2010", "线段树", "并查集", "各省省选", "湖南", "图论建模", "平面图", "2-SAT", "二分图"], "title": "[HNOI2010] 平面图判定", "background": null, "description": "若能将无向图 $G=(V, E)$ 画在平面上使得任意两条无重合顶点的边不相交，则称 $G$ 是平面图。判定一个图是否为平面图的问题是图论中的一个重要问题。现在假设你要判定的是一类特殊的图，图中存在一个包含所有顶点的环，即存在哈密顿回路。", "inputFormat": "输入文件的第一行是一个正整数 $T$，表示数据组数 (每组数据描述一个需要判定的图)。\n\n接下来从输入文件第二行开始有 $T$ 组数据，每组数据的第一行是用空格隔开的两个正整数 $N$ 和 $M$，分别表示对应图的顶点数和边数。\n\n紧接着的 $M$ 行，每行是用空格隔开的两个正整数 $u$ 和 $v$ $\\left(1\\leq u,v\\leq N\\right)$，表示对应图的一条边 $\\left(u,v\\right)$, 输入的数据保证所有边仅出现一次。\n\n每组数据的最后一行是用空格隔开的 $N$ 个正整数，从左到右表示对应图中的一个哈密顿回路：$V_1,V_2,…,V_N$，即对任意 $i\\not=j$ 有 $V_i\\not=V_j$ 且对任意 $1\\leq i\\leq N-1$ 有 $\\left(V_i,V_{i+1}\\right)\\in E$ 及 $\\left(V_1,V_N\\right)\\in E$。\n\n输入的数据保证 $100\\%$ 的数据满足 $T\\leq100,3\\leq N\\leq200,M\\leq10000$。", "outputFormat": "包含 $T$ 行，若输入文件的第 $i$ 组数据所对应图是平面图，则在第 $i$ 行输出 `YES`，否则在第 $i$ 行输出 `NO`，注意均为大写字母", "hint": "感谢@hibiki 对题目进行修正\n\n感谢@Anguei 提供 latex 题面", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2010] Planarity Testing", "background": "", "description": "If an undirected graph $G=(V, E)$ can be drawn in the plane such that any two edges that do not share an endpoint do not intersect, then $G$ is called a planar graph. Deciding whether a graph is planar is an important problem in graph theory. Now suppose you are to decide this for a special class of graphs that contain a cycle passing through all vertices, i.e., there exists a Hamiltonian cycle.", "inputFormat": "The first line of the input file contains a positive integer $T$, indicating the number of test cases (each test case describes one graph to be decided).\n\nStarting from the second line, there are $T$ test cases. For each test case, the first line contains two positive integers $N$ and $M$ separated by a space, representing the number of vertices and the number of edges of the corresponding graph, respectively.\n\nThe next $M$ lines each contain two positive integers $u$ and $v$ $\\left(1\\leq u,v\\leq N\\right)$ separated by a space, representing an edge $\\left(u,v\\right)$ of the graph. The input guarantees that each edge appears exactly once.\n\nThe last line of each test case contains $N$ integers, from left to right representing a Hamiltonian cycle of the corresponding graph: $V_1,V_2,\\dots,V_N$, i.e., for any $i\\not=j$ we have $V_i\\not=V_j$, and for any $1\\leq i\\leq N-1$ we have $\\left(V_i,V_{i+1}\\right)\\in E$ and $\\left(V_1,V_N\\right)\\in E$.\n\nThe input guarantees that $100\\%$ of the testdata satisfy $T\\leq 100$, $3\\leq N\\leq 200$, $M\\leq 10000$.", "outputFormat": "Output $T$ lines. If the graph in the $i$-th test case is planar, print `YES` on the $i$-th line; otherwise, print `NO`. Note that they must be uppercase letters.", "hint": "Thanks to @hibiki for correcting the problem.\n\nThanks to @Anguei for providing the LaTeX problem statement.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2010] 平面图判定", "background": null, "description": "若能将无向图 $G=(V, E)$ 画在平面上使得任意两条无重合顶点的边不相交，则称 $G$ 是平面图。判定一个图是否为平面图的问题是图论中的一个重要问题。现在假设你要判定的是一类特殊的图，图中存在一个包含所有顶点的环，即存在哈密顿回路。", "inputFormat": "输入文件的第一行是一个正整数 $T$，表示数据组数 (每组数据描述一个需要判定的图)。\n\n接下来从输入文件第二行开始有 $T$ 组数据，每组数据的第一行是用空格隔开的两个正整数 $N$ 和 $M$，分别表示对应图的顶点数和边数。\n\n紧接着的 $M$ 行，每行是用空格隔开的两个正整数 $u$ 和 $v$ $\\left(1\\leq u,v\\leq N\\right)$，表示对应图的一条边 $\\left(u,v\\right)$, 输入的数据保证所有边仅出现一次。\n\n每组数据的最后一行是用空格隔开的 $N$ 个正整数，从左到右表示对应图中的一个哈密顿回路：$V_1,V_2,…,V_N$，即对任意 $i\\not=j$ 有 $V_i\\not=V_j$ 且对任意 $1\\leq i\\leq N-1$ 有 $\\left(V_i,V_{i+1}\\right)\\in E$ 及 $\\left(V_1,V_N\\right)\\in E$。\n\n输入的数据保证 $100\\%$ 的数据满足 $T\\leq100,3\\leq N\\leq200,M\\leq10000$。", "outputFormat": "包含 $T$ 行，若输入文件的第 $i$ 组数据所对应图是平面图，则在第 $i$ 行输出 `YES`，否则在第 $i$ 行输出 `NO`，注意均为大写字母", "hint": "感谢@hibiki 对题目进行修正\n\n感谢@Anguei 提供 latex 题面", "locale": "zh-CN"}}}
{"pid": "P3210", "type": "P", "difficulty": 7, "samples": [["8\n1 2 0 3 7 4 0 9", "17 9\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "博弈论", "2010", "各省省选", "湖南"], "title": "[HNOI2010] 取石头游戏", "background": "", "description": "A 公司正在举办一个智力双人游戏比赛 - 取石子游戏，游戏的获胜者将会获得 A 公司提供的丰厚奖金，因此吸引了来自全国各地的许多聪明的选手前来参加比赛。\n\n与经典的取石子游戏相比，A 公司举办的这次比赛的取石子游戏规则复杂了很多：\n\n* 总共有 $N$ 堆石子依次排成一行，第 $i$ 堆石子有 $a_i$ 个石子。\n\n* 开始若干堆石子已被 A 公司故意拿走。\n\n* 然后两个玩家轮流来取石子，每次每个玩家可以取走一堆中的所有石子，但有一个限制条件：一个玩家若要取走一堆石子，则与这堆石子相邻的某堆石子已被取走(之前被某个玩家取走或开始被 A 公司故意拿走)。注意：第 $1$ 堆石子只与第 $2$ 堆石子相邻，第 $N$ 堆石子只与第 $N-1$ 堆石子相邻，其余的第 $i$ 堆石子与第 $i-1$ 堆和第 $i+1$ 堆石子相邻。\n\n* 所有石子都被取走时，游戏结束。谁最后取得的总石子数最多，谁就获得了这场游戏的胜利。\n\n作为这次比赛的参赛者之一，绝顶聪明的你，想知道对于任何一场比赛，如果先手者和后手者都使用最优的策略，最后先手者和后手者分别能够取得的总石子数分别是多少。\n", "inputFormat": "第一行是一个正整数 $N$，表示有多少堆石子。输入文件第二行是用空格隔开的 $N$ 个非负整数 $a_1, a_2,\\ldots, a_N$，其中 $a_i$ 表示第 $i$ 堆石子有多少个石子，$a_i  = 0$ 表示第 $i$ 堆石子开始被 A 公司故意拿走。输入的数据保证 $0\\leq a_i\\leq 10^8$，并且至少有一个 $i$ 使得 $a_i = 0$。", "outputFormat": "仅包含一行，为两个整数，分别表示都使用最优策略时，最后先手者和后手者各自能够取得的总石子数，并且两个整数间用一个空格隔开。\n", "hint": "样例解释：两个玩家都使用最优策略时取走石子的顺序依次为 $9, 2, 1, 4, 7, 3$，因此先手者取得 $9 + 1 + 7 = 17$ 个石子，后手者取得 $2 + 4 + 3 = 9$ 个石子。\n\n$30\\%$ 的数据满足 $2\\leq N\\leq 100$。\n\n$100\\%$ 的数据满足 $2\\leq N\\leq 10^6$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2010] Stone-Taking Game", "background": "", "description": "Company A is hosting a two-player puzzle contest — the stone-taking game. The winner will receive a generous prize provided by Company A, attracting many clever contestants from all over the country.\n\nCompared with the classic stone-taking game, the rules of this contest are much more complex:\n\n- There are $N$ piles of stones arranged in a row. The $i$-th pile contains $a_i$ stones.\n- Some piles have already been deliberately removed by Company A at the start.\n- The two players then take turns. On each turn, a player may take all the stones from exactly one pile, subject to the following constraint: to take a pile, at least one of its adjacent piles must have already been taken (either previously by a player or initially removed by Company A). Note: pile $1$ is adjacent only to pile $2$, pile $N$ is adjacent only to pile $N-1$, and any other pile $i$ is adjacent to piles $i-1$ and $i+1$.\n- The game ends when all stones have been taken. The player who has collected more stones in total wins.\n\nAs one of the contestants, you want to know, for any game, if both the first player and the second player play optimally, what total number of stones each will obtain.", "inputFormat": "The first line contains a positive integer $N$, the number of piles. The second line contains $N$ space-separated nonnegative integers $a_1, a_2, \\ldots, a_N$, where $a_i$ is the number of stones in the $i$-th pile, and $a_i = 0$ means the $i$-th pile was initially removed by Company A. The input guarantees $0 \\le a_i \\le 10^8$, and there exists at least one $i$ such that $a_i = 0$.", "outputFormat": "Output a single line containing two integers: the total stones obtained by the first player and by the second player under optimal play, separated by a single space.", "hint": "Sample explanation: when both players play optimally, the piles are taken in the order $9, 2, 1, 4, 7, 3$, so the first player gets $9 + 1 + 7 = 17$ stones and the second player gets $2 + 4 + 3 = 9$ stones.\n\nConstraints:\n- For $30\\%$ of the testdata, $2 \\le N \\le 100$.\n- For $100\\%$ of the testdata, $2 \\le N \\le 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2010] 取石头游戏", "background": "", "description": "A 公司正在举办一个智力双人游戏比赛 - 取石子游戏，游戏的获胜者将会获得 A 公司提供的丰厚奖金，因此吸引了来自全国各地的许多聪明的选手前来参加比赛。\n\n与经典的取石子游戏相比，A 公司举办的这次比赛的取石子游戏规则复杂了很多：\n\n* 总共有 $N$ 堆石子依次排成一行，第 $i$ 堆石子有 $a_i$ 个石子。\n\n* 开始若干堆石子已被 A 公司故意拿走。\n\n* 然后两个玩家轮流来取石子，每次每个玩家可以取走一堆中的所有石子，但有一个限制条件：一个玩家若要取走一堆石子，则与这堆石子相邻的某堆石子已被取走(之前被某个玩家取走或开始被 A 公司故意拿走)。注意：第 $1$ 堆石子只与第 $2$ 堆石子相邻，第 $N$ 堆石子只与第 $N-1$ 堆石子相邻，其余的第 $i$ 堆石子与第 $i-1$ 堆和第 $i+1$ 堆石子相邻。\n\n* 所有石子都被取走时，游戏结束。谁最后取得的总石子数最多，谁就获得了这场游戏的胜利。\n\n作为这次比赛的参赛者之一，绝顶聪明的你，想知道对于任何一场比赛，如果先手者和后手者都使用最优的策略，最后先手者和后手者分别能够取得的总石子数分别是多少。\n", "inputFormat": "第一行是一个正整数 $N$，表示有多少堆石子。输入文件第二行是用空格隔开的 $N$ 个非负整数 $a_1, a_2,\\ldots, a_N$，其中 $a_i$ 表示第 $i$ 堆石子有多少个石子，$a_i  = 0$ 表示第 $i$ 堆石子开始被 A 公司故意拿走。输入的数据保证 $0\\leq a_i\\leq 10^8$，并且至少有一个 $i$ 使得 $a_i = 0$。", "outputFormat": "仅包含一行，为两个整数，分别表示都使用最优策略时，最后先手者和后手者各自能够取得的总石子数，并且两个整数间用一个空格隔开。\n", "hint": "样例解释：两个玩家都使用最优策略时取走石子的顺序依次为 $9, 2, 1, 4, 7, 3$，因此先手者取得 $9 + 1 + 7 = 17$ 个石子，后手者取得 $2 + 4 + 3 = 9$ 个石子。\n\n$30\\%$ 的数据满足 $2\\leq N\\leq 100$。\n\n$100\\%$ 的数据满足 $2\\leq N\\leq 10^6$。\n", "locale": "zh-CN"}}}
{"pid": "P3211", "type": "P", "difficulty": 6, "samples": [["2 2\n1 1 2\n1 2 3", "2.333"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "各省省选", "湖南", "期望", "高斯消元", "位运算"], "title": "[HNOI2011] XOR和路径", "background": "", "description": "给定一个无向连通图，其节点编号为 $1$ 到 $N$，其边的权值为非负整数。试求出一条从 $1$ 号节点到 $N$ 号节点的路径，使得该路径上经过的边的权值的“XOR 和”最大。该路径可以重复经过某些节点或边，当一条边在路径中出现多次时，其权值在计算“XOR 和”时也要被重复计算相应多的次数。\n\n\n直接求解上述问题比较困难，于是你决定使用非完美算法。具体来说，从 $1$ 号节点开始，以相等的概率，随机选择与当前节点相关联的某条边，并沿这条边走到下一个节点，重复这个过程，直到走到 $N$ 号节点为止，便得到一条从 $1$ 号节点到 $N$ 号节点的路径。显然得到每条这样的路径的概率是不同的并且每条这样的路径的“XOR 和”也不一样。现在请你求出该算法得到的路径的“XOR 和”的期望值。", "inputFormat": "输入文件的第一行是用空格隔开的两个正整数 $N$ 和 $M$，分别表示该图的节点数和边数。紧接着的 $M$ 行，每行是用空格隔开的三个非负整数 $u,v$ 和 $w$。$(1\\le u,v\\le N$，$0\\le w\\le 10^9)$，表示该图的一条边 $(u,v)$，其权值为 $w$。输入的数据保证图连通。\n", "outputFormat": "输出文件仅包含一个实数，表示上述算法得到的路径的“XOR 和”的期望值，要求保留三位小数。（建议使用精度较高的数据类型进行计算）\n", "hint": "### 样例解释\n\n有 $\\dfrac{1}{2}$ 的概率直接从 $1$ 号节点走到 $2$ 号节点，该路径的“XOR和”为 $3$；有 $\\dfrac{1}{4}$ 的概率从 $1$ 号节点走一次 $1$ 号节点的自环后走到 $2$ 号节点，该路径的“XOR和”为 $1$；有 $\\dfrac{1}{8}$ 的概率从 $1$ 号节点走两次 $1$ 号节点的自环后走到 $2$ 号节点，该路径的“XOR和”为 $3$…依此类推，可知“XOR和”的期望值为：$\\dfrac{3}{2}+\\dfrac{1}{4}+\\dfrac{3}{8}+\\dfrac{1}{16}+\\dfrac{3}{32}+\\cdots=\\dfrac{7}{3}$，约等于 $2.333$。\n\n### 数据范围\n\n- $30\\%$ 的数据满足 $N\\le 30$。  \n- $100\\%$ 的数据满足 $2\\le N\\le 100$，$M\\le 10000$，但是图中可能有重边或自环。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2011] XOR and Path", "background": "", "description": "Given an undirected connected graph with nodes labeled from $1$ to $N$, each edge has a nonnegative integer weight. Find a path from node $1$ to node $N$ that maximizes the XOR sum of the weights of the edges along the path. The path may revisit nodes or edges. If an edge appears multiple times on the path, its weight is included in the XOR sum the corresponding number of times.\n\nDirectly solving the above problem is difficult, so you decide to use an imperfect algorithm. Specifically, starting from node $1$, at each step you uniformly at random choose one edge incident to the current node and move along it to the next node. Repeat this process until you reach node $N$ to obtain a path from node $1$ to node $N$. Clearly, different such paths occur with different probabilities, and each such path has a different XOR sum. Now compute the expected value of the XOR sum of the path produced by this algorithm.", "inputFormat": "The first line contains two positive integers $N$ and $M$ separated by a space, denoting the number of nodes and the number of edges. The next $M$ lines each contain three nonnegative integers $u, v$ and $w$ ($1\\le u,v\\le N$, $0\\le w\\le 10^9$), representing an edge $(u,v)$ with weight $w$. The testdata guarantees that the graph is connected.", "outputFormat": "Output a single real number, the expected XOR sum of the path produced by the algorithm above, with three decimal places. (It is recommended to use data types with higher precision.)", "hint": "### Sample Explanation\n\nWith probability $\\dfrac{1}{2}$ you go directly from node $1$ to node $2$, and the XOR sum of this path is $3$; with probability $\\dfrac{1}{4}$ you traverse the self-loop at node $1$ once and then go to node $2$, and the XOR sum is $1$; with probability $\\dfrac{1}{8}$ you traverse the self-loop at node $1$ twice and then go to node $2$, and the XOR sum is $3$; and so on. Therefore, the expected value of the XOR sum is $\\dfrac{3}{2}+\\dfrac{1}{4}+\\dfrac{3}{8}+\\dfrac{1}{16}+\\dfrac{3}{32}+\\cdots=\\dfrac{7}{3}$, which is approximately $2.333$.\n\n### Constraints\n\n- $30\\%$ of the testdata satisfies $N\\le 30$.\n- $100\\%$ of the testdata satisfies $2\\le N\\le 100$, $M\\le 10000$, and the graph may contain multiple edges or self-loops.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2011] XOR和路径", "background": "", "description": "给定一个无向连通图，其节点编号为 $1$ 到 $N$，其边的权值为非负整数。试求出一条从 $1$ 号节点到 $N$ 号节点的路径，使得该路径上经过的边的权值的“XOR 和”最大。该路径可以重复经过某些节点或边，当一条边在路径中出现多次时，其权值在计算“XOR 和”时也要被重复计算相应多的次数。\n\n\n直接求解上述问题比较困难，于是你决定使用非完美算法。具体来说，从 $1$ 号节点开始，以相等的概率，随机选择与当前节点相关联的某条边，并沿这条边走到下一个节点，重复这个过程，直到走到 $N$ 号节点为止，便得到一条从 $1$ 号节点到 $N$ 号节点的路径。显然得到每条这样的路径的概率是不同的并且每条这样的路径的“XOR 和”也不一样。现在请你求出该算法得到的路径的“XOR 和”的期望值。", "inputFormat": "输入文件的第一行是用空格隔开的两个正整数 $N$ 和 $M$，分别表示该图的节点数和边数。紧接着的 $M$ 行，每行是用空格隔开的三个非负整数 $u,v$ 和 $w$。$(1\\le u,v\\le N$，$0\\le w\\le 10^9)$，表示该图的一条边 $(u,v)$，其权值为 $w$。输入的数据保证图连通。\n", "outputFormat": "输出文件仅包含一个实数，表示上述算法得到的路径的“XOR 和”的期望值，要求保留三位小数。（建议使用精度较高的数据类型进行计算）\n", "hint": "### 样例解释\n\n有 $\\dfrac{1}{2}$ 的概率直接从 $1$ 号节点走到 $2$ 号节点，该路径的“XOR和”为 $3$；有 $\\dfrac{1}{4}$ 的概率从 $1$ 号节点走一次 $1$ 号节点的自环后走到 $2$ 号节点，该路径的“XOR和”为 $1$；有 $\\dfrac{1}{8}$ 的概率从 $1$ 号节点走两次 $1$ 号节点的自环后走到 $2$ 号节点，该路径的“XOR和”为 $3$…依此类推，可知“XOR和”的期望值为：$\\dfrac{3}{2}+\\dfrac{1}{4}+\\dfrac{3}{8}+\\dfrac{1}{16}+\\dfrac{3}{32}+\\cdots=\\dfrac{7}{3}$，约等于 $2.333$。\n\n### 数据范围\n\n- $30\\%$ 的数据满足 $N\\le 30$。  \n- $100\\%$ 的数据满足 $2\\le N\\le 100$，$M\\le 10000$，但是图中可能有重边或自环。", "locale": "zh-CN"}}}
{"pid": "P3212", "type": "P", "difficulty": 6, "samples": [["3\n3 5 7\n1 6 1 \n2 2 6\n", "14"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["搜索", "贪心", "2011", "各省省选", "湖南", "随机化", "状压 DP"], "title": "[HNOI2011] 任务调度", "background": "", "description": "\n有 $n$ 个任务和两台机器 A 与 B。每个任务都需要既在机器 A 上执行，又在机器 B 上执行，\n\n第 $i$ 个任务需要在机器 A 上执行时间 $a_i$，且需要在机器 B 上执行时间 $b_i$。最终的目标是所有任务在 A 和 B 上都执行完，且希望执行完所有任务的总时间尽量少。当然问题没有这么简单，有些任务对于先在机器 A 上执行还是先在机器 B 上执行有一定的限制。据此可将所有任务分为三类：\n\n1. 任务必须先在机器 A 上执行完然后再在机器 B 上执行。\n2. 任务必须先在机器 B 上执行完然后再在机器 A 上执行。\n3. 任务没有限制，既可先在机器 A 上执行，也可先在机器 B 上执行。\n\n现在给定每个任务的类别和需要在机器 A 和机器 B 上分别执行的时间，问使所有任务都能按规定完成所需要的最少总时间是多少。", "inputFormat": "输入的第一行只有一个正整数 $n$，表示任务的个数。\n\n接下来的 $n$ 行，每行是用空格隔开的三个正整数 $t_i,a_i,b_i$，分别表示第 $i$ 个任务的类别（类别 $1$，$2$，$3$ 的定义如上）以及第 $i$ 个任务需要在机器 A 和机器 B 上分别执行的时间。", "outputFormat": "输出仅包含一个正整数，表示所有任务都执行完所需要的最少总时间。", "hint": "#### 样例 1 解释\n\n一种最优任务调度方案为：\n\n机器 A 上执行的各任务依次安排如下：\n\n任务 $1\\ (0\\to 5)$，任务 $2\\ (5\\to 11)$, 任务 $3\\ (11\\to 13)$；\n\n机器 B 上执行的各任务依次安排如下：\n\n任务 $3\\ (0 \\to 6)$, 任务 $1\\ (6 \\to 13)$, 任务 $2\\ (13 \\to14)$，\n\n这样，所有任务都执行完所需要的总时间为 $14$。\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 20$，$1\\le a_i\\le 10^3$，$1\\le t_i\\le 3$，并保证 $t_i=3$ 的 $i$ 不超过 $10$ 个。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2011] Task Scheduling", "background": "", "description": "There are $n$ tasks and two machines, A and B. Each task must be processed on both machines.\n\nThe $i$-th task requires time $a_i$ on machine A and time $b_i$ on machine B. The goal is to finish all tasks on both A and B while minimizing the total time to complete all tasks. However, some tasks have restrictions on whether they must be processed on A first or on B first. Based on this, all tasks are divided into three categories:\n\n1. The task must be processed on machine A first, then on machine B.\n2. The task must be processed on machine B first, then on machine A.\n3. The task has no restriction and may be processed on machine A first or on machine B first.\n\nGiven each task’s category and its processing times on machines A and B, find the minimum total time required to finish all tasks according to the rules.", "inputFormat": "The first line contains a single positive integer $n$, the number of tasks.\n\nEach of the next $n$ lines contains three space-separated positive integers $t_i, a_i, b_i$, denoting the category of task $i$ (categories $1$, $2$, and $3$ are as defined above) and the processing times of task $i$ on machines A and B, respectively.", "outputFormat": "Output a single integer, the minimum total time required to finish all tasks.", "hint": "Sample 1 Explanation:\n\nOne optimal scheduling plan is:\n\nOn machine A, schedule the tasks in order:\nTask $1\\ (0\\to 5)$, task $2\\ (5\\to 11)$, task $3\\ (11\\to 13)$;\n\nOn machine B, schedule the tasks in order:\nTask $3\\ (0 \\to 6)$, task $1\\ (6 \\to 13)$, task $2\\ (13 \\to14)$,\n\nso the total time required to finish all tasks is $14$.\n\nConstraints:\n\nFor $100\\%$ of the testdata, it is guaranteed that $1 \\le n \\le 20$, $1 \\le a_i \\le 10^3$, $1 \\le t_i \\le 3$, and the number of tasks with $t_i = 3$ does not exceed $10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2011] 任务调度", "background": "", "description": "\n有 $n$ 个任务和两台机器 A 与 B。每个任务都需要既在机器 A 上执行，又在机器 B 上执行，\n\n第 $i$ 个任务需要在机器 A 上执行时间 $a_i$，且需要在机器 B 上执行时间 $b_i$。最终的目标是所有任务在 A 和 B 上都执行完，且希望执行完所有任务的总时间尽量少。当然问题没有这么简单，有些任务对于先在机器 A 上执行还是先在机器 B 上执行有一定的限制。据此可将所有任务分为三类：\n\n1. 任务必须先在机器 A 上执行完然后再在机器 B 上执行。\n2. 任务必须先在机器 B 上执行完然后再在机器 A 上执行。\n3. 任务没有限制，既可先在机器 A 上执行，也可先在机器 B 上执行。\n\n现在给定每个任务的类别和需要在机器 A 和机器 B 上分别执行的时间，问使所有任务都能按规定完成所需要的最少总时间是多少。", "inputFormat": "输入的第一行只有一个正整数 $n$，表示任务的个数。\n\n接下来的 $n$ 行，每行是用空格隔开的三个正整数 $t_i,a_i,b_i$，分别表示第 $i$ 个任务的类别（类别 $1$，$2$，$3$ 的定义如上）以及第 $i$ 个任务需要在机器 A 和机器 B 上分别执行的时间。", "outputFormat": "输出仅包含一个正整数，表示所有任务都执行完所需要的最少总时间。", "hint": "#### 样例 1 解释\n\n一种最优任务调度方案为：\n\n机器 A 上执行的各任务依次安排如下：\n\n任务 $1\\ (0\\to 5)$，任务 $2\\ (5\\to 11)$, 任务 $3\\ (11\\to 13)$；\n\n机器 B 上执行的各任务依次安排如下：\n\n任务 $3\\ (0 \\to 6)$, 任务 $1\\ (6 \\to 13)$, 任务 $2\\ (13 \\to14)$，\n\n这样，所有任务都执行完所需要的总时间为 $14$。\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 20$，$1\\le a_i\\le 10^3$，$1\\le t_i\\le 3$，并保证 $t_i=3$ 的 $i$ 不超过 $10$ 个。", "locale": "zh-CN"}}}
{"pid": "P3213", "type": "P", "difficulty": 6, "samples": [["4\t\t\t\t\n5 12 35 5\t\n", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "各省省选", "湖南", "枚举", "连通块", "最大公约数 gcd"], "title": "[HNOI2011] 勾股定理", "background": null, "description": "沫沫最近在研究勾股定理。对于两个正整数 $A$ 与 $B$，若存在正整数 $C$ 使得 $A^2+B^2=C^2$，且 $A$ 与 $B$ 互质，则称 $(A,B)$ 为一个互质勾股数对。\n\n\n有一天，沫沫得到了 $N$ 根木棍，其长度都是正整数，她准备从中挑选出若干根木棍来玩拼图游戏，为了使拼出的图案有凌乱美，她希望挑选出的木棍中任意两根的长度均不是互质勾股数对。现在，沫沫想知道有多少种满足要求的挑选木棍的方案。由于答案可能很大，你只要输出答案对 $10^9+7$ 取模的结果。", "inputFormat": "第一行是一个正整数 $N$，表示共有多少根木棍。\n\n第二行是用空格隔开的 $N$ 个正整数 $h_1, h_2, \\cdots, h_N$，其中对 $1≤i≤N$，$h_i$ 表示第 $i$ 根木棍的长度。\n\n输入的数据保证 $30\\%$ 的数据满足对 $1≤i≤N$ 有$1≤h_i≤3000$，\n\n另外 $30\\%$ 的数据满足对 $1≤i≤N$ 有 $1≤h_i≤2\\times10^5$，\n\n剩下的 $40\\%$ 的数据满足对 $1≤i≤N$ 有 $2\\times10^4≤h_i≤10^6$，\n\n$100\\%$ 的数据满足 $N≤10^6$。", "outputFormat": "输出仅包含一个非负整数，表示满足要求的挑选木棍的方案数对 $10^9+7$ 取模的结果。", "hint": "样例解释：$(5,12)$ 与 $(12,35)$ 是互质勾股数对，故满足要求的挑选木棍的方案有 $8$ 种，即：\n\n$\\{5\\},\\{12\\},\\{35\\},\\{5\\},\\{5,35\\},\\{35,5\\},\\{5,5\\},\\{5,35,5\\}$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2011] Pythagorean Theorem", "background": "", "description": "Momo has been studying the Pythagorean Theorem. For two positive integers $A$ and $B$, if there exists a positive integer $C$ such that $A^2 + B^2 = C^2$, and $A$ and $B$ are coprime, then $(A, B)$ is called a primitive Pythagorean pair.\n\nOne day, Momo obtained $N$ sticks, each with a positive integer length. She plans to select some of these sticks to play a puzzle game. To make the pattern look artfully messy, she wants the lengths of any two selected sticks to not form a primitive Pythagorean pair. Now, Momo wants to know how many selection schemes meet the requirement. Since the answer may be large, you only need to output the result modulo $10^9 + 7$.", "inputFormat": "The first line contains a positive integer $N$, the number of sticks.\n\nThe second line contains $N$ space-separated positive integers $h_1, h_2, \\cdots, h_N$, where for $1 \\le i \\le N$, $h_i$ denotes the length of the $i$-th stick.\n\nThe testdata guarantees that:\n- For $30\\%$ of the testdata, for all $1 \\le i \\le N$, $1 \\le h_i \\le 3000$.\n- For another $30\\%$ of the testdata, for all $1 \\le i \\le N$, $1 \\le h_i \\le 2 \\times 10^5$.\n- For the remaining $40\\%$ of the testdata, for all $1 \\le i \\le N$, $2 \\times 10^4 \\le h_i \\le 10^6$.\n- For $100\\%$ of the testdata, $N \\le 10^6$.", "outputFormat": "Output a single non-negative integer, the number of valid selection schemes modulo $10^9 + 7$.", "hint": "Sample explanation: $(5, 12)$ and $(12, 35)$ are primitive Pythagorean pairs, so there are $8$ valid selection schemes, namely:\n\n$\\{5\\}, \\{12\\}, \\{35\\}, \\{5\\}, \\{5,35\\}, \\{35,5\\}, \\{5,5\\}, \\{5,35,5\\}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2011] 勾股定理", "background": null, "description": "沫沫最近在研究勾股定理。对于两个正整数 $A$ 与 $B$，若存在正整数 $C$ 使得 $A^2+B^2=C^2$，且 $A$ 与 $B$ 互质，则称 $(A,B)$ 为一个互质勾股数对。\n\n\n有一天，沫沫得到了 $N$ 根木棍，其长度都是正整数，她准备从中挑选出若干根木棍来玩拼图游戏，为了使拼出的图案有凌乱美，她希望挑选出的木棍中任意两根的长度均不是互质勾股数对。现在，沫沫想知道有多少种满足要求的挑选木棍的方案。由于答案可能很大，你只要输出答案对 $10^9+7$ 取模的结果。", "inputFormat": "第一行是一个正整数 $N$，表示共有多少根木棍。\n\n第二行是用空格隔开的 $N$ 个正整数 $h_1, h_2, \\cdots, h_N$，其中对 $1≤i≤N$，$h_i$ 表示第 $i$ 根木棍的长度。\n\n输入的数据保证 $30\\%$ 的数据满足对 $1≤i≤N$ 有$1≤h_i≤3000$，\n\n另外 $30\\%$ 的数据满足对 $1≤i≤N$ 有 $1≤h_i≤2\\times10^5$，\n\n剩下的 $40\\%$ 的数据满足对 $1≤i≤N$ 有 $2\\times10^4≤h_i≤10^6$，\n\n$100\\%$ 的数据满足 $N≤10^6$。", "outputFormat": "输出仅包含一个非负整数，表示满足要求的挑选木棍的方案数对 $10^9+7$ 取模的结果。", "hint": "样例解释：$(5,12)$ 与 $(12,35)$ 是互质勾股数对，故满足要求的挑选木棍的方案有 $8$ 种，即：\n\n$\\{5\\},\\{12\\},\\{35\\},\\{5\\},\\{5,35\\},\\{35,5\\},\\{5,5\\},\\{5,35,5\\}$。", "locale": "zh-CN"}}}
{"pid": "P3214", "type": "P", "difficulty": 6, "samples": [["2 3", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "递推", "2011", "各省省选", "湖南", "组合数学", "逆元", "快速沃尔什变换 FWT"], "title": "[HNOI2011] 卡农", "background": "", "description": "众所周知卡农是一种复调音乐的写作技法，小余在听卡农音乐时灵感大发，发明了一种新的音乐谱写规则。  \n\n他将声音分成 $n$ 个音阶，并将音乐分成若干个片段。音乐的每个片段都是由 $1$ 到 $n$ 个音阶构成的和声，即从 $n$ 个音阶中挑选若干个音阶同时演奏出来。  \n\n为了强调与卡农的不同，他规定任意两个片段所包含的音阶集合都不同。同时为了保持音乐的规律性，他还规定在一段音乐中每个音阶被奏响的次数为偶数。  \n\n现在的问题是：小余想知道包含 $m$ 个片段的音乐一共有多少种。  \n两段音乐 $a$ 和 $b$ 同种当且仅当将 $a$ 的片段重新排列后可以得到 $b$。例如：假设 $a$ 为 $\\{\\{1,2\\},\\{2,3\\}\\}$，$b$ 为 $\\{\\{2,3\\},\\{1,2\\}\\}$，那么 $a$ 与 $b$ 就是同种音乐。\n\n答案对 $10^8+7$ 取模。\n\n", "inputFormat": "仅一行两个正整数 $n,m$\n", "outputFormat": "输出一行一个整数表示答案。", "hint": "【数据范围】  \n对于 $20\\%$ 的数据，$1\\le n,m \\le 5$；   \n对于 $50\\%$ 的数据，$1\\le n,m \\le 3000$；  \n对于 $100\\%$ 的数据，$1\\le n,m \\le 10^6$。 \n\n【样例解释】   \n音乐为 $\\{\\{1\\},\\{2\\},\\{1,2\\}\\}$\n", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2011] Canon", "background": "", "description": "As is well known, a canon is a polyphonic composition technique. While listening to canons, Xiao Yu had a burst of inspiration and invented a new rule for writing music.\n\nHe divides the sounds into $n$ notes and splits the music into several segments. Each segment is a harmony composed of $1$ to $n$ notes, i.e., selecting some of the $n$ notes to play simultaneously.\n\nTo distinguish it from canons, he stipulates that the set of notes contained in any two segments must be different. To maintain regularity, he also requires that in one piece of music each note is sounded an even number of times across all segments.\n\nNow the question is: how many pieces of music consisting of $m$ segments are there? Two pieces of music $a$ and $b$ are considered the same if and only if $b$ can be obtained by reordering the segments of $a$. For example, suppose $a$ is $\\{\\{1,2\\},\\{2,3\\}\\}$ and $b$ is $\\{\\{2,3\\},\\{1,2\\}\\}$, then $a$ and $b$ are the same music.\n\nThe answer should be taken modulo $10^8+7$.", "inputFormat": "One line containing two positive integers $n, m$.", "outputFormat": "Output one line with a single integer representing the answer.", "hint": "Constraints  \nFor $20\\%$ of the testdata, $1 \\le n, m \\le 5$.  \nFor $50\\%$ of the testdata, $1 \\le n, m \\le 3000$.  \nFor $100\\%$ of the testdata, $1 \\le n, m \\le 10^6$.\n\nSample Explanation  \nThe music is $\\{\\{1\\},\\{2\\},\\{1,2\\}\\}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2011] 卡农", "background": "", "description": "众所周知卡农是一种复调音乐的写作技法，小余在听卡农音乐时灵感大发，发明了一种新的音乐谱写规则。  \n\n他将声音分成 $n$ 个音阶，并将音乐分成若干个片段。音乐的每个片段都是由 $1$ 到 $n$ 个音阶构成的和声，即从 $n$ 个音阶中挑选若干个音阶同时演奏出来。  \n\n为了强调与卡农的不同，他规定任意两个片段所包含的音阶集合都不同。同时为了保持音乐的规律性，他还规定在一段音乐中每个音阶被奏响的次数为偶数。  \n\n现在的问题是：小余想知道包含 $m$ 个片段的音乐一共有多少种。  \n两段音乐 $a$ 和 $b$ 同种当且仅当将 $a$ 的片段重新排列后可以得到 $b$。例如：假设 $a$ 为 $\\{\\{1,2\\},\\{2,3\\}\\}$，$b$ 为 $\\{\\{2,3\\},\\{1,2\\}\\}$，那么 $a$ 与 $b$ 就是同种音乐。\n\n答案对 $10^8+7$ 取模。\n\n", "inputFormat": "仅一行两个正整数 $n,m$\n", "outputFormat": "输出一行一个整数表示答案。", "hint": "【数据范围】  \n对于 $20\\%$ 的数据，$1\\le n,m \\le 5$；   \n对于 $50\\%$ 的数据，$1\\le n,m \\le 3000$；  \n对于 $100\\%$ 的数据，$1\\le n,m \\le 10^6$。 \n\n【样例解释】   \n音乐为 $\\{\\{1\\},\\{2\\},\\{1,2\\}\\}$\n", "locale": "zh-CN"}}}
{"pid": "P3215", "type": "P", "difficulty": 6, "samples": [["4 5\n((((\nReplace 1 2 )\nQuery 1 2\nSwap 2 3\nInvert 3 4\nQuery 1 4", "1\n2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["字符串", "2011", "各省省选", "平衡树", "江苏", "湖南"], "title": "[HNOI2011] 括号修复 / [JSOI2011] 括号序列", "background": null, "description": "一个合法的括号序列是这样定义的：\n\n1.    空串是合法的。\n2.    如果字符串 `S` 是合法的，则`(S)`也是合法的。\n3.    如果字符串 `A` 和 `B` 是合法的，则 `AB` 也是合法的。\n\n现在给你一个长度为 $n$ 的由`(`和`)`组成的字符串，位置标号从 $1$ 到 $n$。对这个字符串有下列四种操作：\n\n\n-  `Replace a b c`：将 $[a,b]$ 之间的所有括号改成 $c$。假设原来的字符串为：`))())())(`，那么执行操作 `Replace 2 7 (`  后原来的字符串变为：`)(((((()(`。\n\n-  `Swap a b`：将 $[a,b]$ 之间的字符串翻转。假设原来的字符串为：`))())())(`，那么执行操作 `Swap 3 5` 后原来的字符串变为：`))))(())(`。\n\n-  `Invert a b`：将 $[a,b]$ 之间的 `(` 变成 `)` ，`)` 变成 `(`。假设原来的字符串为：`))())())(`，那么执行操作 `Invert 4 8` 后原来的字符串变为：`))((()(((`。\n\n-  `Query a b`：询问 $[a,b]$ 之间的字符串至少要改变多少位才能变成合法的括号序列。改变某位是指将该位的 `(` 变成 `)` 或 `)` 变成 `(`。注意执行操作 `Query` 并不改变当前的括号序列。假设原来的字符串为：`))())())(`，那么执行操作 `Query 3 6` 的结果为 $2$，因为要将位置 $5$ 的`)`变成`(`并将位置 $6$ 的`(`变成`)`。", "inputFormat": "输入文件的第一行是用空格隔开的两个正整数 $n,q$，分别表示字符串的长度和将执行的操作个数。  \n\n第二行是长度为 $n$ 的初始字符串 $S$。接下来的 $q$ 行是将依次执行的 $q$ 个操作，其中操作名与操作数之间以及相邻操作数之间均用空格隔开。", "outputFormat": "对于每个 `Query` 操作，输出一行一个整数表示答案。输入数据保证有解。", "hint": "### 样例解释\n\n输入中有 $2$ 个 `Query` 操作，所以输出有 $2$ 行。   \n执行第一个 `Query` 操作时的括号序列为 `))((`，因改变第 $1$ 位可使 $[1,2]$ 之间的字符串变成合法的括号序列，故输出的第一行为 `1`。  \n\n执行第二个 `Query` 操作时的括号序列为 `)(()`，因要改变第 $1$ 位和第 $2$ 位才能使 $[1,4]$ 之间的字符串变成合法的括号序列，故输出的第二行为 `2`。\n\n### 数据范围\n\n对于 $30\\%$ 的数据，$1\\le n,q \\le 3000$；   \n对于 $100\\%$ 的数据，$1\\le n,q \\le 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2011] Bracket Repair / [JSOI2011] Bracket Sequence", "background": "", "description": "A valid parenthesis sequence is defined as follows:\n\n1. The empty string is valid.\n2. If string `S` is valid, then `(S)` is also valid.\n3. If strings `A` and `B` are valid, then `AB` is also valid.\n\nYou are given a string of length $n$ consisting of `(` and `)`, with positions numbered from $1$ to $n$. The following four operations are supported on this string:\n\n- `Replace a b c`: change all parentheses in $[a, b]$ to $c$. For example, given the original string `))())())(`, after performing `Replace 2 7 (`, it becomes `)(((((()(`.\n\n- `Swap a b`: reverse the substring in $[a, b]$. For example, given the original string `))())())(`, after performing `Swap 3 5`, it becomes `))))(())(`.\n\n- `Invert a b`: flip `(` to `)` and `)` to `(` within $[a, b]$. For example, given the original string `))())())(`, after performing `Invert 4 8`, it becomes `))((()(((`.\n\n- `Query a b`: ask for the minimum number of positions in $[a, b]$ that must be changed to make the substring a valid parenthesis sequence. Changing a position means turning `(` into `)` or `)` into `(`. Note that `Query` does not modify the current sequence. For example, given the original string `))())())(`, the result of `Query 3 6` is $2$, because you need to change position $5$ from `)` to `(` and position $6$ from `(` to `)`.", "inputFormat": "The first line contains two space-separated positive integers $n, q$, denoting the length of the string and the number of operations, respectively.  \nThe second line contains the initial string $S$ of length $n$. The next $q$ lines each describe one operation to be performed in order. The operation name and its parameters are separated by single spaces.", "outputFormat": "For each `Query` operation, output a single line with one integer representing the answer. The input is guaranteed to be solvable.", "hint": "Sample Explanation:\n\nThere are $2$ `Query` operations in the input, so the output has $2$ lines.  \nWhen executing the first `Query`, the parenthesis sequence is `))((`. By changing position $1$, the substring over $[1, 2]$ becomes a valid parenthesis sequence, so the first output line is `1`.\n\nWhen executing the second `Query`, the parenthesis sequence is `)(()`. You need to change position $1$ and position $2$ to make the substring over $[1, 4]$ a valid parenthesis sequence, so the second output line is `2`.\n\nConstraints:\n\nFor $30\\%$ of the points, $1 \\le n, q \\le 3000$.  \nFor $100\\%$ of the points, $1 \\le n, q \\le 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2011] 括号修复 / [JSOI2011] 括号序列", "background": null, "description": "一个合法的括号序列是这样定义的：\n\n1.    空串是合法的。\n2.    如果字符串 `S` 是合法的，则`(S)`也是合法的。\n3.    如果字符串 `A` 和 `B` 是合法的，则 `AB` 也是合法的。\n\n现在给你一个长度为 $n$ 的由`(`和`)`组成的字符串，位置标号从 $1$ 到 $n$。对这个字符串有下列四种操作：\n\n\n-  `Replace a b c`：将 $[a,b]$ 之间的所有括号改成 $c$。假设原来的字符串为：`))())())(`，那么执行操作 `Replace 2 7 (`  后原来的字符串变为：`)(((((()(`。\n\n-  `Swap a b`：将 $[a,b]$ 之间的字符串翻转。假设原来的字符串为：`))())())(`，那么执行操作 `Swap 3 5` 后原来的字符串变为：`))))(())(`。\n\n-  `Invert a b`：将 $[a,b]$ 之间的 `(` 变成 `)` ，`)` 变成 `(`。假设原来的字符串为：`))())())(`，那么执行操作 `Invert 4 8` 后原来的字符串变为：`))((()(((`。\n\n-  `Query a b`：询问 $[a,b]$ 之间的字符串至少要改变多少位才能变成合法的括号序列。改变某位是指将该位的 `(` 变成 `)` 或 `)` 变成 `(`。注意执行操作 `Query` 并不改变当前的括号序列。假设原来的字符串为：`))())())(`，那么执行操作 `Query 3 6` 的结果为 $2$，因为要将位置 $5$ 的`)`变成`(`并将位置 $6$ 的`(`变成`)`。", "inputFormat": "输入文件的第一行是用空格隔开的两个正整数 $n,q$，分别表示字符串的长度和将执行的操作个数。  \n\n第二行是长度为 $n$ 的初始字符串 $S$。接下来的 $q$ 行是将依次执行的 $q$ 个操作，其中操作名与操作数之间以及相邻操作数之间均用空格隔开。", "outputFormat": "对于每个 `Query` 操作，输出一行一个整数表示答案。输入数据保证有解。", "hint": "### 样例解释\n\n输入中有 $2$ 个 `Query` 操作，所以输出有 $2$ 行。   \n执行第一个 `Query` 操作时的括号序列为 `))((`，因改变第 $1$ 位可使 $[1,2]$ 之间的字符串变成合法的括号序列，故输出的第一行为 `1`。  \n\n执行第二个 `Query` 操作时的括号序列为 `)(()`，因要改变第 $1$ 位和第 $2$ 位才能使 $[1,4]$ 之间的字符串变成合法的括号序列，故输出的第二行为 `2`。\n\n### 数据范围\n\n对于 $30\\%$ 的数据，$1\\le n,q \\le 3000$；   \n对于 $100\\%$ 的数据，$1\\le n,q \\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P3216", "type": "P", "difficulty": 5, "samples": [["13 13", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "递推", "2011", "各省省选", "湖南", "矩阵乘法"], "title": "[HNOI2011] 数学作业", "background": "", "description": "小 C 数学成绩优异，于是老师给小 C 留了一道非常难的数学作业题：\n\n给定正整数 $n,m$，要求计算 $\\text{Concatenate}(n) \\bmod \\ m$  的值，其中 $\\text{Concatenate}(n)$ 是将 $1 \\sim n$ 所有正整数 顺序连接起来得到的数。\n\n例如，$n = 13$，$\\text{Concatenate}(n) = 12345678910111213$。小 C 想了大半天终于意识到这是一道不可能手算出来的题目，于是他只好向你求助，希望你能编写一个程序帮他解决这个问题。\n\n", "inputFormat": "一行两个正整数 $n,m$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "【数据范围】\n\n对于 $30\\%$ 的数据，$1\\le n \\le 10^6$；  \n对于 $100\\%$ 的数据，$1\\le n \\le 10^{18}$，$1\\le m \\le 10^9$。\n\n- 2023.4.20 添加一组 hack 数据。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2011] Math Homework", "background": "", "description": "Xiao C excels in math, so the teacher assigned him a very difficult math homework problem:\n\nGiven positive integers $n,m$, compute $\\text{Concatenate}(n) \\bmod \\ m$, where $\\text{Concatenate}(n)$ is the number obtained by concatenating all positive integers $1 \\sim n$ in order.\n\nFor example, $n = 13$, $\\text{Concatenate}(n) = 12345678910111213$. After thinking for a long time, Xiao C realized that this problem is impossible to work out by hand, so he asks you to write a program to solve it for him.", "inputFormat": "One line with two positive integers $n,m$.", "outputFormat": "Output one integer on a single line representing the answer.", "hint": "Constraints\n\nFor $30\\%$ of the testdata, $1\\le n \\le 10^6$.  \nFor $100\\%$ of the testdata, $1\\le n \\le 10^{18}$, $1\\le m \\le 10^9$.\n\n- On 2023.4.20, one set of hack testdata was added.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2011] 数学作业", "background": "", "description": "小 C 数学成绩优异，于是老师给小 C 留了一道非常难的数学作业题：\n\n给定正整数 $n,m$，要求计算 $\\text{Concatenate}(n) \\bmod \\ m$  的值，其中 $\\text{Concatenate}(n)$ 是将 $1 \\sim n$ 所有正整数 顺序连接起来得到的数。\n\n例如，$n = 13$，$\\text{Concatenate}(n) = 12345678910111213$。小 C 想了大半天终于意识到这是一道不可能手算出来的题目，于是他只好向你求助，希望你能编写一个程序帮他解决这个问题。\n\n", "inputFormat": "一行两个正整数 $n,m$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "【数据范围】\n\n对于 $30\\%$ 的数据，$1\\le n \\le 10^6$；  \n对于 $100\\%$ 的数据，$1\\le n \\le 10^{18}$，$1\\le m \\le 10^9$。\n\n- 2023.4.20 添加一组 hack 数据。", "locale": "zh-CN"}}}
{"pid": "P3217", "type": "P", "difficulty": 6, "samples": [["8\n-2 3\n-2 -1\n0 3\n0 -1\n1 -1\n2 1 \n-3 1 \n-2 1\n", "10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["计算几何", "2011", "各省省选", "湖南", "枚举", "排序"], "title": "[HNOI2011] 数矩形", "background": null, "description": "最近某歌手在研究自己的全球巡回演出计划，他将所有心仪的城市都用平面上的一个点来表示，并打算从中挑选出 $4$ 个城市作为这次巡回演出的地点。\n\n为了显示自己与众不同，他要求存在一个矩形使得挑选出的 $4$ 个点恰好是这个矩形的 $4$ 个顶点，并且希望这个矩形的面积最大。\n\n这可急坏了其经纪人，于是他向全球歌迷征集方案，当然你这位歌迷一定不会错过这个机会。", "inputFormat": "输入的第一行是一个正整数 $N$，表示平面上点的个数（即歌手心仪的城市数）。接下来的 $N$ 行，每行是由空格隔开的两个整数 $X_i$ 和 $Y_i$，表示城市的坐标。", "outputFormat": "输出仅包含一个非负整数，表示最大的矩形面积。", "hint": "- $20\\%$ 的数据满足 $N\\leq 500$\n- $100\\%$ 的数据满足 $N\\leq 1500$，$-10^8\\leq X_i,Y_i\\leq 10^8$\n\n输入数据保证答案存在。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2011] Counting Rectangles", "background": "", "description": "A certain singer is planning a world tour. He represents each city he likes as a point on the plane and plans to select $4$ cities as the tour stops.\n\nTo be unique, he requires that there exists a rectangle such that the selected $4$ points are exactly the $4$ vertices of this rectangle, and he wants the area of this rectangle to be as large as possible.\n\nThis worries his agent, so he asks fans worldwide for solutions. Of course, you will not miss this opportunity.", "inputFormat": "The first line contains a positive integer $N$, the number of points on the plane (i.e., the number of cities the singer likes). The next $N$ lines each contain two integers $X_i$ and $Y_i$, separated by a space, representing the coordinates of a city.", "outputFormat": "Output a single non-negative integer, the maximum area of such a rectangle.", "hint": "- 20% of the testdata satisfies $N \\leq 500$.\n- 100% of the testdata satisfies $N \\leq 1500$, $-10^8 \\leq X_i, Y_i \\leq 10^8$.\n- The input guarantees that an answer exists.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2011] 数矩形", "background": null, "description": "最近某歌手在研究自己的全球巡回演出计划，他将所有心仪的城市都用平面上的一个点来表示，并打算从中挑选出 $4$ 个城市作为这次巡回演出的地点。\n\n为了显示自己与众不同，他要求存在一个矩形使得挑选出的 $4$ 个点恰好是这个矩形的 $4$ 个顶点，并且希望这个矩形的面积最大。\n\n这可急坏了其经纪人，于是他向全球歌迷征集方案，当然你这位歌迷一定不会错过这个机会。", "inputFormat": "输入的第一行是一个正整数 $N$，表示平面上点的个数（即歌手心仪的城市数）。接下来的 $N$ 行，每行是由空格隔开的两个整数 $X_i$ 和 $Y_i$，表示城市的坐标。", "outputFormat": "输出仅包含一个非负整数，表示最大的矩形面积。", "hint": "- $20\\%$ 的数据满足 $N\\leq 500$\n- $100\\%$ 的数据满足 $N\\leq 1500$，$-10^8\\leq X_i,Y_i\\leq 10^8$\n\n输入数据保证答案存在。", "locale": "zh-CN"}}}
{"pid": "P3218", "type": "P", "difficulty": 6, "samples": [["3\n10.0 1.0 150 0.0\n1\n100.0 -100.0\n10.0 100.0 150 1.0\n2\n100 0\n100 100\n0.5 0.1 100 10\n3\n1000 0\n100 10\n100 -10", "1.41421\nIMPOSSIBLE\n0.07212"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "各省省选", "湖南"], "title": "[HNOI2011] 赛车游戏", "background": "", "description": "名歌手LAALA最近迷上了一款赛车游戏，游戏中开车的玩家在不同的路段需要选择不同的速度，使得自己在最短的时间内到达终点。开始游戏时，车内的初始油量为f，所以游戏的关键是如何在速度和耗油量之间实现平衡。\n\n\nLAALA 经过一段时间的研究后，发现这款游戏可以用一个简单的数学模型来描述，具体来说：从起点到终点的路线可以被简化成折线段，每条线段代表一个上坡或者下坡，若在一段斜率为 s(s>0 代表上坡，s=0 代表平地，s<0 代表下坡)的道路上以速度 v km/h 行驶，则每公里的耗油量为 max(0,av+bs)，其中 a 和 b 为游戏的内置参数，分别表示在平地行驶时的耗油率及斜坡对耗油量的影响(b 恒为正)。这里假设，加速和减速不耗油，且看成是瞬间完成的，所以即使在同一条线段上也可采取以不同的速度行驶的策略来缩短耗费的时间。\n\n\n由于 LAALA 在以前的游戏中表现不佳，现在使用的车型依然是系统初始分配的，所以它的速度不能超过 vmax km/h。在获得这些参数后，LAALA 想知道在初始油量受限的情况下（中途不许加油）自己能得到的最佳成绩是多少。作为 LAALA 的歌迷，你能帮帮他吗?\n", "inputFormat": "从文件input.txt中读入数据，输入文件的第一行是一个正整数T，表示数据组数。对每组数据，第一行是用空格隔开的4个浮点数a、b、vmax和f，其中a、b和vmax的意义如前所述，f表示初始油量，其单位也与前面的描述保持一致。第二行是一个正整数r，表示线段的数目。接下来的r行，每行是用空格隔开的2个浮点数xi和yi，分别表示在标准笛卡耳坐标系下该线段在水平方向和垂直方向的改变量(单位为米)。\n", "outputFormat": "输出文件 output.txt 包含 T 行，依次对应输入中的 T 组数据。对某组数据，若基于初始油量无法到达终点，则对应行输出 IMPOSSIBLE，否则输出最少需要的时间(单位为小时)。\n", "hint": "【数据范围】\n\n\n100%的数据满足 T≤100,0.1≤a≤100,0.1≤b≤100,10≤vmax≤200,0≤f≤50,r≤10000,1≤xi≤1000,-1000≤yi≤1000，且如果问题有解，那么答案不超过 24。\n\n\n你所输出的答案需要恰好保留到小数点后 5 位,当且仅当你的输出与标准答案完全一致时你的输出才被视作正确。\n\n", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2011] Racing Game", "background": "", "description": "The famous singer LAALA recently got hooked on a racing game. In the game, the driver must choose different speeds on different road segments to reach the finish in the shortest possible time. At the start, the car has initial fuel amount $f$, so the key is to balance speed and fuel consumption.\n\nAfter some study, LAALA found that the game can be described by a simple mathematical model. The route from start to finish is simplified into a polyline, where each line segment represents an uphill or a downhill. If you drive on a road segment with slope $s$ ($s > 0$ means uphill, $s = 0$ means flat, $s < 0$ means downhill) at speed $v$ km/h, then the fuel consumption per kilometer is $\\max(0, a v + b s)$, where $a$ and $b$ are built-in parameters of the game, representing the fuel consumption rate on flat ground and the effect of slope on fuel consumption, respectively (with $b$ always positive). It is assumed that accelerating and decelerating consume no fuel and are instantaneous, so you may adopt different speeds even within the same segment to reduce the total time.\n\nBecause LAALA has not performed well in previous games, the current car is still the initial one assigned by the system, so its speed cannot exceed vmax km/h. Given these parameters, LAALA wants to know the best result possible under limited initial fuel (no refueling on the way). As a fan of LAALA, can you help?", "inputFormat": "The first line contains a positive integer $T$, the number of test cases.\n\nFor each test case:\n- The first line contains four floating-point numbers $a$, $b$, vmax, and $f$, where $a$, $b$, and vmax are as described above, and $f$ is the initial fuel amount (units consistent with the description above).\n- The second line contains a positive integer $r$, the number of line segments.\n- Each of the next $r$ lines contains two floating-point numbers $x_i$ and $y_i$, denoting the changes in the horizontal and vertical directions (in meters) of that segment in the standard Cartesian coordinate system.", "outputFormat": "Output $T$ lines, corresponding to the $T$ test cases in order. For a test case, if the finish cannot be reached with the given initial fuel, output IMPOSSIBLE. Otherwise, output the minimum required time in hours.", "hint": "Constraints:\n\nFor 100% of the testdata, $T \\le 100$, $0.1 \\le a \\le 100$, $0.1 \\le b \\le 100$, $10 \\le \\text{vmax} \\le 200$, $0 \\le f \\le 50$, $r \\le 10000$, $1 \\le x_i \\le 1000$, $-1000 \\le y_i \\le 1000$, and if the problem has a solution, the answer does not exceed $24$.\n\nYour output must have exactly 5 digits after the decimal point. Your output is considered correct if and only if it matches the standard answer exactly.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2011] 赛车游戏", "background": "", "description": "名歌手LAALA最近迷上了一款赛车游戏，游戏中开车的玩家在不同的路段需要选择不同的速度，使得自己在最短的时间内到达终点。开始游戏时，车内的初始油量为f，所以游戏的关键是如何在速度和耗油量之间实现平衡。\n\n\nLAALA 经过一段时间的研究后，发现这款游戏可以用一个简单的数学模型来描述，具体来说：从起点到终点的路线可以被简化成折线段，每条线段代表一个上坡或者下坡，若在一段斜率为 s(s>0 代表上坡，s=0 代表平地，s<0 代表下坡)的道路上以速度 v km/h 行驶，则每公里的耗油量为 max(0,av+bs)，其中 a 和 b 为游戏的内置参数，分别表示在平地行驶时的耗油率及斜坡对耗油量的影响(b 恒为正)。这里假设，加速和减速不耗油，且看成是瞬间完成的，所以即使在同一条线段上也可采取以不同的速度行驶的策略来缩短耗费的时间。\n\n\n由于 LAALA 在以前的游戏中表现不佳，现在使用的车型依然是系统初始分配的，所以它的速度不能超过 vmax km/h。在获得这些参数后，LAALA 想知道在初始油量受限的情况下（中途不许加油）自己能得到的最佳成绩是多少。作为 LAALA 的歌迷，你能帮帮他吗?\n", "inputFormat": "从文件input.txt中读入数据，输入文件的第一行是一个正整数T，表示数据组数。对每组数据，第一行是用空格隔开的4个浮点数a、b、vmax和f，其中a、b和vmax的意义如前所述，f表示初始油量，其单位也与前面的描述保持一致。第二行是一个正整数r，表示线段的数目。接下来的r行，每行是用空格隔开的2个浮点数xi和yi，分别表示在标准笛卡耳坐标系下该线段在水平方向和垂直方向的改变量(单位为米)。\n", "outputFormat": "输出文件 output.txt 包含 T 行，依次对应输入中的 T 组数据。对某组数据，若基于初始油量无法到达终点，则对应行输出 IMPOSSIBLE，否则输出最少需要的时间(单位为小时)。\n", "hint": "【数据范围】\n\n\n100%的数据满足 T≤100,0.1≤a≤100,0.1≤b≤100,10≤vmax≤200,0≤f≤50,r≤10000,1≤xi≤1000,-1000≤yi≤1000，且如果问题有解，那么答案不超过 24。\n\n\n你所输出的答案需要恰好保留到小数点后 5 位,当且仅当你的输出与标准答案完全一致时你的输出才被视作正确。\n\n", "locale": "zh-CN"}}}
{"pid": "P3219", "type": "P", "difficulty": 6, "samples": [["3\n1 1 4\n2 0 2\n3 2 2", "11.0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["计算几何", "2012", "各省省选", "平衡树", "湖南", "枚举"], "title": "[HNOI2012] 三角形覆盖问题", "background": null, "description": "二维平面中，给定 $N$ 个等腰直角三角形（每个三角形的两条直角边分别平行于坐标轴，斜边从左上到右下）。我们用三个非负整数 $(x,y,d)$ 来描述这样一个三角形，三角形三个顶点的坐标分别为 $(x,y)$，$(x+d,y)$ 和 $(x,y+d)$。要求计算这 $N$ 个三角形所覆盖的总面积。例如，下图有 $3$ 个三角形，覆盖的总面积为 $11.0$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1459ccln.png)", "inputFormat": "输入文件第一行为一个正整数 $N$，表示三角形的个数。\n\n接下来的 $N$ 行每行有用空格隔开的三个非负整数 $x,y,d$，描述一个三角形的顶点坐标，分别为 $(x,y)$，$(x+d,y)$，$(x,y+d)$，其中 $x,y,d$ 满足 $0 \\le x,y,d \\le 10^6$。", "outputFormat": "仅包含一行，为一个实数 $S$，表示所有三角形所覆盖的总面积，输出恰好保留一位小数。输入数据保证 $S \\le 2^{31}$。", "hint": "对于 $50\\%$ 的数据，$1 \\le N \\le 500$；\\\n对于 $100\\%$ 的数据，$1 \\le N \\le 10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2012] Triangle Coverage Problem", "background": "", "description": "In the two-dimensional plane, you are given $N$ isosceles right triangles (each triangle’s two legs are parallel to the coordinate axes, and the hypotenuse goes from top-left to bottom-right). We use three non-negative integers $(x, y, d)$ to describe such a triangle. The coordinates of its three vertices are $(x, y)$, $(x+d, y)$, and $(x, y+d)$. Compute the total area covered by these $N$ triangles. For example, in the figure below, there are $3$ triangles, and the total covered area is $11.0$.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1459ccln.png)", "inputFormat": "The first line contains a positive integer $N$, indicating the number of triangles.\nEach of the next $N$ lines contains three space-separated non-negative integers $x, y, d$, describing a triangle whose vertices are $(x, y)$, $(x+d, y)$, and $(x, y+d)$, where $x, y, d$ satisfy $0 \\le x, y, d \\le 10^6$.", "outputFormat": "Output a single line containing a real number $S$, the total area covered by all triangles, with exactly one decimal place. It is guaranteed that $S \\le 2^{31}$.", "hint": "For $50\\%$ of the testdata, $1 \\le N \\le 500$.\nFor $100\\%$ of the testdata, $1 \\le N \\le 10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2012] 三角形覆盖问题", "background": null, "description": "二维平面中，给定 $N$ 个等腰直角三角形（每个三角形的两条直角边分别平行于坐标轴，斜边从左上到右下）。我们用三个非负整数 $(x,y,d)$ 来描述这样一个三角形，三角形三个顶点的坐标分别为 $(x,y)$，$(x+d,y)$ 和 $(x,y+d)$。要求计算这 $N$ 个三角形所覆盖的总面积。例如，下图有 $3$ 个三角形，覆盖的总面积为 $11.0$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1459ccln.png)", "inputFormat": "输入文件第一行为一个正整数 $N$，表示三角形的个数。\n\n接下来的 $N$ 行每行有用空格隔开的三个非负整数 $x,y,d$，描述一个三角形的顶点坐标，分别为 $(x,y)$，$(x+d,y)$，$(x,y+d)$，其中 $x,y,d$ 满足 $0 \\le x,y,d \\le 10^6$。", "outputFormat": "仅包含一行，为一个实数 $S$，表示所有三角形所覆盖的总面积，输出恰好保留一位小数。输入数据保证 $S \\le 2^{31}$。", "hint": "对于 $50\\%$ 的数据，$1 \\le N \\le 500$；\\\n对于 $100\\%$ 的数据，$1 \\le N \\le 10^4$。", "locale": "zh-CN"}}}
{"pid": "P3220", "type": "P", "difficulty": 6, "samples": [["3  3 1 4\n3  4 5", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "并查集", "各省省选", "湖南", "位运算", "构造"], "title": "[HNOI2012] 与非", "background": "如果你能提供题面或者题意简述，请直接在讨论区发帖，感谢你的贡献。\n", "description": "NAND（与非）是一种二元逻辑运算，其运算结果为真当且仅当两个输入的布尔值不全为真。NAND运算的真值表如下（1表示真，0表示假）:\n\n ![](https://cdn.luogu.com.cn/upload/pic/7851.png) \n\n两个非负整数的NAND是指将它们表示成二进制数，再在对应的二进制位进行NAND运算。由于两个二进制数的长度可能不等，因此一般约定一个最高位K，使得两个数的二进制表示都不 超过K位，不足K位的在高位补零。给定N个非负整数A1,A2......AN和约定位数K，利用NAND运算与括号，每个数可以使用任意次，请你求出范围[L,R]内可以被计算出的数有多少个。\n", "inputFormat": "输入文件第一行是用空格隔开的四个正整数N，K，L和R，接下来的一行是N个非负整数A1,A2......AN，其含义如上所述。 100%的数据满足K<=60且N<=1000,0<=Ai<=2^k-1,0<=L<=R<=10^18\n", "outputFormat": "仅包含一个整数，表示[L,R]内可以被计算出的数的个数\n", "hint": "样例1中，(3 NAND 4) NAND (3 NAND 5) = 1，5 NAND 5 = 2，3和4直接可得。\n", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2012] NAND", "background": "If you can provide the full statement or a brief description of the problem, please post it directly in the discussion area. Thank you for your contribution.", "description": "NAND is a binary logical operation whose result is true if and only if the two input Boolean values are not both true. The truth table of the NAND operation is as follows (1 denotes true, 0 denotes false):\n\n![](https://cdn.luogu.com.cn/upload/pic/7851.png)\n\nThe NAND of two non-negative integers means writing them in binary and then applying the NAND operation bitwise on corresponding binary digits. Since the lengths of the two binary numbers may differ, we generally fix a most significant bit limit $K$ so that the binary representations of both numbers do not exceed $K$ bits; numbers shorter than $K$ bits are padded with leading zeros on the left.\n\nGiven $N$ non-negative integers $A_1, A_2, \\ldots, A_N$ and the designated bit-length $K$, using NAND operations and parentheses, where each number may be used any number of times, please determine how many numbers in the range $[L, R]$ can be obtained.", "inputFormat": "The first line contains four positive integers $N$, $K$, $L$, and $R$ separated by spaces.  \nThe second line contains $N$ non-negative integers $A_1, A_2, \\ldots, A_N$, as described above.\n\nConstraints: $K \\le 60$ and $N \\le 1000$, $0 \\le A_i \\le 2^K - 1$, $0 \\le L \\le R \\le 10^{18}$.", "outputFormat": "Output a single integer, the number of values in $[L, R]$ that can be computed.", "hint": "In Sample 1, $(3 \\text{ NAND } 4) \\text{ NAND } (3 \\text{ NAND } 5) = 1$, $5 \\text{ NAND } 5 = 2$, and $3$ and $4$ can be obtained directly.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2012] 与非", "background": "如果你能提供题面或者题意简述，请直接在讨论区发帖，感谢你的贡献。\n", "description": "NAND（与非）是一种二元逻辑运算，其运算结果为真当且仅当两个输入的布尔值不全为真。NAND运算的真值表如下（1表示真，0表示假）:\n\n ![](https://cdn.luogu.com.cn/upload/pic/7851.png) \n\n两个非负整数的NAND是指将它们表示成二进制数，再在对应的二进制位进行NAND运算。由于两个二进制数的长度可能不等，因此一般约定一个最高位K，使得两个数的二进制表示都不 超过K位，不足K位的在高位补零。给定N个非负整数A1,A2......AN和约定位数K，利用NAND运算与括号，每个数可以使用任意次，请你求出范围[L,R]内可以被计算出的数有多少个。\n", "inputFormat": "输入文件第一行是用空格隔开的四个正整数N，K，L和R，接下来的一行是N个非负整数A1,A2......AN，其含义如上所述。 100%的数据满足K<=60且N<=1000,0<=Ai<=2^k-1,0<=L<=R<=10^18\n", "outputFormat": "仅包含一个整数，表示[L,R]内可以被计算出的数的个数\n", "hint": "样例1中，(3 NAND 4) NAND (3 NAND 5) = 1，5 NAND 5 = 2，3和4直接可得。\n", "locale": "zh-CN"}}}
{"pid": "P3221", "type": "P", "difficulty": 6, "samples": [["6  8\n12\n1  2\n1  3\n1  4\n1  6\n2  2\n3  2\n3  3\n3  4\n3  7\n6  4\n6  6\n4  8", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "各省省选", "湖南"], "title": "[HNOI2012] 双十字", "background": "", "description": "在 C 部落，双十字是非常重要的一个部落标志。所谓双十字，如下面两个例子，由两条水平的和一条竖直的 `1` 线段组成：\n\n```\n..........\n....1.....      ..1..\n..11111...      .111.\n....1.....      ..1..\n.1111111..      11111\n....1.....      ..1..\n....1.....\n..........\n```\n\n合法的双十字要求满足以下几个限制：\n- 两条水平的线段不能在相邻的两行。\n- 竖直线段上端必须严格高于两条水平线段，下端必须严格低于两条水平线段。\n- 竖直线段必须将两条水平线段严格划分成相等的两半。\n- 上方的水平线段必须严格短于下方的水平线段。\n\n所以上面右边的例子是满足要求的最小的双十字。\n\n现在给定一个 $R\\times C$ 的 `01` 矩阵，要求计算出这个 `01` 矩阵中有多少个双十字。例如下面这个例子，`01` 矩阵如下：\n\n```\n10001011\n10111111\n10001101\n11111110\n11111111\n11101011\n```\n\n我们可以找到 $5$ 个满足条件的双十字，分别如下：\n\n```\n....1...  ....1...  ....1...\n...111..  ...111..  ...111..\n....1...  ....1...  ....1...\n..11111.  ..11111.  ....1...\n....1...  ....1...  ..11111.\n........  ....1...  ....1...\n\n....1...  ....1...\n...111..  ..11111.\n....1...  ....1...\n....1...  ....1...\n.1111111  .1111111\n....1...  ....1...\n```\n\n注意最终的结果可能很大，只要求输出双十字的个数 $\\bmod\\ 10^9+9$ 的值。", "inputFormat": "第一行为用空格隔开的两个正整数 $R$ 和 $C$，分别表示 `01` 矩阵的行数和列数。\n\n第二行是一个非负整数 $N$，表示 `01` 矩阵中 `0` 的个数。\n\n接下来的 $N$ 行，每行为用空格隔开的两个正整数 $x$ 和 $y$（$1\\le x\\le R,1\\le y\\le C$），表示 $(x,y)$ 是 `0`。数据保证 $N$ 个 `0` 的坐标两两不同。", "outputFormat": "一行一个整数，为双十字的个数 $\\bmod\\ 10^9+9$ 的值。", "hint": "对于 $100\\%$ 的数据，保证 $5\\le R,C\\le 10^4$，$0\\le N\\le 10^4$，$RC\\le 2\\times 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2012] Double Cross", "background": "", "description": "In the C tribe, the double cross is a very important tribal emblem. A double cross, as in the two examples below, consists of two horizontal segments of `1` and one vertical segment of `1`:\n\n```\n..........\n....1.....      ..1..\n..11111...      .111.\n....1.....      ..1..\n.1111111..      11111\n....1.....      ..1..\n....1.....\n..........\n```\n\nA valid double cross must satisfy the following constraints:\n- The two horizontal segments cannot be in two adjacent rows.\n- The top end of the vertical segment must be strictly above both horizontal segments, and the bottom end must be strictly below both horizontal segments.\n- The vertical segment must split each horizontal segment into two equal halves.\n- The upper horizontal segment must be strictly shorter than the lower horizontal segment.\n\nSo the example on the right above is the smallest valid double cross.\n\nNow given an $R \\times C$ `01` matrix, compute how many double crosses are in this `01` matrix. For example, consider the following `01` matrix:\n\n```\n10001011\n10111111\n10001101\n11111110\n11111111\n11101011\n```\n\nWe can find $5$ valid double crosses, shown as follows:\n\n```\n....1...  ....1...  ....1...\n...111..  ...111..  ...111..\n....1...  ....1...  ....1...\n..11111.  ..11111.  ....1...\n....1...  ....1...  ..11111.\n........  ....1...  ....1...\n\n....1...  ....1...\n...111..  ..11111.\n....1...  ....1...\n....1...  ....1...\n.1111111  .1111111\n....1...  ....1...\n```\n\nNote that the final result can be large; output the number of double crosses $\\bmod\\ 10^9+9$.", "inputFormat": "The first line contains two positive integers $R$ and $C$, separated by a space, denoting the numbers of rows and columns of the `01` matrix.\n\nThe second line contains a non-negative integer $N$, denoting the number of `0` in the `01` matrix.\n\nEach of the next $N$ lines contains two positive integers $x$ and $y$ ($1 \\le x \\le R, 1 \\le y \\le C$), indicating that $(x, y)$ is `0`. It is guaranteed that the coordinates of the $N$ zeros are pairwise distinct.", "outputFormat": "Output a single integer: the number of double crosses $\\bmod\\ 10^9+9$.", "hint": "For $100\\%$ of the testdata, it is guaranteed that $5 \\le R, C \\le 10^4$, $0 \\le N \\le 10^4$, and $RC \\le 2 \\times 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2012] 双十字", "background": "", "description": "在 C 部落，双十字是非常重要的一个部落标志。所谓双十字，如下面两个例子，由两条水平的和一条竖直的 `1` 线段组成：\n\n```\n..........\n....1.....      ..1..\n..11111...      .111.\n....1.....      ..1..\n.1111111..      11111\n....1.....      ..1..\n....1.....\n..........\n```\n\n合法的双十字要求满足以下几个限制：\n- 两条水平的线段不能在相邻的两行。\n- 竖直线段上端必须严格高于两条水平线段，下端必须严格低于两条水平线段。\n- 竖直线段必须将两条水平线段严格划分成相等的两半。\n- 上方的水平线段必须严格短于下方的水平线段。\n\n所以上面右边的例子是满足要求的最小的双十字。\n\n现在给定一个 $R\\times C$ 的 `01` 矩阵，要求计算出这个 `01` 矩阵中有多少个双十字。例如下面这个例子，`01` 矩阵如下：\n\n```\n10001011\n10111111\n10001101\n11111110\n11111111\n11101011\n```\n\n我们可以找到 $5$ 个满足条件的双十字，分别如下：\n\n```\n....1...  ....1...  ....1...\n...111..  ...111..  ...111..\n....1...  ....1...  ....1...\n..11111.  ..11111.  ....1...\n....1...  ....1...  ..11111.\n........  ....1...  ....1...\n\n....1...  ....1...\n...111..  ..11111.\n....1...  ....1...\n....1...  ....1...\n.1111111  .1111111\n....1...  ....1...\n```\n\n注意最终的结果可能很大，只要求输出双十字的个数 $\\bmod\\ 10^9+9$ 的值。", "inputFormat": "第一行为用空格隔开的两个正整数 $R$ 和 $C$，分别表示 `01` 矩阵的行数和列数。\n\n第二行是一个非负整数 $N$，表示 `01` 矩阵中 `0` 的个数。\n\n接下来的 $N$ 行，每行为用空格隔开的两个正整数 $x$ 和 $y$（$1\\le x\\le R,1\\le y\\le C$），表示 $(x,y)$ 是 `0`。数据保证 $N$ 个 `0` 的坐标两两不同。", "outputFormat": "一行一个整数，为双十字的个数 $\\bmod\\ 10^9+9$ 的值。", "hint": "对于 $100\\%$ 的数据，保证 $5\\le R,C\\le 10^4$，$0\\le N\\le 10^4$，$RC\\le 2\\times 10^6$。", "locale": "zh-CN"}}}
{"pid": "P3222", "type": "P", "difficulty": 6, "samples": [["5\n2  8 12\n5  4 5\n3  8 10\n6  2 3\n1  3 7", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "二分", "各省省选", "湖南", "凸包", "半平面交"], "title": "[HNOI2012] 射箭", "background": "", "description": "沫沫最近在玩一个二维的射箭游戏，如下图 $1$ 所示，这个游戏中的 $x$ 轴在地面，第一象限中有一些竖直线段作为靶子，任意两个靶子都没有公共部分，也不会接触坐标轴。\n\n沫沫控制一个位于 $(0,0)$ 的弓箭手，可以朝 $0$ 至 $90$ 中的任意角度（不包括 $0$ 度和 $90$ 度），以任意大小的力量射出带有穿透能力的光之箭。由于游戏中没有空气阻力，并且光之箭没有箭身，箭的轨迹会是一条标准的抛物线，被轨迹穿过的所有靶子都认为被沫沫射中了，包括那些只有端点被射中的靶子。\n\n这个游戏有多种模式，其中沫沫最喜欢的是闯关模式。\n\n在闯关模式中，第一关只有一个靶子，射中这个靶子即可进入第二关，这时在第一关的基础上会出现另外一个靶子，若能够一箭双雕射中这两个靶子便可进入第三关，这时会出现第三个靶子。依此类推，每过一关都会新出现一个靶子，在第 $K$ 关必须一箭射中前 $K$ 关出现的所有 $K$ 个靶子才能进入第 $K+1$ 关，否则游戏结束。\n\n沫沫花了很多时间在这个游戏上，却最多只能玩到第七关“七星连珠”，这让她非常困惑。于是她设法获得了每一关出现的靶子的位置，想让你告诉她，最多能通过多少关？", "inputFormat": "输入文件第一行是一个正整数 $N$，表示一共有 $N$ 关。\n\n接下来有 $N$ 行，第 $i+1$ 行是用空格隔开的三个正整数 $x_i,y_{i1},y_{i2}\\ (y_{i1}<y_{i2})$，表示第 $i$ 关出现的靶子的横坐标是 $x_i$，纵坐标的范围是从 $y_{i1}$ 到 $y_{i2}$。", "outputFormat": "仅包含一个整数，表示最多的通关数。\n", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/jv279yqz.png)\n\n### 数据范围及约定\n\n- $30\\%$ 的数据满足 $N \\le 100$；\n- $50\\%$ 的数据满足 $N \\le 5000$；\n- $100\\%$ 的数据满足 $N \\le 100000$ 且给出的所有坐标不超过 $10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2012] Archery", "background": "", "description": "Momo is playing a 2D archery game, as shown in Figure 1. In this game, the x-axis lies on the ground, and in the first quadrant there are several vertical segments serving as targets. Any two targets are disjoint, and none of them touch the coordinate axes.\n\nMomo controls an archer located at $(0, 0)$. She can shoot an arrow of light with piercing ability at any angle between 0 and 90 degrees (excluding 0 degrees and 90 degrees), with any power. Since there is no air resistance in the game and the arrow of light has no shaft, the trajectory is a standard parabola. All targets crossed by the trajectory are considered hit, including those whose endpoints are hit only.\n\nThis game has multiple modes, and Momo’s favorite is the challenge mode.\n\nIn challenge mode, the first level has only one target. Hitting this target allows her to enter level two, where one more target appears in addition to the first one. If she can hit both targets with a single shot, she can enter level three, where a third target appears. And so on: at each level, a new target appears. At level $K$, she must hit all $K$ targets that have appeared in the first $K$ levels with a single shot to enter level $K+1$; otherwise, the game ends.\n\nMomo has spent a lot of time on this game, but she can only reach level seven, “Seven Stars in a Row,” which confuses her. She has obtained the positions of the targets that appear in each level and wants you to tell her the maximum number of levels she can pass.", "inputFormat": "The first line of input contains a positive integer $N$, indicating that there are $N$ levels.\n\nThe next $N$ lines follow. Line $i+1$ contains three positive integers $x_i, y_{i1}, y_{i2}\\ (y_{i1}<y_{i2})$, meaning that in level $i$ the target’s x-coordinate is $x_i$, and its y-range is from $y_{i1}$ to $y_{i2}$.", "outputFormat": "Output a single integer, the maximum number of levels that can be cleared.", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/jv279yqz.png)\n\nConstraints:\n- 30% of the testdata satisfy $N \\le 100$.\n- 50% of the testdata satisfy $N \\le 5000$.\n- 100% of the testdata satisfy $N \\le 100000$, and all given coordinates do not exceed $10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2012] 射箭", "background": "", "description": "沫沫最近在玩一个二维的射箭游戏，如下图 $1$ 所示，这个游戏中的 $x$ 轴在地面，第一象限中有一些竖直线段作为靶子，任意两个靶子都没有公共部分，也不会接触坐标轴。\n\n沫沫控制一个位于 $(0,0)$ 的弓箭手，可以朝 $0$ 至 $90$ 中的任意角度（不包括 $0$ 度和 $90$ 度），以任意大小的力量射出带有穿透能力的光之箭。由于游戏中没有空气阻力，并且光之箭没有箭身，箭的轨迹会是一条标准的抛物线，被轨迹穿过的所有靶子都认为被沫沫射中了，包括那些只有端点被射中的靶子。\n\n这个游戏有多种模式，其中沫沫最喜欢的是闯关模式。\n\n在闯关模式中，第一关只有一个靶子，射中这个靶子即可进入第二关，这时在第一关的基础上会出现另外一个靶子，若能够一箭双雕射中这两个靶子便可进入第三关，这时会出现第三个靶子。依此类推，每过一关都会新出现一个靶子，在第 $K$ 关必须一箭射中前 $K$ 关出现的所有 $K$ 个靶子才能进入第 $K+1$ 关，否则游戏结束。\n\n沫沫花了很多时间在这个游戏上，却最多只能玩到第七关“七星连珠”，这让她非常困惑。于是她设法获得了每一关出现的靶子的位置，想让你告诉她，最多能通过多少关？", "inputFormat": "输入文件第一行是一个正整数 $N$，表示一共有 $N$ 关。\n\n接下来有 $N$ 行，第 $i+1$ 行是用空格隔开的三个正整数 $x_i,y_{i1},y_{i2}\\ (y_{i1}<y_{i2})$，表示第 $i$ 关出现的靶子的横坐标是 $x_i$，纵坐标的范围是从 $y_{i1}$ 到 $y_{i2}$。", "outputFormat": "仅包含一个整数，表示最多的通关数。\n", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/jv279yqz.png)\n\n### 数据范围及约定\n\n- $30\\%$ 的数据满足 $N \\le 100$；\n- $50\\%$ 的数据满足 $N \\le 5000$；\n- $100\\%$ 的数据满足 $N \\le 100000$ 且给出的所有坐标不超过 $10^9$。", "locale": "zh-CN"}}}
{"pid": "P3223", "type": "P", "difficulty": 4, "samples": [["1  1", "12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "高精度", "2012", "各省省选", "湖南", "组合数学"], "title": "[HNOI2012] 排队", "background": "", "description": "某中学有 $n$ 名男同学，$m$ 名女同学和两名老师要排队参加体检。他们排成一条直线，并且任意两名女同学不能相邻，两名老师也不能相邻，那么一共有多少种排法呢？（注意：任意两个人都是不同的）\n", "inputFormat": "只有一行且为用空格隔开的两个非负整数 $n$ 和 $m$，其含义如上所述。 ", "outputFormat": "仅一个非负整数，表示不同的排法个数。注意答案可能很大。\n", "hint": "对于 $30\\%$ 的数据 $n\\leq 100$，$m\\leq 100$。\n\n对于 $100\\%$ 的数据 $n\\leq 2000$，$m\\leq 2000$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2012] Queue", "background": "", "description": "A certain middle school has $n$ boys, $m$ girls, and two teachers who are to line up for a physical examination. They form a single straight line, and no two girls may stand adjacent, and the two teachers may not be adjacent either. How many different lineups are there? (Note: every individual is distinct.)", "inputFormat": "A single line containing two non-negative integers $n$ and $m$, separated by a space, as described above.", "outputFormat": "A single non-negative integer, denoting the number of different lineups. Note that the answer may be large.", "hint": "For $30\\%$ of the testdata, $n \\leq 100$, $m \\leq 100$.\n\nFor $100\\%$ of the testdata, $n \\leq 2000$, $m \\leq 2000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2012] 排队", "background": "", "description": "某中学有 $n$ 名男同学，$m$ 名女同学和两名老师要排队参加体检。他们排成一条直线，并且任意两名女同学不能相邻，两名老师也不能相邻，那么一共有多少种排法呢？（注意：任意两个人都是不同的）\n", "inputFormat": "只有一行且为用空格隔开的两个非负整数 $n$ 和 $m$，其含义如上所述。 ", "outputFormat": "仅一个非负整数，表示不同的排法个数。注意答案可能很大。\n", "hint": "对于 $30\\%$ 的数据 $n\\leq 100$，$m\\leq 100$。\n\n对于 $100\\%$ 的数据 $n\\leq 2000$，$m\\leq 2000$。\n", "locale": "zh-CN"}}}
{"pid": "P3224", "type": "P", "difficulty": 6, "samples": [["5 1\n4 3 2 5 1\n1 2\n7\nQ 3 2\nQ 2 1\nB 2 3\nB 1 5\nQ 2 1\nQ 2 4\nQ 2 3\n", "-1\n2\n5\n1\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2012", "线段树", "并查集", "各省省选", "平衡树", "湖南", "线段树合并", "启发式合并"], "title": "[HNOI2012] 永无乡", "background": "", "description": "永无乡包含 $n$ 座岛，编号从 $1$ 到 $n$ ，每座岛都有自己的独一无二的重要度，按照重要度可以将这 $n$ 座岛排名，名次用 $1$  到 $n$ 来表示。某些岛之间由巨大的桥连接，通过桥可以从一个岛到达另一个岛。如果从岛 $a$ 出发经过若干座（含 $0$ 座）桥可以 到达岛 $b$ ，则称岛 $a$ 和岛 $b$ 是连通的。\n\n现在有两种操作：\n\n`B x y` 表示在岛 $x$ 与岛 $y$ 之间修建一座新桥。\n\n`Q x k` 表示询问当前与岛 $x$ 连通的所有岛中第 $k$ 重要的是哪座岛，即所有与岛 $x$ 连通的岛中重要度排名第 $k$ 小的岛是哪座，请你输出那个岛的编号。", "inputFormat": "第一行是用空格隔开的两个整数，分别表示岛的个数 $n$ 以及一开始存在的桥数 $m$。\n\n第二行有 $n$ 个整数，第 $i$ 个整数表示编号为 $i$ 的岛屿的排名 $p_i$。\n\n接下来 $m$ 行，每行两个整数 $u, v$，表示一开始存在一座连接编号为 $u$ 的岛屿和编号为 $v$ 的岛屿的桥。\n\n接下来一行有一个整数，表示操作个数 $q$。\n\n接下来 $q$ 行，每行描述一个操作。每行首先有一个字符 $op$，表示操作类型，然后有两个整数 $x, y$。\n- 若 $op$ 为 `Q`，则表示询问所有与岛 $x$ 连通的岛中重要度排名第 $y$ 小的岛是哪座，请你输出那个岛的编号。\n- 若 $op$ 为 `B`，则表示在岛 $x$ 与岛 $y$ 之间修建一座新桥。\n", "outputFormat": "对于每个询问操作都要依次输出一行一个整数，表示所询问岛屿的编号。如果该岛屿不存在，则输出 $-1$ 。", "hint": "### 数据规模与约定\n\n- 对于 $20\\%$ 的数据，保证 $n \\leq 10^3$, $q \\leq 10^3$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq m \\leq n \\leq 10^5$, $1 \\leq q \\leq 3 \\times 10^5$，$p$ 为一个 $1 \\sim n$ 的排列，$op \\in \\{\\texttt Q, \\texttt B\\}$，$1 \\leq u, v, x, y \\leq n$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2012] Neverland", "background": "", "description": "Neverland contains $n$ islands, numbered from $1$ to $n$. Each island has its own unique importance. According to importance, these $n$ islands can be ranked, with ranks from $1$ to $n$. Some islands are connected by large bridges, through which one can travel from one island to another. If starting from island $a$ you can reach island $b$ after crossing several (including $0$) bridges, then islands $a$ and $b$ are said to be connected.\n\nThere are two operations:\n\n`B x y` means building a new bridge between island $x$ and island $y$.\n\n`Q x k` asks which island currently ranks the $k$-th by importance among all islands connected to island $x$, i.e., among all islands connected to $x$, which island has the $k$-th smallest importance rank. Please output the index of that island.", "inputFormat": "The first line contains two integers separated by a space, representing the number of islands $n$ and the initial number of bridges $m$.\n\nThe second line contains $n$ integers; the $i$-th integer is the rank $p_i$ of island $i$.\n\nThe next $m$ lines each contain two integers $u, v$, indicating that initially there is a bridge connecting island $u$ and island $v$.\n\nThe next line contains an integer, the number of operations $q$.\n\nThe next $q$ lines each describe an operation. Each line first contains a character $op$ indicating the operation type, followed by two integers $x, y$.\n- If $op$ is `Q`, it asks which island ranks the $y$-th smallest by importance among all islands connected to $x$; output the index of that island.\n- If $op$ is `B`, it means building a new bridge between island $x$ and island $y$.", "outputFormat": "For each query operation, output one integer on a separate line, indicating the index of the island being asked for. If such an island does not exist, output $-1$.", "hint": "### Constraints\n\n- For $20\\%$ of the testdata, $n \\leq 10^3$, $q \\leq 10^3$.\n- For $100\\%$ of the testdata, $1 \\leq m \\leq n \\leq 10^5$, $1 \\leq q \\leq 3 \\times 10^5$, $p$ is a permutation of $1 \\sim n$, $op \\in \\{\\texttt Q, \\texttt B\\}$, $1 \\leq u, v, x, y \\leq n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2012] 永无乡", "background": "", "description": "永无乡包含 $n$ 座岛，编号从 $1$ 到 $n$ ，每座岛都有自己的独一无二的重要度，按照重要度可以将这 $n$ 座岛排名，名次用 $1$  到 $n$ 来表示。某些岛之间由巨大的桥连接，通过桥可以从一个岛到达另一个岛。如果从岛 $a$ 出发经过若干座（含 $0$ 座）桥可以 到达岛 $b$ ，则称岛 $a$ 和岛 $b$ 是连通的。\n\n现在有两种操作：\n\n`B x y` 表示在岛 $x$ 与岛 $y$ 之间修建一座新桥。\n\n`Q x k` 表示询问当前与岛 $x$ 连通的所有岛中第 $k$ 重要的是哪座岛，即所有与岛 $x$ 连通的岛中重要度排名第 $k$ 小的岛是哪座，请你输出那个岛的编号。", "inputFormat": "第一行是用空格隔开的两个整数，分别表示岛的个数 $n$ 以及一开始存在的桥数 $m$。\n\n第二行有 $n$ 个整数，第 $i$ 个整数表示编号为 $i$ 的岛屿的排名 $p_i$。\n\n接下来 $m$ 行，每行两个整数 $u, v$，表示一开始存在一座连接编号为 $u$ 的岛屿和编号为 $v$ 的岛屿的桥。\n\n接下来一行有一个整数，表示操作个数 $q$。\n\n接下来 $q$ 行，每行描述一个操作。每行首先有一个字符 $op$，表示操作类型，然后有两个整数 $x, y$。\n- 若 $op$ 为 `Q`，则表示询问所有与岛 $x$ 连通的岛中重要度排名第 $y$ 小的岛是哪座，请你输出那个岛的编号。\n- 若 $op$ 为 `B`，则表示在岛 $x$ 与岛 $y$ 之间修建一座新桥。\n", "outputFormat": "对于每个询问操作都要依次输出一行一个整数，表示所询问岛屿的编号。如果该岛屿不存在，则输出 $-1$ 。", "hint": "### 数据规模与约定\n\n- 对于 $20\\%$ 的数据，保证 $n \\leq 10^3$, $q \\leq 10^3$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq m \\leq n \\leq 10^5$, $1 \\leq q \\leq 3 \\times 10^5$，$p$ 为一个 $1 \\sim n$ 的排列，$op \\in \\{\\texttt Q, \\texttt B\\}$，$1 \\leq u, v, x, y \\leq n$。", "locale": "zh-CN"}}}
{"pid": "P3225", "type": "P", "difficulty": 5, "samples": [["9\n1 3\n4 1\n3 5\n1 2\n2 6\n1 5\n6 3\n1 6\n3 2\n6\n1 2\n1 3\n2 4\n2 5\n3 6\n3 7\n0", "Case 1: 2 4\nCase 2: 4 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "各省省选", "湖南", "深度优先搜索 DFS", "Tarjan", "双连通分量"], "title": "[HNOI2012] 矿场搭建", "background": null, "description": "煤矿工地可以看成是由隧道连接挖煤点组成的无向图。为安全起见，希望在工地发生事故时所有挖煤点的工人都能有一条出路逃到救援出口处。于是矿主决定在某些挖煤点设立救援出口，使得无论哪一个挖煤点坍塌之后，其他挖煤点的工人都有一条道路通向救援出口。\n\n请写一个程序，用来计算至少需要设置几个救援出口，以及不同最少救援出口的设置方案总数。", "inputFormat": "输入文件有若干组数据。\n\n每组数据的第一行是一个正整数 $N\\ (N \\le 500)$，表示工地的隧道数。\n\n接下来的 $N$ 行每行是用空格隔开的两个整数 $S$ 和 $T$，表示挖煤点 $S$ 与挖煤点 $T$ 由隧道直接连接。\n\n输入数据以 $0$ 结尾。", "outputFormat": "对于每组数据，输出一行。\n\n第 $i$ 行组数据以 $\\verb!Case i: !$ 开始（注意大小写，$\\verb!Case!$ 与 $\\verb!i!$ 之间有空格，$\\verb!i!$ 与 $\\verb!:!$ 之间无空格，$\\verb!:!$ 之后有空格）。\n\n其后是用空格隔开的两个正整数，第一个正整数表示对于第 $i$ 组输入数据至少需要设置几个救援出口，第二个正整数表示对于第 $i$ 组输入数据不同最少救援出口的设置方案总数。\n\n输入数据保证答案小于 $2^{64}$。输出格式参照以下输入输出样例。", "hint": "### 样例解释\n\n- Case 1 的四组解分别是 $(2,4)$，$(3,4)$，$(4,5)$，$(4,6)$；\n- Case 2 的一组解为 $(4,5,6,7)$。\n\n### 数据范围及约定\n\n对于每组数据，设 $m$ 为各组 $S, T$ 中最大值，则有：\n\n- $1 \\le m \\le 10^3$；\n- 各组 $S, T$ 构成的集合 $V\\in[1, m] \\cap \\mathbb Z$。\n- $V$ 中任意两点连通。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2012] Building the Mine", "background": "", "description": "A coal mining site can be viewed as an undirected graph where tunnels connect mining points. For safety, we want that in case of an accident, all miners at the remaining mining points can have a way out to reach a rescue exit. Therefore, the owner decides to set up rescue exits at some mining points so that no matter which single mining point collapses, workers at all other mining points still have a path to a rescue exit.\n\nPlease write a program to compute the minimum number of rescue exits required, as well as the total number of distinct configurations that achieve this minimum.", "inputFormat": "The input file contains multiple test cases.\n\nFor each test case, the first line contains a positive integer $N\\ (N \\le 500)$, the number of tunnels.\n\nEach of the next $N$ lines contains two integers $S$ and $T$ separated by a space, indicating that mining point $S$ is directly connected to mining point $T$ by a tunnel.\n\nThe input ends with a single $0$.", "outputFormat": "For each test case, output one line.\n\nThe $i$-th test case output starts with $\\verb!Case i: !$ (note the letter case; there is a space between $\\verb!Case!$ and $\\verb!i!$, no space between $\\verb!i!$ and $\\verb!:!$, and there is one space after $\\verb!:!$).\n\nAfter that, output two space-separated positive integers: the first is the minimum number of rescue exits required for the $i$-th test case, and the second is the number of distinct configurations achieving this minimum.\n\nThe testdata guarantees the answer is less than $2^{64}$. Refer to the sample input and output format.", "hint": "### Sample Explanation\n\n- The four solutions for Case 1 are $(2, 4)$, $(3, 4)$, $(4, 5)$, $(4, 6)$.\n- One solution for Case 2 is $(4, 5, 6, 7)$.\n\n### Constraints\n\nFor each test case, let $m$ be the maximum value among all $S$ and $T$ in that case. Then:\n\n- $1 \\le m \\le 10^3$.\n- The set of vertices formed by all $S$ and $T$ values is $V \\subseteq [1, m] \\cap \\mathbb{Z}$.\n- The graph induced by $V$ is connected.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2012] 矿场搭建", "background": null, "description": "煤矿工地可以看成是由隧道连接挖煤点组成的无向图。为安全起见，希望在工地发生事故时所有挖煤点的工人都能有一条出路逃到救援出口处。于是矿主决定在某些挖煤点设立救援出口，使得无论哪一个挖煤点坍塌之后，其他挖煤点的工人都有一条道路通向救援出口。\n\n请写一个程序，用来计算至少需要设置几个救援出口，以及不同最少救援出口的设置方案总数。", "inputFormat": "输入文件有若干组数据。\n\n每组数据的第一行是一个正整数 $N\\ (N \\le 500)$，表示工地的隧道数。\n\n接下来的 $N$ 行每行是用空格隔开的两个整数 $S$ 和 $T$，表示挖煤点 $S$ 与挖煤点 $T$ 由隧道直接连接。\n\n输入数据以 $0$ 结尾。", "outputFormat": "对于每组数据，输出一行。\n\n第 $i$ 行组数据以 $\\verb!Case i: !$ 开始（注意大小写，$\\verb!Case!$ 与 $\\verb!i!$ 之间有空格，$\\verb!i!$ 与 $\\verb!:!$ 之间无空格，$\\verb!:!$ 之后有空格）。\n\n其后是用空格隔开的两个正整数，第一个正整数表示对于第 $i$ 组输入数据至少需要设置几个救援出口，第二个正整数表示对于第 $i$ 组输入数据不同最少救援出口的设置方案总数。\n\n输入数据保证答案小于 $2^{64}$。输出格式参照以下输入输出样例。", "hint": "### 样例解释\n\n- Case 1 的四组解分别是 $(2,4)$，$(3,4)$，$(4,5)$，$(4,6)$；\n- Case 2 的一组解为 $(4,5,6,7)$。\n\n### 数据范围及约定\n\n对于每组数据，设 $m$ 为各组 $S, T$ 中最大值，则有：\n\n- $1 \\le m \\le 10^3$；\n- 各组 $S, T$ 构成的集合 $V\\in[1, m] \\cap \\mathbb Z$。\n- $V$ 中任意两点连通。", "locale": "zh-CN"}}}
{"pid": "P3226", "type": "P", "difficulty": 6, "samples": [["4", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "各省省选", "湖南", "构造", "状压 DP"], "title": "[HNOI2012] 集合选数", "background": "", "description": "《集合论与图论》这门课程有一道作业题，要求同学们求出 $\\{1, 2, 3, 4, 5\\}$ 的所有满足以下条件的子集：若 $x$ 在该子集中，则 $2x$ 和 $3x$ 不能在该子集中。\n\n同学们不喜欢这种具有枚举性质的题目，于是把它变成了以下问题：对于任意一个正整数 $n\\,(1\\leq n\\leq 10^5)$，如何求出 $\\{1,2,\\dots,n\\}$ 的满足上述约束条件的子集的个数（只需输出对 $10^9+1$ 取模的结果），现在这个问题就交给你了。", "inputFormat": "只有一行，其中有一个正整数 $n$。", "outputFormat": "仅包含一个正整数，表示 $\\{1,2,\\dots,n\\}$ 有多少个满足上述约束条件的子集。", "hint": "**【样例解释】**\n \n有 $8$ 个集合满足要求，分别是 $\\varnothing$、$\\{1\\}$、$\\{1,4\\}$、$\\{2\\}$、$\\{2,3\\}$、$\\{3\\}$、$\\{3,4\\}$ 和 $\\{4\\}$。\n\n**【数据范围】**\n\n对于 $30\\%$ 的数据，$1\\le n\\le 20$。  \n对于 $100\\%$ 的数据，$1\\le n\\le 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2012] Set Selection", "background": "", "description": "The course \"Set Theory and Graph Theory\" has a homework problem asking students to find all subsets of $\\{1, 2, 3, 4, 5\\}$ that satisfy the following condition: if $x$ is in the subset, then $2x$ and $3x$ cannot be in the subset.\n\nStudents do not like such enumeration-style problems, so they turned it into the following question: for any positive integer $n\\,(1\\leq n\\leq 10^5)$, how many subsets of $\\{1,2,\\dots,n\\}$ satisfy the above constraint (you only need to output the result modulo $10^9+1$). Now this task is handed to you.", "inputFormat": "A single line containing a positive integer $n$.", "outputFormat": "Output a single positive integer, the number of subsets of $\\{1,2,\\dots,n\\}$ that satisfy the above constraint.", "hint": "Sample explanation:  \nThere are $8$ sets that meet the requirement, namely $\\varnothing$, $\\{1\\}$, $\\{1,4\\}$, $\\{2\\}$, $\\{2,3\\}$, $\\{3\\}$, $\\{3,4\\}$, and $\\{4\\}$.\n\nConstraints:  \nFor $30\\%$ of the testdata, $1 \\le n \\le 20$.  \nFor $100\\%$ of the testdata, $1 \\le n \\le 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2012] 集合选数", "background": "", "description": "《集合论与图论》这门课程有一道作业题，要求同学们求出 $\\{1, 2, 3, 4, 5\\}$ 的所有满足以下条件的子集：若 $x$ 在该子集中，则 $2x$ 和 $3x$ 不能在该子集中。\n\n同学们不喜欢这种具有枚举性质的题目，于是把它变成了以下问题：对于任意一个正整数 $n\\,(1\\leq n\\leq 10^5)$，如何求出 $\\{1,2,\\dots,n\\}$ 的满足上述约束条件的子集的个数（只需输出对 $10^9+1$ 取模的结果），现在这个问题就交给你了。", "inputFormat": "只有一行，其中有一个正整数 $n$。", "outputFormat": "仅包含一个正整数，表示 $\\{1,2,\\dots,n\\}$ 有多少个满足上述约束条件的子集。", "hint": "**【样例解释】**\n \n有 $8$ 个集合满足要求，分别是 $\\varnothing$、$\\{1\\}$、$\\{1,4\\}$、$\\{2\\}$、$\\{2,3\\}$、$\\{3\\}$、$\\{3,4\\}$ 和 $\\{4\\}$。\n\n**【数据范围】**\n\n对于 $30\\%$ 的数据，$1\\le n\\le 20$。  \n对于 $100\\%$ 的数据，$1\\le n\\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P3227", "type": "P", "difficulty": 6, "samples": [["2 2 2\n1\n6 1\n6 1\n2 6\n2 6", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "各省省选", "网络流", "湖南", "最小割"], "title": "[HNOI2013] 切糕", "background": "", "description": "经过千辛万苦小 A 得到了一块切糕，切糕的形状是长方体，小 A 打算拦腰将切糕切成两半分给小 B。出于美观考虑，小 A 希望切面能尽量光滑且和谐。于是她找到你，希望你能帮她找出最好的切割方案。\n\n出于简便考虑，我们将切糕视作一个长 $P$、宽 $Q$、高 $R$ 的长方体点阵。我们将位于第 $z$ 层中第 $x$ 行、第 $y$ 列上的点称 $(x,y,z)$，它有一个非负的不和谐值 $v(x,y,z)$。一个合法的切面满足以下两个条件：\n\n - 与每个纵轴（一共有 $P\\times Q$ 个纵轴）有且仅有一个交点。即切面是一个函数 $f(x,y)$，对于所有 $(x,y)(x\\in [1,P],y\\in[1,Q])$，我们需指定一个切割点 $f(x,y)$，且 $1\\le f(x,y)\\le R$。\n\n - 切面需要满足一定的光滑性要求，即相邻纵轴上的切割点不能相距太远。对于所有的 $1\\le x,x'\\le P$ 和 $1\\le y,y'\\le Q$，若 $|x-x'|+|y-y'|=1$，则 $|f(x,y)-f(x',y')| \\le D$，其中 $D$ 是给定的一个非负整数。\n\n可能有许多切面 $f$ 满足上面的条件，小 A 希望找出总的切割点上的不和谐值最小的那个。", "inputFormat": "第一行是三个正整数 $P,Q,R$，表示切糕的长宽高。\n\n第二行有一个非负整数 $D$，表示光滑性要求。\n\n接下来是 $R$ 个 $P$ 行 $Q$ 列的矩阵，第 $z$ 个矩阵的第 $x$ 行第 $y$ 列是 $v(x,y,z)(1\\le x\\le P,1\\le y\\le Q,1\\le z\\le R)$。", "outputFormat": "仅包含一个整数，表示在合法基础上最小的总不和谐值。", "hint": "#### 输入输出样例 1 解释\n\n最佳切面的 $f$ 为 $f(1,1)=f(2,1)=2,f(1,2)=f(2,2)=1$。\n\n---\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1 \\leq P,Q,R\\leq 40,0\\le D\\le R$，且给出的所有的不和谐值不超过 $1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2013] Qiegao", "background": "", "description": "After much effort, Xiao A obtained a piece of qiegao. The qiegao is a rectangular cuboid, and Xiao A plans to cut it in half horizontally to share it with Xiao B. For aesthetic reasons, Xiao A hopes the cutting surface can be as smooth and harmonious as possible. So she asks you to find the best cutting plan.\n\nFor simplicity, we view the qiegao as a cuboid grid with length $P$, width $Q$, and height $R$. We call the point at layer $z$, row $x$, and column $y$ the point $(x,y,z)$, and it has a nonnegative disharmony value $v(x,y,z)$. A valid cutting surface satisfies the following two conditions:\n\n- It has exactly one intersection with each vertical axis (there are $P \\times Q$ vertical axes). That is, the cutting surface is a function $f(x,y)$, and for all $(x,y)$ ($x \\in [1,P]$, $y \\in [1,Q]$), we specify a cutting point $f(x,y)$ with $1 \\le f(x,y) \\le R$.\n\n- The cutting surface needs to meet a smoothness requirement: cutting points on adjacent vertical axes cannot be too far apart. For all $1 \\le x,x' \\le P$ and $1 \\le y,y' \\le Q$, if $|x-x'|+|y-y'|=1$, then $|f(x,y)-f(x',y')| \\le D$, where $D$ is a given nonnegative integer.\n\nThere may be many cutting surfaces $f$ satisfying the above conditions. Xiao A wants the one that minimizes the total disharmony value at the cutting points.", "inputFormat": "The first line contains three positive integers $P,Q,R$, representing the length, width, and height of the qiegao.\n\nThe second line contains a nonnegative integer $D$, representing the smoothness requirement.\n\nThen follow $R$ matrices of size $P$ rows and $Q$ columns. In the $z$-th matrix, the entry at row $x$ and column $y$ is $v(x,y,z)$ ($1 \\le x \\le P$, $1 \\le y \\le Q$, $1 \\le z \\le R$).", "outputFormat": "Output a single integer, the minimal possible total disharmony value under the legality constraints.", "hint": "#### Explanation for Sample 1\n\nThe optimal cutting surface $f$ is $f(1,1)=f(2,1)=2$, $f(1,2)=f(2,2)=1$.\n\n---\n#### Constraints\n\nFor $100\\%$ of the testdata, $1 \\le P,Q,R \\le 40$, $0 \\le D \\le R$, and all given disharmony values do not exceed $1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2013] 切糕", "background": "", "description": "经过千辛万苦小 A 得到了一块切糕，切糕的形状是长方体，小 A 打算拦腰将切糕切成两半分给小 B。出于美观考虑，小 A 希望切面能尽量光滑且和谐。于是她找到你，希望你能帮她找出最好的切割方案。\n\n出于简便考虑，我们将切糕视作一个长 $P$、宽 $Q$、高 $R$ 的长方体点阵。我们将位于第 $z$ 层中第 $x$ 行、第 $y$ 列上的点称 $(x,y,z)$，它有一个非负的不和谐值 $v(x,y,z)$。一个合法的切面满足以下两个条件：\n\n - 与每个纵轴（一共有 $P\\times Q$ 个纵轴）有且仅有一个交点。即切面是一个函数 $f(x,y)$，对于所有 $(x,y)(x\\in [1,P],y\\in[1,Q])$，我们需指定一个切割点 $f(x,y)$，且 $1\\le f(x,y)\\le R$。\n\n - 切面需要满足一定的光滑性要求，即相邻纵轴上的切割点不能相距太远。对于所有的 $1\\le x,x'\\le P$ 和 $1\\le y,y'\\le Q$，若 $|x-x'|+|y-y'|=1$，则 $|f(x,y)-f(x',y')| \\le D$，其中 $D$ 是给定的一个非负整数。\n\n可能有许多切面 $f$ 满足上面的条件，小 A 希望找出总的切割点上的不和谐值最小的那个。", "inputFormat": "第一行是三个正整数 $P,Q,R$，表示切糕的长宽高。\n\n第二行有一个非负整数 $D$，表示光滑性要求。\n\n接下来是 $R$ 个 $P$ 行 $Q$ 列的矩阵，第 $z$ 个矩阵的第 $x$ 行第 $y$ 列是 $v(x,y,z)(1\\le x\\le P,1\\le y\\le Q,1\\le z\\le R)$。", "outputFormat": "仅包含一个整数，表示在合法基础上最小的总不和谐值。", "hint": "#### 输入输出样例 1 解释\n\n最佳切面的 $f$ 为 $f(1,1)=f(2,1)=2,f(1,2)=f(2,2)=1$。\n\n---\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1 \\leq P,Q,R\\leq 40,0\\le D\\le R$，且给出的所有的不和谐值不超过 $1000$。", "locale": "zh-CN"}}}
{"pid": "P3228", "type": "P", "difficulty": 6, "samples": [["7 3 2 997\n", "16\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2013", "各省省选", "湖南", "组合数学", "队列", "差分"], "title": "[HNOI2013] 数列", "background": null, "description": "小 T 最近在学着买股票，他得到内部消息：F 公司的股票将会疯涨。股票每天的价格已知是正整数，并且由于客观上的原因，最多只能为 $N$。在疯涨的 $K$ 天中小 T 观察到：除第一天外每天的股价都比前一天高，且高出的价格（即当天的股价与前一天的股价之差）不会超过 $M$，$M$ 为正整数。并且这些参数满足 $M(K-1)<N$。小 T 忘记了这 $K$ 天每天的具体股价了，他现在想知道这 $K$ 天的股价有多少种可能。", "inputFormat": "只有一行用空格隔开的四个数：$N$、$K$、$M$、$P$。对 $P$ 的说明参见后面“输出格式”中对 $P$ 的解释。输入保证 $20\\%$ 的数据 $M,N,K,P \\le 20000$，保证 $100\\%$ 的数据 $M,K,P \\le 10^9$，$N \\le 10^{18}$。", "outputFormat": "仅包含一个数，表示这 $K$ 天的股价的可能种数对于 $P$ 的模值。", "hint": "**样例解释**  \n\n输出样例的 $16$ 表示输入样例的股价有 $16$ 种可能：\n\n$\\{1, 2, 3\\}$，$\\{1, 2, 4\\}$，$\\{1, 3, 4\\}$，$\\{1, 3, 5\\}$，$\\{2, 3, 4\\}$，$\\{2, 3, 5\\}$，$\\{2, 4, 5\\}$，$\\{2, 4, 6\\}$，$\\{3, 4, 5\\}$，$\\{3, 4, 6\\}$，$\\{3, 5, 6\\}$，$\\{3, 5, 7\\}$，$\\{4, 5, 6\\}$，$\\{4, 5, 7\\}$，$\\{4, 6, 7\\}$，$\\{5, 6, 7\\}$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2013] Sequence", "background": "", "description": "Xiao T is learning to buy stocks. He got insider information: the stock of company F will soar. The price each day is a positive integer, and due to objective reasons, it can be at most $N$. During the $K$ days of soaring, Xiao T observed that: except for the first day, each day's price is higher than the previous day, and the increase (i.e., today's price minus yesterday's price) does not exceed $M$, where $M$ is a positive integer. Moreover, these parameters satisfy $M(K-1) < N$. Xiao T forgot the exact price on each of the $K$ days; he now wants to know how many possible price sequences there are for these $K$ days.", "inputFormat": "Only one line with four space-separated numbers: $N$, $K$, $M$, $P$. For $P$, see the explanation in the “Output Format” section below. It is guaranteed that for 20% of the testdata $M, N, K, P \\le 20000$, and for 100% of the testdata $M, K, P \\le 10^9$, $N \\le 10^{18}$.", "outputFormat": "Output a single number: the number of possible price sequences over $K$ days modulo $P$.", "hint": "**Sample Explanation**  \nThe output sample’s $16$ means there are $16$ possible price sequences for the input sample:\n\n$\\{1, 2, 3\\}$, $\\{1, 2, 4\\}$, $\\{1, 3, 4\\}$, $\\{1, 3, 5\\}$, $\\{2, 3, 4\\}$, $\\{2, 3, 5\\}$, $\\{2, 4, 5\\}$, $\\{2, 4, 6\\}$, $\\{3, 4, 5\\}$, $\\{3, 4, 6\\}$, $\\{3, 5, 6\\}$, $\\{3, 5, 7\\}$, $\\{4, 5, 6\\}$, $\\{4, 5, 7\\}$, $\\{4, 6, 7\\}$, $\\{5, 6, 7\\}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2013] 数列", "background": null, "description": "小 T 最近在学着买股票，他得到内部消息：F 公司的股票将会疯涨。股票每天的价格已知是正整数，并且由于客观上的原因，最多只能为 $N$。在疯涨的 $K$ 天中小 T 观察到：除第一天外每天的股价都比前一天高，且高出的价格（即当天的股价与前一天的股价之差）不会超过 $M$，$M$ 为正整数。并且这些参数满足 $M(K-1)<N$。小 T 忘记了这 $K$ 天每天的具体股价了，他现在想知道这 $K$ 天的股价有多少种可能。", "inputFormat": "只有一行用空格隔开的四个数：$N$、$K$、$M$、$P$。对 $P$ 的说明参见后面“输出格式”中对 $P$ 的解释。输入保证 $20\\%$ 的数据 $M,N,K,P \\le 20000$，保证 $100\\%$ 的数据 $M,K,P \\le 10^9$，$N \\le 10^{18}$。", "outputFormat": "仅包含一个数，表示这 $K$ 天的股价的可能种数对于 $P$ 的模值。", "hint": "**样例解释**  \n\n输出样例的 $16$ 表示输入样例的股价有 $16$ 种可能：\n\n$\\{1, 2, 3\\}$，$\\{1, 2, 4\\}$，$\\{1, 3, 4\\}$，$\\{1, 3, 5\\}$，$\\{2, 3, 4\\}$，$\\{2, 3, 5\\}$，$\\{2, 4, 5\\}$，$\\{2, 4, 6\\}$，$\\{3, 4, 5\\}$，$\\{3, 4, 6\\}$，$\\{3, 5, 6\\}$，$\\{3, 5, 7\\}$，$\\{4, 5, 6\\}$，$\\{4, 5, 7\\}$，$\\{4, 6, 7\\}$，$\\{5, 6, 7\\}$。", "locale": "zh-CN"}}}
{"pid": "P3229", "type": "P", "difficulty": 7, "samples": [["8  3\n2  0\n3  1\n4  1\n1  0\n5  0\n6  1\n7  1\n8  0", "1 6 8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2013", "各省省选", "单调队列", "湖南"], "title": "[HNOI2013] 旅行", "background": "", "description": "在遥远的 HX 国，住着一个旅行家小 L，他希望骑着他的自行车游遍全国。在这个国家中，每个城市都有一个编号，共有 $n$ 个城市，编号从 $1$ 到 $n$。\n\n有的城市没有小 L 想去的景点，而有的城市有且仅有一个小 L 想去的景点，所有的城市都是这两种情况之一，小 L 非常热爱信息学，他编写程序给他的旅行安排了一条最短路线以到达所有他想去的景点（所有的通知旅行线路上城市编号是乱序的）：他第 $1$ 个到达的城市编号为 $a_1$，第 $i$ 个到达的城市编号为 $a_i$，最后到达城市 $a_n$ 结束这次旅行。小L希望用恰好的 $m$ 个月（$m<n$）的时间完成这次旅行，所以他需要制定一个理性的旅游计划。\n\n当他抵达一个城市时，如果这个城市有他想要去的景点，他会因此获得 $1$ 点快乐值；但是若到达的城市没有他想去的景点，他会因旅途的疲惫得到 $1$ 点的疲劳值：一个月的时间足够他游玩任意多个城市，但他也希望拿出一点时间来休息。他每个月总是在本月所到达的最后一个城市休息（但如果这个城市有景点，那么小 L 总会游玩这个景点再休息）。当然，小 L 希望每个月都能有一定的旅行任务。即便这个月他所到达的城市中并没有他想去的的景点，换句话说，每个月他都会至少到达一个新的城市。\n\n小 L 无法自己安排旅行计划，所以求助于你。你需要告诉他一个序列：$x_1,x_2,\\ldots,x_m$，其中 $x_i$ 表示小 L 第 $i$ 个月休息时。他所在的城市编号：由于他最后一个月必须完成他的旅行，所以 $x_m$ 肯定等于 $a_n$，例如，设 $n=5$，$m=3$，$(a_1,a_2,a_3,a_4,a_5)=(3,2,4,1,5)$，$(x_1,x_2,x_3)=(2,1,5)$，这意味着：第 $1$ 个月先后到达 $3$ 号和 $2$ 号城市，并在 $2$ 号城市休息：第 $2$ 个月先后到达 $4$ 号和 $1$ 号城市，并在 $1$ 号城市休息：第 $3$ 个月到达 $5$ 号城市，并在 $5$ 号城市休息。\n\n这样的方案序列有很多种，设每种方案序列中第 $i$ 个月旅行中当月获得的快乐值与疲劳值的差绝对值为 $d_i$，设第 $k$ 种方案序列中求出的 $d_1,d_2,\\ldots,d_m$ 这个 $m$ 值的最大值为 $c_k$，小 L 希望所选择的方案序列的 $c_k$ 在所有方案序列中是最小的。\n\n事实上，可能有多个方案序列的 $c_k$ 达到并列最小值。由于小 L 喜爱编程，他患上了一定的强迫症（虽然他自己认为他的强迫症让他炫的发黄），他希望给他的序列是这多个方案中字典序最小的。\n\nTips：比较两个序列字典序即比较第一个不相同数字的大小，如 $(1,2,3,4)<(1,2,4,3)$。", "inputFormat": "第一行为两个空格隔开的正整数 $n, m$，表示旅行的城市数与旅行所花的月数。\n\n接下来 $n$ 行，其中第 $i$ 行包含两个空格隔开的整数 $A_i$ 和 $B_i$，$A_i$ 表示他第 $i$ 个去的城市编号，$B_i$ 为 $0$ 或 $1$。如果 $B_i=0$ 则表示城市 $A_i$ 没有小 L 想去的景点，如果 $B_i=1$ 则表示城市 $A_i$ 有小 L 想去的景点，$A_i$ 两两不同且有 $1\\leq  A_i\\leq N$，即 $\\{A_i\\}$ 为 $1,2,\\ldots,N$ 的一个排列。", "outputFormat": "输出仅包含一行，包含 $m$ 个空格隔开的正整数 $X_1,X_2,\\ldots,X_m$，即给小 L 安排的旅行计划对应的路线。\n", "hint": "第 $1$ 个月得到 $2$ 点快乐值与 $2$ 点疲劳值，第 $2$ 个月得到 $1$ 点快乐值与 $1$ 点疲劳值，第 $3$ 个月得到 $1$ 点快乐值与 $1$ 点疲劳值。$3$ 个月中疲劳值与快乐值差的最大值为 $0$，达到所有方案最小值。\n\n可行方案有：\n\n- 1 6 8\n- 3 6 8\n- 3 1 8\n\n其中 1 6 8 字典序最小。\n\n$N \\leq 5 \\times 10^5$，$M \\leq 2 \\times 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2013] Travel", "background": "", "description": "In the distant country of HX, there lives a traveler named Xiao L. He wants to ride his bicycle across the entire country. There are $n$ cities in this country, numbered from $1$ to $n$.\n\nSome cities have no attraction that Xiao L wants to visit, while some cities have exactly one such attraction. Every city is one of these two types. As an information science enthusiast, he wrote a program that arranged a shortest route to reach all the attractions he wants to visit (the city numbers along the route are in an arbitrary order). He reaches city $a_1$ first, city $a_i$ as the $i$-th city, and finally ends the trip at city $a_n$. Xiao L wants to finish this trip in exactly $m$ months ($m < n$), so he needs a sensible plan.\n\nWhen he arrives at a city, if that city has an attraction he wants to visit, he gains $1$ point of happiness; otherwise, he gains $1$ point of fatigue due to the tiring journey. One month is enough for him to travel through any number of cities, but he also wants to take some time to rest. He always rests in the last city he reaches in that month (if this city has an attraction, Xiao L will always visit the attraction before resting). Of course, Xiao L wants to have some travel tasks every month. Even if none of the cities he reaches that month has an attraction, he will still arrive at least one new city in that month.\n\nXiao L cannot arrange the travel plan by himself, so he asks for your help. You need to provide a sequence $x_1, x_2, \\ldots, x_m$, where $x_i$ is the city number where Xiao L rests in the $i$-th month. Since he must finish his trip in the last month, $x_m$ must equal $a_n$. For example, let $n = 5$, $m = 3$, $(a_1, a_2, a_3, a_4, a_5) = (3, 2, 4, 1, 5)$, and $(x_1, x_2, x_3) = (2, 1, 5)$. This means: in month $1$ he reaches cities $3$ and $2$ in order and rests in city $2$; in month $2$ he reaches cities $4$ and $1$ in order and rests in city $1$; in month $3$ he reaches city $5$ and rests in city $5$.\n\nThere are many such feasible sequences. Let $d_i$ be the absolute value of the difference between the happiness and fatigue obtained in month $i$ for a given plan. For the $k$-th feasible plan, let $c_k$ be the maximum of $d_1, d_2, \\ldots, d_m$. Xiao L wants to choose a plan that minimizes $c_k$ among all feasible plans.\n\nIn fact, there may be multiple plans achieving the same minimal $c_k$. Since Xiao L loves programming, he has a bit of OCD (and believes that it makes him look cool). Among all the plans with minimal $c_k$, he wants the lexicographically smallest sequence.\n\nTips: To compare two sequences lexicographically, compare the first position where they differ, e.g., $(1, 2, 3, 4) < (1, 2, 4, 3)$.", "inputFormat": "The first line contains two space-separated positive integers $n, m$, denoting the number of cities and the number of months.\n\nThe next $n$ lines each contain two space-separated integers $A_i$ and $B_i$. Here $A_i$ is the city number he reaches in the $i$-th step, and $B_i$ is $0$ or $1$. If $B_i = 0$, then city $A_i$ has no attraction Xiao L wants to visit; if $B_i = 1$, then city $A_i$ has such an attraction. The $A_i$ are pairwise distinct and satisfy $1 \\leq A_i \\leq n$, i.e., $\\{A_i\\}$ is a permutation of $1, 2, \\ldots, n$.", "outputFormat": "Output exactly one line containing $m$ space-separated positive integers $X_1, X_2, \\ldots, X_m$, which is the planned sequence of rest-city numbers for Xiao L’s trip.", "hint": "In the first month, he gains $2$ points of happiness and $2$ points of fatigue. In the second month, he gains $1$ point of happiness and $1$ point of fatigue. In the third month, he gains $1$ point of happiness and $1$ point of fatigue. The maximum difference between fatigue and happiness over the $3$ months is $0$, which is the minimal possible value among all plans.\n\nFeasible plans include:\n- 1 6 8\n- 3 6 8\n- 3 1 8\n\nAmong these, 1 6 8 is lexicographically smallest.\n\nConstraints: $n \\leq 5 \\times 10^5$, $m \\leq 2 \\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2013] 旅行", "background": "", "description": "在遥远的 HX 国，住着一个旅行家小 L，他希望骑着他的自行车游遍全国。在这个国家中，每个城市都有一个编号，共有 $n$ 个城市，编号从 $1$ 到 $n$。\n\n有的城市没有小 L 想去的景点，而有的城市有且仅有一个小 L 想去的景点，所有的城市都是这两种情况之一，小 L 非常热爱信息学，他编写程序给他的旅行安排了一条最短路线以到达所有他想去的景点（所有的通知旅行线路上城市编号是乱序的）：他第 $1$ 个到达的城市编号为 $a_1$，第 $i$ 个到达的城市编号为 $a_i$，最后到达城市 $a_n$ 结束这次旅行。小L希望用恰好的 $m$ 个月（$m<n$）的时间完成这次旅行，所以他需要制定一个理性的旅游计划。\n\n当他抵达一个城市时，如果这个城市有他想要去的景点，他会因此获得 $1$ 点快乐值；但是若到达的城市没有他想去的景点，他会因旅途的疲惫得到 $1$ 点的疲劳值：一个月的时间足够他游玩任意多个城市，但他也希望拿出一点时间来休息。他每个月总是在本月所到达的最后一个城市休息（但如果这个城市有景点，那么小 L 总会游玩这个景点再休息）。当然，小 L 希望每个月都能有一定的旅行任务。即便这个月他所到达的城市中并没有他想去的的景点，换句话说，每个月他都会至少到达一个新的城市。\n\n小 L 无法自己安排旅行计划，所以求助于你。你需要告诉他一个序列：$x_1,x_2,\\ldots,x_m$，其中 $x_i$ 表示小 L 第 $i$ 个月休息时。他所在的城市编号：由于他最后一个月必须完成他的旅行，所以 $x_m$ 肯定等于 $a_n$，例如，设 $n=5$，$m=3$，$(a_1,a_2,a_3,a_4,a_5)=(3,2,4,1,5)$，$(x_1,x_2,x_3)=(2,1,5)$，这意味着：第 $1$ 个月先后到达 $3$ 号和 $2$ 号城市，并在 $2$ 号城市休息：第 $2$ 个月先后到达 $4$ 号和 $1$ 号城市，并在 $1$ 号城市休息：第 $3$ 个月到达 $5$ 号城市，并在 $5$ 号城市休息。\n\n这样的方案序列有很多种，设每种方案序列中第 $i$ 个月旅行中当月获得的快乐值与疲劳值的差绝对值为 $d_i$，设第 $k$ 种方案序列中求出的 $d_1,d_2,\\ldots,d_m$ 这个 $m$ 值的最大值为 $c_k$，小 L 希望所选择的方案序列的 $c_k$ 在所有方案序列中是最小的。\n\n事实上，可能有多个方案序列的 $c_k$ 达到并列最小值。由于小 L 喜爱编程，他患上了一定的强迫症（虽然他自己认为他的强迫症让他炫的发黄），他希望给他的序列是这多个方案中字典序最小的。\n\nTips：比较两个序列字典序即比较第一个不相同数字的大小，如 $(1,2,3,4)<(1,2,4,3)$。", "inputFormat": "第一行为两个空格隔开的正整数 $n, m$，表示旅行的城市数与旅行所花的月数。\n\n接下来 $n$ 行，其中第 $i$ 行包含两个空格隔开的整数 $A_i$ 和 $B_i$，$A_i$ 表示他第 $i$ 个去的城市编号，$B_i$ 为 $0$ 或 $1$。如果 $B_i=0$ 则表示城市 $A_i$ 没有小 L 想去的景点，如果 $B_i=1$ 则表示城市 $A_i$ 有小 L 想去的景点，$A_i$ 两两不同且有 $1\\leq  A_i\\leq N$，即 $\\{A_i\\}$ 为 $1,2,\\ldots,N$ 的一个排列。", "outputFormat": "输出仅包含一行，包含 $m$ 个空格隔开的正整数 $X_1,X_2,\\ldots,X_m$，即给小 L 安排的旅行计划对应的路线。\n", "hint": "第 $1$ 个月得到 $2$ 点快乐值与 $2$ 点疲劳值，第 $2$ 个月得到 $1$ 点快乐值与 $1$ 点疲劳值，第 $3$ 个月得到 $1$ 点快乐值与 $1$ 点疲劳值。$3$ 个月中疲劳值与快乐值差的最大值为 $0$，达到所有方案最小值。\n\n可行方案有：\n\n- 1 6 8\n- 3 6 8\n- 3 1 8\n\n其中 1 6 8 字典序最小。\n\n$N \\leq 5 \\times 10^5$，$M \\leq 2 \\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P3230", "type": "P", "difficulty": 5, "samples": [["4\n4 3 6 4", "3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "各省省选", "湖南", "深度优先搜索 DFS", "记忆化搜索", "哈希 hashing"], "title": "[HNOI2013] 比赛", "background": "", "description": "沫沫非常喜欢看足球赛，但因为沉迷于射箭游戏，错过了最近的一次足球联赛。此次联赛共 $N$ 支球队参加，比赛规则如下：\n\n1. 每两支球队之间踢一场比赛；\n\n2. 若平局，两支球队各得 $1$ 分；\n\n3. 否则胜利的球队得 $3$ 分，败者不得分。 尽管非常遗憾没有观赏到精彩的比赛，但沫沫通过新闻知道了每只球队的最后总得分， 然后聪明的她想计算出有多少种可能的比赛过程。\n\n譬如有 $3$ 支球队，每支球队最后均积 $3$ 分，那么有两种可能的情况：\n\n可能性 $1$ and 可能性 $2$\n\n| 球队 | $A$ | $B$ | $C$ | 得分 | 球队 | $A$ | $B$ | $C$ | 得分 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $A$ | - | $3$ | $0$ | $3$ | $A$ | - | $0$ | $3$ | $3$ |\n| $B$ | $0$ | - | $3$ | $3$ | $B$ | $3$ | - | $0$ | $3$ |\n| $C$ | $3$ | $0$ | - | $3$ | $C$ | $0$ | $3$ | - | $3$ |\n\n但沫沫发现当球队较多时，计算工作量将非常大，所以这个任务就交给你了。请你计算出可能的比赛过程的数目，由于答案可能很大，你只需要输出答案对 $10^9+7$ 取模的结果。", "inputFormat": "第一行是一个正整数 $N$，表示一共有 $N$ 支球队。 接下来一行 $N$ 个非负整数，依次表示各队的最后总得分。 输入保证 $20\\%$ 的数据满足 $N\\leq4$，$40\\%$ 的数据满足 $N\\leq6$，$60\\%$ 的数据满足 $N\\leq8$，$100\\%$ 的数据满足 $3\\leq N\\leq10$ 且至少存在一组解。\n", "outputFormat": "仅包含一个整数，表示答案对 $10^9+7$ 取模的结果。", "hint": "$20\\%$ 的数据满足 $N≤4$;\n\n$40\\%$ 的数据满足 $N≤6$;\n\n$60\\%$ 的数据满足 $N≤8$;\n\n$100\\%$ 的数据满足 $3≤N≤10$ 且至少存在一组解。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2013] Competition", "background": "", "description": "Momo loves watching soccer matches, but she missed the latest league because she was addicted to an archery game. There are $N$ teams in the league, and the rules are as follows:\n1. Every pair of teams plays exactly one match.\n2. If a match ends in a draw, each team gets $1$ point.\n3. Otherwise, the winner gets $3$ points and the loser gets $0$ points.\n\nAlthough she could not watch the exciting matches, Momo learned from the news the final total points of each team. Now she wants to compute how many possible tournament outcomes are consistent with these totals.\n\nFor example, if there are $3$ teams and each team finishes with $3$ points, then there are two possibilities:\n\nPossibility $1$ and Possibility $2$\n\n| Team | $A$ | $B$ | $C$ | Points | Team | $A$ | $B$ | $C$ | Points |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $A$ | - | $3$ | $0$ | $3$ | $A$ | - | $0$ | $3$ | $3$ |\n| $B$ | $0$ | - | $3$ | $3$ | $B$ | $3$ | - | $0$ | $3$ |\n| $C$ | $3$ | $0$ | - | $3$ | $C$ | $0$ | $3$ | - | $3$ |\n\nSince the answer can be large, output it modulo $10^9+7$.", "inputFormat": "The first line contains a positive integer $N$, the number of teams.  \nThe second line contains $N$ non-negative integers, giving the final total points of each team in order.", "outputFormat": "Output a single integer, the answer modulo $10^9+7$.", "hint": "- $20\\%$ of the testdata satisfies $N \\le 4$.\n- $40\\%$ of the testdata satisfies $N \\le 6$.\n- $60\\%$ of the testdata satisfies $N \\le 8$.\n- $100\\%$ of the testdata satisfies $3 \\le N \\le 10$, and there exists at least one solution.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2013] 比赛", "background": "", "description": "沫沫非常喜欢看足球赛，但因为沉迷于射箭游戏，错过了最近的一次足球联赛。此次联赛共 $N$ 支球队参加，比赛规则如下：\n\n1. 每两支球队之间踢一场比赛；\n\n2. 若平局，两支球队各得 $1$ 分；\n\n3. 否则胜利的球队得 $3$ 分，败者不得分。 尽管非常遗憾没有观赏到精彩的比赛，但沫沫通过新闻知道了每只球队的最后总得分， 然后聪明的她想计算出有多少种可能的比赛过程。\n\n譬如有 $3$ 支球队，每支球队最后均积 $3$ 分，那么有两种可能的情况：\n\n可能性 $1$ and 可能性 $2$\n\n| 球队 | $A$ | $B$ | $C$ | 得分 | 球队 | $A$ | $B$ | $C$ | 得分 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $A$ | - | $3$ | $0$ | $3$ | $A$ | - | $0$ | $3$ | $3$ |\n| $B$ | $0$ | - | $3$ | $3$ | $B$ | $3$ | - | $0$ | $3$ |\n| $C$ | $3$ | $0$ | - | $3$ | $C$ | $0$ | $3$ | - | $3$ |\n\n但沫沫发现当球队较多时，计算工作量将非常大，所以这个任务就交给你了。请你计算出可能的比赛过程的数目，由于答案可能很大，你只需要输出答案对 $10^9+7$ 取模的结果。", "inputFormat": "第一行是一个正整数 $N$，表示一共有 $N$ 支球队。 接下来一行 $N$ 个非负整数，依次表示各队的最后总得分。 输入保证 $20\\%$ 的数据满足 $N\\leq4$，$40\\%$ 的数据满足 $N\\leq6$，$60\\%$ 的数据满足 $N\\leq8$，$100\\%$ 的数据满足 $3\\leq N\\leq10$ 且至少存在一组解。\n", "outputFormat": "仅包含一个整数，表示答案对 $10^9+7$ 取模的结果。", "hint": "$20\\%$ 的数据满足 $N≤4$;\n\n$40\\%$ 的数据满足 $N≤6$;\n\n$60\\%$ 的数据满足 $N≤8$;\n\n$100\\%$ 的数据满足 $3≤N≤10$ 且至少存在一组解。", "locale": "zh-CN"}}}
{"pid": "P3231", "type": "P", "difficulty": 6, "samples": [["1\n4  4 4\n1  0 1 1\n0  0 1 1\n0  0 0 0\n0  0 0 0\n0  0 1 1\n1  0 1 1\n0  0 0 0\n0  0 0 0\n0  0 0 0\n0  0 0 0\n1  0 0 0\n0  0 0 0\n0  0 0 0\n0  0 0 0\n0  0 0 0\n1  0 0 0", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2013", "各省省选", "湖南", "枚举", "二分图"], "title": "[HNOI2013] 消毒", "background": "", "description": "\n最近在生物实验室工作的小 T 遇到了大麻烦。 由于实验室最近升级的缘故，他的分格实验皿是一个长方体，其尺寸为 $a\\times b\\times c$。为了实验的方便，它被划分为 $a\\times b\\times c$ 个单位立方体区域，每个单位立方体尺寸为 $1\\times 1\\times 1$，并用 $(i,j,k)$ 标识一个单位立方体。这个实验皿已经很久没有人用了。现在，小 T 被导师要求将其中一些单位立方体区域进行消毒操作（每个区域可以被重复消毒）。\n\n而由于严格的实验要求，他被要求使用一种特定的 F 试剂来进行消毒。 这种 F 试剂特别奇怪，每次对尺寸为 $x\\times y\\times z$ 的长方体区域（它由 $x\\times y\\times z$ 个单位立方体组成）进行消毒时，只需要使用 $\\min(x,y,z)$ 单位的 F 试剂。F 试剂的价格不菲，这可难倒了小 T。\n\n现在请你告诉他，最少要用多少单位的 F 试剂。", "inputFormat": "**本题有多组数据。**\n\n第一行是一个正整数 $D$，表示数据组数。\n\n接下来是 $D$ 组数据，每组数据第一行是三个正整数 $a,b,c$ 表示实验皿的尺寸。\n\n接下来会出现 $a$ 个 $b$ 行 $c$ 列的用空格隔开的 `01` 矩阵，`0` 表示对应的单位立方体不要求消毒，`1` 表示对应的单位立方体需要消毒：如，如果第 $1$ 个 `01` 矩阵的第 $2$ 行第 $3$ 列为 `1`，则表示单位立方体 $(1,2,3)$ 需要被消毒。", "outputFormat": "$D$ 行，每行一个整数，表示对应实验皿最少要用多少单位的 F 试剂。", "hint": "#### 样例 1 解释\n对于区域 $(1,1,3)-(2,2,4)$ 和 $(1,1,1)-(4,4,1)$ 消毒，分别花费 $2$ 个单位和 $1$ 个单位的 F 试剂。\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1\\le a,b,c\\le 5\\times 10^3$，$abc\\le 5\\times 10^3$，且 $1\\le D\\le 3$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2013] Disinfection", "background": "", "description": "Xiao T has run into big trouble while working in a biology lab. Due to a recent upgrade, his compartmentalized dish is a rectangular box with dimensions $a\\times b\\times c$. For convenience, it is partitioned into $a\\times b\\times c$ unit cubes, each of size $1\\times 1\\times 1$, and a unit cube is denoted by $(i, j, k)$. The dish has not been used for a long time. Now, Xiao T is required by his advisor to disinfect some of the unit cubes (each unit cube may be disinfected multiple times).\n\nDue to strict experimental requirements, he must use a specific reagent F. This reagent F is peculiar: each time he disinfects a rectangular box of size $x\\times y\\times z$ (consisting of $x\\times y\\times z$ unit cubes), it costs only $\\min(x, y, z)$ units of reagent F. Since reagent F is expensive, Xiao T wants to minimize the total amount used.\n\nPlease tell him the minimum total units of reagent F required.", "inputFormat": "This problem contains multiple testcases.\n\n- The first line contains a positive integer $D$, the number of testcases.\n- For each testcase, the first line contains three positive integers $a, b, c$, the dimensions of the dish.\n- Then follow $a$ blocks. For each $i=1,2,\\dots,a$, read a $b$-row, $c$-column `01` matrix with entries separated by spaces. `0` means the corresponding unit cube does not need disinfection, and `1` means it needs disinfection. For example, if the $(2, 3)$ entry of the first `01` matrix is `1`, then unit cube $(1, 2, 3)$ must be disinfected.", "outputFormat": "Output $D$ lines. For each testcase, output one integer: the minimum total units of reagent F required.", "hint": "Sample 1 explanation:\nDisinfecting regions $(1,1,3)-(2,2,4)$ and $(1,1,1)-(4,4,1)$ costs $2$ units and $1$ unit of reagent F, respectively.\n\nConstraints:\nFor $100\\%$ of the testdata, it is guaranteed that $1\\le a,b,c\\le 5\\times 10^3$, $abc\\le 5\\times 10^3$, and $1\\le D\\le 3$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2013] 消毒", "background": "", "description": "\n最近在生物实验室工作的小 T 遇到了大麻烦。 由于实验室最近升级的缘故，他的分格实验皿是一个长方体，其尺寸为 $a\\times b\\times c$。为了实验的方便，它被划分为 $a\\times b\\times c$ 个单位立方体区域，每个单位立方体尺寸为 $1\\times 1\\times 1$，并用 $(i,j,k)$ 标识一个单位立方体。这个实验皿已经很久没有人用了。现在，小 T 被导师要求将其中一些单位立方体区域进行消毒操作（每个区域可以被重复消毒）。\n\n而由于严格的实验要求，他被要求使用一种特定的 F 试剂来进行消毒。 这种 F 试剂特别奇怪，每次对尺寸为 $x\\times y\\times z$ 的长方体区域（它由 $x\\times y\\times z$ 个单位立方体组成）进行消毒时，只需要使用 $\\min(x,y,z)$ 单位的 F 试剂。F 试剂的价格不菲，这可难倒了小 T。\n\n现在请你告诉他，最少要用多少单位的 F 试剂。", "inputFormat": "**本题有多组数据。**\n\n第一行是一个正整数 $D$，表示数据组数。\n\n接下来是 $D$ 组数据，每组数据第一行是三个正整数 $a,b,c$ 表示实验皿的尺寸。\n\n接下来会出现 $a$ 个 $b$ 行 $c$ 列的用空格隔开的 `01` 矩阵，`0` 表示对应的单位立方体不要求消毒，`1` 表示对应的单位立方体需要消毒：如，如果第 $1$ 个 `01` 矩阵的第 $2$ 行第 $3$ 列为 `1`，则表示单位立方体 $(1,2,3)$ 需要被消毒。", "outputFormat": "$D$ 行，每行一个整数，表示对应实验皿最少要用多少单位的 F 试剂。", "hint": "#### 样例 1 解释\n对于区域 $(1,1,3)-(2,2,4)$ 和 $(1,1,1)-(4,4,1)$ 消毒，分别花费 $2$ 个单位和 $1$ 个单位的 F 试剂。\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1\\le a,b,c\\le 5\\times 10^3$，$abc\\le 5\\times 10^3$，且 $1\\le D\\le 3$。\n", "locale": "zh-CN"}}}
{"pid": "P3232", "type": "P", "difficulty": 6, "samples": [["3 3\n2 3\n1 2\n1 3", "3.333"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "各省省选", "江苏", "湖南", "期望", "高斯消元"], "title": "[HNOI2013 / JSOI2013] 游走", "background": null, "description": "给定一个 $n$ 个点 $m$ 条边的无向连通图，顶点从 $1$ 编号到 $n$，边从 $1$ 编号到 $m$。 \n\n小 Z 在该图上进行随机游走，初始时小 Z 在 $1$ 号顶点，每一步小 Z 以相等的概率随机选择当前顶点的某条边，沿着这条边走到下一个顶点，获得等于这条边的编号的分数。当小 Z 到达 $n$ 号顶点时游走结束，总分为所有获得的分数之和。 现在，请你对这 $m$ 条边进行编号，使得小 Z 获得的总分的期望值最小。", "inputFormat": "第一行是两个整数，分别表示该图的顶点数 $n$ 和边数 $m$。\n\n接下来 $m$ 行每行两个整数 $u,v$，表示顶点 $u$ 与顶点 $v$ 之间存在一条边。", "outputFormat": "输出一行一个实数表示答案，保留三位小数。", "hint": "#### 样例输入输出 1 解释\n\n边 $(1,2)$ 编号为 $1$，边 $(1,3)$ 编号 $2$，边 $(2,3)$ 编号为 $3$。\n\n---\n\n#### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，保证 $n\\leq 10$。\n- 对于 $100\\%$ 的数据，保证 $2\\leq n \\leq 500$， $1 \\leq m \\leq 125000$，$1 \\leq u, v \\leq n$，给出的图无重边和自环，且从 $1$ 出发可以到达所有的节点。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2013] Random Walk", "background": "", "description": "Given an undirected connected graph with $n$ vertices and $m$ edges. The vertices are numbered from $1$ to $n$, and the edges are to be numbered from $1$ to $m$.\n\nXiao Z performs a random walk on this graph. Initially, Xiao Z is at vertex $1$. At each step, Xiao Z chooses one incident edge of the current vertex uniformly at random, traverses it to the next vertex, and obtains a score equal to the label of that edge. The walk ends when Xiao Z reaches vertex $n$. The total score is the sum of all scores obtained. Now, please assign labels to the $m$ edges so that the expected value of Xiao Z’s total score is minimized.", "inputFormat": "The first line contains two integers, representing the number of vertices $n$ and the number of edges $m$.\n\nThe next $m$ lines each contain two integers $u, v$, indicating that there is an edge between vertices $u$ and $v$.", "outputFormat": "Output one real number: the answer, rounded to three decimal places.", "hint": "#### Explanation for Sample 1\n\nEdge $(1, 2)$ is labeled $1$, edge $(1, 3)$ is labeled $2$, and edge $(2, 3)$ is labeled $3$.\n\n---\n\n#### Constraints\n\n- For $30\\%$ of the testdata, it is guaranteed that $n \\leq 10$.\n- For $100\\%$ of the testdata, it is guaranteed that $2 \\leq n \\leq 500$, $1 \\leq m \\leq 125000$, $1 \\leq u, v \\leq n$; the given graph has no multiple edges and no self-loops, and every node is reachable from $1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2013 / JSOI2013] 游走", "background": null, "description": "给定一个 $n$ 个点 $m$ 条边的无向连通图，顶点从 $1$ 编号到 $n$，边从 $1$ 编号到 $m$。 \n\n小 Z 在该图上进行随机游走，初始时小 Z 在 $1$ 号顶点，每一步小 Z 以相等的概率随机选择当前顶点的某条边，沿着这条边走到下一个顶点，获得等于这条边的编号的分数。当小 Z 到达 $n$ 号顶点时游走结束，总分为所有获得的分数之和。 现在，请你对这 $m$ 条边进行编号，使得小 Z 获得的总分的期望值最小。", "inputFormat": "第一行是两个整数，分别表示该图的顶点数 $n$ 和边数 $m$。\n\n接下来 $m$ 行每行两个整数 $u,v$，表示顶点 $u$ 与顶点 $v$ 之间存在一条边。", "outputFormat": "输出一行一个实数表示答案，保留三位小数。", "hint": "#### 样例输入输出 1 解释\n\n边 $(1,2)$ 编号为 $1$，边 $(1,3)$ 编号 $2$，边 $(2,3)$ 编号为 $3$。\n\n---\n\n#### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，保证 $n\\leq 10$。\n- 对于 $100\\%$ 的数据，保证 $2\\leq n \\leq 500$， $1 \\leq m \\leq 125000$，$1 \\leq u, v \\leq n$，给出的图无重边和自环，且从 $1$ 出发可以到达所有的节点。", "locale": "zh-CN"}}}
{"pid": "P3233", "type": "P", "difficulty": 6, "samples": [["10\n2 1\n3 2\n4 3\n5 4\n6 1\n7 3\n8 3\n9 4\n10 1\n5\n2\n6 1\n5\n2 7 3 6 9\n1\n8\n4\n8 7 10 3\n5\n2 9 3 5 8", "1 9   \n3 1 4 1 1   \n10  \n1 1 3 5   \n4 1 3 1 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2014", "倍增", "各省省选", "湖南", "最近公共祖先 LCA", "虚树"], "title": "[HNOI2014] 世界树", "background": "", "description": "世界树是一棵无比巨大的树，它伸出的枝干构成了整个世界。在这里，生存着各种各样的种族和生灵，他们共同信奉着绝对公正公平的女神艾莉森，在他们的信条里，公平是使世界树能够生生不息、持续运转的根本基石。\n\n世界树的形态可以用一个数学模型来描述：世界树中有 $n$ 个种族，种族的编号分别从 $1$ 到 $n$，分别生活在编号为 $1$ 到 $n$ 的聚居地上，种族的编号与其聚居地的编号相同。有的聚居地之间有双向的道路相连，道路的长度为 $1$。保证连接的方式会形成一棵树结构，即所有的聚居地之间可以互相到达，并且不会出现环。定义两个聚居地之间的距离为连接他们的道路的长度；例如，若聚居地 $a$ 和 $b$ 之间有道路，$b$ 和 $c$ 之间有道路，因为每条道路长度为 $1$ 而且又不可能出现环，所以 $a$ 与 $c$ 之间的距离为 $2$。\n\n出于对公平的考虑，第 $i$ 年，世界树的国王需要授权 $m_i$ 个种族的聚居地为临时议事处。对于某个种族 $x$（$x$ 为种族的编号），如果距离该种族最近的临时议事处为 $y$（$y$ 为议事处所在聚居地的编号），则种族 $x$ 将接受 $y$ 议事处的管辖（如果有多个临时议事处到该聚居地的距离一样，则 $y$ 为其中编号最小的临时议事处）。\n\n现在国王想知道，在 $q$ 年的时间里，每一年完成授权后，当年每个临时议事处将会管理多少个种族（议事处所在的聚居地也将接受该议事处管理）。 现在这个任务交给了以智慧著称的灵长类的你：程序猿。请帮国王完成这个任务吧。", "inputFormat": "第一行为一个正整数 $n$，表示世界树中种族的个数。接下来 $n-1$ 行，每行两个正整数 $x，y$，表示 $x$ 聚居地与 $y$ 聚居地之间有一条长度为 $1$ 的双向道路。接下来一行为一个正整数 $q$，表示国王询问的年数。接下来 $q$ 块，每块两行：第 $i$ 块的第一行为 $1$ 个正整数 $m_i$，表示第 $i$ 年授权的临时议事处的个数。第 $i$ 块的第二行为 $m_i$ 个正整数 $h_1, h_2,\\ldots,h_{m_i}$，表示被授权为临时议事处的聚居地编号（保证互不相同）。\n", "outputFormat": "输出包含 $q$ 行，第 $i$ 行为 $m_i$ 个整数，该行的第 $j$ ($j=1, 2,\\ldots, m_i$) 个数表示第 $i$ 年被授权的聚居地 $h_j$ 的临时议事处管理的种族个数。\n", "hint": "对于 $100\\%$ 的数据，$N\\leq 300000$, $q\\leq 300000$, $\\sum^q_{i=1}m_i \\leq 300000$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2014] World Tree", "background": "", "description": "The World Tree is an unimaginably huge tree whose sprawling branches form the entire world. Here live various races and beings. They all worship the goddess Alison, who stands for absolute justice and fairness. In their creed, fairness is the fundamental cornerstone that allows the World Tree to thrive and keep running.\n\nThe shape of the World Tree can be modeled mathematically: there are $n$ races in the World Tree, numbered from $1$ to $n$, each living in a settlement also numbered from $1$ to $n$, and a race’s number equals its settlement’s number. Some settlements are connected by bidirectional roads, each of length $1$. It is guaranteed that the connections form a tree, that is, every settlement is reachable from every other, and there are no cycles. The distance between two settlements is defined as the length of the unique path connecting them. For example, if there is a road between settlements $a$ and $b$, and a road between $b$ and $c$, then since each road has length $1$ and cycles are impossible, the distance between $a$ and $c$ is $2$.\n\nFor fairness, in year $i$, the king of the World Tree authorizes $m_i$ settlements as temporary offices. For a race $x$ (where $x$ is the race’s number), if the nearest temporary office to race $x$ is at settlement $y$ (where $y$ is the settlement number of the office), then race $x$ accepts the administration of the office at $y$ (if multiple temporary offices are at the same minimum distance to that settlement, then $y$ is the office with the smallest number among them).\n\nNow the king wants to know, over $q$ years, after the authorizations in each year are completed, how many races each temporary office will administer that year (the settlement where an office is located also accepts that office’s administration). This task is handed to you, the wise primate: the programmer. Please help the king complete this task.", "inputFormat": "The first line contains a positive integer $n$, the number of races in the World Tree. The next $n-1$ lines each contain two positive integers $x, y$, indicating that there is a bidirectional road of length $1$ between settlements $x$ and $y$. The next line contains a positive integer $q$, the number of years the king queries. Then follow $q$ blocks, each consisting of two lines: in the $i$-th block, the first line contains one positive integer $m_i$, the number of temporary offices authorized in year $i$. The second line contains $m_i$ positive integers $h_1, h_2, \\ldots, h_{m_i}$, the settlement numbers authorized as temporary offices (guaranteed to be all distinct).", "outputFormat": "Output $q$ lines. In the $i$-th line, output $m_i$ integers, where the $j$-th number ($j = 1, 2, \\ldots, m_i$) is the number of races administered by the temporary office at settlement $h_j$ authorized in year $i$.", "hint": "For $100\\%$ of the testdata, $N\\leq 300000$, $q\\leq 300000$, $\\sum^q_{i=1}m_i \\leq 300000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2014] 世界树", "background": "", "description": "世界树是一棵无比巨大的树，它伸出的枝干构成了整个世界。在这里，生存着各种各样的种族和生灵，他们共同信奉着绝对公正公平的女神艾莉森，在他们的信条里，公平是使世界树能够生生不息、持续运转的根本基石。\n\n世界树的形态可以用一个数学模型来描述：世界树中有 $n$ 个种族，种族的编号分别从 $1$ 到 $n$，分别生活在编号为 $1$ 到 $n$ 的聚居地上，种族的编号与其聚居地的编号相同。有的聚居地之间有双向的道路相连，道路的长度为 $1$。保证连接的方式会形成一棵树结构，即所有的聚居地之间可以互相到达，并且不会出现环。定义两个聚居地之间的距离为连接他们的道路的长度；例如，若聚居地 $a$ 和 $b$ 之间有道路，$b$ 和 $c$ 之间有道路，因为每条道路长度为 $1$ 而且又不可能出现环，所以 $a$ 与 $c$ 之间的距离为 $2$。\n\n出于对公平的考虑，第 $i$ 年，世界树的国王需要授权 $m_i$ 个种族的聚居地为临时议事处。对于某个种族 $x$（$x$ 为种族的编号），如果距离该种族最近的临时议事处为 $y$（$y$ 为议事处所在聚居地的编号），则种族 $x$ 将接受 $y$ 议事处的管辖（如果有多个临时议事处到该聚居地的距离一样，则 $y$ 为其中编号最小的临时议事处）。\n\n现在国王想知道，在 $q$ 年的时间里，每一年完成授权后，当年每个临时议事处将会管理多少个种族（议事处所在的聚居地也将接受该议事处管理）。 现在这个任务交给了以智慧著称的灵长类的你：程序猿。请帮国王完成这个任务吧。", "inputFormat": "第一行为一个正整数 $n$，表示世界树中种族的个数。接下来 $n-1$ 行，每行两个正整数 $x，y$，表示 $x$ 聚居地与 $y$ 聚居地之间有一条长度为 $1$ 的双向道路。接下来一行为一个正整数 $q$，表示国王询问的年数。接下来 $q$ 块，每块两行：第 $i$ 块的第一行为 $1$ 个正整数 $m_i$，表示第 $i$ 年授权的临时议事处的个数。第 $i$ 块的第二行为 $m_i$ 个正整数 $h_1, h_2,\\ldots,h_{m_i}$，表示被授权为临时议事处的聚居地编号（保证互不相同）。\n", "outputFormat": "输出包含 $q$ 行，第 $i$ 行为 $m_i$ 个整数，该行的第 $j$ ($j=1, 2,\\ldots, m_i$) 个数表示第 $i$ 年被授权的聚居地 $h_j$ 的临时议事处管理的种族个数。\n", "hint": "对于 $100\\%$ 的数据，$N\\leq 300000$, $q\\leq 300000$, $\\sum^q_{i=1}m_i \\leq 300000$。\n", "locale": "zh-CN"}}}
{"pid": "P3234", "type": "P", "difficulty": 6, "samples": [["10\n2\n1234567890*1234567890\n1234567890a1234567890\n2\n1234567890*1234567890\n1234567890*1234567890\n2\n1234*67890a1234567890\n1234567890*1234567890\n2\n1234567890*1234567890\n1234567890a12345*7890\n2\n1234567890*1234567890\n*12345\n2\n12345*67890\n1234567890*1234567890\n2\n1234567890*1234567890\n12345*\n2\n1234567890*1234567890\n*67890\n2\n67890*\n1234567890*1234567890\n2\n1234567890*a*1234567890\n1234567890*1234567890", "Y\r\nY\r\nY\r\nY\r\nN\r\nY\r\nY\r\nY\r\nN\r\nY"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["字符串", "2014", "各省省选", "湖南", "哈希 hashing", "前缀和"], "title": "[HNOI2014] 抄卡组", "background": null, "description": "一天闲着无聊的小 L 找来了当前正火爆的游戏《炉石传说》来玩，但是怎么打怎么输，于是他大喊一声“我要抄卡组！”就找来了游戏传说组第一名的游戏高手小 H 的直播来看。\n\n但是小 L 家的网络技术还停留在拨号，看着直播画面又是卡顿又是花屏，他不给力的网络让他完全无法记录小 H 展示的给力的卡组。小 L 周围都是学霸没有人玩游戏想去帮他这个忙，但是学霸们热衷于讨论各种信息学问题。\n\n于是他想到了一个方法：由于每次花屏的屏幕位置不一样，于是小 H 每次总能记录下卡组的一些部分，如果这样记录多次，不就有可能还原出小 L 想要的一个卡组么？\n\n但是存在的一个问题是，小 H 每次展示的卡组有可能不一样，所以他想知道他每次看直播抄下来几次的卡组碎片是否一致。\n\n这样一来小 H 将他遇到的游戏问题抽象成这样一个学术问题让学霸（你）解决：`*`可以匹配任意长度个的字符 （包含 $0$ 个），问所有字符串是否两两匹配。", "inputFormat": "第一行包含一个正整数 $T$，表示了数据组数。  \n\n接下来包含 $T$ 组数据：  \n每组数据的第一行是一个正整数 $N$，表示该组数据酌字符串个数。  \n接下来 $N$ 行，每行一个字符串，字符串仅包含小写字母、数字、通配符术。\n\n**注意：** 数据为 UNIX 格式，中间包含空行，你可以采用逐字符读入的方式。", "outputFormat": "输出包含 $T$ 行，每行一个字母 `Y` 或者 `N`，`Y` 表示这组数据中所有字符串两两匹配，`N` 表示这组数据中至少有一对字符串不匹配。", "hint": "对于 $100\\%$ 的数据，满足 $N \\leq 100000，T = 10$，输入文件不超过 $10\\text{M}$，$N\\times$ 最长字符串长度不超过 $2\\times 10^8$。\n\n目前有且仅有 hack 数据中 $T = 1$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2014] Copying Decklists", "background": "", "description": "One day, a bored Xiao L started playing the currently popular game Hearthstone, but he kept losing. He shouted, “I’m going to copy a decklist!” and went to watch the livestream of top Legend player Xiao H.\n\nHowever, Xiao L’s internet is still stuck in the dial-up era. The livestream is laggy and garbled, and his poor connection makes it impossible to record the full powerful decklist Xiao H shows. No one around Xiao L plays games, but they are all top students who love discussing informatics problems.\n\nSo he came up with an idea: since each garbled frame appears in different positions on the screen, Xiao L can record some parts of the decklist each time. If he records many times, maybe he can reconstruct a decklist Xiao L wants.\n\nBut there’s a problem: the decklist Xiao H shows each time might be different. So he wants to know whether the decklist fragments he copied each time are consistent.\n\nAbstracted as an academic problem for you to solve: the wildcard `*` matches a string of any length (including $0$). Determine whether all the strings are pairwise matching.", "inputFormat": "The first line contains a positive integer $T$, the number of test cases.\n\nThen follow $T$ test cases:  \nFor each test case, the first line contains a positive integer $N$, the number of strings in this test case.  \nThen follow $N$ lines, each containing one string. Each string consists only of lowercase letters, digits, and the wildcard symbol `*`.\n\nNote: The testdata is in UNIX format and may contain blank lines. You may read the input character by character.", "outputFormat": "Output $T$ lines, each containing a single letter `Y` or `N`. `Y` means all strings in this test case are pairwise matching, and `N` means there exists at least one pair of strings that do not match.", "hint": "For $100\\%$ of the testdata, $N \\leq 100000$, $T = 10$, the input file size does not exceed $10\\text{M}$, and $N \\times$ the longest string length does not exceed $2 \\times 10^8$.\n\nCurrently, only in hack testdata, $T = 1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2014] 抄卡组", "background": null, "description": "一天闲着无聊的小 L 找来了当前正火爆的游戏《炉石传说》来玩，但是怎么打怎么输，于是他大喊一声“我要抄卡组！”就找来了游戏传说组第一名的游戏高手小 H 的直播来看。\n\n但是小 L 家的网络技术还停留在拨号，看着直播画面又是卡顿又是花屏，他不给力的网络让他完全无法记录小 H 展示的给力的卡组。小 L 周围都是学霸没有人玩游戏想去帮他这个忙，但是学霸们热衷于讨论各种信息学问题。\n\n于是他想到了一个方法：由于每次花屏的屏幕位置不一样，于是小 H 每次总能记录下卡组的一些部分，如果这样记录多次，不就有可能还原出小 L 想要的一个卡组么？\n\n但是存在的一个问题是，小 H 每次展示的卡组有可能不一样，所以他想知道他每次看直播抄下来几次的卡组碎片是否一致。\n\n这样一来小 H 将他遇到的游戏问题抽象成这样一个学术问题让学霸（你）解决：`*`可以匹配任意长度个的字符 （包含 $0$ 个），问所有字符串是否两两匹配。", "inputFormat": "第一行包含一个正整数 $T$，表示了数据组数。  \n\n接下来包含 $T$ 组数据：  \n每组数据的第一行是一个正整数 $N$，表示该组数据酌字符串个数。  \n接下来 $N$ 行，每行一个字符串，字符串仅包含小写字母、数字、通配符术。\n\n**注意：** 数据为 UNIX 格式，中间包含空行，你可以采用逐字符读入的方式。", "outputFormat": "输出包含 $T$ 行，每行一个字母 `Y` 或者 `N`，`Y` 表示这组数据中所有字符串两两匹配，`N` 表示这组数据中至少有一对字符串不匹配。", "hint": "对于 $100\\%$ 的数据，满足 $N \\leq 100000，T = 10$，输入文件不超过 $10\\text{M}$，$N\\times$ 最长字符串长度不超过 $2\\times 10^8$。\n\n目前有且仅有 hack 数据中 $T = 1$。", "locale": "zh-CN"}}}
{"pid": "P3235", "type": "P", "difficulty": 6, "samples": [["4 3\n1 1\n1 2\n1 3\n1 5", "0 0 1 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["递推", "2014", "各省省选", "湖南", "O2优化", "SG 函数"], "title": "[HNOI2014] 江南乐", "background": null, "description": "小 A 是一个名副其实的狂热的回合制游戏玩家。在获得了许多回合制游戏的世界级奖项之后，小 A 有一天突然想起了他小时候在江南玩过的一个回合制游戏。\n\n游戏的规则是这样的，首先给定一个数 $F$，然后游戏系统会产生 $T$ 组游戏。每一组游戏包含 $N$ 堆石子，小 A 和他的对手轮流操作。每次操作时，操作者先选定一个不小于 $2$ 的正整数 $M$（$M$ 是操作者自行选定的，而且每次操作时可不一样，但是 $M$ 不能大于选中的堆中的石子数量），然后将任意一堆数量不小于 $F$ 的石子分成 $M$ 堆，并且满足这 $M$ 堆石子中石子数最多的一堆至多比石子数最少的一堆多 $1$（即分的尽量平均，事实上按照这样的分石子万法，选定 $M$ 和一堆石子后，它分出来的状态是固定的）。当一个玩家不能操作的时候，也就是当每一堆石子的数量都严格小于 $F$ 时，他就输掉。补充：先手从 $N$ 堆石子中选择一堆数量不小于 $F$ 的石子分成 $M$ 堆后，此时共有 $N+M-1$ 堆石子，接下来小 A 从这 $N+M-1$ 堆石子中选择一堆数量不小于 $F$ 的石子，依此类推。\n\n小 A 从小就是个有风度的男生，他邀请他的对手作为先手。小 A 现在想要知道，面对给定的一组游戏，而且他的对手也和他一样聪明绝顶的话，究竟谁能够获得胜利？", "inputFormat": "输入第一行包含两个正整数 $T$ 和 $F$，分别表示游戏组数与给定的数。\n\n接下来 $T$ 行，每行第一个数 $N$ 表示该组游戏初始状态下有多少堆石子。之后 $N$ 个正整数，表示这 $N$ 堆石子分别有多少个。", "outputFormat": "输出一行，包含 $T$ 个用空格隔开的 $0$ 或 $1$ 的数，其中 $0$ 代表此时小 A（后手）会胜利，而 $1$ 代表小 A 的对手（先手）会胜利。", "hint": "对于 $100\\%$ 的数据，$T \\lt 100$，$N \\lt 100$，$F \\lt 100000$，每堆石子数量${}\\lt 100000$。\n\n以上所有数均为正整数。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2014] Jiangnan Le", "background": "", "description": "Xiao A is a true enthusiast of turn-based games. After winning many world-class awards in turn-based games, one day he suddenly remembered a turn-based game he played in Jiangnan when he was a child.\n\nThe rules are as follows. First, a number $F$ is given. Then the game system generates $T$ game instances. Each game instance contains $N$ heaps of stones. Xiao A and his opponent take turns. On each turn, the player first chooses a positive integer $M \\ge 2$ ($M$ is chosen by the player, and can differ from turn to turn, but $M$ cannot exceed the number of stones in the chosen heap). Then the player selects any heap with at least $F$ stones and splits it into $M$ heaps, such that among these $M$ heaps, the largest size is at most $1$ greater than the smallest size (i.e., as evenly as possible; in fact, under this splitting rule, once $M$ and a heap are fixed, the resulting state is determined). A player who cannot move, that is, when every heap has strictly fewer than $F$ stones, loses. Supplement: After the first player chooses one of the $N$ heaps with at least $F$ stones and splits it into $M$ heaps, there are $N + M - 1$ heaps in total. Next, Xiao A chooses one of these $N + M - 1$ heaps with at least $F$ stones, and so on.\n\nXiao A has always been a courteous boy, and he invites his opponent to move first. Now Xiao A wants to know, given each game instance and assuming his opponent is just as clever as he is, who will win.", "inputFormat": "The first line contains two positive integers $T$ and $F$, denoting the number of game instances and the given number, respectively.\n\nEach of the next $T$ lines describes one game instance. In each line, the first number $N$ is the number of initial heaps. Then follow $N$ positive integers, giving the sizes of these $N$ heaps.", "outputFormat": "Output one line containing $T$ numbers separated by single spaces. For each game instance, output $0$ if Xiao A (the second player) will win, and $1$ if Xiao A’s opponent (the first player) will win.", "hint": "For $100\\%$ of the testdata, $T < 100$, $N < 100$, $F < 100000$, and each heap size $< 100000$.\n\nAll the above numbers are positive integers.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2014] 江南乐", "background": null, "description": "小 A 是一个名副其实的狂热的回合制游戏玩家。在获得了许多回合制游戏的世界级奖项之后，小 A 有一天突然想起了他小时候在江南玩过的一个回合制游戏。\n\n游戏的规则是这样的，首先给定一个数 $F$，然后游戏系统会产生 $T$ 组游戏。每一组游戏包含 $N$ 堆石子，小 A 和他的对手轮流操作。每次操作时，操作者先选定一个不小于 $2$ 的正整数 $M$（$M$ 是操作者自行选定的，而且每次操作时可不一样，但是 $M$ 不能大于选中的堆中的石子数量），然后将任意一堆数量不小于 $F$ 的石子分成 $M$ 堆，并且满足这 $M$ 堆石子中石子数最多的一堆至多比石子数最少的一堆多 $1$（即分的尽量平均，事实上按照这样的分石子万法，选定 $M$ 和一堆石子后，它分出来的状态是固定的）。当一个玩家不能操作的时候，也就是当每一堆石子的数量都严格小于 $F$ 时，他就输掉。补充：先手从 $N$ 堆石子中选择一堆数量不小于 $F$ 的石子分成 $M$ 堆后，此时共有 $N+M-1$ 堆石子，接下来小 A 从这 $N+M-1$ 堆石子中选择一堆数量不小于 $F$ 的石子，依此类推。\n\n小 A 从小就是个有风度的男生，他邀请他的对手作为先手。小 A 现在想要知道，面对给定的一组游戏，而且他的对手也和他一样聪明绝顶的话，究竟谁能够获得胜利？", "inputFormat": "输入第一行包含两个正整数 $T$ 和 $F$，分别表示游戏组数与给定的数。\n\n接下来 $T$ 行，每行第一个数 $N$ 表示该组游戏初始状态下有多少堆石子。之后 $N$ 个正整数，表示这 $N$ 堆石子分别有多少个。", "outputFormat": "输出一行，包含 $T$ 个用空格隔开的 $0$ 或 $1$ 的数，其中 $0$ 代表此时小 A（后手）会胜利，而 $1$ 代表小 A 的对手（先手）会胜利。", "hint": "对于 $100\\%$ 的数据，$T \\lt 100$，$N \\lt 100$，$F \\lt 100000$，每堆石子数量${}\\lt 100000$。\n\n以上所有数均为正整数。", "locale": "zh-CN"}}}
{"pid": "P3236", "type": "P", "difficulty": 7, "samples": [["1\n3\n4 3 2\n2 3 4\n3 2 1\n2 3 2\n2 2 4\n1 1 3", "30"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "各省省选", "湖南", "分治", "二分图", "叉积"], "title": "[HNOI2014] 画框", "background": "", "description": "小 T 准备在家里摆放几幅画，为此他买来了 $N$ 幅画和 $N$ 个画框。为了体现他的品味，小 T 希望能合理地搭配画与画框，使得其显得既不过于平庸也不太违和。\n\n对于第 $i$ 幅画与第 $j$ 个画框的配对，小 T 都给出了这个配对的平凡度 $A_{i, j}$ 与违和度 $B_{i, j}$ 。整个搭配方案的总体不和谐度为每对画与画框平凡度之和与每对画与画框违和度的乘积。具体来说，设搭配方案中第 $i$ 幅画与第 $P_i$ 个画框配对，则总体不和谐度为\n\n$$\\mathrm{disharmony}=\\sum_{i=1}^{N}A_{i,p_i}\\times \\sum_{i=1}^{N}B_{i,p_i}$$\n小 T 希望知道通过搭配能得到的最小的总体不和谐度是多少。\n", "inputFormat": "输入文件第 $1$ 行是一个正整数 $T$，表示数据组数，接下来是 $T$ 组数据。对于每组数据，第 $1$ 行是一个正整数 $N$，表示有 $N$ 对画和画框。第 $2$ 到第 $N+1$ 行，每行有 $N$ 个非负整数，第 $i+1$ 行第 $j$ 个数表示 $A_{i,  j}$。第 $N+2$ 到第 $2N+1$ 行，每行有 $N$ 个非负整数，第 $i+N+1$ 行第 $j$ 个数表示 $B_{i, j}$ 。\n", "outputFormat": "包含 $T$ 行，每行一个整数，表示最小的总体不和谐度。\n", "hint": "第 $1$ 幅画搭配第 $3$ 个画框，第 $2$ 幅画搭配第 $1$ 个画框，第 $3$ 幅画搭配第 $2$ 个画框，则总体不和谐度为 $30$。\n\n对于 $100\\%$ 的数据，$N\\leq 70$，$T\\leq 3$，$A_{i, j}\\leq 200$，$B_{i, j}\\leq 200$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2014] Picture Frames", "background": "", "description": "Xiao T (小 T) plans to place several paintings at home. He has bought $N$ paintings and $N$ frames. To show his taste, he wants to match paintings with frames so that the result is neither too plain nor too jarring.\n\nFor the pairing of painting $i$ with frame $j$, Xiao T assigns a plainness value $A_{i, j}$ and an incompatibility value $B_{i, j}$. The overall disharmony of a complete matching is defined as the product of the sum of plainness values over all matched pairs and the sum of incompatibility values over all matched pairs. Specifically, let painting $i$ be matched with frame $p_i$; then the overall disharmony is\n$$\\mathrm{disharmony}=\\sum_{i=1}^{N}A_{i,p_i}\\times \\sum_{i=1}^{N}B_{i,p_i}.$$\nXiao T wants to know the minimum possible overall disharmony.", "inputFormat": "The first line contains a positive integer $T$, the number of test cases. For each test case:\n- The first line contains a positive integer $N$, the number of paintings and frames.\n- Lines $2$ through $N+1$ each contain $N$ non-negative integers; on line $i+1$, the $j$-th number is $A_{i, j}$.\n- Lines $N+2$ through $2N+1$ each contain $N$ non-negative integers; on line $i+N+1$, the $j$-th number is $B_{i, j}$.", "outputFormat": "Output $T$ lines, each containing one integer: the minimum overall disharmony.", "hint": "If painting $1$ is matched with frame $3$, painting $2$ with frame $1$, and painting $3$ with frame $2$, then the overall disharmony is $30$.\n\nConstraints: For $100\\%$ of the testdata, $N \\leq 70$, $T \\leq 3$, $A_{i, j} \\leq 200$, $B_{i, j} \\leq 200$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2014] 画框", "background": "", "description": "小 T 准备在家里摆放几幅画，为此他买来了 $N$ 幅画和 $N$ 个画框。为了体现他的品味，小 T 希望能合理地搭配画与画框，使得其显得既不过于平庸也不太违和。\n\n对于第 $i$ 幅画与第 $j$ 个画框的配对，小 T 都给出了这个配对的平凡度 $A_{i, j}$ 与违和度 $B_{i, j}$ 。整个搭配方案的总体不和谐度为每对画与画框平凡度之和与每对画与画框违和度的乘积。具体来说，设搭配方案中第 $i$ 幅画与第 $P_i$ 个画框配对，则总体不和谐度为\n\n$$\\mathrm{disharmony}=\\sum_{i=1}^{N}A_{i,p_i}\\times \\sum_{i=1}^{N}B_{i,p_i}$$\n小 T 希望知道通过搭配能得到的最小的总体不和谐度是多少。\n", "inputFormat": "输入文件第 $1$ 行是一个正整数 $T$，表示数据组数，接下来是 $T$ 组数据。对于每组数据，第 $1$ 行是一个正整数 $N$，表示有 $N$ 对画和画框。第 $2$ 到第 $N+1$ 行，每行有 $N$ 个非负整数，第 $i+1$ 行第 $j$ 个数表示 $A_{i,  j}$。第 $N+2$ 到第 $2N+1$ 行，每行有 $N$ 个非负整数，第 $i+N+1$ 行第 $j$ 个数表示 $B_{i, j}$ 。\n", "outputFormat": "包含 $T$ 行，每行一个整数，表示最小的总体不和谐度。\n", "hint": "第 $1$ 幅画搭配第 $3$ 个画框，第 $2$ 幅画搭配第 $1$ 个画框，第 $3$ 幅画搭配第 $2$ 个画框，则总体不和谐度为 $30$。\n\n对于 $100\\%$ 的数据，$N\\leq 70$，$T\\leq 3$，$A_{i, j}\\leq 200$，$B_{i, j}\\leq 200$。\n", "locale": "zh-CN"}}}
{"pid": "P3237", "type": "P", "difficulty": 5, "samples": [["5\n5\n4\n3\n2\n1\n1 2\n1 3\n2 4\n2 5", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2014", "各省省选", "湖南", "树形 DP", "哈希 hashing"], "title": "[HNOI2014] 米特运输", "background": null, "description": "米特是 D 星球上一种非常神秘的物质，蕴含着巨大的能量。在以米特为主要能源的 D 星上，这种米特能源的运输和储存一直是一个大问题。\n\nD 星上有 $N$ 个城市，我们将其顺序编号为 $1$ 到 $N$，$1$ 号城市为首都。这 $N$ 个城市由 $N-1$ 条单向高速通道连接起来，构成一棵以 $1$ 号城市（首部）为根的树，高速通道的方向由树中的儿子指向父亲。树按深度分层：根结点深度为 $0$，属于第 $1$ 层；根结点的子节点深度为 $1$，属于第 $2$ 层；依此类推，深度为 $i$ 的结点属于第 $i+1$ 层。\n\n建好高速通道之后，D 星人开始考虑如何具体地储存和传输米特资源。由于发展程度不同，每个城市储存米特的能力不尽相同，其中第 $i$ 个城市建有一个容量为 $A_i$ 的米特储存器。这个米特储存器除了具有储存的功能，还具有自动收集米特的能力。\n\n如果到了晚上六点，有某个储存器处于未满的状态，它就会自动收集大气中蕴含的米特能源，在早上六点之前就能收集满；但是，只有在储存器完全空的状态下启动自动收集程序才是安全的，未满而又非空时启动可能有安全隐患。\n\n早上六点到七点间，根节点城市（$1$ 号城市）会将其储存器里的米特消耗殆尽。根节点不会自动搜集米特，它只接受子节点传输来的米特。\n\n早上七点，城市之间启动米特传输过程，传输过程逐层递进：先是第 $2$ 层节点城市向第 $1$ 层（根节点城市，即 $1$ 号城市）传输，直到第 $1$ 层的储存器满或第 $2$ 层的储存器全为空；然后是第 $3$ 层向第 $2$ 层传输，直到对于第 $2$ 层的每个节点，其储存器满或其子节点（位于第 $3$ 层）的储存器全为空；依此类推，直到最后一层传输完成。传输过程一定会在晚上六点前完成。\n\n由于技术原因，运输方案需要满足以下条件：\n\n1. 不能让某个储存器到了晚上六点传输结束时还处于非空但又未满的状态，这个时候储存器仍然会启动自动收集米特的程序，而给已经储存有米特的储存器启动收集程序可能导致危险，也就是说要让储存器到了晚上六点时要么空要么满；\n\n2. 关于首都——即 $1$ 号城市的特殊情况，  每天早上六点到七点间 $1$ 号城市中的米特储存器里的米特会自动被消耗殆尽，即运输方案不需要考虑首都的米特怎么运走；\n\n3. 除了 $1$ 号城市，每个节点必须在其子节点城市向它运输米特之前将这座城市的米特储存器中原本存有的米特全部运出去给父节点，不允许储存器中残存的米特与外来的米特发生混合；\n\n4. 运向某一个城市的若干个来源的米特数量必须完全相同，不然，这些来源不同的米特按不同比例混合之后可能发生危险。\n\n现在 D 星人已经建立好高速通道，每个城市也有了一定储存容量的米特储存器。为了满足上面的限制条件，可能需要重建一些城市中的米特储存器。你可以，也只能，将某一座城市（包括首都）中原来存在的米特储存器摧毁，再新建一座任意容量的新的米特储存器，其容量可以是小数（在输入数据中，储存器原始容量是正整数，但重建后可以是小数），不能是负数或零，使得需要被重建的米特储存器的数目尽量少。\n\n**形式化题面**：\n\n给定一棵有 $n$ 个结点的树，每个点有正整数权值 $a_i$，\n\n称一个权值方案 $w$ 是好的，当且仅当：\n\n对于所有非叶结点 $u$，$u$ 的所有儿子的 $w_v$ 均相等，且 $\\sum_vw_v=w_u$。\n\n请改动一些 $a_i$，使得方案是好的。请注意，你可以将 $a_i$ 修改为任意**正实数**。\n\n求出最小的改动数。", "inputFormat": "第一行是一个正整数 $N$，表示城市的数目。    \n接下来 $N$ 行，每行一个正整数，其中的第 $i$ 行表示第 $i$ 个城市原来存在的米特储存器的容量。    \n再接下来是 $N-1$ 行，每行两个正整数 $a，b$ 表示城市 $b$ 到城市 $a$ 有一条高速通道 $(a≠b)$。", "outputFormat": "输出文件仅包含一行，一个整数，表示最少的被重建（即修改储存器容量）的米特储存器的数目。", "hint": "【样例解释】\n\n一个最优解是将 $A_1$ 改成 $8$，$A_3$ 改成 $4$，$A_5$ 改成 $2$。这样，$2$ 和 $3$ 运给 $1$ 的量相等，$4$ 和 $5$ 运给 $2$ 的量相等，且每天晚上六点的时候，$1$，$2$ 满，$3$，$4$，$5$ 空，满足所有限制条件。\n\n对于 $100\\%$ 的数据满足 $N<500000，A_j<10^8$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2014] Mite Transportation", "background": "", "description": "Mite (mi te) is a very mysterious substance on planet D, containing huge amounts of energy. On planet D, which uses mite as its main energy source, transporting and storing this mite energy has always been a major problem.\n\nThere are $N$ cities on planet D, numbered $1$ through $N$, with city $1$ being the capital. These $N$ cities are connected by $N-1$ one-way expressways, forming a directed tree rooted at city $1$ (the capital). The direction of each expressway is from a child to its parent. The tree is layered by depth: the root has depth $0$ and belongs to layer $1$; a child of the root has depth $1$ and belongs to layer $2$; and so on, a node of depth $i$ belongs to layer $i+1$.\n\nAfter building the expressways, the D people began to consider how to store and transmit mite. Due to differing levels of development, each city has a different storage capacity. City $i$ has a mite storage unit with capacity $A_i$. Besides storing, a storage unit can also automatically collect mite from the atmosphere.\n\nIf, at 6 pm, some storage unit is not full, it will automatically collect mite from the atmosphere and will be filled before 6 am the next day; however, it is only safe to start this auto-collection when the storage unit is completely empty. Starting auto-collection when a storage unit is non-empty but not full may cause safety hazards.\n\nBetween 6 am and 7 am, the capital (city $1$) consumes all mite in its storage unit. The root does not auto-collect mite; it only accepts mite transmitted from its children.\n\nAt 7 am, cities start the transmission process, proceeding layer by layer: first, cities in layer $2$ transmit to layer $1$ (the root, city $1$), until the root’s storage is full or all layer-$2$ storage units are empty; then layer $3$ transmits to layer $2$, ensuring that for every node in layer $2$, its storage becomes full or all of its children’s (in layer $3$) storage units become empty; and so on, until the last layer completes transmission. The transmission process will certainly finish before 6 pm.\n\nDue to technical reasons, the transportation plan must satisfy the following conditions:\n1. No storage unit may remain non-empty but not full at 6 pm when transmission ends. Otherwise, it would start auto-collection while already containing mite, which is dangerous. In other words, by 6 pm, every storage unit must be either empty or full.\n2. For the capital (city $1$), every day between 6 am and 7 am its storage unit is automatically emptied. The transportation plan does not need to consider how to move mite out of the capital.\n3. Except for city $1$, each node must first send out all the mite originally stored in its own storage unit to its parent before its children transmit mite to it. Mixing locally stored mite with incoming mite is not allowed.\n4. For any city, the amounts of mite sent to it from its multiple sources must be exactly the same. Otherwise, mixing different sources in different proportions may be dangerous.\n\nNow that the expressways are built and each city has a storage unit with some capacity, to meet the above constraints, it may be necessary to rebuild some storage units. You may, and only may, destroy the existing storage unit in a city (including the capital) and build a new one with any positive capacity. The new capacity may be a real number (in the input, original capacities are positive integers, but rebuilt capacities may be fractional), and it cannot be negative or zero. Your goal is to minimize the number of storage units that need to be rebuilt.", "inputFormat": "The first line contains a positive integer $N$, the number of cities.  \nThe next $N$ lines each contain a positive integer; line $i$ gives the original capacity of the storage unit in city $i$.  \nThen follow $N-1$ lines, each containing two positive integers $a, b$, indicating there is a one-way expressway from city $b$ to city $a$ ($a \\ne b$).", "outputFormat": "Output a single line with one integer: the minimum number of storage units that must be rebuilt (i.e., whose capacities are modified).", "hint": "Sample explanation:\nOne optimal solution is to change $A_1$ to $8$, $A_3$ to $4$, and $A_5$ to $2$. Then the amounts sent from $2$ and $3$ to $1$ are equal, the amounts sent from $4$ and $5$ to $2$ are equal, and at 6 pm every day, $1$ and $2$ are full while $3$, $4$, and $5$ are empty, satisfying all constraints.\n\nConstraints:\nFor $100\\%$ of the testdata, $N < 500000$, $A_j < 10^8$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2014] 米特运输", "background": null, "description": "米特是 D 星球上一种非常神秘的物质，蕴含着巨大的能量。在以米特为主要能源的 D 星上，这种米特能源的运输和储存一直是一个大问题。\n\nD 星上有 $N$ 个城市，我们将其顺序编号为 $1$ 到 $N$，$1$ 号城市为首都。这 $N$ 个城市由 $N-1$ 条单向高速通道连接起来，构成一棵以 $1$ 号城市（首部）为根的树，高速通道的方向由树中的儿子指向父亲。树按深度分层：根结点深度为 $0$，属于第 $1$ 层；根结点的子节点深度为 $1$，属于第 $2$ 层；依此类推，深度为 $i$ 的结点属于第 $i+1$ 层。\n\n建好高速通道之后，D 星人开始考虑如何具体地储存和传输米特资源。由于发展程度不同，每个城市储存米特的能力不尽相同，其中第 $i$ 个城市建有一个容量为 $A_i$ 的米特储存器。这个米特储存器除了具有储存的功能，还具有自动收集米特的能力。\n\n如果到了晚上六点，有某个储存器处于未满的状态，它就会自动收集大气中蕴含的米特能源，在早上六点之前就能收集满；但是，只有在储存器完全空的状态下启动自动收集程序才是安全的，未满而又非空时启动可能有安全隐患。\n\n早上六点到七点间，根节点城市（$1$ 号城市）会将其储存器里的米特消耗殆尽。根节点不会自动搜集米特，它只接受子节点传输来的米特。\n\n早上七点，城市之间启动米特传输过程，传输过程逐层递进：先是第 $2$ 层节点城市向第 $1$ 层（根节点城市，即 $1$ 号城市）传输，直到第 $1$ 层的储存器满或第 $2$ 层的储存器全为空；然后是第 $3$ 层向第 $2$ 层传输，直到对于第 $2$ 层的每个节点，其储存器满或其子节点（位于第 $3$ 层）的储存器全为空；依此类推，直到最后一层传输完成。传输过程一定会在晚上六点前完成。\n\n由于技术原因，运输方案需要满足以下条件：\n\n1. 不能让某个储存器到了晚上六点传输结束时还处于非空但又未满的状态，这个时候储存器仍然会启动自动收集米特的程序，而给已经储存有米特的储存器启动收集程序可能导致危险，也就是说要让储存器到了晚上六点时要么空要么满；\n\n2. 关于首都——即 $1$ 号城市的特殊情况，  每天早上六点到七点间 $1$ 号城市中的米特储存器里的米特会自动被消耗殆尽，即运输方案不需要考虑首都的米特怎么运走；\n\n3. 除了 $1$ 号城市，每个节点必须在其子节点城市向它运输米特之前将这座城市的米特储存器中原本存有的米特全部运出去给父节点，不允许储存器中残存的米特与外来的米特发生混合；\n\n4. 运向某一个城市的若干个来源的米特数量必须完全相同，不然，这些来源不同的米特按不同比例混合之后可能发生危险。\n\n现在 D 星人已经建立好高速通道，每个城市也有了一定储存容量的米特储存器。为了满足上面的限制条件，可能需要重建一些城市中的米特储存器。你可以，也只能，将某一座城市（包括首都）中原来存在的米特储存器摧毁，再新建一座任意容量的新的米特储存器，其容量可以是小数（在输入数据中，储存器原始容量是正整数，但重建后可以是小数），不能是负数或零，使得需要被重建的米特储存器的数目尽量少。\n\n**形式化题面**：\n\n给定一棵有 $n$ 个结点的树，每个点有正整数权值 $a_i$，\n\n称一个权值方案 $w$ 是好的，当且仅当：\n\n对于所有非叶结点 $u$，$u$ 的所有儿子的 $w_v$ 均相等，且 $\\sum_vw_v=w_u$。\n\n请改动一些 $a_i$，使得方案是好的。请注意，你可以将 $a_i$ 修改为任意**正实数**。\n\n求出最小的改动数。", "inputFormat": "第一行是一个正整数 $N$，表示城市的数目。    \n接下来 $N$ 行，每行一个正整数，其中的第 $i$ 行表示第 $i$ 个城市原来存在的米特储存器的容量。    \n再接下来是 $N-1$ 行，每行两个正整数 $a，b$ 表示城市 $b$ 到城市 $a$ 有一条高速通道 $(a≠b)$。", "outputFormat": "输出文件仅包含一行，一个整数，表示最少的被重建（即修改储存器容量）的米特储存器的数目。", "hint": "【样例解释】\n\n一个最优解是将 $A_1$ 改成 $8$，$A_3$ 改成 $4$，$A_5$ 改成 $2$。这样，$2$ 和 $3$ 运给 $1$ 的量相等，$4$ 和 $5$ 运给 $2$ 的量相等，且每天晚上六点的时候，$1$，$2$ 满，$3$，$4$，$5$ 空，满足所有限制条件。\n\n对于 $100\\%$ 的数据满足 $N<500000，A_j<10^8$。", "locale": "zh-CN"}}}
{"pid": "P3238", "type": "P", "difficulty": 7, "samples": [["4 5 2\n1 2 2\n1 3 2\n3 4 4\n3 2 1\n2 4 3\n1 5", "6\r\n6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2014", "各省省选", "平衡树", "湖南", "最短路"], "title": "[HNOI2014] 道路堵塞", "background": "### 本题可能不存在正确解法，题解均已被 hack。", "description": "A 国有 $N$ 座城市，依次标为 $1$ 到 $N$。同时，在这 $N$ 座城市间有 $M$ 条单向道路，每条道路的长度是一个正整数。现在，A 国交通部指定了一条从城市 $1$ 到城市 $N$ 的路径，并且保证这条路径的长度是所有从城市 $1$ 到城市 $N$ 的路径中最短的。不幸的是，因为从城市 $1$ 到城市 $N$ 旅行的人越来越多，这条由交通部指定的路径经常发生堵塞。现在 A 国想知道，这条路径中的任意一条道路无法通行时，由城市 $1$ 到 $N$ 的最短路径长度是多少。", "inputFormat": "输入文件第一行是三个用空格分开的正整数 $N$、$M$ 和 $L$，分别表示城市数目、单向道路数目和交通部指定的最短路径包含多少条道路。按下来 $M$ 行，每行三个用空格分开的整数 $a$、$b$ 和 $c$，表示存在一条由城市 $a$ 到城市 $b$ 的长度为 $c$ 的单向道路。这 $M$ 行的行号也是对应道路的编号，即其中第 $1$ 行对应的道路编号为 $1$，第 $2$ 行对应的道路编号为 $2$，......，第 $M$ 行对应的道路编号为 $M$。最后一行为 $L$ 个用空格分开的整数 $\\operatorname{sp}(1),\\ldots,\\operatorname{sp}(L)$，依次表示从城市 $1$ 到城市 $N$ 的由交通部指定的最短路径上的道路的编号。", "outputFormat": "输出文件包含 $L$ 行，每行为一个整数，第 $i$ 行（$i = 1,2,\\ldots,L$）的整数表示删去编号为 $\\operatorname{sp}(i)$ 的道路后从城市 $1$ 到城市 $N$ 的最短路径长度。如果去掉后没有从城市 $1$ 到城市 $N$ 的路径，则输出 $-1$。", "hint": "$100\\%$ 的数据满足 $2 < N < 100000$，$1 < M < 200000$，$c \\in [0, 10000] \\cap \\mathbb{Z}$。\n\n数据已加强 By Vfleaking。\n\n2023.4.8 添加两组 hack 数据。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2014] Roadblock", "background": "This problem may not have a correct solution; all posted solutions have been hacked.", "description": "Country A has $N$ cities, numbered $1$ to $N$. There are $M$ directed roads between these $N$ cities, and the length of each road is a positive integer. The Ministry of Transport of Country A has designated a path from city $1$ to city $N$, and it is guaranteed that this path has the shortest length among all paths from city $1$ to city $N$. Unfortunately, as more and more people travel from city $1$ to city $N$, this designated path often gets congested. Now Country A wants to know, for each road on this path, what the shortest path length from city $1$ to city $N$ would be if that road becomes impassable.", "inputFormat": "The first line contains three space-separated positive integers $N$, $M$, and $L$, denoting the number of cities, the number of directed roads, and how many roads are on the designated shortest path, respectively.  \nThe next $M$ lines each contain three space-separated integers $a$, $b$, and $c$, indicating there is a directed road from city $a$ to city $b$ with length $c$. The line numbers of these $M$ lines are also the corresponding road IDs; that is, the $1$-st of these lines corresponds to road ID $1$, the $2$-nd corresponds to road ID $2$, ..., and the $M$-th corresponds to road ID $M$.  \nThe last line contains $L$ space-separated integers $\\operatorname{sp}(1), \\ldots, \\operatorname{sp}(L)$, which in order denote the IDs of the roads on the designated shortest path from city $1$ to city $N$.", "outputFormat": "Output $L$ lines, each containing one integer. The integer on the $i$-th line ($i = 1, 2, \\ldots, L$) is the length of the shortest path from city $1$ to city $N$ after removing the road with ID $\\operatorname{sp}(i)$. If there is no path from city $1$ to city $N$ after the removal, output $-1$.", "hint": "$100\\%$ of the testdata satisfies $2 < N < 100000$, $1 < M < 200000$, $c \\in [0, 10000] \\cap \\mathbb{Z}$.\n\nTestdata has been strengthened by Vfleaking.\n\nTwo sets of hack testdata were added on 2023-04-08.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2014] 道路堵塞", "background": "### 本题可能不存在正确解法，题解均已被 hack。", "description": "A 国有 $N$ 座城市，依次标为 $1$ 到 $N$。同时，在这 $N$ 座城市间有 $M$ 条单向道路，每条道路的长度是一个正整数。现在，A 国交通部指定了一条从城市 $1$ 到城市 $N$ 的路径，并且保证这条路径的长度是所有从城市 $1$ 到城市 $N$ 的路径中最短的。不幸的是，因为从城市 $1$ 到城市 $N$ 旅行的人越来越多，这条由交通部指定的路径经常发生堵塞。现在 A 国想知道，这条路径中的任意一条道路无法通行时，由城市 $1$ 到 $N$ 的最短路径长度是多少。", "inputFormat": "输入文件第一行是三个用空格分开的正整数 $N$、$M$ 和 $L$，分别表示城市数目、单向道路数目和交通部指定的最短路径包含多少条道路。按下来 $M$ 行，每行三个用空格分开的整数 $a$、$b$ 和 $c$，表示存在一条由城市 $a$ 到城市 $b$ 的长度为 $c$ 的单向道路。这 $M$ 行的行号也是对应道路的编号，即其中第 $1$ 行对应的道路编号为 $1$，第 $2$ 行对应的道路编号为 $2$，......，第 $M$ 行对应的道路编号为 $M$。最后一行为 $L$ 个用空格分开的整数 $\\operatorname{sp}(1),\\ldots,\\operatorname{sp}(L)$，依次表示从城市 $1$ 到城市 $N$ 的由交通部指定的最短路径上的道路的编号。", "outputFormat": "输出文件包含 $L$ 行，每行为一个整数，第 $i$ 行（$i = 1,2,\\ldots,L$）的整数表示删去编号为 $\\operatorname{sp}(i)$ 的道路后从城市 $1$ 到城市 $N$ 的最短路径长度。如果去掉后没有从城市 $1$ 到城市 $N$ 的路径，则输出 $-1$。", "hint": "$100\\%$ 的数据满足 $2 < N < 100000$，$1 < M < 200000$，$c \\in [0, 10000] \\cap \\mathbb{Z}$。\n\n数据已加强 By Vfleaking。\n\n2023.4.8 添加两组 hack 数据。", "locale": "zh-CN"}}}
{"pid": "P3239", "type": "P", "difficulty": 6, "samples": [["1\n3 2\n0.5000 2\n0.3000 3\n0.9000 1", "3.2660250000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2015", "各省省选", "湖南", "Special Judge", "期望"], "title": "[HNOI2015] 亚瑟王", "background": "", "description": "小 K 不慎被 LL 邪教洗脑了，洗脑程度深到他甚至想要从亚瑟王邪教中脱坑。他决定，在脱坑之前，最后再来打一盘亚瑟王。既然是最后一战，就一定要打得漂亮。众所周知，亚瑟王是一个看脸的游戏，技能的发动都是看概率的。\n\n作为一个非洲人，同时作为一个前 OIer，小 K 自然是希望最大化造成伤害的期望值。但他已经多年没写过代码，连 Spaly都敲不对了，因此，希望你能帮帮小 K，让他感受一下当欧洲人是怎样的体验。\n\n本题中我们将考虑游戏的一个简化版模型。 玩家有一套卡牌，共 $n$ 张。游戏时，玩家将 $n$ 张卡牌排列成某种顺序，排列后将卡牌按从前往后依次编号为 $1 -  n$。本题中，顺序已经确定，即为输入的顺序。每张卡牌都有一个技能。第 $i$ 张卡牌的技能发动概率为 $p_i$，如果成功发动，则会对敌方造成 $d_i$ 点伤害。也只有通过发动技能，卡牌才能对敌方造成伤害。基于现实因素以及小 K 非洲血统的考虑，$p_i$ 不会为 $0$，也不会为 $1$，即 $0 < p_i < 1$。 一局游戏一共有 $r$ 轮。在每一轮中，系统将从第一张卡牌开始，按照顺序依次考虑每张卡牌。在一轮中，对于依次考虑的每一张卡牌：\n\n1. 如果这张卡牌在这一局游戏中已经发动过技能，则\n\n1.1. 如果这张卡牌不是最后一张，则跳过之（考虑下一张卡牌）； 否则（是最后一张），结束这一轮游戏。\n\n2. 否则（这张卡牌在这一局游戏中没有发动过技能），设这张卡牌为第 $i$ 张\n\n2.1. 将其以 $p_i$ 的概率发动技能。\n\n2.2. 如果技能发动，则对敌方造成 $d_i$ 点伤害，并结束这一轮。\n\n2.3. 如果这张卡牌已经是最后一张（即 $i$ 等于 $n$），则结束这一轮；否则，考虑下一张卡牌。\n\n请帮助小 K 求出这一套卡牌在一局游戏中能造成的伤害的期望值。\n", "inputFormat": "输入文件的第一行包含一个整数 $T$，代表测试数据组数。 \n\n接下来一共 $T$ 组数据。 \n\n每组数据的第一行包含两个用空格分开的整数 $n$ 和 $r$，分别代表卡牌的张数和游戏的轮数。\n\n接下来 $n$ 行，每行包含一个实数和一个整数，由空格隔开，描述一张卡牌。第$i$ 行的两个数为 $p_i$ 和 $d_i$，分别代表第 $i$ 张卡牌技能发动的概率（实数）和技能发动造成的伤害（整数）。保证 $p_i$ 最多包含 $4$ 位小数，且为一个合法的概率。\n", "outputFormat": "对于每组数据，输出一行，包含一个实数，为这套卡牌在这一局游戏中造成的伤害的期望值。对于每一行输出，只有当你的输出和标准答案的相对误差不超过 $10^{-8}$ 时——即 $\\frac{|a-o|}{a} \\leq 10^{-8}$ 时(其中 $a$ 是标准答案， $o$ 是输出)，你的输出才会被判为正确。建议输出 $10$ 位小数。\n", "hint": "一共有 $13$ 种可能的情况：\n\n1.  第一轮中，第 $1$ 张卡牌发动技能；第二轮中，第 $2$ 张卡牌发动技能；\n\n概率为 $0.15$，伤害为 $5$。\n\n2.  第一轮中，第 $1$ 张卡牌发动技能；第二轮中，第 $3$ 张卡牌发动技能；\n\n概率为 $0.315$，伤害为 $3$。\n\n3.  第一轮中，第 $1$ 张卡牌发动技能；第二轮不发动技能；\n\n概率为 $0.035$，伤害为 $2$。\n\n4.  第一轮中，第 $2$ 张卡牌发动技能；第二轮中，第 $1$ 张卡牌发动技能；\n\n概率为 $0.075$，伤害为 $5$。\n\n5.  第一轮中，第 $2$ 张卡牌发动技能；第二轮中，第 $3$ 张卡牌发动技能；\n\n概率为 $0.0675$，伤害为 $4$。\n\n6.  第一轮中，第 $2$ 张卡牌发动技能；第二轮不发动技能；\n\n概率为 $0.0075$，伤害为 $3$。\n\n7.  第一轮中，第 $3$ 张卡牌发动技能；第二轮中，第 $1$ 张卡牌发动技能；\n\n概率为 $0.1575$，伤害为 $3$。\n\n8.  第一轮中，第 $3$ 张卡牌发动技能；第二轮中，第 $2$ 张卡牌发动技能；\n\n概率为 $0.04725$，伤害为 $4$。\n\n9.  第一轮中，第 $3$ 张卡牌发动技能；第二轮不发动技能；\n\n概率为 $0.11025$，伤害为 $1$。\n\n10.  第一轮不发动技能；第二轮中，第 $1$ 张卡牌发动技能；\n\n概率为 $0.0175$，伤害为 $2$。\n\n11.  第一轮不发动技能；第二轮中，第 $2$ 张卡牌发动技能；\n\n概率为 $0.00525$，伤害为 $3$。\n\n12.  第一轮不发动技能；第二轮中，第 $3$ 张卡牌发动技能；\n\n概率为 $0.011025$，伤害为 $1$。\n\n13.  第一轮不发动技能；第二轮亦不发动技能；\n\n概率为 $0.001225$，伤害为 $0$。\n\n造成伤害的期望值为概率与对应伤害乘积之和，为 $3.266025$。\n\n\n对于所有测试数据， $1 \\leq T \\leq 444， 1 \\leq n \\leq 220， 0 \\leq r \\leq 132， 0 < p_i < 1， 0 \\leq d_i \\leq 1000$。\n\n除非备注中有特殊说明，数据中 $p_i$ 与 $d_i$ 均为随机生成。\n\n请注意可能存在的实数精度问题，并采取适当措施。\n\n本题使用 `special_judge`。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2015] King Arthur", "background": "", "description": "Xiao K was accidentally brainwashed by the LL cult, to the extent that he even wants to quit the King Arthur cult. He decides to play one last game of King Arthur before quitting. Since it is the final battle, it must look good. As is well known, King Arthur is a game of luck, and the activation of skills is probabilistic.\n\nAs an unlucky player (slang “African”), and also a former OIer, Xiao K naturally wants to maximize the expected damage dealt. But he has not coded for many years and cannot even code Splay correctly, so he hopes you can help him experience what it is like to be “European” (i.e., lucky).\n\nIn this problem we consider a simplified model of the game. The player has a deck of $n$ cards. During the game, the player arranges the $n$ cards in some order, and after arranging, numbers the cards from front to back as $1 -  n$. In this problem, the order is already fixed, which is the input order. Each card has a skill. The activation probability of the $i$-th card’s skill is $p_i$, and if it successfully activates, it deals $d_i$ damage to the opponent. Only by activating the skill can a card deal damage to the opponent. Considering practical factors and Xiao K’s “African” luck, $p_i$ is neither $0$ nor $1$, i.e., $0 < p_i < 1$. A game consists of $r$ rounds. In each round, the system starts from the first card and considers each card in order. In one round, for each card considered in order:\n\n1. If this card has already activated its skill in this game, then\n\n1.1. If this card is not the last one, skip it (consider the next card); otherwise (it is the last one), end this round.\n\n2. Otherwise (this card has not activated its skill in this game), let this card be the $i$-th card.\n\n2.1. Attempt to activate its skill with probability $p_i$.\n\n2.2. If the skill activates, deal $d_i$ damage to the opponent and end this round.\n\n2.3. If this card is already the last one (i.e., $i$ equals $n$), end this round; otherwise, consider the next card.\n\nPlease help Xiao K compute the expected damage this deck can deal in one game.", "inputFormat": "The first line of the input file contains an integer $T$, representing the number of testdata groups.\n\nThen there are $T$ groups of data.\n\nThe first line of each group contains two space-separated integers $n$ and $r$, representing the number of cards and the number of rounds in the game, respectively.\n\nThen follow $n$ lines, each containing a real number and an integer separated by a space, describing one card. The two numbers on the $i$-th line are $p_i$ and $d_i$, representing the activation probability (real number) of the $i$-th card’s skill and the damage (integer) dealt when the skill activates. It is guaranteed that $p_i$ has at most $4$ decimal places and is a valid probability.", "outputFormat": "For each group of data, output one line containing a real number, which is the expected damage dealt by this deck in one game. For each output line, your output will be judged correct only if its relative error with the standard answer does not exceed $10^{-8}$—i.e., $\\frac{|a-o|}{a} \\leq 10^{-8}$ (where $a$ is the standard answer and $o$ is your output). It is recommended to output $10$ decimal places.", "hint": "There are $13$ possible cases:\n\n1. In round $1$, card $1$ activates; in round $2$, card $2$ activates.\n\nProbability is $0.15$, damage is $5$.\n\n2. In round $1$, card $1$ activates; in round $2$, card $3$ activates.\n\nProbability is $0.315$, damage is $3$.\n\n3. In round $1$, card $1$ activates; in round $2$ no skill activates.\n\nProbability is $0.035$, damage is $2$.\n\n4. In round $1$, card $2$ activates; in round $2$, card $1$ activates.\n\nProbability is $0.075$, damage is $5$.\n\n5. In round $1$, card $2$ activates; in round $2$, card $3$ activates.\n\nProbability is $0.0675$, damage is $4$.\n\n6. In round $1$, card $2$ activates; in round $2$ no skill activates.\n\nProbability is $0.0075$, damage is $3$.\n\n7. In round $1$, card $3$ activates; in round $2$, card $1$ activates.\n\nProbability is $0.1575$, damage is $3$.\n\n8. In round $1$, card $3$ activates; in round $2$, card $2$ activates.\n\nProbability is $0.04725$, damage is $4$.\n\n9. In round $1$, card $3$ activates; in round $2$ no skill activates.\n\nProbability is $0.11025$, damage is $1$.\n\n10. In round $1$ no skill activates; in round $2$, card $1$ activates.\n\nProbability is $0.0175$, damage is $2$.\n\n11. In round $1$ no skill activates; in round $2$, card $2$ activates.\n\nProbability is $0.00525$, damage is $3$.\n\n12. In round $1$ no skill activates; in round $2$, card $3$ activates.\n\nProbability is $0.011025$, damage is $1$.\n\n13. In round $1$ no skill activates; in round $2$ no skill activates.\n\nProbability is $0.001225$, damage is $0$.\n\nThe expected damage is the sum of the products of probabilities and corresponding damages, which is $3.266025$.\n\nConstraints: For all testdata, $1 \\leq T \\leq 444， 1 \\leq n \\leq 220， 0 \\leq r \\leq 132， 0 < p_i < 1， 0 \\leq d_i \\leq 1000$.\n\nUnless otherwise specified in the remarks, the $p_i$ and $d_i$ in the testdata are randomly generated.\n\nPlease be aware of possible floating-point precision issues and take appropriate measures.\n\nThis problem uses `special_judge`.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2015] 亚瑟王", "background": "", "description": "小 K 不慎被 LL 邪教洗脑了，洗脑程度深到他甚至想要从亚瑟王邪教中脱坑。他决定，在脱坑之前，最后再来打一盘亚瑟王。既然是最后一战，就一定要打得漂亮。众所周知，亚瑟王是一个看脸的游戏，技能的发动都是看概率的。\n\n作为一个非洲人，同时作为一个前 OIer，小 K 自然是希望最大化造成伤害的期望值。但他已经多年没写过代码，连 Spaly都敲不对了，因此，希望你能帮帮小 K，让他感受一下当欧洲人是怎样的体验。\n\n本题中我们将考虑游戏的一个简化版模型。 玩家有一套卡牌，共 $n$ 张。游戏时，玩家将 $n$ 张卡牌排列成某种顺序，排列后将卡牌按从前往后依次编号为 $1 -  n$。本题中，顺序已经确定，即为输入的顺序。每张卡牌都有一个技能。第 $i$ 张卡牌的技能发动概率为 $p_i$，如果成功发动，则会对敌方造成 $d_i$ 点伤害。也只有通过发动技能，卡牌才能对敌方造成伤害。基于现实因素以及小 K 非洲血统的考虑，$p_i$ 不会为 $0$，也不会为 $1$，即 $0 < p_i < 1$。 一局游戏一共有 $r$ 轮。在每一轮中，系统将从第一张卡牌开始，按照顺序依次考虑每张卡牌。在一轮中，对于依次考虑的每一张卡牌：\n\n1. 如果这张卡牌在这一局游戏中已经发动过技能，则\n\n1.1. 如果这张卡牌不是最后一张，则跳过之（考虑下一张卡牌）； 否则（是最后一张），结束这一轮游戏。\n\n2. 否则（这张卡牌在这一局游戏中没有发动过技能），设这张卡牌为第 $i$ 张\n\n2.1. 将其以 $p_i$ 的概率发动技能。\n\n2.2. 如果技能发动，则对敌方造成 $d_i$ 点伤害，并结束这一轮。\n\n2.3. 如果这张卡牌已经是最后一张（即 $i$ 等于 $n$），则结束这一轮；否则，考虑下一张卡牌。\n\n请帮助小 K 求出这一套卡牌在一局游戏中能造成的伤害的期望值。\n", "inputFormat": "输入文件的第一行包含一个整数 $T$，代表测试数据组数。 \n\n接下来一共 $T$ 组数据。 \n\n每组数据的第一行包含两个用空格分开的整数 $n$ 和 $r$，分别代表卡牌的张数和游戏的轮数。\n\n接下来 $n$ 行，每行包含一个实数和一个整数，由空格隔开，描述一张卡牌。第$i$ 行的两个数为 $p_i$ 和 $d_i$，分别代表第 $i$ 张卡牌技能发动的概率（实数）和技能发动造成的伤害（整数）。保证 $p_i$ 最多包含 $4$ 位小数，且为一个合法的概率。\n", "outputFormat": "对于每组数据，输出一行，包含一个实数，为这套卡牌在这一局游戏中造成的伤害的期望值。对于每一行输出，只有当你的输出和标准答案的相对误差不超过 $10^{-8}$ 时——即 $\\frac{|a-o|}{a} \\leq 10^{-8}$ 时(其中 $a$ 是标准答案， $o$ 是输出)，你的输出才会被判为正确。建议输出 $10$ 位小数。\n", "hint": "一共有 $13$ 种可能的情况：\n\n1.  第一轮中，第 $1$ 张卡牌发动技能；第二轮中，第 $2$ 张卡牌发动技能；\n\n概率为 $0.15$，伤害为 $5$。\n\n2.  第一轮中，第 $1$ 张卡牌发动技能；第二轮中，第 $3$ 张卡牌发动技能；\n\n概率为 $0.315$，伤害为 $3$。\n\n3.  第一轮中，第 $1$ 张卡牌发动技能；第二轮不发动技能；\n\n概率为 $0.035$，伤害为 $2$。\n\n4.  第一轮中，第 $2$ 张卡牌发动技能；第二轮中，第 $1$ 张卡牌发动技能；\n\n概率为 $0.075$，伤害为 $5$。\n\n5.  第一轮中，第 $2$ 张卡牌发动技能；第二轮中，第 $3$ 张卡牌发动技能；\n\n概率为 $0.0675$，伤害为 $4$。\n\n6.  第一轮中，第 $2$ 张卡牌发动技能；第二轮不发动技能；\n\n概率为 $0.0075$，伤害为 $3$。\n\n7.  第一轮中，第 $3$ 张卡牌发动技能；第二轮中，第 $1$ 张卡牌发动技能；\n\n概率为 $0.1575$，伤害为 $3$。\n\n8.  第一轮中，第 $3$ 张卡牌发动技能；第二轮中，第 $2$ 张卡牌发动技能；\n\n概率为 $0.04725$，伤害为 $4$。\n\n9.  第一轮中，第 $3$ 张卡牌发动技能；第二轮不发动技能；\n\n概率为 $0.11025$，伤害为 $1$。\n\n10.  第一轮不发动技能；第二轮中，第 $1$ 张卡牌发动技能；\n\n概率为 $0.0175$，伤害为 $2$。\n\n11.  第一轮不发动技能；第二轮中，第 $2$ 张卡牌发动技能；\n\n概率为 $0.00525$，伤害为 $3$。\n\n12.  第一轮不发动技能；第二轮中，第 $3$ 张卡牌发动技能；\n\n概率为 $0.011025$，伤害为 $1$。\n\n13.  第一轮不发动技能；第二轮亦不发动技能；\n\n概率为 $0.001225$，伤害为 $0$。\n\n造成伤害的期望值为概率与对应伤害乘积之和，为 $3.266025$。\n\n\n对于所有测试数据， $1 \\leq T \\leq 444， 1 \\leq n \\leq 220， 0 \\leq r \\leq 132， 0 < p_i < 1， 0 \\leq d_i \\leq 1000$。\n\n除非备注中有特殊说明，数据中 $p_i$ 与 $d_i$ 均为随机生成。\n\n请注意可能存在的实数精度问题，并采取适当措施。\n\n本题使用 `special_judge`。", "locale": "zh-CN"}}}
{"pid": "P3240", "type": "P", "difficulty": 6, "samples": [["5 4\n1 < 2\n1 < 3\n2 < 4\n1 = 5", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "数学", "2015", "并查集", "各省省选", "湖南"], "title": "[HNOI2015] 实验比较", "background": "", "description": "小 D 被邀请到实验室，做一个跟图片质量评价相关的主观实验。\n\n实验用到的图片集一共有 $N$ 张图片，编号为 $1$ 到 $N$。实验分若干轮进行，在每轮实验中，小 D 会被要求观看某两张随机选取的图片， 然后小 D 需要根据他自己主观上的判断确定这两张图片谁好谁坏，或者这两张图片质量差不多。 \n\n用符号 ”$<$”、“$>$” 和 “$=$” 表示图片 $x$ 和 $y$（$x$、$y$ 为图片编号）之间的比较：如果上下文中 $x$ 和 $y$ 是图片编号，则 $x<y$ 表示图片 $x$「质量优于」$y$，$x>y$ 表示图片 $x$「质量差于」$y$，$x=y$ 表示图片 $x$ 和 $y$ 「质量相同」；也就是说，这种上下文中，“$<$”、“$>$”、“$=$” 分别是质量优于、质量差于、质量相同的意思；在其他上下文中，这三个符号分别是小于、大于、等于的含义。\n\n图片质量比较的推理规则（在 $x$ 和 $y$ 是图片编号的上下文中）：\n1. $x < y$ 等价于 $y > x$。\n2. 若 $x < y$ 且 $y = z$，则 $x < z$。\n3. 若 $x < y$ 且 $x = z$，则 $z < y$。\n4. $x=y$ 等价于 $y=x$。\n5. 若 $x=y$ 且 $y=z$，则 $x=z$。 \n\n实验中，小 D 需要对一些图片对 $(x, y)$，给出 $x < y$ 或 $x = y$ 或 $x > y$ 的主观判断。小 D 在做完实验后， 忽然对这个基于局部比较的实验的一些全局性质产生了兴趣。\n\n在主观实验数据给定的情形下，定义这 $N$ 张图片的一个合法质量序列为形如 “$x_1 R_1 x_2 R_2 x_3 R_3 …x_{N-1} R_{N-1} x_N$” 的串，也可看作是集合 $\\{ x_i R_i x_{i+1}|1 \\leq i \\leq N-1 \\}$，其中  $x_i$ 为图片编号，$x_1,x_2, \\ldots ,x_N$ 两两互不相同（即不存在重复编号），$R_i$ 为 $<$ 或 $=$，「合法」是指这个图片质量序列与任何一对主观实验给出的判断不冲突。 \n\n例如： 质量序列 $3 < 1 = 2$ 与主观判断 “$3 > 1$，$3 = 2$” 冲突（因为质量序列中 $3<1$ 且 $1=2$，从而 $3<2$，这与主观判断中的 $3=2$ 冲突；同时质量序列中的 $3<1$ 与主观判断中的 $3>1$ 冲突） ，但与主观判断 “$2 = 1$，$3 < 2$”  不冲突；因此给定主观判断 “$3>1$，$3=2$” 时，$1<3=2$ 和 $1<2=3$ 都是合法的质量序列，$3<1=2$ 和 $1<2<3$ 都是非法的质量序列。\n\n由于实验已经做完一段时间了，小 D 已经忘了一部分主观实验的数据。对每张图片 $X_i$，小 D 都**最多**只记住了某一张质量不比 $X_i$ 好的另一张图片 $K_{X_i}$。这些小 D 仍然记得的质量判断一共有 $M$ 条（$0 \\leq M \\leq N$），其中第 $i$ 条涉及的图片对为 $(K_{X_i}, X_i)$，判断要么是 $K_{X_i} < X_i$，要么是 $K_{X_i} = X_i$，而且所有的 $X_i$ 互不相同。小 D 打算就以这 M 条自己还记得的质量判断作为他的所有主观数据。\n\n现在，基于这些主观数据，我们希望你帮小 D 求出这 $N$ 张图片一共有多少个不同的合法质量序列。我们规定：如果质量序列中出现 “$x = y$”，那么序列中交换 $x$ 和 $y$ 的位置后仍是同一个序列。因此： $1<2=3=4<5$ 和 $1<4=2=3<5$ 是同一个序列， $1 < 2 = 3$ 和 $1 < 3 = 2$ 是同一个序列，而 $1 < 2 < 3$ 与 $1 < 2 = 3$ 是不同的序列，$1<2<3$ 和 $2<1<3$ 是不同的序列。\n\n由于合法的图片质量序列可能很多， 所以你需要输出答案对 $10^9 + 7$ 取模的结果。", "inputFormat": "第一行两个正整数 $N,M$，分别代表图片总数和小 $D$ 仍然记得的判断的条数；\n\n接下来 $M$ 行，每行一条判断，每条判断形如「$x < y$」或者「$x = y$」。", "outputFormat": "输出仅一行，包含一个正整数，表示合法质量序列的数目对 $10^9+7$ 取模的结果。", "hint": "不同的合法序列共5个，如下所示：\n\n- $1 = 5 < 2 < 3 < 4$ \n- $1 = 5 < 2 < 4 < 3$\n- $1 = 5 < 2 < 3 = 4$ \n- $1 = 5 < 3 < 2 < 4$ \n- $1 = 5 < 2 = 3 < 4$\n\n$100\\%$ 的数据满足 $N \\leq 100$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2015] Experimental Comparison", "background": "", "description": "Little D was invited to a lab to participate in a subjective experiment related to image quality assessment.\n\nThe dataset contains $N$ images, numbered $1$ to $N$. The experiment is conducted in several rounds. In each round, Little D is asked to look at two randomly selected images, and then, based on his subjective judgment, decide which image is better, or that their qualities are about the same.\n\nWe use the symbols “$<$”, “$>$”, and “$=$” to denote comparisons between images $x$ and $y$ ($x$, $y$ are image indices): if within the context $x$ and $y$ are image indices, then $x < y$ means “the quality of image $x$ is better than that of $y$,” $x > y$ means “the quality of image $x$ is worse than that of $y$,” and $x = y$ means “images $x$ and $y$ have equal quality.” That is, in such contexts, “$<$”, “$>$”, and “$=$” respectively mean better quality, worse quality, and equal quality; in other contexts, these three symbols retain their usual meanings of less than, greater than, and equal to.\n\nReasoning rules for image quality comparisons (in the context where $x$ and $y$ are image indices):\n1. $x < y$ is equivalent to $y > x$.\n2. If $x < y$ and $y = z$, then $x < z$.\n3. If $x < y$ and $x = z$, then $z < y$.\n4. $x = y$ is equivalent to $y = x$.\n5. If $x = y$ and $y = z$, then $x = z$.\n\nIn the experiment, Little D needs to provide a subjective judgment for some image pairs $(x, y)$: either $x < y$, or $x = y$, or $x > y$. After the experiment, Little D became interested in some global properties of this locally compared experiment.\n\nGiven the subjective experiment data, we define a legal quality sequence of these $N$ images as a string of the form “$x_1 R_1 x_2 R_2 x_3 R_3 \\dots x_{N-1} R_{N-1} x_N$,” which can also be regarded as the set $\\{ x_i R_i x_{i+1} \\mid 1 \\leq i \\leq N - 1 \\}$, where $x_i$ are image indices, $x_1, x_2, \\ldots, x_N$ are pairwise distinct (i.e., no duplicate indices), $R_i$ is either $<$ or $=$, and “legal” means that this quality sequence does not conflict with any of the subjective judgments.\n\nFor example: the quality sequence $3 < 1 = 2$ conflicts with the subjective judgments “$3 > 1$, $3 = 2$” (because in the sequence $3 < 1$ and $1 = 2$, hence $3 < 2$, which conflicts with $3 = 2$ in the judgments; meanwhile $3 < 1$ conflicts with $3 > 1$), but it does not conflict with the judgments “$2 = 1$, $3 < 2$.” Therefore, given the judgments “$3 > 1$, $3 = 2$,” both $1 < 3 = 2$ and $1 < 2 = 3$ are legal quality sequences, while $3 < 1 = 2$ and $1 < 2 < 3$ are illegal quality sequences.\n\nSince some time has passed since the experiment, Little D has forgotten part of the subjective data. For each image $X_i$, Little D remembers at most one other image $K_{X_i}$ whose quality is not better than $X_i$. Altogether there are $M$ remembered judgments ($0 \\leq M \\leq N$). The $i$-th judgment involves the pair $(K_{X_i}, X_i)$ and is either $K_{X_i} < X_i$ or $K_{X_i} = X_i$, and all $X_i$ are pairwise distinct. Little D decides to use precisely these $M$ remembered judgments as all his subjective data.\n\nNow, based on these subjective data, we ask you to help Little D compute how many different legal quality sequences there are for the $N$ images. We stipulate: if “$x = y$” appears in a sequence, then swapping the positions of $x$ and $y$ results in the same sequence. Therefore: $1 < 2 = 3 = 4 < 5$ and $1 < 4 = 2 = 3 < 5$ are the same sequence, $1 < 2 = 3$ and $1 < 3 = 2$ are the same sequence, whereas $1 < 2 < 3$ and $1 < 2 = 3$ are different sequences, and $1 < 2 < 3$ and $2 < 1 < 3$ are different sequences.\n\nAs the number of legal quality sequences can be large, you must output the answer modulo $10^9 + 7$.", "inputFormat": "The first line contains two positive integers $N, M$, the total number of images and the number of judgments that Little D still remembers.\n\nThe following $M$ lines each contain one judgment, in the form “$x < y$” or “$x = y$”.", "outputFormat": "Output a single line containing one positive integer, the number of legal quality sequences modulo $10^9 + 7$.", "hint": "There are 5 different legal sequences, as listed below:\n- $1 = 5 < 2 < 3 < 4$\n- $1 = 5 < 2 < 4 < 3$\n- $1 = 5 < 2 < 3 = 4$\n- $1 = 5 < 3 < 2 < 4$\n- $1 = 5 < 2 = 3 < 4$\n\nFor $100\\%$ of the testdata, $N \\leq 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2015] 实验比较", "background": "", "description": "小 D 被邀请到实验室，做一个跟图片质量评价相关的主观实验。\n\n实验用到的图片集一共有 $N$ 张图片，编号为 $1$ 到 $N$。实验分若干轮进行，在每轮实验中，小 D 会被要求观看某两张随机选取的图片， 然后小 D 需要根据他自己主观上的判断确定这两张图片谁好谁坏，或者这两张图片质量差不多。 \n\n用符号 ”$<$”、“$>$” 和 “$=$” 表示图片 $x$ 和 $y$（$x$、$y$ 为图片编号）之间的比较：如果上下文中 $x$ 和 $y$ 是图片编号，则 $x<y$ 表示图片 $x$「质量优于」$y$，$x>y$ 表示图片 $x$「质量差于」$y$，$x=y$ 表示图片 $x$ 和 $y$ 「质量相同」；也就是说，这种上下文中，“$<$”、“$>$”、“$=$” 分别是质量优于、质量差于、质量相同的意思；在其他上下文中，这三个符号分别是小于、大于、等于的含义。\n\n图片质量比较的推理规则（在 $x$ 和 $y$ 是图片编号的上下文中）：\n1. $x < y$ 等价于 $y > x$。\n2. 若 $x < y$ 且 $y = z$，则 $x < z$。\n3. 若 $x < y$ 且 $x = z$，则 $z < y$。\n4. $x=y$ 等价于 $y=x$。\n5. 若 $x=y$ 且 $y=z$，则 $x=z$。 \n\n实验中，小 D 需要对一些图片对 $(x, y)$，给出 $x < y$ 或 $x = y$ 或 $x > y$ 的主观判断。小 D 在做完实验后， 忽然对这个基于局部比较的实验的一些全局性质产生了兴趣。\n\n在主观实验数据给定的情形下，定义这 $N$ 张图片的一个合法质量序列为形如 “$x_1 R_1 x_2 R_2 x_3 R_3 …x_{N-1} R_{N-1} x_N$” 的串，也可看作是集合 $\\{ x_i R_i x_{i+1}|1 \\leq i \\leq N-1 \\}$，其中  $x_i$ 为图片编号，$x_1,x_2, \\ldots ,x_N$ 两两互不相同（即不存在重复编号），$R_i$ 为 $<$ 或 $=$，「合法」是指这个图片质量序列与任何一对主观实验给出的判断不冲突。 \n\n例如： 质量序列 $3 < 1 = 2$ 与主观判断 “$3 > 1$，$3 = 2$” 冲突（因为质量序列中 $3<1$ 且 $1=2$，从而 $3<2$，这与主观判断中的 $3=2$ 冲突；同时质量序列中的 $3<1$ 与主观判断中的 $3>1$ 冲突） ，但与主观判断 “$2 = 1$，$3 < 2$”  不冲突；因此给定主观判断 “$3>1$，$3=2$” 时，$1<3=2$ 和 $1<2=3$ 都是合法的质量序列，$3<1=2$ 和 $1<2<3$ 都是非法的质量序列。\n\n由于实验已经做完一段时间了，小 D 已经忘了一部分主观实验的数据。对每张图片 $X_i$，小 D 都**最多**只记住了某一张质量不比 $X_i$ 好的另一张图片 $K_{X_i}$。这些小 D 仍然记得的质量判断一共有 $M$ 条（$0 \\leq M \\leq N$），其中第 $i$ 条涉及的图片对为 $(K_{X_i}, X_i)$，判断要么是 $K_{X_i} < X_i$，要么是 $K_{X_i} = X_i$，而且所有的 $X_i$ 互不相同。小 D 打算就以这 M 条自己还记得的质量判断作为他的所有主观数据。\n\n现在，基于这些主观数据，我们希望你帮小 D 求出这 $N$ 张图片一共有多少个不同的合法质量序列。我们规定：如果质量序列中出现 “$x = y$”，那么序列中交换 $x$ 和 $y$ 的位置后仍是同一个序列。因此： $1<2=3=4<5$ 和 $1<4=2=3<5$ 是同一个序列， $1 < 2 = 3$ 和 $1 < 3 = 2$ 是同一个序列，而 $1 < 2 < 3$ 与 $1 < 2 = 3$ 是不同的序列，$1<2<3$ 和 $2<1<3$ 是不同的序列。\n\n由于合法的图片质量序列可能很多， 所以你需要输出答案对 $10^9 + 7$ 取模的结果。", "inputFormat": "第一行两个正整数 $N,M$，分别代表图片总数和小 $D$ 仍然记得的判断的条数；\n\n接下来 $M$ 行，每行一条判断，每条判断形如「$x < y$」或者「$x = y$」。", "outputFormat": "输出仅一行，包含一个正整数，表示合法质量序列的数目对 $10^9+7$ 取模的结果。", "hint": "不同的合法序列共5个，如下所示：\n\n- $1 = 5 < 2 < 3 < 4$ \n- $1 = 5 < 2 < 4 < 3$\n- $1 = 5 < 2 < 3 = 4$ \n- $1 = 5 < 3 < 2 < 4$ \n- $1 = 5 < 2 = 3 < 4$\n\n$100\\%$ 的数据满足 $N \\leq 100$。", "locale": "zh-CN"}}}
{"pid": "P3241", "type": "P", "difficulty": 6, "samples": [["10 10 10\n0 0 7 2 1 4 7 7 7 9\n1 2 270\n2 3 217\n1 4 326\n2 5 361\n4 6 116\n3 7 38\n1 8 800\n6 9 210\n7 10 278\n8 9 8\n2 8 0\n9 3 1\n8 0 8\n4 2 7\n9 7 3\n4 7 0\n2 2 7\n3 2 1\n2 3 4", "1603 \n957 \n7161 \n9466 \n3232 \n5223 \n1879 \n1669 \n1282 \n0"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000], "memory": [512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "各省省选", "点分治", "湖南", "最近公共祖先 LCA", "树链剖分", "动态树 LCT", "可持久化线段树"], "title": "[HNOI2015] 开店", "background": "", "description": "风见幽香有一个好朋友叫八云紫，她们经常一起看星星看月亮从诗词歌赋谈到人生哲学。最近她们灵机一动，打算在幻想乡开一家小店来做生意赚点钱。\n\n这样的想法当然非常好啦，但是她们也发现她们面临着一个问题，那就是店开在哪里，面向什么样的人群。很神奇的是，幻想乡的地图是一个树形结构，幻想乡一共有 $n$ 个地方，编号为 $1$ 到 $n$，被 $n-1$ 条带权的边连接起来。每个地方都住着一个妖怪，其中第 $i$ 个地方的妖怪年龄是 $x_i$。\n\n妖怪都是些比较喜欢安静的家伙，所以它们并不希望和很多妖怪相邻。所以这个树所有顶点的度数都小于或等于 $3$。妖怪和人一样，兴趣点随着年龄的变化自然就会变化，比如我们的 $18$ 岁少女幽香和八云紫就比较喜欢可爱的东西。幽香通过研究发现，基本上妖怪的兴趣只跟年龄有关，所以幽香打算选择一个地方 $u$（$u$ 为编号），然后在 $u$ 开一家面向年龄在 $L$ 到 $R$ 之间（即年龄大于等于 $L$ 小于等于 $R$）的妖怪的店。\n\n也有可能 $u$ 这个地方离这些妖怪比较远，于是幽香就想要知道所有年龄在 $L$ 到 $R$ 之间的妖怪，到点 $u$ 的距离的和是多少（妖怪到 $u$ 的距离是该妖怪所在地方到 $u$ 的路径上的边的权之和），幽香把这个称为这个开店方案的方便值。\n\n幽香她们还没有决定要把店开在哪里，八云紫倒是准备了很多方案，于是幽香想要知道，对于每个方案，方便值是多少呢。\n", "inputFormat": "第一行三个用空格分开的数 $n,Q$ 和 $A$，表示树的大小、开店的方案个数和妖怪的年龄上限。\n\n第二行 $n$ 个用空格分开的数 $x_1,x_2,\\ldots,x_n$；$x_i$ 表示第 $i$ 个地点妖怪的年龄，满足 $0\\le x_i\\lt A$。(年龄是可以为 $0$ 的，例如刚出生的妖怪的年龄为 $0$。) \n\n接下来 $n-1$  行，每行三个用空格分开的数 $a$、$b$、$c$，表示树上的顶点 $a$ 和 $b$ 之间有一条权为 $c(1\\le c\\le1000)$ 的边，$a$ 和 $b$ 是顶点编号。 \n\n接下来 $Q$ 行，每行三个用空格分开的数 $u,a,b$。\n\n对于这 $Q$ 行的每一行，用 $a,b,A$ 计算出 $L$ 和 $R$，表示询问”在地方 $u$ 开店，面向妖怪的年龄区间为 $[L,R]$ 的方案的方便值是多少“。\n\n对于其中第 $1$ 行，$L$ 和 $R$ 的计算方法为：$L=\\min(a\\bmod A,b\\bmod A),R=\\max(a\\bmod A,b\\bmod A)$ 。\n\n对于第 $2$ 到第 $Q$ 行，假设前一行得到的方便值为 $ans$，那么当前行的 $L$ 和 $R$ 计算方法为： $L=\\min((a+ans)\\bmod A,(b+ans)\\bmod A), R=\\max((a+ans)\\bmod A,(b+ans)\\bmod A)$ 。", "outputFormat": "对于每个方案，输出一行表示方便值。\n", "hint": "满足 $n\\le1.5 \\times 10^5,Q\\le2 \\times 10^5$。对于所有数据，满足 $A\\le 10^9$。 ", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2015] Opening a Shop", "background": "", "description": "Kazami Yuuka has a good friend named Yakumo Yukari. They often watch the stars and the moon together, chatting from poetry and songs to life philosophy. Recently, they had a sudden idea to open a small shop in Gensokyo to do business and make some money.\n\nThis idea is certainly great, but they also found a problem: where to open the shop and which group of customers to target. Interestingly, the map of Gensokyo is a tree. There are $n$ places in total, numbered from $1$ to $n$, connected by $n-1$ weighted edges. Each place is inhabited by a youkai, and the age of the youkai at place $i$ is $x_i$.\n\nYoukai are relatively quiet, so they do not want to be adjacent to too many youkai. Therefore, the degree of every vertex in this tree is at most $3$. Interests change naturally with age. For example, our $18$-year-old girls Yuuka and Yukari may prefer cute things. Yuuka discovered through research that a youkai’s interests basically depend only on age. So Yuuka plans to choose a place $u$ (a vertex id), and open a shop at $u$ targeting youkai whose ages are between $L$ and $R$ (that is, ages greater than or equal to $L$ and less than or equal to $R$).\n\nIt is possible that place $u$ is far from these youkai. Thus, Yuuka wants to know the sum of distances from all youkai with ages in $[L, R]$ to $u$ (the distance from a youkai to $u$ is the sum of edge weights along the path from its place to $u$). Yuuka calls this the convenience value of the shop plan.\n\nThey have not yet decided where to open the shop, and Yukari has prepared many plans. For each plan, what is the convenience value?", "inputFormat": "- The first line contains three space-separated integers $n$, $Q$, and $A$, representing the size of the tree, the number of shop plans (queries), and the upper bound of youkai ages.\n- The second line contains $n$ space-separated integers $x_1, x_2, \\ldots, x_n$. Here $x_i$ is the age of the youkai at place $i$, satisfying $0 \\le x_i \\lt A$. (Age can be $0$, for example, a newborn youkai has age $0$.)\n- The next $n-1$ lines each contain three space-separated integers $a$, $b$, and $c$, indicating that there is an edge of weight $c$ ($1 \\le c \\le 1000$) between vertices $a$ and $b$, where $a$ and $b$ are vertex ids.\n- The next $Q$ lines each contain three space-separated integers $u$, $a$, and $b$.\n\nFor each of these $Q$ lines, compute $L$ and $R$ from $a$, $b$, and $A$. This specifies the query “open a shop at place $u$, targeting youkai with ages in $[L, R]$, and ask for the convenience value.”\n\n- For the first query (the $1$-st line), compute:\n  $L=\\min(a \\bmod A, b \\bmod A)$, $R=\\max(a \\bmod A, b \\bmod A)$.\n- For the $2$-nd to the $Q$-th queries, suppose the convenience value obtained from the previous query is $ans$. Then compute:\n  $L=\\min((a+ans) \\bmod A, (b+ans) \\bmod A)$, $R=\\max((a+ans) \\bmod A, (b+ans) \\bmod A)$.", "outputFormat": "For each plan, output one line containing the convenience value.", "hint": "Constraints: $n \\le 1.5 \\times 10^5$, $Q \\le 2 \\times 10^5$. For all testdata, $A \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2015] 开店", "background": "", "description": "风见幽香有一个好朋友叫八云紫，她们经常一起看星星看月亮从诗词歌赋谈到人生哲学。最近她们灵机一动，打算在幻想乡开一家小店来做生意赚点钱。\n\n这样的想法当然非常好啦，但是她们也发现她们面临着一个问题，那就是店开在哪里，面向什么样的人群。很神奇的是，幻想乡的地图是一个树形结构，幻想乡一共有 $n$ 个地方，编号为 $1$ 到 $n$，被 $n-1$ 条带权的边连接起来。每个地方都住着一个妖怪，其中第 $i$ 个地方的妖怪年龄是 $x_i$。\n\n妖怪都是些比较喜欢安静的家伙，所以它们并不希望和很多妖怪相邻。所以这个树所有顶点的度数都小于或等于 $3$。妖怪和人一样，兴趣点随着年龄的变化自然就会变化，比如我们的 $18$ 岁少女幽香和八云紫就比较喜欢可爱的东西。幽香通过研究发现，基本上妖怪的兴趣只跟年龄有关，所以幽香打算选择一个地方 $u$（$u$ 为编号），然后在 $u$ 开一家面向年龄在 $L$ 到 $R$ 之间（即年龄大于等于 $L$ 小于等于 $R$）的妖怪的店。\n\n也有可能 $u$ 这个地方离这些妖怪比较远，于是幽香就想要知道所有年龄在 $L$ 到 $R$ 之间的妖怪，到点 $u$ 的距离的和是多少（妖怪到 $u$ 的距离是该妖怪所在地方到 $u$ 的路径上的边的权之和），幽香把这个称为这个开店方案的方便值。\n\n幽香她们还没有决定要把店开在哪里，八云紫倒是准备了很多方案，于是幽香想要知道，对于每个方案，方便值是多少呢。\n", "inputFormat": "第一行三个用空格分开的数 $n,Q$ 和 $A$，表示树的大小、开店的方案个数和妖怪的年龄上限。\n\n第二行 $n$ 个用空格分开的数 $x_1,x_2,\\ldots,x_n$；$x_i$ 表示第 $i$ 个地点妖怪的年龄，满足 $0\\le x_i\\lt A$。(年龄是可以为 $0$ 的，例如刚出生的妖怪的年龄为 $0$。) \n\n接下来 $n-1$  行，每行三个用空格分开的数 $a$、$b$、$c$，表示树上的顶点 $a$ 和 $b$ 之间有一条权为 $c(1\\le c\\le1000)$ 的边，$a$ 和 $b$ 是顶点编号。 \n\n接下来 $Q$ 行，每行三个用空格分开的数 $u,a,b$。\n\n对于这 $Q$ 行的每一行，用 $a,b,A$ 计算出 $L$ 和 $R$，表示询问”在地方 $u$ 开店，面向妖怪的年龄区间为 $[L,R]$ 的方案的方便值是多少“。\n\n对于其中第 $1$ 行，$L$ 和 $R$ 的计算方法为：$L=\\min(a\\bmod A,b\\bmod A),R=\\max(a\\bmod A,b\\bmod A)$ 。\n\n对于第 $2$ 到第 $Q$ 行，假设前一行得到的方便值为 $ans$，那么当前行的 $L$ 和 $R$ 计算方法为： $L=\\min((a+ans)\\bmod A,(b+ans)\\bmod A), R=\\max((a+ans)\\bmod A,(b+ans)\\bmod A)$ 。", "outputFormat": "对于每个方案，输出一行表示方便值。\n", "hint": "满足 $n\\le1.5 \\times 10^5,Q\\le2 \\times 10^5$。对于所有数据，满足 $A\\le 10^9$。 ", "locale": "zh-CN"}}}
{"pid": "P3242", "type": "P", "difficulty": 6, "samples": [["10 10 10\n1 2\n2 3\n3 4\n4 5\n5 6\n6 7\n7 8\n8 9\n9 10\n3 2 217394434\n10 7 13022269\n6 7 283254485\n6 8 333042360\n4 6 442139372\n8 3 225045590\n10 4 922205209\n10 8 808296330\n9 2 486331361\n4 9 551176338\n1 8 5\n3 8 3\n3 8 4\n1 8 3\n4 8 1\n2 3 1\n2 3 1\n2 3 1\n2 4 1\n1 4 1", "442139372 \n333042360 \n442139372 \n283254485 \n283254485 \n217394434 \n217394434 \n217394434 \n217394434 \n217394434"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "各省省选", "湖南", "深度优先搜索 DFS", "最近公共祖先 LCA", "树套树", "整体二分"], "title": "[HNOI2015] 接水果", "background": "", "description": "风见幽香非常喜欢玩一个叫做 osu! 的游戏，其中她最喜欢玩的模式就是接水果。由于她已经 DT FC 了 The big black，她觉得这个游戏太简单了，于是发明了一个更加难的版本。\n\n首先有一个地图，是一棵由 $n$ 个顶点，$n-1$ 条边组成的树。\n\n这颗树上有 $p$ 个盘子，每个盘子实际上是一条路径，并且每个盘子还有一个权值。第 $i$ 个盘子就是顶点 $a_i$ 到顶点 $b_i$ 的路径（由于是树，所以从 $a_i$ 到 $b_i$ 的路径是唯一的），权值为 $c_i$。\n\n接下来依次会有 $q$ 个水果掉下来，每个水果本质上也是一条路径，第 $i$ 个水果是从顶点 $u_i$ 到顶点 $v_i$ 的路径。\n\n幽香每次需要选择一个盘子去接当前的水果：一个盘子能接住一个水果，当且仅当盘子的路径是水果的路径的子路径。这里规定：从 $a$ 到 $b$ 的路径与从 $b$ 到 $a$ 的路径是同一条路径。\n\n当然为了提高难度，对于第 $i$ 个水果，你需要选择能接住它的所有盘子中，权值第 $k_i$ 小的那个盘子，每个盘子可重复使用（没有使用次数的上限：一个盘子接完一个水果后，后面还可继续接其他水果，只要它是水果路径的子路径）。幽香认为这个游戏很难，你能轻松解决给她看吗？\n", "inputFormat": "第一行三个数 $n$ 和 $p$ 和 $q$，表示树的大小和盘子的个数和水果的个数。\n\n接下来 $n-1$ 行，每行两个数 $a,b$，表示树上的 $a$ 和 $b$ 之间有一条边。树中顶点按 $1$ 到 $n$ 标号。\n\n接下来 $p$ 行，每行三个数 $a,b,c$，表示路径为 $a$ 到 $b$、权值为 $c$ 的盘子，其中 $a \\neq b$。\n\n接下来 $q$ 行，每行三个数 $u,v,k$，表示路径为 $u$ 到 $v$ 的水果，其中 $u \\neq v$，你需要选择第 $k$ 小的盘子，第 $k$ 小一定存在。\n", "outputFormat": "对于每个果子，输出一行表示选择的盘子的权值。\n", "hint": "对于 $100\\%$ 的数据，$1\\leq n,p,q \\leq4\\times 10^4$，$0 \\le c \\le 10^9$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2015] Catching Fruits", "background": "", "description": "Kazami Yuuka really enjoys playing a game called osu!, and her favorite mode is catching fruits. Since she has already DT FC’d The Big Black, she thinks the game is too easy, so she invented a harder version.\n\nFirst, there is a map that is a tree with $n$ vertices and $n-1$ edges.\n\nThere are $p$ plates on this tree. Each plate is actually a path, and each plate also has a weight. The $i$-th plate is the path from vertex $a_i$ to vertex $b_i$ (since it is a tree, the path from $a_i$ to $b_i$ is unique), with weight $c_i$.\n\nNext, $q$ fruits will fall one by one; each fruit is essentially also a path. The $i$-th fruit is the path from vertex $u_i$ to vertex $v_i$.\n\nEach time, Yuuka needs to choose one plate to catch the current fruit: a plate can catch a fruit if and only if the plate’s path is a subpath of the fruit’s path. By convention, the path from $a$ to $b$ is considered the same as the path from $b$ to $a$.\n\nTo increase the difficulty, for the $i$-th fruit, among all plates that can catch it, you must choose the one with the $k_i$-th smallest weight. Each plate can be reused without limit: after catching one fruit, it can continue to catch other fruits as long as it is a subpath of the fruit’s path. Yuuka thinks this game is hard; can you solve it easily for her?", "inputFormat": "- The first line contains three integers $n$, $p$, and $q$, denoting the size of the tree, the number of plates, and the number of fruits.\n- The next $n-1$ lines each contain two integers $a$ and $b$, indicating that there is an edge between $a$ and $b$ in the tree. The vertices are labeled from $1$ to $n$.\n- The next $p$ lines each contain three integers $a$, $b$, and $c$, describing a plate whose path is from $a$ to $b$ with weight $c$, where $a \\ne b$.\n- The next $q$ lines each contain three integers $u$, $v$, and $k$, describing a fruit whose path is from $u$ to $v$, where $u \\ne v$. You need to choose the $k$-th smallest plate, and the $k$-th smallest is guaranteed to exist.", "outputFormat": "For each fruit, output one line containing the weight of the chosen plate.", "hint": "For $100\\%$ of the testdata, $1 \\le n, p, q \\le 4 \\times 10^4$, $0 \\le c \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2015] 接水果", "background": "", "description": "风见幽香非常喜欢玩一个叫做 osu! 的游戏，其中她最喜欢玩的模式就是接水果。由于她已经 DT FC 了 The big black，她觉得这个游戏太简单了，于是发明了一个更加难的版本。\n\n首先有一个地图，是一棵由 $n$ 个顶点，$n-1$ 条边组成的树。\n\n这颗树上有 $p$ 个盘子，每个盘子实际上是一条路径，并且每个盘子还有一个权值。第 $i$ 个盘子就是顶点 $a_i$ 到顶点 $b_i$ 的路径（由于是树，所以从 $a_i$ 到 $b_i$ 的路径是唯一的），权值为 $c_i$。\n\n接下来依次会有 $q$ 个水果掉下来，每个水果本质上也是一条路径，第 $i$ 个水果是从顶点 $u_i$ 到顶点 $v_i$ 的路径。\n\n幽香每次需要选择一个盘子去接当前的水果：一个盘子能接住一个水果，当且仅当盘子的路径是水果的路径的子路径。这里规定：从 $a$ 到 $b$ 的路径与从 $b$ 到 $a$ 的路径是同一条路径。\n\n当然为了提高难度，对于第 $i$ 个水果，你需要选择能接住它的所有盘子中，权值第 $k_i$ 小的那个盘子，每个盘子可重复使用（没有使用次数的上限：一个盘子接完一个水果后，后面还可继续接其他水果，只要它是水果路径的子路径）。幽香认为这个游戏很难，你能轻松解决给她看吗？\n", "inputFormat": "第一行三个数 $n$ 和 $p$ 和 $q$，表示树的大小和盘子的个数和水果的个数。\n\n接下来 $n-1$ 行，每行两个数 $a,b$，表示树上的 $a$ 和 $b$ 之间有一条边。树中顶点按 $1$ 到 $n$ 标号。\n\n接下来 $p$ 行，每行三个数 $a,b,c$，表示路径为 $a$ 到 $b$、权值为 $c$ 的盘子，其中 $a \\neq b$。\n\n接下来 $q$ 行，每行三个数 $u,v,k$，表示路径为 $u$ 到 $v$ 的水果，其中 $u \\neq v$，你需要选择第 $k$ 小的盘子，第 $k$ 小一定存在。\n", "outputFormat": "对于每个果子，输出一行表示选择的盘子的权值。\n", "hint": "对于 $100\\%$ 的数据，$1\\leq n,p,q \\leq4\\times 10^4$，$0 \\le c \\le 10^9$。\n", "locale": "zh-CN"}}}
{"pid": "P3243", "type": "P", "difficulty": 4, "samples": [["3\n5 4\n5 4\n5 3\n4 2\n3 2\n3 3\n1 2\n2 3\n3 1\n5 2\n5 2\n4 3", "1 5 3 4 2 \r\nImpossible! \r\n1 5 2 4 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2015", "各省省选", "湖南", "排序", "拓扑排序"], "title": "[HNOI2015] 菜肴制作", "background": "", "description": "知名美食家小 A 被邀请至 ATM 大酒店，为其品评菜肴。ATM 酒店为小 A 准备了 $n$ 道菜肴，酒店按照为菜肴预估的质量从高到低给予 $1$ 到 $n$ 的顺序编号，预估质量最高的菜肴编号为 $1$。\n\n由于菜肴之间口味搭配的问题，某些菜肴必须在另一些菜肴之前制作，具体的，一共有 $m$ 条形如 $i$ 号菜肴必须先于 $j$ 号菜肴制作的限制，我们将这样的限制简写为 $(i,j)$。\n\n现在，酒店希望能求出一个最优的菜肴的制作顺序，使得小 A 能尽量先吃到质量高的菜肴：\n\n也就是说，\n\n1. 在满足所有限制的前提下，$1$ 号菜肴尽量优先制作。\n\n2. 在满足所有限制，$1$ 号菜肴尽量优先制作的前提下，$2$ 号菜肴尽量优先制作。\n\n3. 在满足所有限制，$1$ 号和 $2$ 号菜肴尽量优先的前提下，$3$ 号菜肴尽量优先制作。\n\n4. 在满足所有限制，$1$ 号和 $2$ 号和 $3$ 号菜肴尽量优先的前提下，$4$ 号菜肴尽量优先制作。\n\n5. 以此类推。\n\n例 1：共 $4$ 道菜肴，两条限制 $(3,1)$、$(4,1)$，那么制作顺序是 $3,4,1,2$。\n\n例 2：共 $5$ 道菜肴，两条限制 $(5,2)$、$(4,3)$，那么制作顺序是 $1,5,2,4,3$。\n\n例 1 里，首先考虑 $1$，因为有限制 $(3,1)$ 和 $(4,1)$，所以只有制作完 $3$ 和 $4$ 后才能制作 $1$，而根据 3，$3$ 号又应尽量比 $4$ 号优先，所以当前可确定前三道菜的制作顺序是 $3,4,1$；接下来考虑 $2$，确定最终的制作顺序是 $3,4,1,2$。\n\n例 $2$ 里，首先制作 $1$ 是不违背限制的；接下来考虑 $2$ 时有 $(5,2)$ 的限制，所以接下来先制作 $5$ 再制作 $2$；接下来考虑 $3$ 时有 $(4,3)$ 的限制，所以接下来先制作 $4$ 再制作 $3$，从而最终的顺序是 $1,5,2,4,3$。现在你需要求出这个最优的菜肴制作顺序。无解输出 `Impossible!`（首字母大写，其余字母小写）", "inputFormat": "第一行是一个正整数 $t$，表示数据组数。接下来是 $t$ 组数据。对于每组数据：第一行两个用空格分开的正整数 $n$ 和 $m$，分别表示菜肴数目和制作顺序限制的条目数。接下来 $m$ 行，每行两个正整数 $x,y$，表示 $x$ 号菜肴必须先于 $y$ 号菜肴制作的限制。", "outputFormat": "输出文件仅包含 $t$ 行，每行 $n$ 个整数，表示最优的菜肴制作顺序，或者 `Impossible!` 表示无解。\n", "hint": "**【样例解释】**\n\n第二组数据同时要求菜肴 $1$ 先于菜肴 $2$ 制作，菜肴 $2$ 先于菜肴 $3$ 制作，菜肴 $3$ 先于菜肴 $1$ 制作，而这是无论如何也不可能满足的，从而导致无解。\n\n**【数据范围】**\n\n$100\\%$ 的数据满足 $n,m\\le 10^5$，$1\\le t\\le 3$。\n\n$m$ 条限制中可能存在完全相同的限制。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2015] Dish Preparation", "background": "", "description": "The famous gourmet Xiao A is invited to the ATM Grand Hotel to evaluate dishes. The hotel prepares $n$ dishes and numbers them from $1$ to $n$ in decreasing order of estimated quality; dish $1$ has the highest estimated quality.\n\nDue to flavor pairing, some dishes must be prepared before others. Specifically, there are $m$ constraints of the form “dish $i$ must be prepared before dish $j$,” which we abbreviate as $(i, j)$.\n\nNow, the hotel wants to find an optimal preparation order so that Xiao A can eat higher-quality dishes as early as possible:\n\nThat is,\n\n1. Subject to all constraints, dish $1$ should be prepared as early as possible.\n2. Subject to all constraints and dish $1$ being as early as possible, dish $2$ should be as early as possible.\n3. Subject to all constraints and dishes $1$ and $2$ being as early as possible, dish $3$ should be as early as possible.\n4. Subject to all constraints and dishes $1$, $2$, and $3$ being as early as possible, dish $4$ should be as early as possible.\n5. And so on.\n\nExample 1: There are $4$ dishes with two constraints $(3, 1)$ and $(4, 1)$. Then the preparation order is $3, 4, 1, 2$.\n\nExample 2: There are $5$ dishes with two constraints $(5, 2)$ and $(4, 3)$. Then the preparation order is $1, 5, 2, 4, 3$.\n\nIn Example 1, consider dish $1$ first. Because of $(3, 1)$ and $(4, 1)$, dish $1$ can only be prepared after dishes $3$ and $4$ are finished. According to item 3, dish $3$ should be prioritized over dish $4$, so the first three dishes are $3, 4, 1$. Next, consider dish $2$, and the final order is $3, 4, 1, 2$.\n\nIn Example $2$, preparing dish $1$ first does not violate any constraints. Next, when considering dish $2$, there is the constraint $(5, 2)$, so prepare $5$ first and then $2$. Next, when considering dish $3$, there is the constraint $(4, 3)$, so prepare $4$ first and then $3$, resulting in the final order $1, 5, 2, 4, 3$. Now you need to compute this optimal preparation order. If there is no solution, output `Impossible!`.", "inputFormat": "The first line contains a positive integer $t$, the number of test cases. Then follow $t$ test cases. For each test case: The first line contains two space-separated positive integers $n$ and $m$, the number of dishes and the number of precedence constraints. The next $m$ lines each contain two positive integers $x, y$, meaning dish $x$ must be prepared before dish $y$.", "outputFormat": "Output exactly $t$ lines. Each line contains $n$ integers representing the optimal preparation order, or `Impossible!` if there is no solution.", "hint": "- Sample Explanation:\n\n  In the second test case, it simultaneously requires dish $1$ before dish $2$, dish $2$ before dish $3$, and dish $3$ before dish $1$, which is impossible to satisfy, so there is no solution.\n\n- Constraints:\n\n  For $100\\%$ of the testdata, $n, m \\le 10^5$, $1 \\le t \\le 3$.\n\n  There may be completely identical constraints among the $m$ constraints.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2015] 菜肴制作", "background": "", "description": "知名美食家小 A 被邀请至 ATM 大酒店，为其品评菜肴。ATM 酒店为小 A 准备了 $n$ 道菜肴，酒店按照为菜肴预估的质量从高到低给予 $1$ 到 $n$ 的顺序编号，预估质量最高的菜肴编号为 $1$。\n\n由于菜肴之间口味搭配的问题，某些菜肴必须在另一些菜肴之前制作，具体的，一共有 $m$ 条形如 $i$ 号菜肴必须先于 $j$ 号菜肴制作的限制，我们将这样的限制简写为 $(i,j)$。\n\n现在，酒店希望能求出一个最优的菜肴的制作顺序，使得小 A 能尽量先吃到质量高的菜肴：\n\n也就是说，\n\n1. 在满足所有限制的前提下，$1$ 号菜肴尽量优先制作。\n\n2. 在满足所有限制，$1$ 号菜肴尽量优先制作的前提下，$2$ 号菜肴尽量优先制作。\n\n3. 在满足所有限制，$1$ 号和 $2$ 号菜肴尽量优先的前提下，$3$ 号菜肴尽量优先制作。\n\n4. 在满足所有限制，$1$ 号和 $2$ 号和 $3$ 号菜肴尽量优先的前提下，$4$ 号菜肴尽量优先制作。\n\n5. 以此类推。\n\n例 1：共 $4$ 道菜肴，两条限制 $(3,1)$、$(4,1)$，那么制作顺序是 $3,4,1,2$。\n\n例 2：共 $5$ 道菜肴，两条限制 $(5,2)$、$(4,3)$，那么制作顺序是 $1,5,2,4,3$。\n\n例 1 里，首先考虑 $1$，因为有限制 $(3,1)$ 和 $(4,1)$，所以只有制作完 $3$ 和 $4$ 后才能制作 $1$，而根据 3，$3$ 号又应尽量比 $4$ 号优先，所以当前可确定前三道菜的制作顺序是 $3,4,1$；接下来考虑 $2$，确定最终的制作顺序是 $3,4,1,2$。\n\n例 $2$ 里，首先制作 $1$ 是不违背限制的；接下来考虑 $2$ 时有 $(5,2)$ 的限制，所以接下来先制作 $5$ 再制作 $2$；接下来考虑 $3$ 时有 $(4,3)$ 的限制，所以接下来先制作 $4$ 再制作 $3$，从而最终的顺序是 $1,5,2,4,3$。现在你需要求出这个最优的菜肴制作顺序。无解输出 `Impossible!`（首字母大写，其余字母小写）", "inputFormat": "第一行是一个正整数 $t$，表示数据组数。接下来是 $t$ 组数据。对于每组数据：第一行两个用空格分开的正整数 $n$ 和 $m$，分别表示菜肴数目和制作顺序限制的条目数。接下来 $m$ 行，每行两个正整数 $x,y$，表示 $x$ 号菜肴必须先于 $y$ 号菜肴制作的限制。", "outputFormat": "输出文件仅包含 $t$ 行，每行 $n$ 个整数，表示最优的菜肴制作顺序，或者 `Impossible!` 表示无解。\n", "hint": "**【样例解释】**\n\n第二组数据同时要求菜肴 $1$ 先于菜肴 $2$ 制作，菜肴 $2$ 先于菜肴 $3$ 制作，菜肴 $3$ 先于菜肴 $1$ 制作，而这是无论如何也不可能满足的，从而导致无解。\n\n**【数据范围】**\n\n$100\\%$ 的数据满足 $n,m\\le 10^5$，$1\\le t\\le 3$。\n\n$m$ 条限制中可能存在完全相同的限制。", "locale": "zh-CN"}}}
{"pid": "P3244", "type": "P", "difficulty": 6, "samples": [["4 4 4 3\n1 2\n1 3\n2 4\n3 2", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "递推", "2015", "各省省选", "湖南", "拓扑排序"], "title": "[HNOI2015] 落忆枫音", "background": "「恒逸，你相信灵魂的存在吗？」 郭恒逸和姚枫茜漫步在枫音乡的街道上。望着漫天飞舞的红枫，枫茜突然问出这样一个问题。\n\n「相信吧。不然我们是什么，一团肉吗？要不是有灵魂......我们也不可能再见到你姐姐吧。」 恒逸给出了一个略微无厘头的回答。枫茜听后笑了笑。 「那你仔细观察过枫叶吗？」 说罢，枫茜伸手，接住了一片飘落的枫叶。\n\n「其实每一片枫叶都是有灵魂的。你看，枫叶上不是有这么多脉络吗？我听说，枫叶上有一些特殊的位置，就和人的穴位一样。脉络都是连接在这些穴位之间的。枫树的灵魂流过每片枫叶的根部，沿着这些脉络，慢慢漫进穴位，沁入整片枫叶。也是因为这个原因，脉络才都是单向的，灵魂可不能倒着溜回来呢。」 恒逸似懂非懂地点了点头。枫茜接着说了下去。\n\n「正是因为有了灵魂，每片枫叶才会与众不同。也正是因为有了灵魂，每片枫叶也都神似其源本的枫树，就连脉络也形成了一棵树的样子。但如果仔细看的话，会发现，在脉络树之外，还存在其它的非常细的脉络。虽然这些脉络并不在树上，但他们的方向也同样顺着灵魂流淌的方向，绝不会出现可能使灵魂倒流的回路。」  恒逸好像突然想到了什么。 「那这些脉络岂不是可以取代已有的脉络，出现在脉络树上？」 枫茜闭上了眼睛。\n\n「是啊，就是这样。脉络树并不是唯一的。只要有一些微小的偏差，脉络树就可能差之万里，哪怕是在这同一片枫叶上。就像我们的故事，结局也不是唯一的。只要改变一个小小的选项，故事流程可能就会被彻底扭转。」\n\n「真是深奥啊......」 恒逸盯着这片红枫，若有所思地说。枫茜继续说道。\n\n「还不止如此呢。所有的脉络都不会永恒存在，也不会永恒消失。不管是脉络树上的脉络，还是之外的细小脉络，都是如此。存在的脉络可能断开消失，消失的脉络也可能再次连接。万物皆处在永恒的变化之中，人与人之间的羁绊也是。或许有一天，我们与大家的羁绊也会如同脉络一样，被无情地斩断。或许我们也终将成为”枫音乡的过客“。或许这一切都会是必然，是枫树的灵魂所决定的......」\n\n枫茜的眼角泛起了几滴晶莹剔透的泪珠。恒逸看着这样的枫茜，将她抱入怀中。\n\n「别这样想，枫茜。就算脉络断开，也有可能还会有新的脉络树，也还会与枫树的根相连。这样的话，我们的羁绊仍然存在，只是稍微绕了一些远路而已。无论如何，我都不会离开你的。因为你是我穷尽一生所寻找的，我的真恋啊！」\n\n两人的目光对上了。枫茜幸福地笑了，把头埋进了恒逸的怀抱。从远方山上的枫林中，传来了枫的声音。", "description": "不妨假设枫叶上有 $n$ 个穴位，穴位的编号为 $1\\sim n$。有若干条有向的脉络连接着这些穴位。\n\n穴位和脉络组成一个有向无环图——称之为**脉络图**（例如图 $1$），穴位的编号使得穴位 $1$ 没有从其他穴位连向它的脉络，即穴位 $1$ 只有连出去的脉络；由上面的故事可知，这个有向无环图存在一个树形子图，它是以穴位 $1$ 为根的包含全部 $n$ 个穴位的一棵树——称之为**脉络树**（例如图 $2$ 和图 $3$ 给出的树都是图 $1$ 给出的脉络图的子图）。\n\n值得注意的是，脉络图中的脉络树方案可能有多种可能性，例如图 $2$ 和图 $3$ 就是图 $1$ 给出的脉络图的两个脉络树方案。\n\n ![](https://cdn.luogu.com.cn/upload/pic/11330.png) \n\n脉络树的形式化定义为：以穴位 $r$ 为根的脉络树由枫叶上全部 $n$ 个穴位以及 $(n-1)$ 条脉络组成，脉络树里没有环，亦不存在从一个穴位连向自身的脉络，且对于枫叶上的每个穴位 $s$，都存在一条唯一的包含于脉络树内的脉络路径，使得从穴位 $r$ 出发沿着这条路径可以到达穴位  $s$。 \n\n现在向脉络图添加一条与已有脉络不同的脉络（**注意：连接 $2$ 个穴位但方向不同的脉络是不同的脉络**，例如从穴位 $3$ 到 $4$ 的脉络与从 $4$ 到 $3$ 的脉络是不同的脉络，因此，图 $1$ 中不能添加从 $3$ 到 $4$ 的脉络，但可添加从 $4$ 到 $3$ 的脉络）。这条新脉络**可以是从一个穴位连向自身的**（例如，图 1 中可添加从 $4$ 到 $4$ 的脉络）。\n\n原脉络图添加这条新脉络后得到的新脉络图可能会出现脉络构成的环。 请你求出添加了这一条脉络之后的新脉络图的以穴位 $1$ 为根的脉络树方案数。\n\n由于方案可能有太多太多，请输出方案数对 $(10^9+7)$ 取模后得到的结果。", "inputFormat": "输入文件的第一行包含四个整数 $n,m,x,y$，依次代表枫叶上的穴位数、脉络数，以及要添加的脉络是从穴位 $x$ 连向穴位 $y$ 的。 \n\n接下来 $m$ 行，每行两个整数，由空格隔开，代表一条脉络。\n\n第 $i$ 行的两个整数为 $u_i$ 和 $v_i$，代表第 $i$ 条脉络是从穴位 $u_i$ 连向穴位 $v_i$ 的。", "outputFormat": "输出一行，为添加了从穴位 $x$ 连向穴位 $y$ 的脉络后，枫叶上以穴位 $1$ 为根的脉络树的方案数对 $(10^9+7)$ 取模得到的结果。\n", "hint": "对于所有测试数据，保证：\n\n- $1 \\leq n \\leq 100000$；\n- $n - 1 \\leq m \\leq \\min(200000, n(n -1)/2)$；\n- $1 \\leq x, y, u_i, v_i \\leq n$。\n\nFixed by Starrykiller.", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2015] Fallen Memories of Maple Echo", "background": "“Hengyi, do you believe that souls exist?” Guo Hengyi and Yao Fengqian were strolling along the street in Maple Echo Village. Watching the fluttering red maple leaves, Fengqian suddenly asked this question.\n\n“I guess I do. Otherwise, what are we—just a lump of flesh? Without souls... we couldn’t have seen your sister again, right?” Hengyi gave a slightly offbeat answer. Fengqian smiled. “Then have you carefully observed maple leaves?” With that, Fengqian reached out and caught a falling maple leaf.\n\n“In fact, every maple leaf has a soul. Look, aren’t there many veins on a maple leaf? I’ve heard that there are some special points on a leaf, just like acupoints on a human body. The veins connect these acupoints. The maple tree’s soul flows through the root of each leaf, along these veins, slowly soaking into the acupoints and permeating the entire leaf. This is also why the veins are all one-way—souls can’t flow backward.” Hengyi nodded, half understanding. Fengqian continued.\n\n“Because of the soul, every maple leaf is unique. Also because of the soul, every leaf resembles its source—the maple tree itself. Even the vein pattern forms the shape of a tree. But if you look carefully, you’ll find that beyond the vein-tree there are other very fine veins. Although these veins are not on the tree, their directions still follow the direction of the soul’s flow, and there will never be a cycle that could cause reverse flow.” Hengyi suddenly thought of something. “So these veins could replace existing ones and appear on the vein-tree, right?” Fengqian closed her eyes.\n\n“Yes, exactly. The vein-tree is not unique. With slight deviations, the vein-tree might differ greatly, even on the very same leaf. Just like our story—the ending is not unique. Change a small choice, and the entire storyline may be completely altered.”\n\n“That’s so profound...” Hengyi stared at the red maple leaf, contemplating. Fengqian went on.\n\n“And that’s not all. No vein exists forever, nor disappears forever. This is true for both veins on the vein-tree and the fine veins outside it. Existing veins may break and vanish; vanished veins may reconnect. Everything is in eternal change, including the bonds between people. Perhaps one day, our bonds with everyone will be ruthlessly severed like veins. Perhaps we, too, will become ‘passersby in Maple Echo Village.’ Perhaps all this is inevitable—decided by the soul of the maple tree...”\n\nTears shimmered in the corner of Fengqian’s eyes. Seeing this, Hengyi held her in his arms.\n\n“Don’t think like that, Fengqian. Even if some veins break, a new vein-tree may still form and still connect to the tree’s root. If so, our bond still exists—it only takes a slightly longer path. No matter what, I won’t leave you. Because you are the one I’ve sought my entire life—my true love!”\n\nTheir eyes met. Fengqian smiled happily and buried her head in Hengyi’s embrace. From the maple forest on the distant mountain came the sound of the maples.", "description": "Assume there are $n$ acupoints on a maple leaf, numbered $1 \\sim n$. Several directed veins connect these acupoints.\n\nThe acupoints and veins form a directed acyclic graph—called the vein graph (for example, Figure $1$). The numbering of the acupoints ensures that acupoint $1$ has no incoming veins from other acupoints, that is, acupoint $1$ only has outgoing veins. As the story above suggests, this directed acyclic graph contains a tree-shaped subgraph: a tree rooted at acupoint $1$ that spans all $n$ acupoints—called a vein-tree (for example, the trees in Figure $2$ and Figure $3$ are both vein-trees of the vein graph given by Figure $1$).\n\nNote that there may be multiple vein-tree schemes in the vein graph. For example, Figure $2$ and Figure $3$ are two different vein-tree schemes for the vein graph in Figure $1$.\n\n![](https://cdn.luogu.com.cn/upload/pic/11330.png)\n\nA formal definition of a vein-tree is as follows: a vein-tree rooted at acupoint $r$ consists of all $n$ acupoints and $(n-1)$ veins. There are no cycles in the vein-tree, nor self-loops. Moreover, for every acupoint $s$ on the leaf, there exists a unique vein path contained in the vein-tree such that starting from acupoint $r$ and following this path you can reach acupoint $s$.\n\nNow we add one new vein, different from all existing veins, to the vein graph (note: veins connecting the same two acupoints but in opposite directions are considered different. For example, the vein from acupoint $3$ to $4$ is different from the vein from $4$ to $3$. Therefore, in Figure $1$, you cannot add a vein from $3$ to $4$, but you may add a vein from $4$ to $3$). This new vein may be a self-loop (for example, in Figure 1, a vein from $4$ to $4$ can be added).\n\nAfter adding this new vein, cycles formed by veins may appear in the new vein graph. Please compute the number of vein-tree schemes rooted at acupoint $1$ in the new vein graph after adding this vein.\n\nSince the number of schemes may be very large, output it modulo $(10^9+7)$.", "inputFormat": "The first line contains four integers $n, m, x, y$, representing the number of acupoints on the leaf, the number of veins, and that the vein to be added goes from acupoint $x$ to acupoint $y$.\n\nThe next $m$ lines each contain two integers separated by a space, representing one existing vein.\n\nIn line $i$, the two integers are $u_i$ and $v_i$, meaning the $i$-th vein goes from acupoint $u_i$ to acupoint $v_i$.", "outputFormat": "Output one line: the number of vein-tree schemes rooted at acupoint $1$ on the leaf after adding the vein from $x$ to $y$, modulo $(10^9+7)$.", "hint": "For all testdata, it is guaranteed that:\n- $1 \\leq n \\leq 100000$.\n- $n - 1 \\leq m \\leq \\min(200000, n(n - 1)/2)$.\n- $1 \\leq x, y, u_i, v_i \\leq n$.\n\nFixed by Starrykiller.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2015] 落忆枫音", "background": "「恒逸，你相信灵魂的存在吗？」 郭恒逸和姚枫茜漫步在枫音乡的街道上。望着漫天飞舞的红枫，枫茜突然问出这样一个问题。\n\n「相信吧。不然我们是什么，一团肉吗？要不是有灵魂......我们也不可能再见到你姐姐吧。」 恒逸给出了一个略微无厘头的回答。枫茜听后笑了笑。 「那你仔细观察过枫叶吗？」 说罢，枫茜伸手，接住了一片飘落的枫叶。\n\n「其实每一片枫叶都是有灵魂的。你看，枫叶上不是有这么多脉络吗？我听说，枫叶上有一些特殊的位置，就和人的穴位一样。脉络都是连接在这些穴位之间的。枫树的灵魂流过每片枫叶的根部，沿着这些脉络，慢慢漫进穴位，沁入整片枫叶。也是因为这个原因，脉络才都是单向的，灵魂可不能倒着溜回来呢。」 恒逸似懂非懂地点了点头。枫茜接着说了下去。\n\n「正是因为有了灵魂，每片枫叶才会与众不同。也正是因为有了灵魂，每片枫叶也都神似其源本的枫树，就连脉络也形成了一棵树的样子。但如果仔细看的话，会发现，在脉络树之外，还存在其它的非常细的脉络。虽然这些脉络并不在树上，但他们的方向也同样顺着灵魂流淌的方向，绝不会出现可能使灵魂倒流的回路。」  恒逸好像突然想到了什么。 「那这些脉络岂不是可以取代已有的脉络，出现在脉络树上？」 枫茜闭上了眼睛。\n\n「是啊，就是这样。脉络树并不是唯一的。只要有一些微小的偏差，脉络树就可能差之万里，哪怕是在这同一片枫叶上。就像我们的故事，结局也不是唯一的。只要改变一个小小的选项，故事流程可能就会被彻底扭转。」\n\n「真是深奥啊......」 恒逸盯着这片红枫，若有所思地说。枫茜继续说道。\n\n「还不止如此呢。所有的脉络都不会永恒存在，也不会永恒消失。不管是脉络树上的脉络，还是之外的细小脉络，都是如此。存在的脉络可能断开消失，消失的脉络也可能再次连接。万物皆处在永恒的变化之中，人与人之间的羁绊也是。或许有一天，我们与大家的羁绊也会如同脉络一样，被无情地斩断。或许我们也终将成为”枫音乡的过客“。或许这一切都会是必然，是枫树的灵魂所决定的......」\n\n枫茜的眼角泛起了几滴晶莹剔透的泪珠。恒逸看着这样的枫茜，将她抱入怀中。\n\n「别这样想，枫茜。就算脉络断开，也有可能还会有新的脉络树，也还会与枫树的根相连。这样的话，我们的羁绊仍然存在，只是稍微绕了一些远路而已。无论如何，我都不会离开你的。因为你是我穷尽一生所寻找的，我的真恋啊！」\n\n两人的目光对上了。枫茜幸福地笑了，把头埋进了恒逸的怀抱。从远方山上的枫林中，传来了枫的声音。", "description": "不妨假设枫叶上有 $n$ 个穴位，穴位的编号为 $1\\sim n$。有若干条有向的脉络连接着这些穴位。\n\n穴位和脉络组成一个有向无环图——称之为**脉络图**（例如图 $1$），穴位的编号使得穴位 $1$ 没有从其他穴位连向它的脉络，即穴位 $1$ 只有连出去的脉络；由上面的故事可知，这个有向无环图存在一个树形子图，它是以穴位 $1$ 为根的包含全部 $n$ 个穴位的一棵树——称之为**脉络树**（例如图 $2$ 和图 $3$ 给出的树都是图 $1$ 给出的脉络图的子图）。\n\n值得注意的是，脉络图中的脉络树方案可能有多种可能性，例如图 $2$ 和图 $3$ 就是图 $1$ 给出的脉络图的两个脉络树方案。\n\n ![](https://cdn.luogu.com.cn/upload/pic/11330.png) \n\n脉络树的形式化定义为：以穴位 $r$ 为根的脉络树由枫叶上全部 $n$ 个穴位以及 $(n-1)$ 条脉络组成，脉络树里没有环，亦不存在从一个穴位连向自身的脉络，且对于枫叶上的每个穴位 $s$，都存在一条唯一的包含于脉络树内的脉络路径，使得从穴位 $r$ 出发沿着这条路径可以到达穴位  $s$。 \n\n现在向脉络图添加一条与已有脉络不同的脉络（**注意：连接 $2$ 个穴位但方向不同的脉络是不同的脉络**，例如从穴位 $3$ 到 $4$ 的脉络与从 $4$ 到 $3$ 的脉络是不同的脉络，因此，图 $1$ 中不能添加从 $3$ 到 $4$ 的脉络，但可添加从 $4$ 到 $3$ 的脉络）。这条新脉络**可以是从一个穴位连向自身的**（例如，图 1 中可添加从 $4$ 到 $4$ 的脉络）。\n\n原脉络图添加这条新脉络后得到的新脉络图可能会出现脉络构成的环。 请你求出添加了这一条脉络之后的新脉络图的以穴位 $1$ 为根的脉络树方案数。\n\n由于方案可能有太多太多，请输出方案数对 $(10^9+7)$ 取模后得到的结果。", "inputFormat": "输入文件的第一行包含四个整数 $n,m,x,y$，依次代表枫叶上的穴位数、脉络数，以及要添加的脉络是从穴位 $x$ 连向穴位 $y$ 的。 \n\n接下来 $m$ 行，每行两个整数，由空格隔开，代表一条脉络。\n\n第 $i$ 行的两个整数为 $u_i$ 和 $v_i$，代表第 $i$ 条脉络是从穴位 $u_i$ 连向穴位 $v_i$ 的。", "outputFormat": "输出一行，为添加了从穴位 $x$ 连向穴位 $y$ 的脉络后，枫叶上以穴位 $1$ 为根的脉络树的方案数对 $(10^9+7)$ 取模得到的结果。\n", "hint": "对于所有测试数据，保证：\n\n- $1 \\leq n \\leq 100000$；\n- $n - 1 \\leq m \\leq \\min(200000, n(n -1)/2)$；\n- $1 \\leq x, y, u_i, v_i \\leq n$。\n\nFixed by Starrykiller.", "locale": "zh-CN"}}}
{"pid": "P3245", "type": "P", "difficulty": 6, "samples": [["11\n121121\n3\n1 6\n1 5\n1 4", "5\n3\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["字符串", "2016", "莫队", "各省省选", "湖南"], "title": "[HNOI2016] 大数", "background": "", "description": "小 B 有一个很大的数 $S$，长度达到了 $n$ 位；这个数可以看成是一个数字串，它可能有前导 $0$，例如 `00009312345`。小 B 还有一个素数 $p$。现在，小 B 提出了 $m$ 个询问，每个询问求 $S$ 的一个子串中有多少子串是 $p$ 的倍数（$0$ 也是 $p$ 的倍数）。例如 $S$ 为 `0077` 时，其子串 `007` 有 $6$ 个子串：`0,0,7,00,07,007`；显然 `0077` 的子串 `007` 有 $6$ 个子串都是素数 $7$ 的倍数。", "inputFormat": "第一行一个整数：$p$。\n\n第二行一个数字串：$S$。\n\n第三行一个整数：$m$。接下来 $m$ 行，每行两个整数 $fr,to$，表示对 $S$ 的子串 $S[fr\\dots to]$ 的一次询问。注意：$S$ 的最左端的数字的位置序号为 $1$；例如 $S$ 为 `213567`，则 $S[1\\dots 3]$ 为 `213`。\n", "outputFormat": "输出 $m$ 行，每行一个整数，第 $i$ 行是第 $i$ 个询问的答案。", "hint": "#### 样例 1 解释\n\n第一个询问问的是整个串，满足条件的子串分别有：`121121,2112,11,121,121`。\n\n#### 数据范围\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 2\\times 10^5$，$2\\le p\\le 10^9$，$S$ 中只有数字字符，$p$ 为素数。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2016] Large Number", "background": "", "description": "Xiao B has a very large number $S$ of length $n$; this number can be regarded as a string of digits and may have leading $0$s, for example, `00009312345`. Xiao B also has a prime $p$. Now, Xiao B proposes $m$ queries. For each query, within a substring of $S$, count how many of its substrings are multiples of $p$ ($0$ is also considered a multiple of $p$). For example, when $S$ is `0077`, its substring `007` has $6$ substrings: `0,0,7,00,07,007`; clearly, all $6$ substrings of `007` are multiples of the prime $7$.", "inputFormat": "The first line contains an integer $p$.\n\nThe second line contains a digit string $S$.\n\nThe third line contains an integer $m$. Then $m$ lines follow, each containing two integers $fr, to$, representing a query on the substring $S[fr\\dots to]$ of $S$. Note: the leftmost digit of $S$ has index $1$; for example, if $S$ is `213567`, then $S[1\\dots 3]$ is `213`.", "outputFormat": "Output $m$ lines, each containing one integer. The $i$-th line is the answer to the $i$-th query.", "hint": "Sample 1 Explanation\n\nThe first query asks about the entire string. The substrings that satisfy the condition are: `121121,2112,11,121,121`.\n\nConstraints\n\nFor $100\\%$ of the testdata, $1\\le n,m\\le 2\\times 10^5$, $2\\le p\\le 10^9$, $S$ contains only digit characters, and $p$ is prime.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2016] 大数", "background": "", "description": "小 B 有一个很大的数 $S$，长度达到了 $n$ 位；这个数可以看成是一个数字串，它可能有前导 $0$，例如 `00009312345`。小 B 还有一个素数 $p$。现在，小 B 提出了 $m$ 个询问，每个询问求 $S$ 的一个子串中有多少子串是 $p$ 的倍数（$0$ 也是 $p$ 的倍数）。例如 $S$ 为 `0077` 时，其子串 `007` 有 $6$ 个子串：`0,0,7,00,07,007`；显然 `0077` 的子串 `007` 有 $6$ 个子串都是素数 $7$ 的倍数。", "inputFormat": "第一行一个整数：$p$。\n\n第二行一个数字串：$S$。\n\n第三行一个整数：$m$。接下来 $m$ 行，每行两个整数 $fr,to$，表示对 $S$ 的子串 $S[fr\\dots to]$ 的一次询问。注意：$S$ 的最左端的数字的位置序号为 $1$；例如 $S$ 为 `213567`，则 $S[1\\dots 3]$ 为 `213`。\n", "outputFormat": "输出 $m$ 行，每行一个整数，第 $i$ 行是第 $i$ 个询问的答案。", "hint": "#### 样例 1 解释\n\n第一个询问问的是整个串，满足条件的子串分别有：`121121,2112,11,121,121`。\n\n#### 数据范围\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 2\\times 10^5$，$2\\le p\\le 10^9$，$S$ 中只有数字字符，$p$ 为素数。", "locale": "zh-CN"}}}
{"pid": "P3246", "type": "P", "difficulty": 6, "samples": [["5 5\n5 2 4 1 3\n1 5\n1 3\n2 4\n3 5\n2 5", "28 \n17 \n11 \n11 \n17"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2016", "莫队", "线段树", "各省省选", "湖南", "前缀和", "栈", "ST 表", "扫描线", "单调栈"], "title": "[HNOI2016] 序列", "background": "", "description": "给定长度为 $ n $ 的序列：$ a_1, a_2, \\cdots , a_n $，记为 $ a[1 \\colon n] $。类似地，$ a[l \\colon r] $（$ 1 \\leq l \\leq r \\leq N$）是指序列：$ a_{l}, a_{l+1}, \\cdots ,a_{r-1}, a_r$。若 $1\\leq l \\leq s \\leq t \\leq r \\leq n$，则称 $ a[s \\colon t] $ 是 $ a[l \\colon r] $ 的子序列。\n\n现在有 $ q $ 个询问，每个询问给定两个数 $ l $ 和 $ r $，$ 1 \\leq l \\leq r \\leq n $，求 $ a[l \\colon r] $ 的不同子序列的最小值之和。例如，给定序列\n $ 5, 2, 4, 1, 3 $，询问给定的两个数为 $ 1 $ 和 $ 3 $，那么 $ a[1 \\colon 3] $ 有 $ 6 $ 个子序列 $a[1 \\colon 1], a[2 \\colon 2], a[3 \\colon 3], a[1 \\colon 2],a[2 \\colon 3], a[1 \\colon 3] $，这 $6 $ 个子序列的最小值之和为 $5+2+4+2+2+2=17$。", "inputFormat": "输入文件的第一行包含两个整数 $ n $ 和 $ q $，分别代表序列长度和询问数。\n\n接下来一行，包含 $ n $ 个整数，以空格隔开，第 $ i $ 个整数为 $ a_i $，即序列第 $i$ 个元素的值。\n\n接下来 $ q $ 行，每行包含两个整数 $ l $ 和 $ r $，代表一次询问。", "outputFormat": "对于每次询问，输出一行，代表询问的答案。\n", "hint": "对于 $100\\%$ 的数据，$ 1 \\leq n,q \\leq 100000$，$|a_i| \\leq 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2016] Sequence", "background": "", "description": "Given a sequence of length $n$: $a_1, a_2, \\cdots, a_n$, denoted by $a[1 \\colon n]$. Similarly, $a[l \\colon r]$ ($1 \\leq l \\leq r \\leq n$) denotes the sequence $a_l, a_{l+1}, \\cdots, a_{r-1}, a_r$. If $1 \\leq l \\leq s \\leq t \\leq r \\leq n$, then $a[s \\colon t]$ is called a subarray of $a[l \\colon r]$.\n\nNow there are $q$ queries. Each query gives two numbers $l$ and $r$, where $1 \\leq l \\leq r \\leq n$. For each query, find the sum of the minimum values over all subarrays of $a[l \\colon r]$. For example, given the sequence $5, 2, 4, 1, 3$ and the query $l = 1$, $r = 3$, the subarrays of $a[1 \\colon 3]$ are $a[1 \\colon 1], a[2 \\colon 2], a[3 \\colon 3], a[1 \\colon 2], a[2 \\colon 3], a[1 \\colon 3]$. The sum of their minimum values is $5 + 2 + 4 + 2 + 2 + 2 = 17$.", "inputFormat": "The first line contains two integers $n$ and $q$, the sequence length and the number of queries.\n\nThe second line contains $n$ integers separated by spaces. The $i$-th integer is $a_i$, the value of the $i$-th element of the sequence.\n\nEach of the next $q$ lines contains two integers $l$ and $r$, describing a query.", "outputFormat": "For each query, output one line containing the answer.", "hint": "Constraints: For $100\\%$ of the testdata, $1 \\leq n, q \\leq 100000$, $|a_i| \\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2016] 序列", "background": "", "description": "给定长度为 $ n $ 的序列：$ a_1, a_2, \\cdots , a_n $，记为 $ a[1 \\colon n] $。类似地，$ a[l \\colon r] $（$ 1 \\leq l \\leq r \\leq N$）是指序列：$ a_{l}, a_{l+1}, \\cdots ,a_{r-1}, a_r$。若 $1\\leq l \\leq s \\leq t \\leq r \\leq n$，则称 $ a[s \\colon t] $ 是 $ a[l \\colon r] $ 的子序列。\n\n现在有 $ q $ 个询问，每个询问给定两个数 $ l $ 和 $ r $，$ 1 \\leq l \\leq r \\leq n $，求 $ a[l \\colon r] $ 的不同子序列的最小值之和。例如，给定序列\n $ 5, 2, 4, 1, 3 $，询问给定的两个数为 $ 1 $ 和 $ 3 $，那么 $ a[1 \\colon 3] $ 有 $ 6 $ 个子序列 $a[1 \\colon 1], a[2 \\colon 2], a[3 \\colon 3], a[1 \\colon 2],a[2 \\colon 3], a[1 \\colon 3] $，这 $6 $ 个子序列的最小值之和为 $5+2+4+2+2+2=17$。", "inputFormat": "输入文件的第一行包含两个整数 $ n $ 和 $ q $，分别代表序列长度和询问数。\n\n接下来一行，包含 $ n $ 个整数，以空格隔开，第 $ i $ 个整数为 $ a_i $，即序列第 $i$ 个元素的值。\n\n接下来 $ q $ 行，每行包含两个整数 $ l $ 和 $ r $，代表一次询问。", "outputFormat": "对于每次询问，输出一行，代表询问的答案。\n", "hint": "对于 $100\\%$ 的数据，$ 1 \\leq n,q \\leq 100000$，$|a_i| \\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P3247", "type": "P", "difficulty": 6, "samples": [["4 5\n1 2 1 3\n1 3 1 2\n1 4 2 1\n2 4 3 2\n3 4 2 2\n5\n1 4 3 3\n4 2 2 3\n1 3 2 2\n2 3 2 2\n1 3 4 4", "Yes \nYes \nYes \nNo \nNo"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "2016", "并查集", "各省省选", "湖南", "分块"], "title": "[HNOI2016] 最小公倍数", "background": "", "description": "给定一张 $N$ 个顶点 $M$ 条边的无向图(顶点编号为 $1,2,\\ldots,n$)，每条边上带有权值。所有权值都可以分解成 $2^a\\times 3^b$ 的形式。\n\n现在有 $q$ 个询问，每次询问给定四个参数 $u,v,a$ 和 $b$，请你求出是否存在一条顶点 $u$ 到 $v$ 之间的路径，使得路径依次经过的边上的权值的最小公倍数为 $2^a\\times 3^b$。\n\n注意：路径可以不是简单路径。\n\n下面是一些可能有用的定义，如果与其它地方定义不同，在本题中以下面的定义为准：  \n\n最小公倍数： $ k $ 个数 $ a_1 , a_2, \\ldots, a_k $ 的最小公倍数是能被每个 $a_i$ 整除的最小正整数。\n\n路径：顶点序列 $ P \\colon P_1,P_2,\\ldots,P_k $ 是一条路径，当且仅当 $k \\geq 2$，且对于任意 $ 1 \\leq i < k $ ，节点 $ P_i $ 和 $ P_{i+1} $ 之间都有边相连。 \n\n简单路径：如果路径 $ P \\colon P_1,P_2,\\ldots,P_k $ 中，对于任意 $ 1 \\leq s \\neq t \\leq k $ 都有 $ P_s \\neq P_t $ ，那么称 $P$ 为简单路径。\n", "inputFormat": "输入文件的第一行包含两个整数 $N$ 和 $M$，分别代表图的顶点数和边数。\n\n接下来 $M$ 行，每行包含四个整数 $u,v,a,b$ 代表一条顶点 $u$ 和 $v$ 之间、权值为 $2^a\\times 3^b$ 的边。\n\n接下来一行包含一个整数 $q$，代表询问数。\n\n接下来 $q$ 行，每行包含四个整数 $u,v,a$ 和 $b$，代表一次询问。询问内容请参见问题描述。\n", "outputFormat": "对于每次询问，如果存在满足条件的路径，则输出一行 `Yes`，否则输出一行 `No`（注意：第一个字母大写，其余字母小写）。\n", "hint": "$1\\le n,q\\le 5\\times 10^4$，$1\\leq m\\leq 10^5$，$0\\leq a,b\\leq 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2016] Least Common Multiple", "background": "", "description": "Given an undirected graph with $N$ vertices and $M$ edges (the vertices are numbered $1, 2, \\ldots, N$). Each edge has a weight, and every weight can be factorized as $2^a \\times 3^b$.\n\nThere are $q$ queries. In each query, you are given four parameters $u, v, a$, and $b$. Please determine whether there exists a path from vertex $u$ to vertex $v$ such that the least common multiple of the weights of the edges traversed along the path is exactly $2^a \\times 3^b$.\n\nNote: The path does not have to be simple.\n\nBelow are some definitions that may be useful. If they differ from other sources, use the definitions below for this problem:  \nLeast common multiple: The least common multiple of $k$ numbers $a_1, a_2, \\ldots, a_k$ is the smallest positive integer that is divisible by each $a_i$.\n\nPath: A vertex sequence $P \\colon P_1, P_2, \\ldots, P_k$ is a path if and only if $k \\geq 2$, and for any $1 \\leq i < k$, there is an edge between $P_i$ and $P_{i+1}$.\n\nSimple path: If in a path $P \\colon P_1, P_2, \\ldots, P_k$, it holds that $P_s \\neq P_t$ for any $1 \\leq s \\neq t \\leq k$, then $P$ is called a simple path.", "inputFormat": "The first line contains two integers $N$ and $M$, the number of vertices and edges of the graph.\n\nEach of the next $M$ lines contains four integers $u, v, a, b$, representing an edge between vertices $u$ and $v$ with weight $2^a \\times 3^b$.\n\nThe next line contains an integer $q$, the number of queries.\n\nEach of the next $q$ lines contains four integers $u, v, a$, and $b$, representing one query. See the problem description for details.", "outputFormat": "For each query, output one line: `Yes` if such a path exists, otherwise output `No` (note: the first letter is uppercase, the rest are lowercase).", "hint": "Constraints: $1 \\leq N, q \\leq 5 \\times 10^4$, $1 \\leq M \\leq 10^5$, $0 \\leq a, b \\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2016] 最小公倍数", "background": "", "description": "给定一张 $N$ 个顶点 $M$ 条边的无向图(顶点编号为 $1,2,\\ldots,n$)，每条边上带有权值。所有权值都可以分解成 $2^a\\times 3^b$ 的形式。\n\n现在有 $q$ 个询问，每次询问给定四个参数 $u,v,a$ 和 $b$，请你求出是否存在一条顶点 $u$ 到 $v$ 之间的路径，使得路径依次经过的边上的权值的最小公倍数为 $2^a\\times 3^b$。\n\n注意：路径可以不是简单路径。\n\n下面是一些可能有用的定义，如果与其它地方定义不同，在本题中以下面的定义为准：  \n\n最小公倍数： $ k $ 个数 $ a_1 , a_2, \\ldots, a_k $ 的最小公倍数是能被每个 $a_i$ 整除的最小正整数。\n\n路径：顶点序列 $ P \\colon P_1,P_2,\\ldots,P_k $ 是一条路径，当且仅当 $k \\geq 2$，且对于任意 $ 1 \\leq i < k $ ，节点 $ P_i $ 和 $ P_{i+1} $ 之间都有边相连。 \n\n简单路径：如果路径 $ P \\colon P_1,P_2,\\ldots,P_k $ 中，对于任意 $ 1 \\leq s \\neq t \\leq k $ 都有 $ P_s \\neq P_t $ ，那么称 $P$ 为简单路径。\n", "inputFormat": "输入文件的第一行包含两个整数 $N$ 和 $M$，分别代表图的顶点数和边数。\n\n接下来 $M$ 行，每行包含四个整数 $u,v,a,b$ 代表一条顶点 $u$ 和 $v$ 之间、权值为 $2^a\\times 3^b$ 的边。\n\n接下来一行包含一个整数 $q$，代表询问数。\n\n接下来 $q$ 行，每行包含四个整数 $u,v,a$ 和 $b$，代表一次询问。询问内容请参见问题描述。\n", "outputFormat": "对于每次询问，如果存在满足条件的路径，则输出一行 `Yes`，否则输出一行 `No`（注意：第一个字母大写，其余字母小写）。\n", "hint": "$1\\le n,q\\le 5\\times 10^4$，$1\\leq m\\leq 10^5$，$0\\leq a,b\\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P3248", "type": "P", "difficulty": 6, "samples": [["5 2 3\n1 4\n1 3\n4 2\n4 5\n4 3\n3 2\n6 9\n1 8\n5 3", "6\n3\n3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000]}, "tags": ["2016", "各省省选", "湖南", "最近公共祖先 LCA", "树套树", "可持久化线段树"], "title": "[HNOI2016] 树", "background": "", "description": "小A想做一棵很大的树，但是他手上的材料有限，只好用点小技巧了。开始，小A只有一棵结点数为 $N$ 的树，结点的编号为 $1,2,...,N$，其中结点 $1$ 为根；我们称这颗树为模板树。小A决定通过这棵模板树来构建一颗大树。构建过程如下：\n\n1. 将模板树复制为初始的大树。\n\n2. 以下(2.1)(2.2)(2.3)步循环执行 $M$ 次\n\n（2.1）选择两个数字 $a,b$，其中 $1 \\leq a \\leq N, 1 \\leq b \\leq \\text{当前大树的结点数}$。\n\n（2.2）将模板树中以结点 $a$ 为根的子树复制一遍，挂到大树中结点 $b$ 的下方(也就是说，模板树中的结点 $a$ 为根的子树复制到大树中后，将成为大树中结点 $b$ 的子树)。\n\n（2.3）将新加入大树的结点按照在模板树中编号的顺序重新编号。例如，假设在进行2.2步之前大树有 $L$ 个结点，模板树中以 $a$ 为根的子树共有 $C$ 个结点，那么新加入模板树的 $C$ 个结点在大树中的编号将是 $L+1,L+2,...,L+C$ ；大树中这C个结点编号的大小顺序和模板树中对应的 $C$ 个结点的大小顺序是一致的。下面给出一个实例。假设模板树如下图：![](https://cdn.luogu.com.cn/upload/image_hosting/mchs3i55.png)\n\n根据第(1)步，初始的大树与模板树是相同的。\n\n在(2.1)步，假设选择了 $a=4, b=3$。运行(2.2)和(2.3)后，得到新的大树如下图所示\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ey2lqez8.png)\n\n现在他想问你，树中一些结点对的距离是多少。\n", "inputFormat": "第一行三个整数：$N,M,Q$，以空格隔开，$N$ 表示模板树结点数，$M$ 表示第(2)中的循环操作的次数，$Q$ 表示询问数量。\n\n接下来 $N-1$ 行，每行两个整数 $fr,to$，表示模板树中的一条树边。\n\n再接下来$M$行，每行两个整数$x,to$，表示将模板树中 $x$ 为根的子树复制到大树中成为结点 $to$ 的子树的一次操作。\n\n再接下来 $Q$ 行，每行两个整数 $fr,to$，表示询问大树中结点 $fr$ 和 $to$ 之间的距离是多少。\n\n$N,M,Q \\leq 100000$\n", "outputFormat": "输出 $Q$ 行，每行一个整数，第 $i$ 行是第 $i$ 个询问的答案。\n", "hint": "经过两次操作后，大树变成了下图所示的形状：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/370xfnn2.png)\n\n结点6到9之间经过了6条边，所以距离为6；类似地，结点1到8之间经过了3条边；结点5到3之间也经过了3条边。\n", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2016] Tree", "background": "", "description": "Little A wants to build a very large tree, but his materials are limited, so he uses a small trick. Initially, Little A has a tree with $N$ nodes, numbered $1, 2, ..., N$, where node $1$ is the root; we call this the \"template tree\". Little A decides to construct a large tree based on this template tree. The construction proceeds as follows:\n\n1. Copy the template tree as the initial large tree.\n\n2. Repeat steps (2.1)–(2.3) $M$ times.\n\n(2.1) Choose two integers $a, b$, where $1 \\leq a \\leq N$, $1 \\leq b \\leq$ the current number of nodes in the large tree.\n\n(2.2) Copy the subtree of the template tree rooted at node $a$, and attach it under node $b$ in the large tree (that is, after copying, the subtree rooted at node $a$ from the template tree becomes a subtree of node $b$ in the large tree).\n\n(2.3) Renumber the newly added nodes in the large tree according to their order in the template tree. For example, suppose the large tree has $L$ nodes before step (2.2), and the subtree rooted at $a$ in the template tree has $C$ nodes. Then the $C$ newly added nodes will be numbered $L+1, L+2, ..., L+C$ in the large tree; the relative order of these $C$ node numbers in the large tree is consistent with the order of the corresponding $C$ nodes in the template tree. An example is given below. Suppose the template tree is as follows: ![](https://cdn.luogu.com.cn/upload/image_hosting/mchs3i55.png)\n\nAccording to step (1), the initial large tree is the same as the template tree.\n\nIn step (2.1), suppose we choose $a=4, b=3$. After performing steps (2.2) and (2.3), the new large tree is as shown below:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ey2lqez8.png)\n\nNow he asks you for the distances between some pairs of nodes in the tree.", "inputFormat": "The first line contains three integers $N, M, Q$, separated by spaces, where $N$ is the number of nodes in the template tree, $M$ is the number of repetitions of the operation in step (2), and $Q$ is the number of queries.\n\nThe next $N-1$ lines each contain two integers $fr, to$, representing an edge in the template tree.\n\nThen there are $M$ lines, each containing two integers $x, to$, representing one operation that copies the subtree rooted at $x$ in the template tree and attaches it as a subtree of node $to$ in the large tree.\n\nThen there are $Q$ lines, each containing two integers $fr, to$, asking for the distance between nodes $fr$ and $to$ in the large tree.\n\n$N, M, Q \\leq 100000$.", "outputFormat": "Output $Q$ lines, each containing one integer. The $i$-th line is the answer to the $i$-th query.", "hint": "After two operations, the large tree becomes the shape shown below:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/370xfnn2.png)\n\nThere are $6$ edges between nodes $6$ and $9$, so the distance is $6$. Similarly, there are $3$ edges between nodes $1$ and $8$. There are also $3$ edges between nodes $5$ and $3$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2016] 树", "background": "", "description": "小A想做一棵很大的树，但是他手上的材料有限，只好用点小技巧了。开始，小A只有一棵结点数为 $N$ 的树，结点的编号为 $1,2,...,N$，其中结点 $1$ 为根；我们称这颗树为模板树。小A决定通过这棵模板树来构建一颗大树。构建过程如下：\n\n1. 将模板树复制为初始的大树。\n\n2. 以下(2.1)(2.2)(2.3)步循环执行 $M$ 次\n\n（2.1）选择两个数字 $a,b$，其中 $1 \\leq a \\leq N, 1 \\leq b \\leq \\text{当前大树的结点数}$。\n\n（2.2）将模板树中以结点 $a$ 为根的子树复制一遍，挂到大树中结点 $b$ 的下方(也就是说，模板树中的结点 $a$ 为根的子树复制到大树中后，将成为大树中结点 $b$ 的子树)。\n\n（2.3）将新加入大树的结点按照在模板树中编号的顺序重新编号。例如，假设在进行2.2步之前大树有 $L$ 个结点，模板树中以 $a$ 为根的子树共有 $C$ 个结点，那么新加入模板树的 $C$ 个结点在大树中的编号将是 $L+1,L+2,...,L+C$ ；大树中这C个结点编号的大小顺序和模板树中对应的 $C$ 个结点的大小顺序是一致的。下面给出一个实例。假设模板树如下图：![](https://cdn.luogu.com.cn/upload/image_hosting/mchs3i55.png)\n\n根据第(1)步，初始的大树与模板树是相同的。\n\n在(2.1)步，假设选择了 $a=4, b=3$。运行(2.2)和(2.3)后，得到新的大树如下图所示\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ey2lqez8.png)\n\n现在他想问你，树中一些结点对的距离是多少。\n", "inputFormat": "第一行三个整数：$N,M,Q$，以空格隔开，$N$ 表示模板树结点数，$M$ 表示第(2)中的循环操作的次数，$Q$ 表示询问数量。\n\n接下来 $N-1$ 行，每行两个整数 $fr,to$，表示模板树中的一条树边。\n\n再接下来$M$行，每行两个整数$x,to$，表示将模板树中 $x$ 为根的子树复制到大树中成为结点 $to$ 的子树的一次操作。\n\n再接下来 $Q$ 行，每行两个整数 $fr,to$，表示询问大树中结点 $fr$ 和 $to$ 之间的距离是多少。\n\n$N,M,Q \\leq 100000$\n", "outputFormat": "输出 $Q$ 行，每行一个整数，第 $i$ 行是第 $i$ 个询问的答案。\n", "hint": "经过两次操作后，大树变成了下图所示的形状：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/370xfnn2.png)\n\n结点6到9之间经过了6条边，所以距离为6；类似地，结点1到8之间经过了3条边；结点5到3之间也经过了3条边。\n", "locale": "zh-CN"}}}
{"pid": "P3249", "type": "P", "difficulty": 6, "samples": [["9 14 5\n0 0\n1 0\n2 0\n0 1\n1 1\n2 1\n0 2\n1 2\n2 2\n1 2\n2 3\n5 6\n7 8\n8 9\n1 4\n4 7\n5 8\n3 6\n6 9\n4 8\n1 5\n2 6\n6 8\n3 3 0 4 7 1 3 4 6 4 8 0 4 3 6 2 3 8 0 4 6 2 5 0 4 5 7 6 3", "1 1 \n1 2 \n1 1 \n9 10 \n3 4"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2016", "各省省选", "湖南", "枚举", "深度优先搜索 DFS", "生成树"], "title": "[HNOI2016] 矿区", "background": "", "description": "平面上的矿区划分成了若干个开发区域。\n\n简单地说，你可以将矿区看成一张连通的平面图，平面图划分为了若干平面块，每个平面块即为一个开发区域，平面块之间的边界必定由若干整点(坐标值为整数的点)和连接这些整点的线段组成。每个开发区域的矿量与该开发区域的面积有关：具体而言，面积为 $ s $ 的开发区域的矿量为 $ s^2 $。\n\n现在有 $ m $ 个开采计划。每个开采计划都指定了一个由若干开发区域组成的多边形，一个开采计划的优先度被规定为矿量的总和÷开发区域的面积和；例如，若某开采计划指定两个开发区域，面积分别为 $ a $ 和 $ b $，则优先度为 $ (a^2+b^2)/(a+b) $。由于平面图是按照划分开发区域边界的点和边给出的，因此每个开采计划也只说明了其指定多边形的边界，并未详细指明是哪些开发区域（但很明显，只要给出了多边形的边界就可以求出是些开发区域）。\n\n你的任务是求出每个开采计划的优先度。为了避免精度问题，你的答案必须按照分数的格式输出，即求出分子和分母，且必须是最简形式（分子和分母都为整数，而且都消除了最大公约数；例如，若矿量总和是 $ 1.5 $，面积和是 $ 2 $，那么分子应为 $ 3 $，分母应为 $ 4 $；又如，若矿量和是 $ 2 $，面积和是 $ 4 $，那么分子应为 \n $ 1 $，分母应为 $ 2 $）。\n\n由于某些原因，你必须依次对每个开采计划求解（即下一个开采计划会按一定格式加密，加密的方式与上一个开采计划的答案有关）。具体的加密方式见输入格式。", "inputFormat": "第一行三个正整数 $ n, m, k $，分别描述平面图中的点和边，以及开采计划的个数。  \n\n接下来 $ n $ 行，第 $ i $ 行 ( $ i = 1, 2, \\cdots , n $)有两个整数 $x_i, y_i$,  表示点 $ i $ 的坐标为 $(x_i, y_i)$。  \n\n接下来 $ m $ 行，第 $ i $ 行有两个正整数 $a, b$，表示点 $ a $ 和 $ b $ 之间有一条边。  \n\n接下来一行若干个整数，依次描述每个开采计划。每个开采计划的第一个数 $ c $ 指出该开采计划由开发区域组成的多边形边界上的点的个数为 $ d=(c+P) \\bmod n \\mathrel{+} 1 $；接下来 $ d $ 个整数，按逆时针方向描述边界上的每一个点：设其中第 $ i $ 个数为 $ z_i $，则第 $ i $ 个点的编号为 $(z_i+P)\\bmod n \\mathrel{+} 1$。其中 $ P $ 是上一个开采计划的答案中分子的值；对于第 $ 1 $ 个开采计划，$ P = 0 $。", "outputFormat": "对于每个开采计划，输出一行两个正整数，分别描述分子和分母。\n", "hint": "### 样例解释\n\n输入文件给出的 $9$ 个点和 $14$ 条边描述的平面图如下所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cg70enmo.png)\n\n第一个开采计划，输入的第 $1$ 个值为 $3$，所以该开采计划对应的多边形有 $(3+0)\\bmod 8+1=4$ 个点，将接下的 $4$ 个数 $3,0,4,7$，分别代入 $(z_i+0)\\bmod n+1$ 得到 $4$ 个点的编号为 $4,1,5,8$。计算出第一个开采计划的分子为 $1$，分母为 $1$。\n\n类似地，可计算出余下开采计划的多边形的点数和点的编号：第二个开采计划对应的多边形有 $3$ 个点，编号分别为 $5,6,8$。第三个开采计划对应的多边形有 $6$ 个点，编号分别为 $1,2,6,5,8,4$。第四个开采计划对应的多边形有 $5$ 个点，编号分别为 $1,2,6,8,4$。第五个开采计划对应的多边形有 $6$ 个点，编号分别为 $1,5,6,8,7,4$。\n\n### 数据范围及约定\n\n\n对于 $ 100 \\% $ 的数据，$ n, k \\leq 2 \\times 10^5, \\  m \\leq 3n-6, \\  |x_i|, |y_i| \\leq 3×10^4$。\n\n所有开采计划的 $ d $ 之和不超过 $2 \\times 10^6$。保证任何开采计划都包含至少一个开发区域，且这些开发区域构成一个连通块。\n\n保证所有开发区域的矿量和不超过 $ 2^{63}-1 $。\n\n保证平面图中没有多余的点和边。\n\n保证数据合法。由于输入数据量较大，建议使用读入优化。\n\n\n~~2025-06-03: 增加了一组 hack 数据~~这组 hack 数据有数据越界，于 2025.10.10 移除并且更新替换。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2016] Mining Area", "background": "", "description": "The mining area on the plane is divided into several development regions.\n\nSimply put, you can regard the mining area as a connected planar graph. The plane is partitioned into several faces, and each face is a development region. The boundaries between faces consist of integer points (points whose coordinates are integers) and line segments connecting these integer points. The mineral amount of each development region depends on its area: specifically, for a development region with area $ s $, its mineral amount is $ s^2 $.\n\nThere are $ m $ mining plans. Each plan specifies a polygon consisting of several development regions. The priority of a plan is defined as the total mineral amount divided by the total area of the selected regions. For example, if a plan specifies two regions of areas $ a $ and $ b $, then its priority is $ (a^2 + b^2)/(a + b) $. Since the planar graph is given by the points and edges that define the boundaries of development regions, each plan only specifies the boundary of its polygon, without explicitly listing which regions are included. However, once the polygon boundary is given, the included development regions are uniquely determined.\n\nYour task is to compute the priority for each mining plan. To avoid precision issues, your answer must be output as a fraction in irreducible form, i.e., output the numerator and denominator as integers with their greatest common divisor removed. For example, if the total mineral amount is $ 1.5 $ and the total area is $ 2 $, then the numerator should be $ 3 $ and the denominator should be $ 4 $. As another example, if the total mineral amount is $ 2 $ and the total area is $ 4 $, then the numerator should be $ 1 $ and the denominator should be $ 2 $.\n\nFor certain reasons, you must process each mining plan sequentially (the next plan is encoded based on the previous plan’s answer). The specific encoding is given in the input format.", "inputFormat": "The first line contains three positive integers $ n, m, k $, representing the number of vertices in the planar graph, the number of edges, and the number of mining plans, respectively.\n\nThe next $ n $ lines. In the $ i $-th line ($ i = 1, 2, \\cdots, n $), there are two integers $ x_i, y_i $, indicating that vertex $ i $ has coordinates $ (x_i, y_i) $.\n\nThe next $ m $ lines. In the $ i $-th line, there are two positive integers $ a, b $, indicating that there is an edge between vertices $ a $ and $ b $.\n\nThe next line contains several integers describing all mining plans in order. For each plan, the first number $ c $ determines the number of boundary vertices of the polygon formed by development regions as $ d = (c + P) \\bmod n \\mathrel{+} 1 $. Then $ d $ integers follow, giving the boundary vertices in counterclockwise order: let the $ i $-th number be $ z_i $, then the index of the $ i $-th vertex is $ (z_i + P) \\bmod n \\mathrel{+} 1 $. Here $ P $ is the numerator of the answer for the previous mining plan; for the first plan, $ P = 0 $.", "outputFormat": "For each mining plan, output one line with two positive integers, the numerator and the denominator, respectively.", "hint": "### Sample Explanation\n\nThe planar graph described by $ 9 $ points and $ 14 $ edges in the input is shown below:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cg70enmo.png)\n\nFor the first mining plan, the first value in the input is $ 3 $, so the polygon of this plan has $ (3 + 0) \\bmod 8 + 1 = 4 $ vertices. Substituting the next four numbers $ 3, 0, 4, 7 $ into $ (z_i + 0) \\bmod n + 1 $, the indices of the four vertices are $ 4, 1, 5, 8 $. The numerator of the first plan is $ 1 $, and the denominator is $ 1 $.\n\nSimilarly, the remaining polygons’ vertex counts and indices are: for the second plan, it has $ 3 $ vertices with indices $ 5, 6, 8 $. For the third plan, it has $ 6 $ vertices with indices $ 1, 2, 6, 5, 8, 4 $. For the fourth plan, it has $ 5 $ vertices with indices $ 1, 2, 6, 8, 4 $. For the fifth plan, it has $ 6 $ vertices with indices $ 1, 5, 6, 8, 7, 4 $.\n\n### Constraints\n\nFor $ 100\\% $ of the testdata, $ n, k \\leq 2 \\times 10^5 $, $ m \\leq 3n - 6 $, and $ |x_i|, |y_i| \\leq 3 \\times 10^4 $.\n\nThe sum of $ d $ over all mining plans does not exceed $ 2 \\times 10^6 $. It is guaranteed that each mining plan contains at least one development region, and these regions form a connected component.\n\nIt is guaranteed that the total mineral amount over all development regions does not exceed $ 2^{63} - 1 $.\n\nIt is guaranteed that there are no redundant vertices or edges in the planar graph.\n\nThe input is guaranteed to be valid. Because the input size is large, fast I/O is recommended.\n\n~~2025-06-03: Added a set of hack testdata~~ This set of hack testdata had out-of-bounds values. It was removed and replaced on 2025.10.10.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2016] 矿区", "background": "", "description": "平面上的矿区划分成了若干个开发区域。\n\n简单地说，你可以将矿区看成一张连通的平面图，平面图划分为了若干平面块，每个平面块即为一个开发区域，平面块之间的边界必定由若干整点(坐标值为整数的点)和连接这些整点的线段组成。每个开发区域的矿量与该开发区域的面积有关：具体而言，面积为 $ s $ 的开发区域的矿量为 $ s^2 $。\n\n现在有 $ m $ 个开采计划。每个开采计划都指定了一个由若干开发区域组成的多边形，一个开采计划的优先度被规定为矿量的总和÷开发区域的面积和；例如，若某开采计划指定两个开发区域，面积分别为 $ a $ 和 $ b $，则优先度为 $ (a^2+b^2)/(a+b) $。由于平面图是按照划分开发区域边界的点和边给出的，因此每个开采计划也只说明了其指定多边形的边界，并未详细指明是哪些开发区域（但很明显，只要给出了多边形的边界就可以求出是些开发区域）。\n\n你的任务是求出每个开采计划的优先度。为了避免精度问题，你的答案必须按照分数的格式输出，即求出分子和分母，且必须是最简形式（分子和分母都为整数，而且都消除了最大公约数；例如，若矿量总和是 $ 1.5 $，面积和是 $ 2 $，那么分子应为 $ 3 $，分母应为 $ 4 $；又如，若矿量和是 $ 2 $，面积和是 $ 4 $，那么分子应为 \n $ 1 $，分母应为 $ 2 $）。\n\n由于某些原因，你必须依次对每个开采计划求解（即下一个开采计划会按一定格式加密，加密的方式与上一个开采计划的答案有关）。具体的加密方式见输入格式。", "inputFormat": "第一行三个正整数 $ n, m, k $，分别描述平面图中的点和边，以及开采计划的个数。  \n\n接下来 $ n $ 行，第 $ i $ 行 ( $ i = 1, 2, \\cdots , n $)有两个整数 $x_i, y_i$,  表示点 $ i $ 的坐标为 $(x_i, y_i)$。  \n\n接下来 $ m $ 行，第 $ i $ 行有两个正整数 $a, b$，表示点 $ a $ 和 $ b $ 之间有一条边。  \n\n接下来一行若干个整数，依次描述每个开采计划。每个开采计划的第一个数 $ c $ 指出该开采计划由开发区域组成的多边形边界上的点的个数为 $ d=(c+P) \\bmod n \\mathrel{+} 1 $；接下来 $ d $ 个整数，按逆时针方向描述边界上的每一个点：设其中第 $ i $ 个数为 $ z_i $，则第 $ i $ 个点的编号为 $(z_i+P)\\bmod n \\mathrel{+} 1$。其中 $ P $ 是上一个开采计划的答案中分子的值；对于第 $ 1 $ 个开采计划，$ P = 0 $。", "outputFormat": "对于每个开采计划，输出一行两个正整数，分别描述分子和分母。\n", "hint": "### 样例解释\n\n输入文件给出的 $9$ 个点和 $14$ 条边描述的平面图如下所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cg70enmo.png)\n\n第一个开采计划，输入的第 $1$ 个值为 $3$，所以该开采计划对应的多边形有 $(3+0)\\bmod 8+1=4$ 个点，将接下的 $4$ 个数 $3,0,4,7$，分别代入 $(z_i+0)\\bmod n+1$ 得到 $4$ 个点的编号为 $4,1,5,8$。计算出第一个开采计划的分子为 $1$，分母为 $1$。\n\n类似地，可计算出余下开采计划的多边形的点数和点的编号：第二个开采计划对应的多边形有 $3$ 个点，编号分别为 $5,6,8$。第三个开采计划对应的多边形有 $6$ 个点，编号分别为 $1,2,6,5,8,4$。第四个开采计划对应的多边形有 $5$ 个点，编号分别为 $1,2,6,8,4$。第五个开采计划对应的多边形有 $6$ 个点，编号分别为 $1,5,6,8,7,4$。\n\n### 数据范围及约定\n\n\n对于 $ 100 \\% $ 的数据，$ n, k \\leq 2 \\times 10^5, \\  m \\leq 3n-6, \\  |x_i|, |y_i| \\leq 3×10^4$。\n\n所有开采计划的 $ d $ 之和不超过 $2 \\times 10^6$。保证任何开采计划都包含至少一个开发区域，且这些开发区域构成一个连通块。\n\n保证所有开发区域的矿量和不超过 $ 2^{63}-1 $。\n\n保证平面图中没有多余的点和边。\n\n保证数据合法。由于输入数据量较大，建议使用读入优化。\n\n\n~~2025-06-03: 增加了一组 hack 数据~~这组 hack 数据有数据越界，于 2025.10.10 移除并且更新替换。", "locale": "zh-CN"}}}
{"pid": "P3250", "type": "P", "difficulty": 6, "samples": [["13 23\n1 2\n1 3\n2 4\n2 5\n3 6\n3 7\n4 8\n4 9\n6 10\n6 11\n7 12\n7 13\n2 1\n0 8 13 3\n0 9 12 5\n2 9\n2 8\n2 2\n0 10 12 1\n2 2\n1 3\n2 7\n2 1\n0 9 5 6\n2 4\n2 5\n1 7\n0 9 12 4\n0 10 5 7\n2 1\n2 4\n2 12\n1 2\n2 5\n2 3", "-1 \n3 \n5 \n-1 \n1 \n-1 \n1 \n1 \n3 \n6 \n7 \n7 \n4 \n6"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2016", "线段树", "各省省选", "湖南", "最近公共祖先 LCA", "树链剖分", "整体二分"], "title": "[HNOI2016] 网络", "background": "", "description": "一个简单的网络系统可以被描述成一棵无根树。每个节点为一个服务器。连接服务器与服务器的数据线则看做一条树边。两个服务器进行数据的交互时，数据会经过连接这两个服务器的路径上的所有服务器（包括这两个服务器自身）。\n\n由于这条路径是唯一的，当路径上的某个服务器出现故障，无法正常运行时，数据便无法交互。此外，每个数据交互请求都有一个重要度，越重要的请求显然需要得到越高的优先处理权。现在，你作为一个网络系统的管理员，要监控整个系统的运行状态。系统的运行也是很简单的，在每一个时刻，只有可能出现下列三种事件中的一种：\n\n1. 在某两个服务器之间出现一条新的数据交互请求；  \n2. 某个数据交互结束请求；\n3. 某个服务器出现故障。系统会在任何故障发生后立即修复。也就是在出现故障的时刻之后，这个服务器依然是正常的。但在服务器产生故障时依然会对需要经过该服务器的数据交互请求造成影响。\n\n你的任务是在每次出现故障时，维护未被影响的请求中重要度的最大值。注意，如果一个数据交互请求已经结束，则不将其纳入未被影响的请求范围。\n", "inputFormat": "第一行两个正整数 $n,m$，分别描述服务器和事件个数。服务器编号是从 $1$ 开始的，因此 $n$ 个服务器的编号依次是 $1,2,3,\\cdots,n$。\n\n接下来 $n-1$ 行，每行两个正整数 $u,v$，描述一条树边。$u$ 和 $v$ 是服务器的编号。\n\n接下来 $m$ 行，按发生时刻依次描述每一个事件；即第 $i$ 行（$i=1,2,3,...,m$）描述时刻 $i$ 发生的事件。每行的第一个数 $\\mathrm{type}$ 描述事件类型，共 $3$ 种类型：\n\n1. 若 $\\mathrm{type}=0$，之后有三个正整数 $a,b,v$，表示服务器 $a,b$ 之间出现一条重要度为 $v$ 的数据交互请求；\n2. 若 $\\mathrm{type}=1$，之后有一个正整数 $t$，表示时刻 $t$（也就是第 $t$ 个发生的事件）出现的数据交互请求结束；\n3. 若 $\\mathrm{type}=2$，之后有一个正整数 $x$，表示服务器 $x$ 在这一时刻出现了故障。\n\n对于每个 $\\mathrm{type}$ 为 $2$ 的事件，就是一次询问，即询问“当服务器 $x$ 发生故障时，未被影响的请求中重要度的最大值是多少？”注意可能有某个服务器自身与自身进行数据交互的情况。$2 \\le n \\le 10^5$，$1 \\le m \\le 2\\times 10^5$，其他的所有输入值不超过 $10^9$。\n", "outputFormat": "对于每个 $\\mathrm{type}=2$ 的事件，即服务器出现故障的事件，输出一行一个整数，描述未被影响的请求中重要度的最大值。如果此时没有任何请求，或者所有请求均被影响，则输出 $-1$。\n", "hint": "样例给出的树如下所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ka4zpxia.png)\n\n解释其中的部分询问；下面的解释中用 $(a,b;t,v)$ 表示在 $t$ 时刻出现的服务器 $a$ 和 $b$ 之间的重要度为 $v$ 的请求：\n\n对于第一个询问（在时刻 $1$），此时没有任何请求，输出 $-1$。\n\n对于第四个询问（在时刻 $6$），此时有两条交互$(8,13;2,3),(9,12;3,5)$，所有询问均经过 $2$ 号服务器，输出 $-1$。\n\n对于第五个询问（在时刻 $8$），此时有三条交互 $(8,13;2,3),(9,12;3,5),(10,12;7,1)$，只有交互 $(10,12;7,1)$ 没有经过 $2$ 号服务器，因此输出其重要度 $1$。\n\n对于最后一个询问（在时刻 $23$），此时有三条交互 $(9,5;12,6),(9,12;16,4),(10,5;17,7)$。当 $3$ 号服务器出现故障时，只有交互 $(9,5;12,6)$ 没有经过 $3$ 号服务器，因此输出 $6$。\n\n$\\text{upd 2016.5.20}$：新加一组 $\\text{Hack}$ 数据。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2016] Network", "background": "", "description": "A simple network system can be described as an unrooted tree. Each node is a server. The data cable connecting servers is treated as a tree edge. When two servers exchange data, the data passes through all servers on the unique path connecting these two servers (including the two servers themselves).\n\nBecause this path is unique, if any server on the path fails and cannot operate normally, the data cannot be exchanged. In addition, each data exchange request has an importance value, and more important requests should clearly receive higher priority. Now, as the administrator of a network system, you need to monitor the system’s operating status. The system behavior is simple: at each time, exactly one of the following three events may occur:\n\n1. A new data exchange request appears between two servers.\n2. A data exchange request ends.\n3. A server fails. The system will repair it immediately after any failure. That is, right after the moment the failure occurs, this server is still normal. However, at the moment the failure occurs, it still affects data exchange requests that need to pass through this server.\n\nYour task is to maintain, for each failure, the maximum importance value among the requests that are not affected. Note that if a data exchange request has already ended, it is not considered among the unaffected requests.\n\nNote that a data exchange request may occur between a server and itself. $2 \\le n \\le 10^5$, $1 \\le m \\le 2\\times 10^5$, and all other input values do not exceed $10^9$.", "inputFormat": "The first line contains two positive integers $n,m$, denoting the numbers of servers and events, respectively. Server IDs start from $1$, so the $n$ servers are numbered $1,2,3,\\cdots,n$.\n\nThe next $n-1$ lines each contain two positive integers $u,v$, describing a tree edge. $u$ and $v$ are server IDs.\n\nThe next $m$ lines describe each event in chronological order; that is, the $i$-th line ($i=1,2,3,\\ldots,m$) describes the event that occurs at time $i$. The first number $\\mathrm{type}$ denotes the event type, with three types in total:\n\n1. If $\\mathrm{type}=0$, then three positive integers $a,b,v$ follow, meaning that a data exchange request with importance $v$ appears between servers $a$ and $b$.\n2. If $\\mathrm{type}=1$, then a positive integer $t$ follows, meaning that the data exchange request that appeared at time $t$ (i.e., the $t$-th event) ends.\n3. If $\\mathrm{type}=2$, then a positive integer $x$ follows, meaning that server $x$ fails at this moment.\n\nEach event with $\\mathrm{type}=2$ is a query, i.e., “When server $x$ fails, what is the maximum importance among the requests that are not affected?”", "outputFormat": "For each event with $\\mathrm{type}=2$ (i.e., a server failure), output one line with one integer, the maximum importance among the requests that are not affected. If there is currently no request, or all requests are affected, output $-1$.", "hint": "The tree given in the sample is shown below:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ka4zpxia.png)\n\nExplanations for some queries; in the explanations below, $(a,b;t,v)$ denotes a request that appears at time $t$ between servers $a$ and $b$ with importance $v$:\n\nFor the first query (at time $1$), there is no request, so output $-1$.\n\nFor the fourth query (at time $6$), there are two requests $(8,13;2,3)$ and $(9,12;3,5)$. Both paths pass through server $2$, so output $-1$.\n\nFor the fifth query (at time $8$), there are three requests $(8,13;2,3)$, $(9,12;3,5)$, and $(10,12;7,1)$. Only the request $(10,12;7,1)$ does not pass through server $2$, so output its importance $1$.\n\nFor the last query (at time $23$), there are three requests $(9,5;12,6)$, $(9,12;16,4)$, and $(10,5;17,7)$. When server $3$ fails, only the request $(9,5;12,6)$ does not pass through server $3$, so output $6$.\n\n$\\text{upd 2016.5.20}$：Added one set of $\\text{Hack}$ testdata.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2016] 网络", "background": "", "description": "一个简单的网络系统可以被描述成一棵无根树。每个节点为一个服务器。连接服务器与服务器的数据线则看做一条树边。两个服务器进行数据的交互时，数据会经过连接这两个服务器的路径上的所有服务器（包括这两个服务器自身）。\n\n由于这条路径是唯一的，当路径上的某个服务器出现故障，无法正常运行时，数据便无法交互。此外，每个数据交互请求都有一个重要度，越重要的请求显然需要得到越高的优先处理权。现在，你作为一个网络系统的管理员，要监控整个系统的运行状态。系统的运行也是很简单的，在每一个时刻，只有可能出现下列三种事件中的一种：\n\n1. 在某两个服务器之间出现一条新的数据交互请求；  \n2. 某个数据交互结束请求；\n3. 某个服务器出现故障。系统会在任何故障发生后立即修复。也就是在出现故障的时刻之后，这个服务器依然是正常的。但在服务器产生故障时依然会对需要经过该服务器的数据交互请求造成影响。\n\n你的任务是在每次出现故障时，维护未被影响的请求中重要度的最大值。注意，如果一个数据交互请求已经结束，则不将其纳入未被影响的请求范围。\n", "inputFormat": "第一行两个正整数 $n,m$，分别描述服务器和事件个数。服务器编号是从 $1$ 开始的，因此 $n$ 个服务器的编号依次是 $1,2,3,\\cdots,n$。\n\n接下来 $n-1$ 行，每行两个正整数 $u,v$，描述一条树边。$u$ 和 $v$ 是服务器的编号。\n\n接下来 $m$ 行，按发生时刻依次描述每一个事件；即第 $i$ 行（$i=1,2,3,...,m$）描述时刻 $i$ 发生的事件。每行的第一个数 $\\mathrm{type}$ 描述事件类型，共 $3$ 种类型：\n\n1. 若 $\\mathrm{type}=0$，之后有三个正整数 $a,b,v$，表示服务器 $a,b$ 之间出现一条重要度为 $v$ 的数据交互请求；\n2. 若 $\\mathrm{type}=1$，之后有一个正整数 $t$，表示时刻 $t$（也就是第 $t$ 个发生的事件）出现的数据交互请求结束；\n3. 若 $\\mathrm{type}=2$，之后有一个正整数 $x$，表示服务器 $x$ 在这一时刻出现了故障。\n\n对于每个 $\\mathrm{type}$ 为 $2$ 的事件，就是一次询问，即询问“当服务器 $x$ 发生故障时，未被影响的请求中重要度的最大值是多少？”注意可能有某个服务器自身与自身进行数据交互的情况。$2 \\le n \\le 10^5$，$1 \\le m \\le 2\\times 10^5$，其他的所有输入值不超过 $10^9$。\n", "outputFormat": "对于每个 $\\mathrm{type}=2$ 的事件，即服务器出现故障的事件，输出一行一个整数，描述未被影响的请求中重要度的最大值。如果此时没有任何请求，或者所有请求均被影响，则输出 $-1$。\n", "hint": "样例给出的树如下所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ka4zpxia.png)\n\n解释其中的部分询问；下面的解释中用 $(a,b;t,v)$ 表示在 $t$ 时刻出现的服务器 $a$ 和 $b$ 之间的重要度为 $v$ 的请求：\n\n对于第一个询问（在时刻 $1$），此时没有任何请求，输出 $-1$。\n\n对于第四个询问（在时刻 $6$），此时有两条交互$(8,13;2,3),(9,12;3,5)$，所有询问均经过 $2$ 号服务器，输出 $-1$。\n\n对于第五个询问（在时刻 $8$），此时有三条交互 $(8,13;2,3),(9,12;3,5),(10,12;7,1)$，只有交互 $(10,12;7,1)$ 没有经过 $2$ 号服务器，因此输出其重要度 $1$。\n\n对于最后一个询问（在时刻 $23$），此时有三条交互 $(9,5;12,6),(9,12;16,4),(10,5;17,7)$。当 $3$ 号服务器出现故障时，只有交互 $(9,5;12,6)$ 没有经过 $3$ 号服务器，因此输出 $6$。\n\n$\\text{upd 2016.5.20}$：新加一组 $\\text{Hack}$ 数据。", "locale": "zh-CN"}}}
{"pid": "P3251", "type": "P", "difficulty": 6, "samples": [["0.5 0 1\n1\n0.5 1 2\n1 2", "1.000\n2.000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "各省省选", "吉林"], "title": "[JLOI2012] 时间流逝", "background": null, "description": "生活可以很简单。可以探索水底世界的神秘，也可以去发现奇特新生物，亦或踏上一段新生的旅程。在必须要迎接挑战或跟周围的生物进行生存争夺之前，享受自由的飞翔。此时你会觉得生活是如此美好。\n\n像蛇喜欢吃浮游生物一样（哦，我好像忘记告诉你这个常识），每天，你可以吃一些你周围的基础生物，然后会在你的尾巴上得到一个能量圈。你将会有好多种不同的能量圈，每一个都会被赋予一个能量。你可以拥有多个同种的能量圈，但是对于新得到的相同的能量圈，它的能量不能大于你已拥有的任何一个能量圈。除了前面的规则，获得新的能量圈的种类的概率是一样的。一天天过去，你得到越来越多的能量，开始了进化演变。\n\n但是你也有自己的问题，有时你会面对邪恶的果冻鱼。它会追着你咬你，你不得不扔出最小能量值的能量圈然后赶忙逃跑。在这种情况下，你不会有任何的胃口了，因此这天你将不再得到任何能量圈。幸好，当你没有任何能量圈的时候，果冻鱼就算看见你也不会追着你，此时你可以好好地享用美食。\n\n你听说当你的总的能量值超过了某个阈值之后，可以进化成强大模式并能够吃掉果冻鱼。是时候反击了！下面是本题的问题：预计要过多少天你才能进化成强大模式？（第一天默认你没有任何能量圈）", "inputFormat": "输入包含多个测例。对每个测例会有两行。第一行是一个浮点数 $P$，一个整数 $T$ 和一个整数 $N$。$P$ 是每天遇到果冻鱼的概率，$T$ 是阈值。第二行是 $N$ 个不同的正整数，表示每一种能量圈的能量值。", "outputFormat": "对于每个测例，输出一行表示预计要过多少天你的能量值能够超过阈值，四舍五入到三位小数。", "hint": "对于所有数据，$0.1\\le P\\le0.9$，$1\\le T\\le50$，$1\\le N\\le50$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2012] The Passage of Time", "background": "", "description": "Life can be simple. You can explore the mysteries of the underwater world, discover strange new organisms, or embark on a fresh journey. Before you must face challenges or compete with nearby creatures for survival, enjoy the freedom of flight. At such moments, life feels wonderful.\n\nLike how snakes enjoy eating plankton (oh, I seem to have forgotten to tell you this common fact), each day you can eat some basic organisms around you and then gain an energy ring on your tail. You will have many different kinds of energy rings, each assigned an energy value. You can possess multiple rings of the same kind, but for a newly obtained ring of the same kind, its energy cannot be greater than that of any energy ring you already possess. Apart from the above rule, the probability of obtaining a new ring’s kind is uniform. Day by day, you accumulate more energy and begin to evolve.\n\nBut you have your own problems. Sometimes you face the evil jellyfish. It chases and bites you, so you must throw away the energy ring with the smallest energy value and then hurriedly escape. On such a day, you will have no appetite and thus will not gain any energy ring. Fortunately, when you have no energy rings, the jellyfish will not chase you even if it sees you, and you can then enjoy your meal.\n\nYou have heard that when your total energy exceeds a certain threshold, you can evolve into a powerful mode and even eat the jellyfish. It is time to fight back! Here is the question: how many days are expected to pass before you evolve into the powerful mode? (On the first day, you are assumed to have no energy rings.)", "inputFormat": "The input contains multiple test cases. Each test case consists of two lines.\n- The first line contains a floating-point number P, an integer T, and an integer N. P is the probability of encountering the jellyfish on a given day, and T is the threshold.\n- The second line contains N distinct positive integers, representing the energy value of each kind of energy ring.\n\nEach day proceeds independently. If you encounter the jellyfish and you currently have at least one ring, you discard the ring with the smallest energy and do not gain any ring that day. If you have no rings, the jellyfish will not chase you, and you proceed to gain one ring that day. When you gain a ring, its kind is chosen uniformly at random among the N kinds. You may obtain duplicates of the same kind.", "outputFormat": "For each test case, output one line with the expected number of days until your total energy strictly exceeds the threshold, rounded to three decimal places.", "hint": "Constraints: For all testdata, $0.1 \\le P \\le 0.9$, $1 \\le T \\le 50$, $1 \\le N \\le 50$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2012] 时间流逝", "background": null, "description": "生活可以很简单。可以探索水底世界的神秘，也可以去发现奇特新生物，亦或踏上一段新生的旅程。在必须要迎接挑战或跟周围的生物进行生存争夺之前，享受自由的飞翔。此时你会觉得生活是如此美好。\n\n像蛇喜欢吃浮游生物一样（哦，我好像忘记告诉你这个常识），每天，你可以吃一些你周围的基础生物，然后会在你的尾巴上得到一个能量圈。你将会有好多种不同的能量圈，每一个都会被赋予一个能量。你可以拥有多个同种的能量圈，但是对于新得到的相同的能量圈，它的能量不能大于你已拥有的任何一个能量圈。除了前面的规则，获得新的能量圈的种类的概率是一样的。一天天过去，你得到越来越多的能量，开始了进化演变。\n\n但是你也有自己的问题，有时你会面对邪恶的果冻鱼。它会追着你咬你，你不得不扔出最小能量值的能量圈然后赶忙逃跑。在这种情况下，你不会有任何的胃口了，因此这天你将不再得到任何能量圈。幸好，当你没有任何能量圈的时候，果冻鱼就算看见你也不会追着你，此时你可以好好地享用美食。\n\n你听说当你的总的能量值超过了某个阈值之后，可以进化成强大模式并能够吃掉果冻鱼。是时候反击了！下面是本题的问题：预计要过多少天你才能进化成强大模式？（第一天默认你没有任何能量圈）", "inputFormat": "输入包含多个测例。对每个测例会有两行。第一行是一个浮点数 $P$，一个整数 $T$ 和一个整数 $N$。$P$ 是每天遇到果冻鱼的概率，$T$ 是阈值。第二行是 $N$ 个不同的正整数，表示每一种能量圈的能量值。", "outputFormat": "对于每个测例，输出一行表示预计要过多少天你的能量值能够超过阈值，四舍五入到三位小数。", "hint": "对于所有数据，$0.1\\le P\\le0.9$，$1\\le T\\le50$，$1\\le N\\le50$。", "locale": "zh-CN"}}}
{"pid": "P3252", "type": "P", "difficulty": 3, "samples": [["3 3\n1 2 3\n1 2\n1 3", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "搜索", "2012", "各省省选", "吉林"], "title": "[JLOI2012] 树", "background": "", "description": "在这个问题中，给定一个值 $s$ 和一棵树。在树的每个节点有一个权值，第 $i$ 个点的权值为 $a_i$，问有多少条路径的节点权值总和为 $s$。路径中节点的深度必须是升序的。假设节点 $1$ 是根节点，根的深度是 $0$，它的儿子节点的深度为 $1$。路径不必一定从根节点开始。", "inputFormat": "第一行有两个整数 $n$ 和 $s$，其中 $n$ 是树的节点数。 \n\n第二行有 $n$ 个整数，第 $i$ 个整数 $a_i$ 表示节点 $i$ 的权值。\n\n接下来的 $(n-1)$ 行，每行有两个个整数 $x$ 和 $y$，表示 $y$ 是 $x$ 的儿子。", "outputFormat": "输出路径节点总和为 $s$ 的路径数量。\n", "hint": "#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 10^5$，$1 \\leq a_i, s \\leq 10^3$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2012] Tree", "background": "", "description": "In this problem, you are given a value $s$ and a tree. Each node has a weight; the $i$-th node has weight $a_i$. Count how many paths have a total sum of node weights equal to $s$. The depths of nodes along a path must be in strictly increasing order. Assume node $1$ is the root, its depth is $0$, and the depth of each of its children is $1$. A path does not have to start at the root.", "inputFormat": "The first line contains two integers $n$ and $s$, where $n$ is the number of nodes in the tree.\n\nThe second line contains $n$ integers; the $i$-th integer $a_i$ denotes the weight of node $i$.\n\nThe next $n - 1$ lines each contain two integers $x$ and $y$, indicating that $y$ is a child of $x$.", "outputFormat": "Output the number of paths whose total node weight equals $s$.", "hint": "Constraints\n\n- For $100\\%$ of the testdata, it holds that $1 \\leq n \\leq 10^5$, $1 \\leq a_i, s \\leq 10^3$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2012] 树", "background": "", "description": "在这个问题中，给定一个值 $s$ 和一棵树。在树的每个节点有一个权值，第 $i$ 个点的权值为 $a_i$，问有多少条路径的节点权值总和为 $s$。路径中节点的深度必须是升序的。假设节点 $1$ 是根节点，根的深度是 $0$，它的儿子节点的深度为 $1$。路径不必一定从根节点开始。", "inputFormat": "第一行有两个整数 $n$ 和 $s$，其中 $n$ 是树的节点数。 \n\n第二行有 $n$ 个整数，第 $i$ 个整数 $a_i$ 表示节点 $i$ 的权值。\n\n接下来的 $(n-1)$ 行，每行有两个个整数 $x$ 和 $y$，表示 $y$ 是 $x$ 的儿子。", "outputFormat": "输出路径节点总和为 $s$ 的路径数量。\n", "hint": "#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 10^5$，$1 \\leq a_i, s \\leq 10^3$。", "locale": "zh-CN"}}}
{"pid": "P3253", "type": "P", "difficulty": 5, "samples": [["3 3\n1\n4\n5\n2\n7\n3", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "2013", "各省省选", "树状数组", "吉林", "栈"], "title": "[JLOI2013] 删除物品", "background": "", "description": "箱子再分配问题需要解决如下问题：\n\n1. 一共有 $N$ 个物品，堆成 $M$ 堆。\n\n2. 所有物品都是一样的，但是它们有不同的优先级。\n\n3. 你只能够移动某堆中位于顶端的物品。\n\n4. 你可以把任意一堆中位于顶端的物品移动到其它某堆的顶端。若此物品是当前所有物品中优先级最高的，可以直接将之删除而不用移动。\n\n5. 求出将所有物品删除所需的最小步数。删除操作不计入步数之中。\n\n6. 这是一个比较难解决的问题，这里你只需要解决一个比较简单的版本：不会有两个物品有着相同的优先级，且 $M=2$。", "inputFormat": "第一行是包含两个整数 $N_1$, $N_2$ 分别表示两堆物品的个数。接下来有 $N_1$ 行整数按照从顶到底的顺序分别给出了第一堆物品中的优先级，数字越大，优先级越高。再接下来的 $N_2$ 行按照同样的格式给出了第二堆物品的优先级。", "outputFormat": "对于每个数据，请输出一个整数，即最小移动步数。", "hint": "$1\\leq N_1+N_2\\leq 100000$，优先级 $\\le 10^7$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2013] Deleting Items", "background": "", "description": "Consider the following box redistribution problem:\n\n1. There are $N$ items arranged into $M$ stacks.\n2. All items are identical, but they have different priorities.\n3. You may move only the top item of a stack.\n4. You may move the top item of any stack onto the top of another stack. If this item is currently the highest-priority among all items, you may delete it immediately instead of moving it.\n5. Find the minimum number of moves needed to delete all items. Deletions do not count toward the move count.\n6. This is a simplified version: no two items have the same priority, and $M = 2$.", "inputFormat": "The first line contains two integers $N_1$, $N_2$ denoting the numbers of items in the two stacks, respectively. Then $N_1$ lines follow, giving the priorities in the first stack from top to bottom; larger numbers indicate higher priority. Then $N_2$ lines follow in the same format for the second stack.", "outputFormat": "For the given testdata, output a single integer, the minimum number of moves.", "hint": "Constraints:\n$1 \\le N_1 + N_2 \\le 100000$, priorities $\\le 10^7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2013] 删除物品", "background": "", "description": "箱子再分配问题需要解决如下问题：\n\n1. 一共有 $N$ 个物品，堆成 $M$ 堆。\n\n2. 所有物品都是一样的，但是它们有不同的优先级。\n\n3. 你只能够移动某堆中位于顶端的物品。\n\n4. 你可以把任意一堆中位于顶端的物品移动到其它某堆的顶端。若此物品是当前所有物品中优先级最高的，可以直接将之删除而不用移动。\n\n5. 求出将所有物品删除所需的最小步数。删除操作不计入步数之中。\n\n6. 这是一个比较难解决的问题，这里你只需要解决一个比较简单的版本：不会有两个物品有着相同的优先级，且 $M=2$。", "inputFormat": "第一行是包含两个整数 $N_1$, $N_2$ 分别表示两堆物品的个数。接下来有 $N_1$ 行整数按照从顶到底的顺序分别给出了第一堆物品中的优先级，数字越大，优先级越高。再接下来的 $N_2$ 行按照同样的格式给出了第二堆物品的优先级。", "outputFormat": "对于每个数据，请输出一个整数，即最小移动步数。", "hint": "$1\\leq N_1+N_2\\leq 100000$，优先级 $\\le 10^7$。", "locale": "zh-CN"}}}
{"pid": "P3254", "type": "P", "difficulty": 5, "samples": [["4 5\n4 5 3 5\n3 5 2 6 4\n", "1\n1 2 4 5\n1 2 3 4 5\n2 4 5\n1 2 3 4 5\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["网络流", "Special Judge", "网络流与线性规划 24 题"], "title": "圆桌问题", "background": "", "description": "有来自 $m$ 个不同单位的代表参加一次国际会议。第 $i$ 个单位派出了 $r_i$ 个代表。\n\n会议的餐厅共有 $n$ 张餐桌，第 $i$ 张餐桌可容纳 $c_i$ 个代表就餐。\n\n为了使代表们充分交流，希望从同一个单位来的代表不在同一个餐桌就餐。请给出一个满足要求的代表就餐方案。", "inputFormat": "输入的第一行是用空格隔开的两个整数，分别代表单位的个数 $m$ 和餐桌的个数 $n$。  \n第二行有 $m$ 个用空格隔开的整数，第 $i$ 个整数代表第 $i$ 个单位的代表人数 $r_i$。  \n第三行有 $n$ 个用空格隔开的整数，第 $i$ 个整数代表第 $i$ 张餐桌能容纳的人数 $c_i$。", "outputFormat": "**本题存在 Special Judge**。  \n请输出是否存在满足要求的就餐方案，若存在，请给出任意一种可行的方案。  \n输出的第一行是一个非 $0$ 即 $1$ 的整数，若存在方案则输出 $1$，否则输出 $0$。  \n若存在方案，则对于第 $2$ 到第 $(m + 1)$ 行，在第 $(i + 1)$ 行输出 $r_i$ 个整数，代表第 $i$ 个单位的代表就餐的餐桌编号。", "hint": "**【数据规模与约定】**\n\n- 对于 $100\\%$ 的数据，保证 $1 \\leq m \\leq 150$，$1 \\leq n \\leq 270$，$1 \\leq r_i, c_i \\leq 10^3$。\n\n**【提示】**\n\n- 请注意输入的第一行先读入 $m$ 再读入 $n$。", "locale": "zh-CN", "translations": {"en": {"title": "Round Table Problem", "background": "", "description": "There are representatives from $m$ different units attending an international conference. The $i$-th unit sends $r_i$ representatives.\n\nThe conference restaurant has $n$ tables, and the $i$-th table can seat $c_i$ representatives.\n\nTo encourage communication, representatives from the same unit should not dine at the same table. Please provide a dining arrangement that satisfies this requirement.", "inputFormat": "The first line contains two integers separated by a space, representing the number of units $m$ and the number of tables $n$.\nThe second line contains $m$ integers separated by spaces, where the $i$-th integer represents the number of representatives $r_i$ in the $i$-th unit.\nThe third line contains $n$ integers separated by spaces, where the $i$-th integer represents the capacity $c_i$ of the $i$-th table.", "outputFormat": "This problem uses Special Judge.\nOutput whether a valid arrangement exists. If it exists, output any valid arrangement.\nThe first line contains a single integer, either $0$ or $1$. Output $1$ if a valid arrangement exists; otherwise, output $0$.\nIf it exists, then for lines $2$ to $(m + 1)$, on line $(i + 1)$ output $r_i$ integers, representing the table indices where the representatives of the $i$-th unit will dine.", "hint": "- Constraints:\n  - For $100\\%$ of the testdata, $1 \\leq m \\leq 150$, $1 \\leq n \\leq 270$, $1 \\leq r_i, c_i \\leq 10^3$.\n- Hint:\n  - Note that the first line of input reads $m$ first, then $n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "圆桌问题", "background": "", "description": "有来自 $m$ 个不同单位的代表参加一次国际会议。第 $i$ 个单位派出了 $r_i$ 个代表。\n\n会议的餐厅共有 $n$ 张餐桌，第 $i$ 张餐桌可容纳 $c_i$ 个代表就餐。\n\n为了使代表们充分交流，希望从同一个单位来的代表不在同一个餐桌就餐。请给出一个满足要求的代表就餐方案。", "inputFormat": "输入的第一行是用空格隔开的两个整数，分别代表单位的个数 $m$ 和餐桌的个数 $n$。  \n第二行有 $m$ 个用空格隔开的整数，第 $i$ 个整数代表第 $i$ 个单位的代表人数 $r_i$。  \n第三行有 $n$ 个用空格隔开的整数，第 $i$ 个整数代表第 $i$ 张餐桌能容纳的人数 $c_i$。", "outputFormat": "**本题存在 Special Judge**。  \n请输出是否存在满足要求的就餐方案，若存在，请给出任意一种可行的方案。  \n输出的第一行是一个非 $0$ 即 $1$ 的整数，若存在方案则输出 $1$，否则输出 $0$。  \n若存在方案，则对于第 $2$ 到第 $(m + 1)$ 行，在第 $(i + 1)$ 行输出 $r_i$ 个整数，代表第 $i$ 个单位的代表就餐的餐桌编号。", "hint": "**【数据规模与约定】**\n\n- 对于 $100\\%$ 的数据，保证 $1 \\leq m \\leq 150$，$1 \\leq n \\leq 270$，$1 \\leq r_i, c_i \\leq 10^3$。\n\n**【提示】**\n\n- 请注意输入的第一行先读入 $m$ 再读入 $n$。", "locale": "zh-CN"}}}
{"pid": "P3255", "type": "P", "difficulty": 6, "samples": [["2\n1 2\n2 2", "2 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "数学", "2013", "各省省选", "吉林", "组合数学"], "title": "[JLOI2013] 地形生成", "background": null, "description": "最近 IK 正在做关于地形建模的工作。其中一个工作阶段就是把一些山排列成一行。每座山都有各不相同的标号和高度。为了遵从一些设计上的要求，每座山都设置了一个关键数字，要求对于每座山，比它高且排列在它前面的其它山的数目必须少于它的关键数字。显然满足要求的排列会有很多个。\n\n对于每一个可能的排列，IK 生成一个对应的标号序列和等高线序列。标号序列就是按顺序写下每座山的标号。\n\n等高线序列就是按顺序写下它们的高度。例如有两座山，这两座山的一个合法排列的第一座山的标号和高度为 $1$ 和 $3$，而第二座山的标号和高度分别为 $2$ 和 $4$，那么这个排列的标号序列就是 $1$ $2$，而等高线序列就是 $3$ $4$.\n\n现在问题就是，给出所有山的信息，IK 希望知道一共有多少种不同的符合条件的标号序列和等高线序列。", "inputFormat": "输入第一行给出山的个数 $N$。接下来 $N$ 行每行有两个整数，按照标号从 $1$ 到 $N$ 的顺序分别给出一座山的高度和关键数。", "outputFormat": "输出两个用空格分隔开的数，第一个数是不同的标号序列的个数，第二个数是不同的等高线序列的个数。这两个答案都应该对 $2011$ 取模，即输出两个答案除以 $2011$ 取余数的结果", "hint": "对于所有的数据，有 $1\\leq N\\leq 1000$，所有的数字都是不大于 $10^9$ 的正整数。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2013] Terrain Generation", "background": "", "description": "Recently, IK has been working on terrain modeling. One stage of the work is to arrange several mountains in a line. Each mountain has a unique label and a height. To satisfy certain design requirements, each mountain is assigned a key number, requiring that for each mountain, the number of other mountains that are higher than it and placed before it must be less than its key number. Obviously, there can be many permutations that satisfy this requirement.\n\nFor every possible permutation, IK generates a corresponding label sequence and a height sequence. The label sequence is obtained by writing down the labels of the mountains in order.\n\nThe height sequence is obtained by writing down their heights in order. For example, if there are two mountains, and in one valid permutation the first mountain has label and height $1$ and $3$, and the second mountain has label and height $2$ and $4$, then the label sequence of this permutation is $1$ $2$, and the height sequence is $3$ $4$.\n\nNow, given all the information about the mountains, IK wants to know how many different valid label sequences and height sequences there are in total.", "inputFormat": "The first line contains the number of mountains $N$. The next $N$ lines each contain two integers. In the order of labels from $1$ to $N$, they give the height and the key number of each mountain.", "outputFormat": "Output two space-separated numbers. The first is the number of distinct label sequences, and the second is the number of distinct height sequences. Both answers should be taken modulo $2011$, that is, output the remainders of the two answers divided by $2011$.", "hint": "Constraints: For all testdata, $1 \\leq N \\leq 1000$, and all numbers are positive integers not exceeding $10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2013] 地形生成", "background": null, "description": "最近 IK 正在做关于地形建模的工作。其中一个工作阶段就是把一些山排列成一行。每座山都有各不相同的标号和高度。为了遵从一些设计上的要求，每座山都设置了一个关键数字，要求对于每座山，比它高且排列在它前面的其它山的数目必须少于它的关键数字。显然满足要求的排列会有很多个。\n\n对于每一个可能的排列，IK 生成一个对应的标号序列和等高线序列。标号序列就是按顺序写下每座山的标号。\n\n等高线序列就是按顺序写下它们的高度。例如有两座山，这两座山的一个合法排列的第一座山的标号和高度为 $1$ 和 $3$，而第二座山的标号和高度分别为 $2$ 和 $4$，那么这个排列的标号序列就是 $1$ $2$，而等高线序列就是 $3$ $4$.\n\n现在问题就是，给出所有山的信息，IK 希望知道一共有多少种不同的符合条件的标号序列和等高线序列。", "inputFormat": "输入第一行给出山的个数 $N$。接下来 $N$ 行每行有两个整数，按照标号从 $1$ 到 $N$ 的顺序分别给出一座山的高度和关键数。", "outputFormat": "输出两个用空格分隔开的数，第一个数是不同的标号序列的个数，第二个数是不同的等高线序列的个数。这两个答案都应该对 $2011$ 取模，即输出两个答案除以 $2011$ 取余数的结果", "hint": "对于所有的数据，有 $1\\leq N\\leq 1000$，所有的数字都是不大于 $10^9$ 的正整数。", "locale": "zh-CN"}}}
{"pid": "P3256", "type": "P", "difficulty": 6, "samples": [["4\n1 1 0 0\n15 16 10 20", "3\n1 2 4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "各省省选", "吉林", "枚举", "栈", "半平面交"], "title": "[JLOI2013] 赛车", "background": null, "description": "这里有一场赛车比赛正在进行，赛场上一共有 $n$ 辆车，分别称为 $g_1,g_2,...,g_n$。赛道是一条无限长的直线。最初，$g_i$ 处于起跑线前 $k_i$ 个单位的位置。比赛开始后，车辆 $g_i$ 将会以 $v_i$ 单位每秒的恒定速度行驶。在这个比赛过程中，如果一辆赛车曾经处于领跑位置（即没有其他的赛车跑在它的前面），这辆赛车最后就可以得奖，而且比赛过程中不用担心相撞的问题。现在给出所有赛车的起始位置和速度，你的任务就是算出哪些赛车将会得奖。", "inputFormat": "第一行有一个正整数 $n$，表示赛车的个数。\n\n接下来一行，包含 $n$ 个整数，按顺序给出 $n$ 辆赛车的起始位置。再接下来一行给出 $n$ 个整数，按顺序给出 $n$ 辆赛车的恒定速度。", "outputFormat": "输出包括两行，第一行为获奖的赛车个数。第二行按从小到大的顺序输出获奖赛车的编号，编号之间用空格隔开，注意最后一个编号后面不要加空格。", "hint": "#### 数据范围与约定\n\n- 对于 $100\\%$ 的数据，$1 \\le n \\le 10^4$，$0 \\le k_i \\le 10^9$，$0 \\le v_i \\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2013] Racing Cars", "background": "", "description": "There is a car race underway. There are $n$ cars on the track, named $g_1,g_2,...,g_n$. The track is an infinitely long straight line. Initially, $g_i$ is located $k_i$ units before the starting line. After the race starts, car $g_i$ travels at a constant speed of $v_i$ units per second. During the race, if a car has ever been in the lead (i.e., no other car is ahead of it), that car will win in the end, and collisions are not a concern. Given all cars’ starting positions and speeds, determine which cars will win.", "inputFormat": "The first line contains a positive integer $n$, the number of cars.\nThe next line contains $n$ integers, giving the starting positions $k_i$ of the $n$ cars in order. The following line contains $n$ integers, giving the constant speeds $v_i$ of the $n$ cars in order.", "outputFormat": "Output two lines. The first line contains the number of winning cars. The second line contains the indices of the winning cars in increasing order, separated by spaces, with no trailing space.", "hint": "Constraints\n- For 100% of the testdata, $1 \\le n \\le 10^4$, $0 \\le k_i \\le 10^9$, $0 \\le v_i \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2013] 赛车", "background": null, "description": "这里有一场赛车比赛正在进行，赛场上一共有 $n$ 辆车，分别称为 $g_1,g_2,...,g_n$。赛道是一条无限长的直线。最初，$g_i$ 处于起跑线前 $k_i$ 个单位的位置。比赛开始后，车辆 $g_i$ 将会以 $v_i$ 单位每秒的恒定速度行驶。在这个比赛过程中，如果一辆赛车曾经处于领跑位置（即没有其他的赛车跑在它的前面），这辆赛车最后就可以得奖，而且比赛过程中不用担心相撞的问题。现在给出所有赛车的起始位置和速度，你的任务就是算出哪些赛车将会得奖。", "inputFormat": "第一行有一个正整数 $n$，表示赛车的个数。\n\n接下来一行，包含 $n$ 个整数，按顺序给出 $n$ 辆赛车的起始位置。再接下来一行给出 $n$ 个整数，按顺序给出 $n$ 辆赛车的恒定速度。", "outputFormat": "输出包括两行，第一行为获奖的赛车个数。第二行按从小到大的顺序输出获奖赛车的编号，编号之间用空格隔开，注意最后一个编号后面不要加空格。", "hint": "#### 数据范围与约定\n\n- 对于 $100\\%$ 的数据，$1 \\le n \\le 10^4$，$0 \\le k_i \\le 10^9$，$0 \\le v_i \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P3257", "type": "P", "difficulty": 6, "samples": [["7 4 6 10\n9 4 7 7 4 3 2\n18 8 9 4 15 12 4\n19 2 4 7 10 18 12\n8 1 13 14 16 0 14", "67 1 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "搜索", "2014", "各省省选", "吉林", "记忆化搜索"], "title": "[JLOI2014] 天天酷跑", "background": "", "description": "在游戏天天酷跑中，最爽的应该是超级奖励模式了吧，没有一切障碍，可以尽情的吃金币，现在请你控制游戏角色来获得尽可能多的分数。游戏界面离散为一个长度为 $1 \\sim n$，高度为 $1 \\sim m$（初始点为 $(0,1)$）的矩阵图。每个格子上都有收益 $(-1 \\sim 1000)$，$-1$ 表示该点不能通过。游戏角色从起点一路奔跑向终点，中途可以跳跃来获得更高的分数，在空中还能进行连跳。\n\n游戏开始前你可以设定跳跃的高度，以及能连跳的次数，初始跳跃高度为 $1$，连跳数为 $1$（最多为 $5$），升级跳跃高度和连跳都需要一定的花费。跳跃高度设定完后游戏角色每次跳跃高度都将固定，连跳必须在下落过程中可以使用。所有操作都将在整点上完成，需要保证设定完的跳跃高度及连跳数，无法跳出游戏高度上限。\n\n![](https://cdn.luogu.com.cn/upload/pic/17609.png) \n\n从 $(1,1)$ 点用一次跳跃，一次经过 $(2,2),(3,3),(4,2),(5,1)$。\n\n以下是连跳数为 $2$ 连跳，跳跃高度为 $2$ 的跳跃方案：\n\n![](https://cdn.luogu.com.cn/upload/pic/17610.png)\n\n从 $(1,1)$ 起跳，依次经过 $(2,2),(3,3),(4,2)$ 再使用连跳，经过 $(5,3),(6,4),(7,3),(8,2),(9,1)$。\n\n![](https://cdn.luogu.com.cn/upload/pic/17611.png)", "inputFormat": "第一行四个整数 $n,m,cost_1,cost_2$。$n,m$ 如题意所示，$cost_1,cost_2$ 分别表示每升一级跳跃高度，连跳数所需的花费。\n\n接下来 $m$ 行，每行 $n$ 个数。第 $i$ 行第 $j$ 个数表示地图中高度为 $i$，长度在第 $j$ 列处的收益。\n", "outputFormat": "如果无法跑出终点线，就输出 `mission failed`，否则输出一行三个数，分别表示最大收益；及最大收益时，最小的连跳数；最大收益，最小连跳数时，最小的跳跃高度。\n", "hint": "对于 $20 \\%$ 的数据，满足 $m=2$，$1 \\le n \\le 10 ^ 5$。\n\n对于另外 $80 \\%$ 的数据，$1 \\le n \\le 10000$，$2 < m \\le 20$，其中有 $20\\%$ 的数据保证 $2 < n \\le 10$，$1 \\le m \\le 10$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2014] Tiantian Cool Run", "background": "", "description": "In the game Tiantian Cool Run, the most exciting part is probably the Super Bonus mode, where there are no obstacles and you can freely collect coins. Now you are to control the character to obtain as high a score as possible. The game interface is discretized into a grid with length from $1$ to $n$ and height from $1$ to $m$ (the starting point is $(0,1)$). Every cell has a gain in the range $(-1 \\sim 1000)$, where $-1$ means the cell is impassable. The character runs from the start to the finish; along the way, they can jump to get a higher score, and can even perform consecutive jumps while in midair.\n\nBefore the game starts, you may set the jump height and the number of consecutive jumps. The initial jump height is $1$, and the initial number of consecutive jumps is $1$ (up to a maximum of $5$). Upgrading jump height and the number of consecutive jumps both require a certain cost. Once the jump height is set, every jump will use this fixed height. A consecutive jump can only be used while descending. All actions happen at integer time steps. You must ensure that with the set jump height and number of consecutive jumps, the character cannot jump above the top boundary of the game.\n\n![](https://cdn.luogu.com.cn/upload/pic/17609.png) \n\nFrom $(1,1)$, using one jump, the path passes through $(2,2),(3,3),(4,2),(5,1)$.\n\nBelow is a jumping plan with the number of consecutive jumps equal to $2$ and jump height equal to $2$:\n\n![](https://cdn.luogu.com.cn/upload/pic/17610.png)\n\nStarting to jump from $(1,1)$, the path goes through $(2,2),(3,3),(4,2)$, then uses a consecutive jump and passes through $(5,3),(6,4),(7,3),(8,2),(9,1)$.\n\n![](https://cdn.luogu.com.cn/upload/pic/17611.png)", "inputFormat": "The first line contains four integers $n,m,cost_1,cost_2$. Here $n,m$ are as described above, and $cost_1,cost_2$ respectively denote the cost to increase the jump height by $1$ level and the cost to increase the number of consecutive jumps by $1$.\n\nThen follow $m$ lines, each containing $n$ integers. The integer in the $i$-th row and $j$-th column gives the gain at height $i$ and length $j$ in the map.", "outputFormat": "If it is impossible to reach the finish line, output `mission failed`. Otherwise, output one line with three integers: the maximum gain; among all settings achieving the maximum gain, the minimum number of consecutive jumps; and among those, the minimum jump height.", "hint": "For $20\\%$ of the testdata, $m=2$ and $1 \\le n \\le 10^5$.\n\nFor the remaining $80\\%$ of the testdata, $1 \\le n \\le 10000$, $2 < m \\le 20$. Among them, for $20\\%$ of the testdata it is guaranteed that $2 < n \\le 10$, $1 \\le m \\le 10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2014] 天天酷跑", "background": "", "description": "在游戏天天酷跑中，最爽的应该是超级奖励模式了吧，没有一切障碍，可以尽情的吃金币，现在请你控制游戏角色来获得尽可能多的分数。游戏界面离散为一个长度为 $1 \\sim n$，高度为 $1 \\sim m$（初始点为 $(0,1)$）的矩阵图。每个格子上都有收益 $(-1 \\sim 1000)$，$-1$ 表示该点不能通过。游戏角色从起点一路奔跑向终点，中途可以跳跃来获得更高的分数，在空中还能进行连跳。\n\n游戏开始前你可以设定跳跃的高度，以及能连跳的次数，初始跳跃高度为 $1$，连跳数为 $1$（最多为 $5$），升级跳跃高度和连跳都需要一定的花费。跳跃高度设定完后游戏角色每次跳跃高度都将固定，连跳必须在下落过程中可以使用。所有操作都将在整点上完成，需要保证设定完的跳跃高度及连跳数，无法跳出游戏高度上限。\n\n![](https://cdn.luogu.com.cn/upload/pic/17609.png) \n\n从 $(1,1)$ 点用一次跳跃，一次经过 $(2,2),(3,3),(4,2),(5,1)$。\n\n以下是连跳数为 $2$ 连跳，跳跃高度为 $2$ 的跳跃方案：\n\n![](https://cdn.luogu.com.cn/upload/pic/17610.png)\n\n从 $(1,1)$ 起跳，依次经过 $(2,2),(3,3),(4,2)$ 再使用连跳，经过 $(5,3),(6,4),(7,3),(8,2),(9,1)$。\n\n![](https://cdn.luogu.com.cn/upload/pic/17611.png)", "inputFormat": "第一行四个整数 $n,m,cost_1,cost_2$。$n,m$ 如题意所示，$cost_1,cost_2$ 分别表示每升一级跳跃高度，连跳数所需的花费。\n\n接下来 $m$ 行，每行 $n$ 个数。第 $i$ 行第 $j$ 个数表示地图中高度为 $i$，长度在第 $j$ 列处的收益。\n", "outputFormat": "如果无法跑出终点线，就输出 `mission failed`，否则输出一行三个数，分别表示最大收益；及最大收益时，最小的连跳数；最大收益，最小连跳数时，最小的跳跃高度。\n", "hint": "对于 $20 \\%$ 的数据，满足 $m=2$，$1 \\le n \\le 10 ^ 5$。\n\n对于另外 $80 \\%$ 的数据，$1 \\le n \\le 10000$，$2 < m \\le 20$，其中有 $20\\%$ 的数据保证 $2 < n \\le 10$，$1 \\le m \\le 10$。", "locale": "zh-CN"}}}
{"pid": "P3258", "type": "P", "difficulty": 4, "samples": [["5\n1 4 5 3 2\n1 2\n2 4\n2 3\n4 5", "1\n2\n1\n2\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "线段树", "各省省选", "吉林", "最近公共祖先 LCA", "树链剖分", "差分"], "title": "[JLOI2014] 松鼠的新家", "background": null, "description": "松鼠的新家是一棵树，前几天刚刚装修了新家，新家有 $n$ 个房间，并且有 $n-1$ 根树枝连接，每个房间都可以相互到达，且俩个房间之间的路线都是唯一的。天哪，他居然真的住在“树”上。\n\n松鼠想邀请小熊维尼前来参观，并且还指定一份参观指南，他希望维尼能够按照他的指南顺序，先去 $a_1$，再去 $a_2$，……，最后到 $a_n$，去参观新家。可是这样会导致重复走很多房间，懒惰的维尼不停地推辞。可是松鼠告诉他，每走到一个房间，他就可以从房间拿一块糖果吃。\n\n维尼是个馋家伙，立马就答应了。现在松鼠希望知道为了保证维尼有糖果吃，他需要在每一个房间各放至少多少个糖果。\n\n因为松鼠参观指南上的最后一个房间 $a_n$ 是餐厅，餐厅里他准备了丰盛的大餐，所以当维尼在参观的最后到达餐厅时就不需要再拿糖果吃了。", "inputFormat": "第一行一个正整数 $n$，表示房间个数。第二行 $n$ 个正整数，依次描述 $a_1, a_2,\\cdots,a_n$。\n\n接下来 $n-1$ 行，每行两个正整数 $x,y$，表示标号 $x$ 和 $y$ 的两个房间之间有树枝相连。", "outputFormat": "一共 $n$ 行，第 $i$ 行输出标号为 $i$ 的房间至少需要放多少个糖果，才能让维尼有糖果吃。", "hint": "对于全部的数据，$2 \\le n \\le 3 \\times 10^5$，$1 \\le a_i \\le n$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2014] Squirrel’s New Home", "background": "", "description": "The squirrel’s new home is a tree. It was just renovated a few days ago. The new home has $n$ rooms and $n-1$ edges connecting them. Every pair of rooms is reachable, and the route between any two rooms is unique. Oh my, he really lives on a \"tree\".\n\nThe squirrel wants to invite Winnie the Pooh to visit and specifies a visiting itinerary. He hopes Winnie will visit in order: first $a_1$, then $a_2$, …, and finally $a_n$. However, this would cause revisiting many rooms, and the lazy Winnie keeps refusing. But the squirrel tells him that each time he arrives at a room, he can take one candy from that room.\n\nWinnie is a glutton, so he agrees at once. Now the squirrel wants to know, to ensure Winnie always has a candy to eat, how many candies at minimum he needs to place in each room.\n\nSince the last room $a_n$ in the itinerary is the dining room, where a feast has been prepared, when Winnie arrives at the dining room at the end of the tour, he does not need to take a candy there.", "inputFormat": "The first line contains a positive integer $n$, the number of rooms. The second line contains $n$ positive integers describing $a_1, a_2, \\cdots, a_n$ in order.\n\nThe next $n-1$ lines each contain two positive integers $x, y$, indicating that rooms labeled $x$ and $y$ are connected by an edge.", "outputFormat": "Output $n$ lines. On the $i$-th line, output the minimum number of candies that must be placed in the room labeled $i$ so that Winnie always has a candy to eat.", "hint": "For all testdata, $2 \\le n \\le 3 \\times 10^5$, $1 \\le a_i \\le n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2014] 松鼠的新家", "background": null, "description": "松鼠的新家是一棵树，前几天刚刚装修了新家，新家有 $n$ 个房间，并且有 $n-1$ 根树枝连接，每个房间都可以相互到达，且俩个房间之间的路线都是唯一的。天哪，他居然真的住在“树”上。\n\n松鼠想邀请小熊维尼前来参观，并且还指定一份参观指南，他希望维尼能够按照他的指南顺序，先去 $a_1$，再去 $a_2$，……，最后到 $a_n$，去参观新家。可是这样会导致重复走很多房间，懒惰的维尼不停地推辞。可是松鼠告诉他，每走到一个房间，他就可以从房间拿一块糖果吃。\n\n维尼是个馋家伙，立马就答应了。现在松鼠希望知道为了保证维尼有糖果吃，他需要在每一个房间各放至少多少个糖果。\n\n因为松鼠参观指南上的最后一个房间 $a_n$ 是餐厅，餐厅里他准备了丰盛的大餐，所以当维尼在参观的最后到达餐厅时就不需要再拿糖果吃了。", "inputFormat": "第一行一个正整数 $n$，表示房间个数。第二行 $n$ 个正整数，依次描述 $a_1, a_2,\\cdots,a_n$。\n\n接下来 $n-1$ 行，每行两个正整数 $x,y$，表示标号 $x$ 和 $y$ 的两个房间之间有树枝相连。", "outputFormat": "一共 $n$ 行，第 $i$ 行输出标号为 $i$ 的房间至少需要放多少个糖果，才能让维尼有糖果吃。", "hint": "对于全部的数据，$2 \\le n \\le 3 \\times 10^5$，$1 \\le a_i \\le n$。", "locale": "zh-CN"}}}
{"pid": "P3259", "type": "P", "difficulty": 6, "samples": [["5 8 1 100 10\nstart 0 0\nazhan 10 10\nxxgasxx 0 5\nbpoint 20 5\nend 0 100\nstart azhan sdf 30\nazhan xxgasxx ewfg 20\nstart end r3tg 200\nend azhan 1xq2 70\nazhan bpoint gg 10\nxxgasxx bpoint kk 30\nbpoint end dsg 40\nxxgasxx end t_s 100", "162.500"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2014", "各省省选", "吉林", "最短路"], "title": "[JLOI2014] 路径规划", "background": null, "description": "相信大家都用过地图上的路径规划功能，只要输入起点终点就能找出一条最优路线。现在告诉你一张地图的信息，请你找出最优路径（即最短路径）。考虑到实际情况，一辆车加满油能开的时间有限，**为 $limit$**，所以在地图上增加了几个加油站。\n\n地图由点和双向边构成，每个点代表一个路口，也有可能是加油站或起点终点。有些路口还装有红绿灯。由于经过太多的红绿灯会让人感到不爽，所以请求在经过不超过 $k$ 个红绿灯的情况下，最少平均花费多少时间能从起点到终点。保证起点终点和加油站没有红绿灯。（题目不考虑最坏情况下能否加到油，只考虑平均花费时间的前提下，车能否到达加油站加油）。\n\n\n注意：\n\n1. $limit$ 指的是车最多能走多长时间，可以看作车的油箱，是不能叠加的（比如不能连续经过多个加油站后剩余能走的时间 $>limit$）。\n2. 与上面类似，一个加油站最多只能加到 $limit$，不能累加。\n3. 不管在加油站加多少油，反正加一次耗费的时间都是 $cost$。\n4. 经过加油站可以不加油。", "inputFormat": "第一行输入 $5$ 个整数 $n,m,k,limit,cost$，表示有 $n$ 个点 $m$ 条边，车能开 $limit$ 长的时间，及加油所花时间 $cost$。\n\n接下来 $n$ 行输入每个点信息，包括点的名称（带 `gas` 的为加油站，`start` 为起点，`end` 为终点），及该点是否有红绿灯，用 $a,b$ 表示。（若为 $a=0$ 则表示没有，$a$ 表示红灯长，$b$ 表示绿灯长）。\n\n接下来 $m$ 行输入每条边信息，包括边的起点，终点，边的名称，通过该边所花时长。\n\n保证点和边名的长度不大于 $20$，只有大小写字母，数字及 `_` 组成。", "outputFormat": "一行输出最少平均花费时长，保留三位小数。", "hint": "共 $14$ 组数据。\n\n- 其中 $3$ 组数据，满足 $1 \\le n<10$，$1 \\le m<20$，$1 \\le k<5$。\n- 另有 $3$ 组没有红绿灯。\n\n所有数据满足 $1 \\le n \\le 10000$，$1 \\le m \\le 20000$，$1 \\le k \\le 10$，加油站 $\\le 50$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2014] Path Planning", "background": "# Description\n\nMost people have used the path planning feature on maps: as long as you enter the start and end, it can find an optimal route. Now you are given information about a map; please find the optimal path (i.e., the shortest path). Considering reality, a car with a full tank can run for a limited time, namely $limit$, so several gas stations are added on the map.\n\nThe map consists of vertices and bidirectional edges. Each vertex represents an intersection and may be a gas station or the start/end. Some intersections also have traffic lights. Since passing too many traffic lights is annoying, please find the minimal average time needed to travel from the start to the end while passing through no more than $k$ traffic lights. It is guaranteed that the start, the end, and gas stations have no traffic lights. (The problem does not consider whether refueling is possible in the worst case; it only considers whether, under average travel time, the car can reach a gas station to refuel.)\n\nNote:\n1. $limit$ is the maximum time the car can drive and can be viewed as the fuel tank; it cannot be accumulated (for example, after passing multiple gas stations in a row, the remaining drivable time cannot exceed $limit$).\n2. Similarly, a single refuel can only fill up to $limit$ and cannot be accumulated.\n3. No matter how much fuel is added at a gas station, the time cost for one refuel is always $cost$.\n4. Passing a gas station does not require refueling.", "description": "Most people have used the path planning feature on maps: as long as you enter the start and end, it can find an optimal route. Now you are given information about a map; please find the optimal path (i.e., the shortest path). Considering reality, a car with a full tank can run for a limited time, namely $limit$, so several gas stations are added on the map.\n\nThe map consists of vertices and bidirectional edges. Each vertex represents an intersection and may be a gas station or the start/end. Some intersections also have traffic lights. Since passing too many traffic lights is annoying, please find the minimal average time needed to travel from the start to the end while passing through no more than $k$ traffic lights. It is guaranteed that the start, the end, and gas stations have no traffic lights. (The problem does not consider whether refueling is possible in the worst case; it only considers whether, under average travel time, the car can reach a gas station to refuel.)\n\nNote:\n1. $limit$ is the maximum time the car can drive and can be viewed as the fuel tank; it cannot be accumulated (for example, after passing multiple gas stations in a row, the remaining drivable time cannot exceed $limit$).\n2. Similarly, a single refuel can only fill up to $limit$ and cannot be accumulated.\n3. No matter how much fuel is added at a gas station, the time cost for one refuel is always $cost$.\n4. Passing a gas station does not require refueling.\n\n# Description", "inputFormat": "The first line contains $5$ integers $n, m, k, limit, cost$, meaning there are $n$ vertices and $m$ edges, the car can run for time $limit$, and refueling costs time $cost$.\n\nThe next $n$ lines describe each vertex, including the vertex name (names containing `gas` are gas stations, `start` is the start, and `end` is the destination) and whether the vertex has a traffic light, represented by $a, b$. (If $a = 0$, it means there is no traffic light; otherwise, $a$ is the red duration and $b$ is the green duration.)\n\nThe next $m$ lines describe each edge, including the edge’s start, end, edge name, and the time to traverse this edge.\n\nThe lengths of vertex and edge names are no more than $20$ and consist only of letters, digits, and `_`.", "outputFormat": "Output one line: the minimal average time spent.", "hint": "There are $14$ sets of testdata.\n\n- Among them, $3$ sets satisfy $1 \\le n < 10$, $1 \\le m < 20$, $1 \\le k < 5$.\n- Another $3$ sets have no traffic lights.\n\nConstraints:\nFor all data, $1 \\le n \\le 10000$, $1 \\le m \\le 20000$, $1 \\le k \\le 10$, and the number of gas stations $\\le 50$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2014] 路径规划", "background": null, "description": "相信大家都用过地图上的路径规划功能，只要输入起点终点就能找出一条最优路线。现在告诉你一张地图的信息，请你找出最优路径（即最短路径）。考虑到实际情况，一辆车加满油能开的时间有限，**为 $limit$**，所以在地图上增加了几个加油站。\n\n地图由点和双向边构成，每个点代表一个路口，也有可能是加油站或起点终点。有些路口还装有红绿灯。由于经过太多的红绿灯会让人感到不爽，所以请求在经过不超过 $k$ 个红绿灯的情况下，最少平均花费多少时间能从起点到终点。保证起点终点和加油站没有红绿灯。（题目不考虑最坏情况下能否加到油，只考虑平均花费时间的前提下，车能否到达加油站加油）。\n\n\n注意：\n\n1. $limit$ 指的是车最多能走多长时间，可以看作车的油箱，是不能叠加的（比如不能连续经过多个加油站后剩余能走的时间 $>limit$）。\n2. 与上面类似，一个加油站最多只能加到 $limit$，不能累加。\n3. 不管在加油站加多少油，反正加一次耗费的时间都是 $cost$。\n4. 经过加油站可以不加油。", "inputFormat": "第一行输入 $5$ 个整数 $n,m,k,limit,cost$，表示有 $n$ 个点 $m$ 条边，车能开 $limit$ 长的时间，及加油所花时间 $cost$。\n\n接下来 $n$ 行输入每个点信息，包括点的名称（带 `gas` 的为加油站，`start` 为起点，`end` 为终点），及该点是否有红绿灯，用 $a,b$ 表示。（若为 $a=0$ 则表示没有，$a$ 表示红灯长，$b$ 表示绿灯长）。\n\n接下来 $m$ 行输入每条边信息，包括边的起点，终点，边的名称，通过该边所花时长。\n\n保证点和边名的长度不大于 $20$，只有大小写字母，数字及 `_` 组成。", "outputFormat": "一行输出最少平均花费时长，保留三位小数。", "hint": "共 $14$ 组数据。\n\n- 其中 $3$ 组数据，满足 $1 \\le n<10$，$1 \\le m<20$，$1 \\le k<5$。\n- 另有 $3$ 组没有红绿灯。\n\n所有数据满足 $1 \\le n \\le 10000$，$1 \\le m \\le 20000$，$1 \\le k \\le 10$，加油站 $\\le 50$。", "locale": "zh-CN"}}}
{"pid": "P3260", "type": "P", "difficulty": 7, "samples": [["1000 100\n6\n1 500 0 50\n2 10 10 20 100\n2 100 10 200 100\n2 300 10 400 100\n2 500 10 600 100\n2 700 0 800 100", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["计算几何", "2014", "各省省选", "吉林", "最小割"], "title": "[JLOI2014] 镜面通道", "background": "", "description": "在一个二维平面上，有一个镜面通道，由镜面 $AC, BD$ 组成，$AC, BD$ 长度相等，且都平行于 $x$ 轴，$B$ 位于 $(0,0)$。\n\n通道中有 $n$ 个外表面为镜面的光学元件，光学元件 $\\alpha$ 为圆形，光学元件 $\\beta$ 为矩形（这些元件可以与其他元件和通道有交集，具体看下图）。光线可以在 $AB$ 上任一点以任意角度射入通道，光线不会发生削弱。当出现元件与元件，元件和通道刚好接触的情况视为光线无法透过（比如两圆相切）。\n\n现在给出通道中所有元件的信息（$\\alpha$ 元件包括圆心坐标和半径 $x_i, y_i, r_i$，$\\beta$ 元件包括左下角和右上角坐标 $x_1, y_1, x_2, y_2$）\n\n![](https://cdn.luogu.com.cn/upload/pic/17612.png)\n\n如上图，$S$ 到 $T$ 便是一条合法线路。\n\n![](https://cdn.luogu.com.cn/upload/pic/17613.png)\n\n当然，显然存在光线无法透过的情况，现在交给你一个艰巨的任务，请求出至少拿走多少个光学元件后，存在一条光线线路可以从 $CD$ 射出。\n\n下面举例说明：\n\n![](https://cdn.luogu.com.cn/upload/pic/17614.png) \n\n现在假设，取走中间那个矩形，那么就可以构造出一条穿过通道的光路，如图中的 $S$ 到 $T$。\n", "inputFormat": "第一行包含两个整数，$x, y$，表示 $C$ 点坐标。\n\n第二行包含一个数字 $n$，表示有 $n$ 个光学元件。\n\n接下来 $n$ 行第一个数字如果是 $1$，表示元件 $\\alpha$，后面会有三个整数 $x_i, y_i, r_i$ 分别表示圆心坐标和半径。第一个数字如果是 $2$，表示元件 $\\beta$，后面会有四个整数 $x_1, y_1, x_2, y_2$ 分别表示左下角和右上角坐标。（矩形都平行，垂直于坐标轴）", "outputFormat": "输出包含一行，至少需要拿走的光学元件个数 $m$。\n", "hint": "$x\\leq 10^5$，$y\\leq 1000$，$n\\leq 300$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2014] Mirror Channel", "background": "", "description": "On a 2D plane, there is a mirror channel formed by mirrors $AC$ and $BD$. The lengths of $AC$ and $BD$ are equal, and both are parallel to the $x$-axis. $B$ is at (0, 0).\n\nInside the channel, there are $n$ optical elements whose outer surfaces are mirrors. Element $\\alpha$ is a circle, and element $\\beta$ is a rectangle (these elements may intersect with other elements and with the channel; see the figures). A light ray can enter the channel from any point on $AB$ at any angle, and the light ray does not attenuate. If an element just touches another element, or an element just touches the channel boundary, the light is considered unable to pass through at that contact (for example, two tangent circles).\n\nAll information about the elements in the channel is given ($\\alpha$ elements include the center coordinates and radius $x_i, y_i, r_i$; $\\beta$ elements include the lower-left and upper-right corner coordinates $x_1, y_1, x_2, y_2$).\n\nAs shown in the first figure, $S$ to $T$ is a valid path.\n\nOf course, there are cases where the light cannot pass through. Your task is to find the minimum number of optical elements that must be removed so that there exists a light path that can exit from $CD$.\n\nAn example is shown below: if the middle rectangle is removed, a light path passing through the channel can be constructed, as shown by $S$ to $T$.", "inputFormat": "- The first line contains two integers, $x, y$, denoting the coordinates of point $C$.\n- The second line contains an integer $n$, the number of optical elements.\n- Each of the next $n$ lines begins with a number. If it is $1$, it denotes an $\\alpha$ element, followed by three integers $x_i, y_i, r_i$ for the circle’s center and radius. If it is $2$, it denotes a $\\beta$ element, followed by four integers $x_1, y_1, x_2, y_2$ for the rectangle’s lower-left and upper-right corner coordinates (rectangles are axis-aligned).", "outputFormat": "Output one line containing a single integer $m$, the minimum number of optical elements that need to be removed.", "hint": "Constraints: $x \\leq 10^5$, $y \\leq 1000$, $n \\leq 300$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2014] 镜面通道", "background": "", "description": "在一个二维平面上，有一个镜面通道，由镜面 $AC, BD$ 组成，$AC, BD$ 长度相等，且都平行于 $x$ 轴，$B$ 位于 $(0,0)$。\n\n通道中有 $n$ 个外表面为镜面的光学元件，光学元件 $\\alpha$ 为圆形，光学元件 $\\beta$ 为矩形（这些元件可以与其他元件和通道有交集，具体看下图）。光线可以在 $AB$ 上任一点以任意角度射入通道，光线不会发生削弱。当出现元件与元件，元件和通道刚好接触的情况视为光线无法透过（比如两圆相切）。\n\n现在给出通道中所有元件的信息（$\\alpha$ 元件包括圆心坐标和半径 $x_i, y_i, r_i$，$\\beta$ 元件包括左下角和右上角坐标 $x_1, y_1, x_2, y_2$）\n\n![](https://cdn.luogu.com.cn/upload/pic/17612.png)\n\n如上图，$S$ 到 $T$ 便是一条合法线路。\n\n![](https://cdn.luogu.com.cn/upload/pic/17613.png)\n\n当然，显然存在光线无法透过的情况，现在交给你一个艰巨的任务，请求出至少拿走多少个光学元件后，存在一条光线线路可以从 $CD$ 射出。\n\n下面举例说明：\n\n![](https://cdn.luogu.com.cn/upload/pic/17614.png) \n\n现在假设，取走中间那个矩形，那么就可以构造出一条穿过通道的光路，如图中的 $S$ 到 $T$。\n", "inputFormat": "第一行包含两个整数，$x, y$，表示 $C$ 点坐标。\n\n第二行包含一个数字 $n$，表示有 $n$ 个光学元件。\n\n接下来 $n$ 行第一个数字如果是 $1$，表示元件 $\\alpha$，后面会有三个整数 $x_i, y_i, r_i$ 分别表示圆心坐标和半径。第一个数字如果是 $2$，表示元件 $\\beta$，后面会有四个整数 $x_1, y_1, x_2, y_2$ 分别表示左下角和右上角坐标。（矩形都平行，垂直于坐标轴）", "outputFormat": "输出包含一行，至少需要拿走的光学元件个数 $m$。\n", "hint": "$x\\leq 10^5$，$y\\leq 1000$，$n\\leq 300$。\n", "locale": "zh-CN"}}}
{"pid": "P3261", "type": "P", "difficulty": 6, "samples": [["5 5\n50 20 10 10 30\n1 1 2\n2 0 5\n2 0 -10\n1 0 10\n20 2\n10 3\n40 4\n20 4\n35 5", "2\n2\n0\n0\n0\n1\n1\n3\n1\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2015", "倍增", "各省省选", "吉林", "可并堆", "栈"], "title": "[JLOI2015] 城池攻占", "background": "", "description": "小铭铭最近获得了一副新的桌游，游戏中需要用 $m$ 个骑士攻占 $n$ 个城池。\n\n这 $n$ 个城池用 $1$ 到 $n$ 的整数表示。除 $1$ 号城池外，城池 $i$ 会受到另一座城池 $f_i$ 的管辖，其中 $f_i<i$。也就是说，所有城池构成了一棵有根树。 \n\n这 $m$ 个骑士用 $1$ 到 $m$ 的整数表示，其中第 $i$ 个骑士的初始战斗力为 $s_i$，第一个攻击的城池为 $c_i$。\n\n每个城池有一个防御值 $h_i$，如果一个骑士的战斗力大于等于城池的生命值，那么骑士就可以占领这座城池；否则占领失败，骑士将在这座城池牺牲。占领一个城池以后，骑士的战斗力将发生变化，然后继续攻击管辖这座城池的城池，直到占领 $1$ 号城池，或牺牲为止。\n\n除 $1$ 号城池外，每个城池 $i$ 会给出一个战斗力变化参数 $(a_i,v_i)$。若 $a_i=0$，攻占城池 $i$ 以后骑士战斗力会增加 $v_i$；若 $a_i=1$，攻占城池 $i$ 以后，战斗力会乘以 $v_i$。\n\n注意每个骑士是单独计算的。也就是说一个骑士攻击一座城池，不管结果如何，均不会影响其他骑士攻击这座城池的结果。\n\n现在的问题是，对于每个城池，输出有多少个骑士在这里牺牲；对于每个骑士，输出他攻占的城池数量。", "inputFormat": "第 $1$ 行包含两个正整数 $n,m$，表示城池的数量和骑士的数量。\n\n第 $2$ 行包含 $n$ 个整数，其中第 $i$ 个数为 $h_i$，表示城池 $i$ 的防御值。\n\n第 $3\\sim n+1$ 行，每行包含三个整数。其中第 $i+1$ 行的三个数为 $f_i,a_i,v_i$，分别表示管辖这座城池的城池编号和两个战斗力变化参数。\n\n第 $n+2\\sim n+m+1$ 行，每行包含两个整数。其中第 $n+i$ 行的两个数为 $s_i,c_i$，分别表示初始战斗力和第一个攻击的城池。\n", "outputFormat": "输出 $n+m$ 行，每行包含一个非负整数。其中前 $n$ 行分别表示在城池 $1$ 到 $n$ 牺牲的骑士数量，后 $m$ 行分别表示骑士 $1$ 到 $m$ 攻占的城池数量。", "hint": "对于 $100\\%$ 的数据，$1\\le n,m\\le 3\\times 10^5$，$\n-10^{18}\\le h_i,v_i,s_i\\le 10^{18}$，$1\\le f_i<i,1\\le c_i\\le n,a_i\\in\\{0,1\\}$，保证 $a_i=1$ 时，$v_i>0$，保证任何时候骑士战斗力值的绝对值不超过 $10^{18}$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2015] City Conquest", "background": "", "description": "Xiao Mingming recently got a new board game. In the game, you need to use $m$ knights to conquer $n$ cities.\n\nThe $n$ cities are numbered from $1$ to $n$. Except for city $1$, each city $i$ is governed by another city $f_i$ with $f_i<i$. In other words, all cities form a rooted tree.\n\nThe $m$ knights are numbered from $1$ to $m$, where knight $i$ has initial combat power $s_i$, and his first target city is $c_i$.\n\nEach city has a defense value $h_i$. If a knight's combat power is greater than or equal to the city's defense value, then the knight can capture that city; otherwise, the capture fails and the knight will fall at that city. After capturing a city, the knight's combat power will change, and then he continues to attack the city that governs this city (its parent), until he captures city $1$, or dies.\n\nExcept for city $1$, each city $i$ provides a combat-power change parameter $(a_i, v_i)$. If $a_i=0$, after capturing city $i$, the knight's combat power increases by $v_i$; if $a_i=1$, after capturing city $i$, the combat power is multiplied by $v_i$.\n\nNote that each knight is simulated independently. That is, when a knight attacks a city, regardless of the outcome, it does not affect the result of other knights attacking this city.\n\nNow the problem is: for each city, output how many knights die here; and for each knight, output how many cities he captures.", "inputFormat": "The first line contains two positive integers $n,m$, the numbers of cities and knights.\n\nThe second line contains $n$ integers, where the $i$-th number is $h_i$, the defense value of city $i$.\n\nLines $3$ to $n+1$: for each city $i$ from $2$ to $n$, line $i+1$ contains three integers $f_i,a_i,v_i$, denoting the governing (parent) city of city $i$ and the two combat-power change parameters.\n\nLines $n+2$ to $n+m+1$: for each knight $i$ from $1$ to $m$, line $n+1+i$ contains two integers $s_i,c_i$, the initial combat power and the first city to attack.", "outputFormat": "Output $n+m$ lines, each containing a nonnegative integer. The first $n$ lines give, for cities $1$ to $n$, the number of knights who die there; the last $m$ lines give, for knights $1$ to $m$, the number of cities they capture.", "hint": "For $100\\%$ of the testdata, $1\\le n,m\\le 3\\times 10^5$, $-10^{18}\\le h_i,v_i,s_i\\le 10^{18}$, $1\\le f_i<i$, $1\\le c_i\\le n$, $a_i\\in\\{0,1\\}$. It is guaranteed that when $a_i=1$, $v_i>0$, and that at any time the absolute value of a knight's combat power does not exceed $10^{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2015] 城池攻占", "background": "", "description": "小铭铭最近获得了一副新的桌游，游戏中需要用 $m$ 个骑士攻占 $n$ 个城池。\n\n这 $n$ 个城池用 $1$ 到 $n$ 的整数表示。除 $1$ 号城池外，城池 $i$ 会受到另一座城池 $f_i$ 的管辖，其中 $f_i<i$。也就是说，所有城池构成了一棵有根树。 \n\n这 $m$ 个骑士用 $1$ 到 $m$ 的整数表示，其中第 $i$ 个骑士的初始战斗力为 $s_i$，第一个攻击的城池为 $c_i$。\n\n每个城池有一个防御值 $h_i$，如果一个骑士的战斗力大于等于城池的生命值，那么骑士就可以占领这座城池；否则占领失败，骑士将在这座城池牺牲。占领一个城池以后，骑士的战斗力将发生变化，然后继续攻击管辖这座城池的城池，直到占领 $1$ 号城池，或牺牲为止。\n\n除 $1$ 号城池外，每个城池 $i$ 会给出一个战斗力变化参数 $(a_i,v_i)$。若 $a_i=0$，攻占城池 $i$ 以后骑士战斗力会增加 $v_i$；若 $a_i=1$，攻占城池 $i$ 以后，战斗力会乘以 $v_i$。\n\n注意每个骑士是单独计算的。也就是说一个骑士攻击一座城池，不管结果如何，均不会影响其他骑士攻击这座城池的结果。\n\n现在的问题是，对于每个城池，输出有多少个骑士在这里牺牲；对于每个骑士，输出他攻占的城池数量。", "inputFormat": "第 $1$ 行包含两个正整数 $n,m$，表示城池的数量和骑士的数量。\n\n第 $2$ 行包含 $n$ 个整数，其中第 $i$ 个数为 $h_i$，表示城池 $i$ 的防御值。\n\n第 $3\\sim n+1$ 行，每行包含三个整数。其中第 $i+1$ 行的三个数为 $f_i,a_i,v_i$，分别表示管辖这座城池的城池编号和两个战斗力变化参数。\n\n第 $n+2\\sim n+m+1$ 行，每行包含两个整数。其中第 $n+i$ 行的两个数为 $s_i,c_i$，分别表示初始战斗力和第一个攻击的城池。\n", "outputFormat": "输出 $n+m$ 行，每行包含一个非负整数。其中前 $n$ 行分别表示在城池 $1$ 到 $n$ 牺牲的骑士数量，后 $m$ 行分别表示骑士 $1$ 到 $m$ 攻占的城池数量。", "hint": "对于 $100\\%$ 的数据，$1\\le n,m\\le 3\\times 10^5$，$\n-10^{18}\\le h_i,v_i,s_i\\le 10^{18}$，$1\\le f_i<i,1\\le c_i\\le n,a_i\\in\\{0,1\\}$，保证 $a_i=1$ 时，$v_i>0$，保证任何时候骑士战斗力值的绝对值不超过 $10^{18}$。\n", "locale": "zh-CN"}}}
{"pid": "P3262", "type": "P", "difficulty": 6, "samples": [["3 4\n503 1082\n1271 369\n303 1135\n749 1289\n100 54\n837 826\n947 699\n216 389", "6701"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2015", "各省省选", "吉林", "枚举", "深度优先搜索 DFS"], "title": "[JLOI2015] 战争调度", "background": "", "description": "脸哥最近来到了一个神奇的王国，王国里的公民每个公民有两个下属或者没有下属，这种关系刚好组成一个 $n$ 层的完全二叉树。公民 $i$ 的下属是 $2i$ 和 $2i +1$。最下层的公民即叶子节点的公民是平民，平民没有下属，最上层的是国王，中间是各级贵族。\n\n现在这个王国爆发了战争，国王需要决定每一个平民是去种地以供应粮食还是参加战争，每一个贵族（包括国王自己）是去管理后勤还是领兵打仗。一个平民会对他的所有直系上司有贡献度，若一个平民 $i$ 参加战争，他的某个直系上司 $j$ 领兵打仗，那么这个平民对上司的作战贡献度为 $w_{ij}$。若一个平民 $i$ 种地，他的某个直系上司 $j$ 管理后勤，那么这个平民对上司的后勤贡献度为 $f_{ij}$，若 $i$ 和 $j$ 所参加的事务不同，则没有贡献度。为了战争需要保障后勤，国王还要求不多于 $m$ 个平民参加战争。\n\n国王想要使整个王国所有贵族得到的贡献度最大，并把这件事交给了脸哥。但不幸的是，脸哥还有很多 deadline 没有完成，他只能把这件事又转交给你。你能帮他安排吗？", "inputFormat": "第一行两个数 $n,m$。\n\n接下来 $2^{n-1}$ 行，每行 $n-1$ 个数，第 $i$ 行表示编号为 $2^{n-1}-1+ i$ 的平民对其 $n-1$ 个直系上司的作战贡献度，其中第一个数表示对第一级直系上司，即编号为 $\\frac{2^{n-1}-1+ i}{2}$ 的贵族的作战贡献度 $w_{ij}$，依次往上。\n\n接下来 $2^{n-1}$ 行，每行 $n-1$ 个数，第 $i$ 行表示编号为 $2^{n-1}-1+ i$ 的平民对其 $n-1$ 个直系上司的后勤贡献度，其中第一个数表示对第一级直系上司，即编号为 $\\frac{2^{n-1}-1+ i}{2}$ 的贵族的后勤贡献度 $f_{ij}$ ，依次往上。", "outputFormat": "一行一个数表示满足条件的最大贡献值。", "hint": "对于 $100 \\%$ 的数据，$2 \\leq n \\leq 10, \\ m \\leq 2^{n-1}, \\ 0 \\leq w_{ij}, f_{ij} \\leq 2000$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2015] War Scheduling", "background": "", "description": "Lian-ge (pinyin) recently arrived in a magical kingdom where each citizen has either two subordinates or no subordinates, and these relations form a complete binary tree with $n$ levels. The subordinates of citizen $i$ are $2i$ and $2i +1$. The citizens on the lowest level, i.e., the leaves, are commoners and have no subordinates; the topmost citizen is the king, and those in between are nobles of various ranks.\n\nA war has broken out in this kingdom. The king must decide whether each commoner should farm to supply food or join the war, and whether each noble (including the king) should manage logistics or lead troops in battle. A commoner contributes to all of their direct superiors. If a commoner $i$ joins the war and one of their direct superiors $j$ leads troops in battle, then the commoner’s combat contribution to that superior is $w_{ij}$. If a commoner $i$ farms and one of their direct superiors $j$ manages logistics, then the commoner’s logistics contribution to that superior is $f_{ij}$. If $i$ and $j$ engage in different affairs, then there is no contribution. To ensure logistics for the war, the king also requires that no more than $m$ commoners join the war.\n\nThe king wants to maximize the total contribution received by all nobles in the kingdom and has assigned this task to Lian-ge. Unfortunately, Lian-ge has many deadlines left unfinished and has passed this task on to you. Can you arrange it?", "inputFormat": "The first line contains two numbers $n, m$.\n\nThe next $2^{n-1}$ lines each contain $n-1$ numbers. The $i$-th of these lines gives the combat contributions from the commoner numbered $2^{n-1}-1+ i$ to their $n-1$ direct superiors. The first number is the combat contribution $w_{ij}$ to their first-level direct superior, i.e., the noble numbered $\\frac{2^{n-1}-1+ i}{2}$, and so on up the chain.\n\nThe next $2^{n-1}$ lines each contain $n-1$ numbers. The $i$-th of these lines gives the logistics contributions from the commoner numbered $2^{n-1}-1+ i$ to their $n-1$ direct superiors. The first number is the logistics contribution $f_{ij}$ to their first-level direct superior, i.e., the noble numbered $\\frac{2^{n-1}-1+ i}{2}$, and so on up the chain.", "outputFormat": "Output a single number: the maximum total contribution that satisfies the constraints.", "hint": "For $100 \\%$ of the testdata, $2 \\leq n \\leq 10, \\ m \\leq 2^{n-1}, \\ 0 \\leq w_{ij}, f_{ij} \\leq 2000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2015] 战争调度", "background": "", "description": "脸哥最近来到了一个神奇的王国，王国里的公民每个公民有两个下属或者没有下属，这种关系刚好组成一个 $n$ 层的完全二叉树。公民 $i$ 的下属是 $2i$ 和 $2i +1$。最下层的公民即叶子节点的公民是平民，平民没有下属，最上层的是国王，中间是各级贵族。\n\n现在这个王国爆发了战争，国王需要决定每一个平民是去种地以供应粮食还是参加战争，每一个贵族（包括国王自己）是去管理后勤还是领兵打仗。一个平民会对他的所有直系上司有贡献度，若一个平民 $i$ 参加战争，他的某个直系上司 $j$ 领兵打仗，那么这个平民对上司的作战贡献度为 $w_{ij}$。若一个平民 $i$ 种地，他的某个直系上司 $j$ 管理后勤，那么这个平民对上司的后勤贡献度为 $f_{ij}$，若 $i$ 和 $j$ 所参加的事务不同，则没有贡献度。为了战争需要保障后勤，国王还要求不多于 $m$ 个平民参加战争。\n\n国王想要使整个王国所有贵族得到的贡献度最大，并把这件事交给了脸哥。但不幸的是，脸哥还有很多 deadline 没有完成，他只能把这件事又转交给你。你能帮他安排吗？", "inputFormat": "第一行两个数 $n,m$。\n\n接下来 $2^{n-1}$ 行，每行 $n-1$ 个数，第 $i$ 行表示编号为 $2^{n-1}-1+ i$ 的平民对其 $n-1$ 个直系上司的作战贡献度，其中第一个数表示对第一级直系上司，即编号为 $\\frac{2^{n-1}-1+ i}{2}$ 的贵族的作战贡献度 $w_{ij}$，依次往上。\n\n接下来 $2^{n-1}$ 行，每行 $n-1$ 个数，第 $i$ 行表示编号为 $2^{n-1}-1+ i$ 的平民对其 $n-1$ 个直系上司的后勤贡献度，其中第一个数表示对第一级直系上司，即编号为 $\\frac{2^{n-1}-1+ i}{2}$ 的贵族的后勤贡献度 $f_{ij}$ ，依次往上。", "outputFormat": "一行一个数表示满足条件的最大贡献值。", "hint": "对于 $100 \\%$ 的数据，$2 \\leq n \\leq 10, \\ m \\leq 2^{n-1}, \\ 0 \\leq w_{ij}, f_{ij} \\leq 2000$。", "locale": "zh-CN"}}}
{"pid": "P3263", "type": "P", "difficulty": 6, "samples": [["3 13 5\n", "393\n"], ["5 29 114514\n", "4997196309027367968\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "各省省选", "吉林", "矩阵乘法", "线性递推"], "title": "[JLOI2015] 有意义的字符串", "background": "", "description": "B 君有两个好朋友，他们叫宁宁和冉冉。有一天，冉冉遇到了一个有趣的题目：输入三个非负整数 $b,d,n$，求\n\n$$\\left\\lfloor \\left ( \\frac{b+\\sqrt{d}}{2} \\right ) ^n \\right\\rfloor \\bmod p$$\n\n其中 $p=7,528,443,412,579,576,937$", "inputFormat": "一行三个非负整数 $b$，$d$，$n$。", "outputFormat": "一行一个数表示模 $7,528,443,412,579,576,937$ 之后的结果。", "hint": "保证 $0<b^2 \\le d<(b+1)^2 \\le 10^{18}$，$n \\le 10^{18}$，并且 $b\\equiv 1\\pmod 2$，$d\\equiv 1\\pmod 4$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2015] Meaningful String", "background": "", "description": "Mr. B has two good friends, named Ningning and Ranran. One day, Ranran encountered an interesting problem: given three non-negative integers $b,d,n$, compute\n$$\\left\\lfloor \\left ( \\frac{b+\\sqrt{d}}{2} \\right ) ^n \\right\\rfloor \\bmod p,$$\nwhere $p=7,528,443,412,579,576,937$.", "inputFormat": "One line containing three non-negative integers $b$, $d$, and $n$.", "outputFormat": "Output a single integer denoting the result modulo 7,528,443,412,579,576,937.", "hint": "It is guaranteed that $0<b^2 \\le d<(b+1)^2 \\le 10^{18}$, $n \\le 10^{18}$, and $b\\equiv 1\\pmod 2$, $d\\equiv 1\\pmod 4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2015] 有意义的字符串", "background": "", "description": "B 君有两个好朋友，他们叫宁宁和冉冉。有一天，冉冉遇到了一个有趣的题目：输入三个非负整数 $b,d,n$，求\n\n$$\\left\\lfloor \\left ( \\frac{b+\\sqrt{d}}{2} \\right ) ^n \\right\\rfloor \\bmod p$$\n\n其中 $p=7,528,443,412,579,576,937$", "inputFormat": "一行三个非负整数 $b$，$d$，$n$。", "outputFormat": "一行一个数表示模 $7,528,443,412,579,576,937$ 之后的结果。", "hint": "保证 $0<b^2 \\le d<(b+1)^2 \\le 10^{18}$，$n \\le 10^{18}$，并且 $b\\equiv 1\\pmod 2$，$d\\equiv 1\\pmod 4$。\n", "locale": "zh-CN"}}}
{"pid": "P3264", "type": "P", "difficulty": 6, "samples": [["5 8 4\n1 2 3\n1 3 2\n1 5 1\n2 4 2\n2 5 1\n3 4 3\n3 5 1\n4 5 1\n1 1\n1 2\n2 3\n2 4", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "各省省选", "吉林", "生成树", "状压 DP"], "title": "[JLOI2015] 管道连接", "background": "", "description": "小铭铭最近进入了某情报部门，该部门正在被如何建立安全的通道连接困扰。该部门有 $n$ 个情报站，用 $1$ 到 $n$ 的整数编号。给出 $m$ 对情报站 $(u_i,v_i)$ 和费用 $w_i$，表示情报站 $u_i$ 和 $v_i$ 之间可以花费 $w_i$ 单位资源建立通道。\n\n如果一个情报站经过若干个建立好的通道可以到达另外一个情报站，那么这两个情报站就建立了通道连接。形式化地，若 $u_i$ 和 $v_i$ 建立了通道，那么它们建立了通道连接；若 $u_i$ 和 $v_i$ 均与 $t_i$ 建立了通道连接，那么 $u_i$ 和 $v_i$ 也建立了通道连接。\n\n现在在所有的情报站中，有 $p$ 个重要情报站，其中每个情报站有一个特定的频道。小铭铭面临的问题是，需要花费最少的资源，使得任意相同频道的情报站之间都建立通道连接。", "inputFormat": "第一行包含三个整数 $n,m,p$，表示情报站的数量，可以建立的通道数量和重要情报站的数量。\n\n接下来 $m$ 行，每行包含三个整数 $u_i,v_i,w_i$，表示可以建立的通道。\n\n最后有 $p$ 行，每行包含两个整数 $c_i,d_i$，表示重要情报站的频道和情报站的编号。", "outputFormat": "输出一行一个整数，表示任意相同频道的情报站之间都建立通道连接所花费的最少资源总量。\n", "hint": "选择 $(1,5),(3,5),(2,5),(4,5)$ 这 $4$ 对情报站连接。\n\n对于 $100\\%$ 的数据，$1\\le c_i\\le p\\le10$，$1\\le u_i,v_i,d_i \\le n \\le 1000$，$0\\le m \\le 3000$，$0\\le w_i \\le2\\times 10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2015] Pipeline Connection", "background": "", "description": "Xiao Mingming recently joined an intelligence department, which is struggling with how to establish secure pipeline connections. The department has $n$ intelligence stations, numbered from $1$ to $n$. You are given $m$ pairs of stations $(u_i,v_i)$ with a cost $w_i$, meaning that a pipeline can be built between station $u_i$ and station $v_i$ at a resource cost of $w_i$.\n\nIf one station can reach another station through several built pipelines, then these two stations are considered connected. Formally, if a pipeline is built between $u_i$ and $v_i$, then they are connected; if $u_i$ and $v_i$ are both connected to $t_i$, then $u_i$ and $v_i$ are also connected.\n\nAmong all stations, there are $p$ important stations, and each of these stations has a specific channel. The task is to spend the minimum total amount of resources so that any two stations with the same channel are connected.", "inputFormat": "The first line contains three integers $n,m,p$, representing the number of stations, the number of possible pipelines, and the number of important stations.\n\nEach of the next $m$ lines contains three integers $u_i,v_i,w_i$, describing a possible pipeline.\n\nFinally, there are $p$ lines, each containing two integers $c_i,d_i$, representing the channel and the station index of an important station.", "outputFormat": "Output a single integer on one line, the minimum total amount of resources required so that any two stations with the same channel are connected.", "hint": "Choose $(1,5)$, $(3,5)$, $(2,5)$, $(4,5)$ to connect these $4$ pairs of stations.\n\nFor $100\\%$ of the testdata, $1\\le c_i\\le p\\le10$, $1\\le u_i,v_i,d_i \\le n \\le 1000$, $0\\le m \\le 3000$, $0\\le w_i \\le 2\\times 10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2015] 管道连接", "background": "", "description": "小铭铭最近进入了某情报部门，该部门正在被如何建立安全的通道连接困扰。该部门有 $n$ 个情报站，用 $1$ 到 $n$ 的整数编号。给出 $m$ 对情报站 $(u_i,v_i)$ 和费用 $w_i$，表示情报站 $u_i$ 和 $v_i$ 之间可以花费 $w_i$ 单位资源建立通道。\n\n如果一个情报站经过若干个建立好的通道可以到达另外一个情报站，那么这两个情报站就建立了通道连接。形式化地，若 $u_i$ 和 $v_i$ 建立了通道，那么它们建立了通道连接；若 $u_i$ 和 $v_i$ 均与 $t_i$ 建立了通道连接，那么 $u_i$ 和 $v_i$ 也建立了通道连接。\n\n现在在所有的情报站中，有 $p$ 个重要情报站，其中每个情报站有一个特定的频道。小铭铭面临的问题是，需要花费最少的资源，使得任意相同频道的情报站之间都建立通道连接。", "inputFormat": "第一行包含三个整数 $n,m,p$，表示情报站的数量，可以建立的通道数量和重要情报站的数量。\n\n接下来 $m$ 行，每行包含三个整数 $u_i,v_i,w_i$，表示可以建立的通道。\n\n最后有 $p$ 行，每行包含两个整数 $c_i,d_i$，表示重要情报站的频道和情报站的编号。", "outputFormat": "输出一行一个整数，表示任意相同频道的情报站之间都建立通道连接所花费的最少资源总量。\n", "hint": "选择 $(1,5),(3,5),(2,5),(4,5)$ 这 $4$ 对情报站连接。\n\n对于 $100\\%$ 的数据，$1\\le c_i\\le p\\le10$，$1\\le u_i,v_i,d_i \\le n \\le 1000$，$0\\le m \\le 3000$，$0\\le w_i \\le2\\times 10^4$。", "locale": "zh-CN"}}}
{"pid": "P3265", "type": "P", "difficulty": 6, "samples": [["3 3\n1 2 3\n3 4 5\n2 3 4\n1 1 2", "2 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "各省省选", "吉林", "高斯消元", "线性基", "向量"], "title": "[JLOI2015] 装备购买", "background": "", "description": "脸哥最近在玩一款神奇的游戏，这个游戏里有 $n$ 件装备，每件装备有 $m$ 个属性，用向量 $\\mathbf{z_i}=(a_1, \\ldots ,a_j, \\ldots , a_m)$ 表示 ($1 \\leq i \\leq n, \\ 1 \\leq j \\leq m$)，每个装备需要花费 $c_i$，现在脸哥想买一些装备，但是脸哥很穷，所以总是盘算着怎样才能花尽量少的钱买尽量多的装备。对于脸哥来说，如果一件装备的属性能用购买的其他装备组合出（也就是说脸哥可以利用手上的这些装备组合出这件装备的效果），那么这件装备就没有买的必要了。\n\n严格的定义是，如果脸哥买了 $\\mathbf{z_{i_1}}, \\ldots , \\mathbf{z_{i_p}}$这 $p$ 件装备，那么对于任意待决定的 $\\mathbf{z_h}$，不存在 $b_1, \\ldots ,b_p$使得 $b_1\\mathbf{z_{i_1}} + \\ldots + b_p\\mathbf{z_{i_p}} = \\mathbf{z_h}$\n​​ （$b_i$均是实数），那么脸哥就会买 $\\mathbf{z_h}$，否则 $\\mathbf{z_h}$ 对脸哥就是无用的了，自然不必购买。\n\n举个例子，$\\mathbf{z_1}=(1, 2, 3), \\ \\mathbf{z_2}=(3, 4, 5), \\ \\mathbf{z_h}=(2, 3, 4), \\ b_1 =\\frac{1}{2}, \\ b_2 =\\frac{1}{2}$，就有 $b_1\\mathbf{z_1} + b_2\\mathbf{z_2} = \\mathbf{z_h}$ ，那么如果脸哥买了 $\\mathbf{z_1}$和 $\\mathbf{z_2}$ 就不会再买 $\\mathbf{z_h}$了。\n\n脸哥想要在买下最多数量的装备的情况下花最少的钱，你能帮他算一下吗？", "inputFormat": "第一行两个数 $n,m$。接下来 $n$ 行，每行 $m$ 个数，其中第 $i$ 行描述装备 $i$ 的各项属性值。接下来一行 $n$ 个数，其中 $c_i$ 表示购买第 $i$ 件装备的花费。", "outputFormat": "一行两个数，第一个数表示能够购买的最多装备数量，第二个数表示在购买最多数量的装备的情况下的最小花费。", "hint": "如题目中描述，选择装备 $1$ 装备 $2$，装备 $1$ 装备 $3$，装备 $2$ 装备 $3$ 均可，但选择装备 $1$ 和装备 $2$ 的花费最小，为 $2$。\n\n对于 $100\\%$ 的数据 $,1 \\le n,m \\le 500$，$0 \\le a_j \\le 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2015] Equipment Purchase", "background": "", "description": "Lian Ge is playing a magical game. There are $n$ pieces of equipment, each with $m$ attributes, represented by a vector $\\mathbf{z_i} = (a_1, \\ldots, a_j, \\ldots, a_m)$ ($1 \\le i \\le n$, $1 \\le j \\le m$). Each piece of equipment costs $c_i$. Lian Ge wants to buy some equipment, but he is poor, so he always tries to spend as little money as possible to buy as many pieces as possible. For him, if the attributes of one piece of equipment can be formed by a combination of other purchased equipment (that is, he can use the equipment he owns to reproduce the effect of this piece), then this piece is unnecessary to buy.\n\nThe strict definition is: if Lian Ge has bought $\\mathbf{z_{i_1}}, \\ldots, \\mathbf{z_{i_p}}$, then for any undecided $\\mathbf{z_h}$, if there do not exist $b_1, \\ldots, b_p$ such that $b_1 \\mathbf{z_{i_1}} + \\ldots + b_p \\mathbf{z_{i_p}} = \\mathbf{z_h}$ ($b_i$ are real numbers), then Lian Ge will buy $\\mathbf{z_h}$; otherwise, $\\mathbf{z_h}$ is useless to him and need not be purchased.\n\nFor example, let $\\mathbf{z_1} = (1, 2, 3)$, $\\mathbf{z_2} = (3, 4, 5)$, $\\mathbf{z_h} = (2, 3, 4)$, and $b_1 = \\frac{1}{2}$, $b_2 = \\frac{1}{2}$. Then $b_1 \\mathbf{z_1} + b_2 \\mathbf{z_2} = \\mathbf{z_h}$. In this case, if Lian Ge buys $\\mathbf{z_1}$ and $\\mathbf{z_2}$, he will not buy $\\mathbf{z_h}$.\n\nLian Ge wants to spend the minimum cost while buying the maximum number of pieces of equipment. Can you help him compute the result?", "inputFormat": "The first line contains two numbers $n, m$.  \nThe next $n$ lines each contain $m$ numbers; the $i$-th line describes the attribute values of equipment $i$.  \nThe next line contains $n$ numbers, where $c_i$ is the cost of buying the $i$-th piece of equipment.", "outputFormat": "Output one line with two numbers: the maximum number of pieces that can be purchased, and the minimum total cost under that maximum.", "hint": "As described in the problem, choosing equipment $1$ and $2$, equipment $1$ and $3$, or equipment $2$ and $3$ are all valid, but choosing equipment $1$ and $2$ has the minimum cost, which is $2$.\n\nFor $100\\%$ of the testdata, $1 \\le n, m \\le 500$, $0 \\le a_j \\le 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2015] 装备购买", "background": "", "description": "脸哥最近在玩一款神奇的游戏，这个游戏里有 $n$ 件装备，每件装备有 $m$ 个属性，用向量 $\\mathbf{z_i}=(a_1, \\ldots ,a_j, \\ldots , a_m)$ 表示 ($1 \\leq i \\leq n, \\ 1 \\leq j \\leq m$)，每个装备需要花费 $c_i$，现在脸哥想买一些装备，但是脸哥很穷，所以总是盘算着怎样才能花尽量少的钱买尽量多的装备。对于脸哥来说，如果一件装备的属性能用购买的其他装备组合出（也就是说脸哥可以利用手上的这些装备组合出这件装备的效果），那么这件装备就没有买的必要了。\n\n严格的定义是，如果脸哥买了 $\\mathbf{z_{i_1}}, \\ldots , \\mathbf{z_{i_p}}$这 $p$ 件装备，那么对于任意待决定的 $\\mathbf{z_h}$，不存在 $b_1, \\ldots ,b_p$使得 $b_1\\mathbf{z_{i_1}} + \\ldots + b_p\\mathbf{z_{i_p}} = \\mathbf{z_h}$\n​​ （$b_i$均是实数），那么脸哥就会买 $\\mathbf{z_h}$，否则 $\\mathbf{z_h}$ 对脸哥就是无用的了，自然不必购买。\n\n举个例子，$\\mathbf{z_1}=(1, 2, 3), \\ \\mathbf{z_2}=(3, 4, 5), \\ \\mathbf{z_h}=(2, 3, 4), \\ b_1 =\\frac{1}{2}, \\ b_2 =\\frac{1}{2}$，就有 $b_1\\mathbf{z_1} + b_2\\mathbf{z_2} = \\mathbf{z_h}$ ，那么如果脸哥买了 $\\mathbf{z_1}$和 $\\mathbf{z_2}$ 就不会再买 $\\mathbf{z_h}$了。\n\n脸哥想要在买下最多数量的装备的情况下花最少的钱，你能帮他算一下吗？", "inputFormat": "第一行两个数 $n,m$。接下来 $n$ 行，每行 $m$ 个数，其中第 $i$ 行描述装备 $i$ 的各项属性值。接下来一行 $n$ 个数，其中 $c_i$ 表示购买第 $i$ 件装备的花费。", "outputFormat": "一行两个数，第一个数表示能够购买的最多装备数量，第二个数表示在购买最多数量的装备的情况下的最小花费。", "hint": "如题目中描述，选择装备 $1$ 装备 $2$，装备 $1$ 装备 $3$，装备 $2$ 装备 $3$ 均可，但选择装备 $1$ 和装备 $2$ 的花费最小，为 $2$。\n\n对于 $100\\%$ 的数据 $,1 \\le n,m \\le 500$，$0 \\le a_j \\le 1000$。", "locale": "zh-CN"}}}
{"pid": "P3266", "type": "P", "difficulty": 6, "samples": [["3 3", "40"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "各省省选", "吉林", "组合数学", "容斥原理"], "title": "[JLOI2015] 骗我呢", "background": null, "description": "说起来，毕业之后 B 君也就见过 R 君两面而已。\n\nR 君有一个 $n\\times m$ 的数组 $x_{i,j}$。\n\n对于 $1\\le i\\le n,1\\le j\\le m$，满足 $0\\le x_{i,j}\\le m$。求可能的数组 $x_{i,j}$ 的个数。\n\nB 君觉得限制太宽松，还要求对于 $1\\le i\\le n,1\\le j<m$，满足 $x_{i,j}<x_{i,j+1}$；对于 $1<i\\le n,1\\le j<m$，满足 $x_{i,j}<x_{i-1,j+1}$。\n\nB 君认为 R 君可以直接 pwn 掉这个题。\n\nR 君说：「黑的实在逼真 =.=，你起码把答案模 $10^9+7$ 吧。」B 君觉得 R 君说的有道理，于是想让你求答案模 $10^9+7$ 的结果。", "inputFormat": "一行两个整数表示 $n,m$，含义如题目中所述。", "outputFormat": "一行一个数表示同时满足 B 君和 R 君的条件 $x_{i,j}$ 的个数，模 $10^9+7$ 的结果。", "hint": "对于 $100\\%$ 的数据，$1\\leq n,m\\leq10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2015] Are You Kidding Me", "background": "", "description": "Speaking of which, after graduation, B has only met R twice.\n\nR has an $n \\times m$ array $x_{i,j}$.\n\nFor $1 \\le i \\le n, 1 \\le j \\le m$, it holds that $0 \\le x_{i,j} \\le m$. Find the number of possible arrays $x_{i,j}$.\n\nB thinks the constraints are too loose and additionally requires that for $1 \\le i \\le n, 1 \\le j < m$, we have $x_{i,j} < x_{i,j+1}$; and for $1 < i \\le n, 1 \\le j < m$, we have $x_{i,j} < x_{i-1,j+1}$.\n\nB believes R can just pwn this problem.\n\nR says: \"This trolling is way too realistic =.=, at least take the answer modulo $10^9+7$.\" B thinks R makes sense, so he asks you to compute the answer modulo $10^9+7$.", "inputFormat": "A single line with two integers $n, m$, as described above.", "outputFormat": "A single line with a single number: the count of arrays $x_{i,j}$ that satisfy both B's and R's conditions, modulo $10^9+7$.", "hint": "For $100\\%$ of the testdata, $1 \\le n, m \\le 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2015] 骗我呢", "background": null, "description": "说起来，毕业之后 B 君也就见过 R 君两面而已。\n\nR 君有一个 $n\\times m$ 的数组 $x_{i,j}$。\n\n对于 $1\\le i\\le n,1\\le j\\le m$，满足 $0\\le x_{i,j}\\le m$。求可能的数组 $x_{i,j}$ 的个数。\n\nB 君觉得限制太宽松，还要求对于 $1\\le i\\le n,1\\le j<m$，满足 $x_{i,j}<x_{i,j+1}$；对于 $1<i\\le n,1\\le j<m$，满足 $x_{i,j}<x_{i-1,j+1}$。\n\nB 君认为 R 君可以直接 pwn 掉这个题。\n\nR 君说：「黑的实在逼真 =.=，你起码把答案模 $10^9+7$ 吧。」B 君觉得 R 君说的有道理，于是想让你求答案模 $10^9+7$ 的结果。", "inputFormat": "一行两个整数表示 $n,m$，含义如题目中所述。", "outputFormat": "一行一个数表示同时满足 B 君和 R 君的条件 $x_{i,j}$ 的个数，模 $10^9+7$ 的结果。", "hint": "对于 $100\\%$ 的数据，$1\\leq n,m\\leq10^6$。", "locale": "zh-CN"}}}
{"pid": "P3267", "type": "P", "difficulty": 5, "samples": [["12 2\n8 9 12 6 1 1 5 1 4 8 10 6\n10\n1 2 3 5 6 7 8 9 10 11\n1 3\n2 3\n3 4\n4 5\n4 6\n4 7\n7 8\n8 9\n9 10\n10 11\n11 12", "10"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "2016", "各省省选", "上海", "吉林"], "title": "[JLOI2016/SHOI2016] 侦察守卫", "background": "", "description": "小 R 和 B 神正在玩一款游戏。这款游戏的地图由 $N$ 个点和 $N-1$ 条无向边组成，每条无向边连接两个点，且地图是连通的。换句话说，游戏的地图是一棵有 $N$ 个节点的树。\n\n游戏中有一种道具叫做侦查守卫，当一名玩家在一个点上放置侦查守卫后，它可以监视这个点以及与这个点的距离在 $D$ 以内的所有点。这里两个点之间的距离定义为它们在树上的距离，也就是两个点之间唯一的简单路径上所经过边的条数。在一个点上放置侦查守卫需要付出一定的代价，在不同点放置守卫的代价可能不同。\n\n现在小 R 知道了所有 B 神可能会出现的位置，请你计算监视所有这些位置的最小代价。\n", "inputFormat": "第一行包含两个正整数 $N$ 和 $D$，分别表示地图上的点数和侦查守卫的视野范围。约定地图上的点用 $1$ 到 $N$ 的整数编号。\n\n第二行 $N$ 个正整数，第 $i$ 个正整数表示在编号为 $i$ 的点放置侦查守卫的代价 $W _ i$。保证 $W _ i \\le 1000$。\n\n第三行一个正整数 $M$，表示 B 神可能出现的点的数量。保证 $M \\le N$。\n\n第四行 $M$ 个正整数，分别表示每个 B 神可能出现的点的编号，从小到大不重复地给出。\n\n接下来 $N-1$ 行，每行包含两个正整数 $U,V$，表示在编号为 $U$ 的点和编号为 $V$ 的点之间有一条无向边。\n", "outputFormat": "仅一行一个整数，表示监视所有 B 神可能出现的点所需要的最小代价。\n", "hint": "对于所有的数据，$N \\le 5 \\times 10 ^ 5,D \\le 20$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2016/SHOI2016] Scout Wards", "background": "", "description": "R and player B are playing a game. The game map consists of $N$ points and $N-1$ undirected edges, each connecting two points, and the map is connected. In other words, the map is a tree with $N$ nodes.\n\nThere is an item called a scout ward. When a player places a scout ward at a point, it can monitor that point and all points whose distance from it is within $D$. The distance between two points is defined as their distance on the tree, i.e., the number of edges on the unique simple path between them. Placing a scout ward at a point has a certain cost, and the cost may differ between points.\n\nNow R knows all the positions where player B may appear. Please compute the minimum total cost to monitor all these positions.", "inputFormat": "The first line contains two positive integers $N$ and $D$, denoting the number of points on the map and the vision range of a scout ward, respectively. Points are numbered from $1$ to $N$.\n\nThe second line contains $N$ positive integers. The $i$-th integer denotes the cost $W_i$ of placing a scout ward at point $i$. It is guaranteed that $W_i \\le 1000$.\n\nThe third line contains a positive integer $M$, denoting the number of points where player B may appear. It is guaranteed that $M \\le N$.\n\nThe fourth line contains $M$ positive integers, denoting the indices of the points where player B may appear, given in strictly increasing order without repetition.\n\nThe next $N-1$ lines each contain two positive integers $U, V$, indicating that there is an undirected edge between points $U$ and $V$.", "outputFormat": "Output a single integer on one line, the minimum total cost required to monitor all points where player B may appear.", "hint": "For all testdata, $N \\le 5 \\times 10^5$, $D \\le 20$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2016/SHOI2016] 侦察守卫", "background": "", "description": "小 R 和 B 神正在玩一款游戏。这款游戏的地图由 $N$ 个点和 $N-1$ 条无向边组成，每条无向边连接两个点，且地图是连通的。换句话说，游戏的地图是一棵有 $N$ 个节点的树。\n\n游戏中有一种道具叫做侦查守卫，当一名玩家在一个点上放置侦查守卫后，它可以监视这个点以及与这个点的距离在 $D$ 以内的所有点。这里两个点之间的距离定义为它们在树上的距离，也就是两个点之间唯一的简单路径上所经过边的条数。在一个点上放置侦查守卫需要付出一定的代价，在不同点放置守卫的代价可能不同。\n\n现在小 R 知道了所有 B 神可能会出现的位置，请你计算监视所有这些位置的最小代价。\n", "inputFormat": "第一行包含两个正整数 $N$ 和 $D$，分别表示地图上的点数和侦查守卫的视野范围。约定地图上的点用 $1$ 到 $N$ 的整数编号。\n\n第二行 $N$ 个正整数，第 $i$ 个正整数表示在编号为 $i$ 的点放置侦查守卫的代价 $W _ i$。保证 $W _ i \\le 1000$。\n\n第三行一个正整数 $M$，表示 B 神可能出现的点的数量。保证 $M \\le N$。\n\n第四行 $M$ 个正整数，分别表示每个 B 神可能出现的点的编号，从小到大不重复地给出。\n\n接下来 $N-1$ 行，每行包含两个正整数 $U,V$，表示在编号为 $U$ 的点和编号为 $V$ 的点之间有一条无向边。\n", "outputFormat": "仅一行一个整数，表示监视所有 B 神可能出现的点所需要的最小代价。\n", "hint": "对于所有的数据，$N \\le 5 \\times 10 ^ 5,D \\le 20$。", "locale": "zh-CN"}}}
{"pid": "P3268", "type": "P", "difficulty": 6, "samples": [["2\n0 0 1\n0 0 2", "3"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2016", "各省省选", "吉林"], "title": "[JLOI2016] 圆的异或并", "background": null, "description": "在平面直角坐标系中给定 $N$ 个圆。已知这些圆**两两没有交点**，即两圆的关系只存在相离和包含。求这些圆的异或面积并。\n\n异或面积并定义为：当一片区域在奇数个圆内，则计入其面积，否则，当一片区域在偶数个圆内则不计入其面积。", "inputFormat": "第一行包含一个正整数 $N$，代表圆的个数。\n\n接下来 $N$ 行，每行 $3$ 个整数 $x,y,r$，表示一个圆心在 $(x,y)$，半径为 $r$ 的圆。\n\n数据保证 $|x_i|,|y_i|\\le 10^8$，$0<r\\leq 10^6$，$1\\le N\\le 2\\times 10^5$。", "outputFormat": "仅一行一个整数，表示所有圆的异或面积并除以圆周率 $\\pi$ 的结果。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2016] XOR Area Union of Circles", "background": "", "description": "Given $N$ circles in the 2D Cartesian coordinate system. It is known that any two circles have no intersection points; that is, two circles are either disjoint or one contains the other. Compute the XOR area union of these circles.\n\nThe XOR area union is defined as follows: a region is counted if it lies inside an odd number of circles; otherwise, if it lies inside an even number of circles, it is not counted.", "inputFormat": "The first line contains a positive integer $N$, the number of circles.\n\nEach of the next $N$ lines contains $3$ integers $x,y,r$, representing a circle centered at $(x,y)$ with radius $r$.\n\nConstraints: $|x_i|,|y_i|\\le 10^8$, $0<r\\leq 10^6$, $1\\le N\\le 2\\times 10^5$.", "outputFormat": "Output a single integer on one line: the result of the XOR area union of all circles divided by $\\pi$.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2016] 圆的异或并", "background": null, "description": "在平面直角坐标系中给定 $N$ 个圆。已知这些圆**两两没有交点**，即两圆的关系只存在相离和包含。求这些圆的异或面积并。\n\n异或面积并定义为：当一片区域在奇数个圆内，则计入其面积，否则，当一片区域在偶数个圆内则不计入其面积。", "inputFormat": "第一行包含一个正整数 $N$，代表圆的个数。\n\n接下来 $N$ 行，每行 $3$ 个整数 $x,y,r$，表示一个圆心在 $(x,y)$，半径为 $r$ 的圆。\n\n数据保证 $|x_i|,|y_i|\\le 10^8$，$0<r\\leq 10^6$，$1\\le N\\le 2\\times 10^5$。", "outputFormat": "仅一行一个整数，表示所有圆的异或面积并除以圆周率 $\\pi$ 的结果。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P3269", "type": "P", "difficulty": 7, "samples": [["2\nhello\n4\nhe\nl\nl\no\nabacaba\n4\nab\nba\na\nc", "4 5 \n4 6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "2016", "各省省选", "吉林"], "title": "[JLOI2016] 字符串覆盖", "background": null, "description": "字符串 $A$ 有 $N$ 个子串 $B_1,B_2,...,B_n$。如果将这 $n$ 个子串分别放在恰好一个它在 $A$ 中出现的位置上（子串之间可以重叠）这样 $A$ 中的若干字符就被这 $N$ 个子串覆盖了。问 $A$ 中能被覆盖字符个数的最小值和最大值。", "inputFormat": "第一行包含一个正整数 $T$，表示数据组数。保证 $T \\le 10$。\n\n接下来依次描述 $T$ 组数据，每组数据中：\n\n第一行包含一个由小写字母组成的字符串，表示母串 $A$。\n\n第二行包含一个整数 $N$，表示子串的个数。\n\n接下来 $N$ 行，每行包含一个由小写字母组成的字符串，描述子串。数据保证所有子串均在母串中出现。", "outputFormat": "输出为 $T$  行，对应每组数据的答案。每行包含两个整数 $Minans$ 和 $Maxans$，分别表示对应数据中能被覆盖字符数量的最小值和最大值。", "hint": "字符串长度 $A \\le 10000$,$N \\le 4$,$\\text{子串长度} \\le 10000$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2016] String Coverage", "background": "", "description": "String $A$ has $N$ substrings $B_1,B_2,...,B_n$. If we place each of these $n$ substrings at exactly one position where it occurs in $A$ (substrings may overlap), then some characters in $A$ will be covered by these $N$ substrings. Find the minimum and maximum possible numbers of covered characters in $A$.", "inputFormat": "The first line contains a positive integer $T$, the number of test cases. It is guaranteed that $T \\le 10$.\n\nThen the $T$ test cases follow. For each test case:\n\n- The first line contains a string of lowercase letters, the main string $A$.\n- The second line contains an integer $N$, the number of substrings.\n- The next $N$ lines each contain a string of lowercase letters, describing a substring. It is guaranteed that every substring occurs in the main string.", "outputFormat": "Output $T$ lines, one for each test case. Each line contains two integers $Minans$ and $Maxans$, the minimum and maximum numbers of characters that can be covered, respectively.", "hint": "Constraints: $|A| \\le 10000$, $N \\le 4$, substring length $\\le 10000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2016] 字符串覆盖", "background": null, "description": "字符串 $A$ 有 $N$ 个子串 $B_1,B_2,...,B_n$。如果将这 $n$ 个子串分别放在恰好一个它在 $A$ 中出现的位置上（子串之间可以重叠）这样 $A$ 中的若干字符就被这 $N$ 个子串覆盖了。问 $A$ 中能被覆盖字符个数的最小值和最大值。", "inputFormat": "第一行包含一个正整数 $T$，表示数据组数。保证 $T \\le 10$。\n\n接下来依次描述 $T$ 组数据，每组数据中：\n\n第一行包含一个由小写字母组成的字符串，表示母串 $A$。\n\n第二行包含一个整数 $N$，表示子串的个数。\n\n接下来 $N$ 行，每行包含一个由小写字母组成的字符串，描述子串。数据保证所有子串均在母串中出现。", "outputFormat": "输出为 $T$  行，对应每组数据的答案。每行包含两个整数 $Minans$ 和 $Maxans$，分别表示对应数据中能被覆盖字符数量的最小值和最大值。", "hint": "字符串长度 $A \\le 10000$,$N \\le 4$,$\\text{子串长度} \\le 10000$。", "locale": "zh-CN"}}}
{"pid": "P3270", "type": "P", "difficulty": 6, "samples": [["3 2 1\n2 2\n1 2", "10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["递推", "2016", "各省省选", "吉林", "容斥原理"], "title": "[JLOI2016] 成绩比较", "background": "", "description": "G 系共有 $N$ 位同学，$M$ 门必修课。这 $N$ 位同学的编号为 $0$ 到 $N-1$ 的整数，其中 B 神的编号为 $0$ 号。这 $M$ 门必修课编号为 $0$ 到 $M-1$ 的整数。一位同学在必修课上可以获得的分数是 $1$ 到 $U_i$ 中的一个整数。\n\n如果在每门课上 A 获得的成绩均小于等于 B 获得的成绩，则称 A 被 B 碾压。在 B 神的说法中，G 系共有 $K$ 位同学被他碾压（不包括他自己），而其他 $N-K-1$ 位同学则没有被他碾压。D 神查到了 B 神每门必修课的排名。\n\n这里的排名是指：如果 B 神某门课的排名为 $R$，则表示有且仅有 $R-1$ 位同学这门课的分数大于 B 神的分数，有且仅有 $N-R$ 位同学这门课的分数小于等于 B 神（不包括他自己）。\n\n我们需要求出全系所有同学每门必修课得分的情况数，使其既能满足 B 神的说法，也能符合 D 神查到的排名。这里两种情况不同当且仅当有任意一位同学在任意一门课上获得的分数不同。\n\n你不需要像 D 神那么厉害，你只需要计算出情况数模 $10^9+7$ 的余数就可以了。", "inputFormat": "第一行包含三个正整数 $N,M,K$，分别表示 G 系的同学数量（包括 B 神），必修课的数量和被 B 神碾压的同学数量。\n\n第二行包含 $M$ 个正整数，依次表示每门课的最高分 $U_i$。\n\n第三行包含 $M$ 个正整数，依次表示 B 神在每门课上的排名 $R_i$。\n\n数据保证至少有 $1$ 种情况使得 B 神说的话成立。", "outputFormat": "仅一行一个正整数，表示满足条件的情况数模 $10^9+7$ 的余数。", "hint": "$1\\leq N\\leq 100$，$1\\leq M\\leq 100$，$1\\leq U_i\\leq 10^9$，$1\\leq R_i\\leq N$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2016] Grade Comparison", "background": "", "description": "The G Department has $N$ students and $M$ required courses. The students are numbered by integers from $0$ to $N-1$, and B Shen's number is $0$. The $M$ required courses are numbered from $0$ to $M-1$. In each required course, a student can earn an integer score from $1$ to $U_i$ inclusive.\n\nIf in every course A's score is less than or equal to B's score, then A is said to be dominated by B. According to B Shen, there are $K$ students whom he dominates (excluding himself), and the other $N-K-1$ students are not dominated by him. D Shen has found B Shen's rank in each required course.\n\nHere, rank means: if B Shen's rank in some course is $R$, then exactly $R-1$ students have a score strictly greater than B Shen's score in that course, and exactly $N-R$ students have a score less than or equal to B Shen's score in that course (excluding himself).\n\nWe need to count the number of possible score assignments for all students in all required courses that satisfy both B Shen's statement and the ranks found by D Shen. Two assignments are different if and only if there exists at least one student and one course where the assigned score differs.\n\nYou do not need to be as powerful as D Shen; just compute the answer modulo $10^9+7$.", "inputFormat": "- The first line contains three positive integers $N, M, K$, denoting the number of students in the G Department (including B Shen), the number of required courses, and the number of students dominated by B Shen.\n- The second line contains $M$ positive integers, the maximum score $U_i$ of each course in order.\n- The third line contains $M$ positive integers, B Shen's rank $R_i$ in each course in order.\n- It is guaranteed that there is at least one assignment that makes B Shen's statement hold.", "outputFormat": "Output a single integer on one line, the number of valid assignments modulo $10^9+7$.", "hint": "Constraints: $1 \\leq N \\leq 100$, $1 \\leq M \\leq 100$, $1 \\leq U_i \\leq 10^9$, $1 \\leq R_i \\leq N$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2016] 成绩比较", "background": "", "description": "G 系共有 $N$ 位同学，$M$ 门必修课。这 $N$ 位同学的编号为 $0$ 到 $N-1$ 的整数，其中 B 神的编号为 $0$ 号。这 $M$ 门必修课编号为 $0$ 到 $M-1$ 的整数。一位同学在必修课上可以获得的分数是 $1$ 到 $U_i$ 中的一个整数。\n\n如果在每门课上 A 获得的成绩均小于等于 B 获得的成绩，则称 A 被 B 碾压。在 B 神的说法中，G 系共有 $K$ 位同学被他碾压（不包括他自己），而其他 $N-K-1$ 位同学则没有被他碾压。D 神查到了 B 神每门必修课的排名。\n\n这里的排名是指：如果 B 神某门课的排名为 $R$，则表示有且仅有 $R-1$ 位同学这门课的分数大于 B 神的分数，有且仅有 $N-R$ 位同学这门课的分数小于等于 B 神（不包括他自己）。\n\n我们需要求出全系所有同学每门必修课得分的情况数，使其既能满足 B 神的说法，也能符合 D 神查到的排名。这里两种情况不同当且仅当有任意一位同学在任意一门课上获得的分数不同。\n\n你不需要像 D 神那么厉害，你只需要计算出情况数模 $10^9+7$ 的余数就可以了。", "inputFormat": "第一行包含三个正整数 $N,M,K$，分别表示 G 系的同学数量（包括 B 神），必修课的数量和被 B 神碾压的同学数量。\n\n第二行包含 $M$ 个正整数，依次表示每门课的最高分 $U_i$。\n\n第三行包含 $M$ 个正整数，依次表示 B 神在每门课上的排名 $R_i$。\n\n数据保证至少有 $1$ 种情况使得 B 神说的话成立。", "outputFormat": "仅一行一个正整数，表示满足条件的情况数模 $10^9+7$ 的余数。", "hint": "$1\\leq N\\leq 100$，$1\\leq M\\leq 100$，$1\\leq U_i\\leq 10^9$，$1\\leq R_i\\leq N$。", "locale": "zh-CN"}}}
{"pid": "P3271", "type": "P", "difficulty": 6, "samples": [["2 2 4\n1 0\n1 2\n0 1\n2 1", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2016", "各省省选", "吉林", "枚举", "容斥原理"], "title": "[JLOI2016] 方", "background": null, "description": "上帝说，不要圆，要方，于是便有了这道题。\n\n由于我们应该方，而且最好能够尽量方，所以上帝派我们来找正方形。上帝把我们派到了一个有 $N$ 行 $M$ 列的方格图上，图上一共有 $(N+1)\\times(M+1)$ 个格点，我们需要做的就是找出这些格点形成了多少个正方形（换句话说，正方形的四个顶点都是格点）。\n\n但是这个问题对于我们来说太难了，因为点数太多了，所以上帝删掉了这 $(N+1)\\times(M+1)$ 中的 $K$ 个点。既然点变少了，问题也就变简单了，那么这个时候这些格点组成了多少个正方形呢？", "inputFormat": "第一行三个整数 $N, M, K$，代表棋盘的行数、 列数和不能选取的顶点个数。保证 $N, M \\ge 1$， $K \\le (N + 1) \\times(M + 1)$。\n\n约定每行的格点从上到下依次用整数 $0$ 到 $N$ 编号，每列的格点依次用 $0$ 到 $M$ 编号。\n\n接下来 $K$ 行，每行两个整数 $x,y$ 代表第 $x$ 行第 $y$ 列的格点被删掉了。\n\n保证 $0 \\le x \\le N \\le 10^6$，$0 \\le y \\le M \\le 10^6$，$K \\le 2000$ 且不会出现重复的格点。", "outputFormat": "仅一行一个正整数，代表正方形个数对 $100000007 ( 10^8 + 7)$ 取模之后的值。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2016] Square", "background": "", "description": "God said, do not be round, be square; thus this problem.\n\nSince we should be square, and preferably as square as possible, God sent us to find squares. We are placed on a grid with $N$ rows and $M$ columns, containing $(N+1)\\times(M+1)$ grid points. Our task is to count how many squares can be formed such that all four vertices are grid points.\n\nHowever, the problem is too hard because there are too many points, so God deleted $K$ of these $(N+1)\\times(M+1)$ points. With fewer points, the problem becomes easier. Now, how many squares can be formed from the remaining grid points?", "inputFormat": "The first line contains three integers $N, M, K$, representing the number of rows, the number of columns, and the number of vertices that cannot be used. It is guaranteed that $N, M \\ge 1$, $K \\le (N+1)\\times(M+1)$.\n\nWe number the rows from top to bottom by integers $0$ to $N$, and the columns from left to right by $0$ to $M$.\n\nThe next $K$ lines each contain two integers $x, y$, indicating that the grid point at row $x$, column $y$ is deleted.\n\nIt is guaranteed that $0 \\le x \\le N \\le 10^6$, $0 \\le y \\le M \\le 10^6$, $K \\le 2000$, and no grid point is repeated.", "outputFormat": "Output a single positive integer: the number of squares modulo $100000007$ ($10^8 + 7$).", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2016] 方", "background": null, "description": "上帝说，不要圆，要方，于是便有了这道题。\n\n由于我们应该方，而且最好能够尽量方，所以上帝派我们来找正方形。上帝把我们派到了一个有 $N$ 行 $M$ 列的方格图上，图上一共有 $(N+1)\\times(M+1)$ 个格点，我们需要做的就是找出这些格点形成了多少个正方形（换句话说，正方形的四个顶点都是格点）。\n\n但是这个问题对于我们来说太难了，因为点数太多了，所以上帝删掉了这 $(N+1)\\times(M+1)$ 中的 $K$ 个点。既然点变少了，问题也就变简单了，那么这个时候这些格点组成了多少个正方形呢？", "inputFormat": "第一行三个整数 $N, M, K$，代表棋盘的行数、 列数和不能选取的顶点个数。保证 $N, M \\ge 1$， $K \\le (N + 1) \\times(M + 1)$。\n\n约定每行的格点从上到下依次用整数 $0$ 到 $N$ 编号，每列的格点依次用 $0$ 到 $M$ 编号。\n\n接下来 $K$ 行，每行两个整数 $x,y$ 代表第 $x$ 行第 $y$ 列的格点被删掉了。\n\n保证 $0 \\le x \\le N \\le 10^6$，$0 \\le y \\le M \\le 10^6$，$K \\le 2000$ 且不会出现重复的格点。", "outputFormat": "仅一行一个正整数，代表正方形个数对 $100000007 ( 10^8 + 7)$ 取模之后的值。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P3272", "type": "P", "difficulty": 7, "samples": [["2 2\n*_\n__", "1"], ["3 3\n ___\n _*_\n ___", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2011", "四川", "各省省选", "O2优化", "广度优先搜索 BFS", "进制", "轮廓线 DP"], "title": "[SCOI2011] 地板", "background": "", "description": "lxhgww 的小名叫“小 L”，这是因为他总是很喜欢 L 型的东西。\n\n小 L 家的客厅是一个 $r\\times c$ 的矩形，现在他想用 L 型的地板来铺满整个客厅，客厅里有些位置有柱子，不能铺地板。\n\n现在小 L 想知道，用 L 型的地板铺满整个客厅有多少种不同的方案？\n\n需要注意的是，如下图所示，L 型地板的两端长度可以任意变化，但不能长度为 $0$。\n\n![](https://cdn.luogu.com.cn/upload/pic/4636.png)\n\n铺设完成后，客厅里面所有没有柱子的地方都必须铺上地板，但同一个地方不能被铺多次。", "inputFormat": "输入的第一行包含两个整数，$r$ 和 $c$，表示客厅的大小。\n\n接着是 $r$ 行，每行 $c$ 个字符，字符要么是 `_`，要么是 `*`，`_` 表示对应的位置是空的，必须铺地板；`*` 表示对应的位置有柱子，不能铺地板。", "outputFormat": "输出一行，包含一个整数，表示铺满整个客厅的方案数。由于这个数可能很大，只需输出它除以 $20110520$ 的余数。", "hint": "#### 数据规模与约定\n| 测试点编号 | 数据限制 |\n| :----------: | :----------: |\n| $1\\sim 2$ | $1\\le r\\times c\\le 25$ |\n| $3\\sim 5$ | $1\\le r\\times c\\le 100$ 并且 （$r=2$ 或者 $c=2$） |\n| $6\\sim 10$ | $1\\le r\\times c\\le 100$ |", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2011] Floor", "background": "", "description": "lxhgww’s nickname is “Little L” (Xiao L), because he always likes L-shaped things.\n\nLittle L’s living room is an $r\\times c$ rectangle. He wants to cover the entire living room with L-shaped tiles. Some positions contain pillars and cannot be tiled.\n\nLittle L wants to know how many different ways there are to tile the living room using L-shaped tiles.\n\nNote that, as shown in the figure below, the two arms of an L-shaped tile can have any positive lengths, but neither arm can have length $0$.\n\n![](https://cdn.luogu.com.cn/upload/pic/4636.png)\n\nAfter tiling, every position without a pillar must be covered by tiles, and no position may be covered more than once.", "inputFormat": "The first line contains two integers, $r$ and $c$, representing the size of the living room.\n\nThen follow $r$ lines, each containing $c$ characters. Each character is either `_` or `*`. `_` indicates the position is empty and must be tiled; `*` indicates the position has a pillar and cannot be tiled.", "outputFormat": "Output one line containing an integer: the number of tiling schemes. Since this number can be large, print the remainder when it is divided by $20110520$.", "hint": "#### Constraints\n| Test point ID | Limits |\n| :----------: | :----------: |\n| $1\\sim 2$ | $1\\le r\\times c\\le 25$ |\n| $3\\sim 5$ | $1\\le r\\times c\\le 100$ and ($r=2$ or $c=2$) |\n| $6\\sim 10$ | $1\\le r\\times c\\le 100$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2011] 地板", "background": "", "description": "lxhgww 的小名叫“小 L”，这是因为他总是很喜欢 L 型的东西。\n\n小 L 家的客厅是一个 $r\\times c$ 的矩形，现在他想用 L 型的地板来铺满整个客厅，客厅里有些位置有柱子，不能铺地板。\n\n现在小 L 想知道，用 L 型的地板铺满整个客厅有多少种不同的方案？\n\n需要注意的是，如下图所示，L 型地板的两端长度可以任意变化，但不能长度为 $0$。\n\n![](https://cdn.luogu.com.cn/upload/pic/4636.png)\n\n铺设完成后，客厅里面所有没有柱子的地方都必须铺上地板，但同一个地方不能被铺多次。", "inputFormat": "输入的第一行包含两个整数，$r$ 和 $c$，表示客厅的大小。\n\n接着是 $r$ 行，每行 $c$ 个字符，字符要么是 `_`，要么是 `*`，`_` 表示对应的位置是空的，必须铺地板；`*` 表示对应的位置有柱子，不能铺地板。", "outputFormat": "输出一行，包含一个整数，表示铺满整个客厅的方案数。由于这个数可能很大，只需输出它除以 $20110520$ 的余数。", "hint": "#### 数据规模与约定\n| 测试点编号 | 数据限制 |\n| :----------: | :----------: |\n| $1\\sim 2$ | $1\\le r\\times c\\le 25$ |\n| $3\\sim 5$ | $1\\le r\\times c\\le 100$ 并且 （$r=2$ 或者 $c=2$） |\n| $6\\sim 10$ | $1\\le r\\times c\\le 100$ |", "locale": "zh-CN"}}}
{"pid": "P3273", "type": "P", "difficulty": 6, "samples": [["3\n0 0 0\n8\nA1 3 -20\nA1 2 20\nU 1 3\nA2 1 10\nF1 3\nF2 3\nA3 -10\nF3", "-10\n10\n10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "四川", "线段树", "各省省选", "深度优先搜索 DFS", "连通块", "可并堆", "启发式合并"], "title": "[SCOI2011] 棘手的操作", "background": "", "description": "有 $N$ 个节点，标号从 $1$ 到 $N$，这 $N$ 个节点一开始相互不连通。第i个节点的初始权值为 $a_i$，接下来有如下一些操作：\n- `U x y`: 加一条边，连接第 $x$ 个节点和第 $y$ 个节点；\n- `A1 x v`: 将第 $x$ 个节点的权值增加 $v$；\n- `A2 x v`: 将第 $x$ 个节点所在的连通块的所有节点的权值都增加 $v$；\n- `A3 v`: 将所有节点的权值都增加 $v$；\n- `F1 x`: 输出第 $x$ 个节点当前的权值；\n- `F2 x`: 输出第 $x$ 个节点所在的连通块中，权值最大的节点的权值；\n- `F3`: 输出所有节点中，权值最大的节点的权值。", "inputFormat": "输入的第一行是一个整数 $N$，代表节点个数。接下来一行输入 $N$ 个整数，$a_1,a_2,\\dots,a_N$，代表 $N$ 个节点的初始权值。\n\n再下一行输入一个整数 $Q$，代表接下来的操作数。\n\n最后输入 $Q$ 行，每行的格式如题目描述所示。", "outputFormat": "对于操作 `F1 x`,`F2 x`,`F3`，输出对应的结果，每个结果占一行。", "hint": "对于 $30\\%$ 的数据，保证 $N\\le 100，Q\\le 10000$；\n\n对于 $80\\%$ 的数据，保证 $N\\le 100000$，$Q\\le 100000$；\n\n对于 $100\\%$ 的数据，保证 $N\\le 300000$，$Q\\le 300000$；\n\n对于所有的数据，保证输入合法，并且 $-1000\\le v,a_1,a_2,\\dots,a_N \\le 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2011] Tricky Operations", "background": "", "description": "There are $N$ nodes labeled from $1$ to $N$, initially all disconnected. The initial weight of the $i$-th node is $a_i$. Then the following operations occur:\n- `U x y`: add an edge connecting node $x$ and node $y$.\n- `A1 x v`: increase the weight of node $x$ by $v$.\n- `A2 x v`: increase the weights of all nodes in the connected component containing node $x$ by $v$.\n- `A3 v`: increase the weights of all nodes by $v$.\n- `F1 x`: output the current weight of node $x$.\n- `F2 x`: output the maximum weight within the connected component containing node $x$.\n- `F3`: output the maximum weight among all nodes.", "inputFormat": "The first line contains an integer $N$, the number of nodes. The second line contains $N$ integers $a_1,a_2,\\dots,a_N$, the initial weights of the $N$ nodes.\n\nThe next line contains an integer $Q$, the number of subsequent operations.\n\nEach of the following $Q$ lines is in one of the formats described above.", "outputFormat": "For operations `F1 x`, `F2 x`, and `F3`, output the corresponding result, one per line.", "hint": "Constraints:\n- For $30\\%$ of the testdata, $N \\le 100$, $Q \\le 10000$.\n- For $80\\%$ of the testdata, $N \\le 100000$, $Q \\le 100000$.\n- For $100\\%$ of the testdata, $N \\le 300000$, $Q \\le 300000$.\n- For all testdata, the input is guaranteed to be valid, and $-1000 \\le v, a_1, a_2, \\dots, a_N \\le 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2011] 棘手的操作", "background": "", "description": "有 $N$ 个节点，标号从 $1$ 到 $N$，这 $N$ 个节点一开始相互不连通。第i个节点的初始权值为 $a_i$，接下来有如下一些操作：\n- `U x y`: 加一条边，连接第 $x$ 个节点和第 $y$ 个节点；\n- `A1 x v`: 将第 $x$ 个节点的权值增加 $v$；\n- `A2 x v`: 将第 $x$ 个节点所在的连通块的所有节点的权值都增加 $v$；\n- `A3 v`: 将所有节点的权值都增加 $v$；\n- `F1 x`: 输出第 $x$ 个节点当前的权值；\n- `F2 x`: 输出第 $x$ 个节点所在的连通块中，权值最大的节点的权值；\n- `F3`: 输出所有节点中，权值最大的节点的权值。", "inputFormat": "输入的第一行是一个整数 $N$，代表节点个数。接下来一行输入 $N$ 个整数，$a_1,a_2,\\dots,a_N$，代表 $N$ 个节点的初始权值。\n\n再下一行输入一个整数 $Q$，代表接下来的操作数。\n\n最后输入 $Q$ 行，每行的格式如题目描述所示。", "outputFormat": "对于操作 `F1 x`,`F2 x`,`F3`，输出对应的结果，每个结果占一行。", "hint": "对于 $30\\%$ 的数据，保证 $N\\le 100，Q\\le 10000$；\n\n对于 $80\\%$ 的数据，保证 $N\\le 100000$，$Q\\le 100000$；\n\n对于 $100\\%$ 的数据，保证 $N\\le 300000$，$Q\\le 300000$；\n\n对于所有的数据，保证输入合法，并且 $-1000\\le v,a_1,a_2,\\dots,a_N \\le 1000$。", "locale": "zh-CN"}}}
{"pid": "P3274", "type": "P", "difficulty": 7, "samples": [["4 2 1\n1 2\n5 2", "2 2\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "四川", "线段树", "各省省选", "平衡树", "连通块"], "title": "[SCOI2011] 植物大战僵尸", "background": "", "description": "坚果保龄球是植物大战僵尸中的一个小游戏。现在疯狂戴夫只给了 lxhgww 一些最普通的坚果，让 lxhgww 像保龄球一样把坚果扔出去，砸死院子里的僵尸。\n\n院子一共由 $N$ 条轨道组成，从上到下依次编号从 $1$ 到 $N$，每条轨道又被分成若干格。院子里一共有 $M$ 只僵尸，每只僵尸站在某个格子内，并且可以认为它的位置不会变化。\n\n游戏可以分成 $K$ 个回合，在每个回合中，你可以选择一条轨道，把一个坚果扔出去。被扔出去的坚果首先会沿着轨道直线的从左往右滚动，直到撞到第一只僵尸之后，它开始沿着 $45$ 度的斜线滚动，并且向中心的一侧滚动（即前 $N/2$ 行的向右下滚动，后 $N/2$ 行的向右上滚动，题目保证 $N$ 是偶数）。院子的两边是围墙。斜着走的坚果撞到围墙或者僵尸会反弹，即从往右上走变成往右下走，或者反过来。直到坚果不再能打到任何僵尸之后，该回合结束。\n\n注意：多只僵尸可能站在同一格，这个时候坚果每次只会撞死该格子的其中一只僵尸。为了砸死尽量多的僵尸，现在 lxhgww 决定在每回合的开始，选择在当前情况下可以砸死最多僵尸的一条路线扔出坚果。在出现相同的情况时，他会选择编号最小的轨道扔出。\n\n为了了解这个做法的效果，现在 lxhgww 需要你帮助他计算这个方法可以砸死的僵尸数目。\n", "inputFormat": "输入的第一行有 3 个整数，$N$，$M$，$K$。接下来 $M$ 行，每行两个整数 $X_i$, $Y_i$，表示第 $i$ 个僵尸位于第 $Y_i$ 条轨道，从左数第 $X_i$ 个格子中。\n", "outputFormat": "输出数据包括 $K+1$ 行。前 $K$ 行，每行2个数据 $A_i, B_i$，表示在第 $i$ 个回合，从第 $A_i$ 条轨道扔出坚果，这个坚果在运行过程中打到了 $B_i$ 个僵尸。最后一行是一个数字，表示被打到的僵尸总数。\n", "hint": "【数据范围】\n\n对于 $20\\%$ 的数据，保证： $N\\le200$，$M\\le500$，$K\\le200$，$X_i\\le200$；\n\n对于 $50\\%$ 的数据，保证： $N\\le200$，$M\\le2\\times 10^5$，$K\\le200$，$X_i\\le10^6$；\n\n对于 $100\\%$ 的数据，保证： $N\\le20000$，$M\\le2\\times 10^5$，$K\\le10^5$，$Xi\\le10^6$。\n\n对于所有的数据，保证：$1\\le Y_i\\le N$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2011] Plants vs. Zombies", "background": "", "description": "Walnut Bowling is a minigame in Plants vs. Zombies. Now Crazy Dave only gave lxhgww some ordinary walnuts and asked lxhgww to throw them like bowling balls to smash the zombies in the yard.\n\nThe yard consists of $N$ lanes, numbered from $1$ to $N$ from top to bottom. Each lane is divided into cells. There are $M$ zombies in total, each standing in some cell, and you may assume their positions are fixed.\n\nThe game has $K$ rounds. In each round, you can choose one lane and throw a walnut. The thrown walnut first rolls straight from left to right along that lane. After it hits the first zombie, it begins to roll along a $45$-degree diagonal toward the center line of the yard (that is, in the first $N/2$ lanes it rolls down-right, and in the last $N/2$ lanes it rolls up-right; it is guaranteed that $N$ is even). The yard is bounded by walls. When a diagonally moving walnut hits a wall or a zombie, it bounces: up-right becomes down-right, or vice versa. The round ends when the walnut can no longer hit any zombie.\n\nNote: Multiple zombies may stand in the same cell; in that case, each time the walnut only kills one zombie in that cell. To kill as many zombies as possible, at the start of each round lxhgww chooses the lane whose resulting path will kill the maximum number of zombies under the current state. When there is a tie, he chooses the lane with the smallest index.\n\nTo evaluate this strategy, lxhgww needs your help to compute the number of zombies that can be killed by this method.", "inputFormat": "The first line contains three integers $N$, $M$, $K$. Then each of the next $M$ lines contains two integers $X_i$, $Y_i$, meaning that the $i$-th zombie is at lane $Y_i$, column $X_i$ (the $X_i$-th cell from the left).", "outputFormat": "Output $K+1$ lines. The first $K$ lines each contain two integers $A_i, B_i$, meaning that in the $i$-th round, the walnut is thrown from lane $A_i$ and hits $B_i$ zombies during its movement. The last line contains a single integer: the total number of zombies hit.", "hint": "Constraints\n\nFor $20\\%$ of the testdata, it is guaranteed that: $N \\le 200$, $M \\le 500$, $K \\le 200$, $X_i \\le 200$.\n\nFor $50\\%$ of the testdata, it is guaranteed that: $N \\le 200$, $M \\le 2\\times 10^5$, $K \\le 200$, $X_i \\le 10^6$.\n\nFor $100\\%$ of the testdata, it is guaranteed that: $N \\le 20000$, $M \\le 2\\times 10^5$, $K \\le 10^5$, $X_i \\le 10^6$.\n\nFor all testdata, it is guaranteed that: $1 \\le Y_i \\le N$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2011] 植物大战僵尸", "background": "", "description": "坚果保龄球是植物大战僵尸中的一个小游戏。现在疯狂戴夫只给了 lxhgww 一些最普通的坚果，让 lxhgww 像保龄球一样把坚果扔出去，砸死院子里的僵尸。\n\n院子一共由 $N$ 条轨道组成，从上到下依次编号从 $1$ 到 $N$，每条轨道又被分成若干格。院子里一共有 $M$ 只僵尸，每只僵尸站在某个格子内，并且可以认为它的位置不会变化。\n\n游戏可以分成 $K$ 个回合，在每个回合中，你可以选择一条轨道，把一个坚果扔出去。被扔出去的坚果首先会沿着轨道直线的从左往右滚动，直到撞到第一只僵尸之后，它开始沿着 $45$ 度的斜线滚动，并且向中心的一侧滚动（即前 $N/2$ 行的向右下滚动，后 $N/2$ 行的向右上滚动，题目保证 $N$ 是偶数）。院子的两边是围墙。斜着走的坚果撞到围墙或者僵尸会反弹，即从往右上走变成往右下走，或者反过来。直到坚果不再能打到任何僵尸之后，该回合结束。\n\n注意：多只僵尸可能站在同一格，这个时候坚果每次只会撞死该格子的其中一只僵尸。为了砸死尽量多的僵尸，现在 lxhgww 决定在每回合的开始，选择在当前情况下可以砸死最多僵尸的一条路线扔出坚果。在出现相同的情况时，他会选择编号最小的轨道扔出。\n\n为了了解这个做法的效果，现在 lxhgww 需要你帮助他计算这个方法可以砸死的僵尸数目。\n", "inputFormat": "输入的第一行有 3 个整数，$N$，$M$，$K$。接下来 $M$ 行，每行两个整数 $X_i$, $Y_i$，表示第 $i$ 个僵尸位于第 $Y_i$ 条轨道，从左数第 $X_i$ 个格子中。\n", "outputFormat": "输出数据包括 $K+1$ 行。前 $K$ 行，每行2个数据 $A_i, B_i$，表示在第 $i$ 个回合，从第 $A_i$ 条轨道扔出坚果，这个坚果在运行过程中打到了 $B_i$ 个僵尸。最后一行是一个数字，表示被打到的僵尸总数。\n", "hint": "【数据范围】\n\n对于 $20\\%$ 的数据，保证： $N\\le200$，$M\\le500$，$K\\le200$，$X_i\\le200$；\n\n对于 $50\\%$ 的数据，保证： $N\\le200$，$M\\le2\\times 10^5$，$K\\le200$，$X_i\\le10^6$；\n\n对于 $100\\%$ 的数据，保证： $N\\le20000$，$M\\le2\\times 10^5$，$K\\le10^5$，$Xi\\le10^6$。\n\n对于所有的数据，保证：$1\\le Y_i\\le N$。\n", "locale": "zh-CN"}}}
{"pid": "P3275", "type": "P", "difficulty": 5, "samples": [["5 7\n1 1 2\n2 3 2\n4 4 1\n3 4 5\n5 4 5\n2 3 5\n4 5 1", "11"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "2011", "四川", "各省省选", "拓扑排序", "Tarjan", "差分约束"], "title": "[SCOI2011] 糖果", "background": null, "description": "幼儿园里有 $N$ 个小朋友，$\\text{lxhgww}$ 老师现在想要给这些小朋友们分配糖果，要求每个小朋友都要分到糖果。但是小朋友们也有嫉妒心，总是会提出一些要求，比如小明不希望小红分到的糖果比他的多，于是在分配糖果的时候，$\\text{lxhgww}$ 需要满足小朋友们的 $K$ 个要求。幼儿园的糖果总是有限的，$\\text{lxhgww}$ 想知道他至少需要准备多少个糖果，才能使得每个小朋友都能够分到糖果，并且满足小朋友们所有的要求。", "inputFormat": "输入的第一行是两个整数 $N,K$。接下来 $K$ 行，每行 $3$ 个数字 $X,A,B$，表示小朋友们的要求。\n\n+ 如果 $X=1$， 表示第 $A$ 个小朋友分到的糖果必须和第 $B$ 个小朋友分到的糖果一样多；\n+ 如果 $X=2$， 表示第 $A$ 个小朋友分到的糖果必须少于第 $B$ 个小朋友分到的糖果；\n+ 如果 $X=3$， 表示第 $A$ 个小朋友分到的糖果必须不少于第 $B$ 个小朋友分到的糖果；\n+ 如果 $X=4$， 表示第 $A$ 个小朋友分到的糖果必须多于第 $B$ 个小朋友分到的糖果；\n+ 如果 $X=5$， 表示第 $A$ 个小朋友分到的糖果必须不多于第 $B$ 个小朋友分到的糖果；", "outputFormat": "输出一行一个整数，表示 $\\text{lxhgww}$ 老师至少需要准备的糖果数，如果不能满足小朋友们的所有要求，则输出 $-1$。", "hint": "对于 $30\\%$ 的数据，$N\\leq100$；\n\n对于 $100\\%$ 的数据，$1\\leq N,K\\leq10^5, 1\\leq X\\leq5, 1\\leq A, B\\leq N$。\n\n---\n\n$\\text{upd 2022.7.6}$：新添加 $21$ 组 [Hack 数据](https://www.luogu.com.cn/discuss/454051)。", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2011] Candy", "background": "", "description": "There are $N$ children in a kindergarten. Teacher $\\text{lxhgww}$ wants to distribute candies to them, and every child must receive at least one candy. However, the children can be jealous and may raise some requests. For example, Xiao Ming does not want Xiao Hong to receive more candies than he does. Therefore, when distributing candies, $\\text{lxhgww}$ needs to satisfy $K$ requests from the children. Since the total number of candies is limited, $\\text{lxhgww}$ wants to know the minimum number of candies he needs to prepare so that every child receives candies and all requests are satisfied.", "inputFormat": "The first line contains two integers $N, K$. The next $K$ lines each contain $3$ integers $X, A, B$, describing a request from the children.\n\n+ If $X=1$, the $A$-th child must receive the same number of candies as the $B$-th child.\n+ If $X=2$, the $A$-th child must receive fewer candies than the $B$-th child.\n+ If $X=3$, the $A$-th child must receive no fewer candies than the $B$-th child.\n+ If $X=4$, the $A$-th child must receive more candies than the $B$-th child.\n+ If $X=5$, the $A$-th child must receive no more candies than the $B$-th child.", "outputFormat": "Output a single integer: the minimum number of candies $\\text{lxhgww}$ needs to prepare. If it is impossible to satisfy all the requests, output $-1$.", "hint": "For $30\\%$ of the testdata, $N \\leq 100$.\n\nFor $100\\%$ of the testdata, $1 \\leq N, K \\leq 10^5$, $1 \\leq X \\leq 5$, $1 \\leq A, B \\leq N$.\n\n---\n\n$\\text{upd 2022.7.6}$: Added $21$ sets of [Hack testdata](https://www.luogu.com.cn/discuss/454051).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2011] 糖果", "background": null, "description": "幼儿园里有 $N$ 个小朋友，$\\text{lxhgww}$ 老师现在想要给这些小朋友们分配糖果，要求每个小朋友都要分到糖果。但是小朋友们也有嫉妒心，总是会提出一些要求，比如小明不希望小红分到的糖果比他的多，于是在分配糖果的时候，$\\text{lxhgww}$ 需要满足小朋友们的 $K$ 个要求。幼儿园的糖果总是有限的，$\\text{lxhgww}$ 想知道他至少需要准备多少个糖果，才能使得每个小朋友都能够分到糖果，并且满足小朋友们所有的要求。", "inputFormat": "输入的第一行是两个整数 $N,K$。接下来 $K$ 行，每行 $3$ 个数字 $X,A,B$，表示小朋友们的要求。\n\n+ 如果 $X=1$， 表示第 $A$ 个小朋友分到的糖果必须和第 $B$ 个小朋友分到的糖果一样多；\n+ 如果 $X=2$， 表示第 $A$ 个小朋友分到的糖果必须少于第 $B$ 个小朋友分到的糖果；\n+ 如果 $X=3$， 表示第 $A$ 个小朋友分到的糖果必须不少于第 $B$ 个小朋友分到的糖果；\n+ 如果 $X=4$， 表示第 $A$ 个小朋友分到的糖果必须多于第 $B$ 个小朋友分到的糖果；\n+ 如果 $X=5$， 表示第 $A$ 个小朋友分到的糖果必须不多于第 $B$ 个小朋友分到的糖果；", "outputFormat": "输出一行一个整数，表示 $\\text{lxhgww}$ 老师至少需要准备的糖果数，如果不能满足小朋友们的所有要求，则输出 $-1$。", "hint": "对于 $30\\%$ 的数据，$N\\leq100$；\n\n对于 $100\\%$ 的数据，$1\\leq N,K\\leq10^5, 1\\leq X\\leq5, 1\\leq A, B\\leq N$。\n\n---\n\n$\\text{upd 2022.7.6}$：新添加 $21$ 组 [Hack 数据](https://www.luogu.com.cn/discuss/454051)。", "locale": "zh-CN"}}}
{"pid": "P3276", "type": "P", "difficulty": 7, "samples": [["10\n2\n6\n6\n2\n6\n6", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "四川", "并查集", "各省省选", "平衡树", "数位 DP", "连通块", "进制", "分类讨论"], "title": "[SCOI2011] 镜像拆分", "background": "", "description": "lxhgww 非常喜欢数字游戏，他发现，很多数都可以表示成两个相互反转的数之和，他把这个现象称为数的“镜像拆分”。比如 $66$ 共有五种镜像拆分方法：$66=15+51=24+42=33+33=42+24=51+15$。注意，前导 0 是不允许的，所以 $66=60+06$ 不算做合法的镜像拆分。现在 lxhgww 想知道，在 K 进制下，对于在 $[A,B]$ 区间内的数，其镜像拆分的方案数之和是多少？", "inputFormat": "输入的第一行是一个数 $K$。输入的第二行是一个数 $n$，表示数字 $A$ 的长度。接下来 $n$ 行，表示 $A$ 从低位开始的每一位数字。然后是一个数 $m$，表示数字 $B$ 的长度。接下来 $m$ 行，表示 $B$ 从低位开始的每一位数字。\n", "outputFormat": "输出一行，包含一个整数，表示镜像拆分的方案数之和。由于这个答案非常大，只需要输出这个答案除以 $20110521$ 的余数。\n", "hint": "对于 $20\\%$ 的数据，保证：$2\\le K\\le100$，$1\\le n,m\\le100$。\n\n对于 $50\\%$ 的数据，保证：$2\\le K\\le1000$，$1\\le n,m\\le1000$。\n\n对于 $100\\%$ 的数据，保证：$2\\le K\\le10^5$，$1\\le n,m\\le10 ^ 5$。\n\n对于所有的数据，保证：$0\\lt A\\le B$。$A,B$ 的每一位数字都在 $[0, K-1]$ 的范围内，没有前导零。", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2011] Mirror Decomposition", "background": "", "description": "lxhgww loves number games. He discovered that many numbers can be expressed as the sum of two numbers that are reverses of each other; he calls this phenomenon a number’s “mirror decomposition”. For example, $66$ has five mirror decompositions: $66=15+51=24+42=33+33=42+24=51+15$. Note that leading zeros are not allowed, so $66=60+06$ is not counted as a valid mirror decomposition. Now lxhgww wants to know, in base $K$, for the numbers in the interval $[A,B]$, what is the sum of the counts of their mirror decompositions?", "inputFormat": "The first line of input is a number $K$. The second line is a number $n$, denoting the length of the number $A$. The next $n$ lines give each digit of $A$ starting from the least significant digit. Then comes a number $m$, denoting the length of the number $B$. The next $m$ lines give each digit of $B$ starting from the least significant digit.", "outputFormat": "Output one line containing an integer, which is the sum of the counts of mirror decompositions. Since the answer can be very large, output the remainder when this answer is divided by $20110521$.", "hint": "- For $20\\%$ of the testdata, it is guaranteed that: $2\\le K\\le100$, $1\\le n,m\\le100$.\n- For $50\\%$ of the testdata, it is guaranteed that: $2\\le K\\le1000$, $1\\le n,m\\le1000$.\n- For $100\\%$ of the testdata, it is guaranteed that: $2\\le K\\le10^5$, $1\\le n,m\\le10 ^ 5$.\n- For all the testdata, it is guaranteed that: $0\\lt A\\le B$. Each digit of $A$ and $B$ is in the range $[0, K-1]$, and there are no leading zeros.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2011] 镜像拆分", "background": "", "description": "lxhgww 非常喜欢数字游戏，他发现，很多数都可以表示成两个相互反转的数之和，他把这个现象称为数的“镜像拆分”。比如 $66$ 共有五种镜像拆分方法：$66=15+51=24+42=33+33=42+24=51+15$。注意，前导 0 是不允许的，所以 $66=60+06$ 不算做合法的镜像拆分。现在 lxhgww 想知道，在 K 进制下，对于在 $[A,B]$ 区间内的数，其镜像拆分的方案数之和是多少？", "inputFormat": "输入的第一行是一个数 $K$。输入的第二行是一个数 $n$，表示数字 $A$ 的长度。接下来 $n$ 行，表示 $A$ 从低位开始的每一位数字。然后是一个数 $m$，表示数字 $B$ 的长度。接下来 $m$ 行，表示 $B$ 从低位开始的每一位数字。\n", "outputFormat": "输出一行，包含一个整数，表示镜像拆分的方案数之和。由于这个答案非常大，只需要输出这个答案除以 $20110521$ 的余数。\n", "hint": "对于 $20\\%$ 的数据，保证：$2\\le K\\le100$，$1\\le n,m\\le100$。\n\n对于 $50\\%$ 的数据，保证：$2\\le K\\le1000$，$1\\le n,m\\le1000$。\n\n对于 $100\\%$ 的数据，保证：$2\\le K\\le10^5$，$1\\le n,m\\le10 ^ 5$。\n\n对于所有的数据，保证：$0\\lt A\\le B$。$A,B$ 的每一位数字都在 $[0, K-1]$ 的范围内，没有前导零。", "locale": "zh-CN"}}}
{"pid": "P3277", "type": "P", "difficulty": 6, "samples": [["5\n1 2 2 10 20\n1 3 2 15 25\n2 2 5 200 170", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "四川", "线段树", "并查集", "各省省选", "连通块"], "title": "[SCOI2011] 飞镖", "background": "", "description": "飞镖是在欧洲颇为流行的一项运动。它的镖盘上分为20个扇形区域，分别标有1到20的分值，每个区域中有单倍、双倍和三倍的区域，打中对应的区域会得到分值乘以倍数所对应的分数。\n\n例如打中18分里面的三倍区域，就会得到54分。\n\n另外，在镖盘的中央，还有”小红心“和”大红心“，分别是25分和50分。\n\n通常的飞镖规则还有一条，那就是在最后一镖的时候，必须以双倍结束战斗，才算获胜。也就是说，当还剩12分的时候，必须打中双倍的6才算赢，而打中单倍的12或者三倍的4则不算。\n\n特别的，”大红心“也算双倍(双倍的25)。在这样的规则下，3镖能解决的最多分数是170分(两个三倍的20，最后用大红心结束)。\n\n现在，lxhgww把原来的1到20分的分值变为了1到K分，同时把小红心的分数变为了M分(大红心是其双倍)，现在lxhgww想知道能否在3镖内（可以不一定用满3镖）解决X分。同样的，最后一镖必须是双倍（包括大红心）。\n", "inputFormat": "输入的第一行是一个整数T，包括了T组数据。\n\n第二行是5个整数，$A_1,B_1,C_1,D_1,K_1$，表示第一组数据的镖盘是从1到$K_1$分的，随后数据的镖盘由公式$K_i=(A_1K^2_{i-1}+B_1K_{i-1}+C_1)mod D_1 + 20$决定，其中第$i(1<i\\le T)$组数据的镖盘是从1到$K_i$分的。\n\n第三行是5个整数，$A_2,B_2,C_2,D_2,M_1$，表示第一组数据的小红心$M_1$分的，随后数据的镖盘由公式$M_i=(A_2M^2_{i-1}+B_2M_{i-1}+C_2)mod D_2 + 20$决定，其中第$i(1<i\\le T)$组数据的小红心是$M_i$分。\n\n\n第四行是5个整数，$A_3,B_3,C_3,D_3,X_1$，表示第一组数据需要解决的分数是$X_1$分的，随后数据的镖盘由公式$X_i=(A_3X^2_{i-1}+B_3X_{i-1}+C_3)mod D_3 + 20$决定，其中第$i(1<i\\le T)$组数据需要解决的分数是$X_i$分。\n", "outputFormat": "一行，包括一个数字，表示这T组数据中，能够被解决的数据数目。\n", "hint": "对于30%的数据，保证$1\\le T\\le 20$,$20\\le K1,M1,X1,D1,D2,D3\\le 1000$\n\n对于100%的数据，保证$1\\le T\\le 10^6$,$20\\le K1,M1,X1,D1,D2,D3\\le 10^9$\n\n对于所有的数据，保证$0\\le A1,B1,A2,B2,C2,A3,B3,C3 \\le 10^9$\n", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2011] Darts", "background": "", "description": "Darts is a popular sport in Europe. The dartboard is divided into 20 sector areas labeled 1 to 20. Each sector has single, double, and triple rings; hitting a ring yields the sector value multiplied by the corresponding multiplier.\n\nFor example, hitting the triple ring of 18 scores 54 points.\n\nIn addition, at the center of the board there are the outer bull and the inner bull, worth 25 and 50 points respectively.\n\nA common darts rule is that you must finish on a double with your last dart to win. That is, if 12 points remain, you must hit double 6 to win; hitting single 12 or triple 4 does not count.\n\nIn particular, the inner bull also counts as a double (double 25). Under these rules, the maximum score that can be finished in 3 darts is 170 (two triple 20s and finishing on the inner bull).\n\nNow, lxhgww changes the sector values from 1–20 to 1–$K$, and changes the outer bull to be worth $M$ points (the inner bull is twice that). lxhgww wants to know whether a total of $X$ points can be finished within 3 darts (you may use fewer than 3 darts). Likewise, the last dart must be a double (including the inner bull).", "inputFormat": "The first line contains an integer $T$, the number of test cases.\n\nThe second line contains 5 integers $A_1,B_1,C_1,D_1,K_1$, indicating that in the first test case the board has sectors from 1 to $K_1$. For subsequent test cases, the board parameter is determined by\n$K_i=(A_1K^2_{i-1}+B_1K_{i-1}+C_1)mod D_1 + 20$, and in the $i$-th test case ($1<i\\le T$) the board has sectors from 1 to $K_i$.\n\nThe third line contains 5 integers $A_2,B_2,C_2,D_2,M_1$, indicating that in the first test case the outer bull is worth $M_1$ points. For subsequent test cases, the value is determined by\n$M_i=(A_2M^2_{i-1}+B_2M_{i-1}+C_2)mod D_2 + 20$, and in the $i$-th test case ($1<i\\le T$) the outer bull is worth $M_i$ points.\n\nThe fourth line contains 5 integers $A_3,B_3,C_3,D_3,X_1$, indicating that in the first test case the required total is $X_1$ points. For subsequent test cases, the target is determined by\n$X_i=(A_3X^2_{i-1}+B_3X_{i-1}+C_3)mod D_3 + 20$, and in the $i$-th test case ($1<i\\le T$) the required total is $X_i$ points.", "outputFormat": "Output one line containing a single integer, the number of test cases among the $T$ that are solvable.", "hint": "For 30% of the testdata, it is guaranteed that $1 \\le T \\le 20$, $20 \\le K_1,M_1,X_1,D_1,D_2,D_3 \\le 1000$.\n\nFor 100% of the testdata, it is guaranteed that $1 \\le T \\le 10^6$, $20 \\le K_1,M_1,X_1,D_1,D_2,D_3 \\le 10^9$.\n\nFor all testdata, it is guaranteed that $0 \\le A_1,B_1,A_2,B_2,C_2,A_3,B_3,C_3 \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2011] 飞镖", "background": "", "description": "飞镖是在欧洲颇为流行的一项运动。它的镖盘上分为20个扇形区域，分别标有1到20的分值，每个区域中有单倍、双倍和三倍的区域，打中对应的区域会得到分值乘以倍数所对应的分数。\n\n例如打中18分里面的三倍区域，就会得到54分。\n\n另外，在镖盘的中央，还有”小红心“和”大红心“，分别是25分和50分。\n\n通常的飞镖规则还有一条，那就是在最后一镖的时候，必须以双倍结束战斗，才算获胜。也就是说，当还剩12分的时候，必须打中双倍的6才算赢，而打中单倍的12或者三倍的4则不算。\n\n特别的，”大红心“也算双倍(双倍的25)。在这样的规则下，3镖能解决的最多分数是170分(两个三倍的20，最后用大红心结束)。\n\n现在，lxhgww把原来的1到20分的分值变为了1到K分，同时把小红心的分数变为了M分(大红心是其双倍)，现在lxhgww想知道能否在3镖内（可以不一定用满3镖）解决X分。同样的，最后一镖必须是双倍（包括大红心）。\n", "inputFormat": "输入的第一行是一个整数T，包括了T组数据。\n\n第二行是5个整数，$A_1,B_1,C_1,D_1,K_1$，表示第一组数据的镖盘是从1到$K_1$分的，随后数据的镖盘由公式$K_i=(A_1K^2_{i-1}+B_1K_{i-1}+C_1)mod D_1 + 20$决定，其中第$i(1<i\\le T)$组数据的镖盘是从1到$K_i$分的。\n\n第三行是5个整数，$A_2,B_2,C_2,D_2,M_1$，表示第一组数据的小红心$M_1$分的，随后数据的镖盘由公式$M_i=(A_2M^2_{i-1}+B_2M_{i-1}+C_2)mod D_2 + 20$决定，其中第$i(1<i\\le T)$组数据的小红心是$M_i$分。\n\n\n第四行是5个整数，$A_3,B_3,C_3,D_3,X_1$，表示第一组数据需要解决的分数是$X_1$分的，随后数据的镖盘由公式$X_i=(A_3X^2_{i-1}+B_3X_{i-1}+C_3)mod D_3 + 20$决定，其中第$i(1<i\\le T)$组数据需要解决的分数是$X_i$分。\n", "outputFormat": "一行，包括一个数字，表示这T组数据中，能够被解决的数据数目。\n", "hint": "对于30%的数据，保证$1\\le T\\le 20$,$20\\le K1,M1,X1,D1,D2,D3\\le 1000$\n\n对于100%的数据，保证$1\\le T\\le 10^6$,$20\\le K1,M1,X1,D1,D2,D3\\le 10^9$\n\n对于所有的数据，保证$0\\le A1,B1,A2,B2,C2,A3,B3,C3 \\le 10^9$\n", "locale": "zh-CN"}}}
{"pid": "P3278", "type": "P", "difficulty": 6, "samples": [["6\nadd 0 1 7\nquery 1\nmul 0 1 7\nquery 2\nmulx 0 1\nquery 3", "14\n147\n588\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["2013", "四川", "各省省选", "平衡树"], "title": "[SCOI2013] 多项式的运算", "background": "", "description": "某天，mzry1992 一边思考着一个项目问题一边在高速公路上骑着摩托车。一个光头踢了他一脚，摩托车损坏，而他也被送进校医院打吊针。现在该项目的截止日期将近，他不得不请你来帮助他完成这个项目。\n\n\n该项目的目的是维护一个动态的关于x 的无穷多项式 ，这个多项式初始时对于所有i有$a_i = 0$。\n\n$f(x)=a_0x^0+a_1x^1+a_2x^2...$\n\n操作者可以进行四种操作：\n\n\n将$x^L$ 到$x^R$ 这些项的系数乘上某个定值v\n\n\n将$x^L$ 到$x^R$ 这些项的系数加上某个定值v\n\n\n将$x^L 到x^R $这些项乘上x变量\n\n\n将某个定值v代入多项式F(x)，并输出代入后多项式的值，之后多项式还原为代入前的状况\n\n经过观察，项目组发现使用者的操作集中在前三种，第四种操作不会出现超过10次。mzry1992 负责这个项目的核心代码，你能帮他实现么？\n", "inputFormat": "输入的第一行有一个整数n 代表操作的个数。\n\n\n接下来n 行，每行一个操作，格式如下：\n\n\nmul L R v 代表第一种操作\n\n\nadd L R v 代表第二种操作\n\n\nmulx L R 代表第三种操作\n\n\nquery v 代表第四种操作\n\n", "outputFormat": "对于每个query 操作，输出对应的答案，结果可能较大，需要模上20130426。\n", "hint": "【样例解释】\n\n操作一之后，多项式为F(x) = 7x + 7。\n\n操作三之后，多项式为F(x) = 49x + 49。\n\n操作五之后，多项式为F(x) = 49x^2 + 49x。\n\n【数据范围与约定】\n\n对于30% 的数据：N ≤ 5000，0 ≤ L ≤ R ≤ 5000，0 ≤ v ≤ 10^9\n\n\n另有20% 的数据：N ≤ 10^5，0 ≤ L ≤ R ≤ 10^5，0 ≤ v ≤ 10^9，没有mulx 操作\n\n\n剩下的50% 的数据：N ≤ 10^5，0 ≤ L ≤ R ≤ 10^5，0 ≤v ≤ 10^9\n", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2013] Polynomial Operations", "background": "", "description": "One day, while thinking about a project, mzry1992 was riding a motorcycle on the highway. A bald guy kicked him, his motorcycle broke down, and he was sent to the school hospital for an IV drip. With the deadline approaching, he has to ask you to help finish the project.\n\nThe goal of this project is to maintain a dynamic infinite polynomial in $x$. Initially, for all $i$, we have $a_i = 0$.\n\n$F(x) = a_0 x^0 + a_1 x^1 + a_2 x^2 + \\dots$.\n\nThere are four types of operations:\n\n- Multiply the coefficients of the terms from $x^L$ to $x^R$ by a fixed value $v$.\n- Add a fixed value $v$ to the coefficients of the terms from $x^L$ to $x^R$.\n- Multiply the terms from $x^L$ to $x^R$ by the variable $x$.\n- Substitute a fixed value $v$ into $F(x)$ and output the resulting value. After the query, the polynomial is restored to its previous state.\n\nAfter observation, the team found that users mainly use the first three operations, and the fourth operation appears no more than $10$ times. mzry1992 is responsible for the core code of this project. Can you help him implement it?", "inputFormat": "The first line contains an integer $n$, representing the number of operations.\n\nThen follow $n$ lines, each containing one operation in one of the following formats:\n\n- mul L R v: the first type of operation.\n- add L R v: the second type of operation.\n- mulx L R: the third type of operation.\n- query v: the fourth type of operation.", "outputFormat": "For each query operation, output the corresponding answer. Since the result may be large, print it modulo $20130426$.", "hint": "[Sample Explanation]\n\nAfter operation 1, the polynomial is $F(x) = 7 x + 7$.\n\nAfter operation 3, the polynomial is $F(x) = 49 x + 49$.\n\nAfter operation 5, the polynomial is $F(x) = 49 x^2 + 49 x$.\n\nConstraints\n\n- For $30\\%$ of the testdata: $N \\le 5000$, $0 \\le L \\le R \\le 5000$, $0 \\le v \\le 10^9$.\n- For another $20\\%$ of the testdata: $N \\le 10^5$, $0 \\le L \\le R \\le 10^5$, $0 \\le v \\le 10^9$, and there is no mulx operation.\n- For the remaining $50\\%$ of the testdata: $N \\le 10^5$, $0 \\le L \\le R \\le 10^5$, $0 \\le v \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2013] 多项式的运算", "background": "", "description": "某天，mzry1992 一边思考着一个项目问题一边在高速公路上骑着摩托车。一个光头踢了他一脚，摩托车损坏，而他也被送进校医院打吊针。现在该项目的截止日期将近，他不得不请你来帮助他完成这个项目。\n\n\n该项目的目的是维护一个动态的关于x 的无穷多项式 ，这个多项式初始时对于所有i有$a_i = 0$。\n\n$f(x)=a_0x^0+a_1x^1+a_2x^2...$\n\n操作者可以进行四种操作：\n\n\n将$x^L$ 到$x^R$ 这些项的系数乘上某个定值v\n\n\n将$x^L$ 到$x^R$ 这些项的系数加上某个定值v\n\n\n将$x^L 到x^R $这些项乘上x变量\n\n\n将某个定值v代入多项式F(x)，并输出代入后多项式的值，之后多项式还原为代入前的状况\n\n经过观察，项目组发现使用者的操作集中在前三种，第四种操作不会出现超过10次。mzry1992 负责这个项目的核心代码，你能帮他实现么？\n", "inputFormat": "输入的第一行有一个整数n 代表操作的个数。\n\n\n接下来n 行，每行一个操作，格式如下：\n\n\nmul L R v 代表第一种操作\n\n\nadd L R v 代表第二种操作\n\n\nmulx L R 代表第三种操作\n\n\nquery v 代表第四种操作\n\n", "outputFormat": "对于每个query 操作，输出对应的答案，结果可能较大，需要模上20130426。\n", "hint": "【样例解释】\n\n操作一之后，多项式为F(x) = 7x + 7。\n\n操作三之后，多项式为F(x) = 49x + 49。\n\n操作五之后，多项式为F(x) = 49x^2 + 49x。\n\n【数据范围与约定】\n\n对于30% 的数据：N ≤ 5000，0 ≤ L ≤ R ≤ 5000，0 ≤ v ≤ 10^9\n\n\n另有20% 的数据：N ≤ 10^5，0 ≤ L ≤ R ≤ 10^5，0 ≤ v ≤ 10^9，没有mulx 操作\n\n\n剩下的50% 的数据：N ≤ 10^5，0 ≤ L ≤ R ≤ 10^5，0 ≤v ≤ 10^9\n", "locale": "zh-CN"}}}
