{"pid": "P5329", "type": "P", "difficulty": 4, "samples": [["7\naabaaab", "3 7 4 5 6 1 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2019", "各省省选", "陕西"], "title": "[SNOI2019] 字符串", "background": "", "description": "给出一个长度为 $n$ 的由小写字母组成的字符串 $a$，设其中第 $i$ 个字符为 $a_i(1\\le i\\le n)$。\n\n设删掉第 $i$ 个字符之后得到的字符串为 $s_i$，请按照字典序对 $s_1,s_2,\\cdots,s_n$ 从小到大排序。若两个字符串相等，则认为编号小的字符串字典序更小。", "inputFormat": "第一行一个整数 $n$。\n\n第二行一个长为 $n$ 的由小写字母组成的字符串 $a$。", "outputFormat": "输出一行 $n$ 个整数 $k_1,k_2,\\cdots,k_n$，用空格隔开。表示 $s_{k_1}<s_{k_2}<\\cdots<s_{k_n}$。", "hint": "对于所有数据，$1\\le n\\le 10^6$。\n\n对于 10% 的数据，$1\\le n\\le 2000$；\n\n对于另外 20% 的数据，$1\\le n\\le 10^5$ 且任意两个相邻字符 $a_i,a_{i+1}$ 不相等；\n\n对于另外 30% 的数据，$1\\le n\\le 10^5$；\n\n对于余下 40% 的数据，无特殊限制。", "locale": "zh-CN", "translations": {"en": {"title": "[SNOI2019] String", "background": "", "description": "Given a string $a$ of length $n$ consisting of lowercase letters, let its $i$-th character be $a_i(1\\le i\\le n)$.\n\nLet $s_i$ be the string obtained after deleting the $i$-th character. Sort $s_1,s_2,\\cdots,s_n$ in increasing lexicographical order. If two strings are equal, then the one with the smaller index is considered lexicographically smaller.", "inputFormat": "The first line contains an integer $n$.\n\nThe second line contains a string $a$ of length $n$ consisting of lowercase letters.", "outputFormat": "Output one line with $n$ integers $k_1,k_2,\\cdots,k_n$, separated by spaces, meaning that $s_{k_1}<s_{k_2}<\\cdots<s_{k_n}$.", "hint": "Constraints: For all testdata, $1\\le n\\le 10^6$.\n\nFor $10\\%$ of the testdata, $1\\le n\\le 2000$.\n\nFor another $20\\%$ of the testdata, $1\\le n\\le 10^5$ and any two adjacent characters $a_i,a_{i+1}$ are not equal.\n\nFor another $30\\%$ of the testdata, $1\\le n\\le 10^5$.\n\nFor the remaining $40\\%$ of the testdata, there are no special constraints.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SNOI2019] 字符串", "background": "", "description": "给出一个长度为 $n$ 的由小写字母组成的字符串 $a$，设其中第 $i$ 个字符为 $a_i(1\\le i\\le n)$。\n\n设删掉第 $i$ 个字符之后得到的字符串为 $s_i$，请按照字典序对 $s_1,s_2,\\cdots,s_n$ 从小到大排序。若两个字符串相等，则认为编号小的字符串字典序更小。", "inputFormat": "第一行一个整数 $n$。\n\n第二行一个长为 $n$ 的由小写字母组成的字符串 $a$。", "outputFormat": "输出一行 $n$ 个整数 $k_1,k_2,\\cdots,k_n$，用空格隔开。表示 $s_{k_1}<s_{k_2}<\\cdots<s_{k_n}$。", "hint": "对于所有数据，$1\\le n\\le 10^6$。\n\n对于 10% 的数据，$1\\le n\\le 2000$；\n\n对于另外 20% 的数据，$1\\le n\\le 10^5$ 且任意两个相邻字符 $a_i,a_{i+1}$ 不相等；\n\n对于另外 30% 的数据，$1\\le n\\le 10^5$；\n\n对于余下 40% 的数据，无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P5330", "type": "P", "difficulty": 6, "samples": [["4 6 3 3 14\n0 1 3\n2 4 5", "4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2019", "各省省选", "陕西"], "title": "[SNOI2019] 数论", "background": "", "description": "给出正整数 $P,Q,T$ ，大小为 $n$ 的整数集 $A$ 和大小为 $m$ 的整数集 $B$ ，请你求出：\n\n$$\n\\sum_{i=0}^{T-1}[(i\\bmod P) \\in A \\land (i\\bmod Q) \\in B]\n$$\n\n\n换言之，就是问有多少个小于 $T$ 的非负整数 $x$ 满足：$x$ 除以 $P$ 的余数属于 $A$ 且 $x$ 除以 $Q$ 的余数属于 $B$。", "inputFormat": "第一行 $5$ 个用空格隔开的整数 $P,Q,n,m,T$。\n\n第二行 $n$ 个用空格隔开的整数，表示集合 $A=\\{A_1,A_2,\\cdots,A_n\\}$。保证 $A_i$ 两两不同，且 $0 \\leq A_i<P$。\n\n第三行 $m$ 个用空格隔开的整数，表示集合 $B=\\{B_1,B_2,\\cdots,B_m\\}$。保证 $B_i$ 两两不同，且 $0 \\leq B_i<Q$。\n", "outputFormat": "输出一行一个整数表示答案。", "hint": "对于所有数据，$1 \\leq n,m \\leq 10^6 , 1 \\leq P,Q \\leq 10^6 , 1 \\leq T \\leq 10^{18}$。\n\n对于10%的数据，$T \\leq 10^6$。\n\n对于另外20%的数据，$P,Q \\leq 1000$。\n\n对于另外10%的数据，$T$是$P,Q$的公倍数。\n\n对于另外10%的数据，$P,Q$互质，且$P,Q \\leq 10^5$。\n\n对于另外10%的数据，$P,Q$互质。\n\n对于另外10%的数据，$P,Q \\leq 10^5$。\n\n对于余下30%的数据，无特殊限制。\n\n- 2023.11.17 添加三组 hack 数据。", "locale": "zh-CN", "translations": {"en": {"title": "[SNOI2019] Number Theory", "background": "", "description": "Given positive integers $P, Q, T$, an integer set $A$ of size $n$, and an integer set $B$ of size $m$, please compute:\n\n$$\n\\sum_{i=0}^{T-1}[(i\\bmod P) \\in A \\land (i\\bmod Q) \\in B]\n$$\n\nIn other words, ask how many non-negative integers $x$ less than $T$ satisfy: the remainder of $x$ divided by $P$ belongs to $A$, and the remainder of $x$ divided by $Q$ belongs to $B$.", "inputFormat": "The first line contains $5$ integers separated by spaces: $P, Q, n, m, T$.\n\nThe second line contains $n$ integers separated by spaces, representing the set $A=\\{A_1,A_2,\\cdots,A_n\\}$. It is guaranteed that all $A_i$ are pairwise distinct, and $0 \\leq A_i < P$.\n\nThe third line contains $m$ integers separated by spaces, representing the set $B=\\{B_1,B_2,\\cdots,B_m\\}$. It is guaranteed that all $B_i$ are pairwise distinct, and $0 \\leq B_i < Q$.", "outputFormat": "Output one integer on a single line, denoting the answer.", "hint": "For all testdata, $1 \\leq n,m \\leq 10^6$, $1 \\leq P,Q \\leq 10^6$, and $1 \\leq T \\leq 10^{18}$.\n\nFor $10\\%$ of the testdata, $T \\leq 10^6$.\n\nFor another $20\\%$ of the testdata, $P,Q \\leq 1000$.\n\nFor another $10\\%$ of the testdata, $T$ is a common multiple of $P$ and $Q$.\n\nFor another $10\\%$ of the testdata, $P$ and $Q$ are coprime, and $P,Q \\leq 10^5$.\n\nFor another $10\\%$ of the testdata, $P$ and $Q$ are coprime.\n\nFor another $10\\%$ of the testdata, $P,Q \\leq 10^5$.\n\nFor the remaining $30\\%$ of the testdata, there are no special constraints.\n\n- 2023.11.17 Added three groups of hack testdata.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SNOI2019] 数论", "background": "", "description": "给出正整数 $P,Q,T$ ，大小为 $n$ 的整数集 $A$ 和大小为 $m$ 的整数集 $B$ ，请你求出：\n\n$$\n\\sum_{i=0}^{T-1}[(i\\bmod P) \\in A \\land (i\\bmod Q) \\in B]\n$$\n\n\n换言之，就是问有多少个小于 $T$ 的非负整数 $x$ 满足：$x$ 除以 $P$ 的余数属于 $A$ 且 $x$ 除以 $Q$ 的余数属于 $B$。", "inputFormat": "第一行 $5$ 个用空格隔开的整数 $P,Q,n,m,T$。\n\n第二行 $n$ 个用空格隔开的整数，表示集合 $A=\\{A_1,A_2,\\cdots,A_n\\}$。保证 $A_i$ 两两不同，且 $0 \\leq A_i<P$。\n\n第三行 $m$ 个用空格隔开的整数，表示集合 $B=\\{B_1,B_2,\\cdots,B_m\\}$。保证 $B_i$ 两两不同，且 $0 \\leq B_i<Q$。\n", "outputFormat": "输出一行一个整数表示答案。", "hint": "对于所有数据，$1 \\leq n,m \\leq 10^6 , 1 \\leq P,Q \\leq 10^6 , 1 \\leq T \\leq 10^{18}$。\n\n对于10%的数据，$T \\leq 10^6$。\n\n对于另外20%的数据，$P,Q \\leq 1000$。\n\n对于另外10%的数据，$T$是$P,Q$的公倍数。\n\n对于另外10%的数据，$P,Q$互质，且$P,Q \\leq 10^5$。\n\n对于另外10%的数据，$P,Q$互质。\n\n对于另外10%的数据，$P,Q \\leq 10^5$。\n\n对于余下30%的数据，无特殊限制。\n\n- 2023.11.17 添加三组 hack 数据。", "locale": "zh-CN"}}}
{"pid": "P5331", "type": "P", "difficulty": 7, "samples": [["6 7\n8 4 6 1 3 0", "23"], ["8 4\n0 4 2 6 1 5 3 7", "18"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "网络流", "cdq 分治", "图论建模", "陕西", "费用流"], "title": "[SNOI2019] 通信", "background": "", "description": "$n$ 个排成一列的哨站要进行通信。第 $i$ 个哨站的频段为 $a_i$。\n\n每个哨站 $i$ 需要选择以下二者之一：\n\n1. 直接连接到控制中心，代价为 $W$；\n2. 连接到前面的某个哨站 $j$ ($j<i$)，代价为 $|a_i-a_j|$。\n每个哨站只能被后面的至多一个哨站连接。\n\n请你求出最小可能的代价和。", "inputFormat": "第 $1$ 行两个自然数 $n,W$，分别表示哨站个数和连接到控制中心的代价；\n\n第 $2$ 行 $n$ 个由空格分隔的自然数 $a_1,a_2,\\ldots,a_n$ 依次表示每个哨站的频段。", "outputFormat": "输出 $1$ 行 $1$ 个自然数表示答案。", "hint": "对于所有数据，$1 \\leq n \\leq 1000$，$0 \\leq W,a_i \\leq 10^9$。\n\n对于 $10\\%$ 的数据，$n \\leq 10$；\n\n对于另外 $10\\%$ 的数据，$n \\leq 20$；\n\n对于另外 $20\\%$ 的数据，$n \\leq 50$，$W \\leq 5$，$a_i \\leq 4$；\n\n对于另外 $20\\%$ 的数据，$n \\leq 100$；\n\n对于另外 $20\\%$ 的数据，$n \\leq 300$；\n\n对于余下 $20\\%$ 的数据，无特殊限制。", "locale": "zh-CN", "translations": {"en": {"title": "[SNOI2019] Communication", "background": "", "description": "There are $n$ sentry stations arranged in a line. The frequency band of station $i$ is $a_i$.\n\nEach station $i$ needs to choose one of the following two options:\n\n1. Connect directly to the control center, with a cost of $W$.\n2. Connect to some previous station $j$ ($j<i$), with a cost of $|a_i-a_j|$.\n\nEach station can be connected by at most one later station.\n\nPlease find the minimum possible total cost.", "inputFormat": "The first line contains two non-negative integers $n, W$, representing the number of sentry stations and the cost to connect to the control center.\n\nThe second line contains $n$ non-negative integers $a_1, a_2, \\ldots, a_n$ separated by spaces, representing the frequency band of each station in order.", "outputFormat": "Output one line containing one non-negative integer, representing the answer.", "hint": "For all testdata, $1 \\leq n \\leq 1000$, $0 \\leq W, a_i \\leq 10^9$.\n\nFor $10\\%$ of the testdata, $n \\leq 10$.\n\nFor another $10\\%$ of the testdata, $n \\leq 20$.\n\nFor another $20\\%$ of the testdata, $n \\leq 50$, $W \\leq 5$, $a_i \\leq 4$.\n\nFor another $20\\%$ of the testdata, $n \\leq 100$.\n\nFor another $20\\%$ of the testdata, $n \\leq 300$.\n\nFor the remaining $20\\%$ of the testdata, there are no special constraints.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SNOI2019] 通信", "background": "", "description": "$n$ 个排成一列的哨站要进行通信。第 $i$ 个哨站的频段为 $a_i$。\n\n每个哨站 $i$ 需要选择以下二者之一：\n\n1. 直接连接到控制中心，代价为 $W$；\n2. 连接到前面的某个哨站 $j$ ($j<i$)，代价为 $|a_i-a_j|$。\n每个哨站只能被后面的至多一个哨站连接。\n\n请你求出最小可能的代价和。", "inputFormat": "第 $1$ 行两个自然数 $n,W$，分别表示哨站个数和连接到控制中心的代价；\n\n第 $2$ 行 $n$ 个由空格分隔的自然数 $a_1,a_2,\\ldots,a_n$ 依次表示每个哨站的频段。", "outputFormat": "输出 $1$ 行 $1$ 个自然数表示答案。", "hint": "对于所有数据，$1 \\leq n \\leq 1000$，$0 \\leq W,a_i \\leq 10^9$。\n\n对于 $10\\%$ 的数据，$n \\leq 10$；\n\n对于另外 $10\\%$ 的数据，$n \\leq 20$；\n\n对于另外 $20\\%$ 的数据，$n \\leq 50$，$W \\leq 5$，$a_i \\leq 4$；\n\n对于另外 $20\\%$ 的数据，$n \\leq 100$；\n\n对于另外 $20\\%$ 的数据，$n \\leq 300$；\n\n对于余下 $20\\%$ 的数据，无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P5332", "type": "P", "difficulty": 7, "samples": [["3 3 2\n0 2 1 3\n1 1 2 3", "2 1 1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000]}, "tags": ["2019", "各省省选", "江苏", "O2优化", "2-SAT"], "title": "[JSOI2019] 精准预测", "background": "JYY 和他的火星探险队再次登录火星小镇，并且打算把机器学习的知识传授给火星人，从而提高火星人的生活效率。但智力有限的火星人纷纷表示不相信计算机科学。为了让火星人彻底信服，JYY 的探险队找到了他们之前关于火星详细的数据记录，并且训练了一个预测模型，这个模型能准确地预测出火星人在未来的生死情况。", "description": "目前，火星小镇上有$n$个居民（编号$1,2,……,n$）。机器学习算法预测出这些居民在接下来$T$个时刻（编号$1,2,……,T$）的生死情况，每条预测都是如下两种形式之一：\n\n- 难兄难弟$0$ $t$ $x$ $y$：在$t$时刻，如果$x$是死亡状态，那么在$t+1$时刻，$y$是死亡状态。（注意，当$x$在$t$时刻是生存状态时，该预测也被认为是正确的）；\n\n- 死神来了$1$ $t$ $x$ $y$：在$t$时刻，如果$x$是生存状态，那么在$t$时刻，$y$是死亡状态。（注意，当$x$在$t$时刻是死亡状态时，该预测也被认为是正确的）。\n\n注意本题是对某个时刻进行生死状态的预测，如果某个人在$t$时刻是生存状态，在$t+1$时刻是死亡状态，你可以认为是在$t$到$t+1$这段时间内发生了某个事件导致其死亡。\n\n虽然 JYY 对自己从大数据中统计得到的模型非常自信，但火星人看到这些预测吓了一跳，表示实在难以接受这种设定，更是认为计算机科学是可怕的邪教，打破了他们平静的生活。为了安抚火星人的情绪， JYY 打算从这些预测结果中推导出一些火星人更容易接受的事实，从而安抚火星人的情绪。\n\n具体来说，JYY 首先假设对火星人生死的预测全部正确，在此基础上，JYY 希望为小镇上的每个居民$k$分别计算有多少个火星人有可能和他一起活到第$T+1$时刻，换言之，JYY 希望为每个火星人$k$计算\n\n$$\\sum_{1 \\leq i \\leq n,i \\neq k} \\operatorname{Live}(k,i)$$\n\n其中 $\\operatorname{Live}(i,j)=1$ 表示编号为$i$和$j$的火星人有可能同时在第 $T+1$ 时刻处于生还状态，否则$\\operatorname{Live}(i,j)=0$。\n\n注意火星人是不能够复活的。一个火星人可能在时刻$1$就处于死亡状态，也有可能有预测未覆盖的死亡情况发生（火星人在任何时候都可能死亡，但任意时刻观察到火星人的状态要么活着，要么死亡）。最后，注意到$\\operatorname{Live}$是为每一对火星人分别独立计算的，因此$\\operatorname{Live}(x,y)=1,\\operatorname{Live}(y,z)=1$并不意味着$\\operatorname{Live}(x,z)=1$。", "inputFormat": "输入第一行包含三个整数$T,n,m$。\n接下来有$m$行，每行表示一条预言，每条预言第一个整数$c$表示预言的类型：\n\n- $c=0$：接下来读入$t,x,y$；\n\n- $c=1$：接下来读入$t,x,y$。", "outputFormat": "输出$n$个数表示答案，用空格分割。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/57734.png)", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2019] Accurate Prediction", "background": "JYY and his Mars exploration team have landed in the Mars town again. They plan to teach the Martians knowledge about machine learning to improve their life efficiency. However, the Martians, with limited intelligence, say they do not believe in computer science. To fully convince them, JYY's team found detailed historical records about Mars and trained a prediction model. This model can accurately predict whether Martians will live or die in the future.", "description": "Currently, there are $n$ residents in the Mars town (numbered $1,2,\\ldots,n$). A machine learning algorithm predicts the life-or-death status of these residents over the next $T$ moments (numbered $1,2,\\ldots,T$). Each prediction is one of the following two types:\n\n- Brothers in Misfortune $0$ $t$ $x$ $y$: At moment $t$, if $x$ is dead, then at moment $t+1$, $y$ is dead. (Note that if $x$ is alive at moment $t$, this prediction is also considered correct.)\n\n- Death God Arrives $1$ $t$ $x$ $y$: At moment $t$, if $x$ is alive, then at moment $t$, $y$ is dead. (Note that if $x$ is dead at moment $t$, this prediction is also considered correct.)\n\nNote that this problem is predicting the life-or-death status at a specific moment. If someone is alive at moment $t$ and dead at moment $t+1$, you may assume that some event happened during the time interval from $t$ to $t+1$ that caused their death.\n\nAlthough JYY is very confident in the model obtained from big data statistics, the Martians are shocked by these predictions and feel it is hard to accept such a setting. They even think computer science is a scary cult that has broken their peaceful life. To calm the Martians down, JYY plans to derive some facts from these prediction results that are easier for the Martians to accept.\n\nSpecifically, JYY first assumes that all predictions about the Martians' life and death are correct. Based on this, JYY wants to compute, for each resident $k$, how many Martians might be able to live together with him until moment $T+1$. In other words, for each Martian $k$, JYY wants to compute\n\n$$\\sum_{1 \\leq i \\leq n,i \\neq k} \\operatorname{Live}(k,i)$$\n\nwhere $\\operatorname{Live}(i,j)=1$ means that Martians $i$ and $j$ may possibly both be alive at moment $T+1$; otherwise, $\\operatorname{Live}(i,j)=0$.\n\nNote that Martians cannot be resurrected. A Martian may already be dead at moment $1$, and there may also be deaths not covered by any prediction (a Martian can die at any time, but at any moment, a Martian's observed state is either alive or dead). Finally, note that $\\operatorname{Live}$ is computed independently for each pair of Martians, so $\\operatorname{Live}(x,y)=1$ and $\\operatorname{Live}(y,z)=1$ does not imply $\\operatorname{Live}(x,z)=1$.", "inputFormat": "The first line contains three integers $T,n,m$.\nThe next $m$ lines each describe a prophecy. The first integer $c$ of each prophecy indicates its type:\n\n- $c=0$: then read $t,x,y$;\n\n- $c=1$: then read $t,x,y$.", "outputFormat": "Output $n$ numbers as the answers, separated by spaces.", "hint": "![](https://cdn.luogu.com.cn/upload/pic/57734.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2019] 精准预测", "background": "JYY 和他的火星探险队再次登录火星小镇，并且打算把机器学习的知识传授给火星人，从而提高火星人的生活效率。但智力有限的火星人纷纷表示不相信计算机科学。为了让火星人彻底信服，JYY 的探险队找到了他们之前关于火星详细的数据记录，并且训练了一个预测模型，这个模型能准确地预测出火星人在未来的生死情况。", "description": "目前，火星小镇上有$n$个居民（编号$1,2,……,n$）。机器学习算法预测出这些居民在接下来$T$个时刻（编号$1,2,……,T$）的生死情况，每条预测都是如下两种形式之一：\n\n- 难兄难弟$0$ $t$ $x$ $y$：在$t$时刻，如果$x$是死亡状态，那么在$t+1$时刻，$y$是死亡状态。（注意，当$x$在$t$时刻是生存状态时，该预测也被认为是正确的）；\n\n- 死神来了$1$ $t$ $x$ $y$：在$t$时刻，如果$x$是生存状态，那么在$t$时刻，$y$是死亡状态。（注意，当$x$在$t$时刻是死亡状态时，该预测也被认为是正确的）。\n\n注意本题是对某个时刻进行生死状态的预测，如果某个人在$t$时刻是生存状态，在$t+1$时刻是死亡状态，你可以认为是在$t$到$t+1$这段时间内发生了某个事件导致其死亡。\n\n虽然 JYY 对自己从大数据中统计得到的模型非常自信，但火星人看到这些预测吓了一跳，表示实在难以接受这种设定，更是认为计算机科学是可怕的邪教，打破了他们平静的生活。为了安抚火星人的情绪， JYY 打算从这些预测结果中推导出一些火星人更容易接受的事实，从而安抚火星人的情绪。\n\n具体来说，JYY 首先假设对火星人生死的预测全部正确，在此基础上，JYY 希望为小镇上的每个居民$k$分别计算有多少个火星人有可能和他一起活到第$T+1$时刻，换言之，JYY 希望为每个火星人$k$计算\n\n$$\\sum_{1 \\leq i \\leq n,i \\neq k} \\operatorname{Live}(k,i)$$\n\n其中 $\\operatorname{Live}(i,j)=1$ 表示编号为$i$和$j$的火星人有可能同时在第 $T+1$ 时刻处于生还状态，否则$\\operatorname{Live}(i,j)=0$。\n\n注意火星人是不能够复活的。一个火星人可能在时刻$1$就处于死亡状态，也有可能有预测未覆盖的死亡情况发生（火星人在任何时候都可能死亡，但任意时刻观察到火星人的状态要么活着，要么死亡）。最后，注意到$\\operatorname{Live}$是为每一对火星人分别独立计算的，因此$\\operatorname{Live}(x,y)=1,\\operatorname{Live}(y,z)=1$并不意味着$\\operatorname{Live}(x,z)=1$。", "inputFormat": "输入第一行包含三个整数$T,n,m$。\n接下来有$m$行，每行表示一条预言，每条预言第一个整数$c$表示预言的类型：\n\n- $c=0$：接下来读入$t,x,y$；\n\n- $c=1$：接下来读入$t,x,y$。", "outputFormat": "输出$n$个数表示答案，用空格分割。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/57734.png)", "locale": "zh-CN"}}}
{"pid": "P5333", "type": "P", "difficulty": 7, "samples": [["2\n3\n1 2\n1 3\n2\n1 2", "12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "江苏", "O2优化"], "title": "[JSOI2019] 神经网络", "background": "火星探险队发现，火星人的思维方式与人类非常不同，是因为他们拥有与人类很不一样的神经网络结构。为了更好地理解火星人的行为模式，JYY 对小镇上火星人的大脑进行了扫描，得到了一些重要数据。", "description": "火星人在出生后，神经网络可以看作是一个由若干无向树 $\\{T_1(V_1, E_1), T_2(V_2, E_2),\\ldots T_m(V_m, E_m)\\}$ 构成的森林。随着火星人年龄的增长，神经连接的数量也不断增长。初始时，神经网络中生长的连接 $E^\\ast = \\varnothing$。神经网络根据如下规则生长：\n- 如果节点 $u \\in V_i, v \\in V_j$ 分别属于不同的无向树 $T_i$ 和 $T_j$（$i \\neq j$），则 $E^\\ast$ 中应当包含边 $(u, v)$。\n\n最终，在不再有神经网络连接可能生长后，神经网络之间的节点连接可以看成是一个无向图 $G(V,E)$，其中\n\n$$V=V_1\\cup V_2\\cup \\ldots \\cup V_m,E=E_1\\cup E_2\\cup \\ldots \\cup E_m\\cup E^\\ast$$\n\n火星人的决策是通过在 $G(V, E)$ 中建立环路完成的。针对不同的外界输入，火星人会建立不同的神经连接环路，从而做出不同的响应。为了了解火星人行为模式的复杂性，JYY 决定计算 $G$ **中哈密顿回路的数量**。\n\n$G(V, E)$ 的哈密顿回路是一条简单回路，从第一棵树的第一个节点出发，恰好经过 $V$ 中的其他节点一次且仅一次，并且回到第一棵树的第一个节点。", "inputFormat": "第一行读入 $m$，表示火星人神经网络初始时无向树的数量。  \n接下来输入有 $m$ 部分，第 $i$ 部分描述了树 $T_i$。  \n对于 $T_i$，输入的第一行是树 $T_i(V_i, E_i)$ 中节点的数量 $k_i$。假设 $V_i = \\{v_1, v_2,\\ldots ,v_{k_i}\\}$。  \n接下来 $k_{i} - 1$ 行，每行两个整数 $x, y$，表示该树节点 $v_x, v_y$（$1 \\le x, y \\le k_i$）之间有一条树边，即 $(v_x, v_y) \\in E_i$。", "outputFormat": "因为哈密顿回路的数量可能很多，你只需要输出一个非负整数，表示答案对 $998244353$ 取模后的值。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/57736.png)", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2019] Neural Network", "background": "The Mars exploration team discovered that Martians think very differently from humans because they have a very different neural network structure. To better understand Martian behavior patterns, JYY scanned the brains of Martians in a small town and obtained some important data.", "description": "After a Martian is born, its neural network can be seen as a forest consisting of several undirected trees $\\{T_1(V_1, E_1), T_2(V_2, E_2),\\ldots T_m(V_m, E_m)\\}$. As the Martian grows older, the number of neural connections keeps increasing. Initially, the set of newly grown connections in the neural network is $E^\\ast = \\varnothing$. The neural network grows according to the following rule:\n- If nodes $u \\in V_i$ and $v \\in V_j$ belong to different undirected trees $T_i$ and $T_j$ respectively ($i \\neq j$), then $E^\\ast$ should contain the edge $(u, v)$.\n\nFinally, after no more neural network connections can grow, the connections between nodes in the neural network can be regarded as an undirected graph $G(V,E)$, where\n\n$$V=V_1\\cup V_2\\cup \\ldots \\cup V_m,E=E_1\\cup E_2\\cup \\ldots \\cup E_m\\cup E^\\ast$$\n\nMartians make decisions by creating cycles in $G(V, E)$. For different external inputs, Martians will create different neural connection cycles and thus produce different responses. To understand how complex Martian behavior patterns are, JYY decides to compute the **number of Hamiltonian cycles in $G$**.\n\nA Hamiltonian cycle of $G(V, E)$ is a simple cycle that starts from the first node of the first tree, visits every other node in $V$ exactly once, and then returns to the first node of the first tree.", "inputFormat": "The first line contains $m$, the number of undirected trees in the Martian neural network at the beginning.  \nThen there are $m$ parts, where the $i$-th part describes the tree $T_i$.  \nFor $T_i$, the first line contains $k_i$, the number of nodes in the tree $T_i(V_i, E_i)$. Assume $V_i = \\{v_1, v_2,\\ldots ,v_{k_i}\\}$.  \nIn the next $k_i - 1$ lines, each line contains two integers $x, y$, meaning there is a tree edge between nodes $v_x$ and $v_y$ ($1 \\le x, y \\le k_i$), i.e., $(v_x, v_y) \\in E_i$.", "outputFormat": "Since the number of Hamiltonian cycles can be very large, output a non-negative integer equal to the answer modulo $998244353$.", "hint": "![](https://cdn.luogu.com.cn/upload/pic/57736.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2019] 神经网络", "background": "火星探险队发现，火星人的思维方式与人类非常不同，是因为他们拥有与人类很不一样的神经网络结构。为了更好地理解火星人的行为模式，JYY 对小镇上火星人的大脑进行了扫描，得到了一些重要数据。", "description": "火星人在出生后，神经网络可以看作是一个由若干无向树 $\\{T_1(V_1, E_1), T_2(V_2, E_2),\\ldots T_m(V_m, E_m)\\}$ 构成的森林。随着火星人年龄的增长，神经连接的数量也不断增长。初始时，神经网络中生长的连接 $E^\\ast = \\varnothing$。神经网络根据如下规则生长：\n- 如果节点 $u \\in V_i, v \\in V_j$ 分别属于不同的无向树 $T_i$ 和 $T_j$（$i \\neq j$），则 $E^\\ast$ 中应当包含边 $(u, v)$。\n\n最终，在不再有神经网络连接可能生长后，神经网络之间的节点连接可以看成是一个无向图 $G(V,E)$，其中\n\n$$V=V_1\\cup V_2\\cup \\ldots \\cup V_m,E=E_1\\cup E_2\\cup \\ldots \\cup E_m\\cup E^\\ast$$\n\n火星人的决策是通过在 $G(V, E)$ 中建立环路完成的。针对不同的外界输入，火星人会建立不同的神经连接环路，从而做出不同的响应。为了了解火星人行为模式的复杂性，JYY 决定计算 $G$ **中哈密顿回路的数量**。\n\n$G(V, E)$ 的哈密顿回路是一条简单回路，从第一棵树的第一个节点出发，恰好经过 $V$ 中的其他节点一次且仅一次，并且回到第一棵树的第一个节点。", "inputFormat": "第一行读入 $m$，表示火星人神经网络初始时无向树的数量。  \n接下来输入有 $m$ 部分，第 $i$ 部分描述了树 $T_i$。  \n对于 $T_i$，输入的第一行是树 $T_i(V_i, E_i)$ 中节点的数量 $k_i$。假设 $V_i = \\{v_1, v_2,\\ldots ,v_{k_i}\\}$。  \n接下来 $k_{i} - 1$ 行，每行两个整数 $x, y$，表示该树节点 $v_x, v_y$（$1 \\le x, y \\le k_i$）之间有一条树边，即 $(v_x, v_y) \\in E_i$。", "outputFormat": "因为哈密顿回路的数量可能很多，你只需要输出一个非负整数，表示答案对 $998244353$ 取模后的值。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/57736.png)", "locale": "zh-CN"}}}
{"pid": "P5334", "type": "P", "difficulty": 7, "samples": [["abaacaba", "1 1 3 3 3 6 3 8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "江苏", "O2优化"], "title": "[JSOI2019] 节日庆典", "background": "JYY 和探险队顺利完成了火星上的任务。在离开前，探险队正好赶上了火星人一年一度最盛大的节日「气球节」。然而，火星人遇到了每年一度的麻烦：怎样最美观地摆放气球。JYY 决定请你设计算法帮助火星人解决这个问题。", "description": "在庆典开始前，火星人会把气球准备好并串在一根绳子上。气球按顺序排列可以看成是一个由小写字母组成的长度为$n$的字符串$S$。然后，火星人会按照字符串的顺序逐个把气球加入到一个庆典的圆环上，并且表演一个节目庆祝。\n\n下图展示了一串气球 **cbbadbcd** 在进行到第$5$个节目时的情形，此时在庆典环上的气球是 **cbbad**。\n\n![](https://cdn.luogu.com.cn/upload/pic/57738.png)\n\n为了让每个节目都更好看，火星人希望在每个节目开始前调整气球在环上的顺序，使得每个节目的气球排布都最美观。对于一组气球（一个字符串），火星人认为最美观的字符串是庆典圆环上按绳子方向读出**字典序最小的字符串**，例如对于 **cbbad**，共有$5$个读出字符串的位置：\n\n- cbbad （$i=1$）；\n\n- bbadc （$i=2$）；\n\n- badcb （$i=3$）；\n\n- adcbb （$i=4$）；\n\n- dcbba （$i=5$）。\n\n如果有多个字典序最小的字符串，火星人希望找出**离绳头最近**的那个(即最小的那个)。更严谨地说，对于字符串，定义\n\n$$T_i=T[i……|T|]::T[1……i-1](1 \\leq i \\leq |T|)$$\n\n其中$::$是字符串的拼接操作。定义$f(T)$为最小的$i$（$1 \\leq i \\leq |T|$）满足$T_i=min(T_1,T_2,……,T_{|T|})$。\n\nJYY希望你帮助他设计一个算法，让火星人每个节目的气球排列都最美观，即对于给定字符串$S$的每一个前缀$S[1……i]$（$1 \\leq i \\leq |S|$），求出$f(S[1……i])$。", "inputFormat": "输入只有一行，该行包括一个字符串$S$。", "outputFormat": "在一行中对于每个$i$（$1 \\leq i \\leq |S|$），输出一个整数$f(S[1……i])$。输出的数字之间以空格分隔。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/57739.png)", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2019] Festival Celebration", "background": "JYY and the expedition team successfully completed their mission on Mars. Before leaving, the team happened to catch the Martians’ biggest annual festival, the “Balloon Festival”. However, the Martians face a yearly problem: how to arrange the balloons in the most visually pleasing way. JYY decides to ask you to design an algorithm to help the Martians solve this problem.", "description": "Before the celebration begins, the Martians prepare the balloons and string them onto a rope. The balloons, in order, can be seen as a string $S$ of length $n$ consisting of lowercase letters. Then, the Martians will add the balloons one by one, following the order of the string, onto a circular ring for the celebration, and perform a show to celebrate.\n\nThe figure below shows the situation for the balloon string **cbbadbcd** at the $5$-th show. At this time, the balloons on the celebration ring are **cbbad**.\n\n![](https://cdn.luogu.com.cn/upload/pic/57738.png)\n\nTo make each show look better, the Martians want to adjust the order of the balloons on the ring before each show starts, so that the balloon arrangement for each show is the most visually pleasing. For a set of balloons (a string), the Martians define the most visually pleasing string as the **lexicographically smallest string** read along the rope direction on the celebration ring. For example, for **cbbad**, there are $5$ possible starting positions to read the string:\n\n- cbbad ($i=1$).\n\n- bbadc ($i=2$).\n\n- badcb ($i=3$).\n\n- adcbb ($i=4$).\n\n- dcbba ($i=5$).\n\nIf there are multiple lexicographically smallest strings, the Martians want the one **closest to the rope head** (i.e. the smallest $i$). More rigorously, for a string $T$, define\n\n$$T_i=T[i……|T|]::T[1……i-1](1 \\leq i \\leq |T|)$$\n\nwhere $::$ denotes string concatenation. Define $f(T)$ as the smallest $i$ ($1 \\leq i \\leq |T|$) such that $T_i=min(T_1,T_2,……,T_{|T|})$.\n\nJYY hopes you can help him design an algorithm so that the balloon arrangement for each show is the most visually pleasing. That is, for every prefix $S[1……i]$ ($1 \\leq i \\leq |S|$) of the given string $S$, compute $f(S[1……i])$.", "inputFormat": "There is only one line of input, containing a string $S$.", "outputFormat": "In one line, for each $i$ ($1 \\leq i \\leq |S|$), output an integer $f(S[1……i])$. Separate the numbers with spaces.", "hint": "![](https://cdn.luogu.com.cn/upload/pic/57739.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2019] 节日庆典", "background": "JYY 和探险队顺利完成了火星上的任务。在离开前，探险队正好赶上了火星人一年一度最盛大的节日「气球节」。然而，火星人遇到了每年一度的麻烦：怎样最美观地摆放气球。JYY 决定请你设计算法帮助火星人解决这个问题。", "description": "在庆典开始前，火星人会把气球准备好并串在一根绳子上。气球按顺序排列可以看成是一个由小写字母组成的长度为$n$的字符串$S$。然后，火星人会按照字符串的顺序逐个把气球加入到一个庆典的圆环上，并且表演一个节目庆祝。\n\n下图展示了一串气球 **cbbadbcd** 在进行到第$5$个节目时的情形，此时在庆典环上的气球是 **cbbad**。\n\n![](https://cdn.luogu.com.cn/upload/pic/57738.png)\n\n为了让每个节目都更好看，火星人希望在每个节目开始前调整气球在环上的顺序，使得每个节目的气球排布都最美观。对于一组气球（一个字符串），火星人认为最美观的字符串是庆典圆环上按绳子方向读出**字典序最小的字符串**，例如对于 **cbbad**，共有$5$个读出字符串的位置：\n\n- cbbad （$i=1$）；\n\n- bbadc （$i=2$）；\n\n- badcb （$i=3$）；\n\n- adcbb （$i=4$）；\n\n- dcbba （$i=5$）。\n\n如果有多个字典序最小的字符串，火星人希望找出**离绳头最近**的那个(即最小的那个)。更严谨地说，对于字符串，定义\n\n$$T_i=T[i……|T|]::T[1……i-1](1 \\leq i \\leq |T|)$$\n\n其中$::$是字符串的拼接操作。定义$f(T)$为最小的$i$（$1 \\leq i \\leq |T|$）满足$T_i=min(T_1,T_2,……,T_{|T|})$。\n\nJYY希望你帮助他设计一个算法，让火星人每个节目的气球排列都最美观，即对于给定字符串$S$的每一个前缀$S[1……i]$（$1 \\leq i \\leq |S|$），求出$f(S[1……i])$。", "inputFormat": "输入只有一行，该行包括一个字符串$S$。", "outputFormat": "在一行中对于每个$i$（$1 \\leq i \\leq |S|$），输出一个整数$f(S[1……i])$。输出的数字之间以空格分隔。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/57739.png)", "locale": "zh-CN"}}}
{"pid": "P5335", "type": "P", "difficulty": 4, "samples": [["8\n1 jead\n1 dec\n3 de 0 0 10\n1 dec\n3 de 0 1 10\n2 dec\n3 de 0 1 10\n3 de 0 2 10", "2\n4\n4\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2016", "哈希 hashing", "字典树 Trie", "THUSC"], "title": "[THUSC 2016] 补退选", "background": null, "description": "X 是 T 大的一名老师，每年他都要教授许多学生基础的 C++ 知识。在 T 大，每个学生在每学期的开学前都需要选课，每次选课一共分为三个阶段：预选，正选，补退选；其中「补退选」阶段最忙碌。\n\n在补退选阶段，学生即可以选课，也可以退课。对于X老师来说，在补退选阶段可能发生以下两种事件：\n\n1. 一个姓名为 $S$ 的学生选了他的课（姓名将出现在 X 的已选课学生名单中）            \n2. 一个姓名为 $S$ 的学生退了他的课（姓名将从 X 的已选课学生名单中移除）\n\n同时，X 老师对于有哪些学生选了他的课非常关心，所以他会不定时的查询已选课学生名单，每次查询最早在哪个事件之后，姓名以 $S$ 为前缀的学生数量超过了 $v$。\n\nX 老师看你骨骼惊奇，所以想用这个问题考考你，你当然不会畏惧，所以勇敢的接下了这个任务。\n\n**注意 1：学生的姓名可能相同，如果有 $p$ 个姓名相同的学生都选了 X 老师的课，则他们的姓名将出现在 X 老师的名单上 $p$ 次。**\n\n**注意 2：只有已经选了课的学生才会退课，如果姓名为 $S$ 的学生退课，则在他退课之前 X 老师的名单上一定有姓名。**\n\n**注意 3：选课，退课和查询都被定义为「事件」，「事件」的编号从 $1$ 开始。**", "inputFormat": "第一行包含一个正整数 $n$，表示一共发生了 $n$ 个事件。\n\n接下来 $n$ 行，每行描述一个事件；每行第一个正整数 $k$ 表示事件类型：\n\n1. 如果 $k = 1$，表示选课事件，接下来一个字符串 $S$，表示一个姓名为 $S$ 的学生选了 X 老师的课。   \n\n2. 如果 $k = 2$，表示退课事件，接下来一个字符串 $S$，表示一个姓名为 $S$ 的学生退了 X 老师的课。\n\n3. 如果 $k = 3$，表示查询事件，接下来一个字符串 $S$ 以及三个非负整数 $a,b,c$，表示 X 老师想知道最早在第几个事件之后，姓名以 $S$ 为前缀的学生数量超过了 $(a*|ANS|+b) \\bmod c$。$|ANS|$ 表示上次查询事件的答案的绝对值，如果当前是第一次查询，则 $ANS=0$；如果任何时刻都没有超过该值，则答案为 $-1$。\n     \n**注：输入中的所有字符串均只包含小写字母。**", "outputFormat": "对于每个查询事件，输出一行表示该查询答案。", "hint": "$n \\le 10^5,|S| \\le  60$，输入中的所有字符串只会包含前 $10$ 个小写字母。", "locale": "zh-CN", "translations": {"en": {"title": "[THUSC 2016] Add/Drop Period", "background": "", "description": "X is a teacher at University T. Every year, he teaches many students basic C++ knowledge. At University T, before the start of each semester, every student needs to choose courses. Each course selection process has three stages: pre-selection, main selection, and add/drop; among them, the “add/drop” stage is the busiest.\n\nDuring the add/drop stage, students can either add a course or drop a course. For Teacher X, the following two types of events may happen during the add/drop stage:\n\n1. A student with name $S$ adds his course (the name will appear in X’s list of enrolled students).\n2. A student with name $S$ drops his course (the name will be removed from X’s list of enrolled students).\n\nAt the same time, Teacher X cares a lot about which students have enrolled in his course, so he will query the enrolled-student list from time to time. For each query, he asks: after which event, as early as possible, does the number of students whose names have prefix $S$ become greater than $v$.\n\nTeacher X thinks you are talented, so he wants to test you with this problem. You are not afraid, so you bravely take on the task.\n\n**Note 1: Student names may be the same. If there are $p$ students with the same name who have all enrolled in Teacher X’s course, then their name will appear $p$ times in Teacher X’s list.**\n\n**Note 2: Only students who have already enrolled can drop the course. If a student with name $S$ drops the course, then before dropping, Teacher X’s list must contain that name.**\n\n**Note 3: Adding, dropping, and querying are all defined as “events”, and event indices start from $1$.**", "inputFormat": "The first line contains a positive integer $n$, indicating that a total of $n$ events occur.\n\nIn the next $n$ lines, each line describes an event. The first integer $k$ in each line indicates the event type:\n\n1. If $k = 1$, it is an add-course event. Next comes a string $S$, meaning that a student with name $S$ adds Teacher X’s course.\n2. If $k = 2$, it is a drop-course event. Next comes a string $S$, meaning that a student with name $S$ drops Teacher X’s course.\n3. If $k = 3$, it is a query event. Next comes a string $S$ and three non-negative integers $a, b, c$, meaning that Teacher X wants to know after which event, as early as possible, the number of students whose names have prefix $S$ becomes greater than $(a*|ANS|+b) \\bmod c$. $|ANS|$ denotes the absolute value of the answer to the previous query event. If this is the first query, then $ANS=0$. If this value is never exceeded at any time, then the answer is $-1$.\n\n**Note: All strings in the input contain only lowercase letters.**", "outputFormat": "For each query event, output one line containing the answer to that query.", "hint": "$n \\le 10^5, |S| \\le 60$. All strings in the input contain only the first $10$ lowercase letters.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUSC 2016] 补退选", "background": null, "description": "X 是 T 大的一名老师，每年他都要教授许多学生基础的 C++ 知识。在 T 大，每个学生在每学期的开学前都需要选课，每次选课一共分为三个阶段：预选，正选，补退选；其中「补退选」阶段最忙碌。\n\n在补退选阶段，学生即可以选课，也可以退课。对于X老师来说，在补退选阶段可能发生以下两种事件：\n\n1. 一个姓名为 $S$ 的学生选了他的课（姓名将出现在 X 的已选课学生名单中）            \n2. 一个姓名为 $S$ 的学生退了他的课（姓名将从 X 的已选课学生名单中移除）\n\n同时，X 老师对于有哪些学生选了他的课非常关心，所以他会不定时的查询已选课学生名单，每次查询最早在哪个事件之后，姓名以 $S$ 为前缀的学生数量超过了 $v$。\n\nX 老师看你骨骼惊奇，所以想用这个问题考考你，你当然不会畏惧，所以勇敢的接下了这个任务。\n\n**注意 1：学生的姓名可能相同，如果有 $p$ 个姓名相同的学生都选了 X 老师的课，则他们的姓名将出现在 X 老师的名单上 $p$ 次。**\n\n**注意 2：只有已经选了课的学生才会退课，如果姓名为 $S$ 的学生退课，则在他退课之前 X 老师的名单上一定有姓名。**\n\n**注意 3：选课，退课和查询都被定义为「事件」，「事件」的编号从 $1$ 开始。**", "inputFormat": "第一行包含一个正整数 $n$，表示一共发生了 $n$ 个事件。\n\n接下来 $n$ 行，每行描述一个事件；每行第一个正整数 $k$ 表示事件类型：\n\n1. 如果 $k = 1$，表示选课事件，接下来一个字符串 $S$，表示一个姓名为 $S$ 的学生选了 X 老师的课。   \n\n2. 如果 $k = 2$，表示退课事件，接下来一个字符串 $S$，表示一个姓名为 $S$ 的学生退了 X 老师的课。\n\n3. 如果 $k = 3$，表示查询事件，接下来一个字符串 $S$ 以及三个非负整数 $a,b,c$，表示 X 老师想知道最早在第几个事件之后，姓名以 $S$ 为前缀的学生数量超过了 $(a*|ANS|+b) \\bmod c$。$|ANS|$ 表示上次查询事件的答案的绝对值，如果当前是第一次查询，则 $ANS=0$；如果任何时刻都没有超过该值，则答案为 $-1$。\n     \n**注：输入中的所有字符串均只包含小写字母。**", "outputFormat": "对于每个查询事件，输出一行表示该查询答案。", "hint": "$n \\le 10^5,|S| \\le  60$，输入中的所有字符串只会包含前 $10$ 个小写字母。", "locale": "zh-CN"}}}
{"pid": "P5336", "type": "P", "difficulty": 6, "samples": [["10\n3 1\n7 10 9 10 6 7 10 7 1 2\n", "15"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2016", "区间 DP", "THUSC"], "title": "[THUSC 2016] 成绩单", "background": "", "description": "期末考试结束了，班主任 L 老师要将成绩单分发到每位同学手中。L 老师共有 $n$ 份成绩单，按照编号从 $1$ 到 $n$ 的顺序叠放在桌子上，其中编号为 $i$ 的的成绩单分数为 $W_i$。       \n成绩单是按照批次发放的。发放成绩单时，L 老师会从当前的一叠成绩单中抽取连续的一段，让这些同学来领取自己的成绩单。当这批同学领取完毕后，L 老师再从剩余的成绩单中抽取连续的一段，供下一批同学领取。经过若干批次的领取后，成绩单将被全部发放到同学手中。       \n然而，分发成绩单是一件令人头痛的事情，一方面要照顾同学们的心理情绪，不能让分数相差太远的同学在同一批领取成绩单；另一方面要考虑时间成本，尽量减少领取成绩单的批次数。对于一个分发成绩单的方案，我们定义其代价为：    \n$$a \\times k + b \\times \\sum_{i = 1} ^ k (max_i - min_i) ^ 2$$        \n其中 $k$ 是分发的批次数，对于第 $i$ 批分发的成绩单，$max_i$ 是最高分数，$min_i$ 是最低分数，$a$ 和 $b$ 是给定的评估参数。现在，请你帮助 L 老师找到代价最小的分发成绩单的方案，并将这个最小的代价告诉 L 老师。当然，分发成绩单的批次数 $k$ 是你决定的。\n", "inputFormat": "第一行包含一个正整数 $n$，表示成绩单的数量。第二行包含两个非负整数 $a,b$，表示给定的评估参数。第三行包含 $n$ 个正整数，$w_i$ 表示第 $i$ 张成绩单上的分数。", "outputFormat": "仅一个正整数，表示最小的代价是多少。  ", "hint": "$n \\leq 50$，$a \\leq 1500$，$b \\leq 10$，$w_i \\leq 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[THUSC 2016] Report Cards", "background": "", "description": "The final exams are over. Head teacher Mr. L needs to hand out the report cards to every student. Mr. L has $n$ report cards, stacked on the desk in order from $1$ to $n$, where the score on report card $i$ is $W_i$.\n\nThe report cards are handed out in batches. When handing them out, Mr. L will take a consecutive segment from the current stack of report cards, and the students in that segment come to pick up their own report cards. After this batch of students finishes, Mr. L then takes another consecutive segment from the remaining report cards for the next batch. After several batches, all report cards will be handed out.\n\nHowever, handing out report cards is a headache. On one hand, he needs to take care of the students' feelings, so students with scores that differ too much should not pick up their report cards in the same batch. On the other hand, he must consider the time cost and try to reduce the number of batches.\n\nFor a distribution plan, we define its cost as:\n$$a \\times k + b \\times \\sum_{i = 1} ^ k (max_i - min_i) ^ 2$$\nwhere $k$ is the number of batches. For the report cards handed out in the $i$-th batch, $max_i$ is the highest score and $min_i$ is the lowest score. $a$ and $b$ are given evaluation parameters. Now, please help Mr. L find the plan with the minimum cost, and report this minimum cost to Mr. L. Of course, the number of batches $k$ is up to you.", "inputFormat": "The first line contains a positive integer $n$, indicating the number of report cards. The second line contains two non-negative integers $a, b$, indicating the given evaluation parameters. The third line contains $n$ positive integers $w_i$, where $w_i$ is the score on the $i$-th report card.", "outputFormat": "Output a single positive integer, indicating the minimum cost.", "hint": "Constraints: $n \\leq 50$，$a \\leq 1500$，$b \\leq 10$，$w_i \\leq 1000$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUSC 2016] 成绩单", "background": "", "description": "期末考试结束了，班主任 L 老师要将成绩单分发到每位同学手中。L 老师共有 $n$ 份成绩单，按照编号从 $1$ 到 $n$ 的顺序叠放在桌子上，其中编号为 $i$ 的的成绩单分数为 $W_i$。       \n成绩单是按照批次发放的。发放成绩单时，L 老师会从当前的一叠成绩单中抽取连续的一段，让这些同学来领取自己的成绩单。当这批同学领取完毕后，L 老师再从剩余的成绩单中抽取连续的一段，供下一批同学领取。经过若干批次的领取后，成绩单将被全部发放到同学手中。       \n然而，分发成绩单是一件令人头痛的事情，一方面要照顾同学们的心理情绪，不能让分数相差太远的同学在同一批领取成绩单；另一方面要考虑时间成本，尽量减少领取成绩单的批次数。对于一个分发成绩单的方案，我们定义其代价为：    \n$$a \\times k + b \\times \\sum_{i = 1} ^ k (max_i - min_i) ^ 2$$        \n其中 $k$ 是分发的批次数，对于第 $i$ 批分发的成绩单，$max_i$ 是最高分数，$min_i$ 是最低分数，$a$ 和 $b$ 是给定的评估参数。现在，请你帮助 L 老师找到代价最小的分发成绩单的方案，并将这个最小的代价告诉 L 老师。当然，分发成绩单的批次数 $k$ 是你决定的。\n", "inputFormat": "第一行包含一个正整数 $n$，表示成绩单的数量。第二行包含两个非负整数 $a,b$，表示给定的评估参数。第三行包含 $n$ 个正整数，$w_i$ 表示第 $i$ 张成绩单上的分数。", "outputFormat": "仅一个正整数，表示最小的代价是多少。  ", "hint": "$n \\leq 50$，$a \\leq 1500$，$b \\leq 10$，$w_i \\leq 1000$。", "locale": "zh-CN"}}}
{"pid": "P5337", "type": "P", "difficulty": 5, "samples": [["2\nab\n", "675\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2019", "各省省选", "矩阵加速", "天津"], "title": "[TJOI2019] 甲苯先生的字符串", "background": "TJOI2019 D1T1\n\n源文件名：str.*\n\n时间限制: 1s 内存限制: 128M", "description": "一天小甲苯得到了一条神的指示，他要把神的指示写下来，但是又不能泄露天机，所以他要用一种方法把神的指示记下来。神的指示是一个字符串，记为字符串 $s_1$，$s_1$ 仅包含 $26$ 个小写字母。现在小甲苯想要写下神的指示，记为字符串 $s_2$，$s_2$ 仅包含 $26$ 个小写字母，要求 $s_1$ 中的相邻的两个字母不能在 $s_2$ 中相邻地出现。现在给定 $s_2$ 的长度，小甲苯想知道他有多少种方法可以将神的指示写下来。输出种类数结果对 $10^9+7$ 取模。", "inputFormat": "第一行只有一个正整数 $n$，代表字符串 $s_2$ 的长度。 \n\n第二行是一个字符串，代表字符串 $s_1$。", "outputFormat": "输出一个整数，表示小甲苯可以写出的字符串的总数。结果对$10^9+7$ 取模", "hint": "对于 $30\\%$ 的数据 $n\\le100000$。\n\n对于 $100\\%$ 的数据 $1 \\le n\\le10^{15}$，$|s_1| \\le 10^5$。\n\n说明：相邻要求顺序相同，如样例中的 $s_2$ 里不能出现 $\\text{ab}$，且仅不能出现 $\\text{ab}$，但可以出现 $\\text{ba}$。", "locale": "zh-CN", "translations": {"en": {"title": "[TJOI2019] Mr. Toluene's String", "background": "TJOI2019 D1T1.\n\nSource file name: str.*.\n\nTime limit: 1 s. Memory limit: 128 M.", "description": "One day, Xiao Toluene received a divine message. He wants to write it down, but cannot reveal the secret, so he decides to record it in a special way.\n\nThe divine message is a string, denoted as $s_1$. $s_1$ contains only $26$ lowercase letters. Now Xiao Toluene wants to write down the message as another string, denoted as $s_2$. $s_2$ also contains only $26$ lowercase letters. The requirement is: any two adjacent letters in $s_1$ must not appear adjacent in $s_2$.\n\nGiven the length of $s_2$, Xiao Toluene wants to know how many different strings $s_2$ he can write. Output the number of valid strings modulo $10^9+7$.", "inputFormat": "The first line contains a single positive integer $n$, representing the length of string $s_2$.\n\nThe second line contains a string, representing string $s_1$.", "outputFormat": "Output one integer, representing the total number of strings that Xiao Toluene can write. Take the result modulo $10^9+7$.", "hint": "For $30\\%$ of the testdata, $n \\le 100000$.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 10^{15}$, $|s_1| \\le 10^5$.\n\nNote: The adjacency restriction requires the same order. For example, in the sample, $s_2$ must not contain $\\text{ab}$, and only $\\text{ab}$ is forbidden, but $\\text{ba}$ is allowed.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[TJOI2019] 甲苯先生的字符串", "background": "TJOI2019 D1T1\n\n源文件名：str.*\n\n时间限制: 1s 内存限制: 128M", "description": "一天小甲苯得到了一条神的指示，他要把神的指示写下来，但是又不能泄露天机，所以他要用一种方法把神的指示记下来。神的指示是一个字符串，记为字符串 $s_1$，$s_1$ 仅包含 $26$ 个小写字母。现在小甲苯想要写下神的指示，记为字符串 $s_2$，$s_2$ 仅包含 $26$ 个小写字母，要求 $s_1$ 中的相邻的两个字母不能在 $s_2$ 中相邻地出现。现在给定 $s_2$ 的长度，小甲苯想知道他有多少种方法可以将神的指示写下来。输出种类数结果对 $10^9+7$ 取模。", "inputFormat": "第一行只有一个正整数 $n$，代表字符串 $s_2$ 的长度。 \n\n第二行是一个字符串，代表字符串 $s_1$。", "outputFormat": "输出一个整数，表示小甲苯可以写出的字符串的总数。结果对$10^9+7$ 取模", "hint": "对于 $30\\%$ 的数据 $n\\le100000$。\n\n对于 $100\\%$ 的数据 $1 \\le n\\le10^{15}$，$|s_1| \\le 10^5$。\n\n说明：相邻要求顺序相同，如样例中的 $s_2$ 里不能出现 $\\text{ab}$，且仅不能出现 $\\text{ab}$，但可以出现 $\\text{ba}$。", "locale": "zh-CN"}}}
{"pid": "P5338", "type": "P", "difficulty": 6, "samples": [["1\n7 3 1\n", "0\n1\n0\n"]], "limits": {"time": [10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2019", "各省省选", "平衡树", "天津"], "title": "[TJOI2019] 甲苯先生的滚榜", "background": "", "description": "甲苯先生在制作一个 Online Judge，他发现做比赛的人们很关心自己的排名（显而易见）。\n\n在 ACM 赛制的比赛中，如果通过题目数量不相等，则通过题目数量多的人排名更靠前；  \n如果通过题目数量相等，则罚时更少的人排名更高。\n\n甲苯先生想让大家帮忙设计一个程序，每次有人通过之后，就告诉他排名在他的前面有多少人。  \n（不包括和他罚时题数都相同的同学）", "inputFormat": "第一行输入一个整数 $T$ 表示测试样例的个数。\n\n对于每一个样例，输入三个整数 $m, n, \\text{seed}$。  \n$m$ 表示参赛总人数（编号 $1 \\sim m$），$n$ 表示一共有 $n$ 次 AC（假设 AC 已经去重，即不存在相同人的相同题目提交）。  \n$\\text{seed}$ 表示生成数据的种子。\n\n接下来要求同学们使用之下的函数生成数据：\n```cpp\ntypedef unsigned int ui ;\nui randNum( ui& seed , ui last , const ui m){ \n    seed = seed * 17 + last ; return seed % m + 1; \n}\n```\n（$\\texttt{last}$ 为上一次输出的结果，在没有输出结果时 $\\texttt{last} = 7$，多组数据时 $\\texttt{last}$ 不需要重新赋值）  \n要求每次生成两个数据 $\\texttt{Ria}, \\texttt{Rib}$，表示第 $\\texttt{Ria}$ 个人 AC 了一道题目，他的罚时为 $\\texttt{Rib}$。  \n（也就是说 $\\texttt{Ria}$ 的题目数量 $+1$，罚时长度 $+\\texttt{Rib}$）。\n\n要求一共生成 $n$ 组数据，代表一共有 $n$ 次提交。\n\n对于所有数据，保证罚时总和不超过 $1.5\\times 10^6$。", "outputFormat": "每次提交输出一行整数，表示在第 $\\texttt{Ria}$ 个人 AC 后，比 $\\texttt{Ria}$ 成绩高的有多少个选手。", "hint": "| 测试点# | 1, 2 | 3, 4 | 5 |6, 7, 8 | 9, 10 |\n| :-: | :-: | :-: | :-: | :-: |:-:|\n| $T$ | $\\le10$ | $\\le5$ | $\\le15$ | $\\le5$ | $\\le5$ |\n| $m$ | $\\le1000$ | $\\le10000$ | $\\le10^5$ | $\\le10^4$ |$\\le10^5$|\n| $n$ | $\\le1000$ | $\\le10000$ | $\\le10^5$ | $\\le10^6$ |$\\le10^6$|\n", "locale": "zh-CN", "translations": {"en": {"title": "[TJOI2019] Mr. Toluene’s Rolling Leaderboard.", "background": "", "description": "Mr. Toluene is building an Online Judge. He noticed that people participating in contests care a lot about their rank (obviously).\n\nIn an ACM-style contest, if the numbers of solved problems are different, the person who solved more problems ranks higher.  \nIf the numbers of solved problems are the same, the person with less penalty time ranks higher.\n\nMr. Toluene wants everyone to help design a program: after each time someone gets an accepted solution, tell him how many people are ranked ahead of that person.  \n(This does not include contestants who have exactly the same number of solved problems and the same penalty time.)", "inputFormat": "The first line contains an integer $T$, the number of test cases.\n\nFor each test case, input three integers $m, n, \\text{seed}$.  \n$m$ is the total number of contestants (numbered $1 \\sim m$), $n$ means there are $n$ AC events in total (assume AC events are already deduplicated, i.e., there is no submission of the same problem by the same person).  \n$\\text{seed}$ is the seed used to generate the data.\n\nThen you must use the following function to generate the data:\n```cpp\ntypedef unsigned int ui ;\nui randNum( ui& seed , ui last , const ui m){ \n    seed = seed * 17 + last ; return seed % m + 1; \n}\n```\n($\\texttt{last}$ is the previous output value. When there has been no output yet, $\\texttt{last} = 7$. For multiple test cases, $\\texttt{last}$ does not need to be reset.)  \nEach time, generate two values $\\texttt{Ria}, \\texttt{Rib}$, meaning that contestant $\\texttt{Ria}$ gets an AC for one problem, and the added penalty time is $\\texttt{Rib}$.  \n(That is, the solved count of $\\texttt{Ria}$ becomes $+1$, and the penalty time becomes $+\\texttt{Rib}$.)\n\nGenerate a total of $n$ pairs of data, meaning there are $n$ submissions in total.\n\nFor all testdata, it is guaranteed that the total sum of penalty times does not exceed $1.5\\times 10^6$.", "outputFormat": "For each submission, output one line with an integer: after contestant $\\texttt{Ria}$ gets an AC, how many contestants have a better result than $\\texttt{Ria}$.", "hint": "| Test Point # | 1, 2 | 3, 4 | 5 | 6, 7, 8 | 9, 10 |\n| :-: | :-: | :-: | :-: | :-: | :-: |\n| $T$ | $\\le10$ | $\\le5$ | $\\le15$ | $\\le5$ | $\\le5$ |\n| $m$ | $\\le1000$ | $\\le10000$ | $\\le10^5$ | $\\le10^4$ | $\\le10^5$ |\n| $n$ | $\\le1000$ | $\\le10000$ | $\\le10^5$ | $\\le10^6$ | $\\le10^6$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[TJOI2019] 甲苯先生的滚榜", "background": "", "description": "甲苯先生在制作一个 Online Judge，他发现做比赛的人们很关心自己的排名（显而易见）。\n\n在 ACM 赛制的比赛中，如果通过题目数量不相等，则通过题目数量多的人排名更靠前；  \n如果通过题目数量相等，则罚时更少的人排名更高。\n\n甲苯先生想让大家帮忙设计一个程序，每次有人通过之后，就告诉他排名在他的前面有多少人。  \n（不包括和他罚时题数都相同的同学）", "inputFormat": "第一行输入一个整数 $T$ 表示测试样例的个数。\n\n对于每一个样例，输入三个整数 $m, n, \\text{seed}$。  \n$m$ 表示参赛总人数（编号 $1 \\sim m$），$n$ 表示一共有 $n$ 次 AC（假设 AC 已经去重，即不存在相同人的相同题目提交）。  \n$\\text{seed}$ 表示生成数据的种子。\n\n接下来要求同学们使用之下的函数生成数据：\n```cpp\ntypedef unsigned int ui ;\nui randNum( ui& seed , ui last , const ui m){ \n    seed = seed * 17 + last ; return seed % m + 1; \n}\n```\n（$\\texttt{last}$ 为上一次输出的结果，在没有输出结果时 $\\texttt{last} = 7$，多组数据时 $\\texttt{last}$ 不需要重新赋值）  \n要求每次生成两个数据 $\\texttt{Ria}, \\texttt{Rib}$，表示第 $\\texttt{Ria}$ 个人 AC 了一道题目，他的罚时为 $\\texttt{Rib}$。  \n（也就是说 $\\texttt{Ria}$ 的题目数量 $+1$，罚时长度 $+\\texttt{Rib}$）。\n\n要求一共生成 $n$ 组数据，代表一共有 $n$ 次提交。\n\n对于所有数据，保证罚时总和不超过 $1.5\\times 10^6$。", "outputFormat": "每次提交输出一行整数，表示在第 $\\texttt{Ria}$ 个人 AC 后，比 $\\texttt{Ria}$ 成绩高的有多少个选手。", "hint": "| 测试点# | 1, 2 | 3, 4 | 5 |6, 7, 8 | 9, 10 |\n| :-: | :-: | :-: | :-: | :-: |:-:|\n| $T$ | $\\le10$ | $\\le5$ | $\\le15$ | $\\le5$ | $\\le5$ |\n| $m$ | $\\le1000$ | $\\le10000$ | $\\le10^5$ | $\\le10^4$ |$\\le10^5$|\n| $n$ | $\\le1000$ | $\\le10000$ | $\\le10^5$ | $\\le10^6$ |$\\le10^6$|\n", "locale": "zh-CN"}}}
{"pid": "P5339", "type": "P", "difficulty": 6, "samples": [["4 4 3 2 1\n", "174\n"], ["996 208 221 132 442\n", "442572391\n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2019", "各省省选", "组合数学", "天津"], "title": "[TJOI2019] 唱、跳、rap和篮球", "background": "TJOI2019 D1T3\n\n源文件名：queue.\\*\n\n时间限制：4s 内存限制：128M", "description": "大中锋的学院要组织学生参观博物馆，要求学生们在博物馆中排成一队进行参观。他的同学可以分为四类：一部分最喜欢唱、一部分最喜欢跳、一部分最喜欢 rap，还有一部分最喜欢篮球。如果队列中 $k$, $k + 1$, $k + 2$, $k + 3$ 位置上的同学依次，最喜欢唱、最喜欢跳、最喜欢 rap、最喜欢篮球，那么他们就会聚在一起讨论蔡徐坤。大中锋不希望这种事情发生，因为这会使得队伍显得很乱。大中锋想知道有多少种排队的方法，不会有学生聚在一起讨论蔡徐坤。两个学生队伍被认为是不同的，当且仅当两个队伍中至少有一个位置上的学生的喜好不同。由于合法的队伍可能会有很多种，种类数对 $998244353$ 取模。", "inputFormat": "输入数据只有一行。每行 $5$ 个整数，第一个整数 $n$，代表大中锋的学院要组织多少人去参观博物馆。接下来四个整数 $a$、$b$、$c$、$d$，分别代表学生中最喜欢唱的人数、最喜欢跳的人数、最喜欢 rap 的人数和最喜欢篮球的人数。保证 $a+b+c+d \\ge n$。", "outputFormat": "每组数据输出一个整数，代表你可以安排出多少种不同的学生队伍，使得队伍中没有学生聚在一起讨论蔡徐坤。结果对 $998244353$ 取模。", "hint": "对于 20% 的数据，有 $n=a=b=c=d\\le500$。\n\n对于 100% 的数据，有 $n \\le 1000$，$a, b, c, d \\le 500$。", "locale": "zh-CN", "translations": {"en": {"title": "[TJOI2019] Singing, Dancing, Rap, and Basketball", "background": "TJOI2019 D1T3.\n\nSource file name: queue.\\*.\n\nTime limit: 4 s. Memory limit: 128 M.", "description": "Da Zhongfeng’s academy is going to organize students to visit a museum, and requires the students to line up in a single queue in the museum.\n\nHis classmates can be divided into four types: some like singing the most, some like dancing the most, some like rap the most, and some like basketball the most. If the students at positions $k$, $k + 1$, $k + 2$, $k + 3$ in the queue, in order, like singing the most, like dancing the most, like rap the most, and like basketball the most, then they will gather together to discuss Cai Xukun. Da Zhongfeng does not want this to happen, because it will make the queue look messy.\n\nDa Zhongfeng wants to know how many ways there are to arrange the queue so that no students will gather together to discuss Cai Xukun. Two queues are considered different if and only if there exists at least one position where the students’ preferences are different. Since the number of valid queues may be very large, output it modulo $998244353$.", "inputFormat": "The input contains only one line. The line contains $5$ integers. The first integer is $n$, the number of students going to visit the museum. The next four integers $a$, $b$, $c$, $d$ represent the number of students who like singing the most, like dancing the most, like rap the most, and like basketball the most, respectively. It is guaranteed that $a+b+c+d \\ge n$.", "outputFormat": "Output one integer, representing how many different student queues you can arrange such that there are no students gathering together to discuss Cai Xukun. Output the result modulo $998244353$.", "hint": "For $20\\%$ of the testdata, $n=a=b=c=d\\le500$.\n\nFor $100\\%$ of the testdata, $n \\le 1000$, $a, b, c, d \\le 500$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[TJOI2019] 唱、跳、rap和篮球", "background": "TJOI2019 D1T3\n\n源文件名：queue.\\*\n\n时间限制：4s 内存限制：128M", "description": "大中锋的学院要组织学生参观博物馆，要求学生们在博物馆中排成一队进行参观。他的同学可以分为四类：一部分最喜欢唱、一部分最喜欢跳、一部分最喜欢 rap，还有一部分最喜欢篮球。如果队列中 $k$, $k + 1$, $k + 2$, $k + 3$ 位置上的同学依次，最喜欢唱、最喜欢跳、最喜欢 rap、最喜欢篮球，那么他们就会聚在一起讨论蔡徐坤。大中锋不希望这种事情发生，因为这会使得队伍显得很乱。大中锋想知道有多少种排队的方法，不会有学生聚在一起讨论蔡徐坤。两个学生队伍被认为是不同的，当且仅当两个队伍中至少有一个位置上的学生的喜好不同。由于合法的队伍可能会有很多种，种类数对 $998244353$ 取模。", "inputFormat": "输入数据只有一行。每行 $5$ 个整数，第一个整数 $n$，代表大中锋的学院要组织多少人去参观博物馆。接下来四个整数 $a$、$b$、$c$、$d$，分别代表学生中最喜欢唱的人数、最喜欢跳的人数、最喜欢 rap 的人数和最喜欢篮球的人数。保证 $a+b+c+d \\ge n$。", "outputFormat": "每组数据输出一个整数，代表你可以安排出多少种不同的学生队伍，使得队伍中没有学生聚在一起讨论蔡徐坤。结果对 $998244353$ 取模。", "hint": "对于 20% 的数据，有 $n=a=b=c=d\\le500$。\n\n对于 100% 的数据，有 $n \\le 1000$，$a, b, c, d \\le 500$。", "locale": "zh-CN"}}}
{"pid": "P5340", "type": "P", "difficulty": 4, "samples": [["1\n2 1 1\n1 1\n1 2 1\n1 2", "-1"], ["1\n2 1 2\n1 1\n1 2 1\n1 2", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "各省省选", "O2优化", "天津"], "title": "[TJOI2019] 大中锋的游乐场", "background": "", "description": "大中锋正在一个游乐场里玩耍。游乐场里有 $n$ 个娱乐设施，娱乐设施之间相互有共 $m$ 条道路相连，经过每一条路都需要花费一定的时间。为了方便游客，每一个娱乐设施旁都会配有一个小卖部，一部分小卖部会销售可乐，另一部分会销售汉堡。\n\n由于大中锋十分贪吃，所以每当他走到一个娱乐设施，他都会先去购买一杯可乐或一个汉堡，并把它们吃掉。但如果大中锋吃掉的汉堡数量比他喝掉的可乐数量多于 $k$ ，那他就会感到很渴；如果喝掉的可乐数量比吃掉的汉堡数量多于 $k$ ，那他就会感到很饿。\n\n现在大中锋正在第 $a$ 个娱乐设施，他想前往第 $b$ 个娱乐设施，但在他前进的路途中他不希望自己很渴或很饿。大中锋想知道自己在路上少花费多少时间。但由于大中锋很懒惰，他不想思考这个问题。你能帮助他解决这个问题吗？\n\n注意：大中锋非常贪吃，所以他到达每个点的第一件事是去吃(或者喝)，才考虑其他的事情，所以在起始点和终点他都会去买汉堡(可乐)，你也需要保证在这两个点他不会感到很饿或者很渴。", "inputFormat": "输入的第一行是一个整数 $T$ 表示数据组数数，对于每组数据的格式如下：\n\n第一行有三个整数，分别代表游乐场的娱乐设施个数 $n$，游乐场的道路数 $m$ ， 以及给出的参数 $k$，其含义见【题目描述】。\n\n第二行有 $n$ 个整数，第 $i$ 个整数 $a_i$ 代表编号为 $i$ 的娱乐设施旁的小卖部销售的物品，$1$ 表示可乐，$2$ 表示汉堡。\n\n第 $3$ 到第 $(m + 2)$ 行，每行三个整数 $u, v, w$，代表从第 $u$ 个娱乐设施到第 $v$ 个娱乐设施有存在一条双向道路，通过该道路需要花费时间 $w$。\n\n第 $m + 3$ 行有两个整数 $s, t$ ，代表大中锋想从娱乐设施 $s$ 前往娱乐设施 $t$。", "outputFormat": "对于每组数据输出一行一个整数表示答案。如果无解，请输出 $-1$。", "hint": "#### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，保证 $n\\leq 50,m\\leq 1000$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n\\leq 10000$，$1 \\leq m\\leq 100000$，$1 \\leq k\\leq 10$，$1 \\leq a_i \\leq 2$，$1 \\leq u, v,s, t \\leq n$，$1 \\leq w \\leq 10000$。\n\n对于所有数据，保证 $1 \\leq T \\leq 10$ ，且每个测试点的大数据不超过 $2$ 个。\n\n#### 题目补充说明\n\n- 路径不一定是简单路径。\n- 大中锋可以多次经过一个节点，同时每次都会取得汉堡/可乐。", "locale": "zh-CN", "translations": {"en": {"title": "[TJOI2019] Big Center Forward’s Amusement Park", "background": "", "description": "Big Center Forward is playing in an amusement park. There are $n$ attractions in the park, connected by a total of $m$ roads. Traveling along each road takes a certain amount of time. For the convenience of visitors, each attraction has a snack shop next to it: some shops sell cola, and the others sell hamburgers.\n\nBecause Big Center Forward loves eating, every time he arrives at an attraction, he will first buy either a cup of cola or a hamburger and consume it. However, if the number of hamburgers he has eaten exceeds the number of colas he has drunk by more than $k$, he will feel very thirsty; if the number of colas he has drunk exceeds the number of hamburgers he has eaten by more than $k$, he will feel very hungry.\n\nNow Big Center Forward is at attraction $a$ and wants to go to attraction $b$, but he does not want to feel very thirsty or very hungry during the trip. He wants to know the minimum total time spent on the way. Since Big Center Forward is very lazy and does not want to think about it, can you help him solve this problem?\n\nNote: Big Center Forward is extremely greedy, so the first thing he does upon arriving at each node is to eat (or drink), and only then consider other things. Therefore, he will buy a hamburger (or cola) at both the starting point and the ending point as well. You also need to ensure that at these two nodes he will not feel very hungry or very thirsty.", "inputFormat": "The first line contains an integer $T$, indicating the number of test cases. For each test case, the format is as follows.\n\nThe first line contains three integers $n$, $m$, and $k$, representing the number of attractions, the number of roads, and the given parameter $k$ as described in the statement.\n\nThe second line contains $n$ integers. The $i$-th integer $a_i$ indicates the item sold by the shop next to attraction $i$: $1$ means cola, and $2$ means hamburger.\n\nLines $3$ to $(m + 2)$ each contain three integers $u, v, w$, indicating that there is an undirected road between attraction $u$ and attraction $v$, and traveling along this road takes time $w$.\n\nLine $m + 3$ contains two integers $s, t$, indicating that Big Center Forward wants to travel from attraction $s$ to attraction $t$.", "outputFormat": "For each test case, output one line containing one integer, the answer. If there is no feasible solution, output $-1$.", "hint": "#### Constraints\n\n- For $30\\%$ of the testdata, $n\\leq 50, m\\leq 1000$.\n- For $100\\%$ of the testdata, $1 \\leq n\\leq 10000$, $1 \\leq m\\leq 100000$, $1 \\leq k\\leq 10$, $1 \\leq a_i \\leq 2$, $1 \\leq u, v, s, t \\leq n$, $1 \\leq w \\leq 10000$.\n\nFor all testdata, $1 \\leq T \\leq 10$, and in each test point, the number of large testdata cases does not exceed $2$.\n\n#### Additional Notes\n\n- The path is not necessarily a simple path.\n- Big Center Forward may pass through a node multiple times, and each time he will obtain a hamburger/cola.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[TJOI2019] 大中锋的游乐场", "background": "", "description": "大中锋正在一个游乐场里玩耍。游乐场里有 $n$ 个娱乐设施，娱乐设施之间相互有共 $m$ 条道路相连，经过每一条路都需要花费一定的时间。为了方便游客，每一个娱乐设施旁都会配有一个小卖部，一部分小卖部会销售可乐，另一部分会销售汉堡。\n\n由于大中锋十分贪吃，所以每当他走到一个娱乐设施，他都会先去购买一杯可乐或一个汉堡，并把它们吃掉。但如果大中锋吃掉的汉堡数量比他喝掉的可乐数量多于 $k$ ，那他就会感到很渴；如果喝掉的可乐数量比吃掉的汉堡数量多于 $k$ ，那他就会感到很饿。\n\n现在大中锋正在第 $a$ 个娱乐设施，他想前往第 $b$ 个娱乐设施，但在他前进的路途中他不希望自己很渴或很饿。大中锋想知道自己在路上少花费多少时间。但由于大中锋很懒惰，他不想思考这个问题。你能帮助他解决这个问题吗？\n\n注意：大中锋非常贪吃，所以他到达每个点的第一件事是去吃(或者喝)，才考虑其他的事情，所以在起始点和终点他都会去买汉堡(可乐)，你也需要保证在这两个点他不会感到很饿或者很渴。", "inputFormat": "输入的第一行是一个整数 $T$ 表示数据组数数，对于每组数据的格式如下：\n\n第一行有三个整数，分别代表游乐场的娱乐设施个数 $n$，游乐场的道路数 $m$ ， 以及给出的参数 $k$，其含义见【题目描述】。\n\n第二行有 $n$ 个整数，第 $i$ 个整数 $a_i$ 代表编号为 $i$ 的娱乐设施旁的小卖部销售的物品，$1$ 表示可乐，$2$ 表示汉堡。\n\n第 $3$ 到第 $(m + 2)$ 行，每行三个整数 $u, v, w$，代表从第 $u$ 个娱乐设施到第 $v$ 个娱乐设施有存在一条双向道路，通过该道路需要花费时间 $w$。\n\n第 $m + 3$ 行有两个整数 $s, t$ ，代表大中锋想从娱乐设施 $s$ 前往娱乐设施 $t$。", "outputFormat": "对于每组数据输出一行一个整数表示答案。如果无解，请输出 $-1$。", "hint": "#### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，保证 $n\\leq 50,m\\leq 1000$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n\\leq 10000$，$1 \\leq m\\leq 100000$，$1 \\leq k\\leq 10$，$1 \\leq a_i \\leq 2$，$1 \\leq u, v,s, t \\leq n$，$1 \\leq w \\leq 10000$。\n\n对于所有数据，保证 $1 \\leq T \\leq 10$ ，且每个测试点的大数据不超过 $2$ 个。\n\n#### 题目补充说明\n\n- 路径不一定是简单路径。\n- 大中锋可以多次经过一个节点，同时每次都会取得汉堡/可乐。", "locale": "zh-CN"}}}
{"pid": "P5341", "type": "P", "difficulty": 6, "samples": [["6\naab 1\nabc 1\naaaa 2\nabab 2\nababacc 2\nabab 4", "2\n1\n3\n1\n2\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "各省省选", "天津"], "title": "[TJOI2019] 甲苯先生和大中锋的字符串", "background": "TJOI2019 D2T2\n\n源文件名：substring.*\n\n时间限制: 1s 内存限制: 128M", "description": "大中锋有一个长度为 $n$ 的字符串，他只知道其中的一个子串是祖上传下来的宝藏的密码。但是由于字符串很长，大中锋很难将这些子串一一尝试。\n\n这天大中锋找到甲苯先生算命，但是甲苯先生说：“天机不可泄漏”。\n\n在大中锋的苦苦哀求下，甲苯先生告诉大中锋：“密码是在字符串中恰好出现了 $k$ 次的子串”。\n\n但是大中锋不知道该怎么做，在大中锋再三的恳求下，甲苯先生看其真诚，又告诉他：“在恰好出现了 $k$ 次的子串中，你去按照字串的长度分类，密码就在数量最多的那一类里”。\n\n大中锋为了尝试这个密码，想让你帮忙找出子串长度出现次数最多的长度数（如果有多个输出最长长度）。", "inputFormat": "第一行一个正整数 $T$ ，表示有 $T$ 组测试数据。\n\n接下来 $T$ 行每行包含一个字符串和一个正整数 $k$ 。", "outputFormat": "一共输出 $T$ 行，每行一个整数表示在出现 $k$ 次的子串中出现次数的最多的长度。如果不存在子串出现 $k$ 次，则输出 $-1$ 。", "hint": "### 数据说明 ###\n\n对于第一个数据：其中子串 $b, aa, ab, aab$ 均只出现一次，其中长度为 $1$ 的子串出现了 $1$ 次，长度为 $2$ 的子串出现了 $2$ 次，长度为 $3$ 的子串出现了 $1$ 次。所以答案为 $2$ 。\n\n对于第二个数据：其中子串 $a, b, c, ab, bc, abc$ 均只出现一次，其中长度为 $1$ 的子串出现了 $3$ 次，长度为 $2$ 的子串出现了 $2$ 次，长度为 $3$ 的子串出现了 $1$ 次。所以答案为 $1$ 。\n\n对于第三个数据：其中子串 $aaa$ 出现二次，长度为 $3$ 的子串出现了 $1$ 次，其他长度均没有。所以答案为 $3$ 。\n\n对于第四个数据：其中子串 $a, b, ab$ 出现二次，其中长度为 $1$ 的子串出现了 $2$ 次，长度为 $2$ 的子串出现了 $1$ 次。所以答案为 $1$ 。\n\n对于第五个数据：其中子串 $b, c, ab, ba$ 出现二次，其中长度为 $1$ 的子串出现了 $2$ 次，长度为 $2$ 的子串出现了 $2$ 次。所以答案为 $2$ 。\n\n对于第六个数据：其中子串没有出现四次。所以本题的本题的答案为 $-1$ 。\n\n### 数据范围 ###\n\n对于 $20\\%$ 的数据， $1\\leq k\\leq n\\leq 10$\n\n对于 $100\\%$ 的数据， $1\\leq n\\leq 10^5,1 \\leq T \\leq 100,\\sum n \\leq 3 * 10^6$ ，输入的字符串中仅包含小写英文字母。", "locale": "zh-CN", "translations": {"en": {"title": "[TJOI2019] Mr. Toluene and Striker’s String", "background": "TJOI2019 D2T2.\n\nSource file name: substring.*.\n\nTime limit: 1 s. Memory limit: 128 MB.", "description": "Striker has a string of length $n$. He only knows that one of its substrings is the password to a family treasure passed down from his ancestors. But since the string is very long, it is hard for Striker to try all substrings one by one.\n\nOne day, Striker went to Mr. Toluene for fortune-telling, but Mr. Toluene said: “Heaven’s secrets must not be revealed.”\n\nAfter Striker’s repeated pleas, Mr. Toluene told him: “The password is a substring that appears exactly $k$ times in the string.”\n\nBut Striker still did not know what to do. After even more pleading, Mr. Toluene, seeing his sincerity, added: “Among the substrings that appear exactly $k$ times, classify them by substring length. The password is in the length group with the largest count.”\n\nTo try the password, Striker wants you to help find the length value whose count is the largest among substrings that appear $k$ times (if there are multiple answers, output the longest length).", "inputFormat": "The first line contains a positive integer $T$, meaning there are $T$ test cases.\n\nIn the next $T$ lines, each line contains a string and a positive integer $k$.", "outputFormat": "Output $T$ lines in total. Each line contains one integer: among substrings that appear exactly $k$ times, output the length that has the largest number of such substrings. If no substring appears exactly $k$ times, output $-1$.", "hint": "### Data Explanation ###\n\nFor the first test case: the substrings $b, aa, ab, aab$ all appear once. Among them, substrings of length $1$ appear $1$ time, length $2$ appear $2$ times, and length $3$ appear $1$ time. So the answer is $2$.\n\nFor the second test case: the substrings $a, b, c, ab, bc, abc$ all appear once. Among them, substrings of length $1$ appear $3$ times, length $2$ appear $2$ times, and length $3$ appear $1$ time. So the answer is $1$.\n\nFor the third test case: the substring $aaa$ appears twice. Substrings of length $3$ appear $1$ time, and there are none for all other lengths. So the answer is $3$.\n\nFor the fourth test case: the substrings $a, b, ab$ appear twice. Among them, substrings of length $1$ appear $2$ times, and length $2$ appear $1$ time. So the answer is $1$.\n\nFor the fifth test case: the substrings $b, c, ab, ba$ appear twice. Among them, substrings of length $1$ appear $2$ times, and length $2$ appear $2$ times. So the answer is $2$.\n\nFor the sixth test case: no substring appears four times. So the answer for this problem is $-1$.\n\n### Constraints ###\n\nFor $20\\%$ of the testdata, $1 \\leq k \\leq n \\leq 10$.\n\nFor $100\\%$ of the testdata, $1 \\leq n \\leq 10^5$, $1 \\leq T \\leq 100$, $\\sum n \\leq 3 * 10^6$. The input strings contain only lowercase English letters.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[TJOI2019] 甲苯先生和大中锋的字符串", "background": "TJOI2019 D2T2\n\n源文件名：substring.*\n\n时间限制: 1s 内存限制: 128M", "description": "大中锋有一个长度为 $n$ 的字符串，他只知道其中的一个子串是祖上传下来的宝藏的密码。但是由于字符串很长，大中锋很难将这些子串一一尝试。\n\n这天大中锋找到甲苯先生算命，但是甲苯先生说：“天机不可泄漏”。\n\n在大中锋的苦苦哀求下，甲苯先生告诉大中锋：“密码是在字符串中恰好出现了 $k$ 次的子串”。\n\n但是大中锋不知道该怎么做，在大中锋再三的恳求下，甲苯先生看其真诚，又告诉他：“在恰好出现了 $k$ 次的子串中，你去按照字串的长度分类，密码就在数量最多的那一类里”。\n\n大中锋为了尝试这个密码，想让你帮忙找出子串长度出现次数最多的长度数（如果有多个输出最长长度）。", "inputFormat": "第一行一个正整数 $T$ ，表示有 $T$ 组测试数据。\n\n接下来 $T$ 行每行包含一个字符串和一个正整数 $k$ 。", "outputFormat": "一共输出 $T$ 行，每行一个整数表示在出现 $k$ 次的子串中出现次数的最多的长度。如果不存在子串出现 $k$ 次，则输出 $-1$ 。", "hint": "### 数据说明 ###\n\n对于第一个数据：其中子串 $b, aa, ab, aab$ 均只出现一次，其中长度为 $1$ 的子串出现了 $1$ 次，长度为 $2$ 的子串出现了 $2$ 次，长度为 $3$ 的子串出现了 $1$ 次。所以答案为 $2$ 。\n\n对于第二个数据：其中子串 $a, b, c, ab, bc, abc$ 均只出现一次，其中长度为 $1$ 的子串出现了 $3$ 次，长度为 $2$ 的子串出现了 $2$ 次，长度为 $3$ 的子串出现了 $1$ 次。所以答案为 $1$ 。\n\n对于第三个数据：其中子串 $aaa$ 出现二次，长度为 $3$ 的子串出现了 $1$ 次，其他长度均没有。所以答案为 $3$ 。\n\n对于第四个数据：其中子串 $a, b, ab$ 出现二次，其中长度为 $1$ 的子串出现了 $2$ 次，长度为 $2$ 的子串出现了 $1$ 次。所以答案为 $1$ 。\n\n对于第五个数据：其中子串 $b, c, ab, ba$ 出现二次，其中长度为 $1$ 的子串出现了 $2$ 次，长度为 $2$ 的子串出现了 $2$ 次。所以答案为 $2$ 。\n\n对于第六个数据：其中子串没有出现四次。所以本题的本题的答案为 $-1$ 。\n\n### 数据范围 ###\n\n对于 $20\\%$ 的数据， $1\\leq k\\leq n\\leq 10$\n\n对于 $100\\%$ 的数据， $1\\leq n\\leq 10^5,1 \\leq T \\leq 100,\\sum n \\leq 3 * 10^6$ ，输入的字符串中仅包含小写英文字母。", "locale": "zh-CN"}}}
{"pid": "P5342", "type": "P", "difficulty": 7, "samples": [["8\n3 1 1 1\n3 1 1 2\n3 1 2 1\n3 1 2 2\n3 2 4 1\n3 2 4 2\n3 1 5 1\n3 1 5 2", "1\n0\n3\n1\n6\n2\n8\n0"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "各省省选", "天津"], "title": "[TJOI2019] 甲苯先生的线段树", "background": "TJOI2019 D2T3\n\n源文件名：segment.*\n\n时间限制: 4s 内存限制: 128M", "description": "大中锋走在路上见到正在战术后仰的甲苯先生。因为甲苯先生帮助他解决了祖传 `Hello word!` 的代码密码，大中锋想上前打个招呼。\n\n甲苯先生突然举起喇叭说：「大家好，我是甲苯拦你斯特，是凯岩城的首席文化大使，七十二变显神通，百般武艺样样有，感受不一样的权游文化。」\n\n这时甲苯先生看到了大中锋，激动的拉着大中锋说：「为了筹钱去北境打异鬼，我参加了今年下半年中外合写的 `stl+` 项目，我将在项目中担任线段树的主写人，但是改写不是乱写，在我写的时候，发现线段树是一个满二叉树，如果让根节点编号为 $1$，对于一个编号为 $x$ 的节点，令左孩子编号为 $2x$ ，右孩子编号为 $2x+1$ 时，现在在这个二叉树上有两个节点 $a,b$，现在我想知道节点 $a$ 到节点 $b$ 之间一条路径编号和最小为多少？你要是不会就直接给我 328，我不知道什么是暗影崛起，也不知道什么是怪盗军团。」\n\n大中锋回答：「那不就是求一条简单路径直接算吗？」甲苯先生：「那你求这颗满二叉树中还有多少条简单路径等于这个值？不知道了吧，给我 328，我到北境打赢异鬼，回到凯岩城我就还你，我们拦你斯特，有债必偿。」\n\n大中锋为了不给甲苯先生 328，请求作为好朋友的你写一个程序能解决甲苯先生的问题。\n\n简单路径指的是路径上各个顶点均不重复的路径。", "inputFormat": "第一行一个正整数 $T$，表示有 $T$ 组测试数据。\n\n接下来 $T$ 行，每行包含 $4$ 个正整数 $d,a,b,c$。其中 $d$ 表示满二叉树的树高，$a，b $表示二叉树上的两个节点，$c$ 表示要回答甲苯先生的问题类别，$c=1$ 时，回答甲苯先生第一个问题（点 $a$ 到点 $b$ 的最小路径上的编号和），$c=2$ 时，回答甲苯先生的第二个问题，即回答除了从点 $a$ 到点 $b$ 的路径外与点 $a$ 到点 $b$ 的最小编号路径有相同编号和的简单路径的条数。\n", "outputFormat": "对于每组输入，输出一行，每行包含一个正整数，表示甲苯先生问题的答案。", "hint": "### 样例解释 ###\n\n对于一颗深度为 $3$ 的满二叉树，含有节点 $1,2,3,4,5,6,7$ 。\n\n节点 $1$ 到 $1$ 的路径编号和为 $1$ ，且没有其他路径编号和为 $1$ 。\n\n节点 $1$ 到 $2$ 的路径编号和为 $1+2=3$ ，存在路径 3-3 编号和为 $3$。\n\n节点 $2$ 到 $4$ 的路径编号和为 $2+4=6$ ，存在路径 2-1-3 和路径 6-6 编号和为 $6$ 。\n\n节点 $1$ 到 $5$ 的路径编号和为 $1+2+5=8$ ，存在路径 8-8 编号和为 $8$ ，但是节点 $8$ 的深度为 $4$ 不满足条件。\n\n### 数据范围 ###\n\n对于 $20\\%$ 的数据，仅存在 $c = 1$ 的情况\n\n对于 $20\\%$ 的数据， $d \\leq 10$\n\n对于 $30\\%$ 的数据， $d \\leq 20$\n\n对于 $40\\%$ 的数据， $d \\leq 25$\n\n对于 $50\\%$ 的数据， $d \\leq 30$\n\n对于 $100\\%$ 的数据， $d \\leq 50,T \\leq 10$\n", "locale": "zh-CN", "translations": {"en": {"title": "[TJOI2019] Mr. Toluene’s Segment Tree", "background": "TJOI2019 D2T3.\n\nSource file name: segment.*.\n\nTime limit: 4 s. Memory limit: 128 M.", "description": "Da Zhongfeng was walking on the road and saw Mr. Toluene doing a tactical fadeaway. Because Mr. Toluene helped him crack the code password of the family-inherited `Hello word!`, Da Zhongfeng wanted to go up and say hello.\n\nMr. Toluene suddenly raised a loudspeaker and said: “Hello everyone, I am Toluene Lannister, the chief cultural ambassador of Casterly Rock. I can transform in seventy-two ways, and I am good at all kinds of skills. Feel a different Game of Thrones culture.”\n\nAt this time, Mr. Toluene saw Da Zhongfeng and excitedly grabbed him and said: “To raise money to go to the North to fight the White Walkers, I joined the `stl+` project co-written by China and foreign teams in the second half of this year. I will be the main writer of the segment tree in the project. But rewriting is not random writing. When I was writing, I found that a segment tree is a perfect binary tree. If we label the root as $1$, then for a node labeled $x$, let the left child be labeled $2x$ and the right child be labeled $2x+1$. Now, in this binary tree there are two nodes $a, b$. I want to know: along the path from node $a$ to node $b$, what is the minimum possible value of the sum of node labels on that path? If you can’t do it, just give me 328. I don’t know what Shadowbrink Rising is, and I don’t know what the Phantom Thief Legion is either.”\n\nDa Zhongfeng replied: “Isn’t that just computing a simple path directly?” Mr. Toluene said: “Then tell me how many simple paths in this perfect binary tree are equal to this value? You don’t know, right? Give me 328. After I defeat the White Walkers in the North and return to Casterly Rock, I will pay you back. We Lannisters always pay our debts.”\n\nTo avoid giving Mr. Toluene 328, Da Zhongfeng asked you, as a good friend, to write a program to solve Mr. Toluene’s problem.\n\nA simple path means a path in which no vertex repeats.", "inputFormat": "The first line contains a positive integer $T$, meaning there are $T$ test cases.\n\nNext, there are $T$ lines. Each line contains $4$ positive integers $d, a, b, c$. Here, $d$ is the height of the perfect binary tree, $a, b$ are two nodes in the binary tree, and $c$ indicates which type of question Mr. Toluene asks. When $c=1$, answer Mr. Toluene’s first question (the minimum sum of labels on the path from node $a$ to node $b$). When $c=2$, answer Mr. Toluene’s second question, i.e., the number of simple paths that have the same label-sum as the minimum-label-sum path from node $a$ to node $b$, excluding the path from node $a$ to node $b$ itself.", "outputFormat": "For each test case, output one line containing one positive integer, the answer to Mr. Toluene’s question.", "hint": "### Sample Explanation\n\nFor a perfect binary tree of depth $3$, it contains nodes $1, 2, 3, 4, 5, 6, 7$.\n\nThe label-sum of the path from node $1$ to node $1$ is $1$, and there is no other path whose label-sum is $1$.\n\nThe label-sum of the path from node $1$ to node $2$ is $1+2=3$. There exists a path $3-3$ whose label-sum is $3$.\n\nThe label-sum of the path from node $2$ to node $4$ is $2+4=6$. There exist the path $2-1-3$ and the path $6-6$ whose label-sum is $6$.\n\nThe label-sum of the path from node $1$ to node $5$ is $1+2+5=8$. There exists a path $8-8$ whose label-sum is $8$, but node $8$ has depth $4$, which does not satisfy the condition.\n\n### Constraints\n\nFor $20\\%$ of the testdata, there are only cases with $c = 1$.\n\nFor $20\\%$ of the testdata, $d \\leq 10$.\n\nFor $30\\%$ of the testdata, $d \\leq 20$.\n\nFor $40\\%$ of the testdata, $d \\leq 25$.\n\nFor $50\\%$ of the testdata, $d \\leq 30$.\n\nFor $100\\%$ of the testdata, $d \\leq 50, T \\leq 10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[TJOI2019] 甲苯先生的线段树", "background": "TJOI2019 D2T3\n\n源文件名：segment.*\n\n时间限制: 4s 内存限制: 128M", "description": "大中锋走在路上见到正在战术后仰的甲苯先生。因为甲苯先生帮助他解决了祖传 `Hello word!` 的代码密码，大中锋想上前打个招呼。\n\n甲苯先生突然举起喇叭说：「大家好，我是甲苯拦你斯特，是凯岩城的首席文化大使，七十二变显神通，百般武艺样样有，感受不一样的权游文化。」\n\n这时甲苯先生看到了大中锋，激动的拉着大中锋说：「为了筹钱去北境打异鬼，我参加了今年下半年中外合写的 `stl+` 项目，我将在项目中担任线段树的主写人，但是改写不是乱写，在我写的时候，发现线段树是一个满二叉树，如果让根节点编号为 $1$，对于一个编号为 $x$ 的节点，令左孩子编号为 $2x$ ，右孩子编号为 $2x+1$ 时，现在在这个二叉树上有两个节点 $a,b$，现在我想知道节点 $a$ 到节点 $b$ 之间一条路径编号和最小为多少？你要是不会就直接给我 328，我不知道什么是暗影崛起，也不知道什么是怪盗军团。」\n\n大中锋回答：「那不就是求一条简单路径直接算吗？」甲苯先生：「那你求这颗满二叉树中还有多少条简单路径等于这个值？不知道了吧，给我 328，我到北境打赢异鬼，回到凯岩城我就还你，我们拦你斯特，有债必偿。」\n\n大中锋为了不给甲苯先生 328，请求作为好朋友的你写一个程序能解决甲苯先生的问题。\n\n简单路径指的是路径上各个顶点均不重复的路径。", "inputFormat": "第一行一个正整数 $T$，表示有 $T$ 组测试数据。\n\n接下来 $T$ 行，每行包含 $4$ 个正整数 $d,a,b,c$。其中 $d$ 表示满二叉树的树高，$a，b $表示二叉树上的两个节点，$c$ 表示要回答甲苯先生的问题类别，$c=1$ 时，回答甲苯先生第一个问题（点 $a$ 到点 $b$ 的最小路径上的编号和），$c=2$ 时，回答甲苯先生的第二个问题，即回答除了从点 $a$ 到点 $b$ 的路径外与点 $a$ 到点 $b$ 的最小编号路径有相同编号和的简单路径的条数。\n", "outputFormat": "对于每组输入，输出一行，每行包含一个正整数，表示甲苯先生问题的答案。", "hint": "### 样例解释 ###\n\n对于一颗深度为 $3$ 的满二叉树，含有节点 $1,2,3,4,5,6,7$ 。\n\n节点 $1$ 到 $1$ 的路径编号和为 $1$ ，且没有其他路径编号和为 $1$ 。\n\n节点 $1$ 到 $2$ 的路径编号和为 $1+2=3$ ，存在路径 3-3 编号和为 $3$。\n\n节点 $2$ 到 $4$ 的路径编号和为 $2+4=6$ ，存在路径 2-1-3 和路径 6-6 编号和为 $6$ 。\n\n节点 $1$ 到 $5$ 的路径编号和为 $1+2+5=8$ ，存在路径 8-8 编号和为 $8$ ，但是节点 $8$ 的深度为 $4$ 不满足条件。\n\n### 数据范围 ###\n\n对于 $20\\%$ 的数据，仅存在 $c = 1$ 的情况\n\n对于 $20\\%$ 的数据， $d \\leq 10$\n\n对于 $30\\%$ 的数据， $d \\leq 20$\n\n对于 $40\\%$ 的数据， $d \\leq 25$\n\n对于 $50\\%$ 的数据， $d \\leq 30$\n\n对于 $100\\%$ 的数据， $d \\leq 50,T \\leq 10$\n", "locale": "zh-CN"}}}
{"pid": "P5343", "type": "P", "difficulty": 4, "samples": [["4\n3\n1 2 3\n3\n1 2 4", "5"], ["19260817\n7\n8 9 6 3 7 2 1\n7\n4 5 2 9 7 8 3", "859254329"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "动态规划优化", "矩阵加速", "矩阵乘法"], "title": "【XR-1】分块", "background": "xht37 喜欢分块，以至于对一道**不需要分块**的题也要分块做。", "description": "有一个长度为 $n$ 的序列，xht37 现在想分块维护它。\n\nPinkRabbit 要求他只准将序列分成 $PR$ 种长度的块。\n\nNaCly_Fish 要求他只准将序列分成 $NF$ 种长度的块。\n\n同一个人可能会要求 xht37 多次相同的块长。\n\nxht37 想同时满足 PinkRabbit 和 NaCly_Fish 要求，只好使用两个人都允许的长度分块。\n\nxht37 想知道，有多少种不同的分块方案，答案对 $10 ^ 9 + 7$ 取模。", "inputFormat": "第一行一个正整数 $n$，表示序列的长度。\n\n第二行一个正整数 $PR$，表示 PinkRabbit 要求的分块长度的种类数。\n\n第三行 $PR$ 个正整数，表示 PinkRabbit 要求的 $PR$ 种分块长度。\n\n第四行一个正整数 $NF$，表示 NaCly_Fish 要求的分块长度的种类数。\n\n第五行 $NF$ 个正整数，表示 NaCly_Fish 要求的 $NF$ 种分块长度。", "outputFormat": "输出一行一个整数，表示不同分块方案的种类数对 $10 ^ 9 + 7$ 取模的值。", "hint": "【样例 $1$ 说明】\n\nPinkRabbit 和 NaCly_Fish 都允许的块长为 $\\{1,2\\}$。\n\n长度为 $4$ 的序列分块，每块长度为 $\\{1,2\\}$ 的方案有：\n\n- $1\\ 1\\ 1\\ 1$\n- $1\\ 1\\ 2$\n- $1\\ 2\\ 1$\n- $2\\ 1\\ 1$\n- $2\\ 2$\n\n共 $5$ 种。\n\n【数据规模与约定】\n\n设最大块长为 $x$。\n\n对于 $60 \\%$ 的数据，$1 \\le n \\le 10 ^ 6$，$1 \\le PR,NF,x \\le 10$，保证同一个人不会要求多次相同的块长。\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le 10 ^ {18}$，$1 \\le PR,NF,x \\le 100$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-1] Block Decomposition", "background": "xht37 likes block decomposition so much that he even uses it to solve a problem that **does not need block decomposition**.", "description": "There is a sequence of length $n$, and xht37 now wants to maintain it using block decomposition.\n\nPinkRabbit requires that he may only divide the sequence into blocks whose lengths come from $PR$ allowed lengths.\n\nNaCly_Fish requires that he may only divide the sequence into blocks whose lengths come from $NF$ allowed lengths.\n\nThe same person may request the same block length multiple times.\n\nxht37 wants to satisfy both PinkRabbit and NaCly_Fish, so he has to use block lengths that are allowed by both of them.\n\nxht37 wants to know how many different block decomposition schemes there are. Output the answer modulo $10 ^ 9 + 7$.", "inputFormat": "The first line contains a positive integer $n$, which is the length of the sequence.\n\nThe second line contains a positive integer $PR$, which is the number of allowed block lengths requested by PinkRabbit.\n\nThe third line contains $PR$ positive integers, representing the $PR$ block lengths requested by PinkRabbit.\n\nThe fourth line contains a positive integer $NF$, which is the number of allowed block lengths requested by NaCly_Fish.\n\nThe fifth line contains $NF$ positive integers, representing the $NF$ block lengths requested by NaCly_Fish.", "outputFormat": "Output one line with one integer, which is the number of different block decomposition schemes modulo $10 ^ 9 + 7$.", "hint": "[Sample $1$ Explanation]\n\nThe block lengths allowed by both PinkRabbit and NaCly_Fish are $\\{1,2\\}$.\n\nFor a sequence of length $4$, the schemes that divide it into blocks with lengths in $\\{1,2\\}$ are:\n\n- $1\\ 1\\ 1\\ 1$\n- $1\\ 1\\ 2$\n- $1\\ 2\\ 1$\n- $2\\ 1\\ 1$\n- $2\\ 2$\n\nThere are $5$ schemes in total.\n\n[Constraints]\n\nLet the maximum block length be $x$.\n\nFor $60 \\%$ of the testdata, $1 \\le n \\le 10 ^ 6$, $1 \\le PR,NF,x \\le 10$, and it is guaranteed that the same person will not request the same block length multiple times.\n\nFor $100 \\%$ of the testdata, $1 \\le n \\le 10 ^ {18}$, $1 \\le PR,NF,x \\le 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-1】分块", "background": "xht37 喜欢分块，以至于对一道**不需要分块**的题也要分块做。", "description": "有一个长度为 $n$ 的序列，xht37 现在想分块维护它。\n\nPinkRabbit 要求他只准将序列分成 $PR$ 种长度的块。\n\nNaCly_Fish 要求他只准将序列分成 $NF$ 种长度的块。\n\n同一个人可能会要求 xht37 多次相同的块长。\n\nxht37 想同时满足 PinkRabbit 和 NaCly_Fish 要求，只好使用两个人都允许的长度分块。\n\nxht37 想知道，有多少种不同的分块方案，答案对 $10 ^ 9 + 7$ 取模。", "inputFormat": "第一行一个正整数 $n$，表示序列的长度。\n\n第二行一个正整数 $PR$，表示 PinkRabbit 要求的分块长度的种类数。\n\n第三行 $PR$ 个正整数，表示 PinkRabbit 要求的 $PR$ 种分块长度。\n\n第四行一个正整数 $NF$，表示 NaCly_Fish 要求的分块长度的种类数。\n\n第五行 $NF$ 个正整数，表示 NaCly_Fish 要求的 $NF$ 种分块长度。", "outputFormat": "输出一行一个整数，表示不同分块方案的种类数对 $10 ^ 9 + 7$ 取模的值。", "hint": "【样例 $1$ 说明】\n\nPinkRabbit 和 NaCly_Fish 都允许的块长为 $\\{1,2\\}$。\n\n长度为 $4$ 的序列分块，每块长度为 $\\{1,2\\}$ 的方案有：\n\n- $1\\ 1\\ 1\\ 1$\n- $1\\ 1\\ 2$\n- $1\\ 2\\ 1$\n- $2\\ 1\\ 1$\n- $2\\ 2$\n\n共 $5$ 种。\n\n【数据规模与约定】\n\n设最大块长为 $x$。\n\n对于 $60 \\%$ 的数据，$1 \\le n \\le 10 ^ 6$，$1 \\le PR,NF,x \\le 10$，保证同一个人不会要求多次相同的块长。\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le 10 ^ {18}$，$1 \\le PR,NF,x \\le 100$。", "locale": "zh-CN"}}}
{"pid": "P5344", "type": "P", "difficulty": 6, "samples": [["9 11 5\n2 2 1 2\n2 3 1 5\n2 4 2 10\n2 5 3 9\n2 6 5 3\n2 7 6 6\n2 8 7 2\n2 9 4 2\n1 1 1 4 9 2\n1 8 5 1 6 1\n1 3 6 9 6 1", "1 1 1 1 0 1 7 9 1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["倍增", "洛谷原创", "O2优化", "最短路", "最近公共祖先 LCA", "ST 表"], "title": "【XR-1】逛森林", "background": "NaCly_Fish 和 PinkRabbit 是好朋友。\n\n有一天她去森林里游玩，回去跟 PinkRabbit 说：“我发现好多棵会动的树耶！”\n\nPinkRabbit 动了动一只兔耳朵：“这有什么好稀奇的，我用一只兔耳朵就能维护每棵树的形态。”\n\nNaCly_Fish 不服：“不止这样，我还看到有一些传送门，能从一条树枝跳到另一条树枝上呢！”\n\nPinkRabbit 动了动另一只兔耳朵：“这有什么好稀奇的，我用两只兔耳朵就能统计每个传送门的信息。”\n\n![](https://cdn.luogu.com.cn/upload/pic/57782.png)\n\n于是 NaCly_Fish 很郁闷，她向你求助，请帮帮她吧。\n\n什么？你不愿意帮？\n\n那她就不给你这题的分了。", "description": "给你 $n$ 个节点的森林，初始没有边。\n\n有 $m$ 个操作，分为两种：\n\n$1\\ u_1\\ v_1\\ u_2\\ v_2\\ w$：表示构建一个单向传送门，从 $u_1 \\rightarrow v_1$ 简单路径上的所有节点，可以花费 $w$ 的代价，到达 $u_2 \\rightarrow v_2$ 简单路径上的所有节点。若 $u_1$ 到 $v_1$ 或 $u_2$ 到 $v_2$ 不连通（由 $2$ 操作产生的边不连通），则忽略此次操作。\n\n$2\\ u\\ v\\ w$：表示将 $u$ 和 $v$ 节点间连一条花费为 $w$ 的无向边，若 $u$ 和 $v$ 之间已连通（由 $2$ 操作产生的边连通）则忽略此次操作。\n\n经过这 $m$ 次操作后，请你求出从 $s$ 节点出发，到每个节点的最小花费。", "inputFormat": "第一行三个正整数 $n, m, s$，分别表示树的节点数、操作数、和起始节点。\n\n接下来 $m$ 行，每行若干个正整数，表示一次操作。", "outputFormat": "输出一行 $n$ 个整数，第 $i$ 个整数表示从 $s$ 节点出发，到 $i$ 节点的最小花费。特别地，若不能到达$i$节点，则输出 `-1`。", "hint": "【样例说明】\n\n这是样例中给出的树（严格来讲，这棵树也是一条链）：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g1kmzdbv.png)\n\n有三个传送门，其中两个是这样的：\n\n- 从 $1$ 号点可以花费 $2$ 的代价到达 $4 \\rightarrow 9$ 简单路径上的所有节点（即 $4, 9$ 号点）。\n- 从 $8 \\rightarrow 5$ 简单路径上的所有节点（即 $8, 7, 6, 5$ 号点）可以花费 $1$ 的代价到达 $1 \\rightarrow 6$ 简单路径上的所有节点（即 $1, 3, 5, 6$ 号点）。\n\n容易看出从 $5$ 号节点出发，到达其它节点的最小花费分别为：$1, 1, 1, 1, 0, 1, 7, 9, 1$。\n\n【数据规模与约定】\n\n对于第 $1, 2$ 个测试点，$1 \\le n \\le 100$，$1 \\le m \\le 300$。\n\n对于第 $3, 4$ 个测试点，$1 \\le n \\le 1000$，$1 \\le m \\le 3000$。\n\n对于 $100\\%$ 的数据，$1\\le n \\le 50000$，$1\\le m \\le 10^6$，$1\\le u,v \\le n$，$1\\le w \\le 100$。\n\n对于第 $1$ ~ $10$ 个测试点，每个 $5$ 分。\n\n对于第 $11, 12$ 个测试点，每个 $25$ 分。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-1] Strolling in the Forest", "background": "NaCly_Fish and PinkRabbit are good friends.\n\nOne day, she went to the forest for fun. After coming back, she said to PinkRabbit: “I found many trees that can move!”\n\nPinkRabbit twitched one rabbit ear: “What is so strange about that? With one rabbit ear, I can maintain the shape of every tree.”\n\nNaCly_Fish was not convinced: “Not only that. I also saw some portals. They can jump from one branch to another!”\n\nPinkRabbit twitched the other rabbit ear: “What is so strange about that? With two rabbit ears, I can count the information of every portal.”\n\n![](https://cdn.luogu.com.cn/upload/pic/57782.png)\n\nSo NaCly_Fish felt very depressed, and she asked you for help. Please help her.\n\nWhat? You are not willing to help?\n\nThen she will not give you the points for this problem.", "description": "You are given a forest with $n$ nodes, with no edges at the beginning.\n\nThere are $m$ operations, of two types:\n\n$1\\ u_1\\ v_1\\ u_2\\ v_2\\ w$: Build a directed portal. From all nodes on the simple path $u_1 \\rightarrow v_1$, you can pay cost $w$ to reach all nodes on the simple path $u_2 \\rightarrow v_2$. If $u_1$ and $v_1$ are not connected, or $u_2$ and $v_2$ are not connected (connectivity is determined only by edges added by type $2$ operations), then ignore this operation.\n\n$2\\ u\\ v\\ w$: Add an undirected edge of cost $w$ between nodes $u$ and $v$. If $u$ and $v$ are already connected (connectivity is determined only by edges added by type $2$ operations), then ignore this operation.\n\nAfter these $m$ operations, find the minimum cost from node $s$ to every node.", "inputFormat": "The first line contains three positive integers $n, m, s$, representing the number of nodes in the tree, the number of operations, and the starting node.\n\nThe next $m$ lines each contain several positive integers, describing one operation.", "outputFormat": "Output one line with $n$ integers. The $i$-th integer is the minimum cost from node $s$ to node $i$. In particular, if node $i$ cannot be reached, output `-1`.", "hint": "[Sample Explanation]\n\nThis is the tree given in the sample (strictly speaking, this tree is also a chain):\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g1kmzdbv.png)\n\nThere are three portals, and two of them are like this:\n\n- From node $1$, you can pay cost $2$ to reach all nodes on the simple path $4 \\rightarrow 9$ (that is, nodes $4$ and $9$).\n- From all nodes on the simple path $8 \\rightarrow 5$ (that is, nodes $8, 7, 6, 5$), you can pay cost $1$ to reach all nodes on the simple path $1 \\rightarrow 6$ (that is, nodes $1, 3, 5, 6$).\n\nIt is easy to see that starting from node $5$, the minimum costs to reach the other nodes are: $1, 1, 1, 1, 0, 1, 7, 9, 1$.\n\n[Constraints]\n\nFor test points $1, 2$, $1 \\le n \\le 100$, $1 \\le m \\le 300$.\n\nFor test points $3, 4$, $1 \\le n \\le 1000$, $1 \\le m \\le 3000$.\n\nFor $100\\%$ of the data, $1 \\le n \\le 50000$, $1 \\le m \\le 10^6$, $1 \\le u,v \\le n$, $1 \\le w \\le 100$.\n\nFor test points $1$ to $10$, each is worth $5$ points.\n\nFor test points $11, 12$, each is worth $25$ points.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-1】逛森林", "background": "NaCly_Fish 和 PinkRabbit 是好朋友。\n\n有一天她去森林里游玩，回去跟 PinkRabbit 说：“我发现好多棵会动的树耶！”\n\nPinkRabbit 动了动一只兔耳朵：“这有什么好稀奇的，我用一只兔耳朵就能维护每棵树的形态。”\n\nNaCly_Fish 不服：“不止这样，我还看到有一些传送门，能从一条树枝跳到另一条树枝上呢！”\n\nPinkRabbit 动了动另一只兔耳朵：“这有什么好稀奇的，我用两只兔耳朵就能统计每个传送门的信息。”\n\n![](https://cdn.luogu.com.cn/upload/pic/57782.png)\n\n于是 NaCly_Fish 很郁闷，她向你求助，请帮帮她吧。\n\n什么？你不愿意帮？\n\n那她就不给你这题的分了。", "description": "给你 $n$ 个节点的森林，初始没有边。\n\n有 $m$ 个操作，分为两种：\n\n$1\\ u_1\\ v_1\\ u_2\\ v_2\\ w$：表示构建一个单向传送门，从 $u_1 \\rightarrow v_1$ 简单路径上的所有节点，可以花费 $w$ 的代价，到达 $u_2 \\rightarrow v_2$ 简单路径上的所有节点。若 $u_1$ 到 $v_1$ 或 $u_2$ 到 $v_2$ 不连通（由 $2$ 操作产生的边不连通），则忽略此次操作。\n\n$2\\ u\\ v\\ w$：表示将 $u$ 和 $v$ 节点间连一条花费为 $w$ 的无向边，若 $u$ 和 $v$ 之间已连通（由 $2$ 操作产生的边连通）则忽略此次操作。\n\n经过这 $m$ 次操作后，请你求出从 $s$ 节点出发，到每个节点的最小花费。", "inputFormat": "第一行三个正整数 $n, m, s$，分别表示树的节点数、操作数、和起始节点。\n\n接下来 $m$ 行，每行若干个正整数，表示一次操作。", "outputFormat": "输出一行 $n$ 个整数，第 $i$ 个整数表示从 $s$ 节点出发，到 $i$ 节点的最小花费。特别地，若不能到达$i$节点，则输出 `-1`。", "hint": "【样例说明】\n\n这是样例中给出的树（严格来讲，这棵树也是一条链）：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g1kmzdbv.png)\n\n有三个传送门，其中两个是这样的：\n\n- 从 $1$ 号点可以花费 $2$ 的代价到达 $4 \\rightarrow 9$ 简单路径上的所有节点（即 $4, 9$ 号点）。\n- 从 $8 \\rightarrow 5$ 简单路径上的所有节点（即 $8, 7, 6, 5$ 号点）可以花费 $1$ 的代价到达 $1 \\rightarrow 6$ 简单路径上的所有节点（即 $1, 3, 5, 6$ 号点）。\n\n容易看出从 $5$ 号节点出发，到达其它节点的最小花费分别为：$1, 1, 1, 1, 0, 1, 7, 9, 1$。\n\n【数据规模与约定】\n\n对于第 $1, 2$ 个测试点，$1 \\le n \\le 100$，$1 \\le m \\le 300$。\n\n对于第 $3, 4$ 个测试点，$1 \\le n \\le 1000$，$1 \\le m \\le 3000$。\n\n对于 $100\\%$ 的数据，$1\\le n \\le 50000$，$1\\le m \\le 10^6$，$1\\le u,v \\le n$，$1\\le w \\le 100$。\n\n对于第 $1$ ~ $10$ 个测试点，每个 $5$ 分。\n\n对于第 $11, 12$ 个测试点，每个 $25$ 分。", "locale": "zh-CN"}}}
{"pid": "P5345", "type": "P", "difficulty": 6, "samples": [["2\n4 7 4\n2 5 3", "7"], ["2\n4 7 3\n2 5 3", "Impossible"], ["2\n4 7 1\n2 5 1", "0"], ["3\n14 60 44\n6 50 6\n1029 91287 87318", "101"], ["1\n6 65536 65536", "16"], ["2\n2 2 2\n2 3 1\n", "2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "中国剩余定理 CRT"], "title": "【XR-1】快乐肥宅", "background": "小粉兔的机房里面有 $n$ 个快乐肥宅，但小粉兔自己并不是，他看着这些快乐肥宅，非常羡慕，于是他想研究一下这些快乐肥宅的体重。", "description": "每个快乐肥宅第 $0$ 天的体重都等于 $1$。第 $i$ 个快乐肥宅的体重记作 $w_i$，则一开始 $w_i = 1$。\n\n第 $i$ 个快乐肥宅有一个专属的快乐指数 $k_i$，这表示他每天刚起床后，体重会是上一天的体重的 $k_i$ 倍。\n\n肥宅们是有觉悟的，第 $i$ 个肥宅有一个专属的觉醒体重 $g_i$，这表示一旦他的体重**大于** $g_i$，他就会去健身房健身，每次减掉自己 $g_i$ 的体重，直到体重小于等于 $g_i$。\n\n健身后，肥宅们会在机房见面，他们发现有时各自的体重会变得很有趣。\n\n有一天，肥宅们发现各自的体重形成了等差数列！\n\n另一天，肥宅们发现各自的体重形成了等比数列！\n\n肥宅们心想，如果 $n$ 个快乐肥宅的体重 $\\{w_1, w_2, \\ldots, w_n\\}$ 恰好形成序列 $\\{r_1, r_2, \\ldots, r_n\\}$，至少需要经过多少天呢？\n\n不过如果肥宅们等了很久都没有等到这一天，他们会认为这是不可能的。", "inputFormat": "第一行为一个正整数 $n$。\n\n接下来 $n$ 行，每行三个正整数 $k_i, g_i, r_i$。分别表示第 $i$ 个肥宅的快乐指数、觉醒体重和序列中的体重。", "outputFormat": "如果在第 $10^9$ 天结束前已经形成给定的序列，则输出一个数，表示至少需要经过的天数。\n\n如果在第 $10^9$ 天结束前没有形成给定的序列，则输出 `Impossible`。", "hint": "【样例 $1$ 说明】\n\n下表是两个肥宅在第 $0$ 天至第 $7$ 天时的体重变化表：\n\n| 天数 | 肥宅 $1$ 的体重 | 肥宅 $2$ 的体重 | 解释 |\n| :--: | :--: | :--: | :--: |\n| $0$ | $1$ | $1$ | 第 $0$ 天每个肥宅的体重都是 $1$ |\n| $1$ | $4$ | $2$ | 肥宅 $1$ 的体重是上一天的 $4$ 倍，肥宅 $2$ 的体重是上一天的 $2$ 倍 |\n| $2$ | $2$ | $4$ | 肥宅 $1$ 的体重是上一天的 $4$ 倍，为 $16$，他发现自己的体重超过了 $7$，于是去了两次健身房，把体重减少了 $2\\times 7=14$ |\n| $3$ | $1$ | $3$ | 这一天肥宅 $1$ 和肥宅 $2$ 都去了一次健身房 |\n| $4$ | $4$ | $1$ | 肥宅 $2$ 去了一次健身房 |\n| $5$ | $2$ | $2$ | 肥宅 $1$ 去了两次健身房 |\n| $6$ | $1$ | $4$ | 肥宅 $1$ 去了一次健身房 |\n| $7$ | $4$ | $3$ | 肥宅 $2$ 去了一次健身房 |\n\n可以看出在第 $7$ 天时肥宅的体重形成了序列 $\\{4, 3\\}$。\n\n【数据规模与约定】\n\nSubtask 1（20 points）：$n \\le 50$，$g_i \\le 50$。  \nSubtask 2（20 points）：$g_i$ 为质数。  \nSubtask 3（20 points）：$g_i \\le 10^3$。  \nSubtask 4（20 points）：$r_i \\in \\{1, g_i\\}$。  \nSubtask 5（20 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^3$，$1 \\le k_i, r_i \\le g_i \\le 10^7$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-1] Happy Chubby Guys", "background": "There are $n$ happy chubby guys in Xiaofentu’s computer lab, but Xiaofentu is not one of them. He looks at these happy chubby guys and feels very jealous, so he wants to study their weights.", "description": "Each happy chubby guy’s weight on day $0$ is $1$. Let the $i$-th happy chubby guy’s weight be $w_i$, so initially $w_i = 1$.\n\nThe $i$-th happy chubby guy has a personal happiness index $k_i$, meaning that every day right after he wakes up, his weight becomes $k_i$ times his weight from the previous day.\n\nThese chubby guys are determined. The $i$-th chubby guy has a personal awakening weight $g_i$, meaning that once his weight is **greater than** $g_i$, he will go to the gym. Each time, he reduces his weight by $g_i$, until his weight is less than or equal to $g_i$.\n\nAfter working out, they meet in the computer lab, and they find that sometimes their weights become very interesting.\n\nOne day, they found that their weights formed an arithmetic progression.\n\nAnother day, they found that their weights formed a geometric progression!\n\nThe chubby guys wonder: if the weights of the $n$ happy chubby guys $\\{w_1, w_2, \\ldots, w_n\\}$ exactly form the sequence $\\{r_1, r_2, \\ldots, r_n\\}$, what is the minimum number of days needed?\n\nHowever, if they wait for a very long time and still do not reach that day, they will think it is impossible.", "inputFormat": "The first line contains a positive integer $n$.\n\nThe next $n$ lines each contain three positive integers $k_i, g_i, r_i$, representing the $i$-th chubby guy’s happiness index, awakening weight, and the target weight in the sequence.", "outputFormat": "If the given sequence is formed before the end of day $10^9$, output one number: the minimum number of days required.\n\nIf the given sequence is not formed before the end of day $10^9$, output `Impossible`.", "hint": "[Sample $1$ Explanation]\n\nThe table below shows the weight changes of two chubby guys from day $0$ to day $7$:\n\n| Days | Chubby guy $1$’s weight | Chubby guy $2$’s weight | Explanation |\n| :--: | :--: | :--: | :--: |\n| $0$ | $1$ | $1$ | On day $0$, each chubby guy’s weight is $1$ |\n| $1$ | $4$ | $2$ | Chubby guy $1$’s weight is $4$ times the previous day, and chubby guy $2$’s weight is $2$ times the previous day |\n| $2$ | $2$ | $4$ | Chubby guy $1$’s weight is $4$ times the previous day, which is $16$. He finds his weight exceeds $7$, so he goes to the gym twice, reducing his weight by $2\\times 7=14$ |\n| $3$ | $1$ | $3$ | On this day, both chubby guy $1$ and chubby guy $2$ go to the gym once |\n| $4$ | $4$ | $1$ | Chubby guy $2$ goes to the gym once |\n| $5$ | $2$ | $2$ | Chubby guy $1$ goes to the gym twice |\n| $6$ | $1$ | $4$ | Chubby guy $1$ goes to the gym once |\n| $7$ | $4$ | $3$ | Chubby guy $2$ goes to the gym once |\n\nIt can be seen that on day $7$, the chubby guys’ weights form the sequence $\\{4, 3\\}$.\n\n[Constraints and Notes]\n\nSubtask 1 (20 points): $n \\le 50$, $g_i \\le 50$.  \nSubtask 2 (20 points): $g_i$ is prime.  \nSubtask 3 (20 points): $g_i \\le 10^3$.  \nSubtask 4 (20 points): $r_i \\in \\{1, g_i\\}$.  \nSubtask 5 (20 points): no special constraints.\n\nFor $100\\%$ of the testdata: $1 \\le n \\le 10^3$, $1 \\le k_i, r_i \\le g_i \\le 10^7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-1】快乐肥宅", "background": "小粉兔的机房里面有 $n$ 个快乐肥宅，但小粉兔自己并不是，他看着这些快乐肥宅，非常羡慕，于是他想研究一下这些快乐肥宅的体重。", "description": "每个快乐肥宅第 $0$ 天的体重都等于 $1$。第 $i$ 个快乐肥宅的体重记作 $w_i$，则一开始 $w_i = 1$。\n\n第 $i$ 个快乐肥宅有一个专属的快乐指数 $k_i$，这表示他每天刚起床后，体重会是上一天的体重的 $k_i$ 倍。\n\n肥宅们是有觉悟的，第 $i$ 个肥宅有一个专属的觉醒体重 $g_i$，这表示一旦他的体重**大于** $g_i$，他就会去健身房健身，每次减掉自己 $g_i$ 的体重，直到体重小于等于 $g_i$。\n\n健身后，肥宅们会在机房见面，他们发现有时各自的体重会变得很有趣。\n\n有一天，肥宅们发现各自的体重形成了等差数列！\n\n另一天，肥宅们发现各自的体重形成了等比数列！\n\n肥宅们心想，如果 $n$ 个快乐肥宅的体重 $\\{w_1, w_2, \\ldots, w_n\\}$ 恰好形成序列 $\\{r_1, r_2, \\ldots, r_n\\}$，至少需要经过多少天呢？\n\n不过如果肥宅们等了很久都没有等到这一天，他们会认为这是不可能的。", "inputFormat": "第一行为一个正整数 $n$。\n\n接下来 $n$ 行，每行三个正整数 $k_i, g_i, r_i$。分别表示第 $i$ 个肥宅的快乐指数、觉醒体重和序列中的体重。", "outputFormat": "如果在第 $10^9$ 天结束前已经形成给定的序列，则输出一个数，表示至少需要经过的天数。\n\n如果在第 $10^9$ 天结束前没有形成给定的序列，则输出 `Impossible`。", "hint": "【样例 $1$ 说明】\n\n下表是两个肥宅在第 $0$ 天至第 $7$ 天时的体重变化表：\n\n| 天数 | 肥宅 $1$ 的体重 | 肥宅 $2$ 的体重 | 解释 |\n| :--: | :--: | :--: | :--: |\n| $0$ | $1$ | $1$ | 第 $0$ 天每个肥宅的体重都是 $1$ |\n| $1$ | $4$ | $2$ | 肥宅 $1$ 的体重是上一天的 $4$ 倍，肥宅 $2$ 的体重是上一天的 $2$ 倍 |\n| $2$ | $2$ | $4$ | 肥宅 $1$ 的体重是上一天的 $4$ 倍，为 $16$，他发现自己的体重超过了 $7$，于是去了两次健身房，把体重减少了 $2\\times 7=14$ |\n| $3$ | $1$ | $3$ | 这一天肥宅 $1$ 和肥宅 $2$ 都去了一次健身房 |\n| $4$ | $4$ | $1$ | 肥宅 $2$ 去了一次健身房 |\n| $5$ | $2$ | $2$ | 肥宅 $1$ 去了两次健身房 |\n| $6$ | $1$ | $4$ | 肥宅 $1$ 去了一次健身房 |\n| $7$ | $4$ | $3$ | 肥宅 $2$ 去了一次健身房 |\n\n可以看出在第 $7$ 天时肥宅的体重形成了序列 $\\{4, 3\\}$。\n\n【数据规模与约定】\n\nSubtask 1（20 points）：$n \\le 50$，$g_i \\le 50$。  \nSubtask 2（20 points）：$g_i$ 为质数。  \nSubtask 3（20 points）：$g_i \\le 10^3$。  \nSubtask 4（20 points）：$r_i \\in \\{1, g_i\\}$。  \nSubtask 5（20 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^3$，$1 \\le k_i, r_i \\le g_i \\le 10^7$。", "locale": "zh-CN"}}}
{"pid": "P5346", "type": "P", "difficulty": 6, "samples": [["5 11\n1 1 3 2\n1 2 2 1 1\n1 1\n1 2\n1 3\n1 4\n1 5\n2 4 1\n2 5 3\n3 1 1\n3 1 2\n3 1 3\n3 1 4", "5\n2\n1\n3\n4\n3\n1\n3\n2\n4\n5"]], "limits": {"time": [1000, 1000, 4000, 4000, 1500, 1500, 1500, 1500, 2500, 2500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["倍增", "离散化", "O2优化", "可持久化线段树", "可持久化", "后缀数组 SA"], "title": "【XR-1】柯南家族", "background": "xht37 最近沉迷于名侦探柯南。\n\n在某集中，小兰又在怀疑柯南的真实身份了。为了让小兰不再怀疑，柯南编造出自己的家族背景来应对小兰的询问。", "description": "这个家族一开始只有一个人，后来不断有人有了孩子，直到现在，这个家族有 $n$ 个人，第 $n$ 个人正是柯南。易知这个家族构成了一个 $n$ 个点的树形结构。\n\n柯南为了使自己编造的家庭背景更加真实，他给家族中的每个人赋予了一个**智商值**。但是，一个人的**聪明程度**不仅仅只与他的**智商值**有关，还可能与他**祖先的聪明程度**及他**出生的时代**有关。\n\n具体来说，在这个家族中，A 比 B 聪明**当且仅当** A 和 B 满足下面三种情况中的某一种：\n\n1. A 的智商值比 B 的智商值高；\n2. A 的智商值与 B 的智商值一样且 A 和 B 有不同的父亲，A 的父亲比 B 的父亲聪明；\n3. A 的智商值与 B 的智商值一样且 A 和 B 的父亲是同一个人或某一个人没有父亲，A 比 B 后出生。\n\n有一个很显然的结论是，这个家族中不会有两个人一样聪明。\n\n柯南需要回答小兰的 $q$ 个询问。为了方便说明，假设第 $i$ 个出生的人编号为 $i$。\n\n每个询问是下面三种情况中的某一种：\n\n1. `1 x`：询问编号为 $x$ 的人在整个家族中聪明程度排第几。\n2. `2 x k`：询问编号为 $x$ 的人及其祖先中第 $k$ 聪明的人的编号。\n3. `3 x k`：询问编号为 $x$ 的人及其后代中第 $k$ 聪明的人的编号。\n\n柯南还有许多案子要办，他不想在回答小兰的问题上浪费时间，他希望你能编程帮他回答小兰的所有询问。", "inputFormat": "第 $1$ 行包含两个数 $n, q$，分别表示人数和询问次数。\n\n第 $2$ 行包含 $n-1$ 个数 $f_{2 \\dots n}$，其中 $f_i$ 表示 $i$ 的父亲。\n\n第 $3$ 行包含 $n$ 个数 $a_{1 \\dots n}$，其中 $a_i$ 表示 $i$ 的智商值。\n\n接下来 $q$ 行每行两个或三个数表示一个合法询问，其中第一个数表示询问种类，后面一个或两个数为询问参数。", "outputFormat": "输出 $q$ 行，每行一个数表示询问的答案。", "hint": "【样例说明】\n\n形成的树如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/eie1mrxb.png)\n\n首先比较编号为 $2,3$ 的两个人，由于** $3$ 号的智商值与 $2$ 号的智商值一样且他们的父亲是同一个人，$3$ 号比 $2$ 号后出生**满足第 $3$ 种情况，因此 $3$ 号比 $2$ 号聪明。\n\n再比较编号为 $4,5$ 的两个人，由于** $4$ 号的智商值与 $5$ 号的智商值一样且他们有不同的父亲，$4$ 号的父亲 $3$ 号比 $5$ 号的父亲 $2$ 号聪明**满足第 $2$ 种情况，因此 $4$ 号比 $5$ 号聪明。\n\n再比较编号为 $1,5$ 的两个人，由于** $5$ 号的智商值与 $1$ 号的智商值一样且 $1$ 号没有父亲，$5$ 号比 $1$ 号后出生**满足第 $3$ 种情况，因此 $5$ 号比 $1$ 号聪明。\n\n再根据第 $1$ 种情况比较编号为 $2,4$ 的两个人，可对 $5$ 人的聪明程度排序：$3 > 2 > 4 > 5 > 1$。\n\n【数据规模与约定】\n\n一共 $10$ 个测试点。\n\n对于前 $20\\%$ 的数据，$1 \\le n, q \\le 10 ^ 3$，每个测试点 $7$ 分，时限 1s。\n\n对于另 $20\\%$ 的数据，保证一个人最多只有一个儿子，每个测试点 $9$ 分，时限 4s。\n\n对于另 $20\\%$ 的数据，$1 \\le n, q \\le 10 ^ 5$，每个测试点 $9$ 分，时限 1.5s。\n\n对于另 $20\\%$ 的数据，保证只有第一种询问，每个测试点 $12$ 分，时限 1.5s。\n\n对于 $100\\%$ 的数据，$1 \\le n, q \\le 5 \\times 10 ^ 5$，$1 \\le a_i \\le 10 ^ 9$，每个测试点 $13$ 分，时限 2.5s。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-1] Conan Family", "background": "xht37 has recently been addicted to *Detective Conan*.\n\nIn one episode, Ran suspects Conan’s true identity again. To stop Ran from suspecting him, Conan makes up a family background to answer Ran’s questions.", "description": "This family initially has only one person. Later, people keep having children, and up to now the family has $n$ people. Person $n$ is Conan. It is easy to see that this family forms a tree structure with $n$ nodes.\n\nTo make his made-up family background more realistic, Conan assigns each person an **IQ value**. However, a person’s **smartness** is not only related to their **IQ value**, but may also depend on their **ancestors’ smartness** and the **era when they were born**.\n\nSpecifically, in this family, A is smarter than B **if and only if** A and B satisfy one of the following three conditions:\n\n1. A’s IQ value is higher than B’s IQ value.\n2. A’s IQ value equals B’s IQ value, and A and B have different fathers; A’s father is smarter than B’s father.\n3. A’s IQ value equals B’s IQ value, and A and B have the same father or one of them has no father; A is born later than B.\n\nAn obvious conclusion is that no two people in this family are equally smart.\n\nConan needs to answer Ran’s $q$ queries. For convenience, assume the $i$-th person to be born is numbered $i$.\n\nEach query is one of the following three types:\n\n1. `1 x`: Ask what rank (in terms of smartness) the person numbered $x$ has in the whole family.\n2. `2 x k`: Ask for the number of the $k$-th smartest person among person $x$ and all their ancestors.\n3. `3 x k`: Ask for the number of the $k$-th smartest person among person $x$ and all their descendants.\n\nConan still has many cases to solve and does not want to waste time answering Ran’s questions. He hopes you can write a program to help him answer all queries.", "inputFormat": "The first line contains two integers $n, q$, representing the number of people and the number of queries.\n\nThe second line contains $n - 1$ integers $f_{2 \\dots n}$, where $f_i$ denotes the father of $i$.\n\nThe third line contains $n$ integers $a_{1 \\dots n}$, where $a_i$ denotes the IQ value of $i$.\n\nThe next $q$ lines each contain two or three integers describing a valid query. The first integer is the query type, and the following one or two integers are the query parameters.", "outputFormat": "Output $q$ lines, each containing one integer representing the answer to the query.", "hint": "[Sample Explanation]\n\nThe formed tree is as follows:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/eie1mrxb.png)\n\nFirst compare persons $2$ and $3$. Since **person $3$ has the same IQ value as person $2$ and they have the same father, and person $3$ is born later than person $2$**, condition 3 is satisfied, so person $3$ is smarter than person $2$.\n\nThen compare persons $4$ and $5$. Since **person $4$ has the same IQ value as person $5$ and they have different fathers, and person $4$’s father (person $3$) is smarter than person $5$’s father (person $2$)**, condition 2 is satisfied, so person $4$ is smarter than person $5$.\n\nThen compare persons $1$ and $5$. Since **person $5$ has the same IQ value as person $1$ and person $1$ has no father, and person $5$ is born later than person $1$**, condition 3 is satisfied, so person $5$ is smarter than person $1$.\n\nThen, using condition 1 to compare persons $2$ and $4$, we can sort the smartness of the $5$ people as: $3 > 2 > 4 > 5 > 1$.\n\n[Constraints]\n\nThere are $10$ test points in total.\n\nFor the first $20\\%$ of the data, $1 \\le n, q \\le 10 ^ 3$. Each test point is worth $7$ points, time limit 1 s.\n\nFor another $20\\%$ of the data, each person has at most one son. Each test point is worth $9$ points, time limit 4 s.\n\nFor another $20\\%$ of the data, $1 \\le n, q \\le 10 ^ 5$. Each test point is worth $9$ points, time limit 1.5 s.\n\nFor another $20\\%$ of the data, only the first type of query is guaranteed. Each test point is worth $12$ points, time limit 1.5 s.\n\nFor $100\\%$ of the data, $1 \\le n, q \\le 5 \\times 10 ^ 5$, $1 \\le a_i \\le 10 ^ 9$. Each test point is worth $13$ points, time limit 2.5 s.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-1】柯南家族", "background": "xht37 最近沉迷于名侦探柯南。\n\n在某集中，小兰又在怀疑柯南的真实身份了。为了让小兰不再怀疑，柯南编造出自己的家族背景来应对小兰的询问。", "description": "这个家族一开始只有一个人，后来不断有人有了孩子，直到现在，这个家族有 $n$ 个人，第 $n$ 个人正是柯南。易知这个家族构成了一个 $n$ 个点的树形结构。\n\n柯南为了使自己编造的家庭背景更加真实，他给家族中的每个人赋予了一个**智商值**。但是，一个人的**聪明程度**不仅仅只与他的**智商值**有关，还可能与他**祖先的聪明程度**及他**出生的时代**有关。\n\n具体来说，在这个家族中，A 比 B 聪明**当且仅当** A 和 B 满足下面三种情况中的某一种：\n\n1. A 的智商值比 B 的智商值高；\n2. A 的智商值与 B 的智商值一样且 A 和 B 有不同的父亲，A 的父亲比 B 的父亲聪明；\n3. A 的智商值与 B 的智商值一样且 A 和 B 的父亲是同一个人或某一个人没有父亲，A 比 B 后出生。\n\n有一个很显然的结论是，这个家族中不会有两个人一样聪明。\n\n柯南需要回答小兰的 $q$ 个询问。为了方便说明，假设第 $i$ 个出生的人编号为 $i$。\n\n每个询问是下面三种情况中的某一种：\n\n1. `1 x`：询问编号为 $x$ 的人在整个家族中聪明程度排第几。\n2. `2 x k`：询问编号为 $x$ 的人及其祖先中第 $k$ 聪明的人的编号。\n3. `3 x k`：询问编号为 $x$ 的人及其后代中第 $k$ 聪明的人的编号。\n\n柯南还有许多案子要办，他不想在回答小兰的问题上浪费时间，他希望你能编程帮他回答小兰的所有询问。", "inputFormat": "第 $1$ 行包含两个数 $n, q$，分别表示人数和询问次数。\n\n第 $2$ 行包含 $n-1$ 个数 $f_{2 \\dots n}$，其中 $f_i$ 表示 $i$ 的父亲。\n\n第 $3$ 行包含 $n$ 个数 $a_{1 \\dots n}$，其中 $a_i$ 表示 $i$ 的智商值。\n\n接下来 $q$ 行每行两个或三个数表示一个合法询问，其中第一个数表示询问种类，后面一个或两个数为询问参数。", "outputFormat": "输出 $q$ 行，每行一个数表示询问的答案。", "hint": "【样例说明】\n\n形成的树如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/eie1mrxb.png)\n\n首先比较编号为 $2,3$ 的两个人，由于** $3$ 号的智商值与 $2$ 号的智商值一样且他们的父亲是同一个人，$3$ 号比 $2$ 号后出生**满足第 $3$ 种情况，因此 $3$ 号比 $2$ 号聪明。\n\n再比较编号为 $4,5$ 的两个人，由于** $4$ 号的智商值与 $5$ 号的智商值一样且他们有不同的父亲，$4$ 号的父亲 $3$ 号比 $5$ 号的父亲 $2$ 号聪明**满足第 $2$ 种情况，因此 $4$ 号比 $5$ 号聪明。\n\n再比较编号为 $1,5$ 的两个人，由于** $5$ 号的智商值与 $1$ 号的智商值一样且 $1$ 号没有父亲，$5$ 号比 $1$ 号后出生**满足第 $3$ 种情况，因此 $5$ 号比 $1$ 号聪明。\n\n再根据第 $1$ 种情况比较编号为 $2,4$ 的两个人，可对 $5$ 人的聪明程度排序：$3 > 2 > 4 > 5 > 1$。\n\n【数据规模与约定】\n\n一共 $10$ 个测试点。\n\n对于前 $20\\%$ 的数据，$1 \\le n, q \\le 10 ^ 3$，每个测试点 $7$ 分，时限 1s。\n\n对于另 $20\\%$ 的数据，保证一个人最多只有一个儿子，每个测试点 $9$ 分，时限 4s。\n\n对于另 $20\\%$ 的数据，$1 \\le n, q \\le 10 ^ 5$，每个测试点 $9$ 分，时限 1.5s。\n\n对于另 $20\\%$ 的数据，保证只有第一种询问，每个测试点 $12$ 分，时限 1.5s。\n\n对于 $100\\%$ 的数据，$1 \\le n, q \\le 5 \\times 10 ^ 5$，$1 \\le a_i \\le 10 ^ 9$，每个测试点 $13$ 分，时限 2.5s。", "locale": "zh-CN"}}}
{"pid": "P5347", "type": "P", "difficulty": 7, "samples": [["1 3 2 0\n...\n", "7\n"], ["1 3 2 1\n...\n", "5\n"], ["2 2 1 0\n..\n..\n", "16\n"], ["2 2 1 1\n..\n..\n", "10\n"], ["2 2 1 0\n..\n#.\n", "4\n"], ["4 5 1 0\n.....\n.#.#.\n....#\n.#...\n", "65856\n"], ["4 5 1 1\n.....\n.#.#.\n....#\n.#...\n", "65616\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "轮廓线 DP"], "title": "【XR-1】俄罗斯方块", "background": "小粉兔最近沉迷一个名叫“俄罗斯方块”的游戏。\n\n然而本题除了都有格子和颜色之外和俄罗斯方块没什么关系。", "description": "有一个 $n \\times m$ 的方格图，小粉兔打算在其中画线。\n\n他可以画线若干次，也可以不画。每次画线必须从一个没有被画过的方格中心开始。\n\n只能往上下左右四个方向画线，对应方向上的方格记作**目标方格**。\n\n目标方格能被画，当且仅当下面三种情况：\n\n1. 如果目标方格**没有被画过**，则可以经过两个方格公共边的中点，直接画到目标方格中心，此时**可以选择**结束本次画线；\n2. 如果目标方格**已经被画过**，且这条画过的线是**贯穿整个方格的线**，则可以再画一条与这条线**垂直**的**贯穿整个方格的线**。对**贯穿整个方格的线**的定义为：这条线在方格中**没有改变方向**，**上下贯穿**或**左右贯穿**；\n3. 如果目标方格是本次画线的**起笔方格**，则可以经过两个方格公共边的中点，直接画到目标方格中心，此时**必须**结束本次画线。\n\n当然，不能画到整个方格图外面去。\n\n虽然小粉兔制定了如此严苛的规则，但是他仍然有很多种颜色的笔，每次画线他可以选择 $c$ 种颜色中的任意一种用来画线。\n\n不幸的是，方格图中有一些位置坏掉了，不能被经过，即在任意一次画线中不能画到坏掉的位置上。\n\n小粉兔想知道，在这些限制下，最终能画出多少种本质不同的图呢？\n\n小粉兔不想要求太多，当 $\\mathrm{op}=0$ 时，两张图本质相同当且仅当不考虑坏掉的方格，它们看起来相同（每个位置上的线条方向和颜色均相同）。\n\n而当 $\\mathrm{op}=1$ 时，两张图本质相同当且仅当不考虑坏掉的方格，它们看起来相同，或旋转 $180 ^ {\\circ}$ 后看起来相同。\n\n因为答案可能很多，所以小粉兔只想知道答案对 $998244353$ 取模的结果。", "inputFormat": "第一行三个正整数 $n,m,c$ 和一个非 $0$ 即 $1$ 的数 $\\mathrm{op}$。\n\n接下来 $n$ 行，每行一个长度为 $m$ 的字符串，只包含 `.` 和 `#` 两种字符，描述方格图的情况。如果第 $i$ 行的第 $j$ 个字符为 `#` 则表示方格图中第 $i$ 行第 $j$ 列的方格坏掉了，否则没有坏掉。", "outputFormat": "输出一行一个数，表示答案对 $998244353$ 取模的结果。", "hint": "【样例 $1$ 说明】\n\n共有如下 $7$ 种本质不同的图：\n\n![](https://cdn.luogu.com.cn/upload/pic/57768.png)\n\n【样例 $6$ 说明】\n\n下面给出两种本质不同的图：\n\n![](https://cdn.luogu.com.cn/upload/pic/57770.png)\n\n【数据规模与约定】\n\n本题采用捆绑测试：\n\nSubtask 1（12 points）：$n=1$，$\\mathrm{op}=0$，没有坏掉的格子。  \nSubtask 2（13 points）：$c=1$，$\\mathrm{op}=0$。  \nSubtask 3（12 points）：$c=1$，$\\mathrm{op}=1$。  \nSubtask 4（14 points）：$m\\le 5$，$\\mathrm{op}=0$。  \nSubtask 5（25 points）：$\\mathrm{op}=0$。  \nSubtask 6（8 points）：$n\\bmod 2=0$，$\\mathrm{op}=1$。  \nSubtask 7（8 points）：$n\\bmod 2=1$，$m\\bmod 2=0$，$\\mathrm{op}=1$。  \nSubtask 8（8 points）：$n\\bmod 2=1$，$m\\bmod 2=1$，$\\mathrm{op}=1$。\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 9$，$1\\le c\\le 10^6$，$\\mathrm{op}\\in\\{0,1\\}$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-1] Tetris", "background": "Xiao Fen Tu has recently become addicted to a game called “Tetris”.\n\nHowever, this problem has almost nothing to do with Tetris except that they both have grids and colors.", "description": "There is an $n \\times m$ grid. Xiao Fen Tu plans to draw lines in it.\n\nHe may draw lines any number of times, or draw none. Each time he draws, he must start from the center of a cell that has not been drawn before.\n\nHe may draw only in four directions: up, down, left, and right. The cell in the chosen direction is called the **target cell**.\n\nThe target cell can be drawn if and only if one of the following three cases holds:\n\n1. If the target cell **has not been drawn**, then he may pass through the midpoint of the common edge of the two cells and draw directly to the center of the target cell. In this case, he **may choose** to end this drawing operation.\n2. If the target cell **has been drawn**, and the drawn line is a **line that goes through the entire cell**, then he may draw another **line that goes through the entire cell** that is **perpendicular** to the existing one. A **line that goes through the entire cell** is defined as a line that **does not change direction** inside the cell, and goes through it **from top to bottom** or **from left to right**.\n3. If the target cell is the **starting cell** of the current drawing operation, then he may pass through the midpoint of the common edge of the two cells and draw directly to the center of the target cell. In this case, he **must** end this drawing operation.\n\nOf course, he cannot draw outside the whole grid.\n\nEven with such strict rules, he still has many colors of pens. Each time he draws, he may choose any one of the $c$ colors to draw the line.\n\nUnfortunately, some positions in the grid are broken and cannot be passed through, meaning that in any drawing operation he cannot draw onto broken positions.\n\nXiao Fen Tu wants to know: under these constraints, how many essentially different drawings can be produced in the end?\n\nXiao Fen Tu does not want to be too demanding. When $\\mathrm{op}=0$, two drawings are essentially the same if and only if, ignoring the broken cells, they look the same (the line direction and color at each position are the same).\n\nWhen $\\mathrm{op}=1$, two drawings are essentially the same if and only if, ignoring the broken cells, they look the same, or they look the same after a $180 ^ {\\circ}$ rotation.\n\nSince the answer may be very large, you only need the result modulo $998244353$.", "inputFormat": "The first line contains three positive integers $n,m,c$ and an integer $\\mathrm{op}$ that is either $0$ or $1$.\n\nThen follow $n$ lines, each containing a string of length $m$ consisting only of `.` and `#`, describing the grid. If the $j$-th character in the $i$-th line is `#`, it means the cell in row $i$, column $j$ is broken; otherwise it is not broken.", "outputFormat": "Output one line with one number, the answer modulo $998244353$.", "hint": "[Sample $1$ Explanation]\n\nThere are the following $7$ essentially different drawings:\n\n![](https://cdn.luogu.com.cn/upload/pic/57768.png)\n\n[Sample $6$ Explanation]\n\nTwo essentially different drawings are given below:\n\n![](https://cdn.luogu.com.cn/upload/pic/57770.png)\n\n[Data Scale and Constraints]\n\nThis problem uses bundled testdata:\n\nSubtask 1 (12 points): $n=1$, $\\mathrm{op}=0$, with no broken cells.  \nSubtask 2 (13 points): $c=1$, $\\mathrm{op}=0$.  \nSubtask 3 (12 points): $c=1$, $\\mathrm{op}=1$.  \nSubtask 4 (14 points): $m\\le 5$, $\\mathrm{op}=0$.  \nSubtask 5 (25 points): $\\mathrm{op}=0$.  \nSubtask 6 (8 points): $n\\bmod 2=0$, $\\mathrm{op}=1$.  \nSubtask 7 (8 points): $n\\bmod 2=1$, $m\\bmod 2=0$, $\\mathrm{op}=1$.  \nSubtask 8 (8 points): $n\\bmod 2=1$, $m\\bmod 2=1$, $\\mathrm{op}=1$.\n\nFor $100\\%$ of the data, $1\\le n,m\\le 9$, $1\\le c\\le 10^6$, $\\mathrm{op}\\in\\{0,1\\}$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-1】俄罗斯方块", "background": "小粉兔最近沉迷一个名叫“俄罗斯方块”的游戏。\n\n然而本题除了都有格子和颜色之外和俄罗斯方块没什么关系。", "description": "有一个 $n \\times m$ 的方格图，小粉兔打算在其中画线。\n\n他可以画线若干次，也可以不画。每次画线必须从一个没有被画过的方格中心开始。\n\n只能往上下左右四个方向画线，对应方向上的方格记作**目标方格**。\n\n目标方格能被画，当且仅当下面三种情况：\n\n1. 如果目标方格**没有被画过**，则可以经过两个方格公共边的中点，直接画到目标方格中心，此时**可以选择**结束本次画线；\n2. 如果目标方格**已经被画过**，且这条画过的线是**贯穿整个方格的线**，则可以再画一条与这条线**垂直**的**贯穿整个方格的线**。对**贯穿整个方格的线**的定义为：这条线在方格中**没有改变方向**，**上下贯穿**或**左右贯穿**；\n3. 如果目标方格是本次画线的**起笔方格**，则可以经过两个方格公共边的中点，直接画到目标方格中心，此时**必须**结束本次画线。\n\n当然，不能画到整个方格图外面去。\n\n虽然小粉兔制定了如此严苛的规则，但是他仍然有很多种颜色的笔，每次画线他可以选择 $c$ 种颜色中的任意一种用来画线。\n\n不幸的是，方格图中有一些位置坏掉了，不能被经过，即在任意一次画线中不能画到坏掉的位置上。\n\n小粉兔想知道，在这些限制下，最终能画出多少种本质不同的图呢？\n\n小粉兔不想要求太多，当 $\\mathrm{op}=0$ 时，两张图本质相同当且仅当不考虑坏掉的方格，它们看起来相同（每个位置上的线条方向和颜色均相同）。\n\n而当 $\\mathrm{op}=1$ 时，两张图本质相同当且仅当不考虑坏掉的方格，它们看起来相同，或旋转 $180 ^ {\\circ}$ 后看起来相同。\n\n因为答案可能很多，所以小粉兔只想知道答案对 $998244353$ 取模的结果。", "inputFormat": "第一行三个正整数 $n,m,c$ 和一个非 $0$ 即 $1$ 的数 $\\mathrm{op}$。\n\n接下来 $n$ 行，每行一个长度为 $m$ 的字符串，只包含 `.` 和 `#` 两种字符，描述方格图的情况。如果第 $i$ 行的第 $j$ 个字符为 `#` 则表示方格图中第 $i$ 行第 $j$ 列的方格坏掉了，否则没有坏掉。", "outputFormat": "输出一行一个数，表示答案对 $998244353$ 取模的结果。", "hint": "【样例 $1$ 说明】\n\n共有如下 $7$ 种本质不同的图：\n\n![](https://cdn.luogu.com.cn/upload/pic/57768.png)\n\n【样例 $6$ 说明】\n\n下面给出两种本质不同的图：\n\n![](https://cdn.luogu.com.cn/upload/pic/57770.png)\n\n【数据规模与约定】\n\n本题采用捆绑测试：\n\nSubtask 1（12 points）：$n=1$，$\\mathrm{op}=0$，没有坏掉的格子。  \nSubtask 2（13 points）：$c=1$，$\\mathrm{op}=0$。  \nSubtask 3（12 points）：$c=1$，$\\mathrm{op}=1$。  \nSubtask 4（14 points）：$m\\le 5$，$\\mathrm{op}=0$。  \nSubtask 5（25 points）：$\\mathrm{op}=0$。  \nSubtask 6（8 points）：$n\\bmod 2=0$，$\\mathrm{op}=1$。  \nSubtask 7（8 points）：$n\\bmod 2=1$，$m\\bmod 2=0$，$\\mathrm{op}=1$。  \nSubtask 8（8 points）：$n\\bmod 2=1$，$m\\bmod 2=1$，$\\mathrm{op}=1$。\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 9$，$1\\le c\\le 10^6$，$\\mathrm{op}\\in\\{0,1\\}$。", "locale": "zh-CN"}}}
{"pid": "P5348", "type": "P", "difficulty": 6, "samples": [["2\n5 1\n5 2", "4\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "密码解锁", "background": "在开锁公司劳动", "description": "这天，WD发现了一个很奇怪的密码锁，他记得CX让他解开这个密码锁之前告诉过他一些数字，可惜由于WD菜的真实，早就忘了那些数字是啥，只记得把他们从1到$n$编号后，对于任意的正整数$d(1\\le d\\le n)$，编号为$d$的倍数的数字之和恰好等于$\\mu(d)$（即$d$的莫比乌斯函数值）。\n\n现在，由于要打开这个密码锁，他必须知道第$m$个位置上的数字。由于他什么都不会，当然要请你来帮忙啦……", "inputFormat": "第一行一个数$T$，表示数据组数。接下来$T$行每行两个数，分别为$n,m$。", "outputFormat": "共$T$行，每行一个数字，表示第$m$个数字的值。显然可以证明解是唯一的。", "hint": "$subtask1(21pts):~n\\le 10^6,~T\\le 5$\n\n$subtask2(34pts):~n\\le 10^7,~T\\le 10$\n\n$subtask3(45pts):~n\\le 10^{18},~m\\le 10^9,~\\frac{n}{m}\\le 10^9,~T\\le 20$\n\n对于所有数据，$m\\le n$。\n\n对于样例1，满足要求的数列为4 -1 -1 0 -1.", "locale": "zh-CN", "translations": {"en": {"title": "Password Unlock", "background": "Working at a lock company.", "description": "One day, WD found a very strange combination lock. He remembered that before CX asked him to unlock it, CX told him some numbers. Unfortunately, since WD is really bad at this, he forgot what those numbers were. He only remembers that after numbering them from $1$ to $n$, for any positive integer $d(1\\le d\\le n)$, the sum of all numbers whose indices are multiples of $d$ is exactly $\\mu(d)$ (that is, the Möbius function value of $d$).\n\nNow, to open this lock, he must know the number at position $m$. Since he cannot do anything, he asks you for help.", "inputFormat": "The first line contains an integer $T$, indicating the number of test cases. The next $T$ lines each contain two integers $n,m$.", "outputFormat": "Output $T$ lines. Each line contains one integer, representing the value of the $m$-th number. It can be proven that the answer is unique.", "hint": "$subtask1(21pts):~n\\le 10^6,~T\\le 5$.\n\n$subtask2(34pts):~n\\le 10^7,~T\\le 10$.\n\n$subtask3(45pts):~n\\le 10^{18},~m\\le 10^9,~\\frac{n}{m}\\le 10^9,~T\\le 20$.\n\nFor all testdata, $m\\le n$.\n\nFor sample 1, the sequence that satisfies the requirement is 4 -1 -1 0 -1.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "密码解锁", "background": "在开锁公司劳动", "description": "这天，WD发现了一个很奇怪的密码锁，他记得CX让他解开这个密码锁之前告诉过他一些数字，可惜由于WD菜的真实，早就忘了那些数字是啥，只记得把他们从1到$n$编号后，对于任意的正整数$d(1\\le d\\le n)$，编号为$d$的倍数的数字之和恰好等于$\\mu(d)$（即$d$的莫比乌斯函数值）。\n\n现在，由于要打开这个密码锁，他必须知道第$m$个位置上的数字。由于他什么都不会，当然要请你来帮忙啦……", "inputFormat": "第一行一个数$T$，表示数据组数。接下来$T$行每行两个数，分别为$n,m$。", "outputFormat": "共$T$行，每行一个数字，表示第$m$个数字的值。显然可以证明解是唯一的。", "hint": "$subtask1(21pts):~n\\le 10^6,~T\\le 5$\n\n$subtask2(34pts):~n\\le 10^7,~T\\le 10$\n\n$subtask3(45pts):~n\\le 10^{18},~m\\le 10^9,~\\frac{n}{m}\\le 10^9,~T\\le 20$\n\n对于所有数据，$m\\le n$。\n\n对于样例1，满足要求的数列为4 -1 -1 0 -1.", "locale": "zh-CN"}}}
