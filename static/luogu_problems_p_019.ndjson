{"pid": "P1381", "type": "P", "difficulty": 4, "samples": [["3\r\nhot\r\ndog\r\nmilk\r\n5\r\nhot\r\ndog\r\ndog\r\nmilk\r\nhot\r\n", "3\r\n3\r\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "字符串", "二分", "福建省历届夏令营", "哈希 hashing", "双指针 two-pointer"], "title": "单词背诵", "background": null, "description": "灵梦有 $n$ 个单词想要背，但她想通过一篇文章中的一段来记住这些单词。\n\n文章由 $m$ 个单词构成，她想在文章中找出连续的一段，其中包含最多的她想要背的单词（重复的只算一个）。并且在背诵的单词量尽量多的情况下，还要使选出的文章段落尽量短，这样她就可以用尽量短的时间学习尽可能多的单词了。", "inputFormat": "第 $1$ 行一个数 $n$，接下来 $n$ 行每行是一个长度不超过 $10$ 的字符串，表示一个要背的单词。\n\n接着是一个数 $m$，然后是 $m$ 行长度不超过 $10$ 的字符串，每个表示文章中的一个单词。", "outputFormat": "输出文件共 $2$ 行。第 $1$ 行为文章中最多包含的要背的单词数，第 $2$ 行表示在文章中包含最多要背单词的最短的连续段的长度。", "hint": "### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，$n \\le 50$，$m \\le 500$；\n- 对于 $60\\%$ 的数据，$n \\le 300$，$m \\le 5000$；\n- 对于 $100\\%$ 的数据，$1 \\le n \\le 1000$，$1 \\le m \\le 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "Word Recitation", "background": "", "description": "Reimu has $n$ words she wants to memorize, and she plans to remember them through a contiguous segment of an article.\n\nThe article consists of $m$ words. She wants to find a contiguous segment in the article that contains as many of her target words as possible, counting only distinct target words within the segment (duplicates count as one). Among all segments that contain the maximum number of target words, she also wants the segment to be as short as possible, so that she can spend the least time learning as many words as she can.", "inputFormat": "The first line contains an integer $n$, followed by $n$ lines, each of which is a string of length at most $10$, representing a target word to memorize.\n\nThen an integer $m$ follows, and then $m$ lines, each of which is a string of length at most $10$, representing a word in the article.", "outputFormat": "Output two lines. The first line is the maximum number of target words contained in any contiguous segment of the article. The second line is the length of the shortest contiguous segment that contains this maximum number of target words.", "hint": "Constraints\n\n- For $30\\%$ of the testdata, $n \\le 50$, $m \\le 500$.\n- For $60\\%$ of the testdata, $n \\le 300$, $m \\le 5000$.\n- For $100\\%$ of the testdata, $1 \\le n \\le 1000$, $1 \\le m \\le 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "单词背诵", "background": null, "description": "灵梦有 $n$ 个单词想要背，但她想通过一篇文章中的一段来记住这些单词。\n\n文章由 $m$ 个单词构成，她想在文章中找出连续的一段，其中包含最多的她想要背的单词（重复的只算一个）。并且在背诵的单词量尽量多的情况下，还要使选出的文章段落尽量短，这样她就可以用尽量短的时间学习尽可能多的单词了。", "inputFormat": "第 $1$ 行一个数 $n$，接下来 $n$ 行每行是一个长度不超过 $10$ 的字符串，表示一个要背的单词。\n\n接着是一个数 $m$，然后是 $m$ 行长度不超过 $10$ 的字符串，每个表示文章中的一个单词。", "outputFormat": "输出文件共 $2$ 行。第 $1$ 行为文章中最多包含的要背的单词数，第 $2$ 行表示在文章中包含最多要背单词的最短的连续段的长度。", "hint": "### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，$n \\le 50$，$m \\le 500$；\n- 对于 $60\\%$ 的数据，$n \\le 300$，$m \\le 5000$；\n- 对于 $100\\%$ 的数据，$1 \\le n \\le 1000$，$1 \\le m \\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P1382", "type": "P", "difficulty": 5, "samples": [["2\n3 0 2\n4 1 3\n", "6\n0 0\n0 3\n1 3\n1 4\n3 4\n3 0"], ["5\n3 -3 0\n2 -1 1\n4 2 4\n2 3 7\n3 6 8", "14\n-3 0\n-3 3\n0 3\n0 2\n1 2\n1 0\n2 0\n2 4\n4 4\n4 2\n6 2\n6 3\n8 3\n8 0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["线段树", "堆", "福建省历届夏令营"], "title": "楼房", "background": "", "description": "地平线（$x$ 轴）上有 $n$ 个楼房，每个楼房可以表示为一个矩形。\n\n用三个整数 $h_i,l_i,r_i$ 来表示第 $i$ 个矩形：矩形左下角为 $(l_i,0)$，右上角为 $(r_i,h_i)$。\n\n地平线高度为 $0$。在轮廓线长度最小的前提下，从左到右输出轮廓线。", "inputFormat": "第一行一个整数 $n$，表示矩形个数。\n\n以下 $n$ 行，每行 $3$ 个整数 $h_i,l_i,r_i$ 表示第 $i$ 个矩形。", "outputFormat": "第一行一个整数 $m$，表示节点个数。\n\n以下 $m$ 行，每行一个坐标表示轮廓线上的节点。\n\n要求从左到右遍历轮廓线并顺序输出节点。\n\n注：第一个和最后一个节点的 $y$ 坐标必然为 $0$。", "hint": "样例二如图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pmf4pzif.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5ec8sxwi.png)\n\n数据范围:\n\n对于 $30\\%$ 的数据，$n\\le100$。\n\n对于另外 $30\\%$ 的数据，$1\\le h_i,l_i,r_i\\le 1000$。\n\n对于 $100\\%$ 的数据，$1\\le n\\le10^5$，$1\\le h_i\\le 10^9$，$-10^9\\le l_i<r_i\\le10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "Buildings", "background": "", "description": "There are $n$ buildings on the horizon (the $x$ axis), and each building is represented as a rectangle.\n\nThe $i$-th rectangle is represented by three integers $h_i, l_i, r_i$: its bottom-left corner is at $(l_i, 0)$ and its top-right corner is at $(r_i, h_i)$.\n\nThe horizon has height $0$. Subject to minimizing the skyline polyline length (i.e., without redundant points), output the skyline from left to right.", "inputFormat": "The first line contains an integer $n$, the number of rectangles.\n\nEach of the following $n$ lines contains $3$ integers $h_i, l_i, r_i$ describing the $i$-th rectangle.", "outputFormat": "The first line contains an integer $m$, the number of nodes.\n\nEach of the following $m$ lines contains one coordinate, representing a node on the skyline.\n\nTraverse the skyline from left to right and output the nodes in order.\n\nNote: The $y$-coordinates of the first and the last node are both $0$.", "hint": "Sample 2 as shown:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pmf4pzif.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5ec8sxwi.png)\n\nConstraints:\n\nFor $30\\%$ of the testdata, $n \\le 100$.\n\nFor another $30\\%$ of the testdata, $1 \\le h_i, l_i, r_i \\le 1000$.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 10^5$, $1 \\le h_i \\le 10^9$, $-10^9 \\le l_i < r_i \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "楼房", "background": "", "description": "地平线（$x$ 轴）上有 $n$ 个楼房，每个楼房可以表示为一个矩形。\n\n用三个整数 $h_i,l_i,r_i$ 来表示第 $i$ 个矩形：矩形左下角为 $(l_i,0)$，右上角为 $(r_i,h_i)$。\n\n地平线高度为 $0$。在轮廓线长度最小的前提下，从左到右输出轮廓线。", "inputFormat": "第一行一个整数 $n$，表示矩形个数。\n\n以下 $n$ 行，每行 $3$ 个整数 $h_i,l_i,r_i$ 表示第 $i$ 个矩形。", "outputFormat": "第一行一个整数 $m$，表示节点个数。\n\n以下 $m$ 行，每行一个坐标表示轮廓线上的节点。\n\n要求从左到右遍历轮廓线并顺序输出节点。\n\n注：第一个和最后一个节点的 $y$ 坐标必然为 $0$。", "hint": "样例二如图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pmf4pzif.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5ec8sxwi.png)\n\n数据范围:\n\n对于 $30\\%$ 的数据，$n\\le100$。\n\n对于另外 $30\\%$ 的数据，$1\\le h_i,l_i,r_i\\le 1000$。\n\n对于 $100\\%$ 的数据，$1\\le n\\le10^5$，$1\\le h_i\\le 10^9$，$-10^9\\le l_i<r_i\\le10^9$。", "locale": "zh-CN"}}}
{"pid": "P1383", "type": "P", "difficulty": 5, "samples": [["7\nT a\nT b\nT c\nQ 2\nU 2\nT c\nQ 2\n", "b\nc\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["倍增", "福建省历届夏令营", "可持久化线段树", "可持久化"], "title": "高级打字机", "background": "", "description": "早苗入手了最新的高级打字机。最新款自然有着与以往不同的功能，那就是它具备撤销功能，厉害吧。\n\n请为这种高级打字机设计一个程序，支持如下 $3$ 种操作：\n\n1. `T x`：Type 操作，表示在文章末尾打下一个小写字母 $x$。\n2. `U x`：Undo 操作，表示撤销最后的 $x$ 次修改操作。\n3. `Q x`：Query 操作，表示询问当前文章中第 $x$ 个字母并输出。请注意 Query 操作并不算修改操作。\n\n文章一开始可以视为空串。", "inputFormat": "第 $1$ 行：一个整数 $n$，表示操作数量。\n\n以下 $n$ 行，每行一个命令。保证输入的命令合法。", "outputFormat": "每行输出一个字母，表示 Query 操作的答案。\n\n", "hint": "对于前 $20\\%$ 的数据，$n\\le 200$。\n\n对于前 $50\\%$ 的数据，保证 Undo 操作不会撤销 Undo 操作。\n\n对于 $100\\%$ 的数据，$n\\le 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "Advanced Typewriter", "background": "", "description": "Sanae has bought the latest advanced typewriter. As you would expect, the latest model has a new feature: it supports undo.\n\nPlease design a program for this advanced typewriter that supports the following $3$ types of operations:\n\n1. `T x`: Type operation, which appends a lowercase letter $x$ to the end of the text.\n2. `U x`: Undo operation, which undoes the last $x$ modification operations.\n3. `Q x`: Query operation, which asks for and outputs the $x$-th letter of the current text. Note that the Query operation does not count as a modification operation.\n\nInitially, the text can be regarded as an empty string.", "inputFormat": "Line $1$: an integer $n$, the number of operations.\n\nThe next $n$ lines each contain one command. It is guaranteed that the input commands are valid.", "outputFormat": "Output one letter per line, which is the answer to each Query operation.", "hint": "For the first $20\\%$ of the testdata, $n \\le 200$.\n\nFor the first $50\\%$ of the testdata, it is guaranteed that an Undo operation will not undo an Undo operation.\n\nFor $100\\%$ of the testdata, $n \\le 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "高级打字机", "background": "", "description": "早苗入手了最新的高级打字机。最新款自然有着与以往不同的功能，那就是它具备撤销功能，厉害吧。\n\n请为这种高级打字机设计一个程序，支持如下 $3$ 种操作：\n\n1. `T x`：Type 操作，表示在文章末尾打下一个小写字母 $x$。\n2. `U x`：Undo 操作，表示撤销最后的 $x$ 次修改操作。\n3. `Q x`：Query 操作，表示询问当前文章中第 $x$ 个字母并输出。请注意 Query 操作并不算修改操作。\n\n文章一开始可以视为空串。", "inputFormat": "第 $1$ 行：一个整数 $n$，表示操作数量。\n\n以下 $n$ 行，每行一个命令。保证输入的命令合法。", "outputFormat": "每行输出一个字母，表示 Query 操作的答案。\n\n", "hint": "对于前 $20\\%$ 的数据，$n\\le 200$。\n\n对于前 $50\\%$ 的数据，保证 Undo 操作不会撤销 Undo 操作。\n\n对于 $100\\%$ 的数据，$n\\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P1384", "type": "P", "difficulty": 4, "samples": [["7 4\n", "1"], ["4 7\n", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "福建省历届夏令营"], "title": "幸运数与排列", "background": "", "description": "一个数是幸运数当且仅当这个数仅由 $4$ 和 $7$ 构成，比如 $47$，$744$，$4747$。\n\n询问在 $1$ 到 $n$ 的全排列中字典序第 $k$ 小的排列中，有多少个幸运数在排列中的位置编号也是幸运数。", "inputFormat": "一行，包含两个整数 $n$，$k$。", "outputFormat": "一个整数表示答案。如果不存在第 $k$ 小的排列，则输出 $-1$。", "hint": "#### 样例 1 解释\n\n排列为 $1,2,3,4,6,7,5$。\n\n#### 样例 2 解释\n\n排列为：$2,1,3,4$。\n\n#### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，保证 $n\\le 8$。\n- 对于 $60\\%$ 的数据，保证 $n\\le 100$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n,k\\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "Lucky Numbers and Permutations", "background": "", "description": "A number is a lucky number if and only if it consists only of the digits $4$ and $7$, for example $47$, $744$, $4747$.\n\nAmong all permutations of $1$ to $n$ in lexicographical order, consider the $k$-th smallest permutation. Count how many indices $i$ such that both the position $i$ and the element at position $i$ are lucky numbers.", "inputFormat": "One line containing two integers $n$, $k$.", "outputFormat": "Output a single integer representing the answer. If the $k$-th smallest permutation does not exist, output $-1$.", "hint": "Sample 1 Explanation:\nThe permutation is 1, 2, 3, 4, 6, 7, 5.\n\nSample 2 Explanation:\nThe permutation is: 2, 1, 3, 4.\n\nConstraints:\n- For $30\\%$ of the testdata, it is guaranteed that $n \\le 8$.\n- For $60\\%$ of the testdata, it is guaranteed that $n \\le 100$.\n- For $100\\%$ of the testdata, it is guaranteed that $1 \\leq n, k \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "幸运数与排列", "background": "", "description": "一个数是幸运数当且仅当这个数仅由 $4$ 和 $7$ 构成，比如 $47$，$744$，$4747$。\n\n询问在 $1$ 到 $n$ 的全排列中字典序第 $k$ 小的排列中，有多少个幸运数在排列中的位置编号也是幸运数。", "inputFormat": "一行，包含两个整数 $n$，$k$。", "outputFormat": "一个整数表示答案。如果不存在第 $k$ 小的排列，则输出 $-1$。", "hint": "#### 样例 1 解释\n\n排列为 $1,2,3,4,6,7,5$。\n\n#### 样例 2 解释\n\n排列为：$2,1,3,4$。\n\n#### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，保证 $n\\le 8$。\n- 对于 $60\\%$ 的数据，保证 $n\\le 100$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n,k\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P1385", "type": "P", "difficulty": 4, "samples": [["3\naaaaaaaaa\nya\nklmbfxzb", "0\n24\n320092793"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "数学", "福建省历届夏令营"], "title": "密令", "background": null, "description": "给定一小写字母串 $s$，每次操作你可以选择一个 $p$（$1 \\leq p \\lt |s|$）执行下述修改中的任意一个：\n\n1. 将 $s_p$ 改为其字典序 $+1$ 的字母，将 $s_{p+1}$ 改为其字典序 $-1$ 的字母；\n2. 将 $s_p$ 改为其字典序 $-1$ 的字母，将 $s_{p+1}$ 改为其字典序 $+1$ 的字母。\n\n在经过任意多次操作后，串 $s$ 能变化成多少种不同于 $s$ 的字符串？\n\n修改过程中必须保证 $s$ 是合法的小写字母串（即不能对字母 a 进行字典序 $-1$ 的操作和不能对字母 z 进行字典序 $+1$ 的操作），答案对 $10^9 + 7$ 取模。", "inputFormat": "第一行一个整数 $T$，表示数据组数\n\n接下来 $T$ 行，每行一个小写字母串 $s$。", "outputFormat": "输出 $T$ 行，每行一个整数表示答案。", "hint": "- 对于 $30\\%$ 的数据，$T=1$，$|s| \\leq 10$；\n- 对于 $60\\%$ 的数据，$T \\leq 10$；\n- 对于 $100\\%$ 的数据，$T \\leq 10000$，$1 \\leq |s| \\leq 100$。", "locale": "zh-CN", "translations": {"en": {"title": "Secret Code", "background": "", "description": "Given a lowercase string $s$, in each operation you may choose a position $p$ ($1 \\leq p \\lt |s|$) and perform one of the following modifications:\n\n1. Change $s_p$ to the letter with lexicographic order $+1$, and change $s_{p+1}$ to the letter with lexicographic order $-1$.\n2. Change $s_p$ to the letter with lexicographic order $-1$, and change $s_{p+1}$ to the letter with lexicographic order $+1$.\n\nAfter performing any number of operations, into how many different strings can $s$ be transformed?\n\nDuring the modifications, $s$ must always remain a valid lowercase string (that is, you cannot apply lexicographic $-1$ to the letter 'a', and you cannot apply lexicographic $+1$ to the letter 'z'). Output the answer modulo $10^9 + 7$.", "inputFormat": "The first line contains an integer $T$, the number of test cases.\n\nThe next $T$ lines each contain a lowercase string $s$.", "outputFormat": "Output $T$ lines, each containing one integer, the answer for the corresponding test case.", "hint": "- For $30\\%$ of the testdata, $T = 1$, $|s| \\leq 10$.\n- For $60\\%$ of the testdata, $T \\leq 10$.\n- For $100\\%$ of the testdata, $T \\leq 10000$, $1 \\leq |s| \\leq 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "密令", "background": null, "description": "给定一小写字母串 $s$，每次操作你可以选择一个 $p$（$1 \\leq p \\lt |s|$）执行下述修改中的任意一个：\n\n1. 将 $s_p$ 改为其字典序 $+1$ 的字母，将 $s_{p+1}$ 改为其字典序 $-1$ 的字母；\n2. 将 $s_p$ 改为其字典序 $-1$ 的字母，将 $s_{p+1}$ 改为其字典序 $+1$ 的字母。\n\n在经过任意多次操作后，串 $s$ 能变化成多少种不同于 $s$ 的字符串？\n\n修改过程中必须保证 $s$ 是合法的小写字母串（即不能对字母 a 进行字典序 $-1$ 的操作和不能对字母 z 进行字典序 $+1$ 的操作），答案对 $10^9 + 7$ 取模。", "inputFormat": "第一行一个整数 $T$，表示数据组数\n\n接下来 $T$ 行，每行一个小写字母串 $s$。", "outputFormat": "输出 $T$ 行，每行一个整数表示答案。", "hint": "- 对于 $30\\%$ 的数据，$T=1$，$|s| \\leq 10$；\n- 对于 $60\\%$ 的数据，$T \\leq 10$；\n- 对于 $100\\%$ 的数据，$T \\leq 10000$，$1 \\leq |s| \\leq 100$。", "locale": "zh-CN"}}}
{"pid": "P1386", "type": "P", "difficulty": 5, "samples": [["2\r\n4 3 10\r\n1 2 2 1 3 1\r\n10 3 8882\r\n7 9 2 9 5 10\r\n", "YES 4\r\nNO\r\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "数学", "福建省历届夏令营"], "title": "座位安排", "background": null, "description": "给 $n$ 个人安排座位，先给每个人一个 $1\\sim n$ 的编号，设第 $i$ 个人的编号为 $a_i$（不同人的编号可以相同），接着从第一个人开始，大家依次入座。\n\n第 $i$ 个人来了以后尝试坐到 $a_i$，如果 $a_i$ 被占据了，就尝试 $a_{i+1}$，$a_{i+1}$ 也被占据了的话就尝试 $a_{i+2}$，……，如果一直尝试到第 $n$ 个都不行，该安排方案就不合法。\n\n然而有 $m$ 个人的编号已经确定（他们或许贿赂了你的上司），你只能安排剩下的人的编号。求有多少种合法的安排方案。由于答案可能很大，只需输出其除以 $M$ 后的余数即可。", "inputFormat": "第一行一个整数 $T$，表示数据组数；\n\n对于每组数据，第一行有三个整数，分别表示 $n,m,M$；\n\n若 $m$ 不为 $0$，则接下来一行有 $m$ 对整数，$p_1,q_1,p_2,q_2,\\ldots,p_m,q_m$，其中第 $i$ 对整数 $p_i,q_i$ 表示第 $p_i$ 个人的编号必须为 $q_i$。", "outputFormat": "对于每组数据输出一行，若是有解则输出 `YES`，后跟一个整数表示方案数 $\\bmod\\ M$，注意，`YES` 和数之间只有一个空格；否则输出 `NO`。", "hint": "对于 $30\\%$ 的数据，$1\\le n\\le 10$，$1\\le M\\le 32767$；\n\n对于 $100\\%$ 的数据，$1 \\le T \\le 10$，$1 \\le n \\le 300$，$0 \\le m \\le n$，$2 \\le M \\le 10^9$，$1 \\le p_i,q_i \\le n$，且保证 $p_i$ 互不相同。", "locale": "zh-CN", "translations": {"en": {"title": "Seat Arrangement", "background": "", "description": "Arrange seats for $n$ people. First assign each person a number from $1\\sim n$. Let the number of the $i$-th person be $a_i$ (different people may share the same number). Then, starting from the first person, everyone takes their seat in order.\n\nWhen the $i$-th person arrives, they try to sit at seat $a_i$. If $a_i$ is occupied, they try $a_{i+1}$. If $a_{i+1}$ is also occupied, they try $a_{i+2}$, … If they have tried up to the $n$-th and still cannot sit, then the arrangement is invalid.\n\nHowever, the numbers of $m$ people are already fixed (they may have bribed your boss), and you can only assign numbers for the remaining people. Find how many valid arrangements there are. Since the answer may be large, output it modulo $M$.", "inputFormat": "The first line contains an integer $T$, the number of test cases.\n\nFor each test case, the first line contains three integers, representing $n,m,M$.\n\nIf $m$ is not $0$, the next line contains $m$ pairs of integers $p_1,q_1,p_2,q_2,\\ldots,p_m,q_m$, where the $i$-th pair $p_i,q_i$ means that the number of the $p_i$-th person must be $q_i$.", "outputFormat": "For each test case, output one line. If there is a solution, output `YES` followed by one integer equal to the number of valid arrangements $\\bmod\\ M$. Note that there is exactly one space between `YES` and the number. Otherwise, output `NO`.", "hint": "Constraints:\n- For $30\\%$ of the testdata, $1 \\le n \\le 10$, $1 \\le M \\le 32767$.\n- For $100\\%$ of the testdata, $1 \\le T \\le 10$, $1 \\le n \\le 300$, $0 \\le m \\le n$, $2 \\le M \\le 10^9$, $1 \\le p_i,q_i \\le n$, and it is guaranteed that the $p_i$ are pairwise distinct.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "座位安排", "background": null, "description": "给 $n$ 个人安排座位，先给每个人一个 $1\\sim n$ 的编号，设第 $i$ 个人的编号为 $a_i$（不同人的编号可以相同），接着从第一个人开始，大家依次入座。\n\n第 $i$ 个人来了以后尝试坐到 $a_i$，如果 $a_i$ 被占据了，就尝试 $a_{i+1}$，$a_{i+1}$ 也被占据了的话就尝试 $a_{i+2}$，……，如果一直尝试到第 $n$ 个都不行，该安排方案就不合法。\n\n然而有 $m$ 个人的编号已经确定（他们或许贿赂了你的上司），你只能安排剩下的人的编号。求有多少种合法的安排方案。由于答案可能很大，只需输出其除以 $M$ 后的余数即可。", "inputFormat": "第一行一个整数 $T$，表示数据组数；\n\n对于每组数据，第一行有三个整数，分别表示 $n,m,M$；\n\n若 $m$ 不为 $0$，则接下来一行有 $m$ 对整数，$p_1,q_1,p_2,q_2,\\ldots,p_m,q_m$，其中第 $i$ 对整数 $p_i,q_i$ 表示第 $p_i$ 个人的编号必须为 $q_i$。", "outputFormat": "对于每组数据输出一行，若是有解则输出 `YES`，后跟一个整数表示方案数 $\\bmod\\ M$，注意，`YES` 和数之间只有一个空格；否则输出 `NO`。", "hint": "对于 $30\\%$ 的数据，$1\\le n\\le 10$，$1\\le M\\le 32767$；\n\n对于 $100\\%$ 的数据，$1 \\le T \\le 10$，$1 \\le n \\le 300$，$0 \\le m \\le n$，$2 \\le M \\le 10^9$，$1 \\le p_i,q_i \\le n$，且保证 $p_i$ 互不相同。", "locale": "zh-CN"}}}
{"pid": "P1387", "type": "P", "difficulty": 2, "samples": [["4 4\n0 1 1 1\n1 1 1 0\n0 1 1 0\n1 1 0 1\n", "2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "福建省历届夏令营", "枚举", "前缀和"], "title": "最大正方形", "background": null, "description": "在一个 $n\\times m$ 的只包含 $0$ 和 $1$ 的矩阵里找出一个不包含 $0$ 的最大正方形，输出边长。\n\n保证矩阵里有至少一个 $1$。", "inputFormat": "输入文件第一行为两个整数 $n,m(1\\leq n,m\\leq 100)$，接下来 $n$ 行，每行 $m$ 个数字，用空格隔开，$0$ 或 $1$。", "outputFormat": "一个整数，最大正方形的边长。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "Largest Square", "background": "", "description": "In an $n\\times m$ matrix that contains only $0$ and $1$, find a largest square that does not contain any $0$, and output its side length. It is guaranteed that there is at least one $1$ in the matrix.", "inputFormat": "The first line of input contains two integers $n,m(1\\leq n,m\\leq 100)$. Then follow $n$ lines, each containing $m$ numbers separated by spaces, $0$ or $1$.", "outputFormat": "A single integer, the side length of the largest square.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "最大正方形", "background": null, "description": "在一个 $n\\times m$ 的只包含 $0$ 和 $1$ 的矩阵里找出一个不包含 $0$ 的最大正方形，输出边长。\n\n保证矩阵里有至少一个 $1$。", "inputFormat": "输入文件第一行为两个整数 $n,m(1\\leq n,m\\leq 100)$，接下来 $n$ 行，每行 $m$ 个数字，用空格隔开，$0$ 或 $1$。", "outputFormat": "一个整数，最大正方形的边长。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P1388", "type": "P", "difficulty": 4, "samples": [["5 2\n1 2 3 4 5\n", "120\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "搜索", "福建省历届夏令营", "区间 DP"], "title": "算式", "background": "", "description": "给出 $n$ 个数字，不改变它们的相对位置，在中间加入 $k$ 个乘号和 $(n-k-1)$ 个加号，括号随便加，使最终结果尽量大。因为乘号和加号一共就是 $n-1$ 个了，所以恰好每两个相邻数字之间都有一个符号。例如：\n\n$n=5$，$k=2$，$5$ 个数字分别为 $1$，$2$，$3$，$4$，$5$，可以加成：\n\n$$1\\times 2\\times(3+4+5)=24$$\n$$1\\times(2+3)\\times(4+5)=45$$\n$$(1\\times2+3)\\times(4+5)=45$$\n$$\\ldots\\ldots$$", "inputFormat": "输入的第一行为两个用空格隔开的整数，分别表示表示 $n$ 和 $k$。\n\n第二行为 $n$ 个用空格隔开的整数 $a_i$，代表给出的数字。", "outputFormat": "输出文件仅一行包含一个整数，表示要求的最大的结果。\n", "hint": "#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，保证 $2\\le n\\le15$，$0\\le k\\lt n$，$0 \\leq a_i \\leq 9$，答案小于 $2^{31}$。", "locale": "zh-CN", "translations": {"en": {"title": "Expression", "background": "", "description": "Given $n$ numbers, without changing their relative order, insert $k$ multiplication signs and $(n-k-1)$ plus signs between them. Parentheses can be added arbitrarily to maximize the final result. Since the total number of operators is $n-1$, there is exactly one operator between every pair of adjacent numbers. For example:\n\nWhen $n=5$, $k=2$, and the $5$ numbers are $1$, $2$, $3$, $4$, $5$, you can form:\n\n$$1\\times 2\\times(3+4+5)=24$$\n$$1\\times(2+3)\\times(4+5)=45$$\n$$(1\\times2+3)\\times(4+5)=45$$\n$$\\ldots\\ldots$$", "inputFormat": "The first line contains two integers separated by a space, denoting $n$ and $k$.\n\nThe second line contains $n$ space-separated integers $a_i$, representing the given numbers.", "outputFormat": "Output a single line containing one integer, the maximum possible result.", "hint": "#### Constraints\n\n- For $100\\%$ of the testdata, it is guaranteed that $2\\le n\\le15$, $0\\le k\\lt n$, $0 \\leq a_i \\leq 9$, and the answer is less than $2^{31}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "算式", "background": "", "description": "给出 $n$ 个数字，不改变它们的相对位置，在中间加入 $k$ 个乘号和 $(n-k-1)$ 个加号，括号随便加，使最终结果尽量大。因为乘号和加号一共就是 $n-1$ 个了，所以恰好每两个相邻数字之间都有一个符号。例如：\n\n$n=5$，$k=2$，$5$ 个数字分别为 $1$，$2$，$3$，$4$，$5$，可以加成：\n\n$$1\\times 2\\times(3+4+5)=24$$\n$$1\\times(2+3)\\times(4+5)=45$$\n$$(1\\times2+3)\\times(4+5)=45$$\n$$\\ldots\\ldots$$", "inputFormat": "输入的第一行为两个用空格隔开的整数，分别表示表示 $n$ 和 $k$。\n\n第二行为 $n$ 个用空格隔开的整数 $a_i$，代表给出的数字。", "outputFormat": "输出文件仅一行包含一个整数，表示要求的最大的结果。\n", "hint": "#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，保证 $2\\le n\\le15$，$0\\le k\\lt n$，$0 \\leq a_i \\leq 9$，答案小于 $2^{31}$。", "locale": "zh-CN"}}}
{"pid": "P1389", "type": "P", "difficulty": 5, "samples": [["6\n-100 5 6 10 0 0\n3 1 2 3 4 10\n", "11\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "福建省历届夏令营"], "title": "一个关于序列的游戏", "background": null, "description": "有一个序列，你可以在上面删除符合要求的连续段若干次。每次删除都会得到连续段长度对应的分数。\n\n需要符合的要求为：\n\n1. 相邻两个元素相差为 $1$。\n2. 如果某个元素不在连续段的最左或最右，那么这个元素就不能同时小于相邻的左右两个元素。\n\n$[1,2,3,4,3],[1,2],[3,2],[3]$ 都符合条件。\n\n显然，删除掉连续段后，这个段的左边和右边并在一起成为相邻元素。\n\n你的任务是对于给出的序列，计算出可能获得的最大总分。", "inputFormat": "第一行一个整数 $N$，表示序列长度。\n\n第二行 $N$ 个数，$V_1,V_2 \\cdots V_N$，代表每个长度对应的分数。\n\n第三行 $N$ 个数，$A_1,A_2 \\cdots A_N$，代表初始序列的每个元素。", "outputFormat": "一个数，可以获得的最大总分。", "hint": "### 数据范围及约定\n\n- 对于 $10\\%$ 的数据 $,N \\le 3$；\n- 对于 $40\\%$ 的数据 $,N \\le 10$；\n- 对于 $70\\%$ 的数据 $,N \\le 70$；\n- 对于 $100\\%$ 的数据 $,1 \\le N \\le 150$，$-10^4 \\le V_i \\le 10^4$，$0 \\le A_i \\le 10^9$。相同的 $A_i$ 不会超过 $14$ 个。", "locale": "zh-CN", "translations": {"en": {"title": "A Game About a Sequence", "background": "", "description": "There is a sequence. You may delete, any number of times, a contiguous segment that meets the rules below. Each deletion yields a score equal to the length of that segment.\n\nThe segment must satisfy:\n1. For every pair of adjacent elements, the absolute difference is $1$.\n2. If an element is not the leftmost or rightmost element of the segment, then it cannot be strictly smaller than both of its immediate neighbors.\n\nAll of $[1,2,3,4,3]$, $[1,2]$, $[3,2]$, and $[3]$ satisfy the rules.\n\nAfter removing a segment, the elements to the left and right of that segment become adjacent.\n\nYour task is: for the given sequence, compute the maximum possible total score.", "inputFormat": "The first line contains an integer $N$, the length of the sequence.\n\nThe second line contains $N$ integers $V_1, V_2 \\cdots V_N$, where $V_L$ is the score for deleting a segment of length $L$.\n\nThe third line contains $N$ integers $A_1, A_2 \\cdots A_N$, the elements of the initial sequence.", "outputFormat": "Output a single integer: the maximum total score that can be obtained.", "hint": "### Constraints\n\n- For $10\\%$ of the testdata, $N \\le 3$.\n- For $40\\%$ of the testdata, $N \\le 10$.\n- For $70\\%$ of the testdata, $N \\le 70$.\n- For $100\\%$ of the testdata, $1 \\le N \\le 150$, $-10000 \\le V_i \\le 10000$, $0 \\le A_i \\le 1000000000$. No value $A_i$ appears more than $14$ times.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "一个关于序列的游戏", "background": null, "description": "有一个序列，你可以在上面删除符合要求的连续段若干次。每次删除都会得到连续段长度对应的分数。\n\n需要符合的要求为：\n\n1. 相邻两个元素相差为 $1$。\n2. 如果某个元素不在连续段的最左或最右，那么这个元素就不能同时小于相邻的左右两个元素。\n\n$[1,2,3,4,3],[1,2],[3,2],[3]$ 都符合条件。\n\n显然，删除掉连续段后，这个段的左边和右边并在一起成为相邻元素。\n\n你的任务是对于给出的序列，计算出可能获得的最大总分。", "inputFormat": "第一行一个整数 $N$，表示序列长度。\n\n第二行 $N$ 个数，$V_1,V_2 \\cdots V_N$，代表每个长度对应的分数。\n\n第三行 $N$ 个数，$A_1,A_2 \\cdots A_N$，代表初始序列的每个元素。", "outputFormat": "一个数，可以获得的最大总分。", "hint": "### 数据范围及约定\n\n- 对于 $10\\%$ 的数据 $,N \\le 3$；\n- 对于 $40\\%$ 的数据 $,N \\le 10$；\n- 对于 $70\\%$ 的数据 $,N \\le 70$；\n- 对于 $100\\%$ 的数据 $,1 \\le N \\le 150$，$-10^4 \\le V_i \\le 10^4$，$0 \\le A_i \\le 10^9$。相同的 $A_i$ 不会超过 $14$ 个。", "locale": "zh-CN"}}}
{"pid": "P1390", "type": "P", "difficulty": 4, "samples": [["10\n", "67"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "数论", "O2优化", "莫比乌斯反演", "容斥原理", "整除分块", "欧拉函数"], "title": "公约数的和", "background": "有一天，TIBBAR 和 LXL 比赛谁先算出 $1 \\sim n$ 这 $n$ 个数中每任意两个不同的数的最大公约数的和。LXL 还在敲一个复杂而冗长的程序，争取能在 $100s$ 内出解。而 TIBBAR 则直接想 $1s$ 秒过而获得完胜，请你帮他完成这个任务。\n", "description": "给定 $n$，求\n$$\\sum_{i = 1}^n \\sum_{j = i + 1}^n \\gcd(i, j)$$\n\n其中 $\\gcd(i, j)$ 表示 $i$ 和 $j$ 的最大公约数。", "inputFormat": "输入只有一行一个整数，表示 $n$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "#### 数据规模与约定\n\n- 对于 $40\\%$ 的数据，保证 $n \\leq 2 \\times 10^3$。\n- 对于 $100\\%$ 的数据，保证 $2 \\leq n \\leq 2 \\times 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "Sum of GCDs", "background": "One day, TIBBAR and LXL competed to see who could first compute the sum of the greatest common divisors of every pair of distinct numbers among the $n$ numbers from $1 \\sim n$. LXL is still typing a complicated and lengthy program, hoping to get an answer within $100s$. TIBBAR, however, wants to pass in $1s$ for a decisive win; please help him accomplish this task.", "description": "Given $n$, compute\n$$\\sum_{i = 1}^n \\sum_{j = i + 1}^n \\gcd(i, j)$$\n\nwhere $\\gcd(i, j)$ denotes the greatest common divisor of $i$ and $j$.", "inputFormat": "The input consists of a single line with one integer, denoting $n$.", "outputFormat": "Output a single line with one integer representing the answer.", "hint": "Constraints\n\n- For 40% of the testdata, $n \\leq 2 \\times 10^3$.\n- For 100% of the testdata, $2 \\leq n \\leq 2 \\times 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "公约数的和", "background": "有一天，TIBBAR 和 LXL 比赛谁先算出 $1 \\sim n$ 这 $n$ 个数中每任意两个不同的数的最大公约数的和。LXL 还在敲一个复杂而冗长的程序，争取能在 $100s$ 内出解。而 TIBBAR 则直接想 $1s$ 秒过而获得完胜，请你帮他完成这个任务。\n", "description": "给定 $n$，求\n$$\\sum_{i = 1}^n \\sum_{j = i + 1}^n \\gcd(i, j)$$\n\n其中 $\\gcd(i, j)$ 表示 $i$ 和 $j$ 的最大公约数。", "inputFormat": "输入只有一行一个整数，表示 $n$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "#### 数据规模与约定\n\n- 对于 $40\\%$ 的数据，保证 $n \\leq 2 \\times 10^3$。\n- 对于 $100\\%$ 的数据，保证 $2 \\leq n \\leq 2 \\times 10^6$。", "locale": "zh-CN"}}}
{"pid": "P1391", "type": "P", "difficulty": 5, "samples": [["3\n0 0 0\n1 0 0\n0 0 0\n", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索"], "title": "方阵安排", "background": "", "description": "A 班希望在学校的行军比赛中取得一个好成绩，他们希望自己班级的行军方阵是一个完美的方阵。他们认为，如果每个人四周的男生个数为偶数，那么这就是一个完美的方阵。\n\n现在你已知道 A 班现有的方阵，你需要把尽量少的女生改成男生，使这个方阵变成一个完美的方阵。\n", "inputFormat": "输入的第一行是一个正整数 $n$，表示方阵大小为 $n \\times n$ 。\n\n第 $2$ 到第 $(n+1)$ 行，每行 $n$ 个数非零即一的数字，第 $(i + 1)$ 行的第 $j$ 个数字代表方阵第 $i$ 行第 $j$ 列的人的性别，其中 $0$ 为女生，$1$ 为男生。", "outputFormat": "输出一个数，表示最少需要把女生改成男生的个数。若无解，输出 $-1$。", "hint": "#### 输入输出样例 1 解释\n\n将方阵改为\n\n```\n0 1 0\n1 0 1\n0 1 0\n```\n\n---\n\n#### 数据规模与约定\n\n对于 $40\\%$ 的数据，保证 $n \\leq 6$。\n\n对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 18$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Square Formation Arrangement", "background": "", "description": "Class A wants a good result in the school marching competition, and they hope their class’s marching formation is a perfect square formation. They consider the formation perfect if, for every person, the number of boys among the four adjacent neighbors (up, down, left, right) is even, considering only neighbors within the grid.\n\nYou are given Class A’s current formation. You need to change as few girls as possible into boys to make the formation perfect.", "inputFormat": "The first line contains a positive integer $n$, meaning the formation is of size $n \\times n$.\n\nLines $2$ to $(n+1)$ each contain $n$ numbers, each either $0$ or $1$. In the $(i+1)$-th line, the $j$-th number represents the gender of the person at row $i$, column $j$, where $0$ means girl and $1$ means boy.", "outputFormat": "Output a single number: the minimum number of girls that need to be changed into boys. If there is no solution, output $-1$.", "hint": "#### Explanation for Sample 1\n\nChange the formation to:\n\n```\n0 1 0\n1 0 1\n0 1 0\n```\n\n---\n\n#### Constraints\n\nFor $40\\%$ of the testdata, $n \\leq 6$.\n\nFor $100\\%$ of the testdata, $1 \\leq n \\leq 18$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "方阵安排", "background": "", "description": "A 班希望在学校的行军比赛中取得一个好成绩，他们希望自己班级的行军方阵是一个完美的方阵。他们认为，如果每个人四周的男生个数为偶数，那么这就是一个完美的方阵。\n\n现在你已知道 A 班现有的方阵，你需要把尽量少的女生改成男生，使这个方阵变成一个完美的方阵。\n", "inputFormat": "输入的第一行是一个正整数 $n$，表示方阵大小为 $n \\times n$ 。\n\n第 $2$ 到第 $(n+1)$ 行，每行 $n$ 个数非零即一的数字，第 $(i + 1)$ 行的第 $j$ 个数字代表方阵第 $i$ 行第 $j$ 列的人的性别，其中 $0$ 为女生，$1$ 为男生。", "outputFormat": "输出一个数，表示最少需要把女生改成男生的个数。若无解，输出 $-1$。", "hint": "#### 输入输出样例 1 解释\n\n将方阵改为\n\n```\n0 1 0\n1 0 1\n0 1 0\n```\n\n---\n\n#### 数据规模与约定\n\n对于 $40\\%$ 的数据，保证 $n \\leq 6$。\n\n对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 18$。\n", "locale": "zh-CN"}}}
{"pid": "P1392", "type": "P", "difficulty": 5, "samples": [["3 3 2\n1 2 3\n6 3 5\n4 1 2\n", "5 6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["堆"], "title": "取数", "background": null, "description": "在一个 $n$ 行 $m$ 列的数阵中，你须在每一行取一个数（共 $n$ 个数），并将它们相加得到一个和。对于给定的数阵，请你输出和前 $k$ 小的取数方法。", "inputFormat": "第一行，三个数 $n,m,k$。\n\n第 $2\\sim n+1$ 行，每行 $m$ 个正整数。", "outputFormat": "一行共 $k$ 个数，代表在每一行取一个数前 $k$ 小的加和。", "hint": "对于 $20\\%$ 的数据，$1\\le n\\le 8$。\n\n对于 $100\\%$ 的数据，$1\\le n\\le 800$，$1\\le k\\le m\\le 800$，保证最后答案不超过 $2^{31}-1$。", "locale": "zh-CN", "translations": {"en": {"title": "Picking Numbers", "background": "", "description": "In an $n$-row, $m$-column array of numbers, you must pick one number from each row (a total of $n$ numbers) and add them to get a sum. For the given array, please output the $k$ smallest picking methods by sum.", "inputFormat": "The first line contains three numbers $n,m,k$.\nLines $2\\sim n+1$, each line contains $m$ positive integers.", "outputFormat": "One line containing $k$ numbers, representing the $k$ smallest sums when picking one number from each row.", "hint": "For $20\\%$ of the testdata, $1\\le n\\le 8$.\nFor $100\\%$ of the testdata, $1\\le n\\le 800$, $1\\le k\\le m\\le 800$. It is guaranteed that the final answer does not exceed $2^{31}-1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "取数", "background": null, "description": "在一个 $n$ 行 $m$ 列的数阵中，你须在每一行取一个数（共 $n$ 个数），并将它们相加得到一个和。对于给定的数阵，请你输出和前 $k$ 小的取数方法。", "inputFormat": "第一行，三个数 $n,m,k$。\n\n第 $2\\sim n+1$ 行，每行 $m$ 个正整数。", "outputFormat": "一行共 $k$ 个数，代表在每一行取一个数前 $k$ 小的加和。", "hint": "对于 $20\\%$ 的数据，$1\\le n\\le 8$。\n\n对于 $100\\%$ 的数据，$1\\le n\\le 800$，$1\\le k\\le m\\le 800$，保证最后答案不超过 $2^{31}-1$。", "locale": "zh-CN"}}}
{"pid": "P1393", "type": "P", "difficulty": 6, "samples": [["3 2 2\n1 1", "623902721"], ["6 3 4\n1 2 3 2", "480636170"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["字符串", "数学", "KMP 算法", "快速数论变换 NTT"], "title": "Mivik 的标题", "background": "Mivik 现在已经写好了他的书，他现在准备给这本书起个书名去投稿。", "description": "由于 Mivik 写书是乱敲键盘敲出来的，他准备对书名干同样的事情。Mivik 的键盘上有 $m$ 个不同的按键，对应着 $m$ 个不同的字符。Mivik 决定在这个键盘上**等概率**随机敲 $n$ 次敲出标题。但出于某些原因，Mivik 希望书名中要包含有一个人的名字 $S$。于是 Mivik 来问你，他随机敲出的标题有多大的概率包含有这个名字。\n\n同样的，Mivik 并不喜欢奇形怪状的小数，所以你只需要输出这个概率对 $998244353$ 取模后的值。", "inputFormat": "第一行三个整数 $n$、$m$、$|S|$，其中 $|S|$ 代表这个名字的长度。\n\n第二行给出 $|S|$ 个整数 $a_i$，代表这个名字。", "outputFormat": "一行一个整数，代表概率对 $998244353$ 取模后的值。", "hint": "### 样例解释\n\n样例一：为方便描述，我们定义键盘上两个按键为 `a` 和 `b`。那么长度为 3 的所有字符串共有 `aaa`、`aab`、`aba`、`abb`、`baa`、`bab`、`bba`、`bbb` 这 8 个，其中包含有指定名字 `aa` 的共有 `aaa`、`aab`、`baa` 这三个，则概率为 $\\frac{3}{8}$，取模后得到 623902721。\n\n### 数据范围\n\n对于全部数据，有 $1\\le |S|\\le 10^5$，$|S|\\le n\\le |S|+10^5$，$1\\le m\\le 10^8$。\n\nSubtask 1 (5 pts)：满足 $m=1$。\n\nSubtask 2 (20 pts)：满足 $1\\le n, m\\le 250$。\n\nSubtask 3 (30 pts)：满足 $1\\le n, m\\le 5000$。\n\nSubtask 3 (45 pts)：无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "Mivik 的标题", "background": "Mivik 现在已经写好了他的书，他现在准备给这本书起个书名去投稿。", "description": "由于 Mivik 写书是乱敲键盘敲出来的，他准备对书名干同样的事情。Mivik 的键盘上有 $m$ 个不同的按键，对应着 $m$ 个不同的字符。Mivik 决定在这个键盘上**等概率**随机敲 $n$ 次敲出标题。但出于某些原因，Mivik 希望书名中要包含有一个人的名字 $S$。于是 Mivik 来问你，他随机敲出的标题有多大的概率包含有这个名字。\n\n同样的，Mivik 并不喜欢奇形怪状的小数，所以你只需要输出这个概率对 $998244353$ 取模后的值。", "inputFormat": "第一行三个整数 $n$、$m$、$|S|$，其中 $|S|$ 代表这个名字的长度。\n\n第二行给出 $|S|$ 个整数 $a_i$，代表这个名字。", "outputFormat": "一行一个整数，代表概率对 $998244353$ 取模后的值。", "hint": "### 样例解释\n\n样例一：为方便描述，我们定义键盘上两个按键为 `a` 和 `b`。那么长度为 3 的所有字符串共有 `aaa`、`aab`、`aba`、`abb`、`baa`、`bab`、`bba`、`bbb` 这 8 个，其中包含有指定名字 `aa` 的共有 `aaa`、`aab`、`baa` 这三个，则概率为 $\\frac{3}{8}$，取模后得到 623902721。\n\n### 数据范围\n\n对于全部数据，有 $1\\le |S|\\le 10^5$，$|S|\\le n\\le |S|+10^5$，$1\\le m\\le 10^8$。\n\nSubtask 1 (5 pts)：满足 $m=1$。\n\nSubtask 2 (20 pts)：满足 $1\\le n, m\\le 250$。\n\nSubtask 3 (30 pts)：满足 $1\\le n, m\\le 5000$。\n\nSubtask 3 (45 pts)：无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P1394", "type": "P", "difficulty": 3, "samples": [["4 2\n1 2 3 4\n1 2\n3 4\n", "Non"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["模拟", "图论", "福建省历届夏令营"], "title": "山上的国度", "background": "", "description": "有一个神秘的小国坐落在南方的青山之上，只有当黄昏时，落日耀眼的余晖刺破薄雾的遮拦，有机缘者才可看到小山上面的 $n$ 个美丽的村庄。\n\n传说这个古老的国家里有 $m$ 条枢纽管道，每一条苍老的管道连接着两个村庄，千百年来为村民提供水源的流通。\n\n$n$ 个村庄里只有一个水库，从有水库的村庄通过这些枢纽管道向其它村庄提供水源。大家都明白水往低处流，所有村庄都能得到水库的供水。\n\n黄小明就是那个有机缘者，同时他也是个偏执狂（把小猫绑在一起的那个变态小明），他迫切的想要知道水库应该在哪一个村庄，你能帮他解决疑惑吗？\n", "inputFormat": "第一行输入 $n,m$（$n,m \\leq 300$）。\n\n第二行输入 $n$ 个正整数，第 $i$ 个数表示第 $i$ 个村庄的海拔。之后 $m$ 行每行两个数表示这两个村庄之间有一条道路。（同海拔之间不能相互流水）\n", "outputFormat": "若存在这样的村庄，输出两行：第一行为 `Oui, j'ai trouve la solution.`，第二行为村庄的编号。\n\n否则，请输出 `Non`。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "The Kingdom on the Mountain", "background": "", "description": "A mysterious small country lies atop the verdant mountains in the south. Only at dusk, when the dazzling afterglow of the setting sun pierces the thin mist, can the destined few see the $n$ beautiful villages on the hill.\n\nLegend says there are $m$ hub pipelines in this ancient country. Each aged pipeline connects two villages and has carried water for the villagers for centuries.\n\nAmong the $n$ villages there is exactly one reservoir, which supplies water from its village to the others through these hub pipelines. Everyone knows that water flows downhill, and all villages can receive supply from the reservoir.\n\nHuang Xiaoming is one of the destined few, and he is also quite obsessive. He is eager to know in which village the reservoir should be located. Can you help resolve his doubt?", "inputFormat": "The first line contains $n, m$ ($n, m \\leq 300$).\n\nThe second line contains $n$ positive integers; the $i$-th number is the elevation of the $i$-th village. Then follow $m$ lines, each containing two integers indicating that there is a pipeline between those two villages. (No flow is possible between villages of the same elevation.)", "outputFormat": "If such a village exists, output two lines: the first line is `Oui, j'ai trouve la solution.`, and the second line is the index of the village.\n\nOtherwise, output `Non`.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "山上的国度", "background": "", "description": "有一个神秘的小国坐落在南方的青山之上，只有当黄昏时，落日耀眼的余晖刺破薄雾的遮拦，有机缘者才可看到小山上面的 $n$ 个美丽的村庄。\n\n传说这个古老的国家里有 $m$ 条枢纽管道，每一条苍老的管道连接着两个村庄，千百年来为村民提供水源的流通。\n\n$n$ 个村庄里只有一个水库，从有水库的村庄通过这些枢纽管道向其它村庄提供水源。大家都明白水往低处流，所有村庄都能得到水库的供水。\n\n黄小明就是那个有机缘者，同时他也是个偏执狂（把小猫绑在一起的那个变态小明），他迫切的想要知道水库应该在哪一个村庄，你能帮他解决疑惑吗？\n", "inputFormat": "第一行输入 $n,m$（$n,m \\leq 300$）。\n\n第二行输入 $n$ 个正整数，第 $i$ 个数表示第 $i$ 个村庄的海拔。之后 $m$ 行每行两个数表示这两个村庄之间有一条道路。（同海拔之间不能相互流水）\n", "outputFormat": "若存在这样的村庄，输出两行：第一行为 `Oui, j'ai trouve la solution.`，第二行为村庄的编号。\n\n否则，请输出 `Non`。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P1395", "type": "P", "difficulty": 3, "samples": [["4\n1 2 \n2 3 \n3 4 \n", "2 4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["福建省历届夏令营", "树的重心"], "title": "会议", "background": "", "description": "有一个村庄居住着 $n$ 个村民，有 $n-1$ 条路径使得这 $n$ 个村民的家联通，每条路径的长度都为 $1$。现在村长希望在某个村民家中召开一场会议，村长希望所有村民到会议地点的距离之和最小，那么村长应该要把会议地点设置在哪个村民的家中，并且这个距离总和最小是多少？若有多个节点都满足条件，则选择节点编号最小的那个点。", "inputFormat": "第一行，一个数 $n$，表示有 $n$ 个村民。\n\n接下来 $n-1$ 行，每行两个数字 $a$ 和 $b$，表示村民 $a$ 的家和村民 $b$ 的家之间存在一条路径。", "outputFormat": "一行输出两个数字 $x$ 和 $y$。\n\n$x$ 表示村长将会在哪个村民家中举办会议。\n\n$y$ 表示距离之和的最小值。", "hint": "#### 数据范围\n\n对于 $70\\%$ 数据 $n \\le 10^3$。\n\n对于 $100\\%$ 数据 $n \\le 5 \\times 10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "Meeting", "background": "", "description": "There is a village with $n$ villagers, connected by $n-1$ paths so that all $n$ homes are connected. Each path has length $1$. The village head wants to hold a meeting at some villager’s home. He wants the sum of distances from all villagers to the meeting place to be minimal. Which villager’s home should be chosen, and what is the minimum total distance? If multiple nodes meet the condition, choose the node with the smallest index.", "inputFormat": "The first line contains an integer $n$, the number of villagers.\n\nThe next $n-1$ lines each contain two integers $a$ and $b$, indicating that there is a path between villager $a$ and villager $b$.", "outputFormat": "Output two integers $x$ and $y$ in one line.\n\nHere, $x$ is the villager’s home where the meeting will be held.\n\n$y$ is the minimum possible sum of distances.", "hint": "#### Constraints\n\nFor $70\\%$ of the testdata, $n \\le 10^3$.\n\nFor $100\\%$ of the testdata, $n \\le 5 \\times 10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "会议", "background": "", "description": "有一个村庄居住着 $n$ 个村民，有 $n-1$ 条路径使得这 $n$ 个村民的家联通，每条路径的长度都为 $1$。现在村长希望在某个村民家中召开一场会议，村长希望所有村民到会议地点的距离之和最小，那么村长应该要把会议地点设置在哪个村民的家中，并且这个距离总和最小是多少？若有多个节点都满足条件，则选择节点编号最小的那个点。", "inputFormat": "第一行，一个数 $n$，表示有 $n$ 个村民。\n\n接下来 $n-1$ 行，每行两个数字 $a$ 和 $b$，表示村民 $a$ 的家和村民 $b$ 的家之间存在一条路径。", "outputFormat": "一行输出两个数字 $x$ 和 $y$。\n\n$x$ 表示村长将会在哪个村民家中举办会议。\n\n$y$ 表示距离之和的最小值。", "hint": "#### 数据范围\n\n对于 $70\\%$ 数据 $n \\le 10^3$。\n\n对于 $100\\%$ 数据 $n \\le 5 \\times 10^4$。", "locale": "zh-CN"}}}
{"pid": "P1396", "type": "P", "difficulty": 3, "samples": [["3 3 1 3\n1 2 2\n2 3 1\n1 3 3", "2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["图论", "二分", "并查集", "福建省历届夏令营", "广度优先搜索 BFS", "最短路", "生成树"], "title": "营救", "background": "“咚咚咚……”“查水表！”原来是查水表来了，现在哪里找这么热心上门的查表员啊！小明感动得热泪盈眶，开起了门……", "description": "妈妈下班回家，街坊邻居说小明被一群陌生人强行押上了警车！妈妈丰富的经验告诉她小明被带到了 $t$ 区，而自己在 $s$ 区。\n\n该市有 $m$ 条大道连接 $n$ 个区，一条大道将两个区相连接，每个大道有一个拥挤度。小明的妈妈虽然很着急，但是不愿意拥挤的人潮冲乱了她优雅的步伐。所以请你帮她规划一条从 $s$ 至 $t$ 的路线，使得经过道路的拥挤度最大值最小。", "inputFormat": "第一行有四个用空格隔开的 $n$，$m$，$s$，$t$，其含义见【题目描述】。\n\n接下来 $m$ 行，每行三个整数 $u, v, w$，表示有一条大道连接区 $u$ 和区 $v$，且拥挤度为 $w$。\n\n**两个区之间可能存在多条大道**。", "outputFormat": "输出一行一个整数，代表最大的拥挤度。", "hint": "#### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，保证 $n\\leq 10$。\n- 对于 $60\\%$ 的数据，保证 $n\\leq 100$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n\\leq 10^4$，$1 \\leq m \\leq 2 \\times 10^4$，$w \\leq 10^4$，$1 \\leq s, t \\leq n$。且从 $s$ 出发一定能到达 $t$ 区。\n\n--- \n\n#### 样例输入输出 1 解释\n\n小明的妈妈要从 $1$ 号点去 $3$ 号点，最优路线为 $1 \\to 2 \\to 3$。", "locale": "zh-CN", "translations": {"en": {"title": "Rescue", "background": "“Knock, knock...” “Water meter inspection!” Turns out it’s the meter inspector. Where can you find such thoughtful door-to-door inspectors these days? Moved to tears, Xiaoming opened the door.", "description": "When Mom came home from work, the neighbors said that Xiaoming had been forced into a police car by a group of strangers. With her experience, she inferred that Xiaoming was taken to district $t$, while she herself is in district $s$.\n\nThe city has $m$ avenues connecting $n$ districts. Each avenue connects two districts and has a congestion level. Although Xiaoming’s mom is in a hurry, she does not want the crowded flow to disrupt her elegant pace. Please help her plan a route from $s$ to $t$ such that the maximum congestion level among the avenues on the route is minimized.", "inputFormat": "The first line contains four space-separated integers $n$, $m$, $s$, $t$, whose meanings are as described above.\n\nThe next $m$ lines each contain three integers $u, v, w$, indicating there is an avenue connecting districts $u$ and $v$ with congestion level $w$.\n\nThere may be multiple avenues between two districts.", "outputFormat": "Output a single integer: the minimal possible value of the maximum congestion level along the chosen route.", "hint": "#### Constraints\n\n- For $30\\%$ of the testdata, $n \\leq 10$.\n- For $60\\%$ of the testdata, $n \\leq 100$.\n- For $100\\%$ of the testdata, $1 \\leq n \\leq 10^4$, $1 \\leq m \\leq 2 \\times 10^4$, $w \\leq 10^4$, $1 \\leq s, t \\leq n$. It is guaranteed that from $s$ one can reach district $t$.\n\n---\n\n#### Explanation for Sample 1\n\nXiaoming’s mom needs to go from point 1 to point 3. An optimal route is 1 -> 2 -> 3.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "营救", "background": "“咚咚咚……”“查水表！”原来是查水表来了，现在哪里找这么热心上门的查表员啊！小明感动得热泪盈眶，开起了门……", "description": "妈妈下班回家，街坊邻居说小明被一群陌生人强行押上了警车！妈妈丰富的经验告诉她小明被带到了 $t$ 区，而自己在 $s$ 区。\n\n该市有 $m$ 条大道连接 $n$ 个区，一条大道将两个区相连接，每个大道有一个拥挤度。小明的妈妈虽然很着急，但是不愿意拥挤的人潮冲乱了她优雅的步伐。所以请你帮她规划一条从 $s$ 至 $t$ 的路线，使得经过道路的拥挤度最大值最小。", "inputFormat": "第一行有四个用空格隔开的 $n$，$m$，$s$，$t$，其含义见【题目描述】。\n\n接下来 $m$ 行，每行三个整数 $u, v, w$，表示有一条大道连接区 $u$ 和区 $v$，且拥挤度为 $w$。\n\n**两个区之间可能存在多条大道**。", "outputFormat": "输出一行一个整数，代表最大的拥挤度。", "hint": "#### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，保证 $n\\leq 10$。\n- 对于 $60\\%$ 的数据，保证 $n\\leq 100$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n\\leq 10^4$，$1 \\leq m \\leq 2 \\times 10^4$，$w \\leq 10^4$，$1 \\leq s, t \\leq n$。且从 $s$ 出发一定能到达 $t$ 区。\n\n--- \n\n#### 样例输入输出 1 解释\n\n小明的妈妈要从 $1$ 号点去 $3$ 号点，最优路线为 $1 \\to 2 \\to 3$。", "locale": "zh-CN"}}}
{"pid": "P1397", "type": "P", "difficulty": 5, "samples": [["3 4 1 3 2 6\n", "85\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["递推", "2013", "NOI", "矩阵乘法", "线性递推"], "title": "[NOI2013] 矩阵游戏", "background": "", "description": "婷婷是个喜欢矩阵的小朋友，有一天她想用电脑生成一个巨大的 $n$ 行 $m$ 列的矩阵（你不用担心她如何存储）。她生成的这个矩阵满足一个神奇的性质：若用 $F[i,j]$ 来表示矩阵中第 $i$ 行第 $j$ 列的元素，则 $F[i,j]$ 满足下面的递推式:\n\n$$\\begin{aligned}\nF[1, 1] &= 1 \\\\\nF[i, j] &=a\\times F[i, j-1]+b, &j\\neq 1 \\\\\nF[i, 1] &=c\\times F[i-1, m]+d, &i\\neq 1 \\\\\n\\end{aligned}$$\n\n递推式中 $a,b,c,d$ 都是给定的常数。\n\n现在婷婷想知道 $F[n,m]$ 的值是多少，请你帮助她。由于最终结果可能很大，你只需要输出 $F[n,m]$ 除以 $10^9+7$ 的余数。\n", "inputFormat": "包含一行有六个整数 $n,m,a,b,c,d$。意义如题所述。\n", "outputFormat": "包含一个整数，表示 $F[n,m]$ 除以 $10^9+7$ 的余数。\n", "hint": "【样例1说明】\n\n样例中的矩阵为：\n\n$$\\begin{pmatrix}\n 1 &  4 &  7 & 10 \\\\\n26 & 29 & 32 & 35 \\\\\n76 & 79 & 82 & 85 \\\\\n\\end{pmatrix}$$\n\n### 数据范围\n\n::cute-table{tuack}\n\n| 测试点编号 | 数据范围 |\n| :-: | :-: |\n| 1 | $1 \\le n,m \\le 10$；$1 \\le a,b,c,d \\le 1000$ |\n| 2 | $1 \\le n,m \\le 100$；$1 \\le a,b,c,d \\le 1000$ |\n| 3 | $1 \\le n,m \\le 10^3$；$1 \\le a,b,c,d \\le 10^9$ |\n| 4 | $1 \\le n,m \\le 10^3$；$1 \\le a,b,c,d \\le 10^9$ |\n| 5 | $1 \\le n,m \\le 10^9$；$1 \\le a = c \\le 10^9$；$1 \\le b = d \\le 10^9$ |\n| 6 | $1 \\le n,m \\le 10^9$；$a = c = 1$；$1 \\le b,d \\le 10^9$ |\n| 7 | $1 \\le n,m,a,b,c,d \\le 10^9$ |\n| 8 | $1 \\le n,m,a,b,c,d \\le 10^9$ |\n| 9 | $1 \\le n,m,a,b,c,d \\le 10^9$ |\n| 10 | $1 \\le n,m,a,b,c,d \\le 10^9$ |\n| 11 | $1 \\le n,m \\le 10^{1\\,000}$；$a = c = 1$；$1 \\le b,d \\le 10^9$ |\n| 12 | $1 \\le n,m \\le 10^{1\\,000}$；$1 \\le a = c \\le 10^9$；$1 \\le b = d \\le 10^9$ |\n| 13 | $1 \\le n,m \\le 10^{1\\,000}$；$1 \\le a,b,c,d \\le 10^9$ |\n| 14 | $1 \\le n,m \\le 10^{1\\,000}$；$1 \\le a,b,c,d \\le 10^9$ |\n| 15 | $1 \\le n,m \\le 10^{20\\,000}$；$1 \\le a,b,c,d \\le 10^9$ |\n| 16 | $1 \\le n,m \\le 10^{20\\,000}$；$1 \\le a,b,c,d \\le 10^9$ |\n| 17 | $1 \\le n,m \\le 10^{1\\,000\\,000}$；$a = c = 1$；$1 \\le b,d \\le 10^9$ |\n| 18 | $1 \\le n,m \\le 10^{1\\,000\\,000}$；$1 \\le a = c \\le 10^9$；$1 \\le b = d \\le 10^9$ |\n| 19 | $1 \\le n,m \\le 10^{1\\,000\\,000}$；$1 \\le a,b,c,d \\le 10^9$ |\n| 20 | $1 \\le n,m \\le 10^{1\\,000\\,000}$；$1 \\le a,b,c,d \\le 10^9$ |", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2013] Matrix Game", "background": "", "description": "Tingting is a kid who likes matrices. One day she wants to use a computer to generate a huge matrix with $n$ rows and $m$ columns (you do not need to worry about how she stores it). The matrix she generates has a magical property: let $F[i, j]$ denote the element at row $i$, column $j$, then $F[i, j]$ satisfies the following recurrence:\n\n$$\\begin{aligned}\nF[1, 1] &= 1 \\\\\nF[i, j] &=a\\times F[i, j-1]+b, &j\\neq 1 \\\\\nF[i, 1] &=c\\times F[i-1, m]+d, &i\\neq 1 \\\\\n\\end{aligned}$$\n\nIn the recurrence, $a, b, c, d$ are given constants.\n\nNow Tingting wants to know the value of $F[n, m]$. Please help her. Since the final result can be large, you only need to output the remainder of $F[n, m]$ modulo $10^9 + 7$.", "inputFormat": "One line containing six integers $n, m, a, b, c, d$. The meaning is as described above.", "outputFormat": "Output a single integer, the value of $F[n, m]$ modulo $10^9 + 7$.", "hint": "Explanation for Sample 1.\n\nThe matrix in the sample is:\n\n$$\\begin{pmatrix}\n 1 &  4 &  7 & 10 \\\\\n26 & 29 & 32 & 35 \\\\\n76 & 79 & 82 & 85 \\\\\n\\end{pmatrix}$$\n\n### Constraints\n\n::cute-table{tuack}\n\n| Test point ID | Constraints |\n| :-: | :-: |\n| 1 | $1 \\le n,m \\le 10$; $1 \\le a,b,c,d \\le 1000$ |\n| 2 | $1 \\le n,m \\le 100$; $1 \\le a,b,c,d \\le 1000$ |\n| 3 | $1 \\le n,m \\le 10^3$; $1 \\le a,b,c,d \\le 10^9$ |\n| 4 | $1 \\le n,m \\le 10^3$; $1 \\le a,b,c,d \\le 10^9$ |\n| 5 | $1 \\le n,m \\le 10^9$; $1 \\le a = c \\le 10^9$; $1 \\le b = d \\le 10^9$ |\n| 6 | $1 \\le n,m \\le 10^9$; $a = c = 1$; $1 \\le b,d \\le 10^9$ |\n| 7 | $1 \\le n,m,a,b,c,d \\le 10^9$ |\n| 8 | $1 \\le n,m,a,b,c,d \\le 10^9$ |\n| 9 | $1 \\le n,m,a,b,c,d \\le 10^9$ |\n| 10 | $1 \\le n,m,a,b,c,d \\le 10^9$ |\n| 11 | $1 \\le n,m \\le 10^{1\\,000}$; $a = c = 1$; $1 \\le b,d \\le 10^9$ |\n| 12 | $1 \\le n,m \\le 10^{1\\,000}$; $1 \\le a = c \\le 10^9$; $1 \\le b = d \\le 10^9$ |\n| 13 | $1 \\le n,m \\le 10^{1\\,000}$; $1 \\le a,b,c,d \\le 10^9$ |\n| 14 | $1 \\le n,m \\le 10^{1\\,000}$; $1 \\le a,b,c,d \\le 10^9$ |\n| 15 | $1 \\le n,m \\le 10^{20\\,000}$; $1 \\le a,b,c,d \\le 10^9$ |\n| 16 | $1 \\le n,m \\le 10^{20\\,000}$; $1 \\le a,b,c,d \\le 10^9$ |\n| 17 | $1 \\le n,m \\le 10^{1\\,000\\,000}$; $a = c = 1$; $1 \\le b,d \\le 10^9$ |\n| 18 | $1 \\le n,m \\le 10^{1\\,000\\,000}$; $1 \\le a = c \\le 10^9$; $1 \\le b = d \\le 10^9$ |\n| 19 | $1 \\le n,m \\le 10^{1\\,000\\,000}$; $1 \\le a,b,c,d \\le 10^9$ |\n| 20 | $1 \\le n,m \\le 10^{1\\,000\\,000}$; $1 \\le a,b,c,d \\le 10^9$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2013] 矩阵游戏", "background": "", "description": "婷婷是个喜欢矩阵的小朋友，有一天她想用电脑生成一个巨大的 $n$ 行 $m$ 列的矩阵（你不用担心她如何存储）。她生成的这个矩阵满足一个神奇的性质：若用 $F[i,j]$ 来表示矩阵中第 $i$ 行第 $j$ 列的元素，则 $F[i,j]$ 满足下面的递推式:\n\n$$\\begin{aligned}\nF[1, 1] &= 1 \\\\\nF[i, j] &=a\\times F[i, j-1]+b, &j\\neq 1 \\\\\nF[i, 1] &=c\\times F[i-1, m]+d, &i\\neq 1 \\\\\n\\end{aligned}$$\n\n递推式中 $a,b,c,d$ 都是给定的常数。\n\n现在婷婷想知道 $F[n,m]$ 的值是多少，请你帮助她。由于最终结果可能很大，你只需要输出 $F[n,m]$ 除以 $10^9+7$ 的余数。\n", "inputFormat": "包含一行有六个整数 $n,m,a,b,c,d$。意义如题所述。\n", "outputFormat": "包含一个整数，表示 $F[n,m]$ 除以 $10^9+7$ 的余数。\n", "hint": "【样例1说明】\n\n样例中的矩阵为：\n\n$$\\begin{pmatrix}\n 1 &  4 &  7 & 10 \\\\\n26 & 29 & 32 & 35 \\\\\n76 & 79 & 82 & 85 \\\\\n\\end{pmatrix}$$\n\n### 数据范围\n\n::cute-table{tuack}\n\n| 测试点编号 | 数据范围 |\n| :-: | :-: |\n| 1 | $1 \\le n,m \\le 10$；$1 \\le a,b,c,d \\le 1000$ |\n| 2 | $1 \\le n,m \\le 100$；$1 \\le a,b,c,d \\le 1000$ |\n| 3 | $1 \\le n,m \\le 10^3$；$1 \\le a,b,c,d \\le 10^9$ |\n| 4 | $1 \\le n,m \\le 10^3$；$1 \\le a,b,c,d \\le 10^9$ |\n| 5 | $1 \\le n,m \\le 10^9$；$1 \\le a = c \\le 10^9$；$1 \\le b = d \\le 10^9$ |\n| 6 | $1 \\le n,m \\le 10^9$；$a = c = 1$；$1 \\le b,d \\le 10^9$ |\n| 7 | $1 \\le n,m,a,b,c,d \\le 10^9$ |\n| 8 | $1 \\le n,m,a,b,c,d \\le 10^9$ |\n| 9 | $1 \\le n,m,a,b,c,d \\le 10^9$ |\n| 10 | $1 \\le n,m,a,b,c,d \\le 10^9$ |\n| 11 | $1 \\le n,m \\le 10^{1\\,000}$；$a = c = 1$；$1 \\le b,d \\le 10^9$ |\n| 12 | $1 \\le n,m \\le 10^{1\\,000}$；$1 \\le a = c \\le 10^9$；$1 \\le b = d \\le 10^9$ |\n| 13 | $1 \\le n,m \\le 10^{1\\,000}$；$1 \\le a,b,c,d \\le 10^9$ |\n| 14 | $1 \\le n,m \\le 10^{1\\,000}$；$1 \\le a,b,c,d \\le 10^9$ |\n| 15 | $1 \\le n,m \\le 10^{20\\,000}$；$1 \\le a,b,c,d \\le 10^9$ |\n| 16 | $1 \\le n,m \\le 10^{20\\,000}$；$1 \\le a,b,c,d \\le 10^9$ |\n| 17 | $1 \\le n,m \\le 10^{1\\,000\\,000}$；$a = c = 1$；$1 \\le b,d \\le 10^9$ |\n| 18 | $1 \\le n,m \\le 10^{1\\,000\\,000}$；$1 \\le a = c \\le 10^9$；$1 \\le b = d \\le 10^9$ |\n| 19 | $1 \\le n,m \\le 10^{1\\,000\\,000}$；$1 \\le a,b,c,d \\le 10^9$ |\n| 20 | $1 \\le n,m \\le 10^{1\\,000\\,000}$；$1 \\le a,b,c,d \\le 10^9$ |", "locale": "zh-CN"}}}
{"pid": "P1398", "type": "P", "difficulty": 6, "samples": [["3 13 \n1 1 -1 -1 1 -1 1 1 1 -1 1 1 1 \n1 -1 1 -1 1 -1 1 -1 1 -1 -1 1 -1 \n1 -1 -1 1 1 -1 1 1 1 -1 1 1 1 \n", "24"], ["3 13\n-1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1\n-1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1\n-1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1\n\n", "-20"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "2013", "NOI", "枚举"], "title": "[NOI2013] 书法家", "background": "", "description": "小 E 同学非常喜欢书法，他听说 NOI2013 已经开始了，想题一幅 “NOI” 的字送给大家。\n\n小 E 有一张非常神奇的纸，纸可以用一个 $n$ 行 $m$ 列的二维方格矩阵来表示，为了描述方便，我们定义矩阵左下角方格坐标为 $(1,1)$，右上角方格坐标为 $(m, n)$。\n\n矩阵的每个方格有一个整数的幸运值。在格子上面写字可以增加大家的幸运度，幸运度的大小恰好是所有被笔写到的方格的幸运值之和。现在你要在上面写\n上 `N`，`O`，`I` 三个字母。\n\n下面给出 $3$ 个书法字的定义:\n- `N` 由若干（$\\ge 3$）个边平行于坐标轴的矩形组成，设由 $K$ 个矩形组成（标号 $1 \\ldots K$），第 $i$ 个矩形的左下角方格坐标设为 $(L_i, B_i)$，右上角坐标设为 $(R_i, T_i )$，要求满足：\n  1. $L_i \\le R_i, B_i \\le T_i$；\n  2. 对任意 $1 < i \\le K$，有 $L_i = R_{i-1} + 1$；\n  3. 对任意 $3 \\le i < K$，有 $B_{i−1} − 1 \\le T_i \\le T_{i-1}$，$B_i \\le B_{i-1}$；\n  4. $B_2 > B_1$，$T_2 = T_1$，$B_{K-1} = B_K$，$T_{K-1} < T_K$；\n- `O` 由一个大矩形 $A$，挖去一个小矩形 $B$ 得到，这两个矩形的边都平行于坐标轴。设大矩形 $A$ 左下角的方格坐标为 $(u, v)$，长为 $W$，宽为 $H$，则小矩形 $B$ 满足左下角方格坐标为 $(u + 1, v + 1)$，长 $W - 2$，宽 $H - 2$。要求满足：\n  1. $W \\ge 3$，$H \\ge 3$；\n  2. $u > R_K + 1$；\n- `I` 为 $3$ 个边平行于坐标轴的从下到上的实心矩形组成，从下到上依次标号为 $1,2,3$，第 $i$ 个矩形的左下角格子坐标设为 $(P_i , Q_i )$，右上角格子坐标设为 $(G_i , H_i )$，要求满足：\n  1. $P_i \\le G_i , Q_i \\le H_i$；\n  2. $P_1 = P_3 > u + W$，$G_1 = G_3$；\n  3. $Q_1 = H_1 = Q_2 - 1, H_2 + 1 = Q_3 = H_3$；\n  4. $P_1 < P_2 \\le G_2 < G_1$。\n\n下图是一个 `N`,`O`,`I` 的例子：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g7t4tquv.png)\n\n另外，所有画的图形均不允许超过纸张的边界。现在小 E 想要知道,他能画出的最大幸运度是多少。", "inputFormat": "第一行包含两个正整数 $n$ 和 $m$ ,分别表示矩阵的行数和列数。\n\n接下来 $n$ 行，每行有 $m$ 个整数，第 $i + 1$ 行的第 $j$ 个数表示格子 $(j, n - i + 1)$ 的幸运值。", "outputFormat": "输出一个整数 $T$，表示小 E 能够获得的最大幸运度。", "hint": "### 样例解释 1\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/vq7asar5.png)\n\n### 样例解释 2\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1ojygumc.png)\n\n### 数据范围\n\n::cute-table{tuack}\n\n| 测试点编号 |   $n$   |   $m$    | 幸运值范围 |\n| :--------: | :------: | :------: | :--------: |\n|     1      |   $=3$   |  $=12$   | $[-50,50]$ |\n|     2      |   ^   |  ^   | ^ |\n|     3      |   ^   |  ^   | ^ |\n|     4      |   ^   |  ^   | ^ |\n|     5      | $\\le10$  | $\\le20$  | ^ |\n|     6      | ^  | ^  | ^ |\n|     7      | ^  | ^  | ^ |\n|     8      | ^  | ^  | ^ |\n|     9      | $\\le150$ | $\\le500$ |    $=1$    |\n|     10     | ^ | ^ |    ^    |\n|     11     | $\\le80$  | $\\le80$  |    $[-200,200]$    |\n|     12     | ^  | ^  |    ^    |\n|     13     | ^  | ^  |    ^    |\n|     14     | ^  | ^  |    ^    |\n|     15     | $\\le150$  | $\\le500$  |    ^    |\n|     16     | ^  | ^  |    ^    |\n|     17     | ^  | ^  |    ^    |\n|     18     | ^  | ^  |    ^    |\n|     19     | ^  | ^  |    ^    |\n|     20     | ^  | ^  |    ^    |\n\n对于所有的测试数据，保证 $n \\ge 3,m \\ge 12$。", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2013] Calligrapher", "background": "", "description": "Student Xiao E loves calligraphy. He heard that NOI2013 has started, and he wants to write the word \"NOI\" to give to everyone.\n\nXiao E has a magical sheet of paper, which can be represented as a 2D grid of $n$ rows and $m$ columns. For convenience, we define the lower-left cell of the grid to have coordinates $(1, 1)$, and the upper-right cell to have coordinates $(m, n)$.\n\nEach cell in the grid has an integer luck value. Writing on the cells increases everyone’s luck. The total luck equals the sum of the luck values of all the cells touched by the brush. Now you need to write the three letters `N`, `O`, and `I` on the paper.\n\nDefinitions of the three calligraphic letters:\n- `N` consists of several (at least $3$) rectangles whose edges are parallel to the coordinate axes. Suppose it consists of $K$ rectangles (indexed $1 \\ldots K$). Let the lower-left cell of the $i$-th rectangle be $(L_i, B_i)$ and the upper-right cell be $(R_i, T_i)$. They must satisfy:\n  1. $L_i \\le R_i, B_i \\le T_i$.\n  2. For any $1 < i \\le K$, $L_i = R_{i-1} + 1$.\n  3. For any $3 \\le i < K$, $B_{i-1} - 1 \\le T_i \\le T_{i-1}$, $B_i \\le B_{i-1}$.\n  4. $B_2 > B_1$, $T_2 = T_1$, $B_{K-1} = B_K$, $T_{K-1} < T_K$.\n- `O` is formed by taking a large rectangle $A$ and removing a smaller rectangle $B$ from its interior. Both rectangles are axis-aligned. Let the lower-left cell of the large rectangle $A$ be $(u, v)$, with width $W$ and height $H$. Then the small rectangle $B$ has lower-left cell $(u + 1, v + 1)$, width $W - 2$, and height $H - 2$. They must satisfy:\n  1. $W \\ge 3$, $H \\ge 3$.\n  2. $u > R_K + 1$.\n- `I` consists of $3$ solid rectangles whose edges are parallel to the coordinate axes and are stacked from bottom to top, indexed $1, 2, 3$ from bottom to top. Let the lower-left cell of the $i$-th rectangle be $(P_i, Q_i)$ and the upper-right cell be $(G_i, H_i)$. They must satisfy:\n  1. $P_i \\le G_i, Q_i \\le H_i$.\n  2. $P_1 = P_3 > u + W$, $G_1 = G_3$.\n  3. $Q_1 = H_1 = Q_2 - 1$, $H_2 + 1 = Q_3 = H_3$.\n  4. $P_1 < P_2 \\le G_2 < G_1$.\n\nAn example of `N`, `O`, and `I` is shown below:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g7t4tquv.png)\n\nIn addition, all drawn shapes are not allowed to go beyond the boundaries of the paper. Now Xiao E wants to know the maximum total luck he can achieve.", "inputFormat": "The first line contains two positive integers $n$ and $m$, representing the number of rows and columns of the matrix, respectively.\n\nThen $n$ lines follow, each containing $m$ integers. In the $(i + 1)$-th line, the $j$-th number is the luck value of cell $(j, n - i + 1)$.", "outputFormat": "Output an integer $T$, which is the maximum total luck that Xiao E can obtain.", "hint": "### Sample Explanation 1\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/vq7asar5.png)\n\n### Sample Explanation 2\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1ojygumc.png)\n\n### Constraints\n\n| Test point ID |   $n$   |   $m$    | Luck value range |\n| :-----------: | :-----: | :------: | :--------------: |\n|       1       |   $=3$  |  $=12$   |   $[-50,50]$     |\n|       2       |    ^    |    ^     |        ^         |\n|       3       |    ^    |    ^     |        ^         |\n|       4       |    ^    |    ^     |        ^         |\n|       5       | $\\le10$ | $\\le20$  |        ^         |\n|       6       |    ^    |    ^     |        ^         |\n|       7       |    ^    |    ^     |        ^         |\n|       8       |    ^    |    ^     |        ^         |\n|       9       | $\\le150$| $\\le500$ |       $=1$       |\n|      10       |    ^    |    ^     |        ^         |\n|      11       |  $\\le80$|  $\\le80$ |   $[-200,200]$   |\n|      12       |    ^    |    ^     |        ^         |\n|      13       |    ^    |    ^     |        ^         |\n|      14       |    ^    |    ^     |        ^         |\n|      15       | $\\le150$| $\\le500$ |        ^         |\n|      16       |    ^    |    ^     |        ^         |\n|      17       |    ^    |    ^     |        ^         |\n|      18       |    ^    |    ^     |        ^         |\n|      19       |    ^    |    ^     |        ^         |\n|      20       |    ^    |    ^     |        ^         |\n\nFor all testdata, it is guaranteed that $n \\ge 3, m \\ge 12$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2013] 书法家", "background": "", "description": "小 E 同学非常喜欢书法，他听说 NOI2013 已经开始了，想题一幅 “NOI” 的字送给大家。\n\n小 E 有一张非常神奇的纸，纸可以用一个 $n$ 行 $m$ 列的二维方格矩阵来表示，为了描述方便，我们定义矩阵左下角方格坐标为 $(1,1)$，右上角方格坐标为 $(m, n)$。\n\n矩阵的每个方格有一个整数的幸运值。在格子上面写字可以增加大家的幸运度，幸运度的大小恰好是所有被笔写到的方格的幸运值之和。现在你要在上面写\n上 `N`，`O`，`I` 三个字母。\n\n下面给出 $3$ 个书法字的定义:\n- `N` 由若干（$\\ge 3$）个边平行于坐标轴的矩形组成，设由 $K$ 个矩形组成（标号 $1 \\ldots K$），第 $i$ 个矩形的左下角方格坐标设为 $(L_i, B_i)$，右上角坐标设为 $(R_i, T_i )$，要求满足：\n  1. $L_i \\le R_i, B_i \\le T_i$；\n  2. 对任意 $1 < i \\le K$，有 $L_i = R_{i-1} + 1$；\n  3. 对任意 $3 \\le i < K$，有 $B_{i−1} − 1 \\le T_i \\le T_{i-1}$，$B_i \\le B_{i-1}$；\n  4. $B_2 > B_1$，$T_2 = T_1$，$B_{K-1} = B_K$，$T_{K-1} < T_K$；\n- `O` 由一个大矩形 $A$，挖去一个小矩形 $B$ 得到，这两个矩形的边都平行于坐标轴。设大矩形 $A$ 左下角的方格坐标为 $(u, v)$，长为 $W$，宽为 $H$，则小矩形 $B$ 满足左下角方格坐标为 $(u + 1, v + 1)$，长 $W - 2$，宽 $H - 2$。要求满足：\n  1. $W \\ge 3$，$H \\ge 3$；\n  2. $u > R_K + 1$；\n- `I` 为 $3$ 个边平行于坐标轴的从下到上的实心矩形组成，从下到上依次标号为 $1,2,3$，第 $i$ 个矩形的左下角格子坐标设为 $(P_i , Q_i )$，右上角格子坐标设为 $(G_i , H_i )$，要求满足：\n  1. $P_i \\le G_i , Q_i \\le H_i$；\n  2. $P_1 = P_3 > u + W$，$G_1 = G_3$；\n  3. $Q_1 = H_1 = Q_2 - 1, H_2 + 1 = Q_3 = H_3$；\n  4. $P_1 < P_2 \\le G_2 < G_1$。\n\n下图是一个 `N`,`O`,`I` 的例子：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g7t4tquv.png)\n\n另外，所有画的图形均不允许超过纸张的边界。现在小 E 想要知道,他能画出的最大幸运度是多少。", "inputFormat": "第一行包含两个正整数 $n$ 和 $m$ ,分别表示矩阵的行数和列数。\n\n接下来 $n$ 行，每行有 $m$ 个整数，第 $i + 1$ 行的第 $j$ 个数表示格子 $(j, n - i + 1)$ 的幸运值。", "outputFormat": "输出一个整数 $T$，表示小 E 能够获得的最大幸运度。", "hint": "### 样例解释 1\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/vq7asar5.png)\n\n### 样例解释 2\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1ojygumc.png)\n\n### 数据范围\n\n::cute-table{tuack}\n\n| 测试点编号 |   $n$   |   $m$    | 幸运值范围 |\n| :--------: | :------: | :------: | :--------: |\n|     1      |   $=3$   |  $=12$   | $[-50,50]$ |\n|     2      |   ^   |  ^   | ^ |\n|     3      |   ^   |  ^   | ^ |\n|     4      |   ^   |  ^   | ^ |\n|     5      | $\\le10$  | $\\le20$  | ^ |\n|     6      | ^  | ^  | ^ |\n|     7      | ^  | ^  | ^ |\n|     8      | ^  | ^  | ^ |\n|     9      | $\\le150$ | $\\le500$ |    $=1$    |\n|     10     | ^ | ^ |    ^    |\n|     11     | $\\le80$  | $\\le80$  |    $[-200,200]$    |\n|     12     | ^  | ^  |    ^    |\n|     13     | ^  | ^  |    ^    |\n|     14     | ^  | ^  |    ^    |\n|     15     | $\\le150$  | $\\le500$  |    ^    |\n|     16     | ^  | ^  |    ^    |\n|     17     | ^  | ^  |    ^    |\n|     18     | ^  | ^  |    ^    |\n|     19     | ^  | ^  |    ^    |\n|     20     | ^  | ^  |    ^    |\n\n对于所有的测试数据，保证 $n \\ge 3,m \\ge 12$。", "locale": "zh-CN"}}}
{"pid": "P1399", "type": "P", "difficulty": 6, "samples": [["4 \n1 2 1 \n1 4 2 \n1 3 2 \n2 4 1\n", "2.0 "], ["5\n1 5 100\n2 1 77\n3 2 80\n4 1 64\n5 3 41", "109.0"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["递推", "2013", "线段树", "NOI", "深度优先搜索 DFS", "基环树"], "title": "[NOI2013] 快餐店", "background": "", "description": "小 T 打算在城市 C 开设一家外送快餐店。送餐到某一个地点的时间与外卖店到该地点之间最短路径长度是成正比的，小 T 希望快餐店的地址选在离最远的顾客距离最近的地方。\n\n快餐店的顾客分布在城市 C 的 $N$ 个建筑中，这 $N$ 个建筑通过恰好 $N$ 条双向道路连接起来，不存在任何两条道路连接了相同的两个建筑。任意两个建筑之间至少存在一条由双向道路连接而成的路径。小 T 的快餐店可以开设在任一建筑中，也可以开设在任意一条道路的某个位置上（该位置与道路两端的建筑的距离不一定是整数）。\n\n现给定城市 C 的地图（道路分布及其长度），请找出最佳的快餐店选址，输出其与最远的顾客之间的距离。", "inputFormat": "第一行包含一个整数 $N$，表示城市 C 中的建筑和道路数目。\n\n接下来 $N$ 行，每行 $3$ 个整数，$A_i,B_i,L_i$（$1\\leq i\\leq N$，$L_i>0$），表示一条道路连接了建筑 $A_i$ 与 $B_i$，其长度为 $L_i$。\n", "outputFormat": "输出仅包含一个实数，四舍五入保留**恰好一位小数**，表示最佳快餐店选址距离最远用户的距离。\n\n注意：你的结果必须恰好有一位小数，小数位数不正确不得分。", "hint": "### 样例解释 1\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/r0dmxcgy.png)\n\n### 样例解释 2\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pf8eaowl.png)\n\n### 数据范围\n\n- 对于 $10\\%$ 的数据，$N\\leq 80$，$L_i=1$；\n- 对于 $30\\%$ 的数据，$N\\leq 600$，$L_i\\leq 100$；\n- 对于 $60\\%$ 的数据，$N\\leq 2000$，$L_i\\leq 10^9$；\n- 对于 $100\\%$ 的数据，$1\\leq N\\leq 10^5$，$1\\leq L_i \\leq 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2013] Fast Food Restaurant", "background": "", "description": "Xiao T plans to open a delivery fast food restaurant in city C. The time to deliver to a location is proportional to the length of the shortest path from the restaurant to that location. Xiao T wants to choose a location that minimizes the distance to the farthest customer.\n\nCustomers are located in $N$ buildings in city C. These $N$ buildings are connected by exactly $N$ bidirectional roads. No two roads connect the same pair of buildings. Between any two buildings, there exists at least one path formed by bidirectional roads. The restaurant can be placed at any building, or at any point on any road (the distances from that point to the two endpoints of the road do not need to be integers).\n\nGiven the map of city C (the road layout and lengths), find the optimal location for the restaurant and output its distance to the farthest customer.", "inputFormat": "The first line contains an integer $N$, representing the number of buildings in city C. There are also exactly $N$ bidirectional roads.\n\nThe next $N$ lines each contain $3$ integers, $A_i,B_i,L_i$ ($1\\leq i\\leq N$, $L_i>0$), indicating that there is a road between buildings $A_i$ and $B_i$ with length $L_i$.", "outputFormat": "Output a single real number, rounded and kept to **exactly one decimal place**, representing the distance from the optimal restaurant location to its farthest customer.\n\nNote: Your result must have exactly one digit after the decimal point. An incorrect number of decimal places will receive no credit.", "hint": "- Sample Explanation 1.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/r0dmxcgy.png)\n\n- Sample Explanation 2.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pf8eaowl.png)\n\n- Constraints:\n  - For $10\\%$ of the testdata, $N\\leq 80$, $L_i=1$.\n  - For $30\\%$ of the testdata, $N\\leq 600$, $L_i\\leq 100$.\n  - For $60\\%$ of the testdata, $N\\leq 2000$, $L_i\\leq 10^9$.\n  - For $100\\%$ of the testdata, $1\\leq N\\leq 10^5$, $1\\leq L_i \\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2013] 快餐店", "background": "", "description": "小 T 打算在城市 C 开设一家外送快餐店。送餐到某一个地点的时间与外卖店到该地点之间最短路径长度是成正比的，小 T 希望快餐店的地址选在离最远的顾客距离最近的地方。\n\n快餐店的顾客分布在城市 C 的 $N$ 个建筑中，这 $N$ 个建筑通过恰好 $N$ 条双向道路连接起来，不存在任何两条道路连接了相同的两个建筑。任意两个建筑之间至少存在一条由双向道路连接而成的路径。小 T 的快餐店可以开设在任一建筑中，也可以开设在任意一条道路的某个位置上（该位置与道路两端的建筑的距离不一定是整数）。\n\n现给定城市 C 的地图（道路分布及其长度），请找出最佳的快餐店选址，输出其与最远的顾客之间的距离。", "inputFormat": "第一行包含一个整数 $N$，表示城市 C 中的建筑和道路数目。\n\n接下来 $N$ 行，每行 $3$ 个整数，$A_i,B_i,L_i$（$1\\leq i\\leq N$，$L_i>0$），表示一条道路连接了建筑 $A_i$ 与 $B_i$，其长度为 $L_i$。\n", "outputFormat": "输出仅包含一个实数，四舍五入保留**恰好一位小数**，表示最佳快餐店选址距离最远用户的距离。\n\n注意：你的结果必须恰好有一位小数，小数位数不正确不得分。", "hint": "### 样例解释 1\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/r0dmxcgy.png)\n\n### 样例解释 2\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pf8eaowl.png)\n\n### 数据范围\n\n- 对于 $10\\%$ 的数据，$N\\leq 80$，$L_i=1$；\n- 对于 $30\\%$ 的数据，$N\\leq 600$，$L_i\\leq 100$；\n- 对于 $60\\%$ 的数据，$N\\leq 2000$，$L_i\\leq 10^9$；\n- 对于 $100\\%$ 的数据，$1\\leq N\\leq 10^5$，$1\\leq L_i \\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P1400", "type": "P", "difficulty": 6, "samples": [["2 8", "1 2 6\n3 10 24\n12 35 88\n15 28 84\n4 5 18\n14 33 90\n40 104 273\n21 60 152"], ["3 3", "1 3 12\n8 21 87\n44 165 615"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2016", "Special Judge", "ICPC", "CERC"], "title": "[CERC2016] Easy Equation", "background": "", "description": "Given an integer $k$ greater than $1$, it is possible to prove that there are infinitely many triples of positive integers $(a, b, c)$ that satisfy the following equation:\n\n$$a^2+b^2+c^2=k(ab+bc+ca)+1$$\n\nGiven positive integers $n$ and $k$, find $n$ arbitrary triples $(a_1, b_1, c_1), (a_2, b_2, c_2), \\cdots , (a_n, b_n, c_n)$ that all\nsatisfy the equation. Furthermore, all $3n$ integers $(a_1, b_1, c_1), (a_2, b_2, c_2), \\cdots , (a_n, b_n, c_n)$ should be different positive integers with at most $100$ decimal digits each.", "inputFormat": "The first line contains two integers $k$ and $n\\;(2 \\leq k \\leq 1000, 1 \\leq n \\leq 1000)$ — the constant k in the\nequation and the target number of triples.", "outputFormat": "Output $n$ lines. The $i$-th line should contain three space separated integers $a_i$, $b_i$ and $c_i$ with at most $100$ digits each — the $i$-th of the solutions you found.", "hint": "", "locale": "en", "translations": {"en": {"title": "[CERC2016] Easy Equation", "background": "", "description": "Given an integer $k$ greater than $1$, it is possible to prove that there are infinitely many triples of positive integers $(a, b, c)$ that satisfy the following equation:\n\n$$a^2+b^2+c^2=k(ab+bc+ca)+1$$\n\nGiven positive integers $n$ and $k$, find $n$ arbitrary triples $(a_1, b_1, c_1), (a_2, b_2, c_2), \\cdots , (a_n, b_n, c_n)$ that all\nsatisfy the equation. Furthermore, all $3n$ integers $(a_1, b_1, c_1), (a_2, b_2, c_2), \\cdots , (a_n, b_n, c_n)$ should be different positive integers with at most $100$ decimal digits each.", "inputFormat": "The first line contains two integers $k$ and $n\\;(2 \\leq k \\leq 1000, 1 \\leq n \\leq 1000)$ — the constant k in the\nequation and the target number of triples.", "outputFormat": "Output $n$ lines. The $i$-th line should contain three space separated integers $a_i$, $b_i$ and $c_i$ with at most $100$ digits each — the $i$-th of the solutions you found.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[CERC2016] Easy Equation", "background": "", "description": "假设 $k$ 大于 $1$，\n可以证明有无穷多个正整数三元组 $(a, b, c)$ 满足以下方程:\n\n   $a^2 + b^2 + c^2 = k(ab + bc + ca) + 1$\n    \n给定正整数 $n$ 和 $k$，找出 $n$ 个三元组 $(a_1, b_1, c_1), (a_2, b_2, c_2), ⋯ ,(a_n, b_n, c_n)$ 使它们都满足方程。另外，这 $3n$ 个正整数 $(a_1, b_1, c_1), (a_2, b_2, c_2), ⋯ ,(a_n, b_n, c_n)$ 应该是不同的，每个数最多有 $100$ 位。", "inputFormat": "第一行包含两个整数：\n方程中的常数 $k$ 和 \n所求三元组的数量 $n$ $(2 ≤ k ≤ 1000, 1 ≤ n ≤ 1000)$;", "outputFormat": "输出有 $n$ 行。第 $i$ 行应该包含三个空格分隔的正整数 $ai$, $bi$ 和 $ci$，\n为你找到的第 $i$ 个解。每个数最多 $100$ 位。", "hint": "", "locale": "zh-CN"}}}
