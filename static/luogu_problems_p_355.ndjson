{"pid": "P8192", "type": "P", "difficulty": 7, "samples": [["2 1\n1 1 3 3\n2 2 4 4 ", "4"], ["5 2\n1 5 3 6\n5 4 7 9\n4 1 8 3\n9 8 10 10\n2 2 6 7", "4 5"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["线段树", "USACO", "2022", "平面图欧拉公式", "扫描线"], "title": "[USACO22FEB]  Paint by Rectangles P", "background": "翻译来自 @wlzhouzhuan。", "description": "在她之前的作品受到好评后，Bessie 得到了一份设计绘画套装的工作。她通过在平面中选择 $N\\ (1\\le N\\le 10^5)$ 个平行于坐标轴的矩形来设计该画作，没有两条边是共线的。这些矩形的边界定义了绘画着色区域的边界。\n\n作为一名先锋艺术家，Bessie 觉得这幅画应该像一头荷斯坦奶牛。更具体地，由矩形构成的每个区域都被着色为黑色或白色，没有两个相邻区域具有相同的颜色，并且所有矩形之外的区域都被着色为白色。\n\n选完矩形后，Bessie 想根据参数 $T$ 让你输出：\n\n- 若 $T=1$，则输出区域总数；\n- 若 $T=2$，则依次输出白色区域数量和黑色区域数量。\n\n**注意：本题的时间限制为 4s，是默认的 2 倍。**", "inputFormat": "第一行，输入 $N$ 和 $T$。\n\n接下来 $N$ 行，每行读入 $x_1,y_1,x_2,y_2$，表示一个左下角为 $(x_1,y_1)$，右上角为 $(x_2,y_2)$ 的矩形。\n\n数据保证 $x_i$ 形成了一个 $1\\sim 2N$ 的排列，$y_i$ 同理。", "outputFormat": "若 $T=1$，输出一个整数；否则输出两个整数，用空格隔开。", "hint": "**【样例解释 #1】**\n\n有 $2$ 个白色区域和 $2$ 个黑色区域，共有 $4$ 个区域。所有矩形的边界连通，因此该输入满足 subtask 3。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/v34kpbhi.png)\n\n**【样例解释 #2】**\n\n右上方的矩形不与其余的矩形连通，因此该输入不满足 subtask 4。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/boqnrha0.png)\n\n**【数据范围】**\n\n- subtask 1：数据 $3\\sim 4$ 满足 $N\\le 10^3$；\n- subtask 2：数据 $5\\sim 7$ 满足不存在两个矩形相交；\n- subtask 3：数据 $8\\sim 10$ 满足 $T=1$，且所有矩形的边界连通；\n- subtask 4：数据 $11\\sim 13$ 满足 $T=2$，且所有矩形的边界连通；\n- subtask 5：数据 $14\\sim 18$ 满足 $T=1$；\n- subtask 6：数据 $19\\sim 23$ 满足 $T=2$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO22FEB]  Paint by Rectangles P", "background": "翻译来自 @wlzhouzhuan。", "description": "在她之前的作品受到好评后，Bessie 得到了一份设计绘画套装的工作。她通过在平面中选择 $N\\ (1\\le N\\le 10^5)$ 个平行于坐标轴的矩形来设计该画作，没有两条边是共线的。这些矩形的边界定义了绘画着色区域的边界。\n\n作为一名先锋艺术家，Bessie 觉得这幅画应该像一头荷斯坦奶牛。更具体地，由矩形构成的每个区域都被着色为黑色或白色，没有两个相邻区域具有相同的颜色，并且所有矩形之外的区域都被着色为白色。\n\n选完矩形后，Bessie 想根据参数 $T$ 让你输出：\n\n- 若 $T=1$，则输出区域总数；\n- 若 $T=2$，则依次输出白色区域数量和黑色区域数量。\n\n**注意：本题的时间限制为 4s，是默认的 2 倍。**", "inputFormat": "第一行，输入 $N$ 和 $T$。\n\n接下来 $N$ 行，每行读入 $x_1,y_1,x_2,y_2$，表示一个左下角为 $(x_1,y_1)$，右上角为 $(x_2,y_2)$ 的矩形。\n\n数据保证 $x_i$ 形成了一个 $1\\sim 2N$ 的排列，$y_i$ 同理。", "outputFormat": "若 $T=1$，输出一个整数；否则输出两个整数，用空格隔开。", "hint": "**【样例解释 #1】**\n\n有 $2$ 个白色区域和 $2$ 个黑色区域，共有 $4$ 个区域。所有矩形的边界连通，因此该输入满足 subtask 3。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/v34kpbhi.png)\n\n**【样例解释 #2】**\n\n右上方的矩形不与其余的矩形连通，因此该输入不满足 subtask 4。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/boqnrha0.png)\n\n**【数据范围】**\n\n- subtask 1：数据 $3\\sim 4$ 满足 $N\\le 10^3$；\n- subtask 2：数据 $5\\sim 7$ 满足不存在两个矩形相交；\n- subtask 3：数据 $8\\sim 10$ 满足 $T=1$，且所有矩形的边界连通；\n- subtask 4：数据 $11\\sim 13$ 满足 $T=2$，且所有矩形的边界连通；\n- subtask 5：数据 $14\\sim 18$ 满足 $T=1$；\n- subtask 6：数据 $19\\sim 23$ 满足 $T=2$。", "locale": "zh-CN"}}}
{"pid": "P8193", "type": "P", "difficulty": 6, "samples": [["6\n1 2 3 1 1 4\n7\n1\n2\n3\n4\n5\n6\n12", "6\n6\n4\n5\n-1\n4\n5"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["贪心", "USACO", "2022", "数论", "素数判断,质数,筛法", "前缀和"], "title": "[USACO22FEB] Sleeping in Class P", "background": null, "description": "最近终于线下授课了，奶牛 Bessie 十分兴奋！不幸的是，Farmer John 是一个非常无聊的讲师，因此她经常课堂上睡觉。\n\nFarmer John 注意到了 Bessie 上课走神。他要求班上的另一个学生 Elsie 跟踪记录给定课上 Bessie 睡觉的次数。一共有 $N$ 堂课，Elsie 记录下了 Bessie 在第 $i$ 堂课睡了 $a_i$ 次。所有课上 Bessie 一共睡觉的次数最多为 $10^{18}$。\n\nElsie 认为自己是 Bessie 的竞争对手，所以她想让 FJ 觉得在每堂课上 Bessie 都一直睡了同样多次——让 FJ 觉得这个问题显然完全是 Bessie 的错，而不是 FJ 有时上课很无聊的问题。\n\nElsie 修改记录只有以下两种方式：把相邻的两堂课的记录合起来，或者把一堂课的记录分成两堂课。例如，如果 $a=[1,2,3,4,5]$，那么如果 Elsie 将第二堂和第三堂课的记录合起来，记录就会变为 $[1,5,4,5]$。如果 Elsie 继续选择让第三堂课的记录分为两堂，记录就可能变为 $[1,5,0,4,5],[1,5,1,3,5],[1,5,2,2,5],[1,5,3,1,5]$ 或 $[1,5,4,0,5]$。\n\n给定 $Q$ 个候选的 Bessie 最不喜欢的数字 $q_1,\\ldots,q_Q$，对于每个数字，请帮助 Elsie 计算她至少要操作多少次，才能让记录里的所有数字都变成这个数字。", "inputFormat": "第一行一个整数 $N$（$1\\le N\\le 10^5$）。\n\n第二行 $N$ 个整数 $a_1,a_2,\\ldots, a_N$（$1\\le a_i\\le 10^{18}$）。\n\n第三行一个整数 $Q$（$1\\le Q\\le 10^5$）。\n\n接下来 $Q$ 行，每行一个整数 $q_i$（$1\\le q_i\\le 10^{18}$），表示 Bessie 最不喜欢的数字。", "outputFormat": "对于每个 $q_i$，计算 Elsie 把记录里的每个数都变成 $q_i$ 所需要的最小操作次数。如果不能把所有数都变成 $q_i$，输出 $-1$。", "hint": "**【样例解释】**\n\nElsie 需要至少 $4$ 次修改才能让记录里的所有数都变成 $3$。\n\n$$\n\\begin{aligned}\n&\\ 1\\ 2\\ 3\\ 1\\ 1\\ 4\\\\\n\\rightarrow&\\ 3\\ 3\\ 1\\ 1\\ 4\\\\\n\\rightarrow&\\ 3\\ 3\\ 1\\ 5\\\\\n\\rightarrow&\\ 3\\ 3\\ 6\\\\\n\\rightarrow&\\ 3\\ 3\\ 3\\ 3\\\\\n\\end{aligned}\n$$\n\nElsie 不可能把记录中的所有数都变成 $5$，因此输出 $-1$。这是正确的。\n\n**【数据范围】**\n\n- 对于第 $2\\sim 4$ 组数据，$N,Q\\le 5000$。\n- 对于第 $5\\sim 7$ 组数据，所有 $a_i$ 最多为 $10^9$。\n- 对于第 $8\\sim 26$ 组数据，无附加限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO22FEB] Sleeping in Class P", "background": null, "description": "最近终于线下授课了，奶牛 Bessie 十分兴奋！不幸的是，Farmer John 是一个非常无聊的讲师，因此她经常课堂上睡觉。\n\nFarmer John 注意到了 Bessie 上课走神。他要求班上的另一个学生 Elsie 跟踪记录给定课上 Bessie 睡觉的次数。一共有 $N$ 堂课，Elsie 记录下了 Bessie 在第 $i$ 堂课睡了 $a_i$ 次。所有课上 Bessie 一共睡觉的次数最多为 $10^{18}$。\n\nElsie 认为自己是 Bessie 的竞争对手，所以她想让 FJ 觉得在每堂课上 Bessie 都一直睡了同样多次——让 FJ 觉得这个问题显然完全是 Bessie 的错，而不是 FJ 有时上课很无聊的问题。\n\nElsie 修改记录只有以下两种方式：把相邻的两堂课的记录合起来，或者把一堂课的记录分成两堂课。例如，如果 $a=[1,2,3,4,5]$，那么如果 Elsie 将第二堂和第三堂课的记录合起来，记录就会变为 $[1,5,4,5]$。如果 Elsie 继续选择让第三堂课的记录分为两堂，记录就可能变为 $[1,5,0,4,5],[1,5,1,3,5],[1,5,2,2,5],[1,5,3,1,5]$ 或 $[1,5,4,0,5]$。\n\n给定 $Q$ 个候选的 Bessie 最不喜欢的数字 $q_1,\\ldots,q_Q$，对于每个数字，请帮助 Elsie 计算她至少要操作多少次，才能让记录里的所有数字都变成这个数字。", "inputFormat": "第一行一个整数 $N$（$1\\le N\\le 10^5$）。\n\n第二行 $N$ 个整数 $a_1,a_2,\\ldots, a_N$（$1\\le a_i\\le 10^{18}$）。\n\n第三行一个整数 $Q$（$1\\le Q\\le 10^5$）。\n\n接下来 $Q$ 行，每行一个整数 $q_i$（$1\\le q_i\\le 10^{18}$），表示 Bessie 最不喜欢的数字。", "outputFormat": "对于每个 $q_i$，计算 Elsie 把记录里的每个数都变成 $q_i$ 所需要的最小操作次数。如果不能把所有数都变成 $q_i$，输出 $-1$。", "hint": "**【样例解释】**\n\nElsie 需要至少 $4$ 次修改才能让记录里的所有数都变成 $3$。\n\n$$\n\\begin{aligned}\n&\\ 1\\ 2\\ 3\\ 1\\ 1\\ 4\\\\\n\\rightarrow&\\ 3\\ 3\\ 1\\ 1\\ 4\\\\\n\\rightarrow&\\ 3\\ 3\\ 1\\ 5\\\\\n\\rightarrow&\\ 3\\ 3\\ 6\\\\\n\\rightarrow&\\ 3\\ 3\\ 3\\ 3\\\\\n\\end{aligned}\n$$\n\nElsie 不可能把记录中的所有数都变成 $5$，因此输出 $-1$。这是正确的。\n\n**【数据范围】**\n\n- 对于第 $2\\sim 4$ 组数据，$N,Q\\le 5000$。\n- 对于第 $5\\sim 7$ 组数据，所有 $a_i$ 最多为 $10^9$。\n- 对于第 $8\\sim 26$ 组数据，无附加限制。", "locale": "zh-CN"}}}
{"pid": "P8194", "type": "P", "difficulty": 7, "samples": [["5\n1478\n4455\n5968\n31313211\n123659874", "5\n2\n24\n3\n255"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "USACO", "2022", "动态规划优化", "状态合并"], "title": "[USACO22FEB] Phone Numbers P", "background": "", "description": "Bessie 获得了一个九键的新手机，键位如下所示：\n\n```\n123\n456\n789\n```\n\nBessie 正在匆忙中尝试打出一个给定的电话号码，所以她决定通过用她的其中一个蹄子一次按下多个按钮的方式来节省时间。具体来说，Bessie 的蹄子可能按下一个键，两个共用一条边的键（总共有 $12$ 种可能），或者形成一个正方形的四个键（$1245$，$2356$，$4578$，$5689$）\n\n例如，如果 Bessie 要打的电话号码是 $123659874$，她可能通过如下方法按键来尝试节省时间：\n\n1. 同时按下 $1$ 和 $2$。\n2. 按下 $3$。\n3. 同时按下 $6,5,9,8$。\n4. 同时按下 $7$ 和 $4$。\n\n不幸的是，Bessie 大大高估了她执行这项任务的技能——如果 Bessie 的蹄子同时按下多个按键，那么所有这些按键会以任意顺序输入。所以如果 Bessie 尝试按上述按键顺序，结束时她输入的电话号码可能是 $123596847$ 或 $213659874$（或者其他可能的序列）。\n\n给定一个 Bessie 已经输入的序列，请计算她可能想输入的电话号码的数量对 $10^9+7$ 取模后的值。", "inputFormat": "第一行一个整数 $T$（$1\\le T\\le 10$），表示要求解的独立测试数据组数。\n\n接下来 $T$ 行，每行一个非空且只包含 $1$ 到 $9$ 的数字串。保证输入中所有的数字串总长度不超过 $10^5$。", "outputFormat": "对于每组数据，输出 Bessie 可能想输入的电话号码个数对 $10^9+7$ 取模后的值。", "hint": "**【样例解释】**\n\n对于第一组数据。Bessie 可能想输入如下五个电话号码之一：\n\n```plain\n1478\n1487\n4178\n4187\n1748\n```\n\n例如，如果 Bessie 想输入 $4187$，她可能会尝试同时按下 $1$ 和 $4$，然后同时按下 $7$ 和 $8$。\n\n对于第三组数据，因为这些数字组成了一个正方形，Bessie 可能想输入的电话是输入序列的任何排列。\n\n**【数据范围】**\n\n- 对于第 $2\\sim 3$ 组数据，所有电话号码的长度最多为 $8$。\n- 对于第 $4\\sim 5$ 组数据，电话号码只包含 $1,2$ 和 $3$。\n- 对于第 $6\\sim 7$ 组数据，电话号码不包含 $5$。\n- 对于第 $8\\sim 9$ 组数据，电话号码只包含 $5,6,8,9$。\n- 对于第 $10\\sim 12$ 组数据，电话号码总长度不超过 $10^2$。\n- 对于第 $13\\sim 15$ 组数据，电话号码总长度不超过 $10^3$。\n- 对于第 $16\\sim 18$ 组数据，电话号码总长度不超过 $10^4$。\n- 对于第 $19\\sim 21$ 组数据，无附加限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO22FEB] Phone Numbers P", "background": "", "description": "Bessie 获得了一个九键的新手机，键位如下所示：\n\n```\n123\n456\n789\n```\n\nBessie 正在匆忙中尝试打出一个给定的电话号码，所以她决定通过用她的其中一个蹄子一次按下多个按钮的方式来节省时间。具体来说，Bessie 的蹄子可能按下一个键，两个共用一条边的键（总共有 $12$ 种可能），或者形成一个正方形的四个键（$1245$，$2356$，$4578$，$5689$）\n\n例如，如果 Bessie 要打的电话号码是 $123659874$，她可能通过如下方法按键来尝试节省时间：\n\n1. 同时按下 $1$ 和 $2$。\n2. 按下 $3$。\n3. 同时按下 $6,5,9,8$。\n4. 同时按下 $7$ 和 $4$。\n\n不幸的是，Bessie 大大高估了她执行这项任务的技能——如果 Bessie 的蹄子同时按下多个按键，那么所有这些按键会以任意顺序输入。所以如果 Bessie 尝试按上述按键顺序，结束时她输入的电话号码可能是 $123596847$ 或 $213659874$（或者其他可能的序列）。\n\n给定一个 Bessie 已经输入的序列，请计算她可能想输入的电话号码的数量对 $10^9+7$ 取模后的值。", "inputFormat": "第一行一个整数 $T$（$1\\le T\\le 10$），表示要求解的独立测试数据组数。\n\n接下来 $T$ 行，每行一个非空且只包含 $1$ 到 $9$ 的数字串。保证输入中所有的数字串总长度不超过 $10^5$。", "outputFormat": "对于每组数据，输出 Bessie 可能想输入的电话号码个数对 $10^9+7$ 取模后的值。", "hint": "**【样例解释】**\n\n对于第一组数据。Bessie 可能想输入如下五个电话号码之一：\n\n```plain\n1478\n1487\n4178\n4187\n1748\n```\n\n例如，如果 Bessie 想输入 $4187$，她可能会尝试同时按下 $1$ 和 $4$，然后同时按下 $7$ 和 $8$。\n\n对于第三组数据，因为这些数字组成了一个正方形，Bessie 可能想输入的电话是输入序列的任何排列。\n\n**【数据范围】**\n\n- 对于第 $2\\sim 3$ 组数据，所有电话号码的长度最多为 $8$。\n- 对于第 $4\\sim 5$ 组数据，电话号码只包含 $1,2$ 和 $3$。\n- 对于第 $6\\sim 7$ 组数据，电话号码不包含 $5$。\n- 对于第 $8\\sim 9$ 组数据，电话号码只包含 $5,6,8,9$。\n- 对于第 $10\\sim 12$ 组数据，电话号码总长度不超过 $10^2$。\n- 对于第 $13\\sim 15$ 组数据，电话号码总长度不超过 $10^3$。\n- 对于第 $16\\sim 18$ 组数据，电话号码总长度不超过 $10^4$。\n- 对于第 $19\\sim 21$ 组数据，无附加限制。", "locale": "zh-CN"}}}
{"pid": "P8195", "type": "P", "difficulty": 1, "samples": [["welcometochuanzhicupchuanzhi", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["模拟", "O2优化", "传智杯"], "title": "[传智杯 #4 决赛] 小智的疑惑", "background": "", "description": "传智专修学院给了小智一个仅包含小写字母的字符串 $s$，他想知道，里面出现了多少次子串 `chuanzhi` 呢。\n\n我们称一个字符串 $t$ 是 $s$ 的子串，当且仅当将 $s$ 的开头若干个（可以为 0 个）连续字符和结尾若干个（可以为 0 个）连续字符删去后，剩下的字符串和 $t$ 相同。例如，我们称 `ab` 是 `abc` 的子串，但 `ac` 不是 `abc` 的子串。", "inputFormat": "输入只有一行一个字符串，表示字符串 $s$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "### 数据规模与约定\n\n对于全部的测试点，保证 $1 \\leq |s| \\leq 4 \\times 10^5$，$|s|$ 表示 $s$ 的长度，且 $s$ 中只有小写字母。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[传智杯 #4 决赛] 小智的疑惑", "background": "", "description": "传智专修学院给了小智一个仅包含小写字母的字符串 $s$，他想知道，里面出现了多少次子串 `chuanzhi` 呢。\n\n我们称一个字符串 $t$ 是 $s$ 的子串，当且仅当将 $s$ 的开头若干个（可以为 0 个）连续字符和结尾若干个（可以为 0 个）连续字符删去后，剩下的字符串和 $t$ 相同。例如，我们称 `ab` 是 `abc` 的子串，但 `ac` 不是 `abc` 的子串。", "inputFormat": "输入只有一行一个字符串，表示字符串 $s$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "### 数据规模与约定\n\n对于全部的测试点，保证 $1 \\leq |s| \\leq 4 \\times 10^5$，$|s|$ 表示 $s$ 的长度，且 $s$ 中只有小写字母。", "locale": "zh-CN"}}}
{"pid": "P8196", "type": "P", "difficulty": 1, "samples": [["2\n3\n1 2 3\n5\n1 2 3 4 5\n", "2\n6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["模拟", "O2优化", "传智杯"], "title": "[传智杯 #4 决赛] 三元组", "background": "", "description": "给定一个长度为 $n$ 的数列 $a$，对于一个有序整数三元组 $(i, j, k)$，若其满足 $1 \\leq i \\leq j \\leq k \\leq n$ 并且 $a_i +a_j  = a_k$，则我们称这个三元组是「传智的」。\n\n现在请你计算，有多少有序整数三元组是传智的。", "inputFormat": "**本题单测试点内有多组测试数据**。\n\n输入的第一行是一个整数 $T$，表示数据组数。\n\n对于每组数据：\n\n第一行是一个整数，表示数列的长度 $n$。  \n第二行有 $n$ 个整数，第 $i$ 个整数表示 $a_i$。", "outputFormat": "对于每组数据，输出一行一个整数表示答案。", "hint": "### 样例 1 解释\n\n对于第一组数据，因为 $a_1 + a_1 = a_2$，$a_1 + a_2 = a_3$，故共 $(1, 1, 2)$ 和 $(1, 2, 3)$ 两个三元组。  \n对于第二组数据六个三元组分别是：\n- $(1, 1, 2)$\n- $(1, 2, 3)$\n- $(1, 3, 4)$\n- $(1, 4, 5)$\n- $(2, 2, 4)$\n- $(2, 3, 5)$\n\n### 数据规模与约定\n\n对于全部测试点，保证 $1 \\leq T \\leq 100$，$1 \\leq n , a_i \\leq 100$，且各个测试点的 $n$ 之和不超过 $100$，即 $\\sum n \\leq 100$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[传智杯 #4 决赛] 三元组", "background": "", "description": "给定一个长度为 $n$ 的数列 $a$，对于一个有序整数三元组 $(i, j, k)$，若其满足 $1 \\leq i \\leq j \\leq k \\leq n$ 并且 $a_i +a_j  = a_k$，则我们称这个三元组是「传智的」。\n\n现在请你计算，有多少有序整数三元组是传智的。", "inputFormat": "**本题单测试点内有多组测试数据**。\n\n输入的第一行是一个整数 $T$，表示数据组数。\n\n对于每组数据：\n\n第一行是一个整数，表示数列的长度 $n$。  \n第二行有 $n$ 个整数，第 $i$ 个整数表示 $a_i$。", "outputFormat": "对于每组数据，输出一行一个整数表示答案。", "hint": "### 样例 1 解释\n\n对于第一组数据，因为 $a_1 + a_1 = a_2$，$a_1 + a_2 = a_3$，故共 $(1, 1, 2)$ 和 $(1, 2, 3)$ 两个三元组。  \n对于第二组数据六个三元组分别是：\n- $(1, 1, 2)$\n- $(1, 2, 3)$\n- $(1, 3, 4)$\n- $(1, 4, 5)$\n- $(2, 2, 4)$\n- $(2, 3, 5)$\n\n### 数据规模与约定\n\n对于全部测试点，保证 $1 \\leq T \\leq 100$，$1 \\leq n , a_i \\leq 100$，且各个测试点的 $n$ 之和不超过 $100$，即 $\\sum n \\leq 100$。", "locale": "zh-CN"}}}
{"pid": "P8197", "type": "P", "difficulty": 3, "samples": [["3\n4\n1 2 2 3\n3 2 2 1\n3\n1 2 3\n1 2 4\n1\n1\n1\n", "YES\n4 3\n2 3\n1 2\n3 2\n3 4\n0 0\nNO\nYES\n0 0\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["Special Judge", "O2优化", "排序", "构造", "传智杯"], "title": "[传智杯 #4 决赛] 排排队", "background": "", "description": "\ncyq 在 tsyz 担任了体育老师，负责排队一事。\n\n在 tsyz 中，每个人都有一个身高 $a_{i}$，并且只有**相邻**的两个人可以交换位置。cyq 带领的队伍有 $n$ 个人,他现在要给大家排队形。\n\n给定一个长度为 $n$ 的序列 $b$，一个队形被认为美观，当且仅当对于所有的 $i = 1, 2, 3, \\dots n$，$a_{i} =b_{i}$。cyq 想知道，他能否让大家的队形变得美观，并且交换相邻两个人的次数不超过 $n^2$ 次。这个问题把 $cyq$ 难住了，请你帮他来解决这个问题，如果存在合法的交换方案，输出 `YES`，并给出一组方案；否则，输出 `NO`。", "inputFormat": "**本题单测试点内有多组测试数据**。\n\n第一行是一个整数 $T$，表示数据组数，对于每组数据：  \n第一行是一个整数，表示队伍的长度 $n$。  \n第二行有 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个人的身高 $a_i$。  \n第三行有 $n$ 个整数，第 $i$ 个整数表示美观队形里第 $i$ 个人的身高 $b_i$。", "outputFormat": "对每组数据依次分别输出答案。\n\n对于每组数据，若存在一种方案，则在第一行输出一个 `YES`，否则输出一个 `NO`。\n\n如果输出 `YES`，下面则输出若干行每行两个整数 $i,j$，表示第 $i$ 个同学和第 $j$ 个同学交换位置，显然 $|i-j|=1$。在交换完成后，你还需要输出一行 `0 0` 表示你的操作结束了，请注意数组的下标从 1 开始编号至 $n$。\n\n如果输出 `NO`，则接下来什么都不需要输出。\n\n**请特别注意，对于每组数据，你的操作次数不能超过 $n^2$（不包括 `0 0` 一行），否则将得到 WA(Wrong Answer) 的结果**。", "hint": "### 数据规模与约定\n\n对于全部的测试点，保证 $1\\leq T \\leq 10$，$1\\leq n \\leq 10^3$，$1\\leq a_{i},b_{i}\\leq 10^9$，且各个测试点 $n$ 之和不超过 $1000$，即 $\\sum n\\leq 10^3$。\n\n### 提示\n- 请注意大量的输出输出对程序效率造成的影响，不要频繁刷新缓冲区。例如，对于使用 `std::cout` 的 C++ 选手，请使用 `'\\n'` 而不是 `std::endl` 来换行；对于 java 选手，请选择高效率的输出方式，如使用 PrintWriter；python 选手可以正常的使用 print 而无需考虑效率问题。\n- 请按照输出格式的要求输出您的答案，如果格式不符合要求，返回的评测信息将可能是 TLE、RE、WA、UKE 等任何结果。\n\n### C++ 语言的高效输出样例\n```cpp\n#include <iostream>\nint main() {\n  std::ios::sync_with_stdio(false);\n  std::cin.tie(0);\n  for (int i = 1; i <= 5; ++i) {\n    std::cout << i << '\\n'; // 注意这里不能使用 std::endl\n  }\n}\n```\n\n### Java 语言的高效输出样例\n```java\nimport java.io.PrintWriter;\n\npublic class Main {\n  public static void main(String[] args) {\n    PrintWriter ot = new PrintWriter(System.out);\n    for (int i = 1; i <= 5; ++i) {\n      ot.println(i);\n    }\n    ot.flush(); // 请务必保证在程序结束时运行本条语句，否则在缓冲区的内容无法输出\n  }\n}", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[传智杯 #4 决赛] 排排队", "background": "", "description": "\ncyq 在 tsyz 担任了体育老师，负责排队一事。\n\n在 tsyz 中，每个人都有一个身高 $a_{i}$，并且只有**相邻**的两个人可以交换位置。cyq 带领的队伍有 $n$ 个人,他现在要给大家排队形。\n\n给定一个长度为 $n$ 的序列 $b$，一个队形被认为美观，当且仅当对于所有的 $i = 1, 2, 3, \\dots n$，$a_{i} =b_{i}$。cyq 想知道，他能否让大家的队形变得美观，并且交换相邻两个人的次数不超过 $n^2$ 次。这个问题把 $cyq$ 难住了，请你帮他来解决这个问题，如果存在合法的交换方案，输出 `YES`，并给出一组方案；否则，输出 `NO`。", "inputFormat": "**本题单测试点内有多组测试数据**。\n\n第一行是一个整数 $T$，表示数据组数，对于每组数据：  \n第一行是一个整数，表示队伍的长度 $n$。  \n第二行有 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个人的身高 $a_i$。  \n第三行有 $n$ 个整数，第 $i$ 个整数表示美观队形里第 $i$ 个人的身高 $b_i$。", "outputFormat": "对每组数据依次分别输出答案。\n\n对于每组数据，若存在一种方案，则在第一行输出一个 `YES`，否则输出一个 `NO`。\n\n如果输出 `YES`，下面则输出若干行每行两个整数 $i,j$，表示第 $i$ 个同学和第 $j$ 个同学交换位置，显然 $|i-j|=1$。在交换完成后，你还需要输出一行 `0 0` 表示你的操作结束了，请注意数组的下标从 1 开始编号至 $n$。\n\n如果输出 `NO`，则接下来什么都不需要输出。\n\n**请特别注意，对于每组数据，你的操作次数不能超过 $n^2$（不包括 `0 0` 一行），否则将得到 WA(Wrong Answer) 的结果**。", "hint": "### 数据规模与约定\n\n对于全部的测试点，保证 $1\\leq T \\leq 10$，$1\\leq n \\leq 10^3$，$1\\leq a_{i},b_{i}\\leq 10^9$，且各个测试点 $n$ 之和不超过 $1000$，即 $\\sum n\\leq 10^3$。\n\n### 提示\n- 请注意大量的输出输出对程序效率造成的影响，不要频繁刷新缓冲区。例如，对于使用 `std::cout` 的 C++ 选手，请使用 `'\\n'` 而不是 `std::endl` 来换行；对于 java 选手，请选择高效率的输出方式，如使用 PrintWriter；python 选手可以正常的使用 print 而无需考虑效率问题。\n- 请按照输出格式的要求输出您的答案，如果格式不符合要求，返回的评测信息将可能是 TLE、RE、WA、UKE 等任何结果。\n\n### C++ 语言的高效输出样例\n```cpp\n#include <iostream>\nint main() {\n  std::ios::sync_with_stdio(false);\n  std::cin.tie(0);\n  for (int i = 1; i <= 5; ++i) {\n    std::cout << i << '\\n'; // 注意这里不能使用 std::endl\n  }\n}\n```\n\n### Java 语言的高效输出样例\n```java\nimport java.io.PrintWriter;\n\npublic class Main {\n  public static void main(String[] args) {\n    PrintWriter ot = new PrintWriter(System.out);\n    for (int i = 1; i <= 5; ++i) {\n      ot.println(i);\n    }\n    ot.flush(); // 请务必保证在程序结束时运行本条语句，否则在缓冲区的内容无法输出\n  }\n}", "locale": "zh-CN"}}}
{"pid": "P8199", "type": "P", "difficulty": 4, "samples": [["3 3 60 8\n1 1\n14 300\n15 30\n5 1\n10 1\n17 11 10\n17 10 10\n17 10 10\n15 10\n4\n4\n2\n3\n3\n2\n4\n4\n", "1\n0\n14 254\n10 1\n15 12\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["模拟", "O2优化", "传智杯"], "title": "[传智杯 #4 决赛] 游戏", "background": "小智正在看 B 站非著名 up 主脚踢喷火幼儿园（下称喷火）和他的朋友 ATA_Radio_STN 和 sltheen 正在游玩著名游戏《PLAYERUNKNOWN’S BATTLEGROUNDS》（绝地求生：大逃杀）。", "description": "喷火刚刚跳伞落地，周围危机四伏，他的手中有一个初始背包，他捡到的所有物资都会装在这个背包里，游戏地图被简化为一个 $n \\times m$ 的网格图，每个格子里要么是物资，要么是敌人。\n\n物资分为主/副武器和弹药，其中弹药又分为子弹与投掷物。每种武器会对应使用某种子弹。例如：Beryl M762 突击步枪使用 7.62mm 子弹，M416 突击步枪使用 5.56mm 子弹，而 AKM 突击步枪也使用 7.62mm 子弹。\n\n当喷火走到一个含有物资的格子的时候，他会拾起地上的物资并放入背包。但背包容量有限，因此当背包装满的时候，他将会扔掉一部分物资以装下新的物资。他将按照以下规则丢弃物资：\n1.\t如果捡到的是武器，那么按照霰弹枪>突击步枪>射手步枪>栓动步枪>空手的优先级进行替换。优先替换主武器，且主武器优先级必须严格高于副武器。如果替换主武器，那么替换下来的主武器被**直接丢弃**，不再用其替换副武器。\n2.\t若有不需要的子弹（指主副武器均不使用的子弹），最优先丢掉这些子弹，直至空间足够装下新的物资。\n3.\t若丢掉全部不需要子弹后空间仍旧不足，或有多种不需要的子弹，优先丢掉最晚拾取时间最早的弹药（包括主副武器使用的子弹和投掷物），直至空间足够装下新的物资（需要注意的是，即使新物资是「不需要的子弹」，在丢掉所有原有的「不需要的子弹」后如果背包空间还是不够，则喷火依然会丢掉其他弹药直到捡起所有「不需要的子弹」）。\n4.\t无论捡到的是新物资，还是已经有的物资，该物资的最晚拾取时间都将被更新为当前时间点。\n5.\t武器最多同时持有两种，即主/副武器，同优先级的主/副武器不进行替换。\n\n每个格子的物资只会拾取一次。当第二次进入某个格子的时候，物品不会刷新，即不会捡起上次在这个格子丢掉的物品，也不会再次捡到初始时的物品。\n\n当喷火走到含有敌人的格子的时候，他会与敌人进行战斗，他的战斗力很强悍，只需要有足够的子弹即可消灭敌人。每个敌人有两个参数 $a,b$，代表需要消耗 $a$ 发主武器子弹，若主武器子弹不够，则不消耗主武器子弹，而消耗 $b$ 发副武器子弹。若主副武器均没有足够子弹，则喷火被敌人反杀，然后敌人会在喷火的盒子上做蹲起嘲讽他。\n\n每个格子的敌人只会出现一次。如果第二次进入某一个有敌人的格子，则什么都不会发生。\n\n现在，喷火跳在了第一行第一列的格子上，ATA_Radio_STN 已经为喷火摸清了地图形势，而 sltheen 会给喷火下指示，喷火想知道，当他执行完最后一条指示之后，他是否还存活，若存活，按照最晚拾取时间时间从早到晚，输出背包内物品种类和数量，若死亡，输出他死亡格子的坐标。\n\n下附可能出现的物资、物资类别、物资使用的子弹种类、物资所需空间以及物资对应编号。\n\n武器：\n| 武器名称 | 武器类型| 使用的子弹类型 | 编号 |\n| --- | --- | ---  | ---|\n| 空手 | 空手 | N/A | 0|\n|BerylM762|突击步枪|7.62mm子弹|1|\n|AKM|突击步枪|7.62mm子弹|2|\n|SKS|射手步枪|7.62mm子弹|3|\n|Kar98K|栓动步枪|7.62mm子弹|4|\n|M416|突击步枪|5.56mm子弹|5|\n|MK12|射手步枪|5.56mm子弹|6|\n|Mini14|射手步枪|5.56mm子弹|7|\n|S686|霰弹枪|12号霰弹|8|\n|DBS|霰弹枪|12号霰弹|9|\n\n弹药\n|弹药名称| 类型 | 占用空间 | 编号 |\n| - | - | - | - |\n|FragGrenade|投掷物| 5  |   10|\n|SmokeGrenade| 投掷物 |    4|    11|\n|MolotovCocktail |投掷物  | 3 |    12|\n|Flashbang |投掷物        | 2    | 13|\n|7.62mm |子弹 |0.2|                14|\n|5.56mm| 子弹| 0.1                |15|\n|3in（12号霰弹）| 子弹| 0.5|                     16|\n\n请注意，上表中子弹的「占用空间」表示一发子弹所占用的空间。\n\n另外，敌人在地图上的编号为 17。\n\n", "inputFormat": "第一行有四个整数，依次表示地图行数 $n$，列数 $m$，背包容量 $k$，和 sltheen 会下达的指令条数 $t$。  \n接下来的 $n\\times m$ 行中，第 $i$ 行代表第 $\\lfloor\\frac{i - 1}{n}\\rfloor+1$ 行，第 $(i - 1)\\%n+1$ 列的地图情况，其中 $i \\% n$ 表示 $i$ 除以 $n$ 的余数：\n- 此处若是物资，则本行有两个空格隔开的整数，为物资编号 $x$ 和物资数量 $y$，物资编号见「题目描述」中表格的最后一列（如果该物资是枪，则保证 $y = 1$）；\n- 若此处是敌人，则本行有三个空格隔开的整数，第一个整数为 $17$，代表敌人，接下来两个整数依次表示敌人的 $a, b$ 两个参数。\n\n接下来 $t$ 行，每行一个整数 $op$，表示 sltheen 为喷火下达的指令的移动方向：1 代表向上，2 代表向下，3 代表向左，4 代表向右。（第一行第一列是地图的左上角，最后一行第一列是地图的左下角）\n", "outputFormat": "如果喷火死亡，则输出两个数 $u, v$，代表喷火在第 $u$ 行第 $v$ 列死亡。\n\n若喷火未死亡，先输出两行，第一行为主武器编号，第二行为副武器编号，之后输出若干行，每行为两个整数整数，中间用空格隔开，第一个整数为物资名称，第二个整数为其数量，按照最后捡到时间从早到晚排序。", "hint": "### 数据规模与约定\n\n对于全部的测试点，保证：\n- $1 \\leq n, m \\leq 100$，且 $1 \\leq  n \\times m \\leq 100$。\n- $1 \\leq k \\leq 500$，$1 \\leq t,a,b  \\leq 200$。\n- $1 \\leq x \\leq 16$，$1 \\leq y \\leq 5000$。\n- $1 \\leq op \\leq 4$。\n- 数据保证每个格子内只有一种物资（或一个敌人），且背包能够装下任意一格的物资。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[传智杯 #4 决赛] 游戏", "background": "小智正在看 B 站非著名 up 主脚踢喷火幼儿园（下称喷火）和他的朋友 ATA_Radio_STN 和 sltheen 正在游玩著名游戏《PLAYERUNKNOWN’S BATTLEGROUNDS》（绝地求生：大逃杀）。", "description": "喷火刚刚跳伞落地，周围危机四伏，他的手中有一个初始背包，他捡到的所有物资都会装在这个背包里，游戏地图被简化为一个 $n \\times m$ 的网格图，每个格子里要么是物资，要么是敌人。\n\n物资分为主/副武器和弹药，其中弹药又分为子弹与投掷物。每种武器会对应使用某种子弹。例如：Beryl M762 突击步枪使用 7.62mm 子弹，M416 突击步枪使用 5.56mm 子弹，而 AKM 突击步枪也使用 7.62mm 子弹。\n\n当喷火走到一个含有物资的格子的时候，他会拾起地上的物资并放入背包。但背包容量有限，因此当背包装满的时候，他将会扔掉一部分物资以装下新的物资。他将按照以下规则丢弃物资：\n1.\t如果捡到的是武器，那么按照霰弹枪>突击步枪>射手步枪>栓动步枪>空手的优先级进行替换。优先替换主武器，且主武器优先级必须严格高于副武器。如果替换主武器，那么替换下来的主武器被**直接丢弃**，不再用其替换副武器。\n2.\t若有不需要的子弹（指主副武器均不使用的子弹），最优先丢掉这些子弹，直至空间足够装下新的物资。\n3.\t若丢掉全部不需要子弹后空间仍旧不足，或有多种不需要的子弹，优先丢掉最晚拾取时间最早的弹药（包括主副武器使用的子弹和投掷物），直至空间足够装下新的物资（需要注意的是，即使新物资是「不需要的子弹」，在丢掉所有原有的「不需要的子弹」后如果背包空间还是不够，则喷火依然会丢掉其他弹药直到捡起所有「不需要的子弹」）。\n4.\t无论捡到的是新物资，还是已经有的物资，该物资的最晚拾取时间都将被更新为当前时间点。\n5.\t武器最多同时持有两种，即主/副武器，同优先级的主/副武器不进行替换。\n\n每个格子的物资只会拾取一次。当第二次进入某个格子的时候，物品不会刷新，即不会捡起上次在这个格子丢掉的物品，也不会再次捡到初始时的物品。\n\n当喷火走到含有敌人的格子的时候，他会与敌人进行战斗，他的战斗力很强悍，只需要有足够的子弹即可消灭敌人。每个敌人有两个参数 $a,b$，代表需要消耗 $a$ 发主武器子弹，若主武器子弹不够，则不消耗主武器子弹，而消耗 $b$ 发副武器子弹。若主副武器均没有足够子弹，则喷火被敌人反杀，然后敌人会在喷火的盒子上做蹲起嘲讽他。\n\n每个格子的敌人只会出现一次。如果第二次进入某一个有敌人的格子，则什么都不会发生。\n\n现在，喷火跳在了第一行第一列的格子上，ATA_Radio_STN 已经为喷火摸清了地图形势，而 sltheen 会给喷火下指示，喷火想知道，当他执行完最后一条指示之后，他是否还存活，若存活，按照最晚拾取时间时间从早到晚，输出背包内物品种类和数量，若死亡，输出他死亡格子的坐标。\n\n下附可能出现的物资、物资类别、物资使用的子弹种类、物资所需空间以及物资对应编号。\n\n武器：\n| 武器名称 | 武器类型| 使用的子弹类型 | 编号 |\n| --- | --- | ---  | ---|\n| 空手 | 空手 | N/A | 0|\n|BerylM762|突击步枪|7.62mm子弹|1|\n|AKM|突击步枪|7.62mm子弹|2|\n|SKS|射手步枪|7.62mm子弹|3|\n|Kar98K|栓动步枪|7.62mm子弹|4|\n|M416|突击步枪|5.56mm子弹|5|\n|MK12|射手步枪|5.56mm子弹|6|\n|Mini14|射手步枪|5.56mm子弹|7|\n|S686|霰弹枪|12号霰弹|8|\n|DBS|霰弹枪|12号霰弹|9|\n\n弹药\n|弹药名称| 类型 | 占用空间 | 编号 |\n| - | - | - | - |\n|FragGrenade|投掷物| 5  |   10|\n|SmokeGrenade| 投掷物 |    4|    11|\n|MolotovCocktail |投掷物  | 3 |    12|\n|Flashbang |投掷物        | 2    | 13|\n|7.62mm |子弹 |0.2|                14|\n|5.56mm| 子弹| 0.1                |15|\n|3in（12号霰弹）| 子弹| 0.5|                     16|\n\n请注意，上表中子弹的「占用空间」表示一发子弹所占用的空间。\n\n另外，敌人在地图上的编号为 17。\n\n", "inputFormat": "第一行有四个整数，依次表示地图行数 $n$，列数 $m$，背包容量 $k$，和 sltheen 会下达的指令条数 $t$。  \n接下来的 $n\\times m$ 行中，第 $i$ 行代表第 $\\lfloor\\frac{i - 1}{n}\\rfloor+1$ 行，第 $(i - 1)\\%n+1$ 列的地图情况，其中 $i \\% n$ 表示 $i$ 除以 $n$ 的余数：\n- 此处若是物资，则本行有两个空格隔开的整数，为物资编号 $x$ 和物资数量 $y$，物资编号见「题目描述」中表格的最后一列（如果该物资是枪，则保证 $y = 1$）；\n- 若此处是敌人，则本行有三个空格隔开的整数，第一个整数为 $17$，代表敌人，接下来两个整数依次表示敌人的 $a, b$ 两个参数。\n\n接下来 $t$ 行，每行一个整数 $op$，表示 sltheen 为喷火下达的指令的移动方向：1 代表向上，2 代表向下，3 代表向左，4 代表向右。（第一行第一列是地图的左上角，最后一行第一列是地图的左下角）\n", "outputFormat": "如果喷火死亡，则输出两个数 $u, v$，代表喷火在第 $u$ 行第 $v$ 列死亡。\n\n若喷火未死亡，先输出两行，第一行为主武器编号，第二行为副武器编号，之后输出若干行，每行为两个整数整数，中间用空格隔开，第一个整数为物资名称，第二个整数为其数量，按照最后捡到时间从早到晚排序。", "hint": "### 数据规模与约定\n\n对于全部的测试点，保证：\n- $1 \\leq n, m \\leq 100$，且 $1 \\leq  n \\times m \\leq 100$。\n- $1 \\leq k \\leq 500$，$1 \\leq t,a,b  \\leq 200$。\n- $1 \\leq x \\leq 16$，$1 \\leq y \\leq 5000$。\n- $1 \\leq op \\leq 4$。\n- 数据保证每个格子内只有一种物资（或一个敌人），且背包能够装下任意一格的物资。", "locale": "zh-CN"}}}
{"pid": "P8200", "type": "P", "difficulty": 4, "samples": [["5 3\n1 2 2\n1 3 6 \n2 4 8\n2 5 1\n1 2 4\n2 3 12\n1 4 10", "nO\nNo\nYeS"], ["5 10\n2 1 63\n3 1 57\n4 2 2\n5 2 84\n5 2 84\n4 1 9977404983223574764\n2 5 84\n2 1 15996060349666123522\n5 4 86\n3 1 8428615422876116375\n5 1 107\n2 3 6\n2 3 6\n4 2 2", "yeS\nnO\nYEs\nNo\nYEs\nnO\nYEs\nyeS\nyeS\nYEs"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["树形数据结构", "Special Judge", "O2优化", "深度优先搜索 DFS", "前缀和", "传智杯"], "title": "[传智杯 #4 决赛] 生活在树上（easy version）", "background": "**本题是 P8201 的简单版本，两道题目的解法略有不同。本题和 P8201 在题意上的区别在于本题给定树上的边权，而不是点权。**\n\n小智生活在「传智国」，这是一个有 $n$ 个城市的国家，各个城市由 $n-1$ 条道路相连。\n\n每个道路都有长度 $w_i$ ，我们定义，小智从城市 $a$ 走到城市 $b$ 的代价是 $\\mathrm{dis}_{a, b} = \\bigoplus \\limits_{e \\in \\mathrm{path}\\left(a, b\\right)} w_e$，其中 $\\bigoplus$ 表示**按位异或**（如果你不知道什么是**按位异或**，请参见题目下方的提示/说明），$\\mathrm{path}\\left(a,b\\right)$ 表示 $a$ 到 $b$ 的简单路径上的边集。也即 $\\mathrm{dis}_{a, b}$ 表示将 $a$ 与 $b$ 的简单路径上所有边写作 $e_1, e_2, e_3, \\dots$ 后，求 $w_{e_1} \\bigoplus w_{e_2}\\bigoplus w_{e_3} \\dots$ 的结果。\n\n有一天，小智获得了去参加传智杯的机会，他在前往比赛地的路上想到了一个问题，但他好像不会做，于是他把这个题告诉了你。聪明的同学，你可以帮帮他吗？", "description": "小智说：「由于我们的国家只有 $n$ 个城市和 $n-1$ 条道路，那么我们的国家就相当于是一棵树。我在想，在我们的国家中，是否有城市满足『到城市 $a$ 的代价和到城市 $b$ 的代价的异或等于 $k$』。好难哦，我想不出来，你能帮帮我吗？」\n\n也就是说，给定城市 $a, b$ 和整数 $k$，请你计算是否存在城市 $t$ 满足 $\\mathrm{dis}_{t, a} \\bigoplus \\mathrm{dis}_{t, b} = k$。", "inputFormat": "第一行有两个整数 $n$，$m$，表示国家的城市数和询问的个数。\n\n\n接下来 $n-1$ 行，每行有两个整数 $x, y, l$，表示城市 $x$ 与城市 $y$ 有一条长度为 $l$ 的边。\n\n接下来 $m$ 行，每行有三个整数 $a, b, k$，表示小智从城市 $a$ 走到城市 $b$，$k$ 的含义与题目描述一致。", "outputFormat": "共 $m$ 行，每行一个整数。\n\n对于第 $i$ 个询问，如果存在至少一个城市 $t$ 满足要求，则输出 `Yes`。\n\n如果不存在任何一个城市满足条件，则输出 `No`。\n\n输出字符串大小写不敏感，例如，`Yes`、`yES`、`YES`、`yes` 等都算作 `Yes`。", "hint": "### 相关概念解释\n「树」：树是一个有 $n$ 个结点和 $n-1$ 条边的无向简单连通图。\n\n「按位异或」：按位异或即 C++、python、java 语言中的 「^」 运算。它是一个二元运算，步骤是将两个数的二进制位按位比较，相同为 $0$，不同为 $1$。例如：$3 \\bigoplus 5 = (011)_2 \\bigoplus (101)_2 = (110)_2 = 6$。**请注意，这是一个按位运算，不是一个逻辑运算**。\n### 样例 1 解释\n下图为传智国的地图。\n\n$\\forall t \\in \\{1, 2, 3, 4, 5\\}$，都不可能有 $\\mathrm{dis} _{t,1} \\bigoplus \\mathrm{dis}_{t, 2} = 4$，$\\mathrm{dis}_{t, 2} \\bigoplus \\mathrm{dis}_{t, 3} = 12$，于是输出 `No`；\n\n而取 $t = 5$，有 $\\mathrm{dis}_{t, 1} \\bigoplus \\mathrm{dis}_{t, 4} = 10$，于是输出 `Yes`。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9ikzjfh3.png)\n### 数据规模与约定\n对于所有测试点，保证 $1 < n \\leq 5 \\times 10^5$，$1 \\leq m \\leq 5 \\times 10^5$，$0 \\leq w_i < 2^{64}$。\n\n对于每次询问，保证 $1 \\leq a, b \\leq n$ 且 $a \\neq b$，$0 \\leq k < 2^{64}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[传智杯 #4 决赛] 生活在树上（easy version）", "background": "**本题是 P8201 的简单版本，两道题目的解法略有不同。本题和 P8201 在题意上的区别在于本题给定树上的边权，而不是点权。**\n\n小智生活在「传智国」，这是一个有 $n$ 个城市的国家，各个城市由 $n-1$ 条道路相连。\n\n每个道路都有长度 $w_i$ ，我们定义，小智从城市 $a$ 走到城市 $b$ 的代价是 $\\mathrm{dis}_{a, b} = \\bigoplus \\limits_{e \\in \\mathrm{path}\\left(a, b\\right)} w_e$，其中 $\\bigoplus$ 表示**按位异或**（如果你不知道什么是**按位异或**，请参见题目下方的提示/说明），$\\mathrm{path}\\left(a,b\\right)$ 表示 $a$ 到 $b$ 的简单路径上的边集。也即 $\\mathrm{dis}_{a, b}$ 表示将 $a$ 与 $b$ 的简单路径上所有边写作 $e_1, e_2, e_3, \\dots$ 后，求 $w_{e_1} \\bigoplus w_{e_2}\\bigoplus w_{e_3} \\dots$ 的结果。\n\n有一天，小智获得了去参加传智杯的机会，他在前往比赛地的路上想到了一个问题，但他好像不会做，于是他把这个题告诉了你。聪明的同学，你可以帮帮他吗？", "description": "小智说：「由于我们的国家只有 $n$ 个城市和 $n-1$ 条道路，那么我们的国家就相当于是一棵树。我在想，在我们的国家中，是否有城市满足『到城市 $a$ 的代价和到城市 $b$ 的代价的异或等于 $k$』。好难哦，我想不出来，你能帮帮我吗？」\n\n也就是说，给定城市 $a, b$ 和整数 $k$，请你计算是否存在城市 $t$ 满足 $\\mathrm{dis}_{t, a} \\bigoplus \\mathrm{dis}_{t, b} = k$。", "inputFormat": "第一行有两个整数 $n$，$m$，表示国家的城市数和询问的个数。\n\n\n接下来 $n-1$ 行，每行有两个整数 $x, y, l$，表示城市 $x$ 与城市 $y$ 有一条长度为 $l$ 的边。\n\n接下来 $m$ 行，每行有三个整数 $a, b, k$，表示小智从城市 $a$ 走到城市 $b$，$k$ 的含义与题目描述一致。", "outputFormat": "共 $m$ 行，每行一个整数。\n\n对于第 $i$ 个询问，如果存在至少一个城市 $t$ 满足要求，则输出 `Yes`。\n\n如果不存在任何一个城市满足条件，则输出 `No`。\n\n输出字符串大小写不敏感，例如，`Yes`、`yES`、`YES`、`yes` 等都算作 `Yes`。", "hint": "### 相关概念解释\n「树」：树是一个有 $n$ 个结点和 $n-1$ 条边的无向简单连通图。\n\n「按位异或」：按位异或即 C++、python、java 语言中的 「^」 运算。它是一个二元运算，步骤是将两个数的二进制位按位比较，相同为 $0$，不同为 $1$。例如：$3 \\bigoplus 5 = (011)_2 \\bigoplus (101)_2 = (110)_2 = 6$。**请注意，这是一个按位运算，不是一个逻辑运算**。\n### 样例 1 解释\n下图为传智国的地图。\n\n$\\forall t \\in \\{1, 2, 3, 4, 5\\}$，都不可能有 $\\mathrm{dis} _{t,1} \\bigoplus \\mathrm{dis}_{t, 2} = 4$，$\\mathrm{dis}_{t, 2} \\bigoplus \\mathrm{dis}_{t, 3} = 12$，于是输出 `No`；\n\n而取 $t = 5$，有 $\\mathrm{dis}_{t, 1} \\bigoplus \\mathrm{dis}_{t, 4} = 10$，于是输出 `Yes`。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9ikzjfh3.png)\n### 数据规模与约定\n对于所有测试点，保证 $1 < n \\leq 5 \\times 10^5$，$1 \\leq m \\leq 5 \\times 10^5$，$0 \\leq w_i < 2^{64}$。\n\n对于每次询问，保证 $1 \\leq a, b \\leq n$ 且 $a \\neq b$，$0 \\leq k < 2^{64}$。", "locale": "zh-CN"}}}
{"pid": "P8201", "type": "P", "difficulty": 5, "samples": [["5 3\n2 6 8 1 5\n1 2\n1 3\n2 4\n2 5\n1 2 4\n2 3 12\n2 3 10", "nO\nNo\nYeS"], ["5 10\n93 97 100 93 93\n2 1\n3 2\n4 3\n5 1\n5 2 93\n4 1 93\n3 2 100\n3 2 100\n2 3 9999998\n1 2 93\n2 3 97\n1 2 93\n2 3 97\n4 3 93", "no\nnO\nyEs\nyEs\nNo\nyEs\nyeS\nYES\nyES\nyes"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["树形数据结构", "Special Judge", "O2优化", "最近公共祖先 LCA", "前缀和", "差分", "传智杯", "离线处理"], "title": "[传智杯 #4 决赛] [yLOI2021] 生活在树上（hard version）", "background": "**本题是 P8200 的较难版本，两道题目的解法略有不同。本题和 P8200 在题意上的区别在于本题给定树上的点权，而不是边权。**\n\n小智生活在「传智国」，这是一个有 $n$ 个城市的国家，各个城市由 $n-1$ 条道路相连。\n\n每个城市都有一个财富指数 $w_i$ ，我们定义，小智从城市 $a$ 走到城市 $b$ 的代价是 $\\mathrm{dis}_{a, b} = \\bigoplus \\limits_{u \\in \\mathrm{path}\\left(a, b\\right)} w_u$，其中 $\\bigoplus$ 表示**按位异或**（如果你不知道什么是**按位异或**，请参见题目下方的提示/说明），$\\mathrm{path}\\left(a,b\\right)$ 表示 $a$ 到 $b$ 的简单路径上的点集（包括 $a$ 和 $b$）。也即 $\\mathrm{dis}_{a, b}$ 表示将 $a$ 与 $b$ 的简单路径上所有点写作 $u_1, u_2, u_3, \\dots$ 后，求 $w_{u_1} \\bigoplus w_{u_2}\\bigoplus w_{u_3} \\dots$ 的结果。\n\n有一天，小智获得了去参加传智杯的机会，他在前往比赛地的路上想到了一个问题，但他好像不会做，于是他把这个题告诉了你。聪明的同学，你可以帮帮他吗？", "description": "小智说：「由于我们的国家只有 $n$ 个城市和 $n-1$ 条道路，那么我们的国家就相当于是一棵树。我在想，在我们的国家中，是否存在城市满足『到城市 $a$ 的代价和到城市 $b$ 的代价的异或等于 $k$』。好难哦，我想不出来，你能帮帮我吗？」\n\n也就是说，给定城市 $a, b$ 和整数 $k$，请你计算是否存在城市 $t$ 满足 $\\mathrm{dis}_{t, a} \\bigoplus \\mathrm{dis}_{t, b} = k$。", "inputFormat": "第一行有两个整数 $n$，$m$，表示国家的城市数和询问的个数。\n\n第二行有 $n$ 个整数 $w_i$，表示 $i$ 号城市的财富指数。\n\n接下来 $n-1$ 行，每行有两个整数 $x, y$，表示城市 $x$ 与城市 $y$ 有一条边相连。\n\n接下来 $m$ 行，每行有三个整数 $a, b, k$，表示小智从城市 $a$ 走到城市 $b$，$k$ 的含义与题目描述一致。", "outputFormat": "输出共 $m$ 行。\n\n对于第 $i$ 个询问，如果存在至少一个城市 $t$ 满足要求，则输出 `Yes`。\n\n如果不存在任何一个城市满足条件，则输出 `No`。\n\n输出字符串大小写不敏感，例如，`Yes`、`yES`、`YES`、`yes` 等都算作 `Yes`。", "hint": "### 相关概念解释\n「树」：树是一个有 $n$ 个结点和 $n-1$ 条边的无向简单连通图。\n\n「按位异或」：按位异或是一个二元运算，步骤是将两个数的二进制位按位比较，相同为 $0$，不同为 $1$ 。例如：$3 \\bigoplus 5 = (011)_2 \\bigoplus (101)_2 = (110)_2 = 6$。\n### 样例 1 解释\n下图为传智国的地图。\n\n$\\forall t \\in \\{1, 2, 3, 4, 5\\}$，都不可能有 $\\mathrm{dis} _{t,1} \\bigoplus \\mathrm{dis}_{t, 2} = 4$，$\\mathrm{dis}_{t, 2} \\bigoplus \\mathrm{dis}_{t, 3} = 12$，于是输出 `No`；\n\n而取 $t=4$，有 $\\mathrm{dis}_{t, 2} \\bigoplus \\mathrm{dis}_{t, 3} = 10$，于是输出 `Yes`。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/d3phj9di.png)\n### 数据规模与约定\n对于所有测试点，保证 $1 < n \\leq 5 \\times 10^5$，$1 \\leq m \\leq 5 \\times 10^5$，$0 \\leq w_i \\leq 1\\times 10^7$。\n\n对于每次询问，保证 $1 \\leq a,b \\leq n$ 且 $a \\neq b$，$0 \\leq k \\leq 1\\times 10^7$。\n### 提示\n- 请注意常数因子对程序效率造成的影响。\n- 对于两个 $x, y \\leq 10^7$，$x \\bigoplus y$ 可能大于 $10^7$，请特别注意这一点。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[传智杯 #4 决赛] [yLOI2021] 生活在树上（hard version）", "background": "**本题是 P8200 的较难版本，两道题目的解法略有不同。本题和 P8200 在题意上的区别在于本题给定树上的点权，而不是边权。**\n\n小智生活在「传智国」，这是一个有 $n$ 个城市的国家，各个城市由 $n-1$ 条道路相连。\n\n每个城市都有一个财富指数 $w_i$ ，我们定义，小智从城市 $a$ 走到城市 $b$ 的代价是 $\\mathrm{dis}_{a, b} = \\bigoplus \\limits_{u \\in \\mathrm{path}\\left(a, b\\right)} w_u$，其中 $\\bigoplus$ 表示**按位异或**（如果你不知道什么是**按位异或**，请参见题目下方的提示/说明），$\\mathrm{path}\\left(a,b\\right)$ 表示 $a$ 到 $b$ 的简单路径上的点集（包括 $a$ 和 $b$）。也即 $\\mathrm{dis}_{a, b}$ 表示将 $a$ 与 $b$ 的简单路径上所有点写作 $u_1, u_2, u_3, \\dots$ 后，求 $w_{u_1} \\bigoplus w_{u_2}\\bigoplus w_{u_3} \\dots$ 的结果。\n\n有一天，小智获得了去参加传智杯的机会，他在前往比赛地的路上想到了一个问题，但他好像不会做，于是他把这个题告诉了你。聪明的同学，你可以帮帮他吗？", "description": "小智说：「由于我们的国家只有 $n$ 个城市和 $n-1$ 条道路，那么我们的国家就相当于是一棵树。我在想，在我们的国家中，是否存在城市满足『到城市 $a$ 的代价和到城市 $b$ 的代价的异或等于 $k$』。好难哦，我想不出来，你能帮帮我吗？」\n\n也就是说，给定城市 $a, b$ 和整数 $k$，请你计算是否存在城市 $t$ 满足 $\\mathrm{dis}_{t, a} \\bigoplus \\mathrm{dis}_{t, b} = k$。", "inputFormat": "第一行有两个整数 $n$，$m$，表示国家的城市数和询问的个数。\n\n第二行有 $n$ 个整数 $w_i$，表示 $i$ 号城市的财富指数。\n\n接下来 $n-1$ 行，每行有两个整数 $x, y$，表示城市 $x$ 与城市 $y$ 有一条边相连。\n\n接下来 $m$ 行，每行有三个整数 $a, b, k$，表示小智从城市 $a$ 走到城市 $b$，$k$ 的含义与题目描述一致。", "outputFormat": "输出共 $m$ 行。\n\n对于第 $i$ 个询问，如果存在至少一个城市 $t$ 满足要求，则输出 `Yes`。\n\n如果不存在任何一个城市满足条件，则输出 `No`。\n\n输出字符串大小写不敏感，例如，`Yes`、`yES`、`YES`、`yes` 等都算作 `Yes`。", "hint": "### 相关概念解释\n「树」：树是一个有 $n$ 个结点和 $n-1$ 条边的无向简单连通图。\n\n「按位异或」：按位异或是一个二元运算，步骤是将两个数的二进制位按位比较，相同为 $0$，不同为 $1$ 。例如：$3 \\bigoplus 5 = (011)_2 \\bigoplus (101)_2 = (110)_2 = 6$。\n### 样例 1 解释\n下图为传智国的地图。\n\n$\\forall t \\in \\{1, 2, 3, 4, 5\\}$，都不可能有 $\\mathrm{dis} _{t,1} \\bigoplus \\mathrm{dis}_{t, 2} = 4$，$\\mathrm{dis}_{t, 2} \\bigoplus \\mathrm{dis}_{t, 3} = 12$，于是输出 `No`；\n\n而取 $t=4$，有 $\\mathrm{dis}_{t, 2} \\bigoplus \\mathrm{dis}_{t, 3} = 10$，于是输出 `Yes`。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/d3phj9di.png)\n### 数据规模与约定\n对于所有测试点，保证 $1 < n \\leq 5 \\times 10^5$，$1 \\leq m \\leq 5 \\times 10^5$，$0 \\leq w_i \\leq 1\\times 10^7$。\n\n对于每次询问，保证 $1 \\leq a,b \\leq n$ 且 $a \\neq b$，$0 \\leq k \\leq 1\\times 10^7$。\n### 提示\n- 请注意常数因子对程序效率造成的影响。\n- 对于两个 $x, y \\leq 10^7$，$x \\bigoplus y$ 可能大于 $10^7$，请特别注意这一点。", "locale": "zh-CN"}}}
{"pid": "P8202", "type": "P", "difficulty": 6, "samples": [["4 4\n1 2\n1 3\n3 4\n", "108"], ["3 3\n1 2\n1 3\n", "12"], ["5 5\n1 2\n1 3\n2 4\n3 5\n", "1200"], ["5 5\n1 2\n1 3\n2 4\n2 5", "1140"], ["7 8\n1 2\n1 3\n2 4\n2 5\n3 6\n3 7\n", "929376"], ["6 6\n1 2\n1 3\n3 4\n4 5\n3 6", "18750"], ["10 20\n1 2\n1 3\n2 4\n2 5\n2 6\n2 7\n3 8\n5 9\n9 10\n", "688946281"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "树形 DP", "容斥原理", "传智杯"], "title": "[传智杯 #4 决赛] [yLOI2021] 染色", "background": "传智杯 2021 决赛 G 题。", "description": "传智专修学院的老师给小智布置了一项任务。\n\n老师给了小智一张纸，上面画着一棵有 $n$ 个节点的树（如果你不知道什么是树，可以参考上一题对此的解释）。老师还给了小智 $m$ 支彩色笔，每支笔的颜色都是不同的。老师想要让小智用这 $m$ 种颜色给树的节点涂色，使得这棵树满足如下约束：\n\n1. 每个节点都被涂上了这 $m$ 个颜色之一的**一种**颜色。\n2. 相邻两个节点（若存在一条边直接连接 $u$ 和 $v$，则我们称 $u,v$ 相邻）的颜色是不同的。\n3. 任何一种颜色被使用的次数都不能超过 $\\lfloor\\frac{n}{3}\\rfloor + 1$。\n\n需要指出的是，虽然每个节点都必须被涂上一种颜色，但是每个颜色并不必须被使用。\n\n如此简单的任务难不倒小智，所以小智提出了一个更困难的问题：他想知道一共有多少种染色的方案满足老师的要求。小智不会解答这个问题，所以来求助你，请你帮他解决他的问题。\n\n因为方案数可能非常大，你只需要输出这个方案数除以 $998,244,353$ 的余数。两种染色方案不同当且仅当存在一个节点 $u$，使得 $u$ 在两种方案种被染上的颜色不同。", "inputFormat": "第一行是两个整数，依次表示树的节点数 $n$ 和颜色的个数 $m$。  \n接下来 $(n - 1)$ 行，每行两个整数 $u, v$，表示树上有一条连接 $u, v$ 的边。", "outputFormat": "输出一行一个整数，表示方案数除以 $998,244,353$ 的余数。", "hint": "### 数据规模与约定\n\n对于全部的测试点，保证 $1 \\leq u, v \\leq n\\leq 100$，$n \\leq m \\leq 10^6$，保证给出的是一棵树。\n\n### 提示\n\n**请注意常数因子对程序效率造成的影响**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[传智杯 #4 决赛] [yLOI2021] 染色", "background": "传智杯 2021 决赛 G 题。", "description": "传智专修学院的老师给小智布置了一项任务。\n\n老师给了小智一张纸，上面画着一棵有 $n$ 个节点的树（如果你不知道什么是树，可以参考上一题对此的解释）。老师还给了小智 $m$ 支彩色笔，每支笔的颜色都是不同的。老师想要让小智用这 $m$ 种颜色给树的节点涂色，使得这棵树满足如下约束：\n\n1. 每个节点都被涂上了这 $m$ 个颜色之一的**一种**颜色。\n2. 相邻两个节点（若存在一条边直接连接 $u$ 和 $v$，则我们称 $u,v$ 相邻）的颜色是不同的。\n3. 任何一种颜色被使用的次数都不能超过 $\\lfloor\\frac{n}{3}\\rfloor + 1$。\n\n需要指出的是，虽然每个节点都必须被涂上一种颜色，但是每个颜色并不必须被使用。\n\n如此简单的任务难不倒小智，所以小智提出了一个更困难的问题：他想知道一共有多少种染色的方案满足老师的要求。小智不会解答这个问题，所以来求助你，请你帮他解决他的问题。\n\n因为方案数可能非常大，你只需要输出这个方案数除以 $998,244,353$ 的余数。两种染色方案不同当且仅当存在一个节点 $u$，使得 $u$ 在两种方案种被染上的颜色不同。", "inputFormat": "第一行是两个整数，依次表示树的节点数 $n$ 和颜色的个数 $m$。  \n接下来 $(n - 1)$ 行，每行两个整数 $u, v$，表示树上有一条连接 $u, v$ 的边。", "outputFormat": "输出一行一个整数，表示方案数除以 $998,244,353$ 的余数。", "hint": "### 数据规模与约定\n\n对于全部的测试点，保证 $1 \\leq u, v \\leq n\\leq 100$，$n \\leq m \\leq 10^6$，保证给出的是一棵树。\n\n### 提示\n\n**请注意常数因子对程序效率造成的影响**。", "locale": "zh-CN"}}}
{"pid": "P8203", "type": "P", "difficulty": 7, "samples": [["3 2 1\na\nb\nc\nab\nbac\n1 2\n", "2"], ["3 3 3\naaba\nbaba\naba\nababa\naabab\nbabaa\n1 2\n1 3\n2 3\n", "1\n2\n1"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "虚树", "AC 自动机", "根号分治", "传智杯"], "title": "[传智杯 #4 决赛] DDOSvoid 的馈赠", "background": "", "description": "小智马上就要 AK（All killed，指使本场比赛的全部题目 AC）本场“传智杯”全国大学生 IT 技能大赛（决赛）然后离场了。临走前，DDOSvoid 打算给小智 $n$ 个字符串 $s_1, s_2, \\dots, s_n$ 作为纪念。在本题中，我们将这 $n$ 个字符串称作「模板串」。\n\n小智本身有 $m$ 个字符串 $t_1, t_2, \\dots t_m$。在本题中，我们将这 $m$ 个字符串称为「查询串」。\n\nDDOSvoid 的礼物不是无条件的，他有 $q$ 个问题，每个问题给定两个参数 $x, y$，要求小智回答他：一共有多少个模板串 $s_i$，满足 $s_i$ 既是 $t_x$ 的子串，也是 $t_y$ 的子串？\n\n只有回答对这 $q$ 个问题，小智才能得到 DDOSvoid 馈赠的礼物。请你帮帮小智，回他 DDOSvoid 的问题。\n\n我们称一个字符串 $t$ 是 $s$ 的子串，当且仅当将 $s$ 的开头若干个（可以为 0 个）连续字符和结尾若干个（可以为 0 个）连续字符删去后，剩下的字符串和 $t$ 相同。例如，我们称 `ab` 是 `abc` 的子串，但 `ac` 不是 `abc` 的子串。", "inputFormat": "第一行有三个整数，依次表示模板串个数 $n$，查询串个数 $m$，以及询问的个数 $q$。  \n接下来 $n$ 行，每行一个字符串，依次表示模板串 $s_1,s_2, \\dots s_n$。  \n接下来 $m$ 行，每行一个字符串，依次表示查询串 $t_1, t_2, \\dots t_m$。  \n接下来 $q$ 行，每行两个整数 $x, y$，表示一个询问。", "outputFormat": "对于每次询问，输出一行一个整数表示答案。", "hint": "### 数据规模与约定\n\n对于全部测试点，保证 $1\\leq n,m,q,|s_i|,|t_i| \\leq 10^5$，且模板串的长度之和、查询串的长度之和均不超过 $10^5$，即 $\\sum\\limits_{i = 1}^n |s_i|,\\sum\\limits_{i = 1}^m|t_i| \\leq 10^5$，其中 $|x|$ 表示字符串 $x$ 的长度。保证输入的字符串只含有小写字母，$1 \\leq x\\neq y \\leq m$。\n\n### 提示\n\n**请注意常数因子对程序效率造成的影响**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[传智杯 #4 决赛] DDOSvoid 的馈赠", "background": "", "description": "小智马上就要 AK（All killed，指使本场比赛的全部题目 AC）本场“传智杯”全国大学生 IT 技能大赛（决赛）然后离场了。临走前，DDOSvoid 打算给小智 $n$ 个字符串 $s_1, s_2, \\dots, s_n$ 作为纪念。在本题中，我们将这 $n$ 个字符串称作「模板串」。\n\n小智本身有 $m$ 个字符串 $t_1, t_2, \\dots t_m$。在本题中，我们将这 $m$ 个字符串称为「查询串」。\n\nDDOSvoid 的礼物不是无条件的，他有 $q$ 个问题，每个问题给定两个参数 $x, y$，要求小智回答他：一共有多少个模板串 $s_i$，满足 $s_i$ 既是 $t_x$ 的子串，也是 $t_y$ 的子串？\n\n只有回答对这 $q$ 个问题，小智才能得到 DDOSvoid 馈赠的礼物。请你帮帮小智，回他 DDOSvoid 的问题。\n\n我们称一个字符串 $t$ 是 $s$ 的子串，当且仅当将 $s$ 的开头若干个（可以为 0 个）连续字符和结尾若干个（可以为 0 个）连续字符删去后，剩下的字符串和 $t$ 相同。例如，我们称 `ab` 是 `abc` 的子串，但 `ac` 不是 `abc` 的子串。", "inputFormat": "第一行有三个整数，依次表示模板串个数 $n$，查询串个数 $m$，以及询问的个数 $q$。  \n接下来 $n$ 行，每行一个字符串，依次表示模板串 $s_1,s_2, \\dots s_n$。  \n接下来 $m$ 行，每行一个字符串，依次表示查询串 $t_1, t_2, \\dots t_m$。  \n接下来 $q$ 行，每行两个整数 $x, y$，表示一个询问。", "outputFormat": "对于每次询问，输出一行一个整数表示答案。", "hint": "### 数据规模与约定\n\n对于全部测试点，保证 $1\\leq n,m,q,|s_i|,|t_i| \\leq 10^5$，且模板串的长度之和、查询串的长度之和均不超过 $10^5$，即 $\\sum\\limits_{i = 1}^n |s_i|,\\sum\\limits_{i = 1}^m|t_i| \\leq 10^5$，其中 $|x|$ 表示字符串 $x$ 的长度。保证输入的字符串只含有小写字母，$1 \\leq x\\neq y \\leq m$。\n\n### 提示\n\n**请注意常数因子对程序效率造成的影响**。", "locale": "zh-CN"}}}
{"pid": "P8204", "type": "P", "difficulty": 6, "samples": [["8 4\n1 1 1 2 2 2 5\n2 1\n1 1\n6 0\n1 2", "16\n1 2 1\n3 1\n2\n1 6 0\n3 3\n2\n1 1 1\n1 1 1\n3 2\n2\n1 1 2\n1 1 2\n3 4\n2\n2\n2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2005", "Special Judge", "O2优化", "Ynoi"], "title": "[Ynoi2005] tdnmo", "background": "", "description": "给定一棵 $n$ 个顶点的有根树，顶点编号为 $1,2,\\dots,n$，$1$ 号顶点为根。定义有向邻域 $N(x,y)$ 为以 $x$ 为根的子树中，距离 $x$ 小于 $y$ 的顶点构成的集合，其中 $1\\le x\\le n,\\;0\\le y\\le n$，$x,y$ 为整数。\n\n给出 $m$ 个有向邻域 $N(x_i,y_i)_{i=1}^m$，你可以从 $N(1,0)$ 出发，经过不超过 $5m$ 次操作到达每个给出的有向邻域，可以使用的操作有：\n\n1. 从有向邻域 $N(x,y)$ 移动到 $N(x',y')$，满足 $N(x,y)\\subseteq N(x',y')$；\n2. 撤销一次 $1$ 操作，即回到之前最后一次未撤销的 $1$ 操作前的位置，并将这次 $1$ 操作标为已撤销；\n3. 声明当前到达了有向邻域 $N(x_i,y_i)$，满足当前所在邻域是 $N(x_i,y_i)$；\n\n其中操作1的代价为移动前后两个有向邻域的元素个数之差，操作2和3不计代价，要求操作2执行时必须存在未撤销的操作1，操作3必须对每个 $1\\le i\\le m$ 恰好各执行一次。\n\n你需要保证操作的总代价不超过 $2.5\\times{10}^{9}$。", "inputFormat": "第一行两个整数 $n\\ m$；\n\n接下来一行，共 $n-1$ 个整数，依次表示编号为 $2,3,\\dots,n$ 的顶点的父亲 $f_2,\\dots,f_n$，保证父亲的编号小于孩子的编号；\n\n接下来的 $m$ 行中，第 $i$ 行两个整数 $x_i\\ y_i$，表示给出的每个有向邻域。", "outputFormat": "第一行一个整数 $m'$，表示你进行的操作次数；\n\n接下来 $m'$ 行，依次表示每个操作；\n\n操作 $1$ 表示为 $1\\ x'\\ y'$；\n\n操作 $2$ 表示为 $2$；\n\n操作 $3$ 表示为 $3\\ i$。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：ccz181078，Data：ccz181078，SPJ：nalemy\n\n对于 $100\\%$ 的数据，满足 $1\\le n,m\\le 10^6$，$1\\le f_i\\le i-1$，$1\\le x_i\\le n,\\;0\\le y_i\\le n$，所有数值为整数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2005] tdnmo", "background": "", "description": "给定一棵 $n$ 个顶点的有根树，顶点编号为 $1,2,\\dots,n$，$1$ 号顶点为根。定义有向邻域 $N(x,y)$ 为以 $x$ 为根的子树中，距离 $x$ 小于 $y$ 的顶点构成的集合，其中 $1\\le x\\le n,\\;0\\le y\\le n$，$x,y$ 为整数。\n\n给出 $m$ 个有向邻域 $N(x_i,y_i)_{i=1}^m$，你可以从 $N(1,0)$ 出发，经过不超过 $5m$ 次操作到达每个给出的有向邻域，可以使用的操作有：\n\n1. 从有向邻域 $N(x,y)$ 移动到 $N(x',y')$，满足 $N(x,y)\\subseteq N(x',y')$；\n2. 撤销一次 $1$ 操作，即回到之前最后一次未撤销的 $1$ 操作前的位置，并将这次 $1$ 操作标为已撤销；\n3. 声明当前到达了有向邻域 $N(x_i,y_i)$，满足当前所在邻域是 $N(x_i,y_i)$；\n\n其中操作1的代价为移动前后两个有向邻域的元素个数之差，操作2和3不计代价，要求操作2执行时必须存在未撤销的操作1，操作3必须对每个 $1\\le i\\le m$ 恰好各执行一次。\n\n你需要保证操作的总代价不超过 $2.5\\times{10}^{9}$。", "inputFormat": "第一行两个整数 $n\\ m$；\n\n接下来一行，共 $n-1$ 个整数，依次表示编号为 $2,3,\\dots,n$ 的顶点的父亲 $f_2,\\dots,f_n$，保证父亲的编号小于孩子的编号；\n\n接下来的 $m$ 行中，第 $i$ 行两个整数 $x_i\\ y_i$，表示给出的每个有向邻域。", "outputFormat": "第一行一个整数 $m'$，表示你进行的操作次数；\n\n接下来 $m'$ 行，依次表示每个操作；\n\n操作 $1$ 表示为 $1\\ x'\\ y'$；\n\n操作 $2$ 表示为 $2$；\n\n操作 $3$ 表示为 $3\\ i$。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：ccz181078，Data：ccz181078，SPJ：nalemy\n\n对于 $100\\%$ 的数据，满足 $1\\le n,m\\le 10^6$，$1\\le f_i\\le i-1$，$1\\le x_i\\le n,\\;0\\le y_i\\le n$，所有数值为整数。", "locale": "zh-CN"}}}
{"pid": "P8205", "type": "P", "difficulty": 7, "samples": [["5\n1 1\n2 2\n3 4\n1 3\n3\n1 1\n2 1 3\n3 3 4 5", "0\n1\n3"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2005", "O2优化", "Ynoi"], "title": "[Ynoi2005] vti", "background": "", "description": "给定一棵包含 $n$ 个结点的树，边的编号从 $1$ 到 $n-1$，第 $i$ 条边有一个权值 $b_i$，树的根节点为 $1$ 号节点；\n\n定义两条边 $x,y$ 构成祖先关系，当且仅当构成边 $x$ 的两个节点中深度最深的一个，是构成边 $y$ 的两个节点中深度最深的一个的祖先。\n\n共 $m$ 次询问，第 $i$ 次询问给出 $t_i$ 个可能相同的点，考虑这些点两两之间简单路径经过的边的并集，问无序地选出两条编号不同的边 $x,y$，使得 $x$ 为 $y$ 祖先，且 $b_x<b_y$ 的方案数。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n-1$ 行，每行两个整数 $a_i,b_i$，表示 $i+1$ 和 $a_i$ 之间有一条边，权值为 $b_i$。\n\n接下来一行一个整数 $m$。\n\n接下来 $m$ 行，每行 $t_i+1$ 个整数，第一个整数为 $t_i$，之后 $t_i$ 个整数表示这次询问的点的集合。", "outputFormat": "对每个询问，输出一行，包含一个整数，表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：ccz181078，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，满足 $1\\le n\\le 10^5$，$1\\le m\\le 10^6$，$1\\le a_i\\le i-1$，$1\\le b_i\\le n$，$1\\le t_i$，$t_1+\\dots+t_m\\le 10^6$，以上所有数值为整数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2005] vti", "background": "", "description": "给定一棵包含 $n$ 个结点的树，边的编号从 $1$ 到 $n-1$，第 $i$ 条边有一个权值 $b_i$，树的根节点为 $1$ 号节点；\n\n定义两条边 $x,y$ 构成祖先关系，当且仅当构成边 $x$ 的两个节点中深度最深的一个，是构成边 $y$ 的两个节点中深度最深的一个的祖先。\n\n共 $m$ 次询问，第 $i$ 次询问给出 $t_i$ 个可能相同的点，考虑这些点两两之间简单路径经过的边的并集，问无序地选出两条编号不同的边 $x,y$，使得 $x$ 为 $y$ 祖先，且 $b_x<b_y$ 的方案数。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n-1$ 行，每行两个整数 $a_i,b_i$，表示 $i+1$ 和 $a_i$ 之间有一条边，权值为 $b_i$。\n\n接下来一行一个整数 $m$。\n\n接下来 $m$ 行，每行 $t_i+1$ 个整数，第一个整数为 $t_i$，之后 $t_i$ 个整数表示这次询问的点的集合。", "outputFormat": "对每个询问，输出一行，包含一个整数，表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：ccz181078，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，满足 $1\\le n\\le 10^5$，$1\\le m\\le 10^6$，$1\\le a_i\\le i-1$，$1\\le b_i\\le n$，$1\\le t_i$，$t_1+\\dots+t_m\\le 10^6$，以上所有数值为整数。", "locale": "zh-CN"}}}
{"pid": "P8207", "type": "P", "difficulty": 5, "samples": [["3 12", "126"], ["6022 14076", "66140507445"], ["13063 77883", "3692727018161"], ["325735 425533", "1483175252352926"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2022", "O2优化", "图论建模", "生成树", "THUPC"], "title": "[THUPC 2022 初赛] 最小公倍树", "background": "听说有人嫌题面描述都太长了。", "description": "对于任意 $V\\subset\\mathbb{N}^*$，$|V|<+\\infty$，构造一张无向完全图 $G=(V,E)$，其中 $(u, v)$ 的边权为 $u,v$ 的最小公倍数 $\\mathrm{lcm}(u, v)$。称 $G$ 的最小生成树为 $V$ 的最小公倍树（LCT, Lowest Common Tree）。\n\n现在给出 $L, R$，请你求出 $V={L, L+1, \\cdots, R}$ 的最小公倍树 $LCT(V)$。", "inputFormat": "输入仅一行，包括两个正整数 $L, R$。", "outputFormat": "输出一个正整数，表示 $LCT(V)$ 的边权和。", "hint": "【样例解释】\n\n其中一种最小公倍树上的边为 $(3, 4), (3, 5), (3, 6), (3, 7), (4, 8), (3, 9), (5, 10), (3, 11), (3, 12)$。\n\n【数据范围】\n\n对于 $100\\%$ 的数据，保证 $1\\le L\\le R\\le 10^6$，且 $R-L\\le 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2022 初赛] 最小公倍树", "background": "听说有人嫌题面描述都太长了。", "description": "对于任意 $V\\subset\\mathbb{N}^*$，$|V|<+\\infty$，构造一张无向完全图 $G=(V,E)$，其中 $(u, v)$ 的边权为 $u,v$ 的最小公倍数 $\\mathrm{lcm}(u, v)$。称 $G$ 的最小生成树为 $V$ 的最小公倍树（LCT, Lowest Common Tree）。\n\n现在给出 $L, R$，请你求出 $V={L, L+1, \\cdots, R}$ 的最小公倍树 $LCT(V)$。", "inputFormat": "输入仅一行，包括两个正整数 $L, R$。", "outputFormat": "输出一个正整数，表示 $LCT(V)$ 的边权和。", "hint": "【样例解释】\n\n其中一种最小公倍树上的边为 $(3, 4), (3, 5), (3, 6), (3, 7), (4, 8), (3, 9), (5, 10), (3, 11), (3, 12)$。\n\n【数据范围】\n\n对于 $100\\%$ 的数据，保证 $1\\le L\\le R\\le 10^6$，且 $R-L\\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P8208", "type": "P", "difficulty": 5, "samples": [["5 1 2\n3 2 3 4\n2 1 5\n2 1 5\n2 1 5\n3 2 3 4", "499122178"], ["7 1 4\n6 2 3 4 5 6 7\n6 1 3 4 5 6 7\n6 1 2 4 5 6 7\n6 1 2 3 5 6 7\n6 1 2 3 4 6 7\n6 1 2 3 4 5 7\n6 1 2 3 4 5 6", "274979351"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "2022", "O2优化", "期望", "THUPC"], "title": "[THUPC 2022 初赛] 骰子旅行", "background": "", "description": "在乐队 f 开巡演之前，按照惯例是要先组织乐队成员进行骰子旅行放松身心的。一次骰子旅行包括 $N$ 个地点，这些地点分别标号为 $1, 2, \\cdots, N$。乐队成员们事先约好在 $s_0$ 处集合；而到了骰子旅行当天，大家都来到了集合地点 $s_0$，骰子旅行就算正式开始了。\n\n骰子旅行的一大乐趣就是由骰子决定旅行的下一个目的地。当然，这个骰子不一定非得是六面的。我们可以认为，如果当前乐队成员们位于地点 $i$，那么下一个目的地会等概率地从 $m_i$ 个互不相同的候选地点中产生，这些候选地点分别是 $l_{i, 1}, l_{i, 2}, \\cdots, l_{i, m_i}$。我们记第 $t$ 次投掷的结果是 $s_t$，那么第 $(t+1)$ 次将会前往 $s_t$ 处掷骰子。第 1 次投掷在起点 $s_0$ 处进行；而由于乐队之后还需要为了巡演排练，事先约定无论前往了哪些地点，投掷完第 $T$ 次骰子，前往 $s_T$ 后骰子旅行都得结束。\n\n当然，享受 $s_0, s_1, \\cdots, s_T$ 这些景点也是骰子旅行的一大乐趣。无论是否之前来过，每次到一个地点 $s_t$，乐队成员们都会尽情地浏览美景，品尝美食。只是如果之前来过 $s_t$，负责掷骰子的键盘手 S 在掷这第 $(t+1)$ 次骰子之前一定会说：“上次来到 $s_t$ 仿佛还是上一次 $t'$，上一次在这里掷出了 $s_{t'+1}$，不知道这一次会掷出什么结果。”鼓手 Y 特别喜欢废话梗，所以每次 S 说这句话时，他都会把 $s_{t'+1}$ 记下来。特别地，如果 $s_T$ 是之前经过的地点，那么 S 会说：“上次来到 $s_t$ 仿佛还是上一次 $t'$，上一次在这里掷出了 $s_{t'+1}$，不过这一次就不投掷了，因为骰子旅行到这里就要告一段落了。”当然，Y 也会把这个 $s_{t'+1}$ 记下来。\n\n作为这次骰子旅行的总结，Y 会把所有记录下来的 $s_{t'+1}$ 加起来，作为 S 的废话指数。\n\nf 的下一次巡演马上就要开始了，于是 S 又盘算着带大家去参加骰子旅行。听说你是 f 的粉丝，S 找到了你，希望你能帮他算一下他这次骰子旅行的废话指数的期望值。", "inputFormat": "输入的第一行包括三个正整数 $N, s_0, T$，分别表示可能涉及地点的个数，骰子旅行的起点和骰子旅行中投掷骰子的次数。\n\n接下来 $N$ 行，第 $i\\ (1\\le i\\le N)$ 行先输入一个正整数 $m_i$，表示地点 $i$ 的下一个目的地的候选地点数；接着输入 $m_i$ 个正整数，表示这 $m_i$ 个地点 $l_{i, 1}, l_{i, 2}, \\cdots, l_{i, m_i}$。保证对于任意 $i$，$m_i$ 个输入的地点互不相同。", "outputFormat": "输出一个数表示废话指数的期望。假设废话指数的期望化为最简分式后的形式为 $p/q$（即其中 $p, q$ 互质），请输出 $x$ 使得 $qx\\equiv p \\pmod{998,244,353}$ 且 $0\\le x<998,244,353$。可以证明，在本题数据范围下，$x$ 存在且唯一。", "hint": "【样例解释 1】\n\n对答案有贡献的方案为：从点 $1$ 出发走到 $2, 3, 4$ 中的任意一个点并返回点 $1$。对于某个点 $i (i=2, 3, 4)$，走到点 $i$ 并返回点 $1$ 的概率为 $1/6$，而贡献为 $i$，故期望为 \n\n$$\\frac{1}{6} \\times (2+3+4) = \\frac{3}{2} .$$\n\n由 $499122178 \\times 2 = 998244356 \\equiv 3 \\pmod {998244353}$ 可知 $3/2$ 在模 $998,244,353$ 意义下为 $499,122,178$，所以正确输出为 $499,122,178$。\n\n【样例解释 2】\n\n转换前的答案为 $1625/432\\approx 3.761574$，而 $432\\times 274979351 = 118791079632 \\equiv 1625 \\pmod{998244353}$，所以模意义下的答案为 $274979351$。\n\n【样例 3】\n\n见附件。\n\n【数据范围】\n\n对于 $100\\%$ 的数据，保证 $1\\le N\\le 100$，$1\\le T\\le 100$，$1\\le s_0\\le N$，$1\\le m_i\\le N$，$\\sum_{i=1}^N m_i\\le 5000$，$1\\le l_{i, j}\\le N$，且 $\\forall 1\\le i\\le N, \\forall 1\\le j_1<j_2\\le m_i, l_{i, j_1}\\ne l_{i, j_2}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2022 初赛] 骰子旅行", "background": "", "description": "在乐队 f 开巡演之前，按照惯例是要先组织乐队成员进行骰子旅行放松身心的。一次骰子旅行包括 $N$ 个地点，这些地点分别标号为 $1, 2, \\cdots, N$。乐队成员们事先约好在 $s_0$ 处集合；而到了骰子旅行当天，大家都来到了集合地点 $s_0$，骰子旅行就算正式开始了。\n\n骰子旅行的一大乐趣就是由骰子决定旅行的下一个目的地。当然，这个骰子不一定非得是六面的。我们可以认为，如果当前乐队成员们位于地点 $i$，那么下一个目的地会等概率地从 $m_i$ 个互不相同的候选地点中产生，这些候选地点分别是 $l_{i, 1}, l_{i, 2}, \\cdots, l_{i, m_i}$。我们记第 $t$ 次投掷的结果是 $s_t$，那么第 $(t+1)$ 次将会前往 $s_t$ 处掷骰子。第 1 次投掷在起点 $s_0$ 处进行；而由于乐队之后还需要为了巡演排练，事先约定无论前往了哪些地点，投掷完第 $T$ 次骰子，前往 $s_T$ 后骰子旅行都得结束。\n\n当然，享受 $s_0, s_1, \\cdots, s_T$ 这些景点也是骰子旅行的一大乐趣。无论是否之前来过，每次到一个地点 $s_t$，乐队成员们都会尽情地浏览美景，品尝美食。只是如果之前来过 $s_t$，负责掷骰子的键盘手 S 在掷这第 $(t+1)$ 次骰子之前一定会说：“上次来到 $s_t$ 仿佛还是上一次 $t'$，上一次在这里掷出了 $s_{t'+1}$，不知道这一次会掷出什么结果。”鼓手 Y 特别喜欢废话梗，所以每次 S 说这句话时，他都会把 $s_{t'+1}$ 记下来。特别地，如果 $s_T$ 是之前经过的地点，那么 S 会说：“上次来到 $s_t$ 仿佛还是上一次 $t'$，上一次在这里掷出了 $s_{t'+1}$，不过这一次就不投掷了，因为骰子旅行到这里就要告一段落了。”当然，Y 也会把这个 $s_{t'+1}$ 记下来。\n\n作为这次骰子旅行的总结，Y 会把所有记录下来的 $s_{t'+1}$ 加起来，作为 S 的废话指数。\n\nf 的下一次巡演马上就要开始了，于是 S 又盘算着带大家去参加骰子旅行。听说你是 f 的粉丝，S 找到了你，希望你能帮他算一下他这次骰子旅行的废话指数的期望值。", "inputFormat": "输入的第一行包括三个正整数 $N, s_0, T$，分别表示可能涉及地点的个数，骰子旅行的起点和骰子旅行中投掷骰子的次数。\n\n接下来 $N$ 行，第 $i\\ (1\\le i\\le N)$ 行先输入一个正整数 $m_i$，表示地点 $i$ 的下一个目的地的候选地点数；接着输入 $m_i$ 个正整数，表示这 $m_i$ 个地点 $l_{i, 1}, l_{i, 2}, \\cdots, l_{i, m_i}$。保证对于任意 $i$，$m_i$ 个输入的地点互不相同。", "outputFormat": "输出一个数表示废话指数的期望。假设废话指数的期望化为最简分式后的形式为 $p/q$（即其中 $p, q$ 互质），请输出 $x$ 使得 $qx\\equiv p \\pmod{998,244,353}$ 且 $0\\le x<998,244,353$。可以证明，在本题数据范围下，$x$ 存在且唯一。", "hint": "【样例解释 1】\n\n对答案有贡献的方案为：从点 $1$ 出发走到 $2, 3, 4$ 中的任意一个点并返回点 $1$。对于某个点 $i (i=2, 3, 4)$，走到点 $i$ 并返回点 $1$ 的概率为 $1/6$，而贡献为 $i$，故期望为 \n\n$$\\frac{1}{6} \\times (2+3+4) = \\frac{3}{2} .$$\n\n由 $499122178 \\times 2 = 998244356 \\equiv 3 \\pmod {998244353}$ 可知 $3/2$ 在模 $998,244,353$ 意义下为 $499,122,178$，所以正确输出为 $499,122,178$。\n\n【样例解释 2】\n\n转换前的答案为 $1625/432\\approx 3.761574$，而 $432\\times 274979351 = 118791079632 \\equiv 1625 \\pmod{998244353}$，所以模意义下的答案为 $274979351$。\n\n【样例 3】\n\n见附件。\n\n【数据范围】\n\n对于 $100\\%$ 的数据，保证 $1\\le N\\le 100$，$1\\le T\\le 100$，$1\\le s_0\\le N$，$1\\le m_i\\le N$，$\\sum_{i=1}^N m_i\\le 5000$，$1\\le l_{i, j}\\le N$，且 $\\forall 1\\le i\\le N, \\forall 1\\le j_1<j_2\\le m_i, l_{i, j_1}\\ne l_{i, j_2}$。", "locale": "zh-CN"}}}
{"pid": "P8209", "type": "P", "difficulty": 6, "samples": [["2 1 1\n1 10 100\n1 2 3", "12.0"], ["3 1 3\n1 2 3\n5 6 12\n1 5 6", "14.0"]], "limits": {"time": [10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2022", "O2优化", "THUPC"], "title": "[THUPC 2022 初赛] 赛程制定", "background": "", "description": "Lewis 热爱打拳，因此他组建了一家拳击俱乐部，希望通过举办表演赛卖票以筹集自己训练的资金，但是，很遗憾，Lewis 人缘并不好，因此这个俱乐部只有两个成员——Lewis 和他的好基友 Valtteri，而观众们很快就厌倦了每晚都是他们两人出场的表演赛，票卖不出去了，拳击俱乐部濒临倒闭。穷则思变，Lewis 决定通过请外援的方式，尝试拯救自己的俱乐部。\n\n通过支票攻势，Lewis 很快就请到了两个拳坛明星——Max 和 Checo，他们将作为飞行嘉宾加入 Lewis 的俱乐部。在接下来的一个赛季里，Lewis 总共会安排 $n$ $(1 \\le n \\le 2*10^5)$ 场比赛，每场比赛会从现有的4个成员中选出2人比赛，对于第 $i$ $(1 \\le i \\le n)$ 场比赛，如果是 Lewis 和 Valtteri 的比赛，只能卖出 $a_{i}$ 元的门票，如果是他们中一人和一个明星的比赛，能卖出 $b_i$ 元的门票，如果是两个明星 Max 和 Checo 之间的比赛，能卖出 $c_i$ 元的门票。观众们喜欢看明星之间的高水平比赛，而不是 Lewis 和 Valtteri 的菜鸡互啄，因此有 $1 \\le a_{i} < b_{i} < c_{i} \\le 10^9$ 。除此之外，安排比赛时还有如下要求——\n\n因为明星都是日理万机的，他们只同意分别在Lewis的俱乐部停留最多 $t_m, t_c$ 场比赛的时间。设Max出席的第一场比赛是第 $p_m$ 场，最后一场是 $q_{m}$ 场，Checo出席的第一场比赛是第 $p_c$ 场，最后一场是 $q_c$ 场，则需要满足 $q_m - p_m +1 \\le t_m$ 且 $q_c - p_c +1 \\le t_c$ ；\nLewis 深知自己不会是两个明星的对手，他不会愿意自己被打得鼻青脸肿直接 KO，因此，他不会安排自己与两位明星的比赛（言下之意，挨打的工作就被 Lewis 偷偷安排给了自己的好基友 Valterri，让我们为可怜的工具人 Valterri 默哀）；\n同时，Lewis 希望最大化自己的总收入，但是，他不太聪明，因此，如果一种方案满足以下条件，他就认为此方案满足”收入最大“——\n\n定义 (“Lewis 的最优方案”)：对于一种方案，可以看作一个长度为 $2n$ 的序列，序列的第 $(2i-1)$ 和 $2i$ 项为第 $i$ 场比赛的对阵双方，如果通过修改序列的任意 $1$ 个位置，都无法得到一个收入严格大于当前收入的合法方案，则称此方案为“Lewis 的最优方案”。\n\n聪明的你很快就发现了，“Lewis 的最优方案”不一定能最大化总收入且可能不唯一。已知 Lewis 会从所有“Lewis 的最优方案”（两个方案相同，当且仅当每一天的对阵均相同，注意，Max vs Valtteri 和 Checo vs Valtteri 虽然卖出门票相当，但视为两种不同的方案）等概率随机选一个方案执行，那么，请问在 Lewis 可能最终选择的所有方案中，门票收入的中位数是多少呢？（答案保留一位小数输出）", "inputFormat": "第 $1$ 行：3个正整数 $n,t_m, t_c$ ，意义见题面；\n\n接下来 $n$ 行：每行3个正整数 $a_i, b_i, c_i$ 表示三种情况下卖出的门票价格。", "outputFormat": "一行一个正整数表示在 Lewis 最终选择的所有方案中，门票收入的中位数。", "hint": "【样例解释】\n\nLewis的“收入最大方案”总共有以下 $4$ 种：\n\n- Max vs Checo, Lewis vs Valtteri，门票收入为 $100+1=101$；\n- Valtteri vs Max, Valtteri vs Checo，门票收入为 $10+2=12$；\n- Valtteri vs Checo, Valtteri vs Max，门票收入为 $10+2=12$；\n- Lewis vs Valterri, Max vs Checo，门票收入为 $1+3=4$。\n\n中位数为 $\\frac{12+12}{2} = 12$。\n\n【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le n, t_m, t_c \\le 2*10^5$ , $1 \\le a_{i} < b_{i} < c_{i} \\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2022 初赛] 赛程制定", "background": "", "description": "Lewis 热爱打拳，因此他组建了一家拳击俱乐部，希望通过举办表演赛卖票以筹集自己训练的资金，但是，很遗憾，Lewis 人缘并不好，因此这个俱乐部只有两个成员——Lewis 和他的好基友 Valtteri，而观众们很快就厌倦了每晚都是他们两人出场的表演赛，票卖不出去了，拳击俱乐部濒临倒闭。穷则思变，Lewis 决定通过请外援的方式，尝试拯救自己的俱乐部。\n\n通过支票攻势，Lewis 很快就请到了两个拳坛明星——Max 和 Checo，他们将作为飞行嘉宾加入 Lewis 的俱乐部。在接下来的一个赛季里，Lewis 总共会安排 $n$ $(1 \\le n \\le 2*10^5)$ 场比赛，每场比赛会从现有的4个成员中选出2人比赛，对于第 $i$ $(1 \\le i \\le n)$ 场比赛，如果是 Lewis 和 Valtteri 的比赛，只能卖出 $a_{i}$ 元的门票，如果是他们中一人和一个明星的比赛，能卖出 $b_i$ 元的门票，如果是两个明星 Max 和 Checo 之间的比赛，能卖出 $c_i$ 元的门票。观众们喜欢看明星之间的高水平比赛，而不是 Lewis 和 Valtteri 的菜鸡互啄，因此有 $1 \\le a_{i} < b_{i} < c_{i} \\le 10^9$ 。除此之外，安排比赛时还有如下要求——\n\n因为明星都是日理万机的，他们只同意分别在Lewis的俱乐部停留最多 $t_m, t_c$ 场比赛的时间。设Max出席的第一场比赛是第 $p_m$ 场，最后一场是 $q_{m}$ 场，Checo出席的第一场比赛是第 $p_c$ 场，最后一场是 $q_c$ 场，则需要满足 $q_m - p_m +1 \\le t_m$ 且 $q_c - p_c +1 \\le t_c$ ；\nLewis 深知自己不会是两个明星的对手，他不会愿意自己被打得鼻青脸肿直接 KO，因此，他不会安排自己与两位明星的比赛（言下之意，挨打的工作就被 Lewis 偷偷安排给了自己的好基友 Valterri，让我们为可怜的工具人 Valterri 默哀）；\n同时，Lewis 希望最大化自己的总收入，但是，他不太聪明，因此，如果一种方案满足以下条件，他就认为此方案满足”收入最大“——\n\n定义 (“Lewis 的最优方案”)：对于一种方案，可以看作一个长度为 $2n$ 的序列，序列的第 $(2i-1)$ 和 $2i$ 项为第 $i$ 场比赛的对阵双方，如果通过修改序列的任意 $1$ 个位置，都无法得到一个收入严格大于当前收入的合法方案，则称此方案为“Lewis 的最优方案”。\n\n聪明的你很快就发现了，“Lewis 的最优方案”不一定能最大化总收入且可能不唯一。已知 Lewis 会从所有“Lewis 的最优方案”（两个方案相同，当且仅当每一天的对阵均相同，注意，Max vs Valtteri 和 Checo vs Valtteri 虽然卖出门票相当，但视为两种不同的方案）等概率随机选一个方案执行，那么，请问在 Lewis 可能最终选择的所有方案中，门票收入的中位数是多少呢？（答案保留一位小数输出）", "inputFormat": "第 $1$ 行：3个正整数 $n,t_m, t_c$ ，意义见题面；\n\n接下来 $n$ 行：每行3个正整数 $a_i, b_i, c_i$ 表示三种情况下卖出的门票价格。", "outputFormat": "一行一个正整数表示在 Lewis 最终选择的所有方案中，门票收入的中位数。", "hint": "【样例解释】\n\nLewis的“收入最大方案”总共有以下 $4$ 种：\n\n- Max vs Checo, Lewis vs Valtteri，门票收入为 $100+1=101$；\n- Valtteri vs Max, Valtteri vs Checo，门票收入为 $10+2=12$；\n- Valtteri vs Checo, Valtteri vs Max，门票收入为 $10+2=12$；\n- Lewis vs Valterri, Max vs Checo，门票收入为 $1+3=4$。\n\n中位数为 $\\frac{12+12}{2} = 12$。\n\n【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le n, t_m, t_c \\le 2*10^5$ , $1 \\le a_{i} < b_{i} < c_{i} \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P8210", "type": "P", "difficulty": 4, "samples": [["2\n2 1", "2 5\n3 4\n1 3\n2 4\n1 4\n2 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2022", "Special Judge", "O2优化", "构造", "THUPC"], "title": "[THUPC 2022 初赛] 造计算机", "background": "", "description": "小R和小C听说贵系有一门造计算机的课之后吓得连夜提交了退学申请。\n\n开玩笑的啦！正处于大一的他们对这门课不但不害怕，甚至有些想笑。他们超强的动手能力甚至驱使他们想造一个玩意玩玩。\n\n当然由于他们毕竟才大一，计算机专业课基本上都没上过，经过长时间的艰苦奋战，他们终于造出了一个奇怪的玩意：\n\n这台计算机只有 $n$ 个内存单元，反而有足够多个寄存器。内存单元的编号从 $1$ 到 $n$ ，寄存器从 $n+1$ 开始往上编号。每个内存单元和寄存器可以存储一个整数。\n\n目前他们已经设计好了一类指令：`swap i, j`，表示交换编号为 $i$ 和 $j$ 的单元里的数，其中 $i$ 和 $j$ 均为正整数且 $i \\neq j$ 。他们打算写一段程序来测试这条指令。\n\n最开始， $n$ 个内存单元中乱序存放着 $1\\thicksim n$ 这些数，且每个数恰好出现一次。而每个寄存器里存放的是它的编号。\n\n两人打算设计一段指令序列，使得计算机依次执行完这些指令后，所有内存和寄存器中的数都归位，也就是恰好等于它自己的编号。\n\n虽然没学过计算机专业课，小R和小C还是懂一点皮毛的，因此他们规定每条 `swap` 指令操作的两个位置至少有一个需要是寄存器，也就是 $i$ 和 $j$ 至少有一者应当大于 $n$。\n\n然而，正当他们写完程序开始运行时，却发现系统崩溃了！在查找了半天原因后，他们发现了一个奇怪的 bug：他们设计出来的计算机不能运行两条相同的指令！也就是说，他们不能在一段程序里出现两条相同的 `swap i, j` 指令。更进一步他们发现即使出现一条 `swap i, j` 一条 `swap j, i` 也不行，因为计算机会自动将这两条指令视为同一条。\n\n然后可怜的小R和小C就斯巴达了。不过他们在弃疗之前还是打算利用现有的架构把程序写出来。不仅如此，他们还希望用到的寄存器数量尽可能少。你能帮帮他们吗？", "inputFormat": "第一行：一个正整数 $n\\ (1 \\leq n \\leq 10^5)$ 表示内存单元的数量。\n\n第二行： $n$ 个正整数$a_i$ 依次表示第 $i$ 个内存单元中的初始值，保证所有 $a_i$ 构成一个 $1 \\thicksim n$ 的排列。", "outputFormat": "第一行：两个非负整数 $m,k$，分别表示你用到的寄存器数量和指令的条数。\n\n接下来 $k$ 行，每行输出两个正整数 $i, j$，依次表示你设计的每一条指令中交换的两个位置。你需要保证 $1 \\leq i,j \\leq n+m$，并且满足题目中对于指令的限制条件。\n\n如果有多种设计指令的方案满足题目所需，输出任意一种即可。\n\n你需要最小化 $m$ 而无需最小化 $k$，但需要保证 $k \\leq 10^6$。输入数据保证符合要求的解存在。", "hint": "【样例解释】\n\n最初，前 $4$ 个单元的值依次为 $(2,1,3,4)$ 。\n\n执行指令 `swap 3, 4`，各单元的值变为 $(2,1,4,3)$ 。\n\n执行指令 `swap 1, 3`，各单元的值变为 $(4,1,2,3)$ 。\n\n执行指令 `swap 2, 4`，各单元的值变为 $(4,3,2,1)$ 。\n\n执行指令 `swap 1, 4`，各单元的值变为 $(1,3,2,4)$ 。\n\n执行指令 `swap 2, 3`，各单元的值变为 $(1,2,3,4)$ 。\n\n可以证明 $m=1$ 是不行的。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2022 初赛] 造计算机", "background": "", "description": "小R和小C听说贵系有一门造计算机的课之后吓得连夜提交了退学申请。\n\n开玩笑的啦！正处于大一的他们对这门课不但不害怕，甚至有些想笑。他们超强的动手能力甚至驱使他们想造一个玩意玩玩。\n\n当然由于他们毕竟才大一，计算机专业课基本上都没上过，经过长时间的艰苦奋战，他们终于造出了一个奇怪的玩意：\n\n这台计算机只有 $n$ 个内存单元，反而有足够多个寄存器。内存单元的编号从 $1$ 到 $n$ ，寄存器从 $n+1$ 开始往上编号。每个内存单元和寄存器可以存储一个整数。\n\n目前他们已经设计好了一类指令：`swap i, j`，表示交换编号为 $i$ 和 $j$ 的单元里的数，其中 $i$ 和 $j$ 均为正整数且 $i \\neq j$ 。他们打算写一段程序来测试这条指令。\n\n最开始， $n$ 个内存单元中乱序存放着 $1\\thicksim n$ 这些数，且每个数恰好出现一次。而每个寄存器里存放的是它的编号。\n\n两人打算设计一段指令序列，使得计算机依次执行完这些指令后，所有内存和寄存器中的数都归位，也就是恰好等于它自己的编号。\n\n虽然没学过计算机专业课，小R和小C还是懂一点皮毛的，因此他们规定每条 `swap` 指令操作的两个位置至少有一个需要是寄存器，也就是 $i$ 和 $j$ 至少有一者应当大于 $n$。\n\n然而，正当他们写完程序开始运行时，却发现系统崩溃了！在查找了半天原因后，他们发现了一个奇怪的 bug：他们设计出来的计算机不能运行两条相同的指令！也就是说，他们不能在一段程序里出现两条相同的 `swap i, j` 指令。更进一步他们发现即使出现一条 `swap i, j` 一条 `swap j, i` 也不行，因为计算机会自动将这两条指令视为同一条。\n\n然后可怜的小R和小C就斯巴达了。不过他们在弃疗之前还是打算利用现有的架构把程序写出来。不仅如此，他们还希望用到的寄存器数量尽可能少。你能帮帮他们吗？", "inputFormat": "第一行：一个正整数 $n\\ (1 \\leq n \\leq 10^5)$ 表示内存单元的数量。\n\n第二行： $n$ 个正整数$a_i$ 依次表示第 $i$ 个内存单元中的初始值，保证所有 $a_i$ 构成一个 $1 \\thicksim n$ 的排列。", "outputFormat": "第一行：两个非负整数 $m,k$，分别表示你用到的寄存器数量和指令的条数。\n\n接下来 $k$ 行，每行输出两个正整数 $i, j$，依次表示你设计的每一条指令中交换的两个位置。你需要保证 $1 \\leq i,j \\leq n+m$，并且满足题目中对于指令的限制条件。\n\n如果有多种设计指令的方案满足题目所需，输出任意一种即可。\n\n你需要最小化 $m$ 而无需最小化 $k$，但需要保证 $k \\leq 10^6$。输入数据保证符合要求的解存在。", "hint": "【样例解释】\n\n最初，前 $4$ 个单元的值依次为 $(2,1,3,4)$ 。\n\n执行指令 `swap 3, 4`，各单元的值变为 $(2,1,4,3)$ 。\n\n执行指令 `swap 1, 3`，各单元的值变为 $(4,1,2,3)$ 。\n\n执行指令 `swap 2, 4`，各单元的值变为 $(4,3,2,1)$ 。\n\n执行指令 `swap 1, 4`，各单元的值变为 $(1,3,2,4)$ 。\n\n执行指令 `swap 2, 3`，各单元的值变为 $(1,2,3,4)$ 。\n\n可以证明 $m=1$ 是不行的。\n", "locale": "zh-CN"}}}
{"pid": "P8211", "type": "P", "difficulty": 6, "samples": [["5\n1 6 1\n1 3 0\n1 9 2\n2 3\n2 4", "3\n4\n"], ["4\n1 2 1\n2 2\n1 2 1\n2 2", "2\n1"]], "limits": {"time": [10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2022", "O2优化", "根号分治", "THUPC"], "title": "[THUPC 2022 初赛] 搬砖", "background": "张华考上了北京大学；李萍进了中等技术学校；小 E 在工地搬砖：他们都有光明的前途。", "description": "**温馨提示：请不要模仿小 E 的搬砖方式，那样很累。**\n\n为了能够快乐地搬砖，小 E 有一种特殊的搬砖方式。\n\n假设他的面前有 $n$ 摞砖，他会在一个小时内搬走每一摞砖最上面的 $d$ 块。其中 $d$ 是小 E 当前的精力值。如果一摞砖不够 $d$ 块，小 E 会把这一摞砖剩下的所有砖搬走。\n\n当小 E 工作完一个小时后发现自己搬完了至少一摞砖，那么他会觉得很快乐，并且继续工作一个小时；但是由于完成了一部分工作，小 E 可能会产生懈怠的心理，导致精力值有所下降。具体地，对于每一摞砖都有一个属性 $b$，当小 E 搬完这一摞砖后，精力值就会下降 $b$。\n\n如果没有任何一摞砖被搬完，小 E 就会停止工作。如果精力值下降到 $0$ 或以下，小 E 也会停止工作。如果小 E 发现自己需要工作但是所有的砖已被搬完，他会用别的方式来度过这一小时，但这一小时仍算作小 E 的工作时间。\n\n工地的砖在不停增加，问如果小 E 初始的精力值为 $d$，那么他可以连续工作几个小时？", "inputFormat": "第一行一个正整数 $T$，表示事件总数。\n\n接下来 $T$ 行，每行若干个整数，其中第一个整数为 $op$ 表示事件类型。\n\n若 $op=1$，则后面跟着两个整数 $a,b$，表示新增了一摞砖，砖有 $a$ 块，搬完后小 E 的精力值会下降 $b$。\n\n若 $op=2$，则后面跟着一个正整数 $d$，询问若小 E 初始的精力值为 $d$，那么他可以连续工作几个小时。\n\n注意 $op=2$ 的操作**不会**改变任何一摞砖的数量。", "outputFormat": "对于每个询问，输出一行一个整数表示答案。", "hint": "【样例解释】\n\n第一组询问：\n\n初始有 $3$ 摞砖，数量分别为 $(6,3,9)$，小 E 的初始精力是 $3$。\n\n第一个小时，小 E 在每一摞砖中各搬了 $3$ 块，数量变成 $(3,0,6)$。其中第二摞砖被搬完，小 E 的精力因此下降 $0$ 并且继续工作一个小时。\n\n第二个小时，小 E 在每一摞砖中各搬了 $3$ 块，数量变成 $(0,0,3)$。其中第一摞砖被搬完，小 E 的精力因此下降 $1$ 并且继续工作一个小时。\n\n第三个小时，小 E 在每一摞砖中各搬了 $2$ 块，数量变成 $(0,0,1)$。由于没有新的砖摞被搬完，小 E 停止工作。\n\n第二组询问：\n\n初始有 $3$ 摞砖，数量分别为 $(6,3,9)$，小 E 的初始精力是 $4$。\n\n第一个小时，小 E 在每一摞砖中各搬了 $4$ 块（第二摞砖由于只有 $3$ 块就只搬了 $3$ 块，以下省略），数量变成 $(2,0,5)$。其中第二摞砖被搬完，小 E 的精力因此下降 $0$ 并且继续工作一个小时。\n\n第二个小时，小 E 在每一摞砖中各搬了 $4$ 块，数量变成 $(0,0,1)$。其中第一摞砖被搬完，小 E 的精力因此下降 $1$ 并且继续工作一个小时。\n\n第三个小时，小 E 在每一摞砖中各搬了 $3$ 块，数量变成 $(0,0,0)$。其中第三摞砖被搬完，小 E 的精力因此下降 $2$ 并且继续工作一个小时。\n\n第四个小时，小 E 在每一摞砖中各搬了 $1$ 块，但其实此时已经没有砖了，不过这一小时仍然算进小 E 的工作时间。由于没有新的砖摞被搬完，小 E 停止工作。\n\n【样例解释 2】\n\n第一组询问：\n\n初始有 $1$ 摞砖，数量为 $2$，小 E 的初始精力是 $2$。\n\n第一个小时，小 E 在每一摞砖中各搬了 $2$ 块，数量变成 $0$。这一摞砖被搬完，小 E 的精力因此下降 $1$ 并且继续工作一个小时。\n\n第二个小时，小 E 在每一摞砖中各搬了 $1$ 块，但其实此时已经没有砖了，不过这一小时仍然算进小 E 的工作时间。由于没有新的砖摞被搬完，小 E 停止工作。\n\n第二组询问：\n\n初始有 $2$ 摞砖，数量为 $(2,2)$，小 E 的初始精力是 $2$。\n\n第一个小时，小 E 在每一摞砖中各搬了 $2$ 块， 数量变成 $(0,0)$。两摞砖都被搬完，小 E 的精力因此下降 $1+1=2$。由于小 E 的精力下降到 $0$，他停止工作。\n\n【数据范围】\n\n保证 $T\\le 351493,1\\le op\\le 2,1\\le a\\le 100000,0\\le b\\le 100000,1\\le d \\le 100000$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2022 初赛] 搬砖", "background": "张华考上了北京大学；李萍进了中等技术学校；小 E 在工地搬砖：他们都有光明的前途。", "description": "**温馨提示：请不要模仿小 E 的搬砖方式，那样很累。**\n\n为了能够快乐地搬砖，小 E 有一种特殊的搬砖方式。\n\n假设他的面前有 $n$ 摞砖，他会在一个小时内搬走每一摞砖最上面的 $d$ 块。其中 $d$ 是小 E 当前的精力值。如果一摞砖不够 $d$ 块，小 E 会把这一摞砖剩下的所有砖搬走。\n\n当小 E 工作完一个小时后发现自己搬完了至少一摞砖，那么他会觉得很快乐，并且继续工作一个小时；但是由于完成了一部分工作，小 E 可能会产生懈怠的心理，导致精力值有所下降。具体地，对于每一摞砖都有一个属性 $b$，当小 E 搬完这一摞砖后，精力值就会下降 $b$。\n\n如果没有任何一摞砖被搬完，小 E 就会停止工作。如果精力值下降到 $0$ 或以下，小 E 也会停止工作。如果小 E 发现自己需要工作但是所有的砖已被搬完，他会用别的方式来度过这一小时，但这一小时仍算作小 E 的工作时间。\n\n工地的砖在不停增加，问如果小 E 初始的精力值为 $d$，那么他可以连续工作几个小时？", "inputFormat": "第一行一个正整数 $T$，表示事件总数。\n\n接下来 $T$ 行，每行若干个整数，其中第一个整数为 $op$ 表示事件类型。\n\n若 $op=1$，则后面跟着两个整数 $a,b$，表示新增了一摞砖，砖有 $a$ 块，搬完后小 E 的精力值会下降 $b$。\n\n若 $op=2$，则后面跟着一个正整数 $d$，询问若小 E 初始的精力值为 $d$，那么他可以连续工作几个小时。\n\n注意 $op=2$ 的操作**不会**改变任何一摞砖的数量。", "outputFormat": "对于每个询问，输出一行一个整数表示答案。", "hint": "【样例解释】\n\n第一组询问：\n\n初始有 $3$ 摞砖，数量分别为 $(6,3,9)$，小 E 的初始精力是 $3$。\n\n第一个小时，小 E 在每一摞砖中各搬了 $3$ 块，数量变成 $(3,0,6)$。其中第二摞砖被搬完，小 E 的精力因此下降 $0$ 并且继续工作一个小时。\n\n第二个小时，小 E 在每一摞砖中各搬了 $3$ 块，数量变成 $(0,0,3)$。其中第一摞砖被搬完，小 E 的精力因此下降 $1$ 并且继续工作一个小时。\n\n第三个小时，小 E 在每一摞砖中各搬了 $2$ 块，数量变成 $(0,0,1)$。由于没有新的砖摞被搬完，小 E 停止工作。\n\n第二组询问：\n\n初始有 $3$ 摞砖，数量分别为 $(6,3,9)$，小 E 的初始精力是 $4$。\n\n第一个小时，小 E 在每一摞砖中各搬了 $4$ 块（第二摞砖由于只有 $3$ 块就只搬了 $3$ 块，以下省略），数量变成 $(2,0,5)$。其中第二摞砖被搬完，小 E 的精力因此下降 $0$ 并且继续工作一个小时。\n\n第二个小时，小 E 在每一摞砖中各搬了 $4$ 块，数量变成 $(0,0,1)$。其中第一摞砖被搬完，小 E 的精力因此下降 $1$ 并且继续工作一个小时。\n\n第三个小时，小 E 在每一摞砖中各搬了 $3$ 块，数量变成 $(0,0,0)$。其中第三摞砖被搬完，小 E 的精力因此下降 $2$ 并且继续工作一个小时。\n\n第四个小时，小 E 在每一摞砖中各搬了 $1$ 块，但其实此时已经没有砖了，不过这一小时仍然算进小 E 的工作时间。由于没有新的砖摞被搬完，小 E 停止工作。\n\n【样例解释 2】\n\n第一组询问：\n\n初始有 $1$ 摞砖，数量为 $2$，小 E 的初始精力是 $2$。\n\n第一个小时，小 E 在每一摞砖中各搬了 $2$ 块，数量变成 $0$。这一摞砖被搬完，小 E 的精力因此下降 $1$ 并且继续工作一个小时。\n\n第二个小时，小 E 在每一摞砖中各搬了 $1$ 块，但其实此时已经没有砖了，不过这一小时仍然算进小 E 的工作时间。由于没有新的砖摞被搬完，小 E 停止工作。\n\n第二组询问：\n\n初始有 $2$ 摞砖，数量为 $(2,2)$，小 E 的初始精力是 $2$。\n\n第一个小时，小 E 在每一摞砖中各搬了 $2$ 块， 数量变成 $(0,0)$。两摞砖都被搬完，小 E 的精力因此下降 $1+1=2$。由于小 E 的精力下降到 $0$，他停止工作。\n\n【数据范围】\n\n保证 $T\\le 351493,1\\le op\\le 2,1\\le a\\le 100000,0\\le b\\le 100000,1\\le d \\le 100000$。", "locale": "zh-CN"}}}
{"pid": "P8212", "type": "P", "difficulty": 6, "samples": [["5 4\n0 0\n1 0\n2 1\n2 2\n0 2", "1.9892766953"], ["3 3\n0 0\n1 0\n0 1", "0.1226170434"]], "limits": {"time": [8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["计算几何", "2022", "Special Judge", "O2优化", "模拟退火", "THUPC"], "title": "[THUPC 2022 初赛] 喵喵花園", "background": "", "description": "喵喵是一只非常富有的猫咪，他在海淀区拥有一个大花园。\n\n这个大花园是由一些旧栅栏为边界所形成的 $N$-gon（即具有 $N$ 边的多边形）。\n\n由于圣诞节快到了，喵喵想用 $K$ 棵圣诞树来装饰一下花园。 同时，喵喵坚信找到一些好的位置来种树会给他带来好运。\n\n作为一只好猫咪，他决定寻找最佳位置如下：\n\n- 所有的树都应该在花园的边界上。\n- 这些 $K$ 树应该平均划分花园的周长。\n- 由树木形成的新凸面$K$-gon 的面积应尽可能小。\n\n虽然喵喵比你有钱，但他没有你那么聪明。 因此，他给了你一些钱，让你帮他找出凸$K$-gon 的最小面积。", "inputFormat": "第一行包含两个整数，$N$ 和 $K$，代表原本花园边界的顶点数和树的数量。\n\n接下来的每行 $N$ 行包含两个整数 $x_i$ 和 $y_i$，表示花园边界顶点的坐标。\n\n所有座标均为逆时针给出的。", "outputFormat": "输出凸面 $K$-gon 的最小面积。 如果相对或绝对误差不超过 $10^{-8}$，则您的答案被认为是正确的。", "hint": "【数据范围】\n\n- $3 \\le N, K \\le 1000$；\n- $-10^5 \\le x_i, y_i \\le 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2022 初赛] 喵喵花園", "background": "", "description": "喵喵是一只非常富有的猫咪，他在海淀区拥有一个大花园。\n\n这个大花园是由一些旧栅栏为边界所形成的 $N$-gon（即具有 $N$ 边的多边形）。\n\n由于圣诞节快到了，喵喵想用 $K$ 棵圣诞树来装饰一下花园。 同时，喵喵坚信找到一些好的位置来种树会给他带来好运。\n\n作为一只好猫咪，他决定寻找最佳位置如下：\n\n- 所有的树都应该在花园的边界上。\n- 这些 $K$ 树应该平均划分花园的周长。\n- 由树木形成的新凸面$K$-gon 的面积应尽可能小。\n\n虽然喵喵比你有钱，但他没有你那么聪明。 因此，他给了你一些钱，让你帮他找出凸$K$-gon 的最小面积。", "inputFormat": "第一行包含两个整数，$N$ 和 $K$，代表原本花园边界的顶点数和树的数量。\n\n接下来的每行 $N$ 行包含两个整数 $x_i$ 和 $y_i$，表示花园边界顶点的坐标。\n\n所有座标均为逆时针给出的。", "outputFormat": "输出凸面 $K$-gon 的最小面积。 如果相对或绝对误差不超过 $10^{-8}$，则您的答案被认为是正确的。", "hint": "【数据范围】\n\n- $3 \\le N, K \\le 1000$；\n- $-10^5 \\le x_i, y_i \\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P8213", "type": "P", "difficulty": 5, "samples": [["3\n3 3 3\n1 2 3", "1.000000000000000000"], ["3\n2 3 3\n1 2 3", "0.250000000000000000"], ["10\n2 1 4 7 4 8 3 6 4 8\n3 1 4 1 5 9 2 6 5 3", "0.833333333333333333\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "2022", "Special Judge", "O2优化", "THUPC"], "title": "[THUPC 2022 初赛] 挑战", "background": "", "description": "**足够聪明**的 Alice 和 Bob 在玩一种棋盘游戏。这个游戏需要用到一个有 $(n+1)$ 个格子的长条棋盘，按从左到右的顺序给每个格子编号 $0, 1, \\cdots, n$。除了编号为 $n$ 的格以外，每一格都有两个数 $p_i, q_i$。游戏开始前，将一个棋子放在第 $0$ 格。游戏由二人轮流操作，这里我们不妨假设 Alice 先手。\n\n轮到其中一位玩家进行操作时，这位玩家可以根据当前格子的 $p$ 值决定前进的步数。具体地说，假设当前棋子位于第 $k$ 格，那么当前进行操作的玩家可以将棋子向前移动 $x$ 格，其中 $x$ 可以是满足 $1\\le x\\le p_k$ 的任意整数。如果玩家没有走满 $p_k$ 格，即 $x<p_k$，那么该玩家可以在完成移动后选择是否进行一次挑战。如果选择不进行挑战，那么由另一位玩家进行下一轮操作。否则，如果当前玩家选择挑战，那么系统将会产生两个随机**整数** $u$ 和 $v$，其中：$u$ 表示挑战的能量，它在 $\\left[1, p_k-x\\right]$ 中等概率产生；$v$ 表示挑战所需的活化能，它在 $\\left[0, q_k + q_{k+x}\\right]$ 中等概率产生。根据 $u$ 和 $v$ 的值，系统会根据以下规则自动判定挑战结果：\n\n如果 $u>v$，则挑战成功，对方玩家的操作被跳过一轮，由当前玩家继续操作；\n如果 $u=v$，则挑战结果为平手，什么事情都不会发生，由对方玩家进行操作；\n如果 $u<v$，则挑战失败，当前玩家下一轮操作将会被跳过，即对方玩家可以连续操作两轮。\n为了防止其中一方玩家一直被跳过，规定：\n\n如果当前玩家通过自身的挑战获得额外操作机会，则该玩家在该额外操作机会中不能进行第二次挑战；\n如果当前玩家通过对方玩家的挑战获得额外操作机会，则该玩家不能在其第一次操作结束时发起挑战，只能在第二次操作结束时选择是否进行挑战，并且当且仅当挑战成功时可以进行第三次操作。\n需要注意的是，无论连续进行多少次操作，每次操作都需要将棋子向前移动至少 $1$ 格。同大多数游戏一样，谁将棋子移动到终点（即编号为 $n$ 的格）谁就获胜。\n\nAlice 和 Bob 都足够聪明，可以心算出对于当前棋子的位置，能使自己获胜概率最大的操作。作为一名旁观者，你没有他们那么强的心算能力；但是你也想通过自己编程的能力，计算出当 Alice 先手从第 $0$ 格开始进行操作时，Alice 的胜率。", "inputFormat": "输入的第一行包含一个正整数 $n$，表示棋盘包含 $(n+1)$ 格，分别标号 $0, 1, \\cdots, n$。\n\n输入的第二行包含 $n$ 个正整数 $p_0, p_1, \\cdots, p_{n-1}$，分别表示第 $0$ 格至第 $(n-1)$ 格的 $p$ 值。\n\n输入的第三行包含 $n$ 个正整数 $q_0, q_1, \\cdots, q_{n-1}$，分别表示第 $0$ 格至第 $(n-1)$ 格的 $q$ 值。", "outputFormat": "输出一个实数，表示 Alice 先手开始游戏的胜率。当你的输出与标准输出的绝对误差不超过 $10^{-6}$ 时，我们认为你的输出是正确的。", "hint": "【样例解释 1】\n\nAlice 先手，由于可以直接从第 $0$ 格移动到终点的第 $3$ 格，Alice 会直接将棋子移动到第 $3$ 格，故 Alice 必胜。\n\n【样例解释 2】\n\nAlice 先手，但是不能直接移动到第 $3$ 格，并且无论结束操作时棋子在第 $1$ 格还是第 $2$ 格，Bob 都可以直接将其移动到终点的第 $3$ 格，因此 Alice 必须尝试挑战。将棋子移动到第 $1$ 格并发动挑战，挑战成功的概率为 $1/4$，故 Alice 的胜率为 $1/4$。\n\n【数据范围】\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 100000$，$1\\le p_i, q_i\\le 333$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2022 初赛] 挑战", "background": "", "description": "**足够聪明**的 Alice 和 Bob 在玩一种棋盘游戏。这个游戏需要用到一个有 $(n+1)$ 个格子的长条棋盘，按从左到右的顺序给每个格子编号 $0, 1, \\cdots, n$。除了编号为 $n$ 的格以外，每一格都有两个数 $p_i, q_i$。游戏开始前，将一个棋子放在第 $0$ 格。游戏由二人轮流操作，这里我们不妨假设 Alice 先手。\n\n轮到其中一位玩家进行操作时，这位玩家可以根据当前格子的 $p$ 值决定前进的步数。具体地说，假设当前棋子位于第 $k$ 格，那么当前进行操作的玩家可以将棋子向前移动 $x$ 格，其中 $x$ 可以是满足 $1\\le x\\le p_k$ 的任意整数。如果玩家没有走满 $p_k$ 格，即 $x<p_k$，那么该玩家可以在完成移动后选择是否进行一次挑战。如果选择不进行挑战，那么由另一位玩家进行下一轮操作。否则，如果当前玩家选择挑战，那么系统将会产生两个随机**整数** $u$ 和 $v$，其中：$u$ 表示挑战的能量，它在 $\\left[1, p_k-x\\right]$ 中等概率产生；$v$ 表示挑战所需的活化能，它在 $\\left[0, q_k + q_{k+x}\\right]$ 中等概率产生。根据 $u$ 和 $v$ 的值，系统会根据以下规则自动判定挑战结果：\n\n如果 $u>v$，则挑战成功，对方玩家的操作被跳过一轮，由当前玩家继续操作；\n如果 $u=v$，则挑战结果为平手，什么事情都不会发生，由对方玩家进行操作；\n如果 $u<v$，则挑战失败，当前玩家下一轮操作将会被跳过，即对方玩家可以连续操作两轮。\n为了防止其中一方玩家一直被跳过，规定：\n\n如果当前玩家通过自身的挑战获得额外操作机会，则该玩家在该额外操作机会中不能进行第二次挑战；\n如果当前玩家通过对方玩家的挑战获得额外操作机会，则该玩家不能在其第一次操作结束时发起挑战，只能在第二次操作结束时选择是否进行挑战，并且当且仅当挑战成功时可以进行第三次操作。\n需要注意的是，无论连续进行多少次操作，每次操作都需要将棋子向前移动至少 $1$ 格。同大多数游戏一样，谁将棋子移动到终点（即编号为 $n$ 的格）谁就获胜。\n\nAlice 和 Bob 都足够聪明，可以心算出对于当前棋子的位置，能使自己获胜概率最大的操作。作为一名旁观者，你没有他们那么强的心算能力；但是你也想通过自己编程的能力，计算出当 Alice 先手从第 $0$ 格开始进行操作时，Alice 的胜率。", "inputFormat": "输入的第一行包含一个正整数 $n$，表示棋盘包含 $(n+1)$ 格，分别标号 $0, 1, \\cdots, n$。\n\n输入的第二行包含 $n$ 个正整数 $p_0, p_1, \\cdots, p_{n-1}$，分别表示第 $0$ 格至第 $(n-1)$ 格的 $p$ 值。\n\n输入的第三行包含 $n$ 个正整数 $q_0, q_1, \\cdots, q_{n-1}$，分别表示第 $0$ 格至第 $(n-1)$ 格的 $q$ 值。", "outputFormat": "输出一个实数，表示 Alice 先手开始游戏的胜率。当你的输出与标准输出的绝对误差不超过 $10^{-6}$ 时，我们认为你的输出是正确的。", "hint": "【样例解释 1】\n\nAlice 先手，由于可以直接从第 $0$ 格移动到终点的第 $3$ 格，Alice 会直接将棋子移动到第 $3$ 格，故 Alice 必胜。\n\n【样例解释 2】\n\nAlice 先手，但是不能直接移动到第 $3$ 格，并且无论结束操作时棋子在第 $1$ 格还是第 $2$ 格，Bob 都可以直接将其移动到终点的第 $3$ 格，因此 Alice 必须尝试挑战。将棋子移动到第 $1$ 格并发动挑战，挑战成功的概率为 $1/4$，故 Alice 的胜率为 $1/4$。\n\n【数据范围】\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 100000$，$1\\le p_i, q_i\\le 333$。", "locale": "zh-CN"}}}
