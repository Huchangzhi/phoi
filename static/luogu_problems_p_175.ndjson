{"pid": "P4539", "type": "P", "difficulty": 5, "samples": [["4 2 3.5\n20 30 50 20", "7.000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2006", "四川", "各省省选", "区间 DP"], "title": "[SCOI2006] zh_tree", "background": null, "description": "张老师根据自己工作的需要，设计了一种特殊的二叉搜索树。\n\n他把这种二叉树起名为 zh_tree，对于具有 $n$ 个结点的 zh_tree，其中序遍历恰好为 $(1,2,3,\\cdots,n)$，其中数字 $1,2,3,\\cdots,n$ 是每个结点的编号。$n$ 个结点恰好对应于一组学术论文中出现的n个不同的单词。\n\n第j个单词在该组论文中出现的次数记为 $d_j$，例如，$d_2=10$表示第 $2$ 个结点所对应的单词在该组论文中出现了10次。设该组论文中出现的单词总数为 S，显然，$S=d_1+d_2+…+d_n$。记 $f_j=\\frac{d_j}{S}$ 为第 j 个单词在该组论文中出现的概率（频率）。 \n\n张老师把根结点深度规定为0，如果第 $j$ 个结点的深度为 $r$，则访问该结点的代价 $h_j$ 为 $h_j=k(r+1)+c$，其中 $k$，$c$ 为已知的不超过 $100$ 的正常数。\n\n则zh_tree是满足以下条件的一棵二叉树：它使 $h_1f_1+h_2f_2+…+h_nf_n$ 达到最小。\n\n我们称上式为访问 zh_tree 的平均代价。 请你根据已知数据为张老师设计一棵 zh_tree。", "inputFormat": "第 $1$ 行：$3$ 个用空格隔开的正数： $n,k,c$ 其中 $n<30$，为整数。$k$，$c$ 为不超过 $100$ 的正实数。 第 $2$ 行：$n$ 个用空格隔开的正整数，为每个单词出现的次数（次数 $<200$）。", "outputFormat": "一行一个正实数，保留 $3$ 位小数，为访问 Zh_tree 的最小平均代价。\n\n----\n\n原题需要构造方案并输出中序遍历。出于各种原因我们决定直接删去第二问以兼容现在的题解与代码。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2006] zh_tree", "background": "", "description": "Teacher Zhang designed a special binary search tree for his work.\n\nHe named this binary tree zh_tree. For a zh_tree with $n$ nodes, its inorder traversal is exactly $(1, 2, 3, \\cdots, n)$, where the numbers $1, 2, 3, \\cdots, n$ are the identifiers of the nodes. The $n$ nodes correspond to $n$ distinct words that appear in a set of academic papers.\n\nLet the $j$-th word appear $d_j$ times; for example, $d_2 = 10$ means that the word corresponding to node $2$ appears $10$ times. Let $S$ be the total number of word occurrences in this set of papers. Obviously, $S = d_1 + d_2 + \\cdots + d_n$. Define $f_j = \\frac{d_j}{S}$ as the probability (frequency) of the $j$-th word.\n\nThe root node has depth $0$. If node $j$ has depth $r$, then its access cost $h_j$ is $h_j = k (r + 1) + c$, where $k$ and $c$ are known positive constants not exceeding $100$.\n\nA zh_tree is a binary tree that minimizes $h_1 f_1 + h_2 f_2 + \\cdots + h_n f_n$.\n\nWe call the expression above the average access cost of the zh_tree. Please design a zh_tree based on the given data.", "inputFormat": "Line 1: Three positive numbers separated by spaces: $n, k, c$, where $n < 30$ is an integer. $k$ and $c$ are positive real numbers not exceeding $100$.\n\nLine 2: $n$ positive integers separated by spaces, the occurrence counts for each word (each count $< 200$).", "outputFormat": "Output one positive real number on a single line, rounded to $3$ decimal places: the minimal average access cost of the zh_tree.", "hint": "The original problem also required constructing the tree and outputting its inorder traversal. For various reasons, we removed that second requirement to keep compatibility with existing solutions and code.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2006] zh_tree", "background": null, "description": "张老师根据自己工作的需要，设计了一种特殊的二叉搜索树。\n\n他把这种二叉树起名为 zh_tree，对于具有 $n$ 个结点的 zh_tree，其中序遍历恰好为 $(1,2,3,\\cdots,n)$，其中数字 $1,2,3,\\cdots,n$ 是每个结点的编号。$n$ 个结点恰好对应于一组学术论文中出现的n个不同的单词。\n\n第j个单词在该组论文中出现的次数记为 $d_j$，例如，$d_2=10$表示第 $2$ 个结点所对应的单词在该组论文中出现了10次。设该组论文中出现的单词总数为 S，显然，$S=d_1+d_2+…+d_n$。记 $f_j=\\frac{d_j}{S}$ 为第 j 个单词在该组论文中出现的概率（频率）。 \n\n张老师把根结点深度规定为0，如果第 $j$ 个结点的深度为 $r$，则访问该结点的代价 $h_j$ 为 $h_j=k(r+1)+c$，其中 $k$，$c$ 为已知的不超过 $100$ 的正常数。\n\n则zh_tree是满足以下条件的一棵二叉树：它使 $h_1f_1+h_2f_2+…+h_nf_n$ 达到最小。\n\n我们称上式为访问 zh_tree 的平均代价。 请你根据已知数据为张老师设计一棵 zh_tree。", "inputFormat": "第 $1$ 行：$3$ 个用空格隔开的正数： $n,k,c$ 其中 $n<30$，为整数。$k$，$c$ 为不超过 $100$ 的正实数。 第 $2$ 行：$n$ 个用空格隔开的正整数，为每个单词出现的次数（次数 $<200$）。", "outputFormat": "一行一个正实数，保留 $3$ 位小数，为访问 Zh_tree 的最小平均代价。\n\n----\n\n原题需要构造方案并输出中序遍历。出于各种原因我们决定直接删去第二问以兼容现在的题解与代码。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P4540", "type": "P", "difficulty": 6, "samples": [["3 5\n2 1 4\n2 2 4\n3 3 4 5\n2 20 1 100 \n1 18 1 200 \n3 28 1 800 \n21 30 3 1500 \n19 21 1 400 ", "1800"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2006", "各省省选", "湖南", "枚举", "排序", "位运算"], "title": "[HNOI2006] 军机调度", "background": "", "description": "凯萨拥有一支由n个人组成的雇佣军，他们靠在威尼斯商行接任务过活。\n\n这支军队的成份比较复杂，不同的人往往具有不同的技能，有的人还拥有多项技能。\n\n威尼斯商行的任务也参差不齐，有的需要几个人合作完成，有的只需要一个人独立完成：有的很简单，不需要耗多少时间，因此报酬也较低，有的很有难度，需要多个人长期合作完成，因此报酬就高。完成这些任务的时间不会超过一个月。并且，一个人不能同时执行两项任务，也不能中途加入或者退出任务。但可以不执行任何任务。\n\n一项只需要n个人来完成的任务，如果执行该任务的人数p大于n,那么反而会得到更少的报酬，即原报酬的1/(p-n+1)。\n\n凯萨是一位英明的领袖，他往往在每个月的月底召开军事会议，总结上个月的成果，发给大家报酬，并指派下个月的任务。\n\n请问，凯萨应该怎样指派任务，才能使总报酬最高？总报酬为多少？", "inputFormat": "一行包含两个正整数n,m。彼此用空格隔开，\n\n其中n〈10表示雇佣军的人数，m〈15表示下个月可选的任务数。\n\n接下来的n行中第i行（对应文件的第i+1行）的第一个整数小于等于表示编号为i的雇佣军可执行的任务数\n\n后面的整数是编号为i的雇佣军可以执行的所有任务的编号，这些整数之间用空格隔开。\n\n最后的m行中，每行有四个整数b、e、p和r，彼此之间用空格隔开，\n\n其中第j行（对应整个文件的第n+j+1行）是编号为j的任务的描述：\n\n0<b<32表示该任务的开始日（这一天会被计入任务所需的时间中），\n\n0<e<32表示该任务的结束日（这一天也会被计入任务所需的时间中），\n\np<10表示该任务所需人数，0<r<100000表示该任务的报酬。", "outputFormat": "第一行只有一个整数t,表示最多可获得的总报酬", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2006] Military Dispatch", "background": "", "description": "Caesar leads a mercenary troop of $n$ people who take jobs from the Venetian Trading House.\n\nThe troop is diverse: different people have different skills, and some have multiple skills.\n\nThe jobs vary a lot. Some require several people to cooperate; some can be done by a single person. Some are simple, take little time, and thus pay less; others are difficult, require many people to work together for a long period, and thus pay more. Each job lasts no more than one month. A person cannot work on two jobs at the same time, and cannot join or leave a job midway. However, a person may stay idle and do no job.\n\nFor a job that requires $p$ people, if the number of assigned people is $x > p$, then the payment becomes the original payment divided by $(x - p + 1)$. If $x < p$, the job cannot be completed. Only people who are capable of a job may be assigned to that job.\n\nCaesar holds a military meeting at the end of each month to summarize the results, pay everyone, and assign the next month’s jobs.\n\nHow should Caesar assign the jobs to maximize the total payment? What is the maximum total payment?", "inputFormat": "- The first line contains two positive integers $n$ and $m$, separated by a space, where $n < 10$ is the number of mercenaries and $m < 15$ is the number of available jobs for the next month.\n- The next $n$ lines describe the capabilities of each mercenary. On line $i$ (corresponding to mercenary $i$), the first integer $k_i$ satisfies $0 \\le k_i \\le m$ and denotes how many jobs mercenary $i$ can perform. It is followed by $k_i$ distinct integers, the IDs of the jobs that mercenary $i$ can perform, separated by spaces.\n- The last $m$ lines describe the jobs. On line $j$ (corresponding to job $j$), there are four integers $b$, $e$, $p$, and $r$, separated by spaces:\n  - $0 < b < 32$: the start day (this day is counted in the job duration),\n  - $0 < e < 32$: the end day (this day is also counted in the job duration),\n  - $p < 10$: the required number of people,\n  - $0 < r < 100000$: the payment for the job.", "outputFormat": "The first line contains a single integer $t$, the maximum total payment that can be obtained.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2006] 军机调度", "background": "", "description": "凯萨拥有一支由n个人组成的雇佣军，他们靠在威尼斯商行接任务过活。\n\n这支军队的成份比较复杂，不同的人往往具有不同的技能，有的人还拥有多项技能。\n\n威尼斯商行的任务也参差不齐，有的需要几个人合作完成，有的只需要一个人独立完成：有的很简单，不需要耗多少时间，因此报酬也较低，有的很有难度，需要多个人长期合作完成，因此报酬就高。完成这些任务的时间不会超过一个月。并且，一个人不能同时执行两项任务，也不能中途加入或者退出任务。但可以不执行任何任务。\n\n一项只需要n个人来完成的任务，如果执行该任务的人数p大于n,那么反而会得到更少的报酬，即原报酬的1/(p-n+1)。\n\n凯萨是一位英明的领袖，他往往在每个月的月底召开军事会议，总结上个月的成果，发给大家报酬，并指派下个月的任务。\n\n请问，凯萨应该怎样指派任务，才能使总报酬最高？总报酬为多少？", "inputFormat": "一行包含两个正整数n,m。彼此用空格隔开，\n\n其中n〈10表示雇佣军的人数，m〈15表示下个月可选的任务数。\n\n接下来的n行中第i行（对应文件的第i+1行）的第一个整数小于等于表示编号为i的雇佣军可执行的任务数\n\n后面的整数是编号为i的雇佣军可以执行的所有任务的编号，这些整数之间用空格隔开。\n\n最后的m行中，每行有四个整数b、e、p和r，彼此之间用空格隔开，\n\n其中第j行（对应整个文件的第n+j+1行）是编号为j的任务的描述：\n\n0<b<32表示该任务的开始日（这一天会被计入任务所需的时间中），\n\n0<e<32表示该任务的结束日（这一天也会被计入任务所需的时间中），\n\np<10表示该任务所需人数，0<r<100000表示该任务的报酬。", "outputFormat": "第一行只有一个整数t,表示最多可获得的总报酬", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4541", "type": "P", "difficulty": 6, "samples": [["1\n1", "0"], ["1\n5", "3"], ["2\n11", "56"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2011", "各省省选", "递归", "浙江", "进制", "Fibonacci 数列", "矩阵乘法"], "title": "[ZJOI2011] 细胞", "background": "", "description": "2222年，人类在银河系外的某颗星球上发现了生命，并且携带了一个细胞回到了地球。经过反复研究，人类已经完全掌握了这类细胞的发展规律：\n\n这种细胞最初的形态是“长条形”，一端是头，一端是尾，中间是躯干。细胞内部含有一列密码（你可以认为它是这种细胞的DNA）。密码是一个长度为n的数字串，且仅含有1~9这9种数字，沿着细胞的躯干从头到尾排列着。\n\n首先，细胞会经历一次分裂。细胞将沿躯干方向分裂成若干个球体，躯干将退化成丝状物，连接着相邻的球体。在分裂过程中，质量是均匀分布的。换句话说，若分裂成k个球体，每个球体的质量为原来的1/k。然而，密码的分布是不确定的。若分割成k个球体，密码会被切割成k段（每段长度至少为1），并按从头到尾的顺序分布在各个球体中。如图，为其中一种合法的一次分裂：\n\n![](https://cdn.luogu.com.cn/upload/pic/18508.png)\n\n接下来，细胞会经历二次分裂。对于每个球体，其中会含有一小段密码（注意他是有序的），我们把它看作一个十进制的数T。这个球体会被分割成T个小球体，并排成一排，之间用躯干退化成的丝状物相连接，并且质量仍然是均匀分布的，每个小球体的质量都是原球体的1/T。至此，密码已经发挥了它的作用，便消失了。如图，为二次分裂：\n\n![](https://cdn.luogu.com.cn/upload/pic/18509.png)\n\n最后，细胞会进行变异。相邻小球体之间的丝状物可能会退化掉，这两个小球体便会以相切的方式直接连接。显然，二次分裂后，除两端外的每个小球体都有两段丝状物与其连接（头尾两端的小球体只有一段丝状物与其相连）。对于每个小球体，必须至少退化一段与其相连的丝状物，否则这个结构不稳定，会继续变异。如图，为一种稳定的变异：\n\n![](https://cdn.luogu.com.cn/upload/pic/18510.png)\n\n现在，我们想知道，对于一个给定密码的细胞，总共有多少种稳定的结构。两种结构被认为相同，当且仅当他们拥有相同个数的小球体，从头到尾每个小球体的质量相同，并且从头到尾每对相邻小球体之间的连接方式相同（都是通过丝状物相连或都是通过相切直接相连）。你只需要回答这个结果 mod 1000000007即可。", "inputFormat": "第一行为一个正整数n，表示细胞密码的长度。\n\n第二行共n个数字，为给定的细胞密码，中间没有空格。", "outputFormat": "只包含一个整数，为细胞的种数 mod 1000000007的结果。", "hint": "对于5%的数据满足，n ≤ 6；\n\n对于25%的数据满足，n ≤ 25；\n\n对于60%的数据满足，n ≤ 100；\n\n对于70%的数据满足，n ≤ 300；\n\n对于100%的数据满足，n ≤ 1 000。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2011] Cell", "background": "", "description": "In the year 2222, humans discovered life on a planet outside the Milky Way and brought back a cell to Earth. After repeated research, humans have fully understood how this type of cell develops:\n\nThe cell initially has a “long strip” shape, with a head at one end and a tail at the other, and a trunk in the middle. Inside the cell there is a sequence of codes (you may think of it as the cell’s DNA). The code is a digit string of length $n$, containing only the 9 digits $1 \\sim 9$, arranged along the trunk from head to tail.\n\nFirst, the cell undergoes a split. The cell splits along the trunk into several spheres, and the trunk degenerates into filaments that connect adjacent spheres. During the split, mass is evenly distributed. In other words, if it splits into $k$ spheres, each sphere has mass $1/k$ of the original. However, the distribution of the code is uncertain. If it is split into $k$ spheres, the code is cut into $k$ segments (each segment has length at least 1), and these segments are placed into the spheres in order from head to tail. The following figure shows one valid split:\n\n![](https://cdn.luogu.com.cn/upload/pic/18508.png)\n\nNext, the cell undergoes a second split. For each sphere, it contains a short segment of the code (note that it is ordered). Treat this segment as a decimal number $T$. This sphere is then divided into $T$ small spheres, arranged in a line, connected by filaments formed from the degenerated trunk, and the mass is still evenly distributed, so each small sphere has mass $1/T$ of the original sphere. At this point, the code has served its purpose and disappears. The following figure shows the second split:\n\n![](https://cdn.luogu.com.cn/upload/pic/18509.png)\n\nFinally, the cell mutates. The filament between two adjacent small spheres may degenerate, and then the two small spheres are directly connected in a tangent way. Clearly, after the second split, each small sphere except the two ends has two filaments connected to it (the small spheres at the head and tail ends have only one filament). For each small sphere, at least one filament connected to it must degenerate; otherwise, the structure is unstable and will continue to mutate. The following figure shows one stable mutation:\n\n![](https://cdn.luogu.com.cn/upload/pic/18510.png)\n\nNow we want to know: for a cell with a given code, how many different stable structures are there in total. Two structures are considered the same if and only if they have the same number of small spheres, from head to tail each small sphere has the same mass, and from head to tail the connection between every pair of adjacent small spheres is the same (either both connected by a filament, or both directly connected tangentially). You only need to output the answer modulo 1000000007.", "inputFormat": "The first line contains a positive integer $n$, indicating the length of the cell code.\n\nThe second line contains $n$ digits, which form the given cell code, with no spaces.", "outputFormat": "Output only one integer, the number of possible structures modulo 1000000007.", "hint": "For 5% of the testdata, $n \\le 6$.\n\nFor 25% of the testdata, $n \\le 25$.\n\nFor 60% of the testdata, $n \\le 100$.\n\nFor 70% of the testdata, $n \\le 300$.\n\nFor 100% of the testdata, $n \\le 1\\,000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2011] 细胞", "background": "", "description": "2222年，人类在银河系外的某颗星球上发现了生命，并且携带了一个细胞回到了地球。经过反复研究，人类已经完全掌握了这类细胞的发展规律：\n\n这种细胞最初的形态是“长条形”，一端是头，一端是尾，中间是躯干。细胞内部含有一列密码（你可以认为它是这种细胞的DNA）。密码是一个长度为n的数字串，且仅含有1~9这9种数字，沿着细胞的躯干从头到尾排列着。\n\n首先，细胞会经历一次分裂。细胞将沿躯干方向分裂成若干个球体，躯干将退化成丝状物，连接着相邻的球体。在分裂过程中，质量是均匀分布的。换句话说，若分裂成k个球体，每个球体的质量为原来的1/k。然而，密码的分布是不确定的。若分割成k个球体，密码会被切割成k段（每段长度至少为1），并按从头到尾的顺序分布在各个球体中。如图，为其中一种合法的一次分裂：\n\n![](https://cdn.luogu.com.cn/upload/pic/18508.png)\n\n接下来，细胞会经历二次分裂。对于每个球体，其中会含有一小段密码（注意他是有序的），我们把它看作一个十进制的数T。这个球体会被分割成T个小球体，并排成一排，之间用躯干退化成的丝状物相连接，并且质量仍然是均匀分布的，每个小球体的质量都是原球体的1/T。至此，密码已经发挥了它的作用，便消失了。如图，为二次分裂：\n\n![](https://cdn.luogu.com.cn/upload/pic/18509.png)\n\n最后，细胞会进行变异。相邻小球体之间的丝状物可能会退化掉，这两个小球体便会以相切的方式直接连接。显然，二次分裂后，除两端外的每个小球体都有两段丝状物与其连接（头尾两端的小球体只有一段丝状物与其相连）。对于每个小球体，必须至少退化一段与其相连的丝状物，否则这个结构不稳定，会继续变异。如图，为一种稳定的变异：\n\n![](https://cdn.luogu.com.cn/upload/pic/18510.png)\n\n现在，我们想知道，对于一个给定密码的细胞，总共有多少种稳定的结构。两种结构被认为相同，当且仅当他们拥有相同个数的小球体，从头到尾每个小球体的质量相同，并且从头到尾每对相邻小球体之间的连接方式相同（都是通过丝状物相连或都是通过相切直接相连）。你只需要回答这个结果 mod 1000000007即可。", "inputFormat": "第一行为一个正整数n，表示细胞密码的长度。\n\n第二行共n个数字，为给定的细胞密码，中间没有空格。", "outputFormat": "只包含一个整数，为细胞的种数 mod 1000000007的结果。", "hint": "对于5%的数据满足，n ≤ 6；\n\n对于25%的数据满足，n ≤ 25；\n\n对于60%的数据满足，n ≤ 100；\n\n对于70%的数据满足，n ≤ 300；\n\n对于100%的数据满足，n ≤ 1 000。", "locale": "zh-CN"}}}
{"pid": "P4542", "type": "P", "difficulty": 7, "samples": [["3 4 2\n0 1 1\n1 2 1\n2 3 100\n0 3 1", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2011", "各省省选", "浙江", "图论建模", "最短路", "费用流"], "title": "[ZJOI2011] 营救皮卡丘", "background": null, "description": "皮卡丘被火箭队用邪恶的计谋抢走了！这三个坏家伙还给小智留下了赤果果的挑衅！为了皮卡丘，也为了正义，小智和他的朋友们义不容辞的踏上了营救皮卡丘的道路。\n\n火箭队一共有 $N$ 个据点，据点之间存在 $M$ 条双向道路。据点分别从 $1$ 到 $N$ 标号。小智一行 $K$ 人从真新镇出发，营救被困在 $N$ 号据点的皮卡丘。为了方便起见，我们将真新镇视为 $0$ 号据点，一开始 $K$ 个人都在 $0$ 号点。\n\n由于火箭队的重重布防，对于任意 $2\\le X\\le N$，要想摧毁 $X$ 号据点，必须按照顺序先摧毁 $1$ 到 $X-1$ 号据点，并且，如果 $X-1$ 号据点没有被摧毁，由于防御的连锁性，小智一行任何一个人进入据点 $X$，都会被发现，并产生严重后果。因此，在$X-1$号据点被摧毁之前，任何人是不能够经过 $X$ 号据点的。\n\n为了简化问题，我们忽略战斗环节，小智一行任何一个人经过 $K$ 号据点即认为 $K$ 号据点被摧毁。被摧毁的据点依然是可以被经过的。\n\n$K$ 个人是可以分头行动的，只要有任何一个人在 $K-1$ 号据点被摧毁之后，经过 $K$ 号据点，$K$ 号据点就被摧毁了。显然的，只要 $N$ 号据点被摧毁，皮卡丘就得救了。\n\n野外的道路是不安全的，因此小智一行希望在摧毁 $N$ 号据点救出皮卡丘的同时，使得 $K$ 个人所经过的道路的长度总和最少。\n\n请你帮助小智设计一个最佳的营救方案吧！", "inputFormat": "第一行包含三个正整数 $N,M,K$。表示一共有 $N+1$ 个点，分别从 $0$ 到 $N$ 编号，以及 $M$ 条无向边。一开始小智一行共 $K$ 个人均位于 $0$ 号点。 \n\n接下来 $M$ 行，每行三个非负整数，第 $i$ 行的整数为 $A_i$，$B_i$，$L_i$。表示存在一条从 $A_i$ 号据点到 $B_i$ 号据点的长度为 $L_i$ 的道路。", "outputFormat": "仅包含一个整数 $S$，为营救皮卡丘所需要经过的最小的道路总和。", "hint": "【样例说明】\n\n小智和小霞一起前去营救皮卡丘。在最优方案中，小智先从真新镇前往 $1$ 号点，接着前往 $2$ 号据点。当小智成功摧毁 $2$ 号据点之后，小霞从真新镇出发直接前往 $3$ 号据点，救出皮卡丘。\n\n对于 $100\\%$ 的数据满足 $N\\le 150, M \\le 20 000, 1 \\le K \\le 10, L_i \\le 10 000$, 保证小智一行一定能够救出皮卡丘。\n\n至于为什么 $K \\le 10$，你可以认为最终在小智的号召下，小智，小霞，小刚，小建，小遥，小胜，小光，艾莉丝，天桐，还有去日本旅游的黑猫警长，一同前去大战火箭队。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2011] Rescue Pikachu", "background": "", "description": "Pikachu has been taken away by Team Rocket using an evil scheme. Those three bad guys also left Ash with an open provocation. For Pikachu, and for justice, Ash and his friends set off without hesitation on the road to rescue Pikachu.\n\nTeam Rocket has a total of $N$ bases, and there are $M$ bidirectional roads between the bases. The bases are numbered from $1$ to $N$. Ash’s team has $K$ people. They start from Pallet Town and plan to rescue Pikachu trapped in base $N$. For convenience, we treat Pallet Town as base $0$. At the beginning, all $K$ people are at node $0$.\n\nDue to Team Rocket’s heavy defenses, for any $2\\le X\\le N$, to destroy base $X$, one must first destroy bases $1$ to $X-1$ in order. Moreover, if base $X-1$ has not been destroyed, then because of chained defenses, once any member of Ash’s team enters base $X$, they will be discovered and serious consequences will occur. Therefore, before base $X-1$ is destroyed, no one can pass through base $X$.\n\nTo simplify the problem, we ignore fighting. If any member of Ash’s team passes through base $K$, then base $K$ is considered destroyed. A destroyed base can still be passed through.\n\nThe $K$ people may act separately. As long as after base $K-1$ is destroyed, any one person passes through base $K$, then base $K$ is destroyed. Obviously, once base $N$ is destroyed, Pikachu is rescued.\n\nThe roads in the wild are unsafe, so while destroying base $N$ to rescue Pikachu, Ash’s team wants the total length of roads traveled by all $K$ people to be as small as possible.\n\nPlease help Ash design the best rescue plan.", "inputFormat": "The first line contains three positive integers $N,M,K$. This means there are $N+1$ nodes numbered from $0$ to $N$, and $M$ undirected edges. At the beginning, Ash’s team has $K$ people, all located at node $0$.\n\nThe next $M$ lines each contain three non-negative integers. On the $i$-th line, the integers are $A_i$, $B_i$, $L_i$, meaning there is a road of length $L_i$ between base $A_i$ and base $B_i$.", "outputFormat": "Output only one integer $S$, the minimum total road length required to rescue Pikachu.", "hint": "[Sample Explanation]\n\nAsh and Misty go to rescue Pikachu together. In the optimal plan, Ash first goes from Pallet Town to node $1$, then goes to base $2$. After Ash successfully destroys base $2$, Misty sets off from Pallet Town and goes directly to base $3$, rescuing Pikachu.\n\nFor $100\\%$ of the testdata, it holds that $N\\le 150, M \\le 20 000, 1 \\le K \\le 10, L_i \\le 10 000$. It is guaranteed that Ash’s team can rescue Pikachu.\n\nAs for why $K \\le 10$, you may assume that in the end, under Ash’s call, Ash, Misty, Brock, Tracey, May, Max, Dawn, Iris, Cilan, and also Officer Black Cat who is traveling in Japan, all go together to fight Team Rocket.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2011] 营救皮卡丘", "background": null, "description": "皮卡丘被火箭队用邪恶的计谋抢走了！这三个坏家伙还给小智留下了赤果果的挑衅！为了皮卡丘，也为了正义，小智和他的朋友们义不容辞的踏上了营救皮卡丘的道路。\n\n火箭队一共有 $N$ 个据点，据点之间存在 $M$ 条双向道路。据点分别从 $1$ 到 $N$ 标号。小智一行 $K$ 人从真新镇出发，营救被困在 $N$ 号据点的皮卡丘。为了方便起见，我们将真新镇视为 $0$ 号据点，一开始 $K$ 个人都在 $0$ 号点。\n\n由于火箭队的重重布防，对于任意 $2\\le X\\le N$，要想摧毁 $X$ 号据点，必须按照顺序先摧毁 $1$ 到 $X-1$ 号据点，并且，如果 $X-1$ 号据点没有被摧毁，由于防御的连锁性，小智一行任何一个人进入据点 $X$，都会被发现，并产生严重后果。因此，在$X-1$号据点被摧毁之前，任何人是不能够经过 $X$ 号据点的。\n\n为了简化问题，我们忽略战斗环节，小智一行任何一个人经过 $K$ 号据点即认为 $K$ 号据点被摧毁。被摧毁的据点依然是可以被经过的。\n\n$K$ 个人是可以分头行动的，只要有任何一个人在 $K-1$ 号据点被摧毁之后，经过 $K$ 号据点，$K$ 号据点就被摧毁了。显然的，只要 $N$ 号据点被摧毁，皮卡丘就得救了。\n\n野外的道路是不安全的，因此小智一行希望在摧毁 $N$ 号据点救出皮卡丘的同时，使得 $K$ 个人所经过的道路的长度总和最少。\n\n请你帮助小智设计一个最佳的营救方案吧！", "inputFormat": "第一行包含三个正整数 $N,M,K$。表示一共有 $N+1$ 个点，分别从 $0$ 到 $N$ 编号，以及 $M$ 条无向边。一开始小智一行共 $K$ 个人均位于 $0$ 号点。 \n\n接下来 $M$ 行，每行三个非负整数，第 $i$ 行的整数为 $A_i$，$B_i$，$L_i$。表示存在一条从 $A_i$ 号据点到 $B_i$ 号据点的长度为 $L_i$ 的道路。", "outputFormat": "仅包含一个整数 $S$，为营救皮卡丘所需要经过的最小的道路总和。", "hint": "【样例说明】\n\n小智和小霞一起前去营救皮卡丘。在最优方案中，小智先从真新镇前往 $1$ 号点，接着前往 $2$ 号据点。当小智成功摧毁 $2$ 号据点之后，小霞从真新镇出发直接前往 $3$ 号据点，救出皮卡丘。\n\n对于 $100\\%$ 的数据满足 $N\\le 150, M \\le 20 000, 1 \\le K \\le 10, L_i \\le 10 000$, 保证小智一行一定能够救出皮卡丘。\n\n至于为什么 $K \\le 10$，你可以认为最终在小智的号召下，小智，小霞，小刚，小建，小遥，小胜，小光，艾莉丝，天桐，还有去日本旅游的黑猫警长，一同前去大战火箭队。", "locale": "zh-CN"}}}
{"pid": "P4543", "type": "P", "difficulty": 6, "samples": [["4 4 4 1 5\n12 9 6 6 11\n0", "0.800000\n0.683938"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2011", "各省省选", "江苏"], "title": "[JSOI2011] Apple 的美食", "background": "", "description": "Apple 很喜欢吃巧克力，但它是一头挑剔的猪，有的品种的巧克力并不能满足它的胃口。如果主人给它的巧克力它不喜欢吃，它就会很不开心。主人并不知道，什么样的巧克力 Apple 喜欢吃，但她知道巧克力的可可含量是巧克力\n口感的重要因素，因此她决定根据巧克力的可可含量来判断什么样的巧克力拿给 Apple 吃，什么样的巧克力不拿给 Apple 吃。\n\n假设一块巧克力的可可含量有 $1\\sim N$ 种不同的计量，则她认为可可含量在 $[a,b]$ 的范围内的巧克力是好吃的\n。不过她不知道的这个范围到底是多少，需要你来帮忙确定这个范围，使得她可以让 Apple 吃到最多的喜欢吃的巧克力。\n\n设 $pos_i$ 是可可脂含量为 $i$，且 Apple 认为是好吃的巧克力的数量，$neg_i$ 是可可脂含量为 $i$，且 Apple 认为是不好吃的巧克力的数量。这两个序列由以下方法生成：\n$$\\begin{cases}pos_i=a_{2i-1}\\\\neg_i=a_{2i}\\end{cases}$$\n\n其中，$a_i=(p_1a_{i-1}+p_2)\\bmod M(i>1)$。\n\n设 $TP$ 是 Apple 认为好吃的、且被主人认为是好吃的巧克力数量，$TN$ 是Apple 认为不好吃的、且被主人认为是不好吃的巧克力数量，$FP$ 是 Apple 认为不好吃的、且被主人认为是好吃的巧克力数量，$FN$ 是 Apple 认为好吃的、且被主人认为是不好吃的巧克力数量。\n\n设 $r$ 为被正确判断为好吃的巧克力数占所有好吃的巧克力的比率，$p$ 为被正确判断为好吃的巧克力占所有被判定为好吃的巧克力数的比率，则\n\n$$\\begin{cases}r=\\frac{TP}{TP+FN}\\\\p=\\frac{TP}{TP+FP}\\end{cases}$$\n\n请你帮助 Apple 求出一个范围，使得 $f=\\frac{2pr}{p+r}$ 最大。", "inputFormat": "输入由若干行组成，每行是一组数据：$N,a_1,p_1,p_2,M$，中间用空格分开。\n\n输入以一个 $0$ 结束，数据组数不超过 $1000$。", "outputFormat": "每组数据输出一行，为 $f$ 的最大值（四舍五入保留 $6$ 位小数）。", "hint": "### 数据范围\n\n对于 $100\\%$ 的数据，$1\\leq N\\leq 10^6,a_1,p_1,p_2<M\\leq 20$，保证至少有一块 Apple 认为好吃的巧克力。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2011] Apple 的美食", "background": "", "description": "Apple 很喜欢吃巧克力，但它是一头挑剔的猪，有的品种的巧克力并不能满足它的胃口。如果主人给它的巧克力它不喜欢吃，它就会很不开心。主人并不知道，什么样的巧克力 Apple 喜欢吃，但她知道巧克力的可可含量是巧克力\n口感的重要因素，因此她决定根据巧克力的可可含量来判断什么样的巧克力拿给 Apple 吃，什么样的巧克力不拿给 Apple 吃。\n\n假设一块巧克力的可可含量有 $1\\sim N$ 种不同的计量，则她认为可可含量在 $[a,b]$ 的范围内的巧克力是好吃的\n。不过她不知道的这个范围到底是多少，需要你来帮忙确定这个范围，使得她可以让 Apple 吃到最多的喜欢吃的巧克力。\n\n设 $pos_i$ 是可可脂含量为 $i$，且 Apple 认为是好吃的巧克力的数量，$neg_i$ 是可可脂含量为 $i$，且 Apple 认为是不好吃的巧克力的数量。这两个序列由以下方法生成：\n$$\\begin{cases}pos_i=a_{2i-1}\\\\neg_i=a_{2i}\\end{cases}$$\n\n其中，$a_i=(p_1a_{i-1}+p_2)\\bmod M(i>1)$。\n\n设 $TP$ 是 Apple 认为好吃的、且被主人认为是好吃的巧克力数量，$TN$ 是Apple 认为不好吃的、且被主人认为是不好吃的巧克力数量，$FP$ 是 Apple 认为不好吃的、且被主人认为是好吃的巧克力数量，$FN$ 是 Apple 认为好吃的、且被主人认为是不好吃的巧克力数量。\n\n设 $r$ 为被正确判断为好吃的巧克力数占所有好吃的巧克力的比率，$p$ 为被正确判断为好吃的巧克力占所有被判定为好吃的巧克力数的比率，则\n\n$$\\begin{cases}r=\\frac{TP}{TP+FN}\\\\p=\\frac{TP}{TP+FP}\\end{cases}$$\n\n请你帮助 Apple 求出一个范围，使得 $f=\\frac{2pr}{p+r}$ 最大。", "inputFormat": "输入由若干行组成，每行是一组数据：$N,a_1,p_1,p_2,M$，中间用空格分开。\n\n输入以一个 $0$ 结束，数据组数不超过 $1000$。", "outputFormat": "每组数据输出一行，为 $f$ 的最大值（四舍五入保留 $6$ 位小数）。", "hint": "### 数据范围\n\n对于 $100\\%$ 的数据，$1\\leq N\\leq 10^6,a_1,p_1,p_2<M\\leq 20$，保证至少有一块 Apple 认为好吃的巧克力。", "locale": "zh-CN"}}}
{"pid": "P4544", "type": "P", "difficulty": 5, "samples": [["2 5 3\n3 1 2\n4 1 2\n1 1 1", "9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2010", "USACO", "单调队列", "背包 DP", "队列"], "title": "[USACO10NOV] Buying Feed G", "background": "", "description": "约翰开车来到镇上，他要带$K$吨饲料回家。运送饲料是需要花钱的，如果他的车上有$X$吨饲料，每公里就要花费$X^2$元，开车D公里就需要$D\\times  X^2$元。约翰可以从$N$家商店购买饲料，所有商店都在一个坐标轴上，第$i$家店的位置是$X_i$，饲料的售价为每吨$C_i$元，库存为$F_i$。\n\n约翰从坐标$X=0$开始沿坐标轴正方向前进，他家在坐标$X=E$上。为了带$K$吨饲料回家，约翰最少的花费是多少呢？假设所有商店的库存之和不会少于$K$。\n\n举个例子，假设有三家商店，情况如下所示：\n\n|坐标|$X=1$|$X=3$|$X=4$|$E=5$|\n|:-:|:-:|:-:|:-:|:-:|\n|库存|$1$|$1$|$1$|\n|售价|$1$|$2$|$2$|\n\n如果$K=2$，约翰的最优选择是在离家较近的两家商店购买饲料，则花在路上的钱是$1+4=5$，花在商店的钱是$2+2=4$，共需要$9$元。", "inputFormat": "第$1$行:三个整数$K,E,N$ 第$2..N+1$行:第$i+1$行的三个整数代表,$X_i,F_i,C_i$.", "outputFormat": "一个整数,代表最小花费", "hint": "$1 \\leq K \\leq 10000 , 1 \\leq E \\leq 500 , 1 \\leq N \\leq 500$\n\n$0 < Xi < E, 1 \\leq Fi \\leq 10000, 1 \\leq C_i \\leq 10^7$", "locale": "zh-CN", "translations": {"en": {"title": "[USACO10NOV] Buying Feed G", "background": "", "description": "John drives to town and wants to bring back $K$ tons of feed. Transporting feed costs money: if his car currently carries $X$ tons, the cost per kilometer is $X^2$ yuan, so driving $D$ kilometers costs $D\\times  X^2$ yuan. John can buy feed from $N$ stores, all located on a number line. Store $i$ is at position $X_i$, sells feed at $C_i$ yuan per ton, and has $F_i$ tons in stock.\n\nJohn starts at $X=0$ and travels in the positive direction along the axis. His home is at $X=E$. What is the minimum total cost for John to bring $K$ tons of feed home? Assume the sum of all stores’ stocks is at least $K$.\n\nFor example, suppose there are three stores as shown below:\n\n|Coordinate|$X=1$|$X=3$|$X=4$|$E=5$|\n|:-:|:-:|:-:|:-:|:-:|\n|Stock|$1$|$1$|$1$|\n|Price|$1$|$2$|$2$|\n\nIf $K=2$, John’s optimal choice is to buy from the two stores closer to home. The money spent on the road is $1+4=5$, the money spent at the stores is $2+2=4$, for a total of $9$ yuan.", "inputFormat": "The first line contains three integers $K$, $E$, $N$.\n\nLines $2$ to $N+1$: line $i+1$ contains three integers $X_i$, $F_i$, $C_i$.", "outputFormat": "Output a single integer, the minimum total cost.", "hint": "Constraints\n\n$1 \\leq K \\leq 10000$, $1 \\leq E \\leq 500$, $1 \\leq N \\leq 500$.\n\n$0 < X_i < E$, $1 \\leq F_i \\leq 10000$, $1 \\leq C_i \\leq 10^7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO10NOV] Buying Feed G", "background": "", "description": "约翰开车来到镇上，他要带$K$吨饲料回家。运送饲料是需要花钱的，如果他的车上有$X$吨饲料，每公里就要花费$X^2$元，开车D公里就需要$D\\times  X^2$元。约翰可以从$N$家商店购买饲料，所有商店都在一个坐标轴上，第$i$家店的位置是$X_i$，饲料的售价为每吨$C_i$元，库存为$F_i$。\n\n约翰从坐标$X=0$开始沿坐标轴正方向前进，他家在坐标$X=E$上。为了带$K$吨饲料回家，约翰最少的花费是多少呢？假设所有商店的库存之和不会少于$K$。\n\n举个例子，假设有三家商店，情况如下所示：\n\n|坐标|$X=1$|$X=3$|$X=4$|$E=5$|\n|:-:|:-:|:-:|:-:|:-:|\n|库存|$1$|$1$|$1$|\n|售价|$1$|$2$|$2$|\n\n如果$K=2$，约翰的最优选择是在离家较近的两家商店购买饲料，则花在路上的钱是$1+4=5$，花在商店的钱是$2+2=4$，共需要$9$元。", "inputFormat": "第$1$行:三个整数$K,E,N$ 第$2..N+1$行:第$i+1$行的三个整数代表,$X_i,F_i,C_i$.", "outputFormat": "一个整数,代表最小花费", "hint": "$1 \\leq K \\leq 10000 , 1 \\leq E \\leq 500 , 1 \\leq N \\leq 500$\n\n$0 < Xi < E, 1 \\leq Fi \\leq 10000, 1 \\leq C_i \\leq 10^7$", "locale": "zh-CN"}}}
{"pid": "P4545", "type": "P", "difficulty": 0, "samples": [["2 150.0000 1000.0000\n-60 165 50 165 0\n110 25 130 120 1\n-205 360 275 360", "0.7443"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2013", "各省省选", "江苏"], "title": "[JSOI2013] 投影面积", "background": "", "description": "为了简单期间，投影屏幕对应二维平面中的一条平行与 $x$ 轴，连接点 $(x_1^s,y^s)$ 和点 $(x_2^s,y^s)$ 的线段。\n\nJYY 的投影仪位于原点，朝向 $y$ 轴正方向，发出对称于 $y$ 轴并且张角度数为 $ang$ 的光束（$ang$ 是角度制），如图所示（粗线条为投影屏幕，黄色区域为投影仪射出的光束）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ate0zcyz.png)\n\n实验室内一共有 $n$ 的障碍物，每个障碍物都对应于二维平面中的一条线段（我们认为这些障碍物的厚度为 $0$）。\n\n有一些障碍物是不能反光的，因此光线只要射到这些线段上，就会被完全吸收（比如投影屏幕就是不会反光的）；其他障碍物则是双面可以反光的，光线如果射到这些线段上，就会按照基本光学原理进行反射。\n\n所有的障碍物都相互不接触，并且也不会与投影屏幕，或者坐标原点接触。\n\n光线在空气中传播会有损耗，因此在 JYY 的实验室中，光线在传播了 $len$ 的距离之后，就会消失。\n\n现在 JYY 想知道，投影屏幕上被照亮的区域占投影屏幕总长度的比率。", "inputFormat": "第一行一个正整数和两个正实数，为 $N,ang,len$。\n\n接下来 $n$ 行，每行 $5$ 个整数 $x_1,x_2,y_1,y_2,r$，表示 JYY 的实验室内存在一个连接点 $(x_1,y_1)$ 和点 $(x_2,y_2)$ 的障碍物，$r$ 为 $0$ 或者 $1$。当 $r=0$ 时表示这个障碍物不反光，$r=1$ 则表示这个障碍物双面反光。\n\n接下来一行四个整数 $x_1^s,y^s,x_2^s,y^s$，表示投影屏幕的位置，保证第二个和第四个整数相同。", "outputFormat": "一行一个 $0$ 到 $1$ 之间的实数，表示屏幕上被照亮部分的长度与屏幕总长的比值，结果精确到小数点后 $4$ 位。", "hint": "### 样例解释 1\n\n如图。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/k09d8sjd.png)\n\n### 数据范围\n\n对于 $100\\%$ 的数据，$0\\leq n\\leq 10,0<ang\\leq 150,0<len\\leq 10^3$，任意输入坐标绝对值不超过 $10^3$。\n\n输入数据保证 $y^s>0,x_1^s<x_2^s$，并且对于任意障碍物满足 $\\vert y_2\\vert<y^s$。\n\n输入数据还保证对于一条光线在消失或被吸收之前至多反射 $30$ 次。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2013] 投影面积", "background": "", "description": "为了简单期间，投影屏幕对应二维平面中的一条平行与 $x$ 轴，连接点 $(x_1^s,y^s)$ 和点 $(x_2^s,y^s)$ 的线段。\n\nJYY 的投影仪位于原点，朝向 $y$ 轴正方向，发出对称于 $y$ 轴并且张角度数为 $ang$ 的光束（$ang$ 是角度制），如图所示（粗线条为投影屏幕，黄色区域为投影仪射出的光束）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ate0zcyz.png)\n\n实验室内一共有 $n$ 的障碍物，每个障碍物都对应于二维平面中的一条线段（我们认为这些障碍物的厚度为 $0$）。\n\n有一些障碍物是不能反光的，因此光线只要射到这些线段上，就会被完全吸收（比如投影屏幕就是不会反光的）；其他障碍物则是双面可以反光的，光线如果射到这些线段上，就会按照基本光学原理进行反射。\n\n所有的障碍物都相互不接触，并且也不会与投影屏幕，或者坐标原点接触。\n\n光线在空气中传播会有损耗，因此在 JYY 的实验室中，光线在传播了 $len$ 的距离之后，就会消失。\n\n现在 JYY 想知道，投影屏幕上被照亮的区域占投影屏幕总长度的比率。", "inputFormat": "第一行一个正整数和两个正实数，为 $N,ang,len$。\n\n接下来 $n$ 行，每行 $5$ 个整数 $x_1,x_2,y_1,y_2,r$，表示 JYY 的实验室内存在一个连接点 $(x_1,y_1)$ 和点 $(x_2,y_2)$ 的障碍物，$r$ 为 $0$ 或者 $1$。当 $r=0$ 时表示这个障碍物不反光，$r=1$ 则表示这个障碍物双面反光。\n\n接下来一行四个整数 $x_1^s,y^s,x_2^s,y^s$，表示投影屏幕的位置，保证第二个和第四个整数相同。", "outputFormat": "一行一个 $0$ 到 $1$ 之间的实数，表示屏幕上被照亮部分的长度与屏幕总长的比值，结果精确到小数点后 $4$ 位。", "hint": "### 样例解释 1\n\n如图。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/k09d8sjd.png)\n\n### 数据范围\n\n对于 $100\\%$ 的数据，$0\\leq n\\leq 10,0<ang\\leq 150,0<len\\leq 10^3$，任意输入坐标绝对值不超过 $10^3$。\n\n输入数据保证 $y^s>0,x_1^s<x_2^s$，并且对于任意障碍物满足 $\\vert y_2\\vert<y^s$。\n\n输入数据还保证对于一条光线在消失或被吸收之前至多反射 $30$ 次。", "locale": "zh-CN"}}}
{"pid": "P4546", "type": "P", "difficulty": 7, "samples": [["3 7 C1\n1 1 0\n3 0.5 0.5\n3 -0.5 0.7\nappear 0 1\ntravel 0 1 0.3\nappear 0 2\ntravel 1 2 0.5\ndisappear 0 1\nappear 1 2\ntravel 1 2 0.5", "9.45520207e-001\n1.67942554e+000\n1.20000000e+000"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2017", "Special Judge", "THUWC"], "title": "[THUWC 2017] 在美妙的数学王国中畅游", "background": "数字和数学规律主宰着这个世界。\n\n机器的运转，\n\n生命的消长，\n\n宇宙的进程，\n\n这些神秘而又美妙的过程无不可以用数学的语言展现出来。\n\n这印证了一句古老的名言：\n\n“学好数理化，走遍天下都不怕。”", "description": "学渣小R 被大学的数学课程虐得生活不能自理，微积分的成绩曾是他在教室里上的课的最低分。然而他的某位陈姓室友却能轻松地在数学考试中得到满分。为了提升自己的数学课成绩，有一天晚上（在他睡觉的时候），他来到了数学王国。\n\n数学王国中，每个人的智商可以用一个属于 $ [0,1]$ 的实数表示。数学王国中有 $n$ 个城市，编号从 $0 \\sim n-1$，这些城市由若干座魔法桥连接。每个城市的中心都有一个魔法球，每个魔法球中藏有一道数学题。\n\n每个人在做完这道数学题之后都会得到一个在 $[0,1]$ 内的分数。一道题可以用一个函数 $f(x)$ 表示。若一个人的智商为 $x$，则他做完这道数学题之后会得到 $f(x)$ 分。有三种形式：\n\n-  正弦函数 $f(x)=\\sin(a x + b)\\ (a \\in [0,1], b \\in [0,\\pi],a+b\\in[0,\\pi])$   \n-  指数函数 $f(x)=\\text e^{ax+b}\\ (a\\in [-1,1], b\\in [-2,0], a+b\\in [-2,0])$   \n-  一次函数 $f(x) = ax + b\\ (a\\in [-1,1],b\\in[0,1],a+b\\in [0,1])$    \n\n数学王国中的魔法桥会发生变化，有时会有一座魔法桥消失，有时会有一座魔法桥出现。但在任意时刻，只存在至多一条连接任意两个城市的简单路径（即所有城市形成一个森林）。在初始情况下，数学王国中不存在任何的魔法桥。\n\n数学王国的国王拉格朗日很乐意传授小R 数学知识，但前提是小R 要先回答国王的问题。这些问题具有相同的形式，即一个智商为 $x$ 的人从城市 $u$ 旅行到城市 $v$（即经过 $u \\to v$ 这条路径上的所有城市，包括 $u$ 和 $v$）且做了所有城市内的数学题后，他所有得分的总和是多少。", "inputFormat": "第一行两个正整数 $n,m$ 和一个字符串 $type$。表示数学王国中共有 $n$ 座城市，发生了 $m$ 个事件，该数据的类型为 $type$。\n\n$type$ 字符串是为了能让大家更方便地获得部分分，你可能不需要用到这个输入。其具体含义在 **【限制与约定】** 中有解释。\n\n接下来 $n$ 行，第 $i$ 行表示初始情况下编号为 $i$ 的城市的魔法球中的函数。一个魔法用一个整数 $f$ 表示函数的类型，两个实数 $a,b$ 表示函数的参数，若\n\n- $f=1$，则函数为 $f(x)=\\sin(ax+b)$\n- $f=2$，则函数为 $f(x)=\\text e^{ax+b}$\n- $f=3$，则函数为 $f(x)=ax+b$\n\n接下来 $m$ 行，每行描述一个事件，事件分为四类。\n\n- `appear u v` 表示数学王国中出现了一条连接 $u$ 和 $v$ 这两座城市的魔法，保证连接前 $u,v$ 这两座城市不能互相到达。\n\n- `disappear u v` 表示数学王国中连接 $u,v$ 这两座城市的魔法桥消失了，保证这座魔法桥是存在的。\n\n- `magic c f a b` 表示城市 $c$ 的魔法球中的魔法变成了类型为 $f$，参数为 $a,b$ 的函数\n\n- `travel u v x` 表示询问一个智商为 $x$ 的人从城市 $u$ 旅行到城市 $v$ 后，他得分的总和是多少。若无法从 $u$ 到达 $v$，则输出一行一个字符串 `unreachable`。", "outputFormat": "对于每个询问，输出一行实数，表示得分的总和。", "hint": "【限制与约定】  \n对于 $100\\%$ 的数据，$1\\le n\\le 10^5, 1\\le m \\le 2 \\times 10^5$ 。\n\n本题共有 20 个数据点，每个数据点 5 分。\n\n测试点|$n$|$m$|数据类型\n:-:|:-:|:-:|:-:|\n$1$|$\\leq 100$|$\\leq 200$|C1\n$2 \\sim 5$|$\\leq 10^5$|$\\leq 2 \\times 10^5$|A0\n$6$|$\\leq 10^5$|$\\leq 2 \\times 10^5$|B0\n$7 \\sim 8$|$\\leq 10^5$|$\\leq 2 \\times 10^5$|D0\n$9 \\sim 14$|$\\leq 10^5$|$\\leq 2 \\times 10^5$|A1\n$15 \\sim 17$|$\\leq 10^5$|$\\leq 2 \\times 10^5$|C1\n$18 \\sim 20$|$\\leq 10^5$|$\\leq 2 \\times 10^5$|D1\n\n数据类型的含义：\n\nA：不存在 `disappear` 事件，且所有`appear`事件中的 $u=v-1$\n\nB：不存在 `disappear` 事件\n\nC：所有的 `travel` 事件经过的城市总数 $\\le 5 \\times 10^6$（不可到达的城市对不计入在内）\n\nD：无限制\n\n0：所有 `travel` 事件中，$x=1$（即所有人的智商均为 $1$）\n\n1：无限制\n\n\n\n【评分标准】  \n\n如果你的答案与标准答案的相对误差在 $10^{-7}$ 以内或绝对误差在 $10^{-7}$ 以内，则被判定为正确。\n\n如果你的所有答案均为正确，则得满分，否则得 0 分。\n\n请注意输出格式：每行输出一个答案，答案只能为 `unreachable` 或者一个实数（建议使用科学计数法表示）。每行的长度不得超过 50。错误输出格式会被判定为 0 分。\n\n\n\n【小R 教你学数学】\n\n若函数 $f(x)$ 的 $n$ 阶导数在 $[a,b]$ 区间内连续，则对 $f(x)$ 在 $x_0 \\ (x_0\\in[a,b])$ 处使用 $n$ 次拉格朗日中值定理可以得到带拉格朗日余项的泰勒展开式\n\n$$f(x)=\\sum_{k=0}^{n-1}\\frac{f^{(k)}(x_0)(x-x_0)^k}{k!}+\\frac{f^{(n)}(\\xi)(x-x_0)^n}{n!},x\\in[a,b]$$\n\n其中，当 $x>x_0$ 时，$\\xi\\in[x_0,x]$。当 $x<x_0$ 时，$\\xi\\in[x,x_0]$。\n\n$f^{(n)}$ 表示函数 $f$ 的 $n$ 阶导数", "locale": "zh-CN", "translations": {"en": {"title": "[THUWC 2017] Roam in the Wonderful Kingdom of Mathematics", "background": "Numbers and mathematical laws rule this world.\n\nThe operation of machines,\n\nthe waxing and waning of life,\n\nthe progress of the universe—\n\nall these mysterious and wonderful processes can be expressed in the language of mathematics.\n\nThis confirms an ancient saying:\n\n“Master math, physics, and chemistry, and you can go anywhere without fear.”", "description": "The underachiever Xiao R (pinyin) was tortured by university mathematics courses to the point of being unable to take care of himself. His calculus score was once the lowest among all the courses he took in the classroom. However, one of his roommates surnamed Chen could easily get full marks in math exams. To improve his math grades, one night (in his sleep), he arrived at the Kingdom of Mathematics.\n\nIn the Kingdom of Mathematics, everyone’s IQ is represented by a real number in $ [0,1]$. There are $n$ cities numbered from $0 \\sim n-1$, connected by several magic bridges. At the center of each city there is a magic orb, and inside each magic orb lies a math problem.\n\nAfter solving this problem, everyone will receive a score in $[0,1]$. A problem can be represented by a function $f(x)$. If a person’s IQ is $x$, then after solving this problem he will receive $f(x)$ points. There are three forms:\n\n- Sine function $f(x)=\\sin(a x + b)\\ (a \\in [0,1], b \\in [0,\\pi],a+b\\in[0,\\pi])$.\n- Exponential function $f(x)=\\text e^{ax+b}\\ (a\\in [-1,1], b\\in [-2,0], a+b\\in [-2,0])$.\n- Linear function $f(x) = ax + b\\ (a\\in [-1,1],b\\in[0,1],a+b\\in [0,1])$.\n\nThe magic bridges in the Kingdom of Mathematics change over time. Sometimes a magic bridge disappears, and sometimes a magic bridge appears. However, at any moment, there exists at most one simple path connecting any two cities (i.e., all cities form a forest). Initially, there are no magic bridges in the Kingdom of Mathematics.\n\nKing Lagrange of the Kingdom of Mathematics is happy to teach Xiao R (pinyin) math, but only if Xiao R first answers the king’s questions. These questions have the same form: for a person with IQ $x$ traveling from city $u$ to city $v$ (i.e., passing through all cities on the path $u \\to v$, including $u$ and $v$) and solving all the problems in those cities, what is the sum of all his scores.", "inputFormat": "The first line contains two positive integers $n, m$ and a string $type$. They indicate that there are $n$ cities in the Kingdom of Mathematics, $m$ events occur, and the type of this testdata is $type$.\n\nThe string $type$ is provided to help you obtain partial scores more easily; you may not need to use it. Its meaning is explained in Constraints and Assumptions.\n\nThe next $n$ lines describe, for each city $i$, the function inside its magic orb in the initial state. One integer $f$ denotes the type of function, and two real numbers $a, b$ denote the parameters. If\n\n- $f=1$, then the function is $f(x)=\\sin(ax+b)$.\n- $f=2$, then the function is $f(x)=\\text e^{ax+b}$.\n- $f=3$, then the function is $f(x)=ax+b$.\n\nThe next $m$ lines each describe an event, of one of four types.\n\n- `appear u v` means a magic bridge appears between cities $u$ and $v$. It is guaranteed that before adding the bridge, $u$ and $v$ are not reachable from each other.\n- `disappear u v` means the magic bridge between $u$ and $v$ disappears. It is guaranteed that this magic bridge exists.\n- `magic c f a b` means the magic orb in city $c$ changes to a function of type $f$ with parameters $a, b$.\n- `travel u v x` asks: for a person with IQ $x$ traveling from city $u$ to city $v$, what is the sum of his scores. If $u$ cannot reach $v$, output a single line containing the string `unreachable`.", "outputFormat": "For each query, output one line with a real number representing the total score.", "hint": "Constraints and Assumptions.  \nFor $100\\%$ of the data, $1\\le n\\le 10^5, 1\\le m \\le 2 \\times 10^5$.\n\nThere are 20 testdata points, each worth 5 points.\n\n测试点|$n$|$m$|数据类型\n:-:|:-:|:-:|:-:|\n$1$|$\\leq 100$|$\\leq 200$|C1\n$2 \\sim 5$|$\\leq 10^5$|$\\leq 2 \\times 10^5$|A0\n$6$|$\\leq 10^5$|$\\leq 2 \\times 10^5$|B0\n$7 \\sim 8$|$\\leq 10^5$|$\\leq 2 \\times 10^5$|D0\n$9 \\sim 14$|$\\leq 10^5$|$\\leq 2 \\times 10^5$|A1\n$15 \\sim 17$|$\\leq 10^5$|$\\leq 2 \\times 10^5$|C1\n$18 \\sim 20$|$\\leq 10^5$|$\\leq 2 \\times 10^5$|D1\n\nMeaning of data types:\n\n- A: There is no `disappear` event, and in all `appear` events, $u = v - 1$.\n- B: There is no `disappear` event.\n- C: The total number of cities traversed over all `travel` events is $\\le 5 \\times 10^6$ (pairs that are unreachable are not counted).\n- D: No further restrictions.\n\n- 0: In all `travel` events, $x=1$ (i.e., everyone’s IQ is $1$).\n- 1: No restriction.\n\nScoring criteria.  \n\nIf your answer differs from the standard answer by a relative error within $10^{-7}$ or an absolute error within $10^{-7}$, it is considered correct.\n\nYou will receive full score only if all your answers are correct; otherwise, you receive 0 points.\n\nPlease pay attention to the output format: print one answer per line, and each line must be either `unreachable` or a real number (scientific notation is recommended). Each line must not exceed 50 characters. Incorrect output format will result in 0 points.\n\nXiao R Teaches You Math.\n\nIf the $n$-th derivative of a function $f(x)$ is continuous on the interval $[a,b]$, then by applying the Lagrange mean value theorem $n$ times to $f(x)$ at $x_0 \\ (x_0\\in[a,b])$, we obtain the Taylor expansion with Lagrange remainder\n$$f(x)=\\sum_{k=0}^{n-1}\\frac{f^{(k)}(x_0)(x-x_0)^k}{k!}+\\frac{f^{(n)}(\\xi)(x-x_0)^n}{n!},x\\in[a,b]$$\nwhere, when $x>x_0$, $\\xi\\in[x_0,x]$. When $x<x_0$, $\\xi\\in[x,x_0]$.\n\n$f^{(n)}$ denotes the $n$-th derivative of the function $f$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUWC 2017] 在美妙的数学王国中畅游", "background": "数字和数学规律主宰着这个世界。\n\n机器的运转，\n\n生命的消长，\n\n宇宙的进程，\n\n这些神秘而又美妙的过程无不可以用数学的语言展现出来。\n\n这印证了一句古老的名言：\n\n“学好数理化，走遍天下都不怕。”", "description": "学渣小R 被大学的数学课程虐得生活不能自理，微积分的成绩曾是他在教室里上的课的最低分。然而他的某位陈姓室友却能轻松地在数学考试中得到满分。为了提升自己的数学课成绩，有一天晚上（在他睡觉的时候），他来到了数学王国。\n\n数学王国中，每个人的智商可以用一个属于 $ [0,1]$ 的实数表示。数学王国中有 $n$ 个城市，编号从 $0 \\sim n-1$，这些城市由若干座魔法桥连接。每个城市的中心都有一个魔法球，每个魔法球中藏有一道数学题。\n\n每个人在做完这道数学题之后都会得到一个在 $[0,1]$ 内的分数。一道题可以用一个函数 $f(x)$ 表示。若一个人的智商为 $x$，则他做完这道数学题之后会得到 $f(x)$ 分。有三种形式：\n\n-  正弦函数 $f(x)=\\sin(a x + b)\\ (a \\in [0,1], b \\in [0,\\pi],a+b\\in[0,\\pi])$   \n-  指数函数 $f(x)=\\text e^{ax+b}\\ (a\\in [-1,1], b\\in [-2,0], a+b\\in [-2,0])$   \n-  一次函数 $f(x) = ax + b\\ (a\\in [-1,1],b\\in[0,1],a+b\\in [0,1])$    \n\n数学王国中的魔法桥会发生变化，有时会有一座魔法桥消失，有时会有一座魔法桥出现。但在任意时刻，只存在至多一条连接任意两个城市的简单路径（即所有城市形成一个森林）。在初始情况下，数学王国中不存在任何的魔法桥。\n\n数学王国的国王拉格朗日很乐意传授小R 数学知识，但前提是小R 要先回答国王的问题。这些问题具有相同的形式，即一个智商为 $x$ 的人从城市 $u$ 旅行到城市 $v$（即经过 $u \\to v$ 这条路径上的所有城市，包括 $u$ 和 $v$）且做了所有城市内的数学题后，他所有得分的总和是多少。", "inputFormat": "第一行两个正整数 $n,m$ 和一个字符串 $type$。表示数学王国中共有 $n$ 座城市，发生了 $m$ 个事件，该数据的类型为 $type$。\n\n$type$ 字符串是为了能让大家更方便地获得部分分，你可能不需要用到这个输入。其具体含义在 **【限制与约定】** 中有解释。\n\n接下来 $n$ 行，第 $i$ 行表示初始情况下编号为 $i$ 的城市的魔法球中的函数。一个魔法用一个整数 $f$ 表示函数的类型，两个实数 $a,b$ 表示函数的参数，若\n\n- $f=1$，则函数为 $f(x)=\\sin(ax+b)$\n- $f=2$，则函数为 $f(x)=\\text e^{ax+b}$\n- $f=3$，则函数为 $f(x)=ax+b$\n\n接下来 $m$ 行，每行描述一个事件，事件分为四类。\n\n- `appear u v` 表示数学王国中出现了一条连接 $u$ 和 $v$ 这两座城市的魔法，保证连接前 $u,v$ 这两座城市不能互相到达。\n\n- `disappear u v` 表示数学王国中连接 $u,v$ 这两座城市的魔法桥消失了，保证这座魔法桥是存在的。\n\n- `magic c f a b` 表示城市 $c$ 的魔法球中的魔法变成了类型为 $f$，参数为 $a,b$ 的函数\n\n- `travel u v x` 表示询问一个智商为 $x$ 的人从城市 $u$ 旅行到城市 $v$ 后，他得分的总和是多少。若无法从 $u$ 到达 $v$，则输出一行一个字符串 `unreachable`。", "outputFormat": "对于每个询问，输出一行实数，表示得分的总和。", "hint": "【限制与约定】  \n对于 $100\\%$ 的数据，$1\\le n\\le 10^5, 1\\le m \\le 2 \\times 10^5$ 。\n\n本题共有 20 个数据点，每个数据点 5 分。\n\n测试点|$n$|$m$|数据类型\n:-:|:-:|:-:|:-:|\n$1$|$\\leq 100$|$\\leq 200$|C1\n$2 \\sim 5$|$\\leq 10^5$|$\\leq 2 \\times 10^5$|A0\n$6$|$\\leq 10^5$|$\\leq 2 \\times 10^5$|B0\n$7 \\sim 8$|$\\leq 10^5$|$\\leq 2 \\times 10^5$|D0\n$9 \\sim 14$|$\\leq 10^5$|$\\leq 2 \\times 10^5$|A1\n$15 \\sim 17$|$\\leq 10^5$|$\\leq 2 \\times 10^5$|C1\n$18 \\sim 20$|$\\leq 10^5$|$\\leq 2 \\times 10^5$|D1\n\n数据类型的含义：\n\nA：不存在 `disappear` 事件，且所有`appear`事件中的 $u=v-1$\n\nB：不存在 `disappear` 事件\n\nC：所有的 `travel` 事件经过的城市总数 $\\le 5 \\times 10^6$（不可到达的城市对不计入在内）\n\nD：无限制\n\n0：所有 `travel` 事件中，$x=1$（即所有人的智商均为 $1$）\n\n1：无限制\n\n\n\n【评分标准】  \n\n如果你的答案与标准答案的相对误差在 $10^{-7}$ 以内或绝对误差在 $10^{-7}$ 以内，则被判定为正确。\n\n如果你的所有答案均为正确，则得满分，否则得 0 分。\n\n请注意输出格式：每行输出一个答案，答案只能为 `unreachable` 或者一个实数（建议使用科学计数法表示）。每行的长度不得超过 50。错误输出格式会被判定为 0 分。\n\n\n\n【小R 教你学数学】\n\n若函数 $f(x)$ 的 $n$ 阶导数在 $[a,b]$ 区间内连续，则对 $f(x)$ 在 $x_0 \\ (x_0\\in[a,b])$ 处使用 $n$ 次拉格朗日中值定理可以得到带拉格朗日余项的泰勒展开式\n\n$$f(x)=\\sum_{k=0}^{n-1}\\frac{f^{(k)}(x_0)(x-x_0)^k}{k!}+\\frac{f^{(n)}(\\xi)(x-x_0)^n}{n!},x\\in[a,b]$$\n\n其中，当 $x>x_0$ 时，$\\xi\\in[x_0,x]$。当 $x<x_0$ 时，$\\xi\\in[x,x_0]$。\n\n$f^{(n)}$ 表示函数 $f$ 的 $n$ 阶导数", "locale": "zh-CN"}}}
{"pid": "P4547", "type": "P", "difficulty": 7, "samples": [["2 2\n1 2 1 2 2\n2 1 2 1 1", "2"], ["3 5\n1 1 2 3 3\n1 3 2 2 2\n1 1 1 1 3\n1 2 1 3 1\n0 2 3", "7"], ["4 9\n2 4 1 4 2\n1 3 2 1 4\n2 2 1 4 4\n2 3 4 1 1\n2 4 3 2 4\n2 2 2 3 1\n0 1 3\n0 3 3\n1 2 3 1 2", "20"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["搜索", "2017", "记忆化搜索", "THUWC", "状压 DP"], "title": "[THUWC 2017] 随机二分图", "background": "", "description": "某人在玩一个非常神奇的游戏。这个游戏中有一个左右各 $n$ 个点的二分图，图中的边会按照一定的规律随机出现。\n\n为了描述这些规律，某人将这些边分到若干个组中。每条边或者不属于任何组 （这样的边一定不会出现），或者只属于一个组。\n\n有且仅有以下三类边的分组：\n\n0.  这类组每组只有一条边，该条边恰好有 $50\\%$ 的概率出现。\n\n1. 这类组每组恰好有两条边，这两条边有 $50\\%$ 的概率同时出现，有 $50\\%$ 的概率同时不出现。\n2. 这类组每组恰好有两条边，这两条边恰好出现一条，各有 $50\\%$ 的概率出现。\n\n组和组之间边的出现都是完全独立的。\n\n某人现在知道了边的分组和组的种类，想要知道完美匹配数量的期望是多少。你能帮助她解决这个问题吗？", "inputFormat": "从标准输入读入数据。\n\n第一行两个数 $n$ 和 $m$，表示图左右点数的数量和边的组的个数。我们用 $(a,b)$ （其中 $1 \\le a,b \\le n$）表示一条左端点为二分图左侧第 $a$ 个点，右端点为二分图右侧第 $b$ 个点的边。\n\n接下来 $m$ 行，每行描述一个组。开头第一个数 $t$ 表示组的种类，$t=0$ 表示是一条边的组，$t=1$ 表示是两条边的组中的第一种，$t=2$ 表示是两条边的组中的第二种。如果 $t=0$， 接下来两个数 $a_1,b_1$ 表示组内的第一条边；否则，接下来四个数 $a_1,b_1,a_2,b_2$， 表示该组内的两条边分别为 $(a_1,b_1)$  和 $(a_2,b_2)$。保证每条边至多出现一次。", "outputFormat": "输出到标准输出。\n\n假设期望的完美匹配数量是$E$。输出一行表示\n$$\n(2^{n} E) \\bmod (10^9 + 7)\n$$\n可以看出上式一定是一个整数。", "hint": "## 【定义解释】\n\n如果你对完美匹配和期望的定义很熟悉，那么你可以跳过本段。\n\n对于一个左右各 $n$ 个点的二分图，它的一个完美匹配是指 $n$ 条没有公共点的边构成的匹配。\n\n两个完美匹配不同，当且仅当它们至少含有一条不同的边。一个二分图完美匹配的数量定义为这张图能找到的两两不同的完美匹配的数量。\n\n在题目的图中，边都是随机出现的，因此这个图中完美匹配的数量是一个随机变量。一个（离散型）随机变量 $X$ 的期望定义为以概率为权，$X$ 所有可能取值的加权平均数，即\n$$\n\\sum_{x \\in V(X)}P[X=x]\\cdot x\n$$\n其中 $V(X)$ 表示 $X$ 所有可能的取值集合，$P[X=x]$ 表示 $X$ 取值为 $x$ 的概率。\n\n## 【数据规模和约定】\n\n对于 $5\\%$ 的数据 $n \\le 5$ 。  \n对于另 $5\\%$ 的数据 $n \\le 8$ 。  \n对于另 $10\\%$ 的数据 $n \\le 10$ 。  \n对于另 $15\\%$ 的数据，只有$t = 0$ 的情况。  \n对于另 $5\\%$ 的数据，只有$t = 0$ 的情况，且$m = n^2$，也就是该图为一个完全图。  \n对于另 $20\\%$ 的数据，只有 $t =0$ 或者 $t=1$ 的情况。\n对于另 $20\\%$ 的数据，只有 $t =0$ 或者 $t=2$ 的情况。\n对于 $100\\%$ 的数据，$n \\le 15$。", "locale": "zh-CN", "translations": {"en": {"title": "[THUWC 2017] Random Bipartite Graph", "background": "", "description": "Someone is playing a very magical game. In this game, there is a bipartite graph with $n$ vertices on the left and $n$ vertices on the right, and edges appear randomly according to certain rules.\n\nTo describe these rules, the edges are partitioned into several groups. Each edge either belongs to exactly one group, or to no group at all (such edges will never appear).\n\nThere are exactly the following three types of groups:\n\n0. Each such group contains exactly one edge, and that edge appears with probability $50\\%$.\n1. Each such group contains exactly two edges; the two edges either both appear with probability $50\\%$, or both do not appear with probability $50\\%$.\n2. Each such group contains exactly two edges; exactly one of the two appears, and each has probability $50\\%$ of appearing.\n\nEdge appearances from different groups are mutually independent.\n\nNow that the grouping and types of edges are given, one wants to know the expected number of perfect matchings. Can you help her solve this problem?", "inputFormat": "Read from standard input.\n\nThe first line contains two integers $n$ and $m$, denoting the number of vertices on each side of the bipartite graph and the number of edge groups. We use $(a,b)$ (where $1 \\le a, b \\le n$) to denote an edge whose left endpoint is the $a$-th vertex on the left and whose right endpoint is the $b$-th vertex on the right.\n\nThe next $m$ lines each describe one group. The first number $t$ denotes the group type, where $t=0$ means a one-edge group, $t=1$ means the first kind of two-edge group, and $t=2$ means the second kind of two-edge group. If $t=0$, then the next two integers $a_1, b_1$ specify the single edge in the group. Otherwise, the next four integers $a_1, b_1, a_2, b_2$ specify that the two edges in the group are $(a_1, b_1)$ and $(a_2, b_2)$. It is guaranteed that each edge appears at most once.", "outputFormat": "Output to standard output.\n\nSuppose the expected number of perfect matchings is $E$. Output one line:\n$$\n(2^{n} E) \\bmod (10^9 + 7)\n$$\nIt can be seen that the above expression is an integer.", "hint": "Definition Explanation.\n\nIf you are familiar with the definitions of perfect matching and expectation, you may skip this part.\n\nFor a bipartite graph with $n$ vertices on each side, a perfect matching is a matching consisting of $n$ edges with no shared endpoints.\n\nTwo perfect matchings are different if and only if they contain at least one different edge. The number of perfect matchings of a bipartite graph is defined as the number of pairwise distinct perfect matchings that can be found in this graph.\n\nIn this problem, edges appear randomly, so the number of perfect matchings is a random variable. The expectation of a (discrete) random variable $X$ is defined as the probability-weighted average of all possible values of $X$, i.e.,\n$$\n\\sum_{x \\in V(X)} P[X = x] \\cdot x\n$$\nwhere $V(X)$ denotes the set of all possible values of $X$, and $P[X = x]$ denotes the probability that $X$ takes the value $x$.\n\nConstraints.\n\n- For $5\\%$ of the testdata, $n \\le 5$.\n- For another $5\\%$ of the testdata, $n \\le 8$.\n- For another $10\\%$ of the testdata, $n \\le 10$.\n- For another $15\\%$ of the testdata, only $t = 0$ occurs.\n- For another $5\\%$ of the testdata, only $t = 0$ occurs and $m = n^2$, i.e., the graph is a complete graph.\n- For another $20\\%$ of the testdata, only $t = 0$ or $t = 1$ occurs.\n- For another $20\\%$ of the testdata, only $t = 0$ or $t = 2$ occurs.\n- For $100\\%$ of the testdata, $n \\le 15$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUWC 2017] 随机二分图", "background": "", "description": "某人在玩一个非常神奇的游戏。这个游戏中有一个左右各 $n$ 个点的二分图，图中的边会按照一定的规律随机出现。\n\n为了描述这些规律，某人将这些边分到若干个组中。每条边或者不属于任何组 （这样的边一定不会出现），或者只属于一个组。\n\n有且仅有以下三类边的分组：\n\n0.  这类组每组只有一条边，该条边恰好有 $50\\%$ 的概率出现。\n\n1. 这类组每组恰好有两条边，这两条边有 $50\\%$ 的概率同时出现，有 $50\\%$ 的概率同时不出现。\n2. 这类组每组恰好有两条边，这两条边恰好出现一条，各有 $50\\%$ 的概率出现。\n\n组和组之间边的出现都是完全独立的。\n\n某人现在知道了边的分组和组的种类，想要知道完美匹配数量的期望是多少。你能帮助她解决这个问题吗？", "inputFormat": "从标准输入读入数据。\n\n第一行两个数 $n$ 和 $m$，表示图左右点数的数量和边的组的个数。我们用 $(a,b)$ （其中 $1 \\le a,b \\le n$）表示一条左端点为二分图左侧第 $a$ 个点，右端点为二分图右侧第 $b$ 个点的边。\n\n接下来 $m$ 行，每行描述一个组。开头第一个数 $t$ 表示组的种类，$t=0$ 表示是一条边的组，$t=1$ 表示是两条边的组中的第一种，$t=2$ 表示是两条边的组中的第二种。如果 $t=0$， 接下来两个数 $a_1,b_1$ 表示组内的第一条边；否则，接下来四个数 $a_1,b_1,a_2,b_2$， 表示该组内的两条边分别为 $(a_1,b_1)$  和 $(a_2,b_2)$。保证每条边至多出现一次。", "outputFormat": "输出到标准输出。\n\n假设期望的完美匹配数量是$E$。输出一行表示\n$$\n(2^{n} E) \\bmod (10^9 + 7)\n$$\n可以看出上式一定是一个整数。", "hint": "## 【定义解释】\n\n如果你对完美匹配和期望的定义很熟悉，那么你可以跳过本段。\n\n对于一个左右各 $n$ 个点的二分图，它的一个完美匹配是指 $n$ 条没有公共点的边构成的匹配。\n\n两个完美匹配不同，当且仅当它们至少含有一条不同的边。一个二分图完美匹配的数量定义为这张图能找到的两两不同的完美匹配的数量。\n\n在题目的图中，边都是随机出现的，因此这个图中完美匹配的数量是一个随机变量。一个（离散型）随机变量 $X$ 的期望定义为以概率为权，$X$ 所有可能取值的加权平均数，即\n$$\n\\sum_{x \\in V(X)}P[X=x]\\cdot x\n$$\n其中 $V(X)$ 表示 $X$ 所有可能的取值集合，$P[X=x]$ 表示 $X$ 取值为 $x$ 的概率。\n\n## 【数据规模和约定】\n\n对于 $5\\%$ 的数据 $n \\le 5$ 。  \n对于另 $5\\%$ 的数据 $n \\le 8$ 。  \n对于另 $10\\%$ 的数据 $n \\le 10$ 。  \n对于另 $15\\%$ 的数据，只有$t = 0$ 的情况。  \n对于另 $5\\%$ 的数据，只有$t = 0$ 的情况，且$m = n^2$，也就是该图为一个完全图。  \n对于另 $20\\%$ 的数据，只有 $t =0$ 或者 $t=1$ 的情况。\n对于另 $20\\%$ 的数据，只有 $t =0$ 或者 $t=2$ 的情况。\n对于 $100\\%$ 的数据，$n \\le 15$。", "locale": "zh-CN"}}}
{"pid": "P4548", "type": "P", "difficulty": 7, "samples": [["2 2\n1 1\n3 1 2 1", "0002\n0010"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["字符串", "2006", "枚举", "期望", "KMP 算法", "概率生成函数", "CTSC/CTS"], "title": "[CTSC2006] 歌唱王国", "background": "", "description": "在歌唱王国，所有人的名字都是一个非空的仅包含整数 $1\\sim n$ 的字符串。\n\n王国里生活着一大群咕噜兵，他们靠不停地歌唱首领——牛人酋长们的名字来获取力量。咕噜兵每一次歌唱过程是这样的：首先，他从整数生成器那儿获得一个数字，然后花一个时间单位将此数字唱出来，如果他发现某个牛人酋长的名字已经被歌唱出来（即此名字是歌唱序列的一个连续子串），那么这次歌唱过程就立即结束。\n\n相关名词定义：\n\n- 歌唱序列：如果某人歌唱了 $x$ 个数字，第 $i$ 次歌唱的数字为 $a_i$，那么歌唱序列 $=(a_1,a_2,\\cdots,a_x)$。\n- 整数生成器：歌唱王国的神物，它有一个按钮，如果你按一下按钮，将从 $1\\sim n$ 数字中等概率的随机返回一个整数。\n- 歌唱时间：在一次歌唱过程中花费的时间。\n\n歌唱时间是随机的，无法预料；不过歌唱时间的期望值是固定的，此期望值即平均来说歌唱时间有多长，亦可称作平均歌唱时间。\n\n王国里的人非常喜欢歌唱，他们希望歌唱的时间越长越好，所以他们决定罢免一些牛人酋长，使得平均歌唱时间变长。但是他们不能罢免掉所有的牛人酋长，否则他们每次歌唱都无法停止，无法获取力量；于是他们决定只保留一个牛人酋长而罢免其余的牛人酋长。\n\n你的任务是：对于给定的 $n$、牛人酋长的个数 $t$ 以及每一个牛人酋长的名字，告诉王国里的人们，对于 $1\\leq i\\leq t$，如果保留第 $i$ 个牛人酋长，罢免掉其余的，那么平均歌唱时间将是多少。\n\n提示：此数为一个非负整数！\n\n输出要求：由于这个数字太大，所以你只需输出这个数的末 $4$ 位数字。如果不足 $4$ 位，则前面补 $0$（见样例）。\n", "inputFormat": "第一行，两个整数 $n,t$。以下 $t$ 行描述 $t$ 个牛人酋长名字。\n\n文件第 $i+1$（$1\\leq i\\leq t$）行格式如下：第一个数为 $m_i$ 表示第 $i$ 个牛人酋长的名字的长度，在一个空格之后，接下来有 $m_i$ 个数，用来描述这个牛人酋长的名字，相邻两个整数之间用一个空格分开。", "outputFormat": "共 $t$ 行，第 $i$ 行为一个整数，表示若保留第 $i$ 个牛人酋长而罢免其余的，则平均歌唱时间最长的末四位数字是多少。", "hint": "对于 $100\\%$ 的数据，$1\\leq n\\leq 10^5$，$t\\leq 50$，$1\\leq m_i\\leq 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2006] Singing Kingdom", "background": "", "description": "In the Singing Kingdom, everyone’s name is a non-empty string consisting only of integers from $1\\sim n$.\n\nThere lives a large group of Gurubing soldiers in the kingdom. They gain power by continuously singing the names of the leaders—the “Niuren chieftains”. Each singing process works like this: first, a soldier gets a number from the integer generator, then spends one unit of time to sing this number. If he finds that the name of some Niuren chieftain has already been sung (that is, the name appears as a contiguous substring of the singing sequence), then this singing process ends immediately.\n\nDefinitions:\n\n- Singing sequence: If someone has sung $x$ numbers, and the number sung at the $i$-th step is $a_i$, then the singing sequence $=(a_1,a_2,\\cdots,a_x)$.\n- Integer generator: A divine object in the Singing Kingdom. It has a button; if you press it once, it returns a random integer from $1\\sim n$ with equal probability.\n- Singing time: The time spent in one singing process.\n\nThe singing time is random and unpredictable. However, its expected value is fixed. This expected value describes how long the singing time is on average, and can also be called the average singing time.\n\nPeople in the kingdom love singing. They want the singing time to be as long as possible, so they decide to remove (dismiss) some Niuren chieftains to make the average singing time longer. But they cannot remove all Niuren chieftains; otherwise, each singing process would never stop, and they would not be able to gain power. Therefore, they decide to keep only one Niuren chieftain and remove all the others.\n\nYour task is: given $n$, the number of Niuren chieftains $t$, and the name of each Niuren chieftain, for each $1\\leq i\\leq t$, if only the $i$-th Niuren chieftain is kept and all others are removed, output what the average singing time will be.\n\nHint: This number is a non-negative integer.\n\nOutput requirement: Because this number is too large, you only need to output its last $4$ digits. If it has fewer than $4$ digits, pad leading zeros (see the sample).", "inputFormat": "The first line contains two integers $n,t$. The following $t$ lines describe the names of the $t$ Niuren chieftains.\n\nLine $i+1$ ($1\\leq i\\leq t$) has the following format: the first number is $m_i$, the length of the $i$-th Niuren chieftain’s name. After a space, there are $m_i$ numbers describing this name, with one space between each pair of adjacent integers.", "outputFormat": "Output $t$ lines. The $i$-th line contains an integer, meaning the last four digits of the maximum average singing time when keeping only the $i$-th Niuren chieftain and removing all others.", "hint": "For $100\\%$ of the testdata, $1\\leq n\\leq 10^5$, $t\\leq 50$, $1\\leq m_i\\leq 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2006] 歌唱王国", "background": "", "description": "在歌唱王国，所有人的名字都是一个非空的仅包含整数 $1\\sim n$ 的字符串。\n\n王国里生活着一大群咕噜兵，他们靠不停地歌唱首领——牛人酋长们的名字来获取力量。咕噜兵每一次歌唱过程是这样的：首先，他从整数生成器那儿获得一个数字，然后花一个时间单位将此数字唱出来，如果他发现某个牛人酋长的名字已经被歌唱出来（即此名字是歌唱序列的一个连续子串），那么这次歌唱过程就立即结束。\n\n相关名词定义：\n\n- 歌唱序列：如果某人歌唱了 $x$ 个数字，第 $i$ 次歌唱的数字为 $a_i$，那么歌唱序列 $=(a_1,a_2,\\cdots,a_x)$。\n- 整数生成器：歌唱王国的神物，它有一个按钮，如果你按一下按钮，将从 $1\\sim n$ 数字中等概率的随机返回一个整数。\n- 歌唱时间：在一次歌唱过程中花费的时间。\n\n歌唱时间是随机的，无法预料；不过歌唱时间的期望值是固定的，此期望值即平均来说歌唱时间有多长，亦可称作平均歌唱时间。\n\n王国里的人非常喜欢歌唱，他们希望歌唱的时间越长越好，所以他们决定罢免一些牛人酋长，使得平均歌唱时间变长。但是他们不能罢免掉所有的牛人酋长，否则他们每次歌唱都无法停止，无法获取力量；于是他们决定只保留一个牛人酋长而罢免其余的牛人酋长。\n\n你的任务是：对于给定的 $n$、牛人酋长的个数 $t$ 以及每一个牛人酋长的名字，告诉王国里的人们，对于 $1\\leq i\\leq t$，如果保留第 $i$ 个牛人酋长，罢免掉其余的，那么平均歌唱时间将是多少。\n\n提示：此数为一个非负整数！\n\n输出要求：由于这个数字太大，所以你只需输出这个数的末 $4$ 位数字。如果不足 $4$ 位，则前面补 $0$（见样例）。\n", "inputFormat": "第一行，两个整数 $n,t$。以下 $t$ 行描述 $t$ 个牛人酋长名字。\n\n文件第 $i+1$（$1\\leq i\\leq t$）行格式如下：第一个数为 $m_i$ 表示第 $i$ 个牛人酋长的名字的长度，在一个空格之后，接下来有 $m_i$ 个数，用来描述这个牛人酋长的名字，相邻两个整数之间用一个空格分开。", "outputFormat": "共 $t$ 行，第 $i$ 行为一个整数，表示若保留第 $i$ 个牛人酋长而罢免其余的，则平均歌唱时间最长的末四位数字是多少。", "hint": "对于 $100\\%$ 的数据，$1\\leq n\\leq 10^5$，$t\\leq 50$，$1\\leq m_i\\leq 10^5$。", "locale": "zh-CN"}}}
{"pid": "P4549", "type": "P", "difficulty": 3, "samples": [["2\n4059 -1782\n", "99"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["数学", "最大公约数 gcd", "不定方程", "Bézout 定理", "模板题"], "title": "【模板】裴蜀定理", "background": "", "description": "给定一个包含 $n$ 个元素的**整数**序列 $A$，记作 $A_1,A_2,A_3,...,A_n$。\n\n求另一个包含 $n$ 个元素的待定**整数**序列 $X$，记 $S=\\sum\\limits_{i=1}^nA_i\\times X_i$，使得 $S>0$ 且 $S$ 尽可能的小。", "inputFormat": "第一行一个整数 $n$，表示序列元素个数。  \n\n第二行 $n$ 个整数，表示序列 $A$。", "outputFormat": "一行一个整数，表示 $S>0$ 的前提下 $S$ 的最小值。", "hint": "对于 $100\\%$ 的数据，$1 \\le n \\le 20$，$|A_i| \\le 10^5$，且 $A$ 序列不全为 $0$。", "locale": "zh-CN", "translations": {"en": {"title": "【Template】Bézout's Identity", "background": "", "description": "Given an **integer** sequence $A$ with $n$ elements, denoted as $A_1, A_2, A_3, \\ldots, A_n$.\n\nFind another **integer** sequence $X$ with $n$ elements. Let $S=\\sum\\limits_{i=1}^nA_i\\times X_i$, such that $S>0$ and $S$ is as small as possible.", "inputFormat": "The first line contains an integer $n$, the number of elements in the sequence.\n\nThe second line contains $n$ integers, the sequence $A$.", "outputFormat": "Output a single integer on one line, the minimal value of $S$ subject to $S>0$.", "hint": "Constraints: For $100\\%$ of the testdata, $1 \\le n \\le 20$, $|A_i| \\le 10^5$, and the sequence $A$ is not all zeros.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】裴蜀定理", "background": "", "description": "给定一个包含 $n$ 个元素的**整数**序列 $A$，记作 $A_1,A_2,A_3,...,A_n$。\n\n求另一个包含 $n$ 个元素的待定**整数**序列 $X$，记 $S=\\sum\\limits_{i=1}^nA_i\\times X_i$，使得 $S>0$ 且 $S$ 尽可能的小。", "inputFormat": "第一行一个整数 $n$，表示序列元素个数。  \n\n第二行 $n$ 个整数，表示序列 $A$。", "outputFormat": "一行一个整数，表示 $S>0$ 的前提下 $S$ 的最小值。", "hint": "对于 $100\\%$ 的数据，$1 \\le n \\le 20$，$|A_i| \\le 10^5$，且 $A$ 序列不全为 $0$。", "locale": "zh-CN"}}}
{"pid": "P4550", "type": "P", "difficulty": 5, "samples": [["3", "21.25"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [165536, 165536, 165536, 165536, 165536, 165536, 165536, 165536, 165536, 165536, 165536]}, "tags": ["递推", "期望"], "title": "收集邮票", "background": "", "description": "有 $n$ 种不同的邮票，皮皮想收集所有种类的邮票。唯一的收集方法是到同学凡凡那里购买，每次只能买一张，并且买到的邮票究竟是 $n$ 种邮票中的哪一种是等概率的，概率均为 $1/n$。但是由于凡凡也很喜欢邮票，所以皮皮购买第 $k$ 次邮票需要支付 $k$ 元钱。\n\n现在皮皮手中没有邮票，皮皮想知道自己得到所有种类的邮票需要花费的钱数目的期望。", "inputFormat": "一行，一个数字 $N$（$N \\le 10000$）。", "outputFormat": "输出要付出多少钱，保留二位小数。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "Collecting Stamps", "background": "", "description": "There are $n$ different kinds of stamps. Pipi wants to collect all kinds of stamps. The only way to collect is to buy from classmate Fanfan: each time Pipi can buy only one stamp, and which one of the $n$ kinds is obtained is equally likely, each with probability $1/n$. However, because Fanfan also likes stamps, Pipi must pay $k$ yuan for the $k$-th purchase.\n\nNow Pipi has no stamps. Pipi wants to know the expected amount of money needed to obtain all kinds of stamps.", "inputFormat": "One line, a single integer $N$ ($N \\le 10000$).", "outputFormat": "Output the amount of money to pay, with two decimal places.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "收集邮票", "background": "", "description": "有 $n$ 种不同的邮票，皮皮想收集所有种类的邮票。唯一的收集方法是到同学凡凡那里购买，每次只能买一张，并且买到的邮票究竟是 $n$ 种邮票中的哪一种是等概率的，概率均为 $1/n$。但是由于凡凡也很喜欢邮票，所以皮皮购买第 $k$ 次邮票需要支付 $k$ 元钱。\n\n现在皮皮手中没有邮票，皮皮想知道自己得到所有种类的邮票需要花费的钱数目的期望。", "inputFormat": "一行，一个数字 $N$（$N \\le 10000$）。", "outputFormat": "输出要付出多少钱，保留二位小数。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4551", "type": "P", "difficulty": 4, "samples": [["4\n1 2 3\n2 3 4\n2 4 6", "7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "贪心", "字典树 Trie"], "title": "最长异或路径", "background": null, "description": "给定一棵 $n$ 个点的带权树，结点下标从 $1$ 开始到 $n$。求树中所有异或路径的最大值。\n\n异或路径指树上两个结点之间唯一路径上的所有边权的异或值。", "inputFormat": "第一行一个整数 $n$，表示结点数。\n\n接下来 $n-1$ 行，给出 $u,v,w$ ，分别表示树上的 $u$ 点和 $v$ 点有连边，边的权值是 $w$。", "outputFormat": "一行，一个整数表示答案。", "hint": "当两个结点分别是 $1,3$ 时，答案是 $7=3\\oplus 4$，取最大值。   \n\n### 数据范围\n\n$1\\le n \\le 10^5;0 < u,v \\le n;0 \\le w < 2^{31}$。", "locale": "zh-CN", "translations": {"en": {"title": "Longest XOR Path", "background": "", "description": "Given a weighted tree with $n$ nodes, indexed from $1$ to $n$. Find the maximum value among the XOR of all paths in the tree.\n\nAn XOR path is the XOR of all edge weights along the unique path between two nodes in the tree.\n\nConstraints\n$1 \\le n \\le 10^5; 0 < u, v \\le n; 0 \\le w < 2^{31}$.", "inputFormat": "The first line contains an integer $n$, the number of nodes.\n\nThe next $n-1$ lines each contain $u, v, w$, meaning there is an edge between node $u$ and node $v$ with weight $w$.", "outputFormat": "One line with a single integer, the answer.", "hint": "When the two nodes are $1$ and $3$, the value is $7=3\\oplus 4$, which is the maximum.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "最长异或路径", "background": null, "description": "给定一棵 $n$ 个点的带权树，结点下标从 $1$ 开始到 $n$。求树中所有异或路径的最大值。\n\n异或路径指树上两个结点之间唯一路径上的所有边权的异或值。", "inputFormat": "第一行一个整数 $n$，表示结点数。\n\n接下来 $n-1$ 行，给出 $u,v,w$ ，分别表示树上的 $u$ 点和 $v$ 点有连边，边的权值是 $w$。", "outputFormat": "一行，一个整数表示答案。", "hint": "当两个结点分别是 $1,3$ 时，答案是 $7=3\\oplus 4$，取最大值。   \n\n### 数据范围\n\n$1\\le n \\le 10^5;0 < u,v \\le n;0 \\le w < 2^{31}$。", "locale": "zh-CN"}}}
{"pid": "P4552", "type": "P", "difficulty": 4, "samples": [["4\n1\n1\n2\n2", "1\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["差分"], "title": "[Poetize6] IncDec Sequence", "background": null, "description": "给定一个长度为 $n$ 的数列 ${a_1,a_2,\\cdots,a_n}$，每次可以选择一个区间 $[l,r]$，使这个区间内的数都加 $1$ 或者都减 $1$。 \n  \n请问至少需要多少次操作才能使数列中的所有数都一样，并求出在保证最少次数的前提下，最终得到的数列有多少种。", "inputFormat": "第一行一个正整数 $n$。  \n接下来 $n$ 行，每行一个整数，第 $i+1$ 行的整数表示 $a_i$。", "outputFormat": "第一行输出最少操作次数。  \n第二行输出最终能得到多少种结果。", "hint": "对于 $100\\%$ 的数据，$n\\le 100000$，$0 \\le a_i \\le 2^{31}$。", "locale": "zh-CN", "translations": {"en": {"title": "[Poetize6] IncDec Sequence", "background": "", "description": "Given a sequence of length $n$, ${a_1,a_2,\\cdots,a_n}$, in each operation you may choose an interval $[l, r]$ and either add $1$ to every number in this interval or subtract $1$ from every number in this interval.\n  \nWhat is the minimum number of operations needed to make all numbers in the sequence equal, and under this minimum, how many different final sequences are possible?", "inputFormat": "The first line contains a positive integer $n$.\nThen $n$ lines follow; the integer on the $(i+1)$-th line is $a_i$.", "outputFormat": "Output the minimum number of operations on the first line.\nOutput the number of possible final sequences on the second line.", "hint": "Constraints: For $100\\%$ of the testdata, $n \\le 100000$, $0 \\le a_i \\le 2^{31}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Poetize6] IncDec Sequence", "background": null, "description": "给定一个长度为 $n$ 的数列 ${a_1,a_2,\\cdots,a_n}$，每次可以选择一个区间 $[l,r]$，使这个区间内的数都加 $1$ 或者都减 $1$。 \n  \n请问至少需要多少次操作才能使数列中的所有数都一样，并求出在保证最少次数的前提下，最终得到的数列有多少种。", "inputFormat": "第一行一个正整数 $n$。  \n接下来 $n$ 行，每行一个整数，第 $i+1$ 行的整数表示 $a_i$。", "outputFormat": "第一行输出最少操作次数。  \n第二行输出最终能得到多少种结果。", "hint": "对于 $100\\%$ 的数据，$n\\le 100000$，$0 \\le a_i \\le 2^{31}$。", "locale": "zh-CN"}}}
{"pid": "P4553", "type": "P", "difficulty": 6, "samples": [["6 3\n2 1 3 1 2 1\n2 6 8 5 0\n8 2 4 1\n6 1 0\n4 -1\n4", "27"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["网络流", "上下界网络流", "费用流"], "title": "80 人环游世界", "background": "", "description": "想必大家都看过成龙大哥的《80 天环游世界》，里面的紧张刺激的打斗场面一定给你留下了深刻的印象。现在就有这么一个 80 人的团伙，也想来一次环游世界。\n\n他们打算兵分多路，游遍每一个国家。\n\n因为他们主要分布在东方，所以他们只朝西方进军。设从东方到西方的每一个国家的编号依次为 $1, \\cdots, N$。假若第 $i$ 个人的游历路线为 $P_1,P_2,\\cdots ,P_k\\ (0\\le k\\le N)$，则 $P_1<P_2<\\cdots <P_k$。\n\n众所周知，中国相当美丽，这样在环游世界时就有很多人经过中国。我们用一个正整数 $V_i$ 来描述一个国家的吸引程度，$V_i$ 值越大表示该国家越有吸引力，同时也表示有且仅有 $V_i$ 个人会经过那一个国家。\n\n为了节省时间，他们打算通过坐飞机来完成环游世界的任务。同时为了省钱，他们希望总的机票费最小。\n  \n明天就要出发了，可是有些人临阵脱逃，最终只剩下了 $M$ 个人去环游世界。他们想知道最少的总费用，你能告诉他们吗？ ", "inputFormat": "第一行两个正整数 $N, M$。\n\n第二行有 $N$ 个不大于 $M$ 的正整数，分别表示 $V_1,V_2,\\cdots, V_N$。\n \n接下来有 $N - 1$ 行。第 $i$ 行有 $N - i$ 个整数，该行的第 $j$ 个数表示从第 $i$ 个国家到第 $i + j$ 个国家的机票费（如果该值等于 $-1$ 则表示这两个国家间没有通航）。", "outputFormat": "在第一行输出最少的总费用。", "hint": "在 $10\\%$ 的数据中，$M=1$；  \n在 $20\\%$ 的数据中，$1\\le M\\le 2$；  \n在 $40\\%$ 的数据中，$1\\le M\\le 3$；  \n在 $60\\%$ 的数据中，$1\\le M\\le 4$；  \n在 $100\\%$ 的数据中，$1 \\le N\\le 100$，$1\\le M\\le 79$。\n\n保证所以输入数据中最少费用小于 $10^6$。  \n保证至少存在一种可行方案。\n\n纪中联赛模拟题  \nBY CQF  ", "locale": "zh-CN", "translations": {"en": {"title": "Around the World with 80 People", "background": "", "description": "I’m sure many of you have seen Jackie Chan’s “Around the World in 80 Days,” and the intense, thrilling fight scenes must have left a deep impression. Now, there is a group of 80 people who also want to travel around the world.\n\nThey plan to split up and visit every country.\n\nSince they are mainly located in the East, they will only move westward. Let the countries from east to west be numbered $1, \\cdots, N$. If the $i$-th person’s itinerary is $P_1,P_2,\\cdots ,P_k\\ (0\\le k\\le N)$, then $P_1<P_2<\\cdots <P_k$.\n\nAs we all know, China is very beautiful, so many people will pass through China during their trip. We use a positive integer $V_i$ to describe a country’s attractiveness. The larger the value of $V_i$, the more attractive the country is, and it also means that exactly $V_i$ people will pass through that country.\n\nTo save time, they plan to travel by plane. To save money, they want the total airfare to be minimal.\n  \nThey are leaving tomorrow, but some people bailed at the last minute, and in the end only $M$ people will travel around the world. They want to know the minimal total cost. Please compute it.", "inputFormat": "The first line contains two positive integers $N, M$.\n\nThe second line has $N$ positive integers, each not greater than $M$, representing $V_1,V_2,\\cdots, V_N$.\n \nThen there are $N - 1$ lines. The $i$-th of these lines contains $N - i$ integers. The $j$-th number on this line is the airfare from the $i$-th country to the $(i + j)$-th country (if this value equals $-1$, then there is no direct flight between these two countries).", "outputFormat": "Output the minimal total cost on the first line.", "hint": "- In $10\\%$ of the testdata, $M=1$.\n- In $20\\%$ of the testdata, $1\\le M\\le 2$.\n- In $40\\%$ of the testdata, $1\\le M\\le 3$.\n- In $60\\%$ of the testdata, $1\\le M\\le 4$.\n- In $100\\%$ of the testdata, $1 \\le N\\le 100$, $1\\le M\\le 79$.\n\nIt is guaranteed that for all input, the minimal cost is less than $10^6$.  \nIt is guaranteed that there exists at least one feasible plan.\n\nJizhong League mock contest problem.  \nBy CQF.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "80 人环游世界", "background": "", "description": "想必大家都看过成龙大哥的《80 天环游世界》，里面的紧张刺激的打斗场面一定给你留下了深刻的印象。现在就有这么一个 80 人的团伙，也想来一次环游世界。\n\n他们打算兵分多路，游遍每一个国家。\n\n因为他们主要分布在东方，所以他们只朝西方进军。设从东方到西方的每一个国家的编号依次为 $1, \\cdots, N$。假若第 $i$ 个人的游历路线为 $P_1,P_2,\\cdots ,P_k\\ (0\\le k\\le N)$，则 $P_1<P_2<\\cdots <P_k$。\n\n众所周知，中国相当美丽，这样在环游世界时就有很多人经过中国。我们用一个正整数 $V_i$ 来描述一个国家的吸引程度，$V_i$ 值越大表示该国家越有吸引力，同时也表示有且仅有 $V_i$ 个人会经过那一个国家。\n\n为了节省时间，他们打算通过坐飞机来完成环游世界的任务。同时为了省钱，他们希望总的机票费最小。\n  \n明天就要出发了，可是有些人临阵脱逃，最终只剩下了 $M$ 个人去环游世界。他们想知道最少的总费用，你能告诉他们吗？ ", "inputFormat": "第一行两个正整数 $N, M$。\n\n第二行有 $N$ 个不大于 $M$ 的正整数，分别表示 $V_1,V_2,\\cdots, V_N$。\n \n接下来有 $N - 1$ 行。第 $i$ 行有 $N - i$ 个整数，该行的第 $j$ 个数表示从第 $i$ 个国家到第 $i + j$ 个国家的机票费（如果该值等于 $-1$ 则表示这两个国家间没有通航）。", "outputFormat": "在第一行输出最少的总费用。", "hint": "在 $10\\%$ 的数据中，$M=1$；  \n在 $20\\%$ 的数据中，$1\\le M\\le 2$；  \n在 $40\\%$ 的数据中，$1\\le M\\le 3$；  \n在 $60\\%$ 的数据中，$1\\le M\\le 4$；  \n在 $100\\%$ 的数据中，$1 \\le N\\le 100$，$1\\le M\\le 79$。\n\n保证所以输入数据中最少费用小于 $10^6$。  \n保证至少存在一种可行方案。\n\n纪中联赛模拟题  \nBY CQF  ", "locale": "zh-CN"}}}
{"pid": "P4554", "type": "P", "difficulty": 4, "samples": [["2 2\n@#\n#@\n0 0 1 1\n2 2\n@@\n@#\n0 1 1 0\n0 0", "2\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["广度优先搜索 BFS", "优先队列", "最短路", "队列"], "title": "小明的游戏", "background": "", "description": "小明最近喜欢玩一个游戏。给定一个 $n \\times m$ 的棋盘，上面有两种格子 `#` 和 `@`。游戏的规则很简单：给定一个起始位置和一个目标位置，小明每一步能向上，下，左，右四个方向移动一格。如果移动到同一类型的格子，则费用是 $0$，否则费用是 $1$。请编程计算从起始位置移动到目标位置的最小花费。", "inputFormat": "输入文件有多组数据。   \n输入第一行包含两个整数 $n$，$m$，分别表示棋盘的行数和列数。   \n输入接下来的 $n$ 行，每一行有 $m$ 个格子（使用 `#` 或者 `@` 表示）。   \n输入接下来一行有四个整数 $x_1, y_1, x_2, y_2$，分别为起始位置和目标位置。   \n当输入 $n$，$m$ 均为 $0$ 时，表示输入结束。  \n", "outputFormat": "对于每组数据，输出从起始位置到目标位置的最小花费。每一组数据独占一行。", "hint": "对于20%的数据满足：$1 \\le n, m \\le 10$。   \n对于40%的数据满足：$1 \\le n, m \\le 300$。   \n对于100%的数据满足：$1 \\le n, m \\le 500$。   ", "locale": "zh-CN", "translations": {"en": {"title": "Xiao Ming's Game", "background": "", "description": "Xiao Ming recently enjoys playing a game. Given an $n \\times m$ board with two types of cells `#` and `@`. The rules are simple: given a starting position and a target position, each step Xiao Ming can move one cell in one of the four directions: up, down, left, or right. If he moves onto a cell of the same type, the cost is $0$; otherwise, the cost is $1$. Write a program to compute the minimum cost to move from the starting position to the target position.", "inputFormat": "The input contains multiple test cases.  \nThe first line of each test case contains two integers $n$, $m$, the number of rows and columns of the board.  \nThe next $n$ lines each contain $m$ cells (denoted by `#` or `@`).  \nThe next line contains four integers $x_1, y_1, x_2, y_2$, the starting position and the target position, respectively.  \nThe input ends when both $n$ and $m$ are $0$.", "outputFormat": "For each test case, output the minimum cost from the starting position to the target position. Print one result per line.", "hint": "- For 20% of the testdata: $1 \\le n, m \\le 10$.  \n- For 40% of the testdata: $1 \\le n, m \\le 300$.  \n- For 100% of the testdata: $1 \\le n, m \\le 500$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小明的游戏", "background": "", "description": "小明最近喜欢玩一个游戏。给定一个 $n \\times m$ 的棋盘，上面有两种格子 `#` 和 `@`。游戏的规则很简单：给定一个起始位置和一个目标位置，小明每一步能向上，下，左，右四个方向移动一格。如果移动到同一类型的格子，则费用是 $0$，否则费用是 $1$。请编程计算从起始位置移动到目标位置的最小花费。", "inputFormat": "输入文件有多组数据。   \n输入第一行包含两个整数 $n$，$m$，分别表示棋盘的行数和列数。   \n输入接下来的 $n$ 行，每一行有 $m$ 个格子（使用 `#` 或者 `@` 表示）。   \n输入接下来一行有四个整数 $x_1, y_1, x_2, y_2$，分别为起始位置和目标位置。   \n当输入 $n$，$m$ 均为 $0$ 时，表示输入结束。  \n", "outputFormat": "对于每组数据，输出从起始位置到目标位置的最小花费。每一组数据独占一行。", "hint": "对于20%的数据满足：$1 \\le n, m \\le 10$。   \n对于40%的数据满足：$1 \\le n, m \\le 300$。   \n对于100%的数据满足：$1 \\le n, m \\le 500$。   ", "locale": "zh-CN"}}}
{"pid": "P4555", "type": "P", "difficulty": 5, "samples": [["baacaabbacabb", "12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "线段树", "集训队互测", "枚举", "Manacher 算法"], "title": "[国家集训队] 最长双回文串", "background": "", "description": "顺序和逆序读起来完全一样的串叫做回文串。比如 `acbca` 是回文串，而 `abc` 不是：`abc` 的顺序为 `abc`，逆序为 `cba`，不相同。\n\n输入长度为 $n$ 的串 $S$，求 $S$ 的最长双回文子串 $T$，即可将 $T$ 分为两部分 $X, Y$（$|X|,|Y|≥1$）且 $X$ 和 $Y$ 都是回文串。", "inputFormat": "一行由小写英文字母组成的字符串 $S$。", "outputFormat": "一行一个整数，表示最长双回文子串的长度。", "hint": "**样例说明**\n\n从第二个字符开始的字符串 `aacaabbacabb` 可分为 `aacaa` 与 `bbacabb` 两部分，且两者都是回文串。\n\n**数据范围**\n\n对于 $100\\%$ 的数据，$2\\leq |S|\\leq 10^5$。\n\n2018.12.10，2018.12.15：感谢 @Ycrpro 提供 hack 数据两组。", "locale": "zh-CN", "translations": {"en": {"title": "[CTT] Longest Double Palindromic Substring", "background": "", "description": "A string that reads the same forward and backward is called a palindrome. For example, `acbca` is a palindrome, while `abc` is not: the forward order is `abc`, and the reverse is `cba`, which are not the same.\n\nGiven a string $S$ of length $n$, find the longest double palindromic substring $T$ of $S$, that is, $T$ can be divided into two parts $X, Y$ (with $|X|, |Y| \\ge 1$) and both $X$ and $Y$ are palindromes.", "inputFormat": "One line containing a string $S$ consisting of lowercase English letters.", "outputFormat": "One line with a single integer, the length of the longest double palindromic substring.", "hint": "**Sample Explanation**\n\nStarting from the second character, the string `aacaabbacabb` can be split into two parts `aacaa` and `bbacabb`, and both are palindromes.\n\n**Constraints**\n\nFor $100\\%$ of the testdata, $2 \\le |S| \\le 10^5$.\n\n2018.12.10, 2018.12.15: Thanks to @Ycrpro for providing two hack testdata sets.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[国家集训队] 最长双回文串", "background": "", "description": "顺序和逆序读起来完全一样的串叫做回文串。比如 `acbca` 是回文串，而 `abc` 不是：`abc` 的顺序为 `abc`，逆序为 `cba`，不相同。\n\n输入长度为 $n$ 的串 $S$，求 $S$ 的最长双回文子串 $T$，即可将 $T$ 分为两部分 $X, Y$（$|X|,|Y|≥1$）且 $X$ 和 $Y$ 都是回文串。", "inputFormat": "一行由小写英文字母组成的字符串 $S$。", "outputFormat": "一行一个整数，表示最长双回文子串的长度。", "hint": "**样例说明**\n\n从第二个字符开始的字符串 `aacaabbacabb` 可分为 `aacaa` 与 `bbacabb` 两部分，且两者都是回文串。\n\n**数据范围**\n\n对于 $100\\%$ 的数据，$2\\leq |S|\\leq 10^5$。\n\n2018.12.10，2018.12.15：感谢 @Ycrpro 提供 hack 数据两组。", "locale": "zh-CN"}}}
{"pid": "P4556", "type": "P", "difficulty": 6, "samples": [["5 3\n1 2\n3 1\n3 4\n5 3\n2 3 3\n1 5 2\n3 3 3", "2\n3\n3\n0\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["线段树", "O2优化", "线段树合并", "模板题"], "title": "【模板】线段树合并 / [Vani 有约会] 雨天的尾巴", "background": "深绘里一直很讨厌雨天。\n\n灼热的天气穿透了前半个夏天，后来一场大雨和随之而来的洪水，浇灭了一切。\n\n虽然深绘里家乡的小村落对洪水有着顽固的抵抗力，但也倒了几座老房子，几棵老树被连根拔起，以及田地里的粮食被弄得一片狼藉。\n\n无奈的深绘里和村民们只好等待救济粮来维生。\n\n不过救济粮的发放方式很特别。", "description": "村落里一共有 $n$ 座房屋，并形成一个树状结构。然后救济粮分 $m$ 次发放，每次选择两个房屋 $(x, y)$，然后对于 $x$ 到 $y$ 的路径上（含 $x$ 和 $y$）每座房子里发放一袋 $z$ 类型的救济粮。\n\n然后深绘里想知道，当所有的救济粮发放完毕后，每座房子里存放的最多的是哪种救济粮。", "inputFormat": "输入的第一行是两个用空格隔开的正整数，分别代表房屋的个数 $n$ 和救济粮发放的次数 $m$。\n\n第 $2$ 到 第 $n$ 行，每行有两个用空格隔开的整数 $a, b$，代表存在一条连接房屋 $a$ 和 $b$ 的边。\n\n第 $(n + 1)$ 到第 $(n + m)$ 行，每行有三个用空格隔开的整数 $x, y, z$，代表一次救济粮的发放是从 $x$ 到 $y$ 路径上的每栋房子发放了一袋 $z$ 类型的救济粮。", "outputFormat": "输出 $n$ 行，每行一个整数，第 $i$ 行的整数代表 $i$ 号房屋存放最多的救济粮的种类，如果有多种救济粮都是存放最多的，输出种类编号最小的一种。\n\n如果某座房屋没有救济粮，则输出 $0$。", "hint": "- 对于 $20\\%$ 的数据，保证 $n, m \\leq 100$。\n- 对于 $50\\%$ 的数据，保证 $n, m \\leq 2 \\times 10^3$。\n- 对于 $100\\%$ 测试数据，保证 $1 \\leq n, m \\leq 10^5$，$1 \\leq a,b,x,y \\leq n$，$1 \\leq z \\leq 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "【Template】Segment Tree Merge / [Vani's Date] The Tail of a Rainy Day", "background": "Shenhuili has always disliked rainy days.\n\nScorching weather pierced through the first half of summer, then a heavy rain and the ensuing flood extinguished everything.\n\nAlthough the small village of Shenhuili’s hometown had a stubborn resistance to floods, several old houses still collapsed, a few old trees were uprooted, and the crops in the fields were left in a mess.\n\nHelpless, Shenhuili and the villagers could only wait for relief rations to survive.\n\nHowever, the distribution method was special.", "description": "There are $n$ houses in the village, forming a tree. Relief rations are distributed $m$ times. Each time, two houses $(x, y)$ are chosen. For every house on the path from $x$ to $y$ (including $x$ and $y$), one bag of type $z$ relief rations is given.\n\nAfter all distributions are finished, Shenhuili wants to know, for each house, which type of relief rations is stored the most.", "inputFormat": "The first line contains two positive integers $n$ and $m$.\n\nLines $2$ through $n$ each contain two integers $a, b$, indicating that there is an edge between houses $a$ and $b$.\n\nLines $(n + 1)$ through $(n + m)$ each contain three integers $x, y, z$, indicating that in one distribution, every house on the path from $x$ to $y$ receives one bag of type $z$ relief rations.", "outputFormat": "Output $n$ lines. The integer on the $i$-th line is the type of relief rations that appears most in house $i$. If multiple types are tied for the maximum, output the smallest type id.\n\nIf a house has no relief rations, output 0.", "hint": "- For $20\\%$ of the testdata, it is guaranteed that $n, m \\leq 100$.\n- For $50\\%$ of the testdata, it is guaranteed that $n, m \\leq 2 \\times 10^3$.\n- For $100\\%$ of the testdata, it is guaranteed that $1 \\leq n, m \\leq 10^5$, $1 \\leq a, b, x, y \\leq n$, and $1 \\leq z \\leq 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】线段树合并 / [Vani 有约会] 雨天的尾巴", "background": "深绘里一直很讨厌雨天。\n\n灼热的天气穿透了前半个夏天，后来一场大雨和随之而来的洪水，浇灭了一切。\n\n虽然深绘里家乡的小村落对洪水有着顽固的抵抗力，但也倒了几座老房子，几棵老树被连根拔起，以及田地里的粮食被弄得一片狼藉。\n\n无奈的深绘里和村民们只好等待救济粮来维生。\n\n不过救济粮的发放方式很特别。", "description": "村落里一共有 $n$ 座房屋，并形成一个树状结构。然后救济粮分 $m$ 次发放，每次选择两个房屋 $(x, y)$，然后对于 $x$ 到 $y$ 的路径上（含 $x$ 和 $y$）每座房子里发放一袋 $z$ 类型的救济粮。\n\n然后深绘里想知道，当所有的救济粮发放完毕后，每座房子里存放的最多的是哪种救济粮。", "inputFormat": "输入的第一行是两个用空格隔开的正整数，分别代表房屋的个数 $n$ 和救济粮发放的次数 $m$。\n\n第 $2$ 到 第 $n$ 行，每行有两个用空格隔开的整数 $a, b$，代表存在一条连接房屋 $a$ 和 $b$ 的边。\n\n第 $(n + 1)$ 到第 $(n + m)$ 行，每行有三个用空格隔开的整数 $x, y, z$，代表一次救济粮的发放是从 $x$ 到 $y$ 路径上的每栋房子发放了一袋 $z$ 类型的救济粮。", "outputFormat": "输出 $n$ 行，每行一个整数，第 $i$ 行的整数代表 $i$ 号房屋存放最多的救济粮的种类，如果有多种救济粮都是存放最多的，输出种类编号最小的一种。\n\n如果某座房屋没有救济粮，则输出 $0$。", "hint": "- 对于 $20\\%$ 的数据，保证 $n, m \\leq 100$。\n- 对于 $50\\%$ 的数据，保证 $n, m \\leq 2 \\times 10^3$。\n- 对于 $100\\%$ 测试数据，保证 $1 \\leq n, m \\leq 10^5$，$1 \\leq a,b,x,y \\leq n$，$1 \\leq z \\leq 10^5$。", "locale": "zh-CN"}}}
{"pid": "P4557", "type": "P", "difficulty": 7, "samples": [["4 4 3\n0 0\n1 0\n0 1\n1 1\n-1 0\n0 3\n0 2\n0 -1\n0 0\n2 3\n0 -1", "1\n0\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2018", "各省省选", "江苏", "向量", "凸包", "闵可夫斯基和 Minkowski sum"], "title": "[JSOI2018] 战争", "background": "", "description": "九条可怜是一个热爱读书的女孩子。\n\n在她最近正在读的一本小说中，描述了两个敌对部落之间的故事。第一个部落有 $n$ 个人，第二个部落有 $m$ 个人，每一个人的位置可以抽象成二维平面上坐标为 $(x_i,y_i)$ 的点。\n\n在这本书中，人们有很强的领地意识，对于平面上的任何一个点，如果它被三个来自同一部落的人形成的三角形（可能退化成一条线段）包含（包括边界），那么这一个点就属于这一个部落的领地。如果存在一个点同时在两个阵营的领地中，那么这两个部落就会为了争夺这一个点而发生战争。\n\n常年的征战让两个部落不堪重负，因此第二个部落的族长作出了一个英明的决定，他打算选择一个向量 $(dx,dy)$ ，让所有的族人都迁徙这个向量的距离，即所有第二阵营的人的坐标都变成 $(x_i+dx,y_i+dy)$ 。\n\n现在他计划了 $q$ 个迁徙的备选方案，他想要你来帮忙对每一个迁徙方案，计算一下在完成了迁徙之后，两个部落之间还会不会因为争夺领地而发生战争。\n", "inputFormat": "第一行输入三个整数 $n,m,q$，表示两个部落里的人数以及迁徙的备选方案数。\n\n接下来 $n$ 行每行两个整数 $x_i,y_i$​​ 表示第一个部落里的人的坐标。\n\n接下来 $m$ 行每行两个整数 $x_i,y_i$​​ 表示第二个部落里的人的坐标。\n\n接下来 $q$ 行每行两个整数 $dx_i,dy_i$​​ 表示一个迁徙方案。\n\n输入数据保证所有人的坐标两两不同。\n", "outputFormat": "对于每个迁徙方案，输出一行一个整数，$0$ 表示不会发生冲突，$1$ 表示会发生冲突。 ", "hint": "**样例 1 解释**\n\n下图为第一组方案中两个部落的私人领地，点 $(0,0)$ 同时属于两个部落，因此会发生战争。\n\n![0](https://i.loli.net/2018/05/05/5aed12638bab1.png)\n\n下图为第二组方案中两个部落的私人领地，没有点同时属于两个部落，因此不会发生战争。\n\n![1](https://i.loli.net/2018/05/05/5aed1293ce6ca.png)\n\n下图为第三组方案中两个部落的私人领地，点 $(0,0)$ 同时属于两个部落，因此会发生战争。\n\n![2](https://i.loli.net/2018/05/05/5aed12a4e3545.png)\n\n**数据范围**\n\n对于 $20\\%$ 的数据， $n,m\\le 5,q\\le 500$。\n\n对于 $40\\%$ 的数据， $n,m\\le 50,q\\le 500$ 。\n\n对于 $70\\%$ 的数据， $n,m\\le 10^4,q\\le 500$ 。\n\n对于 $100\\%$ 的数据， $n,m\\le 10^5,q\\le 10^5$ 。\n\n对于 $100\\%$ 的数据，保证 $-10^8\\le x_i,y_i,dx_i,dy_i\\le 10^8;n,m\\ge 3$ 。所有人的坐标两两不同且对于每一个阵营,所有人都不全共线。\n\n**2024/08/20 增加 6 组 hack 数据，并公开在本题附件。**", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2018] War", "background": "", "description": "Jiu Tiao Keliang is a girl who loves reading.\n\nIn a novel she is reading recently, there is a story about two hostile tribes. The first tribe has $n$ people, and the second tribe has $m$ people. The position of each person can be abstracted as a point with coordinates $(x_i,y_i)$ on the 2D plane.\n\nIn the novel, people have a strong sense of territory. For any point on the plane, if it is contained (including the boundary) in a triangle formed by three people from the same tribe (which may degenerate into a line segment), then this point belongs to that tribe’s territory. If there exists a point that lies in the territories of both tribes at the same time, then the two tribes will go to war to fight for that point.\n\nYears of war have exhausted both tribes, so the leader of the second tribe made a wise decision. He plans to choose a vector $(dx,dy)$ and move all his people by this vector, i.e., the coordinates of every person in the second tribe become $(x_i+dx,y_i+dy)$.\n\nNow he has prepared $q$ candidate migration plans. For each plan, he wants you to determine whether, after the migration, the two tribes will still go to war over territory.", "inputFormat": "The first line contains three integers $n,m,q$, denoting the numbers of people in the two tribes and the number of candidate migration plans.\n\nThe next $n$ lines each contain two integers $x_i,y_i$, denoting the coordinates of the people in the first tribe.\n\nThe next $m$ lines each contain two integers $x_i,y_i$, denoting the coordinates of the people in the second tribe.\n\nThe next $q$ lines each contain two integers $dx_i,dy_i$, denoting a migration plan.\n\nThe input guarantees that all people’s coordinates are pairwise distinct.", "outputFormat": "For each migration plan, output one integer per line. Output $0$ if no conflict will happen, and $1$ if a conflict will happen.", "hint": "**Sample 1 Explanation**\n\nThe figure below shows the territories of the two tribes in the first plan. The point $(0,0)$ belongs to both tribes, so a war will happen.\n\n![0](https://i.loli.net/2018/05/05/5aed12638bab1.png)\n\nThe figure below shows the territories of the two tribes in the second plan. No point belongs to both tribes, so no war will happen.\n\n![1](https://i.loli.net/2018/05/05/5aed1293ce6ca.png)\n\nThe figure below shows the territories of the two tribes in the third plan. The point $(0,0)$ belongs to both tribes, so a war will happen.\n\n![2](https://i.loli.net/2018/05/05/5aed12a4e3545.png)\n\n**Constraints**\n\nFor $20\\%$ of the testdata, $n,m\\le 5,q\\le 500$.\n\nFor $40\\%$ of the testdata, $n,m\\le 50,q\\le 500$.\n\nFor $70\\%$ of the testdata, $n,m\\le 10^4,q\\le 500$.\n\nFor $100\\%$ of the testdata, $n,m\\le 10^5,q\\le 10^5$.\n\nFor $100\\%$ of the testdata, it is guaranteed that $-10^8\\le x_i,y_i,dx_i,dy_i\\le 10^8$ and $n,m\\ge 3$. All people’s coordinates are pairwise distinct, and for each tribe, not all people are collinear.\n\n**2024/08/20 Added 6 sets of hack testdata, and made them public in the attachments of this problem.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2018] 战争", "background": "", "description": "九条可怜是一个热爱读书的女孩子。\n\n在她最近正在读的一本小说中，描述了两个敌对部落之间的故事。第一个部落有 $n$ 个人，第二个部落有 $m$ 个人，每一个人的位置可以抽象成二维平面上坐标为 $(x_i,y_i)$ 的点。\n\n在这本书中，人们有很强的领地意识，对于平面上的任何一个点，如果它被三个来自同一部落的人形成的三角形（可能退化成一条线段）包含（包括边界），那么这一个点就属于这一个部落的领地。如果存在一个点同时在两个阵营的领地中，那么这两个部落就会为了争夺这一个点而发生战争。\n\n常年的征战让两个部落不堪重负，因此第二个部落的族长作出了一个英明的决定，他打算选择一个向量 $(dx,dy)$ ，让所有的族人都迁徙这个向量的距离，即所有第二阵营的人的坐标都变成 $(x_i+dx,y_i+dy)$ 。\n\n现在他计划了 $q$ 个迁徙的备选方案，他想要你来帮忙对每一个迁徙方案，计算一下在完成了迁徙之后，两个部落之间还会不会因为争夺领地而发生战争。\n", "inputFormat": "第一行输入三个整数 $n,m,q$，表示两个部落里的人数以及迁徙的备选方案数。\n\n接下来 $n$ 行每行两个整数 $x_i,y_i$​​ 表示第一个部落里的人的坐标。\n\n接下来 $m$ 行每行两个整数 $x_i,y_i$​​ 表示第二个部落里的人的坐标。\n\n接下来 $q$ 行每行两个整数 $dx_i,dy_i$​​ 表示一个迁徙方案。\n\n输入数据保证所有人的坐标两两不同。\n", "outputFormat": "对于每个迁徙方案，输出一行一个整数，$0$ 表示不会发生冲突，$1$ 表示会发生冲突。 ", "hint": "**样例 1 解释**\n\n下图为第一组方案中两个部落的私人领地，点 $(0,0)$ 同时属于两个部落，因此会发生战争。\n\n![0](https://i.loli.net/2018/05/05/5aed12638bab1.png)\n\n下图为第二组方案中两个部落的私人领地，没有点同时属于两个部落，因此不会发生战争。\n\n![1](https://i.loli.net/2018/05/05/5aed1293ce6ca.png)\n\n下图为第三组方案中两个部落的私人领地，点 $(0,0)$ 同时属于两个部落，因此会发生战争。\n\n![2](https://i.loli.net/2018/05/05/5aed12a4e3545.png)\n\n**数据范围**\n\n对于 $20\\%$ 的数据， $n,m\\le 5,q\\le 500$。\n\n对于 $40\\%$ 的数据， $n,m\\le 50,q\\le 500$ 。\n\n对于 $70\\%$ 的数据， $n,m\\le 10^4,q\\le 500$ 。\n\n对于 $100\\%$ 的数据， $n,m\\le 10^5,q\\le 10^5$ 。\n\n对于 $100\\%$ 的数据，保证 $-10^8\\le x_i,y_i,dx_i,dy_i\\le 10^8;n,m\\ge 3$ 。所有人的坐标两两不同且对于每一个阵营,所有人都不全共线。\n\n**2024/08/20 增加 6 组 hack 数据，并公开在本题附件。**", "locale": "zh-CN"}}}
{"pid": "P4558", "type": "P", "difficulty": 7, "samples": [["2\n2 4\n0111\n1111\n2 4\n0010\n1000", "2\n5"]], "limits": {"time": [5000, 5000, 5000], "memory": [256000, 256000, 256000]}, "tags": ["2018", "各省省选", "江苏"], "title": "[JSOI2018] 机器人", "background": null, "description": "九条可怜是一个懒懒的女孩子。因为懒得扫地，九条可怜买了一架扫地机器人。\n\n九条可怜的家可以抽象成一个 $n \\times m$ 的网格，坐标从 $(1,1)$ 到 $(n,m)$ 。每一天晚上，可怜都会在 $(1,1)$ 处启动扫地机器人。在启动了之后，扫地机器人会按照设定好的路径开始行动，当再一次回到 $(1,1)$ 后便会停止。\n\n因为一些技术原因，扫地机器人只能向右（列编号加一）或者向下（行编号加一）走。为了让扫地机器人能够顺利的回到 $(1,1)$ ，可怜在家中安装了一些通道，使得：\n\n1.    如果机器人目前在 $(i,m)$ ，那么向右走一步会到 $(i,1)$ 。\n2.    如果机器人目前在 $(n,i)$ ，那么向下走一步回到 $(1,i)$ 。\n\n可怜希望，在启动了机器人之后，在机器人回到 $(1,1)$ 前，它可以经过每一个格子**恰好**一次。这样既可以把家里给打扫干净，也不会花太多时间。经过简单的计算，可怜很快就得到了所有不同的方案（两个方案是不同的当且仅当他们经过格子的顺序不同）。于是可怜把所有的方案都输入到了扫地机器人里。\n\n这一天可怜购置了一些新的家具，放好家具之后，家里便多了一些扫地机器人无法通过的障碍，于是在所有之前准备的方案中，扫地机器人都会撞上某一个障碍而停止工作。\n\n对于一个方案 $S$，可怜定义 $f(S)$ 为在这个方案中，扫地机器人在撞上障碍之前，经过了多少个格子。现在可怜想要对所有不同的方案，计算 $f(S)$ 的和。", "inputFormat": "**输入包含多组测试数据**。\n\n输入第一行一个整数 $T$ 表示测试数据的数量。\n\n对于每组测试数据，第一行输入两个整数 $n,m$ ，表示可怜家的大小。\n\n接下来 $n$ 行每行一个长度为 $m$ 的 01 字符串。第 $i$ 行第 $j$ 个字符是 $0$ 表示坐标 $(i,j)$ 的格子不是障碍，否则表示是障碍。\n\n输入保证 $(1,1)$ 不是障碍且至少有一个障碍。", "outputFormat": "对于每组测试数据，输出一行一个整数表示答案，答案可能很大，对 $998244353$ 取模后输出。", "hint": "**样例 2 解释**\n\n$n=2,m=4$ 时，一共有两种合法的方案：\n\n![0](https://i.loli.net/2018/05/05/5aed14bde4548.png)\n\n在第一种方案中,机器人在撞上障碍 $(1,3)$ 之前，一共经过了 $4$ 个格子。\n\n在第二种方案中,机器人在撞上障碍 $(2,1)$ 之前，一共经过了 $1$ 个格子。\n\n因此第二组测试数据的答案为 $1+4=5$ 。\n\n**数据范围**\n\n测试数据 1 $(20\\%)$: $n,m\\le 4$ 。\n\n测试数据 2 $(30\\%)$: $n,m\\le 50$ ，且除了 $(1,1)$ 外所有格子都是障碍。\n\n测试数据 3 $(50\\%)$: $n,m\\le 50$ 。\n\n对于所有测试数据，$T\\le 10;n,m\\ge 1$ 。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2018] Robot", "background": "", "description": "Jiutiao Kelian (pinyin) is a lazy girl. Because she is too lazy to sweep the floor, she bought a robot vacuum cleaner.\n\nKelian’s home can be abstracted as an $n \\times m$ grid, with coordinates from $(1,1)$ to $(n,m)$. Every night, Kelian starts the robot at $(1,1)$. After being started, the robot follows a preset route and stops when it returns to $(1,1)$ again.\n\nDue to technical reasons, the robot can only move right (column index plus one) or down (row index plus one). To ensure the robot can return to $(1,1)$ smoothly, Kelian installed some corridors such that:\n\n1. If the robot is currently at $(i,m)$, then moving one step to the right takes it to $(i,1)$.\n2. If the robot is currently at $(n,i)$, then moving one step down takes it to $(1,i)$.\n\nKelian hopes that, after starting the robot and before it returns to $(1,1)$, it passes through every cell exactly once. This way the house gets cleaned without taking too much time. After a simple calculation, she quickly obtained all different plans (two plans are different if and only if the orders in which they visit the cells are different). She then loaded all those plans into the robot.\n\nOn this day, Kelian bought some new furniture. After placing the furniture, some cells became obstacles that the robot cannot pass. Under all previously prepared plans, the robot will crash into some obstacle and stop.\n\nFor a plan $S$, define $f(S)$ as the number of cells the robot passes before it hits an obstacle under that plan. Now Kelian wants to compute the sum of $f(S)$ over all different plans.", "inputFormat": "The input contains multiple test cases.\n\nThe first line contains an integer $T$ denoting the number of test cases.\n\nFor each test case, the first line contains two integers $n, m$, denoting the size of the house.\n\nThen follow $n$ lines, each containing a binary string of length $m$. In the $i$-th line, the $j$-th character being '0' means the cell $(i,j)$ is not an obstacle; otherwise it is an obstacle.\n\nIt is guaranteed that $(1,1)$ is not an obstacle and there is at least one obstacle.", "outputFormat": "For each test case, output a single integer, the answer modulo $998244353$.", "hint": "Explanation for Sample 2\n\nWhen $n=2, m=4$, there are two valid plans:\n\n![0](https://i.loli.net/2018/05/05/5aed14bde4548.png)\n\nIn the first plan, the robot passes a total of 4 cells before it crashes into the obstacle at $(1,3)$.\n\nIn the second plan, the robot passes a total of 1 cell before it crashes into the obstacle at $(2,1)$.\n\nTherefore, the answer for the second test case is $1+4=5$.\n\nConstraints\n\n- Testdata 1 $(20\\%)$: $n, m \\le 4$.\n- Testdata 2 $(30\\%)$: $n, m \\le 50$, and all cells except $(1,1)$ are obstacles.\n- Testdata 3 $(50\\%)$: $n, m \\le 50$.\n- For all testdata, $T \\le 10; n, m \\ge 1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2018] 机器人", "background": null, "description": "九条可怜是一个懒懒的女孩子。因为懒得扫地，九条可怜买了一架扫地机器人。\n\n九条可怜的家可以抽象成一个 $n \\times m$ 的网格，坐标从 $(1,1)$ 到 $(n,m)$ 。每一天晚上，可怜都会在 $(1,1)$ 处启动扫地机器人。在启动了之后，扫地机器人会按照设定好的路径开始行动，当再一次回到 $(1,1)$ 后便会停止。\n\n因为一些技术原因，扫地机器人只能向右（列编号加一）或者向下（行编号加一）走。为了让扫地机器人能够顺利的回到 $(1,1)$ ，可怜在家中安装了一些通道，使得：\n\n1.    如果机器人目前在 $(i,m)$ ，那么向右走一步会到 $(i,1)$ 。\n2.    如果机器人目前在 $(n,i)$ ，那么向下走一步回到 $(1,i)$ 。\n\n可怜希望，在启动了机器人之后，在机器人回到 $(1,1)$ 前，它可以经过每一个格子**恰好**一次。这样既可以把家里给打扫干净，也不会花太多时间。经过简单的计算，可怜很快就得到了所有不同的方案（两个方案是不同的当且仅当他们经过格子的顺序不同）。于是可怜把所有的方案都输入到了扫地机器人里。\n\n这一天可怜购置了一些新的家具，放好家具之后，家里便多了一些扫地机器人无法通过的障碍，于是在所有之前准备的方案中，扫地机器人都会撞上某一个障碍而停止工作。\n\n对于一个方案 $S$，可怜定义 $f(S)$ 为在这个方案中，扫地机器人在撞上障碍之前，经过了多少个格子。现在可怜想要对所有不同的方案，计算 $f(S)$ 的和。", "inputFormat": "**输入包含多组测试数据**。\n\n输入第一行一个整数 $T$ 表示测试数据的数量。\n\n对于每组测试数据，第一行输入两个整数 $n,m$ ，表示可怜家的大小。\n\n接下来 $n$ 行每行一个长度为 $m$ 的 01 字符串。第 $i$ 行第 $j$ 个字符是 $0$ 表示坐标 $(i,j)$ 的格子不是障碍，否则表示是障碍。\n\n输入保证 $(1,1)$ 不是障碍且至少有一个障碍。", "outputFormat": "对于每组测试数据，输出一行一个整数表示答案，答案可能很大，对 $998244353$ 取模后输出。", "hint": "**样例 2 解释**\n\n$n=2,m=4$ 时，一共有两种合法的方案：\n\n![0](https://i.loli.net/2018/05/05/5aed14bde4548.png)\n\n在第一种方案中,机器人在撞上障碍 $(1,3)$ 之前，一共经过了 $4$ 个格子。\n\n在第二种方案中,机器人在撞上障碍 $(2,1)$ 之前，一共经过了 $1$ 个格子。\n\n因此第二组测试数据的答案为 $1+4=5$ 。\n\n**数据范围**\n\n测试数据 1 $(20\\%)$: $n,m\\le 4$ 。\n\n测试数据 2 $(30\\%)$: $n,m\\le 50$ ，且除了 $(1,1)$ 外所有格子都是障碍。\n\n测试数据 3 $(50\\%)$: $n,m\\le 50$ 。\n\n对于所有测试数据，$T\\le 10;n,m\\ge 1$ 。", "locale": "zh-CN"}}}
