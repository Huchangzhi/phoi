{"pid": "P5832", "type": "P", "difficulty": 1, "samples": [["7\nABCDABC", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "2019", "USACO"], "title": "[USACO19DEC] Where Am I? B", "background": "", "description": "Farmer John 出门沿着马路散步，但是他现在发现可能迷路了！\n\n沿路有一排共 $N$ 个农场。不幸的是农场并没有编号，这使得 Farmer John 难以分辨他在这条路上所处的位置。然而，每个农场都沿路设有一个彩色的邮箱，所以 Farmer John 希望能够通过查看最近的几个邮箱的颜色来唯一确定他所在的位置。\n\n每个邮箱的颜色用 A..Z 之间的一个字母来指定，所以沿着道路的 $N$ 个邮箱的序列可以用一个长为 $N$ 的由字母 A..Z 组成的字符串来表示。某些邮箱可能会有相同的颜色。Farmer John 想要知道最小的 $K$ 的值，使得他查看任意连续 $K$ 个邮箱序列，他都可以唯一确定这一序列在道路上的位置。\n\n例如，假设沿路的邮箱序列为 `ABCDABC` 。Farmer John 不能令 $K=3$，因为如果他看到了 `ABC`，沿路有两个这一连续颜色序列可能所在的位置。最小可行的 $K$ 的值为 $K=4$，因为如果他查看任意连续 4 个邮箱，这一颜色序列可以唯一确定他在道路上的位置。", "inputFormat": "输入的第一行包含 $N$，第二行包含一个由 $N$ 个字符组成的字符串，每个字符均在 A..Z 之内。", "outputFormat": "输出一行，包含一个整数，为可以解决 Farmer John 的问题的最小 $K$ 值。", "hint": "$1 \\leq N \\leq 100$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19DEC] Where Am I? B", "background": "", "description": "Farmer John goes out for a walk along the road, but now he realizes he might be lost.\n\nAlong the road there is a line of $N$ farms. Unfortunately, the farms are not numbered, which makes it hard for Farmer John to tell where he is on this road. However, each farm has a colored mailbox by the roadside, so Farmer John hopes to uniquely determine his position by looking at the colors of the most recent few mailboxes.\n\nEach mailbox color is specified by a letter from A..Z, so the sequence of $N$ mailboxes along the road can be represented as a string of length $N$ consisting of letters A..Z. Some mailboxes may have the same color. Farmer John wants to know the smallest value of $K$ such that, by looking at any consecutive sequence of $K$ mailboxes, he can uniquely determine where this sequence occurs on the road.\n\nFor example, suppose the mailbox sequence along the road is `ABCDABC`. Farmer John cannot set $K=3$, because if he sees `ABC`, there are two possible positions on the road where this consecutive color sequence could be. The smallest feasible value is $K=4$, because if he looks at any consecutive 4 mailboxes, that color sequence can uniquely determine his position on the road.", "inputFormat": "The first line of input contains $N$. The second line contains a string of $N$ characters, each of which is in A..Z.", "outputFormat": "Output one line containing an integer: the minimum value of $K$ that can solve Farmer John's problem.", "hint": "Constraints: $1 \\leq N \\leq 100$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19DEC] Where Am I? B", "background": "", "description": "Farmer John 出门沿着马路散步，但是他现在发现可能迷路了！\n\n沿路有一排共 $N$ 个农场。不幸的是农场并没有编号，这使得 Farmer John 难以分辨他在这条路上所处的位置。然而，每个农场都沿路设有一个彩色的邮箱，所以 Farmer John 希望能够通过查看最近的几个邮箱的颜色来唯一确定他所在的位置。\n\n每个邮箱的颜色用 A..Z 之间的一个字母来指定，所以沿着道路的 $N$ 个邮箱的序列可以用一个长为 $N$ 的由字母 A..Z 组成的字符串来表示。某些邮箱可能会有相同的颜色。Farmer John 想要知道最小的 $K$ 的值，使得他查看任意连续 $K$ 个邮箱序列，他都可以唯一确定这一序列在道路上的位置。\n\n例如，假设沿路的邮箱序列为 `ABCDABC` 。Farmer John 不能令 $K=3$，因为如果他看到了 `ABC`，沿路有两个这一连续颜色序列可能所在的位置。最小可行的 $K$ 的值为 $K=4$，因为如果他查看任意连续 4 个邮箱，这一颜色序列可以唯一确定他在道路上的位置。", "inputFormat": "输入的第一行包含 $N$，第二行包含一个由 $N$ 个字符组成的字符串，每个字符均在 A..Z 之内。", "outputFormat": "输出一行，包含一个整数，为可以解决 Farmer John 的问题的最小 $K$ 值。", "hint": "$1 \\leq N \\leq 100$。", "locale": "zh-CN"}}}
{"pid": "P5833", "type": "P", "difficulty": 2, "samples": [["3\nButtercup must be milked beside Bella\nBlue must be milked beside Bella\nSue must be milked beside Beatrice", "Beatrice\nSue\nBelinda\nBessie\nBetsy\nBlue\nBella\nButtercup"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "2019", "USACO", "枚举"], "title": "[USACO19DEC] Livestock Lineup B", "background": "", "description": "每天，Farmer John 都要给他的 $8$ 头奶牛挤奶。她们的名字分别是 Bessie，Buttercup，Belinda，Beatrice，Bella，Blue，Betsy，和 Sue。\n\n不幸的是，这些奶牛相当难以伺候，她们要求 Farmer John 以一种符合 $N$ 条限制的顺序给她们挤奶。每条限制的形式为“$X$ 必须紧邻着 $Y$ 挤奶”，要求奶牛 $X$ 在挤奶顺序中必须紧接在奶牛 $Y$ 之后，或者紧接在奶牛 $Y$ 之前。\n\n请帮助 Farmer John 求出一种满足所有限制的奶牛挤奶顺序。保证这样的顺序是存在的。如果有多种顺序都满足要求，请输出字典序最小的一种。也就是说，第一头奶牛需要是所有可能排在任意合法奶牛顺序的第一位的奶牛中名字字典序最小的。在所有合法的以这头字典序最小的奶牛为首的奶牛顺序中，第二头奶牛需要是字典序最小的，以此类推。", "inputFormat": "输入的第一行包含 $N$。以下 $N$ 行每行包含一句句子，以 \"$X$ must be milked beside $Y$\" 的格式描述了一条限制，其中 $X$ 和 $Y$ 为 Farmer John 的某些奶牛的名字（上文列举了八个可能的名字）。", "outputFormat": "请用 $8$ 行输出一个奶牛的顺序，每行输出一头奶牛的名字，满足所有的限制。如果由多种顺序符合要求，输出字典序最小的奶牛顺序。", "hint": "$1 \\leq N \\leq 7$。\n\n供题：Brian Dean", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19DEC] Livestock Lineup B", "background": "", "description": "Every day, Farmer John milks his $8$ cows. Their names are Bessie, Buttercup, Belinda, Beatrice, Bella, Blue, Betsy, and Sue.\n\nUnfortunately, these cows are quite hard to deal with. They require Farmer John to milk them in an order that satisfies $N$ constraints. Each constraint is of the form \"$X$ must be milked beside $Y$\", meaning cow $X$ must be immediately after cow $Y$ in the milking order, or immediately before cow $Y$.\n\nPlease help Farmer John find a milking order that satisfies all constraints. It is guaranteed that such an order exists. If there are multiple valid orders, output the one with the smallest lexicographical order. That is, the first cow must be the one with the smallest name in lexicographical order among all cows that can appear first in some valid milking order. Among all valid milking orders that start with this lexicographically smallest cow, the second cow must be lexicographically smallest, and so on.", "inputFormat": "The first line contains $N$. The next $N$ lines each contain a sentence describing a constraint in the format \"$X$ must be milked beside $Y$\", where $X$ and $Y$ are names of Farmer John's cows (from the eight possible names listed above).", "outputFormat": "Output a cow order in $8$ lines, one cow name per line, satisfying all constraints. If multiple orders satisfy the requirements, output the lexicographically smallest cow order.", "hint": "$1 \\leq N \\leq 7$.\n\nProblem by: Brian Dean.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19DEC] Livestock Lineup B", "background": "", "description": "每天，Farmer John 都要给他的 $8$ 头奶牛挤奶。她们的名字分别是 Bessie，Buttercup，Belinda，Beatrice，Bella，Blue，Betsy，和 Sue。\n\n不幸的是，这些奶牛相当难以伺候，她们要求 Farmer John 以一种符合 $N$ 条限制的顺序给她们挤奶。每条限制的形式为“$X$ 必须紧邻着 $Y$ 挤奶”，要求奶牛 $X$ 在挤奶顺序中必须紧接在奶牛 $Y$ 之后，或者紧接在奶牛 $Y$ 之前。\n\n请帮助 Farmer John 求出一种满足所有限制的奶牛挤奶顺序。保证这样的顺序是存在的。如果有多种顺序都满足要求，请输出字典序最小的一种。也就是说，第一头奶牛需要是所有可能排在任意合法奶牛顺序的第一位的奶牛中名字字典序最小的。在所有合法的以这头字典序最小的奶牛为首的奶牛顺序中，第二头奶牛需要是字典序最小的，以此类推。", "inputFormat": "输入的第一行包含 $N$。以下 $N$ 行每行包含一句句子，以 \"$X$ must be milked beside $Y$\" 的格式描述了一条限制，其中 $X$ 和 $Y$ 为 Farmer John 的某些奶牛的名字（上文列举了八个可能的名字）。", "outputFormat": "请用 $8$ 行输出一个奶牛的顺序，每行输出一头奶牛的名字，满足所有的限制。如果由多种顺序符合要求，输出字典序最小的奶牛顺序。", "hint": "$1 \\leq N \\leq 7$。\n\n供题：Brian Dean", "locale": "zh-CN"}}}
{"pid": "P5834", "type": "P", "difficulty": 2, "samples": [["4", "7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2019", "USACO"], "title": "[USACO19DEC] MooBuzz S", "background": "", "description": "Farmer John 的奶牛们最近成为了一个简单的数字游戏“FizzBuzz”的狂热玩家。这个游戏的规则很简单：奶牛们站成一圈，依次从一开始报数，每头奶牛在轮到她的时候报一个数。如果一头奶牛将要报的数字是 $3$ 的倍数，她应当报 `Fizz` 来代替这个数。如果一头奶牛将要报的数字是 $5$ 的倍数，她应当报 `Buzz` 来代替这个数。如果一头奶牛将要报的数字是 $15$ 的倍数，她应当报 `FizzBuzz` 来代替这个数。于是这个游戏的开始部分的记录为：\n\n`1, 2, Fizz, 4, Buzz, Fizz, 7, 8, Fizz, Buzz, 11, Fizz, 13, 14, FizzBuzz, 16`\n\n由于词汇的匮乏，奶牛们玩的 FizzBuzz 中用`Moo` 代替了 `Fizz`、`Buzz`、`FizzBuzz`。于是奶牛版的游戏的开始部分的记录为：\n\n`1, 2, Moo, 4, Moo, Moo, 7, 8, Moo, Moo, 11, Moo, 13, 14, Moo, 16`\n\n给定 $N$，请求出这个游戏中第 $N$ 个被报的数。", "inputFormat": "输入包含一个整数 $N$。", "outputFormat": "输出游戏中被报出的第 $N$ 个数。", "hint": "关于部分分：\n\n测试点 $1$ 为样例。\n\n测试点 $2\\sim 5$ 满足 $N\\le 10^6$。\n\n对于 $100\\%$ 的数据，$1 \\leq N \\leq 10^9$\n\n供题：Brian Dean", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19DEC] MooBuzz S", "background": "", "description": "Farmer John’s cows have recently become enthusiastic players of a simple number game called “FizzBuzz.” The rules of this game are simple: the cows stand in a circle and count in order starting from $1$, and each cow says one item when it is her turn. If the number a cow is about to say is a multiple of $3$, she should say `Fizz` instead of the number. If it is a multiple of $5$, she should say `Buzz` instead of the number. If it is a multiple of $15$, she should say `FizzBuzz` instead of the number. Therefore, the beginning of the record of the game is:\n\n`1, 2, Fizz, 4, Buzz, Fizz, 7, 8, Fizz, Buzz, 11, Fizz, 13, 14, FizzBuzz, 16`\n\nDue to a limited vocabulary, in the cows’ version of FizzBuzz they use `Moo` to replace `Fizz`, `Buzz`, and `FizzBuzz`. Therefore, the beginning of the record of the cows’ game is:\n\n`1, 2, Moo, 4, Moo, Moo, 7, 8, Moo, Moo, 11, Moo, 13, 14, Moo, 16`\n\nGiven $N$, find the $N$-th number that is spoken in this game.", "inputFormat": "The input contains one integer $N$.", "outputFormat": "Output the $N$-th number spoken in the game.", "hint": "About partial scoring:\n\nTest point $1$ is the sample.\n\nTest points $2 \\sim 5$ satisfy $N \\le 10^6$.\n\nFor $100\\%$ of the testdata, $1 \\leq N \\leq 10^9$.\n\nProblem by: Brian Dean.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19DEC] MooBuzz S", "background": "", "description": "Farmer John 的奶牛们最近成为了一个简单的数字游戏“FizzBuzz”的狂热玩家。这个游戏的规则很简单：奶牛们站成一圈，依次从一开始报数，每头奶牛在轮到她的时候报一个数。如果一头奶牛将要报的数字是 $3$ 的倍数，她应当报 `Fizz` 来代替这个数。如果一头奶牛将要报的数字是 $5$ 的倍数，她应当报 `Buzz` 来代替这个数。如果一头奶牛将要报的数字是 $15$ 的倍数，她应当报 `FizzBuzz` 来代替这个数。于是这个游戏的开始部分的记录为：\n\n`1, 2, Fizz, 4, Buzz, Fizz, 7, 8, Fizz, Buzz, 11, Fizz, 13, 14, FizzBuzz, 16`\n\n由于词汇的匮乏，奶牛们玩的 FizzBuzz 中用`Moo` 代替了 `Fizz`、`Buzz`、`FizzBuzz`。于是奶牛版的游戏的开始部分的记录为：\n\n`1, 2, Moo, 4, Moo, Moo, 7, 8, Moo, Moo, 11, Moo, 13, 14, Moo, 16`\n\n给定 $N$，请求出这个游戏中第 $N$ 个被报的数。", "inputFormat": "输入包含一个整数 $N$。", "outputFormat": "输出游戏中被报出的第 $N$ 个数。", "hint": "关于部分分：\n\n测试点 $1$ 为样例。\n\n测试点 $2\\sim 5$ 满足 $N\\le 10^6$。\n\n对于 $100\\%$ 的数据，$1 \\leq N \\leq 10^9$\n\n供题：Brian Dean", "locale": "zh-CN"}}}
{"pid": "P5835", "type": "P", "difficulty": 5, "samples": [["3 5\n1 1 1\n2 2 -1\n3 3 -1", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "二分", "USACO", "排序", "队列"], "title": "[USACO19DEC] Meetings S", "background": "", "description": "有两个牛棚位于一维数轴上的点 $0$ 和 $L$ 处（$1 \\leq L \\leq 10^9$）。同时有 $N$ 头奶牛（$1 \\leq N \\leq 5 \\times 10^4$）位于数轴上不同的位置（将牛棚和奶牛看作点）。每头奶牛 $i$ 初始时位于某个位置 $x_i$，并朝着正向或负向以一个单位每秒的速度移动，用一个等于 $1$ 或 $-1$ 的整数 $d_i$ 表示。每头奶牛还拥有一个在范围 $[1,10^3]$ 内的重量。所有奶牛始终以恒定的速度移动，直到以下事件之一发生：\n- 如果奶牛 $i$ 移动到了一个牛棚，则奶牛 $i$ 停止移动。\n- 当奶牛 $i$ 和 $j$ 占据了相同的点的时候，并且这一点不是一个牛棚，则发生了相遇。此时，奶牛 $i$ 被赋予奶牛 $j$ 先前的速度，反之亦然。注意奶牛可能在一个非整数点相遇。\n\n令 $T$ 等于停止移动的奶牛（由于到达两个牛棚之一）的重量之和至少等于所有奶牛的重量之和的一半的最早时刻。请求出在时刻 $0 \\ldots T$（包括时刻 $T$）之间发生的奶牛对相遇的总数。\n", "inputFormat": "输入的第一行包含两个空格分隔的整数 $N$ 和 $L$。\n\n以下 $N$ 行，每行包含三个空格分隔的整数 $w_i$，$x_i$ 以及 $d_i$。所有的位置 $x_i$ 各不相同，并且满足 $0<x_i<L$。", "outputFormat": "输出一行，包含答案。", "hint": "### 样例解释\n\n在这个例子中，奶牛们按如下方式移动：\n\n1. 第一和第二头奶牛于时刻 0.5 在位置 1.5 相遇。此时第一头奶牛拥有速度 -1，第二头奶牛拥有速度 1。\n2. 第二和第三头奶牛于时刻 1 在位置 2 相遇。此时第二头奶牛拥有速度 −1，第三头奶牛拥有速度 1。\n3. 第一头奶牛于时刻 2 到达左边的牛棚。\n4. 第二头奶牛于时刻 3 到达左边的牛棚。\n5. 由于到达牛棚的奶牛的总重量已经至少是所有奶牛的总重量的一半，这个过程此时终止。如果继续进行下去，第三头奶牛将会在时刻 4 到达右边的牛棚。\n\n发生了恰好两次相遇。 \n\n### 子任务\n\n测试点 $2\\sim 4$ 满足 $N\\le 10^2$，并且对所有 $i$，$w_i=1$。\n\n测试点 $5\\sim 7$ 满足 $N\\le 10^2$。\n\n供题：Benjamin Qi", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19DEC] Meetings S", "background": "", "description": "There are two barns located at points $0$ and $L$ on a one-dimensional number line ($1 \\leq L \\leq 10^9$). There are also $N$ cows ($1 \\leq N \\leq 5 \\times 10^4$) at distinct positions on the number line (treat the barns and cows as points). Each cow $i$ starts at position $x_i$ and moves at a speed of 1 unit per second in either the positive or negative direction, represented by an integer $d_i$ equal to $1$ or $-1$. Each cow also has a weight in the range $[1,10^3]$. All cows move at constant speed until one of the following events happens:\n\n- If cow $i$ reaches a barn, then cow $i$ stops moving.\n- When cows $i$ and $j$ occupy the same point, and this point is not a barn, then a meeting happens. At that moment, cow $i$ is given cow $j$'s previous velocity, and vice versa. Note that cows may meet at a non-integer point.\n\nLet $T$ be the earliest time such that the total weight of the cows that have stopped moving (because they reached one of the two barns) is at least half of the total weight of all cows. Find the total number of pairwise cow meetings that occur during time $0 \\ldots T$ (including time $T$).", "inputFormat": "The first line contains two space-separated integers $N$ and $L$.\n\nThe next $N$ lines each contain three space-separated integers $w_i$, $x_i$, and $d_i$. All positions $x_i$ are distinct and satisfy $0 < x_i < L$.", "outputFormat": "Output one line containing the answer.", "hint": "### Sample Explanation\n\nIn this example, the cows move as follows:\n\n1. The first and second cows meet at time 0.5 at position 1.5. At this time, the first cow has velocity -1, and the second cow has velocity 1.\n2. The second and third cows meet at time 1 at position 2. At this time, the second cow has velocity −1, and the third cow has velocity 1.\n3. The first cow reaches the left barn at time 2.\n4. The second cow reaches the left barn at time 3.\n5. Since the total weight of the cows that have reached a barn is already at least half of the total weight of all cows, the process stops at this time. If it continued, the third cow would reach the right barn at time 4.\n\nExactly two meetings occur.\n\n### Subtasks\n\nTestdata 2 to 4 satisfy $N \\leq 10^2$, and for all $i$, $w_i = 1$.\n\nTestdata 5 to 7 satisfy $N \\leq 10^2$.\n\nProblem author: Benjamin Qi.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19DEC] Meetings S", "background": "", "description": "有两个牛棚位于一维数轴上的点 $0$ 和 $L$ 处（$1 \\leq L \\leq 10^9$）。同时有 $N$ 头奶牛（$1 \\leq N \\leq 5 \\times 10^4$）位于数轴上不同的位置（将牛棚和奶牛看作点）。每头奶牛 $i$ 初始时位于某个位置 $x_i$，并朝着正向或负向以一个单位每秒的速度移动，用一个等于 $1$ 或 $-1$ 的整数 $d_i$ 表示。每头奶牛还拥有一个在范围 $[1,10^3]$ 内的重量。所有奶牛始终以恒定的速度移动，直到以下事件之一发生：\n- 如果奶牛 $i$ 移动到了一个牛棚，则奶牛 $i$ 停止移动。\n- 当奶牛 $i$ 和 $j$ 占据了相同的点的时候，并且这一点不是一个牛棚，则发生了相遇。此时，奶牛 $i$ 被赋予奶牛 $j$ 先前的速度，反之亦然。注意奶牛可能在一个非整数点相遇。\n\n令 $T$ 等于停止移动的奶牛（由于到达两个牛棚之一）的重量之和至少等于所有奶牛的重量之和的一半的最早时刻。请求出在时刻 $0 \\ldots T$（包括时刻 $T$）之间发生的奶牛对相遇的总数。\n", "inputFormat": "输入的第一行包含两个空格分隔的整数 $N$ 和 $L$。\n\n以下 $N$ 行，每行包含三个空格分隔的整数 $w_i$，$x_i$ 以及 $d_i$。所有的位置 $x_i$ 各不相同，并且满足 $0<x_i<L$。", "outputFormat": "输出一行，包含答案。", "hint": "### 样例解释\n\n在这个例子中，奶牛们按如下方式移动：\n\n1. 第一和第二头奶牛于时刻 0.5 在位置 1.5 相遇。此时第一头奶牛拥有速度 -1，第二头奶牛拥有速度 1。\n2. 第二和第三头奶牛于时刻 1 在位置 2 相遇。此时第二头奶牛拥有速度 −1，第三头奶牛拥有速度 1。\n3. 第一头奶牛于时刻 2 到达左边的牛棚。\n4. 第二头奶牛于时刻 3 到达左边的牛棚。\n5. 由于到达牛棚的奶牛的总重量已经至少是所有奶牛的总重量的一半，这个过程此时终止。如果继续进行下去，第三头奶牛将会在时刻 4 到达右边的牛棚。\n\n发生了恰好两次相遇。 \n\n### 子任务\n\n测试点 $2\\sim 4$ 满足 $N\\le 10^2$，并且对所有 $i$，$w_i=1$。\n\n测试点 $5\\sim 7$ 满足 $N\\le 10^2$。\n\n供题：Benjamin Qi", "locale": "zh-CN"}}}
{"pid": "P5836", "type": "P", "difficulty": 3, "samples": [["5 5\nHHGHG\n1 2\n2 3\n2 4\n1 5\n1 4 H\n1 4 G\n1 3 G\n1 3 H\n5 5 H", "10110"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "树形数据结构", "2019", "USACO", "并查集", "最近公共祖先 LCA"], "title": "[USACO19DEC] Milk Visits S", "background": "", "description": "Farmer John 计划建造 $N$ 个农场，用 $N-1$ 条道路连接，构成一棵树（也就是说，所有农场之间都互相可以到达，并且没有环）。每个农场有一头奶牛，品种为更赛牛或荷斯坦牛之一。\n\nFarmer John 的 $M$ 个朋友经常前来拜访他。在朋友 $i$ 拜访之时，Farmer John 会与他的朋友沿着从农场 $A_i$ 到农场 $B_i$ 之间的唯一路径行走（可能有 $A_i = B_i$）。除此之外，他们还可以品尝他们经过的路径上任意一头奶牛的牛奶。由于 Farmer John 的朋友们大多数也是农场主，他们对牛奶有着极强的偏好。他的有些朋友只喝更赛牛的牛奶，其余的只喝荷斯坦牛的牛奶。任何 Farmer John 的朋友只有在他们访问时能喝到他们偏好的牛奶才会高兴。\n\n请求出每个朋友在拜访过后是否会高兴。", "inputFormat": "输入的第一行包含两个整数 $N$ 和 $M$。\n\n第二行包含一个长为 $N$ 的字符串。如果第 $i$ 个农场中的奶牛是更赛牛，则字符串中第 $i$ 个字符为 `G`，如果第 $i$ 个农场中的奶牛是荷斯坦牛则为 `H`。\n\n以下 $N-1$ 行，每行包含两个不同的整数 $X$ 和 $Y$（$1 \\leq X, Y \\leq N$），表示农场 $X$ 与 $Y$ 之间有一条道路。\n\n以下 $M$ 行，每行包含整数 $A_i$，$B_i$，以及一个字符 $C_i$。$A_i$ 和 $B_i$ 表示朋友 $i$ 拜访时行走的路径的端点，$C_i$ 是 `G` 或 `H` 之一，表示第 $i$ 个朋友喜欢更赛牛的牛奶或是荷斯坦牛的牛奶。", "outputFormat": "输出一个长为 $M$ 的二进制字符串。如果第 $i$ 个朋友会感到高兴，则字符串的第 $i$ 个字符为 `1`，否则为 `0`。", "hint": "在这里，从农场 1 到农场 4 的路径包括农场 1、2 和 4。所有这些农场里都是荷斯坦牛，所以第一个朋友会感到满意，而第二个朋友不会。\n\n关于部分分：\n\n测试点 $1$ 样例。\n\n测试点 $2\\sim 5$ 满足 $N\\le 10^3$，$M\\le 2\\cdot 10^3$。\n\n对于 $100\\%$ 的数据，$1 \\leq N \\leq 10^5$，$1 \\leq M \\leq 10^5$。\n\n供题：Spencer Compton", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19DEC] Milk Visits S", "background": "", "description": "Farmer John plans to build $N$ farms and connect them with $N-1$ roads, forming a tree (that is, all farms are reachable from each other, and there are no cycles). Each farm has one cow, whose breed is either Guernsey or Holstein.\n\nFarmer John has $M$ friends who often come to visit him. When friend $i$ visits, Farmer John and this friend will walk along the unique path from farm $A_i$ to farm $B_i$ (it is possible that $A_i = B_i$). Also, they can taste the milk from any cow on the path they travel. Since most of Farmer John’s friends are also farmers, they have a very strong preference for milk. Some friends only drink Guernsey milk, and the rest only drink Holstein milk. A friend will be happy only if, during their visit, they can drink the type of milk they prefer.\n\nFor each friend, determine whether they will be happy after the visit.", "inputFormat": "The first line contains two integers $N$ and $M$.\n\nThe second line contains a string of length $N$. If the cow on farm $i$ is a Guernsey cow, then the $i$-th character is `G`; if the cow on farm $i$ is a Holstein cow, then the $i$-th character is `H`.\n\nThe next $N-1$ lines each contain two distinct integers $X$ and $Y$ ($1 \\leq X, Y \\leq N$), indicating that there is a road between farms $X$ and $Y$.\n\nThe next $M$ lines each contain integers $A_i$, $B_i$, and a character $C_i$. $A_i$ and $B_i$ are the endpoints of the path that friend $i$ walks during the visit. $C_i$ is one of `G` or `H`, indicating whether friend $i$ likes Guernsey milk or Holstein milk.", "outputFormat": "Output a binary string of length $M$. If friend $i$ will be happy, then the $i$-th character is `1`; otherwise it is `0`.", "hint": "Here, the path from farm 1 to farm 4 includes farms 1, 2, and 4. All these farms have Holstein cows, so the first friend will be satisfied, while the second friend will not.\n\nAbout subtasks:\n\nTest point $1$ is the sample.\n\nTest points $2\\sim 5$ satisfy $N \\le 10^3$, $M \\le 2\\cdot 10^3$.\n\nFor $100\\%$ of the testdata, $1 \\leq N \\leq 10^5$, $1 \\leq M \\leq 10^5$.\n\nProblem by: Spencer Compton.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19DEC] Milk Visits S", "background": "", "description": "Farmer John 计划建造 $N$ 个农场，用 $N-1$ 条道路连接，构成一棵树（也就是说，所有农场之间都互相可以到达，并且没有环）。每个农场有一头奶牛，品种为更赛牛或荷斯坦牛之一。\n\nFarmer John 的 $M$ 个朋友经常前来拜访他。在朋友 $i$ 拜访之时，Farmer John 会与他的朋友沿着从农场 $A_i$ 到农场 $B_i$ 之间的唯一路径行走（可能有 $A_i = B_i$）。除此之外，他们还可以品尝他们经过的路径上任意一头奶牛的牛奶。由于 Farmer John 的朋友们大多数也是农场主，他们对牛奶有着极强的偏好。他的有些朋友只喝更赛牛的牛奶，其余的只喝荷斯坦牛的牛奶。任何 Farmer John 的朋友只有在他们访问时能喝到他们偏好的牛奶才会高兴。\n\n请求出每个朋友在拜访过后是否会高兴。", "inputFormat": "输入的第一行包含两个整数 $N$ 和 $M$。\n\n第二行包含一个长为 $N$ 的字符串。如果第 $i$ 个农场中的奶牛是更赛牛，则字符串中第 $i$ 个字符为 `G`，如果第 $i$ 个农场中的奶牛是荷斯坦牛则为 `H`。\n\n以下 $N-1$ 行，每行包含两个不同的整数 $X$ 和 $Y$（$1 \\leq X, Y \\leq N$），表示农场 $X$ 与 $Y$ 之间有一条道路。\n\n以下 $M$ 行，每行包含整数 $A_i$，$B_i$，以及一个字符 $C_i$。$A_i$ 和 $B_i$ 表示朋友 $i$ 拜访时行走的路径的端点，$C_i$ 是 `G` 或 `H` 之一，表示第 $i$ 个朋友喜欢更赛牛的牛奶或是荷斯坦牛的牛奶。", "outputFormat": "输出一个长为 $M$ 的二进制字符串。如果第 $i$ 个朋友会感到高兴，则字符串的第 $i$ 个字符为 `1`，否则为 `0`。", "hint": "在这里，从农场 1 到农场 4 的路径包括农场 1、2 和 4。所有这些农场里都是荷斯坦牛，所以第一个朋友会感到满意，而第二个朋友不会。\n\n关于部分分：\n\n测试点 $1$ 样例。\n\n测试点 $2\\sim 5$ 满足 $N\\le 10^3$，$M\\le 2\\cdot 10^3$。\n\n对于 $100\\%$ 的数据，$1 \\leq N \\leq 10^5$，$1 \\leq M \\leq 10^5$。\n\n供题：Spencer Compton", "locale": "zh-CN"}}}
{"pid": "P5837", "type": "P", "difficulty": 4, "samples": [["3 2\n2 1 2 4\n2 3 5 3", "428571"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["图论", "2019", "USACO", "最短路"], "title": "[USACO19DEC] Milk Pumping G", "background": "", "description": "Farmer John 最近为了扩张他的牛奶产业帝国而收购了一个新的农场。这一新的农场通过一个管道网络与附近的小镇相连，FJ 想要找出其中最合适的一组管道，将其购买并用来将牛奶从农场输送到小镇。\n\n这个管道网络可以用 $N$ 个接合点（管道的端点）来描述，将其编号为 $1 \\ldots N$。接合点 $1$ 表示 FJ 的农场，接合点 $N$ 表示小镇。有 $M$ 条双向的管道，每条连接了两个接合点。使用第 $i$ 条管道需要 FJ 花费 $c_i$ 美元购入，可以支持每秒 $f_i$ 升牛奶的流量。\n\nFJ 想要购买一条管道组成一条单一路径，路径的两端点分别为接合点 $1$ 和 $N$。这条路径的花费等于路径上所有管道的费用之和。路径上的流量等于路径上所有管道的最小流量（因为这是沿这条路径输送牛奶的瓶颈）。FJ 想要最大化路径流量与路径花费之比。保证存在从 $1$ 到 $N$之间的路径。\n", "inputFormat": "输入的第一行包含 $N$ 和 $M$。以下 $M$ 行每行以四个整数描述一条管道：$a$ 和 $b$（管道连接的两个不同的接合点），$c$（管道的花费），以及 $f$（管道的流量）。花费和流量均为范围 $1 \\ldots 1000$ 之内的正整数。", "outputFormat": "输出 $10^6$ 乘以最优解的值，并向下取整（也就是说，如果这个数本身不是整数，输出小于它的最接近它的整数）。", "hint": "在这个例子中，仅由一条路径从 $1$ 到 $N$。 它的流量为 $\\min(3,4)=3$，花费为 $2+5=7$。\n\n### 数据范围\n\n测试点 $2\\sim 5$ 满足 $N,M\\le 100$。\n\n对于 $100\\%$ 的数据，$2 \\leq N \\leq 1000$，$1 \\leq M \\leq 1000$。\n\n供题：Brian Dean", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19DEC] Milk Pumping G", "background": "", "description": "Farmer John recently bought a new farm in order to expand his milk industry empire. This new farm is connected to a nearby town by a network of pipelines, and FJ wants to find the best set of pipelines to buy and use to transport milk from the farm to the town.\n\nThis pipeline network can be described by $N$ junctions (endpoints of pipelines), numbered $1 \\ldots N$. Junction $1$ represents FJ's farm, and junction $N$ represents the town. There are $M$ bidirectional pipelines, each connecting two junctions. Using the $i$-th pipeline costs FJ $c_i$ dollars to buy, and it can support a flow rate of $f_i$ liters of milk per second.\n\nFJ wants to buy some pipelines that form a single simple path whose endpoints are junction $1$ and junction $N$. The cost of this path is the sum of the costs of all pipelines on the path. The flow rate of the path is the minimum flow rate among all pipelines on the path (because this is the bottleneck when sending milk along the path). FJ wants to maximize the ratio of the path flow rate to the path cost. It is guaranteed that there exists a path from $1$ to $N$.", "inputFormat": "The first line of input contains $N$ and $M$. The next $M$ lines each describe one pipeline with four integers: $a$ and $b$ (the two different junctions the pipeline connects), $c$ (the cost of the pipeline), and $f$ (the flow rate of the pipeline). Both cost and flow rate are positive integers in the range $1 \\ldots 1000$.", "outputFormat": "Output $10^6$ times the value of the optimal answer, rounded down (that is, if this number is not an integer, output the greatest integer less than it).", "hint": "In this example, there is only one path from $1$ to $N$. Its flow rate is $\\min(3,4)=3$, and its cost is $2+5=7$.\n\n### Constraints\n\nTest cases $2 \\sim 5$ satisfy $N,M\\le 100$.\n\nFor $100\\%$ of the testdata, $2 \\leq N \\leq 1000$ and $1 \\leq M \\leq 1000$.\n\nProblem by: Brian Dean.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19DEC] Milk Pumping G", "background": "", "description": "Farmer John 最近为了扩张他的牛奶产业帝国而收购了一个新的农场。这一新的农场通过一个管道网络与附近的小镇相连，FJ 想要找出其中最合适的一组管道，将其购买并用来将牛奶从农场输送到小镇。\n\n这个管道网络可以用 $N$ 个接合点（管道的端点）来描述，将其编号为 $1 \\ldots N$。接合点 $1$ 表示 FJ 的农场，接合点 $N$ 表示小镇。有 $M$ 条双向的管道，每条连接了两个接合点。使用第 $i$ 条管道需要 FJ 花费 $c_i$ 美元购入，可以支持每秒 $f_i$ 升牛奶的流量。\n\nFJ 想要购买一条管道组成一条单一路径，路径的两端点分别为接合点 $1$ 和 $N$。这条路径的花费等于路径上所有管道的费用之和。路径上的流量等于路径上所有管道的最小流量（因为这是沿这条路径输送牛奶的瓶颈）。FJ 想要最大化路径流量与路径花费之比。保证存在从 $1$ 到 $N$之间的路径。\n", "inputFormat": "输入的第一行包含 $N$ 和 $M$。以下 $M$ 行每行以四个整数描述一条管道：$a$ 和 $b$（管道连接的两个不同的接合点），$c$（管道的花费），以及 $f$（管道的流量）。花费和流量均为范围 $1 \\ldots 1000$ 之内的正整数。", "outputFormat": "输出 $10^6$ 乘以最优解的值，并向下取整（也就是说，如果这个数本身不是整数，输出小于它的最接近它的整数）。", "hint": "在这个例子中，仅由一条路径从 $1$ 到 $N$。 它的流量为 $\\min(3,4)=3$，花费为 $2+5=7$。\n\n### 数据范围\n\n测试点 $2\\sim 5$ 满足 $N,M\\le 100$。\n\n对于 $100\\%$ 的数据，$2 \\leq N \\leq 1000$，$1 \\leq M \\leq 1000$。\n\n供题：Brian Dean", "locale": "zh-CN"}}}
{"pid": "P5838", "type": "P", "difficulty": 5, "samples": [["5 5\n1 1 2 1 2\n1 2\n2 3\n2 4\n1 5\n1 4 1\n1 4 2\n1 3 2\n1 3 1\n5 5 1", "10110"], ["6 4\n1 2 3 3 3 3\n1 2\n2 3\n3 4\n2 5\n5 6\n4 6 1\n4 6 2\n4 6 3\n4 6 4", "0110"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2019", "USACO", "树上启发式合并", "树链剖分"], "title": "[USACO19DEC] Milk Visits G", "background": "", "description": "Farmer John 计划建造 $N$ 个农场，用 $N-1$ 条道路连接，构成一棵树（也就是说，所有农场之间都互相可以到达，并且没有环）。每个农场有一头奶牛，品种为 $1$ 到 $N$ 之间的一个整数 $T_i$。\n\nFarmer John 的 $M$ 个朋友经常前来拜访他。在朋友 $i$ 拜访之时，Farmer John 会与他的朋友沿着从农场 $A_i$ 到农场 $B_i$ 之间的唯一路径行走（可能有 $A_i = B_i$）。除此之外，他们还可以品尝他们经过的路径上任意一头奶牛的牛奶。由于 Farmer John 的朋友们大多数也是农场主，他们对牛奶有着极强的偏好。他的每个朋友都只喝某种特定品种的奶牛的牛奶。任何 Farmer John 的朋友只有在他们访问时能喝到他们偏好的牛奶才会高兴。\n\n请求出每个朋友在拜访过后是否会高兴。\n\n", "inputFormat": "输入的第一行包含两个整数 $N$ 和 $M$。\n\n第二行包含 $N$ 个空格分隔的整数 $T_1,T_2,\\ldots, T_N$。第 $i$ 个农场内的奶牛的品种用 $T_i$ 表示。\n\n以下 $N-1$ 行，每行包含两个不同的整数 $X$ 和 $Y$（$1 \\leq X, Y \\leq N$），表示农场 $X$ 与 $Y$ 之间有一条边。\n\n以下 $M$ 行，每行包含整数 $A_i$，$B_i$，以及$C_i$。$A_i$ 和 $B_i$ 表示朋友 $i$ 拜访时行走的路径的端点，$C_i$（$1\\le C_i\\le N$）表示这个朋友喜欢的牛奶的奶牛品种。", "outputFormat": "输出一个长为 $M$ 的二进制字符串。如果第 $i$ 个朋友会感到高兴，则字符串的第 $i$ 个字符为 `1`，否则为 `0`。", "hint": "测试点性质：\n\n测试点 $2$ 为以下第二个样例。\n\n测试点 $3$ 满足 $N\\le 10^3$，$M\\le 2\\cdot 10^3$。\n\n测试点 $4\\sim 7$ 满足 $C_i\\le 10$。\n\n对于 $100\\%$ 的数据，$1 \\leq N \\leq 10^5$，$1 \\leq M \\leq 10^5$。\n\n供题：Spencer Compton", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19DEC] Milk Visits G", "background": "", "description": "Farmer John plans to build $N$ farms and connect them with $N-1$ roads to form a tree (that is, every pair of farms is reachable, and there are no cycles). Each farm has one cow, with breed $T_i$, an integer between $1$ and $N$.\n\nFarmer John has $M$ friends who often come to visit him. When friend $i$ visits, Farmer John and this friend will walk along the unique path from farm $A_i$ to farm $B_i$ (it is possible that $A_i = B_i$). In addition, they can taste the milk of any cow on the path they travel. Since most of Farmer John’s friends are also farmers, they have strong preferences for milk. Each friend only drinks milk from one specific breed of cow. A friend will be happy only if, during their visit, they can drink milk of their preferred breed.\n\nPlease determine whether each friend will be happy after the visit.", "inputFormat": "The first line contains two integers $N$ and $M$.\n\nThe second line contains $N$ space-separated integers $T_1,T_2,\\ldots, T_N$. The cow breed on farm $i$ is given by $T_i$.\n\nThe next $N-1$ lines each contain two distinct integers $X$ and $Y$ ($1 \\leq X, Y \\leq N$), indicating there is an edge between farms $X$ and $Y$.\n\nThe next $M$ lines each contain integers $A_i$, $B_i$, and $C_i$. $A_i$ and $B_i$ are the endpoints of the path friend $i$ walks during the visit, and $C_i$ ($1 \\le C_i \\le N$) is the cow breed whose milk this friend likes.", "outputFormat": "Output a binary string of length $M$. If friend $i$ will be happy, the $i$-th character of the string is `1`, otherwise it is `0`.", "hint": "Test point properties.\n\nTest point $2$ is the second sample below.\n\nTest point $3$ satisfies $N\\le 10^3$, $M\\le 2\\cdot 10^3$.\n\nTest points $4\\sim 7$ satisfy $C_i\\le 10$.\n\nFor $100\\%$ of the testdata, $1 \\leq N \\leq 10^5$, $1 \\leq M \\leq 10^5$.\n\nProblem author: Spencer Compton.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19DEC] Milk Visits G", "background": "", "description": "Farmer John 计划建造 $N$ 个农场，用 $N-1$ 条道路连接，构成一棵树（也就是说，所有农场之间都互相可以到达，并且没有环）。每个农场有一头奶牛，品种为 $1$ 到 $N$ 之间的一个整数 $T_i$。\n\nFarmer John 的 $M$ 个朋友经常前来拜访他。在朋友 $i$ 拜访之时，Farmer John 会与他的朋友沿着从农场 $A_i$ 到农场 $B_i$ 之间的唯一路径行走（可能有 $A_i = B_i$）。除此之外，他们还可以品尝他们经过的路径上任意一头奶牛的牛奶。由于 Farmer John 的朋友们大多数也是农场主，他们对牛奶有着极强的偏好。他的每个朋友都只喝某种特定品种的奶牛的牛奶。任何 Farmer John 的朋友只有在他们访问时能喝到他们偏好的牛奶才会高兴。\n\n请求出每个朋友在拜访过后是否会高兴。\n\n", "inputFormat": "输入的第一行包含两个整数 $N$ 和 $M$。\n\n第二行包含 $N$ 个空格分隔的整数 $T_1,T_2,\\ldots, T_N$。第 $i$ 个农场内的奶牛的品种用 $T_i$ 表示。\n\n以下 $N-1$ 行，每行包含两个不同的整数 $X$ 和 $Y$（$1 \\leq X, Y \\leq N$），表示农场 $X$ 与 $Y$ 之间有一条边。\n\n以下 $M$ 行，每行包含整数 $A_i$，$B_i$，以及$C_i$。$A_i$ 和 $B_i$ 表示朋友 $i$ 拜访时行走的路径的端点，$C_i$（$1\\le C_i\\le N$）表示这个朋友喜欢的牛奶的奶牛品种。", "outputFormat": "输出一个长为 $M$ 的二进制字符串。如果第 $i$ 个朋友会感到高兴，则字符串的第 $i$ 个字符为 `1`，否则为 `0`。", "hint": "测试点性质：\n\n测试点 $2$ 为以下第二个样例。\n\n测试点 $3$ 满足 $N\\le 10^3$，$M\\le 2\\cdot 10^3$。\n\n测试点 $4\\sim 7$ 满足 $C_i\\le 10$。\n\n对于 $100\\%$ 的数据，$1 \\leq N \\leq 10^5$，$1 \\leq M \\leq 10^5$。\n\n供题：Spencer Compton", "locale": "zh-CN"}}}
{"pid": "P5839", "type": "P", "difficulty": 5, "samples": [["5 5 2\nabcde\n0 1 4 4 4\n2 0 4 4 4\n6 5 0 3 2\n5 5 5 0 4\n3 7 0 5 0", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2019", "USACO", "前缀和", "Floyd 算法"], "title": "[USACO19DEC] Moortal Cowmbat G", "background": "", "description": "Bessie 玩格斗游戏真牛快打已经有很长时间了。然而，最近游戏开发者发布了一项更新，这迫使 Bessie 改变她的打法。\n\n游戏总共使用 $M$ 个按键，标记为前 $M$ 个小写字母。Bessie 在游戏中最喜欢的组合键是一个长为 $N$ 的按键字符串 $S$。然而，由于最近的更新，现在每种组合键必须由一些“连击”所组成，其中连击的定义为相同的按键连续按下至少 $K$ 次。Bessie想要修改她最喜欢的组合键，创造一个同样长为 $N$ 的新组合键，然而这一新组合键由按键连击所组成，以适应规则的变化。\n\nBessie 需要消耗 $a_{ij}$ 天来训练她在组合键中某个特定的位置用按键 $j$ 来取代按键 $i$（也就是说，将 $S$ 中的某个特定的字符由 $i$ 变为 $j$ 的代价为 $a_{ij}$）。注意有可能将按键 $i$ 换成某种中间按键 $k$ 然后再从按键 $k$ 换成按键 $j$ 会比直接从按键 $i$ 换成按键 $j$ 消耗更短的时间（或者更一般地说，可能有一条起点为 $i$ 终点为 $j$ 的更改路径给出了从按键 $i$ 最终更改为按键 $j$ 的最小总代价）。\n\n帮助 Bessie 求出她创建一个满足新要求的组合键所需要的最小天数。", "inputFormat": "输入的第一行包含 $N$，$M$ 和 $K$。第二行包含 $S$，最后 $M$ 行包含一个 $M\\times M$ 的数字方阵 $a_{ij}$，其中 $a_{ij}$ 为一个范围为 $0 \\ldots 1000$ 的整数，并且对于所有的 $i$，有 $a_{ii} = 0$。", "outputFormat": "输出一个整数，表示 Bessie 将她的组合键改为一个满足新要求的新的组合键所需要的最小天数。", "hint": "在这个例子中的最优方案是将 `a` 改为 `b`，将 `d` 改为 `e`，再将两个 `e` 都改为 `c`。这总共消耗 $1+4+0+0=5$ 天，最终的组合键为 `bbccc`。\n\n测试点性质：\n\n测试点 $2\\sim 4$ 满足 $N\\le 1000$，$K\\le 50$。\n\n测试点 $5\\sim 8$ 满足 $N\\le 3\\times 10^4$，$K\\le 50$。\n\n对于 $100\\%$ 的数据，$1 \\leq M \\leq 26$，$1 \\leq K\\leq N \\leq 10^5$。\n\n供题：Eric Wei", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19DEC] Moortal Cowmbat G", "background": "", "description": "Bessie has been playing the fighting game \"Moortal Cowmbat\" for a long time. However, the game developers recently released an update that forces Bessie to change her playstyle.\n\nThe game uses a total of $M$ keys, labeled as the first $M$ lowercase letters. Bessie's favorite combo in the game is a key string $S$ of length $N$. However, due to the recent update, every combo must be made up of some \"combos\", where a combo is defined as pressing the same key consecutively at least $K$ times. Bessie wants to modify her favorite combo to create a new combo of the same length $N$, but this new combo must be composed of such key combos to fit the new rules.\n\nBessie needs to spend $a_{ij}$ days to train herself to replace key $i$ with key $j$ at a specific position in the combo (that is, the cost to change a specific character in $S$ from $i$ to $j$ is $a_{ij}$). Note that it may be faster to change key $i$ to some intermediate key $k$ and then change key $k$ to key $j$ than to change directly from key $i$ to key $j$ (or, more generally, there may be a change path from $i$ to $j$ that gives the minimum total cost to finally change $i$ into $j$).\n\nHelp Bessie find the minimum number of days needed to create a combo that satisfies the new requirements.", "inputFormat": "The first line contains $N$, $M$, and $K$. The second line contains $S$. The last $M$ lines contain an $M\\times M$ matrix of integers $a_{ij}$, where $a_{ij}$ is an integer in the range $0 \\ldots 1000$, and for all $i$, $a_{ii} = 0$.", "outputFormat": "Output one integer, the minimum number of days needed for Bessie to change her combo into a new combo that satisfies the new requirements.", "hint": "In this example, the optimal plan is to change `a` to `b`, change `d` to `e`, and then change both `e` characters to `c`. This costs a total of $1+4+0+0=5$ days, and the final combo is `bbccc`.\n\nTest point properties:\n\nTest points $2\\sim 4$ satisfy $N\\le 1000$, $K\\le 50$.\n\nTest points $5\\sim 8$ satisfy $N\\le 3\\times 10^4$, $K\\le 50$.\n\nFor $100\\%$ of the data, $1 \\leq M \\leq 26$, $1 \\leq K\\leq N \\leq 10^5$.\n\nProblem by: Eric Wei.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19DEC] Moortal Cowmbat G", "background": "", "description": "Bessie 玩格斗游戏真牛快打已经有很长时间了。然而，最近游戏开发者发布了一项更新，这迫使 Bessie 改变她的打法。\n\n游戏总共使用 $M$ 个按键，标记为前 $M$ 个小写字母。Bessie 在游戏中最喜欢的组合键是一个长为 $N$ 的按键字符串 $S$。然而，由于最近的更新，现在每种组合键必须由一些“连击”所组成，其中连击的定义为相同的按键连续按下至少 $K$ 次。Bessie想要修改她最喜欢的组合键，创造一个同样长为 $N$ 的新组合键，然而这一新组合键由按键连击所组成，以适应规则的变化。\n\nBessie 需要消耗 $a_{ij}$ 天来训练她在组合键中某个特定的位置用按键 $j$ 来取代按键 $i$（也就是说，将 $S$ 中的某个特定的字符由 $i$ 变为 $j$ 的代价为 $a_{ij}$）。注意有可能将按键 $i$ 换成某种中间按键 $k$ 然后再从按键 $k$ 换成按键 $j$ 会比直接从按键 $i$ 换成按键 $j$ 消耗更短的时间（或者更一般地说，可能有一条起点为 $i$ 终点为 $j$ 的更改路径给出了从按键 $i$ 最终更改为按键 $j$ 的最小总代价）。\n\n帮助 Bessie 求出她创建一个满足新要求的组合键所需要的最小天数。", "inputFormat": "输入的第一行包含 $N$，$M$ 和 $K$。第二行包含 $S$，最后 $M$ 行包含一个 $M\\times M$ 的数字方阵 $a_{ij}$，其中 $a_{ij}$ 为一个范围为 $0 \\ldots 1000$ 的整数，并且对于所有的 $i$，有 $a_{ii} = 0$。", "outputFormat": "输出一个整数，表示 Bessie 将她的组合键改为一个满足新要求的新的组合键所需要的最小天数。", "hint": "在这个例子中的最优方案是将 `a` 改为 `b`，将 `d` 改为 `e`，再将两个 `e` 都改为 `c`。这总共消耗 $1+4+0+0=5$ 天，最终的组合键为 `bbccc`。\n\n测试点性质：\n\n测试点 $2\\sim 4$ 满足 $N\\le 1000$，$K\\le 50$。\n\n测试点 $5\\sim 8$ 满足 $N\\le 3\\times 10^4$，$K\\le 50$。\n\n对于 $100\\%$ 的数据，$1 \\leq M \\leq 26$，$1 \\leq K\\leq N \\leq 10^5$。\n\n供题：Eric Wei", "locale": "zh-CN"}}}
{"pid": "P5840", "type": "P", "difficulty": 6, "samples": [["3\na\nbc\nabc\n5\n1 abca\n2 1\n1 bca\n2 2\n2 3\n", "1\n2\n1\n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [786432, 786432, 786432, 786432, 786432, 786432, 786432, 786432, 786432, 786432]}, "tags": ["2015", "线段树", "树状数组", "AC 自动机", "差分", "COCI（克罗地亚）"], "title": "[COCI 2014/2015 #5] Divljak", "background": null, "description": "Alice 有 $n$ 个字符串 $S_1, S_2, \\dots, S_n$，Bob 有一个字符串集合 $T$，一开始集合是空的。\n\n接下来会发生 $q$ 个操作，操作有两种形式：\n\n1. `1 P`：Bob 往自己的集合里添加了一个字符串 $P$。\n2. `2 x`：Alice 询问 Bob，集合 $T$ 中有多少个字符串包含串 $S_x$（我们称串 $A$ 包含串 $B$，当且仅当 $B$ 是 $A$ 的子串）。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行一个字符串 ${S}_i$。\n\n接下来一行一个整数 $q$。\n\n接下来 $q$ 行，每行一个操作。", "outputFormat": "对每个 `2 x` 操作，一行一个整数，表示答案。", "hint": "对于 $50\\%$ 的数据，$n\\le 20000$。\n\n对于 $100\\%$ 的数据，$1\\le n, q\\le 10^5$，字符串由小写字母构成，$S$ 中所有字符串的长度之和与所有 $P$ 的长度之和分别 $\\le 2\\times 10^6$。\n\n译自 [COCI 2014/2015 CONTEST #5](https://hsin.hr/coci/archive/2014_2015/contest5_tasks.pdf)。", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2014/2015 #5] Divljak", "background": "", "description": "Alice has $n$ strings $S_1, S_2, \\dots, S_n$, and Bob has a set of strings $T$, which is empty at the beginning.\n\nThen there will be $q$ operations. There are two types of operations:\n\n1. `1 P`: Bob adds a string $P$ to his set.\n2. `2 x`: Alice asks Bob how many strings in set $T$ contain the string $S_x$ (we say string $A$ contains string $B$ if and only if $B$ is a substring of $A$).", "inputFormat": "The first line contains an integer $n$.\n\nThe next $n$ lines each contain a string ${S}_i$.\n\nThe next line contains an integer $q$.\n\nThe next $q$ lines each contain one operation.", "outputFormat": "For each `2 x` operation, output one integer per line, representing the answer.", "hint": "For $50\\%$ of the testdata, $n \\le 20000$.\n\nFor $100\\%$ of the testdata, $1 \\le n, q \\le 10^5$. All strings consist of lowercase letters. The sum of lengths of all strings in $S$ and the sum of lengths of all strings $P$ are each $\\le 2 \\times 10^6$.\n\nTranslated from [COCI 2014/2015 CONTEST #5](https://hsin.hr/coci/archive/2014_2015/contest5_tasks.pdf)。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2014/2015 #5] Divljak", "background": null, "description": "Alice 有 $n$ 个字符串 $S_1, S_2, \\dots, S_n$，Bob 有一个字符串集合 $T$，一开始集合是空的。\n\n接下来会发生 $q$ 个操作，操作有两种形式：\n\n1. `1 P`：Bob 往自己的集合里添加了一个字符串 $P$。\n2. `2 x`：Alice 询问 Bob，集合 $T$ 中有多少个字符串包含串 $S_x$（我们称串 $A$ 包含串 $B$，当且仅当 $B$ 是 $A$ 的子串）。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行一个字符串 ${S}_i$。\n\n接下来一行一个整数 $q$。\n\n接下来 $q$ 行，每行一个操作。", "outputFormat": "对每个 `2 x` 操作，一行一个整数，表示答案。", "hint": "对于 $50\\%$ 的数据，$n\\le 20000$。\n\n对于 $100\\%$ 的数据，$1\\le n, q\\le 10^5$，字符串由小写字母构成，$S$ 中所有字符串的长度之和与所有 $P$ 的长度之和分别 $\\le 2\\times 10^6$。\n\n译自 [COCI 2014/2015 CONTEST #5](https://hsin.hr/coci/archive/2014_2015/contest5_tasks.pdf)。", "locale": "zh-CN"}}}
{"pid": "P5841", "type": "P", "difficulty": 7, "samples": [["4 6\na\nb\nabc\nbc\n1 2\n1 3\n3 1\n4 2\n2 4\n2 4\n", "2\n4 1 3 5 6\n3 1 2 4\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "2011", "并查集", "Special Judge", "字典树 Trie", "CTSC/CTS"], "title": "[CTSC2011] 字符串重排", "background": null, "description": "对于两个字符串 $A = a_1 a_2 \\cdots a_n$ 和 $B = b_1 b_2 \\cdots b_n$，定义其最长公共前缀长度 $\\text{lcp} (A,B)$  如下：\n\n$$\\text{lcp}(A,B) = \\max \\{k|0 \\le k \\le n,k \\le m,a_1 a_2 \\cdots a_k = b_1 b_2 \\cdots b_k \\}$$\n\n给定 $n$ 个由小写字母组成的两两不同的非空字符串 $S_1,S_2,\\cdots , S_n$，对于一个 $1$ 到 $n$ 的排列 $P=(p_1,p_2,\\cdots,p_n)$，定义 $P$ 的价值 $W(P)$ 如下：\n\n$$W(P) = \\sum_{i=2}^n (\\text{lcp}(S_{p_{i-1}},S_{p_i}))^2$$\n\n我们设能够产生最大价值的排列为 $P^*_G$。\n\n此外，还有 $q$ 个附加任务。对于第 $i$ 个任务，给定两个 $1$ 到 $n$ 之间的不同的整数 $X_i$ 和 $Y_i$。对于排列 $P$，若 $P$ 在满足 $W(P) = W(P^*_G)$ 的前提条件之下，同时满足第 $X_i$ 个字符串 $S_{X_i}$ 恰好排在第 $Y_i$ 个字符串 $S_{Y_i}$ 之前， 即 $\\text{pos}(S_{X_i}) + 1 = \\text{pos}(S_{Y_i})$，其中 $\\text{pos}(S_i)$ 表示字符串 $S_i$ 在排列中的位置，则排列 $P$ 还将获得 $2^i$ 的奖励。所有任务的奖励之和称之为总任务奖励。\n\n我们设能够使得总任务奖励最大的排列为 $P^*_B$。\n\n试求：\n\n1. $W(P^*_G)$，即可能产生的最大价值；\n2. $P^*_B$，在保证最大价值前提下，可以使总任务奖励最大的排列。", "inputFormat": "第一行包含两个整数 $n$ 和 $q$，表示字符串和附加任务的数量，中间用一个空格隔开；\n\n接下来 $n$ 行，描述字符串，其中第 $i$ 行包含一个字符串 $S_i$；\n\n接下来 $q$ 行，描述附加任务，其中第 $i$ 行包含两个整数 $X_i$ 和 $Y_i$，中间用一个空格隔开。", "outputFormat": "包含三行。\n\n第一行包含一个非负整数 $W(P^*_G)$；\n\n第二行若干个数，每两个数之间用一个空格隔开，这一行第一个数表示满足附加任务的数量 $k$，接下来 $k$ 个数为这些任务的序号，序号从 $1$ 开始，按从小到大的顺序输出；\n\n第三行包含 $n$ 个用一个空格隔开的正整数，表示一个 $1$ 到 $n$ 的排列 $P^*_B$。", "hint": "**评分标准**\n\n对于一个测试点：\n\n- 如果输出文件的第一行正确可以得到 $2$ 分；\n- 如果输出文件的第二行正确可以得到 $4$ 分；\n- 如果输出文件的第三行正确可以得到 $4$ 分；\n- 如果输出文件的三行都正确则可以得到 $10$ 分。\n\n对于第三问中的排列，如果存在多个解， 则输出任意一个解均可得分。\n\n若某问无法完成，也请按照格式输出，以避免测评失败。\n\n**数据范围**\n\n- 对于 $10\\%$ 的数据，$n \\le 10$，$q=1$，每个字符串的长度不超过 $50$；\n- 对于 $20\\%$ 的数据，$n \\le 50$，$q=1$，每个字符串的长度不超过 $50$；\n- 对于 $50\\%$ 的数据，$n,q \\le 1000$，每个字符串的长度不超过 $1000$；\n- 对于 $70\\%$ 的数据，任意字符串不为其他任何一个字符串的前缀；\n- 对于 $100\\%$ 的数据，$n \\le 4 \\times 10^4$，$q \\le 10^5$，每个字符串的长度不超过 $10^4$，所有字符串的长度和不超过 $2 \\times 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2011] String Rearrangement", "background": "", "description": "For two strings $A = a_1 a_2 \\cdots a_n$ and $B = b_1 b_2 \\cdots b_n$, define the length of their longest common prefix $\\text{lcp}(A,B)$ as follows:\n\n$$\\text{lcp}(A,B) = \\max \\{k|0 \\le k \\le n,k \\le m,a_1 a_2 \\cdots a_k = b_1 b_2 \\cdots b_k \\}$$\n\nGiven $n$ pairwise distinct non-empty strings $S_1,S_2,\\cdots , S_n$ consisting of lowercase letters, for a permutation $P=(p_1,p_2,\\cdots,p_n)$ of $1$ to $n$, define the value $W(P)$ as:\n\n$$W(P) = \\sum_{i=2}^n (\\text{lcp}(S_{p_{i-1}},S_{p_i}))^2$$\n\nLet a permutation that can produce the maximum value be $P^*_G$.\n\nIn addition, there are $q$ extra tasks. For the $i$-th task, two different integers $X_i$ and $Y_i$ between $1$ and $n$ are given. For a permutation $P$, if under the condition that $W(P) = W(P^*_G)$, it also satisfies that the $X_i$-th string $S_{X_i}$ is placed immediately before the $Y_i$-th string $S_{Y_i}$, i.e. $\\text{pos}(S_{X_i}) + 1 = \\text{pos}(S_{Y_i})$, where $\\text{pos}(S_i)$ denotes the position of string $S_i$ in the permutation, then the permutation $P$ will additionally receive a reward of $2^i$. The sum of rewards of all tasks is called the total task reward.\n\nLet a permutation that can maximize the total task reward be $P^*_B$.\n\nFind:\n\n1. $W(P^*_G)$, the maximum value possible.\n2. $P^*_B$, a permutation that, while ensuring the maximum value, can maximize the total task reward.", "inputFormat": "The first line contains two integers $n$ and $q$, representing the number of strings and the number of extra tasks, separated by a space.\n\nIn the next $n$ lines, the strings are given. The $i$-th line contains a string $S_i$.\n\nIn the next $q$ lines, the extra tasks are given. The $i$-th line contains two integers $X_i$ and $Y_i$, separated by a space.", "outputFormat": "The output contains three lines.\n\nThe first line contains a non-negative integer $W(P^*_G)$.\n\nThe second line contains several numbers separated by single spaces. The first number is the number of satisfied extra tasks $k$, followed by $k$ numbers which are the indices of these tasks. The indices start from $1$ and must be output in increasing order.\n\nThe third line contains $n$ positive integers separated by spaces, representing a permutation $P^*_B$ of $1$ to $n$.", "hint": "**Scoring**\n\nFor each test point:\n\n- If the first line of the output file is correct, you can get $2$ points.\n- If the second line of the output file is correct, you can get $4$ points.\n- If the third line of the output file is correct, you can get $4$ points.\n- If all three lines are correct, you can get $10$ points.\n\nFor the permutation in the third question, if multiple solutions exist, outputting any one of them will be accepted.\n\nIf you cannot complete some part, please still output according to the required format to avoid judging failure.\n\n**Constraints**\n\n- For $10\\%$ of the data, $n \\le 10$, $q = 1$, and each string length is at most $50$.\n- For $20\\%$ of the data, $n \\le 50$, $q = 1$, and each string length is at most $50$.\n- For $50\\%$ of the data, $n,q \\le 1000$, and each string length is at most $1000$.\n- For $70\\%$ of the data, no string is a prefix of any other string.\n- For $100\\%$ of the data, $n \\le 4 \\times 10^4$, $q \\le 10^5$, each string length is at most $10^4$, and the sum of all string lengths is at most $2 \\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2011] 字符串重排", "background": null, "description": "对于两个字符串 $A = a_1 a_2 \\cdots a_n$ 和 $B = b_1 b_2 \\cdots b_n$，定义其最长公共前缀长度 $\\text{lcp} (A,B)$  如下：\n\n$$\\text{lcp}(A,B) = \\max \\{k|0 \\le k \\le n,k \\le m,a_1 a_2 \\cdots a_k = b_1 b_2 \\cdots b_k \\}$$\n\n给定 $n$ 个由小写字母组成的两两不同的非空字符串 $S_1,S_2,\\cdots , S_n$，对于一个 $1$ 到 $n$ 的排列 $P=(p_1,p_2,\\cdots,p_n)$，定义 $P$ 的价值 $W(P)$ 如下：\n\n$$W(P) = \\sum_{i=2}^n (\\text{lcp}(S_{p_{i-1}},S_{p_i}))^2$$\n\n我们设能够产生最大价值的排列为 $P^*_G$。\n\n此外，还有 $q$ 个附加任务。对于第 $i$ 个任务，给定两个 $1$ 到 $n$ 之间的不同的整数 $X_i$ 和 $Y_i$。对于排列 $P$，若 $P$ 在满足 $W(P) = W(P^*_G)$ 的前提条件之下，同时满足第 $X_i$ 个字符串 $S_{X_i}$ 恰好排在第 $Y_i$ 个字符串 $S_{Y_i}$ 之前， 即 $\\text{pos}(S_{X_i}) + 1 = \\text{pos}(S_{Y_i})$，其中 $\\text{pos}(S_i)$ 表示字符串 $S_i$ 在排列中的位置，则排列 $P$ 还将获得 $2^i$ 的奖励。所有任务的奖励之和称之为总任务奖励。\n\n我们设能够使得总任务奖励最大的排列为 $P^*_B$。\n\n试求：\n\n1. $W(P^*_G)$，即可能产生的最大价值；\n2. $P^*_B$，在保证最大价值前提下，可以使总任务奖励最大的排列。", "inputFormat": "第一行包含两个整数 $n$ 和 $q$，表示字符串和附加任务的数量，中间用一个空格隔开；\n\n接下来 $n$ 行，描述字符串，其中第 $i$ 行包含一个字符串 $S_i$；\n\n接下来 $q$ 行，描述附加任务，其中第 $i$ 行包含两个整数 $X_i$ 和 $Y_i$，中间用一个空格隔开。", "outputFormat": "包含三行。\n\n第一行包含一个非负整数 $W(P^*_G)$；\n\n第二行若干个数，每两个数之间用一个空格隔开，这一行第一个数表示满足附加任务的数量 $k$，接下来 $k$ 个数为这些任务的序号，序号从 $1$ 开始，按从小到大的顺序输出；\n\n第三行包含 $n$ 个用一个空格隔开的正整数，表示一个 $1$ 到 $n$ 的排列 $P^*_B$。", "hint": "**评分标准**\n\n对于一个测试点：\n\n- 如果输出文件的第一行正确可以得到 $2$ 分；\n- 如果输出文件的第二行正确可以得到 $4$ 分；\n- 如果输出文件的第三行正确可以得到 $4$ 分；\n- 如果输出文件的三行都正确则可以得到 $10$ 分。\n\n对于第三问中的排列，如果存在多个解， 则输出任意一个解均可得分。\n\n若某问无法完成，也请按照格式输出，以避免测评失败。\n\n**数据范围**\n\n- 对于 $10\\%$ 的数据，$n \\le 10$，$q=1$，每个字符串的长度不超过 $50$；\n- 对于 $20\\%$ 的数据，$n \\le 50$，$q=1$，每个字符串的长度不超过 $50$；\n- 对于 $50\\%$ 的数据，$n,q \\le 1000$，每个字符串的长度不超过 $1000$；\n- 对于 $70\\%$ 的数据，任意字符串不为其他任何一个字符串的前缀；\n- 对于 $100\\%$ 的数据，$n \\le 4 \\times 10^4$，$q \\le 10^5$，每个字符串的长度不超过 $10^4$，所有字符串的长度和不超过 $2 \\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P5842", "type": "P", "difficulty": 7, "samples": [["3\n1 14 4\n1 30 4\n10 60 5\n", "18\n40\n66\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "四川", "各省省选"], "title": "[SCOI2012] Blinker 的仰慕者", "background": "", "description": "Blinker 有非常多的仰慕者，他给每个仰慕者一个正整数编号。而且这些编号还隐藏着特殊的意义，即编号的各位数字之积表示这名仰慕者对 Blinker 的重要度。 现在 Blinker 想知道编号介于某两个值 $A$,$B$ 之间，且重要度为某个定值 $K$ 的仰慕者编号和。", "inputFormat": "输入的第一行是一个整数 $N$，表示 Blinker 想知道的信息个数。\n\n接下来的 $N$ 行，每行有三个数，$A$,$B$,$K$。表示 Blinker想知道编号介于 $A$ 和 $B$ 之间的，重要度为 $K$ 的仰慕者的编号和。   ", "outputFormat": "输出 $N$ 行，每行输出介于 $A$ 和 $B$ 之间，重要度为 $K$ 的仰慕者编号和。结果可能很大请对 $20120427$ 取模。", "hint": "- 对于 $20\\%$ 的数据，保证： $2 \\le A  \\le B \\le 10^9$，$1 \\le N \\le 30$；\n- 对于 $50\\%$ 的数据，保证：$ 2 \\le A \\le B \\le 10^{18}$，$1\\le N \\le 30$；\n- 对于 $100\\%$ 的数据，保证：  $ 2 \\le A \\le B \\le 10^{18}$，$1 \\le N \\le 5000$。", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2012] Blinker’s Admirers", "background": "", "description": "Blinker has many admirers, and he gives each admirer a positive integer ID. These IDs also hide a special meaning: the product of the digits of an ID represents how important this admirer is to Blinker. Now Blinker wants to know the sum of all admirer IDs between two values $A$ and $B$, whose importance equals a fixed value $K$.", "inputFormat": "The first line contains an integer $N$, which represents the number of queries Blinker wants to ask.\n\nThe next $N$ lines each contain three numbers $A$, $B$, and $K$, meaning Blinker wants the sum of all admirer IDs between $A$ and $B$ whose importance is $K$.", "outputFormat": "Output $N$ lines. For each query, output the sum of all admirer IDs between $A$ and $B$ whose importance is $K$. Since the result may be very large, take it modulo $20120427$.", "hint": "## Constraints\n\n- For $20\\%$ of the testdata: $2 \\le A \\le B \\le 10^9$, $1 \\le N \\le 30$.\n- For $50\\%$ of the testdata: $2 \\le A \\le B \\le 10^{18}$, $1 \\le N \\le 30$.\n- For $100\\%$ of the testdata: $2 \\le A \\le B \\le 10^{18}$, $1 \\le N \\le 5000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2012] Blinker 的仰慕者", "background": "", "description": "Blinker 有非常多的仰慕者，他给每个仰慕者一个正整数编号。而且这些编号还隐藏着特殊的意义，即编号的各位数字之积表示这名仰慕者对 Blinker 的重要度。 现在 Blinker 想知道编号介于某两个值 $A$,$B$ 之间，且重要度为某个定值 $K$ 的仰慕者编号和。", "inputFormat": "输入的第一行是一个整数 $N$，表示 Blinker 想知道的信息个数。\n\n接下来的 $N$ 行，每行有三个数，$A$,$B$,$K$。表示 Blinker想知道编号介于 $A$ 和 $B$ 之间的，重要度为 $K$ 的仰慕者的编号和。   ", "outputFormat": "输出 $N$ 行，每行输出介于 $A$ 和 $B$ 之间，重要度为 $K$ 的仰慕者编号和。结果可能很大请对 $20120427$ 取模。", "hint": "- 对于 $20\\%$ 的数据，保证： $2 \\le A  \\le B \\le 10^9$，$1 \\le N \\le 30$；\n- 对于 $50\\%$ 的数据，保证：$ 2 \\le A \\le B \\le 10^{18}$，$1\\le N \\le 30$；\n- 对于 $100\\%$ 的数据，保证：  $ 2 \\le A \\le B \\le 10^{18}$，$1 \\le N \\le 5000$。", "locale": "zh-CN"}}}
{"pid": "P5843", "type": "P", "difficulty": 6, "samples": [["2 4\nC 0 0 2 1\nP 4 -1 -1 -1 1 1 1 1 -1 2\nQ -2 -2 2 2\nQ -1.5 0 0.0 0.0\nC 1 1005\nQ -1.5 0 0.0 0.0", "0\n2\n0"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2012", "四川", "各省省选"], "title": "[SCOI2012] Blinker 的噩梦", "background": "", "description": "一天 Blinker 醒来，发现自己成为了一个二维世界的点，而且被标记上了一个奇怪的值。\n\n这个世界是由 $N$ 个边界互不相交（且不相切）的图形组成，这里图形仅包括圆和凸多边形。每个图形还有一个权值。每次 Blinker 走进或走出某个图形时（相切时经过不算），Blinker 的标记值就会被异或上那个值。\n\n现在，我们记录了 Blinker 在这个世界的 $M$ 天的信息。每天可能发生两种事情，一种是某个图形的权值更改为某个值；另一种是 Blinker 从某个点走到另一个点。 \n\n我们假设 Blinker 首次出发前的标记值为 $0$，我们希望知道他每次到达目的地后的标记值。", "inputFormat": "输入的第一行包含 $2$ 个数，$N$ 和 $M$，分别表示这个世界的图形数和记录的天数。 \n\n接下来有 $N$ 行，每行表示一个图形。 \n\n如果一行以字符 `C` 开头，表示这个图形是一个圆，后面紧跟着三个实数 $x$, $y$, $r$ 和一个整数 $v$，分别表示圆的 $x$ 坐标，$y$ 坐标和圆的半径以及该图形对应的值。 \n\n如果一行以字符 `P` 开头，表示这个图形是凸多边形，后面紧跟着一个整数 $L$，表示凸多边形的点数，然后后面有 $L$ 对实数 $x_0$,$y_0$,$x_1$,$y_1$ $\\cdots$，表示 $L$ 个点的坐标，这一行最后一个数是一个整数 $v$，表示这个图形对应的值，保证凸多边形上的点按照顺时针给出。 \n\n接下来有 $M$ 行，每行表示一天的记录信息。\n\n如果一行以字符 `Q` 开头，表示这一天 Blinker 出行了，接下来有 $x_0,y_0,x_1,y_1$ 四个实数，分别表示出发点的坐标和目的地的坐标。\n\n如果一行以字符 `C` 开头，表示这一天某个图形的值改变了，接下来有两个 $i$ 和 $v$，表示输入中第 $i$ 个出现的图形的值变成 $v$。", "outputFormat": "对于 Blinker 的每个出行输出他到达目的地后的标记值，很显然这个值与 Blinker 的路径无关。", "hint": "**样例解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mj50qefg.png)\n\n样例的世界形如上图：\n\n第一天 Binker 的初始标记值为 $0$，可能从 $A$ 沿直线走到 $B$，或者他绕过圆走到 $B$，他的标记值最终都保持不变为 $0$（假设沿直线从 $A$ 走到 $B$，共穿过 $4$ 次边界，Binker 的标记值变化过程为 $1,3,1,0$）;\n\n第二天 Binker 的初始标记值为 $0$，他通过某种不经过图形边界的方法到达了 $C$ 点（即 Binker 瞬间移动或闪烁），然后从 $C$ 沿某种路径走到 $D$，这时他的标记值变为 $2$；\n\n第三天圆的权值变为 $1005$；\n\n第四天 Binker 的初始标记值为 $2$，他再次回到 $C$，并再次从 $C$ 走到 $D$，这时他的标记值又变为 $0$。\n\n**数据范围**\n- 对于 $30\\%$ 的数据，$1 \\le M \\le 10.00$，凸多边形的点数加上圆的个数小于等于 $1000$；\n- 对于 $100\\%$ 的数据，$1 \\le N \\le 10^5$，$1 \\le M \\le 10^5$，单个凸多边形的点数小于等于 $34$。图形互不相交，且 Binker 的出发点和目的地不在图形的边界。", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2012] Blinker’s Nightmare", "background": "", "description": "One day, Blinker woke up and found that he had become a point in a two-dimensional world, and was marked with a strange value.\n\nThis world consists of $N$ shapes whose boundaries do not intersect (and do not touch). The shapes include only circles and convex polygons. Each shape also has a weight. Each time Blinker enters or leaves a shape (passing while tangent does not count), Blinker’s marked value will be XORed with that weight.\n\nNow, we have recorded Blinker’s information for $M$ days in this world. Each day, one of two things may happen: the weight of some shape is changed to a certain value; or Blinker moves from one point to another point.\n\nWe assume that Blinker’s marked value before his first departure is $0$, and we want to know his marked value after he arrives at the destination each time.", "inputFormat": "The first line contains $2$ numbers, $N$ and $M$, representing the number of shapes in this world and the number of recorded days.\n\nNext, there are $N$ lines, each describing a shape.\n\nIf a line starts with the character `C`, it means the shape is a circle. It is followed by three real numbers $x$, $y$, $r$ and an integer $v$, representing the circle’s $x$ coordinate, $y$ coordinate, radius, and the value of this shape.\n\nIf a line starts with the character `P`, it means the shape is a convex polygon. It is followed by an integer $L$, the number of vertices of the convex polygon, then $L$ pairs of real numbers $x_0$,$y_0$,$x_1$,$y_1$ $\\cdots$, representing the coordinates of the $L$ points. The last number on this line is an integer $v$, representing the value of this shape. It is guaranteed that the points of the convex polygon are given in clockwise order.\n\nNext, there are $M$ lines, each describing one day’s record.\n\nIf a line starts with the character `Q`, it means Blinker traveled on that day. It is followed by four real numbers $x_0,y_0,x_1,y_1$, representing the coordinates of the starting point and the destination.\n\nIf a line starts with the character `C`, it means the value of a shape changed on that day. It is followed by two numbers $i$ and $v$, meaning that the value of the $i$-th shape in the input becomes $v$.", "outputFormat": "For each of Blinker’s travels, output his marked value after he arrives at the destination. Obviously, this value is independent of Blinker’s path.", "hint": "**Sample Explanation**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mj50qefg.png)\n\nThe sample world looks like the figure above:\n\nOn day 1, Binker’s initial marked value is $0$. He may go from $A$ to $B$ along a straight line, or he may go around the circle to reach $B$. His marked value finally remains $0$ in both cases. (Assuming he goes from $A$ to $B$ along the straight line, he crosses the boundary $4$ times, and Binker’s marked value changes as $1,3,1,0$.)\n\nOn day 2, Binker’s initial marked value is $0$. He reaches point $C$ by some method that does not pass through any shape boundary (that is, Binker teleports or blinks), and then goes from $C$ to $D$ along some path. At this time, his marked value becomes $2$.\n\nOn day 3, the circle’s weight becomes $1005$.\n\nOn day 4, Binker’s initial marked value is $2$. He returns to $C$ again, and again goes from $C$ to $D$. At this time, his marked value becomes $0$ again.\n\n**Constraints**\n- For $30\\%$ of the testdata, $1 \\le M \\le 10.00$, and the total number of polygon vertices plus the number of circles is at most $1000$.\n- For $100\\%$ of the testdata, $1 \\le N \\le 10^5$, $1 \\le M \\le 10^5$, and the number of vertices in a single convex polygon is at most $34$. The shapes do not intersect each other, and Blinker’s starting point and destination are not on any shape boundary.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2012] Blinker 的噩梦", "background": "", "description": "一天 Blinker 醒来，发现自己成为了一个二维世界的点，而且被标记上了一个奇怪的值。\n\n这个世界是由 $N$ 个边界互不相交（且不相切）的图形组成，这里图形仅包括圆和凸多边形。每个图形还有一个权值。每次 Blinker 走进或走出某个图形时（相切时经过不算），Blinker 的标记值就会被异或上那个值。\n\n现在，我们记录了 Blinker 在这个世界的 $M$ 天的信息。每天可能发生两种事情，一种是某个图形的权值更改为某个值；另一种是 Blinker 从某个点走到另一个点。 \n\n我们假设 Blinker 首次出发前的标记值为 $0$，我们希望知道他每次到达目的地后的标记值。", "inputFormat": "输入的第一行包含 $2$ 个数，$N$ 和 $M$，分别表示这个世界的图形数和记录的天数。 \n\n接下来有 $N$ 行，每行表示一个图形。 \n\n如果一行以字符 `C` 开头，表示这个图形是一个圆，后面紧跟着三个实数 $x$, $y$, $r$ 和一个整数 $v$，分别表示圆的 $x$ 坐标，$y$ 坐标和圆的半径以及该图形对应的值。 \n\n如果一行以字符 `P` 开头，表示这个图形是凸多边形，后面紧跟着一个整数 $L$，表示凸多边形的点数，然后后面有 $L$ 对实数 $x_0$,$y_0$,$x_1$,$y_1$ $\\cdots$，表示 $L$ 个点的坐标，这一行最后一个数是一个整数 $v$，表示这个图形对应的值，保证凸多边形上的点按照顺时针给出。 \n\n接下来有 $M$ 行，每行表示一天的记录信息。\n\n如果一行以字符 `Q` 开头，表示这一天 Blinker 出行了，接下来有 $x_0,y_0,x_1,y_1$ 四个实数，分别表示出发点的坐标和目的地的坐标。\n\n如果一行以字符 `C` 开头，表示这一天某个图形的值改变了，接下来有两个 $i$ 和 $v$，表示输入中第 $i$ 个出现的图形的值变成 $v$。", "outputFormat": "对于 Blinker 的每个出行输出他到达目的地后的标记值，很显然这个值与 Blinker 的路径无关。", "hint": "**样例解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mj50qefg.png)\n\n样例的世界形如上图：\n\n第一天 Binker 的初始标记值为 $0$，可能从 $A$ 沿直线走到 $B$，或者他绕过圆走到 $B$，他的标记值最终都保持不变为 $0$（假设沿直线从 $A$ 走到 $B$，共穿过 $4$ 次边界，Binker 的标记值变化过程为 $1,3,1,0$）;\n\n第二天 Binker 的初始标记值为 $0$，他通过某种不经过图形边界的方法到达了 $C$ 点（即 Binker 瞬间移动或闪烁），然后从 $C$ 沿某种路径走到 $D$，这时他的标记值变为 $2$；\n\n第三天圆的权值变为 $1005$；\n\n第四天 Binker 的初始标记值为 $2$，他再次回到 $C$，并再次从 $C$ 走到 $D$，这时他的标记值又变为 $0$。\n\n**数据范围**\n- 对于 $30\\%$ 的数据，$1 \\le M \\le 10.00$，凸多边形的点数加上圆的个数小于等于 $1000$；\n- 对于 $100\\%$ 的数据，$1 \\le N \\le 10^5$，$1 \\le M \\le 10^5$，单个凸多边形的点数小于等于 $34$。图形互不相交，且 Binker 的出发点和目的地不在图形的边界。", "locale": "zh-CN"}}}
{"pid": "P5844", "type": "P", "difficulty": 4, "samples": [["5 20 6\n1\n2\n10\n12\n14", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "二分", "IOI", "前缀和", "双指针 two-pointer"], "title": "[IOI 2011] ricehub", "background": "", "description": "乡间有一条笔直而长的路称为“米道”。沿着这条米道上$R$  块稻田，每块稻田的坐标均为一个 $1$ 到 $L$ 之间(含 $1$ 和 $L$ )的整数。这些稻田按照坐标以不减的顺序给出，即对于 $0 \\le i < R$，稻田 $i$ 的坐标 $X[i]$ 满足 $1 \\le X[0] \\le \\cdots \\le X[R-1] \\le L$。\n\n注意：可能有多块稻田位于同一个坐标上。\n\n我们计划建造一个米仓用于储存尽可能多的稻米。和稻田一样，米仓将建在米道上，其坐标也是一个 $1$ 到 $L$ 之间的整数（含 $1$ 和 $L$）。这个米仓可以建在满足上述条件的任一个位置上，包括那些原来已有一个或多个稻田存在的位置。\n\n在收获季节，每一块稻田刚好出产一滿货车的稻米。为了将这些稻米运到米仓，需要雇用一位货车司机来运米。司机的收费是每一满货车运送一个单位的距离收取 $1$ 元。換言之，将稻米从特定的稻田运到米仓的费用在数值上等于稻田坐标与米仓坐标之差的绝对值。\n\n不幸的是，今年预算有限，我们至多只能花费 $B$ 元运费。你的任务是要帮我们找出一个建造米仓的位置，可以收集到尽可能多的稻米。", "inputFormat": "第一行 三个整数 $R,L,B$；\n\n接下来 $R$ 行 每行一个整数 表示 $X[i]$。", "outputFormat": "一个整数，表示最多稻米数", "hint": "对于 $100\\%$ 的数据，$1 \\le R \\le 10^5$，$1 \\le L \\le 10^9$，$ 0 \\le B \\le 2 \\times 10^{15}$。", "locale": "zh-CN", "translations": {"en": {"title": "[IOI 2011] ricehub", "background": "", "description": "In the countryside, there is a straight and long road called the “Rice Road”. Along this Rice Road there are $R$ rice fields, and the coordinate of each field is an integer between $1$ and $L$ (including $1$ and $L$). These fields are given in non-decreasing order of coordinates, that is, for $0 \\le i < R$, the coordinate $X[i]$ of field $i$ satisfies $1 \\le X[0] \\le \\cdots \\le X[R-1] \\le L$.\n\nNote: multiple fields may be located at the same coordinate.\n\nWe plan to build a rice hub to store as much rice as possible. Like the rice fields, the hub will be built on the Rice Road, and its coordinate is also an integer between $1$ and $L$ (including $1$ and $L$). The hub can be built at any position that satisfies the above conditions, including positions where one or more rice fields already exist.\n\nDuring harvest season, each rice field produces exactly one full truckload of rice. To transport this rice to the hub, we need to hire a truck driver. The driver charges $1$ yuan per unit distance for each full truckload. In other words, the cost to transport rice from a particular field to the hub equals the absolute difference between the field’s coordinate and the hub’s coordinate.\n\nUnfortunately, this year the budget is limited, and we can spend at most $B$ yuan on transportation. Your task is to help us find a hub location that can collect as much rice as possible.", "inputFormat": "The first line contains three integers $R, L, B$.\n\nThe next $R$ lines each contain one integer, representing $X[i]$.", "outputFormat": "Output one integer, the maximum amount of rice that can be collected.", "hint": "For $100\\%$ of the testdata, $1 \\le R \\le 10^5$, $1 \\le L \\le 10^9$, $0 \\le B \\le 2 \\times 10^{15}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[IOI 2011] ricehub", "background": "", "description": "乡间有一条笔直而长的路称为“米道”。沿着这条米道上$R$  块稻田，每块稻田的坐标均为一个 $1$ 到 $L$ 之间(含 $1$ 和 $L$ )的整数。这些稻田按照坐标以不减的顺序给出，即对于 $0 \\le i < R$，稻田 $i$ 的坐标 $X[i]$ 满足 $1 \\le X[0] \\le \\cdots \\le X[R-1] \\le L$。\n\n注意：可能有多块稻田位于同一个坐标上。\n\n我们计划建造一个米仓用于储存尽可能多的稻米。和稻田一样，米仓将建在米道上，其坐标也是一个 $1$ 到 $L$ 之间的整数（含 $1$ 和 $L$）。这个米仓可以建在满足上述条件的任一个位置上，包括那些原来已有一个或多个稻田存在的位置。\n\n在收获季节，每一块稻田刚好出产一滿货车的稻米。为了将这些稻米运到米仓，需要雇用一位货车司机来运米。司机的收费是每一满货车运送一个单位的距离收取 $1$ 元。換言之，将稻米从特定的稻田运到米仓的费用在数值上等于稻田坐标与米仓坐标之差的绝对值。\n\n不幸的是，今年预算有限，我们至多只能花费 $B$ 元运费。你的任务是要帮我们找出一个建造米仓的位置，可以收集到尽可能多的稻米。", "inputFormat": "第一行 三个整数 $R,L,B$；\n\n接下来 $R$ 行 每行一个整数 表示 $X[i]$。", "outputFormat": "一个整数，表示最多稻米数", "hint": "对于 $100\\%$ 的数据，$1 \\le R \\le 10^5$，$1 \\le L \\le 10^9$，$ 0 \\le B \\le 2 \\times 10^{15}$。", "locale": "zh-CN"}}}
{"pid": "P5845", "type": "P", "difficulty": 5, "samples": [["13 12 9\n0 1 1\n0 2 4\n0 3 11\n1 4 11\n1 5 7\n1 6 15\n2 7 3\n2 8 13\n2 9 23\n3 10 3\n3 11 1\n3 12 2\n4 5 6 7 8 9 10 11 12\n", "13\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["图论", "2011", "IOI", "最短路"], "title": "[IOI 2011] crocodile", "background": null, "description": "考古学家 Benjamas 考察了神秘的鳄鱼地下宫殿之后需要设法逃离。这个地下宫殿包含 $N$ 个洞穴和 $M$ 条双向的通道。每条通道连接一对不同的洞穴，两个洞穴之间最多只有一条通道，在不同的通道上行走可能需要不同的时间。$N$ 个洞穴中有 $K$ 个洞穴是出口洞穴，Benjamas 可以从出口洞穴逃离。Benjamas 从 $0$ 号洞穴出发，她希望尽快地到达一个出口洞穴。\n\n鳄鱼门卫要阻止 Benjamas 逃离宫殿。它可以通过机关来堵住任意一个的通道（任意时刻，只能堵住一个通道）。即无论何时，鳄鱼门卫堵住一个新的通道，则之前堵住的通道就会被打开。\n\nBenjamas 逃离过程可以描述如下：每次她试图离开一个洞穴时，鳄鱼门卫都会封闭一条连接该洞穴的通道。Benjamas 只能选择没有被封闭的通道走到下一个洞穴。Benjamas 一旦进入一条通道，在她到达该通道的另一端前，鳄鱼门卫不能封闭这条通道。当 Benjamas 到达下一个洞穴，鳄鱼门卫可以选择再封闭一条通道（可以是 Benjamas 刚刚走过的那条通道）。\n\nBenjamas 需要设计一个逃生计划，确切地说，她希望有一系列指令告诉她如何逃生。\n\n设 $A$ 是一个洞穴，如果 $A$ 是出口洞穴，Benjamas 可以直接逃生。否则，对洞穴 $A$，指令是下列形式中的一种：\n\n- 在洞穴 $A$，优先选择一条通道到洞穴 $B$。如果该通道被封堵，则选择另一通道去洞穴 $C$。\n\n- 不用考虑洞穴 $A$，按照逃生计划不会到达 $A$。\n\n注意：数据保证不管鳄鱼门卫如何封闭通道，总能找到一个好的逃生计划保证 Benjamas 在有限时间内可以到达一个出口洞穴。在所有逃生计划中，在最坏情况下用时最短的逃生计划所用的时间定义为 $T$。", "inputFormat": "第一行三个整数 $N$，$M$，$K$；\n\n接下来 $M$ 行 每行三个整数 表示一条无向边的两端和长度（无重边）；\n\n接下来 $K$ 个整数 表示出口洞穴。", "outputFormat": "一个整数 最小时间 $T$。", "hint": "**数据范围**\n\n对于 $100\\%$ 的数据，$3 \\le N \\le 10^5$，$2 \\le M \\le 10^6$，测试数据保证 $T$ 存在，且 $T \\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[IOI 2011] crocodile", "background": "", "description": "After exploring the mysterious underground crocodile palace, archaeologist Benjamas needs to find a way to escape. This underground palace contains $N$ caves and $M$ bidirectional tunnels. Each tunnel connects a pair of different caves, and there is at most one tunnel between any two caves. Traveling along different tunnels may take different amounts of time. Among the $N$ caves, there are $K$ exit caves, and Benjamas can escape from any exit cave. Benjamas starts from cave $0$ and wants to reach an exit cave as quickly as possible.\n\nThe crocodile guard wants to stop Benjamas from escaping the palace. It can use a mechanism to block any one tunnel (at any moment, it can block only one tunnel). That is, whenever the guard blocks a new tunnel, the previously blocked tunnel will be opened.\n\nBenjamas’s escape process can be described as follows: each time she tries to leave a cave, the crocodile guard will block one tunnel connected to that cave. Benjamas can only choose an unblocked tunnel to go to the next cave. Once Benjamas enters a tunnel, the guard cannot block that tunnel before she reaches the other end. When Benjamas arrives at the next cave, the guard may choose to block another tunnel (which may be the tunnel Benjamas just used).\n\nBenjamas needs to design an escape plan. More precisely, she wants a sequence of instructions that tells her how to escape.\n\nLet $A$ be a cave. If $A$ is an exit cave, Benjamas can escape immediately. Otherwise, for cave $A$, the instruction is one of the following forms:\n\n- At cave $A$, first try to take the tunnel to cave $B$. If that tunnel is blocked, then take another tunnel to cave $C$.\n\n- Ignore cave $A$; according to the escape plan, cave $A$ will never be reached.\n\nNote: The testdata guarantees that no matter how the crocodile guard blocks tunnels, there always exists a good escape plan that guarantees Benjamas can reach an exit cave in finite time. Among all escape plans, the time used by the escape plan with the minimum time in the worst case is defined as $T$.", "inputFormat": "The first line contains three integers $N$, $M$, $K$.\n\nThe next $M$ lines each contain three integers, describing the two endpoints of an undirected edge and its length (no multiple edges).\n\nThe next line contains $K$ integers, describing the exit caves.", "outputFormat": "Output one integer, the minimum time $T$.", "hint": "**Constraints**\n\nFor $100\\%$ of the testdata, $3 \\le N \\le 10^5$, $2 \\le M \\le 10^6$. The testdata guarantees that $T$ exists, and $T \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[IOI 2011] crocodile", "background": null, "description": "考古学家 Benjamas 考察了神秘的鳄鱼地下宫殿之后需要设法逃离。这个地下宫殿包含 $N$ 个洞穴和 $M$ 条双向的通道。每条通道连接一对不同的洞穴，两个洞穴之间最多只有一条通道，在不同的通道上行走可能需要不同的时间。$N$ 个洞穴中有 $K$ 个洞穴是出口洞穴，Benjamas 可以从出口洞穴逃离。Benjamas 从 $0$ 号洞穴出发，她希望尽快地到达一个出口洞穴。\n\n鳄鱼门卫要阻止 Benjamas 逃离宫殿。它可以通过机关来堵住任意一个的通道（任意时刻，只能堵住一个通道）。即无论何时，鳄鱼门卫堵住一个新的通道，则之前堵住的通道就会被打开。\n\nBenjamas 逃离过程可以描述如下：每次她试图离开一个洞穴时，鳄鱼门卫都会封闭一条连接该洞穴的通道。Benjamas 只能选择没有被封闭的通道走到下一个洞穴。Benjamas 一旦进入一条通道，在她到达该通道的另一端前，鳄鱼门卫不能封闭这条通道。当 Benjamas 到达下一个洞穴，鳄鱼门卫可以选择再封闭一条通道（可以是 Benjamas 刚刚走过的那条通道）。\n\nBenjamas 需要设计一个逃生计划，确切地说，她希望有一系列指令告诉她如何逃生。\n\n设 $A$ 是一个洞穴，如果 $A$ 是出口洞穴，Benjamas 可以直接逃生。否则，对洞穴 $A$，指令是下列形式中的一种：\n\n- 在洞穴 $A$，优先选择一条通道到洞穴 $B$。如果该通道被封堵，则选择另一通道去洞穴 $C$。\n\n- 不用考虑洞穴 $A$，按照逃生计划不会到达 $A$。\n\n注意：数据保证不管鳄鱼门卫如何封闭通道，总能找到一个好的逃生计划保证 Benjamas 在有限时间内可以到达一个出口洞穴。在所有逃生计划中，在最坏情况下用时最短的逃生计划所用的时间定义为 $T$。", "inputFormat": "第一行三个整数 $N$，$M$，$K$；\n\n接下来 $M$ 行 每行三个整数 表示一条无向边的两端和长度（无重边）；\n\n接下来 $K$ 个整数 表示出口洞穴。", "outputFormat": "一个整数 最小时间 $T$。", "hint": "**数据范围**\n\n对于 $100\\%$ 的数据，$3 \\le N \\le 10^5$，$2 \\le M \\le 10^6$，测试数据保证 $T$ 存在，且 $T \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5846", "type": "P", "difficulty": 5, "samples": [["6\n3 4 5 1 2 6\n", "2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2005", "IOI", "分类讨论"], "title": "[IOI 2005] bir", "background": null, "description": "今天是 Byteman 的生日。有 $n$ 个孩子参加他的生日宴会（包括 Byteman ）。孩子们从 $1$ 到 $n$ 编号。Byteman 的父母准备了一张大圆桌并放了n把椅子在圆桌周围。孩子们来了就坐下。$1$ 号孩子坐其中一个，然后 $2$ 号孩子坐在他左边，然后 $3$ 号孩子坐在 $2$ 号左边，以此类推。最后 $n$ 号孩子坐在最后一个空椅子上，也就是 $n-1$ 号孩子和 $1$ 号孩子之间。\n\nByteman 的父母非常了解这些孩子，知道如果有些孩子坐在一起就会非常吵。因此他们将按特定顺序调整这些孩子的座位。用一个置换 $p_1,p_2,\\cdots,p_n$ ($p_1,p_2,\\cdots,p_n$是 $1$ 到 $n$ 的整数)来表示这个顺序。孩子 $p_1$ 将坐在 $p_2$ 和 $p_n$ 之间，孩子 $p_i$ ($ i = 2,3,…n-1$)将坐在孩子 $p_{i-1}$ 和 $p_{i+1}$ 之间，孩子 $p_n$ 将坐在孩子 $p_{n-1}$ 和 $p_1$ 之间。需要注意的是 $p_1$ 可以坐在 $p_n$ 左边也可以坐在 $p_n$ 右边。 \n\n让所有孩子按给定顺序做好，Byteman 父母必须让每个孩子绕圆桌向左或向右移动一些座位。他们必须决定每个孩子如何移动，也就是说它们必须决定一个方向，以及距离。对于给定的移动信号，所有孩子立刻站起来，移到合适的位置坐下。 串座过程使研会变得乱七八糟，乱七八糟值等于所有孩子中最大移动距离，孩子们可以以很多种方式移动，Byteman 父母将选择乱七八糟值最小的。帮他们找到这一种方案。 \n\n你的任务是写一个程序： 从标准输入读入孩子的数目和描述目标序列的那个置换。 算出最小的乱七八糟值。", "inputFormat": "第一行包括一个整数 $n$ ($1 \\le n \\le 10^6$)。 \n\n第二行包括 $n$ 个整数 $p_1,p_2,\\cdots,p_n$，以一个空格分开。$p_1,p_2,\\cdots,p_n$ 是集合 $\\{1,2,\\cdots,n\\}$ 的一个置换，描述目标顺序。", "outputFormat": "一行包含一个整数：最小的乱七八糟值。", "hint": "对于 $50\\%$ 的数据，$1 \\le n \\le 1000$；\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "[IOI 2005] bir", "background": "", "description": "Today is Byteman’s birthday. There are $n$ children at his birthday party (including Byteman). The children are numbered from $1$ to $n$. Byteman’s parents prepared a big round table and placed $n$ chairs around it. When the children arrive, they sit down as follows: child $1$ sits on some chair, then child $2$ sits to the left of child $1$, then child $3$ sits to the left of child $2$, and so on. Finally, child $n$ sits on the last empty chair, i.e. between child $n-1$ and child $1$.\n\nByteman’s parents know the children very well, and they know that if some children sit next to each other, they will be very noisy. Therefore, they will rearrange the children’s seats in a specific order. This order is given by a permutation $p_1,p_2,\\cdots,p_n$ ($p_1,p_2,\\cdots,p_n$ are integers from $1$ to $n$). Child $p_1$ will sit between $p_2$ and $p_n$, child $p_i$ ($i = 2,3,\\ldots,n-1$) will sit between children $p_{i-1}$ and $p_{i+1}$, and child $p_n$ will sit between children $p_{n-1}$ and $p_1$. Note that $p_1$ may sit either to the left of $p_n$ or to the right of $p_n$.\n\nTo make all children sit in the given order, Byteman’s parents must let each child move some seats to the left or to the right around the table. They must decide how each child moves, that is, they must decide a direction and a distance. For a given moving instruction, all children stand up at once and move to their target seats and sit down. This process makes the party messy. The messiness is defined as the maximum moving distance among all children. Since the children can move in many different ways, Byteman’s parents will choose the one that minimizes the messiness. Help them find such a plan.\n\nYour task is to write a program that reads from standard input the number of children and the permutation describing the target order, and computes the minimum possible messiness.", "inputFormat": "The first line contains an integer $n$ ($1 \\le n \\le 10^6$).\n\nThe second line contains $n$ integers $p_1,p_2,\\cdots,p_n$, separated by single spaces. $p_1,p_2,\\cdots,p_n$ is a permutation of the set $\\{1,2,\\cdots,n\\}$, describing the target order.", "outputFormat": "One line containing one integer: the minimum messiness.", "hint": "For $50\\%$ of the testdata, $1 \\le n \\le 1000$.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[IOI 2005] bir", "background": null, "description": "今天是 Byteman 的生日。有 $n$ 个孩子参加他的生日宴会（包括 Byteman ）。孩子们从 $1$ 到 $n$ 编号。Byteman 的父母准备了一张大圆桌并放了n把椅子在圆桌周围。孩子们来了就坐下。$1$ 号孩子坐其中一个，然后 $2$ 号孩子坐在他左边，然后 $3$ 号孩子坐在 $2$ 号左边，以此类推。最后 $n$ 号孩子坐在最后一个空椅子上，也就是 $n-1$ 号孩子和 $1$ 号孩子之间。\n\nByteman 的父母非常了解这些孩子，知道如果有些孩子坐在一起就会非常吵。因此他们将按特定顺序调整这些孩子的座位。用一个置换 $p_1,p_2,\\cdots,p_n$ ($p_1,p_2,\\cdots,p_n$是 $1$ 到 $n$ 的整数)来表示这个顺序。孩子 $p_1$ 将坐在 $p_2$ 和 $p_n$ 之间，孩子 $p_i$ ($ i = 2,3,…n-1$)将坐在孩子 $p_{i-1}$ 和 $p_{i+1}$ 之间，孩子 $p_n$ 将坐在孩子 $p_{n-1}$ 和 $p_1$ 之间。需要注意的是 $p_1$ 可以坐在 $p_n$ 左边也可以坐在 $p_n$ 右边。 \n\n让所有孩子按给定顺序做好，Byteman 父母必须让每个孩子绕圆桌向左或向右移动一些座位。他们必须决定每个孩子如何移动，也就是说它们必须决定一个方向，以及距离。对于给定的移动信号，所有孩子立刻站起来，移到合适的位置坐下。 串座过程使研会变得乱七八糟，乱七八糟值等于所有孩子中最大移动距离，孩子们可以以很多种方式移动，Byteman 父母将选择乱七八糟值最小的。帮他们找到这一种方案。 \n\n你的任务是写一个程序： 从标准输入读入孩子的数目和描述目标序列的那个置换。 算出最小的乱七八糟值。", "inputFormat": "第一行包括一个整数 $n$ ($1 \\le n \\le 10^6$)。 \n\n第二行包括 $n$ 个整数 $p_1,p_2,\\cdots,p_n$，以一个空格分开。$p_1,p_2,\\cdots,p_n$ 是集合 $\\{1,2,\\cdots,n\\}$ 的一个置换，描述目标顺序。", "outputFormat": "一行包含一个整数：最小的乱七八糟值。", "hint": "对于 $50\\%$ 的数据，$1 \\le n \\le 1000$；\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^6$。", "locale": "zh-CN"}}}
{"pid": "P5847", "type": "P", "difficulty": 4, "samples": [["3\n2\n5\n9\n", "4\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2005", "IOI"], "title": "[IOI 2005] mea", "background": null, "description": "考虑一个非递减的整数序列 $S_1,\\cdots,S_{n+1}$ ($S_i \\le S_{i+1}$，$1 \\le i \\le n$)。序列 $M_1 \\cdots M_n$ 是定义在序列 $S$ 的基础上，关系式为 $M_i = \\frac{S_i + S_{i+1}}{2}$（$1 \\le i \\le n$），序列 $M$ 叫做序列 $S$ 的平均数序列。\n\n例如序列 $1,2,2,4$ 的平均数序列为 $1.5,2,3$. 注意到平均数序列中的元素可能为小数。但是本题的任务只是处理平均数序列都为整数的情况。\n\n给出一个 $n$ 个数字的非递减的整数序列 $M_1,M_2,\\cdots,M_n$。请你计算出：序列 $S_1,\\cdots,S_{n+1}$ 的平均序列是 $M_1,\\cdots,M_n$。 求满足以上条件的序列 $S$ 的总个数。\n\n任务：从标准输入文件中读入一个非递减的整数序列。计算出平均序列是给出序列的整数序列的总个数。把计算结果写到标准输出文件中。", "inputFormat": "输入文件的第一行包含一个整数 $n$（$2 \\le n \\le 5 \\times 10^6$）。\n\n接下来的 $n$ 行包含了这个给出的整数序列 $M_1,\\cdots,M_n$。第 $i+1$ 行包含一个整数 $M_i$ ( $1 \\le M_i \\le 10^9$)。", "outputFormat": "输出文件仅一行，即所求答案。", "hint": "**样例说明**\n\n一共存在 $4$ 种序列，它们的平均数序列都是 $2,5,9$。这四种序列如下：\n\n- $2,2,8,10$\n- $1,3,7,11$\n- $0,4,6,12$\n- $-1,5,5,13$\n\n**数据范围**\n\n对于 $50\\%$ 的数据，$2 \\le n \\le 1000$，$1 \\le M_i \\le 2 \\times 10^4$；\n\n对于 $100\\%$ 的数据，$2 \\le n \\le 5 \\times 10^6$，$1 \\le M_i \\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[IOI 2005] mea", "background": "", "description": "Consider a non-decreasing integer sequence $S_1,\\cdots,S_{n+1}$ ($S_i \\le S_{i+1}$, $1 \\le i \\le n$). A sequence $M_1 \\cdots M_n$ is defined based on the sequence $S$ by the relation $M_i = \\frac{S_i + S_{i+1}}{2}$ ($1 \\le i \\le n$). The sequence $M$ is called the mean sequence of $S$.\n\nFor example, the mean sequence of $1,2,2,4$ is $1.5,2,3$. Note that elements in the mean sequence may be decimals. However, in this problem, you only need to handle the case where all elements of the mean sequence are integers.\n\nYou are given a non-decreasing integer sequence $M_1,M_2,\\cdots,M_n$ of length $n$. Please compute the total number of sequences $S_1,\\cdots,S_{n+1}$ such that the mean sequence of $S$ is exactly $M_1,\\cdots,M_n$.\n\nTask: Read a non-decreasing integer sequence from standard input. Compute the number of integer sequences whose mean sequence equals the given integer sequence. Write the result to standard output.", "inputFormat": "The first line contains an integer $n$ ($2 \\le n \\le 5 \\times 10^6$).\n\nThe next $n$ lines contain the given integer sequence $M_1,\\cdots,M_n$. The $(i+1)$-th line contains an integer $M_i$ ($1 \\le M_i \\le 10^9$).", "outputFormat": "Output only one line, which is the required answer.", "hint": "**Sample Explanation**\n\nThere are $4$ sequences in total whose mean sequence is $2,5,9$. These four sequences are:\n\n- $2,2,8,10$\n- $1,3,7,11$\n- $0,4,6,12$\n- $-1,5,5,13$\n\n**Constraints**\n\nFor $50\\%$ of the testdata, $2 \\le n \\le 1000$, $1 \\le M_i \\le 2 \\times 10^4$.\n\nFor $100\\%$ of the testdata, $2 \\le n \\le 5 \\times 10^6$, $1 \\le M_i \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[IOI 2005] mea", "background": null, "description": "考虑一个非递减的整数序列 $S_1,\\cdots,S_{n+1}$ ($S_i \\le S_{i+1}$，$1 \\le i \\le n$)。序列 $M_1 \\cdots M_n$ 是定义在序列 $S$ 的基础上，关系式为 $M_i = \\frac{S_i + S_{i+1}}{2}$（$1 \\le i \\le n$），序列 $M$ 叫做序列 $S$ 的平均数序列。\n\n例如序列 $1,2,2,4$ 的平均数序列为 $1.5,2,3$. 注意到平均数序列中的元素可能为小数。但是本题的任务只是处理平均数序列都为整数的情况。\n\n给出一个 $n$ 个数字的非递减的整数序列 $M_1,M_2,\\cdots,M_n$。请你计算出：序列 $S_1,\\cdots,S_{n+1}$ 的平均序列是 $M_1,\\cdots,M_n$。 求满足以上条件的序列 $S$ 的总个数。\n\n任务：从标准输入文件中读入一个非递减的整数序列。计算出平均序列是给出序列的整数序列的总个数。把计算结果写到标准输出文件中。", "inputFormat": "输入文件的第一行包含一个整数 $n$（$2 \\le n \\le 5 \\times 10^6$）。\n\n接下来的 $n$ 行包含了这个给出的整数序列 $M_1,\\cdots,M_n$。第 $i+1$ 行包含一个整数 $M_i$ ( $1 \\le M_i \\le 10^9$)。", "outputFormat": "输出文件仅一行，即所求答案。", "hint": "**样例说明**\n\n一共存在 $4$ 种序列，它们的平均数序列都是 $2,5,9$。这四种序列如下：\n\n- $2,2,8,10$\n- $1,3,7,11$\n- $0,4,6,12$\n- $-1,5,5,13$\n\n**数据范围**\n\n对于 $50\\%$ 的数据，$2 \\le n \\le 1000$，$1 \\le M_i \\le 2 \\times 10^4$；\n\n对于 $100\\%$ 的数据，$2 \\le n \\le 5 \\times 10^6$，$1 \\le M_i \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5848", "type": "P", "difficulty": 5, "samples": [["4\nQ 1\nI 1 4 2\nQ 3\nQ 1\nI 2 2 -1\nQ 3\nE\n", "4\n1\n0\n3\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2005", "IOI"], "title": "[IOI 2005] mou", "background": "", "description": "游乐园已经开始运行一个崭新的模拟过山车。模拟的轨道由 $n$ 段铁轨组成，并且首尾相连。第一段铁轨从高度 $0$ 开始。\n\n操作员 Byteman 能通过调整连续几段的铁轨高度来改造这条轨道。在被改造的一段前面的铁轨高度不受影响。 每一次铁轨被调整。后面的轨必须升起或降低来保持连通，并保证起点高度为 $0$。下页举例说明轨道改造过程。 每次开始时车都有足够能量到达高度 $h$。也就是说，只要轨道的高度不超过 $h$，车就一直开下去, 甚至直到结束。 \n\n给出每天的运行和改造情况, 为每次运行计算在车停止前，到达的铁轨数。铁轨以一个 $n$ 个数的数列形式表示 ，一个数对应一段铁轨。第 $i$ 个 $d_i$ 表示在第 $i$ 段铁轨上的高度变化。也就是说，在到达铁轨 $i$ 前，如果车的高度是 $h$，那么经过铁轨i后，高度变为 $h+d_i$。\n\n最初轨道是一条水平线。就是说对于所有的 $i$ 都是 $d_i=0$。运行和改造交错进行。 每个改造用三个数表示: $a$ ，$b$ 和 $D$。表示从 $a$ 到 $b$ (包括 $a$,$b$) 的所有 $d_i$ 改为 $d_i=D$。每次运行给定一个数字 $h$ ——车能到达的最大高度。", "inputFormat": "输入的第一行包括一个正整数 $n$ ——铁轨的数目。\n\n下面的行包括改造和运行，各有一个标识符： \n\n- 改造——一个字母 `I`，和整数$a$,$b$,$D$ ,中间用一个空格隔开。\n- 运行——一个字母 `Q`，和一个整数 $h$，用一个空格隔开。 \n- 一个字母 `E` ——结束符号，表示输入结束。 \n\n你可以假设任意时刻任意铁轨的高度在 $[1，1000000000]$ 区间内。\n\n输入不超过 $10000$ 行。", "outputFormat": "第 $i$ 行需包含一个整数， 即第 $i$ 次运行经过的铁轨数。", "hint": "对于 $50\\%$ 的数据，$1 \\le n \\le 2 \\times 10^4$，且输入不超过 $1000$ 行；\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^9$，$1 \\le a,b \\le n$，$- 10^9 \\le D \\le 10^9$，$0 \\le h \\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[IOI 2005] mou", "background": "", "description": "An amusement park has started operating a brand new simulated roller coaster. The simulated track consists of $n$ rail segments, and the first and last segments are connected to form a loop. The first rail segment starts at height $0$.\n\nThe operator Byteman can modify the track by adjusting the heights of several consecutive rail segments. The heights of the segments before the modified part are not affected. Each time the rail heights are adjusted, the segments after the modified part must be raised or lowered to keep the track connected, and the starting height must remain $0$. The next page illustrates the modification process.\n\nAt the start of each run, the car has enough energy to reach height $h$. That is, as long as the height of the track does not exceed $h$, the car keeps moving, even until it finishes.\n\nGiven the daily runs and modifications, for each run compute how many rail segments the car passes before it stops.\n\nThe rails are represented as a sequence of $n$ numbers, where each number corresponds to one rail segment. The $i$-th value $d_i$ denotes the height change on the $i$-th segment. In other words, if the car’s height is $h$ before reaching segment $i$, then after passing segment $i$, the height becomes $h+d_i$.\n\nInitially, the track is a horizontal line, meaning $d_i=0$ for all $i$. Runs and modifications are interleaved. Each modification is given by three numbers: $a$, $b$, and $D$, meaning that all $d_i$ for $i$ from $a$ to $b$ (inclusive) are set to $d_i=D$. Each run is given a number $h$, the maximum height the car can reach.", "inputFormat": "The first line of input contains a positive integer $n$, the number of rail segments.\n\nThe following lines contain modifications and runs, each starting with an identifier:\n\n- Modification: a letter `I`, followed by integers $a$, $b$, and $D$, separated by single spaces.\n- Run: a letter `Q`, followed by an integer $h$, separated by a single space.\n- A letter `E`: the termination symbol, indicating the end of input.\n\nYou may assume that at any time, the height of any rail segment is within the range $[1,1000000000]$.\n\nThe input contains no more than $10000$ lines.", "outputFormat": "For the $i$-th run, output one integer per line: the number of rail segments passed in that run.", "hint": "For $50\\%$ of the testdata, $1 \\le n \\le 2 \\times 10^4$, and the input contains no more than $1000$ lines.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 10^9$, $1 \\le a,b \\le n$, $- 10^9 \\le D \\le 10^9$, $0 \\le h \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[IOI 2005] mou", "background": "", "description": "游乐园已经开始运行一个崭新的模拟过山车。模拟的轨道由 $n$ 段铁轨组成，并且首尾相连。第一段铁轨从高度 $0$ 开始。\n\n操作员 Byteman 能通过调整连续几段的铁轨高度来改造这条轨道。在被改造的一段前面的铁轨高度不受影响。 每一次铁轨被调整。后面的轨必须升起或降低来保持连通，并保证起点高度为 $0$。下页举例说明轨道改造过程。 每次开始时车都有足够能量到达高度 $h$。也就是说，只要轨道的高度不超过 $h$，车就一直开下去, 甚至直到结束。 \n\n给出每天的运行和改造情况, 为每次运行计算在车停止前，到达的铁轨数。铁轨以一个 $n$ 个数的数列形式表示 ，一个数对应一段铁轨。第 $i$ 个 $d_i$ 表示在第 $i$ 段铁轨上的高度变化。也就是说，在到达铁轨 $i$ 前，如果车的高度是 $h$，那么经过铁轨i后，高度变为 $h+d_i$。\n\n最初轨道是一条水平线。就是说对于所有的 $i$ 都是 $d_i=0$。运行和改造交错进行。 每个改造用三个数表示: $a$ ，$b$ 和 $D$。表示从 $a$ 到 $b$ (包括 $a$,$b$) 的所有 $d_i$ 改为 $d_i=D$。每次运行给定一个数字 $h$ ——车能到达的最大高度。", "inputFormat": "输入的第一行包括一个正整数 $n$ ——铁轨的数目。\n\n下面的行包括改造和运行，各有一个标识符： \n\n- 改造——一个字母 `I`，和整数$a$,$b$,$D$ ,中间用一个空格隔开。\n- 运行——一个字母 `Q`，和一个整数 $h$，用一个空格隔开。 \n- 一个字母 `E` ——结束符号，表示输入结束。 \n\n你可以假设任意时刻任意铁轨的高度在 $[1，1000000000]$ 区间内。\n\n输入不超过 $10000$ 行。", "outputFormat": "第 $i$ 行需包含一个整数， 即第 $i$ 次运行经过的铁轨数。", "hint": "对于 $50\\%$ 的数据，$1 \\le n \\le 2 \\times 10^4$，且输入不超过 $1000$ 行；\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^9$，$1 \\le a,b \\le n$，$- 10^9 \\le D \\le 10^9$，$0 \\le h \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5849", "type": "P", "difficulty": 3, "samples": [["3 2 8\n1 2 5\n", "10\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "IOI"], "title": "[IOI 2015] boxes", "background": "", "description": "IOI2015 开幕式正在进行最后一个环节。按计划在开幕式期间，每个代表队都将收到由主办方发放的一个装有纪念品的盒子。然而所有志愿者都被精彩的开幕式所吸引，除 Aman 外其他人完全忘记了发放纪念品这件事。Aman 是一位热情的志愿者，为使得 IOI 尽量圆满，他要用最短的时间将所有纪念品发放出去。\n\n开幕式的场地是一个圆环，被分为 $L$个完全相等的区域，这些区域的编号依次为 $0$ 到 $L-1$，也就是说，对于$0\\le \n i\\le L-2$,区域 $i$ 与区域 $i+1$ 相邻，且区域 $L-1$ 与区域 $0$ 相邻。场地上共有 $N$ 个代表队，每队坐在上面的一个区域上，每个区域可以包含任意多个代表队，也可以为空。\n\n一共有 $N$ 个相同的纪念品。开始，Aman 和所有纪念品都在区域 $0$。Aman 应该给每队一个纪念品，并且在发放完最后一个纪念品后他必须回到区域 $0$。注意，有些队可能坐在区域 $0$。\n\n在任意时刻，Aman 只能够携带至多 $K$ 个纪念品。Aman 必须从区域 $0$ 取走这些纪念品，且取纪念品不需要时间。纪念品一旦从区域 $0$ 被取走后，Aman 只能将其发放给某个代表队或者随身携带。无论何时，Aman 携带一个或更多的纪念品到达一个这样的区域，该区域有一个代表队尚未收到纪念品，Aman 便可将他携带的一个纪念品发给这个代表队。这种发放也在瞬间完成。他所花的时间都消耗在区域之间的移动上。无论携带多少纪念品，Aman 都需要 $1$ 秒钟从一个区域移动到其相邻的区域（可以顺时针移动也可以逆时针移动）。\n\n你的任务是计算出 Aman 发放完所有纪念品并返回到他的最初区域所需要的最短时间（秒数）。", "inputFormat": "- 第 $1$ 行有三个整数 $N$，$K$，$L$，分别表示 代表队的数目，Aman 每次最多能携带的纪念品数量 ，开幕式场地上的区域数目；\n- 第 $2$ 行有 $N$ 个整数，分别为 $p[0],\\cdots,p[N−1]$，其中 $p[i]$ （$0\\le i\\le N-1$）代表第 $i$ 支代表队所在区域编号。$p$ 的元素按非递减排序。", "outputFormat": "共一行，Aman 所需要的最短时间（秒数）。", "hint": "对于 $100\\%$ 的数据，$1\\le N\\le 10^7$，$1\\le K\\le N$，$1\\le L\\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[IOI 2015] boxes", "background": "", "description": "The opening ceremony of IOI 2015 is in its final part. According to the plan, during the ceremony, each delegation should receive a box containing souvenirs provided by the organizers. However, all volunteers were attracted by the wonderful ceremony and completely forgot about distributing the souvenirs, except Aman. Aman is an enthusiastic volunteer, and to make IOI as successful as possible, he wants to distribute all souvenirs in the shortest time.\n\nThe ceremony venue is a circular ring divided into $L$ equal areas. These areas are numbered from $0$ to $L-1$. That is, for $0\\le i\\le L-2$, area $i$ is adjacent to area $i+1$, and area $L-1$ is adjacent to area $0$. There are $N$ delegations in total, each sitting in one of these areas. Each area may contain any number of delegations, and it may also be empty.\n\nThere are $N$ identical souvenirs. At the beginning, Aman and all souvenirs are in area $0$. Aman should give one souvenir to each delegation, and after distributing the last souvenir, he must return to area $0$. Note that some delegations may be in area $0$.\n\nAt any moment, Aman can carry at most $K$ souvenirs. Aman must take these souvenirs from area $0$, and taking souvenirs takes no time. Once a souvenir is taken from area $0$, Aman can only give it to some delegation or carry it with him. Whenever Aman arrives at an area while carrying one or more souvenirs, and that area has at least one delegation that has not yet received a souvenir, Aman can give one of the souvenirs he is carrying to that delegation. This distribution is also instantaneous. The time he spends is only on moving between areas. No matter how many souvenirs he carries, Aman needs $1$ second to move from one area to an adjacent area (he can move clockwise or counterclockwise).\n\nYour task is to compute the minimum time (in seconds) Aman needs to distribute all souvenirs and return to his initial area.", "inputFormat": "- Line $1$ contains three integers $N$, $K$, $L$, representing the number of delegations, the maximum number of souvenirs Aman can carry each time, and the number of areas in the venue, respectively.\n- Line $2$ contains $N$ integers $p[0],\\cdots,p[N−1]$, where $p[i]$ ($0\\le i\\le N-1$) denotes the area index where the $i$-th delegation is located. The elements of $p$ are sorted in non-decreasing order.", "outputFormat": "One line containing the minimum time (in seconds) Aman needs.", "hint": "For $100\\%$ of the testdata, $1\\le N\\le 10^7$, $1\\le K\\le N$, $1\\le L\\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[IOI 2015] boxes", "background": "", "description": "IOI2015 开幕式正在进行最后一个环节。按计划在开幕式期间，每个代表队都将收到由主办方发放的一个装有纪念品的盒子。然而所有志愿者都被精彩的开幕式所吸引，除 Aman 外其他人完全忘记了发放纪念品这件事。Aman 是一位热情的志愿者，为使得 IOI 尽量圆满，他要用最短的时间将所有纪念品发放出去。\n\n开幕式的场地是一个圆环，被分为 $L$个完全相等的区域，这些区域的编号依次为 $0$ 到 $L-1$，也就是说，对于$0\\le \n i\\le L-2$,区域 $i$ 与区域 $i+1$ 相邻，且区域 $L-1$ 与区域 $0$ 相邻。场地上共有 $N$ 个代表队，每队坐在上面的一个区域上，每个区域可以包含任意多个代表队，也可以为空。\n\n一共有 $N$ 个相同的纪念品。开始，Aman 和所有纪念品都在区域 $0$。Aman 应该给每队一个纪念品，并且在发放完最后一个纪念品后他必须回到区域 $0$。注意，有些队可能坐在区域 $0$。\n\n在任意时刻，Aman 只能够携带至多 $K$ 个纪念品。Aman 必须从区域 $0$ 取走这些纪念品，且取纪念品不需要时间。纪念品一旦从区域 $0$ 被取走后，Aman 只能将其发放给某个代表队或者随身携带。无论何时，Aman 携带一个或更多的纪念品到达一个这样的区域，该区域有一个代表队尚未收到纪念品，Aman 便可将他携带的一个纪念品发给这个代表队。这种发放也在瞬间完成。他所花的时间都消耗在区域之间的移动上。无论携带多少纪念品，Aman 都需要 $1$ 秒钟从一个区域移动到其相邻的区域（可以顺时针移动也可以逆时针移动）。\n\n你的任务是计算出 Aman 发放完所有纪念品并返回到他的最初区域所需要的最短时间（秒数）。", "inputFormat": "- 第 $1$ 行有三个整数 $N$，$K$，$L$，分别表示 代表队的数目，Aman 每次最多能携带的纪念品数量 ，开幕式场地上的区域数目；\n- 第 $2$ 行有 $N$ 个整数，分别为 $p[0],\\cdots,p[N−1]$，其中 $p[i]$ （$0\\le i\\le N-1$）代表第 $i$ 支代表队所在区域编号。$p$ 的元素按非递减排序。", "outputFormat": "共一行，Aman 所需要的最短时间（秒数）。", "hint": "对于 $100\\%$ 的数据，$1\\le N\\le 10^7$，$1\\le K\\le N$，$1\\le L\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5850", "type": "P", "difficulty": 7, "samples": [["13 8", "91\n7462\n546546\n35387352\n3869654\n396558319\n363789591\n879373476\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "集训队互测", "O2优化", "生成函数", "快速傅里叶变换 FFT"], "title": "calc加强版", "background": "[原题链接](https://www.luogu.com.cn/problem/P4463)", "description": "一个序列 $a_1,\\cdots,a_n$ 是合法的，当且仅当：\n\n长度为给定的 $n$。\n\n$a_1,\\cdots,a_n$ 都是 $[1,k]$ 中的整数。\n\n$a_1,\\cdots,a_n$ 互不相等。\n\n一个序列的值定义为它里面所有数的乘积，即 $a_1\\times a_2\\times\\cdots\\times a_n$ 。\n\n求所有不同合法序列的值的和。\n\n两个序列不同当且仅当他们任意一位不一样。\n\n输出答案对 $998244353$ 取余的结果。", "inputFormat": "一行两个数 $k,m$。", "outputFormat": "共 $m$ 行，第 $i(1\\le i\\le m)$ 行表示 $n=i$ 时的答案。", "hint": "$\\text{subtask 1 (84 pts)}$：$1\\le m\\le 500$\n\n$\\text{subtask 2 (16 pts)}$：$1\\le m\\le 5\\times 10^5$，建议使用高效输出方式。\n\n对所有数据，$1\\le m\\le k\\le 998244352$。", "locale": "zh-CN", "translations": {"en": {"title": "calc Enhanced Version.", "background": "[Original problem link](https://www.luogu.com.cn/problem/P4463)", "description": "A sequence $a_1,\\cdots,a_n$ is valid if and only if:\n\n- Its length is the given $n$.\n- $a_1,\\cdots,a_n$ are all integers in $[1,k]$.\n- $a_1,\\cdots,a_n$ are pairwise distinct.\n\nThe value of a sequence is defined as the product of all numbers in it, i.e., $a_1\\times a_2\\times\\cdots\\times a_n$.\n\nFind the sum of the values of all different valid sequences.\n\nTwo sequences are different if and only if they differ at any position.\n\nOutput the answer modulo $998244353$.", "inputFormat": "One line with two numbers $k,m$.", "outputFormat": "There are $m$ lines in total.  \nOn the $i$-th line $(1\\le i\\le m)$, output the answer when $n=i$.", "hint": "$\\text{subtask 1 (84 pts)}$：$1\\le m\\le 500$.\n\n$\\text{subtask 2 (16 pts)}$：$1\\le m\\le 5\\times 10^5$，it is recommended to use an efficient output method.\n\nFor all testdata, $1\\le m\\le k\\le 998244352$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "calc加强版", "background": "[原题链接](https://www.luogu.com.cn/problem/P4463)", "description": "一个序列 $a_1,\\cdots,a_n$ 是合法的，当且仅当：\n\n长度为给定的 $n$。\n\n$a_1,\\cdots,a_n$ 都是 $[1,k]$ 中的整数。\n\n$a_1,\\cdots,a_n$ 互不相等。\n\n一个序列的值定义为它里面所有数的乘积，即 $a_1\\times a_2\\times\\cdots\\times a_n$ 。\n\n求所有不同合法序列的值的和。\n\n两个序列不同当且仅当他们任意一位不一样。\n\n输出答案对 $998244353$ 取余的结果。", "inputFormat": "一行两个数 $k,m$。", "outputFormat": "共 $m$ 行，第 $i(1\\le i\\le m)$ 行表示 $n=i$ 时的答案。", "hint": "$\\text{subtask 1 (84 pts)}$：$1\\le m\\le 500$\n\n$\\text{subtask 2 (16 pts)}$：$1\\le m\\le 5\\times 10^5$，建议使用高效输出方式。\n\n对所有数据，$1\\le m\\le k\\le 998244352$。", "locale": "zh-CN"}}}
{"pid": "P5851", "type": "P", "difficulty": 5, "samples": [["2 2\n100 1 2\n100 1 1\n", "200\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2019", "USACO", "区间 DP"], "title": "[USACO19DEC] Greedy Pie Eaters P", "background": null, "description": "Farmer John 有 $M$ 头奶牛，为了方便，编号为 $1,\\dots,M$。这些奶牛平时都吃青草，但是喜欢偶尔换换口味。Farmer John 一天烤了 $N$ 个派请奶牛吃，这 $N$ 个派编号为 $1,\\dots,N$。第 $i$ 头奶牛喜欢吃编号在 $\\left[ l_i,r_i \\right]$ 中的派（包括两端），并且没有两头奶牛喜欢吃相同范围的派。第 $i$ 头奶牛有一个体重 $w_i$，这是一个在 $\\left[ 1,10^6 \\right]$ 中的正整数。\n\nFarmer John 可以选择一个奶牛序列 $c_1,c_2,\\dots,c_K$，并让这些奶牛按这个顺序轮流吃派。不幸的是，这些奶牛不知道分享！当奶牛吃派时，她会把她喜欢吃的派都吃掉——也就是说，她会吃掉编号在 $[l_{c_i},r_{c_i}]$ 中所有剩余的派。Farmer John 想要避免当轮到一头奶牛吃派时，她所有喜欢的派在之前都被吃掉了这样尴尬的情况。因此，他想让你计算，要使奶牛按 $c_1,c_2,\\dots,c_K$ 的顺序吃派，轮到这头奶牛时她喜欢的派至少剩余一个的情况下，这些奶牛的最大可能体重（$w_{c_1}+w_{c_2}+\\ldots+w_{c_K}$）是多少。", "inputFormat": "第一行包含两个正整数 $N,M$；\n\n接下来 $M$ 行，每行三个正整数 $w_i,l_i,r_i$。", "outputFormat": "输出对于一个合法的序列，最大可能的体重值。", "hint": "#### 样例解释\n在这个样例中，如果奶牛 $1$ 先吃，那么奶牛 $2$ 就吃不到派了。然而，先让奶牛 $2$ 吃，然后奶牛 $1$ 只吃编号为 $2$ 的派，仍可以满足条件。\n\n#### 数据范围\n对于测试点 $2-5$，满足 $N \\le 50,M \\le 20$；\n\n对于测试点 $6-9$，满足 $N \\le 50$。\n\n对于全部数据，$1 \\le N \\le 300,1 \\le M \\le \\dfrac{N(N-1)}{2},1 \\le l_i,r_i \\le N,1 \\le w_i \\le 10^6$。\n\nUSACO 2019 December 铂金组 T1", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19DEC] Greedy Pie Eaters P", "background": null, "description": "Farmer John has $M$ cows, conveniently labeled $1 \\ldots M$, who enjoy the occasional change of pace\nfrom eating grass.  As a treat for the cows, Farmer John has baked $N$ pies ($1 \\leq N \\leq 300$), labeled\n$1 \\ldots N$.  Cow $i$ enjoys pies with labels in the range $[l_i, r_i]$ (from $l_i$ to $r_i$ inclusive),\nand no two cows enjoy the exact same range of pies.  Cow $i$ also has a weight, $w_i$, which \nis an integer in the range $1 \\ldots 10^6$.\n\nFarmer John may choose a sequence of cows $c_1,c_2,\\ldots, c_K,$ after which the\nselected cows will take turns eating in that order. Unfortunately, the cows \ndon't know how to share! When it is cow $c_i$'s turn to eat, she will consume\nall of the  pies that she enjoys --- that is, all remaining pies in the interval\n$[l_{c_i},r_{c_i}]$.  Farmer John would like to avoid the awkward situation\noccurring when it is a cows turn to eat but all of the pies she enjoys have already been\nconsumed. Therefore, he wants you to compute the largest possible total weight\n($w_{c_1}+w_{c_2}+\\ldots+w_{c_K}$) of a sequence $c_1,c_2,\\ldots, c_K$ for which each cow in the\nsequence eats at least one pie.", "inputFormat": "The first line contains two integers $N$ and $M(1\\leq M\\leq \\frac{N(N+1)}{2})$ \n\nThe next $M$ lines each describe a cow in terms of the integers $w_i$,$l_i$, and $r_i$.", "outputFormat": "Print the maximum possible total weight of a valid sequence.", "hint": "In this example, if cow $1$ eats first, then there will be nothing left for cow $2$ to eat. However, if cow $2$ eats first, then cow $1$ will be satisfied by eating the second pie only.\n\nTest cases $2-5$ satisfy $N\\leq50$ and $M\\leq 20$.\n\nTest cases $6-9$ satisfy $N\\leq 50$.", "locale": "en"}, "zh-CN": {"title": "[USACO19DEC] Greedy Pie Eaters P", "background": null, "description": "Farmer John 有 $M$ 头奶牛，为了方便，编号为 $1,\\dots,M$。这些奶牛平时都吃青草，但是喜欢偶尔换换口味。Farmer John 一天烤了 $N$ 个派请奶牛吃，这 $N$ 个派编号为 $1,\\dots,N$。第 $i$ 头奶牛喜欢吃编号在 $\\left[ l_i,r_i \\right]$ 中的派（包括两端），并且没有两头奶牛喜欢吃相同范围的派。第 $i$ 头奶牛有一个体重 $w_i$，这是一个在 $\\left[ 1,10^6 \\right]$ 中的正整数。\n\nFarmer John 可以选择一个奶牛序列 $c_1,c_2,\\dots,c_K$，并让这些奶牛按这个顺序轮流吃派。不幸的是，这些奶牛不知道分享！当奶牛吃派时，她会把她喜欢吃的派都吃掉——也就是说，她会吃掉编号在 $[l_{c_i},r_{c_i}]$ 中所有剩余的派。Farmer John 想要避免当轮到一头奶牛吃派时，她所有喜欢的派在之前都被吃掉了这样尴尬的情况。因此，他想让你计算，要使奶牛按 $c_1,c_2,\\dots,c_K$ 的顺序吃派，轮到这头奶牛时她喜欢的派至少剩余一个的情况下，这些奶牛的最大可能体重（$w_{c_1}+w_{c_2}+\\ldots+w_{c_K}$）是多少。", "inputFormat": "第一行包含两个正整数 $N,M$；\n\n接下来 $M$ 行，每行三个正整数 $w_i,l_i,r_i$。", "outputFormat": "输出对于一个合法的序列，最大可能的体重值。", "hint": "#### 样例解释\n在这个样例中，如果奶牛 $1$ 先吃，那么奶牛 $2$ 就吃不到派了。然而，先让奶牛 $2$ 吃，然后奶牛 $1$ 只吃编号为 $2$ 的派，仍可以满足条件。\n\n#### 数据范围\n对于测试点 $2-5$，满足 $N \\le 50,M \\le 20$；\n\n对于测试点 $6-9$，满足 $N \\le 50$。\n\n对于全部数据，$1 \\le N \\le 300,1 \\le M \\le \\dfrac{N(N-1)}{2},1 \\le l_i,r_i \\le N,1 \\le w_i \\le 10^6$。\n\nUSACO 2019 December 铂金组 T1", "locale": "zh-CN"}}}
