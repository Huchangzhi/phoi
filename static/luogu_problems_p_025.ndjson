{"pid": "P7326", "type": "P", "difficulty": 5, "samples": [["8\n0 1 ^ 2 3 ! & |\n7\n1 9 1 9 8 1 0", "1111010"], ["23\n0 ! ! 3 0 3 ^ ^ 3 | & 1 ! ^ 2 0 ! 3 ^ ! ^ ! ^\n20\n11 10 4 8 13 7 2 5 11 9 16 15 6 9 7 8 15 0 2 10", "00110011010101011010"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["O2优化", "栈", "位运算", "bitset"], "title": "「MCOI-07」Dream and Evaluation", "background": "", "description": "George 在学位运算。他编了一个位运算表达式，但是他不会高效计算这个表达式的值，于是他找 Dream 帮他计算。  \nGeorge 的表达式有 $64$ 个 01 变量，分别编号为 $0$ 到 $63$。他提供了该表达式的[后缀表示法](https://baike.baidu.com/item/%E5%90%8E%E7%BC%80%E8%A1%A8%E7%A4%BA%E6%B3%95/20835385?fr=aladdin)。  \n后缀表示法里可能含有以下符号：\n\n - $0,1,\\dots,63$，代表对应变量\n - `!&|^`，代表对应位运算\n\n现在 Dream 有 $m$ 个情况。每一个情况固定所有 $64$ 个变量的值。他需要你对每一个情况计算给定表达式的值。  \n为了方便输入，这些情况进行压缩。定义 $a_{i,j}$ 为第 $i$ 情况里的第 $j$ 变量值，其中 $a_{i,j}\\in\\{0,1\\}$；他会给你\n\n$$b_i=\\sum_{j=0}^{63}a_{i,j}2^j$$\n\n可以证明，如果 $0\\le b_i<2^{64}$，则 $b_i$ 唯一对应一组 $a_{i,0},a_{i,1},\\dots,a_{i,63}$。", "inputFormat": "第一行一个正整数 $n$，表示后缀表示法的长度。  \n接下来一行 $n$ 个符号，表示 George 的表达式。  \n接下来一行一个正整数 $m$。  \n接下来一行 $m$ 个整数，依次代表 $b_1,b_2,\\dots,b_m$。", "outputFormat": "输出 $m$ 个 01 字符，其中第 $i$ 输出字符代表第 $i$ 情况时，表达式的值。", "hint": "#### 样例 1 解释\n\n如果 $x=1$，则变量 $0$ 为 $1$，其余变量为 $0$。  \n如果 $x=9$，则仅变量 $0$ 和 $3$ 为 $1$。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n - Subtask 1（7 pts）：$n,m\\le10^3$。  \n - Subtask 2（11 pts）：$b_i\\in[0,2^{8}-1]$。\n - Subtask 3（41 pts）：$n,m\\le5\\times10^4$。\n - Subtask 4（41 pts）：没有额外限制。\n\n对于所有数据，$1\\le n,m\\le10^5$，$0\\le b_i<2^{64}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-07」Dream and Evaluation", "background": "", "description": "George 在学位运算。他编了一个位运算表达式，但是他不会高效计算这个表达式的值，于是他找 Dream 帮他计算。  \nGeorge 的表达式有 $64$ 个 01 变量，分别编号为 $0$ 到 $63$。他提供了该表达式的[后缀表示法](https://baike.baidu.com/item/%E5%90%8E%E7%BC%80%E8%A1%A8%E7%A4%BA%E6%B3%95/20835385?fr=aladdin)。  \n后缀表示法里可能含有以下符号：\n\n - $0,1,\\dots,63$，代表对应变量\n - `!&|^`，代表对应位运算\n\n现在 Dream 有 $m$ 个情况。每一个情况固定所有 $64$ 个变量的值。他需要你对每一个情况计算给定表达式的值。  \n为了方便输入，这些情况进行压缩。定义 $a_{i,j}$ 为第 $i$ 情况里的第 $j$ 变量值，其中 $a_{i,j}\\in\\{0,1\\}$；他会给你\n\n$$b_i=\\sum_{j=0}^{63}a_{i,j}2^j$$\n\n可以证明，如果 $0\\le b_i<2^{64}$，则 $b_i$ 唯一对应一组 $a_{i,0},a_{i,1},\\dots,a_{i,63}$。", "inputFormat": "第一行一个正整数 $n$，表示后缀表示法的长度。  \n接下来一行 $n$ 个符号，表示 George 的表达式。  \n接下来一行一个正整数 $m$。  \n接下来一行 $m$ 个整数，依次代表 $b_1,b_2,\\dots,b_m$。", "outputFormat": "输出 $m$ 个 01 字符，其中第 $i$ 输出字符代表第 $i$ 情况时，表达式的值。", "hint": "#### 样例 1 解释\n\n如果 $x=1$，则变量 $0$ 为 $1$，其余变量为 $0$。  \n如果 $x=9$，则仅变量 $0$ 和 $3$ 为 $1$。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n - Subtask 1（7 pts）：$n,m\\le10^3$。  \n - Subtask 2（11 pts）：$b_i\\in[0,2^{8}-1]$。\n - Subtask 3（41 pts）：$n,m\\le5\\times10^4$。\n - Subtask 4（41 pts）：没有额外限制。\n\n对于所有数据，$1\\le n,m\\le10^5$，$0\\le b_i<2^{64}$。", "locale": "zh-CN"}}}
{"pid": "P7327", "type": "P", "difficulty": 6, "samples": [["2\n1 2", "920000007"], ["3\n1 1 2", "480000004"], ["5\n1 2 1 3 2", "734081639"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["数论", "O2优化", "组合数学", "排列组合", "容斥原理"], "title": "「MCOI-07」Dream and Discs", "background": "**均匀随机** 指对所有可行的结果随机选一个结果，其中所有可行结果等概率被选择。", "description": "Dream 有 $n$ 片音乐盘，编号为 $1$ 到 $n$。所有盘都存恰好一首歌，其中编号为 $i$ 的盘所存储歌由正整数 $a_i$ 表示。$a_i$ 满足 $1\\le a_i\\le n$。  \nDream 打算**均匀随机**选择一个编号区间 $P_1$ 和一个歌曲区间 $S_1$，其中 $P_1\\subseteq [1,n]$，$S_1\\subseteq [1,n]$，并且所有区间端点均为正整数。  \nDream 取完两个区间，他会选择尽量多的盘，使得盘编号在 $P_1$ 里，歌曲在 $S_1$ 里，并且所有歌曲互不相同。他准备把这集音乐盘给 Tommy。  \nDream 构造完集合发现他选了太多音乐盘，决定由以上选区间方法再次**均匀随机**选取两个区间 $P_2$ 和 $S_2$，其中 $P_2\\subseteq P_1$ 并 $S_2\\subseteq S_1$。这次，他构造的音乐盘集需要满足编号在 $P_2$ 里，歌曲在 $S_2$ 里。Dream 仍然会选尽量大，歌曲互不相同的集合。  \n**Dream 永远不会选空区间。**  \n现在 Tommy 感觉 Dream 给他的音乐盘太少了。请帮 Tommy 计算 Dream 第二次选取 **平均** 导致的集合大小减少量。  \n这里，平均对所有合法 $(P_1,S_1,P_2,S_2)$ 选取方案等权重平均。", "inputFormat": "第一行一个正整数 $n$。  \n第二行 $n$ 个正整数，依次表示 $a_1,a_2,\\dots,a_n$。", "outputFormat": "假设答案可以表示为 $p/q$，其中 $p$ 和 $q$ 互质。请输出 $p\\cdot q^{-1}\\pmod{10^9+7}$。", "hint": "#### 样例 1 解释\n\n - $P_1=[1,1],S_1=[1,1]$\n   - $P_2=[1,1],S_2=[1,1],\\Delta=1-1=0$\n - $P_1=[1,1],S_1=[1,2]$\n   - $P_2=[1,1],S_2=[1,1],\\Delta=1-1=0$\n   - $P_2=[1,1],S_2=[1,2],\\Delta=1-1=0$\n   - $P_2=[1,1],S_2=[2,2],\\Delta=1-0=1$\n - $P_1=[1,1],S_1=[2,2]$\n   - $P_2=[1,1],S_2=[2,2],\\Delta=0-0=0$\n - $P_1=[1,2],S_1=[1,1]$\n   - $P_2=[1,1],S_2=[1,1],\\Delta=1-1=0$\n   - $P_2=[1,2],S_2=[1,1],\\Delta=1-1=0$\n   - $P_2=[2,2],S_2=[1,1],\\Delta=1-0=1$\n - $P_1=[1,2],S_1=[1,2]$\n   - $P_2=[1,1],S_2=[1,1],\\Delta=2-1=1$\n   - $P_2=[1,1],S_2=[1,2],\\Delta=2-1=1$\n   - $P_2=[1,1],S_2=[2,2],\\Delta=2-0=2$\n   - $P_2=[1,2],S_2=[1,1],\\Delta=2-1=1$\n   - $P_2=[1,2],S_2=[1,2],\\Delta=2-2=0$\n   - $P_2=[1,2],S_2=[2,2],\\Delta=2-1=1$\n   - $P_2=[2,2],S_2=[1,1],\\Delta=2-0=2$\n   - $P_2=[2,2],S_2=[1,2],\\Delta=2-1=1$\n   - $P_2=[2,2],S_2=[2,2],\\Delta=2-1=1$\n - $P_1=[1,2],S_1=[2,2]$\n   - $P_2=[1,1],S_2=[2,2],\\Delta=1-0=1$\n   - $P_2=[1,2],S_2=[2,2],\\Delta=1-1=0$\n   - $P_2=[2,2],S_2=[2,2],\\Delta=1-1=0$\n - $P_1=[2,2],S_1=[1,1]$\n   - $P_2=[2,2],S_2=[1,1],\\Delta=0-0=0$\n - $P_1=[2,2],S_1=[1,2]$\n   - $P_2=[2,2],S_2=[1,1],\\Delta=1-0=1$\n   - $P_2=[2,2],S_2=[1,2],\\Delta=1-1=0$\n   - $P_2=[2,2],S_2=[2,2],\\Delta=1-1=0$\n - $P_1=[2,2],S_1=[2,2]$\n   - $P_2=[2,2],S_2=[2,2],\\Delta=1-1=0$\n\n总共有 $25$ 方案，所有方案减量之和为 $14$，于是答案等于 $14/25$。\n\n#### 样例 2 解释\n\n答案为 $144/225$。\n\n#### 样例 3 解释\n\n答案为 $5921/4900$。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n - Subtask 1（11 pts）：$n\\le8$。\n - Subtask 2（17 pts）：$n\\le64$。\n - Subtask 3（19 pts）：$n\\le1024$。\n - Subtask 4（7 pts）：$a_i\\le 10$。\n - Subtask 5（23 pts）：$n\\le10^5$。\n - Subtask 6（23 pts）：无特殊限制。  \n\n对于所有数据，$1\\le n\\le5\\cdot10^5,1\\le a_i\\le n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-07」Dream and Discs", "background": "**均匀随机** 指对所有可行的结果随机选一个结果，其中所有可行结果等概率被选择。", "description": "Dream 有 $n$ 片音乐盘，编号为 $1$ 到 $n$。所有盘都存恰好一首歌，其中编号为 $i$ 的盘所存储歌由正整数 $a_i$ 表示。$a_i$ 满足 $1\\le a_i\\le n$。  \nDream 打算**均匀随机**选择一个编号区间 $P_1$ 和一个歌曲区间 $S_1$，其中 $P_1\\subseteq [1,n]$，$S_1\\subseteq [1,n]$，并且所有区间端点均为正整数。  \nDream 取完两个区间，他会选择尽量多的盘，使得盘编号在 $P_1$ 里，歌曲在 $S_1$ 里，并且所有歌曲互不相同。他准备把这集音乐盘给 Tommy。  \nDream 构造完集合发现他选了太多音乐盘，决定由以上选区间方法再次**均匀随机**选取两个区间 $P_2$ 和 $S_2$，其中 $P_2\\subseteq P_1$ 并 $S_2\\subseteq S_1$。这次，他构造的音乐盘集需要满足编号在 $P_2$ 里，歌曲在 $S_2$ 里。Dream 仍然会选尽量大，歌曲互不相同的集合。  \n**Dream 永远不会选空区间。**  \n现在 Tommy 感觉 Dream 给他的音乐盘太少了。请帮 Tommy 计算 Dream 第二次选取 **平均** 导致的集合大小减少量。  \n这里，平均对所有合法 $(P_1,S_1,P_2,S_2)$ 选取方案等权重平均。", "inputFormat": "第一行一个正整数 $n$。  \n第二行 $n$ 个正整数，依次表示 $a_1,a_2,\\dots,a_n$。", "outputFormat": "假设答案可以表示为 $p/q$，其中 $p$ 和 $q$ 互质。请输出 $p\\cdot q^{-1}\\pmod{10^9+7}$。", "hint": "#### 样例 1 解释\n\n - $P_1=[1,1],S_1=[1,1]$\n   - $P_2=[1,1],S_2=[1,1],\\Delta=1-1=0$\n - $P_1=[1,1],S_1=[1,2]$\n   - $P_2=[1,1],S_2=[1,1],\\Delta=1-1=0$\n   - $P_2=[1,1],S_2=[1,2],\\Delta=1-1=0$\n   - $P_2=[1,1],S_2=[2,2],\\Delta=1-0=1$\n - $P_1=[1,1],S_1=[2,2]$\n   - $P_2=[1,1],S_2=[2,2],\\Delta=0-0=0$\n - $P_1=[1,2],S_1=[1,1]$\n   - $P_2=[1,1],S_2=[1,1],\\Delta=1-1=0$\n   - $P_2=[1,2],S_2=[1,1],\\Delta=1-1=0$\n   - $P_2=[2,2],S_2=[1,1],\\Delta=1-0=1$\n - $P_1=[1,2],S_1=[1,2]$\n   - $P_2=[1,1],S_2=[1,1],\\Delta=2-1=1$\n   - $P_2=[1,1],S_2=[1,2],\\Delta=2-1=1$\n   - $P_2=[1,1],S_2=[2,2],\\Delta=2-0=2$\n   - $P_2=[1,2],S_2=[1,1],\\Delta=2-1=1$\n   - $P_2=[1,2],S_2=[1,2],\\Delta=2-2=0$\n   - $P_2=[1,2],S_2=[2,2],\\Delta=2-1=1$\n   - $P_2=[2,2],S_2=[1,1],\\Delta=2-0=2$\n   - $P_2=[2,2],S_2=[1,2],\\Delta=2-1=1$\n   - $P_2=[2,2],S_2=[2,2],\\Delta=2-1=1$\n - $P_1=[1,2],S_1=[2,2]$\n   - $P_2=[1,1],S_2=[2,2],\\Delta=1-0=1$\n   - $P_2=[1,2],S_2=[2,2],\\Delta=1-1=0$\n   - $P_2=[2,2],S_2=[2,2],\\Delta=1-1=0$\n - $P_1=[2,2],S_1=[1,1]$\n   - $P_2=[2,2],S_2=[1,1],\\Delta=0-0=0$\n - $P_1=[2,2],S_1=[1,2]$\n   - $P_2=[2,2],S_2=[1,1],\\Delta=1-0=1$\n   - $P_2=[2,2],S_2=[1,2],\\Delta=1-1=0$\n   - $P_2=[2,2],S_2=[2,2],\\Delta=1-1=0$\n - $P_1=[2,2],S_1=[2,2]$\n   - $P_2=[2,2],S_2=[2,2],\\Delta=1-1=0$\n\n总共有 $25$ 方案，所有方案减量之和为 $14$，于是答案等于 $14/25$。\n\n#### 样例 2 解释\n\n答案为 $144/225$。\n\n#### 样例 3 解释\n\n答案为 $5921/4900$。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n - Subtask 1（11 pts）：$n\\le8$。\n - Subtask 2（17 pts）：$n\\le64$。\n - Subtask 3（19 pts）：$n\\le1024$。\n - Subtask 4（7 pts）：$a_i\\le 10$。\n - Subtask 5（23 pts）：$n\\le10^5$。\n - Subtask 6（23 pts）：无特殊限制。  \n\n对于所有数据，$1\\le n\\le5\\cdot10^5,1\\le a_i\\le n$。", "locale": "zh-CN"}}}
{"pid": "P7328", "type": "P", "difficulty": 6, "samples": [["3 8 3\n108 75\n616 36\n220 16\n37 66\n114 64\n514 24\n1919 65\n810 33\n19260817\n123456789\n23333333\n", "3\n79\n49"], ["请见附件 sample.in", "请见附件 sample.out"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["O2优化"], "title": "「MCOI-07」Dream and Machine Learning", "background": "", "description": "Dream 构造了一个红石计算机来验证 $b^e\\equiv r\\pmod m$ 形式的公式。  \nDream 固定了 $b$ 和 $m$ 并且构造了 $n$ 对满足以上条件的 $(e,r)$ 正整数对。  \n可惜，Dream 忘记了 $m$ 的具体值。现在他给了你 $b$ 和这 $n$ 对数。请替代 Dream 的计算机，回答 $q$ 组 $b^{a_i}\\pmod m$ 形式的询问。", "inputFormat": "第一行三个正整数，分别代表 $b$，$n$，和 $q$。  \n接下来 $n$ 行，每行两个正整数，分别代表一对 $e$ 和 $r$。  \n接下来 $q$ 行，每行一个正整数，代表一个 $a_i$。", "outputFormat": "输出 $q$ 行，对应询问的答案。", "hint": "#### 样例 1 解释\n\n可以唯一确定 $m=97$。  \n样例 1 仅仅说明题意，并不代表任何 subtask 的任何测试点。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n - Subtask 1（5 pts）：$m\\le10^3$\n - Subtask 2（19 pts）：$m\\le10^9$\n - Subtask 3（19 pts）：$m\\le10^{19}$\n - Subtask 4（19 pts）：$m\\le10^{29}$\n - Subtask 5（19 pts）：$m\\le10^{99}$\n - Subtask 6（19 pts）：$m\\le10^{199}$\n\n对于 $100\\%$ 的数据，$b\\in\\{2,3\\}$，$1\\le q\\le100$，$2\\le e,a_i\\le 10^9$，$n=10^5$。  \n**保证** $m$ 为质数。  \n**保证** 所有 $e$ 互不相同。  \n**保证** 数据随机。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-07」Dream and Machine Learning", "background": "", "description": "Dream 构造了一个红石计算机来验证 $b^e\\equiv r\\pmod m$ 形式的公式。  \nDream 固定了 $b$ 和 $m$ 并且构造了 $n$ 对满足以上条件的 $(e,r)$ 正整数对。  \n可惜，Dream 忘记了 $m$ 的具体值。现在他给了你 $b$ 和这 $n$ 对数。请替代 Dream 的计算机，回答 $q$ 组 $b^{a_i}\\pmod m$ 形式的询问。", "inputFormat": "第一行三个正整数，分别代表 $b$，$n$，和 $q$。  \n接下来 $n$ 行，每行两个正整数，分别代表一对 $e$ 和 $r$。  \n接下来 $q$ 行，每行一个正整数，代表一个 $a_i$。", "outputFormat": "输出 $q$ 行，对应询问的答案。", "hint": "#### 样例 1 解释\n\n可以唯一确定 $m=97$。  \n样例 1 仅仅说明题意，并不代表任何 subtask 的任何测试点。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n - Subtask 1（5 pts）：$m\\le10^3$\n - Subtask 2（19 pts）：$m\\le10^9$\n - Subtask 3（19 pts）：$m\\le10^{19}$\n - Subtask 4（19 pts）：$m\\le10^{29}$\n - Subtask 5（19 pts）：$m\\le10^{99}$\n - Subtask 6（19 pts）：$m\\le10^{199}$\n\n对于 $100\\%$ 的数据，$b\\in\\{2,3\\}$，$1\\le q\\le100$，$2\\le e,a_i\\le 10^9$，$n=10^5$。  \n**保证** $m$ 为质数。  \n**保证** 所有 $e$ 互不相同。  \n**保证** 数据随机。", "locale": "zh-CN"}}}
{"pid": "P7329", "type": "P", "difficulty": 6, "samples": [["2 2 2 22\n\n222", "\n? 2 2\n\n! 2 2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["交互题", "Special Judge", "O2优化"], "title": "「MCOI-07」Dream and More Discs", "background": "**本题为 IO 交互题。**", "description": "Dream 将 Tommy 的所有音乐盘分为 $n$ 类，其中第 $i$ 类有 $2^m-1$ 片音乐盘。所有盘都有一个唯一的正整数重要度。  \n现在 Dream 已经把所有类之内的音乐盘按照重要度递增排序。Dream 想知道**所有**盘中重要度第 $k$ 小是哪个盘。\n\n由于音乐盘数量实在太多，Dream 不能直接给你所有音乐盘的重要度。在寻找答案时，Dream 允许你访问第 $i$ 类重要度第 $j$ 小的盘重要度值。", "inputFormat": "交互开始时，评测机输入第一行为四个正整数 $n$，$m$，$k$，和 $Th$，其中 $Th$ 为最多应用访问次数。  \n每一次访问，评测机会回复所访问位置的音乐盘重要度。", "outputFormat": "你的程序可以进行两个操作：\n\n 1. `? i j`，表示访问第 $i$ 类型第 $j$ 小音乐盘重要度。评测机会回复这位置重要度。\n 2. `! i j`，表示报告全局第 $k$ 小音乐盘为第 $i$ 类的第 $j$ 小音乐盘。", "hint": "#### 样例 1 解释\n\nDream 的音乐盘重要度为 $[[2222,22222,222222],[22,222,2222222]]$。  \n第 2 类型为 $[22,222]$；第 2 类型的第 2 小重要度为 $222$。  \n全局第 2 小重要度也是这音乐盘。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n|  Subtask | 分值 | $n$ | $m$ | $k$ | $Th$ |\n| ----------- | ----------- | ----------- | ----------- | ----------- | ----------- |\n| 1 | 1 pts | $1$ | $1$| $1$| $15,000$ |\n| 2 | 9 pts | $50$ | $8$ | 无 | $15,000$ |\n| 3 | 19 pts | $20$ | $11$ | 无 | $15,000$ |\n| 4 | 17 pts | $50$ | $11$ | 无 | $6,666$ |\n| 5 | 23 pts | $50$ | $11$ | 无 | $2,333$ |\n| 6 | 31 pts | $50$ | $11$ | 无 | $1,111$ |\n\n对于所有数据，$1\\le k\\le n(2^m-1)$，所有音乐盘的重要度互不相同并且小于等于 $10^{18}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-07」Dream and More Discs", "background": "**本题为 IO 交互题。**", "description": "Dream 将 Tommy 的所有音乐盘分为 $n$ 类，其中第 $i$ 类有 $2^m-1$ 片音乐盘。所有盘都有一个唯一的正整数重要度。  \n现在 Dream 已经把所有类之内的音乐盘按照重要度递增排序。Dream 想知道**所有**盘中重要度第 $k$ 小是哪个盘。\n\n由于音乐盘数量实在太多，Dream 不能直接给你所有音乐盘的重要度。在寻找答案时，Dream 允许你访问第 $i$ 类重要度第 $j$ 小的盘重要度值。", "inputFormat": "交互开始时，评测机输入第一行为四个正整数 $n$，$m$，$k$，和 $Th$，其中 $Th$ 为最多应用访问次数。  \n每一次访问，评测机会回复所访问位置的音乐盘重要度。", "outputFormat": "你的程序可以进行两个操作：\n\n 1. `? i j`，表示访问第 $i$ 类型第 $j$ 小音乐盘重要度。评测机会回复这位置重要度。\n 2. `! i j`，表示报告全局第 $k$ 小音乐盘为第 $i$ 类的第 $j$ 小音乐盘。", "hint": "#### 样例 1 解释\n\nDream 的音乐盘重要度为 $[[2222,22222,222222],[22,222,2222222]]$。  \n第 2 类型为 $[22,222]$；第 2 类型的第 2 小重要度为 $222$。  \n全局第 2 小重要度也是这音乐盘。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n|  Subtask | 分值 | $n$ | $m$ | $k$ | $Th$ |\n| ----------- | ----------- | ----------- | ----------- | ----------- | ----------- |\n| 1 | 1 pts | $1$ | $1$| $1$| $15,000$ |\n| 2 | 9 pts | $50$ | $8$ | 无 | $15,000$ |\n| 3 | 19 pts | $20$ | $11$ | 无 | $15,000$ |\n| 4 | 17 pts | $50$ | $11$ | 无 | $6,666$ |\n| 5 | 23 pts | $50$ | $11$ | 无 | $2,333$ |\n| 6 | 31 pts | $50$ | $11$ | 无 | $1,111$ |\n\n对于所有数据，$1\\le k\\le n(2^m-1)$，所有音乐盘的重要度互不相同并且小于等于 $10^{18}$。", "locale": "zh-CN"}}}
{"pid": "P7330", "type": "P", "difficulty": 7, "samples": [["3 3\n2 0\n1 1 108616\n2 114514", "15\n>\n>\n>\n+ 0 1\n+ 3 2\n< 4\nS 108616\nS 716372446\n* 1 6\n* 8 7\n* 7 7\n* 2 10\n+ 0 9\n+ 12 11\n< 13"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["Special Judge", "O2优化"], "title": "「MCOI-07」Dream Fourier Transform", "background": "Dream 的红石计算机升级为 Dream 平台了。  \n一个“Dream 程序”为一个在 Dream 平台下执行的程序。  \nDream 平台的内存由 $5\\times2^{17}$ 个非负整数构成，这些内存位置依次标号为 $0,1,\\dots,5\\times2^{17}-1$。初始所有内存位置均为 $0$。  \nDream 平台有一个特性：第 $x$ 运算的结果在第 $x$ 内存位置存储，其中运算从 $0$ 编号。  \nDream 程序为若干运算的有序序列，运算类型为：\n\n 1. `>`，表示输入一个非负整数，结果为输入值。\n 2. `< x`，表示输出内存位置 `x` 所含的值，结果为这个值。\n 3. `S c`，表示结果为常量非负整数 $c$，其中 $0\\le c<998244353$。\n 4. `+ x y`，表示结果为内存位置 `x` 的值 加 内存位置 `y` 的值。\n 5. `- x y`，表示结果为内存位置 `x` 的值 减 内存位置 `y` 的值。\n 6. `* x y`，表示结果为内存位置 `x` 的值 乘 内存位置 `y` 的值。\n\n其中所有运算在模 $998244353$ 意义下计算。", "description": "Dream 有一个长度为 $n$ 的序列 $a_0,a_1,\\dots,a_{n-1}$。  \n\nDream 要支持两个操作：\n\n 1. `1 i x`，表示将 $a_i$ 乘 $x$。\n 2. `2 k`，表示定 $x=63912897^k$，并且求\n\n$$\\sum_{i=0}^{n-1}a_ix^i\\pmod{998244353}$$\n\n---\n\n由战争及时，Dream 无法提供序列 $a$。他只能预测他会进行的操作。请构造一个“Dream 程序”，读入数组 $a$ 并且输出对应询问答案。  ", "inputFormat": "第一行两个正整数，分别代表 $n$ 和 $q$。  \n接下来 $q$ 行，每行描述一个操作，由 `1 i x` 或 `2 k` 格式表示。", "outputFormat": "第一行一个非负整数 $L$，代表所构造的 Dream 程序长度。  \n接下来 $L$ 行，每行描述一个运算。  \n你需要保证 $L\\le5\\times2^{17}$。", "hint": "#### 温情提示\n\n$$63912897\\equiv3^{\\frac{998244352}{2^{12}}}\\pmod{998244353}$$\n\n#### 样例解释\n\n当 Dream 程序输入为序列 `[1,2,3]`，输出为序列 `[6,347675984]`，符合要求。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n - Subtask 1（11 pts）：$n,q\\le2^8$\n - Subtask 2（19 pts）：所有询问操作在修改操作后面。\n - Subtask 3（23 pts）：$n,q\\le2^{10}$\n - Subtask 4（47 pts）：没有特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le n,q\\le2^{12}$，$0\\le i<n$，$0\\le x,k<998244353$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-07」Dream Fourier Transform", "background": "Dream 的红石计算机升级为 Dream 平台了。  \n一个“Dream 程序”为一个在 Dream 平台下执行的程序。  \nDream 平台的内存由 $5\\times2^{17}$ 个非负整数构成，这些内存位置依次标号为 $0,1,\\dots,5\\times2^{17}-1$。初始所有内存位置均为 $0$。  \nDream 平台有一个特性：第 $x$ 运算的结果在第 $x$ 内存位置存储，其中运算从 $0$ 编号。  \nDream 程序为若干运算的有序序列，运算类型为：\n\n 1. `>`，表示输入一个非负整数，结果为输入值。\n 2. `< x`，表示输出内存位置 `x` 所含的值，结果为这个值。\n 3. `S c`，表示结果为常量非负整数 $c$，其中 $0\\le c<998244353$。\n 4. `+ x y`，表示结果为内存位置 `x` 的值 加 内存位置 `y` 的值。\n 5. `- x y`，表示结果为内存位置 `x` 的值 减 内存位置 `y` 的值。\n 6. `* x y`，表示结果为内存位置 `x` 的值 乘 内存位置 `y` 的值。\n\n其中所有运算在模 $998244353$ 意义下计算。", "description": "Dream 有一个长度为 $n$ 的序列 $a_0,a_1,\\dots,a_{n-1}$。  \n\nDream 要支持两个操作：\n\n 1. `1 i x`，表示将 $a_i$ 乘 $x$。\n 2. `2 k`，表示定 $x=63912897^k$，并且求\n\n$$\\sum_{i=0}^{n-1}a_ix^i\\pmod{998244353}$$\n\n---\n\n由战争及时，Dream 无法提供序列 $a$。他只能预测他会进行的操作。请构造一个“Dream 程序”，读入数组 $a$ 并且输出对应询问答案。  ", "inputFormat": "第一行两个正整数，分别代表 $n$ 和 $q$。  \n接下来 $q$ 行，每行描述一个操作，由 `1 i x` 或 `2 k` 格式表示。", "outputFormat": "第一行一个非负整数 $L$，代表所构造的 Dream 程序长度。  \n接下来 $L$ 行，每行描述一个运算。  \n你需要保证 $L\\le5\\times2^{17}$。", "hint": "#### 温情提示\n\n$$63912897\\equiv3^{\\frac{998244352}{2^{12}}}\\pmod{998244353}$$\n\n#### 样例解释\n\n当 Dream 程序输入为序列 `[1,2,3]`，输出为序列 `[6,347675984]`，符合要求。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n - Subtask 1（11 pts）：$n,q\\le2^8$\n - Subtask 2（19 pts）：所有询问操作在修改操作后面。\n - Subtask 3（23 pts）：$n,q\\le2^{10}$\n - Subtask 4（47 pts）：没有特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le n,q\\le2^{12}$，$0\\le i<n$，$0\\le x,k<998244353$。", "locale": "zh-CN"}}}
{"pid": "P7331", "type": "P", "difficulty": 7, "samples": [["8 2\n1 2 5 1 4 3 3\n2 4\n4 7\n3\n4 6\n5 7\n1 8", "2\n2\n18"]], "limits": {"time": [7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000], "memory": [386048, 386048, 386048, 386048, 386048, 386048, 386048, 386048, 386048, 386048, 386048, 386048, 386048, 386048, 386048, 386048, 386048, 386048, 386048, 386048, 386048, 386048]}, "tags": ["O2优化"], "title": "Dream and the Multiverse REMATCH", "background": "[Link](https://youtu.be/tylNqtyj0gs?t=2388)\n\n*I have gone over the scenarios in my head,*\n\n*and there are 6.96969 billion outcomes, and only one of them -*\n\n*- do I win.*", "description": "Dream abstracts the fabric of spacetime as a directed rooted tree (arborescence) with $N$ nodes (numbered $1$ through $N$). Node $1$ is the root and for each $i$ ($1 \\le i \\le N-1$), the parent of node $i+1$ is $f_i$. All edges of this tree are directed away from the root.\n\nThen, Dream employs a magical superpower and adds $M$ directed edges to this tree in such a way that the resulting directed graph remains acyclic (a DAG).\n\nLet's call a node of this DAG an *event* and further call a simple path on this DAG an *era*. Dream considers a pair of events $(i,j)$ to be *plausible* if there is an era whose first event is $i$ and last event is $j$. Note that $i \\lt j$ does not have to hold for a plausible pair.\n\nDream now wants you to answer $Q$ queries. In each query, he gives you two positive integers $l$ and $r$, where $l \\leq r$, and he wishes to know the number of plausible pairs of events $(i,j)$ such that $l \\leq i \\lt j \\leq r$.", "inputFormat": "The first line of the input contains two space-separated integers $N$ and $M$.\n\nThe second line contains $N-1$ space-separated integers $f_1, f_2, \\ldots, f_{N-1}$.\n\n$M$ lines follow. Each of these lines contains two space-separated integers $u$ and $v$ describing an additional edge from node $u$ to node $v$.\n\nThe following line contains a single integer $Q$.\n\n$Q$ lines follow. Each of these lines contains two space-separated integers $l$ and $r$ describing a query.", "outputFormat": "For each query, print a single line containing one integer ― the number of plausible pairs $(i,j)$ such that $l \\leq i \\lt j \\leq r$.", "hint": " - $2 \\leq N \\leq 7 \\cdot 10^5$\n - $1 \\leq Q \\leq 7 \\cdot 10^5$\n - $0 \\leq M \\leq 20$\n - $1 \\le f_i \\le N$ for each valid $i$\n - $1 \\le u, v \\le N$\n - the graph described on the input is acyclic\n - $1 \\le l \\le r \\le N$\n\n### Subtasks\n\n**Subtask #1 (17 points):** $N,Q\\le3\\cdot 10^5$\n\n**Subtask #2 (83 points):** original constraints\n", "locale": "en", "translations": {"en": {"title": "Dream and the Multiverse REMATCH", "background": "[Link](https://youtu.be/tylNqtyj0gs?t=2388)\n\n*I have gone over the scenarios in my head,*\n\n*and there are 6.96969 billion outcomes, and only one of them -*\n\n*- do I win.*", "description": "Dream abstracts the fabric of spacetime as a directed rooted tree (arborescence) with $N$ nodes (numbered $1$ through $N$). Node $1$ is the root and for each $i$ ($1 \\le i \\le N-1$), the parent of node $i+1$ is $f_i$. All edges of this tree are directed away from the root.\n\nThen, Dream employs a magical superpower and adds $M$ directed edges to this tree in such a way that the resulting directed graph remains acyclic (a DAG).\n\nLet's call a node of this DAG an *event* and further call a simple path on this DAG an *era*. Dream considers a pair of events $(i,j)$ to be *plausible* if there is an era whose first event is $i$ and last event is $j$. Note that $i \\lt j$ does not have to hold for a plausible pair.\n\nDream now wants you to answer $Q$ queries. In each query, he gives you two positive integers $l$ and $r$, where $l \\leq r$, and he wishes to know the number of plausible pairs of events $(i,j)$ such that $l \\leq i \\lt j \\leq r$.", "inputFormat": "The first line of the input contains two space-separated integers $N$ and $M$.\n\nThe second line contains $N-1$ space-separated integers $f_1, f_2, \\ldots, f_{N-1}$.\n\n$M$ lines follow. Each of these lines contains two space-separated integers $u$ and $v$ describing an additional edge from node $u$ to node $v$.\n\nThe following line contains a single integer $Q$.\n\n$Q$ lines follow. Each of these lines contains two space-separated integers $l$ and $r$ describing a query.", "outputFormat": "For each query, print a single line containing one integer ― the number of plausible pairs $(i,j)$ such that $l \\leq i \\lt j \\leq r$.", "hint": " - $2 \\leq N \\leq 7 \\cdot 10^5$\n - $1 \\leq Q \\leq 7 \\cdot 10^5$\n - $0 \\leq M \\leq 20$\n - $1 \\le f_i \\le N$ for each valid $i$\n - $1 \\le u, v \\le N$\n - the graph described on the input is acyclic\n - $1 \\le l \\le r \\le N$\n\n### Subtasks\n\n**Subtask #1 (17 points):** $N,Q\\le3\\cdot 10^5$\n\n**Subtask #2 (83 points):** original constraints\n", "locale": "en"}, "zh-CN": {"title": "Dream and the Multiverse REMATCH", "background": "", "description": "Dream 将时空的结构抽象为一个有 $N$ 个节点（编号为 $1$ 到 $N$）的有向根树（树形结构）。节点 $1$ 是根节点，对于每个 $i$（$1 \\le i \\le N-1$），节点 $i+1$ 的父节点是 $f_i$。这棵树的所有边都是从根节点指向外部的。\n\n然后，Dream 使用一种神奇的超能力，向这棵树中添加了 $M$ 条有向边，使得结果图仍然是无环的（有向无环图，DAG）。\n\n我们称这个 DAG 的一个节点为一个*事件*，并进一步称这个 DAG 上的一条简单路径为一个*时代*。Dream 认为一对事件 $(i,j)$ 是*可能的*，如果存在一个时代，其第一个事件是 $i$，最后一个事件是 $j$。注意，对于一个可能的对，$i < j$ 并不一定成立。\n\nDream 现在希望你回答 $Q$ 个查询。在每个查询中，他给你两个正整数 $l$ 和 $r$，其中 $l \\leq r$，他希望知道有多少对可能的事件 $(i,j)$ 满足 $l \\leq i < j \\leq r$。", "inputFormat": "输入的第一行包含两个空格分隔的整数 $N$ 和 $M$。\n\n第二行包含 $N-1$ 个空格分隔的整数 $f_1, f_2, \\ldots, f_{N-1}$。\n\n接下来的 $M$ 行中，每行包含两个空格分隔的整数 $u$ 和 $v$，描述了一条从节点 $u$ 到节点 $v$ 的额外边。\n\n接下来的行包含一个整数 $Q$。\n\n接下来的 $Q$ 行中，每行包含两个空格分隔的整数 $l$ 和 $r$，描述了一个查询。", "outputFormat": "对于每个查询，输出一行，包含一个整数——满足 $l \\leq i < j \\leq r$ 的可能事件对 $(i,j)$ 的数量。", "hint": "- $2 \\leq N \\leq 7 \\cdot 10^5$\n- $1 \\leq Q \\leq 7 \\cdot 10^5$\n- $0 \\leq M \\leq 20$\n- 对于每个有效的 $i$，$1 \\le f_i \\le N$\n- $1 \\le u, v \\le N$\n- 输入描述的图是无环的\n- $1 \\le l \\le r \\le N$\n\n### 子任务\n\n**子任务 #1 (17 分):** $N,Q \\le 3 \\cdot 10^5$\n\n**子任务 #2 (83 分):** 原始约束条件。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P7333", "type": "P", "difficulty": 4, "samples": [["3\n1 2 3\n3 2 1", "1 1 1"], ["5\n5 4 3 5 6\n7 6 5 4 3", "-1 2 1 1 1"], ["5\n1 1 2 1 1\n2 2 2 2 2", "2 1 -1 1 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["二分", "2021", "洛谷原创", "分块", "ST 表"], "title": "[JRKSJ R1] JFCA", "background": "", "description": "给出一个环，上面有 $n$ 个点，每个相邻的点对之间的距离为 $1$。\n\n每个点有两个属性 $a_i$ 和 $b_i$，对于点 $i$，定义 $f_i$ 为它与满足 $i\\ne j$ 且 $a_j\\ge b_i$ 的 $j$ 与 $i$ 在环上的最短距离。特殊地，如果没有满足条件的 $j$，其 $f_i=-1$。", "inputFormat": "输入共 $3$ 行。\\\n第 $1$ 行 $1$ 个整数 $n$ 。\\\n第 $2$ 行 $n$ 个整数，其中第 $i$ 个表示 $a_i$，意义同上。\\\n第 $3$ 行 $n$ 个整数，其中第 $i$ 个表示 $b_i$，意义同上。", "outputFormat": "输出 $1$ 行 $n$ 个整数，其中第 $i$ 个表示 $f_i$，意义同上。", "hint": "### 数据规模与约定\n\n对于 $20\\%$ 的数据，$1\\le n \\le 10^3$；\\\n对于 $100\\%$ 的数据，$1\\le n \\le 10^5$，$1\\le a_i,b_i\\le 10^9$。\n\n我们对于测试点 $4$ 至 $11$ 采用捆绑测试。\n\n### 样例 1 解释\n对于 $i=1$，$a_3=3= b_1=3$, $1$ 和 $3$ 的距离是 $1$，所以 $f_1=1$。\\\n对于 $i=2$，$a_3=3> b_2=2$, $2$ 和 $3$ 的距离是 $1$，所以 $f_2=1$。\\\n对于 $i=3$，$a_2=2> b_3=1$, $2$ 和 $3$ 的距离是 $1$，所以 $f_3=1$。\n\n$\\text{Upd 2021.3.30}$：增加一组 hack 数据。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JRKSJ R1] JFCA", "background": "", "description": "给出一个环，上面有 $n$ 个点，每个相邻的点对之间的距离为 $1$。\n\n每个点有两个属性 $a_i$ 和 $b_i$，对于点 $i$，定义 $f_i$ 为它与满足 $i\\ne j$ 且 $a_j\\ge b_i$ 的 $j$ 与 $i$ 在环上的最短距离。特殊地，如果没有满足条件的 $j$，其 $f_i=-1$。", "inputFormat": "输入共 $3$ 行。\\\n第 $1$ 行 $1$ 个整数 $n$ 。\\\n第 $2$ 行 $n$ 个整数，其中第 $i$ 个表示 $a_i$，意义同上。\\\n第 $3$ 行 $n$ 个整数，其中第 $i$ 个表示 $b_i$，意义同上。", "outputFormat": "输出 $1$ 行 $n$ 个整数，其中第 $i$ 个表示 $f_i$，意义同上。", "hint": "### 数据规模与约定\n\n对于 $20\\%$ 的数据，$1\\le n \\le 10^3$；\\\n对于 $100\\%$ 的数据，$1\\le n \\le 10^5$，$1\\le a_i,b_i\\le 10^9$。\n\n我们对于测试点 $4$ 至 $11$ 采用捆绑测试。\n\n### 样例 1 解释\n对于 $i=1$，$a_3=3= b_1=3$, $1$ 和 $3$ 的距离是 $1$，所以 $f_1=1$。\\\n对于 $i=2$，$a_3=3> b_2=2$, $2$ 和 $3$ 的距离是 $1$，所以 $f_2=1$。\\\n对于 $i=3$，$a_2=2> b_3=1$, $2$ 和 $3$ 的距离是 $1$，所以 $f_3=1$。\n\n$\\text{Upd 2021.3.30}$：增加一组 hack 数据。\n", "locale": "zh-CN"}}}
{"pid": "P7334", "type": "P", "difficulty": 5, "samples": [["1 1\n1\n1 1 1", "1"], ["4 2\n1 2 3 4\n1 2 4\n2 1 4", "7"], ["5 5\n10 8 10 11 12\n2 1 5\n1 1 5\n1 1 4\n2 4 5\n1 1 5", "18"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["线段树", "2021", "洛谷原创", "O2优化", "分块", "欧拉降幂"], "title": "[JRKSJ R1] 吊打", "background": "", "description": "给出一个长为 $n$ 的正整数序列 $a_{1\\sim n}$。接下来有两种操作共 $m$ 次：\n- `1 l r`，表示将 $a_{l\\sim r}$ 开方并下取整，即令 $\\forall i\\in [l,r],a_i\\gets\\lfloor\\sqrt{a_i}\\rfloor$；\n- `2 l r`，表示将 $a_{l\\sim r}$ 平方，即令 $\\forall i\\in [l,r],a_i\\gets a_i^2$。\n\n在所有操作结束后，请你输出 $\\displaystyle\\sum_{i=1}^na_i$。\n\n由于答案可能很大，你只需要输出其对 $998244353$ 取模的结果即可。", "inputFormat": "输入共 $m+2$ 行。\n\n第一行输入两个正整数 $n,m$。\n\n第二行输入 $n$ 个正整数 $a_{1\\sim n}$。\n\n接下来 $m$ 行，每行 $3$ 个正整数表示一次操作。", "outputFormat": "输出一行一个整数表示答案对 $998244353$ 取模的结果。", "hint": "### 数据规模与约定\n\n| 测试点 | 特殊限制 |\n| :----------: | :----------: |\n| $1$ | $n,m\\le 10$ |\n| $2$ | 保证一次 `1 l r` 操作上一步是 `2 l r` |\n| $3$ | 保证只有 `1` 操作 |\n| $4$ | 保证只有 `2` 操作 |\n| $5$ | 保证所有的 $l=1$，$r=n$ |\n| $6$ | $n,m\\le 10^3$ |\n| $7\\sim 20$ | 无特殊限制 |\n\n\n对于所有数据，保证 $1\\le n,m\\le2\\times10^5$，$1\\le a_i\\le 10^9$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JRKSJ R1] 吊打", "background": "", "description": "给出一个长为 $n$ 的正整数序列 $a_{1\\sim n}$。接下来有两种操作共 $m$ 次：\n- `1 l r`，表示将 $a_{l\\sim r}$ 开方并下取整，即令 $\\forall i\\in [l,r],a_i\\gets\\lfloor\\sqrt{a_i}\\rfloor$；\n- `2 l r`，表示将 $a_{l\\sim r}$ 平方，即令 $\\forall i\\in [l,r],a_i\\gets a_i^2$。\n\n在所有操作结束后，请你输出 $\\displaystyle\\sum_{i=1}^na_i$。\n\n由于答案可能很大，你只需要输出其对 $998244353$ 取模的结果即可。", "inputFormat": "输入共 $m+2$ 行。\n\n第一行输入两个正整数 $n,m$。\n\n第二行输入 $n$ 个正整数 $a_{1\\sim n}$。\n\n接下来 $m$ 行，每行 $3$ 个正整数表示一次操作。", "outputFormat": "输出一行一个整数表示答案对 $998244353$ 取模的结果。", "hint": "### 数据规模与约定\n\n| 测试点 | 特殊限制 |\n| :----------: | :----------: |\n| $1$ | $n,m\\le 10$ |\n| $2$ | 保证一次 `1 l r` 操作上一步是 `2 l r` |\n| $3$ | 保证只有 `1` 操作 |\n| $4$ | 保证只有 `2` 操作 |\n| $5$ | 保证所有的 $l=1$，$r=n$ |\n| $6$ | $n,m\\le 10^3$ |\n| $7\\sim 20$ | 无特殊限制 |\n\n\n对于所有数据，保证 $1\\le n,m\\le2\\times10^5$，$1\\le a_i\\le 10^9$。\n", "locale": "zh-CN"}}}
{"pid": "P7335", "type": "P", "difficulty": 4, "samples": [["6 3\n2 1 3 4 4 4", "15"], ["7 2\n3 4 5 6 7 8 9", "24"]], "limits": {"time": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "2021", "洛谷原创", "O2优化", "字典树 Trie", "其它技巧"], "title": "[JRKSJ R1] 异或", "background": "", "description": "给你 $n,k$ 和序列 $a_{1,2\\dots n}$，选出 $k$ 个**不交**区间 $[l_i,r_i]\\subseteq[1,n]$，求出\n$$\\max_{l_i,r_i}\\sum_{i=1}^k\\bigoplus_{j=l_i}^{r_i}a_j$$\n\n式中 $\\oplus$ 表示二进制异或运算。\n\n**保证数据随机。**", "inputFormat": "输入共 $2$ 行。\\\n第 $1$ 行输入两个数 $n,k$。\\\n第 $2$ 行输入 $n$ 个非负整数代表序列 $a$。", "outputFormat": "$1$ 行输出一个非负整数，代表这个式子的最大值。", "hint": "### 样例 1 解释\n序列中选择的三个区间分别为：\n$$2,1,[3,4],[4],[4]$$\n所得的三个区间的异或和之和为 $7+4+4=15$。\n\n### 数据规模与约定\n\n对于所有数据，保证 $1\\le k\\le n\\le 3000$，$0\\le a_i\\le 10^{9}$。**保证数据随机。**\n\n本题采用捆绑测试。\n\n| $\\text{Subtask}$ | $n\\le$ | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $30$ | $k\\le3$ | $5$ |\n| $2$ | $500$ | $a_i\\le10^7$|  $10$ |\n| $3$ | $1000$ | 无 |  $10$ |\n| $4$ | $1500$ | 无 |  $15$ |\n| $5$ | $2000$ | 无 |  $15$ |\n| $6$ | $2500$ | 无 | $20$ |\n| $7$ | $3000$ |  无|  $25$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JRKSJ R1] 异或", "background": "", "description": "给你 $n,k$ 和序列 $a_{1,2\\dots n}$，选出 $k$ 个**不交**区间 $[l_i,r_i]\\subseteq[1,n]$，求出\n$$\\max_{l_i,r_i}\\sum_{i=1}^k\\bigoplus_{j=l_i}^{r_i}a_j$$\n\n式中 $\\oplus$ 表示二进制异或运算。\n\n**保证数据随机。**", "inputFormat": "输入共 $2$ 行。\\\n第 $1$ 行输入两个数 $n,k$。\\\n第 $2$ 行输入 $n$ 个非负整数代表序列 $a$。", "outputFormat": "$1$ 行输出一个非负整数，代表这个式子的最大值。", "hint": "### 样例 1 解释\n序列中选择的三个区间分别为：\n$$2,1,[3,4],[4],[4]$$\n所得的三个区间的异或和之和为 $7+4+4=15$。\n\n### 数据规模与约定\n\n对于所有数据，保证 $1\\le k\\le n\\le 3000$，$0\\le a_i\\le 10^{9}$。**保证数据随机。**\n\n本题采用捆绑测试。\n\n| $\\text{Subtask}$ | $n\\le$ | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $30$ | $k\\le3$ | $5$ |\n| $2$ | $500$ | $a_i\\le10^7$|  $10$ |\n| $3$ | $1000$ | 无 |  $10$ |\n| $4$ | $1500$ | 无 |  $15$ |\n| $5$ | $2000$ | 无 |  $15$ |\n| $6$ | $2500$ | 无 | $20$ |\n| $7$ | $3000$ |  无|  $25$ |", "locale": "zh-CN"}}}
{"pid": "P7336", "type": "P", "difficulty": 6, "samples": [["1 1 1 2 0\n1 1\n1 0", "0 0\n0 1\n0 0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["模拟", "搜索", "博弈论", "2021", "洛谷原创", "交互题", "Special Judge", "O2优化"], "title": "[JRKSJ R1] 1+1", "background": "", "description": "### 玩法简介\n\n「1+1」 是一款双人对抗游戏。两名玩家各自拥有两个数，每次一名玩家可以用自己的一个数加上对方的一个数，如果大于 $9$ 则取个位。双方轮流执行此步骤。如，下面记录了游戏的几个回合，玩家双方分别为 `a` 和 `b`：\n\n在下面的局面解释中，第一个局面标 `*` 的是先手。\n\n```\na:1 1*（初始局面）\nb:1 2\n\na:1 3（1+2）\nb:1 2\n\na:1 3\nb:1 5（2+3）\n\na:6 3（1+5）\nb:1 5\n```\n---\n\n### 特殊局面\n\n我们把下面的情况称为「攻击」：\n\n```\n3 3\n5 3\n6 1\n9 1\n```\n这些攻击的「攻击度」为 $1$ ，除了 `9 1`。`9 1` 的攻击度为 $2$ 。\n\n下面的情况称为「防御」：\n\n```\n5 1\n5 5\n```\n这些防御的「防御度」为 $1$ ，除了 `5 5`。`5 5`的 防御度为 $2$ 。\n\n当然，所有的攻击或防御不分两个数的顺序，如 `5 1` 和 `1 5` 都视作防御，而\n `9 1` 和 `1 9` 也都视为攻击，而攻击/防御度不变。\n\n如果玩家 `a` 持有防御，而玩家 `b` 在下一步走成了攻击，如下面的情况：\n\n```\na:1 5\nb:1 1*\n\na:1 5\nb:6 1\n```\n那么此时 `a` 持有防御度为 $1$ 的 `1 5`， `b` 持有攻击度为 $1$ 的 `6 1`，此时应该将 `a` 持有的数变成 `1 1` 而 `b` 的此次攻击无效。\n\n也就是说，如果 `a` 的攻击的攻击度与 `b` 的防御的防御度相等，则将 `b` 的两个数变为 `1 1` 而 `a` 的此次攻击视作无效。\n\n我们认为不属于上面的攻击/防御的攻击/防御度为 $0$ （如 `3 4` 等。）\n\n特别的，如果遇到下面这种情况：\n\n```\na:5 5\nb:1 1*\n\na:5 5\nb:1 6\n```\n`a` 的防御度为 $2$ 而 b 的攻击度为 $1$ 。此时应该把 `a` 变成 `5 1` 而 `b` 的此次攻击作废。\n\n\n\n------------\n\n\n### 胜利条件\n\n如果一方走完一步后，他的攻击度严格大于另一方的防御度，则这一方获胜。此时不应该做任何改动，即使要把另一方变成 `1 1` 或 `5 1`。\n\n下面给出了一个例子：\n\n```\na:1 1\nb:6 3*\n\na:1 1\nb:6 4\n\na:1 5\nb:6 4\n\na:1 5\nb:6 9\n\na:1 1\nb:6 9\n\na:1 1\nb:6 0\n\na:1 7\nb:6 0\n\na:1 7\nb:6 1\n\n（ b 胜）\n```\n为了消除歧义，下面再给出一些例子：\n\n```\na:5 5\nb:1 4*\n\na:1 1\nb:1 9\n\na:1 0（ 1+9=10 ，个位为 0 ）\nb:1 9\n\na:1 0\nb:1 9（注意这里， b 用 1 （或 9 ）加了 a 的 0 ，这样也算一次新的攻击）\n\n（ b 胜）\n```\n\n```\na:1 1*\nb:1 4\n\na:1 5\nb:1 4\n\na:1 5（因为是最后一步，无须变成“1 1”）\nb:1 9（这里 b 的“1 9”直接碾压了 a 的“1 5”）\n\n（ b 胜）\n```\n\n现在，你被要求写一个程序，作为先手通过交互的方式和 mcyl35 的程序玩这个游戏。", "inputFormat": "第一行五个整数 $p_0,p_1,c_0,c_1,P$，分别表示你的两个数，mcyl35 的两个数和测试点编号。\n\n下面每行两个整数 $x,y$，表示 mcyl35 的第 $x$ 个数加上了你的第 $y$ 个数。\n\n本题使用 IO 交互，具体可见 [P1733 猜数（IO交互版）](https://www.luogu.com.cn/problem/P1733)。", "outputFormat": "每行两个整数 $x,y$，表示你的第 $x$ 个数加上了 mcyl35 的第 $y$ 个数。", "hint": "#### 数据规模与约定\n\n对于测试点 $1$，保证玩家可以一步获胜。\n\n对于测试点 $2$，保证 mcyl35 的程序随机走步。\n\n对于其他测试点，无特殊约定。\n\n对于 $100\\%$ 的数据，$0\\le p_0,p_1,c_0,c_1\\le 9$。\n\n#### 评分标准\n\n* 有不合法的输出（如输出中含有除了 $0,1$ 之外的数），得 $0$ 分。\n\n* 获胜或走了 $100$ 步及以上本测试点可以获得满分。\n\n* 否则获得 $\\lfloor \\dfrac {st} {20} \\rfloor$ 分，$st$ 表示走的步数，一步表示 mcyl35 走一步。\n\n#### 提示\n\n当交互库没有返回数时，说明结果已经被判定了。\n\n#### 样例解释\n\n```\npl:1 1*\ncp:1 2\n\npl:2 1\ncp:1 2\n\npl:2 1\ncp:1 3\n\npl:5 1\ncp:1 3\n\npl:5 1\ncp:1 8\n\npl:6 1(胜)\ncp:1 8\n```", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JRKSJ R1] 1+1", "background": "", "description": "### 玩法简介\n\n「1+1」 是一款双人对抗游戏。两名玩家各自拥有两个数，每次一名玩家可以用自己的一个数加上对方的一个数，如果大于 $9$ 则取个位。双方轮流执行此步骤。如，下面记录了游戏的几个回合，玩家双方分别为 `a` 和 `b`：\n\n在下面的局面解释中，第一个局面标 `*` 的是先手。\n\n```\na:1 1*（初始局面）\nb:1 2\n\na:1 3（1+2）\nb:1 2\n\na:1 3\nb:1 5（2+3）\n\na:6 3（1+5）\nb:1 5\n```\n---\n\n### 特殊局面\n\n我们把下面的情况称为「攻击」：\n\n```\n3 3\n5 3\n6 1\n9 1\n```\n这些攻击的「攻击度」为 $1$ ，除了 `9 1`。`9 1` 的攻击度为 $2$ 。\n\n下面的情况称为「防御」：\n\n```\n5 1\n5 5\n```\n这些防御的「防御度」为 $1$ ，除了 `5 5`。`5 5`的 防御度为 $2$ 。\n\n当然，所有的攻击或防御不分两个数的顺序，如 `5 1` 和 `1 5` 都视作防御，而\n `9 1` 和 `1 9` 也都视为攻击，而攻击/防御度不变。\n\n如果玩家 `a` 持有防御，而玩家 `b` 在下一步走成了攻击，如下面的情况：\n\n```\na:1 5\nb:1 1*\n\na:1 5\nb:6 1\n```\n那么此时 `a` 持有防御度为 $1$ 的 `1 5`， `b` 持有攻击度为 $1$ 的 `6 1`，此时应该将 `a` 持有的数变成 `1 1` 而 `b` 的此次攻击无效。\n\n也就是说，如果 `a` 的攻击的攻击度与 `b` 的防御的防御度相等，则将 `b` 的两个数变为 `1 1` 而 `a` 的此次攻击视作无效。\n\n我们认为不属于上面的攻击/防御的攻击/防御度为 $0$ （如 `3 4` 等。）\n\n特别的，如果遇到下面这种情况：\n\n```\na:5 5\nb:1 1*\n\na:5 5\nb:1 6\n```\n`a` 的防御度为 $2$ 而 b 的攻击度为 $1$ 。此时应该把 `a` 变成 `5 1` 而 `b` 的此次攻击作废。\n\n\n\n------------\n\n\n### 胜利条件\n\n如果一方走完一步后，他的攻击度严格大于另一方的防御度，则这一方获胜。此时不应该做任何改动，即使要把另一方变成 `1 1` 或 `5 1`。\n\n下面给出了一个例子：\n\n```\na:1 1\nb:6 3*\n\na:1 1\nb:6 4\n\na:1 5\nb:6 4\n\na:1 5\nb:6 9\n\na:1 1\nb:6 9\n\na:1 1\nb:6 0\n\na:1 7\nb:6 0\n\na:1 7\nb:6 1\n\n（ b 胜）\n```\n为了消除歧义，下面再给出一些例子：\n\n```\na:5 5\nb:1 4*\n\na:1 1\nb:1 9\n\na:1 0（ 1+9=10 ，个位为 0 ）\nb:1 9\n\na:1 0\nb:1 9（注意这里， b 用 1 （或 9 ）加了 a 的 0 ，这样也算一次新的攻击）\n\n（ b 胜）\n```\n\n```\na:1 1*\nb:1 4\n\na:1 5\nb:1 4\n\na:1 5（因为是最后一步，无须变成“1 1”）\nb:1 9（这里 b 的“1 9”直接碾压了 a 的“1 5”）\n\n（ b 胜）\n```\n\n现在，你被要求写一个程序，作为先手通过交互的方式和 mcyl35 的程序玩这个游戏。", "inputFormat": "第一行五个整数 $p_0,p_1,c_0,c_1,P$，分别表示你的两个数，mcyl35 的两个数和测试点编号。\n\n下面每行两个整数 $x,y$，表示 mcyl35 的第 $x$ 个数加上了你的第 $y$ 个数。\n\n本题使用 IO 交互，具体可见 [P1733 猜数（IO交互版）](https://www.luogu.com.cn/problem/P1733)。", "outputFormat": "每行两个整数 $x,y$，表示你的第 $x$ 个数加上了 mcyl35 的第 $y$ 个数。", "hint": "#### 数据规模与约定\n\n对于测试点 $1$，保证玩家可以一步获胜。\n\n对于测试点 $2$，保证 mcyl35 的程序随机走步。\n\n对于其他测试点，无特殊约定。\n\n对于 $100\\%$ 的数据，$0\\le p_0,p_1,c_0,c_1\\le 9$。\n\n#### 评分标准\n\n* 有不合法的输出（如输出中含有除了 $0,1$ 之外的数），得 $0$ 分。\n\n* 获胜或走了 $100$ 步及以上本测试点可以获得满分。\n\n* 否则获得 $\\lfloor \\dfrac {st} {20} \\rfloor$ 分，$st$ 表示走的步数，一步表示 mcyl35 走一步。\n\n#### 提示\n\n当交互库没有返回数时，说明结果已经被判定了。\n\n#### 样例解释\n\n```\npl:1 1*\ncp:1 2\n\npl:2 1\ncp:1 2\n\npl:2 1\ncp:1 3\n\npl:5 1\ncp:1 3\n\npl:5 1\ncp:1 8\n\npl:6 1(胜)\ncp:1 8\n```", "locale": "zh-CN"}}}
{"pid": "P7337", "type": "P", "difficulty": 1, "samples": [["3 1 3\n1 0 1\n0 1 1\n", "3\n"], ["3 1 3\n1 1 1\n0 1 1\n", "2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["模拟", "O2优化", "﻿基础算法", "枚举", "洛谷月赛"], "title": "『MdOI R4』Fun", "background": "去 NOIP 考场时有两个优良传统：打狼和喝快乐水。这两项活动都能给同学们带来快乐。", "description": "VG 的学校有 $n$ 个人要去考 NOIP。\n\n每个人有一个交通方式，第 $i$ 个人的交通方式为 $t_i$，$t_i=1$ 表示这个人坐学校大巴，$t_i=0$ 表示这个人自己去考场。\n\n每个人有一个颓废值，第 $i$ 个人的颓废值为 $q_i$，$q_i=1$ 表示这个人愿意打狼，$q_i=0$ 表示这个人不愿意打狼。\n\n每个人去考场时会买一瓶快乐水，但如果坐大巴且愿意打狼的人数（即满足 $t_i=1$ 且 $q_i=1$ 的 $i$ 个数）$k$ 不小于 $m$，则这 $k$ 个人只需要买 $m$ 瓶快乐水。\n\n现在，VG 统计出了所有人的交通方式和颓废值，他请你帮他求出最终所有人买快乐水的总瓶数。", "inputFormat": "第一行三个整数 $n,m,type$。其中 $type$ 表示特殊限制编号，具体意义见数据范围。它可能可以帮助你获得部分分，但正解不依赖于此。\n\n第二行 $n$ 个整数，第 $i$ 个整数为 $t_i$。\n\n第三行 $n$ 个整数，第 $i$ 个整数为 $q_i$。", "outputFormat": "一行一个整数，表示所有人最终买的快乐水总瓶数。", "hint": "【样例解释 #1】\n\n三个人的情况如下：\n\n- 第 $1$ 个人乘坐大巴但不打狼；\n\n- 第 $2$ 个人打狼但不乘坐大巴；\n\n- 第 $3$ 个人乘坐大巴而且打狼。\n\n所以，只有 $1$ 个人既乘车又打狼，满足不小于 $m$ 的条件，故对于这 $1$ 个人需要购买 $m$ 瓶快乐水，剩下 $2$ 个人购买 $2$ 瓶快乐水，总共须购买 $3$ 瓶快乐水。\n\n【数据规模与约定】\n\n**本题不采用捆绑测试**\n\n| 测试点编号 |   $n,m$    | $type$ |   $t_i$    |   $q_i$    |\n| :------: | :--------: | :----: | :--------: | :--------: |\n|   $1$    |  $\\le 30$  |  $=0$  |    $=0$    |    $=0$    |\n|   $2$    |  $\\le 70$  |  $=0$  |    $=0$    |    $=0$    |\n|   $3$    |  $\\le 30$  |  $=1$  |    $=1$    |    $=1$    |\n|   $4$    |  $\\le 70$  |  $=1$  |    $=1$    |    $=1$    |\n|   $5$    |   $n=m$    |  $=2$  | 无特殊限制 | 无特殊限制 |\n|   $6$    |   $n=m$    |  $=2$  | 无特殊限制 | 无特殊限制 |\n|   $7$    |   $n=m$    |  $=2$  | 无特殊限制 | 无特殊限制 |\n|   $8$    | 无特殊限制 |  $=3$  | 无特殊限制 | 无特殊限制 |\n|   $9$    | 无特殊限制 |  $=3$  | 无特殊限制 | 无特殊限制 |\n|   $10$   | 无特殊限制 |  $=3$  | 无特殊限制 | 无特殊限制 |\n\n对于 $100\\%$ 的数据，$1 \\le m \\le n \\le 100$，$t_i,q_i \\in \\{0,1\\}$，$type \\in \\{0,1,2,3\\}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『MdOI R4』Fun", "background": "去 NOIP 考场时有两个优良传统：打狼和喝快乐水。这两项活动都能给同学们带来快乐。", "description": "VG 的学校有 $n$ 个人要去考 NOIP。\n\n每个人有一个交通方式，第 $i$ 个人的交通方式为 $t_i$，$t_i=1$ 表示这个人坐学校大巴，$t_i=0$ 表示这个人自己去考场。\n\n每个人有一个颓废值，第 $i$ 个人的颓废值为 $q_i$，$q_i=1$ 表示这个人愿意打狼，$q_i=0$ 表示这个人不愿意打狼。\n\n每个人去考场时会买一瓶快乐水，但如果坐大巴且愿意打狼的人数（即满足 $t_i=1$ 且 $q_i=1$ 的 $i$ 个数）$k$ 不小于 $m$，则这 $k$ 个人只需要买 $m$ 瓶快乐水。\n\n现在，VG 统计出了所有人的交通方式和颓废值，他请你帮他求出最终所有人买快乐水的总瓶数。", "inputFormat": "第一行三个整数 $n,m,type$。其中 $type$ 表示特殊限制编号，具体意义见数据范围。它可能可以帮助你获得部分分，但正解不依赖于此。\n\n第二行 $n$ 个整数，第 $i$ 个整数为 $t_i$。\n\n第三行 $n$ 个整数，第 $i$ 个整数为 $q_i$。", "outputFormat": "一行一个整数，表示所有人最终买的快乐水总瓶数。", "hint": "【样例解释 #1】\n\n三个人的情况如下：\n\n- 第 $1$ 个人乘坐大巴但不打狼；\n\n- 第 $2$ 个人打狼但不乘坐大巴；\n\n- 第 $3$ 个人乘坐大巴而且打狼。\n\n所以，只有 $1$ 个人既乘车又打狼，满足不小于 $m$ 的条件，故对于这 $1$ 个人需要购买 $m$ 瓶快乐水，剩下 $2$ 个人购买 $2$ 瓶快乐水，总共须购买 $3$ 瓶快乐水。\n\n【数据规模与约定】\n\n**本题不采用捆绑测试**\n\n| 测试点编号 |   $n,m$    | $type$ |   $t_i$    |   $q_i$    |\n| :------: | :--------: | :----: | :--------: | :--------: |\n|   $1$    |  $\\le 30$  |  $=0$  |    $=0$    |    $=0$    |\n|   $2$    |  $\\le 70$  |  $=0$  |    $=0$    |    $=0$    |\n|   $3$    |  $\\le 30$  |  $=1$  |    $=1$    |    $=1$    |\n|   $4$    |  $\\le 70$  |  $=1$  |    $=1$    |    $=1$    |\n|   $5$    |   $n=m$    |  $=2$  | 无特殊限制 | 无特殊限制 |\n|   $6$    |   $n=m$    |  $=2$  | 无特殊限制 | 无特殊限制 |\n|   $7$    |   $n=m$    |  $=2$  | 无特殊限制 | 无特殊限制 |\n|   $8$    | 无特殊限制 |  $=3$  | 无特殊限制 | 无特殊限制 |\n|   $9$    | 无特殊限制 |  $=3$  | 无特殊限制 | 无特殊限制 |\n|   $10$   | 无特殊限制 |  $=3$  | 无特殊限制 | 无特殊限制 |\n\n对于 $100\\%$ 的数据，$1 \\le m \\le n \\le 100$，$t_i,q_i \\in \\{0,1\\}$，$type \\in \\{0,1,2,3\\}$。", "locale": "zh-CN"}}}
{"pid": "P7338", "type": "P", "difficulty": 3, "samples": [["3\n5\n01110\n10010\n5\n11000\n01100\n5\n00101\n10100\n", "RP\n++\nRP"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "洛谷原创", "洛谷月赛"], "title": "『MdOI R4』Color", "background": "", "description": "小 M 同学有一张 $2$ 行 $n$ 列的方格纸，一开始所有格子都是白色的。\n\n她决定对一些格子染色，具体地，每次她会选择两个**相邻的（四联通的，也就是有公共边的）白色**格子，其中一个染成红色，另一个染成蓝色。\n\n她的目标是通过**任意次操作**让指定的一些格子变成红色，**对其他格子没有要求**。请你帮她判断一下，能否通过上述操作达成目标呢？", "inputFormat": "**本题包含多组数据。** 第一行有一个正整数 $T$ 表示数据组数。\n\n接下来 $T$ 组数据，每组数据三行，包括：\n- 第一行，一个正整数 $n$ 表示方格纸列数。\n- 第二行，一个 $01$ 串 $p_{1\\ldots n}$，其中 $p_i=1$ 表示第 $1$ 行第 $i$ 列必须是红色，否则不作要求。\n- 第三行，一个 $01$ 串 $q_{1\\ldots n}$，其中 $q_i=1$ 表示第 $2$ 行第 $i$ 列必须是红色，否则不作要求。", "outputFormat": "$T$ 行，每行对应一组数据。\n\n对于每组数据，如果可以做到输出 `RP`，否则输出 `++`。", "hint": "【样例解释】\n\n![temp.png](https://i.loli.net/2020/09/27/oCRpYnPAlFk7GuS.png)\n\n上图中左侧为第一组测试数据的一种方案，右侧为第三组测试数据的一种方案，对于第二组测试数据，并没有满足要求的方案。\n\n【数据规模与约定】 \n\n**本题采用捆绑测试**\n\n|子任务编号|$n\\le$|特殊性质|$T\\le$|分值|\n|:-|:-|:-|:-|:-|\n|$1$|$3$|无特殊限制|$10$|$10$|\n|$2$|$10$|无特殊限制|$10$|$20$|\n|$3$|无特殊限制|所有 $1$ 都在同一行|$10$|$1$|\n|$4$|无特殊限制|$1$ 不超过 $4$ 个|$10$|$13$|\n|$5$|$10^3$|无特殊限制|$10$|$25$|\n|$6$|无特殊限制|无特殊限制|$10$|$30$|\n|$7$|$16$|无特殊限制|$65536$|$1$|\n\n对于所有数据，满足 $1\\le n\\le 10^5$，$\\sum n\\le 2^{20}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『MdOI R4』Color", "background": "", "description": "小 M 同学有一张 $2$ 行 $n$ 列的方格纸，一开始所有格子都是白色的。\n\n她决定对一些格子染色，具体地，每次她会选择两个**相邻的（四联通的，也就是有公共边的）白色**格子，其中一个染成红色，另一个染成蓝色。\n\n她的目标是通过**任意次操作**让指定的一些格子变成红色，**对其他格子没有要求**。请你帮她判断一下，能否通过上述操作达成目标呢？", "inputFormat": "**本题包含多组数据。** 第一行有一个正整数 $T$ 表示数据组数。\n\n接下来 $T$ 组数据，每组数据三行，包括：\n- 第一行，一个正整数 $n$ 表示方格纸列数。\n- 第二行，一个 $01$ 串 $p_{1\\ldots n}$，其中 $p_i=1$ 表示第 $1$ 行第 $i$ 列必须是红色，否则不作要求。\n- 第三行，一个 $01$ 串 $q_{1\\ldots n}$，其中 $q_i=1$ 表示第 $2$ 行第 $i$ 列必须是红色，否则不作要求。", "outputFormat": "$T$ 行，每行对应一组数据。\n\n对于每组数据，如果可以做到输出 `RP`，否则输出 `++`。", "hint": "【样例解释】\n\n![temp.png](https://i.loli.net/2020/09/27/oCRpYnPAlFk7GuS.png)\n\n上图中左侧为第一组测试数据的一种方案，右侧为第三组测试数据的一种方案，对于第二组测试数据，并没有满足要求的方案。\n\n【数据规模与约定】 \n\n**本题采用捆绑测试**\n\n|子任务编号|$n\\le$|特殊性质|$T\\le$|分值|\n|:-|:-|:-|:-|:-|\n|$1$|$3$|无特殊限制|$10$|$10$|\n|$2$|$10$|无特殊限制|$10$|$20$|\n|$3$|无特殊限制|所有 $1$ 都在同一行|$10$|$1$|\n|$4$|无特殊限制|$1$ 不超过 $4$ 个|$10$|$13$|\n|$5$|$10^3$|无特殊限制|$10$|$25$|\n|$6$|无特殊限制|无特殊限制|$10$|$30$|\n|$7$|$16$|无特殊限制|$65536$|$1$|\n\n对于所有数据，满足 $1\\le n\\le 10^5$，$\\sum n\\le 2^{20}$。", "locale": "zh-CN"}}}
{"pid": "P7339", "type": "P", "difficulty": 4, "samples": [["3\n3 6\n2 0 0 5 0 9 0 9\n3 6\n2 0 5 0 0 5 0 9\n2 6\n2 0 0 5\n", "Yoshino\nKotori\nKotori\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["洛谷月赛"], "title": "『MdOI R4』Kotori", "background": "『「因为」？所以呢？』\n\n『因为我是你的妹妹，所以你要叫我别阻止你胡来么？』\n\n『因为我是你的妹妹，所以你要叫我看着你赴死么？』\n\n『因为我是你的妹妹，所以你要叫我默默看着你可能被杀死么？』\n\n『不要开玩笑了，这算什么啊！还以为好不容易和平下来了，还以为士道终于不用再受伤了。』\n\n『我——我不希望士道死掉，不想再看到士道受伤了，已经受不了再让士道感到痛苦了啊……』\n\n『因为我——』\n\n『喜欢士道呀——』\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/s0f5nxk0.png)", "description": "一年一度的世界最萌大会开始了。作为曾经的「萌王」，Kotori 自然无需参赛。但她希望帮助自己的哥哥  Shido 获得「燃王」的头衔。\n\n本届 ISML 共有 $n=2^k$ 名参赛选手，编号为 $1,2\\ldots n$，其中 Shido 的编号是 $1$，赛制为淘汰赛。每一轮比赛之后剩余选手中编号最小的两人为对手，编号第 $3,4$ 小的两人为对手，依次类推。每场比赛的胜负取决于粉丝的投票数，获得票数较多的一方晋级下一轮比赛，票数较少的一方淘汰。\n\n例如共有 $4$ 名选手，则第一轮编号为 $1,2$ 的选手进行一场比赛，编号 $3,4$ 的选手进行一场比赛，然后两场比赛的胜者进行一场比赛，争夺总冠军。获得总冠军的选手将获得「燃王」头衔。\n\n每个角色有一个厨团，$i$ 号选手的厨团人数为 $a_i$。每轮投票时，所有厨团的成员**会且仅会**为对应的选手投票。\n\n此外，Kotori 拥有一个人数为 $m$ 人的团队，他们会永远跟随 Kotori 投票。也就是说，每场比赛 Kotori 都可以为对战双方的任意一者增加 $m$ 张得票。注意在一轮比赛中可能有多场比赛，每场比赛一定只有两名选手。\n\n另外，Kotori 还拥有一项特权：当某场比赛双方的票数相同时，作为萌王的她可以决定这场比赛的胜者。\n\n现在，Kotori 希望知道，她是否有能力帮助哥哥成为冠军，获得「燃王」的头衔。", "inputFormat": "**本题包含多组数据。** 第一行有一个正整数 $T$ 表示数据组数。\n\n接下来 $T$ 组数据，每组数据两行，包括：\n\n- 第一行两个整数，表示 $k,m$。\n- 第二行 $2^k$ 个整数，第 $i$ 个表示 $a_i$。", "outputFormat": "$T$ 行，每行对应一组数据。\n\n对于每组数据，如果可以做到输出 `Kotori`，否则输出 `Yoshino`。", "hint": "【样例解释 #1】\n\n对于 $1$ 组数据，并不存在让 Shido 成为燃王的方案。\n\n对于第 $2$ 组数据，考虑以下方案：\n\n第 $1$ 轮：\n- $1$ 号和 $2$ 号比赛，把票给 $1$ 号，$2$ 号淘汰。\n- $3$ 号和 $4$ 号比赛，把票给 $3$ 号，$4$ 号淘汰。\n- $5$ 号和 $6$ 号比赛，把票给 $6$ 号，$5$ 号淘汰。\n- $7$ 号和 $8$ 号比赛，把票给 $7$ 号，$7$ 号淘汰。\n\n第 $2$ 轮：\n- $1$ 号和 $3$ 号比赛，把票给 $1$ 号，$3$ 号淘汰。\n- $6$ 号和 $8$ 号比赛，把票给 $6$ 号，$8$ 号淘汰。\n\n第 $3$ 轮：\n- $1$ 号和 $6$ 号比赛，把票给 $1$ 号，$6$ 号淘汰。\n\n【数据规模与约定】\n\n**本题采用捆绑测试**\n\n| 子任务编号 | $k\\le$    |$\\sum n\\le$ | $m\\le $    | 分值  |\n| -----|------ | ---------- | ---------- | ----- |\n| $1$        | $0$  |$1$      | 无特殊限制 | $1$   |\n| $2$        | $1$     |$2^{11}$   | 无特殊限制 | $9$   |\n| $3$        | $4$  |$2^{14} $     | 无特殊限制 | $15$  |\n| $4$        | 无特殊限制 |$2^{20}$| $0$        | $10 $ |\n| $5$        | $9$   |   $2^{11}$| 无特殊限制 | $20$  |\n| $6$        | $15$   |$2^{17}$    | 无特殊限制 | $20$  |\n| $7$        | $18$   |$2^{20} $   | 无特殊限制 | $25$  |\n\n对于 $100\\%$ 的数据，$\\sum n\\le 2^{20}$，$0\\le k\\le 18$，$0\\le m,a_i\\le 10^9$。\n\n【提示与帮助】\n\n本题读入量较大，请选手选择较快的读入方式。\n\n本题中的“世界最萌大会”与真正的“世界最萌大会”有所不同，在本题中请以本题为准。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『MdOI R4』Kotori", "background": "『「因为」？所以呢？』\n\n『因为我是你的妹妹，所以你要叫我别阻止你胡来么？』\n\n『因为我是你的妹妹，所以你要叫我看着你赴死么？』\n\n『因为我是你的妹妹，所以你要叫我默默看着你可能被杀死么？』\n\n『不要开玩笑了，这算什么啊！还以为好不容易和平下来了，还以为士道终于不用再受伤了。』\n\n『我——我不希望士道死掉，不想再看到士道受伤了，已经受不了再让士道感到痛苦了啊……』\n\n『因为我——』\n\n『喜欢士道呀——』\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/s0f5nxk0.png)", "description": "一年一度的世界最萌大会开始了。作为曾经的「萌王」，Kotori 自然无需参赛。但她希望帮助自己的哥哥  Shido 获得「燃王」的头衔。\n\n本届 ISML 共有 $n=2^k$ 名参赛选手，编号为 $1,2\\ldots n$，其中 Shido 的编号是 $1$，赛制为淘汰赛。每一轮比赛之后剩余选手中编号最小的两人为对手，编号第 $3,4$ 小的两人为对手，依次类推。每场比赛的胜负取决于粉丝的投票数，获得票数较多的一方晋级下一轮比赛，票数较少的一方淘汰。\n\n例如共有 $4$ 名选手，则第一轮编号为 $1,2$ 的选手进行一场比赛，编号 $3,4$ 的选手进行一场比赛，然后两场比赛的胜者进行一场比赛，争夺总冠军。获得总冠军的选手将获得「燃王」头衔。\n\n每个角色有一个厨团，$i$ 号选手的厨团人数为 $a_i$。每轮投票时，所有厨团的成员**会且仅会**为对应的选手投票。\n\n此外，Kotori 拥有一个人数为 $m$ 人的团队，他们会永远跟随 Kotori 投票。也就是说，每场比赛 Kotori 都可以为对战双方的任意一者增加 $m$ 张得票。注意在一轮比赛中可能有多场比赛，每场比赛一定只有两名选手。\n\n另外，Kotori 还拥有一项特权：当某场比赛双方的票数相同时，作为萌王的她可以决定这场比赛的胜者。\n\n现在，Kotori 希望知道，她是否有能力帮助哥哥成为冠军，获得「燃王」的头衔。", "inputFormat": "**本题包含多组数据。** 第一行有一个正整数 $T$ 表示数据组数。\n\n接下来 $T$ 组数据，每组数据两行，包括：\n\n- 第一行两个整数，表示 $k,m$。\n- 第二行 $2^k$ 个整数，第 $i$ 个表示 $a_i$。", "outputFormat": "$T$ 行，每行对应一组数据。\n\n对于每组数据，如果可以做到输出 `Kotori`，否则输出 `Yoshino`。", "hint": "【样例解释 #1】\n\n对于 $1$ 组数据，并不存在让 Shido 成为燃王的方案。\n\n对于第 $2$ 组数据，考虑以下方案：\n\n第 $1$ 轮：\n- $1$ 号和 $2$ 号比赛，把票给 $1$ 号，$2$ 号淘汰。\n- $3$ 号和 $4$ 号比赛，把票给 $3$ 号，$4$ 号淘汰。\n- $5$ 号和 $6$ 号比赛，把票给 $6$ 号，$5$ 号淘汰。\n- $7$ 号和 $8$ 号比赛，把票给 $7$ 号，$7$ 号淘汰。\n\n第 $2$ 轮：\n- $1$ 号和 $3$ 号比赛，把票给 $1$ 号，$3$ 号淘汰。\n- $6$ 号和 $8$ 号比赛，把票给 $6$ 号，$8$ 号淘汰。\n\n第 $3$ 轮：\n- $1$ 号和 $6$ 号比赛，把票给 $1$ 号，$6$ 号淘汰。\n\n【数据规模与约定】\n\n**本题采用捆绑测试**\n\n| 子任务编号 | $k\\le$    |$\\sum n\\le$ | $m\\le $    | 分值  |\n| -----|------ | ---------- | ---------- | ----- |\n| $1$        | $0$  |$1$      | 无特殊限制 | $1$   |\n| $2$        | $1$     |$2^{11}$   | 无特殊限制 | $9$   |\n| $3$        | $4$  |$2^{14} $     | 无特殊限制 | $15$  |\n| $4$        | 无特殊限制 |$2^{20}$| $0$        | $10 $ |\n| $5$        | $9$   |   $2^{11}$| 无特殊限制 | $20$  |\n| $6$        | $15$   |$2^{17}$    | 无特殊限制 | $20$  |\n| $7$        | $18$   |$2^{20} $   | 无特殊限制 | $25$  |\n\n对于 $100\\%$ 的数据，$\\sum n\\le 2^{20}$，$0\\le k\\le 18$，$0\\le m,a_i\\le 10^9$。\n\n【提示与帮助】\n\n本题读入量较大，请选手选择较快的读入方式。\n\n本题中的“世界最萌大会”与真正的“世界最萌大会”有所不同，在本题中请以本题为准。", "locale": "zh-CN"}}}
{"pid": "P7340", "type": "P", "difficulty": 6, "samples": [["1\n3 3 2\n2 4 1 4\n10 4 3 4\n1 3 1 3\n", "1 3\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "二分", "Special Judge", "O2优化", "洛谷月赛"], "title": "『MdOI R4』Balance", "background": "可怜的 $\\rm\\textcolor {grey}{JohnVictor}$ 玩的卡组在平衡性调整中被削弱了，现在他掉了很多杯，他想知道什么样的一个世界才是真正平衡的。\n\n于是就有了这题。", "description": "给定长度为 $n$ 的，由整数构成的数组 $a,b,p,q$，并定义函数 $f(i,j)=\\dfrac{a_i+b_j}{p_i+q_j}(1\\le i,j\\le n)$。\n\n再给定两个整数 $x,y$，你需要求出一对 $(i,j)$，使得 $f(i,j)$ 在所有 $f(i,t)(t=1,2,\\cdots,n)$ 中是第 $x$ 小的，在所有 $f(s,j)(s=1,2,\\cdots,n)$ 中是第 $y$ 小的。 \n\n在本题中，我们称一个数 $x$ 在序列 $c_{1\\ldots n}$ 中是第 $k$ 小的，当且仅当在 $c$ 中有且仅有 $\\alpha$ 个数 $y$ 满足 $y<x$，且有且仅有 $\\beta$ 个数 $y$ 满足 $y\\le x$，同时 $\\alpha<k\\le \\beta$。\n\n如果不存在这样的 $(i,j)$，请输出 `0 0`。\n\n如果有多组这样的 $(i,j)$，输出任意一组即可。\n\n由于平衡性的问题不是一次就能问清楚的，所以出题人会问你多次。", "inputFormat": "**本题有多组数据。**\n\n第一行一个整数 $T$ 表示数据组数，对于每组数据：\n\n第一行三个正整数 $n,x,y$。\n\n接下来 $n$ 行，每行 $4$ 个整数。第 $i$ 行的四个整数为 $a_i,b_i,p_i,q_i$。", "outputFormat": "$T$行，每一行两个整数，表示你找出的 $(i,j)$。", "hint": "【样例解释 #1】\n- $f(1,1)=1.2;f(1,2)=1.2;f(1,3)=1.25$。\n- $f(2,1)=2;f(2,2)=2;f(2,3)=2\\frac{1}{6}$。\n- $f(3,1)=1;f(3,2)=1;f(3,3)=1$。\n\n$f(1,3)$ 在 $f(1,1),f(1,2),f(1,3)$ 中是第 $3$ 小的，$f(1,3)$ 在 $f(1,3),f(2,3),f(3,3)$ 中是第 $2$ 小的。\n\n【数据规模与约定】\n\n**本题采用捆绑测试**\n\n| 子任务编号 | $\\sum n\\le$         | $\\vert a_i\\vert ,\\vert b_i\\vert ,p_i,q_i\\le$ | $(x,y)= $  | 分值  |\n| ---------- | -------------- | -------------------- | ---------- | ----- |\n| $1$        | $5\\times 10^3$ | 无特殊限制           | 无特殊限制 | $10$  |\n| $2$        | 无特殊限制     | $3$                  | 无特殊限制 | $10$  |\n| $3$        | $10^5$         | 无特殊限制           | $(1,n)$        | $30 $ |\n| $4$        | $10^5$         | 无特殊限制           | 无特殊限制 | $20$  |\n| $5$        | 无特殊限制     | 无特殊限制           | 无特殊限制 | $30$  |\n\n对于 $100\\%$ 的数据，$1 \\le x,y \\le n \\le 5 \\times 10^5$，$\\sum n \\le 5 \\times 10^5$，$|a_i|,|b_i|\\le 10^9$，$0<p_i,q_i\\le 10^9$，其中 $\\sum n $ 表示所有数据中 $n$ 的和。\n\n【提示与帮助】\n\n本题读入量较大，请选手选择较快的读入方式。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『MdOI R4』Balance", "background": "可怜的 $\\rm\\textcolor {grey}{JohnVictor}$ 玩的卡组在平衡性调整中被削弱了，现在他掉了很多杯，他想知道什么样的一个世界才是真正平衡的。\n\n于是就有了这题。", "description": "给定长度为 $n$ 的，由整数构成的数组 $a,b,p,q$，并定义函数 $f(i,j)=\\dfrac{a_i+b_j}{p_i+q_j}(1\\le i,j\\le n)$。\n\n再给定两个整数 $x,y$，你需要求出一对 $(i,j)$，使得 $f(i,j)$ 在所有 $f(i,t)(t=1,2,\\cdots,n)$ 中是第 $x$ 小的，在所有 $f(s,j)(s=1,2,\\cdots,n)$ 中是第 $y$ 小的。 \n\n在本题中，我们称一个数 $x$ 在序列 $c_{1\\ldots n}$ 中是第 $k$ 小的，当且仅当在 $c$ 中有且仅有 $\\alpha$ 个数 $y$ 满足 $y<x$，且有且仅有 $\\beta$ 个数 $y$ 满足 $y\\le x$，同时 $\\alpha<k\\le \\beta$。\n\n如果不存在这样的 $(i,j)$，请输出 `0 0`。\n\n如果有多组这样的 $(i,j)$，输出任意一组即可。\n\n由于平衡性的问题不是一次就能问清楚的，所以出题人会问你多次。", "inputFormat": "**本题有多组数据。**\n\n第一行一个整数 $T$ 表示数据组数，对于每组数据：\n\n第一行三个正整数 $n,x,y$。\n\n接下来 $n$ 行，每行 $4$ 个整数。第 $i$ 行的四个整数为 $a_i,b_i,p_i,q_i$。", "outputFormat": "$T$行，每一行两个整数，表示你找出的 $(i,j)$。", "hint": "【样例解释 #1】\n- $f(1,1)=1.2;f(1,2)=1.2;f(1,3)=1.25$。\n- $f(2,1)=2;f(2,2)=2;f(2,3)=2\\frac{1}{6}$。\n- $f(3,1)=1;f(3,2)=1;f(3,3)=1$。\n\n$f(1,3)$ 在 $f(1,1),f(1,2),f(1,3)$ 中是第 $3$ 小的，$f(1,3)$ 在 $f(1,3),f(2,3),f(3,3)$ 中是第 $2$ 小的。\n\n【数据规模与约定】\n\n**本题采用捆绑测试**\n\n| 子任务编号 | $\\sum n\\le$         | $\\vert a_i\\vert ,\\vert b_i\\vert ,p_i,q_i\\le$ | $(x,y)= $  | 分值  |\n| ---------- | -------------- | -------------------- | ---------- | ----- |\n| $1$        | $5\\times 10^3$ | 无特殊限制           | 无特殊限制 | $10$  |\n| $2$        | 无特殊限制     | $3$                  | 无特殊限制 | $10$  |\n| $3$        | $10^5$         | 无特殊限制           | $(1,n)$        | $30 $ |\n| $4$        | $10^5$         | 无特殊限制           | 无特殊限制 | $20$  |\n| $5$        | 无特殊限制     | 无特殊限制           | 无特殊限制 | $30$  |\n\n对于 $100\\%$ 的数据，$1 \\le x,y \\le n \\le 5 \\times 10^5$，$\\sum n \\le 5 \\times 10^5$，$|a_i|,|b_i|\\le 10^9$，$0<p_i,q_i\\le 10^9$，其中 $\\sum n $ 表示所有数据中 $n$ 的和。\n\n【提示与帮助】\n\n本题读入量较大，请选手选择较快的读入方式。", "locale": "zh-CN"}}}
{"pid": "P7341", "type": "P", "difficulty": 7, "samples": [["1\n3 3\n1 3 7", "4"], ["2\n5 9\n2 30 98 386 482\n4 2 \n1 3 3 1", "12\n12"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["洛谷月赛"], "title": "『MdOI R4』Phoenix", "background": "这是 $6$ 题中唯一一道没有题目背景的题。", "description": "给定 $n$ 个**不可重**集合 $s_1\\dots s_n$，集合中的数都是 $[1,m]$ 的范围内的整数。\n\n现在请你求出有多少种 $1\\sim n$ 的排列 $p$，使得\n\n$(\\sum\\limits_{i=1}^n |s_i|)-(\\sum\\limits_{i=1}^{n-1} |s_{p_i}\\bigcap s_{p_{i+1}}|)=|\\bigcup\\limits_{i=1}^n s_i|$\n\n成立。\n\n答案对 $998244353$ 取模。保证取模前的真实答案大于 $0$。", "inputFormat": "**本题有多组数据。**\n\n第一行一个正整数 $T$ 表示数据组数，对于每组数据：\n\n第一行两个正整数 $n,m$。\n\n第二行 $n$ 个正整数 $a_1,a_2,\\cdots,a_n$，每个正整数代表一个状态压缩下的集合，若 $a_i$ 在二进制下从低位往高位的第 $k$ 位是 $1$，则 $s_i$ 包含 $k$，否则 $s_i$ 不包含 $k$。", "outputFormat": "$T$ 行，每行对应一组测试数据。\n\n对于每组数据，一行一个整数表示答案。", "hint": "【样例解释 #1】\n\n三个集合分别为 $\\{1\\},\\{1,2\\},\\{1,2,3\\}$。\n\n\n共有四个排列符合条件，分别是 $(1,2,3),(1,3,2),(2,3,1),(3,2,1)$。\n\n【数据规模与约定】\n\n**本题采用捆绑测试**\n|子任务编号|$n\\le$|$m\\le$|特殊性质|分值|\n|:-|:-|:-|:-|:-|\n|$1$|$10$|$20$|无特殊限制|$10$|\n|$2$|$30$|无特殊限制|$a_i=2^i$|$10$|\n|$3$|无特殊限制|无特殊限制|$a_i\\operatorname{or}a_j=\\max(a_i,a_j)$|$10$|\n|$4$|无特殊限制|无特殊限制|每个集合恰好包含两个元素|$20$|\n|$5$|无特殊限制|$20$|无特殊限制|$20$|\n|$6$|无特殊限制|无特殊限制|无特殊限制|$30$|\n\n对于 $100\\%$ 的数据，$1 \\le T \\le 50$，$1\\le \\sum n\\le  10^5$，$1\\le m\\le 60$，$0 \\le a_i \\le 2^m-1$，其中 $\\sum n$  表示所有测试数据中 $n$ 的和。\n\n【提示与帮助】\n\n本题读入量较大，请选手选择较快的读入方式。\n\n感谢 $\\rm\\textcolor{black}{J}\\textcolor{red}{ohnVictor}$ 对此题的贡献。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『MdOI R4』Phoenix", "background": "这是 $6$ 题中唯一一道没有题目背景的题。", "description": "给定 $n$ 个**不可重**集合 $s_1\\dots s_n$，集合中的数都是 $[1,m]$ 的范围内的整数。\n\n现在请你求出有多少种 $1\\sim n$ 的排列 $p$，使得\n\n$(\\sum\\limits_{i=1}^n |s_i|)-(\\sum\\limits_{i=1}^{n-1} |s_{p_i}\\bigcap s_{p_{i+1}}|)=|\\bigcup\\limits_{i=1}^n s_i|$\n\n成立。\n\n答案对 $998244353$ 取模。保证取模前的真实答案大于 $0$。", "inputFormat": "**本题有多组数据。**\n\n第一行一个正整数 $T$ 表示数据组数，对于每组数据：\n\n第一行两个正整数 $n,m$。\n\n第二行 $n$ 个正整数 $a_1,a_2,\\cdots,a_n$，每个正整数代表一个状态压缩下的集合，若 $a_i$ 在二进制下从低位往高位的第 $k$ 位是 $1$，则 $s_i$ 包含 $k$，否则 $s_i$ 不包含 $k$。", "outputFormat": "$T$ 行，每行对应一组测试数据。\n\n对于每组数据，一行一个整数表示答案。", "hint": "【样例解释 #1】\n\n三个集合分别为 $\\{1\\},\\{1,2\\},\\{1,2,3\\}$。\n\n\n共有四个排列符合条件，分别是 $(1,2,3),(1,3,2),(2,3,1),(3,2,1)$。\n\n【数据规模与约定】\n\n**本题采用捆绑测试**\n|子任务编号|$n\\le$|$m\\le$|特殊性质|分值|\n|:-|:-|:-|:-|:-|\n|$1$|$10$|$20$|无特殊限制|$10$|\n|$2$|$30$|无特殊限制|$a_i=2^i$|$10$|\n|$3$|无特殊限制|无特殊限制|$a_i\\operatorname{or}a_j=\\max(a_i,a_j)$|$10$|\n|$4$|无特殊限制|无特殊限制|每个集合恰好包含两个元素|$20$|\n|$5$|无特殊限制|$20$|无特殊限制|$20$|\n|$6$|无特殊限制|无特殊限制|无特殊限制|$30$|\n\n对于 $100\\%$ 的数据，$1 \\le T \\le 50$，$1\\le \\sum n\\le  10^5$，$1\\le m\\le 60$，$0 \\le a_i \\le 2^m-1$，其中 $\\sum n$  表示所有测试数据中 $n$ 的和。\n\n【提示与帮助】\n\n本题读入量较大，请选手选择较快的读入方式。\n\n感谢 $\\rm\\textcolor{black}{J}\\textcolor{red}{ohnVictor}$ 对此题的贡献。", "locale": "zh-CN"}}}
{"pid": "P7342", "type": "P", "difficulty": 7, "samples": [["4 3\n3 4 6\n", "104\n"], ["10 10\n2 5 3 8 4 5 2 19 3 6\n", "219856\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "洛谷月赛"], "title": "『MdOI R4』Destiny", "background": "T5 的第一句话是假的。", "description": "注意，本题中下标从 $0$ 开始。\n\n一个长度为 $n$ 的序列 $\\{a_i\\}$ 的权值 $v(a)$ 定义为：\n- $n=1$ 时为 $v(a)=a_0$。\n- $n>1$ 时为它所有子区间的权值之和，也就是 $v(a_0,a_1,\\ldots,a_{n-1})=\\sum\\limits_{i=0}^{n-2}\\sum\\limits_{j=0}^{n-i-1}v(a_j,a_{j+1},\\ldots,a_{j+i})$. \n\n给定一个序列，求出它的的权值，答案对 $998244353$ 取模。\n\n这个序列是这样生成的：输入序列 $b_0,b_1,\\cdots,b_{k-1}$，然后 $a_i=b_{i\\bmod k}$。", "inputFormat": "第一行为 $n,k$，表示序列 $a$ 的长和序列 $b$ 的长。\n\n第二行为 $b_0,b_1,\\cdots,b_{k-1}$，含义见题目描述。", "outputFormat": "一行一个整数，表示序列 $a$ 的权值对 $998244353$ 取余的结果。", "hint": "【样例解释 #1】\n\n生成序列 $a=[3,4,6,3]$，然后：\n- $v(3,4)=v(3)+v(4)=7$\n- $v(4,6)=v(4)+v(6)=10$\n- $v(6,3)=v(6)+v(3)=9$\n- $v(3,4,6)=v(3)+v(4)+v(6)+v(3,4)+v(4,6)=30$\n- $v(4,6,3)=v(4)+v(6)+v(3)+v(4,6)+v(6,3)=32$\n- $v(3,4,6,3)=v(3)+v(4)+v(6)+v(3)+v(3,4)+v(4,6)+v(6,3)+v(3,4,6)+v(4,6,3)=104$\n\n【数据规模与约定】\n\n**本题不使用捆绑测试。**\n\n本题共 $25$ 个测试点，每个测试点 $4$ 分。\n\n|测试点编号|$n\\le$|$k$|\n|:-|:-|:-|\n|$1\\sim 3$|$5000$|无特殊限制|\n|$4\\sim 10$|$10^5$|无特殊限制|\n|$11\\sim 15$|无特殊限制|$=60928$|\n|$16\\sim 25$|无特殊限制|无特殊限制|\n\n对于 $100\\%$ 的数据 : $1\\le n\\le 10^9$，$1 \\le k \\le 10^5$，$0\\le a_i\\le 998244352$。\n\n感谢 $\\rm\\textcolor{black}{J}\\textcolor{red}{ohnVictor}$ 对此题的贡献。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『MdOI R4』Destiny", "background": "T5 的第一句话是假的。", "description": "注意，本题中下标从 $0$ 开始。\n\n一个长度为 $n$ 的序列 $\\{a_i\\}$ 的权值 $v(a)$ 定义为：\n- $n=1$ 时为 $v(a)=a_0$。\n- $n>1$ 时为它所有子区间的权值之和，也就是 $v(a_0,a_1,\\ldots,a_{n-1})=\\sum\\limits_{i=0}^{n-2}\\sum\\limits_{j=0}^{n-i-1}v(a_j,a_{j+1},\\ldots,a_{j+i})$. \n\n给定一个序列，求出它的的权值，答案对 $998244353$ 取模。\n\n这个序列是这样生成的：输入序列 $b_0,b_1,\\cdots,b_{k-1}$，然后 $a_i=b_{i\\bmod k}$。", "inputFormat": "第一行为 $n,k$，表示序列 $a$ 的长和序列 $b$ 的长。\n\n第二行为 $b_0,b_1,\\cdots,b_{k-1}$，含义见题目描述。", "outputFormat": "一行一个整数，表示序列 $a$ 的权值对 $998244353$ 取余的结果。", "hint": "【样例解释 #1】\n\n生成序列 $a=[3,4,6,3]$，然后：\n- $v(3,4)=v(3)+v(4)=7$\n- $v(4,6)=v(4)+v(6)=10$\n- $v(6,3)=v(6)+v(3)=9$\n- $v(3,4,6)=v(3)+v(4)+v(6)+v(3,4)+v(4,6)=30$\n- $v(4,6,3)=v(4)+v(6)+v(3)+v(4,6)+v(6,3)=32$\n- $v(3,4,6,3)=v(3)+v(4)+v(6)+v(3)+v(3,4)+v(4,6)+v(6,3)+v(3,4,6)+v(4,6,3)=104$\n\n【数据规模与约定】\n\n**本题不使用捆绑测试。**\n\n本题共 $25$ 个测试点，每个测试点 $4$ 分。\n\n|测试点编号|$n\\le$|$k$|\n|:-|:-|:-|\n|$1\\sim 3$|$5000$|无特殊限制|\n|$4\\sim 10$|$10^5$|无特殊限制|\n|$11\\sim 15$|无特殊限制|$=60928$|\n|$16\\sim 25$|无特殊限制|无特殊限制|\n\n对于 $100\\%$ 的数据 : $1\\le n\\le 10^9$，$1 \\le k \\le 10^5$，$0\\le a_i\\le 998244352$。\n\n感谢 $\\rm\\textcolor{black}{J}\\textcolor{red}{ohnVictor}$ 对此题的贡献。", "locale": "zh-CN"}}}
{"pid": "P7343", "type": "P", "difficulty": 2, "samples": [["3 0\n3 2 1", "1 2 3"], ["7 2\n1 3 1 4 5 2 1\n2 4", "1 3 1 4 1 2 5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": [], "title": "【DSOI 2021】电子跃迁", "background": "\n> “如果能证明大统一理论，这个世界将焕然一新。”\\\n“量子……量子……就差一点……”\\\n“嘶……哦。**我想我明白了**。”", "description": "在你的视野下，出现了一排电子，他们分别拥有不同的能量。你需要做的是通过**将相邻电子互换**的方法，将电子排的有序。**有序**是指：能量最小的电子放到最靠近原子核的左边，将第二小的电子放在第二……将能量最大的电子放在最右边。\\\n可是，你发现电子轨道之间忽然出现了 $m$ 个奇怪的力，使位于第 $x_i$ 个位置的电子和位于第 $x_i+1$ 个位置的电子无法进行交换。\n\n你深信这个力将会颠覆当下的物理理论。你需要做的是将现在的一排电子排得**尽量有序**以发现其中规律。\n\n**尽量有序**是指：**在条件下**，能量最小的电子尽量放到左边直至出现屏障，以此类推。\n", "inputFormat": "第一行输入两个整数 $n,m$ ，分别表示电子数量和力的数量。\\\n第二行输入 $n$ 个整数，表示初始电子排列，其中第 $i$ 个数 $a_i$ 代表第 $i$ 个电子拥有的能量。\\\n第三行包含 $m$ 个整数。其中第 $i$ 个整数 $x_i$ 表示位于第 $x_i$ 个位置的电子和位于第 $x_i+1$ 个位置的电子无法进行交换的。\n", "outputFormat": "输出一行 $n$ 个整数，表示在这种情况下尽量有序的排列结果。", "hint": "对于 $10\\%$ 的数据，满足 $m=0$；\\\n对于另 $20\\%$ 的数据，满足 $n \\le 1000,m \\le 100$；\\\n对于 $100\\%$ 的数据，满足 $0 \\le n,m \\le 5 \\times 10^5,1 \\le x_i \\le n-1,1 \\le a_i \\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【DSOI 2021】电子跃迁", "background": "\n> “如果能证明大统一理论，这个世界将焕然一新。”\\\n“量子……量子……就差一点……”\\\n“嘶……哦。**我想我明白了**。”", "description": "在你的视野下，出现了一排电子，他们分别拥有不同的能量。你需要做的是通过**将相邻电子互换**的方法，将电子排的有序。**有序**是指：能量最小的电子放到最靠近原子核的左边，将第二小的电子放在第二……将能量最大的电子放在最右边。\\\n可是，你发现电子轨道之间忽然出现了 $m$ 个奇怪的力，使位于第 $x_i$ 个位置的电子和位于第 $x_i+1$ 个位置的电子无法进行交换。\n\n你深信这个力将会颠覆当下的物理理论。你需要做的是将现在的一排电子排得**尽量有序**以发现其中规律。\n\n**尽量有序**是指：**在条件下**，能量最小的电子尽量放到左边直至出现屏障，以此类推。\n", "inputFormat": "第一行输入两个整数 $n,m$ ，分别表示电子数量和力的数量。\\\n第二行输入 $n$ 个整数，表示初始电子排列，其中第 $i$ 个数 $a_i$ 代表第 $i$ 个电子拥有的能量。\\\n第三行包含 $m$ 个整数。其中第 $i$ 个整数 $x_i$ 表示位于第 $x_i$ 个位置的电子和位于第 $x_i+1$ 个位置的电子无法进行交换的。\n", "outputFormat": "输出一行 $n$ 个整数，表示在这种情况下尽量有序的排列结果。", "hint": "对于 $10\\%$ 的数据，满足 $m=0$；\\\n对于另 $20\\%$ 的数据，满足 $n \\le 1000,m \\le 100$；\\\n对于 $100\\%$ 的数据，满足 $0 \\le n,m \\le 5 \\times 10^5,1 \\le x_i \\le n-1,1 \\le a_i \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P7344", "type": "P", "difficulty": 5, "samples": [["2\n3 2\n1 2 1\n2 2\n2 2\n-1 2\n2 2", "3\n5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["O2优化"], "title": "【DSOI 2021】积木", "background": "\"你听说过死亡游戏吗？就是将你关在一个暗无天日的房间里，给你一些琢磨不透的线索，倘若你不能解决问题，就给予你死亡的馈赠。\n\n“嗯？慌什么，你现在仅仅是在这个不透风的房间里，我所要你回答的，也仅仅是个简单的问题而已。\n\n“有意见吗？那好的，游戏开始。”", "description": "“现在，你所拥有的是若干个棱长均为 $1$ 的正方体积木。而我，游戏的所有者，将会告诉你最终搭成的立体图形的主视图和左视图。你以为要你搭成这样的图形？别慌，游戏还远远没有这么简单。我将在这个图形中将主视图的其中几列给隐藏掉，如此一来，你就无法观察到他们的高度了。\n\n“为了让这个游戏变得更有意思，我规定这些你无法观察到的数列的高度是任意的——这可以由你来决定。\n\n“想必我亲爱的玩家，你小学时便知道，仅有主视图和左视图是无法确定一个图形的形状的，何况还有一部分被我隐藏了。因此，我们记 $k$ 为能够搭出我给出的图形的积木数，请你告诉我，最多有多少个整数 $k$ 能够满足我的要求呢？ ”（即，请你**先自行决定好未知数列的取值**，**再根据这一取值来求出** $k$，你需要先决定高度使 $k$ 能取的值最多）", "inputFormat": "**本题有多组数据。**\\\n第一行输入一个整数 $T$，表示数据组数。\\\n对于每一组数据：\\\n第一行输入两个整数 $n,m$，表示最终积木形状的长和宽。\\\n第二行包含 $n$ 个整数，第 $i$ 个整数 $a_i$ 表示主视图从左至右第 $i$ 列所看到的方块的高度。特别的，若 $a_i=-1$，则表示这一列的高度是任意的。\\\n第三行包含 $m$ 个整数，第 $i$ 个整数 $b_i$ 表示左视图从后至前第 $i$ 列所看到的方块的高度。保证不存在高度未知的列。", "outputFormat": "对于每一组数据，输出一行一个整数，表示最多的能够满足要求的整数 $k$ 的数量。特别的，如果没有满足条件的整数 $k$，输出 $0$。", "hint": "**【样例解释】**\\\n对于第一组数据：\\\n可行的 $k$ 值分别为：$6,7,8$。\n对于每一个 $k$ 值，给出一种可能的构造如下（给出俯视图，数字表示该格的高度）：\n![](https://cdn.luogu.com.cn/upload/image_hosting/t968uvlx.png)\\\n对于第二组数据：\\\n当未知列的高度取 $2$ 时，满足要求的 $k$ 的数量最多，共有 $5$ 个，分别为：$4,5,6,7,8$。\n\n**【数据范围和限制】**\\\n**本题采用捆绑测试。** 你必须通过 Subtask 中所有的测试点才能获得该 Subtask 的分数。\n\n| Subtask | 分值  | $n,m,a_i,b_i \\le$ |               特殊性质                |\n| :-----: | :---: | :---------------: | :-----------------------------------: |\n|    1    | 7pts  |        $3$        |                  无                   |\n|    2    | 8pts  |       $10$        | 保证数列 $a$ 中 $-1$ 的数量不大于 $4$ |\n|    3    | 8pts  |      $1000$       |           保证 $a_i \\ne -1$           |\n|    4    | 12pts |   $2\\times10^4$   |           保证 $a_i \\ne -1$           |\n|    5    | 7pts  |      $1000$       |          保证所有 $b_i$ 相等          |\n|    6    | 8pts  |   $2\\times10^4$   |          保证所有 $b_i$ 相等          |\n|    7    | 15pts |      $1000$       |                  无                   |\n|    8    | 35pts |   $2\\times10^4$   |                  无                   |\n\n对于 $100\\%$ 的数据，满足 $1 \\le n,m \\le 2\\times10^4,-1 \\le a_i \\le 2\\times10^4,0 \\le b_i \\le 2\\times10^4,0 \\le T \\le 100$。\n\n本题读入数据量较大，请用**较快的读入方式**。\n\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【DSOI 2021】积木", "background": "\"你听说过死亡游戏吗？就是将你关在一个暗无天日的房间里，给你一些琢磨不透的线索，倘若你不能解决问题，就给予你死亡的馈赠。\n\n“嗯？慌什么，你现在仅仅是在这个不透风的房间里，我所要你回答的，也仅仅是个简单的问题而已。\n\n“有意见吗？那好的，游戏开始。”", "description": "“现在，你所拥有的是若干个棱长均为 $1$ 的正方体积木。而我，游戏的所有者，将会告诉你最终搭成的立体图形的主视图和左视图。你以为要你搭成这样的图形？别慌，游戏还远远没有这么简单。我将在这个图形中将主视图的其中几列给隐藏掉，如此一来，你就无法观察到他们的高度了。\n\n“为了让这个游戏变得更有意思，我规定这些你无法观察到的数列的高度是任意的——这可以由你来决定。\n\n“想必我亲爱的玩家，你小学时便知道，仅有主视图和左视图是无法确定一个图形的形状的，何况还有一部分被我隐藏了。因此，我们记 $k$ 为能够搭出我给出的图形的积木数，请你告诉我，最多有多少个整数 $k$ 能够满足我的要求呢？ ”（即，请你**先自行决定好未知数列的取值**，**再根据这一取值来求出** $k$，你需要先决定高度使 $k$ 能取的值最多）", "inputFormat": "**本题有多组数据。**\\\n第一行输入一个整数 $T$，表示数据组数。\\\n对于每一组数据：\\\n第一行输入两个整数 $n,m$，表示最终积木形状的长和宽。\\\n第二行包含 $n$ 个整数，第 $i$ 个整数 $a_i$ 表示主视图从左至右第 $i$ 列所看到的方块的高度。特别的，若 $a_i=-1$，则表示这一列的高度是任意的。\\\n第三行包含 $m$ 个整数，第 $i$ 个整数 $b_i$ 表示左视图从后至前第 $i$ 列所看到的方块的高度。保证不存在高度未知的列。", "outputFormat": "对于每一组数据，输出一行一个整数，表示最多的能够满足要求的整数 $k$ 的数量。特别的，如果没有满足条件的整数 $k$，输出 $0$。", "hint": "**【样例解释】**\\\n对于第一组数据：\\\n可行的 $k$ 值分别为：$6,7,8$。\n对于每一个 $k$ 值，给出一种可能的构造如下（给出俯视图，数字表示该格的高度）：\n![](https://cdn.luogu.com.cn/upload/image_hosting/t968uvlx.png)\\\n对于第二组数据：\\\n当未知列的高度取 $2$ 时，满足要求的 $k$ 的数量最多，共有 $5$ 个，分别为：$4,5,6,7,8$。\n\n**【数据范围和限制】**\\\n**本题采用捆绑测试。** 你必须通过 Subtask 中所有的测试点才能获得该 Subtask 的分数。\n\n| Subtask | 分值  | $n,m,a_i,b_i \\le$ |               特殊性质                |\n| :-----: | :---: | :---------------: | :-----------------------------------: |\n|    1    | 7pts  |        $3$        |                  无                   |\n|    2    | 8pts  |       $10$        | 保证数列 $a$ 中 $-1$ 的数量不大于 $4$ |\n|    3    | 8pts  |      $1000$       |           保证 $a_i \\ne -1$           |\n|    4    | 12pts |   $2\\times10^4$   |           保证 $a_i \\ne -1$           |\n|    5    | 7pts  |      $1000$       |          保证所有 $b_i$ 相等          |\n|    6    | 8pts  |   $2\\times10^4$   |          保证所有 $b_i$ 相等          |\n|    7    | 15pts |      $1000$       |                  无                   |\n|    8    | 35pts |   $2\\times10^4$   |                  无                   |\n\n对于 $100\\%$ 的数据，满足 $1 \\le n,m \\le 2\\times10^4,-1 \\le a_i \\le 2\\times10^4,0 \\le b_i \\le 2\\times10^4,0 \\le T \\le 100$。\n\n本题读入数据量较大，请用**较快的读入方式**。\n\n\n", "locale": "zh-CN"}}}
{"pid": "P7345", "type": "P", "difficulty": 5, "samples": [["2\n1 1 0 100\n\n0\n\n0\n\n1\n\n2 1 1 10000\n\n1\n\n1\n\n1\n\n1", "\n\n0 1 1\n\n0 1 -1\n\n0 0 1\n\n1 0 0\n\n0 2 0\n\n0 0 2\n\n0 -2 0\n\n0 0 -2\n\n1 0 0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["交互题", "Special Judge", "O2优化", "分治"], "title": "【DSOI 2021】吟唱的金色花海", "background": "\n**这是一道 IO 交互题。**\n\n在很久很久以前，有一片开满了白色郁金香的花海。某一天，绽放了一朵金色郁金香，从此，这片花海开始了它永生的吟唱……\n\n>   _(Dutch) $\\textit{\\textcolor{blue}{Het\\ universum\\ zingt\\ voor\\ mij!}}$_\n\n", "description": "在某一时刻，在某处出现了一朵金色郁金香。然后接下来每一秒，每朵金色郁金香会向其上下左右四个点中所有白色郁金香吟唱，使其变为金色郁金香。\n\n现在告诉你一个点 $(x_0,y_0)$，以及它自第一朵金色郁金香出现起，刚变成金色郁金香的那一秒 $t$，你需要找出最初出现的金色郁金香的位置。\n\n每次你可以输出一行 `0 x y`,然后程序会返回一个值 $0$ 或 $1$，$0$ 表示 $(x,y)$ 在第 $t$ 秒是白色郁金香， $1$ 表示 $(x,y)$ 在第 $t$ 秒是金色郁金香。\n你可以输出一行 `1 x y` 告知程序最初出现最初出现的金色郁金香的位置为 $(x,y)$ 以结束程序。", "inputFormat": "**本题有多组数据。**\\\n第一行输入一个正整数 $Q$ ,表示有 $Q$ 组数据。\\\n对于每组数据，输入四个整数 $t,x_0,y_0,k$ 开始交互。数据用单个空格隔开，代表第 $t$ 秒时位于 $(x_0,y_0)$ 处的郁金香刚变成了金色。你最多可以询问的次数为 $k$。", "outputFormat": "对于每一组数据，在你确定答案之后，输出一行 `1 x y` 以结束本组数据，代表你判断 $(x,y)$ 是金色郁金香最开始出现的地方。\n\n### 交互格式\n\n交互过程中，用 `0 x y` 的形式输出一行以执行一次操作。然后你应输入一个布尔值，即操作的返回值 $x$。若 $x=0$ ，表示 $(x,y)$ 在第 $t$ 秒是白色郁金香；若 $x=1$ ，表示 $(x,y)$ 在第 $t$ 秒是金色郁金香。\n\n上述的所有输入都应从**标准输入**中读入，所有输出都应向**标准输出**中输出。输出一行后必须**清空缓冲区** ，否则你的评测有可能被判为**Time Limit Exceeded**。清空缓冲区方式如下：\n\n* 在 C++ 中，使用 `fflush(stdout)` 或 `cout.flush()`。\n* 在 Pascal 中，使用 `flush(output)`。\n* 其他语言请自行查阅文档。", "hint": "| 测试点编号 |     $k =$      | $t \\le$ |  $Q=$  |\n| :--------: | :------------: | :-----: | :----: |\n|     1      |    $10000$     |   $1$   | $100$  |\n|    2~3     |    $10000$     |   $5$   | $100$  |\n|    4~6     |      $4t$      |  $100$  | $100$  |\n|    7~10    | $2 \\times MAX$ |  $100$  | $100$  |\n|   11~14    |    $MAX+1$     | $10^4$  | $5000$ |\n|   15~20    |     $MAX$      | $10^4$  | $5000$ |\n\n\n每个测试点的分值均为 $5$ 分。\n\n记:在最劣情况下询问 $MAX=\\lceil\\log_2(t+1)\\rceil+2$ 次一定能得出答案。保证 $1 \\le t \\le 10^4$，$1 \\le Q \\le 5000$ 且得出的结果的 $x,y$ 的绝对值不大于 $10^5$。\n\n***\n\n提示：由于交互题的特性，若你的算法错误，评测结果为 **TLE** 属于正常现象，请将鼠标放在测试点上查看你的具体错误原因。具体的：\n- 若你输出的结果错误，会返回 **You made a mistake in data i!**\n- 若你询问了过多的次数，会返回 **You ask too many times in data i!**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【DSOI 2021】吟唱的金色花海", "background": "\n**这是一道 IO 交互题。**\n\n在很久很久以前，有一片开满了白色郁金香的花海。某一天，绽放了一朵金色郁金香，从此，这片花海开始了它永生的吟唱……\n\n>   _(Dutch) $\\textit{\\textcolor{blue}{Het\\ universum\\ zingt\\ voor\\ mij!}}$_\n\n", "description": "在某一时刻，在某处出现了一朵金色郁金香。然后接下来每一秒，每朵金色郁金香会向其上下左右四个点中所有白色郁金香吟唱，使其变为金色郁金香。\n\n现在告诉你一个点 $(x_0,y_0)$，以及它自第一朵金色郁金香出现起，刚变成金色郁金香的那一秒 $t$，你需要找出最初出现的金色郁金香的位置。\n\n每次你可以输出一行 `0 x y`,然后程序会返回一个值 $0$ 或 $1$，$0$ 表示 $(x,y)$ 在第 $t$ 秒是白色郁金香， $1$ 表示 $(x,y)$ 在第 $t$ 秒是金色郁金香。\n你可以输出一行 `1 x y` 告知程序最初出现最初出现的金色郁金香的位置为 $(x,y)$ 以结束程序。", "inputFormat": "**本题有多组数据。**\\\n第一行输入一个正整数 $Q$ ,表示有 $Q$ 组数据。\\\n对于每组数据，输入四个整数 $t,x_0,y_0,k$ 开始交互。数据用单个空格隔开，代表第 $t$ 秒时位于 $(x_0,y_0)$ 处的郁金香刚变成了金色。你最多可以询问的次数为 $k$。", "outputFormat": "对于每一组数据，在你确定答案之后，输出一行 `1 x y` 以结束本组数据，代表你判断 $(x,y)$ 是金色郁金香最开始出现的地方。\n\n### 交互格式\n\n交互过程中，用 `0 x y` 的形式输出一行以执行一次操作。然后你应输入一个布尔值，即操作的返回值 $x$。若 $x=0$ ，表示 $(x,y)$ 在第 $t$ 秒是白色郁金香；若 $x=1$ ，表示 $(x,y)$ 在第 $t$ 秒是金色郁金香。\n\n上述的所有输入都应从**标准输入**中读入，所有输出都应向**标准输出**中输出。输出一行后必须**清空缓冲区** ，否则你的评测有可能被判为**Time Limit Exceeded**。清空缓冲区方式如下：\n\n* 在 C++ 中，使用 `fflush(stdout)` 或 `cout.flush()`。\n* 在 Pascal 中，使用 `flush(output)`。\n* 其他语言请自行查阅文档。", "hint": "| 测试点编号 |     $k =$      | $t \\le$ |  $Q=$  |\n| :--------: | :------------: | :-----: | :----: |\n|     1      |    $10000$     |   $1$   | $100$  |\n|    2~3     |    $10000$     |   $5$   | $100$  |\n|    4~6     |      $4t$      |  $100$  | $100$  |\n|    7~10    | $2 \\times MAX$ |  $100$  | $100$  |\n|   11~14    |    $MAX+1$     | $10^4$  | $5000$ |\n|   15~20    |     $MAX$      | $10^4$  | $5000$ |\n\n\n每个测试点的分值均为 $5$ 分。\n\n记:在最劣情况下询问 $MAX=\\lceil\\log_2(t+1)\\rceil+2$ 次一定能得出答案。保证 $1 \\le t \\le 10^4$，$1 \\le Q \\le 5000$ 且得出的结果的 $x,y$ 的绝对值不大于 $10^5$。\n\n***\n\n提示：由于交互题的特性，若你的算法错误，评测结果为 **TLE** 属于正常现象，请将鼠标放在测试点上查看你的具体错误原因。具体的：\n- 若你输出的结果错误，会返回 **You made a mistake in data i!**\n- 若你询问了过多的次数，会返回 **You ask too many times in data i!**", "locale": "zh-CN"}}}
{"pid": "P7346", "type": "P", "difficulty": 5, "samples": [["6 10\n1 1 4 5 1 4\n1 1 6\n1 2 8\n4 2\n4 3\n4 4\n4 5 \n4 6\n2 1\n2 3\n2 4", "7\n2\n3"], ["6 10\n2 3 7 1 9 0\n1 1 2\n3 4 10 1 1\n1 3 3\n4 3\n2 5\n2 6\n1 2 8\n4 5\n4 8\n2 6", "9\n0\n9\n9\n8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["O2优化"], "title": "【DSOI 2021】归零", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/i6v3cc0k.png)\n\n能和强欲魔女谈话的机会，对其他人来说是不可多得的 。\n\n进行问答只需要彼此而已，多余的闲功夫就省了吧 ，只有言语就够了 。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/j1octfbj.png)\n\n你的求知欲、好奇心、强欲，我都给予肯定 。\n\n说吧，你想问什么 ？\n\n是关于为振救苍生免于饥饿，违背天命而创造出的野兽 $\\left \\lceil \\right. $ 暴食魔女 $\\left. \\right \\rfloor$ 达芙妮的事吗 ？\n\n是那个打算用爱填满世界，而赐予非人之物情感 $\\left \\lceil \\right. $ 色欲魔女 $\\left. \\right \\rfloor$ 卡蜜拉的事吗？\n\n是一边哀叹着世界充满争斗，却用暴力治愈所有人 $\\left \\lceil \\right. $ 愤怒魔女 $\\left. \\right \\rfloor$ 密涅瓦的事吗？\n\n是仅仅为了追求安稳，就把龙赶到大瀑布彼端 $\\left \\lceil \\right. $ 怠惰魔女 $\\left. \\right \\rfloor$ 塞赫麦特的事吗？\n\n是仗着年幼天真，却毫无慈悲地制裁世人 $\\left \\lceil \\right. $ 傲慢魔女 $\\left. \\right \\rfloor$ 缇丰的事吗？\n\n是为了渴求世上一切智慧，就连死后的世界都舍不得放弃 那位知识欲望的化身 $\\left \\lceil \\right. $ 强欲魔女 $\\left. \\right \\rfloor$ 艾姬多娜的事吗？\n\n还是说，是消灭所有魔女做自己的食粮，并与世界为敌的 $\\left \\lceil \\right. $ 嫉妒魔女 $\\left. \\right \\rfloor$ 那位令人忌讳的 $\\left \\lceil \\right. $ 她 $\\left. \\right \\rfloor$？\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/40odfi8o.png)", "description": "#### （ **若觉得题意不清，请造访 “输入格式” 查看简明化题意。**）\n\n#### （ **请查看题目保证以确保能 solve the problem .**）\n\n我想问的只有 ....\n\n如果我有一串长度为 $n$ 的序列 $a$ ，编号从 $1\\rightarrow n $ , $a_i$ 表示第 $i$ 个数.\n\n我共将进行 $m$ 次四种类型的操作，其编号为给出的顺序 ：\n\n$\\left \\lceil \\right. $ 如果我有 $x$ 、$y$ 两值，我会用阴魔法将序列中所有下标 $i \\equiv 0 \\pmod{x} $ 的 $a_i$  异或上 $y$ 。$\\left. \\right \\rfloor$\n\n$\\left \\lceil \\right. $ 同时我也会三省自身，问问自己序列中 $a_x$ 的值 。$\\left. \\right \\rfloor$\n\n$\\left \\lceil \\right. $ 多次轮回让我明白，只有完美把握住每一次机遇，我才可以占据更大的有利因素。因而我将估量 $a_x$ 和我的预期 $y$ ，如果 $a_x \\le y$ ，我将轮回并执行编号为 $u \\rightarrow v$ 的操作中的 **阴魔法操作** 。$\\left. \\right \\rfloor$\n\n$\\left \\lceil \\right. $ 另外，为了防止遗忘，我还会轮回执行编号为 $x$ 的操作。$\\left. \\right \\rfloor$\n\n你也知道，轮回的存档点是不能交错的，所以我的轮回是不会相交的。\n\n请问你，能否帮我，回答我心中的问答？", "inputFormat": "第一行两个数 $n$ ，$m$ ，表示序列长度和操作数。\\\n第二行 $n$ 个数 $a_i$ ，表示初始序列。\\\n接下来有 $m$ 行，有若干数字，第 $i + 2$ 行表示编号为 $i$ 的操作，第一个数 $op$ 为 $1 \\rightarrow$ 4 的一个 :\n- $op = 1$ : 读入 3 个数 $1$ , $x$ , $y$ , 对 $\\forall$ $i \\equiv 0 \\pmod{x} $（ 也就是 $x$ , $2x$ … $kx $，$k \\in  Z^+ $ 且 $k \\times x \\le n$ ）, $a_i = a_i \\oplus y$（$\\oplus$ 表示异或）。\n- $op = 2$ : 读入 2 个数 $2$ , $x$ ，输出 $a_x$ 。\n- $op = 3$ : 读入 5 个数 $3$ , $x$ , $y$ , $u$ , $v$  , 若 $a_x \\le y$，执行编号为 $u \\rightarrow v$  内所有 $op = 1$ 的操作，否则无视此操作。保证 $u \\le v < i$ 。\n- $op = 4$ : 读入 2 个数 $4$ , $x$ ， 执行编号为 $x$ 的操作。保证 $x < i$ 。\n \n 因为轮回不交错：题目保证，若 $op_i = 3$，**则编号为 $u\\rightarrow i-1$ 的操作，类型一定不为 $3$ or $4$ ；** 同时，若 $op_i = 4$ ，**则编号为 $x+1\\rightarrow i-1$ 的操作，类型一定不为 $3$ or $4$ （ 但是 $x$ 位置可为 $3$ 、 $4$ 类型操作，即可以调用 ）。** \n \n 用数学语言就是：**若 $op_i = 3$ ，则 $[u , i)$ 一定没有 $3$ or $4$ 操作 ; 若 $op_i = 4$ , 则 $(x, i)$ 一定没有 $3$ or $4$ 操作。**", "outputFormat": "输出若干行。\\\n每一行为 $op=2$ 类型操作的询问结果或 $op = 4$ 类型操作调用的询问操作的询问结果。", "hint": "**【对于样例 2，下面给出其每个操作过程中序列的值】**\n\n|操作| $a_1$ | $a_2$ | $a_3$ | $a_4$ | $a_5$ | $a_6$ | 说明 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |:----------:|\n| 无 | 2 | 3 | 7 | 1 | 9 | 0 | 读入 |\n| $1_{st}$ | 0 | 1 | 5 | 3 | 11 |  2  | $1\\rightarrow6$ 都 $xor$ $2$|\n| $2_{nd}$ | 2 | 3 | 7 | 1 | 9 | 0  | $a_4 = 3 \\le 10$ ，进行 $1$ 操作|\n| $3_{rd} $ | 2 | 3 | 4 | 1 | 9 | 3  |$3 $ $/$ $6$ 都 $xor$ 3|\n| $4_{th} $ | 2 | 3 | 7 | 1 | 9 | 0  |$3 $ $/$ $6$ 都 $xor$ 3|\n| $5_{th} $ | 2 | 3 | 7 | 1 | 9 | 0 | 输出 $a_5$|\n| $6_{th} $ | 2 | 3 | 7 | 1 | 9 | 0 | 输出 $a_5$ |\n| $7_{th} $ | 2 | 11 | 7 | 9 | 9 | 8  | $2$ $/$ $4$ $/$ $6$ 都 $xor$ $8$|\n| $8_{th} $ | 2 | 11 | 7 | 9 | 9 | 8  | 输出 $a_5$ |\n| $9_{th} $ | 2 | 11 | 7 | 9 | 9 | 8 | 输出 $a_5$|\n| $10_{th} $ | 2 | 11 | 7 | 9 | 9 | 8 | 输出 $a_6$ |\n\n------------\n\n**【关于“保证”的说明】**\n\n例如一串操作类型为 $op_1  = 1$、$op_2 = 4$、$op_3 = 2$、$op_4 = 3$、$op_5 = 1$、$op_6=4$。那么 $op_4$ 所对应的 $u$、 $v$ 只能为 $u = 3$ 、$v = 3$ ，因为 $u \\le 2$ 会导致其范围内包含 $4$ 操作；而 $op_6$ 所对应的  $x$ 可以是 $4$ 或 $5$ ，因为这样子 $x$ 的右边到编号 $6$ 的左边都没有 $3$ 、$4$ 操作。\n\n------------\n\n **【数据范围】**\\\n**本题采用捆绑测试。** 你必须通过 Subtask 中所有的测试点才能获得该 Subtask 的分数。\n| Subtask | 特殊性质 | 分值 |\n| :----------: | :----------: |:--------:|\n| 1 | 为样例 $2$ | 2 pts|\n| 2 | $n \\le 10$ , $m \\le 10$ | 8 pts |\n| 3 | $n \\le 1000$ , $m \\le 1000 $ | 10 pts |\n| 4 | $n \\le 10^4$ , $m \\le 10^4$ | 10 pts |\n| 5 | $n \\le 10^5 $ , $m \\le 5 \\times 10^5$ , 无操作 $4$ | 10 pts |\n| 6 | $n \\le 10^5 $ , $m \\le 5 \\times 10^5$ , 无操作 $3$ | 10 pts |\n| 7 | $n \\le 10^5 $ , $m \\le 5 \\times 10^5$ , 数据随机 | 18 pts |\n| 8 | $n \\le 10^5 $ , $m \\le 5 \\times 10^5$| 32 pts |\n对于 $100\\%$ 的数据，保证 $1 \\le n \\le 10^5 $ , $m \\le 5 \\times 10^5$，保证过程及结果的所有值都在 int 范围内。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【DSOI 2021】归零", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/i6v3cc0k.png)\n\n能和强欲魔女谈话的机会，对其他人来说是不可多得的 。\n\n进行问答只需要彼此而已，多余的闲功夫就省了吧 ，只有言语就够了 。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/j1octfbj.png)\n\n你的求知欲、好奇心、强欲，我都给予肯定 。\n\n说吧，你想问什么 ？\n\n是关于为振救苍生免于饥饿，违背天命而创造出的野兽 $\\left \\lceil \\right. $ 暴食魔女 $\\left. \\right \\rfloor$ 达芙妮的事吗 ？\n\n是那个打算用爱填满世界，而赐予非人之物情感 $\\left \\lceil \\right. $ 色欲魔女 $\\left. \\right \\rfloor$ 卡蜜拉的事吗？\n\n是一边哀叹着世界充满争斗，却用暴力治愈所有人 $\\left \\lceil \\right. $ 愤怒魔女 $\\left. \\right \\rfloor$ 密涅瓦的事吗？\n\n是仅仅为了追求安稳，就把龙赶到大瀑布彼端 $\\left \\lceil \\right. $ 怠惰魔女 $\\left. \\right \\rfloor$ 塞赫麦特的事吗？\n\n是仗着年幼天真，却毫无慈悲地制裁世人 $\\left \\lceil \\right. $ 傲慢魔女 $\\left. \\right \\rfloor$ 缇丰的事吗？\n\n是为了渴求世上一切智慧，就连死后的世界都舍不得放弃 那位知识欲望的化身 $\\left \\lceil \\right. $ 强欲魔女 $\\left. \\right \\rfloor$ 艾姬多娜的事吗？\n\n还是说，是消灭所有魔女做自己的食粮，并与世界为敌的 $\\left \\lceil \\right. $ 嫉妒魔女 $\\left. \\right \\rfloor$ 那位令人忌讳的 $\\left \\lceil \\right. $ 她 $\\left. \\right \\rfloor$？\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/40odfi8o.png)", "description": "#### （ **若觉得题意不清，请造访 “输入格式” 查看简明化题意。**）\n\n#### （ **请查看题目保证以确保能 solve the problem .**）\n\n我想问的只有 ....\n\n如果我有一串长度为 $n$ 的序列 $a$ ，编号从 $1\\rightarrow n $ , $a_i$ 表示第 $i$ 个数.\n\n我共将进行 $m$ 次四种类型的操作，其编号为给出的顺序 ：\n\n$\\left \\lceil \\right. $ 如果我有 $x$ 、$y$ 两值，我会用阴魔法将序列中所有下标 $i \\equiv 0 \\pmod{x} $ 的 $a_i$  异或上 $y$ 。$\\left. \\right \\rfloor$\n\n$\\left \\lceil \\right. $ 同时我也会三省自身，问问自己序列中 $a_x$ 的值 。$\\left. \\right \\rfloor$\n\n$\\left \\lceil \\right. $ 多次轮回让我明白，只有完美把握住每一次机遇，我才可以占据更大的有利因素。因而我将估量 $a_x$ 和我的预期 $y$ ，如果 $a_x \\le y$ ，我将轮回并执行编号为 $u \\rightarrow v$ 的操作中的 **阴魔法操作** 。$\\left. \\right \\rfloor$\n\n$\\left \\lceil \\right. $ 另外，为了防止遗忘，我还会轮回执行编号为 $x$ 的操作。$\\left. \\right \\rfloor$\n\n你也知道，轮回的存档点是不能交错的，所以我的轮回是不会相交的。\n\n请问你，能否帮我，回答我心中的问答？", "inputFormat": "第一行两个数 $n$ ，$m$ ，表示序列长度和操作数。\\\n第二行 $n$ 个数 $a_i$ ，表示初始序列。\\\n接下来有 $m$ 行，有若干数字，第 $i + 2$ 行表示编号为 $i$ 的操作，第一个数 $op$ 为 $1 \\rightarrow$ 4 的一个 :\n- $op = 1$ : 读入 3 个数 $1$ , $x$ , $y$ , 对 $\\forall$ $i \\equiv 0 \\pmod{x} $（ 也就是 $x$ , $2x$ … $kx $，$k \\in  Z^+ $ 且 $k \\times x \\le n$ ）, $a_i = a_i \\oplus y$（$\\oplus$ 表示异或）。\n- $op = 2$ : 读入 2 个数 $2$ , $x$ ，输出 $a_x$ 。\n- $op = 3$ : 读入 5 个数 $3$ , $x$ , $y$ , $u$ , $v$  , 若 $a_x \\le y$，执行编号为 $u \\rightarrow v$  内所有 $op = 1$ 的操作，否则无视此操作。保证 $u \\le v < i$ 。\n- $op = 4$ : 读入 2 个数 $4$ , $x$ ， 执行编号为 $x$ 的操作。保证 $x < i$ 。\n \n 因为轮回不交错：题目保证，若 $op_i = 3$，**则编号为 $u\\rightarrow i-1$ 的操作，类型一定不为 $3$ or $4$ ；** 同时，若 $op_i = 4$ ，**则编号为 $x+1\\rightarrow i-1$ 的操作，类型一定不为 $3$ or $4$ （ 但是 $x$ 位置可为 $3$ 、 $4$ 类型操作，即可以调用 ）。** \n \n 用数学语言就是：**若 $op_i = 3$ ，则 $[u , i)$ 一定没有 $3$ or $4$ 操作 ; 若 $op_i = 4$ , 则 $(x, i)$ 一定没有 $3$ or $4$ 操作。**", "outputFormat": "输出若干行。\\\n每一行为 $op=2$ 类型操作的询问结果或 $op = 4$ 类型操作调用的询问操作的询问结果。", "hint": "**【对于样例 2，下面给出其每个操作过程中序列的值】**\n\n|操作| $a_1$ | $a_2$ | $a_3$ | $a_4$ | $a_5$ | $a_6$ | 说明 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |:----------:|\n| 无 | 2 | 3 | 7 | 1 | 9 | 0 | 读入 |\n| $1_{st}$ | 0 | 1 | 5 | 3 | 11 |  2  | $1\\rightarrow6$ 都 $xor$ $2$|\n| $2_{nd}$ | 2 | 3 | 7 | 1 | 9 | 0  | $a_4 = 3 \\le 10$ ，进行 $1$ 操作|\n| $3_{rd} $ | 2 | 3 | 4 | 1 | 9 | 3  |$3 $ $/$ $6$ 都 $xor$ 3|\n| $4_{th} $ | 2 | 3 | 7 | 1 | 9 | 0  |$3 $ $/$ $6$ 都 $xor$ 3|\n| $5_{th} $ | 2 | 3 | 7 | 1 | 9 | 0 | 输出 $a_5$|\n| $6_{th} $ | 2 | 3 | 7 | 1 | 9 | 0 | 输出 $a_5$ |\n| $7_{th} $ | 2 | 11 | 7 | 9 | 9 | 8  | $2$ $/$ $4$ $/$ $6$ 都 $xor$ $8$|\n| $8_{th} $ | 2 | 11 | 7 | 9 | 9 | 8  | 输出 $a_5$ |\n| $9_{th} $ | 2 | 11 | 7 | 9 | 9 | 8 | 输出 $a_5$|\n| $10_{th} $ | 2 | 11 | 7 | 9 | 9 | 8 | 输出 $a_6$ |\n\n------------\n\n**【关于“保证”的说明】**\n\n例如一串操作类型为 $op_1  = 1$、$op_2 = 4$、$op_3 = 2$、$op_4 = 3$、$op_5 = 1$、$op_6=4$。那么 $op_4$ 所对应的 $u$、 $v$ 只能为 $u = 3$ 、$v = 3$ ，因为 $u \\le 2$ 会导致其范围内包含 $4$ 操作；而 $op_6$ 所对应的  $x$ 可以是 $4$ 或 $5$ ，因为这样子 $x$ 的右边到编号 $6$ 的左边都没有 $3$ 、$4$ 操作。\n\n------------\n\n **【数据范围】**\\\n**本题采用捆绑测试。** 你必须通过 Subtask 中所有的测试点才能获得该 Subtask 的分数。\n| Subtask | 特殊性质 | 分值 |\n| :----------: | :----------: |:--------:|\n| 1 | 为样例 $2$ | 2 pts|\n| 2 | $n \\le 10$ , $m \\le 10$ | 8 pts |\n| 3 | $n \\le 1000$ , $m \\le 1000 $ | 10 pts |\n| 4 | $n \\le 10^4$ , $m \\le 10^4$ | 10 pts |\n| 5 | $n \\le 10^5 $ , $m \\le 5 \\times 10^5$ , 无操作 $4$ | 10 pts |\n| 6 | $n \\le 10^5 $ , $m \\le 5 \\times 10^5$ , 无操作 $3$ | 10 pts |\n| 7 | $n \\le 10^5 $ , $m \\le 5 \\times 10^5$ , 数据随机 | 18 pts |\n| 8 | $n \\le 10^5 $ , $m \\le 5 \\times 10^5$| 32 pts |\n对于 $100\\%$ 的数据，保证 $1 \\le n \\le 10^5 $ , $m \\le 5 \\times 10^5$，保证过程及结果的所有值都在 int 范围内。", "locale": "zh-CN"}}}
{"pid": "P7347", "type": "P", "difficulty": 6, "samples": [["2 1 2\n0 1", "14"], ["5 7 100\n0 1\n1 2\n2 3\n3 4\n0 4\n0 3\n0 2", "969766107"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [163840, 163840, 163840, 163840, 163840, 163840, 163840, 163840, 163840, 163840, 163840, 163840, 163840, 163840, 163840, 163840, 163840, 163840, 163840, 163840, 163840]}, "tags": ["O2优化"], "title": "「MCOI-04」纯水精灵", "background": "轻策的净水之主——「纯水精灵」洛蒂娅是一个掉水元素角色突破材料的 BOSS。今天你想刷点材料，所以……", "description": "洛蒂娅所在的水面上有 $n$ 块平台，初始时均未沉没。有 $m$ 对不同的平台彼此相连。洛蒂娅与敌人战斗了 $k$ 个回合。每一回合，她可以选择一些未沉没的平台，让这些平台沉没（可以不选，但不可以让全部平台沉没）。然后她会选择最多的平台，满足任意两块选择的平台之间都相连，在每块平台上召唤一种不同的水之幻形。$k$ 回合结束后，洛蒂娅对敌人的伤害就是每回合召唤的水之幻形数量之和。洛蒂娅想知道，对于她的所有不同选择方案，伤害的总和是多少。两种方案被视为不同当且仅当存在一回合，使得两种方案在这一回合沉没的平台不同，而与召唤水之幻形的平台无关。由于答案可能很大，你需要输出它对 $10^9+7$ 取模的结果。\n\n简要题意：给定无自环无重边的无向图，$k$ 回合中每回合可以删去现有点集的任意真子集，求所有方案中每回合后剩下的图最大团大小之和模 $10^9+7$。", "inputFormat": "第一行输入三个整数 $n,m,k$，分别表示平台数，相连的平台对数，回合数。\n\n接下来 $m$ 行每行两个整数 $x,y$，表示 $x$ 号平台和 $y$ 号平台相连。平台从 $0$ 到 $n-1$ 编号。保证没有自环和重边。", "outputFormat": "输出一行一个整数表示答案。", "hint": "#### 样例解释\n\n有五种不同的方案：\n\n- 第一回合让 $0$ 号平台沉没，第二回合不选，伤害是 $1+1=2$。\n- 第一回合让 $1$ 号平台沉没，第二回合不选，伤害是 $1+1=2$。\n- 第一回合不选，第二回合让 $0$ 号平台沉没，伤害是 $2+1=3$。\n- 第一回合不选，第二回合让 $1$ 号平台沉没，伤害是 $2+1=3$。\n- 两回合都不选，伤害是 $2+2=4$。\n\n五种方案的总伤害是 $2+2+3+3+4=14$。\n\n#### 数据范围\n\n本题采用捆绑测试，数据范围符合下表：\n\n| 测试点编号 | $n\\le$ | $k\\le$ | 得分 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $10$ | $1$ | $10$ |\n| $2$ | $16$ | $100$ | $10$ |\n| $3$ | $20$ | $100$ | $20$ |\n| $4$ | $26$ | $1$ | $20$ |\n| $5$ | $26$ | $10^9$ | $20$ |\n| $6$ | $28$ | $10^9$ | $20$ |\n\n对于全部数据，$2\\le n\\le 28$，$1\\le m\\le\\frac{n(n-1)}{2}$，$1\\le k\\le 10^9$。\n\n#### 提示\n\n请注意时空限制。\n\n#### 说明\n \n[Minecraft OI Round 4](https://www.luogu.com.cn/contest/33344) A         \nidea & solution：鏡音リン check：namespace_std\t", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-04」纯水精灵", "background": "轻策的净水之主——「纯水精灵」洛蒂娅是一个掉水元素角色突破材料的 BOSS。今天你想刷点材料，所以……", "description": "洛蒂娅所在的水面上有 $n$ 块平台，初始时均未沉没。有 $m$ 对不同的平台彼此相连。洛蒂娅与敌人战斗了 $k$ 个回合。每一回合，她可以选择一些未沉没的平台，让这些平台沉没（可以不选，但不可以让全部平台沉没）。然后她会选择最多的平台，满足任意两块选择的平台之间都相连，在每块平台上召唤一种不同的水之幻形。$k$ 回合结束后，洛蒂娅对敌人的伤害就是每回合召唤的水之幻形数量之和。洛蒂娅想知道，对于她的所有不同选择方案，伤害的总和是多少。两种方案被视为不同当且仅当存在一回合，使得两种方案在这一回合沉没的平台不同，而与召唤水之幻形的平台无关。由于答案可能很大，你需要输出它对 $10^9+7$ 取模的结果。\n\n简要题意：给定无自环无重边的无向图，$k$ 回合中每回合可以删去现有点集的任意真子集，求所有方案中每回合后剩下的图最大团大小之和模 $10^9+7$。", "inputFormat": "第一行输入三个整数 $n,m,k$，分别表示平台数，相连的平台对数，回合数。\n\n接下来 $m$ 行每行两个整数 $x,y$，表示 $x$ 号平台和 $y$ 号平台相连。平台从 $0$ 到 $n-1$ 编号。保证没有自环和重边。", "outputFormat": "输出一行一个整数表示答案。", "hint": "#### 样例解释\n\n有五种不同的方案：\n\n- 第一回合让 $0$ 号平台沉没，第二回合不选，伤害是 $1+1=2$。\n- 第一回合让 $1$ 号平台沉没，第二回合不选，伤害是 $1+1=2$。\n- 第一回合不选，第二回合让 $0$ 号平台沉没，伤害是 $2+1=3$。\n- 第一回合不选，第二回合让 $1$ 号平台沉没，伤害是 $2+1=3$。\n- 两回合都不选，伤害是 $2+2=4$。\n\n五种方案的总伤害是 $2+2+3+3+4=14$。\n\n#### 数据范围\n\n本题采用捆绑测试，数据范围符合下表：\n\n| 测试点编号 | $n\\le$ | $k\\le$ | 得分 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $10$ | $1$ | $10$ |\n| $2$ | $16$ | $100$ | $10$ |\n| $3$ | $20$ | $100$ | $20$ |\n| $4$ | $26$ | $1$ | $20$ |\n| $5$ | $26$ | $10^9$ | $20$ |\n| $6$ | $28$ | $10^9$ | $20$ |\n\n对于全部数据，$2\\le n\\le 28$，$1\\le m\\le\\frac{n(n-1)}{2}$，$1\\le k\\le 10^9$。\n\n#### 提示\n\n请注意时空限制。\n\n#### 说明\n \n[Minecraft OI Round 4](https://www.luogu.com.cn/contest/33344) A         \nidea & solution：鏡音リン check：namespace_std\t", "locale": "zh-CN"}}}
{"pid": "P7348", "type": "P", "difficulty": 7, "samples": [["9 4 -1\n1 1 2 2 2 3 7 7\n4 7\n7 2\n5 2\n4 8", "1\n0\n0\n1"], ["30 1 -1\n1 2 3 4 5 6 7 7 9 9 11 11 12 13 13 14 17 18 19 20 21 19 23 22 22 25 25 28 29 \n6 30", "2"], ["30 10000 20051130\n1 2 3 4 5 6 7 7 9 9 11 11 12 13 13 14 17 18 19 20 21 19 23 22 22 25 25 28 29", "2 6362"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "O2优化", "树链剖分", "分块"], "title": "「MCOI-04」重型管制巡航机", "background": "这是一个作战部署命令。\n\n我们已经从国家安全局获得了有关敌方重型指挥巡洋舰的部分机密情报。\n\n敌方巡航机的正式名称已被确认为 P-1112 Aigaion。\n\n空中舰队中包含一种 Kottos 中型巡航机负责电子支援，还有一种 Gyges 中型巡航机负责近程防空。\n\nAigaion，作为指挥机，负责一切与巡航导弹相关的事务。\n\n在获得这些情报之后，我们可以草拟一个摧毁 Aigaion 的计划。\n\n仔细听好了。\n\nAigaion 只能在机体前部接受空中加油。\n\n多架加油机必须同时处在 Aigaion 前方才能进行加油作业。\n\n当加油机在 Aigaion 前部进行加油时，Aigaion 的雷达探测能力会暂时削弱。\n\n这里就是关键点了。\n\nAigaion 在进行加油时，其雷达基本完全无法探测在其前方飞行的物体。\n\n如果你们能维持在一个固定航线并在一个特定高度上飞行，你们就能在不被敌军发现的情况下，从空中接近 Aigaion。\n\n所以我们解决掉这只怪物的最佳时机就是它进行空中加油的时候。\n\nAigaion 的预定航线图也包含在这份情报中。\n\n简报结束后，我们将在机库再次检查航线图。\n\n快去准备吧。\n\n…………\n\nGaruda 队，交战！\n\n$$_{{\\frac{\\large\\text{ACE COMBAT }\\Large6}{\\tiny{\\text{F i r e s\\quad O f\\quad L i b e r a t i o n}}}}}\\\\ \\text{Mission 09} \\\\\\Large\\text{Heavy Command Cruiser}\\\\\\tiny -\\ The\\ Dead\\ Sea\\ -$$", "description": "在平面上给定一棵有根树，树根为 $1$，根的深度为 $0$。\n\n对于深度为 $x$ 的节点，其 **纵坐标** 为 $n-x+1$。\n\n对于一个节点的所有子节点，**从左到右按照编号升序排列**。每条边都是一条 **连接两个点的线段**。\n\n每一个叶子节点都有一条 **平行于 $y$ 轴且向 $y$ 轴负方向无限延伸的射线**，根节点有一条 **平行于 $y$ 轴且向 $y$ 轴正方向无限延伸的射线**。\n\n**任意两条线段或射线只在树的节点处相交。**\n\n如果你不理解这个树是怎么画的，可以阅读样例 1 解释。\n\n给定 $q$ 组 $u,v$，你现在要从点 $u$ 开始在平面上自由移动，但是你不能经过除 $u,v$ 以外的任何一个点，且每经过一条线段或射线就会产生 $1$ 的代价。\n\n你的目标是移动到点 $v$，你需要求出移动过程产生的最小代价。", "inputFormat": "由于直接输入会造成巨大的输入量，所以本题采用特殊的输入方式。\n\n给定如下随机数生成器：\n\n```cpp\nnamespace GenHelper\n{\n    unsigned z1,z2,z3,z4,b;\n    unsigned rand_()\n    {\n    b=((z1<<6)^z1)>>13;\n    z1=((z1&4294967294U)<<18)^b;\n    b=((z2<<2)^z2)>>27;\n    z2=((z2&4294967288U)<<2)^b;\n    b=((z3<<13)^z3)>>21;\n    z3=((z3&4294967280U)<<7)^b;\n    b=((z4<<3)^z4)>>12;\n    z4=((z4&4294967168U)<<13)^b;\n    return (z1^z2^z3^z4);\n    }\n}\nvoid srand(unsigned x)\n{using namespace GenHelper;\nz1=x; z2=(~x)^0x233333333U; z3=x^0x1234598766U; z4=(~x)+51;}\nint read()\n{\n    using namespace GenHelper;\n    int a=rand_()&32767;\n    int b=rand_()&32767;\n    return a*32768+b;\n}\n```\n\n第一行三个整数 $n,q,s$。\n\n接下来一行 $n-1$ 个整数描述树的结构。第 $i$ 个数代表 $i+1$ 号节点的父亲的编号 $f_i$。\n\n接下来，如果 $s=-1$，则标准输入中的接下来 $q$ 行每行会有两个空格分隔的整数，代表询问的 $u'$ 和 $v'$；设上一次询问的答案为 $\\text{lastans}$，你真正要处理的询问是 $u=u'\\oplus \\text{lastans}$ 和 $v=v'\\oplus \\text{lastans}$，其中 $\\oplus$ 表示异或运算。如果这是第一次询问，则 $\\text{lastans}=0$。\n\n否则，你需要先调用一次 $(\\text{read}()\\oplus \\text{lastans})\\bmod n+1$ 得到询问的 $u$，再调用一次 $(\\text{read}()\\oplus \\text{lastans})\\bmod n+1$ 得到询问的 $v$。\n\n", "outputFormat": "如果 $s=-1$，则输出 $q$ 行，每行是对应询问的答案。\n\n如果 $s\\geq 0$，则输出两个空格分隔的整数，分别表示所有答案的异或和和所有答案的和。", "hint": "**For the enhanced version, see [P7434](https://www.luogu.com.cn/problem/P7434).**\n\n#### 样例 1 解释\n\n第二次实际是询问 $u=6,v=3$，其他询问都满足 $u'=u,v'=v$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/a98cor2o.png)\n\n- 可以看出，从 $4$ 到 $7$ 需要经过一条线；\n- 从 $6$ 到 $3$ 不需要经过直线；\n- 从 $5$ 到 $2$ 不需要经过直线；\n- 从 $4$ 到 $8$ 需要经过一条线；\n- 故答案分别为 $1,0,0,1$。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（1 pts）：$f_i=i-1$，$s=-1$。\n- Subtask 2（9 pts）：$f_i=1$，$s=-1$。\n- Subtask 3（10 pts）：$n,q\\leq 2\\times 10^3$，$s=-1$。\n- Subtask 4（20 pts）：$f_i=\\left\\lfloor\\dfrac{i}{2}\\right\\rfloor$，$s=-1$。\n- Subtask 5（59 pts）：$s=-1$。\n- Subtask 6（1 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 5\\times 10^5$，$1\\leq q\\leq 5\\times 10^6$，$1\\leq u,v\\leq n$，$1\\leq f_i<i$，$-1\\leq s\\leq 10^9$，且 $s=-1$ 时 $q\\leq 5\\times 10^5$。\n\n**对于 $99\\%$ 的数据，保证 $s=-1$。**\n\n**IO 量可能很大，请选择合适的读入输出方式。**\n\n#### 说明\n\n[Minecraft OI Round 4](https://www.luogu.com.cn/contest/33344) B         \nidea：ClCN solution：ClCN & \\_Guoyh\\_ check：\\_Guoyh\\_\n\n---\n\n你问为什么 MCOI 里面混入了 AC6？  \n很简单，因为 ClCN 不玩 MC。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-04」重型管制巡航机", "background": "这是一个作战部署命令。\n\n我们已经从国家安全局获得了有关敌方重型指挥巡洋舰的部分机密情报。\n\n敌方巡航机的正式名称已被确认为 P-1112 Aigaion。\n\n空中舰队中包含一种 Kottos 中型巡航机负责电子支援，还有一种 Gyges 中型巡航机负责近程防空。\n\nAigaion，作为指挥机，负责一切与巡航导弹相关的事务。\n\n在获得这些情报之后，我们可以草拟一个摧毁 Aigaion 的计划。\n\n仔细听好了。\n\nAigaion 只能在机体前部接受空中加油。\n\n多架加油机必须同时处在 Aigaion 前方才能进行加油作业。\n\n当加油机在 Aigaion 前部进行加油时，Aigaion 的雷达探测能力会暂时削弱。\n\n这里就是关键点了。\n\nAigaion 在进行加油时，其雷达基本完全无法探测在其前方飞行的物体。\n\n如果你们能维持在一个固定航线并在一个特定高度上飞行，你们就能在不被敌军发现的情况下，从空中接近 Aigaion。\n\n所以我们解决掉这只怪物的最佳时机就是它进行空中加油的时候。\n\nAigaion 的预定航线图也包含在这份情报中。\n\n简报结束后，我们将在机库再次检查航线图。\n\n快去准备吧。\n\n…………\n\nGaruda 队，交战！\n\n$$_{{\\frac{\\large\\text{ACE COMBAT }\\Large6}{\\tiny{\\text{F i r e s\\quad O f\\quad L i b e r a t i o n}}}}}\\\\ \\text{Mission 09} \\\\\\Large\\text{Heavy Command Cruiser}\\\\\\tiny -\\ The\\ Dead\\ Sea\\ -$$", "description": "在平面上给定一棵有根树，树根为 $1$，根的深度为 $0$。\n\n对于深度为 $x$ 的节点，其 **纵坐标** 为 $n-x+1$。\n\n对于一个节点的所有子节点，**从左到右按照编号升序排列**。每条边都是一条 **连接两个点的线段**。\n\n每一个叶子节点都有一条 **平行于 $y$ 轴且向 $y$ 轴负方向无限延伸的射线**，根节点有一条 **平行于 $y$ 轴且向 $y$ 轴正方向无限延伸的射线**。\n\n**任意两条线段或射线只在树的节点处相交。**\n\n如果你不理解这个树是怎么画的，可以阅读样例 1 解释。\n\n给定 $q$ 组 $u,v$，你现在要从点 $u$ 开始在平面上自由移动，但是你不能经过除 $u,v$ 以外的任何一个点，且每经过一条线段或射线就会产生 $1$ 的代价。\n\n你的目标是移动到点 $v$，你需要求出移动过程产生的最小代价。", "inputFormat": "由于直接输入会造成巨大的输入量，所以本题采用特殊的输入方式。\n\n给定如下随机数生成器：\n\n```cpp\nnamespace GenHelper\n{\n    unsigned z1,z2,z3,z4,b;\n    unsigned rand_()\n    {\n    b=((z1<<6)^z1)>>13;\n    z1=((z1&4294967294U)<<18)^b;\n    b=((z2<<2)^z2)>>27;\n    z2=((z2&4294967288U)<<2)^b;\n    b=((z3<<13)^z3)>>21;\n    z3=((z3&4294967280U)<<7)^b;\n    b=((z4<<3)^z4)>>12;\n    z4=((z4&4294967168U)<<13)^b;\n    return (z1^z2^z3^z4);\n    }\n}\nvoid srand(unsigned x)\n{using namespace GenHelper;\nz1=x; z2=(~x)^0x233333333U; z3=x^0x1234598766U; z4=(~x)+51;}\nint read()\n{\n    using namespace GenHelper;\n    int a=rand_()&32767;\n    int b=rand_()&32767;\n    return a*32768+b;\n}\n```\n\n第一行三个整数 $n,q,s$。\n\n接下来一行 $n-1$ 个整数描述树的结构。第 $i$ 个数代表 $i+1$ 号节点的父亲的编号 $f_i$。\n\n接下来，如果 $s=-1$，则标准输入中的接下来 $q$ 行每行会有两个空格分隔的整数，代表询问的 $u'$ 和 $v'$；设上一次询问的答案为 $\\text{lastans}$，你真正要处理的询问是 $u=u'\\oplus \\text{lastans}$ 和 $v=v'\\oplus \\text{lastans}$，其中 $\\oplus$ 表示异或运算。如果这是第一次询问，则 $\\text{lastans}=0$。\n\n否则，你需要先调用一次 $(\\text{read}()\\oplus \\text{lastans})\\bmod n+1$ 得到询问的 $u$，再调用一次 $(\\text{read}()\\oplus \\text{lastans})\\bmod n+1$ 得到询问的 $v$。\n\n", "outputFormat": "如果 $s=-1$，则输出 $q$ 行，每行是对应询问的答案。\n\n如果 $s\\geq 0$，则输出两个空格分隔的整数，分别表示所有答案的异或和和所有答案的和。", "hint": "**For the enhanced version, see [P7434](https://www.luogu.com.cn/problem/P7434).**\n\n#### 样例 1 解释\n\n第二次实际是询问 $u=6,v=3$，其他询问都满足 $u'=u,v'=v$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/a98cor2o.png)\n\n- 可以看出，从 $4$ 到 $7$ 需要经过一条线；\n- 从 $6$ 到 $3$ 不需要经过直线；\n- 从 $5$ 到 $2$ 不需要经过直线；\n- 从 $4$ 到 $8$ 需要经过一条线；\n- 故答案分别为 $1,0,0,1$。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（1 pts）：$f_i=i-1$，$s=-1$。\n- Subtask 2（9 pts）：$f_i=1$，$s=-1$。\n- Subtask 3（10 pts）：$n,q\\leq 2\\times 10^3$，$s=-1$。\n- Subtask 4（20 pts）：$f_i=\\left\\lfloor\\dfrac{i}{2}\\right\\rfloor$，$s=-1$。\n- Subtask 5（59 pts）：$s=-1$。\n- Subtask 6（1 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 5\\times 10^5$，$1\\leq q\\leq 5\\times 10^6$，$1\\leq u,v\\leq n$，$1\\leq f_i<i$，$-1\\leq s\\leq 10^9$，且 $s=-1$ 时 $q\\leq 5\\times 10^5$。\n\n**对于 $99\\%$ 的数据，保证 $s=-1$。**\n\n**IO 量可能很大，请选择合适的读入输出方式。**\n\n#### 说明\n\n[Minecraft OI Round 4](https://www.luogu.com.cn/contest/33344) B         \nidea：ClCN solution：ClCN & \\_Guoyh\\_ check：\\_Guoyh\\_\n\n---\n\n你问为什么 MCOI 里面混入了 AC6？  \n很简单，因为 ClCN 不玩 MC。", "locale": "zh-CN"}}}
{"pid": "P7349", "type": "P", "difficulty": 7, "samples": [["2 2\n1\n1 2\n1 2\n1\n1 2", "3"]], "limits": {"time": [8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["O2优化"], "title": "「MCOI-04」Dream and the Multiverse", "background": "[Link](https://youtu.be/tylNqtyj0gs?t=2388)\n\n*I have gone over the scenarios in my head,*\n\n*and there are 6.96969 billion outcomes, and only one of them -*\n\n*- do I win.*", "description": "Dream 将时空抽象为一颗 $n$ 节点有向有根树，其中树根为节点 $1$ 并且所有边的方向都为浅往深。  \nDream 用他的超能力在这颗树上额外添加 $m$ 条有向边，但最终的图仍然是无环图。  \nDream 进而将一个事件抽象为图上的一个节点，将一个时代抽象为图上的一个简单路径。  \nDream 认为一对事件 $(i,j)$ **可行** 当且仅当存在一个时代，使得时代的首事件是 $i$，末事件是 $j$。  \nDream 现在有 $q$ 组询问。第 $i$ 组询问用两个正整数 $l_i$ 与 $r_i$ 表示，其中 $l_i\\le r_i$。  \nDream 想知道，对每一组询问，有多少对 **可行** 事件 $(i,j)$，使得 $i,j\\in[l,r]$。", "inputFormat": "第一行两个整数 $n,m$。    \n接下来一行 $n-1$ 个正整数描述树的结构。第 $i$ 个数代表 $i+1$ 号节点的父亲的编号 $f_i$，也就是说存在一个 $f_i$ 往 $i$ 的一条边。  \n接下来 $m$ 行，每行两个正整数 $u,v$，表示一条 $u$ 往 $v$ 额外添加的边。  \n接下来一个正整数 $q$。  \n接下来 $q$ 行，每行两个正整数 $l,r$，表示一组询问。", "outputFormat": "输出 $q$ 行，每行一个整数，表示对应组询问的答案。", "hint": "#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n - Subtask 1（1 pts）：树形成一条链。\n - Subtask 2（11 pts）：$n,q,m\\le1000$。  \n - Subtask 3（7 pts）：$m\\le 5$。\n - Subtask 4（23 pts）：$n,q,m\\le5\\times10^4$。\n - Subtask 5（17 pts）：$q\\le 10^5$。\n - Subtask 6（41 pts）：没有特殊限制。\n\n对于 $100\\%$ 的数据，$2\\le n\\le 10^5$，$0\\le m\\le10^5$，$1\\le q\\le 10^6$。    \n**保证** 额外添加的边不会形成环，给定的 $f_i$ 形成一颗根为 $1$ 的树。  \n**保证** $l\\le r$。  \n\n#### 说明\n\n[Minecraft OI Round 4](https://www.luogu.com.cn/contest/33344) C      \nidea & solution：w33z8kqrqk8zzzx33 check：ClCN", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-04」Dream and the Multiverse", "background": "[Link](https://youtu.be/tylNqtyj0gs?t=2388)\n\n*I have gone over the scenarios in my head,*\n\n*and there are 6.96969 billion outcomes, and only one of them -*\n\n*- do I win.*", "description": "Dream 将时空抽象为一颗 $n$ 节点有向有根树，其中树根为节点 $1$ 并且所有边的方向都为浅往深。  \nDream 用他的超能力在这颗树上额外添加 $m$ 条有向边，但最终的图仍然是无环图。  \nDream 进而将一个事件抽象为图上的一个节点，将一个时代抽象为图上的一个简单路径。  \nDream 认为一对事件 $(i,j)$ **可行** 当且仅当存在一个时代，使得时代的首事件是 $i$，末事件是 $j$。  \nDream 现在有 $q$ 组询问。第 $i$ 组询问用两个正整数 $l_i$ 与 $r_i$ 表示，其中 $l_i\\le r_i$。  \nDream 想知道，对每一组询问，有多少对 **可行** 事件 $(i,j)$，使得 $i,j\\in[l,r]$。", "inputFormat": "第一行两个整数 $n,m$。    \n接下来一行 $n-1$ 个正整数描述树的结构。第 $i$ 个数代表 $i+1$ 号节点的父亲的编号 $f_i$，也就是说存在一个 $f_i$ 往 $i$ 的一条边。  \n接下来 $m$ 行，每行两个正整数 $u,v$，表示一条 $u$ 往 $v$ 额外添加的边。  \n接下来一个正整数 $q$。  \n接下来 $q$ 行，每行两个正整数 $l,r$，表示一组询问。", "outputFormat": "输出 $q$ 行，每行一个整数，表示对应组询问的答案。", "hint": "#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n - Subtask 1（1 pts）：树形成一条链。\n - Subtask 2（11 pts）：$n,q,m\\le1000$。  \n - Subtask 3（7 pts）：$m\\le 5$。\n - Subtask 4（23 pts）：$n,q,m\\le5\\times10^4$。\n - Subtask 5（17 pts）：$q\\le 10^5$。\n - Subtask 6（41 pts）：没有特殊限制。\n\n对于 $100\\%$ 的数据，$2\\le n\\le 10^5$，$0\\le m\\le10^5$，$1\\le q\\le 10^6$。    \n**保证** 额外添加的边不会形成环，给定的 $f_i$ 形成一颗根为 $1$ 的树。  \n**保证** $l\\le r$。  \n\n#### 说明\n\n[Minecraft OI Round 4](https://www.luogu.com.cn/contest/33344) C      \nidea & solution：w33z8kqrqk8zzzx33 check：ClCN", "locale": "zh-CN"}}}
{"pid": "P7350", "type": "P", "difficulty": 6, "samples": [["257 997\naabdccbabdcdcadbcabcabaabdbbddbaabcadabcbcdacbbaac", "lmzaeccihyailccmzzaxshssgbvjvhthllyofzudraatifnzxy"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["Special Judge", "O2优化"], "title": "「MCOI-04」Dream and Strings", "background": "", "description": "Tommy 的加密系统用了如下的字符串哈希算法：\n\n```cpp\nint Hash(std::string s, int base, int mod) {\n  int result = 0;\n  for(int i=0; i<s.length(); i++)\n    result = (1ll * result * base + s[i]) % mod;\n  return result;\n}\n```\n\n其中 $\\texttt{base}$ 和 $\\texttt{mod}$ 是给定参数，满足 $257\\le\\texttt{base}\\le\\texttt{mod}\\le10^9+9$，并且 $\\texttt{mod}$ 是一个质数。\n\n现在 Dream 要破解 Tommy 的密文，先需要找到一个适合的哈希碰撞。给定 $\\texttt{base}$，$\\texttt{mod}$，和一个字符串 $S$，请找一个一样长度的字符串 $T$ 使得 $|S|=|T|$，$\\texttt{hash(S)=hash(T)}$，但是 $S$ 和 $T$ 有至少一个位置不同。\n\n如果有多个合法的 $T$，输出任意一个即可。", "inputFormat": "第一行，两个正整数 $\\texttt{base}$ 和 $\\texttt{mod}$。  \n第二行，一个由小写字母组成的字符串 $S$。", "outputFormat": "一行，一个由小写字母组成的字符串 $T$，表示答案。", "hint": "#### 数据规模与约定\n\n如果 $S$ 是一个字符串，$|S|$ 是它的长度。 \n\n对于前 $10\\%$ 的数据，$\\texttt{mod}=997$。  \n对于前 $40\\%$ 的数据，$|S|=2\\times10^5$ 并且 $S$ 随机。  \n对于 $100\\%$ 的数据，$50\\le|S|\\le2\\times10^5$，$257\\le\\texttt{base}<\\texttt{mod}\\le10^9+9$，$\\texttt{mod}$ 是一个质数。\n\n#### 说明\n\n[Minecraft OI Round 4](https://www.luogu.com.cn/contest/33344) D          \nidea & solution：w33z8kqrqk8zzzx33 check：MatKave", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-04」Dream and Strings", "background": "", "description": "Tommy 的加密系统用了如下的字符串哈希算法：\n\n```cpp\nint Hash(std::string s, int base, int mod) {\n  int result = 0;\n  for(int i=0; i<s.length(); i++)\n    result = (1ll * result * base + s[i]) % mod;\n  return result;\n}\n```\n\n其中 $\\texttt{base}$ 和 $\\texttt{mod}$ 是给定参数，满足 $257\\le\\texttt{base}\\le\\texttt{mod}\\le10^9+9$，并且 $\\texttt{mod}$ 是一个质数。\n\n现在 Dream 要破解 Tommy 的密文，先需要找到一个适合的哈希碰撞。给定 $\\texttt{base}$，$\\texttt{mod}$，和一个字符串 $S$，请找一个一样长度的字符串 $T$ 使得 $|S|=|T|$，$\\texttt{hash(S)=hash(T)}$，但是 $S$ 和 $T$ 有至少一个位置不同。\n\n如果有多个合法的 $T$，输出任意一个即可。", "inputFormat": "第一行，两个正整数 $\\texttt{base}$ 和 $\\texttt{mod}$。  \n第二行，一个由小写字母组成的字符串 $S$。", "outputFormat": "一行，一个由小写字母组成的字符串 $T$，表示答案。", "hint": "#### 数据规模与约定\n\n如果 $S$ 是一个字符串，$|S|$ 是它的长度。 \n\n对于前 $10\\%$ 的数据，$\\texttt{mod}=997$。  \n对于前 $40\\%$ 的数据，$|S|=2\\times10^5$ 并且 $S$ 随机。  \n对于 $100\\%$ 的数据，$50\\le|S|\\le2\\times10^5$，$257\\le\\texttt{base}<\\texttt{mod}\\le10^9+9$，$\\texttt{mod}$ 是一个质数。\n\n#### 说明\n\n[Minecraft OI Round 4](https://www.luogu.com.cn/contest/33344) D          \nidea & solution：w33z8kqrqk8zzzx33 check：MatKave", "locale": "zh-CN"}}}
{"pid": "P7351", "type": "P", "difficulty": 7, "samples": [["5 600\n0 5 1 4\n2 3 2 2\n0 4 0 4\n1 7 4 7\n4 6 1 3\n4 2 2 4\n2 3 0 7\n0 3 2 1\n4 4 2 1\n2 3 0 6\n4 5 0 3\n1 2 4 6\n2 0 1 4\n1 6 2 3\n2 2 0 6\n4 3 1 7\n3 6 2 5\n3 0 2 6\n3 7 1 7\n1 2 2 2\n1 7 3 7\n2 6 4 2\n3 0 2 3\n1 1 2 0\n2 1 2 3\n0 5 3 3\n4 0 1 1\n0 5 3 7\n2 6 0 4\n3 1 4 3\n1 1 2 5\n3 6 0 2\n0 4 3 1\n1 7 2 4\n3 4 3 3\n1 0 3 7\n3 5 0 2\n0 4 0 1\n3 0 3 6\n4 2 0 5\n3 3 1 7\n1 5 2 3\n4 5 0 0\n3 0 1 5\n1 5 0 3\n2 0 2 1\n2 6 3 6\n2 4 3 2\n1 2 2 5\n2 1 0 5\n1 2 4 1\n2 7 4 6\n0 5 0 6\n3 6 2 2\n1 7 1 7\n0 1 4 4\n1 6 0 2\n1 6 1 0\n1 4 0 7\n0 7 4 5\n0 4 2 1\n3 7 0 7\n3 0 2 1\n3 3 3 6\n0 2 1 0\n0 6 2 2\n4 1 2 0\n2 7 1 6\n1 0 2 1\n4 3 3 0\n0 7 3 5\n1 3 3 5\n3 0 4 0\n4 6 1 4\n2 3 2 7\n1 0 3 2\n0 3 3 7\n0 2 1 2\n3 1 0 6\n0 1 2 7\n3 4 3 0\n4 7 3 6\n2 5 4 3\n3 4 0 7\n2 0 0 2\n1 4 1 6\n0 7 0 3\n2 4 2 4\n2 2 2 1\n4 2 0 4\n2 7 3 4\n4 6 0 6\n2 4 0 4\n2 2 1 1\n4 7 0 1\n4 0 1 0\n1 1 1 1\n3 4 2 4\n0 4 1 0\n0 0 0 3\n3 3 2 5\n1 0 4 0\n3 3 2 1\n3 7 4 6\n0 1 1 2\n3 4 0 3\n1 1 2 7\n2 7 1 7\n1 5 4 4\n4 4 3 0\n2 2 0 3\n0 1 0 6\n1 2 2 0\n0 4 0 5\n3 0 0 2\n3 6 2 7\n1 4 2 1\n1 6 3 7\n3 1 2 5\n2 0 1 3\n1 6 3 6\n2 1 0 4\n4 5 3 5\n4 4 3 2\n2 5 2 1\n3 6 1 0\n4 4 0 3\n2 0 0 7\n2 4 1 4\n3 4 2 0\n3 6 0 7\n0 5 1 5\n0 3 0 1\n1 2 3 0\n0 1 2 4\n4 5 2 7\n1 5 4 0\n0 4 2 3\n0 7 3 1\n2 5 0 1\n3 1 2 3\n2 6 2 5\n2 1 3 2\n3 1 2 6\n0 2 4 5\n2 7 4 1\n0 0 4 7\n1 6 1 7\n4 4 3 7\n1 5 3 7\n2 3 0 5\n3 0 1 4\n3 0 4 6\n2 5 4 2\n2 7 2 3\n0 1 2 6\n1 7 0 2\n1 1 4 6\n3 0 0 4\n2 5 3 0\n4 6 0 0\n2 4 2 3\n0 3 4 1\n4 5 4 5\n1 5 4 3\n0 5 4 1\n0 3 0 4\n4 5 3 0\n3 2 1 4\n2 6 2 2\n0 6 3 6\n4 2 1 0\n2 1 2 0\n3 4 4 7\n2 1 2 1\n0 5 2 4\n2 7 4 3\n4 7 1 6\n3 6 0 3\n0 1 3 4\n2 6 2 4\n2 2 2 3\n4 5 1 5\n1 4 0 6\n2 6 4 1\n2 0 2 7\n4 5 2 4\n2 7 4 4\n3 7 3 2\n2 5 1 2\n0 2 4 1\n4 7 3 4\n0 1 1 3\n4 1 1 6\n1 1 1 4\n2 7 1 2\n1 4 0 0\n2 0 4 2\n0 3 2 7\n2 5 2 6\n0 5 4 4\n4 0 2 3\n2 4 0 3\n4 5 2 1\n4 4 4 0\n2 5 3 6\n3 1 4 5\n1 6 4 7\n0 2 3 4\n0 1 4 7\n1 5 3 4\n0 6 1 0\n2 7 2 2\n0 4 2 4\n4 2 2 7\n4 5 2 3\n0 3 1 1\n0 3 4 0\n0 4 2 7\n0 3 2 0\n3 0 1 7\n0 1 1 1\n3 4 0 4\n2 3 1 6\n4 4 0 2\n4 2 2 5\n4 4 4 5\n1 1 2 4\n1 1 0 1\n0 7 2 5\n0 5 1 3\n3 2 4 6\n4 0 0 4\n3 1 3 2\n2 3 1 2\n0 1 1 5\n4 5 3 7\n2 0 3 3\n0 2 0 3\n1 5 3 1\n1 4 2 4\n1 5 1 1\n1 0 1 4\n0 7 2 1\n0 5 0 2\n3 4 1 3\n1 7 3 0\n3 3 4 5\n3 5 4 2\n3 4 3 6\n3 4 3 7\n3 4 3 4\n1 7 2 3\n4 4 4 2\n1 7 4 4\n1 3 1 6\n4 3 4 2\n1 5 2 1\n1 5 2 2\n2 5 4 5\n1 5 2 4\n3 6 0 5\n3 2 0 6\n4 4 1 4\n4 0 4 0\n0 4 4 3\n2 4 3 5\n4 1 3 6\n2 4 4 3\n4 3 2 0\n3 5 3 1\n1 7 0 6\n0 2 4 7\n3 0 0 3\n1 4 0 2\n4 5 1 7\n3 1 0 4\n0 1 0 2\n4 1 1 3\n0 3 3 3\n2 2 4 2\n4 3 4 1\n4 5 2 0\n1 6 2 6\n1 1 2 1\n4 6 2 2\n1 7 2 0\n0 4 3 0\n0 3 2 5\n2 2 3 0\n3 6 2 3\n0 7 3 3\n0 5 0 4\n3 7 1 5\n4 5 0 5\n4 1 0 4\n1 7 0 7\n3 4 1 7\n0 0 2 5\n1 3 3 0\n2 1 3 0\n2 6 0 3\n0 5 1 7\n0 6 1 6\n1 1 0 5\n2 7 2 5\n0 3 4 5\n4 0 3 1\n3 2 1 0\n2 6 0 2\n1 4 3 7\n1 6 2 5\n1 4 4 4\n3 5 4 4\n1 1 4 3\n2 1 1 3\n4 2 1 7\n4 6 1 0\n1 0 3 4\n1 1 3 1\n1 6 0 6\n3 7 1 1\n0 0 2 4\n4 0 1 5\n0 2 2 2\n2 0 1 5\n1 0 4 5\n3 0 1 2\n0 1 0 1\n0 3 0 2\n4 7 3 2\n4 4 3 3\n1 5 4 7\n2 2 0 2\n2 4 0 7\n4 1 1 4\n4 5 4 2\n4 4 1 1\n1 7 1 2\n3 2 3 5\n3 6 1 7\n4 1 2 2\n1 1 3 5\n3 1 2 4\n3 1 4 0\n4 6 0 5\n1 5 3 5\n3 1 2 1\n3 0 3 4\n4 4 4 4\n1 5 1 0\n4 0 4 3\n1 4 3 3\n4 7 4 0\n4 5 4 1\n1 5 3 2\n0 6 0 1\n0 6 3 7\n1 3 1 4\n4 0 1 4\n2 1 3 3\n4 1 2 6\n1 0 1 3\n4 7 0 4\n0 0 0 0\n2 5 1 0\n2 3 0 0\n1 6 1 2\n0 2 0 5\n3 7 4 5\n2 3 1 4\n2 3 3 1\n0 2 3 1\n4 7 3 0\n4 5 4 0\n3 3 4 7\n3 4 0 2\n2 7 4 2\n3 0 4 7\n3 0 0 0\n0 4 4 7\n1 4 3 5\n1 1 4 2\n2 3 1 0\n1 0 0 2\n1 1 1 0\n3 5 4 3\n0 6 4 3\n4 4 0 5\n4 4 1 0\n4 3 1 2\n2 4 4 0\n0 5 4 0\n0 0 4 1\n4 2 3 7\n4 5 2 5\n3 7 1 4\n2 1 0 6\n3 1 0 5\n1 3 2 7\n1 3 4 7\n1 4 2 5\n4 4 1 7\n1 1 4 0\n0 5 4 2\n3 3 1 6\n3 1 0 3\n1 3 4 1\n1 2 3 1\n2 1 3 5\n0 0 1 7\n3 4 2 2\n3 6 1 5\n2 7 2 7\n3 5 1 5\n0 4 0 6\n3 2 4 7\n0 6 1 4\n1 0 0 7\n3 1 2 0\n2 3 4 0\n3 1 0 1\n3 3 2 0\n3 5 4 0\n4 7 0 2\n1 2 1 0\n1 6 2 0\n4 2 1 1\n0 0 1 1\n1 0 1 1\n3 7 3 6\n2 4 0 1\n1 2 2 7\n4 3 4 5\n4 2 4 6\n3 7 3 7\n0 7 3 7\n4 5 3 3\n2 6 1 5\n0 3 0 6\n4 7 4 7\n4 0 4 5\n3 4 1 5\n0 2 0 7\n4 1 3 5\n0 5 3 0\n0 5 4 5\n1 0 2 6\n0 4 2 5\n1 3 0 3\n1 5 0 2\n0 0 4 5\n3 3 0 5\n3 2 3 1\n4 1 1 0\n2 4 4 1\n0 6 4 1\n1 1 2 3\n4 6 4 3\n0 5 0 0\n0 4 0 2\n2 3 0 4\n4 7 1 5\n1 6 0 5\n1 7 4 2\n0 2 0 4\n3 5 3 0\n4 6 4 1\n4 6 3 1\n0 0 1 6\n4 2 1 6\n3 1 1 4\n4 7 1 3\n1 6 4 0\n2 5 2 3\n0 2 2 1\n3 7 2 0\n1 0 4 7\n3 5 3 4\n0 0 4 6\n1 7 1 1\n3 5 4 5\n3 3 3 7\n2 2 2 7\n4 2 4 3\n3 6 4 0\n3 5 3 6\n4 6 1 5\n2 7 0 3\n3 3 4 4\n4 2 3 4\n3 1 1 3\n2 0 4 0\n2 3 2 1\n1 7 4 0\n2 3 2 4\n0 4 1 2\n1 7 1 4\n2 6 3 4\n1 3 2 4\n1 4 2 3\n1 4 1 2\n2 0 2 5\n0 7 1 0\n2 7 0 1\n4 1 3 0\n4 1 1 5\n3 1 3 6\n4 4 2 3\n3 0 0 1\n2 4 4 5\n3 1 1 2\n4 3 1 6\n4 0 3 5\n2 4 1 0\n1 3 4 4\n1 1 1 2\n2 6 4 0\n0 6 4 4\n1 0 4 4\n0 4 3 4\n4 5 1 2\n1 1 4 7\n3 2 2 5\n4 7 1 2\n3 7 0 0\n4 4 4 1\n2 7 1 3\n1 0 0 1\n2 1 4 7\n2 0 0 5\n4 6 2 3\n2 5 0 7\n1 6 3 3\n2 6 1 7\n0 1 2 1\n0 7 0 0\n2 1 0 3\n3 0 3 5\n4 3 0 4\n4 3 3 7\n2 6 2 1\n2 4 1 1\n2 3 4 5\n4 3 0 1\n2 2 0 4\n3 0 1 3\n1 2 1 3\n1 7 0 3\n3 3 0 0\n0 6 0 7\n3 1 3 0\n3 6 2 6\n1 1 1 3\n0 5 2 7\n0 0 2 3\n4 0 2 0\n0 1 1 4\n0 4 1 6\n2 2 2 4\n2 0 3 6\n0 5 1 0\n4 1 1 1\n3 6 3 4\n4 3 3 2\n2 3 2 5\n3 1 2 2\n4 0 3 0\n1 3 0 4\n0 7 1 6\n0 1 1 0\n2 6 1 0\n4 2 4 7\n0 0 4 0\n2 5 0 6\n3 5 2 7\n3 2 3 6\n0 0 3 5\n1 2 0 2\n1 0 4 6\n1 4 4 0\n3 4 1 0\n0 5 2 1\n1 3 2 1\n4 7 0 6\n4 3 1 1\n0 6 1 1\n2 2 3 1\n2 2 1 0\n0 2 3 7\n2 0 2 4\n4 4 4 6\n3 4 2 6\n1 0 0 5\n4 0 1 3\n3 4 1 2\n2 1 2 4\n1 3 3 7\n2 1 1 1\n0 0 2 6", "23333"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["提交答案", "Special Judge", "O2优化"], "title": "「MCOI-04」Dream SMP", "background": "**本题为提交答案题。**\n\n链接：https://pan.baidu.com/s/1D3ytb0626EKZ_emw3gLwVQ          \n提取码：inbj ", "description": "Dream SMP 可以看做 $n$ 个编号为 $0,1,\\dots,n-1$ 的地区。  \nDream 希望将这 $n$ 个地区划分为 $8$ 个编号为 $0,1,\\dots,7$ 的国家。每一个地区都所在恰好一个国家，但国家可以不包含任何地区。  \n地区提出 $m$ 组对划分方案的条件，其中第 $i$ 组条件用四个参数 $(u_i,a_i,v_i,b_i)$ 表示。某个划分方案合法当且仅当对所有条件，$u_i$ 号地区不属于 $a_i$ 号国家 **或者** $v_i$ 号地区不属于 $b_i$ 号国家。这里 **或者** 是逻辑或。  \nDream 保证存在至少一个合法划分方案，请你构造一个合法划分方案。", "inputFormat": "第一行两个正整数 $n$ 和 $m$。  \n接下来 $m$ 行，每行四个正整数 $u_i,a_i,v_i,b_i$。", "outputFormat": "输出一个长度为 $n$ 的字符串。  \n字符串的第 $i$ 位为 $i$ 号地区所属的国家。", "hint": "#### 样例 1 解释\n\n23322，23332，23333 均是合法方案。\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1 \\le n\\le10^5$，$1 \\le m\\le10^6$。  \n具体特性请自行参考输入数据。\n\n[点击下载输入数据。](https://gitee.com/w33z8kqrqk8zzzx33/dream-oi-extra/raw/master/down.zip)\n\n如果上面这个下载不了看下面这个：\n\n链接：https://pan.baidu.com/s/1D3ytb0626EKZ_emw3gLwVQ          \n提取码：inbj \n\n#### 说明\n\n[Minecraft OI Round 4](https://www.luogu.com.cn/contest/33344) Extra         \nidea & solution：w33z8kqrqk8zzzx33 check：tiger2005", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-04」Dream SMP", "background": "**本题为提交答案题。**\n\n链接：https://pan.baidu.com/s/1D3ytb0626EKZ_emw3gLwVQ          \n提取码：inbj ", "description": "Dream SMP 可以看做 $n$ 个编号为 $0,1,\\dots,n-1$ 的地区。  \nDream 希望将这 $n$ 个地区划分为 $8$ 个编号为 $0,1,\\dots,7$ 的国家。每一个地区都所在恰好一个国家，但国家可以不包含任何地区。  \n地区提出 $m$ 组对划分方案的条件，其中第 $i$ 组条件用四个参数 $(u_i,a_i,v_i,b_i)$ 表示。某个划分方案合法当且仅当对所有条件，$u_i$ 号地区不属于 $a_i$ 号国家 **或者** $v_i$ 号地区不属于 $b_i$ 号国家。这里 **或者** 是逻辑或。  \nDream 保证存在至少一个合法划分方案，请你构造一个合法划分方案。", "inputFormat": "第一行两个正整数 $n$ 和 $m$。  \n接下来 $m$ 行，每行四个正整数 $u_i,a_i,v_i,b_i$。", "outputFormat": "输出一个长度为 $n$ 的字符串。  \n字符串的第 $i$ 位为 $i$ 号地区所属的国家。", "hint": "#### 样例 1 解释\n\n23322，23332，23333 均是合法方案。\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1 \\le n\\le10^5$，$1 \\le m\\le10^6$。  \n具体特性请自行参考输入数据。\n\n[点击下载输入数据。](https://gitee.com/w33z8kqrqk8zzzx33/dream-oi-extra/raw/master/down.zip)\n\n如果上面这个下载不了看下面这个：\n\n链接：https://pan.baidu.com/s/1D3ytb0626EKZ_emw3gLwVQ          \n提取码：inbj \n\n#### 说明\n\n[Minecraft OI Round 4](https://www.luogu.com.cn/contest/33344) Extra         \nidea & solution：w33z8kqrqk8zzzx33 check：tiger2005", "locale": "zh-CN"}}}
{"pid": "P7352", "type": "P", "difficulty": 6, "samples": [["3 2\n1 1 0\n2\n2 0 2 1\n1 1 1\n0", "2 2 1"], ["3 2\n1 1 1\n1\n3 0 1 2 1\n0", "2 2 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384]}, "tags": [], "title": "炉心融解", "background": "2020-2021 国家集训队自选题", "description": "你叫了 $n$ 个人来玩游戏。$n$ 个人从 $0$ 到 $n-1$ 编号，按顺序坐成一圈，$0$ 号与 $n-1$ 号相邻。\n\n你给这 $n$ 个人每人发了一张写着数字 $\\texttt{0}$ 或 $\\texttt{1}$ 的卡片。每个人都可以看到**除了相邻的两个人以外**所有人的卡片数字，也可以看到自己的。\n\n游戏共进行 $m$ 回合。第 $i$ 回合你会向所有人公布 $k_i$ 条信息，信息的格式都是“某个集合里存在某种数字的卡片”。公布完之后：\n\n- 如果某个人手里的卡片写着 $\\texttt 0$，且他可以通过推断确定相邻的两个人卡片数字**逻辑或**的值，他就必须大喊“Meltdown！”。\n- 如果某个人手里的卡片写着 $\\texttt 1$，且他可以通过推断确定相邻的两个人卡片数字**逻辑异或**的值，他就必须大喊“Meltdown！”。\n\n所有人都清楚游戏规则，且都有极强的推断能力，只要依据他已有的信息能够推断出来他就必须要喊。喊话是所有人同时喊，不可以听别人喊完了再继续推断。然后本回合结束，进入下一回合。\n\n除此之外这 $n$ 个人没有任何信息交流。现在给出每个人的卡片数字和你公布的所有信息，求每个人第一次喊出“Meltdown！”是在第几回合。", "inputFormat": "输入的第一行包括两个正整数 $n,m$，表示人数和回合数。第二行 $n$ 个整数，分别表示编号 $0$ 到 $n-1$ 的人的卡片上的数字。接下来包括 $m$ 个部分，第 $i$ 部分描述了第 $i$ 回合你公布的信息。\n\n第 $i$ 部分的第一行包括一个非负整数 $k_i$，表示第 $i$ 回合公布的信息条数。接下来 $k_i$ 行，每行第一个正整数 $p$，表示集合的人数，接下来 $p$ 个互不相同的整数表示集合里所有人的编号。最后一个整数 $c$，表示这个集合里存在数字为 $c$ 的卡片。数据保证这些信息是正确的。", "outputFormat": "输出包括一行 $n$ 个整数，分别表示编号 $0$ 到 $n-1$ 的人第一次喊出“Meltdown！”时的回合数。如果他自始自终都没有喊“Meltdown！”，这个数输出 $-1$。", "hint": "对于 $100\\%$ 的数据，$3\\le n\\le 16$，$\\ 1\\le m\\le 100$，$0\\le \\sum k\\le 2\\times 10^3$。", "locale": "zh-CN", "translations": {"en": {"title": "Core Meltdown", "background": "2020-2021 CTT optional problem.", "description": "You invited $n$ people to play a game. The $n$ people are numbered from $0$ to $n-1$, and they sit in a circle in order, where person $0$ is adjacent to person $n-1$.\n\nYou give each of these $n$ people a card with a number $\\texttt{0}$ or $\\texttt{1}$ written on it. Everyone can see the numbers on all cards **except those of the two adjacent people**, and they can also see their own card.\n\nThe game lasts for $m$ rounds. In round $i$, you announce $k_i$ pieces of information to everyone. Each piece of information is in the form: “In a certain set, there exists a card with some number.” After the announcements:\n\n- If someone holds a card with $\\texttt 0$, and they can deduce the value of the **logical OR** of the two adjacent people’s card numbers, then they must shout “Meltdown!”.\n- If someone holds a card with $\\texttt 1$, and they can deduce the value of the **logical XOR** of the two adjacent people’s card numbers, then they must shout “Meltdown!”.\n\nEveryone knows the rules, and everyone has extremely strong reasoning ability: as long as they can deduce it from the information they already have, they must shout. Shouting happens simultaneously; they cannot wait to hear others shout and then continue reasoning. Then this round ends and the next round begins.\n\nOther than this, these $n$ people have no communication at all. Now you are given everyone’s card numbers and all the information you announced. Find in which round each person shouts “Meltdown!” for the first time.", "inputFormat": "The first line contains two positive integers $n,m$, representing the number of people and the number of rounds. The second line contains $n$ integers, representing the card numbers of people numbered $0$ to $n-1$. Then there are $m$ parts; part $i$ describes the information you announce in round $i$.\n\nThe first line of part $i$ contains a non-negative integer $k_i$, representing the number of pieces of information announced in round $i$. The next $k_i$ lines each start with a positive integer $p$, representing the size of the set, followed by $p$ distinct integers representing the IDs of all people in the set. The last integer is $c$, meaning that within this set, there exists a card whose number is $c$. The data guarantees that this information is correct.", "outputFormat": "Output one line with $n$ integers, where the $i$-th integer represents the round number when person $i$ shouts “Meltdown!” for the first time. If they never shout “Meltdown!” throughout the whole game, output $-1$ for that person.", "hint": "For $100\\%$ of the data, $3\\le n\\le 16$，$\\ 1\\le m\\le 100$，$0\\le \\sum k\\le 2\\times 10^3$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "炉心融解", "background": "2020-2021 国家集训队自选题", "description": "你叫了 $n$ 个人来玩游戏。$n$ 个人从 $0$ 到 $n-1$ 编号，按顺序坐成一圈，$0$ 号与 $n-1$ 号相邻。\n\n你给这 $n$ 个人每人发了一张写着数字 $\\texttt{0}$ 或 $\\texttt{1}$ 的卡片。每个人都可以看到**除了相邻的两个人以外**所有人的卡片数字，也可以看到自己的。\n\n游戏共进行 $m$ 回合。第 $i$ 回合你会向所有人公布 $k_i$ 条信息，信息的格式都是“某个集合里存在某种数字的卡片”。公布完之后：\n\n- 如果某个人手里的卡片写着 $\\texttt 0$，且他可以通过推断确定相邻的两个人卡片数字**逻辑或**的值，他就必须大喊“Meltdown！”。\n- 如果某个人手里的卡片写着 $\\texttt 1$，且他可以通过推断确定相邻的两个人卡片数字**逻辑异或**的值，他就必须大喊“Meltdown！”。\n\n所有人都清楚游戏规则，且都有极强的推断能力，只要依据他已有的信息能够推断出来他就必须要喊。喊话是所有人同时喊，不可以听别人喊完了再继续推断。然后本回合结束，进入下一回合。\n\n除此之外这 $n$ 个人没有任何信息交流。现在给出每个人的卡片数字和你公布的所有信息，求每个人第一次喊出“Meltdown！”是在第几回合。", "inputFormat": "输入的第一行包括两个正整数 $n,m$，表示人数和回合数。第二行 $n$ 个整数，分别表示编号 $0$ 到 $n-1$ 的人的卡片上的数字。接下来包括 $m$ 个部分，第 $i$ 部分描述了第 $i$ 回合你公布的信息。\n\n第 $i$ 部分的第一行包括一个非负整数 $k_i$，表示第 $i$ 回合公布的信息条数。接下来 $k_i$ 行，每行第一个正整数 $p$，表示集合的人数，接下来 $p$ 个互不相同的整数表示集合里所有人的编号。最后一个整数 $c$，表示这个集合里存在数字为 $c$ 的卡片。数据保证这些信息是正确的。", "outputFormat": "输出包括一行 $n$ 个整数，分别表示编号 $0$ 到 $n-1$ 的人第一次喊出“Meltdown！”时的回合数。如果他自始自终都没有喊“Meltdown！”，这个数输出 $-1$。", "hint": "对于 $100\\%$ 的数据，$3\\le n\\le 16$，$\\ 1\\le m\\le 100$，$0\\le \\sum k\\le 2\\times 10^3$。", "locale": "zh-CN"}}}
{"pid": "P7353", "type": "P", "difficulty": 7, "samples": [["8 10 3\n1 2\n2 3\n3 4\n4 1\n6 4\n5 6\n6 7\n8 7\n8 5\n8 6\n6 4\n4 5\n5 7\n", "No\nYes\nNo\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2020"], "title": "[2020-2021 集训队作业] Tom & Jerry", "background": "自选题 by ix35\n\n2025/10/15：添加一组 [hack 数据](https://www.luogu.com.cn/ticket/BTVX280196)，位于 Subtask 0。", "description": "给定一张包含 $n$ 个顶点和 $m$ 条边的 **无向连通图**，Tom 和 Jerry 在图上进行了 $q$ 次追逐游戏。\n\n在第 $i$ 次游戏中，Tom 一开始位于顶点 $a_i$，而 Jerry 一开始位于顶点 $b_i$（双方任何时候都知道自己和对方的位置），追逐规则如下：\n\n- Jerry 和 Tom 交替行动，Jerry 先行动。\n\n- Jerry 每次行动可以通过无向图中的 **任意多条边**（可以选择不移动），但是在移动过程中不能经过 Tom 当前所在的结点，否则就会被抓住。\n\n- Tom 每次行动只能通过无向图中的 **至多一条边**（可以选择不移动）。\n\n- 如果 Tom 在一次行动后到达了 Jerry 的位置，那么 Tom 胜利。\n\nTom 尽量想要胜利，而 Jerry 会尽量阻止 Tom 胜利。\n\n现在你需要对于每一局游戏，求出 Tom 是否一定能在有限次行动内获胜。", "inputFormat": "第 $1$ 行：三个整数 $n,m,q$，分别表示无向连通图的点数，边数以及游戏的次数。\n\n接下来 $m$ 行：每行两个整数 $x,y$，描述图中的一条无向边。\n\n接下来 $q$ 行：每行两个整数 $a,b$，表示一局游戏中双方的初始位置。", "outputFormat": "共 $q$ 行：对于每局游戏，如果 Tom 可以在有限个回合内获胜则输出 `Yes`，否则输出 `No`。", "hint": "【样例解释】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/gg8gk6fw.png)\n\n第一组询问中，$a_1=6,\\ b_1=4$，则 Jerry 先走到 $2$ 处，此后每一回合，若 Tom 行动完后与 Jerry 相邻，Jerry 只需要移动到环 $[1,2,3,4]$ 中与 Tom 不相邻的那个点，可保证 Tom 不胜。\n\n第二组询问中，$a_2=4,\\ b_2=5$，无论 Jerry 如何行动，Tom 只需走到 $6$ 处，此后 Jerry 可能在 $\\{5,7,8\\}$，无论如何 Tom 都可以一步追到。\n\n第三组询问中，$a_3=5,\\ b_3=7$，则 Jerry 按照第一组询问中的策略即可使得 Tom 无法获胜。\n\n【数据范围】\n\n**本题采用捆绑测试。**\n\n对于 $100\\%$ 的数据，$1\\leq n,m,q\\leq 10^5$，$1\\leq x,y,a,b\\leq n$，$a_i\\ne b_i$。\n\n保证给出的无向图连通，且不含重边和自环。\n\n$\\text{Subtask 1}\\ (10\\%)$： $n,m,q\\leq 10$。\n\n$\\text{Subtask 2}\\ (16\\%)$： $n,m,q\\leq 100$。\n\n$\\text{Subtask 3}\\ (24\\%)$： $n,m,q\\leq 1000$。\n\n$\\text{Subtask 4}\\ (16\\%)$： $m=n$。\n\n$\\text{Subtask 5}\\ (34\\%)$： 无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[2020-2021 集训队作业] Tom & Jerry", "background": "自选题 by ix35\n\n2025/10/15：添加一组 [hack 数据](https://www.luogu.com.cn/ticket/BTVX280196)，位于 Subtask 0。", "description": "给定一张包含 $n$ 个顶点和 $m$ 条边的 **无向连通图**，Tom 和 Jerry 在图上进行了 $q$ 次追逐游戏。\n\n在第 $i$ 次游戏中，Tom 一开始位于顶点 $a_i$，而 Jerry 一开始位于顶点 $b_i$（双方任何时候都知道自己和对方的位置），追逐规则如下：\n\n- Jerry 和 Tom 交替行动，Jerry 先行动。\n\n- Jerry 每次行动可以通过无向图中的 **任意多条边**（可以选择不移动），但是在移动过程中不能经过 Tom 当前所在的结点，否则就会被抓住。\n\n- Tom 每次行动只能通过无向图中的 **至多一条边**（可以选择不移动）。\n\n- 如果 Tom 在一次行动后到达了 Jerry 的位置，那么 Tom 胜利。\n\nTom 尽量想要胜利，而 Jerry 会尽量阻止 Tom 胜利。\n\n现在你需要对于每一局游戏，求出 Tom 是否一定能在有限次行动内获胜。", "inputFormat": "第 $1$ 行：三个整数 $n,m,q$，分别表示无向连通图的点数，边数以及游戏的次数。\n\n接下来 $m$ 行：每行两个整数 $x,y$，描述图中的一条无向边。\n\n接下来 $q$ 行：每行两个整数 $a,b$，表示一局游戏中双方的初始位置。", "outputFormat": "共 $q$ 行：对于每局游戏，如果 Tom 可以在有限个回合内获胜则输出 `Yes`，否则输出 `No`。", "hint": "【样例解释】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/gg8gk6fw.png)\n\n第一组询问中，$a_1=6,\\ b_1=4$，则 Jerry 先走到 $2$ 处，此后每一回合，若 Tom 行动完后与 Jerry 相邻，Jerry 只需要移动到环 $[1,2,3,4]$ 中与 Tom 不相邻的那个点，可保证 Tom 不胜。\n\n第二组询问中，$a_2=4,\\ b_2=5$，无论 Jerry 如何行动，Tom 只需走到 $6$ 处，此后 Jerry 可能在 $\\{5,7,8\\}$，无论如何 Tom 都可以一步追到。\n\n第三组询问中，$a_3=5,\\ b_3=7$，则 Jerry 按照第一组询问中的策略即可使得 Tom 无法获胜。\n\n【数据范围】\n\n**本题采用捆绑测试。**\n\n对于 $100\\%$ 的数据，$1\\leq n,m,q\\leq 10^5$，$1\\leq x,y,a,b\\leq n$，$a_i\\ne b_i$。\n\n保证给出的无向图连通，且不含重边和自环。\n\n$\\text{Subtask 1}\\ (10\\%)$： $n,m,q\\leq 10$。\n\n$\\text{Subtask 2}\\ (16\\%)$： $n,m,q\\leq 100$。\n\n$\\text{Subtask 3}\\ (24\\%)$： $n,m,q\\leq 1000$。\n\n$\\text{Subtask 4}\\ (16\\%)$： $m=n$。\n\n$\\text{Subtask 5}\\ (34\\%)$： 无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P7354", "type": "P", "difficulty": 2, "samples": [["1\n8 8 1 1", "2"], ["2\n10 9 1 9\n999 999 999 2", "2\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["模拟", "数学"], "title": "「PMOI-1」立方骑士", "background": "lhm 最近迷上了国际象棋，他对里面的骑士最感兴趣，于是就开辟了下面这个玩法。", "description": "lhm 现在建立了一个大小为 $n \\times m$ 的国际象棋棋盘，你作为白方要与黑方作战。棋盘上黑方只有一个国王，**国王位置不会移动**，而 lhm 有无穷无尽的骑士。现在你需要解出，最少派出几个骑士才能将死黑方国王，定义将死的标准为**黑方国王在不被吃掉的情况下不能移动为止**。\n\n更形式化地讲：一个 $n\\times m$ 的棋盘上有一个国王，你需要摆放尽可能少的骑士在棋盘上，使得对于每一个国王能走**正好一步**达到的且不在棋盘外的位置，都存在至少一个骑士能走**正好一步**达到。\n\n棋子的移动方法：\n\n国王每一步能向上、下、左、右、左上、右上、左下、右下八个方向移动一格。\n\n骑士与国际象棋规则相同，每次可以走日字（即 $2\\times3$ 长方形的对角线，详见样例）。**注意没有蹩马腿规则，也就是只要不走出棋盘且按照日字格行走，其他没有限制。**\n\nlhm 太菜了，只好请聪明的你来帮他完成这个任务。", "inputFormat": "**本题有多组数据**。\n\n第一行一个整数 $T$，表示数据组数。\n\n对于每组数据，一行四个整数 $n,m,x,y$，表示棋盘大小和黑方国王的坐标。", "outputFormat": "输出共 $T$ 行，每行一个整数，表示最少派出骑士的个数。", "hint": "【样例1解释】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/c5d055nl.png)\n\n一个类似上图的棋盘，$\\text{K}$ 表示黑方国王，$\\text{N}$ 表示白方骑士，$\\color{red}{\\times}$ 表示骑士可以到达的地方（其中 $(3,3)$ 的 $\\text{N}$ 封住了 $(1,2)$ 和 $(2,1)$，$(1,4)$ 的 $\\text{N}$ 封住了 $(2,2)$\n，形如上图，$\\text{K}$ 已经被封死了，所以两个骑士足矣。可以证明两个骑士是最小个数。\n\n【数据范围】\n\n- 对于 $30\\%$ 的数据，保证国王的初始位置一定在棋盘最外面一圈。\n\n- 对于 $100\\%$ 的数据满足，$1 \\leq t \\leq 10$，$1 \\leq x,y \\leq 10^9$，$8 \\leq n,m \\leq 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「PMOI-1」立方骑士", "background": "lhm 最近迷上了国际象棋，他对里面的骑士最感兴趣，于是就开辟了下面这个玩法。", "description": "lhm 现在建立了一个大小为 $n \\times m$ 的国际象棋棋盘，你作为白方要与黑方作战。棋盘上黑方只有一个国王，**国王位置不会移动**，而 lhm 有无穷无尽的骑士。现在你需要解出，最少派出几个骑士才能将死黑方国王，定义将死的标准为**黑方国王在不被吃掉的情况下不能移动为止**。\n\n更形式化地讲：一个 $n\\times m$ 的棋盘上有一个国王，你需要摆放尽可能少的骑士在棋盘上，使得对于每一个国王能走**正好一步**达到的且不在棋盘外的位置，都存在至少一个骑士能走**正好一步**达到。\n\n棋子的移动方法：\n\n国王每一步能向上、下、左、右、左上、右上、左下、右下八个方向移动一格。\n\n骑士与国际象棋规则相同，每次可以走日字（即 $2\\times3$ 长方形的对角线，详见样例）。**注意没有蹩马腿规则，也就是只要不走出棋盘且按照日字格行走，其他没有限制。**\n\nlhm 太菜了，只好请聪明的你来帮他完成这个任务。", "inputFormat": "**本题有多组数据**。\n\n第一行一个整数 $T$，表示数据组数。\n\n对于每组数据，一行四个整数 $n,m,x,y$，表示棋盘大小和黑方国王的坐标。", "outputFormat": "输出共 $T$ 行，每行一个整数，表示最少派出骑士的个数。", "hint": "【样例1解释】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/c5d055nl.png)\n\n一个类似上图的棋盘，$\\text{K}$ 表示黑方国王，$\\text{N}$ 表示白方骑士，$\\color{red}{\\times}$ 表示骑士可以到达的地方（其中 $(3,3)$ 的 $\\text{N}$ 封住了 $(1,2)$ 和 $(2,1)$，$(1,4)$ 的 $\\text{N}$ 封住了 $(2,2)$\n，形如上图，$\\text{K}$ 已经被封死了，所以两个骑士足矣。可以证明两个骑士是最小个数。\n\n【数据范围】\n\n- 对于 $30\\%$ 的数据，保证国王的初始位置一定在棋盘最外面一圈。\n\n- 对于 $100\\%$ 的数据满足，$1 \\leq t \\leq 10$，$1 \\leq x,y \\leq 10^9$，$8 \\leq n,m \\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P7355", "type": "P", "difficulty": 4, "samples": [["5\n2 1\n2 2\n3 3\n114 514\n1919810 7872754", "5\n15\n115\n338602801\n30498159"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学"], "title": "「PMOI-1」抽奖", "background": "", "description": "活动奖池中共有 $n$ 种道具，dead_X 有 $m$ 张兑奖券。一张兑奖券可以兑换成一次抽奖机会或 $114514$ 金币。\n\ndead_X 决定将一部分兑奖券拿来抽奖，并将剩下的兑奖券兑换成金币。\n\n在一次抽奖机会中，dead_X 会等概率得到所有奖池中一款道具的 $1919810$ 秒**体验卡**。\n\n由于 dead_X 在活动中买了 VIP 卡，他可以在所有抽奖结束后选择一款**抽奖得到**的体验卡，将所有这种类型的体验卡上交，并得到对应种类的**永久道具**。\n\n注意，dead_X 可以不使用这个功能，但是不可以使用多于一次。\n\n有选择困难症的 dead_X 想知道，有多少种可能的**活动结果**。\n\n两种活动结果不同，当且仅当 dead_X 获得的金币不同，或者在任何一次抽奖中获得的体验卡不同（即抽到体验卡形成的序列不同），或者获得的永久道具不同。\n\n注意，抽奖中获得的都是体验卡，最后选择的永久道具和体验卡在哪一次抽出没有关系。\n\n------------\n\nUpdate 2023.11.16：出题人看自己好几年前写的题面绷不住了，补一份形式化题面。\n\n定义一个序列的权值是其不同元素个数 $+1$，例如 $[1,9,2,6,8,1,7]$ 的权值是 $7$。\n\n对于所有长度 $\\in[0,m]$，每个数 $\\in [1,n]$ 的整数序列，求其权值和对 $10^9+7$ 取模的值。", "inputFormat": "**本题有多组数据**。\n\n第一行一个整数 $T$，代表数据组数。\n\n对于每组数据，输入两个正整数 $n,m$，分别表示道具的种数和兑奖券的张数。", "outputFormat": "输出共 $T$ 行，每行输出一个正整数，代表方案数对 $10^9+7$ 取模的值。", "hint": "【样例解释】\n\n以下为第二组测试数据所有可能的方案：\n\n假设两种物品分别为 $A$ 和 $B$。\n\n1. 兑换 $229028$ 金币。\n1. 兑换 $114514$ 金币，获得 $A$ 体验卡。\n1. 兑换 $114514$ 金币，获得 $B$ 体验卡。\n1. 兑换 $114514$ 金币，获得 $A$ 永久道具。\n1. 兑换 $114514$ 金币，获得 $B$ 永久道具。\n1. 第一次获得 $A$ 体验卡，第二次获得 $A$ 体验卡。\n1. 第一次获得 $A$ 体验卡，第二次获得 $B$ 体验卡。\n1. 第一次获得 $B$ 体验卡，第二次获得 $A$ 体验卡。\n1. 第一次获得 $B$ 体验卡，第二次获得 $B$ 体验卡。\n1. 第一次获得 $A$ 体验卡，第二次获得 $A$ 体验卡，指定 $A$ 为永久道具。\n1. 第一次获得 $A$ 体验卡，第二次获得 $B$ 体验卡，指定 $A$ 为永久道具。\n1. 第一次获得 $B$ 体验卡，第二次获得 $A$ 体验卡，指定 $A$ 为永久道具。\n1. 第一次获得 $A$ 体验卡，第二次获得 $B$ 体验卡，指定 $B$ 为永久道具。\n1. 第一次获得 $B$ 体验卡，第二次获得 $A$ 体验卡，指定 $B$ 为永久道具。\n1. 第一次获得 $B$ 体验卡，第二次获得 $B$ 体验卡，指定 $B$ 为永久道具。\n\n【数据范围】\n- Subtask1（10pts）：$n,m\\leq5,T\\le25$；\n- Subtask2（10pts）：$n=1$；\n- Subtask3（10pts）：$m=1$；\n- Subtask4（20pts）：$n,m\\leq1000,T\\leq 5$；\n- Subtask5（20pts）：$\\sum m\\leq10^6$；\n- Subtask6（30pts）：无特殊限制。\n\n对于 $100\\%$ 的数据满足，$1\\le n,m\\leq 10^9$，$1\\le T\\leq 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「PMOI-1」抽奖", "background": "", "description": "活动奖池中共有 $n$ 种道具，dead_X 有 $m$ 张兑奖券。一张兑奖券可以兑换成一次抽奖机会或 $114514$ 金币。\n\ndead_X 决定将一部分兑奖券拿来抽奖，并将剩下的兑奖券兑换成金币。\n\n在一次抽奖机会中，dead_X 会等概率得到所有奖池中一款道具的 $1919810$ 秒**体验卡**。\n\n由于 dead_X 在活动中买了 VIP 卡，他可以在所有抽奖结束后选择一款**抽奖得到**的体验卡，将所有这种类型的体验卡上交，并得到对应种类的**永久道具**。\n\n注意，dead_X 可以不使用这个功能，但是不可以使用多于一次。\n\n有选择困难症的 dead_X 想知道，有多少种可能的**活动结果**。\n\n两种活动结果不同，当且仅当 dead_X 获得的金币不同，或者在任何一次抽奖中获得的体验卡不同（即抽到体验卡形成的序列不同），或者获得的永久道具不同。\n\n注意，抽奖中获得的都是体验卡，最后选择的永久道具和体验卡在哪一次抽出没有关系。\n\n------------\n\nUpdate 2023.11.16：出题人看自己好几年前写的题面绷不住了，补一份形式化题面。\n\n定义一个序列的权值是其不同元素个数 $+1$，例如 $[1,9,2,6,8,1,7]$ 的权值是 $7$。\n\n对于所有长度 $\\in[0,m]$，每个数 $\\in [1,n]$ 的整数序列，求其权值和对 $10^9+7$ 取模的值。", "inputFormat": "**本题有多组数据**。\n\n第一行一个整数 $T$，代表数据组数。\n\n对于每组数据，输入两个正整数 $n,m$，分别表示道具的种数和兑奖券的张数。", "outputFormat": "输出共 $T$ 行，每行输出一个正整数，代表方案数对 $10^9+7$ 取模的值。", "hint": "【样例解释】\n\n以下为第二组测试数据所有可能的方案：\n\n假设两种物品分别为 $A$ 和 $B$。\n\n1. 兑换 $229028$ 金币。\n1. 兑换 $114514$ 金币，获得 $A$ 体验卡。\n1. 兑换 $114514$ 金币，获得 $B$ 体验卡。\n1. 兑换 $114514$ 金币，获得 $A$ 永久道具。\n1. 兑换 $114514$ 金币，获得 $B$ 永久道具。\n1. 第一次获得 $A$ 体验卡，第二次获得 $A$ 体验卡。\n1. 第一次获得 $A$ 体验卡，第二次获得 $B$ 体验卡。\n1. 第一次获得 $B$ 体验卡，第二次获得 $A$ 体验卡。\n1. 第一次获得 $B$ 体验卡，第二次获得 $B$ 体验卡。\n1. 第一次获得 $A$ 体验卡，第二次获得 $A$ 体验卡，指定 $A$ 为永久道具。\n1. 第一次获得 $A$ 体验卡，第二次获得 $B$ 体验卡，指定 $A$ 为永久道具。\n1. 第一次获得 $B$ 体验卡，第二次获得 $A$ 体验卡，指定 $A$ 为永久道具。\n1. 第一次获得 $A$ 体验卡，第二次获得 $B$ 体验卡，指定 $B$ 为永久道具。\n1. 第一次获得 $B$ 体验卡，第二次获得 $A$ 体验卡，指定 $B$ 为永久道具。\n1. 第一次获得 $B$ 体验卡，第二次获得 $B$ 体验卡，指定 $B$ 为永久道具。\n\n【数据范围】\n- Subtask1（10pts）：$n,m\\leq5,T\\le25$；\n- Subtask2（10pts）：$n=1$；\n- Subtask3（10pts）：$m=1$；\n- Subtask4（20pts）：$n,m\\leq1000,T\\leq 5$；\n- Subtask5（20pts）：$\\sum m\\leq10^6$；\n- Subtask6（30pts）：无特殊限制。\n\n对于 $100\\%$ 的数据满足，$1\\le n,m\\leq 10^9$，$1\\le T\\leq 10^5$。", "locale": "zh-CN"}}}
{"pid": "P7356", "type": "P", "difficulty": 5, "samples": [["1\n\n0 0\n\n0 0", "\n0 1\n\n0 2\n\n0 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["博弈论", "2021", "交互题", "Special Judge", "O2优化", "构造", "Ad-hoc"], "title": "「PMOI-1」游戏", "background": "> 大眼观察乃交互题第一要义\n\n——command_block 《考前小贴士》\n\ndjy 的同桌和 djy 玩五子棋玩腻了，就发明了一个~~更无聊的~~新游戏，因为 djy 太菜了，所以你要帮这个蒟蒻想出必胜策略。", "description": "**这是一个 IO 交互题。**\n\n这个游戏在一个平面直角坐标系的**原点，$x,y$ 正半轴**和**第一象限**中进行。\n\n交互程序黑棋，你白棋，黑棋先开始，**保证交互库第一步下 $(0,0)$**。**黑白棋都只能下在 $x,y$ 坐标都为自然数的点**。\n\n若出现**横竖斜任意一个方向**有连续的 `黑白白白`，则白棋赢，若你用了 $x$ 步胜利，且 $x\\le 13$，你得到 $\\frac{\\min(14-x,10)}{10}$ 占比的分数。\n\n### 交互方式\n\n先输入一个整数 $T$ 表示进行 $T$ 次游戏。\n\n接下来的 $T$ 次游戏，执行以下过程：\n\n**第一步交互库走的 $(0,0)$ 无需输入。**\n\n然后重复执行以下两步直到你下了 $14$ 步棋或者你获胜：\n\n1.你输出一行两个数 `x y`，表示你下的棋的坐标是 $(x,y)$。\n\n2.你读入一行两个数 `x y`，表示交互库下的棋的坐标是 $(x,y)$。**若你在走完上一步就已经获胜，则不会读入这两个数，而是直接进入下一局游戏。**\n\n**特殊地，为了方便交互，你所有下的棋的坐标必须在 $100$ 以内，否则会直接判你 $14$ 步，立即结束这局游戏。同时交互库所有下棋的坐标也保证在 $100$ 以内。同时，如果下在已有棋子上**，则视为你这次下到了一个很远的地方，**即放弃这次下棋的机会。如果想主动放弃，也可以采用这种方式。请注意交互库也可能选择放弃某次下棋的机会。**\n\n你的得分比为 $T$ 次游戏的得分比**最小值**。", "inputFormat": "上述的所有输入都应从标准输入中读入，所有输出都应向标准输出中输出。输出一行后必须清空缓冲区，否则你的评测将被判为 Time Limit Exceeded。清空缓冲区方式如下：\n\n- 在 C++ 中，使用 `fflush(stdout)` 或 `cout.flush()`。\n- 在 Pascal 中，使用 `flush(output)`。\n- 在 Python 中，使用 `stdout.flush()`。\n- 其他语言请自行查阅文档。", "outputFormat": "如题目描述。$T$ 组交互结束后不应有任何多余的输出。", "hint": "【样例解释】\n\n黑棋一直选择放弃，白棋下了 $(0,1),(0,2),(0,3)$ ，与黑棋的 $(0,0)$ 在竖着的方向形成了``黑白白白``。从而白棋胜利。\n\n**本题采用捆绑测试。**\n\n- Subtask1（10pts）：保证交互库随机下在一个点上。\n- Subtask2（10pts）：保证交互库除了在你下一步必胜时，均选择放弃下棋。\n- Subtask3（20pts）：$T=5$。\n- Subtask4（60pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le T\\le 10^3$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「PMOI-1」游戏", "background": "> 大眼观察乃交互题第一要义\n\n——command_block 《考前小贴士》\n\ndjy 的同桌和 djy 玩五子棋玩腻了，就发明了一个~~更无聊的~~新游戏，因为 djy 太菜了，所以你要帮这个蒟蒻想出必胜策略。", "description": "**这是一个 IO 交互题。**\n\n这个游戏在一个平面直角坐标系的**原点，$x,y$ 正半轴**和**第一象限**中进行。\n\n交互程序黑棋，你白棋，黑棋先开始，**保证交互库第一步下 $(0,0)$**。**黑白棋都只能下在 $x,y$ 坐标都为自然数的点**。\n\n若出现**横竖斜任意一个方向**有连续的 `黑白白白`，则白棋赢，若你用了 $x$ 步胜利，且 $x\\le 13$，你得到 $\\frac{\\min(14-x,10)}{10}$ 占比的分数。\n\n### 交互方式\n\n先输入一个整数 $T$ 表示进行 $T$ 次游戏。\n\n接下来的 $T$ 次游戏，执行以下过程：\n\n**第一步交互库走的 $(0,0)$ 无需输入。**\n\n然后重复执行以下两步直到你下了 $14$ 步棋或者你获胜：\n\n1.你输出一行两个数 `x y`，表示你下的棋的坐标是 $(x,y)$。\n\n2.你读入一行两个数 `x y`，表示交互库下的棋的坐标是 $(x,y)$。**若你在走完上一步就已经获胜，则不会读入这两个数，而是直接进入下一局游戏。**\n\n**特殊地，为了方便交互，你所有下的棋的坐标必须在 $100$ 以内，否则会直接判你 $14$ 步，立即结束这局游戏。同时交互库所有下棋的坐标也保证在 $100$ 以内。同时，如果下在已有棋子上**，则视为你这次下到了一个很远的地方，**即放弃这次下棋的机会。如果想主动放弃，也可以采用这种方式。请注意交互库也可能选择放弃某次下棋的机会。**\n\n你的得分比为 $T$ 次游戏的得分比**最小值**。", "inputFormat": "上述的所有输入都应从标准输入中读入，所有输出都应向标准输出中输出。输出一行后必须清空缓冲区，否则你的评测将被判为 Time Limit Exceeded。清空缓冲区方式如下：\n\n- 在 C++ 中，使用 `fflush(stdout)` 或 `cout.flush()`。\n- 在 Pascal 中，使用 `flush(output)`。\n- 在 Python 中，使用 `stdout.flush()`。\n- 其他语言请自行查阅文档。", "outputFormat": "如题目描述。$T$ 组交互结束后不应有任何多余的输出。", "hint": "【样例解释】\n\n黑棋一直选择放弃，白棋下了 $(0,1),(0,2),(0,3)$ ，与黑棋的 $(0,0)$ 在竖着的方向形成了``黑白白白``。从而白棋胜利。\n\n**本题采用捆绑测试。**\n\n- Subtask1（10pts）：保证交互库随机下在一个点上。\n- Subtask2（10pts）：保证交互库除了在你下一步必胜时，均选择放弃下棋。\n- Subtask3（20pts）：$T=5$。\n- Subtask4（60pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le T\\le 10^3$。", "locale": "zh-CN"}}}
{"pid": "P7357", "type": "P", "difficulty": 6, "samples": [["8 3\n4 2 3 4 2 1 4 3\n1 2\n1 3\n2 4\n2 5\n3 6\n6 7\n6 8\n2 4 8\n1 3 \n2 2 3", "3\n4"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["树形数据结构", "二分", "O2优化", "可持久化线段树", "可持久化"], "title": "「PMOI-1」中位数", "background": null, "description": "给定一棵以 $1$ 为根的包含 $n$ 个节点的**有根树**。第 $i$ 个节点有点权 $a_i$。\n\n定义函数 $f(u,v)$ 表示从 $u$ 到 $v$ 经过的所有节点的点权的**可重集**的中位数。\n\n请注意，**本题中的中位数的定义与数学中的定义略有不同**：这里一个长度为 $t$ 的序列的中位数定义为这个序列第 $\\left\\lceil\\frac{t+1}2\\right\\rceil$ 小的数。\n\n定义函数 $\\text{cover}(x_1,y_1,x_2,y_2)$ 表示从 $x_1$ 到 $y_1$ 的路径是否完全覆盖了从 $x_2$ 到 $y_2$ 的路径。如果完全覆盖，则 $\\text{cover}(x_1,y_1,x_2,y_2)=1$，否则 $\\text{cover}(x_1,y_1,x_2,y_2)=0$。\n\n你需要依次处理 $q$ 次操作，按照以下格式给出：\n\n`1 u`：表示一次操作，需要你将点 $u$ 的点权对 $1$ **异或**；\n\n`2 u v`：表示一次询问，需要你求出 $\\max\\limits_{1\\le i\\le n,1\\le j\\le n}\\{\\text{cover}(i,j,u,v)f(i,j)\\}$。\n\n对于第二类操作，保证每次询问均满足 $u$ 不是 $v$ 的祖先且 $v$ 不是 $u$ 的祖先，且 $u \\neq v$。\n\n你需要对于每个第二类操作，输出对应的值。", "inputFormat": "第一行两个正数 $n$ 和 $q$，分别表示树的节点数与询问次数。\n\n第二行 $n$ 个整数，第 $i$ 个数表示第 $i$ 个节点的点权 $a_i$。\n\n下面 $n-1$ 行，每行两个整数 $x,y$，描述一条连接 $x$ 与 $y$ 的边。\n\n下面 $q$ 行，每行先输入一个整数 $opt$，表示本次是是操作还是询问。若 $opt=1$，则这是一次操作，且接下来会输入一个整数 $u$；若 $opt=2$，则这是一次询问，且接下来会输入两个整数 $u,v$。其具体意义见【题目描述】。", "outputFormat": "对于每次询问输出一行，即对应询问的答案。", "hint": "【样例解释】\n\n第一次是询问。显然，只有 $(i=4,j=8)$ 满足 $\\text{cover}(i,j,u,v)=1$。此时 $f(i,j)=3$。\n\n第二次是操作。将 $3$ 号节点的点权改为了 $2$。\n\n第三次是询问。当 $i=4,j=3$ 时，$\\text{cover}(i,j,u,v)=1$ 且 $f(i,j)=4$。不难发现，对于其他所有满足 $\\text{cover}(i,j,u,v)=1$ 的节点对 $(i,j)$，均没有 $f(i,j)>4$。\n\n【数据范围】\n- Subtask 1（8 pts）：$n,q\\le50$；\n- Subtask 2（12 pts）：$n,q\\le2\\times10^3$；\n- Subtask 3（16 pts）：$n,q\\le4\\times10^4$；\n- Subtask 4（10 pts）：保证树的形态随机生成；\n- Subtask 5（12 pts）：保证没有 $1$ 操作；\n- Subtask 6（12 pts）：保证每次询问的 $u,v$ 都是叶子节点；\n- Subtask 7（30 pts）：无特殊限制。\n\nSubtask 4 的随机方式为：随机生成一个的排列 $p$，对于 $i\\in[2,n]$，$p_i$ 向 $p_1,p_2,...,p_{i-1}$ 中等概率随机的一个点连边。\n\n对于 $100\\%$ 的数据满足，$1\\le n,q,a_i \\le 10^5$，保证每次询问均满足 $u$ 不是 $v$ 的祖先且 $v$ 不是 $u$ 的祖先，且 $u \\neq v$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「PMOI-1」中位数", "background": null, "description": "给定一棵以 $1$ 为根的包含 $n$ 个节点的**有根树**。第 $i$ 个节点有点权 $a_i$。\n\n定义函数 $f(u,v)$ 表示从 $u$ 到 $v$ 经过的所有节点的点权的**可重集**的中位数。\n\n请注意，**本题中的中位数的定义与数学中的定义略有不同**：这里一个长度为 $t$ 的序列的中位数定义为这个序列第 $\\left\\lceil\\frac{t+1}2\\right\\rceil$ 小的数。\n\n定义函数 $\\text{cover}(x_1,y_1,x_2,y_2)$ 表示从 $x_1$ 到 $y_1$ 的路径是否完全覆盖了从 $x_2$ 到 $y_2$ 的路径。如果完全覆盖，则 $\\text{cover}(x_1,y_1,x_2,y_2)=1$，否则 $\\text{cover}(x_1,y_1,x_2,y_2)=0$。\n\n你需要依次处理 $q$ 次操作，按照以下格式给出：\n\n`1 u`：表示一次操作，需要你将点 $u$ 的点权对 $1$ **异或**；\n\n`2 u v`：表示一次询问，需要你求出 $\\max\\limits_{1\\le i\\le n,1\\le j\\le n}\\{\\text{cover}(i,j,u,v)f(i,j)\\}$。\n\n对于第二类操作，保证每次询问均满足 $u$ 不是 $v$ 的祖先且 $v$ 不是 $u$ 的祖先，且 $u \\neq v$。\n\n你需要对于每个第二类操作，输出对应的值。", "inputFormat": "第一行两个正数 $n$ 和 $q$，分别表示树的节点数与询问次数。\n\n第二行 $n$ 个整数，第 $i$ 个数表示第 $i$ 个节点的点权 $a_i$。\n\n下面 $n-1$ 行，每行两个整数 $x,y$，描述一条连接 $x$ 与 $y$ 的边。\n\n下面 $q$ 行，每行先输入一个整数 $opt$，表示本次是是操作还是询问。若 $opt=1$，则这是一次操作，且接下来会输入一个整数 $u$；若 $opt=2$，则这是一次询问，且接下来会输入两个整数 $u,v$。其具体意义见【题目描述】。", "outputFormat": "对于每次询问输出一行，即对应询问的答案。", "hint": "【样例解释】\n\n第一次是询问。显然，只有 $(i=4,j=8)$ 满足 $\\text{cover}(i,j,u,v)=1$。此时 $f(i,j)=3$。\n\n第二次是操作。将 $3$ 号节点的点权改为了 $2$。\n\n第三次是询问。当 $i=4,j=3$ 时，$\\text{cover}(i,j,u,v)=1$ 且 $f(i,j)=4$。不难发现，对于其他所有满足 $\\text{cover}(i,j,u,v)=1$ 的节点对 $(i,j)$，均没有 $f(i,j)>4$。\n\n【数据范围】\n- Subtask 1（8 pts）：$n,q\\le50$；\n- Subtask 2（12 pts）：$n,q\\le2\\times10^3$；\n- Subtask 3（16 pts）：$n,q\\le4\\times10^4$；\n- Subtask 4（10 pts）：保证树的形态随机生成；\n- Subtask 5（12 pts）：保证没有 $1$ 操作；\n- Subtask 6（12 pts）：保证每次询问的 $u,v$ 都是叶子节点；\n- Subtask 7（30 pts）：无特殊限制。\n\nSubtask 4 的随机方式为：随机生成一个的排列 $p$，对于 $i\\in[2,n]$，$p_i$ 向 $p_1,p_2,...,p_{i-1}$ 中等概率随机的一个点连边。\n\n对于 $100\\%$ 的数据满足，$1\\le n,q,a_i \\le 10^5$，保证每次询问均满足 $u$ 不是 $v$ 的祖先且 $v$ 不是 $u$ 的祖先，且 $u \\neq v$。", "locale": "zh-CN"}}}
{"pid": "P7358", "type": "P", "difficulty": 5, "samples": [["4 2\n3 1 1 4 \n3 5 2 1 ", "570934265"], ["3 1\n1 1 1\n1 1 1", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "数学", "矩阵加速"], "title": "「JZOI-1」窗花", "background": "小蔡和小僖在比赛剪窗花。", "description": "小蔡和小僖的制作水平都很高，换句话讲，他们都能制作出好看度为 $1\\dots n$ 的窗花，但是两个人的熟练度不一样，小蔡的熟练度可以用一个数组 $a_{1\\dots n}$ 组成，换句话讲，他剪出一个好看度为 $k(1\\le k\\le n)$ 的窗花的概率为 $\\frac{a_k}{\\sum_{i=1}^na_i}$。同理，小僖的熟练度可以用数组 $b_{1\\dots n}$ 组成，他剪出一个好看度为 $k(1\\le k\\le n)$ 的窗花的概率为 $\\frac{b_k}{\\sum_{i=1}^nb_i}$。\n\n现在两个人正在比赛剪窗花，如果某个人剪出的窗花的好看度比另一个人的大，那么这个人取胜，如果比另一个人的小，那么这个人失败，如果一样，则为平局。\n\n现在，小蔡用一个计数器记录他的情况，如果他赢了，那么计数器 $+1$，如果他输了，那么计数器 $-1$，如果平了，那么不加不减。但由于计数器不支持负数，所以如果结果 $\\le0$ 那么会自动变成 $0$，如果计数器显示的数 $=m$，那么比赛结束。\n\n作为新时代的大神，小蔡花了 $10^{-6}$ 秒就算出来了比赛结束所经过的期望局数，但他想让你帮忙检验一下……", "inputFormat": "第一行输入两个整数 $ n, m $，详细见题目。  \n第二行输入 $ n $ 个整数 $ a_i $，表示第一个人的熟练度。  \n第三行输入 $ n $ 个整数 $ b_i $，表示第二个人的熟练度。", "outputFormat": "一个整数，表示答案对 $ 10^9 + 7 $ 取模之后的结果。", "hint": "对于 $ 30\\% $ 的数据点，$ 1 \\leq m \\leq 100 $。\n\n对于 $ 60\\% $ 的数据点，$ 1 \\leq m \\leq 10^{6} $。\n\n对于 $ 90\\% $ 的数据点，$ 1 \\leq m \\leq 10^{18} $。\n\n对于 $ 100\\% $ 的数据点，$ 2 \\leq n \\leq 10^6 $，$ 1 \\leq m \\leq 10^{1000} $，$ 1 \\leq a_i \\leq 10^9 $。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「JZOI-1」窗花", "background": "小蔡和小僖在比赛剪窗花。", "description": "小蔡和小僖的制作水平都很高，换句话讲，他们都能制作出好看度为 $1\\dots n$ 的窗花，但是两个人的熟练度不一样，小蔡的熟练度可以用一个数组 $a_{1\\dots n}$ 组成，换句话讲，他剪出一个好看度为 $k(1\\le k\\le n)$ 的窗花的概率为 $\\frac{a_k}{\\sum_{i=1}^na_i}$。同理，小僖的熟练度可以用数组 $b_{1\\dots n}$ 组成，他剪出一个好看度为 $k(1\\le k\\le n)$ 的窗花的概率为 $\\frac{b_k}{\\sum_{i=1}^nb_i}$。\n\n现在两个人正在比赛剪窗花，如果某个人剪出的窗花的好看度比另一个人的大，那么这个人取胜，如果比另一个人的小，那么这个人失败，如果一样，则为平局。\n\n现在，小蔡用一个计数器记录他的情况，如果他赢了，那么计数器 $+1$，如果他输了，那么计数器 $-1$，如果平了，那么不加不减。但由于计数器不支持负数，所以如果结果 $\\le0$ 那么会自动变成 $0$，如果计数器显示的数 $=m$，那么比赛结束。\n\n作为新时代的大神，小蔡花了 $10^{-6}$ 秒就算出来了比赛结束所经过的期望局数，但他想让你帮忙检验一下……", "inputFormat": "第一行输入两个整数 $ n, m $，详细见题目。  \n第二行输入 $ n $ 个整数 $ a_i $，表示第一个人的熟练度。  \n第三行输入 $ n $ 个整数 $ b_i $，表示第二个人的熟练度。", "outputFormat": "一个整数，表示答案对 $ 10^9 + 7 $ 取模之后的结果。", "hint": "对于 $ 30\\% $ 的数据点，$ 1 \\leq m \\leq 100 $。\n\n对于 $ 60\\% $ 的数据点，$ 1 \\leq m \\leq 10^{6} $。\n\n对于 $ 90\\% $ 的数据点，$ 1 \\leq m \\leq 10^{18} $。\n\n对于 $ 100\\% $ 的数据点，$ 2 \\leq n \\leq 10^6 $，$ 1 \\leq m \\leq 10^{1000} $，$ 1 \\leq a_i \\leq 10^9 $。", "locale": "zh-CN"}}}
{"pid": "P7359", "type": "P", "difficulty": 6, "samples": [["3 2 2\n1 2 2 1 0\n1 3 3 2 1\n2 3\n1 2", "4\n2"], ["4 1 1\n1 2 100 99 1\n2 3 100 99 0\n3 4 100 99 1\n1 4", "104"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [409600, 409600, 409600, 409600, 409600, 409600, 409600, 409600, 409600, 409600]}, "tags": ["矩阵加速", "树形 DP"], "title": "「JZOI-1」旅行", "background": "新年快到了，小僖要做一个长远的旅行，至于从哪里开始，到哪里，他还没有想好。", "description": "这次旅行是在一个由 $N$ 个城市和 $(N-1)$ 条双向道路组成的一个国家中，其中保证任意两个城市可以互达。\n\n为了美化环境，所有道路都是沿河修建的，这意味着小僖可以自己制造一艘船，然后划船通过这条路，所以小僖每走一条边都可以从陆上走过去，也可以划船通过。\n\n当然，因为顺流和逆流的原因，所以有一个参数 $z_i$，换句话讲，如果从陆上走过这条边所花费的时间为 $a_i$，那么顺流而下划船所花费的时间为 $a_i-z_i$ (保证结果大于 $0$)，逆流而上花费的时间为 $a_i+z_i$。不过，造船需要 $L$ 的时间，且人一旦上了岸，就必须放弃这条船只。\n\n现在小僖想你帮忙算一下从 $u$ 走到 $v$ 的最短时间。\n\n注意：一条船可以连续走多段水路（只要你不下船）", "inputFormat": "第一行三个数，$N,L,T$。\n\n接下来 $(N-1)$ 行，每行五个数，$x_i,y_i,a_i,z_i,type_i$，其中 $type_i=1$ 表示水从 $x_i$ 流向 $y_i$，$type_i=0$ 表示水从 $y_i$ 流向 $x_i$。\n\n接下来 $T$ 行，每行两个数 $u_i,v_i$，表示每个计划的起点和终点。", "outputFormat": "$T$ 行，每行一个数，表示每一个询问的答案。", "hint": "### 样例1解释\n图长这样：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2sp03gic.png)\n\n对于第一组询问，也就是从 $2$ 到 $3$，我们可以在 $2$ 号节点造船，花费 $2$ 的时间，然后从节点 $2$ 顺流而下到 $1$，花费 $2-1=1$，在顺流而下到 $3$，花费 $3-2=1$，所以总花费为 $2+1+1=4$。\n## 数据范围\n对于 $10\\%$ 的数据，$N,T\\leq10^3$。\n\n对于另外 $10\\%$ 的数据，树的形态随机。\n\n对于另外 $20\\%$ 的数据，所有的 $u$ 或所有的 $v$ 都相等。\n\n最后一个测试点给出了一条链。\n\n对于 $100\\%$ 的数据，$N,T\\leq2\\times10^5$，且 $0\n<a_i,L\\leq10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「JZOI-1」旅行", "background": "新年快到了，小僖要做一个长远的旅行，至于从哪里开始，到哪里，他还没有想好。", "description": "这次旅行是在一个由 $N$ 个城市和 $(N-1)$ 条双向道路组成的一个国家中，其中保证任意两个城市可以互达。\n\n为了美化环境，所有道路都是沿河修建的，这意味着小僖可以自己制造一艘船，然后划船通过这条路，所以小僖每走一条边都可以从陆上走过去，也可以划船通过。\n\n当然，因为顺流和逆流的原因，所以有一个参数 $z_i$，换句话讲，如果从陆上走过这条边所花费的时间为 $a_i$，那么顺流而下划船所花费的时间为 $a_i-z_i$ (保证结果大于 $0$)，逆流而上花费的时间为 $a_i+z_i$。不过，造船需要 $L$ 的时间，且人一旦上了岸，就必须放弃这条船只。\n\n现在小僖想你帮忙算一下从 $u$ 走到 $v$ 的最短时间。\n\n注意：一条船可以连续走多段水路（只要你不下船）", "inputFormat": "第一行三个数，$N,L,T$。\n\n接下来 $(N-1)$ 行，每行五个数，$x_i,y_i,a_i,z_i,type_i$，其中 $type_i=1$ 表示水从 $x_i$ 流向 $y_i$，$type_i=0$ 表示水从 $y_i$ 流向 $x_i$。\n\n接下来 $T$ 行，每行两个数 $u_i,v_i$，表示每个计划的起点和终点。", "outputFormat": "$T$ 行，每行一个数，表示每一个询问的答案。", "hint": "### 样例1解释\n图长这样：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2sp03gic.png)\n\n对于第一组询问，也就是从 $2$ 到 $3$，我们可以在 $2$ 号节点造船，花费 $2$ 的时间，然后从节点 $2$ 顺流而下到 $1$，花费 $2-1=1$，在顺流而下到 $3$，花费 $3-2=1$，所以总花费为 $2+1+1=4$。\n## 数据范围\n对于 $10\\%$ 的数据，$N,T\\leq10^3$。\n\n对于另外 $10\\%$ 的数据，树的形态随机。\n\n对于另外 $20\\%$ 的数据，所有的 $u$ 或所有的 $v$ 都相等。\n\n最后一个测试点给出了一条链。\n\n对于 $100\\%$ 的数据，$N,T\\leq2\\times10^5$，且 $0\n<a_i,L\\leq10^5$。", "locale": "zh-CN"}}}
{"pid": "P7360", "type": "P", "difficulty": 6, "samples": [["2\n2 2\n3 2", "8\n7776"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["素数判断,质数,筛法", "最大公约数 gcd", "莫比乌斯反演", "二项式定理", "容斥原理"], "title": "「JZOI-1」红包", "background": "新年到了，小僖收到了叔叔寄给他的红包，这个红包里面有很多很多的钱。", "description": "小僖收到的红包总额是这样的：\n\n所有 $K$ 元组满足每个元素都是正整数且 $\\le N$，总额就是这些 $K$ 元组的最小公倍数的乘积。\n\n但由于叔叔并没有那么多的钱，所以结果还要对 $998244353$ 取模。\n\n小僖花了 $10^{-16}$ 秒就算了出来，但他想验证一下是否正确，于是找上了你（别问我为什么他不直接拆开红包看）。\n\n换句话讲，题目只需要你求：\n$$\\prod_{i_1=1}^N\\prod_{i_2=1}^N...\\prod_{i_K=1}^N{\\rm lcm}(i_1,i_2...i_K)\\mod 998244353$$\n保证 $K>1$，其中，${\\rm lcm}(i_1,i_2...i_K)$，表示 $i_1,i_2...i_K$ 的最小公倍数。", "inputFormat": "**本题有多组数据**。\n\n第一行一个数：$T$，表示数据组数。\n\n接下来 $T$ 行，每行两个数，$N,K$，表示每组询问。", "outputFormat": "$T$ 行，每行一个数，表示答案，记得对 $998244353$ 取模。", "hint": "对于样例的第一组数据，题目要求求出 ${\\rm lcm}(1,1)\\times {\\rm lcm}(1,2)\\times {\\rm lcm}(2,1)\\times {\\rm lcm}(2,2)$。\n\n显然，除了 ${\\rm lcm}(1,1)=1$ 以外其它的结果都为 $2$，所以答案为 $1\\times2\\times2\\times2=8$。\n\n| 数据编号 | $N\\le$ | $K\\leq$ | $T=$ |\n| :-----------: | ----------- | ----------- | ----------- |\n| **0** |$10$|$5$|$10$|\n| **1** | $10^6$ |$2$|$10^3$|\n| **2** | $10^6$ |$3$|$10^3$|\n| **3** | $100$ |$10^{18}$|$100$|\n| **4** | $10^5$ |$100$|$10^3$|\n| **5** | $10^5$ |$3\\times10^8$|$1$|\n| **6** | $10^5$ |$10^{100}$| $10$ |\n| **7** |$10^6$|$10^{18}$|$10^3$|\n| **8** |$10^6$|$10^{100}$|$10^3$|\n| **9** |$10^6$|$10^{100}$|$10^3$|\n\n**出题人：你真以为有这么多钱，哈哈，里面装的全是津巴布韦币哦！**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「JZOI-1」红包", "background": "新年到了，小僖收到了叔叔寄给他的红包，这个红包里面有很多很多的钱。", "description": "小僖收到的红包总额是这样的：\n\n所有 $K$ 元组满足每个元素都是正整数且 $\\le N$，总额就是这些 $K$ 元组的最小公倍数的乘积。\n\n但由于叔叔并没有那么多的钱，所以结果还要对 $998244353$ 取模。\n\n小僖花了 $10^{-16}$ 秒就算了出来，但他想验证一下是否正确，于是找上了你（别问我为什么他不直接拆开红包看）。\n\n换句话讲，题目只需要你求：\n$$\\prod_{i_1=1}^N\\prod_{i_2=1}^N...\\prod_{i_K=1}^N{\\rm lcm}(i_1,i_2...i_K)\\mod 998244353$$\n保证 $K>1$，其中，${\\rm lcm}(i_1,i_2...i_K)$，表示 $i_1,i_2...i_K$ 的最小公倍数。", "inputFormat": "**本题有多组数据**。\n\n第一行一个数：$T$，表示数据组数。\n\n接下来 $T$ 行，每行两个数，$N,K$，表示每组询问。", "outputFormat": "$T$ 行，每行一个数，表示答案，记得对 $998244353$ 取模。", "hint": "对于样例的第一组数据，题目要求求出 ${\\rm lcm}(1,1)\\times {\\rm lcm}(1,2)\\times {\\rm lcm}(2,1)\\times {\\rm lcm}(2,2)$。\n\n显然，除了 ${\\rm lcm}(1,1)=1$ 以外其它的结果都为 $2$，所以答案为 $1\\times2\\times2\\times2=8$。\n\n| 数据编号 | $N\\le$ | $K\\leq$ | $T=$ |\n| :-----------: | ----------- | ----------- | ----------- |\n| **0** |$10$|$5$|$10$|\n| **1** | $10^6$ |$2$|$10^3$|\n| **2** | $10^6$ |$3$|$10^3$|\n| **3** | $100$ |$10^{18}$|$100$|\n| **4** | $10^5$ |$100$|$10^3$|\n| **5** | $10^5$ |$3\\times10^8$|$1$|\n| **6** | $10^5$ |$10^{100}$| $10$ |\n| **7** |$10^6$|$10^{18}$|$10^3$|\n| **8** |$10^6$|$10^{100}$|$10^3$|\n| **9** |$10^6$|$10^{100}$|$10^3$|\n\n**出题人：你真以为有这么多钱，哈哈，里面装的全是津巴布韦币哦！**", "locale": "zh-CN"}}}
{"pid": "P7361", "type": "P", "difficulty": 7, "samples": [["10 5\ncdabababdc\n3 7\n2 8\n5 10\n6 10\n1 4\n", "3\n4\n2\n1\n0\n"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [409600, 409600, 409600, 409600, 409600, 409600, 409600, 409600, 409600, 409600, 409600, 409600, 409600, 409600, 409600, 409600, 409600, 409600, 409600, 409600]}, "tags": ["后缀自动机 SAM", "后缀数组 SA"], "title": "「JZOI-1」拜神", "background": "新年快到了，小僖和爸爸妈妈上山拜神，祈求新一年的好气运。", "description": "小僖要拜的神一共有 $n$ 个，小僖对每个神的信仰可以用一个小写字母表示，信仰排在一起形成了一个从标号 $1$ 开始的字符串 $s$。 \n\n小僖需要祈祷词来拜神，定义一段祈祷词为一个长度大于零的 $s$ 的连续子串，祈祷词的长度为这个子串的长度。由于拜神只需要小僖有着一定的认真度，所以一种祈祷词只要出现两次就可以被称之为有效的。\n\n**注意：只要子串出现的位置开头不同，中间有重复部分也没有问题**。 \n\n但是由于还有爸爸妈妈的存在，小僖的祈祷词有时会被干扰而打断，所以只有区间 $[l,r]$ 的字符串（即 $s[l\\dots r]$）有效。为了未雨绸缪，小僖将会对可能的情况进行精心准备。  \n\n他会给出 $q$ 次询问，每次询问将给定 $l,r$，询问区间 $[l,r]$ 的最长的有效祈祷词的长度。", "inputFormat": "第一行输入两个正整数 $n,q$。  \n第二行输入一个由小写字符构成的字符串 $s$。  \n接下来有 $q$ 行，每行输入两个数 $l,r$。", "outputFormat": "输出 $q$ 行，每行输出一个非负整数，代表最长的有效祈祷词的长度，若无有效祈祷词，则输出 $0$。", "hint": "#### 样例解释：  \n对于第一次询问：区间内的字符串为 $\\texttt{ababa}$，其中子串 $\\texttt{aba}$ 出现了两次，长度为 $3$ 。  \n对于第二次询问：区间内的字符串为 $\\texttt{dababab}$，其中子串 $\\texttt{abab}$ 出现了两次，长度为 $4$ 。  \n对于第三次询问：区间内的字符串为 $\\texttt{ababdc}$，其中子串 $\\texttt{ab}$ 出现了两次，长度为 $2$ 。  \n对于第四次询问：区间内的字符串为 $\\texttt{babdc}$，其中子串 $\\texttt{b}$ 出现了两次，长度为 $1$ 。  \n对于第五次询问：区间内的字符串为 $\\texttt{cdab}$，无出现至少两次的子串，答案为 $0$ 。  \n\n#### 数据范围：    \n对于 $5\\%$ 的数据，$n,q\\le50$。  \n对于 $15\\%$ 的数据，$n,q\\le200$。  \n对于 $30\\%$ 的数据，$n,q\\le2\\times10^3$。  \n对于 $40\\%$ 的数据，$n,q\\le5\\times10^3$。  \n对于 $65\\%$ 的数据，$n,q\\le2\\times 10^4$。  \n对于另外 $5\\%$ 的数据，满足所有的字符都相等。  \n对于 $100\\%$ 的数据，$1 \\le n\\le5\\times10^4$，$1 \\le q \\le 10^5$。  ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「JZOI-1」拜神", "background": "新年快到了，小僖和爸爸妈妈上山拜神，祈求新一年的好气运。", "description": "小僖要拜的神一共有 $n$ 个，小僖对每个神的信仰可以用一个小写字母表示，信仰排在一起形成了一个从标号 $1$ 开始的字符串 $s$。 \n\n小僖需要祈祷词来拜神，定义一段祈祷词为一个长度大于零的 $s$ 的连续子串，祈祷词的长度为这个子串的长度。由于拜神只需要小僖有着一定的认真度，所以一种祈祷词只要出现两次就可以被称之为有效的。\n\n**注意：只要子串出现的位置开头不同，中间有重复部分也没有问题**。 \n\n但是由于还有爸爸妈妈的存在，小僖的祈祷词有时会被干扰而打断，所以只有区间 $[l,r]$ 的字符串（即 $s[l\\dots r]$）有效。为了未雨绸缪，小僖将会对可能的情况进行精心准备。  \n\n他会给出 $q$ 次询问，每次询问将给定 $l,r$，询问区间 $[l,r]$ 的最长的有效祈祷词的长度。", "inputFormat": "第一行输入两个正整数 $n,q$。  \n第二行输入一个由小写字符构成的字符串 $s$。  \n接下来有 $q$ 行，每行输入两个数 $l,r$。", "outputFormat": "输出 $q$ 行，每行输出一个非负整数，代表最长的有效祈祷词的长度，若无有效祈祷词，则输出 $0$。", "hint": "#### 样例解释：  \n对于第一次询问：区间内的字符串为 $\\texttt{ababa}$，其中子串 $\\texttt{aba}$ 出现了两次，长度为 $3$ 。  \n对于第二次询问：区间内的字符串为 $\\texttt{dababab}$，其中子串 $\\texttt{abab}$ 出现了两次，长度为 $4$ 。  \n对于第三次询问：区间内的字符串为 $\\texttt{ababdc}$，其中子串 $\\texttt{ab}$ 出现了两次，长度为 $2$ 。  \n对于第四次询问：区间内的字符串为 $\\texttt{babdc}$，其中子串 $\\texttt{b}$ 出现了两次，长度为 $1$ 。  \n对于第五次询问：区间内的字符串为 $\\texttt{cdab}$，无出现至少两次的子串，答案为 $0$ 。  \n\n#### 数据范围：    \n对于 $5\\%$ 的数据，$n,q\\le50$。  \n对于 $15\\%$ 的数据，$n,q\\le200$。  \n对于 $30\\%$ 的数据，$n,q\\le2\\times10^3$。  \n对于 $40\\%$ 的数据，$n,q\\le5\\times10^3$。  \n对于 $65\\%$ 的数据，$n,q\\le2\\times 10^4$。  \n对于另外 $5\\%$ 的数据，满足所有的字符都相等。  \n对于 $100\\%$ 的数据，$1 \\le n\\le5\\times10^4$，$1 \\le q \\le 10^5$。  ", "locale": "zh-CN"}}}
{"pid": "P7362", "type": "P", "difficulty": 6, "samples": [["5 1\n3 2 8 4 1", "3\n1 2\n4 3\n5 4"], ["5 2\n4 4 2 0 1", "3\n3 2\n4 3\n5 4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2020", "Special Judge", "eJOI（欧洲）"], "title": "[eJOI 2020] XOR Sort (Day2)", "background": "", "description": "给定一个长为 $N$ 的序列 $A_i$，你可以进行如下操作：\n\n> 选定一个位置 $i$，将 $A_i$ 修改为 $A_i \\oplus A_{i+1}$ 或 $A_i \\oplus A_{i-1}$。\n\n你想知道，需要用多少次操作才能把 $A_i$ 变为：\n\n- $S=1$，严格单调递增序列，即 $A_i<A_{i+1}$。\n- $S=2$，非严格单调递增序列，即 $A_i \\le A_{i+1}$。", "inputFormat": "第一行两个整数 $N,S$，代表序列长度以及测试点类型。  \n第二行 $N$ 个整数 $A_i$ 代表这个序列。", "outputFormat": "第一行一个整数 $K$ 代表操作次数，你不需要使得 $K$ 最小，你只需要满足 $0 \\le  K \\le 4 \\times 10^4$。         \n接下来 $K$ 行每行两个整数 $i,j$ 代表要把 $A_i$ 修改为 $A_i \\oplus A_j$，其中 $j=i+1$ 或 $i-1$。", "hint": "#### 样例 1 解释\n\n$$[3, 2, 8, 4, 1] \\to  [\\mathbf 1, 2, 8, 4, 1] \\to [1, 2, 8, \\mathbf{12}, 1] \\to [1, 2, 8, 12, \\mathbf{ 13}]$$\n\n#### 样例 2 解释\n\n$$[4, 4, 2, 0, 1] \\to [4, 4, \\mathbf6, 0, 1] \\to [4, 4, 6, \\mathbf6, 1] \\to [4, 4, 6, 6, \\mathbf7]$$\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（25 pts）：$2 \\le N \\le 150$，$S=1$，$A_i$ 互不相同。\n- Subtask 2（35 pts）：$2 \\le N \\le 200$，$S=1$，$A_i$ 互不相同。\n- Subtask 3（40 pts）：$2 \\le N \\le 1000$，$S=2$。\n\n对于 $100\\%$ 的数据：\n\n- $1 \\le S \\le 2$。\n- $2 \\le N \\le 1000$。\n- $0 \\le A_i<2^{20}$。\n\n**本题使用 Special Judge。**\n\n#### 说明\n\n翻译自 [eJOI 2020 Day2 A XOR Sort](https://ejoi2020.ge/static/assets/Day2/Problems/XorSort.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[eJOI 2020] XOR Sort (Day2)", "background": "", "description": "给定一个长为 $N$ 的序列 $A_i$，你可以进行如下操作：\n\n> 选定一个位置 $i$，将 $A_i$ 修改为 $A_i \\oplus A_{i+1}$ 或 $A_i \\oplus A_{i-1}$。\n\n你想知道，需要用多少次操作才能把 $A_i$ 变为：\n\n- $S=1$，严格单调递增序列，即 $A_i<A_{i+1}$。\n- $S=2$，非严格单调递增序列，即 $A_i \\le A_{i+1}$。", "inputFormat": "第一行两个整数 $N,S$，代表序列长度以及测试点类型。  \n第二行 $N$ 个整数 $A_i$ 代表这个序列。", "outputFormat": "第一行一个整数 $K$ 代表操作次数，你不需要使得 $K$ 最小，你只需要满足 $0 \\le  K \\le 4 \\times 10^4$。         \n接下来 $K$ 行每行两个整数 $i,j$ 代表要把 $A_i$ 修改为 $A_i \\oplus A_j$，其中 $j=i+1$ 或 $i-1$。", "hint": "#### 样例 1 解释\n\n$$[3, 2, 8, 4, 1] \\to  [\\mathbf 1, 2, 8, 4, 1] \\to [1, 2, 8, \\mathbf{12}, 1] \\to [1, 2, 8, 12, \\mathbf{ 13}]$$\n\n#### 样例 2 解释\n\n$$[4, 4, 2, 0, 1] \\to [4, 4, \\mathbf6, 0, 1] \\to [4, 4, 6, \\mathbf6, 1] \\to [4, 4, 6, 6, \\mathbf7]$$\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（25 pts）：$2 \\le N \\le 150$，$S=1$，$A_i$ 互不相同。\n- Subtask 2（35 pts）：$2 \\le N \\le 200$，$S=1$，$A_i$ 互不相同。\n- Subtask 3（40 pts）：$2 \\le N \\le 1000$，$S=2$。\n\n对于 $100\\%$ 的数据：\n\n- $1 \\le S \\le 2$。\n- $2 \\le N \\le 1000$。\n- $0 \\le A_i<2^{20}$。\n\n**本题使用 Special Judge。**\n\n#### 说明\n\n翻译自 [eJOI 2020 Day2 A XOR Sort](https://ejoi2020.ge/static/assets/Day2/Problems/XorSort.pdf)。", "locale": "zh-CN"}}}
{"pid": "P7363", "type": "P", "difficulty": 6, "samples": [["3 3\n000\n111\n011\n110\n1010\n1000\n1001", "-5"], ["5 5\n00100\n10100\n11010\n00100\n01000\n11100\n011111\n001011\n101011\n110111\n100111", "6"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "2020", "eJOI（欧洲）"], "title": "[eJOI 2020] Dots and Boxes (Day2)", "background": "小 T 和小 A 在玩一种点格游戏。", "description": "首先，小 T 拿出了一张拥有 $(N+1) \\times (M+1)$ 个格点的方格纸（这些格子从上到下，从左到右可以编号为第 $1 \\sim N+1$ 行第 $1 \\sim M+1$ 列的格点），每个格点向上下左右的那个格点（如果那个方向有格点的话）连边，不难发现，会形成一个 $N \\times M$ 的方格矩阵。但是小 T 拿出的是没有连边的格点方格纸，小 T 和小 A 的目标就是在格点之间连线。\n\n游戏规则是这样的，每一轮玩家可以在两个格点之间连线，如果连完线能连好一个格子，那么这个格子就属于这个玩家了。然后玩家可以继续连线，直到连完线不能获得格子为止，就换到下一个玩家。当所有玩家都不能连线时，游戏结束。\n\n比如下面这张图即为当 $N=2,M=3$ 时两位玩家可能的连线结果：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/sngf2kqv.png)\n\n其中虚线为这一轮玩家连的线。\n\n小 A 和小 T 已经玩了许久了，你发现他们现在的方格纸满足每一个格子周围的四条边都有 **$0$ 条或 $2$ 条未被连线**，比如下面这张图就满足要求，上面这张图除了第一幅图也都满足要求：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/gzoveutp.png)\n\n并且刚好轮到小 A 了。\n\n定义小 A 和小 T 的分数 $S_A,S_T$ 为玩家从现在开始得到的分数，那么整个游戏的分数即为 $S_A-S_T$，小 A 要让整个游戏的分数变得越大越好，小 T 则反之，他们都会按照他们的目标做最优策略。\n\n你要求出他们做最优策略下得到的分数。", "inputFormat": "第一行两个整数 $N,M$ 代表方格纸的大小。\n\n接下来 $N+1$ 行每行 $M$ 个 **不用空格隔开的** 整数，包含 $0$ 和 $1$，第 $i$ 行第 $j$ 个数为 $0$ 就代表第 $i$ 行第 $j$ 列的格点与第 $i$ 行第 $j+1$ 列的格点之间没有连线，$1$ 则反之。\n\n接下来 $N$ 行每行 $M+1$ 个 **不用空格隔开的** 整数，包含 $0$ 和 $1$，第 $i$ 行第 $j$ 个数 $0$ 就代表第 $i$ 行第 $j$ 列的格点与第 $i+1$ 行第 $j$ 列的格点之间没有连线，$1$ 则反之。", "outputFormat": "", "hint": "#### 样例 1 解释\n\n下图为其中一种连线方式，红色为小 A 的操作，蓝色为小 T 的操作：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cu0mah7j.png)\n\n#### 样例 2 解释\n\n这个样例为题目描述中的第二个图片。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（20 pts）：给出的输入只包含一个连通块。\n- Subtask 2（20 pts）：$N \\times M \\le 12$。\n- Subtask 3（20 pts）：给出的输入只包含两个连通块。\n- Subtask 4（20 pts）：$N,M \\le 7$。\n- Subtask 5（20 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$3 \\le N, M \\le 20$，**每一个格子周围的四条边都有 $0$ 条或 $2$ 条未被连线**。\n\n其中一个连通块定义为已连上的边与方格纸的边缘围起来的块，比如说下面这个图有 $5$ 个连通块：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6g0pk8w2.png)\n\n注意已被玩家占有的方格不属于任意一个连通块。\n\n#### 说明\n\n翻译自 [eJOI 2020 Day2 C Dots and Boxes](https://ejoi2020.ge/static/assets/Day2/Problems/Game.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[eJOI 2020] Dots and Boxes (Day2)", "background": "小 T 和小 A 在玩一种点格游戏。", "description": "首先，小 T 拿出了一张拥有 $(N+1) \\times (M+1)$ 个格点的方格纸（这些格子从上到下，从左到右可以编号为第 $1 \\sim N+1$ 行第 $1 \\sim M+1$ 列的格点），每个格点向上下左右的那个格点（如果那个方向有格点的话）连边，不难发现，会形成一个 $N \\times M$ 的方格矩阵。但是小 T 拿出的是没有连边的格点方格纸，小 T 和小 A 的目标就是在格点之间连线。\n\n游戏规则是这样的，每一轮玩家可以在两个格点之间连线，如果连完线能连好一个格子，那么这个格子就属于这个玩家了。然后玩家可以继续连线，直到连完线不能获得格子为止，就换到下一个玩家。当所有玩家都不能连线时，游戏结束。\n\n比如下面这张图即为当 $N=2,M=3$ 时两位玩家可能的连线结果：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/sngf2kqv.png)\n\n其中虚线为这一轮玩家连的线。\n\n小 A 和小 T 已经玩了许久了，你发现他们现在的方格纸满足每一个格子周围的四条边都有 **$0$ 条或 $2$ 条未被连线**，比如下面这张图就满足要求，上面这张图除了第一幅图也都满足要求：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/gzoveutp.png)\n\n并且刚好轮到小 A 了。\n\n定义小 A 和小 T 的分数 $S_A,S_T$ 为玩家从现在开始得到的分数，那么整个游戏的分数即为 $S_A-S_T$，小 A 要让整个游戏的分数变得越大越好，小 T 则反之，他们都会按照他们的目标做最优策略。\n\n你要求出他们做最优策略下得到的分数。", "inputFormat": "第一行两个整数 $N,M$ 代表方格纸的大小。\n\n接下来 $N+1$ 行每行 $M$ 个 **不用空格隔开的** 整数，包含 $0$ 和 $1$，第 $i$ 行第 $j$ 个数为 $0$ 就代表第 $i$ 行第 $j$ 列的格点与第 $i$ 行第 $j+1$ 列的格点之间没有连线，$1$ 则反之。\n\n接下来 $N$ 行每行 $M+1$ 个 **不用空格隔开的** 整数，包含 $0$ 和 $1$，第 $i$ 行第 $j$ 个数 $0$ 就代表第 $i$ 行第 $j$ 列的格点与第 $i+1$ 行第 $j$ 列的格点之间没有连线，$1$ 则反之。", "outputFormat": "", "hint": "#### 样例 1 解释\n\n下图为其中一种连线方式，红色为小 A 的操作，蓝色为小 T 的操作：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cu0mah7j.png)\n\n#### 样例 2 解释\n\n这个样例为题目描述中的第二个图片。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（20 pts）：给出的输入只包含一个连通块。\n- Subtask 2（20 pts）：$N \\times M \\le 12$。\n- Subtask 3（20 pts）：给出的输入只包含两个连通块。\n- Subtask 4（20 pts）：$N,M \\le 7$。\n- Subtask 5（20 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$3 \\le N, M \\le 20$，**每一个格子周围的四条边都有 $0$ 条或 $2$ 条未被连线**。\n\n其中一个连通块定义为已连上的边与方格纸的边缘围起来的块，比如说下面这个图有 $5$ 个连通块：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6g0pk8w2.png)\n\n注意已被玩家占有的方格不属于任意一个连通块。\n\n#### 说明\n\n翻译自 [eJOI 2020 Day2 C Dots and Boxes](https://ejoi2020.ge/static/assets/Day2/Problems/Game.pdf)。", "locale": "zh-CN"}}}
{"pid": "P7364", "type": "P", "difficulty": 7, "samples": [["没有输入。", "答案的前八行：\n1\n2\n7\n41\n376\n5177\n103237\n2922446"]], "limits": {"time": [2000], "memory": [524288]}, "tags": ["O2优化", "生成函数", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "有标号二分图计数", "background": "", "description": "求 $n$ 个点的有标号二分图数目。对每个 $1\\le n\\le 10^5$ 求出答案。\n\n对 $998244353$ 取模。", "inputFormat": "没有输入。", "outputFormat": "共 $10^5$ 行，第 $i$ 行是 $i$ 个点的有标号二分图数目对 $998244353$ 取模后的值。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "有标号二分图计数", "background": "", "description": "求 $n$ 个点的有标号二分图数目。对每个 $1\\le n\\le 10^5$ 求出答案。\n\n对 $998244353$ 取模。", "inputFormat": "没有输入。", "outputFormat": "共 $10^5$ 行，第 $i$ 行是 $i$ 个点的有标号二分图数目对 $998244353$ 取模后的值。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P7365", "type": "P", "difficulty": 4, "samples": [["6 8\n1 1 1 1 1 0 0 1\n1 0 0 0 0 1 1 1\n1 0 0 0 0 0 1 1\n1 0 1 0 1 0 1 0\n1 0 0 0 0 0 0 1\n1 1 0 0 0 1 0 1", "15"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2002", "CTSC/CTS"], "title": "[CTSC2002] 颁奖典礼", "background": "IOI2002 的颁奖典礼将在 YONG-IN Hall 隆重举行。人们在经历了充满梦幻的世界杯之后变得更加富于情趣。为了使颁奖典礼更具魅力，有人建议在 YONG-IN Hall 中搭建一个 $\\text{I}$ 字型的颁奖台，以此代表信息学 Informatics。\n\n考虑到比赛的赞助商们可能要在 YONG-IN Hall 中摆设了许多展示台，他们可能不愿意移动展示台的位置。你作为 IOI2002 的金牌得主自然地成为了他们求助的对象。\n\n", "description": "YONG-IN Hall 是一个矩形的网格区域。每个赞助商的展示台都占据了若干个单位网格。$\\text{I}$ 型颁奖台将正向搭建，且平行于 YONG-IN Hall 的边缘。$\\text{I}$ 型颁奖台是由三个矩形相接叠成的，其中上方和下方的矩形的两侧必须都超出中间的矩形，否则将被误解成 $\\text{T, L, J}$ 等字母。例如：  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/lxije1kr.png)\n\n这是两个合法的 $\\text{I}$ 型颁奖台，而以下三种情况均不合法： \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/4sekuxrx.png)\n\n希望你编程寻找面积最大的 $\\text{I}$ 型颁奖台，使其不覆盖任何展示台。", "inputFormat": "第一行包含两个正整数 $n,\\,m$，分别表示 YONG-IN Hall 的矩形网格区域的行数和列数。\n\n以下 $n$ 行每行包含 $m$ 个数字 $p_{i,\\,j}$，每个数字描述一个单位网格，$1$ 表示该单位网格存在展示台，$0$ 表示该单位网格不存在展示台。", "outputFormat": "仅包含一个正整数，表示最大的 $\\text{I}$ 型颁奖台的面积。如果不存在合法的 $\\text{I}$ 型颁奖台，则输出 $0$。", "hint": "对于 $100\\%$ 的数据，$1 \\leq n,\\,m \\leq 200$，$p_{i,\\,j} \\in \\{0,\\,1\\}$。\n\n样例解释：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9zaz0leo.png)\n\n可选出的最大 $\\text{I}$ 型颁奖台面积为 $15$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CTSC2002] 颁奖典礼", "background": "IOI2002 的颁奖典礼将在 YONG-IN Hall 隆重举行。人们在经历了充满梦幻的世界杯之后变得更加富于情趣。为了使颁奖典礼更具魅力，有人建议在 YONG-IN Hall 中搭建一个 $\\text{I}$ 字型的颁奖台，以此代表信息学 Informatics。\n\n考虑到比赛的赞助商们可能要在 YONG-IN Hall 中摆设了许多展示台，他们可能不愿意移动展示台的位置。你作为 IOI2002 的金牌得主自然地成为了他们求助的对象。\n\n", "description": "YONG-IN Hall 是一个矩形的网格区域。每个赞助商的展示台都占据了若干个单位网格。$\\text{I}$ 型颁奖台将正向搭建，且平行于 YONG-IN Hall 的边缘。$\\text{I}$ 型颁奖台是由三个矩形相接叠成的，其中上方和下方的矩形的两侧必须都超出中间的矩形，否则将被误解成 $\\text{T, L, J}$ 等字母。例如：  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/lxije1kr.png)\n\n这是两个合法的 $\\text{I}$ 型颁奖台，而以下三种情况均不合法： \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/4sekuxrx.png)\n\n希望你编程寻找面积最大的 $\\text{I}$ 型颁奖台，使其不覆盖任何展示台。", "inputFormat": "第一行包含两个正整数 $n,\\,m$，分别表示 YONG-IN Hall 的矩形网格区域的行数和列数。\n\n以下 $n$ 行每行包含 $m$ 个数字 $p_{i,\\,j}$，每个数字描述一个单位网格，$1$ 表示该单位网格存在展示台，$0$ 表示该单位网格不存在展示台。", "outputFormat": "仅包含一个正整数，表示最大的 $\\text{I}$ 型颁奖台的面积。如果不存在合法的 $\\text{I}$ 型颁奖台，则输出 $0$。", "hint": "对于 $100\\%$ 的数据，$1 \\leq n,\\,m \\leq 200$，$p_{i,\\,j} \\in \\{0,\\,1\\}$。\n\n样例解释：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9zaz0leo.png)\n\n可选出的最大 $\\text{I}$ 型颁奖台面积为 $15$。", "locale": "zh-CN"}}}
{"pid": "P7366", "type": "P", "difficulty": 5, "samples": [["4 9 3", "12"], ["10 15 6", "84"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2002", "CTSC/CTS"], "title": "[CTSC2002] 月亮森林", "background": "一天早晨，一个小女孩在森林里玩耍时看到一颗神奇的种子，光芒四射，还散发着一股淡淡的清香。女孩很喜欢这\n颗种子，便把它捧在手里带回了家。 \n\n那天晚上，女孩做了一个梦，梦到一个面目慈祥的白胡子老爷爷。老爷爷对她说，她手里的种子来自一棵月亮之树，原本只有在月亮上才能见到它，但是机缘巧合，种子悄悄的落在了地球上，无法再回到月亮上了。\n\n老爷爷发现女孩儿很喜欢这颗种子，就问她是否愿意借助自己的勤劳和智慧，用这颗小小的种子种出一片茂密的月亮森林，让月亮树在地球上有一个温暖的新家。女孩兴奋地点点头，忙问老爷爷具体应该怎么做。 ", "description": "\n老人解释说，这颗种子非同寻常，种下去的第二天上午就会长成一棵高度为 $1$（一个单位）的小树苗。\n\n月亮树的生命力极强，以后还会每天上午长高一个单位。由于月亮树不同于地球上的生物，女孩必须使用一种特殊的肥料才能对它施肥，而这种肥料老爷爷每天会送给女孩儿一个单位。每天晚上，她必须给一棵树或者下午刚种下去的种子施肥，但不能多施肥，也不能不施肥。被施肥的树或者种子在第二天上午将比一般情况下多长高一个单位，即两个单位。\n\n月亮树在成长的过程中有两个称为 “收获点” 的特殊高度，分别为 $\\text{HP1}$ 和 $\\text{HP2}$。当月亮之树的高度第一次达到或者超过 $\\text{HP1}$ 的那天中午，树上就会结出一个果实。同样，当高度第一次达到或者超过 $\\text{HP2}$ 的那天中午，树上也会结出一个果实。\n\n果实里面有一颗种子, 和女孩当初捡到的一模一样。每天下午，女孩都可以选择一些种子种下去，当然也可以不种。当女孩种了恰好 $M$ 棵树，且它们的高度都相同时，这些树才能真正的适应地球的环境，永远的活下去。\n\n醒来后的那天下午，女孩儿就按照老爷爷的吩咐把种子种下去了。她把完成老爷爷交付给她的任务作为一生中最大的心愿，日复一日，年复一年辛勤的劳动着。她每天傍晚一坐在门槛上望着远方，眼前就会浮现出一片美丽而宽广的月亮森林。她坚信自己一定能成功，需要再长的时间也不怕。但是这一天何时才会来到呢？", "inputFormat": "三个整数 $\\text{HP1,\\,HP2},\\,M$，代表两个收获点的高度和所需月亮树的棵数。", "outputFormat": "仅包含一个整数 $T$，即最少需要的天数。", "hint": "对于 $100\\%$ 的数据，$2 \\leq \\text{HP1,\\,HP2} \\leq 20$，$2 \\leq M \\leq 100$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CTSC2002] 月亮森林", "background": "一天早晨，一个小女孩在森林里玩耍时看到一颗神奇的种子，光芒四射，还散发着一股淡淡的清香。女孩很喜欢这\n颗种子，便把它捧在手里带回了家。 \n\n那天晚上，女孩做了一个梦，梦到一个面目慈祥的白胡子老爷爷。老爷爷对她说，她手里的种子来自一棵月亮之树，原本只有在月亮上才能见到它，但是机缘巧合，种子悄悄的落在了地球上，无法再回到月亮上了。\n\n老爷爷发现女孩儿很喜欢这颗种子，就问她是否愿意借助自己的勤劳和智慧，用这颗小小的种子种出一片茂密的月亮森林，让月亮树在地球上有一个温暖的新家。女孩兴奋地点点头，忙问老爷爷具体应该怎么做。 ", "description": "\n老人解释说，这颗种子非同寻常，种下去的第二天上午就会长成一棵高度为 $1$（一个单位）的小树苗。\n\n月亮树的生命力极强，以后还会每天上午长高一个单位。由于月亮树不同于地球上的生物，女孩必须使用一种特殊的肥料才能对它施肥，而这种肥料老爷爷每天会送给女孩儿一个单位。每天晚上，她必须给一棵树或者下午刚种下去的种子施肥，但不能多施肥，也不能不施肥。被施肥的树或者种子在第二天上午将比一般情况下多长高一个单位，即两个单位。\n\n月亮树在成长的过程中有两个称为 “收获点” 的特殊高度，分别为 $\\text{HP1}$ 和 $\\text{HP2}$。当月亮之树的高度第一次达到或者超过 $\\text{HP1}$ 的那天中午，树上就会结出一个果实。同样，当高度第一次达到或者超过 $\\text{HP2}$ 的那天中午，树上也会结出一个果实。\n\n果实里面有一颗种子, 和女孩当初捡到的一模一样。每天下午，女孩都可以选择一些种子种下去，当然也可以不种。当女孩种了恰好 $M$ 棵树，且它们的高度都相同时，这些树才能真正的适应地球的环境，永远的活下去。\n\n醒来后的那天下午，女孩儿就按照老爷爷的吩咐把种子种下去了。她把完成老爷爷交付给她的任务作为一生中最大的心愿，日复一日，年复一年辛勤的劳动着。她每天傍晚一坐在门槛上望着远方，眼前就会浮现出一片美丽而宽广的月亮森林。她坚信自己一定能成功，需要再长的时间也不怕。但是这一天何时才会来到呢？", "inputFormat": "三个整数 $\\text{HP1,\\,HP2},\\,M$，代表两个收获点的高度和所需月亮树的棵数。", "outputFormat": "仅包含一个整数 $T$，即最少需要的天数。", "hint": "对于 $100\\%$ 的数据，$2 \\leq \\text{HP1,\\,HP2} \\leq 20$，$2 \\leq M \\leq 100$。", "locale": "zh-CN"}}}
{"pid": "P7367", "type": "P", "difficulty": 0, "samples": [["3\n-1 -1 1 -1 1 1\n1 1 2 1 2 2", "7\nLLURURD"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2002", "Special Judge", "CTSC/CTS"], "title": "[CTSC2002] 丹奇方块【征集 SPJ】", "background": "佳佳最近被一个叫做“丹奇方块”的游戏吸引住了，但是却因为游戏太难而迟迟无法通关。", "description": "游戏在一个没有边界的棋盘上进行，中心 $(0,\\,0)$ 处有一块黑色的障碍物，不远处坐标值为奇数的 $N$ 个不同的格子中各有一个灰色方块。\n\n游戏的任务是把所有灰色方块全部粘起来组成一个给定的形状，如图一所示。该形状可以出现在棋盘上的任何位置，但不能旋转或者对称。图二描述了一个合法的初始状态，其中在坐标 $(-1,\\,-1),\\,(1,\\,-1),\\,(1,\\,1)$ 处各有一个灰色方块。\n\n游戏者每次可以用上（`U`）下（`D`）左（`L`）右（`R`）四种移动指令之一让所有的灰色方块同时往一个指定的方向移动一格。如果其中一个方块前方有障碍物，只有该方块便不能移动，其他方块仍然照常移动。例如，从图二的状态使用了指令 `LLUR` 后将形成图三所示的布局。一旦出现图三这样有两个或多个方块相邻的情况，这些相邻的方块会立刻粘在一起形成一块无法分离的整体，使得在今后的移动中，只要其中任意一个方块运动前方有障碍，即使其他方块并未被挡住，这个整体也无法移动。这样，在图三的状态使用指令 `URD` 后形成图四。由于图四中的灰色方块正好组成了该形状，游戏胜利结束。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/sogsabll.png)\n\n这个游戏看起来简单，但方块数目多，目标形状又很复杂的时候游戏者往往需要很多步才能完成。佳佳希望找到一个不超过 $2000$ 步的解决方案，你能帮帮他吗？", "inputFormat": "第一行包含一个整数 $N$，即方块个数。\n\n第二行包含 $N$ 个整数对 $x_i,\\,y_i$ 其中第 $i$ 个整数对代表第 $i$ 个方块的初始位置。位置按照从上到下（即 $x$ 递增）从左到右（即 $y$ 递增）的顺序排列。\n\n第三行包含 $N$ 个整数对 $P_{x_i},\\,P_{y_i}$，代表目标形状中各小方块的相对位置。目标方块保证是一个连在一起的整体，且数据总是有解的。", "outputFormat": "第一行为需要的步数 $S$，第二行为所求移动序列。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$3 \\leq N \\leq 20$，$-9 \\leq x_i,\\,y_i \\leq 9$ 且 $x_i,\\,y_i$ 为奇数，$1 \\leq P_{x_i},\\,P_{y_i} \\leq N$。\n\n#### 样例解释\n\n参考输入格式，本题中 `D` 方向为 $x$ 轴正方向，`R` 方向为 $y$ 轴正方向。因此样例解释可参考题目描述第三段。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CTSC2002] 丹奇方块【征集 SPJ】", "background": "佳佳最近被一个叫做“丹奇方块”的游戏吸引住了，但是却因为游戏太难而迟迟无法通关。", "description": "游戏在一个没有边界的棋盘上进行，中心 $(0,\\,0)$ 处有一块黑色的障碍物，不远处坐标值为奇数的 $N$ 个不同的格子中各有一个灰色方块。\n\n游戏的任务是把所有灰色方块全部粘起来组成一个给定的形状，如图一所示。该形状可以出现在棋盘上的任何位置，但不能旋转或者对称。图二描述了一个合法的初始状态，其中在坐标 $(-1,\\,-1),\\,(1,\\,-1),\\,(1,\\,1)$ 处各有一个灰色方块。\n\n游戏者每次可以用上（`U`）下（`D`）左（`L`）右（`R`）四种移动指令之一让所有的灰色方块同时往一个指定的方向移动一格。如果其中一个方块前方有障碍物，只有该方块便不能移动，其他方块仍然照常移动。例如，从图二的状态使用了指令 `LLUR` 后将形成图三所示的布局。一旦出现图三这样有两个或多个方块相邻的情况，这些相邻的方块会立刻粘在一起形成一块无法分离的整体，使得在今后的移动中，只要其中任意一个方块运动前方有障碍，即使其他方块并未被挡住，这个整体也无法移动。这样，在图三的状态使用指令 `URD` 后形成图四。由于图四中的灰色方块正好组成了该形状，游戏胜利结束。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/sogsabll.png)\n\n这个游戏看起来简单，但方块数目多，目标形状又很复杂的时候游戏者往往需要很多步才能完成。佳佳希望找到一个不超过 $2000$ 步的解决方案，你能帮帮他吗？", "inputFormat": "第一行包含一个整数 $N$，即方块个数。\n\n第二行包含 $N$ 个整数对 $x_i,\\,y_i$ 其中第 $i$ 个整数对代表第 $i$ 个方块的初始位置。位置按照从上到下（即 $x$ 递增）从左到右（即 $y$ 递增）的顺序排列。\n\n第三行包含 $N$ 个整数对 $P_{x_i},\\,P_{y_i}$，代表目标形状中各小方块的相对位置。目标方块保证是一个连在一起的整体，且数据总是有解的。", "outputFormat": "第一行为需要的步数 $S$，第二行为所求移动序列。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$3 \\leq N \\leq 20$，$-9 \\leq x_i,\\,y_i \\leq 9$ 且 $x_i,\\,y_i$ 为奇数，$1 \\leq P_{x_i},\\,P_{y_i} \\leq N$。\n\n#### 样例解释\n\n参考输入格式，本题中 `D` 方向为 $x$ 轴正方向，`R` 方向为 $y$ 轴正方向。因此样例解释可参考题目描述第三段。", "locale": "zh-CN"}}}
{"pid": "P7368", "type": "P", "difficulty": 5, "samples": [["3 4\n1 1\n1 3\n2 2\n3 2\n\n", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2005", "USACO", "网络流", "二分图"], "title": "[USACO05NOV] Asteroids G", "background": "", "description": "贝茜想在 $N\\times N$ 的网格中驾驶她的宇宙飞船。网格中有 $K$ 个小行星。要使驾驶过程愉快，就必须把这些小行星全部消除。\n\n贝茜有一个武器，可以以一个单位代价消除一行或一列的全部小行星。贝茜想问你，要把所有小行星都消除的最小代价是多少。", "inputFormat": "第一行两个整数 $N,K$。\n\n接下来 $K$ 行，每行输入 $x_i,y_i$，表示第 $i$ 个小行星在网格的坐标。", "outputFormat": "一行一个整数，表示把所有小行星消除的最小代价。", "hint": "#### 样例解释：\n\n样例的图为（`X` 为小行星）：\n\n```text\nX.X\n.X.\n.X.\n```\n\n贝茜可以分别消除第一行和第二列的小行星。\n\n---\n\n#### 数据范围：\n\n对于 $100\\%$ 的数据，$1 \\leq N \\leq 500$，$1 \\leq K \\leq N \\times N$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO05NOV] Asteroids G", "background": "", "description": "贝茜想在 $N\\times N$ 的网格中驾驶她的宇宙飞船。网格中有 $K$ 个小行星。要使驾驶过程愉快，就必须把这些小行星全部消除。\n\n贝茜有一个武器，可以以一个单位代价消除一行或一列的全部小行星。贝茜想问你，要把所有小行星都消除的最小代价是多少。", "inputFormat": "第一行两个整数 $N,K$。\n\n接下来 $K$ 行，每行输入 $x_i,y_i$，表示第 $i$ 个小行星在网格的坐标。", "outputFormat": "一行一个整数，表示把所有小行星消除的最小代价。", "hint": "#### 样例解释：\n\n样例的图为（`X` 为小行星）：\n\n```text\nX.X\n.X.\n.X.\n```\n\n贝茜可以分别消除第一行和第二列的小行星。\n\n---\n\n#### 数据范围：\n\n对于 $100\\%$ 的数据，$1 \\leq N \\leq 500$，$1 \\leq K \\leq N \\times N$。", "locale": "zh-CN"}}}
{"pid": "P7369", "type": "P", "difficulty": 1, "samples": [["A\n3\nB A\nC B\nD A", "C\n3"], ["N\n5\nD A\nN B\nB A\nC D\nF A", "N\n1"], ["X\n4\nA X\nB X\nX A\nD A", "X\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2018", "COCI（克罗地亚）"], "title": "[COCI 2018/2019 #4] Elder", "background": "", "description": "Nikola 在一周内看完八部哈利波特电影之后，体会到了老魔杖的威力之大。如果老魔杖目前效忠于巫师 A，而巫师 A 被巫师 B 击败，则老魔杖会开始效忠于巫师 B。\n\n现在若干位巫师将进行 $N$ 次决斗。已知老魔杖最初效忠的巫师和 $N$ 次决斗的结果，求：\n\n1. 在 $N$ 次决斗之后，老魔杖效忠的对象。\n2. 老魔杖曾经效忠于几位巫师？", "inputFormat": "第一行输入一个大写字母，表示老魔杖最初效忠的巫师。\n\n第二行输入整数 $N$，表示决斗的次数。\n\n接下来的 $N$ 行中的第 $i$ 行，输入两个用空格分开的大写字母 $Z_1$ 和 $Z_2$，表示第 $i$ 次决斗，巫师 $Z_1$ 击败了巫师 $Z_2$。", "outputFormat": "第一行输出一个大写字母，表示问题 1 的答案。\n\n第二行输出一个整数，表示问题 2 的答案。", "hint": "#### 样例 1 解释\n\n老魔杖最初效忠于巫师 A。第一次决斗之后，老魔杖开始效忠于 B。第二次决斗之后，老魔杖开始效忠于 C。此后的第三次对老魔杖的效忠对象无影响。\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 100$。\n\n#### 评分方式\n\n每组数据第一行计 $2$ 分，第二行计 $3$ 分，每组数据共 $5$ 分。如果只想获得其中一行的分数，也请在另一行随意输出一个数，否则将无法正常评判。\n\n评分所需要借助的 Special Judge 详见附件。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $50$。**\n\n**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #4](https://hsin.hr/coci/archive/2018_2019/contest4_tasks.pdf)  _T1 Elder_。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2018/2019 #4] Elder", "background": "", "description": "Nikola 在一周内看完八部哈利波特电影之后，体会到了老魔杖的威力之大。如果老魔杖目前效忠于巫师 A，而巫师 A 被巫师 B 击败，则老魔杖会开始效忠于巫师 B。\n\n现在若干位巫师将进行 $N$ 次决斗。已知老魔杖最初效忠的巫师和 $N$ 次决斗的结果，求：\n\n1. 在 $N$ 次决斗之后，老魔杖效忠的对象。\n2. 老魔杖曾经效忠于几位巫师？", "inputFormat": "第一行输入一个大写字母，表示老魔杖最初效忠的巫师。\n\n第二行输入整数 $N$，表示决斗的次数。\n\n接下来的 $N$ 行中的第 $i$ 行，输入两个用空格分开的大写字母 $Z_1$ 和 $Z_2$，表示第 $i$ 次决斗，巫师 $Z_1$ 击败了巫师 $Z_2$。", "outputFormat": "第一行输出一个大写字母，表示问题 1 的答案。\n\n第二行输出一个整数，表示问题 2 的答案。", "hint": "#### 样例 1 解释\n\n老魔杖最初效忠于巫师 A。第一次决斗之后，老魔杖开始效忠于 B。第二次决斗之后，老魔杖开始效忠于 C。此后的第三次对老魔杖的效忠对象无影响。\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 100$。\n\n#### 评分方式\n\n每组数据第一行计 $2$ 分，第二行计 $3$ 分，每组数据共 $5$ 分。如果只想获得其中一行的分数，也请在另一行随意输出一个数，否则将无法正常评判。\n\n评分所需要借助的 Special Judge 详见附件。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $50$。**\n\n**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #4](https://hsin.hr/coci/archive/2018_2019/contest4_tasks.pdf)  _T1 Elder_。**", "locale": "zh-CN"}}}
{"pid": "P7370", "type": "P", "difficulty": 3, "samples": [["3 2\n2 3\n3 1", "011"], ["2 2\n2 1\n1 2", "11"], ["5 5\n3 1\n2 1\n4 3\n4 5\n2 5", "01110"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2018", "COCI（克罗地亚）"], "title": "[COCI 2018/2019 #4] Wand", "background": "Kile 看到了 Nikola 的题目之后有了灵感，便创作出了自己的版本。", "description": "$N$ 位分别用 $1,2,\\cdots,N$ 表示的巫师将参与 $M$ 次决斗。\n\n现有一个魔杖。如果魔杖目前归属于巫师 A，而巫师 A 被巫师 B 击败，则魔杖将归属于巫师 B。魔杖最初归属于巫师 $1$。\n\nKile 想知道，在只调整决斗的顺序的条件之下，魔杖最终可能会归属于谁。", "inputFormat": "第一行输入正整数 $N,M$。\n\n接下来的 $M$ 行输入正整数 $X_i,Y_i$，表示巫师 $X_i$ 将击败巫师 $Y_i$。", "outputFormat": "输出 $N$ 个字符，其中若魔杖最终可能归属于巫师 $k$，则在第 $k$ 个字符处输出 $1$，否则在此处输出 $0$。", "hint": "#### 样例 1 解释\n\n如果巫师 $1,3$ 先进行决斗，然后轮到巫师 $2,3$，魔杖将最终归属于巫师 $2$。\n\n如果巫师 $2,3$ 先进行决斗，然后轮到巫师 $1,3$，魔杖将最终归属于巫师 $3$。\n\n#### 数据规模与约定\n\n对于 $20\\%$ 的数据，$1 \\le N,M \\le 10$。\n\n对于 $100\\%$ 的数据，$1 \\le N,M \\le 10^5$，$1 \\le X_i,Y_i \\le N$，$X_i \\neq Y_i$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $70$。**\n\n**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #4](https://hsin.hr/coci/archive/2018_2019/contest4_tasks.pdf)  _T2 Wand_。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2018/2019 #4] Wand", "background": "Kile 看到了 Nikola 的题目之后有了灵感，便创作出了自己的版本。", "description": "$N$ 位分别用 $1,2,\\cdots,N$ 表示的巫师将参与 $M$ 次决斗。\n\n现有一个魔杖。如果魔杖目前归属于巫师 A，而巫师 A 被巫师 B 击败，则魔杖将归属于巫师 B。魔杖最初归属于巫师 $1$。\n\nKile 想知道，在只调整决斗的顺序的条件之下，魔杖最终可能会归属于谁。", "inputFormat": "第一行输入正整数 $N,M$。\n\n接下来的 $M$ 行输入正整数 $X_i,Y_i$，表示巫师 $X_i$ 将击败巫师 $Y_i$。", "outputFormat": "输出 $N$ 个字符，其中若魔杖最终可能归属于巫师 $k$，则在第 $k$ 个字符处输出 $1$，否则在此处输出 $0$。", "hint": "#### 样例 1 解释\n\n如果巫师 $1,3$ 先进行决斗，然后轮到巫师 $2,3$，魔杖将最终归属于巫师 $2$。\n\n如果巫师 $2,3$ 先进行决斗，然后轮到巫师 $1,3$，魔杖将最终归属于巫师 $3$。\n\n#### 数据规模与约定\n\n对于 $20\\%$ 的数据，$1 \\le N,M \\le 10$。\n\n对于 $100\\%$ 的数据，$1 \\le N,M \\le 10^5$，$1 \\le X_i,Y_i \\le N$，$X_i \\neq Y_i$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $70$。**\n\n**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #4](https://hsin.hr/coci/archive/2018_2019/contest4_tasks.pdf)  _T2 Wand_。**", "locale": "zh-CN"}}}
{"pid": "P7371", "type": "P", "difficulty": 4, "samples": [["4 3\n2 3\n2 2\n1 4\n3 2", "20"], ["3 3\n1 1\n3 3\n2 2", "18"], ["4 1\n6 4\n4 5\n19 1\n3 6", "18"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "2018", "COCI（克罗地亚）"], "title": "[COCI 2018/2019 #4] Kisik", "background": "", "description": "CAIN 组织决定建立为 $K$ 个家庭在火星上一个新的小镇，因此将建立 $K$ 幢楼房，每家一幢。对于每个家庭，CAIN 提供了 $N$ 种不同的楼房设计可供选择。\n\n楼房都互相紧挨着，以便让它们底部在同一直线上。在建设之后，城市需要进行充气，并让其保存在一个玻璃墙内。玻璃墙只能围住一片矩形区域，因此充气的范围也是一个矩形区域。\n\n求出所需最少的充气量。", "inputFormat": "第一行输入整数 $N,K$。\n\n接下来的 $N$ 行，每行输入整数 $W_i,H_i$，表示第 $i$ 幢楼房的宽度和高度。保证无重复的 $(W_i,H_i)$。", "outputFormat": "输出所需最少的充气量。", "hint": "#### 样例 1 解释\n\n该方案只需 $20$ 个单位的充气量，为最少充气量：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g4z8niml.png)\n\n#### 数据规模与约定\n\n对于 $40$ 分的数据，$N \\le 1000$。\n\n对于 $100\\%$ 的数据，$1 \\le K \\le N \\le 10^6$，$1 \\le W_i,H_i \\le 10^6$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $90$。**\n\n**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #4](https://hsin.hr/coci/archive/2018_2019/contest4_tasks.pdf)  _T3 Kisik_。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2018/2019 #4] Kisik", "background": "", "description": "CAIN 组织决定建立为 $K$ 个家庭在火星上一个新的小镇，因此将建立 $K$ 幢楼房，每家一幢。对于每个家庭，CAIN 提供了 $N$ 种不同的楼房设计可供选择。\n\n楼房都互相紧挨着，以便让它们底部在同一直线上。在建设之后，城市需要进行充气，并让其保存在一个玻璃墙内。玻璃墙只能围住一片矩形区域，因此充气的范围也是一个矩形区域。\n\n求出所需最少的充气量。", "inputFormat": "第一行输入整数 $N,K$。\n\n接下来的 $N$ 行，每行输入整数 $W_i,H_i$，表示第 $i$ 幢楼房的宽度和高度。保证无重复的 $(W_i,H_i)$。", "outputFormat": "输出所需最少的充气量。", "hint": "#### 样例 1 解释\n\n该方案只需 $20$ 个单位的充气量，为最少充气量：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g4z8niml.png)\n\n#### 数据规模与约定\n\n对于 $40$ 分的数据，$N \\le 1000$。\n\n对于 $100\\%$ 的数据，$1 \\le K \\le N \\le 10^6$，$1 \\le W_i,H_i \\le 10^6$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $90$。**\n\n**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #4](https://hsin.hr/coci/archive/2018_2019/contest4_tasks.pdf)  _T3 Kisik_。**", "locale": "zh-CN"}}}
{"pid": "P7372", "type": "P", "difficulty": 7, "samples": [["2 3 2", "5\nR 1 1\nR 1 1\nT 1 1\nT 1 1\nT 1 1"], ["3 3 12", "3\nR 1 1\nT 2 2\nT 2 1"], ["5 4 116", "-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2018", "Special Judge", "COCI（克罗地亚）"], "title": "[COCI 2018/2019 #4] Slagalica", "background": "", "description": "Jurica 创造了一个谜图游戏，它是一个 $N$ 行 $M$ 列的平行四边形，由若干个结点组成。\n\n谜图中，行从 $1$ 到 $N$，顺序为从下到上；列从 $1$ 到 $M$，顺序为从左到右。每个结点用 $(x,y)$ 表示，其中 $x,y$ 分别为行和列。每个结点有一个在 $[1,N \\times M]$ 内的唯一的整数权值。\n\n当谜图的第 $i$ 行从左到右的结点的权值分别为 $M(i-1)+1 \\sim Mi$ 时，谜图就被认为是解开了。\n\n当 $N=3,M=4$ 时，谜图如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9u5ys36s.png)\n\n谜图中可以进行两种操作：\n\n1. 选取单位大小的菱形，其中包含结点 $(x,y),(x+1,y),(x+1,y+1),(x,y+1)$，并将其顺时针旋转。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3xeumpya.png)\n\n2. 选取单位大小的等边三角形，其中包含结点 $(x,y),(x+1,y),(x,y+1)$，并将其顺时针旋转。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jntexc3i.png)\n\nJurica 进行了若干次操作，将其称为一个大操作。并将该大操作（即一系列操作）重复进行了若干次，竟然将谜图解开了。\n\n给定谜图的规模和大操作重复次数 $K$，判断是否有一种大操作，从解开的谜题开始，使得在 $K$ 次重复该大操作之后，首次再回到解开的状态。如果能解开，请输出组成大操作的操作。", "inputFormat": "输入整数 $N,M,K$。", "outputFormat": "如果没有符合题意的大操作，则输出 `-1`。\n\n否则，输出任意一种符合题意的大操作，Special Judge 见附件。\n\n若有符合题意的大操作，则在第一行输出大操作的操作次数 $B$，并在接下来的 $B$ 行以下方格式输出：\n\n- $\\texttt{R x y}$，表示调用操作 1；\n- $\\texttt{T x y}$，表示调用操作 2；\n\n其中输出的 $x,y$ 为对应操作选定的坐标 $(x,y)$。\n\n输出必须满足 $1 \\le B \\le 5 \\times 10^5$，$1 \\le X \\lt N$，$1 \\le y \\lt M$。", "hint": "#### 数据规模与约定\n\n对于 $40\\%$ 的数据，$N,M \\le 3$，$K \\le 20$。\n\n对于 $100\\%$ 的数据，$2 \\le N,M \\le 100$，$2 \\le K \\le 10^{12}$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $110$。**\n\n**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #4](https://hsin.hr/coci/archive/2018_2019/contest4_tasks.pdf)  _T4 Slagalica_。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2018/2019 #4] Slagalica", "background": "", "description": "Jurica 创造了一个谜图游戏，它是一个 $N$ 行 $M$ 列的平行四边形，由若干个结点组成。\n\n谜图中，行从 $1$ 到 $N$，顺序为从下到上；列从 $1$ 到 $M$，顺序为从左到右。每个结点用 $(x,y)$ 表示，其中 $x,y$ 分别为行和列。每个结点有一个在 $[1,N \\times M]$ 内的唯一的整数权值。\n\n当谜图的第 $i$ 行从左到右的结点的权值分别为 $M(i-1)+1 \\sim Mi$ 时，谜图就被认为是解开了。\n\n当 $N=3,M=4$ 时，谜图如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9u5ys36s.png)\n\n谜图中可以进行两种操作：\n\n1. 选取单位大小的菱形，其中包含结点 $(x,y),(x+1,y),(x+1,y+1),(x,y+1)$，并将其顺时针旋转。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3xeumpya.png)\n\n2. 选取单位大小的等边三角形，其中包含结点 $(x,y),(x+1,y),(x,y+1)$，并将其顺时针旋转。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jntexc3i.png)\n\nJurica 进行了若干次操作，将其称为一个大操作。并将该大操作（即一系列操作）重复进行了若干次，竟然将谜图解开了。\n\n给定谜图的规模和大操作重复次数 $K$，判断是否有一种大操作，从解开的谜题开始，使得在 $K$ 次重复该大操作之后，首次再回到解开的状态。如果能解开，请输出组成大操作的操作。", "inputFormat": "输入整数 $N,M,K$。", "outputFormat": "如果没有符合题意的大操作，则输出 `-1`。\n\n否则，输出任意一种符合题意的大操作，Special Judge 见附件。\n\n若有符合题意的大操作，则在第一行输出大操作的操作次数 $B$，并在接下来的 $B$ 行以下方格式输出：\n\n- $\\texttt{R x y}$，表示调用操作 1；\n- $\\texttt{T x y}$，表示调用操作 2；\n\n其中输出的 $x,y$ 为对应操作选定的坐标 $(x,y)$。\n\n输出必须满足 $1 \\le B \\le 5 \\times 10^5$，$1 \\le X \\lt N$，$1 \\le y \\lt M$。", "hint": "#### 数据规模与约定\n\n对于 $40\\%$ 的数据，$N,M \\le 3$，$K \\le 20$。\n\n对于 $100\\%$ 的数据，$2 \\le N,M \\le 100$，$2 \\le K \\le 10^{12}$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $110$。**\n\n**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #4](https://hsin.hr/coci/archive/2018_2019/contest4_tasks.pdf)  _T4 Slagalica_。**", "locale": "zh-CN"}}}
{"pid": "P7374", "type": "P", "difficulty": 2, "samples": [["8\n00:00:01,600 --> 00:00:04,200\nWe thought you was...\n\n9\n00:00:05,900 --> 00:00:07,999\na toad.\n#\n300", "8\n00:00:01,900 --> 00:00:04,500\nWe thought you was...\n\n9\n00:00:06,200 --> 00:00:08,299\na toad.\n#"], ["624\n00:43:30,566 --> 00:43:32,108\nHowdy do, ladies?\n\n625\n00:43:32,276 --> 00:43:33,943\nName of Pete.\n\n626\n00:43:47,124 --> 00:43:48,082\nAin't you gonna\nintroduce us, Pete?\n#\n-500", "624\n00:43:30,066 --> 00:43:31,608\nHowdy do, ladies?\n\n625\n00:43:31,776 --> 00:43:33,443\nName of Pete.\n\n626\n00:43:46,624 --> 00:43:47,582\nAin't you gonna\nintroduce us, Pete?\n#"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536]}, "tags": ["2018", "COCI（克罗地亚）"], "title": "[COCI 2018/2019 #5] Titlovi", "background": "", "description": "现有一个 `.SRT` 类型的文件，其由若干段字幕组成，用来再观看时载入。每段字幕又由三部分组成：\n\n- 第一行：该字幕的编号\n- 第二行字幕开始播放时间 --> 字幕结束播放时间\n- 接下来的若干行：字幕内容\n\n下面是一段字幕的例子：\n\n```plain\n1\n00:00:01,600 --> 00:00:04,200\nGood day!\n\n2\n00:00:05,900 --> 00:00:07,999\nGood day to you too!\nHere you go!\n\n3\n00:00:10,000 --> 00:00:14,000\nMay I please have ten garlic sausages?\n```\n\n时间均以 `HH:MM:SS,TTT` 格式给出，分别表示小时、分钟、秒和毫秒。规定 $1$ 秒 $=1000$ 毫秒。 \n\n有时观看时会出现时间上的差异，因此在载入字幕时需要将所有字幕调快 / 调慢一个特定的时间，并输出调整后的 `.SRT` 文件。", "inputFormat": "输入不超过 $100$ 行，表示 `.SRT` 类型文件的内容。\n\n每一段字幕的第一行，输入字幕编号。对于字幕编号，若第一段的编号为 $X$，则第 $i$ 段的必定为 $X+i-1$。\n\n每一段字幕之间用一个空行隔开。字幕内容包含英文字母、空格和字符 `,.?!.` 等。\n\n最后一段字幕的最后一行之后的一行，将包含一个字符 `#`，表示字幕部分结束。\n\n接下来的一行 / 输入的最后一行，输入整数 $T$，表示需要调整的时间。如果 $T \\ge 0$，则表示要将字幕时间向后调整 $T$ 毫秒。否则，表示要将字幕时间向前调整 $-T$ 毫秒。", "outputFormat": "输出调整时间后的 `.SRT` 文件。", "hint": "#### 数据规模与规定\n\n对于 $100\\%$ 的数据，$-10^4 \\le T \\le 10^4$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $50$。**\n\n注：经测试，官方输入文件中可能含有 `\\r` 等 Windows 下产生的字符。请大家在处理的过程中留意！\n\n**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #5](https://hsin.hr/coci/archive/2018_2019/contest5_tasks.pdf)  _T1 Titlovi_。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2018/2019 #5] Titlovi", "background": "", "description": "现有一个 `.SRT` 类型的文件，其由若干段字幕组成，用来再观看时载入。每段字幕又由三部分组成：\n\n- 第一行：该字幕的编号\n- 第二行字幕开始播放时间 --> 字幕结束播放时间\n- 接下来的若干行：字幕内容\n\n下面是一段字幕的例子：\n\n```plain\n1\n00:00:01,600 --> 00:00:04,200\nGood day!\n\n2\n00:00:05,900 --> 00:00:07,999\nGood day to you too!\nHere you go!\n\n3\n00:00:10,000 --> 00:00:14,000\nMay I please have ten garlic sausages?\n```\n\n时间均以 `HH:MM:SS,TTT` 格式给出，分别表示小时、分钟、秒和毫秒。规定 $1$ 秒 $=1000$ 毫秒。 \n\n有时观看时会出现时间上的差异，因此在载入字幕时需要将所有字幕调快 / 调慢一个特定的时间，并输出调整后的 `.SRT` 文件。", "inputFormat": "输入不超过 $100$ 行，表示 `.SRT` 类型文件的内容。\n\n每一段字幕的第一行，输入字幕编号。对于字幕编号，若第一段的编号为 $X$，则第 $i$ 段的必定为 $X+i-1$。\n\n每一段字幕之间用一个空行隔开。字幕内容包含英文字母、空格和字符 `,.?!.` 等。\n\n最后一段字幕的最后一行之后的一行，将包含一个字符 `#`，表示字幕部分结束。\n\n接下来的一行 / 输入的最后一行，输入整数 $T$，表示需要调整的时间。如果 $T \\ge 0$，则表示要将字幕时间向后调整 $T$ 毫秒。否则，表示要将字幕时间向前调整 $-T$ 毫秒。", "outputFormat": "输出调整时间后的 `.SRT` 文件。", "hint": "#### 数据规模与规定\n\n对于 $100\\%$ 的数据，$-10^4 \\le T \\le 10^4$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $50$。**\n\n注：经测试，官方输入文件中可能含有 `\\r` 等 Windows 下产生的字符。请大家在处理的过程中留意！\n\n**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #5](https://hsin.hr/coci/archive/2018_2019/contest5_tasks.pdf)  _T1 Titlovi_。**", "locale": "zh-CN"}}}
{"pid": "P7375", "type": "P", "difficulty": 3, "samples": [["1\n1\n2", "1"], ["2\n0 0\n1 1", "2"], ["2\n1 2\n5 5", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2018", "COCI（克罗地亚）"], "title": "[COCI 2018/2019 #5] Jarvis", "background": "", "description": "Ivan 拥有 $N$ 架无人机，每架无人机均有一个出厂属性值和一个出战需求属性值。他可以选定一个整数 $X$（$X$ 不一定为正整数），将所有无人机在出厂属性值的基础上加上 $X$。\n\n求能够出战（即属性值与出战需求属性值相等）的无人机的最大数量。", "inputFormat": "第一行输入整数 $N$，表示无人机的数量。\n\n第二行输入 $N$ 个整数 $A_i$，表示无人机的出厂属性值。\n\n第三行输入 $N$ 个整数 $B_i$，表示无人机的出战需求属性值。", "outputFormat": "输出能够出战的无人机的最大数量。", "hint": "#### 样例 3 解释\n\n若选定 $X=3$，则属性值分别变为 $1+3=4$ 和 $2+3=5$，则只有第二架可以出战。若 $X=4$，则属性值分别 $5$ 和 $6$，则只有第一架可以出战。可以证明，没有能够使得两架都能出战的整数 $X$。\n\n#### 数据规模与规定\n\n对于 $40\\%$ 的数据，$-10 \\le A_i,B_i \\le 10$。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 10^5$，$-10^6 \\le A_i,B_i \\le 10^6$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $70$。**\n\n**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #5](https://hsin.hr/coci/archive/2018_2019/contest5_tasks.pdf)  _T2 Jarvis_。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2018/2019 #5] Jarvis", "background": "", "description": "Ivan 拥有 $N$ 架无人机，每架无人机均有一个出厂属性值和一个出战需求属性值。他可以选定一个整数 $X$（$X$ 不一定为正整数），将所有无人机在出厂属性值的基础上加上 $X$。\n\n求能够出战（即属性值与出战需求属性值相等）的无人机的最大数量。", "inputFormat": "第一行输入整数 $N$，表示无人机的数量。\n\n第二行输入 $N$ 个整数 $A_i$，表示无人机的出厂属性值。\n\n第三行输入 $N$ 个整数 $B_i$，表示无人机的出战需求属性值。", "outputFormat": "输出能够出战的无人机的最大数量。", "hint": "#### 样例 3 解释\n\n若选定 $X=3$，则属性值分别变为 $1+3=4$ 和 $2+3=5$，则只有第二架可以出战。若 $X=4$，则属性值分别 $5$ 和 $6$，则只有第一架可以出战。可以证明，没有能够使得两架都能出战的整数 $X$。\n\n#### 数据规模与规定\n\n对于 $40\\%$ 的数据，$-10 \\le A_i,B_i \\le 10$。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 10^5$，$-10^6 \\le A_i,B_i \\le 10^6$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $70$。**\n\n**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #5](https://hsin.hr/coci/archive/2018_2019/contest5_tasks.pdf)  _T2 Jarvis_。**", "locale": "zh-CN"}}}
{"pid": "P7376", "type": "P", "difficulty": 3, "samples": [["4 2\nabcd\nacbd\nenaa\nmoze", "DA"], ["2 2\naa\naa", "DA"], ["3 2\nnec\nuuc\niti", "NE"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2018", "枚举", "COCI（克罗地亚）"], "title": "[COCI 2018/2019 #5] Ispit", "background": null, "description": "给定一个 $N$ 行 $N$ 列由小写字母组成的矩阵和整数 $K$。是否有连续的 $K$ 列，使得这 $K$ 列中每一行在行内进行重组（即只能交换同行的字母）后，能够使原矩阵有两行完全相同？", "inputFormat": "第一行输入整数 $N,K$。\n\n接下来的 $N$ 行，每行输入 $N$ 个字符，表示原来的字母矩阵。", "outputFormat": "如果有符合题意的方案，则输出 `DA`，否则输出 `NE`。", "hint": "#### 样例 1 解释\n\n选定第 $2,3$ 列，并将第 $2,3,4$ 行中的这两列的字母进行交换，得到新矩阵：\n\n```plain\nabcd\nabcd\neana\nmzoe\n```\n\n这时，第 $1,2$ 行完全相同，因此满足题意。\n\n#### 数据规模与约定\n\n对于所有数据，输入的矩阵保证由小写字母组成。\n\n对于 $30\\%$ 的数据，$N \\le 10$。\n\n对于另外 $40\\%$ 的数据，$N \\le 200$。\n\n对于 $100\\%$ 的数据，$2 \\le K \\le N \\le 500$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $90$。**\n\n**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #5](https://hsin.hr/coci/archive/2018_2019/contest5_tasks.pdf)  _T3 Ispit_。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2018/2019 #5] Ispit", "background": null, "description": "给定一个 $N$ 行 $N$ 列由小写字母组成的矩阵和整数 $K$。是否有连续的 $K$ 列，使得这 $K$ 列中每一行在行内进行重组（即只能交换同行的字母）后，能够使原矩阵有两行完全相同？", "inputFormat": "第一行输入整数 $N,K$。\n\n接下来的 $N$ 行，每行输入 $N$ 个字符，表示原来的字母矩阵。", "outputFormat": "如果有符合题意的方案，则输出 `DA`，否则输出 `NE`。", "hint": "#### 样例 1 解释\n\n选定第 $2,3$ 列，并将第 $2,3,4$ 行中的这两列的字母进行交换，得到新矩阵：\n\n```plain\nabcd\nabcd\neana\nmzoe\n```\n\n这时，第 $1,2$ 行完全相同，因此满足题意。\n\n#### 数据规模与约定\n\n对于所有数据，输入的矩阵保证由小写字母组成。\n\n对于 $30\\%$ 的数据，$N \\le 10$。\n\n对于另外 $40\\%$ 的数据，$N \\le 200$。\n\n对于 $100\\%$ 的数据，$2 \\le K \\le N \\le 500$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $90$。**\n\n**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #5](https://hsin.hr/coci/archive/2018_2019/contest5_tasks.pdf)  _T3 Ispit_。**", "locale": "zh-CN"}}}
{"pid": "P7377", "type": "P", "difficulty": 5, "samples": [["3 3\n??b\nc??\nc?c", "2"], ["4 6\nab??c?\n??kll?\na?k??c\n?bcd??", "3"], ["5 2\n??\nb?\nc?\n?g\ncg", "8"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2018", "COCI（克罗地亚）"], "title": "[COCI 2018/2019 #5] Parametriziran", "background": "", "description": "我们规定一个包含小写字母和问号的字符串为一个**参数化单词**。例如，`a??cd`，`bcd`，`??` 都属于参数化单词。\n\n如果两个参数化单词中，可以用特定的小写字母将其中的问号进行替换，并最终使得两个单词完全相同，那么原来的两个参数化单词就被称为是相似的。例如，`a???` 和 `?b?a` 都可以替换为 `abba`，因此 `a???` 和 `?b?a` 是相似的。\n\n给定 $N$ 个长度为 $M$ 的参数化单词，求有多少对相似的参数化单词。", "inputFormat": "第一行输入整数 $N,M$。\n\n接下来的 $N$ 行，每行输入一个长度为 $M$ 的参数化单词。", "outputFormat": "输出相似的参数化单词的对数。", "hint": "#### 样例 1 解释\n\n`??b` 和 `c??` 是相似的，而 `c??` 和 `c?c` 也是相似的。因此共有 $2$ 对相似的参数化单词。\n\n#### 数据规模与约定\n\n对于 $30\\%$ 的数据，$M \\le 2$。\n\n对于另外 $30\\%$ 的数据，$M \\le 4$。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 5 \\times 10^4$，$1 \\le M \\le 6$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $110$。**\n\n**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #5](https://hsin.hr/coci/archive/2018_2019/contest5_tasks.pdf)  _T4 Parametriziran_。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2018/2019 #5] Parametriziran", "background": "", "description": "我们规定一个包含小写字母和问号的字符串为一个**参数化单词**。例如，`a??cd`，`bcd`，`??` 都属于参数化单词。\n\n如果两个参数化单词中，可以用特定的小写字母将其中的问号进行替换，并最终使得两个单词完全相同，那么原来的两个参数化单词就被称为是相似的。例如，`a???` 和 `?b?a` 都可以替换为 `abba`，因此 `a???` 和 `?b?a` 是相似的。\n\n给定 $N$ 个长度为 $M$ 的参数化单词，求有多少对相似的参数化单词。", "inputFormat": "第一行输入整数 $N,M$。\n\n接下来的 $N$ 行，每行输入一个长度为 $M$ 的参数化单词。", "outputFormat": "输出相似的参数化单词的对数。", "hint": "#### 样例 1 解释\n\n`??b` 和 `c??` 是相似的，而 `c??` 和 `c?c` 也是相似的。因此共有 $2$ 对相似的参数化单词。\n\n#### 数据规模与约定\n\n对于 $30\\%$ 的数据，$M \\le 2$。\n\n对于另外 $30\\%$ 的数据，$M \\le 4$。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 5 \\times 10^4$，$1 \\le M \\le 6$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $110$。**\n\n**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #5](https://hsin.hr/coci/archive/2018_2019/contest5_tasks.pdf)  _T4 Parametriziran_。**", "locale": "zh-CN"}}}
{"pid": "P7379", "type": "P", "difficulty": 2, "samples": [["11\n7992739871x", "3"], ["5\nx2464", "5"], ["10\n93380x1696", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2018", "COCI（克罗地亚）"], "title": "[COCI 2018/2019 #6] Lun", "background": "", "description": "现有一个判断某种银行卡号是否合法的算法：\n\n1. 从倒数第二位开始从右往左，每隔一个数位就将其乘 $2$，否则保留原数位不变。\n2. 将被乘 $2$ 的数位分别计算其数位之和。\n3. 计算经过操作之后的所有数位之和，并将其乘 $9$ 再对 $10$ 取模，检验其是否等于最后一位（即银行卡号的校验码）。\n\n若待验证卡号为 $79927398713$，则判断方法如下：\n\n|银行卡号各数位|$7$|$9$|$9$|$2$|$7$|$3$|$9$|$8$|$7$|$1$|$3$|\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n|每隔一位乘 $2$（从倒数第二位开始向左）|$7$|$\\red {18}$|$9$|$\\red 4$|$7$|$\\red 6$|$9$|$\\red {16}$|$7$|$\\red 2$| -|\n|计算得到的数位和并累加|$7$|$\\green 9$|$9$|$4$|$7$|$6$|$9$|$\\green 7$|$7$|$2$|$=67$|\n\n将得到的和 $67$ 乘 $9$ 再对 $10$ 取模，得到 $67 \\times 9 \\bmod 10=3$。其中 $3$ 为该银行卡号校验码，因此原卡号合法。\n\n现有一个缺失一个数位的银行卡号，请根据上述算法在缺失数位处补充一个合适的数位，使得得到的银行卡号合法。", "inputFormat": "第一行输入整数 $N$，表示缺失数位的银行卡号的长度。\n\n第二行有一个长度为 $N$ 的字符串，表示银行卡号。该字符串中只包含数位 $0 \\sim 9$ 和字符 `x`。字符 `x` 将且仅将出现一次，表示缺失的数位。", "outputFormat": "输出符合题意的数位。如果有多种符合题意的数位，则输出最小的。", "hint": "#### 数据规模与约定\n\n对于 $50\\%$ 的数据，缺失的数位位于银行卡号校验码处，即字符 `x` 位于字符串最后一位。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 100$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $50$。**\n\n**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #6](https://hsin.hr/coci/archive/2018_2019/contest6_tasks.pdf)  _T1 Lun_。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2018/2019 #6] Lun", "background": "", "description": "现有一个判断某种银行卡号是否合法的算法：\n\n1. 从倒数第二位开始从右往左，每隔一个数位就将其乘 $2$，否则保留原数位不变。\n2. 将被乘 $2$ 的数位分别计算其数位之和。\n3. 计算经过操作之后的所有数位之和，并将其乘 $9$ 再对 $10$ 取模，检验其是否等于最后一位（即银行卡号的校验码）。\n\n若待验证卡号为 $79927398713$，则判断方法如下：\n\n|银行卡号各数位|$7$|$9$|$9$|$2$|$7$|$3$|$9$|$8$|$7$|$1$|$3$|\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n|每隔一位乘 $2$（从倒数第二位开始向左）|$7$|$\\red {18}$|$9$|$\\red 4$|$7$|$\\red 6$|$9$|$\\red {16}$|$7$|$\\red 2$| -|\n|计算得到的数位和并累加|$7$|$\\green 9$|$9$|$4$|$7$|$6$|$9$|$\\green 7$|$7$|$2$|$=67$|\n\n将得到的和 $67$ 乘 $9$ 再对 $10$ 取模，得到 $67 \\times 9 \\bmod 10=3$。其中 $3$ 为该银行卡号校验码，因此原卡号合法。\n\n现有一个缺失一个数位的银行卡号，请根据上述算法在缺失数位处补充一个合适的数位，使得得到的银行卡号合法。", "inputFormat": "第一行输入整数 $N$，表示缺失数位的银行卡号的长度。\n\n第二行有一个长度为 $N$ 的字符串，表示银行卡号。该字符串中只包含数位 $0 \\sim 9$ 和字符 `x`。字符 `x` 将且仅将出现一次，表示缺失的数位。", "outputFormat": "输出符合题意的数位。如果有多种符合题意的数位，则输出最小的。", "hint": "#### 数据规模与约定\n\n对于 $50\\%$ 的数据，缺失的数位位于银行卡号校验码处，即字符 `x` 位于字符串最后一位。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 100$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $50$。**\n\n**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #6](https://hsin.hr/coci/archive/2018_2019/contest6_tasks.pdf)  _T1 Lun_。**", "locale": "zh-CN"}}}
{"pid": "P7380", "type": "P", "difficulty": 4, "samples": [["15\n2 2 6 2\n2 2 2 6\n6 2 6 4\n6 4 6 6\n2 6 6 6\n6 2 8 2\n8 2 10 2\n10 2 12 2\n12 2 12 4\n12 4 6 4\n6 2 6 1\n8 2 8 0\n10 2 10 1\n12 2 12 0\n42 42 42 43\n2 2", "#####......\n#...#......\n#...#######\n#...#.....#\n###########\n....#.#.#.#\n......#...#"], ["6\n1 1 10 1\n10 1 10 3\n10 3 1 3\n1 3 1 1\n10 3 11 3\n11 3 11 6\n2 1", "..........#\n..........#\n..........#\n###########\n#........#.\n##########."]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["搜索", "2018", "广度优先搜索 BFS", "深度优先搜索 DFS", "COCI（克罗地亚）"], "title": "[COCI 2018/2019 #6] Konj", "background": null, "description": "Domagoj 有一种奇特的绘画手法。首先他准备了 $N$ 条待画的线段，每条线段连接两个点，即 $(A_i,B_i)$ 和 $(C_i,D_i)$。接着，他选定一个点 $T$。然后，Domagoj 将画出所有符合下列条件之一的线段：\n\n- 经过点 $T$\n- 与经过点 $T$ 的线段直接或间接相连\n\n当两条线段 $L_1,L_2$ 有一个公共端点时，我们认为 $L_1,L_2$ 是直接相连的。当线段 $L_1$ 与 $H_1$，$H_1$ 与 $H_2$，$\\cdots$，$H_k$ 与 $L_2$ 都是直接相连的，那么我们认为 $L_1,L_2$ 是间接相连的。\n\n你的任务是打印出 Domagoj 最终画出的图像。输出的形式为一个矩阵 $P$。当有线段经过 $(a,b)$ 时，应在 $P(a,b)$ 的位置输出 `#`，否则输出 `.` 字符。注意横坐标 $a$ 从左到右依次增大，纵坐标 $b$ 从下到上依次增大（这与平面直角坐标系的系统保持一致）。矩阵 $P$ 不能有任何一列或一行都是 `.` 字符，即矩阵必须在包含所有要画出的线段的前提下，在大小上最小。", "inputFormat": "第一行输入待画线段的个数 $N$。\n\n接下来的 $N$ 行，每行输入四个非负整数 $A_i,B_i,C_i,D_i$，表示第 $i$ 条线段的端点 $(A_i,B_i)$ 和 $(C_i,D_i)$。对于每条线段，$A_i \\neq C_i$ 和 $B_i \\neq D_i$ 将且仅将成立其中一个，即任何一条线段都与坐标轴平行。同时，没有线段会相交，但可能会共用同一个端点。\n\n接下来的一行（即最后一行），输入整数 $X,Y$，表示 $T$ 的坐标。保证至少有一条线段经过点 $T$。", "outputFormat": "输出所求的矩阵 $P$。", "hint": "#### 样例 1 解释\n\n除了最后一条线段，其它的都需要画出。即除了连接 $(42,42)$ 和 $(42,43)$ 的线段之外，其它都必须画出。\n\n#### 样例 2 解释\n\n所有线段都必须画出。\n\n#### 数据规模与约定\n\n对于 $30\\%$ 的数据，需要画出所有线段。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 2 \\times 10^5$，$0 \\le A_i,B_i,C_i,D_i \\le 300$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $70$。**\n\n**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #6](https://hsin.hr/coci/archive/2018_2019/contest6_tasks.pdf)  _T2 Konj_。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2018/2019 #6] Konj", "background": null, "description": "Domagoj 有一种奇特的绘画手法。首先他准备了 $N$ 条待画的线段，每条线段连接两个点，即 $(A_i,B_i)$ 和 $(C_i,D_i)$。接着，他选定一个点 $T$。然后，Domagoj 将画出所有符合下列条件之一的线段：\n\n- 经过点 $T$\n- 与经过点 $T$ 的线段直接或间接相连\n\n当两条线段 $L_1,L_2$ 有一个公共端点时，我们认为 $L_1,L_2$ 是直接相连的。当线段 $L_1$ 与 $H_1$，$H_1$ 与 $H_2$，$\\cdots$，$H_k$ 与 $L_2$ 都是直接相连的，那么我们认为 $L_1,L_2$ 是间接相连的。\n\n你的任务是打印出 Domagoj 最终画出的图像。输出的形式为一个矩阵 $P$。当有线段经过 $(a,b)$ 时，应在 $P(a,b)$ 的位置输出 `#`，否则输出 `.` 字符。注意横坐标 $a$ 从左到右依次增大，纵坐标 $b$ 从下到上依次增大（这与平面直角坐标系的系统保持一致）。矩阵 $P$ 不能有任何一列或一行都是 `.` 字符，即矩阵必须在包含所有要画出的线段的前提下，在大小上最小。", "inputFormat": "第一行输入待画线段的个数 $N$。\n\n接下来的 $N$ 行，每行输入四个非负整数 $A_i,B_i,C_i,D_i$，表示第 $i$ 条线段的端点 $(A_i,B_i)$ 和 $(C_i,D_i)$。对于每条线段，$A_i \\neq C_i$ 和 $B_i \\neq D_i$ 将且仅将成立其中一个，即任何一条线段都与坐标轴平行。同时，没有线段会相交，但可能会共用同一个端点。\n\n接下来的一行（即最后一行），输入整数 $X,Y$，表示 $T$ 的坐标。保证至少有一条线段经过点 $T$。", "outputFormat": "输出所求的矩阵 $P$。", "hint": "#### 样例 1 解释\n\n除了最后一条线段，其它的都需要画出。即除了连接 $(42,42)$ 和 $(42,43)$ 的线段之外，其它都必须画出。\n\n#### 样例 2 解释\n\n所有线段都必须画出。\n\n#### 数据规模与约定\n\n对于 $30\\%$ 的数据，需要画出所有线段。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 2 \\times 10^5$，$0 \\le A_i,B_i,C_i,D_i \\le 300$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $70$。**\n\n**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #6](https://hsin.hr/coci/archive/2018_2019/contest6_tasks.pdf)  _T2 Konj_。**", "locale": "zh-CN"}}}
{"pid": "P7381", "type": "P", "difficulty": 4, "samples": [["4 4 3\n4 2 3 1\n0 1 3 6 10", "31"], ["4 3 5\n1 1 2 3\n0 1 2 3", "12"], ["3 6 2\n2 4 1\n31 38 48 60 75 91 120", "206"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["动态规划 DP", "2018", "COCI（克罗地亚）"], "title": "[COCI 2018/2019 #6] Sličice", "background": null, "description": "Nikola 喜欢收集足球队员的照片，并将其保存在相册中。他计划收集 $N$ 支球队的队员照片，其中每支球队都有 $M$ 张。\n\n对于 Nikola 所收集的每支球队，该球队的照片数量 $x$ 能给他增加分数 $B_x$。他目前拥有球队 $i$ 的照片数量为 $P_i$。\n\nNikola 的好朋友 Ivan 有两套完整的相册。Ivan 决定送 $K$ 张照片给 Nikola。Nikola 想要知道，在得到这 $K$ 张照片之后，它的相册所能得到的分数的最大值。", "inputFormat": "第一行输入整数 $N,M,K$。\n\n第二行输入 $N$ 个整数 $P_i$。\n\n第三行输入 $M+1$ 个整数 $B_i$，其中 $B_i$ 表示一支球队收集到了 $i$ 张不同的照片能够获得 $B_i$ 分。\n\n对于 $[0,M-1]$ 内的每一个整数 $t$，都满足 $B_t \\le B_{t+1}$。同时 $K \\le N \\times M-\\sum_{i=1}^N P_i$。", "outputFormat": "输出能够得到的分数的最大值。", "hint": "#### 样例 1 解释\n\nNikola 一开始拥有球队 $1,2,3,4$ 照片数量分别为 $4,2,3,1$。最优的方案是获得球队 $2$ 照片 $2$ 张，球队 $1$ 一张。此时分数最大，为 $10+10+10+1=31$。\n\n#### 数据规模与约定\n\n对于 $20\\%$ 的数据，$K=2$。\n\n对于 $100\\%$ 的数据，$1 \\le N,M \\le 500$，$1 \\le K \\le \\min(N \\times M,500)$，$0 \\le P_i \\le M$，$0 \\le B_i \\le 10^5$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $90$。**\n\n**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #6](https://hsin.hr/coci/archive/2018_2019/contest6_tasks.pdf)  _T3 Sličice_。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2018/2019 #6] Sličice", "background": null, "description": "Nikola 喜欢收集足球队员的照片，并将其保存在相册中。他计划收集 $N$ 支球队的队员照片，其中每支球队都有 $M$ 张。\n\n对于 Nikola 所收集的每支球队，该球队的照片数量 $x$ 能给他增加分数 $B_x$。他目前拥有球队 $i$ 的照片数量为 $P_i$。\n\nNikola 的好朋友 Ivan 有两套完整的相册。Ivan 决定送 $K$ 张照片给 Nikola。Nikola 想要知道，在得到这 $K$ 张照片之后，它的相册所能得到的分数的最大值。", "inputFormat": "第一行输入整数 $N,M,K$。\n\n第二行输入 $N$ 个整数 $P_i$。\n\n第三行输入 $M+1$ 个整数 $B_i$，其中 $B_i$ 表示一支球队收集到了 $i$ 张不同的照片能够获得 $B_i$ 分。\n\n对于 $[0,M-1]$ 内的每一个整数 $t$，都满足 $B_t \\le B_{t+1}$。同时 $K \\le N \\times M-\\sum_{i=1}^N P_i$。", "outputFormat": "输出能够得到的分数的最大值。", "hint": "#### 样例 1 解释\n\nNikola 一开始拥有球队 $1,2,3,4$ 照片数量分别为 $4,2,3,1$。最优的方案是获得球队 $2$ 照片 $2$ 张，球队 $1$ 一张。此时分数最大，为 $10+10+10+1=31$。\n\n#### 数据规模与约定\n\n对于 $20\\%$ 的数据，$K=2$。\n\n对于 $100\\%$ 的数据，$1 \\le N,M \\le 500$，$1 \\le K \\le \\min(N \\times M,500)$，$0 \\le P_i \\le M$，$0 \\le B_i \\le 10^5$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $90$。**\n\n**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #6](https://hsin.hr/coci/archive/2018_2019/contest6_tasks.pdf)  _T3 Sličice_。**", "locale": "zh-CN"}}}
{"pid": "P7382", "type": "P", "difficulty": 4, "samples": [["3 0\n1 2 3\n4 5 7", "1"], ["3 1\n1 2 3\n4 5 7", "0"], ["4 1\n1 2 1 2\n5 6 7 8", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2018", "COCI（克罗地亚）"], "title": "[COCI 2018/2019 #6] Simfonija", "background": "", "description": "给定包含 $N$ 个元素的数组 $A,B$。将 $A$ 数组内的所有元素都加上一个**整数** $X$，并修改不超过 $K$ 个元素，使得下列代数式最小：\n\n$$\\sum_{i=1}^N |A_i-B_i|$$", "inputFormat": "第一行输入整数 $N,K$。\n\n第二行输入 $N$ 个整数 $A_i$。\n\n第三行输入 $N$ 个整数 $B_i$。", "outputFormat": "输出操作之后代数式的最小值。", "hint": "#### 样例 2 解释\n\n当选定 $X=3$，并将 $A$ 数组最后一个数改为 $7$ 后，$A,B$ 两数组完全相同，此时代数式的值为 $0$。\n\n#### 数据规模与约定\n\n对于 $40\\%$ 的数据，$K=0$。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 10^5$，$0 \\le K \\le N$，$-10^6 \\le A_i,B_i \\le 10^6$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $110$。**\n\n**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #6](https://hsin.hr/coci/archive/2018_2019/contest6_tasks.pdf)  _T4 Simfonija_。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2018/2019 #6] Simfonija", "background": "", "description": "给定包含 $N$ 个元素的数组 $A,B$。将 $A$ 数组内的所有元素都加上一个**整数** $X$，并修改不超过 $K$ 个元素，使得下列代数式最小：\n\n$$\\sum_{i=1}^N |A_i-B_i|$$", "inputFormat": "第一行输入整数 $N,K$。\n\n第二行输入 $N$ 个整数 $A_i$。\n\n第三行输入 $N$ 个整数 $B_i$。", "outputFormat": "输出操作之后代数式的最小值。", "hint": "#### 样例 2 解释\n\n当选定 $X=3$，并将 $A$ 数组最后一个数改为 $7$ 后，$A,B$ 两数组完全相同，此时代数式的值为 $0$。\n\n#### 数据规模与约定\n\n对于 $40\\%$ 的数据，$K=0$。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 10^5$，$0 \\le K \\le N$，$-10^6 \\le A_i,B_i \\le 10^6$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $110$。**\n\n**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #6](https://hsin.hr/coci/archive/2018_2019/contest6_tasks.pdf)  _T4 Simfonija_。**", "locale": "zh-CN"}}}
{"pid": "P7383", "type": "P", "difficulty": 3, "samples": [["4\n2 6\n3 18\n1 1\n2 4", "1 5\n3\n5 6 7\n3\n-1\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "Special Judge", "构造"], "title": "「EZEC-6」加减", "background": "", "description": "给你两个数 $n,m$，你要将 $m$ 分为 $n$ 个**互不相同的正整数**（即这 $n$ 个数之和为 $m$），使得在区间 $[1,m]$ 中至少有一个正整数无法通过这 $n$ 个数加减取得（加减时每个数最多用 $1$ 次）。\n\n即，设 $n$ 个正整数中第 $i$ 个数为 $a_i$，你要使在区间 $[1,m]$ 中至少有一个正整数无法被表示为 $\\sum\\limits^{n}_{i=1}k_i\\times a_i\\ (k_i\\in\\{-1,0,1\\})$ 的形式。\n\n若无解，输出 `-1`。\n\n若有解，则输出任意一组满足要求的 $n$ 个正整数，并输出在区间 $[1,m]$ 中无法被表示出的任意一个数。", "inputFormat": "**本题有多组数据**。\n\n第一行一个正整数 $T$，表示数据组数。\n\n对于每组数据，一行 $2$ 个正整数 $n,m$。", "outputFormat": "对于每组数据：\n\n若无解，输出一行 `-1`。\n\n若有解，第一行输出 $n$ 个正整数，表示一组满足要求的解，第二行输出一个在区间 $[1,m]$ 中的正整数，该正整数无法被表示。", "hint": "**本题采用捆绑测试**。\n\n- Subtask 1（10 points）：$n\\le2$。\n- Subtask 2（20 points）：$2n^2\\le m$。\n- Subtask 3（20 points）：$\\lceil1.5n^2\\rceil\\le m$。\n- Subtask 4（20 points）：$n\\le5$。\n- Subtask 5（30 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le T\\le100$，$1\\le n,m\\le10^4$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-6」加减", "background": "", "description": "给你两个数 $n,m$，你要将 $m$ 分为 $n$ 个**互不相同的正整数**（即这 $n$ 个数之和为 $m$），使得在区间 $[1,m]$ 中至少有一个正整数无法通过这 $n$ 个数加减取得（加减时每个数最多用 $1$ 次）。\n\n即，设 $n$ 个正整数中第 $i$ 个数为 $a_i$，你要使在区间 $[1,m]$ 中至少有一个正整数无法被表示为 $\\sum\\limits^{n}_{i=1}k_i\\times a_i\\ (k_i\\in\\{-1,0,1\\})$ 的形式。\n\n若无解，输出 `-1`。\n\n若有解，则输出任意一组满足要求的 $n$ 个正整数，并输出在区间 $[1,m]$ 中无法被表示出的任意一个数。", "inputFormat": "**本题有多组数据**。\n\n第一行一个正整数 $T$，表示数据组数。\n\n对于每组数据，一行 $2$ 个正整数 $n,m$。", "outputFormat": "对于每组数据：\n\n若无解，输出一行 `-1`。\n\n若有解，第一行输出 $n$ 个正整数，表示一组满足要求的解，第二行输出一个在区间 $[1,m]$ 中的正整数，该正整数无法被表示。", "hint": "**本题采用捆绑测试**。\n\n- Subtask 1（10 points）：$n\\le2$。\n- Subtask 2（20 points）：$2n^2\\le m$。\n- Subtask 3（20 points）：$\\lceil1.5n^2\\rceil\\le m$。\n- Subtask 4（20 points）：$n\\le5$。\n- Subtask 5（30 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le T\\le100$，$1\\le n,m\\le10^4$。", "locale": "zh-CN"}}}
{"pid": "P7384", "type": "P", "difficulty": 5, "samples": [["6\n1 1 4 5 1 4", "1"], ["7\n1 9 1 9 8 1 0", "2"], ["8\n1 9 2 6 0 8 1 7", "2"], ["9\n3 1 4 1 5 9 2 6 5", "1"], ["9\n9 9 8 2 4 4 3 5 3", "1"], ["6\n1 2 3 4 8 12", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 400, 400, 400, 400], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["贪心", "O2优化", "位运算"], "title": "「EZEC-6」分组", "background": "", "description": "给你 $n$ 个数，将它们分成任意组（可以不连续），将每个组内的数按位或，并将各组的结果累加，在保证其结果最小的情况下求最多分成的组数。", "inputFormat": "第一行输入一个正整数 $n$。\n\n第二行输入 $n$ 个非负整数 $a_i$。", "outputFormat": "一个正整数，最优解中最多分成的组数。", "hint": "以下为各个样例的一种构造方案。\n\n- $\\{1,1,4,5,1,4\\}$\n- $\\{1,9,1,9,8,1\\},\\{0\\}$\n- $\\{1,9,2,6,8,1,7\\},\\{0\\}$\n- $\\{3,1,4,1,5,9,2,6,5\\}$\n- $\\{9,9,8,2,4,4,3,5,3\\}$\n- $\\{1,2,3\\},\\{4,8,12\\}$\n\n对于样例 $6$ ，$\\{1,2,3,4,8,12\\}$ 也是一种最小化答案的方案，但是 $\\{1,2,3\\},\\{4,8,12\\}$ 分出的组数更多。\n\n本题采用捆绑测试计分。\n\n* Subtask $1$ ：$n\\leq8$，$20$ 分。\n* Subtask $2$ ：$n\\leq10^3$，$20$ 分。\n* Subtask $3$ ：$a_i\\in\\{0,1\\}$，$5$  分。\n* Subtask $4$ ：$n=10^6$，且保证数据随机，$5$ 分。\n* Subtask $5$ ：$n\\leq10^6$，$30$ 分。\n* Subtask $6$ ：$n\\leq10^7$，$20$ 分。\n\n对于所有数据，$0\\leq a_i\\leq10^{18}$，$1\\leq n\\leq10^7$。\n\n如果你不知道什么是按位或，请[点击这里](https://baike.baidu.com/item/%E6%8C%89%E4%BD%8D%E6%88%96)。\n\n本题自动开启O2优化。\n\n本题提供读入优化方式。\n\n使用 `read(x);` 读入一个任意的整型 `x` 等价于 `scanf(\"%d\", &x);`其中可以将 `%d` 自动识别为对应类型。\n\n```cpp\n#define getchar()(p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\nchar buf[1<<21],*p1=buf,*p2=buf;\ntemplate <typename T>\ninline void read(T& r) {\n\tr=0;bool w=0; char ch=getchar();\n\twhile(ch<'0'||ch>'9') w=ch=='-'?1:0,ch=getchar();\n\twhile(ch>='0'&&ch<='9') r=r*10+(ch^48), ch=getchar();\n\tr=w?-r:r;\n}\n```", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-6」分组", "background": "", "description": "给你 $n$ 个数，将它们分成任意组（可以不连续），将每个组内的数按位或，并将各组的结果累加，在保证其结果最小的情况下求最多分成的组数。", "inputFormat": "第一行输入一个正整数 $n$。\n\n第二行输入 $n$ 个非负整数 $a_i$。", "outputFormat": "一个正整数，最优解中最多分成的组数。", "hint": "以下为各个样例的一种构造方案。\n\n- $\\{1,1,4,5,1,4\\}$\n- $\\{1,9,1,9,8,1\\},\\{0\\}$\n- $\\{1,9,2,6,8,1,7\\},\\{0\\}$\n- $\\{3,1,4,1,5,9,2,6,5\\}$\n- $\\{9,9,8,2,4,4,3,5,3\\}$\n- $\\{1,2,3\\},\\{4,8,12\\}$\n\n对于样例 $6$ ，$\\{1,2,3,4,8,12\\}$ 也是一种最小化答案的方案，但是 $\\{1,2,3\\},\\{4,8,12\\}$ 分出的组数更多。\n\n本题采用捆绑测试计分。\n\n* Subtask $1$ ：$n\\leq8$，$20$ 分。\n* Subtask $2$ ：$n\\leq10^3$，$20$ 分。\n* Subtask $3$ ：$a_i\\in\\{0,1\\}$，$5$  分。\n* Subtask $4$ ：$n=10^6$，且保证数据随机，$5$ 分。\n* Subtask $5$ ：$n\\leq10^6$，$30$ 分。\n* Subtask $6$ ：$n\\leq10^7$，$20$ 分。\n\n对于所有数据，$0\\leq a_i\\leq10^{18}$，$1\\leq n\\leq10^7$。\n\n如果你不知道什么是按位或，请[点击这里](https://baike.baidu.com/item/%E6%8C%89%E4%BD%8D%E6%88%96)。\n\n本题自动开启O2优化。\n\n本题提供读入优化方式。\n\n使用 `read(x);` 读入一个任意的整型 `x` 等价于 `scanf(\"%d\", &x);`其中可以将 `%d` 自动识别为对应类型。\n\n```cpp\n#define getchar()(p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\nchar buf[1<<21],*p1=buf,*p2=buf;\ntemplate <typename T>\ninline void read(T& r) {\n\tr=0;bool w=0; char ch=getchar();\n\twhile(ch<'0'||ch>'9') w=ch=='-'?1:0,ch=getchar();\n\twhile(ch>='0'&&ch<='9') r=r*10+(ch^48), ch=getchar();\n\tr=w?-r:r;\n}\n```", "locale": "zh-CN"}}}
{"pid": "P7385", "type": "P", "difficulty": 5, "samples": [["3 0 100\n0", "14"], ["3 100 0\n0", "3"], ["3 0 0\n0", "0"], ["3 0 100\n3\n1 10\n2 10\n3 10", "44"], ["114 5 14\n3\n14 15\n92 65\n100 100", "190259152"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "矩阵乘法"], "title": "「EZEC-6」跳一跳", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/zq0mhuy7.png)\n\n小 A 最近迷上了 “跳一跳” 这个游戏。", "description": "小 A 玩的 “跳一跳” 规则如下：\n\n1. 设定一个计数器 $\\text{cnt}$，将其初始值设置为 $2$。\n2. 若跳上下一个格子但没跳到其中心，加 $1$ 分，将 $\\text{cnt}$ 重置为 $2$。\n3. 若跳上下一个格子且跳到了其中心，加 $\\text{cnt}$ 分，将 $\\text{cnt}$ 翻倍。\n4. 若下一个格子为特殊格 $x_i$ 且跳到了其中心，额外加 $y_i$ 分。\n5. 终止条件为没跳上下一个格子或者跳完了所有格子。\n\n已知共有 $n$ 个格子，编号 $1$ 到 $n$（不包含起始格）。\n\n小 A 跳上下一个格子但**没跳到**其中心的概率为 $a\\%$，跳上下一个格子且**跳到了**其中心的概率为 $b\\%$，剩余 $(100-a-b)\\%$ 为没跳上下一个格子的概率。\n\n求他的期望得分，并对 $10^9+7$ 取模。", "inputFormat": "第一行三个整数 $n,a,b$。\n\n第二行一个整数 $m$，表示共有 $m$ 个特殊格。\n\n后 $m$ 行每行两个整数 $x,y$，表示每个特殊格的编号及其额外的加分，保证 $x$ 均不相同。", "outputFormat": "一个整数表示期望得分。", "hint": "**【样例 1 解释】**\n\n小 A 每次都会跳上下一个格子且跳到其中心，期望得分为 $2+4+8=14$ 分。\n\n**【样例 2 解释】**\n\n小 A 每次都会跳上下一个格子但没跳到其中心，期望得分为 $1+1+1=3$ 分。\n\n**【样例 3 解释】**\n\n小 A 不可能跳上下一个格子，期望得分为 $0$ 分。\n\n**【样例 4 解释】**\n\n小 A 每次都会跳上下一个格子且跳到其中心，期望得分为 $2+10+4+10+8+10=44$ 分。\n\n**【数据规模与约定】**\n\n**本题采用捆绑测试。**\n\n下表中斜杠代表无特殊限制。\n\n| 子任务 | 分值 | $n$ | $a$ | $b$ | $m$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $1$ | $=1$ | $=50$ | $=50$ | / |\n| $2$ | $9$ | $\\le 20$ | / | / | $=0$ |\n| $3$ | $10$ | $\\le 20$ | / | / | / |\n| $4$ | $10$ | $\\le 10^5$ | / | / | $=0$ |\n| $5$ | $20$ | $\\le 10^5$ | / | / | / |\n| $6$ | $5$ | / | $=0$ | $=100$ | / |\n| $7$ | $5$ | / | $=100$ | $=0$ | / |\n| $8$ | $15$ | / | / | / | $=0$ |\n| $9$ | $25$ | / | / | / | / |\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^{18}$，$0\\le a,b,a+b\\le 100$，$0\\le m\\le \\min(n,10^5)$，$1\\le x\\le n$，$1\\le y\\le 100$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-6」跳一跳", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/zq0mhuy7.png)\n\n小 A 最近迷上了 “跳一跳” 这个游戏。", "description": "小 A 玩的 “跳一跳” 规则如下：\n\n1. 设定一个计数器 $\\text{cnt}$，将其初始值设置为 $2$。\n2. 若跳上下一个格子但没跳到其中心，加 $1$ 分，将 $\\text{cnt}$ 重置为 $2$。\n3. 若跳上下一个格子且跳到了其中心，加 $\\text{cnt}$ 分，将 $\\text{cnt}$ 翻倍。\n4. 若下一个格子为特殊格 $x_i$ 且跳到了其中心，额外加 $y_i$ 分。\n5. 终止条件为没跳上下一个格子或者跳完了所有格子。\n\n已知共有 $n$ 个格子，编号 $1$ 到 $n$（不包含起始格）。\n\n小 A 跳上下一个格子但**没跳到**其中心的概率为 $a\\%$，跳上下一个格子且**跳到了**其中心的概率为 $b\\%$，剩余 $(100-a-b)\\%$ 为没跳上下一个格子的概率。\n\n求他的期望得分，并对 $10^9+7$ 取模。", "inputFormat": "第一行三个整数 $n,a,b$。\n\n第二行一个整数 $m$，表示共有 $m$ 个特殊格。\n\n后 $m$ 行每行两个整数 $x,y$，表示每个特殊格的编号及其额外的加分，保证 $x$ 均不相同。", "outputFormat": "一个整数表示期望得分。", "hint": "**【样例 1 解释】**\n\n小 A 每次都会跳上下一个格子且跳到其中心，期望得分为 $2+4+8=14$ 分。\n\n**【样例 2 解释】**\n\n小 A 每次都会跳上下一个格子但没跳到其中心，期望得分为 $1+1+1=3$ 分。\n\n**【样例 3 解释】**\n\n小 A 不可能跳上下一个格子，期望得分为 $0$ 分。\n\n**【样例 4 解释】**\n\n小 A 每次都会跳上下一个格子且跳到其中心，期望得分为 $2+10+4+10+8+10=44$ 分。\n\n**【数据规模与约定】**\n\n**本题采用捆绑测试。**\n\n下表中斜杠代表无特殊限制。\n\n| 子任务 | 分值 | $n$ | $a$ | $b$ | $m$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $1$ | $=1$ | $=50$ | $=50$ | / |\n| $2$ | $9$ | $\\le 20$ | / | / | $=0$ |\n| $3$ | $10$ | $\\le 20$ | / | / | / |\n| $4$ | $10$ | $\\le 10^5$ | / | / | $=0$ |\n| $5$ | $20$ | $\\le 10^5$ | / | / | / |\n| $6$ | $5$ | / | $=0$ | $=100$ | / |\n| $7$ | $5$ | / | $=100$ | $=0$ | / |\n| $8$ | $15$ | / | / | / | $=0$ |\n| $9$ | $25$ | / | / | / | / |\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^{18}$，$0\\le a,b,a+b\\le 100$，$0\\le m\\le \\min(n,10^5)$，$1\\le x\\le n$，$1\\le y\\le 100$。", "locale": "zh-CN"}}}
{"pid": "P7386", "type": "P", "difficulty": 6, "samples": [["1\n2 4", "15"], ["2\n3 5\n114514 1919810", "4487351\n"], ["5\n78 122\n1000000 1000001\n74859432 942432534\n555555555 77777777 \n6666666666 8888888888", "12287990"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "组合数学", "逆元", "构造", "Lucas 定理"], "title": "「EZEC-6」0-1 Trie", "background": "> $\\mathbf{000111}$，这就是简单中所蕴含的优美。\n\n众所周知，tlx 不会字符串。", "description": "现在 tlx 有 $n$ 个 $\\mathbf{1}$ 和 $m$ 个 $\\mathbf{0}$，你需要把它们排列，但要保证任意的 $\\mathbf{1}$ 互不相邻且第一个位置是 $\\mathbf{0}$、最后一个位置是 $\\mathbf{1}$，现在把所有可以构造出的串放到一棵 0-1 Trie 上，需要多少个节点？\n\n**注意：节点计数时，不计算最开始的空节点，只计算代表“ $\\mathbf{0}$ ”、“ $\\mathbf{1}$ ”的节点。**  \n\n**在本题中，我们认为用节点存储字符而非边， Trie 基本原理不变。**\n\n因为答案可能很大而且询问较多，所以请在最后输出所有询问的答案对 $18888913$ （放心，是个质数）取模的结果的异或和（**异或和不再进行取模**）。", "inputFormat": "第一行是一个正整数 $T$，代表数据组数。  \n\n接下来 $T$ 行，每行两个正整数 $n,m$，分别代表 $\\mathbf{1,0}$ 的个数。", "outputFormat": "共一行一个整数，代表所有结果的异或和。", "hint": "**【样例解释 #1】**\n\n可以发现，所有能构造出的串有：  \n\n$$\\mathbf{000101}$$\n$$\\mathbf{001001}$$\n$$\\mathbf{010001}$$\n\n构造 0-1 Trie，如图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/aql3bwo6.png)\n\n共需 $15$ 个节点。\n\n\n**【样例解释 #2】**\n\n两次询问的答案分别为 $34$ 和 $4487317$。\n\n------------\n\n**【数据规模与提示】**\n\n注意：本题采用**捆绑测试**，只有当你通过一个 Subtask 内的所有测试点后，你才能拿到这个 Subtask 的分数。\n\n具体约束如下：  \n\nSubtask $1$（$10\\%$）：满足 $T\\leq 10$，$n,m\\leq 5$；\n\nSubtask $2$（$20\\%$）：满足 $T \\leq 10$，$n,m\\leq 1\\times 10^3$；\n\nSubtask $3$（$30\\%$）：满足 $T\\leq 10$，$n,m\\leq 5\\times 10^5$;\n\n\nSubtask $4$（$40\\%$）：无特殊限制。\n\n对于 $100\\%$ 的数据，满足 $1\\le T \\le 2\\times10^6$，$1\\le n,m\\le 5\\times 10^{18}$。\n\n**本题输入量较大，建议采用较为快速的读入方式并注意常数因子对程序效率带来的影响。**\n\n\n\n------------\n 0-1 Trie 是一种特殊的 Trie ，只有 $\\mathbf{0,1}$ 两种字符。\n \n 如果你不了解 Trie，可以查看：[OI Wiki--Trie](https://deploy-preview-980--oi-wiki.netlify.app/string/trie/)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-6」0-1 Trie", "background": "> $\\mathbf{000111}$，这就是简单中所蕴含的优美。\n\n众所周知，tlx 不会字符串。", "description": "现在 tlx 有 $n$ 个 $\\mathbf{1}$ 和 $m$ 个 $\\mathbf{0}$，你需要把它们排列，但要保证任意的 $\\mathbf{1}$ 互不相邻且第一个位置是 $\\mathbf{0}$、最后一个位置是 $\\mathbf{1}$，现在把所有可以构造出的串放到一棵 0-1 Trie 上，需要多少个节点？\n\n**注意：节点计数时，不计算最开始的空节点，只计算代表“ $\\mathbf{0}$ ”、“ $\\mathbf{1}$ ”的节点。**  \n\n**在本题中，我们认为用节点存储字符而非边， Trie 基本原理不变。**\n\n因为答案可能很大而且询问较多，所以请在最后输出所有询问的答案对 $18888913$ （放心，是个质数）取模的结果的异或和（**异或和不再进行取模**）。", "inputFormat": "第一行是一个正整数 $T$，代表数据组数。  \n\n接下来 $T$ 行，每行两个正整数 $n,m$，分别代表 $\\mathbf{1,0}$ 的个数。", "outputFormat": "共一行一个整数，代表所有结果的异或和。", "hint": "**【样例解释 #1】**\n\n可以发现，所有能构造出的串有：  \n\n$$\\mathbf{000101}$$\n$$\\mathbf{001001}$$\n$$\\mathbf{010001}$$\n\n构造 0-1 Trie，如图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/aql3bwo6.png)\n\n共需 $15$ 个节点。\n\n\n**【样例解释 #2】**\n\n两次询问的答案分别为 $34$ 和 $4487317$。\n\n------------\n\n**【数据规模与提示】**\n\n注意：本题采用**捆绑测试**，只有当你通过一个 Subtask 内的所有测试点后，你才能拿到这个 Subtask 的分数。\n\n具体约束如下：  \n\nSubtask $1$（$10\\%$）：满足 $T\\leq 10$，$n,m\\leq 5$；\n\nSubtask $2$（$20\\%$）：满足 $T \\leq 10$，$n,m\\leq 1\\times 10^3$；\n\nSubtask $3$（$30\\%$）：满足 $T\\leq 10$，$n,m\\leq 5\\times 10^5$;\n\n\nSubtask $4$（$40\\%$）：无特殊限制。\n\n对于 $100\\%$ 的数据，满足 $1\\le T \\le 2\\times10^6$，$1\\le n,m\\le 5\\times 10^{18}$。\n\n**本题输入量较大，建议采用较为快速的读入方式并注意常数因子对程序效率带来的影响。**\n\n\n\n------------\n 0-1 Trie 是一种特殊的 Trie ，只有 $\\mathbf{0,1}$ 两种字符。\n \n 如果你不了解 Trie，可以查看：[OI Wiki--Trie](https://deploy-preview-980--oi-wiki.netlify.app/string/trie/)。", "locale": "zh-CN"}}}
{"pid": "P7387", "type": "P", "difficulty": 6, "samples": [["4\n3\n101\n5\n01100\n5\n01110\n4\n1000", "WIN\nTIE\nWIN\nLOSE"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["博弈论"], "title": "「EZEC-6」象棋", "background": "> 万籁停吹奏\n$\\newline$支颐听秋水问蜉蝣\n$\\newline$既玄冥不可量北斗\n$\\newline$却何信相思最温柔\n", "description": "象棋将会由两个玩家进行游玩，其中红方为先手，黑方为后手。象棋里有很多种棋子，PF 对其中的“炮”情有独钟，炮的操作为：如果任意一方的某个炮和对方的某个炮之间的位置上**有且仅有一个炮**，那么这一方可以将对方的炮移出棋盘，并将他的炮移到对方的炮的位置。\n\nPF 厌倦了传统象棋的玩法，因此他拿出了一张 $1$ 行 $n$ 列的棋盘。棋盘上的每个位置都有且仅有一个炮，每个炮都隶属于红方或黑方。对于每个回合，操作方可以进行一次操作，也可以不进行操作，然后将操作权交给对手。若双方均同意结束或者无棋可动，游戏结束。\n\n\n游戏将进行 $T$ 局。每一局 PF 都是红方。定义游戏的胜利条件为一方的剩余的炮的数量大于对方。他想知道，若双方均使用最佳策略，他是否有必胜策略。", "inputFormat": "第一行一个整数 $T$，表示测试数据的数量。\n\n对于每组数据，第一行一个整数 $n$，表示棋盘大小。\n\n接下来一行一个字符串，其中第 $i$ 个整数 $a_i$ 表示第 $i$ 个棋子的种类，其中 $1$ 表示红方的炮， $0$ 表示黑方的炮。", "outputFormat": "输出共 $T$ 行，若第 $i$ 组有必胜策略，输出 `WIN`，若为平局输出 `TIE`，否则输出 `LOSE`。", "hint": "**由于本题输入量较大，请使用较快的读入方法。**\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n|子任务编号|$T\\le$|$n\\le$|$\\sum n\\le$|分值|\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$20$|$3$|$60$|$5$|\n|$2$|$10^3$|$6$|$6\\times10^3$|$10$|\n|$3$|$10^5$|$15$|$1.5\\times10^6$|$15$|\n|$4$|$200$|$200$|$500$|$20$|\n|$5$|$10^5$|$10^6$|$2\\times10^6$|$25$|\n|$6$|$10^5$|$10^7$|$2\\times10^7$|$25$|\n\n对于 $100\\%$ 的数据， $1\\le T \\le 10^5$，$1 \\le n \\le 10^7$，$\\sum n \\le 2\\times 10^7$，$a \\in \\{0,1\\}$。\n\n**【样例解释】**\n\n对于第一组数据，没有任何棋子能够移动，而棋面红棋子数大于黑棋，故先手有必胜策略。\n\n对于第二组数据，一种平局的变化如下：\n\n```cpp\n0 1 1* 0 0*\n0 1 0 1\n```\t\n\n对于第三组数据，双方的最佳策略有如下两种可能：\n```cpp\n0 1 1* 1 0*\n0* 1 1* 1\n1 0 1\n```\n\n```cpp\n0* 1 1* 1 0\n1 1* 1 0*\n1 0 1\n```\n两种结果均为红炮剩余数量多，故红棋必胜。\n\n对于第四组数据，红棋只有一种操作可行：\n\n```cpp\n1* 0 0* 0\n0 1 0\n```\n无棋可走后黑炮数量更多。\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-6」象棋", "background": "> 万籁停吹奏\n$\\newline$支颐听秋水问蜉蝣\n$\\newline$既玄冥不可量北斗\n$\\newline$却何信相思最温柔\n", "description": "象棋将会由两个玩家进行游玩，其中红方为先手，黑方为后手。象棋里有很多种棋子，PF 对其中的“炮”情有独钟，炮的操作为：如果任意一方的某个炮和对方的某个炮之间的位置上**有且仅有一个炮**，那么这一方可以将对方的炮移出棋盘，并将他的炮移到对方的炮的位置。\n\nPF 厌倦了传统象棋的玩法，因此他拿出了一张 $1$ 行 $n$ 列的棋盘。棋盘上的每个位置都有且仅有一个炮，每个炮都隶属于红方或黑方。对于每个回合，操作方可以进行一次操作，也可以不进行操作，然后将操作权交给对手。若双方均同意结束或者无棋可动，游戏结束。\n\n\n游戏将进行 $T$ 局。每一局 PF 都是红方。定义游戏的胜利条件为一方的剩余的炮的数量大于对方。他想知道，若双方均使用最佳策略，他是否有必胜策略。", "inputFormat": "第一行一个整数 $T$，表示测试数据的数量。\n\n对于每组数据，第一行一个整数 $n$，表示棋盘大小。\n\n接下来一行一个字符串，其中第 $i$ 个整数 $a_i$ 表示第 $i$ 个棋子的种类，其中 $1$ 表示红方的炮， $0$ 表示黑方的炮。", "outputFormat": "输出共 $T$ 行，若第 $i$ 组有必胜策略，输出 `WIN`，若为平局输出 `TIE`，否则输出 `LOSE`。", "hint": "**由于本题输入量较大，请使用较快的读入方法。**\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n|子任务编号|$T\\le$|$n\\le$|$\\sum n\\le$|分值|\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$20$|$3$|$60$|$5$|\n|$2$|$10^3$|$6$|$6\\times10^3$|$10$|\n|$3$|$10^5$|$15$|$1.5\\times10^6$|$15$|\n|$4$|$200$|$200$|$500$|$20$|\n|$5$|$10^5$|$10^6$|$2\\times10^6$|$25$|\n|$6$|$10^5$|$10^7$|$2\\times10^7$|$25$|\n\n对于 $100\\%$ 的数据， $1\\le T \\le 10^5$，$1 \\le n \\le 10^7$，$\\sum n \\le 2\\times 10^7$，$a \\in \\{0,1\\}$。\n\n**【样例解释】**\n\n对于第一组数据，没有任何棋子能够移动，而棋面红棋子数大于黑棋，故先手有必胜策略。\n\n对于第二组数据，一种平局的变化如下：\n\n```cpp\n0 1 1* 0 0*\n0 1 0 1\n```\t\n\n对于第三组数据，双方的最佳策略有如下两种可能：\n```cpp\n0 1 1* 1 0*\n0* 1 1* 1\n1 0 1\n```\n\n```cpp\n0* 1 1* 1 0\n1 1* 1 0*\n1 0 1\n```\n两种结果均为红炮剩余数量多，故红棋必胜。\n\n对于第四组数据，红棋只有一种操作可行：\n\n```cpp\n1* 0 0* 0\n0 1 0\n```\n无棋可走后黑炮数量更多。\n\n", "locale": "zh-CN"}}}
{"pid": "P7389", "type": "P", "difficulty": 7, "samples": [["3\n1 1\n0 3\n1 3", "2\nBA\n3\nAAB\n3\nABA"]], "limits": {"time": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["Special Judge", "O2优化", "构造"], "title": "「EZEC-6」游戏", "background": "", "description": "Alice 和 Bob 玩游戏。\n\nAlice 初始有 $n$ 个石子，Bob 初始有 $m$ 个石子，他们进行若干轮游戏，第 $i$ 轮游戏的输者给赢者 $i$ 个石子，当某一轮输者的石子不足时，停止游戏。\n\n给定 $n,m$，求出游戏最多进行的轮数（不包含结束轮），并构造一个只包含 `A` 与 `B` 的胜负序列，满足该序列的长度为你的答案，并且任何时刻每个人手里的石子数非负。\n\n", "inputFormat": "**本题有多组数据**。\n\n第一行一个正整数 $T$，表示数据组数。\n\n对于每组数据：\n\n一行 $2$ 个非负整数 $n,m$。", "outputFormat": "对于每组数据：\n\n第一行一个整数，表示游戏最多进行的轮数，记你的答案为 $x$；\n\n第二行一个长度为 $x$ 的字符串，表示胜负序列。\n\n若第 $i$ 轮 Alice 赢，则你的胜负序列的第 $i$ 位为 `A`，若第 $i$ 轮 Bob 赢，则你的胜负序列的第 $i$ 位为 `B`。", "hint": "**本题采用捆绑测试**。\n\n- Subtask 1（6 points）：$n+m\\le15$。\n- Subtask 2（8 points）：$n=m$。\n- Subtask 3（8 points）：$\\sum n+m\\le10^3$。\n- Subtask 4（8 points）：$\\sum n+m\\le2\\times10^4$。\n- Subtask 5（25 points）：$\\sum n+m\\le4\\times10^5$。\n- Subtask 6（45 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le T\\le10^3$，$0\\le n,m\\le2\\times10^7$，$1\\le n+m\\le2\\times10^7$，$\\sum n+m\\le2\\times10^7$。\n\n如果你答对了最多进行的轮数，而你构造的胜负序列不合法，你将得到该测试点 $20\\%$ 的分数（下取整）。\n\n注意，若你无法构造胜负序列，也请输出一个长度不为零的字符串。\n\n**本题输出量较大，请使用较快的输出方法。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-6」游戏", "background": "", "description": "Alice 和 Bob 玩游戏。\n\nAlice 初始有 $n$ 个石子，Bob 初始有 $m$ 个石子，他们进行若干轮游戏，第 $i$ 轮游戏的输者给赢者 $i$ 个石子，当某一轮输者的石子不足时，停止游戏。\n\n给定 $n,m$，求出游戏最多进行的轮数（不包含结束轮），并构造一个只包含 `A` 与 `B` 的胜负序列，满足该序列的长度为你的答案，并且任何时刻每个人手里的石子数非负。\n\n", "inputFormat": "**本题有多组数据**。\n\n第一行一个正整数 $T$，表示数据组数。\n\n对于每组数据：\n\n一行 $2$ 个非负整数 $n,m$。", "outputFormat": "对于每组数据：\n\n第一行一个整数，表示游戏最多进行的轮数，记你的答案为 $x$；\n\n第二行一个长度为 $x$ 的字符串，表示胜负序列。\n\n若第 $i$ 轮 Alice 赢，则你的胜负序列的第 $i$ 位为 `A`，若第 $i$ 轮 Bob 赢，则你的胜负序列的第 $i$ 位为 `B`。", "hint": "**本题采用捆绑测试**。\n\n- Subtask 1（6 points）：$n+m\\le15$。\n- Subtask 2（8 points）：$n=m$。\n- Subtask 3（8 points）：$\\sum n+m\\le10^3$。\n- Subtask 4（8 points）：$\\sum n+m\\le2\\times10^4$。\n- Subtask 5（25 points）：$\\sum n+m\\le4\\times10^5$。\n- Subtask 6（45 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le T\\le10^3$，$0\\le n,m\\le2\\times10^7$，$1\\le n+m\\le2\\times10^7$，$\\sum n+m\\le2\\times10^7$。\n\n如果你答对了最多进行的轮数，而你构造的胜负序列不合法，你将得到该测试点 $20\\%$ 的分数（下取整）。\n\n注意，若你无法构造胜负序列，也请输出一个长度不为零的字符串。\n\n**本题输出量较大，请使用较快的输出方法。**", "locale": "zh-CN"}}}
{"pid": "P7390", "type": "P", "difficulty": 7, "samples": [["0\n5\n1 2 3 1 1 \n5 3 1 7 9", "42"], ["1\n10\n114514", "249899101316"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["贪心", "2021", "O2优化", "排序", "构造", "双指针 two-pointer", "Ad-hoc"], "title": "「EZEC-6」造树", "background": "> 成体系的结论会产出“低猜想水平”的机械推导，但更多的题目中需要“高猜想水平”的灵感。\n\n——command_block 《考前小贴士》\n\n[](https://cdn.luogu.com.cn/upload/image_hosting/1m9hce9x.png)无脑选手出思维题。", "description": "你要帮 djy 造一棵树，满足以下条件：\n\n- 由 $n$ 个点组成。\n\n- $i$ 号点的度数为 $a_i$。\n\n定义一条边 $(i,j)$ 的价值为 $b_i\\times b_j$，你要在满足上述两个条件下，使所有边的价值和最大。\n\n保证存在这样的树。", "inputFormat": "第一行一个整数 $type$，表示数据生成方式。\n\n若 $type=0$：\n\n第二行一个整数 $n$。\n\n第三行 $n$ 个整数，第 $i$ 个数表示 $a_i$。\n\n第四行 $n$ 个整数，第 $i$ 个数表示 $b_i$。\n\n若 $type=1$：\n\n给出一个数据生成器模板：\n\n```cpp\nint a[10000005],b[10000005];\nunsigned seed;\nunsigned rnd(unsigned x){\n\tx^=x<<13;\n\tx^=x>>17;\n\tx^=x<<5;\n\treturn x;\n}\nint rad(int x,int y){\n\tseed=rnd(seed);\n\treturn seed%(y-x+1)+x;\n}\nvoid init_data(){\n\tcin>>n>>seed;\n\tfor(int i=1;i<=n;i++)\n\t\ta[i]=1,b[i]=rad(1,500000);\n\tfor(int i=1;i<=n-2;i++)\n\t\ta[rad(1,n)]++;\n}\n```\n\n第二行一个整数 $n$。\n\n之后调用 `init_data()`。\n\n第三行一个整数 $seed$。", "outputFormat": "一行一个整数 $ans$，表示最大的价值和。", "hint": "**本题采用捆绑测试。**\n\n- Subtask0 (10 pts)：$n\\le 6$，$type=0$；\n- Subtask1 (20 pts)：$n\\le 10^3$，$type=0$；\n- Subtask2 (10 pts)：$n\\le5\\times10^5$，$b_i\\le2$，$type=0$；\n- Subtask3 (20 pts)：$n\\le10^5$，$type=0$；\n- Subtask4 (20 pts)：$n\\le5\\times10^5$，$type=0$；\n- Subtask5 (20 pts)：$type=1$。\n\n对于 $100\\%$ 的数据，$2\\le n\\le10^7$，$1\\le a_i\\le n$，$1\\le b_i\\le5\\times10^5$，$type\\in\\{0,1\\}$，$0\\le seed<2^{31}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-6」造树", "background": "> 成体系的结论会产出“低猜想水平”的机械推导，但更多的题目中需要“高猜想水平”的灵感。\n\n——command_block 《考前小贴士》\n\n[](https://cdn.luogu.com.cn/upload/image_hosting/1m9hce9x.png)无脑选手出思维题。", "description": "你要帮 djy 造一棵树，满足以下条件：\n\n- 由 $n$ 个点组成。\n\n- $i$ 号点的度数为 $a_i$。\n\n定义一条边 $(i,j)$ 的价值为 $b_i\\times b_j$，你要在满足上述两个条件下，使所有边的价值和最大。\n\n保证存在这样的树。", "inputFormat": "第一行一个整数 $type$，表示数据生成方式。\n\n若 $type=0$：\n\n第二行一个整数 $n$。\n\n第三行 $n$ 个整数，第 $i$ 个数表示 $a_i$。\n\n第四行 $n$ 个整数，第 $i$ 个数表示 $b_i$。\n\n若 $type=1$：\n\n给出一个数据生成器模板：\n\n```cpp\nint a[10000005],b[10000005];\nunsigned seed;\nunsigned rnd(unsigned x){\n\tx^=x<<13;\n\tx^=x>>17;\n\tx^=x<<5;\n\treturn x;\n}\nint rad(int x,int y){\n\tseed=rnd(seed);\n\treturn seed%(y-x+1)+x;\n}\nvoid init_data(){\n\tcin>>n>>seed;\n\tfor(int i=1;i<=n;i++)\n\t\ta[i]=1,b[i]=rad(1,500000);\n\tfor(int i=1;i<=n-2;i++)\n\t\ta[rad(1,n)]++;\n}\n```\n\n第二行一个整数 $n$。\n\n之后调用 `init_data()`。\n\n第三行一个整数 $seed$。", "outputFormat": "一行一个整数 $ans$，表示最大的价值和。", "hint": "**本题采用捆绑测试。**\n\n- Subtask0 (10 pts)：$n\\le 6$，$type=0$；\n- Subtask1 (20 pts)：$n\\le 10^3$，$type=0$；\n- Subtask2 (10 pts)：$n\\le5\\times10^5$，$b_i\\le2$，$type=0$；\n- Subtask3 (20 pts)：$n\\le10^5$，$type=0$；\n- Subtask4 (20 pts)：$n\\le5\\times10^5$，$type=0$；\n- Subtask5 (20 pts)：$type=1$。\n\n对于 $100\\%$ 的数据，$2\\le n\\le10^7$，$1\\le a_i\\le n$，$1\\le b_i\\le5\\times10^5$，$type\\in\\{0,1\\}$，$0\\le seed<2^{31}$。", "locale": "zh-CN"}}}
{"pid": "P7391", "type": "P", "difficulty": 3, "samples": [["2 1\n1 2\n3 4", "0"], ["3 2\n1 3\n1 3\n2 4", "1"], ["2 1\n1 3\n3 5", "0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "平衡树", "排序"], "title": "「TOCO Round 1」自适应 PVZ", "background": "爆切今天的毒瘤三维计算几何后，$\\color{black}\\texttt{Q}\\color{red}\\texttt{wQcOrZ}$ 打开了某个有趣的 exe 文件。", "description": "可怜的 $\\color{black}\\texttt Q\\color{red}\\texttt{wQcOrZ}$ 在草坪上遇到了 $n$ 只僵尸，第 $i$ 只僵尸在 $l_i$ 时刻出现，会在 $r_i$ 时刻走进房子。\n\n$\\color{black}\\texttt Q\\color{red}\\texttt{wQcOrZ}$ 手头有 $m$ 个豌豆射手。若一个豌豆射手在 $l_i$ 至 $r_i$ 时刻（不包括两个端点）持续攻击 $i$ 僵尸则可以杀死 $i$ 僵尸，但在攻击过程中不能攻击另外两只僵尸且攻击的僵尸不能更换。\n\n现在 $\\color{black}\\texttt Q\\color{red}\\texttt{wQcOrZ}$ 想知道在合理的安排下，最少有几只僵尸会进入他的房子。", "inputFormat": "第一行两个整数 $n,m$ 表示僵尸数量和豌豆射手数量。\n\n接下来 $n$ 行每行两个整数 $l_i$ 和 $r_i$ 表示僵尸 $i$ 的出现时刻和走进房子时刻。", "outputFormat": "一个整数表示答案。", "hint": "对于 $30\\%$ 的数据，$n,m\\leq 6$。  \n对于 $60\\%$ 的数据，$n,m\\leq 10^3$。  \n对于另外 $20\\%$ 的数据，$m\\geq n$。  \n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 2\\times 10^5$，$1\\leq l_i<r_i\\leq 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「TOCO Round 1」自适应 PVZ", "background": "爆切今天的毒瘤三维计算几何后，$\\color{black}\\texttt{Q}\\color{red}\\texttt{wQcOrZ}$ 打开了某个有趣的 exe 文件。", "description": "可怜的 $\\color{black}\\texttt Q\\color{red}\\texttt{wQcOrZ}$ 在草坪上遇到了 $n$ 只僵尸，第 $i$ 只僵尸在 $l_i$ 时刻出现，会在 $r_i$ 时刻走进房子。\n\n$\\color{black}\\texttt Q\\color{red}\\texttt{wQcOrZ}$ 手头有 $m$ 个豌豆射手。若一个豌豆射手在 $l_i$ 至 $r_i$ 时刻（不包括两个端点）持续攻击 $i$ 僵尸则可以杀死 $i$ 僵尸，但在攻击过程中不能攻击另外两只僵尸且攻击的僵尸不能更换。\n\n现在 $\\color{black}\\texttt Q\\color{red}\\texttt{wQcOrZ}$ 想知道在合理的安排下，最少有几只僵尸会进入他的房子。", "inputFormat": "第一行两个整数 $n,m$ 表示僵尸数量和豌豆射手数量。\n\n接下来 $n$ 行每行两个整数 $l_i$ 和 $r_i$ 表示僵尸 $i$ 的出现时刻和走进房子时刻。", "outputFormat": "一个整数表示答案。", "hint": "对于 $30\\%$ 的数据，$n,m\\leq 6$。  \n对于 $60\\%$ 的数据，$n,m\\leq 10^3$。  \n对于另外 $20\\%$ 的数据，$m\\geq n$。  \n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 2\\times 10^5$，$1\\leq l_i<r_i\\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P7392", "type": "P", "difficulty": 4, "samples": [["3\n3 1\n10 2\n1 0", "3\n25200\n1"], ["5\n502520 0\n502520 1\n502520 2\n502520 3\n502520 4", "1\n218102685\n429650441\n770595802\n584122358"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["排序", "排列组合", "逆元"], "title": "「TOCO Round 1」奇怪的排序", "background": "欢喜不问天，风流不问天，温柔不问天，良辰不问天，良缘不问天。\n\n问你不问天。", "description": "情人节那天 $\\color{orange}\\texttt{Biadocy}$ 被虐得好惨，尤其是上流的公爵和小孩说什么《和你在一起的每一天，都叫情人节》。于是他找到了一个机会来报复。\n\n现在有 $n$ 对情人编号为 $1\\sim n$ 按任意顺序排成一列，$\\color{orange}\\texttt{Biadocy}$ 对他们执行了下面这段排序的伪代码。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yny3xh8d.png)\n\n$\\color{orange}\\texttt{Biadocy}$ 想知道有多少种初始排列满足按照这段伪代码排序后情人们的编号有序。也许这能让他好受一点。", "inputFormat": "第一行一个整数 $T$ 表示数据组数。\n\n接下来 $T$ 行每行两个整数 $n,k$ 表示情人对数和第一次调用伪代码传入的参数。", "outputFormat": "$T$ 行，每行一个整数，表示答案对 $10^9+7$ 取模的结果。", "hint": "对于前 $10\\%$ 的数据，$T=0$。  \n对于前 $30\\%$ 的数据，$T\\leq 10$，$n\\leq 7$。  \n对于另外 $10\\%$ 的数据，$k=0$。  \n对于另外 $10\\%$ 的数据，$k=100$。  \n对于 $100\\%$ 的数据，$0\\leq T\\leq 10^5$，$1\\leq n\\leq 10^6$，$0\\leq k\\leq 100$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「TOCO Round 1」奇怪的排序", "background": "欢喜不问天，风流不问天，温柔不问天，良辰不问天，良缘不问天。\n\n问你不问天。", "description": "情人节那天 $\\color{orange}\\texttt{Biadocy}$ 被虐得好惨，尤其是上流的公爵和小孩说什么《和你在一起的每一天，都叫情人节》。于是他找到了一个机会来报复。\n\n现在有 $n$ 对情人编号为 $1\\sim n$ 按任意顺序排成一列，$\\color{orange}\\texttt{Biadocy}$ 对他们执行了下面这段排序的伪代码。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yny3xh8d.png)\n\n$\\color{orange}\\texttt{Biadocy}$ 想知道有多少种初始排列满足按照这段伪代码排序后情人们的编号有序。也许这能让他好受一点。", "inputFormat": "第一行一个整数 $T$ 表示数据组数。\n\n接下来 $T$ 行每行两个整数 $n,k$ 表示情人对数和第一次调用伪代码传入的参数。", "outputFormat": "$T$ 行，每行一个整数，表示答案对 $10^9+7$ 取模的结果。", "hint": "对于前 $10\\%$ 的数据，$T=0$。  \n对于前 $30\\%$ 的数据，$T\\leq 10$，$n\\leq 7$。  \n对于另外 $10\\%$ 的数据，$k=0$。  \n对于另外 $10\\%$ 的数据，$k=100$。  \n对于 $100\\%$ 的数据，$0\\leq T\\leq 10^5$，$1\\leq n\\leq 10^6$，$0\\leq k\\leq 100$。", "locale": "zh-CN"}}}
{"pid": "P7393", "type": "P", "difficulty": 6, "samples": [["2 5", "5\n1 2\n2 3\n3 4\n4 5"], ["3 20", "16\n1 2\n1 3\n1 4\n1 5\n1 6\n1 7\n1 8\n1 9\n2 10\n2 11\n2 12\n2 13\n2 14\n2 15\n2 16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["树形数据结构", "递归", "Special Judge", "构造"], "title": "「TOCO Round 1」Eternal Star", "background": "「诚挚地祈愿」\n\n「在星辰坠落的那一瞬间」\n\n「水中倒映着两个人的身影」\n\n「交相辉映」\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7tf5iu0p.png)", "description": "Kuon 想要一棵结点数量尽可能少的树。\n\n她会给每个结点编号为一个正整数，使得相邻结点编号不同并且所有结点的编号和最小。如果存在很多种方案她会选择任意一种。\n\n请你帮忙构造出一棵树使得它在 Kuon 编号后的最大编号一定不小于 $k$。", "inputFormat": "两个整数 $k$ 和 $x$，其中 $k$ 见题目描述，$x$ 表示评分参数。", "outputFormat": "第一行一个整数 $n$ 表示你构造的树的大小。\n\n接下来 $n-1$ 行每行两个整数 $u,v$ 表示你构造的树的一条边。", "hint": "本题给分方式如下：\n\n- 如果构造的树满足要求并且 $1\\leq n\\leq x$，$1\\leq u,v\\leq n$ 那么你将获得该测试点的所有分数。\n- 否则该测试点你将获得 $0$ 分。\n\n| 测试点编号 | $k$ | $x$ |\n| :-: | :-: | :-: |\n| $1$ | $1$ | $/$ |\n| $2$ | $2$ | $/$ |\n| $3$ | $3$ | $10$ |\n| $4$ | $3$ | $8$ |\n| $5$ | $4$ | $40$ |\n| $6$ | $4$ | $34$ |\n| $7$ | $5$ | $/$ |\n| $8\\sim 16$ | $/$ | $/$ |\n| $17$ | $10$ | $53808$ |\n| $18\\sim 19$ | $/$ | $/$ |\n| $20$ | $12$ | $519616$ |\n\n对于 $100\\%$ 的数据，$1\\leq k\\leq 12$，$1\\leq x\\leq 10^6$，每个测试点必定存在一种树的构造方案能获得满分。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「TOCO Round 1」Eternal Star", "background": "「诚挚地祈愿」\n\n「在星辰坠落的那一瞬间」\n\n「水中倒映着两个人的身影」\n\n「交相辉映」\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7tf5iu0p.png)", "description": "Kuon 想要一棵结点数量尽可能少的树。\n\n她会给每个结点编号为一个正整数，使得相邻结点编号不同并且所有结点的编号和最小。如果存在很多种方案她会选择任意一种。\n\n请你帮忙构造出一棵树使得它在 Kuon 编号后的最大编号一定不小于 $k$。", "inputFormat": "两个整数 $k$ 和 $x$，其中 $k$ 见题目描述，$x$ 表示评分参数。", "outputFormat": "第一行一个整数 $n$ 表示你构造的树的大小。\n\n接下来 $n-1$ 行每行两个整数 $u,v$ 表示你构造的树的一条边。", "hint": "本题给分方式如下：\n\n- 如果构造的树满足要求并且 $1\\leq n\\leq x$，$1\\leq u,v\\leq n$ 那么你将获得该测试点的所有分数。\n- 否则该测试点你将获得 $0$ 分。\n\n| 测试点编号 | $k$ | $x$ |\n| :-: | :-: | :-: |\n| $1$ | $1$ | $/$ |\n| $2$ | $2$ | $/$ |\n| $3$ | $3$ | $10$ |\n| $4$ | $3$ | $8$ |\n| $5$ | $4$ | $40$ |\n| $6$ | $4$ | $34$ |\n| $7$ | $5$ | $/$ |\n| $8\\sim 16$ | $/$ | $/$ |\n| $17$ | $10$ | $53808$ |\n| $18\\sim 19$ | $/$ | $/$ |\n| $20$ | $12$ | $519616$ |\n\n对于 $100\\%$ 的数据，$1\\leq k\\leq 12$，$1\\leq x\\leq 10^6$，每个测试点必定存在一种树的构造方案能获得满分。", "locale": "zh-CN"}}}
{"pid": "P7394", "type": "P", "difficulty": 5, "samples": [["3\n1 2\n1 3\n6\n1 3\n2 2 2\n1 2\n2 2 2\n1 3\n2 2 2", "1\n1\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["树状数组"], "title": "「TOCO Round 1」History", "background": "", "description": "这里有一棵 $n$ 个结点根为 $1$ 号结点的树，每个结点上都有一盏灯，初始状态都是关闭。现在有 $m$ 次事件发生，有以下几种情况：\n\n`1 x` 将 $x$ 位置上的灯打开或关闭（原来如果打开就关闭，否则打开）。\n\n`2 x y` 询问树上与 $x$ 相同深度的点中与 $x$ 结点距离为 $y$ 的点中开着的灯的个数。\n\n`3 x` 回到第 $x$ 次事件发生之后的状态。\n\n对于每个 $2$ 询问请给出回答。\n\n\n\n", "inputFormat": "第一行一个数 $n$ 。\n接下来 $n-1$ 行每行两个数 $u,v$ 表示 $u$ 与 $v$ 之间一条边。接下来一个数 $m$，下面的 $m$ 行每行二或三个数表示事件的发生。", "outputFormat": "对于每次 $2$ 询问，给出答案。", "hint": "**本题采用打包测评。**\n\n* Subtask 1（10 pts）：满足所有询问中 $y \\bmod 2=1$。\n\n\n* Subtask 2（20 pts）：$n,m\\leq 10$。\n\n* Subtask 3（30 pts）：$n,m\\leq 10^3$。\n\n* Subtask 4（40 pts）：$n,m\\leq 10^5$。\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 10^5$，$3$ 操作保证 $0 \\leq x$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「TOCO Round 1」History", "background": "", "description": "这里有一棵 $n$ 个结点根为 $1$ 号结点的树，每个结点上都有一盏灯，初始状态都是关闭。现在有 $m$ 次事件发生，有以下几种情况：\n\n`1 x` 将 $x$ 位置上的灯打开或关闭（原来如果打开就关闭，否则打开）。\n\n`2 x y` 询问树上与 $x$ 相同深度的点中与 $x$ 结点距离为 $y$ 的点中开着的灯的个数。\n\n`3 x` 回到第 $x$ 次事件发生之后的状态。\n\n对于每个 $2$ 询问请给出回答。\n\n\n\n", "inputFormat": "第一行一个数 $n$ 。\n接下来 $n-1$ 行每行两个数 $u,v$ 表示 $u$ 与 $v$ 之间一条边。接下来一个数 $m$，下面的 $m$ 行每行二或三个数表示事件的发生。", "outputFormat": "对于每次 $2$ 询问，给出答案。", "hint": "**本题采用打包测评。**\n\n* Subtask 1（10 pts）：满足所有询问中 $y \\bmod 2=1$。\n\n\n* Subtask 2（20 pts）：$n,m\\leq 10$。\n\n* Subtask 3（30 pts）：$n,m\\leq 10^3$。\n\n* Subtask 4（40 pts）：$n,m\\leq 10^5$。\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 10^5$，$3$ 操作保证 $0 \\leq x$。", "locale": "zh-CN"}}}
{"pid": "P7395", "type": "P", "difficulty": 5, "samples": [["6\n\n   *\n  * *\n * * *\n* * * *\n . * *\n  . *\n   .\n\n   *\n  * *\n * * *\n. . . *\n * * *\n  * *\n   *\n\n   *\n  * *\n * * .\n* * * *\n * * .\n  * *\n   *\n\n   *\n  * *\n . . *\n* * * *\n * * *\n  * *\n   *\n\n   .\n  * *\n * * *\n* * * .\n * * *\n  * *\n   *\n\n   .\n  * .\n * * .\n* * * .\n * * *\n  * *\n   *", "Possible.\nPossible.\nPossible.\nPossible.\nImpossible.\nPossible."]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["博弈论", "2021", "记忆化搜索"], "title": "弹珠游戏（2021 CoE-I C）", "background": "", "description": "$\\operatorname{Alice}$ 对弹珠游戏已经有些厌烦了，她经常在电脑上玩这个游戏。她之所以感到厌烦是因为在这个游戏上她已经是专家级别，她总是能够和电脑打成平手。$\\operatorname{Bob}$ 为 $\\operatorname{Alice}$ 创造了一款新的电脑游戏。以下是这款两人电脑游戏的规则：\n\n（1）游戏在如下图所示的菱形棋盘上进行；\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qw7lsky0.png)\n\n（2）两名玩家轮流放置弹珠，可以在横向、纵向、$45$ 度斜线、$135$ 度斜线方向未放置弹珠的位置**连续放置 $1$ 至 $3$ 颗弹珠**，玩家在可以放置弹珠的情况下，必须至少放置 $1$ 颗弹珠。以下是合法的单次放置操作的示例（黑色圆点表示放置了弹珠，白色圆点表示未放置弹珠，进行该次操作前棋盘为空）：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/v38tajmr.png)\n\n以下是非法的单次放置操作的示例（黑色圆点表示放置了弹珠，白色圆点表示未放置弹珠，进行该次操作前棋盘为空）：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mldg0cs0.png)\n\n非法原因的解释：（$a$）三颗弹珠不在同一条斜线（或者垂直线）上；（$b$）两颗弹珠之间相隔一个空位；（$c$）三颗弹珠不在同一条斜线上；（$d$）三颗弹珠不在同一条斜线（或者垂直线）上；（$e$）一次性放置了 $4$ 颗弹珠；（$f$）三颗弹珠不在同一条水平线（或者垂直线、或者斜线）上。\n\n（3）如果某位玩家无法再继续放置弹珠，则该名玩家输掉游戏，另外一名玩家获胜。\n\n$\\operatorname{Alice}$ 总是第一个进行游戏，而且经常是和 $\\operatorname{Bob}$ 玩这个游戏，$\\operatorname{Bob}$ 在进行若干游戏操作后可能会离开，将游戏交由电脑代理，电脑总是按照最优策略放置弹珠。\n给定 $\\operatorname{Bob}$ 离开后的游戏状态，你的任务是确定 $\\operatorname{Alice}$ 是否可能在对阵电脑时获得胜利。", "inputFormat": "**输入包含多组测试数据**。\n\n输入第一行包含一个整数 $T$，表示测试数据的组数。接着是一个空行。再接下来是 $T$ 组表示棋盘状态的数据，每组数据由七行字符构成，表示 $\\operatorname{Bob}$ 离开后的游戏状态，`*` 表示该位置已经放置了弹珠，`.` 表示该位置未放置弹珠。相邻两组测试数据之间有一个空行。", "outputFormat": "对于每组测试数据，如果 $\\operatorname{Alice}$ 能够获胜，输出 `Possible.`，否则输出 `Impossible.`。", "hint": "#### 样例说明\n\n第一组数据，$\\operatorname{Alice}$ 可以选择在棋盘左下角的斜线方向所剩下的 $3$ 个空余位置一次性连续放置 $3$ 颗弹珠，使得后续电脑无法再放置弹珠，因此 $\\operatorname{Alice}$ 能够获胜。\n\n第二组数据，$\\operatorname{Alice}$ 可以选择沿着第四行剩下的 $3$ 个空余位置一次性连续放置 $3$ 颗弹珠，使得后续电脑无法再放置弹珠，因此 $\\operatorname{Alice}$ 能够获胜。\n\n第三组数据，棋盘剩下倒数第二列两个连续的空余位置，$\\operatorname{Alice}$ 可以一次放置 $2$ 颗弹珠，使得后续电脑无法放置弹珠，因此 $\\operatorname{Alice}$ 会获胜。\n\n第四组数据，类似于第二组测试数据，棋盘剩下第三行两个连续的空余位置，因此 $\\operatorname{Alice}$ 会获胜。\n\n第五组数据，棋盘只剩下两个不连续的空余位置，由于 $\\operatorname{Alice}$ 一次只能选择一个空余位置放置 $1$ 颗弹珠，因此不管 $\\operatorname{Alice}$ 如何操作，电脑总能一次性将剩下的棋盘使用弹珠填满，使得 $\\operatorname{Alice}$ 无法再继续放置弹珠，因此 $\\operatorname{Alice}$ 会输掉比赛。\n\n第六组数据，$\\operatorname{Alice}$ 可以选择在棋盘右上角斜线方向的中间两个空余位置放置 $2$ 颗弹珠，使得棋盘状态转化为样例输入的第五组数据，因此 $\\operatorname{Alice}$ 会赢得比赛。\n\n\n------------\n\n#### 数据范围\n\n对于 $10\\%$ 的数据，$0 \\lt T \\leq 10$。\n\n对于 $60\\%$ 的数据，$0 \\lt T \\leq 10^3$。\n\n对于 $80\\%$ 的数据，$0 \\lt T \\leq 10^5$。\n\n对于 $100\\%$ 的数据，$0 \\lt T \\leq 10^6$。\n\n\n------------\n\n#### 提示\n\n本题输入量较大，请使用合适的读入方式。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "弹珠游戏（2021 CoE-I C）", "background": "", "description": "$\\operatorname{Alice}$ 对弹珠游戏已经有些厌烦了，她经常在电脑上玩这个游戏。她之所以感到厌烦是因为在这个游戏上她已经是专家级别，她总是能够和电脑打成平手。$\\operatorname{Bob}$ 为 $\\operatorname{Alice}$ 创造了一款新的电脑游戏。以下是这款两人电脑游戏的规则：\n\n（1）游戏在如下图所示的菱形棋盘上进行；\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qw7lsky0.png)\n\n（2）两名玩家轮流放置弹珠，可以在横向、纵向、$45$ 度斜线、$135$ 度斜线方向未放置弹珠的位置**连续放置 $1$ 至 $3$ 颗弹珠**，玩家在可以放置弹珠的情况下，必须至少放置 $1$ 颗弹珠。以下是合法的单次放置操作的示例（黑色圆点表示放置了弹珠，白色圆点表示未放置弹珠，进行该次操作前棋盘为空）：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/v38tajmr.png)\n\n以下是非法的单次放置操作的示例（黑色圆点表示放置了弹珠，白色圆点表示未放置弹珠，进行该次操作前棋盘为空）：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mldg0cs0.png)\n\n非法原因的解释：（$a$）三颗弹珠不在同一条斜线（或者垂直线）上；（$b$）两颗弹珠之间相隔一个空位；（$c$）三颗弹珠不在同一条斜线上；（$d$）三颗弹珠不在同一条斜线（或者垂直线）上；（$e$）一次性放置了 $4$ 颗弹珠；（$f$）三颗弹珠不在同一条水平线（或者垂直线、或者斜线）上。\n\n（3）如果某位玩家无法再继续放置弹珠，则该名玩家输掉游戏，另外一名玩家获胜。\n\n$\\operatorname{Alice}$ 总是第一个进行游戏，而且经常是和 $\\operatorname{Bob}$ 玩这个游戏，$\\operatorname{Bob}$ 在进行若干游戏操作后可能会离开，将游戏交由电脑代理，电脑总是按照最优策略放置弹珠。\n给定 $\\operatorname{Bob}$ 离开后的游戏状态，你的任务是确定 $\\operatorname{Alice}$ 是否可能在对阵电脑时获得胜利。", "inputFormat": "**输入包含多组测试数据**。\n\n输入第一行包含一个整数 $T$，表示测试数据的组数。接着是一个空行。再接下来是 $T$ 组表示棋盘状态的数据，每组数据由七行字符构成，表示 $\\operatorname{Bob}$ 离开后的游戏状态，`*` 表示该位置已经放置了弹珠，`.` 表示该位置未放置弹珠。相邻两组测试数据之间有一个空行。", "outputFormat": "对于每组测试数据，如果 $\\operatorname{Alice}$ 能够获胜，输出 `Possible.`，否则输出 `Impossible.`。", "hint": "#### 样例说明\n\n第一组数据，$\\operatorname{Alice}$ 可以选择在棋盘左下角的斜线方向所剩下的 $3$ 个空余位置一次性连续放置 $3$ 颗弹珠，使得后续电脑无法再放置弹珠，因此 $\\operatorname{Alice}$ 能够获胜。\n\n第二组数据，$\\operatorname{Alice}$ 可以选择沿着第四行剩下的 $3$ 个空余位置一次性连续放置 $3$ 颗弹珠，使得后续电脑无法再放置弹珠，因此 $\\operatorname{Alice}$ 能够获胜。\n\n第三组数据，棋盘剩下倒数第二列两个连续的空余位置，$\\operatorname{Alice}$ 可以一次放置 $2$ 颗弹珠，使得后续电脑无法放置弹珠，因此 $\\operatorname{Alice}$ 会获胜。\n\n第四组数据，类似于第二组测试数据，棋盘剩下第三行两个连续的空余位置，因此 $\\operatorname{Alice}$ 会获胜。\n\n第五组数据，棋盘只剩下两个不连续的空余位置，由于 $\\operatorname{Alice}$ 一次只能选择一个空余位置放置 $1$ 颗弹珠，因此不管 $\\operatorname{Alice}$ 如何操作，电脑总能一次性将剩下的棋盘使用弹珠填满，使得 $\\operatorname{Alice}$ 无法再继续放置弹珠，因此 $\\operatorname{Alice}$ 会输掉比赛。\n\n第六组数据，$\\operatorname{Alice}$ 可以选择在棋盘右上角斜线方向的中间两个空余位置放置 $2$ 颗弹珠，使得棋盘状态转化为样例输入的第五组数据，因此 $\\operatorname{Alice}$ 会赢得比赛。\n\n\n------------\n\n#### 数据范围\n\n对于 $10\\%$ 的数据，$0 \\lt T \\leq 10$。\n\n对于 $60\\%$ 的数据，$0 \\lt T \\leq 10^3$。\n\n对于 $80\\%$ 的数据，$0 \\lt T \\leq 10^5$。\n\n对于 $100\\%$ 的数据，$0 \\lt T \\leq 10^6$。\n\n\n------------\n\n#### 提示\n\n本题输入量较大，请使用合适的读入方式。", "locale": "zh-CN"}}}
{"pid": "P7396", "type": "P", "difficulty": 6, "samples": [["6\n6 1 2 5 10 20 50 25.31\n5 1 2 2 5 10 0.18\n5 1 2 10 9 5 0.18\n6 2 5 10 20 50 100 0.03\n11 173 151 214 211 238 167 385 179 5 235 112 46.1\n13 95 180 285 205 164 82 122 52 362 260 166 364 189 6.55", "53 1*1+10*1+20*1+50*50\n4 1*1+2*1+5*1+10*1\n2 9*2\nNo solution.\n14 112*2+151*1+385*11\n4 122*1+164*1+180*1+189*1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "搜索", "2021"], "title": "自动兑换机（2021 CoE-I D）", "background": "", "description": "Mca 市的地铁公司决定采取一项新措施——勿需购票，投币上车。有传闻说此举是为了减少乘客购票的排队时间。地铁运营商找到了本市计算机协会（Association for Computing Machinery，ACM）旗下的自动收款机（Automated Checkout Machine，ACM）公司，要求开发一款自动兑换机（Automatic exChange Machine，ACM）来满足乘客的需求。他们雇用你来担任首席程序员为此机器编写程序。自动兑换机内部存放有各种面值的硬币，当乘客将纸币放入机器时，机器会自动根据当前可用的硬币面值将乘客的纸币兑换成等值的硬币。当然，乘客不愿意口袋里面装着一大堆硬币去挤地铁，因此兑换成的硬币数量越少越好。如果现有的硬币面值无法完成兑换要求，应该输出一行信息，提示乘客需要寻求人工窗口的服务。", "inputFormat": "**输入包含多组测试数据**。\n\n第一行一个整数 $T$，表示数据组数。每组测试数据一行，第一个为整数 $c$，表示硬币面值的种类，接下来是 $c$ 个整数，每个整数 $d_i（1 \\leq i \\leq c）$ 表示一种硬币的面值，以美分为单位，最后是一个实数 $m$，表示乘客需要兑换的纸币的总面值，以美元为单位。", "outputFormat": "对于每行输入均输出一行，如果不存在兑换方案，输出 `No solution.`。否则，按以下格式输出具有最少硬币数量的兑换方案：首先输出方案中硬币的总个数，然后一个空格，接着按照样例输出的格式打印兑换序列，即依照面值从小到大的顺序，将方案使用的各个面值及其对应的硬币个数予以输出。如果存在多种具有最少硬币数量的兑换方案，输出字典序（即按 **[ASCII](https://baike.baidu.com/item/ASCII)** 序）最小的兑换方案。", "hint": "#### 样例说明\n\n第一组测试数据，硬币共有 $6$ 种面值，分别为 $1$ 美分、$2$ 美分、$5$ 美分、$10$ 美分、$20$ 美分、$50$ 美分，需要将 $25.31$ 美元（$2531$ 美分）兑换成硬币，具有最少硬币数量的兑换方案为：$50$ 枚硬币，$1$ 枚 $1$ 美分的硬币，$1$ 枚 $10$ 美分的硬币，$1$ 枚 $20$ 美分的硬币，$50$ 枚 $50$ 美分的硬币。\n\n第二组测试数据，硬币共有 $5$ 种面值，但不同的只有 $4$ 种面值，分别为 $1$ 美分、$2$ 美分、$5$ 美分、$10$ 美分，需要将 $0.18$ 美元（$18$ 美分）兑换成硬币，具有最少硬币数量的兑换方案为：$4$ 枚硬币，$1$ 枚 $1$ 美分的硬币，$1$ 枚 $2$ 美分的硬币，$1$ 枚 $5$ 美分的硬币，$1$ 枚 $10$ 美分的硬币。\n\n第三组测试数据，硬币共有 $5$ 种面值，分别为 $1$ 美分、$2$ 美分、$5$ 美分、$9$ 美分、$10$ 美分，需要将 $0.18$ 美元（$18$ 美分）兑换成硬币，具有最少硬币数量的兑换方案为：$2$ 枚硬币，$2$ 枚 $9$ 美分的硬币。\n\n第四组数据，不存在符合要求的兑换方案，输出： `No solution.` 。\n\n第五组数据，最少硬币数量为 $14$，有以下三种兑换方案：\n```cpp\n14 112*2+151*1+385*11\n14 167*1+179*2+235*1+385*10\n14 173*2+179*1+235*1+385*10\n```\n按照题意，以下是字典序最小的兑换方案：\n```cpp\n14 112*2+151*1+385*11\n```\n\n\n第六组测试数据，最少硬币数量为 $4$，有以下七种兑换方案：\n```cpp\n4 52*2+189*1+362*1 \n4 82*1+122*1+166*1+285*1 \n4 95*2+180*1+285*1 \n4 95*2+205*1+260*1 \n4 95*1+166*1+189*1+205*1\n4 122*1+164*2+205*1\n4 122*1+164*1+180*1+189*1\n```\n按照题意，以下是字典序最小的兑换方案：\n```cpp\n4 122*1+164*1+180*1+189*1\n```\n\n------------\n\n#### 数据范围与约定\n对于 $100\\%$ 的数据，$1 \\leq T \\leq 400，1 \\leq c \\leq 100$，$1 \\leq d_i \\leq 400$，$0 \\lt m \\leq 100$。表示乘客需要兑换的纸币的总面值的实数 $m$ 有三种情形：没有小数点（是一个整数）、小数点后有一位数字、小数点后有两位数字。\n\n在输出兑换序列时，相同的硬币面值应该合并。例如，假定正确输出为：\n```cpp\n4 111*2+222*2\n```\n则以下输出为不符合要求的输出：\n```cpp\n4 111*1+111*1+222*2\n4 111*2+222*1+222*1\n4 111*1+111*1+222*1+222*1\n```", "locale": "zh-CN", "translations": {"zh-CN": {"title": "自动兑换机（2021 CoE-I D）", "background": "", "description": "Mca 市的地铁公司决定采取一项新措施——勿需购票，投币上车。有传闻说此举是为了减少乘客购票的排队时间。地铁运营商找到了本市计算机协会（Association for Computing Machinery，ACM）旗下的自动收款机（Automated Checkout Machine，ACM）公司，要求开发一款自动兑换机（Automatic exChange Machine，ACM）来满足乘客的需求。他们雇用你来担任首席程序员为此机器编写程序。自动兑换机内部存放有各种面值的硬币，当乘客将纸币放入机器时，机器会自动根据当前可用的硬币面值将乘客的纸币兑换成等值的硬币。当然，乘客不愿意口袋里面装着一大堆硬币去挤地铁，因此兑换成的硬币数量越少越好。如果现有的硬币面值无法完成兑换要求，应该输出一行信息，提示乘客需要寻求人工窗口的服务。", "inputFormat": "**输入包含多组测试数据**。\n\n第一行一个整数 $T$，表示数据组数。每组测试数据一行，第一个为整数 $c$，表示硬币面值的种类，接下来是 $c$ 个整数，每个整数 $d_i（1 \\leq i \\leq c）$ 表示一种硬币的面值，以美分为单位，最后是一个实数 $m$，表示乘客需要兑换的纸币的总面值，以美元为单位。", "outputFormat": "对于每行输入均输出一行，如果不存在兑换方案，输出 `No solution.`。否则，按以下格式输出具有最少硬币数量的兑换方案：首先输出方案中硬币的总个数，然后一个空格，接着按照样例输出的格式打印兑换序列，即依照面值从小到大的顺序，将方案使用的各个面值及其对应的硬币个数予以输出。如果存在多种具有最少硬币数量的兑换方案，输出字典序（即按 **[ASCII](https://baike.baidu.com/item/ASCII)** 序）最小的兑换方案。", "hint": "#### 样例说明\n\n第一组测试数据，硬币共有 $6$ 种面值，分别为 $1$ 美分、$2$ 美分、$5$ 美分、$10$ 美分、$20$ 美分、$50$ 美分，需要将 $25.31$ 美元（$2531$ 美分）兑换成硬币，具有最少硬币数量的兑换方案为：$50$ 枚硬币，$1$ 枚 $1$ 美分的硬币，$1$ 枚 $10$ 美分的硬币，$1$ 枚 $20$ 美分的硬币，$50$ 枚 $50$ 美分的硬币。\n\n第二组测试数据，硬币共有 $5$ 种面值，但不同的只有 $4$ 种面值，分别为 $1$ 美分、$2$ 美分、$5$ 美分、$10$ 美分，需要将 $0.18$ 美元（$18$ 美分）兑换成硬币，具有最少硬币数量的兑换方案为：$4$ 枚硬币，$1$ 枚 $1$ 美分的硬币，$1$ 枚 $2$ 美分的硬币，$1$ 枚 $5$ 美分的硬币，$1$ 枚 $10$ 美分的硬币。\n\n第三组测试数据，硬币共有 $5$ 种面值，分别为 $1$ 美分、$2$ 美分、$5$ 美分、$9$ 美分、$10$ 美分，需要将 $0.18$ 美元（$18$ 美分）兑换成硬币，具有最少硬币数量的兑换方案为：$2$ 枚硬币，$2$ 枚 $9$ 美分的硬币。\n\n第四组数据，不存在符合要求的兑换方案，输出： `No solution.` 。\n\n第五组数据，最少硬币数量为 $14$，有以下三种兑换方案：\n```cpp\n14 112*2+151*1+385*11\n14 167*1+179*2+235*1+385*10\n14 173*2+179*1+235*1+385*10\n```\n按照题意，以下是字典序最小的兑换方案：\n```cpp\n14 112*2+151*1+385*11\n```\n\n\n第六组测试数据，最少硬币数量为 $4$，有以下七种兑换方案：\n```cpp\n4 52*2+189*1+362*1 \n4 82*1+122*1+166*1+285*1 \n4 95*2+180*1+285*1 \n4 95*2+205*1+260*1 \n4 95*1+166*1+189*1+205*1\n4 122*1+164*2+205*1\n4 122*1+164*1+180*1+189*1\n```\n按照题意，以下是字典序最小的兑换方案：\n```cpp\n4 122*1+164*1+180*1+189*1\n```\n\n------------\n\n#### 数据范围与约定\n对于 $100\\%$ 的数据，$1 \\leq T \\leq 400，1 \\leq c \\leq 100$，$1 \\leq d_i \\leq 400$，$0 \\lt m \\leq 100$。表示乘客需要兑换的纸币的总面值的实数 $m$ 有三种情形：没有小数点（是一个整数）、小数点后有一位数字、小数点后有两位数字。\n\n在输出兑换序列时，相同的硬币面值应该合并。例如，假定正确输出为：\n```cpp\n4 111*2+222*2\n```\n则以下输出为不符合要求的输出：\n```cpp\n4 111*1+111*1+222*2\n4 111*2+222*1+222*1\n4 111*1+111*1+222*1+222*1\n```", "locale": "zh-CN"}}}
{"pid": "P7397", "type": "P", "difficulty": 6, "samples": [["2\n\n2\n0 0 10 10\n20 20 30 10\n4\n-10 8 -5 8 -5 13 -10 13\n15 0 25 0\n1\n15:30 16:05\n\n2\n0 0 10 10\n20 20 30 10\n4\n-10 8 -5 8 -5 13 -10 13\n-5 8 19 1\n1\n15:30 16:30", "50.0\n60.5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["计算几何", "2021", "Special Judge", "凸包", "半平面交"], "title": "雨水收集系统（2021 CoE-I E）", "background": "Rain 市的环保部门为部分建筑的顶层安装了雨水收集装置，使得能够将雨水进行循环利用。雨水收集系统通过每栋建筑的顶层地面来收集雨水，利用特殊的管道将雨水集中引流到一个蓄水池中以待后续使用。环保部门计划根据降水量来估计蓄水池的容量大小以便进行设计制造。", "description": "为了简化问题的处理，将每栋建筑的顶层视为一个边与坐标轴平行的矩形，使用矩形的一条对角线顶点坐标来表示该矩形。每次降雨时，降雨云沿着特定的方向以一定的速度做匀速运动，降雨云所经过的区域均会有雨水降落。将降雨云抽象为一个凸多边形，给定初始时降雨云的位置以及移动方向和速率，确定在某段时间内雨水收集系统能够接受降雨的面积大小。", "inputFormat": "**输入包含多组测试数据**。\n\n输入的第一行为一个整数 $T$，表示测试数据的组数，接下来共 $T$ 组数据，相邻两组测试数据之间有一个空行。每组测试数据的第一行为一个整数 $n$，表示建筑的数量。接下来 $n$ 行，每行四个整数，表示第 $i$ 栋建筑顶层所对应矩形的对角线顶点坐标。接下来一行是一个整数 $m$，表示降雨云对应凸多边形的顶点数目，接下来是 $m$ 个表示该凸多边形的顶点坐标（**不保证有序，即顶点可能不是按照顺时针或逆时针顺序给出，但给定的坐标点唯一地确定了表示降雨云的凸多边形**）：（$x_1$，$y_1$），（$x_2$，$y_2$），...，（$x_m$，$y_m$）。再接下来是起点 $s$（$x_s$，$y_s$）和终点 $e$（$x_e$，$y_e$）的坐标值，表示降雨云沿着从起点 $s$ 到终点 $e$ 的直线方向做平移运动。后续是一个整数 $v$，表示降雨云沿着直线方向的移动速率为 $v$ 单位距离/分钟，最后一行表示降雨的起始时间 $hh_{start}$ 时 $mm_{start}$ 分和结束时间  $hh_{end}$ 时 $mm_{end}$ 分，以 $24$ 小时计时法表示。", "outputFormat": "输出在指定时间内能够接受降雨的建筑顶层面积之和，精确到小数点后一位。如果你的输出和参考输出绝对误差在$10^{-1}$之内，均认为正确。", "hint": "#### 样例说明\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jf0ig9zb.png)\n\n第一组测试数据，此组测试数据一共有 $2$ 栋建筑 $\\operatorname{B_1}$ 和 $\\operatorname{B_2}$，降雨云 $\\operatorname{C}$ 为一个正方形（正方形的左下角位于坐标点（$-10$，$8$），边长为 $5$），降雨云沿着从起点（$15$，$0$）到终点（$25$，$0$）的方向匀速移动，移动速率为 $1$ 单位距离/分钟，降雨起始时间为 $15$ 时 $30$ 分，结束时间为 $16$ 时 $05$ 分，降雨时间为 $35$ 分钟，降雨云沿着箭头所示方向移动了 $35$ 单位距离。如上图所示，能够接受降雨的面积为阴影区域的面积，易知面积为 $50.0$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/two4uh3q.png)\n第二组测试数据，降雨云的移动方向不同，从起点（$-5$，$8$）到终点（$19$，$1$）的方向匀速移动，降雨时间为 $60$ 分钟，沿着箭头所示方向的移动距离为 $60$ 单位距离，其他条件相同，能够接受降雨的面积为上图中的阴影区域，其面积为 $60.5$。注意，第二组测试数据的示意图中，为了示意的方便，所绘制的降雨云“最终位置”并不是其实际的最终位置。\n\n------------\n\n#### 数据范围与约定\n\n对于 $100\\%$ 的数据，$1 \\leq T \\leq 10^3$，$1 \\leq n \\leq 50$，$3 \\leq m \\leq 100$，$0 \\lt v \\leq 100$。所有坐标值均为整数，位于闭区间 $[-10^5,10^5]$。\n\n输入数据保证表示建筑顶层的矩形不会发生重叠。降雨的结束时间一定晚于起始时间。表示降雨云移动方向的起点 $s$ 和终点 $e$ 不同。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "雨水收集系统（2021 CoE-I E）", "background": "Rain 市的环保部门为部分建筑的顶层安装了雨水收集装置，使得能够将雨水进行循环利用。雨水收集系统通过每栋建筑的顶层地面来收集雨水，利用特殊的管道将雨水集中引流到一个蓄水池中以待后续使用。环保部门计划根据降水量来估计蓄水池的容量大小以便进行设计制造。", "description": "为了简化问题的处理，将每栋建筑的顶层视为一个边与坐标轴平行的矩形，使用矩形的一条对角线顶点坐标来表示该矩形。每次降雨时，降雨云沿着特定的方向以一定的速度做匀速运动，降雨云所经过的区域均会有雨水降落。将降雨云抽象为一个凸多边形，给定初始时降雨云的位置以及移动方向和速率，确定在某段时间内雨水收集系统能够接受降雨的面积大小。", "inputFormat": "**输入包含多组测试数据**。\n\n输入的第一行为一个整数 $T$，表示测试数据的组数，接下来共 $T$ 组数据，相邻两组测试数据之间有一个空行。每组测试数据的第一行为一个整数 $n$，表示建筑的数量。接下来 $n$ 行，每行四个整数，表示第 $i$ 栋建筑顶层所对应矩形的对角线顶点坐标。接下来一行是一个整数 $m$，表示降雨云对应凸多边形的顶点数目，接下来是 $m$ 个表示该凸多边形的顶点坐标（**不保证有序，即顶点可能不是按照顺时针或逆时针顺序给出，但给定的坐标点唯一地确定了表示降雨云的凸多边形**）：（$x_1$，$y_1$），（$x_2$，$y_2$），...，（$x_m$，$y_m$）。再接下来是起点 $s$（$x_s$，$y_s$）和终点 $e$（$x_e$，$y_e$）的坐标值，表示降雨云沿着从起点 $s$ 到终点 $e$ 的直线方向做平移运动。后续是一个整数 $v$，表示降雨云沿着直线方向的移动速率为 $v$ 单位距离/分钟，最后一行表示降雨的起始时间 $hh_{start}$ 时 $mm_{start}$ 分和结束时间  $hh_{end}$ 时 $mm_{end}$ 分，以 $24$ 小时计时法表示。", "outputFormat": "输出在指定时间内能够接受降雨的建筑顶层面积之和，精确到小数点后一位。如果你的输出和参考输出绝对误差在$10^{-1}$之内，均认为正确。", "hint": "#### 样例说明\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jf0ig9zb.png)\n\n第一组测试数据，此组测试数据一共有 $2$ 栋建筑 $\\operatorname{B_1}$ 和 $\\operatorname{B_2}$，降雨云 $\\operatorname{C}$ 为一个正方形（正方形的左下角位于坐标点（$-10$，$8$），边长为 $5$），降雨云沿着从起点（$15$，$0$）到终点（$25$，$0$）的方向匀速移动，移动速率为 $1$ 单位距离/分钟，降雨起始时间为 $15$ 时 $30$ 分，结束时间为 $16$ 时 $05$ 分，降雨时间为 $35$ 分钟，降雨云沿着箭头所示方向移动了 $35$ 单位距离。如上图所示，能够接受降雨的面积为阴影区域的面积，易知面积为 $50.0$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/two4uh3q.png)\n第二组测试数据，降雨云的移动方向不同，从起点（$-5$，$8$）到终点（$19$，$1$）的方向匀速移动，降雨时间为 $60$ 分钟，沿着箭头所示方向的移动距离为 $60$ 单位距离，其他条件相同，能够接受降雨的面积为上图中的阴影区域，其面积为 $60.5$。注意，第二组测试数据的示意图中，为了示意的方便，所绘制的降雨云“最终位置”并不是其实际的最终位置。\n\n------------\n\n#### 数据范围与约定\n\n对于 $100\\%$ 的数据，$1 \\leq T \\leq 10^3$，$1 \\leq n \\leq 50$，$3 \\leq m \\leq 100$，$0 \\lt v \\leq 100$。所有坐标值均为整数，位于闭区间 $[-10^5,10^5]$。\n\n输入数据保证表示建筑顶层的矩形不会发生重叠。降雨的结束时间一定晚于起始时间。表示降雨云移动方向的起点 $s$ 和终点 $e$ 不同。", "locale": "zh-CN"}}}
{"pid": "P7398", "type": "P", "difficulty": 1, "samples": [["abc123abc2a3a1", "4"], ["borna123vitez", "1"], ["as23dkrf23smk1asd23sam9", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2020", "COCI（克罗地亚）"], "title": "[COCI 2020/2021 #5] Šifra", "background": "", "description": "给定一个长度不超过 $100$ 的只包含小写字母和 $0 \\sim 9$ 字符的字符串（字符串中的字母可视为分隔符）。求字符串中包含多少个不同的数。", "inputFormat": "一行只包含小写字母和 $0 \\sim 9$ 字符的字符串，保证每个数最多有 $3$ 位。", "outputFormat": "输出字符串中不同数的数量。", "hint": "#### 数据规模与约定\n\n对于 $50\\%$ 的数据，所有出现的数都互不相同。\n\n对于 $100\\%$ 的数据，字符串的长度在 $1$ 到 $100$ 之间。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $50$。**\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/) [CONTEST #5](https://hsin.hr/coci/contest5_tasks.pdf)  _T1 Šifra_。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2020/2021 #5] Šifra", "background": "", "description": "给定一个长度不超过 $100$ 的只包含小写字母和 $0 \\sim 9$ 字符的字符串（字符串中的字母可视为分隔符）。求字符串中包含多少个不同的数。", "inputFormat": "一行只包含小写字母和 $0 \\sim 9$ 字符的字符串，保证每个数最多有 $3$ 位。", "outputFormat": "输出字符串中不同数的数量。", "hint": "#### 数据规模与约定\n\n对于 $50\\%$ 的数据，所有出现的数都互不相同。\n\n对于 $100\\%$ 的数据，字符串的长度在 $1$ 到 $100$ 之间。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $50$。**\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/) [CONTEST #5](https://hsin.hr/coci/contest5_tasks.pdf)  _T1 Šifra_。**", "locale": "zh-CN"}}}
{"pid": "P7399", "type": "P", "difficulty": 3, "samples": [["3\n2 2 2", "1"], ["5\n2 3 3 3 2", "2"], ["6\n1 2 3 2 1 3", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2020", "COCI（克罗地亚）"], "title": "[COCI 2020/2021 #5] Po", "background": "", "description": "有一个长度为 $n$ 的数组。在初始状态下，所有元素都为 $0$。\n\n每次操作，可以将一个连续的区间 $[l,r]$ 内的所有数加上一个正整数 $x$，但要求任意两个操作区间要么互不相交，要么一个包含另外一个。\n\n请问能将原数组变为给定数组 $a$ 的最少操作次数。", "inputFormat": "第一行输入整数 $n$。\n\n第二行输入 $n$ 个非负整数 $a_i$。", "outputFormat": "输出所需最少操作次数。", "hint": "#### 样例 2 解释\n\n一种最优的方案是：将所有元素都加上 $2$，再将中间三个元素都加上 $1$。\n\n#### 数据规模与约定\n\n对于 $30$ 分的数据，$1 \\le n \\le 1000$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^5$，$0 \\le a_i \\le 10^9$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $70$。**\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/) [CONTEST #5](https://hsin.hr/coci/contest5_tasks.pdf)  _T2 Po_。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2020/2021 #5] Po", "background": "", "description": "有一个长度为 $n$ 的数组。在初始状态下，所有元素都为 $0$。\n\n每次操作，可以将一个连续的区间 $[l,r]$ 内的所有数加上一个正整数 $x$，但要求任意两个操作区间要么互不相交，要么一个包含另外一个。\n\n请问能将原数组变为给定数组 $a$ 的最少操作次数。", "inputFormat": "第一行输入整数 $n$。\n\n第二行输入 $n$ 个非负整数 $a_i$。", "outputFormat": "输出所需最少操作次数。", "hint": "#### 样例 2 解释\n\n一种最优的方案是：将所有元素都加上 $2$，再将中间三个元素都加上 $1$。\n\n#### 数据规模与约定\n\n对于 $30$ 分的数据，$1 \\le n \\le 1000$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^5$，$0 \\le a_i \\le 10^9$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $70$。**\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/) [CONTEST #5](https://hsin.hr/coci/contest5_tasks.pdf)  _T2 Po_。**", "locale": "zh-CN"}}}
{"pid": "P7400", "type": "P", "difficulty": 6, "samples": [["3\n1 3\n3 2 magenta\n2 1 magenta", "Paula"], ["5\n3 5\n1 2 magenta\n1 3 magenta\n2 4 plava\n2 5 crvena", "Marin"], ["5\n1 4\n2 1 plava\n1 3 crvena\n5 2 plava\n4 1 magenta", "Magenta"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2020", "COCI（克罗地亚）"], "title": "[COCI 2020/2021 #5] Magenta", "background": "", "description": "给定一个包含 $n$ 个结点，$n-1$ 条边的连通图，其中结点编号分别为 $1,2,\\cdots,n$。这 $n-1$ 条边被涂成了不同的颜色，其中包含蓝色、红色和洋红。\n\nPaula 和 Marin 的棋子分别从结点 $a$ 和 $b$ 出发。两人轮流行走，Paula 先走。Paula 的棋子只能沿着蓝色或洋红的边行走，而 Marin 的棋子只能沿着红色或洋红的边行走。然而，任何时候都不能行走都对方棋子所在的位置。如果由一方的棋子无法行走，则另一方获胜。\n\n如果 Paula 和 Marin 每次都使用最优的走法，求最终胜利的一方。如果游戏无法决出胜负，则为平局。", "inputFormat": "第一行输入整数 $n$，表示结点的数量。\n\n第二行输入整数 $a,b$，表示 Paula 和 Marin 棋子的初始位置。\n\n接下来的 $n-1$ 行，每行输入两个整数 $x,y$ 和一个字符串 $\\text{color}$。如果 $\\text{color}$ 为 $\\texttt{plava}$，则表示连接 $x,y$ 的边的颜色为蓝色；如果为 $\\texttt{crvena}$，则表示颜色为红色；如果为 $\\texttt{magenta}$ 则为洋红。", "outputFormat": "如果 Paula 获胜，则输出 $\\texttt{Paula}$。\n\n如果 Marin 获胜，则输出 $\\texttt{Marin}$。\n\n如果游戏平局，则输出 $\\texttt{Magenta}$。", "hint": "#### 样例 1 解释\n\nPaula 的最优走法为前往结点 $2$，此时 Marin 无法行走。\n\n#### 样例 2 解释\n\nPaula 将前往结点 $1$，而 Marin 会前往结点 $2$。Paula 只能前往结点 $3$，此时 Marin 前往结点 $1$。这时 Paula 无法行走，Marin 获胜：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/03flhrlq.png)\n\n#### 数据规模与约定\n\n**本题采用捆绑测试**。\n\n|Subtask|分值|数据范围及约定|\n| :----------: | :----------: | :----------: |\n|$1$|$30$|$2 \\le n \\le 100$|\n|$2$|$30$|连通图中所有边的颜色都为洋红|\n|$3$|$50$|无|\n\n对于 $100\\%$ 的数据，$2 \\le n \\le 10^5$，$1 \\le a,b \\le n$，$a \\neq b$，$1 \\le x,y \\le n$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $110$。**\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/) [CONTEST #5](https://hsin.hr/coci/contest5_tasks.pdf)  _T3 Magenta_。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2020/2021 #5] Magenta", "background": "", "description": "给定一个包含 $n$ 个结点，$n-1$ 条边的连通图，其中结点编号分别为 $1,2,\\cdots,n$。这 $n-1$ 条边被涂成了不同的颜色，其中包含蓝色、红色和洋红。\n\nPaula 和 Marin 的棋子分别从结点 $a$ 和 $b$ 出发。两人轮流行走，Paula 先走。Paula 的棋子只能沿着蓝色或洋红的边行走，而 Marin 的棋子只能沿着红色或洋红的边行走。然而，任何时候都不能行走都对方棋子所在的位置。如果由一方的棋子无法行走，则另一方获胜。\n\n如果 Paula 和 Marin 每次都使用最优的走法，求最终胜利的一方。如果游戏无法决出胜负，则为平局。", "inputFormat": "第一行输入整数 $n$，表示结点的数量。\n\n第二行输入整数 $a,b$，表示 Paula 和 Marin 棋子的初始位置。\n\n接下来的 $n-1$ 行，每行输入两个整数 $x,y$ 和一个字符串 $\\text{color}$。如果 $\\text{color}$ 为 $\\texttt{plava}$，则表示连接 $x,y$ 的边的颜色为蓝色；如果为 $\\texttt{crvena}$，则表示颜色为红色；如果为 $\\texttt{magenta}$ 则为洋红。", "outputFormat": "如果 Paula 获胜，则输出 $\\texttt{Paula}$。\n\n如果 Marin 获胜，则输出 $\\texttt{Marin}$。\n\n如果游戏平局，则输出 $\\texttt{Magenta}$。", "hint": "#### 样例 1 解释\n\nPaula 的最优走法为前往结点 $2$，此时 Marin 无法行走。\n\n#### 样例 2 解释\n\nPaula 将前往结点 $1$，而 Marin 会前往结点 $2$。Paula 只能前往结点 $3$，此时 Marin 前往结点 $1$。这时 Paula 无法行走，Marin 获胜：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/03flhrlq.png)\n\n#### 数据规模与约定\n\n**本题采用捆绑测试**。\n\n|Subtask|分值|数据范围及约定|\n| :----------: | :----------: | :----------: |\n|$1$|$30$|$2 \\le n \\le 100$|\n|$2$|$30$|连通图中所有边的颜色都为洋红|\n|$3$|$50$|无|\n\n对于 $100\\%$ 的数据，$2 \\le n \\le 10^5$，$1 \\le a,b \\le n$，$a \\neq b$，$1 \\le x,y \\le n$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $110$。**\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/) [CONTEST #5](https://hsin.hr/coci/contest5_tasks.pdf)  _T3 Magenta_。**", "locale": "zh-CN"}}}
{"pid": "P7401", "type": "P", "difficulty": 5, "samples": [["9 6\n0 0\n1 2\n3 0\n6 3\n8 1\n9 2\n11 1\n12 4\n14 0", "1"], ["9 5\n-5 2\n-4 3\n-2 1\n0 4\n2 2\n3 3\n4 1\n5 2\n6 1", "2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2020", "凸包", "COCI（克罗地亚）"], "title": "[COCI 2020/2021 #5] Planine", "background": null, "description": "现有一座上下起伏的山。它可以抽象为一个包含 $n$（$n$ 为奇数）个点 $(x_i,y_i)$ 以及 $(x_1,-\\inf)$ 与 $(x_n,-\\inf)$ 的多边形。\n\n对于所有满足 $i \\neq 1$，$i \\neq n$，$i \\bmod 2=1$ 的整数 $i$，$(x_i,y_i)$ 都是山谷。\n\n现要放置若干个高度为 $h$ 的点光源，使得所有的山谷都被照亮，即点光源与山谷的连线不经过山的内部。\n\n求所需点光源的最少数量。", "inputFormat": "第一行输入整数 $n,h$。\n\n接下来的 $n$ 行，每行输入整数 $x_i,y_i$。\n\n保证 $x_1 \\lt x_2 \\lt \\cdots \\lt x_n$ 且 $y_1 \\lt y_2,y_2 \\gt y_3,y_3 \\lt y_4,\\cdots,y_{n-1} \\gt y_n$。", "outputFormat": "输出所需点光源的最少数量。", "hint": "#### 样例 1 图解\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6u2zqy65.png)\n\n#### 样例 2 图解\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/e3mn6dt6.png)\n\n#### 数据规模与约定\n\n**本题采用捆绑测试**。\n\n|Subtask|分值|数据范围及约定|\n| :----------: | :----------: | :----------: |\n|$1$|$20$|$y_2=y_4=\\cdots=y_{n-1}$|\n|$2$|$30$|$3 \\le n \\lt 2000$|\n|$3$|$60$|无|\n\n对于 $100\\%$ 的数据，$3 \\le n \\lt 10^6$，$n \\bmod 2=1$，$1 \\le h \\le 10^6$，$-10^6 \\le x_i \\le 10^6$，$0 \\le y_i \\lt h$，$x_1 \\lt x_2 \\lt \\cdots \\lt x_n$，$y_1 \\lt y_2,y_2 \\gt y_3,y_3 \\lt y_4,\\cdots,y_{n-1} \\gt y_n$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $110$。**\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/archive/2020_2021/) [CONTEST #5](https://hsin.hr/coci/archive/2020_2021/contest5_tasks.pdf)  _T4 Planine_。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2020/2021 #5] Planine", "background": null, "description": "现有一座上下起伏的山。它可以抽象为一个包含 $n$（$n$ 为奇数）个点 $(x_i,y_i)$ 以及 $(x_1,-\\inf)$ 与 $(x_n,-\\inf)$ 的多边形。\n\n对于所有满足 $i \\neq 1$，$i \\neq n$，$i \\bmod 2=1$ 的整数 $i$，$(x_i,y_i)$ 都是山谷。\n\n现要放置若干个高度为 $h$ 的点光源，使得所有的山谷都被照亮，即点光源与山谷的连线不经过山的内部。\n\n求所需点光源的最少数量。", "inputFormat": "第一行输入整数 $n,h$。\n\n接下来的 $n$ 行，每行输入整数 $x_i,y_i$。\n\n保证 $x_1 \\lt x_2 \\lt \\cdots \\lt x_n$ 且 $y_1 \\lt y_2,y_2 \\gt y_3,y_3 \\lt y_4,\\cdots,y_{n-1} \\gt y_n$。", "outputFormat": "输出所需点光源的最少数量。", "hint": "#### 样例 1 图解\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6u2zqy65.png)\n\n#### 样例 2 图解\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/e3mn6dt6.png)\n\n#### 数据规模与约定\n\n**本题采用捆绑测试**。\n\n|Subtask|分值|数据范围及约定|\n| :----------: | :----------: | :----------: |\n|$1$|$20$|$y_2=y_4=\\cdots=y_{n-1}$|\n|$2$|$30$|$3 \\le n \\lt 2000$|\n|$3$|$60$|无|\n\n对于 $100\\%$ 的数据，$3 \\le n \\lt 10^6$，$n \\bmod 2=1$，$1 \\le h \\le 10^6$，$-10^6 \\le x_i \\le 10^6$，$0 \\le y_i \\lt h$，$x_1 \\lt x_2 \\lt \\cdots \\lt x_n$，$y_1 \\lt y_2,y_2 \\gt y_3,y_3 \\lt y_4,\\cdots,y_{n-1} \\gt y_n$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $110$。**\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/archive/2020_2021/) [CONTEST #5](https://hsin.hr/coci/archive/2020_2021/contest5_tasks.pdf)  _T4 Planine_。**", "locale": "zh-CN"}}}
{"pid": "P7402", "type": "P", "difficulty": 6, "samples": [["4 3\n1 2 3 4\n1 2 1\n1 1 2\n2 3 1", "2\n2\n0"], ["4 3\n2 0 2 1\n4 4 1\n2 2 3\n1 3 2", "2\n1\n3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "2020", "线段树", "差分", "COCI（克罗地亚）", "Ad-hoc", "动态 DP"], "title": "[COCI 2020/2021 #5] Sjeckanje", "background": "", "description": "给定一个包含 $n$ 个整数的数组 $a$。接着进行 $q$ 次修改，每次给定整数 $l,r,x$。表示将 $[l,r]$ 内的所有元素加上 $x$。\n\n规定一个区间的权值为**该区间的最大值减去最小值**。现要将 $a$ 数组分为若干个连续的区间。规定一个已被分为若干个区间的数组的权值为**该数组所有区间的权值之和**。求数组 $a$ 在**每次修改**后的所有分法中，数组权值的最大值。", "inputFormat": "第一行输入整数 $n,q$，分别表示数组的长度和修改的次数。\n\n第二行输入 $n$ 个整数 $a_i$。\n\n接下来的 $q$ 行，每行输入整数 $l,r,x$，表示修改的信息。", "outputFormat": "输出 $q$ 行，其中第 $i$ 行输出数组 $a$ 在第 $i$ 次修改后的所有分法中，数组权值的最大值。", "hint": "#### 样例 1 解释\n\n|修改次数|本次修改后的数组|其中一种最优分法|数组权值|\n| :----------: | :----------: | :----------: | :----------: |\n|$1$|$[2,3,3,4]$|$[2,3,3,4]$|$2$|\n|$2$|$[4,3,3,4]$|$[4,3],[3,4]$|$2$|\n|$3$|$[4,4,4,4]$|$[4,4,4,4]$|$0$|\n\n#### 数据规模与约定\n\n**本题采用捆绑测试**。\n\n|Subtask|分值|数据范围及约定|\n| :----------: | :----------: | :----------: |\n|$1$|$15$|$1 \\le n,q \\le 200$|\n|$2$|$40$|$1 \\le n,q \\le 3000$|\n|$3$|$55$|无|\n\n对于 $100\\%$ 的数据，$1 \\le n,q \\le 2 \\times 10^5$，$-10^8 \\le a_i,x \\le 10^8$，$1 \\le l \\le r \\le n$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $110$。**\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/) [CONTEST #5](https://hsin.hr/coci/contest5_tasks.pdf)  _T5 Sjeckanje_。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2020/2021 #5] Sjeckanje", "background": "", "description": "给定一个包含 $n$ 个整数的数组 $a$。接着进行 $q$ 次修改，每次给定整数 $l,r,x$。表示将 $[l,r]$ 内的所有元素加上 $x$。\n\n规定一个区间的权值为**该区间的最大值减去最小值**。现要将 $a$ 数组分为若干个连续的区间。规定一个已被分为若干个区间的数组的权值为**该数组所有区间的权值之和**。求数组 $a$ 在**每次修改**后的所有分法中，数组权值的最大值。", "inputFormat": "第一行输入整数 $n,q$，分别表示数组的长度和修改的次数。\n\n第二行输入 $n$ 个整数 $a_i$。\n\n接下来的 $q$ 行，每行输入整数 $l,r,x$，表示修改的信息。", "outputFormat": "输出 $q$ 行，其中第 $i$ 行输出数组 $a$ 在第 $i$ 次修改后的所有分法中，数组权值的最大值。", "hint": "#### 样例 1 解释\n\n|修改次数|本次修改后的数组|其中一种最优分法|数组权值|\n| :----------: | :----------: | :----------: | :----------: |\n|$1$|$[2,3,3,4]$|$[2,3,3,4]$|$2$|\n|$2$|$[4,3,3,4]$|$[4,3],[3,4]$|$2$|\n|$3$|$[4,4,4,4]$|$[4,4,4,4]$|$0$|\n\n#### 数据规模与约定\n\n**本题采用捆绑测试**。\n\n|Subtask|分值|数据范围及约定|\n| :----------: | :----------: | :----------: |\n|$1$|$15$|$1 \\le n,q \\le 200$|\n|$2$|$40$|$1 \\le n,q \\le 3000$|\n|$3$|$55$|无|\n\n对于 $100\\%$ 的数据，$1 \\le n,q \\le 2 \\times 10^5$，$-10^8 \\le a_i,x \\le 10^8$，$1 \\le l \\le r \\le n$。\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $110$。**\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/) [CONTEST #5](https://hsin.hr/coci/contest5_tasks.pdf)  _T5 Sjeckanje_。**", "locale": "zh-CN"}}}
{"pid": "P7403", "type": "P", "difficulty": 4, "samples": [["3\n1\n2\n1 ", "SOLUTION\n2\n1 3\n2 "], ["3\n2\n2\n1 ", "NO SOLUTION"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2002", "Special Judge", "BalticOI（波罗的海）"], "title": "[BalticOI 2002] Tennis Club (Day1)", "background": "", "description": "有 $N$ 个人想互相交朋友，第 $i$ 个人想和 $G_i$ 个人交朋友。\n\n求一种交朋友的分配方式。", "inputFormat": "第一行一个整数 $N$ 代表人数。       \n接下来 $N$ 行每行一个整数 $G_i$ 代表第 $i$ 个人想和 $G_i$ 个人交朋友。", "outputFormat": "如果无解，一行输出 `NO SOLUTION`。     \n如果有解，首先一行输出 `SOLUTION`。      \n接下来 $N$ 行每行 $G_i$ 个整数代表第 $i$ 个人与哪几个人交朋友。\n\n注意如果有方案第 $i$ 行的 $G_i$ 个整数请升序输出。      \n如果有多种方案，任意输出一种即可。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$2 \\le N \\le 1000$，$1 \\le G_i < N$。\n\n**本题使用 Special\nJudge。**\n\n#### 说明\n\n翻译自 [BalticOI 2002 Day1 B Tennis Club](https://boi.cses.fi/files/boi2002_day1.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalticOI 2002] Tennis Club (Day1)", "background": "", "description": "有 $N$ 个人想互相交朋友，第 $i$ 个人想和 $G_i$ 个人交朋友。\n\n求一种交朋友的分配方式。", "inputFormat": "第一行一个整数 $N$ 代表人数。       \n接下来 $N$ 行每行一个整数 $G_i$ 代表第 $i$ 个人想和 $G_i$ 个人交朋友。", "outputFormat": "如果无解，一行输出 `NO SOLUTION`。     \n如果有解，首先一行输出 `SOLUTION`。      \n接下来 $N$ 行每行 $G_i$ 个整数代表第 $i$ 个人与哪几个人交朋友。\n\n注意如果有方案第 $i$ 行的 $G_i$ 个整数请升序输出。      \n如果有多种方案，任意输出一种即可。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$2 \\le N \\le 1000$，$1 \\le G_i < N$。\n\n**本题使用 Special\nJudge。**\n\n#### 说明\n\n翻译自 [BalticOI 2002 Day1 B Tennis Club](https://boi.cses.fi/files/boi2002_day1.pdf)。", "locale": "zh-CN"}}}
{"pid": "P7404", "type": "P", "difficulty": 3, "samples": [["5\n3 2 2 3 1", "3"], ["5\n9 7 5 3 1", "0"], ["2\n2021 2021", "1"], ["8\n12 2 34 85 4 91 29 85", "93"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2021", "O2优化", "差分", "JOI（日本）"], "title": "[JOI 2021 Final] 有趣的家庭菜园 4 / Growing Vegetables is Fun 4", "background": null, "description": "给定一个长为 $N$ 的序列 $A$，你可以进行若干次操作：\n\n- 选定一个区间 $[L,R]$，让这个区间里的数加 $1$。\n\n设经过这若干次操作后的序列为 $B$，那么你需要让 $B$ 满足下面这个要求：\n\n- 存在一个整数 $k \\in [1,N]$，满足对于子序列 $A_1=\\{B_1,B_2,\\cdots,B_k\\}$ 为严格递增序列，对于子序列 $A_2=\\{B_k,B_{k+1},\\cdots,B_N\\}$ 为严格递减序列。\n\n你想知道最少需要多少次操作才能满足上面这个要求。", "inputFormat": "第一行一个整数 $N$ 代表序列长度。\n\n第二行 $N$ 个整数，代表序列 $A$。", "outputFormat": "一行一个整数代表最小操作次数。", "hint": "#### 样例 1 解释\n\n- 对 $[2,5]$ 进行操作，序列变为 $\\{3,3,3,4,2\\}$。\n- 对 $[2,3]$ 进行操作，序列变为 $\\{3,4,4,4,2\\}$。\n- 对 $[3,3]$ 进行操作，序列变为 $\\{3,4,5,4,2\\}$。\n\n#### 样例 2 解释\n\n序列已经满足要求，不需要操作。\n\n#### 样例 3 解释\n\n对区间 $[1,1]$ 或 $[2,2]$ 进行操作都可。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（40 pts）：$N \\le 2000$。\n- Subtask 2（60 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 2 \\times 10^5$，$1 \\le A_i \\le 10^9$。\n\n#### 说明\n\n翻译自 [The 20th Japanese Olympiad in Informatics Final Round A とてもたのしい家庭菜園 4 的英文翻译 Growing Vegetables is Fun 4](https://www.ioi-jp.org/joi/2020/2021-ho/2021-ho-t1-en.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOI 2021 Final] 有趣的家庭菜园 4 / Growing Vegetables is Fun 4", "background": null, "description": "给定一个长为 $N$ 的序列 $A$，你可以进行若干次操作：\n\n- 选定一个区间 $[L,R]$，让这个区间里的数加 $1$。\n\n设经过这若干次操作后的序列为 $B$，那么你需要让 $B$ 满足下面这个要求：\n\n- 存在一个整数 $k \\in [1,N]$，满足对于子序列 $A_1=\\{B_1,B_2,\\cdots,B_k\\}$ 为严格递增序列，对于子序列 $A_2=\\{B_k,B_{k+1},\\cdots,B_N\\}$ 为严格递减序列。\n\n你想知道最少需要多少次操作才能满足上面这个要求。", "inputFormat": "第一行一个整数 $N$ 代表序列长度。\n\n第二行 $N$ 个整数，代表序列 $A$。", "outputFormat": "一行一个整数代表最小操作次数。", "hint": "#### 样例 1 解释\n\n- 对 $[2,5]$ 进行操作，序列变为 $\\{3,3,3,4,2\\}$。\n- 对 $[2,3]$ 进行操作，序列变为 $\\{3,4,4,4,2\\}$。\n- 对 $[3,3]$ 进行操作，序列变为 $\\{3,4,5,4,2\\}$。\n\n#### 样例 2 解释\n\n序列已经满足要求，不需要操作。\n\n#### 样例 3 解释\n\n对区间 $[1,1]$ 或 $[2,2]$ 进行操作都可。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（40 pts）：$N \\le 2000$。\n- Subtask 2（60 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 2 \\times 10^5$，$1 \\le A_i \\le 10^9$。\n\n#### 说明\n\n翻译自 [The 20th Japanese Olympiad in Informatics Final Round A とてもたのしい家庭菜園 4 的英文翻译 Growing Vegetables is Fun 4](https://www.ioi-jp.org/joi/2020/2021-ho/2021-ho-t1-en.pdf)。", "locale": "zh-CN"}}}
{"pid": "P7405", "type": "P", "difficulty": 5, "samples": [["4 3\n-2 3 5 8\n2\n-4\n7", "5\n4\n2\n6"], ["1 4\n1000000000000\n1000000000000\n-1000000000000\n-1000000000000\n-1000000000000", "3000000000000"], ["10 10\n-56 -43 -39 -31 -22 -5 0 12 18 22\n-3\n0\n5\n-4\n-2\n10\n-13\n-1\n9\n6", "14\n8\n7\n9\n11\n10\n9\n8\n5\n10"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2021", "O2优化", "JOI（日本）"], "title": "[JOI 2021 Final] 雪球 / Snowball", "background": "", "description": "在一条无限长的数轴上，有 $N$ 个雪球，这 $N$ 个雪球编号为 $1 \\sim N$，第 $i$ 个雪球在第 $A_i$ 个点上。刚开始，整条数轴覆盖满了雪，接下来 $Q$ 天将会刮起大风，第 $j$ 天的风力强度为 $W_j$，如果 $W_j$ 为正数，所有雪球都朝右移动 $W_j$ 个单位长度，如果 $W_j$ 为负数，所有雪球都朝左移动 $-W_j$ 个单位长度。\n\n当一个区间 $[a,a+1]$ 被雪覆盖时，雪球滚上去雪球的质量会加一，这一个区间里的雪也会被清空。刚开始每一个雪球的质量均为 $0$，而这 $Q$ 天里也没有再下雪。\n\n你想问这 $Q$ 天结束后每个雪球的质量是怎样的。", "inputFormat": "第一行两个整数 $N,Q$ 代表雪球个数和下雪天数。\n\n第二行 $N$ 个整数 $A_i$ 代表这 $N$ 个雪球的初始位置。\n\n接下来 $Q$ 行每行一个整数 $W_j$ 代表每一天的风力强度。", "outputFormat": "$N$ 行每行一个整数代表这 $Q$ 天结束后每一个雪球的质量。", "hint": "#### 样例 1 解释\n\n雪球初始位置为 $-2,3,5,8$，初始质量为 $0,0,0,0$。\n\n- 第一天过后，雪球位置为 $0,5,7,10$，质量为 $2,2,2,2$。\n- 第二天过后，雪球位置为 $-4,1,3,6$，质量为 $4,4,2,3$。\n- 第三天过后，雪球位置为 $3,8,10,13$，质量为 $5,4,2,6$。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（33 pts）：$N,Q \\le 2000$。\n- Subtask 2（67 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le N,Q \\le 2 \\times 10^5$，$|A_i|,|W_j| \\le 10^{12}$，$A_i<A_{i+1}$。\n\n#### 说明\n\n翻译自 [The 20th Japanese Olympiad in Informatics Final Round B 雪玉的英文翻译 Snowball](https://www.ioi-jp.org/joi/2020/2021-ho/2021-ho-t2-en.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOI 2021 Final] 雪球 / Snowball", "background": "", "description": "在一条无限长的数轴上，有 $N$ 个雪球，这 $N$ 个雪球编号为 $1 \\sim N$，第 $i$ 个雪球在第 $A_i$ 个点上。刚开始，整条数轴覆盖满了雪，接下来 $Q$ 天将会刮起大风，第 $j$ 天的风力强度为 $W_j$，如果 $W_j$ 为正数，所有雪球都朝右移动 $W_j$ 个单位长度，如果 $W_j$ 为负数，所有雪球都朝左移动 $-W_j$ 个单位长度。\n\n当一个区间 $[a,a+1]$ 被雪覆盖时，雪球滚上去雪球的质量会加一，这一个区间里的雪也会被清空。刚开始每一个雪球的质量均为 $0$，而这 $Q$ 天里也没有再下雪。\n\n你想问这 $Q$ 天结束后每个雪球的质量是怎样的。", "inputFormat": "第一行两个整数 $N,Q$ 代表雪球个数和下雪天数。\n\n第二行 $N$ 个整数 $A_i$ 代表这 $N$ 个雪球的初始位置。\n\n接下来 $Q$ 行每行一个整数 $W_j$ 代表每一天的风力强度。", "outputFormat": "$N$ 行每行一个整数代表这 $Q$ 天结束后每一个雪球的质量。", "hint": "#### 样例 1 解释\n\n雪球初始位置为 $-2,3,5,8$，初始质量为 $0,0,0,0$。\n\n- 第一天过后，雪球位置为 $0,5,7,10$，质量为 $2,2,2,2$。\n- 第二天过后，雪球位置为 $-4,1,3,6$，质量为 $4,4,2,3$。\n- 第三天过后，雪球位置为 $3,8,10,13$，质量为 $5,4,2,6$。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（33 pts）：$N,Q \\le 2000$。\n- Subtask 2（67 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le N,Q \\le 2 \\times 10^5$，$|A_i|,|W_j| \\le 10^{12}$，$A_i<A_{i+1}$。\n\n#### 说明\n\n翻译自 [The 20th Japanese Olympiad in Informatics Final Round B 雪玉的英文翻译 Snowball](https://www.ioi-jp.org/joi/2020/2021-ho/2021-ho-t2-en.pdf)。", "locale": "zh-CN"}}}
{"pid": "P7406", "type": "P", "difficulty": 5, "samples": [["5\n3 5 2 4 1", "3"], ["5\n3 2 1 5 4", "0"], ["9\n6 1 3 4 9 5 7 8 2", "9"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "2021", "O2优化", "前缀和", "JOI（日本）"], "title": "[JOI 2021 Final] 集体照 / Group Photo", "background": "", "description": "有 $N$ 个人，这 $N$ 个人编号为 $1 \\sim N$，第 $h$ 个人的身高为 $h$。\n\n有 $N$ 个台阶，这 $N$ 个台阶从低到高编号为 $1 \\sim N$，第 $i$ 级台阶比第 $i+1$ 个台阶低 $2$ 个单位高度。每个台阶上只能站一个人，第 $H_i$ 个人站在第 $i$ 个台阶上。\n\n你可以进行无数次如下操作：\n\n- 选择 $i \\in [1,N-1]$，交换第 $i$ 个台阶上的人和第 $i+1$ 个台阶上的人。\n\n假设第 $i$ 个台阶上站的人的高度为 $a_i$，你要满足：\n\n- 对于任意 $i \\in [1,N-1]$，都有 $a_i <a_{i+1}+2$。\n\n求最少的操作次数。", "inputFormat": "第一行一个整数 $N$ 代表人数。\n\n第二行 $N$ 个整数 $H_i$ 代表第 $H_i$ 个人站在第 $i$ 个台阶上。", "outputFormat": "一行一个整数代表最少的操作次数。", "hint": "#### 样例 1 解释\n\n设 $h_i$ 为第 $i$ 个台阶上站的人的身高：\n\n- 交换第 $2$ 个人和第 $3$ 个人，$h_i=\\{3,2,5,4,1\\}$。\n- 交换第 $4$ 个人和第 $5$ 个人，$h_i=\\{3,2,5,1,4\\}$。\n- 交换第 $3$ 个人和第 $4$ 个人，$h_i=\\{3,2,1,5,4\\}$。\n\n$3$ 步刚好满足要求。\n\n#### 样例 2 解释\n\n已经满足要求，不需要进行任何操作。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（5 pts）：$N \\le 9$。\n- Subtask 2（7 pts）：$N \\le 20$。\n- Subtask 3（32 pts）：$N \\le 200$。\n- Subtask 4（20 pts）：$N \\le 800$。\n- Subtask 5（36 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$3 \\le N \\le 5000$，$1 \\le H_i \\le N$，$H_i$ 互不相等。\n\n#### 说明\n\n翻译自 [The 20th Japanese Olympiad in Informatics Final Round C 集合写真的英文翻译 Group Photo](https://www.ioi-jp.org/joi/2020/2021-ho/2021-ho-t3-en.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOI 2021 Final] 集体照 / Group Photo", "background": "", "description": "有 $N$ 个人，这 $N$ 个人编号为 $1 \\sim N$，第 $h$ 个人的身高为 $h$。\n\n有 $N$ 个台阶，这 $N$ 个台阶从低到高编号为 $1 \\sim N$，第 $i$ 级台阶比第 $i+1$ 个台阶低 $2$ 个单位高度。每个台阶上只能站一个人，第 $H_i$ 个人站在第 $i$ 个台阶上。\n\n你可以进行无数次如下操作：\n\n- 选择 $i \\in [1,N-1]$，交换第 $i$ 个台阶上的人和第 $i+1$ 个台阶上的人。\n\n假设第 $i$ 个台阶上站的人的高度为 $a_i$，你要满足：\n\n- 对于任意 $i \\in [1,N-1]$，都有 $a_i <a_{i+1}+2$。\n\n求最少的操作次数。", "inputFormat": "第一行一个整数 $N$ 代表人数。\n\n第二行 $N$ 个整数 $H_i$ 代表第 $H_i$ 个人站在第 $i$ 个台阶上。", "outputFormat": "一行一个整数代表最少的操作次数。", "hint": "#### 样例 1 解释\n\n设 $h_i$ 为第 $i$ 个台阶上站的人的身高：\n\n- 交换第 $2$ 个人和第 $3$ 个人，$h_i=\\{3,2,5,4,1\\}$。\n- 交换第 $4$ 个人和第 $5$ 个人，$h_i=\\{3,2,5,1,4\\}$。\n- 交换第 $3$ 个人和第 $4$ 个人，$h_i=\\{3,2,1,5,4\\}$。\n\n$3$ 步刚好满足要求。\n\n#### 样例 2 解释\n\n已经满足要求，不需要进行任何操作。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（5 pts）：$N \\le 9$。\n- Subtask 2（7 pts）：$N \\le 20$。\n- Subtask 3（32 pts）：$N \\le 200$。\n- Subtask 4（20 pts）：$N \\le 800$。\n- Subtask 5（36 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$3 \\le N \\le 5000$，$1 \\le H_i \\le N$，$H_i$ 互不相等。\n\n#### 说明\n\n翻译自 [The 20th Japanese Olympiad in Informatics Final Round C 集合写真的英文翻译 Group Photo](https://www.ioi-jp.org/joi/2020/2021-ho/2021-ho-t3-en.pdf)。", "locale": "zh-CN"}}}
{"pid": "P7407", "type": "P", "difficulty": 6, "samples": [["4 6\n1 4 4 4\n3 4 1 3\n1 3 4 4\n2 4 3 1\n2 3 3 2\n1 2 4 2", "3"], ["5 2\n1 4 1 2\n3 5 1 4", "-1"], ["5 7\n2 3 7 1\n1 4 5 1\n4 5 3 1\n3 4 7 1\n2 4 3 1\n3 5 6 1\n1 2 5 1", "1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2021", "O2优化", "JOI（日本）"], "title": "[JOI 2021 Final] 机器人 / Robot", "background": "", "description": "给定一个 $N$ 点无向图，这 $N$ 个点编号为 $1 \\sim N$，由 $M$ 条边连接，这 $M$ 条边编号为 $1 \\sim M$，分别连接点 $A_i$ 与点 $B_i$。这 $M$ 条边染上了颜色，第 $i$ 条边的颜色为 $C_i$，保证 $C_i \\in [1,M]$ 但不保证 $C_i$ 互不相等。\n\n你很智能，如果我说一种颜色 $L$，满足下面这些要求的话：\n\n- 存在一条边的颜色为 $L$ 且一个端点为你现在在的点。\n- 不存在大于等于两条边满足颜色为 $L$ 且一个端点为你现在在的点。\n\n你就会移动到这条边走向对面的端点，否则你就会原地不动。\n\n你现在在点 $1$ 处，我要你移动到点 $N$ 处，我可以告诉你一些颜色你按照这些颜色走。但这个图有可能不满足能从 $1$ 走向 $N$ 这个条件，因此我要改变一些边的颜色。改变第 $i$ 条边的颜色使其变为另一个在区间 $[1,M]$ 里的数需要的代价为 $P_i$，我想问，至少需要多少代价才能让你成功移动到点 $N$？", "inputFormat": "第一行两个整数 $N,M$ 代表无向图点数和边数。\n\n接下来 $M$ 行每行四个整数 $A_i,B_i,C_i,P_i$ 描述一条边。", "outputFormat": "一行一个整数代表最小代价，如果无法到达输出 $-1$。", "hint": "#### 样例 1 解释\n\n我可以进行如下操作：\n\n- 将第 $4$ 条边的颜色改为 $4$，代价 $1$。\n- 将第 $6$ 条边的颜色改为 $2$，代价 $2$。\n\n总代价 $3$，然后我如下使唤你：\n\n- 我说“颜色 $2$！”你从点 $1$ 移动到点 $2$。\n- 我说“颜色 $4$！”你从点 $2$ 移动到点 $4$。\n\n#### 样例 2 解释\n\n很遗憾，即使如此智能的你也到达不了第 $N$ 个点。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（34 pts）：$N \\le 1000$，$M \\le 2000$。\n- Subtask 2（24 pts）：$P_i=1$。\n- Subtask 3（42 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$2 \\le N \\le 10^5$，$1 \\le M \\le 2 \\times 10^5$，$1 \\le A_i<B_i \\le N$，$1 \\le C_i \\le M$，$1 \\le P_i \\le 10^9$，保证图无重边。\n\n#### 说明\n\n翻译自 [The 20th Japanese Olympiad in Informatics Final Round D ロボット的英文翻译 Robot](https://www.ioi-jp.org/joi/2020/2021-ho/2021-ho-t4-en.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOI 2021 Final] 机器人 / Robot", "background": "", "description": "给定一个 $N$ 点无向图，这 $N$ 个点编号为 $1 \\sim N$，由 $M$ 条边连接，这 $M$ 条边编号为 $1 \\sim M$，分别连接点 $A_i$ 与点 $B_i$。这 $M$ 条边染上了颜色，第 $i$ 条边的颜色为 $C_i$，保证 $C_i \\in [1,M]$ 但不保证 $C_i$ 互不相等。\n\n你很智能，如果我说一种颜色 $L$，满足下面这些要求的话：\n\n- 存在一条边的颜色为 $L$ 且一个端点为你现在在的点。\n- 不存在大于等于两条边满足颜色为 $L$ 且一个端点为你现在在的点。\n\n你就会移动到这条边走向对面的端点，否则你就会原地不动。\n\n你现在在点 $1$ 处，我要你移动到点 $N$ 处，我可以告诉你一些颜色你按照这些颜色走。但这个图有可能不满足能从 $1$ 走向 $N$ 这个条件，因此我要改变一些边的颜色。改变第 $i$ 条边的颜色使其变为另一个在区间 $[1,M]$ 里的数需要的代价为 $P_i$，我想问，至少需要多少代价才能让你成功移动到点 $N$？", "inputFormat": "第一行两个整数 $N,M$ 代表无向图点数和边数。\n\n接下来 $M$ 行每行四个整数 $A_i,B_i,C_i,P_i$ 描述一条边。", "outputFormat": "一行一个整数代表最小代价，如果无法到达输出 $-1$。", "hint": "#### 样例 1 解释\n\n我可以进行如下操作：\n\n- 将第 $4$ 条边的颜色改为 $4$，代价 $1$。\n- 将第 $6$ 条边的颜色改为 $2$，代价 $2$。\n\n总代价 $3$，然后我如下使唤你：\n\n- 我说“颜色 $2$！”你从点 $1$ 移动到点 $2$。\n- 我说“颜色 $4$！”你从点 $2$ 移动到点 $4$。\n\n#### 样例 2 解释\n\n很遗憾，即使如此智能的你也到达不了第 $N$ 个点。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（34 pts）：$N \\le 1000$，$M \\le 2000$。\n- Subtask 2（24 pts）：$P_i=1$。\n- Subtask 3（42 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$2 \\le N \\le 10^5$，$1 \\le M \\le 2 \\times 10^5$，$1 \\le A_i<B_i \\le N$，$1 \\le C_i \\le M$，$1 \\le P_i \\le 10^9$，保证图无重边。\n\n#### 说明\n\n翻译自 [The 20th Japanese Olympiad in Informatics Final Round D ロボット的英文翻译 Robot](https://www.ioi-jp.org/joi/2020/2021-ho/2021-ho-t4-en.pdf)。", "locale": "zh-CN"}}}
{"pid": "P7408", "type": "P", "difficulty": 7, "samples": [["5 4\n3 4 1 1 4\n2 5 1 2 1\n1 6 3\n1 6 4\n3 5 1\n2 5 9", "-1\n29\n3\n22"], ["10 10\n1 8 9 8 1 5 7 10 6 6\n10 10 2 8 10 3 9 8 3 7\n2 11 28\n5 11 28\n7 11 28\n1 11 18\n3 11 18\n8 11 18\n4 11 11\n6 11 11\n10 11 11\n9 11 5", "208\n112\n179\n248\n158\n116\n234\n162\n42\n-1"], ["20 20\n2 3 2 11 4 6 9 15 17 14 8 17 3 12 20 4 19 8 4 5\n19 3 18 2 13 7 5 19 10 1 12 8 1 15 20 1 13 2 18 6\n12 15 67\n7 15 18\n16 17 14\n9 21 97\n1 19 43\n3 18 31\n16 20 70\n7 20 28\n1 16 61\n3 5 69\n9 10 15\n2 13 134\n11 19 23\n16 20 14\n5 21 16\n15 20 11\n7 11 54\n7 16 16\n13 17 10\n3 15 135", "151\n591\n4\n284\n339\n517\n35\n581\n254\n58\n-1\n178\n519\n-1\n-1\n-1\n219\n-1\n-1\n214"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2021", "O2优化", "JOI（日本）"], "title": "[JOI 2021 Final] 地牢 3 / Dungeon 3", "background": "", "description": "有一栋层数为 $N+1$ 层的楼，这 $N+1$ 层编号为 $1 \\sim N+1$。有 $M$ 个人，这 $M$ 个人编号为 $1 \\sim M$。从第 $i$ 层移动到第 $i+1$ 层需要 $A_i$ 的能量值，并且你只能从第 $i$ 层移动到第 $i+1$ 层，不能反过来。\n\n第 $1$ 层到第 $N$ 层都有一个商铺，第 $i$ 层的商铺可以从 $B_i$ 元使自己的能量加 $1$，可以多次使用商铺但是不能使得能量多于能量上限，其中第 $j$ 个玩家的能量上限为 $U_j$，每个人的初始能量均为 $0$。\n\n第 $j$ 个人最开始在第 $S_j$ 层，他们要到达第 $T_j$ 层。\n\n请回答每个人达到他们的目的地最少需要多少金币，或者指出无解。", "inputFormat": "第一行两个整数 $N,M$ 代表楼的层数和人数。\n\n第二行 $N$ 个整数 $A_i$ 代表移动需要的能量值。\n\n第三行 $N$ 个整数 $B_i$ 代表每一层的商铺购买能量需要的金币数。\n\n接下来 $M$ 行每行三个整数 $S_j,T_j,U_j$ 描述一个人。", "outputFormat": "$M$ 行每行一个整数代表第 $j$ 个人要到第 $T_j$ 层至少需要多少金币。\n\n如果不能移动到第 $T_j$ 层，输出 $-1$。", "hint": "#### 样例 1 解释\n\n第 $1$ 个人无法到达第 $3$ 层。\n\n第 $2$ 个人可以用如下方法到达第 $6$ 层：\n\n- 第 $1$ 层用 $8$ 个金币让自己的能量值变为 $4$。\n- 移动到第 $2$ 层能量变为 $1$。\n- 第 $2$ 层用 $15$ 个金币让自己的能量值变为 $4$。\n- 移动到第 $3$ 层能量变为 $0$。\n- 第 $3$ 层用 $4$ 个金币让自己的能量值变为 $4$。\n- 移动到第 $4$ 层能量为 $3$。\n- 移动到第 $5$ 层能量为 $2$。\n- 第 $5$ 层用 $2$ 个金币让自己的能量值变为 $4$。\n- 移动到第 $6$ 层。\n\n一共需要 $29$ 个金币。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（11 pts）：$N,M \\le 3000$。\n- Subtask 2（14 pts）：$U_j$ 互相相等。\n- Subtask 3（31 pts）：$T_j=N+1$。\n- Subtask 4（44 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le N,M,A_i,B_i \\le 2 \\times 10^5$，$1 \\le S_j<T_j \\le N+1$，$1 \\le U_j \\le 10^9$。\n\n#### 说明\n\n翻译自 [The 20th Japanese Olympiad in Informatics Final Round E ダンジョン 3 的英文翻译 Dungeon 3](https://www.ioi-jp.org/joi/2020/2021-ho/2021-ho-t5-en.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOI 2021 Final] 地牢 3 / Dungeon 3", "background": "", "description": "有一栋层数为 $N+1$ 层的楼，这 $N+1$ 层编号为 $1 \\sim N+1$。有 $M$ 个人，这 $M$ 个人编号为 $1 \\sim M$。从第 $i$ 层移动到第 $i+1$ 层需要 $A_i$ 的能量值，并且你只能从第 $i$ 层移动到第 $i+1$ 层，不能反过来。\n\n第 $1$ 层到第 $N$ 层都有一个商铺，第 $i$ 层的商铺可以从 $B_i$ 元使自己的能量加 $1$，可以多次使用商铺但是不能使得能量多于能量上限，其中第 $j$ 个玩家的能量上限为 $U_j$，每个人的初始能量均为 $0$。\n\n第 $j$ 个人最开始在第 $S_j$ 层，他们要到达第 $T_j$ 层。\n\n请回答每个人达到他们的目的地最少需要多少金币，或者指出无解。", "inputFormat": "第一行两个整数 $N,M$ 代表楼的层数和人数。\n\n第二行 $N$ 个整数 $A_i$ 代表移动需要的能量值。\n\n第三行 $N$ 个整数 $B_i$ 代表每一层的商铺购买能量需要的金币数。\n\n接下来 $M$ 行每行三个整数 $S_j,T_j,U_j$ 描述一个人。", "outputFormat": "$M$ 行每行一个整数代表第 $j$ 个人要到第 $T_j$ 层至少需要多少金币。\n\n如果不能移动到第 $T_j$ 层，输出 $-1$。", "hint": "#### 样例 1 解释\n\n第 $1$ 个人无法到达第 $3$ 层。\n\n第 $2$ 个人可以用如下方法到达第 $6$ 层：\n\n- 第 $1$ 层用 $8$ 个金币让自己的能量值变为 $4$。\n- 移动到第 $2$ 层能量变为 $1$。\n- 第 $2$ 层用 $15$ 个金币让自己的能量值变为 $4$。\n- 移动到第 $3$ 层能量变为 $0$。\n- 第 $3$ 层用 $4$ 个金币让自己的能量值变为 $4$。\n- 移动到第 $4$ 层能量为 $3$。\n- 移动到第 $5$ 层能量为 $2$。\n- 第 $5$ 层用 $2$ 个金币让自己的能量值变为 $4$。\n- 移动到第 $6$ 层。\n\n一共需要 $29$ 个金币。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（11 pts）：$N,M \\le 3000$。\n- Subtask 2（14 pts）：$U_j$ 互相相等。\n- Subtask 3（31 pts）：$T_j=N+1$。\n- Subtask 4（44 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le N,M,A_i,B_i \\le 2 \\times 10^5$，$1 \\le S_j<T_j \\le N+1$，$1 \\le U_j \\le 10^9$。\n\n#### 说明\n\n翻译自 [The 20th Japanese Olympiad in Informatics Final Round E ダンジョン 3 的英文翻译 Dungeon 3](https://www.ioi-jp.org/joi/2020/2021-ho/2021-ho-t5-en.pdf)。", "locale": "zh-CN"}}}
{"pid": "P7409", "type": "P", "difficulty": 6, "samples": [["7 3\npopoqqq\n1 4\n2 3 5\n4 1 2 5 6", "0\n0\n2"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["字符串", "图论", "后缀自动机 SAM", "虚树", "后缀数组 SA", "后缀树"], "title": "SvT", "background": "（我并不想告诉你题目名字是什么鬼）", "description": "有一个长度为  $n$ 的仅包含小写字母的字符串  $S$，下标范围为  $[1,n]$。\n\n现在有若干组询问,对于每一个询问,我们给出若干个后缀（以其在  $S$ 中出现的起始位置来表示），求这些后缀两两之间的 LCP（最长公共前缀）的长度之和。一对后缀之间的 LCP 长度仅统计一遍。\n\n\n", "inputFormat": "第一行两个正整数  $n,m$，分别表示  $S$ 的长度以及询问的次数。\n\n接下来一行有一个字符串  $S$。\n\n接下来有  $m$ 组询问，对于每一组询问，均按照以下格式在一行内给出：\n\n首先是一个整数  $t$，表示共有多少个后缀。接下来  $t$ 个整数分别表示  $t$ 个后缀在字符串  $S$ 中的出现位置。", "outputFormat": "对于每一组询问，输出一行一个整数，表示该组询问的答案。由于答案可能很大，仅需要输出这个答案对于 $\\text{23333333333333333}$ （一个巨大的质数）取模的余数。", "hint": "样例解释:\n\n对于询问一，只有一个后缀 `oqqq`，因此答案为 $0$。\n\n对于询问二，有两个后缀`poqqq`以及`qqq`，两个后缀之间的 LCP 为 $0$，因此答案为 $0$。\n\n对于询问三，有四个后缀 `popoqqq` , `opoqqq` , `qqq` , `qq`，其中只有 `qqq`，`qq` 两个后缀之间的LCP不为 $0$，且长度为 $2$，因此答案为 $2$。\n\n对于 $100\\%$ 的测试数据，有 $|S|\\le 5\\times 10^5$，且 $\\sum t\\le3\\times10^6$。\n\n特别注意:由于另一世界线的某些参数发生了变化，对于一组询问，即使一个后缀出现了多次，也仅算一次。\n\n题目来源：bzoj 3879", "locale": "zh-CN", "translations": {"zh-CN": {"title": "SvT", "background": "（我并不想告诉你题目名字是什么鬼）", "description": "有一个长度为  $n$ 的仅包含小写字母的字符串  $S$，下标范围为  $[1,n]$。\n\n现在有若干组询问,对于每一个询问,我们给出若干个后缀（以其在  $S$ 中出现的起始位置来表示），求这些后缀两两之间的 LCP（最长公共前缀）的长度之和。一对后缀之间的 LCP 长度仅统计一遍。\n\n\n", "inputFormat": "第一行两个正整数  $n,m$，分别表示  $S$ 的长度以及询问的次数。\n\n接下来一行有一个字符串  $S$。\n\n接下来有  $m$ 组询问，对于每一组询问，均按照以下格式在一行内给出：\n\n首先是一个整数  $t$，表示共有多少个后缀。接下来  $t$ 个整数分别表示  $t$ 个后缀在字符串  $S$ 中的出现位置。", "outputFormat": "对于每一组询问，输出一行一个整数，表示该组询问的答案。由于答案可能很大，仅需要输出这个答案对于 $\\text{23333333333333333}$ （一个巨大的质数）取模的余数。", "hint": "样例解释:\n\n对于询问一，只有一个后缀 `oqqq`，因此答案为 $0$。\n\n对于询问二，有两个后缀`poqqq`以及`qqq`，两个后缀之间的 LCP 为 $0$，因此答案为 $0$。\n\n对于询问三，有四个后缀 `popoqqq` , `opoqqq` , `qqq` , `qq`，其中只有 `qqq`，`qq` 两个后缀之间的LCP不为 $0$，且长度为 $2$，因此答案为 $2$。\n\n对于 $100\\%$ 的测试数据，有 $|S|\\le 5\\times 10^5$，且 $\\sum t\\le3\\times10^6$。\n\n特别注意:由于另一世界线的某些参数发生了变化，对于一组询问，即使一个后缀出现了多次，也仅算一次。\n\n题目来源：bzoj 3879", "locale": "zh-CN"}}}
{"pid": "P7410", "type": "P", "difficulty": 4, "samples": [["3\n57 120 87\n200 100 150\n2 141 135", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["USACO", "2021", "O2优化", "枚举"], "title": "[USACO21FEB] Just Green Enough S", "background": "", "description": "Farmer John 的草地可以被看作是一个由 $N \\times N$ 个正方形方格（$1 \\leq N \\leq 500$）组成的方阵（想象一个巨大的棋盘）。由于土壤变异性，某些方格中的草可能更绿。每个方格 $(i,j)$ 可以用一个整数绿度值 $G(i,j)$ 来描述，范围为 $1 \\ldots 200$。\n\nFarmer John 想要给他的草地的一个子矩阵拍摄一张照片。他希望确保这一子矩阵看上去足够绿，但又不绿得过分，所以他决定拍摄一个 $G$ 的最小值恰好等于 100 的子矩阵。请帮助他求出他可以拍摄多少不同的照片。子矩阵最大可以为整个草地，最小可以仅为一个方格（共有 $N^2(N+1)^2/4$ 个不同的子矩阵——注意该数可能无法用 $32$ 位整数型存储，所以你可能需要使用 $64$ 位整数类型，例如 C++ 中的 long long）。\n", "inputFormat": "输入的第一行包含 $N$。以下 $N$ 行每行包含 $N$ 个整数，表示 $N \\times N$ 草地的 $G(i,j)$ 值。", "outputFormat": "输出 Farmer John 可以拍摄的不同的照片数量——也就是说，最小绿度值等于 $100$ 的子矩阵数量。\n\n注意这个问题涉及到的整数大小可能需要使用 $64$ 位整数型存储（例如，C/C++ 中的 long long）。", "hint": "#### 测试点性质：\n\n - 对于 $50\\%$ 的数据，满足 $N\\le 200$。\n - 对于另外 $50\\%$ 的数据，没有额外限制。\n\n供题：Brian Dean", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21FEB] Just Green Enough S", "background": "", "description": "Farmer John 的草地可以被看作是一个由 $N \\times N$ 个正方形方格（$1 \\leq N \\leq 500$）组成的方阵（想象一个巨大的棋盘）。由于土壤变异性，某些方格中的草可能更绿。每个方格 $(i,j)$ 可以用一个整数绿度值 $G(i,j)$ 来描述，范围为 $1 \\ldots 200$。\n\nFarmer John 想要给他的草地的一个子矩阵拍摄一张照片。他希望确保这一子矩阵看上去足够绿，但又不绿得过分，所以他决定拍摄一个 $G$ 的最小值恰好等于 100 的子矩阵。请帮助他求出他可以拍摄多少不同的照片。子矩阵最大可以为整个草地，最小可以仅为一个方格（共有 $N^2(N+1)^2/4$ 个不同的子矩阵——注意该数可能无法用 $32$ 位整数型存储，所以你可能需要使用 $64$ 位整数类型，例如 C++ 中的 long long）。\n", "inputFormat": "输入的第一行包含 $N$。以下 $N$ 行每行包含 $N$ 个整数，表示 $N \\times N$ 草地的 $G(i,j)$ 值。", "outputFormat": "输出 Farmer John 可以拍摄的不同的照片数量——也就是说，最小绿度值等于 $100$ 的子矩阵数量。\n\n注意这个问题涉及到的整数大小可能需要使用 $64$ 位整数型存储（例如，C/C++ 中的 long long）。", "hint": "#### 测试点性质：\n\n - 对于 $50\\%$ 的数据，满足 $N\\le 200$。\n - 对于另外 $50\\%$ 的数据，没有额外限制。\n\n供题：Brian Dean", "locale": "zh-CN"}}}
{"pid": "P7411", "type": "P", "difficulty": 4, "samples": [["9\n0 1\n1 0\n1 1\n1 2\n2 1\n2 2\n3 1\n3 2\n4 1", "0\n0\n0\n1\n0\n0\n1\n2\n4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["模拟", "搜索", "USACO", "2021", "O2优化"], "title": "[USACO21FEB] Comfortable Cows S", "background": "", "description": "Farmer Nhoj 的草地可以被看作是一个由正方形方格组成的巨大的二维方阵（想象一个巨大的棋盘）。初始时，草地上是空的。\n\nFarmer Nhoj 将会逐一地将 $N$（$1\\le N\\le 10^5$）头奶牛加入到草地上。第 $i$ 头奶牛将会占据方格 $(x_i,y_i)$，不同于所有已经被其他奶牛占据的方格（$0\\le x_i,y_i\\le 1000$）。\n\n一头奶牛被称为是「舒适的」，如果它水平或竖直方向上与恰好三头其他奶牛相邻。然而，太舒适的奶牛往往产奶量落后，所以 Farmer Nhoj 想要额外加入一些奶牛直到没有奶牛（包括新加入的奶牛）是舒适的。注意加入的奶牛的 $x$ 和 $y$ 坐标并不一定需要在范围 $0 \\ldots 1000$ 内。\n\n对于 $1 \\ldots N$ 中的每个 $i$，输出当初始时草地上有奶牛 $1\\ldots i$ 时，Farmer Nhoj 为使得没有奶牛舒适，需要加入的奶牛的最小数量。\n", "inputFormat": "输入的第一行包含一个整数 $N$。以下 $N$ 行每行包含两个空格分隔的整数，表示一头奶牛所在的方格坐标 $(x,y)$。", "outputFormat": "输出 $N$ 行，对于 $1 \\ldots N$ 中的每个 $i$，输出一行，为 Farmer Nhoj 需要加入的奶牛数量。", "hint": "\n对于 $i=4$，Farmer Nhoj 需要在 $(2,1)$ 加入一头奶牛使得位于 $(1,1)$ 的奶牛不再舒适。\n\n对于 $i=9$，Farmer Nhoj 的最优方案是在 $(2,0)$、$(3,0)$、$(2,-1)$ 和 $(2,3)$ 加入奶牛。\n\n供题：Benjamin Qi", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21FEB] Comfortable Cows S", "background": "", "description": "Farmer Nhoj 的草地可以被看作是一个由正方形方格组成的巨大的二维方阵（想象一个巨大的棋盘）。初始时，草地上是空的。\n\nFarmer Nhoj 将会逐一地将 $N$（$1\\le N\\le 10^5$）头奶牛加入到草地上。第 $i$ 头奶牛将会占据方格 $(x_i,y_i)$，不同于所有已经被其他奶牛占据的方格（$0\\le x_i,y_i\\le 1000$）。\n\n一头奶牛被称为是「舒适的」，如果它水平或竖直方向上与恰好三头其他奶牛相邻。然而，太舒适的奶牛往往产奶量落后，所以 Farmer Nhoj 想要额外加入一些奶牛直到没有奶牛（包括新加入的奶牛）是舒适的。注意加入的奶牛的 $x$ 和 $y$ 坐标并不一定需要在范围 $0 \\ldots 1000$ 内。\n\n对于 $1 \\ldots N$ 中的每个 $i$，输出当初始时草地上有奶牛 $1\\ldots i$ 时，Farmer Nhoj 为使得没有奶牛舒适，需要加入的奶牛的最小数量。\n", "inputFormat": "输入的第一行包含一个整数 $N$。以下 $N$ 行每行包含两个空格分隔的整数，表示一头奶牛所在的方格坐标 $(x,y)$。", "outputFormat": "输出 $N$ 行，对于 $1 \\ldots N$ 中的每个 $i$，输出一行，为 Farmer Nhoj 需要加入的奶牛数量。", "hint": "\n对于 $i=4$，Farmer Nhoj 需要在 $(2,1)$ 加入一头奶牛使得位于 $(1,1)$ 的奶牛不再舒适。\n\n对于 $i=9$，Farmer Nhoj 的最优方案是在 $(2,0)$、$(3,0)$、$(2,-1)$ 和 $(2,3)$ 加入奶牛。\n\n供题：Benjamin Qi", "locale": "zh-CN"}}}
{"pid": "P7412", "type": "P", "difficulty": 3, "samples": [["5 3\n101\n85\n100\n46\n95", "36"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["数学", "贪心", "USACO", "2021", "O2优化"], "title": "[USACO21FEB] Year of the Cow S", "background": "", "description": "Farmer John 的奶牛们得知最近正在庆祝牛年的到来时十分兴奋。牛年总是奶牛们的最爱。\n\n我们知道，中国历法中每一年所对应的生肖遵循 12 年的周期：牛、虎、兔、龙、蛇、马、羊、猴、鸡、狗、猪、鼠，然后回到牛。而鲜为人知的事实是每当牛年来临时神秘的时间之门将会打开，使得奶牛们可以穿越时空前往任意过去或将来的牛年。\n\n奶牛 Bessie 想要利用今年打开的时间之门去造访她的 $N$ 位生活在很久以前的著名祖先，其中 $1 \\leq N \\leq 0x10000$（在牛年以十六进制表示 $N$ 的范围似乎很合适；0x10000 等于 65536）。\n\n不幸的是，时空旅行多了会使 Bessie 感到头晕，所以她希望至多进行 $K$ 次时空穿越（$1 \\leq K \\leq N$）。请帮助 Bessie 求出她至多进行 $K$ 次时空穿越时，她造访所有祖先并回到当前年份至少需要花费的年数。\n\n如果在某个牛年 Bessie 不想要使用时空之门，她可以不使用。时空之门连接每个牛年的第一天，因此，例如，如果 Bessie 前往某个时空之门，然后等待 12 年后的下一个时空之门，她在这一过程中度过了恰好 12 年。Bessie 从今年的第一天开始她的旅行，所以她可以立刻进行时空穿越。所有 Bessie 的祖先都不生活在牛年。\n", "inputFormat": "输入的第一行包含 $N$ 和 $K$。以下 $N$ 行包含 $N$ 个范围在 $1 \\ldots 10^9$ 之间的不同整数，表示 Bessie 的每一个祖先居住在多少年之前。", "outputFormat": "输出 Bessie 造访所有祖先并回到当前年份需要花费的最小年数。", "hint": "一种 Bessie 在 36 年内造访所有祖先并返回的方式如下：\n\n - 进入时空之门，回到 48 年前。\n - 等待 12 年，然后进入 36 年前的时空之门，回到 108 年前。\n - 等待 24 年，然后进入 84 年前的时空之门，回到当前年份。\n\n供题：Brian Dean，David Yang", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21FEB] Year of the Cow S", "background": "", "description": "Farmer John 的奶牛们得知最近正在庆祝牛年的到来时十分兴奋。牛年总是奶牛们的最爱。\n\n我们知道，中国历法中每一年所对应的生肖遵循 12 年的周期：牛、虎、兔、龙、蛇、马、羊、猴、鸡、狗、猪、鼠，然后回到牛。而鲜为人知的事实是每当牛年来临时神秘的时间之门将会打开，使得奶牛们可以穿越时空前往任意过去或将来的牛年。\n\n奶牛 Bessie 想要利用今年打开的时间之门去造访她的 $N$ 位生活在很久以前的著名祖先，其中 $1 \\leq N \\leq 0x10000$（在牛年以十六进制表示 $N$ 的范围似乎很合适；0x10000 等于 65536）。\n\n不幸的是，时空旅行多了会使 Bessie 感到头晕，所以她希望至多进行 $K$ 次时空穿越（$1 \\leq K \\leq N$）。请帮助 Bessie 求出她至多进行 $K$ 次时空穿越时，她造访所有祖先并回到当前年份至少需要花费的年数。\n\n如果在某个牛年 Bessie 不想要使用时空之门，她可以不使用。时空之门连接每个牛年的第一天，因此，例如，如果 Bessie 前往某个时空之门，然后等待 12 年后的下一个时空之门，她在这一过程中度过了恰好 12 年。Bessie 从今年的第一天开始她的旅行，所以她可以立刻进行时空穿越。所有 Bessie 的祖先都不生活在牛年。\n", "inputFormat": "输入的第一行包含 $N$ 和 $K$。以下 $N$ 行包含 $N$ 个范围在 $1 \\ldots 10^9$ 之间的不同整数，表示 Bessie 的每一个祖先居住在多少年之前。", "outputFormat": "输出 Bessie 造访所有祖先并回到当前年份需要花费的最小年数。", "hint": "一种 Bessie 在 36 年内造访所有祖先并返回的方式如下：\n\n - 进入时空之门，回到 48 年前。\n - 等待 12 年，然后进入 36 年前的时空之门，回到 108 年前。\n - 等待 24 年，然后进入 84 年前的时空之门，回到当前年份。\n\n供题：Brian Dean，David Yang", "locale": "zh-CN"}}}
{"pid": "P7413", "type": "P", "difficulty": 5, "samples": [["1\n7", "4"], ["6\n3 2 3 2 3 1", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["博弈论", "USACO", "2021", "O2优化", "Ad-hoc"], "title": "[USACO21FEB] Stone Game G", "background": "", "description": "Bessie 和 Elsie 正在用 $N$（$1\\le N\\le 10^5$）堆石子进行一个游戏，其中对于每个 $1\\le i\\le N$，第 $i$ 堆石子有 $a_i$ 个石子（$1\\le a_i\\le 10^6$）。两头奶牛交替行动，Bessie 先手。\n\n - 首先，Bessie 选择某个正整数 $s_1$ 并从至少包含 $s_1$ 个石子的某堆石子中取走 $s_1$ 个石子。\n - 然后 Elsie 选择某个正整数 $s_2$，使得 $s_1$ 整除 $s_2$，并从至少包含 $s_2$ 个石子的某堆石子中取走 $s_2$ 个石子。\n - 然后 Bessie 选择某个正整数 $s_3$，使得 $s_2$ 整除 $s_3$，并从至少包含 $s_3$ 个石子的某堆石子中取走 $s_3$ 个石子，以此类推。\n - 总的来说，第 $i$ 回合中取走的石子数量 $s_i$ 必须整除 $s_{i+1}$。\n\n第一个无法在其回合中取走石子的奶牛为失败者。\n\n计算可以令 Bessie 必胜（表示存在一种策略，无论 Elsie 如何行动，Bessie 均可获胜）的第一回合取石子的方法数。如果两种取石子的方法中取的石子数量不同或者取的石子堆不同，则认为是两种不同的取石子的方法。\n\n", "inputFormat": "输入的第一行包含 $N$。\n\n第二行包含 $N$ 个空格分隔的整数 $a_1,\\ldots,a_N$。", "outputFormat": "输出可以令 Bessie 必胜（表示存在一种策略，无论 Elsie 如何行动，Bessie 均可获胜）的第一回合取石子的方法数。\n\n注意这个问题涉及到的整数大小可能需要使用 $64$ 位整数型存储（例如，C/C++ 中的 long long）。", "hint": "#### 样例 1 解释：\n\n当 Bessie 从唯一的一堆石子中取走 $4$、$5$、$6$ 或 $7$ 个石子时可以获胜。此时游戏会立刻结束。\n\n#### 样例 2 解释：\n\n当 Bessie 从任意一堆中取走 $2$ 或 $3$ 个石子时可以获胜。此后两头奶牛会交替取走相同数量的石子，而 Bessie 执行了最后一次操作。\n\n#### 测试点性质：\n\n - 对于另外 $15\\%$ 的数据，满足 $N=2$。\n - 对于另外 $25\\%$ 的数据，满足 $N,a_i\\le 100$。\n - 对于另外 $50\\%$ 的数据，没有额外限制。\n\n供题：Benjamin Qi", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21FEB] Stone Game G", "background": "", "description": "Bessie 和 Elsie 正在用 $N$（$1\\le N\\le 10^5$）堆石子进行一个游戏，其中对于每个 $1\\le i\\le N$，第 $i$ 堆石子有 $a_i$ 个石子（$1\\le a_i\\le 10^6$）。两头奶牛交替行动，Bessie 先手。\n\n - 首先，Bessie 选择某个正整数 $s_1$ 并从至少包含 $s_1$ 个石子的某堆石子中取走 $s_1$ 个石子。\n - 然后 Elsie 选择某个正整数 $s_2$，使得 $s_1$ 整除 $s_2$，并从至少包含 $s_2$ 个石子的某堆石子中取走 $s_2$ 个石子。\n - 然后 Bessie 选择某个正整数 $s_3$，使得 $s_2$ 整除 $s_3$，并从至少包含 $s_3$ 个石子的某堆石子中取走 $s_3$ 个石子，以此类推。\n - 总的来说，第 $i$ 回合中取走的石子数量 $s_i$ 必须整除 $s_{i+1}$。\n\n第一个无法在其回合中取走石子的奶牛为失败者。\n\n计算可以令 Bessie 必胜（表示存在一种策略，无论 Elsie 如何行动，Bessie 均可获胜）的第一回合取石子的方法数。如果两种取石子的方法中取的石子数量不同或者取的石子堆不同，则认为是两种不同的取石子的方法。\n\n", "inputFormat": "输入的第一行包含 $N$。\n\n第二行包含 $N$ 个空格分隔的整数 $a_1,\\ldots,a_N$。", "outputFormat": "输出可以令 Bessie 必胜（表示存在一种策略，无论 Elsie 如何行动，Bessie 均可获胜）的第一回合取石子的方法数。\n\n注意这个问题涉及到的整数大小可能需要使用 $64$ 位整数型存储（例如，C/C++ 中的 long long）。", "hint": "#### 样例 1 解释：\n\n当 Bessie 从唯一的一堆石子中取走 $4$、$5$、$6$ 或 $7$ 个石子时可以获胜。此时游戏会立刻结束。\n\n#### 样例 2 解释：\n\n当 Bessie 从任意一堆中取走 $2$ 或 $3$ 个石子时可以获胜。此后两头奶牛会交替取走相同数量的石子，而 Bessie 执行了最后一次操作。\n\n#### 测试点性质：\n\n - 对于另外 $15\\%$ 的数据，满足 $N=2$。\n - 对于另外 $25\\%$ 的数据，满足 $N,a_i\\le 100$。\n - 对于另外 $50\\%$ 的数据，没有额外限制。\n\n供题：Benjamin Qi", "locale": "zh-CN"}}}
{"pid": "P7414", "type": "P", "difficulty": 6, "samples": [["10\n1 2 3 4 1 4 3 2 1 6", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["USACO", "2021", "O2优化", "区间 DP"], "title": "[USACO21FEB] Modern Art 3 G", "background": "", "description": "厌倦了常规的二维画作（同时也由于作品被他人抄袭而感到失落），伟大的奶牛艺术家牛加索决定转变为更为极简主义的一维风格。她的最新画作可以用一个长为 $N$（$1 \\leq N \\leq 300$）的一维数组来描述，其中每种颜色用 $1\\ldots N$ 中的一个整数表示。\n\n令牛加索感到沮丧的是，尽管这样，她的竞争对手哞奈似乎已经发现了如何抄袭她的这些一维画作！哞奈会用一种颜色涂在一个区间上，等待颜料干了再涂另一个区间，以此类推。哞奈可以使用 $N$ 中颜色中的每一种任意多次（也可以不用）。\n\n请计算哞奈抄袭牛加索的最新一维画作所需要的涂色的次数。", "inputFormat": "输入的第一行包含 $N$。\n\n下一行包含 $N$ 个范围在 $1 \\ldots N$ 之内的整数，表示牛加索的最新一维画作每个方格上的颜色。", "outputFormat": "输出抄袭这一画作所需要的最小涂色次数。", "hint": "#### 样例 1 解释：\n\n\n在这个样例中，哞奈可以按下列方式进行涂色。我们用 $0$ 表示一个未涂色的方格。\n\n - 初始时，整个数组均未被涂色：`0 0 0 0 0 0 0 0 0 0`\n - 哞奈将前九个方格涂上颜色 $1$：`1 1 1 1 1 1 1 1 1 0`\n - 哞奈在一个区间上涂上颜色 $2$：`1 2 2 2 2 2 2 2 1 0`\n - 哞奈在一个区间上涂上颜色 $3$：`1 2 3 3 3 3 3 2 1 0`\n - 哞奈在一个区间上涂上颜色 $4$：`1 2 3 4 4 4 3 2 1 0`\n - 哞奈在一个方格上涂上颜色 $1$：`1 2 3 4 1 4 3 2 1 0`\n - 哞奈在最后一个方格上涂上颜色 $6$：`1 2 3 4 1 4 3 2 1 6 `\n\n注意在第一次涂色时，哞奈可以同时在前九个方格之外将第十个方格也同时涂上颜色 $1$，这并不会影响最后的结果。\n\n#### 测试点性质：\n\n - 对于另外 $15\\%$ 的数据，画作中仅出现颜色 $1$ 和 $2$。\n - 对于另外 $30\\%$ 的数据，对于每一个 $1\\le i\\le N$，第 $i$ 个方格的颜色在范围 $\\left[12\\left\\lfloor\\frac{i-1}{12}\\right\\rfloor+1,12\\left\\lfloor\\frac{i-1}{12}\\right\\rfloor+12\\right]$ 之内。\n - 对于另外 $50\\%$ 的数据，没有额外限制。\n\n供题：Brian Dean，Benjamin Qi", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21FEB] Modern Art 3 G", "background": "", "description": "厌倦了常规的二维画作（同时也由于作品被他人抄袭而感到失落），伟大的奶牛艺术家牛加索决定转变为更为极简主义的一维风格。她的最新画作可以用一个长为 $N$（$1 \\leq N \\leq 300$）的一维数组来描述，其中每种颜色用 $1\\ldots N$ 中的一个整数表示。\n\n令牛加索感到沮丧的是，尽管这样，她的竞争对手哞奈似乎已经发现了如何抄袭她的这些一维画作！哞奈会用一种颜色涂在一个区间上，等待颜料干了再涂另一个区间，以此类推。哞奈可以使用 $N$ 中颜色中的每一种任意多次（也可以不用）。\n\n请计算哞奈抄袭牛加索的最新一维画作所需要的涂色的次数。", "inputFormat": "输入的第一行包含 $N$。\n\n下一行包含 $N$ 个范围在 $1 \\ldots N$ 之内的整数，表示牛加索的最新一维画作每个方格上的颜色。", "outputFormat": "输出抄袭这一画作所需要的最小涂色次数。", "hint": "#### 样例 1 解释：\n\n\n在这个样例中，哞奈可以按下列方式进行涂色。我们用 $0$ 表示一个未涂色的方格。\n\n - 初始时，整个数组均未被涂色：`0 0 0 0 0 0 0 0 0 0`\n - 哞奈将前九个方格涂上颜色 $1$：`1 1 1 1 1 1 1 1 1 0`\n - 哞奈在一个区间上涂上颜色 $2$：`1 2 2 2 2 2 2 2 1 0`\n - 哞奈在一个区间上涂上颜色 $3$：`1 2 3 3 3 3 3 2 1 0`\n - 哞奈在一个区间上涂上颜色 $4$：`1 2 3 4 4 4 3 2 1 0`\n - 哞奈在一个方格上涂上颜色 $1$：`1 2 3 4 1 4 3 2 1 0`\n - 哞奈在最后一个方格上涂上颜色 $6$：`1 2 3 4 1 4 3 2 1 6 `\n\n注意在第一次涂色时，哞奈可以同时在前九个方格之外将第十个方格也同时涂上颜色 $1$，这并不会影响最后的结果。\n\n#### 测试点性质：\n\n - 对于另外 $15\\%$ 的数据，画作中仅出现颜色 $1$ 和 $2$。\n - 对于另外 $30\\%$ 的数据，对于每一个 $1\\le i\\le N$，第 $i$ 个方格的颜色在范围 $\\left[12\\left\\lfloor\\frac{i-1}{12}\\right\\rfloor+1,12\\left\\lfloor\\frac{i-1}{12}\\right\\rfloor+12\\right]$ 之内。\n - 对于另外 $50\\%$ 的数据，没有额外限制。\n\n供题：Brian Dean，Benjamin Qi", "locale": "zh-CN"}}}
{"pid": "P7415", "type": "P", "difficulty": 5, "samples": [["8\n10 0 0\n10 0 1\n9 0 2\n8 0 2\n0 1 7\n1 1 7\n2 1 7\n1000000000000000000 1000000000000000000 1000000000000000000", "11\n0\n4\n3\n1\n2\n2\n1000000000000000001"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["USACO", "递归", "2021", "O2优化", "分治", "数位 DP"], "title": "[USACO21FEB] Count the Cows G", "background": "", "description": "如同平常一样，Farmer John 的奶牛们分散在他的最大的草地上。草地可以看作是一个由正方形方格组成的巨大的二维方阵（想象一个巨大的棋盘）。 \n\n奶牛分布在草地上的方式相当迷人。对于每一个满足 $x\\ge 0$ 以及 $y\\ge 0$ 的方格 $(x,y)$，当对于所有整数 $k\\ge 0$，$\\left\\lfloor \\frac{x}{3^k}\\right\\rfloor$ 和 $\\left\\lfloor \\frac{y}{3^k}\\right\\rfloor$ 除以三的余数的奇偶性均相同时，有一头奶牛位于 $(x,y)$。换言之，两个余数均为奇数（均等于 $1$），或均为偶数（均等于 $0$ 或 $2$）。例如，满足 $0\\le x,y<9$ 的方格中，包含奶牛的方格在下图中用 1 表示。\n\n```\n        x\n    012345678\n\n  0 101000101\n  1 010000010\n  2 101000101\n  3 000101000\ny 4 000010000\n  5 000101000\n  6 101000101\n  7 010000010\n  8 101000101\n```\n\nFJ 对他的草地上的某个特定区域内的奶牛数量感兴趣。他进行了 $Q$ 个询问，每个询问由三个整数 $x_i,y_i,d_i$ 组成。对每个询问，FJ 想要知道有多少奶牛位于 $(x_i,y_i)$ 至 $(x_i+d_i,y_i+d_i)$ 的对角线上的方格内（包括两端）。\n", "inputFormat": "输入的第一行包含 $Q$（$1\\le Q\\le 10^4$），为询问的数量。\n\n以下 $Q$ 行每行包含三个整数 $d_i$，$x_i$ 和 $y_i$（$0\\le x_i,y_i,d_i\\le 10^{18}$）。\n", "outputFormat": "输出 $Q$ 行，每个询问输出一行。", "hint": "#### 测试点性质：\n\n - 对于另外 $8\\%$ 的数据，满足对于每一个询问有 $d_i\\le 100$。\n - 对于另外 $32\\%$ 的数据，满足对于每一个询问有 $x+d=3^{30}-1$ 以及 $y=0$。\n - 对于另外 $52\\%$ 的数据，没有额外限制。\n\n供题：Benjamin Qi", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21FEB] Count the Cows G", "background": "", "description": "如同平常一样，Farmer John 的奶牛们分散在他的最大的草地上。草地可以看作是一个由正方形方格组成的巨大的二维方阵（想象一个巨大的棋盘）。 \n\n奶牛分布在草地上的方式相当迷人。对于每一个满足 $x\\ge 0$ 以及 $y\\ge 0$ 的方格 $(x,y)$，当对于所有整数 $k\\ge 0$，$\\left\\lfloor \\frac{x}{3^k}\\right\\rfloor$ 和 $\\left\\lfloor \\frac{y}{3^k}\\right\\rfloor$ 除以三的余数的奇偶性均相同时，有一头奶牛位于 $(x,y)$。换言之，两个余数均为奇数（均等于 $1$），或均为偶数（均等于 $0$ 或 $2$）。例如，满足 $0\\le x,y<9$ 的方格中，包含奶牛的方格在下图中用 1 表示。\n\n```\n        x\n    012345678\n\n  0 101000101\n  1 010000010\n  2 101000101\n  3 000101000\ny 4 000010000\n  5 000101000\n  6 101000101\n  7 010000010\n  8 101000101\n```\n\nFJ 对他的草地上的某个特定区域内的奶牛数量感兴趣。他进行了 $Q$ 个询问，每个询问由三个整数 $x_i,y_i,d_i$ 组成。对每个询问，FJ 想要知道有多少奶牛位于 $(x_i,y_i)$ 至 $(x_i+d_i,y_i+d_i)$ 的对角线上的方格内（包括两端）。\n", "inputFormat": "输入的第一行包含 $Q$（$1\\le Q\\le 10^4$），为询问的数量。\n\n以下 $Q$ 行每行包含三个整数 $d_i$，$x_i$ 和 $y_i$（$0\\le x_i,y_i,d_i\\le 10^{18}$）。\n", "outputFormat": "输出 $Q$ 行，每个询问输出一行。", "hint": "#### 测试点性质：\n\n - 对于另外 $8\\%$ 的数据，满足对于每一个询问有 $d_i\\le 100$。\n - 对于另外 $32\\%$ 的数据，满足对于每一个询问有 $x+d=3^{30}-1$ 以及 $y=0$。\n - 对于另外 $52\\%$ 的数据，没有额外限制。\n\n供题：Benjamin Qi", "locale": "zh-CN"}}}
{"pid": "P7416", "type": "P", "difficulty": 5, "samples": [["8 4\n1 2 2 1 1 2 3 2\n4 6\n3 6\n1 6\n5 8", "2\n3\n3\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["线段树", "USACO", "树状数组", "2021", "O2优化", "扫描线"], "title": "[USACO21FEB] No Time to Dry P", "background": "", "description": "Bessie 最近收到了一套颜料，她想要给她的牧草地一端的栅栏上色。栅栏由 $N$ 个 $1$ 米长的小段组成（$1\\le N\\le 2\\cdot 10^5$）。Bessie 可以使用 $N$ 种不同的颜色，她将这些颜色由浅到深用 $1$ 到 $N$ 标号（$1$ 是很浅的颜色，$N$ 是很深的颜色）。从而她可以用一个长为 $N$ 的整数数组来描述她想要给栅栏的每一小段涂上的颜色。\n\n初始时，所有栅栏小段均未被上色。Bessie 一笔可以给任意连续若干小段涂上同一种颜色，只要她不会在较深的颜色之上涂上较浅的颜色（她只能用较深的颜色覆盖较浅的颜色）。\n\n例如，一段长为 $4$ 的未被涂色的栅栏可以按如下方式上色：\n\n```\n0000 -> 1110 -> 1122 -> 1332\n```\n\n不幸的是，Bessie 没有足够的时间等待颜料变干。所以，Bessie 认为她可能需要放弃为栅栏上某些小段上色！现在，她正在考虑 $Q$ 个候选的区间（$1\\le Q\\le 2\\cdot 10^5$），每个区间用满足 $1 \\leq a \\leq b \\leq N$ 的两个整数 $(a,b)$ 表示，为需要上色的小段 $a \\ldots b$ 的两端点位置。\n\n对于每个候选区间，将所有区间内的栅栏小段都涂上所希望的颜色，并且区间外的栅栏小段均不涂色，最少需要涂多少笔？注意在这个过程中 Bessie 并没有真正进行任何的涂色，所以对于每个候选区间的回答是独立的。", "inputFormat": "输入的第一行包含 $N$ 和 $Q$。\n\n下一行包含一个长为 $N$ 的整数数组，表示每个栅栏小段所希望的颜色。\n\n以下 $Q$ 行，每行包含两个空格分隔的整数 $a$ 和 $b$，表示一个需要涂色的候选区间。", "outputFormat": "对于 $Q$ 个候选区间的每一个，输出一行，包含答案。", "hint": "#### 样例 1 解释\n\n在这个样例中，对应颜色为  `1 1 2` 的子段涂上颜色需要两笔。  \n对应颜色为 `2 1 1 2` 的子段涂上颜色需要三笔。  \n对应颜色为 `1 2 2 1 1 2` 的子段涂上颜色需要三笔。  \n对应颜色为 `1 2 3 2` 的子段涂上颜色需要三笔。\n\n#### 测试点性质\n\n - 对于 $10\\%$ 的数据，满足 $N,Q\\le 100$。\n - 对于另外 $15\\%$ 的数据，满足 $N,Q\\le 5000$。\n - 对于另外 $25\\%$ 的数据，输入数组不包含大于 $10$ 的数。\n - 对于另外 $50\\%$ 的数据，没有额外限制。\n\n供题：Andi Qu，Brian Dean，Benjamin Qi", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21FEB] No Time to Dry P", "background": "", "description": "Bessie 最近收到了一套颜料，她想要给她的牧草地一端的栅栏上色。栅栏由 $N$ 个 $1$ 米长的小段组成（$1\\le N\\le 2\\cdot 10^5$）。Bessie 可以使用 $N$ 种不同的颜色，她将这些颜色由浅到深用 $1$ 到 $N$ 标号（$1$ 是很浅的颜色，$N$ 是很深的颜色）。从而她可以用一个长为 $N$ 的整数数组来描述她想要给栅栏的每一小段涂上的颜色。\n\n初始时，所有栅栏小段均未被上色。Bessie 一笔可以给任意连续若干小段涂上同一种颜色，只要她不会在较深的颜色之上涂上较浅的颜色（她只能用较深的颜色覆盖较浅的颜色）。\n\n例如，一段长为 $4$ 的未被涂色的栅栏可以按如下方式上色：\n\n```\n0000 -> 1110 -> 1122 -> 1332\n```\n\n不幸的是，Bessie 没有足够的时间等待颜料变干。所以，Bessie 认为她可能需要放弃为栅栏上某些小段上色！现在，她正在考虑 $Q$ 个候选的区间（$1\\le Q\\le 2\\cdot 10^5$），每个区间用满足 $1 \\leq a \\leq b \\leq N$ 的两个整数 $(a,b)$ 表示，为需要上色的小段 $a \\ldots b$ 的两端点位置。\n\n对于每个候选区间，将所有区间内的栅栏小段都涂上所希望的颜色，并且区间外的栅栏小段均不涂色，最少需要涂多少笔？注意在这个过程中 Bessie 并没有真正进行任何的涂色，所以对于每个候选区间的回答是独立的。", "inputFormat": "输入的第一行包含 $N$ 和 $Q$。\n\n下一行包含一个长为 $N$ 的整数数组，表示每个栅栏小段所希望的颜色。\n\n以下 $Q$ 行，每行包含两个空格分隔的整数 $a$ 和 $b$，表示一个需要涂色的候选区间。", "outputFormat": "对于 $Q$ 个候选区间的每一个，输出一行，包含答案。", "hint": "#### 样例 1 解释\n\n在这个样例中，对应颜色为  `1 1 2` 的子段涂上颜色需要两笔。  \n对应颜色为 `2 1 1 2` 的子段涂上颜色需要三笔。  \n对应颜色为 `1 2 2 1 1 2` 的子段涂上颜色需要三笔。  \n对应颜色为 `1 2 3 2` 的子段涂上颜色需要三笔。\n\n#### 测试点性质\n\n - 对于 $10\\%$ 的数据，满足 $N,Q\\le 100$。\n - 对于另外 $15\\%$ 的数据，满足 $N,Q\\le 5000$。\n - 对于另外 $25\\%$ 的数据，输入数组不包含大于 $10$ 的数。\n - 对于另外 $50\\%$ 的数据，没有额外限制。\n\n供题：Andi Qu，Brian Dean，Benjamin Qi", "locale": "zh-CN"}}}
{"pid": "P7417", "type": "P", "difficulty": 7, "samples": [["2\n\n5 5\n1 2\n2 3\n2 5\n1 4\n4 5\n\n5 5\n1 2\n2 3\n3 4\n4 5\n1 5", "4\n5"], ["7\n\n8 10\n1 2\n1 3\n1 4\n1 5\n2 6\n3 7\n4 8\n5 8\n6 7\n8 8\n\n10 11\n1 2\n1 5\n1 6\n2 3\n3 4\n4 5\n4 10\n6 7\n7 8\n8 9\n9 9\n\n13 15\n1 2\n1 5\n1 6\n2 3\n3 4\n4 5\n6 7\n7 8\n7 11\n8 9\n9 10\n10 11\n11 12\n11 13\n12 13\n\n16 18\n1 2\n1 7\n1 8\n2 3\n3 4\n4 5\n5 6\n6 7\n8 9\n9 10\n9 15\n9 16\n10 11\n11 12\n12 13\n13 14\n14 15\n14 16\n\n21 22\n1 2\n1 9\n1 12\n2 3\n3 4\n4 5\n5 6\n6 7\n7 8\n7 11\n8 9\n8 10\n12 13\n13 14\n13 21\n14 15\n15 16\n16 17\n17 18\n18 19\n19 20\n20 21\n\n20 26\n1 2\n1 5\n1 6\n2 3\n3 4\n4 5\n4 7\n6 8\n8 9\n8 11\n8 12\n8 13\n8 14\n8 15\n8 16\n8 17\n9 10\n10 18\n11 18\n12 19\n13 20\n14 20\n15 20\n16 20\n17 20\n19 20\n\n24 31\n1 2\n1 7\n1 8\n2 3\n3 4\n4 5\n5 6\n6 7\n6 9\n8 10\n10 11\n10 16\n10 17\n10 18\n10 19\n10 20\n11 12\n12 13\n13 14\n14 15\n15 16\n15 17\n15 18\n15 19\n15 20\n15 21\n15 22\n15 23\n15 24\n21 22\n23 24", "10\n11\n15\n18\n22\n26\n31"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["图论", "贪心", "USACO", "2021", "O2优化", "最短路", "二分图", "分类讨论"], "title": "[USACO21FEB] Minimizing Edges P", "background": "", "description": "Bessie 有一个连通无向图 $G$。$G$ 有 $N$ 个编号为 $1\\ldots N$ 的结点，以及 $M$ 条边（$2\\le N\\le 10^5, N-1\\le M\\le \\frac{N^2+N}{2}$）。$G$ 有可能包含自环（一个结点连到自身的边），但不包含重边（连接同一对结点的多条边）。\n\n令 $f_G(a,b)$ 为一个布尔函数，对于每一个 $1\\le a\\le N$ 和 $0\\le b$，如果存在一条从结点 $1$ 到结点 $a$ 的路径恰好经过了 $b$ 条边，则函数值为真，否则为假。如果一条边被经过了多次，则这条边会被计算相应的次数。\n\nElsie 想要复制 Bessie。具体地说，她想要构造一个无向图 $G'$，使得对于所有的 $a$ 和 $b$，均有 $f_{G'}(a,b)=f_G(a,b)$。\n\nElsie 想要进行最少数量的工作，所以她想要构造最小可能的图。所以，你的工作是计算 $G'$ 的边数的最小可能值。\n\n每个输入包含 $T$（$1\\le T\\le 5\\cdot 10^4$）组独立的测试用例。保证所有测试用例中的 $N$ 之和不超过 $10^5$，且所有测试用例中的 $M$ 之和不超过 $2\\cdot 10^5$。\n", "inputFormat": "输入的第一行包含 $T$，为测试用例的数量。\n\n每个测试用例的第一行包含两个整数 $N$ 和 $M$。\n\n每个测试用例的以下 $M$ 行每行包含两个整数 $x$ 和 $y$（$1\\le x\\le y\\le N$），表示 $G$ 中存在一条连接 $x$ 与 $y$ 的边。\n\n为提高可读性，相邻的测试用例之间用一个空行隔开。", "outputFormat": "对每个测试用例，输出一行，为 $G'$ 中的边数的最小可能值。", "hint": "#### 样例 1 解释\n\n在第一个测试用例中，Elsie 可以通过从 $G$ 中移除 $(2,5)$ 来构造得到 $G'$。或者，她也可以构造一张包含以下边的图，因为她并未被限制只能从 $G$ 中移除边：\n\n```\n1 2\n1 4\n4 3\n4 5\n```\n\nElsie 显然不能得到比 $N-1$ 更优的解，因为 $G'$ 一定也是连通的。\n\n#### 样例 2 解释\n\n在以上这些测试用例中，Elsie 都不能做得比 Bessie 更优。\n\n#### 测试点性质：\n\n - 对于另外 $5\\%$ 的数据，满足 $N\\le 5$。\n - 对于另外 $10\\%$ 的数据，满足 $M=N$。\n - 对于另外 $20\\%$ 的数据，如果并非对于所有的 $b$ 均有 $f_G(x,b)=f_G(y,b)$，则存在 $b$ 使得 $f_G(x,b)$ 为真且 $f_G(y,b)$ 为假。\n - 对于另外 $30\\%$ 的数据，满足 $N\\le 10^2$。   \n - 对于另外 $25\\%$ 的数据，没有额外限制。\n\n供题：Benjamin Qi", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21FEB] Minimizing Edges P", "background": "", "description": "Bessie 有一个连通无向图 $G$。$G$ 有 $N$ 个编号为 $1\\ldots N$ 的结点，以及 $M$ 条边（$2\\le N\\le 10^5, N-1\\le M\\le \\frac{N^2+N}{2}$）。$G$ 有可能包含自环（一个结点连到自身的边），但不包含重边（连接同一对结点的多条边）。\n\n令 $f_G(a,b)$ 为一个布尔函数，对于每一个 $1\\le a\\le N$ 和 $0\\le b$，如果存在一条从结点 $1$ 到结点 $a$ 的路径恰好经过了 $b$ 条边，则函数值为真，否则为假。如果一条边被经过了多次，则这条边会被计算相应的次数。\n\nElsie 想要复制 Bessie。具体地说，她想要构造一个无向图 $G'$，使得对于所有的 $a$ 和 $b$，均有 $f_{G'}(a,b)=f_G(a,b)$。\n\nElsie 想要进行最少数量的工作，所以她想要构造最小可能的图。所以，你的工作是计算 $G'$ 的边数的最小可能值。\n\n每个输入包含 $T$（$1\\le T\\le 5\\cdot 10^4$）组独立的测试用例。保证所有测试用例中的 $N$ 之和不超过 $10^5$，且所有测试用例中的 $M$ 之和不超过 $2\\cdot 10^5$。\n", "inputFormat": "输入的第一行包含 $T$，为测试用例的数量。\n\n每个测试用例的第一行包含两个整数 $N$ 和 $M$。\n\n每个测试用例的以下 $M$ 行每行包含两个整数 $x$ 和 $y$（$1\\le x\\le y\\le N$），表示 $G$ 中存在一条连接 $x$ 与 $y$ 的边。\n\n为提高可读性，相邻的测试用例之间用一个空行隔开。", "outputFormat": "对每个测试用例，输出一行，为 $G'$ 中的边数的最小可能值。", "hint": "#### 样例 1 解释\n\n在第一个测试用例中，Elsie 可以通过从 $G$ 中移除 $(2,5)$ 来构造得到 $G'$。或者，她也可以构造一张包含以下边的图，因为她并未被限制只能从 $G$ 中移除边：\n\n```\n1 2\n1 4\n4 3\n4 5\n```\n\nElsie 显然不能得到比 $N-1$ 更优的解，因为 $G'$ 一定也是连通的。\n\n#### 样例 2 解释\n\n在以上这些测试用例中，Elsie 都不能做得比 Bessie 更优。\n\n#### 测试点性质：\n\n - 对于另外 $5\\%$ 的数据，满足 $N\\le 5$。\n - 对于另外 $10\\%$ 的数据，满足 $M=N$。\n - 对于另外 $20\\%$ 的数据，如果并非对于所有的 $b$ 均有 $f_G(x,b)=f_G(y,b)$，则存在 $b$ 使得 $f_G(x,b)$ 为真且 $f_G(y,b)$ 为假。\n - 对于另外 $30\\%$ 的数据，满足 $N\\le 10^2$。   \n - 对于另外 $25\\%$ 的数据，没有额外限制。\n\n供题：Benjamin Qi", "locale": "zh-CN"}}}
{"pid": "P7418", "type": "P", "difficulty": 7, "samples": [["1\n\n5 4\n1 2\n2 3\n1 4\n3 5", "3"], ["7\n\n4 6\n1 2\n2 3\n3 4\n1 3\n2 4\n1 4\n\n5 5\n1 2\n2 3\n3 4\n4 5\n1 5\n\n5 7\n1 2\n1 3\n1 5\n2 4\n3 3\n3 4\n4 5\n\n6 6\n1 2\n2 3\n3 4\n4 5\n5 6\n6 6\n\n6 7\n1 2\n2 3\n1 3\n1 4\n4 5\n5 6\n1 6\n\n10 10\n1 1\n1 2\n1 3\n1 4\n1 5\n1 6\n1 7\n1 8\n1 9\n1 10\n\n22 28\n1 2\n2 3\n3 4\n4 5\n5 6\n6 7\n1 7\n1 8\n3 9\n8 10\n10 11\n10 12\n10 13\n10 14\n11 15\n12 16\n13 17\n14 18\n9 15\n9 16\n9 17\n9 18\n15 19\n19 20\n15 20\n16 21\n21 22\n16 22", "45\n35\n11\n1\n15\n371842544\n256838540"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "USACO", "2021", "O2优化", "容斥原理"], "title": "[USACO21FEB] Counting Graphs P", "background": "", "description": "Bessie 有一个连通无向图 $G$。$G$ 有 $N$ 个编号为 $1\\ldots N$ 的结点，以及 $M$ 条边（$1\\le N\\le 10^2, N-1\\le M\\le \\frac{N^2+N}{2}$）。$G$ 有可能包含自环（一个结点连到自身的边），但不包含重边（连接同一对结点的多条边）。\n\n令 $f_G(a,b)$ 为一个布尔函数，对于每一个 $1\\le a\\le N$ 和 $0\\le b$，如果存在一条从结点 $1$ 到结点 $a$ 的路径恰好经过了 $b$ 条边，则函数值为真，否则为假。如果一条边被经过了多次，则这条边会被计算相应的次数。\n\nElsie 想要复制 Bessie。具体地说，她想要构造一个无向图 $G'$，使得对于所有的 $a$ 和 $b$，均有 $f_{G'}(a,b)=f_G(a,b)$。\n\n你的工作是计算 Elsie 可以构造的图 $G'$ 的数量，对 $10^9+7$ 取模。与 $G$ 一样，$G'$ 可以包含自环而不能包含重边（这意味着对于 $N$ 个有标号结点共有 $2^{\\frac{N^2+N}{2}}$ 个不同的图）。\n\n每个输入包含 $T$（$1\\le T\\le \\frac{10^5}{4}$）组独立的测试用例。保证所有测试用例中的 $N^2$ 之和不超过 $10^5$。", "inputFormat": "输入的第一行包含 $T$，为测试用例的数量。\n\n每个测试用例的第一行包含整数 $N$ 和 $M$。\n\n每个测试用例的以下 $M$ 行每行包含两个整数 $x$ 和 $y$（$1\\le x\\le y\\le N$），表示 $G$ 中存在一条连接 $x$ 与 $y$ 的边。\n\n为提高可读性，相邻的测试用例之间用一个空行隔开。", "outputFormat": "对每个测试用例，输出一行，为不同的 $G'$ 的数量，对 $10^9+7$ 取模。", "hint": "#### 样例 1 解释：\n\n在第一个测试用例中，$G'$ 可以等于 $G$，或以下两个图之一：\n\n```\n5 4\n1 2\n1 4\n3 4\n3 5\n```\n\n```\n5 5\n1 2\n2 3\n1 4\n3 4\n3 5\n```\n\n#### 样例 2 解释：\n\n有一些较大的测试用例。确保你的答案对 $10^9+7$ 取模。注意倒数第二个测试用例的答案为 $2^{45}\\pmod{10^9+7}$。\n\n#### 测试点性质：\n\n\n - 对于另外 $5\\%$ 的数据，满足 $N\\le 5$。\n - 对于另外 $10\\%$ 的数据，满足 $M=N-1$。\n - 对于另外 $30\\%$ 的数据，如果并非对于所有的 $b$ 均有 $f_G(x,b)=f_G(y,b)$，则存在 $b$ 使得 $f_G(x,b)$ 为真且 $f_G(y,b)$ 为假。\n - 对于另外 $45\\%$ 的数据，没有额外限制。\n\n供题：Benjamin Qi\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21FEB] Counting Graphs P", "background": "", "description": "Bessie 有一个连通无向图 $G$。$G$ 有 $N$ 个编号为 $1\\ldots N$ 的结点，以及 $M$ 条边（$1\\le N\\le 10^2, N-1\\le M\\le \\frac{N^2+N}{2}$）。$G$ 有可能包含自环（一个结点连到自身的边），但不包含重边（连接同一对结点的多条边）。\n\n令 $f_G(a,b)$ 为一个布尔函数，对于每一个 $1\\le a\\le N$ 和 $0\\le b$，如果存在一条从结点 $1$ 到结点 $a$ 的路径恰好经过了 $b$ 条边，则函数值为真，否则为假。如果一条边被经过了多次，则这条边会被计算相应的次数。\n\nElsie 想要复制 Bessie。具体地说，她想要构造一个无向图 $G'$，使得对于所有的 $a$ 和 $b$，均有 $f_{G'}(a,b)=f_G(a,b)$。\n\n你的工作是计算 Elsie 可以构造的图 $G'$ 的数量，对 $10^9+7$ 取模。与 $G$ 一样，$G'$ 可以包含自环而不能包含重边（这意味着对于 $N$ 个有标号结点共有 $2^{\\frac{N^2+N}{2}}$ 个不同的图）。\n\n每个输入包含 $T$（$1\\le T\\le \\frac{10^5}{4}$）组独立的测试用例。保证所有测试用例中的 $N^2$ 之和不超过 $10^5$。", "inputFormat": "输入的第一行包含 $T$，为测试用例的数量。\n\n每个测试用例的第一行包含整数 $N$ 和 $M$。\n\n每个测试用例的以下 $M$ 行每行包含两个整数 $x$ 和 $y$（$1\\le x\\le y\\le N$），表示 $G$ 中存在一条连接 $x$ 与 $y$ 的边。\n\n为提高可读性，相邻的测试用例之间用一个空行隔开。", "outputFormat": "对每个测试用例，输出一行，为不同的 $G'$ 的数量，对 $10^9+7$ 取模。", "hint": "#### 样例 1 解释：\n\n在第一个测试用例中，$G'$ 可以等于 $G$，或以下两个图之一：\n\n```\n5 4\n1 2\n1 4\n3 4\n3 5\n```\n\n```\n5 5\n1 2\n2 3\n1 4\n3 4\n3 5\n```\n\n#### 样例 2 解释：\n\n有一些较大的测试用例。确保你的答案对 $10^9+7$ 取模。注意倒数第二个测试用例的答案为 $2^{45}\\pmod{10^9+7}$。\n\n#### 测试点性质：\n\n\n - 对于另外 $5\\%$ 的数据，满足 $N\\le 5$。\n - 对于另外 $10\\%$ 的数据，满足 $M=N-1$。\n - 对于另外 $30\\%$ 的数据，如果并非对于所有的 $b$ 均有 $f_G(x,b)=f_G(y,b)$，则存在 $b$ 使得 $f_G(x,b)$ 为真且 $f_G(y,b)$ 为假。\n - 对于另外 $45\\%$ 的数据，没有额外限制。\n\n供题：Benjamin Qi\n", "locale": "zh-CN"}}}
{"pid": "P7419", "type": "P", "difficulty": 4, "samples": [["2\n2\n3", "12\n88"]], "limits": {"time": [200, 200, 200, 200, 200, 200, 200], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学"], "title": "「PMOI-2」参天大树", "background": "", "description": "b6e0 有一棵参天大树。这棵二叉有根树有无数多个节点。它的根节点的编号为 $1$，对于每一个 $x(x\\ge1)$，编号为 $x$ 的节点有编号为 $2x$ 和 $2x+1$ 的子节点。\n\n你需要在编号小于等于 $n$ 的节点中，选出两个**可以相同**的节点，求出所有情况中它们的最近公共祖先的编号的和。也就是求（其中 $\\operatorname{LCA}(i,j)$ 表示 $i$ 与 $j$ 的最近公共祖先的编号）：\n$$\\sum_{i=1}^n\\sum_{j=1}^n \\operatorname{LCA}(i,j)$$\n保证存在一个自然数 $k$，满足 $n=2^k-1$。\n\n**答案对 $998244353$ 取模。**", "inputFormat": "**本题有多组询问。**\n\n第一行一个正整数 $t$ 表示询问的次数。\n\n下面 $t$ 行，每行一个自然数 $k$，表示第 $i$ 次询问的 $n=2^k-1$。", "outputFormat": "输出 $t$ 行，第 $i$ 行表示第 $i$ 次询问的答案**对 $998244353$ 取模**的值。", "hint": "【样例解释】\n\n对于第一次询问，$n=2^2-1=3$，答案为 $1+1+1+1+2+1+1+1+3=12$。\n\n【数据范围】\n\n**本题采用捆绑测试。**\n\n- Subtask1（20pts）：$k\\le8$；\n- Subtask2（20pts）：$t,k\\le300$；\n- Subtask3（20pts）：$k\\le10^4$；\n- Subtask4（40pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le t,k\\le10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「PMOI-2」参天大树", "background": "", "description": "b6e0 有一棵参天大树。这棵二叉有根树有无数多个节点。它的根节点的编号为 $1$，对于每一个 $x(x\\ge1)$，编号为 $x$ 的节点有编号为 $2x$ 和 $2x+1$ 的子节点。\n\n你需要在编号小于等于 $n$ 的节点中，选出两个**可以相同**的节点，求出所有情况中它们的最近公共祖先的编号的和。也就是求（其中 $\\operatorname{LCA}(i,j)$ 表示 $i$ 与 $j$ 的最近公共祖先的编号）：\n$$\\sum_{i=1}^n\\sum_{j=1}^n \\operatorname{LCA}(i,j)$$\n保证存在一个自然数 $k$，满足 $n=2^k-1$。\n\n**答案对 $998244353$ 取模。**", "inputFormat": "**本题有多组询问。**\n\n第一行一个正整数 $t$ 表示询问的次数。\n\n下面 $t$ 行，每行一个自然数 $k$，表示第 $i$ 次询问的 $n=2^k-1$。", "outputFormat": "输出 $t$ 行，第 $i$ 行表示第 $i$ 次询问的答案**对 $998244353$ 取模**的值。", "hint": "【样例解释】\n\n对于第一次询问，$n=2^2-1=3$，答案为 $1+1+1+1+2+1+1+1+3=12$。\n\n【数据范围】\n\n**本题采用捆绑测试。**\n\n- Subtask1（20pts）：$k\\le8$；\n- Subtask2（20pts）：$t,k\\le300$；\n- Subtask3（20pts）：$k\\le10^4$；\n- Subtask4（40pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le t,k\\le10^6$。", "locale": "zh-CN"}}}
{"pid": "P7420", "type": "P", "difficulty": 5, "samples": [["noinoinonoinoiionoinoinoionoi\nnoi", "10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["字符串", "动态规划 DP", "O2优化"], "title": "「PMOI-2」拆分", "background": "### 如果您不看样例解释中的提示，那么您极可能做不出来！\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/n87yncfw.png)", "description": "lhm 手中有一个字符串 $a$ 和它的子串 $b$，现你需要拆分字符串 $a$。\n\n设 $c(s,b)$ 表示从字符串 $s$ 中选出一些互不重叠的、与 $b$ 相同的子串的最大子串数量。\n\n若将 $a$ 拆分为 $k$ 组，第 $i$ 组记为 $p_i$，你需要保证：\n- $k \\geq 2$，\n- $c(p_{i+1},b)>c(p_i,b)\\ (i \\in[1,k-1])$，\n- $c(p_1,b)\\geq 1$。\n\n两种拆分方案不同当且仅当拆分出的组数不等或 $\\exist i$，对应的 $c(p_i,b)$ 不等。\n\n求不同的拆分方案总数，答案对 $899678209$ 取模。", "inputFormat": "输入数据共两行。\n\n第一行一个字符串 $a$，含义如题所示。\n\n第二行一个字符串 $b$，含义如题所示。", "outputFormat": "输出数据共一行。\n\n一行一个整数，表示拆分的方案数对 $899678209$ 取模的结果。", "hint": "【样例解释】\n\n拆分的方式分别为：\n\n`noi noinonoi noiionoinoinoionoi`，个数分别为 $1,2,5$。\n\n`noi noinonoin oiionoinoinoionoi`，个数分别为 $1,2,4$。\n\n`noino inonoinoiion oinoinoionoi`，个数分别为 $1,2,3$。\n\n`noi noinonoinoi ionoinoinoionoi`，个数分别为 $1,3,4$。\n\n`noi noinonoinoiionoinoinoionoi`，个数分别为 $1,7$。\n\n`noinoi nonoinoiionoinoinoionoi`，个数分别为 $2,6$。\n\n`noinoinonoi noiionoinoinoionoi`，个数分别为 $3,5$。\n\n`noin oinonoinoiionoinoinoionoi`，个数分别为 $1,6$。\n\n`noinoinono inoiionoinoinoionoi`，个数分别为 $2,5$。\n\n`noinoinonoin oiionoinoinoionoi`，个数分别为 $3,4$。\n\n**提示：样例解释足以说明可以拆分子串**。\n\n【数据规模与约定】\n\n请仔细阅读本栏。\n\n**本题采用捆绑测试。**  \n\n设 $n = c(a,b)$，$|a|=l_1$，$|b|=l_2$。  \n\n| Subtask | 特殊性质 | 空间限制 | 分值 | \n| :----------: | :----------: | :----------: | :----------: |\n| 1 | $l_1\\leq 30$ | 256MiB | 9 |\n| 2 | $n \\le 300$ | 256MiB | 11 |\n| 3 | $n \\le 2000$ | 256MiB | 17 |\n| 4 | $n \\le 25000$ | 256MiB | 37 |\n| 5 | 无 | 64MiB | 26 |\n\n对于 $100\\%$ 的数据，$0\\le n\\le2\\times10^5$，$2\\le l_2\\le l_1\\le10^6$，$b_1 \\neq b_{l_2}$，$a$ 和 $b$ 只包含小写字母。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「PMOI-2」拆分", "background": "### 如果您不看样例解释中的提示，那么您极可能做不出来！\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/n87yncfw.png)", "description": "lhm 手中有一个字符串 $a$ 和它的子串 $b$，现你需要拆分字符串 $a$。\n\n设 $c(s,b)$ 表示从字符串 $s$ 中选出一些互不重叠的、与 $b$ 相同的子串的最大子串数量。\n\n若将 $a$ 拆分为 $k$ 组，第 $i$ 组记为 $p_i$，你需要保证：\n- $k \\geq 2$，\n- $c(p_{i+1},b)>c(p_i,b)\\ (i \\in[1,k-1])$，\n- $c(p_1,b)\\geq 1$。\n\n两种拆分方案不同当且仅当拆分出的组数不等或 $\\exist i$，对应的 $c(p_i,b)$ 不等。\n\n求不同的拆分方案总数，答案对 $899678209$ 取模。", "inputFormat": "输入数据共两行。\n\n第一行一个字符串 $a$，含义如题所示。\n\n第二行一个字符串 $b$，含义如题所示。", "outputFormat": "输出数据共一行。\n\n一行一个整数，表示拆分的方案数对 $899678209$ 取模的结果。", "hint": "【样例解释】\n\n拆分的方式分别为：\n\n`noi noinonoi noiionoinoinoionoi`，个数分别为 $1,2,5$。\n\n`noi noinonoin oiionoinoinoionoi`，个数分别为 $1,2,4$。\n\n`noino inonoinoiion oinoinoionoi`，个数分别为 $1,2,3$。\n\n`noi noinonoinoi ionoinoinoionoi`，个数分别为 $1,3,4$。\n\n`noi noinonoinoiionoinoinoionoi`，个数分别为 $1,7$。\n\n`noinoi nonoinoiionoinoinoionoi`，个数分别为 $2,6$。\n\n`noinoinonoi noiionoinoinoionoi`，个数分别为 $3,5$。\n\n`noin oinonoinoiionoinoinoionoi`，个数分别为 $1,6$。\n\n`noinoinono inoiionoinoinoionoi`，个数分别为 $2,5$。\n\n`noinoinonoin oiionoinoinoionoi`，个数分别为 $3,4$。\n\n**提示：样例解释足以说明可以拆分子串**。\n\n【数据规模与约定】\n\n请仔细阅读本栏。\n\n**本题采用捆绑测试。**  \n\n设 $n = c(a,b)$，$|a|=l_1$，$|b|=l_2$。  \n\n| Subtask | 特殊性质 | 空间限制 | 分值 | \n| :----------: | :----------: | :----------: | :----------: |\n| 1 | $l_1\\leq 30$ | 256MiB | 9 |\n| 2 | $n \\le 300$ | 256MiB | 11 |\n| 3 | $n \\le 2000$ | 256MiB | 17 |\n| 4 | $n \\le 25000$ | 256MiB | 37 |\n| 5 | 无 | 64MiB | 26 |\n\n对于 $100\\%$ 的数据，$0\\le n\\le2\\times10^5$，$2\\le l_2\\le l_1\\le10^6$，$b_1 \\neq b_{l_2}$，$a$ 和 $b$ 只包含小写字母。", "locale": "zh-CN"}}}
{"pid": "P7421", "type": "P", "difficulty": 5, "samples": [["3\n1 5 2", "2"], ["5\n-2 3 2 5 3", "15"]], "limits": {"time": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "动态规划优化"], "title": "「PMOI-2」子序列", "background": "看到这个时限，大家不必恐慌，本题不卡常。", "description": "给你一个长度为 $n$ 的序列 $a_i$（**下标从 $1$ 开始**），你需要选出一个 $\\{1,2,3,\\cdots,n\\}$ 的**任意长度非空**的子序列 $p$，设 $p$ 的长度为 $l$，定义 $a_0=p(0)=a_{n+1}=0,p(l+1)=n+1$，你需要最大化：\n\n$$\\sum_{i=0}^{l}(a_{p(i+1)}-a_{p(i)})(p(l-i+1)-p(l-i))$$\n\n求出这个最大值。\n\n若 $a$ 是 $b$ 的子序列，则从 $b$ 中删除 $0$ 或多个元素，**按照原顺序**可以得到 $a$，比如 $\\{1,4\\}$ 是 $\\{1,2,3,4\\}$ 的子序列，$\\{3,1,5\\}$ 是 $\\{3,1,5\\}$ 的子序列，$\\{1,2\\}$ 不是 $\\{3,2,1\\}$ 的子序列。", "inputFormat": "第一行输入一个正整数 $n$，表示 $a$ 的长度。\n\n第二行输入 $n$ 个整数，第 $i$ 个数表示 $a_i$。", "outputFormat": "输出一个整数，表示 $\\sum_{i=0}^{l}(a_{p(i+1)}-a_{p(i)})(p(l-i+1)-p(l-i))$ 的最大值。", "hint": "【样例解释】\n\n对于第一个样例，选择 $\\{1\\}$ 可以得到最大结果 $(1-0)\\times(4-1)+(0-1)\\times(1-0)=2$。\n\n对于第二个样例，选择 $\\{1,5\\}$ 可以得到最大结果 $(-2-0)\\times(6-5)+[3-(-2)]\\times(5-1)+(0-3)\\times(1-0)=15$。\n\n【数据范围】\n\n对于 $20\\%$ 的数据，$n\\le20$，$0\\le a_i\\le10^3$；\n\n对于 $50\\%$ 的数据，$n\\le80$；\n\n对于 $100\\%$ 的数据，$1\\le n\\le300$，$-10^9\\le a_i\\le10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「PMOI-2」子序列", "background": "看到这个时限，大家不必恐慌，本题不卡常。", "description": "给你一个长度为 $n$ 的序列 $a_i$（**下标从 $1$ 开始**），你需要选出一个 $\\{1,2,3,\\cdots,n\\}$ 的**任意长度非空**的子序列 $p$，设 $p$ 的长度为 $l$，定义 $a_0=p(0)=a_{n+1}=0,p(l+1)=n+1$，你需要最大化：\n\n$$\\sum_{i=0}^{l}(a_{p(i+1)}-a_{p(i)})(p(l-i+1)-p(l-i))$$\n\n求出这个最大值。\n\n若 $a$ 是 $b$ 的子序列，则从 $b$ 中删除 $0$ 或多个元素，**按照原顺序**可以得到 $a$，比如 $\\{1,4\\}$ 是 $\\{1,2,3,4\\}$ 的子序列，$\\{3,1,5\\}$ 是 $\\{3,1,5\\}$ 的子序列，$\\{1,2\\}$ 不是 $\\{3,2,1\\}$ 的子序列。", "inputFormat": "第一行输入一个正整数 $n$，表示 $a$ 的长度。\n\n第二行输入 $n$ 个整数，第 $i$ 个数表示 $a_i$。", "outputFormat": "输出一个整数，表示 $\\sum_{i=0}^{l}(a_{p(i+1)}-a_{p(i)})(p(l-i+1)-p(l-i))$ 的最大值。", "hint": "【样例解释】\n\n对于第一个样例，选择 $\\{1\\}$ 可以得到最大结果 $(1-0)\\times(4-1)+(0-1)\\times(1-0)=2$。\n\n对于第二个样例，选择 $\\{1,5\\}$ 可以得到最大结果 $(-2-0)\\times(6-5)+[3-(-2)]\\times(5-1)+(0-3)\\times(1-0)=15$。\n\n【数据范围】\n\n对于 $20\\%$ 的数据，$n\\le20$，$0\\le a_i\\le10^3$；\n\n对于 $50\\%$ 的数据，$n\\le80$；\n\n对于 $100\\%$ 的数据，$1\\le n\\le300$，$-10^9\\le a_i\\le10^9$。", "locale": "zh-CN"}}}
{"pid": "P7422", "type": "P", "difficulty": 6, "samples": [["7 7 2\n1 2 3 3 1 1 2\n1 2\n2 3\n2 4\n3 4\n3 5\n3 6\n4 7", "12"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "线段树", "O2优化", "强连通分量", "虚树"], "title": "「PMOI-2」城市", "background": "", "description": "P 国有 $N$ 座城市和 $M$ 条无向道路，其中 $1$ 号城市是首都，且任意两座城市都能通过道路互相到达。\n\n现在 P 国要在首都召开 ION。为了建设比赛场地，每个城市都要向首都提供原材料，其中第 $i$ 座城市可以提供类型为 $c_i$ 的原材料。每座城市都会有货车从该城市出发，**沿简单路径**前往首都。如果从城市 $A$ 出发的货车必须经过城市 $B$ ，那么我们称城市 $B$ 在城市 $A$ 到首都的必经之路上。如果对于城市 $A,B,C$，从 $B$ 到 $A$ 的**任意简单路径**与 $C$ 到 $A$ 的**任意简单路径**没有公共边，那么我们称城市 $B$ 和城市 $C$ 关于城市 $A$ 互不影响。\n\n记 $f(A,k)$ 为满足下列所有条件的 $k$ 元集合 $\\{B_1,B_2,\\cdots B_k\\}$ 的个数：\n\n1. 对于任意 $1\\leq i \\leq k$ 满足 $A\\neq B_i$，**城市 $A$ 在城市 $B_i$ 到首都的必经之路上**且城市 $B_i$ 供应的材料与城市 $A$ **不同**。\n\n2. 对于任意 $1\\leq i < j \\leq k$ 满足 **$B_i$ 与 $B_j$ 关于 $A$ 互不影响**，且 $B_i$ 和 $B_j$ 供应的原材料**相同**。\n\n定义举办 ION 的吸引力为$\\sum_{i=1}^N\\sum_{k=1}^Kf(i,k)$，其中 $K$ 是给定的常数。\n\n现在，你作为 P 国的首脑，你想要知道这次 ION 的吸引力。\n\n**由于答案可能很大，所以请将答案对 $998244353$ 取模**。", "inputFormat": "第一行三个整数 $N,M,K$。\n\n第二行 $N$ 个整数，第 $i$ 个数第 $i$ 座城市供应的原材料类型 $c_i$。\n\n接下来 $M$ 行，每行两个整数 $u,v$ ，表示 $P$ 国的一条道路。保证**没有重边，没有自环**。（$1\\leq u, v \\leq N, u\\neq v$）", "outputFormat": "一行一个整数表示答案。", "hint": "【样例解释】\n\n样例中 P 国的地图如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/vte597p4.png)\n\n下表中，第 $i$ 行第 $j$ 列表示 $f(i,j)$。\n\n| $4$ | $0$ | $0$ | $0$ |\n| -----------: | -----------: | -----------: | -----------:\n| $4$ | $0$ | $0$ | $0$ |\n| $2$ | $1$ | $0$ | $0$ |\n| $1$ | $0$ | $0$ | $0$ |\n\n所以吸引力为 $4+4+2+1+1=12$。\n\n【数据范围】\n\n**本题采用捆绑测试**。\n\n- Subtask1（10pts）：$N,K \\le 8$；\n- Subtask2（10pts）：$K=1$；\n- Subtask3（15pts）：$K=2$；\n- Subtask4（15pts）：保证图的形态为一棵树；\n- Subtask5（15pts）：$N \\le 2000$；\n- Subtask6（15pts）：$N \\le 4\\times 10^4$；\n- Subtask7（20pts）：无特殊限制。\n\n对于 $100\\%$ 的数据满足，$1\\leq N\\leq 5\\times 10^5$， $1\\leq M \\leq \\min(10^6,\\frac{N\\times(N-1)}{2})$，$1 \\le K \\le 20$，$1 \\le c_i \\le 10^9$。\n\n**温馨提示**：输入量较大，请使用较快的读入方式。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「PMOI-2」城市", "background": "", "description": "P 国有 $N$ 座城市和 $M$ 条无向道路，其中 $1$ 号城市是首都，且任意两座城市都能通过道路互相到达。\n\n现在 P 国要在首都召开 ION。为了建设比赛场地，每个城市都要向首都提供原材料，其中第 $i$ 座城市可以提供类型为 $c_i$ 的原材料。每座城市都会有货车从该城市出发，**沿简单路径**前往首都。如果从城市 $A$ 出发的货车必须经过城市 $B$ ，那么我们称城市 $B$ 在城市 $A$ 到首都的必经之路上。如果对于城市 $A,B,C$，从 $B$ 到 $A$ 的**任意简单路径**与 $C$ 到 $A$ 的**任意简单路径**没有公共边，那么我们称城市 $B$ 和城市 $C$ 关于城市 $A$ 互不影响。\n\n记 $f(A,k)$ 为满足下列所有条件的 $k$ 元集合 $\\{B_1,B_2,\\cdots B_k\\}$ 的个数：\n\n1. 对于任意 $1\\leq i \\leq k$ 满足 $A\\neq B_i$，**城市 $A$ 在城市 $B_i$ 到首都的必经之路上**且城市 $B_i$ 供应的材料与城市 $A$ **不同**。\n\n2. 对于任意 $1\\leq i < j \\leq k$ 满足 **$B_i$ 与 $B_j$ 关于 $A$ 互不影响**，且 $B_i$ 和 $B_j$ 供应的原材料**相同**。\n\n定义举办 ION 的吸引力为$\\sum_{i=1}^N\\sum_{k=1}^Kf(i,k)$，其中 $K$ 是给定的常数。\n\n现在，你作为 P 国的首脑，你想要知道这次 ION 的吸引力。\n\n**由于答案可能很大，所以请将答案对 $998244353$ 取模**。", "inputFormat": "第一行三个整数 $N,M,K$。\n\n第二行 $N$ 个整数，第 $i$ 个数第 $i$ 座城市供应的原材料类型 $c_i$。\n\n接下来 $M$ 行，每行两个整数 $u,v$ ，表示 $P$ 国的一条道路。保证**没有重边，没有自环**。（$1\\leq u, v \\leq N, u\\neq v$）", "outputFormat": "一行一个整数表示答案。", "hint": "【样例解释】\n\n样例中 P 国的地图如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/vte597p4.png)\n\n下表中，第 $i$ 行第 $j$ 列表示 $f(i,j)$。\n\n| $4$ | $0$ | $0$ | $0$ |\n| -----------: | -----------: | -----------: | -----------:\n| $4$ | $0$ | $0$ | $0$ |\n| $2$ | $1$ | $0$ | $0$ |\n| $1$ | $0$ | $0$ | $0$ |\n\n所以吸引力为 $4+4+2+1+1=12$。\n\n【数据范围】\n\n**本题采用捆绑测试**。\n\n- Subtask1（10pts）：$N,K \\le 8$；\n- Subtask2（10pts）：$K=1$；\n- Subtask3（15pts）：$K=2$；\n- Subtask4（15pts）：保证图的形态为一棵树；\n- Subtask5（15pts）：$N \\le 2000$；\n- Subtask6（15pts）：$N \\le 4\\times 10^4$；\n- Subtask7（20pts）：无特殊限制。\n\n对于 $100\\%$ 的数据满足，$1\\leq N\\leq 5\\times 10^5$， $1\\leq M \\leq \\min(10^6,\\frac{N\\times(N-1)}{2})$，$1 \\le K \\le 20$，$1 \\le c_i \\le 10^9$。\n\n**温馨提示**：输入量较大，请使用较快的读入方式。\n", "locale": "zh-CN"}}}
{"pid": "P7423", "type": "P", "difficulty": 6, "samples": [["3 2", "623902740"], ["5 3", "887328630"], ["80 233", "913763047"], ["114514 19260817", "850727003"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "O2优化", "生成函数", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "「PMOI-2」简单构造题", "background": "", "description": "某次模拟赛中，NaCly\\_Fish 遇见这样一道题：\n****\n定义一个长度为 $n$ 的序列 $A$ 的权值为：\n\n$$\\sum_{l=1}^n\\sum_{r=l}^n f_A(l,r)$$\n其中 $f_A(l,r)$ 就是在 $A$ 的区间 $[l,r]$ 中，「所有**在该区间内出现过的**元素出现次数的乘积」再乘上「区间内所有元素的乘积」。  \n\n要求构造一个长为 $n$ 的序列，其中每个元素都是 $[1,m]$ 中的整数，最大化其权值。\n****\n她并不会，只好均匀随机 $n$ 个 $[1,m]$ 中的整数组成一个数列，然后输出其权值。\n\n当然，她的这份程序一分都没拿到；但她想知道，生成出的序列期望权值是多少。\n\n为了防止精度问题，答案需要对 $998244353$ 取模。", "inputFormat": "一行两个正整数 $n,m$。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "【样例一解释】  \n\n显然有 $8$ 种可能的序列：  \n$[1,1,1],[1,1,2],[1,2,1],[1,2,2],[2,1,1],[2,1,2],[2,2,1],[2,2,2]$。\n\n权值分别为 $10,12,12,23,12,17,23,46$，期望值就是 $\\frac{155}{8}$。\n\n【样例二解释】\n\n期望值是 $\\frac{76842}{243}$。\n\n【数据范围】  \n\n**本题采用捆绑测试**。\n\n- Subtask 1（5 pts）：$1\\le n,m \\le 8$；  \n- Subtask 2（7 pts）：$1\\le n,m \\le 100$；  \n- Subtask 3（11 pts）：$1 \\le n,m \\le 400$； \n- Subtask 4（13 pts）：$1\\le n,m \\le 5000$；\n- Subtask 5（25 pts）：$1\\le n \\le 5000$；\n- Subtask 6（39 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据满足，$1\\le n \\le 2 \\times 10^5$，$1\\le m \\le 10^8$。\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「PMOI-2」简单构造题", "background": "", "description": "某次模拟赛中，NaCly\\_Fish 遇见这样一道题：\n****\n定义一个长度为 $n$ 的序列 $A$ 的权值为：\n\n$$\\sum_{l=1}^n\\sum_{r=l}^n f_A(l,r)$$\n其中 $f_A(l,r)$ 就是在 $A$ 的区间 $[l,r]$ 中，「所有**在该区间内出现过的**元素出现次数的乘积」再乘上「区间内所有元素的乘积」。  \n\n要求构造一个长为 $n$ 的序列，其中每个元素都是 $[1,m]$ 中的整数，最大化其权值。\n****\n她并不会，只好均匀随机 $n$ 个 $[1,m]$ 中的整数组成一个数列，然后输出其权值。\n\n当然，她的这份程序一分都没拿到；但她想知道，生成出的序列期望权值是多少。\n\n为了防止精度问题，答案需要对 $998244353$ 取模。", "inputFormat": "一行两个正整数 $n,m$。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "【样例一解释】  \n\n显然有 $8$ 种可能的序列：  \n$[1,1,1],[1,1,2],[1,2,1],[1,2,2],[2,1,1],[2,1,2],[2,2,1],[2,2,2]$。\n\n权值分别为 $10,12,12,23,12,17,23,46$，期望值就是 $\\frac{155}{8}$。\n\n【样例二解释】\n\n期望值是 $\\frac{76842}{243}$。\n\n【数据范围】  \n\n**本题采用捆绑测试**。\n\n- Subtask 1（5 pts）：$1\\le n,m \\le 8$；  \n- Subtask 2（7 pts）：$1\\le n,m \\le 100$；  \n- Subtask 3（11 pts）：$1 \\le n,m \\le 400$； \n- Subtask 4（13 pts）：$1\\le n,m \\le 5000$；\n- Subtask 5（25 pts）：$1\\le n \\le 5000$；\n- Subtask 6（39 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据满足，$1\\le n \\le 2 \\times 10^5$，$1\\le m \\le 10^8$。\n\n", "locale": "zh-CN"}}}
{"pid": "P7424", "type": "P", "difficulty": 5, "samples": [["3 2\n1 3 1\n2 4 2\n3 4 1\n2\n3", "1\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "树状数组", "可持久化线段树", "可持久化", "分块", "整体二分", "THUPC"], "title": "[THUPC 2017] 天天爱射击", "background": "", "description": "小 C 爱上了一款名字叫做《天天爱射击》的游戏。如图所示，这个游戏有一些平行于 $x$ 轴的木板。现在有一些子弹，按顺序沿着 $y$ 轴方向向这些木板射去。第 $i$ 块木板被 $S_i$ 个子弹贯穿以后，就会碎掉消失。一个子弹可以贯穿其弹道上的全部木板，特别的，如果一个子弹触碰到木板的边缘，也视为贯穿木板。\n\n小 C 现在知道了游戏中 $n$ 块木板位置，以及知道了 $m$ 个子弹射击位置。现在问你每个子弹射出去以后，有多少木板会碎掉？", "inputFormat": "从标准输入读入数据。\n\n第一行两个整数 $n$ 和 $m$，表示木板数量和子弹数量。其中 $1\\le n,m\\le 2\\times 10^5$。\n\n接下来 $n$ 行，每行三个整数 $x_1,x_2,s$，表示每块木板的左端点 $x$ 坐标、右端点 $x$ 坐标，以及贯穿多少次会碎掉。其中保证 $1\\le x_1\\le x_2\\le2\\times 10^5,1\\le s\\le 2\\times 10^5$。\n\n接下来 $m$ 行，每行一个整数 ，表示每个子弹的 $x$ 坐标。子弹按照发射顺序给出。其中保证 $1\\le x\\le2\\times 10^5$。", "outputFormat": "输出到标准输出。\n\n$m$ 行，每行一个整数。表示每颗子弹射出去后，有多少木板碎掉。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/ocqlbnl3.png)\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。\n\n$\\text{upd}2021.7.6$：感谢 @[jiangbowen](https://www.luogu.com.cn/user/366807) 提供的一组 hack 数据，不计分，但若不通过 hack 数据则不算通过此题。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2017] 天天爱射击", "background": "", "description": "小 C 爱上了一款名字叫做《天天爱射击》的游戏。如图所示，这个游戏有一些平行于 $x$ 轴的木板。现在有一些子弹，按顺序沿着 $y$ 轴方向向这些木板射去。第 $i$ 块木板被 $S_i$ 个子弹贯穿以后，就会碎掉消失。一个子弹可以贯穿其弹道上的全部木板，特别的，如果一个子弹触碰到木板的边缘，也视为贯穿木板。\n\n小 C 现在知道了游戏中 $n$ 块木板位置，以及知道了 $m$ 个子弹射击位置。现在问你每个子弹射出去以后，有多少木板会碎掉？", "inputFormat": "从标准输入读入数据。\n\n第一行两个整数 $n$ 和 $m$，表示木板数量和子弹数量。其中 $1\\le n,m\\le 2\\times 10^5$。\n\n接下来 $n$ 行，每行三个整数 $x_1,x_2,s$，表示每块木板的左端点 $x$ 坐标、右端点 $x$ 坐标，以及贯穿多少次会碎掉。其中保证 $1\\le x_1\\le x_2\\le2\\times 10^5,1\\le s\\le 2\\times 10^5$。\n\n接下来 $m$ 行，每行一个整数 ，表示每个子弹的 $x$ 坐标。子弹按照发射顺序给出。其中保证 $1\\le x\\le2\\times 10^5$。", "outputFormat": "输出到标准输出。\n\n$m$ 行，每行一个整数。表示每颗子弹射出去后，有多少木板碎掉。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/ocqlbnl3.png)\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。\n\n$\\text{upd}2021.7.6$：感谢 @[jiangbowen](https://www.luogu.com.cn/user/366807) 提供的一组 hack 数据，不计分，但若不通过 hack 数据则不算通过此题。", "locale": "zh-CN"}}}
{"pid": "P7425", "type": "P", "difficulty": 6, "samples": [["2\n3 1 1\n0.5\n1 1 5\n1 1 5\n1 1 5\n6 2 2\n0.5\n4 1 4\n4 2 7\n8 4 8\n8 4 8\n10 5 9\n1 7 9", "impossible\n7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "图论建模", "费用流", "THUPC"], "title": "[THUPC 2017] 机场", "background": "", "description": "飞机场有 $a+b$ 个停机位，其中 $a$ 个停机位有登机桥连接飞机和候机厅，乘客可以通过登机桥直接由候机厅登上飞机；另外 $b$ 个停机位没有登机桥和候机厅相连，所以乘客登机需要先搭乘摆渡车再登机。\n\n毫无疑问，搭乘摆渡车的体验是非常差的，所以每位搭乘摆渡车的乘客都会产生不愉快度。\n\n现在，给定每架飞机的乘客数量，登机时间和起飞时间；飞机需要在登机时间点选择一个空闲的停机位，在这个时间点内所有乘客会完成登机，然后飞机会一直停在该停机位，直到起飞时间；\n\n若某飞机在时刻 $x$ 起飞，则在时刻 $x$ 该飞机所在的停机位是空闲的。\n\n飞机场的管理层希望能够尽量减少乘客的不愉快度，为此飞机在登机时间到起飞时间之间，可以切换停机位；\n\n假设某飞机从 $x$ 时间开始由停机位 A 切换到停机位 B，那么停机位 A 在 $x+1$ 时间是空闲的。能进行这样的切换当且仅当停机位 B 在 $x+1$ 时间是空闲的。", "inputFormat": "输入有多组数据，第一行一个正整数 $T$ 表示数据组数；对于每组数据：\n\n第一行输入三个非负整数 $n,a,b$，分别表示飞机数量、有登机桥的停机位数量、没有登机桥的停机位数量；\n\n第二行一个浮点数 $p$，输入最多保留小数点后两位；\n\n接下来 $n$ 行，每行三个正整数 $x,s,t$，描述一架飞机的乘客数量、登机时间和起飞时间。", "outputFormat": "对于每组数据，输出一行一个整数，表示最小的不愉快度。\n\n如果无法安排一个合理的方案使得所有飞机都完成登机，则输出 `impossible`。", "hint": "题目中貌似没有给出明确的不愉快度的计算方法，据样例解释推测是不愉快度=所有乘坐摆渡车的人数$+p\\times$ 每次切换停机位的飞机上的人数向下取整。\n#### 数据范围\n$1\\le T\\le 8,1\\le n\\le 200,0\\le p\\le1,1\\le x\\le 10^5,1\\le s\\le t\\le10^9$\n#### 样例解释\n飞机从 $1$ 开始编号\n\n在时刻 $1$，$1$ 号飞机安排到登机桥 A，乘客开始登机；目前 $1$ 号飞机在登机桥 A。\n\n在时刻 $2$，$2$ 号飞机安排到登机桥 B，乘客开始登机；目前 $1$ 号飞机在登机桥 A，$2$ 号飞机在登机桥 B。\n\n在时刻 $3$，$2$ 号飞机切换到摆渡车 A，此时登机桥 B 尚不可用。\n\n在时刻 $4$，$1$ 号飞机起飞，$2$ 号飞机到达摆渡车 A， 号飞机安排到登机桥 A，$3$ 号飞机安排到登机桥 B，$4$ 号和 $3$ 号的乘客开始登机，登机完成之后 $4$ 号飞机切换到摆渡车 B，此时登机桥 A 和登机桥 B 都不空闲。\n\n在时刻 $5$，$3$ 号飞机到达摆渡车 B，登机桥 A 变为可用，$5$ 号飞机安排到登机桥 A，开始登机；目前 $5$ 号——登机桥 A，$4$ 号——登机桥 B，$3$ 号——摆渡车 B，$2$ 号——摆渡车 A。\n\n在时刻 $7$，$2$ 号飞机起飞，$6$ 号飞机安排到摆渡车 A。\n\n不愉快度为 $7=1$（$6$ 号飞机乘客乘摆渡车）$+4\\times 0.5$（$2$ 号飞机切换停机位）$+8\\times 0.5$（$3$ 号飞机切换停机位）\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2017] 机场", "background": "", "description": "飞机场有 $a+b$ 个停机位，其中 $a$ 个停机位有登机桥连接飞机和候机厅，乘客可以通过登机桥直接由候机厅登上飞机；另外 $b$ 个停机位没有登机桥和候机厅相连，所以乘客登机需要先搭乘摆渡车再登机。\n\n毫无疑问，搭乘摆渡车的体验是非常差的，所以每位搭乘摆渡车的乘客都会产生不愉快度。\n\n现在，给定每架飞机的乘客数量，登机时间和起飞时间；飞机需要在登机时间点选择一个空闲的停机位，在这个时间点内所有乘客会完成登机，然后飞机会一直停在该停机位，直到起飞时间；\n\n若某飞机在时刻 $x$ 起飞，则在时刻 $x$ 该飞机所在的停机位是空闲的。\n\n飞机场的管理层希望能够尽量减少乘客的不愉快度，为此飞机在登机时间到起飞时间之间，可以切换停机位；\n\n假设某飞机从 $x$ 时间开始由停机位 A 切换到停机位 B，那么停机位 A 在 $x+1$ 时间是空闲的。能进行这样的切换当且仅当停机位 B 在 $x+1$ 时间是空闲的。", "inputFormat": "输入有多组数据，第一行一个正整数 $T$ 表示数据组数；对于每组数据：\n\n第一行输入三个非负整数 $n,a,b$，分别表示飞机数量、有登机桥的停机位数量、没有登机桥的停机位数量；\n\n第二行一个浮点数 $p$，输入最多保留小数点后两位；\n\n接下来 $n$ 行，每行三个正整数 $x,s,t$，描述一架飞机的乘客数量、登机时间和起飞时间。", "outputFormat": "对于每组数据，输出一行一个整数，表示最小的不愉快度。\n\n如果无法安排一个合理的方案使得所有飞机都完成登机，则输出 `impossible`。", "hint": "题目中貌似没有给出明确的不愉快度的计算方法，据样例解释推测是不愉快度=所有乘坐摆渡车的人数$+p\\times$ 每次切换停机位的飞机上的人数向下取整。\n#### 数据范围\n$1\\le T\\le 8,1\\le n\\le 200,0\\le p\\le1,1\\le x\\le 10^5,1\\le s\\le t\\le10^9$\n#### 样例解释\n飞机从 $1$ 开始编号\n\n在时刻 $1$，$1$ 号飞机安排到登机桥 A，乘客开始登机；目前 $1$ 号飞机在登机桥 A。\n\n在时刻 $2$，$2$ 号飞机安排到登机桥 B，乘客开始登机；目前 $1$ 号飞机在登机桥 A，$2$ 号飞机在登机桥 B。\n\n在时刻 $3$，$2$ 号飞机切换到摆渡车 A，此时登机桥 B 尚不可用。\n\n在时刻 $4$，$1$ 号飞机起飞，$2$ 号飞机到达摆渡车 A， 号飞机安排到登机桥 A，$3$ 号飞机安排到登机桥 B，$4$ 号和 $3$ 号的乘客开始登机，登机完成之后 $4$ 号飞机切换到摆渡车 B，此时登机桥 A 和登机桥 B 都不空闲。\n\n在时刻 $5$，$3$ 号飞机到达摆渡车 B，登机桥 A 变为可用，$5$ 号飞机安排到登机桥 A，开始登机；目前 $5$ 号——登机桥 A，$4$ 号——登机桥 B，$3$ 号——摆渡车 B，$2$ 号——摆渡车 A。\n\n在时刻 $7$，$2$ 号飞机起飞，$6$ 号飞机安排到摆渡车 A。\n\n不愉快度为 $7=1$（$6$ 号飞机乘客乘摆渡车）$+4\\times 0.5$（$2$ 号飞机切换停机位）$+8\\times 0.5$（$3$ 号飞机切换停机位）\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN"}}}
{"pid": "P7426", "type": "P", "difficulty": 5, "samples": [["1\n2015011233 M 34 14'30\" P 3 3\n8\n20170508 2015011233 17:02:33 17:19:33 2.99 0'0\" 3333\n20170509 2015011233 17:12:15 17:38:46 3.01 2'3\" 4300\n20170510 2015011233 22:03:06 22:13:08 3.05 0'0\" 2772\n20170511 2015011233 22:08:05 22:28:13 3.02 5'3\" 3775\n20170512 2015011233 18:03:12 18:17:56 3.02 0'0\" 2001\n20170513 2015011233 17:30:23 17:46:08 3.01 0'0\" 3020\n20170513 2015011233 22:03:34 22:20:08 3.04 2'0\" 3058\n20170514 2015011233 07:16:22 07:32:34 3.00 0'0\" 3244", "2015011233 59 F"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["模拟", "2017", "THUPC"], "title": "[THUPC 2017] 体育成绩统计", "background": "正所谓「无体育，不清华」。为了更好地督促同学们进行体育锻炼，更加科学地对同学们进行评价，五道口体校的老师们在体育成绩的考核上可谓是煞费苦心。然而每到学期期末时，面对海量的原始数据，如何对数据进行处理，得到同学们的体育总评成绩却又成了体育部老师的一大难题。", "description": "对于大一的同学们来说，体育课的总评成绩由五部分组成：体育课专项成绩（满分 $50$ 分）、长跑测试成绩（满分 $20$ 分）、「阳光长跑」成绩（满分 $10$ 分）、体质测试成绩（满分 $10$ 分）、「大一专项计划」成绩（满分 $10$ 分）。\n\n体育课专项成绩将由任课体育老师直接给出。\n\n长跑测试成绩将由期末长跑测试确定，其中男生需进行 $3000$ 米测试，女生需进行 $1500$ 米测试，具体评分标准为：\n|  | $20$ | $18$ | $16$ | $14$ | $12$ | $10$ | $8$ | $6$ | $4$ | $2$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| 男生 | $12'30''$ | $13'00''$ | $13'30''$ | $14'00''$ | $14'30''$ | $15'10''$ | $15'50''$ | $16'30''$ | $17'10''$ | $18'00''$ |\n| 女生 | $6'40''$ | $6'57''$ | $7'14''$ | $7'31''$ | $7'50''$ | $8'05''$ | $8'20''$ | $8'35''$ | $8'50''$ | $9'00''$ |\n\n「阳光长跑」是通过手机 App 来记录同学们的课外长跑情况，根据对原始跑步数据进行筛选，得到课外长跑的合法次数，来最终确定此部分的成绩。\n\n一条合法的锻炼记录需同时满足：\n\n男生长跑距离 $3000$ 米以上（包含 $3000$ 米），女生长跑距离 $1500$ 米以上（包含 $1500$ 米）；\n\n平均速度（运动距离/(结束时间-开始时间)）不慢于 $2$ 米／秒，且不快于 $5$ 米／秒；\n\n总暂停时间不得超过 $4$ 分 $30$ 秒；\n\n平均步幅（距离／步数）不超过 $1.5$ 米；\n\n开始时间需与上条合法记录的结束时间间隔 $6$ 小时以上（包含 $6$ 小时）；\n\n「阳光长跑」的合法次数与该部分得分的对应如下：\n| 分数 | $10$ | $9$ | $8$ | $7$ | $6$ | $4$ | $2$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| 次数 | $[21,+∞)$ | $[19,20]$ | $[17,18]$ | $[14,16]$ | $[11,13]$ | $[7,10]$ | $[3,6]$ |\n\n对于体质测试部分，若达到合格标准则得到该部分满分 $10$ 分，否则该部分不得分。\n\n「大一专项计划」的 $10$ 分由两部分组成：出勤次数占 $5$ 分，期末检测占 $5$ 分。\n\n其中出勤次数为「班级训练营」的参加次数和「阳光长跑」的合法次数之和，出勤得分与出勤次数的对应如下：\n| 分数 | $5$ | $4$ | $3$ | $2$ | $1$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| 次数 | $[18,+∞)$ | $[15,17]$ | $[12,14]$ | $[9,11]$ | $[6,8]$ |\n\n不难看出，要想准确无误地计算出每个人的体育成绩并不是一件轻松的事，于是体育部的老师找到了正在打校赛的你，他将提供所有需要用到的数据，希望你帮他算算清华大一同学的体育总评成绩及等级。\n\n百分制成绩与等级、绩点对应如下：\n| A | A- | B+ | B | B- | C+ | C | C- |D+  | D | F |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $[95,100]$ | $[90,95)$ | $[85,90)$ | $[80,85)$ | $[77,80)$ | $[73,77)$ | $[70,73)$ | $[67,70)$ | $[63,67)$ | $[60,63)$ | $[0,60)$ |\n", "inputFormat": "从标准输入读入数据。\n\n输入第一行，包含一个正整数 $n$，表示大一年级的学生人数。\n\n接下来 $n$ 行，每行表示一位学生（按学号字典序给出），各项数据之间用空格隔开，一位学生的数据包括：\n\n- 一个长度为 $10$ 的正整数 $p$（数据保证不包含前导零），表示第 $i$ 位同学的学号；\n- 一个字符，M 或 F，若为 M 表示第 $i$ 位同学为男生，若为 F 则表示第 $i$ 位同学为女生；\n- 一个介于 $0$ 到 $50$ 之间的非负整数 $s$，表示第 $i$ 位同学的体育课专项成绩；\n- 一个形如 `a'b\"` 的字符串，表示第 $i$ 位同学的期末长跑测试成绩为 $a$ 分 $b$ 秒；\n- 一个字符，P 或 F，若为 P 表示第 $i$ 位同学的体质测试通过，若为 F 则表示第 $i$ 位同学的体质测试没有通过；\n- 一个介于 $0$ 到 $5$ 之间的非负整数 $f$，表示第 $i$ 位同学的「大一专项计划」的期末检测成绩；\n- 一个非负整数 $c$，表示第 $i$ 位同学参加「班级训练营」的次数。\n\n接下来一行，包括一个非负整数 $m$，表示需要筛选的「阳光长跑」数据条数。\n\n接下来 $m$ 行，每行表示一条需要筛选的「阳光长跑」数据（按开始时间顺序给出），各项之间用空格隔开，一条数据包括：\n\n- 一个形如 `2017MMDD` 的字符串，表示第 $j$ 条记录的完成日期；\n- 一个长度为 $10$ 的正整数 $p$（数据保证不包含前导零），表示第 $j$ 条记录的来源学号；\n- 两个形如 `hh:mm:ss` 的字符串，分别表示第 $j$ 条记录的开始时间和结束时间；\n- 一个精确到小数点后两位的非负浮点数 $l$，表示第 $j$ 条记录的运动距离，单位为千米；\n- 一个形如 `a'b\"` 的字符串，表示第 $j$ 条记录的总暂停时间为 $a$ 分 $b$ 秒；\n- 一个非负整数 $s$，表示第 $j$ 条记录的运动总步数。\n\n输入格式可参见下发样例文件。", "outputFormat": "输出到标准输出。\n\n输出文件共包括 $n$ 行。请你按照学号**字典序**输出每一位同学的学号、百分制总评成绩以及等级。每位同学一行，一行内用空格隔开。", "hint": "对于 $100\\%$ 的数据，$n\\le 10^4,0\\le a,b\\le 59,0\\le c\\le 100,m\\le 1.5\\times 10^5,0\\le l\\le 100,0\\le s\\le 10^6$。\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2017] 体育成绩统计", "background": "正所谓「无体育，不清华」。为了更好地督促同学们进行体育锻炼，更加科学地对同学们进行评价，五道口体校的老师们在体育成绩的考核上可谓是煞费苦心。然而每到学期期末时，面对海量的原始数据，如何对数据进行处理，得到同学们的体育总评成绩却又成了体育部老师的一大难题。", "description": "对于大一的同学们来说，体育课的总评成绩由五部分组成：体育课专项成绩（满分 $50$ 分）、长跑测试成绩（满分 $20$ 分）、「阳光长跑」成绩（满分 $10$ 分）、体质测试成绩（满分 $10$ 分）、「大一专项计划」成绩（满分 $10$ 分）。\n\n体育课专项成绩将由任课体育老师直接给出。\n\n长跑测试成绩将由期末长跑测试确定，其中男生需进行 $3000$ 米测试，女生需进行 $1500$ 米测试，具体评分标准为：\n|  | $20$ | $18$ | $16$ | $14$ | $12$ | $10$ | $8$ | $6$ | $4$ | $2$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| 男生 | $12'30''$ | $13'00''$ | $13'30''$ | $14'00''$ | $14'30''$ | $15'10''$ | $15'50''$ | $16'30''$ | $17'10''$ | $18'00''$ |\n| 女生 | $6'40''$ | $6'57''$ | $7'14''$ | $7'31''$ | $7'50''$ | $8'05''$ | $8'20''$ | $8'35''$ | $8'50''$ | $9'00''$ |\n\n「阳光长跑」是通过手机 App 来记录同学们的课外长跑情况，根据对原始跑步数据进行筛选，得到课外长跑的合法次数，来最终确定此部分的成绩。\n\n一条合法的锻炼记录需同时满足：\n\n男生长跑距离 $3000$ 米以上（包含 $3000$ 米），女生长跑距离 $1500$ 米以上（包含 $1500$ 米）；\n\n平均速度（运动距离/(结束时间-开始时间)）不慢于 $2$ 米／秒，且不快于 $5$ 米／秒；\n\n总暂停时间不得超过 $4$ 分 $30$ 秒；\n\n平均步幅（距离／步数）不超过 $1.5$ 米；\n\n开始时间需与上条合法记录的结束时间间隔 $6$ 小时以上（包含 $6$ 小时）；\n\n「阳光长跑」的合法次数与该部分得分的对应如下：\n| 分数 | $10$ | $9$ | $8$ | $7$ | $6$ | $4$ | $2$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| 次数 | $[21,+∞)$ | $[19,20]$ | $[17,18]$ | $[14,16]$ | $[11,13]$ | $[7,10]$ | $[3,6]$ |\n\n对于体质测试部分，若达到合格标准则得到该部分满分 $10$ 分，否则该部分不得分。\n\n「大一专项计划」的 $10$ 分由两部分组成：出勤次数占 $5$ 分，期末检测占 $5$ 分。\n\n其中出勤次数为「班级训练营」的参加次数和「阳光长跑」的合法次数之和，出勤得分与出勤次数的对应如下：\n| 分数 | $5$ | $4$ | $3$ | $2$ | $1$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| 次数 | $[18,+∞)$ | $[15,17]$ | $[12,14]$ | $[9,11]$ | $[6,8]$ |\n\n不难看出，要想准确无误地计算出每个人的体育成绩并不是一件轻松的事，于是体育部的老师找到了正在打校赛的你，他将提供所有需要用到的数据，希望你帮他算算清华大一同学的体育总评成绩及等级。\n\n百分制成绩与等级、绩点对应如下：\n| A | A- | B+ | B | B- | C+ | C | C- |D+  | D | F |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $[95,100]$ | $[90,95)$ | $[85,90)$ | $[80,85)$ | $[77,80)$ | $[73,77)$ | $[70,73)$ | $[67,70)$ | $[63,67)$ | $[60,63)$ | $[0,60)$ |\n", "inputFormat": "从标准输入读入数据。\n\n输入第一行，包含一个正整数 $n$，表示大一年级的学生人数。\n\n接下来 $n$ 行，每行表示一位学生（按学号字典序给出），各项数据之间用空格隔开，一位学生的数据包括：\n\n- 一个长度为 $10$ 的正整数 $p$（数据保证不包含前导零），表示第 $i$ 位同学的学号；\n- 一个字符，M 或 F，若为 M 表示第 $i$ 位同学为男生，若为 F 则表示第 $i$ 位同学为女生；\n- 一个介于 $0$ 到 $50$ 之间的非负整数 $s$，表示第 $i$ 位同学的体育课专项成绩；\n- 一个形如 `a'b\"` 的字符串，表示第 $i$ 位同学的期末长跑测试成绩为 $a$ 分 $b$ 秒；\n- 一个字符，P 或 F，若为 P 表示第 $i$ 位同学的体质测试通过，若为 F 则表示第 $i$ 位同学的体质测试没有通过；\n- 一个介于 $0$ 到 $5$ 之间的非负整数 $f$，表示第 $i$ 位同学的「大一专项计划」的期末检测成绩；\n- 一个非负整数 $c$，表示第 $i$ 位同学参加「班级训练营」的次数。\n\n接下来一行，包括一个非负整数 $m$，表示需要筛选的「阳光长跑」数据条数。\n\n接下来 $m$ 行，每行表示一条需要筛选的「阳光长跑」数据（按开始时间顺序给出），各项之间用空格隔开，一条数据包括：\n\n- 一个形如 `2017MMDD` 的字符串，表示第 $j$ 条记录的完成日期；\n- 一个长度为 $10$ 的正整数 $p$（数据保证不包含前导零），表示第 $j$ 条记录的来源学号；\n- 两个形如 `hh:mm:ss` 的字符串，分别表示第 $j$ 条记录的开始时间和结束时间；\n- 一个精确到小数点后两位的非负浮点数 $l$，表示第 $j$ 条记录的运动距离，单位为千米；\n- 一个形如 `a'b\"` 的字符串，表示第 $j$ 条记录的总暂停时间为 $a$ 分 $b$ 秒；\n- 一个非负整数 $s$，表示第 $j$ 条记录的运动总步数。\n\n输入格式可参见下发样例文件。", "outputFormat": "输出到标准输出。\n\n输出文件共包括 $n$ 行。请你按照学号**字典序**输出每一位同学的学号、百分制总评成绩以及等级。每位同学一行，一行内用空格隔开。", "hint": "对于 $100\\%$ 的数据，$n\\le 10^4,0\\le a,b\\le 59,0\\le c\\le 100,m\\le 1.5\\times 10^5,0\\le l\\le 100,0\\le s\\le 10^6$。\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN"}}}
{"pid": "P7427", "type": "P", "difficulty": 2, "samples": [["10 5", "5 1 2 3 4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["贪心", "2017", "Special Judge", "构造", "THUPC"], "title": "[THUPC 2017] 玩游戏", "background": "", "description": "ljcc 和他的学妹在玩游戏，这个游戏共有 $n$ 轮，在第 $i$ 轮获胜会获得 $i$ 分，没有平局。\n\n现在给出 ljcc 和学妹的得分，求是否有一种方案符合当前得分。", "inputFormat": "从标准输入读入数据。\n\n输入一行输入两个数 $a,b$ 代表 ljcc 和学妹的得分。", "outputFormat": "输出到标准输出。\n\n若有解，在一行输出一组合法的解。第一个数代表游戏总共进行了 $n$ 轮，之后若干个数表示 ljcc 在哪些局获胜了，每两个数用单个空格隔开，行末不允许有空格。若没有合法解输出 `No`。", "hint": "**由于 SPJ 问题，禁止输出行末空格、回车**。\n\n$a,b\\le 2^{31}-1,1\\le n\\le 10^5$\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2017] 玩游戏", "background": "", "description": "ljcc 和他的学妹在玩游戏，这个游戏共有 $n$ 轮，在第 $i$ 轮获胜会获得 $i$ 分，没有平局。\n\n现在给出 ljcc 和学妹的得分，求是否有一种方案符合当前得分。", "inputFormat": "从标准输入读入数据。\n\n输入一行输入两个数 $a,b$ 代表 ljcc 和学妹的得分。", "outputFormat": "输出到标准输出。\n\n若有解，在一行输出一组合法的解。第一个数代表游戏总共进行了 $n$ 轮，之后若干个数表示 ljcc 在哪些局获胜了，每两个数用单个空格隔开，行末不允许有空格。若没有合法解输出 `No`。", "hint": "**由于 SPJ 问题，禁止输出行末空格、回车**。\n\n$a,b\\le 2^{31}-1,1\\le n\\le 10^5$\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN"}}}
{"pid": "P7428", "type": "P", "difficulty": 4, "samples": [["1\n8 28\n1 2\n1 3\n1 4\n1 5\n1 6\n1 7\n1 8\n2 3\n2 4\n2 5\n2 6\n2 7\n2 8\n3 4\n3 5\n3 6\n3 7\n3 8\n4 5\n4 6\n4 7\n4 8\n5 6\n5 7\n5 8\n6 7\n6 8\n7 8", "abcdabcd"]], "limits": {"time": [1000], "memory": [512000]}, "tags": ["图论", "2017", "Special Judge", "构造", "THUPC"], "title": "[THUPC 2017] 母亲节的礼物", "background": "", "description": "小 B 喜欢图，尤其是边数不太多的无向简单图。\n\n母亲节快到了，小 B 在纸上画了一张有 $n$ 个节点、$m$ 条边的无向简单图（即，不存在重边、自环），保证每个点只和**最多 $7$ 个点**相邻。接着，他想用 $4$ 种不同的颜色给图中的节点进行染色，作为妈妈的母亲节礼物送给她。\n\n小 B 希望染色之后的图尽量漂亮，他觉得相同颜色的点连成一片不好看。所以，他希望能给每对相邻的节点染上不同的颜色。遗憾的是，小 B 很快发现，在有些图中，这是不可能做到的。他不得不降低要求：每个点相邻的点中，**至多**有一个点和它的颜色相同。\n\n限制条件放松了，问题也就变得简单了；但是小 B 忙着做大作业，所以来找你帮忙。现在，请你告诉小 B，是否能给图中每个点染上一个恰当的颜色，恰好满足小 B 的要求？如果可以，请你给他指出一种染色方案；否则，只好残忍地告诉小 B：`impossible`。", "inputFormat": "输入有多组数据，第一行一个整数 $T$（$1\\le T\\le 10$） ，表示数据组数。\n\n对于每组数据：\n\n第一行两个整数 $n,m$（$1\\le n\\le 25000,1\\le m\\le 10^5$），分别表示图的点数和边数（约定点从 $1$ 开始标号）。\n\n接下来 $m$ 行，每行两个整数 $x,y$（$1\\le x,y\\le n$），描述图中的一条边，保证不存在重边、自环。\n\n保证在一个输入文件中，有 $\\sum n\\le 200000,\\sum m\\le 800000$。", "outputFormat": "我们用小写英文字母 `a`、`b`、`c`、`d` 给四种不同的颜色标号。\n\n对于每组数据：\n\n- 如果有解，输出一行一个长度为 $n$ 的字符串 $S$，其中 $S_i$ 表示你给第 $i$ 个点染上的颜色（下标从 $1$ 开始）；\n- 否则，输出 impossible。", "hint": "#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2017] 母亲节的礼物", "background": "", "description": "小 B 喜欢图，尤其是边数不太多的无向简单图。\n\n母亲节快到了，小 B 在纸上画了一张有 $n$ 个节点、$m$ 条边的无向简单图（即，不存在重边、自环），保证每个点只和**最多 $7$ 个点**相邻。接着，他想用 $4$ 种不同的颜色给图中的节点进行染色，作为妈妈的母亲节礼物送给她。\n\n小 B 希望染色之后的图尽量漂亮，他觉得相同颜色的点连成一片不好看。所以，他希望能给每对相邻的节点染上不同的颜色。遗憾的是，小 B 很快发现，在有些图中，这是不可能做到的。他不得不降低要求：每个点相邻的点中，**至多**有一个点和它的颜色相同。\n\n限制条件放松了，问题也就变得简单了；但是小 B 忙着做大作业，所以来找你帮忙。现在，请你告诉小 B，是否能给图中每个点染上一个恰当的颜色，恰好满足小 B 的要求？如果可以，请你给他指出一种染色方案；否则，只好残忍地告诉小 B：`impossible`。", "inputFormat": "输入有多组数据，第一行一个整数 $T$（$1\\le T\\le 10$） ，表示数据组数。\n\n对于每组数据：\n\n第一行两个整数 $n,m$（$1\\le n\\le 25000,1\\le m\\le 10^5$），分别表示图的点数和边数（约定点从 $1$ 开始标号）。\n\n接下来 $m$ 行，每行两个整数 $x,y$（$1\\le x,y\\le n$），描述图中的一条边，保证不存在重边、自环。\n\n保证在一个输入文件中，有 $\\sum n\\le 200000,\\sum m\\le 800000$。", "outputFormat": "我们用小写英文字母 `a`、`b`、`c`、`d` 给四种不同的颜色标号。\n\n对于每组数据：\n\n- 如果有解，输出一行一个长度为 $n$ 的字符串 $S$，其中 $S_i$ 表示你给第 $i$ 个点染上的颜色（下标从 $1$ 开始）；\n- 否则，输出 impossible。", "hint": "#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN"}}}
{"pid": "P7429", "type": "P", "difficulty": 6, "samples": [["1\n3\n0 0\n0 1\n1 0\n1 1", "2"]], "limits": {"time": [1000], "memory": [512000]}, "tags": ["计算几何", "2017", "线性代数", "高斯消元", "THUPC"], "title": "[THUPC 2017] 气氛", "background": "", "description": "北大街，在中国是一个非常常见的地名，比较著名的有上海北大街，西安北大街，成都北大街，太原北大街，中关村北大街等。\n\n我们都知道，北的意思是自由民主，大的意思是兼收并蓄，所以住在北大街的人也性情迥异，我们假设在北大街住了 $n$ 个人。\n\n有人向住在北大街的这 $n$ 个人提了 $n-1$ 个问题，比如：\n\n「用不用筷子？」\n\n「吃不吃红烧肉？」\n\n「写代码用 tab 还是 space」\n\n「大括号换不换行？」\n\n「……」\n\n根据每个人的回答，他会被分配一个 $n-1$ 维的零一坐标，也就是一个点。这样 $n$ 个点可以恰好构成一个 $n-1$ 维空间中的凸包。\n\n北大街的居民认为，在这个多面体内，便是华夏；多面体之外，便是蛮夷。我们可以很容易的计算出华夏部分的广义凸包体积。\n\n有一天，清华路的 B 君来北大街玩，听说了这个故事觉得很有趣，于是也试着给出了这 $n-1$ 个问题的答案，\n\n清华路的 B 君，当然认为自己属于华夏，但是北大街表示在 $n-1$ 维空间中如果有 $n+1$ 个点的话，华夏部分的体积难以计算。\n\n这下子气氛突然僵化。所以这个问题就留给你了，输入 $n-1$ 维度空间中的 $n+1$ 个点，求广义凸包的体积。\n\n由于这个体积可能不是整数，你只需要输出体积乘以 $n-1$ 的阶乘，然后对 $10^9+7$ 取模的结果。", "inputFormat": "从标准输入读入数据。\n\n第一行一个整数 $T$ 表示组数，接下来是 $T$ 组数据\n\n每组数据的第一行是一个整数 $n$ 。\n\n接下来 $n+1$ 行，每行 $n-1$ 个整数，表示在 $n-1$ 维空间中的一个点。", "outputFormat": "输出到标准输出。\n\n对于每组数据，输出一行一个整数表示答案。\n\n输入 $n+1$ 个点的凸包体积乘以 $n-1$ 的阶乘，然后对 $10^9+7$ 取模的结果。", "hint": "$1\\le t\\le 100,3\\le n\\le35$\n\n点的坐标一定是 $0$ 或者 $1$。\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2017] 气氛", "background": "", "description": "北大街，在中国是一个非常常见的地名，比较著名的有上海北大街，西安北大街，成都北大街，太原北大街，中关村北大街等。\n\n我们都知道，北的意思是自由民主，大的意思是兼收并蓄，所以住在北大街的人也性情迥异，我们假设在北大街住了 $n$ 个人。\n\n有人向住在北大街的这 $n$ 个人提了 $n-1$ 个问题，比如：\n\n「用不用筷子？」\n\n「吃不吃红烧肉？」\n\n「写代码用 tab 还是 space」\n\n「大括号换不换行？」\n\n「……」\n\n根据每个人的回答，他会被分配一个 $n-1$ 维的零一坐标，也就是一个点。这样 $n$ 个点可以恰好构成一个 $n-1$ 维空间中的凸包。\n\n北大街的居民认为，在这个多面体内，便是华夏；多面体之外，便是蛮夷。我们可以很容易的计算出华夏部分的广义凸包体积。\n\n有一天，清华路的 B 君来北大街玩，听说了这个故事觉得很有趣，于是也试着给出了这 $n-1$ 个问题的答案，\n\n清华路的 B 君，当然认为自己属于华夏，但是北大街表示在 $n-1$ 维空间中如果有 $n+1$ 个点的话，华夏部分的体积难以计算。\n\n这下子气氛突然僵化。所以这个问题就留给你了，输入 $n-1$ 维度空间中的 $n+1$ 个点，求广义凸包的体积。\n\n由于这个体积可能不是整数，你只需要输出体积乘以 $n-1$ 的阶乘，然后对 $10^9+7$ 取模的结果。", "inputFormat": "从标准输入读入数据。\n\n第一行一个整数 $T$ 表示组数，接下来是 $T$ 组数据\n\n每组数据的第一行是一个整数 $n$ 。\n\n接下来 $n+1$ 行，每行 $n-1$ 个整数，表示在 $n-1$ 维空间中的一个点。", "outputFormat": "输出到标准输出。\n\n对于每组数据，输出一行一个整数表示答案。\n\n输入 $n+1$ 个点的凸包体积乘以 $n-1$ 的阶乘，然后对 $10^9+7$ 取模的结果。", "hint": "$1\\le t\\le 100,3\\le n\\le35$\n\n点的坐标一定是 $0$ 或者 $1$。\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN"}}}
{"pid": "P7430", "type": "P", "difficulty": 6, "samples": [["3 3\n1 3\n2 5\n2 3\n5 1\n1 5\n2 4\n3 3\n4 2\n5 1", "1.000000\n0.600000"]], "limits": {"time": [4000], "memory": [512000]}, "tags": ["数学", "2017", "二分", "Special Judge", "THUPC"], "title": "[THUPC 2017] 组合数问题", "background": "", "description": "小葱是一名勇士。\n\n小葱踏上了拯救世界的征途。\n\n小葱面前有 $N$ 只大葱怪。\n\n大葱怪很厉害，第 $i$ 只大葱怪攻击力为 $a_i$，防御力为 $d_i$。\n\n小葱的攻击力为 $A$，防御力为 $D$。\n\n小葱打掉第 $i$ 只大葱怪的代价是 $A\\times d_i+D\\times a_i$。\n\n小葱打倒很多只大葱怪的代价不是打倒每一只大葱怪的代价之和，而是最大值。\n\n小葱现在需要打倒 $R$ 只大葱怪。\n\n神葱是葱的神，神葱会对小葱打倒 $R$ 只大葱怪做出评价。神葱对小葱打倒 $R$ 只大葱的评价为小葱打倒这 $R$ 只大葱怪所需要的代价除以小葱以同样的攻击力和防御力打倒所有 $N$ 只大葱怪的代价。\n\n神葱是葱的神，所以神葱会在小葱选择了 $R$ 只要被打倒的大葱怪后，设定小葱的攻击力和防御力，使得小葱得到的评价最低。\n\n神葱不希望这个值是负的，所以如果这个值是负的，神葱会强制把它变为 $0$。\n\n小葱是一名勇士。\n\n小葱不会屈服。\n\n小葱需要选择出 $R$ 只大葱怪，使得自己能够从神葱那里得到的评价最高。\n\n小葱求这个评价值。\n\n小葱很善良，所以小葱为你写出了评价值的数学表示：\n$$\\max_{S\\subseteq [N],|S|=R}\\Big\\lbrack\\min_{A,D\\in\\Z^+}\\dfrac{\\max_{i\\in S}(A\\times d_i+D\\times a_i)}{\\max_{i\\in [N]}(A\\times d_i+D\\times a_i)}\\Big\\rbrack$$", "inputFormat": "测试点包含多组数据。\n\n对于每组数据，第一行两个整数代表 $N,R$。\n\n接下来 $N$ 行每行两个实数分别代表 $a_i,d_i$。", "outputFormat": "对于每组数据，一行一个实数代表答案，你需要保证你的答案与标准答案的误差不超过 $10^{-6}$。", "hint": "$1\\le R\\le N\\le 10^3,a_i,d_i$ 均为正整数，数据组数不超过 $50$ 组，所有攻击力和防御力都是正整数。\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2017] 组合数问题", "background": "", "description": "小葱是一名勇士。\n\n小葱踏上了拯救世界的征途。\n\n小葱面前有 $N$ 只大葱怪。\n\n大葱怪很厉害，第 $i$ 只大葱怪攻击力为 $a_i$，防御力为 $d_i$。\n\n小葱的攻击力为 $A$，防御力为 $D$。\n\n小葱打掉第 $i$ 只大葱怪的代价是 $A\\times d_i+D\\times a_i$。\n\n小葱打倒很多只大葱怪的代价不是打倒每一只大葱怪的代价之和，而是最大值。\n\n小葱现在需要打倒 $R$ 只大葱怪。\n\n神葱是葱的神，神葱会对小葱打倒 $R$ 只大葱怪做出评价。神葱对小葱打倒 $R$ 只大葱的评价为小葱打倒这 $R$ 只大葱怪所需要的代价除以小葱以同样的攻击力和防御力打倒所有 $N$ 只大葱怪的代价。\n\n神葱是葱的神，所以神葱会在小葱选择了 $R$ 只要被打倒的大葱怪后，设定小葱的攻击力和防御力，使得小葱得到的评价最低。\n\n神葱不希望这个值是负的，所以如果这个值是负的，神葱会强制把它变为 $0$。\n\n小葱是一名勇士。\n\n小葱不会屈服。\n\n小葱需要选择出 $R$ 只大葱怪，使得自己能够从神葱那里得到的评价最高。\n\n小葱求这个评价值。\n\n小葱很善良，所以小葱为你写出了评价值的数学表示：\n$$\\max_{S\\subseteq [N],|S|=R}\\Big\\lbrack\\min_{A,D\\in\\Z^+}\\dfrac{\\max_{i\\in S}(A\\times d_i+D\\times a_i)}{\\max_{i\\in [N]}(A\\times d_i+D\\times a_i)}\\Big\\rbrack$$", "inputFormat": "测试点包含多组数据。\n\n对于每组数据，第一行两个整数代表 $N,R$。\n\n接下来 $N$ 行每行两个实数分别代表 $a_i,d_i$。", "outputFormat": "对于每组数据，一行一个实数代表答案，你需要保证你的答案与标准答案的误差不超过 $10^{-6}$。", "hint": "$1\\le R\\le N\\le 10^3,a_i,d_i$ 均为正整数，数据组数不超过 $50$ 组，所有攻击力和防御力都是正整数。\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN"}}}
{"pid": "P7431", "type": "P", "difficulty": 6, "samples": [["2\n3\n2 3 3\n5\n1 2 3 4 5", "32\n4675"]], "limits": {"time": [3000], "memory": [512000]}, "tags": ["2017", "分治", "快速傅里叶变换 FFT", "快速数论变换 NTT", "THUPC"], "title": "[THUPC 2017] 小 L 的计算题", "background": "", "description": "现有一个长度为 $n$ 的非负整数数组 $\\{a_i\\}$ 。小 L 定义了一种神奇变换：\n$$f_k=\\left(\\sum_{i=1}^na_i^k\\right)\\bmod 998244353$$\n小 L 计划用变换生成的序列 $f$ 做一些有趣的事情，但是他并不擅长算乘法，所以来找你帮忙，希望你能帮他尽快计算出 $f_{1\\dots n}$。", "inputFormat": "输入包含多组数据。\n\n输入的第一行包含一个整数 $T$ , 表示数据组数。\n\n接下来 $2T$ 行，每两行代表一组测试数据。\n\n每组数据的第一行包含一个整数 $n$，表示数组 $\\{a_i\\}$ 的长度。接下来一行 $n$ 个整数，描述数组 $\\{a_i\\}$。\n\n保证输入的 $a_i$ 满足 $0\\le a_i\\le10^9$。在一个测试文件中，保证有 $\\sum n\\le 4\\times 10^5$。", "outputFormat": "我们不想让你输出过多的数。因此，令 $ans=\\bigoplus_{i=1}^{n}f_i$，其中 $\\bigoplus$ 表示**异或**操作，在 C++ / Java / Python 中，它可以表示为 `^`。\n\n对每组数据，你需要输出一行一个整数，表示 $ans$。", "hint": "对于 $100\\%$ 的数据，$0\\le a_i\\le10^9$，$1\\le n\\le 2\\times 10^5$，$\\sum n\\le 4\\times 10^5$。\n\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2017] 小 L 的计算题", "background": "", "description": "现有一个长度为 $n$ 的非负整数数组 $\\{a_i\\}$ 。小 L 定义了一种神奇变换：\n$$f_k=\\left(\\sum_{i=1}^na_i^k\\right)\\bmod 998244353$$\n小 L 计划用变换生成的序列 $f$ 做一些有趣的事情，但是他并不擅长算乘法，所以来找你帮忙，希望你能帮他尽快计算出 $f_{1\\dots n}$。", "inputFormat": "输入包含多组数据。\n\n输入的第一行包含一个整数 $T$ , 表示数据组数。\n\n接下来 $2T$ 行，每两行代表一组测试数据。\n\n每组数据的第一行包含一个整数 $n$，表示数组 $\\{a_i\\}$ 的长度。接下来一行 $n$ 个整数，描述数组 $\\{a_i\\}$。\n\n保证输入的 $a_i$ 满足 $0\\le a_i\\le10^9$。在一个测试文件中，保证有 $\\sum n\\le 4\\times 10^5$。", "outputFormat": "我们不想让你输出过多的数。因此，令 $ans=\\bigoplus_{i=1}^{n}f_i$，其中 $\\bigoplus$ 表示**异或**操作，在 C++ / Java / Python 中，它可以表示为 `^`。\n\n对每组数据，你需要输出一行一个整数，表示 $ans$。", "hint": "对于 $100\\%$ 的数据，$0\\le a_i\\le10^9$，$1\\le n\\le 2\\times 10^5$，$\\sum n\\le 4\\times 10^5$。\n\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN"}}}
{"pid": "P7432", "type": "P", "difficulty": 6, "samples": [["2\n3 10 3\n2 3 3\n20 50 24\n3 1 10\n1 1\n2 2\n3 3\n2 7 3\n6 7\n1 2\n1 1\n1 1\n2 2\n1 2", "568 120\n660 20\n660 20\n2 2\n2 0\n0 0"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000], "memory": [65536, 65536, 65536, 65536, 65536]}, "tags": ["动态规划 DP", "2017", "O2优化", "背包 DP", "分块", "THUPC"], "title": "[THUPC 2017] 钦妹的玩具商店", "background": null, "description": "钦妹和弗雷兹在 C 市有一个玩具店，店里有 $n$ 种玩具，编号依次为 $1,2,...,n$，第 $i$ 件玩具的单价为 $c_i$ 元，一个该玩具提供的愉悦度为  $v_i$。\n\n突然有一天，C 市来了 $m$ 个小朋友。据可靠消息，接下来 $Q$ 天，这些小朋友每天都会来店里买东西，其中第 $i$ 个小朋友每天都会带 $i$ 元  （$1\\le i\\le m$）。\n\n由于某些玩具不是很优秀，所以每天都会有不同的玩具被禁止出售给小朋友。具体来说，在第 $i$ 天，编号在区间 $[l_i,r_i]$ 内的物品小朋友是不能购买的。\n\n除此之外，为了防止小朋友们太愉悦，每件玩具都有一个限购件数  $t_i$。也就是说，对于第 $i$ 种玩具，每个小朋友在每一天的购买件数都必须为不超过 $t_i$ 的非负整数。\n\n现在，对于每一天，你想知道：所有小朋友所能获得的最大愉悦度之和（对 $10^8+7$ 取模）；所有小朋友所能获得的最大愉悦度的异或和（异或运算是 $\\operatorname{xor}$ 运算，即 C++/Java/Python 中的 `^` 运算）。\n\n本题强制在线，具体规则在输入描述中体现。", "inputFormat": "从标准输入读入数据。\n\n输入包含多组数据。第一行有一个整数  $T$，表示测试数据的组数，对于每组数据：\n\n第一行输入三个整数 $n,m,Q$ 分别表示玩具数目、小朋友的数目以及天数。\n\n第二行 $n$ 个非负整数，分别描述每件玩具的单价  $c_1,c_2,...,c_n$。\n\n第三行 $n$ 个非负整数，分别描述每件玩具的愉悦度 $v_1,v_2,...,v_n$ 。\n\n第四行 $n$ 个非负整数，分别描述每件玩具的限购次数  $t_1,t_2,...,t_n$。\n\n第五行到第 $Q+4$ 行，每行两个描述区间的参数  $x,y$。第  行和前一天的答案共同描述了第 $i$ 天禁止购买的编号区间，假设前一天的最大愉悦度之和为 $\\operatorname{lastans}$ ，那么当天的 $l_i,r_i$ 满足下式：\n$$l_i=\\min((x+\\operatorname{lastans}-1)\\bmod n+1,(y+\\operatorname{lastans}-1)\\bmod n+1)$$\n$$r_i=\\max((x+\\operatorname{lastans}-1)\\bmod n+1,(y+\\operatorname{lastans}-1)\\bmod n+1)$$\n在第一天时，我们认为 $\\operatorname{lastans}=0$ 。保证  $1\\le x,y\\le n$。", "outputFormat": "输出到标准输出。\n\n对于每一组数据，输出 $Q$ 行，每行 $2$ 个整数，依次表示所有小朋友能够获得的最大愉悦度之和（对 $10^8+7$ 取模）以及异或和。", "hint": "对于所有的数据，$1\\le n,m,Q,c_i,t_i\\le 10^3$，$1\\le v_i\\le 2.5\\times 10^5$，$\\sum n,\\sum m,\\sum Q\\le 10^4$。\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2017] 钦妹的玩具商店", "background": null, "description": "钦妹和弗雷兹在 C 市有一个玩具店，店里有 $n$ 种玩具，编号依次为 $1,2,...,n$，第 $i$ 件玩具的单价为 $c_i$ 元，一个该玩具提供的愉悦度为  $v_i$。\n\n突然有一天，C 市来了 $m$ 个小朋友。据可靠消息，接下来 $Q$ 天，这些小朋友每天都会来店里买东西，其中第 $i$ 个小朋友每天都会带 $i$ 元  （$1\\le i\\le m$）。\n\n由于某些玩具不是很优秀，所以每天都会有不同的玩具被禁止出售给小朋友。具体来说，在第 $i$ 天，编号在区间 $[l_i,r_i]$ 内的物品小朋友是不能购买的。\n\n除此之外，为了防止小朋友们太愉悦，每件玩具都有一个限购件数  $t_i$。也就是说，对于第 $i$ 种玩具，每个小朋友在每一天的购买件数都必须为不超过 $t_i$ 的非负整数。\n\n现在，对于每一天，你想知道：所有小朋友所能获得的最大愉悦度之和（对 $10^8+7$ 取模）；所有小朋友所能获得的最大愉悦度的异或和（异或运算是 $\\operatorname{xor}$ 运算，即 C++/Java/Python 中的 `^` 运算）。\n\n本题强制在线，具体规则在输入描述中体现。", "inputFormat": "从标准输入读入数据。\n\n输入包含多组数据。第一行有一个整数  $T$，表示测试数据的组数，对于每组数据：\n\n第一行输入三个整数 $n,m,Q$ 分别表示玩具数目、小朋友的数目以及天数。\n\n第二行 $n$ 个非负整数，分别描述每件玩具的单价  $c_1,c_2,...,c_n$。\n\n第三行 $n$ 个非负整数，分别描述每件玩具的愉悦度 $v_1,v_2,...,v_n$ 。\n\n第四行 $n$ 个非负整数，分别描述每件玩具的限购次数  $t_1,t_2,...,t_n$。\n\n第五行到第 $Q+4$ 行，每行两个描述区间的参数  $x,y$。第  行和前一天的答案共同描述了第 $i$ 天禁止购买的编号区间，假设前一天的最大愉悦度之和为 $\\operatorname{lastans}$ ，那么当天的 $l_i,r_i$ 满足下式：\n$$l_i=\\min((x+\\operatorname{lastans}-1)\\bmod n+1,(y+\\operatorname{lastans}-1)\\bmod n+1)$$\n$$r_i=\\max((x+\\operatorname{lastans}-1)\\bmod n+1,(y+\\operatorname{lastans}-1)\\bmod n+1)$$\n在第一天时，我们认为 $\\operatorname{lastans}=0$ 。保证  $1\\le x,y\\le n$。", "outputFormat": "输出到标准输出。\n\n对于每一组数据，输出 $Q$ 行，每行 $2$ 个整数，依次表示所有小朋友能够获得的最大愉悦度之和（对 $10^8+7$ 取模）以及异或和。", "hint": "对于所有的数据，$1\\le n,m,Q,c_i,t_i\\le 10^3$，$1\\le v_i\\le 2.5\\times 10^5$，$\\sum n,\\sum m,\\sum Q\\le 10^4$。\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN"}}}
{"pid": "P7433", "type": "P", "difficulty": 7, "samples": [["3 2 3 1\n0 0 0 1\n0 0 0 2\n0 0 0 3", "573"], ["3 2 3 5\n0 0 0 1\n0 0 0 2\n0 0 0 3", "253"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288]}, "tags": ["2017", "快速傅里叶变换 FFT", "快速数论变换 NTT", "THUPC"], "title": "[THUPC 2017] 老司机", "background": "", "description": "四环路上行人稀，常有车神较高低。\n\n如今车道依旧在，不见当年老司机。\n\nB 君心情不好的时候，喜欢去四环路上飙车。看着窗外飞驰而过的景色，B 君想到了过去的 R 君和 G 君；想到了现在的 YJQ 和 FLZ；想到了宇宙之浩渺，时空之无限；也想到了这道题。\n\n输入 $n,X,Y,Z$，保证 $X$ 是 $2$ 的整数次幂，$Y$ 是 $3$ 的整数次幂，$Z$ 是 $5$ 的整数次幂，同时 $1\\le n\\le 1000,1\\le X\\times Y\\times Z\\le2000$。\n\n输入四个长度为 $n$ 的数组 $\\{a_i\\},\\{b_i\\},\\{c_i\\},\\{r_i\\}$（$0\\le a_i,b_i,c_i,r_i\\le10^9$）。\n\n对于 $(u,v,w)$ 求有多少组解 $\\{x_i\\},\\{y_i\\},\\{z_i\\}$。\n\n满足对于所有的 $i$，有 $a_i\\le x_i,b_i\\le y_i,c_i\\le z_i,r_i\\ge x_i-a_i+y_i-b_i+z_i-c_i$。\n\n并且\n$$(\\sum_{i=1}^nx_i)\\bmod X=u$$\n$$(\\sum_{i=1}^ny_i)\\bmod Y=v$$\n$$(\\sum_{i=1}^nz_i)\\bmod Z=w$$\n\n设解的个数为 $F(u,v,w)$。\n\n输出\n$$\\operatorname*{xor}_{0\\le u< X,0\\le v<Y,0\\le w<Z}((uYZ+vZ+w)\\times(F(u,v,w)\\bmod466560001))$$\n", "inputFormat": "输入第一行 $n,X,Y,Z$。\n\n接下来 $n$ 行，第 $i$ 行四个整数 $a_i,b_i,c_i,r_i$。", "outputFormat": "一行一个整数表示答案。", "hint": "#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2017] 老司机", "background": "", "description": "四环路上行人稀，常有车神较高低。\n\n如今车道依旧在，不见当年老司机。\n\nB 君心情不好的时候，喜欢去四环路上飙车。看着窗外飞驰而过的景色，B 君想到了过去的 R 君和 G 君；想到了现在的 YJQ 和 FLZ；想到了宇宙之浩渺，时空之无限；也想到了这道题。\n\n输入 $n,X,Y,Z$，保证 $X$ 是 $2$ 的整数次幂，$Y$ 是 $3$ 的整数次幂，$Z$ 是 $5$ 的整数次幂，同时 $1\\le n\\le 1000,1\\le X\\times Y\\times Z\\le2000$。\n\n输入四个长度为 $n$ 的数组 $\\{a_i\\},\\{b_i\\},\\{c_i\\},\\{r_i\\}$（$0\\le a_i,b_i,c_i,r_i\\le10^9$）。\n\n对于 $(u,v,w)$ 求有多少组解 $\\{x_i\\},\\{y_i\\},\\{z_i\\}$。\n\n满足对于所有的 $i$，有 $a_i\\le x_i,b_i\\le y_i,c_i\\le z_i,r_i\\ge x_i-a_i+y_i-b_i+z_i-c_i$。\n\n并且\n$$(\\sum_{i=1}^nx_i)\\bmod X=u$$\n$$(\\sum_{i=1}^ny_i)\\bmod Y=v$$\n$$(\\sum_{i=1}^nz_i)\\bmod Z=w$$\n\n设解的个数为 $F(u,v,w)$。\n\n输出\n$$\\operatorname*{xor}_{0\\le u< X,0\\le v<Y,0\\le w<Z}((uYZ+vZ+w)\\times(F(u,v,w)\\bmod466560001))$$\n", "inputFormat": "输入第一行 $n,X,Y,Z$。\n\n接下来 $n$ 行，第 $i$ 行四个整数 $a_i,b_i,c_i,r_i$。", "outputFormat": "一行一个整数表示答案。", "hint": "#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN"}}}
{"pid": "P7434", "type": "P", "difficulty": 7, "samples": [["30 10000 20051130\n1 1\n2 1\n3 1\n4 1\n5 1\n6 1\n7 1\n7 1\n9 1\n9 1\n11 1\n11 1\n12 1\n13 1\n13 1\n14 1\n17 1\n18 1\n19 1\n20 1\n21 1\n19 1\n23 1\n22 1\n22 1\n25 1\n25 1\n28 1\n29 1\n1\n1 1 1 1 1 1 1 1", "2 6362"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化"], "title": "「MCOI-04 / AC6-M09」Heavy Command Cruiser", "background": "这是一个作战部署命令。\n\n我们已经从国家安全局获得了有关敌方重型指挥巡洋舰的部分机密情报。\n\n敌方巡航机的正式名称已被确认为 P-1112 Aigaion。\n\n空中舰队中包含一种 Kottos 中型巡航机负责电子支援，还有一种 Gyges 中型巡航机负责近程防空。\n\nAigaion，作为指挥机，负责一切与巡航导弹相关的事务。\n\n在获得这些情报之后，我们可以草拟一个摧毁 Aigaion 的计划。\n\n仔细听好了。\n\nAigaion 只能在机体前部接受空中加油。\n\n多架加油机必须同时处在 Aigaion 前方才能进行加油作业。\n\n当加油机在 Aigaion 前部进行加油时，Aigaion 的雷达探测能力会暂时削弱。\n\n这里就是关键点了。\n\nAigaion 在进行加油时，其雷达基本完全无法探测在其前方飞行的物体。\n\n如果你们能维持在一个固定航线并在一个特定高度上飞行，你们就能在不被敌军发现的情况下，从空中接近 Aigaion。\n\n所以我们解决掉这只怪物的最佳时机就是它进行空中加油的时候。\n\nAigaion 的预定航线图也包含在这份情报中。\n\n简报结束后，我们将在机库再次检查航线图。\n\n快去准备吧。\n\n…………\n\nGaruda 队，交战！\n\n$$_{{\\frac{\\large\\text{ACE COMBAT }\\Large6}{\\tiny{\\text{F i r e s\\quad O f\\quad L i b e r a t i o n}}}}}\\\\ \\text{Mission 09} \\\\\\Large\\text{Heavy Command Cruiser}\\\\\\tiny -\\ The\\ Dead\\ Sea\\ -$$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0xt87jqh.png)", "description": "在平面上给定一棵有根树，树根为 $1$，根的深度为 $0$。\n\n对于深度为 $x$ 的节点，其 **纵坐标** 为 $n-x+1$。\n\n对于一个节点的所有子节点，**从左到右按照编号升序排列**。每条边都是一条 **连接两个点的线段**。\n\n每一个叶子节点都有一条 **平行于 $y$ 轴且向 $y$ 轴负方向无限延伸的射线**，根节点有一条 **平行于 $y$ 轴且向 $y$ 轴正方向无限延伸的射线**。\n\n每个线段或射线带一个权值。\n\n**任意两条线段或射线只在树的节点处相交。**\n\n如果你不理解这个树是怎么画的，可以阅读样例 1 解释。\n\n给定 $q$ 组 $u,v$，你现在要从点 $u$ 开始在平面上自由移动，但是你不能经过除 $u,v$ 以外的任何一个点，且每经过一条线段或射线就会产生其对应的权值的代价。\n\n你的目标是移动到点 $v$，你需要求出移动过程产生的最小代价。", "inputFormat": "由于直接输入会造成巨大的输入量，所以本题采用特殊的输入方式。\n\n给定如下随机数生成器：\n\n```cpp\nnamespace GenHelper\n{\n    unsigned z1,z2,z3,z4,b;\n    unsigned rand_()\n    {\n    b=((z1<<6)^z1)>>13;\n    z1=((z1&4294967294U)<<18)^b;\n    b=((z2<<2)^z2)>>27;\n    z2=((z2&4294967288U)<<2)^b;\n    b=((z3<<13)^z3)>>21;\n    z3=((z3&4294967280U)<<7)^b;\n    b=((z4<<3)^z4)>>12;\n    z4=((z4&4294967168U)<<13)^b;\n    return (z1^z2^z3^z4);\n    }\n}\nvoid srand(unsigned x)\n{using namespace GenHelper;\nz1=x; z2=(~x)^0x233333333U; z3=x^0x1234598766U; z4=(~x)+51;}\nint read()\n{\n    using namespace GenHelper;\n    int a=rand_()&32767;\n    int b=rand_()&32767;\n    return a*32768+b;\n}\n```\n\n第一行三个整数 $n,q,s$。\n\n接下来 $n-1$ 行，每行两个整数，分别表示这个节点在树上的父亲 $f_i$ 和其到父亲的边的权值 $w_i$。\n\n接下来一个整数 $w_1$，表示节点 $1$ 向上的射线的权值。\n\n接下来一行若干个空格分隔的整数 $d_u$，按照 **叶子节点编号从小到大（注意不是在树上从左到右）** 的顺序给出所有叶子节点向下的射线的权值。\n\n接下来，对于每一组询问，设上一次询问的答案为 $\\text{lastans}$，如果这是第一次询问，则 $\\text{lastans}=0$。你需要先调用一次 $(\\text{read}()\\oplus \\text{lastans})\\bmod n+1$ 得到询问的 $u$，再调用一次 $(\\text{read}()\\oplus \\text{lastans})\\bmod n+1$ 得到询问的 $v$。其中 $\\oplus$ 表示异或运算。\n\n", "outputFormat": "输出两个空格分隔的整数，分别表示所有答案的异或和和所有答案的和。", "hint": "idea：Sol1，solution：dengyaotriangle & Sol1 & Guoyh，code：Sol1，data：Sol1\n\n对于 $100\\%$ 的数据，满足 $1\\leq n\\leq 5\\times 10^5$，$1\\leq q\\leq 5\\times 10^6$，$1\\leq f_i<i$，$1\\leq w_i,w_1,d_{u}\\leq 2\\times 10^3$，$0\\leq s\\leq10^9$。\n\n---\n\n「魂归大海……」\n\n「你可以休息了……」\n\n「安息吧。」", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-04 / AC6-M09」Heavy Command Cruiser", "background": "这是一个作战部署命令。\n\n我们已经从国家安全局获得了有关敌方重型指挥巡洋舰的部分机密情报。\n\n敌方巡航机的正式名称已被确认为 P-1112 Aigaion。\n\n空中舰队中包含一种 Kottos 中型巡航机负责电子支援，还有一种 Gyges 中型巡航机负责近程防空。\n\nAigaion，作为指挥机，负责一切与巡航导弹相关的事务。\n\n在获得这些情报之后，我们可以草拟一个摧毁 Aigaion 的计划。\n\n仔细听好了。\n\nAigaion 只能在机体前部接受空中加油。\n\n多架加油机必须同时处在 Aigaion 前方才能进行加油作业。\n\n当加油机在 Aigaion 前部进行加油时，Aigaion 的雷达探测能力会暂时削弱。\n\n这里就是关键点了。\n\nAigaion 在进行加油时，其雷达基本完全无法探测在其前方飞行的物体。\n\n如果你们能维持在一个固定航线并在一个特定高度上飞行，你们就能在不被敌军发现的情况下，从空中接近 Aigaion。\n\n所以我们解决掉这只怪物的最佳时机就是它进行空中加油的时候。\n\nAigaion 的预定航线图也包含在这份情报中。\n\n简报结束后，我们将在机库再次检查航线图。\n\n快去准备吧。\n\n…………\n\nGaruda 队，交战！\n\n$$_{{\\frac{\\large\\text{ACE COMBAT }\\Large6}{\\tiny{\\text{F i r e s\\quad O f\\quad L i b e r a t i o n}}}}}\\\\ \\text{Mission 09} \\\\\\Large\\text{Heavy Command Cruiser}\\\\\\tiny -\\ The\\ Dead\\ Sea\\ -$$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0xt87jqh.png)", "description": "在平面上给定一棵有根树，树根为 $1$，根的深度为 $0$。\n\n对于深度为 $x$ 的节点，其 **纵坐标** 为 $n-x+1$。\n\n对于一个节点的所有子节点，**从左到右按照编号升序排列**。每条边都是一条 **连接两个点的线段**。\n\n每一个叶子节点都有一条 **平行于 $y$ 轴且向 $y$ 轴负方向无限延伸的射线**，根节点有一条 **平行于 $y$ 轴且向 $y$ 轴正方向无限延伸的射线**。\n\n每个线段或射线带一个权值。\n\n**任意两条线段或射线只在树的节点处相交。**\n\n如果你不理解这个树是怎么画的，可以阅读样例 1 解释。\n\n给定 $q$ 组 $u,v$，你现在要从点 $u$ 开始在平面上自由移动，但是你不能经过除 $u,v$ 以外的任何一个点，且每经过一条线段或射线就会产生其对应的权值的代价。\n\n你的目标是移动到点 $v$，你需要求出移动过程产生的最小代价。", "inputFormat": "由于直接输入会造成巨大的输入量，所以本题采用特殊的输入方式。\n\n给定如下随机数生成器：\n\n```cpp\nnamespace GenHelper\n{\n    unsigned z1,z2,z3,z4,b;\n    unsigned rand_()\n    {\n    b=((z1<<6)^z1)>>13;\n    z1=((z1&4294967294U)<<18)^b;\n    b=((z2<<2)^z2)>>27;\n    z2=((z2&4294967288U)<<2)^b;\n    b=((z3<<13)^z3)>>21;\n    z3=((z3&4294967280U)<<7)^b;\n    b=((z4<<3)^z4)>>12;\n    z4=((z4&4294967168U)<<13)^b;\n    return (z1^z2^z3^z4);\n    }\n}\nvoid srand(unsigned x)\n{using namespace GenHelper;\nz1=x; z2=(~x)^0x233333333U; z3=x^0x1234598766U; z4=(~x)+51;}\nint read()\n{\n    using namespace GenHelper;\n    int a=rand_()&32767;\n    int b=rand_()&32767;\n    return a*32768+b;\n}\n```\n\n第一行三个整数 $n,q,s$。\n\n接下来 $n-1$ 行，每行两个整数，分别表示这个节点在树上的父亲 $f_i$ 和其到父亲的边的权值 $w_i$。\n\n接下来一个整数 $w_1$，表示节点 $1$ 向上的射线的权值。\n\n接下来一行若干个空格分隔的整数 $d_u$，按照 **叶子节点编号从小到大（注意不是在树上从左到右）** 的顺序给出所有叶子节点向下的射线的权值。\n\n接下来，对于每一组询问，设上一次询问的答案为 $\\text{lastans}$，如果这是第一次询问，则 $\\text{lastans}=0$。你需要先调用一次 $(\\text{read}()\\oplus \\text{lastans})\\bmod n+1$ 得到询问的 $u$，再调用一次 $(\\text{read}()\\oplus \\text{lastans})\\bmod n+1$ 得到询问的 $v$。其中 $\\oplus$ 表示异或运算。\n\n", "outputFormat": "输出两个空格分隔的整数，分别表示所有答案的异或和和所有答案的和。", "hint": "idea：Sol1，solution：dengyaotriangle & Sol1 & Guoyh，code：Sol1，data：Sol1\n\n对于 $100\\%$ 的数据，满足 $1\\leq n\\leq 5\\times 10^5$，$1\\leq q\\leq 5\\times 10^6$，$1\\leq f_i<i$，$1\\leq w_i,w_1,d_{u}\\leq 2\\times 10^3$，$0\\leq s\\leq10^9$。\n\n---\n\n「魂归大海……」\n\n「你可以休息了……」\n\n「安息吧。」", "locale": "zh-CN"}}}
{"pid": "P7435", "type": "P", "difficulty": 6, "samples": [["3 3", "1 5 15 18"]], "limits": {"time": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "数学", "O2优化", "动态规划优化", "组合数学", "排列组合", "Stirling 数", "生成函数", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "简单的排列计数", "background": "", "description": "设 $\\text{inv}_{\\pi}$ 表示排列 $\\pi$ 的逆序对数。如果 $\\pi$ 长度为 $n$ 则有\n\n$$\\text{inv}_{\\pi}=\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=i+1}^{n}[\\pi_i>\\pi_j]$$\n\n给定两个正整数 $n,k$，和一个排列 $\\pi^\\prime$，定义一个长度为 $n$ 的排列 $\\pi$ 的权值 $\\text{val}_{\\pi}$ 为\n\n$$\\text{val}_{\\pi}=\\prod\\limits_{i=1}^{n}\\prod_{j=i+1}^{n}\\pi_i^{[\\pi_{i}>\\pi_j]}$$\n\n对于 $0\\leq m\\leq k$ 求\n\n$$\\sum\\limits_{\\pi}[\\text{inv}_\\pi=m]\\text{val}_\\pi$$\n\n其中 $\\pi$ 是长度为 $n$ 的排列。", "inputFormat": "第一行两个整数 $n,k$。", "outputFormat": "一行 $k+1$ 个整数，表示答案对 $998244353$ 取模的值。", "hint": "### 样例解释 1\n\n$$\\text{inv}_{(1,2,3)}=0,\\text{inv}_{(1,3,2)}=1,\\text{inv}_{(2,1,3)}=1,\\text{inv}_{(2,3,1)}=2,\\text{inv}_{(3,1,2)}=2,\\text{inv}_{(3,2,1)}=3$$\n\n$$\\text{val}_{(1,2,3)}=1,\\text{val}_{(1,3,2)}=3,\\text{val}_{(2,1,3)}=2,\\text{val}_{(2,3,1)}=6,\\text{val}_{(3,1,2)}=9,\\text{val}_{(3,2,1)}=18$$\n\n所以当 $m=0$ 时答案为 $1$，$m=1$ 时为 $5$， $m=2$ 时为 $15$，$m=3$ 时为 $18$。\n\n### 数据范围\n\n| 子任务编号 | 分值 | $n\\leq $ | $k\\leq $ |\n| :----------: | :----------: | :----------: | :----------: |\n| Subtask 1 | $1$ | $6$ |  |\n| Subtask 2 | $12$ | $40$ |  |\n| Subtask 3 | $1$ | $998244352$ | $1$ |\n| Subtask 4 | $16$ | $998244352$ | $10$ |\n| Subtask 5 | $24$ | $2\\times 10^5$ |  |\n| Subtask 6 | $46$ | $998244352$ |  |\n\n对于 $100\\%$ 的数据，$2\\leq n\\leq 998244352$，$1\\leq k\\leq \\min(2\\times 10^5,\\frac{n(n-1)}{2})。$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "简单的排列计数", "background": "", "description": "设 $\\text{inv}_{\\pi}$ 表示排列 $\\pi$ 的逆序对数。如果 $\\pi$ 长度为 $n$ 则有\n\n$$\\text{inv}_{\\pi}=\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=i+1}^{n}[\\pi_i>\\pi_j]$$\n\n给定两个正整数 $n,k$，和一个排列 $\\pi^\\prime$，定义一个长度为 $n$ 的排列 $\\pi$ 的权值 $\\text{val}_{\\pi}$ 为\n\n$$\\text{val}_{\\pi}=\\prod\\limits_{i=1}^{n}\\prod_{j=i+1}^{n}\\pi_i^{[\\pi_{i}>\\pi_j]}$$\n\n对于 $0\\leq m\\leq k$ 求\n\n$$\\sum\\limits_{\\pi}[\\text{inv}_\\pi=m]\\text{val}_\\pi$$\n\n其中 $\\pi$ 是长度为 $n$ 的排列。", "inputFormat": "第一行两个整数 $n,k$。", "outputFormat": "一行 $k+1$ 个整数，表示答案对 $998244353$ 取模的值。", "hint": "### 样例解释 1\n\n$$\\text{inv}_{(1,2,3)}=0,\\text{inv}_{(1,3,2)}=1,\\text{inv}_{(2,1,3)}=1,\\text{inv}_{(2,3,1)}=2,\\text{inv}_{(3,1,2)}=2,\\text{inv}_{(3,2,1)}=3$$\n\n$$\\text{val}_{(1,2,3)}=1,\\text{val}_{(1,3,2)}=3,\\text{val}_{(2,1,3)}=2,\\text{val}_{(2,3,1)}=6,\\text{val}_{(3,1,2)}=9,\\text{val}_{(3,2,1)}=18$$\n\n所以当 $m=0$ 时答案为 $1$，$m=1$ 时为 $5$， $m=2$ 时为 $15$，$m=3$ 时为 $18$。\n\n### 数据范围\n\n| 子任务编号 | 分值 | $n\\leq $ | $k\\leq $ |\n| :----------: | :----------: | :----------: | :----------: |\n| Subtask 1 | $1$ | $6$ |  |\n| Subtask 2 | $12$ | $40$ |  |\n| Subtask 3 | $1$ | $998244352$ | $1$ |\n| Subtask 4 | $16$ | $998244352$ | $10$ |\n| Subtask 5 | $24$ | $2\\times 10^5$ |  |\n| Subtask 6 | $46$ | $998244352$ |  |\n\n对于 $100\\%$ 的数据，$2\\leq n\\leq 998244352$，$1\\leq k\\leq \\min(2\\times 10^5,\\frac{n(n-1)}{2})。$", "locale": "zh-CN"}}}
{"pid": "P7436", "type": "P", "difficulty": 0, "samples": [["3 3 4 4\n1 1\n2 2\n3 3\n2 3", "5"], ["3 3 4 10000\n1 1\n2 2\n3 3\n2 3", "8"]], "limits": {"time": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["O2优化"], "title": "画矩形", "background": "扇贝宫主是一个初三的菜鸡，不擅长出毒瘤题。这天，Ta随手 A 了中国象棋这题，忽然灵光乍现...", "description": "扇贝宫主画了一个 $n \\times m$ 的矩形网格图。具体来说，包含坐标 $(x,y)$（$x\\in [0,n], y\\in [0,m]$）的所有整点以及所有连接距离为 $1$ 的点的边。\n\n这时，扇贝宫主突发奇想，想知道这个矩形里面能够绘制多少个周长不大于 $k$ 的矩形（矩形的四边必须平行于坐标轴）。但这即使作为签到题也未免太简单了些，于是扇贝宫主加入了 $q$ 个障碍点，要求选取的矩形**不包含**障碍点。每个障碍点都是一个 $1\\times 1$ 的正方形。现在扇贝宫主要继续出其他签（毒）到（瘤）题了，你能帮忙解决此题吗？答案对 $998244353$ 取模。", "inputFormat": "第 $1$ 行包含四个正整数 $n$，$m$，$q$ 和 $k$。\n\n接下来 $q$ 行，第 $i$ 行包含 $2$ 个数，分别为障碍物的 $x$ 坐标与 $y$ 坐标（一个坐标为 $(x,y)$ 的障碍点四个顶点为 $(x-1,y-1),(x-1,y),(x,y-1),(x,y)$）。", "outputFormat": "输出共一行一个整数，即矩形个数对 $998244353$ 取模的结果。", "hint": "#### 【样例解释】\n\n样例 #1：除了 $4$ 个障碍物格子之外剩下的格子都是合法的矩形。因此答案为 $3\\times 3-4=5$。\n\n样例 #2：即统计合法的矩形个数。$1\\times 1$ 的矩形有 $5$ 个，$1\\times 2$ 和 $2\\times 1$ 的矩形共 $3$ 个，因此答案为 $5+3=8$。\n\n#### 【数据范围】\n\n| 编号 | $n,m$ | $k$ | $q$ |\n| :----------: | :----------: | :----------: | :----------: |\n| $1,2$ | $\\le 10^3$ | $\\le 1.5\\times 10^9$ | $=0$ |\n| $3,4,5,6$ | $\\le 1.5\\times 10^9$ | $\\le 1.5\\times 10^9$ | $=0$ |\n| $7,8$ | $\\le 20$ | $\\le 1.5\\times 10^9$ | $\\le 20$ |\n| $9,10$ | $\\le 1.5\\times 10^9$ | $\\le 20$ | $\\le 20$ |\n| $11,12,13,14$ | $\\le 1.5\\times 10^9$ | $\\le 10^5$ | $\\le 20$ |\n| $15,16,17,18,19,20$ | $\\le 1.5\\times 10^9$ | $\\le 1.5\\times 10^9$ | $\\le 20$ |\n\n对于 $100\\%$ 的数据，$1\\le n,m \\le 1.5\\times 10^9$，$4\\le k \\le 1.5\\times 10^9$，$0\\le q \\le 20$。保证输入的障碍物合法且两两不同。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "画矩形", "background": "扇贝宫主是一个初三的菜鸡，不擅长出毒瘤题。这天，Ta随手 A 了中国象棋这题，忽然灵光乍现...", "description": "扇贝宫主画了一个 $n \\times m$ 的矩形网格图。具体来说，包含坐标 $(x,y)$（$x\\in [0,n], y\\in [0,m]$）的所有整点以及所有连接距离为 $1$ 的点的边。\n\n这时，扇贝宫主突发奇想，想知道这个矩形里面能够绘制多少个周长不大于 $k$ 的矩形（矩形的四边必须平行于坐标轴）。但这即使作为签到题也未免太简单了些，于是扇贝宫主加入了 $q$ 个障碍点，要求选取的矩形**不包含**障碍点。每个障碍点都是一个 $1\\times 1$ 的正方形。现在扇贝宫主要继续出其他签（毒）到（瘤）题了，你能帮忙解决此题吗？答案对 $998244353$ 取模。", "inputFormat": "第 $1$ 行包含四个正整数 $n$，$m$，$q$ 和 $k$。\n\n接下来 $q$ 行，第 $i$ 行包含 $2$ 个数，分别为障碍物的 $x$ 坐标与 $y$ 坐标（一个坐标为 $(x,y)$ 的障碍点四个顶点为 $(x-1,y-1),(x-1,y),(x,y-1),(x,y)$）。", "outputFormat": "输出共一行一个整数，即矩形个数对 $998244353$ 取模的结果。", "hint": "#### 【样例解释】\n\n样例 #1：除了 $4$ 个障碍物格子之外剩下的格子都是合法的矩形。因此答案为 $3\\times 3-4=5$。\n\n样例 #2：即统计合法的矩形个数。$1\\times 1$ 的矩形有 $5$ 个，$1\\times 2$ 和 $2\\times 1$ 的矩形共 $3$ 个，因此答案为 $5+3=8$。\n\n#### 【数据范围】\n\n| 编号 | $n,m$ | $k$ | $q$ |\n| :----------: | :----------: | :----------: | :----------: |\n| $1,2$ | $\\le 10^3$ | $\\le 1.5\\times 10^9$ | $=0$ |\n| $3,4,5,6$ | $\\le 1.5\\times 10^9$ | $\\le 1.5\\times 10^9$ | $=0$ |\n| $7,8$ | $\\le 20$ | $\\le 1.5\\times 10^9$ | $\\le 20$ |\n| $9,10$ | $\\le 1.5\\times 10^9$ | $\\le 20$ | $\\le 20$ |\n| $11,12,13,14$ | $\\le 1.5\\times 10^9$ | $\\le 10^5$ | $\\le 20$ |\n| $15,16,17,18,19,20$ | $\\le 1.5\\times 10^9$ | $\\le 1.5\\times 10^9$ | $\\le 20$ |\n\n对于 $100\\%$ 的数据，$1\\le n,m \\le 1.5\\times 10^9$，$4\\le k \\le 1.5\\times 10^9$，$0\\le q \\le 20$。保证输入的障碍物合法且两两不同。", "locale": "zh-CN"}}}
{"pid": "P7437", "type": "P", "difficulty": 6, "samples": [["4 5 2\n1 2\n1 3\n2 3\n2 4\n3 4", "374341633"], ["6 8 4\n1 2\n1 3\n2 3\n2 4\n2 5\n4 5\n4 6\n5 6", "374341633"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "生成树", "线性代数", "高斯消元", "状压 DP"], "title": "既见君子", "background": "友情客串：wygz（无忧公主）\n\nwygz 每次从进校到机房，都要尽量避开“屠夫”老师。然而，有一天，她忽然发现一些门上居然贴了“请勿从此门进出”的标签！", "description": "校园可以抽象成一张 $n$ 个点 $m$ 条无向边（可能有重边，无自环）的**连通**无向图，点从 $1$ 标号到 $n$。校门在 $1$ 号点，而机房在 $n$ 号点，屠老师的办公室在点 $z$（$z\\ne 1,n$）。\n\n然而，工作人员（~~其实是樱初音~~）封锁了其中的 $m-n+1$ 条边，使得剩余的图（包括所有点以及剩余的边）仍然连通，此时任意两点之间有且仅有一条简单路径。工作人员会**等概率地**选择一种封锁方案。（若 $m=n-1$ 则不封锁任何边，保持不变）\n\nwygz 当然不希望屠老师的办公室出现在她的必经之路上。她希望你算出从校门到机房的路径**必须**经过屠老师的办公室的概率。答案对 $998244353$ 取模。", "inputFormat": "第一行三个正整数 $n$、$m$ 和 $z$，表示点数、边数和屠老师的办公室的位置。\n\n以下 $m$ 行，每行两个正整数 $u$、$v$，表示一条连接 $u$ 和 $v$ 的无向边。", "outputFormat": "一行一个非负整数，表示答案对 $998244353$ 取模的结果。", "hint": "#### 样例解释：\n样例 #1：生成树共 $8$ 个，有 $5$ 个满足 $1$ 到 $4$ 经过 $2$。$\\dfrac 5 8\\equiv 374341633\\pmod {998244353}$。\n\n样例 #2：生成树共 $24$ 个，有 $15$ 个满足 $1$ 到 $6$ 经过 $4$。$\\dfrac {15} {24}\\equiv 374341633\\pmod {998244353}$。\n\n#### 数据范围：\n\n| 数据点编号 | $n$ | $m$ |\n| :----------: | :----------: | :----------: |\n| $1$ | $=3$ | $\\le 5$ |\n| $2$ | $=3$ | $\\le 10^5$ |\n| $3,4$ | $=7$ | $\\le 15$ |\n| $5,6$ | $=7$ | $\\le 10^5$ |\n| $7$ | $=20$ | $=n-1$ |\n| $8,9$ | $=20$ | $=n$ |\n| $10,11,12$ | $=18$ | $\\le 10^5$ |\n| $13,14,15,16$ | $=19$ | $\\le 10^5$ |\n| $17,18,19,20$ | $=20$ | $\\le 10^5$ |\n\n对 $100\\%$ 的数据，$3\\le n\\le 20$，$n-1\\le m\\le 10^5$，$z\\ne 1$ 且 $z\\ne n$。\n\n**数据保证输入的图的生成树个数模 $998244353$ 非零。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "既见君子", "background": "友情客串：wygz（无忧公主）\n\nwygz 每次从进校到机房，都要尽量避开“屠夫”老师。然而，有一天，她忽然发现一些门上居然贴了“请勿从此门进出”的标签！", "description": "校园可以抽象成一张 $n$ 个点 $m$ 条无向边（可能有重边，无自环）的**连通**无向图，点从 $1$ 标号到 $n$。校门在 $1$ 号点，而机房在 $n$ 号点，屠老师的办公室在点 $z$（$z\\ne 1,n$）。\n\n然而，工作人员（~~其实是樱初音~~）封锁了其中的 $m-n+1$ 条边，使得剩余的图（包括所有点以及剩余的边）仍然连通，此时任意两点之间有且仅有一条简单路径。工作人员会**等概率地**选择一种封锁方案。（若 $m=n-1$ 则不封锁任何边，保持不变）\n\nwygz 当然不希望屠老师的办公室出现在她的必经之路上。她希望你算出从校门到机房的路径**必须**经过屠老师的办公室的概率。答案对 $998244353$ 取模。", "inputFormat": "第一行三个正整数 $n$、$m$ 和 $z$，表示点数、边数和屠老师的办公室的位置。\n\n以下 $m$ 行，每行两个正整数 $u$、$v$，表示一条连接 $u$ 和 $v$ 的无向边。", "outputFormat": "一行一个非负整数，表示答案对 $998244353$ 取模的结果。", "hint": "#### 样例解释：\n样例 #1：生成树共 $8$ 个，有 $5$ 个满足 $1$ 到 $4$ 经过 $2$。$\\dfrac 5 8\\equiv 374341633\\pmod {998244353}$。\n\n样例 #2：生成树共 $24$ 个，有 $15$ 个满足 $1$ 到 $6$ 经过 $4$。$\\dfrac {15} {24}\\equiv 374341633\\pmod {998244353}$。\n\n#### 数据范围：\n\n| 数据点编号 | $n$ | $m$ |\n| :----------: | :----------: | :----------: |\n| $1$ | $=3$ | $\\le 5$ |\n| $2$ | $=3$ | $\\le 10^5$ |\n| $3,4$ | $=7$ | $\\le 15$ |\n| $5,6$ | $=7$ | $\\le 10^5$ |\n| $7$ | $=20$ | $=n-1$ |\n| $8,9$ | $=20$ | $=n$ |\n| $10,11,12$ | $=18$ | $\\le 10^5$ |\n| $13,14,15,16$ | $=19$ | $\\le 10^5$ |\n| $17,18,19,20$ | $=20$ | $\\le 10^5$ |\n\n对 $100\\%$ 的数据，$3\\le n\\le 20$，$n-1\\le m\\le 10^5$，$z\\ne 1$ 且 $z\\ne n$。\n\n**数据保证输入的图的生成树个数模 $998244353$ 非零。**", "locale": "zh-CN"}}}
{"pid": "P7438", "type": "P", "difficulty": 7, "samples": [["3 2\n0 1", "0 1 2"], ["6 4\n11 43 27 7", "0 88 176 1311 7332 53070"]], "limits": {"time": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "数学", "递推", "O2优化", "置换", "组合数学", "排列组合", "前缀和", "二项式定理", "生成函数", "线性递推", "微积分", "导数", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "更简单的排列计数", "background": "", "description": "设 $\\text{cyc}_\\pi$ 将长为 $n$ 的排列 $\\pi$ 当成置换时所能分解成的循环个数。给定两个整数 $n,k$ 和一个 $k-1$ 次多项式，对 $1\\leq m\\leq n$ 求：\n\n$$\n\\sum\\limits_{\\pi}F(\\text{cyc}_{\\pi})\n$$\n\n其中 $\\pi$ 是长度为 $m$ 且不存在位置 $i$ 使得 $\\pi_i=i$ 的排列。", "inputFormat": "第一行两个整数，表示 $n$ 和 $k$。\n\n第二行 $k$ 个整数，从低到高给出多项式的系数。", "outputFormat": "一行 $n$ 个整数，表示答案对 $998244353$ 取模的值。", "hint": "### 样例解释 1\n\n下面是当 $m=1,2,3$ 时满足要求的所有排列：\n\n$\\text{cyc}_{(2,1)}=1,\\text{cyc}_{(2,3,1)}=1,\\text{cyc}_{(3,1,2)}=1$。\n所以当 $m=1$ 时答案为 $0$，$m=2$ 时为 $1$，$m=3$ 时为 $2$。\n\n### 数据范围\n\n| 子任务编号 | 分值 | $n\\leq$ | $k\\leq$ | 其他限制 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| Subtask 1 | $1$ | $10$ | $6$ |  |\n| Subtask 2 | $5$ | $2\\times 10^3$ | $6$ |  |\n| Subtask 3 | $6$ | $2\\times 10^5$ | $1$ |  |\n| Subtask 4 | $16$ | $2\\times 10^5$ | $6$ | $F(x)=x^k$ |\n| Subtask 5 | $16$ | $2\\times 10^5$ | $3$ |  |\n| Subtask 6 | $56$ | $6\\times 10^5$ | $100$ |  |\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 6\\times 10^5$，$1\\leq k\\leq 100$，$0\\leq [x^k]F(x)\\leq 998244352$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "更简单的排列计数", "background": "", "description": "设 $\\text{cyc}_\\pi$ 将长为 $n$ 的排列 $\\pi$ 当成置换时所能分解成的循环个数。给定两个整数 $n,k$ 和一个 $k-1$ 次多项式，对 $1\\leq m\\leq n$ 求：\n\n$$\n\\sum\\limits_{\\pi}F(\\text{cyc}_{\\pi})\n$$\n\n其中 $\\pi$ 是长度为 $m$ 且不存在位置 $i$ 使得 $\\pi_i=i$ 的排列。", "inputFormat": "第一行两个整数，表示 $n$ 和 $k$。\n\n第二行 $k$ 个整数，从低到高给出多项式的系数。", "outputFormat": "一行 $n$ 个整数，表示答案对 $998244353$ 取模的值。", "hint": "### 样例解释 1\n\n下面是当 $m=1,2,3$ 时满足要求的所有排列：\n\n$\\text{cyc}_{(2,1)}=1,\\text{cyc}_{(2,3,1)}=1,\\text{cyc}_{(3,1,2)}=1$。\n所以当 $m=1$ 时答案为 $0$，$m=2$ 时为 $1$，$m=3$ 时为 $2$。\n\n### 数据范围\n\n| 子任务编号 | 分值 | $n\\leq$ | $k\\leq$ | 其他限制 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| Subtask 1 | $1$ | $10$ | $6$ |  |\n| Subtask 2 | $5$ | $2\\times 10^3$ | $6$ |  |\n| Subtask 3 | $6$ | $2\\times 10^5$ | $1$ |  |\n| Subtask 4 | $16$ | $2\\times 10^5$ | $6$ | $F(x)=x^k$ |\n| Subtask 5 | $16$ | $2\\times 10^5$ | $3$ |  |\n| Subtask 6 | $56$ | $6\\times 10^5$ | $100$ |  |\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 6\\times 10^5$，$1\\leq k\\leq 100$，$0\\leq [x^k]F(x)\\leq 998244352$。", "locale": "zh-CN"}}}
{"pid": "P7439", "type": "P", "difficulty": 7, "samples": [["3 2\n0 1", "2"], ["6 4\n11 43 27 7", "53070"], ["6 4\n9 72 22 7", "60990"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "数学", "递推", "O2优化", "置换", "组合数学", "排列组合", "二项式定理", "生成函数", "微积分", "导数", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "「KrOI2021」Feux Follets 弱化版", "background": "", "description": "设 $\\text{cyc}_\\pi$ 将长为 $n$ 的排列 $\\pi$ 当成置换时所能分解成的循环个数。给定两个整数 $n,k$ 和一个 $k-1$ 次多项式，求：\n\n$$\n\\sum\\limits_{\\pi}F(\\text{cyc}_{\\pi})\n$$\n\n其中 $\\pi$ 是长度为 $n$ 且不存在位置 $i$ 使得 $\\pi_i=i$ 的排列。", "inputFormat": "第一行两个整数，表示 $n$ 和 $k$。\n\n第二行 $k$ 个整数，从低到高给出多项式的系数。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模的值。", "hint": "### 数据范围\n\n对于 $100\\%$ 的数据，$1\\leq n,k\\leq 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「KrOI2021」Feux Follets 弱化版", "background": "", "description": "设 $\\text{cyc}_\\pi$ 将长为 $n$ 的排列 $\\pi$ 当成置换时所能分解成的循环个数。给定两个整数 $n,k$ 和一个 $k-1$ 次多项式，求：\n\n$$\n\\sum\\limits_{\\pi}F(\\text{cyc}_{\\pi})\n$$\n\n其中 $\\pi$ 是长度为 $n$ 且不存在位置 $i$ 使得 $\\pi_i=i$ 的排列。", "inputFormat": "第一行两个整数，表示 $n$ 和 $k$。\n\n第二行 $k$ 个整数，从低到高给出多项式的系数。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模的值。", "hint": "### 数据范围\n\n对于 $100\\%$ 的数据，$1\\leq n,k\\leq 10^5$。", "locale": "zh-CN"}}}
{"pid": "P7440", "type": "P", "difficulty": 7, "samples": [["3 2\n0 1", "0 1 2"], ["6 4\n11 43 27 7", "0 88 176 1311 7332 53070"], ["6 4\n9 72 22 7", "0 110 220 1551 8580 60990"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "数学", "递推", "矩阵运算", "O2优化", "矩阵加速", "置换", "组合数学", "排列组合", "生成函数", "线性代数", "矩阵乘法", "线性递推", "微积分", "导数", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "「KrOI2021」Feux Follets", "background": "Note：$\\sigma(5307)=7440$，且在所有满足 $\\sigma(x)=7440$ 的 $x$ 中这是唯一一个模 10 余 7 的数。", "description": "设 $\\text{cyc}_\\pi$ 将长为 $n$ 的排列 $\\pi$ 当成置换时所能分解成的循环个数。给定两个整数 $n,k$ 和一个 $k-1$ 次多项式，对 $1\\leq m\\leq n$ 求：\n\n$$\n\\sum\\limits_{\\pi}F(\\text{cyc}_{\\pi})\n$$\n\n其中 $\\pi$ 是长度为 $m$ 且不存在位置 $i$ 使得 $\\pi_i=i$ 的排列。", "inputFormat": "第一行两个整数，表示 $n$ 和 $k$。\n\n第二行 $k$ 个整数，从低到高给出多项式的系数。", "outputFormat": "一行 $n$ 个整数，表示答案对 $998244353$ 取模的值。", "hint": "### 数据范围\n\n对于 $100\\%$ 的数据，$1\\leq n,k\\leq 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「KrOI2021」Feux Follets", "background": "Note：$\\sigma(5307)=7440$，且在所有满足 $\\sigma(x)=7440$ 的 $x$ 中这是唯一一个模 10 余 7 的数。", "description": "设 $\\text{cyc}_\\pi$ 将长为 $n$ 的排列 $\\pi$ 当成置换时所能分解成的循环个数。给定两个整数 $n,k$ 和一个 $k-1$ 次多项式，对 $1\\leq m\\leq n$ 求：\n\n$$\n\\sum\\limits_{\\pi}F(\\text{cyc}_{\\pi})\n$$\n\n其中 $\\pi$ 是长度为 $m$ 且不存在位置 $i$ 使得 $\\pi_i=i$ 的排列。", "inputFormat": "第一行两个整数，表示 $n$ 和 $k$。\n\n第二行 $k$ 个整数，从低到高给出多项式的系数。", "outputFormat": "一行 $n$ 个整数，表示答案对 $998244353$ 取模的值。", "hint": "### 数据范围\n\n对于 $100\\%$ 的数据，$1\\leq n,k\\leq 10^5$。", "locale": "zh-CN"}}}
{"pid": "P7441", "type": "P", "difficulty": 2, "samples": [["2\n2 3 10\n2 4 11", "3\n2"], ["1\n0 0 1", "0"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "O2优化", "二分图", "洛谷月赛"], "title": "「EZEC-7」Erinnerung", "background": "", "description": "小 Y 和小 Z 都是生活在 Arcaea Offline 的精灵。小 Y 有无数片落叶，其中第 $i$ 片落叶的价值为 $C_i$。小 Z 有无数片雪花，其中第 $i$ 片雪花的价值为 $E_i$。经过小 X 的仔细观察，他发现 $C$ 和 $E$ 满足特殊的条件：\n\n$$\nC_i=\n\\begin{cases}\nx\\times i& (x\\times i\\le K)\\\\\n-K& \\text{otherwise}\n\\end{cases}\n$$\n$$\nE_i=\n\\begin{cases}\ny\\times i& (y\\times i\\le K)\\\\\n-K& \\text{otherwise}\n\\end{cases}\n$$\n\n小 Y 和小 Z 可以对这些落叶和雪花进行一些操作。每次，他们会选择满足价值之和 $\\ge K$ 的一片落叶和一片雪花，然后让把它们一同组成一段彩色的回忆（Erinnerung）。之后，这片雪花和这片落叶就消失不见了，之后的操作也不能再用到这片雪花和落叶了。\n\n小 X 想知道，他们最多能进行多少次操作。", "inputFormat": "**本题有多组数据。**\n\n第一行一个整数 $T$，表示数据的组数。\n\n接下来 $T$ 行，每行三个非负整数 $x,y,K$。", "outputFormat": "对于每组数据，输出一个整数，代表最多能有多少次操作。每组数据的答案用一个换行符隔开。", "hint": "**【样例解释】**\n\n对于样例 1 的第一组数据，落叶的价值为 $2,4,6,8,10,-10,-10\\dots$ ，雪花的价值为 $3,6,9,-10,-10\\dots$ 。第一次操作选取第 $4$ 片落叶和第 $1$ 片雪花，价值和为 $11$。第二次操作选取第 $2$ 片落叶和第 $2$ 片雪花，价值和为 $10$。第三次操作选取第 $5$ 片落叶和第 $3$ 片雪花，价值和为 $19$。如是，可以进行 $3$ 次操作。容易证明不存在更优的解。\n\n对于第二组数据，进行的两次操作可以为：选取第 $4$ 片落叶和第 $1$ 片雪花，以及选取第 $2$ 片落叶和第 $2$ 片雪花。\n\n对于样例 2，所有的雪花和落叶的价值都为 $0$，不可能找到落叶和雪花使其和 $\\ge 1$。\n\n---\n\n**【数据范围】**\n\n-  Subtask 1（30 points）：$x,y,K,T\\le 10$。\n-  Subtask 2（70 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，满足 $0\\le x,y\\le 10^{10}$，$1\\le K\\le 10^{10}$，$1\\le T\\le 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-7」Erinnerung", "background": "", "description": "小 Y 和小 Z 都是生活在 Arcaea Offline 的精灵。小 Y 有无数片落叶，其中第 $i$ 片落叶的价值为 $C_i$。小 Z 有无数片雪花，其中第 $i$ 片雪花的价值为 $E_i$。经过小 X 的仔细观察，他发现 $C$ 和 $E$ 满足特殊的条件：\n\n$$\nC_i=\n\\begin{cases}\nx\\times i& (x\\times i\\le K)\\\\\n-K& \\text{otherwise}\n\\end{cases}\n$$\n$$\nE_i=\n\\begin{cases}\ny\\times i& (y\\times i\\le K)\\\\\n-K& \\text{otherwise}\n\\end{cases}\n$$\n\n小 Y 和小 Z 可以对这些落叶和雪花进行一些操作。每次，他们会选择满足价值之和 $\\ge K$ 的一片落叶和一片雪花，然后让把它们一同组成一段彩色的回忆（Erinnerung）。之后，这片雪花和这片落叶就消失不见了，之后的操作也不能再用到这片雪花和落叶了。\n\n小 X 想知道，他们最多能进行多少次操作。", "inputFormat": "**本题有多组数据。**\n\n第一行一个整数 $T$，表示数据的组数。\n\n接下来 $T$ 行，每行三个非负整数 $x,y,K$。", "outputFormat": "对于每组数据，输出一个整数，代表最多能有多少次操作。每组数据的答案用一个换行符隔开。", "hint": "**【样例解释】**\n\n对于样例 1 的第一组数据，落叶的价值为 $2,4,6,8,10,-10,-10\\dots$ ，雪花的价值为 $3,6,9,-10,-10\\dots$ 。第一次操作选取第 $4$ 片落叶和第 $1$ 片雪花，价值和为 $11$。第二次操作选取第 $2$ 片落叶和第 $2$ 片雪花，价值和为 $10$。第三次操作选取第 $5$ 片落叶和第 $3$ 片雪花，价值和为 $19$。如是，可以进行 $3$ 次操作。容易证明不存在更优的解。\n\n对于第二组数据，进行的两次操作可以为：选取第 $4$ 片落叶和第 $1$ 片雪花，以及选取第 $2$ 片落叶和第 $2$ 片雪花。\n\n对于样例 2，所有的雪花和落叶的价值都为 $0$，不可能找到落叶和雪花使其和 $\\ge 1$。\n\n---\n\n**【数据范围】**\n\n-  Subtask 1（30 points）：$x,y,K,T\\le 10$。\n-  Subtask 2（70 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，满足 $0\\le x,y\\le 10^{10}$，$1\\le K\\le 10^{10}$，$1\\le T\\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P7442", "type": "P", "difficulty": 4, "samples": [["2 7\n2 0\n1 0\n2 1\n1 1\n2 2\n1 0\n2 3", "0\n2\n0\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["位运算", "洛谷月赛"], "title": "「EZEC-7」维护序列", "background": "[![](https://cdn.luogu.com.cn/upload/image_hosting/lo9tuyl9.png)](https://www.luogu.com.cn/paste/tdqr0sto)\n\n可怜的 dead_X 收不了歌，于是他出了个水题并给参赛者送了 $100$ 分。\n\n2022 Update: 已经收了，很水。", "description": "你需要维护一个序列。\n\n这个序列开始时有 $2^n$ 个数，下标从 $0$ 开始。第 $i$ 个数初始值为 $i$，需要支持以下三种操作：\n\n* 定义 $a$ 为所有下标为偶数的数组成的子序列，$b$ 为所有下标为奇数的数组成的子序列，将 $a,b$ 连接，构成新的序列。\n* 定义 $a$ 为所有下标为奇数的数组成的子序列，$b$ 为所有下标为偶数的数组成的子序列，将 $a,b$ 连接，构成新的序列。\n* 查询下标为 $x$ 的数。\n\n总共将进行 $m$ 次操作。", "inputFormat": "第一行输入两个正整数 $n,m$。\n\n接下来输入 $m$ 行，每行输入两个非负整数 $op,x$，代表一次操作。\n\n如果 $op=1$，若 $x=0$，代表第一种操作，若 $x=1$，代表第二种操作。\n\n如果 $op=2$，代表第三种操作，参数 $x$ 即为输入的 $x$。", "outputFormat": "对于每个 $op=2$ 输出一行，即对应的数。", "hint": "**【样例解释】**\n\n所有操作前后的序列从左至右的数如下：\n$$\\{0,1,2,3\\}$$\n下标为 $0$ 的数为 $0$。\n$$\\{0,2\\},\\{1,3\\}$$\n$$\\{0,2,1,3\\}$$\n下标为 $1$ 的数为 $2$。\n$$\\{2,3\\},\\{0,1\\}$$\n$$\\{2,3,0,1\\}$$\n下标为 $2$ 的数为 $0$。\n$$\\{2,0\\},\\{3,1\\}$$\n$$\\{2,0,3,1\\}$$\n下标为 $3$ 的数为 $1$。\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（10 points）：不存在 $op=1$ 的操作。\n- Subtask 2（10 points）：$n\\leq 10，m\\leq 10^3$。\n- Subtask 3（20 points）：$n\\leq 10$。\n- Subtask 4（20 points）：$m\\leq 10^3$。\n- Subtask 5（20 points）：对于 $op=1$ 的操作，$x=0$。\n- Subtask 6（20 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 32$，$1\\leq m\\leq 10^6$。\n\n若 $op=1$，$x\\in\\{0,1\\}$，若 $op=2$，$0\\leq x<2^n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-7」维护序列", "background": "[![](https://cdn.luogu.com.cn/upload/image_hosting/lo9tuyl9.png)](https://www.luogu.com.cn/paste/tdqr0sto)\n\n可怜的 dead_X 收不了歌，于是他出了个水题并给参赛者送了 $100$ 分。\n\n2022 Update: 已经收了，很水。", "description": "你需要维护一个序列。\n\n这个序列开始时有 $2^n$ 个数，下标从 $0$ 开始。第 $i$ 个数初始值为 $i$，需要支持以下三种操作：\n\n* 定义 $a$ 为所有下标为偶数的数组成的子序列，$b$ 为所有下标为奇数的数组成的子序列，将 $a,b$ 连接，构成新的序列。\n* 定义 $a$ 为所有下标为奇数的数组成的子序列，$b$ 为所有下标为偶数的数组成的子序列，将 $a,b$ 连接，构成新的序列。\n* 查询下标为 $x$ 的数。\n\n总共将进行 $m$ 次操作。", "inputFormat": "第一行输入两个正整数 $n,m$。\n\n接下来输入 $m$ 行，每行输入两个非负整数 $op,x$，代表一次操作。\n\n如果 $op=1$，若 $x=0$，代表第一种操作，若 $x=1$，代表第二种操作。\n\n如果 $op=2$，代表第三种操作，参数 $x$ 即为输入的 $x$。", "outputFormat": "对于每个 $op=2$ 输出一行，即对应的数。", "hint": "**【样例解释】**\n\n所有操作前后的序列从左至右的数如下：\n$$\\{0,1,2,3\\}$$\n下标为 $0$ 的数为 $0$。\n$$\\{0,2\\},\\{1,3\\}$$\n$$\\{0,2,1,3\\}$$\n下标为 $1$ 的数为 $2$。\n$$\\{2,3\\},\\{0,1\\}$$\n$$\\{2,3,0,1\\}$$\n下标为 $2$ 的数为 $0$。\n$$\\{2,0\\},\\{3,1\\}$$\n$$\\{2,0,3,1\\}$$\n下标为 $3$ 的数为 $1$。\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（10 points）：不存在 $op=1$ 的操作。\n- Subtask 2（10 points）：$n\\leq 10，m\\leq 10^3$。\n- Subtask 3（20 points）：$n\\leq 10$。\n- Subtask 4（20 points）：$m\\leq 10^3$。\n- Subtask 5（20 points）：对于 $op=1$ 的操作，$x=0$。\n- Subtask 6（20 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 32$，$1\\leq m\\leq 10^6$。\n\n若 $op=1$，$x\\in\\{0,1\\}$，若 $op=2$，$0\\leq x<2^n$。", "locale": "zh-CN"}}}
{"pid": "P7443", "type": "P", "difficulty": 5, "samples": [["4\n3 1 2 7\n1 1\n4 3 2\n3 1 2 7\n1 2\n4 3 2\n3 0 2 7\n1 2\n4 3 2\n9 1 523 182\n1 1 2 2 2 3 3 1\n3 23 18 293 162 483 574 384 109", "-1\n0\n22\n86491"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["树形数据结构", "博弈论", "O2优化", "洛谷月赛"], "title": "「EZEC-7」加边", "background": "> 暴力怎么做？暴力是不是，加边！加边！加边！然后，并查集查询！\n\nAlice 不喜欢并查集，但是她喜欢加边。", "description": "给定一棵 $n$ 个节点的树，节点从 $1$ 开始编号，$1$ 号节点是根节点，每条边的方向是从父亲到儿子。每个点有一个点权 $a_i$。Alice 和 Bob 在玩游戏，他们在根节点上放了一个棋子，Alice 和 Bob 轮流将棋子沿边移动，谁不能移动谁输。\n\n已知 Alice 是先手或是后手。在游戏开始前，Alice 可以在树上添加一条有向边 $u\\to v$（$1\\le u,v\\le n$），然后和 Bob 在形成的图上玩这个游戏，她希望自己存在必胜策略。**她也可以选择不加边。如果无法决出胜负则不算胜利。**\n\n给定正整数 $A,B$，Alice 添加边 $u\\to v$ 的代价是 $A\\times a_u+B\\times  a_v$。选择不加边的代价为 $0$。\n\nAlice 要最小化她的代价。如果她怎么加边都不满足要求，输出 $-1$。\n\nAlice 会做出 $T$ 次询问，你需要对每个询问输出答案。", "inputFormat": "**本题有多组数据。**\n\n第一行输入一个正整数 $T$，表示询问次数。\n\n对于每组询问，第一行输入四个正整数 $n,t,A,B$，其中 $n$ 表示树的节点数，$t$ 表示操作顺序，$t=0$ 表示 Alice 先手，$t=1$ 表示 Alice 后手。\n\n接下来一行 $n-1$ 个正整数，第 $i$ 个数表示节点 $i+1$ 的父亲编号 $f_{i+1}$。\n\n接下来一行 $n$ 个正整数，第 $i$ 个表示 $a_i$ 的值。", "outputFormat": "对于每个询问，输出一行一个整数，表示 Alice 的最小代价。如果她怎么加边都不满足要求，输出 $-1$。", "hint": "**【样例解释】**\n\n在第 $1$ 组询问中，Alice 是后手，她无论怎么添加边都无法拥有必胜策略，所以输出 $-1$。  \n在第 $2$ 组询问中，Alice 是后手，她不需要添加边就拥有必胜策略，所以代价为 $0$。  \n在第 $3$ 组询问中，Alice 是先手，她只能添加一条 $1\\to 3$ 的边使自己必胜，此时代价为 $2\\times 4+7\\times 2=22$。  \n在第 $4$ 组询问中，Alice 是后手，她可以添加一条 $9\\to 5$ 的边使自己必胜，此时代价为 $523\\times 109+182\\times 162=86491$。她还有其他使自己必胜的方法，但是可以发现 $86491$ 是最小代价。  \n\n------------\n\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n\n- Subtask 1（10 points）：$n\\le 10$，$T=1$；\n- Subtask 2（15 points）：$\\sum n\\le 200$；\n- Subtask 3（15 points）：$\\sum n\\le 2000$；\n- Subtask 4（10 points）：$f_i=i-1$；\n- Subtask 5（10 points）：$f_i=1$；\n- Subtask 6（20 points）：$\\sum n\\le 5\\times 10^5$；\n- Subtask 7（20 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，满足 $1\\le T\\le 2\\times10^3$，$2\\le n\\le2\\times 10^5$，$\\sum n\\le 5\\times 10^6$，$1\\le a_i,A,B\\le 10^9$，$f_i<i$，$t\\in\\{0,1\\}$。\n\n\n------------\n**【提示】**\n\n请使用较快的输入方式。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-7」加边", "background": "> 暴力怎么做？暴力是不是，加边！加边！加边！然后，并查集查询！\n\nAlice 不喜欢并查集，但是她喜欢加边。", "description": "给定一棵 $n$ 个节点的树，节点从 $1$ 开始编号，$1$ 号节点是根节点，每条边的方向是从父亲到儿子。每个点有一个点权 $a_i$。Alice 和 Bob 在玩游戏，他们在根节点上放了一个棋子，Alice 和 Bob 轮流将棋子沿边移动，谁不能移动谁输。\n\n已知 Alice 是先手或是后手。在游戏开始前，Alice 可以在树上添加一条有向边 $u\\to v$（$1\\le u,v\\le n$），然后和 Bob 在形成的图上玩这个游戏，她希望自己存在必胜策略。**她也可以选择不加边。如果无法决出胜负则不算胜利。**\n\n给定正整数 $A,B$，Alice 添加边 $u\\to v$ 的代价是 $A\\times a_u+B\\times  a_v$。选择不加边的代价为 $0$。\n\nAlice 要最小化她的代价。如果她怎么加边都不满足要求，输出 $-1$。\n\nAlice 会做出 $T$ 次询问，你需要对每个询问输出答案。", "inputFormat": "**本题有多组数据。**\n\n第一行输入一个正整数 $T$，表示询问次数。\n\n对于每组询问，第一行输入四个正整数 $n,t,A,B$，其中 $n$ 表示树的节点数，$t$ 表示操作顺序，$t=0$ 表示 Alice 先手，$t=1$ 表示 Alice 后手。\n\n接下来一行 $n-1$ 个正整数，第 $i$ 个数表示节点 $i+1$ 的父亲编号 $f_{i+1}$。\n\n接下来一行 $n$ 个正整数，第 $i$ 个表示 $a_i$ 的值。", "outputFormat": "对于每个询问，输出一行一个整数，表示 Alice 的最小代价。如果她怎么加边都不满足要求，输出 $-1$。", "hint": "**【样例解释】**\n\n在第 $1$ 组询问中，Alice 是后手，她无论怎么添加边都无法拥有必胜策略，所以输出 $-1$。  \n在第 $2$ 组询问中，Alice 是后手，她不需要添加边就拥有必胜策略，所以代价为 $0$。  \n在第 $3$ 组询问中，Alice 是先手，她只能添加一条 $1\\to 3$ 的边使自己必胜，此时代价为 $2\\times 4+7\\times 2=22$。  \n在第 $4$ 组询问中，Alice 是后手，她可以添加一条 $9\\to 5$ 的边使自己必胜，此时代价为 $523\\times 109+182\\times 162=86491$。她还有其他使自己必胜的方法，但是可以发现 $86491$ 是最小代价。  \n\n------------\n\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n\n- Subtask 1（10 points）：$n\\le 10$，$T=1$；\n- Subtask 2（15 points）：$\\sum n\\le 200$；\n- Subtask 3（15 points）：$\\sum n\\le 2000$；\n- Subtask 4（10 points）：$f_i=i-1$；\n- Subtask 5（10 points）：$f_i=1$；\n- Subtask 6（20 points）：$\\sum n\\le 5\\times 10^5$；\n- Subtask 7（20 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，满足 $1\\le T\\le 2\\times10^3$，$2\\le n\\le2\\times 10^5$，$\\sum n\\le 5\\times 10^6$，$1\\le a_i,A,B\\le 10^9$，$f_i<i$，$t\\in\\{0,1\\}$。\n\n\n------------\n**【提示】**\n\n请使用较快的输入方式。", "locale": "zh-CN"}}}
{"pid": "P7444", "type": "P", "difficulty": 6, "samples": [["4\n4 3 1 1", "2"], ["4\n4 0 3 2", "0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "2021", "洛谷原创", "O2优化", "动态规划优化", "前缀和", "逆元", "洛谷月赛"], "title": "「EZEC-7」猜排列", "background": "Update：数据已经经过加强。", "description": "Alice 手上有一个长度为 $n$ 的排列 $a$，排列中的数为 $0,1,2,\\cdots,n-1$。\n\nBob 闲来无事，想去猜它。但 Alice 不想让他轻易猜到。\n\n于是他抛给了 Bob 一些条件，让他来猜这个排列。\n\n我们定义 $f(l,r)=\\text{mex}\\{a_l,a_{l+1},\\cdots,a_r\\}$，其中 $\\text{mex}$ 函数代表一个可重集中**没有出现过**的最小**非负整数**。\n\n而 Alice 说出的条件包含 $n$ 个数，第 $i$ 个数代表着满足 $1 \\leq l \\leq r \\leq n$ 且 $f(l,r)=i-1$ 的二元组 $(l,r)$ 的个数。\n\nBob 一下就知道这并不能确认整个排列了，因此他想知道符合已有条件的排列数量。", "inputFormat": "第一行，一个正整数 $n$，代表 Alice 手中排列的长度。\n\n第二行，$n$ 个非负整数，第 $i$ 个数 $c_i$ 代表着满足 $l \\leq r $ 且 $f(l,r)=i-1$ 的二元组 $(l,r)$ 的个数。", "outputFormat": "输出符合已有条件的排列数量对 $998244353$ 取模的值。", "hint": "**【样例解释】**\n\n第一个样例中存在两个满足条件的排列，分别为：\n\n$\\{1,0,2,3\\}$ 和 $\\{3,2,0,1\\}$ 。\n\n第二个样例可以通过枚举发现没有符合题意的解。\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n* Subtask 1（4 points）：$n\\leq 8$。\n* Subtask 2（8 points）：$n\\leq 20$。\n* Subtask 3（16 points）：$n\\leq 100$。\n* Subtask 4（32 points）：$n\\leq 2\\times 10^3$。\n* Subtask 5（20 points）：$n\\leq 10^5$。\n* Subtask 6（20 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le n\\le5\\times10^5 $，$c_i \\ge 0$，保证 $\\sum^{n}_{i=1}c_i=\\frac{n(n+1)}{2}-1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-7」猜排列", "background": "Update：数据已经经过加强。", "description": "Alice 手上有一个长度为 $n$ 的排列 $a$，排列中的数为 $0,1,2,\\cdots,n-1$。\n\nBob 闲来无事，想去猜它。但 Alice 不想让他轻易猜到。\n\n于是他抛给了 Bob 一些条件，让他来猜这个排列。\n\n我们定义 $f(l,r)=\\text{mex}\\{a_l,a_{l+1},\\cdots,a_r\\}$，其中 $\\text{mex}$ 函数代表一个可重集中**没有出现过**的最小**非负整数**。\n\n而 Alice 说出的条件包含 $n$ 个数，第 $i$ 个数代表着满足 $1 \\leq l \\leq r \\leq n$ 且 $f(l,r)=i-1$ 的二元组 $(l,r)$ 的个数。\n\nBob 一下就知道这并不能确认整个排列了，因此他想知道符合已有条件的排列数量。", "inputFormat": "第一行，一个正整数 $n$，代表 Alice 手中排列的长度。\n\n第二行，$n$ 个非负整数，第 $i$ 个数 $c_i$ 代表着满足 $l \\leq r $ 且 $f(l,r)=i-1$ 的二元组 $(l,r)$ 的个数。", "outputFormat": "输出符合已有条件的排列数量对 $998244353$ 取模的值。", "hint": "**【样例解释】**\n\n第一个样例中存在两个满足条件的排列，分别为：\n\n$\\{1,0,2,3\\}$ 和 $\\{3,2,0,1\\}$ 。\n\n第二个样例可以通过枚举发现没有符合题意的解。\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n* Subtask 1（4 points）：$n\\leq 8$。\n* Subtask 2（8 points）：$n\\leq 20$。\n* Subtask 3（16 points）：$n\\leq 100$。\n* Subtask 4（32 points）：$n\\leq 2\\times 10^3$。\n* Subtask 5（20 points）：$n\\leq 10^5$。\n* Subtask 6（20 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le n\\le5\\times10^5 $，$c_i \\ge 0$，保证 $\\sum^{n}_{i=1}c_i=\\frac{n(n+1)}{2}-1$。", "locale": "zh-CN"}}}
{"pid": "P7445", "type": "P", "difficulty": 7, "samples": [["2 1 0\n", "166374059\n"], ["2 2 1\n", "813384288\n"], ["3 2 1\n", "462150164\n"], ["100 114 514\n", "718571152\n"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 2000, 2000, 2000, 2000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["O2优化", "生成函数", "期望", "快速傅里叶变换 FFT", "快速数论变换 NTT", "洛谷月赛"], "title": "「EZEC-7」线段树", "background": "Bob 喜欢线段树。\n", "description": "如果你不知道线段树，可以看 提示说明 中的定义。\n\nBob 得到了一个长度为 $n$ 的序列 $a_{1,2,\\cdots,n}$，初始全为 $0$。\n\n接着 Bob 进行了 $m$ 次区间加操作，每次操作会等概率地从 $[1,n]$ 的所有 $\\dfrac{n(n+1)}{2}$ 个子区间中随机选择一个进行操作，每次加的数是 $[-1,V]$ 之间等概率随机的整数。\n\n$m$ 次操作完之后要求出每一个位置的值。\n\n由于 Bob 喜欢线段树，他熟练地打出一颗 $[1,n]$ 上的线段树来解决这个问题，使用懒惰标记来解决区间加的问题。\n\n打代码的过程中 Bob 忽然想到了两个减小 $\\mathrm{Pushdown}$（下传懒惰标记）次数的方法：\n\n+ 修改的时候不 $\\mathrm{Pushdown}$，最后一次性 $\\mathrm{Pushdown}$（即 $\\mathrm{Pushall}$ 函数）。\n\n+ $\\mathrm{Pushall}$ 到一个节点的时候，如果这个节点的懒惰标记为 $0$ 那么不 $\\mathrm{Pushdown}$。\n\n现在 Bob 想知道期望 $\\mathrm{Pushdown}$ 次数，可是他不会算，于是来问你。\n\n下面是 Bob 写的线段树伪代码（其中 `tag` 数组为懒惰标记）：\n\n$\n\\displaystyle\n\\begin{array}{l}\n\\mathrm{pushdown\\_counter}\\leftarrow 0\\\\\n\\\\\n\\textbf{function }\\mathrm{Update(Node},l,r,ql,qr,Delta)\\\\\n\\qquad \\textbf{if } [l,r]\\cap [ql,qr] = \\varnothing \\textbf{ then}\\\\\n\\qquad \\qquad \\textbf{return}\\\\\n\\qquad \\textbf{end if}\\\\\n\\qquad \\textbf{if }[l,r] \\subseteq [ql,qr] \\textbf{ then}\\\\\n\\qquad \\qquad \\mathrm{tag[Node]\\leftarrow tag[Node]}+Delta\\\\\n\\qquad \\qquad \\textbf{return}\\\\\n\\qquad \\textbf{end if}\\\\\n\\qquad mid\\leftarrow \\lfloor\\dfrac{l+r}{2}\\rfloor\\\\\n\\qquad \\mathrm{Update(LeftChild},l,mid,ql,qr,Delta)\\\\\n\\qquad \\mathrm{Update(RightChild},mid+1,r,ql,qr,Delta)\\\\\n\\textbf{end function}\\\\\n\\\\\n\\textbf{function }\\mathrm{Pushdown(Node)} \\\\\n\\qquad \\mathrm{tag[LeftChild]\\leftarrow tag[LeftChild]+tag[Node]}\\\\\n\\qquad \\mathrm{tag[RightChild]\\leftarrow tag[RightChild]+tag[Node]}\\\\\n\\qquad \\mathrm{pushdown\\_counter}\\leftarrow \\mathrm{pushdown\\_counter}+1\\\\\n\\textbf{end function}\\\\\n\\\\\n\\textbf{function }\\mathrm{Pushall(Node},l,r)\\\\\n\\qquad \\textbf{if } \\mathrm{Node\\ is\\ Leaf} \\textbf{ then}\\\\\n\\qquad \\qquad \\textbf{return}\\\\\n\\qquad \\textbf{end if}\\\\\n\\qquad \\textbf{if } \\mathrm{tag[Node] \\not= 0} \\textbf{ then}\\\\\n\\qquad \\qquad \\mathrm{Pushdown(Node)}\\\\\n\\qquad \\textbf{end if}\\\\\n\\qquad mid\\leftarrow \\lfloor\\dfrac{l+r}{2}\\rfloor\\\\\n\\qquad \\mathrm{Pushall(LeftChild},l,mid)\\\\\n\\qquad \\mathrm{Pushall(RightChild},mid+1,r)\\\\\n\\textbf{end function}\n\\end{array}\n$\n\n\n换句话说，你要帮 Bob 求出 `pushdown_counter` 的期望值。\n\n答案对 $998244353$ 取模。\n", "inputFormat": "一行三个整数 $n,m,V$。", "outputFormat": "一个整数，期望 $\\mathrm{Pushdown}$ 次数对 $998244353$ 取模的结果。", "hint": "**【样例解释 #1】**\n\n整颗线段树只有 $3$ 个节点：$[1,2],[1,1],[2,2]$。\n\n只有节点 $[1,2]$ 可能 $\\mathrm{Pushdown}$。\n\n当操作为 $\\mathrm{Update(1,2,-1)}$ 的时候，根节点的懒惰标记为 $-1$， $\\mathrm{Pushall}$ 在根号节点会 $\\mathrm{Pushdown}$；而 $\\mathrm{Update(1,2,0)}$ 之后，由于根节点懒惰标记为 $0$ 不 $\\mathrm{Pushdown}$。\n\n其余 $4$ 种操作均把懒惰标记打在叶子节点，即 $\\mathrm{Update(1,1,-1)},\\mathrm{Update(1,1,0)},\\mathrm{Update(2,2,-1)},\\mathrm{Update(2,2,0)}$，不会 $\\mathrm{Pushdown}$。\n\n所以，总共 $6$ 种情况，能 $\\mathrm{Pushdown}$ 的只有 $1$ 种，期望次数为 $\\dfrac{1}{6}$。\n\n**【样例解释 #2】**\n\n由于情况过多，不一一解释，只解释一种情况。\n\n如果执行的 $2$ 次操作分别为 $\\mathrm{Update(1,2,-1)},\\mathrm{Update(1,2,1)}$，由于这时候根节点的懒惰标记为 $0$，在 $\\mathrm{Pushall}$ 的时候仍然不会 $\\mathrm{Pushdown}$。\n\n---------\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | $n\\le$       | $m\\le$       | $V$               | 分值 | 时间限制$\\text{ / ms}$ |\n| :----: | :------------: | :------------: | :-----------------: | :----: | :--------: |\n| $1$        | $4$  | $4$   | $\\le 2$         | $3$  | $500$    |\n| $2$        | $300$ | $300$ | $\\le 300$       | $7$  | $500$    |\n| $3$        | $1000$ | $1000$ | $\\le 1000$      | $10$ | $500$    |\n| $4$       | $300$  | $10^5$ | $=1000$          | $15$ | $2000$   |\n| $5$        | $10^5$ | $10^5$ | $\\le 0$         | $10$ | $3000$   |\n| $6$        | $10^5$ | $10^5$ | $=1000$          | $15$ | $3000$   |\n| $7$        | $10^5$ | $10^5$ | $\\le 998244350$ | $40$ | $3000$   |\n\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^5$，$1 \\le m \\le 10^5$，$-1 \\le V \\le 998244350$。\n\n----------\n\n**【线段树定义】**\n\n线段树是一棵每个节点上都记录了一个线段的二叉树。根节点记录的线段是 $[1, n]$。对于每个节点，若它记录的线段是 $[l, r]$ 且 $l\\not= r$，取 $m = \\lfloor \\dfrac{l+r}{2} \\rfloor$，则它的左右儿子节点记录的线段分别是 $[l, m]$ 和 $[m+1,r]$；若 $l=r$，则它是叶子节点。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-7」线段树", "background": "Bob 喜欢线段树。\n", "description": "如果你不知道线段树，可以看 提示说明 中的定义。\n\nBob 得到了一个长度为 $n$ 的序列 $a_{1,2,\\cdots,n}$，初始全为 $0$。\n\n接着 Bob 进行了 $m$ 次区间加操作，每次操作会等概率地从 $[1,n]$ 的所有 $\\dfrac{n(n+1)}{2}$ 个子区间中随机选择一个进行操作，每次加的数是 $[-1,V]$ 之间等概率随机的整数。\n\n$m$ 次操作完之后要求出每一个位置的值。\n\n由于 Bob 喜欢线段树，他熟练地打出一颗 $[1,n]$ 上的线段树来解决这个问题，使用懒惰标记来解决区间加的问题。\n\n打代码的过程中 Bob 忽然想到了两个减小 $\\mathrm{Pushdown}$（下传懒惰标记）次数的方法：\n\n+ 修改的时候不 $\\mathrm{Pushdown}$，最后一次性 $\\mathrm{Pushdown}$（即 $\\mathrm{Pushall}$ 函数）。\n\n+ $\\mathrm{Pushall}$ 到一个节点的时候，如果这个节点的懒惰标记为 $0$ 那么不 $\\mathrm{Pushdown}$。\n\n现在 Bob 想知道期望 $\\mathrm{Pushdown}$ 次数，可是他不会算，于是来问你。\n\n下面是 Bob 写的线段树伪代码（其中 `tag` 数组为懒惰标记）：\n\n$\n\\displaystyle\n\\begin{array}{l}\n\\mathrm{pushdown\\_counter}\\leftarrow 0\\\\\n\\\\\n\\textbf{function }\\mathrm{Update(Node},l,r,ql,qr,Delta)\\\\\n\\qquad \\textbf{if } [l,r]\\cap [ql,qr] = \\varnothing \\textbf{ then}\\\\\n\\qquad \\qquad \\textbf{return}\\\\\n\\qquad \\textbf{end if}\\\\\n\\qquad \\textbf{if }[l,r] \\subseteq [ql,qr] \\textbf{ then}\\\\\n\\qquad \\qquad \\mathrm{tag[Node]\\leftarrow tag[Node]}+Delta\\\\\n\\qquad \\qquad \\textbf{return}\\\\\n\\qquad \\textbf{end if}\\\\\n\\qquad mid\\leftarrow \\lfloor\\dfrac{l+r}{2}\\rfloor\\\\\n\\qquad \\mathrm{Update(LeftChild},l,mid,ql,qr,Delta)\\\\\n\\qquad \\mathrm{Update(RightChild},mid+1,r,ql,qr,Delta)\\\\\n\\textbf{end function}\\\\\n\\\\\n\\textbf{function }\\mathrm{Pushdown(Node)} \\\\\n\\qquad \\mathrm{tag[LeftChild]\\leftarrow tag[LeftChild]+tag[Node]}\\\\\n\\qquad \\mathrm{tag[RightChild]\\leftarrow tag[RightChild]+tag[Node]}\\\\\n\\qquad \\mathrm{pushdown\\_counter}\\leftarrow \\mathrm{pushdown\\_counter}+1\\\\\n\\textbf{end function}\\\\\n\\\\\n\\textbf{function }\\mathrm{Pushall(Node},l,r)\\\\\n\\qquad \\textbf{if } \\mathrm{Node\\ is\\ Leaf} \\textbf{ then}\\\\\n\\qquad \\qquad \\textbf{return}\\\\\n\\qquad \\textbf{end if}\\\\\n\\qquad \\textbf{if } \\mathrm{tag[Node] \\not= 0} \\textbf{ then}\\\\\n\\qquad \\qquad \\mathrm{Pushdown(Node)}\\\\\n\\qquad \\textbf{end if}\\\\\n\\qquad mid\\leftarrow \\lfloor\\dfrac{l+r}{2}\\rfloor\\\\\n\\qquad \\mathrm{Pushall(LeftChild},l,mid)\\\\\n\\qquad \\mathrm{Pushall(RightChild},mid+1,r)\\\\\n\\textbf{end function}\n\\end{array}\n$\n\n\n换句话说，你要帮 Bob 求出 `pushdown_counter` 的期望值。\n\n答案对 $998244353$ 取模。\n", "inputFormat": "一行三个整数 $n,m,V$。", "outputFormat": "一个整数，期望 $\\mathrm{Pushdown}$ 次数对 $998244353$ 取模的结果。", "hint": "**【样例解释 #1】**\n\n整颗线段树只有 $3$ 个节点：$[1,2],[1,1],[2,2]$。\n\n只有节点 $[1,2]$ 可能 $\\mathrm{Pushdown}$。\n\n当操作为 $\\mathrm{Update(1,2,-1)}$ 的时候，根节点的懒惰标记为 $-1$， $\\mathrm{Pushall}$ 在根号节点会 $\\mathrm{Pushdown}$；而 $\\mathrm{Update(1,2,0)}$ 之后，由于根节点懒惰标记为 $0$ 不 $\\mathrm{Pushdown}$。\n\n其余 $4$ 种操作均把懒惰标记打在叶子节点，即 $\\mathrm{Update(1,1,-1)},\\mathrm{Update(1,1,0)},\\mathrm{Update(2,2,-1)},\\mathrm{Update(2,2,0)}$，不会 $\\mathrm{Pushdown}$。\n\n所以，总共 $6$ 种情况，能 $\\mathrm{Pushdown}$ 的只有 $1$ 种，期望次数为 $\\dfrac{1}{6}$。\n\n**【样例解释 #2】**\n\n由于情况过多，不一一解释，只解释一种情况。\n\n如果执行的 $2$ 次操作分别为 $\\mathrm{Update(1,2,-1)},\\mathrm{Update(1,2,1)}$，由于这时候根节点的懒惰标记为 $0$，在 $\\mathrm{Pushall}$ 的时候仍然不会 $\\mathrm{Pushdown}$。\n\n---------\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | $n\\le$       | $m\\le$       | $V$               | 分值 | 时间限制$\\text{ / ms}$ |\n| :----: | :------------: | :------------: | :-----------------: | :----: | :--------: |\n| $1$        | $4$  | $4$   | $\\le 2$         | $3$  | $500$    |\n| $2$        | $300$ | $300$ | $\\le 300$       | $7$  | $500$    |\n| $3$        | $1000$ | $1000$ | $\\le 1000$      | $10$ | $500$    |\n| $4$       | $300$  | $10^5$ | $=1000$          | $15$ | $2000$   |\n| $5$        | $10^5$ | $10^5$ | $\\le 0$         | $10$ | $3000$   |\n| $6$        | $10^5$ | $10^5$ | $=1000$          | $15$ | $3000$   |\n| $7$        | $10^5$ | $10^5$ | $\\le 998244350$ | $40$ | $3000$   |\n\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^5$，$1 \\le m \\le 10^5$，$-1 \\le V \\le 998244350$。\n\n----------\n\n**【线段树定义】**\n\n线段树是一棵每个节点上都记录了一个线段的二叉树。根节点记录的线段是 $[1, n]$。对于每个节点，若它记录的线段是 $[l, r]$ 且 $l\\not= r$，取 $m = \\lfloor \\dfrac{l+r}{2} \\rfloor$，则它的左右儿子节点记录的线段分别是 $[l, m]$ 和 $[m+1,r]$；若 $l=r$，则它是叶子节点。\n", "locale": "zh-CN"}}}
{"pid": "P7446", "type": "P", "difficulty": 6, "samples": [["6 4\n1 2 3 3 4\n2 3 4\n1 1 0 2\n2 6 5\n2 1 0\n", "3\n3\n1"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2007", "O2优化", "Ynoi"], "title": "[Ynoi2007] rfplca", "background": null, "description": "给定一棵大小为 $n$ 的 $1$ 为根节点的树，树用如下方式给出：输入 $a_2,a_3,\\dots,a_n$，保证 $1\\leq a_i<i$，将 $a_i$ 与 $i$ 连边形成一棵树。\n\n接下来有 $m$ 次操作，操作有两种：\n- `1 l r x` 令 $a_i=\\max(a_i-x,1)(l\\leq i\\leq r)$。\n- `2 u v` 查询在当前的 $a$ 数组构成的树上 $u,v$ 的 LCA。", "inputFormat": "第一行包含两个数 $n$，$m$。\n\n之后一行 $n-1$ 个数，表示 $a_2,...,a_n$。\n\n之后 $m$ 行，每行三个或四个数，表示一次操作。\n\n**本题强制在线，所有输入的 $l,r,x,u,v$ 均需要异或 $lastans$，其定义为上一次询问操作得到的答案，若之前没有询问操作，则为 $0$。**", "outputFormat": "对于每个 $2$ 操作，输出一行一个数表示答案。", "hint": "Idea：Ynoi，Solution：Ynoi，Code：Ynoi，Data：Ynoi&nzhtl1477\n\n对于 $100\\%$ 的数据，满足\n$2\\leq n,m\\leq 4\\times 10^5$，$2\\leq l\\leq r\\leq n$，$1\\leq x\\leq 4\\times 10^5$，$1\\leq u,v\\leq n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2007] rfplca", "background": null, "description": "给定一棵大小为 $n$ 的 $1$ 为根节点的树，树用如下方式给出：输入 $a_2,a_3,\\dots,a_n$，保证 $1\\leq a_i<i$，将 $a_i$ 与 $i$ 连边形成一棵树。\n\n接下来有 $m$ 次操作，操作有两种：\n- `1 l r x` 令 $a_i=\\max(a_i-x,1)(l\\leq i\\leq r)$。\n- `2 u v` 查询在当前的 $a$ 数组构成的树上 $u,v$ 的 LCA。", "inputFormat": "第一行包含两个数 $n$，$m$。\n\n之后一行 $n-1$ 个数，表示 $a_2,...,a_n$。\n\n之后 $m$ 行，每行三个或四个数，表示一次操作。\n\n**本题强制在线，所有输入的 $l,r,x,u,v$ 均需要异或 $lastans$，其定义为上一次询问操作得到的答案，若之前没有询问操作，则为 $0$。**", "outputFormat": "对于每个 $2$ 操作，输出一行一个数表示答案。", "hint": "Idea：Ynoi，Solution：Ynoi，Code：Ynoi，Data：Ynoi&nzhtl1477\n\n对于 $100\\%$ 的数据，满足\n$2\\leq n,m\\leq 4\\times 10^5$，$2\\leq l\\leq r\\leq n$，$1\\leq x\\leq 4\\times 10^5$，$1\\leq u,v\\leq n$。", "locale": "zh-CN"}}}
{"pid": "P7447", "type": "P", "difficulty": 7, "samples": [["5 5\n2 4 5 1 3\n1 2 4 3\n2 1 5\n2 10 12\n1 7 3 7\n2 5 3", "9 1 3\n6 1 3\n4 1 2"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2007", "线段树", "倍增", "O2优化", "分块", "洛谷月赛", "Ynoi"], "title": "[Ynoi2007] rgxsxrs", "background": "本题读入量约 15 MB，输出量约 13 MB，请选择合适的输入输出方法。", "description": "给定一个长为 $n$ 的序列 $a$，需要实现 $m$ 次操作：\n\n`1 l r x`：表示将区间 $[l,r]$ 中所有 $>x$ 的元素减去 $x$。\n\n`2 l r`：表示询问区间 $[l,r]$ 的和，最小值，最大值。", "inputFormat": "第一行两个正整数 $n,m$。\n\n第二行 $n$ 个正整数表示序列 $a$。\n\n之后 $m$ 行每行 $3$ 或 $4$ 个正整数表示一次操作。\n\n**本题强制在线，所有输入的 $l,r,x$ 均需要异或 $lastans$，其定义为上一次询问操作得到的区间和对 $2^{20}$ 取模后的值，若之前没有询问操作，则为 $0$。**", "outputFormat": "对于每个操作 $2$ ，输出一行三个用空格分隔的数表示答案。", "hint": "Idea：wangziji&花花，Solution：wangziji&花花，Code：ccz181078，Data：wangziji&花花&ccz181078\n\n注意：本题采用**捆绑测试**，只有当你通过一个 subtask 中的所有测试点后，你才能拿到这个 subtask 的分数。\n\n对于 $1\\%$ 的数据，$n,m\\leq 1000$，时限为 3s。\n\n对于另外 $14\\%$ 的数据，$a_i\\leq 10$，$n,m\\leq 2\\times10^5$，时限为 3s。\n\n对于另外 $19\\%$ 的数据，$a_i\\leq 1000$，$n,m\\leq 2\\times10^5$，时限为 3s。\n\n对于另外 $19\\%$ 的数据，$a_i\\leq 2\\times 10^5$，$n,m\\leq 2\\times10^5$，时限为 3s。\n\n\n对于 $100\\%$ 的数据，$1\\le n,m\\leq 5\\times 10^5$，$1\\leq a_i,x\\leq 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2007] rgxsxrs", "background": "本题读入量约 15 MB，输出量约 13 MB，请选择合适的输入输出方法。", "description": "给定一个长为 $n$ 的序列 $a$，需要实现 $m$ 次操作：\n\n`1 l r x`：表示将区间 $[l,r]$ 中所有 $>x$ 的元素减去 $x$。\n\n`2 l r`：表示询问区间 $[l,r]$ 的和，最小值，最大值。", "inputFormat": "第一行两个正整数 $n,m$。\n\n第二行 $n$ 个正整数表示序列 $a$。\n\n之后 $m$ 行每行 $3$ 或 $4$ 个正整数表示一次操作。\n\n**本题强制在线，所有输入的 $l,r,x$ 均需要异或 $lastans$，其定义为上一次询问操作得到的区间和对 $2^{20}$ 取模后的值，若之前没有询问操作，则为 $0$。**", "outputFormat": "对于每个操作 $2$ ，输出一行三个用空格分隔的数表示答案。", "hint": "Idea：wangziji&花花，Solution：wangziji&花花，Code：ccz181078，Data：wangziji&花花&ccz181078\n\n注意：本题采用**捆绑测试**，只有当你通过一个 subtask 中的所有测试点后，你才能拿到这个 subtask 的分数。\n\n对于 $1\\%$ 的数据，$n,m\\leq 1000$，时限为 3s。\n\n对于另外 $14\\%$ 的数据，$a_i\\leq 10$，$n,m\\leq 2\\times10^5$，时限为 3s。\n\n对于另外 $19\\%$ 的数据，$a_i\\leq 1000$，$n,m\\leq 2\\times10^5$，时限为 3s。\n\n对于另外 $19\\%$ 的数据，$a_i\\leq 2\\times 10^5$，$n,m\\leq 2\\times10^5$，时限为 3s。\n\n\n对于 $100\\%$ 的数据，$1\\le n,m\\leq 5\\times 10^5$，$1\\leq a_i,x\\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P7448", "type": "P", "difficulty": 7, "samples": [["5\n2 1 3 2 1\n4\n2 4\n1 5\n3 5\n2 2", "1\n3\n3\n0"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2007", "O2优化", "Ynoi"], "title": "[Ynoi2007] rdiq", "background": "", "description": "给定一个长为 $n$ 的序列 $a$。\n\n有 $m$ 次询问，每次询问给定一个区间 $[l,r]$，求 $|\\{(a_i,a_j) : l\\le i<j\\le r \\wedge a_i>a_j\\}|$。", "inputFormat": "第一行一个数 $n$。\n\n第二行 $n$ 个数，其中第 $i$ 个数 $a_i$ 表示序列第 $i$ 个位置的值。\n\n第三行一个数 $m$。\n\n之后 $m$ 行，每行用两个空格隔开的数，分别表示 $l,r$，表示一次询问，保证 $l\\le r$。", "outputFormat": "输出 $m$ 行，第 $i$ 行输出一行一个整数，表示第 $i$ 次询问的答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477&ccz181078，Code：ccz181078，Data：w33z8kqrqk8zzzx33&nzhtl1477\n\n对于第一次询问，集合为 $\\{(3,2)\\}$。\n\n对于第二次与第三次询问，集合为 $\\{(2,1),(3,1),(3,2)\\}$。\n\n对于第四次询问，集合为空集。\n\n对于 $100\\%$ 的数据，满足 $1\\le n\\le 10^5$，$1\\le m\\le 5\\times 10^5$，$1\\le a_i\\le n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2007] rdiq", "background": "", "description": "给定一个长为 $n$ 的序列 $a$。\n\n有 $m$ 次询问，每次询问给定一个区间 $[l,r]$，求 $|\\{(a_i,a_j) : l\\le i<j\\le r \\wedge a_i>a_j\\}|$。", "inputFormat": "第一行一个数 $n$。\n\n第二行 $n$ 个数，其中第 $i$ 个数 $a_i$ 表示序列第 $i$ 个位置的值。\n\n第三行一个数 $m$。\n\n之后 $m$ 行，每行用两个空格隔开的数，分别表示 $l,r$，表示一次询问，保证 $l\\le r$。", "outputFormat": "输出 $m$ 行，第 $i$ 行输出一行一个整数，表示第 $i$ 次询问的答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477&ccz181078，Code：ccz181078，Data：w33z8kqrqk8zzzx33&nzhtl1477\n\n对于第一次询问，集合为 $\\{(3,2)\\}$。\n\n对于第二次与第三次询问，集合为 $\\{(2,1),(3,1),(3,2)\\}$。\n\n对于第四次询问，集合为空集。\n\n对于 $100\\%$ 的数据，满足 $1\\le n\\le 10^5$，$1\\le m\\le 5\\times 10^5$，$1\\le a_i\\le n$。", "locale": "zh-CN"}}}
{"pid": "P7449", "type": "P", "difficulty": 7, "samples": [["3\n0 0 0 100\n0 100 100 100\n100 100 0 0", "4\n0 0\n0 100\n100 100\n0 0"], ["3\n0 0 0 100\n1 51 1 49\n0 100 0 0", "5\n0 0\n0 100\n1 51\n1 49\n0 100"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2016", "提交答案", "Special Judge", "随机化", "构造", "THUSC"], "title": "[THUSC 2016] 星露谷物语", "background": "", "description": "最近，小葱为了忘记城市的喧嚣，来到了星露谷开始种地发家致富。但是，由于小葱把钱都拿去抽卡了，所以小葱并没有足够的钱来买种子。为了搜集足够的钱来养猪，小葱必须开始大规模的搜寻野菜工作。\n\n星露谷是一个无限大的二维平面，你可以在这个二维平面内任意移动。小葱可能在星露谷的 $n$ 条线段上找到野菜，但是这些线段是有向的，小葱必须沿着线段的方向移动才能找到野菜。为了找到更多的野菜，小葱希望自己能把星露谷中所有可能出现野菜的地方全部走一遍。换句话说，对于每条线段，小葱都需要沿着该线段的方向将这条线段的每个点都经过一遍。当然，小葱可以选择分多次走一条线段，具体地讲，小葱可以在这条线段的任意位置离开这条线段，再从任意位置进入这条线段，只要保证路径的并集覆盖了这条有向线段即可。\n\n小葱希望找到一条尽量短的路径，这条路径应该由 $m$ 条线段组成，并且覆盖了星露谷中的 $n$ 条有向线段。小葱可以选择星露谷的任意一个点作为路径的起点，同时它也必须是路径的终点，即小葱最终必须回到出发的位置。\n\n现在，小葱要去写四子棋大作业了，他不知道该怎么规划自己的行走方案使得自己移动的距离尽量短，所以就把这个艰巨的任务交给聪明的你了。\n\n**注意：如果有两条线段的某部分重合且方向相同，那么你在走过这一段的时候我们认为这两条线段的这部分都被走过了。**", "inputFormat": "第一行包含一个整数 $n$，代表图中有向线段的数量。\n\n接下来 $n$ 行，每行四个整数  $x_1,y_1,x_2,y_2$，代表这条线段是一条从 $(x_1,y_1)$ 到 $(x_2,y_2)$ 的有向线段。", "outputFormat": "第一行应包含一个整数 $m$，代表小葱所走的折线路径中点的数量，需要满足 $m\\le\\min(5n^2,5\\times 10^6)$。 接下来 $m$ 行，按照路径的顺序依次输出路径上的点。每行应包含两个浮点数 $x,y$，用来描述一个点的横、纵坐标。其中，$x,y$ 请保留不超过 $5$ 位小数。", "hint": "**本题为提交答案题，输入与 checker 将会在附件给出**\n\n对于每组测试数据，如果你的输出格式不符合题目要求，或者你输出的路径并没有走完给定的条 $n$ 有向线段，那么该测试点得 $0$ 分。否则，我们会计算你给出路径的长度 $d$，并根据 $10$ 个评分参数 $a_1\\ge a_2\\ge...\\ge a_{10}$ 计算你的得分：\n$$\\max\\{i|d\\le a_i,1\\le i\\le 10\\}$$\n\n数据保证 $a_1$ 足够大，以确保一个合法的方案至少可以得到 $1$ 分。\n#### 样例解释\n对于样例 $1$，小葱总共移动了 $200+100\\sqrt2$ 的距离，这也是这组样例的最优解。\n\n对于样例 $2$，在该组解中，小葱一共移动了 $202+\\sqrt{2402}+\\sqrt{2602}$ 的距离，但这并不是这组数据的最优解。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUSC 2016] 星露谷物语", "background": "", "description": "最近，小葱为了忘记城市的喧嚣，来到了星露谷开始种地发家致富。但是，由于小葱把钱都拿去抽卡了，所以小葱并没有足够的钱来买种子。为了搜集足够的钱来养猪，小葱必须开始大规模的搜寻野菜工作。\n\n星露谷是一个无限大的二维平面，你可以在这个二维平面内任意移动。小葱可能在星露谷的 $n$ 条线段上找到野菜，但是这些线段是有向的，小葱必须沿着线段的方向移动才能找到野菜。为了找到更多的野菜，小葱希望自己能把星露谷中所有可能出现野菜的地方全部走一遍。换句话说，对于每条线段，小葱都需要沿着该线段的方向将这条线段的每个点都经过一遍。当然，小葱可以选择分多次走一条线段，具体地讲，小葱可以在这条线段的任意位置离开这条线段，再从任意位置进入这条线段，只要保证路径的并集覆盖了这条有向线段即可。\n\n小葱希望找到一条尽量短的路径，这条路径应该由 $m$ 条线段组成，并且覆盖了星露谷中的 $n$ 条有向线段。小葱可以选择星露谷的任意一个点作为路径的起点，同时它也必须是路径的终点，即小葱最终必须回到出发的位置。\n\n现在，小葱要去写四子棋大作业了，他不知道该怎么规划自己的行走方案使得自己移动的距离尽量短，所以就把这个艰巨的任务交给聪明的你了。\n\n**注意：如果有两条线段的某部分重合且方向相同，那么你在走过这一段的时候我们认为这两条线段的这部分都被走过了。**", "inputFormat": "第一行包含一个整数 $n$，代表图中有向线段的数量。\n\n接下来 $n$ 行，每行四个整数  $x_1,y_1,x_2,y_2$，代表这条线段是一条从 $(x_1,y_1)$ 到 $(x_2,y_2)$ 的有向线段。", "outputFormat": "第一行应包含一个整数 $m$，代表小葱所走的折线路径中点的数量，需要满足 $m\\le\\min(5n^2,5\\times 10^6)$。 接下来 $m$ 行，按照路径的顺序依次输出路径上的点。每行应包含两个浮点数 $x,y$，用来描述一个点的横、纵坐标。其中，$x,y$ 请保留不超过 $5$ 位小数。", "hint": "**本题为提交答案题，输入与 checker 将会在附件给出**\n\n对于每组测试数据，如果你的输出格式不符合题目要求，或者你输出的路径并没有走完给定的条 $n$ 有向线段，那么该测试点得 $0$ 分。否则，我们会计算你给出路径的长度 $d$，并根据 $10$ 个评分参数 $a_1\\ge a_2\\ge...\\ge a_{10}$ 计算你的得分：\n$$\\max\\{i|d\\le a_i,1\\le i\\le 10\\}$$\n\n数据保证 $a_1$ 足够大，以确保一个合法的方案至少可以得到 $1$ 分。\n#### 样例解释\n对于样例 $1$，小葱总共移动了 $200+100\\sqrt2$ 的距离，这也是这组样例的最优解。\n\n对于样例 $2$，在该组解中，小葱一共移动了 $202+\\sqrt{2402}+\\sqrt{2602}$ 的距离，但这并不是这组数据的最优解。\n", "locale": "zh-CN"}}}
{"pid": "P7450", "type": "P", "difficulty": 7, "samples": [["1\n5 4 5\n3 4 3 4\n5 5 -1 5\n-1 4 5 5\n5 5 4 2\n1 -1 2 4\n1 3 1 1\n3 2 3 3\n4 4 4 5\n8 9 9 5\n7 2 6 3", "9 5"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "2017", "二分", "Special Judge", "随机化", "THUSC"], "title": "[THUSC 2017] 巧克力", "background": "", "description": "「人生就像一盒巧克力，你永远不知道吃到的下一块是什么味道。」\n\n明明收到了一大块巧克力，里面有若干小块，排成 $n$ 行 $m$ 列。每一小块都有自己特别的图案 ，它们有的是海星，有的是贝壳，有的是海螺……其中还有一些因为挤压，已经分辨不出是什么图案了。明明给每一小块巧克力标上了一个美味值 $a_{i,j}$（$0\\le a_{i,j}\\le 10^6$），这个值越大，表示这一小块巧克力越美味。\n\n正当明明咽了咽口水，准备享用美味时，舟舟神奇地出现了。看到舟舟恳求的目光，明明决定从中选出一些小块与舟舟一同分享。\n\n舟舟希望这些被选出的巧克力是连通的（两块巧克力连通当且仅当他们有公共边），而且这些巧克力要包含至少 $k$（$1\\le k\\le 5$）种。而那些被挤压过的巧克力则是不能被选中的。\n\n明明想满足舟舟的愿望，但他又有点「抠」，想将美味尽可能多地留给自己。所以明明希望选出的巧克力块数能够尽可能地少。如果在选出的块数最少的前提下，美味值的中位数（我们定义 $n$ 个数的中位数为第 $\\left\\lfloor\\frac{n+1}{2}\\right\\rfloor$ 小的数）能够达到最小就更好了。\n\n你能帮帮明明吗？", "inputFormat": "每个测试点包含多组测试数据。\n\n输入第一行包含一个正整数 $T$（$1\\le T\\le 5$），表示测试数据组数。\n\n对于每组测试数据：\n\n输入第一行包含三个正整数 $n,m$ 和 $k$；\n\n接下来 $n$ 行，每行 $m$ 个整数，表示每小块的图案 $c_{i,j}$。若 $c_{i,j}=-1$ 表示这一小块受到过挤压，不能被选中；\n\n接下来 $n$ 行，每行 $m$ 个整数，表示每个小块的美味值 $a_{i,j}$。", "outputFormat": "输出共包括 $T$ 行，每行包含两个整数，用空格隔开，即最少的块数和最小的美味值中位数。\n\n若对于某组测试数据，不存在任意一种合法的选取方案，请在对应行输出两个 $-1$。", "hint": "| 测试点编号 | $n,m$ 的限制 | $c_{i,j}$ 的限制 | 部分分说明 |\n| :----------: | :----------: | :----------: | :----------: |\n| 1 | $n=1,1\\le m\\le233$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le n\\times m$ | $\\text{A}$ |\n| 2 | $1\\le n\\times m\\le 20$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le n\\times m$ | $\\text{A}$ |\n| 3~4 | $n=2,m=15$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le n\\times m$ | $\\text{A}$ |\n| 5~6 | $1\\le n\\times m\\le 30$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le n\\times m$ | $\\text{A}$ |\n| 7~9 | $1\\le n\\times m\\le 50$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le8$ | $\\text{A}$ |\n| 10 | $1\\le n\\times m\\le 233$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le8$ | $\\text{A}$ |\n| 11~12 | $1\\le n\\times m\\le 233$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le8$ | $\\text{B}$ |\n| 13~15 | $1\\le n\\times m\\le 233$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le14$ | $\\text{B}$ |\n| 16~20 | $1\\le n\\times m\\le 233$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le n\\times m$ | $\\text{B}$ |\n| 21 | $1\\le n\\times m\\le 233$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le n\\times m$ | 该测试点不计分。 |\n\n$\\text{A}$:若输出的最少块数均正确，但最小中位数存在错误，选手可以获得该测试点 $80\\%$ 的分数。\\\n$\\text{B}$:若输出的最少块数均正确，但最小中位数存在错误，选手可以获得该测试点 $60\\%$ 的分数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUSC 2017] 巧克力", "background": "", "description": "「人生就像一盒巧克力，你永远不知道吃到的下一块是什么味道。」\n\n明明收到了一大块巧克力，里面有若干小块，排成 $n$ 行 $m$ 列。每一小块都有自己特别的图案 ，它们有的是海星，有的是贝壳，有的是海螺……其中还有一些因为挤压，已经分辨不出是什么图案了。明明给每一小块巧克力标上了一个美味值 $a_{i,j}$（$0\\le a_{i,j}\\le 10^6$），这个值越大，表示这一小块巧克力越美味。\n\n正当明明咽了咽口水，准备享用美味时，舟舟神奇地出现了。看到舟舟恳求的目光，明明决定从中选出一些小块与舟舟一同分享。\n\n舟舟希望这些被选出的巧克力是连通的（两块巧克力连通当且仅当他们有公共边），而且这些巧克力要包含至少 $k$（$1\\le k\\le 5$）种。而那些被挤压过的巧克力则是不能被选中的。\n\n明明想满足舟舟的愿望，但他又有点「抠」，想将美味尽可能多地留给自己。所以明明希望选出的巧克力块数能够尽可能地少。如果在选出的块数最少的前提下，美味值的中位数（我们定义 $n$ 个数的中位数为第 $\\left\\lfloor\\frac{n+1}{2}\\right\\rfloor$ 小的数）能够达到最小就更好了。\n\n你能帮帮明明吗？", "inputFormat": "每个测试点包含多组测试数据。\n\n输入第一行包含一个正整数 $T$（$1\\le T\\le 5$），表示测试数据组数。\n\n对于每组测试数据：\n\n输入第一行包含三个正整数 $n,m$ 和 $k$；\n\n接下来 $n$ 行，每行 $m$ 个整数，表示每小块的图案 $c_{i,j}$。若 $c_{i,j}=-1$ 表示这一小块受到过挤压，不能被选中；\n\n接下来 $n$ 行，每行 $m$ 个整数，表示每个小块的美味值 $a_{i,j}$。", "outputFormat": "输出共包括 $T$ 行，每行包含两个整数，用空格隔开，即最少的块数和最小的美味值中位数。\n\n若对于某组测试数据，不存在任意一种合法的选取方案，请在对应行输出两个 $-1$。", "hint": "| 测试点编号 | $n,m$ 的限制 | $c_{i,j}$ 的限制 | 部分分说明 |\n| :----------: | :----------: | :----------: | :----------: |\n| 1 | $n=1,1\\le m\\le233$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le n\\times m$ | $\\text{A}$ |\n| 2 | $1\\le n\\times m\\le 20$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le n\\times m$ | $\\text{A}$ |\n| 3~4 | $n=2,m=15$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le n\\times m$ | $\\text{A}$ |\n| 5~6 | $1\\le n\\times m\\le 30$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le n\\times m$ | $\\text{A}$ |\n| 7~9 | $1\\le n\\times m\\le 50$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le8$ | $\\text{A}$ |\n| 10 | $1\\le n\\times m\\le 233$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le8$ | $\\text{A}$ |\n| 11~12 | $1\\le n\\times m\\le 233$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le8$ | $\\text{B}$ |\n| 13~15 | $1\\le n\\times m\\le 233$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le14$ | $\\text{B}$ |\n| 16~20 | $1\\le n\\times m\\le 233$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le n\\times m$ | $\\text{B}$ |\n| 21 | $1\\le n\\times m\\le 233$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le n\\times m$ | 该测试点不计分。 |\n\n$\\text{A}$:若输出的最少块数均正确，但最小中位数存在错误，选手可以获得该测试点 $80\\%$ 的分数。\\\n$\\text{B}$:若输出的最少块数均正确，但最小中位数存在错误，选手可以获得该测试点 $60\\%$ 的分数。", "locale": "zh-CN"}}}
{"pid": "P7451", "type": "P", "difficulty": 7, "samples": [["3\n1 8\n12 24\n1 1000000", "16\n16\n947158782"], ["6\n3761870 4957871\n2262774 4279409\n3027437 5896884\n3884310 5021632\n3373244 5464739\n5063504 5368121", "953622420\n551347610\n583188135\n582472626\n190680894\n268824018"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "分治", "线性基", "分块", "THUSC"], "title": "[THUSC 2017] 杜老师", "background": "", "description": "杜老师可是要打 $+∞$ 年 World Final 的男人，虽然规则不允许，但是可以改啊！\n\n但是今年 WF 跟 THUSC 的时间这么近，所以他造了一个 idea 就扔下不管了……\n\n给定 $L,R$，求从 $L$ 到 $R$ 的这 $R-L+1$ 个数中能选出多少个不同的子集，满足子集中所有的数的乘积是一个完全平方数。特别地，空集也算一种选法，定义其乘积为 $1$。\n\n由于杜老师忙于跟陈老师和鏼老师一起打 ACM 竞赛，所以，你能帮帮杜老师写写标算吗？", "inputFormat": "从标准输入读入数据。\n\n每个测试点包含多组测试数据。\n\n输入第一行包含一个正整数 $T$（$1\\le T\\le 100$），表示测试数据组数。\n\n接下来 $T$ 行，第 $i+1$ 行两个正整数 $L_i,R_i$ 表示第 $i$ 组测试数据的 $L,R$，保证 $\\le L_i\\le R_i\\le10^7$。", "outputFormat": "输出到标准输出。\n\n输出 $T$ 行，每行一个非负整数，表示一共可以选出多少个满足条件的子集，答案对 $998244353$ 取模。", "hint": "对于 $L=1,R=8$，对应的 $16$ 种选法为：\n\n1. 空集\n1. $4$\n1. $3,6,8$\n1. $3,4,6,8$\n1. $2,8$\n1. $2,4,8$\n1. $2,3,6$\n1. $2,3,4,6$\n1. $1$\n1. $1,4$\n1. $1,3,6,8$\n1. $1,3,4,6,8$\n1. $1,2,8$\n1. $1,2,4,8$\n1. $1,2,3,6$\n1. $1,2,3,4,6$\n\n| 测试点 $\\operatorname*{Id}$ | $R_i\\le$ | $T\\le$ | $\\sum R_i-L_i+1\\le$ | 特殊约束 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| 1~2 | $30$ | $10$ | $10^3$ | 无特殊约束 |\n| 3 | $100$ | $10$ | $10^3$ | 保证答案不超过 $5\\times 10^6$ |\n| 4 | $100$ | $10$ | $10^3$ | 无特殊约束 |\n| 5~6 | $10^3$ | $10$ | $10^3$ | $R-L\\le22$ |\n| 7~8 | $10^3$ | $10$ | $10^3$ | 保证答案不超过 $2\\times 10^6$ |\n| 9~10 | $10^3$ | $10$ | $5\\times10^3$ | 无特殊约束 |\n| 11~12 | $10^6$ | $10$ | $10^7$ | $R-L\\ge999990$ |\n| 13~14 | $10^6$ | $10$ | $10^7$ | 无特殊约束 |\n| 15~20 | $10^7$ | $100$ | $(\\operatorname*{Id}-14)\\times 10^7$ | 无特殊约束 |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUSC 2017] 杜老师", "background": "", "description": "杜老师可是要打 $+∞$ 年 World Final 的男人，虽然规则不允许，但是可以改啊！\n\n但是今年 WF 跟 THUSC 的时间这么近，所以他造了一个 idea 就扔下不管了……\n\n给定 $L,R$，求从 $L$ 到 $R$ 的这 $R-L+1$ 个数中能选出多少个不同的子集，满足子集中所有的数的乘积是一个完全平方数。特别地，空集也算一种选法，定义其乘积为 $1$。\n\n由于杜老师忙于跟陈老师和鏼老师一起打 ACM 竞赛，所以，你能帮帮杜老师写写标算吗？", "inputFormat": "从标准输入读入数据。\n\n每个测试点包含多组测试数据。\n\n输入第一行包含一个正整数 $T$（$1\\le T\\le 100$），表示测试数据组数。\n\n接下来 $T$ 行，第 $i+1$ 行两个正整数 $L_i,R_i$ 表示第 $i$ 组测试数据的 $L,R$，保证 $\\le L_i\\le R_i\\le10^7$。", "outputFormat": "输出到标准输出。\n\n输出 $T$ 行，每行一个非负整数，表示一共可以选出多少个满足条件的子集，答案对 $998244353$ 取模。", "hint": "对于 $L=1,R=8$，对应的 $16$ 种选法为：\n\n1. 空集\n1. $4$\n1. $3,6,8$\n1. $3,4,6,8$\n1. $2,8$\n1. $2,4,8$\n1. $2,3,6$\n1. $2,3,4,6$\n1. $1$\n1. $1,4$\n1. $1,3,6,8$\n1. $1,3,4,6,8$\n1. $1,2,8$\n1. $1,2,4,8$\n1. $1,2,3,6$\n1. $1,2,3,4,6$\n\n| 测试点 $\\operatorname*{Id}$ | $R_i\\le$ | $T\\le$ | $\\sum R_i-L_i+1\\le$ | 特殊约束 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| 1~2 | $30$ | $10$ | $10^3$ | 无特殊约束 |\n| 3 | $100$ | $10$ | $10^3$ | 保证答案不超过 $5\\times 10^6$ |\n| 4 | $100$ | $10$ | $10^3$ | 无特殊约束 |\n| 5~6 | $10^3$ | $10$ | $10^3$ | $R-L\\le22$ |\n| 7~8 | $10^3$ | $10$ | $10^3$ | 保证答案不超过 $2\\times 10^6$ |\n| 9~10 | $10^3$ | $10$ | $5\\times10^3$ | 无特殊约束 |\n| 11~12 | $10^6$ | $10$ | $10^7$ | $R-L\\ge999990$ |\n| 13~14 | $10^6$ | $10$ | $10^7$ | 无特殊约束 |\n| 15~20 | $10^7$ | $100$ | $(\\operatorname*{Id}-14)\\times 10^7$ | 无特殊约束 |", "locale": "zh-CN"}}}
{"pid": "P7452", "type": "P", "difficulty": 6, "samples": [["2 4\n0 1 1 0\n1 0 1 0\n0 1 1 0\n1 0 1 0", "10"], ["2 4\n0 0 0 0\n0 0 0 0\n0 0 0 0\n0 0 0 0", "no solution"], ["2 10\n0 0 1 1 0 0 0 1 0 0\n1 1 1 0 0 1 0 0 0 0\n1 0 1 1 1 0 1 1 1 1\n1 1 1 1 1 1 0 0 1 0", "22"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "线段树", "费用流", "THUSC"], "title": "[THUSC 2017] 换桌", "background": "", "description": "班级聚会的时候，班主任为了方便管理，规定吃饭的时候同一个寝室的同学必须坐在一起；但是吃完饭后，到了娱乐时间，喜欢不同游戏的同学会聚到一起；在这个过程中就涉及到了座位分配的问题。\n\n有 $n$ 张圆桌排成一排（从左到右依次编号为 $0$ 到 $n-1$），每张桌子有 $m$ 个座位（按照逆时针依次编号为 $0$ 到 $m-1$），在吃饭时每个座位上都有一个人；在吃完饭后的时候，每个人都需要选择一个新的座位（新座位可能和原来的座位是同一个），具体来说，第 $i$ 桌第 $j$ 个人的新座位只能在第 $L_{i,j}$ 桌到第 $R_{i,j}$ 桌中选，可以是这些桌中的任何一个座位。确定好新座位之后，大家开始移动，移动的体力消耗按照如下规则计算：\n\n移动座位过程分为两步：\n\n1. 从起始桌移动到目标桌**对应座位**，这个过程中的体力消耗为**两桌距离的两倍**，即从第 $i$ 桌移动到第 $j$ 桌对应座位的体力消耗为 $2\\times |i-j|$；\n1. 从目标桌的对应座位绕着桌子移动到目标座位，由于桌子是圆的，所以客人会选择**最近的方向**移动，体力消耗为**移动距离的一倍**，即从编号为 $x$ 的座位移动的编号为 $y$ 的座位的体力消耗为 $\\min(|x-y|,m-|x-y|)$；\n\n详情如下图：\n![pic1](https://i.loli.net/2019/01/16/5c3f2f01e0336.png)\n现在，给定每个客人的限制（即每个人的新座位所在的区间），需要你设计一个方案，**使得所有客人消耗的体力和最小；本题中假设客人在移动的时候互不影响。**", "inputFormat": "从标准输入读入数据。\n\n第一行输入两个数 $n$ 和 $m$；\n\n接下来输入 $n$ 行，每行 $m$ 个空格隔开的整数描述矩阵 $L$：其中，第 $i$ 行的第 $j$ 个数表示 $L_{i,j}$；\n\n接下来输入 $n$ 行，每行 $m$ 个空格隔开的整数描述矩阵 $R$：其中，第 $i$ 行的第 $j$ 个数表示 $R_{i,j}$；\n\n数据是随机生成的，生成数据的伪代码如下：\n```cpp\nfor i <- 0 to n-1\n    for j <- 0 to m-1\n        L[i,j] <- 独立等概率地得到 0 到 n-1 中的一个整数\n        R[i,j] <- 独立等概率地得到 0 到 n-1 中的一个整数\n        if L[i,j] > R[i,j] then\n            tmp <- L[i,j]\n            L[i,j] <- R[i,j]\n            R[i,j] <- tmp\n```\n", "outputFormat": "输出到标准输出。\n\n输出总体力消耗的最小值，如果没有合法的方案输出 `no solution`。", "hint": "#### 样例解释\n对于样例 $1$，\n![pic2](https://i.loli.net/2019/01/16/5c3f2f01d91ae.png)\n\n第 $0$ 桌的 $0$ 和 $3$ 号，以及第 $1$ 桌的 $0$ 号和 $2$ 号都被限制为只能坐在他们原来的桌子（可以不是原来的座位），其他人分别需要换到第 $1$ 桌和第 $0$ 桌；\n\n可以发现，最优方案如上图，总体力消耗为 $10$。\n\n对于样例 $2$，所有人都想坐到第 $0$ 桌，所以没有合法的方案。\n\n对于全部数据：$1\\le n\\le 300$，$1\\le m\\le 10$，$0\\le L_i\\le R_i\\le n-1$ 。\n| 测试点 | $n\\le$ |\n| :----------: | :----------: |\n| 1~2 | $2$ |  |\n| 3~8 | $40$ |  |\n| 9~14 | $100$ |  |\n| 15~20 | $300$ |  |\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUSC 2017] 换桌", "background": "", "description": "班级聚会的时候，班主任为了方便管理，规定吃饭的时候同一个寝室的同学必须坐在一起；但是吃完饭后，到了娱乐时间，喜欢不同游戏的同学会聚到一起；在这个过程中就涉及到了座位分配的问题。\n\n有 $n$ 张圆桌排成一排（从左到右依次编号为 $0$ 到 $n-1$），每张桌子有 $m$ 个座位（按照逆时针依次编号为 $0$ 到 $m-1$），在吃饭时每个座位上都有一个人；在吃完饭后的时候，每个人都需要选择一个新的座位（新座位可能和原来的座位是同一个），具体来说，第 $i$ 桌第 $j$ 个人的新座位只能在第 $L_{i,j}$ 桌到第 $R_{i,j}$ 桌中选，可以是这些桌中的任何一个座位。确定好新座位之后，大家开始移动，移动的体力消耗按照如下规则计算：\n\n移动座位过程分为两步：\n\n1. 从起始桌移动到目标桌**对应座位**，这个过程中的体力消耗为**两桌距离的两倍**，即从第 $i$ 桌移动到第 $j$ 桌对应座位的体力消耗为 $2\\times |i-j|$；\n1. 从目标桌的对应座位绕着桌子移动到目标座位，由于桌子是圆的，所以客人会选择**最近的方向**移动，体力消耗为**移动距离的一倍**，即从编号为 $x$ 的座位移动的编号为 $y$ 的座位的体力消耗为 $\\min(|x-y|,m-|x-y|)$；\n\n详情如下图：\n![pic1](https://i.loli.net/2019/01/16/5c3f2f01e0336.png)\n现在，给定每个客人的限制（即每个人的新座位所在的区间），需要你设计一个方案，**使得所有客人消耗的体力和最小；本题中假设客人在移动的时候互不影响。**", "inputFormat": "从标准输入读入数据。\n\n第一行输入两个数 $n$ 和 $m$；\n\n接下来输入 $n$ 行，每行 $m$ 个空格隔开的整数描述矩阵 $L$：其中，第 $i$ 行的第 $j$ 个数表示 $L_{i,j}$；\n\n接下来输入 $n$ 行，每行 $m$ 个空格隔开的整数描述矩阵 $R$：其中，第 $i$ 行的第 $j$ 个数表示 $R_{i,j}$；\n\n数据是随机生成的，生成数据的伪代码如下：\n```cpp\nfor i <- 0 to n-1\n    for j <- 0 to m-1\n        L[i,j] <- 独立等概率地得到 0 到 n-1 中的一个整数\n        R[i,j] <- 独立等概率地得到 0 到 n-1 中的一个整数\n        if L[i,j] > R[i,j] then\n            tmp <- L[i,j]\n            L[i,j] <- R[i,j]\n            R[i,j] <- tmp\n```\n", "outputFormat": "输出到标准输出。\n\n输出总体力消耗的最小值，如果没有合法的方案输出 `no solution`。", "hint": "#### 样例解释\n对于样例 $1$，\n![pic2](https://i.loli.net/2019/01/16/5c3f2f01d91ae.png)\n\n第 $0$ 桌的 $0$ 和 $3$ 号，以及第 $1$ 桌的 $0$ 号和 $2$ 号都被限制为只能坐在他们原来的桌子（可以不是原来的座位），其他人分别需要换到第 $1$ 桌和第 $0$ 桌；\n\n可以发现，最优方案如上图，总体力消耗为 $10$。\n\n对于样例 $2$，所有人都想坐到第 $0$ 桌，所以没有合法的方案。\n\n对于全部数据：$1\\le n\\le 300$，$1\\le m\\le 10$，$0\\le L_i\\le R_i\\le n-1$ 。\n| 测试点 | $n\\le$ |\n| :----------: | :----------: |\n| 1~2 | $2$ |  |\n| 3~8 | $40$ |  |\n| 9~14 | $100$ |  |\n| 15~20 | $300$ |  |\n", "locale": "zh-CN"}}}
{"pid": "P7453", "type": "P", "difficulty": 5, "samples": [["2\n2 3 3\n6 6 6\n4\n7 1 2\n1 1 2\n4 1 2 3\n7 1 2", "8 9 9\n23 9 9"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "线段树", "O2优化", "矩阵乘法", "THUSC"], "title": "[THUSC 2017] 大魔法师", "background": null, "description": "大魔法师小 L 制作了 $n$ 个魔力水晶球，每个水晶球有水、火、土三个属性的能量值。小 L 把这 $n$ 个水晶球在地上从前向后排成一行，然后开始今天的魔法表演。\n\n我们用 $A_i,B_i,C_i$ 分别表示从前向后第 $i$ 个水晶球（下标从 $1$ 开始）的水、火、土的能量值。\n\n小 L 计划施展 $m$ 次魔法。每次，他会选择一个区间 $[l,r]$，然后施展以下 $3$ 大类、$7$ 种魔法之一：\n\n1. 魔力激发：令区间里每个水晶球中**特定属性**的能量爆发，从而使另一个**特定属性**的能量增强。具体来说，有以下三种可能的表现形式：\n\n\t- 火元素激发水元素能量：令 $A_i=A_i+B_i$。\n\t- 土元素激发火元素能量：令 $B_i=B_i+C_i$。\n\t- 水元素激发土元素能量：令 $C_i=C_i+A_i$。\n\t\n    **需要注意的是，增强一种属性的能量并不会改变另一种属性的能量，例如 $A_i=A_i+B_i$ 并不会使 $B_i$ 增加或减少。**\n\n2. 魔力增强：小 L 挥舞法杖，消耗自身 $v$ 点法力值，来改变区间里每个水晶球的**特定属性**的能量。具体来说，有以下三种可能的表现形式：\n\n\t- 水元素能量定值增强：令 $A_i=A_i+v$。\n\t- 火元素能量翻倍增强：令 $B_i=B_i\\times v$。\n\t- 土元素能量吸收融合：令 $C_i=v$。\n3. 魔力释放：小 L 将区间里所有水晶球的能量聚集在一起，融合成一个新的水晶球，然后送给场外观众。生成的水晶球每种属性的能量值等于区间内所有水晶球对应能量值的代数和。**需要注意的是，魔力释放的过程不会真正改变区间内水晶球的能量。**\n\n值得一提的是，小 L 制造和融合的水晶球的原材料都是定制版的 OI 工厂水晶，所以这些水晶球有一个能量阈值 $998244353$。当水晶球中某种属性的能量值大于等于这个阈值时，能量值会自动对阈值取模，从而避免水晶球爆炸。\n\n小 W 为小 L（唯一的）观众，围观了整个表演，并且收到了小 L 在表演中融合的每个水晶球。小 W 想知道，这些水晶球蕴涵的三种属性的能量值分别是多少。", "inputFormat": "从标准输入读入数据。\n\n我们将上述的 $7$ 种魔法，从上到下依次标号为 $1\\sim7$。\n\n输入的第一行包含一个整数 $n$（$1\\le n\\le 2.5\\times 10^5$），表示水晶球个数。\n\n接下来 $n$ 行，每行空格隔开的 $3$ 个整数，其中第 $i$ 行的三个数依次表示 $A_i,B_i,C_i$。\n\n接下来一行包含一个整数 $m$（$1\\le m\\le2.5\\times 10^5$），表示施展魔法的次数。\n\n接下来 $m$ 行，每行 $3$ 或 $4$ 个数，格式为 `opt l r (v)`。其中 `opt` 表示魔法的编号，$l,r$ 表示施展魔法的区间（保证有 $l\\le r$）。特别地，如果施展 $4\\sim6$ 号魔法（魔力增强），则还有一个整数 $v$，表示小 L 消耗的法力值。", "outputFormat": "输出到标准输出。\n\n对每个 $7$ 号魔法（魔力释放），输出一行、空格隔开的 $3$ 个整数 `a b c`，分别表示此次融合得到的水晶球的水、火、土元素能量值。", "hint": "对 $100\\%$ 的数据，$1\\le n,m\\le2.5\\times 10^5,0\\le A_i,B_i,C_i,v<998244353$。\n\n1. $10\\%$ 的数据，$n\\times m\\le10^7$。\n1. 另外 $10\\%$ 的数据，每次魔法的区间均为 $[1,n]$。\n1. 另外 $10\\%$ 的数据，每次非询问魔法的影响区间均为 $[1,n]$，所有修改在询问之前。\n1. 另外 $10\\%$ 的数据，$\\operatorname{opt}\\in\\{4,5,6,7\\}$。\n1. 另外 $15\\%$ 的数据，$\\operatorname{opt}\\in\\{1,2,7\\}$。\n  1. 另外 $15\\%$ 的数据，$\\operatorname{opt}\\in\\{1,2,3,5,7\\}$。\n1. 另外 $15\\%$ 的数据，$n,m\\le 10^5$。\n1. 其他数据，无特殊约定。\n#### 样例解释\n以下展示每次施展魔法后，两个水晶球内的能量：\n```\n(2, 3, 3) (6, 6, 6)\n(5, 3, 3) (12, 6, 6)\n(8, 3, 3) (15, 6, 6)\n(8, 3, 3) (15, 6, 6)\n```", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUSC 2017] 大魔法师", "background": null, "description": "大魔法师小 L 制作了 $n$ 个魔力水晶球，每个水晶球有水、火、土三个属性的能量值。小 L 把这 $n$ 个水晶球在地上从前向后排成一行，然后开始今天的魔法表演。\n\n我们用 $A_i,B_i,C_i$ 分别表示从前向后第 $i$ 个水晶球（下标从 $1$ 开始）的水、火、土的能量值。\n\n小 L 计划施展 $m$ 次魔法。每次，他会选择一个区间 $[l,r]$，然后施展以下 $3$ 大类、$7$ 种魔法之一：\n\n1. 魔力激发：令区间里每个水晶球中**特定属性**的能量爆发，从而使另一个**特定属性**的能量增强。具体来说，有以下三种可能的表现形式：\n\n\t- 火元素激发水元素能量：令 $A_i=A_i+B_i$。\n\t- 土元素激发火元素能量：令 $B_i=B_i+C_i$。\n\t- 水元素激发土元素能量：令 $C_i=C_i+A_i$。\n\t\n    **需要注意的是，增强一种属性的能量并不会改变另一种属性的能量，例如 $A_i=A_i+B_i$ 并不会使 $B_i$ 增加或减少。**\n\n2. 魔力增强：小 L 挥舞法杖，消耗自身 $v$ 点法力值，来改变区间里每个水晶球的**特定属性**的能量。具体来说，有以下三种可能的表现形式：\n\n\t- 水元素能量定值增强：令 $A_i=A_i+v$。\n\t- 火元素能量翻倍增强：令 $B_i=B_i\\times v$。\n\t- 土元素能量吸收融合：令 $C_i=v$。\n3. 魔力释放：小 L 将区间里所有水晶球的能量聚集在一起，融合成一个新的水晶球，然后送给场外观众。生成的水晶球每种属性的能量值等于区间内所有水晶球对应能量值的代数和。**需要注意的是，魔力释放的过程不会真正改变区间内水晶球的能量。**\n\n值得一提的是，小 L 制造和融合的水晶球的原材料都是定制版的 OI 工厂水晶，所以这些水晶球有一个能量阈值 $998244353$。当水晶球中某种属性的能量值大于等于这个阈值时，能量值会自动对阈值取模，从而避免水晶球爆炸。\n\n小 W 为小 L（唯一的）观众，围观了整个表演，并且收到了小 L 在表演中融合的每个水晶球。小 W 想知道，这些水晶球蕴涵的三种属性的能量值分别是多少。", "inputFormat": "从标准输入读入数据。\n\n我们将上述的 $7$ 种魔法，从上到下依次标号为 $1\\sim7$。\n\n输入的第一行包含一个整数 $n$（$1\\le n\\le 2.5\\times 10^5$），表示水晶球个数。\n\n接下来 $n$ 行，每行空格隔开的 $3$ 个整数，其中第 $i$ 行的三个数依次表示 $A_i,B_i,C_i$。\n\n接下来一行包含一个整数 $m$（$1\\le m\\le2.5\\times 10^5$），表示施展魔法的次数。\n\n接下来 $m$ 行，每行 $3$ 或 $4$ 个数，格式为 `opt l r (v)`。其中 `opt` 表示魔法的编号，$l,r$ 表示施展魔法的区间（保证有 $l\\le r$）。特别地，如果施展 $4\\sim6$ 号魔法（魔力增强），则还有一个整数 $v$，表示小 L 消耗的法力值。", "outputFormat": "输出到标准输出。\n\n对每个 $7$ 号魔法（魔力释放），输出一行、空格隔开的 $3$ 个整数 `a b c`，分别表示此次融合得到的水晶球的水、火、土元素能量值。", "hint": "对 $100\\%$ 的数据，$1\\le n,m\\le2.5\\times 10^5,0\\le A_i,B_i,C_i,v<998244353$。\n\n1. $10\\%$ 的数据，$n\\times m\\le10^7$。\n1. 另外 $10\\%$ 的数据，每次魔法的区间均为 $[1,n]$。\n1. 另外 $10\\%$ 的数据，每次非询问魔法的影响区间均为 $[1,n]$，所有修改在询问之前。\n1. 另外 $10\\%$ 的数据，$\\operatorname{opt}\\in\\{4,5,6,7\\}$。\n1. 另外 $15\\%$ 的数据，$\\operatorname{opt}\\in\\{1,2,7\\}$。\n  1. 另外 $15\\%$ 的数据，$\\operatorname{opt}\\in\\{1,2,3,5,7\\}$。\n1. 另外 $15\\%$ 的数据，$n,m\\le 10^5$。\n1. 其他数据，无特殊约定。\n#### 样例解释\n以下展示每次施展魔法后，两个水晶球内的能量：\n```\n(2, 3, 3) (6, 6, 6)\n(5, 3, 3) (12, 6, 6)\n(8, 3, 3) (15, 6, 6)\n(8, 3, 3) (15, 6, 6)\n```", "locale": "zh-CN"}}}
{"pid": "P7454", "type": "P", "difficulty": 7, "samples": [["6 3", "44"], ["120 6", "615888898"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "2017", "线性递推", "THUSC", "状压 DP"], "title": "[THUSC 2017] 如果奇迹有颜色", "background": "法本公司曾经是世界最大的化工企业，他们生产的染料颜色非常丰富，有清华紫，心灵黄，原谅绿，会议蓝，高级黑，北大红，相簿白等。", "description": "现在 B 君有一个由 $n$ 个区域组成的环，B 君要用 $m$ 种颜色来染这 $n$ 个区域。\n\nB 君不希望在这 $n$ 个区域中存在连续 $m$ 个区域恰好出现所有 $m$ 个颜色。换句话说，对于任意连续 $m$ 个区域，都不能恰好出现所有 $m$ 个颜色。\n\n如果两个方案通过旋转可以变得一模一样，那么我们认为他们是本质相同的；\n\n但是如果两个方案需要通过翻转才能变得一模一样，我们不认为他们是本质相同的。\n\n比如如果 $n=4,m=4$；\n\n我们认为 $1,2,3,4$ 和 $3,4,1,2$ 是本质相同的方案；\n\n我们认为 $1,2,3,4$ 和 $4,3,2,1$ 是本质不同的方案；\n\n我们认为 $1,2,1,2$ 和 $2,1,2,1$ 是本质相同的方案；\n\nB 君希望知道满足条件，本质不同的方案数，输出答案对 $10^9+7$ 取模。", "inputFormat": "从标准输入读入数据。\n\n输入一行包含两个整数 $n,m$，其中 $n$ 表示环的长度，$m$ 表示颜色数。", "outputFormat": "输出到标准输出。\n\n输出一行一个整数，表示答案对 $10^9+7$ 取模的结果。", "hint": "对于 $100\\%$ 的测试点，$1\\le n\\le 10^9,2\\le m\\le7$ 。\n| 数据点编号 $\\operatorname*{Id}$ | $n$ | $m$ |\n| :----------: | :----------: | :----------: |\n| 1~2 | $n\\le10$ | $m=\\operatorname*{Id}+2$ |\n| 3~8 | $n\\le 10^5,n$ 是质数 | $m=\\operatorname*{Id}-1$ |\n| 9~14 | $n$ 是质数 | $m=\\operatorname*{Id}-7$ |\n| 15~19 | 无特殊约束 | $m=\\operatorname*{Id}-13$ |\n| 20 | $n=635,643,090$ | $m=7$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUSC 2017] 如果奇迹有颜色", "background": "法本公司曾经是世界最大的化工企业，他们生产的染料颜色非常丰富，有清华紫，心灵黄，原谅绿，会议蓝，高级黑，北大红，相簿白等。", "description": "现在 B 君有一个由 $n$ 个区域组成的环，B 君要用 $m$ 种颜色来染这 $n$ 个区域。\n\nB 君不希望在这 $n$ 个区域中存在连续 $m$ 个区域恰好出现所有 $m$ 个颜色。换句话说，对于任意连续 $m$ 个区域，都不能恰好出现所有 $m$ 个颜色。\n\n如果两个方案通过旋转可以变得一模一样，那么我们认为他们是本质相同的；\n\n但是如果两个方案需要通过翻转才能变得一模一样，我们不认为他们是本质相同的。\n\n比如如果 $n=4,m=4$；\n\n我们认为 $1,2,3,4$ 和 $3,4,1,2$ 是本质相同的方案；\n\n我们认为 $1,2,3,4$ 和 $4,3,2,1$ 是本质不同的方案；\n\n我们认为 $1,2,1,2$ 和 $2,1,2,1$ 是本质相同的方案；\n\nB 君希望知道满足条件，本质不同的方案数，输出答案对 $10^9+7$ 取模。", "inputFormat": "从标准输入读入数据。\n\n输入一行包含两个整数 $n,m$，其中 $n$ 表示环的长度，$m$ 表示颜色数。", "outputFormat": "输出到标准输出。\n\n输出一行一个整数，表示答案对 $10^9+7$ 取模的结果。", "hint": "对于 $100\\%$ 的测试点，$1\\le n\\le 10^9,2\\le m\\le7$ 。\n| 数据点编号 $\\operatorname*{Id}$ | $n$ | $m$ |\n| :----------: | :----------: | :----------: |\n| 1~2 | $n\\le10$ | $m=\\operatorname*{Id}+2$ |\n| 3~8 | $n\\le 10^5,n$ 是质数 | $m=\\operatorname*{Id}-1$ |\n| 9~14 | $n$ 是质数 | $m=\\operatorname*{Id}-7$ |\n| 15~19 | 无特殊约束 | $m=\\operatorname*{Id}-13$ |\n| 20 | $n=635,643,090$ | $m=7$ |", "locale": "zh-CN"}}}
{"pid": "P7455", "type": "P", "difficulty": 7, "samples": [["见附加文件中的 0.in", "见附加文件中的 0.ans"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["计算几何", "2017", "提交答案", "Special Judge", "高斯消元", "THUSC"], "title": "[THUSC 2017] 宇宙广播", "background": "", "description": "威摄纪元公元 2233 年，人类掌握了一项新的科技：基于量子力学原理，在地球表面上的宇宙广播能够超光速地将信号传播到这个点坐标所在的、与地球相切的平面中。\n\n自从万有引力号广播了坐标之后，它带着人类文明的种子，远离太阳系飞向了宇宙深处。\n\nDX3906 星系黑域纪元公元 3333 年，万有引力号找到了一个十分庞大的 X 星系，直径数光年，其中有 3 个适合人类居住的星球，分布在 X 星系不同的角落中。经过商讨之后，万有引力号的部分成员选择留在这三个星球上定居。\n\n对于定居的人类而言，实时通讯是十分必要的，因此一千一百年前发明的那套装置在这时候就派上了用场。显然，三个星球能够互相通讯，当且仅当三个宇宙广播的工作切平面完全重合。\n\n现在，星球球长阿米巴找到了善于编程的你，希望你能够通过编程计算得出所有能够建立宇宙广播的方案。\n\n在你承担了这个任务之后，你在心里说了一句，「这算啥，我 ygg 分分钟搞定」，然而善于读心的阿米巴马上把你叫了回来，语重心长的跟你说，人类文明还要延续，把 $K$ 维空间的 $K$ 个星球的建站方案一起解决了。球长也没太为难你，只要你求 $K\\le10$ 的情况，这是因为宇宙加上时间维之后是 $11$ 维的。\n\n当你用 $3$ 分钟写完程序之后，阿米巴看了看，送给你一张二向箔——因为你没有在程序里考虑到这个情况。\n\n给定坐标维数 $K\\ge2$，以及在 $K$ 维坐标下的 $K$ 个球（**可退化成点**，即半径可以为零），求出这 $K$ 个球的**所有公切面**。\n\n数据保证不会出现无解或无穷多组解的情况，但不保证所有球都是相离的。\n\n以下是一些定义：\n\n- 距离：在 $K$ 维空间中，设有两个点 $A(a_0,a_1,...,a_{K-1}),B(b_0,b_1,...,b_{K-1})$，则 $AB$ 之间的距离 $|AB|=\\sqrt{\\sum_{i=0}^{K-1}(a_i-b_i)^2}$；\n\n- 球：在 $K$ 维空间中，与定点 $A$ 的距离为常数 $r$ 的点集，并同时称点 $A$ 为球心，$r$ 为该球半径；\n\n  当 $K=2$ 时，即为大家在中学所熟知的圆。\n\n- 超平面：到 $K$ 维空间中某两个点 $A,B$ 距离相等的点集；在 $K$ 维空间中，超平面的维数为 $K-1$；\n\n\t当 $K=2$ 时，即为大家在中学所熟知的直线（垂直平分线）。\n\n- 球的切平面：一个超平面 $P$ 与球 $A$ 有且仅有一个交点；\n\n- 球的公切面：一个超平面 $P$ 是所有球的切平面。", "inputFormat": "这是一道提交答案题，共有8组输入数据，这些数据命名为 1.in ~ 8.in。\n\n每个测试点中包含多组数据。对于每个测试点：\n\n- 第一行：测试点包含的数据组数 $T$，保证 $T\\le10$。\n- 对于每组数据：\n\t- 第一行：坐标维数 $K$，保证 $2\\le K\\le10$。\n\t- 接下来 $K$ 行，每行 $K+1$ 个实数。第 $i$ 行的前 $K$ 个数代表第 $i$ 个球的球心所在的坐标，第 $K+1$ 个数代表第 $i$ 个球的半径。", "outputFormat": "对于每组输入数据，你需要提交相应的输出文件 1.out ~ 8.out。\n\n对于每个测试点的每组数据：\n\n- 第一行，一个正整数  $S$，表示在这组数据中你总共找到了 $S$ 组切平面。如果没找到任何一组解，**请务必输出 $0$，否则将会影响后续数据的评分，造成的后果由选手自行承担**；\n- 接下来 $S\\times K$ 行，每行 $K$ 个小数，对于相对的第 $S(i-1)+j$ 行，表示在输出的第 $i$ 个解中，**对应输入**的第 $j$ 个球上的切点坐标；\n- 最后一行，输出一个空行；\n\n**在输出文件的最后，你可以添加任意内容，这不会影响你的得分。我们建议你在此处写一些有意义的内容（如简要方法），以便于我们在考后进行统计分析。单个输出文件大小不得超过 4M。**", "hint": "#### 评分标准\n- 解的输出顺序没有要求。在一组解中，记输出答案为 $A(a_0,a_1,...,a_{K-1})$，如果存在一组标准答案 $B(b_0,b_1,...,b_{K-1})$，满足 $\\sum_{i=0}^{K-1}|A_iB_i|^2\\le10^{-12}$，那么这一组输出答案将会被判定为正确。\n- 在每个测试点的同一组数据中，我们会统计被匹配上的标准答案的公切面的个数，每个标准答案只会被匹配至多一次，输出重复的公切面不倒扣分。第 $i$ 组数据回答正确的比例为被匹配上的标准答案的个数除以标准答案的总个数，记为 $rate_i$。\n- 对于每个测试点的评分方式：\n\t1. 如果你的输出格式不合法，或者参数不符合题目约定，或者某一组的答案个数超过该组标准答案个数的两倍以上（不含两倍），则得0分；\n      1. 在不违背上述条件的情况下，算对其中任何一组数据的任何一个解就至少有一分；并且所有的答案都算对了，才能得\n      1. 在不违背上述条件的情况下，记共有 $T$ 组数据，$rate_i$ 为第 $i$ 组数据回答正确的比例，$score$ 为这个测试点的分值，则 $Yourscore=\\frac{score}{T}\\times\\sum_{i=1}^T\\sqrt{rate_i}$ 在不违背以上原则的情况下四舍五入输出，即 $Yourscore\\in[1,score-1]$。\n各测试点分值不同，具体如下表所示：\n\n| 测试点 | $K\\le$ | 分值 |\n| :----------: | :----------: | :----------: |\n| 1 | $2$ | $5$ |\n| 2 | $2$ | $15$ |\n| 3 | $3$ | $11$ |\n| 4 | $3$ | $14$ |\n| 5 | $3$ | $16$ |\n| 6 | $4$ | $7$ |\n| 7 | $4$ | $9$ |\n| 8 | $10$ | $23$ |\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUSC 2017] 宇宙广播", "background": "", "description": "威摄纪元公元 2233 年，人类掌握了一项新的科技：基于量子力学原理，在地球表面上的宇宙广播能够超光速地将信号传播到这个点坐标所在的、与地球相切的平面中。\n\n自从万有引力号广播了坐标之后，它带着人类文明的种子，远离太阳系飞向了宇宙深处。\n\nDX3906 星系黑域纪元公元 3333 年，万有引力号找到了一个十分庞大的 X 星系，直径数光年，其中有 3 个适合人类居住的星球，分布在 X 星系不同的角落中。经过商讨之后，万有引力号的部分成员选择留在这三个星球上定居。\n\n对于定居的人类而言，实时通讯是十分必要的，因此一千一百年前发明的那套装置在这时候就派上了用场。显然，三个星球能够互相通讯，当且仅当三个宇宙广播的工作切平面完全重合。\n\n现在，星球球长阿米巴找到了善于编程的你，希望你能够通过编程计算得出所有能够建立宇宙广播的方案。\n\n在你承担了这个任务之后，你在心里说了一句，「这算啥，我 ygg 分分钟搞定」，然而善于读心的阿米巴马上把你叫了回来，语重心长的跟你说，人类文明还要延续，把 $K$ 维空间的 $K$ 个星球的建站方案一起解决了。球长也没太为难你，只要你求 $K\\le10$ 的情况，这是因为宇宙加上时间维之后是 $11$ 维的。\n\n当你用 $3$ 分钟写完程序之后，阿米巴看了看，送给你一张二向箔——因为你没有在程序里考虑到这个情况。\n\n给定坐标维数 $K\\ge2$，以及在 $K$ 维坐标下的 $K$ 个球（**可退化成点**，即半径可以为零），求出这 $K$ 个球的**所有公切面**。\n\n数据保证不会出现无解或无穷多组解的情况，但不保证所有球都是相离的。\n\n以下是一些定义：\n\n- 距离：在 $K$ 维空间中，设有两个点 $A(a_0,a_1,...,a_{K-1}),B(b_0,b_1,...,b_{K-1})$，则 $AB$ 之间的距离 $|AB|=\\sqrt{\\sum_{i=0}^{K-1}(a_i-b_i)^2}$；\n\n- 球：在 $K$ 维空间中，与定点 $A$ 的距离为常数 $r$ 的点集，并同时称点 $A$ 为球心，$r$ 为该球半径；\n\n  当 $K=2$ 时，即为大家在中学所熟知的圆。\n\n- 超平面：到 $K$ 维空间中某两个点 $A,B$ 距离相等的点集；在 $K$ 维空间中，超平面的维数为 $K-1$；\n\n\t当 $K=2$ 时，即为大家在中学所熟知的直线（垂直平分线）。\n\n- 球的切平面：一个超平面 $P$ 与球 $A$ 有且仅有一个交点；\n\n- 球的公切面：一个超平面 $P$ 是所有球的切平面。", "inputFormat": "这是一道提交答案题，共有8组输入数据，这些数据命名为 1.in ~ 8.in。\n\n每个测试点中包含多组数据。对于每个测试点：\n\n- 第一行：测试点包含的数据组数 $T$，保证 $T\\le10$。\n- 对于每组数据：\n\t- 第一行：坐标维数 $K$，保证 $2\\le K\\le10$。\n\t- 接下来 $K$ 行，每行 $K+1$ 个实数。第 $i$ 行的前 $K$ 个数代表第 $i$ 个球的球心所在的坐标，第 $K+1$ 个数代表第 $i$ 个球的半径。", "outputFormat": "对于每组输入数据，你需要提交相应的输出文件 1.out ~ 8.out。\n\n对于每个测试点的每组数据：\n\n- 第一行，一个正整数  $S$，表示在这组数据中你总共找到了 $S$ 组切平面。如果没找到任何一组解，**请务必输出 $0$，否则将会影响后续数据的评分，造成的后果由选手自行承担**；\n- 接下来 $S\\times K$ 行，每行 $K$ 个小数，对于相对的第 $S(i-1)+j$ 行，表示在输出的第 $i$ 个解中，**对应输入**的第 $j$ 个球上的切点坐标；\n- 最后一行，输出一个空行；\n\n**在输出文件的最后，你可以添加任意内容，这不会影响你的得分。我们建议你在此处写一些有意义的内容（如简要方法），以便于我们在考后进行统计分析。单个输出文件大小不得超过 4M。**", "hint": "#### 评分标准\n- 解的输出顺序没有要求。在一组解中，记输出答案为 $A(a_0,a_1,...,a_{K-1})$，如果存在一组标准答案 $B(b_0,b_1,...,b_{K-1})$，满足 $\\sum_{i=0}^{K-1}|A_iB_i|^2\\le10^{-12}$，那么这一组输出答案将会被判定为正确。\n- 在每个测试点的同一组数据中，我们会统计被匹配上的标准答案的公切面的个数，每个标准答案只会被匹配至多一次，输出重复的公切面不倒扣分。第 $i$ 组数据回答正确的比例为被匹配上的标准答案的个数除以标准答案的总个数，记为 $rate_i$。\n- 对于每个测试点的评分方式：\n\t1. 如果你的输出格式不合法，或者参数不符合题目约定，或者某一组的答案个数超过该组标准答案个数的两倍以上（不含两倍），则得0分；\n      1. 在不违背上述条件的情况下，算对其中任何一组数据的任何一个解就至少有一分；并且所有的答案都算对了，才能得\n      1. 在不违背上述条件的情况下，记共有 $T$ 组数据，$rate_i$ 为第 $i$ 组数据回答正确的比例，$score$ 为这个测试点的分值，则 $Yourscore=\\frac{score}{T}\\times\\sum_{i=1}^T\\sqrt{rate_i}$ 在不违背以上原则的情况下四舍五入输出，即 $Yourscore\\in[1,score-1]$。\n各测试点分值不同，具体如下表所示：\n\n| 测试点 | $K\\le$ | 分值 |\n| :----------: | :----------: | :----------: |\n| 1 | $2$ | $5$ |\n| 2 | $2$ | $15$ |\n| 3 | $3$ | $11$ |\n| 4 | $3$ | $14$ |\n| 5 | $3$ | $16$ |\n| 6 | $4$ | $7$ |\n| 7 | $4$ | $9$ |\n| 8 | $10$ | $23$ |\n", "locale": "zh-CN"}}}
{"pid": "P7456", "type": "P", "difficulty": 6, "samples": [["3\naaaaa\na\naa\naaa", "2"], ["5\nabecedadabra\nabec\nab\nceda\ndad\nra", "5"], ["9\nicpcontesticpc\ninternational\ncollegiate\nprogramming\ncontest\ncentral\neurope\nregional\ncontest\nicpc", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["字符串", "2018", "哈希 hashing", "AC 自动机", "KMP 算法", "后缀数组 SA", "ICPC", "CERC"], "title": "[CERC2018] The ABCD Murderer", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [The ABCD Murderer](https://contest.felk.cvut.cz/18cerc/solved/abcd.pdf)**\n\nOscar 特别喜欢看犯罪电影。他钦佩那些罪犯，因为他们富有创造力。他也想展示他的创造力。但很可惜的是，他没什么经验，也想不出来什么原创伎俩。所以他想从已有的招数中寻找灵感。他一直喜欢看罪犯从报纸上剪下字母，然后用这些字母拼勒索信的桥段。然而 Oscar 根本不想抄袭，所以他自己想了一个这种方法的变体。他觉得把字母一个一个拼成文本既无聊又费时间。所以他决定通过剪下一整个单词的方式拼出自己的勒索信。\n\nOscar 买来一些主流报纸，这样他几乎就有了无限的单词库。他可以多次剪出任意特定的单词。然而，他还是被报纸中出现的的单词集限制。问题是一些单词根本没在报纸中出现。为了让这项工作更简单，他决定去除勒索信中所有的标点符号和空格并且忽略字母的大小写。他同时允许剪出的单词互相重叠，只需要重叠部分相同。现在 Oscar 想知道他至少要剪下多少次单词才能拼成他想要的勒索信。", "inputFormat": "第一行包含一个整数 $L$，表示在报纸中发现的单词数；\n\n下一行包含勒索信的内容 $s$。保证内容非空并且只包含小写英文字母。\n\n接下来 $L$ 行，每行包含一个在报纸中出现的单词 $a_i$，保证只出现小写英文字母。这些单词中没有空串，也没有比勒索信长的单词。所有报纸中单词在输入中出现至少一次。", "outputFormat": "输出 Oscar 最少要从报纸中剪下多少次单词才能组成勒索信、如果不能组成，输出 $-1$ 。每个单词都要被记实际从报纸剪下那么多次。", "hint": "$1≤L,|s|,∑|a_i|≤3×10^5$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CERC2018] The ABCD Murderer", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [The ABCD Murderer](https://contest.felk.cvut.cz/18cerc/solved/abcd.pdf)**\n\nOscar 特别喜欢看犯罪电影。他钦佩那些罪犯，因为他们富有创造力。他也想展示他的创造力。但很可惜的是，他没什么经验，也想不出来什么原创伎俩。所以他想从已有的招数中寻找灵感。他一直喜欢看罪犯从报纸上剪下字母，然后用这些字母拼勒索信的桥段。然而 Oscar 根本不想抄袭，所以他自己想了一个这种方法的变体。他觉得把字母一个一个拼成文本既无聊又费时间。所以他决定通过剪下一整个单词的方式拼出自己的勒索信。\n\nOscar 买来一些主流报纸，这样他几乎就有了无限的单词库。他可以多次剪出任意特定的单词。然而，他还是被报纸中出现的的单词集限制。问题是一些单词根本没在报纸中出现。为了让这项工作更简单，他决定去除勒索信中所有的标点符号和空格并且忽略字母的大小写。他同时允许剪出的单词互相重叠，只需要重叠部分相同。现在 Oscar 想知道他至少要剪下多少次单词才能拼成他想要的勒索信。", "inputFormat": "第一行包含一个整数 $L$，表示在报纸中发现的单词数；\n\n下一行包含勒索信的内容 $s$。保证内容非空并且只包含小写英文字母。\n\n接下来 $L$ 行，每行包含一个在报纸中出现的单词 $a_i$，保证只出现小写英文字母。这些单词中没有空串，也没有比勒索信长的单词。所有报纸中单词在输入中出现至少一次。", "outputFormat": "输出 Oscar 最少要从报纸中剪下多少次单词才能组成勒索信、如果不能组成，输出 $-1$ 。每个单词都要被记实际从报纸剪下那么多次。", "hint": "$1≤L,|s|,∑|a_i|≤3×10^5$", "locale": "zh-CN"}}}
{"pid": "P7457", "type": "P", "difficulty": 6, "samples": [["6 15\n0 1 2 1\n2 1 4\n2 1 5\n0 2 3 2\n2 1 4\n2 1 5\n0 3 4 3\n2 1 4\n2 1 5\n0 4 5 4\n2 1 4\n2 1 5\n1 4 5\n2 1 4\n2 1 5", "-1\n-1\n-1\n-1\n3\n-1\n3\n4\n3\n-1"], ["6 6\n0 2 0 4\n0 3 4 3\n0 0 4 1\n0 2 5 4\n2 3 2\n2 4 2", "4\n4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2018", "ICPC", "线段树分治", "CERC"], "title": "[CERC2018] The Bridge on the River Kawaii", "background": null, "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/)[ The Bridge on the River Kawaii](https://contest.felk.cvut.cz/18cerc/solved/bridge.pdf)**\n\n在遥远的 Midsommer ，有一条叫 delta 的小河，河里无法游泳。这条河周围有一些小岛，小岛之间有桥连接。每座桥都有一个危险系数，表示通过这座桥有多危险。危险系数越高，通过这座桥就越危险。\n\n一位叫做 Richard Hradecki 的侦探兼悬疑小说作家追查案件时需要经过这些桥。每次追查案件，他会在所有可能的路径中选择最安全的一条，也就是经过桥的最大危险系数最低的一条路径。\n\n每次调查案件时，Richard 会从一个岛屿前往要调查的岛屿。他希望你帮他找到最安全的路径。同时，桥的存在情况也会变化。具体的，你需要处理以下三种事件：\n- 当地人在两座岛屿之间建了一座新桥；\n- 一只酸性的毛茸茸的大粉熊 Lug 摧毁了一座桥；\n- Richard 要求你找两个岛屿之间最安全的路线。", "inputFormat": "第一行包含两个整数 $N,Q$。$N$  是岛屿数（岛屿用 $0…N-1$ 标号），$Q$ 是需要处理的事件数。\n\n接下来 $Q$ 行，每行表示一个事件，包含三或四个整数，说明如下（保证 $X,Y$ 为两个不相同的合法的岛屿）：\n\n- `0 X Y V`：在 $X$ 岛与 $Y$ 岛之间建成一座危险系数为 $V$ 的桥；\n- `1 X Y`：连接 $X,Y$ 两岛的桥被摧毁；\n- `2 X Y`：Richard 询问从 $X$ 到 $Y$ 的最安全路径。\n\n保证任意两个岛屿之间最多只存在一座直达的桥，且每次要被摧毁的桥在被摧毁前是存在的（即，保证输入数据合法）。", "outputFormat": "对于每个种类为 $2$ 的事件，输出 $X$ 到 $Y$ 最安全路径上经过的最危险的桥的危险系数。如果 $X$ 与 $Y$ 之间没有路径，输出 $-1$。", "hint": "$2\\le N\\le 10^5,1\\le Q\\le 10^5,0\\le V\\le 10,0\\le X,Y<N,X\\neq Y$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CERC2018] The Bridge on the River Kawaii", "background": null, "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/)[ The Bridge on the River Kawaii](https://contest.felk.cvut.cz/18cerc/solved/bridge.pdf)**\n\n在遥远的 Midsommer ，有一条叫 delta 的小河，河里无法游泳。这条河周围有一些小岛，小岛之间有桥连接。每座桥都有一个危险系数，表示通过这座桥有多危险。危险系数越高，通过这座桥就越危险。\n\n一位叫做 Richard Hradecki 的侦探兼悬疑小说作家追查案件时需要经过这些桥。每次追查案件，他会在所有可能的路径中选择最安全的一条，也就是经过桥的最大危险系数最低的一条路径。\n\n每次调查案件时，Richard 会从一个岛屿前往要调查的岛屿。他希望你帮他找到最安全的路径。同时，桥的存在情况也会变化。具体的，你需要处理以下三种事件：\n- 当地人在两座岛屿之间建了一座新桥；\n- 一只酸性的毛茸茸的大粉熊 Lug 摧毁了一座桥；\n- Richard 要求你找两个岛屿之间最安全的路线。", "inputFormat": "第一行包含两个整数 $N,Q$。$N$  是岛屿数（岛屿用 $0…N-1$ 标号），$Q$ 是需要处理的事件数。\n\n接下来 $Q$ 行，每行表示一个事件，包含三或四个整数，说明如下（保证 $X,Y$ 为两个不相同的合法的岛屿）：\n\n- `0 X Y V`：在 $X$ 岛与 $Y$ 岛之间建成一座危险系数为 $V$ 的桥；\n- `1 X Y`：连接 $X,Y$ 两岛的桥被摧毁；\n- `2 X Y`：Richard 询问从 $X$ 到 $Y$ 的最安全路径。\n\n保证任意两个岛屿之间最多只存在一座直达的桥，且每次要被摧毁的桥在被摧毁前是存在的（即，保证输入数据合法）。", "outputFormat": "对于每个种类为 $2$ 的事件，输出 $X$ 到 $Y$ 最安全路径上经过的最危险的桥的危险系数。如果 $X$ 与 $Y$ 之间没有路径，输出 $-1$。", "hint": "$2\\le N\\le 10^5,1\\le Q\\le 10^5,0\\le V\\le 10,0\\le X,Y<N,X\\neq Y$", "locale": "zh-CN"}}}
{"pid": "P7458", "type": "P", "difficulty": 3, "samples": [["1010", "1"], ["100110000", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2018", "ICPC", "CERC"], "title": "[CERC2018] Clockwork ||ange", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [Clockwork ||ange](https://contest.felk.cvut.cz/18cerc/solved/clockwork.pdf)**\n\n据百度百科，兔是哺乳类兔形目兔科下属所有的属的总称。毋庸置疑的是，这段文字不是无聊的，因为它们是原始的，并且组织良好。我们农场的兔子生活在有保护的畜栏里，畜栏的边界装饰有精美的花卉装饰品。畜栏里生长着数十个可爱的橙色胡萝卜。兔子繁殖很快（这很正常，每年都有成千上万的兔子出生），我们的导师希望不费力地把它们安置在畜栏里。\n\n畜栏规则地形成一排。在第一个繁殖季开始时，一些畜栏里可能没有兔子。每个繁殖季结束时，都会进行一次精心策划过的兔子搬迁。搬迁遵循一条简单的公式，这个公式取决于一个正整数 $K$，不同的繁殖季 $K$ 值不一定相同。对于所有畜栏，搬迁工作同时进行。在每个畜栏中，大约有一半的兔子被移到这个畜栏右边第 $K$ 个畜栏里。目标畜栏里原来有没有兔子都没有关系。\n\n如果畜栏离这一排最后一个畜栏太近（即离最后一个畜栏的距离小于 $K$ ），那么这个畜栏中的所有兔子都留在原畜栏，不会进行搬迁。\n\n每个畜栏都可以容纳无限只兔子，并且非空的畜栏中总有足够多能够成功繁殖的兔子。\n\n给定第一个繁殖季开始时畜栏被占用的情况。请求出使得所有畜栏中都有兔子的最少搬迁次数。", "inputFormat": "输入仅有一行，包含一个长度为 $b$ 的字符串，每个字符表示一个畜栏。字符只有 $0$（空畜栏）和 $1$（有兔子的畜栏）两种。第一个字符表示这一排的第一个畜栏。", "outputFormat": "输出使得所有畜栏中都有兔子的最少搬迁次数。如果没有任何一种搬迁方案使得每个畜栏中都有兔子，输出 $-1$。", "hint": "$1≤b≤40$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CERC2018] Clockwork ||ange", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [Clockwork ||ange](https://contest.felk.cvut.cz/18cerc/solved/clockwork.pdf)**\n\n据百度百科，兔是哺乳类兔形目兔科下属所有的属的总称。毋庸置疑的是，这段文字不是无聊的，因为它们是原始的，并且组织良好。我们农场的兔子生活在有保护的畜栏里，畜栏的边界装饰有精美的花卉装饰品。畜栏里生长着数十个可爱的橙色胡萝卜。兔子繁殖很快（这很正常，每年都有成千上万的兔子出生），我们的导师希望不费力地把它们安置在畜栏里。\n\n畜栏规则地形成一排。在第一个繁殖季开始时，一些畜栏里可能没有兔子。每个繁殖季结束时，都会进行一次精心策划过的兔子搬迁。搬迁遵循一条简单的公式，这个公式取决于一个正整数 $K$，不同的繁殖季 $K$ 值不一定相同。对于所有畜栏，搬迁工作同时进行。在每个畜栏中，大约有一半的兔子被移到这个畜栏右边第 $K$ 个畜栏里。目标畜栏里原来有没有兔子都没有关系。\n\n如果畜栏离这一排最后一个畜栏太近（即离最后一个畜栏的距离小于 $K$ ），那么这个畜栏中的所有兔子都留在原畜栏，不会进行搬迁。\n\n每个畜栏都可以容纳无限只兔子，并且非空的畜栏中总有足够多能够成功繁殖的兔子。\n\n给定第一个繁殖季开始时畜栏被占用的情况。请求出使得所有畜栏中都有兔子的最少搬迁次数。", "inputFormat": "输入仅有一行，包含一个长度为 $b$ 的字符串，每个字符表示一个畜栏。字符只有 $0$（空畜栏）和 $1$（有兔子的畜栏）两种。第一个字符表示这一排的第一个畜栏。", "outputFormat": "输出使得所有畜栏中都有兔子的最少搬迁次数。如果没有任何一种搬迁方案使得每个畜栏中都有兔子，输出 $-1$。", "hint": "$1≤b≤40$", "locale": "zh-CN"}}}
{"pid": "P7459", "type": "P", "difficulty": 5, "samples": [["1 2 160 20 6 40", "31.92569589"], ["1 2 160 10 6 40", "21.65591118"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2018", "Special Judge", "ICPC", "CERC"], "title": "[CERC2018] Reservoir Dog", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [Reservoir Dog](https://contest.felk.cvut.cz/18cerc/solved/dog.pdf)**\n\n你带你的狗来到你家旁边的一个水库玩。你的狗喜欢玩飞盘，但因为你已经厌烦和你的狗玩飞盘了，所以你很好奇从你扔出飞盘到你的狗捡回飞盘回到你这里的总共用时。所以你把狗牵到你身边，然后开始计时。$T_f$ 毫秒这个时刻，你从高度 $H_f$ 毫米的位置以 $V_f$ 毫米每毫秒的初速度水平丢出飞盘。由于重力，在竖直方向对飞盘的加速度为 $1$ 毫米每二次方毫秒。\n\n在 $T_d$ 毫秒这个时刻，你释放了狗，狗的水平速度最大为 $V_d$ 。狗跑在一个理想平面上，并且它足够聪明，知道如何最小化接飞盘并把它带回你这里的时间。为了达到这个目的，狗可以跳 $H_d$ 毫米高，竖直起跳不影响水平速度。狗接到飞盘后，它就会立刻全速跑向你。当狗跑回你的位置时，你停止计时。注意即使你的狗在空中也要停止计时，也就是说狗位于初始位置上方的时候也停止计时。\n\n你的狗很特殊，因为它可以瞬间获得水平速度（无加速或减速过程的），并且即使在空中也可以改变水平速度大小或反转水平速度方向。由于重力，在竖直方向对你的狗的加速度为 $3$ 毫米每二次方毫秒。\n\n为了简便，假设飞盘和你的狗的大小不计。并且本题中可能用到物体位移公式 $s(t)=s_0+v_0t+0.5at^2$，当然如何使用取决于你。", "inputFormat": "输入包含一行六个整数 $T_f,V_f,H_f,T_d,V_d,H_d$。", "outputFormat": "输出你测得的时间（单位：毫秒），如果你的答案与标准答案的绝对误差不超过 $10^{-4}$ 即视为正确。", "hint": "$1≤T_f;V_f,H_f,T_d,V_d,H_d≤10^6,H_d<H_f,T_f<T_d$\n\nClarifications\n\nQ：狗的跳跃过程是怎样的？\n\nA：狗瞬间获得能够跳到 $H_d$ 高度的竖直速度。\n\nQ：当飞盘落在地面上时会继续运动吗？\n\nA：当飞盘落在地面上时瞬间停止运动。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CERC2018] Reservoir Dog", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [Reservoir Dog](https://contest.felk.cvut.cz/18cerc/solved/dog.pdf)**\n\n你带你的狗来到你家旁边的一个水库玩。你的狗喜欢玩飞盘，但因为你已经厌烦和你的狗玩飞盘了，所以你很好奇从你扔出飞盘到你的狗捡回飞盘回到你这里的总共用时。所以你把狗牵到你身边，然后开始计时。$T_f$ 毫秒这个时刻，你从高度 $H_f$ 毫米的位置以 $V_f$ 毫米每毫秒的初速度水平丢出飞盘。由于重力，在竖直方向对飞盘的加速度为 $1$ 毫米每二次方毫秒。\n\n在 $T_d$ 毫秒这个时刻，你释放了狗，狗的水平速度最大为 $V_d$ 。狗跑在一个理想平面上，并且它足够聪明，知道如何最小化接飞盘并把它带回你这里的时间。为了达到这个目的，狗可以跳 $H_d$ 毫米高，竖直起跳不影响水平速度。狗接到飞盘后，它就会立刻全速跑向你。当狗跑回你的位置时，你停止计时。注意即使你的狗在空中也要停止计时，也就是说狗位于初始位置上方的时候也停止计时。\n\n你的狗很特殊，因为它可以瞬间获得水平速度（无加速或减速过程的），并且即使在空中也可以改变水平速度大小或反转水平速度方向。由于重力，在竖直方向对你的狗的加速度为 $3$ 毫米每二次方毫秒。\n\n为了简便，假设飞盘和你的狗的大小不计。并且本题中可能用到物体位移公式 $s(t)=s_0+v_0t+0.5at^2$，当然如何使用取决于你。", "inputFormat": "输入包含一行六个整数 $T_f,V_f,H_f,T_d,V_d,H_d$。", "outputFormat": "输出你测得的时间（单位：毫秒），如果你的答案与标准答案的绝对误差不超过 $10^{-4}$ 即视为正确。", "hint": "$1≤T_f;V_f,H_f,T_d,V_d,H_d≤10^6,H_d<H_f,T_f<T_d$\n\nClarifications\n\nQ：狗的跳跃过程是怎样的？\n\nA：狗瞬间获得能够跳到 $H_d$ 高度的竖直速度。\n\nQ：当飞盘落在地面上时会继续运动吗？\n\nA：当飞盘落在地面上时瞬间停止运动。", "locale": "zh-CN"}}}
{"pid": "P7460", "type": "P", "difficulty": 0, "samples": [["5\n0 1\n1 2\n2 3\n3 4\n0 0\n9 9\n2 3\n3 2\n7 8", "0 3\n3 1\n1 4\n4 2"], ["3\n1 2\n0 2\n0 0\n1 1\n2 3", "0 1\n1 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2018", "ICPC", "CERC"], "title": "[CERC2018] Trees Gump", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [Trees Gump](https://contest.felk.cvut.cz/18cerc/solved/gump.pdf)**\n\n在 Jumbarian 雨林中，大树的战略地位十分重要。Jumbarian 军队的首领选择了互相距离较近的 $N$ 棵树，并决定这 $N$ 棵树上每棵都要建一个树屋，并安排一支军队。人和材料在树与树之间的运输要依靠双向连接的索道。出于安全因素考虑，从卫星上看任意两条索道之间都没有交叉。\n\n现在已经选出了 $N$ 支军队，并且已经列出了两支军队为一对的清单。在同一对的两支军队应当在同一条索道的两端操控这条索道。军队对数比军队数少一，这就表明这一区域的连通性是有保证的。即，在分配军队后，每一支军队都可以只经过列表中出现的索道到达任意地方。\n\n剩余的工作就是如何在树顶安装索道，才能使得可以按上面的规则安排军队。", "inputFormat": "第一行包含一个整数 $N$，表示树顶数和军队数。树顶和军队都用 $0…N-1$ 编号；\n\n接下来 $N-1$ 行，每行两个整数，表示这两支军队应在同一条索道两端；\n\n接下来 $N$ 行给出每个树顶的坐标，第 $i+1$ 行包含两个数 $X_i,Y_i$，表示第 $i$ 棵树的坐标。任意三棵树不会在同一条直线上。", "outputFormat": "输出 $N-1$ 行，表示安装索道的方案，每行输出两个数 $x,y$，表示 $x,y$ 两棵树之间建一条索道。\n\n如果有多组解满足题目要求，可以输出任意一组。", "hint": "$1≤N≤10^3,0≤X_i,Y_i≤10^9$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CERC2018] Trees Gump", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [Trees Gump](https://contest.felk.cvut.cz/18cerc/solved/gump.pdf)**\n\n在 Jumbarian 雨林中，大树的战略地位十分重要。Jumbarian 军队的首领选择了互相距离较近的 $N$ 棵树，并决定这 $N$ 棵树上每棵都要建一个树屋，并安排一支军队。人和材料在树与树之间的运输要依靠双向连接的索道。出于安全因素考虑，从卫星上看任意两条索道之间都没有交叉。\n\n现在已经选出了 $N$ 支军队，并且已经列出了两支军队为一对的清单。在同一对的两支军队应当在同一条索道的两端操控这条索道。军队对数比军队数少一，这就表明这一区域的连通性是有保证的。即，在分配军队后，每一支军队都可以只经过列表中出现的索道到达任意地方。\n\n剩余的工作就是如何在树顶安装索道，才能使得可以按上面的规则安排军队。", "inputFormat": "第一行包含一个整数 $N$，表示树顶数和军队数。树顶和军队都用 $0…N-1$ 编号；\n\n接下来 $N-1$ 行，每行两个整数，表示这两支军队应在同一条索道两端；\n\n接下来 $N$ 行给出每个树顶的坐标，第 $i+1$ 行包含两个数 $X_i,Y_i$，表示第 $i$ 棵树的坐标。任意三棵树不会在同一条直线上。", "outputFormat": "输出 $N-1$ 行，表示安装索道的方案，每行输出两个数 $x,y$，表示 $x,y$ 两棵树之间建一条索道。\n\n如果有多组解满足题目要求，可以输出任意一组。", "hint": "$1≤N≤10^3,0≤X_i,Y_i≤10^9$", "locale": "zh-CN"}}}
{"pid": "P7461", "type": "P", "difficulty": 0, "samples": [["6\n8 2\n6 8\n4 9\n3 5\n3 0\n1 5", "4 1 4"], ["6\n1 1\n6 1\n1 6\n6 6\n3 2\n4 5", "4 2 6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2018", "ICPC", "CERC"], "title": "[CERC2018] Incredible Hull", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [Incredible Hull](https://contest.felk.cvut.cz/18cerc/solved/hull.pdf)**\n\n在一个皇家赌场中，有一个放有很多老虎机的大房间。赌场老板感觉这个房间结构太简单，这样的话赌徒就有很大机会在没输掉那么多钱之前就离开房间。房间结构需要是固定的，因此老板设计了一个复杂的老虎机摆放和过道设计方式，这样的话人们就更容易在里面迷路了。\n\n房间的形状大致是椭圆形的。如果房间是空的，从房间内部的任何点看，整个房间都可以被看到。房间中的 $N$ 台老虎机每台都可以看做一个点，并且每台都有一个特殊的利润值，每两台老虎机利润值互不相同。老板想要这些老虎机通过过道按下面的方式连通。\n\n已经至少有三台老虎机被建在房间的墙里了，所有这些建在墙里的老虎机必须用直的过道直接相连，以形成一个围绕整个屋子并且闭合的周长路径。房间里剩下的老虎机都在这个闭合的周长路径内部。\n\n这个房间要被直过道分成更小的区域，每个区域都被它自己的周长路径包围。分割古城分成以下两步。\n\n- 第一步操作如下。如果在周长路径上有至少四台老虎机，就要选出两台老虎机作为枢纽。第一台是在周长路径上收益最多的那台老虎机；第二台也在周长路径上，并且距离第一台枢纽老虎机最远。两台老虎机之间的距离用周长路径描述，它等于从一台老虎机到另一台老虎机所经过的过道条数。如果有两台最远的老虎机，那么第二台枢纽老虎机为收益最大的老虎机。周长路径内部的区域被一条连接着这两台枢纽老虎机的过道分成两部分。这两个新形成的小区域的周长路径是包围着这片区域的原周长路径和这条新过道。这个过程重复进行，直到不能新建出新的区域为止；\n- 当前一个过程结束后，第二个分割过程开始。这个过程操作如下。对于任意内部没有过道的区域 $A$，考虑在那个区域内部的所有老虎机。如果有，就在收益最多的那台老虎机与所有在 $A$ 的周长路径 $P_A$ 上的老虎机之间建一条过道。这就将这个区域分割成了一些小区域。每个新区域的周长路径包含 $P_A$ 中的一条过道和两条新建的过道。这个过程重复进行，直到不能新建出新的区域为止。\n赌场老板想要估计他的设计的利润能力。为了计算，他定义了一个所谓的高收益配置。这个配置是一个最大的老虎机的集合，属于集合的任意两台老虎机都被一条过道直接相连。\n\n这个老板对三个盈利参数十分感兴趣。第一个盈利参数是一个高收益配置的大小，第二个参数是这个设计里高收益配置的个数，第三个参数是至少属于一个高收益配置的老虎机个数。", "inputFormat": "第一行包含一个整数 $N$ ，表示老虎机数目。\n\n接下来 $N$ 行，每行两个整数 $X,Y$，表示一台老虎机在房间里的位置。所有老虎机按利润值递减的顺序给出，没有任何三台老虎机共线。", "outputFormat": "输出三个盈利参数。", "hint": "$3≤N≤10^5,0≤X,Y≤10^9$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CERC2018] Incredible Hull", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [Incredible Hull](https://contest.felk.cvut.cz/18cerc/solved/hull.pdf)**\n\n在一个皇家赌场中，有一个放有很多老虎机的大房间。赌场老板感觉这个房间结构太简单，这样的话赌徒就有很大机会在没输掉那么多钱之前就离开房间。房间结构需要是固定的，因此老板设计了一个复杂的老虎机摆放和过道设计方式，这样的话人们就更容易在里面迷路了。\n\n房间的形状大致是椭圆形的。如果房间是空的，从房间内部的任何点看，整个房间都可以被看到。房间中的 $N$ 台老虎机每台都可以看做一个点，并且每台都有一个特殊的利润值，每两台老虎机利润值互不相同。老板想要这些老虎机通过过道按下面的方式连通。\n\n已经至少有三台老虎机被建在房间的墙里了，所有这些建在墙里的老虎机必须用直的过道直接相连，以形成一个围绕整个屋子并且闭合的周长路径。房间里剩下的老虎机都在这个闭合的周长路径内部。\n\n这个房间要被直过道分成更小的区域，每个区域都被它自己的周长路径包围。分割古城分成以下两步。\n\n- 第一步操作如下。如果在周长路径上有至少四台老虎机，就要选出两台老虎机作为枢纽。第一台是在周长路径上收益最多的那台老虎机；第二台也在周长路径上，并且距离第一台枢纽老虎机最远。两台老虎机之间的距离用周长路径描述，它等于从一台老虎机到另一台老虎机所经过的过道条数。如果有两台最远的老虎机，那么第二台枢纽老虎机为收益最大的老虎机。周长路径内部的区域被一条连接着这两台枢纽老虎机的过道分成两部分。这两个新形成的小区域的周长路径是包围着这片区域的原周长路径和这条新过道。这个过程重复进行，直到不能新建出新的区域为止；\n- 当前一个过程结束后，第二个分割过程开始。这个过程操作如下。对于任意内部没有过道的区域 $A$，考虑在那个区域内部的所有老虎机。如果有，就在收益最多的那台老虎机与所有在 $A$ 的周长路径 $P_A$ 上的老虎机之间建一条过道。这就将这个区域分割成了一些小区域。每个新区域的周长路径包含 $P_A$ 中的一条过道和两条新建的过道。这个过程重复进行，直到不能新建出新的区域为止。\n赌场老板想要估计他的设计的利润能力。为了计算，他定义了一个所谓的高收益配置。这个配置是一个最大的老虎机的集合，属于集合的任意两台老虎机都被一条过道直接相连。\n\n这个老板对三个盈利参数十分感兴趣。第一个盈利参数是一个高收益配置的大小，第二个参数是这个设计里高收益配置的个数，第三个参数是至少属于一个高收益配置的老虎机个数。", "inputFormat": "第一行包含一个整数 $N$ ，表示老虎机数目。\n\n接下来 $N$ 行，每行两个整数 $X,Y$，表示一台老虎机在房间里的位置。所有老虎机按利润值递减的顺序给出，没有任何三台老虎机共线。", "outputFormat": "输出三个盈利参数。", "hint": "$3≤N≤10^5,0≤X,Y≤10^9$", "locale": "zh-CN"}}}
{"pid": "P7462", "type": "P", "difficulty": 5, "samples": [["6\n0 4 4 6 6\n0 6 6 7 8\n0 1 3 3 3\n1 1 7 6 1\n1 5 4 6 8\n1 4 5 1 3", "0\n1\n0"], ["3\n0 1 1 1 1\n0 1 2 1 2\n1 1 1 1 2", "1"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2018", "并查集", "广度优先搜索 BFS", "ICPC", "CERC"], "title": "[CERC2018] Shooter Island", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [Shooter Island](https://contest.felk.cvut.cz/18cerc/solved/island.pdf)**\n\n你最近被提拔成上尉，现在你正带着你的士兵在暴风雪中执行一项特别任务。战场有点特别，因为它位于北极圈内的一个巨型冰盖上。你需要和总部协调行动。总部有很多高端的计算机协助你获得战场的最新状态。AI 接口将战场建模为一个网格。每个单元格被它所处行列号唯一确定。由单元格组成的大一些的矩形用对角线顶点的单元格对表示。最初，所有单元格被冰覆盖。\n\n你可以从计算机端接收到两种信息：\n\n1. 关于打击的信息（$t=0$）：你的敌人打击了被单元格 $[x_1,y_1]$ 和 $[x_2,y_2]$ 描述的矩形区域，然后这个矩形区域就被冰冷的北冰洋海水淹没了；\n1. 来自你士兵的询问（$t=1$）：他们问是否可以乘船从 $[x_1,y_1]$ 航行到 $[x_2,y_2]$。这条船可以用一个半径为 $0.31416$ 的圆表示。注意船体全部必须一直浮在水上，并且它不能离开战场区域。\n\n你的士兵需要你的帮助！你能可靠地引导他们完成任务吗？", "inputFormat": "输入第一行包含一个整数 $L$，表示接下来的行数。\n\n接下来 $L$ 行，每行五个整数 $t,x_1,y_1,x_2,y_2$，$t$是信息的类型，$[x_1,y_1]，[x_2,y_2]$表示各自的单元格。", "outputFormat": "对于每个查询，如果可以从 $[x_1,y_1]$ 乘船到达 $[x_2,y_2]$，则输出 $1$，否则输出 $0$。", "hint": "样例输入 1 如下图所示：\n\n![#1](https://cdn.luogu.com.cn/upload/image_hosting/bdhw5j2p.png)\n\n$1 \\leq L \\leq 2 \\times 10^5,t \\in \\{0, 1\\}, 1 \\leq x_1, x_2 \\leq 50, 1 \\leq y_1, y_2 \\leq 10^5$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CERC2018] Shooter Island", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [Shooter Island](https://contest.felk.cvut.cz/18cerc/solved/island.pdf)**\n\n你最近被提拔成上尉，现在你正带着你的士兵在暴风雪中执行一项特别任务。战场有点特别，因为它位于北极圈内的一个巨型冰盖上。你需要和总部协调行动。总部有很多高端的计算机协助你获得战场的最新状态。AI 接口将战场建模为一个网格。每个单元格被它所处行列号唯一确定。由单元格组成的大一些的矩形用对角线顶点的单元格对表示。最初，所有单元格被冰覆盖。\n\n你可以从计算机端接收到两种信息：\n\n1. 关于打击的信息（$t=0$）：你的敌人打击了被单元格 $[x_1,y_1]$ 和 $[x_2,y_2]$ 描述的矩形区域，然后这个矩形区域就被冰冷的北冰洋海水淹没了；\n1. 来自你士兵的询问（$t=1$）：他们问是否可以乘船从 $[x_1,y_1]$ 航行到 $[x_2,y_2]$。这条船可以用一个半径为 $0.31416$ 的圆表示。注意船体全部必须一直浮在水上，并且它不能离开战场区域。\n\n你的士兵需要你的帮助！你能可靠地引导他们完成任务吗？", "inputFormat": "输入第一行包含一个整数 $L$，表示接下来的行数。\n\n接下来 $L$ 行，每行五个整数 $t,x_1,y_1,x_2,y_2$，$t$是信息的类型，$[x_1,y_1]，[x_2,y_2]$表示各自的单元格。", "outputFormat": "对于每个查询，如果可以从 $[x_1,y_1]$ 乘船到达 $[x_2,y_2]$，则输出 $1$，否则输出 $0$。", "hint": "样例输入 1 如下图所示：\n\n![#1](https://cdn.luogu.com.cn/upload/image_hosting/bdhw5j2p.png)\n\n$1 \\leq L \\leq 2 \\times 10^5,t \\in \\{0, 1\\}, 1 \\leq x_1, x_2 \\leq 50, 1 \\leq y_1, y_2 \\leq 10^5$", "locale": "zh-CN"}}}
{"pid": "P7463", "type": "P", "difficulty": 6, "samples": [["3 3\n3 1 K\n2\n1 1\n1 3", "3"], ["3 3\n3 1 Q\n2\n1 1\n1 3", "2"], ["5 5\n4 4 R\n4\n1 2\n2 1\n2 5\n5 1", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2018", "ICPC", "CERC"], "title": "[CERC2018] The Lord of the Kings", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [The Lord of the Kings](https://contest.felk.cvut.cz/18cerc/solved/king.pdf)**\n\n在多年与海外国家的战争后，我们的国家终于成功去除了大多数反动势力和敌人。如此光辉的胜利应该被长时间记住并庆祝。因此，我们的国王宣布将胜利日这一天定为一个公共节日，并且要举行胜利游行。在游行中，军队会跟着国王从他的宫殿出发，访问国家里的每个城市。\n\n国王和他的随从将一种环保的电动直升机作为交通工具。这种直升机有一个缺点，就是它的航程较短。国王让你和你的顾问在一些农场和所有城市中修建停机坪，使得从他的宫殿出发，经过一些停机坪后都可以到达任何城市。然而，建停机坪和基础设施都很费钱。所以要最小化最小化停机坪的修建数量。\n\n此外，由于直升机特殊的设计，国王和他的士兵需要以特殊的方式移动，这就会影响停机坪的数量和位置。\n\n给你一张这个国家的矩形网格地图，其中包含代表村庄，城市和宫殿的网格。同时，也给你了直升机的移动方式——与国际象棋中「车（Rook）」、「后（Queen）」、「象（Bishop）」、「马（Knight）」或「王（King）」之一的移动方式一样（每种棋子的详细移动方式见「数据范围与提示」）。你的任务是求出最少需要在多少农场或城市修停机坪才能够满足国王的需求。国王的宫殿中已经修建了停机坪，因此不需要修一个新的了。", "inputFormat": "第一行包含两个整数 $N,M$，表示我们的国家有 $N$ 行 $M$ 列；\n\n第二行两个整数 $X,Y$，表示国王宫殿的位置，接着一个字符，表示移动方式（R——车，Q——后，B——象，N——马，K——王）；\n\n第三行包含一个整数 $T$，表示国家里的城市数；\n\n接下来 $T$ 行，每行包含两个整数 $W,Z$，表示一个城市的位置。所有城市都在不同的网格中，没有城市和宫殿位于同一格。所有既不代表城市也不代表宫殿的格子都是农场。", "outputFormat": "输出一行一个整数，表示至少要修建多少停机坪。如果不可能使得国王和他的士兵能够到达每一个城市，输出 $-1$。", "hint": "$1 ≤ N, M ≤ 15,1 ≤ T ≤ 10, 1 ≤ X ,W ≤ N,1≤Y, Z≤M$\n\n下图为直升机的运输方式（同国际象棋对应棋子的行棋规则）：\n![#1](https://cdn.luogu.com.cn/upload/image_hosting/ip5cnfsa.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CERC2018] The Lord of the Kings", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [The Lord of the Kings](https://contest.felk.cvut.cz/18cerc/solved/king.pdf)**\n\n在多年与海外国家的战争后，我们的国家终于成功去除了大多数反动势力和敌人。如此光辉的胜利应该被长时间记住并庆祝。因此，我们的国王宣布将胜利日这一天定为一个公共节日，并且要举行胜利游行。在游行中，军队会跟着国王从他的宫殿出发，访问国家里的每个城市。\n\n国王和他的随从将一种环保的电动直升机作为交通工具。这种直升机有一个缺点，就是它的航程较短。国王让你和你的顾问在一些农场和所有城市中修建停机坪，使得从他的宫殿出发，经过一些停机坪后都可以到达任何城市。然而，建停机坪和基础设施都很费钱。所以要最小化最小化停机坪的修建数量。\n\n此外，由于直升机特殊的设计，国王和他的士兵需要以特殊的方式移动，这就会影响停机坪的数量和位置。\n\n给你一张这个国家的矩形网格地图，其中包含代表村庄，城市和宫殿的网格。同时，也给你了直升机的移动方式——与国际象棋中「车（Rook）」、「后（Queen）」、「象（Bishop）」、「马（Knight）」或「王（King）」之一的移动方式一样（每种棋子的详细移动方式见「数据范围与提示」）。你的任务是求出最少需要在多少农场或城市修停机坪才能够满足国王的需求。国王的宫殿中已经修建了停机坪，因此不需要修一个新的了。", "inputFormat": "第一行包含两个整数 $N,M$，表示我们的国家有 $N$ 行 $M$ 列；\n\n第二行两个整数 $X,Y$，表示国王宫殿的位置，接着一个字符，表示移动方式（R——车，Q——后，B——象，N——马，K——王）；\n\n第三行包含一个整数 $T$，表示国家里的城市数；\n\n接下来 $T$ 行，每行包含两个整数 $W,Z$，表示一个城市的位置。所有城市都在不同的网格中，没有城市和宫殿位于同一格。所有既不代表城市也不代表宫殿的格子都是农场。", "outputFormat": "输出一行一个整数，表示至少要修建多少停机坪。如果不可能使得国王和他的士兵能够到达每一个城市，输出 $-1$。", "hint": "$1 ≤ N, M ≤ 15,1 ≤ T ≤ 10, 1 ≤ X ,W ≤ N,1≤Y, Z≤M$\n\n下图为直升机的运输方式（同国际象棋对应棋子的行棋规则）：\n![#1](https://cdn.luogu.com.cn/upload/image_hosting/ip5cnfsa.png)", "locale": "zh-CN"}}}
{"pid": "P7464", "type": "P", "difficulty": 3, "samples": [["5\n5\n6\n10\n30\n666", "0\n1\n3\n26\n2406"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2018", "ICPC", "CERC"], "title": "[CERC2018] The Silence of the Lamps", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [The Silence of the Lamps](https://contest.felk.cvut.cz/18cerc/solved/lamps.pdf)**\n\n在开始之前，如果之前没有见过台灯，那么现在我们把它看做一个用玻璃做的长方体（一个矩形表面的箱子），里面都是煤气。灯的所有边长度都是整数。\n\n曾经，我们的一位讲师曾因破坏路灯而被判刑。他肯定疯了，因为他认为一些路灯向他高声尖叫。\n\n在他的想法里，他遵从一个奇怪的行为模式。他只会认出并且破坏表面不是正方形，并且体积不超过一个给定数值的路灯。后来，在与医生 Clarice 的一次会谈中，他说他非常害怕大型物体和形状过于规则的物体。\n\n你的任务是数出所有满足讲师条件的可能长方体。", "inputFormat": "第一行一个整数 $T$，表示数据组数。\n\n接下来 $T$ 行，每行一个整数 $N$，表示最大可识别的路灯体积。", "outputFormat": "对于每组数据，输出会被破坏的不同路灯个数。", "hint": "$1≤T≤10^5$，$1≤N≤10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CERC2018] The Silence of the Lamps", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [The Silence of the Lamps](https://contest.felk.cvut.cz/18cerc/solved/lamps.pdf)**\n\n在开始之前，如果之前没有见过台灯，那么现在我们把它看做一个用玻璃做的长方体（一个矩形表面的箱子），里面都是煤气。灯的所有边长度都是整数。\n\n曾经，我们的一位讲师曾因破坏路灯而被判刑。他肯定疯了，因为他认为一些路灯向他高声尖叫。\n\n在他的想法里，他遵从一个奇怪的行为模式。他只会认出并且破坏表面不是正方形，并且体积不超过一个给定数值的路灯。后来，在与医生 Clarice 的一次会谈中，他说他非常害怕大型物体和形状过于规则的物体。\n\n你的任务是数出所有满足讲师条件的可能长方体。", "inputFormat": "第一行一个整数 $T$，表示数据组数。\n\n接下来 $T$ 行，每行一个整数 $N$，表示最大可识别的路灯体积。", "outputFormat": "对于每组数据，输出会被破坏的不同路灯个数。", "hint": "$1≤T≤10^5$，$1≤N≤10^6$。", "locale": "zh-CN"}}}
{"pid": "P7465", "type": "P", "difficulty": 4, "samples": [["2 2\nAA\nAd", "1"], ["5 5\n#####\n####.\n###..\n##...\n#....", "60"], ["5 4\nhwwr\neahe\nlroy\nlswo\noaau", "0"], ["5 6\n#girls\n##areb\n#.#est\n#..#!!\n#####!", "7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2018", "ICPC", "CERC"], "title": "[CERC2018] Matrice", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [Matrice](https://contest.felk.cvut.cz/18cerc/solved/matrice.pdf)**\n\n特工 Sue Thomas 和她的儿子正在网格中寻找 trinity。trinity 是一个新词，正如词素 tri 所示，指的是由网格中单元格组成的三角形。\n\n每个 trinity 是一个正方形的单元格区域去除某对角线上方或下方的部分（一个等腰直角三角形，两腰分别与网格两边分别平行）。对角线可以是主对角线（东南-西北方向），也可以是副对角线（西南-东北方向）。一个合法的 trinity 至少包含三个单元格，并且所有单元格中字符都相同。", "inputFormat": "输入的第一行是两个整数 $N,M$，分别表示这个网格的行数和列数。\n\n接下来 $N$ 行每行一个长为 $M$ 的字符串，表示这个网格。", "outputFormat": "输出网格中所有不同合法的 trinity 个数。", "hint": "$1≤N,m≤10^3$，保证输入中出现的字符 ASCII 码在 $33$ 到 $126$ 之间。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CERC2018] Matrice", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [Matrice](https://contest.felk.cvut.cz/18cerc/solved/matrice.pdf)**\n\n特工 Sue Thomas 和她的儿子正在网格中寻找 trinity。trinity 是一个新词，正如词素 tri 所示，指的是由网格中单元格组成的三角形。\n\n每个 trinity 是一个正方形的单元格区域去除某对角线上方或下方的部分（一个等腰直角三角形，两腰分别与网格两边分别平行）。对角线可以是主对角线（东南-西北方向），也可以是副对角线（西南-东北方向）。一个合法的 trinity 至少包含三个单元格，并且所有单元格中字符都相同。", "inputFormat": "输入的第一行是两个整数 $N,M$，分别表示这个网格的行数和列数。\n\n接下来 $N$ 行每行一个长为 $M$ 的字符串，表示这个网格。", "outputFormat": "输出网格中所有不同合法的 trinity 个数。", "hint": "$1≤N,m≤10^3$，保证输入中出现的字符 ASCII 码在 $33$ 到 $126$ 之间。", "locale": "zh-CN"}}}
{"pid": "P7466", "type": "P", "difficulty": 0, "samples": [["2\n2 3 4 2\n2 2 3 3\n1 4 3 4", "1"], ["3\n2 3 5 2\n1 3 1 1\n2 4 4 2\n5 4 6 5", "1"], ["1\n0 0 4 0\n0 4 4 4", "2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2018", "ICPC", "CERC"], "title": "[CERC2018] Mirrority Report", "background": null, "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [Mirrority Report](https://contest.felk.cvut.cz/18cerc/solved/report.pdf)**\n\n在物理课上，每个学生都要完成一个半期作业。你选择做一个实验，探究一种稀有的不稳定粒子的性质，这种粒子名为红色粒子。一个红色粒子永远沿直线传播，直到它被镜子反射。\n\n我们的实验可以看做一些单次反射镜组，这些反射镜可以看成二维平面上能够无限延伸的直线。一面单次反射镜只会在粒子第一次到达时将其反射，并且无论从什么方向入射都可以反射，但在此之后，粒子就只会穿过镜子了。\n\n在反射时，遵循反射定律。如果粒子到达了两面反射镜的交点，这个粒子就会崩解，否则会进行反射。\n\n镜子的摆放方式是你的实验老师设定的，你的任务是求出从一个点出发，有多少种出发的方向会让这个粒子到达一个特定的点。", "inputFormat": "第一行一个整数包含一个非负整数 $N$，表示镜子的个数；\n\n第二行包含四个整数 $S_x,S_y,E_x,E_y$，表示粒子从 $(S_x,S_y)$ 出发，终点是 $(E_x,E_y)$；\n\n接下来 $N$ 行，每行四个整数 $A_x,A_y,B_x,B_y$，表示第 $i$ 面镜子上的两点。\n\n所有输入的坐标值均在 $[-100,100]$ 之间。 起点和终点不同。从起点或终点到任何镜子的距离均不为零。\n\n保证输入中不存在任何一组合法方案使得：粒子在任何可以反射该粒子的反射镜上的入射点到两面镜子的交点间的距离小于 $10^{-4}$。", "outputFormat": "输出一行一个整数，表示从 $(S_x,S_y)$ 出发，有多少种出发的方向会让这个粒子到达 $(E_x,E_y)$。", "hint": "样例 1 如下图：\n\n![#1](https://cdn.luogu.com.cn/upload/image_hosting/kgu6l9nt.png)\n\n样例 2 如下图：\n\n![#2](https://cdn.luogu.com.cn/upload/image_hosting/wxrwuay9.png)\n\n样例 3 如下图：\n\n![#3](https://cdn.luogu.com.cn/upload/image_hosting/bir6zsvn.png)\n\n$0≤N≤8$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CERC2018] Mirrority Report", "background": null, "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [Mirrority Report](https://contest.felk.cvut.cz/18cerc/solved/report.pdf)**\n\n在物理课上，每个学生都要完成一个半期作业。你选择做一个实验，探究一种稀有的不稳定粒子的性质，这种粒子名为红色粒子。一个红色粒子永远沿直线传播，直到它被镜子反射。\n\n我们的实验可以看做一些单次反射镜组，这些反射镜可以看成二维平面上能够无限延伸的直线。一面单次反射镜只会在粒子第一次到达时将其反射，并且无论从什么方向入射都可以反射，但在此之后，粒子就只会穿过镜子了。\n\n在反射时，遵循反射定律。如果粒子到达了两面反射镜的交点，这个粒子就会崩解，否则会进行反射。\n\n镜子的摆放方式是你的实验老师设定的，你的任务是求出从一个点出发，有多少种出发的方向会让这个粒子到达一个特定的点。", "inputFormat": "第一行一个整数包含一个非负整数 $N$，表示镜子的个数；\n\n第二行包含四个整数 $S_x,S_y,E_x,E_y$，表示粒子从 $(S_x,S_y)$ 出发，终点是 $(E_x,E_y)$；\n\n接下来 $N$ 行，每行四个整数 $A_x,A_y,B_x,B_y$，表示第 $i$ 面镜子上的两点。\n\n所有输入的坐标值均在 $[-100,100]$ 之间。 起点和终点不同。从起点或终点到任何镜子的距离均不为零。\n\n保证输入中不存在任何一组合法方案使得：粒子在任何可以反射该粒子的反射镜上的入射点到两面镜子的交点间的距离小于 $10^{-4}$。", "outputFormat": "输出一行一个整数，表示从 $(S_x,S_y)$ 出发，有多少种出发的方向会让这个粒子到达 $(E_x,E_y)$。", "hint": "样例 1 如下图：\n\n![#1](https://cdn.luogu.com.cn/upload/image_hosting/kgu6l9nt.png)\n\n样例 2 如下图：\n\n![#2](https://cdn.luogu.com.cn/upload/image_hosting/wxrwuay9.png)\n\n样例 3 如下图：\n\n![#3](https://cdn.luogu.com.cn/upload/image_hosting/bir6zsvn.png)\n\n$0≤N≤8$", "locale": "zh-CN"}}}
{"pid": "P7467", "type": "P", "difficulty": 5, "samples": [["2 3 4\n2 3", "Petyr"], ["7 8 9\n1 2 3 4 5 6 7", "Varys"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2018", "ICPC", "CERC"], "title": "[CERC2018] Game of Stones", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [Game of Stones](https://contest.felk.cvut.cz/18cerc/solved/stones.pdf)**\n\nPetyr 和 Varys 两个人在玩游戏。游戏中选手从 $N$ 堆石子中轮流取走一些石子。在自己的回合中，Petyr 可以从任意一堆中取走最多 $A$ 个石子，Varys 可以从任意一堆中取走最多 $B$ 个石子。每一轮选手至少要取走一个石子。取走最后一个石子的一方获胜。\n\n游戏已经开始，并且现在 Petyr 要取石子。你的任务是判断在双方均采用最优策略的情况下 Petyr 是否能赢。", "inputFormat": "输入的第一行包含三个整数 $N,A,B$，表示有 $N$ 堆石子和两人的限制。\n\n第二行 $N$ 个数 $X_1,X_2,…,X_N$，表示当前所有堆中石子个数。", "outputFormat": "输出获胜者的名字。", "hint": "$1≤N,A,B,≤10^5,1≤X_i≤10^6$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CERC2018] Game of Stones", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [Game of Stones](https://contest.felk.cvut.cz/18cerc/solved/stones.pdf)**\n\nPetyr 和 Varys 两个人在玩游戏。游戏中选手从 $N$ 堆石子中轮流取走一些石子。在自己的回合中，Petyr 可以从任意一堆中取走最多 $A$ 个石子，Varys 可以从任意一堆中取走最多 $B$ 个石子。每一轮选手至少要取走一个石子。取走最后一个石子的一方获胜。\n\n游戏已经开始，并且现在 Petyr 要取石子。你的任务是判断在双方均采用最优策略的情况下 Petyr 是否能赢。", "inputFormat": "输入的第一行包含三个整数 $N,A,B$，表示有 $N$ 堆石子和两人的限制。\n\n第二行 $N$ 个数 $X_1,X_2,…,X_N$，表示当前所有堆中石子个数。", "outputFormat": "输出获胜者的名字。", "hint": "$1≤N,A,B,≤10^5,1≤X_i≤10^6$", "locale": "zh-CN"}}}
{"pid": "P7468", "type": "P", "difficulty": 7, "samples": [["1000\n3\n3 2 1", "110\n"], ["11111100101\n4\n2 0 2 1", "143901603\n"], ["1001011001101001\n16\n1 0 0 1 0 1 1 0 0 1 1 0 1 0 0 1", "184740992\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2021", "NOI Online"], "title": "[NOI Online 2021 提高组] 愤怒的小 N", "background": "", "description": "极度愤怒的小 N 通关了一款游戏来泄愤。\n\n这款游戏共有 $n$ 关，分别为第 $0$ 关、第 $1$ 关、第 $2$ 关、$\\cdots$、第 $n-1$ 关。这些关卡中有一些是普通关卡，另一些则是奖励关卡。\n\n这款游戏中普通关卡与奖励关卡的分布比较特殊。如果用字符 $\\texttt{a}$ 表示普通关卡，用字符 $\\texttt{b}$ 表示奖励关卡，那么第 $0$ 关、第 $1$ 关、第 $2$ 关、$\\cdots$、第 $n-1$ 关依次排列形成的字符串是一个无穷字符串 $s$ 的前缀，且 $s$ 可以按照如下方式构造：\n\n1. 初始时 $s$ 为包含单个字符 $\\texttt{a}$ 的字符串。\n\n2. 将 $s$ 的每个字符 $\\texttt{a}$ 替换成字符 $\\texttt{b}$，每个字符 $\\texttt{b}$ 替换成字符 $\\texttt{a}$ 得到字符串 $t$，然后将 $t$ 拼接到 $s$ 后。\n3. 不断执行2. 得到的字符串就是最终的 $s$。\n\n可以发现 $s=\\texttt{abbabaabbaababba}\\cdots$，所以这款游戏的第 $0$ 关是普通关卡，第 $1$ 关\n是奖励关卡，第 $2$ 关是奖励关卡，第 $3$ 关是普通关卡，以此类推。\n\n通过游戏的第 $i$ 关可以得到 $f(i)$ 分，其中 $f(x)=a_0+a_1x+a_2x^2+\\cdots+a_{k-1}x^{k-1}$ \n是一个固定的 $k-1$ 次多项式。\n\n小 N 通关时一气之下通过了所有奖励关卡而忽略了所有普通关卡，然后就把游戏卸载了。现在回想起来，他想要知道他在卸载游戏前的总得分对 $10^9+7$ 取模后的结果。", "inputFormat": "第一行一个正整数 $n$，表示游戏的关卡数目。为方便，$n$ 以二进制表示给出。\n\n第二行一个正整数 $k$，表示多项式的次数加一。\n\n第三行 $k$ 个非负整数，分别为 $a_0,a_1,a_2,\\cdots,a_{k-1}$，表示多项式的各项系数。", "outputFormat": "一行一个非负整数，表示小 N 卸载游戏前的总得分对 $10^9 + 7$ 取模后的结果。", "hint": "对于所有测试点：$0\\le \\log_2n<5\\times 10^5$，$1\\le k\\le 500$，$0\\le a_i < 10^9 + 7$，$a_{k-1}\\ne 0。$\n\n| 测试点编号 | $\\log_2n\\le$ | $k\\le$ |\n|:-:|:-:|:-:|\n| $1\\sim2$ | $10$ |$500$ |\n| $3\\sim4$ | $20$ | $500$ |\n| $5\\sim8$ | $100$ | $500$ |\n| $9\\sim10$ | $500$ | $500$ |\n| $11\\sim12$ | $5\\times 10^5$ | $1$ |\n| $13\\sim16$ | $5\\times 10^5$ | $100$ |\n| $17\\sim20$ | $5\\times 10^5$ | $500$ |\n\n感谢 [s_r_f](https://www.luogu.com.cn/user/52518) 提供数据。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI Online 2021 提高组] 愤怒的小 N", "background": "", "description": "极度愤怒的小 N 通关了一款游戏来泄愤。\n\n这款游戏共有 $n$ 关，分别为第 $0$ 关、第 $1$ 关、第 $2$ 关、$\\cdots$、第 $n-1$ 关。这些关卡中有一些是普通关卡，另一些则是奖励关卡。\n\n这款游戏中普通关卡与奖励关卡的分布比较特殊。如果用字符 $\\texttt{a}$ 表示普通关卡，用字符 $\\texttt{b}$ 表示奖励关卡，那么第 $0$ 关、第 $1$ 关、第 $2$ 关、$\\cdots$、第 $n-1$ 关依次排列形成的字符串是一个无穷字符串 $s$ 的前缀，且 $s$ 可以按照如下方式构造：\n\n1. 初始时 $s$ 为包含单个字符 $\\texttt{a}$ 的字符串。\n\n2. 将 $s$ 的每个字符 $\\texttt{a}$ 替换成字符 $\\texttt{b}$，每个字符 $\\texttt{b}$ 替换成字符 $\\texttt{a}$ 得到字符串 $t$，然后将 $t$ 拼接到 $s$ 后。\n3. 不断执行2. 得到的字符串就是最终的 $s$。\n\n可以发现 $s=\\texttt{abbabaabbaababba}\\cdots$，所以这款游戏的第 $0$ 关是普通关卡，第 $1$ 关\n是奖励关卡，第 $2$ 关是奖励关卡，第 $3$ 关是普通关卡，以此类推。\n\n通过游戏的第 $i$ 关可以得到 $f(i)$ 分，其中 $f(x)=a_0+a_1x+a_2x^2+\\cdots+a_{k-1}x^{k-1}$ \n是一个固定的 $k-1$ 次多项式。\n\n小 N 通关时一气之下通过了所有奖励关卡而忽略了所有普通关卡，然后就把游戏卸载了。现在回想起来，他想要知道他在卸载游戏前的总得分对 $10^9+7$ 取模后的结果。", "inputFormat": "第一行一个正整数 $n$，表示游戏的关卡数目。为方便，$n$ 以二进制表示给出。\n\n第二行一个正整数 $k$，表示多项式的次数加一。\n\n第三行 $k$ 个非负整数，分别为 $a_0,a_1,a_2,\\cdots,a_{k-1}$，表示多项式的各项系数。", "outputFormat": "一行一个非负整数，表示小 N 卸载游戏前的总得分对 $10^9 + 7$ 取模后的结果。", "hint": "对于所有测试点：$0\\le \\log_2n<5\\times 10^5$，$1\\le k\\le 500$，$0\\le a_i < 10^9 + 7$，$a_{k-1}\\ne 0。$\n\n| 测试点编号 | $\\log_2n\\le$ | $k\\le$ |\n|:-:|:-:|:-:|\n| $1\\sim2$ | $10$ |$500$ |\n| $3\\sim4$ | $20$ | $500$ |\n| $5\\sim8$ | $100$ | $500$ |\n| $9\\sim10$ | $500$ | $500$ |\n| $11\\sim12$ | $5\\times 10^5$ | $1$ |\n| $13\\sim16$ | $5\\times 10^5$ | $100$ |\n| $17\\sim20$ | $5\\times 10^5$ | $500$ |\n\n感谢 [s_r_f](https://www.luogu.com.cn/user/52518) 提供数据。", "locale": "zh-CN"}}}
{"pid": "P7469", "type": "P", "difficulty": 4, "samples": [["5\nbcabc\nbbcca", "9"], ["20\negebejbhcfabgegjgiig\nedfbhhighajibcgfecef", "34"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["字符串", "2021", "哈希 hashing", "NOI Online"], "title": "[NOI Online 2021 提高组] 积木小赛", "background": "", "description": "Alice 和 Bob 最近热衷于玩一个游戏——积木小赛。\n\nAlice 和 Bob 初始时各有 $n$ 块积木从左至右排成一排，每块积木都被标上了一个英文小写字母。\n\nAlice 可以从自己的积木中丢掉任意多块（也可以不丢）；Bob 可以从自己的积木中丢掉最左边的一段连续的积木和最右边的一段连续的积木（也可以有一边不丢或者两边都不丢）。两人都不能丢掉自己所有的积木。然后 Alice 和 Bob 会分别将自己剩下的积木按原来的顺序重新排成一排。\n\nAlice 和 Bob 都忙着去玩游戏了，于是想请你帮他们算一下，有多少种不同的情况下他们最后剩下的两排积木是相同的。\n\n两排积木相同，当且仅当这两排积木块数相同且每一个位置上的字母都对应相同。\n\n两种情况不同，当且仅当 Alice（或者 Bob）剩下的积木在两种情况中不同。", "inputFormat": "第一行一个正整数 $n$，表示积木的块数。\n\n第二行一个长度为 $n$ 的小写字母串 $s$，表示 Alice 初始的那一排积木，其中第 $i$ 个字母 $s_i$ 表示第 $i$ 块积木上的字母。\n\n第三行一个长度为 $n$ 的小写字母串 $t$，表示 Bob 初始的那一排积木，其中第 $i$ 个字母 $t_i$ 表示第 $i$ 块积木上的字母。", "outputFormat": "一行一个非负整数表示答案。", "hint": "对于所有测试点：$1\\le n \\le 3000$，$s$ 与 $t$ 中只包含英文小写字母。\n\n测试点 $1$ 满足：$n\\le3000$，$s$ 与 $t$ 中只包含同一种字母。\n\n测试点 $2,3,4$ 满足：$n\\le100$。\n\n测试点 $5,6,7$ 满足：$n\\le500$。\n\n测试点 $8,9,10$ 满足：$n\\le3000$。\n\n感谢 [w33z8kqrqk8zzzx33](https://www.luogu.com.cn/user/220037) 提供测试数据。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI Online 2021 提高组] 积木小赛", "background": "", "description": "Alice 和 Bob 最近热衷于玩一个游戏——积木小赛。\n\nAlice 和 Bob 初始时各有 $n$ 块积木从左至右排成一排，每块积木都被标上了一个英文小写字母。\n\nAlice 可以从自己的积木中丢掉任意多块（也可以不丢）；Bob 可以从自己的积木中丢掉最左边的一段连续的积木和最右边的一段连续的积木（也可以有一边不丢或者两边都不丢）。两人都不能丢掉自己所有的积木。然后 Alice 和 Bob 会分别将自己剩下的积木按原来的顺序重新排成一排。\n\nAlice 和 Bob 都忙着去玩游戏了，于是想请你帮他们算一下，有多少种不同的情况下他们最后剩下的两排积木是相同的。\n\n两排积木相同，当且仅当这两排积木块数相同且每一个位置上的字母都对应相同。\n\n两种情况不同，当且仅当 Alice（或者 Bob）剩下的积木在两种情况中不同。", "inputFormat": "第一行一个正整数 $n$，表示积木的块数。\n\n第二行一个长度为 $n$ 的小写字母串 $s$，表示 Alice 初始的那一排积木，其中第 $i$ 个字母 $s_i$ 表示第 $i$ 块积木上的字母。\n\n第三行一个长度为 $n$ 的小写字母串 $t$，表示 Bob 初始的那一排积木，其中第 $i$ 个字母 $t_i$ 表示第 $i$ 块积木上的字母。", "outputFormat": "一行一个非负整数表示答案。", "hint": "对于所有测试点：$1\\le n \\le 3000$，$s$ 与 $t$ 中只包含英文小写字母。\n\n测试点 $1$ 满足：$n\\le3000$，$s$ 与 $t$ 中只包含同一种字母。\n\n测试点 $2,3,4$ 满足：$n\\le100$。\n\n测试点 $5,6,7$ 满足：$n\\le500$。\n\n测试点 $8,9,10$ 满足：$n\\le3000$。\n\n感谢 [w33z8kqrqk8zzzx33](https://www.luogu.com.cn/user/220037) 提供测试数据。", "locale": "zh-CN"}}}
{"pid": "P7470", "type": "P", "difficulty": 7, "samples": [["4 2\n1 1\n4 2\n5 1\n2 7\n1 4 6 5\n2 4 3 3", "2\n1"], ["20 10\n215 144\n2 110\n174 132\n214 142\n116 108\n155 192\n236 208\n216 214\n99 220\n236 118\n190 81\n230 131\n10 238\n189 198\n183 13\n45 193\n14 234\n208 192\n126 19\n49 38\n7 14 251 184\n2 18 89 76\n11 15 49 196\n8 11 83 139\n10 15 119 239\n9 16 148 120\n11 17 225 34\n15 16 3 46\n14 15 86 227\n7 18 252 103", "7\n2\n2\n2\n1\n3\n1\n1\n0\n7"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2021", "NOI Online"], "title": "[NOI Online 2021 提高组] 岛屿探险", "background": "", "description": "凇睦是一个喜欢探险的女孩子，这天她到一片海域上来探险了。\n\n在这片海域上一共有 $n$ 座岛屿排成一排，标号为 $1,2,3, \\ldots ,n$。每座岛屿有两个权值，分别为劳累度 $a_i$ 和有趣度 $b_i$。\n\n对于一座劳累度为 $a$，有趣度为 $b$ 的小岛，如果这个小岛满足 $(a\\oplus c) \\leq \\min(b,d)$，凇睦到这座岛探险就会感到开心，其中 $c$ 表示凇睦到岛上去之前就有的劳累度（称作初始劳累度），同理 $d$ 代表凇睦的初始有趣度。$\\oplus$ 表示二进制异或（即二进制表示下不进位的加法）。\n\n为了玩的更尽兴，凇睦会向你询问 $q$ 次，每次给出一个区间 $[l_i,r_i]$ 和两个数 $c_i,d_i$，你需要告诉凇睦若她的初始劳累度为 $c_i$，初始有趣度为 $d_i$，则有多少个标号在 $[l_i,r_i]$ 这个区间内的岛屿能使凇睦探险时感到开心。", "inputFormat": "第一行两个正整数 $n,q$ 分别表示岛屿的数量和询问的数量。\n\n接下来 $n$ 行，每行两个整数 $a_i,b_i$ 分别表示第 $i$ 座岛屿的劳累度和有趣度。\n\n接下来 $q$ 行，每行四个正整数 $l_i,r_i,c_i,d_i$ 分别表示区间左端点，区间右端点，初始劳累度与初始有趣度。", "outputFormat": "输出一共 $q$ 行，每行一个整数对应一个询问的答案。\n", "hint": "测试点 $1,2$ 满足 $1\\leq n,q\\leq 5000$。\n\n测试点 $3,4$ 满足 $1\\leq n,q\\leq 10^4$。\n\n测试点 $5,6,7$ 满足 $1\\leq n,q\\leq 10^5$ 且 $\\max\\{d_i\\}\\leq \\min\\{b_i\\}$。\n\n测试点 $8,9,10,11$ 满足 $1\\leq n,q\\leq 10^5$ 且 $\\min\\{d_i\\}\\geq \\max\\{b_i\\}$。\n\n测试点 $12,13$ 满足 $1\\leq n,q\\leq 10^5$ 且 $l_i=1,r_i=n$。\n\n测试点 $14,15,16$ 满足 $1\\leq n,q\\leq 7\\times 10^4$。\n\n测试点 $17,18,19,20$ 满足 $1\\leq n,q\\leq 10^5$。\n\n所有数据满足 $1\\leq n,q\\leq 10^5$， $1\\leq a_i,b_i,c_i,d_i\\leq 2^{24}-1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI Online 2021 提高组] 岛屿探险", "background": "", "description": "凇睦是一个喜欢探险的女孩子，这天她到一片海域上来探险了。\n\n在这片海域上一共有 $n$ 座岛屿排成一排，标号为 $1,2,3, \\ldots ,n$。每座岛屿有两个权值，分别为劳累度 $a_i$ 和有趣度 $b_i$。\n\n对于一座劳累度为 $a$，有趣度为 $b$ 的小岛，如果这个小岛满足 $(a\\oplus c) \\leq \\min(b,d)$，凇睦到这座岛探险就会感到开心，其中 $c$ 表示凇睦到岛上去之前就有的劳累度（称作初始劳累度），同理 $d$ 代表凇睦的初始有趣度。$\\oplus$ 表示二进制异或（即二进制表示下不进位的加法）。\n\n为了玩的更尽兴，凇睦会向你询问 $q$ 次，每次给出一个区间 $[l_i,r_i]$ 和两个数 $c_i,d_i$，你需要告诉凇睦若她的初始劳累度为 $c_i$，初始有趣度为 $d_i$，则有多少个标号在 $[l_i,r_i]$ 这个区间内的岛屿能使凇睦探险时感到开心。", "inputFormat": "第一行两个正整数 $n,q$ 分别表示岛屿的数量和询问的数量。\n\n接下来 $n$ 行，每行两个整数 $a_i,b_i$ 分别表示第 $i$ 座岛屿的劳累度和有趣度。\n\n接下来 $q$ 行，每行四个正整数 $l_i,r_i,c_i,d_i$ 分别表示区间左端点，区间右端点，初始劳累度与初始有趣度。", "outputFormat": "输出一共 $q$ 行，每行一个整数对应一个询问的答案。\n", "hint": "测试点 $1,2$ 满足 $1\\leq n,q\\leq 5000$。\n\n测试点 $3,4$ 满足 $1\\leq n,q\\leq 10^4$。\n\n测试点 $5,6,7$ 满足 $1\\leq n,q\\leq 10^5$ 且 $\\max\\{d_i\\}\\leq \\min\\{b_i\\}$。\n\n测试点 $8,9,10,11$ 满足 $1\\leq n,q\\leq 10^5$ 且 $\\min\\{d_i\\}\\geq \\max\\{b_i\\}$。\n\n测试点 $12,13$ 满足 $1\\leq n,q\\leq 10^5$ 且 $l_i=1,r_i=n$。\n\n测试点 $14,15,16$ 满足 $1\\leq n,q\\leq 7\\times 10^4$。\n\n测试点 $17,18,19,20$ 满足 $1\\leq n,q\\leq 10^5$。\n\n所有数据满足 $1\\leq n,q\\leq 10^5$， $1\\leq a_i,b_i,c_i,d_i\\leq 2^{24}-1$。", "locale": "zh-CN"}}}
{"pid": "P7471", "type": "P", "difficulty": 3, "samples": [["6\n0 0 8\n0 5 3\n9 9 0\n6 2 4\n1 7 4\n5 8 5", "0\n2\n1\n2\n3\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2021", "NOI Online", "分类讨论"], "title": "[NOI Online 2021 入门组] 切蛋糕", "background": "", "description": "Alice、Bob 和 Cindy 三个好朋友得到了一个圆形蛋糕，他们打算分享这个蛋糕。\n\n三个人的需求量分别为 $a,b,c$，现在请你帮他们切蛋糕，规则如下：\n\n1. 每次切蛋糕可以选择蛋糕的任意一条直径，并沿这条直径切一刀（注意切完后不会立刻将蛋糕分成两部分）。\n\n2. 设你一共切了 $n$ 刀，那么你将得到 $2n$ 个扇形的蛋糕（特别地，切了 $0$ 刀被认为是有一个扇形，即整个圆形蛋糕），将这些蛋糕分配给 Alice，Bob 和 Cindy，要求每个扇形蛋糕只能完整地分给一个人。\n\n3. 三人分到的蛋糕面积比需要为 $a:b:c$（不保证是最简比例，且如果 $a:b:c$ 中某个数为 $0$，表示那个人不吃蛋糕）。\n\n为了完成这个任务，你至少需要切几刀？", "inputFormat": "本题单个测试点包含多组数据。\n\n第一行包含一个整数 $T$，表示数据组数。\n\n接下来 $T$ 行，每行包含三个整数 $a,b,c$，表示三人的需求量。", "outputFormat": "输出 $T$ 行，第 $i$ 行的输出表示第 $i$ 组数据中你至少需要切蛋糕的次数。", "hint": "### 样例 $1$ 解释\n![](https://cdn.luogu.com.cn/upload/image_hosting/i3pai9va.png)\n\n### 数据范围与提示\n$30\\%$ 的数据满足：$a=b=0$。\n\n$60\\%$ 的数据满足：$a=0$。\n\n$100\\%$ 的数据满足：$1\\le T\\le 10^4，0\\le a,b,c\\le 10^8$，保证 $a+b+c>0$。\n\n数据由 [SSerxhs](https://www.luogu.com.cn/user/29826) 提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI Online 2021 入门组] 切蛋糕", "background": "", "description": "Alice、Bob 和 Cindy 三个好朋友得到了一个圆形蛋糕，他们打算分享这个蛋糕。\n\n三个人的需求量分别为 $a,b,c$，现在请你帮他们切蛋糕，规则如下：\n\n1. 每次切蛋糕可以选择蛋糕的任意一条直径，并沿这条直径切一刀（注意切完后不会立刻将蛋糕分成两部分）。\n\n2. 设你一共切了 $n$ 刀，那么你将得到 $2n$ 个扇形的蛋糕（特别地，切了 $0$ 刀被认为是有一个扇形，即整个圆形蛋糕），将这些蛋糕分配给 Alice，Bob 和 Cindy，要求每个扇形蛋糕只能完整地分给一个人。\n\n3. 三人分到的蛋糕面积比需要为 $a:b:c$（不保证是最简比例，且如果 $a:b:c$ 中某个数为 $0$，表示那个人不吃蛋糕）。\n\n为了完成这个任务，你至少需要切几刀？", "inputFormat": "本题单个测试点包含多组数据。\n\n第一行包含一个整数 $T$，表示数据组数。\n\n接下来 $T$ 行，每行包含三个整数 $a,b,c$，表示三人的需求量。", "outputFormat": "输出 $T$ 行，第 $i$ 行的输出表示第 $i$ 组数据中你至少需要切蛋糕的次数。", "hint": "### 样例 $1$ 解释\n![](https://cdn.luogu.com.cn/upload/image_hosting/i3pai9va.png)\n\n### 数据范围与提示\n$30\\%$ 的数据满足：$a=b=0$。\n\n$60\\%$ 的数据满足：$a=0$。\n\n$100\\%$ 的数据满足：$1\\le T\\le 10^4，0\\le a,b,c\\le 10^8$，保证 $a+b+c>0$。\n\n数据由 [SSerxhs](https://www.luogu.com.cn/user/29826) 提供。", "locale": "zh-CN"}}}
{"pid": "P7472", "type": "P", "difficulty": 3, "samples": [["4\n20 1 19 2\n3 18 4 17\n16 5 15 6\n7 14 8 13", "132"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "枚举", "NOI Online"], "title": "[NOI Online 2021 入门组] 吃豆人", "background": "", "description": "有一个 $n$ 行 $n$ 列的正方形点阵，左上角点坐标为 $(1, 1)$，右下角点坐标为 $(n, n)$。\n\n点阵中每个整点上都有数量不一的豆子，坐标为 $(i, j)$ 的点上有 $a_{i,j}$ 个豆子。\n\n你可以放置吃豆人，可以将点阵中任意的整点作为吃豆人的初始位置，再给定左上、左下、右上、右下之一作为吃豆人的初始方向。\n\n吃豆人会不断沿初始方向行进，吃光遇到的所有豆子，直到碰到点阵的边界，此时：\n\n1. 如果吃豆人处于正方形点阵四个角之一的位置，那么就会停止行动；\n\n2. 否则，吃豆人的行进路线将以这条边界为镜面发生反射，下图展示了一个路径某两次发生反射的例子：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6tji95nq.png)\n\n现在，你需要放置两个吃豆人，求两个吃豆人最多共能吃到多少个豆子？注意同一个豆子只能被吃一次。\n", "inputFormat": "第一行包含一个整数 $n$，表示点阵大小。\n\n接下来 $n$ 行，每行包含 $n$ 个整数，其中第 $i$ 行第 $j$ 个整数表示 $a_{i,j}$。\n", "outputFormat": "输出一行一个整数，表示两个吃豆人最多共能吃到的豆子数量。", "hint": "### 样例 1 解释\n\n在 $(1, 1)$ 和 $(1, 3)$ 位置放置吃豆人，初始方向分别为右下和左下，即可吃到位于\n$(1, 1)$，$(1, 3)$，$(2, 2)$，$(2, 4)$，$(3, 1)$，$(3, 3)$，$(4, 2)$，$(4, 4)$ 位置上的豆子，总个数为 $132$，\n达到最大，路径分别如下图绿线和红线所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1axaad1b.png)\n\n### 数据范围\n\n对于 $30\\%$ 的数据，$n\\leq 3$。\n\n对于 $60\\%$ 的数据：$n\\leq 100$。\n\n对于 $100\\%$ 的数据：$2\\leq n\\leq 1000$，$0\\leq a_{i,j}\\leq 1000$。\n\n数据由 [SSerxhs](https://www.luogu.com.cn/user/29826) 和 [Karry5307](https://www.luogu.com.cn/user/60990) 共同提供。\n\n感谢 [Silence_water](https://www.luogu.com.cn/user/338630) 提供一组 hack 数据。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI Online 2021 入门组] 吃豆人", "background": "", "description": "有一个 $n$ 行 $n$ 列的正方形点阵，左上角点坐标为 $(1, 1)$，右下角点坐标为 $(n, n)$。\n\n点阵中每个整点上都有数量不一的豆子，坐标为 $(i, j)$ 的点上有 $a_{i,j}$ 个豆子。\n\n你可以放置吃豆人，可以将点阵中任意的整点作为吃豆人的初始位置，再给定左上、左下、右上、右下之一作为吃豆人的初始方向。\n\n吃豆人会不断沿初始方向行进，吃光遇到的所有豆子，直到碰到点阵的边界，此时：\n\n1. 如果吃豆人处于正方形点阵四个角之一的位置，那么就会停止行动；\n\n2. 否则，吃豆人的行进路线将以这条边界为镜面发生反射，下图展示了一个路径某两次发生反射的例子：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6tji95nq.png)\n\n现在，你需要放置两个吃豆人，求两个吃豆人最多共能吃到多少个豆子？注意同一个豆子只能被吃一次。\n", "inputFormat": "第一行包含一个整数 $n$，表示点阵大小。\n\n接下来 $n$ 行，每行包含 $n$ 个整数，其中第 $i$ 行第 $j$ 个整数表示 $a_{i,j}$。\n", "outputFormat": "输出一行一个整数，表示两个吃豆人最多共能吃到的豆子数量。", "hint": "### 样例 1 解释\n\n在 $(1, 1)$ 和 $(1, 3)$ 位置放置吃豆人，初始方向分别为右下和左下，即可吃到位于\n$(1, 1)$，$(1, 3)$，$(2, 2)$，$(2, 4)$，$(3, 1)$，$(3, 3)$，$(4, 2)$，$(4, 4)$ 位置上的豆子，总个数为 $132$，\n达到最大，路径分别如下图绿线和红线所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1axaad1b.png)\n\n### 数据范围\n\n对于 $30\\%$ 的数据，$n\\leq 3$。\n\n对于 $60\\%$ 的数据：$n\\leq 100$。\n\n对于 $100\\%$ 的数据：$2\\leq n\\leq 1000$，$0\\leq a_{i,j}\\leq 1000$。\n\n数据由 [SSerxhs](https://www.luogu.com.cn/user/29826) 和 [Karry5307](https://www.luogu.com.cn/user/60990) 共同提供。\n\n感谢 [Silence_water](https://www.luogu.com.cn/user/338630) 提供一组 hack 数据。", "locale": "zh-CN"}}}
{"pid": "P7473", "type": "P", "difficulty": 5, "samples": [["4 4 3\n2 2\n2 4\n3 2\n4 4\n1 3 4 3\n2 1 2 1\n1 2 3 4", "1\n0\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["图论", "2021", "最短路", "NOI Online"], "title": "[NOI Online 2021 入门组] 重力球", "background": null, "description": "“重力球”游戏在一块 $n\\times n$ 的正方形区域中进行，记从上往下第 $i$ 行，从左往右第 $j$ 列的位置为 $(i,j)$。\n\n正方形区域中存在 $m$ 个障碍，第 $i$ 个障碍占据位置 $(x_i,y_i)$，此外，正方形区域的边界外都是障碍。\n\n现在有两个小球，位置分别是 $(a,b)$ 和 $(c,d)$，在游戏中你可以进行如下操作：\n\n- 指定上、下、左、右中的一个方向，将重力方向“切换”为这个方向。此时两个小球会同时向这个方向移动，直到碰到障碍。\n\n你要用最少的操作次数使得两个小球到达同一个位置。\n\n现有 $q$ 局游戏，每局游戏中只有小球的初始位置不同，而障碍位置是不变的，你需要对每局游戏都求出最小操作次数，或报告无解。", "inputFormat": "第一行包含三个整数 $n,m,q$，分别表示矩形区域大小，障碍个数和游戏局数。\n\n接下来 $m$ 行，每行包含两个整数 $x_i,y_i$，表示位置 $(x_i,y_i)$ 上有一个障碍。数据保证所有障碍所处的位置互不相同。\n\n接下来 $q$ 行，每行四个整数 $a,b,c,d$，表示一局游戏中两个小球的初始位置，保证初始位置不存在障碍。", "outputFormat": "输出共 $q$ 行，第 $i$ 行输出一个整数表示第 $i$ 局游戏需要的最小操作次数，如果无解则输出 `-1`。", "hint": "### 样例 $1$ 解释\n\n该样例中障碍分布如图中红叉所示。\n\n第一组询问中只需将重力改向上（或改向下）即可使两球同时到达。\n\n第二组询问中两球已经在同一位置故不需操作。\n\n第三组询问中改变 $3$ 次重力的方向，依次改为向左、向下、向左，小球移动路线分别如图中粉色、橙色、棕色线所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7nngrov0.png)\n### 数据范围与提示\n对于 $20\\%$ 的数据：$n,m\\le 2$。\n\n对于 $50\\%$ 的数据：$n,m\\le30$。\n\n对于另外 $30\\%$ 的数据：$q=1$。\n\n对于 $100\\%$ 的数据：$1\\le n,m\\le250，1\\le q\\le10^5，1\\le x_i,y_i,a,b,c,d\\le n$。\n\n数据由 [SSerxhs](https://www.luogu.com.cn/user/29826) 提供。\n\n数据参考了 小喵喵不喜欢计算几何 2020 ICPC 区域赛（南京）A 题的构造方案，在此表示感谢。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI Online 2021 入门组] 重力球", "background": null, "description": "“重力球”游戏在一块 $n\\times n$ 的正方形区域中进行，记从上往下第 $i$ 行，从左往右第 $j$ 列的位置为 $(i,j)$。\n\n正方形区域中存在 $m$ 个障碍，第 $i$ 个障碍占据位置 $(x_i,y_i)$，此外，正方形区域的边界外都是障碍。\n\n现在有两个小球，位置分别是 $(a,b)$ 和 $(c,d)$，在游戏中你可以进行如下操作：\n\n- 指定上、下、左、右中的一个方向，将重力方向“切换”为这个方向。此时两个小球会同时向这个方向移动，直到碰到障碍。\n\n你要用最少的操作次数使得两个小球到达同一个位置。\n\n现有 $q$ 局游戏，每局游戏中只有小球的初始位置不同，而障碍位置是不变的，你需要对每局游戏都求出最小操作次数，或报告无解。", "inputFormat": "第一行包含三个整数 $n,m,q$，分别表示矩形区域大小，障碍个数和游戏局数。\n\n接下来 $m$ 行，每行包含两个整数 $x_i,y_i$，表示位置 $(x_i,y_i)$ 上有一个障碍。数据保证所有障碍所处的位置互不相同。\n\n接下来 $q$ 行，每行四个整数 $a,b,c,d$，表示一局游戏中两个小球的初始位置，保证初始位置不存在障碍。", "outputFormat": "输出共 $q$ 行，第 $i$ 行输出一个整数表示第 $i$ 局游戏需要的最小操作次数，如果无解则输出 `-1`。", "hint": "### 样例 $1$ 解释\n\n该样例中障碍分布如图中红叉所示。\n\n第一组询问中只需将重力改向上（或改向下）即可使两球同时到达。\n\n第二组询问中两球已经在同一位置故不需操作。\n\n第三组询问中改变 $3$ 次重力的方向，依次改为向左、向下、向左，小球移动路线分别如图中粉色、橙色、棕色线所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7nngrov0.png)\n### 数据范围与提示\n对于 $20\\%$ 的数据：$n,m\\le 2$。\n\n对于 $50\\%$ 的数据：$n,m\\le30$。\n\n对于另外 $30\\%$ 的数据：$q=1$。\n\n对于 $100\\%$ 的数据：$1\\le n,m\\le250，1\\le q\\le10^5，1\\le x_i,y_i,a,b,c,d\\le n$。\n\n数据由 [SSerxhs](https://www.luogu.com.cn/user/29826) 提供。\n\n数据参考了 小喵喵不喜欢计算几何 2020 ICPC 区域赛（南京）A 题的构造方案，在此表示感谢。", "locale": "zh-CN"}}}
{"pid": "P7474", "type": "P", "difficulty": 4, "samples": [["2", "4\n1"], ["7", "166374067\n539688692"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "数学", "Special Judge", "动态规划优化", "连通块", "期望"], "title": "「C.E.L.U-02」学术精神", "background": "", "description": "提供 **一句话题意** 阅读。\n\n某地有 $n$ 个小朋友，每个小朋友都有一个**独特的**  idea，其中第 $i$ 个小朋友的 idea 的 **编号** 为 $i$。老师让这个每一个小朋友在一组编号分别为 $1\\sim n$ 的卡片中随机抽一个，**抽完后把卡片放回去**，这个小朋友会和编号为卡片上数字的小朋友**交换** idea（交换指**两人**把**所有**自己知道的 idea 告诉对方）。因为自己和自己交换 idea 在他们眼中也许是一件很傻的事情，所以如果**卡片上的编号与自己的相同**，他将再抽一次（此时他已经把卡片放回去了），**直到编号不是自己**的为止。\n\n不久，每个小朋友都抽完了一遍，每个小朋友将把收集到的**所有** idea 出成一场比赛，因为有 idea 的交换，有很多比赛之间都是**有联系**的。\n\n如果两场比赛中存在 idea **相同**的题目，我们认为这两场比赛是有联系的。「联系」具有**传递性**：**如果比赛 $\\mathbf A$、$\\mathbf B$ 有联系，比赛 $\\mathbf B$、$\\mathbf C$ 有联系，则比赛 $\\mathbf A$、$\\mathbf C$ 也有联系**。为了避免理解错误，在这举一个例子：\n\n若仅有四场比赛：比赛一出现了 idea $1$、$2$；比赛二出现 idea $2$、$5$ ；比赛三出现 idea $3$、$5$、$8$，比赛四出现 idea $4$、$7$。则比赛一、二之间有**直接联系**。比赛一、三之间虽然没有公共 idea，但它们之间是**有联系**的。比赛四与其他所有比赛没有联系。  \n\n而所有有联系的比赛都将属于同一个比赛集，没有联系的比赛处在不同的比赛集。\n\n上例中比赛一、二、三属于一个比赛集，比赛四属于另一个。\n\n求所有人**抽球卡片的次数和**的期望 $E_0$ 和比赛集的个数 $s$ 的期望 $E_1$。\n\n---\n\n**一句话题意：**\n\n对于每个点 $i$ 随机与 $[1,n]$ 中的一点连无向边，若连向自己，则保留该边并再次连边，一直重复至连到别的点上为止，求边数与连通块个数期望。", "inputFormat": "输入一行一个正整数 $n$。", "outputFormat": "第一行输出一个数 $E_0$ ，第二行输出一个数 $E_1$ ，可以证明它们都是**有理数**。\n\n为了避免精度误差，您只需要输出它们对质数 $998244353$ 取模的结果即可，如果您不会分数取模，您可以查找关于费马小定理与乘法逆元的相关资料。\n\n如果输出格式错误或两问答案均错误，该测试点得 $0$ 分；\n\n如果仅答对第一问，该测试点得 $3$ 分；\n\n如果仅答对第二问，该测试点得 $7$ 分；\n\n如果两问均正确，该测试点得 $10$ 分。\n\n**请务必输出两个整数。**", "hint": "---\n\n### 样例解释  \n\n**样例解释一**\n\n- 每个小朋友摸卡片次数为 $1$ 的概率为 $\\dfrac{1}{2}$，摸卡片次数为 $2$ 的概率为 $\\dfrac{1}{4}$，摸卡片次数为 $i$ 的期望次数为 $\\dfrac{1}{2^i}$，期望摸卡片次数为 $2$，总摸卡片次数为 $4$。\n\n- $1$ 号小朋友一定会和 $2$ 号小朋友交换 idea，所以他们出的比赛之间一定是属于同一个比赛集。$E_1=1$。\n\n**样例解释二**\n\n- 第一问取模前的答案为 $\\dfrac{49}{6}$。\n\n- 第二问取模前的答案为 $\\dfrac{2245}{1944}$。\n\n---\n\n### 数据范围\n\n| 测试点编号 | $n$ | 测试点编号 | $n$ | \n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\leq 3$ | $5$ | $\\leq 1000$ |\n| $2$ | $\\leq 5$ | $6$ | $\\leq 2000$ | \n| $3$ | $\\leq 9$ | $7\\sim8$ | $\\leq 5000$ | \n| $4$ | $\\leq 12$ | $9\\sim 10$ | $\\leq10^4$ | \n\n对于 $100\\%$ 的数据，有 $2\\leq n\\leq10^4$。\n\n---\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「C.E.L.U-02」学术精神", "background": "", "description": "提供 **一句话题意** 阅读。\n\n某地有 $n$ 个小朋友，每个小朋友都有一个**独特的**  idea，其中第 $i$ 个小朋友的 idea 的 **编号** 为 $i$。老师让这个每一个小朋友在一组编号分别为 $1\\sim n$ 的卡片中随机抽一个，**抽完后把卡片放回去**，这个小朋友会和编号为卡片上数字的小朋友**交换** idea（交换指**两人**把**所有**自己知道的 idea 告诉对方）。因为自己和自己交换 idea 在他们眼中也许是一件很傻的事情，所以如果**卡片上的编号与自己的相同**，他将再抽一次（此时他已经把卡片放回去了），**直到编号不是自己**的为止。\n\n不久，每个小朋友都抽完了一遍，每个小朋友将把收集到的**所有** idea 出成一场比赛，因为有 idea 的交换，有很多比赛之间都是**有联系**的。\n\n如果两场比赛中存在 idea **相同**的题目，我们认为这两场比赛是有联系的。「联系」具有**传递性**：**如果比赛 $\\mathbf A$、$\\mathbf B$ 有联系，比赛 $\\mathbf B$、$\\mathbf C$ 有联系，则比赛 $\\mathbf A$、$\\mathbf C$ 也有联系**。为了避免理解错误，在这举一个例子：\n\n若仅有四场比赛：比赛一出现了 idea $1$、$2$；比赛二出现 idea $2$、$5$ ；比赛三出现 idea $3$、$5$、$8$，比赛四出现 idea $4$、$7$。则比赛一、二之间有**直接联系**。比赛一、三之间虽然没有公共 idea，但它们之间是**有联系**的。比赛四与其他所有比赛没有联系。  \n\n而所有有联系的比赛都将属于同一个比赛集，没有联系的比赛处在不同的比赛集。\n\n上例中比赛一、二、三属于一个比赛集，比赛四属于另一个。\n\n求所有人**抽球卡片的次数和**的期望 $E_0$ 和比赛集的个数 $s$ 的期望 $E_1$。\n\n---\n\n**一句话题意：**\n\n对于每个点 $i$ 随机与 $[1,n]$ 中的一点连无向边，若连向自己，则保留该边并再次连边，一直重复至连到别的点上为止，求边数与连通块个数期望。", "inputFormat": "输入一行一个正整数 $n$。", "outputFormat": "第一行输出一个数 $E_0$ ，第二行输出一个数 $E_1$ ，可以证明它们都是**有理数**。\n\n为了避免精度误差，您只需要输出它们对质数 $998244353$ 取模的结果即可，如果您不会分数取模，您可以查找关于费马小定理与乘法逆元的相关资料。\n\n如果输出格式错误或两问答案均错误，该测试点得 $0$ 分；\n\n如果仅答对第一问，该测试点得 $3$ 分；\n\n如果仅答对第二问，该测试点得 $7$ 分；\n\n如果两问均正确，该测试点得 $10$ 分。\n\n**请务必输出两个整数。**", "hint": "---\n\n### 样例解释  \n\n**样例解释一**\n\n- 每个小朋友摸卡片次数为 $1$ 的概率为 $\\dfrac{1}{2}$，摸卡片次数为 $2$ 的概率为 $\\dfrac{1}{4}$，摸卡片次数为 $i$ 的期望次数为 $\\dfrac{1}{2^i}$，期望摸卡片次数为 $2$，总摸卡片次数为 $4$。\n\n- $1$ 号小朋友一定会和 $2$ 号小朋友交换 idea，所以他们出的比赛之间一定是属于同一个比赛集。$E_1=1$。\n\n**样例解释二**\n\n- 第一问取模前的答案为 $\\dfrac{49}{6}$。\n\n- 第二问取模前的答案为 $\\dfrac{2245}{1944}$。\n\n---\n\n### 数据范围\n\n| 测试点编号 | $n$ | 测试点编号 | $n$ | \n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\leq 3$ | $5$ | $\\leq 1000$ |\n| $2$ | $\\leq 5$ | $6$ | $\\leq 2000$ | \n| $3$ | $\\leq 9$ | $7\\sim8$ | $\\leq 5000$ | \n| $4$ | $\\leq 12$ | $9\\sim 10$ | $\\leq10^4$ | \n\n对于 $100\\%$ 的数据，有 $2\\leq n\\leq10^4$。\n\n---\n", "locale": "zh-CN"}}}
{"pid": "P7475", "type": "P", "difficulty": 6, "samples": [["3\nfan\nfantasy\nfather\n6\nfat 1\nfa 1\nfan 1\nfan 1\nfa 1\nfant 1", "father\nfather\nfan\nfan\nfan\nfantasy"], ["5\nuva\nusaco\nusa\nusssu\nkonjac\n11\nu 2\nu 2\nkkk 1\nuv 2\nus 3\nu 4\nu 1\nu 2\nk 1\nu 3\nusa 1", "usaco\nusa\n404Error\nuva\nusssu\nuva\nuva\nusa\nkonjac\nusaco\nusa"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216]}, "tags": ["平衡树", "O2优化", "树套树", "字典树 Trie"], "title": "「C.E.L.U-02」简易输入法", "background": "YQH 有一个伟大的梦想，他想成为全世界最强的男人。为了实现这一个目标，他准备从一个简易的输入法入手开始征程。", "description": "这个简易输入法原先有一个词典 $\\text{U}$，用户输入时，输入法从用户处读入一个字符串 $s$ ，以及一个整数 $x$ 对于这个字符串有以下几种情形：  \n设$s_i \\in \\text{U} $ 且 $s$ 为 $s_i$ 的前缀的个数为 $a$。  \n\n当 $a\\ge x$ 时，请输出按照以输出次数从大到小为第一关键字，以字典序为第二关键字排序后的第 $x$ 个 $s_i$，并将其输出次数加 $1$。    \n\n当 $x>a>0$ 时，请输出按照以输出次数从大到小为第一关键字，以字典序为第二关键字排序后的最后一个 $s_i$，并将其输出次数加 $1$。  \n\n当 $a=0$ 时，输出 `404Error`。  ", "inputFormat": "第$1$行输入一个整数 $n$，代表 $\\text{U}$ 中原有 $n$ 个单词，每个原始存在的单词一开始输入次数都是 $0$。  \n\n第 $2$ 至 $n+1$ 行，每行输入一个字符串 $str$，代表一个词典中原来出现的单词。  \n\n第 $n+2$ 行输入一个整数 $m$，代表用户进行了 $m$ 次操作。  \n\n第 $n+3$ 至 $n+m+2$ 行，输入一个字符串 $s$ 和一个整数 $x$ ，含义在题目描述中已经说了。 ", "outputFormat": "对于每一个用户的 $1$ 操作，输出一个字符串。", "hint": "### 样例解释 \n\n**样例解释一**\n\n`fat` 为前缀只有 $1$ 个，故输出 `father`，并将其输出次数加 $1$。  \n`fa` 为前缀中输出次数最多是 `father`，故输出它，并将其输出次数加 $1$。  \n`fan` 为前缀中输出次数都是 $0$，但 `fan` 字典序最小，故输出它，并将其输出次数加 $1$。  \n`fan` 为前缀 `fan` 输出次数最多，故输出 `fan`，并将其输出次数加 $1$。  \n`fa` 为前缀中输出次数最多是 `fan`，故输出它，并将其输出次数加 $1$。  \n`fant` 为前缀只有一个单词 `fantasy`，故输出它，并将其输出次数加 $1$。\n\n ### 数据范围\n\n| 数据编号 | $n$ | $m$ | $x$ | $\\sum str$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1\\sim 2$ | $\\le100$ | $\\le100$ | $=1$ | $\\le10^3$ |\n| $3\\sim 4$ | $\\le100$ | $\\le100$ | $\\diagdown$ | $10^3$ |\n| $5\\sim 8$ | $\\le5\\times10^4$ | $\\le10^5$ | $=1$ | $\\le5\\times10^5$ |\n| $9\\sim 14$ | $\\le10^4$ | $\\le10^5$ | $\\diagdown$ | $\\le10^5$ |\n| $15\\sim 20$ | $\\le5\\times10^4$ | $\\le10^5$ | $\\diagdown$ | $\\le5\\times10^5$ |\n\n对于$100\\%$的数据，$|s|,|str|\\le10,1\\leq x\\le10^4$，所有字母都是小写字母。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「C.E.L.U-02」简易输入法", "background": "YQH 有一个伟大的梦想，他想成为全世界最强的男人。为了实现这一个目标，他准备从一个简易的输入法入手开始征程。", "description": "这个简易输入法原先有一个词典 $\\text{U}$，用户输入时，输入法从用户处读入一个字符串 $s$ ，以及一个整数 $x$ 对于这个字符串有以下几种情形：  \n设$s_i \\in \\text{U} $ 且 $s$ 为 $s_i$ 的前缀的个数为 $a$。  \n\n当 $a\\ge x$ 时，请输出按照以输出次数从大到小为第一关键字，以字典序为第二关键字排序后的第 $x$ 个 $s_i$，并将其输出次数加 $1$。    \n\n当 $x>a>0$ 时，请输出按照以输出次数从大到小为第一关键字，以字典序为第二关键字排序后的最后一个 $s_i$，并将其输出次数加 $1$。  \n\n当 $a=0$ 时，输出 `404Error`。  ", "inputFormat": "第$1$行输入一个整数 $n$，代表 $\\text{U}$ 中原有 $n$ 个单词，每个原始存在的单词一开始输入次数都是 $0$。  \n\n第 $2$ 至 $n+1$ 行，每行输入一个字符串 $str$，代表一个词典中原来出现的单词。  \n\n第 $n+2$ 行输入一个整数 $m$，代表用户进行了 $m$ 次操作。  \n\n第 $n+3$ 至 $n+m+2$ 行，输入一个字符串 $s$ 和一个整数 $x$ ，含义在题目描述中已经说了。 ", "outputFormat": "对于每一个用户的 $1$ 操作，输出一个字符串。", "hint": "### 样例解释 \n\n**样例解释一**\n\n`fat` 为前缀只有 $1$ 个，故输出 `father`，并将其输出次数加 $1$。  \n`fa` 为前缀中输出次数最多是 `father`，故输出它，并将其输出次数加 $1$。  \n`fan` 为前缀中输出次数都是 $0$，但 `fan` 字典序最小，故输出它，并将其输出次数加 $1$。  \n`fan` 为前缀 `fan` 输出次数最多，故输出 `fan`，并将其输出次数加 $1$。  \n`fa` 为前缀中输出次数最多是 `fan`，故输出它，并将其输出次数加 $1$。  \n`fant` 为前缀只有一个单词 `fantasy`，故输出它，并将其输出次数加 $1$。\n\n ### 数据范围\n\n| 数据编号 | $n$ | $m$ | $x$ | $\\sum str$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1\\sim 2$ | $\\le100$ | $\\le100$ | $=1$ | $\\le10^3$ |\n| $3\\sim 4$ | $\\le100$ | $\\le100$ | $\\diagdown$ | $10^3$ |\n| $5\\sim 8$ | $\\le5\\times10^4$ | $\\le10^5$ | $=1$ | $\\le5\\times10^5$ |\n| $9\\sim 14$ | $\\le10^4$ | $\\le10^5$ | $\\diagdown$ | $\\le10^5$ |\n| $15\\sim 20$ | $\\le5\\times10^4$ | $\\le10^5$ | $\\diagdown$ | $\\le5\\times10^5$ |\n\n对于$100\\%$的数据，$|s|,|str|\\le10,1\\leq x\\le10^4$，所有字母都是小写字母。", "locale": "zh-CN"}}}
{"pid": "P7476", "type": "P", "difficulty": 6, "samples": [["5 4\n1 1 3 2\n1 2 4 3\n2 3 3\n3 1 3", "3"], ["6 6\n1 1 6 2\n1 3 3 2\n1 3 4 3\n2 3 4\n3 3 3\n3 4 4", "2\n2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["线段树", "堆", "O2优化", "均摊分析"], "title": "「C.E.L.U-02」苦涩", "background": "回想起自己的过往的人生，YQH 觉得心中充满了苦涩。如果人生能再来一次，我一定会少做一些傻事，少真香几次，然后大胆地去追寻自己的爱。可惜没有这样一个机会了。  ", "description": "在 YQH 的梦中，他看到自己过去的记忆正在不断浮现在自己脑中。这些记忆带给他的是满满的苦涩。他想要强行忘记一些来减轻自己的苦涩。  \nYQH 的脑中可以被分成 $n$ 个片区，每个片区相当于一个存放记忆的可重集，初始为空。他将进行 $m$ 次这三种操作：  \n操作 1：区间 $l\\sim r$ 的片区中都浮现了一个苦涩值为 $k$ 的记忆。    \n操作 2：YQH 开始清理 $l\\sim r$ 片区的记忆。如果一个片区 $k\\in[l,r]$ 且 $k$ 中苦涩值最大的记忆与 $l\\sim r$ 片区中苦涩值最大的记忆相等，则将这个苦涩值最大的记忆忘记。如果在同一个片区有多个相同的苦涩值最大的记忆，则只忘记一个。如果这些片区内没有记忆，则无视。  \n操作 3：YQH 想知道，$l\\sim r$ 片区中苦涩值最大的记忆的苦涩值是多少，如果不存在，输出`-1`。  ", "inputFormat": "第一行两个数，$n,m$。  \n接下来 $m$ 行，第一个数代表操作种类 $op$，对于操作 1，有三个数 $l,r,k$，对于操作 2 或 3，有两个数 $l,r$。", "outputFormat": "对于每个操作 3 输出一行，代表答案。", "hint": "### 样例解释 \n\n**样例解释一**\n\n下面为各操作之后 YQH 的大脑的状态：  \n第一次操作：$\\{2\\},\\{2\\},\\{2\\},\\varnothing,\\varnothing$  \n第二次操作：$\\{2\\},\\{2,3\\},\\{2,3\\},\\{3\\},\\varnothing$    \n第三次操作：$\\{2\\},\\{2,3\\},\\{2\\},\\{3\\},\\varnothing$    \n第四次操作询问 区间 $1\\sim 3$ 的最大值，所以答案是 $3$。\n\n**样例解释二**\n\n下面为各操作之后 YQH 的大脑的状态：  \n第一次操作：$\\{2\\},\\{2\\},\\{2\\},\\{2\\},\\{2\\},\\{2\\}$  \n第二次操作：$\\{2\\},\\{2\\},\\{2,2\\},\\{2\\},\\{2\\},\\{2\\}$  \n第三次操作：$\\{2\\},\\{2\\},\\{2,2,3\\},\\{2,3\\},\\{2\\},\\{2\\}$   \n第四次操作：$\\{2\\},\\{2\\},\\{2,2\\},\\{2\\},\\{2\\},\\{2\\}$  \n第五次操作询问 $3$ 的最大值，所以答案是 $2$。  \n第六次操作询问 $4$ 的最大值，所以答案是 $2$。  \n\n### 数据范围  \n|Subtask|n|m|特殊性质|\n|:---:|:---:|:---:|:---:|\n|$1(10pts)$|$\\leq10^3$|$\\le10^3$|$\\diagdown$|\n|$2(20pts)$|$\\leq5\\times10^4$|$\\leq5\\times10^4$|没有操作 2|\n|$3(10pts)$|$\\leq5\\times10^4$|$\\leq5\\times10^4$|操作 2 中 $l=r$|\n|$4(20pts)$|$\\leq5\\times10^4$|$\\leq5\\times10^4$|$\\diagdown$|\n|$5(20pts)$|$\\leq2\\times10^5$|$\\leq2\\times10^5$|操作 2 中 $l=r$|\n|$6(20pts)$|$\\leq2\\times10^5$|$\\leq2\\times10^5$|$\\diagdown$|  \n\n对于 $100\\%$ 的数据，$n,m\\le2\\times10^5,k\\le10^9$  ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「C.E.L.U-02」苦涩", "background": "回想起自己的过往的人生，YQH 觉得心中充满了苦涩。如果人生能再来一次，我一定会少做一些傻事，少真香几次，然后大胆地去追寻自己的爱。可惜没有这样一个机会了。  ", "description": "在 YQH 的梦中，他看到自己过去的记忆正在不断浮现在自己脑中。这些记忆带给他的是满满的苦涩。他想要强行忘记一些来减轻自己的苦涩。  \nYQH 的脑中可以被分成 $n$ 个片区，每个片区相当于一个存放记忆的可重集，初始为空。他将进行 $m$ 次这三种操作：  \n操作 1：区间 $l\\sim r$ 的片区中都浮现了一个苦涩值为 $k$ 的记忆。    \n操作 2：YQH 开始清理 $l\\sim r$ 片区的记忆。如果一个片区 $k\\in[l,r]$ 且 $k$ 中苦涩值最大的记忆与 $l\\sim r$ 片区中苦涩值最大的记忆相等，则将这个苦涩值最大的记忆忘记。如果在同一个片区有多个相同的苦涩值最大的记忆，则只忘记一个。如果这些片区内没有记忆，则无视。  \n操作 3：YQH 想知道，$l\\sim r$ 片区中苦涩值最大的记忆的苦涩值是多少，如果不存在，输出`-1`。  ", "inputFormat": "第一行两个数，$n,m$。  \n接下来 $m$ 行，第一个数代表操作种类 $op$，对于操作 1，有三个数 $l,r,k$，对于操作 2 或 3，有两个数 $l,r$。", "outputFormat": "对于每个操作 3 输出一行，代表答案。", "hint": "### 样例解释 \n\n**样例解释一**\n\n下面为各操作之后 YQH 的大脑的状态：  \n第一次操作：$\\{2\\},\\{2\\},\\{2\\},\\varnothing,\\varnothing$  \n第二次操作：$\\{2\\},\\{2,3\\},\\{2,3\\},\\{3\\},\\varnothing$    \n第三次操作：$\\{2\\},\\{2,3\\},\\{2\\},\\{3\\},\\varnothing$    \n第四次操作询问 区间 $1\\sim 3$ 的最大值，所以答案是 $3$。\n\n**样例解释二**\n\n下面为各操作之后 YQH 的大脑的状态：  \n第一次操作：$\\{2\\},\\{2\\},\\{2\\},\\{2\\},\\{2\\},\\{2\\}$  \n第二次操作：$\\{2\\},\\{2\\},\\{2,2\\},\\{2\\},\\{2\\},\\{2\\}$  \n第三次操作：$\\{2\\},\\{2\\},\\{2,2,3\\},\\{2,3\\},\\{2\\},\\{2\\}$   \n第四次操作：$\\{2\\},\\{2\\},\\{2,2\\},\\{2\\},\\{2\\},\\{2\\}$  \n第五次操作询问 $3$ 的最大值，所以答案是 $2$。  \n第六次操作询问 $4$ 的最大值，所以答案是 $2$。  \n\n### 数据范围  \n|Subtask|n|m|特殊性质|\n|:---:|:---:|:---:|:---:|\n|$1(10pts)$|$\\leq10^3$|$\\le10^3$|$\\diagdown$|\n|$2(20pts)$|$\\leq5\\times10^4$|$\\leq5\\times10^4$|没有操作 2|\n|$3(10pts)$|$\\leq5\\times10^4$|$\\leq5\\times10^4$|操作 2 中 $l=r$|\n|$4(20pts)$|$\\leq5\\times10^4$|$\\leq5\\times10^4$|$\\diagdown$|\n|$5(20pts)$|$\\leq2\\times10^5$|$\\leq2\\times10^5$|操作 2 中 $l=r$|\n|$6(20pts)$|$\\leq2\\times10^5$|$\\leq2\\times10^5$|$\\diagdown$|  \n\n对于 $100\\%$ 的数据，$n,m\\le2\\times10^5,k\\le10^9$  ", "locale": "zh-CN"}}}
{"pid": "P7477", "type": "P", "difficulty": 6, "samples": [["6 0\n6 2 8 5 7 3", "2"], ["10 3\n1 3 4 3 8 2 3 4 5 6\n2 3\n6 7\n1 9\n", "5"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["O2优化", "图论建模", "2-SAT", "可持久化线段树"], "title": "「C.E.L.U-02」划分可重集", "background": "", "description": "给你一个长度为 $n$ 的数列 $v$，请你将其划分成两个可重集 $a$ 和 $b$。你将从左至右开始划分，每个数必须至少被划分进一个可重集中。  \n一个数 $v_i$ 可以被划分进 $a$ 当且仅当 $j<i \\ and\\ v_j\\le v_i-k$ 的 $v_j$ 都没有被划分进当前的 $a$。一个数 $v_i$ 可以被划分进 $b$ 当且仅当 $j<i\\ and\\ v_j\\ge v_i+k$ 的 $v_j$ 都没有被划分进当前的 $b$。  \n同时给出了 $m$ 组关系，每组关系代表 $u$ 和 $v$ 不能划分进同一个可重集里。求能使划分成功的最小的 $k$。如果不存在合法划分，请输出 `-1`。", "inputFormat": "第一行两个数 $n,m$，意义在题目描述中。 \t   \n接下来一行共 $n$ 个数，代表 $v$。   \n下面 $m$ 行每行两个数，表示一组关系。", "outputFormat": "仅一个数，答案。", "hint": "### 样例解释\n\n**样例解释一**\n\n以下是一组合法的划分：  \n|6|2|8|5|7|3|\n|:---:|:---:|:---:|:---:|:---:|:---:|\n|a|b|b|a|b|a|\n\n**样例解释二**\n\n以下是一组合法的划分：  \n|1|3|4|3|8|2|3|4|5|6|\n|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|\n|b|b|a|b|a|b|a|a|a|b|\n\n### 数据范围 \n|数据编号|$n$|$m$|\n|:---:|:---:|:---:|\n|$1\\sim2$|$\\le10^3$|$0$|\n|$3\\sim4$|$\\le10^3$|$\\le10^3$|\n|$5\\sim6$|$\\le2\\times10^4$|$0$|\n|$7\\sim10$|$\\le2\\times10^4$|$\\le2\\times10^4$|\n\n对于 $100\\%$ 的数据，$n,m\\le2\\times10^4,v_i\\le10^9$，保证 $u<v\\le n$，没有一对相同的 $u,v$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「C.E.L.U-02」划分可重集", "background": "", "description": "给你一个长度为 $n$ 的数列 $v$，请你将其划分成两个可重集 $a$ 和 $b$。你将从左至右开始划分，每个数必须至少被划分进一个可重集中。  \n一个数 $v_i$ 可以被划分进 $a$ 当且仅当 $j<i \\ and\\ v_j\\le v_i-k$ 的 $v_j$ 都没有被划分进当前的 $a$。一个数 $v_i$ 可以被划分进 $b$ 当且仅当 $j<i\\ and\\ v_j\\ge v_i+k$ 的 $v_j$ 都没有被划分进当前的 $b$。  \n同时给出了 $m$ 组关系，每组关系代表 $u$ 和 $v$ 不能划分进同一个可重集里。求能使划分成功的最小的 $k$。如果不存在合法划分，请输出 `-1`。", "inputFormat": "第一行两个数 $n,m$，意义在题目描述中。 \t   \n接下来一行共 $n$ 个数，代表 $v$。   \n下面 $m$ 行每行两个数，表示一组关系。", "outputFormat": "仅一个数，答案。", "hint": "### 样例解释\n\n**样例解释一**\n\n以下是一组合法的划分：  \n|6|2|8|5|7|3|\n|:---:|:---:|:---:|:---:|:---:|:---:|\n|a|b|b|a|b|a|\n\n**样例解释二**\n\n以下是一组合法的划分：  \n|1|3|4|3|8|2|3|4|5|6|\n|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|\n|b|b|a|b|a|b|a|a|a|b|\n\n### 数据范围 \n|数据编号|$n$|$m$|\n|:---:|:---:|:---:|\n|$1\\sim2$|$\\le10^3$|$0$|\n|$3\\sim4$|$\\le10^3$|$\\le10^3$|\n|$5\\sim6$|$\\le2\\times10^4$|$0$|\n|$7\\sim10$|$\\le2\\times10^4$|$\\le2\\times10^4$|\n\n对于 $100\\%$ 的数据，$n,m\\le2\\times10^4,v_i\\le10^9$，保证 $u<v\\le n$，没有一对相同的 $u,v$。", "locale": "zh-CN"}}}
{"pid": "P7478", "type": "P", "difficulty": 2, "samples": [["3\nacb", "1 3"], ["6\nzyxwvu", "-1"], ["14\naabbccddccbbaa", "6 8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": [], "title": "StickSuger", "background": "YSGHYYDS", "description": "YSGH 给你一个长度为 $n$ 的字符串 $S$。设 $S_x$ 表示字符串 $S$ 的第 $x$ 个字符。你可以选择一个二元组 $(i,j)$，然后交换 $S_i$ 和 $S_j$。二元组 $(i,j)$ 是合法的当且仅当 $1\\leq i<j\\leq n$ 并且交换后的字符串的字典序比原串大。\n\n对于两个字符 $c_0,c_1$，称 $c_0>c_1$ 当且仅当 $c_0$ 的 ASCII 码大于 $c_1$ 的 ASCII 码。\n\n对于两个长度为 $n$ 的字符串 $S,T$，$S$ 的字典序大于 $T$ 当且仅当存在一个 $i\\in [0,n-1]$ 使得 $\\forall j\\in[1,i],S_j=T_j$， 并且 $S_{i+1}>T_{i+1}$。\n\n如果存在多种合法方案，输出最大的二元组。\n\n对于两个二元组 $(i_1,j_1)$，$(i_2,j_2)$，称  $(i_1,j_1)$ 小于 $(i_2,j_2)$ 当且仅当 $i_1<i_2\\lor(i_1=i_2\\land j_1<j_2)$。\n\n如果不存在合法方案，则输出 `-1`。 \n\n保证 $S$ 只包含小写英文字母。", "inputFormat": "第一行，一个正整数 $n$，表示字符串 $S$ 的长度。\n\n第二行，一个字符串 $S$。", "outputFormat": "如果无解，输出 `-1`。\n\n否则一行输出两个整数 $i,j$ 表示最大的合法二元组 $(i,j)$。", "hint": "**【样例解释 #1】**\n\n如果选择二元组 $(2,3)$，交换 $S_2$ 和 $S_3$ 后的字符串为 `abc`，字典序比 `acb` 小，所以不合法。\n\n如果选择二元组 $(1,3)$，交换 $S_1$ 和 $S_3$ 后的字符串为 `bca`，字典序比 `acb` 大，是合法的。\n\n虽然 $(1,2)$ 也是合法的，但是没有 $(1,3)$ 大。所以答案是 $(1,3)$。 \n\n**【样例解释 #2】**\n\n容易看出任何一个二元组都不合法。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 10^6$，$S$ 只包含小写英文字母。\n\n- Subtask 1（4 points）：$S$ 只包含一种字符。\n- Subtask 2（10 points）：$n\\leq 100$。\n- Subtask 3（16 points）：$n\\leq 500$。\n- Subtask 4（25 points）：$n\\leq 5000$。\n- Subtask 5（18 points）：$n\\leq 10^5$。\n- Subtask 6（27 points）：$n\\leq 10^6$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "StickSuger", "background": "YSGHYYDS", "description": "YSGH 给你一个长度为 $n$ 的字符串 $S$。设 $S_x$ 表示字符串 $S$ 的第 $x$ 个字符。你可以选择一个二元组 $(i,j)$，然后交换 $S_i$ 和 $S_j$。二元组 $(i,j)$ 是合法的当且仅当 $1\\leq i<j\\leq n$ 并且交换后的字符串的字典序比原串大。\n\n对于两个字符 $c_0,c_1$，称 $c_0>c_1$ 当且仅当 $c_0$ 的 ASCII 码大于 $c_1$ 的 ASCII 码。\n\n对于两个长度为 $n$ 的字符串 $S,T$，$S$ 的字典序大于 $T$ 当且仅当存在一个 $i\\in [0,n-1]$ 使得 $\\forall j\\in[1,i],S_j=T_j$， 并且 $S_{i+1}>T_{i+1}$。\n\n如果存在多种合法方案，输出最大的二元组。\n\n对于两个二元组 $(i_1,j_1)$，$(i_2,j_2)$，称  $(i_1,j_1)$ 小于 $(i_2,j_2)$ 当且仅当 $i_1<i_2\\lor(i_1=i_2\\land j_1<j_2)$。\n\n如果不存在合法方案，则输出 `-1`。 \n\n保证 $S$ 只包含小写英文字母。", "inputFormat": "第一行，一个正整数 $n$，表示字符串 $S$ 的长度。\n\n第二行，一个字符串 $S$。", "outputFormat": "如果无解，输出 `-1`。\n\n否则一行输出两个整数 $i,j$ 表示最大的合法二元组 $(i,j)$。", "hint": "**【样例解释 #1】**\n\n如果选择二元组 $(2,3)$，交换 $S_2$ 和 $S_3$ 后的字符串为 `abc`，字典序比 `acb` 小，所以不合法。\n\n如果选择二元组 $(1,3)$，交换 $S_1$ 和 $S_3$ 后的字符串为 `bca`，字典序比 `acb` 大，是合法的。\n\n虽然 $(1,2)$ 也是合法的，但是没有 $(1,3)$ 大。所以答案是 $(1,3)$。 \n\n**【样例解释 #2】**\n\n容易看出任何一个二元组都不合法。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 10^6$，$S$ 只包含小写英文字母。\n\n- Subtask 1（4 points）：$S$ 只包含一种字符。\n- Subtask 2（10 points）：$n\\leq 100$。\n- Subtask 3（16 points）：$n\\leq 500$。\n- Subtask 4（25 points）：$n\\leq 5000$。\n- Subtask 5（18 points）：$n\\leq 10^5$。\n- Subtask 6（27 points）：$n\\leq 10^6$。\n", "locale": "zh-CN"}}}
{"pid": "P7479", "type": "P", "difficulty": 4, "samples": [["3\n3 5\n.*.*.\n.***.\n.....\n2 5\n.*.*.\n.***.\n6 5\n.*...\n.***.\n**.**\n*...*\n**.**\n*****", "NO\nYES\nNO"], ["1\n1 3\n.*.\n", "YES"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": [], "title": "至曾是英雄的您", "background": "YSGHYYDS", "description": "YSGH 有一个 $n\\times m$ 的围棋棋盘，初始时，每个位置要么是空的，要么有一个黑棋棋子。**保证黑棋是连通的。**\n\n在围棋中，一个棋子的「气」是与它相邻的所有**空**位置构成的集合。\n\n设棋盘上第 $i$ 行第 $j$ 个位置为 $(i,j)$。\n\n两个分别在 $(i_1,j_1)$ 和 $(i_2,j_2)$ 的**同色**棋子如果满足 $|i_1-i_2|+|j_1-j_2|=1$，就认为是相邻的，也就是在同一个连通块里。\n\n一个连通块的「气」是这个连通块中所有棋子的「气」的并集。\n\n白方走一步棋是合法的，当且仅当走完这手棋之后这个棋子所在连通块的「气」大于等于 $1$ 或者黑棋连通块的「气」等于 $0$。\n\n比如下图，绿色的位置都是黑棋连通块的「气」。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wzrjvpox.png)\n\n「活棋」的定义：无论对方连续走多少手棋，在每步棋都是合法的情况下，该连通块的「气」都大于等于 $1$。\n\n请你判断这个黑棋连通块是否是「活棋」。\n\n如果是，输出 `YES`，否则输出 `NO`。\n\n**本题有多测。**", "inputFormat": "第一行，一个正整数 $T$，表示数据组数。\n\n对于每组数据：\n\n第一行，两个正整数 $n, m$，表示棋盘的大小为 $n \\times m$。\n\n接下来 $n$ 行，每行一个长度为 $m$ 的字符串。第 $i$ 行第 $j$ 个字符表示棋盘上位置为 $(i, j)$ 的地方是否有棋子。`.` 表示空格，`*` 表示黑棋子。", "outputFormat": "如果黑棋是「活棋」，输出 `YES`，否则输出 `NO`。", "hint": "**【样例解释 #1】**\n\n第 1 组数据：\n\n白棋依次走 $(1,1),(2,1),(3,2),(3,3),(3,4),(1,5),(2,5),(1,3)$ 即可使得黑棋连通块的「气」变成 $0$ 了。\n\n不妨用 `@` 表示白棋，那么最终局面就是：\n\n```plain\n@*@*@\n@***@\n.@@@.\n```\n\n第 2 组数据：\n\n比方说白棋先走 $(1,1)$ 那么白棋之后就再也走不到 $(1,3)$ 和 $(2,1)$ 了，导致黑棋的「气」永远大于等于 $1$，所以黑棋是「活棋」。\n\n第 3 组数据：\n\n最终使得黑棋连通块的「气」等于 $0$ 的局面：\n\n```plain\n@*@@.\n@***@\n**@**\n*@.@*\n**@**\n*****\n```\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n对于 $100 \\%$ 的数据，$1 \\le n, m \\le 2 \\times {10}^3$，$1 \\le T \\le {10}^5$。输入的初始棋盘的每个位置要么是 `.`，要么是 `*`，并且至少有一个 `.`，至少有一个 `*`。**保证黑棋是连通的。** 保证每个测试点的 $n \\times m$ 之和都小于等于 $4 \\times {10}^6$。\n\n- Subtask 1（9 points）：$n = 1$。\n- Subtask 2（10 points）：$n = 2$，$m = 3$。\n- Subtask 3（16 points）：保证 `.` 的个数不超过 $7$，$n, m \\le 10$，$T \\le 50$。\n- Subtask 4（24 points）：保证 `.` 的个数不超过 $14$，$n, m \\le 10$，$T \\le 50$。\n- Subtask 5（15 points）：$n, m \\ge 3$，输入局面的边界上都是 `.`。即 $\\forall (i, j)$，如果 $i = 1 \\lor i = n \\lor j = 1 \\lor j = m$，则 $(i, j)$ 一定是空地。 \n- Subtask 6（26 points）：无特殊限制。 \n\n---\n---\n---\n\nP.S. Froggy 和 uyom 都是（很久没下棋的）业余四段哥，欢迎找我们然后把我们虐一顿。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "至曾是英雄的您", "background": "YSGHYYDS", "description": "YSGH 有一个 $n\\times m$ 的围棋棋盘，初始时，每个位置要么是空的，要么有一个黑棋棋子。**保证黑棋是连通的。**\n\n在围棋中，一个棋子的「气」是与它相邻的所有**空**位置构成的集合。\n\n设棋盘上第 $i$ 行第 $j$ 个位置为 $(i,j)$。\n\n两个分别在 $(i_1,j_1)$ 和 $(i_2,j_2)$ 的**同色**棋子如果满足 $|i_1-i_2|+|j_1-j_2|=1$，就认为是相邻的，也就是在同一个连通块里。\n\n一个连通块的「气」是这个连通块中所有棋子的「气」的并集。\n\n白方走一步棋是合法的，当且仅当走完这手棋之后这个棋子所在连通块的「气」大于等于 $1$ 或者黑棋连通块的「气」等于 $0$。\n\n比如下图，绿色的位置都是黑棋连通块的「气」。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wzrjvpox.png)\n\n「活棋」的定义：无论对方连续走多少手棋，在每步棋都是合法的情况下，该连通块的「气」都大于等于 $1$。\n\n请你判断这个黑棋连通块是否是「活棋」。\n\n如果是，输出 `YES`，否则输出 `NO`。\n\n**本题有多测。**", "inputFormat": "第一行，一个正整数 $T$，表示数据组数。\n\n对于每组数据：\n\n第一行，两个正整数 $n, m$，表示棋盘的大小为 $n \\times m$。\n\n接下来 $n$ 行，每行一个长度为 $m$ 的字符串。第 $i$ 行第 $j$ 个字符表示棋盘上位置为 $(i, j)$ 的地方是否有棋子。`.` 表示空格，`*` 表示黑棋子。", "outputFormat": "如果黑棋是「活棋」，输出 `YES`，否则输出 `NO`。", "hint": "**【样例解释 #1】**\n\n第 1 组数据：\n\n白棋依次走 $(1,1),(2,1),(3,2),(3,3),(3,4),(1,5),(2,5),(1,3)$ 即可使得黑棋连通块的「气」变成 $0$ 了。\n\n不妨用 `@` 表示白棋，那么最终局面就是：\n\n```plain\n@*@*@\n@***@\n.@@@.\n```\n\n第 2 组数据：\n\n比方说白棋先走 $(1,1)$ 那么白棋之后就再也走不到 $(1,3)$ 和 $(2,1)$ 了，导致黑棋的「气」永远大于等于 $1$，所以黑棋是「活棋」。\n\n第 3 组数据：\n\n最终使得黑棋连通块的「气」等于 $0$ 的局面：\n\n```plain\n@*@@.\n@***@\n**@**\n*@.@*\n**@**\n*****\n```\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n对于 $100 \\%$ 的数据，$1 \\le n, m \\le 2 \\times {10}^3$，$1 \\le T \\le {10}^5$。输入的初始棋盘的每个位置要么是 `.`，要么是 `*`，并且至少有一个 `.`，至少有一个 `*`。**保证黑棋是连通的。** 保证每个测试点的 $n \\times m$ 之和都小于等于 $4 \\times {10}^6$。\n\n- Subtask 1（9 points）：$n = 1$。\n- Subtask 2（10 points）：$n = 2$，$m = 3$。\n- Subtask 3（16 points）：保证 `.` 的个数不超过 $7$，$n, m \\le 10$，$T \\le 50$。\n- Subtask 4（24 points）：保证 `.` 的个数不超过 $14$，$n, m \\le 10$，$T \\le 50$。\n- Subtask 5（15 points）：$n, m \\ge 3$，输入局面的边界上都是 `.`。即 $\\forall (i, j)$，如果 $i = 1 \\lor i = n \\lor j = 1 \\lor j = m$，则 $(i, j)$ 一定是空地。 \n- Subtask 6（26 points）：无特殊限制。 \n\n---\n---\n---\n\nP.S. Froggy 和 uyom 都是（很久没下棋的）业余四段哥，欢迎找我们然后把我们虐一顿。", "locale": "zh-CN"}}}
{"pid": "P7480", "type": "P", "difficulty": 5, "samples": [["3 5 10\n10 5\n2 4\n1 7", "19\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化"], "title": "Reboot from Blue", "background": "YSGHYYDS", "description": "数轴上有 $n$ 个加油站，第 $i$ 个位于 $x_i$，油价是每升 $c_i$ 元。\n\nYSGH 和他的车一开始位于坐标 $s$，它想去坐标 $t$（$s < t$），车的油箱一开始是空的，保证坐标 $s$ 有加油站。\n\n假设车的油箱容量无限大，一升油能走距离 $1$。\n\n他想知道他需要花费的最小费用。", "inputFormat": "第一行，三个整数 $n, s, t$，意义同题面描述。\n\n接下来 $n$ 行，每行两个整数 $c_i, x_i$，分别表示第 $i$ 个加油站的油价和坐标。", "outputFormat": "仅一行，一个整数，表示答案。", "hint": "**【样例解释】**\n\n最优方案是在第一个加油站加 $1$ 升油到第二个加油站。\n\n在第二个加油站加 $3$ 升油到第三个加油站。\n\n在第三个加油站加 $3$ 升油到终点。\n\n答案是 $10 + 2 \\times 3 + 1 \\times 3 = 19$。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le {10}^5$，$-{10}^9 \\le x_i, s, t \\le {10}^9$，$1 \\le c_i \\le {10}^9$，$s < t$，保证坐标 $s$ 有加油站。\n\n- Subtask 1（10 points）：$n \\le 20$。\n- Subtask 2（30 points）：$n \\le 5000$。\n- Subtask 3（20 points）：$c_i$ 在 $[1, {10}^9]$ 中等概率随机。\n- Subtask 4（40 points）：无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "Reboot from Blue", "background": "YSGHYYDS", "description": "数轴上有 $n$ 个加油站，第 $i$ 个位于 $x_i$，油价是每升 $c_i$ 元。\n\nYSGH 和他的车一开始位于坐标 $s$，它想去坐标 $t$（$s < t$），车的油箱一开始是空的，保证坐标 $s$ 有加油站。\n\n假设车的油箱容量无限大，一升油能走距离 $1$。\n\n他想知道他需要花费的最小费用。", "inputFormat": "第一行，三个整数 $n, s, t$，意义同题面描述。\n\n接下来 $n$ 行，每行两个整数 $c_i, x_i$，分别表示第 $i$ 个加油站的油价和坐标。", "outputFormat": "仅一行，一个整数，表示答案。", "hint": "**【样例解释】**\n\n最优方案是在第一个加油站加 $1$ 升油到第二个加油站。\n\n在第二个加油站加 $3$ 升油到第三个加油站。\n\n在第三个加油站加 $3$ 升油到终点。\n\n答案是 $10 + 2 \\times 3 + 1 \\times 3 = 19$。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le {10}^5$，$-{10}^9 \\le x_i, s, t \\le {10}^9$，$1 \\le c_i \\le {10}^9$，$s < t$，保证坐标 $s$ 有加油站。\n\n- Subtask 1（10 points）：$n \\le 20$。\n- Subtask 2（30 points）：$n \\le 5000$。\n- Subtask 3（20 points）：$c_i$ 在 $[1, {10}^9]$ 中等概率随机。\n- Subtask 4（40 points）：无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P7481", "type": "P", "difficulty": 6, "samples": [["3 3", "7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化"], "title": "梦现时刻", "background": "", "description": "给定 $n,m$ ，保证 $m\\le n$，令 $F(a,b)=\\sum_{i=0}^{b}\\binom{b}{i}\\binom{n-i}{a}$。\n\n求 $\\bigoplus_{a=1}^{m}\\bigoplus_{b=1}^{m}(F(a,b) \\bmod 998244353)$。\n\n其中 $\\oplus$ 表示异或运算。", "inputFormat": "第一行两个整数 $n,m$，意义同题面描述。", "outputFormat": "一行一个整数表示答案。", "hint": "**【数据范围】**\n\n**本题采用捆绑测试。**\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le {10}^9$，$1\\le m\\le 5000$，保证 $m\\le n$\n\n- Subtask 1（20 points）：$n \\le 500$。\n- Subtask 2（30 points）：$n \\le 5000$。\n- Subtask 3（50 points）：无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "梦现时刻", "background": "", "description": "给定 $n,m$ ，保证 $m\\le n$，令 $F(a,b)=\\sum_{i=0}^{b}\\binom{b}{i}\\binom{n-i}{a}$。\n\n求 $\\bigoplus_{a=1}^{m}\\bigoplus_{b=1}^{m}(F(a,b) \\bmod 998244353)$。\n\n其中 $\\oplus$ 表示异或运算。", "inputFormat": "第一行两个整数 $n,m$，意义同题面描述。", "outputFormat": "一行一个整数表示答案。", "hint": "**【数据范围】**\n\n**本题采用捆绑测试。**\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le {10}^9$，$1\\le m\\le 5000$，保证 $m\\le n$\n\n- Subtask 1（20 points）：$n \\le 500$。\n- Subtask 2（30 points）：$n \\le 5000$。\n- Subtask 3（50 points）：无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P7482", "type": "P", "difficulty": 6, "samples": [["3\n1 2 4", "18"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化"], "title": "不条理狂诗曲", "background": "YSGHYYDS", "description": "YSGH 有一个长度为 $n$ 的非负整数序列 $a$，定义 $f(l, r)$ 表示从 $a$ 序列的区间 $[l, r]$ 选择若干不相邻的数的和的最大值。 \n\nYSGH 想知道 $\\displaystyle \\left[ \\sum_{l = 1}^{n} \\sum_{r = l}^{n} f(l, r) \\right] \\bmod ({10}^9 + 7)$ 。", "inputFormat": "第一行，一个正整数 $n$，表示序列长度。\n\n第二行，$n$ 个非负整数 $a_1, a_2, \\ldots , a_n$。", "outputFormat": "仅一行，一个整数，表示答案。", "hint": "**【样例解释】**\n\n$f(1, 1)=1$，$f(1, 2)=2$，$f(1, 3)=5$，$f(2, 2)=2$，$f(2, 3)=4$，$f(3, 3)=4$。\n\n答案为 $1 + 2 + 5 + 2 + 4 + 4 = 18$。\n\n---\n\n**【数据范围】**\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le {10}^5$，$0 \\le a_i \\le {10}^9$。\n\n- Subtask 1（10 points）：$n \\le 500$。\n- Subtask 2（20 points）：$n \\le 5000$。\n- Subtask 3（20 points）：$a_i \\in \\{ 0, 1 \\}$。\n- Subtask 4（20 points）：$a_i \\in \\{ 1, x \\}$，$x$ 是大于 $1$ 的整数。\n- Subtask 5（30 points）：无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "不条理狂诗曲", "background": "YSGHYYDS", "description": "YSGH 有一个长度为 $n$ 的非负整数序列 $a$，定义 $f(l, r)$ 表示从 $a$ 序列的区间 $[l, r]$ 选择若干不相邻的数的和的最大值。 \n\nYSGH 想知道 $\\displaystyle \\left[ \\sum_{l = 1}^{n} \\sum_{r = l}^{n} f(l, r) \\right] \\bmod ({10}^9 + 7)$ 。", "inputFormat": "第一行，一个正整数 $n$，表示序列长度。\n\n第二行，$n$ 个非负整数 $a_1, a_2, \\ldots , a_n$。", "outputFormat": "仅一行，一个整数，表示答案。", "hint": "**【样例解释】**\n\n$f(1, 1)=1$，$f(1, 2)=2$，$f(1, 3)=5$，$f(2, 2)=2$，$f(2, 3)=4$，$f(3, 3)=4$。\n\n答案为 $1 + 2 + 5 + 2 + 4 + 4 = 18$。\n\n---\n\n**【数据范围】**\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le {10}^5$，$0 \\le a_i \\le {10}^9$。\n\n- Subtask 1（10 points）：$n \\le 500$。\n- Subtask 2（20 points）：$n \\le 5000$。\n- Subtask 3（20 points）：$a_i \\in \\{ 0, 1 \\}$。\n- Subtask 4（20 points）：$a_i \\in \\{ 1, x \\}$，$x$ 是大于 $1$ 的整数。\n- Subtask 5（30 points）：无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P7483", "type": "P", "difficulty": 6, "samples": [["5 2 1\n346 412\n464 685\n895 544\n976 322\n612 121\n346 712 2\n850 932 3\n", "4068\n"], ["5 2 2\n346 412\n464 685\n895 544\n976 322\n612 121\n233 749 798465123\n698 985 151455772\n", "105133973"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "O2优化", "动态规划优化", "组合数学", "二项式定理", "容斥原理"], "title": "50 年后的我们", "background": "YSGHYYDS", "description": "YSGH 给一场比赛出了 $n$ 道题，第 $i$ 道题的难度为 $d_i$，价值为 $c_i$。\n\n有 $m$ 个可能参赛的选手。第 $i$ 个选手有 $p_i$ 的概率会参加比赛。若第 $i$ 个选手参加比赛，则该选手会恰好通过难度在 $l_i$ 到 $r_i$ 之间（包括 $l_i$ 和 $r_i$）的所有题目。\n\n比赛组委会最终给 YSGH 的奖金为所有题中，有选手通过的题的价值之和的 $k$ 次幂。特别地，我们定义 $0$ 的 $0$ 次幂等于 $1$。\n\nYSGH 想让你帮他求出奖金的期望。\n\n令 $P=998244353$，设一个有理数 $x$ 表示成最简分数的形式为 $\\frac{a}{b}$，若 $\\gcd(b,P)=1$，则存在唯一的整数 $c$（$0 \\le c < P$）满足 $b c \\equiv a \\pmod{P}$，我们称 $x$ 在模 $P$ 意义下的值为 $c$。\n\n可以证明，在仅给出 $p_i$ 模 $P$ 意义下的值时，答案仍然在模 $P$ 意义下唯一存在。", "inputFormat": "第一行，三个整数 $n,m,k$，表示题目数量，可能参赛的人数，以及计算奖金需要的参数。\n\n接下来 $n$ 行，第 $i$ 行两个整数 $d_i, c_i$，分别表示第 $i$ 道题的难度和价值。\n\n接下来 $m$ 行，第 $i$ 行三个整数 $l_i, r_i, p_i$，分别表示第 $i$ 个选手通过的题的难度区间，以及来参加比赛的概率在模 $P$ 意义下的值。", "outputFormat": "一行，一个整数，表示奖金的期望在模 $P$ 意义下的值。", "hint": "**【样例解释 \\#1】**\n\n该样例满足特殊性质 A。\n\n第一个人若参赛，可以通过第 $1,2,5$ 题。\n\n第二个人若参赛，可以通过第 $3$ 题。\n\n所以 YSGH 的奖金期望为 $(412+685+121)\\times 2\\times (1-3)+544\\times (1-2)\\times 3+(412+685+121+544)\\times 2\\times 3\\equiv 4068\\pmod{P}$。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n对于 $100\\%$ 的数据，$1\\le n\\le 400$，$0\\le k\\le 400$，$1\\le m\\le 10^5$，$1\\le d_i\\le 10^9$，$1\\le l_i\\le r_i\\le 10^9$，$0\\le c_i,p_i < 998244353$。\n\n各 Subtask 的特殊限制与分值如下：\n\n| 测试包编号 | $n\\le $ | $k\\le $ | 其他限制 | 分值 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $400$ | $1$ | 特殊性质 A | $5$ |\n| $2$ | $400$ | $1$ | 无 | $6$ |\n| $3$ | $400$ | $2$ | 特殊性质 A | $7$ |\n| $4$ | $400$ | $2$ | 无 | $8$ |\n| $6$ | $18$ | $100$ | 特殊性质 A | $3$ |\n| $5$ | $18$ | $100$ | 无 | $15$ |\n| $7$ | $100$ | $100$ | 特殊性质 A | $9$ |\n| $8$ | $100$ | $100$ | 无 | $16$ |\n| $9$ | $400$ | $400$ | 特殊性质 A | $10$ |\n| $10$ | $400$ | $400$ | 无 | $21$ |\n\n特殊性质 A：对于任意 $1\\le i < j\\le M$，都有 $[l_i,r_i]\\cap [l_j,r_j]=\\varnothing$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "50 年后的我们", "background": "YSGHYYDS", "description": "YSGH 给一场比赛出了 $n$ 道题，第 $i$ 道题的难度为 $d_i$，价值为 $c_i$。\n\n有 $m$ 个可能参赛的选手。第 $i$ 个选手有 $p_i$ 的概率会参加比赛。若第 $i$ 个选手参加比赛，则该选手会恰好通过难度在 $l_i$ 到 $r_i$ 之间（包括 $l_i$ 和 $r_i$）的所有题目。\n\n比赛组委会最终给 YSGH 的奖金为所有题中，有选手通过的题的价值之和的 $k$ 次幂。特别地，我们定义 $0$ 的 $0$ 次幂等于 $1$。\n\nYSGH 想让你帮他求出奖金的期望。\n\n令 $P=998244353$，设一个有理数 $x$ 表示成最简分数的形式为 $\\frac{a}{b}$，若 $\\gcd(b,P)=1$，则存在唯一的整数 $c$（$0 \\le c < P$）满足 $b c \\equiv a \\pmod{P}$，我们称 $x$ 在模 $P$ 意义下的值为 $c$。\n\n可以证明，在仅给出 $p_i$ 模 $P$ 意义下的值时，答案仍然在模 $P$ 意义下唯一存在。", "inputFormat": "第一行，三个整数 $n,m,k$，表示题目数量，可能参赛的人数，以及计算奖金需要的参数。\n\n接下来 $n$ 行，第 $i$ 行两个整数 $d_i, c_i$，分别表示第 $i$ 道题的难度和价值。\n\n接下来 $m$ 行，第 $i$ 行三个整数 $l_i, r_i, p_i$，分别表示第 $i$ 个选手通过的题的难度区间，以及来参加比赛的概率在模 $P$ 意义下的值。", "outputFormat": "一行，一个整数，表示奖金的期望在模 $P$ 意义下的值。", "hint": "**【样例解释 \\#1】**\n\n该样例满足特殊性质 A。\n\n第一个人若参赛，可以通过第 $1,2,5$ 题。\n\n第二个人若参赛，可以通过第 $3$ 题。\n\n所以 YSGH 的奖金期望为 $(412+685+121)\\times 2\\times (1-3)+544\\times (1-2)\\times 3+(412+685+121+544)\\times 2\\times 3\\equiv 4068\\pmod{P}$。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n对于 $100\\%$ 的数据，$1\\le n\\le 400$，$0\\le k\\le 400$，$1\\le m\\le 10^5$，$1\\le d_i\\le 10^9$，$1\\le l_i\\le r_i\\le 10^9$，$0\\le c_i,p_i < 998244353$。\n\n各 Subtask 的特殊限制与分值如下：\n\n| 测试包编号 | $n\\le $ | $k\\le $ | 其他限制 | 分值 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $400$ | $1$ | 特殊性质 A | $5$ |\n| $2$ | $400$ | $1$ | 无 | $6$ |\n| $3$ | $400$ | $2$ | 特殊性质 A | $7$ |\n| $4$ | $400$ | $2$ | 无 | $8$ |\n| $6$ | $18$ | $100$ | 特殊性质 A | $3$ |\n| $5$ | $18$ | $100$ | 无 | $15$ |\n| $7$ | $100$ | $100$ | 特殊性质 A | $9$ |\n| $8$ | $100$ | $100$ | 无 | $16$ |\n| $9$ | $400$ | $400$ | 特殊性质 A | $10$ |\n| $10$ | $400$ | $400$ | 无 | $21$ |\n\n特殊性质 A：对于任意 $1\\le i < j\\le M$，都有 $[l_i,r_i]\\cap [l_j,r_j]=\\varnothing$。", "locale": "zh-CN"}}}
{"pid": "P7484", "type": "P", "difficulty": 7, "samples": [["4 4\n1 2\n2 3\n3 4\n1 2 3 4\n10 2 3 7\n2 5 6 1\n5 1 7 2", "30\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化"], "title": "再生之青", "background": "YSGHYYDS", "description": "YSGH 有一个大小为 $n$ 的树和一个长度为 $m$ 的序列。\n\n树上每个点 $i$ 有颜色 $c_i$ 和价值 $a_i$，颜色两两不同，**保证叶子个数不超过** $\\boldsymbol{20}$。\n\n序列第 $i$ 个位置也有一个颜色 $d_i$ 和价值 $b_i$，颜色也两两不同（但树和序列颜色可能会相同）。\n\nYSGH 想从树上选一条链和序列的一个区间满足一个颜色最多只能出现一次，他想知道他能选出来的最大的价值和。", "inputFormat": "第一行，两个正整数 $n, m$，分别表示树的大小和序列长度。\n\n接下来 $n - 1$ 行，每行两个正整数 $x, y$，表示树上的一条边。\n\n接下来一行，每行 $n$ 个正整数，第 $i$ 个表示 $c_i$。\n\n接下来一行，每行 $n$ 个正整数，第 $i$ 个表示 $a_i$。\n\n接下来一行，每行 $m$ 个正整数，第 $i$ 个表示 $d_i$。\n\n接下来一行，每行 $m$ 个正整数，第 $i$ 个表示 $b_i$。", "outputFormat": "仅一行，一个整数，表示答案。", "hint": "**【样例解释】**\n\n最优方案是选择树的 $1, 2, 3, 4$ 号节点和序列的第 $2, 3$ 个位置。\n\n价值和是 $10 + 2 + 3 + 7 + 1 + 7 = 30$。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le 5 \\times {10}^4$，$1 \\le m \\le 5 \\times {10}^5$，$1 \\le c_i, d_i \\le n + m$，$1 \\le a_i, b_i \\le {10}^9$，保证树的叶子个数不超过 $20$。\n\n+ Subtask 1（10 points）: $n, m \\le 500$。 \n+ Subtask 2（10 points）: $n, m \\le 1000$。 \n+ Subtask 3（10 points）: $n, m \\le 5000$。 \n+ Subtask 4（20 points）: 满足树的第 $i$ 条边连接的是 $i$ 和 $i + 1$。 \n+ Subtask 5（15 points）: $m \\le {10}^5$。\n+ Subtask 6（35 points）: 无特殊限制。 ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "再生之青", "background": "YSGHYYDS", "description": "YSGH 有一个大小为 $n$ 的树和一个长度为 $m$ 的序列。\n\n树上每个点 $i$ 有颜色 $c_i$ 和价值 $a_i$，颜色两两不同，**保证叶子个数不超过** $\\boldsymbol{20}$。\n\n序列第 $i$ 个位置也有一个颜色 $d_i$ 和价值 $b_i$，颜色也两两不同（但树和序列颜色可能会相同）。\n\nYSGH 想从树上选一条链和序列的一个区间满足一个颜色最多只能出现一次，他想知道他能选出来的最大的价值和。", "inputFormat": "第一行，两个正整数 $n, m$，分别表示树的大小和序列长度。\n\n接下来 $n - 1$ 行，每行两个正整数 $x, y$，表示树上的一条边。\n\n接下来一行，每行 $n$ 个正整数，第 $i$ 个表示 $c_i$。\n\n接下来一行，每行 $n$ 个正整数，第 $i$ 个表示 $a_i$。\n\n接下来一行，每行 $m$ 个正整数，第 $i$ 个表示 $d_i$。\n\n接下来一行，每行 $m$ 个正整数，第 $i$ 个表示 $b_i$。", "outputFormat": "仅一行，一个整数，表示答案。", "hint": "**【样例解释】**\n\n最优方案是选择树的 $1, 2, 3, 4$ 号节点和序列的第 $2, 3$ 个位置。\n\n价值和是 $10 + 2 + 3 + 7 + 1 + 7 = 30$。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le 5 \\times {10}^4$，$1 \\le m \\le 5 \\times {10}^5$，$1 \\le c_i, d_i \\le n + m$，$1 \\le a_i, b_i \\le {10}^9$，保证树的叶子个数不超过 $20$。\n\n+ Subtask 1（10 points）: $n, m \\le 500$。 \n+ Subtask 2（10 points）: $n, m \\le 1000$。 \n+ Subtask 3（10 points）: $n, m \\le 5000$。 \n+ Subtask 4（20 points）: 满足树的第 $i$ 条边连接的是 $i$ 和 $i + 1$。 \n+ Subtask 5（15 points）: $m \\le {10}^5$。\n+ Subtask 6（35 points）: 无特殊限制。 ", "locale": "zh-CN"}}}
{"pid": "P7485", "type": "P", "difficulty": 4, "samples": [["1\n2 3 1 3\n", "1 2\n"], ["2\n2 3 1 3\n3 7 2 4 7\n", "1 2\n2 2 5\n"], ["3\n2 3 1 3\n3 7 2 4 7\n7 10 1 2 3 6 7 8 10\n", "1 2\n2 2 5\n1 2 2 3 4 6 6\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "递推"], "title": "「Stoi2031」枫", "background": "> 缓缓飘落的枫叶像思念 为何挽回要赶在冬天来之前 爱你穿越时间 两行来自秋末的眼泪 让爱渗透了地面 我要的只是你在我身边 ——《枫》", "description": "冬很喜欢枫叶。她家门前有一棵枫树，树上落下了 $n$ 片叶子。冬将它们编号为 $1$ 到 $n$。她希望这些枫叶不要这样被人踩碎后烂在地里，所以决定把它们捡起来。她称将剩余未捡起来的枫叶按编号从小到大或从大到小的顺序排序后，先捡起第一片枫叶，然后每隔 $k$ 片捡起一片称为一次 **挽回**。她会一直进行 **挽回**，第一次 **挽回** 从小到大，之后每次 **挽回** 的顺序都和上次不同（即上次从小到大这次就从大到小，反之亦然），直到最后一片枫叶也被捡起。她认为最后一片捡起的枫叶代表了 **思念**，能带来幸福。她希望获得更多的幸福，所以她会很多次地问你 $n$ 和 $k$ 取某两个值时她得到的 **思念** 的编号。", "inputFormat": "第一行为数据组数 $t$，满足 $t=i$，$i$ 为数据点编号。\n\n第 $2$ 到 $t+1$ 行，每行开头两个数 $q,m$，表示她要取 $q$ 次，每次的枫叶数 $n$ 不超过 $m$。接着输入 $q$ 个数表示每次的枫叶数 $n$。第 $x$ 行的所有询问中 $k=x-1$。", "outputFormat": "对于每行输出 $q$ 个数，表示每次询问的答案。", "hint": "#### 简述版题意：\n\n给定 $n,k$，对 $1,2,\\dots,n$ 一直操作，每次操作交替从小到大或从大到小的顺序取走当前的第 $(k+1)x+1$ 个数（$x \\in \\mathbb{Z_{\\ge 0}}$ 且 $(k+1)x+1$ 不超过剩余数总数），求最后一个取走的数的编号。多次询问。\n\n#### 样例解释：\n\n限于篇幅，只对样例 $2$ 作解释。\n\n对于第 $2$ 行：\n\n对于第一次询问，地上只有 $1$ 片枫叶，此即 **思念**。\n\n对于第二次询问，冬第一次 **挽回** 时依次捡起了 $1,3$ 两片枫叶，转身后只剩下 $2$，即 **思念**。\n\n对于第 $3$ 行：\n\n对于第一次询问，冬第一次 **挽回** 时捡起了 $1$ 号枫叶，转身后剩下 $2$，即 **思念**。\n\n对于第二次询问，冬第一次 **挽回** 时捡起了 $1,4$ 两片枫叶，第二次 **挽回** 捡起了 $3$，剩下 $2$，即 **思念**。\n\n对于第三次询问，冬第一次捡起了 $1,4,7$，第二次捡起了 $6,2$，第三次捡起了 $3$，此时剩下 $5$，即 **思念**。\n\n#### 数据范围：\n\n**本题每个数据点（除第 $1$ 个外）输入数据除数据组数 $t$ 以及最后一行（第 $t+1$ 行）外与前一个数据点输入数据完全相同。各个数据点的数据范围及特殊限制如下。**\n\n| Testdata No. | $q \\le$ | $m \\le$ | 特殊限制 | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $2$ | $3$ | 为样例 $1$ | $3$ |\n| $2$ | $3$ | $7$ | 为样例 $2$ | $7$ |\n| $3$ | $7$ | $10$ | 为样例 $3$ | $3$ |\n| $4$ | $10$ | $30$ | 无 | $3$ |\n| $5$ | $30$ | $70$ | 无 | $7$ |\n| $6$ | $70$ | $100$ | 无 | $7$ |\n| $7$ | $100$ | $300$ | 无 | $7$ |\n| $8$ | $300$ | $700$ | 无 | $10$ |\n| $9$ | $700$ | $10^3$ | 无 | $3$ |\n| $10$ | $10^3$ | $3 \\times 10^3$ | 无 | $3$ |\n| $11$ | $3 \\times 10^3$ | $7 \\times 10^3$ | 无 | $1$ |\n| $12$ | $7 \\times 10^3$ | $10^4$ | 无 | $13$ |\n| $13$ | $10^4$ | $3 \\times 10^4$ | 无 | $3$ |\n| $14$ | $3 \\times 10^4$ | $7 \\times 10^4$ | 无 | $3$ |\n| $15$ | $7 \\times 10^4$ | $10^5$ | 无 | $10$ |\n| $16$ | $10^5$ | $3 \\times 10^5$ | 无 | $13$ |\n| $17$ | $3 \\times 10^5$ | $7 \\times 10^5$ | 无 | $1$ |\n| $18$ | $7 \\times 10^5$ | $10^6$ | 无 | $3$ |\n\n**本题读入量较大，可以选择使用比赛描述中的快速读入模板以加快读入速度。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Stoi2031」枫", "background": "> 缓缓飘落的枫叶像思念 为何挽回要赶在冬天来之前 爱你穿越时间 两行来自秋末的眼泪 让爱渗透了地面 我要的只是你在我身边 ——《枫》", "description": "冬很喜欢枫叶。她家门前有一棵枫树，树上落下了 $n$ 片叶子。冬将它们编号为 $1$ 到 $n$。她希望这些枫叶不要这样被人踩碎后烂在地里，所以决定把它们捡起来。她称将剩余未捡起来的枫叶按编号从小到大或从大到小的顺序排序后，先捡起第一片枫叶，然后每隔 $k$ 片捡起一片称为一次 **挽回**。她会一直进行 **挽回**，第一次 **挽回** 从小到大，之后每次 **挽回** 的顺序都和上次不同（即上次从小到大这次就从大到小，反之亦然），直到最后一片枫叶也被捡起。她认为最后一片捡起的枫叶代表了 **思念**，能带来幸福。她希望获得更多的幸福，所以她会很多次地问你 $n$ 和 $k$ 取某两个值时她得到的 **思念** 的编号。", "inputFormat": "第一行为数据组数 $t$，满足 $t=i$，$i$ 为数据点编号。\n\n第 $2$ 到 $t+1$ 行，每行开头两个数 $q,m$，表示她要取 $q$ 次，每次的枫叶数 $n$ 不超过 $m$。接着输入 $q$ 个数表示每次的枫叶数 $n$。第 $x$ 行的所有询问中 $k=x-1$。", "outputFormat": "对于每行输出 $q$ 个数，表示每次询问的答案。", "hint": "#### 简述版题意：\n\n给定 $n,k$，对 $1,2,\\dots,n$ 一直操作，每次操作交替从小到大或从大到小的顺序取走当前的第 $(k+1)x+1$ 个数（$x \\in \\mathbb{Z_{\\ge 0}}$ 且 $(k+1)x+1$ 不超过剩余数总数），求最后一个取走的数的编号。多次询问。\n\n#### 样例解释：\n\n限于篇幅，只对样例 $2$ 作解释。\n\n对于第 $2$ 行：\n\n对于第一次询问，地上只有 $1$ 片枫叶，此即 **思念**。\n\n对于第二次询问，冬第一次 **挽回** 时依次捡起了 $1,3$ 两片枫叶，转身后只剩下 $2$，即 **思念**。\n\n对于第 $3$ 行：\n\n对于第一次询问，冬第一次 **挽回** 时捡起了 $1$ 号枫叶，转身后剩下 $2$，即 **思念**。\n\n对于第二次询问，冬第一次 **挽回** 时捡起了 $1,4$ 两片枫叶，第二次 **挽回** 捡起了 $3$，剩下 $2$，即 **思念**。\n\n对于第三次询问，冬第一次捡起了 $1,4,7$，第二次捡起了 $6,2$，第三次捡起了 $3$，此时剩下 $5$，即 **思念**。\n\n#### 数据范围：\n\n**本题每个数据点（除第 $1$ 个外）输入数据除数据组数 $t$ 以及最后一行（第 $t+1$ 行）外与前一个数据点输入数据完全相同。各个数据点的数据范围及特殊限制如下。**\n\n| Testdata No. | $q \\le$ | $m \\le$ | 特殊限制 | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $2$ | $3$ | 为样例 $1$ | $3$ |\n| $2$ | $3$ | $7$ | 为样例 $2$ | $7$ |\n| $3$ | $7$ | $10$ | 为样例 $3$ | $3$ |\n| $4$ | $10$ | $30$ | 无 | $3$ |\n| $5$ | $30$ | $70$ | 无 | $7$ |\n| $6$ | $70$ | $100$ | 无 | $7$ |\n| $7$ | $100$ | $300$ | 无 | $7$ |\n| $8$ | $300$ | $700$ | 无 | $10$ |\n| $9$ | $700$ | $10^3$ | 无 | $3$ |\n| $10$ | $10^3$ | $3 \\times 10^3$ | 无 | $3$ |\n| $11$ | $3 \\times 10^3$ | $7 \\times 10^3$ | 无 | $1$ |\n| $12$ | $7 \\times 10^3$ | $10^4$ | 无 | $13$ |\n| $13$ | $10^4$ | $3 \\times 10^4$ | 无 | $3$ |\n| $14$ | $3 \\times 10^4$ | $7 \\times 10^4$ | 无 | $3$ |\n| $15$ | $7 \\times 10^4$ | $10^5$ | 无 | $10$ |\n| $16$ | $10^5$ | $3 \\times 10^5$ | 无 | $13$ |\n| $17$ | $3 \\times 10^5$ | $7 \\times 10^5$ | 无 | $1$ |\n| $18$ | $7 \\times 10^5$ | $10^6$ | 无 | $3$ |\n\n**本题读入量较大，可以选择使用比赛描述中的快速读入模板以加快读入速度。**", "locale": "zh-CN"}}}
{"pid": "P7486", "type": "P", "difficulty": 7, "samples": [["3 7\n1 3\n2 3\n7 7\n", "21072733\n12145631\n823543\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "O2优化", "莫比乌斯反演"], "title": "「Stoi2031」彩虹", "background": "> 你要离开 我知道很简单 你说依赖 是我们的阻碍 就算放开 但能不能别没收我的爱 就当我最后才明白 ——《彩虹》", "description": "虹是一个喜欢幻想的女孩子。她认为两个正整数 $i,j$ 的 **依赖值** 为 $\\operatorname{lcm}(i,j)^{\\operatorname{lcm}(i,j)}$。她定义所有满足 $l \\le i \\le r,l \\le j \\le r$ 的 $i,j$ 的 **依赖值** 之积为两个正整数 $l,r$ 的 **阻碍值**。现在她给了你一个正整数 $n$，并 $t$ 次询问你两个满足 $1 \\le l \\le r \\le n$ 的正整数 $l,r$ 的 **阻碍值** $ans\\bmod{32465177}$。", "inputFormat": "第一行两个正整数 $t,n$。\n\n接下来 $t$ 行，每行两个正整数 $l_i,r_i$，表示一次询问。", "outputFormat": "对于每组询问输出一个整数表示答案。", "hint": "#### 简述版题意：\n\n给定 $l,r$，求 $\\prod\\limits_{i=l}^{r}\\prod\\limits_{j=l}^{r}\\operatorname{lcm}(i,j)^{\\operatorname{lcm}(i,j)} \\bmod{32465177}$。多次询问。\n\n#### 样例解释：\n\n对于第 $1$ 次询问，$ans=1^1 \\times (2^2)^3 \\times (3^3)^3 \\times (6^6)^2$，$ans \\bmod{32465177}=21072733$；\n\n对于第 $2$ 次询问，$ans=2^2 \\times 3^3 \\times (6^6)^2$，$ans \\bmod{32465177}=12145631$；\n\n对于第 $3$ 次询问，$ans=7^7=823543$。\n\n#### 数据范围：\n\n对于 $30\\%$ 的数据，$1 \\le n \\le 10^3,t=1$；\n\n对于 $60\\%$ 的数据，$1 \\le n \\le 10^5,t=1$；\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^6,1 \\le t \\le 10,1 \\le l_i \\le r_i \\le n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Stoi2031」彩虹", "background": "> 你要离开 我知道很简单 你说依赖 是我们的阻碍 就算放开 但能不能别没收我的爱 就当我最后才明白 ——《彩虹》", "description": "虹是一个喜欢幻想的女孩子。她认为两个正整数 $i,j$ 的 **依赖值** 为 $\\operatorname{lcm}(i,j)^{\\operatorname{lcm}(i,j)}$。她定义所有满足 $l \\le i \\le r,l \\le j \\le r$ 的 $i,j$ 的 **依赖值** 之积为两个正整数 $l,r$ 的 **阻碍值**。现在她给了你一个正整数 $n$，并 $t$ 次询问你两个满足 $1 \\le l \\le r \\le n$ 的正整数 $l,r$ 的 **阻碍值** $ans\\bmod{32465177}$。", "inputFormat": "第一行两个正整数 $t,n$。\n\n接下来 $t$ 行，每行两个正整数 $l_i,r_i$，表示一次询问。", "outputFormat": "对于每组询问输出一个整数表示答案。", "hint": "#### 简述版题意：\n\n给定 $l,r$，求 $\\prod\\limits_{i=l}^{r}\\prod\\limits_{j=l}^{r}\\operatorname{lcm}(i,j)^{\\operatorname{lcm}(i,j)} \\bmod{32465177}$。多次询问。\n\n#### 样例解释：\n\n对于第 $1$ 次询问，$ans=1^1 \\times (2^2)^3 \\times (3^3)^3 \\times (6^6)^2$，$ans \\bmod{32465177}=21072733$；\n\n对于第 $2$ 次询问，$ans=2^2 \\times 3^3 \\times (6^6)^2$，$ans \\bmod{32465177}=12145631$；\n\n对于第 $3$ 次询问，$ans=7^7=823543$。\n\n#### 数据范围：\n\n对于 $30\\%$ 的数据，$1 \\le n \\le 10^3,t=1$；\n\n对于 $60\\%$ 的数据，$1 \\le n \\le 10^5,t=1$；\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^6,1 \\le t \\le 10,1 \\le l_i \\le r_i \\le n$。", "locale": "zh-CN"}}}
{"pid": "P7487", "type": "P", "difficulty": 6, "samples": [["15 2\n", "201012023\n"], ["1 3\n", "2\n"], ["521 6\n", "262795752\n"], ["6546546546546543 22211\n", "388124125\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "递推", "递归", "O2优化", "素数判断,质数,筛法"], "title": "「Stoi2031」兰亭序", "background": "> 无关风月 我题序等你回 悬笔一绝 那岸边浪千叠 情字何解 怎落笔都不对 而我独缺 你一生的了解 ——《兰亭序》", "description": "月非常喜欢复数，尤其喜欢形如 $e^{2\\pi it}$ 的复数。她选择了两个正整数 $n,k$，并将 $1+e^{\\frac{2\\pi i x_1 \\dots x_k}{n}}$ 称为 $(x_1,\\dots,x_k)$ 的 **绝对度**，所有满足 $1 \\le x_i \\le n$ $(i \\in \\{1,2,\\dots,k\\})$ 的 $(x_1,\\dots,x_k)$ 的 **绝对度** 之积称为 $(n,k)$ 的 **无关度**。现在她想请你帮她对 $t \\in \\{1,2,\\dots,k\\}$ 求出 $(n,t)$ 的 **无关度** $ans \\bmod{335544323}$。由于回答太多的数太麻烦，你只要回答她所有答案进行异或运算后的结果。", "inputFormat": "一行两个正整数 $n,k$。", "outputFormat": "一行一个自然数表示答案。", "hint": "#### 简述版题意：\n\n给定 $n,k$，对 $1 \\le t \\le k$ 求\n\n$$\\prod_{x_1=1}^{n}\\prod_{x_2=1}^{n}\\dots\\prod_{x_t=1}^{n}\\left( 1+e^{\\frac{2\\pi ix_1x_2\\dots x_t}{n}} \\right) \\bmod{335544323}$$\n\n输出所有 $k$ 个答案的异或和。\n\n其中 $e^{it}=\\cos{t}+i\\sin{t}$ 对所有 $t \\in \\mathbb{R}$ 成立，$i$ 为虚数单位，满足 $i^2=-1$。\n\n#### 样例解释：\n\n对于第一组样例，$t=1,2$ 时答案分别为 $2,35184372088832$，取模后为 $2,201012021$，异或和为 $201012023$。\n\n对于第二组样例，$t=1,2,3$ 时答案均为 $2$，异或和为 $2$。\n\n限于篇幅，剩下的样例不作解释说明。\n\n#### 数据范围：\n\n**本题采用捆绑测试，各个 Subtask 的限制与分值如下：**\n\n| Subtask No. | $n \\le$ | $k \\le$ | 特殊限制 | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $10$ | $1$ | 无 | $7$ |\n| $2$ | $1$ | $10$ | 无 | $7$ |\n| $3$ | $10$ | $2$ | 无 | $7$ |\n| $4$ | $10^{18}$ | $10^5$ | $n$ 为偶数 | $7$ |\n| $5$ | $10$ | $10$ | $n^k \\le 730$ | $16$ |\n| $6$ | $10^9$ | $10^3$ | 无 | $19$ |\n| $7$ | $10^{18}$ | $10^5$ | 无 | $37$ |\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^{18},1 \\le k \\le 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Stoi2031」兰亭序", "background": "> 无关风月 我题序等你回 悬笔一绝 那岸边浪千叠 情字何解 怎落笔都不对 而我独缺 你一生的了解 ——《兰亭序》", "description": "月非常喜欢复数，尤其喜欢形如 $e^{2\\pi it}$ 的复数。她选择了两个正整数 $n,k$，并将 $1+e^{\\frac{2\\pi i x_1 \\dots x_k}{n}}$ 称为 $(x_1,\\dots,x_k)$ 的 **绝对度**，所有满足 $1 \\le x_i \\le n$ $(i \\in \\{1,2,\\dots,k\\})$ 的 $(x_1,\\dots,x_k)$ 的 **绝对度** 之积称为 $(n,k)$ 的 **无关度**。现在她想请你帮她对 $t \\in \\{1,2,\\dots,k\\}$ 求出 $(n,t)$ 的 **无关度** $ans \\bmod{335544323}$。由于回答太多的数太麻烦，你只要回答她所有答案进行异或运算后的结果。", "inputFormat": "一行两个正整数 $n,k$。", "outputFormat": "一行一个自然数表示答案。", "hint": "#### 简述版题意：\n\n给定 $n,k$，对 $1 \\le t \\le k$ 求\n\n$$\\prod_{x_1=1}^{n}\\prod_{x_2=1}^{n}\\dots\\prod_{x_t=1}^{n}\\left( 1+e^{\\frac{2\\pi ix_1x_2\\dots x_t}{n}} \\right) \\bmod{335544323}$$\n\n输出所有 $k$ 个答案的异或和。\n\n其中 $e^{it}=\\cos{t}+i\\sin{t}$ 对所有 $t \\in \\mathbb{R}$ 成立，$i$ 为虚数单位，满足 $i^2=-1$。\n\n#### 样例解释：\n\n对于第一组样例，$t=1,2$ 时答案分别为 $2,35184372088832$，取模后为 $2,201012021$，异或和为 $201012023$。\n\n对于第二组样例，$t=1,2,3$ 时答案均为 $2$，异或和为 $2$。\n\n限于篇幅，剩下的样例不作解释说明。\n\n#### 数据范围：\n\n**本题采用捆绑测试，各个 Subtask 的限制与分值如下：**\n\n| Subtask No. | $n \\le$ | $k \\le$ | 特殊限制 | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $10$ | $1$ | 无 | $7$ |\n| $2$ | $1$ | $10$ | 无 | $7$ |\n| $3$ | $10$ | $2$ | 无 | $7$ |\n| $4$ | $10^{18}$ | $10^5$ | $n$ 为偶数 | $7$ |\n| $5$ | $10$ | $10$ | $n^k \\le 730$ | $16$ |\n| $6$ | $10^9$ | $10^3$ | 无 | $19$ |\n| $7$ | $10^{18}$ | $10^5$ | 无 | $37$ |\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^{18},1 \\le k \\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P7488", "type": "P", "difficulty": 6, "samples": [["32 2 47\n", "36\n"], ["233 223 1926817\n", "620162\n"], ["3 1 7", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "组合数学", "Lucas 定理"], "title": "「Stoi2031」黑色毛衣", "background": "> 看着那白色的蜻蜓 在空中忘了前进 还能不能 重新编织 脑海中起毛球的记忆 再说我爱你 可能雨也不会停 黑色毛衣 藏在哪里 就让回忆永远停在那里 ——《黑色毛衣》", "description": "让想起了和雨在一起的时候。由于雨是一个爱玩的女孩子，所以他们有很多玩具，其中就有一种像 **白色蜻蜓** 一样的玩具，现在留在了让的身边，共有 $n$ 只。每只 **白色蜻蜓** 的翅膀长度分别是 $1,2,\\dots,n$，并且可以张开成 $(0,\\pi)$ 之间的任意角度。让认为使其中 $m$ 只 **白色蜻蜓** 分别张开翅膀使双翅末端的距离都为整数且互不相同的场景是在 **编织** 一份 **记忆**。他认为两份 **记忆** 相同当且仅当可以将 $m$ 只 **白色蜻蜓** 按某种方式重排后一一对应使对应的蜻蜓翅膀长度和双翅距离都相等。他想请你告诉他能编织出多少份不同的记忆。你只需要求出答案 $ans\\bmod{p}$ 的值。", "inputFormat": "一行三个正整数 $n,m,p$。", "outputFormat": "一行一个数，表示答案。", "hint": "#### 简述版题意\n\n求不同的腰长 $1 \\le a \\le n$，底长 $1 \\le b \\le 2a-1$ 且都为整数，腰长互不相同，底长也互不相同的 $m$ 个等腰三角形构成的不同组数。两组相同当且仅当可以使 $m$ 个三角形按某种方式重排后一一对应全等。\n\n#### 样例解释：\n\n限于篇幅，只对样例 $3$ 作解释。\n\n可以 **编织** 出 $1,1,1$，$2,2,1$，$2,2,2$，$2,2,3$，$3,3,1$，$3,3,2$，$3,3,3$，$3,3,4$，$3,3,5$ 共 $9$ 种 **记忆**，取模 $7$ 后为 $2$。\n\n**本题采用捆绑测试，每个 Subtask 的分数与限制如下。**\n\n| Subtask No. | $m \\le n \\le$ | 特殊限制 | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $10^3$ | 无 | $13$ |\n| $2$ | $10^6$ | 无 | $37$ |\n| $3$ | $10^{18}$ | 无 | $37$ |\n| $4$ | $10^{18}$ | $p$是质数 | $13$ |\n\n对于所有数据， $1 \\le m \\le n \\le 10^{18},1 \\le p \\le 10^5$，不保证 $p$ 是质数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Stoi2031」黑色毛衣", "background": "> 看着那白色的蜻蜓 在空中忘了前进 还能不能 重新编织 脑海中起毛球的记忆 再说我爱你 可能雨也不会停 黑色毛衣 藏在哪里 就让回忆永远停在那里 ——《黑色毛衣》", "description": "让想起了和雨在一起的时候。由于雨是一个爱玩的女孩子，所以他们有很多玩具，其中就有一种像 **白色蜻蜓** 一样的玩具，现在留在了让的身边，共有 $n$ 只。每只 **白色蜻蜓** 的翅膀长度分别是 $1,2,\\dots,n$，并且可以张开成 $(0,\\pi)$ 之间的任意角度。让认为使其中 $m$ 只 **白色蜻蜓** 分别张开翅膀使双翅末端的距离都为整数且互不相同的场景是在 **编织** 一份 **记忆**。他认为两份 **记忆** 相同当且仅当可以将 $m$ 只 **白色蜻蜓** 按某种方式重排后一一对应使对应的蜻蜓翅膀长度和双翅距离都相等。他想请你告诉他能编织出多少份不同的记忆。你只需要求出答案 $ans\\bmod{p}$ 的值。", "inputFormat": "一行三个正整数 $n,m,p$。", "outputFormat": "一行一个数，表示答案。", "hint": "#### 简述版题意\n\n求不同的腰长 $1 \\le a \\le n$，底长 $1 \\le b \\le 2a-1$ 且都为整数，腰长互不相同，底长也互不相同的 $m$ 个等腰三角形构成的不同组数。两组相同当且仅当可以使 $m$ 个三角形按某种方式重排后一一对应全等。\n\n#### 样例解释：\n\n限于篇幅，只对样例 $3$ 作解释。\n\n可以 **编织** 出 $1,1,1$，$2,2,1$，$2,2,2$，$2,2,3$，$3,3,1$，$3,3,2$，$3,3,3$，$3,3,4$，$3,3,5$ 共 $9$ 种 **记忆**，取模 $7$ 后为 $2$。\n\n**本题采用捆绑测试，每个 Subtask 的分数与限制如下。**\n\n| Subtask No. | $m \\le n \\le$ | 特殊限制 | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $10^3$ | 无 | $13$ |\n| $2$ | $10^6$ | 无 | $37$ |\n| $3$ | $10^{18}$ | 无 | $37$ |\n| $4$ | $10^{18}$ | $p$是质数 | $13$ |\n\n对于所有数据， $1 \\le m \\le n \\le 10^{18},1 \\le p \\le 10^5$，不保证 $p$ 是质数。", "locale": "zh-CN"}}}
{"pid": "P7489", "type": "P", "difficulty": 5, "samples": [["3 1 7\n1 2 3\n", "3\n"], ["3 10 7\n1 2 3\n", "4\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "O2优化", "逆元"], "title": "「Stoi2031」手写的从前", "background": "> 我看着你的脸 轻刷着和弦 情人节卡片 手写的永远 还记得广场公园 一起表演 学校旁糖果店 记忆里在微甜 ——《手写的从前》", "description": "远定义一个集合 $S$ 的 **权值** 为 $\\dfrac{\\sigma(S)}{\\pi(S)}$，其中 $\\sigma(S)=\\sum\\limits_{x \\in S}x$ 为 $S$ 中所有元素之和， $\\pi(S)=\\prod\\limits_{x \\in S}x$ 为 $S$ 中所有元素之积。甜问他，一个集合 $S$ 的 **所有子集** 的 **权值** 和是多少？远很快就算出了答案。甜又问，那 **所有子集** 的 **所有子集** 的 **权值** 和之和是多少？远又很快就算了出来。于是甜又问了一个问题，问题中总共有 $k$ 个 **所有子集**，这下远算不完了，所以他找你帮忙。远不需要回答一个太大的数，所以答案只要取模 $p$。", "inputFormat": "第一行 $3$ 个正整数 $n,k,p$，其中 $n$ 为 $S$ 中元素的个数。\n\n第二行 $n$ 个正整数，表示 $S$ 中的元素。", "outputFormat": "输出一个正整数表示答案，保证答案在模 $p$ 时有意义。", "hint": "#### 简述版题意：\n\n令 $f_0(S)=\\dfrac{\\sigma(S)}{\\pi(S)}$，$f_k(S)=\\sum\\limits_{T \\subseteq S}f_{k-1}(T)$。其中 $\\sigma(S)=\\sum\\limits_{x \\in S}x$ 为 $S$ 中所有元素之和， $\\pi(S)=\\prod\\limits_{x \\in S}x$ 为 $S$ 中所有元素之积。给定 $n,k,p$ 和集合 $S$，求 $f_k(S) \\bmod{p}$ 的值。\n\n#### 样例解释：\n\n限于篇幅，只解释样例 $1$。\n\n枚举子集：\n\n$\\emptyset$，$f_0$ 值为 $0$；\n\n$\\{1\\}$，$f_0$ 值为 $1$；\n\n$\\{2\\}$，$f_0$ 值为 $1$；\n\n$\\{3\\}$，$f_0$ 值为 $1$；\n\n$\\{1,2\\}$，$f_0$ 值为 $\\dfrac{3}{2}$；\n\n$\\{1,3\\}$，$f_0$ 值为 $\\dfrac{4}{3}$；\n\n$\\{2,3\\}$，$f_0$ 值为 $\\dfrac{5}{6}$；\n\n$\\{1,2,3\\}$，$f_0$ 值为 $1$；\n\n总和为 $\\dfrac{23}{3}$，模 $7$ 后为 $3$。\n\n#### 数据范围：\n\n对于 $30\\%$ 的数据，$n \\le 13,k=1$。\n\n对于 $70\\%$ 的数据，$n \\le 10^3$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 7 \\times 10^6,1 \\le k \\le 10^{18},1 \\le x_i<p,1<p<2^{31},p$ 是质数，$x_i$ 互不相同。\n\n**本题读入量较大，可以选择使用比赛描述中的快速读入模板以加快读入速度。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Stoi2031」手写的从前", "background": "> 我看着你的脸 轻刷着和弦 情人节卡片 手写的永远 还记得广场公园 一起表演 学校旁糖果店 记忆里在微甜 ——《手写的从前》", "description": "远定义一个集合 $S$ 的 **权值** 为 $\\dfrac{\\sigma(S)}{\\pi(S)}$，其中 $\\sigma(S)=\\sum\\limits_{x \\in S}x$ 为 $S$ 中所有元素之和， $\\pi(S)=\\prod\\limits_{x \\in S}x$ 为 $S$ 中所有元素之积。甜问他，一个集合 $S$ 的 **所有子集** 的 **权值** 和是多少？远很快就算出了答案。甜又问，那 **所有子集** 的 **所有子集** 的 **权值** 和之和是多少？远又很快就算了出来。于是甜又问了一个问题，问题中总共有 $k$ 个 **所有子集**，这下远算不完了，所以他找你帮忙。远不需要回答一个太大的数，所以答案只要取模 $p$。", "inputFormat": "第一行 $3$ 个正整数 $n,k,p$，其中 $n$ 为 $S$ 中元素的个数。\n\n第二行 $n$ 个正整数，表示 $S$ 中的元素。", "outputFormat": "输出一个正整数表示答案，保证答案在模 $p$ 时有意义。", "hint": "#### 简述版题意：\n\n令 $f_0(S)=\\dfrac{\\sigma(S)}{\\pi(S)}$，$f_k(S)=\\sum\\limits_{T \\subseteq S}f_{k-1}(T)$。其中 $\\sigma(S)=\\sum\\limits_{x \\in S}x$ 为 $S$ 中所有元素之和， $\\pi(S)=\\prod\\limits_{x \\in S}x$ 为 $S$ 中所有元素之积。给定 $n,k,p$ 和集合 $S$，求 $f_k(S) \\bmod{p}$ 的值。\n\n#### 样例解释：\n\n限于篇幅，只解释样例 $1$。\n\n枚举子集：\n\n$\\emptyset$，$f_0$ 值为 $0$；\n\n$\\{1\\}$，$f_0$ 值为 $1$；\n\n$\\{2\\}$，$f_0$ 值为 $1$；\n\n$\\{3\\}$，$f_0$ 值为 $1$；\n\n$\\{1,2\\}$，$f_0$ 值为 $\\dfrac{3}{2}$；\n\n$\\{1,3\\}$，$f_0$ 值为 $\\dfrac{4}{3}$；\n\n$\\{2,3\\}$，$f_0$ 值为 $\\dfrac{5}{6}$；\n\n$\\{1,2,3\\}$，$f_0$ 值为 $1$；\n\n总和为 $\\dfrac{23}{3}$，模 $7$ 后为 $3$。\n\n#### 数据范围：\n\n对于 $30\\%$ 的数据，$n \\le 13,k=1$。\n\n对于 $70\\%$ 的数据，$n \\le 10^3$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 7 \\times 10^6,1 \\le k \\le 10^{18},1 \\le x_i<p,1<p<2^{31},p$ 是质数，$x_i$ 互不相同。\n\n**本题读入量较大，可以选择使用比赛描述中的快速读入模板以加快读入速度。**", "locale": "zh-CN"}}}
{"pid": "P7490", "type": "P", "difficulty": 6, "samples": [["4 3\n1 1 1\n1 6\n", "0\n"], ["6 3\n1 7 3\n1 3\n", "5047704042563\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "博弈论", "期望", "SG 函数"], "title": "「Stoi2031」蒲公英的约定（vol.1）", "background": "> 一起长大的约定 那样清晰 拉过勾的我相信 说好要一起旅行 是你如今 唯一坚持的任性 ——《蒲公英的约定》", "description": "清和如在玩游戏。她们有 $n$ 丛 **蒲公英**，每丛分别有 $s_i$ 朵。这些 **蒲公英** 有一个神奇的性质：有一个给定的常数 $\\sigma \\in (0,1)$，$x$ 朵 **蒲公英** 会分出 $\\lfloor \\sigma x \\rfloor$ 朵为一组，剩下 $x-\\lfloor \\sigma x \\rfloor$ 朵继续分组，直到分出的组没有 **蒲公英** 即 $\\lfloor \\sigma x \\rfloor=0$ 为止。她们称这种现象为 **任性**。现在她们的每丛 **蒲公英** 都有 **任性** 的现象。她们的游戏规则如下：从清开始，两人轮流进行 **旅行**。一次 **旅行** 为选择一丛 **蒲公英** 并吹散这一丛的第一组中的若干朵 **蒲公英**，至少要吹一朵，至多吹的朵数为第一组的朵数，即不能吹散除第一组外的 **蒲公英**。当第一组为空时，其下一组成为第一组。若这一丛只剩下一组 **蒲公英**，这一丛不能再被选定。每丛 **蒲公英** 都不能被选定时，游戏结束，当前轮到的人落败。她们想知道如果清第一次 **旅行** 时等概率选择其中一丛可吹散的 **蒲公英** 再等概率选择吹散的朵数后两人都按最优策略操作，那么清的胜率 $x \\bmod 20190816170251$ 的值将会是多少。\n\n与 vol.2 的区别是，**蒲公英** 在被吹散一部分后 **不会** 重新分组。", "inputFormat": "第一行两个正整数 $id,n$，其中 $id$ 表示 Subtask 编号。\n\n第二行 $n$ 个正整数，第 $i$ 个表示 $s_i$。\n\n若 $id>3$，第三行输入两个正整数 $p,q$ 表示 $\\sigma=\\dfrac{p}{q}$。", "outputFormat": "一行一个整数，表示清的胜率 $x \\bmod{20190816170251}$。", "hint": "#### 简述版题意：\n\n有 $n$ 丛 **蒲公英**，第 $i$ 丛有 $s_i$ 朵。给定实数 $\\sigma$，每丛会分为若干组，第 $j$ 组有 $t_j$ 朵，且满足 $t_j=\\left\\lfloor \\sigma\\left(s_i - \\sum\\limits_{k=1}^{j-1}t_k\\right) \\right\\rfloor$，当 $t_j=0$ 时不再分组。两人轮流操作，每次操作可以选择一丛 **蒲公英**，并选择一个整数 $c \\in t_j$，从这丛 **蒲公英** 中吹散 $c$ 朵，将 $t_j$ 变为 $t_j-c$，其中 $j$ 为操作之前这丛 **蒲公英** 中满足 $t_j \\neq 0$ 的最小正整数。必须至少吹一朵，不能操作者败。求先手第一步等概率选择任意一丛可操作的 **蒲公英** 再等概率选择吹散的朵数后两人都采取最优策略时先手的胜率 $x \\bmod{20190816170251}$ 的值。\n\n#### 样例解释：\n\n对于样例 $1$，清无法操作，胜率为 $0$。\n\n对于样例 $2$，初始局面为 $\\{0;1\\},\\{2,1,1,1,0;2\\},\\{1,0;2\\}$，清可以选择第 $2$ 丛并在两种操作中选择吹散 $2$ 朵变成 $\\{0;1\\},\\{1,1,1,0;2\\},\\{1,0;2\\}$，选择第 $3$ 丛没有可取胜的策略，且第 $1$ 丛不能选择，总胜率为 $\\dfrac{\\frac{1}{2}+0}{2}=\\dfrac{1}{4}$。\n\n#### 数据范围：\n\n**本题采用捆绑测试，各个 Subtask 的分数与限制如下。**\n\n| Subtask No. | $n \\le$ | $s_i \\le$ | $\\sigma$ 限制 | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $3 \\times 10^5$ | $10^{10}$ | $\\sigma=\\dfrac{\\sqrt{2}+1}{3}$ | $10$ |\n| $2$ | $3 \\times 10^5$ | $10^{10}$ | $\\sigma=\\dfrac{\\sqrt{3}+1}{5}$ | $10$ |\n| $3$ | $3 \\times 10^5$ | $10^{10}$ | $\\sigma=\\dfrac{\\sqrt{5}-1}{2}$ | $10$ |\n| $4$ | $100$ | $1$ | 无 | $3$ |\n| $5$ | $100$ | $100$ | $\\sigma=\\dfrac{1}{2}$ | $7$ |\n| $6$ | $100$ | $10^6$ | 无 | $13$ |\n| $7$ | $3 \\times 10^5$ | $10^{10}$ | $\\sigma \\ge \\dfrac{1}{2}$ | $47$ |\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 3 \\times 10^5,1 \\le s_i \\le 10^{10},1 \\le p<q \\le 10^9$。\n\n**本题读入量较大，可以选择使用比赛描述中的快速读入模板以加快读入速度。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Stoi2031」蒲公英的约定（vol.1）", "background": "> 一起长大的约定 那样清晰 拉过勾的我相信 说好要一起旅行 是你如今 唯一坚持的任性 ——《蒲公英的约定》", "description": "清和如在玩游戏。她们有 $n$ 丛 **蒲公英**，每丛分别有 $s_i$ 朵。这些 **蒲公英** 有一个神奇的性质：有一个给定的常数 $\\sigma \\in (0,1)$，$x$ 朵 **蒲公英** 会分出 $\\lfloor \\sigma x \\rfloor$ 朵为一组，剩下 $x-\\lfloor \\sigma x \\rfloor$ 朵继续分组，直到分出的组没有 **蒲公英** 即 $\\lfloor \\sigma x \\rfloor=0$ 为止。她们称这种现象为 **任性**。现在她们的每丛 **蒲公英** 都有 **任性** 的现象。她们的游戏规则如下：从清开始，两人轮流进行 **旅行**。一次 **旅行** 为选择一丛 **蒲公英** 并吹散这一丛的第一组中的若干朵 **蒲公英**，至少要吹一朵，至多吹的朵数为第一组的朵数，即不能吹散除第一组外的 **蒲公英**。当第一组为空时，其下一组成为第一组。若这一丛只剩下一组 **蒲公英**，这一丛不能再被选定。每丛 **蒲公英** 都不能被选定时，游戏结束，当前轮到的人落败。她们想知道如果清第一次 **旅行** 时等概率选择其中一丛可吹散的 **蒲公英** 再等概率选择吹散的朵数后两人都按最优策略操作，那么清的胜率 $x \\bmod 20190816170251$ 的值将会是多少。\n\n与 vol.2 的区别是，**蒲公英** 在被吹散一部分后 **不会** 重新分组。", "inputFormat": "第一行两个正整数 $id,n$，其中 $id$ 表示 Subtask 编号。\n\n第二行 $n$ 个正整数，第 $i$ 个表示 $s_i$。\n\n若 $id>3$，第三行输入两个正整数 $p,q$ 表示 $\\sigma=\\dfrac{p}{q}$。", "outputFormat": "一行一个整数，表示清的胜率 $x \\bmod{20190816170251}$。", "hint": "#### 简述版题意：\n\n有 $n$ 丛 **蒲公英**，第 $i$ 丛有 $s_i$ 朵。给定实数 $\\sigma$，每丛会分为若干组，第 $j$ 组有 $t_j$ 朵，且满足 $t_j=\\left\\lfloor \\sigma\\left(s_i - \\sum\\limits_{k=1}^{j-1}t_k\\right) \\right\\rfloor$，当 $t_j=0$ 时不再分组。两人轮流操作，每次操作可以选择一丛 **蒲公英**，并选择一个整数 $c \\in t_j$，从这丛 **蒲公英** 中吹散 $c$ 朵，将 $t_j$ 变为 $t_j-c$，其中 $j$ 为操作之前这丛 **蒲公英** 中满足 $t_j \\neq 0$ 的最小正整数。必须至少吹一朵，不能操作者败。求先手第一步等概率选择任意一丛可操作的 **蒲公英** 再等概率选择吹散的朵数后两人都采取最优策略时先手的胜率 $x \\bmod{20190816170251}$ 的值。\n\n#### 样例解释：\n\n对于样例 $1$，清无法操作，胜率为 $0$。\n\n对于样例 $2$，初始局面为 $\\{0;1\\},\\{2,1,1,1,0;2\\},\\{1,0;2\\}$，清可以选择第 $2$ 丛并在两种操作中选择吹散 $2$ 朵变成 $\\{0;1\\},\\{1,1,1,0;2\\},\\{1,0;2\\}$，选择第 $3$ 丛没有可取胜的策略，且第 $1$ 丛不能选择，总胜率为 $\\dfrac{\\frac{1}{2}+0}{2}=\\dfrac{1}{4}$。\n\n#### 数据范围：\n\n**本题采用捆绑测试，各个 Subtask 的分数与限制如下。**\n\n| Subtask No. | $n \\le$ | $s_i \\le$ | $\\sigma$ 限制 | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $3 \\times 10^5$ | $10^{10}$ | $\\sigma=\\dfrac{\\sqrt{2}+1}{3}$ | $10$ |\n| $2$ | $3 \\times 10^5$ | $10^{10}$ | $\\sigma=\\dfrac{\\sqrt{3}+1}{5}$ | $10$ |\n| $3$ | $3 \\times 10^5$ | $10^{10}$ | $\\sigma=\\dfrac{\\sqrt{5}-1}{2}$ | $10$ |\n| $4$ | $100$ | $1$ | 无 | $3$ |\n| $5$ | $100$ | $100$ | $\\sigma=\\dfrac{1}{2}$ | $7$ |\n| $6$ | $100$ | $10^6$ | 无 | $13$ |\n| $7$ | $3 \\times 10^5$ | $10^{10}$ | $\\sigma \\ge \\dfrac{1}{2}$ | $47$ |\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 3 \\times 10^5,1 \\le s_i \\le 10^{10},1 \\le p<q \\le 10^9$。\n\n**本题读入量较大，可以选择使用比赛描述中的快速读入模板以加快读入速度。**", "locale": "zh-CN"}}}
{"pid": "P7491", "type": "P", "difficulty": 6, "samples": [["4 3\n1 1 1\n1 6\n", "0\n"], ["6 3\n1 7 3\n1 3\n", "15143112127689\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "博弈论", "期望", "SG 函数"], "title": "「Stoi2031」蒲公英的约定（vol.2）", "background": "> 一起长大的约定 那样清晰 拉过勾的我相信 说好要一起旅行 是你如今 唯一坚持的任性 ——《蒲公英的约定》", "description": "清和如在玩游戏。她们有 $n$ 丛 **蒲公英**，每丛分别有 $s_i$ 朵。这些 **蒲公英** 有一个神奇的性质：有一个给定的常数 $\\sigma \\in (0,1)$，$x$ 朵 **蒲公英** 会分出 $\\lfloor \\sigma x \\rfloor$ 朵为一组，剩下 $x-\\lfloor \\sigma x \\rfloor$ 朵继续分组，直到分出的组没有 **蒲公英** 即 $\\lfloor \\sigma x \\rfloor=0$ 为止。她们称这种现象为 **任性**。现在她们的每丛 **蒲公英** 都有 **任性** 的现象。她们的游戏规则如下：从清开始，两人轮流进行 **旅行**。一次 **旅行** 为选择一丛 **蒲公英** 并吹散这一丛的第一组中的若干朵 **蒲公英**，至少要吹一朵，至多吹的朵数为第一组的朵数，即不能吹散除第一组外的 **蒲公英**。当第一组为空时，其下一组成为第一组。若这一丛只剩下一组 **蒲公英**，这一丛不能再被选定。每丛 **蒲公英** 都不能被选定时，游戏结束，当前轮到的人落败。她们想知道如果清第一次 **旅行** 时等概率选择其中一丛可吹散的 **蒲公英** 再等概率选择吹散的朵数后两人都按最优策略操作，那么清的胜率 $x \\bmod{20190816170251}$ 的值将会是多少。\n\n与 vol.1 的区别是，**蒲公英** 在被吹散一部分后 **会** 重新分组。", "inputFormat": "第一行两个正整数 $id,n$，其中 $id$ 表示 Subtask 编号。\n\n第二行 $n$ 个正整数，第 $i$ 个表示 $s_i$。\n\n若 $id>3$，第三行输入两个正整数 $p,q$ 表示 $\\sigma=\\dfrac{p}{q}$。", "outputFormat": "一行一个整数，表示清的胜率 $x \\bmod{20190816170251}$。", "hint": "#### 简述版题意：\n\n有 $n$ 丛 **蒲公英**，第 $i$ 丛有 $s_i$ 朵。给定实数 $\\sigma$，两人轮流操作，每次操作可以选择一丛 **蒲公英**，并选择一个整数 $c \\in (0,\\sigma s]$，从这丛 **蒲公英** 中吹散 $c$ 朵，其中 $s$ 为操作之前这丛 **蒲公英** 的朵数。必须至少吹一朵，不能操作者败。求先手第一步等概率选择任意一丛可操作的 **蒲公英** 再等概率选择吹散的朵数后两人都采取最优策略时先手的胜率 $x \\bmod{20190816170251}$ 的值。\n\n#### 样例解释：\n\n对于样例 $1$，清无法操作，胜率为 $0$。\n\n对于样例 $2$，清可以选择第 $2$ 丛并在两种操作中选择吹散 $2$ 朵变成 $1,5,3$，或选择第 $3$ 丛并选择唯一的操作变成 $1,7,2$，且第 $1$ 丛不能选择，总胜率为 $\\dfrac{\\frac{1}{2}+1}{2}=\\dfrac{3}{4}$。\n\n#### 数据范围：\n\n**本题采用捆绑测试，各个 Subtask 的分数与限制如下。**\n\n| Subtask No. | $n \\le$ | $s_i \\le$ | $\\sigma$ 限制 | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $3 \\times 10^5$ | $10^{10}$ | $\\sigma=\\dfrac{\\sqrt{2}+1}{3}$ | $10$ |\n| $2$ | $3 \\times 10^5$ | $10^{10}$ | $\\sigma=\\dfrac{\\sqrt{3}+1}{5}$ | $10$ |\n| $3$ | $3 \\times 10^5$ | $10^{10}$ | $\\sigma=\\dfrac{\\sqrt{5}-1}{2}$ | $10$ |\n| $4$ | $100$ | $1$ | 无 | $3$ |\n| $5$ | $100$ | $100$ | $\\sigma=\\dfrac{1}{2}$ | $7$ |\n| $6$ | $100$ | $10^6$ | 无 | $13$ |\n| $7$ | $3 \\times 10^5$ | $10^{10}$ | $\\sigma \\ge \\dfrac{1}{2}$ | $47$ |\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 3 \\times 10^5,1 \\le s_i \\le 10^{10},1 \\le p<q \\le 10^9$。\n\n**本题读入量较大，可以选择使用比赛描述中的快速读入模板以加快读入速度。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Stoi2031」蒲公英的约定（vol.2）", "background": "> 一起长大的约定 那样清晰 拉过勾的我相信 说好要一起旅行 是你如今 唯一坚持的任性 ——《蒲公英的约定》", "description": "清和如在玩游戏。她们有 $n$ 丛 **蒲公英**，每丛分别有 $s_i$ 朵。这些 **蒲公英** 有一个神奇的性质：有一个给定的常数 $\\sigma \\in (0,1)$，$x$ 朵 **蒲公英** 会分出 $\\lfloor \\sigma x \\rfloor$ 朵为一组，剩下 $x-\\lfloor \\sigma x \\rfloor$ 朵继续分组，直到分出的组没有 **蒲公英** 即 $\\lfloor \\sigma x \\rfloor=0$ 为止。她们称这种现象为 **任性**。现在她们的每丛 **蒲公英** 都有 **任性** 的现象。她们的游戏规则如下：从清开始，两人轮流进行 **旅行**。一次 **旅行** 为选择一丛 **蒲公英** 并吹散这一丛的第一组中的若干朵 **蒲公英**，至少要吹一朵，至多吹的朵数为第一组的朵数，即不能吹散除第一组外的 **蒲公英**。当第一组为空时，其下一组成为第一组。若这一丛只剩下一组 **蒲公英**，这一丛不能再被选定。每丛 **蒲公英** 都不能被选定时，游戏结束，当前轮到的人落败。她们想知道如果清第一次 **旅行** 时等概率选择其中一丛可吹散的 **蒲公英** 再等概率选择吹散的朵数后两人都按最优策略操作，那么清的胜率 $x \\bmod{20190816170251}$ 的值将会是多少。\n\n与 vol.1 的区别是，**蒲公英** 在被吹散一部分后 **会** 重新分组。", "inputFormat": "第一行两个正整数 $id,n$，其中 $id$ 表示 Subtask 编号。\n\n第二行 $n$ 个正整数，第 $i$ 个表示 $s_i$。\n\n若 $id>3$，第三行输入两个正整数 $p,q$ 表示 $\\sigma=\\dfrac{p}{q}$。", "outputFormat": "一行一个整数，表示清的胜率 $x \\bmod{20190816170251}$。", "hint": "#### 简述版题意：\n\n有 $n$ 丛 **蒲公英**，第 $i$ 丛有 $s_i$ 朵。给定实数 $\\sigma$，两人轮流操作，每次操作可以选择一丛 **蒲公英**，并选择一个整数 $c \\in (0,\\sigma s]$，从这丛 **蒲公英** 中吹散 $c$ 朵，其中 $s$ 为操作之前这丛 **蒲公英** 的朵数。必须至少吹一朵，不能操作者败。求先手第一步等概率选择任意一丛可操作的 **蒲公英** 再等概率选择吹散的朵数后两人都采取最优策略时先手的胜率 $x \\bmod{20190816170251}$ 的值。\n\n#### 样例解释：\n\n对于样例 $1$，清无法操作，胜率为 $0$。\n\n对于样例 $2$，清可以选择第 $2$ 丛并在两种操作中选择吹散 $2$ 朵变成 $1,5,3$，或选择第 $3$ 丛并选择唯一的操作变成 $1,7,2$，且第 $1$ 丛不能选择，总胜率为 $\\dfrac{\\frac{1}{2}+1}{2}=\\dfrac{3}{4}$。\n\n#### 数据范围：\n\n**本题采用捆绑测试，各个 Subtask 的分数与限制如下。**\n\n| Subtask No. | $n \\le$ | $s_i \\le$ | $\\sigma$ 限制 | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $3 \\times 10^5$ | $10^{10}$ | $\\sigma=\\dfrac{\\sqrt{2}+1}{3}$ | $10$ |\n| $2$ | $3 \\times 10^5$ | $10^{10}$ | $\\sigma=\\dfrac{\\sqrt{3}+1}{5}$ | $10$ |\n| $3$ | $3 \\times 10^5$ | $10^{10}$ | $\\sigma=\\dfrac{\\sqrt{5}-1}{2}$ | $10$ |\n| $4$ | $100$ | $1$ | 无 | $3$ |\n| $5$ | $100$ | $100$ | $\\sigma=\\dfrac{1}{2}$ | $7$ |\n| $6$ | $100$ | $10^6$ | 无 | $13$ |\n| $7$ | $3 \\times 10^5$ | $10^{10}$ | $\\sigma \\ge \\dfrac{1}{2}$ | $47$ |\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 3 \\times 10^5,1 \\le s_i \\le 10^{10},1 \\le p<q \\le 10^9$。\n\n**本题读入量较大，可以选择使用比赛描述中的快速读入模板以加快读入速度。**", "locale": "zh-CN"}}}
{"pid": "P7492", "type": "P", "difficulty": 5, "samples": [["15 15\n512 -65 33554432 32 8194 13 16 2 67108872 131072 -8192 8194 16 2048 4096 \n1 3 5\n1 10 10\n2 1 7 671367424\n1 8 14\n1 5 11\n2 13 13 335579137\n2 2 13 5376\n1 2 5\n2 5 6 8392768\n1 1 2\n2 2 14 201335872\n2 1 14 0\n1 11 12\n1 8 12\n1 4 9", "33562658\n131072\n67242012\n2081350441\n2047680290\n671367936\n201340226\n805489228\n3373416393"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["线段树", "分块", "位运算", "传智杯"], "title": "[传智杯 #3 决赛] 序列", "background": "disangan233 正在数数，他希望你帮他记录数数的序列，并完成一些操作。", "description": "你有一个长为 $n$ 的序列 $a$，现在要对其进行 $m$ 次操作。操作分为两种：\n\n1. 给定两个整数 $l,r$，表示询问 $l$ 到 $r$ 的最大连续子段和。\n2. 给定三个整数 $l,r,k$，表示将 $l$ 到 $r$ 的 $a_i$ 都按位或上一个 $k$。\n\n对于所有数据，$n,m\\leq 10^5$，$-2^{30}\\leq a_i,k<2^{30}$，$1\\leq l\\leq r\\leq n$。\t \n\n注意：负数按照 32 位补码取按位或。", "inputFormat": "输入共 $m+2$ 行。\n\n第 $1$ 行输入 $2$ 个正整数 $n,m$。\n\n第 $2$ 行输入 $n$ 个整数 $a_1\\ldots a_n$。\n\n接下来 $m$ 行，每行先输入 $1$ 个正整数 $op$，$op=1$ 输入 $2$ 个整数 $l,r$ 表示一次询问，否则输入 $3$ 个整数 $l,r,k$ 表示一次修改。", "outputFormat": "输出共若干行，每行共 $1$ 个整数，表示询问的答案。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[传智杯 #3 决赛] 序列", "background": "disangan233 正在数数，他希望你帮他记录数数的序列，并完成一些操作。", "description": "你有一个长为 $n$ 的序列 $a$，现在要对其进行 $m$ 次操作。操作分为两种：\n\n1. 给定两个整数 $l,r$，表示询问 $l$ 到 $r$ 的最大连续子段和。\n2. 给定三个整数 $l,r,k$，表示将 $l$ 到 $r$ 的 $a_i$ 都按位或上一个 $k$。\n\n对于所有数据，$n,m\\leq 10^5$，$-2^{30}\\leq a_i,k<2^{30}$，$1\\leq l\\leq r\\leq n$。\t \n\n注意：负数按照 32 位补码取按位或。", "inputFormat": "输入共 $m+2$ 行。\n\n第 $1$ 行输入 $2$ 个正整数 $n,m$。\n\n第 $2$ 行输入 $n$ 个整数 $a_1\\ldots a_n$。\n\n接下来 $m$ 行，每行先输入 $1$ 个正整数 $op$，$op=1$ 输入 $2$ 个整数 $l,r$ 表示一次询问，否则输入 $3$ 个整数 $l,r,k$ 表示一次修改。", "outputFormat": "输出共若干行，每行共 $1$ 个整数，表示询问的答案。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P7493", "type": "P", "difficulty": 6, "samples": [["3 2 2 2\n1 3\n2 3", "2\n1"], ["2077 30 200 3\n1949 2021\n1969 2077\n1970 2004\n", "360658315\n804081653\n603979748"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "多项式", "O2优化", "快速数论变换 NTT", "传智杯"], "title": "[传智杯 #3 决赛] 旅人1969", "background": "在被称为未来的二十一世纪里，只残留着不安与少许的幻想。\n\n永远与须臾的罪人啊，二十世纪的诺亚方舟，承载着期待与不安向着天空飞去呢！\n\n而作为希望的你，在这并不永恒的旅途中，会怎样地前行呢？", "description": "一条笔直的公路上有 $n$ 个旅店，第 $i$ 个旅店的坐标是 $i$，每一天早上从旅店出发走最多 $m$ 个距离，同时固定给你一个常数 $k$。\n\n给定 $q$ 组询问，每次给定 $u,v$，求早上从旅店 $u$ 出发到旅店 $v$，途径不超过 $k$ 个旅店（不含起点 $u$）且行走方向不变的方案数。两种方案不同当且仅当存在一个不同的旅店选择，答案对 $998244353$ 取模。\n\n对于所有数据，$n,q\\leq 10^5$，$m,k\\leq 10^4$，$mk\\leq 10^5$，$u,v\\leq n$。", "inputFormat": "输入共 $q+1$ 行。\n\n第一行输入 $4$ 个正整数 $n,m,k,q$。\n\n接下来 $q$ 行，每行输入 $2$ 个正整数 $u,v$，表示一组询问。", "outputFormat": "输出共 $q$ 行，每行输入 $1$ 个整数表示答案。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[传智杯 #3 决赛] 旅人1969", "background": "在被称为未来的二十一世纪里，只残留着不安与少许的幻想。\n\n永远与须臾的罪人啊，二十世纪的诺亚方舟，承载着期待与不安向着天空飞去呢！\n\n而作为希望的你，在这并不永恒的旅途中，会怎样地前行呢？", "description": "一条笔直的公路上有 $n$ 个旅店，第 $i$ 个旅店的坐标是 $i$，每一天早上从旅店出发走最多 $m$ 个距离，同时固定给你一个常数 $k$。\n\n给定 $q$ 组询问，每次给定 $u,v$，求早上从旅店 $u$ 出发到旅店 $v$，途径不超过 $k$ 个旅店（不含起点 $u$）且行走方向不变的方案数。两种方案不同当且仅当存在一个不同的旅店选择，答案对 $998244353$ 取模。\n\n对于所有数据，$n,q\\leq 10^5$，$m,k\\leq 10^4$，$mk\\leq 10^5$，$u,v\\leq n$。", "inputFormat": "输入共 $q+1$ 行。\n\n第一行输入 $4$ 个正整数 $n,m,k,q$。\n\n接下来 $q$ 行，每行输入 $2$ 个正整数 $u,v$，表示一组询问。", "outputFormat": "输出共 $q$ 行，每行输入 $1$ 个整数表示答案。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P7494", "type": "P", "difficulty": 2, "samples": [["4 5", "2"], ["13 6", "3"], ["8 2", "3"], ["114 514", "5"], ["19198 10", "962"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["递推", "2021"], "title": "三遣救援", "background": ">就像第一块多米诺骨牌，那个人的出现开启了后面的故事。\n\n穆罗在家里养了许多猪。在他的训练下，这些猪都十分乖巧。当然，有的时候这些猪也会变得十分调皮……", "description": "一天早上，穆罗发现自己私存的一块蛋糕被偷吃了！他立即猜到某只猪吃了这块蛋糕，于是迅速赶到猪圈决定找出这只猪进行惩罚。\n\n猪圈里有 $n$ 只猪，猪的序号是 $1$ 到 $n$ 之间的整数。除了偷吃了蛋糕的那只猪，其他所有猪**一样重**，而那只偷吃了蛋糕的猪会比其他猪**略重一些**（你可以假设原本猪是 $5\\text{kg}$ 的，那只吃了蛋糕的猪是 $5.1\\text{kg}$ 的）。穆罗无法肉眼判断是哪只猪吃了蛋糕。\n\n幸运的是穆罗有一个天平，可以将猪赶上天平两侧，从而比较出哪边的猪更重。不过这个天平不是很大，每侧最多只能有 $m$ 只猪，否则天平就会损坏导致无法使用（偷吃蛋糕的猪**不会使天平一侧可放置的猪的数目减少**，即**无论猪是否偷吃，每侧都最多只能有 $m$ 只猪**）。\n\n穆罗不想花费太多的时间，所以他希望知道在**天平不损坏**的前提下，**至少需要使用几次天平称量才能保证找出这只偷吃了的猪**。他希望你能求出这个数。", "inputFormat": "一行，两个正整数 $n,m$。", "outputFormat": "一行，一个正整数表示答案。", "hint": "#### 样例一解释：\n\n穆罗先让 $1$ 号猪和 $2$ 号猪分别上天平两侧，再让 $3$ 号猪和 $4$ 号猪分别上天平两侧，此时一定能找出偷吃了的猪，使用天平次数为 $2$。显然只使用一次天平无法保证能找出那只偷吃了的猪。\n\n#### 样例三解释：\n\n天平两侧最多都只能放两只猪，所以至少需要三次才能保证找出。\n\n------------\n#### 数据范围\n\n**本题采用捆绑测试。**\n\n+ Subtask 1 ( $10\\%$ )：$n,m\\leq10$。\n+ Subtask 2 ( $25\\%$ )：$n,m\\leq10^6$。\n+ Subtask 3 ( $15\\%$ )：$n\\leq m$。\n+ Subtask 4 ( $50\\%$ )：无特殊限制。\n\n对于所有数据，$1\\leq n,m\\leq10^{15}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "三遣救援", "background": ">就像第一块多米诺骨牌，那个人的出现开启了后面的故事。\n\n穆罗在家里养了许多猪。在他的训练下，这些猪都十分乖巧。当然，有的时候这些猪也会变得十分调皮……", "description": "一天早上，穆罗发现自己私存的一块蛋糕被偷吃了！他立即猜到某只猪吃了这块蛋糕，于是迅速赶到猪圈决定找出这只猪进行惩罚。\n\n猪圈里有 $n$ 只猪，猪的序号是 $1$ 到 $n$ 之间的整数。除了偷吃了蛋糕的那只猪，其他所有猪**一样重**，而那只偷吃了蛋糕的猪会比其他猪**略重一些**（你可以假设原本猪是 $5\\text{kg}$ 的，那只吃了蛋糕的猪是 $5.1\\text{kg}$ 的）。穆罗无法肉眼判断是哪只猪吃了蛋糕。\n\n幸运的是穆罗有一个天平，可以将猪赶上天平两侧，从而比较出哪边的猪更重。不过这个天平不是很大，每侧最多只能有 $m$ 只猪，否则天平就会损坏导致无法使用（偷吃蛋糕的猪**不会使天平一侧可放置的猪的数目减少**，即**无论猪是否偷吃，每侧都最多只能有 $m$ 只猪**）。\n\n穆罗不想花费太多的时间，所以他希望知道在**天平不损坏**的前提下，**至少需要使用几次天平称量才能保证找出这只偷吃了的猪**。他希望你能求出这个数。", "inputFormat": "一行，两个正整数 $n,m$。", "outputFormat": "一行，一个正整数表示答案。", "hint": "#### 样例一解释：\n\n穆罗先让 $1$ 号猪和 $2$ 号猪分别上天平两侧，再让 $3$ 号猪和 $4$ 号猪分别上天平两侧，此时一定能找出偷吃了的猪，使用天平次数为 $2$。显然只使用一次天平无法保证能找出那只偷吃了的猪。\n\n#### 样例三解释：\n\n天平两侧最多都只能放两只猪，所以至少需要三次才能保证找出。\n\n------------\n#### 数据范围\n\n**本题采用捆绑测试。**\n\n+ Subtask 1 ( $10\\%$ )：$n,m\\leq10$。\n+ Subtask 2 ( $25\\%$ )：$n,m\\leq10^6$。\n+ Subtask 3 ( $15\\%$ )：$n\\leq m$。\n+ Subtask 4 ( $50\\%$ )：无特殊限制。\n\n对于所有数据，$1\\leq n,m\\leq10^{15}$。", "locale": "zh-CN"}}}
{"pid": "P7495", "type": "P", "difficulty": 5, "samples": [["5 2 3\n01101\n", "338690049"], ["17 4 13\n10101110100101101\n", "512357021"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["递推", "2021", "矩阵运算", "概率论", "矩阵乘法"], "title": "异位坍缩", "background": ">自然的法则隐藏在黑暗之中。\n\n月光之下，菲欧娜和一群与她有着同样信仰的信徒们聚集在一起，等待着他们所信仰的神明降临。\n\n「神明大人，我们愿意永远追随您。」", "description": "神明想要测试他的信徒们是否忠诚，他决定用运气来进行测试。\n\n神明事先准备了 $n$ 个问题，每个问题都有两种选择：**「相对激进的」** 和 **「相对保守的」**。神明已经定好了自己的选择。\n\n为了考验他的信徒们，神明会在所有可行的问题选择方式中**等概率选出一种**（可行的选择方式指选出**连续的** $k$ 个问题，满足 $l\\leq k\\leq r$，其中 $l,r$ 给定），然后信徒们会依次对这 $k$ 个问题中的每个问题回答「相对激进的」或「相对保守的」。神明会根据自己的选择以及某个信徒的回答来判定这名信徒是否忠诚。\n\n神明的判定方式是这样的：\n\n+ 这是第一个问题：无论回答如何，神明都愿意相信这名信徒是忠诚的。\n+ 这不是第一个问题：如果这名信徒的上一个回答与神明的选择相同，那么神明会需要他去对更先进的选择进行探索，因此这名信徒在这个问题的回答**不能比神明的选择更保守**；否则，神明会要求这名信徒服从于自己，在这个问题的回答**不能比神明的选择更激进**。\n\n如果这名信徒的回答满足上述要求，那么这名信徒就是忠诚的。\n\n现在，神明想要知道，如果信徒对每个问题都会**等概率回答「相对激进的」或「相对保守的」**，那么一名信徒有多大的概率会是忠诚的。他通过菲欧娜向你提出了这个问题，并要求你将结果对 $998244353$ 取模。如果你无法及时回答出，那么你就会失去神明的信任。\n\n------------\n\n#### 简要题意：\n\n给定一个长度为 $n$ 的 01 串 $a$ 以及 $l,r(l\\leq r)$。\n\n对于两个长度均为 $k$ 的 01 串 $p,q$，我们认为 $q$ 对于 $p$ 是「忠诚的」，当且仅当 $p$ 和 $q$ 满足如下要求：\n\n+ 对于任意 $1<i\\leq k$，如果 $q_{i-1}=p_{i-1}$，那么 $q_i\\geq p_i$，否则 $q_i\\leq p_i$。\n\n你需要求出如果**先等概率随机选出一个长度 $k$ 满足 $l\\leq k\\leq r$ 的 $a$ 的子串**，然后**再等概率随机出一个长度为 $k$ 的 01 串 $b$**，有多大的概率使得 $b$ 对于这个子串是「忠诚的」，结果对 $998244353$ 取模。", "inputFormat": "第一行三个整数 $n,l,r$，意义如上。\n\n第二行有一个长度为 $n$ 的字符串，表示 $a$。保证字符串只含字符 `0` 和 `1`。", "outputFormat": "一行一个整数，表示结果。", "hint": "#### 样例一解释：\n\n我们用 $\\left[l,r\\right]$ 表示所选择的子串所在区间。\n\n+ 选择 $\\left[1,2\\right]$，子串为 `01`，长度为 $2$，有 $3$ 个 01 串对这个子串是「忠诚的」，概率为 $\\dfrac{3}{4}$。\n+ 选择 $\\left[1,3\\right]$，子串为 `011`，长度为 $3$，有 $4$ 个 01 串对这个子串是「忠诚的」，概率为 $\\dfrac{1}{2}$。\n+ 选择 $\\left[2,3\\right]$，概率为 $\\dfrac{3}{4}$。\n\n+ 选择 $\\left[2,4\\right]$，概率为 $\\dfrac{5}{8}$。\n+ 选择 $\\left[3,4\\right]$，概率为 $\\dfrac{3}{4}$。\n+ 选择 $\\left[3,5\\right]$，概率为 $\\dfrac{1}{2}$。\n+ 选择 $\\left[4,5\\right]$，概率为 $\\dfrac{3}{4}$。\n\n结果为 $\\dfrac{\\dfrac{3}{4}+\\dfrac{1}{2}+\\dfrac{3}{4}+\\dfrac{5}{8}+\\dfrac{3}{4}+\\dfrac{1}{2}+\\dfrac{3}{4}}{7}=\\dfrac{37}{56}$，取模意义下为 $338690049$。\n\n------------\n\n**本题采用捆绑测试**\n\n+ Subtask 1 ( $1\\%$ )：$n=1$。\n+ Subtask 2 ( $13\\%$ )：$n\\leq100$。\n+ Subtask 3 ( $3\\%$ )：保证 $\\forall1\\leq i\\leq n,a_i=0$。\n+ Subtask 4 ( $3\\%$ )：保证 $\\forall1\\leq i\\leq n,a_i=1$。\n+ Subtask 5 ( $20\\%$ )：$n\\leq10^3$。\n+ Subtask 6 ( $15\\%$ )：$l=r$。\n+ Subtask 7 ( $20\\%$ )：$n\\leq 5\\times 10^5$。\n+ Subtask 8 ( $25\\%$ )：无特殊限制。\n\n对于所有数据，$1\\leq n\\leq5\\times 10^6,1\\leq l\\leq r\\leq n$。", "locale": "zh-CN", "translations": {"en": {"title": "Anagram Collapse", "background": "> The laws of nature are hidden in the darkness.\n\nUnder the moonlight, Fiona and a group of believers who share the same faith gather together, waiting for the god they believe in to arrive.\n\n“Dear God, we are willing to follow you forever.”", "description": "The god wants to test whether his believers are loyal, and he decides to use luck as the test.\n\nThe god has prepared $n$ questions in advance. Each question has two choices: **“relatively radical”** and **“relatively conservative”**. The god has already fixed his own choices.\n\nTo test his believers, the god will **uniformly choose one** from all feasible ways of selecting questions (a feasible way means choosing **a consecutive** $k$ questions, with $l\\leq k\\leq r$, where $l,r$ are given). Then the believers will answer each of the $k$ questions in order with either “relatively radical” or “relatively conservative”. The god will judge whether a believer is loyal based on his own choices and that believer’s answers.\n\nThe judging rules are:\n\n+ This is the first question: no matter what the answer is, the god is willing to believe the believer is loyal.\n+ This is not the first question: if the believer’s previous answer is the same as the god’s choice, then the god will require them to explore more advanced choices, so the believer’s answer to this question **cannot be more conservative than the god’s choice**; otherwise, the god will require the believer to obey him, so the believer’s answer to this question **cannot be more radical than the god’s choice**.\n\nIf the believer’s answers satisfy the above requirements, then the believer is loyal.\n\nNow, the god wants to know: if a believer answers each question **uniformly at random with “relatively radical” or “relatively conservative”**, what is the probability that the believer is loyal? He asks you this question through Fiona, and requires you to output the result modulo $998244353$. If you cannot answer in time, you will lose the god’s trust.\n\n------------\n\n#### Simplified statement:\n\nGiven a binary string $a$ of length $n$ and $l,r(l\\leq r)$.\n\nFor two binary strings $p,q$ of the same length $k$, we say that $q$ is “loyal” to $p$ if and only if $p$ and $q$ satisfy:\n\n+ For any $1<i\\leq k$, if $q_{i-1}=p_{i-1}$, then $q_i\\geq p_i$, otherwise $q_i\\leq p_i$.\n\nYou need to compute the probability that: **first, uniformly choose a substring of $a$ whose length $k$ satisfies $l\\leq k\\leq r$**, and then **uniformly choose a binary string $b$ of length $k$**, such that $b$ is “loyal” to that substring. Output the result modulo $998244353$.", "inputFormat": "The first line contains three integers $n,l,r$, as described above.\n\nThe second line contains a string of length $n$, representing $a$. It is guaranteed that the string contains only characters `0` and `1`.", "outputFormat": "Output one integer in one line, representing the answer.", "hint": "#### Explanation for Sample 1:\n\nWe use $\\left[l,r\\right]$ to denote the interval where the chosen substring lies.\n\n+ Choose $\\left[1,2\\right]$. The substring is `01`, with length $2$. There are $3$ binary strings that are “loyal” to this substring, so the probability is $\\dfrac{3}{4}$.\n+ Choose $\\left[1,3\\right]$. The substring is `011`, with length $3$. There are $4$ binary strings that are “loyal” to this substring, so the probability is $\\dfrac{1}{2}$.\n+ Choose $\\left[2,3\\right]$. The probability is $\\dfrac{3}{4}$.\n\n+ Choose $\\left[2,4\\right]$. The probability is $\\dfrac{5}{8}$.\n+ Choose $\\left[3,4\\right]$. The probability is $\\dfrac{3}{4}$.\n+ Choose $\\left[3,5\\right]$. The probability is $\\dfrac{1}{2}$.\n+ Choose $\\left[4,5\\right]$. The probability is $\\dfrac{3}{4}$.\n\nSo the result is $\\dfrac{\\dfrac{3}{4}+\\dfrac{1}{2}+\\dfrac{3}{4}+\\dfrac{5}{8}+\\dfrac{3}{4}+\\dfrac{1}{2}+\\dfrac{3}{4}}{7}=\\dfrac{37}{56}$, which is $338690049$ modulo $998244353$.\n\n------------\n\n**This problem uses bundled testdata.**\n\n+ Subtask 1 ( $1\\%$ ): $n=1$.\n+ Subtask 2 ( $13\\%$ ): $n\\leq100$.\n+ Subtask 3 ( $3\\%$ ): Guaranteed that $\\forall1\\leq i\\leq n,a_i=0$.\n+ Subtask 4 ( $3\\%$ ): Guaranteed that $\\forall1\\leq i\\leq n,a_i=1$.\n+ Subtask 5 ( $20\\%$ ): $n\\leq10^3$.\n+ Subtask 6 ( $15\\%$ ): $l=r$.\n+ Subtask 7 ( $20\\%$ ): $n\\leq 5\\times 10^5$.\n+ Subtask 8 ( $25\\%$ ): No special constraints.\n\nConstraints: for all testdata, $1\\leq n\\leq5\\times 10^6,1\\leq l\\leq r\\leq n$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "异位坍缩", "background": ">自然的法则隐藏在黑暗之中。\n\n月光之下，菲欧娜和一群与她有着同样信仰的信徒们聚集在一起，等待着他们所信仰的神明降临。\n\n「神明大人，我们愿意永远追随您。」", "description": "神明想要测试他的信徒们是否忠诚，他决定用运气来进行测试。\n\n神明事先准备了 $n$ 个问题，每个问题都有两种选择：**「相对激进的」** 和 **「相对保守的」**。神明已经定好了自己的选择。\n\n为了考验他的信徒们，神明会在所有可行的问题选择方式中**等概率选出一种**（可行的选择方式指选出**连续的** $k$ 个问题，满足 $l\\leq k\\leq r$，其中 $l,r$ 给定），然后信徒们会依次对这 $k$ 个问题中的每个问题回答「相对激进的」或「相对保守的」。神明会根据自己的选择以及某个信徒的回答来判定这名信徒是否忠诚。\n\n神明的判定方式是这样的：\n\n+ 这是第一个问题：无论回答如何，神明都愿意相信这名信徒是忠诚的。\n+ 这不是第一个问题：如果这名信徒的上一个回答与神明的选择相同，那么神明会需要他去对更先进的选择进行探索，因此这名信徒在这个问题的回答**不能比神明的选择更保守**；否则，神明会要求这名信徒服从于自己，在这个问题的回答**不能比神明的选择更激进**。\n\n如果这名信徒的回答满足上述要求，那么这名信徒就是忠诚的。\n\n现在，神明想要知道，如果信徒对每个问题都会**等概率回答「相对激进的」或「相对保守的」**，那么一名信徒有多大的概率会是忠诚的。他通过菲欧娜向你提出了这个问题，并要求你将结果对 $998244353$ 取模。如果你无法及时回答出，那么你就会失去神明的信任。\n\n------------\n\n#### 简要题意：\n\n给定一个长度为 $n$ 的 01 串 $a$ 以及 $l,r(l\\leq r)$。\n\n对于两个长度均为 $k$ 的 01 串 $p,q$，我们认为 $q$ 对于 $p$ 是「忠诚的」，当且仅当 $p$ 和 $q$ 满足如下要求：\n\n+ 对于任意 $1<i\\leq k$，如果 $q_{i-1}=p_{i-1}$，那么 $q_i\\geq p_i$，否则 $q_i\\leq p_i$。\n\n你需要求出如果**先等概率随机选出一个长度 $k$ 满足 $l\\leq k\\leq r$ 的 $a$ 的子串**，然后**再等概率随机出一个长度为 $k$ 的 01 串 $b$**，有多大的概率使得 $b$ 对于这个子串是「忠诚的」，结果对 $998244353$ 取模。", "inputFormat": "第一行三个整数 $n,l,r$，意义如上。\n\n第二行有一个长度为 $n$ 的字符串，表示 $a$。保证字符串只含字符 `0` 和 `1`。", "outputFormat": "一行一个整数，表示结果。", "hint": "#### 样例一解释：\n\n我们用 $\\left[l,r\\right]$ 表示所选择的子串所在区间。\n\n+ 选择 $\\left[1,2\\right]$，子串为 `01`，长度为 $2$，有 $3$ 个 01 串对这个子串是「忠诚的」，概率为 $\\dfrac{3}{4}$。\n+ 选择 $\\left[1,3\\right]$，子串为 `011`，长度为 $3$，有 $4$ 个 01 串对这个子串是「忠诚的」，概率为 $\\dfrac{1}{2}$。\n+ 选择 $\\left[2,3\\right]$，概率为 $\\dfrac{3}{4}$。\n\n+ 选择 $\\left[2,4\\right]$，概率为 $\\dfrac{5}{8}$。\n+ 选择 $\\left[3,4\\right]$，概率为 $\\dfrac{3}{4}$。\n+ 选择 $\\left[3,5\\right]$，概率为 $\\dfrac{1}{2}$。\n+ 选择 $\\left[4,5\\right]$，概率为 $\\dfrac{3}{4}$。\n\n结果为 $\\dfrac{\\dfrac{3}{4}+\\dfrac{1}{2}+\\dfrac{3}{4}+\\dfrac{5}{8}+\\dfrac{3}{4}+\\dfrac{1}{2}+\\dfrac{3}{4}}{7}=\\dfrac{37}{56}$，取模意义下为 $338690049$。\n\n------------\n\n**本题采用捆绑测试**\n\n+ Subtask 1 ( $1\\%$ )：$n=1$。\n+ Subtask 2 ( $13\\%$ )：$n\\leq100$。\n+ Subtask 3 ( $3\\%$ )：保证 $\\forall1\\leq i\\leq n,a_i=0$。\n+ Subtask 4 ( $3\\%$ )：保证 $\\forall1\\leq i\\leq n,a_i=1$。\n+ Subtask 5 ( $20\\%$ )：$n\\leq10^3$。\n+ Subtask 6 ( $15\\%$ )：$l=r$。\n+ Subtask 7 ( $20\\%$ )：$n\\leq 5\\times 10^5$。\n+ Subtask 8 ( $25\\%$ )：无特殊限制。\n\n对于所有数据，$1\\leq n\\leq5\\times 10^6,1\\leq l\\leq r\\leq n$。", "locale": "zh-CN"}}}
{"pid": "P7496", "type": "P", "difficulty": 6, "samples": [["3\n1 2 3\n1 2 3\n", "777777785"], ["12\n1 3 4 2 3 5 7 3 5 6 8 9\n4 3 10 2 5 6 4 8 2 9 12 5\n", "931089600"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "2021", "O2优化", "最大公约数 gcd", "莫比乌斯反演"], "title": "干杯！再会！", "background": ">酒酣之时，等待你的会是……\n\n黛米和哥哥在一个小城镇里经营着一家小酒吧。靠着哥哥调制的多夫林酒，这间小酒吧的生意也逐渐兴隆起来。", "description": "这家小店有 $n$ 位常驻顾客。第 $i$ 位顾客来到这家小店时都会带上一瓶美味度为 $a_i$ 的底酒和一份美味度为 $b_i$ 的调料。这些顾客会让黛米帮忙调酒。对于一瓶美味度为 $x$ 的底酒和一份美味度为 $y$ 的调料，如果黛米将它们调制在一起，就能得到一瓶美味度为 $\\gcd(x,y)$ 的美酒（我们认为美味度数值越低代表酒越好喝）。\n\n这一天，这些顾客同时来到了这家小店想要黛米帮忙调酒。然而黛米在前一天喝了太多的酒导致意识错乱了，这导致她将调料加入到了错误的底酒里。不过好在这些顾客并不在意，他们只想知道对于**所有**黛米加入调料的情况下，他们将会拿到的酒的美味度的**方差**的**和**在对 $10^9+7$ 取模意义下是多少。如果你能回答出他们的问题，那么他们会很愿意帮你支付酒钱。\n\n------------\n#### 简要题意：\n给定 $n$ 以及两个长度为 $n$ 的序列 $a,b$。对于一个 $1$ 到 $n$ 的排列 $p$，记 $c_i=\\gcd(a_i,b_{p_i})$，$\\sigma(c)$ 表示序列 $c$ 中所有元素的**方差**（方差公式详见提示），求：\n\n$$\\sum\\limits_{p}\\sigma(c)$$\n\n对 $10^9+7$ 取模。", "inputFormat": "第一行一个整数 $n$，意义如上。\n\n第二行有 $n$ 个整数，第 $i$ 个整数表示 $a_i$。\n\n第三行有 $n$ 个整数，第 $i$ 个整数表示 $b_i$。", "outputFormat": "一行一个整数，表示答案。", "hint": "#### 样例一解释\n+ $p=\\{1,2,3\\},c=\\{1,2,3\\},\\sigma(c)=\\dfrac{2}{3}$。\n+ $p=\\{1,3,2\\},c=\\{1,1,1\\},\\sigma(c)=0$。\n+ $p=\\{2,1,3\\},c=\\{1,1,3\\},\\sigma(c)=\\dfrac{8}{9}$。\n+ $p=\\{2,3,1\\},c=\\{1,1,1\\},\\sigma(c)=0$。\n+ $p=\\{3,1,2\\},c=\\{1,1,1\\},\\sigma(c)=0$。\n+ $p=\\{3,2,1\\},c=\\{1,2,1\\},\\sigma(c)=\\dfrac{2}{9}$。\n\n总和为 $\\dfrac{16}{9}$，对 $10^9+7$ 取模意义下为 $777777785$。\n\n------------\n#### 数据范围\n\n**本题采用捆绑测试**。\n\n+ Subtask 1 ( $5\\%$ )：$n\\leq8$。\n+ Subtask 2 ( $15\\%$ )：$n,a_i,b_i\\leq100$。\n+ Subtask 3 ( $25\\%$ )：$a_i,b_i\\leq10^3$。\n+ Subtask 4 ( $25\\%$ )：$n,a_i,b_i\\leq 10^5$。\n+ Subtask 5 ( $30\\%$ )：无特殊限制。\n\n对于所有数据，$2\\leq n\\leq 10^6,1\\leq a_i,b_i\\leq 10^6$。\n\n------------\n对于一个长度为 $n$ 的序列 $x$，方差 $\\sigma(x)=\\sum\\limits_{i=1}^n\\dfrac{1}{n}(x_i-\\bar{x})^2$，其中 $\\bar{x}$ 表示所有元素的平均数（$\\bar{x}=\\dfrac{1}{n}\\sum\\limits_{i=1}^nx_i$）。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "干杯！再会！", "background": ">酒酣之时，等待你的会是……\n\n黛米和哥哥在一个小城镇里经营着一家小酒吧。靠着哥哥调制的多夫林酒，这间小酒吧的生意也逐渐兴隆起来。", "description": "这家小店有 $n$ 位常驻顾客。第 $i$ 位顾客来到这家小店时都会带上一瓶美味度为 $a_i$ 的底酒和一份美味度为 $b_i$ 的调料。这些顾客会让黛米帮忙调酒。对于一瓶美味度为 $x$ 的底酒和一份美味度为 $y$ 的调料，如果黛米将它们调制在一起，就能得到一瓶美味度为 $\\gcd(x,y)$ 的美酒（我们认为美味度数值越低代表酒越好喝）。\n\n这一天，这些顾客同时来到了这家小店想要黛米帮忙调酒。然而黛米在前一天喝了太多的酒导致意识错乱了，这导致她将调料加入到了错误的底酒里。不过好在这些顾客并不在意，他们只想知道对于**所有**黛米加入调料的情况下，他们将会拿到的酒的美味度的**方差**的**和**在对 $10^9+7$ 取模意义下是多少。如果你能回答出他们的问题，那么他们会很愿意帮你支付酒钱。\n\n------------\n#### 简要题意：\n给定 $n$ 以及两个长度为 $n$ 的序列 $a,b$。对于一个 $1$ 到 $n$ 的排列 $p$，记 $c_i=\\gcd(a_i,b_{p_i})$，$\\sigma(c)$ 表示序列 $c$ 中所有元素的**方差**（方差公式详见提示），求：\n\n$$\\sum\\limits_{p}\\sigma(c)$$\n\n对 $10^9+7$ 取模。", "inputFormat": "第一行一个整数 $n$，意义如上。\n\n第二行有 $n$ 个整数，第 $i$ 个整数表示 $a_i$。\n\n第三行有 $n$ 个整数，第 $i$ 个整数表示 $b_i$。", "outputFormat": "一行一个整数，表示答案。", "hint": "#### 样例一解释\n+ $p=\\{1,2,3\\},c=\\{1,2,3\\},\\sigma(c)=\\dfrac{2}{3}$。\n+ $p=\\{1,3,2\\},c=\\{1,1,1\\},\\sigma(c)=0$。\n+ $p=\\{2,1,3\\},c=\\{1,1,3\\},\\sigma(c)=\\dfrac{8}{9}$。\n+ $p=\\{2,3,1\\},c=\\{1,1,1\\},\\sigma(c)=0$。\n+ $p=\\{3,1,2\\},c=\\{1,1,1\\},\\sigma(c)=0$。\n+ $p=\\{3,2,1\\},c=\\{1,2,1\\},\\sigma(c)=\\dfrac{2}{9}$。\n\n总和为 $\\dfrac{16}{9}$，对 $10^9+7$ 取模意义下为 $777777785$。\n\n------------\n#### 数据范围\n\n**本题采用捆绑测试**。\n\n+ Subtask 1 ( $5\\%$ )：$n\\leq8$。\n+ Subtask 2 ( $15\\%$ )：$n,a_i,b_i\\leq100$。\n+ Subtask 3 ( $25\\%$ )：$a_i,b_i\\leq10^3$。\n+ Subtask 4 ( $25\\%$ )：$n,a_i,b_i\\leq 10^5$。\n+ Subtask 5 ( $30\\%$ )：无特殊限制。\n\n对于所有数据，$2\\leq n\\leq 10^6,1\\leq a_i,b_i\\leq 10^6$。\n\n------------\n对于一个长度为 $n$ 的序列 $x$，方差 $\\sigma(x)=\\sum\\limits_{i=1}^n\\dfrac{1}{n}(x_i-\\bar{x})^2$，其中 $\\bar{x}$ 表示所有元素的平均数（$\\bar{x}=\\dfrac{1}{n}\\sum\\limits_{i=1}^nx_i$）。", "locale": "zh-CN"}}}
{"pid": "P7497", "type": "P", "difficulty": 6, "samples": [["5 5\n1 5 4 3 6\n1 2 4 3\n3 1 2 2\n4 2 5\n2 2 3 4\n4 1 3", "27\n37"], ["10 12\n4 2 1 5 10 3 2 4 6 7\n2 3 7 4\n1 2 9 5\n3 2 4 5\n3 4 7 2\n4 3 9\n1 1 8 2\n2 4 5 2\n3 6 8 2\n4 2 3\n1 2 10 6\n2 7 9 3\n4 1 10", "129\n16\n314"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["线段树", "2021"], "title": "四方喝彩", "background": ">念出他们的名字，让他们，再次回到舞台。\n\n麦克要在月亮河马戏团表演全新的杂技节目了！", "description": "麦克一共有 $n$ 个新节目，每个节目的惊险值为 $a_i$。\n\n接下来麦克可以通过若干次操作来对每个节目的惊险值进行变换：\n\n+ 麦克使用冰球，对于所有的 $l\\leq i\\leq r$，第 $i$ 个节目的惊险值会增加 $x$。\n\n+ 麦克使用土球，对于所有的 $l\\leq i\\leq r$，第 $i$ 个节目的惊险值会乘以 $x$。\n\n+ 麦克使用火球，对于所有的 $l\\leq i\\leq r$，第 $i$ 个节目的惊险值在接下来的 $x$ 个操作中**不会受到冰球和土球的影响**。火球效果**不会被替换**。\n\n当然观众对每个节目的惊险值也很好奇，所以你需要在操作过程中帮麦克回答对于所有 $l\\leq i\\leq r$，第 $i$ 个节目的惊险值之和。当然观众不希望惊险值过大，所以你需要将结果对 $10^9+7$ 取模。\n\n------------\n#### 简要题意：\n\n给你一个长度为 $n$ 的数组 $a$，你需要支持如下几个操作：\n\n1. `l r x`：对所有 $l\\leq i\\leq r$，令 $a_i$ 增加 $x$。\n2. `l r x`：对所有 $l\\leq i\\leq r$，令 $a_i$ 乘上 $x$。\n3. `l r x`：对所有 $l\\leq i\\leq r$，在接下来的 $x$ 个操作内，$a_i$ 将会被封锁，**不会受到操作 1 和操作 2 的影响**（设本次操作为第 $k$ 次操作，则第 $k+1,k+2,\\cdots,k+x$ 次操作中的所有操作 1和操作 2 不会对区间 $\\left[l,r\\right]$ 产生影响）。已有的封锁效果**不会被替换**（即假设第 $3$ 次有一个操作 3 对某个位置进行封锁，封锁时间为 $5$，第 $5$ 次操作同样对这个位置进行封锁，封锁时间为 $2$ 那么实际上这个位置在第 $4$ 次操作到第 $8$ 次操作的时间内都会被封锁）（感性理解就是后面时间短的封锁不会使前面时间长的封锁失效）。\n4. `l r`：询问 $\\sum\\limits_{l\\leq i\\leq r}a_i$，对 $10^9+7$ 取模。", "inputFormat": "第一行有两个正整数 $n,m$，分别表示数组长度和操作数。\n\n第二行会有 $n$ 个整数 $a_i$，表示数组 $a$。\n\n接下来 $m$ 行，每行有三个整数 $opt,l,r$ 表示操作编号以及这次操作的 $l,r$，如果 $opt\\leq 3$，那么还会有一个整数 $x$，表示这次操作的 $x$。", "outputFormat": "对于所有的操作 4，一行一个整数表示结果，对 $10^9+7$ 取模。", "hint": "#### 样例一解释\n一开始数组为 $\\{1,5,4,3,6\\}$。\n\n+ 执行第 $1$ 次操作，此时数组变为 $\\{1,8,7,6,6\\}$。\n+ 执行第 $2$ 次操作，此时数组不变。\n+ 执行第 $3$ 次操作，询问结果为 $27$。\n+ 执行第 $4$ 次操作，因为此时 $a_2$ 在第 $2$ 次操作中被封锁还未解除，所以这次操作只对 $a_3$ 产生影响，数组变为 $\\{1,8,28,6,6\\}$。\n+ 执行第 $5$ 次操作，询问结果为 $37$。\n\n------------\n#### 数据范围\n\n**本题采用捆绑测试**。\n\n+ Subtask 1 ( $25\\%$ )：$n,m\\leq2\\times10^3$。\n+ Subtask 2 ( $8\\%$ )：没有操作 3。\n+ Subtask 3 ( $17\\%$ )：对于所有操作 4，保证 $l=r$。\n+ Subtask 4 ( $50\\%$ )：无特殊限制。\n\n对于所有数据，$1\\leq n,m\\leq 2\\times 10^5,0\\leq a_i<10^9+7,1\\leq l\\leq r\\leq n$，对于所有操作 1 和操作 2，保证 $0\\leq x<10^9+7$，对于所有操作 3，设其为第 $k$ 次操作，保证 $0\\leq x\\leq m-k$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "四方喝彩", "background": ">念出他们的名字，让他们，再次回到舞台。\n\n麦克要在月亮河马戏团表演全新的杂技节目了！", "description": "麦克一共有 $n$ 个新节目，每个节目的惊险值为 $a_i$。\n\n接下来麦克可以通过若干次操作来对每个节目的惊险值进行变换：\n\n+ 麦克使用冰球，对于所有的 $l\\leq i\\leq r$，第 $i$ 个节目的惊险值会增加 $x$。\n\n+ 麦克使用土球，对于所有的 $l\\leq i\\leq r$，第 $i$ 个节目的惊险值会乘以 $x$。\n\n+ 麦克使用火球，对于所有的 $l\\leq i\\leq r$，第 $i$ 个节目的惊险值在接下来的 $x$ 个操作中**不会受到冰球和土球的影响**。火球效果**不会被替换**。\n\n当然观众对每个节目的惊险值也很好奇，所以你需要在操作过程中帮麦克回答对于所有 $l\\leq i\\leq r$，第 $i$ 个节目的惊险值之和。当然观众不希望惊险值过大，所以你需要将结果对 $10^9+7$ 取模。\n\n------------\n#### 简要题意：\n\n给你一个长度为 $n$ 的数组 $a$，你需要支持如下几个操作：\n\n1. `l r x`：对所有 $l\\leq i\\leq r$，令 $a_i$ 增加 $x$。\n2. `l r x`：对所有 $l\\leq i\\leq r$，令 $a_i$ 乘上 $x$。\n3. `l r x`：对所有 $l\\leq i\\leq r$，在接下来的 $x$ 个操作内，$a_i$ 将会被封锁，**不会受到操作 1 和操作 2 的影响**（设本次操作为第 $k$ 次操作，则第 $k+1,k+2,\\cdots,k+x$ 次操作中的所有操作 1和操作 2 不会对区间 $\\left[l,r\\right]$ 产生影响）。已有的封锁效果**不会被替换**（即假设第 $3$ 次有一个操作 3 对某个位置进行封锁，封锁时间为 $5$，第 $5$ 次操作同样对这个位置进行封锁，封锁时间为 $2$ 那么实际上这个位置在第 $4$ 次操作到第 $8$ 次操作的时间内都会被封锁）（感性理解就是后面时间短的封锁不会使前面时间长的封锁失效）。\n4. `l r`：询问 $\\sum\\limits_{l\\leq i\\leq r}a_i$，对 $10^9+7$ 取模。", "inputFormat": "第一行有两个正整数 $n,m$，分别表示数组长度和操作数。\n\n第二行会有 $n$ 个整数 $a_i$，表示数组 $a$。\n\n接下来 $m$ 行，每行有三个整数 $opt,l,r$ 表示操作编号以及这次操作的 $l,r$，如果 $opt\\leq 3$，那么还会有一个整数 $x$，表示这次操作的 $x$。", "outputFormat": "对于所有的操作 4，一行一个整数表示结果，对 $10^9+7$ 取模。", "hint": "#### 样例一解释\n一开始数组为 $\\{1,5,4,3,6\\}$。\n\n+ 执行第 $1$ 次操作，此时数组变为 $\\{1,8,7,6,6\\}$。\n+ 执行第 $2$ 次操作，此时数组不变。\n+ 执行第 $3$ 次操作，询问结果为 $27$。\n+ 执行第 $4$ 次操作，因为此时 $a_2$ 在第 $2$ 次操作中被封锁还未解除，所以这次操作只对 $a_3$ 产生影响，数组变为 $\\{1,8,28,6,6\\}$。\n+ 执行第 $5$ 次操作，询问结果为 $37$。\n\n------------\n#### 数据范围\n\n**本题采用捆绑测试**。\n\n+ Subtask 1 ( $25\\%$ )：$n,m\\leq2\\times10^3$。\n+ Subtask 2 ( $8\\%$ )：没有操作 3。\n+ Subtask 3 ( $17\\%$ )：对于所有操作 4，保证 $l=r$。\n+ Subtask 4 ( $50\\%$ )：无特殊限制。\n\n对于所有数据，$1\\leq n,m\\leq 2\\times 10^5,0\\leq a_i<10^9+7,1\\leq l\\leq r\\leq n$，对于所有操作 1 和操作 2，保证 $0\\leq x<10^9+7$，对于所有操作 3，设其为第 $k$ 次操作，保证 $0\\leq x\\leq m-k$。", "locale": "zh-CN"}}}
{"pid": "P7498", "type": "P", "difficulty": 7, "samples": [["6 4 499122177\n1 2\n1 3\n5 3\n4 6\n4 3\n2 N 1 S\n3 S 1 S\n5 N 6 N\n1 S 4 N", "3\n6\n17\n11"], ["10 6 199648871\n3 7\n4 9\n2 3\n5 6\n7 10\n5 7\n5 9\n8 2\n1 3\n10 S 5 S\n1 N 7 S\n1 N 4 N\n1 S 4 N\n4 N 3 S\n7 N 4 N", "332748127\n8\n665496262\n665496261\n665496253\n831870314"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "O2优化", "树形 DP", "期望"], "title": "磁控法则", "background": ">那只不过是别人的不幸。\n\n诺顿进入了一个结构复杂的洞穴。在之前的勘察中，他已经得知了这个洞穴里有他梦寐以求的宝藏。\n\n然而这个洞穴是如此的黑暗与复杂，以至于他探索了许久都没有找到宝藏的所在地。但宝藏强大的吸引力仍驱使着他继续搜寻。然而很快他就意识到了不对劲，因为那股吸引力不仅作用在他脑海中，也作用在他身体上——宝藏的防御机关正释放巨大的磁力试图驱逐外来者。\n\n「果然，这就是它自带的保护机制吗？」诺顿笑了笑，拿出了一小块散发着奇特光芒的金属。\n\n「不过，我也是有准备的。」", "description": "诺顿所在的洞穴可以看作是由 $n$ 个洞窟和 $n-1$ 条通道形成的树状结构，诺顿在石窟 $s$，宝藏在石窟 $t$。在宝藏所在的石窟里有一块拥有强大磁场的特殊的磁铁，诺顿身上也有一块小型的同样材质的磁铁。宝藏石窟里的磁铁**只有一个磁极**（N 或 S），并且**磁极不会发生变化**。诺顿身上的磁铁也**只有一个磁极**（N 或 S），但**每个时刻开始时会有 $p$ 的概率切换磁极**（N 变成 S，S 变成 N）。\n\n每个时刻诺顿的移动方式由宝藏石窟磁铁的磁极和诺顿身上磁铁的磁极决定：\n\n1. 两块磁铁磁极不同。此时两块磁铁会触发「吸引」效果。诺顿会因为磁铁间的吸引力移动到与 $s$ 相连的石窟中到 $t$ 距离 $-1$ 的石窟中（即**以 $t$ 为根时 $s$ 的父亲**）。\n\n2. 两块磁铁磁极相同。此时两块磁铁会触发「弹射」效果。诺顿会因为磁铁间的排斥力**等概率**移动到与 $s$ 相连的石窟中到 $t$ 距离 $+1$ 的石窟（即**以 $t$ 为根时 $s$ 的任意一个儿子**）。如果没有满足的石窟，将触发「眩晕」效果，下个时刻诺顿将**不进行任何的移动，也不会进行任何的磁极切换**。\n\n经过一段时间的勘察，诺顿已经知道了整个洞穴的结构以及磁极切换的概率 $p$。为了更好的寻找宝藏，他每次会向你提出询问，你需要回答他如果一开始诺顿在石窟 $x$，身上磁铁磁极为 $c_1$，宝藏在石窟 $y$，石窟内磁铁磁极为 $c_2$，期望在多少时刻后诺顿可以找到宝藏。", "inputFormat": "第一行三个整数 $n,q,p$，分别表示石窟数，询问数和磁极切换概率。其中磁极切换概率为在 $998244353$ 取模意义下的概率。\n\n接下来 $n-1$ 行，每行两个正整数 $u,v$，表示石窟 $u$ 和石窟 $v$ 之间存在一条通道。保证最后结构为一棵树。\n\n接下来 $q$ 行，每行**依次**有一个正整数 $x$，一个字符 $c_1$，一个正整数 $y$，一个字符 $c_2$，表示一个询问，各自意义如上。保证 $c_1,c_2$ 为 `N` 或 `S`。", "outputFormat": "$q$ 行，每行一个非负整数，表示询问答案对 $998244353$ 取模后的结果。", "hint": "#### 样例一解释\n每个时刻磁极切换概率为 $\\dfrac{1}{2}$。\n\n洞窟结构如下：  \n![](https://cdn.luogu.com.cn/upload/image_hosting/od4ixuog.png)\n\n对于询问 $1$，诺顿在第 $1$ 个时刻有 $\\dfrac{1}{2}$ 的概率移动到 $1$，有 $\\dfrac{1}{2}$ 的概率触发「眩晕」进入第 $3$ 个时刻。在第 $3$ 个时刻同样有 $\\dfrac{1}{2}$ 的概率移动到 $1$，有 $\\dfrac{1}{2}$ 的概率触发「眩晕」进入第 $5$ 个时刻……期望结果为 $1\\times\\dfrac{1}{2}+3\\times\\left(\\dfrac{1}{2}\\right)^2+5\\times\\left(\\dfrac{1}{2}\\right)^3+\\ldots=3$。\n\n------------\n#### 数据范围\n\n**本题采用捆绑测试**。\n\n+ Subtask 1 ( $10\\%$ )：$n,q\\leq15$。\n+ Subtask 2 ( $20\\%$ )：$n\\leq10^3$。\n+ Subtask 3 ( $25\\%$ )：对于所有询问，保证 $y=1$。\n+ Subtask 4 ( $45\\%$ )：无特殊限制。\n\n对于所有数据，$2\\leq n\\leq5\\times 10^5,1\\leq q\\leq5\\times10^5,1\\leq u,v,x,y\\leq n,x\\neq y,2\\leq p\\leq998244352$。\n\n------------\n**本题读入量较大，请使用较快的读入方式。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "磁控法则", "background": ">那只不过是别人的不幸。\n\n诺顿进入了一个结构复杂的洞穴。在之前的勘察中，他已经得知了这个洞穴里有他梦寐以求的宝藏。\n\n然而这个洞穴是如此的黑暗与复杂，以至于他探索了许久都没有找到宝藏的所在地。但宝藏强大的吸引力仍驱使着他继续搜寻。然而很快他就意识到了不对劲，因为那股吸引力不仅作用在他脑海中，也作用在他身体上——宝藏的防御机关正释放巨大的磁力试图驱逐外来者。\n\n「果然，这就是它自带的保护机制吗？」诺顿笑了笑，拿出了一小块散发着奇特光芒的金属。\n\n「不过，我也是有准备的。」", "description": "诺顿所在的洞穴可以看作是由 $n$ 个洞窟和 $n-1$ 条通道形成的树状结构，诺顿在石窟 $s$，宝藏在石窟 $t$。在宝藏所在的石窟里有一块拥有强大磁场的特殊的磁铁，诺顿身上也有一块小型的同样材质的磁铁。宝藏石窟里的磁铁**只有一个磁极**（N 或 S），并且**磁极不会发生变化**。诺顿身上的磁铁也**只有一个磁极**（N 或 S），但**每个时刻开始时会有 $p$ 的概率切换磁极**（N 变成 S，S 变成 N）。\n\n每个时刻诺顿的移动方式由宝藏石窟磁铁的磁极和诺顿身上磁铁的磁极决定：\n\n1. 两块磁铁磁极不同。此时两块磁铁会触发「吸引」效果。诺顿会因为磁铁间的吸引力移动到与 $s$ 相连的石窟中到 $t$ 距离 $-1$ 的石窟中（即**以 $t$ 为根时 $s$ 的父亲**）。\n\n2. 两块磁铁磁极相同。此时两块磁铁会触发「弹射」效果。诺顿会因为磁铁间的排斥力**等概率**移动到与 $s$ 相连的石窟中到 $t$ 距离 $+1$ 的石窟（即**以 $t$ 为根时 $s$ 的任意一个儿子**）。如果没有满足的石窟，将触发「眩晕」效果，下个时刻诺顿将**不进行任何的移动，也不会进行任何的磁极切换**。\n\n经过一段时间的勘察，诺顿已经知道了整个洞穴的结构以及磁极切换的概率 $p$。为了更好的寻找宝藏，他每次会向你提出询问，你需要回答他如果一开始诺顿在石窟 $x$，身上磁铁磁极为 $c_1$，宝藏在石窟 $y$，石窟内磁铁磁极为 $c_2$，期望在多少时刻后诺顿可以找到宝藏。", "inputFormat": "第一行三个整数 $n,q,p$，分别表示石窟数，询问数和磁极切换概率。其中磁极切换概率为在 $998244353$ 取模意义下的概率。\n\n接下来 $n-1$ 行，每行两个正整数 $u,v$，表示石窟 $u$ 和石窟 $v$ 之间存在一条通道。保证最后结构为一棵树。\n\n接下来 $q$ 行，每行**依次**有一个正整数 $x$，一个字符 $c_1$，一个正整数 $y$，一个字符 $c_2$，表示一个询问，各自意义如上。保证 $c_1,c_2$ 为 `N` 或 `S`。", "outputFormat": "$q$ 行，每行一个非负整数，表示询问答案对 $998244353$ 取模后的结果。", "hint": "#### 样例一解释\n每个时刻磁极切换概率为 $\\dfrac{1}{2}$。\n\n洞窟结构如下：  \n![](https://cdn.luogu.com.cn/upload/image_hosting/od4ixuog.png)\n\n对于询问 $1$，诺顿在第 $1$ 个时刻有 $\\dfrac{1}{2}$ 的概率移动到 $1$，有 $\\dfrac{1}{2}$ 的概率触发「眩晕」进入第 $3$ 个时刻。在第 $3$ 个时刻同样有 $\\dfrac{1}{2}$ 的概率移动到 $1$，有 $\\dfrac{1}{2}$ 的概率触发「眩晕」进入第 $5$ 个时刻……期望结果为 $1\\times\\dfrac{1}{2}+3\\times\\left(\\dfrac{1}{2}\\right)^2+5\\times\\left(\\dfrac{1}{2}\\right)^3+\\ldots=3$。\n\n------------\n#### 数据范围\n\n**本题采用捆绑测试**。\n\n+ Subtask 1 ( $10\\%$ )：$n,q\\leq15$。\n+ Subtask 2 ( $20\\%$ )：$n\\leq10^3$。\n+ Subtask 3 ( $25\\%$ )：对于所有询问，保证 $y=1$。\n+ Subtask 4 ( $45\\%$ )：无特殊限制。\n\n对于所有数据，$2\\leq n\\leq5\\times 10^5,1\\leq q\\leq5\\times10^5,1\\leq u,v,x,y\\leq n,x\\neq y,2\\leq p\\leq998244352$。\n\n------------\n**本题读入量较大，请使用较快的读入方式。**", "locale": "zh-CN"}}}
{"pid": "P7499", "type": "P", "difficulty": 1, "samples": [["1\n1 2 3 4 5\n", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": [], "title": "「HMOI R1」概率", "background": "“傻子才相信概率。”", "description": "fz 退役之后正在学文化课。\n\nfz 见到一个题，这个题是这样的：\n\n给定区间 $[a, b]$ 和 $[c, d]$，求从其中各等概率选择一个整数，和等于 $e$ 的概率。\n\nfz 本来想把 “等于 $e$” 改成 “$\\in [e,f]$”，但是这样他就会变成辣鸡分类讨论出题人，所以他决定不改。\n\n为了方便，你只需输出答案乘 $(b-a+1)(d-c+1)$ 的结果。可以证明这个数是一个整数。", "inputFormat": "第一行一个整数 $T$，代表共有 $T$ 组数据。\n\n接下来 $T$ 行，每行五个整数 $a, b, c, d, e$。", "outputFormat": "共 $T$ 行，每组数据一行一个自然数，表示对应的答案。", "hint": "样例解释：\n\n对于样例的第一组数据，从 $[1,2]$ 和 $[3,4]$ 中各随机选出一个整数的方案共有 $4$ 种，其中只有 $\\{1,4\\}$ 和 $\\{2,3\\}$ 两种方案和为 $5$，故概率为 $\\dfrac12$。\n\n---------\n\n令 $N=\\max\\{|a|,|b|,|c|,|d|,|e|\\}$。\n\n对于所有数据：\n\n- $1 \\le T \\le 1000$；\n\n- $0 \\le N \\le 10^{18}$。\n\n-----------------\n\n**本题不采用捆绑测试。**\n\n| No.  | Constraints            | Score |\n| ---- | ---------------------- | ----- |\n| $1$  | 与样例相同             | $10$  |\n| $2$  | $N \\le 300$            | $10$  |\n| $3$  | $N \\le 5000$           | $30$  |\n| $4$  | $N \\le 10^9$           | $20$  |\n| $5$  | No further constraints | $30$  |\n\n---------\n\n- Idea: FZzzz  \n- Solution: FZzzz  \n- Code: FZzzz  \n- Data: FZzzz", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「HMOI R1」概率", "background": "“傻子才相信概率。”", "description": "fz 退役之后正在学文化课。\n\nfz 见到一个题，这个题是这样的：\n\n给定区间 $[a, b]$ 和 $[c, d]$，求从其中各等概率选择一个整数，和等于 $e$ 的概率。\n\nfz 本来想把 “等于 $e$” 改成 “$\\in [e,f]$”，但是这样他就会变成辣鸡分类讨论出题人，所以他决定不改。\n\n为了方便，你只需输出答案乘 $(b-a+1)(d-c+1)$ 的结果。可以证明这个数是一个整数。", "inputFormat": "第一行一个整数 $T$，代表共有 $T$ 组数据。\n\n接下来 $T$ 行，每行五个整数 $a, b, c, d, e$。", "outputFormat": "共 $T$ 行，每组数据一行一个自然数，表示对应的答案。", "hint": "样例解释：\n\n对于样例的第一组数据，从 $[1,2]$ 和 $[3,4]$ 中各随机选出一个整数的方案共有 $4$ 种，其中只有 $\\{1,4\\}$ 和 $\\{2,3\\}$ 两种方案和为 $5$，故概率为 $\\dfrac12$。\n\n---------\n\n令 $N=\\max\\{|a|,|b|,|c|,|d|,|e|\\}$。\n\n对于所有数据：\n\n- $1 \\le T \\le 1000$；\n\n- $0 \\le N \\le 10^{18}$。\n\n-----------------\n\n**本题不采用捆绑测试。**\n\n| No.  | Constraints            | Score |\n| ---- | ---------------------- | ----- |\n| $1$  | 与样例相同             | $10$  |\n| $2$  | $N \\le 300$            | $10$  |\n| $3$  | $N \\le 5000$           | $30$  |\n| $4$  | $N \\le 10^9$           | $20$  |\n| $5$  | No further constraints | $30$  |\n\n---------\n\n- Idea: FZzzz  \n- Solution: FZzzz  \n- Code: FZzzz  \n- Data: FZzzz", "locale": "zh-CN"}}}
{"pid": "P7500", "type": "P", "difficulty": 4, "samples": [["8 4 4\n4 1 2 3 5\n2 3 6\n2 2 4\n3 7 4 8\n1 6\n4 3\n4 8\n6 7", "9"], ["8 4 4\n4 1 2 3 5\n3 6 3 8\n2 2 4\n3 7 4 8\n1 6\n4 3\n4 8\n6 7", "7"], ["8 3 4\n4 1 2 3 5\n2 3 6\n3 7 4 8\n1 6\n4 3\n4 8\n6 7", "3"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化"], "title": "「HMOI R1」地铁客流", "background": "一座城市的地铁客流量是非常重要的指标，它体现了这座城市正在不断流动着的人口数量。无论通勤还是旅游，都会给这座城市的经济带来活力。\n\n疫情期间各地地铁客流惨淡，甚至有部分城市地铁停运。现在疫情态势好转，各地陆续复工复产，地铁客流量大小也是判断城市复工复产、经济恢复率的重要参考。", "description": "天穹市的地铁系统由 $M$ 条线路组成，共有 $N$ 座车站，**每座车站都会有线路停靠**。每条线路的相邻两站之间可视为由无向边连接。其中地铁 $i$ 号线上有 $k_i$ 座车站，**这些车站互不相同**。\n\n这些线路会在一些车站相交，也就是说，一座车站可能有很多线路停靠。\n\n现在，有 $P$ 位乘客分别想从 $s_j$ 号车站出发，去 $t_j$ 号车站，**保证这两座车站不同**。当这两座车站不在一条线路上时，他就会进行若干次换乘。作为天穹地铁的技术工作人员，你需要计算这些乘客贡献的客流量。\n\n-------------\n\n请注意，在这里使用的客流量计算方法和实际应用中的有所不同。\n\n客流量 $=$ 进站客流 $+$ 换乘客流。进站客流即为乘客数；换乘客流为乘客的换乘次数。起终点之间可能会有多条路径可以选择，此时，地铁客流量与 **乘客选择的** 路径无关；计算时，我们只考虑 **换乘次数最少** 的路径。\n\n---------\n\n注意：\n\n- 设从 $s$ 到 $t$ 最少进行 $\\rm trans$ 次换乘，则此时要乘坐 $\\rm trans + 1$ 条线路，贡献 $\\rm trans + 1$ 的客流量。  \n- 当乘客不能从起点到达终点时，即 $s, t$ 之间没有通路，他就会去坐公交，此时客流量计为 $0$。", "inputFormat": "第一行三个整数 $N, M, P$。\n\n接下来 $M$ 行，每行表示一条地铁线路：  \n每行第一个整数为 $k_i\\ (2 \\le k_i \\le N)$，为这条线的车站数；  \n后面 $k_i$ 个整数 $q\\ (1 \\le q \\le N)$，为这条线路依次经过的车站编号。\n\n接下来 $P$ 行，每行两个整数 $s_j, t_j\\ (1 \\le s_j, t_j \\le N;\\ s_j \\neq t_j)$，表示一位乘客的出行起终点。", "outputFormat": "仅一行一个整数，表示这些乘客贡献的客流量。", "hint": "样例解释：\n\n- 默认乘客会选择换乘次数最少的路径。\n- 边上的数字表示所在地铁线路的编号。\n\n样例 1 如图：\n![](https://cdn.luogu.com.cn/upload/image_hosting/t97d5qmr.png)\n\n乘客 $1$ 会乘坐 $1$ 号线从 $1$ 到 $3$，再乘坐 $2$ 号线从 $3$ 到 $6$；  \n乘客 $2$ 会乘坐 $3$ 号线从 $4$ 到 $2$，再乘坐 $1$ 号线从 $2$ 到 $3$；  \n乘客 $3$ 会乘坐 $4$ 号线从 $4$ 到 $8$；  \n乘客 $4$ 会乘坐 $2$ 号线从 $6$ 到 $3$，乘坐 $1$ 号线从 $3$ 到 $2$，再乘坐 $3$ 号线从 $2$ 到 $4$，最后乘坐 $4$ 号线从 $4$ 到 $7$。\n\n如上，四个人分别贡献了 $2, 2, 1, 4$ 的客流量，答案为 $9$。\n\n样例 2 如图：\n![](https://cdn.luogu.com.cn/upload/image_hosting/i0lm9un9.png)\n\n相比样例 1，  \n乘客 $2$ 可以选择另外一条路线，即乘坐 $4$ 号线从 $4$ 到 $8$，再乘坐 $2$ 号线从 $8$ 到 $3$，也是换乘一次的；  \n乘客 $4$ 可以选择另外一条换乘次数更少的的路线：乘坐 $4$ 号线从 $7$ 到 $8$，再乘坐 $2$ 号线从 $8$ 到 $6$，只换乘了一次。\n\n总客流量为 $2 + 2 + 1 + 2 = 7$。\n\n样例 3 如图：\n![](https://cdn.luogu.com.cn/upload/image_hosting/a2afk5k5.png)\n\n相比样例 1，乘客 $2$ 和 $4$ 的出行路径不是通路，不会计入客流量。\n\n总客流量为 $2 + 0 + 1 + 0 = 3$。\n\n------------\n\n设车站 $i$ 停靠的线路数为 $\\mathrm{siz}_i$。  \n对于所有数据：\n\n- $2 \\le N \\le 10^5$；\n- $1 \\le M \\le 1000$；\n- $1 \\le P \\le 100$；\n- $1 \\le \\mathrm{siz}_i \\le 50$。\n\n--------\n\n**本题采用捆绑测试。**\n\n| No.  | Constraints              | Score |\n| ---- | ------------------------ | ----- |\n| $1$  | $N, P \\le 5;\\ M \\le 3$   | $10$  |\n| $2$  | $k_i = 2$                | $20$  |\n| $3$  | $N, M \\le 50;\\ P \\le 10$ | $20$  |\n| $4$  | $M \\le 500;\\ P \\le 10$   | $20$  |\n| $5$  | No further constraints   | $30$  |\n\n------------\n\n由于读入量较大，请勿不关流同步使用 `cin`。\n\n你可以通过 `std::ios::sync_with_stdio(false)` 来关闭 `cin` 的流同步。\n\n你也可以使用以下快速读入模板，支持读入 `int` 范围内的非负整数。\n\n```cpp\nint readInt() {\n\tint ret = 0; char o;\n\twhile (!isdigit(o = getchar()));\n\tdo ret = ret * 10 + (o ^ 48);\n\twhile (isdigit(o = getchar()));\n\treturn ret;\n}\n```\n----------\n\n- Idea: 南桥汽车站\n- Solution: 南桥汽车站\n- Code: 南桥汽车站\n- Data: 南桥汽车站", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「HMOI R1」地铁客流", "background": "一座城市的地铁客流量是非常重要的指标，它体现了这座城市正在不断流动着的人口数量。无论通勤还是旅游，都会给这座城市的经济带来活力。\n\n疫情期间各地地铁客流惨淡，甚至有部分城市地铁停运。现在疫情态势好转，各地陆续复工复产，地铁客流量大小也是判断城市复工复产、经济恢复率的重要参考。", "description": "天穹市的地铁系统由 $M$ 条线路组成，共有 $N$ 座车站，**每座车站都会有线路停靠**。每条线路的相邻两站之间可视为由无向边连接。其中地铁 $i$ 号线上有 $k_i$ 座车站，**这些车站互不相同**。\n\n这些线路会在一些车站相交，也就是说，一座车站可能有很多线路停靠。\n\n现在，有 $P$ 位乘客分别想从 $s_j$ 号车站出发，去 $t_j$ 号车站，**保证这两座车站不同**。当这两座车站不在一条线路上时，他就会进行若干次换乘。作为天穹地铁的技术工作人员，你需要计算这些乘客贡献的客流量。\n\n-------------\n\n请注意，在这里使用的客流量计算方法和实际应用中的有所不同。\n\n客流量 $=$ 进站客流 $+$ 换乘客流。进站客流即为乘客数；换乘客流为乘客的换乘次数。起终点之间可能会有多条路径可以选择，此时，地铁客流量与 **乘客选择的** 路径无关；计算时，我们只考虑 **换乘次数最少** 的路径。\n\n---------\n\n注意：\n\n- 设从 $s$ 到 $t$ 最少进行 $\\rm trans$ 次换乘，则此时要乘坐 $\\rm trans + 1$ 条线路，贡献 $\\rm trans + 1$ 的客流量。  \n- 当乘客不能从起点到达终点时，即 $s, t$ 之间没有通路，他就会去坐公交，此时客流量计为 $0$。", "inputFormat": "第一行三个整数 $N, M, P$。\n\n接下来 $M$ 行，每行表示一条地铁线路：  \n每行第一个整数为 $k_i\\ (2 \\le k_i \\le N)$，为这条线的车站数；  \n后面 $k_i$ 个整数 $q\\ (1 \\le q \\le N)$，为这条线路依次经过的车站编号。\n\n接下来 $P$ 行，每行两个整数 $s_j, t_j\\ (1 \\le s_j, t_j \\le N;\\ s_j \\neq t_j)$，表示一位乘客的出行起终点。", "outputFormat": "仅一行一个整数，表示这些乘客贡献的客流量。", "hint": "样例解释：\n\n- 默认乘客会选择换乘次数最少的路径。\n- 边上的数字表示所在地铁线路的编号。\n\n样例 1 如图：\n![](https://cdn.luogu.com.cn/upload/image_hosting/t97d5qmr.png)\n\n乘客 $1$ 会乘坐 $1$ 号线从 $1$ 到 $3$，再乘坐 $2$ 号线从 $3$ 到 $6$；  \n乘客 $2$ 会乘坐 $3$ 号线从 $4$ 到 $2$，再乘坐 $1$ 号线从 $2$ 到 $3$；  \n乘客 $3$ 会乘坐 $4$ 号线从 $4$ 到 $8$；  \n乘客 $4$ 会乘坐 $2$ 号线从 $6$ 到 $3$，乘坐 $1$ 号线从 $3$ 到 $2$，再乘坐 $3$ 号线从 $2$ 到 $4$，最后乘坐 $4$ 号线从 $4$ 到 $7$。\n\n如上，四个人分别贡献了 $2, 2, 1, 4$ 的客流量，答案为 $9$。\n\n样例 2 如图：\n![](https://cdn.luogu.com.cn/upload/image_hosting/i0lm9un9.png)\n\n相比样例 1，  \n乘客 $2$ 可以选择另外一条路线，即乘坐 $4$ 号线从 $4$ 到 $8$，再乘坐 $2$ 号线从 $8$ 到 $3$，也是换乘一次的；  \n乘客 $4$ 可以选择另外一条换乘次数更少的的路线：乘坐 $4$ 号线从 $7$ 到 $8$，再乘坐 $2$ 号线从 $8$ 到 $6$，只换乘了一次。\n\n总客流量为 $2 + 2 + 1 + 2 = 7$。\n\n样例 3 如图：\n![](https://cdn.luogu.com.cn/upload/image_hosting/a2afk5k5.png)\n\n相比样例 1，乘客 $2$ 和 $4$ 的出行路径不是通路，不会计入客流量。\n\n总客流量为 $2 + 0 + 1 + 0 = 3$。\n\n------------\n\n设车站 $i$ 停靠的线路数为 $\\mathrm{siz}_i$。  \n对于所有数据：\n\n- $2 \\le N \\le 10^5$；\n- $1 \\le M \\le 1000$；\n- $1 \\le P \\le 100$；\n- $1 \\le \\mathrm{siz}_i \\le 50$。\n\n--------\n\n**本题采用捆绑测试。**\n\n| No.  | Constraints              | Score |\n| ---- | ------------------------ | ----- |\n| $1$  | $N, P \\le 5;\\ M \\le 3$   | $10$  |\n| $2$  | $k_i = 2$                | $20$  |\n| $3$  | $N, M \\le 50;\\ P \\le 10$ | $20$  |\n| $4$  | $M \\le 500;\\ P \\le 10$   | $20$  |\n| $5$  | No further constraints   | $30$  |\n\n------------\n\n由于读入量较大，请勿不关流同步使用 `cin`。\n\n你可以通过 `std::ios::sync_with_stdio(false)` 来关闭 `cin` 的流同步。\n\n你也可以使用以下快速读入模板，支持读入 `int` 范围内的非负整数。\n\n```cpp\nint readInt() {\n\tint ret = 0; char o;\n\twhile (!isdigit(o = getchar()));\n\tdo ret = ret * 10 + (o ^ 48);\n\twhile (isdigit(o = getchar()));\n\treturn ret;\n}\n```\n----------\n\n- Idea: 南桥汽车站\n- Solution: 南桥汽车站\n- Code: 南桥汽车站\n- Data: 南桥汽车站", "locale": "zh-CN"}}}
{"pid": "P7501", "type": "P", "difficulty": 4, "samples": [["4 4 0\n1 1 1 1", "24"], ["4 4 1\n1 1 1 1", "24"], ["3 47 1\n4 8 9", "10940"], ["8 100000 1\n21 37 23 13 32 22 9 39", "405170260"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["O2优化"], "title": "「HMOI R1」50 块好兄弟", "background": "Polaris_Dane 非常菜，他不仅沉迷于计数，而且喜欢玩星际争霸 2。", "description": "「我的好兄弟无穷无尽，而你的虫子每时每刻都在消亡」\n\n作为新上任爱民如子的指挥官，Polaris_Dane 充分领悟了雷诺指挥官的智慧，决定将此战术贯彻到底。\n\n有 $N$ 个兵营，依次编号为 $1,2,3\\cdots N$。现在需要把它们排列在一条数轴中位于 $[1,M]$ 间的整点处。每一个兵营都有一个生产范围 $r_i$，若兵营放在点 $x\\ (1 \\le x \\le M)$ 处，那么它会在区间 $[x - r_i + 1, x + r_i - 1]$ 生产好兄弟。\n\n当 $\\rm type = 0$ 时，生产好兄弟的范围必须被区间 $[1,M]$ 完全包含；当 $\\rm type = 1$ 时，生产好兄弟的范围可以落在 $[1,M]$ 之外，但是兵营必须放在 $[1,M]$ 内。\n\nPolaris_Dane 不能让好兄弟们太挤了，所以任何两个兵营的生产范围 **都不能相交**，他想知道有多少种方案满足该条件。\n\n若两个方案中存在一个编号为 $i$ 的兵营，其在两个方案中的放置位置不同，则称这两个方案不同。\n\n由于答案可能很大，所以 Polaris_Dane 想请你输出答案对 $998244353$ 取模后的结果。", "inputFormat": "第一行三个整数 $N, M, \\mathrm{type}$，其中 $\\rm type \\in \\{0, 1\\}$。\n\n第二行 $N$ 个整数 $r_1, r_2, r_3, \\ldots, r_n$。", "outputFormat": "仅一行一个整数，为所求的答案对 $998244353$ 取模后的结果。", "hint": "样例解释：\n\n在样例 1 中，无论如何摆放兵营，生产范围都不会交叉，所以答案即为 $A_4^4 = 24$。\n\n在样例 2 中，虽然生产范围可以出界，但是兵营的可选位置还是只有 $4$ 种，答案仍是 $A_4^4 = 24$。\n\n--------\n\n对于所有数据：\n- $1 \\le N, M \\le 10^6$；\n- $1 \\le r_i \\le 1000$。\n\n-----------\n\n**本题采用捆绑测试。**\n\n| No. | Constraints                           | $\\rm type$ | Score |\n| ----------- | ------------------------------------- | ---------- | ----- |\n| $1$         | $N = 2;\\ M \\le 1000;\\ r_i = 1$          | $0$        | $10$  |\n| $2$         | $N = 2;\\ M \\le 10^6;\\ r_i = 1$          | $0$        | $10$  |\n| $3$         | $N \\le 40;\\ M \\le 10^6;\\ r_i = 1$ | $0$        | $10$  |\n| $4$         | No further constraints                | $0$        | $30$  |\n| $5$         | $N, r_i \\le 40$                 | $1$        | $20$  |\n| $6$         | No further constraints                | $1$        | $20$  |\n\n------\n\n- Idea: Polaris_Dane\n- Solution: Polaris_Dane\n- Code: Polaris_Dane\n- Data: Polaris_Dane", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「HMOI R1」50 块好兄弟", "background": "Polaris_Dane 非常菜，他不仅沉迷于计数，而且喜欢玩星际争霸 2。", "description": "「我的好兄弟无穷无尽，而你的虫子每时每刻都在消亡」\n\n作为新上任爱民如子的指挥官，Polaris_Dane 充分领悟了雷诺指挥官的智慧，决定将此战术贯彻到底。\n\n有 $N$ 个兵营，依次编号为 $1,2,3\\cdots N$。现在需要把它们排列在一条数轴中位于 $[1,M]$ 间的整点处。每一个兵营都有一个生产范围 $r_i$，若兵营放在点 $x\\ (1 \\le x \\le M)$ 处，那么它会在区间 $[x - r_i + 1, x + r_i - 1]$ 生产好兄弟。\n\n当 $\\rm type = 0$ 时，生产好兄弟的范围必须被区间 $[1,M]$ 完全包含；当 $\\rm type = 1$ 时，生产好兄弟的范围可以落在 $[1,M]$ 之外，但是兵营必须放在 $[1,M]$ 内。\n\nPolaris_Dane 不能让好兄弟们太挤了，所以任何两个兵营的生产范围 **都不能相交**，他想知道有多少种方案满足该条件。\n\n若两个方案中存在一个编号为 $i$ 的兵营，其在两个方案中的放置位置不同，则称这两个方案不同。\n\n由于答案可能很大，所以 Polaris_Dane 想请你输出答案对 $998244353$ 取模后的结果。", "inputFormat": "第一行三个整数 $N, M, \\mathrm{type}$，其中 $\\rm type \\in \\{0, 1\\}$。\n\n第二行 $N$ 个整数 $r_1, r_2, r_3, \\ldots, r_n$。", "outputFormat": "仅一行一个整数，为所求的答案对 $998244353$ 取模后的结果。", "hint": "样例解释：\n\n在样例 1 中，无论如何摆放兵营，生产范围都不会交叉，所以答案即为 $A_4^4 = 24$。\n\n在样例 2 中，虽然生产范围可以出界，但是兵营的可选位置还是只有 $4$ 种，答案仍是 $A_4^4 = 24$。\n\n--------\n\n对于所有数据：\n- $1 \\le N, M \\le 10^6$；\n- $1 \\le r_i \\le 1000$。\n\n-----------\n\n**本题采用捆绑测试。**\n\n| No. | Constraints                           | $\\rm type$ | Score |\n| ----------- | ------------------------------------- | ---------- | ----- |\n| $1$         | $N = 2;\\ M \\le 1000;\\ r_i = 1$          | $0$        | $10$  |\n| $2$         | $N = 2;\\ M \\le 10^6;\\ r_i = 1$          | $0$        | $10$  |\n| $3$         | $N \\le 40;\\ M \\le 10^6;\\ r_i = 1$ | $0$        | $10$  |\n| $4$         | No further constraints                | $0$        | $30$  |\n| $5$         | $N, r_i \\le 40$                 | $1$        | $20$  |\n| $6$         | No further constraints                | $1$        | $20$  |\n\n------\n\n- Idea: Polaris_Dane\n- Solution: Polaris_Dane\n- Code: Polaris_Dane\n- Data: Polaris_Dane", "locale": "zh-CN"}}}
{"pid": "P7502", "type": "P", "difficulty": 5, "samples": [["6\n3 1 2\n1 3 2\n1 4 5\n3 6 2\n2 3 2\n3 6 2\n", "0\n1\n0\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["O2优化", "字典树 Trie"], "title": "「HMOI R1」不知道是啥的垃圾题", "background": "由于这是崩坏 3 round，所以这里应该有一个关于崩坏三的背景。然而 fz 不玩崩坏 3，而且他实在是太屑了，所以这题就变成了一道裸题。", "description": "要求维护一个可重集，支持三种操作：\n1. 插入一个自然数对；\n1. 删除一个自然数对，保证这个数对之前在集合中；\n1. 给定一个自然数对 $(x,y)$，问集合中有多少个数对 $(a,b)$ 满足 $x\\operatorname{xor}a>y\\operatorname{xor}b$，其中 $\\operatorname{xor}$ 表示按位异或运算。\n\n本题中所有“数对”均指有序数对。", "inputFormat": "第一行一个自然数 $M$ 代表操作数。\n\n接下来 $M$ 行，每行一个操作，格式如下：\n- `1 x y` 表示插入自然数对 $(x,y)$；\n- `2 x y` 表示删除自然数对 $(x,y)$，保证此时 $(x,y)$ 在集合中至少出现了一次；\n- `3 x y` 表示查询自然数对 $(x,y)$。", "outputFormat": "共 $M$ 行，每个询问输出一行一个自然数，表示询问的答案。", "hint": "对于样例，第一次查询时集合里没有任何数对，所以答案为 $0$。\n\n第二次查询时，集合为 $\\{(3,2),(4,5)\\}$，$6\\operatorname{xor}3=5>0=2\\operatorname{xor}2$，$6\\operatorname{xor}4=2<7=2\\operatorname{xor}5$，故满足条件的数对只有 $(3,2)$ 一个，答案为 $1$。\n\n第三次询问时，集合为 $\\{(4,5)\\}$，没有满足条件的数对，答案为 $0$。\n\n------------\n对于所有数据：\n- $0 \\le M \\le 2 \\times 10^5$；\n- $0 \\le x, y \\le 10^{18}$。\n\n--------\n\n**本题采用捆绑测试。**\n\n| No.  | Constraints                 | Score |\n| ---- | --------------------------- | ----- |\n| $1$  | $M \\le 2000$ | $10$  |\n| $2$  | $x, y < 8$          | $20$  |\n| $3$  | $x, y \\le M$          | $30$  |\n| $4$  | No further constraints      | $40$  |\n\n-------\n\n- Idea: FZzzz\n- Solution: FZzzz\n- Code: FZzzz\n- Data: FZzzz", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「HMOI R1」不知道是啥的垃圾题", "background": "由于这是崩坏 3 round，所以这里应该有一个关于崩坏三的背景。然而 fz 不玩崩坏 3，而且他实在是太屑了，所以这题就变成了一道裸题。", "description": "要求维护一个可重集，支持三种操作：\n1. 插入一个自然数对；\n1. 删除一个自然数对，保证这个数对之前在集合中；\n1. 给定一个自然数对 $(x,y)$，问集合中有多少个数对 $(a,b)$ 满足 $x\\operatorname{xor}a>y\\operatorname{xor}b$，其中 $\\operatorname{xor}$ 表示按位异或运算。\n\n本题中所有“数对”均指有序数对。", "inputFormat": "第一行一个自然数 $M$ 代表操作数。\n\n接下来 $M$ 行，每行一个操作，格式如下：\n- `1 x y` 表示插入自然数对 $(x,y)$；\n- `2 x y` 表示删除自然数对 $(x,y)$，保证此时 $(x,y)$ 在集合中至少出现了一次；\n- `3 x y` 表示查询自然数对 $(x,y)$。", "outputFormat": "共 $M$ 行，每个询问输出一行一个自然数，表示询问的答案。", "hint": "对于样例，第一次查询时集合里没有任何数对，所以答案为 $0$。\n\n第二次查询时，集合为 $\\{(3,2),(4,5)\\}$，$6\\operatorname{xor}3=5>0=2\\operatorname{xor}2$，$6\\operatorname{xor}4=2<7=2\\operatorname{xor}5$，故满足条件的数对只有 $(3,2)$ 一个，答案为 $1$。\n\n第三次询问时，集合为 $\\{(4,5)\\}$，没有满足条件的数对，答案为 $0$。\n\n------------\n对于所有数据：\n- $0 \\le M \\le 2 \\times 10^5$；\n- $0 \\le x, y \\le 10^{18}$。\n\n--------\n\n**本题采用捆绑测试。**\n\n| No.  | Constraints                 | Score |\n| ---- | --------------------------- | ----- |\n| $1$  | $M \\le 2000$ | $10$  |\n| $2$  | $x, y < 8$          | $20$  |\n| $3$  | $x, y \\le M$          | $30$  |\n| $4$  | No further constraints      | $40$  |\n\n-------\n\n- Idea: FZzzz\n- Solution: FZzzz\n- Code: FZzzz\n- Data: FZzzz", "locale": "zh-CN"}}}
{"pid": "P7503", "type": "P", "difficulty": 5, "samples": [["6\n1 1 4 5 1 4\n1 1\n4 5\n1 4\n1 5\n1 1\n4 4\n", "6\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": [], "title": "「HMOI R1」文化课", "background": "有一群人在参加 CPS0202。由于作弊可以使得省队名额减一，所以他们准备作弊祸害他人，然后高考考全省第二。\n\n但是由于他们非常菜，高考考不到全省第二，所以他们需要你来指导他们作弊。\n\nfz 编不下去了，恳请 PD 帮他写个崩 3 的背景。", "description": "$n$ 个人正在会考。由于他们假装自己退役了，所以下午的 CPS0202 跟他们没啥关系。\n\n目前第 $i$ 个人有一个得分 $a_i$，想要及格需要拿到 $l_i$ 分。而为了不被老师怀疑，他的分数不能超过 $r_i$。\n\n你可以组织若干场作弊。这些作弊是同时进行的，所以不能有人同时参加两场或以上的作弊。每场作弊在连续的一段考生中进行，他们的分数都变为他们中分数最高的人的分数。\n\n求最多能使多少人及格且不被怀疑。", "inputFormat": "第一行一个整数 $n$，表示有 $n$ 个人。\n\n第二行 $n$ 个用空格隔开的整数，第 $i$ 个数 $a_i$ 代表第 $i$ 个人的初始得分。\n\n接下来 $n$ 行每行两个整数，第 $i$ 行的数为 $l_i$ 和 $r_i$，意义见题目描述。", "outputFormat": "一行一个整数，代表最多能使多少人及格且不被老师怀疑。", "hint": "在 $[2,3]$ 组织一场作弊，可以使所有人满足条件。\n\n本题采用捆绑测试。\n- Subtask 1（$5$ 分）：$n\\le5$；\n- Subtask 2（$5$ 分）：$n\\le100$；\n- Subtask 3（$10$ 分）：$n\\le8\\times10^3$；\n- Subtask 4（$30$ 分）：$l_i=r_i$；\n- Subtask 5（$20$ 分）：$a_i\\le a_{i+1}$；\n- Subtask 6（$30$ 分）：无特殊性质。\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^5$，$1\\le a_i\\le n$，$1\\le l_i\\le r_i\\le n$。\n\n-------\n\n- Idea: FZzzz\n- Solution: FZzzz\n- Code: FZzzz\n- Data: FZzzz", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「HMOI R1」文化课", "background": "有一群人在参加 CPS0202。由于作弊可以使得省队名额减一，所以他们准备作弊祸害他人，然后高考考全省第二。\n\n但是由于他们非常菜，高考考不到全省第二，所以他们需要你来指导他们作弊。\n\nfz 编不下去了，恳请 PD 帮他写个崩 3 的背景。", "description": "$n$ 个人正在会考。由于他们假装自己退役了，所以下午的 CPS0202 跟他们没啥关系。\n\n目前第 $i$ 个人有一个得分 $a_i$，想要及格需要拿到 $l_i$ 分。而为了不被老师怀疑，他的分数不能超过 $r_i$。\n\n你可以组织若干场作弊。这些作弊是同时进行的，所以不能有人同时参加两场或以上的作弊。每场作弊在连续的一段考生中进行，他们的分数都变为他们中分数最高的人的分数。\n\n求最多能使多少人及格且不被怀疑。", "inputFormat": "第一行一个整数 $n$，表示有 $n$ 个人。\n\n第二行 $n$ 个用空格隔开的整数，第 $i$ 个数 $a_i$ 代表第 $i$ 个人的初始得分。\n\n接下来 $n$ 行每行两个整数，第 $i$ 行的数为 $l_i$ 和 $r_i$，意义见题目描述。", "outputFormat": "一行一个整数，代表最多能使多少人及格且不被老师怀疑。", "hint": "在 $[2,3]$ 组织一场作弊，可以使所有人满足条件。\n\n本题采用捆绑测试。\n- Subtask 1（$5$ 分）：$n\\le5$；\n- Subtask 2（$5$ 分）：$n\\le100$；\n- Subtask 3（$10$ 分）：$n\\le8\\times10^3$；\n- Subtask 4（$30$ 分）：$l_i=r_i$；\n- Subtask 5（$20$ 分）：$a_i\\le a_{i+1}$；\n- Subtask 6（$30$ 分）：无特殊性质。\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^5$，$1\\le a_i\\le n$，$1\\le l_i\\le r_i\\le n$。\n\n-------\n\n- Idea: FZzzz\n- Solution: FZzzz\n- Code: FZzzz\n- Data: FZzzz", "locale": "zh-CN"}}}
{"pid": "P7504", "type": "P", "difficulty": 6, "samples": [["2 2 2", "1"], ["4 2 2", "16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["O2优化"], "title": "「HMOI R1」可爱的德丽莎", "background": "Polaris_Dane 非常菜，他不仅沉迷于数论，而且喜欢玩崩坏 3。", "description": "可爱的德丽莎希望你能帮她求出\n\n$$\n\\sum_{x = 1}^n\\sum_{y = 1}^n\\sum_{i = 1}^x[x \\bot k_1][i \\bot x]\\cdot i\\cdot \\sum_{j = 1}^y[y \\bot k_2][j \\bot y]\\cdot j\n$$\n的结果。\n\n其中 $[x \\bot y] = \\begin{cases}1 & \\operatorname{gcd}(x,y)=1 \\\\ 0 & \\operatorname{gcd}(x,y)\\neq 1\\end{cases}$\n\n德丽莎这么可爱，你怎么能不答应她呢？\n\n由于答案可能很大，所以德丽莎只想知道它对 $998244353$ 取模后的结果。", "inputFormat": "共一行三个整数 $n, k_1, k_2$。", "outputFormat": "仅一行一个数，为所求的答案对 $998244353$ 取模后的结果。", "hint": "**本题测试点编号倒序排列。**\n\n对于所有数据：\n- $1 \\le n, k_1, k_2 \\le 2 \\times 10^9$。\n\n---------\n\n**本题采用捆绑测试。**\n\n| No. | Constraints                   | Score |\n| ----------- | ----------------------------- | ----- |\n| $1$         | $1\\le n,k_1,k_2\\le 100$         | $10$  |\n| $2$         | $1\\le n,k_1,k_2\\le 3000$ | $20$  |\n| $3$         | $1\\le n,k_1,k_2\\le 5\\times 10^5$ | $20$  |\n| $4$         | No further constraints        | $50$  |\n\n---------------\n\n- Idea: Polaris_Dane\n- Solution: Polaris_Dane\n- Code: Polaris_Dane\n- Data: Polaris_Dane", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「HMOI R1」可爱的德丽莎", "background": "Polaris_Dane 非常菜，他不仅沉迷于数论，而且喜欢玩崩坏 3。", "description": "可爱的德丽莎希望你能帮她求出\n\n$$\n\\sum_{x = 1}^n\\sum_{y = 1}^n\\sum_{i = 1}^x[x \\bot k_1][i \\bot x]\\cdot i\\cdot \\sum_{j = 1}^y[y \\bot k_2][j \\bot y]\\cdot j\n$$\n的结果。\n\n其中 $[x \\bot y] = \\begin{cases}1 & \\operatorname{gcd}(x,y)=1 \\\\ 0 & \\operatorname{gcd}(x,y)\\neq 1\\end{cases}$\n\n德丽莎这么可爱，你怎么能不答应她呢？\n\n由于答案可能很大，所以德丽莎只想知道它对 $998244353$ 取模后的结果。", "inputFormat": "共一行三个整数 $n, k_1, k_2$。", "outputFormat": "仅一行一个数，为所求的答案对 $998244353$ 取模后的结果。", "hint": "**本题测试点编号倒序排列。**\n\n对于所有数据：\n- $1 \\le n, k_1, k_2 \\le 2 \\times 10^9$。\n\n---------\n\n**本题采用捆绑测试。**\n\n| No. | Constraints                   | Score |\n| ----------- | ----------------------------- | ----- |\n| $1$         | $1\\le n,k_1,k_2\\le 100$         | $10$  |\n| $2$         | $1\\le n,k_1,k_2\\le 3000$ | $20$  |\n| $3$         | $1\\le n,k_1,k_2\\le 5\\times 10^5$ | $20$  |\n| $4$         | No further constraints        | $50$  |\n\n---------------\n\n- Idea: Polaris_Dane\n- Solution: Polaris_Dane\n- Code: Polaris_Dane\n- Data: Polaris_Dane", "locale": "zh-CN"}}}
{"pid": "P7505", "type": "P", "difficulty": 2, "samples": [["3 4 3\n-1 1 2\n2 3\n3\n1 5\n3", "2\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["模拟", "2021", "洛谷原创", "排序", "队列"], "title": "「Wdsr-2.5」小小的埴轮兵团", "background": "杖刀偶磨弓是埴轮兵团的首长。\n\n作为埴轮兵长，训练埴轮兵团是很平常的事情。", "description": "磨弓下达命令让埴轮们站成一行。不妨认为它们站在了一个数轴上，每个埴轮的位置就是它脚下数轴的数字。磨弓会告诉你，第 $i$ 个埴轮的位置为 $a_i$ 。**不保证** $\\bm {a_i}$ **升序**。\n\n数轴的长度是有限制的，具体的范围是 $[-k,k]$ 。也就是说，如果某个埴轮移出了这个范围，它就脱离了这个队列了，并且不会再次回到队列当中。\n\n为了训练埴轮，磨弓给埴轮们下达了 $m$ 个指令，有以下 3 种：\n\n- 指令 1：**全体埴轮**向数轴的正方向移动 $x$ 个单位长度。\n- 指令 2：**全体埴轮**往数轴的反方向移动 $x$ 个单位长度。\n- 指令 3：依次报数，统计目前队列里一共有多少个埴轮。\n\n但是磨弓发现，埴轮兵团的大小实在是太大了，以至于执行这些操作变得非常缓慢。尽管如此，磨弓仍然希望你告诉她所有指令 3 的结果。", "inputFormat": "第一行共有 $3$ 个整数 $n, m, k$，含义如题面所示。\n\n第二行共有 $n$ 个整数 $a_1, a_2, \\cdots, a_n$，表示每个埴轮的位置。\n\n接下来 $m$ 行，有 $1$ 或者 $2$ 个正整数，描述一条指令。首先是一个整数 $\\operatorname{op}$，表示这条指令的类型。如果 $1 \\leq \\operatorname{op} \\leq 2$，接下来还会输入一个整数 $x$。", "outputFormat": "对于每条指令 3 ，输出一个整数，表示目前还在队列中的埴轮的数目。", "hint": "#### 样例 1 说明\n\n一共有三个埴轮。初始时，它们的站位分别是 $[-1,1,2]$ 。\n\n- 第一次操作后，所有埴轮向左移动 $3$ 格，位置变成了  $[\\underline{\\bm{-4}},-2,-1]$ 。第一个埴轮被移出了数轴。\n- 第二次操作后，输出当前的埴轮数目，为 $2$ 个。\n- 第三次操作后，所有埴轮向右移动 $5$ 格，位置变成了 $[3,\\underline{\\bm4}]$ ，第二个埴轮被移出了数轴。\n- 第四次操作后，输出当前的埴轮数目，为 $1$ 个。\n\n#### 样例 2, 3\n\n见下发附件。\n\n#### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，$1 \\leq n, m \\leq 5\\times 10^3$；\n- 对于另外 $20\\%$ 的数据，$1\\le k\\le 500$；\n- 对于 $100\\%$ 的数据，$1 \\leq n, m \\leq 3\\times 10^5$，$1 \\leq k, x \\leq 2 \\times 10^9$，$-k \\le a_i \\le k$ 。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdsr-2.5」小小的埴轮兵团", "background": "杖刀偶磨弓是埴轮兵团的首长。\n\n作为埴轮兵长，训练埴轮兵团是很平常的事情。", "description": "磨弓下达命令让埴轮们站成一行。不妨认为它们站在了一个数轴上，每个埴轮的位置就是它脚下数轴的数字。磨弓会告诉你，第 $i$ 个埴轮的位置为 $a_i$ 。**不保证** $\\bm {a_i}$ **升序**。\n\n数轴的长度是有限制的，具体的范围是 $[-k,k]$ 。也就是说，如果某个埴轮移出了这个范围，它就脱离了这个队列了，并且不会再次回到队列当中。\n\n为了训练埴轮，磨弓给埴轮们下达了 $m$ 个指令，有以下 3 种：\n\n- 指令 1：**全体埴轮**向数轴的正方向移动 $x$ 个单位长度。\n- 指令 2：**全体埴轮**往数轴的反方向移动 $x$ 个单位长度。\n- 指令 3：依次报数，统计目前队列里一共有多少个埴轮。\n\n但是磨弓发现，埴轮兵团的大小实在是太大了，以至于执行这些操作变得非常缓慢。尽管如此，磨弓仍然希望你告诉她所有指令 3 的结果。", "inputFormat": "第一行共有 $3$ 个整数 $n, m, k$，含义如题面所示。\n\n第二行共有 $n$ 个整数 $a_1, a_2, \\cdots, a_n$，表示每个埴轮的位置。\n\n接下来 $m$ 行，有 $1$ 或者 $2$ 个正整数，描述一条指令。首先是一个整数 $\\operatorname{op}$，表示这条指令的类型。如果 $1 \\leq \\operatorname{op} \\leq 2$，接下来还会输入一个整数 $x$。", "outputFormat": "对于每条指令 3 ，输出一个整数，表示目前还在队列中的埴轮的数目。", "hint": "#### 样例 1 说明\n\n一共有三个埴轮。初始时，它们的站位分别是 $[-1,1,2]$ 。\n\n- 第一次操作后，所有埴轮向左移动 $3$ 格，位置变成了  $[\\underline{\\bm{-4}},-2,-1]$ 。第一个埴轮被移出了数轴。\n- 第二次操作后，输出当前的埴轮数目，为 $2$ 个。\n- 第三次操作后，所有埴轮向右移动 $5$ 格，位置变成了 $[3,\\underline{\\bm4}]$ ，第二个埴轮被移出了数轴。\n- 第四次操作后，输出当前的埴轮数目，为 $1$ 个。\n\n#### 样例 2, 3\n\n见下发附件。\n\n#### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，$1 \\leq n, m \\leq 5\\times 10^3$；\n- 对于另外 $20\\%$ 的数据，$1\\le k\\le 500$；\n- 对于 $100\\%$ 的数据，$1 \\leq n, m \\leq 3\\times 10^5$，$1 \\leq k, x \\leq 2 \\times 10^9$，$-k \\le a_i \\le k$ 。", "locale": "zh-CN"}}}
{"pid": "P7506", "type": "P", "difficulty": 6, "samples": [["2 1 10\nJoesSR B9 A99 PASS\nCirno C2 D2 A49\nE49 DOUBLE PASS A19 A49 A99 A99 A99 A99 A99  ", "Round 1:\nJoesSR used A99,now p=99.\nCirno used D2,now p=49.\nJoesSR used E49,now p=49.\nCirno used C2,now p=98.\nJoesSR used B9,now p=89.\nCirno used DOUBLE,now p=89.\nJoesSR used PASS,now p=89.\nCirno lost the game."], ["3 2 25\nCirno A9 A19 B1\nReimu TURN A9 C2\nMarisa DOUBLE D2 D2\nA9 B9 C2 PASS PASS A9 A1 A99 A99 A99 A99 A99 A99 A99 A99 A99 A99 A99 A99 A99 A99 A99 A99 A99 A99\n", "Round 1:\nCirno used A19,now p=19.\nReimu used C2,now p=38.\nMarisa used D2,now p=19.\nCirno used A9,now p=28.\nReimu used A9,now p=37.\nMarisa used C2,now p=74.\nCirno used A9,now p=83.\nReimu used B9,now p=74.\nMarisa used A9,now p=83.\nCirno used A1,now p=84.\nReimu used PASS,now p=84.\nMarisa used D2,now p=42.\nCirno used B1,now p=41.\nReimu used TURN,now p=41.\nCirno used PASS,now p=41.\nMarisa used DOUBLE,now p=41.\nReimu lost the game.\nRound 2:\nReimu used A99,now p=99.\nMarisa lost the game.\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["模拟", "2021", "洛谷原创"], "title": "「Wdsr-2.5」琪露诺的算数游戏", "background": "", "description": "#### 游戏概况\n\n《琪露诺的算数游戏》（诨名“⑨牌”），是一款轻松快乐的多玩家卡牌回合制游戏。\n\n**注意：这里的规则与市面上的⑨牌规则不尽相同**。由于⑨牌种类太多不大容易处理，所以这里的规则更类似于 $\\text{NEU}$ 游戏。\n\n游戏中有 $n$ 名玩家，围成一圈。一共会进行 $m$ 轮。每个玩家初始时有 $3$ 张手牌。游戏有一个 $k$ 张牌的牌堆。在本题中，你可以认为**不会出现牌堆抽完的情况**（真的）。此外，根据该题给出的规则，你不需要考虑选手手牌的顺序。\n\n为了简述游戏规则，你可以认为每一轮游戏中有一个整型变量（类似于 $\\text{int}$ 类型寄存器） $p$ 。玩家打出的牌本质上是对 $p$ 进行操作。\n\n**注**：请注意下文中“局”、“轮”、“回合”的关系。本题你只会进行一局游戏，每局有 $m$ 轮，每一轮会有若干回合，每一回合会有一名玩家出牌。\n\n每一轮开始时，$p$ 会被初始化为 $0$ ，然后从初始玩家开始，按照**顺时针顺序**（$1,2,3,\\cdots n-1,n,1,2,\\cdots$ ，逆时针同理），依次出牌。如果这是第一轮，那么初始玩家就是 $1$ 号玩家。当某个玩家出完某张牌后，如果此时 $p> 99$ ，视作该玩家成为该局的**失败者**；否则她就会**立刻从牌堆顶部取出一张牌**并进入到下一回合。失败者会丢失手上其余的两张牌，并从牌堆顶部依次摸三张牌放入自己的手牌中。同时，失败者会成为**下一轮初始玩家**。在一局游戏当中，牌堆里的牌只减不增。被使用的牌不会回到牌堆当中。\n\n下面介绍该魔改版游戏的牌型。\n\n#### 基本牌\n\n基本牌可以分为五类：加法牌、减法牌、乘法牌、除法牌、固定牌。\n\n- 加法牌，一共有 $7$ 种： $A_{1},A_{2},A_{5},A_{9},A_{19},A_{49},A_{99}$ 。其中， $A_x$ 的作用效果是，使 $p$ 加上牌面上的数字。即 $p\\gets p+x$ 。  \n- 减法牌，一共有 $3$ 种： $B_{1},B_{9},B_{19}$ 。作用效果与加法牌类似，只不过会使 $p$ 减去牌面上的数字。  \n- 乘法牌，一共只有 $1$ 种： $C_2$ 。它的作用效果是令 $p$ 乘上对应的数字，即 $p\\gets p\\times x$ 。  \n- 除法牌，同样只有 $1$ 种： $D_2$ 。会令 $p$ 除以对应的数字，**向下取整**。即 $p\\gets \\lfloor p\\div x\\rfloor$ 。  \n- 固定牌，一共有 $3$ 种： $E_{0},E_{49},E_{99}$ ，会将 $p$ 直接设置为牌面上的数字。\n\n#### 解牌\n\n解牌是可以使一名玩家跳过该回合，并附加一些特殊效果的一类牌。\n\n- $\\tt{PASS}$ ，跳过你，转到下一个玩家。\n- $\\tt{TURN}$ ，跳过你，出牌顺序反转（顺时针变为逆时针，逆时针变为顺时针。在下一轮游戏开始时会重置为顺时针）。\n- $\\tt{DOUBLE}$ ，跳过你，然后给下一名玩家施加 $\\verb!\"DOUBLE\"!$ 效果，也即要出两张牌（先打一摸一，再打一摸一，需要保持全程总数不超过 $99$ 才能保证不失败）。\n\n$\\tt{DOUBLE}$ 效果的一些说明：如果你被施加了 $\\tt{DOUBLE}$ 的效果，但是你第一张出了解牌（三种解牌都可以），那么你就会立即解除 $\\tt{DOUBLE}$ 效果，跳过这一回合，**并且将效果转移到下一名玩家**。 $\\tt{DOUBLE}$ 效果不能叠加。\n\n--- \n\n在输入文件中，卡牌名会形如 $\\colorbox{#f0f0f0}\\verb!A1 A99 D2 PASS DOUBLE!$ 等等。\n\n#### 策略\n\n这一部分将会讲述本题中所有玩家的运行逻辑。\n\n如果无论怎么出都会失败，那么玩家就会随便打出一张牌并成为失败者（显然，打出哪张牌不会对游戏结局产生实质上的影响）。否则会有两种情形：\n\n1. 如果此时没有被施加 $\\tt{DOUBLE}$ 效果：\n   - 每名玩家会优先考虑普通牌，并且选择在不成为失败者的前提下使 $p$ 变得**尽可能大**的那种方案（如果有多种方案可以使得 $p$ 最大，那就会按照**乘法牌、加法牌、减法牌、除法牌、固定牌**的顺序优先选择。显然，同一类普通牌中的不同种类的牌不会使 $p$ 产生相同的值）。\n   - 如果没有普通牌，或者出牌后会成为失败者，那么就考虑使用解牌。玩家会依次考虑手头是否有 $\\tt{PASS,TURN,DOUBLE}$ 牌。如果有，就打出这张牌。\n2. 如果被施加了 $\\tt{DOUBLE}$ 效果：\n   - 优先考虑使用解牌。依次考虑$\\tt{PASS,TURN,DOUBLE}$ 。如果有，就打出这张牌。\n   - 否则，选择在不成为失败者的前提下使 $p$ 变得**尽可能小**的那种方案（如果有多种方案可以使得 $p$ 最小，那就会按照**除法牌、减法牌、加法牌、乘法牌、固定牌**的顺序优先选择）。此时玩家会被解除 $\\tt{DOUBLE}$ 状态，于是她会按照情形 $1$ 来决策。", "inputFormat": "第一行三个正整数 $n,m,k$ ，含义如题面所示。\n\n接下来 $n$ 行，每行四个字符串 $name,card_1,card_2,card_3$ ，表示这名玩家的名称以及她的三张手牌。玩家名称仅由大小写英文字母组成，不包含空格，长度不超过 $20$ 。\n\n接下来一行， $k$ 个字符串，按照从上至下的顺序描述牌堆里的牌。\n\n详情可以参考输入样例。", "outputFormat": "当新的一轮开始时，你需要输出： $\\colorbox{f0f0f0}\\verb!Round XXX:!$ （其中，$\\verb!XXX!$ 表示这是第多少轮）。\n\n每名玩家出牌时，如果她不是失败者，你需要输出： $\\colorbox{f0f0f0}\\verb!XXX used YYY,now p=ZZZ.!$ （其中，$\\verb!XXX!$ 是玩家名； $\\verb!YYY!$ 是卡牌名； $\\verb!ZZZ!$ 是当前 $p$ 的值）。\n\n否则，当一名玩家成为失败者时，该轮结束。你要输出：$\\colorbox{f0f0f0}\\verb!XXX lost the game.!$ （其中，$\\verb!XXX!$ 是玩家名）。\n\n详情可以参考输出样例。", "hint": "#### 样例 1 说明\n\n牌的使用情况都在输出样例中。这里仅说明每出一张牌后每名玩家当前手牌的情况。具体为什么要使用某张牌，可以参考题目描述。\n\n$$\n\\def\\c#1{\\texttt{#1}}\n\\def\\arraystretch{1.5}\n\\begin{matrix}\n\\begin{gathered}\n\\textbf{\\textsf{初始}}\\cr\n\\begin{array}{|c|c|c|c|} \\hline\n\\textbf{玩家名} & \\textbf{手牌 1} & \\textbf{手牌 2}  & \\textbf{手牌 3} \\cr\\hline\n\\text{JoesSR} & \\c{B9} & \\c{A99} & \\c{PASS} \\cr\\hline\n\\text{Cirno} & \\c{C2} & \\c{D2} & \\c{A49} \\cr\\hline\n\\end{array}\\cr\n\\textbf{\\textsf{第一回合}}\\quad (p: 0\\to 99)\\cr\n\\begin{array}{|c|c|c|c|} \\hline\n\\textbf{玩家名} & \\textbf{手牌 1} & \\textbf{手牌 2}  & \\textbf{手牌 3} \\cr\\hline\n\\text{JoesSR} & \\c{B9} & \\c{E49} & \\c{PASS} \\cr\\hline\n\\text{Cirno} & \\c{C2} & \\c{D2} & \\c{A49} \\cr\\hline\n\\end{array}\\cr\n\\textbf{\\textsf{第二回合}}\\quad (p:99\\to 49)\\cr\n\\begin{array}{|c|c|c|c|} \\hline\n\\textbf{玩家名} & \\textbf{手牌 1} & \\textbf{手牌 2}  & \\textbf{手牌 3} \\cr\\hline\n\\text{JoesSR} & \\c{B9} & \\c{E49} & \\c{PASS} \\cr\\hline\n\\text{Cirno} & \\c{C2} & \\c{DOUBLE} & \\c{A49} \\cr\\hline\n\\end{array}\\cr\n\\textbf{\\textsf{第三回合}}\\quad (p:49\\to 49)\\cr\n\\begin{array}{|c|c|c|c|} \\hline\n\\textbf{玩家名} & \\textbf{手牌 1} & \\textbf{手牌 2}  & \\textbf{手牌 3} \\cr\\hline\n\\text{JoesSR} & \\c{B9} & \\c{PASS} & \\c{PASS} \\cr\\hline\n\\text{Cirno} & \\c{C2} & \\c{DOUBLE} & \\c{A49} \\cr\\hline\n\\end{array}\\cr\n\\end{gathered}\n&\n\\begin{gathered}\n\\textbf{\\textsf{第四回合}}\\quad (p:49\\to 98)\\cr\n\\begin{array}{|c|c|c|c|} \\hline\n\\textbf{玩家名} & \\textbf{手牌 1} & \\textbf{手牌 2}  & \\textbf{手牌 3} \\cr\\hline\n\\text{JoesSR} & \\c{B9} & \\c{PASS} & \\c{PASS} \\cr\\hline\n\\text{Cirno} & \\c{A19} & \\c{DOUBLE} & \\c{A49} \\cr\\hline\n\\end{array}\\cr\n\\textbf{\\textsf{第五回合}}\\quad (p:98\\to 89)\\cr\n\\begin{array}{|c|c|c|c|} \\hline\n\\textbf{玩家名} & \\textbf{手牌 1} & \\textbf{手牌 2}  & \\textbf{手牌 3} \\cr\\hline\n\\text{JoesSR} & \\c{A49} & \\c{PASS} & \\c{PASS} \\cr\\hline\n\\text{Cirno} & \\c{A19} & \\c{DOUBLE} & \\c{A49} \\cr\\hline\n\\end{array}\\cr\n\\textbf{\\textsf{第六回合}}\\quad (p:89\\to 89)\\cr\n\\begin{array}{|c|c|c|c|} \\hline\n\\textbf{玩家名} & \\textbf{手牌 1} & \\textbf{手牌 2}  & \\textbf{手牌 3} \\cr\\hline\n\\text{JoesSR} & \\c{A49} & \\c{PASS} & \\c{PASS} \\cr\\hline\n\\text{Cirno} & \\c{A19} & \\c{A99} & \\c{A49} \\cr\\hline\n\\end{array}\\cr\n\\textbf{\\textsf{第七回合}}\\quad (p:89\\to 89)\\cr\n\\begin{array}{|c|c|c|c|} \\hline\n\\textbf{玩家名} & \\textbf{手牌 1} & \\textbf{手牌 2}  & \\textbf{手牌 3} \\cr\\hline\n\\text{JoesSR} & \\c{A49} & \\c{A99} & \\c{PASS} \\cr\\hline\n\\text{Cirno} & \\c{A19} & \\c{A99} & \\c{A49} \\cr\\hline\n\\end{array}\\cr\n\\end{gathered}\n\\end{matrix}\n$$\n\n**注**：初始回合以及第 $2,4,6$ 回合都是 $\\text{JoesSR}$ 出牌；第 $1,3,5,7$ 回合都是琪露诺出牌。值得注意的是，尽管第 $5$ 回合琪露诺使用了 $\\tt{DOUBLE}$ ，但因为下一回合被 $\\tt{PASS}$ 了，所以第 $7$ 回合仍然是琪露诺出牌。\n\n此时琪露诺无论如何都会失败，于是琪露诺成为了失败者。\n\n#### 样例 3\n\n见下发附件。\n\n#### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，仅包含普通牌，并且 $n\\le 3$ 。\n- 对于另外 $15\\%$ 的数据，不包含 $\\tt{TURN}$ 牌和 $\\tt{PASS}$ 牌。\n- 对于另外 $15\\%$ 的数据，不包含 $\\tt{DOUBLE}$ 牌。\n- 对于 $100\\%$ 的数据， 满足 $1\\le n\\le 30;1\\le m\\le 100;1\\le k\\le 3\\times 10^5$ 。保证任何时候 $|p|<10^4$ 。\n\n#### 参考资料\n\n[【东方桌游考古】NEU，“⑨牌”，与十年前的同人](https://www.bilibili.com/read/cv9951620)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdsr-2.5」琪露诺的算数游戏", "background": "", "description": "#### 游戏概况\n\n《琪露诺的算数游戏》（诨名“⑨牌”），是一款轻松快乐的多玩家卡牌回合制游戏。\n\n**注意：这里的规则与市面上的⑨牌规则不尽相同**。由于⑨牌种类太多不大容易处理，所以这里的规则更类似于 $\\text{NEU}$ 游戏。\n\n游戏中有 $n$ 名玩家，围成一圈。一共会进行 $m$ 轮。每个玩家初始时有 $3$ 张手牌。游戏有一个 $k$ 张牌的牌堆。在本题中，你可以认为**不会出现牌堆抽完的情况**（真的）。此外，根据该题给出的规则，你不需要考虑选手手牌的顺序。\n\n为了简述游戏规则，你可以认为每一轮游戏中有一个整型变量（类似于 $\\text{int}$ 类型寄存器） $p$ 。玩家打出的牌本质上是对 $p$ 进行操作。\n\n**注**：请注意下文中“局”、“轮”、“回合”的关系。本题你只会进行一局游戏，每局有 $m$ 轮，每一轮会有若干回合，每一回合会有一名玩家出牌。\n\n每一轮开始时，$p$ 会被初始化为 $0$ ，然后从初始玩家开始，按照**顺时针顺序**（$1,2,3,\\cdots n-1,n,1,2,\\cdots$ ，逆时针同理），依次出牌。如果这是第一轮，那么初始玩家就是 $1$ 号玩家。当某个玩家出完某张牌后，如果此时 $p> 99$ ，视作该玩家成为该局的**失败者**；否则她就会**立刻从牌堆顶部取出一张牌**并进入到下一回合。失败者会丢失手上其余的两张牌，并从牌堆顶部依次摸三张牌放入自己的手牌中。同时，失败者会成为**下一轮初始玩家**。在一局游戏当中，牌堆里的牌只减不增。被使用的牌不会回到牌堆当中。\n\n下面介绍该魔改版游戏的牌型。\n\n#### 基本牌\n\n基本牌可以分为五类：加法牌、减法牌、乘法牌、除法牌、固定牌。\n\n- 加法牌，一共有 $7$ 种： $A_{1},A_{2},A_{5},A_{9},A_{19},A_{49},A_{99}$ 。其中， $A_x$ 的作用效果是，使 $p$ 加上牌面上的数字。即 $p\\gets p+x$ 。  \n- 减法牌，一共有 $3$ 种： $B_{1},B_{9},B_{19}$ 。作用效果与加法牌类似，只不过会使 $p$ 减去牌面上的数字。  \n- 乘法牌，一共只有 $1$ 种： $C_2$ 。它的作用效果是令 $p$ 乘上对应的数字，即 $p\\gets p\\times x$ 。  \n- 除法牌，同样只有 $1$ 种： $D_2$ 。会令 $p$ 除以对应的数字，**向下取整**。即 $p\\gets \\lfloor p\\div x\\rfloor$ 。  \n- 固定牌，一共有 $3$ 种： $E_{0},E_{49},E_{99}$ ，会将 $p$ 直接设置为牌面上的数字。\n\n#### 解牌\n\n解牌是可以使一名玩家跳过该回合，并附加一些特殊效果的一类牌。\n\n- $\\tt{PASS}$ ，跳过你，转到下一个玩家。\n- $\\tt{TURN}$ ，跳过你，出牌顺序反转（顺时针变为逆时针，逆时针变为顺时针。在下一轮游戏开始时会重置为顺时针）。\n- $\\tt{DOUBLE}$ ，跳过你，然后给下一名玩家施加 $\\verb!\"DOUBLE\"!$ 效果，也即要出两张牌（先打一摸一，再打一摸一，需要保持全程总数不超过 $99$ 才能保证不失败）。\n\n$\\tt{DOUBLE}$ 效果的一些说明：如果你被施加了 $\\tt{DOUBLE}$ 的效果，但是你第一张出了解牌（三种解牌都可以），那么你就会立即解除 $\\tt{DOUBLE}$ 效果，跳过这一回合，**并且将效果转移到下一名玩家**。 $\\tt{DOUBLE}$ 效果不能叠加。\n\n--- \n\n在输入文件中，卡牌名会形如 $\\colorbox{#f0f0f0}\\verb!A1 A99 D2 PASS DOUBLE!$ 等等。\n\n#### 策略\n\n这一部分将会讲述本题中所有玩家的运行逻辑。\n\n如果无论怎么出都会失败，那么玩家就会随便打出一张牌并成为失败者（显然，打出哪张牌不会对游戏结局产生实质上的影响）。否则会有两种情形：\n\n1. 如果此时没有被施加 $\\tt{DOUBLE}$ 效果：\n   - 每名玩家会优先考虑普通牌，并且选择在不成为失败者的前提下使 $p$ 变得**尽可能大**的那种方案（如果有多种方案可以使得 $p$ 最大，那就会按照**乘法牌、加法牌、减法牌、除法牌、固定牌**的顺序优先选择。显然，同一类普通牌中的不同种类的牌不会使 $p$ 产生相同的值）。\n   - 如果没有普通牌，或者出牌后会成为失败者，那么就考虑使用解牌。玩家会依次考虑手头是否有 $\\tt{PASS,TURN,DOUBLE}$ 牌。如果有，就打出这张牌。\n2. 如果被施加了 $\\tt{DOUBLE}$ 效果：\n   - 优先考虑使用解牌。依次考虑$\\tt{PASS,TURN,DOUBLE}$ 。如果有，就打出这张牌。\n   - 否则，选择在不成为失败者的前提下使 $p$ 变得**尽可能小**的那种方案（如果有多种方案可以使得 $p$ 最小，那就会按照**除法牌、减法牌、加法牌、乘法牌、固定牌**的顺序优先选择）。此时玩家会被解除 $\\tt{DOUBLE}$ 状态，于是她会按照情形 $1$ 来决策。", "inputFormat": "第一行三个正整数 $n,m,k$ ，含义如题面所示。\n\n接下来 $n$ 行，每行四个字符串 $name,card_1,card_2,card_3$ ，表示这名玩家的名称以及她的三张手牌。玩家名称仅由大小写英文字母组成，不包含空格，长度不超过 $20$ 。\n\n接下来一行， $k$ 个字符串，按照从上至下的顺序描述牌堆里的牌。\n\n详情可以参考输入样例。", "outputFormat": "当新的一轮开始时，你需要输出： $\\colorbox{f0f0f0}\\verb!Round XXX:!$ （其中，$\\verb!XXX!$ 表示这是第多少轮）。\n\n每名玩家出牌时，如果她不是失败者，你需要输出： $\\colorbox{f0f0f0}\\verb!XXX used YYY,now p=ZZZ.!$ （其中，$\\verb!XXX!$ 是玩家名； $\\verb!YYY!$ 是卡牌名； $\\verb!ZZZ!$ 是当前 $p$ 的值）。\n\n否则，当一名玩家成为失败者时，该轮结束。你要输出：$\\colorbox{f0f0f0}\\verb!XXX lost the game.!$ （其中，$\\verb!XXX!$ 是玩家名）。\n\n详情可以参考输出样例。", "hint": "#### 样例 1 说明\n\n牌的使用情况都在输出样例中。这里仅说明每出一张牌后每名玩家当前手牌的情况。具体为什么要使用某张牌，可以参考题目描述。\n\n$$\n\\def\\c#1{\\texttt{#1}}\n\\def\\arraystretch{1.5}\n\\begin{matrix}\n\\begin{gathered}\n\\textbf{\\textsf{初始}}\\cr\n\\begin{array}{|c|c|c|c|} \\hline\n\\textbf{玩家名} & \\textbf{手牌 1} & \\textbf{手牌 2}  & \\textbf{手牌 3} \\cr\\hline\n\\text{JoesSR} & \\c{B9} & \\c{A99} & \\c{PASS} \\cr\\hline\n\\text{Cirno} & \\c{C2} & \\c{D2} & \\c{A49} \\cr\\hline\n\\end{array}\\cr\n\\textbf{\\textsf{第一回合}}\\quad (p: 0\\to 99)\\cr\n\\begin{array}{|c|c|c|c|} \\hline\n\\textbf{玩家名} & \\textbf{手牌 1} & \\textbf{手牌 2}  & \\textbf{手牌 3} \\cr\\hline\n\\text{JoesSR} & \\c{B9} & \\c{E49} & \\c{PASS} \\cr\\hline\n\\text{Cirno} & \\c{C2} & \\c{D2} & \\c{A49} \\cr\\hline\n\\end{array}\\cr\n\\textbf{\\textsf{第二回合}}\\quad (p:99\\to 49)\\cr\n\\begin{array}{|c|c|c|c|} \\hline\n\\textbf{玩家名} & \\textbf{手牌 1} & \\textbf{手牌 2}  & \\textbf{手牌 3} \\cr\\hline\n\\text{JoesSR} & \\c{B9} & \\c{E49} & \\c{PASS} \\cr\\hline\n\\text{Cirno} & \\c{C2} & \\c{DOUBLE} & \\c{A49} \\cr\\hline\n\\end{array}\\cr\n\\textbf{\\textsf{第三回合}}\\quad (p:49\\to 49)\\cr\n\\begin{array}{|c|c|c|c|} \\hline\n\\textbf{玩家名} & \\textbf{手牌 1} & \\textbf{手牌 2}  & \\textbf{手牌 3} \\cr\\hline\n\\text{JoesSR} & \\c{B9} & \\c{PASS} & \\c{PASS} \\cr\\hline\n\\text{Cirno} & \\c{C2} & \\c{DOUBLE} & \\c{A49} \\cr\\hline\n\\end{array}\\cr\n\\end{gathered}\n&\n\\begin{gathered}\n\\textbf{\\textsf{第四回合}}\\quad (p:49\\to 98)\\cr\n\\begin{array}{|c|c|c|c|} \\hline\n\\textbf{玩家名} & \\textbf{手牌 1} & \\textbf{手牌 2}  & \\textbf{手牌 3} \\cr\\hline\n\\text{JoesSR} & \\c{B9} & \\c{PASS} & \\c{PASS} \\cr\\hline\n\\text{Cirno} & \\c{A19} & \\c{DOUBLE} & \\c{A49} \\cr\\hline\n\\end{array}\\cr\n\\textbf{\\textsf{第五回合}}\\quad (p:98\\to 89)\\cr\n\\begin{array}{|c|c|c|c|} \\hline\n\\textbf{玩家名} & \\textbf{手牌 1} & \\textbf{手牌 2}  & \\textbf{手牌 3} \\cr\\hline\n\\text{JoesSR} & \\c{A49} & \\c{PASS} & \\c{PASS} \\cr\\hline\n\\text{Cirno} & \\c{A19} & \\c{DOUBLE} & \\c{A49} \\cr\\hline\n\\end{array}\\cr\n\\textbf{\\textsf{第六回合}}\\quad (p:89\\to 89)\\cr\n\\begin{array}{|c|c|c|c|} \\hline\n\\textbf{玩家名} & \\textbf{手牌 1} & \\textbf{手牌 2}  & \\textbf{手牌 3} \\cr\\hline\n\\text{JoesSR} & \\c{A49} & \\c{PASS} & \\c{PASS} \\cr\\hline\n\\text{Cirno} & \\c{A19} & \\c{A99} & \\c{A49} \\cr\\hline\n\\end{array}\\cr\n\\textbf{\\textsf{第七回合}}\\quad (p:89\\to 89)\\cr\n\\begin{array}{|c|c|c|c|} \\hline\n\\textbf{玩家名} & \\textbf{手牌 1} & \\textbf{手牌 2}  & \\textbf{手牌 3} \\cr\\hline\n\\text{JoesSR} & \\c{A49} & \\c{A99} & \\c{PASS} \\cr\\hline\n\\text{Cirno} & \\c{A19} & \\c{A99} & \\c{A49} \\cr\\hline\n\\end{array}\\cr\n\\end{gathered}\n\\end{matrix}\n$$\n\n**注**：初始回合以及第 $2,4,6$ 回合都是 $\\text{JoesSR}$ 出牌；第 $1,3,5,7$ 回合都是琪露诺出牌。值得注意的是，尽管第 $5$ 回合琪露诺使用了 $\\tt{DOUBLE}$ ，但因为下一回合被 $\\tt{PASS}$ 了，所以第 $7$ 回合仍然是琪露诺出牌。\n\n此时琪露诺无论如何都会失败，于是琪露诺成为了失败者。\n\n#### 样例 3\n\n见下发附件。\n\n#### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，仅包含普通牌，并且 $n\\le 3$ 。\n- 对于另外 $15\\%$ 的数据，不包含 $\\tt{TURN}$ 牌和 $\\tt{PASS}$ 牌。\n- 对于另外 $15\\%$ 的数据，不包含 $\\tt{DOUBLE}$ 牌。\n- 对于 $100\\%$ 的数据， 满足 $1\\le n\\le 30;1\\le m\\le 100;1\\le k\\le 3\\times 10^5$ 。保证任何时候 $|p|<10^4$ 。\n\n#### 参考资料\n\n[【东方桌游考古】NEU，“⑨牌”，与十年前的同人](https://www.bilibili.com/read/cv9951620)", "locale": "zh-CN"}}}
{"pid": "P7507", "type": "P", "difficulty": 6, "samples": [["6 10\n3 0 4 5 1000 7\n1004 1005 1004 1004 5 997\n1006 1004 1000 999 5 999\n1017 1021 1023 1023 20 1019\n1012 1009 1009 1009 24 1018\n1007 1004 1004 1004 5 997\n", "1005\n1005\n1020\n1008\n1005\n1005\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2021", "洛谷原创", "O2优化", "背包 DP", "分块"], "title": "「Wdsr-2.5」未来水妖集市", "background": "每年，河城荷取（河童）都要为未来水妖集市准备展品，以及用于销售的商品。于是河童会生产大批量的产品。\n\n为了提高生产效率，河童决定搭建一条生产线。具体而言，河童会利用她的机械臂，构建出一长串的机器。每个机器只会对原材料进行若干次加工，最终输出成品。\n\n由于河童需要调试设备，于是机械臂每次操作后，河童会用一些询问确定这条生产线目前的性能如何。为了顺利完成生产任务，河童找到了你，希望你写一个程序告诉她每次操作后生产线的性能。", "description": "初始时原材料会有一个初始权值 。然后它会经过若干个机器的加工，花费若干点**加工指数**，得到最终产品。\n\n河童的机器有两种：\n\n- 0 型：每次加工花费 $v_i$ 的加工指数，让材料的附加值增加 $w_i$ 。材料经过时**最多只能加工一次**。\n- 1 型：每次加工花费 $v_i$ 的加工指数，让材料的附加值增加 $w_i$ 。材料经过时**加工次数无限制**。\n\n现在河童会利用一个机械臂来设计这套工艺流程。初始时，流水线上没有一台机器，机械臂放在位置 $0$。机器的位置编号是从 $1$ 开始的。现在河童会告诉你加工指数的最大值 $v$ ，然后她会下达 $q$ 个命令。不妨设每个指令执行前，机械臂的位置在 $p$ 。\n\n每个指令的格式为 $\\colorbox{#f0f0f0}\\verb!opt ti vi wi xi yi!$ ，其中 $opt$ 表示操作的种类。共有如下几种：\n\n1. **右移**：将机械臂向右移动一格，即 $p\\gets p+1$。\n2. **左移**：将机械臂向左移动一格，即 $p\\gets p-1$。\n3. **插入机器**：在机械臂当前位置插入一个机器，它的类型为 $t_i$ ，每次消耗的加工指数为 $v_i$ ，材料的附加值会增加 $w_i$ ，插入的机器的位置为 $p+1$ 。机械臂位置不变，但是被插入的机器右侧的机器都会向右移动一格。\n4. **删除机器**：在机械臂当前位置移除一个机器，移除的机器位置为 $p+1$ 。移除机器后机械臂位置不变，但是被移除的机器右侧的机器都会向左移动一格。\n5. **修改机器**：在机械臂当前位置修改一个机器的参数。即修改的机器的位置为 $p+1$ 。\n\n对于操作 1, 2, 4，请忽略参数 $\\colorbox{#f0f0f0}\\verb!ti vi wi!$ 。\n\n每次操作完，河童会询问你，如果一个初始权值为 $x_i$ 的物品从左侧起第一个机器进去，直到从右边机器出来，依次加工，消耗最多 $y_i$ 点加工点数（ $y_i\\le v$ ），这个物品可以获得的最大权值。特别地，如果此时没有一台机器，此物品权值不变。\n\n假设某一时刻共有 $u$ 台机器，那么数据保证在此时刻机械臂的位置必然在 $[0,u]$ 内。", "inputFormat": "第一行两个正整数 $q,v$ ，含义如题面所述。\n\n接下来 $q$ 行，每行 $6$ 个正整数 $opt',t_i',v_i',w_i',x_i',y_i'$ 。你需要**将它们分别异或上** $\\boldsymbol{last}$ 来获得真实的 $opt,t_i,v_i,w_i,x_i,y_i$ 。其中 $last$ 为上次输出的结果。特别地，初始时 $last=0$ 。", "outputFormat": "输出共 $q$ 行，每行一个正整数，表示每次询问的答案。", "hint": "#### 样例 1 说明\n\n解码后的输入数据：\n\n```plain\n6 10\n3 0 4 5 1000 7\n1 0 1 1 1000 8\n3 1 5 10 1000 10\n5 1 3 3 1000 7\n4 1 1 1 1000 10\n2 1 1 1 1000 8\n```\n\n#### 样例 2, 3\n\n见下发附件。\n\n#### 数据规模与约定\n\n- 对于 $10\\%$ 的数据，满足 $q,v\\le 10$ 。\n- 对于另外 $20\\%$ 的数据，满足 $v\\le 100$ 。\n- 对于另外 $20\\%$ 的数据，满足 $q,v\\le 2\\times 10^3$ 。\n- 对于 $100\\%$ 的数据， 满足 $1\\le q\\le 3\\times 10^4;1\\le v\\le 2\\times 10^4;1\\le x_i,y_i,w_i\\le 4\\times 10^4$ 。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdsr-2.5」未来水妖集市", "background": "每年，河城荷取（河童）都要为未来水妖集市准备展品，以及用于销售的商品。于是河童会生产大批量的产品。\n\n为了提高生产效率，河童决定搭建一条生产线。具体而言，河童会利用她的机械臂，构建出一长串的机器。每个机器只会对原材料进行若干次加工，最终输出成品。\n\n由于河童需要调试设备，于是机械臂每次操作后，河童会用一些询问确定这条生产线目前的性能如何。为了顺利完成生产任务，河童找到了你，希望你写一个程序告诉她每次操作后生产线的性能。", "description": "初始时原材料会有一个初始权值 。然后它会经过若干个机器的加工，花费若干点**加工指数**，得到最终产品。\n\n河童的机器有两种：\n\n- 0 型：每次加工花费 $v_i$ 的加工指数，让材料的附加值增加 $w_i$ 。材料经过时**最多只能加工一次**。\n- 1 型：每次加工花费 $v_i$ 的加工指数，让材料的附加值增加 $w_i$ 。材料经过时**加工次数无限制**。\n\n现在河童会利用一个机械臂来设计这套工艺流程。初始时，流水线上没有一台机器，机械臂放在位置 $0$。机器的位置编号是从 $1$ 开始的。现在河童会告诉你加工指数的最大值 $v$ ，然后她会下达 $q$ 个命令。不妨设每个指令执行前，机械臂的位置在 $p$ 。\n\n每个指令的格式为 $\\colorbox{#f0f0f0}\\verb!opt ti vi wi xi yi!$ ，其中 $opt$ 表示操作的种类。共有如下几种：\n\n1. **右移**：将机械臂向右移动一格，即 $p\\gets p+1$。\n2. **左移**：将机械臂向左移动一格，即 $p\\gets p-1$。\n3. **插入机器**：在机械臂当前位置插入一个机器，它的类型为 $t_i$ ，每次消耗的加工指数为 $v_i$ ，材料的附加值会增加 $w_i$ ，插入的机器的位置为 $p+1$ 。机械臂位置不变，但是被插入的机器右侧的机器都会向右移动一格。\n4. **删除机器**：在机械臂当前位置移除一个机器，移除的机器位置为 $p+1$ 。移除机器后机械臂位置不变，但是被移除的机器右侧的机器都会向左移动一格。\n5. **修改机器**：在机械臂当前位置修改一个机器的参数。即修改的机器的位置为 $p+1$ 。\n\n对于操作 1, 2, 4，请忽略参数 $\\colorbox{#f0f0f0}\\verb!ti vi wi!$ 。\n\n每次操作完，河童会询问你，如果一个初始权值为 $x_i$ 的物品从左侧起第一个机器进去，直到从右边机器出来，依次加工，消耗最多 $y_i$ 点加工点数（ $y_i\\le v$ ），这个物品可以获得的最大权值。特别地，如果此时没有一台机器，此物品权值不变。\n\n假设某一时刻共有 $u$ 台机器，那么数据保证在此时刻机械臂的位置必然在 $[0,u]$ 内。", "inputFormat": "第一行两个正整数 $q,v$ ，含义如题面所述。\n\n接下来 $q$ 行，每行 $6$ 个正整数 $opt',t_i',v_i',w_i',x_i',y_i'$ 。你需要**将它们分别异或上** $\\boldsymbol{last}$ 来获得真实的 $opt,t_i,v_i,w_i,x_i,y_i$ 。其中 $last$ 为上次输出的结果。特别地，初始时 $last=0$ 。", "outputFormat": "输出共 $q$ 行，每行一个正整数，表示每次询问的答案。", "hint": "#### 样例 1 说明\n\n解码后的输入数据：\n\n```plain\n6 10\n3 0 4 5 1000 7\n1 0 1 1 1000 8\n3 1 5 10 1000 10\n5 1 3 3 1000 7\n4 1 1 1 1000 10\n2 1 1 1 1000 8\n```\n\n#### 样例 2, 3\n\n见下发附件。\n\n#### 数据规模与约定\n\n- 对于 $10\\%$ 的数据，满足 $q,v\\le 10$ 。\n- 对于另外 $20\\%$ 的数据，满足 $v\\le 100$ 。\n- 对于另外 $20\\%$ 的数据，满足 $q,v\\le 2\\times 10^3$ 。\n- 对于 $100\\%$ 的数据， 满足 $1\\le q\\le 3\\times 10^4;1\\le v\\le 2\\times 10^4;1\\le x_i,y_i,w_i\\le 4\\times 10^4$ 。", "locale": "zh-CN"}}}
{"pid": "P7508", "type": "P", "difficulty": 5, "samples": [["7 7 4 1\n2 1\n3 1\n4 2\n5 2\n6 1\n7 6\n3 2\n7 1 2 3\n", "3\n3\n3\n4\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "2021", "洛谷原创", "O2优化", "图遍历"], "title": "「Wdsr-2.5」第二次月面战争", "background": "若干年之前，八云紫策划了第二次月面战争。\n\n作为神社的巫女，灵梦自然有保护人间之里人类的职责。为了能够使得人类免受月面战争可能造成的影响，灵梦决定在博丽神社设立一个结界。\n\n由于结界的影响范围有限，只能覆盖到博丽神社，于是灵梦决定将人间之里的所有居民迁入到神社中去。然而由于居民数目较多，灵梦在组织上出现了一些困难。这时，她找到了外界的你，希望你帮助她解决这个问题。", "description": "人间之里可以看做一张 $n$ 个点 $m$ 条边的有向图，而博丽神社在点 $t$ 。然而由于时间差的原因，灵梦不能一次性获取所有居民的位置，于是她会依次受到 $k$ 条消息，每条信息包含一个节点 $x$。\n\n- 如果 $x$ 号节点本来没有居民，那么灵梦得知了有一个居民在 $x$ 号节点。\n- 如果 $x$ 号节点本来有居民，那么由于某些原因， $x$ 号节点现在没有居民了。\n\n由于某些原因，在 $t$ 号节点也有可能存在居民。\n\n每当得知一条新的消息后，灵梦都需要快速计算出居民的最快疏散时间，以便于合理安排（此时，你可以认为其他节点上没有居民）。同时为了避免拥挤，以及其他难以预料的困难，灵梦做出了如下规则：\n\n- 每一时刻，每个居民只能沿着一条有向边走一步，或者**停留在原地**。\n- 每一时刻，每个节点上，**最多只能有一位居民**。\n- 当居民到达了博丽神社，那么**下一时刻**他就可以进入结界以获得庇护。你可以认为，在居民进入结界后他的行程就结束了。\n\n最快疏散时间，指的是**所有居民**全部进入结界的最短用时。", "inputFormat": "第一行四个正整数 $n,m,k,t$ ，含义如题所示。\n\n接下来 $m$ 行，每行两个正整数 $u,v$ ，描述一条 $u\\to v$ 的有向边。可能出现自环或者重边，请选手自行忽略。\n\n接下来一行，共 $k$ 个整数 $x_i$ ，表示在第 $i$ 条消息中 $x_i$ 号节点是否有居民的情况发生了变化。", "outputFormat": "输出共 $k$ 行，每行表示在按照前 $i$ 条消息，疏散所有居民所用的最小疏散时间。", "hint": "#### 样例 1 说明\n\n![main1.png](https://i.loli.net/2021/03/26/bWyznVgRc1pqPaf.png)\n\n这张图描述了**初始状态**、**第一次操作**、**第二次操作**的情况。可以发现；\n\n- 第一次操作后， $7$ 号节点最快通过 $7\\to 6\\to 1$ 到达神社，再花费 $1$ 单位时间进入神社，总共用时 $3$ 单位时间。\n- 第二次操作后， $1$ 号节点花费 $1$ 时刻进入神社， $7$ 号节点仍然按照 $7\\to 6\\to 1$ 到达神社，并花费 $1$ 单位时间进入神社即可。总共花费 $3$ 单位时间。\n\n![main2.png](https://i.loli.net/2021/03/26/sr3kbOWh7PxBway.png)\n\n这张图描述了第三次操作后的情况。\n\n第一时刻， $1$ 进入神社， $2\\to 1,7\\to 6$ ；第二时刻， $1$ 进入神社， $6\\to 1$ ；第三时刻所有人都进入了神社，于是总共花费 $3$ 单位时间。\n\n![main3.png](https://i.loli.net/2021/03/26/IWt7zKPohpFBmfV.png)\n\n这张图描述了第四次操作后的情况。\n\n第一时刻， $1$ 进入神社， $3\\to 1,7\\to 6$ ， $2$ 不动；第二时刻， $1$ 进入神社， $2\\to 1$ ， $6$ 不动。接下来花费 $2$ 时刻全部进入神社，于是总共花费 $4$ 单位时间。\n\n#### 样例 2,3\n\n见下发附件。\n\n#### 数据范围及约定\n\n$$\n\\def\\bd{\\boldsymbol}\n\\def\\a{\\texttt{A}}\t% 链的性质\n\\def\\b{\\texttt{B}}\t% 菊花图的性质\n\\def\\p{\\texttt{P}}\t% k为正的性质\n\\def\\n{\\text{无特殊限制}}\n\\def\\l{\\hline}\n\\def\\arraystretch{1.5}\\begin{array}{|c|c|c|c|c|}\\l\n\\textbf{数据点} & \\bd{n} & \\bd{m} & \\bd{k} & \\textbf{特殊性质} \\cr\\l\n1\\sim4 & n\\le 8 & m\\le 10 & k\\le 10 & - \\cr\\l\n5,6 & \\n & m=n-1 & \\n & \\p,\\a \\cr\\l\n7,8 & \\n & m=n-1 & \\n & \\p,\\b \\cr\\l\n9 & n\\le 10^5 & m=n-1 & k\\le 10^5 & \\p \\cr\\l\n10\\sim 12 & n\\le 10^3 & m\\le 10^3 & k\\le 10^3 & - \\cr\\l\n13,14 & n\\le 10^5 & m\\le 10^5 & k\\le 10^5 & \\p \\cr\\l\n15\\sim 17 & n\\le 10^5 & m\\le 10^5 & k\\le 10^5 & - \\cr\\l\n18\\sim 20 & \\n & \\n & \\n & - \\cr\\l\n\\end{array}\n$$\n\n- 特殊性质 $\\texttt{P}:$ 保证只存在出现居民的操作。\n- 特殊性质 $\\texttt{A}:$ 保证整张图是一条链，但不保证 $t$ 是链的一端。\n- 特殊性质 $\\texttt{B}:$ 保证除了 $t$ 以外的所有节点，都指向 $t$ 。\n\n\n对于所有数据，满足 $1\\le n\\le 10^6; 1\\le m\\le 1.05\\times 10^6;1\\le k\\le 10^6$ 。保证所有节点可以到达 $t$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdsr-2.5」第二次月面战争", "background": "若干年之前，八云紫策划了第二次月面战争。\n\n作为神社的巫女，灵梦自然有保护人间之里人类的职责。为了能够使得人类免受月面战争可能造成的影响，灵梦决定在博丽神社设立一个结界。\n\n由于结界的影响范围有限，只能覆盖到博丽神社，于是灵梦决定将人间之里的所有居民迁入到神社中去。然而由于居民数目较多，灵梦在组织上出现了一些困难。这时，她找到了外界的你，希望你帮助她解决这个问题。", "description": "人间之里可以看做一张 $n$ 个点 $m$ 条边的有向图，而博丽神社在点 $t$ 。然而由于时间差的原因，灵梦不能一次性获取所有居民的位置，于是她会依次受到 $k$ 条消息，每条信息包含一个节点 $x$。\n\n- 如果 $x$ 号节点本来没有居民，那么灵梦得知了有一个居民在 $x$ 号节点。\n- 如果 $x$ 号节点本来有居民，那么由于某些原因， $x$ 号节点现在没有居民了。\n\n由于某些原因，在 $t$ 号节点也有可能存在居民。\n\n每当得知一条新的消息后，灵梦都需要快速计算出居民的最快疏散时间，以便于合理安排（此时，你可以认为其他节点上没有居民）。同时为了避免拥挤，以及其他难以预料的困难，灵梦做出了如下规则：\n\n- 每一时刻，每个居民只能沿着一条有向边走一步，或者**停留在原地**。\n- 每一时刻，每个节点上，**最多只能有一位居民**。\n- 当居民到达了博丽神社，那么**下一时刻**他就可以进入结界以获得庇护。你可以认为，在居民进入结界后他的行程就结束了。\n\n最快疏散时间，指的是**所有居民**全部进入结界的最短用时。", "inputFormat": "第一行四个正整数 $n,m,k,t$ ，含义如题所示。\n\n接下来 $m$ 行，每行两个正整数 $u,v$ ，描述一条 $u\\to v$ 的有向边。可能出现自环或者重边，请选手自行忽略。\n\n接下来一行，共 $k$ 个整数 $x_i$ ，表示在第 $i$ 条消息中 $x_i$ 号节点是否有居民的情况发生了变化。", "outputFormat": "输出共 $k$ 行，每行表示在按照前 $i$ 条消息，疏散所有居民所用的最小疏散时间。", "hint": "#### 样例 1 说明\n\n![main1.png](https://i.loli.net/2021/03/26/bWyznVgRc1pqPaf.png)\n\n这张图描述了**初始状态**、**第一次操作**、**第二次操作**的情况。可以发现；\n\n- 第一次操作后， $7$ 号节点最快通过 $7\\to 6\\to 1$ 到达神社，再花费 $1$ 单位时间进入神社，总共用时 $3$ 单位时间。\n- 第二次操作后， $1$ 号节点花费 $1$ 时刻进入神社， $7$ 号节点仍然按照 $7\\to 6\\to 1$ 到达神社，并花费 $1$ 单位时间进入神社即可。总共花费 $3$ 单位时间。\n\n![main2.png](https://i.loli.net/2021/03/26/sr3kbOWh7PxBway.png)\n\n这张图描述了第三次操作后的情况。\n\n第一时刻， $1$ 进入神社， $2\\to 1,7\\to 6$ ；第二时刻， $1$ 进入神社， $6\\to 1$ ；第三时刻所有人都进入了神社，于是总共花费 $3$ 单位时间。\n\n![main3.png](https://i.loli.net/2021/03/26/IWt7zKPohpFBmfV.png)\n\n这张图描述了第四次操作后的情况。\n\n第一时刻， $1$ 进入神社， $3\\to 1,7\\to 6$ ， $2$ 不动；第二时刻， $1$ 进入神社， $2\\to 1$ ， $6$ 不动。接下来花费 $2$ 时刻全部进入神社，于是总共花费 $4$ 单位时间。\n\n#### 样例 2,3\n\n见下发附件。\n\n#### 数据范围及约定\n\n$$\n\\def\\bd{\\boldsymbol}\n\\def\\a{\\texttt{A}}\t% 链的性质\n\\def\\b{\\texttt{B}}\t% 菊花图的性质\n\\def\\p{\\texttt{P}}\t% k为正的性质\n\\def\\n{\\text{无特殊限制}}\n\\def\\l{\\hline}\n\\def\\arraystretch{1.5}\\begin{array}{|c|c|c|c|c|}\\l\n\\textbf{数据点} & \\bd{n} & \\bd{m} & \\bd{k} & \\textbf{特殊性质} \\cr\\l\n1\\sim4 & n\\le 8 & m\\le 10 & k\\le 10 & - \\cr\\l\n5,6 & \\n & m=n-1 & \\n & \\p,\\a \\cr\\l\n7,8 & \\n & m=n-1 & \\n & \\p,\\b \\cr\\l\n9 & n\\le 10^5 & m=n-1 & k\\le 10^5 & \\p \\cr\\l\n10\\sim 12 & n\\le 10^3 & m\\le 10^3 & k\\le 10^3 & - \\cr\\l\n13,14 & n\\le 10^5 & m\\le 10^5 & k\\le 10^5 & \\p \\cr\\l\n15\\sim 17 & n\\le 10^5 & m\\le 10^5 & k\\le 10^5 & - \\cr\\l\n18\\sim 20 & \\n & \\n & \\n & - \\cr\\l\n\\end{array}\n$$\n\n- 特殊性质 $\\texttt{P}:$ 保证只存在出现居民的操作。\n- 特殊性质 $\\texttt{A}:$ 保证整张图是一条链，但不保证 $t$ 是链的一端。\n- 特殊性质 $\\texttt{B}:$ 保证除了 $t$ 以外的所有节点，都指向 $t$ 。\n\n\n对于所有数据，满足 $1\\le n\\le 10^6; 1\\le m\\le 1.05\\times 10^6;1\\le k\\le 10^6$ 。保证所有节点可以到达 $t$。", "locale": "zh-CN"}}}
{"pid": "P7509", "type": "P", "difficulty": 4, "samples": [["5 1\n1 2 3 4 5\n1 1 1 1 1", "15"], ["3 2\n1 2 3\n499122177 499122177 499122177", "499122177"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "期望"], "title": "撕裂抹消", "background": "何以撕裂，何以抹消？", "description": "给定一个长为 $n$ 的整数序列 $a_1,a_2,\\dots,a_n$，再给定一个有理数序列 $p_1,p_2,\\dots,p_n$。每个位置上有一个随机系数 $c_i \\in \\{0,1\\}$，其中 $P(c_i =  1) = p_i$，$P(c_i = 0) = 1-p_i$。\n\n注意到随机系数写作序列后可以划分为若干个极长的连续 $0$、$1$ 段，极长指不能再向两边扩展。定义一种系数序列的权值为：当系数序列中恰有 $k$ 个极长连续 $1$ 段时为 $\\sum\\limits_{i=1}^n c_i a_i$，否则为 $0$。\n\n求这个系数序列的期望权值。答案对 $998244353$ 取模。", "inputFormat": "第一行，两个正整数 $n,k$。\n\n第二行，$n$ 个非负整数 $a_1,a_2,\\dots,a_n$。\n\n第三行，$n$ 个非负整数 $p_1,p_2,\\dots,p_n$，以模 $998244353$ 意义下给出。", "outputFormat": "一行，一个非负整数，表示期望。", "hint": "**样例解释**\n\n对于第一组样例，$c_i$ 必然为 $1$，且必然恰有 $1$ 个极长连续段，故权值必然为 $1 + 2 + 3 + 4 + 5 = 15$。\n\n对于第二组样例，仅有 $c_1 = 1,c_2 = 0,c_3 = 1$ 时权值不为 $0$，且此种情况的概率为 $\\frac 12 \\times \\frac 12 \\times \\frac 12 = \\frac 18$，故期望为 $\\frac{1+3}8 = \\frac 12 \\equiv 499122177 \\pmod {998244353}$。\n\n**数据范围**\n\n对于 $30\\%$ 的数据，$n \\le 20$。\n\n对于 $60\\%$ 的数据，$n \\le 10^3$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^5$，$1 \\le k \\le \\min\\left(20,\\left\\lfloor\\frac{n+1}2\\right\\rfloor\\right)$，$0 \\le a_i,p_i < 998244353$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "撕裂抹消", "background": "何以撕裂，何以抹消？", "description": "给定一个长为 $n$ 的整数序列 $a_1,a_2,\\dots,a_n$，再给定一个有理数序列 $p_1,p_2,\\dots,p_n$。每个位置上有一个随机系数 $c_i \\in \\{0,1\\}$，其中 $P(c_i =  1) = p_i$，$P(c_i = 0) = 1-p_i$。\n\n注意到随机系数写作序列后可以划分为若干个极长的连续 $0$、$1$ 段，极长指不能再向两边扩展。定义一种系数序列的权值为：当系数序列中恰有 $k$ 个极长连续 $1$ 段时为 $\\sum\\limits_{i=1}^n c_i a_i$，否则为 $0$。\n\n求这个系数序列的期望权值。答案对 $998244353$ 取模。", "inputFormat": "第一行，两个正整数 $n,k$。\n\n第二行，$n$ 个非负整数 $a_1,a_2,\\dots,a_n$。\n\n第三行，$n$ 个非负整数 $p_1,p_2,\\dots,p_n$，以模 $998244353$ 意义下给出。", "outputFormat": "一行，一个非负整数，表示期望。", "hint": "**样例解释**\n\n对于第一组样例，$c_i$ 必然为 $1$，且必然恰有 $1$ 个极长连续段，故权值必然为 $1 + 2 + 3 + 4 + 5 = 15$。\n\n对于第二组样例，仅有 $c_1 = 1,c_2 = 0,c_3 = 1$ 时权值不为 $0$，且此种情况的概率为 $\\frac 12 \\times \\frac 12 \\times \\frac 12 = \\frac 18$，故期望为 $\\frac{1+3}8 = \\frac 12 \\equiv 499122177 \\pmod {998244353}$。\n\n**数据范围**\n\n对于 $30\\%$ 的数据，$n \\le 20$。\n\n对于 $60\\%$ 的数据，$n \\le 10^3$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^5$，$1 \\le k \\le \\min\\left(20,\\left\\lfloor\\frac{n+1}2\\right\\rfloor\\right)$，$0 \\le a_i,p_i < 998244353$。", "locale": "zh-CN"}}}
{"pid": "P7510", "type": "P", "difficulty": 6, "samples": [["2\n", "-1 0\n"], ["5\n", "2 1\n9 7\n6 3\n8 4\n10 5\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "2021", "Special Judge", "构造"], "title": "铃解缀", "background": "题目：数对构造。", "description": "将 $1 \\sim 2n$ 的整数分为 $n$ 个有序数对 $(a_i,b_i)$（$1 \\le i \\le n$）。你需要使得对于任意不大于 $n$ 的正整数 $i$，有 $a_i - b_i = i$。\n\n给定 $n$，请你给出一种构造方案。若无解则输出 `-1 0`。", "inputFormat": "一行一个正整数 $n$。", "outputFormat": "若无解，输出一行两个整数 `-1 0`。否则输出 $n$ 行，每行两个 $1 \\sim 2n$ 内的正整数，表示 $(a_i,b_i)$。\n\n你需要保证 $n$ 对 $(a_i,b_i)$ 按 $a_i - b_i$ 的大小顺次构成一个 $1 \\sim 2n$ 整数的排列。", "hint": "**样例解释**\n\n对于第一组样例，显然这个样例无解。\n\n对于第二组样例，样例输出给出了一种可行的构造方案。\n\n**数据范围及约定**\n\n**本题使用捆绑测试。**\n\n$\\texttt{Subtask 1 (20 pts)}$：$n \\le 5$。\n\n$\\texttt{Subtask 2 (20 pts)}$：$n \\le 10 ^ 5$。\n\n$\\texttt{Subtask 3 (30 pts)}$：$n$ 为素数。\n\n$\\texttt{Subtask 4 (30 pts)}$：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^6$。\n\n这道题用来锻炼数学思维和构造能力，但不适合在 OI 比赛中。\n\n[CoOI Round 1](https://www.luogu.com.cn/contest/43016) B 题。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "铃解缀", "background": "题目：数对构造。", "description": "将 $1 \\sim 2n$ 的整数分为 $n$ 个有序数对 $(a_i,b_i)$（$1 \\le i \\le n$）。你需要使得对于任意不大于 $n$ 的正整数 $i$，有 $a_i - b_i = i$。\n\n给定 $n$，请你给出一种构造方案。若无解则输出 `-1 0`。", "inputFormat": "一行一个正整数 $n$。", "outputFormat": "若无解，输出一行两个整数 `-1 0`。否则输出 $n$ 行，每行两个 $1 \\sim 2n$ 内的正整数，表示 $(a_i,b_i)$。\n\n你需要保证 $n$ 对 $(a_i,b_i)$ 按 $a_i - b_i$ 的大小顺次构成一个 $1 \\sim 2n$ 整数的排列。", "hint": "**样例解释**\n\n对于第一组样例，显然这个样例无解。\n\n对于第二组样例，样例输出给出了一种可行的构造方案。\n\n**数据范围及约定**\n\n**本题使用捆绑测试。**\n\n$\\texttt{Subtask 1 (20 pts)}$：$n \\le 5$。\n\n$\\texttt{Subtask 2 (20 pts)}$：$n \\le 10 ^ 5$。\n\n$\\texttt{Subtask 3 (30 pts)}$：$n$ 为素数。\n\n$\\texttt{Subtask 4 (30 pts)}$：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^6$。\n\n这道题用来锻炼数学思维和构造能力，但不适合在 OI 比赛中。\n\n[CoOI Round 1](https://www.luogu.com.cn/contest/43016) B 题。", "locale": "zh-CN"}}}
{"pid": "P7511", "type": "P", "difficulty": 6, "samples": [["5 0\n1 2 3 4 5", "120"], ["5 1\n2 3 4 5 1", "5"], ["5 2\n2 4 5 1 3", "60"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["O2优化"], "title": "三到六", "background": "「听说 JOJO 6 要来力！」  \n「好时代，来临力！」  \n「可是那个无敌的男人……」  \n「啊……在吃刀子之前，让我重温一下『欧拉欧拉』……」", "description": "给定整数 $n,k$ 和一个 $n$ 阶排列 $\\pi'$，问多少个排列 $\\pi$ 满足恰有 $k$ 个位置 $i$ 满足 $1 \\le i \\le n$ 且 $\\pi_i < \\pi_{\\pi'_i}$。答案对 $998244353$ 取模。", "inputFormat": "第一行，两个整数 $n,k$。\n\n第二行，$n$ 个正整数，表示 $\\pi'$。", "outputFormat": "一行，一个非负整数，表示满足条件的 $\\pi$ 的数量。", "hint": "**样例解释**\n\n对于第一组样例，$\\pi_i$ 不可能小于 $\\pi_i$，故必然满足条件，则答案为 $5! = 120$。 \n\n对于第二组样例，有以下 $5$ 种 $\\pi$ 满足条件：\n\n 1. $12345$；\n 1. $23451$；\n 1. $34512$；\n 1. $45123$；\n 1. $51234$。\n\n对于第三组样例，不予解释。\n\n**数据范围**\n\n对于 $20\\%$ 的数据，$n \\le 10$。\n\n对于 $40\\%$ 的数据，$n \\le 3 \\times 10^2$。\n\n对于 $60\\%$ 的数据，$n \\le 10^3$。\n\n对于另外 $20\\%$ 的数据，保证 $\\pi'_i = i \\bmod n + 1$（$1 \\le i \\le n$）。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 2 \\times 10^5$，$0 \\le k \\le n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "三到六", "background": "「听说 JOJO 6 要来力！」  \n「好时代，来临力！」  \n「可是那个无敌的男人……」  \n「啊……在吃刀子之前，让我重温一下『欧拉欧拉』……」", "description": "给定整数 $n,k$ 和一个 $n$ 阶排列 $\\pi'$，问多少个排列 $\\pi$ 满足恰有 $k$ 个位置 $i$ 满足 $1 \\le i \\le n$ 且 $\\pi_i < \\pi_{\\pi'_i}$。答案对 $998244353$ 取模。", "inputFormat": "第一行，两个整数 $n,k$。\n\n第二行，$n$ 个正整数，表示 $\\pi'$。", "outputFormat": "一行，一个非负整数，表示满足条件的 $\\pi$ 的数量。", "hint": "**样例解释**\n\n对于第一组样例，$\\pi_i$ 不可能小于 $\\pi_i$，故必然满足条件，则答案为 $5! = 120$。 \n\n对于第二组样例，有以下 $5$ 种 $\\pi$ 满足条件：\n\n 1. $12345$；\n 1. $23451$；\n 1. $34512$；\n 1. $45123$；\n 1. $51234$。\n\n对于第三组样例，不予解释。\n\n**数据范围**\n\n对于 $20\\%$ 的数据，$n \\le 10$。\n\n对于 $40\\%$ 的数据，$n \\le 3 \\times 10^2$。\n\n对于 $60\\%$ 的数据，$n \\le 10^3$。\n\n对于另外 $20\\%$ 的数据，保证 $\\pi'_i = i \\bmod n + 1$（$1 \\le i \\le n$）。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 2 \\times 10^5$，$0 \\le k \\le n$。", "locale": "zh-CN"}}}
{"pid": "P7512", "type": "P", "difficulty": 7, "samples": [["3 0", "6 13 17 4"], ["5 1", "1035"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 2000, 2000, 2000, 2500, 2500, 2500], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["O2优化"], "title": "「Byakkai OI 2021」Eaquira", "background": "", "description": "给定 $n$，并在数轴上截取 $[1,n]$ 的整点。\n\n定义**极长连续黑区间段**为满足 $1 \\le L \\le R \\le p$ 的区间段 $[L,R]$，且编号在 $[L,R]$ 内的区间都是黑色，且其不能再扩展，即编号为 $L-1$（如果存在，下同）和 $R+1$ 的区间都是白色。\n\n首先，请您将它们划分成若干个区间 $[l_1,r_1],[l_2,r_2],\\dots,[l_p,r_p]$，满足 $l_1=1,r_p = n$，且对于 $1 \\le i < p$ 有 $r_i = l_{i+1}-1$；对于 $1 \\le i \\le p$ 满足 $l_i \\le r_i$。  \n\n其二，您需要将每个区间标记为黑色或是白色，但不允许第 $1$ 个区间和第 $p$ 个区间同时被标记为黑色。\n\n其三，请您在每个区间内选出一个子区间，称为**绝妙子区间**。\n\n其四，请您在每个极长连续黑区间段中各选出一个黑色区间，称为**绝妙黑区间**。\n\n其五，在所有的极长连续黑区间段中钦定若干个称作**绝妙极长连续黑区间段**。\n\n定义一种以上述步骤所确定的方案的权值为黑色区间的个数与绝妙极长连续黑区间段个数的和。\n\n我本来希望您求出对于 $s = 0,1,2,\\dots,n$ 得到可以使得最终权值为 $s$ 的方案数。不过我也准备了一些更低要求的挑战。详见输入格式。\n\n答案对 $998244353$ 取模。", "inputFormat": "一行，两个整数 $n,{\\rm type}$。\n\n若 ${\\rm type} = 0$，则表示需要对 $0 \\le s \\le n$ 求出权值为 $s$ 的方案数。  \n若 ${\\rm type} = 1$，则表示需要求出对所有 $0 \\le s \\le n$ 的总方案数。", "outputFormat": "若 ${\\rm type} = 0$，则一行 $n+1$ 个非负整数，依次表示对于 $s = 0,1,2,\\dots,n$ 的答案。  \n若 ${\\rm type} = 1$，则一行一个非负整数，表示答案。", "hint": "**样例解释**\n\n以下用 $0$ 表示黑，$1$ 表示白。\n\n对于第一个样例，考虑 $[1,3]$ 的 $4$ 种划分：\n- $[1,1],[2,2],[3,3]$：  \n  此时选出无序数对的方案数为 $1$。  \n  考虑每个区间的黑白标记情况，有如下 $4$ 种方案： \n    - $001,100$：此时可以选择将唯一的极长连续黑区间段标记为绝妙与否，则权值为 $2$ 或 $3$，选择绝妙黑区间的方案数为 $2$。\n    - $101$：此时可以选择将唯一的极长连续黑区间段标记为绝妙与否，则权值为 $1$ 或 $2$，选择绝妙黑区间的方案数为 $1$。\n- $[1,2],[3,3]$ 或 $[1,1],[2,3]$：  \n  此时选出无序数对的方案数为 $3$。  \n  考虑每个区间的黑白标记情况，有如下 $2$ 种方案：\n    - $01,10$：此时可以选择将唯一的极长连续黑区间段标记为绝妙与否，则权值为 $1$ 或 $2$，选择绝妙黑区间的方案数为 $1$。\n- $[1,3]$：  \n  此时选出无序数对的方案数为 $6$。  \n  考虑每个区间的黑白标记情况，有如下 $1$ 种方案：\n    - $1$：此时权值为 $0$，总方案数为 $6$，选择绝妙黑区间的方案数为 $1$。\n故权值为 $0$ 的方案数为 $6 \\times 1 = 6$，权值为 $1$ 的方案数为 $1 \\times 1 + 2 \\times 3 \\times 2 \\times 1 = 13$，权值为 $2$ 的方案数为 $1 \\times 2 \\times 2 + 1 \\times 1 + 2 \\times 3 \\times 2 \\times 1 = 17$，权值为 $3$ 的方案数为 $1 \\times 2 \\times 2 = 4$。\n\n对于第二个样例，不予解释。\n\n**数据范围**\n\n**本题使用捆绑测试。**\n\n具体子任务限制及分值如下表：\n\n|子任务编号|分值|$n \\le $|${\\rm type} =$|时限 / s|\n|:-:|:-:|:-:|:-:|:-:|\n|$0$|$1$|$8$|$0$|$1$|\n|$1$|$4$|$13$|$1$|$1$|\n|$2$|$8$|$300$|$1$|$1$|\n|$3$|$5$|$70$|$0$|$1$|\n|$4$|$10$|$5 \\times 10^3$|$1$|$1$|\n|$5$|$8$|$300$|$0$|$1$|\n|$6$|$12$|$2 \\times 10^5$|$1$|$1$|\n|$7$|$22$|$10^3$|$0$|$2$|\n|$8$|$30$|$2 \\times 10^5$|$0$|$2.5$|\n\n对于所有数据，$1 \\le n \\le 2 \\times 10^5$，${\\rm type} \\in \\{0,1\\}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Byakkai OI 2021」Eaquira", "background": "", "description": "给定 $n$，并在数轴上截取 $[1,n]$ 的整点。\n\n定义**极长连续黑区间段**为满足 $1 \\le L \\le R \\le p$ 的区间段 $[L,R]$，且编号在 $[L,R]$ 内的区间都是黑色，且其不能再扩展，即编号为 $L-1$（如果存在，下同）和 $R+1$ 的区间都是白色。\n\n首先，请您将它们划分成若干个区间 $[l_1,r_1],[l_2,r_2],\\dots,[l_p,r_p]$，满足 $l_1=1,r_p = n$，且对于 $1 \\le i < p$ 有 $r_i = l_{i+1}-1$；对于 $1 \\le i \\le p$ 满足 $l_i \\le r_i$。  \n\n其二，您需要将每个区间标记为黑色或是白色，但不允许第 $1$ 个区间和第 $p$ 个区间同时被标记为黑色。\n\n其三，请您在每个区间内选出一个子区间，称为**绝妙子区间**。\n\n其四，请您在每个极长连续黑区间段中各选出一个黑色区间，称为**绝妙黑区间**。\n\n其五，在所有的极长连续黑区间段中钦定若干个称作**绝妙极长连续黑区间段**。\n\n定义一种以上述步骤所确定的方案的权值为黑色区间的个数与绝妙极长连续黑区间段个数的和。\n\n我本来希望您求出对于 $s = 0,1,2,\\dots,n$ 得到可以使得最终权值为 $s$ 的方案数。不过我也准备了一些更低要求的挑战。详见输入格式。\n\n答案对 $998244353$ 取模。", "inputFormat": "一行，两个整数 $n,{\\rm type}$。\n\n若 ${\\rm type} = 0$，则表示需要对 $0 \\le s \\le n$ 求出权值为 $s$ 的方案数。  \n若 ${\\rm type} = 1$，则表示需要求出对所有 $0 \\le s \\le n$ 的总方案数。", "outputFormat": "若 ${\\rm type} = 0$，则一行 $n+1$ 个非负整数，依次表示对于 $s = 0,1,2,\\dots,n$ 的答案。  \n若 ${\\rm type} = 1$，则一行一个非负整数，表示答案。", "hint": "**样例解释**\n\n以下用 $0$ 表示黑，$1$ 表示白。\n\n对于第一个样例，考虑 $[1,3]$ 的 $4$ 种划分：\n- $[1,1],[2,2],[3,3]$：  \n  此时选出无序数对的方案数为 $1$。  \n  考虑每个区间的黑白标记情况，有如下 $4$ 种方案： \n    - $001,100$：此时可以选择将唯一的极长连续黑区间段标记为绝妙与否，则权值为 $2$ 或 $3$，选择绝妙黑区间的方案数为 $2$。\n    - $101$：此时可以选择将唯一的极长连续黑区间段标记为绝妙与否，则权值为 $1$ 或 $2$，选择绝妙黑区间的方案数为 $1$。\n- $[1,2],[3,3]$ 或 $[1,1],[2,3]$：  \n  此时选出无序数对的方案数为 $3$。  \n  考虑每个区间的黑白标记情况，有如下 $2$ 种方案：\n    - $01,10$：此时可以选择将唯一的极长连续黑区间段标记为绝妙与否，则权值为 $1$ 或 $2$，选择绝妙黑区间的方案数为 $1$。\n- $[1,3]$：  \n  此时选出无序数对的方案数为 $6$。  \n  考虑每个区间的黑白标记情况，有如下 $1$ 种方案：\n    - $1$：此时权值为 $0$，总方案数为 $6$，选择绝妙黑区间的方案数为 $1$。\n故权值为 $0$ 的方案数为 $6 \\times 1 = 6$，权值为 $1$ 的方案数为 $1 \\times 1 + 2 \\times 3 \\times 2 \\times 1 = 13$，权值为 $2$ 的方案数为 $1 \\times 2 \\times 2 + 1 \\times 1 + 2 \\times 3 \\times 2 \\times 1 = 17$，权值为 $3$ 的方案数为 $1 \\times 2 \\times 2 = 4$。\n\n对于第二个样例，不予解释。\n\n**数据范围**\n\n**本题使用捆绑测试。**\n\n具体子任务限制及分值如下表：\n\n|子任务编号|分值|$n \\le $|${\\rm type} =$|时限 / s|\n|:-:|:-:|:-:|:-:|:-:|\n|$0$|$1$|$8$|$0$|$1$|\n|$1$|$4$|$13$|$1$|$1$|\n|$2$|$8$|$300$|$1$|$1$|\n|$3$|$5$|$70$|$0$|$1$|\n|$4$|$10$|$5 \\times 10^3$|$1$|$1$|\n|$5$|$8$|$300$|$0$|$1$|\n|$6$|$12$|$2 \\times 10^5$|$1$|$1$|\n|$7$|$22$|$10^3$|$0$|$2$|\n|$8$|$30$|$2 \\times 10^5$|$0$|$2.5$|\n\n对于所有数据，$1 \\le n \\le 2 \\times 10^5$，${\\rm type} \\in \\{0,1\\}$。", "locale": "zh-CN"}}}
{"pid": "P7513", "type": "P", "difficulty": 7, "samples": [["15 1 2\n", "201012023\n"], ["1 7 3\n", "2\n"], ["3 2 3\n", "301162058\n"], ["4 2 2\n", "0\n"], ["19260817 114514 13579\n", "461194421\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "递推", "递归", "O2优化", "素数判断,质数,筛法", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "「Stoi2031」兰亭序 加强版", "background": "本题是[「Stoi2031」兰亭序](https://www.luogu.com.cn/problem/P7487) 的加强版。", "description": "给定 $n=a^b,k$，对 $1 \\le t \\le k$ 求\n\n$$\\prod_{x_1=1}^{n}\\prod_{x_2=1}^{n}\\dots\\prod_{x_t=1}^{n}\\left( 1+e^{\\frac{2\\pi ix_1x_2\\dots x_t}{n}} \\right) \\bmod{335544323}$$\n\n输出所有 $k$ 个答案的异或和。\n\n其中 $e^{it}=\\cos{t}+i\\sin{t}$ 对所有 $t \\in \\mathbb{R}$ 成立，$i$ 为虚数单位，满足 $i^2=-1$。", "inputFormat": "一行三个正整数 $a,b,k$，其中 $n=a^b$。", "outputFormat": "一行一个自然数表示答案。", "hint": "对于所有数据，$1 \\le a \\le 10^{18}$，$1 \\le b \\le 10^{13}$，$1 \\le k \\le 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Stoi2031」兰亭序 加强版", "background": "本题是[「Stoi2031」兰亭序](https://www.luogu.com.cn/problem/P7487) 的加强版。", "description": "给定 $n=a^b,k$，对 $1 \\le t \\le k$ 求\n\n$$\\prod_{x_1=1}^{n}\\prod_{x_2=1}^{n}\\dots\\prod_{x_t=1}^{n}\\left( 1+e^{\\frac{2\\pi ix_1x_2\\dots x_t}{n}} \\right) \\bmod{335544323}$$\n\n输出所有 $k$ 个答案的异或和。\n\n其中 $e^{it}=\\cos{t}+i\\sin{t}$ 对所有 $t \\in \\mathbb{R}$ 成立，$i$ 为虚数单位，满足 $i^2=-1$。", "inputFormat": "一行三个正整数 $a,b,k$，其中 $n=a^b$。", "outputFormat": "一行一个自然数表示答案。", "hint": "对于所有数据，$1 \\le a \\le 10^{18}$，$1 \\le b \\le 10^{13}$，$1 \\le k \\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P7514", "type": "P", "difficulty": 5, "samples": [["6 3\n8 11 13 14 16 19\n10 18 2 3 6 7\n", "8\n"], ["见附件中的 card/card2.in。", "见附件中的 card/card2.ans。"], ["见附件中的 card/card3.in。", "见附件中的 card/card3.ans。"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["各省省选", "2021", "O2优化", "排序", "双指针 two-pointer"], "title": "[省选联考 2021 A/B 卷] 卡牌游戏", "background": "", "description": "Alice 有 $n$ 张卡牌，第 $i$（$1 \\le i \\le n$）张卡牌的正面有数字 $a_i$，背面有数字 $b_i$，初始时所有卡牌正面朝上。\n\n现在 Alice 可以将不超过 $m$ 张卡牌翻面，即由正面朝上改为背面朝上。Alice 的目标是让最终朝上的 $n$ 个数字的极差（最大值与最小值的差）尽量小。请你帮 Alice 算一算极差的最小值是多少。", "inputFormat": "第一行，两个正整数 $n, m$，代表卡牌张数与至多翻面张数。  \n第二行，$n$ 个正整数，第 $i$ 个数字表示 $a_i$。  \n第三行，$n$ 个正整数，第 $i$ 个数字表示 $b_i$。\n\n数据保证卡牌上的 $2 n$ 个数字互不相同，且卡牌按照 $a_i$ 升序给出。", "outputFormat": "仅一行，一个整数，表示答案。", "hint": "**【样例 #1 解释】**\n\n最优方案之一：将第 $1, 5, 6$ 张卡牌翻面，最终朝上的数字依次为 $10, 11, 13, 14, 6, 7$，极差为 $14 - 6 = 8$。\n\n---\n\n**【数据范围】**\n\n对于所有测试数据：$3 \\le n \\le {10}^6$，$1 \\le m < n$，$1 \\le a_i, b_i \\le {10}^9$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | $n \\le$ | 特殊限制 |\n|:-:|:-:|:-:|\n| $1 \\sim 2$ | $10$ | 无 |\n| $3 \\sim 4$ | $500$ | 无 |\n| $5 \\sim 6$ | $5 \\times {10}^5$ | $m \\le 1000$ |\n| $7$ | ${10}^5$ | 无 |\n| $8$ | $4 \\times {10}^5$ | 无 |\n| $9$ | $7 \\times {10}^5$ | 无 |\n| $10$ | ${10}^6$ | 无 |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[省选联考 2021 A/B 卷] 卡牌游戏", "background": "", "description": "Alice 有 $n$ 张卡牌，第 $i$（$1 \\le i \\le n$）张卡牌的正面有数字 $a_i$，背面有数字 $b_i$，初始时所有卡牌正面朝上。\n\n现在 Alice 可以将不超过 $m$ 张卡牌翻面，即由正面朝上改为背面朝上。Alice 的目标是让最终朝上的 $n$ 个数字的极差（最大值与最小值的差）尽量小。请你帮 Alice 算一算极差的最小值是多少。", "inputFormat": "第一行，两个正整数 $n, m$，代表卡牌张数与至多翻面张数。  \n第二行，$n$ 个正整数，第 $i$ 个数字表示 $a_i$。  \n第三行，$n$ 个正整数，第 $i$ 个数字表示 $b_i$。\n\n数据保证卡牌上的 $2 n$ 个数字互不相同，且卡牌按照 $a_i$ 升序给出。", "outputFormat": "仅一行，一个整数，表示答案。", "hint": "**【样例 #1 解释】**\n\n最优方案之一：将第 $1, 5, 6$ 张卡牌翻面，最终朝上的数字依次为 $10, 11, 13, 14, 6, 7$，极差为 $14 - 6 = 8$。\n\n---\n\n**【数据范围】**\n\n对于所有测试数据：$3 \\le n \\le {10}^6$，$1 \\le m < n$，$1 \\le a_i, b_i \\le {10}^9$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | $n \\le$ | 特殊限制 |\n|:-:|:-:|:-:|\n| $1 \\sim 2$ | $10$ | 无 |\n| $3 \\sim 4$ | $500$ | 无 |\n| $5 \\sim 6$ | $5 \\times {10}^5$ | $m \\le 1000$ |\n| $7$ | ${10}^5$ | 无 |\n| $8$ | $4 \\times {10}^5$ | 无 |\n| $9$ | $7 \\times {10}^5$ | 无 |\n| $10$ | ${10}^6$ | 无 |", "locale": "zh-CN"}}}
{"pid": "P7515", "type": "P", "difficulty": 6, "samples": [["3\n3 3\n28 25\n24 25\n3 3\n15 14\n14 12\n3 3\n0 3000005\n0 0\n", "YES\n7 8 8\n8 5 4\n4 7 9\nYES\n4 2 2\n5 4 6\n5 0 2\nNO\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["图论", "各省省选", "2021", "Special Judge", "O2优化", "差分约束", "构造"], "title": "[省选联考 2021 A 卷] 矩阵游戏", "background": "", "description": "Alice 有一个 $n \\times m$ 的矩阵 $a_{i, j}$（$1 \\le i \\le n$，$1 \\le j \\le m$），其每个元素为大小不超过 ${10}^6$ 的非负整数。\n\nBob 根据该矩阵生成了一个 $(n - 1) \\times (m - 1)$ 的矩阵 $b_{i, j}$（$1 \\le i \\le n - 1$，$1 \\le j \\le m - 1$），每个元素的生成公式为\n\n$$ b_{i, j} = a_{i, j} + a_{i, j + 1} + a_{i + 1, j} + a_{i + 1, j + 1} $$\n\n现在 Alice 忘记了矩阵 $a_{i, j}$，请你根据 Bob 给出的矩阵 $b_{i, j}$ 还原出 $a_{i, j}$。", "inputFormat": "**本题有多组数据。**\n\n第一行，一个整数 $T$，表示数据组数。对于每组数据：\n\n第一行，两个正整数 $n, m$，表示矩阵 $a_{i, j}$ 的大小。  \n接下来 $n - 1$ 行，每行 $m - 1$ 个非负整数，表示 $b_{i, j}$。", "outputFormat": "对于每组数据：\n\n1. 若矩阵 $b_{i, j}$ 无法被生成，则输出一行一个字符串 `NO`。\n2. 若矩阵 $b_{i, j}$ 可被生成，则先输出一行一个字符串 `YES`，接下来输出 $n$ 行每行 $m$ 个（用单个空格分隔的）大小不超过 ${10}^6$ 的非负整数表示 $a_{i, j}$。\n\n若有多个矩阵 $a_{i, j}$ 可生成给出的 $b_{i, j}$，输出其中任意一个即可。", "hint": "**【数据范围】**\n\n对于所有测试数据：$1 \\le T \\le 10$，$2 \\le n, m \\le 300$，$0 \\le b_{i, j} \\le 4 \\times {10}^6$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | $n, m \\le$ | 特殊限制 |\n|:-:|:-:|:-:|\n| $1 \\sim 4$ | $3$ | 无 |\n| $5 \\sim 7$ | $10$ | $m = 2$ |\n| $8 \\sim 10$ | $100$ | $m = 2$ |\n| $11 \\sim 15$ | $300$ | $0 \\le b_{i, j} \\le 1$ |\n| $16 \\sim 20$ | $300$ | 无 |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[省选联考 2021 A 卷] 矩阵游戏", "background": "", "description": "Alice 有一个 $n \\times m$ 的矩阵 $a_{i, j}$（$1 \\le i \\le n$，$1 \\le j \\le m$），其每个元素为大小不超过 ${10}^6$ 的非负整数。\n\nBob 根据该矩阵生成了一个 $(n - 1) \\times (m - 1)$ 的矩阵 $b_{i, j}$（$1 \\le i \\le n - 1$，$1 \\le j \\le m - 1$），每个元素的生成公式为\n\n$$ b_{i, j} = a_{i, j} + a_{i, j + 1} + a_{i + 1, j} + a_{i + 1, j + 1} $$\n\n现在 Alice 忘记了矩阵 $a_{i, j}$，请你根据 Bob 给出的矩阵 $b_{i, j}$ 还原出 $a_{i, j}$。", "inputFormat": "**本题有多组数据。**\n\n第一行，一个整数 $T$，表示数据组数。对于每组数据：\n\n第一行，两个正整数 $n, m$，表示矩阵 $a_{i, j}$ 的大小。  \n接下来 $n - 1$ 行，每行 $m - 1$ 个非负整数，表示 $b_{i, j}$。", "outputFormat": "对于每组数据：\n\n1. 若矩阵 $b_{i, j}$ 无法被生成，则输出一行一个字符串 `NO`。\n2. 若矩阵 $b_{i, j}$ 可被生成，则先输出一行一个字符串 `YES`，接下来输出 $n$ 行每行 $m$ 个（用单个空格分隔的）大小不超过 ${10}^6$ 的非负整数表示 $a_{i, j}$。\n\n若有多个矩阵 $a_{i, j}$ 可生成给出的 $b_{i, j}$，输出其中任意一个即可。", "hint": "**【数据范围】**\n\n对于所有测试数据：$1 \\le T \\le 10$，$2 \\le n, m \\le 300$，$0 \\le b_{i, j} \\le 4 \\times {10}^6$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | $n, m \\le$ | 特殊限制 |\n|:-:|:-:|:-:|\n| $1 \\sim 4$ | $3$ | 无 |\n| $5 \\sim 7$ | $10$ | $m = 2$ |\n| $8 \\sim 10$ | $100$ | $m = 2$ |\n| $11 \\sim 15$ | $300$ | $0 \\le b_{i, j} \\le 1$ |\n| $16 \\sim 20$ | $300$ | 无 |", "locale": "zh-CN"}}}
{"pid": "P7516", "type": "P", "difficulty": 6, "samples": [["4 6\n2 3\n3 2\n4 1\n1 4\n2 1\n3 1\n", "6 5 5 4 4 4 4\n"], ["见附件中的 graph/graph2.in。", "见附件中的 graph/graph2.ans。"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["各省省选", "2021", "O2优化"], "title": "[省选联考 2021 A/B 卷] 图函数", "background": "", "description": "对于一张 $n$ 个点 $m$ 条边的有向图 $G$（顶点从 $1 \\sim n$ 编号），定义函数 $f(u, G)$：\n\n1. 初始化返回值 $cnt = 0$，图 $G' = G$。\n2. 从 $1$ 至 $n$ 按顺序枚举顶点 $v$，如果当前的图 $G'$ 中，从 $u$ 到 $v$ 与从 $v$ 到 $u$ 的路径都存在，则将 $cnt + 1$，并在图 $G'$ 中删去顶点 $v$ 以及与它相关的边。\n3. 第 $2$ 步结束后，返回值 $cnt$ 即为函数值。\n\n现在给定一张有向图 $G$，请你求出 $h(G) = f(1, G) + f(2, G) + \\cdots + f(n, G)$ 的值。\n\n更进一步地，记删除（按输入顺序给出的）第 $1$ 到 $i$ 条边后的图为 $G_i$（$1 \\le i \\le m$），请你求出所有 $h(G_i)$ 的值。", "inputFormat": "第一行，两个整数 $n,m$，表示图的点数与边数。  \n接下来 $m$ 行，每行两个整数，第 $i$ 行的两个整数 $x_i, y_i$ 表示一条有向边 $x_i \\to y_i$。\n\n数据保证 $x_i \\neq y_i$ 且同一条边不会给出多次。", "outputFormat": "输出一行 $m + 1$ 个整数，其中第一个数表示给出的完整图 $G$ 的 $h(G)$ 值。第 $i$（$2 \\le i \\le m + 1$）个整数表示 $h(G_{i-1})$。", "hint": "**【样例 #1 解释】**\n\n对于给出的完整图 $G$：\n\n1. $f(1, G) = 1$，过程中删除了顶点 $1$。\n2. $f(2, G) = 1$，过程中删除了顶点 $2$。\n3. $f(3, G) = 2$，过程中删除了顶点 $2, 3$。\n4. $f(4, G) = 2$，过程中删除了顶点 $1, 4$。\n\n---\n\n**【数据范围】**\n\n对于所有测试数据：$2 \\le n \\le {10}^3$，$1 \\le m \\le 2 \\times {10}^5$，$1 \\le x_i, y_i \\le n$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | $n \\le$ | $m\\le$ |\n|:-:|:-:|:-:|\n| $1 \\sim 4$ | $10$ | $10$ |\n| $5 \\sim 11$ | $100$ | $2 \\times {10}^3$ |\n| $12 \\sim 20$ | ${10}^3$ | $5 \\times {10}^3$ |\n| $21 \\sim 25$ | ${10}^3$ | $2 \\times {10}^5$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[省选联考 2021 A/B 卷] 图函数", "background": "", "description": "对于一张 $n$ 个点 $m$ 条边的有向图 $G$（顶点从 $1 \\sim n$ 编号），定义函数 $f(u, G)$：\n\n1. 初始化返回值 $cnt = 0$，图 $G' = G$。\n2. 从 $1$ 至 $n$ 按顺序枚举顶点 $v$，如果当前的图 $G'$ 中，从 $u$ 到 $v$ 与从 $v$ 到 $u$ 的路径都存在，则将 $cnt + 1$，并在图 $G'$ 中删去顶点 $v$ 以及与它相关的边。\n3. 第 $2$ 步结束后，返回值 $cnt$ 即为函数值。\n\n现在给定一张有向图 $G$，请你求出 $h(G) = f(1, G) + f(2, G) + \\cdots + f(n, G)$ 的值。\n\n更进一步地，记删除（按输入顺序给出的）第 $1$ 到 $i$ 条边后的图为 $G_i$（$1 \\le i \\le m$），请你求出所有 $h(G_i)$ 的值。", "inputFormat": "第一行，两个整数 $n,m$，表示图的点数与边数。  \n接下来 $m$ 行，每行两个整数，第 $i$ 行的两个整数 $x_i, y_i$ 表示一条有向边 $x_i \\to y_i$。\n\n数据保证 $x_i \\neq y_i$ 且同一条边不会给出多次。", "outputFormat": "输出一行 $m + 1$ 个整数，其中第一个数表示给出的完整图 $G$ 的 $h(G)$ 值。第 $i$（$2 \\le i \\le m + 1$）个整数表示 $h(G_{i-1})$。", "hint": "**【样例 #1 解释】**\n\n对于给出的完整图 $G$：\n\n1. $f(1, G) = 1$，过程中删除了顶点 $1$。\n2. $f(2, G) = 1$，过程中删除了顶点 $2$。\n3. $f(3, G) = 2$，过程中删除了顶点 $2, 3$。\n4. $f(4, G) = 2$，过程中删除了顶点 $1, 4$。\n\n---\n\n**【数据范围】**\n\n对于所有测试数据：$2 \\le n \\le {10}^3$，$1 \\le m \\le 2 \\times {10}^5$，$1 \\le x_i, y_i \\le n$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | $n \\le$ | $m\\le$ |\n|:-:|:-:|:-:|\n| $1 \\sim 4$ | $10$ | $10$ |\n| $5 \\sim 11$ | $100$ | $2 \\times {10}^3$ |\n| $12 \\sim 20$ | ${10}^3$ | $5 \\times {10}^3$ |\n| $21 \\sim 25$ | ${10}^3$ | $2 \\times {10}^5$ |", "locale": "zh-CN"}}}
{"pid": "P7517", "type": "P", "difficulty": 3, "samples": [["6\n16 11 6 1 9 11\n", "7\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["各省省选", "2021", "O2优化", "枚举"], "title": "[省选联考 2021 B 卷] 数对", "background": "", "description": "给定 $n$ 个正整数 $a_i$，请你求出有多少个数对 $(i, j)$ 满足 $1 \\le i \\le n$，$1 \\le j \\le n$，$i \\ne j$ 且 $a_i$ 是 $a_j$ 的倍数。", "inputFormat": "第一行，一个整数 $n$，表示数字个数。\n\n第二行，$n$ 个整数，表示 $a_i$。", "outputFormat": "输出一行，一个整数，表示答案。", "hint": "对于 $40 \\%$ 的数据，$n \\le 1000$。  \n对于 $70 \\%$ 的数据，$1 \\le a_i \\le 5 \\times {10}^3$。  \n对于 $100 \\%$ 的数据，$2 \\le n \\le 2 \\times {10}^5$，$1 \\le a_i \\le 5 \\times {10}^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[省选联考 2021 B 卷] 数对", "background": "", "description": "给定 $n$ 个正整数 $a_i$，请你求出有多少个数对 $(i, j)$ 满足 $1 \\le i \\le n$，$1 \\le j \\le n$，$i \\ne j$ 且 $a_i$ 是 $a_j$ 的倍数。", "inputFormat": "第一行，一个整数 $n$，表示数字个数。\n\n第二行，$n$ 个整数，表示 $a_i$。", "outputFormat": "输出一行，一个整数，表示答案。", "hint": "对于 $40 \\%$ 的数据，$n \\le 1000$。  \n对于 $70 \\%$ 的数据，$1 \\le a_i \\le 5 \\times {10}^3$。  \n对于 $100 \\%$ 的数据，$2 \\le n \\le 2 \\times {10}^5$，$1 \\le a_i \\le 5 \\times {10}^5$。", "locale": "zh-CN"}}}
{"pid": "P7518", "type": "P", "difficulty": 6, "samples": [["7 3 3\n2 3 1\n2 1 3 3 2 1 3\n1 2\n2 3\n1 4\n4 5\n4 6\n6 7\n5\n3 5\n1 3\n7 3\n5 7\n7 5\n", "2\n2\n2\n3\n1\n"], ["见附件中的 gem/gem2.in", "见附件中的 gem/gem2.ans"], ["见附件中的 gem/gem3.in", "见附件中的 gem/gem3.ans"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["倍增", "二分", "各省省选", "2021", "O2优化", "可持久化线段树"], "title": "[省选联考 2021 A/B 卷]  宝石", "background": "**链的部分分官方数据有误。这里已经修改，如仍有误请反馈。**", "description": "欧艾大陆上有 $n$ 座城市，城市从 $1 \\sim n$ 编号，所有城市经由 $n - 1$ 条无向道路互相连通，即 $n$ 座城市与 $n - 1$ 条道路构成了一棵树。\n\n每座城市的集市上都会出售宝石，总共有 $m$ 种不同的宝石，用 $1 \\sim m$ 编号。$i$ 号城市的集市出售的是第 $w_i$ 种宝石，一种宝石可能会在多座城市的集市出售。\n\nK 神有一个宝石收集器。这个宝石收集器能按照顺序收集至多 $c$ 颗宝石，其收集宝石的顺序为：$P_1, P_2, \\ldots , P_c$。更具体地，收集器需要先放入第 $P_1$ 种宝石，然后才能再放入第 $P_2$ 种宝石，之后再能放入第 $P_3$ 种宝石，以此类推。其中 $P_1, P_2, \\ldots , P_c$ 互不相等。\n\nK 神到达一个城市后，如果该城市的集市上出售的宝石种类和当前收集器中需要放入的种类相同，则他可以在该城市的集市上购买一颗宝石并放入宝石收集器中；否则他只会路过该城市什么都不做。\n\n现在 K 神给了你 $q$ 次询问，每次给出起点 $s_i$ 与终点 $t_i$，他想知道如果从 $s_i$ 号城市出发，沿最短路线走到 $t_i$ 号城市后，他的收集器中最多能收集到几个宝石？（在每次询问中，收集器内初始时没有任何宝石。起点与终点城市集市上的宝石可以尝试被收集）", "inputFormat": "第一行，包含三个正整数 $n, m, c$，分别表示城市数，宝石种类数，收集器的容量。  \n第二行，包含 $c$ 个正整数 $P_i$。数据保证 $1 \\le P_i \\le m$ 且这些数互不相等。  \n第三行，包含 $n$ 个正整数 $w_i$，表示每个城市集市上出售的宝石种类。  \n接下来 $n - 1$ 行，每行两个正整数 $u_i, v_i$，表示一条连接 $u_i$ 和 $v_i$ 号城市的道路。  \n接下来一行，包含一个正整数 $q$，表示询问次数。  \n接下来 $q$ 行，每行两个正整数 $s_i, t_i$，表示该次询问的起点与终点。", "outputFormat": "按输入顺序输出 $q$ 行，每行一个整数，表示询问的答案。", "hint": "**【数据范围】**\n\n对于所有测试数据：$1 \\le n, q \\le 2 \\times {10}^5$，$1 \\le c \\le m \\le 5 \\times {10}^4$，$1 \\le w_i \\le m$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | $n, q \\le$ | 特殊限制 |\n|:-:|:-:|:-:|\n| $1 \\sim 2$ | $10$ | 无 |\n| $3 \\sim 5$ | $1000$ | 无 |\n| $6 \\sim 10$ | $2 \\times {10}^5$ | $m \\le 300$ |\n| $11 \\sim 14$ | $2 \\times {10}^5$ | $u_i = i$，$v_i = i + 1$ |\n| $15 \\sim 20$ | $2 \\times {10}^5$ | 无 |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[省选联考 2021 A/B 卷]  宝石", "background": "**链的部分分官方数据有误。这里已经修改，如仍有误请反馈。**", "description": "欧艾大陆上有 $n$ 座城市，城市从 $1 \\sim n$ 编号，所有城市经由 $n - 1$ 条无向道路互相连通，即 $n$ 座城市与 $n - 1$ 条道路构成了一棵树。\n\n每座城市的集市上都会出售宝石，总共有 $m$ 种不同的宝石，用 $1 \\sim m$ 编号。$i$ 号城市的集市出售的是第 $w_i$ 种宝石，一种宝石可能会在多座城市的集市出售。\n\nK 神有一个宝石收集器。这个宝石收集器能按照顺序收集至多 $c$ 颗宝石，其收集宝石的顺序为：$P_1, P_2, \\ldots , P_c$。更具体地，收集器需要先放入第 $P_1$ 种宝石，然后才能再放入第 $P_2$ 种宝石，之后再能放入第 $P_3$ 种宝石，以此类推。其中 $P_1, P_2, \\ldots , P_c$ 互不相等。\n\nK 神到达一个城市后，如果该城市的集市上出售的宝石种类和当前收集器中需要放入的种类相同，则他可以在该城市的集市上购买一颗宝石并放入宝石收集器中；否则他只会路过该城市什么都不做。\n\n现在 K 神给了你 $q$ 次询问，每次给出起点 $s_i$ 与终点 $t_i$，他想知道如果从 $s_i$ 号城市出发，沿最短路线走到 $t_i$ 号城市后，他的收集器中最多能收集到几个宝石？（在每次询问中，收集器内初始时没有任何宝石。起点与终点城市集市上的宝石可以尝试被收集）", "inputFormat": "第一行，包含三个正整数 $n, m, c$，分别表示城市数，宝石种类数，收集器的容量。  \n第二行，包含 $c$ 个正整数 $P_i$。数据保证 $1 \\le P_i \\le m$ 且这些数互不相等。  \n第三行，包含 $n$ 个正整数 $w_i$，表示每个城市集市上出售的宝石种类。  \n接下来 $n - 1$ 行，每行两个正整数 $u_i, v_i$，表示一条连接 $u_i$ 和 $v_i$ 号城市的道路。  \n接下来一行，包含一个正整数 $q$，表示询问次数。  \n接下来 $q$ 行，每行两个正整数 $s_i, t_i$，表示该次询问的起点与终点。", "outputFormat": "按输入顺序输出 $q$ 行，每行一个整数，表示询问的答案。", "hint": "**【数据范围】**\n\n对于所有测试数据：$1 \\le n, q \\le 2 \\times {10}^5$，$1 \\le c \\le m \\le 5 \\times {10}^4$，$1 \\le w_i \\le m$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | $n, q \\le$ | 特殊限制 |\n|:-:|:-:|:-:|\n| $1 \\sim 2$ | $10$ | 无 |\n| $3 \\sim 5$ | $1000$ | 无 |\n| $6 \\sim 10$ | $2 \\times {10}^5$ | $m \\le 300$ |\n| $11 \\sim 14$ | $2 \\times {10}^5$ | $u_i = i$，$v_i = i + 1$ |\n| $15 \\sim 20$ | $2 \\times {10}^5$ | 无 |", "locale": "zh-CN"}}}
{"pid": "P7519", "type": "P", "difficulty": 6, "samples": [["3 6\n1 2 1\n", "5\n"], ["6 50\n4 7 9 3 0 3\n", "96"], ["11 300\n6 8 8 12 0 11 6 1 0 15 5\n", "30140983\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["各省省选", "2021", "O2优化"], "title": "[省选联考 2021 A/B 卷] 滚榜", "background": "", "description": "封榜是 ICPC 系列竞赛中的一个特色机制。ICPC 竞赛是实时反馈提交结果的程序设计竞赛，参赛选手与场外观众可以通过排行榜实时查看每个参赛队伍的过题数与排名。竞赛的最后一小时会进行“封榜”，即排行榜上将隐藏最后一小时内的提交的结果。赛后通过滚榜环节将最后一小时的结果（即每只队伍最后一小时的过题数）公布。\n\nAlice 围观了一场 ICPC 竞赛的滚榜环节。本次竞赛共有 $n$ 支队伍参赛，队伍从 $1 \\sim n$ 编号，$i$ 号队伍在封榜前通过的题数为 $a_i$。排行榜上队伍按照过题数从大到小进行排名，若两支队伍过题数相同，则编号小的队伍排名靠前。\n\n滚榜时主办方以 $b_i$ 不降的顺序依次公布了每支队伍在封榜后的过题数 $b_i$（最终该队伍总过题数为 $a_i + b_i$），并且每公布一支队伍的结果，排行榜上就会实时更新排名。Alice 并不记得队伍被公布的顺序，也不记得最终排行榜上的排名情况，只记得每次公布后，本次被公布结果的队伍都成为了新排行榜上的第一名，以及所有队伍在封榜后一共通过了 $m$ 道题（即 $\\sum_{i = 1}^{n} b_i = m$）。\n\n现在 Alice 想请你帮她算算，最终排行榜上队伍的排名情况可能有多少种。", "inputFormat": "第一行，包含两个正整数 $n, m$，表示队伍数量与它们封榜后的总过题数。  \n第二行，包含 $n$ 个正整数，表示 $a_i$。", "outputFormat": "仅一行，一个整数，表示答案。", "hint": "**【样例 #1 解释】**\n\n1. 最终排名：$1, 3, 2$，滚榜情况（按公布顺序，下同）：$b_2 = 0$，$b_3 = 2$，$b_1 = 4$。\n\n2. 最终排名：$2, 1, 3$，滚榜情况：$b_3 = 2$，$b_1 = 2$，$b_2 = 2$。\n\n3. 最终排名：$2, 3, 1$，滚榜情况：$b_1 = 1$，$b_3 = 2$，$b_2 = 3$。\n\n4. 最终排名：$3, 1, 2$，滚榜情况：$b_2 = 0$，$b_1 = 2$，$b_3 = 4$。\n\n5. 最终排名：$3, 2, 1$，滚榜情况：$b_1 = 1$，$b_2 = 1$，$b_3 = 4$。\n\n---\n\n**【数据范围】**\n\n对于所有测试数据：$1 \\le n \\le 13$，$1 \\le m \\le 500$，$0 \\le a_i \\le {10}^4$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | $n \\le$ | $m \\le$ |\n|:-:|:-:|:-:|\n| $1 \\sim 2$ | $2$ | $10$ |\n| $3 \\sim 5$ | $3$ | $10$ |\n| $6 \\sim 8$ | $8$ | $100$ |\n| $9 \\sim 12$ | $10$ | $200$ |\n| $13 \\sim 16$ | $12$ | $300$ |\n| $17 \\sim 20$ | $13$ | $500$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[省选联考 2021 A/B 卷] 滚榜", "background": "", "description": "封榜是 ICPC 系列竞赛中的一个特色机制。ICPC 竞赛是实时反馈提交结果的程序设计竞赛，参赛选手与场外观众可以通过排行榜实时查看每个参赛队伍的过题数与排名。竞赛的最后一小时会进行“封榜”，即排行榜上将隐藏最后一小时内的提交的结果。赛后通过滚榜环节将最后一小时的结果（即每只队伍最后一小时的过题数）公布。\n\nAlice 围观了一场 ICPC 竞赛的滚榜环节。本次竞赛共有 $n$ 支队伍参赛，队伍从 $1 \\sim n$ 编号，$i$ 号队伍在封榜前通过的题数为 $a_i$。排行榜上队伍按照过题数从大到小进行排名，若两支队伍过题数相同，则编号小的队伍排名靠前。\n\n滚榜时主办方以 $b_i$ 不降的顺序依次公布了每支队伍在封榜后的过题数 $b_i$（最终该队伍总过题数为 $a_i + b_i$），并且每公布一支队伍的结果，排行榜上就会实时更新排名。Alice 并不记得队伍被公布的顺序，也不记得最终排行榜上的排名情况，只记得每次公布后，本次被公布结果的队伍都成为了新排行榜上的第一名，以及所有队伍在封榜后一共通过了 $m$ 道题（即 $\\sum_{i = 1}^{n} b_i = m$）。\n\n现在 Alice 想请你帮她算算，最终排行榜上队伍的排名情况可能有多少种。", "inputFormat": "第一行，包含两个正整数 $n, m$，表示队伍数量与它们封榜后的总过题数。  \n第二行，包含 $n$ 个正整数，表示 $a_i$。", "outputFormat": "仅一行，一个整数，表示答案。", "hint": "**【样例 #1 解释】**\n\n1. 最终排名：$1, 3, 2$，滚榜情况（按公布顺序，下同）：$b_2 = 0$，$b_3 = 2$，$b_1 = 4$。\n\n2. 最终排名：$2, 1, 3$，滚榜情况：$b_3 = 2$，$b_1 = 2$，$b_2 = 2$。\n\n3. 最终排名：$2, 3, 1$，滚榜情况：$b_1 = 1$，$b_3 = 2$，$b_2 = 3$。\n\n4. 最终排名：$3, 1, 2$，滚榜情况：$b_2 = 0$，$b_1 = 2$，$b_3 = 4$。\n\n5. 最终排名：$3, 2, 1$，滚榜情况：$b_1 = 1$，$b_2 = 1$，$b_3 = 4$。\n\n---\n\n**【数据范围】**\n\n对于所有测试数据：$1 \\le n \\le 13$，$1 \\le m \\le 500$，$0 \\le a_i \\le {10}^4$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | $n \\le$ | $m \\le$ |\n|:-:|:-:|:-:|\n| $1 \\sim 2$ | $2$ | $10$ |\n| $3 \\sim 5$ | $3$ | $10$ |\n| $6 \\sim 8$ | $8$ | $100$ |\n| $9 \\sim 12$ | $10$ | $200$ |\n| $13 \\sim 16$ | $12$ | $300$ |\n| $17 \\sim 20$ | $13$ | $500$ |", "locale": "zh-CN"}}}
{"pid": "P7520", "type": "P", "difficulty": 6, "samples": [["6 6 3\n1 2\n1 3\n3 4\n4 5\n2 6\n4 1\n5 6\n3 2\n2 4\n", "1\n0\n2\n"], ["见附件中的 dominator/dominator2.in。", "见附件中的 dominator/dominator2.ans。"], ["见附件中的 dominator/dominator3.in。", "见附件中的 dominator/dominator3.ans。"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["各省省选", "2021", "O2优化"], "title": "[省选联考 2021 A 卷] 支配", "background": "", "description": "给定一张 $n$ 个点 $m$ 条边的有向图 $G$，其顶点从 $1$ 到 $n$ 编号。\n\n对于任意两个点 $u, v$，若从顶点 $1$ 出发到达顶点 $v$ 的所有路径都需要经过顶点 $u$，则称顶点 $u$ 支配顶点 $v$。特别地，每个顶点支配其自身。\n\n对于任意一个点 $v$，我们将图中支配顶点 $v$ 的顶点集合称为 $v$ 的受支配集 $D_v$。\n\n现在有 $q$ 次互相独立的询问，每次询问给出一条有向边，请你回答在图 $G$ 中加入该条边后，有多少个顶点的受支配集发生了变化。", "inputFormat": "第一行，三个整数 $n, m, q$，分别表示图中的顶点数、边数，以及询问数。  \n接下来 $m$ 行，每行两个整数 $x_i,y_i$，表示一条有向边从 $x_i$ 到 $y_i$。  \n接下来 $q$ 行，每行两个整数 $s_i,t_i$，表示每次询问加入的边从 $s_i$ 到 $t_i$。\n\n数据保证给出的图 $G$ 中，从 $1$ 号点出发能到达所有其他点，并且图中不包含重边与自环。", "outputFormat": "对于每个询问，输出一行，一个整数，表示答案。", "hint": "**【样例 #1 解释】**\n\n对于原图，六个点的受支配集分别为：$D_1 = \\{ 1 \\}$，$D_2 = \\{ 1, 2 \\}$，$D_3 = \\{ 1, 3 \\}$，$D_4 =\\{ 1, 3, 4 \\}$，$D_5 = \\{ 1, 3, 4, 5 \\}$，$D_6 = \\{ 1, 2, 6 \\}$。\n\n加入 $5 \\to 6$ 后，$D_6 = \\{ 1, 6 \\}$，其他点受支配集不变。\n\n加入 $3 \\to 2$ 后没有点受支配集改变。\n\n加入 $2 \\to 4$ 后，$D_4 = \\{ 1, 4 \\}$，$D_5 = \\{ 1, 4, 5 \\}$，其他点受支配集不变。\n\n---\n\n**【数据范围】**\n\n对于所有测试数据：$1 \\le n \\le 3 \\times {10}^3$，$1 \\le m \\le 2 \\times n$，$1 \\le q \\le 2 \\times {10}^4$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | $n \\le$ | 特殊性质 |\n|:-:|:-:|:-:|\n| $1 \\sim 2$ | $10$ | 无 |\n| $3 \\sim 6$ | $100$ | $q \\le 100$ |\n| $7 \\sim 9$ | $1000$ | $m = n - 1$ |\n| $10 \\sim 15$ | $1000$ | $q \\le 2000$ |\n| $16 \\sim 20$ | $3000$ | 无 |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[省选联考 2021 A 卷] 支配", "background": "", "description": "给定一张 $n$ 个点 $m$ 条边的有向图 $G$，其顶点从 $1$ 到 $n$ 编号。\n\n对于任意两个点 $u, v$，若从顶点 $1$ 出发到达顶点 $v$ 的所有路径都需要经过顶点 $u$，则称顶点 $u$ 支配顶点 $v$。特别地，每个顶点支配其自身。\n\n对于任意一个点 $v$，我们将图中支配顶点 $v$ 的顶点集合称为 $v$ 的受支配集 $D_v$。\n\n现在有 $q$ 次互相独立的询问，每次询问给出一条有向边，请你回答在图 $G$ 中加入该条边后，有多少个顶点的受支配集发生了变化。", "inputFormat": "第一行，三个整数 $n, m, q$，分别表示图中的顶点数、边数，以及询问数。  \n接下来 $m$ 行，每行两个整数 $x_i,y_i$，表示一条有向边从 $x_i$ 到 $y_i$。  \n接下来 $q$ 行，每行两个整数 $s_i,t_i$，表示每次询问加入的边从 $s_i$ 到 $t_i$。\n\n数据保证给出的图 $G$ 中，从 $1$ 号点出发能到达所有其他点，并且图中不包含重边与自环。", "outputFormat": "对于每个询问，输出一行，一个整数，表示答案。", "hint": "**【样例 #1 解释】**\n\n对于原图，六个点的受支配集分别为：$D_1 = \\{ 1 \\}$，$D_2 = \\{ 1, 2 \\}$，$D_3 = \\{ 1, 3 \\}$，$D_4 =\\{ 1, 3, 4 \\}$，$D_5 = \\{ 1, 3, 4, 5 \\}$，$D_6 = \\{ 1, 2, 6 \\}$。\n\n加入 $5 \\to 6$ 后，$D_6 = \\{ 1, 6 \\}$，其他点受支配集不变。\n\n加入 $3 \\to 2$ 后没有点受支配集改变。\n\n加入 $2 \\to 4$ 后，$D_4 = \\{ 1, 4 \\}$，$D_5 = \\{ 1, 4, 5 \\}$，其他点受支配集不变。\n\n---\n\n**【数据范围】**\n\n对于所有测试数据：$1 \\le n \\le 3 \\times {10}^3$，$1 \\le m \\le 2 \\times n$，$1 \\le q \\le 2 \\times {10}^4$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | $n \\le$ | 特殊性质 |\n|:-:|:-:|:-:|\n| $1 \\sim 2$ | $10$ | 无 |\n| $3 \\sim 6$ | $100$ | $q \\le 100$ |\n| $7 \\sim 9$ | $1000$ | $m = n - 1$ |\n| $10 \\sim 15$ | $1000$ | $q \\le 2000$ |\n| $16 \\sim 20$ | $3000$ | 无 |", "locale": "zh-CN"}}}
{"pid": "P7521", "type": "P", "difficulty": 5, "samples": [["6\n4 7 7 5 2 2\n", "6\n"], ["见附件中的 mod/mod2.in。", "见附件中的 mod/mod2.ans。"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["各省省选", "2021", "O2优化"], "title": "[省选联考 2021 B 卷] 取模", "background": "", "description": "给定 $n$ 个正整数 $a_i$，请你在其中选出三个数 $i, j, k$（$i \\ne j$，$i \\ne k$，$j \\ne k$），使得 $(a_i + a_j) \\bmod a_k$ 的值最大。", "inputFormat": "第一行，一个整数 $n$，表示数字个数。  \n第二行，$n$ 个整数，表示 $a_i$。", "outputFormat": "输出一行，一个整数，表示答案。", "hint": "对于 $30 \\%$ 的数据，$n \\le 100$。  \n对于 $60 \\%$ 的数据，$n \\le 3000$。  \n对于 $100 \\%$ 的数据，$3 \\le n \\le 2 \\times {10}^5$，$1 \\le a_i \\le {10}^8$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[省选联考 2021 B 卷] 取模", "background": "", "description": "给定 $n$ 个正整数 $a_i$，请你在其中选出三个数 $i, j, k$（$i \\ne j$，$i \\ne k$，$j \\ne k$），使得 $(a_i + a_j) \\bmod a_k$ 的值最大。", "inputFormat": "第一行，一个整数 $n$，表示数字个数。  \n第二行，$n$ 个整数，表示 $a_i$。", "outputFormat": "输出一行，一个整数，表示答案。", "hint": "对于 $30 \\%$ 的数据，$n \\le 100$。  \n对于 $60 \\%$ 的数据，$n \\le 3000$。  \n对于 $100 \\%$ 的数据，$3 \\le n \\le 2 \\times {10}^5$，$1 \\le a_i \\le {10}^8$。", "locale": "zh-CN"}}}
{"pid": "P7522", "type": "P", "difficulty": 3, "samples": [["3\n1 2 3", "4"], ["4\n-4 5 -2 -3", "14"], ["8\n2 0 2 1 0 4 2 3", "14"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["贪心", "2021"], "title": "⎌ Nurture ⎌", "background": "![Nurture](https://mivik.gitee.io/image/nurture_wallpaper.jpg)\n\n> \"I realized I shouldn't write music with the expectation that the productivity or achievement will fix my problems, but instead with the hope that my honest expression will move people the way music moves me.\"\n>\n> — Robinson in a letter to his fans", "description": "Mivik 正在听 Nurture，但这时教练走了进来，Mivik 便假装自己在做这道题。\n\n你有一个长度为 $n$ 的序列 $v$，你每次可以 **取出** 两个数 $a,b$，并把 $a-b$ 添加到序列中。重复操作直到序列中只剩下一个数，你需要求出这个数的最大值。\n\n~~（结果教练一眼秒了这水题，Mivik 因没事刷水题被批判了一番）~~", "inputFormat": "第一行一个正整数 $n$，代表序列的长度。\n\n第二行 $n$ 个整数，第 $i$ 个整数 $v_i$ 代表序列第 $i$ 项的元素。", "outputFormat": "一行一个整数，代表最终剩下的数的最大值。", "hint": "### 样例解释\n\n样例一：第一步取出 $1,2$，并把 $1-2=-1$ 添加到序列中，此时序列为 $[3,-1]$；然后取出 $3,-1$，将 $3-(-1)=4$ 添加到序列中，此时序列只剩下一个数 $4$。可以证明不存在使剩下的数更大的操作方式。\n\n### 数据范围\n\n对于全部数据，有 $1\\le n\\le 3\\cdot 10^5$，$|v_i|\\le 10^9$。\n\nSubtask 1 (15 pts)：保证 $n\\le 3$。\n\nSubtask 2 (30 pts)：保证 $v_i\\ge0$。\n\nSubtask 3 (55 pts)：无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "⎌ Nurture ⎌", "background": "![Nurture](https://mivik.gitee.io/image/nurture_wallpaper.jpg)\n\n> \"I realized I shouldn't write music with the expectation that the productivity or achievement will fix my problems, but instead with the hope that my honest expression will move people the way music moves me.\"\n>\n> — Robinson in a letter to his fans", "description": "Mivik 正在听 Nurture，但这时教练走了进来，Mivik 便假装自己在做这道题。\n\n你有一个长度为 $n$ 的序列 $v$，你每次可以 **取出** 两个数 $a,b$，并把 $a-b$ 添加到序列中。重复操作直到序列中只剩下一个数，你需要求出这个数的最大值。\n\n~~（结果教练一眼秒了这水题，Mivik 因没事刷水题被批判了一番）~~", "inputFormat": "第一行一个正整数 $n$，代表序列的长度。\n\n第二行 $n$ 个整数，第 $i$ 个整数 $v_i$ 代表序列第 $i$ 项的元素。", "outputFormat": "一行一个整数，代表最终剩下的数的最大值。", "hint": "### 样例解释\n\n样例一：第一步取出 $1,2$，并把 $1-2=-1$ 添加到序列中，此时序列为 $[3,-1]$；然后取出 $3,-1$，将 $3-(-1)=4$ 添加到序列中，此时序列只剩下一个数 $4$。可以证明不存在使剩下的数更大的操作方式。\n\n### 数据范围\n\n对于全部数据，有 $1\\le n\\le 3\\cdot 10^5$，$|v_i|\\le 10^9$。\n\nSubtask 1 (15 pts)：保证 $n\\le 3$。\n\nSubtask 2 (30 pts)：保证 $v_i\\ge0$。\n\nSubtask 3 (55 pts)：无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P7523", "type": "P", "difficulty": 3, "samples": [["2 2\noo\nxo", "5"], ["2 2\noo\n?o", "7"], ["3 4\no?o?\n?xox\no?xo", "499122189"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2021"], "title": "Cytoid", "background": "![Welcome to Cytoid!](https://cdn.luogu.com.cn/upload/image_hosting/zzg1blb0.png)\n\n众所周知，尽管很菜，但 colazcy 仍然很喜欢玩 Cytus。", "description": "一天，colazcy 又在越级打谱。不到一分钟，colazcy 把手机一摔，骂道：“什么垃圾铺面！” 于是他准备在 Cytoid 上面做一个自制铺恶心别人。\n\ncolazcy 准备上一波劲爆 $m$ 押，共有 $n$ 排。也就是说，他的铺面是一个 $n\\times m$ 的矩阵，其中每一个位置可以是 Drag 也可以是 Click。colazcy 已经确定了其中一些位置应该是什么元素，但剩下的还没有确定。\n\n但是 colazcy 发现，他铺面对应的矩形如果有一个子矩形中所有元素都是 Drag，那么玩家就可以一直按住糊过去。colazcy 定义一张铺面的简单度为这张铺面对应的矩形中全都是 Drag 的子矩形个数。\n\n现在 colazcy 把他还未完成的铺面给了你，希望你告诉他：如果他等概率随机地把剩下没有决定的元素填成 Drag / Click，最终铺面简单度的期望是多少。不难观察到答案总是一个有理数，你只需要输出这个答案对 $998244353$ 取模的结果。如果你不知道如何将一个有理数对质数取模，可以参考 [有理数取模](https://www.luogu.com.cn/problem/P2613)。", "inputFormat": "第一行两个正整数 $n,m$，分别代表矩阵的行数和列数。\n\n接下来 $n$ 行，第 $i$ 行有一个长度为 $m$ 的字符串，其第 $j$ 位为 `o` 代表这个位置被确定为 Drag，为 `x` 代表其被确定为 Click，为 `?` 表示这个位置还没有确定。", "outputFormat": "一行一个整数，代表简单度的期望对 $998244353$ 取模的结果。", "hint": "### 样例解释\n\n样例一：整个铺面已经确定，而简单度 = 全是 Drag 的子矩阵数目 = $5$。\n\n样例二：只有一个位置没有确定：当这个位置填 Drag 时，简单度为 $9$；当这个位置填 Click 时，简单度为 $5$。则期望简单度为 $\\dfrac{9+5}2=7$。\n\n### 数据范围\n\n对于全部数据，有 $1\\le n,m\\le 100$。\n\nSubtask 1 (15 pts)：保证没有尚未确定的元素（即输入没有 `?`）。\n\nSubtask 2 (15 pts)：保证尚未确定的元素个数 $\\le 3$。\n\nSubtask 3 (30 pts)：保证 $n\\le 30$。\n\nSubtask 4 (40 pts)：无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "Cytoid", "background": "![Welcome to Cytoid!](https://cdn.luogu.com.cn/upload/image_hosting/zzg1blb0.png)\n\n众所周知，尽管很菜，但 colazcy 仍然很喜欢玩 Cytus。", "description": "一天，colazcy 又在越级打谱。不到一分钟，colazcy 把手机一摔，骂道：“什么垃圾铺面！” 于是他准备在 Cytoid 上面做一个自制铺恶心别人。\n\ncolazcy 准备上一波劲爆 $m$ 押，共有 $n$ 排。也就是说，他的铺面是一个 $n\\times m$ 的矩阵，其中每一个位置可以是 Drag 也可以是 Click。colazcy 已经确定了其中一些位置应该是什么元素，但剩下的还没有确定。\n\n但是 colazcy 发现，他铺面对应的矩形如果有一个子矩形中所有元素都是 Drag，那么玩家就可以一直按住糊过去。colazcy 定义一张铺面的简单度为这张铺面对应的矩形中全都是 Drag 的子矩形个数。\n\n现在 colazcy 把他还未完成的铺面给了你，希望你告诉他：如果他等概率随机地把剩下没有决定的元素填成 Drag / Click，最终铺面简单度的期望是多少。不难观察到答案总是一个有理数，你只需要输出这个答案对 $998244353$ 取模的结果。如果你不知道如何将一个有理数对质数取模，可以参考 [有理数取模](https://www.luogu.com.cn/problem/P2613)。", "inputFormat": "第一行两个正整数 $n,m$，分别代表矩阵的行数和列数。\n\n接下来 $n$ 行，第 $i$ 行有一个长度为 $m$ 的字符串，其第 $j$ 位为 `o` 代表这个位置被确定为 Drag，为 `x` 代表其被确定为 Click，为 `?` 表示这个位置还没有确定。", "outputFormat": "一行一个整数，代表简单度的期望对 $998244353$ 取模的结果。", "hint": "### 样例解释\n\n样例一：整个铺面已经确定，而简单度 = 全是 Drag 的子矩阵数目 = $5$。\n\n样例二：只有一个位置没有确定：当这个位置填 Drag 时，简单度为 $9$；当这个位置填 Click 时，简单度为 $5$。则期望简单度为 $\\dfrac{9+5}2=7$。\n\n### 数据范围\n\n对于全部数据，有 $1\\le n,m\\le 100$。\n\nSubtask 1 (15 pts)：保证没有尚未确定的元素（即输入没有 `?`）。\n\nSubtask 2 (15 pts)：保证尚未确定的元素个数 $\\le 3$。\n\nSubtask 3 (30 pts)：保证 $n\\le 30$。\n\nSubtask 4 (40 pts)：无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P7524", "type": "P", "difficulty": 4, "samples": [["1 1", "1"], ["2 2", "4"], ["3 2", "18"], ["10 5", "8647680"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2021", "O2优化"], "title": "魔女的茶会", "background": "“原来如此，这就是你欲望的根本吗，真有意思呢…”\n\n声音在墓穴中传开来，昴猛然回头，眼前的景象却骤然大变：他的四周由昏黑的墙壁变为了一望无际的草坪，起伏着大大小小的山丘；而原本应该是墓穴入口的地方，却有着一张茶桌和两张座椅，与之一齐处在遮阳伞的荫庇下的，还有一位端坐着的黑衣女子。\n\n![初见](https://cdn.luogu.com.cn/upload/image_hosting/umx8vsni.png)\n\n“我好久没有跟人类对话了，就兴奋了点… 我叫艾姬多娜。「强欲魔女」，这样说比较好懂吧？” 女子浅笑着说道。\n\n“… 这是哪里！？我应该在一个黑暗的遗迹中，你是什么时候把我转移过来的？” 昴咬紧了牙，问道。\n\n“很遗憾，你搞错了。你并不是肉体经历了转移，只是被邀请参加我的茶会而已。”\n\n“茶会…？”\n\n“是魔女的茶会哦。”\n\n**[管理员 Mivik 更改了时间线]**", "description": "“那么… 你还准备在那里站多久？趁着茶还没凉赶紧入座吧。”\n\n“可恶… 知道啦知道啦！” 昴走上前去，坐在了魔女对面。桌上除了两杯茶外，还有一副黑白交错的棋盘。\n\n“这是…？” 昴指着棋盘，问道。\n\n“这是魔女棋哦。我请你过来是为了解答我沉思多年都无法解决的一个问题。如果你解决了它，我就会给你和爱蜜莉雅参加试炼的权利… 否则…”令人不安的笑容浮现在魔女脸上，“你可能就会在圣域里无穷地轮回哦…？”\n\n昴出了一身冷汗，战战兢兢地问道：“那么问题是？”\n\n魔女拾起了身边的一个棋子，缓缓说道：“如你所见，这是一张 $n\\times n$ 的棋盘，由 $n^2$ 个方格组成，每个方格上最多只能存在一个棋子。**不同于普通的棋盘，这个棋盘是循环的，也就是说，第 $i$ 行 $n$ 列的格子右边是第 $i$ 行 $1$ 列的格子，第 $n$ 行 $i$ 列的格子下面是第 $1$ 行 $i$ 列的格子，以此类推。** 我手中的棋子名叫「大罪司教」，它一步可以向任意斜线方向移动任意多格。一个棋子能一步走到的格子称为其掌控的格子。如果一个棋子掌控了另一个棋子所在的方格，则这种棋盘布局是不稳定的，反之称其为稳定的。现在，请问你能否向棋盘中放入恰好 $m$ 个「大罪司教」，使得整个棋盘布局是稳定的呢？”\n\n![示例](https://cdn.luogu.com.cn/upload/image_hosting/8d8481wr.png)\n\n[上图高清版](https://cdn.luogu.com.cn/upload/image_hosting/np9zk0t4.png)\n\n昴沉思了一会儿，随后在棋盘上操作，很快就完成了魔女的任务，说道：“那么快给我参加试炼的权利吧！”\n\n魔女说：“不行啦… 我还有一个问题没有解决呢…”\n\n昴：“靠北，你耍赖啊！”\n\n魔女没有理会昴，继续说道：“现在问题是，一共有多少种本质不同的稳定的布局方案，使得布局中恰好有 $m$ 个「大罪司教」呢？两种方案本质不同，当且仅当存在任意一格在一种方案中有棋子而在另一种方案中没有哦。”\n\n昴更加生气，因为他不会做了，他转而求助于你。你只需要告诉他答案对 $998244353$ 取模的结果即可。\n", "inputFormat": "一行两个正整数 $n,m$，代表棋盘的大小和你需要放置的棋子数目。", "outputFormat": "一行一个正整数，代表答案对 $998244353$ 取模的结果。", "hint": "样例一：将一个棋子放入 $1\\times1$ 的棋盘中显然只有一种方案。\n\n样例二：一共有以下四种稳定的布局（用 `.` 代表空位，`o` 代表「大罪司教」）：\n\n```plain\noo .o .. o.\n.. .o oo o.\n```\n\n样例三：所有 $18$ 种稳定的布局可以在 [这里](https://www.luogu.com.cn/paste/obkotkqb) 查看。\n\n### 数据范围\n\n对于全部数据，有 $1\\le n<998244353$，$0\\le m\\le\\min\\{n,10^7\\}$。\n\nSubtask 1 (5 pts)：保证 $m=0$。\n\nSubtask 2 (10 pts)：保证 $m=1$。\n\nSubtask 3 (10 pts)：保证 $1\\le n\\le 4$。\n\nSubtask 4 (20 pts)：保证 $n$ 是奇数。\n\nSubtask 5 (25 pts)：保证 $n\\le 10^7$。\n\nSubtask 6 (30 pts)：无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "魔女的茶会", "background": "“原来如此，这就是你欲望的根本吗，真有意思呢…”\n\n声音在墓穴中传开来，昴猛然回头，眼前的景象却骤然大变：他的四周由昏黑的墙壁变为了一望无际的草坪，起伏着大大小小的山丘；而原本应该是墓穴入口的地方，却有着一张茶桌和两张座椅，与之一齐处在遮阳伞的荫庇下的，还有一位端坐着的黑衣女子。\n\n![初见](https://cdn.luogu.com.cn/upload/image_hosting/umx8vsni.png)\n\n“我好久没有跟人类对话了，就兴奋了点… 我叫艾姬多娜。「强欲魔女」，这样说比较好懂吧？” 女子浅笑着说道。\n\n“… 这是哪里！？我应该在一个黑暗的遗迹中，你是什么时候把我转移过来的？” 昴咬紧了牙，问道。\n\n“很遗憾，你搞错了。你并不是肉体经历了转移，只是被邀请参加我的茶会而已。”\n\n“茶会…？”\n\n“是魔女的茶会哦。”\n\n**[管理员 Mivik 更改了时间线]**", "description": "“那么… 你还准备在那里站多久？趁着茶还没凉赶紧入座吧。”\n\n“可恶… 知道啦知道啦！” 昴走上前去，坐在了魔女对面。桌上除了两杯茶外，还有一副黑白交错的棋盘。\n\n“这是…？” 昴指着棋盘，问道。\n\n“这是魔女棋哦。我请你过来是为了解答我沉思多年都无法解决的一个问题。如果你解决了它，我就会给你和爱蜜莉雅参加试炼的权利… 否则…”令人不安的笑容浮现在魔女脸上，“你可能就会在圣域里无穷地轮回哦…？”\n\n昴出了一身冷汗，战战兢兢地问道：“那么问题是？”\n\n魔女拾起了身边的一个棋子，缓缓说道：“如你所见，这是一张 $n\\times n$ 的棋盘，由 $n^2$ 个方格组成，每个方格上最多只能存在一个棋子。**不同于普通的棋盘，这个棋盘是循环的，也就是说，第 $i$ 行 $n$ 列的格子右边是第 $i$ 行 $1$ 列的格子，第 $n$ 行 $i$ 列的格子下面是第 $1$ 行 $i$ 列的格子，以此类推。** 我手中的棋子名叫「大罪司教」，它一步可以向任意斜线方向移动任意多格。一个棋子能一步走到的格子称为其掌控的格子。如果一个棋子掌控了另一个棋子所在的方格，则这种棋盘布局是不稳定的，反之称其为稳定的。现在，请问你能否向棋盘中放入恰好 $m$ 个「大罪司教」，使得整个棋盘布局是稳定的呢？”\n\n![示例](https://cdn.luogu.com.cn/upload/image_hosting/8d8481wr.png)\n\n[上图高清版](https://cdn.luogu.com.cn/upload/image_hosting/np9zk0t4.png)\n\n昴沉思了一会儿，随后在棋盘上操作，很快就完成了魔女的任务，说道：“那么快给我参加试炼的权利吧！”\n\n魔女说：“不行啦… 我还有一个问题没有解决呢…”\n\n昴：“靠北，你耍赖啊！”\n\n魔女没有理会昴，继续说道：“现在问题是，一共有多少种本质不同的稳定的布局方案，使得布局中恰好有 $m$ 个「大罪司教」呢？两种方案本质不同，当且仅当存在任意一格在一种方案中有棋子而在另一种方案中没有哦。”\n\n昴更加生气，因为他不会做了，他转而求助于你。你只需要告诉他答案对 $998244353$ 取模的结果即可。\n", "inputFormat": "一行两个正整数 $n,m$，代表棋盘的大小和你需要放置的棋子数目。", "outputFormat": "一行一个正整数，代表答案对 $998244353$ 取模的结果。", "hint": "样例一：将一个棋子放入 $1\\times1$ 的棋盘中显然只有一种方案。\n\n样例二：一共有以下四种稳定的布局（用 `.` 代表空位，`o` 代表「大罪司教」）：\n\n```plain\noo .o .. o.\n.. .o oo o.\n```\n\n样例三：所有 $18$ 种稳定的布局可以在 [这里](https://www.luogu.com.cn/paste/obkotkqb) 查看。\n\n### 数据范围\n\n对于全部数据，有 $1\\le n<998244353$，$0\\le m\\le\\min\\{n,10^7\\}$。\n\nSubtask 1 (5 pts)：保证 $m=0$。\n\nSubtask 2 (10 pts)：保证 $m=1$。\n\nSubtask 3 (10 pts)：保证 $1\\le n\\le 4$。\n\nSubtask 4 (20 pts)：保证 $n$ 是奇数。\n\nSubtask 5 (25 pts)：保证 $n\\le 10^7$。\n\nSubtask 6 (30 pts)：无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P7525", "type": "P", "difficulty": 6, "samples": [["7 1\nabcdabc", "10"], ["5 2\nioioi", "11"], ["8 50\nidolidol", "263923940"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2021", "O2优化"], "title": "Shelter", "background": "![Shelter](https://cdn.luogu.com.cn/upload/image_hosting/dng2ysqs.png)\n\n> It's a long way forward, so trust in me\n>\n> I'll give them shelter, like you've done for me\n>\n> And I know, I'm not alone\n>\n> You'll be watching over us, until you're gone", "description": "在太空里的时间，Rin 除了在虚拟世界里自由创作，每天还会进行一个有趣的小游戏。\n\n最初来到太空时，她的父亲留给她了一个由英文小写字母组成的非空的字符串 $s$，其长度为 $n$。每天，Rin 都会找到一个最大的整数 $i$（$0\\le i<|s|$）使得字符串的长度为 $i$ 的前缀与其长度为 $i$ 的后缀相同（注意 $i$ 可能为 $0$），并将这个 前缀 / 后缀 追加在整个字符串的最后面形成新的字符串。例如，当字符串为 `mivikismivik` 时，最大的 $i=5$（字符串长为 $5$ 的前缀后缀皆为 `mivik`），于是 Rin 将 `mivik` 追加在字符串后面形成新字符串 `mivikismivikmivik`。\n\n在太空中度过 $K$ 天后，这个字符串已经变得很长，Rin 突然很好奇这个字符串的长度现在是多少，你能帮帮她吗？由于答案可能很大，你只需要告诉她答案对 $998244353$ 取模的结果即可。", "inputFormat": "第一行两个正整数 $n,K$，分别代表最初字符串的长度和 Rin 在太空中度过的天数。\n\n第二行一个长度为 $n$ 的小写英文字母组成的字符串 $s$，代表 Rin 的父亲留给她的字符串。", "outputFormat": "一行一个整数，代表 $K$ 天后字符串的长度对 $998244353$ 取模的结果。", "hint": "### 样例解释\n\n样例一：操作一次后得到字符串 `abcdabcabc`，长度为 $10$。\n\n样例二：操作一次后得到字符串 `ioioiioi`，再操作一次得到 `ioioiioiioi`，长度为 $11$。\n\n### 数据范围\n\n对于全部数据，有 $1\\le n\\le 2\\cdot 10^6$，$1\\le K\\le 10^{18}$。\n\nSubtask 1 (15 pts)：保证 $s$ 只由一种字母构成。\n\nSubtask 2 (20 pts)：保证 $s$ 有长度不为 $|s|$ 的整周期（即长度是 $|s|$ 的约数的周期）。\n\nSubtask 3 (65 pts)：无特殊限制。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "Shelter", "background": "![Shelter](https://cdn.luogu.com.cn/upload/image_hosting/dng2ysqs.png)\n\n> It's a long way forward, so trust in me\n>\n> I'll give them shelter, like you've done for me\n>\n> And I know, I'm not alone\n>\n> You'll be watching over us, until you're gone", "description": "在太空里的时间，Rin 除了在虚拟世界里自由创作，每天还会进行一个有趣的小游戏。\n\n最初来到太空时，她的父亲留给她了一个由英文小写字母组成的非空的字符串 $s$，其长度为 $n$。每天，Rin 都会找到一个最大的整数 $i$（$0\\le i<|s|$）使得字符串的长度为 $i$ 的前缀与其长度为 $i$ 的后缀相同（注意 $i$ 可能为 $0$），并将这个 前缀 / 后缀 追加在整个字符串的最后面形成新的字符串。例如，当字符串为 `mivikismivik` 时，最大的 $i=5$（字符串长为 $5$ 的前缀后缀皆为 `mivik`），于是 Rin 将 `mivik` 追加在字符串后面形成新字符串 `mivikismivikmivik`。\n\n在太空中度过 $K$ 天后，这个字符串已经变得很长，Rin 突然很好奇这个字符串的长度现在是多少，你能帮帮她吗？由于答案可能很大，你只需要告诉她答案对 $998244353$ 取模的结果即可。", "inputFormat": "第一行两个正整数 $n,K$，分别代表最初字符串的长度和 Rin 在太空中度过的天数。\n\n第二行一个长度为 $n$ 的小写英文字母组成的字符串 $s$，代表 Rin 的父亲留给她的字符串。", "outputFormat": "一行一个整数，代表 $K$ 天后字符串的长度对 $998244353$ 取模的结果。", "hint": "### 样例解释\n\n样例一：操作一次后得到字符串 `abcdabcabc`，长度为 $10$。\n\n样例二：操作一次后得到字符串 `ioioiioi`，再操作一次得到 `ioioiioiioi`，长度为 $11$。\n\n### 数据范围\n\n对于全部数据，有 $1\\le n\\le 2\\cdot 10^6$，$1\\le K\\le 10^{18}$。\n\nSubtask 1 (15 pts)：保证 $s$ 只由一种字母构成。\n\nSubtask 2 (20 pts)：保证 $s$ 有长度不为 $|s|$ 的整周期（即长度是 $|s|$ 的约数的周期）。\n\nSubtask 3 (65 pts)：无特殊限制。\n", "locale": "zh-CN"}}}
{"pid": "P7526", "type": "P", "difficulty": 7, "samples": [["2 2\n0 1 1 1", "5"], ["3 3\n2 0 1 7 1 2 0 1", "320"], ["5 3\n2 0 2 1 0 4 2 3", "1482"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2021", "O2优化"], "title": "Virtual Self", "background": "![Virtual Self](https://cdn.luogu.com.cn/upload/image_hosting/16xzq9r9.png)\n\n> Lately, I've been hearing the cries of the angels when I close my eyes\n>\n> Remember?", "description": "Technic_Angel 想用粒子来制作一支美丽的水晶。Pathselector 告诉她，一支水晶由 $m$ 簇粒子合成，其中每一簇粒子都有美丽度（一个小于 $2^w$ 的非负整数，其中 $w$ 为给定正整数），而一支水晶的美丽度就是合成它的所有粒子的美丽度的异或和。\n\nTechnic_Angel 有许多粒子：对于每一个 $i\\in[0,2^w)\\cap\\Z$，她都有恰好 $v_i$ 簇美丽度为 $i$ 的粒子。现在 Technic_Angel 想要知道，有多少种方案能够合成一支美丽度为 $k$ 的水晶呢？（两种方案不同，当且仅当有一簇粒子在一种方案中被使用而在另一种方案中没有；所有粒子都互不相同）可惜她并不会这个问题，于是她找到了擅长 OI 的你。\n\n在你花 $0.01\\mu s$ 切掉这道题后，异常惊喜的 Technic_Angel 想要让你对所有 $k\\in[0,2^w)\\cap\\Z$ 都解决上面的问题。但由于答案过于巨大，她只要求你告诉她对于所有的 $i$，$((i+1)f(i))\\bmod998244353$ 的异或和，其中 $f(i)$ 代表合成一支美丽度为 $i$ 的水晶的方案数。即\n$$\n(f(0)\\bmod P)\\otimes(2f(1)\\bmod P)\\otimes\\cdots\\otimes(2^wf(2^w-1)\\bmod P)\n$$\n其中 $P=998244353$，$\\otimes$ 代表异或。注意是取模后的异或和而非异或后再取模。", "inputFormat": "第一行两个正整数 $m,w$，分别代表合成水晶所需的粒子数目以及问题中的参数。\n\n第二行 $2^w$ 个正整数，第 $i$ 个整数代表 $v_{i-1}$。", "outputFormat": "一行一个整数，代表 $((i+1)f(i))\\bmod 998244353$ 的异或和。", "hint": "### 样例解释\n\n样例一：Technic_Angel 共有三簇粒子，美丽度分别为 $1,2,3$。用序列表示选出的粒子的美丽度的话，没有合成美丽度为 $0$ 的水晶的方案，而为 $1$、为 $2$ 和为 $3$ 的方案各有一种（分别是 $[2,3]$、$[1,3]$ 和 $[1,2]$），于是答案为 $0\\otimes2\\otimes3\\otimes4=5$。\n\n### 数据范围\n\n令 $n=\\sum v_i$。对于全部数据，有 $0\\le n,v_i<998244353$，$1\\le m\\le\\min\\{n,10^6\\}$，$1\\le w\\le 20$。\n\n| 子任务 |       $n,m,w$       | 特殊性质 | 分值 |\n| :----: | :-----------------: | :------: | :--: |\n|   1    |        $m=1$        |   $A$    |  5   |\n|   2    |   $n\\le200,w\\le8$   |   $A$    |  10  |\n|   3    |        $m=2$        |   $A$    |  20  |\n|   4    |         无          |  $A,B$   |  25  |\n|   5    |         无          |   $A$    |  38  |\n|   6    | $m\\le 60000,w\\le16$ |    无    |  2   |\n\n特殊性质 $A$：$n\\le10^6$。\n\n特殊性质 $B$：$2^w\\cdot m\\le 6\\cdot 10^7$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "Virtual Self", "background": "![Virtual Self](https://cdn.luogu.com.cn/upload/image_hosting/16xzq9r9.png)\n\n> Lately, I've been hearing the cries of the angels when I close my eyes\n>\n> Remember?", "description": "Technic_Angel 想用粒子来制作一支美丽的水晶。Pathselector 告诉她，一支水晶由 $m$ 簇粒子合成，其中每一簇粒子都有美丽度（一个小于 $2^w$ 的非负整数，其中 $w$ 为给定正整数），而一支水晶的美丽度就是合成它的所有粒子的美丽度的异或和。\n\nTechnic_Angel 有许多粒子：对于每一个 $i\\in[0,2^w)\\cap\\Z$，她都有恰好 $v_i$ 簇美丽度为 $i$ 的粒子。现在 Technic_Angel 想要知道，有多少种方案能够合成一支美丽度为 $k$ 的水晶呢？（两种方案不同，当且仅当有一簇粒子在一种方案中被使用而在另一种方案中没有；所有粒子都互不相同）可惜她并不会这个问题，于是她找到了擅长 OI 的你。\n\n在你花 $0.01\\mu s$ 切掉这道题后，异常惊喜的 Technic_Angel 想要让你对所有 $k\\in[0,2^w)\\cap\\Z$ 都解决上面的问题。但由于答案过于巨大，她只要求你告诉她对于所有的 $i$，$((i+1)f(i))\\bmod998244353$ 的异或和，其中 $f(i)$ 代表合成一支美丽度为 $i$ 的水晶的方案数。即\n$$\n(f(0)\\bmod P)\\otimes(2f(1)\\bmod P)\\otimes\\cdots\\otimes(2^wf(2^w-1)\\bmod P)\n$$\n其中 $P=998244353$，$\\otimes$ 代表异或。注意是取模后的异或和而非异或后再取模。", "inputFormat": "第一行两个正整数 $m,w$，分别代表合成水晶所需的粒子数目以及问题中的参数。\n\n第二行 $2^w$ 个正整数，第 $i$ 个整数代表 $v_{i-1}$。", "outputFormat": "一行一个整数，代表 $((i+1)f(i))\\bmod 998244353$ 的异或和。", "hint": "### 样例解释\n\n样例一：Technic_Angel 共有三簇粒子，美丽度分别为 $1,2,3$。用序列表示选出的粒子的美丽度的话，没有合成美丽度为 $0$ 的水晶的方案，而为 $1$、为 $2$ 和为 $3$ 的方案各有一种（分别是 $[2,3]$、$[1,3]$ 和 $[1,2]$），于是答案为 $0\\otimes2\\otimes3\\otimes4=5$。\n\n### 数据范围\n\n令 $n=\\sum v_i$。对于全部数据，有 $0\\le n,v_i<998244353$，$1\\le m\\le\\min\\{n,10^6\\}$，$1\\le w\\le 20$。\n\n| 子任务 |       $n,m,w$       | 特殊性质 | 分值 |\n| :----: | :-----------------: | :------: | :--: |\n|   1    |        $m=1$        |   $A$    |  5   |\n|   2    |   $n\\le200,w\\le8$   |   $A$    |  10  |\n|   3    |        $m=2$        |   $A$    |  20  |\n|   4    |         无          |  $A,B$   |  25  |\n|   5    |         无          |   $A$    |  38  |\n|   6    | $m\\le 60000,w\\le16$ |    无    |  2   |\n\n特殊性质 $A$：$n\\le10^6$。\n\n特殊性质 $B$：$2^w\\cdot m\\le 6\\cdot 10^7$。", "locale": "zh-CN"}}}
{"pid": "P7527", "type": "P", "difficulty": 5, "samples": [["7\n1 2 3 4 3 2 5", "13"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["USACO", "树状数组", "2021"], "title": "[USACO21OPEN] United Cows of Farmer John G", "background": "", "description": "农夫约翰合牛国（The United Cows of Farmer John，UCFJ）将要选派一个代表队参加国际牛学奥林匹克（International bOvine olympIad，IOI）。\n\n有 $N$\n头奶牛参加了代表队选拔。她们站成一行，奶牛 $i$ 的品种为 $b_i$。\n\n代表队将会由包含至少两头奶牛的连续区间组成——也就是说，对于满足 $1\\le l<r\\le N$\n的奶牛 $l\\dots r$。最边上的奶牛会被指定为**领队**。为了避免种内冲突，每一名领队都必须与代表队的其他成员（**包括领队**）品种不同。\n\n请帮助 UCFJ 求出他们可以选派参加 IOI 的代表队的方法数。 ", "inputFormat": "输入的第一行包含 $N$。\n\n第二行包含 $N$ 个整数 $b_1,b_2,\\dots,b_N$，均在范围 $[1,N]$ 之间。 ", "outputFormat": "输出一行表示可能的代表队的数量。", "hint": "#### 样例解释\n\n每一代表队对应以下的一对领队：\n$$(1,2),(1,3),(1,4),(1,7),(2,3),(2,4),(3,4),(4,5),(4,6),(4,7),(5,6),(5,7),(6,7).$$\n\n#### 数据范围与约定\n\n$1\\le N\\le 2\\times 10^5$ 。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21OPEN] United Cows of Farmer John G", "background": "", "description": "农夫约翰合牛国（The United Cows of Farmer John，UCFJ）将要选派一个代表队参加国际牛学奥林匹克（International bOvine olympIad，IOI）。\n\n有 $N$\n头奶牛参加了代表队选拔。她们站成一行，奶牛 $i$ 的品种为 $b_i$。\n\n代表队将会由包含至少两头奶牛的连续区间组成——也就是说，对于满足 $1\\le l<r\\le N$\n的奶牛 $l\\dots r$。最边上的奶牛会被指定为**领队**。为了避免种内冲突，每一名领队都必须与代表队的其他成员（**包括领队**）品种不同。\n\n请帮助 UCFJ 求出他们可以选派参加 IOI 的代表队的方法数。 ", "inputFormat": "输入的第一行包含 $N$。\n\n第二行包含 $N$ 个整数 $b_1,b_2,\\dots,b_N$，均在范围 $[1,N]$ 之间。 ", "outputFormat": "输出一行表示可能的代表队的数量。", "hint": "#### 样例解释\n\n每一代表队对应以下的一对领队：\n$$(1,2),(1,3),(1,4),(1,7),(2,3),(2,4),(3,4),(4,5),(4,6),(4,7),(5,6),(5,7),(6,7).$$\n\n#### 数据范围与约定\n\n$1\\le N\\le 2\\times 10^5$ 。", "locale": "zh-CN"}}}
{"pid": "P7528", "type": "P", "difficulty": 5, "samples": [["5\n10 1 4 8 9\n11 1 2 5 6\n12 9 10 2 3\n3 4 3 6 7\n15 10 8 7 5", "13"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["USACO", "2021", "图论建模", "生成树"], "title": "[USACO21OPEN] Portals G", "background": "", "description": "Bessie 位于一个由 $N$ 个编号为 $1\\dots N$ 的结点以及 $2N$ 个编号为 $1\\cdots 2N$ 的传送门所组成的网络中。每个传送门连接两个不同的结点 $u$ 和 $v$（$u≠v$）。可能有多个传送门连接同一对结点。\n\n每个结点 $v$ 与四个不同的传送门相连。与 $v$ 相连的传送门列表由 $p_v=[p_{v,1},p_{v,2},p_{v,3},p_{v,4}]$ 给出。\n\n你的当前位置可以用有序对（当前结点，当前传送门）表示；即一个有序对 $(v,p_{v,i})$\n，其中 $1\\le v\\le N$ 以及 $1\\le i\\le 4$。你可以使用以下任一操作来改变你的当前位置：\n\n- 1. 由穿过当前传送门来改变当前结点。\n- 2. 改变当前传送门。在每一个结点上，列表的前两个传送门是配对的，后两个传送门也是配对的。也就是说，如果你的当前位置是 $(v,p_{v,2})$，你可以转而使用传送门 $(v,p_{v,1})$，反之亦然。类似地，如果你的当前位置是 $(v,p_{v,3})$，你可以转而使用传送门 $(v,p_{v,4})$，反之亦然。没有其他改变传送门的方式（例如，你**不能**从传送门 $p_{v,2}$ 转去传送门 $p_{v,4}$ ）。\n\n总共有 $4N$ 个不同的位置。不幸的是，并不一定每一个位置都可以从另外的每一个位置经过一系列操作而到达。所以，以 $c_v$ 哞尼的代价，你可以以任意顺序重新排列与 $v$ 相邻的传送门列表。在此之后，列表中的前两个传送门互相配对，同时后两个传送门也互相配对。\n\n例如，如果你将与 $v$ 相邻的传送门以 $[p_{v,3},p_{v,1},p_{v,2},p_{v,4}]$ 的顺序重新排列，这意味着如果你位于结点 $v$ ，\n- 如果你当前位于传送门 $p_{v,1}$ ，你可以转而使用传送门 $p_{v,3}$，反之亦然。\n- 如果你当前位于传送门 $p_{v,2}$ ，你可以转而使用传送门 $p_{v,4}$，反之亦然。\n你不再能够从传送门 $p_{v,1}$\n转至传送门 $p_{v,2}$，或从传送门 $p_{v,3}$ 转至 $p_{v,4}$ ，反之亦然。\n\n计算修改这一网络使得每一个位置都可以从另外的每一个位置到达所需要花费的哞尼的最小数量。输入保证存在至少一种修改网络的合法方式。 ", "inputFormat": "输入的第一行包含 $N$。\n\n以下 $N$ 行每行描述一个结点。第 $v+1$ 行包含五个空格分隔的整数 $c_v,p_{v,1},p_{v,2},p_{v,3},p_{v,4}$。\n\n输入保证对于每一个 $v$ ，$p_{v,1},p_{v,2},p_{v,3},p_{v,4}$ 各不相同，且每个传送门出现在**恰好两个结点**的邻接表中。 ", "outputFormat": "输出一行，包含修改这一网络使得每一个位置都可以从另外的每一个位置到达所需要花费的哞尼的最小数量。 ", "hint": "#### 样例解释\n\n重新排列结点 $1$ 和 $4$ 的邻接表就已足够。这需要总计 $c_1+c_4=13$ 哞尼。我们可以使 $p_1=[1,9,4,8]$ 以及 $p_4=[7,4,6,3]$。 \n\n#### 数据范围与约定\n\n$2\\le N\\le 10^5$，$1\\le c_v\\le 10^3$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21OPEN] Portals G", "background": "", "description": "Bessie 位于一个由 $N$ 个编号为 $1\\dots N$ 的结点以及 $2N$ 个编号为 $1\\cdots 2N$ 的传送门所组成的网络中。每个传送门连接两个不同的结点 $u$ 和 $v$（$u≠v$）。可能有多个传送门连接同一对结点。\n\n每个结点 $v$ 与四个不同的传送门相连。与 $v$ 相连的传送门列表由 $p_v=[p_{v,1},p_{v,2},p_{v,3},p_{v,4}]$ 给出。\n\n你的当前位置可以用有序对（当前结点，当前传送门）表示；即一个有序对 $(v,p_{v,i})$\n，其中 $1\\le v\\le N$ 以及 $1\\le i\\le 4$。你可以使用以下任一操作来改变你的当前位置：\n\n- 1. 由穿过当前传送门来改变当前结点。\n- 2. 改变当前传送门。在每一个结点上，列表的前两个传送门是配对的，后两个传送门也是配对的。也就是说，如果你的当前位置是 $(v,p_{v,2})$，你可以转而使用传送门 $(v,p_{v,1})$，反之亦然。类似地，如果你的当前位置是 $(v,p_{v,3})$，你可以转而使用传送门 $(v,p_{v,4})$，反之亦然。没有其他改变传送门的方式（例如，你**不能**从传送门 $p_{v,2}$ 转去传送门 $p_{v,4}$ ）。\n\n总共有 $4N$ 个不同的位置。不幸的是，并不一定每一个位置都可以从另外的每一个位置经过一系列操作而到达。所以，以 $c_v$ 哞尼的代价，你可以以任意顺序重新排列与 $v$ 相邻的传送门列表。在此之后，列表中的前两个传送门互相配对，同时后两个传送门也互相配对。\n\n例如，如果你将与 $v$ 相邻的传送门以 $[p_{v,3},p_{v,1},p_{v,2},p_{v,4}]$ 的顺序重新排列，这意味着如果你位于结点 $v$ ，\n- 如果你当前位于传送门 $p_{v,1}$ ，你可以转而使用传送门 $p_{v,3}$，反之亦然。\n- 如果你当前位于传送门 $p_{v,2}$ ，你可以转而使用传送门 $p_{v,4}$，反之亦然。\n你不再能够从传送门 $p_{v,1}$\n转至传送门 $p_{v,2}$，或从传送门 $p_{v,3}$ 转至 $p_{v,4}$ ，反之亦然。\n\n计算修改这一网络使得每一个位置都可以从另外的每一个位置到达所需要花费的哞尼的最小数量。输入保证存在至少一种修改网络的合法方式。 ", "inputFormat": "输入的第一行包含 $N$。\n\n以下 $N$ 行每行描述一个结点。第 $v+1$ 行包含五个空格分隔的整数 $c_v,p_{v,1},p_{v,2},p_{v,3},p_{v,4}$。\n\n输入保证对于每一个 $v$ ，$p_{v,1},p_{v,2},p_{v,3},p_{v,4}$ 各不相同，且每个传送门出现在**恰好两个结点**的邻接表中。 ", "outputFormat": "输出一行，包含修改这一网络使得每一个位置都可以从另外的每一个位置到达所需要花费的哞尼的最小数量。 ", "hint": "#### 样例解释\n\n重新排列结点 $1$ 和 $4$ 的邻接表就已足够。这需要总计 $c_1+c_4=13$ 哞尼。我们可以使 $p_1=[1,9,4,8]$ 以及 $p_4=[7,4,6,3]$。 \n\n#### 数据范围与约定\n\n$2\\le N\\le 10^5$，$1\\le c_v\\le 10^3$。", "locale": "zh-CN"}}}
{"pid": "P7529", "type": "P", "difficulty": 6, "samples": [["4\n0 0\n0 4\n1 1\n1 2", "0"], ["4\n0 0\n0 4\n4 0\n1 1", "24"], ["5\n0 0\n0 4\n4 0\n1 1\n1 2", "96"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "USACO", "2021"], "title": "[USACO21OPEN] Permutation G", "background": "", "description": "Bessie 在二维平面上有 $N$ 个最爱的不同的点，其中任意三点均不共线。对于每一个 $1\\le i\\le N$，第 $i$ 个点可以用两个整数 $x_i$ 和 $y_i$ 表示。\n\nBessie 按如下方式在这些点之间画一些线段：\n\n- 1. 她选择这 $N$ 个点的某个排列 $p_1,p_2,\\dots,p_N$ 。\n- 2. 她在点 $p_1$ 和 $p_2$ 、$p_2$ 和 $p_3$、$p_3$ 和 $p_1$ 之间画上线段。\n- 3. 然后依次对于从 $4$ 到 $N$ 的每个整数 $i$，对于所有 $j<i$，她从 $p_i$ 到 $p_j$ 画上一条线段，只要这条线段不与任何已经画上的线段相交（端点位置相交除外）。\n\nBessie 注意到对于每一个 $i$ ，她都画上了恰好三条新的线段。计算 Bessie 在第 $1$ 步可以选择的满足上述性质的排列的数量，结果对 $10^9+7$ 取模。 ", "inputFormat": "输入的第一行包含 $N$。\n\n以下 $N$ 行，每行包含两个空格分隔的整数 $x_i$ 和 $y_i$。 ", "outputFormat": "输出一行一个整数表示方案数对 $10^9+7$ 取模后的结果。", "hint": "#### 样例一解释\n\n没有排列满足该性质\n\n#### 样例二解释\n\n所有排列均满足该性质\n\n#### 样例解释三\n\n一个满足该性质的排列为 $(0,0),(0,4),(4,0),(1,2),(1,1)$ 。对于这个排列，\n\n- 首先，她在 $(0,0),(0,4)$ 和 $(4,0)$ 两两之间画上线段。\n- 然后她从 $(1,2)$ 向 $(0,0)$ ，$(0,4)$ 和 $(4,0)$ 画上线段。\n- 最后，她从 $(1,1)$ 向 $(1,2)$ ，$(4,0)$ 和 $(0,0)$ 画上线段。 \n\n![](http://usaco.org/current/data/fig_permutation_gold_open21.png)\n\n### 数据范围与约定\n\n$3\\le N \\le 40$，$0\\le x_i,y_i \\le 10^4$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21OPEN] Permutation G", "background": "", "description": "Bessie 在二维平面上有 $N$ 个最爱的不同的点，其中任意三点均不共线。对于每一个 $1\\le i\\le N$，第 $i$ 个点可以用两个整数 $x_i$ 和 $y_i$ 表示。\n\nBessie 按如下方式在这些点之间画一些线段：\n\n- 1. 她选择这 $N$ 个点的某个排列 $p_1,p_2,\\dots,p_N$ 。\n- 2. 她在点 $p_1$ 和 $p_2$ 、$p_2$ 和 $p_3$、$p_3$ 和 $p_1$ 之间画上线段。\n- 3. 然后依次对于从 $4$ 到 $N$ 的每个整数 $i$，对于所有 $j<i$，她从 $p_i$ 到 $p_j$ 画上一条线段，只要这条线段不与任何已经画上的线段相交（端点位置相交除外）。\n\nBessie 注意到对于每一个 $i$ ，她都画上了恰好三条新的线段。计算 Bessie 在第 $1$ 步可以选择的满足上述性质的排列的数量，结果对 $10^9+7$ 取模。 ", "inputFormat": "输入的第一行包含 $N$。\n\n以下 $N$ 行，每行包含两个空格分隔的整数 $x_i$ 和 $y_i$。 ", "outputFormat": "输出一行一个整数表示方案数对 $10^9+7$ 取模后的结果。", "hint": "#### 样例一解释\n\n没有排列满足该性质\n\n#### 样例二解释\n\n所有排列均满足该性质\n\n#### 样例解释三\n\n一个满足该性质的排列为 $(0,0),(0,4),(4,0),(1,2),(1,1)$ 。对于这个排列，\n\n- 首先，她在 $(0,0),(0,4)$ 和 $(4,0)$ 两两之间画上线段。\n- 然后她从 $(1,2)$ 向 $(0,0)$ ，$(0,4)$ 和 $(4,0)$ 画上线段。\n- 最后，她从 $(1,1)$ 向 $(1,2)$ ，$(4,0)$ 和 $(0,0)$ 画上线段。 \n\n![](http://usaco.org/current/data/fig_permutation_gold_open21.png)\n\n### 数据范围与约定\n\n$3\\le N \\le 40$，$0\\le x_i,y_i \\le 10^4$", "locale": "zh-CN"}}}
{"pid": "P7530", "type": "P", "difficulty": 6, "samples": [["7\n1 2 3 4 3 2 5", "9"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["线段树", "USACO", "2021", "扫描线"], "title": "[USACO21OPEN] United Cows of Farmer John P", "background": "", "description": "农夫约翰合牛国（The United Cows of Farmer John，UCFJ）将要选派一个代表队参加国际牛学奥林匹克（International bOvine olympIad，IOI）。\n\n有 $N$ 头奶牛参加了代表队选拔。她们站成一行，奶牛 $i$ 的品种为 $b_i$。\n\n代表队将会由包含至少三头奶牛的连续区间组成——也就是说，对于满足 $1\\le l<r\\le N$ 且 $r−l\\ge 2$ 的奶牛 \n$l\\dots r$。选定区间内的三头奶牛将会被指定为领队。出于法律原因，最边上的两头奶牛必须是领队。此外，为了避免种内冲突，每一名领队都必须与代表队的其他成员（包括领队）品种不同。\n\n请帮助 UCFJ 求出（由于纳税原因）他们可以选派参加 IOI 的代表队的方法数。如果两个代表队拥有不同的成员或不同的领队，则被认为是不同的。 ", "inputFormat": "输入的第一行包含 $N$。\n\n第二行包含 $N$ 个整数 $b_1,b_2,\\dots,b_N$，均在范围 $[1,N]$ 之间。", "outputFormat": "输出一行一个整数表示可能的代表队的数量。", "hint": "#### 样例解释\n\n每一代表队对应以下的一组领队：\n\n$$(1,2,3),(1,2,4),(1,3,4),(1,4,7),(2,3,4),(4,5,6),(4,5,7),(4,6,7),(5,6,7).$$\n\n#### 数据范围与约定\n\n$1\\le N\\le 2\\times 10^5$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21OPEN] United Cows of Farmer John P", "background": "", "description": "农夫约翰合牛国（The United Cows of Farmer John，UCFJ）将要选派一个代表队参加国际牛学奥林匹克（International bOvine olympIad，IOI）。\n\n有 $N$ 头奶牛参加了代表队选拔。她们站成一行，奶牛 $i$ 的品种为 $b_i$。\n\n代表队将会由包含至少三头奶牛的连续区间组成——也就是说，对于满足 $1\\le l<r\\le N$ 且 $r−l\\ge 2$ 的奶牛 \n$l\\dots r$。选定区间内的三头奶牛将会被指定为领队。出于法律原因，最边上的两头奶牛必须是领队。此外，为了避免种内冲突，每一名领队都必须与代表队的其他成员（包括领队）品种不同。\n\n请帮助 UCFJ 求出（由于纳税原因）他们可以选派参加 IOI 的代表队的方法数。如果两个代表队拥有不同的成员或不同的领队，则被认为是不同的。 ", "inputFormat": "输入的第一行包含 $N$。\n\n第二行包含 $N$ 个整数 $b_1,b_2,\\dots,b_N$，均在范围 $[1,N]$ 之间。", "outputFormat": "输出一行一个整数表示可能的代表队的数量。", "hint": "#### 样例解释\n\n每一代表队对应以下的一组领队：\n\n$$(1,2,3),(1,2,4),(1,3,4),(1,4,7),(2,3,4),(4,5,6),(4,5,7),(4,6,7),(5,6,7).$$\n\n#### 数据范围与约定\n\n$1\\le N\\le 2\\times 10^5$", "locale": "zh-CN"}}}
{"pid": "P7531", "type": "P", "difficulty": 7, "samples": [["2\n\n8 0\nSS....RR\n00100000\n00100000\n00011000\n00000100\n00000100\n00000011\n00000000\n00000000\n\n13 0\nSSS.RRRSS.RR.\n0001000000000\n0001000000000\n0001000000000\n0000111000000\n0000000000000\n0000000000000\n0000000000000\n0000000001000\n0000000001000\n0000000000110\n0000000000000\n0000000000000\n0000000000000", "4\n12"], ["2\n\n5 1\nSS.RR\n00101\n00100\n10010\n00000\n00000\n\n6 2\nS....R\n001000\n000100\n010001\n000010\n001000\n000000", "3\n1"], ["5\n\n3 2\nRS.\n010\n101\n100\n\n4 2\n.R.S\n0100\n0010\n1000\n0100\n\n4 2\n.SR.\n0000\n0011\n0100\n0010\n\n5 2\n.SSRR\n01000\n10101\n01010\n00000\n00000\n\n6 2\nSS..RR\n001010\n000010\n000010\n000010\n100101\n000000", "2\n1\n2\n6\n24"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["USACO", "2021", "矩阵树定理", "欧拉回路"], "title": "[USACO21OPEN] Routing Schemes P", "background": "", "description": "考虑一个由 $N$ 个编号为 $1\\dots N$ 的结点组成的网络。每个结点被指定为发送者（sender）、接收者（receiver）或两者均不是。发送者的数量 $S$ 与接收者的数量相等（$S≥1$）。\n\n这一网络中结点间的连接关系可以用一系列形式为 $i→j$\n的有向边表示，代表由结点 $i$ 可以路由到结点 $j$。有趣的是，所有的边满足性质 $i<j$，除了 $K$ 条满足 $i>j$（$0≤K≤2$）。网络中没有自环（$i→i$ 形式的边）。\n\n一个「**路由方案**」的描述由 $S$ 条从发送者到接收者的有向路径组成，其中没有两条路径有相同的起止点。也就是说，这些路径将不同的发送者连接到不同的接收者。一条从发送者 $s$ 到接收者 $r$ 的路径可以用一个结点序列\n$s=v_0→v_1→v_2→⋯→v_e=r$ 表示，其中对于所有 $0≤i<e$，有向边 $v_i→v_{i+1}$ 均存在。一个结点可能在同一条路径中出现多于一次。\n\n计算使得每条有向边恰好使用一次的路由方案数量。由于答案可能非常大，输出答案对 $10^9+7$ 取模的结果。输入保证存在至少一种路由方案符合条件。\n\n每个输入包含 $T$ 组需要独立求解的测试用例。", "inputFormat": "输入的第一行包含 $T$，为测试用例的数量。\n\n每个测试用例的第一行包含整数 $N$ 和 $K$。注意 $S$ 并不会在输入中明确给出。\n\n每个测试用例的第二行包含一个长为 $N$ 的字符串。如果第 $i$ 个结点是发送者，则字符串的第 $i$ 个字符为 $\\texttt{S}$，如果第 $i$ 个结点是接收者则为 $\\texttt{R}$，如果第 $i$ 个结点两者均不是则为 $\\texttt{.}$。字符串中 $\\texttt{R}$ 的数量等于 $\\texttt{S}$ 的数量，且至少有一个 $\\texttt{S}$。\n\n每个测试用例的以下 $N$ 行每行包含一个长为 $N$ 的 01 字符串。如果从结点 $i$ 到结点 $j$ 存在一条有向边，则第 $i$ 行的第 $j$ 个字符为 $1$，否则为 $0$。由于不存在自环，矩阵的主对角线仅包含 $0$。除此之外，在主对角线以下恰好有 $K$ 个 $1$ 。\n\n为提高可读性，相邻的测试用例之间用一个空行隔开。 ", "outputFormat": "对每个测试用例，输出每条边使用恰好一次的路由方案的数量，结果对 $10^9+7$ 取模。输入保证对每个测试用例存在至少一种合法的路由方案。 ", "hint": "#### 样例一解释\n\n对于第一个测试用例，网络中的边为 $1→3,2→3,3→4,3→5,4→6,5→6,6→7,6→8$ 。\n\n有四种可能的路由方案：\n\n- $1→3→4→6→7,2→3→5→6→8$\n- $1→3→5→6→7,2→3→4→6→8$\n- $1→3→4→6→8,2→3→5→6→7$\n- $1→3→5→6→8,2→3→4→6→7$\n\n对于第二个测试用例，网络中的边为 $1→4,2→4,3→4,4→5,4→6,4→7,8→10,9→10,10→11,11→12$。\n\n一种可能的路由方案由如下路径组成：\n\n- $1→4→5$\n- $2→4→7$\n- $3→4→6$\n- $8→10→12$\n- $9→10→11$\n\n总的来说，发送者 ${1,2,3}$\n可以路由到接收者 ${5,6,7}$ 的某个排列，发送者 ${8,9}$ 可以路由到接收者 ${11,12}$ 的某个排列，得出答案为 $6\\times 2=12$。 \n\n#### 样例二解释\n\n对于第一个测试用例，网络中的边为 $1→3,1→5,2→3,3→1,3→4$ 。\n\n有三种可能的路由方案：\n\n- $1→3→1→5,2→3→4$\n- $1→3→4,2→3→1→5$\n- $1→5,2→3→1→3→4$\n\n对于第二个测试用例，网络中的边为 $1→3,2→4,3→2,3→6,4→5,5→3$。\n\n只有一种可能的路由方案：$1→3→2→4→5→3→6$\n。 \n\n#### 数据范围和约定\n\n$2\\le N\\le 100$，$1\\le T\\le 20$ , $\\sum N^2\\le 2\\times 10^4$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21OPEN] Routing Schemes P", "background": "", "description": "考虑一个由 $N$ 个编号为 $1\\dots N$ 的结点组成的网络。每个结点被指定为发送者（sender）、接收者（receiver）或两者均不是。发送者的数量 $S$ 与接收者的数量相等（$S≥1$）。\n\n这一网络中结点间的连接关系可以用一系列形式为 $i→j$\n的有向边表示，代表由结点 $i$ 可以路由到结点 $j$。有趣的是，所有的边满足性质 $i<j$，除了 $K$ 条满足 $i>j$（$0≤K≤2$）。网络中没有自环（$i→i$ 形式的边）。\n\n一个「**路由方案**」的描述由 $S$ 条从发送者到接收者的有向路径组成，其中没有两条路径有相同的起止点。也就是说，这些路径将不同的发送者连接到不同的接收者。一条从发送者 $s$ 到接收者 $r$ 的路径可以用一个结点序列\n$s=v_0→v_1→v_2→⋯→v_e=r$ 表示，其中对于所有 $0≤i<e$，有向边 $v_i→v_{i+1}$ 均存在。一个结点可能在同一条路径中出现多于一次。\n\n计算使得每条有向边恰好使用一次的路由方案数量。由于答案可能非常大，输出答案对 $10^9+7$ 取模的结果。输入保证存在至少一种路由方案符合条件。\n\n每个输入包含 $T$ 组需要独立求解的测试用例。", "inputFormat": "输入的第一行包含 $T$，为测试用例的数量。\n\n每个测试用例的第一行包含整数 $N$ 和 $K$。注意 $S$ 并不会在输入中明确给出。\n\n每个测试用例的第二行包含一个长为 $N$ 的字符串。如果第 $i$ 个结点是发送者，则字符串的第 $i$ 个字符为 $\\texttt{S}$，如果第 $i$ 个结点是接收者则为 $\\texttt{R}$，如果第 $i$ 个结点两者均不是则为 $\\texttt{.}$。字符串中 $\\texttt{R}$ 的数量等于 $\\texttt{S}$ 的数量，且至少有一个 $\\texttt{S}$。\n\n每个测试用例的以下 $N$ 行每行包含一个长为 $N$ 的 01 字符串。如果从结点 $i$ 到结点 $j$ 存在一条有向边，则第 $i$ 行的第 $j$ 个字符为 $1$，否则为 $0$。由于不存在自环，矩阵的主对角线仅包含 $0$。除此之外，在主对角线以下恰好有 $K$ 个 $1$ 。\n\n为提高可读性，相邻的测试用例之间用一个空行隔开。 ", "outputFormat": "对每个测试用例，输出每条边使用恰好一次的路由方案的数量，结果对 $10^9+7$ 取模。输入保证对每个测试用例存在至少一种合法的路由方案。 ", "hint": "#### 样例一解释\n\n对于第一个测试用例，网络中的边为 $1→3,2→3,3→4,3→5,4→6,5→6,6→7,6→8$ 。\n\n有四种可能的路由方案：\n\n- $1→3→4→6→7,2→3→5→6→8$\n- $1→3→5→6→7,2→3→4→6→8$\n- $1→3→4→6→8,2→3→5→6→7$\n- $1→3→5→6→8,2→3→4→6→7$\n\n对于第二个测试用例，网络中的边为 $1→4,2→4,3→4,4→5,4→6,4→7,8→10,9→10,10→11,11→12$。\n\n一种可能的路由方案由如下路径组成：\n\n- $1→4→5$\n- $2→4→7$\n- $3→4→6$\n- $8→10→12$\n- $9→10→11$\n\n总的来说，发送者 ${1,2,3}$\n可以路由到接收者 ${5,6,7}$ 的某个排列，发送者 ${8,9}$ 可以路由到接收者 ${11,12}$ 的某个排列，得出答案为 $6\\times 2=12$。 \n\n#### 样例二解释\n\n对于第一个测试用例，网络中的边为 $1→3,1→5,2→3,3→1,3→4$ 。\n\n有三种可能的路由方案：\n\n- $1→3→1→5,2→3→4$\n- $1→3→4,2→3→1→5$\n- $1→5,2→3→1→3→4$\n\n对于第二个测试用例，网络中的边为 $1→3,2→4,3→2,3→6,4→5,5→3$。\n\n只有一种可能的路由方案：$1→3→2→4→5→3→6$\n。 \n\n#### 数据范围和约定\n\n$2\\le N\\le 100$，$1\\le T\\le 20$ , $\\sum N^2\\le 2\\times 10^4$。", "locale": "zh-CN"}}}
{"pid": "P7532", "type": "P", "difficulty": 6, "samples": [["2\nGG\nGG", "13"], ["4\nGGGG\nGGGG\nGG.G\nGGGG", "642"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "USACO", "2021", "前缀和"], "title": "[USACO21OPEN] Balanced Subsets  P", "background": "", "description": "Farmer John 的草地可以被看作是由正方形方格组成的巨大的二维方阵（想象一个巨大的棋盘），对于每一个 $1≤i≤N$、$1≤j≤N$，方格可以用有序对 $(i,j)$ 表示。某些方格中含有草。\n\n方格的一个非空子集被称为是「平衡的」，如果以下条件成立：\n\n- 1. 所有子集中的方格均含有草。\n- 2. 子集是四连通的。换句话说，从子集中的任一方格到另一方格均存在一条路径使得路径中的相邻方格均水平或竖直方向上相邻。\n- 3. 如果方格 $(x_1,y)$ 和 $(x_2,y)$（$x_1≤x_2$）存在于子集中，那么所有满足 $x_1≤x≤x_2$ 的方格 $(x,y)$ 也存在于子集中。\n- 4. 如果方格 $(x,y_1)$ 和 $(x,y_2)$（$y_1≤y_2$）存在于子集中，那么所有满足 $y_1≤y≤y_2$ 的方格 $(x,y)$ 也存在于子集中。\n\n计算平衡的子集数量模 $10^9+7$ 的结果。", "inputFormat": "输入的第一行包含 $N$。\n\n以下 $N$ 行每行包含一个长为 $N$ 的字符串。如果方格 $(i,j)$ 中有草，则第 $i$ 行的第 $j$ 个字符为 $\\texttt{G}$，否则为$\\texttt{.}$。 ", "outputFormat": "输出平衡的子集数量模 $10^9+7$ 的结果。 ", "hint": "#### 样例一解释\n\n对于这个测试用例，所有的四连通子集均是平衡的。\n\n```\nG.  .G  ..  ..  GG  .G  ..  G.  GG  .G  G.  GG  GG\n.., .., G., .G, .., .G, GG, G., G., GG, GG, .G, GG\n```\n\n#### 样例二解释\n\n以下是一个符合第二个条件（四连通）但不符合第三个条件的子集的例子： \n\n```\nGG..\n.G..\nGG..\n....\n```\n\n#### 数据范围与约定\n\n$1\\le N \\le 150$ 。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21OPEN] Balanced Subsets  P", "background": "", "description": "Farmer John 的草地可以被看作是由正方形方格组成的巨大的二维方阵（想象一个巨大的棋盘），对于每一个 $1≤i≤N$、$1≤j≤N$，方格可以用有序对 $(i,j)$ 表示。某些方格中含有草。\n\n方格的一个非空子集被称为是「平衡的」，如果以下条件成立：\n\n- 1. 所有子集中的方格均含有草。\n- 2. 子集是四连通的。换句话说，从子集中的任一方格到另一方格均存在一条路径使得路径中的相邻方格均水平或竖直方向上相邻。\n- 3. 如果方格 $(x_1,y)$ 和 $(x_2,y)$（$x_1≤x_2$）存在于子集中，那么所有满足 $x_1≤x≤x_2$ 的方格 $(x,y)$ 也存在于子集中。\n- 4. 如果方格 $(x,y_1)$ 和 $(x,y_2)$（$y_1≤y_2$）存在于子集中，那么所有满足 $y_1≤y≤y_2$ 的方格 $(x,y)$ 也存在于子集中。\n\n计算平衡的子集数量模 $10^9+7$ 的结果。", "inputFormat": "输入的第一行包含 $N$。\n\n以下 $N$ 行每行包含一个长为 $N$ 的字符串。如果方格 $(i,j)$ 中有草，则第 $i$ 行的第 $j$ 个字符为 $\\texttt{G}$，否则为$\\texttt{.}$。 ", "outputFormat": "输出平衡的子集数量模 $10^9+7$ 的结果。 ", "hint": "#### 样例一解释\n\n对于这个测试用例，所有的四连通子集均是平衡的。\n\n```\nG.  .G  ..  ..  GG  .G  ..  G.  GG  .G  G.  GG  GG\n.., .., G., .G, .., .G, GG, G., G., GG, GG, .G, GG\n```\n\n#### 样例二解释\n\n以下是一个符合第二个条件（四连通）但不符合第三个条件的子集的例子： \n\n```\nGG..\n.G..\nGG..\n....\n```\n\n#### 数据范围与约定\n\n$1\\le N \\le 150$ 。", "locale": "zh-CN"}}}
{"pid": "P7533", "type": "P", "difficulty": 1, "samples": [["1\nAKXAKJXXXAXAQ", "25"], ["4\nXXXAXXXXXXJXX\nKXAXXXQJAXXXX\nAQKQXXXKXXKQX\nJXXXXXJXXXXXX", "40"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2016", "COCI（克罗地亚）"], "title": "[COCI 2016/2017 #4] Bridž", "background": "", "description": "Mirko 发明了一种卡牌游戏。卡牌只包含 $\\text{A, K, Q, J}$ 和 $\\text{X}$。它们的分值分别为 $4,3,2,1,0$。\n\n给定 $N$ 个包含 $13$ 张卡牌的卡组，求这 $N$ 个卡组中所有卡牌分值的总和。", "inputFormat": "第一行，一个整数 $N$。\n\n接下来的 $N$ 行，每行一个长度为 $13$ 的字符串 $K_i$。字符串只包含字符 $\\text{A, K, Q, J, X}$。", "outputFormat": "输出所有卡牌分值的总和。", "hint": "**【样例 1 解释】**\n\n|卡牌类型|卡牌数量|每张卡牌分值|累计分值|\n| :----------: | :----------: | :----------: | :----------: |\n|$\\text{A}$|$4$|$4$|$4 \\times 4=16$|\n|$\\text{K}$|$2$|$3$|$2 \\times 3=6$|\n|$\\text{Q}$|$1$|$2$|$1 \\times 2=2$|\n|$\\text{J}$|$1$|$1$|$1 \\times 1=1$|\n|$\\text{X}$|$5$|$0$|$5 \\times 0=0$|\n\n因此分值总和为 $16+6+2+1+0=25$。\n\n**【数据规模与约定】**\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 10^4$。\n\n**【提示与说明】**\n\n**题目译自 [COCI 2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #4](https://hsin.hr/coci/archive/2016_2017/contest4_tasks.pdf) _T1 Bridž_。**\n\n**本题分值按 COCI 原题设置，满分 $50$。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2016/2017 #4] Bridž", "background": "", "description": "Mirko 发明了一种卡牌游戏。卡牌只包含 $\\text{A, K, Q, J}$ 和 $\\text{X}$。它们的分值分别为 $4,3,2,1,0$。\n\n给定 $N$ 个包含 $13$ 张卡牌的卡组，求这 $N$ 个卡组中所有卡牌分值的总和。", "inputFormat": "第一行，一个整数 $N$。\n\n接下来的 $N$ 行，每行一个长度为 $13$ 的字符串 $K_i$。字符串只包含字符 $\\text{A, K, Q, J, X}$。", "outputFormat": "输出所有卡牌分值的总和。", "hint": "**【样例 1 解释】**\n\n|卡牌类型|卡牌数量|每张卡牌分值|累计分值|\n| :----------: | :----------: | :----------: | :----------: |\n|$\\text{A}$|$4$|$4$|$4 \\times 4=16$|\n|$\\text{K}$|$2$|$3$|$2 \\times 3=6$|\n|$\\text{Q}$|$1$|$2$|$1 \\times 2=2$|\n|$\\text{J}$|$1$|$1$|$1 \\times 1=1$|\n|$\\text{X}$|$5$|$0$|$5 \\times 0=0$|\n\n因此分值总和为 $16+6+2+1+0=25$。\n\n**【数据规模与约定】**\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 10^4$。\n\n**【提示与说明】**\n\n**题目译自 [COCI 2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #4](https://hsin.hr/coci/archive/2016_2017/contest4_tasks.pdf) _T1 Bridž_。**\n\n**本题分值按 COCI 原题设置，满分 $50$。**", "locale": "zh-CN"}}}
{"pid": "P7534", "type": "P", "difficulty": 2, "samples": [["4\nZAGREB\nSISAK\nZADAR\nZABOK\nZA", "****B*D*\n*G******\n********\n********"], ["4\nSPLIT\nVINKOVCI\nNOVSKA\nRIJEKA\nVINKO", "********\n********\n********\nV*******"], ["4\nAAAABCD\nAAAABCA\nAAAACDE\nAAAAAAA\nAAAA", "***ABC**\n********\n********\n********"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["模拟", "2016", "COCI（克罗地亚）"], "title": "[COCI 2016/2017 #4] Kartomat", "background": "", "description": "在火车站使用自动售票机时，可以通过其屏幕上的键盘搜寻目的地城市。键盘可抽象为一个 $4 \\times 8$ 的字符矩阵：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ey39vw2o.png)\n\n目前，屏幕上显示着 $N$ 个字符串，表示城市的名称。为了搜寻目的地城市，你依次点击了若干个字母，作为初始字符串。\n\n输入初始字符串之后，屏幕上只会留下以该字符串开头的城市（即留下的城市有一个前缀为初始字符串）。同时，如果通过初始字符串和一个字母不能搜寻到任何一个城市，那么一个 $\\texttt *$ 字符则会代替屏幕上的这个字母。\n\n求在输入初始字符串之后，键盘的最终情况。", "inputFormat": "第一行，一个整数 $N$，表示屏幕上城市的数量。\n\n接下来的 $N$ 行，每行一个只由大写字母组成的字符串，表示一个城市的名称。字符串长度不超过 $100$。\n\n最后一行，输入初始字符串。初始字符串不会与任何一个城市完全相同，且必定是至少一个城市的前缀。", "outputFormat": "输出一个 $4 \\times 8$ 的字符矩阵，表示键盘的最终情况。", "hint": "**【样例 1 解释】**\n\n在输入初始字符串 $\\texttt{ZA}$ 之后，键盘上剩下的字母只有 $\\texttt{B,D,G}$。\n\n|初始字符串|剩余字母|新字符串|可搜寻城市|\n| :----------: | :----------: | :----------: | :----------: |\n|$\\texttt{ZA}$|$\\texttt B$|$\\texttt{ZAB}$|$\\texttt{ZABOK}$|\n|$\\texttt{ZA}$|$\\texttt D$|$\\texttt{ZAD}$|$\\texttt{ZADAR}$|\n|$\\texttt{ZA}$|$\\texttt G$|$\\texttt{ZAG}$|$\\texttt{ZAGREB}$|\n\n而初始字符串与其它字母所构成的新字符串不能搜寻到任何一个其它城市，因此它们将会从屏幕上消失，变为 $\\texttt *$ 字符。\n\n**【数据规模与约定】**\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 50$。\n\n**【提示与说明】**\n\n**题目译自 [COCI 2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #4](https://hsin.hr/coci/archive/2016_2017/contest4_tasks.pdf) _T2 Kartomat_。**\n\n**本题分值按 COCI 原题设置，满分 $80$。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2016/2017 #4] Kartomat", "background": "", "description": "在火车站使用自动售票机时，可以通过其屏幕上的键盘搜寻目的地城市。键盘可抽象为一个 $4 \\times 8$ 的字符矩阵：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ey39vw2o.png)\n\n目前，屏幕上显示着 $N$ 个字符串，表示城市的名称。为了搜寻目的地城市，你依次点击了若干个字母，作为初始字符串。\n\n输入初始字符串之后，屏幕上只会留下以该字符串开头的城市（即留下的城市有一个前缀为初始字符串）。同时，如果通过初始字符串和一个字母不能搜寻到任何一个城市，那么一个 $\\texttt *$ 字符则会代替屏幕上的这个字母。\n\n求在输入初始字符串之后，键盘的最终情况。", "inputFormat": "第一行，一个整数 $N$，表示屏幕上城市的数量。\n\n接下来的 $N$ 行，每行一个只由大写字母组成的字符串，表示一个城市的名称。字符串长度不超过 $100$。\n\n最后一行，输入初始字符串。初始字符串不会与任何一个城市完全相同，且必定是至少一个城市的前缀。", "outputFormat": "输出一个 $4 \\times 8$ 的字符矩阵，表示键盘的最终情况。", "hint": "**【样例 1 解释】**\n\n在输入初始字符串 $\\texttt{ZA}$ 之后，键盘上剩下的字母只有 $\\texttt{B,D,G}$。\n\n|初始字符串|剩余字母|新字符串|可搜寻城市|\n| :----------: | :----------: | :----------: | :----------: |\n|$\\texttt{ZA}$|$\\texttt B$|$\\texttt{ZAB}$|$\\texttt{ZABOK}$|\n|$\\texttt{ZA}$|$\\texttt D$|$\\texttt{ZAD}$|$\\texttt{ZADAR}$|\n|$\\texttt{ZA}$|$\\texttt G$|$\\texttt{ZAG}$|$\\texttt{ZAGREB}$|\n\n而初始字符串与其它字母所构成的新字符串不能搜寻到任何一个其它城市，因此它们将会从屏幕上消失，变为 $\\texttt *$ 字符。\n\n**【数据规模与约定】**\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 50$。\n\n**【提示与说明】**\n\n**题目译自 [COCI 2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #4](https://hsin.hr/coci/archive/2016_2017/contest4_tasks.pdf) _T2 Kartomat_。**\n\n**本题分值按 COCI 原题设置，满分 $80$。**", "locale": "zh-CN"}}}
{"pid": "P7535", "type": "P", "difficulty": 4, "samples": [["4\n2\n3\n1\n6", "6"], ["5\n2\n3\n5\n8\n13", "18"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "2016", "COCI（克罗地亚）"], "title": "[COCI 2016/2017 #4] Kas", "background": "", "description": "Kile 和 Pogi 在路上捡到了 $N$ 张钞票。他们将分别取走若干张钞票，使得每人所得的总金额相同。同时要尽可能保证分得的总金额最大。\n\n接着，他们会带着剩下的钞票前往赌场。由于他们的运气很好，因此他们将剩余金额作为赌注后，会得到双倍的金额。然后，他们会将得到的金额再次平分，并加入每个人的总金额中。\n\n求每个人能够分得的总金额是多少。", "inputFormat": "第一行，一个整数 $N$。\n\n接下来的 $N$ 行，每行一个正整数 $c_i$，表示第 $i$ 张钞票的面额。保证 $N$ 张钞票的总金额不超过 $10^5$。", "outputFormat": "输出每个人能够分得的总金额。", "hint": "**【样例 1 解释】**\n\nKile 可以选择取走面额分别为 $2,3,1$ 的钞票，而 Pogi 可以取走面额为 $6$ 的钞票。由于没有剩余钞票，因此每人所得总金额为 $6$。\n\n**【样例 2 解释】**\n\nKile 可以选择取走面额分别为 $5,8$ 的钞票，而 Pogi 可以取走面额为 $13$ 的钞票。剩下的钞票面额分别为 $2,3$，因此在前往赌场之后，每人所得总金额为 $13+2+3=18$。\n\n**【数据规模与约定】**\n\n对于 $50\\%$ 的数据，$N \\le 13$。\n\n对于 $70\\%$ 的数据，$N \\le 50$，$\\sum c_i \\le 1000$。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 500$。\n\n**【提示与说明】**\n\n**题目译自 [COCI 2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #4](https://hsin.hr/coci/archive/2016_2017/contest4_tasks.pdf) _T3 Kas_。**\n\n**本题分值按 COCI 原题设置，满分 $100$。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2016/2017 #4] Kas", "background": "", "description": "Kile 和 Pogi 在路上捡到了 $N$ 张钞票。他们将分别取走若干张钞票，使得每人所得的总金额相同。同时要尽可能保证分得的总金额最大。\n\n接着，他们会带着剩下的钞票前往赌场。由于他们的运气很好，因此他们将剩余金额作为赌注后，会得到双倍的金额。然后，他们会将得到的金额再次平分，并加入每个人的总金额中。\n\n求每个人能够分得的总金额是多少。", "inputFormat": "第一行，一个整数 $N$。\n\n接下来的 $N$ 行，每行一个正整数 $c_i$，表示第 $i$ 张钞票的面额。保证 $N$ 张钞票的总金额不超过 $10^5$。", "outputFormat": "输出每个人能够分得的总金额。", "hint": "**【样例 1 解释】**\n\nKile 可以选择取走面额分别为 $2,3,1$ 的钞票，而 Pogi 可以取走面额为 $6$ 的钞票。由于没有剩余钞票，因此每人所得总金额为 $6$。\n\n**【样例 2 解释】**\n\nKile 可以选择取走面额分别为 $5,8$ 的钞票，而 Pogi 可以取走面额为 $13$ 的钞票。剩下的钞票面额分别为 $2,3$，因此在前往赌场之后，每人所得总金额为 $13+2+3=18$。\n\n**【数据规模与约定】**\n\n对于 $50\\%$ 的数据，$N \\le 13$。\n\n对于 $70\\%$ 的数据，$N \\le 50$，$\\sum c_i \\le 1000$。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 500$。\n\n**【提示与说明】**\n\n**题目译自 [COCI 2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #4](https://hsin.hr/coci/archive/2016_2017/contest4_tasks.pdf) _T3 Kas_。**\n\n**本题分值按 COCI 原题设置，满分 $100$。**", "locale": "zh-CN"}}}
{"pid": "P7536", "type": "P", "difficulty": 6, "samples": [["4\n1 2\n1\n1.4\n1.5\n2", "0.5\n0.7"], ["5\n10 25\n12\n13.5\n18\n20.25\n24", "6.0\n6.75"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["搜索", "贪心", "2016", "Special Judge", "其它技巧", "随机化", "COCI（克罗地亚）"], "title": "[COCI 2016/2017 #4] Rekonstruiraj", "background": "", "description": "给定一个闭区间 $[A,B]$ 和一个空的初始集合。每次操作，选定一个实数 $x$，并将 $0,x,2x,3x,4x,\\cdots$ 中所有在闭区间 $[A,B]$ 内的实数加入集合（集合中重复的数将只保留一个）。\n\n现在给定最终集合内的所有实数，求一种方案，使得在操作次数最少的情况下，初始集合在操作之后与输入集合相同。", "inputFormat": "第一行，一个整数 $K$，表示最终集合中的实数个数。\n\n第二行，两个整数 $A,B$，表示将加入闭区间 $[A,B]$ 内的实数。\n\n接下来的 $K$ 行，每行一个小数点后不超过 $5$ 位的实数。保证这 $K$ 个实数单调递增。", "outputFormat": "输出 $N$ 行，其中 $N$ 为该方案的操作次数。\n\n接下来的 $N$ 行，每行一个实数。这 $N$ 个实数依次表示 $N$ 次操作所选定的实数。输出顺序不限。\n\n如果有多种符合题意的方案，请输出操作次数最少的一种。如果有多种操作次数最小的方案，请输出任意一种。", "hint": "**【样例 1 解释】**\n\n另外一种符合题意的方案是选定实数 $0.5$ 和 $1.4$。\n\n**【数据规模与约定】**\n\n对于 $50\\%$ 的数据，所有输入的整数均为自然数。\n\n对于 $100\\%$ 的数据，$1 \\le K \\le 50$，$1 \\le A \\le B \\le 10^6$。\n\n**【提示与说明】**\n\n本题使用自行编写的 [Special Judge](https://www.luogu.com.cn/paste/gchfnvo0)，欢迎大家 hack（发题目综合类工单）。\n\n**题目译自 [COCI 2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #4](https://hsin.hr/coci/archive/2016_2017/contest4_tasks.pdf) _T4 Rekonstruiraj_。**\n\n**本题分值按 COCI 原题设置，满分 $120$。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2016/2017 #4] Rekonstruiraj", "background": "", "description": "给定一个闭区间 $[A,B]$ 和一个空的初始集合。每次操作，选定一个实数 $x$，并将 $0,x,2x,3x,4x,\\cdots$ 中所有在闭区间 $[A,B]$ 内的实数加入集合（集合中重复的数将只保留一个）。\n\n现在给定最终集合内的所有实数，求一种方案，使得在操作次数最少的情况下，初始集合在操作之后与输入集合相同。", "inputFormat": "第一行，一个整数 $K$，表示最终集合中的实数个数。\n\n第二行，两个整数 $A,B$，表示将加入闭区间 $[A,B]$ 内的实数。\n\n接下来的 $K$ 行，每行一个小数点后不超过 $5$ 位的实数。保证这 $K$ 个实数单调递增。", "outputFormat": "输出 $N$ 行，其中 $N$ 为该方案的操作次数。\n\n接下来的 $N$ 行，每行一个实数。这 $N$ 个实数依次表示 $N$ 次操作所选定的实数。输出顺序不限。\n\n如果有多种符合题意的方案，请输出操作次数最少的一种。如果有多种操作次数最小的方案，请输出任意一种。", "hint": "**【样例 1 解释】**\n\n另外一种符合题意的方案是选定实数 $0.5$ 和 $1.4$。\n\n**【数据规模与约定】**\n\n对于 $50\\%$ 的数据，所有输入的整数均为自然数。\n\n对于 $100\\%$ 的数据，$1 \\le K \\le 50$，$1 \\le A \\le B \\le 10^6$。\n\n**【提示与说明】**\n\n本题使用自行编写的 [Special Judge](https://www.luogu.com.cn/paste/gchfnvo0)，欢迎大家 hack（发题目综合类工单）。\n\n**题目译自 [COCI 2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #4](https://hsin.hr/coci/archive/2016_2017/contest4_tasks.pdf) _T4 Rekonstruiraj_。**\n\n**本题分值按 COCI 原题设置，满分 $120$。**", "locale": "zh-CN"}}}
{"pid": "P7537", "type": "P", "difficulty": 5, "samples": [["4\nhoni\ntoni\noni\novi", "3"], ["5\nask\npsk\nkrafna\nsk\nk", "4"], ["5\npas\nkompas\nstas\ns\nnemarime", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2016", "树形 DP", "字典树 Trie", "COCI（克罗地亚）"], "title": "[COCI 2016/2017 #4] Rima", "background": null, "description": "规定字符串 $A,B$ 的最长公共后缀的长度为 $\\text{LCS}(A,B)$。\n\n当 $\\text{LCS}(A,B) \\ge \\max(|A|,|B|)-1$ 时，我们认为 $A,B$ 两个字符串押韵。\n\n给定 $N$ 个字符串，要求从中组合出一个长度最长的字符串序列（序列长度为该序列所包含字符串的数量），使得序列中相邻两个字符串押韵。", "inputFormat": "第一行，一个整数 $N$。\n\n接下来的 $N$ 行，每行一个字符串。保证所有字符串互不相同，由小写字母组成，且总长度不超过 $3 \\times 10^6$。", "outputFormat": "输出字符串序列长度的最大值。", "hint": "**【样例 2 解释】**\n\n字符串序列 $\\texttt{ask-psk-sk-k}$ 长度最大，为 $4$。\n\n**【样例 3 解释】**\n\n没有任何两个字符串押韵，因此任何一个字符串都可以单独组成一个序列，答案为 $1$。\n\n**【数据规模与约定】**\n\n对于 $30\\%$ 的数据，$N \\le 18$。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 5 \\times 10^5$。\n\n**【提示与说明】**\n\n**题目译自 [COCI 2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #4](https://hsin.hr/coci/archive/2016_2017/contest4_tasks.pdf) _T5 Rima_。**\n\n**本题分值按 COCI 原题设置，满分 $140$。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2016/2017 #4] Rima", "background": null, "description": "规定字符串 $A,B$ 的最长公共后缀的长度为 $\\text{LCS}(A,B)$。\n\n当 $\\text{LCS}(A,B) \\ge \\max(|A|,|B|)-1$ 时，我们认为 $A,B$ 两个字符串押韵。\n\n给定 $N$ 个字符串，要求从中组合出一个长度最长的字符串序列（序列长度为该序列所包含字符串的数量），使得序列中相邻两个字符串押韵。", "inputFormat": "第一行，一个整数 $N$。\n\n接下来的 $N$ 行，每行一个字符串。保证所有字符串互不相同，由小写字母组成，且总长度不超过 $3 \\times 10^6$。", "outputFormat": "输出字符串序列长度的最大值。", "hint": "**【样例 2 解释】**\n\n字符串序列 $\\texttt{ask-psk-sk-k}$ 长度最大，为 $4$。\n\n**【样例 3 解释】**\n\n没有任何两个字符串押韵，因此任何一个字符串都可以单独组成一个序列，答案为 $1$。\n\n**【数据规模与约定】**\n\n对于 $30\\%$ 的数据，$N \\le 18$。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 5 \\times 10^5$。\n\n**【提示与说明】**\n\n**题目译自 [COCI 2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #4](https://hsin.hr/coci/archive/2016_2017/contest4_tasks.pdf) _T5 Rima_。**\n\n**本题分值按 COCI 原题设置，满分 $140$。**", "locale": "zh-CN"}}}
{"pid": "P7538", "type": "P", "difficulty": 5, "samples": [["1 2 2\nab", "5/16"], ["2 4 3\nhoni\nhsin", "19/512"], ["3 3 10\nban\nana\nnab", "2/27"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2016", "COCI（克罗地亚）"], "title": "[COCI 2016/2017 #4] Osmosmjerka", "background": "", "description": "给定一个 $M \\times N$ 的字母矩阵，以下面的为例：\n\n```plain\nhoni\nhsin\n```\n\n接着我们将其进行无限延伸，得到：\n\n```plain\n...honihonihonihoni...\n...hsinhsinhsinhsin...\n...honihonihonihoni...\n...hsinhsinhsinhsin...\n```\n\n在无限延伸后得到的新矩阵后，我们随机选取其中一个区域的字母，然后再沿着一定的方向连续读取 $K$ 个字母。在独立完成上述操作两次之后，我们会得到两个长度为 $K$ 的字符串。求两个字符串相同的概率。", "inputFormat": "第一行，三个整数 $N,M,K$。\n\n接下来的 $M$ 行，每行 $N$ 个小写字母。保证每行至少有两个不同的字母。", "outputFormat": "以最简分数 $\\texttt{p/q}$ 的形式输出最终概率。", "hint": "**【数据规模与约定】**\n\n对于其中 $100$ 分的数据，$M=N$。\n\n对于 $100\\%$ 的数据，$1 \\le M,N \\le 500$，$2 \\le K \\le 10^9$。\n\n**【提示与说明】**\n\n**题目译自 [COCI 2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #4](https://hsin.hr/coci/archive/2016_2017/contest4_tasks.pdf) _T6 Osmosmjerka_。**\n\n**本题分值按 COCI 原题设置，满分 $160$。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2016/2017 #4] Osmosmjerka", "background": "", "description": "给定一个 $M \\times N$ 的字母矩阵，以下面的为例：\n\n```plain\nhoni\nhsin\n```\n\n接着我们将其进行无限延伸，得到：\n\n```plain\n...honihonihonihoni...\n...hsinhsinhsinhsin...\n...honihonihonihoni...\n...hsinhsinhsinhsin...\n```\n\n在无限延伸后得到的新矩阵后，我们随机选取其中一个区域的字母，然后再沿着一定的方向连续读取 $K$ 个字母。在独立完成上述操作两次之后，我们会得到两个长度为 $K$ 的字符串。求两个字符串相同的概率。", "inputFormat": "第一行，三个整数 $N,M,K$。\n\n接下来的 $M$ 行，每行 $N$ 个小写字母。保证每行至少有两个不同的字母。", "outputFormat": "以最简分数 $\\texttt{p/q}$ 的形式输出最终概率。", "hint": "**【数据规模与约定】**\n\n对于其中 $100$ 分的数据，$M=N$。\n\n对于 $100\\%$ 的数据，$1 \\le M,N \\le 500$，$2 \\le K \\le 10^9$。\n\n**【提示与说明】**\n\n**题目译自 [COCI 2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #4](https://hsin.hr/coci/archive/2016_2017/contest4_tasks.pdf) _T6 Osmosmjerka_。**\n\n**本题分值按 COCI 原题设置，满分 $160$。**", "locale": "zh-CN"}}}
{"pid": "P7539", "type": "P", "difficulty": 1, "samples": [["1 2 3 4 5 6 7 8", "ascending"], ["8 7 6 5 4 3 2 1", "descending"], ["8 1 7 2 6 3 5 4", "mixed"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["模拟", "2009", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #1] NOTE", "background": "", "description": "C 大调的音阶由 $8$ 个音符组成：$\\texttt{c,d,e,f,g,a,b,C}$。将每个音符用数字 $1$ 到 $8$ 编号。\n\n音阶可以是**升序**的（从 $1$ 到 $8$）、**降序**的（从 $8$ 到 $1$），或者是**混合**的。\n\n根据音符的顺序，确定音阶是升序的、降序的还是混合的。", "inputFormat": "一行八个整数，包含 $1$ 至 $8$ 之间的所有整数。每个整数在输入中只会出现一次。", "outputFormat": "如果音阶是**降序**的，输出 `descending`；\n\n如果音阶是**升序**的，输出 `ascending`；\n\n如果音阶是**混合**的，输出 `mixed`。", "hint": "#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $30$。\n\n题目译自 [**COCI2009-2010 CONTEST #1**](https://hsin.hr/coci/archive/2009_2010/contest1_tasks.pdf) _**T1 NOTE**_。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2009/2010 #1] NOTE", "background": "", "description": "C 大调的音阶由 $8$ 个音符组成：$\\texttt{c,d,e,f,g,a,b,C}$。将每个音符用数字 $1$ 到 $8$ 编号。\n\n音阶可以是**升序**的（从 $1$ 到 $8$）、**降序**的（从 $8$ 到 $1$），或者是**混合**的。\n\n根据音符的顺序，确定音阶是升序的、降序的还是混合的。", "inputFormat": "一行八个整数，包含 $1$ 至 $8$ 之间的所有整数。每个整数在输入中只会出现一次。", "outputFormat": "如果音阶是**降序**的，输出 `descending`；\n\n如果音阶是**升序**的，输出 `ascending`；\n\n如果音阶是**混合**的，输出 `mixed`。", "hint": "#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $30$。\n\n题目译自 [**COCI2009-2010 CONTEST #1**](https://hsin.hr/coci/archive/2009_2010/contest1_tasks.pdf) _**T1 NOTE**_。", "locale": "zh-CN"}}}
{"pid": "P7540", "type": "P", "difficulty": 1, "samples": [["2", "12"], ["3", "30"], ["15", "2040"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2009", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #1] DOMINO", "background": "", "description": "求所有满足 $0 \\le x \\le y \\le N$ 的非负整数对 $(x,y)$ 中，$\\sum{x} + \\sum{y}$ 是多少。", "inputFormat": "一行一个整数 $N$，意义如题面所述。", "outputFormat": "一行一个整数，表示 $\\sum{x} + \\sum{y}$ 的值。", "hint": "#### 【样例 2 解释】\n\n满足要求的所有数对为：$(0,0)$、$(0,1)$、$(0,2)$、$(0,3)$、$(1,1)$、$(1,2)$、$(1,3)$、$(2,2)$、$(2,3)$、$(3,3)。$\n\n#### 【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^3$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $50$。\n\n题目译自 [**COCI2009-2010 CONTEST #1**](https://hsin.hr/coci/archive/2009_2010/contest1_tasks.pdf) _**T2 DOMINO**_。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2009/2010 #1] DOMINO", "background": "", "description": "求所有满足 $0 \\le x \\le y \\le N$ 的非负整数对 $(x,y)$ 中，$\\sum{x} + \\sum{y}$ 是多少。", "inputFormat": "一行一个整数 $N$，意义如题面所述。", "outputFormat": "一行一个整数，表示 $\\sum{x} + \\sum{y}$ 的值。", "hint": "#### 【样例 2 解释】\n\n满足要求的所有数对为：$(0,0)$、$(0,1)$、$(0,2)$、$(0,3)$、$(1,1)$、$(1,2)$、$(1,3)$、$(2,2)$、$(2,3)$、$(3,3)。$\n\n#### 【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^3$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $50$。\n\n题目译自 [**COCI2009-2010 CONTEST #1**](https://hsin.hr/coci/archive/2009_2010/contest1_tasks.pdf) _**T2 DOMINO**_。", "locale": "zh-CN"}}}
{"pid": "P7541", "type": "P", "difficulty": 3, "samples": [["L_V", "5"], ["V__K", "10"], ["JA_BU_K_A", "485"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2009", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #1] DOBRA", "background": "", "description": "Lea 写下了一个单词，之后她把单词中的一些字母用下划线 `_` 替换。接下来 Lea 会用其他字母代替下划线。\n\nLea 认为如果一个单词不包含 $3$ 个及以上**连续的元音字母**、$3$ 个及以上**连续的辅音字母**，并且至少包含**一个**大写字母 `L`，那么这个单词就是**令人愉快**的。\n\n**提示**：元音字母仅包含 $\\texttt{a,e,i,o,u}$，其他的字母都是辅音字母。\n\n求 Lea 有多少种方案将下划线替换成大写字母，使得这个单词是**令人愉快的**。", "inputFormat": "一行一个字符串，表示 Lea 写下的单词。\n\n保证字符串中最多有 $10$ 个下划线，并且只会出现大写字母和下划线。", "outputFormat": "一行一个整数，表示方案数。\n\n**注意：** 你需要使用 $64$ 位有符号整数。在 C/C++ 中使用 `long long`，Pascal 中使用 `int64`。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，字符串长度 $\\le 100$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $70$。\n\n题目译自 [**COCI2009-2010 CONTEST #1**](https://hsin.hr/coci/archive/2009_2010/contest1_tasks.pdf) _**T3 DOBRA**_。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2009/2010 #1] DOBRA", "background": "", "description": "Lea 写下了一个单词，之后她把单词中的一些字母用下划线 `_` 替换。接下来 Lea 会用其他字母代替下划线。\n\nLea 认为如果一个单词不包含 $3$ 个及以上**连续的元音字母**、$3$ 个及以上**连续的辅音字母**，并且至少包含**一个**大写字母 `L`，那么这个单词就是**令人愉快**的。\n\n**提示**：元音字母仅包含 $\\texttt{a,e,i,o,u}$，其他的字母都是辅音字母。\n\n求 Lea 有多少种方案将下划线替换成大写字母，使得这个单词是**令人愉快的**。", "inputFormat": "一行一个字符串，表示 Lea 写下的单词。\n\n保证字符串中最多有 $10$ 个下划线，并且只会出现大写字母和下划线。", "outputFormat": "一行一个整数，表示方案数。\n\n**注意：** 你需要使用 $64$ 位有符号整数。在 C/C++ 中使用 `long long`，Pascal 中使用 `int64`。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，字符串长度 $\\le 100$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $70$。\n\n题目译自 [**COCI2009-2010 CONTEST #1**](https://hsin.hr/coci/archive/2009_2010/contest1_tasks.pdf) _**T3 DOBRA**_。", "locale": "zh-CN"}}}
{"pid": "P7542", "type": "P", "difficulty": 3, "samples": [["3\n2 8\n3 1\n1 4", "10\n10\n9"], ["3\n1 1\n2 2\n3 3", "2\n3\n4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2009", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #1] MALI", "background": "", "description": "Mirko 和 Slavko 正在玩游戏。游戏共有 $N$ 个回合，在第 $k$ 个回合，Slavko 给出两个整数 $A_k$ 和 $B_k$。请你帮助 Mirko 解决以下问题：\n\n前 $k$ 个回合中 Slavko 给出了数字 $A_1,A_2,...,A_k$ 和 $B_1,B_2,...,B_k$。将这些数两两配成 $k$ 个数对 $(A_i,B_j)$（$1 \\le i,j \\le k$），使得序列 $A$ 和序列 $B$ 的每一个数**都只在这些数对中出现一次**，并且使所有数对的**和**（$A_i + B_j$）**的最大值最小**。", "inputFormat": "第一行包含一个整数 $N$，表示游戏的回合数。\n\n接下来 $N$ 行的第 $i$ 行包含两个整数 $A_i,B_i$，表示 Slavko 在第 $i$ 个回合中给出的两个数字。", "outputFormat": "输出 $N$ 行，第 $i$ 行表示第 $i$ 个回合最小的最大数对和。", "hint": "#### 【数据范围】\n\n对于 $50\\%$ 的数据，$1 \\le N \\le 200$。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 10^5$，$1 \\le A_i,B_i \\le 100$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $100$。\n\n题目译自 [**COCI2009-2010 CONTEST #1**](https://hsin.hr/coci/archive/2009_2010/contest1_tasks.pdf) _**T4 MALI**_。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2009/2010 #1] MALI", "background": "", "description": "Mirko 和 Slavko 正在玩游戏。游戏共有 $N$ 个回合，在第 $k$ 个回合，Slavko 给出两个整数 $A_k$ 和 $B_k$。请你帮助 Mirko 解决以下问题：\n\n前 $k$ 个回合中 Slavko 给出了数字 $A_1,A_2,...,A_k$ 和 $B_1,B_2,...,B_k$。将这些数两两配成 $k$ 个数对 $(A_i,B_j)$（$1 \\le i,j \\le k$），使得序列 $A$ 和序列 $B$ 的每一个数**都只在这些数对中出现一次**，并且使所有数对的**和**（$A_i + B_j$）**的最大值最小**。", "inputFormat": "第一行包含一个整数 $N$，表示游戏的回合数。\n\n接下来 $N$ 行的第 $i$ 行包含两个整数 $A_i,B_i$，表示 Slavko 在第 $i$ 个回合中给出的两个数字。", "outputFormat": "输出 $N$ 行，第 $i$ 行表示第 $i$ 个回合最小的最大数对和。", "hint": "#### 【数据范围】\n\n对于 $50\\%$ 的数据，$1 \\le N \\le 200$。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 10^5$，$1 \\le A_i,B_i \\le 100$。\n\n#### 【说明】\n\n本题分值按 COCI 原题设置，满分 $100$。\n\n题目译自 [**COCI2009-2010 CONTEST #1**](https://hsin.hr/coci/archive/2009_2010/contest1_tasks.pdf) _**T4 MALI**_。", "locale": "zh-CN"}}}
{"pid": "P7543", "type": "P", "difficulty": 6, "samples": [["11\nP 1 2\nD 1 3\nP 2 5\nD 7 3\nD 3 7\nP 1 2\nP 3 3\nD 10 11\nP 5 1\nD 14 8\nD 2 4", "2\n5\n4\n1\n6\n2"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2011", "交互题", "Special Judge", "CEOI（中欧）", "最近公共祖先 LCA"], "title": "[CEOI 2011] Treasure Hunt", "background": "", "description": "现在有一棵树，初始时只有一个根节点 $1$，你需要完成下列两种操作：\n\n* `path u s` 表示在 $u$ 下面依次加入了 $s$ 个节点：其中的第 $i$ 个节点作为第 $i-1$ 个节点的孩子（$2\\le i\\le s$），特别地，第 $1$ 个节点会作为 $u$ 的孩子。设加入前时，树中节点的最大编号为 $n$，则新加入的 $s$ 个点会被依次编号为 $n+1,n+2,\\cdots,n+s$；\n* `dig u v` 表示询问 $u,v$ 的中点。形式化地，设 $u,v$ 间的距离为 $d$，则你需要求出 $u,v$的路径上，距离 $u$ 为 $\\lfloor \\frac d2\\rfloor$ 的节点编号。", "inputFormat": "本题是一道交互题，首先你需要从标准输入读入操作次数 $n$。  \n接下来 $n$ 次，你会得到以下两种格式的指令之一：\n\n* `P u s` 表示一次 `path u s` 的操作；\n* `D u v` 表示一次 `dig u v` 的操作。\n\n对于第一种操作，你不需要输出任何东西。对于第二种操作，你必须给出答案并清空缓冲区后，才可以读取后续操作。\n\n在您输出一行后，请清空缓冲区：\n\n- 在 C++ 中，使用 fflush(stdout) 或 cout.flush()。  \n- 在 Pascal 中，使用 flush(output)。  \n- 在 Python 中，使用 stdout.flush()。  \n- 其它语言请自行查阅文档。", "outputFormat": "对于每一次 `D u v` 的操作，输出一行表示答案，保证至少有一次这样的操作。", "hint": "对于 $20\\%$ 的数据，保证最终点的编号最大不超过 $5000$，且 $n\\le 5000$；  \n对于 $50\\%$ 的数据，保证最终点的编号最大不超过 $400\\ 000$；  \n对于 $100\\%$ 的数据，保证最终点的编号最大不超过 $10^9$，且 $n\\le 400\\ 000$。\n\n#### 说明\n题目译自 [CEOI 2011 day 1 T3 _Treasure Hunt_](http://ceoi.inf.elte.hu/probarch/11/trezad.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CEOI 2011] Treasure Hunt", "background": "", "description": "现在有一棵树，初始时只有一个根节点 $1$，你需要完成下列两种操作：\n\n* `path u s` 表示在 $u$ 下面依次加入了 $s$ 个节点：其中的第 $i$ 个节点作为第 $i-1$ 个节点的孩子（$2\\le i\\le s$），特别地，第 $1$ 个节点会作为 $u$ 的孩子。设加入前时，树中节点的最大编号为 $n$，则新加入的 $s$ 个点会被依次编号为 $n+1,n+2,\\cdots,n+s$；\n* `dig u v` 表示询问 $u,v$ 的中点。形式化地，设 $u,v$ 间的距离为 $d$，则你需要求出 $u,v$的路径上，距离 $u$ 为 $\\lfloor \\frac d2\\rfloor$ 的节点编号。", "inputFormat": "本题是一道交互题，首先你需要从标准输入读入操作次数 $n$。  \n接下来 $n$ 次，你会得到以下两种格式的指令之一：\n\n* `P u s` 表示一次 `path u s` 的操作；\n* `D u v` 表示一次 `dig u v` 的操作。\n\n对于第一种操作，你不需要输出任何东西。对于第二种操作，你必须给出答案并清空缓冲区后，才可以读取后续操作。\n\n在您输出一行后，请清空缓冲区：\n\n- 在 C++ 中，使用 fflush(stdout) 或 cout.flush()。  \n- 在 Pascal 中，使用 flush(output)。  \n- 在 Python 中，使用 stdout.flush()。  \n- 其它语言请自行查阅文档。", "outputFormat": "对于每一次 `D u v` 的操作，输出一行表示答案，保证至少有一次这样的操作。", "hint": "对于 $20\\%$ 的数据，保证最终点的编号最大不超过 $5000$，且 $n\\le 5000$；  \n对于 $50\\%$ 的数据，保证最终点的编号最大不超过 $400\\ 000$；  \n对于 $100\\%$ 的数据，保证最终点的编号最大不超过 $10^9$，且 $n\\le 400\\ 000$。\n\n#### 说明\n题目译自 [CEOI 2011 day 1 T3 _Treasure Hunt_](http://ceoi.inf.elte.hu/probarch/11/trezad.pdf)。", "locale": "zh-CN"}}}
{"pid": "P7544", "type": "P", "difficulty": 3, "samples": [["4\nhoni", "1 4"], ["7\nnivelle", "4 7"], ["6\nananas", "1 5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2019", "Special Judge", "COCI（克罗地亚）"], "title": "[COCI 2019/2020 #4] Nivelle", "background": "", "description": "Bojan 看到了 $n$ 个可爱的能吃的毛绒玩具摆在商店的货架上。从序号 $1$ 摆到 $n$。每个毛绒玩具都有 $26$ 中不同的颜色。每种颜色用英文字母 $a...z$ 表示。             \n对于任何一套玩具，我们都可以把它的颜色定义为一套玩具中不同颜色的玩具数量除以一套玩具的总数。            \nBojan 想吃这些玩具，但 Bojan 不喜欢有太多的颜色，所以请你帮助 Bojan 找到一个连续的子序列的玩具，使其色彩数尽可能的少。", "inputFormat": "第一行包含一个正整数 $n$，表示玩具的个数。              \n第二行包含长度为 $n$ 的字符串 $S$，第 $i$ 个字符表示架子上的第 $i$ 个玩具的颜色。", "outputFormat": "输出只有一行，包含两个整数 $l,r$，表示所求连续子序列的左端点及右端点。    \n如果存在多个具有相同颜色数量且颜色最少的连续子序列，则输出任意一个子序列。", "hint": "**数据范围及约定**\n\n**本题采用多测试点捆绑测试，共有 5 个子任务。**\n\n- Subtask 1（7 points）：$1 \\leq n \\leq 100$；\n- Subtask 2（17 points）：$1 \\leq n \\leq 2 \\times 10^3$；\n- Subtask 3（13 points）：字符串 $S$ 中只有两个字符 $a,b$（你可以理解为所有玩具中只有两种颜色）。\n- Subtask 4（25 points）：字符串 $S$ 中只有五个字符 $a,b,c,d,e$（你可以理解为所有玩具中只有五种颜色）。\n- Subtask 5（48 points）：无特别限制。\n\n对于全部的测试点，保证 $1 \\leq n \\leq 10^5，1 \\leq l \\leq r \\leq n$。\n\n【提示与帮助】\n\n**题目译自 [COCI 2019/2020](https://hsin.hr/coci/archive/2019_2020/) [CONTEST #4](https://hsin.hr/coci/archive/2019_2020/contest4_tasks.pdf) T5 Nivelle**\n\n在 COCI 中，本题分值为 $110$ 分。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2019/2020 #4] Nivelle", "background": "", "description": "Bojan 看到了 $n$ 个可爱的能吃的毛绒玩具摆在商店的货架上。从序号 $1$ 摆到 $n$。每个毛绒玩具都有 $26$ 中不同的颜色。每种颜色用英文字母 $a...z$ 表示。             \n对于任何一套玩具，我们都可以把它的颜色定义为一套玩具中不同颜色的玩具数量除以一套玩具的总数。            \nBojan 想吃这些玩具，但 Bojan 不喜欢有太多的颜色，所以请你帮助 Bojan 找到一个连续的子序列的玩具，使其色彩数尽可能的少。", "inputFormat": "第一行包含一个正整数 $n$，表示玩具的个数。              \n第二行包含长度为 $n$ 的字符串 $S$，第 $i$ 个字符表示架子上的第 $i$ 个玩具的颜色。", "outputFormat": "输出只有一行，包含两个整数 $l,r$，表示所求连续子序列的左端点及右端点。    \n如果存在多个具有相同颜色数量且颜色最少的连续子序列，则输出任意一个子序列。", "hint": "**数据范围及约定**\n\n**本题采用多测试点捆绑测试，共有 5 个子任务。**\n\n- Subtask 1（7 points）：$1 \\leq n \\leq 100$；\n- Subtask 2（17 points）：$1 \\leq n \\leq 2 \\times 10^3$；\n- Subtask 3（13 points）：字符串 $S$ 中只有两个字符 $a,b$（你可以理解为所有玩具中只有两种颜色）。\n- Subtask 4（25 points）：字符串 $S$ 中只有五个字符 $a,b,c,d,e$（你可以理解为所有玩具中只有五种颜色）。\n- Subtask 5（48 points）：无特别限制。\n\n对于全部的测试点，保证 $1 \\leq n \\leq 10^5，1 \\leq l \\leq r \\leq n$。\n\n【提示与帮助】\n\n**题目译自 [COCI 2019/2020](https://hsin.hr/coci/archive/2019_2020/) [CONTEST #4](https://hsin.hr/coci/archive/2019_2020/contest4_tasks.pdf) T5 Nivelle**\n\n在 COCI 中，本题分值为 $110$ 分。", "locale": "zh-CN"}}}
{"pid": "P7546", "type": "P", "difficulty": 6, "samples": [["7 2 3 2\nabcbcaa", "15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2014", "北京"], "title": "[BJWC2014] 珠链", "background": "", "description": "Alex 喜欢玩网络游戏，认为这是智力和体力的综合锻炼。在一次游戏活动中，他意外获得了一个传说中威力极其强大的法宝：珠链。 \n\n珠链，顾名思义，就是由许多小珠子串起来的一条链。珠子有很多种颜色。Alex 听说过，只有将珠链打磨纯净，珠链才能发挥最大的威力。 \n\n纯净珠链是指这样的珠链：它可以分成若干个长度相等的段，使任何两段的任何相同位置的珠子的颜色均不同，相同位置指珠子在段内的相对位置相同；而且每段的长度以及划分的段数也是有规范的，Alex 记得，每段包含的珠子数目必须在 $L$ 到 $R$ 之间，而且划分的段数不能少于 $S$。 \n\n所谓打磨，就是从珠链的首和尾拿掉连续的若干个珠子。打磨后的纯净珠链的威力等于它的每个珠子具有的魔力值之和。\n\n一个珠子的魔力值只与它在打磨前的珠链中的位置有关。在查找和分析了大量实验数据以后，Alex 发现珠子的魔力值等于珠子原来位置编号的约数个数！ \n\n兴奋不已的 Alex 想将珠链打磨成威力最大的纯净珠链。然而，马上要参加期末考试的 Alex 来不及计算了，你能否帮助 Alex 算出最大的威力值呢？ ", "inputFormat": "第一行是四个整数 $N,L,R,S$。 \n\n第二行是一个长度等于 $N$ 的字符串，表示 Alex 得到的珠链。字符串的第 $i$ 个字符表示珠链的第 $i$ 个珠子的颜色。相同字母表示相同颜色。珠子的位置从 $1$ 编号到 $N$。\n\n**保证输入的字符串只包含大写和小写的英文字母，并且字母区分大小写。**", "outputFormat": "输出一行，表示打磨后的纯净珠链的最大威力值。\n\n如果无法打磨成满足要求的纯净珠链，输出 `-1`。", "hint": "#### 【样例解释】\n\n能够打磨出的合乎要求的纯净珠链有三种：$\\texttt{bc/aa}$，$\\texttt{abc/bca}$ 和 $\\texttt{bcb/caa}$。其中威力最大的是第三种，其威力值等于 $2 + 2 + 3 + 2 + 4 + 2 = 15$。\n\n如果给出的珠链是纯净珠链，那么可以不打磨。纯净珠链必须能划分成不少于 $S$ 个等长的段且每段长度在 $L$ 到 $R$ 之间。\n\n#### 【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 5 \\cdot 10^5$，$1 \\le L,R,S \\le N$，$0 \\le R - L \\le 10$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BJWC2014] 珠链", "background": "", "description": "Alex 喜欢玩网络游戏，认为这是智力和体力的综合锻炼。在一次游戏活动中，他意外获得了一个传说中威力极其强大的法宝：珠链。 \n\n珠链，顾名思义，就是由许多小珠子串起来的一条链。珠子有很多种颜色。Alex 听说过，只有将珠链打磨纯净，珠链才能发挥最大的威力。 \n\n纯净珠链是指这样的珠链：它可以分成若干个长度相等的段，使任何两段的任何相同位置的珠子的颜色均不同，相同位置指珠子在段内的相对位置相同；而且每段的长度以及划分的段数也是有规范的，Alex 记得，每段包含的珠子数目必须在 $L$ 到 $R$ 之间，而且划分的段数不能少于 $S$。 \n\n所谓打磨，就是从珠链的首和尾拿掉连续的若干个珠子。打磨后的纯净珠链的威力等于它的每个珠子具有的魔力值之和。\n\n一个珠子的魔力值只与它在打磨前的珠链中的位置有关。在查找和分析了大量实验数据以后，Alex 发现珠子的魔力值等于珠子原来位置编号的约数个数！ \n\n兴奋不已的 Alex 想将珠链打磨成威力最大的纯净珠链。然而，马上要参加期末考试的 Alex 来不及计算了，你能否帮助 Alex 算出最大的威力值呢？ ", "inputFormat": "第一行是四个整数 $N,L,R,S$。 \n\n第二行是一个长度等于 $N$ 的字符串，表示 Alex 得到的珠链。字符串的第 $i$ 个字符表示珠链的第 $i$ 个珠子的颜色。相同字母表示相同颜色。珠子的位置从 $1$ 编号到 $N$。\n\n**保证输入的字符串只包含大写和小写的英文字母，并且字母区分大小写。**", "outputFormat": "输出一行，表示打磨后的纯净珠链的最大威力值。\n\n如果无法打磨成满足要求的纯净珠链，输出 `-1`。", "hint": "#### 【样例解释】\n\n能够打磨出的合乎要求的纯净珠链有三种：$\\texttt{bc/aa}$，$\\texttt{abc/bca}$ 和 $\\texttt{bcb/caa}$。其中威力最大的是第三种，其威力值等于 $2 + 2 + 3 + 2 + 4 + 2 = 15$。\n\n如果给出的珠链是纯净珠链，那么可以不打磨。纯净珠链必须能划分成不少于 $S$ 个等长的段且每段长度在 $L$ 到 $R$ 之间。\n\n#### 【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 5 \\cdot 10^5$，$1 \\le L,R,S \\le N$，$0 \\le R - L \\le 10$。", "locale": "zh-CN"}}}
{"pid": "P7547", "type": "P", "difficulty": 5, "samples": [["5 3\n4 2 6 1 3", "24"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2017", "北京"], "title": "[BJWC2017] 太空飞船", "background": "21XX 年，秋。\n\n小诚是 THU（Tomorrow Happy University）航天学院船舶设计系本科四年级的学生。为了顺利毕业，小诚仔细阅读了这几年被引用次数最多的十几篇会议论文，打算在权威理论的指导下设计一艘新型太空飞船。", "description": "这将是一艘环形的太空飞船，由 $N$ 个舱室顺序组成。第 $i$ 个舱室的设计长度为 $L_i$。\n\n为了给飞船提供能量，要在飞船上装置 $K$ 个太空能量吸收器。根据权威理论，这些吸收器应该尽量均匀地分散在飞船表面。也就是说，小诚要把飞船所有 $N$ 个舱室划分成 $K$ 个部分（每个部分包括连续一段舱室），并给每个部分配置一个能量吸收器。设第 $i$ 个部分舱室的长度之和为 $s_i$，则要令方差尽量小。\n\n可是，这个问题对于已经大学四年级的小诚来说太难了。你能否帮助他完成设计呢？为方便起见，输出方差最小值与 $K^2$ 的乘积。", "inputFormat": "输入共两行。\n\n第一行包含两个整数 $N,K$。\n\n第二行包含 $N$ 个以空格分隔的整数 $L_1,L_2,…,L_N$，依次表示每个舱室的长度。", "outputFormat": "输出一行一个整数，表示方差最小值与 $K^2$ 的乘积。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，$N \\le 400$，$K \\le 20$，$1 \\le L_i \\le 10^3$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BJWC2017] 太空飞船", "background": "21XX 年，秋。\n\n小诚是 THU（Tomorrow Happy University）航天学院船舶设计系本科四年级的学生。为了顺利毕业，小诚仔细阅读了这几年被引用次数最多的十几篇会议论文，打算在权威理论的指导下设计一艘新型太空飞船。", "description": "这将是一艘环形的太空飞船，由 $N$ 个舱室顺序组成。第 $i$ 个舱室的设计长度为 $L_i$。\n\n为了给飞船提供能量，要在飞船上装置 $K$ 个太空能量吸收器。根据权威理论，这些吸收器应该尽量均匀地分散在飞船表面。也就是说，小诚要把飞船所有 $N$ 个舱室划分成 $K$ 个部分（每个部分包括连续一段舱室），并给每个部分配置一个能量吸收器。设第 $i$ 个部分舱室的长度之和为 $s_i$，则要令方差尽量小。\n\n可是，这个问题对于已经大学四年级的小诚来说太难了。你能否帮助他完成设计呢？为方便起见，输出方差最小值与 $K^2$ 的乘积。", "inputFormat": "输入共两行。\n\n第一行包含两个整数 $N,K$。\n\n第二行包含 $N$ 个以空格分隔的整数 $L_1,L_2,…,L_N$，依次表示每个舱室的长度。", "outputFormat": "输出一行一个整数，表示方差最小值与 $K^2$ 的乘积。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，$N \\le 400$，$K \\le 20$，$1 \\le L_i \\le 10^3$。", "locale": "zh-CN"}}}
{"pid": "P7548", "type": "P", "difficulty": 0, "samples": [["4 4\n0 1 2 3\n1 2 3 4\n1 2\n1 4\n2 3\n1 3", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2017", "北京"], "title": "[BJWC2017] 星际穿越", "background": "21YY 年，夏。\n\n时过境迁，小诚已是星际联邦（Federation of Planets）太空防御理事会的技术顾问。去年联邦举行大选，新总统刚刚宣誓就任。新政府的主要政策之一是对行政区域进行重新规划，将各个星球之间原有的行政关系精简。", "description": "联邦有 $N$ 个星球，新的行政体系结构形如一个二叉树。联邦的行政中心为首都，其他所有星球分成至多两个区域，每个区域内部又是同样的结构。\n\n在此番行政改革之前，每个星球驻扎着一支太空舰队。其中，第 $i$ 个星球驻扎舰队的战斗力是 $F_i$。\n\n在行政改革的同时，太空防御理事会负责调整各个舰队的驻地，以符合军事条例中要求每个行政区域中心驻扎的舰队是区域内战斗力最强舰队的规定。此外，根据军事条例，舰队调整驻地的方式只有一种，就是两个星球的舰队交换驻防。现在，所有星球之间共有 $M$ 条双向的星际航道。只有存在星际航道的两个星球才能进行舰队换防。\n\n为了节省开支，理事会希望总的换防次数尽量少。早在年初，理事会就委托了小诚制定换防计划，但是小诚至今还未完成任务。你能否帮助小诚，使他免于被解职的命运呢？", "inputFormat": "第一行包含两个以空格分隔的整数 $N,M$。\n\n第二行包含 $N$ 个以空格分隔的整数 $R_1,R_2,…,R_N$，由空格隔开。$R_i$ 表示星球 $i$ 的直属上级星球编号。对于联邦首都，$R_i$ 用 $0$ 表示。\n\n第三行，$N$ 个互不相同的整数 $F_1,F_2,...,F_N$，由空格隔开。其中 $F_i$ 表示当前驻扎在星球 $i$ 的舰队的战斗力。\n\n接下来 $M$ 行，每行两个整数 $X_i,Y_i$，表示在星球 $X_i$ 和星球 $Y_i$ 之间存在一条星际航道。\n\n输入数据保证星球之间的行政关系形成一个二叉树，任何两个星球之间至多有一条星际航道，且星际航道不会出现自环。\n\n数据保证有解。", "outputFormat": "输出一行一个整数，表示总换防次数的最小值。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 12$，$1 \\le M \\le 20$，$1 \\le F_i \\le 100$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BJWC2017] 星际穿越", "background": "21YY 年，夏。\n\n时过境迁，小诚已是星际联邦（Federation of Planets）太空防御理事会的技术顾问。去年联邦举行大选，新总统刚刚宣誓就任。新政府的主要政策之一是对行政区域进行重新规划，将各个星球之间原有的行政关系精简。", "description": "联邦有 $N$ 个星球，新的行政体系结构形如一个二叉树。联邦的行政中心为首都，其他所有星球分成至多两个区域，每个区域内部又是同样的结构。\n\n在此番行政改革之前，每个星球驻扎着一支太空舰队。其中，第 $i$ 个星球驻扎舰队的战斗力是 $F_i$。\n\n在行政改革的同时，太空防御理事会负责调整各个舰队的驻地，以符合军事条例中要求每个行政区域中心驻扎的舰队是区域内战斗力最强舰队的规定。此外，根据军事条例，舰队调整驻地的方式只有一种，就是两个星球的舰队交换驻防。现在，所有星球之间共有 $M$ 条双向的星际航道。只有存在星际航道的两个星球才能进行舰队换防。\n\n为了节省开支，理事会希望总的换防次数尽量少。早在年初，理事会就委托了小诚制定换防计划，但是小诚至今还未完成任务。你能否帮助小诚，使他免于被解职的命运呢？", "inputFormat": "第一行包含两个以空格分隔的整数 $N,M$。\n\n第二行包含 $N$ 个以空格分隔的整数 $R_1,R_2,…,R_N$，由空格隔开。$R_i$ 表示星球 $i$ 的直属上级星球编号。对于联邦首都，$R_i$ 用 $0$ 表示。\n\n第三行，$N$ 个互不相同的整数 $F_1,F_2,...,F_N$，由空格隔开。其中 $F_i$ 表示当前驻扎在星球 $i$ 的舰队的战斗力。\n\n接下来 $M$ 行，每行两个整数 $X_i,Y_i$，表示在星球 $X_i$ 和星球 $Y_i$ 之间存在一条星际航道。\n\n输入数据保证星球之间的行政关系形成一个二叉树，任何两个星球之间至多有一条星际航道，且星际航道不会出现自环。\n\n数据保证有解。", "outputFormat": "输出一行一个整数，表示总换防次数的最小值。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 12$，$1 \\le M \\le 20$，$1 \\le F_i \\le 100$。", "locale": "zh-CN"}}}
{"pid": "P7549", "type": "P", "difficulty": 5, "samples": [["4 3\n5 8 10 2\nmax 1 3\nmin 1 3\nmax 2 4", "5\n2\n8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2017", "北京"], "title": "[BJWC2017] 神秘物质", "background": "21ZZ 年，冬。\n\n小诚退休以后，不知为何重新燃起了对物理学的兴趣。他从研究所借了些实验仪器，整天研究各种微观粒子。", "description": "这一天，小诚刚从研究所得到了一块奇异的陨石样本，便迫不及待地开始观测。在精密仪器的视野下，构成陨石的每个原子都无比清晰。\n\n小诚发现，这些原子排成若干列，每一列的结构具有高度相似性。于是，他决定对单独一列原子进行测量和测试。\n\n被选中的这列共有 $N$ 个顺序排列的原子。最初， 第 $i$ 个原子具有能量 $E_i$。 随着时间推移和人为测试，这列原子在观测上会产生两种变化：\n\n- `merge x e`：当前第 $x$ 个原子和第 $x + 1$ 个原子合并，得到能量为 $e$ 的新原子；\n- `insert x e`：在当前第 $x$ 个原子和第 $x + 1$ 个原子之间插入一个能量为 $e$ 的新原子。\n\n对于一列原子，小诚关心的是相邻一段中能量最大和能量最小的两个原子的能量差值，称为区间极差。因此，除了观测变化外，小诚还要经常统计这列原子的两类数据：\n\n- `max x y`：表示当前第 $x$ 到第 $y$ 个原子之间的任意子区间中区间极差的最大值；\n- `min x y`：表示当前第 $x$ 到第 $y$ 个原子之间的任意子区间中区间极差的最小值。\n\n其中，子区间指的是长度至少是 $2$ 的子区间。\n\n小诚坚信这项研究可以获得诺贝尔物理学奖。为了让小诚早日了结心愿，你能否帮助他实现上述的观测和测量呢？", "inputFormat": "第一行包含两个整数 $N,M$，分别表示最初的原子数目和事件总数。\n\n第二行包含 $N$ 个以空格分隔的整数 $E_1,E_2,...,E_N$，依次表示每个原子的能量。\n\n接下来 $M$ 行，每行为一个字符串和两个整数，描述一次事件，格式见题目描述。", "outputFormat": "输出若干行，按顺序依次表示每次 max 和 min 类事件的测量结果。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 10^5$，$1 \\le M \\le 10^5$，$1 \\le e,E_i \\le 10^9$。\n\n设 $N'$ 为当前时刻原子数目：\n\n- 对于 merge 类事件，$1 \\le x \\le N' - 1$；\n- 对于 insert 类事件，$1 \\le x \\le N'$；\n- 对于 max 和 min 类事件，$1 \\le x < y \\le N'$。\n\n任何时刻，保证 $N' \\ge 2$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BJWC2017] 神秘物质", "background": "21ZZ 年，冬。\n\n小诚退休以后，不知为何重新燃起了对物理学的兴趣。他从研究所借了些实验仪器，整天研究各种微观粒子。", "description": "这一天，小诚刚从研究所得到了一块奇异的陨石样本，便迫不及待地开始观测。在精密仪器的视野下，构成陨石的每个原子都无比清晰。\n\n小诚发现，这些原子排成若干列，每一列的结构具有高度相似性。于是，他决定对单独一列原子进行测量和测试。\n\n被选中的这列共有 $N$ 个顺序排列的原子。最初， 第 $i$ 个原子具有能量 $E_i$。 随着时间推移和人为测试，这列原子在观测上会产生两种变化：\n\n- `merge x e`：当前第 $x$ 个原子和第 $x + 1$ 个原子合并，得到能量为 $e$ 的新原子；\n- `insert x e`：在当前第 $x$ 个原子和第 $x + 1$ 个原子之间插入一个能量为 $e$ 的新原子。\n\n对于一列原子，小诚关心的是相邻一段中能量最大和能量最小的两个原子的能量差值，称为区间极差。因此，除了观测变化外，小诚还要经常统计这列原子的两类数据：\n\n- `max x y`：表示当前第 $x$ 到第 $y$ 个原子之间的任意子区间中区间极差的最大值；\n- `min x y`：表示当前第 $x$ 到第 $y$ 个原子之间的任意子区间中区间极差的最小值。\n\n其中，子区间指的是长度至少是 $2$ 的子区间。\n\n小诚坚信这项研究可以获得诺贝尔物理学奖。为了让小诚早日了结心愿，你能否帮助他实现上述的观测和测量呢？", "inputFormat": "第一行包含两个整数 $N,M$，分别表示最初的原子数目和事件总数。\n\n第二行包含 $N$ 个以空格分隔的整数 $E_1,E_2,...,E_N$，依次表示每个原子的能量。\n\n接下来 $M$ 行，每行为一个字符串和两个整数，描述一次事件，格式见题目描述。", "outputFormat": "输出若干行，按顺序依次表示每次 max 和 min 类事件的测量结果。", "hint": "#### 【数据范围】\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 10^5$，$1 \\le M \\le 10^5$，$1 \\le e,E_i \\le 10^9$。\n\n设 $N'$ 为当前时刻原子数目：\n\n- 对于 merge 类事件，$1 \\le x \\le N' - 1$；\n- 对于 insert 类事件，$1 \\le x \\le N'$；\n- 对于 max 和 min 类事件，$1 \\le x < y \\le N'$。\n\n任何时刻，保证 $N' \\ge 2$。", "locale": "zh-CN"}}}
{"pid": "P7550", "type": "P", "difficulty": 1, "samples": [["4 4\n....\n.#..\n....\n....", "....\n.##.\n.##.\n...."], ["7 7\n.......\n.####..\n.#...#.\n.#...#.\n.#...#.\n.####..\n.......", ".......\n.#####.\n.######\n.##..##\n.##..##\n.######\n.#####."], ["9 7\n.......\n.####..\n.#...#.\n.#...#.\n.####..\n.#.....\n.#.....\n.#.....\n.......", ".......\n.#####.\n.######\n.##..##\n.######\n.#####.\n.##....\n.##....\n.##...."]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000]}, "tags": ["2020", "COCI（克罗地亚）"], "title": "[COCI 2020/2021 #6] Bold", "background": "", "description": "Paula 给 Daniel 写了一封信，她需要加粗文本的字体，以便视力恶化的 Daniel 阅读。\n\n信可以用 `.` 和 `#` 组成的矩阵表示。对于所有信中原有的 `#`，Paula 需要将其向右下方扩展为 $2 \\times 2$ 的 `#`。", "inputFormat": "第一行两个整数 $n, m$，表示信的尺寸。\n\n接下来 $n$ 行，每 $m$ 个字符，表示信的内容。\n\n保证最后一行与最后一列中没有 `#`。", "outputFormat": "$n$ 行，每行 $m$ 个字符，表示加粗后的信。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$2 \\le n, m \\le 10^3$。保证信中只包含 `.` 和 `#`。\n\n------------\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $50$**。\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/archive/2020_2021/) [CONTEST #6](https://hsin.hr/coci/archive/2020_2021/contest6_tasks.pdf) _T1 Bold_**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2020/2021 #6] Bold", "background": "", "description": "Paula 给 Daniel 写了一封信，她需要加粗文本的字体，以便视力恶化的 Daniel 阅读。\n\n信可以用 `.` 和 `#` 组成的矩阵表示。对于所有信中原有的 `#`，Paula 需要将其向右下方扩展为 $2 \\times 2$ 的 `#`。", "inputFormat": "第一行两个整数 $n, m$，表示信的尺寸。\n\n接下来 $n$ 行，每 $m$ 个字符，表示信的内容。\n\n保证最后一行与最后一列中没有 `#`。", "outputFormat": "$n$ 行，每行 $m$ 个字符，表示加粗后的信。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$2 \\le n, m \\le 10^3$。保证信中只包含 `.` 和 `#`。\n\n------------\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $50$**。\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/archive/2020_2021/) [CONTEST #6](https://hsin.hr/coci/archive/2020_2021/contest6_tasks.pdf) _T1 Bold_**。", "locale": "zh-CN"}}}
{"pid": "P7551", "type": "P", "difficulty": 3, "samples": [["3 2\nnovak goat 1\ngoat simulator 3\n2\nnovak simulator\nsimulator goat", "4\nRoger"], ["3 3\nkile legend 4\nlegend beer 5\nbeer kile 6\n2\nkile beer\nlegend kile", "9\n11"], ["4 5\nrafael me 5\nme ow 6\now ausopenfinal 2012\nausopenfinal me 2\nrafael ausopenfinal 2\n3\nrafael me\nme rafael\now me", "4\nRoger\n2014"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["图论", "2020", "离散化", "最短路", "COCI（克罗地亚）"], "title": "[COCI 2020/2021 #6] Alias", "background": "", "description": "Novak 和 Rafael 在玩一个猜单词的游戏。\n\nRafael 脑中有一个包含 $n$ 个单词的数据库。数据库中还有 $m$ 对形如 $x, y, t$ 的链接，表示如果他记起或听到了单词 $x$，他会在 $t$ 毫秒后记起单词 $y$。\n\n游戏将进行 $q$ 轮，每轮游戏相互独立。每一轮游戏开始时，Novak 将说出初始单词 $a$。他想知道，多少毫秒后 Rafael 会记起目标单词 $b$？", "inputFormat": "第一行两个整数 $n, m$。\n\n接下来 $m$ 行每行两个字符串 $x_i, y_i$ 和一个整数 $t_i$，表示一对链接。\n\n接下来一行一个整数 $q$。\n\n接下来 $q$ 行，每行两个字符串 $a_i, b_i$，表示第 $i$ 轮游戏中的初始单词和目标单词。", "outputFormat": "共 $q$ 行，表示每轮游戏的答案。\n\n如果 Rafael 能记起目标单词，输出一个整数，表示所需要的时间。否则，输出 `Roger`。", "hint": "#### 样例 1 解释\n\n第一轮游戏中，Novak 说出单词 `novak`。$1$ 毫秒后，Rafael 记起单词 `goat`。又过了 $3$ 毫秒，他记起目标单词 `simulator`。\n\n第二轮游戏中，Novak 说出单词 `simulator`，但 Rafael 不会记起任何其他单词。\n\n------------\n\n#### 数据规模与约定\n\n对于 $20$ 分的数据，$n \\le 10$。  \n对于 $40$ 分的数据，$n \\le 100$。  \n对于 $100\\%$ 的数据，$2 \\le n \\le 10^3$，$1 \\le m \\le 10^3$，$1 \\le t_i \\le 10^9$，$1 \\le q \\le 10^3$。保证单词的长度不超过 $20$ 且仅含小写字母。\n\n------------\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $70$**。\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/archive/2020_2021/) [CONTEST #6](https://hsin.hr/coci/archive/2020_2021/contest6_tasks.pdf) _T2 Alias_**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2020/2021 #6] Alias", "background": "", "description": "Novak 和 Rafael 在玩一个猜单词的游戏。\n\nRafael 脑中有一个包含 $n$ 个单词的数据库。数据库中还有 $m$ 对形如 $x, y, t$ 的链接，表示如果他记起或听到了单词 $x$，他会在 $t$ 毫秒后记起单词 $y$。\n\n游戏将进行 $q$ 轮，每轮游戏相互独立。每一轮游戏开始时，Novak 将说出初始单词 $a$。他想知道，多少毫秒后 Rafael 会记起目标单词 $b$？", "inputFormat": "第一行两个整数 $n, m$。\n\n接下来 $m$ 行每行两个字符串 $x_i, y_i$ 和一个整数 $t_i$，表示一对链接。\n\n接下来一行一个整数 $q$。\n\n接下来 $q$ 行，每行两个字符串 $a_i, b_i$，表示第 $i$ 轮游戏中的初始单词和目标单词。", "outputFormat": "共 $q$ 行，表示每轮游戏的答案。\n\n如果 Rafael 能记起目标单词，输出一个整数，表示所需要的时间。否则，输出 `Roger`。", "hint": "#### 样例 1 解释\n\n第一轮游戏中，Novak 说出单词 `novak`。$1$ 毫秒后，Rafael 记起单词 `goat`。又过了 $3$ 毫秒，他记起目标单词 `simulator`。\n\n第二轮游戏中，Novak 说出单词 `simulator`，但 Rafael 不会记起任何其他单词。\n\n------------\n\n#### 数据规模与约定\n\n对于 $20$ 分的数据，$n \\le 10$。  \n对于 $40$ 分的数据，$n \\le 100$。  \n对于 $100\\%$ 的数据，$2 \\le n \\le 10^3$，$1 \\le m \\le 10^3$，$1 \\le t_i \\le 10^9$，$1 \\le q \\le 10^3$。保证单词的长度不超过 $20$ 且仅含小写字母。\n\n------------\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $70$**。\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/archive/2020_2021/) [CONTEST #6](https://hsin.hr/coci/archive/2020_2021/contest6_tasks.pdf) _T2 Alias_**。", "locale": "zh-CN"}}}
{"pid": "P7552", "type": "P", "difficulty": 4, "samples": [["3 1\novo\nono\nvoo", "2"], ["5 2\ntrava\nvatra\nvrata\nleo\nole", "3"], ["6 3\nmali\nlima\nimal\nje\nsve\nej", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2020", "COCI（克罗地亚）"], "title": "[COCI 2020/2021 #6] Anagramistica", "background": "", "description": "Biljana 喜欢出字谜游戏。\n\n如果一个单词可以由另一个单词交换字母顺序得到，则称它们是「相似」的。\n\n现在，她有 $n$ 个单词。她希望选出一些单词，使得其中恰好有 $k$ 对单词是「相似」的。请你帮她计算可行的方案数，对 $10^9 + 7$ 取模。", "inputFormat": "第一行两个整数 $n$，$k$。\n\n接下来 $n$ 行，每行一个字符串，表示一个单词。", "outputFormat": "一行一个整数，表示可行的方案数，对 $10^9 + 7$ 取模。", "hint": "#### 样例 1 解释\n\n恰含有一对「相似」的单词的方案为 `ovo, ono, voo` 和 `ovo, voo`。\n\n------------\n\n#### 数据规模与约定\n\n**本题采用捆绑测试**。\n\n| Subtask | 分值 | 数据规模与约定 |\n| :----------: | :----------: | :----------: |\n| $1$ | $10$ | $1 \\le n \\le 15$ |\n| $2$ | $30$ | $0 \\le k \\le 3$ |\n| $3$ | $70$ | 无附加约定 |\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 2 \\times 10^3$，$0 \\le k \\le 2 \\times 10^3$，单词的长度不超过 $10$ 且仅含小写字母。\n\n------------\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $110$**。\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/archive/2020_2021/) [CONTEST #6](https://hsin.hr/coci/archive/2020_2021/contest6_tasks.pdf) _T3 Anagramistica_**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2020/2021 #6] Anagramistica", "background": "", "description": "Biljana 喜欢出字谜游戏。\n\n如果一个单词可以由另一个单词交换字母顺序得到，则称它们是「相似」的。\n\n现在，她有 $n$ 个单词。她希望选出一些单词，使得其中恰好有 $k$ 对单词是「相似」的。请你帮她计算可行的方案数，对 $10^9 + 7$ 取模。", "inputFormat": "第一行两个整数 $n$，$k$。\n\n接下来 $n$ 行，每行一个字符串，表示一个单词。", "outputFormat": "一行一个整数，表示可行的方案数，对 $10^9 + 7$ 取模。", "hint": "#### 样例 1 解释\n\n恰含有一对「相似」的单词的方案为 `ovo, ono, voo` 和 `ovo, voo`。\n\n------------\n\n#### 数据规模与约定\n\n**本题采用捆绑测试**。\n\n| Subtask | 分值 | 数据规模与约定 |\n| :----------: | :----------: | :----------: |\n| $1$ | $10$ | $1 \\le n \\le 15$ |\n| $2$ | $30$ | $0 \\le k \\le 3$ |\n| $3$ | $70$ | 无附加约定 |\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 2 \\times 10^3$，$0 \\le k \\le 2 \\times 10^3$，单词的长度不超过 $10$ 且仅含小写字母。\n\n------------\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $110$**。\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/archive/2020_2021/) [CONTEST #6](https://hsin.hr/coci/archive/2020_2021/contest6_tasks.pdf) _T3 Anagramistica_**。", "locale": "zh-CN"}}}
{"pid": "P7553", "type": "P", "difficulty": 6, "samples": [["4\n1 1\n-1 1\n-1 -1\n1 -1", "4"], ["4\n-1 -1\n1 -1\n0 1\n0 0", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2020", "COCI（克罗地亚）"], "title": "[COCI 2020/2021 #6] Geometrija", "background": "", "description": "平面内有不共线的 $n$ 个点。如果两条线段 $\\overline{AB}$  和 $\\overline{CD}$ 有异于 $A, B, C, D$ 的公共点，则称他们「相交」。\n\n记 $S$ 为 $n$ 个点两两相连得到的线段的集合。求不与 $S$ 中任意其他线段相交的线段数量。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行两个整数 $x_i, y_i$，表示第 $i$ 个点的坐标。", "outputFormat": "一行一个整数，表示满足要求的线段的数量。", "hint": "#### 样例 1 解释\n\n符合要求的线段如图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/hduk6ziy.png)\n\n#### 样例 2 解释\n\n符合要求的线段如图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/21ce6qj8.png)\n\n------------\n\n#### 数据规模与约定\n\n**本题采用捆绑测试**。\n\n| Subtask | 分值 | 数据规模与约定 |\n| :----------: | :----------: | :----------: |\n| $1$ | $20$ | $3 \\le n \\le 40$ |\n| $2$ | $30$ | $3 \\le n \\le 200$ |\n| $3$ | $60$ | 无附加约定 |\n\n对于 $100\\%$ 的数据，$3 \\le n \\le 10^3$，$-10^9 \\le x_i, y_i \\le 10^9$。\n\n------------\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $110$**。\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/archive/2020_2021/) [CONTEST #6](https://hsin.hr/coci/archive/2020_2021/contest6_tasks.pdf) _T4 Geometrija_**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2020/2021 #6] Geometrija", "background": "", "description": "平面内有不共线的 $n$ 个点。如果两条线段 $\\overline{AB}$  和 $\\overline{CD}$ 有异于 $A, B, C, D$ 的公共点，则称他们「相交」。\n\n记 $S$ 为 $n$ 个点两两相连得到的线段的集合。求不与 $S$ 中任意其他线段相交的线段数量。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行两个整数 $x_i, y_i$，表示第 $i$ 个点的坐标。", "outputFormat": "一行一个整数，表示满足要求的线段的数量。", "hint": "#### 样例 1 解释\n\n符合要求的线段如图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/hduk6ziy.png)\n\n#### 样例 2 解释\n\n符合要求的线段如图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/21ce6qj8.png)\n\n------------\n\n#### 数据规模与约定\n\n**本题采用捆绑测试**。\n\n| Subtask | 分值 | 数据规模与约定 |\n| :----------: | :----------: | :----------: |\n| $1$ | $20$ | $3 \\le n \\le 40$ |\n| $2$ | $30$ | $3 \\le n \\le 200$ |\n| $3$ | $60$ | 无附加约定 |\n\n对于 $100\\%$ 的数据，$3 \\le n \\le 10^3$，$-10^9 \\le x_i, y_i \\le 10^9$。\n\n------------\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $110$**。\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/archive/2020_2021/) [CONTEST #6](https://hsin.hr/coci/archive/2020_2021/contest6_tasks.pdf) _T4 Geometrija_**。", "locale": "zh-CN"}}}
{"pid": "P7554", "type": "P", "difficulty": 5, "samples": [["7 6\n3 2 3 1 1 4 7\n3 4\n1 7\n1 6\n4 5\n1 2\n5 7", "1\n3\n3\n1\n2\n2"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2020", "COCI（克罗地亚）"], "title": "[COCI 2020/2021 #6] Index", "background": "", "description": "「H 指数」可以衡量学者论文的数量与引用量。一位学者的「H 指数」为最大的整数 $h$，满足他至少有 $h$ 篇论文被引用了不少于 $h$ 次。\n\nMirko 一共发表了 $n$ 篇论文，而他有 $q$ 个疑问：如果他只发表了第 $l_i$ 篇至第 $r_i$ 篇论文，他的「H 指数」会是多少？", "inputFormat": "第一行两个整数 $n, q$。\n\n第二行 $n$ 个整数 $p_i$，其中 $p_i$ 表示他的第 $i$ 篇论文的引用量。\n\n接下来 $q$ 行，每行两个整数 $l_i, r_i$，表示一个疑问。", "outputFormat": "共 $q$ 行。每行一个整数，表示一个疑问的答案。", "hint": "#### 数据规模与约定\n\n**本题采用捆绑测试**。\n\n| Subtask | 分值 | 数据规模与约定 |\n| :----------: | :----------: | :----------: |\n| $1$ | $20$ | $1 \\le n, q \\le 10^3$ |\n| $2$ | $40$ | $1 \\le n, q \\le 5 \\times 10^4$ |\n| $3$ | $50$ | 无附加约定 |\n\n对于 $100\\%$ 的数据，$1 \\le n, q \\le 2 \\times 10^5$，$1 \\le p_i \\le 2 \\times 10^5$，$1 \\le l_i \\le r_i \\le n$。\n\n------------\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $110$**。\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/archive/2020_2021/) [CONTEST #6](https://hsin.hr/coci/archive/2020_2021/contest6_tasks.pdf) _T5 Index_**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2020/2021 #6] Index", "background": "", "description": "「H 指数」可以衡量学者论文的数量与引用量。一位学者的「H 指数」为最大的整数 $h$，满足他至少有 $h$ 篇论文被引用了不少于 $h$ 次。\n\nMirko 一共发表了 $n$ 篇论文，而他有 $q$ 个疑问：如果他只发表了第 $l_i$ 篇至第 $r_i$ 篇论文，他的「H 指数」会是多少？", "inputFormat": "第一行两个整数 $n, q$。\n\n第二行 $n$ 个整数 $p_i$，其中 $p_i$ 表示他的第 $i$ 篇论文的引用量。\n\n接下来 $q$ 行，每行两个整数 $l_i, r_i$，表示一个疑问。", "outputFormat": "共 $q$ 行。每行一个整数，表示一个疑问的答案。", "hint": "#### 数据规模与约定\n\n**本题采用捆绑测试**。\n\n| Subtask | 分值 | 数据规模与约定 |\n| :----------: | :----------: | :----------: |\n| $1$ | $20$ | $1 \\le n, q \\le 10^3$ |\n| $2$ | $40$ | $1 \\le n, q \\le 5 \\times 10^4$ |\n| $3$ | $50$ | 无附加约定 |\n\n对于 $100\\%$ 的数据，$1 \\le n, q \\le 2 \\times 10^5$，$1 \\le p_i \\le 2 \\times 10^5$，$1 \\le l_i \\le r_i \\le n$。\n\n------------\n\n#### 说明\n\n**本题分值按 COCI 原题设置，满分 $110$**。\n\n**题目译自 [COCI2020-2021](https://hsin.hr/coci/archive/2020_2021/) [CONTEST #6](https://hsin.hr/coci/archive/2020_2021/contest6_tasks.pdf) _T5 Index_**。", "locale": "zh-CN"}}}
{"pid": "P7555", "type": "P", "difficulty": 4, "samples": [["7\n#####################\n###O11###...###M13###\n###......O22......###\n###...######M22######\n###BBB###M31###M11###\n###...O32...M33O31###\n#####################", "8"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["USACO", "2021", "记忆化搜索", "进制"], "title": "[USACO21OPEN] Maze Tac Toe S", "background": "", "description": "奶牛 Bessie 喜欢玩走迷宫。她同样喜欢玩井字棋（更准确地说，奶牛版的井字棋，马上会进行介绍）。Farmer John 找到了一种全新的方式，可以使她同时玩到这两种游戏！\n\n首先，奶牛井字棋：与在 $3 \\times 3$ 棋盘内放置 `X` 和 `O` 不同，奶牛当然是在 $3 \\times 3$ 棋盘内放置 `M` 和 `O`。在一方的回合内，玩家可以选择将一个 `M` 或一个 `O` 放在任意一个空格内（这是另一个与标准井字棋的不同之处，标准的井字棋中一名玩家始终放 `X` 而另一名玩家始终放 `O`）。奶牛井字棋的胜利方是首位拼出 `MOO` 的玩家，可以是同行、同列或对角线。倒着拼出也是可以的，例如一名玩家在棋盘的一行内拼出 `OOM` 也可以获胜。如同标准井字棋一样，有可能最后没有玩家取得胜利。奶牛井字棋的一次行动通常用 3 个字符表示，`Mij` 或 `Oij`，其中 $i$ 和 $j$ 在范围 $1 \\ldots 3$ 之间，表示放置 `M` 或 `O` 的行与列。\n\n为了给 Bessie 增加一些挑战，Farmer John 设计了一个由 $N \\times N$ 个方格组成的正方形迷宫（$3 \\leq N \\leq 25$）。某些方格，包括所有的边界方格，有巨大的草堆，使得 Bessie 不能移动到这些方格。Bessie 可以沿东南西北四个方向在迷宫内的所有其他方格内自由行动。某些方格内有一张纸，上面写有奶牛井字棋的一次行动。当 Bessie 在迷宫中移动时，任何时刻她停留在这样的方格上，她都必须于迷宫中移动之时在同时进行的奶牛井字棋游戏内做出对应的行动（除非奶牛井字棋中对应的方格已经被填上了，在这种情况下她不进行行动）。在奶牛井字棋游戏内没有与她对阵的玩家，但迷宫中的某些方格可能会不利于她最终拼出 `MOO`。\n\n如果 Bessie 在获胜之时就会立刻停止奶牛井字棋，请求出她可以通过适当的方式在迷宫中移动而完成的不同的胜利状态棋盘数量。", "inputFormat": "输入的第一行包含 $N$。\n\n以下 $N$ 行，每行包含 $3N$ 个字符，描述迷宫。每个方格用 3 个字符表示，`###` 代表墙，`...` 代表空格，`BBB` 代表 Bessie 所在的一个非墙方格，或者一个奶牛井字棋的行动，表示 Bessie 必须进行对应行动的一个非墙方格。恰好一个方格为 `BBB`。", "outputFormat": "输出 Bessie 可以通过在迷宫中行动并在获胜时立刻停止而产生的不同的胜利状态下的奶牛井字棋盘数量（可能为 $0$）。", "hint": "#### 样例说明\n\n在这个样例中，Bessie 最终可能达成 $8$ 种胜利的棋盘状态：\n\n```plain\nO.M\n.O.\nMOM\n\nO..\n.O.\n.OM\n\nO.M\n.O.\n.OM\n\nO..\n.O.\nMOM\n\nO..\n...\nOOM\n\n..M\n.O.\nOOM\n\n...\n.O.\nOOM\n\n...\n...\nOOM\n```\n\n对其中一种情况进行说明：\n\n```plain\nO..\n...\nOOM\n```\n\n在这里，Bessie 可以先移动到 `O11` 方格，然后移动到下方并通过 `O32`、`M33` 和 `O31`。此时游戏结束，因为她获得了胜利（例如她不能再前往位于她当前所在的 `O31` 方格北面的 `M11` 方格）。\n\n#### 说明\n\n供题：Brian Dean", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21OPEN] Maze Tac Toe S", "background": "", "description": "奶牛 Bessie 喜欢玩走迷宫。她同样喜欢玩井字棋（更准确地说，奶牛版的井字棋，马上会进行介绍）。Farmer John 找到了一种全新的方式，可以使她同时玩到这两种游戏！\n\n首先，奶牛井字棋：与在 $3 \\times 3$ 棋盘内放置 `X` 和 `O` 不同，奶牛当然是在 $3 \\times 3$ 棋盘内放置 `M` 和 `O`。在一方的回合内，玩家可以选择将一个 `M` 或一个 `O` 放在任意一个空格内（这是另一个与标准井字棋的不同之处，标准的井字棋中一名玩家始终放 `X` 而另一名玩家始终放 `O`）。奶牛井字棋的胜利方是首位拼出 `MOO` 的玩家，可以是同行、同列或对角线。倒着拼出也是可以的，例如一名玩家在棋盘的一行内拼出 `OOM` 也可以获胜。如同标准井字棋一样，有可能最后没有玩家取得胜利。奶牛井字棋的一次行动通常用 3 个字符表示，`Mij` 或 `Oij`，其中 $i$ 和 $j$ 在范围 $1 \\ldots 3$ 之间，表示放置 `M` 或 `O` 的行与列。\n\n为了给 Bessie 增加一些挑战，Farmer John 设计了一个由 $N \\times N$ 个方格组成的正方形迷宫（$3 \\leq N \\leq 25$）。某些方格，包括所有的边界方格，有巨大的草堆，使得 Bessie 不能移动到这些方格。Bessie 可以沿东南西北四个方向在迷宫内的所有其他方格内自由行动。某些方格内有一张纸，上面写有奶牛井字棋的一次行动。当 Bessie 在迷宫中移动时，任何时刻她停留在这样的方格上，她都必须于迷宫中移动之时在同时进行的奶牛井字棋游戏内做出对应的行动（除非奶牛井字棋中对应的方格已经被填上了，在这种情况下她不进行行动）。在奶牛井字棋游戏内没有与她对阵的玩家，但迷宫中的某些方格可能会不利于她最终拼出 `MOO`。\n\n如果 Bessie 在获胜之时就会立刻停止奶牛井字棋，请求出她可以通过适当的方式在迷宫中移动而完成的不同的胜利状态棋盘数量。", "inputFormat": "输入的第一行包含 $N$。\n\n以下 $N$ 行，每行包含 $3N$ 个字符，描述迷宫。每个方格用 3 个字符表示，`###` 代表墙，`...` 代表空格，`BBB` 代表 Bessie 所在的一个非墙方格，或者一个奶牛井字棋的行动，表示 Bessie 必须进行对应行动的一个非墙方格。恰好一个方格为 `BBB`。", "outputFormat": "输出 Bessie 可以通过在迷宫中行动并在获胜时立刻停止而产生的不同的胜利状态下的奶牛井字棋盘数量（可能为 $0$）。", "hint": "#### 样例说明\n\n在这个样例中，Bessie 最终可能达成 $8$ 种胜利的棋盘状态：\n\n```plain\nO.M\n.O.\nMOM\n\nO..\n.O.\n.OM\n\nO.M\n.O.\n.OM\n\nO..\n.O.\nMOM\n\nO..\n...\nOOM\n\n..M\n.O.\nOOM\n\n...\n.O.\nOOM\n\n...\n...\nOOM\n```\n\n对其中一种情况进行说明：\n\n```plain\nO..\n...\nOOM\n```\n\n在这里，Bessie 可以先移动到 `O11` 方格，然后移动到下方并通过 `O32`、`M33` 和 `O31`。此时游戏结束，因为她获得了胜利（例如她不能再前往位于她当前所在的 `O31` 方格北面的 `M11` 方格）。\n\n#### 说明\n\n供题：Brian Dean", "locale": "zh-CN"}}}
{"pid": "P7556", "type": "P", "difficulty": 3, "samples": [["10\n7\n1 2 3 4 5 6 7\n4\n4 5 7 8\n4\n4 5 7 9\n4\n4 5 7 10\n4\n4 5 7 11\n4\n4 5 7 12\n4\n4 5 7 13\n4\n4 5 7 14\n4\n4 5 7 15\n4\n4 5 7 16", "1\n3\n5\n1\n4\n3\n0\n0\n0\n1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["USACO", "2021", "分类讨论"], "title": "[USACO21OPEN] Do You Know Your ABCs? S", "background": "", "description": "Farmer John 的奶牛正在 mooZ 视频会议平台上举行每日集会。她们发明了一个简单的数字游戏，为会议增添一些乐趣。\n\nElsie 有三个正整数 $A$、$B$ 和 $C$（$1\\le A\\le B\\le C$）。这些数字是保密的，她不会直接透露给她的姐妹 Bessie。她告诉 Bessie $N$（$4\\le N\\le 7$）个不同的整数 $x_1,x_2,\\ldots,x_N$（$1\\le x_i\\le 10^9$），并宣称每一个 $x_i$ 都是 $A$、$B$、$C$、$A+B$、$B+C$、$C+A$ 或 $A+B+C$ 之一。然而，Elsie 可能在撒谎；这些整数 $x_i$ 可能并没有对应任何一组合法的 $(A,B,C)$。\n\nBessie 百思不得其解，所以需要靠你来求出与 Elsie 给出的数相符合的三元组 $(A,B,C)$ 的数量。\n\n每个输入包含 $T$（$1\\le T\\le 100$）组需要独立求解的测试用例。", "inputFormat": "输入的第一行包含 $T$。\n\n每个测试用例的第一行包含 $N$，为 Elsie 给 Bessie 的整数的数量。\n\n每个测试用例的第二行包含 $N$ 个不同的整数 $x_1,x_2,\\ldots,x_N$。", "outputFormat": "对于每个测试用例，输出与 Elsie 给出的数相符合的三元组 $(A,B,C)$ 的数量。", "hint": "#### 样例说明\n\n对于 $x=\\{4,5,7,9\\}$，五个可能的三元组如下：\n\n$$(2, 2, 5), (2, 3, 4), (2, 4, 5), (3, 4, 5), (4, 5, 7).$$\n\n#### 测试点性质：\n\n- 测试点 $1 \\sim 4$ 中，所有的 $x_i$ 不超过 $50$。\n- 测试点 $5 \\sim 5$ 满足 $N=7$。\n- 测试点 $7 \\sim 15$ 没有额外限制。\n\n#### 说明\n\n供题：Benjamin Qi", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21OPEN] Do You Know Your ABCs? S", "background": "", "description": "Farmer John 的奶牛正在 mooZ 视频会议平台上举行每日集会。她们发明了一个简单的数字游戏，为会议增添一些乐趣。\n\nElsie 有三个正整数 $A$、$B$ 和 $C$（$1\\le A\\le B\\le C$）。这些数字是保密的，她不会直接透露给她的姐妹 Bessie。她告诉 Bessie $N$（$4\\le N\\le 7$）个不同的整数 $x_1,x_2,\\ldots,x_N$（$1\\le x_i\\le 10^9$），并宣称每一个 $x_i$ 都是 $A$、$B$、$C$、$A+B$、$B+C$、$C+A$ 或 $A+B+C$ 之一。然而，Elsie 可能在撒谎；这些整数 $x_i$ 可能并没有对应任何一组合法的 $(A,B,C)$。\n\nBessie 百思不得其解，所以需要靠你来求出与 Elsie 给出的数相符合的三元组 $(A,B,C)$ 的数量。\n\n每个输入包含 $T$（$1\\le T\\le 100$）组需要独立求解的测试用例。", "inputFormat": "输入的第一行包含 $T$。\n\n每个测试用例的第一行包含 $N$，为 Elsie 给 Bessie 的整数的数量。\n\n每个测试用例的第二行包含 $N$ 个不同的整数 $x_1,x_2,\\ldots,x_N$。", "outputFormat": "对于每个测试用例，输出与 Elsie 给出的数相符合的三元组 $(A,B,C)$ 的数量。", "hint": "#### 样例说明\n\n对于 $x=\\{4,5,7,9\\}$，五个可能的三元组如下：\n\n$$(2, 2, 5), (2, 3, 4), (2, 4, 5), (3, 4, 5), (4, 5, 7).$$\n\n#### 测试点性质：\n\n- 测试点 $1 \\sim 4$ 中，所有的 $x_i$ 不超过 $50$。\n- 测试点 $5 \\sim 5$ 满足 $N=7$。\n- 测试点 $7 \\sim 15$ 没有额外限制。\n\n#### 说明\n\n供题：Benjamin Qi", "locale": "zh-CN"}}}
{"pid": "P7557", "type": "P", "difficulty": 3, "samples": [["4 4 1\n1 100 1 1", "3"], ["4 1 4\n1 100 1 1", "2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["二分", "USACO", "2021"], "title": "[USACO21OPEN] Acowdemia S", "background": null, "description": "由于对计算机科学的热爱，以及有朝一日成为 「Bessie 博士」的诱惑，奶牛 Bessie 开始攻读计算机科学博士学位。经过一段时间的学术研究，她已经发表了 $N$ 篇论文（$1 \\leq N \\leq 10^5$），并且她的第 $i$ 篇论文得到了来自其他研究文献的 $c_i$ 次引用（$0 \\leq c_i \\leq 10^5$）。\n\nBessie 听说学术成就可以用 $h$ 指数来衡量。$h$ 指数等于使得研究员有至少 $h$ 篇引用次数不少于 $h$ 的论文的最大整数 $h$。例如，如果一名研究员有 $4$ 篇论文，引用次数分别为 $(1,100,2,3)$，则 $h$ 指数为 $2$，然而若引用次数为 $(1,100,3,3)$ 则 $h$ 指数将会是 $3$。\n\n为了提升她的 $h$ 指数，Bessie 计划写至多 $K$ 篇综述（$0 \\leq K \\leq 10^5$），并在每篇综述中引用许多她曾经写过的论文。然而，由于页数限制，她至多可以在一篇综述中引用 $L$ 篇论文（$0 \\leq L \\leq 10^5$）。当然，一篇综述中她只能引用一篇论文至多一次（但是一篇论文可以在多篇综述中被引用）。\n\n请帮助 Bessie 求出在写完这些综述后她可以达到的最大 $h$ 指数。Bessie 不可以在一篇综述中引用她写的其他综述。\n\n注意 Bessie 的导师可能会告知她纯粹为了提升 $h$ 指数而写综述存在违反学术道德的嫌疑；我们不建议其他学者模仿 Bessie 的行为。", "inputFormat": "输入的第一行包含 $N$、$K$ 和 $L$。\n\n第二行包含 $N$ 个空格分隔的整数 $c_1,\\ldots, c_N$。", "outputFormat": "输出最大可以达到的 $h$ 指数。", "hint": "#### 样例说明\n\n对于第一个样例，Bessie 可以写至多四篇综述，每一个综述最多引用一篇文章。如果 Bessie 引用她的第一、第三篇论文各两次，她的 $h$ 指数会变为 $3$。\n\n对于第二个样例，Bessie 可以写至多一篇综述。如果 Bessie 引用她的第一、第三、第四篇论文中的任意一篇，她的 $h$ 指数会变为 $2$。\n\n#### 测试点性质：\n\n- 测试点 $1 \\sim 6$ 满足 $N\\le 100$。\n- 测试点 $7 \\sim 16$ 没有额外限制。\n\n#### 说明\n\n供题：Dhruv Rohatgi", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21OPEN] Acowdemia S", "background": null, "description": "由于对计算机科学的热爱，以及有朝一日成为 「Bessie 博士」的诱惑，奶牛 Bessie 开始攻读计算机科学博士学位。经过一段时间的学术研究，她已经发表了 $N$ 篇论文（$1 \\leq N \\leq 10^5$），并且她的第 $i$ 篇论文得到了来自其他研究文献的 $c_i$ 次引用（$0 \\leq c_i \\leq 10^5$）。\n\nBessie 听说学术成就可以用 $h$ 指数来衡量。$h$ 指数等于使得研究员有至少 $h$ 篇引用次数不少于 $h$ 的论文的最大整数 $h$。例如，如果一名研究员有 $4$ 篇论文，引用次数分别为 $(1,100,2,3)$，则 $h$ 指数为 $2$，然而若引用次数为 $(1,100,3,3)$ 则 $h$ 指数将会是 $3$。\n\n为了提升她的 $h$ 指数，Bessie 计划写至多 $K$ 篇综述（$0 \\leq K \\leq 10^5$），并在每篇综述中引用许多她曾经写过的论文。然而，由于页数限制，她至多可以在一篇综述中引用 $L$ 篇论文（$0 \\leq L \\leq 10^5$）。当然，一篇综述中她只能引用一篇论文至多一次（但是一篇论文可以在多篇综述中被引用）。\n\n请帮助 Bessie 求出在写完这些综述后她可以达到的最大 $h$ 指数。Bessie 不可以在一篇综述中引用她写的其他综述。\n\n注意 Bessie 的导师可能会告知她纯粹为了提升 $h$ 指数而写综述存在违反学术道德的嫌疑；我们不建议其他学者模仿 Bessie 的行为。", "inputFormat": "输入的第一行包含 $N$、$K$ 和 $L$。\n\n第二行包含 $N$ 个空格分隔的整数 $c_1,\\ldots, c_N$。", "outputFormat": "输出最大可以达到的 $h$ 指数。", "hint": "#### 样例说明\n\n对于第一个样例，Bessie 可以写至多四篇综述，每一个综述最多引用一篇文章。如果 Bessie 引用她的第一、第三篇论文各两次，她的 $h$ 指数会变为 $3$。\n\n对于第二个样例，Bessie 可以写至多一篇综述。如果 Bessie 引用她的第一、第三、第四篇论文中的任意一篇，她的 $h$ 指数会变为 $2$。\n\n#### 测试点性质：\n\n- 测试点 $1 \\sim 6$ 满足 $N\\le 100$。\n- 测试点 $7 \\sim 16$ 没有额外限制。\n\n#### 说明\n\n供题：Dhruv Rohatgi", "locale": "zh-CN"}}}
{"pid": "P7558", "type": "P", "difficulty": 7, "samples": [["7 90\n3 1\n2 5\n0 2\n-1 6\n-3 1\n-1 -4\n4 -2", "5\n3\n1\n7\n6\n4\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2021", "提交答案", "Special Judge", "JOISC/JOIST（日本）"], "title": "[JOISC 2021] 曲芸飛行 (Day1)", "background": "**本题是提交答案题。**\n\nSPJ modified by wlzhouzhuan", "description": "在一个平面直角坐标系上，有 $N$ 个点 $(X_i,Y_i)$，小 B 从一个点出发，任意选择一个点作为终点走直线路径过去，并重复这个过程 $N-1$ 次，不难发现这个过程会形成由 $N$ 条线段组成的折线，除了第一个点和最后一个点之外的每一个点都会形成一个夹角 $\\alpha_i\\ (2 \\le i \\le n-1)$（小于等于 $180^\\circ$ 的那个角，$i$ 即代表第 $i$ 个经过的点），小 B 要求你通过策划折线路径经过的点的顺序求得下面这个式子的最大值：\n\n$$\\min\\limits_{i=2}^{n-1}\\{\\alpha_i\\}$$", "inputFormat": "第一行两个整数 $N,Z_0$ 代表点数和评分参数（见下方数据规模与约定和评测说明）。\n\n接下来 $N$ 行每行两个整数 $X_i,Y_i$ 代表一个点。", "outputFormat": "$N$ 行每行一个整数 $P_k$ 代表第 $k$ 个经过的点的编号。", "hint": "#### 样例 1 解释\n\n如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tcfv266a.png)\n\n最小的夹角在点 $6$ 处，为 $68.19859\\cdots^\\circ$，根据 $Z_0=90$ 和下方评测方式中的评分参数说明，这个输出可以得到 $61.5\\%$ 的分数。\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$3 \\le N \\le 1000$，$\\sqrt{X_i^2+Y_i^2} \\le 10^7$，任意两点不重合，$1 \\le Z_0 \\le 179$。\n\n具体地，**本题为提交答案题**，共有 $6$ 个测试点：\n\n- 输入文件为 `input_01.txt` 到 `input_06.txt`。\n- 输出文件为 `output_01.txt` 到 `output_06.txt`。\n- 每一个测试点的 $N$，$Z_0$ 和分数分别为：\n\n|测试点编号|$N$|$Z_0$|分数|\n|:-:|:-:|:-:|:-:|\n|$1$|$15$|$100$|$10$|\n|$2$|$200$|$143$|$15$|\n|$3$|$200$|$134$|$15$|\n|$4$|$1000$|$156$|$20$|\n|$5$|$1000$|$150$|$20$|\n|$6$|$1000$|$153$|$20$|\n\n#### 评测参数\n\n**本题采用 Special Judge。**\n\n感谢 @[035966_L3](https://www.luogu.com.cn/user/365654) 提供的 [Special Judge](https://www.luogu.com.cn/blog/12322655-4/p7558spj)。\n\n如果您的输出格式有误或者输出的数不是 $1 \\sim N$ 等其他错误，您抱铃。\n\n如果您的输出格式是正确的，假设您得到的最小夹角是 $Z$，则您的分数如下：\n\n- 如果 $Z \\ge Z_0$，您将得到满分。\n- 如果 $Z < Z_0$，设该测试点分数为 $S$，您将得到 $S \\times \\frac{f(Z/180)}{f(Z_0/180)}$。\n\n定义函数 $f(\\alpha)\\ (0 \\le \\alpha \\le 1)$ 为：\n\n$$f(\\alpha)=4\\alpha^4+\\alpha$$\n\n#### 评测库\n\n我们额外提供评测库（在文件 `aerobatics.h` 中），您可以用他计算三个点形成的夹角度数。\n\n调用格式如下：\n\n- `double GetAngle(int xb,int yb,int xa,int ya,int xc,int yc) ` 或 `double GetAngle(int xb,int yb,int xc,int yc,int xa,int ya)`\n\t- 这个函数计算 $\\angle ABC$，误差足够小。\n    - **请保证顺序正确。**\n    - $(xa,ya)$ 为点 $A$。\n    - $(xb,yb)$ 为点 $B$。\n    - $(xc,yc)$ 为点 $C$。\n    - 如果 $(xa,ya)=(xb,yb)$ 或 $(xa,ya)=(xc,yc)$，那么，嘿，嘿嘿。\n\n#### 附加文件说明\n\n1. 名称：下方附件中的 `aerobatics-dist.zip`。\n\t- in & out：样例输入输出。\n\t- aerobatics.h：评测库。\n2. 名称：下方附件中的 `aerobatics-data.zip`：\n\t- in：输入数据。\n    \n#### 说明\n\n翻译自 [第２０回日本情報オリンピック　春季トレーニング合宿](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/index.html) [Day1 A 曲芸飛行 (Aerobatics) 的英文版本](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day1/aerobatics-en.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOISC 2021] 曲芸飛行 (Day1)", "background": "**本题是提交答案题。**\n\nSPJ modified by wlzhouzhuan", "description": "在一个平面直角坐标系上，有 $N$ 个点 $(X_i,Y_i)$，小 B 从一个点出发，任意选择一个点作为终点走直线路径过去，并重复这个过程 $N-1$ 次，不难发现这个过程会形成由 $N$ 条线段组成的折线，除了第一个点和最后一个点之外的每一个点都会形成一个夹角 $\\alpha_i\\ (2 \\le i \\le n-1)$（小于等于 $180^\\circ$ 的那个角，$i$ 即代表第 $i$ 个经过的点），小 B 要求你通过策划折线路径经过的点的顺序求得下面这个式子的最大值：\n\n$$\\min\\limits_{i=2}^{n-1}\\{\\alpha_i\\}$$", "inputFormat": "第一行两个整数 $N,Z_0$ 代表点数和评分参数（见下方数据规模与约定和评测说明）。\n\n接下来 $N$ 行每行两个整数 $X_i,Y_i$ 代表一个点。", "outputFormat": "$N$ 行每行一个整数 $P_k$ 代表第 $k$ 个经过的点的编号。", "hint": "#### 样例 1 解释\n\n如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tcfv266a.png)\n\n最小的夹角在点 $6$ 处，为 $68.19859\\cdots^\\circ$，根据 $Z_0=90$ 和下方评测方式中的评分参数说明，这个输出可以得到 $61.5\\%$ 的分数。\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$3 \\le N \\le 1000$，$\\sqrt{X_i^2+Y_i^2} \\le 10^7$，任意两点不重合，$1 \\le Z_0 \\le 179$。\n\n具体地，**本题为提交答案题**，共有 $6$ 个测试点：\n\n- 输入文件为 `input_01.txt` 到 `input_06.txt`。\n- 输出文件为 `output_01.txt` 到 `output_06.txt`。\n- 每一个测试点的 $N$，$Z_0$ 和分数分别为：\n\n|测试点编号|$N$|$Z_0$|分数|\n|:-:|:-:|:-:|:-:|\n|$1$|$15$|$100$|$10$|\n|$2$|$200$|$143$|$15$|\n|$3$|$200$|$134$|$15$|\n|$4$|$1000$|$156$|$20$|\n|$5$|$1000$|$150$|$20$|\n|$6$|$1000$|$153$|$20$|\n\n#### 评测参数\n\n**本题采用 Special Judge。**\n\n感谢 @[035966_L3](https://www.luogu.com.cn/user/365654) 提供的 [Special Judge](https://www.luogu.com.cn/blog/12322655-4/p7558spj)。\n\n如果您的输出格式有误或者输出的数不是 $1 \\sim N$ 等其他错误，您抱铃。\n\n如果您的输出格式是正确的，假设您得到的最小夹角是 $Z$，则您的分数如下：\n\n- 如果 $Z \\ge Z_0$，您将得到满分。\n- 如果 $Z < Z_0$，设该测试点分数为 $S$，您将得到 $S \\times \\frac{f(Z/180)}{f(Z_0/180)}$。\n\n定义函数 $f(\\alpha)\\ (0 \\le \\alpha \\le 1)$ 为：\n\n$$f(\\alpha)=4\\alpha^4+\\alpha$$\n\n#### 评测库\n\n我们额外提供评测库（在文件 `aerobatics.h` 中），您可以用他计算三个点形成的夹角度数。\n\n调用格式如下：\n\n- `double GetAngle(int xb,int yb,int xa,int ya,int xc,int yc) ` 或 `double GetAngle(int xb,int yb,int xc,int yc,int xa,int ya)`\n\t- 这个函数计算 $\\angle ABC$，误差足够小。\n    - **请保证顺序正确。**\n    - $(xa,ya)$ 为点 $A$。\n    - $(xb,yb)$ 为点 $B$。\n    - $(xc,yc)$ 为点 $C$。\n    - 如果 $(xa,ya)=(xb,yb)$ 或 $(xa,ya)=(xc,yc)$，那么，嘿，嘿嘿。\n\n#### 附加文件说明\n\n1. 名称：下方附件中的 `aerobatics-dist.zip`。\n\t- in & out：样例输入输出。\n\t- aerobatics.h：评测库。\n2. 名称：下方附件中的 `aerobatics-data.zip`：\n\t- in：输入数据。\n    \n#### 说明\n\n翻译自 [第２０回日本情報オリンピック　春季トレーニング合宿](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/index.html) [Day1 A 曲芸飛行 (Aerobatics) 的英文版本](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day1/aerobatics-en.pdf)。", "locale": "zh-CN"}}}
{"pid": "P7559", "type": "P", "difficulty": 7, "samples": [["2\n0 0\n4 3", "1"], ["3\n1 2\n2 1\n4 3", "3"], ["2\n20 20\n20 21", "2"], ["15\n5 6\n2 9\n12 0\n4 11\n3 12\n6 5\n0 8\n9 10\n11 13\n8 7\n13 2\n1 1\n7 14\n10 4\n14 3", "9"], ["30\n275810186 246609547\n122805872 99671769\n243507947 220373844\n281305347 252104708\n237805644 214671541\n172469077 149334974\n222589229 229887956\n160653451 208404690\n241378966 211098219\n144302355 224755786\n186392385 163258282\n199129390 169928751\n294937491 265736852\n196096122 172962019\n314342944 285142305\n202720470 166337671\n157037485 133903382\n263858979 240724876\n210720220 181519581\n296402036 267201397\n186021287 183036854\n195081930 173976211\n328293029 299092390\n261195361 238061258\n323595085 294394446\n299933764 270733125\n240976723 128081418\n188501753 165367650\n277832422 248631783\n119896220 96762117", "11"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "JOISC/JOIST（日本）"], "title": "[JOISC 2021] IOI 熱の感染拡大 (Day1)", "background": "", "description": "JOI 王国有 $N$ 个宫殿，第 $i$ 个宫殿坐标为 $(X_i,Y_i)$，每个宫殿居住着一个王子，第 $i$ 个宫殿里的王子为 $i$ 号王子。从第 $0$ 时刻开始，每个王子将会从自己的宫殿出发开始走动，他们可以选择东南西北：\n\n- 如果选择东，则 $t$ 时刻过后坐标位置从 $(x,y)$ 变为 $(x+t,y)$。\n- 如果选择西，则 $t$ 时刻过后坐标位置从 $(x,y)$ 变为 $(x-t,y)$。\n- 如果选择南，则 $t$ 时刻过后坐标位置从 $(x,y)$ 变为 $(x,y-t)$。\n- 如果选择北，则 $t$ 时刻过后坐标位置从 $(x,y)$ 变为 $(x,y+t)$。\n\n$t$ 不一定是整数。 \n\n方向不会给定，你可以自己规划。\n\n不幸的是，$1$ 号王子染上了 IOVID-114514 病毒，在 $0$ 时刻只有 $1$ 号王子感染了该病毒。\n\nIOVID-114514 病毒按照如下方式进行传播：\n\n- 如果某一个时刻 $a$ 号王子和 $b$ 号王子在同一个坐标上，且 $a$ 号王子感染了病毒，$b$ 号王子没有感染病毒，则 $a$ 号王子会将病毒传染给 $b$ 号王子。\n\nIOVID-114514 病毒没有其他传染方式，可怜的国王 JOI 114514 世也没有发现治愈方法。\n\n（消毒水也不能治愈！）\n\nJOI 114514 世想问问你求第 $10^{100}$ 个时刻的时候最多会有多少个王子感染 IOVID-114514 病毒。", "inputFormat": "第一行一个整数 $N$ 代表宫殿个数。\n\n接下来 $N$ 行每行两个整数 $X_i,Y_i$ 代表一个宫殿的坐标。", "outputFormat": "一行一个整数代表答案。", "hint": "#### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/vi1nasol.png)\n\n我们规划 $1$ 号王子向东，$2$ 号王子向西。\n\n不难发现，不论怎么移动 $1$ 都无法与 $2$ 相遇，只有 $1$ 号王子一个感染者。\n\n#### 样例 2 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/na76sh3g.png)\n\n我们规划 $1$ 号王子向东，$2$ 号王子向北，$3$ 号王子向西。\n\n- 时刻 $0$，$1$ 号王子是感染者。\n- 时刻 $1$，$1$ 号王子与 $2$ 号王子坐标重合，$2$ 号王子感染。\n- 时刻 $2$，$2$ 号王子与 $3$ 号王子坐标重合，$3$ 号王子感染。\n\n#### 样例 3 解释\n\n我们规划 $1$ 号王子向北，$2$ 号王子向南。\n\n- 时刻 $0$，$1$ 号王子是感染者。\n- 时刻 $0.5$，$1$ 号王子和 $2$ 号王子坐标重合，$2$ 号王子感染。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（5 pts）：$N \\le 7$，满足性质 A。\n- Subtask 2（8 pts）：$N \\le 15$，满足性质 A。\n- Subtask 3（6 pts）：$N \\le 100$，满足性质 A 和 B。\n- Subtask 4（6 pts）：$N \\le 100$，满足性质 A。\n- Subtask 5（12 pts）：$N \\le 3000$。\n- Subtask 6（32 pts）：满足性质 A。\n- Subtask 7（31 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 10^5$，$0 \\le X_i,Y_i \\le 5 \\times 10^8$，宫殿坐标互不重合。\n\n其中性质分别为：\n\n- 性质 A：$X_i \\ne X_j$，$Y_i \\ne Y_j$。\n- 性质 B：$1$ 号宫殿坐标为原点。\n\n#### 说明\n\n翻译自 [第２０回日本情報オリンピック　春季トレーニング合宿](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/index.html) [Day1 B IOI 熱の感染拡大 (IOI Fever) 的英文版本](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day1/fever-en.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOISC 2021] IOI 熱の感染拡大 (Day1)", "background": "", "description": "JOI 王国有 $N$ 个宫殿，第 $i$ 个宫殿坐标为 $(X_i,Y_i)$，每个宫殿居住着一个王子，第 $i$ 个宫殿里的王子为 $i$ 号王子。从第 $0$ 时刻开始，每个王子将会从自己的宫殿出发开始走动，他们可以选择东南西北：\n\n- 如果选择东，则 $t$ 时刻过后坐标位置从 $(x,y)$ 变为 $(x+t,y)$。\n- 如果选择西，则 $t$ 时刻过后坐标位置从 $(x,y)$ 变为 $(x-t,y)$。\n- 如果选择南，则 $t$ 时刻过后坐标位置从 $(x,y)$ 变为 $(x,y-t)$。\n- 如果选择北，则 $t$ 时刻过后坐标位置从 $(x,y)$ 变为 $(x,y+t)$。\n\n$t$ 不一定是整数。 \n\n方向不会给定，你可以自己规划。\n\n不幸的是，$1$ 号王子染上了 IOVID-114514 病毒，在 $0$ 时刻只有 $1$ 号王子感染了该病毒。\n\nIOVID-114514 病毒按照如下方式进行传播：\n\n- 如果某一个时刻 $a$ 号王子和 $b$ 号王子在同一个坐标上，且 $a$ 号王子感染了病毒，$b$ 号王子没有感染病毒，则 $a$ 号王子会将病毒传染给 $b$ 号王子。\n\nIOVID-114514 病毒没有其他传染方式，可怜的国王 JOI 114514 世也没有发现治愈方法。\n\n（消毒水也不能治愈！）\n\nJOI 114514 世想问问你求第 $10^{100}$ 个时刻的时候最多会有多少个王子感染 IOVID-114514 病毒。", "inputFormat": "第一行一个整数 $N$ 代表宫殿个数。\n\n接下来 $N$ 行每行两个整数 $X_i,Y_i$ 代表一个宫殿的坐标。", "outputFormat": "一行一个整数代表答案。", "hint": "#### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/vi1nasol.png)\n\n我们规划 $1$ 号王子向东，$2$ 号王子向西。\n\n不难发现，不论怎么移动 $1$ 都无法与 $2$ 相遇，只有 $1$ 号王子一个感染者。\n\n#### 样例 2 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/na76sh3g.png)\n\n我们规划 $1$ 号王子向东，$2$ 号王子向北，$3$ 号王子向西。\n\n- 时刻 $0$，$1$ 号王子是感染者。\n- 时刻 $1$，$1$ 号王子与 $2$ 号王子坐标重合，$2$ 号王子感染。\n- 时刻 $2$，$2$ 号王子与 $3$ 号王子坐标重合，$3$ 号王子感染。\n\n#### 样例 3 解释\n\n我们规划 $1$ 号王子向北，$2$ 号王子向南。\n\n- 时刻 $0$，$1$ 号王子是感染者。\n- 时刻 $0.5$，$1$ 号王子和 $2$ 号王子坐标重合，$2$ 号王子感染。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（5 pts）：$N \\le 7$，满足性质 A。\n- Subtask 2（8 pts）：$N \\le 15$，满足性质 A。\n- Subtask 3（6 pts）：$N \\le 100$，满足性质 A 和 B。\n- Subtask 4（6 pts）：$N \\le 100$，满足性质 A。\n- Subtask 5（12 pts）：$N \\le 3000$。\n- Subtask 6（32 pts）：满足性质 A。\n- Subtask 7（31 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 10^5$，$0 \\le X_i,Y_i \\le 5 \\times 10^8$，宫殿坐标互不重合。\n\n其中性质分别为：\n\n- 性质 A：$X_i \\ne X_j$，$Y_i \\ne Y_j$。\n- 性质 B：$1$ 号宫殿坐标为原点。\n\n#### 说明\n\n翻译自 [第２０回日本情報オリンピック　春季トレーニング合宿](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/index.html) [Day1 B IOI 熱の感染拡大 (IOI Fever) 的英文版本](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day1/fever-en.pdf)。", "locale": "zh-CN"}}}
{"pid": "P7560", "type": "P", "difficulty": 6, "samples": [["3 5 7\n1 2 3 5 2\n1 1 2 2 4\n3 2 3\n2 1 3 3\n3 1 2\n1 2 3 4 2\n3 3 2", "2\n0\n4"], ["3 4 7\n1 1 2 1 1\n1 1 3 4 1\n2 2 3 1\n2 1 3 1\n1 1 2 2 1\n3 1 1\n3 3 2", "4\n0"], ["183326 218318 22\n1 106761 160918 151683 574906362\n3 68709 1\n1 29240 156379 22166 957318472\n1 14054 181502 82845 97183925\n2 112033 122908 587808357\n2 57819 160939 215041262\n3 36674 524274467\n1 35854 69866 32334 322730299\n1 1384 7230 115069 454256926\n1 44192 158235 8750 84192710\n3 54457 1077490708\n2 10592 110384 979714505\n2 44594 79244 311724477\n3 160965 97183926\n1 88748 101697 39148 373927458\n3 41166 58039001\n1 91501 137591 205480 958877326\n2 77775 169655 135756956\n1 12497 57047 60918 15666764\n1 47839 51716 144688 732270998\n3 114514 774994894\n3 48645 169986425", "0\n22166\n32334\n0\n82845\n8750\n60918"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "JOISC/JOIST（日本）"], "title": "[JOISC 2021] フードコート (Day1)", "background": "如果洛谷上数据无法下载，请在 [此处](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day1/foodcourt-data.zip) 获取完整数据。", "description": "有 $N$ 家书虫食品店，有 $M$ 个家庭来享受用书虫制作的美味食物。\n\n因为食品店十分火爆，所以顾客需要排队，刚开始所有队列都是空的。\n\n今天食品店又全部开张了，发生了 $Q$ 个事件：\n\n- **加入事件**：编号位于区间 $[L,R]$ 内的所有食品店中，都有编号为 $C$ 的家庭加入队尾，每个满足要求的食品店队尾都加入了 $K$ 个人。\n- **离开事件**：编号位于区间 $[L,R]$ 内的所有食品店中，如果队列有超过 $K$ 个人，那么队列的前 $K$ 个人离开队列，否则队列里的所有人离开队列。\n- **白嫖事件**：如果编号为 $A$ 的食品店的队列中有大于等于 $B$ 个人，那么食品店就会赠送从队列开头开始数第 $B$ 个人一份秘制书虫，否则店员会吃掉书虫。\n\n求每次 **白嫖事件** 是否有顾客被赠送了秘制书虫，如果有的话，求顾客所在的家庭。", "inputFormat": "第一行三个整数 $N,M,Q$ 代表食品店个数，家庭个数和事件个数。\n\n接下来 $Q$ 行，每行首先一个整数 $T$：\n\n- $T=1$，接下来四个整数 $L,R,C,K$ 描述 **加入事件**。\n- $T=2$，接下来三个整数 $L,R,K$ 描述 **离开事件**。\n- $T=3$，接下来两个整数 $A,B$ 描述 **白嫖事件**。", "outputFormat": "对于所有 **白嫖事件**，一行一个整数：\n\n- 如果有顾客被送了秘制书虫，输出他所在的家庭。\n- 如果店员吃掉了书虫，输出 $0$。", "hint": "#### 样例 1 解释\n\n我们用 $Q_i(a_1,a_2,\\cdots,a_k)$ 代表第 $i$ 个食品店的队列，$a_1$ 为队首，$a_k$ 为队尾，其中 $a_i=p$ 就代表第 $i$ 个位置的人来自第 $p$ 个家庭。特殊地，$Q_i()$ 就代表当前队列为空。\n\n根据样例 1 的这几个事件：\n\n- 第 $1$ 个 **加入事件**：\n\n$$Q_1(),Q_2(5,5),Q_3(5,5)$$\n\n- 第 $2$ 个 **加入事件**：\n\n$$Q_1(2,2,2,2),Q_2(5,5,2,2,2,2),Q_3(5,5)$$\n\n- 第 $3$ 个 **白嫖事件**，第 $2$ 个食品店的第 $3$ 个人（第 $2$ 个家庭）被送上秘制书虫。\n- 第 $4$ 个 **离开事件**：\n\n$$Q_1(2),Q_2(2,2,2),Q_3()$$\n\n- 第 $5$ 个 **白嫖事件**，第 $1$ 个食品店不够 $2$ 个人，店员会吃掉书虫。\n- 第 $6$ 个 **加入事件**：\n\n$$Q_1(2),Q_2(2,2,2,4,4),Q_3(4,4)$$\n\n- 第 $7$ 个 **白嫖事件**，第 $3$ 个食品店的第 $2$ 个人（第 $4$ 个家庭）被送上秘制书虫。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（2 pts）：$N,Q \\le 2000$，满足性质 A。\n- Subtask 2（5 pts）：$N,Q \\le 2000$。\n- Subtask 3（7 pts）：$N,Q \\le 65000$，满足性质 B。\n- Subtask 4（21 pts）：$M=1$。\n- Subtask 5（15 pts）：$N,Q \\le 65000$，满足性质 A。\n- Subtask 6（13 pts）：$N,Q \\le 65000$，满足性质 C。\n- Subtask 7（26 pts）：$N,Q \\le 65000$。\n- Subtask 8（11 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据：\n\n- $1 \\le N,M,Q \\le 25 \\times 10^4$。\n- $T \\in \\{1,2,3\\}$。\n- 对于所有 **加入事件**，$1 \\le L \\le R \\le N$，$1 \\le C \\le M$，$1 \\le K \\le 10^9$。\n- 对于所有 **离开事件**，$1 \\le L \\le R \\le N$，$1 \\le K \\le 10^9$。\n- 对于所有 **白嫖事件**，$1 \\le A \\le N$，$1 \\le B \\le 10^{15}$。\n- 至少有一个 **白嫖事件**。\n\n有以下若干个性质：\n\n- 性质 A：对于所有 **加入事件** 和 **离开事件**，有 $K=1$。\n- 性质 B：对于所有 **加入事件**，有 $R-L \\le  10$ 和 $K=1$。\n- 性质 C：只有 **加入事件** 和 **白嫖事件**。\n\n#### 说明\n\n翻译自 [第２０回日本情報オリンピック　春季トレーニング合宿](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/index.html) [Day1 C フードコート (Food Court) 的英文版本](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day1/foodcourt-en.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOISC 2021] フードコート (Day1)", "background": "如果洛谷上数据无法下载，请在 [此处](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day1/foodcourt-data.zip) 获取完整数据。", "description": "有 $N$ 家书虫食品店，有 $M$ 个家庭来享受用书虫制作的美味食物。\n\n因为食品店十分火爆，所以顾客需要排队，刚开始所有队列都是空的。\n\n今天食品店又全部开张了，发生了 $Q$ 个事件：\n\n- **加入事件**：编号位于区间 $[L,R]$ 内的所有食品店中，都有编号为 $C$ 的家庭加入队尾，每个满足要求的食品店队尾都加入了 $K$ 个人。\n- **离开事件**：编号位于区间 $[L,R]$ 内的所有食品店中，如果队列有超过 $K$ 个人，那么队列的前 $K$ 个人离开队列，否则队列里的所有人离开队列。\n- **白嫖事件**：如果编号为 $A$ 的食品店的队列中有大于等于 $B$ 个人，那么食品店就会赠送从队列开头开始数第 $B$ 个人一份秘制书虫，否则店员会吃掉书虫。\n\n求每次 **白嫖事件** 是否有顾客被赠送了秘制书虫，如果有的话，求顾客所在的家庭。", "inputFormat": "第一行三个整数 $N,M,Q$ 代表食品店个数，家庭个数和事件个数。\n\n接下来 $Q$ 行，每行首先一个整数 $T$：\n\n- $T=1$，接下来四个整数 $L,R,C,K$ 描述 **加入事件**。\n- $T=2$，接下来三个整数 $L,R,K$ 描述 **离开事件**。\n- $T=3$，接下来两个整数 $A,B$ 描述 **白嫖事件**。", "outputFormat": "对于所有 **白嫖事件**，一行一个整数：\n\n- 如果有顾客被送了秘制书虫，输出他所在的家庭。\n- 如果店员吃掉了书虫，输出 $0$。", "hint": "#### 样例 1 解释\n\n我们用 $Q_i(a_1,a_2,\\cdots,a_k)$ 代表第 $i$ 个食品店的队列，$a_1$ 为队首，$a_k$ 为队尾，其中 $a_i=p$ 就代表第 $i$ 个位置的人来自第 $p$ 个家庭。特殊地，$Q_i()$ 就代表当前队列为空。\n\n根据样例 1 的这几个事件：\n\n- 第 $1$ 个 **加入事件**：\n\n$$Q_1(),Q_2(5,5),Q_3(5,5)$$\n\n- 第 $2$ 个 **加入事件**：\n\n$$Q_1(2,2,2,2),Q_2(5,5,2,2,2,2),Q_3(5,5)$$\n\n- 第 $3$ 个 **白嫖事件**，第 $2$ 个食品店的第 $3$ 个人（第 $2$ 个家庭）被送上秘制书虫。\n- 第 $4$ 个 **离开事件**：\n\n$$Q_1(2),Q_2(2,2,2),Q_3()$$\n\n- 第 $5$ 个 **白嫖事件**，第 $1$ 个食品店不够 $2$ 个人，店员会吃掉书虫。\n- 第 $6$ 个 **加入事件**：\n\n$$Q_1(2),Q_2(2,2,2,4,4),Q_3(4,4)$$\n\n- 第 $7$ 个 **白嫖事件**，第 $3$ 个食品店的第 $2$ 个人（第 $4$ 个家庭）被送上秘制书虫。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（2 pts）：$N,Q \\le 2000$，满足性质 A。\n- Subtask 2（5 pts）：$N,Q \\le 2000$。\n- Subtask 3（7 pts）：$N,Q \\le 65000$，满足性质 B。\n- Subtask 4（21 pts）：$M=1$。\n- Subtask 5（15 pts）：$N,Q \\le 65000$，满足性质 A。\n- Subtask 6（13 pts）：$N,Q \\le 65000$，满足性质 C。\n- Subtask 7（26 pts）：$N,Q \\le 65000$。\n- Subtask 8（11 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据：\n\n- $1 \\le N,M,Q \\le 25 \\times 10^4$。\n- $T \\in \\{1,2,3\\}$。\n- 对于所有 **加入事件**，$1 \\le L \\le R \\le N$，$1 \\le C \\le M$，$1 \\le K \\le 10^9$。\n- 对于所有 **离开事件**，$1 \\le L \\le R \\le N$，$1 \\le K \\le 10^9$。\n- 对于所有 **白嫖事件**，$1 \\le A \\le N$，$1 \\le B \\le 10^{15}$。\n- 至少有一个 **白嫖事件**。\n\n有以下若干个性质：\n\n- 性质 A：对于所有 **加入事件** 和 **离开事件**，有 $K=1$。\n- 性质 B：对于所有 **加入事件**，有 $R-L \\le  10$ 和 $K=1$。\n- 性质 C：只有 **加入事件** 和 **白嫖事件**。\n\n#### 说明\n\n翻译自 [第２０回日本情報オリンピック　春季トレーニング合宿](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/index.html) [Day1 C フードコート (Food Court) 的英文版本](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day1/foodcourt-en.pdf)。", "locale": "zh-CN"}}}
{"pid": "P7561", "type": "P", "difficulty": 6, "samples": [["3 2\n-1 0\n0 2\n0 0\n", "1\n2\n"], ["5 4\n1 -1\n2 0\n-1 0\n0 2\n0 -2\n", "2\n2\n3\n3\n"], ["4 6\n0 0\n1 0\n3 0\n4 0\n", "1\n1\n2\n3\n3\n4\n"], ["10 10\n10 -8\n7 2\n7 -8\n-3 -6\n-2 1\n-8 6\n8 -1\n2 4\n6 -6\n2 -1\n", "3\n3\n4\n5\n6\n6\n6\n7\n7\n7\n"]], "limits": {"time": [10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["二分", "堆", "2021", "优先队列", "K-D Tree", "双指针 two-pointer", "JOISC/JOIST（日本）"], "title": "[JOISC 2021] 道路の建設案 (Road Construction) (Day2)", "background": "10s,2048M", "description": "JOI 国是一个 $x\\times y$ 的二维平面，王国里有 $n$ 个城镇，分别编号为 $1, 2, \\cdots, n$，其中第 $i$ 个城镇的 **坐标** 为 $(x_i, y_i)$。\n\n在 JOI 国，正计划修建连接两座城镇的路（下文简称：**「修路的项目」**），路有 $k$ 条。连接两个不同的城镇 $a$ 和 $b$ 将花费 $|x_a − x_b| + |y_a − y_b|$ 元。若有一条连接 $c$，$d$ 的路，则不需要也不可以再建一条连接 $d$，$c$ 的路，因为它们是相同的。\n\n你要管理这个「修路的项目」，为了计算花费情况，你得弄明白连接一些城镇所需的花费。在这 $\\dfrac{n\\cdot(n-1)}{2}$ 条道路中，你想了解最便宜的 $k$ 条道路的花费。\n\n给你城镇的坐标以及 $k$，请计算最便宜的 $k$ 条路所需要的钱。", "inputFormat": "输入数据共 $n+1$ 行。\n\n第一行，$2$ 个正整数 $n, k$，$n$ 表示城镇的数量，$k$ 含义见 **「题目描述」** 部分。\n\n接下来的第 $2 \\sim n+1$ 行，每行 $2$ 个整数，分别是 $x_i$ 和 $y_i$，其中 $1\\le i \\le n$，表示第 $i$ 个城镇的坐标。", "outputFormat": "输出数据共 $k$ 行。\n\n对于第 $k$ 行，有一个整数表示第 $k$ 便宜的路需要的日元。", "hint": "#### 样例 #1 解释\n有 $\\dfrac{3 \\times 2}{2} = 3$ 种方案。\n\n- 城镇 $1 \\to$ 城镇 $2$，$|(-1)-0|+|0-2| = 3$ 日元。\n- 城镇 $1 \\to$ 城镇 $3$，$|(-1)-0|+|0-0| = 1$ 日元。\n- 城镇 $2 \\to$ 城镇 $3$，$|0-0|+|2-0| = 2$ 日元。\n\n将其进行排序为 $1,2,3$，所以输出是 $1$ 和 $2$。\n\n本样例满足 Subtask $1, 4, 5, 6$。\n\n#### 样例 #2 解释\n\n有 $\\dfrac{5 \\times 4}{2} = 10$ 种方案。\n\n将钱数排序后是 $2, 2, 3, 3, 3, 3, 4, 4, 4, 4$。\n\n本样例满足 Subtask $1, 4, 5, 6$。\n\n#### 样例 #3 解释\n\n本样例满足 Subtask $1, 2, 4, 5, 6$。\n\n#### 样例 #4 解释\n\n本样例满足 Subtask $1, 4, 5, 6$。\n\n#### 数据范围与约定\n\n**本题采用 Subtask 计分法。**\n\n| Subtask | 分值占比百分率 | $n$ | $k$ | $y_i$ |\n| :----: | :----: | :----: | :----:| :----: |\n| $1$ | $5\\%$ | $\\le 10^3$ | / | / |\n| $2$ | $6\\%$ | / | / | $=0$ |\n| $3$ | $7\\%$ | / | $=1$ | / |\n| $4$ | $20\\%$ | / | $\\le 10$ | / |\n| $5$ | $27\\%$ |  / | $\\le 10 ^ 5$ | / |\n| $6$ | $35\\%$ | / | / | / |\n\n**注：斜线表示无特殊限制。**\n\n对于 $100\\%$ 的数据：\n- $2 \\le n \\le 2.5 \\times 10^5$；\n- $1 \\le k \\le \\min(2.5\\times 10^5,\\ \\dfrac{n\\cdot(n-1)}{2}$)；\n- $-10^9 \\le x_i, y_i \\le 10^9$，且 $1 \\le i \\le n$；\n- $(x_i,y_i)\\not = (x_j, y_j)$ 且 $1 \\le i < j \\le n$。\n\n#### 说明\n\n本题译自 [第２０回日本情報オリンピック 2020/2021春季トレーニング合宿 -](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/index.html) [競技 2 -](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day2/2021-sp-d2-notice.pdf) [T2 日文题面](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day2/road_construction.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOISC 2021] 道路の建設案 (Road Construction) (Day2)", "background": "10s,2048M", "description": "JOI 国是一个 $x\\times y$ 的二维平面，王国里有 $n$ 个城镇，分别编号为 $1, 2, \\cdots, n$，其中第 $i$ 个城镇的 **坐标** 为 $(x_i, y_i)$。\n\n在 JOI 国，正计划修建连接两座城镇的路（下文简称：**「修路的项目」**），路有 $k$ 条。连接两个不同的城镇 $a$ 和 $b$ 将花费 $|x_a − x_b| + |y_a − y_b|$ 元。若有一条连接 $c$，$d$ 的路，则不需要也不可以再建一条连接 $d$，$c$ 的路，因为它们是相同的。\n\n你要管理这个「修路的项目」，为了计算花费情况，你得弄明白连接一些城镇所需的花费。在这 $\\dfrac{n\\cdot(n-1)}{2}$ 条道路中，你想了解最便宜的 $k$ 条道路的花费。\n\n给你城镇的坐标以及 $k$，请计算最便宜的 $k$ 条路所需要的钱。", "inputFormat": "输入数据共 $n+1$ 行。\n\n第一行，$2$ 个正整数 $n, k$，$n$ 表示城镇的数量，$k$ 含义见 **「题目描述」** 部分。\n\n接下来的第 $2 \\sim n+1$ 行，每行 $2$ 个整数，分别是 $x_i$ 和 $y_i$，其中 $1\\le i \\le n$，表示第 $i$ 个城镇的坐标。", "outputFormat": "输出数据共 $k$ 行。\n\n对于第 $k$ 行，有一个整数表示第 $k$ 便宜的路需要的日元。", "hint": "#### 样例 #1 解释\n有 $\\dfrac{3 \\times 2}{2} = 3$ 种方案。\n\n- 城镇 $1 \\to$ 城镇 $2$，$|(-1)-0|+|0-2| = 3$ 日元。\n- 城镇 $1 \\to$ 城镇 $3$，$|(-1)-0|+|0-0| = 1$ 日元。\n- 城镇 $2 \\to$ 城镇 $3$，$|0-0|+|2-0| = 2$ 日元。\n\n将其进行排序为 $1,2,3$，所以输出是 $1$ 和 $2$。\n\n本样例满足 Subtask $1, 4, 5, 6$。\n\n#### 样例 #2 解释\n\n有 $\\dfrac{5 \\times 4}{2} = 10$ 种方案。\n\n将钱数排序后是 $2, 2, 3, 3, 3, 3, 4, 4, 4, 4$。\n\n本样例满足 Subtask $1, 4, 5, 6$。\n\n#### 样例 #3 解释\n\n本样例满足 Subtask $1, 2, 4, 5, 6$。\n\n#### 样例 #4 解释\n\n本样例满足 Subtask $1, 4, 5, 6$。\n\n#### 数据范围与约定\n\n**本题采用 Subtask 计分法。**\n\n| Subtask | 分值占比百分率 | $n$ | $k$ | $y_i$ |\n| :----: | :----: | :----: | :----:| :----: |\n| $1$ | $5\\%$ | $\\le 10^3$ | / | / |\n| $2$ | $6\\%$ | / | / | $=0$ |\n| $3$ | $7\\%$ | / | $=1$ | / |\n| $4$ | $20\\%$ | / | $\\le 10$ | / |\n| $5$ | $27\\%$ |  / | $\\le 10 ^ 5$ | / |\n| $6$ | $35\\%$ | / | / | / |\n\n**注：斜线表示无特殊限制。**\n\n对于 $100\\%$ 的数据：\n- $2 \\le n \\le 2.5 \\times 10^5$；\n- $1 \\le k \\le \\min(2.5\\times 10^5,\\ \\dfrac{n\\cdot(n-1)}{2}$)；\n- $-10^9 \\le x_i, y_i \\le 10^9$，且 $1 \\le i \\le n$；\n- $(x_i,y_i)\\not = (x_j, y_j)$ 且 $1 \\le i < j \\le n$。\n\n#### 说明\n\n本题译自 [第２０回日本情報オリンピック 2020/2021春季トレーニング合宿 -](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/index.html) [競技 2 -](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day2/2021-sp-d2-notice.pdf) [T2 日文题面](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day2/road_construction.pdf)。", "locale": "zh-CN"}}}
{"pid": "P7562", "type": "P", "difficulty": 6, "samples": [["5 4\n1 3\n2 5\n8 9\n6 8\n10 15\n", "1\n3\n4\n5\n"], ["4 3\n1 4\n3 5\n4 9\n7 10\n", "-1\n"], ["10 6\n77412002 93858605\n244306432 318243514\n280338037 358494212\n439397354 492065507\n485779890 529132783\n571714810 632053254\n659767854 709114867\n718405631 733610573\n786950301 815106357\n878719468 899999649\n", "1\n2\n4\n6\n7\n8\n"], ["20 16\n250732298 258217736\n26470443 34965880\n252620676 260043105\n692063405 697656580\n497457675 504191511\n391372149 397942668\n858168758 867389085\n235756850 241022021\n585764751 593366541\n207824318 217052204\n661682908 671226688\n886273261 892279963\n770109416 778960597\n264372562 270395107\n176883483 186662376\n509929119 519063796\n109491630 118520141\n162731982 168101507\n662727316 668317158\n757072772 765493222\n", "1\n2\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["贪心", "倍增", "2021", "颜色段均摊（珂朵莉树 ODT）", "离散化", "JOISC/JOIST（日本）"], "title": "[JOISC 2021] イベント巡り 2 (Event Hopping 2) (Day4)", "background": "**如果无法在洛谷下载测试数据，可以 [点此](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day4/event2-data.zip) 下载所有数据。**\n", "description": "IOI Park 将有 $n$ 场活动。\n\n这些活动的编号从 $1$ 到 $n$。 活动 $i$ 从时间 $L_i+10^{-1}$ 到时间 $R_i-10^{-1}$ 举行。数据保证 $L_i$ 和 $R_i$ 是整数。\n\nJOI 君决定参加其中的 $k$ 个活动。但是，JOI 君不能在中间加入或离开每个活动。**在两个活动场所间移动的时间忽略不计**。\n\nJOI 君希望参加编号较小的活动。严格来说，JOI 君参加的 $k$ 个活动的编号依次为 $a_1,\\cdots,a_k$，其中 $1 \\le a_1 < \\cdots < a_k \\le n$。如果序列 $(a_1, \\cdots, a_k)$ 的编号小于 $(b_1, \\cdots, b_k)$，当且仅当存在 $j\\ (1 \\le j \\le k)$ 满足在区间 $[1,j-1]$ 里的所有 $l$ 都有 $a_l=b_l$ 和 $a_j<b_j$。\n\n\n\n给出每个活动的信息和 JOI 君参加的活动个数 $k$，判断 JOI 君是否可以参加 $k$ 个活动，如果可以，输出所有的 $k$ 个活动的编号。\n\n", "inputFormat": "第一行，两个正整数 $n,k$。\n\n第 $2 \\sim n + 1$ 行，每行 $2$ 个正整数，$L_i, R_i$。", "outputFormat": "如果 JOI 君可以参加 $k$ 个活动：\n- 输出 $k$ 行。\n- 我们设 JOI 君参与的 $k$ 个活动的编号为 $a_1, a_2, \\cdots, a_k\\ (1\\le a_1 < \\cdots < a_k \\le n）$，你需要在第 $j$ 行输出 $a_j\\ (1\\le j \\le k)$。 请注意，序列 $(a_1, \\cdots, a_k)$ 必须是 **最小字典序**。\n\n\n\n\n如果 JOI 君无法参加 $k$ 个活动，输出 $\\texttt{-1}$。", "hint": "#### 样例 #1 解释\n\n有 $2$ 种方式可以参加正好 $4$ 个活动。\n\n- 参加 $1, 3, 4, 5$；\n- 参加 $2, 3, 4, 5$。\n\n数列 $(1,3,4,5)$ 比数列 $(2, 3, 4, 5)$ 字典序小，所以输出 $1, 3, 4, 5$。\n\n#### 样例 #2 解释\n\n无论怎么选择都不可能正好参加 $3$ 个活动，所以输出 $\\tt -1$。\n\n#### 样例 #3 解释\n\n本样例满足所有 Subtask 的条件。\n\n#### 数据规模与约定\n\n**因洛谷限制，本题不予评测每个 Subtask 的第 $1\\sim 20$ 个测试点。**\n\n**本题采用 Subtask 计分法。**\n\n| Subtask | 分值占比百分率 | $n$ | $L_i$ |\n| :----: | :----: | :----: | :----:|\n| $1$ | $7\\%$ | / | $L_i \\le L_{i+1}\\ (1 \\le i \\le n − 1)$ |\n| $2$ | $1\\%$ | $\\le20$ | / |\n| $3$ | $31\\%$ | $\\le 3 \\times 10^3$ |/ |\n| $4$ | $61\\%$ | / | / |\n\n**注：斜线表示无特殊限制。**\n\n对于 $100\\%$ 的数据：\n- $1\\le n\\le 10^5$；\n- $1 \\le k \\le n$；\n- $1\\le L_i < R_i \\le 10^9 (1\\le i \\le n)$。\n\n\n#### 说明\n\n本题译自 [第２０回日本情報オリンピック 2020/2021春季トレーニング合宿 -](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/index.html) [競技 4 -](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day4/2021-sp-d4-notice.pdf) [T1 日文题面](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day4/event2.pdf)。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOISC 2021] イベント巡り 2 (Event Hopping 2) (Day4)", "background": "**如果无法在洛谷下载测试数据，可以 [点此](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day4/event2-data.zip) 下载所有数据。**\n", "description": "IOI Park 将有 $n$ 场活动。\n\n这些活动的编号从 $1$ 到 $n$。 活动 $i$ 从时间 $L_i+10^{-1}$ 到时间 $R_i-10^{-1}$ 举行。数据保证 $L_i$ 和 $R_i$ 是整数。\n\nJOI 君决定参加其中的 $k$ 个活动。但是，JOI 君不能在中间加入或离开每个活动。**在两个活动场所间移动的时间忽略不计**。\n\nJOI 君希望参加编号较小的活动。严格来说，JOI 君参加的 $k$ 个活动的编号依次为 $a_1,\\cdots,a_k$，其中 $1 \\le a_1 < \\cdots < a_k \\le n$。如果序列 $(a_1, \\cdots, a_k)$ 的编号小于 $(b_1, \\cdots, b_k)$，当且仅当存在 $j\\ (1 \\le j \\le k)$ 满足在区间 $[1,j-1]$ 里的所有 $l$ 都有 $a_l=b_l$ 和 $a_j<b_j$。\n\n\n\n给出每个活动的信息和 JOI 君参加的活动个数 $k$，判断 JOI 君是否可以参加 $k$ 个活动，如果可以，输出所有的 $k$ 个活动的编号。\n\n", "inputFormat": "第一行，两个正整数 $n,k$。\n\n第 $2 \\sim n + 1$ 行，每行 $2$ 个正整数，$L_i, R_i$。", "outputFormat": "如果 JOI 君可以参加 $k$ 个活动：\n- 输出 $k$ 行。\n- 我们设 JOI 君参与的 $k$ 个活动的编号为 $a_1, a_2, \\cdots, a_k\\ (1\\le a_1 < \\cdots < a_k \\le n）$，你需要在第 $j$ 行输出 $a_j\\ (1\\le j \\le k)$。 请注意，序列 $(a_1, \\cdots, a_k)$ 必须是 **最小字典序**。\n\n\n\n\n如果 JOI 君无法参加 $k$ 个活动，输出 $\\texttt{-1}$。", "hint": "#### 样例 #1 解释\n\n有 $2$ 种方式可以参加正好 $4$ 个活动。\n\n- 参加 $1, 3, 4, 5$；\n- 参加 $2, 3, 4, 5$。\n\n数列 $(1,3,4,5)$ 比数列 $(2, 3, 4, 5)$ 字典序小，所以输出 $1, 3, 4, 5$。\n\n#### 样例 #2 解释\n\n无论怎么选择都不可能正好参加 $3$ 个活动，所以输出 $\\tt -1$。\n\n#### 样例 #3 解释\n\n本样例满足所有 Subtask 的条件。\n\n#### 数据规模与约定\n\n**因洛谷限制，本题不予评测每个 Subtask 的第 $1\\sim 20$ 个测试点。**\n\n**本题采用 Subtask 计分法。**\n\n| Subtask | 分值占比百分率 | $n$ | $L_i$ |\n| :----: | :----: | :----: | :----:|\n| $1$ | $7\\%$ | / | $L_i \\le L_{i+1}\\ (1 \\le i \\le n − 1)$ |\n| $2$ | $1\\%$ | $\\le20$ | / |\n| $3$ | $31\\%$ | $\\le 3 \\times 10^3$ |/ |\n| $4$ | $61\\%$ | / | / |\n\n**注：斜线表示无特殊限制。**\n\n对于 $100\\%$ 的数据：\n- $1\\le n\\le 10^5$；\n- $1 \\le k \\le n$；\n- $1\\le L_i < R_i \\le 10^9 (1\\le i \\le n)$。\n\n\n#### 说明\n\n本题译自 [第２０回日本情報オリンピック 2020/2021春季トレーニング合宿 -](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/index.html) [競技 4 -](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day4/2021-sp-d4-notice.pdf) [T1 日文题面](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day4/event2.pdf)。\n", "locale": "zh-CN"}}}
{"pid": "P7563", "type": "P", "difficulty": 7, "samples": [["6\n1 6 5\n1 3 6\n1 8 4\n3 4 9\n2 2 5\n2 5 6\n", "14"], ["5\n1 1 1\n2 2 1\n4 3 1\n3 3 1\n4 3 1\n", "0"], ["20\n1 7 381792936\n1 89 964898447\n1 27 797240712\n3 4 299745243\n2 18 113181438\n2 20 952129455\n4 34 124298446\n4 89 33466733\n7 40 109601410\n5 81 902931267\n2 4 669879699\n8 23 785166502\n8 1 601717183\n8 26 747624379\n1 17 504589209\n9 24 909134233\n16 56 236448090\n8 94 605526613\n5 90 481898834\n9 34 183442771\n", "2711043927\n"], ["20\n15 62 418848971\n13 5 277275513\n14 60 80376452\n12 14 256845164\n12 42 481331310\n6 86 290168639\n3 98 947342135\n3 19 896070909\n16 39 48034188\n8 29 925729089\n18 97 420006994\n13 51 454182928\n19 61 822405612\n13 37 148425187\n15 77 474094143\n14 27 272926693\n18 43 566552069\n9 93 790433300\n10 73 61654171\n14 28 334498030\n", "4012295156\n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "线段树", "2021", "离散化", "树形 DP", "基环树", "线段树合并", "JOISC/JOIST（日本）"], "title": "[JOISC 2021] 最悪の記者 4 (Worst Reporter 4) (Day4)", "background": "B 太郎不可爱。", "description": "B 太郎是一名主要写关于 OI 的报道的记者。再过几天，就要举行 IOI 了，B 太郎决定写一篇关于 IOI 的文章。\n\n比赛将有 $n$ 名选手参加，每位选手的编号从 $1$ 到 $n$。每位选手都有一个 Rating，这是衡量其实力的标准。Rating 用 $1$ 至 $10^9$ 之间的整数表示。\n\nB 太郎采访了每位选手，并获得了以下信息：\n\n- 选手 $i\\ (1\\le i\\le N)$ 的 Rating 大于等于选手 $a_i\\ (1\\le a_i \\le n)$ 的 Rating（$a_i$ 可以等于 $i$）。\n\n在所有的采访结束后，B 太郎从管理 Rating 系统的公司收到了一张表格，上面有每个选手的 Rating。 表上写着以下信息：\n\n- 选手 $i\\ (1 \\le i \\le n)$ 的 Rating 是 $h_i$。\n\n当 B 太郎试图根据这些信息写一篇文章时，他发现每个选手的 Rating 表可能存在错误。\n\n由于临近截止时间，没有时间去弄正确的 Rating 表。因此，B 太郎决定重写表中选手的 Rating，使其与采访中获得的信息不相矛盾。\n\nB 太郎在表中改写选手 $i\\ (1\\le i \\le n)$ 的 Rating 需要 $c_i$ 日元。\n\n也就是说，B 太郎可以通过支付 $c_i$ 日元，将列表中选手 $i$ 的 Rating 更改为 $1$ 到 $10^9$ 之间的任意整数。为了在截止日期前完成任务，B 太郎想要最小化更改列表中 Rating 的总成本。\n\n编写一个程序，给定选手的数量、采访获得的信息、Rating 列表、和更改每个选手 Rating 所用的花费。请你计算不与采访信息矛盾的情况下，最少需要花费多少日元。", "inputFormat": "第一行，一个正整数 $n$。\n\n第 $2 \\sim n + 1$ 行，每行三个正整数，$a_i,\\ h_i,\\ c_i$。", "outputFormat": "仅一行一个正整数，表示不与采访信息矛盾的情况下，最少需要花费的日元钱数。", "hint": "#### 样例 #1 解释\n\n如下表所示。\n\n| 选手 | 原 Rating | 更改为 | 花费日元 |\n| :-: | :-: | :-: | :-: |\n| $1$ | $6$ | $1$ | $5$ |\n| $3$ | $8$ | $4$ | $4$ |\n| $5$ | $2$ | $10^9$ | $5$ |\n\n花费了 $5+4+5=14$ 日元。\n\n本样例满足 Subtask $1, 2, 3$。\n\n\n#### 样例 #2 解释\n\n信息一致，输出 $\\tt 0$。\n\n#### 样例 #3 解释\n\n本样例满足 Subtask $1, 2, 3$。\n\n#### 数据规模与约定\n\n**本题采用 Subtask 计分法。**\n\n| Subtask | 分值占比百分率 | 特殊限制 |\n| :-: | :-: | :-: |\n| $1$ | $14\\%$ | $n \\le 5 \\times 10^3$，$a_1 = 1$，$a_i \\le i - 1$，且 $2 \\le i \\le n$ |\n| $2$ | $65\\%$ | $a_1 = 1$，$a_i \\le i - 1$，且 $2 \\le i \\le n$ |\n| $3$ | $21\\%$ | / |\n\n**注：斜线表示无特殊限制。**\n\n对于 $100\\%$ 的数据：\n\n- $2 \\le n \\le 2 \\times 10^5$；\n- $1 \\le a_i \\le n\\ (1\\le i\\le n)$；\n- $1\\le h_i,\\ c_i \\le 10^9\\ (1\\le i\\le n)$；\n\n\n#### 说明\n\n本题译自 [第２０回日本情報オリンピック 2020/2021春季トレーニング合宿 -](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/index.html) [競技 4 -](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day4/2021-sp-d4-notice.pdf) [T3 日文题面](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day4/worst_reporter4.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOISC 2021] 最悪の記者 4 (Worst Reporter 4) (Day4)", "background": "B 太郎不可爱。", "description": "B 太郎是一名主要写关于 OI 的报道的记者。再过几天，就要举行 IOI 了，B 太郎决定写一篇关于 IOI 的文章。\n\n比赛将有 $n$ 名选手参加，每位选手的编号从 $1$ 到 $n$。每位选手都有一个 Rating，这是衡量其实力的标准。Rating 用 $1$ 至 $10^9$ 之间的整数表示。\n\nB 太郎采访了每位选手，并获得了以下信息：\n\n- 选手 $i\\ (1\\le i\\le N)$ 的 Rating 大于等于选手 $a_i\\ (1\\le a_i \\le n)$ 的 Rating（$a_i$ 可以等于 $i$）。\n\n在所有的采访结束后，B 太郎从管理 Rating 系统的公司收到了一张表格，上面有每个选手的 Rating。 表上写着以下信息：\n\n- 选手 $i\\ (1 \\le i \\le n)$ 的 Rating 是 $h_i$。\n\n当 B 太郎试图根据这些信息写一篇文章时，他发现每个选手的 Rating 表可能存在错误。\n\n由于临近截止时间，没有时间去弄正确的 Rating 表。因此，B 太郎决定重写表中选手的 Rating，使其与采访中获得的信息不相矛盾。\n\nB 太郎在表中改写选手 $i\\ (1\\le i \\le n)$ 的 Rating 需要 $c_i$ 日元。\n\n也就是说，B 太郎可以通过支付 $c_i$ 日元，将列表中选手 $i$ 的 Rating 更改为 $1$ 到 $10^9$ 之间的任意整数。为了在截止日期前完成任务，B 太郎想要最小化更改列表中 Rating 的总成本。\n\n编写一个程序，给定选手的数量、采访获得的信息、Rating 列表、和更改每个选手 Rating 所用的花费。请你计算不与采访信息矛盾的情况下，最少需要花费多少日元。", "inputFormat": "第一行，一个正整数 $n$。\n\n第 $2 \\sim n + 1$ 行，每行三个正整数，$a_i,\\ h_i,\\ c_i$。", "outputFormat": "仅一行一个正整数，表示不与采访信息矛盾的情况下，最少需要花费的日元钱数。", "hint": "#### 样例 #1 解释\n\n如下表所示。\n\n| 选手 | 原 Rating | 更改为 | 花费日元 |\n| :-: | :-: | :-: | :-: |\n| $1$ | $6$ | $1$ | $5$ |\n| $3$ | $8$ | $4$ | $4$ |\n| $5$ | $2$ | $10^9$ | $5$ |\n\n花费了 $5+4+5=14$ 日元。\n\n本样例满足 Subtask $1, 2, 3$。\n\n\n#### 样例 #2 解释\n\n信息一致，输出 $\\tt 0$。\n\n#### 样例 #3 解释\n\n本样例满足 Subtask $1, 2, 3$。\n\n#### 数据规模与约定\n\n**本题采用 Subtask 计分法。**\n\n| Subtask | 分值占比百分率 | 特殊限制 |\n| :-: | :-: | :-: |\n| $1$ | $14\\%$ | $n \\le 5 \\times 10^3$，$a_1 = 1$，$a_i \\le i - 1$，且 $2 \\le i \\le n$ |\n| $2$ | $65\\%$ | $a_1 = 1$，$a_i \\le i - 1$，且 $2 \\le i \\le n$ |\n| $3$ | $21\\%$ | / |\n\n**注：斜线表示无特殊限制。**\n\n对于 $100\\%$ 的数据：\n\n- $2 \\le n \\le 2 \\times 10^5$；\n- $1 \\le a_i \\le n\\ (1\\le i\\le n)$；\n- $1\\le h_i,\\ c_i \\le 10^9\\ (1\\le i\\le n)$；\n\n\n#### 说明\n\n本题译自 [第２０回日本情報オリンピック 2020/2021春季トレーニング合宿 -](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/index.html) [競技 4 -](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day4/2021-sp-d4-notice.pdf) [T3 日文题面](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day4/worst_reporter4.pdf)。", "locale": "zh-CN"}}}
{"pid": "P7564", "type": "P", "difficulty": 7, "samples": [["2 2\n1 2 1 4\n3 1 3 2\n1 2\n3 3", "8\n2"], ["3 2\n3 1 5 2\n1 4 1 4\n4 2 4 4\n2 2\n6 3", "15\n0"], ["5 5\n8 1 4 10\n8 3 7 6\n1 4 6 2\n3 9 5 4\n6 1 9 6\n7 6\n6 8\n1 3\n9 4\n2 4", "30\n27\n48\n30\n48"]], "limits": {"time": [25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000, 25000], "memory": [4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000]}, "tags": ["动态规划 DP", "线段树", "2021", "离散化", "李超线段树", "JOISC/JOIST（日本）"], "title": "[JOISC 2021] ボディーガード (Day3)", "background": "因为数据包过大，如果洛谷上无法下载错误测试数据，请在 [此处](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day3/bodyguard-data.zip) 获取完整数据。", "description": "在一条数轴上，有 $N$ 个人，他们都是书虫保镖公司的顾客，第 $i$ 个人会在第 $T_i$ 个时刻从第 $A_i$ 个位置移动到第 $B_i$ 个位置，他们的速度是每一个时刻一个单位长度。\n\n如果一个保镖与一个顾客同时在一个位置上，就称保镖在保护这个顾客。设这个保镖从 $a$ 时刻开始保护一个顾客 $i$，从 $b$ 时刻停止保护，那么区间 $[a,b]$ 就称为这个顾客的保护时间，时刻 $a$ 称为保护开始时间，时刻 $b$ 称为保护停止时间。**其中 $a$ 和 $b$ 不必是整数**。特殊地，如果一个保镖与两个顾客同时在一个位置上，保镖只能保护一个顾客。\n\n保镖可以在数轴上以最多每一个时刻一个单位长度最少静止不动的速度随意移动，当保镖停止保护一个顾客的时候，他可以到另一个位置上保护另一个顾客。如果一个保镖保护第 $i$ 个顾客一起走过的路径长度为 $L$，那么顾客 $i$ 将会以 $C_i$ 津巴布韦币每单位长度给这个保镖 $ L \\times C_i$ 津巴布韦币作为他的工资。\n\n书虫作为书虫保镖公司的老板，他手里紧握着 $Q$ 份策划保护的方案，其中，第 $j$ 个方案，一个保镖从时刻 $P_j$ 开始从第 $X_j$ 个位置出发开始进行工作。\n\n求对于每个方案，每个保镖获得的总工资数量最多是多少津巴布韦币。", "inputFormat": "第一行两个整数 $N,Q$ 代表顾客数和策划保护的方案数。\n\n接下来 $N$ 行每行四个整数 $T_i,A_i,B_i,C_i$ 描述一位顾客。\n\n接下来 $Q$ 行每行两个整数 $P_j,X_j$ 描述一个策划保护的方案。", "outputFormat": "$Q$ 行每行一个整数代表每个方案保镖会得到的总工资最多是多少津巴布韦币。", "hint": "#### 样例 1 解释\n\n- 保护方案 $1$ 中保镖可以按照下面的方式得到 $4+4=8$ 津巴布韦币：\n\t- 在时刻 $1$ 从 $2$ 位置开始行动。\n    - 从时刻 $1$ 到时刻 $2$ 保护顾客 $1$，一起走过的路径长度为 $1$，得到 $4 \\times 1=4$ 津巴布韦币。\n    - 时刻 $2$ 到时刻 $3$ 停留在 $1$ 位置。\n    - 从时刻 $3$ 到时刻 $5$ 保护顾客 $2$，一起走过的路径长度为 $2$，得到 $2 \\times 2=4$ 津巴布韦币。\n- 保护方案 $2$ 中保镖可以按照下面的方式得到 $2$ 津巴布韦币：\n\t- 在时刻 $3$ 从 $3$ 位置开始行动。\n    - 时刻 $3$ 到时刻 $4$ 从 $3$ 位置移动到 $2$ 位置。\n    - 从时刻 $4$ 到时刻 $5$ 保护顾客 $2$，一起走过的路径长度为 $1$，得到 $2 \\times 1=2$ 津巴布韦币。\n\n#### 样例 2 解释\n\n- 保护方案 $1$ 中保镖可以按照下面的方式得到 $4+1+8+2=15$ 津巴布韦币：\n\t- 在时刻 $2$ 从 $2$ 位置开始行动。\n    - 时刻 $2$ 到时刻 $2.5$ 从 $2$ 位置移动到 $2.5$ 位置。\n    - 从时刻 $2.5$ 到时刻 $3.5$ 保护顾客 $2$，一起走过的路径长度为 $1$，得到 $4 \\times 1=4$ 津巴布韦币。\n    - 从时刻 $3.5$ 到时刻 $4$ 保护顾客 $1$，一起走过的路径长度为 $0.5$，得到 $2 \\times 0.5=1$ 津巴布韦币。\n    - 从时刻 $4$ 到时刻 $6$ 保护顾客 $3$，一起走过的路径长度为 $2$，得到 $4 \\times 2=8$ 津巴布韦币。\n    - 从时刻 $6$ 到时刻 $7$ 保护顾客 $1$，一起走过的路径长度为 $1$，得到 $2 \\times 1=2$ 津巴布韦币。\n- 保护方案 $2$ 中保镖无论怎么走都得不到工资，只能得到 $0$ 津巴布韦币。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（6 pts）：$T_i,A_i,B_i,P_j,X_j \\le 3000$。\n- Subtask 2（7 pts）：$Q=1$。\n- Subtask 3（15 pts）：$Q \\le 3000$。\n- Subtask 4（20 pts）：$Q \\le 4 \\times 10^4$。\n- Subtask 5（52 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 2800$，$1 \\le Q \\le 3 \\times 10^6$，$1 \\le T_i,A_i,B_i,C_i \\le 10^9$，$A_i \\ne B_i$，$C_i$ 为偶数，$1 \\le P_j,X_j \\le 10^9$。\n\n#### 说明\n\n翻译自 [第２０回日本情報オリンピック　春季トレーニング合宿](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/index.html) [Day3 B ボディーガード (Bodyguard) 的英文版本](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day3/bodyguard-en.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOISC 2021] ボディーガード (Day3)", "background": "因为数据包过大，如果洛谷上无法下载错误测试数据，请在 [此处](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day3/bodyguard-data.zip) 获取完整数据。", "description": "在一条数轴上，有 $N$ 个人，他们都是书虫保镖公司的顾客，第 $i$ 个人会在第 $T_i$ 个时刻从第 $A_i$ 个位置移动到第 $B_i$ 个位置，他们的速度是每一个时刻一个单位长度。\n\n如果一个保镖与一个顾客同时在一个位置上，就称保镖在保护这个顾客。设这个保镖从 $a$ 时刻开始保护一个顾客 $i$，从 $b$ 时刻停止保护，那么区间 $[a,b]$ 就称为这个顾客的保护时间，时刻 $a$ 称为保护开始时间，时刻 $b$ 称为保护停止时间。**其中 $a$ 和 $b$ 不必是整数**。特殊地，如果一个保镖与两个顾客同时在一个位置上，保镖只能保护一个顾客。\n\n保镖可以在数轴上以最多每一个时刻一个单位长度最少静止不动的速度随意移动，当保镖停止保护一个顾客的时候，他可以到另一个位置上保护另一个顾客。如果一个保镖保护第 $i$ 个顾客一起走过的路径长度为 $L$，那么顾客 $i$ 将会以 $C_i$ 津巴布韦币每单位长度给这个保镖 $ L \\times C_i$ 津巴布韦币作为他的工资。\n\n书虫作为书虫保镖公司的老板，他手里紧握着 $Q$ 份策划保护的方案，其中，第 $j$ 个方案，一个保镖从时刻 $P_j$ 开始从第 $X_j$ 个位置出发开始进行工作。\n\n求对于每个方案，每个保镖获得的总工资数量最多是多少津巴布韦币。", "inputFormat": "第一行两个整数 $N,Q$ 代表顾客数和策划保护的方案数。\n\n接下来 $N$ 行每行四个整数 $T_i,A_i,B_i,C_i$ 描述一位顾客。\n\n接下来 $Q$ 行每行两个整数 $P_j,X_j$ 描述一个策划保护的方案。", "outputFormat": "$Q$ 行每行一个整数代表每个方案保镖会得到的总工资最多是多少津巴布韦币。", "hint": "#### 样例 1 解释\n\n- 保护方案 $1$ 中保镖可以按照下面的方式得到 $4+4=8$ 津巴布韦币：\n\t- 在时刻 $1$ 从 $2$ 位置开始行动。\n    - 从时刻 $1$ 到时刻 $2$ 保护顾客 $1$，一起走过的路径长度为 $1$，得到 $4 \\times 1=4$ 津巴布韦币。\n    - 时刻 $2$ 到时刻 $3$ 停留在 $1$ 位置。\n    - 从时刻 $3$ 到时刻 $5$ 保护顾客 $2$，一起走过的路径长度为 $2$，得到 $2 \\times 2=4$ 津巴布韦币。\n- 保护方案 $2$ 中保镖可以按照下面的方式得到 $2$ 津巴布韦币：\n\t- 在时刻 $3$ 从 $3$ 位置开始行动。\n    - 时刻 $3$ 到时刻 $4$ 从 $3$ 位置移动到 $2$ 位置。\n    - 从时刻 $4$ 到时刻 $5$ 保护顾客 $2$，一起走过的路径长度为 $1$，得到 $2 \\times 1=2$ 津巴布韦币。\n\n#### 样例 2 解释\n\n- 保护方案 $1$ 中保镖可以按照下面的方式得到 $4+1+8+2=15$ 津巴布韦币：\n\t- 在时刻 $2$ 从 $2$ 位置开始行动。\n    - 时刻 $2$ 到时刻 $2.5$ 从 $2$ 位置移动到 $2.5$ 位置。\n    - 从时刻 $2.5$ 到时刻 $3.5$ 保护顾客 $2$，一起走过的路径长度为 $1$，得到 $4 \\times 1=4$ 津巴布韦币。\n    - 从时刻 $3.5$ 到时刻 $4$ 保护顾客 $1$，一起走过的路径长度为 $0.5$，得到 $2 \\times 0.5=1$ 津巴布韦币。\n    - 从时刻 $4$ 到时刻 $6$ 保护顾客 $3$，一起走过的路径长度为 $2$，得到 $4 \\times 2=8$ 津巴布韦币。\n    - 从时刻 $6$ 到时刻 $7$ 保护顾客 $1$，一起走过的路径长度为 $1$，得到 $2 \\times 1=2$ 津巴布韦币。\n- 保护方案 $2$ 中保镖无论怎么走都得不到工资，只能得到 $0$ 津巴布韦币。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（6 pts）：$T_i,A_i,B_i,P_j,X_j \\le 3000$。\n- Subtask 2（7 pts）：$Q=1$。\n- Subtask 3（15 pts）：$Q \\le 3000$。\n- Subtask 4（20 pts）：$Q \\le 4 \\times 10^4$。\n- Subtask 5（52 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 2800$，$1 \\le Q \\le 3 \\times 10^6$，$1 \\le T_i,A_i,B_i,C_i \\le 10^9$，$A_i \\ne B_i$，$C_i$ 为偶数，$1 \\le P_j,X_j \\le 10^9$。\n\n#### 说明\n\n翻译自 [第２０回日本情報オリンピック　春季トレーニング合宿](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/index.html) [Day3 B ボディーガード (Bodyguard) 的英文版本](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day3/bodyguard-en.pdf)。", "locale": "zh-CN"}}}
{"pid": "P7565", "type": "P", "difficulty": 6, "samples": [["5\n1 2\n2 3\n4 2\n3 5", "1\n4\n1\n2\n1"], ["7\n1 2\n2 3\n3 4\n4 5\n2 6\n3 7", "1\n5\n1\n3\n1\n2\n1"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2021", "JOISC/JOIST（日本）"], "title": "[JOISC 2021] ビーバーの会合 2 (Day3)", "background": "", "description": "给定一棵有 $N$ 个点的树，每一个点上有一个人，这些人要开秘密会议。\n\n假设一次秘密会议有 $P$ 个人参加，这 $P$ 个人分别在第 $p_1,p_2,\\cdots,p_P$ 个点上。如果点 $k$ 满足下面这个值最小（$d(a,b)$ 为点 $a$ 到点 $b$ 的距离，$k$ 不需要满足 $k \\in \\{p_1,p_2,\\cdots,p_P\\}$）：\n\n$$\\sum\\limits_{i=1}^Pd(k,p_i)$$\n\n那么就称第 $k$ 个点为可期待的，这场会议的期待值即为所有点中中可期待点的个数。\n\n对于每个 $j \\in [1,N]$，求当会议里有 $j$ 个人的时候，会议的期待值的最大值是多少。", "inputFormat": "第一行一个整数 $N$ 代表树的点数。\n\n接下来 $N-1$ 行每行两个整数 $A_i,B_i$ 代表一条边。", "outputFormat": "$N$ 行每行一个整数，第 $j$ 行代表会议有 $j$ 个人时的答案。", "hint": "#### 样例 1 解释\n\n下文我们称 $\\displaystyle\\beta_k=\\sum\\limits_{i=1}^Pd(k,p_i)$。\n\n拿样例 1 中的树举个例子，假设这一次会议参加者为第 $1$ 个点上的人和第 $3$ 个点上的人，则：\n\n- $P=2$，$p_i=\\{1,3\\}$。\n- $\\beta_1=2$。\n- $\\beta_2=2$。\n- $\\beta_3=2$。\n- $\\beta_4=4$。\n- $\\beta_5=4$。\n\n$\\min\\limits_{i=1}^5\\{\\beta_i\\}=2$，满足要求的点为 $1,2,3$，该会议的期待值为 $3$。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（4 pts）：$N \\le 16$。\n- Subtask 2（16 pts）：$N \\le 4000$。\n- Subtask 3（80 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 2 \\times 10^5$，$1 \\le A_i,B_i \\le N$。\n\n#### 说明\n\n翻译自 [第２０回日本情報オリンピック　春季トレーニング合宿](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/index.html) [Day3 C ビーバーの会合 2 (Meetings 2) 的英文版本](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day3/meetings2-en.pdf)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JOISC 2021] ビーバーの会合 2 (Day3)", "background": "", "description": "给定一棵有 $N$ 个点的树，每一个点上有一个人，这些人要开秘密会议。\n\n假设一次秘密会议有 $P$ 个人参加，这 $P$ 个人分别在第 $p_1,p_2,\\cdots,p_P$ 个点上。如果点 $k$ 满足下面这个值最小（$d(a,b)$ 为点 $a$ 到点 $b$ 的距离，$k$ 不需要满足 $k \\in \\{p_1,p_2,\\cdots,p_P\\}$）：\n\n$$\\sum\\limits_{i=1}^Pd(k,p_i)$$\n\n那么就称第 $k$ 个点为可期待的，这场会议的期待值即为所有点中中可期待点的个数。\n\n对于每个 $j \\in [1,N]$，求当会议里有 $j$ 个人的时候，会议的期待值的最大值是多少。", "inputFormat": "第一行一个整数 $N$ 代表树的点数。\n\n接下来 $N-1$ 行每行两个整数 $A_i,B_i$ 代表一条边。", "outputFormat": "$N$ 行每行一个整数，第 $j$ 行代表会议有 $j$ 个人时的答案。", "hint": "#### 样例 1 解释\n\n下文我们称 $\\displaystyle\\beta_k=\\sum\\limits_{i=1}^Pd(k,p_i)$。\n\n拿样例 1 中的树举个例子，假设这一次会议参加者为第 $1$ 个点上的人和第 $3$ 个点上的人，则：\n\n- $P=2$，$p_i=\\{1,3\\}$。\n- $\\beta_1=2$。\n- $\\beta_2=2$。\n- $\\beta_3=2$。\n- $\\beta_4=4$。\n- $\\beta_5=4$。\n\n$\\min\\limits_{i=1}^5\\{\\beta_i\\}=2$，满足要求的点为 $1,2,3$，该会议的期待值为 $3$。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（4 pts）：$N \\le 16$。\n- Subtask 2（16 pts）：$N \\le 4000$。\n- Subtask 3（80 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 2 \\times 10^5$，$1 \\le A_i,B_i \\le N$。\n\n#### 说明\n\n翻译自 [第２０回日本情報オリンピック　春季トレーニング合宿](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/index.html) [Day3 C ビーバーの会合 2 (Meetings 2) 的英文版本](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day3/meetings2-en.pdf)。", "locale": "zh-CN"}}}
{"pid": "P7566", "type": "P", "difficulty": 1, "samples": [["5\nMINE\nCRAFT\nOLYMPIAD\nIN\nINFORMATICS", "7"]], "limits": {"time": [500, 500, 500], "memory": [131072, 131072, 131072]}, "tags": [], "title": "饱食", "background": "", "description": "书虫背包里有 $n$ 只兔兔，第 $i$ 只兔兔被书虫编号为一个由大写字母组成的字符串 $S_i$。\n\n书虫会 +C+，他用 +C+ 编写出了 `random` 函数，随机抽取出了三只兔兔。\n\n不过书虫暂时得了神经性厌食症，书虫能吃下这三只兔兔当且仅当：\n\n- 编号的首字母为 `M`，`C`，`O` 或 `I` 中的任意一个。\n- 编号的首字母不能相同。\n\n书虫想问有多少种选择方案使得他能吃下他选的的三只兔兔？", "inputFormat": "第一行一个整数 $n$ 代表兔兔个数。\n\n接下来 $n$ 行每行一个字符串 $S_i$ 代表一只兔兔。", "outputFormat": "一行一个整数代表答案。", "hint": "#### 样例 1 解释\n\n有如下 $7$ 种选择方式：\n\n- `MINE`，`CRAFT`，`OLYMPIAD`。\n- `MINE`，`CRAFT`，`IN`。\n- `MINE`，`CRAFT`，`INFORMATICS`。\n- `MINE`，`OLYMPIAD`，`IN`。\n- `MINE`，`OLYMPIAD`，`INFORMATICS`。\n- `CRAFT`，`OLYMPIAD`，`IN`。\n- `CRAFT`，`OLYMPIAD`，`INFORMATICS`。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（10 pts）：$S_i$ 首字母均为 `M`。\n- Subtask 2（30 pts）：$n \\le 100$。\n- Subtask 3（60 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le n\\le10^5$，$1 \\le |S_i| \\le 11$，$S_i$ 由大写字母组成。\n\n数据不保证 $S_i$ 互不相同。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "饱食", "background": "", "description": "书虫背包里有 $n$ 只兔兔，第 $i$ 只兔兔被书虫编号为一个由大写字母组成的字符串 $S_i$。\n\n书虫会 +C+，他用 +C+ 编写出了 `random` 函数，随机抽取出了三只兔兔。\n\n不过书虫暂时得了神经性厌食症，书虫能吃下这三只兔兔当且仅当：\n\n- 编号的首字母为 `M`，`C`，`O` 或 `I` 中的任意一个。\n- 编号的首字母不能相同。\n\n书虫想问有多少种选择方案使得他能吃下他选的的三只兔兔？", "inputFormat": "第一行一个整数 $n$ 代表兔兔个数。\n\n接下来 $n$ 行每行一个字符串 $S_i$ 代表一只兔兔。", "outputFormat": "一行一个整数代表答案。", "hint": "#### 样例 1 解释\n\n有如下 $7$ 种选择方式：\n\n- `MINE`，`CRAFT`，`OLYMPIAD`。\n- `MINE`，`CRAFT`，`IN`。\n- `MINE`，`CRAFT`，`INFORMATICS`。\n- `MINE`，`OLYMPIAD`，`IN`。\n- `MINE`，`OLYMPIAD`，`INFORMATICS`。\n- `CRAFT`，`OLYMPIAD`，`IN`。\n- `CRAFT`，`OLYMPIAD`，`INFORMATICS`。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（10 pts）：$S_i$ 首字母均为 `M`。\n- Subtask 2（30 pts）：$n \\le 100$。\n- Subtask 3（60 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le n\\le10^5$，$1 \\le |S_i| \\le 11$，$S_i$ 由大写字母组成。\n\n数据不保证 $S_i$ 互不相同。", "locale": "zh-CN"}}}
{"pid": "P7567", "type": "P", "difficulty": 3, "samples": [["2\n4\n114513", "1 -1 2 -2\nw33zAKIOI"], ["1\n1", "w33zAKIOI"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["Special Judge", "O2优化", "构造", "洛谷月赛"], "title": "「MCOI-05」魔仙", "background": "你是魔仙堡里的占星魔仙。", "description": "魔仙女王的宝石被古娜拉黑暗之神偷走了！古娜拉黑暗之神藏在魔仙堡的 $n$ 个穹顶中的任意一个里面，这 $n$ 个穹顶编号为 $1 \\sim n$，第 $i$ 个穹顶可以将其赋予 $a_i$ 的魔力，$a_i$ 必须是整数。\n\n如果所有穹顶的魔力之和为 $0$，之积为 $n$，那么我们称这种情况是可以轻易搜索出古娜拉黑暗之神的。\n\n魔仙女王让占星魔仙求一种赋予魔力的情况使得是可以轻易搜索出古娜拉黑暗之神的。", "inputFormat": "**本题有多组数据。**  \n\n第一行一个正整数 $T$，表示表示数据的组数。 \n\n接下来 $T$ 行，一行一个整数 $n$。", "outputFormat": "输出 $T$ 行，第 $i$ 行含第 $i$ 组数据的答案。\n\n如果有解，输出一行 $n$ 个整数代表构造出的魔力值。否则，输出 `w33zAKIOI`。\n\n**本题采用 Special Judge**，你只需要输出其中一种序列。", "hint": "#### 样例 1 解释\n\n$1 +(-1)+2+(-2)=0$，$1 \\times (-1) \\times 2 \\times (-2)=4$。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n - Subtask 1（5 pts）：$n\\le 1$\n - Subtask 2（20 pts）：$n,\\sum n\\le 100$\n - Subtask 3（75 pts）：没有特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n\\le10^6$，$\\sum n\\le 5\\times10^6$，$1\\le T\\le10^5$。\n\n**本题采用 Special Judge**，你只需要输出其中一种序列。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-05」魔仙", "background": "你是魔仙堡里的占星魔仙。", "description": "魔仙女王的宝石被古娜拉黑暗之神偷走了！古娜拉黑暗之神藏在魔仙堡的 $n$ 个穹顶中的任意一个里面，这 $n$ 个穹顶编号为 $1 \\sim n$，第 $i$ 个穹顶可以将其赋予 $a_i$ 的魔力，$a_i$ 必须是整数。\n\n如果所有穹顶的魔力之和为 $0$，之积为 $n$，那么我们称这种情况是可以轻易搜索出古娜拉黑暗之神的。\n\n魔仙女王让占星魔仙求一种赋予魔力的情况使得是可以轻易搜索出古娜拉黑暗之神的。", "inputFormat": "**本题有多组数据。**  \n\n第一行一个正整数 $T$，表示表示数据的组数。 \n\n接下来 $T$ 行，一行一个整数 $n$。", "outputFormat": "输出 $T$ 行，第 $i$ 行含第 $i$ 组数据的答案。\n\n如果有解，输出一行 $n$ 个整数代表构造出的魔力值。否则，输出 `w33zAKIOI`。\n\n**本题采用 Special Judge**，你只需要输出其中一种序列。", "hint": "#### 样例 1 解释\n\n$1 +(-1)+2+(-2)=0$，$1 \\times (-1) \\times 2 \\times (-2)=4$。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n - Subtask 1（5 pts）：$n\\le 1$\n - Subtask 2（20 pts）：$n,\\sum n\\le 100$\n - Subtask 3（75 pts）：没有特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n\\le10^6$，$\\sum n\\le 5\\times10^6$，$1\\le T\\le10^5$。\n\n**本题采用 Special Judge**，你只需要输出其中一种序列。", "locale": "zh-CN"}}}
{"pid": "P7568", "type": "P", "difficulty": 5, "samples": [["2 2\n1 2\n1 2\n", "0 3 3"], ["23 22\n2 1\n14 10\n4 9\n12 11\n2 1\n4 9\n12 3\n5 3\n5 6\n4 13\n5 5\n15 15\n7 22\n7 22\n7 1\n6 3\n1 2\n1 2\n2 1\n18 16\n19 17\n20 8\n21 8", "0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 72 456 0 0\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["O2优化", "洛谷月赛"], "title": "「MCOI-05」追杀", "background": "", "description": "Dream SMP 具有 $m$ 位玩家，编号为 $1$ 至 $m$。初始时，每一位玩家生命数量为 $3$。一位玩家 **公认活着**（canonically alive） 当且仅当生命值非零。\n\nDream SMP 经常发生大型战争，于是会有玩家杀（PvP）别的玩家。对于活着玩家 $u$ 与 $v$，如果 $u$ 杀 $v$，$v$ 的生命数量扣除一次。注意，如果 $u$ 或 $v$ 不为公认活着，杀没有影响。\n\n总共按时序记录了 $n$ 次追杀 $1,2,\\dots,n$，其中第 $k$ 次追杀为 $u_k$ 杀 $v_k$。\n\nDreamXD（玩家 $0$）解锁了时空穿越超能力。他现在可以选取任何 $i,v$ 使得 $1\\le i\\le n+1$ 并且 $1\\le v\\le m$，穿越到第 $i-1$ 次追杀之后与第 $i$ 次追杀之前，并追杀玩家 $v$。$i=n+1$ 表示穿越到第 $n$ 次追杀后。\n\n不同 $i$ 和 $v$ 可能导致最终活着玩家集合不同。对于每一个 $x$ 使得 $0\\le x\\le m$，DreamXD 想知道，有多少种 $i,v$ 使最后公认活着玩家集合恰好含有 $x$ 位玩家？", "inputFormat": "第一行两个正整数 $n,m$。  \n接下来 $n$ 行，第 $k$ 行两个正整数 $u_k,v_k$，表示在第 $k$ 时刻，$u_k$ 追杀 $v_k$。", "outputFormat": "输出一行 $m+1$ 个正整数，其中第 $x$ 个为最终有 $x-1$ 位玩家活（不包含 Dream）的方案数。", "hint": "#### 样例 2 解释\n\n本样例对应 Dream SMP 当前（4/26/2021) 情况，仅包含公认死亡，即对应剧本，的次数：\n\n - Aug 2, 2020: Tommy killed by Dream  \n - Aug 2, 2020: Fundy killed by George  \n - Aug 2, 2020: Wilbur killed by Punz  \n - Aug 2, 2020: Tubbo killed by Sapnap  \n - Aug 2, 2020: Tommy killed by Dream  \n - Sep 2, 2020: Wilbur killed by Punz  \n - Oct 16, 2020: Tubbo killed by Techno  \n - Oct 16, 2020: Schlatt killed by Techno  \n - Oct 17, 2020: Schlatt killed by Quackity  \n - Nov 16, 2020: Wilbur killed by Philza  \n - Nov 16, 2020: Schlatt killed by Schlatt  \n - Dec 6, 2020: Karl killed by Karl  \n - Dec 14, 2020: Mexican Dream killed by Natural Causes\n - Dec 14, 2020: Mexican Dream killed by Natural Causes\n - Dec 14, 2020: Mexican Dream killed by Dream  \n - Dec 16, 2020: Quackity killed by Techno  \n - Jan 20, 2021: Dream killed by Tommy  \n - Jan 20, 2021: Dream killed by Tommy  \n - Mar 1, 2021: Tommy killed by Dream  \n - Mar 12, 2021: Connor killed by Ranboo  \n - Mar 23, 2021: Ponk killed by Sam  \n - Apr 18, 2021: Skeppy killed by Bad  \n - Apr 26, 2021: Foolish killed by Bad\n\n\n**本题采用捆绑测试。**\n\n - Subtask 1（5 pts）：$n\\le5$，$m=1$。\n - Subtask 2（11 pts）：$n,m\\le100$。\n - Subtask 3（41 pts）：$n\\le10^3$。\n - Subtask 4（43 pts）：没有特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le n\\le6\\times10^4$，$1\\le m\\le10^3$，$1\\le u_i,v_i\\le m$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-05」追杀", "background": "", "description": "Dream SMP 具有 $m$ 位玩家，编号为 $1$ 至 $m$。初始时，每一位玩家生命数量为 $3$。一位玩家 **公认活着**（canonically alive） 当且仅当生命值非零。\n\nDream SMP 经常发生大型战争，于是会有玩家杀（PvP）别的玩家。对于活着玩家 $u$ 与 $v$，如果 $u$ 杀 $v$，$v$ 的生命数量扣除一次。注意，如果 $u$ 或 $v$ 不为公认活着，杀没有影响。\n\n总共按时序记录了 $n$ 次追杀 $1,2,\\dots,n$，其中第 $k$ 次追杀为 $u_k$ 杀 $v_k$。\n\nDreamXD（玩家 $0$）解锁了时空穿越超能力。他现在可以选取任何 $i,v$ 使得 $1\\le i\\le n+1$ 并且 $1\\le v\\le m$，穿越到第 $i-1$ 次追杀之后与第 $i$ 次追杀之前，并追杀玩家 $v$。$i=n+1$ 表示穿越到第 $n$ 次追杀后。\n\n不同 $i$ 和 $v$ 可能导致最终活着玩家集合不同。对于每一个 $x$ 使得 $0\\le x\\le m$，DreamXD 想知道，有多少种 $i,v$ 使最后公认活着玩家集合恰好含有 $x$ 位玩家？", "inputFormat": "第一行两个正整数 $n,m$。  \n接下来 $n$ 行，第 $k$ 行两个正整数 $u_k,v_k$，表示在第 $k$ 时刻，$u_k$ 追杀 $v_k$。", "outputFormat": "输出一行 $m+1$ 个正整数，其中第 $x$ 个为最终有 $x-1$ 位玩家活（不包含 Dream）的方案数。", "hint": "#### 样例 2 解释\n\n本样例对应 Dream SMP 当前（4/26/2021) 情况，仅包含公认死亡，即对应剧本，的次数：\n\n - Aug 2, 2020: Tommy killed by Dream  \n - Aug 2, 2020: Fundy killed by George  \n - Aug 2, 2020: Wilbur killed by Punz  \n - Aug 2, 2020: Tubbo killed by Sapnap  \n - Aug 2, 2020: Tommy killed by Dream  \n - Sep 2, 2020: Wilbur killed by Punz  \n - Oct 16, 2020: Tubbo killed by Techno  \n - Oct 16, 2020: Schlatt killed by Techno  \n - Oct 17, 2020: Schlatt killed by Quackity  \n - Nov 16, 2020: Wilbur killed by Philza  \n - Nov 16, 2020: Schlatt killed by Schlatt  \n - Dec 6, 2020: Karl killed by Karl  \n - Dec 14, 2020: Mexican Dream killed by Natural Causes\n - Dec 14, 2020: Mexican Dream killed by Natural Causes\n - Dec 14, 2020: Mexican Dream killed by Dream  \n - Dec 16, 2020: Quackity killed by Techno  \n - Jan 20, 2021: Dream killed by Tommy  \n - Jan 20, 2021: Dream killed by Tommy  \n - Mar 1, 2021: Tommy killed by Dream  \n - Mar 12, 2021: Connor killed by Ranboo  \n - Mar 23, 2021: Ponk killed by Sam  \n - Apr 18, 2021: Skeppy killed by Bad  \n - Apr 26, 2021: Foolish killed by Bad\n\n\n**本题采用捆绑测试。**\n\n - Subtask 1（5 pts）：$n\\le5$，$m=1$。\n - Subtask 2（11 pts）：$n,m\\le100$。\n - Subtask 3（41 pts）：$n\\le10^3$。\n - Subtask 4（43 pts）：没有特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le n\\le6\\times10^4$，$1\\le m\\le10^3$，$1\\le u_i,v_i\\le m$。", "locale": "zh-CN"}}}
{"pid": "P7569", "type": "P", "difficulty": 6, "samples": [["3 3 2\n", "NO\n"], ["3 3 3\n", "YES\nRDLDRRUU\n1 1"], ["6 4 4\n", "YES\nRRRDLLLDRRRDLLLDRRRDLLL\n1 1\n"], ["1 1 2000", "YES\n\n1 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["Special Judge", "洛谷月赛"], "title": "「MCOI-05」粘液", "background": "2077 年 7 月 7 日，MineCraft 20.7.7 发布了。这次更新允许了玩家将红石电路刻进一块电路板中进行运算。\n\n`namespace_std` 作为一只程序猿兼 MC 玩家，他想在新的版本用电路板建造一台简易的粘液块盾构机。\n\n然而，`namespace_std` 由于太久没玩 MC 了，建错了 TNT 复制装置，被炸上了外太空。所以搭建这个粘液块盾构机的任务就交给书虫了。\n\n书虫用他附有耐久 X 的肝写出了这个盾构机的程序。然而，事情并没有这么简单 ...", "description": "书虫有一个 $1 \\times 1$ 体积的盾构机，和一块 $n \\times m$ 个格子的地块，书虫打算用盾构机将这块地块推平。形式化地说，书虫需要让这个盾构机经过每一个格子 **恰好一次**。\n\n这看上去很简单。然而，这个盾构机的程序的实现却有一些故障。当盾构机向同一个方向 **连续** 移动 **达到** $k$ 步时，盾构机就会卡住并不断地向同一个地方投放 TNT。\n\n注意：最开始摆放盾构机**不视为移动**。换言之，盾构机应当移动 $n \\times m - 1$ 次。\n\n书虫并不想像可怜的 `namespace_std` 一样被炸上天，因此书虫希望找到一种安排盾构机路线的方案，使得盾构机 **不会** 被卡住。", "inputFormat": "输入一行三个整数 $n,m,k$，分别表示地块的长宽，以及盾构机程序中的 $k$ 值。", "outputFormat": "如果有合法的方案，输出三行：\n\n- 第一行输出一个字符串 `YES`；\n- 第二行输出一个长为 $n \\times m - 1$ 的只包含 `L`、`R`、`D`、`U` 的字符串，表示每一步移动的方向；\n- 第三行输出两个整数 $x,y$，表示书虫设计的路线起点为 $(x,y)$，即第 $x$ 行第 $y$ 列。当有多种可能的答案的时候，书虫可以输出 **任意一种**。\n\n否则，只需要输出一行 `NO`。\n\n请注意输出量可能较大，**请使用较快的输出方式**。\n", "hint": "#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 0（1 pts）：样例，您可以通过提交结果得知您的答案是否通过了 `Special Judge`。\n- Subtask 1（9 pts）：$n,m,k \\leq 3$。\n- Subtask 2（15 pts）：$n,m,k \\leq 10$。\n- Subtask 3（5 pts）：$k \\geq n$。\n- Subtask 4（15 pts）：$n \\leq 5$。\n- Subtask 5（20 pts）：$k \\geq 5$。\n- Subtask 6（10 pts）：保证存在合法解。\n- Subtask 7（25 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n,m,k \\le 2000$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-05」粘液", "background": "2077 年 7 月 7 日，MineCraft 20.7.7 发布了。这次更新允许了玩家将红石电路刻进一块电路板中进行运算。\n\n`namespace_std` 作为一只程序猿兼 MC 玩家，他想在新的版本用电路板建造一台简易的粘液块盾构机。\n\n然而，`namespace_std` 由于太久没玩 MC 了，建错了 TNT 复制装置，被炸上了外太空。所以搭建这个粘液块盾构机的任务就交给书虫了。\n\n书虫用他附有耐久 X 的肝写出了这个盾构机的程序。然而，事情并没有这么简单 ...", "description": "书虫有一个 $1 \\times 1$ 体积的盾构机，和一块 $n \\times m$ 个格子的地块，书虫打算用盾构机将这块地块推平。形式化地说，书虫需要让这个盾构机经过每一个格子 **恰好一次**。\n\n这看上去很简单。然而，这个盾构机的程序的实现却有一些故障。当盾构机向同一个方向 **连续** 移动 **达到** $k$ 步时，盾构机就会卡住并不断地向同一个地方投放 TNT。\n\n注意：最开始摆放盾构机**不视为移动**。换言之，盾构机应当移动 $n \\times m - 1$ 次。\n\n书虫并不想像可怜的 `namespace_std` 一样被炸上天，因此书虫希望找到一种安排盾构机路线的方案，使得盾构机 **不会** 被卡住。", "inputFormat": "输入一行三个整数 $n,m,k$，分别表示地块的长宽，以及盾构机程序中的 $k$ 值。", "outputFormat": "如果有合法的方案，输出三行：\n\n- 第一行输出一个字符串 `YES`；\n- 第二行输出一个长为 $n \\times m - 1$ 的只包含 `L`、`R`、`D`、`U` 的字符串，表示每一步移动的方向；\n- 第三行输出两个整数 $x,y$，表示书虫设计的路线起点为 $(x,y)$，即第 $x$ 行第 $y$ 列。当有多种可能的答案的时候，书虫可以输出 **任意一种**。\n\n否则，只需要输出一行 `NO`。\n\n请注意输出量可能较大，**请使用较快的输出方式**。\n", "hint": "#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 0（1 pts）：样例，您可以通过提交结果得知您的答案是否通过了 `Special Judge`。\n- Subtask 1（9 pts）：$n,m,k \\leq 3$。\n- Subtask 2（15 pts）：$n,m,k \\leq 10$。\n- Subtask 3（5 pts）：$k \\geq n$。\n- Subtask 4（15 pts）：$n \\leq 5$。\n- Subtask 5（20 pts）：$k \\geq 5$。\n- Subtask 6（10 pts）：保证存在合法解。\n- Subtask 7（25 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n,m,k \\le 2000$。", "locale": "zh-CN"}}}
{"pid": "P7570", "type": "P", "difficulty": 7, "samples": [["2 2\n1\n1 2\n1 2\n1\n1 2", "0"], ["8 2\n1 2 5 1 4 3 3\n2 4\n4 7\n3\n4 6\n5 7\n1 8", "0\n1\n4"]], "limits": {"time": [3000, 3000, 3000, 3000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["O2优化", "洛谷月赛"], "title": "「MCOI-05」多宇", "background": "", "description": "Dream 将时空抽象为一颗 $n$ 节点有向有根树，其中树根为节点 $1$ 并且所有边的方向都为浅往深。  \nDream 用他的超能力在这颗树上额外添加 $m$ 条有向边，但最终的图仍然是无环图。  \nDream 进而将一个事件抽象为图上的一个节点，将一个时代抽象为图上的一个简单路径。  \nDream 认为一对事件 $(i,j)$ **可行** 当且仅当存在一个时代，使得时代的首事件是 $i$，末事件是 $j$。  \nDream 不满足于统计普通可行对。他认为超能力添加的额外边十分重要。  \nDream 认为一对事件 $(i,j)$ **条件可行** 当且仅当 $(i,j)$ 可行并且所有额外边去掉之后 $(i,j)$ 非可行。  \nDream 现在有 $q$ 组询问。第 $i$ 组询问用两个正整数 $l_i$ 与 $r_i$ 表示，其中 $l_i\\le r_i$。  \nDream 想知道，对每一组询问，有多少对 **条件可行** 事件 $(i,j)$，使得 $l\\le i<j\\le r$。", "inputFormat": "第一行两个整数 $n,m$。    \n接下来一行 $n-1$ 个正整数描述树的结构。第 $i$ 个数代表 $i+1$ 号节点的父亲的编号 $f_i$，也就是说存在一个 $f_i$ 往 $i$ 的一条边。  \n接下来 $m$ 行，每行两个正整数 $u,v$，表示一条 $u$ 往 $v$ 额外添加的边。  \n接下来一个正整数 $q$。  \n接下来 $q$ 行，每行两个正整数 $l,r$，表示一组询问。", "outputFormat": "输出 $q$ 行，每行一个整数，表示对应组询问的答案。", "hint": "\n - Subtask 1（3 pts）：$n,q\\le 1000$，3s；\n - Subtask 2（29 pts）：$n,q\\le2\\times10^5$，$m\\le50$，3s；\n - Subtask 3（31 pts）：$m\\le 50$，5s；\n - Subtask 4（37 pts）：无额外限制，5s。\n\n对于 $100\\%$ 的数据，$2\\le n\\le7\\times10^5$，$1\\le q\\le3\\times10^5$，$0\\le m\\le100$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-05」多宇", "background": "", "description": "Dream 将时空抽象为一颗 $n$ 节点有向有根树，其中树根为节点 $1$ 并且所有边的方向都为浅往深。  \nDream 用他的超能力在这颗树上额外添加 $m$ 条有向边，但最终的图仍然是无环图。  \nDream 进而将一个事件抽象为图上的一个节点，将一个时代抽象为图上的一个简单路径。  \nDream 认为一对事件 $(i,j)$ **可行** 当且仅当存在一个时代，使得时代的首事件是 $i$，末事件是 $j$。  \nDream 不满足于统计普通可行对。他认为超能力添加的额外边十分重要。  \nDream 认为一对事件 $(i,j)$ **条件可行** 当且仅当 $(i,j)$ 可行并且所有额外边去掉之后 $(i,j)$ 非可行。  \nDream 现在有 $q$ 组询问。第 $i$ 组询问用两个正整数 $l_i$ 与 $r_i$ 表示，其中 $l_i\\le r_i$。  \nDream 想知道，对每一组询问，有多少对 **条件可行** 事件 $(i,j)$，使得 $l\\le i<j\\le r$。", "inputFormat": "第一行两个整数 $n,m$。    \n接下来一行 $n-1$ 个正整数描述树的结构。第 $i$ 个数代表 $i+1$ 号节点的父亲的编号 $f_i$，也就是说存在一个 $f_i$ 往 $i$ 的一条边。  \n接下来 $m$ 行，每行两个正整数 $u,v$，表示一条 $u$ 往 $v$ 额外添加的边。  \n接下来一个正整数 $q$。  \n接下来 $q$ 行，每行两个正整数 $l,r$，表示一组询问。", "outputFormat": "输出 $q$ 行，每行一个整数，表示对应组询问的答案。", "hint": "\n - Subtask 1（3 pts）：$n,q\\le 1000$，3s；\n - Subtask 2（29 pts）：$n,q\\le2\\times10^5$，$m\\le50$，3s；\n - Subtask 3（31 pts）：$m\\le 50$，5s；\n - Subtask 4（37 pts）：无额外限制，5s。\n\n对于 $100\\%$ 的数据，$2\\le n\\le7\\times10^5$，$1\\le q\\le3\\times10^5$，$0\\le m\\le100$。", "locale": "zh-CN"}}}
{"pid": "P7571", "type": "P", "difficulty": 7, "samples": [["10 0", "2 2 3 3\n2 1 1 1\n1 0 1 1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["O2优化", "洛谷月赛"], "title": "「MCOI-05」幂积", "background": "书虫有 $10^{10}$ 块金牌！\n\n书虫正在整理他的 $n$ 块金牌。他的金牌分四类，依次为：NOI 金牌，IOI 金牌，IMO 金牌，ICPC WF 金牌。他在第 $1$ 到第 $n$ 天中各 AK 了一场比赛，得到以上类金牌之一。对于给定参数 $k$，第 $i$ 天得到的金牌的价值为 $1$ 如果 $k=0$，为 $i$ 如果 $k=1$。\n\n书虫每天会通过奇妙手段选择他当天应该 AK 什么比赛。对于第 $i$ 天，令 $i=p_1\\times p_2\\times\\dots p_k$，其中 $p_1,p_2,\\dots,p_k$ 均为质数。书虫会计算 $x$，其中 $x$ 是 $p_1+p_2+\\dots+p_k$ 对 $4$ 取模的余数，并且 AK 第 $x+1$ 类比赛，得到一个第 $x+1$ 类比赛的金牌。\n\n书虫的金牌实在太多了，于是他邀请您帮他计算，他这 $n$ 个金牌里，每一类中的**价值**之和。但是书虫不满足于这个，于是他给您 $m$ 和 $k$，请您对每一个 $1\\le i\\le\\lfloor\\sqrt m\\rfloor$ 计算当 $n=\\lfloor\\frac mi\\rfloor$ 时候的答案。", "description": "定义函数 $f(\\prod p_i^{a_i})=\\sum a_ip_i$，其中 $p_i$ 为质数。特别，$f(1)=0$。\n\n对于 $k\\in\\{0,1\\}$，定义函数 $g$ 为：\n\n$$g(n,k,r)=\\sum_{i=1}^ni^k[f(i)\\equiv r\\pmod 4]$$\n\n给定 $m$ 和 $k$，请对所有 $1\\le i\\le\\lfloor\\sqrt m\\rfloor$，计算所有 $0\\le r<4$ 的 $g(\\lfloor\\frac mi\\rfloor,k,r)$ 值。", "inputFormat": "第一行一个正整数 $m$。  \n第二行一个非负整数 $k$。", "outputFormat": "输出 $\\lfloor\\sqrt m\\rfloor$ 行。  \n第 $i$ 行包含四个非负整数，第 $r$ 非负整数为 $g(\\lfloor\\frac mi\\rfloor,k,r)$。", "hint": "#### 样例 1 解释\n\n$f=[0,2,3,0,1,1,3,2,2,3,\\dots]$\n\n#### 数据规模与约定\n\n**本题采用捆绑测试**。\n\n| Subtask | 分数 | $m$ | $k$ |\n| - | - | - | - |\n| 1 | 5 pts | $\\le 10^7$ | 无 |\n| 2 | 15 pts | $\\le10^9$ | $=0$ |\n| 3 | 25 pts | 无 | $=0$ |\n| 4 | 25 pts | $\\le10^9$ | 无 |\n| 5 | 30 pts | 无 | 无 |\n\n对于 $100\\%$ 的数据，$1\\le m\\le10^{10}$，$0\\le k\\le1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-05」幂积", "background": "书虫有 $10^{10}$ 块金牌！\n\n书虫正在整理他的 $n$ 块金牌。他的金牌分四类，依次为：NOI 金牌，IOI 金牌，IMO 金牌，ICPC WF 金牌。他在第 $1$ 到第 $n$ 天中各 AK 了一场比赛，得到以上类金牌之一。对于给定参数 $k$，第 $i$ 天得到的金牌的价值为 $1$ 如果 $k=0$，为 $i$ 如果 $k=1$。\n\n书虫每天会通过奇妙手段选择他当天应该 AK 什么比赛。对于第 $i$ 天，令 $i=p_1\\times p_2\\times\\dots p_k$，其中 $p_1,p_2,\\dots,p_k$ 均为质数。书虫会计算 $x$，其中 $x$ 是 $p_1+p_2+\\dots+p_k$ 对 $4$ 取模的余数，并且 AK 第 $x+1$ 类比赛，得到一个第 $x+1$ 类比赛的金牌。\n\n书虫的金牌实在太多了，于是他邀请您帮他计算，他这 $n$ 个金牌里，每一类中的**价值**之和。但是书虫不满足于这个，于是他给您 $m$ 和 $k$，请您对每一个 $1\\le i\\le\\lfloor\\sqrt m\\rfloor$ 计算当 $n=\\lfloor\\frac mi\\rfloor$ 时候的答案。", "description": "定义函数 $f(\\prod p_i^{a_i})=\\sum a_ip_i$，其中 $p_i$ 为质数。特别，$f(1)=0$。\n\n对于 $k\\in\\{0,1\\}$，定义函数 $g$ 为：\n\n$$g(n,k,r)=\\sum_{i=1}^ni^k[f(i)\\equiv r\\pmod 4]$$\n\n给定 $m$ 和 $k$，请对所有 $1\\le i\\le\\lfloor\\sqrt m\\rfloor$，计算所有 $0\\le r<4$ 的 $g(\\lfloor\\frac mi\\rfloor,k,r)$ 值。", "inputFormat": "第一行一个正整数 $m$。  \n第二行一个非负整数 $k$。", "outputFormat": "输出 $\\lfloor\\sqrt m\\rfloor$ 行。  \n第 $i$ 行包含四个非负整数，第 $r$ 非负整数为 $g(\\lfloor\\frac mi\\rfloor,k,r)$。", "hint": "#### 样例 1 解释\n\n$f=[0,2,3,0,1,1,3,2,2,3,\\dots]$\n\n#### 数据规模与约定\n\n**本题采用捆绑测试**。\n\n| Subtask | 分数 | $m$ | $k$ |\n| - | - | - | - |\n| 1 | 5 pts | $\\le 10^7$ | 无 |\n| 2 | 15 pts | $\\le10^9$ | $=0$ |\n| 3 | 25 pts | 无 | $=0$ |\n| 4 | 25 pts | $\\le10^9$ | 无 |\n| 5 | 30 pts | 无 | 无 |\n\n对于 $100\\%$ 的数据，$1\\le m\\le10^{10}$，$0\\le k\\le1$。", "locale": "zh-CN"}}}
{"pid": "P7572", "type": "P", "difficulty": 7, "samples": [["10 0\n0 1 2 3\n1 2 3 0\n2 3 0 1\n3 0 1 2", "2 2 3 3\n2 1 1 1\n1 0 1 1"], ["100 100\n0 1 2 3\n1 0 3 2\n2 3 0 1\n3 2 1 0", "457599333 476580683 403589597 762762658\n361221912 612412943 661908092 483645330\n242804711 682542199 535167020 465246643\n913280460 516845083 917292729 390364642\n39265044 919790719 181416471 421087779\n530140662 31014314 181416471 226287885\n982924733 31014314 851084249 226287885\n982924733 938693280 851084249 226287885\n982924733 938693280 851084249 435036575\n982924733 938693280 851084249 138976409"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化"], "title": "20", "background": "", "description": "对于每一个 $0\\le i,j<4$，给定 $x(i,j)$ 使得：\n\n 1. 交换律：$x(i,j)=x(j,i)$\n 2. 结合律：$x(x(i,j),k)=x(i,x(j,k))$。\n 3. 单元：$x(0,i)=i$。\n\n定义函数 $f(n)$，使得：\n\n 1. $f(p^k)=pk\\bmod 4$\n 2. 当 $\\gcd(a,b)=1$，$f(ab)=x(f(a),f(b))$。\n\n特别，$f(1)=0$。\n\n定义函数 $g$ 为：\n\n$$g(n,k,r)=\\sum_{i=1}^ni^k[f(i)=r]$$\n\n给定 $m$ 和 $k$，请对所有 $1\\le i\\le\\lfloor\\sqrt m\\rfloor$，计算所有 $0\\le r<4$ 的 $g(\\lfloor\\frac mi\\rfloor,k,r)$ 值。答案对 $998244353$ 取模。", "inputFormat": "第一行两个整数 $n$，$k$。  \n接下来 $4$ 行每行 $4$ 个整数，第 $i$ 行第 $j$ 整数为 $x(i-1,j-1)$。", "outputFormat": "输出 $\\lfloor\\sqrt m\\rfloor$ 行。  \n第 $i$ 行包含四个非负整数，第 $r$ 非负整数为 $g(\\lfloor\\frac mi\\rfloor,k,r)$。", "hint": "本题不采用捆绑测试，数据略微有梯度。\n\n对于 $16\\%$ 的数据，$n\\le10^6$。\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^{10}$，$0\\le k\\le 1000$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "20", "background": "", "description": "对于每一个 $0\\le i,j<4$，给定 $x(i,j)$ 使得：\n\n 1. 交换律：$x(i,j)=x(j,i)$\n 2. 结合律：$x(x(i,j),k)=x(i,x(j,k))$。\n 3. 单元：$x(0,i)=i$。\n\n定义函数 $f(n)$，使得：\n\n 1. $f(p^k)=pk\\bmod 4$\n 2. 当 $\\gcd(a,b)=1$，$f(ab)=x(f(a),f(b))$。\n\n特别，$f(1)=0$。\n\n定义函数 $g$ 为：\n\n$$g(n,k,r)=\\sum_{i=1}^ni^k[f(i)=r]$$\n\n给定 $m$ 和 $k$，请对所有 $1\\le i\\le\\lfloor\\sqrt m\\rfloor$，计算所有 $0\\le r<4$ 的 $g(\\lfloor\\frac mi\\rfloor,k,r)$ 值。答案对 $998244353$ 取模。", "inputFormat": "第一行两个整数 $n$，$k$。  \n接下来 $4$ 行每行 $4$ 个整数，第 $i$ 行第 $j$ 整数为 $x(i-1,j-1)$。", "outputFormat": "输出 $\\lfloor\\sqrt m\\rfloor$ 行。  \n第 $i$ 行包含四个非负整数，第 $r$ 非负整数为 $g(\\lfloor\\frac mi\\rfloor,k,r)$。", "hint": "本题不采用捆绑测试，数据略微有梯度。\n\n对于 $16\\%$ 的数据，$n\\le10^6$。\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^{10}$，$0\\le k\\le 1000$。", "locale": "zh-CN"}}}
{"pid": "P7573", "type": "P", "difficulty": 1, "samples": [["2\n2\n3", "1\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072]}, "tags": ["模拟", "数学"], "title": "「PMOI-3」公平正义", "background": "> 公平正义，需要牺牲。——《唐人街探案 3》", "description": "现在有 $n$ 个人，lhm 有一个质量为 $1$ 的蛋糕。所有人都想吃到 lhm 的蛋糕。lhm 为了维持公平正义，他需要用最小的刀数将蛋糕分成相等的 $n$ 份（一份中可以包含多块）。\n\n把蛋糕看作一个圆，注意：每次切蛋糕时只能沿着直径切下。\n\n最终每人得到的蛋糕块数可以不同，但必须保证每人得到的质量为 $\\frac1n$。\n\n现在你需要求出 lhm 切割的最小刀数。", "inputFormat": "**本题包含多组数据。**\n\n输入数据共 $t+1$ 行。\n\n第一行一个整数 $t$，表示数据组数。\n\n接下来 $t$ 行，每行一个整数 $n$，表示人数。", "outputFormat": "输出数据共 $t$ 行，每行一个正整数，表示答案。", "hint": "【样例解释】\n\n当 $n=2$ 时，我们直接沿直径切下，从而得到了两个质量均为 $\\frac 1 2$ 的蛋糕块，分别将它们分给两个人即可。\n\n当 $n=3$ 时，我们可以先后沿两条夹角为 $60 \\degree$ 的直径切下，从而得到了质量为 $\\frac 1 6$ 的两个蛋糕块 $a,b$ 和质量为 $\\frac 1 3$ 的两个蛋糕块 $c,d$。我们把 $a,b$ 分给第一个人，$c,d$ 分别给第二个人和第三个人，就可以做到公平正义。\n\n【数据范围】\n\n对于 $20\\%$ 的数据满足，$1 \\le n \\le 10$。\n\n对于另 $20\\%$ 的数据满足，$t=1$。\n\n对于 $100\\%$ 的数据满足，$1 \\le t \\le 10^3$，$1 \\le n \\le 10^{9}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「PMOI-3」公平正义", "background": "> 公平正义，需要牺牲。——《唐人街探案 3》", "description": "现在有 $n$ 个人，lhm 有一个质量为 $1$ 的蛋糕。所有人都想吃到 lhm 的蛋糕。lhm 为了维持公平正义，他需要用最小的刀数将蛋糕分成相等的 $n$ 份（一份中可以包含多块）。\n\n把蛋糕看作一个圆，注意：每次切蛋糕时只能沿着直径切下。\n\n最终每人得到的蛋糕块数可以不同，但必须保证每人得到的质量为 $\\frac1n$。\n\n现在你需要求出 lhm 切割的最小刀数。", "inputFormat": "**本题包含多组数据。**\n\n输入数据共 $t+1$ 行。\n\n第一行一个整数 $t$，表示数据组数。\n\n接下来 $t$ 行，每行一个整数 $n$，表示人数。", "outputFormat": "输出数据共 $t$ 行，每行一个正整数，表示答案。", "hint": "【样例解释】\n\n当 $n=2$ 时，我们直接沿直径切下，从而得到了两个质量均为 $\\frac 1 2$ 的蛋糕块，分别将它们分给两个人即可。\n\n当 $n=3$ 时，我们可以先后沿两条夹角为 $60 \\degree$ 的直径切下，从而得到了质量为 $\\frac 1 6$ 的两个蛋糕块 $a,b$ 和质量为 $\\frac 1 3$ 的两个蛋糕块 $c,d$。我们把 $a,b$ 分给第一个人，$c,d$ 分别给第二个人和第三个人，就可以做到公平正义。\n\n【数据范围】\n\n对于 $20\\%$ 的数据满足，$1 \\le n \\le 10$。\n\n对于另 $20\\%$ 的数据满足，$t=1$。\n\n对于 $100\\%$ 的数据满足，$1 \\le t \\le 10^3$，$1 \\le n \\le 10^{9}$。", "locale": "zh-CN"}}}
{"pid": "P7574", "type": "P", "difficulty": 5, "samples": [["6\n7 2 5 100 1 5\n1 3\n3 4\n1 2\n4 5\n4 6", "67562\n29930\n75168\n76888\n63243\n63283"]], "limits": {"time": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["O2优化", "树形 DP"], "title": "「PMOI-3」子树", "background": "分割线下有形式化题面，可以配合食用。", "description": "b6e0 有一棵树，树上第 $i$ 个点有价值 $a_i$。每条边长度为 $1$。\n\nb6e0 会选择一个节点作为根节点。设这个节点为 $r$。然后，b6e0 会圈定一个节点的整个子树作为他的领地，设这个子树的根节点为 $u$。此时，树上的每个节点会给 b6e0 带来一些收益。在领地子树的根节点为 $u$ 的情况下，节点 $x$ 带来的收益 $f(x,u)$ 定义如下：\n1. 当 $x$ 在 $u$ 的子树中时，它的收益为它父亲节点的收益加上它本身的价值 $a_x$；\n2. 当 $x$ 不在 $u$ 的子树中时，它的收益为：与它相邻的节点中，与 $u$ 距离（到 $u$ 的简单路径长度）比 $x$ 到 $u$ 的距离远的节点，这些节点的收益**对 $998244353$ 取模**的最大值，再乘上 $a_x$。\n\n在根节点为 $r$ 的情况下，定义以 $u$ 为子树的收益 $W(u)$ 为所有节点的 $f$ 值和。\n\n当然，b6e0 有许多种选择根节点的方案。定义选 $r$ 为根节点的收益 $C(r)$ 为对于所有 $u$，以 $u$ 为子树的收益（$W(u)$）的和。对于每一个节点 $r$，求 $C(r)$。\n\n---\n形式化题面：\n\n给你一棵有 $n$ 个节点的树，第 $i$ 个节点有点权 $a_i$，每条边的长度为 $1$。当根节点为 $r$ 时：\n\n设 $F(x)$ 表示 $x$ 的父亲节点，特殊地，$F(r)=0$；$D(x,y)$ 表示 $x$ 到 $y$ 的简单路径的长度，特殊地，对于所有 $x$，$D(x,x)=0$；$A_x$ 表示 $x$ 的子树中的节点（包括 $x$ 本身）组成的集合，即 $A_x=\\{y\\mid D(x,y)=D(F(x),y)-1\\}$，特殊地，$A_r=\\{1,2,\\cdots,n\\}$；$B_x$ 表示与 $x$ 相邻的节点组成的集合，即 $B_x=\\{y\\mid D(x,y)=1\\}$。\n\n定义 $f(x,u)$：\n$$f(x,u)=\\begin{cases}f(F(x),u)+a_x&x\\in A_u\\\\a_x\\cdot\\max_{y\\in B_x,D(y,u)>D(x,u)}\\{f(y,u)\\bmod 998244353\\}&x\\not\\in A_u\\end{cases}$$\n特殊地，对于所有 $x$，$f(0,x)=0$；在 $x\\not\\in A_u$ 的情况中，若对于所有 $y\\in B_x$，都有 $D(y,u)\\le D(x,u)$，则 $f(x,u)=a_x$。\n\n定义节点 $u$ 的分数 $W(u)=\\sum_{v=1}^nf(v,u)$。\n\n定义节点 $r$ 的收益 $C(r)$ 表示以 $r$ 为根时，$\\sum_{i=1}^nW(i)$ 的值。\n\n对于每一个节点 $r$，求 $C(r)$。\n\n**所有 $C(r)$ 对 $998244353$ 取模。**", "inputFormat": "第一行输入一个正整数 $n$ 表示这棵树的节点数。\n\n第二行输入 $n$ 个整数，第 $i$ 表示节点 $i$ 的点权 $a_i$。\n\n下面 $n-1$ 行，每行输入两个正整数 $u,v$，表示节点 $u$ 与节点 $v$ 之间有一条边。", "outputFormat": "输出 $n$ 行，第 $i$ 行输出一个正整数表示节点 $i$ 的收益 $C(i)$ **对 $998244353$ 取模**的值。", "hint": "【样例解释】\n\n样例中的树如下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/bs02n466.png)\n\n例如在 $r=1$，$u=5$ 时，$f(2,u)=a_2=2$，$f(1,u)=a_1\\cdot f(2,u)=14$，$f(3,u)=a_3\\cdot f(1,u)=70$，$f(6,u)=a_6=5$，$f(4,u)=a_4\\cdot\\max\\{f(3,u),f(6,u)\\}=7000$，$f(5,u)=f(4,u)+a_5=7001$。\n\n【数据范围】\n- Subtask1（10pts）：$n\\le200$，$a_i\\le 10^3$；\n- Subtask2（20pts）：$n\\le10^3$；\n- Subtask3（20pts）：树为一条链；\n- Subtask4（20pts）：存在一个节点，使得它的度数为 $n-1$；\n- Subtask5（30pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le n\\le5\\times10^5$，$1\\le a_i\\le10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「PMOI-3」子树", "background": "分割线下有形式化题面，可以配合食用。", "description": "b6e0 有一棵树，树上第 $i$ 个点有价值 $a_i$。每条边长度为 $1$。\n\nb6e0 会选择一个节点作为根节点。设这个节点为 $r$。然后，b6e0 会圈定一个节点的整个子树作为他的领地，设这个子树的根节点为 $u$。此时，树上的每个节点会给 b6e0 带来一些收益。在领地子树的根节点为 $u$ 的情况下，节点 $x$ 带来的收益 $f(x,u)$ 定义如下：\n1. 当 $x$ 在 $u$ 的子树中时，它的收益为它父亲节点的收益加上它本身的价值 $a_x$；\n2. 当 $x$ 不在 $u$ 的子树中时，它的收益为：与它相邻的节点中，与 $u$ 距离（到 $u$ 的简单路径长度）比 $x$ 到 $u$ 的距离远的节点，这些节点的收益**对 $998244353$ 取模**的最大值，再乘上 $a_x$。\n\n在根节点为 $r$ 的情况下，定义以 $u$ 为子树的收益 $W(u)$ 为所有节点的 $f$ 值和。\n\n当然，b6e0 有许多种选择根节点的方案。定义选 $r$ 为根节点的收益 $C(r)$ 为对于所有 $u$，以 $u$ 为子树的收益（$W(u)$）的和。对于每一个节点 $r$，求 $C(r)$。\n\n---\n形式化题面：\n\n给你一棵有 $n$ 个节点的树，第 $i$ 个节点有点权 $a_i$，每条边的长度为 $1$。当根节点为 $r$ 时：\n\n设 $F(x)$ 表示 $x$ 的父亲节点，特殊地，$F(r)=0$；$D(x,y)$ 表示 $x$ 到 $y$ 的简单路径的长度，特殊地，对于所有 $x$，$D(x,x)=0$；$A_x$ 表示 $x$ 的子树中的节点（包括 $x$ 本身）组成的集合，即 $A_x=\\{y\\mid D(x,y)=D(F(x),y)-1\\}$，特殊地，$A_r=\\{1,2,\\cdots,n\\}$；$B_x$ 表示与 $x$ 相邻的节点组成的集合，即 $B_x=\\{y\\mid D(x,y)=1\\}$。\n\n定义 $f(x,u)$：\n$$f(x,u)=\\begin{cases}f(F(x),u)+a_x&x\\in A_u\\\\a_x\\cdot\\max_{y\\in B_x,D(y,u)>D(x,u)}\\{f(y,u)\\bmod 998244353\\}&x\\not\\in A_u\\end{cases}$$\n特殊地，对于所有 $x$，$f(0,x)=0$；在 $x\\not\\in A_u$ 的情况中，若对于所有 $y\\in B_x$，都有 $D(y,u)\\le D(x,u)$，则 $f(x,u)=a_x$。\n\n定义节点 $u$ 的分数 $W(u)=\\sum_{v=1}^nf(v,u)$。\n\n定义节点 $r$ 的收益 $C(r)$ 表示以 $r$ 为根时，$\\sum_{i=1}^nW(i)$ 的值。\n\n对于每一个节点 $r$，求 $C(r)$。\n\n**所有 $C(r)$ 对 $998244353$ 取模。**", "inputFormat": "第一行输入一个正整数 $n$ 表示这棵树的节点数。\n\n第二行输入 $n$ 个整数，第 $i$ 表示节点 $i$ 的点权 $a_i$。\n\n下面 $n-1$ 行，每行输入两个正整数 $u,v$，表示节点 $u$ 与节点 $v$ 之间有一条边。", "outputFormat": "输出 $n$ 行，第 $i$ 行输出一个正整数表示节点 $i$ 的收益 $C(i)$ **对 $998244353$ 取模**的值。", "hint": "【样例解释】\n\n样例中的树如下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/bs02n466.png)\n\n例如在 $r=1$，$u=5$ 时，$f(2,u)=a_2=2$，$f(1,u)=a_1\\cdot f(2,u)=14$，$f(3,u)=a_3\\cdot f(1,u)=70$，$f(6,u)=a_6=5$，$f(4,u)=a_4\\cdot\\max\\{f(3,u),f(6,u)\\}=7000$，$f(5,u)=f(4,u)+a_5=7001$。\n\n【数据范围】\n- Subtask1（10pts）：$n\\le200$，$a_i\\le 10^3$；\n- Subtask2（20pts）：$n\\le10^3$；\n- Subtask3（20pts）：树为一条链；\n- Subtask4（20pts）：存在一个节点，使得它的度数为 $n-1$；\n- Subtask5（30pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le n\\le5\\times10^5$，$1\\le a_i\\le10^9$。", "locale": "zh-CN"}}}
{"pid": "P7575", "type": "P", "difficulty": 6, "samples": [["3 2\n1 2", "1"], ["5 20\n1 2 4 6", "312"], ["5 20\n2 3 1 4", "592"], ["10 1000\n1 2 4 8 16 32 64 128 256 ", "207388829"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "O2优化", "莫比乌斯反演"], "title": "「PMOI-3」公约数", "background": "", "description": "给出 $n,m$ 和一个长度为 $n-1$ 的序列 $x$，保证 $x_i$ 互不相同。\n\n求\n$$\n\\sum_{i_1=1}^m\\sum_{i_2=1}^m\\cdots\\sum_{i_n=1}^m[\\gcd(i_1,i_2)=x_1][\\gcd(i_2,i_3)=x_2]\\cdots[\\gcd(i_{n-1},i_n)=x_{n-1}]$$\n\n答案对 $998244353$ 取模。", "inputFormat": "第一行两个数 $n,m$。\n\n接下来一行 $n-1$ 个整数，表示 $x_i$。", "outputFormat": "一行一个整数。", "hint": "【样例解释】\n\n对于第一组样例，只有当 $i_1=1,i_2=2,i_3=2$ 时才满足要求。\n\n【数据范围】\n\n**本题采用捆绑测试。**\n\n- Subtask1（10pts）：$n,m\\le 5$；\n- Subtask2（15pts）：$n,m\\le500$；\n- Subtask3（15pts）：$n,m\\le 5\\times 10^3$；\n- Subtask4（15pts）：$n,m\\le 5\\times 10^4$。\n- Subtask5（20pts）：$n,m\\le 3\\times 10^5$。\n- Subtask6（25pts）：无特殊限制。\n\n对于 $100\\%$ 的数据满足，$n-1\\le m$，$1\\le n,m\\le 10^6$，$1\\le x_i\\le m$，保证 $x_i$ 互不相同。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「PMOI-3」公约数", "background": "", "description": "给出 $n,m$ 和一个长度为 $n-1$ 的序列 $x$，保证 $x_i$ 互不相同。\n\n求\n$$\n\\sum_{i_1=1}^m\\sum_{i_2=1}^m\\cdots\\sum_{i_n=1}^m[\\gcd(i_1,i_2)=x_1][\\gcd(i_2,i_3)=x_2]\\cdots[\\gcd(i_{n-1},i_n)=x_{n-1}]$$\n\n答案对 $998244353$ 取模。", "inputFormat": "第一行两个数 $n,m$。\n\n接下来一行 $n-1$ 个整数，表示 $x_i$。", "outputFormat": "一行一个整数。", "hint": "【样例解释】\n\n对于第一组样例，只有当 $i_1=1,i_2=2,i_3=2$ 时才满足要求。\n\n【数据范围】\n\n**本题采用捆绑测试。**\n\n- Subtask1（10pts）：$n,m\\le 5$；\n- Subtask2（15pts）：$n,m\\le500$；\n- Subtask3（15pts）：$n,m\\le 5\\times 10^3$；\n- Subtask4（15pts）：$n,m\\le 5\\times 10^4$。\n- Subtask5（20pts）：$n,m\\le 3\\times 10^5$。\n- Subtask6（25pts）：无特殊限制。\n\n对于 $100\\%$ 的数据满足，$n-1\\le m$，$1\\le n,m\\le 10^6$，$1\\le x_i\\le m$，保证 $x_i$ 互不相同。", "locale": "zh-CN"}}}
{"pid": "P7576", "type": "P", "difficulty": 6, "samples": [["2 1 1\n1 2\n1 2", "15"], ["10 3 3\n1 5 3 2 2 4 6 3 2 3\n1 7\n4 9\n3 10", "3850\n1166\n3893"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "线段树", "O2优化", "动态规划优化", "矩阵加速", "矩阵乘法"], "title": "「PMOI-3」期望乘积", "background": "", "description": "ducati 热爱定义一些奇奇妙妙的东西。\n\n- 定义两个序列不同，当且仅当它们的长度不同，或者它们长度相同但存在至少一组对应位上的值不同。\n\n- 定义序列 $A$ 的权值为 $A$ 中所有数的**乘积**。\n\n- 定义序列间的**可达**如下：\n\n  - 做**恰好** $t$ 次操作，每次操作选择 $A$ 的一个子区间（**注意，选定的子区间可以为空**）并将子区间中的数加 $1$ ；若存在一种操作方案，使得操作结束后 $A$ 与 $B$ 完全相同 ，则称 $A$ 可达 $B$。\n  \n- 定义序列 $A$ 的优美值为 $A$ 可达的**所有不同**序列的**权值**和。\n\n现在，ducati 拥有了一个长度为 $n$ 的序列 $a$。他会多次查询一段区间的优美值。\n\n你能帮帮好奇的他吗？你只需要输出每个答案对 $10007$ 取模的值就行啦。", "inputFormat": "第一行三个整数 $n,q,t$，表示序列的长度、询问的次数与每次询问的可修改次数。\n\n第二行 $n$ 个整数，表示序列 $a$。\n\n下面 $q$ 行，每行两个正整数 $l,r$，描述一次询问。", "outputFormat": "对于每次询问，输出答案对 $10007$ 取模的值。", "hint": "【样例解释1】\n\n$a$ 为 $\\{1,2\\}$。共 $1$ 次询问。\n\n所有 $a$ 可达的 $b$ 如下：\n\n$$\\{1,3 \\} \\{2,2 \\} \\{2,3 \\}\\{1,2 \\}$$\n\n它们的权值之和为 $3+4+6+2=15$ 。\n\n【样例解释2】\n\n关于第二个样例，我有一个绝妙的解释，可惜这里空白太小，我写不下。\n\n【数据范围】\n\n**本题采用捆绑测试**。\n- Subtask1（10pts）：$n,q\\le8$；\n- Subtask2（20pts）：$q=1$；\n- Subtask3（30pts）：$n,q\\le5\\times10^4$，$t\\le2$；\n- Subtask4（40pts）：无特殊限制。\n\n对于 $100\\%$ 的数据满足，$1\\le n,q\\le10^5$，$1\\le a_i\\le10^4$，$1\\le t\\le3$，对于所有询问，$1\\le l\\le r\\le n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「PMOI-3」期望乘积", "background": "", "description": "ducati 热爱定义一些奇奇妙妙的东西。\n\n- 定义两个序列不同，当且仅当它们的长度不同，或者它们长度相同但存在至少一组对应位上的值不同。\n\n- 定义序列 $A$ 的权值为 $A$ 中所有数的**乘积**。\n\n- 定义序列间的**可达**如下：\n\n  - 做**恰好** $t$ 次操作，每次操作选择 $A$ 的一个子区间（**注意，选定的子区间可以为空**）并将子区间中的数加 $1$ ；若存在一种操作方案，使得操作结束后 $A$ 与 $B$ 完全相同 ，则称 $A$ 可达 $B$。\n  \n- 定义序列 $A$ 的优美值为 $A$ 可达的**所有不同**序列的**权值**和。\n\n现在，ducati 拥有了一个长度为 $n$ 的序列 $a$。他会多次查询一段区间的优美值。\n\n你能帮帮好奇的他吗？你只需要输出每个答案对 $10007$ 取模的值就行啦。", "inputFormat": "第一行三个整数 $n,q,t$，表示序列的长度、询问的次数与每次询问的可修改次数。\n\n第二行 $n$ 个整数，表示序列 $a$。\n\n下面 $q$ 行，每行两个正整数 $l,r$，描述一次询问。", "outputFormat": "对于每次询问，输出答案对 $10007$ 取模的值。", "hint": "【样例解释1】\n\n$a$ 为 $\\{1,2\\}$。共 $1$ 次询问。\n\n所有 $a$ 可达的 $b$ 如下：\n\n$$\\{1,3 \\} \\{2,2 \\} \\{2,3 \\}\\{1,2 \\}$$\n\n它们的权值之和为 $3+4+6+2=15$ 。\n\n【样例解释2】\n\n关于第二个样例，我有一个绝妙的解释，可惜这里空白太小，我写不下。\n\n【数据范围】\n\n**本题采用捆绑测试**。\n- Subtask1（10pts）：$n,q\\le8$；\n- Subtask2（20pts）：$q=1$；\n- Subtask3（30pts）：$n,q\\le5\\times10^4$，$t\\le2$；\n- Subtask4（40pts）：无特殊限制。\n\n对于 $100\\%$ 的数据满足，$1\\le n,q\\le10^5$，$1\\le a_i\\le10^4$，$1\\le t\\le3$，对于所有询问，$1\\le l\\le r\\le n$。", "locale": "zh-CN"}}}
{"pid": "P7577", "type": "P", "difficulty": 6, "samples": [["3 1\n2020 2021 2020\n3 3 2 2 1 1", "1"], ["10 3\n2 2 4 3 5 3 5 4 1 2\n3 5 2 4 1 2\n5 7 2 9 2 4\n1 3 1 8 1 3", "2\n4\n4"]], "limits": {"time": [4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["二分", "O2优化", "可持久化线段树"], "title": "「PMOI-3」简单模拟题", "background": "", "description": "给定一个长度为 $n$ 的序列 $s$。\n\n$q$ 次询问，每个询问形如 `a b c d e f`，需要你求出下面式子的值：\n$$\\sum_{L=a}^{b}[e\\le G(F(L,c),F(L,c+1),\\cdots,F(L,d))\\le f]$$\n这里 $F(l,r)$ 表示 $s$ 序列区间 $[l,r]$ 中不同的数的个数，$G(x_1,x_2,\\cdots,x_k)$ 表示 $x_1,x_2,\\cdots,x_k$ 中不同的数的个数。", "inputFormat": "第一行两个整数 $n,q$，表示序列长度与命令次数。\n\n第二行输入 $n$ 个整数，第 $i$ 个数表示 $s_i$。\n\n下面 $q$ 行，每行输入 $6$ 个数 $a',b',c',d',e,f$。令上一次询问的答案为 $\\text{lastans}$（特别的，若这是第一次询问，则 $\\text{lastans}=0$），则本次询问中\n\n$a=(a'+\\text{lastans})\\bmod n+1\\\\$\n$b=(b'+\\text{lastans})\\bmod n+1\\\\$\n$c=(c'+\\text{lastans})\\bmod n+1\\\\$\n$d=(d'+\\text{lastans})\\bmod n+1\\\\$\n\n**注意，你需要将 $a,b,c,d$ 重新排序使得 $a\\le b\\le c\\le d$。**", "outputFormat": "对于每次询问，依次输出答案。", "hint": "【样例一解释】\n\n第一次询问中，$a=1,b=1,c=3,d=3,e=1,f=1$。\n\n不难得到 $G(F(1,3))=1$，且 $e\\le G(F(1,3))\\le f$，所以答案为 $1$。\n\n【样例二解释】\n| 询问编号 | $a$ | $b$ | $c$ | $d$ | $e$ | $f$ |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| ① | 3 | 4 | 5 | 6 | 1 | 2 |\n| ② | 2 | 5 | 8 | 10 | 2 | 4 |\n| ③ | 3 | 6 | 6 | 8 | 1 | 3 |\n\n【数据范围】\n\n**本题采用捆绑测试**。\n- Subtask1（10pts）：$n,q\\le500$，$1\\le s_i\\le10^6$；\n- Subtask2（15pts）：$n,q\\le3\\times10^3$；\n- Subtask3（20pts）：$b-a\\le20$；\n- Subtask4（25pts）：$n,q\\le10^5$；\n- Subtask5（30pts）：无特殊限制。\n\n对于 $100\\%$ 的数据满足，$1\\le n,q\\le3\\times10^5$，$0\\le|s_i|\\le10^9$，对于所有询问，$1\\le a,b,c,d\\le n$，$0\\le e\\le f\\le n$。\n\n【提示】\n1. 本题中，$[x \\le y \\le z]$ 表示 $y$ 是否 $\\in[x,z]$。如果在该区间内，则值为 $1$；否则为 $0$。\n\n2. 输入量较大，请采用较快的读入方式。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「PMOI-3」简单模拟题", "background": "", "description": "给定一个长度为 $n$ 的序列 $s$。\n\n$q$ 次询问，每个询问形如 `a b c d e f`，需要你求出下面式子的值：\n$$\\sum_{L=a}^{b}[e\\le G(F(L,c),F(L,c+1),\\cdots,F(L,d))\\le f]$$\n这里 $F(l,r)$ 表示 $s$ 序列区间 $[l,r]$ 中不同的数的个数，$G(x_1,x_2,\\cdots,x_k)$ 表示 $x_1,x_2,\\cdots,x_k$ 中不同的数的个数。", "inputFormat": "第一行两个整数 $n,q$，表示序列长度与命令次数。\n\n第二行输入 $n$ 个整数，第 $i$ 个数表示 $s_i$。\n\n下面 $q$ 行，每行输入 $6$ 个数 $a',b',c',d',e,f$。令上一次询问的答案为 $\\text{lastans}$（特别的，若这是第一次询问，则 $\\text{lastans}=0$），则本次询问中\n\n$a=(a'+\\text{lastans})\\bmod n+1\\\\$\n$b=(b'+\\text{lastans})\\bmod n+1\\\\$\n$c=(c'+\\text{lastans})\\bmod n+1\\\\$\n$d=(d'+\\text{lastans})\\bmod n+1\\\\$\n\n**注意，你需要将 $a,b,c,d$ 重新排序使得 $a\\le b\\le c\\le d$。**", "outputFormat": "对于每次询问，依次输出答案。", "hint": "【样例一解释】\n\n第一次询问中，$a=1,b=1,c=3,d=3,e=1,f=1$。\n\n不难得到 $G(F(1,3))=1$，且 $e\\le G(F(1,3))\\le f$，所以答案为 $1$。\n\n【样例二解释】\n| 询问编号 | $a$ | $b$ | $c$ | $d$ | $e$ | $f$ |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| ① | 3 | 4 | 5 | 6 | 1 | 2 |\n| ② | 2 | 5 | 8 | 10 | 2 | 4 |\n| ③ | 3 | 6 | 6 | 8 | 1 | 3 |\n\n【数据范围】\n\n**本题采用捆绑测试**。\n- Subtask1（10pts）：$n,q\\le500$，$1\\le s_i\\le10^6$；\n- Subtask2（15pts）：$n,q\\le3\\times10^3$；\n- Subtask3（20pts）：$b-a\\le20$；\n- Subtask4（25pts）：$n,q\\le10^5$；\n- Subtask5（30pts）：无特殊限制。\n\n对于 $100\\%$ 的数据满足，$1\\le n,q\\le3\\times10^5$，$0\\le|s_i|\\le10^9$，对于所有询问，$1\\le a,b,c,d\\le n$，$0\\le e\\le f\\le n$。\n\n【提示】\n1. 本题中，$[x \\le y \\le z]$ 表示 $y$ 是否 $\\in[x,z]$。如果在该区间内，则值为 $1$；否则为 $0$。\n\n2. 输入量较大，请采用较快的读入方式。", "locale": "zh-CN"}}}
{"pid": "P7578", "type": "P", "difficulty": 1, "samples": [["1\nx-y 1", "3 2 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2021"], "title": "「RdOI R2」数(number)", "background": "", "description": "试求出两两不同的三个正整数 $x,y,z(x\\gt y\\gt z)$ 使得其中的任意两个数的和能被第三个数整除。\n\n现在给出你下面的几种要求：\n\n- 给出你 $x-y$ 的值，求出 $x,y,z$。\n- 给出你 $x-z$ 的值，求出 $x,y,z$。\n- 给出你 $y-z$ 的值，求出 $x,y,z$。", "inputFormat": "一共 $T+1$ 行。\n\n第一行，一个整数 $T$ ，表示有 $T$ 组数据。\n\n接下来 $T$ 行，每行两个内容：\n\n1. 一个字符串，可能是 $x-y,x-z,y-z$ 表示给出的数是由哪两个数做差得到的。\n2. 一个数，这个差的值。", "outputFormat": "一共 $T$ 行。\n\n每一行三个正整数 $x,y,z$（如上文所述）。题目保证有解。", "hint": "**样例解释**\n\n由 $x-y=1$ 得 $x,y$ 差 $1$ ，经尝试，得 $x=3,y=2,z=1$。\n\n此时显然有 $z\\mid (x+y)$，$y\\mid (x+z)$，$x\\mid (y+z)$。\n\n---\n\n**数据范围**\n\n- 对于 $1\\%$ 的数据，即样例 \\#1。\n- 对于 $100\\%$ 的数据，$1\\le T\\le 10^6,1\\le x,y,z\\le10^8$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「RdOI R2」数(number)", "background": "", "description": "试求出两两不同的三个正整数 $x,y,z(x\\gt y\\gt z)$ 使得其中的任意两个数的和能被第三个数整除。\n\n现在给出你下面的几种要求：\n\n- 给出你 $x-y$ 的值，求出 $x,y,z$。\n- 给出你 $x-z$ 的值，求出 $x,y,z$。\n- 给出你 $y-z$ 的值，求出 $x,y,z$。", "inputFormat": "一共 $T+1$ 行。\n\n第一行，一个整数 $T$ ，表示有 $T$ 组数据。\n\n接下来 $T$ 行，每行两个内容：\n\n1. 一个字符串，可能是 $x-y,x-z,y-z$ 表示给出的数是由哪两个数做差得到的。\n2. 一个数，这个差的值。", "outputFormat": "一共 $T$ 行。\n\n每一行三个正整数 $x,y,z$（如上文所述）。题目保证有解。", "hint": "**样例解释**\n\n由 $x-y=1$ 得 $x,y$ 差 $1$ ，经尝试，得 $x=3,y=2,z=1$。\n\n此时显然有 $z\\mid (x+y)$，$y\\mid (x+z)$，$x\\mid (y+z)$。\n\n---\n\n**数据范围**\n\n- 对于 $1\\%$ 的数据，即样例 \\#1。\n- 对于 $100\\%$ 的数据，$1\\le T\\le 10^6,1\\le x,y,z\\le10^8$。", "locale": "zh-CN"}}}
{"pid": "P7579", "type": "P", "difficulty": 4, "samples": [["6\n\n=\n\n<\n\n>", "\n1 1 1 1 2\n\n1 1 3 1 4\n\n1 1 5 1 6\n\n2 3 6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["二分", "2021", "三分", "交互题", "Special Judge", "分治"], "title": "「RdOI R2」称重(weigh)", "background": "因为 rui_er 是一个良心出题人，所以本题是一道交互题。", "description": "rui_er 为了准备体测，买了 $n$ 个实心球准备练习，但是却发现在发货时混入了两个质量明显较轻但外观相似的球（这两个球质量相等），且已知这两个球的质量之和大于一个正常的球。为了防止影响训练效果，现在需要找出这两个球。因为手动找太慢了，现在拿来了一个天平，可以在两侧各放上若干个球，得到两侧的质量大小关系。请你帮帮 rui_er，在使用不超过 $k$ 次天平的情况下，找出这两个较轻的球。\n\n这里 $k$ 是每个测试点的属性，你不必也不应该读入。\n\n---\n\n**交互方式**\n\n本题采用 I/O 交互。\n\n你可以选择进行称量操作，此时向标准输出打印一行 `1 p a1 a2 ... ap q b1 b2 ... bq`，表示在天平左盘放入编号为 $a_1,a_2,\\cdots,a_p$ 的 $p$ 个球，在天平右盘放入编号为 $b_1,b_2,\\cdots,b_q$ 的 $q$ 个球。随后清空缓冲区，并从标准输入读入一个 `<>=` 之一的字符，表示左盘与右盘的质量关系。\n\n对于每次此类询问，你需要保证 $1\\le p,q\\le n$，$p+q\\le n$，所有 $a_i$ 和 $b_i$ 互不相同，且你最多进行此类询问 $k$ 次。\n\n在得到答案后，向标准输出打印一行 `2 x y` 来提交答案，表示编号为 $x$ 的球和编号为 $y$ 的球质量偏轻。\n\n你需要保证 $1\\le x\\lt y\\le n$（注意需要严格按照从小到大顺序输出），且在进行完这一操作后立即终止程序。\n\n交互库在一开始就已经确定小球的情况，不会随着你的询问而改变。", "inputFormat": "第一行一个整数 $n$，表示球的数量。这里 $k$ 是每个测试点的属性，你不必也不应该读入。\n\n接下来若干行，见【交互方式】。", "outputFormat": "若干行，见【交互方式】。", "hint": "**样例解释**\n\n三次询问的结果为 $a_1=a_2,a_3\\lt a_4,a_5\\gt a_6$，可以知道编号为 $3,6$ 的两个球质量偏轻。\n\n---\n\n**数据范围**\n\n本题按点得分。\n\n$20$ 个非 HACK 测试点中，第一个点 $4$ 分，其它点每点 $5$ 分；$4$ 个 HACK 测试点共 $1$ 分，任意一个测试点不通过则不得分。\n\n|测试点|$n\\le$|$k=$|特殊性质|测试点|$n\\le$|$k=$|特殊性质|\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|1|$5$|$50$|无|11|$500$|$50$|无|\n|2|$10$|$50$|无|12|$500$|$50$|无|\n|3|$100$|$50$|无|13|$500$|$20$|A|\n|4|$100$|$50$|无|14|$500$|$20$|B|\n|5|$500$|$50$|A|15|$500$|$20$|A|\n|6|$500$|$50$|B|16|$500$|$20$|B|\n|7|$500$|$50$|A|17|$500$|$20$|无|\n|8|$500$|$50$|B|18|$500$|$20$|无|\n|9|$500$|$50$|无|19|$500$|$20$|无|\n|10|$500$|$50$|无|20|$500$|$20$|无|\n|ex1|$500$|$12$|B/HACK|ex3|$500$|$13$|HACK|\n|ex2|$500$|$13$|HACK|ex4|$500$|$14$|HACK|\n\n- 特殊性质 A：$n=2^i-1,i\\in\\left\\{4,5,6,7,8\\right\\}$。\n- 特殊性质 B：$n=2^i,i\\in\\left\\{4,5,6,7,8\\right\\}$。\n- 备注：HACK 数据的 $k$ 根据测试点实际情况设置，会卡一些奇怪的做法，保证正解可过。\n\n对于全部数据，$5\\le n\\le 500$，$k\\in\\left\\{50,20,14,13,12\\right\\}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「RdOI R2」称重(weigh)", "background": "因为 rui_er 是一个良心出题人，所以本题是一道交互题。", "description": "rui_er 为了准备体测，买了 $n$ 个实心球准备练习，但是却发现在发货时混入了两个质量明显较轻但外观相似的球（这两个球质量相等），且已知这两个球的质量之和大于一个正常的球。为了防止影响训练效果，现在需要找出这两个球。因为手动找太慢了，现在拿来了一个天平，可以在两侧各放上若干个球，得到两侧的质量大小关系。请你帮帮 rui_er，在使用不超过 $k$ 次天平的情况下，找出这两个较轻的球。\n\n这里 $k$ 是每个测试点的属性，你不必也不应该读入。\n\n---\n\n**交互方式**\n\n本题采用 I/O 交互。\n\n你可以选择进行称量操作，此时向标准输出打印一行 `1 p a1 a2 ... ap q b1 b2 ... bq`，表示在天平左盘放入编号为 $a_1,a_2,\\cdots,a_p$ 的 $p$ 个球，在天平右盘放入编号为 $b_1,b_2,\\cdots,b_q$ 的 $q$ 个球。随后清空缓冲区，并从标准输入读入一个 `<>=` 之一的字符，表示左盘与右盘的质量关系。\n\n对于每次此类询问，你需要保证 $1\\le p,q\\le n$，$p+q\\le n$，所有 $a_i$ 和 $b_i$ 互不相同，且你最多进行此类询问 $k$ 次。\n\n在得到答案后，向标准输出打印一行 `2 x y` 来提交答案，表示编号为 $x$ 的球和编号为 $y$ 的球质量偏轻。\n\n你需要保证 $1\\le x\\lt y\\le n$（注意需要严格按照从小到大顺序输出），且在进行完这一操作后立即终止程序。\n\n交互库在一开始就已经确定小球的情况，不会随着你的询问而改变。", "inputFormat": "第一行一个整数 $n$，表示球的数量。这里 $k$ 是每个测试点的属性，你不必也不应该读入。\n\n接下来若干行，见【交互方式】。", "outputFormat": "若干行，见【交互方式】。", "hint": "**样例解释**\n\n三次询问的结果为 $a_1=a_2,a_3\\lt a_4,a_5\\gt a_6$，可以知道编号为 $3,6$ 的两个球质量偏轻。\n\n---\n\n**数据范围**\n\n本题按点得分。\n\n$20$ 个非 HACK 测试点中，第一个点 $4$ 分，其它点每点 $5$ 分；$4$ 个 HACK 测试点共 $1$ 分，任意一个测试点不通过则不得分。\n\n|测试点|$n\\le$|$k=$|特殊性质|测试点|$n\\le$|$k=$|特殊性质|\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|1|$5$|$50$|无|11|$500$|$50$|无|\n|2|$10$|$50$|无|12|$500$|$50$|无|\n|3|$100$|$50$|无|13|$500$|$20$|A|\n|4|$100$|$50$|无|14|$500$|$20$|B|\n|5|$500$|$50$|A|15|$500$|$20$|A|\n|6|$500$|$50$|B|16|$500$|$20$|B|\n|7|$500$|$50$|A|17|$500$|$20$|无|\n|8|$500$|$50$|B|18|$500$|$20$|无|\n|9|$500$|$50$|无|19|$500$|$20$|无|\n|10|$500$|$50$|无|20|$500$|$20$|无|\n|ex1|$500$|$12$|B/HACK|ex3|$500$|$13$|HACK|\n|ex2|$500$|$13$|HACK|ex4|$500$|$14$|HACK|\n\n- 特殊性质 A：$n=2^i-1,i\\in\\left\\{4,5,6,7,8\\right\\}$。\n- 特殊性质 B：$n=2^i,i\\in\\left\\{4,5,6,7,8\\right\\}$。\n- 备注：HACK 数据的 $k$ 根据测试点实际情况设置，会卡一些奇怪的做法，保证正解可过。\n\n对于全部数据，$5\\le n\\le 500$，$k\\in\\left\\{50,20,14,13,12\\right\\}$。", "locale": "zh-CN"}}}
{"pid": "P7580", "type": "P", "difficulty": 6, "samples": [["3 0 12345678", "175092810"], ["114514 100000 1919810", "212218651\n"], ["9919810 2 12121121", "204065242"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "O2优化"], "title": "「RdOI R2」因数和(sum)", "background": "monsters 喜欢因数，所以他要出一道关于因数的题。", "description": "众所周知，$i$ 的标准分解形式为：$\\prod\\limits_{j=1}^{k_i}p_{i,j}^{c_{i,j}}$。\n\n给定一个序列 $a$，长度为 $n$。\n\n定义 $f(x)=\\sum\\limits_{d|x}\\left({a_{\\frac{x}{d}}\\times\\prod\\limits_{i=1}^{k_d}{C_{c_{d,i}+m}^{m}}}\\right)$，现在需要你求出 $f(1),f(2),f(3),\\cdots ,f(n)$，其中 $m$ 是给定常数。\n\n由于 monsters 不喜欢太大的数，他需要你输出答案模 $998244353$ 的值。\n\n另外，为了避免过大的输入输出量，本题使用随机数生成数据，并且只需要你输出所有答案的异或和。\n\n如果你不知道 $C$ 是什么，$C_n^m=\\dfrac{n!}{m!(n-m)!}$，其中 $!$ 代表阶乘。", "inputFormat": "输入共有一行。\n\n第一行，三个非负整数 $n,m,seed$。\n\n你需要在程序中调用 $n$ 次数据生成器（```randomdigit```）来得到 $a$。", "outputFormat": "输出共有一行一个整数，为所有 $f(x)$ 的异或和。", "hint": "**数据生成器**\n\nC/C++:\n```cpp\n#define uint unsigned int\nuint seed;\ninline uint randomdigit(){\n\tseed^=seed<<13;\n\tseed^=seed>>17;\n\tseed^=seed<<5;\n\treturn seed;\n}\n```\npascal:\n```pascal\nvar seed:dword;\nfunction randomdigit:dword;\nbegin\n\tseed:=seed xor(seed shl 13);\n\tseed:=seed xor(seed shr 17);\n\tseed:=seed xor(seed shl 5);\n\trandomdigit:=seed;\nend;\n```\n\npython3:\n```python\nseed = 0 # please input seed\nmod = 1 << 32\ndef randomdigit():\n    global seed\n    seed ^= (seed << 13) % mod\n    seed ^= (seed >> 17) % mod\n    seed ^= (seed << 5) % mod\n    return seed\n```\n\n---\n\n**样例解释**\n\n序列 $a$ 为 $506005380,3857352168,531380003$。\n\n$f(1),f(2),f(3)$ 模 $998244353$ 的值分别为 $506005380,370380136,39141030$。\n\n---\n\n**数据范围**\n\n对于 $100\\%$ 的数据，$0\\le m\\le 10^5,1\\le n\\le 10^7,0\\le a_1,a_2,\\cdots,a_n,seed<2^{32}$。\n\n- Subtask $1$（$30\\%$ 的数据）：$n\\le 10^6,m\\le 10^5$。\n\n在此 Subtask 中：\n\n有 $10\\%$ 的数据，满足 $m=0$。\n\n另有 $10\\%$ 的数据，满足 $n\\le 100$。\n- Subtask $2$（剩下 $70\\%$ 的数据）：$n\\le 10^7,m\\le 3$。\n\n**提示**\n\n请注意空间限制和常数因子对程序运行效率的影响", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「RdOI R2」因数和(sum)", "background": "monsters 喜欢因数，所以他要出一道关于因数的题。", "description": "众所周知，$i$ 的标准分解形式为：$\\prod\\limits_{j=1}^{k_i}p_{i,j}^{c_{i,j}}$。\n\n给定一个序列 $a$，长度为 $n$。\n\n定义 $f(x)=\\sum\\limits_{d|x}\\left({a_{\\frac{x}{d}}\\times\\prod\\limits_{i=1}^{k_d}{C_{c_{d,i}+m}^{m}}}\\right)$，现在需要你求出 $f(1),f(2),f(3),\\cdots ,f(n)$，其中 $m$ 是给定常数。\n\n由于 monsters 不喜欢太大的数，他需要你输出答案模 $998244353$ 的值。\n\n另外，为了避免过大的输入输出量，本题使用随机数生成数据，并且只需要你输出所有答案的异或和。\n\n如果你不知道 $C$ 是什么，$C_n^m=\\dfrac{n!}{m!(n-m)!}$，其中 $!$ 代表阶乘。", "inputFormat": "输入共有一行。\n\n第一行，三个非负整数 $n,m,seed$。\n\n你需要在程序中调用 $n$ 次数据生成器（```randomdigit```）来得到 $a$。", "outputFormat": "输出共有一行一个整数，为所有 $f(x)$ 的异或和。", "hint": "**数据生成器**\n\nC/C++:\n```cpp\n#define uint unsigned int\nuint seed;\ninline uint randomdigit(){\n\tseed^=seed<<13;\n\tseed^=seed>>17;\n\tseed^=seed<<5;\n\treturn seed;\n}\n```\npascal:\n```pascal\nvar seed:dword;\nfunction randomdigit:dword;\nbegin\n\tseed:=seed xor(seed shl 13);\n\tseed:=seed xor(seed shr 17);\n\tseed:=seed xor(seed shl 5);\n\trandomdigit:=seed;\nend;\n```\n\npython3:\n```python\nseed = 0 # please input seed\nmod = 1 << 32\ndef randomdigit():\n    global seed\n    seed ^= (seed << 13) % mod\n    seed ^= (seed >> 17) % mod\n    seed ^= (seed << 5) % mod\n    return seed\n```\n\n---\n\n**样例解释**\n\n序列 $a$ 为 $506005380,3857352168,531380003$。\n\n$f(1),f(2),f(3)$ 模 $998244353$ 的值分别为 $506005380,370380136,39141030$。\n\n---\n\n**数据范围**\n\n对于 $100\\%$ 的数据，$0\\le m\\le 10^5,1\\le n\\le 10^7,0\\le a_1,a_2,\\cdots,a_n,seed<2^{32}$。\n\n- Subtask $1$（$30\\%$ 的数据）：$n\\le 10^6,m\\le 10^5$。\n\n在此 Subtask 中：\n\n有 $10\\%$ 的数据，满足 $m=0$。\n\n另有 $10\\%$ 的数据，满足 $n\\le 100$。\n- Subtask $2$（剩下 $70\\%$ 的数据）：$n\\le 10^7,m\\le 3$。\n\n**提示**\n\n请注意空间限制和常数因子对程序运行效率的影响", "locale": "zh-CN"}}}
