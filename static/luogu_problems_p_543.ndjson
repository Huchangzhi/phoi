{"pid": "P12022", "type": "P", "difficulty": 2, "samples": [["3 3\nD\nWD\nLWD\n1 2\n2 3\n1 1", "0\n0\n5"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["USACO", "2025"], "title": "[USACO25OPEN] Hoof Paper Scissors Minus One B", "background": "", "description": "在一局蹄子剪刀布游戏中，Bessie 和 Elsie 可以出 $N$ （$1 \\leq N \\leq 3000$）种不同的蹄子手势，编号为 $1\\dots N$，每个手势对应一种不同的材料。不同材料之间的相互关系有一个复杂的表格，基于该表格，可能会：\n\n- 一种手势获胜，另一种失败。\n- 两种手势平局。\n\n蹄子剪刀布-1.0 的规则类似，但 Bessie 和 Elsie 可以各自出两个手势，每只蹄子出一个。在观察到她们所出的四个手势后，她们各自选择其中一个手势进行游戏。结果根据正常的蹄子剪刀布的规则决定。\n\n给定 Elsie 计划在每局游戏中出的 $M$（$1 \\leq M \\leq 3000$）个手势组合，Bessie 想知道有多少种不同的手势组合可以确保战胜 Elsie。一个手势组合定义为一个有序对 $(L,R)$，其中 $L$ 为奶牛用左蹄出的手势，$R$ 为奶牛用右蹄出的手势。你能为每局游戏进行计算吗？", "inputFormat": "输入的第一行包含两个空格分隔的整数 $N$ 和 $M$，表示蹄子手势的数量，以及 Bessie 与 Elsie 进行的游戏局数。\n以下 $N$ 行，第 $i$ 行由 $i$ 个字符 $a_{i,1}a_{i,2}\\ldots a_{i,i}$ 组成，其中 $a_{i,j} \\in \\{\\texttt D,\\texttt W,\\texttt L\\}$。如果 $a_{i,j} = \\texttt D$，则手势 $i$ 平于手势 $j$。如果 $a_{i,j} = \\texttt W$，则手势 $i$ 胜于手势 $j$。如果 $a_{i,j} = \\texttt L$，则手势 $i$ 负于手势 $j$。输入保证 $a_{i,i} = \\texttt D$。\n\n以下 $M$ 行，每行包含两个空格分隔的整数 $s_1$ 和 $s_2$，其中 $1 \\leq s_1,s_2 \\leq N$，表示 Elsie 在该局游戏中的手势组合。", "outputFormat": "输出 $M$ 行，其中第 $i$ 行包含在第 $i$ 局游戏中 Bessie 可以确保战胜 Elsie 的手势组合数量。", "hint": "在样例 1 解释：这对应于原始的蹄子剪刀布，我们可以设蹄子为 $1$，布为 $2$，剪刀为 $3$。布战胜蹄子，蹄子战胜剪刀，剪刀战胜布。Bessie 无法确保战胜蹄子 + 布或布 + 剪刀的组合。然而，如果 Elsie 出蹄子 + 蹄子，Bessie 可以采用以下任一组合进行反击。\n\n- 布 + 布\n- 布 + 剪刀\n- 布 + 蹄子\n- 蹄子 + 布\n- 剪刀 + 布\n\n如果 Bessie 出这些组合中的任意一个，她可以确保通过出布来获胜。\n\n- 测试点 $2\\sim 6$：$N,M\\le 100$。\n\n- 测试点 $7\\sim 12$：没有额外限制。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO25OPEN] Hoof Paper Scissors Minus One B", "background": null, "description": "In a game of Hoof Paper Scissors, Bessie and Elsie can put out one of $N$ ($1 \\leq N \\leq 3000$) different hoof symbols labeled $1\\dots N$, each corresponding to a different material. There is a complicated chart of how the different materials interact with one another, and based on that chart, either:\n\n- One symbol wins and the other loses.\n- The symbols draw against each other.\n\nHoof Paper Scissors Minus One works similarly, except Bessie and Elsie can each put out two symbols, one with each hoof. After observing all four symbols that they have all put out, they each choose one of their two symbols to play. The outcome is decided based on normal Hoof Paper Scissor conventions.\n\nGiven the $M$ ($1 \\leq M \\leq 3000$) symbol combinations that Elsie plans to make across each game, Bessie wants to know how many different symbol combinations would result in a guaranteed win against Elsie. A symbol combination is defined as an ordered pair $(L,R)$ where $L$ is the symbol the cow plays with her left hoof and $R$ is the symbol the cow plays with her right hoof. Can you compute this for each game?", "inputFormat": "The first line contains two space-separated integers $N$ and $M$ representing the number of hoof symbols and the number of games that Bessie and Elsie play.\n\nOut of the following $N$ lines of input, the $i$th line consists of $i$ characters  $a_{i,1}a_{i,2}\\ldots a_{i,i}$ where each $a_{i,j} \\in \\{\\texttt D,\\texttt W,\\texttt L\\}$. If $a_{i,j} = \\texttt D$, then symbol $i$ draws against symbol $j$.  If $a_{i,j} = \\texttt W$, then symbol $i$ wins against symbol $j$. If $a_{i,j} = \\texttt L$, then symbol $i$ loses against symbol $j$. It is guaranteed that $a_{i,i} = \\texttt D$.\n\nThe next $M$ lines contain two space separated integers $s_1$ and $s_2$ where $1 \\leq s_1,s_2 \\leq N$. This represents Elsie's symbol combination for that game.", "outputFormat": "Output $M$ lines where the $i$-th line contains the number of symbol combinations guaranteeing that Bessie can beat Elsie in the $i$-th game.", "hint": "In this example, this corresponds to the [original Hoof Paper Scissors](https://www.luogu.com.cn/problem/P6120) and we can let Hoof=1, Paper=2, and Scissors=3. Paper beats Hoof, Hoof beats Scissors, and Scissors beats Paper. There is no way for Bessie to guarantee a win against the combinations of Hoof+Paper or Paper+Scissors. However, if Elsie plays Hoof+Hoof, Bessie can counteract with any of the following combinations.\n\n- Paper+Paper\n- Paper+Scissors\n- Paper+Hoof\n- Hoof+Paper\n- Scissors+Paper\n\nIf Bessie plays any of these combinations, she can guarantee that she wins by putting forward Paper.\n\n##### SCORING:\n\n- Inputs 2-6: $N,M\\le 100$\n- Inputs 7-12: No additional constraints.", "locale": "en"}, "zh-CN": {"title": "[USACO25OPEN] Hoof Paper Scissors Minus One B", "background": "", "description": "在一局蹄子剪刀布游戏中，Bessie 和 Elsie 可以出 $N$ （$1 \\leq N \\leq 3000$）种不同的蹄子手势，编号为 $1\\dots N$，每个手势对应一种不同的材料。不同材料之间的相互关系有一个复杂的表格，基于该表格，可能会：\n\n- 一种手势获胜，另一种失败。\n- 两种手势平局。\n\n蹄子剪刀布-1.0 的规则类似，但 Bessie 和 Elsie 可以各自出两个手势，每只蹄子出一个。在观察到她们所出的四个手势后，她们各自选择其中一个手势进行游戏。结果根据正常的蹄子剪刀布的规则决定。\n\n给定 Elsie 计划在每局游戏中出的 $M$（$1 \\leq M \\leq 3000$）个手势组合，Bessie 想知道有多少种不同的手势组合可以确保战胜 Elsie。一个手势组合定义为一个有序对 $(L,R)$，其中 $L$ 为奶牛用左蹄出的手势，$R$ 为奶牛用右蹄出的手势。你能为每局游戏进行计算吗？", "inputFormat": "输入的第一行包含两个空格分隔的整数 $N$ 和 $M$，表示蹄子手势的数量，以及 Bessie 与 Elsie 进行的游戏局数。\n以下 $N$ 行，第 $i$ 行由 $i$ 个字符 $a_{i,1}a_{i,2}\\ldots a_{i,i}$ 组成，其中 $a_{i,j} \\in \\{\\texttt D,\\texttt W,\\texttt L\\}$。如果 $a_{i,j} = \\texttt D$，则手势 $i$ 平于手势 $j$。如果 $a_{i,j} = \\texttt W$，则手势 $i$ 胜于手势 $j$。如果 $a_{i,j} = \\texttt L$，则手势 $i$ 负于手势 $j$。输入保证 $a_{i,i} = \\texttt D$。\n\n以下 $M$ 行，每行包含两个空格分隔的整数 $s_1$ 和 $s_2$，其中 $1 \\leq s_1,s_2 \\leq N$，表示 Elsie 在该局游戏中的手势组合。", "outputFormat": "输出 $M$ 行，其中第 $i$ 行包含在第 $i$ 局游戏中 Bessie 可以确保战胜 Elsie 的手势组合数量。", "hint": "在样例 1 解释：这对应于原始的蹄子剪刀布，我们可以设蹄子为 $1$，布为 $2$，剪刀为 $3$。布战胜蹄子，蹄子战胜剪刀，剪刀战胜布。Bessie 无法确保战胜蹄子 + 布或布 + 剪刀的组合。然而，如果 Elsie 出蹄子 + 蹄子，Bessie 可以采用以下任一组合进行反击。\n\n- 布 + 布\n- 布 + 剪刀\n- 布 + 蹄子\n- 蹄子 + 布\n- 剪刀 + 布\n\n如果 Bessie 出这些组合中的任意一个，她可以确保通过出布来获胜。\n\n- 测试点 $2\\sim 6$：$N,M\\le 100$。\n\n- 测试点 $7\\sim 12$：没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P12023", "type": "P", "difficulty": 2, "samples": [["2\n4\n1 1 2 3\n4\n3 3 2 1", "3\n1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["USACO", "2025"], "title": "[USACO25OPEN] More Cow Photos B", "background": "", "description": "今天奶牛们的心情特别顽皮！Farmer John 只是想拍摄一张奶牛们排成一行的照片，但她们总是在他得到机会按下快门之前移动位置。\n\n具体地说，FJ 的 $N$ 头奶牛（$1 \\le N \\le 10^5$）每一头的身高都是 $1$ 到 $N$ 的整数。FJ 想要拍摄奶牛以一种特定的顺序排成一行的照片。如果奶牛们排成一行时从左到右有身高 $h_1, \\dots, h_K$，他希望奶牛们的身高拥有以下三个性质：\n\n- 他希望奶牛们的身高先递增再递减。形式化地说，必须存在一个整数 $i$ 使得 $h_1 \\le \\dots \\le h_i \\ge \\dots \\ge h_K$。\n- 他不希望任何奶牛与另一头身高完全相同的奶牛相邻。形式化地说，对于所有 $1 \\le i < K$ 有 $h_i \\neq h_{i+1}$。\n- 他希望照片是对称的。形式化地说，如果 $i + j = K+1$，则 $h_i = h_j$。\n\nFJ 希望照片中包含尽可能多的奶牛。具体地说，FJ 可以移除一些奶牛并重新排列余下的奶牛。计算 FJ 在满足他的限制的情况下可以在照片中包含的奶牛的最大数量。", "inputFormat": "你需要回答多个测试用例。\n输入的第一行包含一个整数 $T$（$1 \\leq T \\leq 10^5$），为测试用例的数量。以下为 $T$ 个测试用例。\n\n每一个测试用例的第一行包含一个整数 $N$。第二行包含 $N$ 个整数，为可用的 $N$ 头奶牛的身高。奶牛们的身高在 $1$ 到 $N$ 之间。\n\n输入保证所有测试用例的 $N$ 之和不超过 $10^6$。", "outputFormat": "输出 $T$ 行，第 $i$ 行包含第 $i$ 个测试用例的答案。每行包含一个整数，表示 FJ 可以在照片中包含的奶牛的最大数量。\n", "hint": "对于第一个测试用例，FJ 可以选择身高为 $1$，$1$ 和 $3$ 的奶牛，并重新排列为 $[1,3,1]$，满足所有条件。对于第二个测试用例，FJ 可以选择身高为 $3$ 的奶牛以组成一张合法的照片。\n\n- 测试点 $2\\sim3$：$T\\le 100$，$N \\le 7$。\n- 测试点 $4\\sim5$：$T \\le 10^4$，所有奶牛的身高不超过 $10$。\n- 测试点 $6\\sim11$：没有额外限制。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO25OPEN] More Cow Photos B", "background": null, "description": "The cows are in a particularly mischievous mood today!  All Farmer John wants to\ndo is take a photograph of the cows standing in a line, but they keep moving\nright before he has a chance to snap the picture.\n\nSpecifically, each of FJ's $N$ cows $(1 \\le N \\le 10^5)$ has an integer height from $1$ to $N$. FJ wants to take a picture of the cows standing in line in a very specific ordering. If the cows have heights $h_1, \\dots, h_K$ when lined up from left to right, he wants the cow heights to have the following three properties:\n\n- He wants the cow heights to increase and then decrease. Formally, there must exist an integer $i$ such that $h_1 \\le \\dots \\le h_i \\ge \\dots \\ge h_K$.\n- He does not want any cow standing next to another cow with exactly the same height. Formally, $h_i \\neq h_{i+1}$ for all $1 \\le i \\lt K$.\n- He wants the picture to be symmetric. Formally, if $i + j = K+1$, then $h_i = h_j$.\n\nFJ wants the picture to contain as many cows as possible. Specifically, FJ can remove some cows and rearrange the remaining ones. Compute the maximum number of cows FJ can have in the picture satisfying his constraints.", "inputFormat": "You have to answer multiple test cases.\n\nThe first line of input contains a single integer $T$ ($1 \\leq T \\leq 10^5$) denoting the number of test cases. $T$ test cases follow.\n\nThe first line of every test case contains a single integer $N$. The second line of every test case contains $N$ integers, the heights of the $N$ cows available. The cow heights will be between $1$ and $N$.\n\nIt is guaranteed the sum of $N$ over all test cases will not exceed $10^6$.", "outputFormat": "Output $T$ lines, the $i$'th line containing the answer to the $i$'th test case. Each line should be an integer denoting the maximum number of cows FJ can include in the picture.", "hint": "For the first test case, FJ can take the cows with heights $1$, $1$, and $3$, and rearrange them into $[1,3,1]$, which satisfies all the conditions. For the second test case, FJ can take the cow with height $3$ and form a valid photo.\n\n#### SCORING:\n\n- Inputs 2-3: $T\\le 100, N \\le 7$\n- Inputs 4-5: $T \\le 10^4$, all cows will have height at most 10.\n- Inputs 6-11: No additional constraints.", "locale": "en"}, "zh-CN": {"title": "[USACO25OPEN] More Cow Photos B", "background": "", "description": "今天奶牛们的心情特别顽皮！Farmer John 只是想拍摄一张奶牛们排成一行的照片，但她们总是在他得到机会按下快门之前移动位置。\n\n具体地说，FJ 的 $N$ 头奶牛（$1 \\le N \\le 10^5$）每一头的身高都是 $1$ 到 $N$ 的整数。FJ 想要拍摄奶牛以一种特定的顺序排成一行的照片。如果奶牛们排成一行时从左到右有身高 $h_1, \\dots, h_K$，他希望奶牛们的身高拥有以下三个性质：\n\n- 他希望奶牛们的身高先递增再递减。形式化地说，必须存在一个整数 $i$ 使得 $h_1 \\le \\dots \\le h_i \\ge \\dots \\ge h_K$。\n- 他不希望任何奶牛与另一头身高完全相同的奶牛相邻。形式化地说，对于所有 $1 \\le i < K$ 有 $h_i \\neq h_{i+1}$。\n- 他希望照片是对称的。形式化地说，如果 $i + j = K+1$，则 $h_i = h_j$。\n\nFJ 希望照片中包含尽可能多的奶牛。具体地说，FJ 可以移除一些奶牛并重新排列余下的奶牛。计算 FJ 在满足他的限制的情况下可以在照片中包含的奶牛的最大数量。", "inputFormat": "你需要回答多个测试用例。\n输入的第一行包含一个整数 $T$（$1 \\leq T \\leq 10^5$），为测试用例的数量。以下为 $T$ 个测试用例。\n\n每一个测试用例的第一行包含一个整数 $N$。第二行包含 $N$ 个整数，为可用的 $N$ 头奶牛的身高。奶牛们的身高在 $1$ 到 $N$ 之间。\n\n输入保证所有测试用例的 $N$ 之和不超过 $10^6$。", "outputFormat": "输出 $T$ 行，第 $i$ 行包含第 $i$ 个测试用例的答案。每行包含一个整数，表示 FJ 可以在照片中包含的奶牛的最大数量。\n", "hint": "对于第一个测试用例，FJ 可以选择身高为 $1$，$1$ 和 $3$ 的奶牛，并重新排列为 $[1,3,1]$，满足所有条件。对于第二个测试用例，FJ 可以选择身高为 $3$ 的奶牛以组成一张合法的照片。\n\n- 测试点 $2\\sim3$：$T\\le 100$，$N \\le 7$。\n- 测试点 $4\\sim5$：$T \\le 10^4$，所有奶牛的身高不超过 $10$。\n- 测试点 $6\\sim11$：没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P12024", "type": "P", "difficulty": 4, "samples": [["12 5\nabcabbacabac\n1 12\n2 7\n4 8\n2 5\n3 10", "28\n6\n1\n-1\n12"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["二分", "USACO", "2025", "枚举"], "title": "[USACO25OPEN] It's Mooin' Time III B", "background": null, "description": "Elsie 正在试图向 Bessie 描述她最喜欢的 USACO 竞赛，但 Bessie 很难理解为什么 Elsie 这么喜欢它。Elsie 说「现在是哞哞时间！谁想哞哞？拜托，我只想参加 USACO」。\n\nBessie 仍然不理解，于是她将 Elsie 的描述转文字得到了一个长为 $N$（$3 \\leq N \\leq 10^5$）的字符串，包含小写字母字符 $s_1s_2 \\ldots s_N$。Elsie 认为一个包含三个字符的字符串 $t$ 是一个哞叫，如果 $t_2 = t_3$ 且 $t_2 \\neq t_1$。\n\n一个三元组 $(i, j, k)$ 是合法的，如果 $i < j < k$ 且字符串 $s_i s_j s_k$ 组成一个哞叫。对于该三元组，FJ 执行以下操作计算其值：\n\n- FJ 将字符串 $s$ 在索引 $j$ 处弯曲 90 度\n- 该三元组的值是 $\\Delta ijk$ 的面积的两倍。\n\n换句话说，该三元组的值等于 $(j-i)(k-j)$。\n\nBessie 向你进行 $Q$（$1 \\leq Q \\leq 3 \\cdot 10^4$）个查询。在每个查询中，她给你两个整数 $l$ 和 $r$（$1 \\leq l \\leq r \\leq N$，$r-l+1 \\ge 3$），并询问满足 $l \\leq i$ 和 $k \\leq r$ 的所有合法三元组 $(i, j, k)$ 的最大值。如果不存在合法的三元组，输出 $-1$。\n\n注意这个问题涉及到的整数可能需要使用 64 位整数类型（例如，C/C++ 中的 `long long`）。", "inputFormat": "输入的第一行包含两个整数 $N$ 和 $Q$。\n以下一行包含 $s_1 s_2, \\ldots s_N$。\n\n以下 $Q$ 行每行包含两个整数 $l$ 和 $r$，表示每个查询。", "outputFormat": "对于每一个查询输出一行，包含对于该查询的答案。", "hint": "#### 样例解释\n对于第一个查询，$(i,j,k)$ 必须满足 $1 \\le i < j < k \\le 12$。可以证明，对于某个合法的 $(i,j,k)$，$\\Delta ijk$ 的最大面积在 $i=1$，$j=8$ 以及 $k=12$ 时取到。注意 $s_1 s_8 s_{12}$ 是字符串 \"acc\"，根据前述定义是一个哞叫。$\\Delta ijk$ 的直角边长为 $7$ 和 $4$，从而它的面积的两倍将等于 $28$。\n\n对于第三个查询，$(i,j,k)$ 必须满足 $4 \\le i < j < k \\le 8$。可以证明，对于某个合法的 $(i,j,k)$，$\\Delta ijk$ 的最大面积在 $i=4$，$j=5$ 以及 $k=6$ 时取到。\n\n对于第四个查询，不存在满足 $2 \\le i < j < k \\le 5$ 的 $(i,j,k)$ 使得 $s_i s_j s_k$ 是一个哞叫，所以该查询的输出为 $-1$。\n\n#### 测试点性质\n\n- 测试点 $2\\sim3$：$N,Q\\le 50$。\n- 测试点 $4\\sim6$：$Q=1$，唯一的询问满足 $l=1$ 且 $r=N$。\n- 测试点 $7\\sim 11$：没有额外限制。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO25OPEN] It's Mooin' Time III B", "background": null, "description": "Elsie is trying to describe her favorite USACO contest to Bessie, but Bessie is having trouble understanding why Elsie likes it so much. Elsie says \"And It's mooin' time! Who wants a mooin'? Please, I just want to do USACO\".\n\nBessie still doesn't understand, so she transcribes Elsie's description in a string of length $N$ ($3 \\leq N \\leq 10^5$) containing lowercase alphabetic characters $s_1s_2 \\ldots s_N$. Elsie considers a string $t$ containing three characters a moo if $t_2 = t_3$ and $t_2 \\neq t_1$.\n\nA triplet $(i, j, k)$ is valid if $i < j < k$ and string $s_i s_j s_k$ forms a moo. For the triplet, FJ performs the following to calculate its value:\n\n- FJ bends string $s$ 90-degrees at index $j$\n- The value of the triplet is twice the area of $\\Delta ijk$.\n\nIn other words, the value of the triplet is $(j-i)(k-j)$.\n\nBessie asks you $Q$ ($1 \\leq Q \\leq 3 \\cdot 10^4$) queries. In each query, she gives you two integers $l$ and $r$ ($1 \\leq l \\leq r \\leq N$, $r-l+1 \\ge 3$) and ask you for the maximum value among valid triplets $(i, j, k)$ such that $l \\leq i$ and $k \\leq r$. If no valid triplet exists, output $-1$.\n\n**Note that the large size of integers involved in this problem may require the use of 64-bit integer data types (e.g., a \"long long\" in C/C++).**", "inputFormat": "The first line contains two integers $N$ and $Q$.\n\nThe following line contains $s_1 s_2, \\ldots s_N$.\n\nThe following $Q$ lines contain two integers $l$ and $r$, denoting each query.", "outputFormat": "Output the answer for each query on a new line.", "hint": "For the first query, ($i,j,k$) must satisfy $1 \\le i < j < k \\le 12$. It can be shown that the maximum area of $\\Delta ijk$ for some valid ($i,j,k$) is achieved when $i=1$, $j=8$, and $k=12$. Note that $s_1 s_8 s_{12}$ is the string \"acc\" which is a moo according to the definitions above. $\\Delta ijk$ will have legs of lengths $7$ and $4$ so two times the area of it will be $28$.\n\nFor the third query, ($i,j,k$) must satisfy $4 \\le i < j < k \\le 8$. It can be shown that the maximum area of $\\Delta ijk$ for some valid ($i,j,k$) is achieved when $i=4$, $j=5$, and $k=6$.\n\nFor the fourth query, there exists no ($i,j,k$) satisfying $2 \\le i < j < k \\le 5$ in which $s_i s_j s_k$ is a moo so the output to that query is $-1$.\n\n#### SCORING:\n- Inputs 2-3: $N,Q\\le 50$\n- Inputs 4-6: $Q=1$ and the singular query satisfies $l=1$ and $r=N$\n- Inputs 7-11: No additional constraints", "locale": "en"}, "zh-CN": {"title": "[USACO25OPEN] It's Mooin' Time III B", "background": null, "description": "Elsie 正在试图向 Bessie 描述她最喜欢的 USACO 竞赛，但 Bessie 很难理解为什么 Elsie 这么喜欢它。Elsie 说「现在是哞哞时间！谁想哞哞？拜托，我只想参加 USACO」。\n\nBessie 仍然不理解，于是她将 Elsie 的描述转文字得到了一个长为 $N$（$3 \\leq N \\leq 10^5$）的字符串，包含小写字母字符 $s_1s_2 \\ldots s_N$。Elsie 认为一个包含三个字符的字符串 $t$ 是一个哞叫，如果 $t_2 = t_3$ 且 $t_2 \\neq t_1$。\n\n一个三元组 $(i, j, k)$ 是合法的，如果 $i < j < k$ 且字符串 $s_i s_j s_k$ 组成一个哞叫。对于该三元组，FJ 执行以下操作计算其值：\n\n- FJ 将字符串 $s$ 在索引 $j$ 处弯曲 90 度\n- 该三元组的值是 $\\Delta ijk$ 的面积的两倍。\n\n换句话说，该三元组的值等于 $(j-i)(k-j)$。\n\nBessie 向你进行 $Q$（$1 \\leq Q \\leq 3 \\cdot 10^4$）个查询。在每个查询中，她给你两个整数 $l$ 和 $r$（$1 \\leq l \\leq r \\leq N$，$r-l+1 \\ge 3$），并询问满足 $l \\leq i$ 和 $k \\leq r$ 的所有合法三元组 $(i, j, k)$ 的最大值。如果不存在合法的三元组，输出 $-1$。\n\n注意这个问题涉及到的整数可能需要使用 64 位整数类型（例如，C/C++ 中的 `long long`）。", "inputFormat": "输入的第一行包含两个整数 $N$ 和 $Q$。\n以下一行包含 $s_1 s_2, \\ldots s_N$。\n\n以下 $Q$ 行每行包含两个整数 $l$ 和 $r$，表示每个查询。", "outputFormat": "对于每一个查询输出一行，包含对于该查询的答案。", "hint": "#### 样例解释\n对于第一个查询，$(i,j,k)$ 必须满足 $1 \\le i < j < k \\le 12$。可以证明，对于某个合法的 $(i,j,k)$，$\\Delta ijk$ 的最大面积在 $i=1$，$j=8$ 以及 $k=12$ 时取到。注意 $s_1 s_8 s_{12}$ 是字符串 \"acc\"，根据前述定义是一个哞叫。$\\Delta ijk$ 的直角边长为 $7$ 和 $4$，从而它的面积的两倍将等于 $28$。\n\n对于第三个查询，$(i,j,k)$ 必须满足 $4 \\le i < j < k \\le 8$。可以证明，对于某个合法的 $(i,j,k)$，$\\Delta ijk$ 的最大面积在 $i=4$，$j=5$ 以及 $k=6$ 时取到。\n\n对于第四个查询，不存在满足 $2 \\le i < j < k \\le 5$ 的 $(i,j,k)$ 使得 $s_i s_j s_k$ 是一个哞叫，所以该查询的输出为 $-1$。\n\n#### 测试点性质\n\n- 测试点 $2\\sim3$：$N,Q\\le 50$。\n- 测试点 $4\\sim6$：$Q=1$，唯一的询问满足 $l=1$ 且 $r=N$。\n- 测试点 $7\\sim 11$：没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P12025", "type": "P", "difficulty": 4, "samples": [["3\n2 1\n33 5\n10 5", "2\n2 0\n3\n3 23 7 \n-1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["USACO", "2025", "Special Judge", "构造"], "title": "[USACO25OPEN] Sequence Construction S", "background": null, "description": "最近，农夫约翰农场里的奶牛们迷上了观看《炼乳神探》这档节目。节目讲述了一头聪明的奶牛侦探 CowCow 解决各类案件的故事。贝茜从节目中发现了新的谜题，但答案要等到下周的下一集才会揭晓！请帮她解决这个问题。\n\n给定整数 $M$ 和 $K$ $(1 \\leq M \\leq 10^9, 1 \\leq K \\leq 31)$。请选择一个正整数 $N$ 并构造一个包含 $N$ 个非负整数的序列 $a$，满足以下条件：\n\n- $1 \\le N \\le 100$。\n- $a_1 + a_2 + \\dots + a_N = M$。\n- $\\text{popcount}(a_1) \\oplus \\text{ popcount}(a_2) \\oplus \\dots \\oplus \\text{ popcount}(a_N) = K$。\n\n如果不存在这样的序列，输出 $-1$。\n\n$\\dagger \\text{ popcount}(x)$ 表示整数 $x$ 的二进制表示中 $1$ 的位数。例如，$11$ 的 popcount 是 $3$，$16$ 的 popcount 是 $1$。\n\n$\\dagger \\oplus$ 表示按位异或运算符。\n\n输入包含 $T$ ($1 \\le T \\le 5 \\cdot 10^3$) 组独立测试用例。", "inputFormat": "第一行包含 $T$。\n\n每个测试用例的第一行也是唯一一行包含 $M$ 和 $K$。\n\n保证所有测试用例都是唯一的。", "outputFormat": "按以下方式输出 $T$ 个测试用例的解答：\n\n如果无解，该测试用例对应的唯一一行输出应为 $-1$。\n\n否则，该测试用例的第一行输出应为序列长度 $N$（$1 \\le N \\le 100$），第二行输出应包含 $N$ 个用空格分隔且满足条件的整数（$0 \\le a_i \\le M$）。", "hint": "在第一个测试用例中，数组 $a = [2, 0]$ 的元素之和为 $2$。其 popcount 的异或和为 $1 \\oplus 0 = 1$，因此所有条件均被满足。\n\n在第二个测试用例中，数组 $a = [3, 23, 7]$ 的元素之和为 $33$。其 popcount 的异或和为 $2 \\oplus 4 \\oplus 3 = 5$，因此所有条件均被满足。\n\n其他有效数组包括 $a = [4, 2, 15, 5, 7]$ 和 $a = [1, 4, 0, 27, 1]$。\n\n可以证明第三个测试用例不存在有效数组。\n\n- 测试点 $2$：$M \\leq 8, K \\leq 8$。\n- 测试点 $3\\sim 5$：$M > 2^K$。\n- 测试点 $6\\sim18$：无额外限制。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO25OPEN] Sequence Construction S", "background": null, "description": "Lately, the cows on Farmer John's farm have been infatuated with watching the show Apothecowry Dairies. The show revolves around a clever bovine sleuth CowCow solving problems of various kinds. Bessie found a new problem from the show, but the solution won't be revealed until the next episode in a week! Please solve the problem for her.\n\nYou are given integers $M$ and $K$ $(1 \\leq M \\leq 10 ^ 9, 1 \\leq K \\leq 31)$. Please choose a positive integer $N$ and construct a sequence $a$ of $N$ non-negative integers such that the following conditions are satisfied:\n- $1 \\le N \\le 100$ \n- $a_1 + a_2 + \\dots + a_N = M$\n- $\\text{popcount}(a_1) \\oplus \\text{ popcount}(a_2) \\oplus \\dots \\oplus \\text{ popcount}(a_N) = K$\n\nIf no such sequence exists, print $-1$.\n\n$\\dagger \\text{ popcount}(x)$ is the number of bits equal to $1$ in the binary representation of the integer $x$. For instance, the popcount of $11$ is $3$ and the popcount of $16$ is $1$.\n\n$\\dagger \\oplus$ is the bitwise xor operator.\n\nThe input will consist of $T$ ($1 \\le T \\le 5 \\cdot 10^3$) independent test cases.", "inputFormat": "The first line contains $T$.\n\nThe first and only line of each test case has $M$ and $K$. \n\nIt is guaranteed that all test cases are unique.", "outputFormat": "Output the solutions for $T$ test cases as follows:\n\nIf no answer exists, the only line for that test case should be $-1$.\n\nOtherwise, the first line for that test case should be a single integer $N$, the length of the sequence -- ($1 \\le  N \\le 100$).\n\nThe second line for that test case should contain $N$ space-separated integers that satisfy the conditions -- ($0 \\le a_i \\le M$).", "hint": "In the first test case, the elements in the array $a = [2, 0]$ sum to $2$. The xor sum of popcounts is $1 \\oplus 0 = 1$. Thus, all the conditions are satisfied.\n\nIn the second test case, the elements in the array $a = [3, 23, 7]$ sum to $33$. The xor sum of the popcounts is $2 \\oplus 4 \\oplus 3 = 5$. Thus, all conditions are satisfied.\n\nOther valid arrays are $a = [4, 2, 15, 5, 7]$ and $a = [1, 4, 0, 27, 1]$.\n\nIt can be shown that no valid arrays exist for the third test case.\n\n#### SCORING:\n- Input 2: $M \\leq 8, K \\leq 8$\n- Inputs 3-5: $M \\gt 2^K$\n- Inputs 6-18: No additional constraints.", "locale": "en"}, "zh-CN": {"title": "[USACO25OPEN] Sequence Construction S", "background": null, "description": "最近，农夫约翰农场里的奶牛们迷上了观看《炼乳神探》这档节目。节目讲述了一头聪明的奶牛侦探 CowCow 解决各类案件的故事。贝茜从节目中发现了新的谜题，但答案要等到下周的下一集才会揭晓！请帮她解决这个问题。\n\n给定整数 $M$ 和 $K$ $(1 \\leq M \\leq 10^9, 1 \\leq K \\leq 31)$。请选择一个正整数 $N$ 并构造一个包含 $N$ 个非负整数的序列 $a$，满足以下条件：\n\n- $1 \\le N \\le 100$。\n- $a_1 + a_2 + \\dots + a_N = M$。\n- $\\text{popcount}(a_1) \\oplus \\text{ popcount}(a_2) \\oplus \\dots \\oplus \\text{ popcount}(a_N) = K$。\n\n如果不存在这样的序列，输出 $-1$。\n\n$\\dagger \\text{ popcount}(x)$ 表示整数 $x$ 的二进制表示中 $1$ 的位数。例如，$11$ 的 popcount 是 $3$，$16$ 的 popcount 是 $1$。\n\n$\\dagger \\oplus$ 表示按位异或运算符。\n\n输入包含 $T$ ($1 \\le T \\le 5 \\cdot 10^3$) 组独立测试用例。", "inputFormat": "第一行包含 $T$。\n\n每个测试用例的第一行也是唯一一行包含 $M$ 和 $K$。\n\n保证所有测试用例都是唯一的。", "outputFormat": "按以下方式输出 $T$ 个测试用例的解答：\n\n如果无解，该测试用例对应的唯一一行输出应为 $-1$。\n\n否则，该测试用例的第一行输出应为序列长度 $N$（$1 \\le N \\le 100$），第二行输出应包含 $N$ 个用空格分隔且满足条件的整数（$0 \\le a_i \\le M$）。", "hint": "在第一个测试用例中，数组 $a = [2, 0]$ 的元素之和为 $2$。其 popcount 的异或和为 $1 \\oplus 0 = 1$，因此所有条件均被满足。\n\n在第二个测试用例中，数组 $a = [3, 23, 7]$ 的元素之和为 $33$。其 popcount 的异或和为 $2 \\oplus 4 \\oplus 3 = 5$，因此所有条件均被满足。\n\n其他有效数组包括 $a = [4, 2, 15, 5, 7]$ 和 $a = [1, 4, 0, 27, 1]$。\n\n可以证明第三个测试用例不存在有效数组。\n\n- 测试点 $2$：$M \\leq 8, K \\leq 8$。\n- 测试点 $3\\sim 5$：$M > 2^K$。\n- 测试点 $6\\sim18$：无额外限制。", "locale": "zh-CN"}}}
{"pid": "P12026", "type": "P", "difficulty": 4, "samples": [["4 4 5\n17 2\n100 0\n10 1\n200 4", "118"], ["4 4 5\n100 0\n10 1\n100 3\n20 4", "30"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["图论", "贪心", "USACO", "2025", "图论建模", "拓扑排序"], "title": "[USACO25OPEN] Compatible Pairs S", "background": "", "description": "Deep in the countryside, Farmer John’s cows aren’t just ordinary farm animals—they are part of a clandestine bovine intelligence network. Each cow carries an ID number, carefully assigned by the elite cow cryptographers. However, due to Farmer John's rather haphazard tagging system, some cows ended up with the same ID.\n\nFarmer John noted that there are $N$ ($1\\le N\\le 2\\cdot 10^5$) unique ID numbers, and for each unique ID $d_i$ ($0\\le d_i\\le 10^9$), there are $n_i$ ($1\\le n_i\\le 10^9$) cows who shared it.\n\nThe cows can only communicate in pairs, and their secret encryption method has one strict rule: two cows can only exchange information if they are not the same cow and the sum of their ID numbers equals either $A$ or $B$ ($0\\le A\\le B\\le 2\\cdot 10^9$). A cow can only engage in one conversation at a time (i.e., no cow can be part of more than one pair).\n\nFarmer John would like to maximize the number of disjoint communication pairs to ensure the best information flow. Can you determine the largest number of conversations that can happen at once?", "inputFormat": "The first line contains $N$, $A$, $B$.\n\nThe next $N$ lines each contain $n_i$ and $d_i$. No two $d_i$ are the same.", "outputFormat": "The maximum number of disjoint communicating pairs that can be formed at the same time.\n\n**Note that the large size of integers involved in this problem may require the use of 64-bit integer data types (e.g., a \"long long\" in C/C++).**", "hint": "##### For Sample 1:\n\nA cow with an ID of $0$ can communicate with another cow with an ID of $4$ because the sum of their IDs is $4$.  Since there are a total of $100$ cows of ID $0$ and $200$ cows of ID $4$,  there can be up to $100$ communicating pairs with this combination of IDs.\n\nA cow with an ID of $4$ can also communicate with another cow with an ID of $1$ (sum to $5$). There are $10$ cows of ID $1$ and $100$ remaining unpaired cows of ID $4$, allowing for another $10$ pairs.\n\nFinally, a cow with an ID of $2$ can communicate with another cow of the same ID.  Since there are a total of $17$ cows of ID $2$, there can be up to $8$ more pairs.\n\nIn total, there are $100+10+8=118$ communicating pairs. It can be shown that this is the maximum possible number of pairs.\n\n\n##### For Sample 2:\n\nPairing IDs $0$ and $4$ makes $20$ pairs, while pairing IDs $1$ and $3$ makes $10$ pairs. It can be shown that this is the optimal pairing, resulting in a total of $30$ pairs.\n\n#### SCORING:\n\n- Inputs 3-4: $A=B$\n- Inputs 5-7: $N\\le 1000$\n- Inputs 8-12: No additional constraints", "locale": "en", "translations": {"en": {"title": "[USACO25OPEN] Compatible Pairs S", "background": "", "description": "Deep in the countryside, Farmer John’s cows aren’t just ordinary farm animals—they are part of a clandestine bovine intelligence network. Each cow carries an ID number, carefully assigned by the elite cow cryptographers. However, due to Farmer John's rather haphazard tagging system, some cows ended up with the same ID.\n\nFarmer John noted that there are $N$ ($1\\le N\\le 2\\cdot 10^5$) unique ID numbers, and for each unique ID $d_i$ ($0\\le d_i\\le 10^9$), there are $n_i$ ($1\\le n_i\\le 10^9$) cows who shared it.\n\nThe cows can only communicate in pairs, and their secret encryption method has one strict rule: two cows can only exchange information if they are not the same cow and the sum of their ID numbers equals either $A$ or $B$ ($0\\le A\\le B\\le 2\\cdot 10^9$). A cow can only engage in one conversation at a time (i.e., no cow can be part of more than one pair).\n\nFarmer John would like to maximize the number of disjoint communication pairs to ensure the best information flow. Can you determine the largest number of conversations that can happen at once?", "inputFormat": "The first line contains $N$, $A$, $B$.\n\nThe next $N$ lines each contain $n_i$ and $d_i$. No two $d_i$ are the same.", "outputFormat": "The maximum number of disjoint communicating pairs that can be formed at the same time.\n\n**Note that the large size of integers involved in this problem may require the use of 64-bit integer data types (e.g., a \"long long\" in C/C++).**", "hint": "##### For Sample 1:\n\nA cow with an ID of $0$ can communicate with another cow with an ID of $4$ because the sum of their IDs is $4$.  Since there are a total of $100$ cows of ID $0$ and $200$ cows of ID $4$,  there can be up to $100$ communicating pairs with this combination of IDs.\n\nA cow with an ID of $4$ can also communicate with another cow with an ID of $1$ (sum to $5$). There are $10$ cows of ID $1$ and $100$ remaining unpaired cows of ID $4$, allowing for another $10$ pairs.\n\nFinally, a cow with an ID of $2$ can communicate with another cow of the same ID.  Since there are a total of $17$ cows of ID $2$, there can be up to $8$ more pairs.\n\nIn total, there are $100+10+8=118$ communicating pairs. It can be shown that this is the maximum possible number of pairs.\n\n\n##### For Sample 2:\n\nPairing IDs $0$ and $4$ makes $20$ pairs, while pairing IDs $1$ and $3$ makes $10$ pairs. It can be shown that this is the optimal pairing, resulting in a total of $30$ pairs.\n\n#### SCORING:\n\n- Inputs 3-4: $A=B$\n- Inputs 5-7: $N\\le 1000$\n- Inputs 8-12: No additional constraints", "locale": "en"}, "zh-CN": {"title": "[USACO25OPEN] Compatible Pairs S", "background": "", "description": "在乡村深处，Farmer John 的奶牛们不仅仅是普通的农场动物——她们是一个奶牛地下情报网络的一部分。每头奶牛都有一个识别码，由奶牛密码专家精心分配。然而，由于 Farmer John 相当随意的标记系统，一些奶牛最终得到了相同的识别码。\n\nFarmer John 注意到有 $N$（$1\\leq N\\leq 2\\cdot10^5$）个不同的识别码，对于每一个不同的识别码 $d_i$（$0\\leq d_i\\leq 10^9$），有 $n_i$（$1\\leq n_i\\leq 10^9$）头奶牛共用该识别码。\n\n这些奶牛们只能一对一地进行通信，她们的秘密加密方法有一个严格的规则：两头奶牛只有当她们不是同一头奶牛且她们的识别码之和等于 $A$ 或 $B$ 时（$0\\leq A\\leq B\\leq 2\\cdot10^9$），她们才能交换信息。每头奶牛同时只能参与一个对话（即，没有奶牛可以属于多对）。", "inputFormat": "输入的第一行包含 $N$，$A$，$B$。\n\n接下来 $N$ 行每行包含 $n_i$ 和 $d_i$。所有 $d_i$ 均不相同。", "outputFormat": "输出一行，包含同时可以组成的独立通信对的最大数量。\n\n**注意这个问题涉及到的整数可能需要使用 64 位整数类型（例如，C/C++ 中的 \"long long\"）。**", "hint": "#### 样例一解释\n\n一头识别码为 $0$ 的奶牛可以与另一头识别码为 $4$ 的奶牛通信，因为她们的识别码之和为 $4$。由于总共有 $100$ 头识别码为 $0$ 的奶牛和 $200$ 头识别码为 $4$ 的奶牛，因此可以组成至多 $100$ 对此识别码组合的通信对。\n\n一头识别码为 $4$ 的奶牛也可以与另一头识别码为 $1$ 的奶牛通信（和为 $5$）。有 $10$ 头识别码为 $1$ 的奶牛和 $100$ 头余下未配对的识别码为 $4$ 的奶牛，组成另外 $10$ 对。\n\n最后，一头识别码为 $2$ 的奶牛可以与另一头相同识别码的奶牛通信。由于总共有 $17$ 头识别码为 $2$ 的奶牛，因此可以另外组成至多 $8$ 对。\n\n总共组成 $100+10+8=118$ 对通信对。可以证明这是最大可能的对数。 \n\n#### 样例二解释\n\n将识别码 $0$ 和 $4$ 配对可以组成 $20$ 对，而将识别码 $1$ 和 $3$ 配对可以组成 $10$ 对。可以证明这是最优配对方案，总共组成 $30$ 对。\n\n#### 测试点性质\n\n- 测试点 $3\\sim4$：$A=B$。\n- 测试点 $5\\sim7$：$N\\le 1000$。\n- 测试点 $8\\sim12$：无额外限制。", "locale": "zh-CN"}}}
{"pid": "P12027", "type": "P", "difficulty": 4, "samples": [["4\n1 20 200\n2 30 300\n2 10 100\n8\n19 0\n19 1\n19 2\n20 0\n20 1\n20 2\n29 0\n30 0", "0\n300\n500\n300\n500\n500\n300\n500"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["USACO", "2025"], "title": "[USACO25OPEN] Ski Slope S", "background": "", "description": "Bessie is going on a ski trip with her friends. The mountain has $N$ waypoints ($1\\leq N \\leq 10^5$) labeled $1, 2, \\ldots, N$ in increasing order of altitude (waypoint $1$ is the bottom of the mountain). \n\nFor each waypoint $i \\gt 1$, there is a ski run starting from waypoint $i$ and ending at waypoint $p_i$ ($1\\le p_i\\lt i$).  This run has difficulty $d_i$ ($0 \\leq d_i \\leq 10^9$) and enjoyment $e_i$ ($0 \\leq e_i \\leq 10^9$).\n\nEach of Bessie's $M$ friends ($1\\leq M \\leq 10^5$) will do the following: They ill pick some initial waypoint $i$ to start at, and then follow the runs downward (to $p_i$, then to $p_{p_i}$, and so forth) until they get to waypoint $1$. \n\nThe enjoyment each friend gets is equal to the sum of the enjoyments of the runs they follow. Each friend also has a different skill level $s_j$ ($0 \\leq s_j \\leq 10^9$)  and courage level $c_j$ ($0 \\leq c_j \\leq 10$), which limits them to selecting an initial waypoint that results in them taking at most $c_j$ runs with difficulty greater than $s_j$.\n\nFor each friend, compute the maximum enjoyment they can get.", "inputFormat": "The first line contains $N$.\n\nThen for each $i$ from $2$ to $N$, a line follows containing three space-separated integers $p_i$, $d_i$, and $e_i$.\n\nThe next line contains $M$.\n\nThe next $M$ lines each contain two space-separated integers $s_j$ and $c_j$.", "outputFormat": "Output $M$ lines, with the answer for each friend on a separate line.\n\n**Note that the large size of integers involved in this problem may require the use of 64-bit integer data types (e.g., a \"long long\" in C/C++).**", "hint": "1. The first friend cannot start any waypoint other than $1$, since any other waypoint would cause them to take at least one run with difficulty greater than $19$. Their total enjoyment is $0$.\n2. The second friend can start at waypoint $4$ and take runs down to waypoint $2$ and then $1$. Their total enjoyment is $100+200=300$. They take one run with difficulty greater than $19$.\n3. The third friend can start at waypoint $3$ and take runs down to waypoint $2$ and then $1$. Their total enjoyment is $300+200=500$. They take two runs with difficulty greater than $19$.\n\n#### SCORING:\n\n- Inputs 2-4: $N, M\\le 1000$\n- Inputs 5-7: All $c_j=0$\n- Inputs 8-17: No additional constraints.", "locale": "en", "translations": {"en": {"title": "[USACO25OPEN] Ski Slope S", "background": "", "description": "Bessie is going on a ski trip with her friends. The mountain has $N$ waypoints ($1\\leq N \\leq 10^5$) labeled $1, 2, \\ldots, N$ in increasing order of altitude (waypoint $1$ is the bottom of the mountain). \n\nFor each waypoint $i \\gt 1$, there is a ski run starting from waypoint $i$ and ending at waypoint $p_i$ ($1\\le p_i\\lt i$).  This run has difficulty $d_i$ ($0 \\leq d_i \\leq 10^9$) and enjoyment $e_i$ ($0 \\leq e_i \\leq 10^9$).\n\nEach of Bessie's $M$ friends ($1\\leq M \\leq 10^5$) will do the following: They ill pick some initial waypoint $i$ to start at, and then follow the runs downward (to $p_i$, then to $p_{p_i}$, and so forth) until they get to waypoint $1$. \n\nThe enjoyment each friend gets is equal to the sum of the enjoyments of the runs they follow. Each friend also has a different skill level $s_j$ ($0 \\leq s_j \\leq 10^9$)  and courage level $c_j$ ($0 \\leq c_j \\leq 10$), which limits them to selecting an initial waypoint that results in them taking at most $c_j$ runs with difficulty greater than $s_j$.\n\nFor each friend, compute the maximum enjoyment they can get.", "inputFormat": "The first line contains $N$.\n\nThen for each $i$ from $2$ to $N$, a line follows containing three space-separated integers $p_i$, $d_i$, and $e_i$.\n\nThe next line contains $M$.\n\nThe next $M$ lines each contain two space-separated integers $s_j$ and $c_j$.", "outputFormat": "Output $M$ lines, with the answer for each friend on a separate line.\n\n**Note that the large size of integers involved in this problem may require the use of 64-bit integer data types (e.g., a \"long long\" in C/C++).**", "hint": "1. The first friend cannot start any waypoint other than $1$, since any other waypoint would cause them to take at least one run with difficulty greater than $19$. Their total enjoyment is $0$.\n2. The second friend can start at waypoint $4$ and take runs down to waypoint $2$ and then $1$. Their total enjoyment is $100+200=300$. They take one run with difficulty greater than $19$.\n3. The third friend can start at waypoint $3$ and take runs down to waypoint $2$ and then $1$. Their total enjoyment is $300+200=500$. They take two runs with difficulty greater than $19$.\n\n#### SCORING:\n\n- Inputs 2-4: $N, M\\le 1000$\n- Inputs 5-7: All $c_j=0$\n- Inputs 8-17: No additional constraints.", "locale": "en"}, "zh-CN": {"title": "[USACO25OPEN] Ski Slope S", "background": "", "description": "贝茜要和朋友们一起去滑雪。雪山上有 $N$ 个路标（$1 \\leq N \\leq 10^5$），按海拔从低到高依次标记为 $1, 2, \\ldots, N$（路标 $1$ 位于山脚）。\n\n对于每个路标 $i > 1$，有一条从路标 $i$ 出发，终点为路标 $p_i$（$1 \\leq p_i < i$）的滑雪道。这条滑道的难度为 $d_i$（$0 \\leq d_i \\leq 10^9$），乐趣值为 $e_i$（$0 \\leq e_i \\leq 10^9$）。\n\n贝茜的 $M$ 个朋友（$1 \\leq M \\leq 10^5$）每人会进行如下操作：选择一个起始路标 $i$，然后沿着滑道向下滑行（依次经过 $p_i,p_{p_i}$，依此类推），直到抵达路标 $1$。\n\n每位朋友获得的乐趣值等于他们经过的所有滑道的乐趣值之和。每个朋友有不同的技能水平 $s_j$（$0 \\leq s_j \\leq 10^9$）和勇气值 $c_j$（$0 \\leq c_j \\leq 10$），这限制他们选择的起始路标必须满足：滑行过程中最多有 $c_j$ 条滑道的难度超过 $s_j$。\n\n请为每位朋友计算他们能获得的最大乐趣值。\n", "inputFormat": "第一行包含 $N$。\n\n接下来 $2$ 到 $N$ 行，每行包含三个整数 $p_i$，$d_i$ 和 $e_i$。\n\n随后一行包含 $M$。\n\n接下来 $M$ 行，每行包含两个整数 $s_j$ 和 $c_j$。\n", "outputFormat": "输出 $M$ 行，每行对应一个朋友的答案。\n\n注意：由于涉及大整数运算，可能需要使用 64 位整数类型（如 C/C++ 中的 `long long`）。\n", "hint": "第一位朋友只能选择路标 $1$ 作为起点，因为其他路标都会导致至少经过一条难度超过 $19$ 的滑道。总乐趣值为 $0$。\n\n第二位朋友可以选择路标 $4$，依次滑行至路标 $2$ 和 $1$。总乐趣值为 $100 + 200 = 300$，其中有一条滑道难度超过 $19$。\n\n第三位朋友可以选择路标 $3$，依次滑行至路标 $2$ 和 $1$。总乐趣值为 $300 + 200 = 500$，其中有两条滑道难度超过 $19$。\n\n- 测试点 $2\\sim4$：$N, M \\leq 1000$。\n- 测试点 $5\\sim7$：所有 $c_j = 0$。\n- 测试点 $8\\sim17$：无额外限制。", "locale": "zh-CN"}}}
{"pid": "P12028", "type": "P", "difficulty": 4, "samples": [["2 6 1\nMOOMOO", "1"], ["2 6 1\nMMOOOO", "6"], ["1 4 2\nMMOO", "4"], ["1 4 100\nMMOO", "976371285"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["字符串", "数学", "USACO", "2025", "组合数学", "逆元"], "title": "[USACO25OPEN] Moo Decomposition G", "background": "", "description": "给定一个由 $\\texttt{M}$ 和 $\\texttt{O}$ 组成的长字符串 $S$ 和一个整数 $K \\geq 1$。计算将 $S$ 分解为若干子序列的方式数，其中每个子序列形如 $\\texttt{MOOO...O}$（恰好包含 $K$ 个 $\\texttt{O}$），结果对 $10^9+7$ 取模。\n\n由于字符串非常长，我们不直接给出 $S$。而是给定一个整数 $L$（$1 \\leq L \\leq 10^{18}$）和一个长度为 $N$ 的字符串 $T$（$1 \\leq K\\leq N \\leq 10^6$）。字符串 $S$ 是 $T$ 重复 $L$ 次拼接而成。\n", "inputFormat": "第一行包含 $K$、$N$ 和 $L$。\n\n第二行包含长度为 $N$ 的字符串 $T$，每个字符是 $\\texttt{M}$ 或 $\\texttt{O}$。\n\n保证 $S$ 的分解方式数不为零。", "outputFormat": "输出字符串 $S$ 的分解方式数，对 $10^9+7$ 取模。", "hint": "样例一解释：唯一分解方式是将前三个字符组成一个 $\\texttt{MOO}$，后三个字符组成另一个 $\\texttt{MOO}$。\n\n样例二解释：共有六种不同的分解方式（大写字母组成一个 $\\texttt{MOO}$，小写字母组成另一个 $\\texttt{MOO}$）：\n1. $\\texttt{MmOOoo}$\n2. $\\texttt{MmOoOo}$\n3. $\\texttt{MmOooO}$\n4. $\\texttt{MmoOOo}$\n5. $\\texttt{MmoOoO}$\n6. $\\texttt{MmooOO}$\n\n样例四解释：注意：结果需对 $10^9+7$ 取模。\n\n- 测试点 $5\\sim7$：$K=1$，$L=1$。\n- 测试点 $8\\sim10$：$K=2$，$N \\leq 1000$，$L=1$。\n- 测试点 $11\\sim13$：$K=1$。\n- 测试点 $14\\sim19$：$L=1$。\n- 测试点 $20\\sim25$：无额外限制。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO25OPEN] Moo Decomposition G", "background": null, "description": "You have a long string $S$ of Ms and Os and an integer $K \\geq 1$. Count the number of ways of ways to decompose $S$ into subsequences such that each subsequence is MOOOO....O with exactly $K$ Os, modulo $10^9+7$.\n\nSince the string is very long, you are not given it explicitly. Instead, you are given an integer $L$ ($1 \\leq L \\leq 10^{18}$), and a string $T$ of length $N$ ($1 \\leq N \\leq 10^6$). The string $S$ is the concatenation of $L$ copies of the string $T$.", "inputFormat": "The first line contains $K$, $N$, and $L$.\n\nThe second line contains the string $T$ of length $N$. Every character is either an M or an O.\n\nIt is guaranteed that the number of decompositions of $S$ is nonzero.", "outputFormat": "Output the number of decompositions of string $S$, modulo $10^9+7$.", "hint": "##### For Sample 1:\nThe only way to decompose $S$ into MOOs is to let the first three characters form a MOO and the last three characters form another MOO.\n\n##### For Sample 2:\nThere are six distinct ways to decompose the string into subsequences (uppercase letters form one MOO, lowercase letters form another):\n- MmOOoo\n- MmOoOo\n- MmOooO\n- MmoOOo\n- MmoOoO\n- MmooOO\n\n##### For Sample 4:\nMake sure to take the answer modulo $10^9+7$.\n\n#### SCORING:\n\n- Inputs 5-7: $K=1$, $L = 1$\n- Inputs 8-10: $K=2$, $N\\leq 1000$, $L = 1$\n- Inputs 11-13: $K=1$\n- Inputs 14-19: $L = 1$\n- Inputs 20-25: No additional constraints.", "locale": "en"}, "zh-CN": {"title": "[USACO25OPEN] Moo Decomposition G", "background": "", "description": "给定一个由 $\\texttt{M}$ 和 $\\texttt{O}$ 组成的长字符串 $S$ 和一个整数 $K \\geq 1$。计算将 $S$ 分解为若干子序列的方式数，其中每个子序列形如 $\\texttt{MOOO...O}$（恰好包含 $K$ 个 $\\texttt{O}$），结果对 $10^9+7$ 取模。\n\n由于字符串非常长，我们不直接给出 $S$。而是给定一个整数 $L$（$1 \\leq L \\leq 10^{18}$）和一个长度为 $N$ 的字符串 $T$（$1 \\leq K\\leq N \\leq 10^6$）。字符串 $S$ 是 $T$ 重复 $L$ 次拼接而成。\n", "inputFormat": "第一行包含 $K$、$N$ 和 $L$。\n\n第二行包含长度为 $N$ 的字符串 $T$，每个字符是 $\\texttt{M}$ 或 $\\texttt{O}$。\n\n保证 $S$ 的分解方式数不为零。", "outputFormat": "输出字符串 $S$ 的分解方式数，对 $10^9+7$ 取模。", "hint": "样例一解释：唯一分解方式是将前三个字符组成一个 $\\texttt{MOO}$，后三个字符组成另一个 $\\texttt{MOO}$。\n\n样例二解释：共有六种不同的分解方式（大写字母组成一个 $\\texttt{MOO}$，小写字母组成另一个 $\\texttt{MOO}$）：\n1. $\\texttt{MmOOoo}$\n2. $\\texttt{MmOoOo}$\n3. $\\texttt{MmOooO}$\n4. $\\texttt{MmoOOo}$\n5. $\\texttt{MmoOoO}$\n6. $\\texttt{MmooOO}$\n\n样例四解释：注意：结果需对 $10^9+7$ 取模。\n\n- 测试点 $5\\sim7$：$K=1$，$L=1$。\n- 测试点 $8\\sim10$：$K=2$，$N \\leq 1000$，$L=1$。\n- 测试点 $11\\sim13$：$K=1$。\n- 测试点 $14\\sim19$：$L=1$。\n- 测试点 $20\\sim25$：无额外限制。", "locale": "zh-CN"}}}
{"pid": "P12029", "type": "P", "difficulty": 5, "samples": [["5 3\n1 2 3 4 5\n3 4\n1 2\n5 2", "4\n3\n2"], ["8 5\n8 1 4 2 5 4 2 3\n7 4\n8 4\n4 1\n5 8\n8 4", "4\n4\n4\n7\n7"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["模拟", "USACO", "2025", "双指针 two-pointer"], "title": "[USACO25OPEN] Election Queries G", "background": null, "description": "**注意：本题时间限制为 3 秒，是默认时间的 1.5 倍。**\n\n农夫约翰有 $N$ 头（$2 \\leq N \\leq 2 \\cdot 10^5$）编号从 $1$ 到 $N$ 的奶牛。农场正在举行选举，将选出两头新的领头牛。初始时，已知第 $i$ 头奶牛会投票给第 $a_i$ 头奶牛（$1 \\leq a_i \\leq N$）。\n\n选举过程如下：\n1. 农夫约翰任意选择一个非空真子集 $S$（即至少包含一头牛但不包含所有牛）。\n2. 让集合 $S$ 中的奶牛进行投票，将得票数最多的奶牛选为第一头领头牛 $x$（如果出现平票，可以在得票最多的奶牛中任意选择一个）。\n3. 让其余奶牛进行投票，用同样的方式选出第二头领头牛 $y$。\n4. 定义两头领头牛的差异度为 $|x - y|$。若无法选出两头不同的领头牛，则差异度为 $0$。\n\n由于奶牛们经常改变主意，农夫约翰需要进行 $Q$ 次（$1 \\leq Q \\leq 10^5$）查询。每次查询会修改一头奶牛的投票对象，你需要回答当前状态下可能获得的最大差异度。", "inputFormat": "第一行包含 $N$ 和 $Q$。\n\n第二行包含初始投票数组 $a_1, a_2, \\ldots, a_N$。\n\n接下来 $Q$ 行，每行两个整数 $i$ 和 $x$，表示将 $a_i$ 修改为 $x$。（$1 \\le i, x \\le N$）", "outputFormat": "输出 $Q$ 行，第 $i$ 行表示前 $i$ 次查询后的最大可能差异度。", "hint": "#### 样例一解释：\n\n第一次查询后，$a = [1,2,4,4,5]$。选择 $S = \\{1,3\\}$ 时：\n\n- $S$ 中：牛 $1$ 得 $1$ 票，牛 $4$ 得 $1$ 票 $\\to$ 可选择牛 $1$ 或牛 $4$ 作为第一头领头牛。\n- 剩余牛中：牛 $2,4,5$ 各得 $1$ 票 $\\to$ 可选择牛 $2,4,5$ 作为第二头领头牛。\n\n最大差异度为 $|1-5| = 4$。\n\n第二次查询后，$a = [2,2,4,4,5]$。选择 $S = \\{4,5\\}$ 时：\n\n- $S$ 中：牛 $4$ 得 $1$ 票，牛 $5$ 得 $1$ 票。\n- 剩余牛中：牛 $2$ 得 $2$ 票。\n\n最大差异度为 $|5-2| = 3$。\n\n\n#### 测试点性质：\n- 测试点 $3\\sim4$：$N,Q \\leq 100$。\n- 测试点 $5\\sim7$：$N,Q \\leq 3000$。\n- 测试点 $8\\sim15$：无额外限制。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO25OPEN] Election Queries G", "background": null, "description": "**Note: The time limit for this problem is 3s, 1.5x the default.**\n\nFarmer John has $N$ ($2 \\leq N \\leq 2 \\cdot 10^5$) cows numbered from $1$ to $N$. An election is being held in FJ's farm to determine the two new head cows in his farm. Initially, it is known that cow $i$ will vote for cow $a_i$ ($1 \\leq a_i \\leq N$).\n\nTo determine the two head cows, FJ will hold his election in the following process:\n- Choose an arbitrary subset $S$ of his cows that contains at least one cow but not all cows. FJ is able to choose cow $x$ as the first head cow if its votes appear most frequently among all votes cast by cows in $S$.\n- FJ is able to choose cow $y$ as the second head cow if its votes appear most frequently among votes cast by cows not in $S$.\n- For a fixed subset $S$, FJ denotes the **diversity** between his head cows as $|x - y|$. As FJ does not like having leaders with similar numbers, he  wants to choose $S$ such that the **diversity** is maximized. Note that if FJ is not able to choose two distinct head cows, then the diversity is $0$.\n\nHowever, some cows keep changing their minds, and FJ may have to rerun the election many times! Therefore, he asks you $Q$ ($1 \\leq Q \\leq 10^5$) queries. In each query, a cow changes their vote. After each query, he asks you for the maximum possible **diversity** among his new head cows.", "inputFormat": "The first line contains $N$ and $Q$.\n\nThe following line contains $a_1, a_2, \\ldots, a_N$.\n\nThe following $Q$ lines contain two integers $i$ and $x$, representing the update $a_i = x$ ($1 \\leq i, x \\leq N$).", "outputFormat": "Output $Q$ lines, the $i$'th of which is the maximum possible **diversity** after the first $i$ queries.", "hint": "##### For Sample 1:\nAfter the first query, $a = [1, 2, 4, 4, 5]$. At the first step of the election, FJ can make $S = \\{1, 3\\}$. Here, cow $1$ receives one vote and cow $4$ receives one vote.  Therefore, FJ can choose either cow $1$ or cow $4$ as its first head cow. \n\nFor all cows not in the election, cow $2$ receives one vote, cow $4$ receives one vote, and cow $5$ also receives one vote. Therefore, FJ can choose any one of cows $2$, $4$, or $5$ to be its second head cow. \n\nTo obtain the maximum diversity, FJ can choose cow $1$ as the first head cow and cow $5$ as the second head cow. Therefore, the diversity is $|1-5| = 4$.\n\nAfter the second query, $a=[2,2,4,4,5]$ and FJ can make $S = \\{4, 5\\}$. Then, he can choose $5$ as the first head cow and cow $2$ as the second head cow. The maximum possible diversity is $|5 - 2| = 3$.\n\n#### SCORING:\n\n- Inputs 3-4: $N, Q \\leq 100$\n- Inputs 5-7: $N, Q \\leq 3000$\n- Inputs 8-15:  No additional constraints.", "locale": "en"}, "zh-CN": {"title": "[USACO25OPEN] Election Queries G", "background": null, "description": "**注意：本题时间限制为 3 秒，是默认时间的 1.5 倍。**\n\n农夫约翰有 $N$ 头（$2 \\leq N \\leq 2 \\cdot 10^5$）编号从 $1$ 到 $N$ 的奶牛。农场正在举行选举，将选出两头新的领头牛。初始时，已知第 $i$ 头奶牛会投票给第 $a_i$ 头奶牛（$1 \\leq a_i \\leq N$）。\n\n选举过程如下：\n1. 农夫约翰任意选择一个非空真子集 $S$（即至少包含一头牛但不包含所有牛）。\n2. 让集合 $S$ 中的奶牛进行投票，将得票数最多的奶牛选为第一头领头牛 $x$（如果出现平票，可以在得票最多的奶牛中任意选择一个）。\n3. 让其余奶牛进行投票，用同样的方式选出第二头领头牛 $y$。\n4. 定义两头领头牛的差异度为 $|x - y|$。若无法选出两头不同的领头牛，则差异度为 $0$。\n\n由于奶牛们经常改变主意，农夫约翰需要进行 $Q$ 次（$1 \\leq Q \\leq 10^5$）查询。每次查询会修改一头奶牛的投票对象，你需要回答当前状态下可能获得的最大差异度。", "inputFormat": "第一行包含 $N$ 和 $Q$。\n\n第二行包含初始投票数组 $a_1, a_2, \\ldots, a_N$。\n\n接下来 $Q$ 行，每行两个整数 $i$ 和 $x$，表示将 $a_i$ 修改为 $x$。（$1 \\le i, x \\le N$）", "outputFormat": "输出 $Q$ 行，第 $i$ 行表示前 $i$ 次查询后的最大可能差异度。", "hint": "#### 样例一解释：\n\n第一次查询后，$a = [1,2,4,4,5]$。选择 $S = \\{1,3\\}$ 时：\n\n- $S$ 中：牛 $1$ 得 $1$ 票，牛 $4$ 得 $1$ 票 $\\to$ 可选择牛 $1$ 或牛 $4$ 作为第一头领头牛。\n- 剩余牛中：牛 $2,4,5$ 各得 $1$ 票 $\\to$ 可选择牛 $2,4,5$ 作为第二头领头牛。\n\n最大差异度为 $|1-5| = 4$。\n\n第二次查询后，$a = [2,2,4,4,5]$。选择 $S = \\{4,5\\}$ 时：\n\n- $S$ 中：牛 $4$ 得 $1$ 票，牛 $5$ 得 $1$ 票。\n- 剩余牛中：牛 $2$ 得 $2$ 票。\n\n最大差异度为 $|5-2| = 3$。\n\n\n#### 测试点性质：\n- 测试点 $3\\sim4$：$N,Q \\leq 100$。\n- 测试点 $5\\sim7$：$N,Q \\leq 3000$。\n- 测试点 $8\\sim15$：无额外限制。", "locale": "zh-CN"}}}
{"pid": "P12030", "type": "P", "difficulty": 6, "samples": [["5 4\n4 2\n4 10 8 10 10", "546"], ["10 5\n5 1\n1 2 3 4 5 6 7 8 9 10", "777\n"], ["5 1000000000\n3 1\n0 1 2 3 4", "10"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["二分", "USACO", "2025"], "title": "[USACO25OPEN] OohMoo Milk G", "background": "", "description": "农夫约翰正在生产他世界闻名的 OohMoo 牛奶以获取利润。他有 $N$ 个（$1 \\leq N \\leq 10^5$）瓶子需要装牛奶，每个瓶子初始含有 $m_i$（$0 \\leq m_i \\leq 10^9$）单位的牛奶。每天，他会选择 $A$ 个（$1 \\leq A \\leq N$）瓶子，每个被选中的瓶子增加 $1$ 单位牛奶。\n\n不幸的是，他的竞争对手农夫 Nhoj 知道这个生产过程并计划破坏。每天在农夫约翰添加牛奶后，农夫 Nhoj 会偷偷从 $B$ 个（$0 \\leq B < A$）不同的非空瓶子中各偷走 $1$ 单位牛奶。为了不被发现，农夫 Nhoj 确保 $B$ 严格小于 $A$。\n\n经过 $D$ 天（$1 \\leq D \\leq 10^9$）后，农夫约翰将出售他的牛奶。如果一个瓶子含有 $M$ 单位牛奶，它将卖出 $M^2$ moonies 的价钱。\n\n设 $P$ 为唯一确定的利润值，使得无论农夫 Nhoj 如何操作，农夫约翰都能保证至少获得 $P$ 利润；同时无论农夫约翰如何操作，农夫 Nhoj 都能确保农夫约翰最多获得 $P$ 利润。请输出 $P$ 对 $10^9+7$ 取模的结果。\n", "inputFormat": "第一行包含 $N$ 和 $D$，分别表示瓶子数量和天数。\n\n第二行包含 $A$ 和 $B$，表示农夫约翰每天添加的牛奶瓶数和农夫 Nhoj 每天偷取的瓶数。\n\n第三行包含 $N$ 个整数 $m_i$，表示每个瓶子的初始牛奶量。\n", "outputFormat": "输出 $P$ 对 $10^9+7$ 取模的结果。", "hint": "样例一解释：经过 $4$ 天后，可能的牛奶量为 $[4,11,11,12,12]$，总利润为 $4^2+11^2+11^2+12^2+12^2=546$。\n\n- 测试点 $4\\sim6$：$N,D \\leq 1000$。\n- 测试点 $7\\sim10$：$D \\leq 10^6$。\n- 测试点 $11\\sim20$：无额外限制。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO25OPEN] OohMoo Milk G", "background": null, "description": "Farmer John is trying to make his world's famous OohMoo Milk to sell for a profit. He has $N$ $(1 \\leq N \\leq 10^5)$ bottles that he is trying to fill. Each bottle initially contains some amount of milk $m_i$ $(0 \\leq m_i \\leq 10^9)$. Every day, he takes $A$ $(1 \\le A \\le N)$ bottles and fills each bottle with one unit of milk. \n\nUnfortunately, Farmer Nhoj, Farmer John's competitor in the business of OohMoo Milk,  knows about Farmer John's production processes and has a plan to curtail his business.  Every day, after Farmer John fills his $A$ bottles, Farmer Nhoj will sneakily steal one unit of milk from each of $B$ $(0 \\le B \\lt A)$ different nonempty bottles. To remain sneaky, Farmer Nhoj chooses $B$ so that it is strictly less than $A$, so that it is less likely for Farmer John to discover him.\n\nAfter $D$ ($1 \\leq D \\leq 10^9$) days, Farmer John will sell his OohMoo Milk. If a bottle has $M$ units of milk, it will sell for $M^2$ moonies. \n\nLet $P$ be the unique profit such that FJ can guarantee that he makes at least $P$ profit  regardless of how FN behaves, and FN can guarantee that FJ makes at most $P$ profit regardless of how  FJ behaves. Output the value of $P$ modulo $10^9+7$.", "inputFormat": "The first line of the input contains $N$ and $D$, where $N$ is the number of bottles and $D$ is the number of days that take place.\n\nThe second line of the input contains $A$ and $B$ representing the number of units of milk that Farmer John fills and Farmer Nhoj steals respectively.\n\nThe third line of the input contains $N$ space-separated integers $m_i$ representing the initial amount of milk in each bottle.", "outputFormat": "Output the value of $P$ modulo $10^9+7$.", "hint": "##### For Sample 1:\nOn the first day, Farmer John could add milk to the second, third, fourth, and fifth bottles. Then, Farmer Nhoj could remove milk from the second and fourth bottles. \n\nThus, the new amount of milk in each bottle is\n$$[4, 10, 8, 10, 10] \\to [4, 11, 9, 11, 11] \\to [4, 10, 9, 10, 11].$$\n\nAfter four days, the amount of milk in each bottle could be\n$$[4, 10, 8, 10, 10] \\to [4, 10, 9, 10, 11] \\to [4, 10, 10, 11, 11] \\to [4, 11, 11, 11, 11] \\to [4, 11, 11, 12, 12].$$\n\nThe total amount of moonies Farmer John would make in this situation is $4^2+11^2+11^2+12^2+12^2 = 546$. It can be shown that this is the value of $P$.\n\n##### For Sample 2:\nMake sure you output $P$ modulo $10^9+7$.\n\n#### SCORING:\n\n- Inputs 4-6: $N,D\\le 1000$. \n- Inputs 7-10: $D\\le 10^6$. \n- Inputs 11-20: No additional constraints.", "locale": "en"}, "zh-CN": {"title": "[USACO25OPEN] OohMoo Milk G", "background": "", "description": "农夫约翰正在生产他世界闻名的 OohMoo 牛奶以获取利润。他有 $N$ 个（$1 \\leq N \\leq 10^5$）瓶子需要装牛奶，每个瓶子初始含有 $m_i$（$0 \\leq m_i \\leq 10^9$）单位的牛奶。每天，他会选择 $A$ 个（$1 \\leq A \\leq N$）瓶子，每个被选中的瓶子增加 $1$ 单位牛奶。\n\n不幸的是，他的竞争对手农夫 Nhoj 知道这个生产过程并计划破坏。每天在农夫约翰添加牛奶后，农夫 Nhoj 会偷偷从 $B$ 个（$0 \\leq B < A$）不同的非空瓶子中各偷走 $1$ 单位牛奶。为了不被发现，农夫 Nhoj 确保 $B$ 严格小于 $A$。\n\n经过 $D$ 天（$1 \\leq D \\leq 10^9$）后，农夫约翰将出售他的牛奶。如果一个瓶子含有 $M$ 单位牛奶，它将卖出 $M^2$ moonies 的价钱。\n\n设 $P$ 为唯一确定的利润值，使得无论农夫 Nhoj 如何操作，农夫约翰都能保证至少获得 $P$ 利润；同时无论农夫约翰如何操作，农夫 Nhoj 都能确保农夫约翰最多获得 $P$ 利润。请输出 $P$ 对 $10^9+7$ 取模的结果。\n", "inputFormat": "第一行包含 $N$ 和 $D$，分别表示瓶子数量和天数。\n\n第二行包含 $A$ 和 $B$，表示农夫约翰每天添加的牛奶瓶数和农夫 Nhoj 每天偷取的瓶数。\n\n第三行包含 $N$ 个整数 $m_i$，表示每个瓶子的初始牛奶量。\n", "outputFormat": "输出 $P$ 对 $10^9+7$ 取模的结果。", "hint": "样例一解释：经过 $4$ 天后，可能的牛奶量为 $[4,11,11,12,12]$，总利润为 $4^2+11^2+11^2+12^2+12^2=546$。\n\n- 测试点 $4\\sim6$：$N,D \\leq 1000$。\n- 测试点 $7\\sim10$：$D \\leq 10^6$。\n- 测试点 $11\\sim20$：无额外限制。", "locale": "zh-CN"}}}
{"pid": "P12031", "type": "P", "difficulty": 5, "samples": [["2 1\n4\n1 6 2 8\n6 2 7 3\n3 1 4 7\n5 4 8 5\n3\n1 5 3 6\n4 1 5 2\n2 3 6 4", "1 3 2 4\n2 3 1"], ["2 2\n4\n1 6 2 8\n6 2 7 3\n3 1 4 7\n5 4 8 5\n3\n1 5 3 6\n4 1 5 2\n2 3 6 4", "1011\n011"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["线段树", "USACO", "2025", "Special Judge", "图论建模", "拓扑排序", "可持久化线段树", "扫描线"], "title": "[USACO25OPEN] Forklift Certified P", "background": "checker 提供者：kjhhjki\n", "description": "Farmer John is training to become forklift certified! As part of his training, he needs to clear $N$ ($1 \\le N \\le 10^5$) boxes, conveniently labeled 1 through $N$, from an old warehouse.\n\nThe boxes can be modeled as axis-aligned rectangles in a 2-dimensional plane, where the $+x$-direction is east and the $+y$-direction is north. Box $i$ has its southwest corner at $(x_{i1}, y_{i1})$ and its northeast corner at $(x_{i2}, y_{i2})$. All coordinates are integers in the range $[1, 2N]$, and no two corners from two different rectangles share the same $x$ or $y$ coordinate. All boxes have a non-zero area, and no two boxes intersect.\n\nFarmer John plans to remove the boxes one at a time out of the southwest entrance of the warehouse. However, he can only remove a box if no part of any other box lies both south and west of the box's northeast corner due to physical limitations of the forklift.\n\nAn example with $N = 4$ is shown below. To remove box 4, there cannot be any other boxes in the shaded region. Boxes 2 and 3 prevent box 4 from being removed, but box 1 does not.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jte8z0w6.png)\n\nHelp Farmer John decide how to remove all the boxes! Your code should operate in two separate modes, defined by an integer flag $M$:\n\n*   **Mode 1** ($M = 1$): Generate a permutation of $1, \\dots, N$ specifying a valid box removal order. If there are multiple valid orders, find any. It can be proven that such an order always exists.\n*   **Mode 2** ($M = 2$): For each $k = 1, \\dots, N$, output 1 if Farmer John can remove box $k$ if boxes $1, \\dots, k-1$ have already been removed, and 0 otherwise.", "inputFormat": "Each input consists of $T$ ($1 \\le T \\le 10$) independent test cases. It is guaranteed that the sum of all $N$ within each input does not exceed $5 \\cdot 10^5$.\n\nThe first line of input contains $T$ and $M$. (Note that $M$ is the same for each test case.) Each test case is then formatted as follows:\n\n*   The first line contains a single integer $N$.\n*   Each of the next $N$ lines contains four space-separated integers $x_{i1}, y_{i1}, x_{i2}, y_{i2}$: the locations of the southwest and northeast corners of box $i$.", "outputFormat": "For each test case:\n\n*   If $M = 1$, output a single line with $N$ space-separated integers, where the $j$-th integer is the label of the $j$-th box to remove.\n*   If $M = 2$, output a single line with a binary string of $N$ characters specifying the answer for each $k = 1, \\dots, N$.", "hint": "### Sample 1 Explanation\n\nThe first test case corresponds to the $N = 4$ example above. Box 1 is not blocked by anything, box 3 is blocked by box 1, box 2 is blocked by box 3, and box 4 is blocked by boxes 2 and 3.\n\n### Sample 2 Explanation\n\nFor the first test case, box 2 is blocked by box 3, so Farmer John cannot remove it before removing box 3.\n\n### Scoring\n\n- Inputs 3-5: $M=1$, $N≤1000$.\n- Input 6: $M=2$, $N≤1000$.\n- Inputs 7-13: $M=1$, no additional constraints.\n- Inputs 14-16: $M=2$, no additional constraints.", "locale": "en", "translations": {"en": {"title": "[USACO25OPEN] Forklift Certified P", "background": "checker 提供者：kjhhjki\n", "description": "Farmer John is training to become forklift certified! As part of his training, he needs to clear $N$ ($1 \\le N \\le 10^5$) boxes, conveniently labeled 1 through $N$, from an old warehouse.\n\nThe boxes can be modeled as axis-aligned rectangles in a 2-dimensional plane, where the $+x$-direction is east and the $+y$-direction is north. Box $i$ has its southwest corner at $(x_{i1}, y_{i1})$ and its northeast corner at $(x_{i2}, y_{i2})$. All coordinates are integers in the range $[1, 2N]$, and no two corners from two different rectangles share the same $x$ or $y$ coordinate. All boxes have a non-zero area, and no two boxes intersect.\n\nFarmer John plans to remove the boxes one at a time out of the southwest entrance of the warehouse. However, he can only remove a box if no part of any other box lies both south and west of the box's northeast corner due to physical limitations of the forklift.\n\nAn example with $N = 4$ is shown below. To remove box 4, there cannot be any other boxes in the shaded region. Boxes 2 and 3 prevent box 4 from being removed, but box 1 does not.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jte8z0w6.png)\n\nHelp Farmer John decide how to remove all the boxes! Your code should operate in two separate modes, defined by an integer flag $M$:\n\n*   **Mode 1** ($M = 1$): Generate a permutation of $1, \\dots, N$ specifying a valid box removal order. If there are multiple valid orders, find any. It can be proven that such an order always exists.\n*   **Mode 2** ($M = 2$): For each $k = 1, \\dots, N$, output 1 if Farmer John can remove box $k$ if boxes $1, \\dots, k-1$ have already been removed, and 0 otherwise.", "inputFormat": "Each input consists of $T$ ($1 \\le T \\le 10$) independent test cases. It is guaranteed that the sum of all $N$ within each input does not exceed $5 \\cdot 10^5$.\n\nThe first line of input contains $T$ and $M$. (Note that $M$ is the same for each test case.) Each test case is then formatted as follows:\n\n*   The first line contains a single integer $N$.\n*   Each of the next $N$ lines contains four space-separated integers $x_{i1}, y_{i1}, x_{i2}, y_{i2}$: the locations of the southwest and northeast corners of box $i$.", "outputFormat": "For each test case:\n\n*   If $M = 1$, output a single line with $N$ space-separated integers, where the $j$-th integer is the label of the $j$-th box to remove.\n*   If $M = 2$, output a single line with a binary string of $N$ characters specifying the answer for each $k = 1, \\dots, N$.", "hint": "### Sample 1 Explanation\n\nThe first test case corresponds to the $N = 4$ example above. Box 1 is not blocked by anything, box 3 is blocked by box 1, box 2 is blocked by box 3, and box 4 is blocked by boxes 2 and 3.\n\n### Sample 2 Explanation\n\nFor the first test case, box 2 is blocked by box 3, so Farmer John cannot remove it before removing box 3.\n\n### Scoring\n\n- Inputs 3-5: $M=1$, $N≤1000$.\n- Input 6: $M=2$, $N≤1000$.\n- Inputs 7-13: $M=1$, no additional constraints.\n- Inputs 14-16: $M=2$, no additional constraints.", "locale": "en"}, "zh-CN": {"title": "[USACO25OPEN] Forklift Certified P", "background": "**本翻译使用 AI 生成。**\n\nchecker 提供者：kjhhjki\n", "description": "农夫约翰（Farmer John）正在接受培训，以获得叉车认证！作为培训的一部分，他需要从一个旧仓库中清理 $N$（$1 \\le N \\le 10^5$）个箱子，这些箱子被方便地标记为 $1$ 到 $N$。\n\n这些箱子可以被建模为二维平面上的轴对齐矩形，其中 $+x$ 方向是东，$+y$ 方向是北。箱子 $i$ 的西南角坐标为 $(x_{i1}, y_{i1})$，东北角坐标为 $(x_{i2}, y_{i2})$。所有坐标都是范围 $[1, 2N]$ 内的整数，并且来自不同矩形的任意两个角都不会共享相同的 $x$ 或 $y$ 坐标。所有箱子都有非零面积，且没有两个箱子相交。\n\n农夫约翰计划每次从仓库的西南入口处移除一个箱子。然而，由于叉车的物理限制，他只有在没有其他箱子的任何部分位于该箱子东北角的南方和西方时，才能移除该箱子。\n\n下面显示了一个 $N = 4$ 的示例。要移除箱子 4，阴影区域内不能有任何其他箱子。箱子 2 和 3 阻止了箱子 4 被移除，但箱子 1 不会。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jte8z0w6.png)\n\n帮助农夫约翰决定如何移除所有箱子！您的代码应根据整数标志 $M$ 在两种不同的模式下运行：\n\n*   **模式 1**（$M = 1$）：生成一个 $1, \\dots, N$ 的排列，指定一个有效的箱子移除顺序。如果存在多个有效的顺序，则输出任意一个。可以证明这样的顺序总是存在的。\n*   **模式 2**（$M = 2$）：对于每个 $k = 1, \\dots, N$，如果农夫约翰可以在箱子 $1, \\dots, k-1$ 都已被移除的情况下移除箱子 $k$，则输出 1，否则输出 0。", "inputFormat": "每个输入包含 $T$（$1 \\le T \\le 10$）组独立的测试用例。保证每个输入中所有 $N$ 的总和不超过 $5 \\cdot 10^5$。\n\n输入的第一行包含 $T$ 和 $M$。（请注意，对于每个测试用例，$M$ 都是相同的。）然后，每个测试用例的格式如下：\n\n*   第一行包含一个整数 $N$。\n*   接下来的 $N$ 行中的每一行包含四个空格分隔的整数 $x_{i1}, y_{i1}, x_{i2}, y_{i2}$：箱子 $i$ 的西南角和东北角的位置。", "outputFormat": "对于每个测试用例：\n\n*   如果 $M = 1$，则输出一行 $N$ 个空格分隔的整数，其中第 $j$ 个整数是要移除的第 $j$ 个箱子的标签。\n*   如果 $M = 2$，则输出一行包含 $N$ 个字符的二进制字符串，指定对于每个 $k = 1, \\dots, N$ 的答案。", "hint": "### 样例 1 解释\n\n第一个测试用例对应于上面 $N = 4$ 的示例。箱子 1 没有被任何东西阻挡，箱子 3 被箱子 1 阻挡，箱子 2 被箱子 3 阻挡，而箱子 4 被箱子 2 和 3 阻挡。\n\n### 样例 2 解释\n\n第一个测试用例，箱子 2 被箱子 3 阻挡，所以农夫约翰在移除箱子 3 之前无法移除箱子 2。\n\n### 测试点限制\n\n- 测试点 3-5: $M=1$，$N\\leq 1000$。\n- 测试点 6: $M=2$，$N\\leq 1000$。\n- 测试点 7-13: $M=1$，无额外限制。\n- 测试点 14-16: $M=2$，无额外限制。", "locale": "zh-CN"}}}
{"pid": "P12032", "type": "P", "difficulty": 6, "samples": [["3 2\n1 3\n3 2", "2"], ["6 3\n1 1\n3 3\n6 5", "89"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["USACO", "2025"], "title": "[USACO25OPEN] Lazy Sort P", "background": "", "description": "Farmer John has $N$ cows ($2 \\le N \\le 5 \\cdot 10^6$) and is attempting to get them to sort a non-negative integer array $A$ of length $N$ by relying on their laziness. He has a lot of heavy boxes so he lines the cows up one behind another, where cow $i+1$ is behind cow $i$, and gives $a_i$ boxes to cow $i$ ($0 \\le a_i$).\n\nCows are inherently lazy so they always look to pass their work off to someone else. From cow 1 to $N-1$ in order, each cow looks to the cow behind them. If cow $i$ has strictly more boxes than cow $i+1$, cow $i$ thinks this is \"unfair\" and gives one of its boxes to cow $i+1$. This process repeats until every cow is satisfied.\n\nFarmer John will then note the number of boxes $b_i$ that each cow $i$ is holding and create an array $B$ out of these values. If $B = \\text{sorted}(A)$, then Farmer John will be happy. Unfortunately, Farmer John forgot all but $Q$ values ($2 \\le Q \\le \\min(N, 100)$) in $A$. Luckily, those values include the number of boxes he was going to give to the first and last cow. Each value that FJ remembers is given in the form $c_i\\; v_i$ representing that $a_{c_i} = v_i$ ($1 \\le c_i \\le N$, $1 \\le v_i \\le 10^9$). Determine the number of different ways the missing values can be filled in so that he will be happy mod $10^9 + 7$.", "inputFormat": "The first line contains two space-separated integers $N$ and $Q$ representing the number of cows and queries respectively.\n\nThe next $Q$ lines contain two space separated integers $c_i\\; v_i$ representing that cow $c_i$ initially holds $v_i$ boxes. It is guaranteed that $c_1 = 1$, $c_Q = N$, and $c_i < c_{i+1}$ (the order of the cows is strictly increasing).", "outputFormat": "Print the number of different ways modulo $10^9 + 7$ that values $a_i$ can be assigned such that Farmer John will be happy after the cows perform the lazy sort. It is guaranteed that there will be at least one valid assignment.", "hint": "### Sample 1 Explanation\n\nIn this example, FJ remembers the values at the ends of the array. The arrays $[3, 2, 2]$ and $[3, 3, 2]$ are the valid arrays that will make FJ happy at the end of the lazy sorting.\n\n### SCORING:\n- Inputs 3-4: $N,v_i\\leq 100$\n- Inputs 5-6: $N\\leq 100$ and $v_i\\leq 10^6$\n- Inputs 7-9: $N\\leq 2\\times 10^5$ and $v_i\\leq 10^6$\n- Inputs 10-12: $N\\leq 2\\times 10^5$\n- Inputs 13-15: No additional constraints.", "locale": "en", "translations": {"en": {"title": "[USACO25OPEN] Lazy Sort P", "background": "", "description": "Farmer John has $N$ cows ($2 \\le N \\le 5 \\cdot 10^6$) and is attempting to get them to sort a non-negative integer array $A$ of length $N$ by relying on their laziness. He has a lot of heavy boxes so he lines the cows up one behind another, where cow $i+1$ is behind cow $i$, and gives $a_i$ boxes to cow $i$ ($0 \\le a_i$).\n\nCows are inherently lazy so they always look to pass their work off to someone else. From cow 1 to $N-1$ in order, each cow looks to the cow behind them. If cow $i$ has strictly more boxes than cow $i+1$, cow $i$ thinks this is \"unfair\" and gives one of its boxes to cow $i+1$. This process repeats until every cow is satisfied.\n\nFarmer John will then note the number of boxes $b_i$ that each cow $i$ is holding and create an array $B$ out of these values. If $B = \\text{sorted}(A)$, then Farmer John will be happy. Unfortunately, Farmer John forgot all but $Q$ values ($2 \\le Q \\le \\min(N, 100)$) in $A$. Luckily, those values include the number of boxes he was going to give to the first and last cow. Each value that FJ remembers is given in the form $c_i\\; v_i$ representing that $a_{c_i} = v_i$ ($1 \\le c_i \\le N$, $1 \\le v_i \\le 10^9$). Determine the number of different ways the missing values can be filled in so that he will be happy mod $10^9 + 7$.", "inputFormat": "The first line contains two space-separated integers $N$ and $Q$ representing the number of cows and queries respectively.\n\nThe next $Q$ lines contain two space separated integers $c_i\\; v_i$ representing that cow $c_i$ initially holds $v_i$ boxes. It is guaranteed that $c_1 = 1$, $c_Q = N$, and $c_i < c_{i+1}$ (the order of the cows is strictly increasing).", "outputFormat": "Print the number of different ways modulo $10^9 + 7$ that values $a_i$ can be assigned such that Farmer John will be happy after the cows perform the lazy sort. It is guaranteed that there will be at least one valid assignment.", "hint": "### Sample 1 Explanation\n\nIn this example, FJ remembers the values at the ends of the array. The arrays $[3, 2, 2]$ and $[3, 3, 2]$ are the valid arrays that will make FJ happy at the end of the lazy sorting.\n\n### SCORING:\n- Inputs 3-4: $N,v_i\\leq 100$\n- Inputs 5-6: $N\\leq 100$ and $v_i\\leq 10^6$\n- Inputs 7-9: $N\\leq 2\\times 10^5$ and $v_i\\leq 10^6$\n- Inputs 10-12: $N\\leq 2\\times 10^5$\n- Inputs 13-15: No additional constraints.", "locale": "en"}, "zh-CN": {"title": "[USACO25OPEN] Lazy Sort P", "background": "**本翻译使用 AI 生成。**", "description": "农夫约翰（Farmer John）有 $N$（$2 \\le N \\le 5 \\cdot 10^6$）头奶牛，他试图让它们依靠自身的懒惰性来排序一个长度为 $N$ 的非负整数数组 $A$。他有很多沉重的箱子，所以他把奶牛们排成一列，其中奶牛 $i+1$ 在奶牛 $i$ 的后面，并给奶牛 $i$ 分配 $a_i$（$0 \\le a_i$）个箱子。\n\n奶牛们天生就很懒，所以它们总是想把工作推给别人。从奶牛 $1$ 到 $N-1$，每头奶牛依次看向它后面的奶牛。如果奶牛 $i$ 的箱子严格多于奶牛 $i+1$，奶牛 $i$ 会认为这“不公平”，并把它的一个箱子交给奶牛 $i+1$。这个过程会一直重复，直到每头奶牛都满意为止。\n\n然后，农夫约翰会记下每头奶牛 $i$ 持有的箱子数量 $b_i$，并用这些值创建一个数组 $B$。如果 $B = \\text{sorted}(A)$（即 $A$ 排序后的结果），那么农夫约翰就会很高兴。不幸的是，农夫约翰忘记了 $A$ 中除了 $Q$（$2 \\le Q \\le \\min(N, 100)$）个值之外的所有值。幸运的是，这些记住的值包括了他打算给第一头和最后一头奶牛的箱子数量。FJ 记住的每个值都以 $c_i\\; v_i$ 的形式给出，表示 $a_{c_i} = v_i$（$1 \\le c_i \\le N$，$1 \\le v_i \\le 10^9$）。请确定有多少种不同的方法可以填补缺失的值，使得他在奶牛们完成懒惰排序后会感到高兴，结果对 $10^9 + 7$ 取模。", "inputFormat": "第一行包含两个空格分隔的整数 $N$ 和 $Q$，分别代表奶牛的数量和查询（记住的值）的数量。\n\n接下来的 $Q$ 行，每行包含两个空格分隔的整数 $c_i\\; v_i$，表示奶牛 $c_i$ 最初持有 $v_i$ 个箱子。保证 $c_1 = 1$，$c_Q = N$，并且 $c_i < c_{i+1}$（奶牛的编号是严格递增的）。", "outputFormat": "输出可以分配 $a_i$ 值的方法数量，使得农夫约翰在奶牛执行懒惰排序后感到高兴，结果对 $10^9 + 7$ 取模。保证至少存在一种有效的分配方案。", "hint": "### 样例 1 解释\n\n在这个例子中，FJ 记住了数组两端的值。数组 $[3, 2, 2]$ 和 $[3, 3, 2]$ 是有效的数组，它们会在懒惰排序结束时让 FJ 高兴。\n\n### 测试点限制\n\n- 测试点 3-4: $N,v_i\\leq 100$；\n- 测试点 5-6: $N\\leq 100$ 且 $v_i\\leq 10^6$；\n- 测试点 7-9: $N\\leq 2\\times 10^5$ 且 $v_i\\leq 10^6$；\n- 测试点 10-12: $N\\leq 2\\times 10^5$；\n- 测试点 13-15: 无额外限制。", "locale": "zh-CN"}}}
{"pid": "P12033", "type": "P", "difficulty": 7, "samples": [["100 3 7\n10 10\n20 20\n30 30\n7 7\n11 11\n13 13\n17 17\n24 24\n26 26\n33 33", "22"], ["2 1 1\n1 5\n2 6", "3"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["USACO", "2025"], "title": "[USACO25OPEN] Package Pickup P", "background": "", "description": "**Note: The time limit for this problem is 4s, 2x the default.**\n\nFarmer John has distributed cows and packages in a weird pattern across the number line using the following process:\n\n*   Farmer John chooses a number $M$ ($1 \\le M \\le 10^{18}$).\n*   Farmer John chooses $N$ ($1 \\le N \\le 2 \\cdot 10^4$) intervals $[L_i, R_i]$ to distribute cows in ($1 \\le L_i \\le R_i \\le 10^{18}$). He then places cows at locations $L_i, L_i + M, L_i + 2M, \\dots, R_i$. It is guaranteed that $R_i - L_i$ is a multiple of $M$.\n*   Farmer John chooses $P$ ($1 \\le P \\le 2 \\cdot 10^4$) intervals $[A_j, B_j]$ to distribute packages in ($1 \\le A_j \\le B_j \\le 10^{18}$). He then places packages at locations $A_j, A_j + M, A_j + 2M, \\dots, B_j$. It is guaranteed that $B_j - A_j$ is a multiple of $M$.\n\nOnce the cows and packages are distributed, Farmer John wants to see how long it takes the cows to pick up the packages. Every second, Farmer John can issue a command to a single cow to move one unit left or right of their current position with his handy walkie talkie. If a cow travels to the position where a package is located, they are able to pick it up. Farmer John wants to know the minimum time in seconds that it would take the cows to pick up every package.", "inputFormat": "The first line contains $M$, $N$, and $P$.\n\nThe next $N$ lines each contain two integers $L_i$ and $R_i$.\n\nThe next $P$ lines each contain two integers $A_j$ and $B_j$.", "outputFormat": "Output a single integer, representing the minimum amount of time it can take the cows to pick up all the packages, given that every second, he can issue a single left/right command to a single cow.", "hint": "### Sample 1 Explanation\n\nIn the above test case, suppose the cows and packages are numbered from left to right. Farmer John can follow this procedure to pick up the packages in 22 seconds:\n\n*   Issue 3 lefts to cow 1 so that it picks up package 1\n*   Issue 3 rights to cow 3 so that it picks up package 7\n*   Issue 4 rights to cow 2 so that it picks up package 5\n*   Issue 10 rights to cow 1 so that it picks up packages 2, 3, and 4\n*   Issue 2 rights to cow 2 so that it picks up package 6\n\n### SCORING\n\n*   Input 3-4: It is guaranteed that the total number of cows and packages does not exceed $2 \\cdot 10^5$.\n*   Inputs 5-10: It is guaranteed that $N, P \\le 500$.\n*   Inputs 11-13: It is guaranteed that no intervals of packages or cows intersect.\n*   Inputs 14-20: No additional constraints.", "locale": "en", "translations": {"en": {"title": "[USACO25OPEN] Package Pickup P", "background": "", "description": "**Note: The time limit for this problem is 4s, 2x the default.**\n\nFarmer John has distributed cows and packages in a weird pattern across the number line using the following process:\n\n*   Farmer John chooses a number $M$ ($1 \\le M \\le 10^{18}$).\n*   Farmer John chooses $N$ ($1 \\le N \\le 2 \\cdot 10^4$) intervals $[L_i, R_i]$ to distribute cows in ($1 \\le L_i \\le R_i \\le 10^{18}$). He then places cows at locations $L_i, L_i + M, L_i + 2M, \\dots, R_i$. It is guaranteed that $R_i - L_i$ is a multiple of $M$.\n*   Farmer John chooses $P$ ($1 \\le P \\le 2 \\cdot 10^4$) intervals $[A_j, B_j]$ to distribute packages in ($1 \\le A_j \\le B_j \\le 10^{18}$). He then places packages at locations $A_j, A_j + M, A_j + 2M, \\dots, B_j$. It is guaranteed that $B_j - A_j$ is a multiple of $M$.\n\nOnce the cows and packages are distributed, Farmer John wants to see how long it takes the cows to pick up the packages. Every second, Farmer John can issue a command to a single cow to move one unit left or right of their current position with his handy walkie talkie. If a cow travels to the position where a package is located, they are able to pick it up. Farmer John wants to know the minimum time in seconds that it would take the cows to pick up every package.", "inputFormat": "The first line contains $M$, $N$, and $P$.\n\nThe next $N$ lines each contain two integers $L_i$ and $R_i$.\n\nThe next $P$ lines each contain two integers $A_j$ and $B_j$.", "outputFormat": "Output a single integer, representing the minimum amount of time it can take the cows to pick up all the packages, given that every second, he can issue a single left/right command to a single cow.", "hint": "### Sample 1 Explanation\n\nIn the above test case, suppose the cows and packages are numbered from left to right. Farmer John can follow this procedure to pick up the packages in 22 seconds:\n\n*   Issue 3 lefts to cow 1 so that it picks up package 1\n*   Issue 3 rights to cow 3 so that it picks up package 7\n*   Issue 4 rights to cow 2 so that it picks up package 5\n*   Issue 10 rights to cow 1 so that it picks up packages 2, 3, and 4\n*   Issue 2 rights to cow 2 so that it picks up package 6\n\n### SCORING\n\n*   Input 3-4: It is guaranteed that the total number of cows and packages does not exceed $2 \\cdot 10^5$.\n*   Inputs 5-10: It is guaranteed that $N, P \\le 500$.\n*   Inputs 11-13: It is guaranteed that no intervals of packages or cows intersect.\n*   Inputs 14-20: No additional constraints.", "locale": "en"}, "zh-CN": {"title": "[USACO25OPEN] Package Pickup P", "background": "", "description": "**注意：本题的时间限制为 4 秒，是默认值的 2 倍。**\n\n农夫约翰（Farmer John）按照以下奇怪的方式在数轴上分布了奶牛和包裹：\n\n*   农夫约翰选择一个数字 $M$（$1 \\le M \\le 10^{18}$）。\n*   农夫约翰选择 $N$（$1 \\le N \\le 2 \\cdot 10^4$）个区间 $[L_i, R_i]$ 来分布奶牛（$1 \\le L_i \\le R_i \\le 10^{18}$）。然后他在位置 $L_i, L_i + M, L_i + 2M, \\dots, R_i$ 放置奶牛。保证 $R_i - L_i$ 是 $M$ 的倍数。\n*   农夫约翰选择 $P$（$1 \\le P \\le 2 \\cdot 10^4$）个区间 $[A_j, B_j]$ 来分布包裹（$1 \\le A_j \\le B_j \\le 10^{18}$）。然后他在位置 $A_j, A_j + M, A_j + 2M, \\dots, B_j$ 放置包裹。保证 $B_j - A_j$ 是 $M$ 的倍数。\n\n一旦奶牛和包裹分布完毕，农夫约翰想知道奶牛们捡起所有包裹需要多长时间。每一秒，农夫约翰可以用他方便的对讲机（walkie talkie）向**一头**奶牛发出指令，让其从当前位置向左或向右移动一个单位。如果一头奶牛移动到包裹所在的位置，它就能捡起该包裹。农夫约翰想知道，奶牛们捡起所有包裹所需的最少时间（以秒为单位）。", "inputFormat": "第一行包含 $M$、$N$ 和 $P$。\n\n接下来的 $N$ 行，每行包含两个整数 $L_i$ 和 $R_i$。\n\n再接下来的 $P$ 行，每行包含两个整数 $A_j$ 和 $B_j$。\n", "outputFormat": "输出一个整数，表示奶牛们捡起所有包裹所需的最少时间，前提是每一秒他只能向一头奶牛发出一次向左/向右的指令。\n", "hint": "### 样例 1 解释\n\n在上面的测试用例中，假设奶牛和包裹从左到右编号。农夫约翰可以按照以下步骤在 22 秒内捡起所有包裹：\n\n*   向奶牛 1 发出 3 次向左指令，使其捡起包裹 1。\n*   向奶牛 3 发出 3 次向右指令，使其捡起包裹 7。\n*   向奶牛 2 发出 4 次向右指令，使其捡起包裹 5。\n*   向奶牛 1 发出 10 次向右指令，使其捡起包裹 2、3 和 4。\n*   向奶牛 2 发出 2 次向右指令，使其捡起包裹 6。\n\n### 测试点限制\n\n*   测试点 3-4：保证奶牛和包裹的总数不超过 $2 \\cdot 10^5$。\n*   测试点 5-10：保证 $N, P \\le 500$。\n*   测试点 11-13：保证包裹或奶牛的区间均不相交。\n*   测试点 14-20：无额外限制。", "locale": "zh-CN"}}}
{"pid": "P12034", "type": "P", "difficulty": 2, "samples": [["4 4 4 2\n9 935\n9 1212\n9 1218\n9 1322\n8 868\n8 934\n8 960\n8 1031\n8 1112\n8 1166\n8 1324\n7 605\n7 898\n7 954", "9 1322 8 867\n8 1031 8 1111\n7 605 7 897"], ["1 1 1 1\n3 0\n1 0\n1 1\n0 0", "3 0 2 180558\n1 0 1 0\n1 1 1 180279"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2025", "高校校赛"], "title": "[USTCPC 2025] Introduction to ICPC", "background": "USTCPC 设置 2s 时限为了使得 python 通过。洛谷改为 1s 时限。", "description": "克露丝卡尔酱正在参加 ICPC！这个题目是和 ICPC 基本规则相关的一道题。\n\n以下关于 ICPC 的内容与该题目无关：\n\n1. 一场 ICPC 一般有 $10\\sim 15$ 道题。题目排布顺序与题目难度无关。不过为了提升大家的参赛体验，克露丝卡尔酱温馨地提醒大家，ABCD 是本场比赛的简单题哦～\n\n2. 提交代码的正确性会即时返回给选手，选手也可以看到其他选手提交代码的正确性和即时排名。因此，当你在某一道题卡住时，不妨看看排行榜上其他队伍在做什么题，一般来说**通过**选手数较多的题目会更简单哦~\n\n3. 比赛最后一小时内，选手将不再能够看到其他选手提交代码的正确性，称为**封榜**（可以看到自己提交代码的正确性）。在颁奖过程中，会将排名从低到高逐渐公开是否通过，称为**滚榜**。\n\n-------\n\n以下关于 ICPC 的内容与该题目有关：\n\n1. 在 ICPC 中，提交代码的正确性为即时返回给选手，包括：（不同平台上这些名词会略有不同，以实际为准）\n   \n   + Accepted（正确）\n   \n   + Wrong Answer（答案错误）\n   \n   + Time Exceeded（程序运行时间超出时间限制）\n   \n   + Runtime Error（程序运行时发生错误，可能原因有：数组越界、除以0等）\n   \n   + Memory Exceeded（程序运行内存空间超过了题目限制）\n   \n   + Compile Error（编译错误）\n   \n   如果一位选手在一道题目中获得 Accepted 的结果，则选手在该题获得**通过**。\n\n2. 选手的成绩可以用 $2$ 个参数表示，**通过的题数**和**总罚时**。通过的题数即为选手获得通过题目的数量，而**罚时**的计算参照下表：\n   \n   - 对于未通过的题目，该题目的罚时为 $0$。\n   \n   - 对于通过的题目：该题目基础罚时为在该题获得 Accepted 的结果的时间（从比赛开始的分钟数）；特别地，在 Accepted 结果前，**每一个**非 Accepted 且非 Compile Error 在该题的提交会对于该题增加 $20$ 分钟罚时。\n   \n   - 每道题目的基础罚时的范围为 $[0,300)$，即在第 $300$ 分钟开始后不能够再提交代码。（这里认为存在第 $0$ 分钟）\n   \n   - 一场比赛的总罚时即为所有题目的罚时之和。\n   \n\t定义偏序关系：对于 2 位选手，如果他们通过的题数不相等，则通过的题数更多的选手胜出；若通过的题数相等，则总罚时更小的选手胜出。\n\n特别地，对于该题，规定一位选手只能在一分钟内提交 $30$ 次代码（所有题目共用提交次数）\n\n---\n\n一场一般的 ICPC 可以决出金奖、银奖、铜奖和荣誉奖。按照定义的偏序关系可以获得一个排行榜，而排行榜的前若干名可以获得金奖/银奖/铜奖。每种奖牌存在一种分数线（显然也有 $2$ 个参数）：成绩优于或等于该分数线的获得该种奖牌，而成绩劣于该分数线不能获得该种奖牌。分数线必须是一个可能达成的成绩。\n\n显然，能将不同奖牌区分开的分数线并不唯一。因此，克露丝卡尔酱想知道：对于每种奖牌，奖牌线的**上确界**和**下确界**为多少？", "inputFormat": "输入第一行 $4$ 个正整数 $g,s,b,h$ $(g,s,b,h\\ge 1,g+s+b+h\\le 10^5)$，分别表示金奖、银奖、铜奖和荣誉奖的选手数。\n\n接着，输入 $g+s+b+h$ 行，每行 $2$ 个整数 $x_i$ $(0\\le x_i\\le 15)$ 和 $y_i$ $(0\\le y_i\\le 1.6\\times 10^5)$ 表示通过的题数和总罚时。保证 $(x_i,y_i)$ 为理论可能存在的通过的题数和对应的总罚时。\n\n前 $g$ 名获得金奖，第 $g+1\\sim g+s$ 名获得银奖，第 $g+s+1\\sim g+s+b$ 名获得铜奖，剩余选手获得荣誉奖。\n\n数据保证对于 $\\forall i$ 有 $(x_i,y_i)$ 和 $(x_{i+1},y_{i+1})$ 满足如题定义的偏序关系。", "outputFormat": "输出 $3$ 行，每行 $4$ 个整数。\n\n第一行输出的是金奖的上确界的通过的题数和罚时，下确界的通过的题数和罚时。第二行和第三行分别为银奖和铜奖的上确界和下确界。\n\n数据保证所有奖牌的**上下确界均存在**。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USTCPC 2025] Introduction to ICPC", "background": "USTCPC 设置 2s 时限为了使得 python 通过。洛谷改为 1s 时限。", "description": "克露丝卡尔酱正在参加 ICPC！这个题目是和 ICPC 基本规则相关的一道题。\n\n以下关于 ICPC 的内容与该题目无关：\n\n1. 一场 ICPC 一般有 $10\\sim 15$ 道题。题目排布顺序与题目难度无关。不过为了提升大家的参赛体验，克露丝卡尔酱温馨地提醒大家，ABCD 是本场比赛的简单题哦～\n\n2. 提交代码的正确性会即时返回给选手，选手也可以看到其他选手提交代码的正确性和即时排名。因此，当你在某一道题卡住时，不妨看看排行榜上其他队伍在做什么题，一般来说**通过**选手数较多的题目会更简单哦~\n\n3. 比赛最后一小时内，选手将不再能够看到其他选手提交代码的正确性，称为**封榜**（可以看到自己提交代码的正确性）。在颁奖过程中，会将排名从低到高逐渐公开是否通过，称为**滚榜**。\n\n-------\n\n以下关于 ICPC 的内容与该题目有关：\n\n1. 在 ICPC 中，提交代码的正确性为即时返回给选手，包括：（不同平台上这些名词会略有不同，以实际为准）\n   \n   + Accepted（正确）\n   \n   + Wrong Answer（答案错误）\n   \n   + Time Exceeded（程序运行时间超出时间限制）\n   \n   + Runtime Error（程序运行时发生错误，可能原因有：数组越界、除以0等）\n   \n   + Memory Exceeded（程序运行内存空间超过了题目限制）\n   \n   + Compile Error（编译错误）\n   \n   如果一位选手在一道题目中获得 Accepted 的结果，则选手在该题获得**通过**。\n\n2. 选手的成绩可以用 $2$ 个参数表示，**通过的题数**和**总罚时**。通过的题数即为选手获得通过题目的数量，而**罚时**的计算参照下表：\n   \n   - 对于未通过的题目，该题目的罚时为 $0$。\n   \n   - 对于通过的题目：该题目基础罚时为在该题获得 Accepted 的结果的时间（从比赛开始的分钟数）；特别地，在 Accepted 结果前，**每一个**非 Accepted 且非 Compile Error 在该题的提交会对于该题增加 $20$ 分钟罚时。\n   \n   - 每道题目的基础罚时的范围为 $[0,300)$，即在第 $300$ 分钟开始后不能够再提交代码。（这里认为存在第 $0$ 分钟）\n   \n   - 一场比赛的总罚时即为所有题目的罚时之和。\n   \n\t定义偏序关系：对于 2 位选手，如果他们通过的题数不相等，则通过的题数更多的选手胜出；若通过的题数相等，则总罚时更小的选手胜出。\n\n特别地，对于该题，规定一位选手只能在一分钟内提交 $30$ 次代码（所有题目共用提交次数）\n\n---\n\n一场一般的 ICPC 可以决出金奖、银奖、铜奖和荣誉奖。按照定义的偏序关系可以获得一个排行榜，而排行榜的前若干名可以获得金奖/银奖/铜奖。每种奖牌存在一种分数线（显然也有 $2$ 个参数）：成绩优于或等于该分数线的获得该种奖牌，而成绩劣于该分数线不能获得该种奖牌。分数线必须是一个可能达成的成绩。\n\n显然，能将不同奖牌区分开的分数线并不唯一。因此，克露丝卡尔酱想知道：对于每种奖牌，奖牌线的**上确界**和**下确界**为多少？", "inputFormat": "输入第一行 $4$ 个正整数 $g,s,b,h$ $(g,s,b,h\\ge 1,g+s+b+h\\le 10^5)$，分别表示金奖、银奖、铜奖和荣誉奖的选手数。\n\n接着，输入 $g+s+b+h$ 行，每行 $2$ 个整数 $x_i$ $(0\\le x_i\\le 15)$ 和 $y_i$ $(0\\le y_i\\le 1.6\\times 10^5)$ 表示通过的题数和总罚时。保证 $(x_i,y_i)$ 为理论可能存在的通过的题数和对应的总罚时。\n\n前 $g$ 名获得金奖，第 $g+1\\sim g+s$ 名获得银奖，第 $g+s+1\\sim g+s+b$ 名获得铜奖，剩余选手获得荣誉奖。\n\n数据保证对于 $\\forall i$ 有 $(x_i,y_i)$ 和 $(x_{i+1},y_{i+1})$ 满足如题定义的偏序关系。", "outputFormat": "输出 $3$ 行，每行 $4$ 个整数。\n\n第一行输出的是金奖的上确界的通过的题数和罚时，下确界的通过的题数和罚时。第二行和第三行分别为银奖和铜奖的上确界和下确界。\n\n数据保证所有奖牌的**上下确界均存在**。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P12035", "type": "P", "difficulty": 2, "samples": [["{flag{y0u_ar3_g0od_at_constructi0n}{}}", "flag{y0u_ar3_g0od_at_constructi0n}"], ["flag{flag{{}}}}}}", "NOT FOUND"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["字符串", "2025", "Special Judge", "高校校赛"], "title": "[USTCPC 2025] Hackergame", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/s9gnt6kl.png)", "description": "hackergame 是 USTC 特色比赛之一，也是克露丝卡尔酱心心念念的比赛之一。\n\n克露丝卡尔酱的同学小 H 在打 hackergame 时，发现当复制一个 flag 时，会将一些其它的内容（如感叹号、句号等）一同复制，从而上传答案时造成错误。\n\n克露丝卡尔酱打算编写一个程序来解决该问题，该程序会读取一个字符串，在当中选择一个连续的子串，满足是一个合法的 flag，并将其输出。如果所有子串都不是合法的，输出 `NOT FOUND`。\n\n一个字符串为一个合法的 flag，当且仅当满足以下性质：\n\n+ 该字符串以 `flag{` 开头，以字符 `}` 结尾。\n+ 在 `flag{` 和 `}` 之间，不存在字符 `{` 和字符 `}`，可以存在任何其它可见字符。\n\n克露丝卡尔酱想要尽快帮助她的同学，但她的同学想要朴素的代码。请帮她完成这个程序！", "inputFormat": "输入一行一个字符串，表示需要处理的字符串 $s$。$|s|\\le 10^5$，即输入的字符串长度不超过 $10^5$。\n\n输入的字符集为所有可见字符，不含空格、换行符等不可见字符。输入的字符串以换行符结尾。", "outputFormat": "输出一行一个字符串。\n\n+ 如输入的字符串中出现至少一个连续的子串时一个合法的 flag，请**任意选择一个**进行输出。\n+ 若所有连续的子串均不为合法的 flag，输出 `NOT FOUND`。", "hint": "第一个样例中，设字符串的下标位置从 $0$ 开始，则输出的字符串的第一个字符下标位置为 $1$，最后一个字符下标位置为 $34$。输出的字符串满足合法的 flag 所有的要求。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USTCPC 2025] Hackergame", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/s9gnt6kl.png)", "description": "hackergame 是 USTC 特色比赛之一，也是克露丝卡尔酱心心念念的比赛之一。\n\n克露丝卡尔酱的同学小 H 在打 hackergame 时，发现当复制一个 flag 时，会将一些其它的内容（如感叹号、句号等）一同复制，从而上传答案时造成错误。\n\n克露丝卡尔酱打算编写一个程序来解决该问题，该程序会读取一个字符串，在当中选择一个连续的子串，满足是一个合法的 flag，并将其输出。如果所有子串都不是合法的，输出 `NOT FOUND`。\n\n一个字符串为一个合法的 flag，当且仅当满足以下性质：\n\n+ 该字符串以 `flag{` 开头，以字符 `}` 结尾。\n+ 在 `flag{` 和 `}` 之间，不存在字符 `{` 和字符 `}`，可以存在任何其它可见字符。\n\n克露丝卡尔酱想要尽快帮助她的同学，但她的同学想要朴素的代码。请帮她完成这个程序！", "inputFormat": "输入一行一个字符串，表示需要处理的字符串 $s$。$|s|\\le 10^5$，即输入的字符串长度不超过 $10^5$。\n\n输入的字符集为所有可见字符，不含空格、换行符等不可见字符。输入的字符串以换行符结尾。", "outputFormat": "输出一行一个字符串。\n\n+ 如输入的字符串中出现至少一个连续的子串时一个合法的 flag，请**任意选择一个**进行输出。\n+ 若所有连续的子串均不为合法的 flag，输出 `NOT FOUND`。", "hint": "第一个样例中，设字符串的下标位置从 $0$ 开始，则输出的字符串的第一个字符下标位置为 $1$，最后一个字符下标位置为 $34$。输出的字符串满足合法的 flag 所有的要求。", "locale": "zh-CN"}}}
{"pid": "P12036", "type": "P", "difficulty": 2, "samples": [["3\n1 1 2\n3 5 4\n3 4 6", "2\n8\n-1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "2025", "Fibonacci 数列", "高校校赛"], "title": "[USTCPC 2025] 摩拉", "background": "USTCPC 设置 2s 时限为了使得 python 通过。洛谷改为 1s 时限。", "description": "克露丝卡尔酱喜欢 os！（`o` 代表圆，通原，`s` 代表神），里面有一位名叫凝光的角色。\n\n璃月的天权星凝光大人最热衷的就是赚取摩拉。\n\n近日她研究出了一种生财之道。如果她能在第一天赚 $p$ 个摩拉，就能在第二天赚 $p+1$ 个摩拉，并从第三天开始，每天所赚的摩拉是前两天赚的摩拉之和。\n\n现在凝光想知道，按照这种赚钱方法，如果在第 $a$ 天赚到了 $x$ 个摩拉，那么在第 $b$ 天能赚多少摩拉？", "inputFormat": "输入第一行表示数据组数 $T$ $(1 \\leq T\\leq 10^5)$。\n\n接下来 $T$ 行，每行三个整数 $a,x,b$ $(1 \\leq a,b \\leq 20$，$1 \\leq x \\leq 10 ^ {10})$。\n\n数据保证如果答案存在，那么 $1 \\leq p \\leq 10^6$，保证输入均为整数。", "outputFormat": "输出对应输入，每行一个整数，若不存在第 $a$ 天赚 $x$ 摩拉的情况，则输出 `-1`，否则输出对应答案。", "hint": "对于 `3 5 4` 的情况，第一天 $p=2$ ，第二天 $3$，第三天 $5$，第四天 $8$。\n\n对于 `3 4 6` 的情况，不存在使得第三天 $4$ 的情形。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USTCPC 2025] 摩拉", "background": "USTCPC 设置 2s 时限为了使得 python 通过。洛谷改为 1s 时限。", "description": "克露丝卡尔酱喜欢 os！（`o` 代表圆，通原，`s` 代表神），里面有一位名叫凝光的角色。\n\n璃月的天权星凝光大人最热衷的就是赚取摩拉。\n\n近日她研究出了一种生财之道。如果她能在第一天赚 $p$ 个摩拉，就能在第二天赚 $p+1$ 个摩拉，并从第三天开始，每天所赚的摩拉是前两天赚的摩拉之和。\n\n现在凝光想知道，按照这种赚钱方法，如果在第 $a$ 天赚到了 $x$ 个摩拉，那么在第 $b$ 天能赚多少摩拉？", "inputFormat": "输入第一行表示数据组数 $T$ $(1 \\leq T\\leq 10^5)$。\n\n接下来 $T$ 行，每行三个整数 $a,x,b$ $(1 \\leq a,b \\leq 20$，$1 \\leq x \\leq 10 ^ {10})$。\n\n数据保证如果答案存在，那么 $1 \\leq p \\leq 10^6$，保证输入均为整数。", "outputFormat": "输出对应输入，每行一个整数，若不存在第 $a$ 天赚 $x$ 摩拉的情况，则输出 `-1`，否则输出对应答案。", "hint": "对于 `3 5 4` 的情况，第一天 $p=2$ ，第二天 $3$，第三天 $5$，第四天 $8$。\n\n对于 `3 4 6` 的情况，不存在使得第三天 $4$ 的情形。", "locale": "zh-CN"}}}
{"pid": "P12037", "type": "P", "difficulty": 4, "samples": [["2\n5 2 1", "4.8347398341"], ["0\n4", "3.1415926536"]], "limits": {"time": [100, 100, 100, 100, 100], "memory": [524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "2025", "Special Judge", "微积分", "定积分", "高校校赛"], "title": "[USTCPC 2025] 数学分析", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/667ze1p8.png)", "description": "克露丝卡尔酱在中科大偶遇数学分析，拼尽全力无法战胜！请帮助她解决以下问题，帮助她不要挂科！\n\n请编写程序计算 $\\displaystyle\\int_{0}^1\\frac{P(x)}{x^2+1}dx$\n\n其中，$P(x)$ 为输入给定的多项式。$P(x)=a_0+a_1x+a_2x^2+\\cdots+a_nx^n$。", "inputFormat": "输入第一行一个非负整数 $n$ $(0\\le n\\le 10^5)$ 表示多项式的次数。\n\n输入第二行有 $n+1$ 个**整数** $a_0,a_1,\\dots,a_n$ $(-10^4\\le a_i\\le 10^4)$。", "outputFormat": "输出一行，即为积分的值。\n\n特别地，你的答案被视为正确当且仅当绝对误差或相对误差不超过 $10^{-6}$。正式地说，令你的答案为 $x$，评测机的答案为 $y$。你的答案视为正确当且仅当 $\\dfrac{|x-y|}{\\max(1,|y|)}\\le 10^{-6}$。", "hint": "$$\\displaystyle\\int_{0}^1\\frac{x^2+2x+5}{x^2+1}dx=\\pi+\\ln2+1\\approx 4.8347398341$$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USTCPC 2025] 数学分析", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/667ze1p8.png)", "description": "克露丝卡尔酱在中科大偶遇数学分析，拼尽全力无法战胜！请帮助她解决以下问题，帮助她不要挂科！\n\n请编写程序计算 $\\displaystyle\\int_{0}^1\\frac{P(x)}{x^2+1}dx$\n\n其中，$P(x)$ 为输入给定的多项式。$P(x)=a_0+a_1x+a_2x^2+\\cdots+a_nx^n$。", "inputFormat": "输入第一行一个非负整数 $n$ $(0\\le n\\le 10^5)$ 表示多项式的次数。\n\n输入第二行有 $n+1$ 个**整数** $a_0,a_1,\\dots,a_n$ $(-10^4\\le a_i\\le 10^4)$。", "outputFormat": "输出一行，即为积分的值。\n\n特别地，你的答案被视为正确当且仅当绝对误差或相对误差不超过 $10^{-6}$。正式地说，令你的答案为 $x$，评测机的答案为 $y$。你的答案视为正确当且仅当 $\\dfrac{|x-y|}{\\max(1,|y|)}\\le 10^{-6}$。", "hint": "$$\\displaystyle\\int_{0}^1\\frac{x^2+2x+5}{x^2+1}dx=\\pi+\\ln2+1\\approx 4.8347398341$$", "locale": "zh-CN"}}}
{"pid": "P12038", "type": "P", "difficulty": 6, "samples": [["6 10\n1 2 3 4 5\n7 7 7 7 7 7", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["二分", "2025", "双指针 two-pointer", "折半搜索 meet in the middle", "高校校赛", "树的重心"], "title": "[USTCPC 2025] 送温暖", "background": "", "description": "克露丝卡尔酱听说大家都是经验丰富的信息竞赛老手，轻松暴力踩标算。为了让大家都体验一下暴力踩标算的乐趣，所以克露丝卡尔酱准备了一道简单的送温暖题：\n\n给定一个 $n$ 个点的树，点 $i$ 的点权为 $a_i$，你需要从中选出一个连通块，使得它们的点权和模 $M$ 的余数最大。克露丝卡尔酱想知道这个点权和模 $M$ 的余数最大是多少。", "inputFormat": "第一行两个正整数 $n$ $(1\\leqslant n \\leqslant 33)$ 和 $M$ $(2\\leqslant M \\leqslant 10^9)$。\n\n为了方便输入，我们输入时假定以 $1$ 为根，但是请注意这是一棵无根树。\n\n第二行有 $n - 1$ 个整数，第 $i$ 个整数表示第 $i + 1$ 个点的父节点 $f_{i + 1}$ $(1\\leqslant f_{i+1} < i+1)$。\n\n第三行有 $n$ 个整数，$a_1, \\cdots, a_n$ $(0 \\leqslant a_i < M)$ 表示每个点的点权。", "outputFormat": "共一个整数表示答案。", "hint": "这棵树是一条链 `1 - 2 - 3 - 4 - 5 - 6`。最优解为选择一条长度为 4 的链（例如 `1 - 2 - 3 - 4` 或者 `2 - 3 - 4 - 5` 等等），此时答案为 $4 \\times 7 \\equiv 8\\pmod {10}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USTCPC 2025] 送温暖", "background": "", "description": "克露丝卡尔酱听说大家都是经验丰富的信息竞赛老手，轻松暴力踩标算。为了让大家都体验一下暴力踩标算的乐趣，所以克露丝卡尔酱准备了一道简单的送温暖题：\n\n给定一个 $n$ 个点的树，点 $i$ 的点权为 $a_i$，你需要从中选出一个连通块，使得它们的点权和模 $M$ 的余数最大。克露丝卡尔酱想知道这个点权和模 $M$ 的余数最大是多少。", "inputFormat": "第一行两个正整数 $n$ $(1\\leqslant n \\leqslant 33)$ 和 $M$ $(2\\leqslant M \\leqslant 10^9)$。\n\n为了方便输入，我们输入时假定以 $1$ 为根，但是请注意这是一棵无根树。\n\n第二行有 $n - 1$ 个整数，第 $i$ 个整数表示第 $i + 1$ 个点的父节点 $f_{i + 1}$ $(1\\leqslant f_{i+1} < i+1)$。\n\n第三行有 $n$ 个整数，$a_1, \\cdots, a_n$ $(0 \\leqslant a_i < M)$ 表示每个点的点权。", "outputFormat": "共一个整数表示答案。", "hint": "这棵树是一条链 `1 - 2 - 3 - 4 - 5 - 6`。最优解为选择一条长度为 4 的链（例如 `1 - 2 - 3 - 4` 或者 `2 - 3 - 4 - 5` 等等），此时答案为 $4 \\times 7 \\equiv 8\\pmod {10}$。", "locale": "zh-CN"}}}
{"pid": "P12039", "type": "P", "difficulty": 4, "samples": [["5 5\n1 4\n2 5\n1 2\n2 3\n3 1", "2 2 2 1 1"], ["1 0", "0"], ["6 9\n1 2\n1 3\n1 4\n1 5\n1 6\n2 3\n2 5\n2 6\n5 6", "3 3 2 1 3 3"], ["3 2\n1 2\n2 3", "1 1 1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288]}, "tags": ["2025", "拓扑排序", "高校校赛"], "title": "[USTCPC 2025] 高位逼抢", "background": "考虑到评测机性能差异，改为 2s 时限。USTCPC 时限为 3s。\n\n（题面最后提供了形式化的描述）\n\n克露丝卡尔酱最近开始游玩“实况足球”手游，在天梯遭遇10连败之后，又不幸匹配上了臭名昭著的“倒脚狗”。只见那可憎的对手将足球从后卫传到门将，又从门将传到后卫，又从后卫传到门将······\n\n是可忍，孰不可忍！怒不可遏的克露丝卡尔酱操纵自己的球员大举压上，向对手展开了高压逼抢。只可惜那对手发扬 Tiki-taka 战术，来回传球，把克露丝卡尔酱的上抢球员耍的团团转。\n\n说时迟，那时快，对手见克露丝卡尔酱全军出击，后防空虚，一个大脚将皮球开到前场。对手的前锋接球长驱直入，轻松攻破了克露丝卡尔酱的大门！\n\n克露丝卡尔酱自闭的卸载了“实况足球”，虽然过了几天又下了回来。但是在东山再起之前，她想要请教“实况足球”领域大神——你，该如何对付可恶的“倒脚狗”。", "description": "一场球赛上，对手共有 $n$ 名球员，但由于距离和技术限制，并不是任何两名球员之间都可以互相直接传球。具体来说，有且仅有 $m$ 对球员之间可以互相传球。\n\n当对手持球时，克露丝卡尔酱可以操纵球员上抢和封堵传球路线，具体地，当 $x+1$ 名队员去**高压逼抢**时:\n\n- 有 $1$ 名球员上抢，干扰持球球员。\n- 其余 $x$ 名球员，每个球员会**封堵至多一条传球路线**。\n\n由于没有练习过花式技巧，持球球员不会过人。因此在受到干扰后，持球球员必须立刻将球通过一条传球路线传给某个队友。\n\n如果某一时刻，持球球员发现自己所有的传球线路都被封堵。此时上抢球员直扑右脚，持球球员**丢失球权**。\n\n然而，过多的前场逼抢会快速地消耗球员体力，同时也会给防守带来隐患。因此，克露丝卡尔酱希望想知道：当对方的第 $i$ 号球员拿球时，$x$ 至少为多少，可以保证在有限的时间内抢下足球？\n\n\n### 形式化题面\n一个 $n$ 个点 $m$ 条边的无向图（无重边自环），一个棋子，还有一个常数 $x$。A 和 B 玩一个游戏。\n\n初始棋子位于 $i$ 节点，此后每一回合：\n\n- B 选定至多 $x$ 条边删掉\n- A 把棋子沿着某条边移到另一个节点\n- B 把刚刚删掉的边复原\n\n如果 A，B 都绝顶聪明，并且在有限轮中，B 可以把 A 逼入绝境（无法移动），则 B 胜利，否则 A 胜利。\n\n对于 $i\\in[1,n]$ 求 $x$ 至少为多少，B 才胜利。", "inputFormat": "第一行包含两个整数 $n$ $(1\\le n\\le 10^6)$ 和 $m$ $(0\\le m\\le 2\\times 10^6)$，表示图中的节点数和边数。\n\n接下来的 $m$ 行，每行包含两个整数 $u$ 和 $v$ $(1\\le u,v\\le n)$，表示球员 $u$ 和球员 $v$ 之间可以互相传球。\n\n保证图无重边自环。", "outputFormat": "输出一行 $n$ 个整数，表示对 $i=1\\sim n$ 的答案。\n\n", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USTCPC 2025] 高位逼抢", "background": "考虑到评测机性能差异，改为 2s 时限。USTCPC 时限为 3s。\n\n（题面最后提供了形式化的描述）\n\n克露丝卡尔酱最近开始游玩“实况足球”手游，在天梯遭遇10连败之后，又不幸匹配上了臭名昭著的“倒脚狗”。只见那可憎的对手将足球从后卫传到门将，又从门将传到后卫，又从后卫传到门将······\n\n是可忍，孰不可忍！怒不可遏的克露丝卡尔酱操纵自己的球员大举压上，向对手展开了高压逼抢。只可惜那对手发扬 Tiki-taka 战术，来回传球，把克露丝卡尔酱的上抢球员耍的团团转。\n\n说时迟，那时快，对手见克露丝卡尔酱全军出击，后防空虚，一个大脚将皮球开到前场。对手的前锋接球长驱直入，轻松攻破了克露丝卡尔酱的大门！\n\n克露丝卡尔酱自闭的卸载了“实况足球”，虽然过了几天又下了回来。但是在东山再起之前，她想要请教“实况足球”领域大神——你，该如何对付可恶的“倒脚狗”。", "description": "一场球赛上，对手共有 $n$ 名球员，但由于距离和技术限制，并不是任何两名球员之间都可以互相直接传球。具体来说，有且仅有 $m$ 对球员之间可以互相传球。\n\n当对手持球时，克露丝卡尔酱可以操纵球员上抢和封堵传球路线，具体地，当 $x+1$ 名队员去**高压逼抢**时:\n\n- 有 $1$ 名球员上抢，干扰持球球员。\n- 其余 $x$ 名球员，每个球员会**封堵至多一条传球路线**。\n\n由于没有练习过花式技巧，持球球员不会过人。因此在受到干扰后，持球球员必须立刻将球通过一条传球路线传给某个队友。\n\n如果某一时刻，持球球员发现自己所有的传球线路都被封堵。此时上抢球员直扑右脚，持球球员**丢失球权**。\n\n然而，过多的前场逼抢会快速地消耗球员体力，同时也会给防守带来隐患。因此，克露丝卡尔酱希望想知道：当对方的第 $i$ 号球员拿球时，$x$ 至少为多少，可以保证在有限的时间内抢下足球？\n\n\n### 形式化题面\n一个 $n$ 个点 $m$ 条边的无向图（无重边自环），一个棋子，还有一个常数 $x$。A 和 B 玩一个游戏。\n\n初始棋子位于 $i$ 节点，此后每一回合：\n\n- B 选定至多 $x$ 条边删掉\n- A 把棋子沿着某条边移到另一个节点\n- B 把刚刚删掉的边复原\n\n如果 A，B 都绝顶聪明，并且在有限轮中，B 可以把 A 逼入绝境（无法移动），则 B 胜利，否则 A 胜利。\n\n对于 $i\\in[1,n]$ 求 $x$ 至少为多少，B 才胜利。", "inputFormat": "第一行包含两个整数 $n$ $(1\\le n\\le 10^6)$ 和 $m$ $(0\\le m\\le 2\\times 10^6)$，表示图中的节点数和边数。\n\n接下来的 $m$ 行，每行包含两个整数 $u$ 和 $v$ $(1\\le u,v\\le n)$，表示球员 $u$ 和球员 $v$ 之间可以互相传球。\n\n保证图无重边自环。", "outputFormat": "输出一行 $n$ 个整数，表示对 $i=1\\sim n$ 的答案。\n\n", "hint": "", "locale": "zh-CN"}}}
{"pid": "P12040", "type": "P", "difficulty": 5, "samples": [["3 2 998244353", "665496238"], ["10 2 998244353", "798595487"]], "limits": {"time": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2025", "数论", "概率论", "期望", "高校校赛"], "title": "[USTCPC 2025] 公平抉择", "background": "考虑到评测机性能差异，改为 400ms 时限。USTCPC 时限为 600ms。\n\n**请注意本题非常规时空限制！**\n\n所以要“费厄”，最好是首先看清对手，倘是些不配承受“费厄”的，大可以老实不客气；待到它也“费厄”了，然后再与它讲“费厄”不迟。(节选自鲁迅《论“费厄泼赖”应该缓行》)\n\n克露丝卡尔酱选择困难！她甚至无法抉择午饭去吃什么，作为她的朋友，你需要和她一起完整**公平的抉择**。", "description": "克露丝卡尔酱在做选择，食堂共有 $n$ 种菜品可选，而她手里只有一个 $k$ 面的骰子(如果 $k = 2$ 则为硬币)。\n\n为了落实公平抉择的理念，她希望她的策略选择到每个菜品的概率相等。\n\n求她期望投掷次数的最小值，**答案对质数 $M$ 取模**。", "inputFormat": "一行三个正整数 $n, k, M$ ,分别表示选项数、骰子面数和模数。\n\n$2 \\le k \\le n \\le 3 \\times 10^6$，$10^8 \\le M \\le 10^9$，**保证 $M$ 为质数且对于任意 $1 \\le i \\le n,k^i \\bmod M > 1$**。", "outputFormat": "一个整数表示模意义下的答案。\n\n关于分数取模：设答案为 $\\dfrac{q}{p}$ 且 $M \\nmid p,q$，那么取模结果 $x$ 为 唯一 $x\\in[0,M)$ 使得 $px\\equiv q\\pmod M$。", "hint": "在样例 $1$ 中，不妨设答案为 $E$。考虑扔两次硬币，得到四种情况，出现概率各为 $\\dfrac{1}4$。前三种情况分配给三种菜品，第四种情况重投。故 $E=2+\\dfrac{E}4$，解得 $E=\\dfrac{8}3$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USTCPC 2025] 公平抉择", "background": "考虑到评测机性能差异，改为 400ms 时限。USTCPC 时限为 600ms。\n\n**请注意本题非常规时空限制！**\n\n所以要“费厄”，最好是首先看清对手，倘是些不配承受“费厄”的，大可以老实不客气；待到它也“费厄”了，然后再与它讲“费厄”不迟。(节选自鲁迅《论“费厄泼赖”应该缓行》)\n\n克露丝卡尔酱选择困难！她甚至无法抉择午饭去吃什么，作为她的朋友，你需要和她一起完整**公平的抉择**。", "description": "克露丝卡尔酱在做选择，食堂共有 $n$ 种菜品可选，而她手里只有一个 $k$ 面的骰子(如果 $k = 2$ 则为硬币)。\n\n为了落实公平抉择的理念，她希望她的策略选择到每个菜品的概率相等。\n\n求她期望投掷次数的最小值，**答案对质数 $M$ 取模**。", "inputFormat": "一行三个正整数 $n, k, M$ ,分别表示选项数、骰子面数和模数。\n\n$2 \\le k \\le n \\le 3 \\times 10^6$，$10^8 \\le M \\le 10^9$，**保证 $M$ 为质数且对于任意 $1 \\le i \\le n,k^i \\bmod M > 1$**。", "outputFormat": "一个整数表示模意义下的答案。\n\n关于分数取模：设答案为 $\\dfrac{q}{p}$ 且 $M \\nmid p,q$，那么取模结果 $x$ 为 唯一 $x\\in[0,M)$ 使得 $px\\equiv q\\pmod M$。", "hint": "在样例 $1$ 中，不妨设答案为 $E$。考虑扔两次硬币，得到四种情况，出现概率各为 $\\dfrac{1}4$。前三种情况分配给三种菜品，第四种情况重投。故 $E=2+\\dfrac{E}4$，解得 $E=\\dfrac{8}3$。", "locale": "zh-CN"}}}
{"pid": "P12041", "type": "P", "difficulty": 3, "samples": [["4 4\n1 2 0\n2 3 0\n3 1 0\n3 4 1", "Yes\n0 1 2 0"], ["1 1\n1 1 114514", "NO"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["图论", "并查集", "2025", "Special Judge", "连通块", "构造", "高校校赛"], "title": "[USTCPC 2025] 图上交互题 2 / Constructive Minimum Mex Path", "background": "USTCPC 设置 3s 时限为了使得 python 通过。洛谷改为 1s 时限。\n\n2024 年 1 月 13 日 15:59:31，随着最后一发交互 J 题的提交出现了 Wrong Answer，小 G 的 EC-Final 比赛结束了，也意味着在 ICPC 生涯中第一次打铁。\n\n克露丝卡尔酱想要帮助她的同学小 G！她打算批量生产交互题给小 G 做。如何批量生产交互题？只要在一个数据结构中有若干个未知量 $a_i$，每次询问给定向量 $x$，交互库会返回关于 $a_i$ 的函数 $f(x)$，这样就能批量生产交互题了！\n\n~~为什么题目名里有 2 呢？~~", "description": "给定一个 $n$ 个点，$m$ 条边的**无向图**。第 $i$ 条边 $(u_i,v_i)$ 有一个**未知边权** $a_i$。\n\n对于任何一条**路径**，定义其**代价**如下：设路径为 $(p_0,p_1,...,p_k)$，其中要求 $(p_{i-1},p_i)$ 是无向图中的边，设其为第 $e_i$ 条边。那么路径的代价即为 $\\mathop{\\text{mex}}\\limits_{i=1}^{k} a_{e_i}$。（该路径可以经过重复点和重复边，即 $p$ 和 $e$ 可以包含重复的数）\n\n$\\text{mex}$ 是一种定义域为一个非负整数的可重集合，函数值为非负整数的映射，定义为集合内最小未在集合内出现过的非负整数。\n\n定义 $f(x,y)$ 为从 $x$ 到 $y$ 的所有路径中代价的**最小值**。特别地，当 $x=y$ 时，$f(x,y)=0$。\n\n给定 $n,m$，再对于每条边 $(u_i,v_i)$ 给定 $f(u_i,v_i)$，你需要求出是否存在一组合法的 $a_i$，如果有解，你还需要构造一组解。", "inputFormat": "第一行两个正整数 $n,m$ $(1\\le n,m\\le 10^5)$。\n\n第 $2\\sim m+1$ 行每行两个正整数 $u_i,v_i$ $(1\\le u_i,v_i\\le n)$ 和一个非负整数 $f(u_i,v_i)$ $(0\\le f(u_i,v_i)<2^{31})$。\n\n**请注意：本题并不保证图连通；可能会存在重边和自环。**", "outputFormat": "如果不存在解，则仅输出 `No`。\n\n否则，在第一行输出 `Yes`，在第二行输出 $m$ 个非负整数 $a_i$ 表示一组合法的解。\n\n答案可能有很多组，此时输出任意一组解即可。你需要保证 输出的 $0\\le a_i<2^{31}$。\n\n你可以以任意的大小写形式输出 `Yes` 或 `No`。例如，`yEs`，`yes`，`Yes` 和 `YES` 都将被视为肯定的回复。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/z3pthk3a.png)\n\n考虑 $f(1,2)$：\n\n+ 考虑路径 $1\\rightarrow 2$，路径的代价为 $\\text{mex}\\{0\\}=1$。\n+ 考虑路径 $1\\rightarrow 2\\rightarrow 3\\rightarrow 1\\rightarrow 2$，路径的代价为 $\\text{mex}\\{0,1,2,0\\}=3$。\n+ 考虑路径 $1\\rightarrow 3\\rightarrow 2$，路径的代价为 $\\text{mex}\\{1,2\\}=0$。\n\n此外还存在其他路径，但可以证明不存在代价比 $0$ 更小的路径，故 $f(1,2)=0$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USTCPC 2025] 图上交互题 2 / Constructive Minimum Mex Path", "background": "USTCPC 设置 3s 时限为了使得 python 通过。洛谷改为 1s 时限。\n\n2024 年 1 月 13 日 15:59:31，随着最后一发交互 J 题的提交出现了 Wrong Answer，小 G 的 EC-Final 比赛结束了，也意味着在 ICPC 生涯中第一次打铁。\n\n克露丝卡尔酱想要帮助她的同学小 G！她打算批量生产交互题给小 G 做。如何批量生产交互题？只要在一个数据结构中有若干个未知量 $a_i$，每次询问给定向量 $x$，交互库会返回关于 $a_i$ 的函数 $f(x)$，这样就能批量生产交互题了！\n\n~~为什么题目名里有 2 呢？~~", "description": "给定一个 $n$ 个点，$m$ 条边的**无向图**。第 $i$ 条边 $(u_i,v_i)$ 有一个**未知边权** $a_i$。\n\n对于任何一条**路径**，定义其**代价**如下：设路径为 $(p_0,p_1,...,p_k)$，其中要求 $(p_{i-1},p_i)$ 是无向图中的边，设其为第 $e_i$ 条边。那么路径的代价即为 $\\mathop{\\text{mex}}\\limits_{i=1}^{k} a_{e_i}$。（该路径可以经过重复点和重复边，即 $p$ 和 $e$ 可以包含重复的数）\n\n$\\text{mex}$ 是一种定义域为一个非负整数的可重集合，函数值为非负整数的映射，定义为集合内最小未在集合内出现过的非负整数。\n\n定义 $f(x,y)$ 为从 $x$ 到 $y$ 的所有路径中代价的**最小值**。特别地，当 $x=y$ 时，$f(x,y)=0$。\n\n给定 $n,m$，再对于每条边 $(u_i,v_i)$ 给定 $f(u_i,v_i)$，你需要求出是否存在一组合法的 $a_i$，如果有解，你还需要构造一组解。", "inputFormat": "第一行两个正整数 $n,m$ $(1\\le n,m\\le 10^5)$。\n\n第 $2\\sim m+1$ 行每行两个正整数 $u_i,v_i$ $(1\\le u_i,v_i\\le n)$ 和一个非负整数 $f(u_i,v_i)$ $(0\\le f(u_i,v_i)<2^{31})$。\n\n**请注意：本题并不保证图连通；可能会存在重边和自环。**", "outputFormat": "如果不存在解，则仅输出 `No`。\n\n否则，在第一行输出 `Yes`，在第二行输出 $m$ 个非负整数 $a_i$ 表示一组合法的解。\n\n答案可能有很多组，此时输出任意一组解即可。你需要保证 输出的 $0\\le a_i<2^{31}$。\n\n你可以以任意的大小写形式输出 `Yes` 或 `No`。例如，`yEs`，`yes`，`Yes` 和 `YES` 都将被视为肯定的回复。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/z3pthk3a.png)\n\n考虑 $f(1,2)$：\n\n+ 考虑路径 $1\\rightarrow 2$，路径的代价为 $\\text{mex}\\{0\\}=1$。\n+ 考虑路径 $1\\rightarrow 2\\rightarrow 3\\rightarrow 1\\rightarrow 2$，路径的代价为 $\\text{mex}\\{0,1,2,0\\}=3$。\n+ 考虑路径 $1\\rightarrow 3\\rightarrow 2$，路径的代价为 $\\text{mex}\\{1,2\\}=0$。\n\n此外还存在其他路径，但可以证明不存在代价比 $0$ 更小的路径，故 $f(1,2)=0$。", "locale": "zh-CN"}}}
