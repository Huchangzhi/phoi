{"pid": "P12995", "type": "P", "difficulty": 6, "samples": [["4\n2\n-3 0\n-1 0\n3 0\n-2 -1\n-2 1\n1\n0 0\n1 1\n2 2\n3\n10 0\n-10 0\n0 0\n0 5\n-1 0\n5 0\n0 -5\n2\n3 4\n3 4\n5 7\n3 4\n5 7", "Case #1: POSSIBLE\n2 2\n1 3\nCase #2: IMPOSSIBLE\nCase #3: POSSIBLE\n3 2\n2 4\n1 3\nCase #4: POSSIBLE\n1 2\n2 3"]], "limits": {"time": [10000, 10000, 45000], "memory": [1048576, 1048576, 1048576]}, "tags": ["2022", "网络流", "Special Judge", "二分图", "Google Code Jam"], "title": "[GCJ 2022 #2] Saving the Jelly", "background": "", "description": "Mr. Jolly teaches football (or soccer, for US speakers) to $\\mathbf{N}$ children numbered from 1 to $\\mathbf{N}$. He has taken to leaving sweets on the field where the games take place, one for each child. After the game is finished, each child can grab and eat one sweet as their reward.\n\nThe children are tired after games, so each child wants to grab the sweet closest to them (using Euclidean distance). This could lead to fights - if the same sweet is closest to two or more children. To avoid that, after the game all the children stop where they are, and Mr. Jolly calls out their names, one by one. When a child's name is called, they grab the closest sweet to them (out of the ones that weren't already grabbed, of course). In the case where two or more sweets are tied for the smallest distance, Mr. Jolly can decide which one the child grabs.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/h3px6piy.png)\n\nThis has worked very well for Mr. Jolly for a while now, but today disaster struck! While laying out the sweets, Mr. Jolly accidentally dropped his blueberry jelly that he planned to eat after all the children go home. So now there are $\\mathbf{N}$ children on the field, and $\\mathbf{N}+1$ sweets. The sweets are numbered from 1 to $\\mathbf{N}+1$, with sweet 1 being Mr. Jolly's blueberry jelly. Is there a way for Mr. Jolly to save his blueberry jelly by calling the children's names in such an order that the blueberry jelly is the one sweet left over?", "inputFormat": "The first line of the input gives the number of test cases, $\\mathbf{T}$. $\\mathbf{T}$ test cases follow. Each test begins with a line containing a single integer, $\\mathbf{N}$, the number of children on the field. The next $\\mathbf{N}$ lines describe the positions of the children. Each of these lines contains two integers, $\\mathbf{X}_{\\mathbf{i}}$ and $\\mathbf{Y}_{\\mathbf{i}}$, representing the position of the $i$-th child after the game ends. Then there are $\\mathbf{N}+1$ more lines that describe the positions of sweets after the game, where the first of the sweets is Mr. Jolly's blueberry jelly. Each of these lines contains two integers, $\\mathbf{X}_{\\mathbf{j}}$ and $\\mathbf{Y}_{\\mathbf{j}}$, representing the position of the $j$-th sweet.\n", "outputFormat": "For each test case, output one line containing `Case #x: y`, where $x$ is the test case number (starting from 1) and $y$ is IMPOSSIBLE if there is no way Mr. Jolly can choose the children (and break ties for the closest sweet) to leave his blueberry jelly uneaten. Otherwise, if Mr. Jolly can save his blueberry jelly, $y$ is POSSIBLE. If Mr. Jolly can save his jelly, output $\\mathbf{N}$ additional lines representing the order the children will go and which jellies they will pick. The $i$-th line should contain two integers $A_{i}$ and $B_{i}$ representing that child $A_{i}$ will go next and will pick sweet $B_{i}$. The sweet $B_{i}$ must be the closest (or tied for the closest) sweet to child $A_{i}$ when they go to pick their sweet.", "hint": "**Sample Explanation**\n\nSample Case #1 is illustrated in the image above. Notice that each child is equally close to each of the two non-blueberry-jelly sweets. In our solution, Mr. Jolly assigns the second sweet to the second child and the third sweet to the first child, successfully leaving the first sweet (the blueberry jelly) for himself.\n\nIn Sample Case #2, the sole child is closer to the blueberry jelly than to the other sweet, so Mr. Jolly cannot prevent his precious blueberry jelly from being eaten.\n\nIn Sample Case #3, we present one of many solutions; it is actually possible to call the children in any order.\n\nIn Sample Case #4, note that children might share the same position, sweets might share the same position, and children and sweets might share the same position.\n\n**Limits**\n\n- $1 \\leq \\mathbf{T} \\leq 100$.\n- $-10^{9} \\leq \\mathbf{X}_{\\mathbf{i}} \\leq 10^{9}$, for all $i$.\n- $-10^{9} \\leq \\mathbf{Y}_{\\mathbf{i}} \\leq 10^{9}$, for all $i$.\n- $-10^{9} \\leq \\mathbf{X}_{\\mathbf{j}} \\leq 10^{9}$, for all $j$.\n- $-10^{9} \\leq \\mathbf{Y}_{\\mathbf{j}} \\leq 10^{9}$, for all $j$.\n\n**Test Set 1 (10 Pts, Visible Verdict)**\n\n- Time limit: 10 seconds.\n- $1 \\leq \\mathbf{N} \\leq 10$.\n\n**Test Set 2 (18 Pts, Hidden Verdict)**\n\n- Time limit: 45 seconds.\n- $1 \\leq \\mathbf{N} \\leq 1000$.", "locale": "en", "translations": {"en": {"title": "[GCJ 2022 #2] Saving the Jelly", "background": "", "description": "Mr. Jolly teaches football (or soccer, for US speakers) to $\\mathbf{N}$ children numbered from 1 to $\\mathbf{N}$. He has taken to leaving sweets on the field where the games take place, one for each child. After the game is finished, each child can grab and eat one sweet as their reward.\n\nThe children are tired after games, so each child wants to grab the sweet closest to them (using Euclidean distance). This could lead to fights - if the same sweet is closest to two or more children. To avoid that, after the game all the children stop where they are, and Mr. Jolly calls out their names, one by one. When a child's name is called, they grab the closest sweet to them (out of the ones that weren't already grabbed, of course). In the case where two or more sweets are tied for the smallest distance, Mr. Jolly can decide which one the child grabs.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/h3px6piy.png)\n\nThis has worked very well for Mr. Jolly for a while now, but today disaster struck! While laying out the sweets, Mr. Jolly accidentally dropped his blueberry jelly that he planned to eat after all the children go home. So now there are $\\mathbf{N}$ children on the field, and $\\mathbf{N}+1$ sweets. The sweets are numbered from 1 to $\\mathbf{N}+1$, with sweet 1 being Mr. Jolly's blueberry jelly. Is there a way for Mr. Jolly to save his blueberry jelly by calling the children's names in such an order that the blueberry jelly is the one sweet left over?", "inputFormat": "The first line of the input gives the number of test cases, $\\mathbf{T}$. $\\mathbf{T}$ test cases follow. Each test begins with a line containing a single integer, $\\mathbf{N}$, the number of children on the field. The next $\\mathbf{N}$ lines describe the positions of the children. Each of these lines contains two integers, $\\mathbf{X}_{\\mathbf{i}}$ and $\\mathbf{Y}_{\\mathbf{i}}$, representing the position of the $i$-th child after the game ends. Then there are $\\mathbf{N}+1$ more lines that describe the positions of sweets after the game, where the first of the sweets is Mr. Jolly's blueberry jelly. Each of these lines contains two integers, $\\mathbf{X}_{\\mathbf{j}}$ and $\\mathbf{Y}_{\\mathbf{j}}$, representing the position of the $j$-th sweet.\n", "outputFormat": "For each test case, output one line containing `Case #x: y`, where $x$ is the test case number (starting from 1) and $y$ is IMPOSSIBLE if there is no way Mr. Jolly can choose the children (and break ties for the closest sweet) to leave his blueberry jelly uneaten. Otherwise, if Mr. Jolly can save his blueberry jelly, $y$ is POSSIBLE. If Mr. Jolly can save his jelly, output $\\mathbf{N}$ additional lines representing the order the children will go and which jellies they will pick. The $i$-th line should contain two integers $A_{i}$ and $B_{i}$ representing that child $A_{i}$ will go next and will pick sweet $B_{i}$. The sweet $B_{i}$ must be the closest (or tied for the closest) sweet to child $A_{i}$ when they go to pick their sweet.", "hint": "**Sample Explanation**\n\nSample Case #1 is illustrated in the image above. Notice that each child is equally close to each of the two non-blueberry-jelly sweets. In our solution, Mr. Jolly assigns the second sweet to the second child and the third sweet to the first child, successfully leaving the first sweet (the blueberry jelly) for himself.\n\nIn Sample Case #2, the sole child is closer to the blueberry jelly than to the other sweet, so Mr. Jolly cannot prevent his precious blueberry jelly from being eaten.\n\nIn Sample Case #3, we present one of many solutions; it is actually possible to call the children in any order.\n\nIn Sample Case #4, note that children might share the same position, sweets might share the same position, and children and sweets might share the same position.\n\n**Limits**\n\n- $1 \\leq \\mathbf{T} \\leq 100$.\n- $-10^{9} \\leq \\mathbf{X}_{\\mathbf{i}} \\leq 10^{9}$, for all $i$.\n- $-10^{9} \\leq \\mathbf{Y}_{\\mathbf{i}} \\leq 10^{9}$, for all $i$.\n- $-10^{9} \\leq \\mathbf{X}_{\\mathbf{j}} \\leq 10^{9}$, for all $j$.\n- $-10^{9} \\leq \\mathbf{Y}_{\\mathbf{j}} \\leq 10^{9}$, for all $j$.\n\n**Test Set 1 (10 Pts, Visible Verdict)**\n\n- Time limit: 10 seconds.\n- $1 \\leq \\mathbf{N} \\leq 10$.\n\n**Test Set 2 (18 Pts, Hidden Verdict)**\n\n- Time limit: 45 seconds.\n- $1 \\leq \\mathbf{N} \\leq 1000$.", "locale": "en"}, "zh-CN": {"title": "[GCJ 2022 #2] Saving the Jelly", "background": "", "description": "Jolly 先生正在教编号为 1 到 $\\mathbf{N}$ 的 $\\mathbf{N}$ 个孩子踢足球（或称 soccer，针对美国读者）。他习惯在比赛场地上放置糖果，每个孩子一颗。比赛结束后，每个孩子可以拿走并吃掉一颗作为奖励。\n\n孩子们在比赛后很累，所以每个孩子都想拿离自己最近的糖果（使用欧几里得距离计算）。这可能导致冲突——如果同一颗糖果是多个孩子最近的。为避免这种情况，比赛结束后所有孩子停在原地，Jolly 先生会依次点名。当被点到名时，孩子会拿走离自己最近的糖果（当然，只能选未被拿走的糖果）。当有多颗糖果距离最近且相同时，Jolly 先生可以决定孩子拿哪一颗。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/h3px6piy.png)\n\n这个方法一直很有效，但今天出问题了！Jolly 先生在布置糖果时，不小心把他准备在孩子们回家后享用的蓝莓果冻也放在了场地上。现在场上有 $\\mathbf{N}$ 个孩子和 $\\mathbf{N}+1$ 颗糖果。糖果编号为 1 到 $\\mathbf{N}+1$，其中 1 号是 Jolly 先生的蓝莓果冻。是否存在一种点名顺序，使得最后剩下的糖果正好是蓝莓果冻？", "inputFormat": "第一行输入测试用例数量 $\\mathbf{T}$。随后 $\\mathbf{T}$ 个测试用例，每个用例第一行是一个整数 $\\mathbf{N}$ 表示孩子数量。接下来 $\\mathbf{N}$ 行描述孩子的位置，每行两个整数 $\\mathbf{X}_{\\mathbf{i}}$ 和 $\\mathbf{Y}_{\\mathbf{i}}$ 表示第 $i$ 个孩子的坐标。随后 $\\mathbf{N}+1$ 行描述糖果位置，其中第一颗是蓝莓果冻，每行两个整数 $\\mathbf{X}_{\\mathbf{j}}$ 和 $\\mathbf{Y}_{\\mathbf{j}}$ 表示第 $j$ 颗糖果的坐标。\n", "outputFormat": "对于每个测试用例，输出一行 `Case #x: y`，其中 $x$ 是用例编号（从 1 开始）。若无法保留蓝莓果冻，$y$ 为 IMPOSSIBLE；否则为 POSSIBLE。若可能，还需输出 $\\mathbf{N}$ 行表示点名顺序和选择的糖果，每行两个整数 $A_{i}$ 和 $B_{i}$，表示孩子 $A_{i}$ 被点名并选择糖果 $B_{i}$（选择时 $B_{i}$ 必须是该孩子最近的糖果之一）。\n", "hint": "**样例解释**\n\n样例 #1 如上图所示。每个孩子到两颗非果冻糖果的距离相等。解决方案中，Jolly 先生让 2 号孩子拿 2 号糖果，1 号孩子拿 3 号糖果，成功保留 1 号糖果（蓝莓果冻）。\n\n样例 #2 中，唯一的孩子离蓝莓果冻比其他糖果更近，Jolly 先生无法保住果冻。\n\n样例 #3 展示了一种可能的解，实际上可以任意顺序点名。\n\n样例 #4 中注意孩子可能位置重合、糖果可能位置重合、孩子和糖果也可能位置重合。\n\n**数据范围**\n\n- $1 \\leq \\mathbf{T} \\leq 100$\n- 所有坐标的绝对值不超过 $10^{9}$\n\n**测试集 1（10 分，可见判定）**\n\n- 时间限制：10 秒\n- $1 \\leq \\mathbf{N} \\leq 10$\n\n**测试集 2（18 分，隐藏判定）**\n\n- 时间限制：45 秒\n- $1 \\leq \\mathbf{N} \\leq 1000$\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P12996", "type": "P", "difficulty": 6, "samples": [["4\n5 0\n3 0\n6 0\n8 0\n10 1\n15 1\n5 10\n3 0\n6 0\n8 0\n10 1\n15 1\n5 1\n3 0\n6 0\n8 0\n10 1\n15 1\n2 0\n1000000000 0\n-1000000000 1", "Case #1: 52\nCase #2: 56\nCase #3: 54\nCase #4: 4000000000"]], "limits": {"time": [40000, 40000, 40000], "memory": [1048576, 1048576, 1048576]}, "tags": ["动态规划 DP", "2022", "Google Code Jam"], "title": "[GCJ 2022 #2] I, O Bot", "background": "", "description": "To welcome attendees to a developers' conference on Jupiter's moon of Io, the organizers inflated many giant beach balls. Each ball is in roughly the shape of either a 1 or a 0, since those look sort of like the letters I and O. The conference just ended, and so now the beach balls need to be cleaned up. Luckily, the beach ball cleanup robot, BALL-E, is on the job!\n\nThe conference was held on an infinite horizontal line, with station 0 in the middle, stations 1, 2, … to the right, and stations $-1, -2, \\ldots$ to the left. Station 0 contains the conference's only beach ball storage warehouse. Each other station contains at most one beach ball.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/88wnnnxw.png)\n\nBALL-E has two storage compartments, each of which can hold a single beach ball. One compartment can only hold 1-shaped balls and the other can only hold 0-shaped balls. (The 1-shaped balls are more oblong than the 0-shaped balls, so neither shape of ball will fit in the other shape's compartment.)\n\nBALL-E initially has both the 0 and 1 compartments empty, and it starts off at station 0. The robot can do the following things:\n\n* Move left one station or right one station. This costs 1 unit of power.\n* If there is a ball at the current station, and BALL-E is not already storing a ball of that shape, it can put the ball in the appropriate compartment. This takes 0 units of power.\n* If there is a ball at the current station, BALL-E can compress it so that its shape becomes the other shape. That is, a 1-shaped ball becomes a 0-shaped ball, or vice versa. It takes $\\mathbf{C}$ units of power to do this. Note that BALL-E may not change the shape of a ball that it has already put into one of its compartments.\n* If BALL-E is at station 0 and is storing at least one ball, it can deposit all balls from its compartment(s) into the beach ball storage warehouse. This takes 0 units of power and leaves both compartments empty.\n\nNotice that if BALL-E moves to a station and there is a ball there, BALL-E is not required to pick it up immediately, even if the robot has an open compartment for it. Also, if BALL-E moves to the station with the warehouse, it is not required to deposit any balls it has.\n\nFind the minimum number of units of power needed for BALL-E to transfer all of the balls to the warehouse, using only the moves described above.", "inputFormat": "The first line of the input gives the number of test cases, $\\mathbf{T}$. $\\mathbf{T}$ test cases follow.\n\nThe first line of each test case contains two integers, $\\mathbf{N}$ and $\\mathbf{C}$: the number of balls and the amount of power units needed to change the shape of a ball, respectively.\n\nThe next $\\mathbf{N}$ lines describe the positions (i.e., station numbers) and the shapes of the balls. The $i$-th line contains two integers, $\\mathbf{X}_{\\mathbf{i}}$ and $\\mathbf{S}_{\\mathbf{i}}$: the position and the shape of the $i$-th ball, respectively.", "outputFormat": "For each test case, output one line containing case # $x$: $y$, where $x$ is the test case number (starting from 1) and $y$ is the minimum number of units of power needed to transfer all of the balls to the warehouse, as described above.", "hint": "**Sample Explanation**\n\nIn Sample Case #1 (illustrated in the statement), there are $\\mathbf{N} = 5$ balls and $\\mathbf{C} = 0$. One optimal strategy is to make three round trips from (and back to) the warehouse:\n\n* First round trip: Move to station 3, pick up the 0 ball there and store it in the 0 compartment, move back to station 0, and deposit the ball in the warehouse. This takes 6 units of power.\n* Second round trip: Move to station 8, pick up the 0 ball there, and store it in the 0 compartment. Move to station 6, change the 0 ball there into a 1 ball, and pick it up and store it in the 1 compartment. Move to station 0 and deposit both balls in the warehouse. This takes 16 units of power. (Recall that in this case, it takes 0 units of power to change a ball's shape.)\n* Third round trip: Move to station 10. Change the 1 ball there into a 0 ball, and pick it up and store it in the 0 compartment. Move to station 15. Pick up the 1 ball there and store it in the 1 compartment. Move to station 0 and deposit both balls in the warehouse. This takes 30 units of power.\n\nThe total number of units of power needed to collect all the balls is 52.\n\nSample Case #2 is like Sample Case #1, but now with $\\mathbf{C} = 10$. Now BALL-E has to use at least 56 units of power:\n\n* First round trip: Get the ball from station 3. This takes 6 units of power.\n* Second round trip: Get the differently-shaped balls from stations 6 and 10. (These are a 0 and a 1, respectively, so there is no need to change the shape of either of them.) This takes 20 units of power.\n* Third round trip: Get the differently-shaped balls from stations 8 and 15. This takes 30 units of power.\n\nSample Case #3 is also like Sample Case #1, but now with $\\mathbf{C} = 1$. Here, BALL-E needs at least 54 units of power:\n\n* First round trip: Get the ball from station 3. This takes 6 units of power.\n* Second round trip: Get the ball from station 8. When passing through station 6 on the way back, change the shape of the ball there and get it. This takes 17 units of power.\n* Third round trip: Do the same with the balls at stations 15 and 10. This takes 31 units of power.\n\nIn Sample Case #4, one optimal strategy is for BALL-E to move to station $-1000000000$, get the 1 ball there, move to station $1000000000$, get the 0 ball there, and then return to station 0 to deposit both of them.\n\n**Limits**\n\n- $1 \\leq \\mathbf{T} \\leq 100$.\n- $0 \\leq \\mathbf{S}_{\\mathbf{i}} \\leq 1$, for all $i$.\n- $-10^{9} \\leq \\mathbf{X}_{\\mathbf{i}} \\leq 10^{9}$, for all $i$.\n- $0 \\leq \\mathbf{C} \\leq 10^{9}$.\n- $\\mathbf{X}_{\\mathbf{i}} \\neq 0$, for all $i$.\n- All $\\mathbf{X}_{\\mathbf{i}}$ are distinct.\n\n**Test Set 1 (11 Pts, Visible Verdict)**\n\nFor at most 15 cases:\n\n- $1 \\leq \\mathbf{N} \\leq 5000$.\n\nFor the remaining cases:\n\n- $1 \\leq \\mathbf{N} \\leq 100$.\n\n**Test Set 2 (20 Pts, Hidden Verdict)**\n\nFor at most 15 cases:\n\n- $1 \\leq \\mathbf{N} \\leq 10^{5}$.\n\nFor the remaining cases:\n\n- $1 \\leq \\mathbf{N} \\leq 5000$.\n", "locale": "en", "translations": {"en": {"title": "[GCJ 2022 #2] I, O Bot", "background": "", "description": "To welcome attendees to a developers' conference on Jupiter's moon of Io, the organizers inflated many giant beach balls. Each ball is in roughly the shape of either a 1 or a 0, since those look sort of like the letters I and O. The conference just ended, and so now the beach balls need to be cleaned up. Luckily, the beach ball cleanup robot, BALL-E, is on the job!\n\nThe conference was held on an infinite horizontal line, with station 0 in the middle, stations 1, 2, … to the right, and stations $-1, -2, \\ldots$ to the left. Station 0 contains the conference's only beach ball storage warehouse. Each other station contains at most one beach ball.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/88wnnnxw.png)\n\nBALL-E has two storage compartments, each of which can hold a single beach ball. One compartment can only hold 1-shaped balls and the other can only hold 0-shaped balls. (The 1-shaped balls are more oblong than the 0-shaped balls, so neither shape of ball will fit in the other shape's compartment.)\n\nBALL-E initially has both the 0 and 1 compartments empty, and it starts off at station 0. The robot can do the following things:\n\n* Move left one station or right one station. This costs 1 unit of power.\n* If there is a ball at the current station, and BALL-E is not already storing a ball of that shape, it can put the ball in the appropriate compartment. This takes 0 units of power.\n* If there is a ball at the current station, BALL-E can compress it so that its shape becomes the other shape. That is, a 1-shaped ball becomes a 0-shaped ball, or vice versa. It takes $\\mathbf{C}$ units of power to do this. Note that BALL-E may not change the shape of a ball that it has already put into one of its compartments.\n* If BALL-E is at station 0 and is storing at least one ball, it can deposit all balls from its compartment(s) into the beach ball storage warehouse. This takes 0 units of power and leaves both compartments empty.\n\nNotice that if BALL-E moves to a station and there is a ball there, BALL-E is not required to pick it up immediately, even if the robot has an open compartment for it. Also, if BALL-E moves to the station with the warehouse, it is not required to deposit any balls it has.\n\nFind the minimum number of units of power needed for BALL-E to transfer all of the balls to the warehouse, using only the moves described above.", "inputFormat": "The first line of the input gives the number of test cases, $\\mathbf{T}$. $\\mathbf{T}$ test cases follow.\n\nThe first line of each test case contains two integers, $\\mathbf{N}$ and $\\mathbf{C}$: the number of balls and the amount of power units needed to change the shape of a ball, respectively.\n\nThe next $\\mathbf{N}$ lines describe the positions (i.e., station numbers) and the shapes of the balls. The $i$-th line contains two integers, $\\mathbf{X}_{\\mathbf{i}}$ and $\\mathbf{S}_{\\mathbf{i}}$: the position and the shape of the $i$-th ball, respectively.", "outputFormat": "For each test case, output one line containing case # $x$: $y$, where $x$ is the test case number (starting from 1) and $y$ is the minimum number of units of power needed to transfer all of the balls to the warehouse, as described above.", "hint": "**Sample Explanation**\n\nIn Sample Case #1 (illustrated in the statement), there are $\\mathbf{N} = 5$ balls and $\\mathbf{C} = 0$. One optimal strategy is to make three round trips from (and back to) the warehouse:\n\n* First round trip: Move to station 3, pick up the 0 ball there and store it in the 0 compartment, move back to station 0, and deposit the ball in the warehouse. This takes 6 units of power.\n* Second round trip: Move to station 8, pick up the 0 ball there, and store it in the 0 compartment. Move to station 6, change the 0 ball there into a 1 ball, and pick it up and store it in the 1 compartment. Move to station 0 and deposit both balls in the warehouse. This takes 16 units of power. (Recall that in this case, it takes 0 units of power to change a ball's shape.)\n* Third round trip: Move to station 10. Change the 1 ball there into a 0 ball, and pick it up and store it in the 0 compartment. Move to station 15. Pick up the 1 ball there and store it in the 1 compartment. Move to station 0 and deposit both balls in the warehouse. This takes 30 units of power.\n\nThe total number of units of power needed to collect all the balls is 52.\n\nSample Case #2 is like Sample Case #1, but now with $\\mathbf{C} = 10$. Now BALL-E has to use at least 56 units of power:\n\n* First round trip: Get the ball from station 3. This takes 6 units of power.\n* Second round trip: Get the differently-shaped balls from stations 6 and 10. (These are a 0 and a 1, respectively, so there is no need to change the shape of either of them.) This takes 20 units of power.\n* Third round trip: Get the differently-shaped balls from stations 8 and 15. This takes 30 units of power.\n\nSample Case #3 is also like Sample Case #1, but now with $\\mathbf{C} = 1$. Here, BALL-E needs at least 54 units of power:\n\n* First round trip: Get the ball from station 3. This takes 6 units of power.\n* Second round trip: Get the ball from station 8. When passing through station 6 on the way back, change the shape of the ball there and get it. This takes 17 units of power.\n* Third round trip: Do the same with the balls at stations 15 and 10. This takes 31 units of power.\n\nIn Sample Case #4, one optimal strategy is for BALL-E to move to station $-1000000000$, get the 1 ball there, move to station $1000000000$, get the 0 ball there, and then return to station 0 to deposit both of them.\n\n**Limits**\n\n- $1 \\leq \\mathbf{T} \\leq 100$.\n- $0 \\leq \\mathbf{S}_{\\mathbf{i}} \\leq 1$, for all $i$.\n- $-10^{9} \\leq \\mathbf{X}_{\\mathbf{i}} \\leq 10^{9}$, for all $i$.\n- $0 \\leq \\mathbf{C} \\leq 10^{9}$.\n- $\\mathbf{X}_{\\mathbf{i}} \\neq 0$, for all $i$.\n- All $\\mathbf{X}_{\\mathbf{i}}$ are distinct.\n\n**Test Set 1 (11 Pts, Visible Verdict)**\n\nFor at most 15 cases:\n\n- $1 \\leq \\mathbf{N} \\leq 5000$.\n\nFor the remaining cases:\n\n- $1 \\leq \\mathbf{N} \\leq 100$.\n\n**Test Set 2 (20 Pts, Hidden Verdict)**\n\nFor at most 15 cases:\n\n- $1 \\leq \\mathbf{N} \\leq 10^{5}$.\n\nFor the remaining cases:\n\n- $1 \\leq \\mathbf{N} \\leq 5000$.\n", "locale": "en"}, "zh-CN": {"title": "[GCJ 2022 #2] I, O Bot", "background": "", "description": "为了欢迎开发者参加在木星卫星 Io 上举办的会议，主办方充起了许多巨型沙滩球。每个球的形状大致是数字 1 或 0，因为它们看起来有点像字母 I 和 O。会议刚结束，现在需要清理这些沙滩球。幸运的是，沙滩球清理机器人 BALL-E 已经准备就绪！\n\n会议场地是一条无限延伸的水平线，0 号站点位于中央，1、2...号站点在右侧，-1、-2...号站点在左侧。0 号站点设有会议唯一的沙滩球仓库，其他每个站点最多放置一个沙滩球。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/88wnnnxw.png)\n\nBALL-E 有两个存储舱，每个只能容纳一个沙滩球。一个舱专门存放 1 形球，另一个专门存放 0 形球（1 形球比 0 形球更长，因此两种球无法互换舱室）。\n\nBALL-E 初始时两个舱都为空，且位于 0 号站点。机器人可以执行以下操作：\n\n* 向左或向右移动一个站点，消耗 1 单位能量。\n* 若当前站点有球，且 BALL-E 未存储同类型球，可将球放入对应舱室，不消耗能量。\n* 若当前站点有球，可花费 $\\mathbf{C}$ 单位能量将其形状转换（1 形变 0 形，或反之）。注意已存入舱室的球不可转换。\n* 若在 0 号站点且存有球，可将所有球存入仓库，不消耗能量且清空舱室。\n\n注意 BALL-E 移动到有球的站点时不必立即拾取，即使有空闲舱室；移动到仓库站点时也不必立即存球。\n\n请计算 BALL-E 将所有球运到仓库所需的最小能量。", "inputFormat": "第一行输入测试用例数 $\\mathbf{T}$。每个用例包含：\n- 首行两个整数 $\\mathbf{N}$（球的数量）和 $\\mathbf{C}$（转换球形的能量消耗）。\n- 随后 $\\mathbf{N}$ 行，每行两个整数 $\\mathbf{X}_{\\mathbf{i}}$（站点编号）和 $\\mathbf{S}_{\\mathbf{i}}$（球形状，0 或 1）。\n", "outputFormat": "每个用例输出一行 `Case #x: y`，其中 $x$ 为用例编号，$y$ 为最小能量消耗。\n", "hint": "**样例解释**\n\n在样例 #1（题目描述中已图示）中，$\\mathbf{N} = 5$ 个球且 $\\mathbf{C} = 0$。最优策略需要分三趟往返仓库：\n\n* **第一趟**：移动到 3 号站点，拾取那里的 0 形球存入 0 号舱，返回 0 号站点存入仓库。消耗 6 单位能量。\n* **第二趟**：移动到 8 号站点拾取 0 形球，途经 6 号站点时将其 0 形球转换为 1 形球并拾取，返回仓库存入两球。消耗 16 单位能量（注意此时转换不耗能）。\n* **第三趟**：移动到 10 号站点将其 1 形球转换为 0 形球并拾取，再到 15 号站点拾取 1 形球，返回仓库存入。消耗 30 单位能量。  \n总消耗：$6+16+30=52$ 单位能量。\n\n样例 #2 与 #1 类似，但 $\\mathbf{C} = 10$。此时需至少 56 单位能量：\n* 分三次单独收集 (3号)、(6号与10号)、(8号与15号) 的球，避免转换操作。\n\n样例 #3 中 $\\mathbf{C} = 1$，需 54 单位能量：\n* 第一趟：收集 3 号球（6 能量）\n* 第二趟：收集 8 号球，并在返回时转换并拾取 6 号球（17 能量）\n* 第三趟：对 15 号和 10 号球重复类似操作（31 能量）\n\n样例 #4 中，最优策略为：\n1. 移动到 $-10^9$ 号站点拾取 1 形球\n2. 移动到 $10^9$ 号站点拾取 0 形球\n3. 返回仓库  \n总移动距离 $4 \\times 10^9$，故消耗 4000000000 单位能量。\n\n**数据范围**\n- $1 \\leq \\mathbf{T} \\leq 100$\n- 所有坐标绝对值 $\\leq 10^9$\n- 转换能耗 $0 \\leq \\mathbf{C} \\leq 10^9$\n- 保证所有站点坐标非零且不重复\n\n**测试集 1（11 分，可见判定）**\n- 最多 15 个用例：$1 \\leq \\mathbf{N} \\leq 5000$\n- 其余用例：$1 \\leq \\mathbf{N} \\leq 100$\n\n**测试集 2（20 分，隐藏判定）**\n- 最多 15 个用例：$1 \\leq \\mathbf{N} \\leq 10^5$\n- 其余用例：$1 \\leq \\mathbf{N} \\leq 5000$\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P12997", "type": "P", "difficulty": 5, "samples": [["2 4 8\n1 4 3 2\n\n0\n1 4 3 2\n\n1\n2 1 4 3\n\n1", "\n\n1 2 3 2\n\n\n1 2 3 2\n\n\n4 4 4 4"]], "limits": {"time": [20000, 20000, 20000], "memory": [106496, 106496, 106496]}, "tags": ["数学", "2022", "交互题", "Special Judge", "期望", "Google Code Jam"], "title": "[GCJ 2022 #3] Revenge of GoroSort", "background": "", "description": "**In this problem, when something is said to be chosen at random, it means uniformly at random from among all valid possibilities, and independently of any other choice.**\n\nCode Jam contestants once helped the mighty Goro sort an array of integers. (You do not need to read that problem to solve this one.) Once again, Goro needs your help. He has $\\mathbf{N}$ boxes lined up on the table in a single row, numbered 1 through $\\mathbf{N}$ from left to right. Each box has exactly one ball inside. Balls are also numbered 1 through $\\mathbf{N}$. Goro wants ball $i$ to end up in box $i$, for all $i$. That is, he wants to leave the balls in sorted order. Unfortunately, that is not initially the case.\n\nWhen Goro bumps the table with his powerful fists, balls pop up in the air and fall back in boxes. Goro can do this so accurately that exactly one ball falls into each box. A ball may fall into the same box it came out of, or into a different one.\n\nBetter yet, Goro also has the ability to assign colors to boxes before each bump. Then, he can bump the table in such a way that balls coming out of a box of color $c$ always fall into a box of color $c$. As impressive as this accuracy is, Goro does not have any more control than that. Within each color, balls end up assigned to boxes at random.\n\nFor example, suppose the balls appear in the order $1, 4, 3, 6, 5, 2$ (as seen above). He might choose — not necessarily optimally — to give the first box the color red, the second and sixth boxes the color green, and the third through fifth boxes the color blue. Then, after Goro bumps the table,\n\n- The 1 in the first box falls back into the same box, because that is the only red box.\n- The 4 and 2 in the second and sixth boxes remain in place with probability $\\frac{1}{2}$, and switch places with probability $\\frac{1}{2}$.\n- The 3, 6, 5 in the third, fourth, and fifth boxes end up in one of the following orders, each with probability $\\frac{1}{6}$:\n  - $3, 6, 5$\n  - $3, 5, 6$\n  - $6, 3, 5$\n  - $6, 5, 3$\n  - $5, 3, 6$\n  - $5, 6, 3$\n\nSo, for example, the probability of the bump leaving the balls in the order $1, 2, 3, 5, 6, 4$ is $\\frac{1}{12}$. If Goro got this or some other non-sorted result, he would have to designate a set of box colors for the next round, and so on, until he eventually arrives at the sorted $1, 2, 3, 4, 5, 6$. Goro can assign colors to boxes in any way before each bump, regardless of previous assignments.\n\nCan you help Goro implement a better strategy that will efficiently sort the balls? It is guaranteed that the balls start in a random non-sorted order.\n\n### Interactive Protocol\n\nThis is an interactive problem.\n\nInitially, your program should read a single line containing three integers, $T$ $N$ $K$: the number of test cases, the number of boxes per test case, and the total number of bumps allowed for all test cases combined. Then, $T$ test cases must be processed.\n\nEach test case begins with the judge sending one line with $N$ integers, with each integer from 1 to $N$ appearing exactly once, and with the list chosen at random from all non-sorted lists. Then you must engage in a series of interactions with the judge. Each interaction works as follows:\n\n- You send one line of $N$ integers $C_1, C_2, \\ldots, C_N$, in which each integer is between 1 and $N$, inclusive. Each $C_i$ represents that you are assigning color $C_i$ to box $i$ for the next bump. You may choose how many colors there are and how they are numbered, but you must assign a color to each box.\n- The judge simulates the bump as explained in the statement. If this results in the balls being in sorted order:\n    - If this interaction was the $K$-th interaction across all test cases, and this was not the last test case, the judge sends one line with the integer $-1$ and does not output anything further.\n    - Otherwise, the judge sends one line with the integer 1 and then immediately begins the next test case, if there is one. If this was the last test case, your program must exit without error and without sending anything further.\n- Otherwise, the balls are not sorted, and:\n    - If this interaction was the $K$-th across all test cases, or if you provided an invalid line (e.g., too few integers, or color numbers out of range), the judge sends one line with the integer $-1$ and does not output anything further.\n    - If this was not your $K$-th interaction, the judge sends one line with the integer 0, and then another line with $N$ integers, with each integer from 1 to $N$ appearing exactly once, and in non-sorted order, representing the new order of the balls, that is, the $i$-th of these integers is the ball that fell into box $i$. Then you must begin another interaction.\n\nAs usual, if the memory limit is exceeded, or your program gets a runtime error, you will receive the appropriate judgment. Also, if your program continues to wait for the judge after receiving a $-1$, your program will time out, resulting in a Time Limit Exceeded error. Notice that it is your responsibility to have your program exit in time to receive a Wrong Answer judgment instead of a Time Limit Exceeded error.\n\nBe advised that the judge uses the same source of randomness each time, so in the absence of other errors (e.g. Time Limit Exceeded, Memory Limit Exceeded), submitting the exact same code twice will yield the same outcome twice.", "inputFormat": "See Interactive Protocol.", "outputFormat": "See Interactive Protocol.", "hint": "**Sample Explanation**\n\nNote that the sample interaction does not satisfy the constraints of any of the test sets. It is only presented to clarify the input and output format.\n\n**Limits**\n\n- $\\mathbf{T} = 1000$.\n- $\\mathbf{N} = 100$.\n\n**Test Set 1 (8 Pts, Visible Verdict)**\n\n- $\\mathbf{K} = 16500$.\n\n**Test Set 2 (10 Pts, Visible Verdict)**\n\n- $\\mathbf{K} = 12500$.\n\n**Test Set 3 (3 Pts, Visible Verdict)**\n\n- $\\mathbf{K} = 11500$.", "locale": "en", "translations": {"en": {"title": "[GCJ 2022 #3] Revenge of GoroSort", "background": "", "description": "**In this problem, when something is said to be chosen at random, it means uniformly at random from among all valid possibilities, and independently of any other choice.**\n\nCode Jam contestants once helped the mighty Goro sort an array of integers. (You do not need to read that problem to solve this one.) Once again, Goro needs your help. He has $\\mathbf{N}$ boxes lined up on the table in a single row, numbered 1 through $\\mathbf{N}$ from left to right. Each box has exactly one ball inside. Balls are also numbered 1 through $\\mathbf{N}$. Goro wants ball $i$ to end up in box $i$, for all $i$. That is, he wants to leave the balls in sorted order. Unfortunately, that is not initially the case.\n\nWhen Goro bumps the table with his powerful fists, balls pop up in the air and fall back in boxes. Goro can do this so accurately that exactly one ball falls into each box. A ball may fall into the same box it came out of, or into a different one.\n\nBetter yet, Goro also has the ability to assign colors to boxes before each bump. Then, he can bump the table in such a way that balls coming out of a box of color $c$ always fall into a box of color $c$. As impressive as this accuracy is, Goro does not have any more control than that. Within each color, balls end up assigned to boxes at random.\n\nFor example, suppose the balls appear in the order $1, 4, 3, 6, 5, 2$ (as seen above). He might choose — not necessarily optimally — to give the first box the color red, the second and sixth boxes the color green, and the third through fifth boxes the color blue. Then, after Goro bumps the table,\n\n- The 1 in the first box falls back into the same box, because that is the only red box.\n- The 4 and 2 in the second and sixth boxes remain in place with probability $\\frac{1}{2}$, and switch places with probability $\\frac{1}{2}$.\n- The 3, 6, 5 in the third, fourth, and fifth boxes end up in one of the following orders, each with probability $\\frac{1}{6}$:\n  - $3, 6, 5$\n  - $3, 5, 6$\n  - $6, 3, 5$\n  - $6, 5, 3$\n  - $5, 3, 6$\n  - $5, 6, 3$\n\nSo, for example, the probability of the bump leaving the balls in the order $1, 2, 3, 5, 6, 4$ is $\\frac{1}{12}$. If Goro got this or some other non-sorted result, he would have to designate a set of box colors for the next round, and so on, until he eventually arrives at the sorted $1, 2, 3, 4, 5, 6$. Goro can assign colors to boxes in any way before each bump, regardless of previous assignments.\n\nCan you help Goro implement a better strategy that will efficiently sort the balls? It is guaranteed that the balls start in a random non-sorted order.\n\n### Interactive Protocol\n\nThis is an interactive problem.\n\nInitially, your program should read a single line containing three integers, $T$ $N$ $K$: the number of test cases, the number of boxes per test case, and the total number of bumps allowed for all test cases combined. Then, $T$ test cases must be processed.\n\nEach test case begins with the judge sending one line with $N$ integers, with each integer from 1 to $N$ appearing exactly once, and with the list chosen at random from all non-sorted lists. Then you must engage in a series of interactions with the judge. Each interaction works as follows:\n\n- You send one line of $N$ integers $C_1, C_2, \\ldots, C_N$, in which each integer is between 1 and $N$, inclusive. Each $C_i$ represents that you are assigning color $C_i$ to box $i$ for the next bump. You may choose how many colors there are and how they are numbered, but you must assign a color to each box.\n- The judge simulates the bump as explained in the statement. If this results in the balls being in sorted order:\n    - If this interaction was the $K$-th interaction across all test cases, and this was not the last test case, the judge sends one line with the integer $-1$ and does not output anything further.\n    - Otherwise, the judge sends one line with the integer 1 and then immediately begins the next test case, if there is one. If this was the last test case, your program must exit without error and without sending anything further.\n- Otherwise, the balls are not sorted, and:\n    - If this interaction was the $K$-th across all test cases, or if you provided an invalid line (e.g., too few integers, or color numbers out of range), the judge sends one line with the integer $-1$ and does not output anything further.\n    - If this was not your $K$-th interaction, the judge sends one line with the integer 0, and then another line with $N$ integers, with each integer from 1 to $N$ appearing exactly once, and in non-sorted order, representing the new order of the balls, that is, the $i$-th of these integers is the ball that fell into box $i$. Then you must begin another interaction.\n\nAs usual, if the memory limit is exceeded, or your program gets a runtime error, you will receive the appropriate judgment. Also, if your program continues to wait for the judge after receiving a $-1$, your program will time out, resulting in a Time Limit Exceeded error. Notice that it is your responsibility to have your program exit in time to receive a Wrong Answer judgment instead of a Time Limit Exceeded error.\n\nBe advised that the judge uses the same source of randomness each time, so in the absence of other errors (e.g. Time Limit Exceeded, Memory Limit Exceeded), submitting the exact same code twice will yield the same outcome twice.", "inputFormat": "See Interactive Protocol.", "outputFormat": "See Interactive Protocol.", "hint": "**Sample Explanation**\n\nNote that the sample interaction does not satisfy the constraints of any of the test sets. It is only presented to clarify the input and output format.\n\n**Limits**\n\n- $\\mathbf{T} = 1000$.\n- $\\mathbf{N} = 100$.\n\n**Test Set 1 (8 Pts, Visible Verdict)**\n\n- $\\mathbf{K} = 16500$.\n\n**Test Set 2 (10 Pts, Visible Verdict)**\n\n- $\\mathbf{K} = 12500$.\n\n**Test Set 3 (3 Pts, Visible Verdict)**\n\n- $\\mathbf{K} = 11500$.", "locale": "en"}, "zh-CN": {"title": "[GCJ 2022 #3] Revenge of GoroSort", "background": "", "description": "**在本问题中，当提到“随机选择”时，均指从所有有效可能性中均匀随机且独立地选择。**\n\nCode Jam 的参赛者曾帮助强大的 Goro 对一个整数数组进行排序（无需阅读该问题即可解决本题）。现在，Goro 再次需要你的帮助。他有 $\\mathbf{N}$ 个盒子排成一行放在桌子上，从左到右编号为 1 到 $\\mathbf{N}$。每个盒子中恰好有一个球。球的编号也是 1 到 $\\mathbf{N}$。Goro 希望球 $i$ 最终位于盒子 $i$ 中，即他希望将球按顺序排列。然而，初始状态并非如此。\n\n当 Goro 用他强壮的拳头敲击桌子时，球会弹到空中并落回盒子中。Goro 可以精确控制，使得每个盒子恰好落回一个球。球可能落回原来的盒子，也可能落入其他盒子。\n\n更厉害的是，Goro 还能在每次敲击前为盒子分配颜色。然后，他可以以某种方式敲击桌子，使得从颜色为 $c$ 的盒子中弹出的球总是落入颜色为 $c$ 的盒子中。尽管这种控制力令人印象深刻，但 Goro 无法进一步干预——在每个颜色组内，球的分配是完全随机的。\n\n例如，假设球的初始顺序为 $1, 4, 3, 6, 5, 2$（如上所述）。他可能会选择（不一定最优）将第一个盒子设为红色，第二个和第六个盒子设为绿色，第三到第五个盒子设为蓝色。敲击桌子后：\n\n- 第一个盒子中的 1 会落回原盒子，因为这是唯一的红色盒子。\n- 第二个和第六个盒子中的 4 和 2 有 $\\frac{1}{2}$ 的概率保持原位，也有 $\\frac{1}{2}$ 的概率交换位置。\n- 第三、四、五个盒子中的 3、6、5 会以 $\\frac{1}{6}$ 的概率变为以下任意一种顺序：\n  - $3, 6, 5$\n  - $3, 5, 6$\n  - $6, 3, 5$\n  - $6, 5, 3$\n  - $5, 3, 6$\n  - $5, 6, 3$\n\n因此，例如，敲击后球变为 $1, 2, 3, 5, 6, 4$ 的概率是 $\\frac{1}{12}$。如果 Goro 得到这个或其他非排序结果，他需要为下一轮重新分配盒子颜色，直到最终达到排序状态 $1, 2, 3, 4, 5, 6$。Goro 可以在每次敲击前以任意方式分配颜色，不受之前分配的影响。\n\n你能帮助 Goro 实现一种更高效的策略来排序球吗？题目保证球的初始顺序是随机且非排序的。\n\n### 交互协议\n\n这是一个交互式问题。\n\n最初，你的程序应读取一行，包含三个整数 $T$、$N$、$K$：测试用例的数量、每个测试用例的盒子数量以及所有测试用例允许的总敲击次数。然后，需要处理 $T$ 个测试用例。\n\n每个测试用例开始时，评测机会发送一行 $N$ 个整数，每个整数从 1 到 $N$ 恰好出现一次，且列表是从所有非排序列表中随机选择的。之后，你需要与评测机进行一系列交互。每次交互如下：\n\n- 你发送一行 $N$ 个整数 $C_1, C_2, \\ldots, C_N$，每个整数在 1 到 $N$ 之间（含）。$C_i$ 表示你将颜色 $C_i$ 分配给盒子 $i$ 用于下一次敲击。你可以选择颜色的数量和编号方式，但必须为每个盒子分配一个颜色。\n- 评测机模拟敲击过程（如题目描述）。如果敲击后球已排序：\n  - 如果这是所有测试用例中的第 $K$ 次交互，且不是最后一个测试用例，评测机会发送一行整数 $-1$ 并停止输出。\n  - 否则，评测机会发送一行整数 1，并立即开始下一个测试用例（如果有）。如果是最后一个测试用例，你的程序必须无错误退出且不再发送任何内容。\n- 如果球未排序：\n  - 如果这是所有测试用例中的第 $K$ 次交互，或你提供了无效输入（如整数不足、颜色编号越界），评测机会发送一行整数 $-1$ 并停止输出。\n  - 否则，评测机会发送一行整数 0，接着另一行 $N$ 个整数（每个 1 到 $N$ 恰好出现一次且非排序），表示球的新顺序（第 $i$ 个整数是落入盒子 $i$ 的球）。然后你需要开始下一次交互。\n\n通常，如果内存超限或程序运行时错误，你将收到相应的判题结果。此外，如果在收到 $-1$ 后程序仍在等待评测机，将因超时被判为 Time Limit Exceeded。注意，你有责任及时退出程序以避免超时错误。\n\n请注意，评测机每次使用相同的随机源，因此在没有其他错误（如超时、内存超限）的情况下，提交完全相同的代码两次将得到相同的结果。", "inputFormat": "参见交互协议。", "outputFormat": "参见交互协议。", "hint": "**样例解释**\n\n注意，样例交互不满足任何测试集的约束，仅用于说明输入输出格式。\n\n**限制**\n\n- $\\mathbf{T} = 1000$。\n- $\\mathbf{N} = 100$。\n\n**测试集 1（8 分，可见判题结果）**\n\n- $\\mathbf{K} = 16500$。\n\n**测试集 2（10 分，可见判题结果）**\n\n- $\\mathbf{K} = 12500$。\n\n**测试集 3（3 分，可见判题结果）**\n\n- $\\mathbf{K} = 11500$。\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P12998", "type": "P", "difficulty": 5, "samples": [["3\n3 2\n1 1\n1 1\n1 1 2\n5 2\n1 1\n1 2\n1 2 1 2 2\n3 3\n1 2\n1 2\n2 2\n1 1 3", "Case #1: 2\nCase #2: 9\nCase #3: 1"]], "limits": {"time": [20000, 20000, 20000], "memory": [1048576, 1048576, 1048576]}, "tags": ["线段树", "2022", "Google Code Jam"], "title": "[GCJ 2022 #3] Duck, Duck, Geese", "background": "", "description": "In the game \"Duck, Duck, Goose\", all players but one sit on the floor and form a circle. The remaining player walks around the circle calling each player \"duck\" until they select one sitting player and, while touching their head, call them \"goose\" instead. At that point, the goose chases the selecting player and our interest in the game fades.\n\nIn the new game \"Duck, Duck, Geese\", the walking player instead chooses a contiguous subset of at least two (but not all) sitting players to be \"geese\"! Furthermore, each sitting player is wearing a hat. Each hat is one of $\\mathbf{C}$ possible colors, numbered 1 through $\\mathbf{C}$.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0d1hucqa.png)\n\nFor each color $i$, the quantity of selected geese wearing a hat of color $i$ must be either 0 or between $\\mathbf{A}_i$ and $\\mathbf{B}_i$, inclusive.\n\nCan you help count the number of choices that fulfill these requirements? Two choices are considered different if there is some player that is included in one choice but not the other.\n", "inputFormat": "The first line of the input gives the number of test cases, $\\mathbf{T}$. $\\mathbf{T}$ test cases follow. Each test case starts with a line containing two integers $\\mathbf{N}$ and $\\mathbf{C}$: the number of sitting players and hat colors, respectively. Then, $\\mathbf{C}$ lines follow. The $i$-th of these lines contains two integers $\\mathbf{A}_i$ and $\\mathbf{B}_i$, as explained above. The last line of a test case contains $\\mathbf{N}$ integers $\\mathbf{P}_1, \\mathbf{P}_2, \\ldots, \\mathbf{P}_\\mathbf{N}$ representing that the $j$-th sitting player in clockwise order (starting from an arbitrary one) is wearing a hat of color $\\mathbf{P}_j$.\n", "outputFormat": "For each test case, output one line containing `Case #x: y`, where $x$ is the test case number (starting from 1) and $y$ is the number of sets of at least 2 and at most $\\mathbf{N} - 1$ contiguously sitting players that fulfill all the color requirements.", "hint": "**Sample Explanation**\n\nIn Sample Case #1, the total number of players chosen as geese must be 2. There are only three possible ways to select 2 players. The following color configurations are possible: $[1, 1]$, $[1, 2]$, and $[2, 1]$. The first one has two players wearing hats of color 1, so it is not valid, but the other two are valid. Therefore the answer is 2.\n\nSample Case #2 is the one illustrated in the statement, with color 1 being yellow and color 2 being blue. The total number of players chosen as geese in this case must be between 2 and 3, because selecting 4 geese would require at least one color to be out of bounds. For cases with 2 geese, the only requirement is that we do not select 2 geese both wearing hats of color 1; all 5 such selections are valid. If choosing 3 geese, the options are $[1, 2, 1]$, $[2, 1, 2]$, $[1, 2, 2]$, $[2, 2, 1]$, or $[2, 1, 2]$. All but the first one are valid, adding another 4 valid options, for a total of 9.\n\nIn Sample Case #3, notice that there can be hat colors that nobody is wearing. In this case, since there is only 1 player wearing hat color 3 and 1 is not in range, the only valid way is to pick 0 players wearing that hat color.\n\n**Limits**\n\n- $1 \\leq \\mathbf{T} \\leq 100$.\n- $2 \\leq \\mathbf{C} \\leq \\mathbf{N}$.\n- $0 \\leq \\mathbf{A}_i \\leq \\mathbf{B}_i \\leq \\mathbf{N}$, for all $i$.\n- $1 \\leq \\mathbf{P}_j \\leq \\mathbf{C}$, for all $j$.\n\n**Test Set 1 (12 Pts, Visible Verdict)**\n\n- $3 \\leq \\mathbf{N} \\leq 1000$.\n\n**Test Set 2 (13 Pts, Hidden Verdict)**\n\n- $3 \\leq \\mathbf{N} \\leq 10^5$.", "locale": "en", "translations": {"en": {"title": "[GCJ 2022 #3] Duck, Duck, Geese", "background": "", "description": "In the game \"Duck, Duck, Goose\", all players but one sit on the floor and form a circle. The remaining player walks around the circle calling each player \"duck\" until they select one sitting player and, while touching their head, call them \"goose\" instead. At that point, the goose chases the selecting player and our interest in the game fades.\n\nIn the new game \"Duck, Duck, Geese\", the walking player instead chooses a contiguous subset of at least two (but not all) sitting players to be \"geese\"! Furthermore, each sitting player is wearing a hat. Each hat is one of $\\mathbf{C}$ possible colors, numbered 1 through $\\mathbf{C}$.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0d1hucqa.png)\n\nFor each color $i$, the quantity of selected geese wearing a hat of color $i$ must be either 0 or between $\\mathbf{A}_i$ and $\\mathbf{B}_i$, inclusive.\n\nCan you help count the number of choices that fulfill these requirements? Two choices are considered different if there is some player that is included in one choice but not the other.\n", "inputFormat": "The first line of the input gives the number of test cases, $\\mathbf{T}$. $\\mathbf{T}$ test cases follow. Each test case starts with a line containing two integers $\\mathbf{N}$ and $\\mathbf{C}$: the number of sitting players and hat colors, respectively. Then, $\\mathbf{C}$ lines follow. The $i$-th of these lines contains two integers $\\mathbf{A}_i$ and $\\mathbf{B}_i$, as explained above. The last line of a test case contains $\\mathbf{N}$ integers $\\mathbf{P}_1, \\mathbf{P}_2, \\ldots, \\mathbf{P}_\\mathbf{N}$ representing that the $j$-th sitting player in clockwise order (starting from an arbitrary one) is wearing a hat of color $\\mathbf{P}_j$.\n", "outputFormat": "For each test case, output one line containing `Case #x: y`, where $x$ is the test case number (starting from 1) and $y$ is the number of sets of at least 2 and at most $\\mathbf{N} - 1$ contiguously sitting players that fulfill all the color requirements.", "hint": "**Sample Explanation**\n\nIn Sample Case #1, the total number of players chosen as geese must be 2. There are only three possible ways to select 2 players. The following color configurations are possible: $[1, 1]$, $[1, 2]$, and $[2, 1]$. The first one has two players wearing hats of color 1, so it is not valid, but the other two are valid. Therefore the answer is 2.\n\nSample Case #2 is the one illustrated in the statement, with color 1 being yellow and color 2 being blue. The total number of players chosen as geese in this case must be between 2 and 3, because selecting 4 geese would require at least one color to be out of bounds. For cases with 2 geese, the only requirement is that we do not select 2 geese both wearing hats of color 1; all 5 such selections are valid. If choosing 3 geese, the options are $[1, 2, 1]$, $[2, 1, 2]$, $[1, 2, 2]$, $[2, 2, 1]$, or $[2, 1, 2]$. All but the first one are valid, adding another 4 valid options, for a total of 9.\n\nIn Sample Case #3, notice that there can be hat colors that nobody is wearing. In this case, since there is only 1 player wearing hat color 3 and 1 is not in range, the only valid way is to pick 0 players wearing that hat color.\n\n**Limits**\n\n- $1 \\leq \\mathbf{T} \\leq 100$.\n- $2 \\leq \\mathbf{C} \\leq \\mathbf{N}$.\n- $0 \\leq \\mathbf{A}_i \\leq \\mathbf{B}_i \\leq \\mathbf{N}$, for all $i$.\n- $1 \\leq \\mathbf{P}_j \\leq \\mathbf{C}$, for all $j$.\n\n**Test Set 1 (12 Pts, Visible Verdict)**\n\n- $3 \\leq \\mathbf{N} \\leq 1000$.\n\n**Test Set 2 (13 Pts, Hidden Verdict)**\n\n- $3 \\leq \\mathbf{N} \\leq 10^5$.", "locale": "en"}, "zh-CN": {"title": "[GCJ 2022 #3] Duck, Duck, Geese", "background": "", "description": "在游戏 \"Duck, Duck, Goose\" 中，除一名玩家外，其余玩家坐在地板上围成一个圈。剩下的玩家绕着圈走，依次称呼每个坐着的玩家为 \"duck\"，直到他们选择一名坐着的玩家，轻拍其头部并称其为 \"goose\"。此时，\"goose\" 会追逐选择者，而我们对游戏的兴趣就此消失。\n\n在新游戏 \"Duck, Duck, Geese\" 中，行走的玩家改为选择一个连续的、至少包含两名（但非全部）坐着的玩家作为 \"geese\"！此外，每名坐着的玩家都戴着一顶帽子。每顶帽子是 $\\mathbf{C}$ 种可能颜色中的一种，编号为 1 到 $\\mathbf{C}$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0d1hucqa.png)\n\n对于每种颜色 $i$，被选为 \"geese\" 的玩家中戴颜色 $i$ 帽子的数量必须为 0，或在 $\\mathbf{A}_i$ 和 $\\mathbf{B}_i$ 之间（含端点）。\n\n你能帮忙计算满足这些要求的选择数量吗？如果某个玩家在一个选择中被包含而在另一个选择中未被包含，则这两个选择被视为不同。", "inputFormat": "输入的第一行给出测试用例的数量 $\\mathbf{T}$。随后是 $\\mathbf{T}$ 个测试用例。每个测试用例的第一行包含两个整数 $\\mathbf{N}$ 和 $\\mathbf{C}$：分别表示坐着的玩家数量和帽子颜色数量。接下来是 $\\mathbf{C}$ 行，第 $i$ 行包含两个整数 $\\mathbf{A}_i$ 和 $\\mathbf{B}_i$，如上所述。每个测试用例的最后一行包含 $\\mathbf{N}$ 个整数 $\\mathbf{P}_1, \\mathbf{P}_2, \\ldots, \\mathbf{P}_\\mathbf{N}$，表示按顺时针方向（从任意一个玩家开始）的第 $j$ 名坐着的玩家戴的帽子颜色为 $\\mathbf{P}_j$。\n", "outputFormat": "对于每个测试用例，输出一行 `Case #x: y`，其中 $x$ 是测试用例编号（从 1 开始），$y$ 是满足所有颜色要求的、连续坐着的玩家集合的数量（集合大小至少为 2，最多为 $\\mathbf{N} - 1$）。\n", "hint": "**样例解释**\n\n在样例 #1 中，被选为 \"geese\" 的玩家总数必须为 2。只有三种选择 2 名玩家的方式。可能的帽子颜色配置为：$[1, 1]$、$[1, 2]$ 和 $[2, 1]$。第一种有两名玩家戴颜色 1 的帽子，因此无效，但后两种有效。因此答案为 2。\n\n样例 #2 是题目描述中图示的情况，颜色 1 为黄色，颜色 2 为蓝色。此时被选为 \"geese\" 的玩家总数必须在 2 到 3 之间，因为选择 4 名 \"geese\" 会导致至少一种颜色超出范围。对于选择 2 名 \"geese\" 的情况，唯一的要求是不能选择两名都戴颜色 1 帽子的玩家；所有 5 种此类选择均有效。如果选择 3 名 \"geese\"，选项为 $[1, 2, 1]$、$[2, 1, 2]$、$[1, 2, 2]$、$[2, 2, 1]$ 或 $[2, 1, 2]$。除第一种外，其余均有效，因此又增加了 4 种有效选项，总计 9 种。\n\n在样例 #3 中，注意可能存在无人佩戴的帽子颜色。由于只有一名玩家戴颜色 3 的帽子，而 1 不在范围内，因此唯一有效的方式是选择 0 名戴该颜色帽子的玩家。\n\n**限制**\n\n- $1 \\leq \\mathbf{T} \\leq 100$。\n- $2 \\leq \\mathbf{C} \\leq \\mathbf{N}$。\n- 对于所有 $i$，$0 \\leq \\mathbf{A}_i \\leq \\mathbf{B}_i \\leq \\mathbf{N}$。\n- 对于所有 $j$，$1 \\leq \\mathbf{P}_j \\leq \\mathbf{C}$。\n\n**测试集 1（12 分，可见判题结果）**\n\n- $3 \\leq \\mathbf{N} \\leq 1000$。\n\n**测试集 2（13 分，隐藏判题结果）**\n\n- $3 \\leq \\mathbf{N} \\leq 10^5$。\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P12999", "type": "P", "difficulty": 5, "samples": [["4\n3\n2 1 1\n3 3 2\n6\n3 1 4 1 2 3\n5 3 5 2 4 5\n20\n2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 1 1\n3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 20 2\n19\n2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 1 1\n3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 19 3", "Case #1: IMPOSSIBLE\nCase #2: TSHIRT\nCase #3: HCJKSHCJKSHCJKSHCJKS\nCase #4: CODEJAMROCKSTHEMOST"]], "limits": {"time": [20000, 20000, 45000], "memory": [1048576, 1048576, 1048576]}, "tags": ["贪心", "2022", "Special Judge", "拓扑排序", "Google Code Jam"], "title": "[GCJ 2022 #3] Mascot Maze", "background": "", "description": "The Google Coding Competitions team is setting up a new theme park. As in any good theme park, we want to have actors dressed up as mascots to interact with visitors. Because we are in a rush to open, we decided to use the letters from CODE JAM, KICK START, and HASH CODE as mascots, for a total of 13 different mascots (the letters `ACDEHIJKMORST`).\n\nThe park's only attraction is a maze that has a set of $\\mathbf{N}$ rooms numbered from 1 to $\\mathbf{N}$. Each room has a left exit and a right exit. Each exit takes the visitor to another room. Exits cannot be used in reverse; for example, if room 2 has an exit to room 3, you cannot go back from room 3 to room 2 unless room 3 also happens to have an exit to room 2.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/8fuhdtgj.png)\n\nWe want to place exactly one of our 13 mascots in each room. Each letter may be present in zero, one, or more rooms of the maze. To increase variety, we want to place mascots so that any three (not necessarily distinct) rooms that a visitor can visit consecutively have three different mascots.\n\nCan you help us choose a mascot for each room such that this goal is met, or let us know that it cannot be done?\n", "inputFormat": "The first line of the input gives the number of test cases, $\\mathbf{T}$. $\\mathbf{T}$ test cases follow. Each test case consists of 3 lines. The first line contains a single integer $\\mathbf{N}$, representing the number of rooms in the maze. The second line contains $\\mathbf{N}$ integers $\\mathbf{L}_1, \\mathbf{L}_2, \\ldots, \\mathbf{L}_\\mathbf{N}$, representing that the left exit from room $i$ leads to room $\\mathbf{L}_i$. The third and last line contains $\\mathbf{N}$ integers $\\mathbf{R}_1, \\mathbf{R}_2, \\ldots, \\mathbf{R}_\\mathbf{N}$, representing that the right exit from room $i$ leads to room $\\mathbf{R}_i$.\n", "outputFormat": "For each test case, output one line containing `Case #x: y`, where $x$ is the test case number (starting from 1) and $y$ is `IMPOSSIBLE` if there is no way to assign mascots while obeying the rules explained above. Otherwise, $y$ is an $\\mathbf{N}$ character long string. The $i$-th character of $y$ should be an uppercase letter from the set `ACDEHIJKMORST`, representing that you wish to assign that mascot to the $i$-th room.", "hint": "**Sample Explanation**\n\nSample Case #1 is the image in the problem statement. It is possible to visit rooms 1, 2, and 1 consecutively (which visits room 1 twice), so the case is impossible.\n\nSample Case #2 has the following layout (blue arrows represent the left exits and red arrows represent the right exits):\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ykiviiry.png)\n\nOne of many valid answers is to assign mascots as indicated. Notice that although we do not need to assign two $\\tau$ mascots in this case, we have done so in a way that does not break the rules.\n\nSample Cases #3 and #4 are possible, but require the use of multiple copies of some mascots.\n\n**Limits**\n\n- $1 \\leq \\mathbf{T} \\leq 100$.\n- $\\mathbf{L}_i \\neq i$, for all $i$. $\\mathbf{R}_i \\neq i$, for all $i$. $1 \\leq \\mathbf{L}_i < \\mathbf{R}_i \\leq \\mathbf{N}$, for all $i$.\n\n**Test Set 1 (12 Pts, Visible Verdict)**\n\n- Time limit: 20 seconds.\n- $3 \\leq \\mathbf{N} \\leq 100$.\n\n**Test Set 2 (13 Pts, Hidden Verdict)**\n\n- Time limit: 45 seconds.\n- $3 \\leq \\mathbf{N} \\leq 10^5$.", "locale": "en", "translations": {"en": {"title": "[GCJ 2022 #3] Mascot Maze", "background": "", "description": "The Google Coding Competitions team is setting up a new theme park. As in any good theme park, we want to have actors dressed up as mascots to interact with visitors. Because we are in a rush to open, we decided to use the letters from CODE JAM, KICK START, and HASH CODE as mascots, for a total of 13 different mascots (the letters `ACDEHIJKMORST`).\n\nThe park's only attraction is a maze that has a set of $\\mathbf{N}$ rooms numbered from 1 to $\\mathbf{N}$. Each room has a left exit and a right exit. Each exit takes the visitor to another room. Exits cannot be used in reverse; for example, if room 2 has an exit to room 3, you cannot go back from room 3 to room 2 unless room 3 also happens to have an exit to room 2.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/8fuhdtgj.png)\n\nWe want to place exactly one of our 13 mascots in each room. Each letter may be present in zero, one, or more rooms of the maze. To increase variety, we want to place mascots so that any three (not necessarily distinct) rooms that a visitor can visit consecutively have three different mascots.\n\nCan you help us choose a mascot for each room such that this goal is met, or let us know that it cannot be done?\n", "inputFormat": "The first line of the input gives the number of test cases, $\\mathbf{T}$. $\\mathbf{T}$ test cases follow. Each test case consists of 3 lines. The first line contains a single integer $\\mathbf{N}$, representing the number of rooms in the maze. The second line contains $\\mathbf{N}$ integers $\\mathbf{L}_1, \\mathbf{L}_2, \\ldots, \\mathbf{L}_\\mathbf{N}$, representing that the left exit from room $i$ leads to room $\\mathbf{L}_i$. The third and last line contains $\\mathbf{N}$ integers $\\mathbf{R}_1, \\mathbf{R}_2, \\ldots, \\mathbf{R}_\\mathbf{N}$, representing that the right exit from room $i$ leads to room $\\mathbf{R}_i$.\n", "outputFormat": "For each test case, output one line containing `Case #x: y`, where $x$ is the test case number (starting from 1) and $y$ is `IMPOSSIBLE` if there is no way to assign mascots while obeying the rules explained above. Otherwise, $y$ is an $\\mathbf{N}$ character long string. The $i$-th character of $y$ should be an uppercase letter from the set `ACDEHIJKMORST`, representing that you wish to assign that mascot to the $i$-th room.", "hint": "**Sample Explanation**\n\nSample Case #1 is the image in the problem statement. It is possible to visit rooms 1, 2, and 1 consecutively (which visits room 1 twice), so the case is impossible.\n\nSample Case #2 has the following layout (blue arrows represent the left exits and red arrows represent the right exits):\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ykiviiry.png)\n\nOne of many valid answers is to assign mascots as indicated. Notice that although we do not need to assign two $\\tau$ mascots in this case, we have done so in a way that does not break the rules.\n\nSample Cases #3 and #4 are possible, but require the use of multiple copies of some mascots.\n\n**Limits**\n\n- $1 \\leq \\mathbf{T} \\leq 100$.\n- $\\mathbf{L}_i \\neq i$, for all $i$. $\\mathbf{R}_i \\neq i$, for all $i$. $1 \\leq \\mathbf{L}_i < \\mathbf{R}_i \\leq \\mathbf{N}$, for all $i$.\n\n**Test Set 1 (12 Pts, Visible Verdict)**\n\n- Time limit: 20 seconds.\n- $3 \\leq \\mathbf{N} \\leq 100$.\n\n**Test Set 2 (13 Pts, Hidden Verdict)**\n\n- Time limit: 45 seconds.\n- $3 \\leq \\mathbf{N} \\leq 10^5$.", "locale": "en"}, "zh-CN": {"title": "[GCJ 2022 #3] Mascot Maze", "background": "", "description": "Google 编程竞赛团队正在筹建一个新的主题公园。和所有优秀的主题公园一样，我们希望让演员装扮成吉祥物与游客互动。由于开业在即，我们决定使用 CODE JAM、KICK START 和 HASH CODE 中的字母作为吉祥物，共计 13 种不同的吉祥物（字母 `ACDEHIJKMORST`）。\n\n公园唯一的景点是一个由 $\\mathbf{N}$ 个房间组成的迷宫，房间编号从 1 到 $\\mathbf{N}$。每个房间都有一个左出口和一个右出口。每个出口会将游客带到另一个房间。出口不能反向使用；例如，如果房间 2 有一个出口通向房间 3，你不能从房间 3 返回到房间 2，除非房间 3 恰好也有一个出口通向房间 2。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/8fuhdtgj.png)\n\n我们希望在每个房间放置恰好一个这 13 种吉祥物。每个字母可以在迷宫的零个、一个或多个房间中出现。为了增加多样性，我们希望这样放置吉祥物：游客连续访问的任意三个（不一定不同）房间中的吉祥物必须互不相同。\n\n你能帮助我们为每个房间选择一个吉祥物来满足这一目标吗？或者告诉我们这是不可能实现的？\n", "inputFormat": "输入的第一行给出测试用例的数量 $\\mathbf{T}$。随后是 $\\mathbf{T}$ 个测试用例。每个测试用例包含 3 行。第一行是一个整数 $\\mathbf{N}$，表示迷宫中的房间数量。第二行包含 $\\mathbf{N}$ 个整数 $\\mathbf{L}_1, \\mathbf{L}_2, \\ldots, \\mathbf{L}_\\mathbf{N}$，表示房间 $i$ 的左出口通向房间 $\\mathbf{L}_i$。第三行包含 $\\mathbf{N}$ 个整数 $\\mathbf{R}_1, \\mathbf{R}_2, \\ldots, \\mathbf{R}_\\mathbf{N}$，表示房间 $i$ 的右出口通向房间 $\\mathbf{R}_i$。\n", "outputFormat": "对于每个测试用例，输出一行 `Case #x: y`，其中 $x$ 是测试用例编号（从 1 开始），$y$ 是 `IMPOSSIBLE`（如果无法按照上述规则分配吉祥物）。否则，$y$ 是一个长度为 $\\mathbf{N}$ 的字符串，其第 $i$ 个字符是大写字母 `ACDEHIJKMORST` 中的一个，表示你希望分配给第 $i$ 个房间的吉祥物。\n", "hint": "**样例解释**\n\n样例 #1 对应题目描述中的图片。游客可以连续访问房间 1、2、1（其中房间 1 被访问两次），因此这种情况不可能满足要求。\n\n样例 #2 的布局如下（蓝色箭头表示左出口，红色箭头表示右出口）：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ykiviiry.png)\n\n众多有效解之一如输出所示。注意虽然我们不需要分配两个 $\\tau$ 吉祥物，但当前的分配方式不会违反规则。\n\n样例 #3 和 #4 是可行的，但需要重复使用某些吉祥物。\n\n**限制**\n\n- $1 \\leq \\mathbf{T} \\leq 100$。\n- 对于所有 $i$，$\\mathbf{L}_i \\neq i$ 且 $\\mathbf{R}_i \\neq i$。\n- 对于所有 $i$，$1 \\leq \\mathbf{L}_i < \\mathbf{R}_i \\leq \\mathbf{N}$。\n\n**测试集 1（12 分，可见判题结果）**\n\n- 时间限制：20 秒。\n- $3 \\leq \\mathbf{N} \\leq 100$。\n\n**测试集 2（13 分，隐藏判题结果）**\n\n- 时间限制：45 秒。\n- $3 \\leq \\mathbf{N} \\leq 10^5$。\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P13000", "type": "P", "difficulty": 7, "samples": [["2\n3\n\n\n\n1\n1\n3\n\n\n4\n\n\n\n2\n3\n2 1 3\n\n\n2\n2 3\n\n\n-1", "\n\n\n1 2\n1 3\n\n\n\n2\n1 2\n\n1 2\n2 3\n2 4\n\n\n\n1\n4\n\n\n1\n1"]], "limits": {"time": [60000, 60000], "memory": [1048576, 1048576]}, "tags": ["模拟", "博弈论", "2022", "交互题", "Special Judge", "构造", "分类讨论", "SG 函数", "Google Code Jam"], "title": "[GCJ 2022 #3] Win As Second\t", "background": "", "description": "Ueli and Vreni are playing a game. The game's board is a tree with $\\mathbf{N}$ vertices, all initially colored blue. They alternate turns, with Ueli going first. In each turn, a player must choose a blue vertex, together with any subset (possibly none or all) of its blue neighbors, and color all those vertices red. If at the start of a players' turn, all vertices are red, then that player loses the game and the other player wins the game.\n\nIn the example game below, Ueli colored vertex 3 red in their first turn. Then, Vreni chose vertex 2 for their turn and colored both it and its neighbor (vertex 1) red. Because all vertices are now red, Ueli loses and Vreni wins.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xw0xc7is.png)\n\nUeli and Vreni have noticed that it is much easier for Ueli to win this game because he has the first turn. Therefore they have adopted the following procedure: first, Ueli chooses an integer $\\mathbf{N}$. Then, Vreni chooses any tree with $\\mathbf{N}$ vertices. And then they start playing as described above, with Ueli taking the first turn.\n\nVreni is hopeful that being able to choose the tree can help her overcome the disadvantage of going second. Can you demonstrate how Vreni can win games in this setup?\n\n### Interactive Protocol\n\nThis is an interactive problem. You should make sure you have read the information in the Interactive Problems section of our FAQ.\n\nInitially, your program should read a single line containing an integer, $\\mathbf{T}$, the number of test cases. Then, $\\mathbf{T}$ test cases must be processed.\n\nFor each test case, your program must first read a line containing a single integer $\\mathbf{N}$, the number of vertices that Ueli has chosen. Then, your program must output $\\mathbf{N}-1$ lines describing the edges of the tree Vreni should choose. The nodes of the tree are numbered 1 through $\\mathbf{N}$. Each line must represent a distinct edge of the tree with 2 integers between 1 and $\\mathbf{N}$: the two vertices the edge connects. The edges must represent a tree. The two integers within a line may be in either order, and the $\\mathbf{N}-1$ lines themselves may be in any order.\n\nAfter that, your program must read a line containing a single integer $\\mathbf{M}$, the number of games that you need to play on this tree. These games are played independently; in other words, all vertices of the tree are blue at the start of each game.\n\nFor each of the $\\mathbf{M}$ games, you need to process some number of exchanges until the game is over. Each exchange consists of a turn from each player.\n\nFor each exchange, your program must read two lines describing Ueli's turn first. The first of those lines will contain an integer $\\mathbf{K}$, denoting the number of blue vertices to be colored red. The second of those lines will contain $\\mathbf{K}$ distinct integers $\\mathbf{A}_1, \\mathbf{A}_2, \\ldots, \\mathbf{A}_\\mathbf{K}$ describing the blue vertices to be colored red. $\\mathbf{K}$ will be at least 1, and each $\\mathbf{A}_i$ will be between 1 and $\\mathbf{N}$, inclusive. Vertices $\\mathbf{A}_2, \\mathbf{A}_3, \\ldots, \\mathbf{A}_\\mathbf{K}$ will all be neighbors of vertex $\\mathbf{A}_1$.\n\nAfter that, your program must output Vreni's choice for their turn in the same format: the first line with the number of blue vertices to be colored red, followed by the second line with the numbers of those vertices, in such an order that all vertices except the first one are neighbors of the first one.\n\nIf all vertices are red after Vreni's turn, it means that Vreni has won and this game is over. The next game starts immediately if there is one. If this was the last game for this test case, then the next test case starts immediately if there is one. If this was the last test case, the judge will send no further input to your program, and the program must send no further output.\n\nOn the other hand, if all vertices are red after Ueli's move, it means that Vreni has lost and therefore your program did not pass the test case. In this case, instead of starting a new exchange by printing the last move that colors all remaining blue vertices red, the judge will print a single number -1 and will not print any further output, and will not process any further games or test cases.\n\nIf the judge receives an invalidly formatted or invalid line (like outputting an unexpected number of integers, or integers out of range, or outputting a set of edges that do not form a tree, or trying to color a vertex that is already red, or trying to color a vertex that is not a neighbor of the first vertex colored in this turn) from your program at any moment, the judge will also print a single number -1 and will not print any further output. If your program continues to wait for the judge after receiving a -1, your program will time out, resulting in a Time Limit Exceeded error. Notice that it is your responsibility to have your program exit in time to receive a Wrong Answer judgment instead of a Time Limit Exceeded error. As usual, if the memory limit is exceeded, or your program gets a runtime error, you will receive the appropriate judgment.\n\nThe judge is deterministic. In other words, if you make two attempts that print the same numbers, you will get the same inputs from the judge. However, of course the judge can make different moves in different games on the same tree.", "inputFormat": "See Interactive Protocol.", "outputFormat": "See Interactive Protocol.", "hint": "Note that the sample interaction does not satisfy the constraints of either test set, as its $\\mathbf{N}$ values are too small. It is only presented to clarify the input and output format.\n\nBelow is an illustration of Case #2, Game #1 at the beginning and after each turn:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cccz3vlj.png)\n\nBelow is an illustration of Case #2, Game #2 at the beginning and after each turn:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0b2qkj8q.png)\n\n**Limits**\n\n- $1 \\leq \\mathbf{M} \\leq 50.$\n\n**Test Set 1 (13 Pts, Visible Verdict)**\n\n- $\\mathbf{T}=1$.\n- $\\mathbf{N}=30$.\n\n**Test Set 2 (Hidden Verdict)**\n\n- $1 \\leq \\mathbf{T} \\leq 10.$\n- $31 \\leq \\mathbf{N} \\leq 40.$\n- No two test cases use the same value of $\\mathbf{N}$.", "locale": "en", "translations": {"en": {"title": "[GCJ 2022 #3] Win As Second\t", "background": "", "description": "Ueli and Vreni are playing a game. The game's board is a tree with $\\mathbf{N}$ vertices, all initially colored blue. They alternate turns, with Ueli going first. In each turn, a player must choose a blue vertex, together with any subset (possibly none or all) of its blue neighbors, and color all those vertices red. If at the start of a players' turn, all vertices are red, then that player loses the game and the other player wins the game.\n\nIn the example game below, Ueli colored vertex 3 red in their first turn. Then, Vreni chose vertex 2 for their turn and colored both it and its neighbor (vertex 1) red. Because all vertices are now red, Ueli loses and Vreni wins.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xw0xc7is.png)\n\nUeli and Vreni have noticed that it is much easier for Ueli to win this game because he has the first turn. Therefore they have adopted the following procedure: first, Ueli chooses an integer $\\mathbf{N}$. Then, Vreni chooses any tree with $\\mathbf{N}$ vertices. And then they start playing as described above, with Ueli taking the first turn.\n\nVreni is hopeful that being able to choose the tree can help her overcome the disadvantage of going second. Can you demonstrate how Vreni can win games in this setup?\n\n### Interactive Protocol\n\nThis is an interactive problem. You should make sure you have read the information in the Interactive Problems section of our FAQ.\n\nInitially, your program should read a single line containing an integer, $\\mathbf{T}$, the number of test cases. Then, $\\mathbf{T}$ test cases must be processed.\n\nFor each test case, your program must first read a line containing a single integer $\\mathbf{N}$, the number of vertices that Ueli has chosen. Then, your program must output $\\mathbf{N}-1$ lines describing the edges of the tree Vreni should choose. The nodes of the tree are numbered 1 through $\\mathbf{N}$. Each line must represent a distinct edge of the tree with 2 integers between 1 and $\\mathbf{N}$: the two vertices the edge connects. The edges must represent a tree. The two integers within a line may be in either order, and the $\\mathbf{N}-1$ lines themselves may be in any order.\n\nAfter that, your program must read a line containing a single integer $\\mathbf{M}$, the number of games that you need to play on this tree. These games are played independently; in other words, all vertices of the tree are blue at the start of each game.\n\nFor each of the $\\mathbf{M}$ games, you need to process some number of exchanges until the game is over. Each exchange consists of a turn from each player.\n\nFor each exchange, your program must read two lines describing Ueli's turn first. The first of those lines will contain an integer $\\mathbf{K}$, denoting the number of blue vertices to be colored red. The second of those lines will contain $\\mathbf{K}$ distinct integers $\\mathbf{A}_1, \\mathbf{A}_2, \\ldots, \\mathbf{A}_\\mathbf{K}$ describing the blue vertices to be colored red. $\\mathbf{K}$ will be at least 1, and each $\\mathbf{A}_i$ will be between 1 and $\\mathbf{N}$, inclusive. Vertices $\\mathbf{A}_2, \\mathbf{A}_3, \\ldots, \\mathbf{A}_\\mathbf{K}$ will all be neighbors of vertex $\\mathbf{A}_1$.\n\nAfter that, your program must output Vreni's choice for their turn in the same format: the first line with the number of blue vertices to be colored red, followed by the second line with the numbers of those vertices, in such an order that all vertices except the first one are neighbors of the first one.\n\nIf all vertices are red after Vreni's turn, it means that Vreni has won and this game is over. The next game starts immediately if there is one. If this was the last game for this test case, then the next test case starts immediately if there is one. If this was the last test case, the judge will send no further input to your program, and the program must send no further output.\n\nOn the other hand, if all vertices are red after Ueli's move, it means that Vreni has lost and therefore your program did not pass the test case. In this case, instead of starting a new exchange by printing the last move that colors all remaining blue vertices red, the judge will print a single number -1 and will not print any further output, and will not process any further games or test cases.\n\nIf the judge receives an invalidly formatted or invalid line (like outputting an unexpected number of integers, or integers out of range, or outputting a set of edges that do not form a tree, or trying to color a vertex that is already red, or trying to color a vertex that is not a neighbor of the first vertex colored in this turn) from your program at any moment, the judge will also print a single number -1 and will not print any further output. If your program continues to wait for the judge after receiving a -1, your program will time out, resulting in a Time Limit Exceeded error. Notice that it is your responsibility to have your program exit in time to receive a Wrong Answer judgment instead of a Time Limit Exceeded error. As usual, if the memory limit is exceeded, or your program gets a runtime error, you will receive the appropriate judgment.\n\nThe judge is deterministic. In other words, if you make two attempts that print the same numbers, you will get the same inputs from the judge. However, of course the judge can make different moves in different games on the same tree.", "inputFormat": "See Interactive Protocol.", "outputFormat": "See Interactive Protocol.", "hint": "Note that the sample interaction does not satisfy the constraints of either test set, as its $\\mathbf{N}$ values are too small. It is only presented to clarify the input and output format.\n\nBelow is an illustration of Case #2, Game #1 at the beginning and after each turn:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cccz3vlj.png)\n\nBelow is an illustration of Case #2, Game #2 at the beginning and after each turn:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0b2qkj8q.png)\n\n**Limits**\n\n- $1 \\leq \\mathbf{M} \\leq 50.$\n\n**Test Set 1 (13 Pts, Visible Verdict)**\n\n- $\\mathbf{T}=1$.\n- $\\mathbf{N}=30$.\n\n**Test Set 2 (Hidden Verdict)**\n\n- $1 \\leq \\mathbf{T} \\leq 10.$\n- $31 \\leq \\mathbf{N} \\leq 40.$\n- No two test cases use the same value of $\\mathbf{N}$.", "locale": "en"}, "zh-CN": {"title": "[GCJ 2022 #3] Win As Second", "background": "", "description": "Ueli 和 Vreni 正在玩一个游戏。游戏棋盘是一棵有 $\\mathbf{N}$ 个顶点的树，初始所有顶点都是蓝色的。两人轮流操作，Ueli 先手。在每个回合中，玩家必须选择一个蓝色顶点及其任意数量（可以是零个或全部）的蓝色邻居顶点，并将这些顶点全部染红。如果在某个玩家的回合开始时所有顶点都是红色，则该玩家输掉游戏，另一方获胜。\n\n在下面的示例游戏中，Ueli 在第一回合将顶点 3 染红。然后，Vreni 选择顶点 2 并在她的回合中将其及其邻居（顶点 1）染红。由于所有顶点都已变红，Ueli 输掉游戏，Vreni 获胜。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xw0xc7is.png)\n\nUeli 和 Vreni 注意到，由于 Ueli 先手，他更容易获胜。因此他们采用了以下规则：首先，Ueli 选择一个整数 $\\mathbf{N}$；然后，Vreni 选择任意一棵有 $\\mathbf{N}$ 个顶点的树；接着他们按照上述规则开始游戏，Ueli 先手。\n\nVreni 希望通过选择树的结构来克服后手的劣势。你能展示 Vreni 如何在这种设定下获胜吗？\n\n### 交互协议\n\n这是一个交互式问题。请确保你已阅读常见问题中关于交互式问题的部分。\n\n开始时，你的程序应读取一个整数 $\\mathbf{T}$，表示测试用例的数量。然后处理 $\\mathbf{T}$ 个测试用例。\n\n对于每个测试用例，你的程序首先读取一个整数 $\\mathbf{N}$，表示 Ueli 选择的顶点数量。然后，你的程序需要输出 $\\mathbf{N}-1$ 行来描述 Vreni 应选择的树结构。树的顶点编号为 1 到 $\\mathbf{N}$。每行表示树的一条边，包含两个 1 到 $\\mathbf{N}$ 的整数，表示该边连接的两个顶点。这些边必须构成一棵树。每行中的两个整数顺序不限，$\\mathbf{N}-1$ 行的顺序也不限。\n\n之后，你的程序需要读取一个整数 $\\mathbf{M}$，表示需要在该树上进行的游戏数量。这些游戏是独立的，即每局游戏开始时所有顶点均为蓝色。\n\n对于每局游戏，你需要处理若干轮交互，直到游戏结束。每轮交互包含双方各一个回合。\n\n对于每轮交互，你的程序首先读取两行描述 Ueli 的回合。第一行是一个整数 $\\mathbf{K}$，表示要染红的蓝色顶点数量。第二行包含 $\\mathbf{K}$ 个互不相同的整数 $\\mathbf{A}_1, \\mathbf{A}_2, \\ldots, \\mathbf{A}_\\mathbf{K}$，表示要染红的蓝色顶点。$\\mathbf{K}$ 至少为 1，每个 $\\mathbf{A}_i$ 在 1 到 $\\mathbf{N}$ 之间。顶点 $\\mathbf{A}_2, \\mathbf{A}_3, \\ldots, \\mathbf{A}_\\mathbf{K}$ 都必须是 $\\mathbf{A}_1$ 的邻居。\n\n然后，你的程序需要以相同格式输出 Vreni 的回合选择：第一行输出要染红的蓝色顶点数量，第二行输出这些顶点的编号，且除第一个顶点外，其他顶点都必须是第一个顶点的邻居。\n\n如果 Vreni 的回合后所有顶点变红，则 Vreni 获胜，该局游戏结束。如果有下一局游戏，则立即开始；如果是该测试用例的最后一局游戏，则立即开始下一个测试用例（如果有）；如果是最后一个测试用例，评测机将不再发送输入，你的程序也不应再输出。\n\n如果在 Ueli 的回合后所有顶点已变红，则 Vreni 输掉游戏，你的程序未通过该测试用例。此时，评测机会输出 -1 并不再处理后续输入，你的程序应适时退出。\n\n如果评测机在任何时刻收到无效输入或输出（如格式错误、越界整数、非树结构的边、试图染红已为红色的顶点或不符合邻居条件的顶点），评测机也会输出 -1 并终止交互。若你的程序在收到 -1 后仍等待输入，将因超时而判为 Time Limit Exceeded。请注意，你有责任确保程序及时退出以避免超时错误。\n\n评测机的行为是确定性的。即相同的输出会得到相同的输入。但同一棵树上的不同游戏可能会有不同操作。", "inputFormat": "参见交互协议。", "outputFormat": "参见交互协议。", "hint": "注意样例交互不满足任何测试集的约束（$\\mathbf{N}$ 值过小），仅用于说明输入输出格式。\n\n下图展示了测试用例 #2 中游戏 #1 的初始状态及每回合后的变化：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cccz3vlj.png)\n\n下图展示了测试用例 #2 中游戏 #2 的初始状态及每回合后的变化：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0b2qkj8q.png)\n\n**限制**\n\n- $1 \\leq \\mathbf{M} \\leq 50$。\n\n**测试集 1（13 分，可见判题结果）**\n\n- $\\mathbf{T}=1$。\n- $\\mathbf{N}=30$。\n\n**测试集 2（隐藏判题结果）**\n\n- $1 \\leq \\mathbf{T} \\leq 10$。\n- $31 \\leq \\mathbf{N} \\leq 40$。\n- 不同测试用例的 $\\mathbf{N}$ 值互不相同。\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P13001", "type": "P", "difficulty": 5, "samples": [["4\n5 5 5 1\n1 2\n1 3\n2 4\n3 4\n4 5\n5 5 5 2\n1 2\n1 3\n2 4\n3 4\n4 5\n3 1 2 3\n1 3\n2 1 1 2\n1 2", "Case #1: SAFE\nCase #2: 4\nCase #3: SAFE\nCase #4: 2"]], "limits": {"time": [10000, 10000, 60000], "memory": [1048576, 1048576, 1048576]}, "tags": ["图论", "2022", "广度优先搜索 BFS", "Google Code Jam"], "title": "[GCJ 2022 Finals] Wonderland Chase", "background": "", "description": "Alice is trapped in Wonderland's labyrinth, being chased by the Queen of Hearts and her herald! The labyrinth is a set of $\\mathbf{J}$ junctions numbered 1 through $\\mathbf{J}$, connected by $\\mathbf{C}$ bidirectional corridors.\n\nAlice and the Queen of Hearts take turns making moves, and each knows the location of the other at all times. A move (by either of them) consists of either staying at the current junction or moving to another one that is connected to it by a corridor.\n\nThe Queen's herald, however, announces the next move the Queen makes in advance. That means that before anyone makes a move, he announces the Queen's first move. Then, Alice moves first. Then, each time the Queen moves, she must respect the previous announcement, and then decide her next move so the herald can announce it. Alice hears the announcements, so she always knows the Queen's next move before making her own.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5dctftu9.png)\n\nIf Alice and the Queen are at the same junction after either of them moves, then Alice is caught. Otherwise, the pursuit continues. After $10^{9}$ total moves (half of them for Alice and half for the Queen), if Alice and the Queen are not in the same junction, then the Queen will give up and Alice will be safe.\n\nAlice chooses her moves optimally to escape. If she cannot escape, she chooses her moves to maximize the total number of moves until she is caught. The Queen chooses her moves optimally to try to catch Alice in as few total moves as possible.\n\nGiven the labyrinth's layout and the initial locations of both the Queen and Alice, find out whether Alice will be caught by the Queen and, if so, in how many moves.", "inputFormat": "The first line of the input gives the number of test cases, $\\mathbf{T}$. $\\mathbf{T}$ test cases follow. Each test case starts with a line containing four integers $\\mathbf{J}$, $\\mathbf{C}$, $\\mathbf{A}$, and $\\mathbf{Q}$: the number of junctions, the number of corridors, the junction where Alice starts, and the junction where the Queen starts, respectively. Then, $\\mathbf{C}$ lines follow. The $i$-th of these lines contains two integers $\\mathbf{U}_i$ and $\\mathbf{V}_i$, indicating that the $i$-th corridor bidirectionally connects junctions $\\mathbf{U}_i$ and $\\mathbf{V}_i$.", "outputFormat": "For each test case, output one line containing `Case #x: y`, where $x$ is the test case number (starting from 1) and $y$ is `SAFE` if Alice can avoid being caught for $10^9$ total moves. Otherwise, $y$ is the total number of moves (including Alice's and the Queen's) that it takes for the Queen to catch Alice.", "hint": "Sample Case #1 is the one pictured in the problem statement. Alice's optimal first move is to move to junction 4.\n\nSample Case #2 is the same as Sample Case #1 but the Queen starts at junction 2. The Queen can catch Alice by first announcing a move to junction 4. If Alice were to move to junction 4, she would be caught in 2 moves. Alice can evade capture for an extra 2 moves by staying put and waiting until the Queen then moves to junction 5 where she is located.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tbatx4qf.png)\n\nIn Sample Case #3, the Queen cannot reach Alice no matter what she does.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/f4qvfxc7.png)\n\nIn Sample Case #4, the Queen can begin by announcing that she will move to Alice's current junction. Alice has to move before then. If Alice moves to where the Queen already is, she gets caught immediately; if Alice remains in place, then she gets caught when the Queen moves. The second option is better, since it requires 2 total moves (Alice's and the Queen's) instead of 1.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2ac9iwif.png)\n\n**Limits**\n\n- $1 \\leq \\mathbf{T} \\leq 100$.\n- $1 \\leq \\mathbf{A} \\leq \\mathbf{J}$.\n- $1 \\leq \\mathbf{Q} \\leq \\mathbf{J}$.\n- $\\mathbf{A} \\neq \\mathbf{Q}$.\n- $1 \\leq \\mathbf{U}_i < \\mathbf{V}_i \\leq \\mathbf{J}$, for all $i$.\n- $(\\mathbf{U}_i, \\mathbf{V}_i) \\neq (\\mathbf{U}_j, \\mathbf{V}_j)$, for all $i \\neq j$.\n\n**Test Set 1 (Visible Verdict)**\n\n- Time limit: 10 seconds.\n- $2 \\leq \\mathbf{J} \\leq 30$.\n- $1 \\leq \\mathbf{C} \\leq 60$.\n\n**Test Set 2 (Hidden Verdict)**\n\n- Time limit: 60 seconds.\n- $2 \\leq \\mathbf{J} \\leq 10^5$.\n- $1 \\leq \\mathbf{C} \\leq 2 \\times 10^5$.", "locale": "en", "translations": {"en": {"title": "[GCJ 2022 Finals] Wonderland Chase", "background": "", "description": "Alice is trapped in Wonderland's labyrinth, being chased by the Queen of Hearts and her herald! The labyrinth is a set of $\\mathbf{J}$ junctions numbered 1 through $\\mathbf{J}$, connected by $\\mathbf{C}$ bidirectional corridors.\n\nAlice and the Queen of Hearts take turns making moves, and each knows the location of the other at all times. A move (by either of them) consists of either staying at the current junction or moving to another one that is connected to it by a corridor.\n\nThe Queen's herald, however, announces the next move the Queen makes in advance. That means that before anyone makes a move, he announces the Queen's first move. Then, Alice moves first. Then, each time the Queen moves, she must respect the previous announcement, and then decide her next move so the herald can announce it. Alice hears the announcements, so she always knows the Queen's next move before making her own.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5dctftu9.png)\n\nIf Alice and the Queen are at the same junction after either of them moves, then Alice is caught. Otherwise, the pursuit continues. After $10^{9}$ total moves (half of them for Alice and half for the Queen), if Alice and the Queen are not in the same junction, then the Queen will give up and Alice will be safe.\n\nAlice chooses her moves optimally to escape. If she cannot escape, she chooses her moves to maximize the total number of moves until she is caught. The Queen chooses her moves optimally to try to catch Alice in as few total moves as possible.\n\nGiven the labyrinth's layout and the initial locations of both the Queen and Alice, find out whether Alice will be caught by the Queen and, if so, in how many moves.", "inputFormat": "The first line of the input gives the number of test cases, $\\mathbf{T}$. $\\mathbf{T}$ test cases follow. Each test case starts with a line containing four integers $\\mathbf{J}$, $\\mathbf{C}$, $\\mathbf{A}$, and $\\mathbf{Q}$: the number of junctions, the number of corridors, the junction where Alice starts, and the junction where the Queen starts, respectively. Then, $\\mathbf{C}$ lines follow. The $i$-th of these lines contains two integers $\\mathbf{U}_i$ and $\\mathbf{V}_i$, indicating that the $i$-th corridor bidirectionally connects junctions $\\mathbf{U}_i$ and $\\mathbf{V}_i$.", "outputFormat": "For each test case, output one line containing `Case #x: y`, where $x$ is the test case number (starting from 1) and $y$ is `SAFE` if Alice can avoid being caught for $10^9$ total moves. Otherwise, $y$ is the total number of moves (including Alice's and the Queen's) that it takes for the Queen to catch Alice.", "hint": "Sample Case #1 is the one pictured in the problem statement. Alice's optimal first move is to move to junction 4.\n\nSample Case #2 is the same as Sample Case #1 but the Queen starts at junction 2. The Queen can catch Alice by first announcing a move to junction 4. If Alice were to move to junction 4, she would be caught in 2 moves. Alice can evade capture for an extra 2 moves by staying put and waiting until the Queen then moves to junction 5 where she is located.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tbatx4qf.png)\n\nIn Sample Case #3, the Queen cannot reach Alice no matter what she does.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/f4qvfxc7.png)\n\nIn Sample Case #4, the Queen can begin by announcing that she will move to Alice's current junction. Alice has to move before then. If Alice moves to where the Queen already is, she gets caught immediately; if Alice remains in place, then she gets caught when the Queen moves. The second option is better, since it requires 2 total moves (Alice's and the Queen's) instead of 1.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2ac9iwif.png)\n\n**Limits**\n\n- $1 \\leq \\mathbf{T} \\leq 100$.\n- $1 \\leq \\mathbf{A} \\leq \\mathbf{J}$.\n- $1 \\leq \\mathbf{Q} \\leq \\mathbf{J}$.\n- $\\mathbf{A} \\neq \\mathbf{Q}$.\n- $1 \\leq \\mathbf{U}_i < \\mathbf{V}_i \\leq \\mathbf{J}$, for all $i$.\n- $(\\mathbf{U}_i, \\mathbf{V}_i) \\neq (\\mathbf{U}_j, \\mathbf{V}_j)$, for all $i \\neq j$.\n\n**Test Set 1 (Visible Verdict)**\n\n- Time limit: 10 seconds.\n- $2 \\leq \\mathbf{J} \\leq 30$.\n- $1 \\leq \\mathbf{C} \\leq 60$.\n\n**Test Set 2 (Hidden Verdict)**\n\n- Time limit: 60 seconds.\n- $2 \\leq \\mathbf{J} \\leq 10^5$.\n- $1 \\leq \\mathbf{C} \\leq 2 \\times 10^5$.", "locale": "en"}, "zh-CN": {"title": "[GCJ 2022 Finals] Wonderland Chase", "background": "", "description": "**Alice** 被困在仙境的迷宫中，正被**红心皇后**和她的传令官追赶！迷宫由 $\\mathbf{J}$ 个编号为 1 到 $\\mathbf{J}$ 的交叉点和 $\\mathbf{C}$ 条双向走廊连接而成。\n\n**Alice** 和**红心皇后**轮流移动，双方始终知道对方的位置。每次移动（无论是谁）可以选择停留在当前交叉点，或通过走廊移动到相邻的交叉点。\n\n然而，皇后的传令官会提前宣布皇后下一步的移动计划。这意味着在任何人移动之前，他会先宣布皇后的第一步移动。接着，**Alice** 先移动。之后，每次皇后移动时，她必须遵守之前的宣布，并决定下一步移动以便传令官宣布。**Alice** 会听到这些宣布，因此她总是能在自己移动前知道皇后的下一步计划。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5dctftu9.png)\n\n如果 **Alice** 和皇后在任意一方移动后处于同一交叉点，则 **Alice** 被抓住。否则，追逐继续。若在总共 $10^{9}$ 次移动（**Alice** 和皇后各占一半）后，两人仍未处于同一交叉点，则皇后会放弃，**Alice** 安全逃脱。\n\n**Alice** 会以最优策略选择移动以逃脱。若无法逃脱，她会选择最大化被抓住前的移动次数。皇后则会以最优策略尝试在尽可能少的移动次数内抓住 **Alice**。\n\n给定迷宫的布局以及 **Alice** 和皇后的初始位置，判断 **Alice** 是否会被皇后抓住，如果是，计算需要多少次移动。", "inputFormat": "输入的第一行包含测试用例的数量 $\\mathbf{T}$。随后是 $\\mathbf{T}$ 个测试用例。每个测试用例的第一行包含四个整数 $\\mathbf{J}$、$\\mathbf{C}$、$\\mathbf{A}$ 和 $\\mathbf{Q}$：分别表示交叉点数量、走廊数量、**Alice** 的起始交叉点和皇后的起始交叉点。接着是 $\\mathbf{C}$ 行，每行包含两个整数 $\\mathbf{U}_i$ 和 $\\mathbf{V}_i$，表示第 $i$ 条走廊双向连接交叉点 $\\mathbf{U}_i$ 和 $\\mathbf{V}_i$。\n", "outputFormat": "对于每个测试用例，输出一行 `Case #x: y`，其中 $x$ 是测试用例编号（从 1 开始），$y$ 为 `SAFE` 表示 **Alice** 能在 $10^9$ 次移动内避免被抓住；否则 $y$ 是皇后抓住 **Alice** 所需的总移动次数（包括 **Alice** 和皇后的移动）。\n", "hint": "样例 #1 对应题目描述中的图示。**Alice** 的最优第一步是移动到交叉点 4。\n\n样例 #2 与样例 #1 相同，但皇后起始于交叉点 2。皇后可以通过先宣布移动到交叉点 4 来抓住 **Alice**。若 **Alice** 移动到交叉点 4，她将在 2 次移动后被抓住。 **Alice** 可以选择停留，直到皇后移动到交叉点 5，从而将捕获时间延长至 4 次移动。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tbatx4qf.png)\n\n样例 #3 中，皇后无论如何都无法到达 **Alice** 所在位置。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/f4qvfxc7.png)\n\n样例 #4 中，皇后可以宣布直接移动到 **Alice** 当前所在的交叉点。**Alice** 必须在皇后移动前行动。若 **Alice** 移动到皇后所在位置，她会立即被抓住；若停留原地，则会在皇后移动时被抓住。第二种选择更优，因为需要 2 次总移动（**Alice** 和皇后各一次）而非 1 次。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2ac9iwif.png)\n\n**限制条件**\n\n- $1 \\leq \\mathbf{T} \\leq 100$。\n- $1 \\leq \\mathbf{A} \\leq \\mathbf{J}$。\n- $1 \\leq \\mathbf{Q} \\leq \\mathbf{J}$。\n- $\\mathbf{A} \\neq \\mathbf{Q}$。\n- 对所有 $i$，$1 \\leq \\mathbf{U}_i < \\mathbf{V}_i \\leq \\mathbf{J}$。\n- 对所有 $i \\neq j$，$(\\mathbf{U}_i, \\mathbf{V}_i) \\neq (\\mathbf{U}_j, \\mathbf{V}_j)$。\n\n**测试集 1（可见判定）**\n\n- 时间限制：10 秒。\n- $2 \\leq \\mathbf{J} \\leq 30$。\n- $1 \\leq \\mathbf{C} \\leq 60$。\n\n**测试集 2（隐藏判定）**\n\n- 时间限制：60 秒。\n- $2 \\leq \\mathbf{J} \\leq 10^5$。\n- $1 \\leq \\mathbf{C} \\leq 2 \\times 10^5$。\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P13002", "type": "P", "difficulty": 7, "samples": [["2\n2 1 2\n1 2 3\n1 2 1 1 1\n2 1 2 2 2\n4 2 4\n4 3 10\n-4 -3 20\n1 3 4 3 11\n2 4 0 0 16\n3 1 6 3 9\n4 2 0 0 16", "Case #1: 1\nCase #2: 2"]], "limits": {"time": [20000, 20000, 60000], "memory": [1048576, 1048576, 1048576]}, "tags": ["2022", "强连通分量", "Google Code Jam"], "title": "[GCJ 2022 Finals] Goose, Goose, Ducks?", "background": "", "description": "The first international Geese conference just wrapped up, and even though it should have been a happy occasion, it was bittersweet. The organizers found a paper with detailed plans of a duck infiltration. Now, they are trying to identify the infiltrating group from among the attendees.\n\nThe document that they found contained a list of $\\mathbf{M}$ triples of integers $(\\mathbf{X}_i, \\mathbf{Y}_i, \\mathbf{C}_i)$ meaning the ducks would meet exactly $\\mathbf{C}_i$ seconds after the start of the conference at point $(\\mathbf{X}_i, \\mathbf{Y}_i)$, which is $\\mathbf{X}_i$ meters east and $\\mathbf{Y}_i$ meters north of the center of the conference floor. Each goose may or may not have been at those specific points at those specific times, but every duck certainly was.\n\nBoth ducks and geese walk at a maximum speed of one meter per second, which means an attendee that is at point $(x, y)$ at time $t$ can reach any point of the form $(x + \\Delta_x, y + \\Delta_y)$ by time $t + \\Delta_t$ as long as $\\Delta_x^2 + \\Delta_y^2 \\leq \\Delta_t^2$. Each attendee's position at time 0 can be any point, independently of the other attendees.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mq68x9yi.png)\n\nAfter the discovery, the group held a questioning session to try to identify the ducks. During that session, attendees issued a series of statements, one at a time. The $j$-th of those, in the order they were issued, was made by attendee $\\mathbf{A}_j$, claiming that both they and attendee $\\mathbf{B}_j$ were at point $(\\mathbf{U}_j, \\mathbf{V}_j)$ exactly $\\mathbf{D}_j$ seconds after the start of the conference. Points in statements may or may not be points where duck meetings happened.\n\nStatements from geese are always true, but ducks may lie. Moreover, ducks know which attendees are ducks and which are geese. To avoid getting caught easily, ducks only make statements that are consistent with all statements previously made by geese. Note that statements made by geese are consistent with all ducks being at all duck meetings.\n\nIt may not be possible to determine all the ducks with the information provided. However, knowing the minimum number of ducks will at least provide a lower bound on the level of duck activity. Note that there was at least one duck. Find this minimum number of ducks.\n\nFormally, a hypothesis $H$ is a partition of all attendees into a set of ducks (named $H$-ducks) and geese (named $H$-geese). $H$ is consistent with a set of statements $S$ if there exists a path for each attendee moving at most one meter per second such that:\n\n* all $H$-ducks were at all duck meetings and\n* for each statement in $S$ claiming that $A$ saw $B$ at point $P$ at time $T$, both $A$ and $B$'s paths went through point $P$ at time $T$.\n\nA hypothesis $H$ is feasible under a set of statements $S$ if:\n\n* $H$-ducks is not empty (i.e., there was at least one duck),\n* the subset of all statements from $S$ made by members of $H$-geese is consistent with $H$ (i.e., statements from geese are always true), and\n* for each statement $s \\in S$ made by a member of $H$-ducks, if $P \\subseteq S$ is the subset of statements made by members of $H$-geese issued before $s$, there exists a hypothesis $H'$ (which may or may not be equal to $H$) such that $\\{s\\} \\cup P$ is consistent with $H'$ (i.e., ducks do not contradict previous statements made by geese).\n\nNotice that the hypotheses $H$ such that $H$-ducks contains all attendees is always feasible.\n\nFind the minimum size of $H$-ducks over all feasible hypotheses $H$.", "inputFormat": "The first line of the input gives the number of test cases, $\\mathbf{T}$. $\\mathbf{T}$ test cases follow. Each test case starts with a line containing three integers, $\\mathbf{N}$, $\\mathbf{M}$, and $\\mathbf{S}$, representing the numbers of attendees, duck meetings, and statements, respectively. The next $\\mathbf{M}$ lines each describe a different duck meeting with three integers $\\mathbf{X}_i$, $\\mathbf{Y}_i$, and $\\mathbf{C}_i$, representing that there was a meeting at point $(\\mathbf{X}_i, \\mathbf{Y}_i)$, held exactly $\\mathbf{C}_i$ seconds after the start of the conference. Then, the last $\\mathbf{S}$ lines of a test case each describe a statement. The $j$-th of these lines describes the $j$-th issued statement with five integers $\\mathbf{A}_j$, $\\mathbf{B}_j$, $\\mathbf{U}_j$, $\\mathbf{V}_j$, and $\\mathbf{D}_j$, representing that attendee $\\mathbf{A}_j$ stated that they and attendee $\\mathbf{B}_j$ were both at point $(\\mathbf{U}_j, \\mathbf{V}_j)$ exactly $\\mathbf{D}_j$ seconds after the start of the conference.", "outputFormat": "For each test case, output one line containing `Case #x: y`, where $x$ is the test case number (starting from 1) and $y$ is the minimum number of ducks that might have infiltrated the conference.", "hint": "**Sample Explanation**\n\nIn Sample Case #1, attendee 1 being the only duck is a feasible hypothesis.\n\nIn Sample Case #2, attendees 2 and 4 being the only ducks is a feasible hypothesis. Note that there is at least one duck, so all attendees being geese is not feasible.\n\n**Limits**\n\n- $1 \\leq \\mathbf{T} \\leq 50$.\n- $-10^9 \\leq \\mathbf{X}_i \\leq 10^9$, for all $i$.\n- $-10^9 \\leq \\mathbf{Y}_i \\leq 10^9$, for all $i$.\n- $1 \\leq \\mathbf{C}_i \\leq 10^9$, for all $i$.\n- $\\mathbf{C}_i < \\mathbf{C}_{i+1}$, for all $i$.\n- $(\\mathbf{X}_i - \\mathbf{X}_{i+1})^2 + (\\mathbf{Y}_i - \\mathbf{Y}_{i+1})^2 \\leq (\\mathbf{C}_i - \\mathbf{C}_{i+1})^2$, for all $i$.\n- $1 \\leq \\mathbf{A}_j \\leq \\mathbf{N}$, for all $j$.\n- $1 \\leq \\mathbf{B}_j \\leq \\mathbf{N}$, for all $j$.\n- $\\mathbf{A}_j \\neq \\mathbf{B}_j$, for all $j$.\n- $-10^9 \\leq \\mathbf{U}_j \\leq 10^9$, for all $j$.\n- $-10^9 \\leq \\mathbf{V}_j \\leq 10^9$, for all $j$.\n- $1 \\leq \\mathbf{D}_j \\leq 10^9$, for all $j$.\n- $(\\mathbf{A}_j, \\mathbf{B}_j, \\mathbf{U}_j, \\mathbf{V}_j, \\mathbf{D}_j) \\neq (\\mathbf{A}_k, \\mathbf{B}_k, \\mathbf{U}_k, \\mathbf{V}_k, \\mathbf{D}_k)$, for all $j \\neq k$.\n\n**Test Set 1 (11 Pts, Visible Verdict)**\n\n- Time limit: 20 seconds.\n- $2 \\leq \\mathbf{N} \\leq 50$.\n- $1 \\leq \\mathbf{M} \\leq 50$.\n- $1 \\leq \\mathbf{S} \\leq 50$.\n\n**Test Set 2 (24 Pts, Hidden Verdict)**\n\n- Time limit: 60 seconds.\n- $2 \\leq \\mathbf{N} \\leq 10^5$.\n- $1 \\leq \\mathbf{M} \\leq 10^5$.\n- $1 \\leq \\mathbf{S} \\leq 10^5$.", "locale": "en", "translations": {"en": {"title": "[GCJ 2022 Finals] Goose, Goose, Ducks?", "background": "", "description": "The first international Geese conference just wrapped up, and even though it should have been a happy occasion, it was bittersweet. The organizers found a paper with detailed plans of a duck infiltration. Now, they are trying to identify the infiltrating group from among the attendees.\n\nThe document that they found contained a list of $\\mathbf{M}$ triples of integers $(\\mathbf{X}_i, \\mathbf{Y}_i, \\mathbf{C}_i)$ meaning the ducks would meet exactly $\\mathbf{C}_i$ seconds after the start of the conference at point $(\\mathbf{X}_i, \\mathbf{Y}_i)$, which is $\\mathbf{X}_i$ meters east and $\\mathbf{Y}_i$ meters north of the center of the conference floor. Each goose may or may not have been at those specific points at those specific times, but every duck certainly was.\n\nBoth ducks and geese walk at a maximum speed of one meter per second, which means an attendee that is at point $(x, y)$ at time $t$ can reach any point of the form $(x + \\Delta_x, y + \\Delta_y)$ by time $t + \\Delta_t$ as long as $\\Delta_x^2 + \\Delta_y^2 \\leq \\Delta_t^2$. Each attendee's position at time 0 can be any point, independently of the other attendees.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mq68x9yi.png)\n\nAfter the discovery, the group held a questioning session to try to identify the ducks. During that session, attendees issued a series of statements, one at a time. The $j$-th of those, in the order they were issued, was made by attendee $\\mathbf{A}_j$, claiming that both they and attendee $\\mathbf{B}_j$ were at point $(\\mathbf{U}_j, \\mathbf{V}_j)$ exactly $\\mathbf{D}_j$ seconds after the start of the conference. Points in statements may or may not be points where duck meetings happened.\n\nStatements from geese are always true, but ducks may lie. Moreover, ducks know which attendees are ducks and which are geese. To avoid getting caught easily, ducks only make statements that are consistent with all statements previously made by geese. Note that statements made by geese are consistent with all ducks being at all duck meetings.\n\nIt may not be possible to determine all the ducks with the information provided. However, knowing the minimum number of ducks will at least provide a lower bound on the level of duck activity. Note that there was at least one duck. Find this minimum number of ducks.\n\nFormally, a hypothesis $H$ is a partition of all attendees into a set of ducks (named $H$-ducks) and geese (named $H$-geese). $H$ is consistent with a set of statements $S$ if there exists a path for each attendee moving at most one meter per second such that:\n\n* all $H$-ducks were at all duck meetings and\n* for each statement in $S$ claiming that $A$ saw $B$ at point $P$ at time $T$, both $A$ and $B$'s paths went through point $P$ at time $T$.\n\nA hypothesis $H$ is feasible under a set of statements $S$ if:\n\n* $H$-ducks is not empty (i.e., there was at least one duck),\n* the subset of all statements from $S$ made by members of $H$-geese is consistent with $H$ (i.e., statements from geese are always true), and\n* for each statement $s \\in S$ made by a member of $H$-ducks, if $P \\subseteq S$ is the subset of statements made by members of $H$-geese issued before $s$, there exists a hypothesis $H'$ (which may or may not be equal to $H$) such that $\\{s\\} \\cup P$ is consistent with $H'$ (i.e., ducks do not contradict previous statements made by geese).\n\nNotice that the hypotheses $H$ such that $H$-ducks contains all attendees is always feasible.\n\nFind the minimum size of $H$-ducks over all feasible hypotheses $H$.", "inputFormat": "The first line of the input gives the number of test cases, $\\mathbf{T}$. $\\mathbf{T}$ test cases follow. Each test case starts with a line containing three integers, $\\mathbf{N}$, $\\mathbf{M}$, and $\\mathbf{S}$, representing the numbers of attendees, duck meetings, and statements, respectively. The next $\\mathbf{M}$ lines each describe a different duck meeting with three integers $\\mathbf{X}_i$, $\\mathbf{Y}_i$, and $\\mathbf{C}_i$, representing that there was a meeting at point $(\\mathbf{X}_i, \\mathbf{Y}_i)$, held exactly $\\mathbf{C}_i$ seconds after the start of the conference. Then, the last $\\mathbf{S}$ lines of a test case each describe a statement. The $j$-th of these lines describes the $j$-th issued statement with five integers $\\mathbf{A}_j$, $\\mathbf{B}_j$, $\\mathbf{U}_j$, $\\mathbf{V}_j$, and $\\mathbf{D}_j$, representing that attendee $\\mathbf{A}_j$ stated that they and attendee $\\mathbf{B}_j$ were both at point $(\\mathbf{U}_j, \\mathbf{V}_j)$ exactly $\\mathbf{D}_j$ seconds after the start of the conference.", "outputFormat": "For each test case, output one line containing `Case #x: y`, where $x$ is the test case number (starting from 1) and $y$ is the minimum number of ducks that might have infiltrated the conference.", "hint": "**Sample Explanation**\n\nIn Sample Case #1, attendee 1 being the only duck is a feasible hypothesis.\n\nIn Sample Case #2, attendees 2 and 4 being the only ducks is a feasible hypothesis. Note that there is at least one duck, so all attendees being geese is not feasible.\n\n**Limits**\n\n- $1 \\leq \\mathbf{T} \\leq 50$.\n- $-10^9 \\leq \\mathbf{X}_i \\leq 10^9$, for all $i$.\n- $-10^9 \\leq \\mathbf{Y}_i \\leq 10^9$, for all $i$.\n- $1 \\leq \\mathbf{C}_i \\leq 10^9$, for all $i$.\n- $\\mathbf{C}_i < \\mathbf{C}_{i+1}$, for all $i$.\n- $(\\mathbf{X}_i - \\mathbf{X}_{i+1})^2 + (\\mathbf{Y}_i - \\mathbf{Y}_{i+1})^2 \\leq (\\mathbf{C}_i - \\mathbf{C}_{i+1})^2$, for all $i$.\n- $1 \\leq \\mathbf{A}_j \\leq \\mathbf{N}$, for all $j$.\n- $1 \\leq \\mathbf{B}_j \\leq \\mathbf{N}$, for all $j$.\n- $\\mathbf{A}_j \\neq \\mathbf{B}_j$, for all $j$.\n- $-10^9 \\leq \\mathbf{U}_j \\leq 10^9$, for all $j$.\n- $-10^9 \\leq \\mathbf{V}_j \\leq 10^9$, for all $j$.\n- $1 \\leq \\mathbf{D}_j \\leq 10^9$, for all $j$.\n- $(\\mathbf{A}_j, \\mathbf{B}_j, \\mathbf{U}_j, \\mathbf{V}_j, \\mathbf{D}_j) \\neq (\\mathbf{A}_k, \\mathbf{B}_k, \\mathbf{U}_k, \\mathbf{V}_k, \\mathbf{D}_k)$, for all $j \\neq k$.\n\n**Test Set 1 (11 Pts, Visible Verdict)**\n\n- Time limit: 20 seconds.\n- $2 \\leq \\mathbf{N} \\leq 50$.\n- $1 \\leq \\mathbf{M} \\leq 50$.\n- $1 \\leq \\mathbf{S} \\leq 50$.\n\n**Test Set 2 (24 Pts, Hidden Verdict)**\n\n- Time limit: 60 seconds.\n- $2 \\leq \\mathbf{N} \\leq 10^5$.\n- $1 \\leq \\mathbf{M} \\leq 10^5$.\n- $1 \\leq \\mathbf{S} \\leq 10^5$.", "locale": "en"}, "zh-CN": {"title": "[GCJ 2022 Finals] Goose, Goose, Ducks?", "background": "", "description": "首届国际鹅类大会刚刚结束，尽管这本应是一件值得高兴的事，却让人五味杂陈。组织者发现了一份文件，详细记录了鸭子的渗透计划。现在，他们正试图从与会者中找出这群渗透者。\n\n找到的文件中包含 $\\mathbf{M}$ 个整数三元组 $(\\mathbf{X}_i, \\mathbf{Y}_i, \\mathbf{C}_i)$，表示鸭子们会在会议开始后恰好 $\\mathbf{C}_i$ 秒在点 $(\\mathbf{X}_i, \\mathbf{Y}_i)$ 处集合，该点位于会议大厅中心以东 $\\mathbf{X}_i$ 米、以北 $\\mathbf{Y}_i$ 米处。每只鹅可能在这些特定时间出现在这些特定地点，也可能没有，但每只鸭子一定都在。\n\n鸭子和鹅的最大行走速度均为每秒 1 米，这意味着在时间 $t$ 处于点 $(x, y)$ 的与会者可以在时间 $t + \\Delta_t$ 前到达任何形如 $(x + \\Delta_x, y + \\Delta_y)$ 的点，只要满足 $\\Delta_x^2 + \\Delta_y^2 \\leq \\Delta_t^2$。每位与会者在时间 0 时的位置可以是任意点，与其他与会者无关。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mq68x9yi.png)\n\n发现文件后，组织者召开了一场质询会以试图识别鸭子。在质询过程中，与会者依次发表了一系列声明。按发表顺序，第 $j$ 条声明由与会者 $\\mathbf{A}_j$ 作出，声称他们和与会者 $\\mathbf{B}_j$ 在会议开始后恰好 $\\mathbf{D}_j$ 秒时位于点 $(\\mathbf{U}_j, \\mathbf{V}_j)$。声明中的点可能是也可能不是鸭子集合的地点。\n\n**鹅的声明总是真实的，但鸭子可能撒谎**。此外，鸭子知道哪些与会者是鸭子，哪些是鹅。为了避免轻易暴露，鸭子只会发表与之前鹅作出的所有声明一致的声明。注意，鹅的声明与所有鸭子都参加了所有鸭子集合是一致的。\n\n根据提供的信息，可能无法确定所有鸭子。然而，知道鸭子的最小数量至少可以为鸭子活动的活跃程度提供一个下限。注意，至少存在一只鸭子。请找出这一最小数量。\n\n形式化地，假设 $H$ 是将所有与会者划分为鸭子集合（称为 $H$-鸭子）和鹅集合（称为 $H$-鹅）的一种分类。$H$ 与一组声明 $S$ 一致的条件是：存在每位与会者以不超过每秒 1 米的速度移动的路径，满足：\n\n* 所有 $H$-鸭子都参加了所有鸭子集合；\n* 对于 $S$ 中每一条声称 $A$ 在时间 $T$ 于点 $P$ 看到 $B$ 的声明，$A$ 和 $B$ 的路径在时间 $T$ 都经过点 $P$。\n\n假设 $H$ 在一组声明 $S$ 下是可行的，如果：\n\n* $H$-鸭子非空（即至少存在一只鸭子），\n* $S$ 中由 $H$-鹅成员作出的所有声明的子集与 $H$ 一致（即鹅的声明总是真实的），\n* 对于 $S$ 中由 $H$-鸭子成员作出的每一条声明 $s$，如果 $P \\subseteq S$ 是在 $s$ 之前由 $H$-鹅成员作出的声明的子集，则存在一个假设 $H'$（可能与 $H$ 相同也可能不同）使得 $\\{s\\} \\cup P$ 与 $H'$ 一致（即鸭子不会与之前鹅的声明矛盾）。\n\n注意，$H$-鸭子包含所有与会者的假设 $H$ 总是可行的。\n\n求出所有可行假设 $H$ 中 $H$-鸭子集合的最小大小。", "inputFormat": "输入的第一行给出测试用例的数量 $\\mathbf{T}$。随后是 $\\mathbf{T}$ 个测试用例。每个测试用例的第一行包含三个整数 $\\mathbf{N}$、$\\mathbf{M}$ 和 $\\mathbf{S}$，分别表示与会者数量、鸭子集合数量和声明数量。接下来的 $\\mathbf{M}$ 行每行描述一个鸭子集合，包含三个整数 $\\mathbf{X}_i$、$\\mathbf{Y}_i$ 和 $\\mathbf{C}_i$，表示在点 $(\\mathbf{X}_i, \\mathbf{Y}_i)$ 处有一个集合，时间为会议开始后恰好 $\\mathbf{C}_i$ 秒。然后，每个测试用例的最后 $\\mathbf{S}$ 行描述声明。第 $j$ 行描述第 $j$ 条声明，包含五个整数 $\\mathbf{A}_j$、$\\mathbf{B}_j$、$\\mathbf{U}_j$、$\\mathbf{V}_j$ 和 $\\mathbf{D}_j$，表示与会者 $\\mathbf{A}_j$ 声称他们和与会者 $\\mathbf{B}_j$ 在会议开始后恰好 $\\mathbf{D}_j$ 秒时位于点 $(\\mathbf{U}_j, \\mathbf{V}_j)$。", "outputFormat": "对于每个测试用例，输出一行 `Case #x: y`，其中 $x$ 是测试用例编号（从 1 开始），$y$ 是可能渗透会议的最小鸭子数量。\n", "hint": "**样例解释**\n\n在样例 #1 中，与会者 1 是唯一的鸭子是一个可行的假设。\n\n在样例 #2 中，与会者 2 和 4 是唯一的鸭子是一个可行的假设。注意，至少存在一只鸭子，因此所有与会者都是鹅的假设不可行。\n\n**限制条件**\n\n- $1 \\leq \\mathbf{T} \\leq 50$。\n- $-10^9 \\leq \\mathbf{X}_i \\leq 10^9$，对所有 $i$。\n- $-10^9 \\leq \\mathbf{Y}_i \\leq 10^9$，对所有 $i$。\n- $1 \\leq \\mathbf{C}_i \\leq 10^9$，对所有 $i$。\n- $\\mathbf{C}_i < \\mathbf{C}_{i+1}$，对所有 $i$。\n- $(\\mathbf{X}_i - \\mathbf{X}_{i+1})^2 + (\\mathbf{Y}_i - \\mathbf{Y}_{i+1})^2 \\leq (\\mathbf{C}_i - \\mathbf{C}_{i+1})^2$，对所有 $i$。\n- $1 \\leq \\mathbf{A}_j \\leq \\mathbf{N}$，对所有 $j$。\n- $1 \\leq \\mathbf{B}_j \\leq \\mathbf{N}$，对所有 $j$。\n- $\\mathbf{A}_j \\neq \\mathbf{B}_j$，对所有 $j$。\n- $-10^9 \\leq \\mathbf{U}_j \\leq 10^9$，对所有 $j$。\n- $-10^9 \\leq \\mathbf{V}_j \\leq 10^9$，对所有 $j$。\n- $1 \\leq \\mathbf{D}_j \\leq 10^9$，对所有 $j$。\n- $(\\mathbf{A}_j, \\mathbf{B}_j, \\mathbf{U}_j, \\mathbf{V}_j, \\mathbf{D}_j) \\neq (\\mathbf{A}_k, \\mathbf{B}_k, \\mathbf{U}_k, \\mathbf{V}_k, \\mathbf{D}_k)$，对所有 $j \\neq k$。\n\n**测试集 1（11 分，可见判定）**\n\n- 时间限制：20 秒。\n- $2 \\leq \\mathbf{N} \\leq 50$。\n- $1 \\leq \\mathbf{M} \\leq 50$。\n- $1 \\leq \\mathbf{S} \\leq 50$。\n\n**测试集 2（24 分，隐藏判定）**\n\n- 时间限制：60 秒。\n- $2 \\leq \\mathbf{N} \\leq 10^5$。\n- $1 \\leq \\mathbf{M} \\leq 10^5$。\n- $1 \\leq \\mathbf{S} \\leq 10^5$。\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P13003", "type": "P", "difficulty": 6, "samples": [["5\n2 2\n2 1\n1 2\n3 4\n2 3\n1 2\n3 2\n1 3\n3 6\n1 2\n1 3\n2 1\n2 3\n3 1\n3 2\n3 4\n1 2\n2 1\n1 3\n3 1\n4 6\n1 2\n1 4\n2 3\n3 2\n3 4\n4 1", "Case #1: 7\n1 2 1 2 1 2 1\nCase #2: IMPOSSIBLE\nCase #3: 7\n1 2 3 1 3 2 1\nCase #4: IMPOSSIBLE\nCase #5: 9\n1 4 1 2 3 2 3 4 1"]], "limits": {"time": [10000, 10000, 20000], "memory": [1048576, 1048576, 1048576]}, "tags": ["2022", "网络流", "Special Judge", "欧拉回路", "二分图", "Google Code Jam"], "title": "[GCJ 2022 Finals] Slide Parade", "background": "", "description": "Gooli is a huge company that owns $\\mathbf{B}$ buildings in a hilly area, numbered 1 through $\\mathbf{B}$. Six years ago, Gooli built slides that allowed employees to go from one building to another. Each slide allows anyone to go from the slide's origin building to the slide's destination building, but not the other way around. Gooli's CEO is very proud of their slides and wants to organize a parade through the slides. She has tasked Melek, Gooli's Head of Transportation and a problem-solving enthusiast, with designing the parade's route.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/njzcunb7.png)\n\nShe has some requirements for the parade route in mind:\n\n* It must start and end at building 1, where her office is located.\n* It must visit each building the same number of times. Being in building 1 at the start of the route does not count as a visit.\n* It must use each slide at least once.\n* It must have at most $10^6$ steps.\n\nGiven the layout of buildings and slides, help Melek find a route that satisfies all of the CEO's requirements, if one exists.", "inputFormat": "The first line of the input gives the number of test cases, $\\mathbf{T}$. $\\mathbf{T}$ test cases follow. Each test case starts with a line containing two integers $\\mathbf{B}$ and $\\mathbf{S}$: the number of buildings and slides, respectively. Then, $\\mathbf{S}$ lines follow. The $i$-th of these lines contains two integers $\\mathbf{U}_i$ and $\\mathbf{V}_i$, indicating that the $i$-th slide goes from building $\\mathbf{U}_i$ to building $\\mathbf{V}_i$.\n", "outputFormat": "For each test case, output one line containing `Case #x: y`, where $x$ is the test case number (starting from 1). If there is no route that fulfills all the requirements, $y$ must be `IMPOSSIBLE`. If there is, $y$ must be an integer between $\\mathbf{S} + 1$ and $10^6 + 1$, inclusive, representing the length of one such route you want to exhibit. In that case, output another line containing $y$ integers $z_1$ $z_2$ $\\dots$ $z_y$, where $z_j$ is the $j$-th building in your proposed route. Notice that $z_1 = z_y = 1$ and that each building must appear the same number of times among the $z_j$, except for building 1, which appears exactly one extra time.", "hint": "**Sample Explanation**\n\nIn Sample Case #1, another acceptable parade route is one that goes from building 1 to building 2 and then back for a total of 2 steps.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/udzlxptm.png)\n\nIn Sample Case #2, there are no slides leading to building 1, so no valid parade can exist.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pp27u0fj.png)\n\nIn Sample Case #3, the parade route the sample output exhibits goes through each building twice.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/e7pjon34.png)\n\nSample Case #4 is pictured below.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ff4gi295.png)\n\nSample Case #5 is the one illustrated in the problem statement. In the parade route in the sample output, the slides from 2 to 3 and from 4 to 1 are used twice, but the rest of the slides are used only once each.\n\n**Limits**\n\n- $1 \\leq \\mathbf{T} \\leq 100$.\n- $1 \\leq \\mathbf{U}_i \\leq \\mathbf{B}$, for all $i$.\n- $1 \\leq \\mathbf{V}_i \\leq \\mathbf{B}$, for all $i$.\n- $\\mathbf{U}_i \\neq \\mathbf{V}_i$, for all $i$.\n- $(\\mathbf{U}_i, \\mathbf{V}_i) \\neq (\\mathbf{U}_j, \\mathbf{V}_j)$, for all $i \\neq j$.\n\n**Test Set 1 (11 Pts, Visible Verdict)**\n\n- Time limit: 10 seconds.\n- $2 \\leq \\mathbf{B} \\leq 10$.\n- $2 \\leq \\mathbf{S} \\leq 10$.\n\n**Test Set 2 (24 Pts, Hidden Verdict)**\n\n- Time limit: 20 seconds.\n- $2 \\leq \\mathbf{B} \\leq 200$.\n- $2 \\leq \\mathbf{S} \\leq 5000$.\n", "locale": "en", "translations": {"en": {"title": "[GCJ 2022 Finals] Slide Parade", "background": "", "description": "Gooli is a huge company that owns $\\mathbf{B}$ buildings in a hilly area, numbered 1 through $\\mathbf{B}$. Six years ago, Gooli built slides that allowed employees to go from one building to another. Each slide allows anyone to go from the slide's origin building to the slide's destination building, but not the other way around. Gooli's CEO is very proud of their slides and wants to organize a parade through the slides. She has tasked Melek, Gooli's Head of Transportation and a problem-solving enthusiast, with designing the parade's route.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/njzcunb7.png)\n\nShe has some requirements for the parade route in mind:\n\n* It must start and end at building 1, where her office is located.\n* It must visit each building the same number of times. Being in building 1 at the start of the route does not count as a visit.\n* It must use each slide at least once.\n* It must have at most $10^6$ steps.\n\nGiven the layout of buildings and slides, help Melek find a route that satisfies all of the CEO's requirements, if one exists.", "inputFormat": "The first line of the input gives the number of test cases, $\\mathbf{T}$. $\\mathbf{T}$ test cases follow. Each test case starts with a line containing two integers $\\mathbf{B}$ and $\\mathbf{S}$: the number of buildings and slides, respectively. Then, $\\mathbf{S}$ lines follow. The $i$-th of these lines contains two integers $\\mathbf{U}_i$ and $\\mathbf{V}_i$, indicating that the $i$-th slide goes from building $\\mathbf{U}_i$ to building $\\mathbf{V}_i$.\n", "outputFormat": "For each test case, output one line containing `Case #x: y`, where $x$ is the test case number (starting from 1). If there is no route that fulfills all the requirements, $y$ must be `IMPOSSIBLE`. If there is, $y$ must be an integer between $\\mathbf{S} + 1$ and $10^6 + 1$, inclusive, representing the length of one such route you want to exhibit. In that case, output another line containing $y$ integers $z_1$ $z_2$ $\\dots$ $z_y$, where $z_j$ is the $j$-th building in your proposed route. Notice that $z_1 = z_y = 1$ and that each building must appear the same number of times among the $z_j$, except for building 1, which appears exactly one extra time.", "hint": "**Sample Explanation**\n\nIn Sample Case #1, another acceptable parade route is one that goes from building 1 to building 2 and then back for a total of 2 steps.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/udzlxptm.png)\n\nIn Sample Case #2, there are no slides leading to building 1, so no valid parade can exist.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pp27u0fj.png)\n\nIn Sample Case #3, the parade route the sample output exhibits goes through each building twice.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/e7pjon34.png)\n\nSample Case #4 is pictured below.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ff4gi295.png)\n\nSample Case #5 is the one illustrated in the problem statement. In the parade route in the sample output, the slides from 2 to 3 and from 4 to 1 are used twice, but the rest of the slides are used only once each.\n\n**Limits**\n\n- $1 \\leq \\mathbf{T} \\leq 100$.\n- $1 \\leq \\mathbf{U}_i \\leq \\mathbf{B}$, for all $i$.\n- $1 \\leq \\mathbf{V}_i \\leq \\mathbf{B}$, for all $i$.\n- $\\mathbf{U}_i \\neq \\mathbf{V}_i$, for all $i$.\n- $(\\mathbf{U}_i, \\mathbf{V}_i) \\neq (\\mathbf{U}_j, \\mathbf{V}_j)$, for all $i \\neq j$.\n\n**Test Set 1 (11 Pts, Visible Verdict)**\n\n- Time limit: 10 seconds.\n- $2 \\leq \\mathbf{B} \\leq 10$.\n- $2 \\leq \\mathbf{S} \\leq 10$.\n\n**Test Set 2 (24 Pts, Hidden Verdict)**\n\n- Time limit: 20 seconds.\n- $2 \\leq \\mathbf{B} \\leq 200$.\n- $2 \\leq \\mathbf{S} \\leq 5000$.\n", "locale": "en"}, "zh-CN": {"title": "[GCJ 2022 Finals] Slide Parade", "background": null, "description": "**Gooli** 是一家巨型公司，在一个丘陵地区拥有 $\\mathbf{B}$ 栋编号为 1 到 $\\mathbf{B}$ 的建筑。六年前，Gooli 修建了滑梯，允许员工从一栋建筑滑向另一栋建筑。每个滑梯只能从其出发建筑滑向目标建筑，而不能反向滑行。Gooli 的 CEO 对公司的滑梯系统非常自豪，并希望组织一场滑梯游戏。她将设计路线的任务交给了 **Melek**——Gooli 的交通主管兼解题爱好者。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/njzcunb7.png)\n\nCEO 对路线提出了以下要求：\n\n* 路线必须从建筑 1（她的办公室所在地）出发并最终回到建筑 1。\n* 每栋建筑的访问次数必须相同。起点位于建筑 1 不算作对建筑 1 的一次访问。\n* 每条滑梯必须至少被使用一次。\n* 路线长度不超过 $10^6$ 步。\n\n给定建筑和滑梯的布局，帮助 Melek 找到一条满足 CEO 所有要求的路线（如果存在）。", "inputFormat": "输入的第一行给出测试用例的数量 $\\mathbf{T}$。随后是 $\\mathbf{T}$ 个测试用例。每个测试用例的第一行包含两个整数 $\\mathbf{B}$ 和 $\\mathbf{S}$，分别表示建筑数量和滑梯数量。接下来的 $\\mathbf{S}$ 行每行包含两个整数 $\\mathbf{U}_i$ 和 $\\mathbf{V}_i$，表示第 $i$ 条滑梯从建筑 $\\mathbf{U}_i$ 通向建筑 $\\mathbf{V}_i$。", "outputFormat": "对于每个测试用例，输出一行 `Case #x: y`，其中 $x$ 是测试用例编号（从 1 开始）。如果不存在满足所有要求的路线，$y$ 应为 `IMPOSSIBLE`。如果存在，$y$ 必须是一个介于 $\\mathbf{S} + 1$ 到 $10^6 + 1$ 之间的整数，表示你建议的路线长度。此时，还需输出第二行，包含 $y$ 个整数 $z_1\\ z_2\\ \\dots\\ z_y$，其中 $z_j$ 表示路线中第 $j$ 栋建筑的编号。注意 $z_1 = z_y = 1$，且所有建筑（除建筑 1 外）在 $z_j$ 中的出现次数必须相同，而建筑 1 恰好多出现一次。", "hint": "**样例解释**\n\n在样例 #1 中，另一条可接受的路线是从建筑 1 滑到建筑 2 再返回，总步数为 2 步。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/udzlxptm.png)\n\n在样例 #2 中，没有滑梯通向建筑 1，因此不存在有效路线。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pp27u0fj.png)\n\n在样例 #3 中，样例输出展示的路线使每栋建筑被访问两次。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/e7pjon34.png)\n\n样例 #4 如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ff4gi295.png)\n\n样例 #5 是题目描述中图示的案例。在样例输出的路线中，从 2 到 3 和从 4 到 1 的滑梯被使用了两次，其余滑梯各使用一次。\n\n**限制条件**\n\n- $1 \\leq \\mathbf{T} \\leq 100$。\n- $1 \\leq \\mathbf{U}_i \\leq \\mathbf{B}$，对所有 $i$。\n- $1 \\leq \\mathbf{V}_i \\leq \\mathbf{B}$，对所有 $i$。\n- $\\mathbf{U}_i \\neq \\mathbf{V}_i$，对所有 $i$。\n- $(\\mathbf{U}_i, \\mathbf{V}_i) \\neq (\\mathbf{U}_j, \\mathbf{V}_j)$，对所有 $i \\neq j$。\n\n**测试集 1（11 分，可见判定）**\n\n- 时间限制：10 秒。\n- $2 \\leq \\mathbf{B} \\leq 10$。\n- $2 \\leq \\mathbf{S} \\leq 10$。\n\n**测试集 2（24 分，隐藏判定）**\n\n- 时间限制：20 秒。\n- $2 \\leq \\mathbf{B} \\leq 200$。\n- $2 \\leq \\mathbf{S} \\leq 5000$。\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P13004", "type": "P", "difficulty": 6, "samples": [["4\n4\n??.C\n2 3 1 3\n4\n????\n2 3 1 3\n6\n?.????\n6 6 6 6 6 5\n34\n????????????????????????????????CC\n2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 33", "Case #1: 1\nCase #2: 2\nCase #3: 15\nCase #4: 294967268"]], "limits": {"time": [10000, 10000, 10000], "memory": [1048576, 1048576, 1048576]}, "tags": ["动态规划 DP", "2022", "概率论", "基环树", "Google Code Jam"], "title": "[GCJ 2022 Finals] Schrödinger and Pavlov", "background": "", "description": " _The story, all names, characters, and incidents portrayed in this problem statement are fictitious. No identification with actual persons is intended or should be inferred._ \n\nIt is 1935 and a meeting between two Nobel prize winners is producing astonishing results. Schrödinger, a famous physicist, invited Pavlov, a famous physiologist, to see his experiments with cats in boxes. Pavlov brought his dog with him to keep up with his own research, and the combination proved interesting, to say the least.\n\nSchrödinger had a row of $\\mathbf{N}$ boxes. Some boxes definitely contain a cat, some boxes definitely do not contain a cat, and some boxes may or may not contain a cat. Each box is only big enough to hold a single cat. Each box is also equipped with a special quantum tunnel, that allows the cat in the box to move to some other specific box if the destination was empty. The tunnels work in a single direction.\n\nCats are usually mellow and quiet and do not use the tunnels unless they become startled. When a third unannounced guest rings the bell, Pavlov's dog gets excited immediately and starts running and barking. The dog starts at box 1 and runs towards box $\\mathbf{N}$. As the dog runs, it passes right next to each box, one at a time. When it passes next to a box that contains a cat, the cat in that box becomes startled. The startled cat checks the available tunnel and, if the destination box is empty, uses it to escape. If the destination box is occupied, the cat stays in its current box. The same cat can be startled more than once if they move to a box the dog will get to afterwards, and will proceed in the same way every time it is startled (using only the newly available tunnel each subsequent time).\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xcqaev9m.png)\n\nAfter Pavlov's dog finally stops right next to the last box, Pavlov asks Schrödinger whether there is a cat in that last box. Schrödinger, true to his fame, replies that he does not know. Pavlov notices that the answer may depend on whether or not there were cats in the unknown boxes. Moreover, he also notices that because there are $k$ unknown boxes, there are $2^k$ possible *initial configurations*, one for each combination of statuses of the unknown boxes. Pavlov tells Schrödinger that they should try to calculate how many of the $2^k$ initial configurations would result in having a cat in the last box. You are asked to recreate that calculation. Since the output can be a really big number, we only ask you to output the remainder of dividing the result by the prime $10^9 + 7$ (1000000007).\n\n*Neither cats, nor dogs, nor Nobel prize winners were harmed in the making of this problem statement.*", "inputFormat": "The first line of the input gives the number of test cases, $\\mathbf{T}$. $\\mathbf{T}$ test cases follow, each described by exactly three lines. The first line of a test case contains a single integer $\\mathbf{N}$, the number of boxes in Schrödinger's experiment. Boxes are numbered between 1 and $\\mathbf{N}$, in the order Pavlov's dog passes them by. The second line of a test case contains a single string $\\mathbf{S}$ of $\\mathbf{N}$ characters. The $i$-th character of $\\mathbf{S}$ (counting from left to right) represents the contents of box $i$: it is an uppercase 'c' if the box contains a cat, a period '.' if the box does not contain a cat and a question mark '?' if it is unknown whether the box contains a cat or not. The third line of a test case contains $\\mathbf{N}$ integers $\\mathbf{B}_1$, $\\mathbf{B}_2$, $\\dots$, $\\mathbf{B}_\\mathbf{N}$, representing that there is a tunnel going out of box $i$ and into box $\\mathbf{B}_i$, for all $i$.\n", "outputFormat": "For each test case, output one line containing `Case #x: y`, where $x$ is the test case number (starting from 1) and $y$ is the number of initial configurations that would result in a cat being in the last box and unable to escape despite hearing the barking, modulo the prime $10^9 + 7$ ($1000000007$).", "hint": "**Sample Explanation**\n\nSample Case #1 is illustrated in the problem statement. There are 4 possible configurations:\n\n*   `...C`: the dog runs through the first 3 boxes without changing anything because there is no cat there. Then, when it gets to the last box, the cat hears it and escapes to box 3. Therefore, there is no cat in the last box in this case.\n*   `C..C`: when the dog barks near box 1, that startles the cat that goes through the tunnel to get to box 2, which was empty. Then, the same cat gets startled again when the dog barks near box 2 and gets to box 3. And when the dog barks next to box 3, the cat hears it and returns to box 1. Therefore, when the dog gets to box 4 and the other cats hears it, box 3 is empty so the cat escapes and the last box ends up empty.\n*   `.C.C`: This case is very similar to the previous one. After the dog goes through the first box and nothing happens, the state is the same as before, so the ultimate result is the same: last box empty.\n*   `CC.C`: In this case, the cat in the first box cannot escape when it hears the dog, so it remains in box 1. Then, when the cat in box 2 gets startled it escapes to box 3 leaving a state of `C.CC`. When the dog gets to the box 3, the cat currently there cannot escape to box 1 so the state remains the same. Finally, when the dog gets to the last box, the cat that is there cannot escape because box 3 is occupied this time. So, in this case, the last box ends up with a cat after the dog ends its journey.\n\nOut of the 4 possibilities, only 1 (the last one) ends up with a cat in the last box, so the answer is 1.\n\nIn Sample Case #2, the tunnels are set up the same as in Sample Case #1. Since no tunnel ends at the last box, the configurations that start with no cat at the last box will also not end with a cat there, so we do not need to count them. Then, we have 8 additional configurations. The 4 we considered for Sample Case #1, out of which only 1 ends up with a cat at the last box. The remaining 4 configurations are: `..CC`, `C.CC`, `.CCC`, `CCCC`. From these additional 4 configurations, only in the last one listed a cat ends up in the last box, for a total of 2 overall.\n\nIn Sample Case #3, notice that for a cat to remain in the last box after the dog barks near it, both that box and box 5 must be occupied then (otherwise, either there is no cat in the last box, or it will escape to box 5). Since there is no tunnel going into box 5, a cat must start there. As long as there is another cat in any other box, box 6 will get (or remain) occupied before the cat in box 5 gets an opportunity to escape, so all of those will end up with a cat in the last box. As we argued before, a single cat is not enough. Thus, we need to count the number of configurations with a cat in box 5 and at least one other cat. There are $2^4$ configurations with a cat in box 5, and out of those, only 1 has no other cat, so the answer is $2^4 - 1 = 15$.\n\nIn Sample Case #4, in all of the $2^k$ ways in which the $k$ unknown boxes may exist a cat would be left in the last box.\n\n**Limits**\n\n- $1 \\leq \\mathbf{T} \\leq 1234$.\n- the length of $\\mathbf{S} = \\mathbf{N}$.\nE- ach character of $\\mathbf{S}$ is either an upper case 'c', a period '.' or a question mark '?'.\n- $1 \\leq \\mathbf{B}_i \\leq \\mathbf{N}$, for all $i$.\n- $\\mathbf{B}_i \\neq i$, for all $i$.\n\n**Test Set 1 (8 Pts, Visible Verdict)**\n\n- $1 \\leq \\mathbf{N} \\leq 100$.\n- $i - 5 \\leq \\mathbf{B}_i \\leq i + 5$, for all $i$. (All tunnels connect to nearby boxes.)\n\n**Test Set 2 (42 Pts, Hidden Verdict)**\n\n- $1 \\leq \\mathbf{N} \\leq 5000$.", "locale": "en", "translations": {"en": {"title": "[GCJ 2022 Finals] Schrödinger and Pavlov", "background": "", "description": " _The story, all names, characters, and incidents portrayed in this problem statement are fictitious. No identification with actual persons is intended or should be inferred._ \n\nIt is 1935 and a meeting between two Nobel prize winners is producing astonishing results. Schrödinger, a famous physicist, invited Pavlov, a famous physiologist, to see his experiments with cats in boxes. Pavlov brought his dog with him to keep up with his own research, and the combination proved interesting, to say the least.\n\nSchrödinger had a row of $\\mathbf{N}$ boxes. Some boxes definitely contain a cat, some boxes definitely do not contain a cat, and some boxes may or may not contain a cat. Each box is only big enough to hold a single cat. Each box is also equipped with a special quantum tunnel, that allows the cat in the box to move to some other specific box if the destination was empty. The tunnels work in a single direction.\n\nCats are usually mellow and quiet and do not use the tunnels unless they become startled. When a third unannounced guest rings the bell, Pavlov's dog gets excited immediately and starts running and barking. The dog starts at box 1 and runs towards box $\\mathbf{N}$. As the dog runs, it passes right next to each box, one at a time. When it passes next to a box that contains a cat, the cat in that box becomes startled. The startled cat checks the available tunnel and, if the destination box is empty, uses it to escape. If the destination box is occupied, the cat stays in its current box. The same cat can be startled more than once if they move to a box the dog will get to afterwards, and will proceed in the same way every time it is startled (using only the newly available tunnel each subsequent time).\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xcqaev9m.png)\n\nAfter Pavlov's dog finally stops right next to the last box, Pavlov asks Schrödinger whether there is a cat in that last box. Schrödinger, true to his fame, replies that he does not know. Pavlov notices that the answer may depend on whether or not there were cats in the unknown boxes. Moreover, he also notices that because there are $k$ unknown boxes, there are $2^k$ possible *initial configurations*, one for each combination of statuses of the unknown boxes. Pavlov tells Schrödinger that they should try to calculate how many of the $2^k$ initial configurations would result in having a cat in the last box. You are asked to recreate that calculation. Since the output can be a really big number, we only ask you to output the remainder of dividing the result by the prime $10^9 + 7$ (1000000007).\n\n*Neither cats, nor dogs, nor Nobel prize winners were harmed in the making of this problem statement.*", "inputFormat": "The first line of the input gives the number of test cases, $\\mathbf{T}$. $\\mathbf{T}$ test cases follow, each described by exactly three lines. The first line of a test case contains a single integer $\\mathbf{N}$, the number of boxes in Schrödinger's experiment. Boxes are numbered between 1 and $\\mathbf{N}$, in the order Pavlov's dog passes them by. The second line of a test case contains a single string $\\mathbf{S}$ of $\\mathbf{N}$ characters. The $i$-th character of $\\mathbf{S}$ (counting from left to right) represents the contents of box $i$: it is an uppercase 'c' if the box contains a cat, a period '.' if the box does not contain a cat and a question mark '?' if it is unknown whether the box contains a cat or not. The third line of a test case contains $\\mathbf{N}$ integers $\\mathbf{B}_1$, $\\mathbf{B}_2$, $\\dots$, $\\mathbf{B}_\\mathbf{N}$, representing that there is a tunnel going out of box $i$ and into box $\\mathbf{B}_i$, for all $i$.\n", "outputFormat": "For each test case, output one line containing `Case #x: y`, where $x$ is the test case number (starting from 1) and $y$ is the number of initial configurations that would result in a cat being in the last box and unable to escape despite hearing the barking, modulo the prime $10^9 + 7$ ($1000000007$).", "hint": "**Sample Explanation**\n\nSample Case #1 is illustrated in the problem statement. There are 4 possible configurations:\n\n*   `...C`: the dog runs through the first 3 boxes without changing anything because there is no cat there. Then, when it gets to the last box, the cat hears it and escapes to box 3. Therefore, there is no cat in the last box in this case.\n*   `C..C`: when the dog barks near box 1, that startles the cat that goes through the tunnel to get to box 2, which was empty. Then, the same cat gets startled again when the dog barks near box 2 and gets to box 3. And when the dog barks next to box 3, the cat hears it and returns to box 1. Therefore, when the dog gets to box 4 and the other cats hears it, box 3 is empty so the cat escapes and the last box ends up empty.\n*   `.C.C`: This case is very similar to the previous one. After the dog goes through the first box and nothing happens, the state is the same as before, so the ultimate result is the same: last box empty.\n*   `CC.C`: In this case, the cat in the first box cannot escape when it hears the dog, so it remains in box 1. Then, when the cat in box 2 gets startled it escapes to box 3 leaving a state of `C.CC`. When the dog gets to the box 3, the cat currently there cannot escape to box 1 so the state remains the same. Finally, when the dog gets to the last box, the cat that is there cannot escape because box 3 is occupied this time. So, in this case, the last box ends up with a cat after the dog ends its journey.\n\nOut of the 4 possibilities, only 1 (the last one) ends up with a cat in the last box, so the answer is 1.\n\nIn Sample Case #2, the tunnels are set up the same as in Sample Case #1. Since no tunnel ends at the last box, the configurations that start with no cat at the last box will also not end with a cat there, so we do not need to count them. Then, we have 8 additional configurations. The 4 we considered for Sample Case #1, out of which only 1 ends up with a cat at the last box. The remaining 4 configurations are: `..CC`, `C.CC`, `.CCC`, `CCCC`. From these additional 4 configurations, only in the last one listed a cat ends up in the last box, for a total of 2 overall.\n\nIn Sample Case #3, notice that for a cat to remain in the last box after the dog barks near it, both that box and box 5 must be occupied then (otherwise, either there is no cat in the last box, or it will escape to box 5). Since there is no tunnel going into box 5, a cat must start there. As long as there is another cat in any other box, box 6 will get (or remain) occupied before the cat in box 5 gets an opportunity to escape, so all of those will end up with a cat in the last box. As we argued before, a single cat is not enough. Thus, we need to count the number of configurations with a cat in box 5 and at least one other cat. There are $2^4$ configurations with a cat in box 5, and out of those, only 1 has no other cat, so the answer is $2^4 - 1 = 15$.\n\nIn Sample Case #4, in all of the $2^k$ ways in which the $k$ unknown boxes may exist a cat would be left in the last box.\n\n**Limits**\n\n- $1 \\leq \\mathbf{T} \\leq 1234$.\n- the length of $\\mathbf{S} = \\mathbf{N}$.\nE- ach character of $\\mathbf{S}$ is either an upper case 'c', a period '.' or a question mark '?'.\n- $1 \\leq \\mathbf{B}_i \\leq \\mathbf{N}$, for all $i$.\n- $\\mathbf{B}_i \\neq i$, for all $i$.\n\n**Test Set 1 (8 Pts, Visible Verdict)**\n\n- $1 \\leq \\mathbf{N} \\leq 100$.\n- $i - 5 \\leq \\mathbf{B}_i \\leq i + 5$, for all $i$. (All tunnels connect to nearby boxes.)\n\n**Test Set 2 (42 Pts, Hidden Verdict)**\n\n- $1 \\leq \\mathbf{N} \\leq 5000$.", "locale": "en"}, "zh-CN": {"title": "[GCJ 2022 Finals] Schrödinger and Pavlov", "background": "", "description": "_本题目中所有故事、名称、角色和情节均为虚构。如有雷同，纯属巧合。_\n\n1935 年，两位诺贝尔奖得主的会面产生了惊人的结果。著名物理学家**薛定谔**邀请著名生理学家**巴甫洛夫**参观他的\"猫在箱子里\"的实验。巴甫洛夫带着他的狗一同前来以继续自己的研究，两者的实验相结合产生了有趣的现象。\n\n薛定谔有一排 $\\mathbf{N}$ 个箱子。某些箱子中肯定有一只猫，某些箱子肯定没有猫，还有些箱子可能有也可能没有猫。每个箱子只能容纳一只猫。每个箱子还配备了一个特殊的**量子隧道**，允许箱子里的猫移动到另一个特定的箱子（前提是目标箱子是空的）。隧道的运作是单向的。\n\n猫通常很安静，除非受到惊吓才会使用隧道。当一位不速之客按响门铃时，巴甫洛夫的狗立即兴奋起来，开始边跑边叫。狗从 1 号箱子开始，一直跑到 $\\mathbf{N}$ 号箱子。当它经过一个有猫的箱子时，会惊吓到里面的猫。受惊的猫会检查可用的隧道：如果目标箱子是空的，就会通过隧道逃跑；如果目标箱子已被占据，猫就会留在原地。同一只猫可能会被多次惊吓（如果它移动到了狗还未经过的箱子），每次受惊时都会以相同的方式检查隧道（但每次只能使用新位置的隧道）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xcqaev9m.png)\n\n当狗最终停在最后一个箱子旁时，巴甫洛夫问薛定谔最后一个箱子里是否有猫。薛定谔（不出所料）回答说他不知道。巴甫洛夫意识到，答案取决于那些未知箱子中是否有猫。由于有 $k$ 个未知箱子，共有 $2^k$ 种可能的**初始配置**（每种对应未知箱子状态的一种组合）。巴甫洛夫建议他们应该计算有多少种初始配置会导致最后一个箱子里有猫。你需要重现这个计算过程。由于结果可能非常大，只需输出其对质数 $10^9 + 7$（1000000007）取模的值。\n\n*在本题描述过程中，没有猫、狗或诺贝尔奖得主受到伤害。*", "inputFormat": "输入的第一行给出测试用例数量 $\\mathbf{T}$。随后每个测试用例由三行组成：第一行是整数 $\\mathbf{N}$（箱子数量，编号为 1 到 $\\mathbf{N}$）；第二行是长度为 $\\mathbf{N}$ 的字符串 $\\mathbf{S}$，其中第 $i$ 个字符表示 $i$ 号箱子的初始状态（'c'表示有猫，'.'表示无猫，'?'表示未知）；第三行包含 $\\mathbf{N}$ 个整数 $\\mathbf{B}_1, \\mathbf{B}_2, \\dots, \\mathbf{B}_\\mathbf{N}$，表示从 $i$ 号箱子出发的隧道通向 $\\mathbf{B}_i$ 号箱子。\n", "outputFormat": "对于每个测试用例，输出一行 `Case #x: y`，其中 $x$ 是测试用例编号（从 1 开始），$y$ 是会导致最后一个箱子最终有猫的初始配置数量（模 $10^9 + 7$）。\n", "hint": "**样例解释**\n\n样例 #1 的情况如题目描述所示。4 种可能的初始配置中，只有 `CC.C` 会导致最后一个箱子最终有猫。\n\n样例 #2 中，由于没有隧道通向最后一个箱子，只有当最后一个箱子初始有猫时才可能最终有猫。经分析共有 2 种符合条件的配置。\n\n样例 #3 中，要使最后一个箱子最终有猫，必须满足：5 号箱子初始有猫，且至少还有一个其他箱子有猫。符合条件的配置共有 $2^4 - 1 = 15$ 种。\n\n样例 #4 中，对于所有 $2^k$ 种可能的初始配置，最后一个箱子最终都会有猫。\n\n**限制条件**\n\n- $1 \\leq \\mathbf{T} \\leq 1234$\n- $\\mathbf{S}$ 的长度等于 $\\mathbf{N}$\n- $\\mathbf{S}$ 的每个字符是大写的 'c'、'.' 或 '?'\n- $1 \\leq \\mathbf{B}_i \\leq \\mathbf{N}$ 且 $\\mathbf{B}_i \\neq i$（所有 $i$）\n\n**测试集 1（8 分，可见判定）**\n\n- $1 \\leq \\mathbf{N} \\leq 100$\n- $i - 5 \\leq \\mathbf{B}_i \\leq i + 5$（所有隧道都连接到附近的箱子）\n\n**测试集 2（42 分，隐藏判定）**\n\n- $1 \\leq \\mathbf{N} \\leq 5000$\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P13005", "type": "P", "difficulty": 7, "samples": [["3\n9\n8 2\n10 2\n2 0\n0 5\n2 3\n10 4\n10 0\n8 3\n2 4\n7\n0 0\n0 3\n3 0\n0 1\n1 0\n1 1\n2 2\n3\n0 0\n0 1\n0 2", "Case #1: 3\n3 4 5\n1 7 9\n6 2 8\nCase #2: 2\n2 3 1\n6 5 4\nCase #3: 0"]], "limits": {"time": [15000, 15000, 15000], "memory": [1048576, 1048576, 1048576]}, "tags": ["贪心", "计算几何", "2022", "Special Judge", "构造", "Google Code Jam"], "title": "[GCJ 2022 Finals] Triangles", "background": "", "description": "You are given a set $P$ of $\\mathbf{N}$ distinct points in the two-dimensional plane. You want to find a maximum set of triangles such that:\n\n*   Each vertex of a triangle in your set is a point from $P$ and each point in $P$ is a vertex of at most one triangle in your set.\n*   Each triangle in your set has positive area (i.e., its 3 vertices are not collinear).\n*   For any two sides of triangles in your set, their intersection is either empty or an endpoint of one of them.\n*   For any two triangles in your set, the intersection of the areas strictly inside those triangles is either empty or equal to one of them.\n\nFor example, the set of triangles depicted below meets the definition above.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jxq6yve2.png)\n\nOn the other hand, each pair of a yellow and a red triangle in the picture below does not meet the definition.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/oyhps85j.png)", "inputFormat": "The first line of the input gives the number of test cases, $\\mathbf{T}$. $\\mathbf{T}$ test cases follow. Each test case starts with a line containing a single integer $\\mathbf{N}$. Then, $\\mathbf{N}$ lines follow. The $i$-th of these lines contains two integers $\\mathbf{X}_i$ and $\\mathbf{Y}_i$ representing the coordinates of the $i$-th point.\n", "outputFormat": "For each test case, output one line containing `Case #x: y`, where $x$ is the test case number (starting from 1) and $y$ is the maximum size of a set of triangles with the desired properties. Then, output $y$ more lines. The $j$-th of those lines must contain $p_j$ $q_j$ $r_j$ representing that the $j$-th triangle in your proposed set has the $p_j$-th, $q_j$-th, and $r_j$-th points in the input as vertices. Points in the input are numbered starting from 1.", "hint": "Sample Case #1 is illustrated below. Notice that there are other valid ways to construct a maximum number of triangles.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x975q63y.png)\n\nSample Case #2 is illustrated below. As before, there are other valid ways to construct 2 triangles.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7ca1oxq2.png)\n\nIn Sample Case #3, the 3 given points are collinear, so it is not possible to make a valid triangle with them.\n\n**Limits**\n\n- $1 \\leq \\mathbf{T} \\leq 100$.\n- $-10^9 \\leq \\mathbf{X}_i \\leq 10^9$, for all $i$.\n- $-10^9 \\leq \\mathbf{Y}_i \\leq 10^9$, for all $i$.\n- $(\\mathbf{X}_i, \\mathbf{Y}_i) \\neq (\\mathbf{X}_j, \\mathbf{Y}_j)$, for all $i \\neq j$.\n\n**Test Set 1 (8 Pts, Visible Verdict)**\n\n- $3 \\leq \\mathbf{N} \\leq 12$.\n\n**Test Set 2 (42 Pts, Hidden Verdict)**\n\n- $3 \\leq \\mathbf{N} \\leq 3000$.", "locale": "en", "translations": {"en": {"title": "[GCJ 2022 Finals] Triangles", "background": "", "description": "You are given a set $P$ of $\\mathbf{N}$ distinct points in the two-dimensional plane. You want to find a maximum set of triangles such that:\n\n*   Each vertex of a triangle in your set is a point from $P$ and each point in $P$ is a vertex of at most one triangle in your set.\n*   Each triangle in your set has positive area (i.e., its 3 vertices are not collinear).\n*   For any two sides of triangles in your set, their intersection is either empty or an endpoint of one of them.\n*   For any two triangles in your set, the intersection of the areas strictly inside those triangles is either empty or equal to one of them.\n\nFor example, the set of triangles depicted below meets the definition above.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jxq6yve2.png)\n\nOn the other hand, each pair of a yellow and a red triangle in the picture below does not meet the definition.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/oyhps85j.png)", "inputFormat": "The first line of the input gives the number of test cases, $\\mathbf{T}$. $\\mathbf{T}$ test cases follow. Each test case starts with a line containing a single integer $\\mathbf{N}$. Then, $\\mathbf{N}$ lines follow. The $i$-th of these lines contains two integers $\\mathbf{X}_i$ and $\\mathbf{Y}_i$ representing the coordinates of the $i$-th point.\n", "outputFormat": "For each test case, output one line containing `Case #x: y`, where $x$ is the test case number (starting from 1) and $y$ is the maximum size of a set of triangles with the desired properties. Then, output $y$ more lines. The $j$-th of those lines must contain $p_j$ $q_j$ $r_j$ representing that the $j$-th triangle in your proposed set has the $p_j$-th, $q_j$-th, and $r_j$-th points in the input as vertices. Points in the input are numbered starting from 1.", "hint": "Sample Case #1 is illustrated below. Notice that there are other valid ways to construct a maximum number of triangles.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x975q63y.png)\n\nSample Case #2 is illustrated below. As before, there are other valid ways to construct 2 triangles.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7ca1oxq2.png)\n\nIn Sample Case #3, the 3 given points are collinear, so it is not possible to make a valid triangle with them.\n\n**Limits**\n\n- $1 \\leq \\mathbf{T} \\leq 100$.\n- $-10^9 \\leq \\mathbf{X}_i \\leq 10^9$, for all $i$.\n- $-10^9 \\leq \\mathbf{Y}_i \\leq 10^9$, for all $i$.\n- $(\\mathbf{X}_i, \\mathbf{Y}_i) \\neq (\\mathbf{X}_j, \\mathbf{Y}_j)$, for all $i \\neq j$.\n\n**Test Set 1 (8 Pts, Visible Verdict)**\n\n- $3 \\leq \\mathbf{N} \\leq 12$.\n\n**Test Set 2 (42 Pts, Hidden Verdict)**\n\n- $3 \\leq \\mathbf{N} \\leq 3000$.", "locale": "en"}, "zh-CN": {"title": "[GCJ 2022 Finals] Triangles", "background": "", "description": "给定二维平面上的一个点集 $P$，包含 $\\mathbf{N}$ 个互不相同的点。你需要找到一个最大的三角形集合满足以下条件：\n\n* 集合中每个三角形的顶点都来自 $P$，且 $P$ 中的每个点最多作为一个三角形的一个顶点。\n* 集合中的每个三角形面积必须为正（即三个顶点不共线）。\n* 对于集合中任意两个三角形的边，它们的交集要么为空，要么是其中一条边的端点。\n* 对于集合中任意两个三角形，它们内部区域的交集要么为空，要么完全等于其中一个三角形。\n\n下图展示的三角形集合满足以上所有条件：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jxq6yve2.png)\n\n而下图中任意一对黄色和红色三角形的组合都不满足条件：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/oyhps85j.png)", "inputFormat": "输入的第一行给出测试用例的数量 $\\mathbf{T}$。随后每个测试用例的第一行是一个整数 $\\mathbf{N}$，接着 $\\mathbf{N}$ 行，每行包含两个整数 $\\mathbf{X}_i$ 和 $\\mathbf{Y}_i$，表示第 $i$ 个点的坐标。\n", "outputFormat": "对于每个测试用例，首先输出一行 `Case #x: y`，其中 $x$ 是测试用例编号（从 1 开始），$y$ 是满足条件的三角形集合的最大大小。然后输出 $y$ 行，每行三个整数 $p_j\\ q_j\\ r_j$，表示第 $j$ 个三角形由输入中的第 $p_j$、$q_j$ 和 $r_j$ 个点组成（点从 1 开始编号）。\n", "hint": "**样例解释**\n\n样例 #1 如下图所示。注意存在其他有效的构造方式也能达到最大三角形数量：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x975q63y.png)\n\n样例 #2 如下图所示。同样存在其他有效的构造方式能组成 2 个三角形：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7ca1oxq2.png)\n\n样例 #3 中，所有给定点共线，因此无法组成有效的三角形。\n\n**限制条件**\n\n- $1 \\leq \\mathbf{T} \\leq 100$\n- $-10^9 \\leq \\mathbf{X}_i \\leq 10^9$（所有 $i$）\n- $-10^9 \\leq \\mathbf{Y}_i \\leq 10^9$（所有 $i$）\n- 所有点的坐标互不相同\n\n**测试集 1（8 分，可见判定）**\n\n- $3 \\leq \\mathbf{N} \\leq 12$\n\n**测试集 2（42 分，隐藏判定）**\n\n- $3 \\leq \\mathbf{N} \\leq 3000$\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P13006", "type": "P", "difficulty": 1, "samples": [["zxx : zxx is weak.", "Plang."], ["zxx : ou is strong.", "Not plang."], ["zxx : zxx is cute.", "Not plang."]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["模拟", "O2优化", "梦熊比赛"], "title": "【MX-X13-T1】「KDOI-12」在现实和志向中选择现实，否则会一个都得不到的。", "background": "现实中的你加入了一个群聊，这个群聊总是有人说批话。", "description": "定义一句话为 $A\\underline{\\texttt{ : }}B\\underline{\\texttt{ is }}C\\underline{\\texttt{.}}$，其中 $A,B,C$ 均为字符串，分别表示这个人的名称，句子的主语以及表语。\n\n一句话是批话当且仅当这个人在说自己菜，也就是，$A$ 与 $B$ 相同且 $C=\\underline{\\texttt{weak}}$。\n\n现在，你先判断给出的这句话是否是批话。如果是批话输出 `Plang.`，否则输出 `Not plang.`。", "inputFormat": "仅一行，一个形如 $A\\underline{\\texttt{ : }}B\\underline{\\texttt{ is }}C\\underline{\\texttt{.}}$ 的字符串。**保证 $A,B,C$ 由且仅由小写英文字母组成**。", "outputFormat": "仅一行，如果给出句子是批话则输出 `Plang.`，否则输出 `Not plang.`。", "hint": "**【样例解释 \\#1】**\n\n在第一个样例中，$A=\\text{zxx}$，$B=\\text{zxx}$，$C=\\text{weak}$。这句话中，$\\text{zxx}$ 在说自己菜，这是一句批话。因此，应当输出 `Plang.`。\n\n**【数据范围】**\n\n| 测试点编号 | 特殊性质 |\n|:--:|:--:|\n| $1\\sim7$ | A |\n| $8\\sim20$ | 无特殊性质 |\n\n* 特殊性质 A：$C=\\underline{\\texttt{weak}}$。\n\n对于所有数据：保证 $A,B,C$ 为长度不少于 $1$，不超过 $10$ 的由小写英文字母组成的字符串。", "locale": "zh-CN", "translations": {"en": {"title": "【MX-X13-T1】\"KDOI-12\" Choosing Reality Over Ambition in Reality, Otherwise You'll Get Neither.", "background": "In reality, you joined a group chat where people often talk nonsense.", "description": "A sentence is defined as $A\\underline{\\texttt{ : }}B\\underline{\\texttt{ is }}C\\underline{\\texttt{.}}$, where $A$, $B$, and $C$ are strings representing the speaker's name, the subject of the sentence, and the predicative, respectively.  \n\nA sentence is considered nonsense if and only if the speaker is calling themselves weak—that is, $A$ is the same as $B$ and $C=\\underline{\\texttt{weak}}$.  \n\nNow, you need to determine whether the given sentence is nonsense. If it is, output `Plang.`; otherwise, output `Not plang.`.  \n", "inputFormat": "A single line containing a string in the form of $A\\underline{\\texttt{ : }}B\\underline{\\texttt{ is }}C\\underline{\\texttt{.}}$. **It is guaranteed that $A$, $B$, and $C$ consist solely of lowercase English letters**.  \n", "outputFormat": "A single line. If the given sentence is nonsense, output `Plang.`; otherwise, output `Not plang.`.  \n", "hint": "### **Explanation for Sample #1**\n\nIn the first sample, $A=\\text{zxx}$, $B=\\text{zxx}$, and $C=\\text{weak}$. Here, $\\text{zxx}$ is calling themselves weak, which qualifies as nonsense. Therefore, the output should be `Plang.`.  \n\n### **Data Range**\n\n| Test Case ID | Special Property |\n|:--:|:--:|\n| $1\\sim7$ | A |\n| $8\\sim20$ | No special property |\n\n* **Special Property A**: $C=\\underline{\\texttt{weak}}$.  \n\nFor all test cases: It is guaranteed that $A$, $B$, and $C$ are strings consisting solely of lowercase English letters, with lengths between $1$ and $10$ (inclusive).  \n\n---\n\n*Translated by DeepSeek V3.*", "locale": "en"}, "zh-CN": {"title": "【MX-X13-T1】「KDOI-12」在现实和志向中选择现实，否则会一个都得不到的。", "background": "现实中的你加入了一个群聊，这个群聊总是有人说批话。", "description": "定义一句话为 $A\\underline{\\texttt{ : }}B\\underline{\\texttt{ is }}C\\underline{\\texttt{.}}$，其中 $A,B,C$ 均为字符串，分别表示这个人的名称，句子的主语以及表语。\n\n一句话是批话当且仅当这个人在说自己菜，也就是，$A$ 与 $B$ 相同且 $C=\\underline{\\texttt{weak}}$。\n\n现在，你先判断给出的这句话是否是批话。如果是批话输出 `Plang.`，否则输出 `Not plang.`。", "inputFormat": "仅一行，一个形如 $A\\underline{\\texttt{ : }}B\\underline{\\texttt{ is }}C\\underline{\\texttt{.}}$ 的字符串。**保证 $A,B,C$ 由且仅由小写英文字母组成**。", "outputFormat": "仅一行，如果给出句子是批话则输出 `Plang.`，否则输出 `Not plang.`。", "hint": "**【样例解释 \\#1】**\n\n在第一个样例中，$A=\\text{zxx}$，$B=\\text{zxx}$，$C=\\text{weak}$。这句话中，$\\text{zxx}$ 在说自己菜，这是一句批话。因此，应当输出 `Plang.`。\n\n**【数据范围】**\n\n| 测试点编号 | 特殊性质 |\n|:--:|:--:|\n| $1\\sim7$ | A |\n| $8\\sim20$ | 无特殊性质 |\n\n* 特殊性质 A：$C=\\underline{\\texttt{weak}}$。\n\n对于所有数据：保证 $A,B,C$ 为长度不少于 $1$，不超过 $10$ 的由小写英文字母组成的字符串。", "locale": "zh-CN"}}}
{"pid": "P13007", "type": "P", "difficulty": 3, "samples": [["3\n4 2\n00\n01\n10\n11\n5 4\n1110\n1100\n1000\n0001\n0000\n7 4\n0101\n1101\n1001\n0010\n1110\n0100\n1000", "4\n4\n7"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["图论", "O2优化", "枚举", "位运算", "梦熊比赛"], "title": "【MX-X13-T2】「KDOI-12」不要去思考未来，把这留给未来的你。", "background": "未来的你在打一场模拟赛。", "description": "模拟赛中共有 $T$ 道题，每道题有 $n$ 个子任务和 $m$ 个特殊性质。每个子任务均满足 $m$ 个特殊性质的一个子集。\n\n定义一组子任务依赖 $(i,j)$ 表示子任务 $j$ 依赖子任务 $i$，也就是只有通过了子任务 $i$ 才能通过子任务 $j$。\n\n考虑到模拟赛有懒惰的出题人和愚蠢的在线法官，子任务依赖的条数必然是越少越好。现在你想知道最少配置多少组子任务依赖才能保证：\n\n* 不存在一对子任务 $x,y$ 使得满足子任务 $y$ 的数据必然满足子任务 $x$，但是在不通过子任务 $x$ 的情况下**仍然有可能**通过子任务 $y$；\n* 不存在一对子任务 $x,y$ 使得存在满足子任务 $y$ 的数据**不**满足子任务 $x$，但是在不通过子任务 $x$ 的情况下**无法**通过子任务 $y$。\n\n形式化地讲，设第 $i$ 个子任务的特殊性质集合为 $S_i$，那么你要选择尽可能少的 $(u_x,v_x)$ 二元组使得：\n\n* 对于任意 $(i,j)$ 满足 $S_i\\subseteq S_j$，均存在 $j=p_1,p_2,\\dots,p_M=i$ 使得对于任意 $1\\leq k<M$，存在 $x$ 使得 $u_x=p_k,v_x=p_{k+1}$；\n* 对于任意 $(i,j)$ **不**满足 $S_i\\subseteq S_j$，均**不**存在 $j=p_1,p_2,\\dots,p_M=i$ 使得对于任意 $1\\leq k<M$，存在 $x$ 使得 $u_x=p_k,v_x=p_{k+1}$。\n\n并求出选择二元组数量的最小值。", "inputFormat": "第一行，一个正整数 $T$，表示题目数量。对于每道题目：\n\n* 第一行，两个正整数 $n,m$，表示子任务数量和特殊性质数量。\n* 接下来 $n$ 行，每行一个长度为 $m$ 的 `01` 串。第 $i$ 个子任务满足特殊性质 $j$ 当且仅当第 $i$ 行的字符串的第 $j$ 个字符为 `1`。\n\n**保证不存在两个子任务满足的特殊性质相同。**", "outputFormat": "对于每道题目，一行，一个非负整数，表示子任务依赖数量的最小值。", "hint": "**【样例解释】**\n\n对于第二道题目：不妨设四个特殊性质分别为 $\\text{ABCD}$，那么五个子任务分别符合特殊性质 $\\{\\text{ABC}\\}$、$\\{\\text{AB}\\}$、$\\{\\text{A}\\}$、$\\{\\text{D}\\}$、和 $\\varnothing$。可以证明，配置以下子任务依赖符合要求且最优：\n\n* $(1,2)$；\n* $(2,3)$；\n* $(3,5)$；\n* $(4,5)$。\n\n**【数据范围】**\n\n| 测试点编号 | $n,m\\leq$ | 特殊性质 |\n|:--:|:--:|:--:|\n| $1\\sim2$ | $2$ | 无 |\n| $3\\sim9$ | $5$ | 无 |\n| $10\\sim13$ | $10$ | 无 |\n| $14\\sim20$ | $16$ | A |\n| $21\\sim25$ | $16$ | 无 |\n\n* 特殊性质 A：保证每个子任务最多满足两个特殊性质。\n\n对于所有数据：$1\\leq T\\leq 6$，$1\\leq n,m\\leq16$，输入的字符串由 `0` 和 `1` 组成，保证不存在两个子任务满足的特殊性质相同。", "locale": "zh-CN", "translations": {"en": {"title": "T622835 【MX-X13-T2】\"KDOI-12\" Don't Think About the Future, Leave It to Your Future Self  ", "background": "Your future self is participating in a mock contest.  \n", "description": "The mock contest consists of $T$ problems. Each problem has $n$ subtasks and $m$ special properties. Each subtask satisfies a subset of the $m$ special properties.  \n\nA **subtask dependency** $(i,j)$ means that subtask $j$ depends on subtask $i$—that is, subtask $j$ can only be passed after subtask $i$ is passed.  \n\nConsidering that the problem setters are lazy and the online judge is \"not very smart,\" the number of subtask dependencies should be minimized. Now, you need to determine the minimum number of subtask dependencies required to ensure:  \n\n1. There does **not** exist a pair of subtasks $(x, y)$ such that:  \n   - All test cases satisfying subtask $y$ must also satisfy subtask $x$, but  \n   - It is still **possible** to pass subtask $y$ **without** passing subtask $x$.  \n\n2. There does **not** exist a pair of subtasks $(x, y)$ such that:  \n   - There exists a test case satisfying subtask $y$ but **not** satisfying subtask $x$, but  \n   - It is **impossible** to pass subtask $y$ **without** passing subtask $x$.  \n\nFormally, let $S_i$ denote the set of special properties satisfied by subtask $i$. You need to select the smallest possible number of $(u_x, v_x)$ pairs such that:  \n\n- For any $(i,j)$ where $S_i \\subseteq S_j$, there exists a sequence $j = p_1, p_2, \\dots, p_m = i$ such that for all $1 \\leq k < m$, there exists $x$ where $(u_x, v_x) = (p_k, p_{k+1})$.  \n- For any $(i,j)$ where $S_i \\not\\subseteq S_j$, there does **not** exist any sequence $j = p_1, p_2, \\dots, p_m = i$ such that for all $1 \\leq k < m$, there exists $x$ where $(u_x, v_x) = (p_k, p_{k+1})$.  \n\nYour task is to find the minimum number of such pairs.  ", "inputFormat": "- The first line contains a positive integer $T$, the number of problems.  \n- For each problem:  \n  - The first line contains two positive integers $n$ and $m$, the number of subtasks and special properties, respectively.  \n  - The next $n$ lines each contain a binary string of length $m$. The $j$-th character of the $i$-th string is `1` if and only if the $i$-th subtask satisfies the $j$-th special property.  \n  - **It is guaranteed that no two subtasks satisfy the exact same set of special properties.**  \n", "outputFormat": "For each problem, output a single non-negative integer—the minimum number of subtask dependencies required.  \n", "hint": "### **Sample Explanation**  \n\nFor the second problem: Suppose the four special properties are $\\text{ABCD}$. Then, the five subtasks correspond to the following sets:  \n\n- $\\{\\text{A}, \\text{B}, \\text{C}\\}$  \n- $\\{\\text{A}, \\text{B}\\}$  \n- $\\{\\text{A}\\}$  \n- $\\{\\text{D}\\}$  \n- $\\varnothing$ (empty set)  \n\nThe following dependency configuration is optimal:  \n\n- $(1, 2)$  \n- $(2, 3)$  \n- $(3, 5)$  \n- $(4, 5)$  \n\n### **Data Range**  \n\n| Test Case | $n, m \\leq$ | Special Property |  \n|:--:|:--:|:--:|  \n| $1\\sim2$ | $2$ | None |  \n| $3\\sim9$ | $5$ | None |  \n| $10\\sim13$ | $10$ | None |  \n| $14\\sim20$ | $16$ | A |  \n| $21\\sim25$ | $16$ | None |  \n\n- **Special Property A**: Each subtask satisfies at most two special properties.  \n\nFor all test cases:  \n- $1 \\leq T \\leq 6$,  \n- $1 \\leq n, m \\leq 16$,  \n- Input strings consist of `0` and `1`,  \n- No two subtasks share the exact same set of special properties.  \n\n---\n\n*Translated by DeepSeek V3.*  ", "locale": "en"}, "zh-CN": {"title": "【MX-X13-T2】「KDOI-12」不要去思考未来，把这留给未来的你。", "background": "未来的你在打一场模拟赛。", "description": "模拟赛中共有 $T$ 道题，每道题有 $n$ 个子任务和 $m$ 个特殊性质。每个子任务均满足 $m$ 个特殊性质的一个子集。\n\n定义一组子任务依赖 $(i,j)$ 表示子任务 $j$ 依赖子任务 $i$，也就是只有通过了子任务 $i$ 才能通过子任务 $j$。\n\n考虑到模拟赛有懒惰的出题人和愚蠢的在线法官，子任务依赖的条数必然是越少越好。现在你想知道最少配置多少组子任务依赖才能保证：\n\n* 不存在一对子任务 $x,y$ 使得满足子任务 $y$ 的数据必然满足子任务 $x$，但是在不通过子任务 $x$ 的情况下**仍然有可能**通过子任务 $y$；\n* 不存在一对子任务 $x,y$ 使得存在满足子任务 $y$ 的数据**不**满足子任务 $x$，但是在不通过子任务 $x$ 的情况下**无法**通过子任务 $y$。\n\n形式化地讲，设第 $i$ 个子任务的特殊性质集合为 $S_i$，那么你要选择尽可能少的 $(u_x,v_x)$ 二元组使得：\n\n* 对于任意 $(i,j)$ 满足 $S_i\\subseteq S_j$，均存在 $j=p_1,p_2,\\dots,p_M=i$ 使得对于任意 $1\\leq k<M$，存在 $x$ 使得 $u_x=p_k,v_x=p_{k+1}$；\n* 对于任意 $(i,j)$ **不**满足 $S_i\\subseteq S_j$，均**不**存在 $j=p_1,p_2,\\dots,p_M=i$ 使得对于任意 $1\\leq k<M$，存在 $x$ 使得 $u_x=p_k,v_x=p_{k+1}$。\n\n并求出选择二元组数量的最小值。", "inputFormat": "第一行，一个正整数 $T$，表示题目数量。对于每道题目：\n\n* 第一行，两个正整数 $n,m$，表示子任务数量和特殊性质数量。\n* 接下来 $n$ 行，每行一个长度为 $m$ 的 `01` 串。第 $i$ 个子任务满足特殊性质 $j$ 当且仅当第 $i$ 行的字符串的第 $j$ 个字符为 `1`。\n\n**保证不存在两个子任务满足的特殊性质相同。**", "outputFormat": "对于每道题目，一行，一个非负整数，表示子任务依赖数量的最小值。", "hint": "**【样例解释】**\n\n对于第二道题目：不妨设四个特殊性质分别为 $\\text{ABCD}$，那么五个子任务分别符合特殊性质 $\\{\\text{ABC}\\}$、$\\{\\text{AB}\\}$、$\\{\\text{A}\\}$、$\\{\\text{D}\\}$、和 $\\varnothing$。可以证明，配置以下子任务依赖符合要求且最优：\n\n* $(1,2)$；\n* $(2,3)$；\n* $(3,5)$；\n* $(4,5)$。\n\n**【数据范围】**\n\n| 测试点编号 | $n,m\\leq$ | 特殊性质 |\n|:--:|:--:|:--:|\n| $1\\sim2$ | $2$ | 无 |\n| $3\\sim9$ | $5$ | 无 |\n| $10\\sim13$ | $10$ | 无 |\n| $14\\sim20$ | $16$ | A |\n| $21\\sim25$ | $16$ | 无 |\n\n* 特殊性质 A：保证每个子任务最多满足两个特殊性质。\n\n对于所有数据：$1\\leq T\\leq 6$，$1\\leq n,m\\leq16$，输入的字符串由 `0` 和 `1` 组成，保证不存在两个子任务满足的特殊性质相同。", "locale": "zh-CN"}}}
{"pid": "P13008", "type": "P", "difficulty": 4, "samples": [["5\n2 4 1\n2 5\n2 5 2\n2 5 2\n3 9 2\n1 2 3\n4 23 3\n1 5 2 4\n1 114 5\n1 4 1 9 19 8", "4\n4\n5\n11\n29"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "贪心", "O2优化", "位运算", "梦熊比赛"], "title": "【MX-X13-T3】「KDOI-12」只有失去光明，才能逃脱黑暗。", "background": "", "description": "给定一个非负整数 $x$，你要经过若干次以下操作将其变成 $y$，求最小代价：\n\n* 选择一个 $0\\leq i\\leq k$，花费 $a_i$ 代价将 $x$ 加或减 $2^i$。\n\n**注意：你在操作时不需要保证 $x$ 为非负整数。**", "inputFormat": "**本题有多组测试数据。**\n\n第一行，一个正整数 $T$，表示测试数据组数。对于每组测试数据：\n\n* 第一行，三个非负整数 $x,y,k$。\n* 第二行，$k+1$ 个正整数 $a_0, \\ldots, a_k$。", "outputFormat": "对于每组测试数据，一行，一个非负整数，表示最小代价。", "hint": "**【样例解释】**\n\n对于样例的第二组测试数据：经过以下两次操作即可让 $x$ 变为 $y$，且代价最小：\n\n* 取 $i=2$，令 $x\\gets x+2^2$，此时 $x=6$，总代价为 $2$；\n* 取 $i=0$，令 $x\\gets x-2^0$，此时 $x=5$，总代价为 $4$。\n\n**【数据范围】**\n\n**本题使用捆绑测试。**\n\n| 子任务编号 | 分值 | $T\\leq$ | $x,y<$ | $k\\leq$ | $a_i$  |\n|:--:|:--:|:--:|:--:|:--:|:--:|\n| $1$ | $6$ | $10^3$ | $2^3$ | $3$ | $\\leq10^9$ |\n| $2$ | $15$ | $10^3$ | $2^{10}$ | $10$ | $\\leq10^9$ |\n| $3$ | $21$ | $2\\times10^5$ | $2^{30}$ | $1$ | $\\leq10^9$ |\n| $4$ | $27$ | $2\\times10^5$ | $2^{30}$ | $30$ | $\\leq2$ |\n| $5$ | $20$ | $10^4$ | $2^{30}$ | $30$ | $\\leq10^9$ |\n| $6$ | $11$ | $2\\times10^5$ | $2^{30}$ | $30$ | $\\leq10^9$ |\n\n对于所有数据：$1\\leq T\\leq2\\times10^5$，$0\\leq x,y<2^{30}$，$1\\leq k\\leq 30$，$1\\leq a_i\\leq10^9$。\n\n**【提示】**\n\n请使用较快的读入方式。", "locale": "zh-CN", "translations": {"en": {"title": "【MX-X13-T3】\"KDOI-12\" Only by Losing Light Can You Escape Darkness", "background": "", "description": "Given a non-negative integer $x$, you need to transform it into $y$ through a series of operations with the minimum cost. Each operation is defined as follows:\n\n* Choose an integer $0 \\leq i \\leq k$, and pay a cost of $a_i$ to either add or subtract $2^i$ from $x$.\n\n**Note: You do not need to ensure that $x$ remains non-negative during the operations.**", "inputFormat": "For each test case, output a single non-negative integer—the minimum cost required to transform $x$ into $y$.\n", "outputFormat": "For each test case, output a single non-negative integer—the minimum cost required to transform $x$ into $y$.\n", "hint": "### **Sample Explanation**\n\nFor the second test case in the sample input, the following two operations transform $x$ into $y$ with the minimum cost:\n\n1. Choose $i=2$, perform $x \\gets x + 2^2$, resulting in $x=6$ with a cost of $2$.\n2. Choose $i=0$, perform $x \\gets x - 2^0$, resulting in $x=5$ with an additional cost of $2$, totaling $4$.\n\n### **Data Range**\n\n**This problem uses bundled testing.**\n\n| Subtask | Points | $T \\leq$ | $x, y <$ | $k \\leq$ | $a_i$ |\n|:--:|:--:|:--:|:--:|:--:|:--:|\n| $1$ | $6$ | $10^3$ | $2^3$ | $3$ | $\\leq 10^9$ |\n| $2$ | $15$ | $10^3$ | $2^{10}$ | $10$ | $\\leq 10^9$ |\n| $3$ | $21$ | $2 \\times 10^5$ | $2^{30}$ | $1$ | $\\leq 10^9$ |\n| $4$ | $27$ | $2 \\times 10^5$ | $2^{30}$ | $30$ | $\\leq 2$ |\n| $5$ | $20$ | $10^4$ | $2^{30}$ | $30$ | $\\leq 10^9$ |\n| $6$ | $11$ | $2 \\times 10^5$ | $2^{30}$ | $30$ | $\\leq 10^9$ |\n\nFor all test cases:  \n- $1 \\leq T \\leq 2 \\times 10^5$,  \n- $0 \\leq x, y < 2^{30}$,  \n- $1 \\leq k \\leq 30$,  \n- $1 \\leq a_i \\leq 10^9$.  \n\n### **Hint**\n\nPlease use fast input methods for reading data.\n\n---\n\n*Translated by DeepSeek V3.*  ", "locale": "en"}, "zh-CN": {"title": "【MX-X13-T3】「KDOI-12」只有失去光明，才能逃脱黑暗。", "background": "", "description": "给定一个非负整数 $x$，你要经过若干次以下操作将其变成 $y$，求最小代价：\n\n* 选择一个 $0\\leq i\\leq k$，花费 $a_i$ 代价将 $x$ 加或减 $2^i$。\n\n**注意：你在操作时不需要保证 $x$ 为非负整数。**", "inputFormat": "**本题有多组测试数据。**\n\n第一行，一个正整数 $T$，表示测试数据组数。对于每组测试数据：\n\n* 第一行，三个非负整数 $x,y,k$。\n* 第二行，$k+1$ 个正整数 $a_0, \\ldots, a_k$。", "outputFormat": "对于每组测试数据，一行，一个非负整数，表示最小代价。", "hint": "**【样例解释】**\n\n对于样例的第二组测试数据：经过以下两次操作即可让 $x$ 变为 $y$，且代价最小：\n\n* 取 $i=2$，令 $x\\gets x+2^2$，此时 $x=6$，总代价为 $2$；\n* 取 $i=0$，令 $x\\gets x-2^0$，此时 $x=5$，总代价为 $4$。\n\n**【数据范围】**\n\n**本题使用捆绑测试。**\n\n| 子任务编号 | 分值 | $T\\leq$ | $x,y<$ | $k\\leq$ | $a_i$  |\n|:--:|:--:|:--:|:--:|:--:|:--:|\n| $1$ | $6$ | $10^3$ | $2^3$ | $3$ | $\\leq10^9$ |\n| $2$ | $15$ | $10^3$ | $2^{10}$ | $10$ | $\\leq10^9$ |\n| $3$ | $21$ | $2\\times10^5$ | $2^{30}$ | $1$ | $\\leq10^9$ |\n| $4$ | $27$ | $2\\times10^5$ | $2^{30}$ | $30$ | $\\leq2$ |\n| $5$ | $20$ | $10^4$ | $2^{30}$ | $30$ | $\\leq10^9$ |\n| $6$ | $11$ | $2\\times10^5$ | $2^{30}$ | $30$ | $\\leq10^9$ |\n\n对于所有数据：$1\\leq T\\leq2\\times10^5$，$0\\leq x,y<2^{30}$，$1\\leq k\\leq 30$，$1\\leq a_i\\leq10^9$。\n\n**【提示】**\n\n请使用较快的读入方式。", "locale": "zh-CN"}}}
{"pid": "P13009", "type": "P", "difficulty": 4, "samples": [["3\n2 5\n1 2\n5 10\n1 5 2 4 3\n10 10\n1 4 2 5 1 6 2 7 1 10", "7 1\n28 3\n80 5"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "贪心", "O2优化", "整除分块", "梦熊比赛"], "title": "【MX-X13-T4】「KDOI-12」好胜是人的本能，功利是社会的本性。", "background": "", "description": "给定一个长度为 $n$ 的正整数序列 $a_1, \\ldots, a_n$ 以及一个正整数 $m$ 满足 $m \\ge \\max a_i$。\n\n你可以对序列进行任意次操作（也可以不操作）。每次操作你可以选择一个区间 $[l,r]$，然后对于所有 $l\\leq i\\leq r$，令 $a_i\\gets\\bigl\\lfloor\\frac{m}{a_i}\\bigr\\rfloor$。\n\n求可以得到的 $\\sum_{j=1}^na_j$ 的最大值以及对应的最少操作次数。", "inputFormat": "**本题有多组测试数据。**\n\n第一行，一个正整数 $T$，表示测试数据组数。对于每组测试数据：\n\n* 第一行，两个正整数 $n,m$。\n* 第二行，$n$ 个正整数 $a_1, \\ldots, a_n$。", "outputFormat": "对于每组测试数据，一行，两个非负整数，分别表示 $\\sum_{j=1}^na_j$ 的最大值以及对应的最少操作次数。", "hint": "**【样例解释】**\n\n对于样例的第二组测试数据：选择以下 $3$ 组 $[l,r]$ 即可得到最大值 $28$：\n\n* $[1,2]$；\n* $[2,5]$；\n* $[4,5]$。\n\n可以证明该方案是最优的之一。\n\n**【数据范围】**\n\n**本题使用捆绑测试。**\n\n| 子任务编号 | 分值 | $n\\leq$ | $\\sum n\\leq$ | 特殊性质 |\n|:--:|:--:|:--:|:--:|:--:|\n| $1$ | $9$ | $4$ | $400$ | 无 |\n| $2$ | $27$ | $10^3$ | $10^4$ | 无 |\n| $3$ | $11$ | $10^5$ | $10^6$ | A |\n| $4$ | $16$ | $10^5$ | $10^6$ | B |\n| $5$ | $37$ | $10^5$ | $10^6$ | 无 |\n\n* 特殊性质 A：$a_i\\leq\\sqrt m$；\n* 特殊性质 B：$a_i\\mid m$。\n\n对于所有数据：$1\\leq T\\leq 10^5$，$1\\leq n\\leq 10^5$，$1\\leq\\sum n\\leq10^6$，$1\\leq a_i\\leq m\\leq10^{12}$。", "locale": "zh-CN", "translations": {"en": {"title": "【MX-X13-T4】\"KDOI-12\" Competitiveness is Human Nature, Utility is Society's Nature", "background": "", "description": "Given a sequence of positive integers $a_1, \\ldots, a_n$ of length $n$ and a positive integer $m$ satisfying $m \\geq \\max a_i$, you can perform any number of operations (including zero) on the sequence. In each operation, you may select an interval $[l, r]$ and for all $l \\leq i \\leq r$, set $a_i \\gets \\left\\lfloor \\frac{m}{a_i} \\right\\rfloor$. \n\nYour task is to determine:\n1. The maximum possible value of $\\sum_{j=1}^n a_j$ achievable through these operations.\n2. The minimum number of operations required to achieve this maximum sum.", "inputFormat": "**This problem contains multiple test cases.**\n\n- The first line contains a positive integer $T$, the number of test cases.\n- For each test case:\n  - The first line contains two positive integers $n$ and $m$.\n  - The second line contains $n$ positive integers $a_1, \\ldots, a_n$.", "outputFormat": "For each test case, output two non-negative integers:\n1. The maximum possible sum $\\sum_{j=1}^n a_j$.\n2. The minimum number of operations required to achieve this sum.", "hint": "### **Sample Explanation**\n\nFor the second test case in the sample input, selecting the following 3 intervals achieves the maximum sum of $28$:\n\n1. $[1, 2]$\n2. $[2, 5]$\n3. $[4, 5]$\n\nIt can be proven that this is one of the optimal solutions.\n\n### **Data Range**\n\n**This problem uses bundled testing.**\n\n| Subtask | Points | $n \\leq$ | $\\sum n \\leq$ | Special Properties |\n|:--:|:--:|:--:|:--:|:--:|\n| $1$ | $9$ | $4$ | $400$ | None |\n| $2$ | $27$ | $10^3$ | $10^4$ | None |\n| $3$ | $11$ | $10^5$ | $10^6$ | A |\n| $4$ | $16$ | $10^5$ | $10^6$ | B |\n| $5$ | $37$ | $10^5$ | $10^6$ | None |\n\n- **Special Property A**: $a_i \\leq \\sqrt{m}$.\n- **Special Property B**: $a_i$ divides $m$ (i.e., $a_i \\mid m$).\n\nFor all test cases:\n- $1 \\leq T \\leq 10^5$,\n- $1 \\leq n \\leq 10^5$,\n- $1 \\leq \\sum n \\leq 10^6$,\n- $1 \\leq a_i \\leq m \\leq 10^{12}$.\n\n---\n\n*Translated by DeepSeek V3.*", "locale": "en"}, "zh-CN": {"title": "【MX-X13-T4】「KDOI-12」好胜是人的本能，功利是社会的本性。", "background": "", "description": "给定一个长度为 $n$ 的正整数序列 $a_1, \\ldots, a_n$ 以及一个正整数 $m$ 满足 $m \\ge \\max a_i$。\n\n你可以对序列进行任意次操作（也可以不操作）。每次操作你可以选择一个区间 $[l,r]$，然后对于所有 $l\\leq i\\leq r$，令 $a_i\\gets\\bigl\\lfloor\\frac{m}{a_i}\\bigr\\rfloor$。\n\n求可以得到的 $\\sum_{j=1}^na_j$ 的最大值以及对应的最少操作次数。", "inputFormat": "**本题有多组测试数据。**\n\n第一行，一个正整数 $T$，表示测试数据组数。对于每组测试数据：\n\n* 第一行，两个正整数 $n,m$。\n* 第二行，$n$ 个正整数 $a_1, \\ldots, a_n$。", "outputFormat": "对于每组测试数据，一行，两个非负整数，分别表示 $\\sum_{j=1}^na_j$ 的最大值以及对应的最少操作次数。", "hint": "**【样例解释】**\n\n对于样例的第二组测试数据：选择以下 $3$ 组 $[l,r]$ 即可得到最大值 $28$：\n\n* $[1,2]$；\n* $[2,5]$；\n* $[4,5]$。\n\n可以证明该方案是最优的之一。\n\n**【数据范围】**\n\n**本题使用捆绑测试。**\n\n| 子任务编号 | 分值 | $n\\leq$ | $\\sum n\\leq$ | 特殊性质 |\n|:--:|:--:|:--:|:--:|:--:|\n| $1$ | $9$ | $4$ | $400$ | 无 |\n| $2$ | $27$ | $10^3$ | $10^4$ | 无 |\n| $3$ | $11$ | $10^5$ | $10^6$ | A |\n| $4$ | $16$ | $10^5$ | $10^6$ | B |\n| $5$ | $37$ | $10^5$ | $10^6$ | 无 |\n\n* 特殊性质 A：$a_i\\leq\\sqrt m$；\n* 特殊性质 B：$a_i\\mid m$。\n\n对于所有数据：$1\\leq T\\leq 10^5$，$1\\leq n\\leq 10^5$，$1\\leq\\sum n\\leq10^6$，$1\\leq a_i\\leq m\\leq10^{12}$。", "locale": "zh-CN"}}}
{"pid": "P13010", "type": "P", "difficulty": 5, "samples": [["4\n1 3 1\n1 1 3\n2 1 1\n1 5 2\n1 2 2 1 3\n3 2 1 2 2\n2 5 1\n2 3 1 3 3\n2 1 3 1 1\n3 6 2\n3 5 2 4 1 6\n2 3 4 5 6 1", "1.5000000000\n2.0000000000\n1.5000000000\n3.0000000000\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["贪心", "二分", "Special Judge", "O2优化", "梦熊比赛"], "title": "【MX-X13-T5】「KDOI-12」茫茫人海如都市的晚高峰，迎面的车终将相遇，迎面的车终将分别。", "background": "", "description": "一条大道共有从北到南和从南到北两个方向，记作方向 $1$ 和方向 $2$。  \n\n每个方向都各有一条基础车道，除此之外，大道还有 $n$ 条动态车道。\n\n一天共会经过 $m$ 个时刻，编号为 $1 \\sim m$，其中第 $i$ 个时刻 $j$ 方向会有 $c_{i, j}$ 辆车驶过。\n\n在每一个时刻 $i$，每一条动态车道 $j$ 都会有 $3$ 种情况，记为 $t_{i, j}$（$t_{i, j}\\in \\{0, 1, 2\\}$）。  \n其中若 $t_{i, j} = 0$ 则代表这条动态车道无法通行，否则其值就代表这条动态车道允许通过的方向。\n\n动态车道不能随意调转方向，有一个值 $C$ 代表调换动态车道的方向所需要的时间。  \n具体来说，如果在 $x$ 时刻与 $x + 1$ 时刻之间决定调换动态车道 $j$（$t_{x, j} \\ne 0$）的方向。  \n那么对于 $y \\in [x + 1, x + C]$，有 $t_{y, j} = 0$。从 $x + C + 1$ 时刻开始（到下一次调转方向为止），$t_{*, j}$ 才变为 $3 - t_{x, j}$。 \n\n特殊的是，对于 $1$ 时刻，可以直接为每个动态车道分配好其对应的方向。\n\n定义时刻 $i$ 时方向 $j$ 的负载量 $v_{i, j}$ 是该时刻通过这个方向的车辆数量与能够通过的车道数量（包括基础和动态车道）的比值，即 $v_{i, j} = \\frac{c_{i, j}}{1 + \\sum_{k = 1}^n [t_{i, k} = j]}$。  \n\n你需要求出在合理的调配下，最大负载量的最小值是多少。", "inputFormat": "**本题有多组测试数据。**\n\n第一行，一个正整数 $T$，表示测试数据组数。对于每组测试数据：\n\n* 第一行，三个正整数 $n, m, C$。\n* 第二行，$m$ 个正整数 $c_{1, 1}, \\ldots, c_{m, 1}$，表示在每个时刻通过方向 $1$ 的车辆数量。\n* 第三行，$m$ 个正整数 $c_{1, 2}, \\ldots, c_{m, 2}$，表示在每个时刻通过方向 $2$ 的车辆数量。", "outputFormat": "对于每组测试数据，一行，一个小数，表示最大负载量的最小值。\n\n**本题使用自定义校验器**，你的答案与正确答案的绝对误差或相对误差在 $10^{-6}$ 内即可算做正确。", "hint": "**【样例解释】**\n\n对于样例的第一组测试数据：令 $t_{1, 1} = 2, t_{2, 1} = 0, t_{3, 1} = 1$，这样有 $v_{1, 1} = v_{1, 2} = v_{2, 1} = v_{2, 2} = v_{3, 2} = 1, v_{3, 1} = 1.5$，最大负载量为 $1.5$。可以证明没有比 $1.5$ 更优的分配。\n\n**【数据范围】**\n\n**本题使用捆绑测试。**\n\n| 子任务编号 | 分值 | $n\\leq$ | $C\\leq$ | $\\sum m\\leq$ |\n|:--:|:--:|:--:|:--:|:--:|\n| $1$ | $15$ | $1$ | $m-1$ | $5\\times10^5$ |\n| $2$ | $20$ | $10^5$ | $1$ | $5\\times10^5$ |\n| $3$ | $15$ | $10^5$ | $m-1$ | $100$ |\n| $4$ | $20$ | $10^5$ | $m-1$ | $5\\times10^4$ |\n| $5$ | $30$ | $10^5$ | $m-1$ | $5\\times10^5$ |\n\n对于所有数据：$1\\leq T\\leq10^4$，$1\\le n\\le 10^5$，$1\\le c_{i, 1}, c_{i, 2}\\le 10^5$，$1\\le C < m\\leq5\\times10^5$，$\\sum m\\le 5\\times 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "【MX-X13-T5】\"In the Vast Sea of People Like the Evening Rush Hour in the City\"", "background": "", "description": "A main road has two directions: from north to south and from south to north, denoted as direction $1$ and direction $2$, respectively.  \n\nEach direction has one base lane. Additionally, the road has $n$ dynamic lanes.\n\nA day consists of $m$ moments, numbered from $1$ to $m$, where at the $i$-th moment, $c_{i, j}$ cars pass through direction $j$.\n\nAt each moment $i$, each dynamic lane $j$ can be in one of three states, denoted as $t_{i, j}$ ($t_{i, j} \\in \\{0, 1, 2\\}$).  \nIf $t_{i, j} = 0$, it means the dynamic lane is impassable. Otherwise, its value indicates the direction allowed for passage.  \n\nThe direction of dynamic lanes cannot be freely switched. A parameter $C$ represents the time required to switch the direction of a dynamic lane.  \nSpecifically, if the direction of dynamic lane $j$ is decided to switch between moment $x$ and $x + 1$ (where $t_{x, j} \\ne 0$),  \nthen for $y \\in [x + 1, x + C]$, $t_{y, j} = 0$. Starting from moment $x + C + 1$ (until the next switch), $t_{*, j}$ becomes $3 - t_{x, j}$.  \n\nAs a special case, for the first moment ($1$), the direction of each dynamic lane can be directly assigned.\n\nDefine the **load** $v_{i, j}$ of direction $j$ at moment $i$ as the ratio of the number of cars passing through this direction to the number of available lanes (including the base lane and dynamic lanes), i.e., $v_{i, j} = \\frac{c_{i, j}}{1 + \\sum_{k = 1}^n [t_{i, k} = j]}$.  \n\nYour task is to determine the minimum possible maximum load under a reasonable allocation scheme.", "inputFormat": "**There are multiple test cases in this problem.**\n\nThe first line contains a positive integer $T$, the number of test cases. For each test case:\n\n* The first line contains three positive integers $n, m, C$.  \n* The second line contains $m$ positive integers $c_{1, 1}, \\ldots, c_{m, 1}$, representing the number of cars passing through direction $1$ at each moment.  \n* The third line contains $m$ positive integers $c_{1, 2}, \\ldots, c_{m, 2}$, representing the number of cars passing through direction $2$ at each moment.  \n", "outputFormat": "For each test case, output a single line with a decimal number, representing the minimum possible maximum load.  \n\n**This problem uses a custom checker.** Your answer will be considered correct if its absolute or relative error compared to the correct answer is within $10^{-6}$.\n", "hint": "**【Sample Explanation】**\n\nFor the first test case in the sample: Let $t_{1, 1} = 2$, $t_{2, 1} = 0$, and $t_{3, 1} = 1$. Then, $v_{1, 1} = v_{1, 2} = v_{2, 1} = v_{2, 2} = v_{3, 2} = 1$, and $v_{3, 1} = 1.5$. The maximum load is $1.5$. It can be proven that no allocation yields a better result than $1.5$.\n\n**【Data Range】**\n\n**This problem uses bundled testing.**\n\n| Subtask ID | Points | $n\\leq$ | $C\\leq$ | $\\sum m\\leq$ |\n|:--:|:--:|:--:|:--:|:--:|\n| $1$ | $15$ | $1$ | $m-1$ | $5\\times10^5$ |\n| $2$ | $20$ | $10^5$ | $1$ | $5\\times10^5$ |\n| $3$ | $15$ | $10^5$ | $m-1$ | $100$ |\n| $4$ | $20$ | $10^5$ | $m-1$ | $5\\times10^4$ |\n| $5$ | $30$ | $10^5$ | $m-1$ | $5\\times10^5$ |\n\nFor all data:  \n$1 \\leq T \\leq 10^4$,  \n$1 \\le n \\le 10^5$,  \n$1 \\le c_{i, 1}, c_{i, 2} \\le 10^5$,  \n$1 \\le C < m \\leq 5 \\times 10^5$,  \n$\\sum m \\le 5 \\times 10^5$.\n\n---\n\nTranslated by DeepSeek V3.", "locale": "en"}, "zh-CN": {"title": "【MX-X13-T5】「KDOI-12」茫茫人海如都市的晚高峰，迎面的车终将相遇，迎面的车终将分别。", "background": "", "description": "一条大道共有从北到南和从南到北两个方向，记作方向 $1$ 和方向 $2$。  \n\n每个方向都各有一条基础车道，除此之外，大道还有 $n$ 条动态车道。\n\n一天共会经过 $m$ 个时刻，编号为 $1 \\sim m$，其中第 $i$ 个时刻 $j$ 方向会有 $c_{i, j}$ 辆车驶过。\n\n在每一个时刻 $i$，每一条动态车道 $j$ 都会有 $3$ 种情况，记为 $t_{i, j}$（$t_{i, j}\\in \\{0, 1, 2\\}$）。  \n其中若 $t_{i, j} = 0$ 则代表这条动态车道无法通行，否则其值就代表这条动态车道允许通过的方向。\n\n动态车道不能随意调转方向，有一个值 $C$ 代表调换动态车道的方向所需要的时间。  \n具体来说，如果在 $x$ 时刻与 $x + 1$ 时刻之间决定调换动态车道 $j$（$t_{x, j} \\ne 0$）的方向。  \n那么对于 $y \\in [x + 1, x + C]$，有 $t_{y, j} = 0$。从 $x + C + 1$ 时刻开始（到下一次调转方向为止），$t_{*, j}$ 才变为 $3 - t_{x, j}$。 \n\n特殊的是，对于 $1$ 时刻，可以直接为每个动态车道分配好其对应的方向。\n\n定义时刻 $i$ 时方向 $j$ 的负载量 $v_{i, j}$ 是该时刻通过这个方向的车辆数量与能够通过的车道数量（包括基础和动态车道）的比值，即 $v_{i, j} = \\frac{c_{i, j}}{1 + \\sum_{k = 1}^n [t_{i, k} = j]}$。  \n\n你需要求出在合理的调配下，最大负载量的最小值是多少。", "inputFormat": "**本题有多组测试数据。**\n\n第一行，一个正整数 $T$，表示测试数据组数。对于每组测试数据：\n\n* 第一行，三个正整数 $n, m, C$。\n* 第二行，$m$ 个正整数 $c_{1, 1}, \\ldots, c_{m, 1}$，表示在每个时刻通过方向 $1$ 的车辆数量。\n* 第三行，$m$ 个正整数 $c_{1, 2}, \\ldots, c_{m, 2}$，表示在每个时刻通过方向 $2$ 的车辆数量。", "outputFormat": "对于每组测试数据，一行，一个小数，表示最大负载量的最小值。\n\n**本题使用自定义校验器**，你的答案与正确答案的绝对误差或相对误差在 $10^{-6}$ 内即可算做正确。", "hint": "**【样例解释】**\n\n对于样例的第一组测试数据：令 $t_{1, 1} = 2, t_{2, 1} = 0, t_{3, 1} = 1$，这样有 $v_{1, 1} = v_{1, 2} = v_{2, 1} = v_{2, 2} = v_{3, 2} = 1, v_{3, 1} = 1.5$，最大负载量为 $1.5$。可以证明没有比 $1.5$ 更优的分配。\n\n**【数据范围】**\n\n**本题使用捆绑测试。**\n\n| 子任务编号 | 分值 | $n\\leq$ | $C\\leq$ | $\\sum m\\leq$ |\n|:--:|:--:|:--:|:--:|:--:|\n| $1$ | $15$ | $1$ | $m-1$ | $5\\times10^5$ |\n| $2$ | $20$ | $10^5$ | $1$ | $5\\times10^5$ |\n| $3$ | $15$ | $10^5$ | $m-1$ | $100$ |\n| $4$ | $20$ | $10^5$ | $m-1$ | $5\\times10^4$ |\n| $5$ | $30$ | $10^5$ | $m-1$ | $5\\times10^5$ |\n\n对于所有数据：$1\\leq T\\leq10^4$，$1\\le n\\le 10^5$，$1\\le c_{i, 1}, c_{i, 2}\\le 10^5$，$1\\le C < m\\leq5\\times10^5$，$\\sum m\\le 5\\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P13011", "type": "P", "difficulty": 6, "samples": [["10 1000000007\n4 1 4\n4 2 2\n4 3 2\n5 4 2\n7 3 5\n8 2 7\n10 3 8\n100 99 6\n1000 234 789\n5000 1234 4321", "6\n24\n8\n25\n882\n3840\n270000\n220955222\n251832899\n768412458\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "数学", "O2优化", "组合数学", "容斥原理", "梦熊比赛"], "title": "【MX-X13-T6】「KDOI-12」能做到的也只不过是静等缘分耗尽的那一天。", "background": "待到缘分耗尽，关系断裂，我们还会在一起吗？", "description": "对于一个排列 $p_{1\\sim n}$，建出其大根[笛卡尔树](https://www.luogu.com.cn/problem/P5854)，并断开每个点与其右儿子（如果存在）的连边，记最后所成的森林为 $T(p)$。\n\n例如 $p_{1\\sim 5} = [1, 3, 2, 5, 4]$，其大根笛卡尔树与 $T(p)$ 分别如下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6mikhar1.png)![](https://cdn.luogu.com.cn/upload/image_hosting/otv9hnhe.png)\n\n在给定 $n, x, y$ 的情况下，你需要回答，在 $n!$ 种 $1\\sim n$ 的排列 $p_{1\\sim n}$ 中，有多少种 $p$ 使得节点 $x$ 与节点 $y$ 在 $T(p)$ 中属于同一棵树。**节点指的是编号而非在 $p$ 中的权值。**\n\n由于答案可能很大，输出的答案需要对一个质数 $P$ 取模。", "inputFormat": "**本题有多组测试数据。**\n\n第一行，两个正整数 $T, P$，表示测试数据组数与模数。**保证 $\\bm P$ 为质数**。对于每组测试数据：\n\n* 仅一行，三个正整数 $n, x, y$。", "outputFormat": "对于每组测试数据，一行，一个非负整数，表示满足题目条件的排列数量，对 $P$ 取模。", "hint": "**【样例解释】**\n\n对于样例的第一组测试数据：有 $[1, 2, 3, 4], [1, 3, 2, 4], [2, 1, 3, 4], [2, 3, 1, 4], [3, 1, 2, 4], [3, 2, 1, 4]$ 共 $6$ 种排列满足条件。\n\n对于样例的第二组测试数据：任意 $1\\sim 4$ 的排列均满足条件。\n\n**【数据范围】**\n\n**本题使用捆绑测试。**\n\n| 子任务编号 | 分值 | $n\\leq$ | $T\\leq$ | 特殊性质 |\n|:--:|:--:|:--:|:--:|:--:|\n| $1$ | $5$ | $8$ | $10^6$ | 无 |\n| $2$ | $15$ | $2000$ | $2000$ | 无 |\n| $3$ | $15$ | $2000$ | $10^6$ | 无 |\n| $4$ | $25$ | $5\\times10^6$ | $20$ | 无 |\n| $5$ | $15$ | $10^5$ | $10^6$ | A |\n| $6$ | $25$ | $5\\times10^6$ | $10^6$ | 无 |\n\n* 特殊性质 A：$P=998244353$。\n\n对于所有数据：$1\\leq T\\leq10^6$，$1\\le x, y\\le n\\le 5\\times 10^6$，$10^8\\le P\\le 10^9 + 7$ 且 $P$ 为质数。\n\n**【提示】**\n\n请使用较快的读入方式。", "locale": "zh-CN", "translations": {"en": {"title": "【MX-X13-T6】\"All I Can Do Is Quietly Wait for the Day When Fate Runs Out\"", "background": "When fate runs out and relationships break, will we still be together?\n", "description": "For a permutation $p_{1\\sim n}$, construct its **max-heap Cartesian tree**, then disconnect the edge between each node and its right child (if it exists). Denote the resulting forest as $T(p)$.  \n\nFor example, consider $p_{1\\sim 5} = [1, 3, 2, 5, 4]$. The max-heap Cartesian tree and $T(p)$ are shown below:  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6mikhar1.png)![](https://cdn.luogu.com.cn/upload/image_hosting/otv9hnhe.png)  \n\nGiven $n, x, y$, you need to determine how many of the $n!$ permutations of $1\\sim n$ satisfy that nodes $x$ and $y$ belong to the same tree in $T(p)$. **Nodes are identified by their indices, not their values in $p$.**  \n\nSince the answer may be large, output it modulo a prime $P$.  ", "inputFormat": "**This problem contains multiple test cases.**  \n\nThe first line contains two positive integers $T$ and $P$, representing the number of test cases and the modulo. **It is guaranteed that $\\bm{P}$ is a prime.** For each test case:  \n- One line with three positive integers $n, x, y$. ", "outputFormat": "For each test case, output a non-negative integer indicating the number of valid permutations modulo $P$.  \n", "hint": "### Sample Explanation  \nFor the first test case, the following $6$ permutations satisfy the condition:  \n$[1, 2, 3, 4], [1, 3, 2, 4], [2, 1, 3, 4], [2, 3, 1, 4], [3, 1, 2, 4], [3, 2, 1, 4]$.  \n\nFor the second test case, all $1\\sim 4$ permutations are valid.  \n\n### Constraints  \n\n**This problem uses bundling tests.**  \n\n| Subtask | Points | $n\\leq$ | $T\\leq$ | Special Constraints |\n|:------:|:------:|:------:|:------:|:------------------:|\n| $1$    | $5$    | $8$    | $10^6$ | None               |\n| $2$    | $15$   | $2000$ | $2000$ | None               |\n| $3$    | $15$   | $2000$ | $10^6$ | None               |\n| $4$    | $25$   | $5\\times10^6$ | $20$ | None               |\n| $5$    | $15$   | $10^5$ | $10^6$ | A                  |\n| $6$    | $25$   | $5\\times10^6$ | $10^6$ | None               |\n\n- Special Constraint A: $P=998244353$.  \n\nFor all test cases:  \n- $1 \\leq T \\leq 10^6$,  \n- $1 \\le x, y \\le n \\le 5 \\times 10^6$,  \n- $10^8 \\le P \\le 10^9 + 7$ and $P$ is a prime.  \n\n### Hint  \nPlease use a fast input method.  \n\n---\n\n*Translation by DeepSeek V3.*  ", "locale": "en"}, "zh-CN": {"title": "【MX-X13-T6】「KDOI-12」能做到的也只不过是静等缘分耗尽的那一天。", "background": "待到缘分耗尽，关系断裂，我们还会在一起吗？", "description": "对于一个排列 $p_{1\\sim n}$，建出其大根[笛卡尔树](https://www.luogu.com.cn/problem/P5854)，并断开每个点与其右儿子（如果存在）的连边，记最后所成的森林为 $T(p)$。\n\n例如 $p_{1\\sim 5} = [1, 3, 2, 5, 4]$，其大根笛卡尔树与 $T(p)$ 分别如下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6mikhar1.png)![](https://cdn.luogu.com.cn/upload/image_hosting/otv9hnhe.png)\n\n在给定 $n, x, y$ 的情况下，你需要回答，在 $n!$ 种 $1\\sim n$ 的排列 $p_{1\\sim n}$ 中，有多少种 $p$ 使得节点 $x$ 与节点 $y$ 在 $T(p)$ 中属于同一棵树。**节点指的是编号而非在 $p$ 中的权值。**\n\n由于答案可能很大，输出的答案需要对一个质数 $P$ 取模。", "inputFormat": "**本题有多组测试数据。**\n\n第一行，两个正整数 $T, P$，表示测试数据组数与模数。**保证 $\\bm P$ 为质数**。对于每组测试数据：\n\n* 仅一行，三个正整数 $n, x, y$。", "outputFormat": "对于每组测试数据，一行，一个非负整数，表示满足题目条件的排列数量，对 $P$ 取模。", "hint": "**【样例解释】**\n\n对于样例的第一组测试数据：有 $[1, 2, 3, 4], [1, 3, 2, 4], [2, 1, 3, 4], [2, 3, 1, 4], [3, 1, 2, 4], [3, 2, 1, 4]$ 共 $6$ 种排列满足条件。\n\n对于样例的第二组测试数据：任意 $1\\sim 4$ 的排列均满足条件。\n\n**【数据范围】**\n\n**本题使用捆绑测试。**\n\n| 子任务编号 | 分值 | $n\\leq$ | $T\\leq$ | 特殊性质 |\n|:--:|:--:|:--:|:--:|:--:|\n| $1$ | $5$ | $8$ | $10^6$ | 无 |\n| $2$ | $15$ | $2000$ | $2000$ | 无 |\n| $3$ | $15$ | $2000$ | $10^6$ | 无 |\n| $4$ | $25$ | $5\\times10^6$ | $20$ | 无 |\n| $5$ | $15$ | $10^5$ | $10^6$ | A |\n| $6$ | $25$ | $5\\times10^6$ | $10^6$ | 无 |\n\n* 特殊性质 A：$P=998244353$。\n\n对于所有数据：$1\\leq T\\leq10^6$，$1\\le x, y\\le n\\le 5\\times 10^6$，$10^8\\le P\\le 10^9 + 7$ 且 $P$ 为质数。\n\n**【提示】**\n\n请使用较快的读入方式。", "locale": "zh-CN"}}}
{"pid": "P13012", "type": "P", "difficulty": 7, "samples": [["3 3\n0 1 2\n3 0 2\n3 1 0", "2"], ["6 5\n0 1 1 2 3 4\n3 3 0 6 6 1\n2 4 1 0 1 1\n3 0 2 6 6 2\n5 3 6 1 0 4", "18"]], "limits": {"time": [12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["O2优化", "深度优先搜索 DFS", "树论", "前缀和", "分块", "梦熊比赛"], "title": "【MX-X13-T7】「KDOI-12」No one can be anything without comparison.", "background": "", "description": "**请注意本题对 $\\bm{n,k}$ 的特殊限制。**\n\n$n$ 名选手参加了 $k$ 场 Tetris Tournament。每一场 Tetris Tournament 包含 $n-1$ 轮，每轮会选出两个目前还未淘汰的选手 $x,y$ 并让他们参加一场比赛，输的人淘汰。最后会有唯一胜者。你现在得知第 $j$ 个人在第 $i$ 场 Tetris Tournament 中被 $a_{i,j}$ 淘汰了。$j$ 是第 $i$ 场 Tetris Tournament 的胜者当且仅当 $a_{i,j}=0$。\n\n选手们喜欢比较。他们都希望自己在某种意义上能够胜过别人，或至少跟别人水平差不多。\n\n定义第 $i$ 场 Tetris Tournament 中 $x$ 严格吊打 $y$ 当且仅当存在 $x=p_1,p_2,\\dots,p_m=y$（$m\\ge 2$，也就是说 $x\\neq y$），使得对于任意 $1\\leq j<m$，$a_{i,p_{j+1}}=p_j$。\n\n定义一个有序的选手 $k$ 元组 $(i_1,i_2,\\dots,i_k)$ 是水平相似的当且仅当对于 $1\\leq j<k$，$i_j$ 在第 $j$ 场比赛中严格吊打 $i_{j+1}$ 且 $i_k$ 在第 $k$ 场比赛中严格吊打 $i_1$。\n\n求水平相似的 $k$ 元组数量，对 $998244353$ 取模。", "inputFormat": "第一行，两个正整数 $n,k$。**保证 $\\bm{3\\leq k\\leq 5}$**。\n\n接下来 $k$ 行，第 $i$ 行 $n$ 个非负整数 $a_{i,1}, \\ldots, a_{i,n}$。", "outputFormat": "仅一行，一个非负整数，表示水平相似的 $k$ 元组数量，对 $998244353$ 取模。", "hint": "**【样例解释 \\#1】**\n\n符合要求的三元组 $(i_1,i_2,i_3)$ 有：$(1,2,3)$，$(2,3,1)$。\n\n**【数据范围】**\n\n**本题使用捆绑测试。**\n\n| 子任务编号 | 分值 | $n\\leq$ | $k=$ | 特殊性质 |\n|:--:|:--:|:--:|:--:|:--:|\n| $1$ | $7$ | $100$ | $3$ | 无 |\n| $2$ | $8$ | $500$ | $3$ | 无 |\n| $3$ | $13$ | $3\\times10^3$ | $3$ | 无 |\n| $4$ | $14$ | $2.5\\times10^5$ | $3$ | A |\n| $5$ | $15$ | $10^5$ | $3$ | B |\n| $6$ | $7$ | $10^5$ | $3$ | 无 |\n| $7$ | $14$ | $2.5\\times10^5$ | $3$ | 无 |\n| $8$ | $7$ | $5\\times10^4$ | $4$ | 无 |\n| $9$ | $6$ | $7.5\\times10^4$ | $4$ | 无 |\n| $10$ | $9$ | $4\\times10^4$ | $5$ | 无 |\n\n* 特殊性质 A：对于 $1\\leq i\\leq n$，$a_{1,i}=a_{2,i}$；\n* 特殊性质 B：对于 $1\\leq i\\leq k$，不存在 $1\\leq j_1<j_2\\leq n$ 使得 $a_{i,j_1}=a_{i,j_2}$。\n\n对于所有数据：$1\\leq n\\leq2.5\\times10^5$，$\\bm{3\\leq k\\leq 5}$，保证 $a$ 数组符合题意，且：\n\n* $k=3$ 时，$n\\leq2.5\\times10^5$；\n* $k=4$ 时：$n\\leq7.5\\times10^4$；\n* $k=5$ 时：$n\\leq4\\times10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "【MX-X13-T7】\"KDOI-12\" No one can be anything without comparison.", "background": "", "description": "**Please note the special constraints on $\\bm{n,k}$ in this problem.**\n\n$n$ players participated in $k$ Tetris Tournaments. Each Tetris Tournament consists of $n-1$ rounds. In each round, two currently uneliminated players $x$ and $y$ are selected to compete, and the loser is eliminated. The last remaining player is the winner. You are given that the $j$-th player was eliminated by $a_{i,j}$ in the $i$-th Tetris Tournament. Here, $j$ is the winner of the $i$-th tournament if and only if $a_{i,j} = 0$.\n\nThe players enjoy comparison. They all hope to surpass others in some way or at least be on a similar level.\n\nDefine that in the $i$-th Tetris Tournament, $x$ **strictly dominates** $y$ if and only if there exists a sequence $x = p_1, p_2, \\dots, p_m = y$ (where $m \\ge 2$, i.e., $x \\neq y$) such that for all $1 \\leq j < m$, $a_{i,p_{j+1}} = p_j$.\n\nAn ordered $k$-tuple of players $(i_1, i_2, \\dots, i_k)$ is called **level-similar** if and only if for all $1 \\leq j < k$, $i_j$ strictly dominates $i_{j+1}$ in the $j$-th tournament, and $i_k$ strictly dominates $i_1$ in the $k$-th tournament.\n\nYour task is to compute the number of level-similar $k$-tuples, modulo $998244353$.", "inputFormat": "The first line contains two positive integers $n$ and $k$. **It is guaranteed that $\\bm{3 \\leq k \\leq 5}$.**\n\nThe next $k$ lines each contain $n$ non-negative integers $a_{i,1}, \\ldots, a_{i,n}$, representing the elimination data for the $i$-th tournament.\n", "outputFormat": "Output a single non-negative integer: the number of level-similar $k$-tuples, modulo $998244353$.\n", "hint": "### Sample Explanation #1  \nThe valid $3$-tuples $(i_1, i_2, i_3)$ are: $(1, 2, 3)$ and $(2, 3, 1)$.  \n\n### Constraints  \n\n**This problem uses bundling tests.**  \n\n| Subtask | Points | $n\\leq$ | $k=$ | Special Constraints |\n|:--:|:--:|:--:|:--:|:--:|\n| $1$ | $7$ | $100$ | $3$ | None |\n| $2$ | $8$ | $500$ | $3$ | None |\n| $3$ | $13$ | $3\\times10^3$ | $3$ | None |\n| $4$ | $14$ | $2.5\\times10^5$ | $3$ | A |\n| $5$ | $15$ | $10^5$ | $3$ | B |\n| $6$ | $7$ | $10^5$ | $3$ | None |\n| $7$ | $14$ | $2.5\\times10^5$ | $3$ | None |\n| $8$ | $7$ | $5\\times10^4$ | $4$ | None |\n| $9$ | $6$ | $7.5\\times10^4$ | $4$ | None |\n| $10$ | $9$ | $4\\times10^4$ | $5$ | None |\n\n- **Special Constraint A**: For $1 \\leq i \\leq n$, $a_{1,i} = a_{2,i}$.  \n- **Special Constraint B**: For $1 \\leq i \\leq k$, there do not exist $1 \\leq j_1 < j_2 \\leq n$ such that $a_{i,j_1} = a_{i,j_2}$.  \n\nFor all test cases:  \n- $1 \\leq n \\leq 2.5 \\times 10^5$,  \n- $\\bm{3 \\leq k \\leq 5}$,  \n- The $a$ array is consistent with the problem description, and:  \n  - If $k=3$, $n \\leq 2.5 \\times 10^5$.  \n  - If $k=4$, $n \\leq 7.5 \\times 10^4$.  \n  - If $k=5$, $n \\leq 4 \\times 10^4$.  \n\n---\n\n*Translation by DeepSeek V3.*  ", "locale": "en"}, "zh-CN": {"title": "【MX-X13-T7】「KDOI-12」No one can be anything without comparison.", "background": "", "description": "**请注意本题对 $\\bm{n,k}$ 的特殊限制。**\n\n$n$ 名选手参加了 $k$ 场 Tetris Tournament。每一场 Tetris Tournament 包含 $n-1$ 轮，每轮会选出两个目前还未淘汰的选手 $x,y$ 并让他们参加一场比赛，输的人淘汰。最后会有唯一胜者。你现在得知第 $j$ 个人在第 $i$ 场 Tetris Tournament 中被 $a_{i,j}$ 淘汰了。$j$ 是第 $i$ 场 Tetris Tournament 的胜者当且仅当 $a_{i,j}=0$。\n\n选手们喜欢比较。他们都希望自己在某种意义上能够胜过别人，或至少跟别人水平差不多。\n\n定义第 $i$ 场 Tetris Tournament 中 $x$ 严格吊打 $y$ 当且仅当存在 $x=p_1,p_2,\\dots,p_m=y$（$m\\ge 2$，也就是说 $x\\neq y$），使得对于任意 $1\\leq j<m$，$a_{i,p_{j+1}}=p_j$。\n\n定义一个有序的选手 $k$ 元组 $(i_1,i_2,\\dots,i_k)$ 是水平相似的当且仅当对于 $1\\leq j<k$，$i_j$ 在第 $j$ 场比赛中严格吊打 $i_{j+1}$ 且 $i_k$ 在第 $k$ 场比赛中严格吊打 $i_1$。\n\n求水平相似的 $k$ 元组数量，对 $998244353$ 取模。", "inputFormat": "第一行，两个正整数 $n,k$。**保证 $\\bm{3\\leq k\\leq 5}$**。\n\n接下来 $k$ 行，第 $i$ 行 $n$ 个非负整数 $a_{i,1}, \\ldots, a_{i,n}$。", "outputFormat": "仅一行，一个非负整数，表示水平相似的 $k$ 元组数量，对 $998244353$ 取模。", "hint": "**【样例解释 \\#1】**\n\n符合要求的三元组 $(i_1,i_2,i_3)$ 有：$(1,2,3)$，$(2,3,1)$。\n\n**【数据范围】**\n\n**本题使用捆绑测试。**\n\n| 子任务编号 | 分值 | $n\\leq$ | $k=$ | 特殊性质 |\n|:--:|:--:|:--:|:--:|:--:|\n| $1$ | $7$ | $100$ | $3$ | 无 |\n| $2$ | $8$ | $500$ | $3$ | 无 |\n| $3$ | $13$ | $3\\times10^3$ | $3$ | 无 |\n| $4$ | $14$ | $2.5\\times10^5$ | $3$ | A |\n| $5$ | $15$ | $10^5$ | $3$ | B |\n| $6$ | $7$ | $10^5$ | $3$ | 无 |\n| $7$ | $14$ | $2.5\\times10^5$ | $3$ | 无 |\n| $8$ | $7$ | $5\\times10^4$ | $4$ | 无 |\n| $9$ | $6$ | $7.5\\times10^4$ | $4$ | 无 |\n| $10$ | $9$ | $4\\times10^4$ | $5$ | 无 |\n\n* 特殊性质 A：对于 $1\\leq i\\leq n$，$a_{1,i}=a_{2,i}$；\n* 特殊性质 B：对于 $1\\leq i\\leq k$，不存在 $1\\leq j_1<j_2\\leq n$ 使得 $a_{i,j_1}=a_{i,j_2}$。\n\n对于所有数据：$1\\leq n\\leq2.5\\times10^5$，$\\bm{3\\leq k\\leq 5}$，保证 $a$ 数组符合题意，且：\n\n* $k=3$ 时，$n\\leq2.5\\times10^5$；\n* $k=4$ 时：$n\\leq7.5\\times10^4$；\n* $k=5$ 时：$n\\leq4\\times10^4$。", "locale": "zh-CN"}}}
{"pid": "P13013", "type": "P", "difficulty": 3, "samples": [["8 8\n2 1", "5"], ["314159 2653589\n27 1828", "1599"]], "limits": {"time": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["二分", "2025", "GESP", "整数规划"], "title": "[GESP202506 五级] 奖品兑换", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1185>\n\n为了保证只有时间复杂度正确的代码能够通过本题，时限下降为 400 毫秒。", "description": "班主任给上课专心听讲、认真完成作业的同学们分别发放了若干张课堂优秀券和作业优秀券。同学们可以使用这两种券找班主任兑换奖品。具体来说，可以使用 $a$ 张课堂优秀券和 $b$ 张作业优秀券兑换一份奖品，或者使用 $b$ 张课堂优秀券和 $a$ 张作业优秀券兑换一份奖品。\n\n现在小 A 有 $n$ 张课堂优秀券和 $m$ 张作业优秀券，他最多能兑换多少份奖品呢？", "inputFormat": "第一行，两个正整数 $n,m$，分别表示小 A 持有的课堂优秀券和作业优秀券的数量。\n\n第二行，两个正整数 $a,b$，表示兑换一份奖品所需的两种券的数量。", "outputFormat": "输出共一行，一个整数，表示最多能兑换的奖品份数。\n", "hint": "对于 $60\\%$ 的测试点，保证 $1 \\le a,b \\le 100$，$1 \\le n,m \\le 500$。\n\n对于所有测试点，保证 $1 \\le a,b \\le 10^4$，$1 \\le n,m \\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[GESP202506 五级] 奖品兑换", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1185>\n\n为了保证只有时间复杂度正确的代码能够通过本题，时限下降为 400 毫秒。", "description": "班主任给上课专心听讲、认真完成作业的同学们分别发放了若干张课堂优秀券和作业优秀券。同学们可以使用这两种券找班主任兑换奖品。具体来说，可以使用 $a$ 张课堂优秀券和 $b$ 张作业优秀券兑换一份奖品，或者使用 $b$ 张课堂优秀券和 $a$ 张作业优秀券兑换一份奖品。\n\n现在小 A 有 $n$ 张课堂优秀券和 $m$ 张作业优秀券，他最多能兑换多少份奖品呢？", "inputFormat": "第一行，两个正整数 $n,m$，分别表示小 A 持有的课堂优秀券和作业优秀券的数量。\n\n第二行，两个正整数 $a,b$，表示兑换一份奖品所需的两种券的数量。", "outputFormat": "输出共一行，一个整数，表示最多能兑换的奖品份数。\n", "hint": "对于 $60\\%$ 的测试点，保证 $1 \\le a,b \\le 100$，$1 \\le n,m \\le 500$。\n\n对于所有测试点，保证 $1 \\le a,b \\le 10^4$，$1 \\le n,m \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P13014", "type": "P", "difficulty": 2, "samples": [["5 3\n6 9 12 18 30", "1\n1\n3"], ["3 5\n31 47 59", "4\n1\n2\n1\n4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "2025", "GESP"], "title": "[GESP202506 五级] 最大公因数", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1185>", "description": "对于两个正整数 $a,b$，他们的最大公因数记为 $\\gcd(a,b)$。对于 $k > 3$ 个正整数 $c_1,c_2,\\dots,c_k$，他们的最大公因数为：\n\n$$\\gcd(c_1,c_2,\\dots,c_k)=\\gcd(\\gcd(c_1,c_2,\\dots,c_{k-1}),c_k)$$\n\n给定 $n$ 个正整数 $a_1,a_2,\\dots,a_n$ 以及 $q$ 组询问。对于第 $i(1 \\le i \\le q)$ 组询问，请求出 $a_1+i,a_2+i,\\dots,a_n+i$ 的最大公因数，也即 $\\gcd(a_1+i,a_2+i,\\dots,a_n+i)$。", "inputFormat": "第一行，两个正整数 $n,q$，分别表示给定正整数的数量，以及询问组数。\n\n第二行，$n$ 个正整数 $a_1,a_2,\\dots,a_n$。", "outputFormat": "输出共 $q$ 行，第 $i$ 行包含一个正整数，表示 $a_1+i,a_2+i,\\dots,a_n+i$ 的最大公因数。", "hint": "对于 $60\\%$ 的测试点，保证 $1 \\le n \\le 10^3$，$1 \\le q \\le 10$。\n\n对于所有测试点，保证 $1 \\le n \\le 10^5$，$1 \\le q \\le 10^5$，$1 \\le a_i \\le 1000$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[GESP202506 五级] 最大公因数", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1185>", "description": "对于两个正整数 $a,b$，他们的最大公因数记为 $\\gcd(a,b)$。对于 $k > 3$ 个正整数 $c_1,c_2,\\dots,c_k$，他们的最大公因数为：\n\n$$\\gcd(c_1,c_2,\\dots,c_k)=\\gcd(\\gcd(c_1,c_2,\\dots,c_{k-1}),c_k)$$\n\n给定 $n$ 个正整数 $a_1,a_2,\\dots,a_n$ 以及 $q$ 组询问。对于第 $i(1 \\le i \\le q)$ 组询问，请求出 $a_1+i,a_2+i,\\dots,a_n+i$ 的最大公因数，也即 $\\gcd(a_1+i,a_2+i,\\dots,a_n+i)$。", "inputFormat": "第一行，两个正整数 $n,q$，分别表示给定正整数的数量，以及询问组数。\n\n第二行，$n$ 个正整数 $a_1,a_2,\\dots,a_n$。", "outputFormat": "输出共 $q$ 行，第 $i$ 行包含一个正整数，表示 $a_1+i,a_2+i,\\dots,a_n+i$ 的最大公因数。", "hint": "对于 $60\\%$ 的测试点，保证 $1 \\le n \\le 10^3$，$1 \\le q \\le 10$。\n\n对于所有测试点，保证 $1 \\le n \\le 10^5$，$1 \\le q \\le 10^5$，$1 \\le a_i \\le 1000$。", "locale": "zh-CN"}}}
