{"pid": "P5166", "type": "P", "difficulty": 4, "samples": [["4 4\n1 3\n1 3\n1 4\n0\n1 2 3\n1 1 1\n2 2 3 1\n1 1 1", "1\n1\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["线段树"], "title": "xtq的口令", "background": "三年级时，xtq 就展现出高超的身体素质，以至于体育老师允许他不用参加同学们的体育锻炼，而是可以自由活动。\n\nxtq 现在正在观察同学们跑步。", "description": "$n$ 个同学在排队跑步。\n\n体育老师发了一条指令，要求这 $n$ 名同学加快跑步速度。然而，由于风太大，只有部分同学听到并执行了老师的指令。同时，没有听到指令的同学如果观察到其他的同学执行了老师的指令，他们也会执行老师的指令。\n\n现在我们一般化这个情况。我们将位于队首的同学编号为 $1$，将接下来的同学以此类推，最后位于队尾的同学编号为 $n$。\n\n经过观察，xtq 给出了每位同学的若干位观察对象，这意味着当这位同学看到他的任何一个观察对象加快跑步速度（执行指令）时，他也会加快跑步速度（执行指令）。保证对于任何一位同学，他的所有观察对象的编号都小于自己（一个同学只会观察排在自己前面同学中的一部分）。\n\n现在有 $q$ 条询问或修改，\n\n询问：格式为 ```1 L R```。\n\n回答如果编号在 $\\left[L,R \\right]$ 范围内的同学听到了指令，至少还需要多少个同学听到指令才能使所有人执行指令。\n\n修改：格式为 ```2 L R x```。\n\n给在 $\\left[L,R \\right]$ 的同学添加第 $x$ 位同学作为自己的观察对象。保证 $x < L$。如果区间内有人原来的观察对象有第 $x$ 位同学，忽略即可。", "inputFormat": "第一行两个整数 $n,q$。\n\n接下来 $n$ 行，每行第一个整数 $a_i$，代表第 $i$ 位同学被共计 $a_i$ 位同学观察。接下来 $a_i$ 个整数，代表观察第 $i$ 位同学的编号。若 $a_i=0$，代表没有同学观察这位同学。由于一个同学只会被自己后面的同学观察，所以输入的编号一定大于这位同学自己的编号。\n\n#### 注意输入的编号是观察第 $i$ 位同学的同学编号，而不是被第 $i$ 位同学观察的同学编号。\n\n接下来 $q$ 行，每行一个询问或修改，格式见题目描述。", "outputFormat": "对于每个询问操作，输出至少还需要几位同学知道指令，才能使最终每位同学都接执行了老师的指令。", "hint": "【样例解释】\n\n样例中，$1$ 号同学被 $3$ 号同学观察，$2$ 号同学被 $3$ 号同学观察，$3$ 号同学被 $4$ 号同学观察。\n\n对于第一个询问 ```1 2 3```：这意味着 $2,3$ 号两位同学听到了老师的指令。因为 $3$ 号同学被 $4$ 号同学观察，所以当 $3$ 号同学加快跑步速度后，$4$ 号同学也会加快跑步速度。所以需要告诉 $1$ 号同学指令是什么，才能使所有同学收到指令。\n\n【数据范围】\n|编号|n|特殊性质|\n| ------ | ------ | ------ |\n|1|$10$|有|\n|2|$10$|无|\n|3|$500$|有|\n|4|$5000$|无|\n|5|$5000$|无|\n|6|$50000$|有|\n|7|$50000$|无|\n|8|$3 \\times 10^5$|有|\n|9|$3 \\times 10^5$|无|\n|10|$3 \\times 10^5$|无|\n\n特殊性质：修改操作不超过 $100$ 次。\n\n对于 $100\\%$ 的数据，$n,q\\le 3 \\times 10^5$，$\\sum a_i\\le 10^7$。\n\n由于本题输入输出量大，请不要使用 cin/cout。", "locale": "zh-CN", "translations": {"en": {"title": "xtq's Password", "background": "In third grade, xtq already showed excellent physical fitness, so the PE teacher allowed him to skip the class exercises and move freely.\n\nxtq is now observing his classmates running.", "description": "There are $n$ students lined up for running.\n\nThe PE teacher gave an order, asking these $n$ students to speed up. However, because the wind was too strong, only some students heard and carried out the order. At the same time, if a student who did not hear the order observes other students carrying out the order, he will also carry out the order.\n\nNow we generalize this situation. We number the student at the front of the line as $1$, the next as $2$, and so on, with the student at the end numbered $n$.\n\nAfter observation, xtq provides for each student several observed targets. This means that when this student sees any one of his observed targets speed up (carry out the order), he will also speed up (carry out the order). It is guaranteed that for any student, all of his observed targets have indices smaller than his own (a student only observes some of the students in front of him).\n\nNow there are $q$ queries or modifications:\n\nQuery: in the form of ```1 L R```.\n\nAnswer: if the students with indices in $\\left[L,R \\right]$ have heard the order, at least how many more students need to hear the order to make everyone carry out the order.\n\nModification: in the form of ```2 L R x```.\n\nFor each student in $\\left[L,R \\right]$, add student $x$ as one of his observed targets. It is guaranteed that $x < L$. If someone in the interval already has student $x$ as an observed target, ignore it.", "inputFormat": "The first line contains two integers $n,q$.\n\nIn the next $n$ lines, the first integer of each line is $a_i$, meaning student $i$ is observed by a total of $a_i$ students. Then follow $a_i$ integers, which are the indices of the students who observe student $i$. If $a_i=0$, it means no one observes this student. Since a student can only be observed by students behind him, the input indices are guaranteed to be greater than this student's own index.\n\n#### Note that the input indices are the indices of students who observe student $i$, not the indices of students observed by student $i$.\n\nThen follow $q$ lines, each being a query or a modification, in the formats described above.", "outputFormat": "For each query operation, output the minimum number of additional students who need to know the order so that eventually every student carries out the teacher's order.", "hint": "【Sample Explanation】\n\nIn the sample, student $1$ is observed by student $3$, student $2$ is observed by student $3$, and student $3$ is observed by student $4$.\n\nFor the first query ```1 2 3```: this means students $2$ and $3$ heard the teacher's order. Since student $3$ is observed by student $4$, after student $3$ speeds up, student $4$ will also speed up. Therefore, we need to tell student $1$ what the order is, so that all students receive the order.\n\n【Constraints】\n|ID|n|Special Property|\n| ------ | ------ | ------ |\n|1|$10$|Yes|\n|2|$10$|No|\n|3|$500$|Yes|\n|4|$5000$|No|\n|5|$5000$|No|\n|6|$50000$|Yes|\n|7|$50000$|No|\n|8|$3 \\times 10^5$|Yes|\n|9|$3 \\times 10^5$|No|\n|10|$3 \\times 10^5$|No|\n\nSpecial Property: the number of modification operations does not exceed $100$.\n\nFor $100\\%$ of the testdata, $n,q\\le 3 \\times 10^5$, $\\sum a_i\\le 10^7$.\n\nBecause the input and output size of this problem is large, please do not use cin/cout.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "xtq的口令", "background": "三年级时，xtq 就展现出高超的身体素质，以至于体育老师允许他不用参加同学们的体育锻炼，而是可以自由活动。\n\nxtq 现在正在观察同学们跑步。", "description": "$n$ 个同学在排队跑步。\n\n体育老师发了一条指令，要求这 $n$ 名同学加快跑步速度。然而，由于风太大，只有部分同学听到并执行了老师的指令。同时，没有听到指令的同学如果观察到其他的同学执行了老师的指令，他们也会执行老师的指令。\n\n现在我们一般化这个情况。我们将位于队首的同学编号为 $1$，将接下来的同学以此类推，最后位于队尾的同学编号为 $n$。\n\n经过观察，xtq 给出了每位同学的若干位观察对象，这意味着当这位同学看到他的任何一个观察对象加快跑步速度（执行指令）时，他也会加快跑步速度（执行指令）。保证对于任何一位同学，他的所有观察对象的编号都小于自己（一个同学只会观察排在自己前面同学中的一部分）。\n\n现在有 $q$ 条询问或修改，\n\n询问：格式为 ```1 L R```。\n\n回答如果编号在 $\\left[L,R \\right]$ 范围内的同学听到了指令，至少还需要多少个同学听到指令才能使所有人执行指令。\n\n修改：格式为 ```2 L R x```。\n\n给在 $\\left[L,R \\right]$ 的同学添加第 $x$ 位同学作为自己的观察对象。保证 $x < L$。如果区间内有人原来的观察对象有第 $x$ 位同学，忽略即可。", "inputFormat": "第一行两个整数 $n,q$。\n\n接下来 $n$ 行，每行第一个整数 $a_i$，代表第 $i$ 位同学被共计 $a_i$ 位同学观察。接下来 $a_i$ 个整数，代表观察第 $i$ 位同学的编号。若 $a_i=0$，代表没有同学观察这位同学。由于一个同学只会被自己后面的同学观察，所以输入的编号一定大于这位同学自己的编号。\n\n#### 注意输入的编号是观察第 $i$ 位同学的同学编号，而不是被第 $i$ 位同学观察的同学编号。\n\n接下来 $q$ 行，每行一个询问或修改，格式见题目描述。", "outputFormat": "对于每个询问操作，输出至少还需要几位同学知道指令，才能使最终每位同学都接执行了老师的指令。", "hint": "【样例解释】\n\n样例中，$1$ 号同学被 $3$ 号同学观察，$2$ 号同学被 $3$ 号同学观察，$3$ 号同学被 $4$ 号同学观察。\n\n对于第一个询问 ```1 2 3```：这意味着 $2,3$ 号两位同学听到了老师的指令。因为 $3$ 号同学被 $4$ 号同学观察，所以当 $3$ 号同学加快跑步速度后，$4$ 号同学也会加快跑步速度。所以需要告诉 $1$ 号同学指令是什么，才能使所有同学收到指令。\n\n【数据范围】\n|编号|n|特殊性质|\n| ------ | ------ | ------ |\n|1|$10$|有|\n|2|$10$|无|\n|3|$500$|有|\n|4|$5000$|无|\n|5|$5000$|无|\n|6|$50000$|有|\n|7|$50000$|无|\n|8|$3 \\times 10^5$|有|\n|9|$3 \\times 10^5$|无|\n|10|$3 \\times 10^5$|无|\n\n特殊性质：修改操作不超过 $100$ 次。\n\n对于 $100\\%$ 的数据，$n,q\\le 3 \\times 10^5$，$\\sum a_i\\le 10^7$。\n\n由于本题输入输出量大，请不要使用 cin/cout。", "locale": "zh-CN"}}}
{"pid": "P5167", "type": "P", "difficulty": 6, "samples": [["1\n6 2\n3 1 4 5 6 2\n6 -2\n", "31\n"]], "limits": {"time": [3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["O2优化"], "title": "xtq 的神笔", "background": "xtq 在小学四年级的时候得到了一套神奇的画笔。为了测试神笔的威力（以及展现自己过人的艺术天赋），他决定先为美术老师临摹几幅画。", "description": "每幅画的形态可以抽象为排成一列的 $n$ 个格子，其中第 $i$ 个格子具有一个权值 $a_i$。\n\nxtq 有足够多不同颜色的画笔，每当他使用一根笔，他可以在格子上画下至少长度为 $k$ 的连续一段，然后再换另一根笔从下一个格子继续画，其中 $k<n$。\n\n美术老师为了考验 xtq 的绘画功力，为他设置了一些挑战。\n\n他可以从 $1$ 到 $k$ 的任意一个格子开始画到编号为 $n$ 的格子，其中从第 $i$ 个格子开始会获得 $b_i$ 的得分。\n\n假设 xtq 使用同一根画笔，从编号为 $i$ 的格子连续地画到编号为 $j$ 的格子，他就会获得（$a_i \\mathbin{\\mathrm{or}} a_{i+1} \\mathbin{\\mathrm{or}} a_{i+2} \\mathbin{\\mathrm{or}} \\cdots \\mathbin{\\mathrm{or}} a_j) + (a_i \\mathbin{\\mathrm{and}} a_{i+1} \\mathbin{\\mathrm{and}} a_{i+2} \\mathbin{\\mathrm{and}} \\cdots \\mathbin{\\mathrm{and}} a_j) + \\gcd(a_i, a_{i+1}, a_{i+2}, \\ldots, a_j)$ 的分数，其中 $\\gcd$ 代表最大公约数。\n\n现在，xtq 希望找到一种安排画笔使用的方案，使得对于每一幅需要临摹的画，他总共获得的分数尽量多。", "inputFormat": "第一行，一个正整数 $T$，表示画的数量。\n\n对于每一幅画：\n\n第一行，两个正整数 $n, k$。\n\n第二行，$n$ 个正整数 $a_1, a_2, a_3, \\ldots , a_n$。\n\n第三行，$k$ 个整数 $b_1, b_2, b_3, \\ldots , b_k$。", "outputFormat": "对于每一幅画，输出一个整数，代表 xtq 完成这幅画最多能获得的分数。", "hint": "样例解释：\n\nxtq 可以从 $1$ 开始，获得 $6$ 分初始得分；第一段画 $[1,2]$，获得 $5$ 分；第二段画 $[3,4]$，获得 $10$ 分；第三段画 $[5,6]$，获得 $10$ 分。共 $31$ 分。\n\n对于 $20\\%$ 的数据，$n\\le 10$。  \n对于 $40\\%$ 的数据，$n\\le 3000$。  \n对于 $70\\%$ 的数据，$n\\le 30000$。  \n对于 $100\\%$ 的数据，$1\\le k<n\\le 3 \\times {10}^5$，$T\\le 10$，$1\\le a_i\\le 2^{30}$，$-2^{30}\\le b_i\\le 2^{30}$。\n\n数据有梯度，应该不太卡常。", "locale": "zh-CN", "translations": {"en": {"title": "xtq’s Magic Brush", "background": "When xtq was in fourth grade, he got a set of magical paintbrushes. To test how powerful the brushes were (and to show off his strong artistic talent), he decided to copy several paintings for his art teacher.", "description": "The shape of each painting can be abstracted as $n$ cells in a row, where the $i$-th cell has a weight $a_i$.\n\nxtq has enough paintbrushes of different colors. Each time he uses one brush, he can paint a continuous segment on the cells with length at least $k$, and then switch to another brush and continue painting starting from the next cell, where $k<n$.\n\nTo test xtq’s painting skills, the art teacher sets some challenges.\n\nHe may start painting from any cell between $1$ and $k$ (inclusive) and paint all the way to cell $n$. If he starts from cell $i$, he gains an initial score of $b_i$.\n\nSuppose xtq uses the same brush to paint continuously from cell $i$ to cell $j$. Then he gains a score of $(a_i \\mathbin{\\mathrm{or}} a_{i+1} \\mathbin{\\mathrm{or}} a_{i+2} \\mathbin{\\mathrm{or}} \\cdots \\mathbin{\\mathrm{or}} a_j) + (a_i \\mathbin{\\mathrm{and}} a_{i+1} \\mathbin{\\mathrm{and}} a_{i+2} \\mathbin{\\mathrm{and}} \\cdots \\mathbin{\\mathrm{and}} a_j) + \\gcd(a_i, a_{i+1}, a_{i+2}, \\ldots, a_j)$, where $\\gcd$ denotes the greatest common divisor.\n\nNow, xtq wants to find a plan for using the brushes so that for each painting he needs to copy, his total score is as large as possible.", "inputFormat": "The first line contains a positive integer $T$, representing the number of paintings.\n\nFor each painting:\n\nThe first line contains two positive integers $n, k$.\n\nThe second line contains $n$ positive integers $a_1, a_2, a_3, \\ldots , a_n$.\n\nThe third line contains $k$ integers $b_1, b_2, b_3, \\ldots , b_k$.", "outputFormat": "For each painting, output one integer, representing the maximum score xtq can obtain after completing this painting.", "hint": "Sample explanation:\n\nxtq can start from $1$ and gain an initial score of $6$ points. The first segment is $[1,2]$, gaining $5$ points; the second segment is $[3,4]$, gaining $10$ points; the third segment is $[5,6]$, gaining $10$ points. In total, $31$ points.\n\nConstraints:\n\nFor $20\\%$ of the testdata, $n\\le 10$.  \nFor $40\\%$ of the testdata, $n\\le 3000$.  \nFor $70\\%$ of the testdata, $n\\le 30000$.  \nFor $100\\%$ of the testdata, $1\\le k<n\\le 3 \\times {10}^5$, $T\\le 10$, $1\\le a_i\\le 2^{30}$, $-2^{30}\\le b_i\\le 2^{30}$.\n\nThe testdata has multiple levels, so it should not be too strict on constant factors.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "xtq 的神笔", "background": "xtq 在小学四年级的时候得到了一套神奇的画笔。为了测试神笔的威力（以及展现自己过人的艺术天赋），他决定先为美术老师临摹几幅画。", "description": "每幅画的形态可以抽象为排成一列的 $n$ 个格子，其中第 $i$ 个格子具有一个权值 $a_i$。\n\nxtq 有足够多不同颜色的画笔，每当他使用一根笔，他可以在格子上画下至少长度为 $k$ 的连续一段，然后再换另一根笔从下一个格子继续画，其中 $k<n$。\n\n美术老师为了考验 xtq 的绘画功力，为他设置了一些挑战。\n\n他可以从 $1$ 到 $k$ 的任意一个格子开始画到编号为 $n$ 的格子，其中从第 $i$ 个格子开始会获得 $b_i$ 的得分。\n\n假设 xtq 使用同一根画笔，从编号为 $i$ 的格子连续地画到编号为 $j$ 的格子，他就会获得（$a_i \\mathbin{\\mathrm{or}} a_{i+1} \\mathbin{\\mathrm{or}} a_{i+2} \\mathbin{\\mathrm{or}} \\cdots \\mathbin{\\mathrm{or}} a_j) + (a_i \\mathbin{\\mathrm{and}} a_{i+1} \\mathbin{\\mathrm{and}} a_{i+2} \\mathbin{\\mathrm{and}} \\cdots \\mathbin{\\mathrm{and}} a_j) + \\gcd(a_i, a_{i+1}, a_{i+2}, \\ldots, a_j)$ 的分数，其中 $\\gcd$ 代表最大公约数。\n\n现在，xtq 希望找到一种安排画笔使用的方案，使得对于每一幅需要临摹的画，他总共获得的分数尽量多。", "inputFormat": "第一行，一个正整数 $T$，表示画的数量。\n\n对于每一幅画：\n\n第一行，两个正整数 $n, k$。\n\n第二行，$n$ 个正整数 $a_1, a_2, a_3, \\ldots , a_n$。\n\n第三行，$k$ 个整数 $b_1, b_2, b_3, \\ldots , b_k$。", "outputFormat": "对于每一幅画，输出一个整数，代表 xtq 完成这幅画最多能获得的分数。", "hint": "样例解释：\n\nxtq 可以从 $1$ 开始，获得 $6$ 分初始得分；第一段画 $[1,2]$，获得 $5$ 分；第二段画 $[3,4]$，获得 $10$ 分；第三段画 $[5,6]$，获得 $10$ 分。共 $31$ 分。\n\n对于 $20\\%$ 的数据，$n\\le 10$。  \n对于 $40\\%$ 的数据，$n\\le 3000$。  \n对于 $70\\%$ 的数据，$n\\le 30000$。  \n对于 $100\\%$ 的数据，$1\\le k<n\\le 3 \\times {10}^5$，$T\\le 10$，$1\\le a_i\\le 2^{30}$，$-2^{30}\\le b_i\\le 2^{30}$。\n\n数据有梯度，应该不太卡常。", "locale": "zh-CN"}}}
{"pid": "P5168", "type": "P", "difficulty": 7, "samples": [["4 4 4\n4 6 4 2\n1 2 8\n3 2 3\n2 4 2\n4 1 7\n3 4 3\n1 4 4\n3 1 7\n2 4 3", "3\n2\n3\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["O2优化"], "title": "xtq玩魔塔", "background": "**已添加样例解释**\n\n在小学五年级的时候，$xtq$迷上了各种奇奇怪怪的魔塔。\n关于魔塔游戏的背景：https://baike.baidu.com/item/%E9%AD%94%E5%A1%94/861619?fr=aladdin\n\n对于题意理解可能并没有任何微小的作用", "description": "xtq 现在正在玩一个魔塔。这个魔塔十分特殊，不是由正方形格子构成的，而是一个 $n$ 个点，$m$ 条边的无向图，而且每条边上都会有一个怪物。xtq 经过了重重阻拦，现在到达了一个奖励层。\n\n在这层内，所有怪物都不会让 xtq 掉血，但是对于每一个怪物如果 xtq 不到一定血量他就无法攻击这个怪物。每一个点上还有一个宝石，宝石的种类有很多，但是如果 xtq 到了一个点但是他已经拥有了这种宝石，他是不能捡起的。他现在想要知道从这个魔塔的一个点到另一个点所需要的最小血量是多少，还要知道如果他从一个点到达这个魔塔，以某个血量能够捡到的宝石数量是多少。还有一件事令 xtq 十分头疼：这个魔塔由于一些神秘的力量，可能宝石的种类会发生变化。保证如果 xtq 的血量无穷大，他就可以走到这一层的任何地方。", "inputFormat": "第一行三个数 $n,m,q$ 代表点数，边数和操作数量\n\n第二行 $n$ 个数，代表每个点上宝石的种类\n\n下面 $m$ 行每行三个数 $u,v,t$，代表 $u$ 和 $v$ 之间有一条路，路上有一个需要 $t$ 点血量才能击杀的怪物\n\n然后 $q$ 行每行三个数 $opt,x,y$\n\n$opt=1$ 时将 $x$ 点的宝石改成第 $y$ 种\n\n$opt=2$ 代表查询从 $x$ 点要到达 $y$ 点所需的最小血量\n\n$opt=3$ 代表查询从 $x$ 点到达魔塔，血量为 $y$ 能捡到多少宝石", "outputFormat": "对于每一个 $2$ 操作和 $3$ 操作，输出一行答案", "hint": "样例解释：\n\n![](https://cdn.luogu.com.cn/upload/pic/47598.png)\n\n第一次操作为3号操作，从4开始，有3点血量，可以到达 $\\{2,3,4\\}$，可以获得的宝石种类为 $\\{2,4,6\\}$\n\n第二次将 $1$ 的宝石种类修改为 $4$，即下图：\n\n![](https://cdn.luogu.com.cn/upload/pic/47599.png)\n\n第三次为 $3$ 操作，从 $1$ 开始，可以到达的点为 $\\{1,2,3,4\\}$，可以获得的宝石种类为 $\\{4,6\\}$。\n\n第四次为 $2$ 操作，从 $4$ 走到 $3$，至少需要 $3$ 点血量。\n\n\n\n 测试点 | $n$ | $m$ | $q$ | 有无修改操作 \n------ | ------ | ---|--- | ------ \n $1$ | $10$ | $20$ | $10$ | 有 \n $2 \\sim 3$ | $1000$ | $5000$ | $5000$ | ^ \n $4 \\sim 5$ | $8000$ | $30000$ | $20000$ | ^ \n $6$ | $20000$ | $100000$ | $100000$ | 无 \n $7$ | ^ | ^ | ^ | 有 \n $8$ | $50000$ | $200000$ | $200000$ | 无 \n $9$ | ^ | ^ | ^ | 有 \n $10$ | $100000$ | $300000$ | ^ | ^ \n\n\n对于 $100\\%$ 的数据，$n \\le 100000,m \\le 300000,q \\le 200000$\n\n剩余所有数字 $\\le \\text{intmax}$\n\n**保证查询的区间是随机生成的（其实是出题人懒得再写 generator 了）**", "locale": "zh-CN", "translations": {"en": {"title": "xtq Plays Magic Tower", "background": "**Sample explanation has been added.**\n\nWhen $xtq$ was in fifth grade of primary school, he became obsessed with all kinds of strange Magic Tower games.  \nBackground of the Magic Tower game: https://baike.baidu.com/item/%E9%AD%94%E5%A1%94/861619?fr=aladdin\n\nThis may not be of any help for understanding the problem.", "description": "xtq is now playing a Magic Tower. This Magic Tower is very special: it is not made of square grids, but an undirected graph with $n$ vertices and $m$ edges, and there is a monster on every edge. After many obstacles, xtq has now reached a reward floor.\n\nOn this floor, no monster will make xtq lose HP. However, for each monster, if xtq does not have at least a certain amount of HP, he cannot attack that monster. Each vertex also has a gem. There are many types of gems, but if xtq arrives at a vertex and he already has that type of gem, then he cannot pick it up. He now wants to know the minimum HP required to go from one vertex of the Magic Tower to another. He also wants to know, if he starts from some vertex with a certain amount of HP, how many gems he can pick up. One more thing troubles xtq a lot: due to some mysterious power, the gem types may change. It is guaranteed that if xtq has infinite HP, he can reach anywhere on this floor.", "inputFormat": "The first line contains three integers $n, m, q$, representing the number of vertices, the number of edges, and the number of operations.\n\nThe second line contains $n$ integers, representing the gem type on each vertex.\n\nThe next $m$ lines each contain three integers $u, v, t$, meaning there is a road between $u$ and $v$, and there is a monster on the road that requires $t$ HP to defeat.\n\nThen follow $q$ lines, each containing three integers $opt, x, y$.\n\nWhen $opt = 1$, change the gem at vertex $x$ to type $y$.\n\nWhen $opt = 2$, query the minimum HP required to go from vertex $x$ to vertex $y$.\n\nWhen $opt = 3$, query how many gems can be picked up if starting from vertex $x$ with HP $y$.", "outputFormat": "For each operation of type $2$ and type $3$, output one line containing the answer.", "hint": "Sample explanation:\n\n![](https://cdn.luogu.com.cn/upload/pic/47598.png)\n\nThe first operation is type $3$. Starting from $4$ with $3$ HP, you can reach $\\{2,3,4\\}$, and the gem types you can obtain are $\\{2,4,6\\}$.\n\nThe second operation changes the gem type of $1$ to $4$, as shown below:\n\n![](https://cdn.luogu.com.cn/upload/pic/47599.png)\n\nThe third operation is type $3$. Starting from $1$, the reachable vertices are $\\{1,2,3,4\\}$, and the gem types you can obtain are $\\{4,6\\}$.\n\nThe fourth operation is type $2$. To walk from $4$ to $3$, you need at least $3$ HP.\n\nConstraints:\n\nTest Point | $n$ | $m$ | $q$ | Has modification operations\n------ | ------ | --- | --- | ------\n$1$ | $10$ | $20$ | $10$ | Yes\n$2 \\sim 3$ | $1000$ | $5000$ | $5000$ | ^\n$4 \\sim 5$ | $8000$ | $30000$ | $20000$ | ^\n$6$ | $20000$ | $100000$ | $100000$ | No\n$7$ | ^ | ^ | ^ | Yes\n$8$ | $50000$ | $200000$ | $200000$ | No\n$9$ | ^ | ^ | ^ | Yes\n$10$ | $100000$ | $300000$ | ^ | ^\n\nFor $100\\%$ of the data, $n \\le 100000$, $m \\le 300000$, $q \\le 200000$.\n\nAll remaining numbers are $\\le \\text{intmax}$.\n\n**It is guaranteed that the query ranges are randomly generated (actually, the problem setter was too lazy to write a generator again).**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "xtq玩魔塔", "background": "**已添加样例解释**\n\n在小学五年级的时候，$xtq$迷上了各种奇奇怪怪的魔塔。\n关于魔塔游戏的背景：https://baike.baidu.com/item/%E9%AD%94%E5%A1%94/861619?fr=aladdin\n\n对于题意理解可能并没有任何微小的作用", "description": "xtq 现在正在玩一个魔塔。这个魔塔十分特殊，不是由正方形格子构成的，而是一个 $n$ 个点，$m$ 条边的无向图，而且每条边上都会有一个怪物。xtq 经过了重重阻拦，现在到达了一个奖励层。\n\n在这层内，所有怪物都不会让 xtq 掉血，但是对于每一个怪物如果 xtq 不到一定血量他就无法攻击这个怪物。每一个点上还有一个宝石，宝石的种类有很多，但是如果 xtq 到了一个点但是他已经拥有了这种宝石，他是不能捡起的。他现在想要知道从这个魔塔的一个点到另一个点所需要的最小血量是多少，还要知道如果他从一个点到达这个魔塔，以某个血量能够捡到的宝石数量是多少。还有一件事令 xtq 十分头疼：这个魔塔由于一些神秘的力量，可能宝石的种类会发生变化。保证如果 xtq 的血量无穷大，他就可以走到这一层的任何地方。", "inputFormat": "第一行三个数 $n,m,q$ 代表点数，边数和操作数量\n\n第二行 $n$ 个数，代表每个点上宝石的种类\n\n下面 $m$ 行每行三个数 $u,v,t$，代表 $u$ 和 $v$ 之间有一条路，路上有一个需要 $t$ 点血量才能击杀的怪物\n\n然后 $q$ 行每行三个数 $opt,x,y$\n\n$opt=1$ 时将 $x$ 点的宝石改成第 $y$ 种\n\n$opt=2$ 代表查询从 $x$ 点要到达 $y$ 点所需的最小血量\n\n$opt=3$ 代表查询从 $x$ 点到达魔塔，血量为 $y$ 能捡到多少宝石", "outputFormat": "对于每一个 $2$ 操作和 $3$ 操作，输出一行答案", "hint": "样例解释：\n\n![](https://cdn.luogu.com.cn/upload/pic/47598.png)\n\n第一次操作为3号操作，从4开始，有3点血量，可以到达 $\\{2,3,4\\}$，可以获得的宝石种类为 $\\{2,4,6\\}$\n\n第二次将 $1$ 的宝石种类修改为 $4$，即下图：\n\n![](https://cdn.luogu.com.cn/upload/pic/47599.png)\n\n第三次为 $3$ 操作，从 $1$ 开始，可以到达的点为 $\\{1,2,3,4\\}$，可以获得的宝石种类为 $\\{4,6\\}$。\n\n第四次为 $2$ 操作，从 $4$ 走到 $3$，至少需要 $3$ 点血量。\n\n\n\n 测试点 | $n$ | $m$ | $q$ | 有无修改操作 \n------ | ------ | ---|--- | ------ \n $1$ | $10$ | $20$ | $10$ | 有 \n $2 \\sim 3$ | $1000$ | $5000$ | $5000$ | ^ \n $4 \\sim 5$ | $8000$ | $30000$ | $20000$ | ^ \n $6$ | $20000$ | $100000$ | $100000$ | 无 \n $7$ | ^ | ^ | ^ | 有 \n $8$ | $50000$ | $200000$ | $200000$ | 无 \n $9$ | ^ | ^ | ^ | 有 \n $10$ | $100000$ | $300000$ | ^ | ^ \n\n\n对于 $100\\%$ 的数据，$n \\le 100000,m \\le 300000,q \\le 200000$\n\n剩余所有数字 $\\le \\text{intmax}$\n\n**保证查询的区间是随机生成的（其实是出题人懒得再写 generator 了）**", "locale": "zh-CN"}}}
{"pid": "P5169", "type": "P", "difficulty": 6, "samples": [["3 3 3\n1 2 0\n2 3 1\n3 1 2\n0\n1\n2", "5\n4\n4"], ["4 3 2\n1 2 1\n2 3 6\n2 4 7\n6\n7", "4\n4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": [], "title": "xtq 的异或和", "background": "xtq在六年级的时候开始大量研究离散数学。这一天，他正在对着一张密密麻麻的图思索。", "description": "xtq 有一张 $n$ 个点，$m$ 条边的无向连通图。第 $i$ 条边连接 $s_i,t_i$，权值为 $w_i$。不保证无重边或自环。\n\nxtq 认为，如果存在一条从 $u$ 出发，到 $v$ 结束的路径，使得所有**被这条路径恰经过奇数次的边**的权值的异或和为 $x$，那么点对 $(u,v)$ 关于 $x$ 是巧妙的。\n\n现在，xtq 问了你 $q$ 个问题，每次询问有多少个不同的点对 $(u,v)$ 关于 $x$ 是巧妙的。注意 $u$ 可以等于 $v$，且如果 $u \\neq v$ 那么 $(u,v)$ 与 $(v,u)$ 是不同的。", "inputFormat": "第一行，三个正整数 $n,m,q$\n\n接下来 $m$ 行，每行三个整数 $s_i,t_i,w_i$\n\n接下来 $q$ 行，每行一个整数 $x$，表示一次询问。", "outputFormat": "$q$ 行，每行回答一次询问，输出对 $998244353$ 取模后的结果。", "hint": "### 样例解释1\n\n关于 $0$ 巧妙的点对：\n\n$(1,1): 1 \\Rightarrow 2 \\Rightarrow 1$，$(2,2),(3,3)$ 类似；$(1,2): 1 \\Rightarrow 2$，$(2,1)$ 类似\n\n关于 $1$ 巧妙的点对：\n\n$(2,3):2 \\Rightarrow 3$，$(3,2)$ 类似；$(1,3):1 \\Rightarrow 2 \\Rightarrow 3$，$(3,1)$ 类似\n\n关于 $2$ 巧妙的点对：与 $1$ 类似\n\n### 数据范围\n\n|  测试点编号|$n$  |$m$  |      $\\, w_i,x,q-1$  |       特殊限制  |\n| ----------- | ----------- | ----------- | --------------- | ----------- |\n|$1$  |$\\le 5$  |$\\le 10$  |$< 4$  | 无  |\n|$2$  |$\\le 10$  |$\\le 50$  |$< 8$  | ^  |\n|$3$  |$\\le 100$  |$= n-1$  |$< 128$  | 是一棵树  |\n|$4$  |^  |$\\le 500$  |^ | 无  |\n|$5$  |$\\le 1000$  |$= n-1$  |$< 1024$  | 是一棵树  |\n|$6$  |^  |$\\le 5000$  |^ | 无  |\n|$7$  |$\\le 1 \\times 10^5 $  |$\\le 3\\times 10^5$  |^ | ^  |\n|$8$  |^|^  |^| ^  |\n|$9$  |^|$= n-1$  |$< 262144$  | 是一棵树  |\n|$10$  |^|^ |^| ^ |\n|$11$  |^|^ |^ | ^ |\n|$12$  |^|^|^ | ^ |\n|$13$  |^|$\\le n+11$  |^| 无  |\n|$14$  |^|^ |^ | ^  |\n|$15$ |^|$\\le 3\\times 10^5$  |^ | ^ |\n|$16$ |^|^ |^ | ^ |\n|$17$  |^|^ |^| ^ |\n|$18$ |^|^|^| ^ |\n|$19$  |^|^|^| ^ |\n|$20$  |^|^ |^ | ^  |\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^5,n-1\\le m\\le 3*10^5,0\\le w_i,x< 262144,0\\le q\\le 262144$", "locale": "zh-CN", "translations": {"en": {"title": "xtq’s XOR Sum", "background": "xtq started studying discrete mathematics a lot when he was in sixth grade. One day, he was thinking while looking at a very dense graph.", "description": "xtq has an undirected connected graph with $n$ vertices and $m$ edges. The $i$-th edge connects $s_i$ and $t_i$ and has weight $w_i$. Multiple edges and self-loops are not guaranteed to be absent.\n\nxtq thinks that if there exists a path starting from $u$ and ending at $v$ such that the XOR sum of the weights of all **edges that are traversed an odd number of times by this path** equals $x$, then the ordered pair $(u,v)$ is “clever” with respect to $x$.\n\nNow, xtq asks you $q$ queries. For each query, ask how many distinct ordered pairs $(u,v)$ are clever with respect to $x$. Note that $u$ may equal $v$, and if $u \\neq v$, then $(u,v)$ and $(v,u)$ are considered different.", "inputFormat": "The first line contains three positive integers $n,m,q$.\n\nThe next $m$ lines each contain three integers $s_i,t_i,w_i$.\n\nThe next $q$ lines each contain one integer $x$, representing a query.", "outputFormat": "Output $q$ lines. Each line answers one query, and you should print the result modulo $998244353$.", "hint": "### Sample Explanation 1\n\nOrdered pairs that are clever with respect to $0$:\n\n$(1,1): 1 \\Rightarrow 2 \\Rightarrow 1$, and $(2,2),(3,3)$ are similar; $(1,2): 1 \\Rightarrow 2$, and $(2,1)$ is similar.\n\nOrdered pairs that are clever with respect to $1$:\n\n$(2,3):2 \\Rightarrow 3$, and $(3,2)$ is similar; $(1,3):1 \\Rightarrow 2 \\Rightarrow 3$, and $(3,1)$ is similar.\n\nOrdered pairs that are clever with respect to $2$: similar to $1$.\n\n### Constraints\n\n|  Test Point ID |$n$  |$m$  |      $\\, w_i,x,q-1$  |       Special Restriction  |\n| ----------- | ----------- | ----------- | --------------- | ----------- |\n|$1$  |$\\le 5$  |$\\le 10$  |$< 4$  | None  |\n|$2$  |$\\le 10$  |$\\le 50$  |$< 8$  | ^  |\n|$3$  |$\\le 100$  |$= n-1$  |$< 128$  | A tree  |\n|$4$  |^  |$\\le 500$  |^ | None  |\n|$5$  |$\\le 1000$  |$= n-1$  |$< 1024$  | A tree  |\n|$6$  |^  |$\\le 5000$  |^ | None  |\n|$7$  |$\\le 1 \\times 10^5 $  |$\\le 3\\times 10^5$  |^ | ^  |\n|$8$  |^|^  |^| ^  |\n|$9$  |^|$= n-1$  |$< 262144$  | A tree  |\n|$10$  |^|^ |^| ^ |\n|$11$  |^|^ |^ | ^ |\n|$12$  |^|^|^ | ^ |\n|$13$  |^|$\\le n+11$  |^| None  |\n|$14$  |^|^ |^ | ^  |\n|$15$ |^|$\\le 3\\times 10^5$  |^ | ^ |\n|$16$ |^|^ |^ | ^ |\n|$17$  |^|^ |^| ^ |\n|$18$ |^|^|^| ^ |\n|$19$  |^|^|^| ^ |\n|$20$  |^|^ |^ | ^  |\n\nFor $100\\%$ of the testdata, $1\\le n\\le 10^5,n-1\\le m\\le 3*10^5,0\\le w_i,x< 262144,0\\le q\\le 262144$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "xtq 的异或和", "background": "xtq在六年级的时候开始大量研究离散数学。这一天，他正在对着一张密密麻麻的图思索。", "description": "xtq 有一张 $n$ 个点，$m$ 条边的无向连通图。第 $i$ 条边连接 $s_i,t_i$，权值为 $w_i$。不保证无重边或自环。\n\nxtq 认为，如果存在一条从 $u$ 出发，到 $v$ 结束的路径，使得所有**被这条路径恰经过奇数次的边**的权值的异或和为 $x$，那么点对 $(u,v)$ 关于 $x$ 是巧妙的。\n\n现在，xtq 问了你 $q$ 个问题，每次询问有多少个不同的点对 $(u,v)$ 关于 $x$ 是巧妙的。注意 $u$ 可以等于 $v$，且如果 $u \\neq v$ 那么 $(u,v)$ 与 $(v,u)$ 是不同的。", "inputFormat": "第一行，三个正整数 $n,m,q$\n\n接下来 $m$ 行，每行三个整数 $s_i,t_i,w_i$\n\n接下来 $q$ 行，每行一个整数 $x$，表示一次询问。", "outputFormat": "$q$ 行，每行回答一次询问，输出对 $998244353$ 取模后的结果。", "hint": "### 样例解释1\n\n关于 $0$ 巧妙的点对：\n\n$(1,1): 1 \\Rightarrow 2 \\Rightarrow 1$，$(2,2),(3,3)$ 类似；$(1,2): 1 \\Rightarrow 2$，$(2,1)$ 类似\n\n关于 $1$ 巧妙的点对：\n\n$(2,3):2 \\Rightarrow 3$，$(3,2)$ 类似；$(1,3):1 \\Rightarrow 2 \\Rightarrow 3$，$(3,1)$ 类似\n\n关于 $2$ 巧妙的点对：与 $1$ 类似\n\n### 数据范围\n\n|  测试点编号|$n$  |$m$  |      $\\, w_i,x,q-1$  |       特殊限制  |\n| ----------- | ----------- | ----------- | --------------- | ----------- |\n|$1$  |$\\le 5$  |$\\le 10$  |$< 4$  | 无  |\n|$2$  |$\\le 10$  |$\\le 50$  |$< 8$  | ^  |\n|$3$  |$\\le 100$  |$= n-1$  |$< 128$  | 是一棵树  |\n|$4$  |^  |$\\le 500$  |^ | 无  |\n|$5$  |$\\le 1000$  |$= n-1$  |$< 1024$  | 是一棵树  |\n|$6$  |^  |$\\le 5000$  |^ | 无  |\n|$7$  |$\\le 1 \\times 10^5 $  |$\\le 3\\times 10^5$  |^ | ^  |\n|$8$  |^|^  |^| ^  |\n|$9$  |^|$= n-1$  |$< 262144$  | 是一棵树  |\n|$10$  |^|^ |^| ^ |\n|$11$  |^|^ |^ | ^ |\n|$12$  |^|^|^ | ^ |\n|$13$  |^|$\\le n+11$  |^| 无  |\n|$14$  |^|^ |^ | ^  |\n|$15$ |^|$\\le 3\\times 10^5$  |^ | ^ |\n|$16$ |^|^ |^ | ^ |\n|$17$  |^|^ |^| ^ |\n|$18$ |^|^|^| ^ |\n|$19$  |^|^|^| ^ |\n|$20$  |^|^ |^ | ^  |\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^5,n-1\\le m\\le 3*10^5,0\\le w_i,x< 262144,0\\le q\\le 262144$", "locale": "zh-CN"}}}
{"pid": "P5170", "type": "P", "difficulty": 6, "samples": [["2\n2 1 0 2\n4 3 9 6", "1 1 2\n11 27 27"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["Special Judge", "类欧几里得算法", "模板题"], "title": "【模板】类欧几里德算法", "background": null, "description": "给定 $n,\\,a,\\,b,\\,c$ ，分别求 $\\sum\\limits_{i=0}^{n}\\left\\lfloor \\frac{ai+b}{c} \\right\\rfloor\\,,\\  \\sum\\limits_{i=0}^{n}{\\left\\lfloor \\frac{ai+b}{c} \\right\\rfloor}^2\\,,\\  \\sum\\limits_{i=0}^{n}i\\left\\lfloor \\frac{ai+b}{c} \\right\\rfloor$ ，答案对 $998244353$ 取模。多组数据。", "inputFormat": "第一行给出数据组数 $t$ 。\n\n接下来 $t$ 行，每行有四个整数，分别为每组数据的 $n,\\ a,\\ b,\\ c$ 。", "outputFormat": "对于每组数据，输出一行三个整数，为三个答案对 $998244353$ 取模的结果。", "hint": "本题采用 $\\mathrm{Special}\\ \\mathrm{Judge}$。\n\n答对所有第一问可以获得测试点 $40\\%$ 的分数，答对所有第二问、第三问可以分别获得另外 $30\\%$ 的分数。\n\n|测试点编号|特殊性质|\n|:-:|:-:|\n|$1$|$n,\\,a,\\,b,\\,c\\leqslant10$|\n|$2 \\sim 3$|$n,\\,a,\\,b,\\,c\\leqslant1000$|\n|$4$|$n,\\,a,\\,b,\\,c\\leqslant10^6$|\n|$5$|$t=1$|\n|$6 \\sim 10$|无|\n\n对于所有测试点，有 $1 \\leqslant t \\leqslant 10^5,\\ 0 \\leqslant n,\\,a,\\,b,\\,c \\leqslant 10^9,\\ c \\neq 0$ 。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Euclidean-like Algorithm", "background": "", "description": "Given $n,\\,a,\\,b,\\,c$, compute respectively $\\sum\\limits_{i=0}^{n}\\left\\lfloor \\frac{ai+b}{c} \\right\\rfloor$, $\\sum\\limits_{i=0}^{n}{\\left\\lfloor \\frac{ai+b}{c} \\right\\rfloor}^2$, and $\\sum\\limits_{i=0}^{n} i \\left\\lfloor \\frac{ai+b}{c} \\right\\rfloor$. Output each answer modulo $998244353$. There are multiple test cases.", "inputFormat": "The first line contains the number of test cases $t$.\n\nThe next $t$ lines each contain four integers, which are $n,\\ a,\\ b,\\ c$ for that test case.", "outputFormat": "For each test case, output one line with three integers, which are the three answers modulo $998244353$.", "hint": "This problem uses $\\mathrm{Special}\\ \\mathrm{Judge}$.\n\nIf you answer all cases for the first query correctly, you can get $40\\%$ of the total score. If you answer all cases for the second and third queries correctly, you can get an additional $30\\%$ for each.\n\n|Test Point ID|Special Property|\n|:-:|:-:|\n|$1$|$n,\\,a,\\,b,\\,c\\leqslant10$|\n|$2 \\sim 3$|$n,\\,a,\\,b,\\,c\\leqslant1000$|\n|$4$|$n,\\,a,\\,b,\\,c\\leqslant10^6$|\n|$5$|$t=1$|\n|$6 \\sim 10$|None|\n\nFor all test points, $1 \\leqslant t \\leqslant 10^5,\\ 0 \\leqslant n,\\,a,\\,b,\\,c \\leqslant 10^9,\\ c \\neq 0$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】类欧几里德算法", "background": null, "description": "给定 $n,\\,a,\\,b,\\,c$ ，分别求 $\\sum\\limits_{i=0}^{n}\\left\\lfloor \\frac{ai+b}{c} \\right\\rfloor\\,,\\  \\sum\\limits_{i=0}^{n}{\\left\\lfloor \\frac{ai+b}{c} \\right\\rfloor}^2\\,,\\  \\sum\\limits_{i=0}^{n}i\\left\\lfloor \\frac{ai+b}{c} \\right\\rfloor$ ，答案对 $998244353$ 取模。多组数据。", "inputFormat": "第一行给出数据组数 $t$ 。\n\n接下来 $t$ 行，每行有四个整数，分别为每组数据的 $n,\\ a,\\ b,\\ c$ 。", "outputFormat": "对于每组数据，输出一行三个整数，为三个答案对 $998244353$ 取模的结果。", "hint": "本题采用 $\\mathrm{Special}\\ \\mathrm{Judge}$。\n\n答对所有第一问可以获得测试点 $40\\%$ 的分数，答对所有第二问、第三问可以分别获得另外 $30\\%$ 的分数。\n\n|测试点编号|特殊性质|\n|:-:|:-:|\n|$1$|$n,\\,a,\\,b,\\,c\\leqslant10$|\n|$2 \\sim 3$|$n,\\,a,\\,b,\\,c\\leqslant1000$|\n|$4$|$n,\\,a,\\,b,\\,c\\leqslant10^6$|\n|$5$|$t=1$|\n|$6 \\sim 10$|无|\n\n对于所有测试点，有 $1 \\leqslant t \\leqslant 10^5,\\ 0 \\leqslant n,\\,a,\\,b,\\,c \\leqslant 10^9,\\ c \\neq 0$ 。", "locale": "zh-CN"}}}
{"pid": "P5171", "type": "P", "difficulty": 6, "samples": [["3 4 13", "12"]], "limits": {"time": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "Earthquake", "background": "", "description": "给定 $a,\\,b,\\,c$ ，求满足方程 $ax+by \\leqslant c$ 的非负整数解个数。", "inputFormat": "输入三个整数 $a,\\,b,\\,c$ 。", "outputFormat": "输出一个整数表示答案。", "hint": "**样例解释：**\n\n若以 $(x,\\,y)$ 表示一组合法解，样例的 $12$ 组合法解如下：\n\n$(0,\\,0)$，$(0,\\,1)$，$(0,\\,2)$，$(0,\\,3)$，$(1,\\,0)$，$(1,\\,1)$，$(1,\\,2)$，$(2,\\,0)$，$(2,\\,1)$，$(3,\\,0)$，$(3,\\,1)$，$(4,\\,0)$ 。\n\n**数据规模：**\n\n||||\n|:-:|:-:|:-:|\n|测试点编号|$a,\\,b$|$c$|\n|$1 \\sim 5$|$\\leqslant 10$|$\\leqslant 10$|\n|$6 \\sim 10$|$\\leqslant 10^5$|$\\leqslant 10^9$|\n|$11 \\sim 25$|$\\leqslant 10^9$|$\\leqslant 10^{18}$|\n\n对于所有数据，$1 \\leqslant a,\\,b \\leqslant 10^9,\\ 0 \\leqslant c \\leqslant \\min(a,\\,b) \\times 10^9$ 。", "locale": "zh-CN", "translations": {"en": {"title": "Earthquake", "background": "", "description": "Given $a,\\,b,\\,c$, find the number of non-negative integer solutions that satisfy the inequality $ax+by \\leqslant c$.", "inputFormat": "Input three integers $a,\\,b,\\,c$.", "outputFormat": "Output one integer representing the answer.", "hint": "**Sample Explanation:**\n\nLet $(x,\\,y)$ represent a valid solution. The sample has the following $12$ valid solutions:\n\n$(0,\\,0)$, $(0,\\,1)$, $(0,\\,2)$, $(0,\\,3)$, $(1,\\,0)$, $(1,\\,1)$, $(1,\\,2)$, $(2,\\,0)$, $(2,\\,1)$, $(3,\\,0)$, $(3,\\,1)$, $(4,\\,0)$.\n\n**Constraints:**\n\n||||\n|:-:|:-:|:-:|\n|Test point ID|$a,\\,b$|$c$|\n|$1 \\sim 5$|$\\leqslant 10$|$\\leqslant 10$|\n|$6 \\sim 10$|$\\leqslant 10^5$|$\\leqslant 10^9$|\n|$11 \\sim 25$|$\\leqslant 10^9$|$\\leqslant 10^{18}$|\n\nFor all testdata, $1 \\leqslant a,\\,b \\leqslant 10^9,\\ 0 \\leqslant c \\leqslant \\min(a,\\,b) \\times 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Earthquake", "background": "", "description": "给定 $a,\\,b,\\,c$ ，求满足方程 $ax+by \\leqslant c$ 的非负整数解个数。", "inputFormat": "输入三个整数 $a,\\,b,\\,c$ 。", "outputFormat": "输出一个整数表示答案。", "hint": "**样例解释：**\n\n若以 $(x,\\,y)$ 表示一组合法解，样例的 $12$ 组合法解如下：\n\n$(0,\\,0)$，$(0,\\,1)$，$(0,\\,2)$，$(0,\\,3)$，$(1,\\,0)$，$(1,\\,1)$，$(1,\\,2)$，$(2,\\,0)$，$(2,\\,1)$，$(3,\\,0)$，$(3,\\,1)$，$(4,\\,0)$ 。\n\n**数据规模：**\n\n||||\n|:-:|:-:|:-:|\n|测试点编号|$a,\\,b$|$c$|\n|$1 \\sim 5$|$\\leqslant 10$|$\\leqslant 10$|\n|$6 \\sim 10$|$\\leqslant 10^5$|$\\leqslant 10^9$|\n|$11 \\sim 25$|$\\leqslant 10^9$|$\\leqslant 10^{18}$|\n\n对于所有数据，$1 \\leqslant a,\\,b \\leqslant 10^9,\\ 0 \\leqslant c \\leqslant \\min(a,\\,b) \\times 10^9$ 。", "locale": "zh-CN"}}}
{"pid": "P5172", "type": "P", "difficulty": 7, "samples": [["3\n3 5\n3 6\n3 7", "3\n1\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2014", "CTT（清华集训/北大集训）", "类欧几里得算法"], "title": "[清华集训 2014] Sum", "background": "", "description": "给定正整数 $n,\\,r$ ，求：\n\n$$\\sum_{d=1}^{n}(-1)^{\\lfloor d\\sqrt{r} \\rfloor}$$", "inputFormat": "第一行一个数 $t$，表示有 $t$ 组测试数据。\n\n接下来 $t$ 行，每行两个正整数 $n,\\,r$ 。", "outputFormat": "输出 $t$ 行，每行一个整数表示答案。", "hint": "|测试点编号|$t$|$n$|$r$| \n|:-:|:-:|:-:|:-:|    \n|$1 \\sim 3$|$\\leqslant 10$|$\\leqslant 10^5$|$\\leqslant 100$|   \n|$4 \\sim 6$|$\\leqslant 100$|$\\leqslant 10^7$|$\\leqslant 1000$|  \n|$7 \\sim 10$|$\\leqslant 10^4$|$\\leqslant 10^9$|$\\leqslant 10^4$|", "locale": "zh-CN", "translations": {"en": {"title": "[Tsinghua Training 2014] Sum", "background": "", "description": "Given positive integers $n$ and $r$, compute:\n\n$$\\sum_{d=1}^{n}(-1)^{\\lfloor d\\sqrt{r} \\rfloor}$$", "inputFormat": "The first line contains an integer $t$, indicating that there are $t$ testdata cases.\n\nThe next $t$ lines each contain two positive integers $n$ and $r$.", "outputFormat": "Output $t$ lines, each containing one integer representing the answer.", "hint": "## Constraints\n\n|Test Point ID|$t$|$n$|$r$|\n|:-:|:-:|:-:|:-:|\n|$1 \\sim 3$|$\\leqslant 10$|$\\leqslant 10^5$|$\\leqslant 100$|\n|$4 \\sim 6$|$\\leqslant 100$|$\\leqslant 10^7$|$\\leqslant 1000$|\n|$7 \\sim 10$|$\\leqslant 10^4$|$\\leqslant 10^9$|$\\leqslant 10^4$|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[清华集训 2014] Sum", "background": "", "description": "给定正整数 $n,\\,r$ ，求：\n\n$$\\sum_{d=1}^{n}(-1)^{\\lfloor d\\sqrt{r} \\rfloor}$$", "inputFormat": "第一行一个数 $t$，表示有 $t$ 组测试数据。\n\n接下来 $t$ 行，每行两个正整数 $n,\\,r$ 。", "outputFormat": "输出 $t$ 行，每行一个整数表示答案。", "hint": "|测试点编号|$t$|$n$|$r$| \n|:-:|:-:|:-:|:-:|    \n|$1 \\sim 3$|$\\leqslant 10$|$\\leqslant 10^5$|$\\leqslant 100$|   \n|$4 \\sim 6$|$\\leqslant 100$|$\\leqslant 10^7$|$\\leqslant 1000$|  \n|$7 \\sim 10$|$\\leqslant 10^4$|$\\leqslant 10^9$|$\\leqslant 10^4$|", "locale": "zh-CN"}}}
{"pid": "P5173", "type": "P", "difficulty": 6, "samples": [["3 3", "2"], ["30 30\n", "155117522"], ["1234 12345678\n", "424074635"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": [], "title": "传球", "background": "临近中考，pG的班主任决定上一节体育课，放松一下。\n", "description": "老师带着 pG 的同学们一起做传球游戏。\n\n游戏规则是这样的： $n$ 个同学站成一个圆圈，其中的一个同学手里拿着一个球，当老师吹哨子时开始传球，每个同学可以把球传给自己左右的两个同学中的一个（左右任意），当老师再次吹哨子时，传球停止，此时，拿着球没有传出去的那个同学就是败者，要给大家表演一个节目。\n\npG 提出一个有趣的问题：有多少种不同的传球方法可以使得从 pG 手里开始传的球，传了 $m$ 次以后，又回到 pG 手里。两种传球方法被视作不同的方法，当且仅当这两种方法中，接到球的同学按接球顺序组成的序列是不同的。比如有三个同学 $1$ 号、 $2$ 号、 $3$ 号，并假设 pG 为 $1$ 号，球传了 $3$ 次回到pG手里的方式有 $1 \\to 2 \\to 3 \\to 1$ 和 $1 \\to 3 \\to 2 \\to 1$ ，共$ 2$ 种。", "inputFormat": "一行，有两个用空格隔开的整数 $n,m$", "outputFormat": "$1$ 个整数，表示符合题意的方法数。\n\n由于答案可能过大，对 $10^9+7$ 取模。", "hint": "对于8%的数据，$n \\le 100,m \\le 10^4$.\n\n对于100%的数据，$n \\le 3500,m \\le 10^9$.\n\n**数据有一定梯度。**\n", "locale": "zh-CN", "translations": {"en": {"title": "Passing the Ball", "background": "As the middle school entrance exam is approaching, pG’s head teacher decides to hold a PE class to help everyone relax.\n", "description": "The teacher leads pG’s classmates to play a ball-passing game.\n\nThe rules are as follows: $n$ students stand in a circle. One of them holds a ball at the beginning. When the teacher blows the whistle, they start passing the ball. Each student can pass the ball to either of their two neighbors (left or right, either is allowed). When the teacher blows the whistle again, passing stops. At that moment, the student who is holding the ball and did not pass it out is the loser, and must perform a show for everyone.\n\npG asks an interesting question: how many different passing methods make it so that the ball, starting from pG, returns to pG after being passed $m$ times? Two passing methods are considered different if and only if the sequence of students who receive the ball (in the order of receiving) is different. For example, if there are three students numbered $1$, $2$, $3$, and pG is student $1$, then the ways for the ball to return to pG after $3$ passes are $1 \\to 2 \\to 3 \\to 1$ and $1 \\to 3 \\to 2 \\to 1$, for a total of $2$ ways.", "inputFormat": "One line containing two integers $n, m$ separated by a space.", "outputFormat": "Output $1$ integer, the number of methods that satisfy the requirement.\n\nSince the answer may be very large, output it modulo $10^9+7$.", "hint": "For $8\\%$ of the testdata, $n \\le 100, m \\le 10^4$.\n\nFor $100\\%$ of the testdata, $n \\le 3500, m \\le 10^9$.\n\n**The testdata has a certain gradient.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "传球", "background": "临近中考，pG的班主任决定上一节体育课，放松一下。\n", "description": "老师带着 pG 的同学们一起做传球游戏。\n\n游戏规则是这样的： $n$ 个同学站成一个圆圈，其中的一个同学手里拿着一个球，当老师吹哨子时开始传球，每个同学可以把球传给自己左右的两个同学中的一个（左右任意），当老师再次吹哨子时，传球停止，此时，拿着球没有传出去的那个同学就是败者，要给大家表演一个节目。\n\npG 提出一个有趣的问题：有多少种不同的传球方法可以使得从 pG 手里开始传的球，传了 $m$ 次以后，又回到 pG 手里。两种传球方法被视作不同的方法，当且仅当这两种方法中，接到球的同学按接球顺序组成的序列是不同的。比如有三个同学 $1$ 号、 $2$ 号、 $3$ 号，并假设 pG 为 $1$ 号，球传了 $3$ 次回到pG手里的方式有 $1 \\to 2 \\to 3 \\to 1$ 和 $1 \\to 3 \\to 2 \\to 1$ ，共$ 2$ 种。", "inputFormat": "一行，有两个用空格隔开的整数 $n,m$", "outputFormat": "$1$ 个整数，表示符合题意的方法数。\n\n由于答案可能过大，对 $10^9+7$ 取模。", "hint": "对于8%的数据，$n \\le 100,m \\le 10^4$.\n\n对于100%的数据，$n \\le 3500,m \\le 10^9$.\n\n**数据有一定梯度。**\n", "locale": "zh-CN"}}}
{"pid": "P5174", "type": "P", "difficulty": 4, "samples": [["3", "12"], ["100\n", "16012"], ["1234567\n", "205275050"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000]}, "tags": [], "title": "圆点", "background": "中考了，Pg看着数学卷子的压轴题，陷入了沉思……\n\n题解：https://blog.csdn.net/kkkksc03/article/details/85008125", "description": "众所周知，平面中的每一个整点都**有且仅有**一个圆心在原点的圆穿过，我们定义这个整点的权值为穿过它的圆的**半径的平方**。\n\n现在有一个圆心在原点的圆，半径为$\\sqrt{R}$。你要求出这个圆所包含的所有整点的权值**和**。\n\n由于答案可能过大，对$10^9+7$取模。\n", "inputFormat": "一个数字$R$。", "outputFormat": "一行，仅有一个数字。", "hint": "样例1 解释：\n\n共包含了$9$个整点。分别为$(0,0),(0,1),(1,1),(1,0),(1,-1),(0,-1),(-1,-1),(-1,0),(-1,1)$。\n\n权值分别为$\\ 0,1,2,1,2,1,2,1,2$，总和为12。\n\n--------\n   \n对于50%的数据，$R \\le 10^{6}.$\n\n对于100%的数据，$R \\le 10^{14}.$\n", "locale": "zh-CN", "translations": {"en": {"title": "Dot Circles", "background": "The senior high school entrance exam is here. Pg stared at the last (hardest) problem on the math paper and fell into deep thought……\n\nSolution: https://blog.csdn.net/kkkksc03/article/details/85008125", "description": "As everyone knows, every lattice point (integer-coordinate point) on the plane is passed through by **exactly one** circle centered at the origin. We define the weight of this lattice point as the **square of the radius** of the circle that passes through it.\n\nNow there is a circle centered at the origin with radius $\\sqrt{R}$. You need to find the **sum** of the weights of all lattice points contained in this circle.\n\nSince the answer may be very large, output it modulo $10^9+7$.", "inputFormat": "One number $R$.", "outputFormat": "One line with only one number.", "hint": "Explanation for Sample 1:\n\nThere are $9$ lattice points in total: $(0,0),(0,1),(1,1),(1,0),(1,-1),(0,-1),(-1,-1),(-1,0),(-1,1)$.\n\nTheir weights are $\\ 0,1,2,1,2,1,2,1,2$, and the total sum is 12.\n\n--------\n\nConstraints:\n\nFor $50\\%$ of the testdata, $R \\le 10^{6}.$\n\nFor $100\\%$ of the testdata, $R \\le 10^{14}.$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "圆点", "background": "中考了，Pg看着数学卷子的压轴题，陷入了沉思……\n\n题解：https://blog.csdn.net/kkkksc03/article/details/85008125", "description": "众所周知，平面中的每一个整点都**有且仅有**一个圆心在原点的圆穿过，我们定义这个整点的权值为穿过它的圆的**半径的平方**。\n\n现在有一个圆心在原点的圆，半径为$\\sqrt{R}$。你要求出这个圆所包含的所有整点的权值**和**。\n\n由于答案可能过大，对$10^9+7$取模。\n", "inputFormat": "一个数字$R$。", "outputFormat": "一行，仅有一个数字。", "hint": "样例1 解释：\n\n共包含了$9$个整点。分别为$(0,0),(0,1),(1,1),(1,0),(1,-1),(0,-1),(-1,-1),(-1,0),(-1,1)$。\n\n权值分别为$\\ 0,1,2,1,2,1,2,1,2$，总和为12。\n\n--------\n   \n对于50%的数据，$R \\le 10^{6}.$\n\n对于100%的数据，$R \\le 10^{14}.$\n", "locale": "zh-CN"}}}
{"pid": "P5175", "type": "P", "difficulty": 5, "samples": [["3\n5 1 1 1 1\n4 3 4 3 2\n461564597527246 987489553 321654648 164165256 315648984", "40\n4193\n480929868"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000]}, "tags": ["数学", "矩阵乘法"], "title": "数列", "background": "题解：https://blog.csdn.net/kkkksc03/article/details/85008130", "description": "一个数列 $a_n $，已知 $a_1$ 及 $a_2$ 两项。\n\n数列 $a_n$ 满足递推式 $a_n=x \\times a_{n-1}+ y \\times a_{n-2}(n≥3).$\n\n求 $\\sum_{i=1}^na_i^2$\n\n由于答案可能过大，对 $10^9+7$ 取模。", "inputFormat": "第一行一个整数 $T$，即数据组数。\n\n下面 $T$ 行，每行 $5$ 个整数，$n,a_1,a_2,x,y$，含义如上。", "outputFormat": "共 $T$ 行，每行一个整数，即为每组数据的答案。", "hint": "样例解释：\n\n对于第一组样例，可知数列为 $1,1,2,3,5$，则答案是 $1^2+1^2+2^2+3^2+5^2=40$。\n\n对于第二组样例，可知数列为 $3,4,18,62$，则答案是 $3^2+4^2+18^2+62^2=4193$。\n\n~~第三组样例不予解释。~~\n\n对于前 $20\\%$ 的数据，保证 $x=y=1$。\n\n对于 $100\\%$ 的数据，$T=30000,1\\le n \\le 10^{18},1\\le a_1,a_2 ,x,y \\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "Sequence", "background": "Solution: https://blog.csdn.net/kkkksc03/article/details/85008130", "description": "Given a sequence $a_n$, where $a_1$ and $a_2$ are known.\n\nThe sequence $a_n$ satisfies the recurrence $a_n = x \\times a_{n-1} + y \\times a_{n-2} \\ (n \\ge 3).$\n\nCompute $\\sum_{i=1}^n a_i^2$.\n\nSince the answer may be very large, output it modulo $10^9+7$.", "inputFormat": "The first line contains an integer $T$, the number of test cases.\n\nThe next $T$ lines each contain $5$ integers $n, a_1, a_2, x, y$, with the meanings as described above.", "outputFormat": "Output $T$ lines, each containing one integer, the answer for each test case.", "hint": "Sample explanation:\n\nFor the first sample, the sequence is $1, 1, 2, 3, 5$, so the answer is $1^2 + 1^2 + 2^2 + 3^2 + 5^2 = 40$.\n\nFor the second sample, the sequence is $3, 4, 18, 62$, so the answer is $3^2 + 4^2 + 18^2 + 62^2 = 4193$.\n\n~~The third sample will not be explained.~~\n\nFor the first $20\\%$ of the testdata, it is guaranteed that $x = y = 1$.\n\nFor $100\\%$ of the testdata, $T = 30000$, $1 \\le n \\le 10^{18}$, $1 \\le a_1, a_2, x, y \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "数列", "background": "题解：https://blog.csdn.net/kkkksc03/article/details/85008130", "description": "一个数列 $a_n $，已知 $a_1$ 及 $a_2$ 两项。\n\n数列 $a_n$ 满足递推式 $a_n=x \\times a_{n-1}+ y \\times a_{n-2}(n≥3).$\n\n求 $\\sum_{i=1}^na_i^2$\n\n由于答案可能过大，对 $10^9+7$ 取模。", "inputFormat": "第一行一个整数 $T$，即数据组数。\n\n下面 $T$ 行，每行 $5$ 个整数，$n,a_1,a_2,x,y$，含义如上。", "outputFormat": "共 $T$ 行，每行一个整数，即为每组数据的答案。", "hint": "样例解释：\n\n对于第一组样例，可知数列为 $1,1,2,3,5$，则答案是 $1^2+1^2+2^2+3^2+5^2=40$。\n\n对于第二组样例，可知数列为 $3,4,18,62$，则答案是 $3^2+4^2+18^2+62^2=4193$。\n\n~~第三组样例不予解释。~~\n\n对于前 $20\\%$ 的数据，保证 $x=y=1$。\n\n对于 $100\\%$ 的数据，$T=30000,1\\le n \\le 10^{18},1\\le a_1,a_2 ,x,y \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5176", "type": "P", "difficulty": 7, "samples": [["2\n10 12 11\n30 20 25", "25302\n573830"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["最大公约数 gcd", "莫比乌斯反演", "整除分块"], "title": "公约数", "background": "在收卷最后五分钟，pg 发现了卷子反面还有一道大题。", "description": "求\n\n[![](https://cdn.luogu.com.cn/upload/pic/33775.png)](https://www.luogu.org/paste/zltm8ddt)\n\n由于答案可能过大，输出答案对 $10^9+7$ 取模的值。", "inputFormat": "第一行一个正整数 $T$，为数据组数。\n\n下面 $T$ 行，每行 $3$ 个整数，为 $n,m,p$。", "outputFormat": "共 $T$ 行，每行一个整数，为答案。", "hint": "对于前 $10\\%$ 的数据，$T=5~,~40 \\le n,m,p \\le 100$。\n\n对于另外 $20\\%$ 的数据，$T=50~,~100 \\le n,m,p \\le 5\\times 10^4$。\n\n对于另外 $20\\%$ 的数据，$T= 20~,~4\\times 10^6 \\le n,m,p \\le 5\\times 10^6$。\n\n对于另外 $50\\%$ 的数据，$T=10^3~,~10^7 \\le n,m,p \\le 2\\times 10^7$。", "locale": "zh-CN", "translations": {"en": {"title": "Greatest Common Divisor.", "background": "In the last five minutes before collecting the papers, pg found that there was still a major problem on the back side of the paper.", "description": "Compute\n\n[![](https://cdn.luogu.com.cn/upload/pic/33775.png)](https://www.luogu.org/paste/zltm8ddt)\n\nSince the answer may be too large, output the value of the answer modulo $10^9+7$.", "inputFormat": "The first line contains a positive integer $T$, the number of test cases.\n\nThe next $T$ lines each contain $3$ integers: $n, m, p$.", "outputFormat": "Output $T$ lines. Each line contains one integer, the answer.", "hint": "For the first $10\\%$ of the testdata, $T = 5$, and $40 \\le n, m, p \\le 100$.\n\nFor another $20\\%$ of the testdata, $T = 50$, and $100 \\le n, m, p \\le 5 \\times 10^4$.\n\nFor another $20\\%$ of the testdata, $T = 20$, and $4 \\times 10^6 \\le n, m, p \\le 5 \\times 10^6$.\n\nFor the remaining $50\\%$ of the testdata, $T = 10^3$, and $10^7 \\le n, m, p \\le 2 \\times 10^7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "公约数", "background": "在收卷最后五分钟，pg 发现了卷子反面还有一道大题。", "description": "求\n\n[![](https://cdn.luogu.com.cn/upload/pic/33775.png)](https://www.luogu.org/paste/zltm8ddt)\n\n由于答案可能过大，输出答案对 $10^9+7$ 取模的值。", "inputFormat": "第一行一个正整数 $T$，为数据组数。\n\n下面 $T$ 行，每行 $3$ 个整数，为 $n,m,p$。", "outputFormat": "共 $T$ 行，每行一个整数，为答案。", "hint": "对于前 $10\\%$ 的数据，$T=5~,~40 \\le n,m,p \\le 100$。\n\n对于另外 $20\\%$ 的数据，$T=50~,~100 \\le n,m,p \\le 5\\times 10^4$。\n\n对于另外 $20\\%$ 的数据，$T= 20~,~4\\times 10^6 \\le n,m,p \\le 5\\times 10^6$。\n\n对于另外 $50\\%$ 的数据，$T=10^3~,~10^7 \\le n,m,p \\le 2\\times 10^7$。", "locale": "zh-CN"}}}
{"pid": "P5177", "type": "P", "difficulty": 5, "samples": [["3\n10\n100\n1000", "20\n2634\n325502"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000]}, "tags": [], "title": "签到", "background": "题解：https://blog.csdn.net/kkkksc03/article/details/85008142", "description": "求$\\sum_{i=1}^n \\sum_{j=1}^n i \\  xor \\ j \\in [\\min(i,j),\\max(i,j)]$\n\n由于答案可能过大，输出答案对$10^9+7$取模的值。", "inputFormat": "第一行，一个整数$T$，为数据组数。\n\n下面$T$行，每行一个整数$n$。", "outputFormat": "对于每行数据，输出答案。", "hint": "第一组样例解释：\n\n符合题意的$(i,j)$有$20$对。\n```\ni=1  j=3  i^j=2\ni=1  j=5  i^j=4\ni=1  j=7  i^j=6\ni=1  j=9  i^j=8\ni=2  j=6  i^j=4\ni=2  j=7  i^j=5\ni=2  j=10  i^j=8\ni=3  j=1  i^j=2\ni=3  j=6  i^j=5\ni=3  j=7  i^j=4\ni=3  j=10  i^j=9\ni=5  j=1  i^j=4\ni=6  j=2  i^j=4\ni=6  j=3  i^j=5\ni=7  j=1  i^j=6\ni=7  j=2  i^j=5\ni=7  j=3  i^j=4\ni=9  j=1  i^j=8\ni=10  j=2  i^j=8\ni=10  j=3  i^j=9\n```\n\n对于27%的数据，$T\\le 5, n \\le 1000$。\n\n对于54%的数据，$T\\le 20, n \\le 5 \\times 10^5$。\n\n对于90%的数据，$T\\le 10^5, n \\le 10^{18}$。\n\n最后一个点，$T=3\\times 10^6 \\ ,\\  n\\le 10^{18}$。", "locale": "zh-CN", "translations": {"en": {"title": "Check-in.", "background": "Solution: https://blog.csdn.net/kkkksc03/article/details/85008142", "description": "Compute $\\sum_{i=1}^n \\sum_{j=1}^n i \\  xor \\ j \\in [\\min(i,j),\\max(i,j)]$.\n\nSince the answer may be very large, output the value modulo $10^9+7$.", "inputFormat": "The first line contains an integer $T$, the number of test cases.\n\nThe next $T$ lines each contain one integer $n$.", "outputFormat": "For each test case, output the answer.", "hint": "Explanation for the first sample:\n\nThere are $20$ pairs $(i,j)$ that satisfy the condition.\n```\ni=1  j=3  i^j=2\ni=1  j=5  i^j=4\ni=1  j=7  i^j=6\ni=1  j=9  i^j=8\ni=2  j=6  i^j=4\ni=2  j=7  i^j=5\ni=2  j=10  i^j=8\ni=3  j=1  i^j=2\ni=3  j=6  i^j=5\ni=3  j=7  i^j=4\ni=3  j=10  i^j=9\ni=5  j=1  i^j=4\ni=6  j=2  i^j=4\ni=6  j=3  i^j=5\ni=7  j=1  i^j=6\ni=7  j=2  i^j=5\ni=7  j=3  i^j=4\ni=9  j=1  i^j=8\ni=10  j=2  i^j=8\ni=10  j=3  i^j=9\n```\n\nConstraints:\n\nFor $27\\%$ of the testdata, $T\\le 5$, $n \\le 1000$.\n\nFor $54\\%$ of the testdata, $T\\le 20$, $n \\le 5 \\times 10^5$.\n\nFor $90\\%$ of the testdata, $T\\le 10^5$, $n \\le 10^{18}$.\n\nFor the last test point, $T=3\\times 10^6 \\ ,\\  n\\le 10^{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "签到", "background": "题解：https://blog.csdn.net/kkkksc03/article/details/85008142", "description": "求$\\sum_{i=1}^n \\sum_{j=1}^n i \\  xor \\ j \\in [\\min(i,j),\\max(i,j)]$\n\n由于答案可能过大，输出答案对$10^9+7$取模的值。", "inputFormat": "第一行，一个整数$T$，为数据组数。\n\n下面$T$行，每行一个整数$n$。", "outputFormat": "对于每行数据，输出答案。", "hint": "第一组样例解释：\n\n符合题意的$(i,j)$有$20$对。\n```\ni=1  j=3  i^j=2\ni=1  j=5  i^j=4\ni=1  j=7  i^j=6\ni=1  j=9  i^j=8\ni=2  j=6  i^j=4\ni=2  j=7  i^j=5\ni=2  j=10  i^j=8\ni=3  j=1  i^j=2\ni=3  j=6  i^j=5\ni=3  j=7  i^j=4\ni=3  j=10  i^j=9\ni=5  j=1  i^j=4\ni=6  j=2  i^j=4\ni=6  j=3  i^j=5\ni=7  j=1  i^j=6\ni=7  j=2  i^j=5\ni=7  j=3  i^j=4\ni=9  j=1  i^j=8\ni=10  j=2  i^j=8\ni=10  j=3  i^j=9\n```\n\n对于27%的数据，$T\\le 5, n \\le 1000$。\n\n对于54%的数据，$T\\le 20, n \\le 5 \\times 10^5$。\n\n对于90%的数据，$T\\le 10^5, n \\le 10^{18}$。\n\n最后一个点，$T=3\\times 10^6 \\ ,\\  n\\le 10^{18}$。", "locale": "zh-CN"}}}
{"pid": "P5178", "type": "P", "difficulty": 6, "samples": [["2 2\n1 2 3\n1 2 3\n0 1 3", "22\n46\n64"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["数学", "2019", "前缀和"], "title": "求和", "background": "QAQ", "description": "给定数列$a_1...a_n$及$x_0$。\n\n满足\n\n$$f[i][j]=\\begin{cases} a_i & j=0,i<=n \\\\ x_0 & j=0,i=n+1 \\\\ f[i][j-1]+f[i-1][j-1] & 0<i,j<=n+1,j<i \\\\ 0 & i<=j \\\\ \\end{cases}$$\n\n求\n\n$$\\sum_{i=0}^{n+1}\\sum_{j=0}^{n+1}f[i][j]$$\n\n~~但这样太水了~~\n\n于是给出$m$个操作，每次将$a[l]...a[r] \\  (0\\le l,r \\le n)$加$p$，对于每个操作，输出答案。\n\n特别地，若$0$在$l...r$范围内，我们认为$x_0$也加$p$。\n\n另外，在读入$m$个操作前，你也应该输出答案。\n\n由于答案可能过大，输出答案对$1234567891$取模的结果。", "inputFormat": "第一行，两个整数$n,m$。\n\n下面一行$n+1$个整数，为$a_1...a_n$及$x_0$，且最后一个是$x_0$。\n\n下面$m$行，每行$3$个整数$l,r,p$。", "outputFormat": "共$m+1$行，每行一个整数，为答案。", "hint": "共20个数据点。\n\n对于第$i$个数据点\n\n$$n,m=\\lfloor ln^{12}i+\\pi^5\\rfloor,|a,x,p|\\le \\lfloor ln^{19}i+i^{\\pi}\\rfloor$$\n\n保证$0 \\le l\\le r \\le n$\n\n~~想不到吧！~~", "locale": "zh-CN", "translations": {"en": {"title": "Sum", "background": "QAQ", "description": "Given a sequence $a_1 \\ldots a_n$ and $x_0$.\n\nIt satisfies:\n\n$$f[i][j]=\\begin{cases} a_i & j=0,i<=n \\\\ x_0 & j=0,i=n+1 \\\\ f[i][j-1]+f[i-1][j-1] & 0<i,j<=n+1,j<i \\\\ 0 & i<=j \\\\ \\end{cases}$$\n\nFind:\n\n$$\\sum_{i=0}^{n+1}\\sum_{j=0}^{n+1}f[i][j]$$\n\n~~But this is too easy.~~\n\nSo $m$ operations are given. Each time, add $p$ to $a[l] \\ldots a[r]$ $(0\\le l,r \\le n)$. For each operation, output the answer.\n\nIn particular, if $0$ is within the range $l \\ldots r$, we consider that $x_0$ is also increased by $p$.\n\nAlso, before reading the $m$ operations, you should output the answer once.\n\nSince the answer may be too large, output the result modulo $1234567891$.", "inputFormat": "The first line contains two integers $n, m$.\n\nThe next line contains $n+1$ integers, which are $a_1 \\ldots a_n$ and $x_0$, and the last one is $x_0$.\n\nThe next $m$ lines each contain $3$ integers $l, r, p$.", "outputFormat": "There are $m+1$ lines in total. Each line contains one integer, the answer.", "hint": "There are $20$ test points.\n\nFor the $i$-th test point:\n\n$$n,m=\\lfloor ln^{12}i+\\pi^5\\rfloor,|a,x,p|\\le \\lfloor ln^{19}i+i^{\\pi}\\rfloor$$\n\nIt is guaranteed that $0 \\le l\\le r \\le n$.\n\n~~Didn’t expect that, right!~~\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "求和", "background": "QAQ", "description": "给定数列$a_1...a_n$及$x_0$。\n\n满足\n\n$$f[i][j]=\\begin{cases} a_i & j=0,i<=n \\\\ x_0 & j=0,i=n+1 \\\\ f[i][j-1]+f[i-1][j-1] & 0<i,j<=n+1,j<i \\\\ 0 & i<=j \\\\ \\end{cases}$$\n\n求\n\n$$\\sum_{i=0}^{n+1}\\sum_{j=0}^{n+1}f[i][j]$$\n\n~~但这样太水了~~\n\n于是给出$m$个操作，每次将$a[l]...a[r] \\  (0\\le l,r \\le n)$加$p$，对于每个操作，输出答案。\n\n特别地，若$0$在$l...r$范围内，我们认为$x_0$也加$p$。\n\n另外，在读入$m$个操作前，你也应该输出答案。\n\n由于答案可能过大，输出答案对$1234567891$取模的结果。", "inputFormat": "第一行，两个整数$n,m$。\n\n下面一行$n+1$个整数，为$a_1...a_n$及$x_0$，且最后一个是$x_0$。\n\n下面$m$行，每行$3$个整数$l,r,p$。", "outputFormat": "共$m+1$行，每行一个整数，为答案。", "hint": "共20个数据点。\n\n对于第$i$个数据点\n\n$$n,m=\\lfloor ln^{12}i+\\pi^5\\rfloor,|a,x,p|\\le \\lfloor ln^{19}i+i^{\\pi}\\rfloor$$\n\n保证$0 \\le l\\le r \\le n$\n\n~~想不到吧！~~", "locale": "zh-CN"}}}
{"pid": "P5179", "type": "P", "difficulty": 6, "samples": [["1 3 1 2\n2 1 3 1\n2 1 4 1\n1000 1001 1001 1002\n", "2/5\n5/2\n3/1\n2001/2003"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["类欧几里得算法", "Stern-Brocot 树"], "title": "Fraction", "background": null, "description": "给你四个正整数 $a,\\,b,\\,c,\\,d$ ，求一个最简分数 $\\frac{p}{q}$ 满足 $\\frac{a}{b} < \\frac{p}{q} < \\frac{c}{d}$。\n\n若有多组解，输出 $q$ 最小的一组，若仍有多组解，输出 $p$ 最小的一组。", "inputFormat": "本题有多组数据，有若干行，每行四个正整数，为每组数据的 $a,b,c,d$。", "outputFormat": "每组数据各输出一行，如果答案是 $\\frac{p}{q}$，则以 `p/q` 的格式输出。", "hint": "|测试点编号|数据组数|$a,b,c,d$|\n|:-:|:-:|:-:|\n|$1 \\sim 3$|$\\leqslant 100$|$\\leqslant 100$|\n|$4 \\sim 10$|$\\leqslant 500$|$\\leqslant 10^9$|\n\n数据保证至少存在一个最简分数符合条件。", "locale": "zh-CN", "translations": {"en": {"title": "Fraction", "background": "", "description": "You are given four positive integers $a,\\,b,\\,c,\\,d$. Find a fraction $\\frac{p}{q}$ in lowest terms such that $\\frac{a}{b} < \\frac{p}{q} < \\frac{c}{d}$.\n\nIf there are multiple solutions, output the one with the smallest $q$. If there are still multiple solutions, output the one with the smallest $p$.", "inputFormat": "This problem contains multiple test cases. There are several lines, and each line contains four positive integers, which are $a,b,c,d$ for one test case.", "outputFormat": "For each test case, output one line. If the answer is $\\frac{p}{q}$, print it in the format `p/q`.", "hint": "|Test Point ID|Number of Test Cases|Constraints on $a,b,c,d$|\n|:-:|:-:|:-:|\n|$1 \\sim 3$|$\\leqslant 100$|$\\leqslant 100$|\n|$4 \\sim 10$|$\\leqslant 500$|$\\leqslant 10^9$|\n\nThe testdata guarantees that there exists at least one fraction in lowest terms that satisfies the condition.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Fraction", "background": null, "description": "给你四个正整数 $a,\\,b,\\,c,\\,d$ ，求一个最简分数 $\\frac{p}{q}$ 满足 $\\frac{a}{b} < \\frac{p}{q} < \\frac{c}{d}$。\n\n若有多组解，输出 $q$ 最小的一组，若仍有多组解，输出 $p$ 最小的一组。", "inputFormat": "本题有多组数据，有若干行，每行四个正整数，为每组数据的 $a,b,c,d$。", "outputFormat": "每组数据各输出一行，如果答案是 $\\frac{p}{q}$，则以 `p/q` 的格式输出。", "hint": "|测试点编号|数据组数|$a,b,c,d$|\n|:-:|:-:|:-:|\n|$1 \\sim 3$|$\\leqslant 100$|$\\leqslant 100$|\n|$4 \\sim 10$|$\\leqslant 500$|$\\leqslant 10^9$|\n\n数据保证至少存在一个最简分数符合条件。", "locale": "zh-CN"}}}
{"pid": "P5180", "type": "P", "difficulty": 7, "samples": [["10 15\n1 2\n2 3\n3 4\n3 5\n3 6\n4 7\n7 8\n7 9\n7 10\n5 6\n6 8\n7 8\n4 1\n3 6\n5 3", "10 9 8 4 1 1 3 1 1 1 "]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["图论", "Tarjan", "模板题"], "title": "【模板】支配树", "background": "模板题，无背景。", "description": "给定一张有向图，求从 $1$ 号点出发，每个点能支配的点的个数（包括自己）。", "inputFormat": "第一行两个正整数 $n,m$，表示点数和边数。\n\n接下来 $m$ 行，每行输入两个整数 $u,v$，表示一条 $u$ 到 $v$ 的有向边。", "outputFormat": "一行 $n$ 个整数，表示每个点能支配的点的个数。", "hint": "$n\\le2\\times 10^5$，$m\\le3\\times 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Dominator Tree", "background": "This is a template problem, with no background.", "description": "Given a directed graph, starting from node $1$, find for each node the number of nodes it can dominate (including itself).", "inputFormat": "The first line contains two positive integers $n, m$, representing the number of nodes and the number of edges.\n\nIn the next $m$ lines, each line contains two integers $u, v$, representing a directed edge from $u$ to $v$.", "outputFormat": "Output one line with $n$ integers, representing the number of nodes each node can dominate.", "hint": "Constraints: $n \\le 2 \\times 10^5$, $m \\le 3 \\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】支配树", "background": "模板题，无背景。", "description": "给定一张有向图，求从 $1$ 号点出发，每个点能支配的点的个数（包括自己）。", "inputFormat": "第一行两个正整数 $n,m$，表示点数和边数。\n\n接下来 $m$ 行，每行输入两个整数 $u,v$，表示一条 $u$ 到 $v$ 的有向边。", "outputFormat": "一行 $n$ 个整数，表示每个点能支配的点的个数。", "hint": "$n\\le2\\times 10^5$，$m\\le3\\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P5181", "type": "P", "difficulty": 4, "samples": [["4 1 5 0 1\n1 3 4 2", "2"], ["7 3 8 1 2\n2 3 1 6 4 7 5", "0"], ["6 2 11 3 0\n6 3 5 4 2 1", "1"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000]}, "tags": ["2009", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #1] GENIJALAC", "background": "", "description": " **译自 [COCI 2009.10](http://hsin.hr/coci/archive/2009_2010/) T5「[GENIJALAC](http://hsin.hr/coci/archive/2009_2010/contest1_tasks.pdf)」**\n\nMirko 发明了一台打乱机。机器接受一个 $N$ 列、无限行的纸带作为输入和输出。这 $N$ 列依次编号为 $1\\ldots N$。\n\n开始时，只有纸带的第一行写了数，其下方的每一行都是空白的。  \n在纸带的第一行中，每列有一个整数，第 $i$ 列上写了整数 $i$。  \n另外，Mirko 给出了一个打乱排列，这是一个长度为 $N$ 的排列 $s_1,$ $s_2,$ $\\ldots,$ $s_N$。\n\n有一个行指针，开始时指向首行。  \n每次运行该机器时，机器会将当前行（行指针所指向的行）位于第 $i$ 列的数放到下一行的第 $s_i$ 列上，$N$ 个数都放好后，指针将下移一行。\n\nMirko 运行了该机器无限次。现在 Mirko 将纸带的前 $C$ 列和后 $D$ 列剪掉了，我们称之为新的纸带。\n\n试问：在新纸带的第 $A\\sim B$ 行中，有多少行与新纸带的首行相同。", "inputFormat": "第一行五个整数 $N, A, B, C, D$。  \n第二行 $N$ 个整数 $s_1,$ $s_2,$ $\\ldots,$ $s_N$。", "outputFormat": "一行，一个整数，表示在新纸带的第 $A\\sim B$ 行中，有多少行与新纸带的首行相同。", "hint": "#### 样例说明 1\n```plain\n+-----+\n|1 2 3|4 <--\n|1 3 4|2\n|1 4 2|3\n|1 2 3|4 <--\n|1 3 4|2\n+-----+\n 1 4 2 3\n 1 2 3 4\n```\n\n#### 样例说明 2\n```plain\n1 2 3 4 5 6 7\n2 3 1 6 4 7 5\n +-------+\n3|1 2 7 6|5 4\n1|2 3 5 7|4 6\n2|3 1 4 5|6 7\n3|1 2 6 4|7 5\n1|2 3 7 6|5 4\n2|3 1 5 7|4 6\n +-------+\n3 1 2 4 5 6 7\n1 2 3 6 4 7 5\n```\n\n#### 样例说明 3\n```plain\n1 2 3 4 5 6\n     +-----+\n6 3 5|4 2 1|\n1 5 2|4 3 6|\n6 2 3|4 5 1|\n1 3 5|4 2 6|\n6 5 2|4 3 1|\n1 2 3|4 5 6| <--\n6 3 5|4 2 1|\n1 5 2|4 3 6|\n6 2 3|4 5 1|\n1 3 5|4 2 6|\n     +-----+\n```\n\n#### 数据范围与提示\n对于 $40\\%$ 的数据，$A,$ $B,$ $C,$ $D,$ $N\\le 2000$。  \n对于所有数据，$1\\le N\\le 5\\times 10^5,$ $1\\le A, B\\le 10^{12},$ $0\\le C,$ $D\\le N,$ $C+D\\le N$。", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2009/2010 #1] GENIJALAC", "background": "", "description": "**Translated from [COCI 2009.10](http://hsin.hr/coci/archive/2009_2010/) T5 “[GENIJALAC](http://hsin.hr/coci/archive/2009_2010/contest1_tasks.pdf)”.**\n\nMirko invented a shuffling machine. The machine takes a paper tape with $N$ columns and infinitely many rows as both input and output. These $N$ columns are numbered $1 \\ldots N$ in order.\n\nAt the beginning, only the first row of the tape contains numbers, and every row below it is blank.  \nIn the first row, each column contains an integer: column $i$ contains the integer $i$.  \nIn addition, Mirko is given a shuffle permutation, which is a permutation of length $N$: $s_1,$ $s_2,$ $\\ldots,$ $s_N$.\n\nThere is a row pointer, which initially points to the first row.  \nEach time the machine runs, for every $i$, it moves the number in column $i$ of the current row (the row pointed to by the pointer) to column $s_i$ of the next row. After all $N$ numbers are placed, the pointer moves down by one row.\n\nMirko runs the machine infinitely many times. Now Mirko cuts off the first $C$ columns and the last $D$ columns of the tape; we call the result the new tape.\n\nQuestion: among rows $A \\sim B$ of the new tape, how many rows are identical to the first row of the new tape?", "inputFormat": "The first line contains five integers $N, A, B, C, D$.  \nThe second line contains $N$ integers $s_1,$ $s_2,$ $\\ldots,$ $s_N$.", "outputFormat": "One line with one integer: the number of rows among rows $A \\sim B$ of the new tape that are identical to the first row of the new tape.", "hint": "#### Sample Explanation 1\n```plain\n+-----+\n|1 2 3|4 <--\n|1 3 4|2\n|1 4 2|3\n|1 2 3|4 <--\n|1 3 4|2\n+-----+\n 1 4 2 3\n 1 2 3 4\n```\n\n#### Sample Explanation 2\n```plain\n1 2 3 4 5 6 7\n2 3 1 6 4 7 5\n +-------+\n3|1 2 7 6|5 4\n1|2 3 5 7|4 6\n2|3 1 4 5|6 7\n3|1 2 6 4|7 5\n1|2 3 7 6|5 4\n2|3 1 5 7|4 6\n +-------+\n3 1 2 4 5 6 7\n1 2 3 6 4 7 5\n```\n\n#### Sample Explanation 3\n```plain\n1 2 3 4 5 6\n     +-----+\n6 3 5|4 2 1|\n1 5 2|4 3 6|\n6 2 3|4 5 1|\n1 3 5|4 2 6|\n6 5 2|4 3 1|\n1 2 3|4 5 6| <--\n6 3 5|4 2 1|\n1 5 2|4 3 6|\n6 2 3|4 5 1|\n1 3 5|4 2 6|\n     +-----+\n```\n\n#### Constraints and Hints\n\nFor $40\\%$ of the testdata, $A,$ $B,$ $C,$ $D,$ $N \\le 2000$.  \nFor all testdata, $1 \\le N \\le 5 \\times 10^5,$ $1 \\le A, B \\le 10^{12},$ $0 \\le C,$ $D \\le N,$ and $C + D \\le N$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2009/2010 #1] GENIJALAC", "background": "", "description": " **译自 [COCI 2009.10](http://hsin.hr/coci/archive/2009_2010/) T5「[GENIJALAC](http://hsin.hr/coci/archive/2009_2010/contest1_tasks.pdf)」**\n\nMirko 发明了一台打乱机。机器接受一个 $N$ 列、无限行的纸带作为输入和输出。这 $N$ 列依次编号为 $1\\ldots N$。\n\n开始时，只有纸带的第一行写了数，其下方的每一行都是空白的。  \n在纸带的第一行中，每列有一个整数，第 $i$ 列上写了整数 $i$。  \n另外，Mirko 给出了一个打乱排列，这是一个长度为 $N$ 的排列 $s_1,$ $s_2,$ $\\ldots,$ $s_N$。\n\n有一个行指针，开始时指向首行。  \n每次运行该机器时，机器会将当前行（行指针所指向的行）位于第 $i$ 列的数放到下一行的第 $s_i$ 列上，$N$ 个数都放好后，指针将下移一行。\n\nMirko 运行了该机器无限次。现在 Mirko 将纸带的前 $C$ 列和后 $D$ 列剪掉了，我们称之为新的纸带。\n\n试问：在新纸带的第 $A\\sim B$ 行中，有多少行与新纸带的首行相同。", "inputFormat": "第一行五个整数 $N, A, B, C, D$。  \n第二行 $N$ 个整数 $s_1,$ $s_2,$ $\\ldots,$ $s_N$。", "outputFormat": "一行，一个整数，表示在新纸带的第 $A\\sim B$ 行中，有多少行与新纸带的首行相同。", "hint": "#### 样例说明 1\n```plain\n+-----+\n|1 2 3|4 <--\n|1 3 4|2\n|1 4 2|3\n|1 2 3|4 <--\n|1 3 4|2\n+-----+\n 1 4 2 3\n 1 2 3 4\n```\n\n#### 样例说明 2\n```plain\n1 2 3 4 5 6 7\n2 3 1 6 4 7 5\n +-------+\n3|1 2 7 6|5 4\n1|2 3 5 7|4 6\n2|3 1 4 5|6 7\n3|1 2 6 4|7 5\n1|2 3 7 6|5 4\n2|3 1 5 7|4 6\n +-------+\n3 1 2 4 5 6 7\n1 2 3 6 4 7 5\n```\n\n#### 样例说明 3\n```plain\n1 2 3 4 5 6\n     +-----+\n6 3 5|4 2 1|\n1 5 2|4 3 6|\n6 2 3|4 5 1|\n1 3 5|4 2 6|\n6 5 2|4 3 1|\n1 2 3|4 5 6| <--\n6 3 5|4 2 1|\n1 5 2|4 3 6|\n6 2 3|4 5 1|\n1 3 5|4 2 6|\n     +-----+\n```\n\n#### 数据范围与提示\n对于 $40\\%$ 的数据，$A,$ $B,$ $C,$ $D,$ $N\\le 2000$。  \n对于所有数据，$1\\le N\\le 5\\times 10^5,$ $1\\le A, B\\le 10^{12},$ $0\\le C,$ $D\\le N,$ $C+D\\le N$。", "locale": "zh-CN"}}}
{"pid": "P5182", "type": "P", "difficulty": 4, "samples": [["8 0", "32"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["二分图"], "title": "棋盘覆盖", "background": "", "description": "给定一个 $N$ 行 $N$ 列的棋盘，已知某些格子禁止放置。\n\n求最多能往棋盘上放多少块的长度为 $2$、宽度为 $1$ 的骨牌，骨牌的边界与格线重合（骨牌占用两个格子），并且任意两张骨牌都不重叠。", "inputFormat": "第一行包含两个整数 $N$ 和 $t$，其中 $t$ 为禁止放置的格子的数量。\n\n接下来 $t$ 行每行包含两个整数 $x$ 和 $y$，表示位于第 $x$ 行第 $y$ 列的格子禁止放置，行列数从 $1$ 开始。", "outputFormat": "输出一个整数，表示结果。", "hint": "$1 \\le N \\le 100$，$0 \\le t \\le 100$", "locale": "zh-CN", "translations": {"en": {"title": "Board Tiling", "background": "", "description": "Given an $N$ by $N$ chessboard, it is known that some cells are forbidden to place on.\n\nFind the maximum number of dominoes of length $2$ and width $1$ that can be placed on the board. The boundary of each domino must align with the grid lines (each domino occupies two cells), and no two dominoes may overlap.", "inputFormat": "The first line contains two integers $N$ and $t$, where $t$ is the number of forbidden cells.\n\nThe next $t$ lines each contain two integers $x$ and $y$, indicating that the cell at row $x$ and column $y$ is forbidden. Row and column indices start from $1$.", "outputFormat": "Output one integer, the result.", "hint": "$1 \\le N \\le 100$，$0 \\le t \\le 100$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "棋盘覆盖", "background": "", "description": "给定一个 $N$ 行 $N$ 列的棋盘，已知某些格子禁止放置。\n\n求最多能往棋盘上放多少块的长度为 $2$、宽度为 $1$ 的骨牌，骨牌的边界与格线重合（骨牌占用两个格子），并且任意两张骨牌都不重叠。", "inputFormat": "第一行包含两个整数 $N$ 和 $t$，其中 $t$ 为禁止放置的格子的数量。\n\n接下来 $t$ 行每行包含两个整数 $x$ 和 $y$，表示位于第 $x$ 行第 $y$ 列的格子禁止放置，行列数从 $1$ 开始。", "outputFormat": "输出一个整数，表示结果。", "hint": "$1 \\le N \\le 100$，$0 \\le t \\le 100$", "locale": "zh-CN"}}}
{"pid": "P5183", "type": "P", "difficulty": 5, "samples": [["2 1\n2 1\n1 2", "1\n1"], ["3 2\n2 1 3\n1 3\n2 3", "3\n2\n1\n2"], ["5 5\n1 2 3 4 5\n1 5\n2 5\n1 4\n1 1\n3 5", "0"]], "limits": {"time": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200], "memory": [32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000, 32000]}, "tags": ["2009", "Special Judge", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #2] POSLOZI", "background": null, "description": "**译自 [COCI 2009.11](http://hsin.hr/coci/archive/2009_2010/) T5「[POSLOZI](http://hsin.hr/coci/archive/2009_2010/contest2_tasks.pdf)」**\n\n给一个长度为 $N$ 的排列 $(1\\le N\\le 12)$。有 $M$ 种允许的修改方式 $(1\\le M\\le \\frac{N\\times (N-1)}{2})$，保证修改方式不重复，每种方式用 $L,$ $R$ 来表示，意为你可以将下标为 $L$ 的数与下标为 $R$ 的数交换。你可以修改该排列若干次，请给出一种修改方案，使原排列变为 $1,$ $2,$ $3,$ $\\ldots,$ $N$。如果有多种方案，输出修改次数最少的方案。如果还有多种方案，输出任意一组即可。", "inputFormat": "第一行两个整数 $N,$ $M$。  \n第二行 $N$ 个整数，表示排列。  \n接下来 $M$ 行，第 $i$ 行有两个整数，表示第 $i$ 种修改方式。", "outputFormat": "首行一个整数 $\\mathit{ope\\_cnt}$，表示最少的修改次数。  \n接下来 $\\mathit{ope\\_cnt}$ 行，每行一个整数，表示进行第 $i$ 种修改。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2009/2010 #2] POSLOZI", "background": "", "description": "**Translated from [COCI 2009.11](http://hsin.hr/coci/archive/2009_2010/) T5 “[POSLOZI](http://hsin.hr/coci/archive/2009_2010/contest2_tasks.pdf)”.**\n\nYou are given a permutation of length $N$ $(1 \\le N \\le 12)$. There are $M$ allowed types of operations $(1 \\le M \\le \\frac{N \\times (N - 1)}{2})$. It is guaranteed that no operation type is repeated. Each operation is described by $L$, $R$, meaning you may swap the number at index $L$ with the number at index $R$. You may apply operations to the permutation any number of times. Please output one sequence of operations that turns the original permutation into $1$, $2$, $3$, $\\ldots$, $N$. If there are multiple solutions, output one with the minimum number of operations. If there are still multiple, output any one of them.", "inputFormat": "The first line contains two integers $N$, $M$.  \nThe second line contains $N$ integers, describing the permutation.  \nThe next $M$ lines each contain two integers; the $i$-th line describes the $i$-th allowed operation.", "outputFormat": "The first line contains an integer $\\mathit{ope\\_cnt}$, the minimum number of operations.  \nThe next $\\mathit{ope\\_cnt}$ lines each contain one integer, indicating that you perform the $i$-th allowed operation.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2009/2010 #2] POSLOZI", "background": null, "description": "**译自 [COCI 2009.11](http://hsin.hr/coci/archive/2009_2010/) T5「[POSLOZI](http://hsin.hr/coci/archive/2009_2010/contest2_tasks.pdf)」**\n\n给一个长度为 $N$ 的排列 $(1\\le N\\le 12)$。有 $M$ 种允许的修改方式 $(1\\le M\\le \\frac{N\\times (N-1)}{2})$，保证修改方式不重复，每种方式用 $L,$ $R$ 来表示，意为你可以将下标为 $L$ 的数与下标为 $R$ 的数交换。你可以修改该排列若干次，请给出一种修改方案，使原排列变为 $1,$ $2,$ $3,$ $\\ldots,$ $N$。如果有多种方案，输出修改次数最少的方案。如果还有多种方案，输出任意一组即可。", "inputFormat": "第一行两个整数 $N,$ $M$。  \n第二行 $N$ 个整数，表示排列。  \n接下来 $M$ 行，第 $i$ 行有两个整数，表示第 $i$ 种修改方式。", "outputFormat": "首行一个整数 $\\mathit{ope\\_cnt}$，表示最少的修改次数。  \n接下来 $\\mathit{ope\\_cnt}$ 行，每行一个整数，表示进行第 $i$ 种修改。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P5184", "type": "P", "difficulty": 5, "samples": [["3\n1 2\n1 100\n1 1", "1 2 100\n"], ["2\n5 10 20 30 40 50\n2 28 27", "10 20 28 27 30 40 50"], ["2\n3 5 1 2\n3 5 1 1", "5 1 1 5 1 2"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2009", "O2优化", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #2] PASIJANS", "background": "原题时限 5s，这里根据洛谷评测机速度更改了时限。", "description": "**译自 [COCI 2009.11](http://hsin.hr/coci/archive/2009_2010/) T6「[PASIJANS](http://hsin.hr/coci/archive/2009_2010/contest2_tasks.pdf)」**\n\n给出 $N$ 个已经塞了数进去的栈（每个栈中元素的数量可能不同），有一个空的「答案队列」，你每次可以「将一个栈的栈顶元素弹出，插入答案队列的末尾」，直至所有栈都清空。试求「字典序最小」的答案队列。\n\n如果两个答案队列 $a, b$ （从队首往队尾数）前 $i-1$ 个数都相同，而 $a_i<b_i$，则我们称 $a$ 的字典序比 $b$ 的字典序小。", "inputFormat": "第一行一个整数 $N$。  \n接下来 $N$ 行，每行第一个整数为 $L$，表示栈中元素的数量。接下来按照从栈顶到栈底的顺序依次给出 $L$ 个整数。", "outputFormat": "$\\sum L$ 个整数，表示字典序最小的答案队列。", "hint": "$1\\le N\\le 1000,$ $1\\le L\\le 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2009/2010 #2] PASIJANS", "background": "The original time limit was 5 s. The time limit here has been adjusted according to the speed of Luogu's judge machines.", "description": "**Translated from [COCI 2009.11](http://hsin.hr/coci/archive/2009_2010/) T6 “[PASIJANS](http://hsin.hr/coci/archive/2009_2010/contest2_tasks.pdf)”**\n\nYou are given $N$ stacks that already contain numbers (the number of elements in each stack may be different), and an empty “answer queue”. Each time, you may “pop the top element of one stack and append it to the end of the answer queue”, until all stacks become empty. Find the lexicographically smallest possible answer queue.\n\nIf two answer queues $a, b$ (from front to back) have the same first $i-1$ numbers, and $a_i<b_i$, then we say the lexicographical order of $a$ is smaller than that of $b$.", "inputFormat": "The first line contains an integer $N$.  \nIn the next $N$ lines, the first integer is $L$, the number of elements in the stack. Then $L$ integers are given in order from the top of the stack to the bottom.", "outputFormat": "Output $\\sum L$ integers, representing the lexicographically smallest answer queue.", "hint": "$1\\le N\\le 1000,$ $1\\le L\\le 1000$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2009/2010 #2] PASIJANS", "background": "原题时限 5s，这里根据洛谷评测机速度更改了时限。", "description": "**译自 [COCI 2009.11](http://hsin.hr/coci/archive/2009_2010/) T6「[PASIJANS](http://hsin.hr/coci/archive/2009_2010/contest2_tasks.pdf)」**\n\n给出 $N$ 个已经塞了数进去的栈（每个栈中元素的数量可能不同），有一个空的「答案队列」，你每次可以「将一个栈的栈顶元素弹出，插入答案队列的末尾」，直至所有栈都清空。试求「字典序最小」的答案队列。\n\n如果两个答案队列 $a, b$ （从队首往队尾数）前 $i-1$ 个数都相同，而 $a_i<b_i$，则我们称 $a$ 的字典序比 $b$ 的字典序小。", "inputFormat": "第一行一个整数 $N$。  \n接下来 $N$ 行，每行第一个整数为 $L$，表示栈中元素的数量。接下来按照从栈顶到栈底的顺序依次给出 $L$ 个整数。", "outputFormat": "$\\sum L$ 个整数，表示字典序最小的答案队列。", "hint": "$1\\le N\\le 1000,$ $1\\le L\\le 1000$。", "locale": "zh-CN"}}}
{"pid": "P5185", "type": "P", "difficulty": 5, "samples": [["1 1\n26 02 03 03 1", "5"], ["1 1\n26 02 03 03 2", "185"], ["3 3\n22 03 01 10 9 10 10\n05 05 16 12 1 7 10\n20 06 15 01 4 9 10", "102\n204\n125"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2009", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #3] PLANETE", "background": null, "description": "**译自 [COCI 2009.12](http://hsin.hr/coci/archive/2009_2010/) T6「[PLANETE](http://hsin.hr/coci/archive/2009_2010/contest3_tasks.pdf)」**\n\n已知 $N$ 组记录，第 $i$ 组记录包含两个**无年份**的日期 $A_i,B_i$（换言之，只有月和日）以及一个长度为 $M$ 的数组 $a_{i,1},a_{i,2},\\dots,a_{i,M}$。请给出关于 $x_1,x_2,\\dots,x_M\\ (1\\le x_j\\le 365)$ 的方程组\n\n$\\begin{cases}A_1+\\displaystyle\\sum_{j=1}^M a_{1,j}x_j\\equiv B_1\\pmod{365} \\\\ A_2+\\displaystyle\\sum_{j=1}^M a_{2,j}x_j\\equiv B_2\\pmod{365} \\\\ \\vdots \\\\ A_N+\\displaystyle\\sum_{j=1}^M a_{N,j}x_j\\equiv B_N\\pmod{365}\\end{cases}$\n\n的任意一组解，若无解则仅输出 `-1`。", "inputFormat": "第一行两个整数 $N,M$。\n\n接下来 $N$ 行，第 $i$ 行开头有四个整数，分别表示 $A_i$ 的日，$A_i$ 的月，$B_i$ 的日，$B_i$ 的月。接下来有 $M$ 个整数，表示 $a_{i,1},a_{i,2},\\dots,a_{i,M}$。", "outputFormat": "若有解，输出共 $M$ 行，第 $i$ 行一个整数，表示 $x_i$。\n\n若无解则仅输出 `-1`。", "hint": "$1\\le N,M\\le 200$，$0\\le a_{i,j}\\le 200$，保证输入的月、日合法。", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2009/2010 #3] PLANETE", "background": "", "description": "**Translated from [COCI 2009.12](http://hsin.hr/coci/archive/2009_2010/) T6 “[PLANETE](http://hsin.hr/coci/archive/2009_2010/contest3_tasks.pdf)”.**\n\nYou are given $N$ records. The $i$-th record contains two dates $A_i, B_i$ **without a year** (in other words, only month and day), and an array $a_{i,1}, a_{i,2}, \\dots, a_{i,M}$ of length $M$. Find any solution to the system of equations in $x_1, x_2, \\dots, x_M\\ (1 \\le x_j \\le 365)$:\n\n$\\begin{cases}A_1+\\displaystyle\\sum_{j=1}^M a_{1,j}x_j\\equiv B_1\\pmod{365} \\\\ A_2+\\displaystyle\\sum_{j=1}^M a_{2,j}x_j\\equiv B_2\\pmod{365} \\\\ \\vdots \\\\ A_N+\\displaystyle\\sum_{j=1}^M a_{N,j}x_j\\equiv B_N\\pmod{365}\\end{cases}$\n\nIf there is no solution, output `-1` only.", "inputFormat": "The first line contains two integers $N, M$.\n\nIn the next $N$ lines, the $i$-th line starts with four integers, representing: the day of $A_i$, the month of $A_i$, the day of $B_i$, and the month of $B_i$. Then follow $M$ integers representing $a_{i,1}, a_{i,2}, \\dots, a_{i,M}$.", "outputFormat": "If there is a solution, output $M$ lines in total. The $i$-th line contains one integer, representing $x_i$.\n\nIf there is no solution, output `-1` only.", "hint": "Constraints: $1 \\le N, M \\le 200$, $0 \\le a_{i,j} \\le 200$. The input months and days are guaranteed to be valid.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2009/2010 #3] PLANETE", "background": null, "description": "**译自 [COCI 2009.12](http://hsin.hr/coci/archive/2009_2010/) T6「[PLANETE](http://hsin.hr/coci/archive/2009_2010/contest3_tasks.pdf)」**\n\n已知 $N$ 组记录，第 $i$ 组记录包含两个**无年份**的日期 $A_i,B_i$（换言之，只有月和日）以及一个长度为 $M$ 的数组 $a_{i,1},a_{i,2},\\dots,a_{i,M}$。请给出关于 $x_1,x_2,\\dots,x_M\\ (1\\le x_j\\le 365)$ 的方程组\n\n$\\begin{cases}A_1+\\displaystyle\\sum_{j=1}^M a_{1,j}x_j\\equiv B_1\\pmod{365} \\\\ A_2+\\displaystyle\\sum_{j=1}^M a_{2,j}x_j\\equiv B_2\\pmod{365} \\\\ \\vdots \\\\ A_N+\\displaystyle\\sum_{j=1}^M a_{N,j}x_j\\equiv B_N\\pmod{365}\\end{cases}$\n\n的任意一组解，若无解则仅输出 `-1`。", "inputFormat": "第一行两个整数 $N,M$。\n\n接下来 $N$ 行，第 $i$ 行开头有四个整数，分别表示 $A_i$ 的日，$A_i$ 的月，$B_i$ 的日，$B_i$ 的月。接下来有 $M$ 个整数，表示 $a_{i,1},a_{i,2},\\dots,a_{i,M}$。", "outputFormat": "若有解，输出共 $M$ 行，第 $i$ 行一个整数，表示 $x_i$。\n\n若无解则仅输出 `-1`。", "hint": "$1\\le N,M\\le 200$，$0\\le a_{i,j}\\le 200$，保证输入的月、日合法。", "locale": "zh-CN"}}}
