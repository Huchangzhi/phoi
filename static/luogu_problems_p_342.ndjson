{"pid": "P7930", "type": "P", "difficulty": 6, "samples": [["3 4\n1123\n1322\n1221\n", "1\n"], ["2 2\n11\n22\n", "0\n"], ["5 3\n111\n222\n333\n123\n132\n", "2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "COCI（克罗地亚）"], "title": "[COCI 2021/2022 #1] Set", "background": "在知名游戏 SET 中，存在着一些数字、形状、颜色等不同的卡片，玩家的目标是确定一个存在的 triplet of cards（即卡片的三元组，也就是三张卡片构成的组合），使其符合特定的要求。Marin 和 Josip 很快就对这个游戏感到无趣，并对其进行了加强。", "description": "在本题中，定义每张卡片代表着一个仅由 $ 1, 2, 3 $ 构成的长度为 $ k $ 的序列，共有 $ n $ 张卡片，卡片之间是无序的，保证卡片**两两不同**。\n\n定义一个 SET 表示，当且仅当一个无序的 triplet of cards 其中的三个序列的每一位均相同或各不相同，用原文中的话就是 same 或 pairwise different，更严谨地表示，我们令这三个序列为 $ S_i, S_j, S_k $，则一定满足如下条件：\n\n* $ i \\lt j \\lt k $\n* $ \\forall x \\in \\left[1, k\\right] $，满足 $ S_i(x) = S_j(x) = S_k(x) $ 或 $ S_i(x) \\neq S_j(x) \\neq S_k(x) $\n\n例如 $ (1123, 1322, 1221) $ 便满足 $ 1, 3 $ 位均相同，$ 2,4 $ 位各不相同。\n\n给你这些序列，求可以组成多少种本质不同的 SET。", "inputFormat": "第一行为两个整数正整数 $ n, k $。\n\n接下来 $ n $ 行中每一行包含一个仅由 $ 1, 2, 3 $ 构成的长度为 $ k $ 的序列，代表着一张卡片。\n\n保证每张卡片上的序列不同。", "outputFormat": "仅一行一个整数，表示可以组成的本质不同的 SET 的数量。", "hint": "**【样例解释 \\#3】**\n\n可以组成的两个 SET 分别为 $ (S_1, S_2, S_3) $ 和  $ (S_1, S_4, S_5) $。\n\n**【数据范围】**\n\n对于全部数据，$1\\le k\\le 12$，$1\\le n\\le 3^k$，$S_i$ 互不相同，$1\\le S_i(x) \\le 3$。\n\n| Subtask |  特殊限制  | 分数 |\n| :-----: | :--------: | :--: |\n|   $1$   |  $k\\le 5$  | $10$ |\n|   $2$   |  $k\\le 7$  | $30$ |\n|   $3$   | 无特殊限制 | $70$ |\n\n#### 说明\n**本题总分 $110$ 分。**\n\n本题译自 [Croatian Open Competition in Informatics 2021/2022](https://hsin.hr/coci/archive/2021_2022) [Contest #1](https://hsin.hr/coci/archive/2021_2022/contest1_tasks.pdf) T4 Set。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2021/2022 #1] Set", "background": "在知名游戏 SET 中，存在着一些数字、形状、颜色等不同的卡片，玩家的目标是确定一个存在的 triplet of cards（即卡片的三元组，也就是三张卡片构成的组合），使其符合特定的要求。Marin 和 Josip 很快就对这个游戏感到无趣，并对其进行了加强。", "description": "在本题中，定义每张卡片代表着一个仅由 $ 1, 2, 3 $ 构成的长度为 $ k $ 的序列，共有 $ n $ 张卡片，卡片之间是无序的，保证卡片**两两不同**。\n\n定义一个 SET 表示，当且仅当一个无序的 triplet of cards 其中的三个序列的每一位均相同或各不相同，用原文中的话就是 same 或 pairwise different，更严谨地表示，我们令这三个序列为 $ S_i, S_j, S_k $，则一定满足如下条件：\n\n* $ i \\lt j \\lt k $\n* $ \\forall x \\in \\left[1, k\\right] $，满足 $ S_i(x) = S_j(x) = S_k(x) $ 或 $ S_i(x) \\neq S_j(x) \\neq S_k(x) $\n\n例如 $ (1123, 1322, 1221) $ 便满足 $ 1, 3 $ 位均相同，$ 2,4 $ 位各不相同。\n\n给你这些序列，求可以组成多少种本质不同的 SET。", "inputFormat": "第一行为两个整数正整数 $ n, k $。\n\n接下来 $ n $ 行中每一行包含一个仅由 $ 1, 2, 3 $ 构成的长度为 $ k $ 的序列，代表着一张卡片。\n\n保证每张卡片上的序列不同。", "outputFormat": "仅一行一个整数，表示可以组成的本质不同的 SET 的数量。", "hint": "**【样例解释 \\#3】**\n\n可以组成的两个 SET 分别为 $ (S_1, S_2, S_3) $ 和  $ (S_1, S_4, S_5) $。\n\n**【数据范围】**\n\n对于全部数据，$1\\le k\\le 12$，$1\\le n\\le 3^k$，$S_i$ 互不相同，$1\\le S_i(x) \\le 3$。\n\n| Subtask |  特殊限制  | 分数 |\n| :-----: | :--------: | :--: |\n|   $1$   |  $k\\le 5$  | $10$ |\n|   $2$   |  $k\\le 7$  | $30$ |\n|   $3$   | 无特殊限制 | $70$ |\n\n#### 说明\n**本题总分 $110$ 分。**\n\n本题译自 [Croatian Open Competition in Informatics 2021/2022](https://hsin.hr/coci/archive/2021_2022) [Contest #1](https://hsin.hr/coci/archive/2021_2022/contest1_tasks.pdf) T4 Set。", "locale": "zh-CN"}}}
{"pid": "P7931", "type": "P", "difficulty": 6, "samples": [["3\n1 2 3", "1 3\n1 2 3"], ["4\n4 3 2 1", "4 1\n1\n2\n3\n4"], ["7\n2 1 6 5 7 3 4", "2 3\n1 3 5\n2 6 7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "Special Judge", "COCI（克罗地亚）"], "title": "[COCI 2021/2022 #1] Volontiranje", "background": "", "description": "给定一个 $1\\sim n$ 的排列 $p$，请从这里面取出尽可能多的不交的上升子序列，且他们的长度为原排列的 LIS 的长度，并构造一组方案。", "inputFormat": "第一行为一个整数 $n$。\n\n接下来一行 $n$ 个整数 $p_i$。", "outputFormat": "第一行请输出您选择的上升子序列个数与他们的长度。\n\n接下来若干行，一行若干个整数，表示某个上升子序列的每个元素的下标。\n\n您可以以任意顺序输出您选择的上升子序列。", "hint": "#### 数据范围\n\n对于全部数据，$1\\le n\\le 10^6$，$1\\le p_i\\le n$。\n\n| Subtask |  数据范围   | 分值 |\n| :-----: | :---------: | :--: |\n|   $1$   |  $n\\le 15$  | $10$ |\n|   $2$   | $n\\le 10^3$ | $40$ |\n|   $3$   | 无特殊限制  | $60$ |\n\n#### 说明\n**本题总分 $110$ 分。**\n\n本题译自 [Croatian Open Competition in Informatics 2021/2022](https://hsin.hr/coci/archive/2021_2022) [Contest #1](https://hsin.hr/coci/archive/2021_2022/contest1_tasks.pdf) T5 Volontiranje。\n\n在附加文件中下发了一份 checker.cpp。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2021/2022 #1] Volontiranje", "background": "", "description": "给定一个 $1\\sim n$ 的排列 $p$，请从这里面取出尽可能多的不交的上升子序列，且他们的长度为原排列的 LIS 的长度，并构造一组方案。", "inputFormat": "第一行为一个整数 $n$。\n\n接下来一行 $n$ 个整数 $p_i$。", "outputFormat": "第一行请输出您选择的上升子序列个数与他们的长度。\n\n接下来若干行，一行若干个整数，表示某个上升子序列的每个元素的下标。\n\n您可以以任意顺序输出您选择的上升子序列。", "hint": "#### 数据范围\n\n对于全部数据，$1\\le n\\le 10^6$，$1\\le p_i\\le n$。\n\n| Subtask |  数据范围   | 分值 |\n| :-----: | :---------: | :--: |\n|   $1$   |  $n\\le 15$  | $10$ |\n|   $2$   | $n\\le 10^3$ | $40$ |\n|   $3$   | 无特殊限制  | $60$ |\n\n#### 说明\n**本题总分 $110$ 分。**\n\n本题译自 [Croatian Open Competition in Informatics 2021/2022](https://hsin.hr/coci/archive/2021_2022) [Contest #1](https://hsin.hr/coci/archive/2021_2022/contest1_tasks.pdf) T5 Volontiranje。\n\n在附加文件中下发了一份 checker.cpp。", "locale": "zh-CN"}}}
{"pid": "P7933", "type": "P", "difficulty": 2, "samples": [["1", "0"], ["10", "5"], ["27", "18"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2007", "COCI（克罗地亚）"], "title": "[COCI 2007/2008 #5] PASCAL", "background": "", "description": "小 Frane 已经十年级了，但是在信息课上学习 Pascal 仍然很吃力。老师写下了如下的 Pascal 程序作为家庭作业，他需要根据输入的整数 $N$ 来判断程序的输出。\n\n```pascal\nreadln(N);\ncounter := 0;\nfor i := N-1 downto 1 do begin\n\tcounter := counter + 1;\n\tif N mod i = 0 then break;\nend;\nwriteln(counter); \n```\n\n请您编写一个程序来解决这个问题。", "inputFormat": "一行，一个整数 $N$。", "outputFormat": "一行，表示以上程序的输出结果。", "hint": "对于 $100\\%$ 的数据，$1\\le N\\le10^9$。\n\n本题分值按照原比赛设置，满分 $30$ 分。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2007/2008 #5] PASCAL", "background": "", "description": "小 Frane 已经十年级了，但是在信息课上学习 Pascal 仍然很吃力。老师写下了如下的 Pascal 程序作为家庭作业，他需要根据输入的整数 $N$ 来判断程序的输出。\n\n```pascal\nreadln(N);\ncounter := 0;\nfor i := N-1 downto 1 do begin\n\tcounter := counter + 1;\n\tif N mod i = 0 then break;\nend;\nwriteln(counter); \n```\n\n请您编写一个程序来解决这个问题。", "inputFormat": "一行，一个整数 $N$。", "outputFormat": "一行，表示以上程序的输出结果。", "hint": "对于 $100\\%$ 的数据，$1\\le N\\le10^9$。\n\n本题分值按照原比赛设置，满分 $30$ 分。", "locale": "zh-CN"}}}
{"pid": "P7934", "type": "P", "difficulty": 2, "samples": [["1 1\n5 1\n3 3\n4\n3 1\n3 2\n3 3\n3 4 ", "4.0\n3"], ["3 2\n5 4\n1 6\n3\n2 4\n3 5\n4 3 ", "6.0\n3"], ["2 6\n5 1\n7 8\n5\n1 4\n3 5\n6 4\n6 5\n4 7 ", "15.5\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768]}, "tags": ["2007", "COCI（克罗地亚）"], "title": "[COCI 2007/2008 #5] JABUKE", "background": "", "description": "给出一个三角形三个顶点的坐标以及 $N$ 个点的坐标，请您计算出这个三角形的面积和在这 $N$ 个点中，有多少个点在这个三角形内部（包含边界）。", "inputFormat": "前三行，每行两个整数，表示三角形一个顶点的坐标。\n\n接下来一行，一个整数 $N$。\n\n接下来 $N$ 行，每行两个整数 $x_i,y_i$，表示第 $i$ 个点的坐标。", "outputFormat": "第一行，一个实数，表示三角形的面积，保留一位小数。\n\n第二行，一个整数，表示在三角形内部和边界上的点数。", "hint": "对于 $100\\%$ 的数据，$1\\le N\\le100$，所有坐标的 $x,y$ 均为小于 $10^3$ 的正整数。\n\n**提示：以坐标 $(x_A,y_A)$，$(x_B,y_B)$ 与 $(x_C,y_C)$ 为顶点的三角形面积公式如下：**\n\n$\\dfrac{|x_A(y_B-y_C)+x_B(y_C-y_A)+x_C(y_A-y_B)|}{2}$\n\n本题分值按照原比赛设置，满分 $30$ 分。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2007/2008 #5] JABUKE", "background": "", "description": "给出一个三角形三个顶点的坐标以及 $N$ 个点的坐标，请您计算出这个三角形的面积和在这 $N$ 个点中，有多少个点在这个三角形内部（包含边界）。", "inputFormat": "前三行，每行两个整数，表示三角形一个顶点的坐标。\n\n接下来一行，一个整数 $N$。\n\n接下来 $N$ 行，每行两个整数 $x_i,y_i$，表示第 $i$ 个点的坐标。", "outputFormat": "第一行，一个实数，表示三角形的面积，保留一位小数。\n\n第二行，一个整数，表示在三角形内部和边界上的点数。", "hint": "对于 $100\\%$ 的数据，$1\\le N\\le100$，所有坐标的 $x,y$ 均为小于 $10^3$ 的正整数。\n\n**提示：以坐标 $(x_A,y_A)$，$(x_B,y_B)$ 与 $(x_C,y_C)$ 为顶点的三角形面积公式如下：**\n\n$\\dfrac{|x_A(y_B-y_C)+x_B(y_C-y_A)+x_C(y_A-y_B)|}{2}$\n\n本题分值按照原比赛设置，满分 $30$ 分。", "locale": "zh-CN"}}}
{"pid": "P7935", "type": "P", "difficulty": 3, "samples": [["7\n5 4 3 2 1 6 7\n5 5 1 1 3 4 7\n3 7 1 4 5 6 2 ", "4"], ["9\n1 3 5 9 8 6 2 4 7\n2 1 5 6 4 9 3 4 7\n3 5 1 9 8 6 2 8 7", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["模拟", "2007", "枚举", "队列", "COCI（克罗地亚）"], "title": "[COCI 2007/2008 #5] AVOGADRO", "background": "", "description": "Luka 画了一张 $3$ 行 $N$ 列的表格，然后将整数 $1$ 到 $N$ 写进表格。对于表格第一行，每个整数只出现一次。对于其余两行，每个数字可以出现任意次或者不出现。\n\nLuka 现在可以删去任意一些列。完成后，他对这个表的每一行进行升序排序。\n\n他希望得到一张表，使得表中的三行在升序排序后完全相同。请您求出他至少需要删去多少列。", "inputFormat": "第一行，一个整数 $N$，表示表中数字的列数。\n\n接下来三行，每行包含 $N$ 个整数。这些整数都在 $1$ 到 $N$ 之间，第一行每个数字有且仅出现一次。", "outputFormat": "一行，一个整数，表示 Luka 至少需要删除的列数。", "hint": "对于 $40\\%$ 的测试点，$N\\le 100$。\n\n对于 $70\\%$ 的测试点，$N\\le 10000$。\n\n对于 $100\\%$ 的测试点，$1\\le N\\le 10^5$。\n\n### 样例 1 解释：\n\n对于样例 1，Luka 需要删除第二、第四、第六和第七列。删除并排序后，这三行都只包含 $1,3,5$ 三个整数。\n\n本题分值按照原比赛设置，满分 $60$ 分。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2007/2008 #5] AVOGADRO", "background": "", "description": "Luka 画了一张 $3$ 行 $N$ 列的表格，然后将整数 $1$ 到 $N$ 写进表格。对于表格第一行，每个整数只出现一次。对于其余两行，每个数字可以出现任意次或者不出现。\n\nLuka 现在可以删去任意一些列。完成后，他对这个表的每一行进行升序排序。\n\n他希望得到一张表，使得表中的三行在升序排序后完全相同。请您求出他至少需要删去多少列。", "inputFormat": "第一行，一个整数 $N$，表示表中数字的列数。\n\n接下来三行，每行包含 $N$ 个整数。这些整数都在 $1$ 到 $N$ 之间，第一行每个数字有且仅出现一次。", "outputFormat": "一行，一个整数，表示 Luka 至少需要删除的列数。", "hint": "对于 $40\\%$ 的测试点，$N\\le 100$。\n\n对于 $70\\%$ 的测试点，$N\\le 10000$。\n\n对于 $100\\%$ 的测试点，$1\\le N\\le 10^5$。\n\n### 样例 1 解释：\n\n对于样例 1，Luka 需要删除第二、第四、第六和第七列。删除并排序后，这三行都只包含 $1,3,5$ 三个整数。\n\n本题分值按照原比赛设置，满分 $60$ 分。", "locale": "zh-CN"}}}
{"pid": "P7936", "type": "P", "difficulty": 4, "samples": [["6 5\n1 1 5\n2 1 5\n1 2 4\n2 3 5\n3 2 30\n3 3 5 ", "5\n4\n1 1\n2 1\n2 3\n3 3 "], ["8 10\n1 1 15\n2 2 30\n1 2 8\n2 1 7\n3 2 8\n2 3 7\n4 2 100\n3 3 15", "36\n5\n1 1\n1 2\n2 2\n3 2\n3 3"], ["9 5\n5 5 10\n6 5 2\n7 5 1\n5 6 2\n6 6 6\n7 6 2\n5 7 1\n6 7 2\n7 7 1 ", "2\n3\n5 5\n7 5\n7 7 "]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2007", "COCI（克罗地亚）"], "title": "[COCI 2007/2008 #5] BARICA", "background": "", "description": "Barica 是一只非同寻常的青蛙。她住在一个池塘里，有 $N$ 片漂浮在水面上的荷叶。这些荷叶的编号为 $1$ 到 $N$，位置可以用一对坐标表示。Barica 可以在这些荷叶上跳来跳去，但是她害怕斜着跳和朝负方向跳。\n\n准确的说，她可以从坐标 $(x_1,y_1)$ 跳到另一个坐标 $(x_2,y_2)$ 仅当：\n\n- $x_2>x_1$ 且 $y_2=y_1$ 或者\n\n- $y_2>y_1$ 且 $x_2=x_1$。\n\n对于每一片荷叶，我们知道其附近的苍蝇数量。Barika 可以吃掉所有在她荷叶附近的苍蝇。\n\nBarica 每吃一只苍蝇会获得 $1$ 个单位的能量，每进行一次跳跃消耗 $K$ 个单位的能量。如果 Barica 没有足够的能量，她就不能进行跳跃。\n\nBarica 想通过 $1$ 号植物到达 $N$ 号植物，并获得尽可能多的能量。Barica 开始时没有能量，必须通过吃掉 $1$ 号植物附近的苍蝇来获取能量。\n\n找到使得 Barica 达到目标的一种可行路径。", "inputFormat": "第一行，两个整数 $N$ 和 $K$。\n\n接下来 $N$ 行，每行包含三个整数 $x_i$，$y_i$ 和 $z_i$，表示第 $i$ 号荷叶的坐标为 $(x_i,y_i)$，且其附近有 $z_i$ 只苍蝇。", "outputFormat": "第一行，输出到达终点后能量单位数量。\n\n第二行，输出一个整数 $L$，表示 Barica 需要经过的植物个数。必须包含 $1$ 号和 $N$ 号植物。\n\n接下来 $L$ 行，依次输出 Barica 需要经过的植物坐标。", "hint": "对于 $100\\%$ 的数据，$2\\le N\\le 3\\times 10^5$，$1\\le K\\le 1000$，$0\\le x_i,y_i\\le 10^5$，$0\\le z_i\\le 1000$。\n\n输入数据保证有解，但不保证有唯一解。\n\n本题分值按照原比赛设置，满分 $70$ 分。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2007/2008 #5] BARICA", "background": "", "description": "Barica 是一只非同寻常的青蛙。她住在一个池塘里，有 $N$ 片漂浮在水面上的荷叶。这些荷叶的编号为 $1$ 到 $N$，位置可以用一对坐标表示。Barica 可以在这些荷叶上跳来跳去，但是她害怕斜着跳和朝负方向跳。\n\n准确的说，她可以从坐标 $(x_1,y_1)$ 跳到另一个坐标 $(x_2,y_2)$ 仅当：\n\n- $x_2>x_1$ 且 $y_2=y_1$ 或者\n\n- $y_2>y_1$ 且 $x_2=x_1$。\n\n对于每一片荷叶，我们知道其附近的苍蝇数量。Barika 可以吃掉所有在她荷叶附近的苍蝇。\n\nBarica 每吃一只苍蝇会获得 $1$ 个单位的能量，每进行一次跳跃消耗 $K$ 个单位的能量。如果 Barica 没有足够的能量，她就不能进行跳跃。\n\nBarica 想通过 $1$ 号植物到达 $N$ 号植物，并获得尽可能多的能量。Barica 开始时没有能量，必须通过吃掉 $1$ 号植物附近的苍蝇来获取能量。\n\n找到使得 Barica 达到目标的一种可行路径。", "inputFormat": "第一行，两个整数 $N$ 和 $K$。\n\n接下来 $N$ 行，每行包含三个整数 $x_i$，$y_i$ 和 $z_i$，表示第 $i$ 号荷叶的坐标为 $(x_i,y_i)$，且其附近有 $z_i$ 只苍蝇。", "outputFormat": "第一行，输出到达终点后能量单位数量。\n\n第二行，输出一个整数 $L$，表示 Barica 需要经过的植物个数。必须包含 $1$ 号和 $N$ 号植物。\n\n接下来 $L$ 行，依次输出 Barica 需要经过的植物坐标。", "hint": "对于 $100\\%$ 的数据，$2\\le N\\le 3\\times 10^5$，$1\\le K\\le 1000$，$0\\le x_i,y_i\\le 10^5$，$0\\le z_i\\le 1000$。\n\n输入数据保证有解，但不保证有唯一解。\n\n本题分值按照原比赛设置，满分 $70$ 分。", "locale": "zh-CN"}}}
{"pid": "P7937", "type": "P", "difficulty": 5, "samples": [["5\nhobotnica\nrobot\nhobi\nhobit\nrobi\n4\nrobi\nhobi\nhobit\nrakija ", "12\n10\n16\n7 "], ["8\nmajmunica\nmajmun\nmajka\nmalina\nmalinska\nmalo\nmaleni\nmalesnica\n3\nkrampus\nmalnar\nmajmun ", "8\n29\n14"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2007", "COCI（克罗地亚）"], "title": "[COCI 2007/2008 #5] BAZA", "background": "", "description": "定义两个字符串的公共前缀为这两个字符串从开头开始的公共子串。比如，字符串 `identity` 和字符串 `idealistic` 的公共前缀为 `ide`。\n\n有一个数据库包含了 $N$ 个字符串。\n\n在这个数据库中查询字符串 $W$ 使用的算法很原始，它将 $W$ 与数据库中的字符串一一比较。两个字符串的字符也一一比对，直到找到一个不匹配的字符或者其中一个字符串的结尾，然后进行最后一次比较确定两个字符串长度是否相等。当在数据库中找到 $W$ 时，算法结束。\n\n分析这个算法，我们发现，在数据库中找到 $W$ 所用的步骤数等于与 $W$ 进行比较的字符串数量，加上 $W$ 与所有进行比较的字符串的公共前缀之和。\n\n共有 $Q$ 个需查询的字符串。\n\n写出一个程序，计算对于每一个字符串，程序需要多少步才能在数据库中找到这个词。\n\n**请留意本题非同寻常的内存限制。**", "inputFormat": "第一行，一个整数 $N$，表示数据库中字符串的个数。\n\n接下来 $N$ 行，每行一个数据库中的字符串，这些字符串按照算法的查询顺序给出，互不相同。\n\n接下来一行，一个整数 $Q$，表示需查询的字符串数。\n\n接下来 $Q$ 行，每行一个需查询的字符串。", "outputFormat": "对于每个查询字符串，输出一行，一个整数，表示程序在数据库中找到这个词所需的步数。", "hint": "对于 $100\\%$ 的数据，$1\\le N,Q\\le 3\\times 10^4$，所有字符串长度 $<30$，且只包含小写字母。\n\n### 样例 2 解释：\n\n对于样例 2，搜索字符串 `krampus` 所用的步数为 $8$，我们只需要将数据库里每一个字符串的第一个字符与此字符串比较即可。\n\n搜索字符串 `malnar` 时，前三个字符串每个字符串需要比较三次，剩下五个字符串每个字符串则需要比较四次，所以总共需要 $29$ 次比较。\n\n为了找到 `majmun` 字符串，我们总共需要 $14$ 次比较。对于第一个单词，我们进行了六次成功的比较，但最后一次比较确定了字符串 `majmunica` 比 `majmun` 长。对于第二个字符串，我们也进行了六次成功的比较，在最后一次比较中我们发现两个字符串长度相等，算法结束。\n\n本题分值按照原比赛设置，满分 $90$ 分。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2007/2008 #5] BAZA", "background": "", "description": "定义两个字符串的公共前缀为这两个字符串从开头开始的公共子串。比如，字符串 `identity` 和字符串 `idealistic` 的公共前缀为 `ide`。\n\n有一个数据库包含了 $N$ 个字符串。\n\n在这个数据库中查询字符串 $W$ 使用的算法很原始，它将 $W$ 与数据库中的字符串一一比较。两个字符串的字符也一一比对，直到找到一个不匹配的字符或者其中一个字符串的结尾，然后进行最后一次比较确定两个字符串长度是否相等。当在数据库中找到 $W$ 时，算法结束。\n\n分析这个算法，我们发现，在数据库中找到 $W$ 所用的步骤数等于与 $W$ 进行比较的字符串数量，加上 $W$ 与所有进行比较的字符串的公共前缀之和。\n\n共有 $Q$ 个需查询的字符串。\n\n写出一个程序，计算对于每一个字符串，程序需要多少步才能在数据库中找到这个词。\n\n**请留意本题非同寻常的内存限制。**", "inputFormat": "第一行，一个整数 $N$，表示数据库中字符串的个数。\n\n接下来 $N$ 行，每行一个数据库中的字符串，这些字符串按照算法的查询顺序给出，互不相同。\n\n接下来一行，一个整数 $Q$，表示需查询的字符串数。\n\n接下来 $Q$ 行，每行一个需查询的字符串。", "outputFormat": "对于每个查询字符串，输出一行，一个整数，表示程序在数据库中找到这个词所需的步数。", "hint": "对于 $100\\%$ 的数据，$1\\le N,Q\\le 3\\times 10^4$，所有字符串长度 $<30$，且只包含小写字母。\n\n### 样例 2 解释：\n\n对于样例 2，搜索字符串 `krampus` 所用的步数为 $8$，我们只需要将数据库里每一个字符串的第一个字符与此字符串比较即可。\n\n搜索字符串 `malnar` 时，前三个字符串每个字符串需要比较三次，剩下五个字符串每个字符串则需要比较四次，所以总共需要 $29$ 次比较。\n\n为了找到 `majmun` 字符串，我们总共需要 $14$ 次比较。对于第一个单词，我们进行了六次成功的比较，但最后一次比较确定了字符串 `majmunica` 比 `majmun` 长。对于第二个字符串，我们也进行了六次成功的比较，在最后一次比较中我们发现两个字符串长度相等，算法结束。\n\n本题分值按照原比赛设置，满分 $90$ 分。", "locale": "zh-CN"}}}
{"pid": "P7938", "type": "P", "difficulty": 2, "samples": [["2\n2 1\n()\n2 99\n()", "1\n0"]], "limits": {"time": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化"], "title": "「Wdcfr-1」Beautiful Array", "background": "", "description": "In this problem, we define a sequence of `(` and `)` as a \"bracket sequence\".\n\nThe definition of *Regular Bracket Sequence* is as follows:\n\n1. `()` is a Regular Bracket Sequence.\n1. If `A` is a Regular Bracket Sequence, then `(A)` is also a Regular Bracket Sequence.\n1. If `A` and `B` are Regular Bracket Sequences, then `AB` is also a Regular Bracket Sequence.\n\nFor example: `()`, `(())`, and `()()` are all Regular Bracket Sequences, but `)(`, `()(` are not.\n\nIn particular, an empty sequence is **not** a Regular Bracket Sequence sequence in this problem.\n\nNow ~~cute~~ Ran gives you a bracket sequence $s$ of length $n$. She wants you to construct $2\\cdot m$ **strictly increasing** arrays. Let us denote them as\n $p_1,p_2,\\cdots,p_{2 m}$ (you can leave any of them empty). You need to ensure that all integers between $1\\sim n$ appear **exactly once** in these arrays. \n \nAn array $p_i=\\{r_1,r_2,\\cdots,r_k\\}$ is *Beautiful* if    $\\{s_{r_1},s_{r_2},\\cdots,s_{r_k}\\}$ is a Regular Bracket Sequence.\n\nRan wonders whether it is possible to construct these arrays so that at least $m$ of the $2\\cdot m$ arrays are \"beautiful arrays\". ", "inputFormat": "Each test contains multiple test cases.\n\nThe first line contains an integer $T$, the number of test cases.\n\nFor each test case, the first line contains two integers $n$ and $m$, and the second line contains a bracket sequence $s$.", "outputFormat": "For each test case, print one line.\n\nIf it is possible to construct these arrays, print $1$. Otherwise print $0$.", "hint": "### Explanation\n\nFor the first test case, we can construct $p_1=\\{1,2\\}$ and $ p_2=\\{\\}$. So $p_1$ is a \"beautiful array\".\n\nFor the second test case, it is obvious that we cannot use two numbers to construct $99$ beautiful arrays.\n\n### Constraints\n\n$1\\le T,n,m\\le 200$.", "locale": "en", "translations": {"en": {"title": "「Wdcfr-1」Beautiful Array", "background": "", "description": "In this problem, we define a sequence of `(` and `)` as a \"bracket sequence\".\n\nThe definition of *Regular Bracket Sequence* is as follows:\n\n1. `()` is a Regular Bracket Sequence.\n1. If `A` is a Regular Bracket Sequence, then `(A)` is also a Regular Bracket Sequence.\n1. If `A` and `B` are Regular Bracket Sequences, then `AB` is also a Regular Bracket Sequence.\n\nFor example: `()`, `(())`, and `()()` are all Regular Bracket Sequences, but `)(`, `()(` are not.\n\nIn particular, an empty sequence is **not** a Regular Bracket Sequence sequence in this problem.\n\nNow ~~cute~~ Ran gives you a bracket sequence $s$ of length $n$. She wants you to construct $2\\cdot m$ **strictly increasing** arrays. Let us denote them as\n $p_1,p_2,\\cdots,p_{2 m}$ (you can leave any of them empty). You need to ensure that all integers between $1\\sim n$ appear **exactly once** in these arrays. \n \nAn array $p_i=\\{r_1,r_2,\\cdots,r_k\\}$ is *Beautiful* if    $\\{s_{r_1},s_{r_2},\\cdots,s_{r_k}\\}$ is a Regular Bracket Sequence.\n\nRan wonders whether it is possible to construct these arrays so that at least $m$ of the $2\\cdot m$ arrays are \"beautiful arrays\". ", "inputFormat": "Each test contains multiple test cases.\n\nThe first line contains an integer $T$, the number of test cases.\n\nFor each test case, the first line contains two integers $n$ and $m$, and the second line contains a bracket sequence $s$.", "outputFormat": "For each test case, print one line.\n\nIf it is possible to construct these arrays, print $1$. Otherwise print $0$.", "hint": "### Explanation\n\nFor the first test case, we can construct $p_1=\\{1,2\\}$ and $ p_2=\\{\\}$. So $p_1$ is a \"beautiful array\".\n\nFor the second test case, it is obvious that we cannot use two numbers to construct $99$ beautiful arrays.\n\n### Constraints\n\n$1\\le T,n,m\\le 200$.", "locale": "en"}, "zh-CN": {"title": "「Wdcfr-1」Beautiful Array", "background": null, "description": "在这个问题中，我们将由 `(` 和 `)` 组成的序列定义为“括号序列”。\n\n*正规括号序列* 的定义如下：\n\n1. `()` 是一个正规括号序列。\n2. 如果 `A` 是一个正规括号序列，那么 `(A)` 也是一个正规括号序列。\n3. 如果 `A` 和 `B` 是正规括号序列，那么 `AB` 也是一个正规括号序列。\n\n例如：`()`, `(())` 和 `()()` 都是正规括号序列，但 `)(`, `()(` 不是。\n\n特别地，在这个问题中，空序列**不是**一个正规括号序列。\n\n现在，~~可爱的~~ Ran 给你一个长度为 $n$ 的括号序列 $s$。她希望你构造 $2 \\cdot m$ 个**严格递增**的数组。我们将它们记作 $p_1,p_2,\\cdots,p_{2m}$（你可以将其中任何一个留空）。你需要确保所有从 $1\\sim n$ 的整数在这些数组中**恰好出现一次**。\n\n一个数组 $p_i=\\{r_1,r_2,\\cdots,r_k\\}$ 是*美丽的*，如果 $\\{s_{r_1},s_{r_2},\\cdots,s_{r_k}\\}$ 是一个正规括号序列。\n\nRan 想知道是否有可能构造这些数组，使得 $2 \\cdot m$ 个数组中至少 $m$ 个是“美丽数组”。", "inputFormat": "每个测试包含多个测试用例。\n\n第一行包含一个整数 $T$，表示测试用例的数量。\n\n对于每个测试用例，第一行包含两个整数 $n$ 和 $m$，第二行包含一个括号序列 $s$。", "outputFormat": "对于每个测试用例，输出一行。\n\n如果可以构造这些数组，输出 $1$。否则输出 $0$。", "hint": "### 解释\n\n对于第一个测试用例，我们可以构造 $p_1=\\{1,2\\}$ 和 $p_2=\\{\\}$。所以 $p_1$ 是一个“美丽数组”。\n\n对于第二个测试用例，很明显我们不能用两个数字构造 $99$ 个美丽数组。\n\n### 约束\n\n$1\\le T,n,m\\le 200$。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P7939", "type": "P", "difficulty": 2, "samples": [["2\n1\n1 2\n1 2\n2\n2 3 1 3\n1 2 2 1", "2\n1 1\n2 2\n4\n3 1 1 3\n1 2 2 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["Special Judge", "O2优化"], "title": "「Wdcfr-1」Alice Wins!  (easy version)", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/zshuq5iq.png)\n", "description": "**The difference between the versions is the limit of operations.**\n\nAlice is a cute girl who has a lot of dolls.\n\nThere are $4\\cdot n$ dolls playing *rock-paper-scissors*. They are divided into two teams: Team A and Team B. Each team contains $2\\cdot n$ dolls.\n\nA total of $2\\cdot n$ rounds of the game will be played. In the $i$-th round, the $i$-th doll in Team A will play against the $i$-th doll in Team B. If the doll in Team A wins, Team A will get $1$ point. If it loses, Team A will lose $1$ point. If it ties, Team A will not get points.\n\nAlice knows all the dolls' choices in this game. To be precise, she uses two arrays $a$ and $b$ to represent the choices of the dolls in the two teams. $a_i$ means the choice of the $i$-th doll in Team A, and $b_i$ means the choice of the $i$-th doll in Team B. In this question, we use $1$ for rock, $2$ for scissors, and $3$ for paper.\n\nNow for **each team**, Alice wants to change the choices of **at most** $n$ dolls to make the score of Team A as high as possible.\n\nFind the maximum score of Team A and its construction method. If there are multiple answers print any of them (you still have to maximize the score of Team A).", "inputFormat": "Each test contains multiple testcases. The first line contains an integer $T$, the number of test cases.\n\nFor each test case, the first line contains one integer $n$.\n\nThen two lines follow, containing an array $a$ of length $2\\cdot n$ and an array $b$ of length $2\\cdot n$, respectively.", "outputFormat": "For each test case, print three lines.\n\nThe first line contains one integer, the maximum score of Team A.\n\nThe second line contains an array $a'$ of length $2\\cdot n$, which represents the $a$ array after Alice's modification. For integers $1$ to $2\\cdot n$, if $a_i \\ne a'_i$, then it means you have modified the choice of one player in Team A.\n\nThe third line contains an array $b'$ of length $2\\cdot n$, which represents the $b$ array after Alice's modification. For integers $1$ to $2\\cdot n$, if $b_i \\ne b'_i$, then it means you have modified the choice of one player in Team B.", "hint": "### Explanation\n\nFor the first test case, we can change $a_2$ to $1$ and $b_1$ to $2$. Then Team A can get $2$ points. It can be proved that this is the maximum score that Team A can get.\n\nFor the second test case, we can change $a_1$ to $3$ and $a_2$ to $1$.\n\n### Constraints\n\n$1\\le T,n \\le 10^5;\\ 1\\le a_i,b_i \\le 3$. The sum of $n$ over all test cases  $\\le 10^5$.", "locale": "en", "translations": {"en": {"title": "「Wdcfr-1」Alice Wins!  (easy version)", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/zshuq5iq.png)\n", "description": "**The difference between the versions is the limit of operations.**\n\nAlice is a cute girl who has a lot of dolls.\n\nThere are $4\\cdot n$ dolls playing *rock-paper-scissors*. They are divided into two teams: Team A and Team B. Each team contains $2\\cdot n$ dolls.\n\nA total of $2\\cdot n$ rounds of the game will be played. In the $i$-th round, the $i$-th doll in Team A will play against the $i$-th doll in Team B. If the doll in Team A wins, Team A will get $1$ point. If it loses, Team A will lose $1$ point. If it ties, Team A will not get points.\n\nAlice knows all the dolls' choices in this game. To be precise, she uses two arrays $a$ and $b$ to represent the choices of the dolls in the two teams. $a_i$ means the choice of the $i$-th doll in Team A, and $b_i$ means the choice of the $i$-th doll in Team B. In this question, we use $1$ for rock, $2$ for scissors, and $3$ for paper.\n\nNow for **each team**, Alice wants to change the choices of **at most** $n$ dolls to make the score of Team A as high as possible.\n\nFind the maximum score of Team A and its construction method. If there are multiple answers print any of them (you still have to maximize the score of Team A).", "inputFormat": "Each test contains multiple testcases. The first line contains an integer $T$, the number of test cases.\n\nFor each test case, the first line contains one integer $n$.\n\nThen two lines follow, containing an array $a$ of length $2\\cdot n$ and an array $b$ of length $2\\cdot n$, respectively.", "outputFormat": "For each test case, print three lines.\n\nThe first line contains one integer, the maximum score of Team A.\n\nThe second line contains an array $a'$ of length $2\\cdot n$, which represents the $a$ array after Alice's modification. For integers $1$ to $2\\cdot n$, if $a_i \\ne a'_i$, then it means you have modified the choice of one player in Team A.\n\nThe third line contains an array $b'$ of length $2\\cdot n$, which represents the $b$ array after Alice's modification. For integers $1$ to $2\\cdot n$, if $b_i \\ne b'_i$, then it means you have modified the choice of one player in Team B.", "hint": "### Explanation\n\nFor the first test case, we can change $a_2$ to $1$ and $b_1$ to $2$. Then Team A can get $2$ points. It can be proved that this is the maximum score that Team A can get.\n\nFor the second test case, we can change $a_1$ to $3$ and $a_2$ to $1$.\n\n### Constraints\n\n$1\\le T,n \\le 10^5;\\ 1\\le a_i,b_i \\le 3$. The sum of $n$ over all test cases  $\\le 10^5$.", "locale": "en"}, "zh-CN": {"title": "「Wdcfr-1」Alice Wins!  (easy version)", "background": null, "description": "**版本之间的区别在于操作的限制。**\n\nAlice 是一个可爱的女孩，她有很多玩偶。\n\n有 $4 \\cdot n$ 个玩偶在玩“石头剪刀布”。他们被分成两个队伍：A 队和 B 队。每个队伍包含 $2 \\cdot n$ 个玩偶。\n\n总共会进行 $2 \\cdot n$ 轮比赛。在第 $i$ 轮中，A 队的第 $i$ 个玩偶将与 B 队的第 $i$ 个玩偶对战。如果 A 队的玩偶赢了，A 队将获得 $1$ 分。如果输了，A 队将失去 $1$ 分。如果打平，A 队将不获得分数。\n\nAlice 知道所有玩偶在这场比赛中的选择。具体来说，她用两个数组 $a$ 和 $b$ 来表示两个队伍中玩偶的选择。$a_i$ 表示 A 队第 $i$ 个玩偶的选择，$b_i$ 表示 B 队第 $i$ 个玩偶的选择。在这个问题中，我们用 $1$ 表示石头，$2$ 表示剪刀，$3$ 表示布。\n\n现在对于**每个队伍**，Alice 想要改变**最多** $n$ 个玩偶的选择，以使 A 队的得分尽可能高。\n\n找出 A 队的最大得分及其构造方法。如果有多个答案，输出任意一个（你仍然需要最大化 A 队的得分）。", "inputFormat": "每个测试包含多个测试用例。第一行包含一个整数 $T$，表示测试用例的数量。\n\n对于每个测试用例，第一行包含一个整数 $n$。\n\n接下来是两行，分别包含长度为 $2 \\cdot n$ 的数组 $a$ 和数组 $b$。", "outputFormat": "对于每个测试用例，输出三行。\n\n第一行包含一个整数，表示 A 队的最大得分。\n\n第二行包含一个长度为 $2 \\cdot n$ 的数组 $a'$，表示 Alice 修改后的 $a$ 数组。对于整数 $1$ 到 $2 \\cdot n$，如果 $a_i \\ne a'_i$，则表示你已经修改了 A 队中一个玩家的选择。\n\n第三行包含一个长度为 $2 \\cdot n$ 的数组 $b'$，表示 Alice 修改后的 $b$ 数组。对于整数 $1$ 到 $2 \\cdot n$，如果 $b_i \\ne b'_i$，则表示你已经修改了 B 队中一个玩家的选择。", "hint": "### 解释\n\n对于第一个测试用例，我们可以将 $a_2$ 改为 $1$，将 $b_1$ 改为 $2$。然后 A 队可以得到 $2$ 分。可以证明这是 A 队可以获得的最大分数。\n\n对于第二个测试用例，我们可以将 $a_1$ 改为 $3$，将 $a_2$ 改为 $1$。\n\n### 约束\n\n$1\\le T,n \\le 10^5; 1\\le a_i,b_i \\le 3$。所有测试用例中 $n$ 的总和 $\\le 10^5$。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P7940", "type": "P", "difficulty": 3, "samples": [["1\n1\n1 2\n1 2", "2\n1 1\n2 2"]], "limits": {"time": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["贪心", "Special Judge", "O2优化", "构造"], "title": "「Wdcfr-1」Alice Wins! (hard version)", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/zshuq5iq.png)", "description": "**The difference between the versions is the limit of operations.**\n\nAlice is a cute girl who has a lot of dolls.\n\nThere are $4\\cdot n$ dolls playing *rock-paper-scissors*. They are divided into two teams: Team A and Team B. Each team contains $2\\cdot n$ dolls.\n\nA total of $2\\cdot n$ rounds of the game will be played. In the $i$-th round, the $i$-th doll in Team A will play against the $i$-th doll in Team B. If the doll in Team A wins, Team A will get $1$ point. If it loses, Team A will lose $1$ point. If it ties, Team A will not get points.\n\nAlice knows all the dolls' choices in this game. To be precise, she uses two arrays $a$ and $b$ to represent the choices of the dolls in the two teams. $a_i$ means the choice of the $i$-th doll in Team A, and $b_i$ means the choice of the $i$-th doll in Team B. In this question, we use $1$ for rock, $2$ for scissors, and $3$ for paper.\n\nNow for **each team**, Alice wants to change the choices of **exact** $n$ dolls to make the score of Team A as high as possible.\n\nFind the maximum score of Team A and its construction method. If there are multiple answers print any of them (you still have to maximize the score of Team A).", "inputFormat": "Each test contains multiple testcases. The first line contains an integer $T$, the number of test cases.\n\nFor each test case, the first line contains one integer $n$.\n\nThen two lines follow, containing an array $a$ of length $2\\cdot n$ and an array $b$ of length $2\\cdot n$, respectively.", "outputFormat": "For each test case, output three lines.\n\nThe first line contains one integer, which is the maximize the score of Team A.\n\nThe second line contains an array $a'$ of length $2\\cdot n$, which represents the modified $a$ array. For integers $1$ to $2\\cdot n$, if $a_i \\ne a'_i$, then it means you have modified the hand shape of one player in Team A.\n\nThe third line contains an array $b'$ of length $2\\cdot n$, which represents the modified $b$ array. For integers $1$ to $2\\cdot n$, if $b_i \\ne b'_i$, then it means you have modified the hand shape of one player in Team B.", "hint": "### Explanation\n\nFor the first test case, we can change $a_2$ to $1$ and $b_1$ to $2$. Then Team A can get $2$ points. It can be proved that this is the maximum score that Team A can get.\n\n### Constraints\n\n$1\\le T,n \\le 10^5;\\ 1\\le a_i,b_i \\le 3$. The sum of $n$ of all test cases $\\le 10^5$.", "locale": "en", "translations": {"en": {"title": "「Wdcfr-1」Alice Wins! (hard version)", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/zshuq5iq.png)", "description": "**The difference between the versions is the limit of operations.**\n\nAlice is a cute girl who has a lot of dolls.\n\nThere are $4\\cdot n$ dolls playing *rock-paper-scissors*. They are divided into two teams: Team A and Team B. Each team contains $2\\cdot n$ dolls.\n\nA total of $2\\cdot n$ rounds of the game will be played. In the $i$-th round, the $i$-th doll in Team A will play against the $i$-th doll in Team B. If the doll in Team A wins, Team A will get $1$ point. If it loses, Team A will lose $1$ point. If it ties, Team A will not get points.\n\nAlice knows all the dolls' choices in this game. To be precise, she uses two arrays $a$ and $b$ to represent the choices of the dolls in the two teams. $a_i$ means the choice of the $i$-th doll in Team A, and $b_i$ means the choice of the $i$-th doll in Team B. In this question, we use $1$ for rock, $2$ for scissors, and $3$ for paper.\n\nNow for **each team**, Alice wants to change the choices of **exact** $n$ dolls to make the score of Team A as high as possible.\n\nFind the maximum score of Team A and its construction method. If there are multiple answers print any of them (you still have to maximize the score of Team A).", "inputFormat": "Each test contains multiple testcases. The first line contains an integer $T$, the number of test cases.\n\nFor each test case, the first line contains one integer $n$.\n\nThen two lines follow, containing an array $a$ of length $2\\cdot n$ and an array $b$ of length $2\\cdot n$, respectively.", "outputFormat": "For each test case, output three lines.\n\nThe first line contains one integer, which is the maximize the score of Team A.\n\nThe second line contains an array $a'$ of length $2\\cdot n$, which represents the modified $a$ array. For integers $1$ to $2\\cdot n$, if $a_i \\ne a'_i$, then it means you have modified the hand shape of one player in Team A.\n\nThe third line contains an array $b'$ of length $2\\cdot n$, which represents the modified $b$ array. For integers $1$ to $2\\cdot n$, if $b_i \\ne b'_i$, then it means you have modified the hand shape of one player in Team B.", "hint": "### Explanation\n\nFor the first test case, we can change $a_2$ to $1$ and $b_1$ to $2$. Then Team A can get $2$ points. It can be proved that this is the maximum score that Team A can get.\n\n### Constraints\n\n$1\\le T,n \\le 10^5;\\ 1\\le a_i,b_i \\le 3$. The sum of $n$ of all test cases $\\le 10^5$.", "locale": "en"}, "zh-CN": {"title": "「Wdcfr-1」Alice Wins! (hard version)", "background": null, "description": "**版本之间的区别在于操作的限制。**\n\nAlice 是一个可爱的女孩，她有很多玩偶。\n\n有 $4\\cdot n$ 个玩偶在玩“石头剪刀布”。它们被分成两个队伍：A 队和 B 队。每个队伍包含 $2\\cdot n$ 个玩偶。\n\n游戏将进行总共 $2\\cdot n$ 轮。在第 $i$ 轮中，A 队的第 $i$ 个玩偶将与 B 队的第 $i$ 个玩偶对战。如果 A 队的玩偶赢了，A 队将获得 $1$ 分。如果输了，A 队将失去 $1$ 分。如果平局，A 队将不获得分数。\n\nAlice 知道所有玩偶在这场游戏中的选择。具体来说，她使用两个数组 $a$ 和 $b$ 来表示两个队伍中玩偶的选择。$a_i$ 表示 A 队第 $i$ 个玩偶的选择，$b_i$ 表示 B 队第 $i$ 个玩偶的选择。在这个问题中，我们用 $1$ 表示石头，$2$ 表示剪刀，$3$ 表示布。\n\n现在对于**每个队伍**，Alice 想要改变**恰好** $n$ 个玩偶的选择，以使 A 队的得分尽可能高。\n\n找出 A 队的最大得分及其构造方法。如果有多个答案，输出任意一个（你仍然需要最大化 A 队的得分）。", "inputFormat": "每个测试包含多个测试用例。第一行包含一个整数 $T$，表示测试用例的数量。\n\n对于每个测试用例，第一行包含一个整数 $n$。\n\n接下来两行，分别包含长度为 $2\\cdot n$ 的数组 $a$ 和数组 $b$。", "outputFormat": "对于每个测试用例，输出三行。\n\n第一行包含一个整数，表示 A 队的最大得分。\n\n第二行包含长度为 $2\\cdot n$ 的数组 $a'$，表示修改后的 $a$ 数组。对于整数 $1$ 到 $2\\cdot n$，如果 $a_i \\ne a'_i$，则表示你已经修改了 A 队中一个玩家的手势。\n\n第三行包含长度为 $2\\cdot n$ 的数组 $b'$，表示修改后的 $b$ 数组。对于整数 $1$ 到 $2\\cdot n$，如果 $b_i \\ne b'_i$，则表示你已经修改了 B 队中一个玩家的手势。", "hint": "### 解释\n\n对于第一个测试用例，我们可以将 $a_2$ 改为 $1$，将 $b_1$ 改为 $2$。然后 A 队可以得到 $2$ 分。可以证明这是 A 队可以获得的最大分数。\n\n### 约束\n\n$1\\le T,n \\le 10^5; 1\\le a_i,b_i \\le 3$。所有测试用例的 $n$ 之和 $\\le 10^5$。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P7941", "type": "P", "difficulty": 3, "samples": [["2\n3 01?\n7 01?01?|", "1\n3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "栈"], "title": "「Wdcfr-1」Magical Expression", "background": "", "description": "Nitori is learning postfix expressions. She has a incomplete postfix expression $E$ of length $n$. Being a Youkai, she wants to find its magical property.\n\nHer postfix expression contains the Bitwise Or operator (denoted as `|`), the Bitwise And operator (denoted as `&`), and numbers `0` and `1`. Being incomplete, some operators have not been decided yet and are denoted as `?`. She promised that $E$ **will become a *vaild* postfix expression** after you complete it.\n\nIn this problem, the term *substring* is defined as a continuous segment of $E$. **Two substrings are considered different as long as their positions or length differ.**  So `1?0`, `01?0` are all substrings of `01?01?|`  , but `0101` is not.\n\nNitori found out that a substring of her expression is *magical* if and only if the following conditions are met:\n\n- It is possible to transform it into a *valid* postfix expression after replacing `?` with either `&` or `|` .\n- Among these transformations, it is possible to find at least one of them that after applying it, the expression yields $0$,  and at least one of them that after applying it, the expression yields $1$.\n\nYour task is to find out the number of *magical* substrings.\n", "inputFormat": "The first line contains an integer $T$, the number of test cases.\n\nFor each test case, input one integer $n$ and an expression $E$ in a single line.", "outputFormat": "For each test case, print one integer which is the answer.", "hint": "### Constraints\n\n$1\\le T,n\\le 2\\times 10^6$. The sum of $n$ of all test cases $\\le 2\\times 10^6$.", "locale": "en", "translations": {"en": {"title": "「Wdcfr-1」Magical Expression", "background": "", "description": "Nitori is learning postfix expressions. She has a incomplete postfix expression $E$ of length $n$. Being a Youkai, she wants to find its magical property.\n\nHer postfix expression contains the Bitwise Or operator (denoted as `|`), the Bitwise And operator (denoted as `&`), and numbers `0` and `1`. Being incomplete, some operators have not been decided yet and are denoted as `?`. She promised that $E$ **will become a *vaild* postfix expression** after you complete it.\n\nIn this problem, the term *substring* is defined as a continuous segment of $E$. **Two substrings are considered different as long as their positions or length differ.**  So `1?0`, `01?0` are all substrings of `01?01?|`  , but `0101` is not.\n\nNitori found out that a substring of her expression is *magical* if and only if the following conditions are met:\n\n- It is possible to transform it into a *valid* postfix expression after replacing `?` with either `&` or `|` .\n- Among these transformations, it is possible to find at least one of them that after applying it, the expression yields $0$,  and at least one of them that after applying it, the expression yields $1$.\n\nYour task is to find out the number of *magical* substrings.\n", "inputFormat": "The first line contains an integer $T$, the number of test cases.\n\nFor each test case, input one integer $n$ and an expression $E$ in a single line.", "outputFormat": "For each test case, print one integer which is the answer.", "hint": "### Constraints\n\n$1\\le T,n\\le 2\\times 10^6$. The sum of $n$ of all test cases $\\le 2\\times 10^6$.", "locale": "en"}, "zh-CN": {"title": "「Wdcfr-1」Magical Expression", "background": "", "description": "妮特莉正在学习后缀表达式。她有一个长度为 $n$ 的不完整后缀表达式 $E$。作为妖怪，她想要找到它的魔法属性。\n\n她的后缀表达式包含按位或运算符（记作 `|`）、按位与运算符（记作 `&`），以及数字 `0` 和 `1`。由于不完整，一些运算符尚未决定，用 `?` 表示。她保证 $E$ **在你完成它之后将成为一个*有效*的后缀表达式**。\n\n在这个问题中，术语*子串*定义为 $E$ 的一个连续片段。**只要位置或长度不同，两个子串就被认为是不同的。**所以 `1?0`，`01?0` 都是 `01?01?|` 的子串，但 `0101` 不是。\n\n妮特莉发现她的表达式的一个子串是*魔法的*，当且仅当满足以下条件：\n\n- 在将 `?` 替换为 `&` 或 `|` 后，可以将其转换为一个*有效*的后缀表达式。\n- 在这些转换中，至少能找到一种转换，使得应用后表达式的结果为 $0$，并且至少能找到一种转换，使得应用后表达式的结果为 $1$。\n\n你的任务是找出*魔法的*子串的数量。", "inputFormat": "第一行包含一个整数 $T$，表示测试用例的数量。\n\n对于每个测试用例，在一行中输入一个整数 $n$ 和一个表达式 $E$。", "outputFormat": "对于每个测试用例，输出一个整数，表示答案。", "hint": "### 约束条件\n\n$1\\le T,n\\le 2\\times 10^6$。所有测试用例的 $n$ 之和 $\\le 2\\times 10^6$。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P7942", "type": "P", "difficulty": 4, "samples": [["3 3 4\naab\nbaa\nbaa", "4"], ["3 3 2\nxyz\nqaq\naba\n", "0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "枚举"], "title": "「Wdcfr-1」CONsecutive and CONcat (easy version)", "background": "", "description": "**In easy version, It is guaranteed that any string in array $\\mathbf a$ contains at least two different letters.**\n\nLily White is playing with strings. Being a yousei, she is not capable of complex speech. Thus, she likes strings that only contain one kind of letter, she calls such strings of length $x$ a \"$x$-CON string\". For example, `qqqq` is a \"$4$-CON string\", while `aaab` is not any type of \"CON string\".\n\nLily White composed an array $a$. It contains $n$ strings of length $m$ that she will use to herald spring. For each permutation of $1,2,\\ldots, n$, let us denote current permutation as $p=\\{p_1,p_2,\\cdots,p_n\\}$. Lily White concatenates all the string in array $a$ in the order of $a_{p_1},a_{p_2},\\cdots,a_{p_n}$ into a string $s$ of length $nm$ . \n\nAs she likes $k$-CON strings, she wants to know the sum of the number of \"$k$-CON string\" in all non-empty substrings of $s$ composed by all $n!$ permutations. Since the answer may be enormous, just print the answer taken modulo $998,244,353$ (a large prime).\n", "inputFormat": "The first line contains three integers $n,m,k$.\n\nThen $n$ lines follow, each line contains a string of length $m$. The string in the$(i+1)$-th line represents $a_i$.", "outputFormat": "Print a single integer - the answer taken modulo $998,244,353$.\n", "hint": "### Explanation\n\n#### Sample \\#1\n\n- For permutation $1,2,3$, the formed $s$ is `aabbaabaa`, none on the non-empty substring in this string are \"$4$-CON string\".\n- For permutation $1,3,2$, the formed $s$ is `aabbaabaa`, none on the non-empty substring in this string are \"$4$-CON string\".\n- For permutation $2,1,3$, the formed $s$ is `baaaabbaa`, this string has one substring `aaaa` which is a \"$4$-CON string\".\n- For permutation $2,3,1$, the formed $s$ is `baabaaaab`, this string has one substring `aaaa` which is a \"$4$-CON string\".\n- For permutation $3,1,2$, the formed $s$ is `baaaabbaa`, this string has one substring `aaaa` which is a \"$4$-CON string\".\n- For permutation $3,2,1$, the formed $s$ is `baabaaaab`, this string has one substring `aaaa` which is a \"$4$-CON string\".\n\nIn summary, the answer is $0+0+1+1+1+1=4$.\n\n#### Sample \\#2\n\nIn all of the full permutation of length $3$, there will be six different $s$: `xyzqaqaba`, `xyzabaqaq`, `qaqxyzaba`, `qaqabaxyz`, `abaqaqxyz`, and `abaxyzqaq`. None of these has a non-empty substrings which is a \"$2$-CON string\". So the answer is $0$.\n\n### Constraints\n\n$2\\le k \\le n\\cdot m\\le 10^6;\\ 1\\le m \\le 100$. $a_i$ contains only lowercase English letters.\n\n**In easy version, we ensure that any string in array $\\mathbf a$ contains at least two different letters.**", "locale": "en", "translations": {"en": {"title": "「Wdcfr-1」CONsecutive and CONcat (easy version)", "background": "", "description": "**In easy version, It is guaranteed that any string in array $\\mathbf a$ contains at least two different letters.**\n\nLily White is playing with strings. Being a yousei, she is not capable of complex speech. Thus, she likes strings that only contain one kind of letter, she calls such strings of length $x$ a \"$x$-CON string\". For example, `qqqq` is a \"$4$-CON string\", while `aaab` is not any type of \"CON string\".\n\nLily White composed an array $a$. It contains $n$ strings of length $m$ that she will use to herald spring. For each permutation of $1,2,\\ldots, n$, let us denote current permutation as $p=\\{p_1,p_2,\\cdots,p_n\\}$. Lily White concatenates all the string in array $a$ in the order of $a_{p_1},a_{p_2},\\cdots,a_{p_n}$ into a string $s$ of length $nm$ . \n\nAs she likes $k$-CON strings, she wants to know the sum of the number of \"$k$-CON string\" in all non-empty substrings of $s$ composed by all $n!$ permutations. Since the answer may be enormous, just print the answer taken modulo $998,244,353$ (a large prime).\n", "inputFormat": "The first line contains three integers $n,m,k$.\n\nThen $n$ lines follow, each line contains a string of length $m$. The string in the$(i+1)$-th line represents $a_i$.", "outputFormat": "Print a single integer - the answer taken modulo $998,244,353$.\n", "hint": "### Explanation\n\n#### Sample \\#1\n\n- For permutation $1,2,3$, the formed $s$ is `aabbaabaa`, none on the non-empty substring in this string are \"$4$-CON string\".\n- For permutation $1,3,2$, the formed $s$ is `aabbaabaa`, none on the non-empty substring in this string are \"$4$-CON string\".\n- For permutation $2,1,3$, the formed $s$ is `baaaabbaa`, this string has one substring `aaaa` which is a \"$4$-CON string\".\n- For permutation $2,3,1$, the formed $s$ is `baabaaaab`, this string has one substring `aaaa` which is a \"$4$-CON string\".\n- For permutation $3,1,2$, the formed $s$ is `baaaabbaa`, this string has one substring `aaaa` which is a \"$4$-CON string\".\n- For permutation $3,2,1$, the formed $s$ is `baabaaaab`, this string has one substring `aaaa` which is a \"$4$-CON string\".\n\nIn summary, the answer is $0+0+1+1+1+1=4$.\n\n#### Sample \\#2\n\nIn all of the full permutation of length $3$, there will be six different $s$: `xyzqaqaba`, `xyzabaqaq`, `qaqxyzaba`, `qaqabaxyz`, `abaqaqxyz`, and `abaxyzqaq`. None of these has a non-empty substrings which is a \"$2$-CON string\". So the answer is $0$.\n\n### Constraints\n\n$2\\le k \\le n\\cdot m\\le 10^6;\\ 1\\le m \\le 100$. $a_i$ contains only lowercase English letters.\n\n**In easy version, we ensure that any string in array $\\mathbf a$ contains at least two different letters.**", "locale": "en"}, "zh-CN": {"title": "「Wdcfr-1」CONsecutive and CONcat (easy version)", "background": "", "description": "**在简单版本中，保证数组 $\\mathbf a$ 中的任何字符串至少包含两个不同的字母。**\n\nLily White 正在玩字符串。作为一个妖精，她不擅长复杂的语言。因此，她喜欢只包含一种字母的字符串，她称这样的长度为 $x$ 的字符串为“$x$-CON 字符串”。例如，`qqqq` 是一个“$4$-CON 字符串”，而 `aaab` 不是任何类型的“CON 字符串”。\n\nLily White 组成了一个数组 $a$。它包含 $n$ 个长度为 $m$ 的字符串，她将用来迎接春天。对于 $1,2,\\ldots, n$ 的每一个排列，我们将当前排列记为 $p=\\{p_1,p_2,\\cdots,p_n\\}$。Lily White 按照 $a_{p_1},a_{p_2},\\cdots,a_{p_n}$ 的顺序将数组 $a$ 中的所有字符串连接成一个长度为 $nm$ 的字符串 $s$。\n\n由于她喜欢 $k$-CON 字符串，她想知道由所有 $n!$ 个排列组成的 $s$ 的所有非空子串中“$k$-CON 字符串”的数量之和。由于答案可能非常大，只需输出答案对 $998,244,353$（一个大质数）取模的结果。", "inputFormat": "第一行包含三个整数 $n,m,k$。\n\n接下来有 $n$ 行，每行包含一个长度为 $m$ 的字符串。第 $(i+1)$ 行的字符串表示 $a_i$。", "outputFormat": "输出一个整数，即答案对 $998,244,353$ 取模的结果。", "hint": "### 解释\n\n#### 示例 \\#1\n\n- 对于排列 $1,2,3$，形成的 $s$ 是 `aabbaabaa`，这个字符串中的非空子串没有一个是“$4$-CON 字符串”。\n- 对于排列 $1,3,2$，形成的 $s$ 是 `aabbaabaa`，这个字符串中的非空子串没有一个是“$4$-CON 字符串”。\n- 对于排列 $2,1,3$，形成的 $s$ 是 `baaaabbaa`，这个字符串有一个子串 `aaaa` 是“$4$-CON 字符串”。\n- 对于排列 $2,3,1$，形成的 $s$ 是 `baabaaaab`，这个字符串有一个子串 `aaaa` 是“$4$-CON 字符串”。\n- 对于排列 $3,1,2$，形成的 $s$ 是 `baaaabbaa`，这个字符串有一个子串 `aaaa` 是“$4$-CON 字符串”。\n- 对于排列 $3,2,1$，形成的 $s$ 是 `baabaaaab`，这个字符串有一个子串 `aaaa` 是“$4$-CON 字符串”。\n\n综上所述，答案是 $0+0+1+1+1+1=4$。\n\n#### 示例 \\#2\n\n在所有长度为 $3$ 的全排列中，将有六个不同的 $s$：`xyzqaqaba`，`xyzabaqaq`，`qaqxyzaba`，`qaqabaxyz`，`abaqaqxyz` 和 `abaxyzqaq`。这些中没有一个非空子串是“$2$-CON 字符串”。所以答案是 $0$。\n\n### 约束\n\n$2\\le k \\le n\\cdot m\\le 10^6;\\\\ 1\\le m \\le 100$。$a_i$ 仅包含小写英文字母。\n\n**在简单版本中，我们确保数组 $\\mathbf a$ 中的任何字符串至少包含两个不同的字母。**\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P7943", "type": "P", "difficulty": 4, "samples": [["3 3 5\naaa\nbaa\nbaa\n", "4"], ["3 3 2\nxyz\nqaq\naba\n", "0"], ["5 3 2\ncca\ncbb\nacb\nbbb\nacb\n", "600"], ["5 3 5\naba\nbbb\nbbb\naba\nbcb\n", "120"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "枚举"], "title": "「Wdcfr-1」CONsecutive and CONcat (hard version)", "background": "", "description": "Lily White is playing with strings. Being a yousei, she is not capable of complex speech. Thus, she likes strings that only contain one kind of letter, she calls such strings of length $x$ a \"$x$-CON string\". For example, `qqqq` is a \"$4$-CON string\", while `aaab` is not any type of \"CON string\".\n\nLily White composed an array $a$. It contains $n$ strings of length $m$ that she will use to herald spring. For each permutation of $1,2,\\ldots, n$, let us denote current permutation as $p=\\{p_1,p_2,\\cdots,p_n\\}$. Lily White concatenates all the string in array $a$ in the order of $a_{p_1},a_{p_2},\\cdots,a_{p_n}$ into a string $s$ of length $nm$ . \n\nAs she likes $k$-CON strings, she wants to know the sum of the number of \"$k$-CON string\" in all non-empty substrings of $s$ composed by all $n!$ permutations. Since the answer may be enormous, just print the answer taken modulo $998,244,353$ (a large prime).\n", "inputFormat": "The first line contains three integers $n,m,k$.\n\nThen $n$ lines follow, each line contains a string of length $m$. The string in the$(i+1)$-th line represents $a_i$.", "outputFormat": "Print a single integer - the answer taken modulo $998,244,353$.\n", "hint": "### Explanation\n\n#### Sample \\#1\n\n- For permutation $1,2,3$, the formed $s$ is `aaabaabaa`, none on the non-empty substring in this string are \"$5$-CON string\".\n- For permutation $1,3,2$, the formed $s$ is `aaabaabaa`, none on the non-empty substring in this string are \"$5$-CON string\".\n- For permutation $2,1,3$, the formed $s$ is `baaaaabaa`, this string has one substring `aaaaa` which is a \"$5$-CON string\".\n- For permutation $2,3,1$, the formed $s$ is `baabaaaaa`, this string has one substring `aaaaa` which is a \"$5$-CON string\".\n- For permutation $3,1,2$, the formed $s$ is `baaaaabaa`, this string has one substring `aaaaa` which is a \"$5$-CON string\".\n- For permutation $3,2,1$, the formed $s$ is `baabaaaaa`, this string has one substring `aaaaa` which is a \"$5$-CON string\".\n\nIn summary, the answer is $0+0+1+1+1+1=4$.\n\n#### Sample \\#2\n\nIn all of the full permutation of length $3$, there will be six different $s$: `xyzqaqaba`, `xyzabaqaq`, `qaqxyzaba`, `qaqabaxyz`, `abaqaqxyz`, and `abaxyzqaq`. None of these has a non-empty substrings which is a \"$2$-CON string\". So the answer is $0$.\n\n### Constraints\n\n$2\\le k \\le n\\cdot m\\le 10^6;\\ 1\\le m \\le 100$. $a_i$ contains only lowercase English letters.", "locale": "en", "translations": {"en": {"title": "「Wdcfr-1」CONsecutive and CONcat (hard version)", "background": "", "description": "Lily White is playing with strings. Being a yousei, she is not capable of complex speech. Thus, she likes strings that only contain one kind of letter, she calls such strings of length $x$ a \"$x$-CON string\". For example, `qqqq` is a \"$4$-CON string\", while `aaab` is not any type of \"CON string\".\n\nLily White composed an array $a$. It contains $n$ strings of length $m$ that she will use to herald spring. For each permutation of $1,2,\\ldots, n$, let us denote current permutation as $p=\\{p_1,p_2,\\cdots,p_n\\}$. Lily White concatenates all the string in array $a$ in the order of $a_{p_1},a_{p_2},\\cdots,a_{p_n}$ into a string $s$ of length $nm$ . \n\nAs she likes $k$-CON strings, she wants to know the sum of the number of \"$k$-CON string\" in all non-empty substrings of $s$ composed by all $n!$ permutations. Since the answer may be enormous, just print the answer taken modulo $998,244,353$ (a large prime).\n", "inputFormat": "The first line contains three integers $n,m,k$.\n\nThen $n$ lines follow, each line contains a string of length $m$. The string in the$(i+1)$-th line represents $a_i$.", "outputFormat": "Print a single integer - the answer taken modulo $998,244,353$.\n", "hint": "### Explanation\n\n#### Sample \\#1\n\n- For permutation $1,2,3$, the formed $s$ is `aaabaabaa`, none on the non-empty substring in this string are \"$5$-CON string\".\n- For permutation $1,3,2$, the formed $s$ is `aaabaabaa`, none on the non-empty substring in this string are \"$5$-CON string\".\n- For permutation $2,1,3$, the formed $s$ is `baaaaabaa`, this string has one substring `aaaaa` which is a \"$5$-CON string\".\n- For permutation $2,3,1$, the formed $s$ is `baabaaaaa`, this string has one substring `aaaaa` which is a \"$5$-CON string\".\n- For permutation $3,1,2$, the formed $s$ is `baaaaabaa`, this string has one substring `aaaaa` which is a \"$5$-CON string\".\n- For permutation $3,2,1$, the formed $s$ is `baabaaaaa`, this string has one substring `aaaaa` which is a \"$5$-CON string\".\n\nIn summary, the answer is $0+0+1+1+1+1=4$.\n\n#### Sample \\#2\n\nIn all of the full permutation of length $3$, there will be six different $s$: `xyzqaqaba`, `xyzabaqaq`, `qaqxyzaba`, `qaqabaxyz`, `abaqaqxyz`, and `abaxyzqaq`. None of these has a non-empty substrings which is a \"$2$-CON string\". So the answer is $0$.\n\n### Constraints\n\n$2\\le k \\le n\\cdot m\\le 10^6;\\ 1\\le m \\le 100$. $a_i$ contains only lowercase English letters.", "locale": "en"}, "zh-CN": {"title": "「Wdcfr-1」CONsecutive and CONcat (hard version)", "background": "", "description": "Lily White 在玩字符串。作为一个妖精，她不擅长复杂的语言。因此，她喜欢只包含一种字母的字符串，她称这种长度为 $x$ 的字符串为“$x$-CON 字符串”。例如，`qqqq` 是一个“$4$-CON 字符串”，而 `aaab` 不是任何类型的“CON 字符串”。\n\nLily White 组成了一个数组 $a$。它包含 $n$ 个长度为 $m$ 的字符串，她将用来迎接春天。对于 $1,2,\\ldots, n$ 的每一个排列，我们将当前排列记为 $p=\\{p_1,p_2,\\cdots,p_n\\}$。Lily White 按照 $a_{p_1},a_{p_2},\\cdots,a_{p_n}$ 的顺序将数组 $a$ 中的所有字符串连接成一个长度为 $nm$ 的字符串 $s$。\n\n由于她喜欢 $k$-CON 字符串，她想知道由所有 $n!$ 个排列组成的 $s$ 的所有非空子串中“$k$-CON 字符串”的数量之和。由于答案可能非常大，只需输出答案对 $998,244,353$（一个大质数）取模的结果。", "inputFormat": "第一行包含三个整数 $n,m,k$。\n\n接下来有 $n$ 行，每行包含一个长度为 $m$ 的字符串。第 $(i+1)$ 行的字符串表示 $a_i$。", "outputFormat": "输出一个整数，即答案对 $998,244,353$ 取模的结果。", "hint": "### 解释\n\n#### 示例 \\#1\n\n- 对于排列 $1,2,3$，形成的 $s$ 是 `aaabaabaa`，在这个字符串的非空子串中没有“$5$-CON 字符串”。\n- 对于排列 $1,3,2$，形成的 $s$ 是 `aaabaabaa`，在这个字符串的非空子串中没有“$5$-CON 字符串”。\n- 对于排列 $2,1,3$，形成的 $s$ 是 `baaaaabaa`，这个字符串有一个子串 `aaaaa` 是“$5$-CON 字符串”。\n- 对于排列 $2,3,1$，形成的 $s$ 是 `baabaaaaa`，这个字符串有一个子串 `aaaaa` 是“$5$-CON 字符串”。\n- 对于排列 $3,1,2$，形成的 $s$ 是 `baaaaabaa`，这个字符串有一个子串 `aaaaa` 是“$5$-CON 字符串”。\n- 对于排列 $3,2,1$，形成的 $s$ 是 `baabaaaaa`，这个字符串有一个子串 `aaaaa` 是“$5$-CON 字符串”。\n\n综上所述，答案是 $0+0+1+1+1+1=4$。\n\n#### 示例 \\#2\n\n在长度为 $3$ 的所有全排列中，将有六个不同的 $s$：`xyzqaqaba`，`xyzabaqaq`，`qaqxyzaba`，`qaqabaxyz`，`abaqaqxyz` 和 `abaxyzqaq`。这些字符串中没有任何非空子串是“$2$-CON 字符串”。所以答案是 $0$。\n\n### 约束\n\n$2\\le k \\le n\\cdot m\\le 10^6; 1\\le m \\le 100$。$a_i$ 仅包含小写英文字母。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P7944", "type": "P", "difficulty": 5, "samples": [["4 4\n1 1\n1 2\n2 2\n3 2\n3 3\n3 4\n4 4\n\n0\n\n1\n\n0\n\n0\n\n1\n\n\n\n\n\n\n\n1\n\n1\n", "\n\n\n\n\n\n\n\n? 2 2\n\n? 2 1\n\n? 3 1\n\n? 3 2\n\n? 4 1\n\n2 1\n2 2\n3 2\n3 1\n4 1\n-1 -1\n? 1 4\n\n? 1 3\n\n1 4\n1 3\n-1 -1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["交互题", "Special Judge", "O2优化"], "title": "「Wdcfr-1」Border of Gensokyo", "background": "", "description": "\n**This is an interactive problem.**\n\n\nRan is helping Yukari to maintain the border of Gensokyo. \n\nThe border of Gensokyo is a $n\\times m$ matrix, where $n$ and $m$ are both even. Unfortunately, due to Moriya Shrine's moving in, there are now $4$ weakened points within the matrix.\n\nTo ease the maintenance work, Ran have already found a path from $(1,1)$ to $(n,m)$, going only down or right. The path separates the four weakened points so that exactly two of them are on either side. She will tell you this path in the input.\n\nNow you need to help Ran maintain the border. You can use the operation `? x y` to ask whether the point $(x,y)$ is weakened. And after the query, Ran will mark the point with blue.\n\nIf, after a query, you have just found out the $k$-th weakened point, and $k$ is even, you will need to construct a simple path from the $(k-1)$-th weakened point to the $k$-th. The path you constructed must pass through and only pass through **all** the points that are marked blue.  Ran will then strengthen these points in the border and recolor them red.\n\nRan does not want to do repetitive work, so you can only ask for points that are white with the `?` query.\n\nNow Ran hopes that you can ask all the \"weakened points\" and finish all the constructions.\n\n### Interaction Protocol\n\nFirst read two integers $n$ and $m$ from standard input.\n\nThen read several points (including start and end points) from standard input, one per line, representing a simple path from $(1,1)$ to $(n,m)$.\n\nThen you can make **unlimited** queries. Print your queries to standard output in the format of `? x y`. You will then receive an integer $p$ from standard input. If $p=1$, it means that the point you asked is indeed weakened; if $p=0$, it means that it is not weakened.\n\nRemember to flush your output, you can use `fflush(stdout);` in C++. Please refer to your programming language's documentation.\n\nOn the $k$-th time ($k$ is even) of receiving the result $p=1$, please output several points (including the two weakened points) in order, one per line, ending with $-1,-1$, so that they represent the simple path from the $(k-1)$-th to the $k$-th weakened point.\n\nYou need to exit your program immediately after finding the fourth weakened point and finishing the construction.\n", "inputFormat": "Refer to \"Interactive Method\".", "outputFormat": "Refer to \"Interactive Method\".", "hint": "### Explanation\n\nThe matrix in the sample is as follows:\n\n```plain\n..XX\nX...\n....\nX...\n```\n\nWhich `X` means a \"weakened point\".\n\n### Constraints\n\n$4\\le n,m\\le100$。", "locale": "en", "translations": {"en": {"title": "「Wdcfr-1」Border of Gensokyo", "background": "", "description": "\n**This is an interactive problem.**\n\n\nRan is helping Yukari to maintain the border of Gensokyo. \n\nThe border of Gensokyo is a $n\\times m$ matrix, where $n$ and $m$ are both even. Unfortunately, due to Moriya Shrine's moving in, there are now $4$ weakened points within the matrix.\n\nTo ease the maintenance work, Ran have already found a path from $(1,1)$ to $(n,m)$, going only down or right. The path separates the four weakened points so that exactly two of them are on either side. She will tell you this path in the input.\n\nNow you need to help Ran maintain the border. You can use the operation `? x y` to ask whether the point $(x,y)$ is weakened. And after the query, Ran will mark the point with blue.\n\nIf, after a query, you have just found out the $k$-th weakened point, and $k$ is even, you will need to construct a simple path from the $(k-1)$-th weakened point to the $k$-th. The path you constructed must pass through and only pass through **all** the points that are marked blue.  Ran will then strengthen these points in the border and recolor them red.\n\nRan does not want to do repetitive work, so you can only ask for points that are white with the `?` query.\n\nNow Ran hopes that you can ask all the \"weakened points\" and finish all the constructions.\n\n### Interaction Protocol\n\nFirst read two integers $n$ and $m$ from standard input.\n\nThen read several points (including start and end points) from standard input, one per line, representing a simple path from $(1,1)$ to $(n,m)$.\n\nThen you can make **unlimited** queries. Print your queries to standard output in the format of `? x y`. You will then receive an integer $p$ from standard input. If $p=1$, it means that the point you asked is indeed weakened; if $p=0$, it means that it is not weakened.\n\nRemember to flush your output, you can use `fflush(stdout);` in C++. Please refer to your programming language's documentation.\n\nOn the $k$-th time ($k$ is even) of receiving the result $p=1$, please output several points (including the two weakened points) in order, one per line, ending with $-1,-1$, so that they represent the simple path from the $(k-1)$-th to the $k$-th weakened point.\n\nYou need to exit your program immediately after finding the fourth weakened point and finishing the construction.\n", "inputFormat": "Refer to \"Interactive Method\".", "outputFormat": "Refer to \"Interactive Method\".", "hint": "### Explanation\n\nThe matrix in the sample is as follows:\n\n```plain\n..XX\nX...\n....\nX...\n```\n\nWhich `X` means a \"weakened point\".\n\n### Constraints\n\n$4\\le n,m\\le100$。", "locale": "en"}, "zh-CN": {"title": "「Wdcfr-1」Border of Gensokyo", "background": "", "description": "**这是一个交互式问题。**\n\nRan 正在帮助 Yukari 维护幻想乡的边界。\n\n幻想乡的边界是一个 $n \\times m$ 的矩阵，其中 $n$ 和 $m$ 都是偶数。不幸的是，由于 Moriya 神社的迁入，矩阵中现在有 4 个薄弱点。\n\n为了简化维护工作，Ran 已经找到了从 $(1,1)$ 到 $(n,m)$ 的一条路径，只能向下或向右走。路径将四个薄弱点分隔开，使得每一侧恰好有两个薄弱点。她将在输入中告诉你这条路径。\n\n现在你需要帮助 Ran 维护边界。你可以使用操作 `? x y` 来询问点 $(x,y)$ 是否是薄弱点。在查询之后，Ran 会将该点标记为蓝色。\n\n如果在一次查询后，你刚刚找到了第 $k$ 个薄弱点，并且 $k$ 是偶数，你需要构造一条从第 $(k-1)$ 个薄弱点到第 $k$ 个薄弱点的简单路径。你构造的路径必须经过且仅经过所有标记为蓝色的点。Ran 然后将这些点在边界上加固并重新着色为红色。\n\nRan 不想做重复的工作，所以你只能用 `?` 查询白色的点。\n\n现在 Ran 希望你能找到所有的“薄弱点”并完成所有的构造。\n\n### 交互协议\n\n首先从标准输入读取两个整数 $n$ 和 $m$。\n\n然后从标准输入读取几个点（包括起点和终点），每行一个，表示从 $(1,1)$ 到 $(n,m)$ 的一条简单路径。\n\n然后你可以进行**无限**次查询。将你的查询以 `? x y` 的格式打印到标准输出。然后你将从标准输入接收一个整数 $p$。如果 $p=1$，表示你询问的点确实是薄弱点；如果 $p=0$，表示它不是薄弱点。\n\n记得刷新你的输出，你可以在 C++ 中使用 `fflush(stdout);`。请参考你的编程语言的文档。\n\n在第 $k$ 次（$k$ 是偶数）接收到结果 $p=1$ 时，请按顺序输出几个点（包括两个薄弱点），每行一个，以 $-1,-1$ 结束，以表示从第 $(k-1)$ 个到第 $k$ 个薄弱点的简单路径。\n\n在找到第四个薄弱点并完成构造后，你需要立即退出程序。", "inputFormat": "参考“交互方法”。", "outputFormat": "参考“交互方法”。", "hint": "### 解释\n\n示例中的矩阵如下：\n\n```plain\n..XX\nX...\n....\nX...\n```\n\n其中 `X` 表示一个“薄弱点”。\n\n### 约束\n\n$4 \\le n,m \\le 100$。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P7945", "type": "P", "difficulty": 5, "samples": [["3\n0 1 2 3 4 5", "6"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化"], "title": "「Wdcfr-1」Yet Another Cirno Game (easy version)", "background": "", "description": "**The only difference between the two versions is whether you have to find a way to get the maximum points.**\n\nCirno drew a graph. This graph contains $4\\cdot n$ nodes, numbered $0$ through $4\\cdot n - 1$. Also:\n\n- For any $0\\le i\\le 3$ and $0 \\le j, k \\lt n$, node $(n\\cdot i + j)$ and node $(n\\cdot i + k)$ are connected.\n- For any $0 \\le i < n$ and $0 \\le j, k \\le 3$, node $(i + n\\cdot j)$ and node $(i + n\\cdot k)$ are connected.\n\nCirno called Daiyousei to come and play with her.\n\nThe rules for this game are as follows:\n\n- Firstly, Cirno chooses $2\\cdot n$ (i.e. half) of the nodes, and she colors them blue. The rest are left red.\n- Then there are $2\\cdot n$ turns: for each turn Cirno first chooses a blue node, and Daiyousei chooses a red node. If those two nodes are connected, Daiyousei gets a point.\n\nTry to maximize the number of points Daiyousei gets.", "inputFormat": "The first line contains an integer $n$. Then one line below, $2\\cdot n$ numbers follow: they are the nodes that Cirno chose.", "outputFormat": "For each test case, output an integer $x$ in a single line, which is the maximum number of points Daiyousei can get.\n\nYou don't have to output anything else in this version.", "hint": "### Explanation\n\nIn the following picture, nodes in matrices are connected to each other. Cirno chose nodes $0,1,2,3,4,5$.\n\nArrows below show a possible way for Daiyousei to get the maximum number of points she can get.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7v3w2cz9.png)\n\n### Constraints\n\n$1\\le n\\le 2\\times 10^6$.", "locale": "en", "translations": {"en": {"title": "「Wdcfr-1」Yet Another Cirno Game (easy version)", "background": "", "description": "**The only difference between the two versions is whether you have to find a way to get the maximum points.**\n\nCirno drew a graph. This graph contains $4\\cdot n$ nodes, numbered $0$ through $4\\cdot n - 1$. Also:\n\n- For any $0\\le i\\le 3$ and $0 \\le j, k \\lt n$, node $(n\\cdot i + j)$ and node $(n\\cdot i + k)$ are connected.\n- For any $0 \\le i < n$ and $0 \\le j, k \\le 3$, node $(i + n\\cdot j)$ and node $(i + n\\cdot k)$ are connected.\n\nCirno called Daiyousei to come and play with her.\n\nThe rules for this game are as follows:\n\n- Firstly, Cirno chooses $2\\cdot n$ (i.e. half) of the nodes, and she colors them blue. The rest are left red.\n- Then there are $2\\cdot n$ turns: for each turn Cirno first chooses a blue node, and Daiyousei chooses a red node. If those two nodes are connected, Daiyousei gets a point.\n\nTry to maximize the number of points Daiyousei gets.", "inputFormat": "The first line contains an integer $n$. Then one line below, $2\\cdot n$ numbers follow: they are the nodes that Cirno chose.", "outputFormat": "For each test case, output an integer $x$ in a single line, which is the maximum number of points Daiyousei can get.\n\nYou don't have to output anything else in this version.", "hint": "### Explanation\n\nIn the following picture, nodes in matrices are connected to each other. Cirno chose nodes $0,1,2,3,4,5$.\n\nArrows below show a possible way for Daiyousei to get the maximum number of points she can get.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7v3w2cz9.png)\n\n### Constraints\n\n$1\\le n\\le 2\\times 10^6$.", "locale": "en"}, "zh-CN": {"title": "「Wdcfr-1」Yet Another Cirno Game (easy version)", "background": "", "description": "**两个版本之间的唯一区别是是否需要找到一种方法来获得最大分数。**\n\n琪露诺画了一张图。这张图包含 $4\\cdot n$ 个节点，编号为 $0$ 到 $4\\cdot n - 1$。此外：\n\n- 对于任何 $0\\le i\\le 3$ 和 $0 \\le j, k < n$，节点 $(n\\cdot i + j)$ 和节点 $(n\\cdot i + k)$ 是连接的。\n- 对于任何 $0 \\le i < n$ 和 $0 \\le j, k \\le 3$，节点 $(i + n\\cdot j)$ 和节点 $(i + n\\cdot k)$ 是连接的。\n\n琪露诺叫来了大妖精和她一起玩。\n\n游戏规则如下：\n\n- 首先，琪露诺选择 $2\\cdot n$（即一半）的节点，并将它们涂成蓝色。其余的节点保持红色。\n- 然后进行 $2\\cdot n$ 回合：每回合中，琪露诺首先选择一个蓝色节点，而大妖精选择一个红色节点。如果这两个节点是连接的，大妖精得一分。\n\n尝试最大化大妖精获得的分数。", "inputFormat": "第一行包含一个整数 $n$。接下来一行有 $2\\cdot n$ 个数字：它们是琪露诺选择的节点。", "outputFormat": "对于每个测试用例，输出一个整数 $x$，表示大妖精可以获得的最大分数。\n\n在这个版本中，你不需要输出其他任何东西。", "hint": "### 解释\n\n在下图中，矩阵中的节点是相互连接的。琪露诺选择了节点 $0,1,2,3,4,5$。\n\n下面的箭头显示了大妖精可以获得的最大分数的一种可能方式。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7v3w2cz9.png)\n\n### 约束\n\n$1\\le n\\le 2\\times 10^6$。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P7946", "type": "P", "difficulty": 6, "samples": [["3\n0 1 2 3 4 5", "6\n6 7 8 9 10 11"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["Special Judge", "O2优化"], "title": "「Wdcfr-1」Yet Another Cirno Game (hard version)", "background": "", "description": "**The only difference between the two versions is whether you have to find a way to get the maximum points.**\n\nCirno drew a graph. This graph consists of $4\\cdot n$ nodes, which are numbered $0$ through $4\\cdot n - 1$. Also:\n\n- For $0\\le i\\le 3$ and $0 \\le j, k \\lt n$, node $(n\\cdot i + j)$ and node $(n\\cdot i + k)$ are connected.\n- For $0 \\le i \\le n$ and $0 \\le j, k \\le 3$, node $(i + n\\cdot j)$ and node $(i + n\\cdot k)$ are connected.\n\nCirno called Daiyousei to come and play with her.\n\nThe rules for this game are as follows:\n\n- Firstly, Cirno chooses $2\\cdot n$ (i.e. half) of the nodes, and she colors them blue. The rest are left red.\n- Then there are $2\\cdot n$ turns: for each turn Cirno first chooses a blue node, and Daiyousei chooses a red node. If those two nodes are connected, Daiyousei gets a point.\n\nTry to maximize the number of points Daiyousei gets.", "inputFormat": "In the first line, $n$ is provided.\n\nIn the second line, $n$ numbers follow: they are the nodes that Cirno chose.", "outputFormat": "In the first line output $x$, which is the maximum number of points Daiyousei can get.\n\nThen output $2\\cdot n$ integers. For each node that Cirno chooses, output the corresponding node that Daiyousei responds with. Obviously the order of the chosen nodes doesn't matter. The solution must get the maximum number of points possible.", "hint": "### Explanation\n\nIn the following picture, nodes in matrices are connected to each other. Cirno chose nodes $0,1,2,3,4,5$.\n\nArrows below show a possible way for Daiyousei to get the maximum number of points she can get.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7v3w2cz9.png)\n\n### Constraints\n\n$1\\le n\\le 2\\times 10^6$.", "locale": "en", "translations": {"en": {"title": "「Wdcfr-1」Yet Another Cirno Game (hard version)", "background": "", "description": "**The only difference between the two versions is whether you have to find a way to get the maximum points.**\n\nCirno drew a graph. This graph consists of $4\\cdot n$ nodes, which are numbered $0$ through $4\\cdot n - 1$. Also:\n\n- For $0\\le i\\le 3$ and $0 \\le j, k \\lt n$, node $(n\\cdot i + j)$ and node $(n\\cdot i + k)$ are connected.\n- For $0 \\le i \\le n$ and $0 \\le j, k \\le 3$, node $(i + n\\cdot j)$ and node $(i + n\\cdot k)$ are connected.\n\nCirno called Daiyousei to come and play with her.\n\nThe rules for this game are as follows:\n\n- Firstly, Cirno chooses $2\\cdot n$ (i.e. half) of the nodes, and she colors them blue. The rest are left red.\n- Then there are $2\\cdot n$ turns: for each turn Cirno first chooses a blue node, and Daiyousei chooses a red node. If those two nodes are connected, Daiyousei gets a point.\n\nTry to maximize the number of points Daiyousei gets.", "inputFormat": "In the first line, $n$ is provided.\n\nIn the second line, $n$ numbers follow: they are the nodes that Cirno chose.", "outputFormat": "In the first line output $x$, which is the maximum number of points Daiyousei can get.\n\nThen output $2\\cdot n$ integers. For each node that Cirno chooses, output the corresponding node that Daiyousei responds with. Obviously the order of the chosen nodes doesn't matter. The solution must get the maximum number of points possible.", "hint": "### Explanation\n\nIn the following picture, nodes in matrices are connected to each other. Cirno chose nodes $0,1,2,3,4,5$.\n\nArrows below show a possible way for Daiyousei to get the maximum number of points she can get.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7v3w2cz9.png)\n\n### Constraints\n\n$1\\le n\\le 2\\times 10^6$.", "locale": "en"}, "zh-CN": {"title": "「Wdcfr-1」Yet Another Cirno Game (hard version)", "background": "", "description": "**两个版本之间的唯一区别是你是否需要找到一种方法来获得最大分数。**\n\nCirno 画了一张图。这张图由 $4\\cdot n$ 个节点组成，节点编号为 $0$ 到 $4\\cdot n - 1$。此外：\n\n- 对于 $0\\le i\\le 3$ 和 $0 \\le j, k < n$，节点 $(n\\cdot i + j)$ 和节点 $(n\\cdot i + k)$ 是相连的。\n- 对于 $0 \\le i \\le n$ 和 $0 \\le j, k \\le 3$，节点 $(i + n\\cdot j)$ 和节点 $(i + n\\cdot k)$ 是相连的。\n\nCirno 叫来了 Daiyousei 和她一起玩。\n\n游戏规则如下：\n\n- 首先，Cirno 选择 $2\\cdot n$（即一半）的节点，并将它们涂成蓝色。其余的节点保持红色。\n- 然后有 $2\\cdot n$ 轮：每轮 Cirno 首先选择一个蓝色节点，Daiyousei 选择一个红色节点。如果这两个节点是相连的，Daiyousei 得到一分。\n\n试图最大化 Daiyousei 能得到的分数。", "inputFormat": "第一行给出 $n$。\n\n第二行跟随 $n$ 个数字：它们是 Cirno 选择的节点。", "outputFormat": "第一行输出 $x$，即 Daiyousei 能得到的最大分数。\n\n然后输出 $2\\cdot n$ 个整数。对于 Cirno 选择的每个节点，输出 Daiyousei 对应选择的节点。显然，选择的节点顺序无关紧要。解必须获得可能的最大分数。", "hint": "### 解释\n\n在下图中，矩阵中的节点是相互连接的。Cirno 选择了节点 $0,1,2,3,4,5$。\n\n下面的箭头显示了 Daiyousei 获得她能得到的最大分数的一种可能方式。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7v3w2cz9.png)\n\n### 约束\n\n$1\\le n\\le 2\\times 10^6$。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P7947", "type": "P", "difficulty": 3, "samples": [["67 68", "2\n1 67"], ["100 1", "-1"], ["80 16", "6\n1 1 4 5 1 4"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["Special Judge", "O2优化"], "title": "[✗✓OI R1] 铝锤制作", "background": "DPair 打算用米德拉什给大家带来笑容。\n\n因为 Lillia 不知道什么是米德拉什，所以打算阻止 Ta。  \n\n为了阻止 DPair，你需要制作一个小铝锤。\n\n如果你不知道如何制作小铝锤，你可以参考题目下方给出的视频。\n\n或者，你也可以选择做这场月赛的签到题。", "description": "构造一个正整数数列 $a$，使 $a$ 中所有元素之积为 $n$，所有元素之和为 $k$。如果不存在这样的数列，输出 `-1`。", "inputFormat": "一行两个正整数 $n,k$。", "outputFormat": "第一行一个整数 $m$，代表这个数列的长度。  \n接下来一行 $m$ 个正整数 $a_i$，代表这个数列。要求 $1\\leq m \\leq 1000$，$1\\leq a_i \\leq 1000$。  \n特别的，如果没有符合要求的数列，直接输出 `-1`。\n\n**本题采用 Special Judge。如果有多种答案，输出任意一种即可。**", "hint": "**【样例解释】**\n\n对于样例一，显然有 $1\\times67=67,1+67=68$。  \n对于样例二，可以证明没有合法的解。\n\n**【数据范围】**\n\n对于 $10\\%$ 的数据，$1\\leq n,k \\leq 3$；  \n对于 $30\\%$ 的数据，$1\\leq n,k \\leq 10$；  \n另有 $10\\%$ 的数据，$n=k$；  \n对于 $100\\%$ 的数据，$1\\leq n,k \\leq 100$。\n\n![](bilibili:av498389435)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[✗✓OI R1] 铝锤制作", "background": "DPair 打算用米德拉什给大家带来笑容。\n\n因为 Lillia 不知道什么是米德拉什，所以打算阻止 Ta。  \n\n为了阻止 DPair，你需要制作一个小铝锤。\n\n如果你不知道如何制作小铝锤，你可以参考题目下方给出的视频。\n\n或者，你也可以选择做这场月赛的签到题。", "description": "构造一个正整数数列 $a$，使 $a$ 中所有元素之积为 $n$，所有元素之和为 $k$。如果不存在这样的数列，输出 `-1`。", "inputFormat": "一行两个正整数 $n,k$。", "outputFormat": "第一行一个整数 $m$，代表这个数列的长度。  \n接下来一行 $m$ 个正整数 $a_i$，代表这个数列。要求 $1\\leq m \\leq 1000$，$1\\leq a_i \\leq 1000$。  \n特别的，如果没有符合要求的数列，直接输出 `-1`。\n\n**本题采用 Special Judge。如果有多种答案，输出任意一种即可。**", "hint": "**【样例解释】**\n\n对于样例一，显然有 $1\\times67=67,1+67=68$。  \n对于样例二，可以证明没有合法的解。\n\n**【数据范围】**\n\n对于 $10\\%$ 的数据，$1\\leq n,k \\leq 3$；  \n对于 $30\\%$ 的数据，$1\\leq n,k \\leq 10$；  \n另有 $10\\%$ 的数据，$n=k$；  \n对于 $100\\%$ 的数据，$1\\leq n,k \\leq 100$。\n\n![](bilibili:av498389435)", "locale": "zh-CN"}}}
{"pid": "P7948", "type": "P", "difficulty": 3, "samples": [["5\n9 9\n19 99 63 39 72 46 97 38 68 \n0 6 4 0 7 1 0 3 6 \n6 8\n88 62 48 50 8 47 \n0 6 1 5 2 2 6 1 \n6 5\n33 3 54 17 26 64 \n87 89 92 70 59 \n18 19\n71 52 77 38 12 34 82 14 57 39 91 7 56 86 35 68 38 14 \n9 9 1 5 1 3 4 5 6 1 6 0 3 0 2 1 3 5 8 \n10 15\n4 77 78 76 5 19 98 94 77 81 \n17 43 4 86 2 91 85 4 81 74 44 16 21 69 32 \n", "1 2 2 1 2 2 1 2 2\n1 1 1 1 1 1 1 1\n6 6 6 6 6\n4 4 1 3 1 2 2 3 3 1 3 1 2 1 1 1 2 3 4\n7 7 2 10 2 10 10 2 10 10 7 7 7 10 7\n"], ["1\n5 1\n20 0 0 0 0\n5", "5"]], "limits": {"time": [300, 300, 800, 800, 800, 800, 800, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "O2优化", "洛谷月赛"], "title": "[✗✓OI R1] 前方之风", "background": ">「不错的恶意。」  \n> 女性呵呵笑道。  \n>「但是，如果向我发出恶意，你可是会死哦？」\n\n你不知道什么动作会被算作发出恶意，所以你决定做一道题来分散自己的注意力。", "description": "给出一个长度为 $n$ 的序列 $a$ 和 $q$ 个询问，第 $i$ 个询问给出 $k_i$。对于每次询问，你需要进行以下操作：\n1. 求出剩下的数的平均数 $\\mathit{avg}$。\n2. 将剩下的数中 $<\\mathit{avg}-k_i$ 的数删去。\n3. 重复以上两个步骤直到所有数都不会被删去。\n4. 输出最后会剩下几个数。\n\n**注意：询问之间是独立的，也就是说，不会真的删去那些数。**", "inputFormat": "**本题有多组测试数据。**\n\n第一行一个整数 $T$，表示测试数据的数量。  \n对于每一组数据，第一行两个整数 $n,q$，表示数字个数和询问数量。  \n接下来一行 $n$ 个整数，第 $i$ 个整数表示 $a_i$。  \n接下来一行 $q$ 个整数，第 $i$ 个整数表示 $k_i$。", "outputFormat": "输出共 $T$ 行，每行输出 $q$ 个整数，第 $i$ 个数表示第 $i$ 次询问最终会剩下几个数。", "hint": "**【样例解释】**\n\n对于第一组样例，当 $k=0$ 时，显然只会留下 $99$。  \n当 $k=6$ 时，删除数的步骤如下：\n- 平均数为 $60\\dfrac{1}{9}$，留下 $99,63,72,97,68$。\n- 平均数为 $79.8$，留下 $99,97$。\n- 平均数为 $98$，停止删除。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，满足 $1\\leq n,q \\le 10^5$，$1\\le T \\le 10$，$0 \\le a_i,k_i \\le 10^9$。\n\n| subtask | 特殊数据范围 | 分数 |  时间限制\n| :----------: | :----------: | :----------: |  :----------: |\n| 1 | $n,q \\le 200$ | 20 |   300ms \n| 2 | $n,q \\le 2000$ | 30  | 300ms\n| 3 |  | 50 | 800ms|\n\n>「不错的恶意。」  \n> 女性呵呵笑道。  \n>「而且你运气很不错，如果放在以前，你早就死了。」\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6icoj36r.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[✗✓OI R1] 前方之风", "background": ">「不错的恶意。」  \n> 女性呵呵笑道。  \n>「但是，如果向我发出恶意，你可是会死哦？」\n\n你不知道什么动作会被算作发出恶意，所以你决定做一道题来分散自己的注意力。", "description": "给出一个长度为 $n$ 的序列 $a$ 和 $q$ 个询问，第 $i$ 个询问给出 $k_i$。对于每次询问，你需要进行以下操作：\n1. 求出剩下的数的平均数 $\\mathit{avg}$。\n2. 将剩下的数中 $<\\mathit{avg}-k_i$ 的数删去。\n3. 重复以上两个步骤直到所有数都不会被删去。\n4. 输出最后会剩下几个数。\n\n**注意：询问之间是独立的，也就是说，不会真的删去那些数。**", "inputFormat": "**本题有多组测试数据。**\n\n第一行一个整数 $T$，表示测试数据的数量。  \n对于每一组数据，第一行两个整数 $n,q$，表示数字个数和询问数量。  \n接下来一行 $n$ 个整数，第 $i$ 个整数表示 $a_i$。  \n接下来一行 $q$ 个整数，第 $i$ 个整数表示 $k_i$。", "outputFormat": "输出共 $T$ 行，每行输出 $q$ 个整数，第 $i$ 个数表示第 $i$ 次询问最终会剩下几个数。", "hint": "**【样例解释】**\n\n对于第一组样例，当 $k=0$ 时，显然只会留下 $99$。  \n当 $k=6$ 时，删除数的步骤如下：\n- 平均数为 $60\\dfrac{1}{9}$，留下 $99,63,72,97,68$。\n- 平均数为 $79.8$，留下 $99,97$。\n- 平均数为 $98$，停止删除。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，满足 $1\\leq n,q \\le 10^5$，$1\\le T \\le 10$，$0 \\le a_i,k_i \\le 10^9$。\n\n| subtask | 特殊数据范围 | 分数 |  时间限制\n| :----------: | :----------: | :----------: |  :----------: |\n| 1 | $n,q \\le 200$ | 20 |   300ms \n| 2 | $n,q \\le 2000$ | 30  | 300ms\n| 3 |  | 50 | 800ms|\n\n>「不错的恶意。」  \n> 女性呵呵笑道。  \n>「而且你运气很不错，如果放在以前，你早就死了。」\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6icoj36r.png)", "locale": "zh-CN"}}}
{"pid": "P7949", "type": "P", "difficulty": 6, "samples": [["4 3", "1\n0 14 3 13 6 8 5 11 12 2 15 1 10 4 9 7"], ["4 2", "0"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["Special Judge", "O2优化"], "title": "[✗✓OI R1] 左方之地", "background": "\n后记中将会详细描述帅神左方之地为何能成为「魔禁六帅」之首。\n\n如果你很奇怪题目名称里面为什么没有前方之风，那你可能应该去看看 div.2。\n\n但在此之前，你需要做一道构造题。\n", "description": "给你一个自然数 $n$ 和一个自然数参数 $k$，你需要构造一个长度为 $2^n$ 的序列 $a$，满足 $[0,2^n)$ 间的所有整数恰好出现一次，并且 $\\forall i\\in[2,2^n]$，$\\operatorname{popcount}(a_i \\oplus a_{i-1})=k$。  \n其中 $\\operatorname{popcount}(x)$ 表示 $x$ 在二进制下 $1$ 的个数，$\\oplus$ 表示[按位异或](https://oi-wiki.org/math/bit/#_1)运算。\n\n若有解则输出 `1` 并输出这个序列，否则输出 `0`。", "inputFormat": "一行两个整数 $n,k$，意义同题目描述。", "outputFormat": "第一行输出一个整数 `0` 或者 `1`，其中 `0` 代表不存在这样的序列，而 `1` 代表存在这样的序列。  \n如果第一行输出的是 `1`，接下来一行输出 $2^n$ 个整数，表示你构造的序列。如果有多个合法的序列，输出任意一个。", "hint": "**本题采用 Special Judge，子任务评测**。\n\n对于 $100\\%$ 的数据，保证 $1\\le n, k \\le 20$。\n\n| 子任务编号 | $n$     | $k$     | 子任务总分 |依赖子任务|\n| :--------: | :-----: | :-----: | :-------: | :-------: |\n| 0   | $\\le 4$ | $\\le 4$ | 5        ||\n| 1   | $\\le 8$ | $\\le 8$ | 25       |Subtask 0|\n| 2   |         | $=1$    | 10       ||\n| 3   |  | $=n-1$  | 15       ||\n| 4   |         |         | 45       |Subtask 0~3|\n\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/lipqunc4.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[✗✓OI R1] 左方之地", "background": "\n后记中将会详细描述帅神左方之地为何能成为「魔禁六帅」之首。\n\n如果你很奇怪题目名称里面为什么没有前方之风，那你可能应该去看看 div.2。\n\n但在此之前，你需要做一道构造题。\n", "description": "给你一个自然数 $n$ 和一个自然数参数 $k$，你需要构造一个长度为 $2^n$ 的序列 $a$，满足 $[0,2^n)$ 间的所有整数恰好出现一次，并且 $\\forall i\\in[2,2^n]$，$\\operatorname{popcount}(a_i \\oplus a_{i-1})=k$。  \n其中 $\\operatorname{popcount}(x)$ 表示 $x$ 在二进制下 $1$ 的个数，$\\oplus$ 表示[按位异或](https://oi-wiki.org/math/bit/#_1)运算。\n\n若有解则输出 `1` 并输出这个序列，否则输出 `0`。", "inputFormat": "一行两个整数 $n,k$，意义同题目描述。", "outputFormat": "第一行输出一个整数 `0` 或者 `1`，其中 `0` 代表不存在这样的序列，而 `1` 代表存在这样的序列。  \n如果第一行输出的是 `1`，接下来一行输出 $2^n$ 个整数，表示你构造的序列。如果有多个合法的序列，输出任意一个。", "hint": "**本题采用 Special Judge，子任务评测**。\n\n对于 $100\\%$ 的数据，保证 $1\\le n, k \\le 20$。\n\n| 子任务编号 | $n$     | $k$     | 子任务总分 |依赖子任务|\n| :--------: | :-----: | :-----: | :-------: | :-------: |\n| 0   | $\\le 4$ | $\\le 4$ | 5        ||\n| 1   | $\\le 8$ | $\\le 8$ | 25       |Subtask 0|\n| 2   |         | $=1$    | 10       ||\n| 3   |  | $=n-1$  | 15       ||\n| 4   |         |         | 45       |Subtask 0~3|\n\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/lipqunc4.png)", "locale": "zh-CN"}}}
{"pid": "P7950", "type": "P", "difficulty": 5, "samples": [["3\n2 6\n3 5\n4 7", "35\n45\n336"], ["5\n182565 710825096\n429580 541341177\n741770 757408347\n461909 941427258\n114514 1919810\n", "487324711\n256967112\n352532743\n962265551\n926494516\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["O2优化", "组合数学"], "title": "[✗✓OI R1] 后方之水", "background": "这个题目没有背景，因为我是圣人的同时还是神之右席。", "description": "定义一次石子合并的过程如下：有一排 $n$ 堆石子，每一堆有 $a_i(a_i\\ge1)$ 个。每次你可以选择相邻的两堆石子合并，设个数分别为 $x,y$，则你会得到一堆 $(x+y)$ 个石子，同时你要付出 $xy$ 的代价。最后要把所有石子合并成一堆。记 $f(a_1,\\ldots,a_n)$ 为合并这些石子的最小代价。\n\n给出石子总数 $S$，求\n$$ \\sum_{\\sum a_i=S}f(a_1,\\ldots,a_n) $$\n答案对 $998244353$ 取模。", "inputFormat": "**本题有多组测试数据。**\n\n第一行一个整数 $T$，表示测试数据的数量。  \n接下来 $T$ 行，每行两个整数，分别为 $n,S$。", "outputFormat": "$T$ 行，每行一个整数，表示答案对 $998244353$ 取模的结果。", "hint": "**【样例解释】**\n\n对第一个样例的第一组数据解释：  \n划分有 $(1,5),(2,4),(3,3),(4,2),(5,1)$，共 $5$ 种。  \n答案为 $1\\times 5 + 2 \\times 4 + 3 \\times 3 + 4 \\times 2 + 5 \\times 1 = 35$。\n\n**【数据范围】**\n\n| 测试点编号 |    $n$    |    $S$    \n| :--------: | :-------: | :-------: | \n| 1,2 |  $\\le15$  |  $\\le15$  |\n| 3,4 |  $\\le40$  |  $\\le40$  |\n| 5,6,7 |  $\\le70$  |  $\\le70$  | \n| 8,9 | $\\le200$  | $\\le200$  | \n| 10,11 | $\\le2000$ | $\\le2000$ | \n| 12,13,14 | $\\le10^6$ | $\\le10^6$ | \n| 15 |   $=2$    | $\\le10^9$ | \n| 16,17,18 | $\\le2000$ | $\\le10^9$ | \n| 19~25 | $\\le10^6$ | $\\le10^9$ |\n\n对于 $100\\%$ 的数据，有 $1\\le T\\le5$，$1\\le n\\le10^6$，$1\\le S\\le10^9$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/am5zu5e6.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[✗✓OI R1] 后方之水", "background": "这个题目没有背景，因为我是圣人的同时还是神之右席。", "description": "定义一次石子合并的过程如下：有一排 $n$ 堆石子，每一堆有 $a_i(a_i\\ge1)$ 个。每次你可以选择相邻的两堆石子合并，设个数分别为 $x,y$，则你会得到一堆 $(x+y)$ 个石子，同时你要付出 $xy$ 的代价。最后要把所有石子合并成一堆。记 $f(a_1,\\ldots,a_n)$ 为合并这些石子的最小代价。\n\n给出石子总数 $S$，求\n$$ \\sum_{\\sum a_i=S}f(a_1,\\ldots,a_n) $$\n答案对 $998244353$ 取模。", "inputFormat": "**本题有多组测试数据。**\n\n第一行一个整数 $T$，表示测试数据的数量。  \n接下来 $T$ 行，每行两个整数，分别为 $n,S$。", "outputFormat": "$T$ 行，每行一个整数，表示答案对 $998244353$ 取模的结果。", "hint": "**【样例解释】**\n\n对第一个样例的第一组数据解释：  \n划分有 $(1,5),(2,4),(3,3),(4,2),(5,1)$，共 $5$ 种。  \n答案为 $1\\times 5 + 2 \\times 4 + 3 \\times 3 + 4 \\times 2 + 5 \\times 1 = 35$。\n\n**【数据范围】**\n\n| 测试点编号 |    $n$    |    $S$    \n| :--------: | :-------: | :-------: | \n| 1,2 |  $\\le15$  |  $\\le15$  |\n| 3,4 |  $\\le40$  |  $\\le40$  |\n| 5,6,7 |  $\\le70$  |  $\\le70$  | \n| 8,9 | $\\le200$  | $\\le200$  | \n| 10,11 | $\\le2000$ | $\\le2000$ | \n| 12,13,14 | $\\le10^6$ | $\\le10^6$ | \n| 15 |   $=2$    | $\\le10^9$ | \n| 16,17,18 | $\\le2000$ | $\\le10^9$ | \n| 19~25 | $\\le10^6$ | $\\le10^9$ |\n\n对于 $100\\%$ 的数据，有 $1\\le T\\le5$，$1\\le n\\le10^6$，$1\\le S\\le10^9$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/am5zu5e6.png)", "locale": "zh-CN"}}}
