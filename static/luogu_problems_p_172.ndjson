{"pid": "P4479", "type": "P", "difficulty": 6, "samples": [["4 1\n-1 -1\n2 1\n3 3\n1 4", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2018", "二分", "树状数组", "离散化", "北京"], "title": "[BJWC2018] 第k大斜率", "background": "", "description": "在平面直角坐标系上，有 $n$ 个不同的点。任意两个不同的点确定了一条直线。请求出所有斜率存在的直线按斜率从大到小排序后，第 $k$ 条直线的斜率为多少。\n\n为了避免精度误差，请输出斜率向下取整后的结果。（例如：$\\lfloor 1.5 \\rfloor = 1$，$\\lfloor -1.5 \\rfloor = -2$）。", "inputFormat": "第一行，包含两个正整数 $n$ 和 $k$。  \n接下来 $n$ 行，每行包含两个整数 $x_i, y_i$，表示每个点的横纵坐标。", "outputFormat": "输出一行，包含一个整数，表示第 $k$ 大的斜率向下取整的结果。", "hint": "**【样例说明】**\n\n符合要求的直线的斜率分别为 $-3, -\\frac{1}{2}, \\frac{2}{3}, 1, 2, \\frac{5}{2}$ 。\n\n**【数据规模和约定】**\n\n令 $M$ 为所有斜率存在的直线的数量 。\n\n对于 $10 \\%$ 的数据，$1 \\le n \\le 10$。  \n对于 $20 \\%$ 的数据，$1 \\le n \\le 100$，$|x_i|, |y_i| \\le {10}^3$。  \n对于 $30 \\%$ 的数据，$1 \\le n \\le 1000$。  \n对于 $40 \\%$ 的数据，$1 ≤ n ≤ 5000$。  \n对于另 $20 \\%$ 的数据，满足 $k = 1$ 。  \n对于另 $20 \\%$ 的数据，满足 $1 \\le x_i, y_i \\le {10}^3$。  \n对于 $100 \\%$ 的数据，$1 \\le n \\le 100000$，$1 \\le k \\le M$，$|x_i|, |y_i| \\le {10}^8$。", "locale": "zh-CN", "translations": {"en": {"title": "[BJWC2018] The k-th Largest Slope", "background": "", "description": "On the 2D Cartesian plane, there are $n$ distinct points. Any two distinct points determine a line. Among all lines whose slopes are defined, sort them by slope in descending order and find the slope of the $k$-th line.\n\nTo avoid precision errors, please output the floor of the slope. (For example: $\\lfloor 1.5 \\rfloor = 1$, $\\lfloor -1.5 \\rfloor = -2$.)", "inputFormat": "The first line contains two positive integers $n$ and $k$.  \nEach of the next $n$ lines contains two integers $x_i, y_i$, the coordinates of a point.", "outputFormat": "Output one line containing an integer: the floor of the $k$-th largest slope.", "hint": "[Sample Explanation]\n\nThe slopes of the lines that meet the requirement are $-3, -\\frac{1}{2}, \\frac{2}{3}, 1, 2, \\frac{5}{2}$.\n\n[Constraints]\n\nLet $M$ be the number of lines whose slopes are defined.\n\n- For $10\\%$ of the testdata, $1 \\le n \\le 10$.\n- For $20\\%$ of the testdata, $1 \\le n \\le 100$, $|x_i|, |y_i| \\le 10^3$.\n- For $30\\%$ of the testdata, $1 \\le n \\le 1000$.\n- For $40\\%$ of the testdata, $1 \\le n \\le 5000$.\n- For another $20\\%$ of the testdata, $k = 1$.\n- For another $20\\%$ of the testdata, $1 \\le x_i, y_i \\le 10^3$.\n- For $100\\%$ of the testdata, $1 \\le n \\le 100000$, $1 \\le k \\le M$, $|x_i|, |y_i| \\le 10^8$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJWC2018] 第k大斜率", "background": "", "description": "在平面直角坐标系上，有 $n$ 个不同的点。任意两个不同的点确定了一条直线。请求出所有斜率存在的直线按斜率从大到小排序后，第 $k$ 条直线的斜率为多少。\n\n为了避免精度误差，请输出斜率向下取整后的结果。（例如：$\\lfloor 1.5 \\rfloor = 1$，$\\lfloor -1.5 \\rfloor = -2$）。", "inputFormat": "第一行，包含两个正整数 $n$ 和 $k$。  \n接下来 $n$ 行，每行包含两个整数 $x_i, y_i$，表示每个点的横纵坐标。", "outputFormat": "输出一行，包含一个整数，表示第 $k$ 大的斜率向下取整的结果。", "hint": "**【样例说明】**\n\n符合要求的直线的斜率分别为 $-3, -\\frac{1}{2}, \\frac{2}{3}, 1, 2, \\frac{5}{2}$ 。\n\n**【数据规模和约定】**\n\n令 $M$ 为所有斜率存在的直线的数量 。\n\n对于 $10 \\%$ 的数据，$1 \\le n \\le 10$。  \n对于 $20 \\%$ 的数据，$1 \\le n \\le 100$，$|x_i|, |y_i| \\le {10}^3$。  \n对于 $30 \\%$ 的数据，$1 \\le n \\le 1000$。  \n对于 $40 \\%$ 的数据，$1 ≤ n ≤ 5000$。  \n对于另 $20 \\%$ 的数据，满足 $k = 1$ 。  \n对于另 $20 \\%$ 的数据，满足 $1 \\le x_i, y_i \\le {10}^3$。  \n对于 $100 \\%$ 的数据，$1 \\le n \\le 100000$，$1 \\le k \\le M$，$|x_i|, |y_i| \\le {10}^8$。", "locale": "zh-CN"}}}
{"pid": "P4480", "type": "P", "difficulty": 7, "samples": [["4 1 2 2 1 3\n8\n2\n1\n6", "35"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2018", "网络流", "北京", "最短路", "队列"], "title": "[BJWC2018] 餐巾计划问题", "background": "**本题和网络流24题中的餐巾计划不为重题**", "description": "一个餐厅在相继的 $n$ 天里，每天需用的餐巾数不尽相同。假设第 $i$ 天 $(i=1, 2, ..., n)$ 需要 $r_i$ 块餐巾。餐厅可以在任意时刻购买新的餐巾，每块餐巾的费用为 $p$ 。使用过的旧餐巾，则需要经过清洗才能重新使用。把一块旧餐巾送到清洗店A，需要等待 $m_1$ 天后才能拿到新餐巾，其费用为 $c_1$ ；把一块旧餐巾送到清洗店B，需要等待 $m_2$ 天后才能拿到新餐巾，其费用为 $c_2$ 。例如，将一块第 $k$ 天使用过的餐巾送到清洗店A清洗，则可以在第 $k+m_1$ 天使用。\n\n请为餐厅合理地安排好 $n$ 天中餐巾使用计划，使总的花费最小。", "inputFormat": "第一行，包含六个个正整数  $n, m_1, m_2, c_1, c_2, p$ 。\n\n接下来输入 $n$ 行，每行包含一个正整数 $r_i$ 。", "outputFormat": "输出一行，包含一个正整数，表示最小的总花费。", "hint": "**【样例说明】**\n\n第 1 天：买8块餐巾，花费24。送2块餐巾去清洗店A，6块餐巾去清洗店B。\n\n第 2 天：取回2块清洗店A的餐巾，花费4。送1块餐巾去清洗店B。\n\n第 3 天：取回6块清洗店B的餐巾，花费6。\n\n第 4 天：取回1块清洗店B的餐巾，花费1。这样就用了最少的钱。\n\n\n**【数据规模和约定】**\n\n对于30%的数据，$1 \\leq n \\leq 5$ ，$1 \\leq c_1, c_2, p \\leq 5$ ， $1 \\leq r_i \\leq 5$ 。\n\n对于50%的数据，$1 \\leq n \\leq 100$ ，$1 \\leq r_i \\leq 50$ 。\n\n对于70%的数据，$1 \\leq n \\leq 5000$ 。\n\n对于100%的数据，$1 \\leq n \\leq 200000$ ， $1 \\leq m_1, m_2 \\leq n$ ， $1 \\leq c_1, c_2, p \\leq 100$ ， $1 \\leq r_i \\leq 100$ 。", "locale": "zh-CN", "translations": {"en": {"title": "[BJWC2018] Napkin Planning Problem", "background": "This problem is not the same as the Napkin Plan in the 24 Network Flow Problems.", "description": "A restaurant requires a varying number of napkins over $n$ consecutive days. Suppose on day $i$ ($i = 1, 2, \\ldots, n$) it needs $r_i$ napkins. The restaurant can purchase new napkins at any time, at a cost of $p$ per napkin. Used napkins must be washed before reuse. Sending one used napkin to laundry A returns it after $m_1$ days at a cost of $c_1$; sending one used napkin to laundry B returns it after $m_2$ days at a cost of $c_2$. For example, a napkin used on day $k$ and sent to laundry A can be used on day $k+m_1$.\n\nArrange the napkin usage plan over $n$ days to minimize the total cost.", "inputFormat": "The first line contains six positive integers $n, m_1, m_2, c_1, c_2, p$.\n\nThe next $n$ lines each contain a positive integer $r_i$.", "outputFormat": "Output one line containing a single positive integer, the minimum total cost.", "hint": "【Sample Explanation】\n\nDay 1: Buy 8 napkins, costing 24. Send 2 napkins to laundry A and 6 napkins to laundry B.\n\nDay 2: Take back 2 napkins from laundry A, costing 4. Send 1 napkin to laundry B.\n\nDay 3: Take back 6 napkins from laundry B, costing 6.\n\nDay 4: Take back 1 napkin from laundry B, costing 1. This achieves the minimum cost.\n\n【Constraints】\n\nFor 30% of the testdata, $1 \\leq n \\leq 5$, $1 \\leq c_1, c_2, p \\leq 5$, $1 \\leq r_i \\leq 5$.\n\nFor 50% of the testdata, $1 \\leq n \\leq 100$, $1 \\leq r_i \\leq 50$.\n\nFor 70% of the testdata, $1 \\leq n \\leq 5000$.\n\nFor 100% of the testdata, $1 \\leq n \\leq 200000$, $1 \\leq m_1, m_2 \\leq n$, $1 \\leq c_1, c_2, p \\leq 100$, $1 \\leq r_i \\leq 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJWC2018] 餐巾计划问题", "background": "**本题和网络流24题中的餐巾计划不为重题**", "description": "一个餐厅在相继的 $n$ 天里，每天需用的餐巾数不尽相同。假设第 $i$ 天 $(i=1, 2, ..., n)$ 需要 $r_i$ 块餐巾。餐厅可以在任意时刻购买新的餐巾，每块餐巾的费用为 $p$ 。使用过的旧餐巾，则需要经过清洗才能重新使用。把一块旧餐巾送到清洗店A，需要等待 $m_1$ 天后才能拿到新餐巾，其费用为 $c_1$ ；把一块旧餐巾送到清洗店B，需要等待 $m_2$ 天后才能拿到新餐巾，其费用为 $c_2$ 。例如，将一块第 $k$ 天使用过的餐巾送到清洗店A清洗，则可以在第 $k+m_1$ 天使用。\n\n请为餐厅合理地安排好 $n$ 天中餐巾使用计划，使总的花费最小。", "inputFormat": "第一行，包含六个个正整数  $n, m_1, m_2, c_1, c_2, p$ 。\n\n接下来输入 $n$ 行，每行包含一个正整数 $r_i$ 。", "outputFormat": "输出一行，包含一个正整数，表示最小的总花费。", "hint": "**【样例说明】**\n\n第 1 天：买8块餐巾，花费24。送2块餐巾去清洗店A，6块餐巾去清洗店B。\n\n第 2 天：取回2块清洗店A的餐巾，花费4。送1块餐巾去清洗店B。\n\n第 3 天：取回6块清洗店B的餐巾，花费6。\n\n第 4 天：取回1块清洗店B的餐巾，花费1。这样就用了最少的钱。\n\n\n**【数据规模和约定】**\n\n对于30%的数据，$1 \\leq n \\leq 5$ ，$1 \\leq c_1, c_2, p \\leq 5$ ， $1 \\leq r_i \\leq 5$ 。\n\n对于50%的数据，$1 \\leq n \\leq 100$ ，$1 \\leq r_i \\leq 50$ 。\n\n对于70%的数据，$1 \\leq n \\leq 5000$ 。\n\n对于100%的数据，$1 \\leq n \\leq 200000$ ， $1 \\leq m_1, m_2 \\leq n$ ， $1 \\leq c_1, c_2, p \\leq 100$ ， $1 \\leq r_i \\leq 100$ 。", "locale": "zh-CN"}}}
{"pid": "P4481", "type": "P", "difficulty": 5, "samples": [["3\n3 2 2\n1 2 3\n3 2 3\n1 2 3\n4 3 3\n1 2 3 4", "9\n6\n0"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "2018", "北京", "区间 DP"], "title": "[BJWC2018] 序列合并", "background": "绿意盎然的一天，Scape 去 XX 赛区加冕为王。", "description": "Scape 倒开题目，看到了这样一道题：\n\n有一个序列 $A$ 和 $L,R$，每次可以合并相邻的 $K$ 个元素（要求 $L\\leq K\\leq R$），代价为这 $K$ 个元素的和并合并产生一个新元素，权值为这 $K$ 个元素的和。\n\n求把整个序列合并为一个元素的最小代价。\n\nScape 想都不想就写了一个 $\\mathcal{O}(n^4)$ 暴力，结果居然 T 了，作为 XX 之王的 Scape 自然不会管这种辣鸡题，请你写出这道题。", "inputFormat": "第一行一个整数 $T$，表示数据组数。\n\n每组数据第一行三个整数 $n,L,R$ 表示序列 $A$ 的长度，和 $K$ 的上下界限制。\n\n第二行 $n$ 个整数表示序列 $A$。", "outputFormat": "每行一个整数表示结果，无解输出 $0$。", "hint": "对于 $20\\%$ 的数据， $n\\le 20$。\n\n对于 $60\\%$ 的数据， $n\\le 50$。\n\n对于 $100\\%$ 的数据， $1\\le T\\le 10,n\\le 300,A_i\\le 100$。", "locale": "zh-CN", "translations": {"en": {"title": "[BJWC2018] Sequence Merging", "background": "On a verdant day, Scape went to the XX division to be crowned king.", "description": "Scape flipped open the problemset and saw this problem:\n\nThere is a sequence $A$ and $L, R$. At each step, you may merge $K$ adjacent elements (with $L \\le K \\le R$). The cost is the sum of those $K$ elements, and the merge produces a new element whose value is that same sum.\n\nFind the minimum cost to merge the entire sequence into one element.\n\nWithout thinking, Scape wrote an $\\mathcal{O}(n^4)$ brute force, which actually timed out (TLE). As the king of XX, Scape naturally will not bother with such a “trash” problem; please solve it.", "inputFormat": "The first line contains an integer $T$, the number of test cases.\n\nFor each test case, the first line contains three integers $n, L, R$, denoting the length of sequence $A$ and the bounds on $K$.\n\nThe second line contains $n$ integers, the sequence $A$.", "outputFormat": "For each test case, output one integer — the answer. If it is impossible, output $0$.", "hint": "Constraints:\n- For $20\\%$ of the testdata, $n \\le 20$.\n- For $60\\%$ of the testdata, $n \\le 50$.\n- For $100\\%$ of the testdata, $1 \\le T \\le 10$, $n \\le 300$, $A_i \\le 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJWC2018] 序列合并", "background": "绿意盎然的一天，Scape 去 XX 赛区加冕为王。", "description": "Scape 倒开题目，看到了这样一道题：\n\n有一个序列 $A$ 和 $L,R$，每次可以合并相邻的 $K$ 个元素（要求 $L\\leq K\\leq R$），代价为这 $K$ 个元素的和并合并产生一个新元素，权值为这 $K$ 个元素的和。\n\n求把整个序列合并为一个元素的最小代价。\n\nScape 想都不想就写了一个 $\\mathcal{O}(n^4)$ 暴力，结果居然 T 了，作为 XX 之王的 Scape 自然不会管这种辣鸡题，请你写出这道题。", "inputFormat": "第一行一个整数 $T$，表示数据组数。\n\n每组数据第一行三个整数 $n,L,R$ 表示序列 $A$ 的长度，和 $K$ 的上下界限制。\n\n第二行 $n$ 个整数表示序列 $A$。", "outputFormat": "每行一个整数表示结果，无解输出 $0$。", "hint": "对于 $20\\%$ 的数据， $n\\le 20$。\n\n对于 $60\\%$ 的数据， $n\\le 50$。\n\n对于 $100\\%$ 的数据， $1\\le T\\le 10,n\\le 300,A_i\\le 100$。", "locale": "zh-CN"}}}
{"pid": "P4482", "type": "P", "difficulty": 7, "samples": [["abbabbaa\n3\n1 8\n1 7\n2 7", "1\n4\n3"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2018", "北京", "O2优化"], "title": "[BJWC2018] Border 的四种求法", "background": "Scape 一到机房，所有做题的人便都看着他笑，有的叫道，“Scape，你一定又被标准分倍杀了！”他不回答，对柜里说，“测两个程序，看一眼成绩单。”便拷出两个程序。他们又故意的高声嚷道，“你怎么欧拉回路和逆序对都WA了！”……", "description": "Scape 知道，以上的故事只是 OI 生涯里的一个意外，为了证明自己，他决定教你 $\\text{Border}$ 的四种求法。\n\n给一个小写字母字符串 $S$，$q$ 次询问每次给出 $l,r$ ，求 $s_{l\\ldots r}$ 的 $\\text{Border}$。\n\n$\\text{Border}$：对于给定的串 $s$，最大的 $i$ 使得 $s_{1\\ldots i} = s_{|s|-i+1\\ldots |s|}$。$|s|$ 为 $s$ 的长度。", "inputFormat": "第一行一个字符串 $S$。\n\n第二行一个整数 $q$ 表示询问个数。\n\n接下来的 $q$ 行每行两个整数 $l,r$ 表示一个询问。", "outputFormat": "对于每组询问输出答案。", "hint": "对于 $30%$ 的数据， $n,q\\leq 1000$ 。\n\n对于 $50%$ 的数据， $n,q\\leq 2\\times 10^4$ 。\n\n对于另外 $30\\%$ 的数据，答案至少为 $r-l+1$ 的一半。\n\n对于 $100\\%$ 的数据， $n,q\\leq 2\\times 10^5$ 。", "locale": "zh-CN", "translations": {"en": {"title": "[BJWC2018] Four Methods to Compute Border", "background": "As soon as Scape walked into the computer lab, everyone solving problems looked at him and laughed. Someone shouted, \"Scape, you must have been crushed by the standard score again!\" He did not answer; he said, \"Run two programs, check the score sheet,\" and then he copied out two programs. They deliberately shouted again, \"How did you get WA on both the Euler circuit and inversions?\" ...", "description": "Scape knows that the story above is just an accident in his OI career. To prove himself, he decides to teach you four methods to compute $\\text{Border}$.\n\nGiven a lowercase-letter string $S$, there are $q$ queries. Each query gives $l, r$, and asks for the $\\text{Border}$ of $s_{l\\ldots r}$.\n\n$\\text{Border}$: For a given string $s$, the largest $i$ such that $s_{1\\ldots i} = s_{|s|-i+1\\ldots |s|}$. Here $|s|$ is the length of $s$.", "inputFormat": "The first line contains a string $S$.\n\nThe second line contains an integer $q$ denoting the number of queries.\n\nEach of the next $q$ lines contains two integers $l, r$ denoting a query.", "outputFormat": "For each query, output the answer.", "hint": "- For $30\\%$ of the testdata, $n, q \\le 1000$.\n- For $50\\%$ of the testdata, $n, q \\le 2\\times 10^4$.\n- For another $30\\%$ of the testdata, the answer is at least half of $r - l + 1$.\n- For $100\\%$ of the testdata, $n, q \\le 2\\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJWC2018] Border 的四种求法", "background": "Scape 一到机房，所有做题的人便都看着他笑，有的叫道，“Scape，你一定又被标准分倍杀了！”他不回答，对柜里说，“测两个程序，看一眼成绩单。”便拷出两个程序。他们又故意的高声嚷道，“你怎么欧拉回路和逆序对都WA了！”……", "description": "Scape 知道，以上的故事只是 OI 生涯里的一个意外，为了证明自己，他决定教你 $\\text{Border}$ 的四种求法。\n\n给一个小写字母字符串 $S$，$q$ 次询问每次给出 $l,r$ ，求 $s_{l\\ldots r}$ 的 $\\text{Border}$。\n\n$\\text{Border}$：对于给定的串 $s$，最大的 $i$ 使得 $s_{1\\ldots i} = s_{|s|-i+1\\ldots |s|}$。$|s|$ 为 $s$ 的长度。", "inputFormat": "第一行一个字符串 $S$。\n\n第二行一个整数 $q$ 表示询问个数。\n\n接下来的 $q$ 行每行两个整数 $l,r$ 表示一个询问。", "outputFormat": "对于每组询问输出答案。", "hint": "对于 $30%$ 的数据， $n,q\\leq 1000$ 。\n\n对于 $50%$ 的数据， $n,q\\leq 2\\times 10^4$ 。\n\n对于另外 $30\\%$ 的数据，答案至少为 $r-l+1$ 的一半。\n\n对于 $100\\%$ 的数据， $n,q\\leq 2\\times 10^5$ 。", "locale": "zh-CN"}}}
{"pid": "P4483", "type": "P", "difficulty": 6, "samples": [["65432", "01:08 03:40 13:52"], ["1", "00:01 00:01 00:01"], ["58", "00:01 00:02 00:01"], ["2000000000", "-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "北京"], "title": "[BJWC2018] 神奇的钟点", "background": "", "description": "一天，小 L 看到了 3 块钟表，分别显示着 $\\texttt{01:08}$、$\\texttt{03:40}$、$\\texttt{13:52}$。小 L 发现，每块表上的时间都是 $\\texttt{hh:mm}$ 的形式，其中 $\\texttt{hh}$ 表示小时，$\\texttt{mm}$ 表示分钟，而且都不是整点（即 $0\\leqslant\\texttt{hh}<24$，$1\\leqslant\\texttt{mm}<60$）。\n\n回想起小学数学老师刚刚讲的关于比例的知识，$\\texttt{hh:mm}$ 也表示一个比，它的值等于 $\\frac{\\texttt{hh}}{\\texttt{mm}}$。这时小 L 发现了一件神奇的事情：把这三个钟点加起来会得到 $\\texttt{18:40}$，这也是一个不是整点的合法时间（注意小时数要小于 $24$），它对应的比值 $\\frac{9}{20}$，与这三个钟点对应的比值 $\\frac{1}{8}$、$\\frac{3}{40}$、$\\frac{1}{4}$ 之和竟然相等！\n\n现在小 L 想知道，把所有的满足这个神奇的性质的 3 个钟点组成的钟点组按照字典序排序后，第 $k$ 小的是什么。", "inputFormat": "输入仅包含一个正整数 $k$。", "outputFormat": "输出字典序第 $k$ 小的满足题目所述神奇性质的钟点组，以一个空格隔开，详见样例输出。如果答案不存在，输出 `-1`。", "hint": "**【样例说明】**\n\n注意钟点可以相同。\n\n**【数据规模和约定】**\n\n对于 $30\\%$ 的数据，$k\\leqslant 1000$。  \n对于 $60\\%$ 的数据，$k\\leqslant 20000$。  \n对于 $100\\%$ 的数据，$1\\leqslant k\\leqslant 2\\times 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[BJWC2018] Magical Clock Times", "background": "", "description": "One day, Xiao L saw three clocks showing $\\texttt{01:08}$, $\\texttt{03:40}$, and $\\texttt{13:52}$. Xiao L noticed that each time is in the form $\\texttt{hh:mm}$, where $\\texttt{hh}$ is the hour and $\\texttt{mm}$ is the minute, and none of them is on the hour (i.e., $0\\leqslant\\texttt{hh}<24$, $1\\leqslant\\texttt{mm}<60$).\n\nRecalling a lesson about ratios, $\\texttt{hh:mm}$ also represents a ratio with value $\\frac{\\texttt{hh}}{\\texttt{mm}}$. Then Xiao L discovered something magical: adding these three times yields $\\texttt{18:40}$, which is also a valid time that is not on the hour (note the hour must be less than $24$). Its corresponding ratio $\\frac{9}{20}$ is exactly equal to the sum of the ratios $\\frac{1}{8}$, $\\frac{3}{40}$, and $\\frac{1}{4}$ of the three times!\n\nNow Xiao L wants to know: among all triplets of times that satisfy this magical property, sorted in lexicographic order, what is the $k$-th smallest?", "inputFormat": "The input contains only a single positive integer $k$.", "outputFormat": "Output the $k$-th smallest triplet that satisfies the magical property described in the statement, with the three times separated by a space; see the sample output. If the answer does not exist, output `-1`.", "hint": "【Sample Explanation】\n\nNote that the times may be identical.\n\n【Constraints】\n\nFor $30\\%$ of the testdata, $k\\leqslant 1000$.  \nFor $60\\%$ of the testdata, $k\\leqslant 20000$.  \nFor $100\\%$ of the testdata, $1\\leqslant k\\leqslant 2\\times 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJWC2018] 神奇的钟点", "background": "", "description": "一天，小 L 看到了 3 块钟表，分别显示着 $\\texttt{01:08}$、$\\texttt{03:40}$、$\\texttt{13:52}$。小 L 发现，每块表上的时间都是 $\\texttt{hh:mm}$ 的形式，其中 $\\texttt{hh}$ 表示小时，$\\texttt{mm}$ 表示分钟，而且都不是整点（即 $0\\leqslant\\texttt{hh}<24$，$1\\leqslant\\texttt{mm}<60$）。\n\n回想起小学数学老师刚刚讲的关于比例的知识，$\\texttt{hh:mm}$ 也表示一个比，它的值等于 $\\frac{\\texttt{hh}}{\\texttt{mm}}$。这时小 L 发现了一件神奇的事情：把这三个钟点加起来会得到 $\\texttt{18:40}$，这也是一个不是整点的合法时间（注意小时数要小于 $24$），它对应的比值 $\\frac{9}{20}$，与这三个钟点对应的比值 $\\frac{1}{8}$、$\\frac{3}{40}$、$\\frac{1}{4}$ 之和竟然相等！\n\n现在小 L 想知道，把所有的满足这个神奇的性质的 3 个钟点组成的钟点组按照字典序排序后，第 $k$ 小的是什么。", "inputFormat": "输入仅包含一个正整数 $k$。", "outputFormat": "输出字典序第 $k$ 小的满足题目所述神奇性质的钟点组，以一个空格隔开，详见样例输出。如果答案不存在，输出 `-1`。", "hint": "**【样例说明】**\n\n注意钟点可以相同。\n\n**【数据规模和约定】**\n\n对于 $30\\%$ 的数据，$k\\leqslant 1000$。  \n对于 $60\\%$ 的数据，$k\\leqslant 20000$。  \n对于 $100\\%$ 的数据，$1\\leqslant k\\leqslant 2\\times 10^9$。", "locale": "zh-CN"}}}
{"pid": "P4484", "type": "P", "difficulty": 6, "samples": [["1\n", "1\n"], ["2\n", "499122178\n"], ["3\n", "2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "北京", "差分", "杨表", "状压 DP"], "title": "[BJWC2018] 最长上升子序列", "background": "", "description": "现在有一个长度为 $n$ 的随机排列，求它的最长上升子序列长度的期望。\n\n为了避免精度误差，你只需要输出答案模 $998244353$ 的余数。", "inputFormat": "输入只包含一个正整数 $n$。", "outputFormat": "输出只包含一个非负整数，表示答案模 $998244353$ 的余数。\n\n可以证明，答案一定为有理数，设其为 $a/b$（$a, b$ 为互质的整数），你输出的整数为 $x$，则你需要保证 $0 \\le x < 998244353$ 且 $a$ 与 $b x$ 模 $998244353$ 同余。", "hint": "**【样例 \\#2 说明】**\n\n这是 $3/2$。\n\n**【数据规模和约定】**\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le 28$。\n\n共有 25 组数据，对于第 $i$ 组数据（$1 \\le i \\le 25$），$n = i + 3$。", "locale": "zh-CN", "translations": {"en": {"title": "[BJWC2018] Longest Increasing Subsequence", "background": "", "description": "Given a uniformly random permutation of length $n$, compute the expected length of its longest increasing subsequence.\n\nTo avoid precision errors, you only need to output the answer modulo $998244353$.", "inputFormat": "The input contains a single positive integer $n$.", "outputFormat": "Output a single non-negative integer, the remainder of the answer modulo $998244353$.\n\nIt can be proved that the answer is a rational number; let it be $a/b$ ($a, b$ are coprime integers). Let the integer you output be $x$. You must ensure $0 \\le x < 998244353$ and $a \\equiv b x \\pmod{998244353}$.", "hint": "Sample #2 Explanation:\n\nThis is $3/2$.\n\nConstraints:\n\n- For $100\\%$ of the data, $1 \\le n \\le 28$.\n- There are 25 testcases. For the $i$-th testcase ($1 \\le i \\le 25$), $n = i + 3$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJWC2018] 最长上升子序列", "background": "", "description": "现在有一个长度为 $n$ 的随机排列，求它的最长上升子序列长度的期望。\n\n为了避免精度误差，你只需要输出答案模 $998244353$ 的余数。", "inputFormat": "输入只包含一个正整数 $n$。", "outputFormat": "输出只包含一个非负整数，表示答案模 $998244353$ 的余数。\n\n可以证明，答案一定为有理数，设其为 $a/b$（$a, b$ 为互质的整数），你输出的整数为 $x$，则你需要保证 $0 \\le x < 998244353$ 且 $a$ 与 $b x$ 模 $998244353$ 同余。", "hint": "**【样例 \\#2 说明】**\n\n这是 $3/2$。\n\n**【数据规模和约定】**\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le 28$。\n\n共有 25 组数据，对于第 $i$ 组数据（$1 \\le i \\le 25$），$n = i + 3$。", "locale": "zh-CN"}}}
{"pid": "P4485", "type": "P", "difficulty": 0, "samples": [["4 4 4\n1 2 3 4", "1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "北京"], "title": "[BJWC2018] 拓扑序列", "background": "", "description": "小 C 最近学习了拓扑排序的相关知识。对一个有向无环图 $G$ 进行拓扑排序，是将 $G$ 中所有顶点排成一个线性序列，使得对图 $G$ 中任意一条有向边 $(u,v)$，$u$ 在线性序列中出现在 $v$ 之前。例如，如果图 $G$ 的点集为 $\\{1,2,3,4\\}$，边集为 $\\{(1,2)\n,(1,3),(2,4),(3,4)\\}$，那么 $(1,2,3,4)$ 和 $(1,3,2,4)$ 都是图 $G$ 的拓扑序列。\n\n现在小 C 对一个简单（无重边）有向无环图进行了拓扑排序，但不小心把原图弄丢了。除了拓扑序列，小 C 只记得原图的边数为 $k$，而且图中存在一个顶点 $u$ 可以到达其他所有顶点。他想知道有多少个满足上述要求的简单有向无环图。由于答案可能很大，你只需要输出答案模 $m$ 的余数。", "inputFormat": "输入第一行包含三个整数 $n,k,m$。\n\n第二行是空格隔开的 $n$ 个正整数 $a_1,a_2,…,a_n$，表示原图的一个拓扑序列，保证是 $1$ 到 $n$ 的一个排列。\t", "outputFormat": "仅输出一个整数， 表示满足要求的简单有向无环图个数模 $m$ 的余数。", "hint": "**【样例说明】**\n\n共有 $9$ 个满足要求的简单有向无环图，边集分别为：\n\n$\\{(1, 2), (1, 3), (1, 4), (2, 3)\\}$\n\n$\\{(1, 2), (1, 3), (1, 4), (2, 4)\\}$\n\n$\\{(1, 2), (1, 3), (1, 4), (3, 4)\\}$\n\n$\\{(1, 2), (1, 3), (2, 3), (2, 4)\\}$\n\n$\\{(1, 2), (1, 3), (2, 3), (3, 4)\\}$\n\n$\\{(1, 2), (1, 3), (2, 4), (3, 4)\\}$\n\n$\\{(1, 2), (1, 4), (2, 3), (2, 4)\\}$\n\n$\\{(1, 2), (1, 4), (2, 3), (3, 4)\\}$\n\n$\\{(1, 2), (2, 3), (2, 4), (3, 4)\\}$\n\n**【数据规模和约定】**\n\n对于 $100\\%$ 的数据 ，$0 \\le k \\le n \\le 2\\times 10^5$，$1 \\leq m \\leq 10^{200000}$。\n\n![](https://cdn.luogu.com.cn/upload/pic/17945.png)", "locale": "zh-CN", "translations": {"en": {"title": "[BJWC2018] Topological Sequence", "background": "", "description": "Xiao C recently learned about topological sorting. Performing a topological sort on a directed acyclic graph $G$ means arranging all vertices of $G$ into a linear order such that for any directed edge $(u, v)$ in $G$, $u$ appears before $v$ in the linear order. For example, if the vertex set of $G$ is $\\{1,2,3,4\\}$ and the edge set is $\\{(1,2)\n,(1,3),(2,4),(3,4)\\}$, then $(1,2,3,4)$ and $(1,3,2,4)$ are both topological sequences of $G$.\n\nNow Xiao C performed a topological sort on a simple (no multiple edges) directed acyclic graph, but accidentally lost the original graph. Besides the topological sequence, he only remembers that the original graph has $k$ edges, and that there exists a vertex $u$ that can reach all other vertices in the graph. He wants to know how many simple directed acyclic graphs satisfy the above requirements. Since the answer may be large, you only need to output the answer modulo $m$.", "inputFormat": "The first line contains three integers $n, k, m$.\n\nThe second line contains $n$ space-separated positive integers $a_1, a_2, \\dots, a_n$, representing a topological sequence of the original graph, guaranteed to be a permutation of $1$ to $n$.", "outputFormat": "Output a single integer, the remainder modulo $m$ of the number of simple directed acyclic graphs that satisfy the requirements.", "hint": "【Sample Explanation】\n\nThere are $9$ simple directed acyclic graphs that satisfy the requirements. Their edge sets are:\n\n$\\{(1, 2), (1, 3), (1, 4), (2, 3)\\}$\n\n$\\{(1, 2), (1, 3), (1, 4), (2, 4)\\}$\n\n$\\{(1, 2), (1, 3), (1, 4), (3, 4)\\}$\n\n$\\{(1, 2), (1, 3), (2, 3), (2, 4)\\}$\n\n$\\{(1, 2), (1, 3), (2, 3), (3, 4)\\}$\n\n$\\{(1, 2), (1, 3), (2, 4), (3, 4)\\}$\n\n$\\{(1, 2), (1, 4), (2, 3), (2, 4)\\}$\n\n$\\{(1, 2), (1, 4), (2, 3), (3, 4)\\}$\n\n$\\{(1, 2), (2, 3), (2, 4), (3, 4)\\}$\n\nConstraints\n\nFor $100\\%$ of the testdata, $0 \\le k \\le n \\le 2 \\times 10^5$, $1 \\le m \\le 10^{200000}$.\n\n![](https://cdn.luogu.com.cn/upload/pic/17945.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJWC2018] 拓扑序列", "background": "", "description": "小 C 最近学习了拓扑排序的相关知识。对一个有向无环图 $G$ 进行拓扑排序，是将 $G$ 中所有顶点排成一个线性序列，使得对图 $G$ 中任意一条有向边 $(u,v)$，$u$ 在线性序列中出现在 $v$ 之前。例如，如果图 $G$ 的点集为 $\\{1,2,3,4\\}$，边集为 $\\{(1,2)\n,(1,3),(2,4),(3,4)\\}$，那么 $(1,2,3,4)$ 和 $(1,3,2,4)$ 都是图 $G$ 的拓扑序列。\n\n现在小 C 对一个简单（无重边）有向无环图进行了拓扑排序，但不小心把原图弄丢了。除了拓扑序列，小 C 只记得原图的边数为 $k$，而且图中存在一个顶点 $u$ 可以到达其他所有顶点。他想知道有多少个满足上述要求的简单有向无环图。由于答案可能很大，你只需要输出答案模 $m$ 的余数。", "inputFormat": "输入第一行包含三个整数 $n,k,m$。\n\n第二行是空格隔开的 $n$ 个正整数 $a_1,a_2,…,a_n$，表示原图的一个拓扑序列，保证是 $1$ 到 $n$ 的一个排列。\t", "outputFormat": "仅输出一个整数， 表示满足要求的简单有向无环图个数模 $m$ 的余数。", "hint": "**【样例说明】**\n\n共有 $9$ 个满足要求的简单有向无环图，边集分别为：\n\n$\\{(1, 2), (1, 3), (1, 4), (2, 3)\\}$\n\n$\\{(1, 2), (1, 3), (1, 4), (2, 4)\\}$\n\n$\\{(1, 2), (1, 3), (1, 4), (3, 4)\\}$\n\n$\\{(1, 2), (1, 3), (2, 3), (2, 4)\\}$\n\n$\\{(1, 2), (1, 3), (2, 3), (3, 4)\\}$\n\n$\\{(1, 2), (1, 3), (2, 4), (3, 4)\\}$\n\n$\\{(1, 2), (1, 4), (2, 3), (2, 4)\\}$\n\n$\\{(1, 2), (1, 4), (2, 3), (3, 4)\\}$\n\n$\\{(1, 2), (2, 3), (2, 4), (3, 4)\\}$\n\n**【数据规模和约定】**\n\n对于 $100\\%$ 的数据 ，$0 \\le k \\le n \\le 2\\times 10^5$，$1 \\leq m \\leq 10^{200000}$。\n\n![](https://cdn.luogu.com.cn/upload/pic/17945.png)", "locale": "zh-CN"}}}
{"pid": "P4486", "type": "P", "difficulty": 7, "samples": [["8 8\n0 1 1 0 0 1 1 1\n2 4 4 0 3 4 4 4\n2 4 4 3 4 4 4 4\n2 4 4 4 4 4 1 0\n0 2 4 4 3 4 4 1\n0 1 3 4 4 4 4 4\n2 4 4 4 4 2 4 4\n2 4 4 4 0 2 4 4\n23 30 27 12 16\n16 9 7 17 24 8 7 9\n17 8 9 15 29 8 9 5 7\n35 6 8 5 9 7 12\n7 6 1 7 8 2 6 7\n11 10 16 4 6 1 3 2\n21 8 9 3 1 5 1 4\n6 3 1 2 3 2 1\n-1 -1 -1 -1 -1\n-1 -1 -1 -1 -1 -1 -1 -1\n-1 -1 -1 -1 -1 -1 -1 -1 -1\n-1 -1 -1 -1 -1 -1 -1\n-1 -1 -1 -1 -1 -1 -1 -1\n-1 -1 -1 -1 -1 -1 -1 -1\n-1 -1 -1 -1 -1 -1 -1 -1\n-1 -1 -1 -1 -1 -1 -1", "0"], ["5 5\n0 1 1 1 1\n2 4 4 4 4\n2 4 4 3 4\n2 4 4 4 4\n2 4 4 4 4\n16 8 6 8\n4 4 9 5 4\n12 8 4 19 10 4\n14 2 3 3 6\n1 7 9 4 5\n17 5 10 13\n11 15 16 4 14\n20 20 15 5 16 3\n4 3 19 2 4\n19 19 13 15 20", "822"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "网络流", "北京", "上下界网络流"], "title": "[BJWC2018] Kakuro", "background": "首先介绍一下Kakuro(カックロ) 这个游戏。\n\n游戏规则为：\n\n• 方形空格中填入1 ~ 9 的整数。\n\n• 被斜线分开的方格中，右上角的数字等于其右侧邻接之连续方格中数字之和，左下角的数字等于其下方邻接之连续方格中数字之和。\n\n• 无论是横向还是纵向，连续方格中的数字不能重复。\n\n![](https://cdn.luogu.com.cn/upload/pic/17946.png)\n![](https://cdn.luogu.com.cn/upload/pic/17947.png)\n\n左边为一个Kakuro 游戏，右边为这个游戏的唯一解。\n\n我们称一开始给出的数字为线索，称需要填入数字的地方为空格。如果一个格子包含线索那么就不需要填入数字。我们约定所有的谜题都非空，即至少有一个空格需要被填入。\n\n**注意：在以下题目中的游戏规则可能会有所不同，请认真阅读在每个\n题目下的规则。**", "description": "游戏规则：\n\n• 空格中填入正整数。\n\n• 被斜线分开的方格中，右上角的数字等于其右侧邻接之连续方格中数字之和，左下角的数字等于其下方邻接之连续方格中数字之和。\n\nApia 给了Rimbaud 一个Kakuro 谜题。心不灵手不巧的Rimbaud 根本不会做Kakuro，所以只在空格里面填上了一些随机的数字，称这个为一个局面，即包含了谜题一开始给出的线索和后面填入的数字。\n\n现在Rimbaud 希望能修改这个局面使得她的答案是一个合法解。这个局面中有些数字(**包括一开始的给出线索和后面填入的数字**) 是可以修改的。每个数字都有个特定的代价，将这个数字加1 或者减1 都得付出这个数字对应的代价。注意对于一组合法解，必须满足游戏规则，也就是**空格中填的数字必须是正整数并且满足和的条件，但是不要求不重复**。\n\nRimbaud 希望用最少的代价让这个局面变得合法，如果不可能那么输出-1。", "inputFormat": "第一行，两个正整数表示n,m 表示这个游戏的行和列。\n\n接下来n 行，每行包含m 个0 到4 的数字，第i 行第j 列表示第i 行第j 列格子的种类。\n\n• 0 表示这个格子既不是空格也不是线索。\n\n• 1 表示这个格子左下角包含线索，右上角没有线索。\n\n• 2 表示这个格子右上角包含线索，左下角没有线索。\n\n• 3 表示这个格子左下角右上角都包含线索。\n\n• 4 表示这个格子为空格。\n\n输入保证这个从格式上来说一定是个合法的Kakuro 谜题，即每一段连续的空格的左边或者上面的格子包含线索。\n\n接下来n 行，每行包含若干个正整数，按从左往右的顺序给出初始局面中的每个数字。特别地如果这个格子的种类为3，那么先给出左下角的线索，再给出右上角的线索。\n\n接下来n 行，每行包含若干个整数，按从左往右的顺序给出初始局面中的每个数字对应的代价。如果代价为-1 表示这个格子不能修改，否则代价为非负整数。注意3 号格子的两个线索有着两个不同的代价。\n\n**样例1 给出了上面的谜题的输入，请在做题前阅读样例1 确保你理解了输入格式。**", "outputFormat": "一个整数表示最小的代价，如果不可能输出-1。", "hint": "对于5% 的数据，保证所有的代价都为-1。\n\n对于20% 的数据，保证所有空格中的数字代价都为-1。\n\n对于另外30% 的数据，保证所有代表线索的数字的代价都为-1。\n\n对于另外20% 的数据，保证只有第一行第一列包含线索，剩下的地方全都是空格。\n\n对于100% 的数据，保证3 ≤ n,m ≤ 30，保证初始局面中的每个数字不超过$10^6$，保证每个数字的代价不超过$10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "[BJWC2018] Kakuro", "background": "First, an introduction to the game Kakuro (カックロ).\n\nRules of the game:\n• Fill each blank square with an integer from 1 to 9.\n• In a square divided by a diagonal, the number in the upper-right corner equals the sum of the numbers in the contiguous squares to its right, and the number in the lower-left corner equals the sum of the numbers in the contiguous squares below it.\n• In any contiguous run of squares, whether horizontal or vertical, the numbers cannot repeat.\n\n![](https://cdn.luogu.com.cn/upload/pic/17946.png)\n![](https://cdn.luogu.com.cn/upload/pic/17947.png)\n\nThe left figure shows a Kakuro puzzle, and the right figure shows its unique solution.\n\nWe call the initially given numbers clues, and the places where numbers are to be filled blanks. If a cell contains a clue, then no number needs to be filled there. We assume all puzzles are nonempty, i.e., at least one blank must be filled.\n\nNote: The rules in the following problems may differ from the above. Please read the rules under each problem carefully.", "description": "Rules of this problem:\n• Fill each blank with a positive integer.\n• In a square divided by a diagonal, the number in the upper-right corner equals the sum of the numbers in the contiguous squares to its right, and the number in the lower-left corner equals the sum of the numbers in the contiguous squares below it.\n\nApia gave Rimbaud a Kakuro puzzle. Clumsy as she is, Rimbaud did not know how to solve Kakuro, so she filled some random numbers into the blanks. We call this a position: it includes both the initially given clues and the numbers filled later.\n\nNow Rimbaud wants to modify this position so that her answer becomes a valid solution. Some numbers in this position (including both the initially given clues and the numbers filled later) can be modified. Each number has a specific cost: increasing or decreasing this number by 1 costs its associated cost per unit. Note that any valid solution must satisfy the game rules: the numbers filled in blanks must be positive integers and must satisfy the sum conditions, but distinctness is not required.\n\nRimbaud wants to make the position valid with the minimum total cost; if impossible, output -1.", "inputFormat": "The first line contains two positive integers n, m, the numbers of rows and columns.\n\nThen follow n lines, each containing m integers from 0 to 4; the integer in row i and column j denotes the type of the cell at (i, j):\n• 0 means the cell is neither a blank nor a clue.\n• 1 means the cell has a clue in the lower-left corner, and no clue in the upper-right corner.\n• 2 means the cell has a clue in the upper-right corner, and no clue in the lower-left corner.\n• 3 means the cell has clues in both the lower-left and upper-right corners.\n• 4 means the cell is a blank.\n\nThe input is guaranteed to be a syntactically valid Kakuro puzzle: for every contiguous run of blanks, the cell immediately to its left or immediately above contains a clue.\n\nThen follow n lines, each containing a sequence of positive integers, giving, from left to right, every number present in the initial position. In particular, if a cell is of type 3, then the lower-left clue is given first, followed by the upper-right clue.\n\nThen follow n lines, each containing a sequence of integers, giving, from left to right, the modification cost corresponding to each number in the initial position. A cost of -1 means the number in that cell cannot be modified; otherwise the cost is a nonnegative integer. Note that the two clues in a type 3 cell have two different costs.\n\nSample 1 gives the input for the puzzle above. Please read Sample 1 before solving to ensure you understand the input format.", "outputFormat": "Output a single integer, the minimum total cost. If it is impossible, output -1.", "hint": "• For 5% of the testdata, all costs are -1.\n• For 20% of the testdata, the costs of all numbers in blanks are -1.\n• For another 30% of the testdata, the costs of all clue numbers are -1.\n• For another 20% of the testdata, only the cell at row 1, column 1 contains clues, and all remaining cells are blanks.\n• For 100% of the testdata, 3 ≤ n, m ≤ 30, every number in the initial position is at most $10^6$, and every cost is at most $10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJWC2018] Kakuro", "background": "首先介绍一下Kakuro(カックロ) 这个游戏。\n\n游戏规则为：\n\n• 方形空格中填入1 ~ 9 的整数。\n\n• 被斜线分开的方格中，右上角的数字等于其右侧邻接之连续方格中数字之和，左下角的数字等于其下方邻接之连续方格中数字之和。\n\n• 无论是横向还是纵向，连续方格中的数字不能重复。\n\n![](https://cdn.luogu.com.cn/upload/pic/17946.png)\n![](https://cdn.luogu.com.cn/upload/pic/17947.png)\n\n左边为一个Kakuro 游戏，右边为这个游戏的唯一解。\n\n我们称一开始给出的数字为线索，称需要填入数字的地方为空格。如果一个格子包含线索那么就不需要填入数字。我们约定所有的谜题都非空，即至少有一个空格需要被填入。\n\n**注意：在以下题目中的游戏规则可能会有所不同，请认真阅读在每个\n题目下的规则。**", "description": "游戏规则：\n\n• 空格中填入正整数。\n\n• 被斜线分开的方格中，右上角的数字等于其右侧邻接之连续方格中数字之和，左下角的数字等于其下方邻接之连续方格中数字之和。\n\nApia 给了Rimbaud 一个Kakuro 谜题。心不灵手不巧的Rimbaud 根本不会做Kakuro，所以只在空格里面填上了一些随机的数字，称这个为一个局面，即包含了谜题一开始给出的线索和后面填入的数字。\n\n现在Rimbaud 希望能修改这个局面使得她的答案是一个合法解。这个局面中有些数字(**包括一开始的给出线索和后面填入的数字**) 是可以修改的。每个数字都有个特定的代价，将这个数字加1 或者减1 都得付出这个数字对应的代价。注意对于一组合法解，必须满足游戏规则，也就是**空格中填的数字必须是正整数并且满足和的条件，但是不要求不重复**。\n\nRimbaud 希望用最少的代价让这个局面变得合法，如果不可能那么输出-1。", "inputFormat": "第一行，两个正整数表示n,m 表示这个游戏的行和列。\n\n接下来n 行，每行包含m 个0 到4 的数字，第i 行第j 列表示第i 行第j 列格子的种类。\n\n• 0 表示这个格子既不是空格也不是线索。\n\n• 1 表示这个格子左下角包含线索，右上角没有线索。\n\n• 2 表示这个格子右上角包含线索，左下角没有线索。\n\n• 3 表示这个格子左下角右上角都包含线索。\n\n• 4 表示这个格子为空格。\n\n输入保证这个从格式上来说一定是个合法的Kakuro 谜题，即每一段连续的空格的左边或者上面的格子包含线索。\n\n接下来n 行，每行包含若干个正整数，按从左往右的顺序给出初始局面中的每个数字。特别地如果这个格子的种类为3，那么先给出左下角的线索，再给出右上角的线索。\n\n接下来n 行，每行包含若干个整数，按从左往右的顺序给出初始局面中的每个数字对应的代价。如果代价为-1 表示这个格子不能修改，否则代价为非负整数。注意3 号格子的两个线索有着两个不同的代价。\n\n**样例1 给出了上面的谜题的输入，请在做题前阅读样例1 确保你理解了输入格式。**", "outputFormat": "一个整数表示最小的代价，如果不可能输出-1。", "hint": "对于5% 的数据，保证所有的代价都为-1。\n\n对于20% 的数据，保证所有空格中的数字代价都为-1。\n\n对于另外30% 的数据，保证所有代表线索的数字的代价都为-1。\n\n对于另外20% 的数据，保证只有第一行第一列包含线索，剩下的地方全都是空格。\n\n对于100% 的数据，保证3 ≤ n,m ≤ 30，保证初始局面中的每个数字不超过$10^6$，保证每个数字的代价不超过$10^6$。", "locale": "zh-CN"}}}
{"pid": "P4487", "type": "P", "difficulty": 7, "samples": [["3\n3 3\n0 1 1\n2 4 4\n2 4 4\n3 7\n2\n6\n3 3\n0 1 1\n2 4 4\n2 4 4\n1 1\n1\n1\n2 2\n0 1\n2 4\n0\n0", "\n1 3\n2 4\n-1\n-1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "北京", "Special Judge"], "title": "[BJWC2018] Cross sum", "background": "首先介绍一下Kakuro(カックロ) 这个游戏。\n\n游戏规则为：\n\n- 方形空格中填入 $1\\sim 9$ 的整数。\n- 被斜线分开的方格中，右上角的数字等于其右侧邻接之连续方格中数字之和，左下角的数字等于其下方邻接之连续方格中数字之和。\n- 无论是横向还是纵向，连续方格中的数字不能重复。\n\n![](https://cdn.luogu.com.cn/upload/pic/17946.png)\n![](https://cdn.luogu.com.cn/upload/pic/17947.png)\n\n左边为一个Kakuro 游戏，右边为这个游戏的唯一解。\n\n我们称一开始给出的数字为线索，称需要填入数字的地方为空格。如果一个格子包含线索那么就不需要填入数字。我们约定所有的谜题都非空，即至少有一个空格需要被填入。\n\n**注意：在以下题目中的游戏规则可能会有所不同，请认真阅读在每个\n题目下的规则。**", "description": "游戏规则：\n\n- 空格中填入正整数。\n- 被斜线分开的方格中，右上角的数字等于其右侧邻接之连续方格中数字之异或和，左下角的数字等于其下方邻接之连续方格中数字之异或和。\n- 所有空格中填入的整数都不能重复。\n\nApia 给了 Rimbaud 一个 Kakuro 谜题。心不灵手不巧的 Rimbaud 根本不会做 Kakuro，所以她请求你帮她解决。由于 Rimbaud 很年幼，只会对不超过 $2^{60}-1$ 的数字进行运算。所以希望谜题的解中每个数字都不超过\n $2^{60}-1$。", "inputFormat": "每组数据包含多组测试数据。第一行包含一个整数 $T$ 表示测试数据组数。\n\n对于每组测试数据，第一行，两个正整数 $n,m$ 表示这个游戏的行和列。\n\n接下来 $n$ 行，每行包含 $m$ 个 $0$ 到 $4$ 的数字，第 $i$ 行第 $j$ 列表示第 $i$ 行第 $j$ 列格子的种类。\n\n- $0$ 表示这个格子既不是空格也不是线索。\n- $1$ 表示这个格子左下角包含线索，右上角没有线索。\n- $2$ 表示这个格子右上角包含线索，左下角没有线索。\n- $3$ 表示这个格子左下角右上角都包含线索。\n- $4$ 表示这个格子为空格。\n\n输入保证这个从格式上来说一定是个合法的 Kakuro 谜题，即每一段连续的空格的左边或者上面的格子包含线索。\n\n接下来 $n$ 行，每行包含若干个**非负整数**，按从左往右的顺序给出谜题中的每个线索。特别地如果这个格子的种类为 $3$，那么先给出左下角的线索，再给出右上角的线索。", "outputFormat": "对于每组测试数据，如果有解，那么输出 $n$ 行，每行按从左往右的顺序输出往空格中填入的数，要求空格内填入的数字在 $1$ 到 $2^{60}-1$ 之间。否则输出一个 $-1$。", "hint": "对于 $10\\%$ 的数据，保证 $n,m \\leq 3$。\n\n对于 $30\\%$ 的数据，保证$n,m \\leq 15$。\n\n对于 $50\\%$ 的数据，保证$n,m \\leq 40$。\n\n对于另外 $20\\%$ 的数据，保证只有第一行第一列包含线索，剩下的地方全都是空格。\n\n对于 $100\\%$ 的数据，保证$3 \\leq n,m \\leq 200$，$1\\leq T \\leq 5$，保证初始局面中的每个数字不超过 $2^{60}-1$。", "locale": "zh-CN", "translations": {"en": {"title": "[BJWC2018] Cross sum", "background": "First, let us introduce the game Kakuro (カックロ).\n\nThe rules are:\n\n- Fill each empty cell with an integer from $1\\sim 9$.\n- In a cell split by a diagonal line, the number in the upper-right corner equals the sum of the numbers in the consecutive adjacent cells to its right, and the number in the lower-left corner equals the sum of the numbers in the consecutive adjacent cells below it.\n- Whether horizontally or vertically, numbers in consecutive cells must not repeat.\n\n![](https://cdn.luogu.com.cn/upload/pic/17946.png)\n![](https://cdn.luogu.com.cn/upload/pic/17947.png)\n\nThe left picture shows a Kakuro puzzle, and the right picture shows its unique solution.\n\nWe call the numbers given at the beginning clues, and the places that need to be filled are called empty cells. If a cell contains a clue, then it does not need to be filled. We guarantee that all puzzles are non-empty, meaning there is at least one empty cell that needs to be filled.\n\n**Note: The game rules in the following problems may be different. Please read the rules under each problem carefully.**", "description": "Game rules:\n\n- Fill each empty cell with a positive integer.\n- In a cell split by a diagonal line, the number in the upper-right corner equals the XOR sum of the numbers in the consecutive adjacent cells to its right, and the number in the lower-left corner equals the XOR sum of the numbers in the consecutive adjacent cells below it.\n- All integers filled in empty cells must be pairwise distinct (no duplicates).\n\nApia gave Rimbaud a Kakuro puzzle. Rimbaud is not good at such puzzles at all, so she asks you to help solve it. Since Rimbaud is very young, she can only operate on numbers not exceeding $2^{60}-1$. Therefore, it is required that in the solution of the puzzle, every number does not exceed $2^{60}-1$.", "inputFormat": "Each input contains multiple test cases. The first line contains an integer $T$, the number of test cases.\n\nFor each test case, the first line contains two positive integers $n, m$, representing the number of rows and columns of the board.\n\nIn the next $n$ lines, each line contains $m$ digits from $0$ to $4$. The digit in row $i$, column $j$ indicates the type of the cell at $(i, j)$:\n\n- $0$ means this cell is neither an empty cell nor a clue cell.\n- $1$ means this cell contains a clue in the lower-left corner, and no clue in the upper-right corner.\n- $2$ means this cell contains a clue in the upper-right corner, and no clue in the lower-left corner.\n- $3$ means this cell contains clues in both the lower-left and upper-right corners.\n- $4$ means this cell is an empty cell.\n\nThe input guarantees that, in terms of format, this is a valid Kakuro puzzle: for every consecutive segment of empty cells, the cell to its left or the cell above it contains a clue.\n\nThen there are $n$ more lines. Each line contains several **non-negative integers**, giving all clues in the puzzle in left-to-right order. In particular, if a cell type is $3$, then the lower-left clue is given first, followed by the upper-right clue.", "outputFormat": "For each test case, if there is a solution, output $n$ lines. Each line should output, from left to right, the numbers filled into the empty cells in that row. The filled numbers must be between $1$ and $2^{60}-1$ (inclusive). Otherwise, output $-1$.", "hint": "For $10\\%$ of the testdata, it is guaranteed that $n, m \\leq 3$.\n\nFor $30\\%$ of the testdata, it is guaranteed that $n, m \\leq 15$.\n\nFor $50\\%$ of the testdata, it is guaranteed that $n, m \\leq 40$.\n\nFor another $20\\%$ of the testdata, it is guaranteed that only the cell at the first row and first column contains clues, and all remaining cells are empty cells.\n\nFor $100\\%$ of the testdata, it is guaranteed that $3 \\leq n, m \\leq 200$, $1 \\leq T \\leq 5$, and every initial clue number does not exceed $2^{60}-1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJWC2018] Cross sum", "background": "首先介绍一下Kakuro(カックロ) 这个游戏。\n\n游戏规则为：\n\n- 方形空格中填入 $1\\sim 9$ 的整数。\n- 被斜线分开的方格中，右上角的数字等于其右侧邻接之连续方格中数字之和，左下角的数字等于其下方邻接之连续方格中数字之和。\n- 无论是横向还是纵向，连续方格中的数字不能重复。\n\n![](https://cdn.luogu.com.cn/upload/pic/17946.png)\n![](https://cdn.luogu.com.cn/upload/pic/17947.png)\n\n左边为一个Kakuro 游戏，右边为这个游戏的唯一解。\n\n我们称一开始给出的数字为线索，称需要填入数字的地方为空格。如果一个格子包含线索那么就不需要填入数字。我们约定所有的谜题都非空，即至少有一个空格需要被填入。\n\n**注意：在以下题目中的游戏规则可能会有所不同，请认真阅读在每个\n题目下的规则。**", "description": "游戏规则：\n\n- 空格中填入正整数。\n- 被斜线分开的方格中，右上角的数字等于其右侧邻接之连续方格中数字之异或和，左下角的数字等于其下方邻接之连续方格中数字之异或和。\n- 所有空格中填入的整数都不能重复。\n\nApia 给了 Rimbaud 一个 Kakuro 谜题。心不灵手不巧的 Rimbaud 根本不会做 Kakuro，所以她请求你帮她解决。由于 Rimbaud 很年幼，只会对不超过 $2^{60}-1$ 的数字进行运算。所以希望谜题的解中每个数字都不超过\n $2^{60}-1$。", "inputFormat": "每组数据包含多组测试数据。第一行包含一个整数 $T$ 表示测试数据组数。\n\n对于每组测试数据，第一行，两个正整数 $n,m$ 表示这个游戏的行和列。\n\n接下来 $n$ 行，每行包含 $m$ 个 $0$ 到 $4$ 的数字，第 $i$ 行第 $j$ 列表示第 $i$ 行第 $j$ 列格子的种类。\n\n- $0$ 表示这个格子既不是空格也不是线索。\n- $1$ 表示这个格子左下角包含线索，右上角没有线索。\n- $2$ 表示这个格子右上角包含线索，左下角没有线索。\n- $3$ 表示这个格子左下角右上角都包含线索。\n- $4$ 表示这个格子为空格。\n\n输入保证这个从格式上来说一定是个合法的 Kakuro 谜题，即每一段连续的空格的左边或者上面的格子包含线索。\n\n接下来 $n$ 行，每行包含若干个**非负整数**，按从左往右的顺序给出谜题中的每个线索。特别地如果这个格子的种类为 $3$，那么先给出左下角的线索，再给出右上角的线索。", "outputFormat": "对于每组测试数据，如果有解，那么输出 $n$ 行，每行按从左往右的顺序输出往空格中填入的数，要求空格内填入的数字在 $1$ 到 $2^{60}-1$ 之间。否则输出一个 $-1$。", "hint": "对于 $10\\%$ 的数据，保证 $n,m \\leq 3$。\n\n对于 $30\\%$ 的数据，保证$n,m \\leq 15$。\n\n对于 $50\\%$ 的数据，保证$n,m \\leq 40$。\n\n对于另外 $20\\%$ 的数据，保证只有第一行第一列包含线索，剩下的地方全都是空格。\n\n对于 $100\\%$ 的数据，保证$3 \\leq n,m \\leq 200$，$1\\leq T \\leq 5$，保证初始局面中的每个数字不超过 $2^{60}-1$。", "locale": "zh-CN"}}}
{"pid": "P4488", "type": "P", "difficulty": 6, "samples": [["8 8 9 24\n0 2 2 3 16\n0 2 6 8 24\n0 3 2 3 17\n0 3 5 8 29\n0 4 2 6 35\n0 5 3 4 7\n0 5 6 7 8\n0 6 4 8 16\n0 7 2 5 21\n0 7 7 8 5\n0 8 2 4 6\n0 8 7 8 3\n1 2 2 4 23\n1 2 7 8 11\n1 3 2 5 30\n1 3 7 8 10\n1 4 4 8 15\n1 5 3 4 17\n1 5 6 7 7\n1 6 2 6 27\n1 7 2 3 12\n1 7 5 8 12\n1 8 2 3 16\n1 8 6 8 7", "127"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "2018", "北京", "cdq 分治", "扫描线"], "title": "[BJWC2018] Kreuzsummen", "background": "首先介绍一下Kakuro(カックロ) 这个游戏。\n\n游戏规则为：\n\n• 方形空格中填入1 ~ 9 的整数。\n\n• 被斜线分开的方格中，右上角的数字等于其右侧邻接之连续方格中数字之和，左下角的数字等于其下方邻接之连续方格中数字之和。\n\n• 无论是横向还是纵向，连续方格中的数字不能重复。\n\n![](https://cdn.luogu.com.cn/upload/pic/17946.png)\n![](https://cdn.luogu.com.cn/upload/pic/17947.png)\n\n左边为一个Kakuro 游戏，右边为这个游戏的唯一解。\n\n我们称一开始给出的数字为线索，称需要填入数字的地方为空格。如果一个格子包含线索那么就不需要填入数字。我们约定所有的谜题都非空，即至少有一个空格需要被填入。\n\n**注意：在以下题目中的游戏规则可能会有所不同，请认真阅读在每个\n题目下的规则。**", "description": "游戏规则：\n\n• 方形空格中填入1 ~ k 的整数。\n\n• 被斜线分开的方格中，右上角的数字等于其右侧邻接之连续方格中数字之和，左下角的数字等于其下方邻接之连续方格中数字之和。\n\n• 无论是横向还是纵向，连续方格中的数字不能重复。\n\nApia 给了Rimbaud 一个Kakuro 谜题。心不灵手不巧的Rimbaud 发现自己总是做不出Kakuro。她怀疑原因是Apia 给的题目难度太高而不是自己太菜。所以她想评价一下这个题目的难度。\n\nRimbaud 认为一个Kakuro 谜题的难度为每个空格的候选数个数的和。我们来定义一下对于每个空格的候选数，这里的候选数为只考虑这个格子在初始谜题下对应的行和列线索和数字不能重复的条件下可以填的数字集合。\n\n如果某连续4 个空格对应的线索为10，那么这四个数只可能是1 + 2 + 3 + 4，也就是这几个空格在这个线索的限制下候选数集合为{1, 2, 3, 4}。\n\n更一般的，如果某连续c 个空格对应的线索为s，那么考虑所有数值1 ~ k 之间，不重复并且和为s 的c 元组，这几个空格在这个线索限制下的候选数集合为出现在这些c 元组中的所有数字。对于每个空格，它的候选数集合为行限制下的候选数和列限制下的候选数的交。\n\n![](https://cdn.luogu.com.cn/upload/pic/17946.png)\n\n在这个谜题中，我们考虑第2 行第2 列的空格。这个空格的行线索为16，对应的候选数集合为{7, 9}。这个空格的列线索为23，对应的候选数{6, 8, 9}，所以这个空格的候选数集合为{9}。第2 行第3 列的空格的行线索对应的候选数集合为{7, 9}，列线索的I 应的候选数集合为{6, 7, 8, 9}，所以这个空格的候选数集合为{7, 9}。注意虽然我们可以通过先确定第2 行第2 列的数字，然后根据行线索推算出第2 行第3 列的数字，但是Rimbaud **只会考虑初始的线索**。\n\n请帮助Rimbaud 求出这个谜题的难度即所有的空格的候选数个数的和。", "inputFormat": "第一行，四个正整数表示n, m, k, T 表示这个游戏的行，列，数值范围和总线索个数。\n接下来T 行，每行五个正整数，$t, x, y_1, y_2, s(t \\in \\{0, 1\\}, y_1 ≤ y_2)$。其中t 表示这个线索的种类，如果t = 0，那么表示这个线索为行线索，第x 行第y1 列到y2 列之间的数字和为s。如果t = 1，那么表示这个线索为行线索，\n第x 列第y1 行到y2 行之间的数字和为s。数据中的行和列都从1 开始标号。\n\n这个谜题的空格为所有线索对应的空格的并集。输入保证这个从格式上来说一定是个合法的Kakuro 谜题，即每一段连续的空格的左边或者上面的格子包含线索，并且每个空格出现了恰好两次。\n\n**数据中可能出现某些位置的候选数集合为空或者无解的情况**。对于这种情况还是只需要按定义求出这个谜题的难度即可。", "outputFormat": "输出一个整数表示答案。", "hint": "// 下面为这个样例的解释。\n\n-1 -1 -1 -1 -1 -1 -1 -1\n\n-1 1 2 -1 -1 3 3 2\n\n-1 2 2 -1 2 4 4 2\n\n-1 3 4 1 2 5 -1 -1\n\n-1 -1 1 5 -1 6 5 -1\n\n-1 -1 -1 4 5 5 5 3\n\n-1 8 8 5 6 -1 4 3\n\n-1 2 3 3 -1 -1 2 2\n\n对于10% 的数据，保证$n,m ≤ 3$。\n\n对于30% 的数据，保证$n,m ≤ 50$。\n\n对于50% 的数据，保证$n,m ≤ 500$。\n\n对于另外20% 的数据，保证只有第一行第一列包含线索，剩下的地方全都是空格。\n\n对于100% 的数据，保证$3 ≤ n, m, T ≤ 10^5, 1 ≤ k ≤ 10^5, s ≤ 10^{18}$。", "locale": "zh-CN", "translations": {"en": {"title": "[BJWC2018] Kreuzsummen", "background": "First, let’s introduce the game Kakuro (カックロ).\n\nRules:\n- Fill each square cell with an integer from $1$ to $9$.\n- In a cell split by a diagonal slash, the number at the top-right equals the sum of the consecutive cells to its right, and the number at the bottom-left equals the sum of the consecutive cells below it.\n- In any horizontal or vertical run, digits may not repeat.\n\n![](https://cdn.luogu.com.cn/upload/pic/17946.png)\n![](https://cdn.luogu.com.cn/upload/pic/17947.png)\n\nThe left is a Kakuro puzzle, and the right is its unique solution.\n\nWe call the numbers given at the start clues, and the places where numbers need to be filled empty cells. If a cell contains a clue, then no number needs to be filled there. We assume every puzzle is non-empty, i.e., at least one empty cell needs to be filled.\n\nNote: The game rules in the following problems may differ. Please read the rules under each problem carefully.", "description": "Rules:\n- Fill each square cell with an integer from $1$ to $k$.\n- In a cell split by a diagonal slash, the number at the top-right equals the sum of the consecutive cells to its right, and the number at the bottom-left equals the sum of the consecutive cells below it.\n- In any horizontal or vertical run, digits may not repeat.\n\nApia gave Rimbaud a Kakuro puzzle. Clumsy as she is, Rimbaud keeps failing to solve Kakuro. She suspects the reason is that Apia’s puzzle is too hard rather than her own skill. So she wants to evaluate the difficulty of this puzzle.\n\nRimbaud defines the difficulty of a Kakuro puzzle as the sum, over all empty cells, of the sizes of their candidate sets. For each empty cell, its candidate set is defined using only the initial puzzle’s row and column clues and the “no repetition” rule, considering the cell in its row and column runs independently.\n\nFor example, if a run of $4$ consecutive cells has a clue sum $10$, then the four digits must be $1 + 2 + 3 + 4$. That is, under this clue, the candidate set for these cells is $\\{1, 2, 3, 4\\}$.\n\nMore generally, if a run of $c$ consecutive cells has a clue sum $s$, consider all $c$-tuples of distinct numbers from $1$ to $k$ that sum to $s$. Under this clue, the candidate set for these cells is the set of all digits that appear in any of those $c$-tuples. For any given empty cell, its candidate set is the intersection of the candidate set from its row run and that from its column run.\n\n![](https://cdn.luogu.com.cn/upload/pic/17946.png)\n\nIn this puzzle, consider the empty cell at row $2$, column $2$. The row clue is $16$, giving a candidate set $\\{7, 9\\}$. The column clue is $23$, giving a candidate set $\\{6, 8, 9\\}$, so the cell’s candidate set is $\\{9\\}$. For the cell at row $2$, column $3$, the row clue gives $\\{7, 9\\}$ and the column clue gives $\\{6, 7, 8, 9\\}$, so the candidate set is $\\{7, 9\\}$. Note that although one could deduce more by first fixing row $2$, column $2$ and then using the row clue to determine row $2$, column $3$, Rimbaud only considers the initial clues.\n\nPlease help Rimbaud compute the difficulty of this puzzle, i.e., the sum of the sizes of the candidate sets over all empty cells.", "inputFormat": "The first line contains four positive integers $n, m, k, T$, denoting the number of rows, columns, the value range, and the total number of clues.\n\nThe next $T$ lines each contain five positive integers\n$t, x, y_1, y_2, s \\ (t \\in \\{0, 1\\},\\ y_1 \\le y_2)$.\nHere $t$ indicates the type of clue:\n- If $t = 0$, this is a row clue: in row $x$, columns $y_1$ to $y_2$ sum to $s$.\n- If $t = 1$, this is a column clue: in column $x$, rows $y_1$ to $y_2$ sum to $s$.\nRows and columns are $1$-indexed.\n\nThe empty cells of the puzzle are the union of all cells covered by the clues. The input is guaranteed to be a syntactically valid Kakuro puzzle: for every run of consecutive empty cells, the cell immediately to its left or above contains the corresponding clue, and each empty cell is covered by exactly two clues (one row clue and one column clue).\n\nThe testdata may contain positions where the candidate set is empty or the puzzle is unsatisfiable. In such cases, still compute the difficulty strictly by the definition above.", "outputFormat": "Output a single integer, the answer.", "hint": "// The following explains this sample.\n\n```\n-1 -1 -1 -1 -1 -1 -1 -1\n-1 1 2 -1 -1 3 3 2\n-1 2 2 -1 2 4 4 2\n-1 3 4 1 2 5 -1 -1\n-1 -1 1 5 -1 6 5 -1\n-1 -1 -1 4 5 5 5 3\n-1 8 8 5 6 -1 4 3\n-1 2 3 3 -1 -1 2 2\n```\n\nFor $10\\%$ of the testdata, it is guaranteed that $n, m \\le 3$.\n\nFor $30\\%$ of the testdata, it is guaranteed that $n, m \\le 50$.\n\nFor $50\\%$ of the testdata, it is guaranteed that $n, m \\le 500$.\n\nFor another $20\\%$ of the testdata, only the cell at row $1$, column $1$ contains a clue, and all other cells are empty.\n\nFor $100\\%$ of the testdata, it is guaranteed that $3 \\le n, m, T \\le 10^5$, $1 \\le k \\le 10^5$, $s \\le 10^{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJWC2018] Kreuzsummen", "background": "首先介绍一下Kakuro(カックロ) 这个游戏。\n\n游戏规则为：\n\n• 方形空格中填入1 ~ 9 的整数。\n\n• 被斜线分开的方格中，右上角的数字等于其右侧邻接之连续方格中数字之和，左下角的数字等于其下方邻接之连续方格中数字之和。\n\n• 无论是横向还是纵向，连续方格中的数字不能重复。\n\n![](https://cdn.luogu.com.cn/upload/pic/17946.png)\n![](https://cdn.luogu.com.cn/upload/pic/17947.png)\n\n左边为一个Kakuro 游戏，右边为这个游戏的唯一解。\n\n我们称一开始给出的数字为线索，称需要填入数字的地方为空格。如果一个格子包含线索那么就不需要填入数字。我们约定所有的谜题都非空，即至少有一个空格需要被填入。\n\n**注意：在以下题目中的游戏规则可能会有所不同，请认真阅读在每个\n题目下的规则。**", "description": "游戏规则：\n\n• 方形空格中填入1 ~ k 的整数。\n\n• 被斜线分开的方格中，右上角的数字等于其右侧邻接之连续方格中数字之和，左下角的数字等于其下方邻接之连续方格中数字之和。\n\n• 无论是横向还是纵向，连续方格中的数字不能重复。\n\nApia 给了Rimbaud 一个Kakuro 谜题。心不灵手不巧的Rimbaud 发现自己总是做不出Kakuro。她怀疑原因是Apia 给的题目难度太高而不是自己太菜。所以她想评价一下这个题目的难度。\n\nRimbaud 认为一个Kakuro 谜题的难度为每个空格的候选数个数的和。我们来定义一下对于每个空格的候选数，这里的候选数为只考虑这个格子在初始谜题下对应的行和列线索和数字不能重复的条件下可以填的数字集合。\n\n如果某连续4 个空格对应的线索为10，那么这四个数只可能是1 + 2 + 3 + 4，也就是这几个空格在这个线索的限制下候选数集合为{1, 2, 3, 4}。\n\n更一般的，如果某连续c 个空格对应的线索为s，那么考虑所有数值1 ~ k 之间，不重复并且和为s 的c 元组，这几个空格在这个线索限制下的候选数集合为出现在这些c 元组中的所有数字。对于每个空格，它的候选数集合为行限制下的候选数和列限制下的候选数的交。\n\n![](https://cdn.luogu.com.cn/upload/pic/17946.png)\n\n在这个谜题中，我们考虑第2 行第2 列的空格。这个空格的行线索为16，对应的候选数集合为{7, 9}。这个空格的列线索为23，对应的候选数{6, 8, 9}，所以这个空格的候选数集合为{9}。第2 行第3 列的空格的行线索对应的候选数集合为{7, 9}，列线索的I 应的候选数集合为{6, 7, 8, 9}，所以这个空格的候选数集合为{7, 9}。注意虽然我们可以通过先确定第2 行第2 列的数字，然后根据行线索推算出第2 行第3 列的数字，但是Rimbaud **只会考虑初始的线索**。\n\n请帮助Rimbaud 求出这个谜题的难度即所有的空格的候选数个数的和。", "inputFormat": "第一行，四个正整数表示n, m, k, T 表示这个游戏的行，列，数值范围和总线索个数。\n接下来T 行，每行五个正整数，$t, x, y_1, y_2, s(t \\in \\{0, 1\\}, y_1 ≤ y_2)$。其中t 表示这个线索的种类，如果t = 0，那么表示这个线索为行线索，第x 行第y1 列到y2 列之间的数字和为s。如果t = 1，那么表示这个线索为行线索，\n第x 列第y1 行到y2 行之间的数字和为s。数据中的行和列都从1 开始标号。\n\n这个谜题的空格为所有线索对应的空格的并集。输入保证这个从格式上来说一定是个合法的Kakuro 谜题，即每一段连续的空格的左边或者上面的格子包含线索，并且每个空格出现了恰好两次。\n\n**数据中可能出现某些位置的候选数集合为空或者无解的情况**。对于这种情况还是只需要按定义求出这个谜题的难度即可。", "outputFormat": "输出一个整数表示答案。", "hint": "// 下面为这个样例的解释。\n\n-1 -1 -1 -1 -1 -1 -1 -1\n\n-1 1 2 -1 -1 3 3 2\n\n-1 2 2 -1 2 4 4 2\n\n-1 3 4 1 2 5 -1 -1\n\n-1 -1 1 5 -1 6 5 -1\n\n-1 -1 -1 4 5 5 5 3\n\n-1 8 8 5 6 -1 4 3\n\n-1 2 3 3 -1 -1 2 2\n\n对于10% 的数据，保证$n,m ≤ 3$。\n\n对于30% 的数据，保证$n,m ≤ 50$。\n\n对于50% 的数据，保证$n,m ≤ 500$。\n\n对于另外20% 的数据，保证只有第一行第一列包含线索，剩下的地方全都是空格。\n\n对于100% 的数据，保证$3 ≤ n, m, T ≤ 10^5, 1 ≤ k ≤ 10^5, s ≤ 10^{18}$。", "locale": "zh-CN"}}}
{"pid": "P4489", "type": "P", "difficulty": 5, "samples": [["2 \n3 \n2 \n0 \n1 \n2 \n2 \n1 \n1 1 0 \n1 1 1 \n0 1 1", "4"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["搜索", "2009", "CTSC/CTS"], "title": "[CTSC2009] 纷繁世界", "background": "这是一个纷繁复杂的世界。\n\n某一天清晨你起床很迟，没有吃上早饭。于是你骑着自行车去超市，但是你又发现商店的工作人员已经重新贴上了价格标签，零食价格都涨了 $50\\%$。你一怒之下就这样饿了一个上午…… \n\n当然，事情也许完全不会这样发展。 \n\n某一天清晨你起床比较迟，但还是没有吃上早饭。于是你骑着自行车去超市，恰好商店的工作人员还没有把涨价后的价格标签贴在零食上。于是你顺利的买了一些早餐然后逍遥而去…… \n\n或许你会起得更早，也或许商店的工作人员会迟到。 \n\n有时候，人们只是按照预想的顺序去完成一些事情，不过可能有一些事件，它们发生时间的前后顺序会影响世界的发展。 \n\n比如，如果商店只有一个西瓜，你想买，我也想买，那么我们买西瓜的先后顺序就会直接影响到谁最后能够买到西瓜。 \n\n这样一个复杂的世界，分析它的运行规律是一件非常重要的工作，也是你所要研究的。", "description": "简单起见，假定总共有 $N$ 个人以及 $M$ 种不同类型事件。定义事件之间的二元关系“相关”：\n\n- 相关关系是一个二元关系，就是说我们只能定义两种类型的事件间是否相关；\n- 同一种类型的事件之间一定是相关的；\n- 若事件 $x$ 与事件 $y$ 是相关的，那么事件 $y$ 与事件 $x$ 也一定是相关的。\n\n令 $Q_i = (Q_{i, 1}, Q_{i, 2}, \\cdots, Q_{i, C_i})$ 表示第 $i$ 个人计划完成的事件序列（称为计划序列），$C_i$ 表示 $Q_i$ 的长度。$Q_i$ 中每个事件 $Q_{i,j}$ 都是 $M$ 种事件中的某一种，且同一种类型的事件可以发生多次。 \n\n随着时间的推移每个计划序列中的事件都会发生一次且恰好一次；为了简单起见，不会有任何两个事件发生在同一时刻。 \n\n为了描述事件的发生顺序，定义 $P = (Q_{i_1, j_1}, Q_{i_2, j_2}, \\cdots, Q_{i_l, j_l})$ 为世界的一条发展轨迹，$P$ 是满足如下条件的有序序列：\n\n1. 对于每个人，计划序列中的每个事件 $Q_{i,j}$ 都在 $P$ 出现一次且恰好一次；\n2. 对于属于同一个计划序列的两个事件 $Q_{i,j_1}$ 和 $Q_{i,j_2}$（$1 \\leq j_1 < j_2 \\leq C_i$），$Q_{i,j_1}$ 一定发生在 $Q_{i,j_2}$ 之前（也就是在 $P$ 中位于更靠前的位置）。\n\n两条轨迹 $P_1$ 和 $P_2$ 被定义为本质不同的，当且仅当存在两个相关的事件 $Q_{i,j}$ 和 $Q_{u,v}$，他们在 $P_1$ 和 $P_2$ 中发生的先后顺序不同，也就是说，如果在 $P_1$ 中 $Q_{i,j}$ 发生在 $Q_{u,v}$ 之前且在 $P_2$ 中 $Q_{i,j}$ 发生在 $Q_{u,v}$ 之后，那么 $P_1$ 和 $P_2$ 就是本质不同的；如果在 $P_1$ 中 $Q_{i,j}$ 发生在 $Q_{u,v}$ 之后且在 $P_2$ 中 $Q_{i,j}$ 发生在 $Q_{u,v}$ 之前，那么 $P_1$ 和 $P_2$ 也是本质不同的。\n\n注意：本质相同具有传递性，即若 $P_1$ 与 $P_2$ 本质相同且 $P_2$ 与 $P_3$ 本质相同，那么 $P_1$ 与 $P_3$ 一定也本质相同。\n\n给定 $N, M$、每个人计划序列以及事件之间的相关关系。你需要计算一共有多少种本质不同的世界运行轨迹。", "inputFormat": "输入的第一行包括一个整数，表示人数 $N$。 \n\n输入的第二行包括一个整数，表示事件种类数 $M$，所有类型的事件按照 $0$ 至 $M - 1$ 编号。\n\n接下来依次给出每个人的计划序列的描述，对于第 $i$ 个人： \n\n首先一行一个整数表示序列长度 $C_i$ 。 \n\n第二行包含 $C_i$ 个整数，依次给出 $Q_i$ 中的每个事件 $Q_{i,j}$。 \n\n最后 $M$ 行输入一个 $M$ 行 $M$ 列的矩阵 $dep$ 用来描述相关关系，每行包含 $M$ 个整数，都是 $0$ 或者 $1$。$dep(i,j)$ 表示矩阵自上往下的第 $i$ 行，自左往右的第 $j$ 列所包含的整数。若 $dep(i,j)$ 的值为 $1$ ，那么第 $i$ 类事件和第 $j$ 类事件就是相关的，否则这两类事件不相关。", "outputFormat": "输出只有一行，一个整数表示本质不同的世界轨迹数 $T$。", "hint": "### 样例说明\n\n样例中有 $2$ 个人与 $3$ 类事件，$C_1 = C_2 = 2$。$Q_{1,0} = 0, Q_{1,1} = 1, Q_{2,0} = 2, Q_{2,1} = 1$。\n\n一共有 $4$ 种不同的发生轨迹：\n\n- $P_1 = (Q_{1,0}, Q_{1,1}, Q_{2,0}, Q_{2,1})$；\n- $P_2 = (Q_{1,0}, Q_{2,0}, Q_{1,1}, Q_{2,1})$；\n- $P_3 = (Q_{1,0}, Q_{2,0}, Q_{2,1}, Q_{1,1})$；\n- $P_4 = (Q_{2,0}, Q_{2,1}, Q_{1,0}, Q_{1,1})$。\n\n对于其他任何合法的发展轨迹，都一定和这四条轨迹中的某一条本质相同。例如 $P = (Q_{2,0}, Q_{1,0}, Q_{2,1}, Q_{1,1})$ 与 $P_3$ 是本质相同的，因为两条轨迹只交换了 $Q_{1,0} = 0$ 和 $Q_{2,0} = 2$ 的顺序，但是这两类事件是不相关的。\n\n### 数据规模\n\n对于 $100\\%$ 的数据，总人数 $N \\leq 10$，事件种类数 $M \\leq 15$，计划序列长度 $C_i \\leq 20$，世界轨迹数 $T \\leq 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2009] A Complicated World", "background": "This is a complex and intricate world.\n\nOne morning you woke up late and missed breakfast. You rode your bike to the supermarket, only to find that the staff had already put up new price tags and all snacks had gone up by $50\\%$. In anger, you stayed hungry the whole morning.\n\nOf course, things might not have turned out that way.\n\nAnother morning you woke up a bit late and still missed breakfast. You rode your bike to the supermarket, and it happened that the staff had not yet put up the new price tags. You smoothly bought some breakfast and went on your way.\n\nPerhaps you would get up earlier, or perhaps the store staff would arrive late.\n\nSometimes people complete tasks in an expected order, but for some events, the relative order in which they occur can influence how the world develops.\n\nFor example, if the store has only one watermelon, and both you and I want to buy it, then the order in which we try to buy it will directly determine who gets it.\n\nAnalyzing the rules of operation in such a complicated world is very important, and that is exactly what you are going to study.", "description": "For simplicity, assume there are $N$ people and $M$ types of events. Define a binary relation “related” between event types:\n\n- The relation is binary, meaning we only determine whether two types of events are related.\n- Events of the same type are always related.\n- If event $x$ is related to event $y$, then event $y$ is also related to event $x$.\n\nLet $Q_i = (Q_{i, 1}, Q_{i, 2}, \\cdots, Q_{i, C_i})$ be the sequence of events person $i$ plans to complete (called the plan sequence), where $C_i$ is the length of $Q_i$. Each event $Q_{i, j}$ is one of the $M$ event types, and events of the same type may occur multiple times.\n\nAs time goes by, each event in every plan sequence will occur exactly once, and no two events occur at the same moment.\n\nTo describe the order in which events occur, define $P = (Q_{i_1, j_1}, Q_{i_2, j_2}, \\cdots, Q_{i_l, j_l})$ as a development trajectory of the world. $P$ is an ordered sequence satisfying:\n\n1. For every person, each event $Q_{i, j}$ in their plan sequence appears in $P$ exactly once.\n2. For any two events $Q_{i, j_1}$ and $Q_{i, j_2}$ belonging to the same plan sequence ($1 \\leq j_1 < j_2 \\leq C_i$), $Q_{i, j_1}$ must occur before $Q_{i, j_2}$ (i.e., appear earlier in $P$).\n\nTwo trajectories $P_1$ and $P_2$ are defined to be essentially different if and only if there exist two related events $Q_{i, j}$ and $Q_{u, v}$ whose relative order differs in $P_1$ and $P_2$. In other words, if in $P_1$ the event $Q_{i, j}$ occurs before $Q_{u, v}$ while in $P_2$ the event $Q_{i, j}$ occurs after $Q_{u, v}$, then $P_1$ and $P_2$ are essentially different; similarly, if in $P_1$ $Q_{i, j}$ occurs after $Q_{u, v}$ but in $P_2$ it occurs before $Q_{u, v}$, then $P_1$ and $P_2$ are also essentially different.\n\nNote: “Essentially the same” is transitive. That is, if $P_1$ is essentially the same as $P_2$, and $P_2$ is essentially the same as $P_3$, then $P_1$ is necessarily essentially the same as $P_3$.\n\nGiven $N$, $M$, each person’s plan sequence, and the relatedness between event types, compute how many essentially different world development trajectories there are.", "inputFormat": "- The first line contains an integer denoting the number of people $N$.\n- The second line contains an integer denoting the number of event types $M$. All event types are numbered from $0$ to $M - 1$.\n- Then, for each person $i$, the description of their plan sequence is given:\n  - The first line contains one integer, the sequence length $C_i$.\n  - The second line contains $C_i$ integers, giving each event $Q_{i, j}$ in $Q_i$ in order.\n- Finally, $M$ lines follow, containing an $M \\times M$ matrix dep that describes the relatedness. Each line contains $M$ integers, each being $0$ or $1$. dep(i, j) denotes the integer in the $i$-th row (from top to bottom) and the $j$-th column (from left to right). If dep(i, j) equals $1$, then event type $i$ and event type $j$ are related; otherwise, they are unrelated.", "outputFormat": "Output a single line containing one integer, the number $T$ of essentially different world trajectories.", "hint": "Sample Explanation\n\nThere are $2$ people and $3$ event types, with $C_1 = C_2 = 2$. $Q_{1,0} = 0$, $Q_{1,1} = 1$, $Q_{2,0} = 2$, $Q_{2,1} = 1$.\n\nThere are $4$ different development trajectories:\n- $P_1 = (Q_{1,0}, Q_{1,1}, Q_{2,0}, Q_{2,1})$;\n- $P_2 = (Q_{1,0}, Q_{2,0}, Q_{1,1}, Q_{2,1})$;\n- $P_3 = (Q_{1,0}, Q_{2,0}, Q_{2,1}, Q_{1,1})$;\n- $P_4 = (Q_{2,0}, Q_{2,1}, Q_{1,0}, Q_{1,1})$.\n\nAny other valid development trajectory is necessarily essentially the same as one of these four. For example, $P = (Q_{2,0}, Q_{1,0}, Q_{2,1}, Q_{1,1})$ is essentially the same as $P_3$, because the two trajectories only swap the order of $Q_{1,0} = 0$ and $Q_{2,0} = 2$, and those two event types are unrelated.\n\nConstraints\n\nFor $100\\%$ of the testdata: $N \\leq 10$, $M \\leq 15$, $C_i \\leq 20$, $T \\leq 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2009] 纷繁世界", "background": "这是一个纷繁复杂的世界。\n\n某一天清晨你起床很迟，没有吃上早饭。于是你骑着自行车去超市，但是你又发现商店的工作人员已经重新贴上了价格标签，零食价格都涨了 $50\\%$。你一怒之下就这样饿了一个上午…… \n\n当然，事情也许完全不会这样发展。 \n\n某一天清晨你起床比较迟，但还是没有吃上早饭。于是你骑着自行车去超市，恰好商店的工作人员还没有把涨价后的价格标签贴在零食上。于是你顺利的买了一些早餐然后逍遥而去…… \n\n或许你会起得更早，也或许商店的工作人员会迟到。 \n\n有时候，人们只是按照预想的顺序去完成一些事情，不过可能有一些事件，它们发生时间的前后顺序会影响世界的发展。 \n\n比如，如果商店只有一个西瓜，你想买，我也想买，那么我们买西瓜的先后顺序就会直接影响到谁最后能够买到西瓜。 \n\n这样一个复杂的世界，分析它的运行规律是一件非常重要的工作，也是你所要研究的。", "description": "简单起见，假定总共有 $N$ 个人以及 $M$ 种不同类型事件。定义事件之间的二元关系“相关”：\n\n- 相关关系是一个二元关系，就是说我们只能定义两种类型的事件间是否相关；\n- 同一种类型的事件之间一定是相关的；\n- 若事件 $x$ 与事件 $y$ 是相关的，那么事件 $y$ 与事件 $x$ 也一定是相关的。\n\n令 $Q_i = (Q_{i, 1}, Q_{i, 2}, \\cdots, Q_{i, C_i})$ 表示第 $i$ 个人计划完成的事件序列（称为计划序列），$C_i$ 表示 $Q_i$ 的长度。$Q_i$ 中每个事件 $Q_{i,j}$ 都是 $M$ 种事件中的某一种，且同一种类型的事件可以发生多次。 \n\n随着时间的推移每个计划序列中的事件都会发生一次且恰好一次；为了简单起见，不会有任何两个事件发生在同一时刻。 \n\n为了描述事件的发生顺序，定义 $P = (Q_{i_1, j_1}, Q_{i_2, j_2}, \\cdots, Q_{i_l, j_l})$ 为世界的一条发展轨迹，$P$ 是满足如下条件的有序序列：\n\n1. 对于每个人，计划序列中的每个事件 $Q_{i,j}$ 都在 $P$ 出现一次且恰好一次；\n2. 对于属于同一个计划序列的两个事件 $Q_{i,j_1}$ 和 $Q_{i,j_2}$（$1 \\leq j_1 < j_2 \\leq C_i$），$Q_{i,j_1}$ 一定发生在 $Q_{i,j_2}$ 之前（也就是在 $P$ 中位于更靠前的位置）。\n\n两条轨迹 $P_1$ 和 $P_2$ 被定义为本质不同的，当且仅当存在两个相关的事件 $Q_{i,j}$ 和 $Q_{u,v}$，他们在 $P_1$ 和 $P_2$ 中发生的先后顺序不同，也就是说，如果在 $P_1$ 中 $Q_{i,j}$ 发生在 $Q_{u,v}$ 之前且在 $P_2$ 中 $Q_{i,j}$ 发生在 $Q_{u,v}$ 之后，那么 $P_1$ 和 $P_2$ 就是本质不同的；如果在 $P_1$ 中 $Q_{i,j}$ 发生在 $Q_{u,v}$ 之后且在 $P_2$ 中 $Q_{i,j}$ 发生在 $Q_{u,v}$ 之前，那么 $P_1$ 和 $P_2$ 也是本质不同的。\n\n注意：本质相同具有传递性，即若 $P_1$ 与 $P_2$ 本质相同且 $P_2$ 与 $P_3$ 本质相同，那么 $P_1$ 与 $P_3$ 一定也本质相同。\n\n给定 $N, M$、每个人计划序列以及事件之间的相关关系。你需要计算一共有多少种本质不同的世界运行轨迹。", "inputFormat": "输入的第一行包括一个整数，表示人数 $N$。 \n\n输入的第二行包括一个整数，表示事件种类数 $M$，所有类型的事件按照 $0$ 至 $M - 1$ 编号。\n\n接下来依次给出每个人的计划序列的描述，对于第 $i$ 个人： \n\n首先一行一个整数表示序列长度 $C_i$ 。 \n\n第二行包含 $C_i$ 个整数，依次给出 $Q_i$ 中的每个事件 $Q_{i,j}$。 \n\n最后 $M$ 行输入一个 $M$ 行 $M$ 列的矩阵 $dep$ 用来描述相关关系，每行包含 $M$ 个整数，都是 $0$ 或者 $1$。$dep(i,j)$ 表示矩阵自上往下的第 $i$ 行，自左往右的第 $j$ 列所包含的整数。若 $dep(i,j)$ 的值为 $1$ ，那么第 $i$ 类事件和第 $j$ 类事件就是相关的，否则这两类事件不相关。", "outputFormat": "输出只有一行，一个整数表示本质不同的世界轨迹数 $T$。", "hint": "### 样例说明\n\n样例中有 $2$ 个人与 $3$ 类事件，$C_1 = C_2 = 2$。$Q_{1,0} = 0, Q_{1,1} = 1, Q_{2,0} = 2, Q_{2,1} = 1$。\n\n一共有 $4$ 种不同的发生轨迹：\n\n- $P_1 = (Q_{1,0}, Q_{1,1}, Q_{2,0}, Q_{2,1})$；\n- $P_2 = (Q_{1,0}, Q_{2,0}, Q_{1,1}, Q_{2,1})$；\n- $P_3 = (Q_{1,0}, Q_{2,0}, Q_{2,1}, Q_{1,1})$；\n- $P_4 = (Q_{2,0}, Q_{2,1}, Q_{1,0}, Q_{1,1})$。\n\n对于其他任何合法的发展轨迹，都一定和这四条轨迹中的某一条本质相同。例如 $P = (Q_{2,0}, Q_{1,0}, Q_{2,1}, Q_{1,1})$ 与 $P_3$ 是本质相同的，因为两条轨迹只交换了 $Q_{1,0} = 0$ 和 $Q_{2,0} = 2$ 的顺序，但是这两类事件是不相关的。\n\n### 数据规模\n\n对于 $100\\%$ 的数据，总人数 $N \\leq 10$，事件种类数 $M \\leq 15$，计划序列长度 $C_i \\leq 20$，世界轨迹数 $T \\leq 10^6$。", "locale": "zh-CN"}}}
{"pid": "P4490", "type": "P", "difficulty": 6, "samples": [["36 2 \n3 \n99 100 105 100 \n101 100 95 100 \n100 99 100 105", "0.000"], ["10 9.8 \n3 \n0 0 0 0 \n1 0 100 0 \n0 50 0 1", "25.0000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["计算几何", "2009", "Special Judge", "凸包", "CTSC/CTS"], "title": "[CTSC2009] 魔幻花园", "background": "", "description": "魔法师栋栋有一个美丽的魔幻花园，在花园里，栋栋种满各式各样的魔幻植物，花园里一年四季都开满着姹紫嫣红的鲜花。栋栋的朋友们都特别喜欢来花园里玩。\n\n花园的浇灌系统是由栋栋特别设计的，栋栋用魔法在花园上空变出了$n$个喷头，这些喷头都连接着附近的圣水河。浇灌的时候，所有的喷头一起喷出一道道水流，水流在空中划出一道道美丽的弧线，最终正好浇灌到n棵最缺水的魔幻植物上。\n\n![喷头](https://cdn.luogu.com.cn/upload/pic/18045.png)\n\n栋栋把每个喷头都设在同一水平高度$h$。所有的喷头都是水平放置的，当水流从喷头喷出时，只有水平的速度(每个喷头的水平速度不一定相同)。魔幻花园里没有风，空气阻力可以忽略。所以在重力的影响下(魔幻花园的重力加速度为$g$)，水流的轨迹是一条完美的抛物线。空间上的任意点都最多被三个喷头喷到，两条水流相交不会影响各自的轨迹。\n\n近些年来魔幻花园附近新建了许多工厂，圣水河受到了污染，栋栋不想受污染的水影响到他的花园，所以他要使用魔法先净化一下浇灌的水。栋栋的魔法只能净化从喷头喷出来的水，他可以施魔法在空中的一个水平面形成一个凸多边形的滤水层，所有通过滤水层的水都会被净化，施这个魔法需要的能量和滤水层的面积成正比，每平方米滤水层需要$1$单位的魔法能量。栋栋想净化所有的水，他最少需要多少能量呢？ \n\n为了更好的描述问题，栋栋在花园建立起了一个三维的直角坐标系，以花园的西北角为坐标轴的原点，从原点向东是$x$轴的正方向，向南是$y$轴的正方向，向上是$z$轴的正方向。这样第$i$个喷头的位置可以用$(x_i,y_i,h)$来表示，而第$j$棵魔幻植物的位置可以用$(x_j',y_j',0)$来表示。", "inputFormat": "输入文件*garden.in*第一行为两个实数$h, g$，表示喷头的高度和魔幻花园的重力加速度。第二行为整数$n$，表示有多少个喷头。 \n\n接下来$n$行，每行四个整数$x_i, y_i, x_i', y_i'$，整数间使用一个空格分隔。表示第i个喷头的坐标是$(x_i, y_i, h)$，它喷出的水正好浇灌到了$(x_i', y_i', 0)$位置的魔幻植物上。", "outputFormat": "输出文件*garden.out*仅有一个实数，表示栋栋最少需要的能量，至少精确到小数点后3位。", "hint": "**【样例说明1】**\n\n在高度为$35$的地方施魔法，此时所有的水流正好汇合到$(100, 100, 35)$这点，所以需要的能量为$0$。\n\n**【样例说明2】**\n\n在高度为$10$的地方（即喷头处）施魔法，魔法形成一个直角三角形，三个点的坐标分别为：$(0,0,10), (1,0,10), (0,50,10)$，面积为$25.000$，所以需要的魔法能量也为$25.000$。\n\n**【评分标准】**\n\n对于每个测试点，如果你的答案与标准答案的差不超过$0.001$，则得到该测试点的全部分数；如果你的答案与标准答案的差超过$0.001$但不超过$0.002$，则得到50%的分数；否则得0分。\n\n**【数据规模】**\n\n对于20%的数据，$1 \\leq n \\leq 10$\n\n对于50%的数据，$1 \\leq n \\leq 50$\n\n对于100%的数据，$1 \\leq n \\leq 100$\n\n$0 < h \\leq 10000.0$\n\n$0 < g \\leq 100.0$\n\n$0 \\leq x_i, y_i, x_i', y_i' \\leq 1000$\n\n**【提示】**\n\n水从喷头喷出到地面的过程可以看成一个平抛运动。平抛运动可以分解为向\n水平方向和竖直方向的两个分运动：\n\n令$L = (x_i - x_i')^2 + (y_i - y_i')^2$，则\n\n初始速度$v_0 = \\sqrt{\\frac{Lg}{2h}}$\n\n$t$时刻的水平分速度：$v_{\\text{平}}(t) = v_0$\n\n$t$时刻的竖直分速度：$v_{\\text{竖}}(t) = gt$\n\n$t$时刻的速度：$v(t) = \\sqrt{v_{\\text{平}}^2(t) + v_{\\text{竖}}^2(t)}$", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2009] Magic Garden", "background": "", "description": "Wizard Dongdong has a beautiful magic garden filled with all kinds of magical plants, blooming with colorful flowers throughout the year. Dongdong’s friends love to come and play in the garden.\n\nThe garden’s irrigation system is specially designed by Dongdong. He used magic to create $n$ sprinklers suspended over the garden, all connected to the nearby Holy Water River. When irrigating, all sprinklers simultaneously eject streams of water. The water traces beautiful arcs in the air and lands precisely on the $n$ most water-starved magical plants.\n\n![Sprinklers](https://cdn.luogu.com.cn/upload/pic/18045.png)\n\nDongdong placed every sprinkler at the same height $h$. All sprinklers are oriented horizontally, so when water is ejected, it has only horizontal velocity (the horizontal velocity may differ between sprinklers). There is no wind in the magic garden, and air resistance is negligible. Therefore, under gravity (the gravitational acceleration in the magic garden is $g$), the water follows perfect parabolic trajectories. Any point in space is reached by water from at most three sprinklers, and intersections of water streams do not affect their trajectories.\n\nIn recent years, many factories have been built near the magic garden, and the Holy Water River has become polluted. Dongdong does not want polluted water to affect his garden, so he intends to purify the irrigation water using magic. His magic can only purify water as it leaves the sprinklers. He can cast a spell to create a convex polygon filter layer lying in some horizontal plane in the air. All water passing through this filter layer will be purified. The energy required to cast this spell is proportional to the area of the filter layer: each square meter of filter layer requires $1$ unit of magical energy. Dongdong wants to purify all the water. What is the minimum energy he needs?\n\nTo better describe the problem, Dongdong sets up a 3D Cartesian coordinate system in the garden with the northwest corner as the origin. The positive $x$-axis points east, the positive $y$-axis points south, and the positive $z$-axis points upward. Thus the position of the $i$-th sprinkler is $(x_i, y_i, h)$, and the position of the $j$-th magical plant is $(x_j', y_j', 0)$.", "inputFormat": "The first line contains two real numbers $h, g$, representing the sprinklers’ height and the gravitational acceleration in the magic garden.\n\nThe second line contains an integer $n$, the number of sprinklers.\n\nEach of the next $n$ lines contains four integers $x_i, y_i, x_i', y_i'$, separated by a space. This means the $i$-th sprinkler is at $(x_i, y_i, h)$, and its water lands exactly on the magical plant at $(x_i', y_i', 0)$.", "outputFormat": "Output a single real number: the minimum energy required by Dongdong, accurate to at least 3 decimal places.", "hint": "【Sample Explanation 1】\n\nIf the magic is cast at height $35$, all water streams converge at the point $(100, 100, 35)$, so the required energy is $0$.\n\n【Sample Explanation 2】\n\nIf the magic is cast at height $10$ (i.e., at the sprinklers), the magic forms a right triangle with vertices $(0, 0, 10)$, $(1, 0, 10)$, and $(0, 50, 10)$. Its area is $25.000$, so the required magical energy is also $25.000$.\n\n【Scoring】\n\nFor each test point, if your answer differs from the standard answer by no more than $0.001$, you receive full score for that test point; if the difference is greater than $0.001$ but no more than $0.002$, you receive 50% of the score; otherwise, you receive 0.\n\n【Constraints】\n\n- For 20% of the testdata, $1 \\leq n \\leq 10$.\n- For 50% of the testdata, $1 \\leq n \\leq 50$.\n- For 100% of the testdata, $1 \\leq n \\leq 100$.\n- $0 < h \\leq 10000.0$.\n- $0 < g \\leq 100.0$.\n- $0 \\leq x_i, y_i, x_i', y_i' \\leq 1000$.\n\n【Tips】\n\nThe motion of water from the sprinkler to the ground can be regarded as horizontal projectile motion. It can be decomposed into two component motions along the horizontal and vertical directions.\n\nLet $L = (x_i - x_i')^2 + (y_i - y_i')^2$. Then:\n\nInitial speed: $v_0 = \\sqrt{\\frac{Lg}{2h}}$.\n\nHorizontal component of velocity at time $t$: $v_{\\text{平}}(t) = v_0$.\n\nVertical component of velocity at time $t$: $v_{\\text{竖}}(t) = gt$.\n\nSpeed at time $t$: $v(t) = \\sqrt{v_{\\text{平}}^2(t) + v_{\\text{竖}}^2(t)}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2009] 魔幻花园", "background": "", "description": "魔法师栋栋有一个美丽的魔幻花园，在花园里，栋栋种满各式各样的魔幻植物，花园里一年四季都开满着姹紫嫣红的鲜花。栋栋的朋友们都特别喜欢来花园里玩。\n\n花园的浇灌系统是由栋栋特别设计的，栋栋用魔法在花园上空变出了$n$个喷头，这些喷头都连接着附近的圣水河。浇灌的时候，所有的喷头一起喷出一道道水流，水流在空中划出一道道美丽的弧线，最终正好浇灌到n棵最缺水的魔幻植物上。\n\n![喷头](https://cdn.luogu.com.cn/upload/pic/18045.png)\n\n栋栋把每个喷头都设在同一水平高度$h$。所有的喷头都是水平放置的，当水流从喷头喷出时，只有水平的速度(每个喷头的水平速度不一定相同)。魔幻花园里没有风，空气阻力可以忽略。所以在重力的影响下(魔幻花园的重力加速度为$g$)，水流的轨迹是一条完美的抛物线。空间上的任意点都最多被三个喷头喷到，两条水流相交不会影响各自的轨迹。\n\n近些年来魔幻花园附近新建了许多工厂，圣水河受到了污染，栋栋不想受污染的水影响到他的花园，所以他要使用魔法先净化一下浇灌的水。栋栋的魔法只能净化从喷头喷出来的水，他可以施魔法在空中的一个水平面形成一个凸多边形的滤水层，所有通过滤水层的水都会被净化，施这个魔法需要的能量和滤水层的面积成正比，每平方米滤水层需要$1$单位的魔法能量。栋栋想净化所有的水，他最少需要多少能量呢？ \n\n为了更好的描述问题，栋栋在花园建立起了一个三维的直角坐标系，以花园的西北角为坐标轴的原点，从原点向东是$x$轴的正方向，向南是$y$轴的正方向，向上是$z$轴的正方向。这样第$i$个喷头的位置可以用$(x_i,y_i,h)$来表示，而第$j$棵魔幻植物的位置可以用$(x_j',y_j',0)$来表示。", "inputFormat": "输入文件*garden.in*第一行为两个实数$h, g$，表示喷头的高度和魔幻花园的重力加速度。第二行为整数$n$，表示有多少个喷头。 \n\n接下来$n$行，每行四个整数$x_i, y_i, x_i', y_i'$，整数间使用一个空格分隔。表示第i个喷头的坐标是$(x_i, y_i, h)$，它喷出的水正好浇灌到了$(x_i', y_i', 0)$位置的魔幻植物上。", "outputFormat": "输出文件*garden.out*仅有一个实数，表示栋栋最少需要的能量，至少精确到小数点后3位。", "hint": "**【样例说明1】**\n\n在高度为$35$的地方施魔法，此时所有的水流正好汇合到$(100, 100, 35)$这点，所以需要的能量为$0$。\n\n**【样例说明2】**\n\n在高度为$10$的地方（即喷头处）施魔法，魔法形成一个直角三角形，三个点的坐标分别为：$(0,0,10), (1,0,10), (0,50,10)$，面积为$25.000$，所以需要的魔法能量也为$25.000$。\n\n**【评分标准】**\n\n对于每个测试点，如果你的答案与标准答案的差不超过$0.001$，则得到该测试点的全部分数；如果你的答案与标准答案的差超过$0.001$但不超过$0.002$，则得到50%的分数；否则得0分。\n\n**【数据规模】**\n\n对于20%的数据，$1 \\leq n \\leq 10$\n\n对于50%的数据，$1 \\leq n \\leq 50$\n\n对于100%的数据，$1 \\leq n \\leq 100$\n\n$0 < h \\leq 10000.0$\n\n$0 < g \\leq 100.0$\n\n$0 \\leq x_i, y_i, x_i', y_i' \\leq 1000$\n\n**【提示】**\n\n水从喷头喷出到地面的过程可以看成一个平抛运动。平抛运动可以分解为向\n水平方向和竖直方向的两个分运动：\n\n令$L = (x_i - x_i')^2 + (y_i - y_i')^2$，则\n\n初始速度$v_0 = \\sqrt{\\frac{Lg}{2h}}$\n\n$t$时刻的水平分速度：$v_{\\text{平}}(t) = v_0$\n\n$t$时刻的竖直分速度：$v_{\\text{竖}}(t) = gt$\n\n$t$时刻的速度：$v(t) = \\sqrt{v_{\\text{平}}^2(t) + v_{\\text{竖}}^2(t)}$", "locale": "zh-CN"}}}
{"pid": "P4491", "type": "P", "difficulty": 6, "samples": [["8 8 3\n3999 8477 9694 8454 3308 8961 3018 2255 4910", "524070430"], ["见 sample.zip/data2.in", "见 sample.zip/data2.ans"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "河南", "各省省选", "O2优化", "容斥原理", "生成函数", "快速数论变换 NTT"], "title": "[HAOI2018] 染色", "background": "HAOI2018 Round2 第二题", "description": "为了报答小 C 的苹果，小 G 打算送给热爱美术的小 C 一块画布，这块画布可以抽象为一个长度为 $N$ 的序列，每个位置都可以被染成 $M$ 种颜色中的某一种。\n\n然而小 C 只关心序列的 $N$ 个位置中出现次数恰好为 $S$ 的颜色种数，如果恰好出现了 $S$ 次的颜色有 $K$ 种，则小 C 会产生 $W_k$ 的愉悦度。\n\n小 C 希望知道对于所有可能的染色方案，他能获得的愉悦度的和对 $1004535809$\n取模的结果是多少。", "inputFormat": "从标准输入读入数据。第一行三个整数 $N, M, S$。\n\n接下来一行 $M + 1$ 个整数，第 $i$ 个数表示 $W_{i-1}$。", "outputFormat": "输出到标准输出中。输出一个整数表示答案。", "hint": "特殊性质: $\\forall 1 \\le i \\le m, W_i = 0$。\n\n对于 $100\\%$ 的数据，满足 $1 \\le N \\le 10 ^ 7$，$1 \\le M \\le 10 ^ 5$，$1 \\le S \\le 150$，$0 \\le W_i < 1004535809$。\n\n![Data](https://cdn.luogu.com.cn/upload/pic/18057.png)\n", "locale": "zh-CN", "translations": {"en": {"title": "[HAOI2018] Coloring", "background": "HAOI2018 Round 2 Problem 2.", "description": "To repay Xiao C for the apples, Xiao G plans to give art-loving Xiao C a canvas. This canvas can be abstracted as a sequence of length $N$, and each position can be painted with one of $M$ colors.\n\nHowever, Xiao C only cares about the number of colors that appear exactly $S$ times among the $N$ positions. If there are $K$ colors that appear exactly $S$ times, then Xiao C will gain happiness $W_k$.\n\nXiao C wants to know, over all possible colorings, what the sum of the happiness he can obtain is, modulo $1004535809$.", "inputFormat": "Read from standard input. The first line contains three integers $N, M, S$.\n\nThe next line contains $M + 1$ integers; the $i$-th number denotes $W_{i-1}$.", "outputFormat": "Output to standard output. Output a single integer representing the answer.", "hint": "Special property: $\\forall 1 \\le i \\le M, W_i = 0$.\n\nConstraints: For $100\\%$ of the testdata, $1 \\le N \\le 10^7$, $1 \\le M \\le 10^5$, $1 \\le S \\le 150$, $0 \\le W_i < 1004535809$.\n\n![Data](https://cdn.luogu.com.cn/upload/pic/18057.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HAOI2018] 染色", "background": "HAOI2018 Round2 第二题", "description": "为了报答小 C 的苹果，小 G 打算送给热爱美术的小 C 一块画布，这块画布可以抽象为一个长度为 $N$ 的序列，每个位置都可以被染成 $M$ 种颜色中的某一种。\n\n然而小 C 只关心序列的 $N$ 个位置中出现次数恰好为 $S$ 的颜色种数，如果恰好出现了 $S$ 次的颜色有 $K$ 种，则小 C 会产生 $W_k$ 的愉悦度。\n\n小 C 希望知道对于所有可能的染色方案，他能获得的愉悦度的和对 $1004535809$\n取模的结果是多少。", "inputFormat": "从标准输入读入数据。第一行三个整数 $N, M, S$。\n\n接下来一行 $M + 1$ 个整数，第 $i$ 个数表示 $W_{i-1}$。", "outputFormat": "输出到标准输出中。输出一个整数表示答案。", "hint": "特殊性质: $\\forall 1 \\le i \\le m, W_i = 0$。\n\n对于 $100\\%$ 的数据，满足 $1 \\le N \\le 10 ^ 7$，$1 \\le M \\le 10 ^ 5$，$1 \\le S \\le 150$，$0 \\le W_i < 1004535809$。\n\n![Data](https://cdn.luogu.com.cn/upload/pic/18057.png)\n", "locale": "zh-CN"}}}
{"pid": "P4492", "type": "P", "difficulty": 6, "samples": [["3 610745795", "24"], ["305 1000000007", "865018107"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "河南", "各省省选", "O2优化", "树形 DP", "组合数学", "排列组合", "概率论"], "title": "[HAOI2018] 苹果树", "background": "HAOI2018 Round2 第一题", "description": "小 C 在自己家的花园里种了一棵苹果树, 树上每个结点都有恰好两个分支. 经过细心的观察, 小 C 发现每一天这棵树都会生长出一个新的结点.\n\n第一天的时候, 果树会长出一个根结点, 以后每一天, 果树会随机选择一个当前树中没有长出过结点 的分支, 然后在这个分支上长出一个新结点, 新结点与分支所属的结点之间连接上一条边.\n\n小 C 定义一棵果树的不便度为树上两两结点之间的距离之和, 两个结点之间 的距离定义为从一个点走到另一个点的路径经过的边数.\n\n现在他非常好奇, 如果 $N$ 天之后小 G 来他家摘苹果, 这个不便度的期望 $E$ 是多少. 但是小 C 讨厌分数, 所以他只想知道 $E \\times N !$ 对 $P$ 取模的结果, 可以证明这是一个整数.", "inputFormat": "从标准输入中读入数据. 一行两个整数 $N$, $P$ .", "outputFormat": "输出到标准输出中. 输出一个整数表示答案．", "hint": "![Explanation](https://cdn.luogu.com.cn/upload/pic/18067.png)\n\n以上是所有 $N = 3$ 时可能的苹果树形态, 其中编号表示这个结点是第几天生\n长出来的, 显然每种情况两两结点的距离均为 $4$ .\n\n### 数据范围与约定\n| 测试点编号   | $N$  | $P$  |\n| :--------: | :--: | :--: |\n| $1$ |  $\\le 10$    |  $\\le 10^9 + 7$    |\n| $2$ |  $\\le 10$    |   $\\le 10^9 + 7$    |\n| $3$ |  $\\le 500$    |  $\\le 10^9 + 7$     |\n| $4$ |  $\\le 500$    |   $\\le 10^9 + 7$    |\n| $5$ |  $\\le 500$    |   $\\le 10^9 + 7$    |\n| $6$ |  $\\le 2000$    |   $= 10^9 + 7$    |\n| $7$ |  $\\le 2000$    |   $= 10^9 + 7$    |\n| $8$ |  $\\le 2000$    |   $\\le 10^9 + 7$    |\n| $9$ |  $\\le 2000$    |   $\\le 10^9 + 7$    |\n| $10$ | $\\le 2000$     |    $\\le 10^9 + 7$   |\n\n", "locale": "zh-CN", "translations": {"en": {"title": "[HAOI2018] Apple Tree", "background": "HAOI2018 Round2 Problem 1.", "description": "Xiao C planted an apple tree in his garden. Every node on the tree has exactly two branches. After careful observation, Xiao C found that each day the tree grows exactly one new node.\n\nOn the first day, the tree grows a root node. On every subsequent day, the tree randomly chooses one branch in the current tree that has not yet produced a node, and grows a new node on that branch. The new node is connected by an edge to the node that the branch belongs to.\n\nXiao C defines the “inconvenience” of an apple tree as the sum of distances between all pairs of nodes on the tree. The distance between two nodes is defined as the number of edges on the path from one to the other.\n\nHe is very curious: if Xiao G comes to pick apples after $N$ days, what is the expected inconvenience $E$? However, Xiao C hates fractions, so he only wants to know the result of $E \\times N !$ modulo $P$. It can be proven that this is an integer.", "inputFormat": "Read from standard input. A single line contains two integers $N$, $P$.", "outputFormat": "Print to standard output. Output a single integer representing the answer.", "hint": "![Explanation](https://cdn.luogu.com.cn/upload/pic/18067.png)\n\nThe above shows all possible apple tree shapes when $N = 3$, where the label on each node indicates the day on which it grew. Clearly, in every case the sum of pairwise node distances is $4$.\n\n### Constraints\n| Test point ID | $N$ | $P$ |\n| :--------: | :--: | :--: |\n| $1$ | $\\le 10$ | $\\le 10^9 + 7$ |\n| $2$ | $\\le 10$ | $\\le 10^9 + 7$ |\n| $3$ | $\\le 500$ | $\\le 10^9 + 7$ |\n| $4$ | $\\le 500$ | $\\le 10^9 + 7$ |\n| $5$ | $\\le 500$ | $\\le 10^9 + 7$ |\n| $6$ | $\\le 2000$ | $= 10^9 + 7$ |\n| $7$ | $\\le 2000$ | $= 10^9 + 7$ |\n| $8$ | $\\le 2000$ | $\\le 10^9 + 7$ |\n| $9$ | $\\le 2000$ | $\\le 10^9 + 7$ |\n| $10$ | $\\le 2000$ | $\\le 10^9 + 7$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HAOI2018] 苹果树", "background": "HAOI2018 Round2 第一题", "description": "小 C 在自己家的花园里种了一棵苹果树, 树上每个结点都有恰好两个分支. 经过细心的观察, 小 C 发现每一天这棵树都会生长出一个新的结点.\n\n第一天的时候, 果树会长出一个根结点, 以后每一天, 果树会随机选择一个当前树中没有长出过结点 的分支, 然后在这个分支上长出一个新结点, 新结点与分支所属的结点之间连接上一条边.\n\n小 C 定义一棵果树的不便度为树上两两结点之间的距离之和, 两个结点之间 的距离定义为从一个点走到另一个点的路径经过的边数.\n\n现在他非常好奇, 如果 $N$ 天之后小 G 来他家摘苹果, 这个不便度的期望 $E$ 是多少. 但是小 C 讨厌分数, 所以他只想知道 $E \\times N !$ 对 $P$ 取模的结果, 可以证明这是一个整数.", "inputFormat": "从标准输入中读入数据. 一行两个整数 $N$, $P$ .", "outputFormat": "输出到标准输出中. 输出一个整数表示答案．", "hint": "![Explanation](https://cdn.luogu.com.cn/upload/pic/18067.png)\n\n以上是所有 $N = 3$ 时可能的苹果树形态, 其中编号表示这个结点是第几天生\n长出来的, 显然每种情况两两结点的距离均为 $4$ .\n\n### 数据范围与约定\n| 测试点编号   | $N$  | $P$  |\n| :--------: | :--: | :--: |\n| $1$ |  $\\le 10$    |  $\\le 10^9 + 7$    |\n| $2$ |  $\\le 10$    |   $\\le 10^9 + 7$    |\n| $3$ |  $\\le 500$    |  $\\le 10^9 + 7$     |\n| $4$ |  $\\le 500$    |   $\\le 10^9 + 7$    |\n| $5$ |  $\\le 500$    |   $\\le 10^9 + 7$    |\n| $6$ |  $\\le 2000$    |   $= 10^9 + 7$    |\n| $7$ |  $\\le 2000$    |   $= 10^9 + 7$    |\n| $8$ |  $\\le 2000$    |   $\\le 10^9 + 7$    |\n| $9$ |  $\\le 2000$    |   $\\le 10^9 + 7$    |\n| $10$ | $\\le 2000$     |    $\\le 10^9 + 7$   |\n\n", "locale": "zh-CN"}}}
{"pid": "P4493", "type": "P", "difficulty": 7, "samples": [["10 11\nabcbababab\nababcbabab\n5\n1 9 7 9\n3 10 8 10\n1 10 1 2\n5 7 2 3\n1 5 3 6", "6\n10\n22\n5\n10"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "河南", "各省省选", "O2优化"], "title": "[HAOI2018] 字串覆盖", "background": null, "description": "小 C 对字符串颇有研究，他觉得传统的字符串匹配太无聊了，于是他想到了这样一个问题。\n\n对于两个长度为 $n$ 的串 $A,B$，小 C 每次会给出给出 $4$ 个参数 $s,t,l,r$。令 $A$ 从 $s$ 到 $t$ 的\n子串（从 $1$ 开始标号）为 $T$，令 $B$ 从 $l$ 到 $r$ 的子串为 $P$。然后他会进行下面的操作：\n\n如果 $T$ 的某个子串与 $P$ 相同，我们就可以覆盖 $T$ 的这个子串，并获得 $K-i$ 的收益，其中 $i$ 是初始时 $A$ 中（注意不是 $T$ 中）这个子串的起始位置，$K$ 是给定的参数。一个位置不能被覆盖多次．覆盖操作可以进行任意多次，你需要输出获得收益的最大值。\n\n注意每次询问都是独立的，即进行一次询问后，覆盖的位置会复原。", "inputFormat": "第一行两个整数 $n,K$ 表示字符串长度和参数。\n\n接下来一行一个字符串 $A$。\n\n接下来一行一个字符串 $B$。\n\n接下来一行一个整数 $q$，表示询问个数。\n\n接下来 $q$ 行，每行四个整数 $s,t,l,r$ 表示一次询问。", "outputFormat": "输出 $q$ 行，每行一个整数，表示一个询问的答案．", "hint": "样例 $1$ 解释 ![](https://cdn.luogu.com.cn/upload/pic/18143.png)\n\n对于所有数据，有 $1\\le n,q\\le 10^5$，$A,B$ 仅由小写英文字母组成，$ 1\\le s\\le t\\le n$，$ 1\\le l\\le r\\le n$，$n<K\\le 10^9$。\nHAOI2018 round1 T3\n\n对于 $ n = 10^5 $ 的测试点，满足 $51\\le r−l\\le2\\times 10^3$ 的询问不超过 $11000$ 个，且 $l,r$ 均匀随机\n\n数据范围\n![](https://cdn.luogu.com.cn/upload/pic/18142.png)", "locale": "zh-CN", "translations": {"en": {"title": "[HAOI2018] Substring Coverage", "background": "", "description": "Xiao C is quite into strings. He finds traditional string matching too boring, so he came up with the following problem.\n\nFor two strings $A, B$ of length $n$, each time he gives four parameters $s, t, l, r$. Let $T$ be the substring of $A$ from $s$ to $t$ (1-indexed), and let $P$ be the substring of $B$ from $l$ to $r$. Then he performs the following operation:\n\nIf some substring of $T$ equals $P$, we can cover this substring of $T$ and gain $K - i$, where $i$ is the starting position of this substring in $A$ at the beginning (note: not in $T$), and $K$ is a given parameter. A position cannot be covered more than once. The covering operation can be performed any number of times. You need to output the maximum total gain.\n\nNote that each query is independent, i.e., after finishing a query, the covered positions are restored.", "inputFormat": "The first line contains two integers $n, K$, denoting the string length and the parameter.\n\nThe next line contains a string $A$.\n\nThe next line contains a string $B$.\n\nThe next line contains an integer $q$, denoting the number of queries.\n\nEach of the next $q$ lines contains four integers $s, t, l, r$, describing one query.", "outputFormat": "Output $q$ lines, each containing one integer, the answer for each query.", "hint": "Explanation for Sample 1: ![](https://cdn.luogu.com.cn/upload/pic/18143.png)\n\nFor all testdata, $1 \\le n, q \\le 10^5$, $A, B$ consist only of lowercase English letters, $1 \\le s \\le t \\le n$, $1 \\le l \\le r \\le n$, $n < K \\le 10^9$. HAOI2018 Round 1 T3.\n\nFor the testpoint with $n = 10^5$, the number of queries satisfying $51 \\le r - l \\le 2 \\times 10^3$ does not exceed $11000$, and $l, r$ are uniformly random.\n\nConstraints\n![](https://cdn.luogu.com.cn/upload/pic/18142.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HAOI2018] 字串覆盖", "background": null, "description": "小 C 对字符串颇有研究，他觉得传统的字符串匹配太无聊了，于是他想到了这样一个问题。\n\n对于两个长度为 $n$ 的串 $A,B$，小 C 每次会给出给出 $4$ 个参数 $s,t,l,r$。令 $A$ 从 $s$ 到 $t$ 的\n子串（从 $1$ 开始标号）为 $T$，令 $B$ 从 $l$ 到 $r$ 的子串为 $P$。然后他会进行下面的操作：\n\n如果 $T$ 的某个子串与 $P$ 相同，我们就可以覆盖 $T$ 的这个子串，并获得 $K-i$ 的收益，其中 $i$ 是初始时 $A$ 中（注意不是 $T$ 中）这个子串的起始位置，$K$ 是给定的参数。一个位置不能被覆盖多次．覆盖操作可以进行任意多次，你需要输出获得收益的最大值。\n\n注意每次询问都是独立的，即进行一次询问后，覆盖的位置会复原。", "inputFormat": "第一行两个整数 $n,K$ 表示字符串长度和参数。\n\n接下来一行一个字符串 $A$。\n\n接下来一行一个字符串 $B$。\n\n接下来一行一个整数 $q$，表示询问个数。\n\n接下来 $q$ 行，每行四个整数 $s,t,l,r$ 表示一次询问。", "outputFormat": "输出 $q$ 行，每行一个整数，表示一个询问的答案．", "hint": "样例 $1$ 解释 ![](https://cdn.luogu.com.cn/upload/pic/18143.png)\n\n对于所有数据，有 $1\\le n,q\\le 10^5$，$A,B$ 仅由小写英文字母组成，$ 1\\le s\\le t\\le n$，$ 1\\le l\\le r\\le n$，$n<K\\le 10^9$。\nHAOI2018 round1 T3\n\n对于 $ n = 10^5 $ 的测试点，满足 $51\\le r−l\\le2\\times 10^3$ 的询问不超过 $11000$ 个，且 $l,r$ 均匀随机\n\n数据范围\n![](https://cdn.luogu.com.cn/upload/pic/18142.png)", "locale": "zh-CN"}}}
{"pid": "P4494", "type": "P", "difficulty": 6, "samples": [["2\n5 5\n1 2\n2 3\n3 4\n2 4\n3 5\n00000\n5 4\n1 2\n2 3\n2 4\n2 5\n11111", "2 2 1 1 1 2\n0 1 0 1 1 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "河南", "各省省选", "O2优化"], "title": "[HAOI2018] 反色游戏", "background": null, "description": "小 C 和小 G 经常在一起研究搏弈论问题，有一天他们想到了这样一个游戏——\n\n有一张 $n$ 个点 $m$ 条边的无向图，初始时每个节点有一个颜色，要么是黑色，要么是白色。\n\n现在他们对于每条边做出一次抉择：要么将这条边连接的两个节点都反色（黑变白，白变黑），要么不作处理。\n\n他们想把所有节点都变为白色，于是他们想知道在所有 $2^m$ 种可能的决策中，有多少种方案能达成这个目标。\n\n然而，小 G 认为这个问题太水了，于是他还想知道，对于第 $i$ 个点，在删去这个点及与它相连的边后，新的答案是多少。\n\n由于答案可能很大，你只需要输出答案对 $10^9+7$ 取模后的结果。", "inputFormat": "第一行一个正整数 $T$，表示数据组数。\n\n对于每组数据：\n\n第一行两个整数 $n,m$ 表示图的点数和边数。\n\n接下来 $m$ 行，每行两个整数 $u,v$，描述无向图的一条边 $(u,v)$。\n\n接下来一行一个长度为 $n$ 的 01 串：\n\n- 如果第 $i$ 个字符为 $\\tt 0$，表示第 $i$ 个点为白色；\n- 如果第 $i$ 个字符为 $\\tt 1$，表示第 $i$ 个点为黑色。", "outputFormat": "对于每组数据，输出一行 $n+1$ 个整数：\n\n第一个整数表示不删去任何点时的答案（输出后不要换行）；\n\n接下来 $n$ 个整数，第 $i$ 个表示删去第 $i$ 个点时的答案。\n\n答案对 $10^9+7$ 取模。", "hint": "对于所有数据，有 $1\\le T\\le l0^5,1\\le n,m\\le10^5,1\\le u,v\\le n$，且给定的无向图没有重边和自环。\n\n![](https://cdn.luogu.com.cn/upload/pic/18145.png)\n\n*[Source: HAOI2018 Day 1 T2]*", "locale": "zh-CN", "translations": {"en": {"title": "[HAOI2018] Color Inversion Game", "background": "", "description": "Xiao C and Xiao G often study game theory together. One day they came up with the following game—\n\nThere is an undirected graph with $n$ vertices and $m$ edges. Initially, each vertex has a color: either black or white.\n\nFor each edge, they make one decision: either flip the colors of both endpoints of this edge (black becomes white, white becomes black), or do nothing.\n\nThey want to make all vertices white, so they would like to know, among all $2^m$ possible decisions, how many ways can achieve this goal.\n\nHowever, Xiao G thinks this is too easy, so he also wants to know, for the $i$-th vertex, after deleting this vertex and all edges incident to it, what the new answer is.\n\nSince the answer can be large, you only need to output the result modulo $10^9+7$.", "inputFormat": "The first line contains a positive integer $T$, the number of test cases.\n\nFor each test case:\n\nThe first line contains two integers $n, m$, the numbers of vertices and edges.\n\nThe next $m$ lines each contain two integers $u, v$, describing an undirected edge $(u, v)$.\n\nThen one line contains a binary string of length $n$:\n- If the $i$-th character is $\\tt 0$, vertex $i$ is white.\n- If the $i$-th character is $\\tt 1$, vertex $i$ is black.", "outputFormat": "For each test case, output one line with $n+1$ integers:\nThe first integer is the answer when no vertex is deleted (do not add a line break right after printing it); then output $n$ integers, where the $i$-th is the answer after deleting vertex $i$. Each answer is taken modulo $10^9+7$.", "hint": "Constraints: For all testdata, $1 \\le T \\le 10^5, 1 \\le n, m \\le 10^5, 1 \\le u, v \\le n$, and the given undirected graph has no multiple edges or self-loops.\n\n![](https://cdn.luogu.com.cn/upload/pic/18145.png)\n\n*[Source: HAOI2018 Day 1 T2]*\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HAOI2018] 反色游戏", "background": null, "description": "小 C 和小 G 经常在一起研究搏弈论问题，有一天他们想到了这样一个游戏——\n\n有一张 $n$ 个点 $m$ 条边的无向图，初始时每个节点有一个颜色，要么是黑色，要么是白色。\n\n现在他们对于每条边做出一次抉择：要么将这条边连接的两个节点都反色（黑变白，白变黑），要么不作处理。\n\n他们想把所有节点都变为白色，于是他们想知道在所有 $2^m$ 种可能的决策中，有多少种方案能达成这个目标。\n\n然而，小 G 认为这个问题太水了，于是他还想知道，对于第 $i$ 个点，在删去这个点及与它相连的边后，新的答案是多少。\n\n由于答案可能很大，你只需要输出答案对 $10^9+7$ 取模后的结果。", "inputFormat": "第一行一个正整数 $T$，表示数据组数。\n\n对于每组数据：\n\n第一行两个整数 $n,m$ 表示图的点数和边数。\n\n接下来 $m$ 行，每行两个整数 $u,v$，描述无向图的一条边 $(u,v)$。\n\n接下来一行一个长度为 $n$ 的 01 串：\n\n- 如果第 $i$ 个字符为 $\\tt 0$，表示第 $i$ 个点为白色；\n- 如果第 $i$ 个字符为 $\\tt 1$，表示第 $i$ 个点为黑色。", "outputFormat": "对于每组数据，输出一行 $n+1$ 个整数：\n\n第一个整数表示不删去任何点时的答案（输出后不要换行）；\n\n接下来 $n$ 个整数，第 $i$ 个表示删去第 $i$ 个点时的答案。\n\n答案对 $10^9+7$ 取模。", "hint": "对于所有数据，有 $1\\le T\\le l0^5,1\\le n,m\\le10^5,1\\le u,v\\le n$，且给定的无向图没有重边和自环。\n\n![](https://cdn.luogu.com.cn/upload/pic/18145.png)\n\n*[Source: HAOI2018 Day 1 T2]*", "locale": "zh-CN"}}}
{"pid": "P4495", "type": "P", "difficulty": 6, "samples": [["3 3 6\n1 3 4\n5 2 3", "5\n6\n6"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "2018", "河南", "各省省选", "O2优化", "枚举"], "title": "[HAOI2018] 奇怪的背包", "background": "", "description": "小 C 非常擅长背包问题，他有一个奇怪的背包，这个背包有一个参数 $P$ ，当他向这个背包内放入若干个物品后，背包的重量是物品总体积对 $P$ 取模后的结果。\n\n现在小 C 有 $n$ 种体积不同的物品，第 $i$ 种占用体积为 $V_i$ ，每种物品都有无限个。他会进行 $q$ 次询问，每次询问给出重量 $w_i$ ，你需要回答有多少种放入物品的方案，能将一个初始为空的背包的重量变为 $w_i$。注意，两种方案被认为是不同的，当且仅当放入物品的种类不同，而与每种物品放入的个数无关．不难发现总的方案数为 $2^n$。\n\n由于答案可能很大，你只需要输出答案对 $10^9 + 7$ 取模的结果。", "inputFormat": "第一行三个整数 $n, q, P$，含义见问题描述。\n\n接下来一行 $n$ 个整数表示 $V_i$。\n\n接下来一行 $q$ 个整数表示 $w_i$。", "outputFormat": "输出 $q$ 行，每行一个整数表示答案。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/18144.png)\nHAOI2018 round1 T1", "locale": "zh-CN", "translations": {"en": {"title": "[HAOI2018] Strange Knapsack", "background": "", "description": "Xiao C is very good at knapsack problems. He has a strange knapsack with a parameter $P$. After he puts some items into this knapsack, the knapsack’s weight is the total volume of the items modulo $P$.\n\nNow there are $n$ types of items with different volumes. The $i$-th type has volume $V_i$, and each type has an unlimited supply. He will make $q$ queries. For each query, a weight $w_i$ is given. You need to answer how many ways there are to put items so that the weight of an initially empty knapsack becomes $w_i$. Note that two ways are considered different if and only if the types of items used are different, regardless of how many of each type are used. It is not hard to see that the total number of ways is $2^n$.\n\nSince the answer may be large, you only need to output it modulo $10^9 + 7$.", "inputFormat": "The first line contains three integers $n, q, P$, as described above.\n\nThe next line contains $n$ integers denoting $V_i$.\n\nThe next line contains $q$ integers denoting $w_i$.", "outputFormat": "Output $q$ lines, each containing one integer, the answer for that query.", "hint": "![](https://cdn.luogu.com.cn/upload/pic/18144.png)\nHAOI2018 round1 T1\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HAOI2018] 奇怪的背包", "background": "", "description": "小 C 非常擅长背包问题，他有一个奇怪的背包，这个背包有一个参数 $P$ ，当他向这个背包内放入若干个物品后，背包的重量是物品总体积对 $P$ 取模后的结果。\n\n现在小 C 有 $n$ 种体积不同的物品，第 $i$ 种占用体积为 $V_i$ ，每种物品都有无限个。他会进行 $q$ 次询问，每次询问给出重量 $w_i$ ，你需要回答有多少种放入物品的方案，能将一个初始为空的背包的重量变为 $w_i$。注意，两种方案被认为是不同的，当且仅当放入物品的种类不同，而与每种物品放入的个数无关．不难发现总的方案数为 $2^n$。\n\n由于答案可能很大，你只需要输出答案对 $10^9 + 7$ 取模的结果。", "inputFormat": "第一行三个整数 $n, q, P$，含义见问题描述。\n\n接下来一行 $n$ 个整数表示 $V_i$。\n\n接下来一行 $q$ 个整数表示 $w_i$。", "outputFormat": "输出 $q$ 行，每行一个整数表示答案。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/18144.png)\nHAOI2018 round1 T1", "locale": "zh-CN"}}}
{"pid": "P4496", "type": "P", "difficulty": 7, "samples": [["3 1\n1 5\n2 4\n3 6\n1 2 3", "9\n2 5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2009", "提交答案", "Special Judge", "CTSC/CTS"], "title": "[CTSC2009] 移民站选址", "background": "", "description": "2323年，随着科技的发展以及地球日趋严重的人口压力，人类开始大规模向火星移民。令人欣慰的是，移民工程的第一步取得了巨大的成功，已经在火星表面建立了$N$个移民站，其中第i个移民站的坐标是$(u_i, v_i)$。但是在进行后续的移民工作时，人们遇到了一个严峻的问题：如何选择新建的移民站的地址。经过调查确定，需要在火星上新建$M$个移民站，已知原有的第$i$个移民站和新建的第$j$个移民站之间信息传输的流量是$A_{i,j}$，新建的第$j$个移民站和第$k$个移民站之间信息传输的流量是$B_{j,k}$，同时假定，将一个单位流量的信息传输一个单位距离的费用是$1$，这里的距离定义为曼哈顿距离。两个点$(x_1, y_1)$和$(x_2, y_2)$的曼哈顿距离定义如下：\n\n$$ \\mathrm{ManhattanDist}( (x_1, y_1), (x_2, y_2) ) = |x_1 - x_2| + |y_1 - y_2| $$\n\n现在的问题是，给定原有的$N$个移民站的地址和信息流量传输矩阵$A$、$B$，需要你为这$M$个新的移民站选择地址，使得信息传输总费用最小。", "inputFormat": "输入文件为*locate1.in~locate10.in*，第一行为两个整数$N$、$M$，表示原有移民站的数目和需要新建的移民站的数目。接下来的N行每行包含两个整数，表示原有的移民站的坐标；接下来$N$行每行包含$M$个整数，表示信息流量传输矩阵$A$；最后$M-1$行中，第$i$行包含$M-i$个整数，其中的第$j$个表示$B_{i,i+j}$。", "outputFormat": "输出文件为*locate1.out~locate10.out*，*locate?.out*对应*locate?.in*的答案。输出的第一行为一个整数，表示你所计算出的信息传输费用。接下来的$M$行每行包含两个整数，其中第$i$行表示第$i$个新建的移民站的坐标。", "hint": "本题输入数据下载：[百度网盘](https://pan.baidu.com/s/1hEbcB45kL25wbXqEeew7Yg)\n\n**【评分标准】**\n\n每个测试点单独评分。\n\n对于每一个测试点，如果你给出的输出文件不合法，如文件格式错误、输出\n解不符合要求等，该测试点得 0 分。否则设你的输出答案长度为 ans，对于不同的测试点，我们还设有 9 个评分相关的常数 c1 ≤ c2 ≤ c3 ≤ c4 ≤ c5 ≤ c6\n≤ c7 ≤ c8 ≤ c9 ≤ c10，你在该测试点中的得分由下列陈述得出：\n\n- 如果 ans > c10，得0分。\n- 如果 ans ≤ c10，得1分。\n- 如果 ans ≤ c9，得2分。\n- 如果 ans ≤ c8，得3分。\n- 如果 ans ≤ c7，得4分。\n- 如果 ans ≤ c6，得5分。\n- 如果 ans ≤ c5，得6分。\n- 如果 ans ≤ c4，得7分。\n- 如果 ans ≤ c3，得8分。\n- 如果 ans ≤ c2，得9分。\n- 如果 ans ≤ c1，得10分。\n- ~~如果 ans < c1，得12分。~~\n- 如果满足多个条件，取得分最大者为最终得分。\n\n**【特别提示】**\n\n请妥善保存输入文件*locate\\*.in* 和你的输出*locate\\*.out*，及时备份，以免误删。☺", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2009] Immigration Station Site Selection", "background": "", "description": "In the year 2323, with technological advances and the increasingly severe population pressure on Earth, humanity began large-scale migration to Mars. Encouragingly, the first step of the migration project achieved great success, and $N$ immigration stations have already been established on the surface of Mars, where the $i$-th station is at coordinates $(u_i, v_i)$. However, when proceeding with subsequent migration work, people encountered a serious problem: how to choose the locations for the new immigration stations. After investigation, it has been determined that $M$ new immigration stations need to be built on Mars. It is known that the information transmission flow between the original $i$-th station and the new $j$-th station is $A_{i,j}$, and the information transmission flow between the new $j$-th station and the $k$-th new station is $B_{j,k}$. At the same time, assume that the cost to transmit one unit of flow over one unit of distance is $1$, where the distance is defined as the Manhattan distance. The Manhattan distance between two points $(x_1, y_1)$ and $(x_2, y_2)$ is defined as follows:\n\n$$ \\mathrm{ManhattanDist}( (x_1, y_1), (x_2, y_2) ) = |x_1 - x_2| + |y_1 - y_2| $$\n\nNow the problem is: given the addresses of the $N$ existing immigration stations and the information flow matrices $A$ and $B$, you need to choose locations for these $M$ new immigration stations so that the total information transmission cost is minimized.", "inputFormat": "The input files are *locate1.in~locate10.in*. The first line contains two integers $N$, $M$, representing the number of existing immigration stations and the number of new stations to be built. The next $N$ lines each contain two integers, representing the coordinates of the existing stations. The next $N$ lines each contain $M$ integers, representing the information flow matrix $A$. In the final $M-1$ lines, the $i$-th line contains $M-i$ integers, where the $j$-th of them represents $B_{i,i+j}$.", "outputFormat": "The output files are *locate1.out~locate10.out*, where *locate?.out* corresponds to the answer for *locate?.in*. The first line of the output is an integer, representing the total information transmission cost you computed. The next $M$ lines each contain two integers; the $i$-th line represents the coordinates of the $i$-th newly built immigration station.", "hint": "The input testdata for this problem can be downloaded from: [Baidu Netdisk](https://pan.baidu.com/s/1hEbcB45kL25wbXqEeew7Yg).\n\n【Scoring Criteria】\n\nEach test point is scored independently.\n\nFor each test point, if your output file is invalid (e.g., file format error, output not meeting requirements, etc.), you receive 0 points for that test point. Otherwise, let your answer be $ans$. For different test points, we also set 10 scoring-related constants satisfying $c_1 \\le c_2 \\le c_3 \\le c_4 \\le c_5 \\le c_6 \\le c_7 \\le c_8 \\le c_9 \\le c_{10}$. Your score for that test point is determined by the following statements:\n\n- If $ans > c_{10}$, you get 0 points.\n- If $ans \\le c_{10}$, you get 1 point.\n- If $ans \\le c_9$, you get 2 points.\n- If $ans \\le c_8$, you get 3 points.\n- If $ans \\le c_7$, you get 4 points.\n- If $ans \\le c_6$, you get 5 points.\n- If $ans \\le c_5$, you get 6 points.\n- If $ans \\le c_4$, you get 7 points.\n- If $ans \\le c_3$, you get 8 points.\n- If $ans \\le c_2$, you get 9 points.\n- If $ans \\le c_1$, you get 10 points.\n- ~~If $ans < c_1$, you get 12 points.~~\n- If multiple conditions are satisfied, the highest applicable score is taken as the final score.\n\n【Special Reminder】\n\nPlease properly save the input files *locate\\*.in* and your outputs *locate\\*.out*, and back them up in time to avoid accidental deletion. ☺\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2009] 移民站选址", "background": "", "description": "2323年，随着科技的发展以及地球日趋严重的人口压力，人类开始大规模向火星移民。令人欣慰的是，移民工程的第一步取得了巨大的成功，已经在火星表面建立了$N$个移民站，其中第i个移民站的坐标是$(u_i, v_i)$。但是在进行后续的移民工作时，人们遇到了一个严峻的问题：如何选择新建的移民站的地址。经过调查确定，需要在火星上新建$M$个移民站，已知原有的第$i$个移民站和新建的第$j$个移民站之间信息传输的流量是$A_{i,j}$，新建的第$j$个移民站和第$k$个移民站之间信息传输的流量是$B_{j,k}$，同时假定，将一个单位流量的信息传输一个单位距离的费用是$1$，这里的距离定义为曼哈顿距离。两个点$(x_1, y_1)$和$(x_2, y_2)$的曼哈顿距离定义如下：\n\n$$ \\mathrm{ManhattanDist}( (x_1, y_1), (x_2, y_2) ) = |x_1 - x_2| + |y_1 - y_2| $$\n\n现在的问题是，给定原有的$N$个移民站的地址和信息流量传输矩阵$A$、$B$，需要你为这$M$个新的移民站选择地址，使得信息传输总费用最小。", "inputFormat": "输入文件为*locate1.in~locate10.in*，第一行为两个整数$N$、$M$，表示原有移民站的数目和需要新建的移民站的数目。接下来的N行每行包含两个整数，表示原有的移民站的坐标；接下来$N$行每行包含$M$个整数，表示信息流量传输矩阵$A$；最后$M-1$行中，第$i$行包含$M-i$个整数，其中的第$j$个表示$B_{i,i+j}$。", "outputFormat": "输出文件为*locate1.out~locate10.out*，*locate?.out*对应*locate?.in*的答案。输出的第一行为一个整数，表示你所计算出的信息传输费用。接下来的$M$行每行包含两个整数，其中第$i$行表示第$i$个新建的移民站的坐标。", "hint": "本题输入数据下载：[百度网盘](https://pan.baidu.com/s/1hEbcB45kL25wbXqEeew7Yg)\n\n**【评分标准】**\n\n每个测试点单独评分。\n\n对于每一个测试点，如果你给出的输出文件不合法，如文件格式错误、输出\n解不符合要求等，该测试点得 0 分。否则设你的输出答案长度为 ans，对于不同的测试点，我们还设有 9 个评分相关的常数 c1 ≤ c2 ≤ c3 ≤ c4 ≤ c5 ≤ c6\n≤ c7 ≤ c8 ≤ c9 ≤ c10，你在该测试点中的得分由下列陈述得出：\n\n- 如果 ans > c10，得0分。\n- 如果 ans ≤ c10，得1分。\n- 如果 ans ≤ c9，得2分。\n- 如果 ans ≤ c8，得3分。\n- 如果 ans ≤ c7，得4分。\n- 如果 ans ≤ c6，得5分。\n- 如果 ans ≤ c5，得6分。\n- 如果 ans ≤ c4，得7分。\n- 如果 ans ≤ c3，得8分。\n- 如果 ans ≤ c2，得9分。\n- 如果 ans ≤ c1，得10分。\n- ~~如果 ans < c1，得12分。~~\n- 如果满足多个条件，取得分最大者为最终得分。\n\n**【特别提示】**\n\n请妥善保存输入文件*locate\\*.in* 和你的输出*locate\\*.out*，及时备份，以免误删。☺", "locale": "zh-CN"}}}
{"pid": "P4497", "type": "P", "difficulty": 7, "samples": [["2 \n5 9 \n9 10 7 6 8 \n1 \n0 4 5 2 \n0 3 5 4 \n1 \n0 2 5 -2 \n0 3 5 -3 \n0 4 5 -2 \n0 5 5 -4 \n1 \n4 3 \n2 4 3 5 \n1 \n0 3 3 3 \n1 ", "3 1 \n5 -1 \n0 0 \n4 -1 \n4 -1 "]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2011", "Special Judge", "WC"], "title": "[WC2011] 拼点游戏", "background": "", "description": "小 W 和小 Y 都很喜欢玩一种“拼点游戏”。游戏中两个人分别通过某种操作产生一个数作为自己的“点数”，点数大的一方获胜。“拼点游戏”的规则如下：\n\n1. 游戏开始时，给定一个包含 $n$ 个元素的正整数序列 $U=(u_1,u_2,\\cdots,u_n)$。\n2. 定义 $U$ 的一个下标序列 $I=(i_1,i_2,\\cdots,i_m)$ 是满足 $1\\leq i_1<i_2<\\cdots<i_m\\leq n$ 的一个整数序列（ $m$ 可以为 0 ，即序列可以为空），并且其对应 $U$ 的子序列为 $V=(u_{i_1},u_{i_2},\\cdots,u_{i_m})$。\n3. 定义下标序列 $I=(i_1,i_2,\\cdots,i_m)$ 对应的点数 $D(I)$ 为： $D(I)=\\sum_{p=1}^m u_{i_p}\\times (-1)^p$。\n4. 进行游戏时两人分别选择一个下标序列，谁选择的下标序列对应的点数 $D(I)$ 大，谁就获胜。\n\n然而在每次游戏中，小 W 总是能准确无误的算出点数最大的最优下标序列。为了让游戏更加具有竞技性，他们制定了下列额外规则：\n\nEx1. 小W可以选择一个非空区间 $[l,r]$，并将 $u_l,u_{l+1},\\cdots,u_r$ 同时增加一个整数 $c$，产生的新序列将取代原序列 $U$。\n\nEx2. 当他们对于当前的 $U$ 序列进行一次“拼点游戏”时，允许小 Y 在小 W 选出最优下标序列 $I=(i_1,i_2,\\cdots,i_m)$ 之后，对 $I_W$ 进行任意次修改操作。每次修改操作规则如下：\n\n(1)任意选择一个正整数k满足݉ $2k+1\\leq m$，以及两个非负整数 $z_1,z_2$ 满足 $i_{2k}+z_1<i_{2k+1}-z_2$；\n\n(2)将 $i_{2k}$ 修改为 $i_{2k}+z_1$，将 $i_{2k+1}$ 修改为 $i_{2k+1}-z_2$。\n\n若小 W 选出的下标序列 $I_W$ 经过小 Y 若干次修改操作之后所对应的点数小于等于 $0$，则小 Y 获胜。\n\n现在给出小 W 所进行的 Ex1 操作的信息，请你对于每一次“拼点游戏”\n，帮助他们计算：\n\na)小 W 一开始所能选出的最优下标序列对应的点数是多少？\n\nb)小 Y 最少需要进行几次修改操作才能获胜？即使得 $D(I_W)\\leq 0$。", "inputFormat": "输入文件 joy.in 的第一行包含一个正整数 $T$，表示测试数据的组数。接下来为 $T$ 组数据。\n\n每一组数据的第一行包含两个整数 $n$ 和 $q$，分别表示 $U$ 中的元素个数和事件个数。\n\n接下来的一行，包含 $n$个 用一个空格隔开的正整数，第 $i$ 个整数为初始的序列中第 $i$ 个元素 $u_i$。\n\n接下来 $q$ 行，每行代表一个事件（按事件发生顺序输入）。每行的第一个数非 $0$ 即 $1$，表示这个事件的类型。\n\n若为 $0$ ：在 $0$ 之后还有三个整数 $l$，$r$ 和 $c$（这四个数之间均有一个空格）表示小 W 将 $u_l,u_{l+1},\\cdots,u_r$ 增加 $c$；\n\n若为 $1$：表示两人进行了一次“拼点游戏”，你需要输出相应的结果。\n\n输入数据保证序列 $U$ 中的所有元素总是正整数。", "outputFormat": "输出文件为joy.out。对于每一组测试数据，依次对每一次“拼点游戏”输出一行包含两个由一个空格隔开的整数 $D_{max}$ 和 $X$，其中\n\n$D_{max}$ 为对于当前序列 $U$，小 W 所能选出的最优下标序列所对应的点数；\n\n$X$ 表示小 Y 最少需要进行几次修改操作才能获胜。如果小 Y 不论多少次操作都无法获胜，则输出```-1```。\n\n数据保证最优下标序列总是唯一的。", "hint": "【评分标准】\n\n一个测试点包含多组测试数据，对于该测试点：\n\n如果所有的 $D_{max}$ 均正确但某个 $X$ 不正确，则可以得到3分；\n\n如果所有的 $X$ 均正确但某个 $D_{max}$ 不正确，则可以得到7分；\n\n如果所有回答均正确，则可以得到 10 分。\n\n【样例说明】\n\n输入数据包含两组测试数据。\n\n在第一组测试数据中：第一次“拼点游戏”时，最优下标序列为 $(1,2,4,5)$，小 Y 只需要进行一次修改操作：选择 $k=1$，以及非负整数 $z_1=1,z_2=0$。这样经过修改操作之后下标序列将变为 $(1,3,4,5)$，小 Y 获胜。\n\n第三次“拼点游戏”时，序列 $U$ 为 $(9,8,6,5,3)$，小 W 所选择的最优下标序列为空序列，所产生的点数为 $0$。在这种情况下，小 Y 无法进行任何修改操作（也无需进行任何修改操作），此时小 Y 已经直接获胜。\n\n【数据规模】\n\n对于 10% 的数据满足 $n,q\\leq 13$；\n\n对于 30% 的数据满足 $n,q\\leq 1000$；\n\n对于另外 20% 的数据满足 $T=1$ 且 $n\\leq 40000$；\n\n对于 100% 的数据满足 $T\\leq 3$ 且 $n,q\\leq 10^5$，同时初始序列 $U$ 满足 $0 <u_i< 2^{31}$，$|c|<10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[WC2011] Point-Picking Game", "background": "", "description": "Xiao W and Xiao Y both enjoy a “point-picking game.” In the game, each of the two players produces a number as their “score” through some operation, and the player with the larger score wins. The rules of the “point-picking game” are as follows:\n1. At the start of the game, you are given a positive integer sequence with $n$ elements, $U=(u_1, u_2, \\cdots, u_n)$.\n2. An index sequence $I=(i_1, i_2, \\cdots, i_m)$ of $U$ is an integer sequence satisfying $1 \\leq i_1 < i_2 < \\cdots < i_m \\leq n$ (where $m$ can be $0$, i.e., the sequence can be empty), and its corresponding subsequence of $U$ is $V=(u_{i_1}, u_{i_2}, \\cdots, u_{i_m})$.\n3. The score $D(I)$ corresponding to the index sequence $I=(i_1, i_2, \\cdots, i_m)$ is defined as $D(I)=\\sum_{p=1}^m u_{i_p} \\times (-1)^p$.\n4. During the game, the two players each choose an index sequence, and the one whose chosen index sequence corresponds to a larger score $D(I)$ wins.\n\nHowever, in every game, Xiao W can always compute, accurately and flawlessly, the optimal index sequence that maximizes the score. To make the game more competitive, they added the following extra rules:\n\nEx1. Xiao W may choose a non-empty interval $[l, r]$ and increase $u_l, u_{l+1}, \\cdots, u_r$ by an integer $c$ simultaneously; the new sequence replaces the original sequence $U$.\n\nEx2. When they play a “point-picking game” on the current sequence $U$, Xiao Y is allowed, after Xiao W has chosen the optimal index sequence $I_W=(i_1, i_2, \\cdots, i_m)$, to modify $I_W$ any number of times. Each modification follows the rules below:\n(1) Arbitrarily choose a positive integer $k$ satisfying $2k+1 \\leq m$, and two non-negative integers $z_1, z_2$ satisfying $i_{2k} + z_1 < i_{2k+1} - z_2$;\n(2) Change $i_{2k}$ to $i_{2k} + z_1$, and change $i_{2k+1}$ to $i_{2k+1} - z_2$.\n\nIf, after some number of modifications by Xiao Y to the index sequence $I_W$ chosen by Xiao W, the corresponding score is less than or equal to $0$, then Xiao Y wins.\n\nNow, given the information about Xiao W’s Ex1 operations, for each “point-picking game,” please help them compute:\na) What is the score of the optimal index sequence that Xiao W can initially choose?\nb) What is the minimum number of modification operations Xiao Y needs in order to win, i.e., to make $D(I_W) \\leq 0$?", "inputFormat": "The first line of the input file joy.in contains a positive integer $T$, the number of groups of testdata. Then follow $T$ groups of data.\n\nFor each group of data, the first line contains two integers $n$ and $q$, denoting the number of elements in $U$ and the number of events, respectively.\n\nThe next line contains $n$ positive integers separated by single spaces, where the $i$-th integer is the $i$-th element $u_i$ in the initial sequence.\n\nThe following $q$ lines each describe an event (given in chronological order). The first number in each line is either $0$ or $1$, indicating the type of the event.\n\nIf it is $0$: after the $0$ there are three integers $l$, $r$, and $c$ (all separated by single spaces), meaning Xiao W increases $u_l, u_{l+1}, \\cdots, u_r$ by $c$.\n\nIf it is $1$: the two players play a “point-picking game,” and you need to output the corresponding result.\n\nThe input guarantees that all elements in the sequence $U$ are always positive integers.", "outputFormat": "The output file is joy.out. For each group of testdata, for each “point-picking game” in order, output one line containing two integers separated by a single space, $D_{max}$ and $X$, where\n- $D_{max}$ is the score of the optimal index sequence that Xiao W can choose for the current sequence $U$;\n- $X$ is the minimum number of modification operations that Xiao Y needs to win. If Xiao Y cannot win no matter how many operations are performed, output ```-1```.\n\nThe data guarantee that the optimal index sequence is always unique.", "hint": "Scoring rules:\n- A test point contains multiple groups of testdata. For that test point:\n  - If all $D_{max}$ are correct but some $X$ is incorrect, you get 3 points.\n  - If all $X$ are correct but some $D_{max}$ is incorrect, you get 7 points.\n  - If all answers are correct, you get 10 points.\n\nSample explanation:\n- The input contains two groups of testdata.\n- In the first group: In the first “point-picking game,” the optimal index sequence is $(1, 2, 4, 5)$. Xiao Y needs only one modification: choose $k=1$ and non-negative integers $z_1=1$, $z_2=0$. After the modification, the index sequence becomes $(1, 3, 4, 5)$, and Xiao Y wins.\n- In the third “point-picking game,” the sequence $U$ is $(9, 8, 6, 5, 3)$. Xiao W chooses the empty sequence as the optimal index sequence, yielding a score of $0$. In this case, Xiao Y cannot make any modification (nor is any modification needed), and Xiao Y already wins.\n\nConstraints:\n- For 10% of the data, $n, q \\leq 13$.\n- For 30% of the data, $n, q \\leq 1000$.\n- For another 20% of the data, $T=1$ and $n \\leq 40000$.\n- For 100% of the data, $T \\leq 3$ and $n, q \\leq 10^5$, and the initial sequence $U$ satisfies $0 < u_i < 2^{31}$ and $|c| < 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[WC2011] 拼点游戏", "background": "", "description": "小 W 和小 Y 都很喜欢玩一种“拼点游戏”。游戏中两个人分别通过某种操作产生一个数作为自己的“点数”，点数大的一方获胜。“拼点游戏”的规则如下：\n\n1. 游戏开始时，给定一个包含 $n$ 个元素的正整数序列 $U=(u_1,u_2,\\cdots,u_n)$。\n2. 定义 $U$ 的一个下标序列 $I=(i_1,i_2,\\cdots,i_m)$ 是满足 $1\\leq i_1<i_2<\\cdots<i_m\\leq n$ 的一个整数序列（ $m$ 可以为 0 ，即序列可以为空），并且其对应 $U$ 的子序列为 $V=(u_{i_1},u_{i_2},\\cdots,u_{i_m})$。\n3. 定义下标序列 $I=(i_1,i_2,\\cdots,i_m)$ 对应的点数 $D(I)$ 为： $D(I)=\\sum_{p=1}^m u_{i_p}\\times (-1)^p$。\n4. 进行游戏时两人分别选择一个下标序列，谁选择的下标序列对应的点数 $D(I)$ 大，谁就获胜。\n\n然而在每次游戏中，小 W 总是能准确无误的算出点数最大的最优下标序列。为了让游戏更加具有竞技性，他们制定了下列额外规则：\n\nEx1. 小W可以选择一个非空区间 $[l,r]$，并将 $u_l,u_{l+1},\\cdots,u_r$ 同时增加一个整数 $c$，产生的新序列将取代原序列 $U$。\n\nEx2. 当他们对于当前的 $U$ 序列进行一次“拼点游戏”时，允许小 Y 在小 W 选出最优下标序列 $I=(i_1,i_2,\\cdots,i_m)$ 之后，对 $I_W$ 进行任意次修改操作。每次修改操作规则如下：\n\n(1)任意选择一个正整数k满足݉ $2k+1\\leq m$，以及两个非负整数 $z_1,z_2$ 满足 $i_{2k}+z_1<i_{2k+1}-z_2$；\n\n(2)将 $i_{2k}$ 修改为 $i_{2k}+z_1$，将 $i_{2k+1}$ 修改为 $i_{2k+1}-z_2$。\n\n若小 W 选出的下标序列 $I_W$ 经过小 Y 若干次修改操作之后所对应的点数小于等于 $0$，则小 Y 获胜。\n\n现在给出小 W 所进行的 Ex1 操作的信息，请你对于每一次“拼点游戏”\n，帮助他们计算：\n\na)小 W 一开始所能选出的最优下标序列对应的点数是多少？\n\nb)小 Y 最少需要进行几次修改操作才能获胜？即使得 $D(I_W)\\leq 0$。", "inputFormat": "输入文件 joy.in 的第一行包含一个正整数 $T$，表示测试数据的组数。接下来为 $T$ 组数据。\n\n每一组数据的第一行包含两个整数 $n$ 和 $q$，分别表示 $U$ 中的元素个数和事件个数。\n\n接下来的一行，包含 $n$个 用一个空格隔开的正整数，第 $i$ 个整数为初始的序列中第 $i$ 个元素 $u_i$。\n\n接下来 $q$ 行，每行代表一个事件（按事件发生顺序输入）。每行的第一个数非 $0$ 即 $1$，表示这个事件的类型。\n\n若为 $0$ ：在 $0$ 之后还有三个整数 $l$，$r$ 和 $c$（这四个数之间均有一个空格）表示小 W 将 $u_l,u_{l+1},\\cdots,u_r$ 增加 $c$；\n\n若为 $1$：表示两人进行了一次“拼点游戏”，你需要输出相应的结果。\n\n输入数据保证序列 $U$ 中的所有元素总是正整数。", "outputFormat": "输出文件为joy.out。对于每一组测试数据，依次对每一次“拼点游戏”输出一行包含两个由一个空格隔开的整数 $D_{max}$ 和 $X$，其中\n\n$D_{max}$ 为对于当前序列 $U$，小 W 所能选出的最优下标序列所对应的点数；\n\n$X$ 表示小 Y 最少需要进行几次修改操作才能获胜。如果小 Y 不论多少次操作都无法获胜，则输出```-1```。\n\n数据保证最优下标序列总是唯一的。", "hint": "【评分标准】\n\n一个测试点包含多组测试数据，对于该测试点：\n\n如果所有的 $D_{max}$ 均正确但某个 $X$ 不正确，则可以得到3分；\n\n如果所有的 $X$ 均正确但某个 $D_{max}$ 不正确，则可以得到7分；\n\n如果所有回答均正确，则可以得到 10 分。\n\n【样例说明】\n\n输入数据包含两组测试数据。\n\n在第一组测试数据中：第一次“拼点游戏”时，最优下标序列为 $(1,2,4,5)$，小 Y 只需要进行一次修改操作：选择 $k=1$，以及非负整数 $z_1=1,z_2=0$。这样经过修改操作之后下标序列将变为 $(1,3,4,5)$，小 Y 获胜。\n\n第三次“拼点游戏”时，序列 $U$ 为 $(9,8,6,5,3)$，小 W 所选择的最优下标序列为空序列，所产生的点数为 $0$。在这种情况下，小 Y 无法进行任何修改操作（也无需进行任何修改操作），此时小 Y 已经直接获胜。\n\n【数据规模】\n\n对于 10% 的数据满足 $n,q\\leq 13$；\n\n对于 30% 的数据满足 $n,q\\leq 1000$；\n\n对于另外 20% 的数据满足 $T=1$ 且 $n\\leq 40000$；\n\n对于 100% 的数据满足 $T\\leq 3$ 且 $n,q\\leq 10^5$，同时初始序列 $U$ 满足 $0 <u_i< 2^{31}$，$|c|<10^5$。", "locale": "zh-CN"}}}
{"pid": "P4498", "type": "P", "difficulty": 7, "samples": [["2\n2 1\n0 4\n4 4", "4.000000"], ["2\n2 1\n4 4\n4 -4", "5.464102"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2007", "Special Judge", "WC"], "title": "[WC2007] 疯狂赛车", "background": "布布是一个《泡泡堂》高手，拥有着近乎完美的战绩。他擅长很多地图，例如“小区10”、“海盗14”、“大海02”等等，不过他最喜欢的地图是“赛车”。\n\n在赛车地图中，每个玩家将得到一辆赛车，从起点出发，比赛谁最先到达终点。\n", "description": "在地图中，包括有障碍、加油站、赛车跑道与沙地。障碍不可通过，并且赛车在赛车跑道与沙地上的行进速度是不一样的。\n\n现在我们来考虑一个简化版的赛车游戏。在这个简化版本的赛车游戏中：\n\n* 比赛在一个无限大的沙地平面上举行。\n\n* 赛道是一个从原点出发、由$n$条线段首尾相接组成的折线。\n\n* 出于安全考虑，赛道不会自交（即折线中的任何两条线段，相邻两条线段有且仅有一个公共点，其他任意两条线段均无公共点）。\n\n* 赛车在赛道上的速度为$v_a$，在沙地上的速度为$v_b$，且满足 $v_a\\geq v_b$。\n\n* 为了增加比赛的挑战性，在赛道上逆向行驶是允许的。\n\n布布是一个操作非常精确的选手，他总能按照预想的道路行进至终点，但是他不知道哪个才是最快的路线，聪明的你，能帮助他么？", "inputFormat": "输入文件racing.in的第1行包含一个整数$n$，表示赛道一共有$n$段；第2行包含两个实数$v_a$与$v_b$，分别表示赛车在赛道上与沙地中的行进速度。\n\n接下来的$n$行，每行包含两个整数$x_i$与$y_i$，依次表示赛道的每一个转折点。即赛道的第一个线段是$(0,0)\\rightarrow (x_1 , y_1)$，第二条线段是$(x_1 , y_1)\\rightarrow ( x_2 , y_2)$，依次类推。其中$(x_n , y_n)$为终点。", "outputFormat": "输出文件racing.out仅包含一个实数，表示从起点到终点最少所需时间。精确到小数点后6位。", "hint": "【评分标准】\n\n每一组数据单独评分，对于每一组数据，你的得分按照如下公式计算：\n\n$$YourScore=\\begin{cases}10 &  |YourAnswer-OurAnswer|\\leq 0.0001\\\\  5  & |YourAnswer-OurAnswer|\\leq 0.01 \\\\ 0 &    Otherwise \\end{cases}$$\n\n【数据规模】\n\n对于20%的数据，赛道的折线段平行于坐标轴。\n\n对于40%的数据，$n\\leq 50$ 。\n\n对于100%的数据，$n\\leq 1000$ ，$1\\leq v_b\\leq v_a\\leq 20 $。\n\n所有的坐标都在$[-10^6 , 10^6]$内。\n", "locale": "zh-CN", "translations": {"en": {"title": "[WC2007] Crazy Racing", "background": "Bubu is a master of “Paopaotang” (pinyin), with an almost perfect record. He excels on many maps, such as “小区10”, “海盗14”, “大海02”, etc., but his favorite map is “赛车”.\n\nOn the racing map, each player gets a car, starts from the origin, and competes to reach the finish line first.", "description": "The map contains obstacles, gas stations, race track, and sand. Obstacles are impassable, and the car’s speed differs between the race track and the sand.\n\nNow we consider a simplified racing game. In this simplified version:\n\n- The race takes place on an infinite sandy plane.\n- The track is a polyline starting from the origin, composed of $n$ connected segments.\n- For safety, the track does not self-intersect (i.e., in the polyline, adjacent segments share exactly one common point, and any other pair of segments has no common point).\n- The car’s speed on the track is $v_a$, and on the sand is $v_b$, with $v_a \\geq v_b$.\n- To increase the challenge, driving in the reverse direction along the track is allowed.\n\nBubu is extremely precise and can always follow the intended path to the finish, but he does not know which route is the fastest. Can you help him?", "inputFormat": "The first line of the input file racing.in contains an integer $n$, the number of segments in the track. The second line contains two real numbers $v_a$ and $v_b$, representing the car’s speed on the track and on the sand, respectively.\n\nThe next $n$ lines each contain two integers $x_i$ and $y_i$, giving each turning point of the track in order. That is, the first segment of the track is $(0,0)\\rightarrow (x_1 , y_1)$, the second segment is $(x_1 , y_1)\\rightarrow ( x_2 , y_2)$, and so on. Here $(x_n , y_n)$ is the finish point.", "outputFormat": "The output file racing.out contains a single real number, the minimum time required to go from the start to the finish. Print to 6 decimal places.", "hint": "Scoring:\n\n$$YourScore=\\begin{cases}10 &  |YourAnswer-OurAnswer|\\leq 0.0001\\\\  5  & |YourAnswer-OurAnswer|\\leq 0.01 \\\\ 0 &    Otherwise \\end{cases}$$\n\nConstraints:\n\n- For 20% of the testdata, the polyline segments of the track are parallel to the coordinate axes.\n- For 40% of the testdata, $n \\leq 50$.\n- For 100% of the testdata, $n \\leq 1000$, $1 \\leq v_b \\leq v_a \\leq 20$.\n- All coordinates are within $[-10^6 , 10^6]$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[WC2007] 疯狂赛车", "background": "布布是一个《泡泡堂》高手，拥有着近乎完美的战绩。他擅长很多地图，例如“小区10”、“海盗14”、“大海02”等等，不过他最喜欢的地图是“赛车”。\n\n在赛车地图中，每个玩家将得到一辆赛车，从起点出发，比赛谁最先到达终点。\n", "description": "在地图中，包括有障碍、加油站、赛车跑道与沙地。障碍不可通过，并且赛车在赛车跑道与沙地上的行进速度是不一样的。\n\n现在我们来考虑一个简化版的赛车游戏。在这个简化版本的赛车游戏中：\n\n* 比赛在一个无限大的沙地平面上举行。\n\n* 赛道是一个从原点出发、由$n$条线段首尾相接组成的折线。\n\n* 出于安全考虑，赛道不会自交（即折线中的任何两条线段，相邻两条线段有且仅有一个公共点，其他任意两条线段均无公共点）。\n\n* 赛车在赛道上的速度为$v_a$，在沙地上的速度为$v_b$，且满足 $v_a\\geq v_b$。\n\n* 为了增加比赛的挑战性，在赛道上逆向行驶是允许的。\n\n布布是一个操作非常精确的选手，他总能按照预想的道路行进至终点，但是他不知道哪个才是最快的路线，聪明的你，能帮助他么？", "inputFormat": "输入文件racing.in的第1行包含一个整数$n$，表示赛道一共有$n$段；第2行包含两个实数$v_a$与$v_b$，分别表示赛车在赛道上与沙地中的行进速度。\n\n接下来的$n$行，每行包含两个整数$x_i$与$y_i$，依次表示赛道的每一个转折点。即赛道的第一个线段是$(0,0)\\rightarrow (x_1 , y_1)$，第二条线段是$(x_1 , y_1)\\rightarrow ( x_2 , y_2)$，依次类推。其中$(x_n , y_n)$为终点。", "outputFormat": "输出文件racing.out仅包含一个实数，表示从起点到终点最少所需时间。精确到小数点后6位。", "hint": "【评分标准】\n\n每一组数据单独评分，对于每一组数据，你的得分按照如下公式计算：\n\n$$YourScore=\\begin{cases}10 &  |YourAnswer-OurAnswer|\\leq 0.0001\\\\  5  & |YourAnswer-OurAnswer|\\leq 0.01 \\\\ 0 &    Otherwise \\end{cases}$$\n\n【数据规模】\n\n对于20%的数据，赛道的折线段平行于坐标轴。\n\n对于40%的数据，$n\\leq 50$ 。\n\n对于100%的数据，$n\\leq 1000$ ，$1\\leq v_b\\leq v_a\\leq 20 $。\n\n所有的坐标都在$[-10^6 , 10^6]$内。\n", "locale": "zh-CN"}}}
