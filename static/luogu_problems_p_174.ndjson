{"pid": "P4519", "type": "P", "difficulty": 2, "samples": [["5\n2\n2\n1\n5", "0"], ["26\n3\n3\n3\n19\n26\n", "2"], ["13\n2\n10\n1\n2\n", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["2017", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #4] Rasvjeta", "background": "", "description": "It is Advent season. There are M street lights in a street N metres long (the meters of the\nstreet are denoted with numbers from 1 to N). Each of the lights lights up the meter of the\nstreet it’s located in and K meters to the left and to the right of that location. In other words, if\nthe light is located at meter X, it lights up all metres of the street from X - K to X + K,\ninclusively. Of course, it is possible for a meter of the street to be lit up by multiple street\nlights. All lights have distinct locations.\n\nThe problem is that there is a possibility that the lights don’t light up all N metres of the\nstreet. It is your task to determine the minimal amount of additional lights needed to be put\nup (at position from 1 to N) so that the entire street is lit up.", "inputFormat": "The first line of input contains the number N (1 ≤ N ≤ 1000).\n\nThe second line of input contains the number M (1 ≤ M ≤ N).\n\nThe third line contains the number K (0 ≤ K ≤ N).\n\nEach of the following M lines contains a number. The numbers are sorted in ascending order\nand represent the positions of each of the M street lights.\n\nThe positions will be distinct and from the interval [1, N].\n", "outputFormat": "You must output the required number from the task.", "hint": "**Clarification of the first test case:**\n\nIt’s not necessary to add lights to the street, since all N meters are already lit up.\n\n**Clarification of the third test case:**\n\nIt is necessary to add one lamp, for example at location 13.", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #4] Rasvjeta", "background": "", "description": "It is Advent season. There are M street lights in a street N metres long (the meters of the\nstreet are denoted with numbers from 1 to N). Each of the lights lights up the meter of the\nstreet it’s located in and K meters to the left and to the right of that location. In other words, if\nthe light is located at meter X, it lights up all metres of the street from X - K to X + K,\ninclusively. Of course, it is possible for a meter of the street to be lit up by multiple street\nlights. All lights have distinct locations.\n\nThe problem is that there is a possibility that the lights don’t light up all N metres of the\nstreet. It is your task to determine the minimal amount of additional lights needed to be put\nup (at position from 1 to N) so that the entire street is lit up.", "inputFormat": "The first line of input contains the number N (1 ≤ N ≤ 1000).\n\nThe second line of input contains the number M (1 ≤ M ≤ N).\n\nThe third line contains the number K (0 ≤ K ≤ N).\n\nEach of the following M lines contains a number. The numbers are sorted in ascending order\nand represent the positions of each of the M street lights.\n\nThe positions will be distinct and from the interval [1, N].\n", "outputFormat": "You must output the required number from the task.", "hint": "**Clarification of the first test case:**\n\nIt’s not necessary to add lights to the street, since all N meters are already lit up.\n\n**Clarification of the third test case:**\n\nIt is necessary to add one lamp, for example at location 13.", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #4] Rasvjeta / 路灯", "background": null, "description": "在一条 $N$ 米长的路上有 $M$ 个路灯。每个路灯能够照亮其左右 $K$ 米，即如果在 $X$ 米处安放路灯，则从 $X-K$ 米处到 $X+K$ 米处都被照亮。\n\n但是，有可能这条路上有些地方没有被照亮。请求出至少要再安放多少路灯才能让这条路的 $1$ 米处（**注意**：不是 $0$ 米处）到 $N$ 米处都被照亮。", "inputFormat": "第一行，一个正整数 $N$ 代表路的长度。\n\n第二行，一个正整数 $M$ 代表已经有的路灯的数量。\n\n第三行，一个**非负**整数 $K$ 代表路灯可以照亮的范围。\n\n以后 $M$ 行，第 $i$ 行一个正整数 $a_i$，代表第 $i$ 个路灯在 $a_i$ 米的位置。", "outputFormat": "输出一个非负整数 $D$，代表这条路至少还需要安装 $D$ 个路灯才能使 $1$ 米处到 $N$ 米处都被照亮。", "hint": "### 样例解释\n对于第一组样例，这条路已经被全部照亮了，不需要添加路灯。\n\n对于第三组样例，这条路只有 $13$ 米处没有被照亮，在 $3$ 米和 $13$ 米之间任意添加 $1$ 盏路灯就可以让整条路被照亮。\n\n### 数据范围\n\n对于全部数据，$1 \\le M \\le N \\le 1000,\\ 0 \\le K \\le N,\\ 1 \\le a_i \\le N$。", "locale": "zh-CN"}}}
{"pid": "P4520", "type": "P", "difficulty": 3, "samples": [["3 4 1\n3 4 1 2\n4 2 3 1\n3 4 2 1", "3\n3"], ["4 1 1\n1\n1\n1\n1", "1\n0"], ["4 4 4\n2 3 1 4\n2 3 1 4\n1 3 2 4\n4 3 2 1", "2\n3"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2017", "Special Judge", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #4] Izbori", "background": "", "description": "In a land with developed democracy far, far away, presidential elections for the football\nassociation are taking place. This land consists of N counties, and each county has its own\nfootball association. There are M presidential candidates labeled with 1, 2, … M. Each of the\nfootball associations will select exactly one candidate to cast their vote for. The winner of the\nelection is the candidate with the most votes. If multiple candidates get the most amount of\nvotes, the winner is the one with the smallest label.\n\nDuring the election campaign, candidates visited the counties and tried to gain their\nsympathies. After having met all the candidates, each county’s football association\ndetermined the order in which they would cast their vote for each candidate.\n\nFor example, let’s assume that there are four candidates in the election and that one\ncounty’s order is 2, 1, 4, 3. This means that, unless they revoke their candidacy, the\ncandidate with label 2 will get the county’s vote. If candidate 2 revokes their candidacy, and\ncandidate 1 is still in the race, then they will get the vote, and so on.\n\nZdravko is a passionate football fan, and also a close friend of candidate with label K. He\nwants to know which candidate will win if neither of the candidates revokes their candidacy.\n\nHe also wants to know what is the minimal number of candidates he must persuade to\nrevoke their candidacy in order for his friend, candidate K, to become the president of the\nfootball association.\n\nZdravko is currently dealing with other problems, so he is hoping that you will answer these\nquestions.\n", "inputFormat": "The first line of input contains the numbers N (1 ≤ N ≤ 100), M (1 ≤ M ≤ 15) and K (1 ≤ K ≤\nM) from the task.\n\nEach of the following N lines contains the orders given by the counties’ football associations,\ni.e. a permutation of the first M natural numbers.", "outputFormat": "You must output the answers to the questions from the task, each in its own line.", "hint": "The output must consist of two non-empty lines, each containing a single integer. ~~The correct answer to each of the questions is worth 50% of points for that test case.(不会做spj没用)~~\n\n**Clarification of the first test case:**\n\nThe land where the elections are being held consists of 3 counties, and there are 4 candidates for the\npresident of the association. If neither of the candidates revoke their candidacy, candidate 3 will win\nthe elections with two votes. Candidate 1 will only win if all the other candidates revoke their\ncandidacy.\n\n**Clarification of the second test case:**\n\nThere is only one candidate, Zdravko’s friend, so they will surely win.", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #4] Izbori", "background": "", "description": "In a land with developed democracy far, far away, presidential elections for the football\nassociation are taking place. This land consists of N counties, and each county has its own\nfootball association. There are M presidential candidates labeled with 1, 2, … M. Each of the\nfootball associations will select exactly one candidate to cast their vote for. The winner of the\nelection is the candidate with the most votes. If multiple candidates get the most amount of\nvotes, the winner is the one with the smallest label.\n\nDuring the election campaign, candidates visited the counties and tried to gain their\nsympathies. After having met all the candidates, each county’s football association\ndetermined the order in which they would cast their vote for each candidate.\n\nFor example, let’s assume that there are four candidates in the election and that one\ncounty’s order is 2, 1, 4, 3. This means that, unless they revoke their candidacy, the\ncandidate with label 2 will get the county’s vote. If candidate 2 revokes their candidacy, and\ncandidate 1 is still in the race, then they will get the vote, and so on.\n\nZdravko is a passionate football fan, and also a close friend of candidate with label K. He\nwants to know which candidate will win if neither of the candidates revokes their candidacy.\n\nHe also wants to know what is the minimal number of candidates he must persuade to\nrevoke their candidacy in order for his friend, candidate K, to become the president of the\nfootball association.\n\nZdravko is currently dealing with other problems, so he is hoping that you will answer these\nquestions.\n", "inputFormat": "The first line of input contains the numbers N (1 ≤ N ≤ 100), M (1 ≤ M ≤ 15) and K (1 ≤ K ≤\nM) from the task.\n\nEach of the following N lines contains the orders given by the counties’ football associations,\ni.e. a permutation of the first M natural numbers.", "outputFormat": "You must output the answers to the questions from the task, each in its own line.", "hint": "The output must consist of two non-empty lines, each containing a single integer. ~~The correct answer to each of the questions is worth 50% of points for that test case.(不会做spj没用)~~\n\n**Clarification of the first test case:**\n\nThe land where the elections are being held consists of 3 counties, and there are 4 candidates for the\npresident of the association. If neither of the candidates revoke their candidacy, candidate 3 will win\nthe elections with two votes. Candidate 1 will only win if all the other candidates revoke their\ncandidacy.\n\n**Clarification of the second test case:**\n\nThere is only one candidate, Zdravko’s friend, so they will surely win.", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #4] Izbori", "background": "", "description": "在一个遥远的民主发达的土地上，正在进行足球协会的总统选举。这个土地由 N 个县组成，每个县都有自己的足球协会。有 M 名总统候选人，编号为 1, 2, … M。每个足球协会将选择一个候选人投票。选举的获胜者是获得最多选票的候选人。如果有多个候选人获得最多选票，获胜者是编号最小的候选人。\n\n在竞选期间，候选人访问了各个县，试图赢得他们的支持。在会见了所有候选人后，每个县的足球协会确定了他们为每个候选人投票的顺序。\n\n例如，假设选举中有四名候选人，一个县的投票顺序是 2, 1, 4, 3。这意味着，除非他们撤回候选资格，编号为 2 的候选人将获得该县的选票。如果候选人 2 撤回候选资格，而候选人 1 仍在竞选中，那么他们将获得选票，依此类推。\n\nZdravko 是一个热情的足球迷，也是编号为 K 的候选人的密友。他想知道如果没有候选人撤回候选资格，哪位候选人将获胜。\n\n他还想知道他必须说服多少名候选人撤回候选资格，才能让他的朋友，候选人 K，成为足球协会的主席。\n\nZdravko 目前正在处理其他问题，所以他希望你能回答这些问题。", "inputFormat": "输入的第一行包含任务中的数字 N (1 ≤ N ≤ 100), M (1 ≤ M ≤ 15) 和 K (1 ≤ K ≤ M)。\n\n接下来的 N 行中的每一行包含各县足球协会给出的投票顺序，即前 M 个自然数的一个排列。", "outputFormat": "你必须输出任务中问题的答案，每个答案占一行。", "hint": "输出必须由两个非空行组成，每行包含一个整数。~~每个问题的正确答案在该测试用例中占 50% 的分数。（不会做 spj 没用）~~\n\n**第一个测试用例的说明：**\n\n选举所在的土地由 3 个县组成，有 4 名候选人竞选协会主席。如果没有候选人撤回候选资格，候选人 3 将以两票赢得选举。候选人 1 只有在所有其他候选人撤回候选资格时才会获胜。\n\n**第二个测试用例的说明：**\n\n只有一个候选人，即 Zdravko 的朋友，所以他们肯定会赢。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P4521", "type": "P", "difficulty": 5, "samples": [["3 4 4\nR 2 4\nS 4 1\nR 3 2\nR 2 0", "94"], ["3 1 1\nS 1 4\n", "24"], ["2 4 4\nS 2 0\nS 2 3\nR 1 5\nS 1 3", "80"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["2017", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #4] Automobil", "background": "", "description": "Mirko has found a matrix with N rows and M columns at the back seat of his car. The first\nrow of the matrix consists of numbers 1, 2, … M, the second row of numbers M+1, M+2, …\n2⋅M and so on until the $N^{th}$  \nrow which consists of numbers (N-1)⋅M + 1, (N-1)⋅M + 2, …\nN⋅M, respectively.\n\nFor example, for N = 3 and M = 4:\n\n| - | - | - | - |\n| :----------: | :----------: | :----------: | :----------: |\n| **1** | **2** | **3** | **4** |\n| **5** | **6** | **7** | **8** |\n| **9** | **10** | **11** | **12** |\n\nSuch matrix wasn’t interesting enough to him, so he chose a row or a column K times and\nmultiplied its values with a non-negative integer.\n\nNaturally, now he wants to know the sum of all the values from the matrix. Since this sum\ncan be very large, Mirko will be satisfied with the value modulo $10^9$ + 7. Help Mirko answer\nthis question.", "inputFormat": "The first line of input contains the numbers N (1 ≤ N ≤ 1 000 000), M (1 ≤ M ≤ 1 000\n000) and K (1 ≤ K ≤ 1000) from the task.\n\n - Either the multiplication of the $X^{th}$\nrow with Y, in the form of \"R X Y\", where “R”\nrepresents row multiplication, X is a positive integer (1 ≤ X ≤ N), and Y is a\nnon-negative integer (0 ≤ Y ≤ $10^{9}$\n).\n\n - Or the multiplication of the $X^{th}$ column with Y, in the form of “S X Y”, where “S”\nrepresents column multiplication, X is a positive integer (1 ≤ X ≤ M), and Y is a\nnon-negative integer (0 ≤ Y ≤ $10^{9}$\n).", "outputFormat": "You must output the sum of the final values from the matrix modulo $10^{9}$ + 7", "hint": "In test cases worth a total of 50 points, it will hold 1 ≤ N, M ≤ 1000.\n\n**Clarification of the first test case:**\nAfter multiplying the second row with 4, the fourth column with 1, the third row with 2, and again the\nsecond row with 0, the final matrix looks like this:\n\n| - | - | - | - |\n| :----------: | :----------: | :----------: | :----------: |\n| **1** | **2** | **3** | **4** |\n| **0** | **0** | **0** | **0** |\n| **18** | **20** | **22** | **24** |\n\nThe sum of the elements from the final matrix is 1 + 2 + 3 + 4 + 0 + 0 + 0 + 0 + 18 + 20 + 22 + 24 =\n94.", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #4] Automobil", "background": "", "description": "Mirko has found a matrix with N rows and M columns at the back seat of his car. The first\nrow of the matrix consists of numbers 1, 2, … M, the second row of numbers M+1, M+2, …\n2⋅M and so on until the $N^{th}$  \nrow which consists of numbers (N-1)⋅M + 1, (N-1)⋅M + 2, …\nN⋅M, respectively.\n\nFor example, for N = 3 and M = 4:\n\n| - | - | - | - |\n| :----------: | :----------: | :----------: | :----------: |\n| **1** | **2** | **3** | **4** |\n| **5** | **6** | **7** | **8** |\n| **9** | **10** | **11** | **12** |\n\nSuch matrix wasn’t interesting enough to him, so he chose a row or a column K times and\nmultiplied its values with a non-negative integer.\n\nNaturally, now he wants to know the sum of all the values from the matrix. Since this sum\ncan be very large, Mirko will be satisfied with the value modulo $10^9$ + 7. Help Mirko answer\nthis question.", "inputFormat": "The first line of input contains the numbers N (1 ≤ N ≤ 1 000 000), M (1 ≤ M ≤ 1 000\n000) and K (1 ≤ K ≤ 1000) from the task.\n\n - Either the multiplication of the $X^{th}$\nrow with Y, in the form of \"R X Y\", where “R”\nrepresents row multiplication, X is a positive integer (1 ≤ X ≤ N), and Y is a\nnon-negative integer (0 ≤ Y ≤ $10^{9}$\n).\n\n - Or the multiplication of the $X^{th}$ column with Y, in the form of “S X Y”, where “S”\nrepresents column multiplication, X is a positive integer (1 ≤ X ≤ M), and Y is a\nnon-negative integer (0 ≤ Y ≤ $10^{9}$\n).", "outputFormat": "You must output the sum of the final values from the matrix modulo $10^{9}$ + 7", "hint": "In test cases worth a total of 50 points, it will hold 1 ≤ N, M ≤ 1000.\n\n**Clarification of the first test case:**\nAfter multiplying the second row with 4, the fourth column with 1, the third row with 2, and again the\nsecond row with 0, the final matrix looks like this:\n\n| - | - | - | - |\n| :----------: | :----------: | :----------: | :----------: |\n| **1** | **2** | **3** | **4** |\n| **0** | **0** | **0** | **0** |\n| **18** | **20** | **22** | **24** |\n\nThe sum of the elements from the final matrix is 1 + 2 + 3 + 4 + 0 + 0 + 0 + 0 + 18 + 20 + 22 + 24 =\n94.", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #4] Automobil", "background": null, "description": "米尔科在他的车后座上发现了一个有 $N$ 行 $M$ 列的矩阵。矩阵的第一行由数字 $1, 2, \\cdots, M$ 组成，第二行由数字 $M+1, M+2, \\cdots, 2M$ 组成，依此类推，直到第 $N$ 行，其由数字 $(N-1)M + 1, (N-1)M + 2, \\cdots, NM$ 组成。\n\n例如，对于 $N = 3$ 和 $M = 4$：\n\n| - | - | - | - |\n| :----------: | :----------: | :----------: | :----------: |\n| **1** | **2** | **3** | **4** |\n| **5** | **6** | **7** | **8** |\n| **9** | **10** | **11** | **12** |\n\n这样的矩阵对他来说不够有趣，所以他选择了一行或一列 $K$ 次，并将其值乘以一个非负整数。\n\n自然地，现在他想知道矩阵中所有值的和。由于这个和可能非常大，米尔科将对其取模 $10^9 + 7$。帮助米尔科回答这个问题。", "inputFormat": "输入的第一行包含任务中的数字 $N$（$1 \\le N \\le 10^6$）, $M$（$1\\le M\\le 10^6$）和 $K$（$1\\le K\\le 10^3$）。\n\n- 或者是将第 $X$ 行乘以 $Y$，形式为 `R X Y`，其中 `R` 表示行乘法，$X$ 是一个正整数（$1\\le X\\le N$），$Y$ 是一个非负整数（$0 \\le Y \\le 10^9$）。\n\n- 或者是将第 $X$ 列乘以 $Y$，形式为 `S X Y`，其中 `S` 表示列乘法，$X$ 是一个正整数（$1\\le X\\le M$），$Y$ 是一个非负整数（$0 \\le Y \\le 10^9$）。", "outputFormat": "你必须输出矩阵最终值的和对 $10^9 + 7$ 取模的结果。", "hint": "在总共价值 $50$ 分的测试用例中，将满足 $1 \\le N, M \\le 10^3$。\n\n**第一个测试用例的说明**：在将第二行乘以 $4$，第四列乘以 $1$，第三行乘以 $2$，再次将第二行乘以 $0$ 之后，最终矩阵如下所示：\n\n| - | - | - | - |\n| :----------: | :----------: | :----------: | :----------: |\n| **1** | **2** | **3** | **4** |\n| **0** | **0** | **0** | **0** |\n| **18** | **20** | **22** | **24** |\n\n最终矩阵中元素的和为 $1 + 2 + 3 + 4 + 0 + 0 + 0 + 0 + 18 + 20 + 22 + 24 = 94$。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P4522", "type": "P", "difficulty": 4, "samples": [["2 9 2\n0 1", "0 1"], ["6 499 5\n1 0 0 1 1 0", "0 1 1 1 1 0"], ["10 100 10\n0 0 0 1 1 1 1 0 1 1", "1 1 1 1 1 1 1 1 1 1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #4] Vođe", "background": "", "description": "As we all very well know, goats and sheep have been fighting for years about the fields\nthey’re grazing. After many fierce fights, the goat leader and the sheep leader decided to\nmeet to try to find a peaceful solution to their problem. After many hours of discussion, they\nagreed that they will play a game for each field and that the winner will get to graze that field.\n\nThe game is played such that a total of N animals (that can be goats or sheep) form a circle\n(the exact order of goats and sheep is an agreement between their leaders). After animal i (1\n≤ i ≤ N-1), the game is continued by animal i+1, and after animal N, the game is continued by\nanimal 1. The animal starting the game can say any positive integer from the interval [1, K],\nbut only if that number is not greater than M. If the animal that started the game said the\nnumber j, then the next animal can say a number in interval [j+1, j+K], but only if that number\nis not greater than M. In other words, each animal can say a number that is greater by\nminimally 1, and maximally by K than the number said by the animal before, but only if the\nnew number is not greater than M. If an animal must say number M, its team (goats or\nsheep) loses.\n\nIf both the goats and the sheep are playing optimally, for each i (1 ≤ i ≤ N), determine who\nwill win the field if the game is started by the $i^{th}$ animal.\n", "inputFormat": "The first line of input contains N, M and K (1 ≤ N, M, K ≤ 5000), the numbers from the task.\nThe following line contains N numbers, 0 if the $i^{th}$  animal is a sheep, and 1 if it’s a goat.", "outputFormat": "Output N space-separated numbers. For each animal i (1 ≤ i ≤ N) output 0 if the sheep will\nwin the field, and 1 if the goats will win, if the $i^{th}$   animal is starting the game.\n", "hint": "In test cases worth a total of 60% of points, it will hold 1 ≤ N, M, K ≤ 500.\n\n**Clarification of the first test case:**\n\nWhen a sheep is playing first, it can play like this:\n\nThe sheep starts with number 2, after which the goat can say 3 or 4. In both cases, the sheep can say\n5, after which the goat can say either 6 or 7. In both cases, the sheep can say 8, after which the goat\ndoesn’t have any other choice but 9 and thus losing the game and the field.", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #4] Vođe", "background": "", "description": "As we all very well know, goats and sheep have been fighting for years about the fields\nthey’re grazing. After many fierce fights, the goat leader and the sheep leader decided to\nmeet to try to find a peaceful solution to their problem. After many hours of discussion, they\nagreed that they will play a game for each field and that the winner will get to graze that field.\n\nThe game is played such that a total of N animals (that can be goats or sheep) form a circle\n(the exact order of goats and sheep is an agreement between their leaders). After animal i (1\n≤ i ≤ N-1), the game is continued by animal i+1, and after animal N, the game is continued by\nanimal 1. The animal starting the game can say any positive integer from the interval [1, K],\nbut only if that number is not greater than M. If the animal that started the game said the\nnumber j, then the next animal can say a number in interval [j+1, j+K], but only if that number\nis not greater than M. In other words, each animal can say a number that is greater by\nminimally 1, and maximally by K than the number said by the animal before, but only if the\nnew number is not greater than M. If an animal must say number M, its team (goats or\nsheep) loses.\n\nIf both the goats and the sheep are playing optimally, for each i (1 ≤ i ≤ N), determine who\nwill win the field if the game is started by the $i^{th}$ animal.\n", "inputFormat": "The first line of input contains N, M and K (1 ≤ N, M, K ≤ 5000), the numbers from the task.\nThe following line contains N numbers, 0 if the $i^{th}$  animal is a sheep, and 1 if it’s a goat.", "outputFormat": "Output N space-separated numbers. For each animal i (1 ≤ i ≤ N) output 0 if the sheep will\nwin the field, and 1 if the goats will win, if the $i^{th}$   animal is starting the game.\n", "hint": "In test cases worth a total of 60% of points, it will hold 1 ≤ N, M, K ≤ 500.\n\n**Clarification of the first test case:**\n\nWhen a sheep is playing first, it can play like this:\n\nThe sheep starts with number 2, after which the goat can say 3 or 4. In both cases, the sheep can say\n5, after which the goat can say either 6 or 7. In both cases, the sheep can say 8, after which the goat\ndoesn’t have any other choice but 9 and thus losing the game and the field.", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #4] Vođe", "background": null, "description": "众所周知，山羊和绵羊为了它们放牧的田地已经争斗多年。在经历了许多激烈的战斗后，山羊首领和绵羊首领决定会面，尝试为他们的问题找到一个和平的解决方案。经过多小时的讨论，他们同意为每块田地玩一个游戏，胜者将获得在该田地放牧的权利。\n\n游戏的规则是，总共有 $N$ 只动物（可能是山羊或绵羊）围成一个圈（山羊和绵羊的具体顺序由它们的首领协商决定）。在动物 $i$（$1\\le i\\le N-1$）之后，游戏由动物 $i+1$ 继续，而在动物 $N$ 之后，游戏由动物 $1$ 继续。开始游戏的动物可以从区间 $[1,K]$ 中说出任意一个正整数，但这个数字不能大于 $M$。如果开始游戏的动物说了数字 $j$，那么下一个动物可以在区间 $[j+1,j+K]$ 中说一个数字，但这个数字也不能大于 $M$。换句话说，每只动物可以说出比前一只动物所说的数字大至少 $1$、最多 $K$ 的数字，但新数字不能大于 $M$。如果一只动物必须说出数字 $M$，它所在的队伍（山羊或绵羊）就会输掉。\n\n如果山羊和绵羊都以最佳策略进行游戏，对于每个 $i$（$1\\le i\\le N$），确定如果游戏由第 $i$ 只动物开始，谁将赢得这块田地。", "inputFormat": "输入的第一行包含 $N$、$M$ 和 $K$（$1\\le N,M,K\\le 5000$），如题目所述。接下来的行包含 $N$ 个数字，如果第 $i$ 只动物是绵羊，则为 0，如果是山羊，则为 1。", "outputFormat": "输出 $N$ 个以空格分隔的数字。对于每只动物 $i$（$1\\le i\\le N$），如果游戏由第 $i$ 只动物开始时绵羊将赢得田地，则输出 `0`，否则则输出 `1`。", "hint": "在总分值为 $60\\%$ 的测试用例中，将满足 $1\\le N,M,K\\le 500$。\n\n**第一个样例的说明：**\n\n当绵羊先开始时，它可以这样进行游戏：\n\n绵羊以数字 2 开始，之后山羊可以说 3 或 4。在这两种情况下，绵羊可以说 5，之后山羊可以说 6 或 7。在这两种情况下，绵羊可以说 8，之后山羊别无选择只能说 9，从而输掉游戏和田地。\n\n题面翻译由 ChatGPT-4o 提供，123asdf123 修缮。", "locale": "zh-CN"}}}
{"pid": "P4523", "type": "P", "difficulty": 5, "samples": [["4\n1 1 2 3", "3"], ["5\n4 5 7 2 2", "4"], ["6\n4 5 6 5 4 3", "0"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2017", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #4] Krov", "background": "", "description": "You are given a histogram consisting of N columns of heights $X_1,X_2,X_N$, respectively. The histogram needs to be transformed into a roof using a series of operations. A roof is a\nhistogram that has the following properties:\n- A single column is called the top of the roof. Let it be the column at position $i$.\n- The height of the column at position $j\\ (1 ≤ j ≤ N)$ is $ h_j = h_i- |i - j|$.\n- All heights $h_j$ are positive integers.\n\nAn operation can be increasing or decreasing the heights of a column of the histogram by $1$.\nIt is your task to determine the minimal number of operations needed in order to transform\nthe given histogram into a roof.\n", "inputFormat": "The first line of input contains the number $N (1 ≤ N ≤ 10^5$\n), the number of columns in the\nhistogram.\n\nThe following line contains $N$ numbers $X_i\\ (1 ≤ X_i ≤ 10^9)$, the initial column heights.", "outputFormat": "You must output the minimal number of operations from the task.\n", "hint": "In test cases worth 60% of total points, it will hold N ≤ 5000.\n\n**Clarification of the first test case:** By increasing the height of the second, third, and fourth column,\nwe created a roof where the fourth column is the top of the roof.\n\n**Clarification of the second test case:** By decreasing the height of the third column three times, and\nincreasing the height of the fourth column, we transformed the histogram into a roof. The example is\nillustrated below.\n\n![](https://cdn.luogu.com.cn/upload/pic/18666.png)", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #4] Krov", "background": "", "description": "You are given a histogram consisting of N columns of heights $X_1,X_2,X_N$, respectively. The histogram needs to be transformed into a roof using a series of operations. A roof is a\nhistogram that has the following properties:\n- A single column is called the top of the roof. Let it be the column at position $i$.\n- The height of the column at position $j\\ (1 ≤ j ≤ N)$ is $ h_j = h_i- |i - j|$.\n- All heights $h_j$ are positive integers.\n\nAn operation can be increasing or decreasing the heights of a column of the histogram by $1$.\nIt is your task to determine the minimal number of operations needed in order to transform\nthe given histogram into a roof.\n", "inputFormat": "The first line of input contains the number $N (1 ≤ N ≤ 10^5$\n), the number of columns in the\nhistogram.\n\nThe following line contains $N$ numbers $X_i\\ (1 ≤ X_i ≤ 10^9)$, the initial column heights.", "outputFormat": "You must output the minimal number of operations from the task.\n", "hint": "In test cases worth 60% of total points, it will hold N ≤ 5000.\n\n**Clarification of the first test case:** By increasing the height of the second, third, and fourth column,\nwe created a roof where the fourth column is the top of the roof.\n\n**Clarification of the second test case:** By decreasing the height of the third column three times, and\nincreasing the height of the fourth column, we transformed the histogram into a roof. The example is\nillustrated below.\n\n![](https://cdn.luogu.com.cn/upload/pic/18666.png)", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #4] Krov", "background": "", "description": "给定一个由 N 个柱子组成的直方图，其高度分别为 $X_1, X_2, \\ldots, X_N$。需要通过一系列操作将直方图转换为屋顶。屋顶是具有以下性质的直方图：  \n- 单个柱子称为屋顶的顶点。设其为位置 $i$ 的柱子。  \n- 位置 $j\\ (1 \\leq j \\leq N)$ 的柱子的高度为 $h_j = h_i - |i - j|$。  \n- 所有高度 $h_j$ 都是正整数。  \n\n一个操作可以是将直方图的某个柱子的高度增加或减少 1。  \n你的任务是确定将给定直方图转换为屋顶所需的最小操作次数。", "inputFormat": "输入的第一行包含一个数 $N\\ (1 \\leq N \\leq 10^5)$，表示直方图中的柱子数量。  \n\n接下来的行包含 $N$ 个数 $X_i\\ (1 \\leq X_i \\leq 10^9)$，表示初始的柱子高度。", "outputFormat": "你必须输出完成任务所需的最小操作次数。", "hint": "在占总分 60% 的测试用例中，将满足 $N \\leq 5000$。  \n\n**第一个测试用例的说明：** 通过增加第二、第三和第四个柱子的高度，我们创建了一个屋顶，其中第四个柱子是屋顶的顶点。  \n\n**第二个测试用例的说明：** 通过将第三个柱子的高度减少三次，并增加第四个柱子的高度，我们将直方图转换为屋顶。例子如下图所示。  \n\n![](https://cdn.luogu.com.cn/upload/pic/18666.png)\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P4524", "type": "P", "difficulty": 7, "samples": [["4 4\n1 2 2 4\n3 4 4 1\n4 2 1 1\n1 3 3 1\n", "8\n3\n14"], ["4 5\n1 2 1 7\n3 1 3 2\n2 4 5 2\n2 3 1 1\n2 4 7 1", "7\n6\n44"], ["3 2\n1 2 2 5\n2 1 3 3", "9\n-1"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2017", "排序", "最短路", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #4] Ceste", "background": "**原题时限2.5s**", "description": "There’s a country with N cities and M bidirectional roads. Driving on road i takes $T_i$ minutes,\nand costs $C_i$ kunas (Croatian currency).\n\nTo make the arrival to the holiday destination as pleasant as possible, you want to make it\nas fast and as cheap as possible. More specifically, you are in city 1 and want to minimize\nthe product of total money spent and total time spent (overall, with all roads you drove on) in\ngetting to a city from city 1. For each city (except city 1), output the required minimal product\nor -1 if city 1 and that city aren’t connected.\n", "inputFormat": "The first line of input contains numbers N (1 ≤ N ≤ 2000), the number of cities, and M (1 ≤ M\n≤ 2000), the number of roads.\n\nEach of the following M lines contains four numbers,$A_i,B_i,T_i,C_i,(1≤A_i,B_i≤N,1≤T_i,C_i≤2000)$ that denote there is a road connecting cities $A_i$ and $B_i$\n, that it takes $T_i$ minutes to drive\non it, and it costs $C_i$ kunas.\n\nIt is possible that multiple roads exist between two cities, but there will never be a road that\nconnects a city with itself.\n", "outputFormat": "You must output N - 1 lines. In the $i^{th}$\nline, output the required minimal product in order to get\nto city (i + 1), or -1 if cities 1 and (i + 1) aren’t connected.", "hint": "In test cases worth 40% of total points, it will hold $1 ≤ N, M, T_i, C_i ≤ 100$.\n\n**Clarification of the second test case:**\n\nIn order to get to city 2, you need to drive on road 1, for that it takes 1 minute and 7 kunas, so the\nrequired product is 7.\n\nIn order to get to city 3, you need to drive on road 2, for that it takes 3 minutes and 2 kunas, so the\nrequired product is 6.\n\nIn order to get to city 4, you need to drive on roads 2, 4, 5, in that order, and for that it takes a total of\n11 minutes and 4 kunas, so the required product is 44.", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #4] Ceste", "background": "**原题时限2.5s**", "description": "There’s a country with N cities and M bidirectional roads. Driving on road i takes $T_i$ minutes,\nand costs $C_i$ kunas (Croatian currency).\n\nTo make the arrival to the holiday destination as pleasant as possible, you want to make it\nas fast and as cheap as possible. More specifically, you are in city 1 and want to minimize\nthe product of total money spent and total time spent (overall, with all roads you drove on) in\ngetting to a city from city 1. For each city (except city 1), output the required minimal product\nor -1 if city 1 and that city aren’t connected.\n", "inputFormat": "The first line of input contains numbers N (1 ≤ N ≤ 2000), the number of cities, and M (1 ≤ M\n≤ 2000), the number of roads.\n\nEach of the following M lines contains four numbers,$A_i,B_i,T_i,C_i,(1≤A_i,B_i≤N,1≤T_i,C_i≤2000)$ that denote there is a road connecting cities $A_i$ and $B_i$\n, that it takes $T_i$ minutes to drive\non it, and it costs $C_i$ kunas.\n\nIt is possible that multiple roads exist between two cities, but there will never be a road that\nconnects a city with itself.\n", "outputFormat": "You must output N - 1 lines. In the $i^{th}$\nline, output the required minimal product in order to get\nto city (i + 1), or -1 if cities 1 and (i + 1) aren’t connected.", "hint": "In test cases worth 40% of total points, it will hold $1 ≤ N, M, T_i, C_i ≤ 100$.\n\n**Clarification of the second test case:**\n\nIn order to get to city 2, you need to drive on road 1, for that it takes 1 minute and 7 kunas, so the\nrequired product is 7.\n\nIn order to get to city 3, you need to drive on road 2, for that it takes 3 minutes and 2 kunas, so the\nrequired product is 6.\n\nIn order to get to city 4, you need to drive on roads 2, 4, 5, in that order, and for that it takes a total of\n11 minutes and 4 kunas, so the required product is 44.", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #4] Ceste", "background": "", "description": "有一个无向图，给定 $n$ 个顶点和 $m$ 条边，第 $i$ 条边连接 $A_i$ 和 $B_i$ 两个点且有两个代价 $T_i$ 和 $C_i$。\n\n从第 $i$ 个顶点经过一些边到第 $j$ 个顶点花费的代价为这些边的 $T$ 之和乘以 $C$ 之和。\n\n问题是，对于每一个 $k(2 \\le k \\le n)$，求从1号点出发到 $k$ 号点花费的最小代价。", "inputFormat": "第一行两个整数 $n$ 和 $m$。\n\n接下来 $m$ 行，每行包含4个正整数 $A_i,B_i,T_i,C_i$，表示一条连接 $A_i,B_i$ 的路,代价为 $T_i,C_i$。", "outputFormat": "输出 $n-1$ 行，每行一个正整数，第 $i$ 行的正整数表示从城市1到城市 $i+1$ 的最小代价。", "hint": "对于 $40\\%$ 的数据，满足 $1 \\le n,m,T_i,C_i \\le 100$。\n\n对于 $100\\%$ 的数据，满足 $1 \\le n,m,T_i,C_i \\le 2000,1 \\le A_i,B_i \\le n$。\n\n可能存在重边，不存在自环。\n\n样例2解释：\n\n为了到达城市2，我们选择第一条道路，花费1T与7C，代价为7。\n\n为了到达城市3，我们选择第二条道路，花费3T与2C，代价为6。\n\n为了到达城市4，我们选择道路2，4，5，花费11T与4C，代价为44。\n\n2025/10/31 增加 hack 数据一组", "locale": "zh-CN"}}}
{"pid": "P4525", "type": "P", "difficulty": 5, "samples": [["1 2 3 4 5 6", "2.732937"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["数学", "递归", "积分", "定积分", "模板题"], "title": "【模板】自适应辛普森法 1", "background": null, "description": "试计算积分\n\n$\\displaystyle{\\int_L^R\\frac{cx+d}{ax+b}\\mathrm{d}x}$\n\n结果保留至小数点后 $6$ 位。\n\n数据保证计算过程中分母不为 $0$ 且积分能够收敛。", "inputFormat": "一行，包含 $6$ 个实数 $a,b,c,d,L,R$。", "outputFormat": "一行，积分值，保留至小数点后 $6$ 位。", "hint": "$a,b,c,d\\in[-10,10]$，$-100\\le L<R\\le 100$ 且 $R-L\\ge1$。\n\n保证输入的数至多只有一位小数。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Adaptive Simpson's Rule 1", "background": "", "description": "Compute the integral\n\n$\\displaystyle{\\int_L^R\\frac{cx+d}{ax+b}\\mathrm{d}x}$\n\nRound the result to $6$ decimal places.\n\nThe testdata guarantees that the denominator is not $0$ during the computation and the integral converges.", "inputFormat": "One line containing $6$ real numbers $a,b,c,d,L,R$.", "outputFormat": "One line with the value of the integral, rounded to $6$ decimal places.", "hint": "$a,b,c,d\\in[-10,10]$，$-100\\le L<R\\le 100$ 且 $R-L\\ge1$。\n\nIt is guaranteed that each input number has at most one decimal place.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】自适应辛普森法 1", "background": null, "description": "试计算积分\n\n$\\displaystyle{\\int_L^R\\frac{cx+d}{ax+b}\\mathrm{d}x}$\n\n结果保留至小数点后 $6$ 位。\n\n数据保证计算过程中分母不为 $0$ 且积分能够收敛。", "inputFormat": "一行，包含 $6$ 个实数 $a,b,c,d,L,R$。", "outputFormat": "一行，积分值，保留至小数点后 $6$ 位。", "hint": "$a,b,c,d\\in[-10,10]$，$-100\\le L<R\\le 100$ 且 $R-L\\ge1$。\n\n保证输入的数至多只有一位小数。", "locale": "zh-CN"}}}
{"pid": "P4526", "type": "P", "difficulty": 6, "samples": [["2.33", "1.51068"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["数学", "积分", "定积分", "模板题"], "title": "【模板】自适应辛普森法 2", "background": "", "description": "试计算积分\n\n$\\displaystyle{\\int_0^\\infty x^{\\frac{a}{x}-x}\\mathrm{d}x}$\n\n保留至小数点后$5$位。若积分发散，请输出$\\text{orz}$。", "inputFormat": "一行，包含一个实数，为$a$的值", "outputFormat": "一行，积分值或$\\text{orz}$", "hint": "$|a|\\le50$。\n\n请注意时空限制。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Adaptive Simpson's Method 2", "background": "", "description": "Compute the integral\n\n$\\displaystyle{\\int_0^\\infty x^{\\frac{a}{x}-x}\\mathrm{d}x}$\n\nKeep $5$ digits after the decimal point. If the integral diverges, output $\\text{orz}$.", "inputFormat": "One line containing a real number, the value of $a$.", "outputFormat": "One line: the integral value or $\\text{orz}$.", "hint": "$|a|\\le50$.\n\nPlease pay attention to the time and memory limits.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】自适应辛普森法 2", "background": "", "description": "试计算积分\n\n$\\displaystyle{\\int_0^\\infty x^{\\frac{a}{x}-x}\\mathrm{d}x}$\n\n保留至小数点后$5$位。若积分发散，请输出$\\text{orz}$。", "inputFormat": "一行，包含一个实数，为$a$的值", "outputFormat": "一行，积分值或$\\text{orz}$", "hint": "$|a|\\le50$。\n\n请注意时空限制。", "locale": "zh-CN"}}}
{"pid": "P4527", "type": "P", "difficulty": 7, "samples": [["1 0 0 1 0\n10001 2\n3\n1 10\n2 12\n4 15", "3265\n5816\n0"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2008", "树套树", "CTSC/CTS"], "title": "[CTSC2008] 奥运抽奖", "background": "", "description": "距 $2008$ 年北京奥运会开幕还有90天时，CTSC 准备为志愿者们举行一次抽奖活动。作为志愿者的一员，你对这次抽奖活动自然是万分期待。\n\nCTSC 委员会介绍了抽奖活动的规则。设总共有 $p$ 个参加抽奖的志愿者，开始时每一个志愿者领取一个 $0 \\sim p-1$ 的号码。任意两个志愿者领取的号码不同。  \n\n屏幕的正中央是五福娃的头像，他们不停的眨眼欢迎大家。开始抽奖时，工作人员按下屏幕旁边的按钮，等待屏幕上的画面静止下来。这时，福娃们都停止眨眼了。  \n\n当然，画面静止时，有的福娃的眼睛可能是睁开的，有的是闭上的。如果所有福娃的眼睛都闭上了，工作人员需要重新按一 下按钮。这样，直到至少有一个福娃的眼睛是睁开的。接着，工作人员开始观察有哪些福娃的眼睛是睁开的。\n\n工作人员对五个福娃都标了号。贝贝、晶晶、欢欢、迎迎、妮妮的标号分别是 $2$、$3$、$4$、$5$、$6$（工作人员认为 $0$ 和 $1$ 都不是好数字）。定义幸运数字如下：\n\n- 如果一个福娃的眼睛是睁开的，那么他（她）对应的标号就是幸运数字；\n\n- 如果数字 $l_1$ 和 $l_2$（可能相等）都是幸运数字，那么他们的乘积也是幸运数字；\n\n- 其他的数字都不是幸运数字。\n\n用 $L$ 表示所有数字的集合，例如，如果贝贝、晶晶的眼睛是睁开的，欢欢、迎迎、妮妮的眼睛是闭上的，则 $L=\\{2,3,4,6,8,9,12,…\\}$。令 $l(x)$ 表示第 $x$ 大的幸运数字。例如，上面的例子中，$l(1)=2$，$l(4)=6$ 等等。\n\n接着，工作人员开始随机产生两个数，小的数是 $a$，大的数字是 $b$。定义集合 $T_{a,b}$ 为：$T_{a,b}=\\{d|d∈L,l(a)|d,d|l(b)\\}$（其中 $x|y$ 表示 $x$ 整除 $y$ ）\n\n定义一个自然数的有限子集的特征值 $f$ 如下：\n\n- 空集的特征值为$0$。\n\n- 对于非空集合 $S$，令 $d$ 为 $S$ 中的最小元素，则\n\n$$f(S)=d+f(S\\backslash d)+q\\times d\\times f(S\\backslash d)$$\n\n其中， $S\\backslash d$ 表示把 $S$ 删除元素 $d$ 后的集合，$q$ 是一个给定的非负整数。\n\n在 $a$ 和 $b$ 产生以后，中奖的志愿者就确定了，他的号码是 $f(T_{a,b})$ 除以 $p$ 的余数。工作人员会产生多次 $a$，$b$，这样就能形成多个中奖者。  \n\n但是，抽奖现场的程序需要很长的时间才能算出中奖的志愿者。出于对中奖结果的热切期待，你便想要重新写一下计算程序，于是，你的目光移向了前面的键盘……。", "inputFormat": "输入的第一行给出用空格隔开的五个数，每个数不是 $0$ 就是 $1$，分别表示贝贝、晶晶、欢欢、迎迎、妮妮的眼睛是否睁开。$0$ 对应眼睛闭上，$1$ 对应眼睛睁开。$5$ 个数不可能都是 $0$。\n\n第二行给出了用空格隔开的两个数，$p$ 和 $q$。 其中 $p$ 表示参加抽奖的志愿者的人数，$q$ 如前所述，用来计算集合的特征值。\n\n第三行给出了数 $n$，表示抽取的 $a$ 和 $b$ 的次数。\n\n接下来的 $n$ 行，每一行有两个数 $a$、$b$，中间用空格隔开，表示一次抽奖产生的两个数。", "outputFormat": "输出共 $n$ 行，每一行一个整数，表示一次抽奖中中奖者的号码。顺序与输入的 $n$ 对 $a$、$b$ 一一对应。当然，一个人可能中奖多次。", "hint": "【样例说明】\n\n贝贝和迎迎的眼睛是睁开的，因此，前面 $15$ 个幸运数字是 $2$、$4$、$5$、$8$、$10$、$16$、$20$、$25$、$32$、$40$、$50$、$64$、$80$、$100$、$125$。  \n\n$l(1) = 2$，$l(10) = 40$。既是 $2$ 的倍数，又是 $40$ 的约数的幸运数字有 $2$、$4$、$8$、$10$、$20$、$40$。  \n所以 $T_{1,10} = \\{2,4,8,10,20,40\\}$。$T_{1,10}$ 的特征值的计算过程为：\n\n$f(\\emptyset )=0$\n\n$f(\\{40\\})=40+0+2\\times40\\times0=40$\n\n$f(\\{20,40\\})=20+40+2\\times20\\times40=1660$\n\n$f(\\{10,20,40\\})=10+1660+2\\times10\\times1660=34870$\n\n$f(\\{8,10,20,40\\})=8+34870+2\\times8\\times34870=592798$\n\n$f(\\{4,8,10,20,40\\})=4+592798+2\\times4\\times592798=5335186$\n\n$f(\\{2,4,8,10,20,40\\})=2+5335186+2\\times2\\times5335186=26675932$\n\n所以中奖者的号码就是 $26675932$ 除以 $10001$ 的余数 —— $3265$。\n类似的，$T_{2,12} = \\{4,8,16,32,64\\}$，它的特征值是 $21167932$，除以 $10001$ 的余数是 $5816$。而 $T_{4,15} = \\emptyset$。\n\n【数据规模】   \n对于 $20\\%$ 数据，$1 ≤ a ≤ b ≤1000$，$n ≤ 2000$；   \n对于 $60\\%$ 的数据，$p$ 为素数；   \n对于 $100\\%$ 的数据，$1 ≤ a ≤ b ≤ 10^5$，$n ≤ 10^5$，$p, q ≤ 2 \\times 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2008] Olympic Lottery", "background": "", "description": "With $90$ days left before the opening of the Beijing $2008$ Olympics, CTSC plans to hold a lottery for volunteers. As one of the volunteers, you are very excited about it.\n\nThe CTSC committee introduces the rules. Suppose there are $p$ volunteers in total. At the beginning, each volunteer receives a distinct number from $0$ to $p-1$.\n\nIn the center of the screen are the avatars of the five Fuwa (Beibei, Jingjing, Huanhuan, Yingying, Nini), blinking to welcome everyone. When the lottery starts, the staff presses the button next to the screen and waits for the screen to stop. At that moment, the Fuwa stop blinking.\n\nOf course, when the screen stops, some Fuwa may have their eyes open while others have them closed. If all Fuwa have their eyes closed, the staff presses the button again, repeating this until at least one Fuwa has eyes open. Then, the staff observes which Fuwa have their eyes open.\n\nThe five Fuwa are labeled as follows: Beibei, Jingjing, Huanhuan, Yingying, Nini are labeled $2$, $3$, $4$, $5$, $6$ respectively (the staff think $0$ and $1$ are not good numbers). Lucky numbers are defined as follows:\n\n- If a Fuwa’s eyes are open, then his/her label is a lucky number.\n- If numbers $l_1$ and $l_2$ (possibly equal) are lucky numbers, then their product is also a lucky number.\n- All other numbers are not lucky.\n\nLet $L$ denote the set of all lucky numbers. For example, if Beibei and Jingjing have eyes open while Huanhuan, Yingying, and Nini have eyes closed, then $L=\\{2,3,4,6,8,9,12,\\dots\\}$. Let $l(x)$ denote the $x$-th lucky number in ascending order. For example, in the above case, $l(1)=2$, $l(4)=6$, and so on.\n\nNext, the staff randomly generates two numbers; let the smaller one be $a$ and the larger one be $b$. Define the set $T_{a,b}$ by\n$$T_{a,b}=\\{\\,d \\mid d\\in L,\\ l(a)\\mid d,\\ d\\mid l(b)\\,\\}$$\n(where $x\\mid y$ means $x$ divides $y$).\n\nDefine the characteristic value $f$ of a finite subset of natural numbers as follows:\n\n- The characteristic value of the empty set is $0$.\n- For a non-empty set $S$, let $d$ be the smallest element of $S$. Then\n$$f(S)=d+f(S\\backslash d)+q\\times d\\times f(S\\backslash d),$$\nwhere $S\\backslash d$ denotes the set obtained by removing the element $d$ from $S$, and $q$ is a given non-negative integer.\n\nAfter $a$ and $b$ are generated, the winner’s number is the remainder when $f(T_{a,b})$ is divided by $p$. The staff will generate many pairs $(a,b)$, thus producing multiple winners.\n\nHowever, the on-site program takes a long time to compute the winners. Eager to know the results, you decide to rewrite the computation program, and your eyes turn to the keyboard in front of you.", "inputFormat": "The first line contains five space-separated numbers, each either $0$ or $1$, indicating whether Beibei, Jingjing, Huanhuan, Yingying, and Nini have their eyes open. Here $0$ means closed and $1$ means open. The $5$ numbers cannot all be $0$.\n\nThe second line contains two space-separated numbers $p$ and $q$. Here $p$ is the number of volunteers, and $q$ is as described above for computing the characteristic value of a set.\n\nThe third line contains the number $n$, the number of generated pairs $(a,b)$.\n\nEach of the next $n$ lines contains two space-separated integers $a$ and $b$, representing one lottery draw.", "outputFormat": "Output $n$ lines, each containing one integer, the winner’s number for that draw. The order corresponds one-to-one with the $n$ pairs $(a,b)$ in the input. Of course, a person may win multiple times.", "hint": "Sample explanation:\n\nBeibei and Yingying have their eyes open. Therefore, the first $15$ lucky numbers are $2,4,5,8,10,16,20,25,32,40,50,64,80,100,125$.\n\n$l(1)=2$, $l(10)=40$. The lucky numbers that are multiples of $2$ and divisors of $40$ are $2,4,8,10,20,40$.\nSo $T_{1,10}=\\{2,4,8,10,20,40\\}$. The characteristic value of $T_{1,10}$ is computed as follows:\n\n$f(\\emptyset)=0$\n\n$f(\\{40\\})=40+0+2\\times40\\times0=40$\n\n$f(\\{20,40\\})=20+40+2\\times20\\times40=1660$\n\n$f(\\{10,20,40\\})=10+1660+2\\times10\\times1660=34870$\n\n$f(\\{8,10,20,40\\})=8+34870+2\\times8\\times34870=592798$\n\n$f(\\{4,8,10,20,40\\})=4+592798+2\\times4\\times592798=5335186$\n\n$f(\\{2,4,8,10,20,40\\})=2+5335186+2\\times2\\times5335186=26675932$\n\nTherefore, the winner’s number is the remainder of $26675932$ divided by $10001$, which is $3265$.\nSimilarly, $T_{2,12}=\\{4,8,16,32,64\\}$, whose characteristic value is $21167932$, and its remainder modulo $10001$ is $5816$. Also, $T_{4,15}=\\emptyset$.\n\nConstraints:\n- For $20\\%$ of the testdata, $1 \\le a \\le b \\le 1000$, $n \\le 2000$.\n- For $60\\%$ of the testdata, $p$ is prime.\n- For $100\\%$ of the testdata, $1 \\le a \\le b \\le 10^5$, $n \\le 10^5$, $p, q \\le 2\\times 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2008] 奥运抽奖", "background": "", "description": "距 $2008$ 年北京奥运会开幕还有90天时，CTSC 准备为志愿者们举行一次抽奖活动。作为志愿者的一员，你对这次抽奖活动自然是万分期待。\n\nCTSC 委员会介绍了抽奖活动的规则。设总共有 $p$ 个参加抽奖的志愿者，开始时每一个志愿者领取一个 $0 \\sim p-1$ 的号码。任意两个志愿者领取的号码不同。  \n\n屏幕的正中央是五福娃的头像，他们不停的眨眼欢迎大家。开始抽奖时，工作人员按下屏幕旁边的按钮，等待屏幕上的画面静止下来。这时，福娃们都停止眨眼了。  \n\n当然，画面静止时，有的福娃的眼睛可能是睁开的，有的是闭上的。如果所有福娃的眼睛都闭上了，工作人员需要重新按一 下按钮。这样，直到至少有一个福娃的眼睛是睁开的。接着，工作人员开始观察有哪些福娃的眼睛是睁开的。\n\n工作人员对五个福娃都标了号。贝贝、晶晶、欢欢、迎迎、妮妮的标号分别是 $2$、$3$、$4$、$5$、$6$（工作人员认为 $0$ 和 $1$ 都不是好数字）。定义幸运数字如下：\n\n- 如果一个福娃的眼睛是睁开的，那么他（她）对应的标号就是幸运数字；\n\n- 如果数字 $l_1$ 和 $l_2$（可能相等）都是幸运数字，那么他们的乘积也是幸运数字；\n\n- 其他的数字都不是幸运数字。\n\n用 $L$ 表示所有数字的集合，例如，如果贝贝、晶晶的眼睛是睁开的，欢欢、迎迎、妮妮的眼睛是闭上的，则 $L=\\{2,3,4,6,8,9,12,…\\}$。令 $l(x)$ 表示第 $x$ 大的幸运数字。例如，上面的例子中，$l(1)=2$，$l(4)=6$ 等等。\n\n接着，工作人员开始随机产生两个数，小的数是 $a$，大的数字是 $b$。定义集合 $T_{a,b}$ 为：$T_{a,b}=\\{d|d∈L,l(a)|d,d|l(b)\\}$（其中 $x|y$ 表示 $x$ 整除 $y$ ）\n\n定义一个自然数的有限子集的特征值 $f$ 如下：\n\n- 空集的特征值为$0$。\n\n- 对于非空集合 $S$，令 $d$ 为 $S$ 中的最小元素，则\n\n$$f(S)=d+f(S\\backslash d)+q\\times d\\times f(S\\backslash d)$$\n\n其中， $S\\backslash d$ 表示把 $S$ 删除元素 $d$ 后的集合，$q$ 是一个给定的非负整数。\n\n在 $a$ 和 $b$ 产生以后，中奖的志愿者就确定了，他的号码是 $f(T_{a,b})$ 除以 $p$ 的余数。工作人员会产生多次 $a$，$b$，这样就能形成多个中奖者。  \n\n但是，抽奖现场的程序需要很长的时间才能算出中奖的志愿者。出于对中奖结果的热切期待，你便想要重新写一下计算程序，于是，你的目光移向了前面的键盘……。", "inputFormat": "输入的第一行给出用空格隔开的五个数，每个数不是 $0$ 就是 $1$，分别表示贝贝、晶晶、欢欢、迎迎、妮妮的眼睛是否睁开。$0$ 对应眼睛闭上，$1$ 对应眼睛睁开。$5$ 个数不可能都是 $0$。\n\n第二行给出了用空格隔开的两个数，$p$ 和 $q$。 其中 $p$ 表示参加抽奖的志愿者的人数，$q$ 如前所述，用来计算集合的特征值。\n\n第三行给出了数 $n$，表示抽取的 $a$ 和 $b$ 的次数。\n\n接下来的 $n$ 行，每一行有两个数 $a$、$b$，中间用空格隔开，表示一次抽奖产生的两个数。", "outputFormat": "输出共 $n$ 行，每一行一个整数，表示一次抽奖中中奖者的号码。顺序与输入的 $n$ 对 $a$、$b$ 一一对应。当然，一个人可能中奖多次。", "hint": "【样例说明】\n\n贝贝和迎迎的眼睛是睁开的，因此，前面 $15$ 个幸运数字是 $2$、$4$、$5$、$8$、$10$、$16$、$20$、$25$、$32$、$40$、$50$、$64$、$80$、$100$、$125$。  \n\n$l(1) = 2$，$l(10) = 40$。既是 $2$ 的倍数，又是 $40$ 的约数的幸运数字有 $2$、$4$、$8$、$10$、$20$、$40$。  \n所以 $T_{1,10} = \\{2,4,8,10,20,40\\}$。$T_{1,10}$ 的特征值的计算过程为：\n\n$f(\\emptyset )=0$\n\n$f(\\{40\\})=40+0+2\\times40\\times0=40$\n\n$f(\\{20,40\\})=20+40+2\\times20\\times40=1660$\n\n$f(\\{10,20,40\\})=10+1660+2\\times10\\times1660=34870$\n\n$f(\\{8,10,20,40\\})=8+34870+2\\times8\\times34870=592798$\n\n$f(\\{4,8,10,20,40\\})=4+592798+2\\times4\\times592798=5335186$\n\n$f(\\{2,4,8,10,20,40\\})=2+5335186+2\\times2\\times5335186=26675932$\n\n所以中奖者的号码就是 $26675932$ 除以 $10001$ 的余数 —— $3265$。\n类似的，$T_{2,12} = \\{4,8,16,32,64\\}$，它的特征值是 $21167932$，除以 $10001$ 的余数是 $5816$。而 $T_{4,15} = \\emptyset$。\n\n【数据规模】   \n对于 $20\\%$ 数据，$1 ≤ a ≤ b ≤1000$，$n ≤ 2000$；   \n对于 $60\\%$ 的数据，$p$ 为素数；   \n对于 $100\\%$ 的数据，$1 ≤ a ≤ b ≤ 10^5$，$n ≤ 10^5$，$p, q ≤ 2 \\times 10^9$。", "locale": "zh-CN"}}}
{"pid": "P4528", "type": "P", "difficulty": 7, "samples": [["5\n1 5 3 2 4", "0"], ["4\n1 2 4 3", "16777215"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2008", "线段树", "树状数组", "容斥原理", "CTSC/CTS"], "title": "[CTSC2008] 图腾", "background": "", "description": "在完成了古越州圆盘密码的研究之后，考古学家小布来到了南美大陆的西部。相传很久以前在这片土地上生活着两个部落，一个部落崇拜闪电，另一个部落崇拜高山，他们分别用闪电和山峰的形状作为各自部落的图腾。\n\n小布的团队在山洞里发现了一幅巨大的壁画，壁画上被标记出了$N$个点，经测量发现这$N$个点的水平位置和竖直位置是两两不同的。小布认为这幅壁画所包含的信息仅与这$N$个点的相对位置有关，因此不妨设坐标分别为$(1, y_1) , (2, y_2), ..., (n, y_n)$，其中$y_1\\sim y_n$是$1\\sim N$的一个排列。\n\n小布的团队打算研究在这幅壁画中包含着多少个图腾，其中闪电图腾的定义图示如下（**图腾的形式只与$4$个纵坐标值的相对大小排列顺序有关**）：\n\n![](https://cdn.luogu.com.cn/upload/pic/18466.png)\n\n即$1≤a<b<c<d≤N,y_a<y_c<y_b<y_d$\n\n崇拜高山的部落有两个氏族，因而山峰图腾有如下两种形式，左边为$A$类，右边为$B$类（**同样，图腾的形式也都只与$4$个纵坐标值的大小排列顺序有关**）：\n\n![](https://cdn.luogu.com.cn/upload/pic/18467.png)\n\n即$1≤a<b<c<d≤N,y_a<y_b<y_d<y_c$\n\n即$1≤a<b<c<d≤N,y_a<y_d<y_c<y_b$\n\n小布的团队希望知道，这$N$个点中两个部落图腾数目的差值。因此在本题中，你需要帮助小布的团队编写一个程序，计算闪电图腾数目减去山峰图腾数目的值，由于该值可能绝对值较大，本题中只需输出该值对$16777216$的余数（注意余数必为正值，例如$-1$对$16777216$的余数为$16777215$）。", "inputFormat": "输入文件totem.in中第一行包含一个整数$N$，为点的数目。\n接下来一行包含$N$个整数，分别为$y_1, y_2, …, y_n$。保证$y_1, y_2, …, y_n$是$1\\sim N$的一个排列。", "outputFormat": "输出文件totem.out仅包含一个数，表示闪电图腾数目与山峰图腾数目的差值对$16777216$的余数。", "hint": "**【样例说明】**\n\n样例一中共有$1$个闪电图腾（$1324$）和$1$个$B$类山峰图腾（$1532$）。\n\n样例二中仅有一个$A$类山峰图腾（$1243$），故差值为$-1$，答案为$16777215$。\n\n**【数据规模】**\n\n对于$10\\%$的数据，$N  ≤ 600$；\n\n对于$40\\%$的数据，$N  ≤ 5000$；\n\n对于$100\\%$的数据，$N ≤ 200000$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2008] Totem", "background": "", "description": "After completing the study of the Guyuezhou (Gu Yue Zhou) disk cipher, archaeologist Xiao Bu arrived at the west of the South American continent. It is said that long ago two tribes lived on this land: one worshiped lightning, the other worshiped mountains, and they used the shapes of lightning and peaks as their totems.\n\nXiao Bu’s team discovered a huge mural in a cave. The mural marks $N$ points, and measurements show that the horizontal and vertical coordinates of these $N$ points are pairwise distinct. Xiao Bu believes the information contained in the mural depends only on the relative positions of these $N$ points, so we may set the coordinates as $(1, y_1), (2, y_2), \\ldots, (N, y_N)$, where $y_1 \\sim y_N$ is a permutation of $1 \\sim N$.\n\nThe team plans to study how many totems are contained in the mural. The definition of a lightning totem is illustrated below (the totem’s type depends only on the relative order of the four $y$-values):\n\n![](https://cdn.luogu.com.cn/upload/pic/18466.png)\n\nThat is, $1 \\le a < b < c < d \\le N,\\ y_a < y_c < y_b < y_d$.\n\nThe mountain-worship tribe has two clans, so there are two peak totem types, A on the left and B on the right (again, the totem’s type depends only on the relative order of the four $y$-values):\n\n![](https://cdn.luogu.com.cn/upload/pic/18467.png)\n\nThat is, $1 \\le a < b < c < d \\le N,\\ y_a < y_b < y_d < y_c$.\n\nThat is, $1 \\le a < b < c < d \\le N,\\ y_a < y_d < y_c < y_b$.\n\nXiao Bu’s team wants to know the difference between the counts of the two tribes’ totems. In this problem, you need to compute the number of lightning totems minus the number of peak totems. Since the absolute value of this number can be large, output the result modulo $16777216$ (the remainder must be positive; for example, the remainder of $-1$ modulo $16777216$ is $16777215$).", "inputFormat": "The first line contains an integer $N$, the number of points.  \nThe second line contains $N$ integers $y_1, y_2, \\ldots, y_N$. It is guaranteed that $y_1, y_2, \\ldots, y_N$ is a permutation of $1 \\sim N$.", "outputFormat": "Output a single integer, the remainder modulo $16777216$ of the difference between the number of lightning totems and the number of peak totems.", "hint": "[Sample Explanation]\n\nIn Sample 1, there is 1 lightning totem (1324) and 1 type B peak totem (1532).\n\nIn Sample 2, there is only one type A peak totem (1243), so the difference is $-1$, and the answer is $16777215$.\n\n[Constraints]\n\n- For $10\\%$ of the testdata, $N \\le 600$.\n- For $40\\%$ of the testdata, $N \\le 5000$.\n- For $100\\%$ of the testdata, $N \\le 200000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2008] 图腾", "background": "", "description": "在完成了古越州圆盘密码的研究之后，考古学家小布来到了南美大陆的西部。相传很久以前在这片土地上生活着两个部落，一个部落崇拜闪电，另一个部落崇拜高山，他们分别用闪电和山峰的形状作为各自部落的图腾。\n\n小布的团队在山洞里发现了一幅巨大的壁画，壁画上被标记出了$N$个点，经测量发现这$N$个点的水平位置和竖直位置是两两不同的。小布认为这幅壁画所包含的信息仅与这$N$个点的相对位置有关，因此不妨设坐标分别为$(1, y_1) , (2, y_2), ..., (n, y_n)$，其中$y_1\\sim y_n$是$1\\sim N$的一个排列。\n\n小布的团队打算研究在这幅壁画中包含着多少个图腾，其中闪电图腾的定义图示如下（**图腾的形式只与$4$个纵坐标值的相对大小排列顺序有关**）：\n\n![](https://cdn.luogu.com.cn/upload/pic/18466.png)\n\n即$1≤a<b<c<d≤N,y_a<y_c<y_b<y_d$\n\n崇拜高山的部落有两个氏族，因而山峰图腾有如下两种形式，左边为$A$类，右边为$B$类（**同样，图腾的形式也都只与$4$个纵坐标值的大小排列顺序有关**）：\n\n![](https://cdn.luogu.com.cn/upload/pic/18467.png)\n\n即$1≤a<b<c<d≤N,y_a<y_b<y_d<y_c$\n\n即$1≤a<b<c<d≤N,y_a<y_d<y_c<y_b$\n\n小布的团队希望知道，这$N$个点中两个部落图腾数目的差值。因此在本题中，你需要帮助小布的团队编写一个程序，计算闪电图腾数目减去山峰图腾数目的值，由于该值可能绝对值较大，本题中只需输出该值对$16777216$的余数（注意余数必为正值，例如$-1$对$16777216$的余数为$16777215$）。", "inputFormat": "输入文件totem.in中第一行包含一个整数$N$，为点的数目。\n接下来一行包含$N$个整数，分别为$y_1, y_2, …, y_n$。保证$y_1, y_2, …, y_n$是$1\\sim N$的一个排列。", "outputFormat": "输出文件totem.out仅包含一个数，表示闪电图腾数目与山峰图腾数目的差值对$16777216$的余数。", "hint": "**【样例说明】**\n\n样例一中共有$1$个闪电图腾（$1324$）和$1$个$B$类山峰图腾（$1532$）。\n\n样例二中仅有一个$A$类山峰图腾（$1243$），故差值为$-1$，答案为$16777215$。\n\n**【数据规模】**\n\n对于$10\\%$的数据，$N  ≤ 600$；\n\n对于$40\\%$的数据，$N  ≤ 5000$；\n\n对于$100\\%$的数据，$N ≤ 200000$。\n", "locale": "zh-CN"}}}
{"pid": "P4529", "type": "P", "difficulty": 6, "samples": [["100 100\n4\n80 80\n70 30\n20 20\n20 80", "312.575"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2003", "四川", "各省省选", "Special Judge"], "title": "[SCOI2003] 切割多边形", "background": "", "description": "我们希望通过切割得到一个凸 $p$ 边形，$p\\le 8$。\n\n一开始的时候，你有一个 $n\\times m$ 的矩形，即它的四角的坐标分别为 $(0,0), (0,m), (n,0), (n,m)$。每次，你可以选择一条直线把当前图形切割成两部分，保留其中一个部分（另一部分扔掉），切割线的长度为此直线在多边形内部的部分的长度。\n\n求出最短的切割线总长度。\n\n下面是一个例子，我们需要得到中间的多边形。\n\n![](https://cdn.luogu.com.cn/upload/pic/18468.png)\n\n分别沿着直线 $1,2,3,4$ 进行切割即可，得到中间的四边形。", "inputFormat": "第一行有两个整数 $n,m\\ (0 < n,m < 500)$。\n\n第二行为一个整数 $p(3\\le p\\le 8)$，以下 $p$ 行每行为两个整数 $x, y(0 < x < n, 0 < y < m)$，为按顺时针给出的各顶点坐标。\n\n数据保证多边形的是凸的，无三点共线，输入数据无错误。", "outputFormat": "仅一行，为最短切割线的总长度，四舍五入到小数点后 $3$ 位。允许有 $0.001$ 的误差。", "hint": "样例对应于图中给出的例子。", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2003] Cutting a Polygon", "background": "", "description": "We wish to obtain a convex $p$-gon, $p\\le 8$.\n\nInitially, you have an $n\\times m$ rectangle; that is, its four corner coordinates are $(0,0), (0,m), (n,0), (n,m)$. Each time, you may choose a straight line to cut the current shape into two parts and keep one part (discard the other). The length of a cut is defined as the length of the portion of this line that lies inside the polygon.\n\nFind the minimal total length of all cutting lines.\n\nBelow is an example; we need to obtain the polygon in the middle.\n\n![](https://cdn.luogu.com.cn/upload/pic/18468.png)\n\nCut along lines $1, 2, 3, 4$ respectively to obtain the quadrilateral in the middle.", "inputFormat": "The first line contains two integers $n,m\\ (0 < n,m < 500)$.\n\nThe second line contains an integer $p(3\\le p\\le 8)$, and each of the following $p$ lines contains two integers $x, y(0 < x < n, 0 < y < m)$, which are the vertex coordinates given in clockwise order.\n\nIt is guaranteed that the polygon is convex, no three points are collinear, and the input is valid.", "outputFormat": "Output a single line with the minimal total length of the cutting lines, rounded to $3$ decimal places. An error of $0.001$ is allowed.", "hint": "The sample corresponds to the example shown in the figure.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2003] 切割多边形", "background": "", "description": "我们希望通过切割得到一个凸 $p$ 边形，$p\\le 8$。\n\n一开始的时候，你有一个 $n\\times m$ 的矩形，即它的四角的坐标分别为 $(0,0), (0,m), (n,0), (n,m)$。每次，你可以选择一条直线把当前图形切割成两部分，保留其中一个部分（另一部分扔掉），切割线的长度为此直线在多边形内部的部分的长度。\n\n求出最短的切割线总长度。\n\n下面是一个例子，我们需要得到中间的多边形。\n\n![](https://cdn.luogu.com.cn/upload/pic/18468.png)\n\n分别沿着直线 $1,2,3,4$ 进行切割即可，得到中间的四边形。", "inputFormat": "第一行有两个整数 $n,m\\ (0 < n,m < 500)$。\n\n第二行为一个整数 $p(3\\le p\\le 8)$，以下 $p$ 行每行为两个整数 $x, y(0 < x < n, 0 < y < m)$，为按顺时针给出的各顶点坐标。\n\n数据保证多边形的是凸的，无三点共线，输入数据无错误。", "outputFormat": "仅一行，为最短切割线的总长度，四舍五入到小数点后 $3$ 位。允许有 $0.001$ 的误差。", "hint": "样例对应于图中给出的例子。", "locale": "zh-CN"}}}
{"pid": "P4530", "type": "P", "difficulty": 7, "samples": [["10 2\n0 -1 -2 0 1 2 3 2 10 1\n10 3\n0 -1 -2 0 1 2 3 2 10 1\n0 0", "240\n241"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2006", "CTSC/CTS"], "title": "[CTSC2006] 投篮游戏", "background": "", "description": "在大学里，体育课有很多门，每个人都可以选自己最喜欢的项目。King 这学期选的是篮球，因为篮球课的老师是一个十分有趣的人。\n\n上课的第一天，老师宣布了这门课的评分规则：\n\n有 $n$ 个篮球（$n\\ge m$），老师事先在每个球上写了一个整数（不一定相同，绝对值小于 $10000$）。有 $m$ 个篮，每个篮板上有一个计分器，显示一个整数。一个学生开始考核前先将所有计分器显示值赋为 $1$。\n\n每个学生考核时要进行 $n$ 次投篮：选择任意一个篮球投向任意一个篮。最后他必须将所有球全部投出且每个球恰好投出一次，要求每个篮至少被投进过一次。\n\n如果学生将一个写有整数 $x$ 的篮球投进了某个计分器显示为y的篮，则该篮板上的计分器显示值将从 $y$ 变成 $y\\times x$。\n\n一个学生的**原始得分** $S$ 定义为 $m$ 个计分器的显示值之和，如果 $S$ 越大则老师给这个学生的最终打分越高（事实上，老师根据名次按照正态分布给分，但此超出本题了讨论范围）。\n\nKing 是一个神投手，他保证能将 $n$ 个球全都投进。但是 King 的数学十分糟糕，他不知道该如何安排投篮，才能使得自己的**原始得分**最大，你能帮帮他吗？\n", "inputFormat": "输入有多组数据，每组数据有两行：\n\n第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数，用一个空格分开，表示老师在 $n$ 个篮球上分别写下的整数。\n\n文件以 `0 0` 结尾。一个文件中最多只有 $10$ 组数据。", "outputFormat": "\n每组数据一行，包含一个整数 $S_{max}$，表示最大可能的原始得分。\n\n提示：$S_{max}$ 可能超过任何基本整数类型。$S_{max}$ 也可能比 $0$ 小。", "hint": "\n**【约定】**\n\n- $1≤ m≤n≤ 2000$。\n\n- 恰有 $40\\%$ 的数据满足 $n≤100$。\n\n**【样例说明】**\n\n第一组数据有多解，其中一解为：$(0,0)(-1,-2,1,2,3,2,10,1)$\n\n第二组数据有多解，其中一解为：$(0,0)(1,1)(-1,-2,2,3,2,10)$", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2006] Shooting Game", "background": "", "description": "At university, there are many P.E. classes, and everyone can pick what they like. This semester, King chose basketball because the instructor is a very interesting person.\n\nOn the first day, the instructor announced the grading rules:\n\nThere are $n$ basketballs ($n \\ge m$). The instructor has written an integer on each ball in advance (not necessarily distinct, with absolute value less than $10000$). There are $m$ baskets, and each basket has a counter displaying an integer. Before a student starts, all counters are initialized to $1$.\n\nDuring the assessment, a student will take $n$ shots in total: for each shot, choose any basketball and throw it into any basket. In the end, all balls must be used and each ball must be used exactly once, and every basket must be used at least once.\n\nIf a ball labeled with integer $x$ is thrown into a basket whose counter currently displays $y$, then that basket’s counter changes from $y$ to $y \\times x$.\n\nA student’s raw score $S$ is defined as the sum of the $m$ counters’ displayed values. The larger $S$ is, the higher the final grade the instructor will assign (in fact, the instructor grades by ranking using a normal distribution, but that is beyond the scope of this problem).\n\nKing is a sharpshooter and guarantees every shot goes in. However, King is bad at math and does not know how to arrange the shots to maximize his raw score. Can you help him?", "inputFormat": "Multiple testcases. Each testcase consists of two lines:\n\n- The first line contains two integers $n, m$.\n- The second line contains $n$ integers separated by spaces, which are the integers written on the $n$ basketballs.\n\nThe input ends with a line containing `0 0`. There are at most $10$ testcases in a file.", "outputFormat": "For each testcase, output one line containing an integer $S_{max}$, the maximum possible raw score.", "hint": "- Constraints:\n  - $1 \\le m \\le n \\le 2000$.\n  - Exactly $40\\%$ of the testcases satisfy $n \\le 100$.\n\n- Notes:\n  - $S_{max}$ may exceed any basic integer type.\n  - $S_{max}$ may also be less than $0$.\n\n- Sample Explanation:\n  - The first testcase has multiple solutions; one solution is: $(0,0)(-1,-2,1,2,3,2,10,1)$.\n  - The second testcase has multiple solutions; one solution is: $(0,0)(1,1)(-1,-2,2,3,2,10)$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2006] 投篮游戏", "background": "", "description": "在大学里，体育课有很多门，每个人都可以选自己最喜欢的项目。King 这学期选的是篮球，因为篮球课的老师是一个十分有趣的人。\n\n上课的第一天，老师宣布了这门课的评分规则：\n\n有 $n$ 个篮球（$n\\ge m$），老师事先在每个球上写了一个整数（不一定相同，绝对值小于 $10000$）。有 $m$ 个篮，每个篮板上有一个计分器，显示一个整数。一个学生开始考核前先将所有计分器显示值赋为 $1$。\n\n每个学生考核时要进行 $n$ 次投篮：选择任意一个篮球投向任意一个篮。最后他必须将所有球全部投出且每个球恰好投出一次，要求每个篮至少被投进过一次。\n\n如果学生将一个写有整数 $x$ 的篮球投进了某个计分器显示为y的篮，则该篮板上的计分器显示值将从 $y$ 变成 $y\\times x$。\n\n一个学生的**原始得分** $S$ 定义为 $m$ 个计分器的显示值之和，如果 $S$ 越大则老师给这个学生的最终打分越高（事实上，老师根据名次按照正态分布给分，但此超出本题了讨论范围）。\n\nKing 是一个神投手，他保证能将 $n$ 个球全都投进。但是 King 的数学十分糟糕，他不知道该如何安排投篮，才能使得自己的**原始得分**最大，你能帮帮他吗？\n", "inputFormat": "输入有多组数据，每组数据有两行：\n\n第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数，用一个空格分开，表示老师在 $n$ 个篮球上分别写下的整数。\n\n文件以 `0 0` 结尾。一个文件中最多只有 $10$ 组数据。", "outputFormat": "\n每组数据一行，包含一个整数 $S_{max}$，表示最大可能的原始得分。\n\n提示：$S_{max}$ 可能超过任何基本整数类型。$S_{max}$ 也可能比 $0$ 小。", "hint": "\n**【约定】**\n\n- $1≤ m≤n≤ 2000$。\n\n- 恰有 $40\\%$ 的数据满足 $n≤100$。\n\n**【样例说明】**\n\n第一组数据有多解，其中一解为：$(0,0)(-1,-2,1,2,3,2,10,1)$\n\n第二组数据有多解，其中一解为：$(0,0)(1,1)(-1,-2,2,3,2,10)$", "locale": "zh-CN"}}}
{"pid": "P4531", "type": "P", "difficulty": 5, "samples": [["3 4 10000\n40 45 52\n10 27 30 55", "7 8250"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["贪心", "2005", "CTSC/CTS"], "title": "[CTSC2005] 魔术眼镜盒", "background": "", "description": "小花买了一只很有意思的魔术眼镜盒。眼镜盒盖由两半组成，每半水平分割为若干条纸带，如图1所示（左半为盒子底部，右半为盒子顶部）。灰色表示盒子的表面，白色表示空白区域。下图的眼镜盒有 $3$ 个纸带，每个纸带的长度均为 $50$ 毫米，但其他眼镜盒可能有不同数目的纸带，每条纸带的长度也不一定一样。\n\n![](https://cdn.luogu.com.cn/upload/pic/18472.png)\n\n眼镜盒的特别之处在于它有两种折法。图1的(a)和(b)就是它的两种折法，第一种折法把区域 $1，2，3$ 暴露在盒子的表面，而第二种折法把区域 $4，5，6$ 暴露在盒子的表面。如果一个眼镜盒有 $n$ 条纸带，那么折法1暴露出来的区域编号为 $1，2，...，n$，折法2暴露出来的区域编号为 $n+1，n+2，...，2n$ 。第 $i$ 个区域和第 $n+i$ 个区域是全等的。**在本题中，你不需要了解两种折法是怎么互相转化的**。\n\n小花有两种正方形纸片：公式纸片和卡通图片。她想把公式纸片贴在区域 $1，2，3$ 中，而把卡通图片贴在 $4，5，6$ 中，在学习的时候使用折法1，休息的时候使用折法2。每张纸片都必须完全位于区域的内部，纸片边界可以和区域边界重合。不同的纸片必须贴在不同的区域，有的区域内也可以不贴纸片。\n\n标准的眼镜盒长度为 $150$，宽度为 $55$，面积为 $8250$，分为长度相等的三个纸带，因此每个白色区域的尺寸为 $55 \\times 50$。小花有 $3$ 张公式纸片，边长分别为 $40，45$ 和 $52$；$4$ 张卡通纸片，边长分别为 $10, 27, 30, 55$，只能在正面放 $40$ 和 $45$，反面放 $10，27$ 和 $30$。显然，标准眼镜盒并不能满足小花的要求。\n\n好在眼镜盒公司允许用户订做自己的眼镜盒，盒子长度、宽度、纸带数目和每条纸带的长度都是可以任意修改的，即长度可以不是 $150$，宽度也可以不是 $55$。小花发现如果眼镜盒子尺寸不变，而换四条长度为 $40, 45, 55$ 和 $10$ 的纸带，所有纸片就都能放下了，如图2所示。\n\n![](https://cdn.luogu.com.cn/upload/pic/18473.png)\n\n面积越大的眼镜盒越贵，因此小花希望买一个面积不超过 $s$ 的眼镜盒。应该如何选购眼镜盒、设计纸带和贴小纸片，使得眼镜盒上的小纸片总数尽量多？纸片最多的前提下，眼镜盒的面积最小是多大？", "inputFormat": "输入文件的第一行为三个整数 $n，m$ 和 $s$，分别表示公式纸片，卡通纸片的个数，以及眼镜盒的面积上限。第二行有 $n$ 个正整数，表示每个公式纸片的边长；第三行有 $m$ 个正整数，表示每个卡通图片的边长。", "outputFormat": "输出文件仅包含一行，有两个整数 $C_{max}$ 和 $S_{min}$，表示能贴在盒上的纸片个数的最大值，及在此条件下眼镜盒面积的最小值。", "hint": "$1 \\le n,m \\le 5 \\times 10^4, 1 \\le s\\le 10^{13}$，所有纸片边长不超过 $4 \\times 10^4$。\n\n$50 \\%$ 的数据满足 $1 \\le n,m \\le 10^3$", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2005] Magic Glasses Case", "background": "", "description": "Xiaohua bought a very interesting magic glasses case. The lid of the case is made of two halves, and each half is horizontally divided into several paper strips, as shown in Figure 1 (the left half is the bottom part of the case, and the right half is the top part). Gray indicates the surface of the case, and white indicates blank areas. The case in the figure has $3$ strips, and each strip has length $50$ mm, but other cases may have a different number of strips, and the lengths of the strips may also be different.\n\n![](https://cdn.luogu.com.cn/upload/pic/18472.png)\n\nThe special thing about this case is that it can be folded in two ways. Figure 1(a) and (b) show these two folding methods. The first folding method exposes areas $1,2,3$ on the surface of the case, while the second folding method exposes areas $4,5,6$ on the surface. If a case has $n$ strips, then folding method 1 exposes areas numbered $1,2,\\ldots,n$, and folding method 2 exposes areas numbered $n+1,n+2,\\ldots,2n$. Area $i$ and area $n+i$ are congruent. **In this problem, you do not need to know how the two folding methods are converted into each other.**\n\nXiaohua has two kinds of square paper pieces: formula pieces and cartoon pictures. She wants to stick the formula pieces onto areas $1,2,3$, and stick the cartoon pictures onto areas $4,5,6$, so that she can use folding method 1 when studying and folding method 2 when resting. Each paper piece must lie completely inside an area, and its boundary is allowed to coincide with the boundary of the area. Different paper pieces must be placed in different areas, and some areas may also be left empty.\n\nA standard case has length $150$, width $55$, and area $8250$. It is divided into three strips of equal length, so each white area has size $55 \\times 50$. Xiaohua has $3$ formula pieces with side lengths $40,45,52$, and $4$ cartoon pieces with side lengths $10, 27, 30, 55$. She can only place $40$ and $45$ on the front side, and $10,27,30$ on the back side. Obviously, the standard case cannot meet her needs.\n\nFortunately, the case company allows users to customize their own cases: the case length, width, number of strips, and the length of each strip can all be modified arbitrarily. That is, the length does not have to be $150$, and the width does not have to be $55$. Xiaohua found that if the case size stays the same, but the strips are changed to four strips with lengths $40,45,55,10$, then all pieces can fit, as shown in Figure 2.\n\n![](https://cdn.luogu.com.cn/upload/pic/18473.png)\n\nA larger-area case is more expensive, so Xiaohua wants to buy a case with area not exceeding $s$. How should she choose the case, design the strips, and place the small paper pieces, so that the total number of pieces on the case is as large as possible? Under the condition that the number of pieces is maximized, what is the minimum possible area of the case?", "inputFormat": "The first line of the input contains three integers $n,m,s$, representing the numbers of formula pieces, cartoon pieces, and the upper limit on the case area, respectively. The second line contains $n$ positive integers, representing the side length of each formula piece. The third line contains $m$ positive integers, representing the side length of each cartoon picture.", "outputFormat": "The output contains only one line with two integers $C_{max}$ and $S_{min}$, representing the maximum number of pieces that can be stuck onto the case, and the minimum case area under this condition.", "hint": "Constraints: $1 \\le n,m \\le 5 \\times 10^4$, $1 \\le s \\le 10^{13}$. All paper piece side lengths do not exceed $4 \\times 10^4$.\n\nFor $50\\%$ of the testdata: $1 \\le n,m \\le 10^3$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2005] 魔术眼镜盒", "background": "", "description": "小花买了一只很有意思的魔术眼镜盒。眼镜盒盖由两半组成，每半水平分割为若干条纸带，如图1所示（左半为盒子底部，右半为盒子顶部）。灰色表示盒子的表面，白色表示空白区域。下图的眼镜盒有 $3$ 个纸带，每个纸带的长度均为 $50$ 毫米，但其他眼镜盒可能有不同数目的纸带，每条纸带的长度也不一定一样。\n\n![](https://cdn.luogu.com.cn/upload/pic/18472.png)\n\n眼镜盒的特别之处在于它有两种折法。图1的(a)和(b)就是它的两种折法，第一种折法把区域 $1，2，3$ 暴露在盒子的表面，而第二种折法把区域 $4，5，6$ 暴露在盒子的表面。如果一个眼镜盒有 $n$ 条纸带，那么折法1暴露出来的区域编号为 $1，2，...，n$，折法2暴露出来的区域编号为 $n+1，n+2，...，2n$ 。第 $i$ 个区域和第 $n+i$ 个区域是全等的。**在本题中，你不需要了解两种折法是怎么互相转化的**。\n\n小花有两种正方形纸片：公式纸片和卡通图片。她想把公式纸片贴在区域 $1，2，3$ 中，而把卡通图片贴在 $4，5，6$ 中，在学习的时候使用折法1，休息的时候使用折法2。每张纸片都必须完全位于区域的内部，纸片边界可以和区域边界重合。不同的纸片必须贴在不同的区域，有的区域内也可以不贴纸片。\n\n标准的眼镜盒长度为 $150$，宽度为 $55$，面积为 $8250$，分为长度相等的三个纸带，因此每个白色区域的尺寸为 $55 \\times 50$。小花有 $3$ 张公式纸片，边长分别为 $40，45$ 和 $52$；$4$ 张卡通纸片，边长分别为 $10, 27, 30, 55$，只能在正面放 $40$ 和 $45$，反面放 $10，27$ 和 $30$。显然，标准眼镜盒并不能满足小花的要求。\n\n好在眼镜盒公司允许用户订做自己的眼镜盒，盒子长度、宽度、纸带数目和每条纸带的长度都是可以任意修改的，即长度可以不是 $150$，宽度也可以不是 $55$。小花发现如果眼镜盒子尺寸不变，而换四条长度为 $40, 45, 55$ 和 $10$ 的纸带，所有纸片就都能放下了，如图2所示。\n\n![](https://cdn.luogu.com.cn/upload/pic/18473.png)\n\n面积越大的眼镜盒越贵，因此小花希望买一个面积不超过 $s$ 的眼镜盒。应该如何选购眼镜盒、设计纸带和贴小纸片，使得眼镜盒上的小纸片总数尽量多？纸片最多的前提下，眼镜盒的面积最小是多大？", "inputFormat": "输入文件的第一行为三个整数 $n，m$ 和 $s$，分别表示公式纸片，卡通纸片的个数，以及眼镜盒的面积上限。第二行有 $n$ 个正整数，表示每个公式纸片的边长；第三行有 $m$ 个正整数，表示每个卡通图片的边长。", "outputFormat": "输出文件仅包含一行，有两个整数 $C_{max}$ 和 $S_{min}$，表示能贴在盒上的纸片个数的最大值，及在此条件下眼镜盒面积的最小值。", "hint": "$1 \\le n,m \\le 5 \\times 10^4, 1 \\le s\\le 10^{13}$，所有纸片边长不超过 $4 \\times 10^4$。\n\n$50 \\%$ 的数据满足 $1 \\le n,m \\le 10^3$", "locale": "zh-CN"}}}
{"pid": "P4532", "type": "P", "difficulty": 0, "samples": [["8 30.0\nA -2\nA 0\nB 7 8 5.0\nB 4 -3 2.0\nB -3 4 1.0\nA 2\nB -4 5 1.0\nA 4", "3"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2005", "CTSC/CTS"], "title": "[CTSC2005] 合并正方形", "background": "", "description": "一个二维平面初始时为空，有一串往平面中加入点的命令。\n\n加入的点有两种，这里称为 A 类点和 B 类点（如图 1，黑色正方形表示 A 类点，小圆黑点表示 B 类点）。A 类点一定位于 $X$ 轴上，而且不会重叠，而 B 类点可以出现在平面上的任何一个位置，可以重叠。每个 B 类点有一个权值 $W$。\n\n![](https://cdn.luogu.com.cn/upload/pic/18474.png)\n\n处理：一、最初，将相邻两个 A 类点之间连一个与 $X$ 轴成 $45$ 度的正方形（如图 2）。二、每次可以将任意两个有公共点的正方形合并为一个大正方形，合并之后两个小正方形消失。图 2 的左数第 $2$、$3$ 的正方形合并后在图 3 中表示为灰边正方形。\n\n![](https://cdn.luogu.com.cn/upload/pic/18475.png)\n\n合并后的正方形将平面划分为 $9$ 个区域，与正方形 $4$ 条边相邻的 $4$ 个区域分别为图 3 中的 I，II，III，IV。落在区域 I 中的 B 类点的权值和记为 $w_1$，落在区域 II 中的 B 类点的权值和记为 $w_2$，落在区域 III 中的 B 类点的权值和记为 $w_3$，落在区域 IV 中的 B 类点的权值和记为 $w_4$。落在灰色正方形内部的 B 类点的权值和记为 $w_5$（B 类点保证不会出现在任何一个区域的边界上），则合并费用为 $w_1+2w_2+3w_3+4w_4+5w_5$。落在其他区域的 B 类点不予考虑。每次合并之后并不影响 B 类点在平面上的位置和它自己所拥有的权值。\n\n每进行一次合并，由 A 类点形成的正方形会减少一个，直到只剩下一个正方形为止。合并总费用为每次合并费用之和。不同合并顺序的合并费用可能会不同。\n\n点是一个一个加入到平面的。加入第 $i$ 个 A 类点后，平面上有 $i$ 个 A 类点和在此之前加入的所有 B 类点。设此时的**最小**合并费用为 $f(i)$。\n\n给定费用限制 $L$，编程求出 A 类点的最大数目 $K$，使得**前 $K$ 个 A 类点**的最小合并费用不超过 $L$，即 $f(K)\\le L$。 ", "inputFormat": "第一行包含两个数 $M$，$L$，表示有 $M$ 条加入点的命令，费用限制为 $L$。\n\n以下包含 $M$ 行，每行一个字母表示点的类型。`A` 表示 A 类点，`B` 表示 B 类点。对于 A 类点，后面一个数表示这个点的 $X$ 坐标；对于 B 类点，后面三个数表示这个点的 $X$，$Y$ 坐标和这个点的权值。", "outputFormat": "输出文件仅包含一个整数 $K_{max}$，即使 $f(K) \\le L$的最大 $K$。", "hint": "### 样例说明\n\n输入最后一个点时，所有点如下图。B 类点旁边的数字为权值。\n\n![](https://cdn.luogu.com.cn/upload/pic/18476.png)\n\n合并前 $3$ 个点的最小费用为 $f(3) = 27$，合并前 $4$ 个点的最小费用 $f(4) = 36$。由于 $f(3) < 30$ 而 $f(4) > 30$，因此最大的 $K$ 为 $3$。\n\n### 约定\n\n$3 \\le \\text{A 类点的数目} \\le 30000$\n\n$5 \\le M \\le 100000$\n\n$X$，$Y$均为整数，绝对值不超过 $10000000$\n\n$L, W$ 均为实数，$0<W \\le 10000$，$L\\le 10^{11}$，所有输入实数最多保留三位小数\n\n$50\\%$ 的数据满足 $M \\le3000$", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2005] Merging Squares", "background": "", "description": "A two-dimensional plane is initially empty. There is a sequence of commands that add points to the plane.\n\nThere are two kinds of points, called type A points and type B points (see Figure 1, where black squares denote type A points and small black dots denote type B points). Type A points always lie on the $X$-axis and never overlap, while type B points can appear anywhere on the plane and may overlap. Each type B point has a weight $W$.\n\n![](https://cdn.luogu.com.cn/upload/pic/18474.png)\n\nProcessing: (1) Initially, between every pair of adjacent type A points, draw a square whose sides make a $45$-degree angle with the $X$-axis (see Figure 2). (2) Each time, you may merge any two squares that share at least one common point into a larger square; after merging, the two smaller squares disappear. The second and third squares from the left in Figure 2 are merged and shown as the gray-edged square in Figure 3.\n\n![](https://cdn.luogu.com.cn/upload/pic/18475.png)\n\nAfter merging, the resulting square divides the plane into $9$ regions. The $4$ regions adjacent to the $4$ sides of the square are labeled I, II, III, IV in Figure 3. Let $w_1$ be the sum of weights of type B points falling into region I, $w_2$ for region II, $w_3$ for region III, and $w_4$ for region IV. Let $w_5$ be the sum of weights of type B points falling inside the gray square (type B points are guaranteed not to lie on the boundaries of any region). Then the cost of this merge is $w_1 + 2 w_2 + 3 w_3 + 4 w_4 + 5 w_5$. Type B points in other regions are ignored. Each merge does not affect the positions or weights of the type B points.\n\nEach time you perform a merge, the number of squares formed by type A points decreases by one, until only one square remains. The total merge cost is the sum of the costs of all merges. Different merge orders may result in different total costs.\n\nPoints are added to the plane one by one. After adding the $i$-th type A point, the plane contains $i$ type A points and all previously added type B points. Let the minimum total merge cost at this moment be $f(i)$.\n\nGiven a cost limit $L$, compute the maximum number $K$ of type A points such that the minimum total merge cost for the first $K$ type A points does not exceed $L$, i.e., $f(K) \\le L$.", "inputFormat": "The first line contains two numbers $M$, $L$, meaning there are $M$ add-point commands and the cost limit is $L$.\n\nThen follow $M$ lines, each starting with a letter indicating the point type. `A` denotes a type A point, and `B` denotes a type B point. For a type A point, one number follows giving its $X$-coordinate; for a type B point, three numbers follow giving its $X$-coordinate, $Y$-coordinate, and weight.", "outputFormat": "Output a single integer $K_{max}$, which is the largest $K$ such that $f(K) \\le L$.", "hint": "Sample explanation:\n\nIn the state after adding the last point, all points are as shown below. The number next to each type B point is its weight.\n\n![](https://cdn.luogu.com.cn/upload/pic/18476.png)\n\nThe minimum cost for the first $3$ type A points is $f(3) = 27$, and for the first $4$ type A points is $f(4) = 36$. Since $f(3) < 30$ and $f(4) > 30$, the maximum $K$ is $3$.\n\nConstraints:\n\n- $3 \\le \\text{number of type A points} \\le 30000$.\n- $5 \\le M \\le 100000$.\n- $X$, $Y$ are integers with absolute value at most $10000000$.\n- $L$, $W$ are real numbers with $0 < W \\le 10000$, $L \\le 10^{11}$; all input real numbers have at most three decimal places.\n- $50\\%$ of the testdata satisfies $M \\le 3000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2005] 合并正方形", "background": "", "description": "一个二维平面初始时为空，有一串往平面中加入点的命令。\n\n加入的点有两种，这里称为 A 类点和 B 类点（如图 1，黑色正方形表示 A 类点，小圆黑点表示 B 类点）。A 类点一定位于 $X$ 轴上，而且不会重叠，而 B 类点可以出现在平面上的任何一个位置，可以重叠。每个 B 类点有一个权值 $W$。\n\n![](https://cdn.luogu.com.cn/upload/pic/18474.png)\n\n处理：一、最初，将相邻两个 A 类点之间连一个与 $X$ 轴成 $45$ 度的正方形（如图 2）。二、每次可以将任意两个有公共点的正方形合并为一个大正方形，合并之后两个小正方形消失。图 2 的左数第 $2$、$3$ 的正方形合并后在图 3 中表示为灰边正方形。\n\n![](https://cdn.luogu.com.cn/upload/pic/18475.png)\n\n合并后的正方形将平面划分为 $9$ 个区域，与正方形 $4$ 条边相邻的 $4$ 个区域分别为图 3 中的 I，II，III，IV。落在区域 I 中的 B 类点的权值和记为 $w_1$，落在区域 II 中的 B 类点的权值和记为 $w_2$，落在区域 III 中的 B 类点的权值和记为 $w_3$，落在区域 IV 中的 B 类点的权值和记为 $w_4$。落在灰色正方形内部的 B 类点的权值和记为 $w_5$（B 类点保证不会出现在任何一个区域的边界上），则合并费用为 $w_1+2w_2+3w_3+4w_4+5w_5$。落在其他区域的 B 类点不予考虑。每次合并之后并不影响 B 类点在平面上的位置和它自己所拥有的权值。\n\n每进行一次合并，由 A 类点形成的正方形会减少一个，直到只剩下一个正方形为止。合并总费用为每次合并费用之和。不同合并顺序的合并费用可能会不同。\n\n点是一个一个加入到平面的。加入第 $i$ 个 A 类点后，平面上有 $i$ 个 A 类点和在此之前加入的所有 B 类点。设此时的**最小**合并费用为 $f(i)$。\n\n给定费用限制 $L$，编程求出 A 类点的最大数目 $K$，使得**前 $K$ 个 A 类点**的最小合并费用不超过 $L$，即 $f(K)\\le L$。 ", "inputFormat": "第一行包含两个数 $M$，$L$，表示有 $M$ 条加入点的命令，费用限制为 $L$。\n\n以下包含 $M$ 行，每行一个字母表示点的类型。`A` 表示 A 类点，`B` 表示 B 类点。对于 A 类点，后面一个数表示这个点的 $X$ 坐标；对于 B 类点，后面三个数表示这个点的 $X$，$Y$ 坐标和这个点的权值。", "outputFormat": "输出文件仅包含一个整数 $K_{max}$，即使 $f(K) \\le L$的最大 $K$。", "hint": "### 样例说明\n\n输入最后一个点时，所有点如下图。B 类点旁边的数字为权值。\n\n![](https://cdn.luogu.com.cn/upload/pic/18476.png)\n\n合并前 $3$ 个点的最小费用为 $f(3) = 27$，合并前 $4$ 个点的最小费用 $f(4) = 36$。由于 $f(3) < 30$ 而 $f(4) > 30$，因此最大的 $K$ 为 $3$。\n\n### 约定\n\n$3 \\le \\text{A 类点的数目} \\le 30000$\n\n$5 \\le M \\le 100000$\n\n$X$，$Y$均为整数，绝对值不超过 $10000000$\n\n$L, W$ 均为实数，$0<W \\le 10000$，$L\\le 10^{11}$，所有输入实数最多保留三位小数\n\n$50\\%$ 的数据满足 $M \\le3000$", "locale": "zh-CN"}}}
{"pid": "P4533", "type": "P", "difficulty": 0, "samples": [["3 2\n1 3 2 4 3 5\n1 1 -1 1 2\n1 1 1 2 3", "3 3 4 4 3 3"], ["3 1\n1 5 2 5 1 3\n2 1 1 1 2 3", "1 2 2 3 2 3"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2005", "CTSC/CTS"], "title": "[CTSC2005] 玩具的重量", "background": null, "description": "冰冰有三个玩具：皮卡秋、维妮孙悟空和芭比娃娃。她并不知道这些玩具的具体重量（采用 NOI 单位），但是知道每个玩具重量的大概范围，如下表：\n\n表 1. \n玩具和它们的最小、最大可能重量|皮卡秋|维妮孙悟空|芭比娃娃\n:-:|:-:|:-:|:-:\n最小可能重量|$1$|$2$|$3$\n最大可能重量|$3$|$4$|$5$\n\n这些范围太粗略，冰冰希望能把它们缩小一些。\n\n正好佳佳有一个电子天平，不仅可以告诉你左右两边是否一样重，还可以告诉你左边比右边重（或轻）多少。天平很大，左右两边都可以放任意多件玩具。\n\n冰冰向佳佳借电子天平，希望能算出每个玩具的精确重量。佳佳为了考验冰冰，只允许她把任意一个玩具往天平的左侧和右侧最多各放一次。例如，如果她曾经把皮卡秋放在天平的左侧，则她不能再次把它放在天平的左侧。冰冰同意了。她一共称量了两次，结果如下（数字表示左边比右边重多少）：\n\n![](https://cdn.luogu.com.cn/upload/pic/18477.png)\n\n根据结果和表 1，可以确定三个玩具的重量一定是 $3,4,3$，也就是说，通过称量结果所得到的更新后的重量范围是：\n\n表2. 根据称量结果所得到的精确范围|皮卡秋|维妮孙悟空|芭比娃娃\n:-:|:-:|:-:|:-:\n最小可能重量|$3$|$4$|$3$\n最大可能重量|$3$|$4$|$3$\n\n冰冰以后还会买很多很多玩具，她不想每次都自己计算每个玩具的重量。她需要写一个程序计算每个玩具最精确的重量下限和上限，你能帮她吗？", "inputFormat": "输入文件第一行包含两个整数 $n$ 和 $m$，即玩具的个数和称量的次数。\n\n第二行包含 $2n$ 个数，第 $2i-1$ 个数和第 $2i$ 个数分别表示第 $i$ 个玩具的重量初始下限和初始上限。\n\n以下 $m$ 行，每行前三个数 $L，R，D$ 表示左边的玩具数、右边的玩具数和左右两边的重量差（$L, R \\ge 0$），接下来的 $L$ 个数为天平左边的玩具编号，再接下来的 $R$ 个数为天平右边的玩具编号。输入保证每个玩具在天平的每一边最多出现一次。", "outputFormat": "输出文件包含 $2n$ 个整数，第 $2i-1$ 个数和第 $2i$ 个数分别表示第 $i$ 个玩具的重量下限和上限，即最小可能的整数重量和最大可能的整数重量。如果无解（可能是天平坏了），只输出一个数 $-1$。", "hint": "【样例解释】\n\n样例 $1$ 对应于题目描述中的例子。\n\n在样例 $2$ 中，冰冰有三个玩具，重量的原始范围为 $1 \\sim 5$, $2 \\sim 5$, $1 \\sim 3$。只有一次称量，天平的左边是玩具 $1$ 和玩具 $2$，右边是玩具 $3$。左边比右边重 $1$ 个单位。根据此结果，可以判断三个玩具的重量范围为 $1 \\sim 2$，$2 \\sim 3$ 和 $2 \\sim 3$。\n\n【约定】\n\n$3 \\le n \\le 200, 1 \\le m \\le 100$，重量上限不超过 $20000$。\n\n$50\\%$ 的数据满足 $3 \\le n \\le 10，1 \\le m \\le 5$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2005] Toy Weights", "background": "", "description": "Bingbing has three toys: Pikachu, Weini Sun Wukong, and a Barbie doll. She does not know their exact weights (in NOI units), but she knows an approximate range for each toy, as shown below:\n\nTable 1.\nToys and their minimum and maximum possible weights|Pikachu|Weini Sun Wukong|Barbie doll\n:-:|:-:|:-:|:-:\nMinimum possible weight|$1$|$2$|$3$\nMaximum possible weight|$3$|$4$|$5$\n\nThese ranges are too coarse, and Bingbing wants to narrow them down.\n\nJiajia happens to have a digital balance. It can tell not only whether the two sides are equal in weight, but also by how much the left side is heavier (or lighter) than the right. The balance is large; either side can hold any number of toys.\n\nBingbing borrows the balance and hopes to determine the exact weight of each toy. To test her, Jiajia allows her to place any toy on the left side and on the right side at most once each. For example, if she has ever placed Pikachu on the left side, she cannot place Pikachu on the left side again. Bingbing agrees. She performs two weighings, and the results are as follows (the number indicates how much heavier the left side is than the right):\n\n![](https://cdn.luogu.com.cn/upload/pic/18477.png)\n\nFrom the results and Table 1, it can be determined that the weights of the three toys must be $3, 4, 3$. That is, the updated ranges obtained from the weighings are:\n\nTable 2. Precise ranges obtained from the weighing results|Pikachu|Weini Sun Wukong|Barbie doll\n:-:|:-:|:-:|:-:\nMinimum possible weight|$3$|$4$|$3$\nMaximum possible weight|$3$|$4$|$3$\n\nBingbing will buy many more toys in the future and does not want to compute the weight of each toy by hand every time. She needs a program to compute the most precise lower and upper bounds of each toy’s weight. Can you help her?", "inputFormat": "The first line contains two integers $n$ and $m$, the number of toys and the number of weighings.\n\nThe second line contains $2n$ numbers. For each $i$, the $(2i-1)$-th and $2i$-th numbers are the initial lower bound and upper bound of the weight of toy $i$.\n\nEach of the following $m$ lines starts with three numbers $L, R, D$, denoting the number of toys on the left, the number of toys on the right, and the weight difference between the two sides (left minus right, with $L, R \\ge 0$). The next $L$ numbers are the indices of the toys on the left side of the balance, followed by $R$ numbers for the right side. The input guarantees that each toy appears on each side of the balance at most once in total.", "outputFormat": "Output $2n$ integers. For each $i$, the $(2i-1)$-th and $2i$-th numbers are the lower and upper bounds of toy $i$’s weight, i.e., the minimum possible integer weight and the maximum possible integer weight. If there is no solution (the balance might be broken), output only $-1$.", "hint": "Sample explanation:\n\nSample $1$ corresponds to the example in the problem statement.\n\nIn sample $2$, Bingbing has three toys with initial ranges $1 \\sim 5$, $2 \\sim 5$, and $1 \\sim 3$. There is only one weighing: the left side has toys $1$ and $2$, and the right side has toy $3$. The left side is heavier by $1$ unit. From this, the ranges can be determined to be $1 \\sim 2$, $2 \\sim 3$, and $2 \\sim 3$.\n\nConstraints:\n\n$3 \\le n \\le 200$, $1 \\le m \\le 100$, and all upper bounds of weights are at most $20000$.\n\n$50\\%$ of the testdata satisfies $3 \\le n \\le 10$, $1 \\le m \\le 5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2005] 玩具的重量", "background": null, "description": "冰冰有三个玩具：皮卡秋、维妮孙悟空和芭比娃娃。她并不知道这些玩具的具体重量（采用 NOI 单位），但是知道每个玩具重量的大概范围，如下表：\n\n表 1. \n玩具和它们的最小、最大可能重量|皮卡秋|维妮孙悟空|芭比娃娃\n:-:|:-:|:-:|:-:\n最小可能重量|$1$|$2$|$3$\n最大可能重量|$3$|$4$|$5$\n\n这些范围太粗略，冰冰希望能把它们缩小一些。\n\n正好佳佳有一个电子天平，不仅可以告诉你左右两边是否一样重，还可以告诉你左边比右边重（或轻）多少。天平很大，左右两边都可以放任意多件玩具。\n\n冰冰向佳佳借电子天平，希望能算出每个玩具的精确重量。佳佳为了考验冰冰，只允许她把任意一个玩具往天平的左侧和右侧最多各放一次。例如，如果她曾经把皮卡秋放在天平的左侧，则她不能再次把它放在天平的左侧。冰冰同意了。她一共称量了两次，结果如下（数字表示左边比右边重多少）：\n\n![](https://cdn.luogu.com.cn/upload/pic/18477.png)\n\n根据结果和表 1，可以确定三个玩具的重量一定是 $3,4,3$，也就是说，通过称量结果所得到的更新后的重量范围是：\n\n表2. 根据称量结果所得到的精确范围|皮卡秋|维妮孙悟空|芭比娃娃\n:-:|:-:|:-:|:-:\n最小可能重量|$3$|$4$|$3$\n最大可能重量|$3$|$4$|$3$\n\n冰冰以后还会买很多很多玩具，她不想每次都自己计算每个玩具的重量。她需要写一个程序计算每个玩具最精确的重量下限和上限，你能帮她吗？", "inputFormat": "输入文件第一行包含两个整数 $n$ 和 $m$，即玩具的个数和称量的次数。\n\n第二行包含 $2n$ 个数，第 $2i-1$ 个数和第 $2i$ 个数分别表示第 $i$ 个玩具的重量初始下限和初始上限。\n\n以下 $m$ 行，每行前三个数 $L，R，D$ 表示左边的玩具数、右边的玩具数和左右两边的重量差（$L, R \\ge 0$），接下来的 $L$ 个数为天平左边的玩具编号，再接下来的 $R$ 个数为天平右边的玩具编号。输入保证每个玩具在天平的每一边最多出现一次。", "outputFormat": "输出文件包含 $2n$ 个整数，第 $2i-1$ 个数和第 $2i$ 个数分别表示第 $i$ 个玩具的重量下限和上限，即最小可能的整数重量和最大可能的整数重量。如果无解（可能是天平坏了），只输出一个数 $-1$。", "hint": "【样例解释】\n\n样例 $1$ 对应于题目描述中的例子。\n\n在样例 $2$ 中，冰冰有三个玩具，重量的原始范围为 $1 \\sim 5$, $2 \\sim 5$, $1 \\sim 3$。只有一次称量，天平的左边是玩具 $1$ 和玩具 $2$，右边是玩具 $3$。左边比右边重 $1$ 个单位。根据此结果，可以判断三个玩具的重量范围为 $1 \\sim 2$，$2 \\sim 3$ 和 $2 \\sim 3$。\n\n【约定】\n\n$3 \\le n \\le 200, 1 \\le m \\le 100$，重量上限不超过 $20000$。\n\n$50\\%$ 的数据满足 $3 \\le n \\le 10，1 \\le m \\le 5$。", "locale": "zh-CN"}}}
{"pid": "P4534", "type": "P", "difficulty": 6, "samples": [["4\n0 0\n3 0\n3 3\n0 3\n4\n1 1\n2 1\n2 2\n1 2", "8"], ["4\n0 0\n3 0\n3 3\n0 3\n4\n0 0\n2 0\n2 3\n0 3", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["计算几何", "2004", "CTSC/CTS"], "title": "[CTSC2004] 最优切割", "background": "HURRICANE 小组的成员最近去工厂实习，在实习的过程中遇到了如下的问题。", "description": "HURRICANE 小组要在一个模板内切割出一个零件。\n\n现已知模板和零件都是给定的凸多边形，且零件在模板中的位置已经固定。\n\n对于零件来说，除相邻的两边外，其任何两条边的延长线的交点都在模板之外。\n\n由于工厂的加工条件所限，切割时，每一刀必须沿零件的某一条边所在的直线切下，把模板分成两部分，然后保留含有零件的一部分，再继续切割。\n\n切割的每一刀的费用为模板上切痕的长度，现在你需要求出切割出这个零件所需的最小总费用。", "inputFormat": "第一行输入一个正整数 $n$，表示模板的顶点个数。\n\n接下来 $n$ 行每行输入两个实数 $x,y$，为按逆时针方向给出的模板顶点的坐标。\n\n第 $n+2$ 行输入一个正整数 $m$，表示零件的顶点个数。\n\n接下来 $m$ 行每行输入两个实数 $x,y$，为按逆时针方向给出的零件顶点的坐标。", "outputFormat": "输出一个整数，表示所需最小总费用四舍五入到整数后的值。", "hint": "对于 $100\\%$ 的数据，保证 $3\\le n,m\\le 2000$ 且 $|x|,|y|\\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2004] Optimal Cutting", "background": "Members of the HURRICANE team recently went to a factory for an internship and encountered the following problem during the process.", "description": "The HURRICANE team needs to cut out a part from within a template.\n\nBoth the template and the part are given convex polygons, and the position of the part inside the template is fixed.\n\nFor the part, for any two non-adjacent edges, the intersection point of the extensions of their supporting lines lies outside the template.\n\nDue to factory constraints, each cut must follow the straight line containing some edge of the part, splitting the template into two pieces. Keep the piece that contains the part and continue cutting.\n\nThe cost of each cut is the length of the cut mark on the template. You need to compute the minimum total cost required to cut out the part.", "inputFormat": "The first line contains a positive integer $n$, the number of vertices of the template.\n\nThe next $n$ lines each contain two real numbers $x, y$, giving the coordinates of the template’s vertices listed in counterclockwise order.\n\nThe $(n+2)$-th line contains a positive integer $m$, the number of vertices of the part.\n\nThe next $m$ lines each contain two real numbers $x, y$, giving the coordinates of the part’s vertices listed in counterclockwise order.", "outputFormat": "Output a single integer, which is the minimum total cost rounded to the nearest integer.", "hint": "For $100\\%$ of the testdata, it is guaranteed that $3 \\le n, m \\le 2000$ and $|x|, |y| \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2004] 最优切割", "background": "HURRICANE 小组的成员最近去工厂实习，在实习的过程中遇到了如下的问题。", "description": "HURRICANE 小组要在一个模板内切割出一个零件。\n\n现已知模板和零件都是给定的凸多边形，且零件在模板中的位置已经固定。\n\n对于零件来说，除相邻的两边外，其任何两条边的延长线的交点都在模板之外。\n\n由于工厂的加工条件所限，切割时，每一刀必须沿零件的某一条边所在的直线切下，把模板分成两部分，然后保留含有零件的一部分，再继续切割。\n\n切割的每一刀的费用为模板上切痕的长度，现在你需要求出切割出这个零件所需的最小总费用。", "inputFormat": "第一行输入一个正整数 $n$，表示模板的顶点个数。\n\n接下来 $n$ 行每行输入两个实数 $x,y$，为按逆时针方向给出的模板顶点的坐标。\n\n第 $n+2$ 行输入一个正整数 $m$，表示零件的顶点个数。\n\n接下来 $m$ 行每行输入两个实数 $x,y$，为按逆时针方向给出的零件顶点的坐标。", "outputFormat": "输出一个整数，表示所需最小总费用四舍五入到整数后的值。", "hint": "对于 $100\\%$ 的数据，保证 $3\\le n,m\\le 2000$ 且 $|x|,|y|\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P4535", "type": "P", "difficulty": 7, "samples": [["4 12333+33\n312331", "5"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2004", "CTSC/CTS"], "title": "[CTSC2004] 数字搜索", "background": "HURRICANE小组最近接到了一个搜索文本的任务，即从一个由数字构成的长文本中，匹配满足指定条件的子串。搜索的条件采用形如‘(0+10\\*1)\\*10\\*’这样的正则表达式来描述。其中正则表达式的归纳定义如下：\n\n1. 0, 1, …, 9，0\\*, 1\\*, …, 9\\*是正则表达式；\n\n2. 如果A和B是正则表达式，则(A)，A+B，AB，(A)\\*都是正则表达式；\n\n3. 只有按以上方法构造出来的表达式才是正则表达式。\n\n其中，A+B表示“或者”关系，AB表示“连接”关系，(A)\\*表示A的内容“重复”零次或者多次。比如正则表达式(12+3)(4+5)6\\*，就可以匹配以124，125，34，35之一开头，之后接零0个或任意多个6的字符串（例如字符串12566）。正则表达式(1+0)\\*可以匹配所有由0和1构成的字符串，或者是空串。如果一个正则表达式不能匹配空串，则称它是非空的。**本题考虑的都是非空正则表达式**。\n\n如果在给定文本的某一个位置，存在一个以该位置结束的子串，能够被给定的非空正则表达式匹配，则称该位置是可匹配的。现在HURRICANE小组接到的任务就是找出所有可匹配的位置。你能帮助他们完成这个任务么？", "description": "你的程序需要根据给定的输入，给出符合题意的输出：\n\n- 输入包括一个满足如上定义的正则表达式，以及一长串文本；\n\n- 你需要根据输入的正则表达式及文本，找出文本中所有可匹配的位置；\n\n- 你给出的输出需要包括所有可匹配的位置。", "inputFormat": "输入文件regular.in的第一行描述一个正则表达式，第二行为需要处理的文本：\n\n- 第一行的正则表达式包括由一个空格分开的两个部分：\n\n- 一个非负整数n（1≤ n≤ 10），表示我们所要考虑的数字集（即在正则表达式和文本中所出现的数字）是0, 1, …, n–1。\n\n- 接下来是一个正则表达式，它由{‘(‘, ’)’, ’+’, ’*’}中的4个符号和{0, …, n–1}中的数字构成，表达式的长度不超过500个字符。\n\n- 第二行为一个由0到n-1之间数字构成的字符串，为需要处理的文本。该文本长度不超过10,000,000个字符。", "outputFormat": "输出文件只有一行，包括一些由空格分开的整数，按从小到大的顺序依次输出所需处理的文本中每一个可匹配的位置。", "hint": "**说明：**对于输入示例，需要处理的文本是’312331’，其中只有第5个字符所在的位置（下划线所在处）是可匹配的。这时正则表达式’12333+33'中的’33’可以与之匹配。\n\n**提示：**在本次的测试数据中，有6个测试点中的正则表达式不出现’*’，其中有3个测试点，正则表达式只由数字和’+’构成。有一个测试点的待处理文本不超过1,000,000个字符。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2004] Digit Search", "background": "The HURRICANE team recently received a task to search text, namely to match substrings in a long text composed of digits that satisfy specified conditions. The search conditions are described by regular expressions such as ‘(0+10\\*1)\\*10\\*’. The inductive definition of regular expressions is as follows:\n\n1. 0, 1, …, 9, 0\\*, 1\\*, …, 9\\* are regular expressions.\n2. If A and B are regular expressions, then (A), A+B, AB, (A)\\* are regular expressions.\n3. Only expressions constructed in the above ways are regular expressions.\n\nHere, A+B denotes the “or” relation, AB denotes “concatenation,” and (A)\\* denotes “repeat” the content of A zero or more times. For example, the regular expression (12+3)(4+5)6\\* matches strings that start with one of 124, 125, 34, 35, followed by zero or any number of 6's (for example, the string 12566). The regular expression (1+0)\\* matches all strings composed of 0 and 1, or the empty string. If a regular expression cannot match the empty string, it is called nonempty. In this problem, we only consider nonempty regular expressions.\n\nIf, at some position in the given text, there exists a substring ending at that position that can be matched by the given nonempty regular expression, then that position is called matchable. The task given to the HURRICANE team is to find all matchable positions. Can you help them complete this task?", "description": "Your program needs to produce output according to the given input:\n\n- The input consists of a regular expression defined as above and a long piece of text.\n- Based on the input regular expression and text, you need to find all matchable positions in the text.\n- Your output should include all matchable positions.", "inputFormat": "The input file regular.in contains a regular expression on the first line and the text to be processed on the second line:\n\n- The first line contains two parts separated by a space:\n  - A nonnegative integer n ($1 \\le n \\le 10$), indicating that the set of digits we consider (i.e., digits appearing in the regular expression and the text) is $0, 1, \\ldots, n-1$.\n  - Next is a regular expression, composed of the 4 symbols from {‘(‘, ’)’, ’+’, ’*’} and the digits from $\\{0, \\ldots, n-1\\}$, with length not exceeding 500 characters.\n- The second line is a string composed of digits from 0 to $n-1$, which is the text to be processed. The length of this text does not exceed 10,000,000 characters.", "outputFormat": "The output file contains only one line, consisting of integers separated by spaces, output in ascending order, representing every matchable position in the text to be processed.", "hint": "Explanation: For the sample input, the text to be processed is ’312331’, and only the 5th character position (the underlined one) is matchable. Here, ’33’ in the regular expression ’12333+33’ can match it.\n\nHint: In the testdata for this problem, in 6 test points the regular expression does not contain ’*’. Among these, in 3 test points, the regular expression consists only of digits and ’+’. In one test point, the text to be processed does not exceed 1,000,000 characters.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2004] 数字搜索", "background": "HURRICANE小组最近接到了一个搜索文本的任务，即从一个由数字构成的长文本中，匹配满足指定条件的子串。搜索的条件采用形如‘(0+10\\*1)\\*10\\*’这样的正则表达式来描述。其中正则表达式的归纳定义如下：\n\n1. 0, 1, …, 9，0\\*, 1\\*, …, 9\\*是正则表达式；\n\n2. 如果A和B是正则表达式，则(A)，A+B，AB，(A)\\*都是正则表达式；\n\n3. 只有按以上方法构造出来的表达式才是正则表达式。\n\n其中，A+B表示“或者”关系，AB表示“连接”关系，(A)\\*表示A的内容“重复”零次或者多次。比如正则表达式(12+3)(4+5)6\\*，就可以匹配以124，125，34，35之一开头，之后接零0个或任意多个6的字符串（例如字符串12566）。正则表达式(1+0)\\*可以匹配所有由0和1构成的字符串，或者是空串。如果一个正则表达式不能匹配空串，则称它是非空的。**本题考虑的都是非空正则表达式**。\n\n如果在给定文本的某一个位置，存在一个以该位置结束的子串，能够被给定的非空正则表达式匹配，则称该位置是可匹配的。现在HURRICANE小组接到的任务就是找出所有可匹配的位置。你能帮助他们完成这个任务么？", "description": "你的程序需要根据给定的输入，给出符合题意的输出：\n\n- 输入包括一个满足如上定义的正则表达式，以及一长串文本；\n\n- 你需要根据输入的正则表达式及文本，找出文本中所有可匹配的位置；\n\n- 你给出的输出需要包括所有可匹配的位置。", "inputFormat": "输入文件regular.in的第一行描述一个正则表达式，第二行为需要处理的文本：\n\n- 第一行的正则表达式包括由一个空格分开的两个部分：\n\n- 一个非负整数n（1≤ n≤ 10），表示我们所要考虑的数字集（即在正则表达式和文本中所出现的数字）是0, 1, …, n–1。\n\n- 接下来是一个正则表达式，它由{‘(‘, ’)’, ’+’, ’*’}中的4个符号和{0, …, n–1}中的数字构成，表达式的长度不超过500个字符。\n\n- 第二行为一个由0到n-1之间数字构成的字符串，为需要处理的文本。该文本长度不超过10,000,000个字符。", "outputFormat": "输出文件只有一行，包括一些由空格分开的整数，按从小到大的顺序依次输出所需处理的文本中每一个可匹配的位置。", "hint": "**说明：**对于输入示例，需要处理的文本是’312331’，其中只有第5个字符所在的位置（下划线所在处）是可匹配的。这时正则表达式’12333+33'中的’33’可以与之匹配。\n\n**提示：**在本次的测试数据中，有6个测试点中的正则表达式不出现’*’，其中有3个测试点，正则表达式只由数字和’+’构成。有一个测试点的待处理文本不超过1,000,000个字符。", "locale": "zh-CN"}}}
{"pid": "P4536", "type": "P", "difficulty": 4, "samples": [["T312", "T314\nT34\nT4"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["字符串", "2007", "重庆", "各省省选", "递归", "深度优先搜索 DFS"], "title": "[CQOI2007] 三角形", "background": "", "description": "画一个等边三角形，把三边的中点连接起来，得到四个三角形，把它们称为 $T_1,T_2,T_3,T_4$，如图1。\n\n把前三个三角形也这样划分，得到 $12$ 个更小的三角形，$T_{11},T_{12},T_{13},T_{14},T_{21},T_{22},T_{23},T_{24},T_{31},T_{32},T_{33},T_{34}$，如图2。\n\n把编号以 $1,2,3$ 结尾的三角形又继续划分……最后得到的分形称为 Sierpinski 三角形。\n\n![](https://cdn.luogu.com.cn/upload/pic/18501.png)\n\n如果三角形 $B$ 不包含三角形 $A$，且 $A$ 的某一条完整的边是 $B$ 的某条边的一部分，则我们说 $A$ 靠在 $B$ 的边上。例如 $T_{12}$ 靠在 $T_{14}$ 和 $T_4$ 上，但不靠在 $T_{32}$ 上。\n\n给出 Spierpinski 三角形中的一个三角形，找出它靠着的所有三角形。", "inputFormat": "输入仅一行，即三角形的编号，以 `T` 开头，后面有 $n$ 个 $1$ 到 $4$ 的数字。仅最后一个数字可能为 $4$。", "outputFormat": "输出每行一个三角形编号，按字典序从小到大排列。\n", "hint": "对于 $100 \\%$ 的数据，$1 \\le n \\le 50$。", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2007] Triangle", "background": "", "description": "Draw an equilateral triangle and connect the midpoints of its three sides to obtain four triangles, denoted $T_1, T_2, T_3, T_4$, as shown in Figure 1.\n\nApply the same subdivision to the first three triangles to obtain $12$ smaller triangles: $T_{11}, T_{12}, T_{13}, T_{14}, T_{21}, T_{22}, T_{23}, T_{24}, T_{31}, T_{32}, T_{33}, T_{34}$, as shown in Figure 2.\n\nContinue subdividing the triangles whose indices end with $1, 2, 3$... The resulting fractal is called the Sierpinski triangle.\n\n![](https://cdn.luogu.com.cn/upload/pic/18501.png)\n\nIf triangle $B$ does not contain triangle $A$, and one entire edge of $A$ is a part of an edge of $B$, then we say $A$ “rests on” an edge of $B$. For example, $T_{12}$ rests on $T_{14}$ and $T_4$, but does not rest on $T_{32}$.\n\nGiven a triangle in the Sierpinski triangle, find all the triangles it “rests on”.", "inputFormat": "The input contains a single line: the index of a triangle. It starts with `T` followed by $n$ digits from $1$ to $4$. Only the last digit may be $4$.", "outputFormat": "Output one triangle index per line, sorted in lexicographical ascending order.", "hint": "Constraints: For $100\\%$ of the testdata, $1 \\le n \\le 50$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2007] 三角形", "background": "", "description": "画一个等边三角形，把三边的中点连接起来，得到四个三角形，把它们称为 $T_1,T_2,T_3,T_4$，如图1。\n\n把前三个三角形也这样划分，得到 $12$ 个更小的三角形，$T_{11},T_{12},T_{13},T_{14},T_{21},T_{22},T_{23},T_{24},T_{31},T_{32},T_{33},T_{34}$，如图2。\n\n把编号以 $1,2,3$ 结尾的三角形又继续划分……最后得到的分形称为 Sierpinski 三角形。\n\n![](https://cdn.luogu.com.cn/upload/pic/18501.png)\n\n如果三角形 $B$ 不包含三角形 $A$，且 $A$ 的某一条完整的边是 $B$ 的某条边的一部分，则我们说 $A$ 靠在 $B$ 的边上。例如 $T_{12}$ 靠在 $T_{14}$ 和 $T_4$ 上，但不靠在 $T_{32}$ 上。\n\n给出 Spierpinski 三角形中的一个三角形，找出它靠着的所有三角形。", "inputFormat": "输入仅一行，即三角形的编号，以 `T` 开头，后面有 $n$ 个 $1$ 到 $4$ 的数字。仅最后一个数字可能为 $4$。", "outputFormat": "输出每行一个三角形编号，按字典序从小到大排列。\n", "hint": "对于 $100 \\%$ 的数据，$1 \\le n \\le 50$。", "locale": "zh-CN"}}}
{"pid": "P4537", "type": "P", "difficulty": 4, "samples": [["3 2", "15"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["模拟", "搜索", "2007", "重庆", "各省省选"], "title": "[CQOI2007] 矩形", "background": null, "description": "给一个 $a\\times b$ 矩形，由 $a\\times b$ 个单位正方形组成。你需要沿着网格线把它分成非空的两部分，每部分所有格子连通，且至少有一个格子在原矩形的边界上。“连通”是指任两个格子都可以通过水平或者竖直路径连在一起。 求方案总数。例如 $3\\times 2$ 的矩形有 $15$ 种方案。\n\n![](https://cdn.luogu.com.cn/upload/pic/18502.png)", "inputFormat": "输入仅一行，为两个整数 $a,b$（$1 \\le a \\le 6$，$2 \\le b \\le7$）。", "outputFormat": "输出仅一行，即方案总数。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2007] Rectangle", "background": "", "description": "Given an $a\\times b$ rectangle formed by $a\\times b$ unit squares. You need to split it along the grid lines into two non-empty parts such that in each part all cells are connected, and at least one cell lies on the boundary of the original rectangle. “Connected” means any two cells can be connected by a path that moves only horizontally or vertically. Find the total number of such ways. For example, a $3\\times 2$ rectangle has $15$ ways.\n\n![](https://cdn.luogu.com.cn/upload/pic/18502.png)", "inputFormat": "The input contains a single line with two integers $a,b$ ($1 \\le a \\le 6$, $2 \\le b \\le 7$).", "outputFormat": "Output a single line with the total number of ways.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2007] 矩形", "background": null, "description": "给一个 $a\\times b$ 矩形，由 $a\\times b$ 个单位正方形组成。你需要沿着网格线把它分成非空的两部分，每部分所有格子连通，且至少有一个格子在原矩形的边界上。“连通”是指任两个格子都可以通过水平或者竖直路径连在一起。 求方案总数。例如 $3\\times 2$ 的矩形有 $15$ 种方案。\n\n![](https://cdn.luogu.com.cn/upload/pic/18502.png)", "inputFormat": "输入仅一行，为两个整数 $a,b$（$1 \\le a \\le 6$，$2 \\le b \\le7$）。", "outputFormat": "输出仅一行，即方案总数。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P4538", "type": "P", "difficulty": 0, "samples": [["3 4\n1 2\n1 3\n2 2\n2 1", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2006", "各省省选", "安徽"], "title": "[AHOI2006] 棋盘上的问题", "background": null, "description": "可可和卡卡画了一张巨大的 $N\\times N$ 的棋盘，他们想在这个棋盘上放尽量多的国际象棋的“車”，使得它们互相不能攻击到对方（車可以沿着棋盘的横向和纵向攻击）。\n\n但这个答案显然就是棋盘的宽度 $N$，于是可可在棋盘上规定了只有在有限的 $M$ 个位置上才能放棋子。（其他位置不能放棋子，而車却可以穿过这个位置去攻击其他的棋子）然而这样也不会难倒两个聪明的小家伙，他们很快算出来这个答案是 $K$。\n\n于是卡卡又提出来一个问题：如果我们在这 $M$ 个可以放棋子的位置中再去掉一个位置，而仍然保证最多能放下 $K$ 个車，可行的方案又有多少种呢？ \n\n[任务] 编写一个程序： \n\n从输入文件中读入棋盘的大小和棋盘上可以放棋子的位置信息； \n\n计算出如题卡卡所说的可行方案的数目； \n\n输出你得到的答案。", "inputFormat": "第一行有两个正整数 $N$ 和 $M$，分别表示棋盘的大小和可以放棋子的位置数目。 \n\n以下 $M$ 行，每行用 $x_i$ 和 $y_i$ 两个整数描述一个位置，表示这个位置是棋盘的第 $x_i$ 行第 $y_i$ 列。\n\n同样的一个位置不会被描述两次。", "outputFormat": "输出文件中只有一个整数，表示可行方案的数目。", "hint": "对于所有数据保证：$1\\le i \\le M\\le 6\\times 10^5,1\\le x_i,y_i\\le N\\le 2\\times 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2006] Problem on the Chessboard", "background": "", "description": "Keke and Kaka drew a huge $N*N$ chessboard. They want to place as many international chess rooks as possible on this board so that none of them can attack each other (a rook can attack along rows and columns).\n\nBut the answer is obviously the board width $N$, so Keke restricts that pieces can only be placed on a finite set of $M$ positions on the board. (Other positions cannot hold pieces, but rooks can still pass through them to attack other pieces.) However, this does not stump the two smart kids; they quickly figure out that the answer is $K$.\n\nThen Kaka raises another question: If we remove one position from these $M$ allowed positions while still ensuring that at most $K$ rooks can be placed (i.e., the maximum remains $K$), how many feasible choices are there?\n\n[Task] Write a program to:\n\n- Read from the input file the size of the board and the positions on the board where pieces can be placed.\n- Compute the number of feasible choices as Kaka described.\n- Output your answer.", "inputFormat": "The first line contains two positive integers $N$ and $M$, representing the size of the board and the number of positions where pieces can be placed.\n\nThe following $M$ lines each describe one position with two integers $x_i$ and $y_i$, indicating that this position is at row $x_i$, column $y_i$ of the board.\n\nThe same position will not be described twice.", "outputFormat": "The output contains a single integer, representing the number of feasible choices.", "hint": "For all testdata, it is guaranteed that: $1\\le i \\le M\\le 6\\times 10^5,1\\le x_i,y_i\\le N\\le 2\\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2006] 棋盘上的问题", "background": null, "description": "可可和卡卡画了一张巨大的 $N\\times N$ 的棋盘，他们想在这个棋盘上放尽量多的国际象棋的“車”，使得它们互相不能攻击到对方（車可以沿着棋盘的横向和纵向攻击）。\n\n但这个答案显然就是棋盘的宽度 $N$，于是可可在棋盘上规定了只有在有限的 $M$ 个位置上才能放棋子。（其他位置不能放棋子，而車却可以穿过这个位置去攻击其他的棋子）然而这样也不会难倒两个聪明的小家伙，他们很快算出来这个答案是 $K$。\n\n于是卡卡又提出来一个问题：如果我们在这 $M$ 个可以放棋子的位置中再去掉一个位置，而仍然保证最多能放下 $K$ 个車，可行的方案又有多少种呢？ \n\n[任务] 编写一个程序： \n\n从输入文件中读入棋盘的大小和棋盘上可以放棋子的位置信息； \n\n计算出如题卡卡所说的可行方案的数目； \n\n输出你得到的答案。", "inputFormat": "第一行有两个正整数 $N$ 和 $M$，分别表示棋盘的大小和可以放棋子的位置数目。 \n\n以下 $M$ 行，每行用 $x_i$ 和 $y_i$ 两个整数描述一个位置，表示这个位置是棋盘的第 $x_i$ 行第 $y_i$ 列。\n\n同样的一个位置不会被描述两次。", "outputFormat": "输出文件中只有一个整数，表示可行方案的数目。", "hint": "对于所有数据保证：$1\\le i \\le M\\le 6\\times 10^5,1\\le x_i,y_i\\le N\\le 2\\times 10^5$。", "locale": "zh-CN"}}}
