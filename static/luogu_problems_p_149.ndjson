{"pid": "P4018", "type": "P", "difficulty": 3, "samples": [["3\n4\n9\n14", "October wins!\nOctober wins!\nOctober wins!"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "博弈论", "素数判断,质数,筛法"], "title": "Roy&October之取石子", "background": "Roy 和 October 两人在玩一个取石子的游戏。\n", "description": "游戏规则是这样的：共有 $n$ 个石子，两人每次都只能取 $p^k$ 个（ $p$ 为质数，$k$ 为自然数，且 $p^k$ 小于等于当前剩余石子数），谁取走最后一个石子，谁就赢了。\n\n现在 October 先取，问她有没有必胜策略。\n\n若她有必胜策略，输出一行 `October wins!`；否则输出一行 `Roy wins!`。\n", "inputFormat": "第一行一个正整数 $T$，表示测试点组数。\n\n第 $2$ 行$\\sim$ 第 $T+1$ 行，一行一个正整数 $n$，表示石子个数。\n", "outputFormat": "$T$ 行，每行分别为 `October wins!` 或 `Roy wins!`。\n", "hint": "对于 $30\\%$ 的数据，$1\\leq n\\leq 30$；\n\n对于 $60\\%$ 的数据，$1\\leq n\\leq 10^6$；\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 5\\times 10^7$, $1\\leq T\\leq 10^5$。\n\n（改编题）\n", "locale": "zh-CN", "translations": {"en": {"title": "Roy & October: Taking Stones", "background": "Roy and October are playing a stone-taking game.", "description": "The rules are as follows: There are $n$ stones in total. On each turn, a player may take exactly $p^k$ stones ($p$ is a prime, $k$ is a natural number, and $p^k$ is less than or equal to the current remaining number of stones). Whoever takes the last stone wins.\n\nOctober moves first. Determine whether she has a winning strategy.\n\nIf she has a winning strategy, output a line `October wins!`; otherwise, output a line `Roy wins!`.", "inputFormat": "The first line contains a positive integer $T$, the number of test cases.\n\nFrom line $2$ to line $T+1$, each line contains a positive integer $n$, the number of stones.", "outputFormat": "$T$ lines, each being either `October wins!` or `Roy wins!`.", "hint": "For $30\\%$ of the testdata, $1 \\leq n \\leq 30$.\nFor $60\\%$ of the testdata, $1 \\leq n \\leq 10^6$.\nFor $100\\%$ of the testdata, $1 \\leq n \\leq 5\\times 10^7$, $1 \\leq T \\leq 10^5$.\n\n(Adapted problem).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Roy&October之取石子", "background": "Roy 和 October 两人在玩一个取石子的游戏。\n", "description": "游戏规则是这样的：共有 $n$ 个石子，两人每次都只能取 $p^k$ 个（ $p$ 为质数，$k$ 为自然数，且 $p^k$ 小于等于当前剩余石子数），谁取走最后一个石子，谁就赢了。\n\n现在 October 先取，问她有没有必胜策略。\n\n若她有必胜策略，输出一行 `October wins!`；否则输出一行 `Roy wins!`。\n", "inputFormat": "第一行一个正整数 $T$，表示测试点组数。\n\n第 $2$ 行$\\sim$ 第 $T+1$ 行，一行一个正整数 $n$，表示石子个数。\n", "outputFormat": "$T$ 行，每行分别为 `October wins!` 或 `Roy wins!`。\n", "hint": "对于 $30\\%$ 的数据，$1\\leq n\\leq 30$；\n\n对于 $60\\%$ 的数据，$1\\leq n\\leq 10^6$；\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 5\\times 10^7$, $1\\leq T\\leq 10^5$。\n\n（改编题）\n", "locale": "zh-CN"}}}
{"pid": "P4019", "type": "P", "difficulty": 5, "samples": [["3 0 3", "6"], ["5 2 5\n2 3 4\n3 2 3", "208"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP"], "title": "多边形染色", "background": null, "description": "Flokirie 有一个美丽的凸 $n$ 边形，顶点编号为 $1$ 到 $n$，每条边连接顶点 $i$ 和 $i+1$。特别的，顶点 $n$ 与顶点 $1$ 相连\n\n他想把每个顶点都染成某一种颜色 $k(k \\le c)$，且相邻顶点颜色不能相同。\n\n他想知道所有可行方案共有多少。于是他在纸上算了算，$5$ 分钟就解决了这题。\n\n于是他觉得太 low 了，便定义了以下骚操作。\n\n1. `1 x p`：表示第 $x$ 个顶点必须染颜色 $p$。\n\n2. `2 x p`：表示第 $x$ 个顶点必须不染颜色 $p$。\n\n3. `3 x y`：表示更改第 $x$ 个顶点与第 $y$ 个顶点之间边的属性（保证 $y=x±1$，且 $x,y≠1,n$），即第 $x$ 个顶点必须与第 $y$ 个顶点颜色相同。\n\n现在，他想知道所有可行的方案共有多少种。由于结果可能过大，你只需输出它对 $987654321$ 取模的结果即可。", "inputFormat": "第一行，三个正整数 $n$，$m$，$c$，表示多边形边数、操作个数、颜色个数。\n\n之后 $m$ 行，每行三个正整数表示一个操作，具体意义见题目描述。", "outputFormat": "一行一个整数，为所有可行操作和模上 $987654321$ 的结果。", "hint": "|  测试点编号 | $n$  | $m$  | $c$  |\n|:-:|:-:|:-:|:-:|\n| $1\\sim 2$  |  $3\\le n\\le 10$  |  $0\\le m\\le 10$ |  $1\\le c\\le 5$ |\n| $3\\sim 4$  |  $3\\le n\\le 100$  | $0\\le m\\le 30$  | $1\\le c\\le 8$  |\n| $5$  |  $3\\le n\\le 2\\times 10^3$  |  $m=0$ |  $1\\le c\\le 10$  |\n| $6$  |  $3\\le n\\le 2\\times 10^3$  |  $0\\le m\\le 100$ |  $1\\le c\\le 10$ |\n| $7$  |  $3\\le n\\le 5\\times 10^4$  | $m=0$  | $1\\le c\\le 10$  |\n| $8$  |  $3\\le n\\le 5\\times 10^4$  | $0\\le m\\le500$  | $1\\le c\\le 10$  |\n| $9\\sim 10$  |  $3\\le n\\le 5\\times 10^4$  | $0\\le m\\le10^3$  | $1\\le c\\le 10$ |\n\n保证对于 $100\\%$ 的数据，$3\\le n\\le 5\\times 10^4,0\\le m\\le10^3, 1\\le c\\le10$。", "locale": "zh-CN", "translations": {"en": {"title": "Polygon Coloring", "background": "", "description": "Flokirie has a beautiful convex $n$-gon with vertices numbered from $1$ to $n$. Each edge connects vertex $i$ and $i+1$, and in particular, vertex $n$ is connected to vertex $1$.\n\nHe wants to color each vertex with some color $k$ ($k \\le c$), i.e., each vertex is assigned a color from $1$ to $c$, and adjacent vertices must not have the same color.\n\nHe wants to know how many feasible colorings there are. He calculated it on paper and solved it in $5$ minutes.\n\nHe thought that was too trivial, so he defined the following “fancy” operations:\n\n1. `1 x p`: vertex $x$ must be colored with color $p$.\n2. `2 x p`: vertex $x$ must not be colored with color $p$.\n3. `3 x y`: change the attribute of the edge between vertex $x$ and vertex $y$ (guaranteed that $y = x \\pm 1$ and $x, y \\ne 1, n$), i.e., vertex $x$ must have the same color as vertex $y$.\n\nNow, he wants to know the total number of feasible colorings after applying all operations. Since the result may be large, output it modulo $987654321$.", "inputFormat": "The first line contains three positive integers $n$, $m$, $c$, representing the number of sides of the polygon, the number of operations, and the number of colors.\n\nEach of the following $m$ lines contains three positive integers describing one operation, as defined above.", "outputFormat": "Output a single integer: the number of feasible colorings modulo $987654321$.", "hint": "| Test Point ID | $n$ | $m$ | $c$ |\n|:-:|:-:|:-:|:-:|\n| $1 \\sim 2$ | $3 \\le n \\le 10$ | $0 \\le m \\le 10$ | $1 \\le c \\le 5$ |\n| $3 \\sim 4$ | $3 \\le n \\le 100$ | $0 \\le m \\le 30$ | $1 \\le c \\le 8$ |\n| $5$ | $3 \\le n \\le 2 \\times 10^3$ | $m = 0$ | $1 \\le c \\le 10$ |\n| $6$ | $3 \\le n \\le 2 \\times 10^3$ | $0 \\le m \\le 100$ | $1 \\le c \\le 10$ |\n| $7$ | $3 \\le n \\le 5 \\times 10^4$ | $m = 0$ | $1 \\le c \\le 10$ |\n| $8$ | $3 \\le n \\le 5 \\times 10^4$ | $0 \\le m \\le 500$ | $1 \\le c \\le 10$ |\n| $9 \\sim 10$ | $3 \\le n \\le 5 \\times 10^4$ | $0 \\le m \\le 10^3$ | $1 \\le c \\le 10$ |\n\nIt is guaranteed that for $100\\%$ of the testdata, $3 \\le n \\le 5 \\times 10^4$, $0 \\le m \\le 10^3$, $1 \\le c \\le 10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "多边形染色", "background": null, "description": "Flokirie 有一个美丽的凸 $n$ 边形，顶点编号为 $1$ 到 $n$，每条边连接顶点 $i$ 和 $i+1$。特别的，顶点 $n$ 与顶点 $1$ 相连\n\n他想把每个顶点都染成某一种颜色 $k(k \\le c)$，且相邻顶点颜色不能相同。\n\n他想知道所有可行方案共有多少。于是他在纸上算了算，$5$ 分钟就解决了这题。\n\n于是他觉得太 low 了，便定义了以下骚操作。\n\n1. `1 x p`：表示第 $x$ 个顶点必须染颜色 $p$。\n\n2. `2 x p`：表示第 $x$ 个顶点必须不染颜色 $p$。\n\n3. `3 x y`：表示更改第 $x$ 个顶点与第 $y$ 个顶点之间边的属性（保证 $y=x±1$，且 $x,y≠1,n$），即第 $x$ 个顶点必须与第 $y$ 个顶点颜色相同。\n\n现在，他想知道所有可行的方案共有多少种。由于结果可能过大，你只需输出它对 $987654321$ 取模的结果即可。", "inputFormat": "第一行，三个正整数 $n$，$m$，$c$，表示多边形边数、操作个数、颜色个数。\n\n之后 $m$ 行，每行三个正整数表示一个操作，具体意义见题目描述。", "outputFormat": "一行一个整数，为所有可行操作和模上 $987654321$ 的结果。", "hint": "|  测试点编号 | $n$  | $m$  | $c$  |\n|:-:|:-:|:-:|:-:|\n| $1\\sim 2$  |  $3\\le n\\le 10$  |  $0\\le m\\le 10$ |  $1\\le c\\le 5$ |\n| $3\\sim 4$  |  $3\\le n\\le 100$  | $0\\le m\\le 30$  | $1\\le c\\le 8$  |\n| $5$  |  $3\\le n\\le 2\\times 10^3$  |  $m=0$ |  $1\\le c\\le 10$  |\n| $6$  |  $3\\le n\\le 2\\times 10^3$  |  $0\\le m\\le 100$ |  $1\\le c\\le 10$ |\n| $7$  |  $3\\le n\\le 5\\times 10^4$  | $m=0$  | $1\\le c\\le 10$  |\n| $8$  |  $3\\le n\\le 5\\times 10^4$  | $0\\le m\\le500$  | $1\\le c\\le 10$  |\n| $9\\sim 10$  |  $3\\le n\\le 5\\times 10^4$  | $0\\le m\\le10^3$  | $1\\le c\\le 10$ |\n\n保证对于 $100\\%$ 的数据，$3\\le n\\le 5\\times 10^4,0\\le m\\le10^3, 1\\le c\\le10$。", "locale": "zh-CN"}}}
{"pid": "P4020", "type": "P", "difficulty": 6, "samples": [["4 3\n1 2\n2 3\n2 4\nQ 2\nC 2 4 5\nQ 2", "0.0000000000\n-1.6666666666"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["递推", "2012", "Special Judge", "高斯消元", "CTSC/CTS"], "title": "[CTSC2012] 电阻网络", "background": null, "description": "给定一个树型电网，树中的每条边上有一个电阻 $R_i$，电阻值均为 $10000\\ Ω$。下图为一个包含 $4$ 个节点的树型电路情况：\n\n![图1](https://i.loli.net/2018/10/03/5bb46c0c587be.png)\n\n树中的所有叶子节点（度为 $1$ 的节点称为叶子）都接地，每条线上都接地，每条线上都附有 $10000\\ Ω$ 的电阻，最终形成的电网如下图所示：\n\n![图2](https://i.loli.net/2018/10/03/5bb46c0c72576.png)\n\n现有如下两种操作：\n\n`C u v w`：表示在边 $(u,v)$ 上串联一个电源，电源的大小为 $w$ 伏，电源位于靠近节点 $u$ 一侧（如下图所示），电源负极指向 $u$。注意同一条边上可以串联多个电源。\n\n![图3](https://i.loli.net/2018/10/03/5bb46c0c6a122.png)\n\n`Q u` ：表示询问点 $u$ 当前的电压，此是指对地。\n\n如对上图进行 `C 2 4 5` 操作后，网络变为：\n\n![图4](https://i.loli.net/2018/10/03/5bb46c0c86064.png)\n\n此时每个节点上的电压见上图的标注。", "inputFormat": "输入文件 circuit.in 的第一行包含两个整数 $N,M$，分别表示树的节点数和操作个数。接下来 $N-1$ 行，每行两个数 $u,v$，表示有一条连接节点 $u,v$ 的边，这条边上恰好包含一个电阻。\n\n接下来 $M$ 行，每行一个命令，格式见题目描述。", "outputFormat": "输出文件为 circuit.out。对于每个 `Q` 命令，输出一个数表示此刻该点的电压值。你可以输出任意多位的小数，只要你的答案和标准答案相差不超过 $10^{-3}$ 就算合法。", "hint": "【样例说明】\n\n对于第一个询问，由于原图中没有电源，所以没有电流，所有点的电压都相\n\n等（否则如果有 $U_i>U_j$，则就有 $i$ 流向 $j$ 的电流，与没有电源矛盾），都等于地电压 $0\\text{V}$。\n\n之后在 $(2,4)$ 中加一个 $5\\text{V}$ 的电源，得到的新图见题目描述。\n\n整理后可以发现，新图的形式是串联（电源，$R_2+10000$，并联（$R_1+10000$，$R_3+10000$）），由此可以得到新图的总电阻为:\n\n$$\nR 2 +10000+\\frac{1}{\\frac{1}{R_3 +10000}+\\frac{1}{R_1 +10000}}=30000\\ Ω\n$$\n\n所以流过节点 $4$ 的电流就是 $\\frac{5}{30000}\\ A$，所以 $U_4=\\frac{5}{3}V$，$U_2=U_4+R_2\\cdot I-5=-\\frac{5}{3}V$，由\n\n于 $U_1$ 和 $U_3$ 形式对称，由分压关系可知 $U_1 =U_3 =U_2\\times\\frac{10000}{10000+10000}=-\\frac{5}{6}V$。\n\n【数据规模】\n\n$30\\%$ 的数据保证 $N,M ≤ 30$。\n\n$60\\%$ 的数据保证 $N,M ≤ 3000$。\n\n$100\\%$ 的数据保证 $3 ≤ N,M ≤ 50000$，$1 ≤ u,v ≤ n$，$1 ≤ w ≤ 10$，树中最长链的长度不超过 $50$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2012] Resistor Network", "background": "", "description": "Given a tree-shaped circuit, each edge in the tree has a resistor $R_i$, and all resistances are $10000\\ Ω$. The figure below shows a tree-shaped circuit with $4$ nodes:\n\n![Figure 1](https://i.loli.net/2018/10/03/5bb46c0c587be.png)\n\nAll leaf nodes in the tree (nodes of degree $1$ are called leaves) are connected to ground, each line is connected to ground, and each line carries a $10000\\ Ω$ resistor, forming the network shown below:\n\n![Figure 2](https://i.loli.net/2018/10/03/5bb46c0c72576.png)\n\nThere are two types of operations:\n\n`C u v w`: Insert a voltage source in series on edge $(u, v)$, with magnitude $w$ volts. The source is placed on the side closer to node $u$ (as shown below), with its negative terminal pointing toward $u$. Note that multiple voltage sources can be inserted in series on the same edge.\n\n![Figure 3](https://i.loli.net/2018/10/03/5bb46c0c6a122.png)\n\n`Q u`: Query the current voltage of node $u$, measured with respect to ground.\n\nAfter performing `C 2 4 5` on the figure above, the network becomes:\n\n![Figure 4](https://i.loli.net/2018/10/03/5bb46c0c86064.png)\n\nAt this time, the voltage at each node is as labeled in the figure.", "inputFormat": "The input file circuit.in contains two integers $N, M$ on the first line, representing the number of nodes in the tree and the number of operations, respectively. The next $N-1$ lines each contain two integers $u, v$, indicating that there is an edge connecting nodes $u$ and $v$, and this edge contains exactly one resistor.\n\nThen there are $M$ lines, each containing one command in the format described above.", "outputFormat": "Output to circuit.out. For each `Q` command, output a single number representing the voltage at that node at that moment. You may print any number of decimal places; your answer is considered correct if it differs from the standard answer by at most $10^{-3}$.", "hint": "[Sample Explanation]\n\nFor the first query, since there is no voltage source in the original circuit, there is no current, and all node voltages are equal (otherwise, if there exists $U_i > U_j$, there would be current flowing from $i$ to $j$, contradicting the absence of a source). They are all equal to the ground potential $0\\text{V}$.\n\nAfter adding a $5\\text{V}$ voltage source on $(2, 4)$, the new circuit is as shown in the problem statement.\n\nAfter simplification, the new circuit can be seen as series (source, $R_2+10000$, parallel ($R_1+10000$, $R_3+10000$)), hence the equivalent resistance is:\n\n$$\nR 2 +10000+\\frac{1}{\\frac{1}{R_3 +10000}+\\frac{1}{R_1 +10000}}=30000\\ Ω\n$$\n\nTherefore, the current flowing through node $4$ is $\\frac{5}{30000}\\ A$, so $U_4=\\frac{5}{3}V$ and $U_2=U_4+R_2\\cdot I-5=-\\frac{5}{3}V$; since $U_1$ and $U_3$ are symmetric, by the voltage division relation we have $U_1 =U_3 =U_2\\times\\frac{10000}{10000+10000}=-\\frac{5}{6}V$.\n\n[Constraints]\n\n$30\\%$ of the testdata guarantees $N, M ≤ 30$.\n\n$60\\%$ of the testdata guarantees $N, M ≤ 3000$.\n\n$100\\%$ of the testdata guarantees $3 ≤ N, M ≤ 50000$, $1 ≤ u, v ≤ n$, $1 ≤ w ≤ 10$, and the length of the longest chain in the tree does not exceed $50$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2012] 电阻网络", "background": null, "description": "给定一个树型电网，树中的每条边上有一个电阻 $R_i$，电阻值均为 $10000\\ Ω$。下图为一个包含 $4$ 个节点的树型电路情况：\n\n![图1](https://i.loli.net/2018/10/03/5bb46c0c587be.png)\n\n树中的所有叶子节点（度为 $1$ 的节点称为叶子）都接地，每条线上都接地，每条线上都附有 $10000\\ Ω$ 的电阻，最终形成的电网如下图所示：\n\n![图2](https://i.loli.net/2018/10/03/5bb46c0c72576.png)\n\n现有如下两种操作：\n\n`C u v w`：表示在边 $(u,v)$ 上串联一个电源，电源的大小为 $w$ 伏，电源位于靠近节点 $u$ 一侧（如下图所示），电源负极指向 $u$。注意同一条边上可以串联多个电源。\n\n![图3](https://i.loli.net/2018/10/03/5bb46c0c6a122.png)\n\n`Q u` ：表示询问点 $u$ 当前的电压，此是指对地。\n\n如对上图进行 `C 2 4 5` 操作后，网络变为：\n\n![图4](https://i.loli.net/2018/10/03/5bb46c0c86064.png)\n\n此时每个节点上的电压见上图的标注。", "inputFormat": "输入文件 circuit.in 的第一行包含两个整数 $N,M$，分别表示树的节点数和操作个数。接下来 $N-1$ 行，每行两个数 $u,v$，表示有一条连接节点 $u,v$ 的边，这条边上恰好包含一个电阻。\n\n接下来 $M$ 行，每行一个命令，格式见题目描述。", "outputFormat": "输出文件为 circuit.out。对于每个 `Q` 命令，输出一个数表示此刻该点的电压值。你可以输出任意多位的小数，只要你的答案和标准答案相差不超过 $10^{-3}$ 就算合法。", "hint": "【样例说明】\n\n对于第一个询问，由于原图中没有电源，所以没有电流，所有点的电压都相\n\n等（否则如果有 $U_i>U_j$，则就有 $i$ 流向 $j$ 的电流，与没有电源矛盾），都等于地电压 $0\\text{V}$。\n\n之后在 $(2,4)$ 中加一个 $5\\text{V}$ 的电源，得到的新图见题目描述。\n\n整理后可以发现，新图的形式是串联（电源，$R_2+10000$，并联（$R_1+10000$，$R_3+10000$）），由此可以得到新图的总电阻为:\n\n$$\nR 2 +10000+\\frac{1}{\\frac{1}{R_3 +10000}+\\frac{1}{R_1 +10000}}=30000\\ Ω\n$$\n\n所以流过节点 $4$ 的电流就是 $\\frac{5}{30000}\\ A$，所以 $U_4=\\frac{5}{3}V$，$U_2=U_4+R_2\\cdot I-5=-\\frac{5}{3}V$，由\n\n于 $U_1$ 和 $U_3$ 形式对称，由分压关系可知 $U_1 =U_3 =U_2\\times\\frac{10000}{10000+10000}=-\\frac{5}{6}V$。\n\n【数据规模】\n\n$30\\%$ 的数据保证 $N,M ≤ 30$。\n\n$60\\%$ 的数据保证 $N,M ≤ 3000$。\n\n$100\\%$ 的数据保证 $3 ≤ N,M ≤ 50000$，$1 ≤ u,v ≤ n$，$1 ≤ w ≤ 10$，树中最长链的长度不超过 $50$。", "locale": "zh-CN"}}}
{"pid": "P4021", "type": "P", "difficulty": 7, "samples": [["3 3 1\n1 2 1\n2 3 1\n1 3 1", "1\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "提交答案", "Special Judge", "CTSC/CTS"], "title": "[CTSC2012] 最短路", "background": null, "description": "给定一个节点 $1$ 和节点 $N$ 连通的正权无向图，请你删除不超过 $K$ 条边，使得节点 $1$ 和节点 $N$ 仍然连通的同时，这两点之间的最短路尽可能长 。", "inputFormat": "**本题为提交答案试题，[输入文件](https://pan.baidu.com/s/1o7K2dCm)（`shortest1.in`~`shortest10.in`）请在链接中下载**。\n\n输入文件 `shortest*.in` 的第一行包含三个正整数 $N,M,K$。其中 $N$ 表示节点数，$M$ 表示边数，节点的编号由 $1$ 至 $N$，边的编号由 $1$ 至 $M$。接下来 $M$ 行，\n\n每行三个正整数 $u,v,w$，表示有一条连接节点 $u$ 和节点 $v$ 的边，权值为 $w$。", "outputFormat": "输出文件 `shortest*.out` 的第一行包含一个非负整数 $T$，表示需要删掉的边数。\n\n接下来 $T$ 行，每行一个 $1$ 到 $M$ 之间的整数 $x$，表示删掉输入中的第 $x$ 条边。你需要保证这 $T$ 个整数互不相同。", "hint": "### 样例说明\n\n样例中从节点 $1$ 到 $3$ 的最短路径长度为 $1$，删去第三条边之后，最短路径长度为 $2$。\n\n### 评分标准\n\n对于每个测试点，设有评分四个参数 $s_1,s_2,s_3,s_4$。假设你的方案的最短路为 $\\textit{ans}$。\n\n如果你没有输出，或者输出不合法，或者最短路不存在，得 $0$ 分。\n\n如果最短路存在，得 $1$ 分。\n\n如果 $\\textit{ans}\\geq s_1$，得 $3$ 分。\n\n如果 $\\textit{ans}\\geq s_2$，得 $5$ 分。\n\n如果 $\\textit{ans}\\geq s_3$，得 $8$ 分。\n\n如果 $\\textit{ans}=s_4$，得 $10$ 分。\n\n如果 $\\textit{ans}>s_4$，得 $12$ 分。\n\n取满足条件的分数中的最高得分为该测试点你的得分。\n\n### 如何测试你的输出\n\n首先先编译 `checker.cpp`。\n\n在你的目录下有一个名为 `checker` 的程序可以用来检查你的输出，你可以在终端中使用以下命令来检查你的输出：\n\n```\n./checker N\n```\n\n其中 $N$ 为测试点的编号；例如，要测试第 $3$ 个测试点可以使用\n\n```\n./checker 3\n```\n\n该程序会检测你的输出方案是否合法。如果方案合法，程序还会给出该方案的最短路的长度值。\n\n### 特别提示\n\n请妥善保存输入文件和你的输出文件，及时备份，以免误删。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2012] Shortest Path", "background": "", "description": "Given an undirected graph with positive edge weights in which node $1$ and node $N$ are connected, delete at most $K$ edges so that nodes $1$ and $N$ remain connected, while making the shortest path between them as long as possible.", "inputFormat": "This is an output-only problem. Please download the input files from the link: [input files](https://pan.baidu.com/s/1o7K2dCm) (`shortest1.in` ~ `shortest10.in`).\n\nThe first line of the input file `shortest*.in` contains three positive integers $N, M, K$. Here $N$ is the number of nodes, $M$ is the number of edges. Nodes are numbered from $1$ to $N$, and edges are numbered from $1$ to $M$ in input order.  \nThen follow $M$ lines.  \nEach line contains three positive integers $u, v, w$, indicating an edge between nodes $u$ and $v$ with weight $w$.", "outputFormat": "The first line of the output file `shortest*.out` contains a non-negative integer $T$, the number of edges to delete.  \nThen output $T$ lines, each containing an integer $x$ between $1$ and $M$, indicating that the $x$-th edge in the input is deleted. These $T$ integers must be pairwise distinct.", "hint": "### Sample Explanation\n\nIn the sample, the shortest path length from node $1$ to $3$ is $1$. After deleting the third edge, the shortest path length becomes $2$.\n\n### Scoring\n\nFor each test point, there are four scoring parameters $s_1, s_2, s_3, s_4$. Let your solution’s shortest path be $\\textit{ans}$.\n\n- If you produce no output, or the output is invalid, or the shortest path does not exist, you get $0$ points.\n- If a shortest path exists, you get $1$ point.\n- If $\\textit{ans}\\geq s_1$, you get $3$ points.\n- If $\\textit{ans}\\geq s_2$, you get $5$ points.\n- If $\\textit{ans}\\geq s_3$, you get $8$ points.\n- If $\\textit{ans}=s_4$, you get $10$ points.\n- If $\\textit{ans}>s_4$, you get $12$ points.\n\nYour score for a test point is the maximum among the applicable cases above.\n\n### How to Test Your Output\n\nFirst, compile `checker.cpp`.\n\nThere will be a program named `checker` in your directory that can be used to verify your output. You can run the following command in the terminal:\n\n```\n./checker N\n```\n\nHere $N$ is the test point index. For example, to test the $3$-rd test point:\n\n```\n./checker 3\n```\n\nThis program checks whether your output solution is valid. If it is valid, it will also report the length of the shortest path.\n\n### Special Notes\n\nPlease keep your input files and output files properly saved and back them up in time to avoid accidental deletion.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2012] 最短路", "background": null, "description": "给定一个节点 $1$ 和节点 $N$ 连通的正权无向图，请你删除不超过 $K$ 条边，使得节点 $1$ 和节点 $N$ 仍然连通的同时，这两点之间的最短路尽可能长 。", "inputFormat": "**本题为提交答案试题，[输入文件](https://pan.baidu.com/s/1o7K2dCm)（`shortest1.in`~`shortest10.in`）请在链接中下载**。\n\n输入文件 `shortest*.in` 的第一行包含三个正整数 $N,M,K$。其中 $N$ 表示节点数，$M$ 表示边数，节点的编号由 $1$ 至 $N$，边的编号由 $1$ 至 $M$。接下来 $M$ 行，\n\n每行三个正整数 $u,v,w$，表示有一条连接节点 $u$ 和节点 $v$ 的边，权值为 $w$。", "outputFormat": "输出文件 `shortest*.out` 的第一行包含一个非负整数 $T$，表示需要删掉的边数。\n\n接下来 $T$ 行，每行一个 $1$ 到 $M$ 之间的整数 $x$，表示删掉输入中的第 $x$ 条边。你需要保证这 $T$ 个整数互不相同。", "hint": "### 样例说明\n\n样例中从节点 $1$ 到 $3$ 的最短路径长度为 $1$，删去第三条边之后，最短路径长度为 $2$。\n\n### 评分标准\n\n对于每个测试点，设有评分四个参数 $s_1,s_2,s_3,s_4$。假设你的方案的最短路为 $\\textit{ans}$。\n\n如果你没有输出，或者输出不合法，或者最短路不存在，得 $0$ 分。\n\n如果最短路存在，得 $1$ 分。\n\n如果 $\\textit{ans}\\geq s_1$，得 $3$ 分。\n\n如果 $\\textit{ans}\\geq s_2$，得 $5$ 分。\n\n如果 $\\textit{ans}\\geq s_3$，得 $8$ 分。\n\n如果 $\\textit{ans}=s_4$，得 $10$ 分。\n\n如果 $\\textit{ans}>s_4$，得 $12$ 分。\n\n取满足条件的分数中的最高得分为该测试点你的得分。\n\n### 如何测试你的输出\n\n首先先编译 `checker.cpp`。\n\n在你的目录下有一个名为 `checker` 的程序可以用来检查你的输出，你可以在终端中使用以下命令来检查你的输出：\n\n```\n./checker N\n```\n\n其中 $N$ 为测试点的编号；例如，要测试第 $3$ 个测试点可以使用\n\n```\n./checker 3\n```\n\n该程序会检测你的输出方案是否合法。如果方案合法，程序还会给出该方案的最短路的长度值。\n\n### 特别提示\n\n请妥善保存输入文件和你的输出文件，及时备份，以免误删。", "locale": "zh-CN"}}}
{"pid": "P4022", "type": "P", "difficulty": 7, "samples": [["1 2\n10110\n000001110\n1011001100", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["字符串", "2012", "后缀自动机 SAM", "CTSC/CTS"], "title": "[CTSC2012] 熟悉的文章", "background": "", "description": "阿米巴是小强的好朋友。\n\n在小强眼中，阿米巴是一个作文成绩很高的文艺青年。为了获取考试作文的真谛，小强向阿米巴求教。阿米巴给小强展示了几篇作文，小强觉得这些文章怎么看怎么觉得熟悉，仿佛是某些范文拼拼凑凑而成的。小强不禁向阿米巴投去了疑惑的眼光，却发现阿米巴露出了一个狡黠的微笑。\n\n为了有说服力地向阿米巴展示阿米巴的作文是多么让人觉得“眼熟”，小强想出了一个评定作文 “熟悉程度”的量化指标：$L_0$ .小强首先将作文转化成一个 $01$ 串。之后，小强搜集了各路名家的文章，同样分别转化成 $01$ 串后，整理出一个包含了 $M$ 个 $01$ 串的 “ 标准作文库 ”。\n\n小强认为：如果一个 $01$ 串长度不少于 $L$ 且在标准作文库中的某个串里出现过（即，它是标准作文库的某个串的一个 连续子串），那么它是 “ 熟悉 ” 的。对于一篇作文（一个 $01$ 串）$A$，如果能够把 $A$ 分割成若干段子串，其中 “ 熟悉 ” 的子串的长度总和不少于 $A$ 总长度的 $90\\%$，那么称 $A$ 是 “ 熟悉的文章 ”。 $L_0$ 是能够让 $A$ 成为 “ 熟悉的文章 ” 的 所有 $L$ 的最大值 （如果不存在这样的 $L$，那么规定 $L_0=0$）。\n\n举个例子：\n\n小强的作文库里包含了如下 $2$ 个字符串：\n\n```cpp\n10110\n000001110\n```\n有一篇待考察的作文是：\n\n```cpp\n1011001100\n```\n小强计算出这篇作文 $L$ 的最大值是 $4$，因为待考察的作文可以视作 $10110+0110+0$，其中 $10110$ 和 $0110$ 被判定为 “熟悉” 的。而当 $L = 5$ 或是更大的时候，不存在符合题意的分割方法。所以，这篇作文的 $L_0 = 4$。小强认为阿米巴作文的 $L_0$ 值比其他同学的明显要大。请你帮他验证一下。\n", "inputFormat": "输入第一行是两个整数 $N, M$，表示待检查的作文数量，和小强的标准作文库的行数。\n\n接下来是 $M$ 行的 $01$ 串，表示标准作文库。\n\n接下来是 $N$ 行的 $01$ 串，表示 $N$ 篇作文。\n", "outputFormat": "输出包含 $N$ 行，每一行包含一个整数，表示该篇作文的 $L_0$ 值。\n", "hint": "对于 $30\\%$ 的测试数据，输入文件的长度不超过 $1000$ 字节。\n\n对于 $50\\%$ 的测试数据，输入文件的长度不超过 $61000$ 字节。\n\n对于 $80\\%$ 的测试数据，输入文件的长度不超过 $250000$ 字节。\n\n对于 $100\\%$ 的测试数据，输入文件的长度不超过 $1100000$ 字节。\n", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2012] Familiar Article", "background": "", "description": "Amiba is Xiao Qiang’s good friend.\n\nIn Xiao Qiang’s eyes, Amiba is a literary youth with excellent essay scores. To grasp the essence of exam essays, Xiao Qiang asked Amiba for guidance. Amiba showed him several essays. Xiao Qiang felt they looked very familiar, as if they were pieced together from some model essays. He cast a doubtful look at Amiba, only to see a sly smile.\n\nTo convincingly show how “familiar” Amiba’s essays feel, Xiao Qiang devised a quantitative metric for the “degree of familiarity” of an essay: $L_0$. He first converts an essay into a $01$ string. Then he collects essays from various famous authors, also converts them into $01$ strings, and compiles a “standard essay library” containing $M$ $01$ strings.\n\nXiao Qiang considers the following: if a $01$ string has length at least $L$ and appears in some string in the standard essay library (i.e., it is a contiguous substring of some string in the library), then it is “familiar.” For an essay (a $01$ string) $A$, if we can split $A$ into several substrings such that the total length of the “familiar” substrings is at least $90\\%$ of the total length of $A$, then $A$ is a “familiar article.” $L_0$ is the maximum among all $L$ that make $A$ a “familiar article” (if no such $L$ exists, define $L_0 = 0$).\n\nFor example:\n\nXiao Qiang’s essay library contains the following $2$ strings:\n\n```cpp\n10110\n000001110\n```\nThere is an essay to be examined:\n\n```cpp\n1011001100\n```\nXiao Qiang computes that the maximum $L$ for this essay is $4$, because the essay can be viewed as $10110+0110+0$, where $10110$ and $0110$ are judged “familiar.” When $L = 5$ or larger, no valid split exists. Therefore, this essay’s $L_0 = 4$. Xiao Qiang believes that Amiba’s $L_0$ values are noticeably larger than other students’. Please help him verify this.", "inputFormat": "The first line contains two integers $N, M$, denoting the number of essays to check and the number of strings in Xiao Qiang’s standard essay library.\n\nThe next $M$ lines contain $01$ strings, forming the standard essay library.\n\nThe next $N$ lines contain $01$ strings, representing the $N$ essays.", "outputFormat": "Output $N$ lines. Each line contains one integer, the $L_0$ value of the corresponding essay.", "hint": "For $30\\%$ of the testdata, the input file length does not exceed $1000$ bytes.\n\nFor $50\\%$ of the testdata, the input file length does not exceed $61000$ bytes.\n\nFor $80\\%$ of the testdata, the input file length does not exceed $250000$ bytes.\n\nFor $100\\%$ of the testdata, the input file length does not exceed $1100000$ bytes.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2012] 熟悉的文章", "background": "", "description": "阿米巴是小强的好朋友。\n\n在小强眼中，阿米巴是一个作文成绩很高的文艺青年。为了获取考试作文的真谛，小强向阿米巴求教。阿米巴给小强展示了几篇作文，小强觉得这些文章怎么看怎么觉得熟悉，仿佛是某些范文拼拼凑凑而成的。小强不禁向阿米巴投去了疑惑的眼光，却发现阿米巴露出了一个狡黠的微笑。\n\n为了有说服力地向阿米巴展示阿米巴的作文是多么让人觉得“眼熟”，小强想出了一个评定作文 “熟悉程度”的量化指标：$L_0$ .小强首先将作文转化成一个 $01$ 串。之后，小强搜集了各路名家的文章，同样分别转化成 $01$ 串后，整理出一个包含了 $M$ 个 $01$ 串的 “ 标准作文库 ”。\n\n小强认为：如果一个 $01$ 串长度不少于 $L$ 且在标准作文库中的某个串里出现过（即，它是标准作文库的某个串的一个 连续子串），那么它是 “ 熟悉 ” 的。对于一篇作文（一个 $01$ 串）$A$，如果能够把 $A$ 分割成若干段子串，其中 “ 熟悉 ” 的子串的长度总和不少于 $A$ 总长度的 $90\\%$，那么称 $A$ 是 “ 熟悉的文章 ”。 $L_0$ 是能够让 $A$ 成为 “ 熟悉的文章 ” 的 所有 $L$ 的最大值 （如果不存在这样的 $L$，那么规定 $L_0=0$）。\n\n举个例子：\n\n小强的作文库里包含了如下 $2$ 个字符串：\n\n```cpp\n10110\n000001110\n```\n有一篇待考察的作文是：\n\n```cpp\n1011001100\n```\n小强计算出这篇作文 $L$ 的最大值是 $4$，因为待考察的作文可以视作 $10110+0110+0$，其中 $10110$ 和 $0110$ 被判定为 “熟悉” 的。而当 $L = 5$ 或是更大的时候，不存在符合题意的分割方法。所以，这篇作文的 $L_0 = 4$。小强认为阿米巴作文的 $L_0$ 值比其他同学的明显要大。请你帮他验证一下。\n", "inputFormat": "输入第一行是两个整数 $N, M$，表示待检查的作文数量，和小强的标准作文库的行数。\n\n接下来是 $M$ 行的 $01$ 串，表示标准作文库。\n\n接下来是 $N$ 行的 $01$ 串，表示 $N$ 篇作文。\n", "outputFormat": "输出包含 $N$ 行，每一行包含一个整数，表示该篇作文的 $L_0$ 值。\n", "hint": "对于 $30\\%$ 的测试数据，输入文件的长度不超过 $1000$ 字节。\n\n对于 $50\\%$ 的测试数据，输入文件的长度不超过 $61000$ 字节。\n\n对于 $80\\%$ 的测试数据，输入文件的长度不超过 $250000$ 字节。\n\n对于 $100\\%$ 的测试数据，输入文件的长度不超过 $1100000$ 字节。\n", "locale": "zh-CN"}}}
{"pid": "P4023", "type": "P", "difficulty": 7, "samples": [["4 5 \n6 3 7 -1 -6 -5 1 5\n-5 -5 7 -5 9 -9 -10 11 -5 -6", "3"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2012", "CTSC/CTS"], "title": "[CTSC2012] 极点统计", "background": "", "description": "对于一个由平面上点组成的集合 $S$，以及一个平面上的点，以及一个平面上的点 $p$，函数 $f(p,S)$ 当且仅当 $p$ 在 $S$ 的凸包内部（包括 $S$ 的凸包的边界）时值为 $1$，其余情况下其值为 $0$。\n\n现给定两个平面上的点集 $P=\\{p_1,p_2,\\cdots,p_N\\}$ 和 $A=\\{a_1,a_2,\\cdots,a_M\\}$，我们称 $A$ 中的一个点 $a_i$ 为极点，当且仅其满足\n\n$$\\sum_{j\\ne i} f(a_i,P\\cup\\{a_j\\})=0$$\n\n也就是说，**$a_i$ 不在任意 $A$ 集合中非 $a_i$ 的点与 $P$ 组成的凸包内部。**\n\n请统计出集合 $A$ 中极点的个数。", "inputFormat": "第一行包含两个用空格隔开正整数 $N$ 和 $M$；\n\n第二行包含 $N$ 个用空格隔开的整数对，第 $i$ 个数对  $(x_i^p,y_i^p)$ 表示点 $p_i$ 的坐标；\n\n第二行包含$M$个用空格隔开的整数对，第 $j$ 个数对  $(x_j^a,y_j^a)$ 表示点 $a_j$ 的坐标。\n\n对于同一个集合，输入数据保证不会出现坐标相同的两个点。", "outputFormat": "仅包含一行一个整数，表示集合$A$中极点的个数。\n\n## 说明", "hint": "对于 $30\\%$ 的数据满足 $N,M\\le 50$；\n\n对于另外 $30\\%$ 的数据满足 $N\\le 10,M\\le 20000$；\n\n对于 $100\\%$ 的数据满足 $3\\le N\\le 10^5,1\\le M\\le 10^5,\\ |x_i|,|y_i|≤10^6$，且点集 $P$ 的凸包面积不为 $0$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2012] Extreme Point Statistics", "background": "", "description": "For a set $S$ of points in the plane and a point $p$ in the plane, define the function $f(p, S)$ to be $1$ if and only if $p$ lies inside the convex hull of $S$ (including its boundary), and $0$ otherwise.\n\nGiven two sets of points in the plane $P=\\{p_1,p_2,\\cdots,p_N\\}$ and $A=\\{a_1,a_2,\\cdots,a_M\\}$, we call a point $a_i \\in A$ an extreme point if and only if\n$$\\sum_{j\\ne i} f(a_i,P\\cup\\{a_j\\})=0.$$\n\nThat is, $a_i$ is not inside the convex hull formed by $P$ together with any other single point from $A$.\n\nPlease count the number of extreme points in set $A$.", "inputFormat": "- The first line contains two space-separated positive integers $N$ and $M$.\n- The second line contains $N$ space-separated pairs of integers; the $i$-th pair $(x_i^p,y_i^p)$ denotes the coordinates of point $p_i$.\n- The third line contains $M$ space-separated pairs of integers; the $j$-th pair $(x_j^a,y_j^a)$ denotes the coordinates of point $a_j$.\n- For the same set, the input guarantees that no two points share identical coordinates.", "outputFormat": "Output a single line with a single integer, the number of extreme points in set $A$.", "hint": "Constraints:\n- For $30\\%$ of the testdata, $N,M\\le 50$.\n- For another $30\\%$ of the testdata, $N\\le 10, M\\le 20000$.\n- For $100\\%$ of the testdata, $3\\le N\\le 10^5, 1\\le M\\le 10^5,\\ |x_i|,|y_i|\\le 10^6$, and the convex hull of set $P$ has non-zero area.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2012] 极点统计", "background": "", "description": "对于一个由平面上点组成的集合 $S$，以及一个平面上的点，以及一个平面上的点 $p$，函数 $f(p,S)$ 当且仅当 $p$ 在 $S$ 的凸包内部（包括 $S$ 的凸包的边界）时值为 $1$，其余情况下其值为 $0$。\n\n现给定两个平面上的点集 $P=\\{p_1,p_2,\\cdots,p_N\\}$ 和 $A=\\{a_1,a_2,\\cdots,a_M\\}$，我们称 $A$ 中的一个点 $a_i$ 为极点，当且仅其满足\n\n$$\\sum_{j\\ne i} f(a_i,P\\cup\\{a_j\\})=0$$\n\n也就是说，**$a_i$ 不在任意 $A$ 集合中非 $a_i$ 的点与 $P$ 组成的凸包内部。**\n\n请统计出集合 $A$ 中极点的个数。", "inputFormat": "第一行包含两个用空格隔开正整数 $N$ 和 $M$；\n\n第二行包含 $N$ 个用空格隔开的整数对，第 $i$ 个数对  $(x_i^p,y_i^p)$ 表示点 $p_i$ 的坐标；\n\n第二行包含$M$个用空格隔开的整数对，第 $j$ 个数对  $(x_j^a,y_j^a)$ 表示点 $a_j$ 的坐标。\n\n对于同一个集合，输入数据保证不会出现坐标相同的两个点。", "outputFormat": "仅包含一行一个整数，表示集合$A$中极点的个数。\n\n## 说明", "hint": "对于 $30\\%$ 的数据满足 $N,M\\le 50$；\n\n对于另外 $30\\%$ 的数据满足 $N\\le 10,M\\le 20000$；\n\n对于 $100\\%$ 的数据满足 $3\\le N\\le 10^5,1\\le M\\le 10^5,\\ |x_i|,|y_i|≤10^6$，且点集 $P$ 的凸包面积不为 $0$。", "locale": "zh-CN"}}}
{"pid": "P4024", "type": "P", "difficulty": 6, "samples": [["3 5 3\n1 2 3 4 5\n9 9 9 9 9\n1 4 3 5 2\n1 1 2 5\n3 1 3 5\n2 1 3 5\n", "0\n4\n19\n"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2012", "提交答案", "CTSC/CTS"], "title": "[CTSC2012] 统计学家", "background": "[输入文件](https://pan.baidu.com/s/1i5laUcH)\n\n**由于洛谷评测机限制，最后请输出所有回答的异或和。**\n", "description": "给定一个 $N\\times M$ 的整数矩阵 $\\{A[i,j]\\}$（$1\\le i\\le N$，$1\\le j\\le M$）。请回答 $K$ 个询问，其中第 $i$ 个询问要求统计满足下述条件的二维逆序对 $(x_1,y_1,x_2,y_2)$ 的个数：\n\n- $u_{i,1}\\le x_1\\le x_2\\le u_{i,2}$\n- 且 $v_{i,1}\\le y_1\\le y_2\\le v_{i,2}$\n- 且 $A[x_1,y_1]>A[x_2,y_2]$", "inputFormat": "本题为提交答案试题，[输入文件](https://pan.baidu.com/s/1i5laUcH) `rev1.in ~ rev10.in`。\n\n输入文件 `rev*.in` 的第一行依次包含三个正整数 $N, M, K$。\n\n接下来 $N$ 行，每行 $M$ 个数给出整数矩阵 $A$，其中第 $i$ 行第 $j$ 个数为 $A[i,j]$。接下来 $K$ 行，每行四个整数给出所有的询问，其中第 $i$ 行依次为 $u_{i,1}, v_{i,1}, u_{i,2}, v_{i,2}$。", "outputFormat": "输出文件 `rev*.out` 的包含 $K$ 行，其中第 $i$ 行为一个整数，对应的第 $i$ 个询问的答案，即满足相应条件的二维逆序对个数。\n\n## 说明\n\n### 评分标准\n\n对于每个测试点，如果你有输出，且输出结果与标准输出完全一致，则该测试点得 $10$ 分，否则该测试点得 $0$ 分。\n\n**由于洛谷评测机限制，最后请输出所有回答的异或和。样例仅为理解题目之用，并非最后输出格式。**", "hint": "请妥善保存输入文件 `*.in` 和你的输出 `*.out`，及时备份，以免误删。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2012] Statistician", "background": "[Input files](https://pan.baidu.com/s/1i5laUcH).\n\nDue to the limitation of the Luogu judge, please output the XOR of all answers at the end.\n\nScoring: For each test point, if you produce an output and it exactly matches the official output, you get 10 points; otherwise, you get 0 points.", "description": "Given an $N \\times M$ integer matrix $\\{A[i,j]\\}$ ($1 \\le i \\le N$, $1 \\le j \\le M$). You need to answer $K$ queries. The $i$‑th query asks you to count the number of 2D inversion pairs $(x_1, y_1, x_2, y_2)$ that satisfy all of the following:\n- $u_{i,1} \\le x_1 \\le x_2 \\le u_{i,2}$,\n- $v_{i,1} \\le y_1 \\le y_2 \\le v_{i,2}$,\n- $A[x_1, y_1] > A[x_2, y_2]$.", "inputFormat": "This is an answer-submission problem. The [input files](https://pan.baidu.com/s/1i5laUcH) are named `rev1.in ~ rev10.in`.\n\nFor each `rev*.in`, the first line contains three positive integers $N, M, K$.\n\nThe next $N$ lines each contain $M$ integers, giving the matrix $A$, where the $j$‑th number in the $i$‑th line is $A[i, j]$. Then the next $K$ lines each contain four integers describing the queries; in the $i$‑th of these lines, the four integers are $u_{i,1}, v_{i,1}, u_{i,2}, v_{i,2}$.", "outputFormat": "On Luogu, output a single integer: the XOR of all $K$ answers (i.e., the XOR of the answers to all queries).\n\nNote: The sample is only for understanding the problem and is not the final output format.\n\n(Original answer-submission format for each `rev*.out`: it contains $K$ lines, where the $i$‑th line is the answer to the $i$‑th query, i.e., the number of 2D inversion pairs that satisfy the corresponding conditions.)", "hint": "Please keep the input files `*.in` and your outputs `*.out` safe and back them up in time to avoid accidental deletion.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2012] 统计学家", "background": "[输入文件](https://pan.baidu.com/s/1i5laUcH)\n\n**由于洛谷评测机限制，最后请输出所有回答的异或和。**\n", "description": "给定一个 $N\\times M$ 的整数矩阵 $\\{A[i,j]\\}$（$1\\le i\\le N$，$1\\le j\\le M$）。请回答 $K$ 个询问，其中第 $i$ 个询问要求统计满足下述条件的二维逆序对 $(x_1,y_1,x_2,y_2)$ 的个数：\n\n- $u_{i,1}\\le x_1\\le x_2\\le u_{i,2}$\n- 且 $v_{i,1}\\le y_1\\le y_2\\le v_{i,2}$\n- 且 $A[x_1,y_1]>A[x_2,y_2]$", "inputFormat": "本题为提交答案试题，[输入文件](https://pan.baidu.com/s/1i5laUcH) `rev1.in ~ rev10.in`。\n\n输入文件 `rev*.in` 的第一行依次包含三个正整数 $N, M, K$。\n\n接下来 $N$ 行，每行 $M$ 个数给出整数矩阵 $A$，其中第 $i$ 行第 $j$ 个数为 $A[i,j]$。接下来 $K$ 行，每行四个整数给出所有的询问，其中第 $i$ 行依次为 $u_{i,1}, v_{i,1}, u_{i,2}, v_{i,2}$。", "outputFormat": "输出文件 `rev*.out` 的包含 $K$ 行，其中第 $i$ 行为一个整数，对应的第 $i$ 个询问的答案，即满足相应条件的二维逆序对个数。\n\n## 说明\n\n### 评分标准\n\n对于每个测试点，如果你有输出，且输出结果与标准输出完全一致，则该测试点得 $10$ 分，否则该测试点得 $0$ 分。\n\n**由于洛谷评测机限制，最后请输出所有回答的异或和。样例仅为理解题目之用，并非最后输出格式。**", "hint": "请妥善保存输入文件 `*.in` 和你的输出 `*.out`，及时备份，以免误删。", "locale": "zh-CN"}}}
{"pid": "P4025", "type": "P", "difficulty": 4, "samples": [["3 5\n3 1\n4 8\n8 3", "TAK\n2 3 1 "]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "Special Judge", "PA（波兰）"], "title": "[PA 2014] Bohater", "background": "", "description": "在一款电脑游戏中，你需要打败 $n$ 只怪物（从 $1$ 到 $n$ 编号）。\n\n为了打败第 $i$ 只怪物，你需要消耗 $d_i$ 点生命值，但怪物死后会掉落血药，使你恢复 $a_i$ 点生命值。\n\n任何时候你的生命值都不能降到 $0$（或 $0$ 以下）。\n\n请问是否存在一种打怪顺序，使得你可以打完这 $n$ 只怪物而不死掉。", "inputFormat": "第一行两个整数 $n,z$，分别表示怪物的数量和你的初始生命值。\n\n接下来 $n$ 行，每行两个整数 $d_i,a_i$。", "outputFormat": "第一行为 `TAK`（是）或 `NIE`（否），表示是否存在这样的顺序。\n\n如果第一行为 `TAK`，则第二行为空格隔开的 $1\\sim n$ 的排列，表示合法的顺序。\n\n如果答案有很多，你可以输出其中任意一个。（**本题使用 SPJ**）", "hint": "对于 $100\\%$ 的数据，$1\\le n,z\\le 10^5$，$0\\le d_i,a_i\\le 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2014] Bohater", "background": "", "description": "在一款电脑游戏中，你需要打败 $n$ 只怪物（从 $1$ 到 $n$ 编号）。\n\n为了打败第 $i$ 只怪物，你需要消耗 $d_i$ 点生命值，但怪物死后会掉落血药，使你恢复 $a_i$ 点生命值。\n\n任何时候你的生命值都不能降到 $0$（或 $0$ 以下）。\n\n请问是否存在一种打怪顺序，使得你可以打完这 $n$ 只怪物而不死掉。", "inputFormat": "第一行两个整数 $n,z$，分别表示怪物的数量和你的初始生命值。\n\n接下来 $n$ 行，每行两个整数 $d_i,a_i$。", "outputFormat": "第一行为 `TAK`（是）或 `NIE`（否），表示是否存在这样的顺序。\n\n如果第一行为 `TAK`，则第二行为空格隔开的 $1\\sim n$ 的排列，表示合法的顺序。\n\n如果答案有很多，你可以输出其中任意一个。（**本题使用 SPJ**）", "hint": "对于 $100\\%$ 的数据，$1\\le n,z\\le 10^5$，$0\\le d_i,a_i\\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P4026", "type": "P", "difficulty": 6, "samples": [["10 0 0\n0 1 0 0 0 0\n0 0 0 3 0 10\n0 0 3 0 0 0", "5"], ["-10 -10 -10\n0 0 0 0 0 0\n0 0 0 0 0 0\n0 0 0 0 0 0", "0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2008", "各省省选", "上海", "枚举", "背包 DP"], "title": "[SHOI2008] 循环的债务", "background": null, "description": "Alice、Bob 和 Cynthia 总是为他们之间混乱的债务而烦恼，终于有一天，他们决定坐下来一起解决这个问题。不过，鉴别钞票的真伪是一件很麻烦的事情，于是他们决定要在清还债务的时候尽可能少的交换现金。\n\n比如说，Alice 欠 Bob $10$ 元，而 Cynthia 和他俩互不相欠。现在假设 Alice 只有一张 $50$ 元，Bob 有 $3$ 张 $10$ 元和 $10$ 张 $1$ 元，Cynthia有 $3$ 张 $20$ 元。一种比较直接的做法是：Alice 将 $50$ 元交给 Bob，而 Bob 将他身上的钱找给 Alice，这样一共就会有 $14$ 张钞票被交换。但这不是最好的做法，最好的做法是：Alice 把 $50$ 块给 Cynthia，Cynthia 再把两张 $20$ 给 Alice，另一张 $20$ 给 Bob，而 Bob 把一张 $10$ 块给 Cynthia，此时只有 $5$ 张钞票被交换过。\n\n没过多久他们就发现这是一个很棘手的问题，于是他们找到了精通数学的你为他们解决这个难题。", "inputFormat": "输入的第一行包括三个整数：$x_1$、$x_2$、$x_3$（$-1,000 \\le x_1, x_2, x_3 \\le 1,000$），其中\n\n$x_1$ 代表 Alice 欠 Bob 的钱（如果 $x_1$ 是负数，说明 Bob 欠了 Alice 的钱）\n\n$x_2$ 代表 Bob 欠 Cynthia 的钱（如果 $x_2$ 是负数，说明 Cynthia 欠了 Bob 的钱）\n\n$x_3$ 代表 Cynthia 欠 Alice 的钱（如果 $x_3$ 是负数，说明 Alice 欠了 Cynthia 的钱）\n\n接下来有三行，每行包括 6 个自然数：\n\n$\na_{100}, a_{50}, a_{20}, a_{10}, a_5, a_1\n$\n\n$\nb_{100}, b_{50}, b_{20}, b_{10}, b_5, b_1\n$\n\n$\nc_{100}, c_{50}, c_{20}, c_{10}, c_5, c_1\n$\n\n$a_{100}$ 表示 Alice 拥有的 $100$ 元钞票张数，$b_{50}$ 表示 Bob 拥有的 $50$ 元钞票张数，以此类推。另外，我们保证有 $a_{10} + a_5 + a_1 \\le 30$，$b_{10} + b_5 + b_1 \\le 30$，$c_{10} + c_5 + c_1 \\le 30$，而且三人总共拥有的钞票面值总额不会超过 $1,000$。", "outputFormat": "如果债务可以还清，则输出需要交换钞票的最少张数；如果不能还清，则输出“```impossible```”（注意单词全部小写，输出到文件时不要加引号）。", "hint": "对于 $30\\%$ 的数据，$x_1, x_2, x_3 \\le 50$。\n\n对于 $100\\%$ 的数据，$x_1, x_2, x_3 \\le 1,000$。", "locale": "zh-CN", "translations": {"en": {"title": "[SHOI2008] Cyclic Debts", "background": "", "description": "Alice, Bob, and Cynthia are always troubled by the messy debts among them. One day, they decide to sit together and settle everything. However, checking the authenticity of banknotes is troublesome, so they decide to exchange as little cash as possible when paying off their debts.\n\nFor example, Alice owes Bob $10$ yuan, while Cynthia owes neither of them anything. Suppose Alice has one $50$ yuan note, Bob has three $10$ yuan notes and ten $1$ yuan notes, and Cynthia has three $20$ yuan notes. A straightforward way is: Alice gives the $50$ yuan to Bob, and Bob gives change back to Alice. In total, $14$ banknotes are exchanged. But this is not optimal. The optimal way is: Alice gives the $50$ to Cynthia, Cynthia gives two $20$ notes to Alice and one $20$ note to Bob, and Bob gives one $10$ note to Cynthia. In this case, only $5$ banknotes are exchanged.\n\nBefore long, they find this is a hard problem, so they ask you, who are good at math, to solve it for them.", "inputFormat": "The first line contains three integers: $x_1$, $x_2$, $x_3$ ($-1,000 \\le x_1, x_2, x_3 \\le 1,000$), where\n\n$x_1$ is the amount Alice owes Bob (if $x_1$ is negative, it means Bob owes Alice),\n\n$x_2$ is the amount Bob owes Cynthia (if $x_2$ is negative, it means Cynthia owes Bob),\n\n$x_3$ is the amount Cynthia owes Alice (if $x_3$ is negative, it means Alice owes Cynthia).\n\nThen there are three lines, each containing 6 natural numbers:\n\n$\na_{100}, a_{50}, a_{20}, a_{10}, a_5, a_1\n$\n\n$\nb_{100}, b_{50}, b_{20}, b_{10}, b_5, b_1\n$\n\n$\nc_{100}, c_{50}, c_{20}, c_{10}, c_5, c_1\n$\n\n$a_{100}$ is the number of $100$ yuan banknotes Alice has, $b_{50}$ is the number of $50$ yuan banknotes Bob has, and so on. We also guarantee $a_{10} + a_5 + a_1 \\le 30$, $b_{10} + b_5 + b_1 \\le 30$, $c_{10} + c_5 + c_1 \\le 30$, and the total face value of all banknotes owned by the three people does not exceed $1,000$.", "outputFormat": "If the debts can be fully settled, output the minimum number of banknotes that need to be exchanged. If they cannot be settled, output impossible.", "hint": "For $30\\%$ of the testdata, $x_1, x_2, x_3 \\le 50$.\n\nFor $100\\%$ of the testdata, $x_1, x_2, x_3 \\le 1,000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SHOI2008] 循环的债务", "background": null, "description": "Alice、Bob 和 Cynthia 总是为他们之间混乱的债务而烦恼，终于有一天，他们决定坐下来一起解决这个问题。不过，鉴别钞票的真伪是一件很麻烦的事情，于是他们决定要在清还债务的时候尽可能少的交换现金。\n\n比如说，Alice 欠 Bob $10$ 元，而 Cynthia 和他俩互不相欠。现在假设 Alice 只有一张 $50$ 元，Bob 有 $3$ 张 $10$ 元和 $10$ 张 $1$ 元，Cynthia有 $3$ 张 $20$ 元。一种比较直接的做法是：Alice 将 $50$ 元交给 Bob，而 Bob 将他身上的钱找给 Alice，这样一共就会有 $14$ 张钞票被交换。但这不是最好的做法，最好的做法是：Alice 把 $50$ 块给 Cynthia，Cynthia 再把两张 $20$ 给 Alice，另一张 $20$ 给 Bob，而 Bob 把一张 $10$ 块给 Cynthia，此时只有 $5$ 张钞票被交换过。\n\n没过多久他们就发现这是一个很棘手的问题，于是他们找到了精通数学的你为他们解决这个难题。", "inputFormat": "输入的第一行包括三个整数：$x_1$、$x_2$、$x_3$（$-1,000 \\le x_1, x_2, x_3 \\le 1,000$），其中\n\n$x_1$ 代表 Alice 欠 Bob 的钱（如果 $x_1$ 是负数，说明 Bob 欠了 Alice 的钱）\n\n$x_2$ 代表 Bob 欠 Cynthia 的钱（如果 $x_2$ 是负数，说明 Cynthia 欠了 Bob 的钱）\n\n$x_3$ 代表 Cynthia 欠 Alice 的钱（如果 $x_3$ 是负数，说明 Alice 欠了 Cynthia 的钱）\n\n接下来有三行，每行包括 6 个自然数：\n\n$\na_{100}, a_{50}, a_{20}, a_{10}, a_5, a_1\n$\n\n$\nb_{100}, b_{50}, b_{20}, b_{10}, b_5, b_1\n$\n\n$\nc_{100}, c_{50}, c_{20}, c_{10}, c_5, c_1\n$\n\n$a_{100}$ 表示 Alice 拥有的 $100$ 元钞票张数，$b_{50}$ 表示 Bob 拥有的 $50$ 元钞票张数，以此类推。另外，我们保证有 $a_{10} + a_5 + a_1 \\le 30$，$b_{10} + b_5 + b_1 \\le 30$，$c_{10} + c_5 + c_1 \\le 30$，而且三人总共拥有的钞票面值总额不会超过 $1,000$。", "outputFormat": "如果债务可以还清，则输出需要交换钞票的最少张数；如果不能还清，则输出“```impossible```”（注意单词全部小写，输出到文件时不要加引号）。", "hint": "对于 $30\\%$ 的数据，$x_1, x_2, x_3 \\le 50$。\n\n对于 $100\\%$ 的数据，$x_1, x_2, x_3 \\le 1,000$。", "locale": "zh-CN"}}}
{"pid": "P4027", "type": "P", "difficulty": 6, "samples": [["3 100\n1 1 1\n1 2 2\n2 2 3", "225.000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "2007", "平衡树", "NOI", "离散化", "cdq 分治", "Special Judge", "分治", "动态规划优化", "斜率优化", "凸包", "李超线段树"], "title": "[NOI2007] 货币兑换", "background": "", "description": "小 Y 最近在一家金券交易所工作。该金券交易所只发行交易两种金券：A 纪念券（以下简称 A 券）和 B 纪念券（以下简称 B 券）。每个持有金券的顾客都有一个自己的帐户。金券的数目可以是一个实数。\n\n每天随着市场的起伏波动，两种金券都有自己当时的价值，即每一单位金券当天可以兑换的人民币数目。我们记录第 $K$ 天中 A 券和 B 券的价值分别为 $A_K$ 和 $B_K$（元/单位金券）。\n\n为了方便顾客，金券交易所提供了一种非常方便的交易方式：比例交易法。\n\n比例交易法分为两个方面：\n\na)  卖出金券：顾客提供一个 $[0, 100]$ 内的实数 $OP$ 作为卖出比例，其意义为：将 $OP\\%$ 的 A 券和 $OP\\%$ 的 B 券以当时的价值兑换为人民币；\n\nb)  买入金券：顾客支付 $IP$ 元人民币，交易所将会兑换给用户总价值为 $IP$ 的金券，并且，满足提供给顾客的 A 券和 B 券的比例在第 $K$ 天恰好为 $\\mathrm{Rate}_ K$；\n\n例如，假定接下来 $3$ 天内的 $A_K,B_K,\\mathrm{Rate}_ K$ 的变化分别为：\n\n| 时间 | $A_K$ | $B_K$ | $\\mathrm{Rate}_ K$ |\n| ----- | ----- | ----- | ----- |\n| 第一天 | $1$ | $1$ | $1$ |\n| 第二天 | $1$ | $2$ | $2$ |\n| 第三天 | $2$ | $2$ | $3$ |\n\n\n\n假定在第一天时，用户手中有 $100$ 元人民币但是没有任何金券。\n\n用户可以执行以下的操作：\n\n| 时间 | 用户操作 | 人民币(元) | A 券的数量 | B 券的数量 |\n| ----- | ----- | ----- | ----- | ----- |\n| 开户 | 无 | $100$ | $0$ | $0$ |\n| 第一天 | 买入 $100$ 元 | $0$ | $50$ | $50$ |\n| 第二天 | 卖出 $50\\%$ | $75$ | $25$ | $25$ |\n| 第二天 | 买入 $60$ 元 | $15$ | $55$ | $40$ |\n| 第三天 | 卖出 $100\\%$ | $205$ | $0$ | $0$ |\n\n注意到，同一天内可以进行多次操作。\n\n小 Y 是一个很有经济头脑的员工，通过较长时间的运作和行情测算，他已经知道了未来 $N$ 天内的 A 券和 B 券的价值以及 $\\mathrm{Rate}$。他还希望能够计算出来，如果开始时拥有 $S$ 元钱，那么 $N$ 天后最多能够获得多少元钱。\n", "inputFormat": "第一行两个正整数 $N,S$，分别表示小 Y 能预知的天数以及初始时拥有的钱数。\n\n接下来 $N$ 行，第 $K$ 行三个实数 $A_K,B_K,\\mathrm{Rate} _ K$ ，意义如题目中所述。\n", "outputFormat": "只有一个实数 $\\mathrm{MaxProfit}$，表示第 $N$ 天的操作结束时能够获得的最大的金钱数目。答案保留 $3$ 位小数。\n", "hint": "| 时间 | 用户操作 | 人民币(元) | A 券的数量 | B 券的数量 |\n| ----- | ----- | ----- | ----- | ----- |\n| 开户 | 无 | $100$ | $0$ | $0$ |\n| 第一天 | 买入 $100$ 元 | $0$ | $50$ | $50$ |\n| 第二天 | 卖出 $100\\%$ | $150$ | $0$ | $0$ |\n| 第二天 | 买入 $150$ 元 | $0$ | $75$ | $37.5$ |\n| 第三天 | 卖出 $100\\%$ | $225$ | $0$ | $0$ |\n\n\n本题没有部分分，你的程序的输出只有和标准答案相差不超过 $0.001$ 时，才能获得该测试点的满分，否则不得分。\n\n\n测试数据设计使得精度误差不会超过 $10^{-7}$ 。\n\n对于 $40\\%$ 的测试数据，满足 $N \\le 10$。\n\n对于 $60\\%$ 的测试数据，满足 $N \\le 1 000$。\n\n对于 $100\\%$ 的测试数据，满足 $N \\le 10^5$。\n\n对于 $100\\%$ 的测试数据，满足：\n\n$0 < A_K \\leq 10$，$0 < B_K\\le 10$，$0 < \\mathrm{Rate}_K \\le 100$，$\\mathrm{MaxProfit}  \\leq 10^9$。\n\n输入文件可能很大，请采用快速的读入方式。\n\n必然存在一种最优的买卖方案满足：\n\n每次买进操作使用完所有的人民币，每次卖出操作卖出所有的金券。\n", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2007] Currency Exchange", "background": "", "description": "Xiao Y (pinyin) recently started working at a voucher exchange. This exchange issues and trades only two types of vouchers: A commemorative voucher (hereinafter A voucher) and B commemorative voucher (hereinafter B voucher). Each customer who holds vouchers has their own account. The quantities of vouchers can be real numbers.\n\nWith daily market fluctuations, the two vouchers each have their current value, i.e., each unit of voucher can be exchanged for a certain amount of RMB on that day. We record the values of A and B vouchers on day $K$ as $A_K$ and $B_K$ (yuan per unit voucher), respectively.\n\nFor customer convenience, the exchange provides a very convenient trading method: proportional trading.\n\nProportional trading has two aspects:\n\na) Sell vouchers: The customer provides a real number $OP$ in $[0, 100]$ as the selling ratio, meaning: exchange $OP\\%$ of A vouchers and $OP\\%$ of B vouchers into RMB at the current values.\n\nb) Buy vouchers: The customer pays $IP$ RMB, and the exchange will convert it into vouchers with a total value of $IP$, and the proportion of A and B vouchers provided to the customer will be exactly $\\mathrm{Rate}_ K$ on day $K$.\n\nFor example, suppose over the next $3$ days the changes of $A_K$, $B_K$, and $\\mathrm{Rate}_ K$ are as follows:\n\n| Time | $A_K$ | $B_K$ | $\\mathrm{Rate}_ K$ |\n| ----- | ----- | ----- | ----- |\n| Day 1 | $1$ | $1$ | $1$ |\n| Day 2 | $1$ | $2$ | $2$ |\n| Day 3 | $2$ | $2$ | $3$ |\n\nAssume that on day 1, the user has $100$ RMB yuan and no vouchers.\n\nThe user can perform the following operations:\n\n| Time | User operation | RMB (yuan) | Quantity of A vouchers | Quantity of B vouchers |\n| ----- | ----- | ----- | ----- | ----- |\n| Account opening | None | $100$ | $0$ | $0$ |\n| Day 1 | Buy $100$ yuan | $0$ | $50$ | $50$ |\n| Day 2 | Sell $50\\%$ | $75$ | $25$ | $25$ |\n| Day 2 | Buy $60$ yuan | $15$ | $55$ | $40$ |\n| Day 3 | Sell $100\\%$ | $205$ | $0$ | $0$ |\n\nNote that multiple operations can be performed on the same day.\n\nXiao Y is financially savvy. Through long-term operations and market estimation, he already knows the values of A and B vouchers and $\\mathrm{Rate}$ for the next $N$ days. He also wants to compute, if he starts with $S$ RMB yuan, what is the maximum amount of money he can obtain after $N$ days.", "inputFormat": "The first line contains two positive integers $N, S$, representing the number of days Xiao Y can foresee and the initial amount of money, respectively.\n\nThe next $N$ lines each contain three real numbers $A_K, B_K, \\mathrm{Rate} _ K$ on line $K$, as described above.", "outputFormat": "Output a single real number $\\mathrm{MaxProfit}$, the maximum amount of money obtainable by the end of day $N$. The answer should be rounded to $3$ decimal places.", "hint": "| Time | User operation | RMB (yuan) | Quantity of A vouchers | Quantity of B vouchers |\n| ----- | ----- | ----- | ----- | ----- |\n| Account opening | None | $100$ | $0$ | $0$ |\n| Day 1 | Buy $100$ yuan | $0$ | $50$ | $50$ |\n| Day 2 | Sell $100\\%$ | $150$ | $0$ | $0$ |\n| Day 2 | Buy $150$ yuan | $0$ | $75$ | $37.5$ |\n| Day 3 | Sell $100\\%$ | $225$ | $0$ | $0$ |\n\nThere is no partial credit for this problem. Your program’s output must not differ from the standard answer by more than $0.001$ to receive full credit for a test point; otherwise, you get no points.\n\nThe testdata is designed such that the precision error will not exceed $10^{-7}$.\n\nFor $40\\%$ of the testdata, $N \\le 10$.\n\nFor $60\\%$ of the testdata, $N \\le 1\\,000$.\n\nFor $100\\%$ of the testdata, $N \\le 10^5$.\n\nFor $100\\%$ of the testdata, the following hold:\n$0 < A_K \\leq 10$, $0 < B_K \\le 10$, $0 < \\mathrm{Rate}_K \\le 100$, $\\mathrm{MaxProfit} \\leq 10^9$.\n\nThe input file may be large; please use fast I/O.\n\nThere always exists an optimal buy/sell strategy that satisfies:\neach buy operation uses up all RMB, and each sell operation sells all vouchers.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2007] 货币兑换", "background": "", "description": "小 Y 最近在一家金券交易所工作。该金券交易所只发行交易两种金券：A 纪念券（以下简称 A 券）和 B 纪念券（以下简称 B 券）。每个持有金券的顾客都有一个自己的帐户。金券的数目可以是一个实数。\n\n每天随着市场的起伏波动，两种金券都有自己当时的价值，即每一单位金券当天可以兑换的人民币数目。我们记录第 $K$ 天中 A 券和 B 券的价值分别为 $A_K$ 和 $B_K$（元/单位金券）。\n\n为了方便顾客，金券交易所提供了一种非常方便的交易方式：比例交易法。\n\n比例交易法分为两个方面：\n\na)  卖出金券：顾客提供一个 $[0, 100]$ 内的实数 $OP$ 作为卖出比例，其意义为：将 $OP\\%$ 的 A 券和 $OP\\%$ 的 B 券以当时的价值兑换为人民币；\n\nb)  买入金券：顾客支付 $IP$ 元人民币，交易所将会兑换给用户总价值为 $IP$ 的金券，并且，满足提供给顾客的 A 券和 B 券的比例在第 $K$ 天恰好为 $\\mathrm{Rate}_ K$；\n\n例如，假定接下来 $3$ 天内的 $A_K,B_K,\\mathrm{Rate}_ K$ 的变化分别为：\n\n| 时间 | $A_K$ | $B_K$ | $\\mathrm{Rate}_ K$ |\n| ----- | ----- | ----- | ----- |\n| 第一天 | $1$ | $1$ | $1$ |\n| 第二天 | $1$ | $2$ | $2$ |\n| 第三天 | $2$ | $2$ | $3$ |\n\n\n\n假定在第一天时，用户手中有 $100$ 元人民币但是没有任何金券。\n\n用户可以执行以下的操作：\n\n| 时间 | 用户操作 | 人民币(元) | A 券的数量 | B 券的数量 |\n| ----- | ----- | ----- | ----- | ----- |\n| 开户 | 无 | $100$ | $0$ | $0$ |\n| 第一天 | 买入 $100$ 元 | $0$ | $50$ | $50$ |\n| 第二天 | 卖出 $50\\%$ | $75$ | $25$ | $25$ |\n| 第二天 | 买入 $60$ 元 | $15$ | $55$ | $40$ |\n| 第三天 | 卖出 $100\\%$ | $205$ | $0$ | $0$ |\n\n注意到，同一天内可以进行多次操作。\n\n小 Y 是一个很有经济头脑的员工，通过较长时间的运作和行情测算，他已经知道了未来 $N$ 天内的 A 券和 B 券的价值以及 $\\mathrm{Rate}$。他还希望能够计算出来，如果开始时拥有 $S$ 元钱，那么 $N$ 天后最多能够获得多少元钱。\n", "inputFormat": "第一行两个正整数 $N,S$，分别表示小 Y 能预知的天数以及初始时拥有的钱数。\n\n接下来 $N$ 行，第 $K$ 行三个实数 $A_K,B_K,\\mathrm{Rate} _ K$ ，意义如题目中所述。\n", "outputFormat": "只有一个实数 $\\mathrm{MaxProfit}$，表示第 $N$ 天的操作结束时能够获得的最大的金钱数目。答案保留 $3$ 位小数。\n", "hint": "| 时间 | 用户操作 | 人民币(元) | A 券的数量 | B 券的数量 |\n| ----- | ----- | ----- | ----- | ----- |\n| 开户 | 无 | $100$ | $0$ | $0$ |\n| 第一天 | 买入 $100$ 元 | $0$ | $50$ | $50$ |\n| 第二天 | 卖出 $100\\%$ | $150$ | $0$ | $0$ |\n| 第二天 | 买入 $150$ 元 | $0$ | $75$ | $37.5$ |\n| 第三天 | 卖出 $100\\%$ | $225$ | $0$ | $0$ |\n\n\n本题没有部分分，你的程序的输出只有和标准答案相差不超过 $0.001$ 时，才能获得该测试点的满分，否则不得分。\n\n\n测试数据设计使得精度误差不会超过 $10^{-7}$ 。\n\n对于 $40\\%$ 的测试数据，满足 $N \\le 10$。\n\n对于 $60\\%$ 的测试数据，满足 $N \\le 1 000$。\n\n对于 $100\\%$ 的测试数据，满足 $N \\le 10^5$。\n\n对于 $100\\%$ 的测试数据，满足：\n\n$0 < A_K \\leq 10$，$0 < B_K\\le 10$，$0 < \\mathrm{Rate}_K \\le 100$，$\\mathrm{MaxProfit}  \\leq 10^9$。\n\n输入文件可能很大，请采用快速的读入方式。\n\n必然存在一种最优的买卖方案满足：\n\n每次买进操作使用完所有的人民币，每次卖出操作卖出所有的金券。\n", "locale": "zh-CN"}}}
{"pid": "P4028", "type": "P", "difficulty": 5, "samples": [["1\n5 2 3", "3"], ["1\n2 2 2", "Couldn't Produce!"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "洛谷原创", "O2优化", "枚举", "哈希 hashing", "大步小步算法 BSGS"], "title": "New Product", "background": "**一个经商的神奇故事……**\n\n(善意提醒：注意时限！）\n", "description": "LiM 有一家手工糕点店，因为糕点既实惠又好吃，于是积累了 $P$ 个常客（$P$ 为质数）。\n\n每次这家店出 New Product（新品）的时候，都会做很多个，这 $P$ 个人都会支持，支持方法是：\n\n**每个人买的数量都相同，而且买的总数要尽量多。**\n\n这家店共有 $B$ 个工人，一分钟可以生产已经生产的数量的 $A$ 倍。\n\n（注：一开始有一个已制作的 New Product 作为制作样品）\n\n而当制作完毕，抢购（只考虑常客）完后：\n\n**为了考虑工人们，最后要剩下正好 $B$ 个。**\n\n下面给出已知条件，请你帮 LiM 算算最少要工作多长时间吧！", "inputFormat": "\n\n共 $T+1$ 行。\n\n第一行一个数 $T$，表示共要出 $T$ 个 New Product。\n\n第 $2 \\sim T+1$ 行，每行三个数 $P$，$A$，$B$，意义如题。", "outputFormat": "\n对于每个 New Product：\n\n如果可以实现（有可能不行），输出最少工作的分钟数。\n\n如果不行，输出 `Couldn't Produce!`。", "hint": "\n\n#### 样例 $1$ 解释：\n\n有 $5$ 个常客，一分钟可以生产已生产的 $2$ 倍，有 $3$ 个工人。\n\n则最小需要 $3$ 分钟（生产 $2^3=8$ 个）才能符合要求。\n\n#### 样例 $2$ 解释：\n\n有 $2$ 个常客，一分钟可以生产已生产的 $2$ 倍，有 $2$ 个工人。\n\n因为不管是多长时间都会余下 $0$ 个，所以输出 `Couldn't Produce!`。\n\n\n----------------------------------------------\n\n说明：\n\nLiM 不是工人哦！\n\n对于每组 New Product，常客数量不同。\n\n对于 $20\\%$ 的数据，$T=1$，所有条件 $\\leqslant 100$。\n\n对于 $100\\%$ 的数据，$T \\leqslant 5000$，所有条件 $\\leqslant 5 \\times 10^4$。$P$ 为质数。", "locale": "zh-CN", "translations": {"en": {"title": "New Product", "background": "A magical story about doing business...\n\n(Friendly reminder: mind the time limit!).", "description": "LiM owns a handmade pastry shop. Because the pastries are both affordable and delicious, the shop has accumulated $P$ regular customers ($P$ is prime).\n\nEvery time the shop launches a New Product, they make many items. All $P$ customers will support it in this way:\n- Each customer buys the same quantity.\n- They buy as much as possible.\n\nThe shop has $B$ workers. At the end of each minute, the total number of products becomes $A$ times the current total.\n\n(Note: initially, there is one already-made New Product as a sample.)\n\nAfter production is finished and the $P$ regular customers rush to buy (only these regular customers are considered):\n- To take care of the workers, exactly $B$ items must remain.\n\nGiven the known conditions, please help LiM compute the minimal working time.", "inputFormat": "There are $T+1$ lines.\n\nThe first line contains an integer $T$, the number of New Products.\n\nLines $2$ to $T+1$ each contain three integers $P$, $A$, $B$, as described above.", "outputFormat": "For each New Product:\n- If it is achievable, output the minimal number of minutes worked.\n- If it is not achievable, output `Couldn't Produce!`.", "hint": "Sample 1 explanation:\nThere are $5$ regular customers, the total multiplies by $2$ each minute, and there are $3$ workers. The minimum is $3$ minutes (produce $2^3 = 8$ items) to meet the requirement.\n\nSample 2 explanation:\nThere are $2$ regular customers, the total multiplies by $2$ each minute, and there are $2$ workers. Since no matter how long they work the leftover will always be $0$, output `Couldn't Produce!`.\n\nNotes:\n- LiM is not a worker.\n- For each New Product, the number of regular customers may differ.\n\nConstraints:\n- For $20\\%$ of the testdata, $T = 1$ and all values $\\leqslant 100$.\n- For $100\\%$ of the testdata, $T \\leqslant 5000$, all values $\\leqslant 5 \\times 10^4$, and $P$ is prime.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "New Product", "background": "**一个经商的神奇故事……**\n\n(善意提醒：注意时限！）\n", "description": "LiM 有一家手工糕点店，因为糕点既实惠又好吃，于是积累了 $P$ 个常客（$P$ 为质数）。\n\n每次这家店出 New Product（新品）的时候，都会做很多个，这 $P$ 个人都会支持，支持方法是：\n\n**每个人买的数量都相同，而且买的总数要尽量多。**\n\n这家店共有 $B$ 个工人，一分钟可以生产已经生产的数量的 $A$ 倍。\n\n（注：一开始有一个已制作的 New Product 作为制作样品）\n\n而当制作完毕，抢购（只考虑常客）完后：\n\n**为了考虑工人们，最后要剩下正好 $B$ 个。**\n\n下面给出已知条件，请你帮 LiM 算算最少要工作多长时间吧！", "inputFormat": "\n\n共 $T+1$ 行。\n\n第一行一个数 $T$，表示共要出 $T$ 个 New Product。\n\n第 $2 \\sim T+1$ 行，每行三个数 $P$，$A$，$B$，意义如题。", "outputFormat": "\n对于每个 New Product：\n\n如果可以实现（有可能不行），输出最少工作的分钟数。\n\n如果不行，输出 `Couldn't Produce!`。", "hint": "\n\n#### 样例 $1$ 解释：\n\n有 $5$ 个常客，一分钟可以生产已生产的 $2$ 倍，有 $3$ 个工人。\n\n则最小需要 $3$ 分钟（生产 $2^3=8$ 个）才能符合要求。\n\n#### 样例 $2$ 解释：\n\n有 $2$ 个常客，一分钟可以生产已生产的 $2$ 倍，有 $2$ 个工人。\n\n因为不管是多长时间都会余下 $0$ 个，所以输出 `Couldn't Produce!`。\n\n\n----------------------------------------------\n\n说明：\n\nLiM 不是工人哦！\n\n对于每组 New Product，常客数量不同。\n\n对于 $20\\%$ 的数据，$T=1$，所有条件 $\\leqslant 100$。\n\n对于 $100\\%$ 的数据，$T \\leqslant 5000$，所有条件 $\\leqslant 5 \\times 10^4$。$P$ 为质数。", "locale": "zh-CN"}}}
{"pid": "P4029", "type": "P", "difficulty": 4, "samples": [["3 0\nA=?\n?=A+B\nC+O2=?", "A\nAB\nCO2"], ["3 1\nA1=?\nA1+?=B1\nC1+O2=?", "A\nNo Solution\nCO2"], ["1 2\nA0B0C0D0E0F0G0H0I0JK0L0M0N0O0P0QR0S0T0U0V0W0X0Y2Z0=?", "JQY2"], ["2 3\n?=A0B0C0D0E0F0G0H0I0J1K0L0M0N0O0P0Q1R0S0T0U0V0W0X0Y2Z0\nA0B0C0D0E0F0G0H0I0J1K0L0M0N0O0P0Q1R0S0T0U0V0W0X0Y2Z0+A0B0C0D0E0F0G0H0I0J1K0L0M0N0O0P0Q1R0S0T0U0V0W0X0Y2Z0=?", "JQY2\nJ2Q2Y4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["Code+"], "title": "[Code+#2] 化学狂暴", "background": "在那遥远的钦钦草原，住着 Yazid 和 YJQQQAQ，他们都是炼金术士。\n\n\n一般而言，题目背景总是没有用的，但这道题是个例外。在这里，我们将严谨地介绍钦钦草原世界化学学科的一些基本知识。如果你对这些内容感到枯燥乏味，你也可以跳过这个部分，直接阅读题目描述中的简述并结合样例来帮助你更快地理解题目。\n\n\n钦钦草原的世界里共有 $26$ 种元素，分别用大写字母A至Z表示。\n\n\n钦钦草原世界中的物质由元素构成，对于任意的物质，每种元素的出现次数都是非负整数，且至少有 $1$ 种物质的出现次数为正整数，我们把每种元素在物质中的出现次数称作该元素在该物质中的下标。我们可以按A到Z的顺序写下每种元素及其下标来描述一个物质。这是一个例子：`A0B0C0D0E0F0G0H0I0J1K0L0M0N0O0P0Q1R0S0T0U0V0W0X0Y2Z0`。这个例子描述了一种 J、Q 各出现 $1$ 次，Y 出现 $2$ 次的物质。\n\n\n然而，这种描述方法实在是太麻烦了，于是钦钦草原世界中的炼金术士们便尝试简化物质的描述。对于某种物质，我们定义“虚无元素”表示在该物质中下标为 $0$ 的元素，“单一元素”表示在该物质中下标为 $1$ 的元素。针对这两个定义，炼金术士们提出了两种化简方式：\n\n\n省略“虚无元素”：将“虚无元素”的字母和下标省略。如上面的物质可以通过该操作化简为：`J1Q1Y2`。\n\n省略“单一元素”的下标：将“单一元素”的下标省略。如上面的物质可以通过该操作化简为：`A0B0C0D0E0F0G0H0I0JK0L0M0N0O0P0QR0S0T0U0V0W0X0Y2Z0`。\n\n\n特别地，对于同时省略了“虚无元素”和“单一元素”下标的表示，我们把它叫做该物质的“最简式”。如上面物质的“最简式”即为：`JQY2`。\n\n\n由于钦钦草原世界的化学研究仍处于起步阶段，因此对于任意的物质，所有元素下标均为不超过 $9$ 的非负整数。\n\n\n化学方程式是描述化学反应的式子。一个化学方程式包含恰好一个等号（=），等号两边是由加号（+）连接的若干物质。形象地说，它的形式是这样的：\n\n```\n物质+物质+…+物质=物质+物质+…+物质\n```\n除了需要满足上述格式外，元素守恒也是不可忽视的。这表示等号两边所有元素在各物质中的出现次数总和必须相等。比如，这就是一个合法的（格式正确、元素守恒的）化学方程式：\n\n```\nJQY2+J2=J3QY2\n```\n需要特别注意的是，在化学方程式的书写中，未被化至“最简式”的元素也是可以被接受的。例如，下面的化学方程式也是合法的：\n\n```\nJ1Q1Y2+J2=J3Q1Y2\n```\n而下面这个化学方程式就不是合法的了，因为它并没有满足元素守恒。\n\n```\nJQY2+J2=JQY\n```\n钦钦草原化学学科的基本知识就介绍到这。祝各位选手武运昌隆！", "description": "所谓化学方程式，即是用加号（+）和等号（=）连接一些化学物质的式子。保证一个化学方程式中含有恰好一个等号（=）。化学物质由一些元素（用大写字母A至Z表示）加上下标（保证下标为不超过 $9$ 的非负整数）连接而成的。例如：`JQY2`、`A0J1QY2` 等。书写时需要保证字典序越小的字母排在越前面。\n\n\n需要注意的是，像 `A0J1QY2` 这样的物质书写同样是合法的，虽然事实上它和 `JQY2` 是等价的。我们把下标为 $1$ 的元素称为“单一元素”，把下标为 $0$ 的元素称为“虚无元素”。在书写一种物质时，我们既可以省去“单一元素”的下标，又可以直接省去“虚无元素”。特别地，我们把用这两种规则省略至最简的书写称为该物质的“最简式”。例如，`JQY2` 就是 `A0J1Q1Y2` 的最简式。\n\n\n既然称之为“方程式”，元素守恒就是必须的了。对于一个化学方程式，元素守恒指的是指等号两边所有元素的下标之和相等。比如，这个化学方程式就是元素守恒的：\n\n```\nJQY2+J2=J3QY2\n```\n而这个化学方程式就是不合法的，因为它不满足元素守恒：\n\n```\nJQY2+J2=JQY\n```\n作为一名资深炼金术士，Yazid 自然是整日沉迷在化学狂暴中。某一天，Yazid 写下了 $n$ 个化学方程式，并把它们放在一边，为后续的研究做着准备。\n\n\n然而，见习炼金术士 YJQQQAQ 不慎打翻了一瓶绿色的试剂，导致 Yazid 写下的所有化学方程式中，都有恰好 $1$ 个物质被绿色液体弄得模糊不清了。\n\n\n暴怒的 Yazid 狠狠地把 YJQQQAQ 批判了一番，并要求他将所有模糊不清的物质重新写出来。除此之外，作为惩罚，无论原来 Yazid 如何书写这些物质，YJQQQAQ 都必须将它们以“最简式”的形式写出。\n\n\n如果不能完成这些任务，Yazid 就会把他从钦钦草原放逐。面对这么多的化学方程式，弱小、无助的 YJQQQAQ 手足无措，于是他找到了钦钦草原最擅长编程的你，请你帮他完成任务。", "inputFormat": "从标准输入读入数据。\n\n\n第一行 $2$ 个整数 $n,m$，分别表示化学方程式的数目和Yazid的书写习惯。其中，书写习惯 $m$ 是 $0$ 到 $3$ 之间的整数，对于不同的 $m$，Yazid 书写物质的方式不同（这一信息可能对你解决部分测试点有帮助）：\n\n\n如果 $m=0$，则 Yazid 在书写方程式时一定会将所有物质化为“最简式”；\n\n如果 $m=1$，则 Yazid 在书写方程式时一定会将所有物质的“虚无元素”省略，且不会存在“单一元素”的下标被省略；\n\n如果 $m=2$，则 Yazid 在书写方程式时一定会将所有物质“单一元素”的下标省略，且不会存在“虚无元素”被省略；\n\n如果 $m=3$，则 Yazid 在书写方程式时一定不会省略“单一元素”的下标，也一定不会省略“虚无元素”。\n\n\n接下来 $n$ 行，每行一个字符串，描述一个被污染的化学方程式。其中，被污染的物质用?表示，保证对于每一个方程式都会存在恰好 $1$ 个?。\n\n\n数据保证化学方程式严格按照题目背景和题目描述中的格式，且不存在多余的空格或其他字符。", "outputFormat": "输出到标准输出。\n\n\n输出 $n$ 行，每行一个字符串，表示化为“最简式”的?所表示的物质。特别地，对于无解的情况（即?表示的物质超出钦钦草原世界化学学科的研究范围），请输出 `No Solution`。", "hint": "|测试点编号|m|?在方程式最左端|等号左边不含+|等号右边不含+|\n|:-:|:-:|:-:|:-:|:-:|\n|1|0|Yes|Yes|Yes|\n|2|1|Yes|Yes|Yes|\n|3|2|Yes|Yes|Yes|\n|4|3|Yes|Yes|Yes|\n|5|0|Yes|Yes||\n|6|1|Yes|Yes||\n|7|2|Yes|Yes||\n|8|3|Yes|Yes||\n|9|0|Yes||Yes|\n|10|1|Yes||Yes|\n|11|2|Yes||Yes|\n|12|3|Yes||Yes|\n|13|0||||\n|14|1||||\n|15|2||||\n|16|3||||\n|17|0||||\n|18|1||||\n|19|2||||\n|20|3|||\n\n如表格中“?在方程式的最左端”为 `Yes`，则表示该测试点保证每个字符串的第一个字符均为?；否则无特殊保证。\n\n\n如表格中“等号左边不含+”为 `Yes`，则表示该测试点保证等号左边没有加号（+），即等号左边只有一种物质；否则无特殊保证。\n\n\n如表格中“等号右边不含+”为 `Yes`，则表示该测试点保证等号右边没有加号（+），即等号右边只有一种物质；否则无特殊保证。\n\n\n对于所有的测试点，保证 $n\\leq 100$，保证每个方程式中等式两边的加号+都不超过 $5$ 个，这也意味着每行字符串（每个化学方程式）的长度不超过 $635$。\n\n\n来自 CodePlus 2017 12 月赛，清华大学计算机科学与技术系学生算法与竞赛协会 荣誉出品。\n\nCredit：idea/王聿中 命题/王聿中 验题/陈宇\n\nGit Repo：[https://git.thusaac.org/publish/CodePlus201712](https://git.thusaac.org/publish/CodePlus201712)\n\n感谢腾讯公司对此次比赛的支持。\n\n感谢 @[ChampionCyan](https://www.luogu.com.cn/user/1036180) 提供了修复后的题面。", "locale": "zh-CN", "translations": {"en": {"title": "[Code+#2] Chemical Rampage", "background": "In the distant Qinqin Grassland, Yazid and YJQQQAQ live there as alchemists.\n\nIn general, problem backgrounds are often useless, but this one is an exception. Here, we will rigorously introduce some basic knowledge of the chemistry discipline in the world of the Qinqin Grassland. If you find this content tedious, you may skip it and directly read the brief description in the problem statement and the samples to help you understand the problem more quickly.\n\nThere are $26$ kinds of elements in the world of the Qinqin Grassland, denoted by uppercase letters A to Z.\n\nSubstances in the Qinqin Grassland are composed of elements. For any substance, the occurrence count of each element is a non-negative integer, and at least one element has a positive count. We call the occurrence count of each element in a substance the subscript (index) of that element in that substance. We can write down each element and its subscript in the order from A to Z to describe a substance. Here is an example: `A0B0C0D0E0F0G0H0I0J1K0L0M0N0O0P0Q1R0S0T0U0V0W0X0Y2Z0`. This example describes a substance where J and Q each appear $1$ time, and Y appears $2$ times.\n\nHowever, this way of describing is too cumbersome, so the alchemists in the Qinqin Grassland tried to simplify substance descriptions. For a given substance, we define “null elements” as elements with subscript $0$ in this substance, and “unit elements” as elements with subscript $1$ in this substance. Based on these two definitions, the alchemists proposed two simplification methods:\n\nOmit “null elements”: remove the letters and subscripts of “null elements”. The substance above can be simplified to: `J1Q1Y2`.\n\nOmit the subscripts of “unit elements”: remove the subscripts of “unit elements”. The substance above can be simplified to: `A0B0C0D0E0F0G0H0I0JK0L0M0N0O0P0QR0S0T0U0V0W0X0Y2Z0`.\n\nIn particular, when both the “null elements” and the subscripts of “unit elements” are omitted, we call it the “minimal form” of the substance. For the substance above, its “minimal form” is: `JQY2`.\n\nSince the chemical research in the Qinqin Grassland is still in its infancy, for any substance, all element subscripts are non-negative integers not exceeding $9$.\n\nA chemical equation describes a chemical reaction. A chemical equation contains exactly one equals sign (=), and each side of the equals sign is a number of substances connected by plus signs (+). Informally, it looks like this:\n\n```\nSubstance+Substance+…+Substance=Substance+Substance+…+Substance\n```\nIn addition to satisfying the above format, conservation of elements must not be ignored. This means the total occurrence counts of all elements on both sides of the equals sign must be equal across all substances. For example, this is a valid (format-correct and element-conserving) chemical equation:\n\n```\nJQY2+J2=J3QY2\n```\nIt is especially important to note that, in writing chemical equations, elements not reduced to the “minimal form” are also acceptable. For example, the following chemical equation is also valid:\n\n```\nJ1Q1Y2+J2=J3Q1Y2\n```\nHowever, the following chemical equation is not valid, because it does not satisfy conservation of elements.\n\n```\nJQY2+J2=JQY\n```\nThat concludes the basic knowledge of chemistry in the Qinqin Grassland. Good luck to all contestants!", "description": "A chemical equation is an expression that connects several chemical substances with plus signs (+) and an equals sign (=). It is guaranteed that a chemical equation contains exactly one equals sign (=). A chemical substance is formed by several elements (denoted by uppercase letters A to Z) concatenated with subscripts (subscripts are non-negative integers not exceeding $9$). For example: `JQY2`, `A0J1QY2`. When writing, you must ensure that letters with smaller lexicographic order appear earlier.\n\nNote that a substance like `A0J1QY2` is also valid, although it is in fact equivalent to `JQY2`. We call elements with subscript $1$ “unit elements”, and elements with subscript $0$ “null elements”. When writing a substance, you may omit the subscript of “unit elements”, and you may directly omit “null elements”. In particular, we call the writing minimized by these two rules the “minimal form” of the substance. For example, `JQY2` is the minimal form of `A0J1Q1Y2`.\n\nSince it is called an “equation”, conservation of elements is required. For a chemical equation, conservation of elements means the sums of subscripts of all elements on the two sides of the equals sign are equal. For example, this chemical equation conserves elements:\n\n```\nJQY2+J2=J3QY2\n```\nThis chemical equation is invalid because it does not satisfy conservation of elements:\n\n```\nJQY2+J2=JQY\n```\nAs a seasoned alchemist, Yazid is naturally obsessed with chemical rampage all day long. One day, Yazid wrote down $n$ chemical equations and set them aside for later research.\n\nHowever, the apprentice alchemist YJQQQAQ accidentally knocked over a bottle of green reagent, causing exactly $1$ substance in each of Yazid’s chemical equations to be blurred.\n\nThe enraged Yazid harshly criticized YJQQQAQ and demanded that he rewrite all the blurred substances. Moreover, as punishment, regardless of how Yazid originally wrote those substances, YJQQQAQ must write them in their “minimal form”.\n\nIf he cannot complete these tasks, Yazid will banish him from the Qinqin Grassland. Faced with so many chemical equations, the weak and helpless YJQQQAQ was at a loss, so he found you, the best programmer in the Qinqin Grassland, to help him complete the task.", "inputFormat": "Read from standard input.\n\nThe first line contains $2$ integers $n, m$, representing the number of chemical equations and Yazid’s writing habit, respectively. The writing habit $m$ is an integer from $0$ to $3$. For different $m$, Yazid writes substances differently (this information may help you on some test points):\n\nIf $m=0$, then when writing equations, Yazid will always reduce all substances to their “minimal form”.\n\nIf $m=1$, then when writing equations, Yazid will always omit all “null elements”, and the subscripts of “unit elements” will not be omitted.\n\nIf $m=2$, then when writing equations, Yazid will always omit the subscripts of all “unit elements”, and no “null elements” will be omitted.\n\nIf $m=3$, then when writing equations, Yazid will neither omit the subscripts of “unit elements” nor omit “null elements”.\n\nThe next $n$ lines each contain one string describing a polluted chemical equation. The blurred substance is denoted by ?, and it is guaranteed that for each equation there is exactly $1$ ?.\n\nThe testdata guarantees that chemical equations strictly follow the format described in the Background and Description, and there are no extra spaces or other characters.", "outputFormat": "Output to standard output.\n\nOutput $n$ lines, each containing a string that is the “minimal form” of the substance represented by ?. In particular, for cases with no solution (i.e., the substance represented by ? is beyond the scope of the chemistry discipline of the Qinqin Grassland), output `No Solution`.", "hint": "|Testpoint ID|m|? at the very left|No + on the left of =|No + on the right of =|\n|:-:|:-:|:-:|:-:|:-:|\n|1|0|Yes|Yes|Yes|\n|2|1|Yes|Yes|Yes|\n|3|2|Yes|Yes|Yes|\n|4|3|Yes|Yes|Yes|\n|5|0|Yes|Yes||\n|6|1|Yes|Yes||\n|7|2|Yes|Yes||\n|8|3|Yes|Yes||\n|9|0|Yes||Yes|\n|10|1|Yes||Yes|\n|11|2|Yes||Yes|\n|12|3|Yes||Yes|\n|13|0||||\n|14|1||||\n|15|2||||\n|16|3||||\n|17|0||||\n|18|1||||\n|19|2||||\n|20|3|||\n\nIf “? at the very left” is `Yes` in the table, then each string in that testpoint is guaranteed to have ? as its first character; otherwise there is no special guarantee.\n\nIf “No + on the left of =” is `Yes` in the table, then each testpoint is guaranteed to have no plus sign (+) on the left side of the equals sign, i.e., there is only one substance on the left; otherwise there is no special guarantee.\n\nIf “No + on the right of =” is `Yes` in the table, then each testpoint is guaranteed to have no plus sign (+) on the right side of the equals sign, i.e., there is only one substance on the right; otherwise there is no special guarantee.\n\nFor all test points, it is guaranteed that $n \\le 100$, and the number of plus signs (+) on each side of the equation does not exceed $5$. This also implies that the length of each line (each chemical equation) does not exceed $635$.\n\nFrom CodePlus 2017 December Contest, proudly presented by the Student Algorithms and Competition Association of the Department of Computer Science and Technology, Tsinghua University.\n\nCredit: idea/Wang Yuzhong, problem setting/Wang Yuzhong, verification/Chen Yu.\n\nGit Repo: [https://git.thusaac.org/publish/CodePlus201712](https://git.thusaac.org/publish/CodePlus201712)\n\nThanks to Tencent for supporting this contest.\n\nThanks to @[ChampionCyan](https://www.luogu.com.cn/user/1036180) for providing the fixed statement.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Code+#2] 化学狂暴", "background": "在那遥远的钦钦草原，住着 Yazid 和 YJQQQAQ，他们都是炼金术士。\n\n\n一般而言，题目背景总是没有用的，但这道题是个例外。在这里，我们将严谨地介绍钦钦草原世界化学学科的一些基本知识。如果你对这些内容感到枯燥乏味，你也可以跳过这个部分，直接阅读题目描述中的简述并结合样例来帮助你更快地理解题目。\n\n\n钦钦草原的世界里共有 $26$ 种元素，分别用大写字母A至Z表示。\n\n\n钦钦草原世界中的物质由元素构成，对于任意的物质，每种元素的出现次数都是非负整数，且至少有 $1$ 种物质的出现次数为正整数，我们把每种元素在物质中的出现次数称作该元素在该物质中的下标。我们可以按A到Z的顺序写下每种元素及其下标来描述一个物质。这是一个例子：`A0B0C0D0E0F0G0H0I0J1K0L0M0N0O0P0Q1R0S0T0U0V0W0X0Y2Z0`。这个例子描述了一种 J、Q 各出现 $1$ 次，Y 出现 $2$ 次的物质。\n\n\n然而，这种描述方法实在是太麻烦了，于是钦钦草原世界中的炼金术士们便尝试简化物质的描述。对于某种物质，我们定义“虚无元素”表示在该物质中下标为 $0$ 的元素，“单一元素”表示在该物质中下标为 $1$ 的元素。针对这两个定义，炼金术士们提出了两种化简方式：\n\n\n省略“虚无元素”：将“虚无元素”的字母和下标省略。如上面的物质可以通过该操作化简为：`J1Q1Y2`。\n\n省略“单一元素”的下标：将“单一元素”的下标省略。如上面的物质可以通过该操作化简为：`A0B0C0D0E0F0G0H0I0JK0L0M0N0O0P0QR0S0T0U0V0W0X0Y2Z0`。\n\n\n特别地，对于同时省略了“虚无元素”和“单一元素”下标的表示，我们把它叫做该物质的“最简式”。如上面物质的“最简式”即为：`JQY2`。\n\n\n由于钦钦草原世界的化学研究仍处于起步阶段，因此对于任意的物质，所有元素下标均为不超过 $9$ 的非负整数。\n\n\n化学方程式是描述化学反应的式子。一个化学方程式包含恰好一个等号（=），等号两边是由加号（+）连接的若干物质。形象地说，它的形式是这样的：\n\n```\n物质+物质+…+物质=物质+物质+…+物质\n```\n除了需要满足上述格式外，元素守恒也是不可忽视的。这表示等号两边所有元素在各物质中的出现次数总和必须相等。比如，这就是一个合法的（格式正确、元素守恒的）化学方程式：\n\n```\nJQY2+J2=J3QY2\n```\n需要特别注意的是，在化学方程式的书写中，未被化至“最简式”的元素也是可以被接受的。例如，下面的化学方程式也是合法的：\n\n```\nJ1Q1Y2+J2=J3Q1Y2\n```\n而下面这个化学方程式就不是合法的了，因为它并没有满足元素守恒。\n\n```\nJQY2+J2=JQY\n```\n钦钦草原化学学科的基本知识就介绍到这。祝各位选手武运昌隆！", "description": "所谓化学方程式，即是用加号（+）和等号（=）连接一些化学物质的式子。保证一个化学方程式中含有恰好一个等号（=）。化学物质由一些元素（用大写字母A至Z表示）加上下标（保证下标为不超过 $9$ 的非负整数）连接而成的。例如：`JQY2`、`A0J1QY2` 等。书写时需要保证字典序越小的字母排在越前面。\n\n\n需要注意的是，像 `A0J1QY2` 这样的物质书写同样是合法的，虽然事实上它和 `JQY2` 是等价的。我们把下标为 $1$ 的元素称为“单一元素”，把下标为 $0$ 的元素称为“虚无元素”。在书写一种物质时，我们既可以省去“单一元素”的下标，又可以直接省去“虚无元素”。特别地，我们把用这两种规则省略至最简的书写称为该物质的“最简式”。例如，`JQY2` 就是 `A0J1Q1Y2` 的最简式。\n\n\n既然称之为“方程式”，元素守恒就是必须的了。对于一个化学方程式，元素守恒指的是指等号两边所有元素的下标之和相等。比如，这个化学方程式就是元素守恒的：\n\n```\nJQY2+J2=J3QY2\n```\n而这个化学方程式就是不合法的，因为它不满足元素守恒：\n\n```\nJQY2+J2=JQY\n```\n作为一名资深炼金术士，Yazid 自然是整日沉迷在化学狂暴中。某一天，Yazid 写下了 $n$ 个化学方程式，并把它们放在一边，为后续的研究做着准备。\n\n\n然而，见习炼金术士 YJQQQAQ 不慎打翻了一瓶绿色的试剂，导致 Yazid 写下的所有化学方程式中，都有恰好 $1$ 个物质被绿色液体弄得模糊不清了。\n\n\n暴怒的 Yazid 狠狠地把 YJQQQAQ 批判了一番，并要求他将所有模糊不清的物质重新写出来。除此之外，作为惩罚，无论原来 Yazid 如何书写这些物质，YJQQQAQ 都必须将它们以“最简式”的形式写出。\n\n\n如果不能完成这些任务，Yazid 就会把他从钦钦草原放逐。面对这么多的化学方程式，弱小、无助的 YJQQQAQ 手足无措，于是他找到了钦钦草原最擅长编程的你，请你帮他完成任务。", "inputFormat": "从标准输入读入数据。\n\n\n第一行 $2$ 个整数 $n,m$，分别表示化学方程式的数目和Yazid的书写习惯。其中，书写习惯 $m$ 是 $0$ 到 $3$ 之间的整数，对于不同的 $m$，Yazid 书写物质的方式不同（这一信息可能对你解决部分测试点有帮助）：\n\n\n如果 $m=0$，则 Yazid 在书写方程式时一定会将所有物质化为“最简式”；\n\n如果 $m=1$，则 Yazid 在书写方程式时一定会将所有物质的“虚无元素”省略，且不会存在“单一元素”的下标被省略；\n\n如果 $m=2$，则 Yazid 在书写方程式时一定会将所有物质“单一元素”的下标省略，且不会存在“虚无元素”被省略；\n\n如果 $m=3$，则 Yazid 在书写方程式时一定不会省略“单一元素”的下标，也一定不会省略“虚无元素”。\n\n\n接下来 $n$ 行，每行一个字符串，描述一个被污染的化学方程式。其中，被污染的物质用?表示，保证对于每一个方程式都会存在恰好 $1$ 个?。\n\n\n数据保证化学方程式严格按照题目背景和题目描述中的格式，且不存在多余的空格或其他字符。", "outputFormat": "输出到标准输出。\n\n\n输出 $n$ 行，每行一个字符串，表示化为“最简式”的?所表示的物质。特别地，对于无解的情况（即?表示的物质超出钦钦草原世界化学学科的研究范围），请输出 `No Solution`。", "hint": "|测试点编号|m|?在方程式最左端|等号左边不含+|等号右边不含+|\n|:-:|:-:|:-:|:-:|:-:|\n|1|0|Yes|Yes|Yes|\n|2|1|Yes|Yes|Yes|\n|3|2|Yes|Yes|Yes|\n|4|3|Yes|Yes|Yes|\n|5|0|Yes|Yes||\n|6|1|Yes|Yes||\n|7|2|Yes|Yes||\n|8|3|Yes|Yes||\n|9|0|Yes||Yes|\n|10|1|Yes||Yes|\n|11|2|Yes||Yes|\n|12|3|Yes||Yes|\n|13|0||||\n|14|1||||\n|15|2||||\n|16|3||||\n|17|0||||\n|18|1||||\n|19|2||||\n|20|3|||\n\n如表格中“?在方程式的最左端”为 `Yes`，则表示该测试点保证每个字符串的第一个字符均为?；否则无特殊保证。\n\n\n如表格中“等号左边不含+”为 `Yes`，则表示该测试点保证等号左边没有加号（+），即等号左边只有一种物质；否则无特殊保证。\n\n\n如表格中“等号右边不含+”为 `Yes`，则表示该测试点保证等号右边没有加号（+），即等号右边只有一种物质；否则无特殊保证。\n\n\n对于所有的测试点，保证 $n\\leq 100$，保证每个方程式中等式两边的加号+都不超过 $5$ 个，这也意味着每行字符串（每个化学方程式）的长度不超过 $635$。\n\n\n来自 CodePlus 2017 12 月赛，清华大学计算机科学与技术系学生算法与竞赛协会 荣誉出品。\n\nCredit：idea/王聿中 命题/王聿中 验题/陈宇\n\nGit Repo：[https://git.thusaac.org/publish/CodePlus201712](https://git.thusaac.org/publish/CodePlus201712)\n\n感谢腾讯公司对此次比赛的支持。\n\n感谢 @[ChampionCyan](https://www.luogu.com.cn/user/1036180) 提供了修复后的题面。", "locale": "zh-CN"}}}
{"pid": "P4030", "type": "P", "difficulty": 4, "samples": [["3 3 4\n1 1 1\n1 1 1\n1 1 2\n1 1 2\n1 1 3\n2 2 2\n2 1 2", "Y\nN\nN\nY"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["Code+"], "title": "[Code+#2] 可做题1", "background": "“codeplus比赛的时候在做什么？有没有空？能来解决停机问题吗？”qmqmqm这样问sublinekelzrip。\n\n\n当然，sublinekelzrip并不会停机问题，所以qmqmqm改为提出了另一个题目，现在请你帮助sublinekelzrip解决这个题目。\n", "description": "这个问题是这样的：\n\n\n对于任何一个$n$阶方阵，若任意从其中选择$n$个不同行不同列的位置，其上的权值之和均相等，则我们称这个矩阵是巧妙的。注意对于$n=1$的任何矩阵都是巧妙的。 例如矩阵：\n\n```cpp\n1 2 3\n4 5 6\n7 8 9\n```\n是巧妙的，因为$1+5+9=1+6+8=2+4+9=2+6+7=3+5+7=3+4+8=15$。\n\n而矩阵：\n\n```cpp\n1 2\n2 1\n```\n不巧妙，因为$1+1 \\neq 2+2$。\n\n现在有一个$n \\times m$大小的矩阵$M$以及$T$个询问，每次询问其一个子方阵是否是巧妙的。\n", "inputFormat": "从标准输入读入数据。\n\n\n输入第一行包含三个正整数$n,m,T$。\n\n\n之后$n$行每行$m$个空格分割的非负整数，表示矩阵$M$。\n\n\n之后$T$行每行$3$个正整数$x,y,k$,表示询问第$x$行第$y$列为左上角的$k$阶方阵是否是巧妙的。保证这个矩阵完全位于$M$之中。\n", "outputFormat": "输出到标准输出。\n\n\n输出包含$T$行每行一个字符Y或者N。Y表示被询问的方阵是巧妙的，N表示不是。\n", "hint": " ![](https://cdn.luogu.com.cn/upload/pic/12654.png) \n\n对于所有的数据，$0 \\leq M_{ij} \\leq 10^9$，$1 \\leq x \\leq n$，$1 \\leq y \\leq m$。\n\n\n来自 CodePlus 2017 12 月赛，清华大学计算机科学与技术系学生算法与竞赛协会 荣誉出品。\n\nCredit：idea/卢政荣 命题/卢政荣 验题/吕时清，王聿中\n\nGit Repo：https://git.thusaac.org/publish/CodePlus201712\n\n感谢腾讯公司对此次比赛的支持。\n", "locale": "zh-CN", "translations": {"en": {"title": "[Code+#2] Doable Problem 1", "background": "“During the CodePlus contest, what are you doing? Are you free? Can you come solve the Halting Problem?” qmqmqm asked sublinekelzrip.\n\nOf course, sublinekelzrip cannot solve the Halting Problem, so qmqmqm proposed another problem instead. Now please help sublinekelzrip solve this problem.", "description": "The problem is as follows:\n\nFor any $n$-by-$n$ matrix, if for any selection of $n$ positions with no two in the same row or column, the sum of the values on those positions is always the same, then we call this matrix “clever.” Note that any matrix with $n = 1$ is clever. For example, the matrix:\n\n```cpp\n1 2 3\n4 5 6\n7 8 9\n```\nis clever because $1+5+9=1+6+8=2+4+9=2+6+7=3+5+7=3+4+8=15$.\n\nThe matrix:\n\n```cpp\n1 2\n2 1\n```\nis not clever because $1+1 \\neq 2+2$.\n\nNow you are given an $n \\times m$ matrix $M$ and $T$ queries. Each query asks whether a subsquare is clever.", "inputFormat": "Read from standard input.\n\nThe first line contains three positive integers $n, m, T$.\n\nThe next $n$ lines each contain $m$ space-separated non-negative integers, representing the matrix $M$.\n\nThe next $T$ lines each contain three positive integers $x, y, k$, indicating the $k$-by-$k$ square whose top-left corner is at row $x$, column $y$. It is guaranteed that this square lies entirely within $M$.", "outputFormat": "Output to standard output.\n\nPrint $T$ lines, each containing a single character Y or N. Y means the queried square is clever, and N means it is not.", "hint": "![](https://cdn.luogu.com.cn/upload/pic/12654.png)\n\nConstraints: For all the testdata, $0 \\leq M_{ij} \\leq 10^9$, $1 \\leq x \\leq n$, $1 \\leq y \\leq m$.\n\nFrom CodePlus 2017 December Contest, proudly presented by the Student Association for Algorithms and Programming Contest, Department of Computer Science and Technology, Tsinghua University.\n\nCredit: idea/卢政荣 命题/卢政荣 验题/吕时清，王聿中.\n\nGit Repo: https://git.thusaac.org/publish/CodePlus201712\n\nThanks to Tencent for supporting this contest.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Code+#2] 可做题1", "background": "“codeplus比赛的时候在做什么？有没有空？能来解决停机问题吗？”qmqmqm这样问sublinekelzrip。\n\n\n当然，sublinekelzrip并不会停机问题，所以qmqmqm改为提出了另一个题目，现在请你帮助sublinekelzrip解决这个题目。\n", "description": "这个问题是这样的：\n\n\n对于任何一个$n$阶方阵，若任意从其中选择$n$个不同行不同列的位置，其上的权值之和均相等，则我们称这个矩阵是巧妙的。注意对于$n=1$的任何矩阵都是巧妙的。 例如矩阵：\n\n```cpp\n1 2 3\n4 5 6\n7 8 9\n```\n是巧妙的，因为$1+5+9=1+6+8=2+4+9=2+6+7=3+5+7=3+4+8=15$。\n\n而矩阵：\n\n```cpp\n1 2\n2 1\n```\n不巧妙，因为$1+1 \\neq 2+2$。\n\n现在有一个$n \\times m$大小的矩阵$M$以及$T$个询问，每次询问其一个子方阵是否是巧妙的。\n", "inputFormat": "从标准输入读入数据。\n\n\n输入第一行包含三个正整数$n,m,T$。\n\n\n之后$n$行每行$m$个空格分割的非负整数，表示矩阵$M$。\n\n\n之后$T$行每行$3$个正整数$x,y,k$,表示询问第$x$行第$y$列为左上角的$k$阶方阵是否是巧妙的。保证这个矩阵完全位于$M$之中。\n", "outputFormat": "输出到标准输出。\n\n\n输出包含$T$行每行一个字符Y或者N。Y表示被询问的方阵是巧妙的，N表示不是。\n", "hint": " ![](https://cdn.luogu.com.cn/upload/pic/12654.png) \n\n对于所有的数据，$0 \\leq M_{ij} \\leq 10^9$，$1 \\leq x \\leq n$，$1 \\leq y \\leq m$。\n\n\n来自 CodePlus 2017 12 月赛，清华大学计算机科学与技术系学生算法与竞赛协会 荣誉出品。\n\nCredit：idea/卢政荣 命题/卢政荣 验题/吕时清，王聿中\n\nGit Repo：https://git.thusaac.org/publish/CodePlus201712\n\n感谢腾讯公司对此次比赛的支持。\n", "locale": "zh-CN"}}}
{"pid": "P4031", "type": "P", "difficulty": 5, "samples": [["6\n2 17 68 3 23 1\n1 17 68 3 57 1\n5 17 68 10 11 9\n5 17 68 10 71 9\n10 17 68 11 12 3\n10 17 68 8 6 4", "3\n1\n4\n1\n5\n9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["矩阵加速", "扩展欧几里德算法", "Code+"], "title": "[Code+#2] 可做题2", "background": "“codeplus比赛的时候在做什么？有没有空？能来解决丢番图方程问题吗？”sublinekelzrip这样问qmqmqm。\n\n\n当然，qmqmqm并不会丢番图方程问题，所以sublinekelzrip改为提出了另一个题目，现在请你帮助qmqmqm解决这个题目。\n", "description": "这个问题是这样的：\n\n\n若一个数列$a$满足条件$a_n=a_{n-1}+a_{n-2}$,$n \\geq 3$,而$a_1,a_2$为任意实数，则我们称这个数列为广义斐波那契数列。\n\n\n现在请你求出满足条件$a_1=i$，$a_2$为区间$[l,r]$中的整数，且$a_k mod p = m$的广义斐波那契数列有多少个。\n", "inputFormat": "从标准输入读入数据。\n\n\n本题包含多组数据，输入第一行包含一个正整数$T$，表示数据组数。对于每组数据：\n\n\n一行六个用空格隔开的整数$i,l,r,k,p,m$，意义如「题目描述」所示。\n", "outputFormat": "输出到标准输出。\n\n\n输出共$T$行，每行一个数表示该组数据的答案。\n", "hint": " ![](https://cdn.luogu.com.cn/upload/pic/12655.png) \n\n对于所有数据，$0 \\leq l \\leq r$,$1 \\leq p \\leq 10^9$,$0 \\leq m < p$,$T=10$,$0 \\leq i \\leq 10^{18},k \\geq 3$。\n\n\n来自 CodePlus 2017 12 月赛，清华大学计算机科学与技术系学生算法与竞赛协会 荣誉出品。\n\nCredit：idea/卢政荣 命题/卢政荣 验题/吕时清，茹逸中，王聿中\n\nGit Repo：https://git.thusaac.org/publish/CodePlus201712\n\n感谢腾讯公司对此次比赛的支持。\n", "locale": "zh-CN", "translations": {"en": {"title": "[Code+#2] Solvable Problem 2", "background": "\"What are you doing during the CodePlus contest? Are you free? Can you come solve a Diophantine equation problem?\" sublinekelzrip asked qmqmqm.\n\nOf course, qmqmqm could not solve a Diophantine equation problem, so sublinekelzrip instead proposed another problem. Now please help qmqmqm solve this one.", "description": "The problem is as follows:\n\nA sequence $a$ is called a generalized Fibonacci sequence if it satisfies $a_n = a_{n-1} + a_{n-2}$ for $n \\ge 3$, and $a_1, a_2$ are arbitrary real numbers.\n\nNow please count how many generalized Fibonacci sequences satisfy $a_1 = i$, $a_2$ is an integer in the interval $[l, r]$, and $a_k \\bmod p = m$.", "inputFormat": "Read from standard input.\n\nThis problem contains multiple test cases. The first line contains a positive integer $T$, the number of test cases. For each test case:\n\nOne line with six space-separated integers: i, l, r, k, p, m, whose meanings are as defined in the Description.", "outputFormat": "Write to standard output.\n\nOutput $T$ lines. Each line contains a single number, the answer for that test case.", "hint": "![](https://cdn.luogu.com.cn/upload/pic/12655.png)\n\nConstraints:\nFor all testdata, $0 \\le l \\le r$, $1 \\le p \\le 10^9$, $0 \\le m < p$, $T = 10$, $0 \\le i \\le 10^{18}$, $k \\ge 3$.\n\nFrom the CodePlus 2017 December Contest, proudly presented by the Student Association for Algorithms and Programming Competitions, Department of Computer Science and Technology, Tsinghua University.\n\nCredit: idea/卢政荣 (Lu Zhengrong), problem setting/卢政荣 (Lu Zhengrong), verification/吕时清 (Lü Shiqing), 茹逸中 (Ru Yizhong), 王聿中 (Wang Yuzhong).\n\nGit repo: https://git.thusaac.org/publish/CodePlus201712\n\nWe thank Tencent for supporting this contest.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Code+#2] 可做题2", "background": "“codeplus比赛的时候在做什么？有没有空？能来解决丢番图方程问题吗？”sublinekelzrip这样问qmqmqm。\n\n\n当然，qmqmqm并不会丢番图方程问题，所以sublinekelzrip改为提出了另一个题目，现在请你帮助qmqmqm解决这个题目。\n", "description": "这个问题是这样的：\n\n\n若一个数列$a$满足条件$a_n=a_{n-1}+a_{n-2}$,$n \\geq 3$,而$a_1,a_2$为任意实数，则我们称这个数列为广义斐波那契数列。\n\n\n现在请你求出满足条件$a_1=i$，$a_2$为区间$[l,r]$中的整数，且$a_k mod p = m$的广义斐波那契数列有多少个。\n", "inputFormat": "从标准输入读入数据。\n\n\n本题包含多组数据，输入第一行包含一个正整数$T$，表示数据组数。对于每组数据：\n\n\n一行六个用空格隔开的整数$i,l,r,k,p,m$，意义如「题目描述」所示。\n", "outputFormat": "输出到标准输出。\n\n\n输出共$T$行，每行一个数表示该组数据的答案。\n", "hint": " ![](https://cdn.luogu.com.cn/upload/pic/12655.png) \n\n对于所有数据，$0 \\leq l \\leq r$,$1 \\leq p \\leq 10^9$,$0 \\leq m < p$,$T=10$,$0 \\leq i \\leq 10^{18},k \\geq 3$。\n\n\n来自 CodePlus 2017 12 月赛，清华大学计算机科学与技术系学生算法与竞赛协会 荣誉出品。\n\nCredit：idea/卢政荣 命题/卢政荣 验题/吕时清，茹逸中，王聿中\n\nGit Repo：https://git.thusaac.org/publish/CodePlus201712\n\n感谢腾讯公司对此次比赛的支持。\n", "locale": "zh-CN"}}}
{"pid": "P4032", "type": "P", "difficulty": 5, "samples": [["1\n2\n1 100\n10\n1 0 2\n2 0 1\n3 2 1\n4 2 2\n5 2 1\n200 0 1\n201 3 1 2\n202 1\n203 1\n204 1", "Succeeded!\n97\nYJQQQAQ is angry.\n2\n1\n2\nYazid is angry."]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["线段树", "树状数组", "优先队列", "队列", "Code+"], "title": "[Code+#2] 火锅盛宴", "background": "SkyDec 和 YJQQQAQ 都是 Yazid 的好朋友。他们都非常喜欢吃火锅。有一天，他们聚在一起，享受一场火锅盛宴。", "description": "在这场火锅盛宴中，有一个麻辣浓汤锅底的火锅和 $n$ 种食物，每种食物数量都是无限的。我们用 $1$ 至 $n$ 将这些食材编号。\n\n每种食物煮熟所需要的时间不同，第 $i$ 种食物煮熟需要 $s_i$ 单位时间。这表示如果你在第 $T$ 个时刻将一个食物 $i$ 下到火锅里，那么它会在第 $T+s_i$ 个时刻被煮熟，并且此后一直会延续被煮熟的状态，直到它被拿走为止。\n\nYazid 和 YJQQQAQ 的口味不同：YJQQQAQ 觉得所有食物的好吃程度都是相同的；而 Yazid 则觉得没有两种食材的好吃程度是相同的，并且，巧合的是，编号越小的食物 Yazid 越喜欢吃。可怜的 SkyDec 由于不能吃辣，所以只能帮 Yazid 和 YJQQQAQ 煮食物。\n\n整个火锅盛宴持续 $10^9$ 单位时间。在整个盛宴中，三位好朋友除了谈笑风生之外，最重要的事当然就是吃东西了。在任意整数时刻，都有可能发生下列 $4$ 种事件中的任意一种，我们用 $0$ 至 $3$ 之间的整数 $op$ 描述事件类型：\n\n- $0\\ id$：表示 SkyDec 往火锅里下了一个编号为 $id$ 的食物。\n- $1$：Yazid 在锅内搜寻熟了的且最喜欢吃的食物，并拿走一个这种食物。特别地，如果锅里没有熟了的食物，那么 Yazid 会很愤怒。\n- $2\\ id$：YJQQQAQ 在锅内搜寻编号为 $id$ 的食物：\n   - 如果锅里不存在该种食物，则 YJQQQAQ 会很愤怒；\n   - 如果锅里存在熟了的该食物，则 YJQQQAQ 会取走一个并食用；\n   - 如果锅里只有未煮熟的该种食物，那么 YJQQQAQ 会希望知道最接近煮熟的该种食物（即锅内存在时间最长的该种食物）还需要多少时间被煮熟。\n- $3\\ l\\ r$：馋涎欲滴的 SkyDec 想知道，锅里编号在 $[l,r]$ 之间的且熟了的食物总共有多少个。", "inputFormat": "从标准输入读入数据。\n\n本题包含多组数据，输入的第一行为一个正整数 $T$，表示数据组数。接下来依次描述每组数据，对于每组数据：\n\n第一行一个正整数 $n$，表示食物的种类数。\n\n第二行 $n$ 个用空格隔开的正整数 $s_1,s_2,\\cdots, s_n$，描述每种食物煮熟需要的时间。\n\n第三行一个正整数 $Q$，表示事件的数目。\n\n接下来 $Q$ 行，每行若干个用空格隔开的非负整数，描述一个事件。先是两个整数 $t,op$，分别表示发生事件的时间以及事件的类型。\n\n- 如果 $op=0$ 或 $op=2$，则接下来 $1$ 个正整数 $id$，意义见题目描述；\n- 如果 $op=1$，则接下来没有其他数；\n- 如果 $op=3$，则接下来 $2$ 个正整数 $l,r$，意义见题目描述。\n\n数据保证 $t$ 按输入顺序严格递增。\n", "outputFormat": "对于每个 $op\\neq 0$ 的操作，输出一行表示答案。对于不同的 $op$，需要输出的内容如下：\n\n- 对于 $op=1$，如果 Yazid 成功取走食物，则输出他取走食物的编号；否则输出 $\\text{``\\texttt{Yazid is angry.}''}\\!\\!$（不含引号，下同）。\n- 对于 $op=2$，如果 YJQQQAQ 成功取走食物，则输出 $\\!\\!\\text{``\\texttt{Succeeded!}''}\\!\\!$；否则，如果锅里有未煮熟的该类食物，输出最接近煮熟的该种食物还需要多少时间被煮熟；否则，输出 $\\!\\!\\text{``\\texttt{YJQQQAQ is angry.}''}\\!$。\n- 对于 $op=3$，输出锅内编号在指定范围内的熟食的数量。", "hint": "对于所有数据，保证$ T\\leq 4$，保证 $n\\leq 100,000$，$Q\\leq 500,000$，$1\\leq s_i\\leq 10^8$，$1\\leq t\\leq 10^9$，$op\\in\\{0, 1, 2, 3\\}$，$1\\leq id\\leq n$，$1\\leq l\\leq r\\leq n$。数据保证 $t$ 按输入顺序严格递增。\n\n来自 CodePlus 2017 12 月赛，清华大学计算机科学与技术系学生算法与竞赛协会 荣誉出品。\n\nCredit：idea/王聿中 命题/王聿中 验题/吕时清，杨景钦\n\nGit Repo：https://git.thusaac.org/publish/CodePlus201712\n\n感谢腾讯公司对此次比赛的支持。\n", "locale": "zh-CN", "translations": {"en": {"title": "[Code+#2] Hotpot Feast", "background": "SkyDec and YJQQQAQ are both good friends of Yazid. They all love eating hotpot. One day, they get together to enjoy a hotpot feast.", "description": "In this hotpot feast, there is one spicy rich-broth hotpot and $n$ types of food, each available in unlimited quantity. We number the foods from $1$ to $n$.\n\nEach type takes a different amount of time to cook. The $i$-th type takes $s_i$ units of time to get cooked. This means if you put a food $i$ into the pot at time $T$, it will be cooked at time $T+s_i$, and thereafter it will remain cooked until it is taken out.\n\nYazid and YJQQQAQ have different tastes: YJQQQAQ thinks all foods are equally tasty; Yazid thinks no two types have the same tastiness, and, coincidentally, the smaller the id, the more Yazid likes it. Poor SkyDec cannot eat spicy food, so he can only help Yazid and YJQQQAQ cook.\n\nThe whole feast lasts $10^9$ units of time. Throughout the feast, besides chatting and laughing, the most important thing is of course eating. At any integer time, any one of the following $4$ types of events may occur. We use an integer $op$ between $0$ and $3$ to denote the event type:\n\n- $0\\ id$: SkyDec puts one food with id $id$ into the hotpot.\n- $1$: Yazid searches the pot for a cooked food that he likes the most and takes one of that type. In particular, if there is no cooked food in the pot, Yazid will be angry.\n- $2\\ id$: YJQQQAQ searches the pot for food with id $id$:\n  - If there is no such food in the pot, YJQQQAQ will be angry;\n  - If there is a cooked one of that type, YJQQQAQ will take one and eat it;\n  - If only uncooked ones of that type are in the pot, YJQQQAQ wants to know how much longer it will take for the one closest to being cooked (i.e., the one that has been in the pot the longest) to get cooked.\n- $3\\ l\\ r$: The mouthwatering SkyDec wants to know how many cooked foods with ids in $[l,r]$ are currently in the pot.", "inputFormat": "Read from standard input.\n\nThis problem contains multiple testcases. The first line contains a positive integer $T$, the number of testcases. Then for each testcase:\n\nThe first line contains a positive integer $n$, the number of food types.\n\nThe second line contains $n$ space-separated positive integers $s_1,s_2,\\cdots,s_n$, the cooking time required for each type.\n\nThe third line contains a positive integer $Q$, the number of events.\n\nThen follow $Q$ lines, each containing several space-separated nonnegative integers describing one event. Each line starts with two integers $t,op$, denoting the time the event occurs and the event type, respectively.\n\n- If $op=0$ or $op=2$, then one positive integer $id$ follows, as described above;\n- If $op=1$, then nothing else follows;\n- If $op=3$, then two positive integers $l,r$ follow, as described above.\n\nIt is guaranteed that $t$ is strictly increasing in the order of input.", "outputFormat": "For each operation with $op\\neq 0$, output one line with the answer. For different values of $op$, output as follows:\n\n- For $op=1$, if Yazid successfully takes a food, output the id of the food he takes; otherwise output $\\text{``\\texttt{Yazid is angry.}''}\\!\\!$.\n- For $op=2$, if YJQQQAQ successfully takes a food, output $\\!\\!\\text{``\\texttt{Succeeded!}''}\\!\\!$; otherwise, if there is an uncooked food of that type in the pot, output how much longer it will take for the closest-to-cooked one of that type to get cooked; otherwise, output $\\!\\!\\text{``\\texttt{YJQQQAQ is angry.}''}\\!$.\n- For $op=3$, output the number of cooked foods in the pot whose ids are within the specified range.", "hint": "For all testdata, it is guaranteed that $T\\leq 4$, $n\\leq 100,000$, $Q\\leq 500,000$, $1\\leq s_i\\leq 10^8$, $1\\leq t\\leq 10^9$, $op\\in\\{0, 1, 2, 3\\}$, $1\\leq id\\leq n$, $1\\leq l\\leq r\\leq n$. It is guaranteed that $t$ is strictly increasing in the order of input.\n\nFrom CodePlus December 2017 Contest, proudly presented by the Student Algorithm and Programming Association, Department of Computer Science and Technology, Tsinghua University.\n\nCredit: idea/Wang Yuzhong, problem setter/Wang Yuzhong, testers/Lü Shiqing, Yang Jingqin.\n\nGit Repo: https://git.thusaac.org/publish/CodePlus201712\n\nThanks to Tencent for supporting this contest.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Code+#2] 火锅盛宴", "background": "SkyDec 和 YJQQQAQ 都是 Yazid 的好朋友。他们都非常喜欢吃火锅。有一天，他们聚在一起，享受一场火锅盛宴。", "description": "在这场火锅盛宴中，有一个麻辣浓汤锅底的火锅和 $n$ 种食物，每种食物数量都是无限的。我们用 $1$ 至 $n$ 将这些食材编号。\n\n每种食物煮熟所需要的时间不同，第 $i$ 种食物煮熟需要 $s_i$ 单位时间。这表示如果你在第 $T$ 个时刻将一个食物 $i$ 下到火锅里，那么它会在第 $T+s_i$ 个时刻被煮熟，并且此后一直会延续被煮熟的状态，直到它被拿走为止。\n\nYazid 和 YJQQQAQ 的口味不同：YJQQQAQ 觉得所有食物的好吃程度都是相同的；而 Yazid 则觉得没有两种食材的好吃程度是相同的，并且，巧合的是，编号越小的食物 Yazid 越喜欢吃。可怜的 SkyDec 由于不能吃辣，所以只能帮 Yazid 和 YJQQQAQ 煮食物。\n\n整个火锅盛宴持续 $10^9$ 单位时间。在整个盛宴中，三位好朋友除了谈笑风生之外，最重要的事当然就是吃东西了。在任意整数时刻，都有可能发生下列 $4$ 种事件中的任意一种，我们用 $0$ 至 $3$ 之间的整数 $op$ 描述事件类型：\n\n- $0\\ id$：表示 SkyDec 往火锅里下了一个编号为 $id$ 的食物。\n- $1$：Yazid 在锅内搜寻熟了的且最喜欢吃的食物，并拿走一个这种食物。特别地，如果锅里没有熟了的食物，那么 Yazid 会很愤怒。\n- $2\\ id$：YJQQQAQ 在锅内搜寻编号为 $id$ 的食物：\n   - 如果锅里不存在该种食物，则 YJQQQAQ 会很愤怒；\n   - 如果锅里存在熟了的该食物，则 YJQQQAQ 会取走一个并食用；\n   - 如果锅里只有未煮熟的该种食物，那么 YJQQQAQ 会希望知道最接近煮熟的该种食物（即锅内存在时间最长的该种食物）还需要多少时间被煮熟。\n- $3\\ l\\ r$：馋涎欲滴的 SkyDec 想知道，锅里编号在 $[l,r]$ 之间的且熟了的食物总共有多少个。", "inputFormat": "从标准输入读入数据。\n\n本题包含多组数据，输入的第一行为一个正整数 $T$，表示数据组数。接下来依次描述每组数据，对于每组数据：\n\n第一行一个正整数 $n$，表示食物的种类数。\n\n第二行 $n$ 个用空格隔开的正整数 $s_1,s_2,\\cdots, s_n$，描述每种食物煮熟需要的时间。\n\n第三行一个正整数 $Q$，表示事件的数目。\n\n接下来 $Q$ 行，每行若干个用空格隔开的非负整数，描述一个事件。先是两个整数 $t,op$，分别表示发生事件的时间以及事件的类型。\n\n- 如果 $op=0$ 或 $op=2$，则接下来 $1$ 个正整数 $id$，意义见题目描述；\n- 如果 $op=1$，则接下来没有其他数；\n- 如果 $op=3$，则接下来 $2$ 个正整数 $l,r$，意义见题目描述。\n\n数据保证 $t$ 按输入顺序严格递增。\n", "outputFormat": "对于每个 $op\\neq 0$ 的操作，输出一行表示答案。对于不同的 $op$，需要输出的内容如下：\n\n- 对于 $op=1$，如果 Yazid 成功取走食物，则输出他取走食物的编号；否则输出 $\\text{``\\texttt{Yazid is angry.}''}\\!\\!$（不含引号，下同）。\n- 对于 $op=2$，如果 YJQQQAQ 成功取走食物，则输出 $\\!\\!\\text{``\\texttt{Succeeded!}''}\\!\\!$；否则，如果锅里有未煮熟的该类食物，输出最接近煮熟的该种食物还需要多少时间被煮熟；否则，输出 $\\!\\!\\text{``\\texttt{YJQQQAQ is angry.}''}\\!$。\n- 对于 $op=3$，输出锅内编号在指定范围内的熟食的数量。", "hint": "对于所有数据，保证$ T\\leq 4$，保证 $n\\leq 100,000$，$Q\\leq 500,000$，$1\\leq s_i\\leq 10^8$，$1\\leq t\\leq 10^9$，$op\\in\\{0, 1, 2, 3\\}$，$1\\leq id\\leq n$，$1\\leq l\\leq r\\leq n$。数据保证 $t$ 按输入顺序严格递增。\n\n来自 CodePlus 2017 12 月赛，清华大学计算机科学与技术系学生算法与竞赛协会 荣誉出品。\n\nCredit：idea/王聿中 命题/王聿中 验题/吕时清，杨景钦\n\nGit Repo：https://git.thusaac.org/publish/CodePlus201712\n\n感谢腾讯公司对此次比赛的支持。\n", "locale": "zh-CN"}}}
{"pid": "P4033", "type": "P", "difficulty": 6, "samples": [["5\n3 9\nLLRRUDUUU\nLLR.UDUUU\nLLRRUDUUU\n4 4\nLLRR\nL.LL\nRR.R\nLLRR\n4 3\nLRD\nLUL\nDLU\nRDL\n1 2\nLR\n2 2\n..\n..", "3\n8\n0\n1\n192"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["搜索", "图论建模", "生成树", "Code+"], "title": "[Code+#2] 白金元首与独舞", "background": "```cpp\n到河北省 见斯大林 / 在月光下 你的背影 / 让我们一起跳舞吧\n```\nうそだよ~ 河北省怎么可能有 Stalin。\n\n\n可是…… 可是如果 Stalin 把自己当作炸弹扔到地堡花园里来了呢？\n\n\n怀揣着这份小小的希望，元首 Adolf 独自走进了花园。终有一天会重逢的吧，Stalin。或许是在此处，或许是在遥远的彼方。\n\n\n无论如何，在此之前，好好装点一番花园，编排一段优美的舞步吧！", "description": "元首把花园分为 $n$ 行 $m$ 列的网格。每个格子中都可以放置一个标识，指向上、下、左、右四个方向中的任意一个。元首位于一个格子时，会按照其中标识所指的方向进入周围的格子，或者走出花园（即目的格子不在网格之内）。举个例子 —— 对于下面的放置方式，元首从第 $3$ 行第 $2$ 列的格子开始，会沿着以红色标出的路径走出花园；从第 $2$ 行第 $2$ 列的格子开始，则会在以蓝色标出的环路内不断地行走。\n\n ![](https://cdn.luogu.com.cn/upload/pic/12659.png) \n\n元首已经设计好了大部分格子的标识。元首用字符 L、R、U、D 分别表示指向左、右、上、下四个方向的标识，用字符 . 表示未决定的格子。现在，元首希望将每个 . 替换为 L、R、U、D 中任意一种，使得从花园中的任意一个格子出发，按照上述规则行走，都可以最终走出花园。\n\n\n你需要编写程序帮助元首计算替换的不同方案数。两个方案不同当且仅当存在一个格子，使得两个方案中该格子内的标识不同。当然，由于答案可能很大，只需给出方案数除以 $10^9 + 7$所得的余数即可。", "inputFormat": "从标准输入读入数据。\n\n\n输入的第一行包含一个正整数 $T$ —— 测试数据的组数。接下来包含 $T$ 组测试数据，格式如下，测试数据间没有空行。\n\n\n第 $1$ 行：两个空格分隔的正整数 $n$、$m$ —— 依次表示花园被分成的行数和列数。\n\n接下来 $n$ 行：每行一个长度为 $m$ 的由字符 L、R、U、D 和 . 组成的字符串 —— 表示花园内已经确定的格子状态。", "outputFormat": "输出到标准输出。\n\n\n对于每组测试数据输出一行 —— 满足条件的方案数除以 $10^9 + 7 $所得的余数。", "hint": "**样例解释**\n\n第 $1$ 组数据中，将惟一的 . 替换成 R、U 或 D 均满足要求。\n\n\n第 $2$ 组数据中，将左上方和右下方的两个 . 分别替换成 LR、LU、LD、UR、UU、UD、DR 或 DD 均满足要求。\n\n\n第 $3$ 组数据中，没有待决定的格子，原本的安排会使得元首陷入无尽的环路，故答案为 $0$。该组数据与**题目描述**中的例子相同。\n\n\n第 $4$ 组数据中，也没有待决定的格子，但原本的安排已经满足要求，故答案为 $1$。\n\n\n令 $k$ 表示标记未确定（即包含 `.`）的格子总数。\n\n\n对于所有数据，有 $1 \\leq T \\leq 10$，$1 \\leq n, m \\leq 200$，$0 \\leq k \\leq \\min(nm, 300)$。\n\n ![](https://cdn.luogu.com.cn/upload/pic/12660.png) \n\n“... wie Stalin!”\n\n\n题面与史实无关。\n\n\n来自 CodePlus 2017 12 月赛，清华大学计算机科学与技术系学生算法与竞赛协会 荣誉出品。\n\nCredit：idea/吕时清 命题/吕时清 验题/王聿中，杨景钦\n\nGit Repo：https://git.thusaac.org/publish/CodePlus201712\n\n感谢腾讯公司对此次比赛的支持。", "locale": "zh-CN", "translations": {"en": {"title": "[Code+#2] Platinum Führer and the Solo Dance", "background": "```cpp\n到河北省 见斯大林 / 在月光下 你的背影 / 让我们一起跳舞吧\n```\nJust kidding — how could there be Stalin in Hebei Province.\n\nBut... what if Stalin threw himself like a bomb into the bunker garden.\n\nWith this small hope in his heart, the Führer Adolf walked into the garden alone. We will meet again someday, Stalin. Perhaps here, perhaps far away.\n\nIn any case, before that, let’s decorate the garden and choreograph a graceful dance.", "description": "The Führer divides the garden into an $n$ by $m$ grid. Each cell can hold a marker pointing in one of the four directions: up, down, left, or right. When the Führer is in a cell, he moves to the adjacent cell indicated by the marker, or leaves the garden if the target cell is outside the grid. For example — in the placement below, starting from the cell at row $3$, column $2$, the Führer will leave the garden along the red path; starting from row $2$, column $2$, he will keep walking around the blue cycle.\n\n![](https://cdn.luogu.com.cn/upload/pic/12659.png)\n\nMost cells’ markers have already been designed. Characters L, R, U, D denote markers pointing left, right, up, and down, respectively, and the character . denotes an undecided cell. Now, the Führer wants to replace each . with one of L, R, U, D so that starting from any cell in the garden and following the rule above, the walk will eventually leave the garden.\n\nYou need to write a program to count the number of different valid replacements. Two replacements are different if and only if there exists a cell whose marker differs between the two. Since the answer can be large, output the remainder modulo $10^9 + 7$.", "inputFormat": "Read from standard input.\n\nThe first line contains a positive integer $T$ — the number of test cases. Then follow $T$ test cases with no blank lines between them.\n\nLine 1: Two space-separated positive integers $n$, $m$ — the number of rows and columns of the garden.\n\nNext $n$ lines: Each line is a string of length $m$ consisting of characters L, R, U, D, and . — the current state of the garden.", "outputFormat": "Output to standard output.\n\nFor each test case, output one line — the number of valid replacements modulo $10^9 + 7$.", "hint": "Sample explanation.\n\nIn the first test, replacing the only . with R, U, or D all works.\n\nIn the second test, the two . at the top-left and bottom-right can be replaced, respectively, as one of the pairs LR, LU, LD, UR, UU, UD, DR, or DD.\n\nIn the third test, there is no undecided cell, and the original arrangement traps the Führer in an endless cycle, so the answer is $0$. This test matches the example in the Description.\n\nIn the fourth test, there is also no undecided cell, and the original arrangement already satisfies the requirement, so the answer is $1$.\n\nLet $k$ be the total number of undecided cells (those containing .).\n\nFor all test cases, $1 \\le T \\le 10$, $1 \\le n, m \\le 200$, $0 \\le k \\le \\min(nm, 300)$.\n\n![](https://cdn.luogu.com.cn/upload/pic/12660.png)\n\n“... like Stalin.”\n\nThis problem statement is unrelated to historical facts.\n\nFrom CodePlus December 2017 Contest, proudly presented by the Student Association for Algorithms and Competitions, Department of Computer Science and Technology, Tsinghua University.\n\nCredit: idea/吕时清, problem setting/吕时清, verification/王聿中, 杨景钦.\n\nGit Repo: https://git.thusaac.org/publish/CodePlus201712\n\nThanks to Tencent for supporting this contest.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Code+#2] 白金元首与独舞", "background": "```cpp\n到河北省 见斯大林 / 在月光下 你的背影 / 让我们一起跳舞吧\n```\nうそだよ~ 河北省怎么可能有 Stalin。\n\n\n可是…… 可是如果 Stalin 把自己当作炸弹扔到地堡花园里来了呢？\n\n\n怀揣着这份小小的希望，元首 Adolf 独自走进了花园。终有一天会重逢的吧，Stalin。或许是在此处，或许是在遥远的彼方。\n\n\n无论如何，在此之前，好好装点一番花园，编排一段优美的舞步吧！", "description": "元首把花园分为 $n$ 行 $m$ 列的网格。每个格子中都可以放置一个标识，指向上、下、左、右四个方向中的任意一个。元首位于一个格子时，会按照其中标识所指的方向进入周围的格子，或者走出花园（即目的格子不在网格之内）。举个例子 —— 对于下面的放置方式，元首从第 $3$ 行第 $2$ 列的格子开始，会沿着以红色标出的路径走出花园；从第 $2$ 行第 $2$ 列的格子开始，则会在以蓝色标出的环路内不断地行走。\n\n ![](https://cdn.luogu.com.cn/upload/pic/12659.png) \n\n元首已经设计好了大部分格子的标识。元首用字符 L、R、U、D 分别表示指向左、右、上、下四个方向的标识，用字符 . 表示未决定的格子。现在，元首希望将每个 . 替换为 L、R、U、D 中任意一种，使得从花园中的任意一个格子出发，按照上述规则行走，都可以最终走出花园。\n\n\n你需要编写程序帮助元首计算替换的不同方案数。两个方案不同当且仅当存在一个格子，使得两个方案中该格子内的标识不同。当然，由于答案可能很大，只需给出方案数除以 $10^9 + 7$所得的余数即可。", "inputFormat": "从标准输入读入数据。\n\n\n输入的第一行包含一个正整数 $T$ —— 测试数据的组数。接下来包含 $T$ 组测试数据，格式如下，测试数据间没有空行。\n\n\n第 $1$ 行：两个空格分隔的正整数 $n$、$m$ —— 依次表示花园被分成的行数和列数。\n\n接下来 $n$ 行：每行一个长度为 $m$ 的由字符 L、R、U、D 和 . 组成的字符串 —— 表示花园内已经确定的格子状态。", "outputFormat": "输出到标准输出。\n\n\n对于每组测试数据输出一行 —— 满足条件的方案数除以 $10^9 + 7 $所得的余数。", "hint": "**样例解释**\n\n第 $1$ 组数据中，将惟一的 . 替换成 R、U 或 D 均满足要求。\n\n\n第 $2$ 组数据中，将左上方和右下方的两个 . 分别替换成 LR、LU、LD、UR、UU、UD、DR 或 DD 均满足要求。\n\n\n第 $3$ 组数据中，没有待决定的格子，原本的安排会使得元首陷入无尽的环路，故答案为 $0$。该组数据与**题目描述**中的例子相同。\n\n\n第 $4$ 组数据中，也没有待决定的格子，但原本的安排已经满足要求，故答案为 $1$。\n\n\n令 $k$ 表示标记未确定（即包含 `.`）的格子总数。\n\n\n对于所有数据，有 $1 \\leq T \\leq 10$，$1 \\leq n, m \\leq 200$，$0 \\leq k \\leq \\min(nm, 300)$。\n\n ![](https://cdn.luogu.com.cn/upload/pic/12660.png) \n\n“... wie Stalin!”\n\n\n题面与史实无关。\n\n\n来自 CodePlus 2017 12 月赛，清华大学计算机科学与技术系学生算法与竞赛协会 荣誉出品。\n\nCredit：idea/吕时清 命题/吕时清 验题/王聿中，杨景钦\n\nGit Repo：https://git.thusaac.org/publish/CodePlus201712\n\n感谢腾讯公司对此次比赛的支持。", "locale": "zh-CN"}}}
{"pid": "P4034", "type": "P", "difficulty": 6, "samples": [["2 4 3\n1 1 -1\n-1 1 -1\n0 2\n-2 1\n2 1\n0 0", "4.00\n8.50\n8.50\n15.00"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["Code+"], "title": "[Code+#2] 寄蒜几盒", "background": "R姓出题人：第一次出CodePlus月赛，好紧脏，怎么才能装作经常出CodePlus月赛的样子？\n\n\n某W姓出题人：写题面记得要加背景。\n\n\nR姓出题人：可是我的题目没有什么背景可以写，怎么办？\n\n\n某W姓出题人：其实背景和题面没有关系也是可以的。\n\n\nR姓出题人：原来如此，那我知道了。\n", "description": "在二维平面上有$n$条直线，这些直线会将平面划分成若干个区域。给定$m$个点，求每个点所在的区域的面积。\n\n\n聪明的读者会发现有些点所在的区域面积是无穷大的。R姓出题人早就想到了这一点，所以他给出了一个实数$L$，由额外的四条直线$x=L,x=-L,y=L,y=-L$框定了一个有限的平面区域，并且所有的询问点都在这个框定的平面区域内部。\n\n\n聪明绝顶的读者会发现如果询问点恰好落在某条直线上或者离某条直线的距离非常近，那么精度误差会严重影响答案。R姓出题人早就想到了这一点，所以在他造的数据中，任意一个询问点距离任意一条直线的距离大于$10^{-7}$。\n", "inputFormat": "从标准输入读入数据。\n\n\n第一行两个正整数$n,m$和一个正实数$L$。\n\n\n接下来$n$行每行三个实数$A,B,C$，表示这条直线的方程为$Ax+By+C=0$\n\n\n接下来$m$行，第$i$行两个实数$x_i,y_i$，表示第$i$个点的坐标。\n", "outputFormat": "输出到标准输出。\n\n\n输出$m$行，每行一个实数，第iii行输出的实数表示第$i$个点所在的区域的面积。保留两位小数。\n", "hint": "对于$20\\%$的数据，$n,m \\le 10$。\n\n\n对于$40\\%$的数据，$n,m \\le 300$。\n\n\n对于$100\\%$的数据，$n \\le 500,m \\le 100000$。\n\n\n对于$100\\%$的数据，输入数据的绝对值$ \\le 10^7$，且输入数据最多保留两位小数。\n\n\n来自 CodePlus 2017 12 月赛，清华大学计算机科学与技术系学生算法与竞赛协会 荣誉出品。\n\nCredit：idea/茹逸中 命题/茹逸中 验题/陈宇，王聿中\n\nGit Repo：https://git.thusaac.org/publish/CodePlus201712\n\n感谢腾讯公司对此次比赛的支持。\n", "locale": "zh-CN", "translations": {"en": {"title": "[Code+#2] How Many Boxes of Garlic to Ship", "background": "R-surnamed problem setter: It’s my first time hosting a CodePlus monthly contest. I’m so nervous—how can I act like I do CodePlus monthlies all the time?\n\nA certain W-surnamed problem setter: When you write the statement, remember to add a background.\n\nR-surnamed problem setter: But my problem doesn’t really have a background. What should I do?\n\nA certain W-surnamed problem setter: Actually, it’s fine if the background is unrelated to the statement.\n\nR-surnamed problem setter: I see. Got it.", "description": "In the 2D plane, there are $n$ lines that partition the plane into regions. Given $m$ points, find the area of the region that contains each point.\n\nA careful reader will notice that some regions have infinite area. The R-surnamed author has anticipated this and provides a real number $L$. Four extra lines $x = L, x = -L, y = L, y = -L$ bound a finite rectangular area, and all query points lie strictly inside this bounded region.\n\nAn even more careful reader will note that if a query point lies exactly on a line or extremely close to one, numerical error could severely affect the answer. The R-surnamed author has anticipated this as well: in the testdata, the distance from any query point to any line is greater than $10^{-7}$.", "inputFormat": "Read from standard input.\n\nThe first line contains two positive integers $n, m$ and one positive real number $L$.\n\nThe next $n$ lines each contain three real numbers $A, B, C$, indicating a line with equation $Ax + By + C = 0$.\n\nThe next $m$ lines, the $i$-th line contains two real numbers $x_i, y_i$, which are the coordinates of the $i$-th point.", "outputFormat": "Write to standard output.\n\nOutput $m$ lines, each containing one real number. The number on the $i$-th line is the area of the region containing the $i$-th point. Print with two decimal places.", "hint": "For $20\\%$ of the testdata, $n, m \\le 10$.\n\nFor $40\\%$ of the testdata, $n, m \\le 300$.\n\nFor $100\\%$ of the testdata, $n \\le 500, m \\le 100000$.\n\nFor $100\\%$ of the testdata, the absolute value of every input number is $\\le 10^7$, and each input number has at most two decimal places.\n\nFrom the CodePlus 2017 December Contest, proudly presented by the Student Algorithms and Contest Association of the Department of Computer Science and Technology, Tsinghua University.\n\nCredit: idea/Ru Yizhong; setter/Ru Yizhong; testers/Chen Yu, Wang Yuzhong.\n\nGit Repo: https://git.thusaac.org/publish/CodePlus201712\n\nThanks to Tencent for supporting this contest.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Code+#2] 寄蒜几盒", "background": "R姓出题人：第一次出CodePlus月赛，好紧脏，怎么才能装作经常出CodePlus月赛的样子？\n\n\n某W姓出题人：写题面记得要加背景。\n\n\nR姓出题人：可是我的题目没有什么背景可以写，怎么办？\n\n\n某W姓出题人：其实背景和题面没有关系也是可以的。\n\n\nR姓出题人：原来如此，那我知道了。\n", "description": "在二维平面上有$n$条直线，这些直线会将平面划分成若干个区域。给定$m$个点，求每个点所在的区域的面积。\n\n\n聪明的读者会发现有些点所在的区域面积是无穷大的。R姓出题人早就想到了这一点，所以他给出了一个实数$L$，由额外的四条直线$x=L,x=-L,y=L,y=-L$框定了一个有限的平面区域，并且所有的询问点都在这个框定的平面区域内部。\n\n\n聪明绝顶的读者会发现如果询问点恰好落在某条直线上或者离某条直线的距离非常近，那么精度误差会严重影响答案。R姓出题人早就想到了这一点，所以在他造的数据中，任意一个询问点距离任意一条直线的距离大于$10^{-7}$。\n", "inputFormat": "从标准输入读入数据。\n\n\n第一行两个正整数$n,m$和一个正实数$L$。\n\n\n接下来$n$行每行三个实数$A,B,C$，表示这条直线的方程为$Ax+By+C=0$\n\n\n接下来$m$行，第$i$行两个实数$x_i,y_i$，表示第$i$个点的坐标。\n", "outputFormat": "输出到标准输出。\n\n\n输出$m$行，每行一个实数，第iii行输出的实数表示第$i$个点所在的区域的面积。保留两位小数。\n", "hint": "对于$20\\%$的数据，$n,m \\le 10$。\n\n\n对于$40\\%$的数据，$n,m \\le 300$。\n\n\n对于$100\\%$的数据，$n \\le 500,m \\le 100000$。\n\n\n对于$100\\%$的数据，输入数据的绝对值$ \\le 10^7$，且输入数据最多保留两位小数。\n\n\n来自 CodePlus 2017 12 月赛，清华大学计算机科学与技术系学生算法与竞赛协会 荣誉出品。\n\nCredit：idea/茹逸中 命题/茹逸中 验题/陈宇，王聿中\n\nGit Repo：https://git.thusaac.org/publish/CodePlus201712\n\n感谢腾讯公司对此次比赛的支持。\n", "locale": "zh-CN"}}}
{"pid": "P4035", "type": "P", "difficulty": 5, "samples": [["2\n0.0 0.0\n-1.0 1.0\n1.0 0.0", "0.500 1.500"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2008", "各省省选", "江苏", "模拟退火", "高斯消元", "构造"], "title": "[JSOI2008] 球形空间产生器", "background": "", "description": "有一个球形空间产生器能够在 $n$ 维空间中产生一个坚硬的球体。现在，你被困在了这个 $n$ 维球体中，你只知道球面上 $n+1$ 个点的坐标，你需要以最快的速度确定这个 $n$ 维球体的球心坐标，以便于摧毁这个球形空间产生器。", "inputFormat": "第一行是一个整数 $n$ $(1\\le N\\le 10)$。接下来的 $n+1$ 行，每行有 $n$ 个实数，表示球面上一点的 $n$ 维坐标。每一个实数精确到小数点后 $6$ 位，且其绝对值都不超过 $20000$。", "outputFormat": "有且只有一行，依次给出球心的 $n$ 维坐标（ $n$ 个实数），两个实数之间用一个空格隔开。每个实数精确到小数点后 $3$ 位。数据保证有解。你的答案必须和标准输出一模一样才能够得分。", "hint": "提示：给出两个定义：\n\n1. 球心：到球面上任意一点距离都相等的点。\n2. 距离：设两个 $n$ 维空间上的点 $A,B$ 的坐标为 $(a_1, a_2, \\cdots , a_n), (b_1, b_2, \\cdots , b_n)$，则 $A,B$ 的距离定义为：$dist = \\sqrt{ (a_1-b_1)^2 + (a_2-b_2)^2 + \\cdots + (a_n-b_n)^2 }$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2008] Spherical Space Generator", "background": "", "description": "There is a spherical space generator that can create a rigid sphere in $n$-dimensional space. Now you are trapped inside this $n$-dimensional sphere. You only know the coordinates of $n+1$ points on the sphere, and you need to determine the coordinates of the center of this $n$-dimensional sphere as quickly as possible in order to destroy the spherical space generator.", "inputFormat": "The first line contains an integer $n$ ($1 \\le n \\le 10$). The next $n+1$ lines each contain $n$ real numbers, representing the $n$-dimensional coordinates of a point on the sphere. Each real number is given to $6$ decimal places, and its absolute value does not exceed $20000$.", "outputFormat": "Output exactly one line containing the $n$ coordinates of the center (i.e., $n$ real numbers), separated by a single space. Each real number must be printed to $3$ decimal places. It is guaranteed that a solution exists. Your answer must be exactly the same as the standard output to receive points.", "hint": "Hint: Two definitions are given:\n\n1. Center: a point whose distances to all points on the sphere are equal.\n2. Distance: let two points $A, B$ in $n$-dimensional space have coordinates $(a_1, a_2, \\cdots, a_n), (b_1, b_2, \\cdots, b_n)$. The distance between $A$ and $B$ is defined as $dist = \\sqrt{ (a_1-b_1)^2 + (a_2-b_2)^2 + \\cdots + (a_n-b_n)^2 }$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2008] 球形空间产生器", "background": "", "description": "有一个球形空间产生器能够在 $n$ 维空间中产生一个坚硬的球体。现在，你被困在了这个 $n$ 维球体中，你只知道球面上 $n+1$ 个点的坐标，你需要以最快的速度确定这个 $n$ 维球体的球心坐标，以便于摧毁这个球形空间产生器。", "inputFormat": "第一行是一个整数 $n$ $(1\\le N\\le 10)$。接下来的 $n+1$ 行，每行有 $n$ 个实数，表示球面上一点的 $n$ 维坐标。每一个实数精确到小数点后 $6$ 位，且其绝对值都不超过 $20000$。", "outputFormat": "有且只有一行，依次给出球心的 $n$ 维坐标（ $n$ 个实数），两个实数之间用一个空格隔开。每个实数精确到小数点后 $3$ 位。数据保证有解。你的答案必须和标准输出一模一样才能够得分。", "hint": "提示：给出两个定义：\n\n1. 球心：到球面上任意一点距离都相等的点。\n2. 距离：设两个 $n$ 维空间上的点 $A,B$ 的坐标为 $(a_1, a_2, \\cdots , a_n), (b_1, b_2, \\cdots , b_n)$，则 $A,B$ 的距离定义为：$dist = \\sqrt{ (a_1-b_1)^2 + (a_2-b_2)^2 + \\cdots + (a_n-b_n)^2 }$。\n", "locale": "zh-CN"}}}
{"pid": "P4036", "type": "P", "difficulty": 6, "samples": [["madamimadam\n7\nQ 1 7\nQ 4 8\nQ 10 11\nR 3 a\nQ 1 7\nI 10 a\nQ 2 11", "5\n1\n0\n2\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["字符串", "2008", "各省省选", "平衡树", "江苏", "哈希 hashing"], "title": "[JSOI2008] 火星人", "background": "", "description": "火星人最近研究了一种操作：求一个字串两个后缀的公共前缀。\n\n比方说，有这样一个字符串：madamimadam，我们将这个字符串的各个字符予以标号：\n```\n序号 1 2 3 4 5 6 7 8 9 10 11 \n字符 m a d a m i m a d a m\n```\n现在，火星人定义了一个函数 $LCQ(x, y)$，表示：该字符串中第 $x$ 个字符开始的字串，与该字符串中第 $y$ 个字符开始的字串，两个字串的公共前缀的长度。比方说，$LCQ(1, 7) = 5, LCQ(2, 10) = 1, LCQ(4, 7) = 0$\n\n在研究 $LCQ$ 函数的过程中，火星人发现了这样的一个关联：如果把该字符串的所有后缀排好序，就可以很快地求出 $LCQ$ 函数的值；同样，如果求出了 $LCQ$ 函数的值，也可以很快地将该字符串的后缀排好序。\n\n尽管火星人聪明地找到了求取 $LCQ$ 函数的快速算法，但不甘心认输的地球人又给火星人出了个难题：在求取 $LCQ$ 函数的同时，还可以改变字符串本身。具体地说，可以更改字符串中某一个字符的值，也可以在字符串中的某一个位置插入一个字符。地球人想考验一下，在如此复杂的问题中，火星人是否还能够做到很快地求取 $LCQ$ 函数的值。", "inputFormat": "第一行给出初始的字符串。第二行是一个非负整数 $M$ ，表示操作的个数。接下来的M行，每行描述一个操作。操作有 $3$ 种，如下所示\n\n1. 询问。语法：$Q$ $x$ $y$ ，$x$ ,$y$ 均为正整数。功能：计算 $LCQ(x,y)$ 限制：$1$ $\\leq$ $x$ , $y$ $\\leq$ 当前字符串长度 。\n2. 修改。语法：$R$ $x$ $d$，$x$ 是正整数，$d$ 是字符。功能：将字符串中第 $x$ 个数修改为字符 $d$ 。限制：$x$ 不超过当前字符串长度。\n3. 插入：语法：$I$ $x$ $d$ ，$x$ 是非负整数，$d$ 是字符。功能：在字符串第 $x$ 个字符之后插入字符 $d$ ，如果 $x=0$，则在字符串开头插入。限制：$x$ 不超过当前字符串长度", "outputFormat": "对于输入文件中每一个询问操作，你都应该输出对应的答案。一个答案一行。", "hint": "1. 所有字符串自始至终都只有小写字母构成。\n2. $M\\leq150,000$\n3. 字符串长度L自始至终都满足$L\\leq100,000$\n4. 询问操作的个数不超过 $10,000$ 个。\n\n对于第 $1$，$2$ 个数据，字符串长度自始至终都不超过 $1,000$\n对于第 $3$，$4$，$5$ 个数据，没有插入操作。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2008] Martians", "background": "", "description": "Martians have recently been studying an operation: finding the common prefix of two suffixes of a string.\n\nFor example, consider this string: madamimadam. We label its characters as follows:\n```\n序号 1 2 3 4 5 6 7 8 9 10 11 \n字符 m a d a m i m a d a m\n```\nNow, Martians define a function $LCQ(x, y)$, which means: the length of the common prefix between the substring starting at the $x$-th character and the substring starting at the $y$-th character of the string. For example, $LCQ(1, 7) = 5, LCQ(2, 10) = 1, LCQ(4, 7) = 0$.\n\nIn the process of studying the $LCQ$ function, Martians found a connection: if you sort all suffixes of the string, you can quickly compute the value of $LCQ$; likewise, if you know the values of $LCQ$, you can quickly sort the suffixes of the string.\n\nAlthough Martians cleverly discovered a fast algorithm for computing $LCQ$, the unyielding Earthlings posed a new challenge: while computing $LCQ$, the string itself may change. Specifically, you may change the value of a character in the string, or insert a character at some position in the string. The Earthlings want to test whether Martians can still compute $LCQ$ quickly under such a complex scenario.", "inputFormat": "The first line gives the initial string. The second line is a non-negative integer $M$, the number of operations. The next M lines each describe one operation. There are 3 types of operations:\n\n1. Query. Syntax: $Q$ $x$ $y$, where $x$, $y$ are positive integers. Function: compute $LCQ(x, y)$. Constraint: $1 \\leq x, y \\leq$ current string length.\n2. Modify. Syntax: $R$ $x$ $d$, where $x$ is a positive integer and $d$ is a character. Function: replace the $x$-th character of the string with $d$. Constraint: $x$ does not exceed the current string length.\n3. Insert. Syntax: $I$ $x$ $d$, where $x$ is a non-negative integer and $d$ is a character. Function: insert character $d$ after the $x$-th character of the string; if $x=0$, insert at the beginning of the string. Constraint: $x$ does not exceed the current string length.", "outputFormat": "For each query operation in the input, output the corresponding answer, one per line.", "hint": "1. All strings always consist of lowercase letters only.\n2. $M\\leq150,000$\n3. The string length $L$ always satisfies $L\\leq100,000$.\n4. The number of query operations does not exceed $10,000$.\n\nFor testdata 1 and 2, the string length never exceeds $1,000$.\nFor testdata 3, 4, and 5, there are no insert operations.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2008] 火星人", "background": "", "description": "火星人最近研究了一种操作：求一个字串两个后缀的公共前缀。\n\n比方说，有这样一个字符串：madamimadam，我们将这个字符串的各个字符予以标号：\n```\n序号 1 2 3 4 5 6 7 8 9 10 11 \n字符 m a d a m i m a d a m\n```\n现在，火星人定义了一个函数 $LCQ(x, y)$，表示：该字符串中第 $x$ 个字符开始的字串，与该字符串中第 $y$ 个字符开始的字串，两个字串的公共前缀的长度。比方说，$LCQ(1, 7) = 5, LCQ(2, 10) = 1, LCQ(4, 7) = 0$\n\n在研究 $LCQ$ 函数的过程中，火星人发现了这样的一个关联：如果把该字符串的所有后缀排好序，就可以很快地求出 $LCQ$ 函数的值；同样，如果求出了 $LCQ$ 函数的值，也可以很快地将该字符串的后缀排好序。\n\n尽管火星人聪明地找到了求取 $LCQ$ 函数的快速算法，但不甘心认输的地球人又给火星人出了个难题：在求取 $LCQ$ 函数的同时，还可以改变字符串本身。具体地说，可以更改字符串中某一个字符的值，也可以在字符串中的某一个位置插入一个字符。地球人想考验一下，在如此复杂的问题中，火星人是否还能够做到很快地求取 $LCQ$ 函数的值。", "inputFormat": "第一行给出初始的字符串。第二行是一个非负整数 $M$ ，表示操作的个数。接下来的M行，每行描述一个操作。操作有 $3$ 种，如下所示\n\n1. 询问。语法：$Q$ $x$ $y$ ，$x$ ,$y$ 均为正整数。功能：计算 $LCQ(x,y)$ 限制：$1$ $\\leq$ $x$ , $y$ $\\leq$ 当前字符串长度 。\n2. 修改。语法：$R$ $x$ $d$，$x$ 是正整数，$d$ 是字符。功能：将字符串中第 $x$ 个数修改为字符 $d$ 。限制：$x$ 不超过当前字符串长度。\n3. 插入：语法：$I$ $x$ $d$ ，$x$ 是非负整数，$d$ 是字符。功能：在字符串第 $x$ 个字符之后插入字符 $d$ ，如果 $x=0$，则在字符串开头插入。限制：$x$ 不超过当前字符串长度", "outputFormat": "对于输入文件中每一个询问操作，你都应该输出对应的答案。一个答案一行。", "hint": "1. 所有字符串自始至终都只有小写字母构成。\n2. $M\\leq150,000$\n3. 字符串长度L自始至终都满足$L\\leq100,000$\n4. 询问操作的个数不超过 $10,000$ 个。\n\n对于第 $1$，$2$ 个数据，字符串长度自始至终都不超过 $1,000$\n对于第 $3$，$4$，$5$ 个数据，没有插入操作。", "locale": "zh-CN"}}}
{"pid": "P4037", "type": "P", "difficulty": 6, "samples": [["10 59\n5 A 3 6 1 9 2 10 1\n1 B 5 3\n1 B 4 3\n1 B 2 3\n8 A 3 2 1 3 1 7 1\n1 B 5 3\n5 B 3 3\n15 A 3 1 1 5 1 4 1\n1 B 3 5\n1 B 4 3", "33"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2008", "各省省选", "江苏", "O2优化", "枚举", "背包 DP"], "title": "[JSOI2008] 魔兽地图", "background": "本题疑似错题，不保证存在算法能通过该数据范围下的所有数据。目前所有题解的复杂度都是错误的，且绝大部分能被 https://www.luogu.com.cn/discuss/1112812 中的 Hack 卡掉。", "description": "DotR (Defense of the Robots) Allstars 是一个风靡全球的魔兽地图，他的规则简单与同样流行的地图 DotA (Defense of the Ancients) Allstars。\n\nDotR 里面的英雄只有一个属性——力量。他们需要购买装备来提升自己的力量值，每件装备都可以使佩戴它的英雄的力量值提高固定的点数，所以英雄的力量值等于它购买的所有装备的力量值之和。装备分为基本装备和高级装备两种。基本装备可以直接从商店里面用金币购买，而高级装备需要用基本装备或者较低级的高级装备来合成，合成不需要附加的金币。装备的合成路线可以用一棵树来表示。\n\n比如，Sange and Yasha 的合成需要 Sange，Yasha 和 Sange and Yasha Recipe Scroll 三样物品。其中 Sange 又要用 Ogre Axe，Belt of Giant Strength 和 Sange Recipe Scroll 合成。每件基本装备都有数量限制，这限制了你不能无限制地合成某些性价比很高的装备。\n\n现在，英雄 Spectre 有 $M$ 个金币，他想用这些钱购买装备使自己的力量值尽量高。你能帮帮他吗？他会教你魔法 Haunt（幽灵附体）作为回报的。", "inputFormat": "第一行包含两个整数，$N(1\\le N\\le 51)$ 和 $M(0\\le M\\le  2000)$。分别表示装备的种类数和金币数。装备用 $1$ 到 $N$ 的整数编号。\n\n接下来的 $N$ 行，按照装备 $1$ 到装备 $N$ 的顺序，每行描述一种装备。\n\n每一行的第一个非负整数表示这个装备贡献的力量值。\n\n接下来的非空字符表示这种装备是基本装备还是高级装备，A 表示高级装备，B 表示基本装备。如果是基本装备，紧接着的两个正整数分别表示它的单价（单位为金币）和数量限制（不超过 $100$）。如果是高级装备，后面紧跟着一个正整数 $C$，表示这个高级装备需要 $C$ 种低级装备。后面的 $2C$ 个数，依次描述某个低级装备的种类和需要的个数。", "outputFormat": "第一行包含一个整数 $S$，表示最多可以提升多少点力量值。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2008] Warcraft Map", "background": "This problem is suspected to be flawed, and there is no guarantee that any algorithm can pass all testdata under these constraints. The time complexity of all existing solutions is incorrect, and most of them can be hacked by the cases in https://www.luogu.com.cn/discuss/1112812.", "description": "DotR (Defense of the Robots) Allstars is a globally popular Warcraft map. Its rules are simple, similar to the also popular map DotA (Defense of the Ancients) Allstars.\n\nIn DotR, heroes have only one attribute — Strength. They need to buy equipment to improve their Strength. Each piece of equipment increases the hero’s Strength by a fixed amount, so the hero’s Strength equals the sum of the Strength values of all purchased equipment. There are two types of equipment: basic equipment and advanced equipment. Basic equipment can be purchased directly from the shop with gold, while advanced equipment must be crafted from basic equipment or lower-tier advanced equipment. Crafting requires no additional gold. The crafting dependency can be represented by a tree.\n\nFor example, Sange and Yasha is crafted from Sange, Yasha, and a Sange and Yasha Recipe Scroll. Sange itself is crafted from an Ogre Axe, a Belt of Giant Strength, and a Sange Recipe Scroll. Each basic equipment has a stock limit, which prevents you from crafting certain high cost-performance equipment infinitely.\n\nNow, the hero Spectre has $M$ gold coins and wants to buy equipment to maximize his Strength. Can you help him? He will teach you the spell Haunt (幽灵附体) as a reward.\n\n# Description", "inputFormat": "The first line contains two integers, $N$ ($1 \\le N \\le 51$) and $M$ ($0 \\le M \\le 2000$), representing the number of equipment types and the amount of gold, respectively. Equipment are numbered from $1$ to $N$.\n\nThe next $N$ lines, in the order of equipment $1$ to equipment $N$, each describe one equipment.\n\n- The first nonnegative integer on each line is the Strength contributed by this equipment.\n- The next character indicates whether this equipment is basic or advanced: A denotes advanced equipment, B denotes basic equipment.\n  - If it is basic equipment, it is followed by two positive integers: its unit price (in gold) and its stock limit (no more than $100$).\n  - If it is advanced equipment, it is followed by a positive integer $C$, indicating that this advanced equipment requires $C$ types of lower-tier equipment. The next $2C$ integers then describe, in order, for each lower-tier equipment, its type and the required quantity.", "outputFormat": "Output a single integer $S$, the maximum total Strength that can be achieved.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2008] 魔兽地图", "background": "本题疑似错题，不保证存在算法能通过该数据范围下的所有数据。目前所有题解的复杂度都是错误的，且绝大部分能被 https://www.luogu.com.cn/discuss/1112812 中的 Hack 卡掉。", "description": "DotR (Defense of the Robots) Allstars 是一个风靡全球的魔兽地图，他的规则简单与同样流行的地图 DotA (Defense of the Ancients) Allstars。\n\nDotR 里面的英雄只有一个属性——力量。他们需要购买装备来提升自己的力量值，每件装备都可以使佩戴它的英雄的力量值提高固定的点数，所以英雄的力量值等于它购买的所有装备的力量值之和。装备分为基本装备和高级装备两种。基本装备可以直接从商店里面用金币购买，而高级装备需要用基本装备或者较低级的高级装备来合成，合成不需要附加的金币。装备的合成路线可以用一棵树来表示。\n\n比如，Sange and Yasha 的合成需要 Sange，Yasha 和 Sange and Yasha Recipe Scroll 三样物品。其中 Sange 又要用 Ogre Axe，Belt of Giant Strength 和 Sange Recipe Scroll 合成。每件基本装备都有数量限制，这限制了你不能无限制地合成某些性价比很高的装备。\n\n现在，英雄 Spectre 有 $M$ 个金币，他想用这些钱购买装备使自己的力量值尽量高。你能帮帮他吗？他会教你魔法 Haunt（幽灵附体）作为回报的。", "inputFormat": "第一行包含两个整数，$N(1\\le N\\le 51)$ 和 $M(0\\le M\\le  2000)$。分别表示装备的种类数和金币数。装备用 $1$ 到 $N$ 的整数编号。\n\n接下来的 $N$ 行，按照装备 $1$ 到装备 $N$ 的顺序，每行描述一种装备。\n\n每一行的第一个非负整数表示这个装备贡献的力量值。\n\n接下来的非空字符表示这种装备是基本装备还是高级装备，A 表示高级装备，B 表示基本装备。如果是基本装备，紧接着的两个正整数分别表示它的单价（单位为金币）和数量限制（不超过 $100$）。如果是高级装备，后面紧跟着一个正整数 $C$，表示这个高级装备需要 $C$ 种低级装备。后面的 $2C$ 个数，依次描述某个低级装备的种类和需要的个数。", "outputFormat": "第一行包含一个整数 $S$，表示最多可以提升多少点力量值。", "hint": "", "locale": "zh-CN"}}}
