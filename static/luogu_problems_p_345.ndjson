{"pid": "P7991", "type": "P", "difficulty": 4, "samples": [["2\n5 2\n1 2\n4 5\n5 3\n1 2\n2 3\n4 5", "2\n1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["二分", "USACO", "并查集", "2021"], "title": "[USACO21DEC] Connecting Two Barns S", "background": "", "description": "Farmer John 的农场由 $N$ 块田地（$1 \\leq N \\leq 10^5$）组成，编号为 $1 \\ldots N$。在这些田地之间有 $M$ 条双向道路（$0 \\leq M \\leq 10^5$），每条道路连接两块田地。\n\n农场有两个牛棚，一个在田地 1 中，另一个在田地 $N$ 中。Farmer John 希望确保有一种方式可以沿着一组道路在两个牛棚之间行走。 他愿意建造至多两条新道路来实现这一目标。由于田地的位置因素，在田地 $i$ 和 $j$ 之间建造新道路的花费是 $(i-j)^2$。\n\n请帮助 Farmer John 求出使得牛棚 $1$ 和 $N$ 可以相互到达所需要的最小花费。", "inputFormat": "每个测试用例的输入包含 $T$ 个子测试用例（$1\\le T\\le 20$），所有子测试用例必须全部回答正确才能通过整个测试用例。\n\n输入的第一行包含 $T$，之后是 $T$ 个子测试用例。\n\n每个子测试用例的第一行包含两个整数 $N$ 和 $M$。以下 $M$ 行，每行包含两个整数 $i$ 和 $j$，表示一条连接两个不同田地 $i$ 和 $j$ 的道路。输入保证任何两个田地之间至多只有一条道路，并且所有子测试用例的 $N+M$ 之和不超过 $5 \\cdot 10^5$。\n", "outputFormat": "输出 $T$ 行。第 $i$ 行包含一个整数，为第 $i$ 个子测试用例的最小花费。", "hint": "【样例解释】\n\n- 第一个子测试用例中，最优的方式是用一条道路连接田地 2 和 3，用一条道路连接田地 3 和 4。\n- 第二个子测试用例中，最优的方式是用一条道路连接田地 3 和 4。不需要第二条道路。\n\n【数据范围】\n\n- 测试点 2 满足 $N \\le 20$。\n- 测试点 3-5 满足 $N \\le 10^3$。\n- 测试点 6-10 没有额外限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21DEC] Connecting Two Barns S", "background": "", "description": "Farmer John 的农场由 $N$ 块田地（$1 \\leq N \\leq 10^5$）组成，编号为 $1 \\ldots N$。在这些田地之间有 $M$ 条双向道路（$0 \\leq M \\leq 10^5$），每条道路连接两块田地。\n\n农场有两个牛棚，一个在田地 1 中，另一个在田地 $N$ 中。Farmer John 希望确保有一种方式可以沿着一组道路在两个牛棚之间行走。 他愿意建造至多两条新道路来实现这一目标。由于田地的位置因素，在田地 $i$ 和 $j$ 之间建造新道路的花费是 $(i-j)^2$。\n\n请帮助 Farmer John 求出使得牛棚 $1$ 和 $N$ 可以相互到达所需要的最小花费。", "inputFormat": "每个测试用例的输入包含 $T$ 个子测试用例（$1\\le T\\le 20$），所有子测试用例必须全部回答正确才能通过整个测试用例。\n\n输入的第一行包含 $T$，之后是 $T$ 个子测试用例。\n\n每个子测试用例的第一行包含两个整数 $N$ 和 $M$。以下 $M$ 行，每行包含两个整数 $i$ 和 $j$，表示一条连接两个不同田地 $i$ 和 $j$ 的道路。输入保证任何两个田地之间至多只有一条道路，并且所有子测试用例的 $N+M$ 之和不超过 $5 \\cdot 10^5$。\n", "outputFormat": "输出 $T$ 行。第 $i$ 行包含一个整数，为第 $i$ 个子测试用例的最小花费。", "hint": "【样例解释】\n\n- 第一个子测试用例中，最优的方式是用一条道路连接田地 2 和 3，用一条道路连接田地 3 和 4。\n- 第二个子测试用例中，最优的方式是用一条道路连接田地 3 和 4。不需要第二条道路。\n\n【数据范围】\n\n- 测试点 2 满足 $N \\le 20$。\n- 测试点 3-5 满足 $N \\le 10^3$。\n- 测试点 6-10 没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P7992", "type": "P", "difficulty": 3, "samples": [["2 5\n1 3\n2 5", "0\n0\n1\n3\n4\n4\n4\n3\n3\n1\n1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "USACO", "2021", "前缀和", "差分"], "title": "[USACO21DEC]  Convoluted Intervals S", "background": "", "description": "奶牛们正在努力尝试发明有趣的新游戏来玩。他们目前的工作之一与一组 $N$ 个区间（$1\\le N\\le 2\\cdot 10^5$）有关，其中第 $i$ 个区间从数轴上的 $a_i$ 位置开始，并在位置 $b_i \\geq a_i$ 结束。$a_i$ 和 $b_i$ 均为 $0 \\ldots M$ 范围内的整数，其中 $1 \\leq M \\leq 5000$。\n\n这个游戏的玩法是，Bessie 选择某个区间（假设是第 $i$ 个区间），而她的表妹 Elsie 选择某个区间（假设是第 $j$ 个区间，可能与 Bessie 所选的的区间相同）。给定某个值 $k$，如果 $a_i + a_j \\leq k \\leq b_i + b_j$，则她们获胜。\n\n对范围 $0 \\ldots 2M$ 内的每个值 $k$，请计算使得 Bessie 和 Elsie 可以赢得游戏的有序对 $(i,j)$ 的数量。", "inputFormat": "输入的第一行包含 $N$ 和 $M$。以下 $N$ 行每行以整数 $a_i$ 和 $b_i$ 的形式描述一个区间。", "outputFormat": "输出 $2M+1$ 行，依次包含范围 $0 \\ldots 2M$ 中的每一个 $k$ 的答案。", "hint": "【样例解释】\n\n在这个例子中，对于 $k=3$，有三个有序对可以使得 Bessie 和 Elsie 获胜：$(1, 1)$，$(1, 2)$，和 $(2, 1)$。\n\n【数据范围】\n\n- 测试点 1-2 满足 $N\\le 100, M\\le 100$。\n- 测试点 3-5 满足 $N\\le 5000$。\n- 测试点 6-20 没有额外限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21DEC]  Convoluted Intervals S", "background": "", "description": "奶牛们正在努力尝试发明有趣的新游戏来玩。他们目前的工作之一与一组 $N$ 个区间（$1\\le N\\le 2\\cdot 10^5$）有关，其中第 $i$ 个区间从数轴上的 $a_i$ 位置开始，并在位置 $b_i \\geq a_i$ 结束。$a_i$ 和 $b_i$ 均为 $0 \\ldots M$ 范围内的整数，其中 $1 \\leq M \\leq 5000$。\n\n这个游戏的玩法是，Bessie 选择某个区间（假设是第 $i$ 个区间），而她的表妹 Elsie 选择某个区间（假设是第 $j$ 个区间，可能与 Bessie 所选的的区间相同）。给定某个值 $k$，如果 $a_i + a_j \\leq k \\leq b_i + b_j$，则她们获胜。\n\n对范围 $0 \\ldots 2M$ 内的每个值 $k$，请计算使得 Bessie 和 Elsie 可以赢得游戏的有序对 $(i,j)$ 的数量。", "inputFormat": "输入的第一行包含 $N$ 和 $M$。以下 $N$ 行每行以整数 $a_i$ 和 $b_i$ 的形式描述一个区间。", "outputFormat": "输出 $2M+1$ 行，依次包含范围 $0 \\ldots 2M$ 中的每一个 $k$ 的答案。", "hint": "【样例解释】\n\n在这个例子中，对于 $k=3$，有三个有序对可以使得 Bessie 和 Elsie 获胜：$(1, 1)$，$(1, 2)$，和 $(2, 1)$。\n\n【数据范围】\n\n- 测试点 1-2 满足 $N\\le 100, M\\le 100$。\n- 测试点 3-5 满足 $N\\le 5000$。\n- 测试点 6-20 没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P7993", "type": "P", "difficulty": 2, "samples": [["5\nGHGHG", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "USACO", "2021"], "title": "[USACO21DEC] Lonely Photo B", "background": "", "description": "Farmer John 最近购入了 $N$ 头新的奶牛（$3 \\le N \\le 5 \\times 10^5$），每头奶牛的品种是更赛牛（Guernsey）或荷斯坦牛（Holstein）之一。 \n\n奶牛目前排成一排，Farmer John 想要为每个连续不少于三头奶牛的序列拍摄一张照片。 然而，他不想拍摄这样的照片，其中只有一头牛的品种是更赛牛，或者只有一头牛的品种是荷斯坦牛——他认为这头奇特的牛会感到孤立和不自然。 在为每个连续不少于三头奶牛的序列拍摄了一张照片后，他把所有「孤独的」照片，即其中只有一头更赛牛或荷斯坦奶牛的照片，都扔掉了。\n\n给定奶牛的排列方式，请帮助 Farmer John 求出他会扔掉多少张孤独的照片。如果两张照片以不同的奶牛开始或结束，则认为它们是不同的。\n", "inputFormat": "输入的第一行包含 $N$。\n\n输入的第二行包含一个长为 $N$ 的字符串。如果队伍中的第 $i$ 头奶牛是更赛牛，则字符串的第 $i$ 个字符为 G。否则，第 $i$ 头奶牛是荷斯坦牛，该字符为 H。", "outputFormat": "输出 Farmer John 会扔掉的孤独的照片数量。", "hint": "【样例解释】\n\n这个例子中的每一个长为 3 的子串均恰好包含一头更赛牛或荷斯坦牛——所以这些子串表示孤独的照片，并会被 Farmer John 扔掉。所有更长的子串（GHGH、HGHG 和 GHGHG）都可以被接受。\n\n【数据范围】\n\n- 测试点 2-4 满足 $N \\le 50$。\n- 测试点 5-10 满足 $N \\le 5000$。\n- 测试点 11 没有额外限制。\n\n注意这个测试点的答案可能无法用标准的 32 位整数型存储，你可能需要使用更大的整数类型（例如，C++ 中 64 位的 \"long long int\" 类型）。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21DEC] Lonely Photo B", "background": "", "description": "Farmer John 最近购入了 $N$ 头新的奶牛（$3 \\le N \\le 5 \\times 10^5$），每头奶牛的品种是更赛牛（Guernsey）或荷斯坦牛（Holstein）之一。 \n\n奶牛目前排成一排，Farmer John 想要为每个连续不少于三头奶牛的序列拍摄一张照片。 然而，他不想拍摄这样的照片，其中只有一头牛的品种是更赛牛，或者只有一头牛的品种是荷斯坦牛——他认为这头奇特的牛会感到孤立和不自然。 在为每个连续不少于三头奶牛的序列拍摄了一张照片后，他把所有「孤独的」照片，即其中只有一头更赛牛或荷斯坦奶牛的照片，都扔掉了。\n\n给定奶牛的排列方式，请帮助 Farmer John 求出他会扔掉多少张孤独的照片。如果两张照片以不同的奶牛开始或结束，则认为它们是不同的。\n", "inputFormat": "输入的第一行包含 $N$。\n\n输入的第二行包含一个长为 $N$ 的字符串。如果队伍中的第 $i$ 头奶牛是更赛牛，则字符串的第 $i$ 个字符为 G。否则，第 $i$ 头奶牛是荷斯坦牛，该字符为 H。", "outputFormat": "输出 Farmer John 会扔掉的孤独的照片数量。", "hint": "【样例解释】\n\n这个例子中的每一个长为 3 的子串均恰好包含一头更赛牛或荷斯坦牛——所以这些子串表示孤独的照片，并会被 Farmer John 扔掉。所有更长的子串（GHGH、HGHG 和 GHGHG）都可以被接受。\n\n【数据范围】\n\n- 测试点 2-4 满足 $N \\le 50$。\n- 测试点 5-10 满足 $N \\le 5000$。\n- 测试点 11 没有额外限制。\n\n注意这个测试点的答案可能无法用标准的 32 位整数型存储，你可能需要使用更大的整数类型（例如，C++ 中 64 位的 \"long long int\" 类型）。", "locale": "zh-CN"}}}
{"pid": "P7994", "type": "P", "difficulty": 3, "samples": [["5\n1 5 3 3 4\n1 2 2 2 1", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["贪心", "USACO", "2021"], "title": "[USACO21DEC] Air Cownditioning B", "background": "", "description": "Farmer John 的 $N$ 头奶牛对他们牛棚的室温非常挑剔。有些奶牛喜欢温度低一些，而有些奶牛则喜欢温度高一些。\n\nFarmer John 的牛棚包含一排 $N$ 个牛栏，编号为 $1 \\ldots N$，每个牛栏里有一头牛。 第 $i$ 头奶牛希望她的牛栏中的温度是 $p_i$，而现在她的牛栏中的温度是 $t_i$。为了确保每头奶牛都感到舒适，Farmer John 安装了一个新的空调系统。该系统进行控制的方式非常有趣，他可以向系统发送命令，告诉它将一组连续的牛栏内的温度升高或降低 1 个单位——例如「将牛栏 $5 \\ldots 8$ 的温度升高 1 个单位」。一组连续的牛栏最短可以仅包含一个牛栏。\n\n请帮助 Farmer John 求出他需要向新的空调系统发送的命令的最小数量，使得每头奶牛的牛栏都处于其中的奶牛的理想温度。", "inputFormat": "输入的第一行包含 $N$。下一行包含 $N$ 个非负整数 $p_1 \\ldots p_N$，用空格分隔。最后一行包含 $N$ 个非负整数 $t_1 \\ldots t_N$。", "outputFormat": "输出一个整数，为 Farmer John 需要使用的最小指令数量。", "hint": "【样例解释】\n\n一组最优的 Farmer John 可以使用的指令如下：\n\n```\n初始温度     ：1 2 2 2 1\n升高牛棚 2..5：1 3 3 3 2\n升高牛棚 2..5：1 4 4 4 3\n升高牛棚 2..5：1 5 5 5 4\n降低牛棚 3..4：1 5 4 4 4\n降低牛棚 3..4：1 5 3 3 4\n```\n\n【数据范围】\n\n- 测试点 2-5 满足 $N \\leq 100$。\n- 测试点 6-8 满足 $N \\leq 1000$。\n- 测试点 9-10 满足 $N \\leq 100,000$\n- 测试点 1-6 和 9 中，温度值不超过 $100$\n- 测试点 7-8 和 10 中，温度值不超过 $10,000$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21DEC] Air Cownditioning B", "background": "", "description": "Farmer John 的 $N$ 头奶牛对他们牛棚的室温非常挑剔。有些奶牛喜欢温度低一些，而有些奶牛则喜欢温度高一些。\n\nFarmer John 的牛棚包含一排 $N$ 个牛栏，编号为 $1 \\ldots N$，每个牛栏里有一头牛。 第 $i$ 头奶牛希望她的牛栏中的温度是 $p_i$，而现在她的牛栏中的温度是 $t_i$。为了确保每头奶牛都感到舒适，Farmer John 安装了一个新的空调系统。该系统进行控制的方式非常有趣，他可以向系统发送命令，告诉它将一组连续的牛栏内的温度升高或降低 1 个单位——例如「将牛栏 $5 \\ldots 8$ 的温度升高 1 个单位」。一组连续的牛栏最短可以仅包含一个牛栏。\n\n请帮助 Farmer John 求出他需要向新的空调系统发送的命令的最小数量，使得每头奶牛的牛栏都处于其中的奶牛的理想温度。", "inputFormat": "输入的第一行包含 $N$。下一行包含 $N$ 个非负整数 $p_1 \\ldots p_N$，用空格分隔。最后一行包含 $N$ 个非负整数 $t_1 \\ldots t_N$。", "outputFormat": "输出一个整数，为 Farmer John 需要使用的最小指令数量。", "hint": "【样例解释】\n\n一组最优的 Farmer John 可以使用的指令如下：\n\n```\n初始温度     ：1 2 2 2 1\n升高牛棚 2..5：1 3 3 3 2\n升高牛棚 2..5：1 4 4 4 3\n升高牛棚 2..5：1 5 5 5 4\n降低牛棚 3..4：1 5 4 4 4\n降低牛棚 3..4：1 5 3 3 4\n```\n\n【数据范围】\n\n- 测试点 2-5 满足 $N \\leq 100$。\n- 测试点 6-8 满足 $N \\leq 1000$。\n- 测试点 9-10 满足 $N \\leq 100,000$\n- 测试点 1-6 和 9 中，温度值不超过 $100$\n- 测试点 7-8 和 10 中，温度值不超过 $10,000$。\n", "locale": "zh-CN"}}}
{"pid": "P7995", "type": "P", "difficulty": 3, "samples": [["7\n3 1\n...\n...\n...\n3 2\n...\n...\n...\n3 3\n...\n...\n...\n3 3\n...\n.H.\n...\n3 2\n.HH\nHHH\nHH.\n3 3\n.H.\nH..\n...\n4 3\n...H\n.H..\n....\nH...", "2\n4\n6\n2\n0\n0\n6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["搜索", "USACO", "2021", "深度优先搜索 DFS"], "title": "[USACO21DEC] Walking Home B", "background": "", "description": "奶牛 Bessie 正准备从她最喜爱的草地回到她的牛棚。\n\n农场位于一个 $N \\times N$ 的方阵上（$2 \\leq N \\leq 50$），其中她的草地在左上角，牛棚在右下角。Bessie 想要尽快回家，所以她只会向下或向右走。有些地方有草堆（haybale），Bessie 无法穿过；她必须绕过它们。\n\nBessie 今天感到有些疲倦，所以她希望改变她的行走方向至多 $K$ 次（$1 \\leq K \\leq 3$）。\n\nBessie 有多少条不同的从她最爱的草地回到牛棚的路线？如果一条路线中 Bessie 经过了某个方格而另一条路线中没有，则认为这两条路线不同。", "inputFormat": "每个测试用例的输入包含 $T$ 个子测试用例，每个子测试用例描述了一个不同的农场，并且必须全部回答正确才能通过整个测试用例。输入的第一行包含 $T$（$1 \\leq T \\leq 50$）。每一个子测试用例如下。\n\n每个子测试用例的第一行包含 $N$ 和 $K$。\n\n以下 $N$ 行每行包含一个长为 $N$ 的字符串。每个字符为 $\\texttt{.}$，如果这一格是空的，或 $\\texttt{H}$，如果这一格中有草堆。输入保证农场的左上角和右下角没有草堆。", "outputFormat": "输出 $T$ 行，第 $i$ 行包含在第 $i$ 个子测试用例中 Bessie 可以选择的不同的路线数量。", "hint": "【样例解释】\n\n我们将使用一个由字符 D 和 R 组成的字符串来表示 Bessie 的路线，其中 D 和 R 分别表示 Bessie 向下（down）或向右（right）移动。\n\n第一个子测试用例中，Bessie 的两条可能的路线为 DDRR 和 RRDD。\n\n第二个子测试用例中，Bessie 的四条可能的路线为 DDRR，DRRD，RDDR 和 RRDD。\n\n第三个子测试用例中，Bessie 的六条可能的路线为 DDRR，DRDR，DRRD，RDDR，RDRD 和 RRDD。\n\n第四个子测试用例中，Bessie 的两条可能的路线为 DDRR 和 RRDD。\n\n第五和第六个子测试用例中，Bessie 不可能回到牛棚。\n\n第七个子测试用例中，Bessie 的六条可能的路线为 DDRDRR，DDRRDR，DDRRRD，RRDDDR，RRDDRD 和 RRDRDD。\n\n【数据范围】\n\n- 测试点 2 满足 $K = 1$。\n- 测试点 3-5 满足 $K = 2$。\n- 测试点 6-10 满足 $K = 3$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO21DEC] Walking Home B", "background": "", "description": "奶牛 Bessie 正准备从她最喜爱的草地回到她的牛棚。\n\n农场位于一个 $N \\times N$ 的方阵上（$2 \\leq N \\leq 50$），其中她的草地在左上角，牛棚在右下角。Bessie 想要尽快回家，所以她只会向下或向右走。有些地方有草堆（haybale），Bessie 无法穿过；她必须绕过它们。\n\nBessie 今天感到有些疲倦，所以她希望改变她的行走方向至多 $K$ 次（$1 \\leq K \\leq 3$）。\n\nBessie 有多少条不同的从她最爱的草地回到牛棚的路线？如果一条路线中 Bessie 经过了某个方格而另一条路线中没有，则认为这两条路线不同。", "inputFormat": "每个测试用例的输入包含 $T$ 个子测试用例，每个子测试用例描述了一个不同的农场，并且必须全部回答正确才能通过整个测试用例。输入的第一行包含 $T$（$1 \\leq T \\leq 50$）。每一个子测试用例如下。\n\n每个子测试用例的第一行包含 $N$ 和 $K$。\n\n以下 $N$ 行每行包含一个长为 $N$ 的字符串。每个字符为 $\\texttt{.}$，如果这一格是空的，或 $\\texttt{H}$，如果这一格中有草堆。输入保证农场的左上角和右下角没有草堆。", "outputFormat": "输出 $T$ 行，第 $i$ 行包含在第 $i$ 个子测试用例中 Bessie 可以选择的不同的路线数量。", "hint": "【样例解释】\n\n我们将使用一个由字符 D 和 R 组成的字符串来表示 Bessie 的路线，其中 D 和 R 分别表示 Bessie 向下（down）或向右（right）移动。\n\n第一个子测试用例中，Bessie 的两条可能的路线为 DDRR 和 RRDD。\n\n第二个子测试用例中，Bessie 的四条可能的路线为 DDRR，DRRD，RDDR 和 RRDD。\n\n第三个子测试用例中，Bessie 的六条可能的路线为 DDRR，DRDR，DRRD，RDDR，RDRD 和 RRDD。\n\n第四个子测试用例中，Bessie 的两条可能的路线为 DDRR 和 RRDD。\n\n第五和第六个子测试用例中，Bessie 不可能回到牛棚。\n\n第七个子测试用例中，Bessie 的六条可能的路线为 DDRDRR，DDRRDR，DDRRRD，RRDDDR，RRDDRD 和 RRDRDD。\n\n【数据范围】\n\n- 测试点 2 满足 $K = 1$。\n- 测试点 3-5 满足 $K = 2$。\n- 测试点 6-10 满足 $K = 3$。", "locale": "zh-CN"}}}
{"pid": "P7996", "type": "P", "difficulty": 3, "samples": [["7 47\n7 2 4 6 3 7 10", "3"], ["4 4\n4 4 4 4", "No answer!"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "二分", "洛谷原创", "O2优化", "洛谷月赛"], "title": "[WFOI - 01] 硬币（coin）", "background": "", "description": "你面前有一排 $n$ **堆**硬币排成一线，**同一堆硬币**的面值相同，记第 $i$ 堆硬币的面值为 $a_i$。而**每堆硬币**的数量都相同，记为 $x$。\n\n现在你知道每第 $i$ 堆硬币的面值 $a_i$，你需要确定一个**正整数** $x$，使得**每堆硬币的总金额的**方差最接近于一个**正整数** $k$。\n\n两数 **“最接近”** 的定义：两数之差的绝对值最小。\n\n方差定义：方差 $s ^ 2 = \\cfrac{(a_1 - \\bar x)^2 + (a_2 - \\bar x) ^ 2 + \\cdots + (a_n - \\bar x) ^ 2}{n}$，其中 $\\bar x$ 代表 $x$ 的平均值。", "inputFormat": "第一行两个数 $n,k$。\n\n第二行 $n$ 个数，第 $i$ 个数表示 $a_i$，表示第 $i$ 堆硬币的面值 $a_i$。", "outputFormat": "一行一个**正整数**，表示符合题意的 $x$ 值。如果有不同的答案，输出最小的一个。如果无论 $x$ 取什么值方差都为 $0$，输出一行 `No answer!`。", "hint": "\n**【样例 $\\#1$ 解释】**\n\n  当 $x=3$ 时，第 $i$ 个堆的硬币金额为 $3\\times a_i$，这些硬币堆的金额分别为 $21,6,12,18,9,21,30$，可以计算得这些硬币金额的方差约为 $58.78$，可以证明当 $x=3$ 时方差最接近 $47$。\n\n**【样例 $\\#2$ 解释】**\n\n  可以发现，无论 $x$ 的取值，方差都会为 $0$，所以输出 `No answer!`。\n\n\n\n\n\n\n\n**【数据规模】**\n\n**本题采用 Subtask 捆绑测试。**\n\nSubtask 编号 | $n,\\forall a_i\\le$ | $k\\le$ | $\\footnotesize\\texttt{测试点数目}$ |\n:-: | :-: | :-: | :-:\n**Subtask #0 $(20\\texttt{pts})$** | $10^3$ | $10^9$| $6$ |\n**Subtask #1 $(25\\texttt{pts})$** | $10^5$ | $10^{12}$| $6$ |\n**Subtask #2 $(25\\texttt{pts})$** | $10^5$ | $10^{18}$| $6$ |\n**Subtask #3 $(30\\texttt{pts})$** | $7\\times10^6$ | $3\\times 10^{18}$| $6$ |\n\n对于 $100\\%$ 的数据，$1\\le n,\\forall a_i\\le7\\times10^6$，$1\\le k\\le3\\times10^{18}$。记原来 $a$ 数组的方差为 $p$，则数据满足 $p=0$ 或 $p\\in[0.25,\\ 2^{63}-1]$ 。\n\n\n\n\n\n**【提示】**\n\n  本题读入量较大，请使用合适的读入方式。此处推荐[快速读入模板](https://www.luogu.com.cn/paste/bcfvgxr7)，对于 $\\texttt{C/C++}$ 语言，你也可以使用 `scanf` 语句完成读入。\n  \n  为避免卡精度，建议 `C/C++` 选手使用 $\\texttt{double}$ 类型，并不建议使用 `eps`。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[WFOI - 01] 硬币（coin）", "background": "", "description": "你面前有一排 $n$ **堆**硬币排成一线，**同一堆硬币**的面值相同，记第 $i$ 堆硬币的面值为 $a_i$。而**每堆硬币**的数量都相同，记为 $x$。\n\n现在你知道每第 $i$ 堆硬币的面值 $a_i$，你需要确定一个**正整数** $x$，使得**每堆硬币的总金额的**方差最接近于一个**正整数** $k$。\n\n两数 **“最接近”** 的定义：两数之差的绝对值最小。\n\n方差定义：方差 $s ^ 2 = \\cfrac{(a_1 - \\bar x)^2 + (a_2 - \\bar x) ^ 2 + \\cdots + (a_n - \\bar x) ^ 2}{n}$，其中 $\\bar x$ 代表 $x$ 的平均值。", "inputFormat": "第一行两个数 $n,k$。\n\n第二行 $n$ 个数，第 $i$ 个数表示 $a_i$，表示第 $i$ 堆硬币的面值 $a_i$。", "outputFormat": "一行一个**正整数**，表示符合题意的 $x$ 值。如果有不同的答案，输出最小的一个。如果无论 $x$ 取什么值方差都为 $0$，输出一行 `No answer!`。", "hint": "\n**【样例 $\\#1$ 解释】**\n\n  当 $x=3$ 时，第 $i$ 个堆的硬币金额为 $3\\times a_i$，这些硬币堆的金额分别为 $21,6,12,18,9,21,30$，可以计算得这些硬币金额的方差约为 $58.78$，可以证明当 $x=3$ 时方差最接近 $47$。\n\n**【样例 $\\#2$ 解释】**\n\n  可以发现，无论 $x$ 的取值，方差都会为 $0$，所以输出 `No answer!`。\n\n\n\n\n\n\n\n**【数据规模】**\n\n**本题采用 Subtask 捆绑测试。**\n\nSubtask 编号 | $n,\\forall a_i\\le$ | $k\\le$ | $\\footnotesize\\texttt{测试点数目}$ |\n:-: | :-: | :-: | :-:\n**Subtask #0 $(20\\texttt{pts})$** | $10^3$ | $10^9$| $6$ |\n**Subtask #1 $(25\\texttt{pts})$** | $10^5$ | $10^{12}$| $6$ |\n**Subtask #2 $(25\\texttt{pts})$** | $10^5$ | $10^{18}$| $6$ |\n**Subtask #3 $(30\\texttt{pts})$** | $7\\times10^6$ | $3\\times 10^{18}$| $6$ |\n\n对于 $100\\%$ 的数据，$1\\le n,\\forall a_i\\le7\\times10^6$，$1\\le k\\le3\\times10^{18}$。记原来 $a$ 数组的方差为 $p$，则数据满足 $p=0$ 或 $p\\in[0.25,\\ 2^{63}-1]$ 。\n\n\n\n\n\n**【提示】**\n\n  本题读入量较大，请使用合适的读入方式。此处推荐[快速读入模板](https://www.luogu.com.cn/paste/bcfvgxr7)，对于 $\\texttt{C/C++}$ 语言，你也可以使用 `scanf` 语句完成读入。\n  \n  为避免卡精度，建议 `C/C++` 选手使用 $\\texttt{double}$ 类型，并不建议使用 `eps`。", "locale": "zh-CN"}}}
{"pid": "P7997", "type": "P", "difficulty": 4, "samples": [["5 3\n1 2 3 4 6\n1\n2\n3", "6\n10\n11"], ["1 2\n1\n1\n2", "1\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "O2优化", "最短路", "其它技巧", "洛谷月赛"], "title": "[WFOI - 01]  刷题 （problem）", "background": "简化题意：[$\\texttt{Link}$](https://www.luogu.com.cn/paste/ievt77rm)。", "description": "你初始能力为 $0$。\n\n现在有 $n$ 个题库，每个题库的题有同一个难度 $a_i$，并且题目数量可以视为无限多。现在你要刷 $m$ 道题，每道题都是所有题中你选择出来的一道。\n\n假设你目前做到的题目难度是 $x$，则：\n\n当你的能力比这个题大或等于此题时，你将花费你的能力以攻破此题（此时你的能力减去 $x$）；否则，你将认真钻研此题，钻研出此题后能力增加 $x$（此时不会导致能力减少）。\n\n现在你想知道你做 $m$ 题后能力最大值。由于你的小伙伴也要刷题，所以**有多次询问**，询问之间相互独立，也就是说每次询问的能力初值为 $0$。", "inputFormat": "第一行输入 $2$ 个数 $n,T$；\n\n第二行输入 $n$ 个数，表示数组 $a$；\n\n接下来 $T$ 行，每行一个整数，表示询问。", "outputFormat": "对于每一个询问，输出相应的结果。", "hint": "- **样例 $1$ 解释：**\n\t\n    当 $m=1$ 时，依次选择 $6$；\n\n\t当 $m=2$ 时，依次选择 $4,6$；\n    \n    当 $m=3$ 时，依次选择 $1,4,6$；\n- **样例 $2$ 解释：** \n\n    当 $m=1$ 时，依次选择 $1$；\n\n\t当 $m=2$ 时，依次选择 $1,1$；\n\n**本题采用 Subtask 捆绑测试。**\n\n  Subtask 编号 | $n\\le$ | $m\\le$ | $T\\le$\n  :-: | :-: | :-: | :-: |\n  **Subtask #0 ($5\\texttt{pts}$)** | $5$ | $5$ | $100$ |\n  **Subtask #1 ($10\\texttt{pts}$)** | $5$ | $5$ | $10^5$ |\n  **Subtask #2 ($10\\texttt{pts}$)** | $200$ | $200$ | $100$ |\n  **Subtask #3 ($15\\texttt{pts}$)** | $200$ | $200$ | $10^5$ |\n  **Subtask #4 ($10\\texttt{pts}$)** | $200$ | $10^{18}$ | $10^5$ |\n  **Subtask #5 ($50\\texttt{pts}$)** | $2000$ | $10^{18}$ | $10^5$ |\n  \n对于 $100\\%$ 的数据，$1 \\le T \\le 10^5$，$1 \\le n\\le 2000$，$1 \\le m \\le 10^{18}$，$\\forall i,0 \\le a_i \\le 2000$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[WFOI - 01]  刷题 （problem）", "background": "简化题意：[$\\texttt{Link}$](https://www.luogu.com.cn/paste/ievt77rm)。", "description": "你初始能力为 $0$。\n\n现在有 $n$ 个题库，每个题库的题有同一个难度 $a_i$，并且题目数量可以视为无限多。现在你要刷 $m$ 道题，每道题都是所有题中你选择出来的一道。\n\n假设你目前做到的题目难度是 $x$，则：\n\n当你的能力比这个题大或等于此题时，你将花费你的能力以攻破此题（此时你的能力减去 $x$）；否则，你将认真钻研此题，钻研出此题后能力增加 $x$（此时不会导致能力减少）。\n\n现在你想知道你做 $m$ 题后能力最大值。由于你的小伙伴也要刷题，所以**有多次询问**，询问之间相互独立，也就是说每次询问的能力初值为 $0$。", "inputFormat": "第一行输入 $2$ 个数 $n,T$；\n\n第二行输入 $n$ 个数，表示数组 $a$；\n\n接下来 $T$ 行，每行一个整数，表示询问。", "outputFormat": "对于每一个询问，输出相应的结果。", "hint": "- **样例 $1$ 解释：**\n\t\n    当 $m=1$ 时，依次选择 $6$；\n\n\t当 $m=2$ 时，依次选择 $4,6$；\n    \n    当 $m=3$ 时，依次选择 $1,4,6$；\n- **样例 $2$ 解释：** \n\n    当 $m=1$ 时，依次选择 $1$；\n\n\t当 $m=2$ 时，依次选择 $1,1$；\n\n**本题采用 Subtask 捆绑测试。**\n\n  Subtask 编号 | $n\\le$ | $m\\le$ | $T\\le$\n  :-: | :-: | :-: | :-: |\n  **Subtask #0 ($5\\texttt{pts}$)** | $5$ | $5$ | $100$ |\n  **Subtask #1 ($10\\texttt{pts}$)** | $5$ | $5$ | $10^5$ |\n  **Subtask #2 ($10\\texttt{pts}$)** | $200$ | $200$ | $100$ |\n  **Subtask #3 ($15\\texttt{pts}$)** | $200$ | $200$ | $10^5$ |\n  **Subtask #4 ($10\\texttt{pts}$)** | $200$ | $10^{18}$ | $10^5$ |\n  **Subtask #5 ($50\\texttt{pts}$)** | $2000$ | $10^{18}$ | $10^5$ |\n  \n对于 $100\\%$ 的数据，$1 \\le T \\le 10^5$，$1 \\le n\\le 2000$，$1 \\le m \\le 10^{18}$，$\\forall i,0 \\le a_i \\le 2000$。", "locale": "zh-CN"}}}
{"pid": "P7998", "type": "P", "difficulty": 6, "samples": [["2\n\n1 0\n ", "\n? 1 2\n\n! 2"], ["3\n\n1 0\n\n3 2\n ", "\n? 1 3\n\n? 3 3\n\n! 2"]], "limits": {"time": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "洛谷原创", "交互题", "Special Judge", "其它技巧", "洛谷月赛"], "title": "[WFOI - 01] 猜数（guess）", "background": "**这是一道交互题。交互库自适应。请注意特殊的时间限制。**\n\n**每次输出后请记得清空缓存**\n\n简化题意：[$\\texttt{Link}$](https://www.luogu.com.cn/paste/xx7sa8go)。", "description": "你需要猜一个正整数 $q$，保证 $q\\in [1,n]$；\n\n你每次可以用诸如 `? x y` 的询问，交互库会在 $[x,y]$ 中指定选择一个数 $z$；\n\n然后交互库会输出形如 `u v` 的回答，表示指定的数是 $u$，其与 $q$ 的关系为 $v$；\n\n具体地，\n- 当交互库返回的 $v=0$ 时，表示 $u<q$；\n- 当交互库返回的 $v=1$ 时，表示 $u=q$；\n- 当交互库返回的 $v=2$ 时，表示 $u>q$。\n\n而一次询问的代价是 $\\dfrac{1}{y-x+1}$；\n\n你可以通过 `! x` 输出你认为正确的答案。\n\n现在你要求出 $q$。\n\n------------\n\n设你的代价为 $x$，你每个测试点获得的分数和你的总代价有如下关系（每个测试点满分 $10$ 分）：\n\n\n- 若 $x\\le 1.9813035$，则你可以得到 $\\text{10 pts}$；\n- 若 $1.9813035 < x \\le 12$，则你可以得到 $\\lfloor(12-x)\\times0.7 \\div 1.00186965\\rfloor  \\text{ pts}$。\n- 若 $x\\ge12$，则你可以得到 $\\text{0 pts}$。\n\n\n需要注意的是，在每一次操作后，需要调用以下函数刷新缓存：\n\n- 对于 C/C++：`fflush(stdout)`；\n- 对于 C++：`std::cout << std::flush`；\n- 对于 Java：`System.out.flush()`；\n- 对于 Python：`stdout.flush()`；\n- 对于 Pascal：`flush(output)`；\n- 对于其他语言，请自行查阅对应语言的帮助文档。\n\n### 交互格式\n\n一开始交互库会给你 $n$，\n\n然后你可以按题目描述中的方式进行询问或回答答案；\n\n在回答后请立即退出程序。", "inputFormat": "见交互格式。", "outputFormat": "见交互格式。", "hint": "- **样例 $1$ 解释：**\n\t\n    询问后发现 $1<x\\le2$，所以 $x=2$；\n    \n- **样例 $2$ 解释：** \n\n    第一次询问后发现 $1<x\\le3$；\n    \n    第二次询问后发现 $1<x<3$，所以 $x=2$；\n\n**【数据规模与约定】**\n\n| 测试点编号 | $n \\le$ | 测试点编号 | $n\\le$ |\n| :-: | :-: | :-: | :-: |\n| $\\texttt{1}$ | $1$ | $\\texttt{6}$ | $2\\times 10^3$ |\n| $\\texttt{2}$ | $7$ | $\\texttt{7}$ | $10^4$ |\n| $\\texttt{3}$ | $20$ | $\\texttt{8}$ | $5\\times 10^4$ |\n| $\\texttt{4}$ | $80$ | $\\texttt{9}$ | $10^5$ |\n| $\\texttt{5}$ | $300$ | $\\texttt{10}$ | $10^5$ |\n\n对于 $100\\%$ 的数据，$1\\le n\\le10^5$，$1\\le q,\\forall u\\le n$，$\\forall v\\in\\{0,1,2\\}$。\n\n保证每询问一次交互库时间是 $\\mathcal O(1)$ 的。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[WFOI - 01] 猜数（guess）", "background": "**这是一道交互题。交互库自适应。请注意特殊的时间限制。**\n\n**每次输出后请记得清空缓存**\n\n简化题意：[$\\texttt{Link}$](https://www.luogu.com.cn/paste/xx7sa8go)。", "description": "你需要猜一个正整数 $q$，保证 $q\\in [1,n]$；\n\n你每次可以用诸如 `? x y` 的询问，交互库会在 $[x,y]$ 中指定选择一个数 $z$；\n\n然后交互库会输出形如 `u v` 的回答，表示指定的数是 $u$，其与 $q$ 的关系为 $v$；\n\n具体地，\n- 当交互库返回的 $v=0$ 时，表示 $u<q$；\n- 当交互库返回的 $v=1$ 时，表示 $u=q$；\n- 当交互库返回的 $v=2$ 时，表示 $u>q$。\n\n而一次询问的代价是 $\\dfrac{1}{y-x+1}$；\n\n你可以通过 `! x` 输出你认为正确的答案。\n\n现在你要求出 $q$。\n\n------------\n\n设你的代价为 $x$，你每个测试点获得的分数和你的总代价有如下关系（每个测试点满分 $10$ 分）：\n\n\n- 若 $x\\le 1.9813035$，则你可以得到 $\\text{10 pts}$；\n- 若 $1.9813035 < x \\le 12$，则你可以得到 $\\lfloor(12-x)\\times0.7 \\div 1.00186965\\rfloor  \\text{ pts}$。\n- 若 $x\\ge12$，则你可以得到 $\\text{0 pts}$。\n\n\n需要注意的是，在每一次操作后，需要调用以下函数刷新缓存：\n\n- 对于 C/C++：`fflush(stdout)`；\n- 对于 C++：`std::cout << std::flush`；\n- 对于 Java：`System.out.flush()`；\n- 对于 Python：`stdout.flush()`；\n- 对于 Pascal：`flush(output)`；\n- 对于其他语言，请自行查阅对应语言的帮助文档。\n\n### 交互格式\n\n一开始交互库会给你 $n$，\n\n然后你可以按题目描述中的方式进行询问或回答答案；\n\n在回答后请立即退出程序。", "inputFormat": "见交互格式。", "outputFormat": "见交互格式。", "hint": "- **样例 $1$ 解释：**\n\t\n    询问后发现 $1<x\\le2$，所以 $x=2$；\n    \n- **样例 $2$ 解释：** \n\n    第一次询问后发现 $1<x\\le3$；\n    \n    第二次询问后发现 $1<x<3$，所以 $x=2$；\n\n**【数据规模与约定】**\n\n| 测试点编号 | $n \\le$ | 测试点编号 | $n\\le$ |\n| :-: | :-: | :-: | :-: |\n| $\\texttt{1}$ | $1$ | $\\texttt{6}$ | $2\\times 10^3$ |\n| $\\texttt{2}$ | $7$ | $\\texttt{7}$ | $10^4$ |\n| $\\texttt{3}$ | $20$ | $\\texttt{8}$ | $5\\times 10^4$ |\n| $\\texttt{4}$ | $80$ | $\\texttt{9}$ | $10^5$ |\n| $\\texttt{5}$ | $300$ | $\\texttt{10}$ | $10^5$ |\n\n对于 $100\\%$ 的数据，$1\\le n\\le10^5$，$1\\le q,\\forall u\\le n$，$\\forall v\\in\\{0,1,2\\}$。\n\n保证每询问一次交互库时间是 $\\mathcal O(1)$ 的。", "locale": "zh-CN"}}}
{"pid": "P7999", "type": "P", "difficulty": 7, "samples": [["2\n2 1", "1\n1\n1 2"], ["5\n5 2 3 4 1", "4\n2\n1 5\n2 4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["洛谷原创", "Special Judge", "O2优化", "其它技巧", "构造", "洛谷月赛"], "title": "[WFOI - 01] 翻转序列（requese）", "background": "简化题意：[$\\texttt{Link}$](https://www.luogu.com.cn/paste/kmmn8pyd)。\n\n为什么做完这题你不去做做[这题](https://www.luogu.com.cn/problem/P8223)呢", "description": "你需要在一台奇怪的电脑上排序一个 $1\\sim n$ 的排列。\n\n你可以选择一个数 $x$，然后你每次可以翻转一段长为 $x+1$ 或一段长为 $x-1$ 的序列。\n\n请在 $20\\times n$ 次内还原成 $1\\sim n$ 的序列。\n\n（出题人注：现在最优可以达到15000次以下，请尝试优化您的算法）", "inputFormat": "输入共 $2$ 行：\n\n第一行一个数 $n$。\n\n第二行 $n$ 个数，表示序列 $a$。", "outputFormat": "输出共 $m + 2$ 行。\n\n前两行每行 $1$ 个数，分别是 $x,m$。$m$ 表示操作次数。\n\n接下来 $m$ 行，每行两个数，表示翻转区间的左、右端点。\n\n本题采用 $\\text{SPJ}$，只要翻转操作正确即可给分。", "hint": "- **样例 $1$ 解释：**\n\t\n    翻转 $(1,2)$ 序列变成 $1,2$；\n    \n- **样例 $2$ 解释：** \n\n    翻转 $(1,5)$ 序列变成 $1,4,3,2,5$；\n\n\t翻转 $(2,4)$ 序列变成 $1,2,3,4,5$；\n    \n**本题采用 Subtask 捆绑测试。**\n\nSubtask 编号 | 数据规模与约定\n:-: | :-:\n**Subtask #0** ($\\texttt{1 pts}$) | $n=1$\n**Subtask #1** ($\\texttt{2 pts}$) | $n=2$\n**Subtask #2** ($\\texttt{3 pts}$) | $n=3$\n**Subtask #3** ($\\texttt{4 pts}$) | $n=4$\n**Subtask #4** ($\\texttt{20 pts}$) | $1\\le n\\le 50$\n**Subtask #5** ($\\texttt{20 pts}$) | $1\\le n\\le 100$\n**Subtask #6** ($\\texttt{50 pts}$) | $1\\le n\\le 10^3$\n\n对于 $100\\%$  的数据，$1\\le n,a_i\\le 10^3$，数据保证 $a$ 是一个 $1\\sim n$ 的排列。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[WFOI - 01] 翻转序列（requese）", "background": "简化题意：[$\\texttt{Link}$](https://www.luogu.com.cn/paste/kmmn8pyd)。\n\n为什么做完这题你不去做做[这题](https://www.luogu.com.cn/problem/P8223)呢", "description": "你需要在一台奇怪的电脑上排序一个 $1\\sim n$ 的排列。\n\n你可以选择一个数 $x$，然后你每次可以翻转一段长为 $x+1$ 或一段长为 $x-1$ 的序列。\n\n请在 $20\\times n$ 次内还原成 $1\\sim n$ 的序列。\n\n（出题人注：现在最优可以达到15000次以下，请尝试优化您的算法）", "inputFormat": "输入共 $2$ 行：\n\n第一行一个数 $n$。\n\n第二行 $n$ 个数，表示序列 $a$。", "outputFormat": "输出共 $m + 2$ 行。\n\n前两行每行 $1$ 个数，分别是 $x,m$。$m$ 表示操作次数。\n\n接下来 $m$ 行，每行两个数，表示翻转区间的左、右端点。\n\n本题采用 $\\text{SPJ}$，只要翻转操作正确即可给分。", "hint": "- **样例 $1$ 解释：**\n\t\n    翻转 $(1,2)$ 序列变成 $1,2$；\n    \n- **样例 $2$ 解释：** \n\n    翻转 $(1,5)$ 序列变成 $1,4,3,2,5$；\n\n\t翻转 $(2,4)$ 序列变成 $1,2,3,4,5$；\n    \n**本题采用 Subtask 捆绑测试。**\n\nSubtask 编号 | 数据规模与约定\n:-: | :-:\n**Subtask #0** ($\\texttt{1 pts}$) | $n=1$\n**Subtask #1** ($\\texttt{2 pts}$) | $n=2$\n**Subtask #2** ($\\texttt{3 pts}$) | $n=3$\n**Subtask #3** ($\\texttt{4 pts}$) | $n=4$\n**Subtask #4** ($\\texttt{20 pts}$) | $1\\le n\\le 50$\n**Subtask #5** ($\\texttt{20 pts}$) | $1\\le n\\le 100$\n**Subtask #6** ($\\texttt{50 pts}$) | $1\\le n\\le 10^3$\n\n对于 $100\\%$  的数据，$1\\le n,a_i\\le 10^3$，数据保证 $a$ 是一个 $1\\sim n$ 的排列。", "locale": "zh-CN"}}}
{"pid": "P8000", "type": "P", "difficulty": 6, "samples": [["4\n0 0\n0 1\n1 0\n1 1", "2\n1 3\n0 1\n1"], ["3\n0 0\n0 1\n1 0", "3\n1 2 3\n0 0\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["计算几何", "洛谷原创", "Special Judge", "O2优化", "凸包", "旋转卡壳", "洛谷月赛"], "title": "[WFOI - 01] 循环节（circle）", "background": "简化题意：[$\\texttt{Link}$](https://www.luogu.com.cn/paste/v7gqdh44)。\n\n出题人注：これは非常に嫌な質問なので、あまり時間をかけたくない場合は、この質問を見る前に他の質問を終えることをお勧めします。", "description": "给你一个坐标系上的点集 $a$，你需要找出一个子点集 $b$ 和一个向量 $x$，使得 $\\exist\\ z\\in N^+,\\{b\\cup b+x\\cup b+2x\\cup\\dots\\cup b+zx=a\\}$。\n\n现在想让你求出任意一对 $b_0,x_0,z_0$，其中 $z_0$ 为所有满足条件的三元组中 $z$ 最大的，$b_0$ 中任意三点不共线，任意四点不构成梯形或平行四边形且 $b_0\\cap b_0+x_0=\\varnothing,b_0\\cap b_0+2x_0=\\varnothing,\\dots,b_0\\cap b+yx_0=\\varnothing|{y\\to+\\infty}$。\n\n其中 $b+x$ 的意思是，$b$ 中的所有点都平移向量 $x$ 后组成的点集。", "inputFormat": "第一行一个正整数 $n$。\n\n接下来 $n$ 行，每行 $2$ 个整数，表示一个点。", "outputFormat": "输出共 $4$ 行：\n\n第一行一个整数 $|b|$。\n\n第二行 $|b|$ 个整数 $b_1,b_2,\\dots,b_{|b|}$（对应编号）。\n\n第三行两个整数 $x$。\n\n第四行一个整数 $z$。", "hint": "由于本题有样例解释也只是照着念一遍，并且相信既然您都做到这一题来了应该能读懂题目含义，所以本题不提供样例解释（~~其实是出题人懒~~）。\n\n**本题采用 Subtask 捆绑测试。**\nSubtask 编号 | 数据规模与约定\n:-: | :-:\n**Subtask #0($\\text{20 pts}$)** | $1\\le n\\le10$；$-10\\le x_i,y_i \\le 10$\n**Subtask #1($\\text{20 pts}$)** | $1\\le n\\le10^3$\n**Subtask #2($\\text{30 pts}$)** | $z>1$\n**Subtask #3($\\text{30 pts}$)** | 无特殊限制\n\n对于 $100\\%$ 的数据，$1\\le n\\le10^5$，点的坐标范围 $\\in\\left(-10^9,10^9\\right)$，数据保证有解。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[WFOI - 01] 循环节（circle）", "background": "简化题意：[$\\texttt{Link}$](https://www.luogu.com.cn/paste/v7gqdh44)。\n\n出题人注：これは非常に嫌な質問なので、あまり時間をかけたくない場合は、この質問を見る前に他の質問を終えることをお勧めします。", "description": "给你一个坐标系上的点集 $a$，你需要找出一个子点集 $b$ 和一个向量 $x$，使得 $\\exist\\ z\\in N^+,\\{b\\cup b+x\\cup b+2x\\cup\\dots\\cup b+zx=a\\}$。\n\n现在想让你求出任意一对 $b_0,x_0,z_0$，其中 $z_0$ 为所有满足条件的三元组中 $z$ 最大的，$b_0$ 中任意三点不共线，任意四点不构成梯形或平行四边形且 $b_0\\cap b_0+x_0=\\varnothing,b_0\\cap b_0+2x_0=\\varnothing,\\dots,b_0\\cap b+yx_0=\\varnothing|{y\\to+\\infty}$。\n\n其中 $b+x$ 的意思是，$b$ 中的所有点都平移向量 $x$ 后组成的点集。", "inputFormat": "第一行一个正整数 $n$。\n\n接下来 $n$ 行，每行 $2$ 个整数，表示一个点。", "outputFormat": "输出共 $4$ 行：\n\n第一行一个整数 $|b|$。\n\n第二行 $|b|$ 个整数 $b_1,b_2,\\dots,b_{|b|}$（对应编号）。\n\n第三行两个整数 $x$。\n\n第四行一个整数 $z$。", "hint": "由于本题有样例解释也只是照着念一遍，并且相信既然您都做到这一题来了应该能读懂题目含义，所以本题不提供样例解释（~~其实是出题人懒~~）。\n\n**本题采用 Subtask 捆绑测试。**\nSubtask 编号 | 数据规模与约定\n:-: | :-:\n**Subtask #0($\\text{20 pts}$)** | $1\\le n\\le10$；$-10\\le x_i,y_i \\le 10$\n**Subtask #1($\\text{20 pts}$)** | $1\\le n\\le10^3$\n**Subtask #2($\\text{30 pts}$)** | $z>1$\n**Subtask #3($\\text{30 pts}$)** | 无特殊限制\n\n对于 $100\\%$ 的数据，$1\\le n\\le10^5$，点的坐标范围 $\\in\\left(-10^9,10^9\\right)$，数据保证有解。", "locale": "zh-CN"}}}
{"pid": "P8001", "type": "P", "difficulty": 2, "samples": [["3\n0011\n0110\n1100", "9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "洛谷月赛"], "title": "Easy Strings Merging", "background": "", "description": "给定 $n$ 个 01 串，每次你可以从某个串开头移除一个字符并把它加入一个新串 $S$ 的末尾。最大化 $S$ 中相邻两个字符相同的对数。", "inputFormat": "第一行一个正整数 $n$ 表示串的个数。\n\n接下来 $n$ 行，每行一个 01 字符串。", "outputFormat": "一行一个整数表示答案。", "hint": "### 样例解释\n\n最优方案下，每次取的串的编号为 $1,1,2,1,2,3,1,2,3,2,3,3$，最终的 $S=000111111000$。\n\n### 数据范围\n\n**本题采用捆绑测试**\n\n设 $s$ 表示输入的 01 串的长度之和。\n\n| 子任务编号 | 分值 | 特殊限制 |\n| :----------: | :----------: | :----------: |\n| $0$ | $5$ | $n=1$ |\n| $1$ | $20$ | $n\\le 2$，$s\\le 10$ |\n| $2$ | $25$ | $n\\le 5$，$s\\le 30$ |\n| $3$ | $25$ | $n\\le 100$，$s\\le 200$ |\n| $4$ | $25$ | 无特殊限制 |\n\n对于所有数据，保证 $1\\le n\\le s\\le 10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "Easy Strings Merging", "background": "", "description": "给定 $n$ 个 01 串，每次你可以从某个串开头移除一个字符并把它加入一个新串 $S$ 的末尾。最大化 $S$ 中相邻两个字符相同的对数。", "inputFormat": "第一行一个正整数 $n$ 表示串的个数。\n\n接下来 $n$ 行，每行一个 01 字符串。", "outputFormat": "一行一个整数表示答案。", "hint": "### 样例解释\n\n最优方案下，每次取的串的编号为 $1,1,2,1,2,3,1,2,3,2,3,3$，最终的 $S=000111111000$。\n\n### 数据范围\n\n**本题采用捆绑测试**\n\n设 $s$ 表示输入的 01 串的长度之和。\n\n| 子任务编号 | 分值 | 特殊限制 |\n| :----------: | :----------: | :----------: |\n| $0$ | $5$ | $n=1$ |\n| $1$ | $20$ | $n\\le 2$，$s\\le 10$ |\n| $2$ | $25$ | $n\\le 5$，$s\\le 30$ |\n| $3$ | $25$ | $n\\le 100$，$s\\le 200$ |\n| $4$ | $25$ | 无特殊限制 |\n\n对于所有数据，保证 $1\\le n\\le s\\le 10^6$。", "locale": "zh-CN"}}}
{"pid": "P8002", "type": "P", "difficulty": 3, "samples": [["2 2\n1 3\n2 2", "-2"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "洛谷月赛"], "title": "Alice and Bob are playing a Normal Game", "background": "", "description": "给定一个长度为 $n$ 的序列，Alice 和 Bob 交替操作一共 $k$ 次，第 $i$ 次当前操作的人必须选一个 $-x_i \\sim x_i$ 的整数把它插在序列开头或结尾，Alice 先手（也就是说 $i$ 为奇数时由 Alice 来插入一个 $-x_i\\sim x_i$ 的整数，$i$ 为偶数时由 Bob 来插入一个 $-x_i\\sim x_i$ 的整数）。\n\n记最终的序列为 $a_1,a_2,\\dots,a_{n+k}$，则得分为 $\\sum_{i=1}^{n+k} (-1)^{i-1}a_i$。Alice 希望得分最大，Bob 希望得分最小。在两人都采取最优策略的情况下，求最终得分。", "inputFormat": "第一行两个正整数 $n,k$ 表示初始序列长度以及操作次数。\n\n接下来一行 $n$ 个整数 $a_1,a_2,\\dots,a_n$，表示初始的序列。\n\n接下来一行 $k$ 个非负整数，第 $i$ 个表示 $x_i$。", "outputFormat": "一行一个整数表示答案。", "hint": "**本题采用捆绑测试**\n\n| 子任务编号 | 分值 | 特殊限制 |\n| :----------: | :----------: | :----------: |\n| $0$ | $25$ | $n,k,x_i\\le 5$ |\n| $1$ | $25$ | $n,k\\le 10$ |\n| $2$ | $25$ | $n,k\\le 100$ |\n| $3$ | $25$ | 无特殊限制 |\n\n对于所有数据，保证 $1\\le n,k\\le 2\\times 10^5$，$0\\le |a_i|,x_i\\le 10^9$。\n\n本题测试点较多，为了保证评测速度，本题时限 500ms，保证时限在 std 所用最大时间的 5 倍以上。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "Alice and Bob are playing a Normal Game", "background": "", "description": "给定一个长度为 $n$ 的序列，Alice 和 Bob 交替操作一共 $k$ 次，第 $i$ 次当前操作的人必须选一个 $-x_i \\sim x_i$ 的整数把它插在序列开头或结尾，Alice 先手（也就是说 $i$ 为奇数时由 Alice 来插入一个 $-x_i\\sim x_i$ 的整数，$i$ 为偶数时由 Bob 来插入一个 $-x_i\\sim x_i$ 的整数）。\n\n记最终的序列为 $a_1,a_2,\\dots,a_{n+k}$，则得分为 $\\sum_{i=1}^{n+k} (-1)^{i-1}a_i$。Alice 希望得分最大，Bob 希望得分最小。在两人都采取最优策略的情况下，求最终得分。", "inputFormat": "第一行两个正整数 $n,k$ 表示初始序列长度以及操作次数。\n\n接下来一行 $n$ 个整数 $a_1,a_2,\\dots,a_n$，表示初始的序列。\n\n接下来一行 $k$ 个非负整数，第 $i$ 个表示 $x_i$。", "outputFormat": "一行一个整数表示答案。", "hint": "**本题采用捆绑测试**\n\n| 子任务编号 | 分值 | 特殊限制 |\n| :----------: | :----------: | :----------: |\n| $0$ | $25$ | $n,k,x_i\\le 5$ |\n| $1$ | $25$ | $n,k\\le 10$ |\n| $2$ | $25$ | $n,k\\le 100$ |\n| $3$ | $25$ | 无特殊限制 |\n\n对于所有数据，保证 $1\\le n,k\\le 2\\times 10^5$，$0\\le |a_i|,x_i\\le 10^9$。\n\n本题测试点较多，为了保证评测速度，本题时限 500ms，保证时限在 std 所用最大时间的 5 倍以上。", "locale": "zh-CN"}}}
{"pid": "P8003", "type": "P", "difficulty": 5, "samples": [["2\n4 5\n(())\n2 3\n()", "8\n6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "洛谷月赛"], "title": "Hard Brackets Inserting", "background": "", "description": "小 S 有一个长度为 $n$ 的**合法**括号序列。\n\n现在小 K 看到了，想在其中插入若干括号，使之成为一个长度为 $m$ 的括号序列（不一定合法）。但是她不想完全破坏这个序列，于是她希望对于她这种添加括号的方式，仅存在一种合法的且长度为 $n$ 的括号序可以通过插入若干括号来得到小 K 改后的序列，这样小 S 就可以轻松还原出原来的括号序列了（也就是说在保证删完后的括号序列长度为 $n$ 且合法的情况下，无论小 S 如何删除括号，都只能得到她初始的括号序列）。\n\n求小 K 插入括号的方案数模 $998244353$。两种插入括号的方案不同当且仅当我们将最终的括号序列按照是小 K 所插入的还是原有的两类分别染成红色和黑色，得到的带颜色的括号序列不同。", "inputFormat": "第一行一个整数 $T$ 表示数据组数。\n\n接下来对于每一组数据：\n\n第一行两个整数 $n$ 和 $m$ 表示小 S 的括号序列的长度和小 K 插入括号后的长度。\n\n第二行一个**合法**的括号序列表示小 S 的括号序列。", "outputFormat": "对于每一组数据输出一行一个整数，表示方案数对 $998244353$ 取模的结果。", "hint": "### 样例解释\n\n对于第一组样例，我们有如下 $8$ 种插入方式：\n\n$\\textcolor{red}{)}(())$\n\n$((\\textcolor{red}{)}))$\n\n$(()\\textcolor{red}{)})$\n\n$(())\\textcolor{red}{)}$\n\n$\\textcolor{red}{(}(())$\n\n$(\\textcolor{red}{(}())$\n\n$((\\textcolor{red}{(}))$\n\n$(())\\textcolor{red}{(}$\n\n其中红色的括号表示小 K 插入的括号。\n\n如下的方式是不可行的：\n\n$(\\textcolor{red}{)}())$\n\n因为你可以通过删除第二个括号或第四个括号来获得如下两种括号序列：$(()),()()$。\n\n### 数据范围\n\n**本题采用捆绑测试**\n\n| 子任务编号 | 分值 | 特殊限制 |\n| :----------: | :----------: | :----------: |\n| $0$ | $20$ | $m\\le 10$ |\n| $1$ | $30$ | $m\\le 100$ |\n| $2$ | $20$ | $n=2$ |\n| $3$ | $30$ | $n\\ne 2$ |\n\n对于所有数据，保证 $1\\le n\\le m$ 且 $\\sum m\\le 10^6$，$1\\le T\\le 100$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "Hard Brackets Inserting", "background": "", "description": "小 S 有一个长度为 $n$ 的**合法**括号序列。\n\n现在小 K 看到了，想在其中插入若干括号，使之成为一个长度为 $m$ 的括号序列（不一定合法）。但是她不想完全破坏这个序列，于是她希望对于她这种添加括号的方式，仅存在一种合法的且长度为 $n$ 的括号序可以通过插入若干括号来得到小 K 改后的序列，这样小 S 就可以轻松还原出原来的括号序列了（也就是说在保证删完后的括号序列长度为 $n$ 且合法的情况下，无论小 S 如何删除括号，都只能得到她初始的括号序列）。\n\n求小 K 插入括号的方案数模 $998244353$。两种插入括号的方案不同当且仅当我们将最终的括号序列按照是小 K 所插入的还是原有的两类分别染成红色和黑色，得到的带颜色的括号序列不同。", "inputFormat": "第一行一个整数 $T$ 表示数据组数。\n\n接下来对于每一组数据：\n\n第一行两个整数 $n$ 和 $m$ 表示小 S 的括号序列的长度和小 K 插入括号后的长度。\n\n第二行一个**合法**的括号序列表示小 S 的括号序列。", "outputFormat": "对于每一组数据输出一行一个整数，表示方案数对 $998244353$ 取模的结果。", "hint": "### 样例解释\n\n对于第一组样例，我们有如下 $8$ 种插入方式：\n\n$\\textcolor{red}{)}(())$\n\n$((\\textcolor{red}{)}))$\n\n$(()\\textcolor{red}{)})$\n\n$(())\\textcolor{red}{)}$\n\n$\\textcolor{red}{(}(())$\n\n$(\\textcolor{red}{(}())$\n\n$((\\textcolor{red}{(}))$\n\n$(())\\textcolor{red}{(}$\n\n其中红色的括号表示小 K 插入的括号。\n\n如下的方式是不可行的：\n\n$(\\textcolor{red}{)}())$\n\n因为你可以通过删除第二个括号或第四个括号来获得如下两种括号序列：$(()),()()$。\n\n### 数据范围\n\n**本题采用捆绑测试**\n\n| 子任务编号 | 分值 | 特殊限制 |\n| :----------: | :----------: | :----------: |\n| $0$ | $20$ | $m\\le 10$ |\n| $1$ | $30$ | $m\\le 100$ |\n| $2$ | $20$ | $n=2$ |\n| $3$ | $30$ | $n\\ne 2$ |\n\n对于所有数据，保证 $1\\le n\\le m$ 且 $\\sum m\\le 10^6$，$1\\le T\\le 100$。", "locale": "zh-CN"}}}
{"pid": "P8004", "type": "P", "difficulty": 7, "samples": [["2\n4 3 100\n1 2\n2 3\n3 4\n2 3 4\n5 2 100\n1 2\n2 3\n3 4\n3 5\n4 5", "6\n0\n0\n0\n5\n1 1 0\n3 4 0 3 1 1 1\n1 2 0\n3 2 1 3 0 4 1"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["Special Judge", "O2优化", "洛谷月赛"], "title": "Welcome to Lunatic City", "background": "", "description": "M 国由 $n$ 个城市，$n-1$ 条双向高速铁路组成。其中的 $n$ 个城市可经过铁路互相抵达。\n\n由于 M 国有着最顶尖的科技，为了加快交通速度，它可以在铁路上放置若干的互相配对的传送门，但总对数不超过 $L$。当一个列车在一条铁轨上运行时，每当它遇到一个传送门，就会进行传送。每个传送门分为正面与反面，列车从正面进入传送门时就会从与这个传送门配对的传送门的正面出来，从反面进入就从反面出来。传送门可以设立在一条铁路中间的任何地方。（如果对这一段描述有问题可以参考样例解释）\n\n同时由于 M 国有着最高速的列车，列车的行驶时间仅消耗在停靠。于是从城市 $i$ 到城市 $j$ 的距离 $dis(i,j)$ 定义为列车所经过的城市数（包含终点但不包含起点）。\n\n现在 M 国设立了 $m$ 个重要城市 $x_1,x_2,\\dots,x_m$，请通过合理放置不超过 $L$ 对传送门使得 M 国的首都 $1$ 号城市到这些城市的距离和最小，即最小化 $\\sum_{i=1}^mdis(1,x_i)$，并构造方案。同时放置的传送门必须保证城市间仍互相可达。\n\n（由于 spj 的某些特性，请不要在一条铁路上放超过 $L$ 个传送门，否则会被判断为 WA）", "inputFormat": "第一行一个数 $T$ 表示数据组数。\n\n接下来对于每一组数据：\n\n第一行三个整数 $n$，$m$ 和 $L$ 表示城市数，$x$ 的长度和最多放置的传送门对数。\n\n接下来 $n-1$ 行，第 $i$ 行两个正整数 $u_i,v_i$ 表示第 $i$ 条铁路连接的两个城市。\n\n接下来一行 $m$ 个整数表示 $x$。", "outputFormat": "对于每组数据：\n\n第一行一个整数表示最小距离和。\n\n接下来 $n-1$ 行，第 $i$ 行开头一个整数 $num$ 表示第 $i$ 条铁路上的传送门数。然后 $num$ 对整数 $x,f$ 描述了从 $u_i$ 到 $v_i$ 传送门依次的编号与朝向，$f=0$ 表示正面朝向城市 $u_i$，$f=1$ 表示正面朝向城市 $v_i$。\n\n传送门编号为 $1\\sim \\frac{\\sum num}{2}$ 且每种编号必须恰好出现两次。\n\n对于每组数据，传送门总对数不得超过 $L$，即 $\\frac{\\sum num}{2}\\le L$。", "hint": "### 样例解释\n\n对于样例的第二组数据，树的形态及传送门的放置方式如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/l0r5x9l0.png)\n\n其中红色门编号为 $1$，绿色编号为 $2$，蓝色编号为 $3$，紫色编号为 $4$。箭头表示传送门的正面所朝的方向。加粗的点表示重要城市。\n\n其中 $1$ 号城市到 $5$ 号城市的最短路径如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0bwhu6ct.png)\n\n首先由 $1$ 号城市出发，进入红色传送门的正面到达 $3$ 号城市。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rgq415ni.png)\n\n随后从 $3$ 号城市出发，从绿色传送门的正面进入，到达 $3-5$ 这条路上绿色与蓝色传送门中间的一段铁路上，再从蓝色传送门正面进入，到达 $2-3$ 这条路中蓝色与红色传送门中间的一段铁路上，再由红色传送门的背面进入，最终到达 $2$ 号城市。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xm1qefmr.png)\n\n最后再从紫色传送门的正面进入，最终到达 $5$ 号城市。中途除去 $1$ 号城市分别经过了 $3,2,5$ 号城市，于是在这种传送门的放置方式下 $dis(1,5)=3$。\n\n同时有 $dis(1,4)=2$，可以证明不存在让 $dis(1,4)+dis(1,5)$ 更小的放置方案。\n\n### 数据范围\n\n**本题采用捆绑测试**\n\n| 子任务编号 | 分值 | 特殊限制 |\n| :----------: | :----------: | :----------: |\n| $0$ | $15$ | $n\\le 9$，$L=100$ |\n| $1$ | $10$ | $m=n-1$，$L=5n$ |\n| $2$ | $20$ | $n\\le 70$ 且 $n>30$ 的数据不超过五组，$L=n^2$ |\n| $3$ | $20$ | $n\\le 1000$ 且 $n>100$ 的数据不超过五组，$L=100n$ |\n| $4$ | $30$ | $L=5n$ |\n| $5$ | $5$ | $L=n$ |\n\n对于所有数据，保证 $1\\le T\\le 100$，$1\\le n\\le 10^5$，$1\\le \\sum n\\le 5\\times 10^5$，$0\\le m<n$，$2\\le x_i\\le n$，$x_i$ 互不相同。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "Welcome to Lunatic City", "background": "", "description": "M 国由 $n$ 个城市，$n-1$ 条双向高速铁路组成。其中的 $n$ 个城市可经过铁路互相抵达。\n\n由于 M 国有着最顶尖的科技，为了加快交通速度，它可以在铁路上放置若干的互相配对的传送门，但总对数不超过 $L$。当一个列车在一条铁轨上运行时，每当它遇到一个传送门，就会进行传送。每个传送门分为正面与反面，列车从正面进入传送门时就会从与这个传送门配对的传送门的正面出来，从反面进入就从反面出来。传送门可以设立在一条铁路中间的任何地方。（如果对这一段描述有问题可以参考样例解释）\n\n同时由于 M 国有着最高速的列车，列车的行驶时间仅消耗在停靠。于是从城市 $i$ 到城市 $j$ 的距离 $dis(i,j)$ 定义为列车所经过的城市数（包含终点但不包含起点）。\n\n现在 M 国设立了 $m$ 个重要城市 $x_1,x_2,\\dots,x_m$，请通过合理放置不超过 $L$ 对传送门使得 M 国的首都 $1$ 号城市到这些城市的距离和最小，即最小化 $\\sum_{i=1}^mdis(1,x_i)$，并构造方案。同时放置的传送门必须保证城市间仍互相可达。\n\n（由于 spj 的某些特性，请不要在一条铁路上放超过 $L$ 个传送门，否则会被判断为 WA）", "inputFormat": "第一行一个数 $T$ 表示数据组数。\n\n接下来对于每一组数据：\n\n第一行三个整数 $n$，$m$ 和 $L$ 表示城市数，$x$ 的长度和最多放置的传送门对数。\n\n接下来 $n-1$ 行，第 $i$ 行两个正整数 $u_i,v_i$ 表示第 $i$ 条铁路连接的两个城市。\n\n接下来一行 $m$ 个整数表示 $x$。", "outputFormat": "对于每组数据：\n\n第一行一个整数表示最小距离和。\n\n接下来 $n-1$ 行，第 $i$ 行开头一个整数 $num$ 表示第 $i$ 条铁路上的传送门数。然后 $num$ 对整数 $x,f$ 描述了从 $u_i$ 到 $v_i$ 传送门依次的编号与朝向，$f=0$ 表示正面朝向城市 $u_i$，$f=1$ 表示正面朝向城市 $v_i$。\n\n传送门编号为 $1\\sim \\frac{\\sum num}{2}$ 且每种编号必须恰好出现两次。\n\n对于每组数据，传送门总对数不得超过 $L$，即 $\\frac{\\sum num}{2}\\le L$。", "hint": "### 样例解释\n\n对于样例的第二组数据，树的形态及传送门的放置方式如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/l0r5x9l0.png)\n\n其中红色门编号为 $1$，绿色编号为 $2$，蓝色编号为 $3$，紫色编号为 $4$。箭头表示传送门的正面所朝的方向。加粗的点表示重要城市。\n\n其中 $1$ 号城市到 $5$ 号城市的最短路径如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0bwhu6ct.png)\n\n首先由 $1$ 号城市出发，进入红色传送门的正面到达 $3$ 号城市。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rgq415ni.png)\n\n随后从 $3$ 号城市出发，从绿色传送门的正面进入，到达 $3-5$ 这条路上绿色与蓝色传送门中间的一段铁路上，再从蓝色传送门正面进入，到达 $2-3$ 这条路中蓝色与红色传送门中间的一段铁路上，再由红色传送门的背面进入，最终到达 $2$ 号城市。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xm1qefmr.png)\n\n最后再从紫色传送门的正面进入，最终到达 $5$ 号城市。中途除去 $1$ 号城市分别经过了 $3,2,5$ 号城市，于是在这种传送门的放置方式下 $dis(1,5)=3$。\n\n同时有 $dis(1,4)=2$，可以证明不存在让 $dis(1,4)+dis(1,5)$ 更小的放置方案。\n\n### 数据范围\n\n**本题采用捆绑测试**\n\n| 子任务编号 | 分值 | 特殊限制 |\n| :----------: | :----------: | :----------: |\n| $0$ | $15$ | $n\\le 9$，$L=100$ |\n| $1$ | $10$ | $m=n-1$，$L=5n$ |\n| $2$ | $20$ | $n\\le 70$ 且 $n>30$ 的数据不超过五组，$L=n^2$ |\n| $3$ | $20$ | $n\\le 1000$ 且 $n>100$ 的数据不超过五组，$L=100n$ |\n| $4$ | $30$ | $L=5n$ |\n| $5$ | $5$ | $L=n$ |\n\n对于所有数据，保证 $1\\le T\\le 100$，$1\\le n\\le 10^5$，$1\\le \\sum n\\le 5\\times 10^5$，$0\\le m<n$，$2\\le x_i\\le n$，$x_i$ 互不相同。", "locale": "zh-CN"}}}
{"pid": "P8005", "type": "P", "difficulty": 7, "samples": [["7\n3 1\n3 2\n3 3\n4 1\n4 2\n4 3\n4 4", "1\n2\n1\n3\n5\n5\n3"], ["5\n5 2\n6 3\n7 4\n8 5\n9 6", "20\n104\n648\n4662\n38040"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "洛谷月赛"], "title": "An Extra Requirement", "background": "由于 Codeforces [[1]](https://codeforces.com/contest/1610/problem/I) [[2]](https://codeforces.com/contest/1591/problem/F) 能从 Atcoder [[1]](https://atcoder.jp/contests/agc017/tasks/agc017_d) [[2]](https://atcoder.jp/contests/arc115/tasks/arc115_e) 搬题，于是出（搬）题人也从 Atcoder [[3]](https://atcoder.jp/contests/agc054/tasks/agc054_e) 搬了一道。", "description": "对于一个长度为 $N$ 的排列 $P$，你可以进行若干次如下操作：选三个位置 $x,y,z(x<y<z)$，若 $P_y<\\min\\{P_x,P_z\\}$ 或 $P_y>\\max\\{P_x,P_z\\}$，那么可以删除 $P_y$。\n\n统计存在一种删除方式，使得最后只剩下不超过两个数且 $P_1=A$ 的排列 $P$ 的个数。由于答案可能很大，你只需要输出个数模 $998244353$ 的结果即可。", "inputFormat": "第一行输入一行一个正整数 $T$ 表示数据组数。\n\n接下来 $T$ 行，每行两个正整数 $N,A$，分别表示排列 $P$ 的长度和排列 $P$ 的第一个数。", "outputFormat": "输出 $T$ 行，每行一个整数表示答案，对 $998244353$ 取模。", "hint": "**本题采用捆绑测试**\n\n| 子任务编号 | 分值 | 特殊限制 |\n| :----------: | :----------: | :----------: |\n| $0$ | $10$ | $T,N\\le 8$ |\n| $1$ | $15$ | $T\\le 5$，$N\\le 100$ |\n| $2$ | $10$ | $T\\le 5$，$N\\le 1000$ |\n| $3$ | $15$ | $A=1$ |\n| $4$ | $15$ | $T\\le 5$，$N\\le 5\\times 10^4$ |\n| $5$ | $15$ | $T\\le 200$ |\n| $6$ | $20$ | 无特殊限制 |\n\n对于所有数据，保证：$1\\le T\\le 10^5$，$1\\le A\\le N\\le 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "An Extra Requirement", "background": "由于 Codeforces [[1]](https://codeforces.com/contest/1610/problem/I) [[2]](https://codeforces.com/contest/1591/problem/F) 能从 Atcoder [[1]](https://atcoder.jp/contests/agc017/tasks/agc017_d) [[2]](https://atcoder.jp/contests/arc115/tasks/arc115_e) 搬题，于是出（搬）题人也从 Atcoder [[3]](https://atcoder.jp/contests/agc054/tasks/agc054_e) 搬了一道。", "description": "对于一个长度为 $N$ 的排列 $P$，你可以进行若干次如下操作：选三个位置 $x,y,z(x<y<z)$，若 $P_y<\\min\\{P_x,P_z\\}$ 或 $P_y>\\max\\{P_x,P_z\\}$，那么可以删除 $P_y$。\n\n统计存在一种删除方式，使得最后只剩下不超过两个数且 $P_1=A$ 的排列 $P$ 的个数。由于答案可能很大，你只需要输出个数模 $998244353$ 的结果即可。", "inputFormat": "第一行输入一行一个正整数 $T$ 表示数据组数。\n\n接下来 $T$ 行，每行两个正整数 $N,A$，分别表示排列 $P$ 的长度和排列 $P$ 的第一个数。", "outputFormat": "输出 $T$ 行，每行一个整数表示答案，对 $998244353$ 取模。", "hint": "**本题采用捆绑测试**\n\n| 子任务编号 | 分值 | 特殊限制 |\n| :----------: | :----------: | :----------: |\n| $0$ | $10$ | $T,N\\le 8$ |\n| $1$ | $15$ | $T\\le 5$，$N\\le 100$ |\n| $2$ | $10$ | $T\\le 5$，$N\\le 1000$ |\n| $3$ | $15$ | $A=1$ |\n| $4$ | $15$ | $T\\le 5$，$N\\le 5\\times 10^4$ |\n| $5$ | $15$ | $T\\le 200$ |\n| $6$ | $20$ | 无特殊限制 |\n\n对于所有数据，保证：$1\\le T\\le 10^5$，$1\\le A\\le N\\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P8006", "type": "P", "difficulty": 7, "samples": [["10 4\naabbaabbaa\n1 6 5 10\n3 6 5 8\n1 3 5 7\n1 10 1 10", "11\n9\n2\n17\n"]], "limits": {"time": [1000, 2000, 3000, 4000, 5000, 1000, 2000, 3000, 4000, 5000, 4000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 4000, 3000, 2000, 1000, 4000, 3000, 2000, 1000, 4000, 4000, 5000, 3000, 2000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "洛谷月赛"], "title": "String Rearrangement in Phantom", "background": "", "description": "有一字符串 $S$，每次询问两串 $S[l_1,r_1]$，$S[l_2,r_2]$，问有多少划分方式使得 $S[l_1,r_1]=A+B+C$，$C+B^R+A=S[l_2,r_2]$。其中 $B^R$ 表示 $B$ 串的翻转，$+$ 表示字符串的拼接，$S[l,r]$ 表示提取串 $S$ 的第 $l$ 到第 $r$ 个字符。$A,B,C$ 可以为空。", "inputFormat": "第一行两个正整数 $n$ 和 $m$ 表示 $S$ 的长度和询问数。\n\n第二行一个长度为 $n$ 的小写字母组成的字符串表示 $S$。\n\n接下来 $m$ 行，每行四个正整数 $l_1,r_1,l_2,r_2$ 表示询问区间，保证 $r_1-l_1=r_2-l_2$。", "outputFormat": "$m$ 行，每行一个正整数表示答案。", "hint": "**本题采用捆绑测试**\n\n| 子任务编号 | 分值 | 特殊限制 |\n| :----------: | :----------: | :----------:|\n| $0$ | $10$ | $1\\le n,m\\le 100$ |\n| $1$ | $10$ | $1\\le n,m\\le 500$ |\n| $2$ | $20$ | $1\\le n,m\\le 3000$ |\n| $3$ | $30$ | $1\\le n,m\\le 5\\times 10^4$ |\n| $4$ | $30$ | $1\\le n\\le 2\\times 10^5$，$1\\le m\\le 10^5$ |\n\n对于所有数据，保证 $1\\le n\\le 2\\times 10^5$，$1\\le m\\le 10^5$，$1\\le l_1\\le r_1\\le n$，$1\\le l_2\\le r_2\\le n$，$r_1-l_1=r_2-l_2$。\n\n对于编号为 $i$ 的 Subtask，其时限为 $i+1$ 秒。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "String Rearrangement in Phantom", "background": "", "description": "有一字符串 $S$，每次询问两串 $S[l_1,r_1]$，$S[l_2,r_2]$，问有多少划分方式使得 $S[l_1,r_1]=A+B+C$，$C+B^R+A=S[l_2,r_2]$。其中 $B^R$ 表示 $B$ 串的翻转，$+$ 表示字符串的拼接，$S[l,r]$ 表示提取串 $S$ 的第 $l$ 到第 $r$ 个字符。$A,B,C$ 可以为空。", "inputFormat": "第一行两个正整数 $n$ 和 $m$ 表示 $S$ 的长度和询问数。\n\n第二行一个长度为 $n$ 的小写字母组成的字符串表示 $S$。\n\n接下来 $m$ 行，每行四个正整数 $l_1,r_1,l_2,r_2$ 表示询问区间，保证 $r_1-l_1=r_2-l_2$。", "outputFormat": "$m$ 行，每行一个正整数表示答案。", "hint": "**本题采用捆绑测试**\n\n| 子任务编号 | 分值 | 特殊限制 |\n| :----------: | :----------: | :----------:|\n| $0$ | $10$ | $1\\le n,m\\le 100$ |\n| $1$ | $10$ | $1\\le n,m\\le 500$ |\n| $2$ | $20$ | $1\\le n,m\\le 3000$ |\n| $3$ | $30$ | $1\\le n,m\\le 5\\times 10^4$ |\n| $4$ | $30$ | $1\\le n\\le 2\\times 10^5$，$1\\le m\\le 10^5$ |\n\n对于所有数据，保证 $1\\le n\\le 2\\times 10^5$，$1\\le m\\le 10^5$，$1\\le l_1\\le r_1\\le n$，$1\\le l_2\\le r_2\\le n$，$r_1-l_1=r_2-l_2$。\n\n对于编号为 $i$ 的 Subtask，其时限为 $i+1$ 秒。", "locale": "zh-CN"}}}
{"pid": "P8007", "type": "P", "difficulty": 4, "samples": [["4\n(???\n", "3"], ["8\n(???))??", "10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["O2优化", "组合数学"], "title": "「Wdsr-3」永远与须臾的走廊", "background": "永远亭是迷途森林里的不可思议的屋子。\n\n为了躲避月之使者的到来，也是为了防御，永远亭内被布下了一条无尽的长廊。困在其中的对手无法触及到真实，陷入到永远与须臾的陷阱里去。\n\n不过，无尽的长廊 $S$ 毕竟只是单一有限走廊 $S_0$ 的无限循环，其本质是永远亭的主人蓬莱山辉夜及八意永琳设下的圈套。正因该长廊是通过辉夜的能力实现的，因此辉夜可以通过修改该「有限长的」走廊 $S_0$，进而作用于「无限长的」长廊 $S$。这意味着有限的修改可以创造出无限的变动。\n\n光秃秃的长廊显得单调，也难以起到掩人耳目的目的。辉夜决定在长廊上绘制象征着月初的「上弦月」和象征着月末的「下弦月」，以达到图案交错重叠的目的。为了方便起见，「上弦月」可以被近似认为是左括号，而「下弦月」可以被近似认为是右括号。作为优雅的月之都的公主，当然会有不少条条框框——轮到你帮助辉夜满足她的要求了。", "description": "辉夜希望创造一个无限长的括号序列 $S$ 作为永远亭长廊的绘制图案，它由一个长度为 $n$ 的括号序列 $S_0$ 不断重复而成。\n\n我们称一个括号序列 $T$ 是合法的，当且仅当它可以由以下方式生成：\n\n- $\\verb!()!$ 是一个合法的括号序列。  \n- 如果 $A$ 是合法括号序列，那么 $\\verb!(!A\\verb!)!$ 同样是一个合法括号序列。  \n- 如果 $A,B$ 都是合法括号序列，那么 $AB$（即 $A,B$ 拼接）同样是一个合法括号序列。\n\n例如，$\\verb!(()())!,\\verb!()()!,\\verb!((()())())!$ 都是合法括号序列；而 $\\verb!)(!,\\verb!(()!,\\verb!())(()!$ 均不是合法括号序列。\n\n现在辉夜已经确定了 $S_0$ 当中一部分的符号。你需要求出，「在剩下来的单元上绘制括号，使得这条无限长的长廊上可以找到**无限长的**合法括号序列」的方案数。两种方案不同仅当两种方案中有至少一个位置的 `?` 被替换成了不同的字符。输出它对 $998,244,353$（一个大质数）取模后的结果。", "inputFormat": "- 第一行有一个正整数 $n$，表示单元总数。  \n- 接下来一行有 $n$ 个字符。若第 $i$ 个字符是 $\\verb!(!$ 或者 $\\verb!)!$，则表示第 $i$ 个单元上绘制的括号已经被辉夜所指定；否则若第 $i$ 个字符是 $\\verb!?!$，则表示该位置尚未被确定。", "outputFormat": "- 共一行一个整数。表示所有方案数对 $998,244,353$ 取模后的结果。", "hint": "#### 样例 1 解释\n\n符合条件的方案共有三种：$\\verb!(())!$、$\\verb!()()!$ 和 $\\verb!())(!$。\n\n- 第一种方案，$\\overbrace{\\text{\\tt\\textcolor{red}{(())}\\textcolor{blue}{(())}\\texttt{...}\\textcolor{red}{(())}\\textcolor{blue}{(())}}}^{\\text{无穷个}}$ 可以找到无限长的合法括号序列。\n- 第二种方案，$\\overbrace{\\text{\\tt\\textcolor{red}{()()}\\textcolor{blue}{()()}\\texttt{...}\\textcolor{red}{()()}\\textcolor{blue}{()()}}}^{\\text{无穷个}}$ 同样可以找到无限长的合法括号序列。\n- 第三种方案，$\\text{\\tt\\textcolor{red}{())}}\\overbrace{\\text{\\tt\\textcolor{red}{(}\\textcolor{blue}{())(}\\texttt{...}\\textcolor{red}{())(}\\textcolor{blue}{())}}}^{\\text{无穷个}}\\text{\\tt\\textcolor{blue}{(}}$ 仍然可以找到无穷长的括号序列。\n\n可以证明，不存在其他方案。\n\n#### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le } & \\textbf{特殊性质} & \\textbf{分值} \\cr\\hline\n1 & 20 & - & 20 \\cr\\hline\n2 & 10^5 & \\text{A} & 10 \\cr\\hline\n3 & 10^5 & \\text{B} & 10 \\cr\\hline\n4 & 10^5 & - & 60 \\cr\\hline\n\\end{array}\n$$\n\n**特殊性质** $\\textbf{A}$：保证字符串里仅出现 $\\verb!(!$ 和 $\\verb!)!$。  \n**特殊性质** $\\textbf{B}$：保证字符串里仅出现 $\\verb!?!$。\n\n对于全部数据，满足 $1\\le n\\le 10^5$，且字符串里仅出现 $\\verb!(!,\\verb!)!,\\verb!?!$ 三种字符。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdsr-3」永远与须臾的走廊", "background": "永远亭是迷途森林里的不可思议的屋子。\n\n为了躲避月之使者的到来，也是为了防御，永远亭内被布下了一条无尽的长廊。困在其中的对手无法触及到真实，陷入到永远与须臾的陷阱里去。\n\n不过，无尽的长廊 $S$ 毕竟只是单一有限走廊 $S_0$ 的无限循环，其本质是永远亭的主人蓬莱山辉夜及八意永琳设下的圈套。正因该长廊是通过辉夜的能力实现的，因此辉夜可以通过修改该「有限长的」走廊 $S_0$，进而作用于「无限长的」长廊 $S$。这意味着有限的修改可以创造出无限的变动。\n\n光秃秃的长廊显得单调，也难以起到掩人耳目的目的。辉夜决定在长廊上绘制象征着月初的「上弦月」和象征着月末的「下弦月」，以达到图案交错重叠的目的。为了方便起见，「上弦月」可以被近似认为是左括号，而「下弦月」可以被近似认为是右括号。作为优雅的月之都的公主，当然会有不少条条框框——轮到你帮助辉夜满足她的要求了。", "description": "辉夜希望创造一个无限长的括号序列 $S$ 作为永远亭长廊的绘制图案，它由一个长度为 $n$ 的括号序列 $S_0$ 不断重复而成。\n\n我们称一个括号序列 $T$ 是合法的，当且仅当它可以由以下方式生成：\n\n- $\\verb!()!$ 是一个合法的括号序列。  \n- 如果 $A$ 是合法括号序列，那么 $\\verb!(!A\\verb!)!$ 同样是一个合法括号序列。  \n- 如果 $A,B$ 都是合法括号序列，那么 $AB$（即 $A,B$ 拼接）同样是一个合法括号序列。\n\n例如，$\\verb!(()())!,\\verb!()()!,\\verb!((()())())!$ 都是合法括号序列；而 $\\verb!)(!,\\verb!(()!,\\verb!())(()!$ 均不是合法括号序列。\n\n现在辉夜已经确定了 $S_0$ 当中一部分的符号。你需要求出，「在剩下来的单元上绘制括号，使得这条无限长的长廊上可以找到**无限长的**合法括号序列」的方案数。两种方案不同仅当两种方案中有至少一个位置的 `?` 被替换成了不同的字符。输出它对 $998,244,353$（一个大质数）取模后的结果。", "inputFormat": "- 第一行有一个正整数 $n$，表示单元总数。  \n- 接下来一行有 $n$ 个字符。若第 $i$ 个字符是 $\\verb!(!$ 或者 $\\verb!)!$，则表示第 $i$ 个单元上绘制的括号已经被辉夜所指定；否则若第 $i$ 个字符是 $\\verb!?!$，则表示该位置尚未被确定。", "outputFormat": "- 共一行一个整数。表示所有方案数对 $998,244,353$ 取模后的结果。", "hint": "#### 样例 1 解释\n\n符合条件的方案共有三种：$\\verb!(())!$、$\\verb!()()!$ 和 $\\verb!())(!$。\n\n- 第一种方案，$\\overbrace{\\text{\\tt\\textcolor{red}{(())}\\textcolor{blue}{(())}\\texttt{...}\\textcolor{red}{(())}\\textcolor{blue}{(())}}}^{\\text{无穷个}}$ 可以找到无限长的合法括号序列。\n- 第二种方案，$\\overbrace{\\text{\\tt\\textcolor{red}{()()}\\textcolor{blue}{()()}\\texttt{...}\\textcolor{red}{()()}\\textcolor{blue}{()()}}}^{\\text{无穷个}}$ 同样可以找到无限长的合法括号序列。\n- 第三种方案，$\\text{\\tt\\textcolor{red}{())}}\\overbrace{\\text{\\tt\\textcolor{red}{(}\\textcolor{blue}{())(}\\texttt{...}\\textcolor{red}{())(}\\textcolor{blue}{())}}}^{\\text{无穷个}}\\text{\\tt\\textcolor{blue}{(}}$ 仍然可以找到无穷长的括号序列。\n\n可以证明，不存在其他方案。\n\n#### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le } & \\textbf{特殊性质} & \\textbf{分值} \\cr\\hline\n1 & 20 & - & 20 \\cr\\hline\n2 & 10^5 & \\text{A} & 10 \\cr\\hline\n3 & 10^5 & \\text{B} & 10 \\cr\\hline\n4 & 10^5 & - & 60 \\cr\\hline\n\\end{array}\n$$\n\n**特殊性质** $\\textbf{A}$：保证字符串里仅出现 $\\verb!(!$ 和 $\\verb!)!$。  \n**特殊性质** $\\textbf{B}$：保证字符串里仅出现 $\\verb!?!$。\n\n对于全部数据，满足 $1\\le n\\le 10^5$，且字符串里仅出现 $\\verb!(!,\\verb!)!,\\verb!?!$ 三种字符。", "locale": "zh-CN"}}}
{"pid": "P8008", "type": "P", "difficulty": 4, "samples": [["4\n2.0000 2.0000\n2.0000 -2.0000\n-2.0000 -2.0000\n-2.0000 2.0000\n45.0000 1.0000", "22.6274169980"], ["8\n0.0000 2.5000\n1.0000 1.5000\n2.5000 1.0000\n2.0000 -1.0000\n1.0000 -2.0000\n-2.0000 -2.0000\n-2.5000 1.0000\n-1.0000 2.0000\n60.0000 0.8000", "23.1662217484"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["计算几何", "Special Judge", "O2优化", "线段相交", "差分"], "title": "「Wdsr-3」迷途竹林", "background": "迷途竹林是生长着高耸入云的、无边无际的竹子的竹林。由于特殊地势的缘故，所有竹子都向着一侧倾斜生长。由于竹子顶部的叶片交错在一起，因此即使竹子的下端已经被砍掉，仍然会因为其他竹子的相互作用而无法掉落。\n\n作为白玉楼的亭师，白玉楼的实际管家，魂魄妖梦时常需要收集一些竹子用于维修竹制家具以及竹楼。因为她拥有精湛的剑术，因此可以在瞬间砍伐一大片的竹子作为材料。当然，妖梦并不希望拥有过多的竹子。因此她会选择一个多边形区域进行采集。在那一瞬间，妖梦会用楼观剑顺着多边形的边进行砍伐。\n\n不过，由于掉落下来的竹子数量实在太多，因此妖梦无暇统计砍下来的竹子。你能帮帮她吗？", "description": "妖梦在迷途竹林里选定的竹子，可以看作在同一平面上。竹子可以看作有 $+\\infty$ 根，每相邻两根竹子间距相等，并且每根竹子的倾斜程度相同。竹子的高度可以看作是无限高。\n\n妖梦选定了一块多边形区域进行竹子的砍伐。**只有在多边形内的部分**才会被收集到。多边形共有 $n$ 条边，为了防止出现歧义，保证任意一条边都不和竹子平行；保证多边形是[简单多边形](https://baike.baidu.com/item/%E7%AE%80%E5%8D%95%E5%A4%9A%E8%BE%B9%E5%BD%A2/18891697)。\n\n我们会使用两个实数 $\\theta$ 和 $a$ 来描述这些竹子。这两个字母表示的含义可以参考下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7j0tx5xy.png)\n\n现在妖梦需要知道她砍下来的竹子的总长度，也就是求出这些竹子（图中橙色的这些线段）的长度之和。", "inputFormat": "- 第一行有一个正整数 $n$，表示多边形的边数。  \n- 接下来 $n$ 行，将会**按照顺时针顺序**给出多边形的 $n$ 个顶点的坐标，第 $i$ 个点与第 $i+1$ 个点连接 $(1\\le i<n)$，第 $n$ 个点与第 $1$ 个点连接。\n- 接着给出描述线段的参数 $\\theta$ 和 $a$。", "outputFormat": "- 共一行，一个实数，表示所求得的竹子的总长。你的答案 $\\mathit{ans}$ 被认为是正确的，当且仅当与标准答案 $\\mathit{std}$ 满足 $\\dfrac{|\\mathit{ans}-\\mathit{std}\\ |}{\\max(1.0,\\mathit{std}\\ )}\\le 10^{-6}$。", "hint": "#### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ajm42r7v.png)\n\n容易发现，竹子总长（即橘红色线段的总长度）为 $16\\sqrt 2$。\n\n#### 样例 2 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/anqb86a9.png)\n\n我有一个精妙绝伦的方法解释样例 $2$，可惜这里空白太小写不下。\n\n#### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le} & \\textbf{特殊性质} & \\textbf{分值}\\cr\\hline\n1 & 10 & \\text{A} & 30 \\cr\\hline\n2 & 10^3 & - & 20 \\cr\\hline\n3 & 10^5 & \\text{B} & 20 \\cr\\hline\n4 & 10^5 & - & 30 \\cr\\hline\n\\end{array}\n$$\n\n**特殊性质** $\\textbf{A}$：保证 $\\theta\\in[80,100);|x_i|,|y_i|\\le 10$。  \n**特殊性质** $\\textbf{B}$：保证 $\\theta=90$。\n\n- 对于 $100\\%$ 的数据，保证 $3\\le n\\le 10^5;|x_i|,|y_i|\\le 10^4;\\theta\\in[1,179);a\\in[0.1,100]$。输入数据当中出现的浮点数均保留四位小数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdsr-3」迷途竹林", "background": "迷途竹林是生长着高耸入云的、无边无际的竹子的竹林。由于特殊地势的缘故，所有竹子都向着一侧倾斜生长。由于竹子顶部的叶片交错在一起，因此即使竹子的下端已经被砍掉，仍然会因为其他竹子的相互作用而无法掉落。\n\n作为白玉楼的亭师，白玉楼的实际管家，魂魄妖梦时常需要收集一些竹子用于维修竹制家具以及竹楼。因为她拥有精湛的剑术，因此可以在瞬间砍伐一大片的竹子作为材料。当然，妖梦并不希望拥有过多的竹子。因此她会选择一个多边形区域进行采集。在那一瞬间，妖梦会用楼观剑顺着多边形的边进行砍伐。\n\n不过，由于掉落下来的竹子数量实在太多，因此妖梦无暇统计砍下来的竹子。你能帮帮她吗？", "description": "妖梦在迷途竹林里选定的竹子，可以看作在同一平面上。竹子可以看作有 $+\\infty$ 根，每相邻两根竹子间距相等，并且每根竹子的倾斜程度相同。竹子的高度可以看作是无限高。\n\n妖梦选定了一块多边形区域进行竹子的砍伐。**只有在多边形内的部分**才会被收集到。多边形共有 $n$ 条边，为了防止出现歧义，保证任意一条边都不和竹子平行；保证多边形是[简单多边形](https://baike.baidu.com/item/%E7%AE%80%E5%8D%95%E5%A4%9A%E8%BE%B9%E5%BD%A2/18891697)。\n\n我们会使用两个实数 $\\theta$ 和 $a$ 来描述这些竹子。这两个字母表示的含义可以参考下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7j0tx5xy.png)\n\n现在妖梦需要知道她砍下来的竹子的总长度，也就是求出这些竹子（图中橙色的这些线段）的长度之和。", "inputFormat": "- 第一行有一个正整数 $n$，表示多边形的边数。  \n- 接下来 $n$ 行，将会**按照顺时针顺序**给出多边形的 $n$ 个顶点的坐标，第 $i$ 个点与第 $i+1$ 个点连接 $(1\\le i<n)$，第 $n$ 个点与第 $1$ 个点连接。\n- 接着给出描述线段的参数 $\\theta$ 和 $a$。", "outputFormat": "- 共一行，一个实数，表示所求得的竹子的总长。你的答案 $\\mathit{ans}$ 被认为是正确的，当且仅当与标准答案 $\\mathit{std}$ 满足 $\\dfrac{|\\mathit{ans}-\\mathit{std}\\ |}{\\max(1.0,\\mathit{std}\\ )}\\le 10^{-6}$。", "hint": "#### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ajm42r7v.png)\n\n容易发现，竹子总长（即橘红色线段的总长度）为 $16\\sqrt 2$。\n\n#### 样例 2 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/anqb86a9.png)\n\n我有一个精妙绝伦的方法解释样例 $2$，可惜这里空白太小写不下。\n\n#### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le} & \\textbf{特殊性质} & \\textbf{分值}\\cr\\hline\n1 & 10 & \\text{A} & 30 \\cr\\hline\n2 & 10^3 & - & 20 \\cr\\hline\n3 & 10^5 & \\text{B} & 20 \\cr\\hline\n4 & 10^5 & - & 30 \\cr\\hline\n\\end{array}\n$$\n\n**特殊性质** $\\textbf{A}$：保证 $\\theta\\in[80,100);|x_i|,|y_i|\\le 10$。  \n**特殊性质** $\\textbf{B}$：保证 $\\theta=90$。\n\n- 对于 $100\\%$ 的数据，保证 $3\\le n\\le 10^5;|x_i|,|y_i|\\le 10^4;\\theta\\in[1,179);a\\in[0.1,100]$。输入数据当中出现的浮点数均保留四位小数。", "locale": "zh-CN"}}}
{"pid": "P8009", "type": "P", "difficulty": 5, "samples": [["5\n3 1 2 1 3\n1 2\n1 3\n3 4\n3 5\n", "109\n0\n18\n0\n0"], ["10\n1 1 4 5 1 4 1 9 1 9\n1 2\n1 3\n1 4\n2 5\n2 6\n5 7\n3 8\n3 9\n9 10", "972\n33\n99\n0\n2\n0\n0\n0\n10\n0"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["O2优化", "树形 DP"], "title": "「Wdsr-3」船往低处流", "background": "村纱水密是控制着圣辇船的船长。因为是一生和船相伴的船幽灵，因此对船只非常感兴趣。正因为这样的爱好，村纱有一大堆船模。\n\n由于间歇泉的喷发，间歇泉的周围出现了一个汇聚了多方水流的大水坑。不同的水流交错，形成了大大小小的水道。只需要把船模放在某个位置，它就会顺着水流流动。根据物理原理，船自然会从高处流向低处。由于水坑由四处的水汇集而成，因此水坑的中央地势最低；随着到中央距离的增加，地势不断增加。\n\n村纱发现，当她选定了两个位置放下船模后，它们会在某个水流的交汇处发生碰撞。村纱关心碰撞发生的位置。容易发现，第一个可能会产生碰撞的位置，就是在树形结构上这两个选定的点的最近公共祖先。\n\n当然了，由于间歇泉并不稳定，因此水池中央的位置可能会不断变化，地势也不断变化，但是水道并不会发生任何改变。村纱给每个交汇处标上了一个数值「危险程度」，表示两个船模在此处碰撞可能会发生的危险的大小。村纱放置船模的位置也是随机的。\n\n不过由于水坑实在是太大，水坑中央又不断变化，因此只关心船模的村纱被绕晕了。她迫切地想知道在水坑处玩船模产生的威胁，因此希望你帮她计算。", "description": "这些水道形成了一棵以 $1$ 为根的节点数为 $n$ 的树形结构 $T$。每个节点上有一个点权 $w_i$，表示它的危险程度。现做出如下定义：\n\n- **最近公共祖先**：在一棵以 $r$ 为根的有根树上，两个节点 $u,v$ 的最近公共祖先，就是这两个点的公共祖先里面，离根最远的那个，记作 $\\operatorname{lca}(r,u,v)$。\n- **子树**：树 $T$ 上，删掉节点 $u$ 与父亲相连的边后，该结点所在的子图记为子树 $T_u$。特别地，$T$ 本身可以认为是以 $1$ 为根节点的子树 $T_1$。\n- **危险值**：对于 $T_u$ 而言，它的危险值被定义为：\n\n$$\\mathrm{LCAS}(u)=\\sum_{i\\in T_u}\\sum_{j\\in T_u}\\sum_{k\\in T_u,k<j} w_{\\operatorname{lca}(i,j,k)}$$\n\n现在给出 $T$，希望你对于 $i=1,2,\\cdots n$，求出 $\\mathrm{LCAS}(i)$。", "inputFormat": "- 第一行有一个正整数 $n$，表示节点的个数。  \n- 第二行有 $n$ 个整数 $w_i$，表示每个结点的危险程度。  \n- 接下来 $n-1$ 行，每行有两个正整数 $u,v$，描述 $T$ 中的一条边。", "outputFormat": "- 共 $n$ 行 $n$ 个整数，第 $i$ 个整数表示 $\\mathrm{LCAS}(i)$ 的值对 $998,244,353$（一个大质数）取模后的结果。  ", "hint": "\n\n#### 样例 1 解释\n\n样例一当中的树如下。红色的是节点，蓝色的是点权。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/f7gvtsp5.png)\n\n容易发现 $\\mathrm{LCAS}(2)=\\mathrm{LCAS}(4)=\\mathrm{LCAS}(5)=0$。这里说明如何计算 $\\mathrm{LCAS}(1)$ 和 $\\mathrm{LCAS}(3)$。首先说明 $\\mathrm{LCAS}(3)$：\n\n- 以 $3$ 为根，那么有 $\\mathrm{lca}(3,3,4)=\\mathrm{lca}(3,3,5)=\\mathrm{lca}(3,4,5)=3$，这部分的贡献是 $3\\times w_3=6$。  \n- 以 $4$ 为根，那么有 $\\mathrm{lca}(4,3,4)=\\mathrm{lca}(4,4,5)=4,\\mathrm{lca}(4,3,5)=3$，这部分的贡献是 $2\\times w_4+1\\times w_3=4$。  \n- 以 $5$ 为根，那么有 $\\mathrm{lca}(5,3,5)=\\mathrm{lca}(5,4,5)=5,\\mathrm{lca}(5,3,4)=3$，这部分的贡献是 $2\\times w_5+1\\times w_3=8$。\n\n因此，$\\mathrm{LCAS}(3)=6+4+8=18$。下面计算 $\\mathrm{LCAS}(1)$。\n\n$$\n\\def\\arraystretch{1.2}\n\\begin{matrix}\n\\textbf{以 1 为根 }\\bm{\\mathbf{lca}(1,i,j)} & \\textbf{以 2 为根 }\\bm{\\mathbf{lca}(2,i,j)}\\cr\n\\begin{array}{c||c|c|c|c|c}\\hline\n& 1 & 2 & 3 & 4 & 5 \\cr\\hline\\hline\n1 & - & - & - & - &- \\cr\\hline\n2 & 1 & - & - & - &- \\cr\\hline\n3 & 1 & 1 & - & - &- \\cr\\hline\n4 & 1 & 1 & 3 & - &- \\cr\\hline\n5 & 1 & 1 & 3 & 3 &- \\cr\\hline\n\\end{array} &\n\\begin{array}{c||c|c|c|c|c}\\hline\n& 1 & 2 & 3 & 4 & 5 \\cr\\hline\\hline\n1 & - & - & - & - &- \\cr\\hline\n2 & 2 & - & - & - &- \\cr\\hline\n3 & 1 & 2 & - & - &- \\cr\\hline\n4 & 1 & 2 & 3 & - &- \\cr\\hline\n5 & 1 & 2 & 3 & 3 &- \\cr\\hline\n\\end{array} \\cr[50pt]\n\\textbf{以 3 为根 }\\bm{\\mathbf{lca}(3,i,j)} & \\textbf{以 4 为根 }\\bm{\\mathbf{lca}(4,i,j)}\\cr\n\\begin{array}{c||c|c|c|c|c}\\hline\n& 1 & 2 & 3 & 4 & 5 \\cr\\hline\\hline\n1 & - & - & - & - &- \\cr\\hline\n2 & 1 & - & - & - &- \\cr\\hline\n3 & 3 & 3 & - & - &- \\cr\\hline\n4 & 3 & 3 & 3 & - &- \\cr\\hline\n5 & 3 & 3 & 3 & 3 &- \\cr\\hline\n\\end{array} &\n\\begin{array}{c||c|c|c|c|c}\\hline\n& 1 & 2 & 3 & 4 & 5 \\cr\\hline\\hline\n1 & - & - & - & - &- \\cr\\hline\n2 & 1 & - & - & - &- \\cr\\hline\n3 & 3 & 3 & - & - &- \\cr\\hline\n4 & 4 & 4 & 4 & - &- \\cr\\hline\n5 & 3 & 3 & 3 & 4 &- \\cr\\hline\n\\end{array}\n\\end{matrix}\\\\[10pt]\n\\textbf{以 5 为根 }\\bm{\\mathbf{lca}(5,i,j)}\\\\\n\\begin{array}{c||c|c|c|c|c}\\hline\n& 1 & 2 & 3 & 4 & 5 \\cr\\hline\\hline\n1 & - & - & - & - &- \\cr\\hline\n2 & 1 & - & - & - &- \\cr\\hline\n3 & 3 & 3 & - & - &- \\cr\\hline\n4 & 3 & 3 & 3 & - &- \\cr\\hline\n5 & 5 & 5 & 5 & 5 &- \\cr\\hline\n\\end{array}\n$$\n\n容易发现，在上图中，$1$ 出现了 $13$ 次，$2$ 出现了 $4$ 次，$3$ 出现了 $25$ 次，$4$ 出现了 $4$ 次，$5$ 出现了 $4$ 次。因此，$\\mathrm{LCAS}(1)=3\\times 13+1\\times 4+2\\times 25+1\\times 4+3\\times 4=109$。\n\n#### 样例 2 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/uwm8c9bk.png)\n\n我有一个精妙绝伦的方法解释样例 $2$，可惜这里空白太小写不下。\n\n**本题输入量较大。请采用较快的读入方式。**\n\n#### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le} & \\textbf{特殊性质} & \\textbf{分值}\\cr\\hline\n1 & 100 & - & 20 \\cr\\hline\n2 & 10^3 & - & 25 \\cr\\hline\n3 & 10^5 & \\text{A} & 10\\cr\\hline\n4 & 10^5 & \\text{B} & 10\\cr\\hline\n5 & 10^6 & - & 35\\cr\\hline\n\\end{array}\n$$\n\n**特殊性质** $\\textbf{A}$：保证第 $i$ 条边为 $u=i$，$v=i+1$。  \n**特殊性质** $\\textbf{B}$：保证第 $i$ 条边为 $u=1$，$v=i+1$。\n\n对于全部数据，保证 $1\\le n\\le 10^6$，$0\\le w_i<998,244,353$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdsr-3」船往低处流", "background": "村纱水密是控制着圣辇船的船长。因为是一生和船相伴的船幽灵，因此对船只非常感兴趣。正因为这样的爱好，村纱有一大堆船模。\n\n由于间歇泉的喷发，间歇泉的周围出现了一个汇聚了多方水流的大水坑。不同的水流交错，形成了大大小小的水道。只需要把船模放在某个位置，它就会顺着水流流动。根据物理原理，船自然会从高处流向低处。由于水坑由四处的水汇集而成，因此水坑的中央地势最低；随着到中央距离的增加，地势不断增加。\n\n村纱发现，当她选定了两个位置放下船模后，它们会在某个水流的交汇处发生碰撞。村纱关心碰撞发生的位置。容易发现，第一个可能会产生碰撞的位置，就是在树形结构上这两个选定的点的最近公共祖先。\n\n当然了，由于间歇泉并不稳定，因此水池中央的位置可能会不断变化，地势也不断变化，但是水道并不会发生任何改变。村纱给每个交汇处标上了一个数值「危险程度」，表示两个船模在此处碰撞可能会发生的危险的大小。村纱放置船模的位置也是随机的。\n\n不过由于水坑实在是太大，水坑中央又不断变化，因此只关心船模的村纱被绕晕了。她迫切地想知道在水坑处玩船模产生的威胁，因此希望你帮她计算。", "description": "这些水道形成了一棵以 $1$ 为根的节点数为 $n$ 的树形结构 $T$。每个节点上有一个点权 $w_i$，表示它的危险程度。现做出如下定义：\n\n- **最近公共祖先**：在一棵以 $r$ 为根的有根树上，两个节点 $u,v$ 的最近公共祖先，就是这两个点的公共祖先里面，离根最远的那个，记作 $\\operatorname{lca}(r,u,v)$。\n- **子树**：树 $T$ 上，删掉节点 $u$ 与父亲相连的边后，该结点所在的子图记为子树 $T_u$。特别地，$T$ 本身可以认为是以 $1$ 为根节点的子树 $T_1$。\n- **危险值**：对于 $T_u$ 而言，它的危险值被定义为：\n\n$$\\mathrm{LCAS}(u)=\\sum_{i\\in T_u}\\sum_{j\\in T_u}\\sum_{k\\in T_u,k<j} w_{\\operatorname{lca}(i,j,k)}$$\n\n现在给出 $T$，希望你对于 $i=1,2,\\cdots n$，求出 $\\mathrm{LCAS}(i)$。", "inputFormat": "- 第一行有一个正整数 $n$，表示节点的个数。  \n- 第二行有 $n$ 个整数 $w_i$，表示每个结点的危险程度。  \n- 接下来 $n-1$ 行，每行有两个正整数 $u,v$，描述 $T$ 中的一条边。", "outputFormat": "- 共 $n$ 行 $n$ 个整数，第 $i$ 个整数表示 $\\mathrm{LCAS}(i)$ 的值对 $998,244,353$（一个大质数）取模后的结果。  ", "hint": "\n\n#### 样例 1 解释\n\n样例一当中的树如下。红色的是节点，蓝色的是点权。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/f7gvtsp5.png)\n\n容易发现 $\\mathrm{LCAS}(2)=\\mathrm{LCAS}(4)=\\mathrm{LCAS}(5)=0$。这里说明如何计算 $\\mathrm{LCAS}(1)$ 和 $\\mathrm{LCAS}(3)$。首先说明 $\\mathrm{LCAS}(3)$：\n\n- 以 $3$ 为根，那么有 $\\mathrm{lca}(3,3,4)=\\mathrm{lca}(3,3,5)=\\mathrm{lca}(3,4,5)=3$，这部分的贡献是 $3\\times w_3=6$。  \n- 以 $4$ 为根，那么有 $\\mathrm{lca}(4,3,4)=\\mathrm{lca}(4,4,5)=4,\\mathrm{lca}(4,3,5)=3$，这部分的贡献是 $2\\times w_4+1\\times w_3=4$。  \n- 以 $5$ 为根，那么有 $\\mathrm{lca}(5,3,5)=\\mathrm{lca}(5,4,5)=5,\\mathrm{lca}(5,3,4)=3$，这部分的贡献是 $2\\times w_5+1\\times w_3=8$。\n\n因此，$\\mathrm{LCAS}(3)=6+4+8=18$。下面计算 $\\mathrm{LCAS}(1)$。\n\n$$\n\\def\\arraystretch{1.2}\n\\begin{matrix}\n\\textbf{以 1 为根 }\\bm{\\mathbf{lca}(1,i,j)} & \\textbf{以 2 为根 }\\bm{\\mathbf{lca}(2,i,j)}\\cr\n\\begin{array}{c||c|c|c|c|c}\\hline\n& 1 & 2 & 3 & 4 & 5 \\cr\\hline\\hline\n1 & - & - & - & - &- \\cr\\hline\n2 & 1 & - & - & - &- \\cr\\hline\n3 & 1 & 1 & - & - &- \\cr\\hline\n4 & 1 & 1 & 3 & - &- \\cr\\hline\n5 & 1 & 1 & 3 & 3 &- \\cr\\hline\n\\end{array} &\n\\begin{array}{c||c|c|c|c|c}\\hline\n& 1 & 2 & 3 & 4 & 5 \\cr\\hline\\hline\n1 & - & - & - & - &- \\cr\\hline\n2 & 2 & - & - & - &- \\cr\\hline\n3 & 1 & 2 & - & - &- \\cr\\hline\n4 & 1 & 2 & 3 & - &- \\cr\\hline\n5 & 1 & 2 & 3 & 3 &- \\cr\\hline\n\\end{array} \\cr[50pt]\n\\textbf{以 3 为根 }\\bm{\\mathbf{lca}(3,i,j)} & \\textbf{以 4 为根 }\\bm{\\mathbf{lca}(4,i,j)}\\cr\n\\begin{array}{c||c|c|c|c|c}\\hline\n& 1 & 2 & 3 & 4 & 5 \\cr\\hline\\hline\n1 & - & - & - & - &- \\cr\\hline\n2 & 1 & - & - & - &- \\cr\\hline\n3 & 3 & 3 & - & - &- \\cr\\hline\n4 & 3 & 3 & 3 & - &- \\cr\\hline\n5 & 3 & 3 & 3 & 3 &- \\cr\\hline\n\\end{array} &\n\\begin{array}{c||c|c|c|c|c}\\hline\n& 1 & 2 & 3 & 4 & 5 \\cr\\hline\\hline\n1 & - & - & - & - &- \\cr\\hline\n2 & 1 & - & - & - &- \\cr\\hline\n3 & 3 & 3 & - & - &- \\cr\\hline\n4 & 4 & 4 & 4 & - &- \\cr\\hline\n5 & 3 & 3 & 3 & 4 &- \\cr\\hline\n\\end{array}\n\\end{matrix}\\\\[10pt]\n\\textbf{以 5 为根 }\\bm{\\mathbf{lca}(5,i,j)}\\\\\n\\begin{array}{c||c|c|c|c|c}\\hline\n& 1 & 2 & 3 & 4 & 5 \\cr\\hline\\hline\n1 & - & - & - & - &- \\cr\\hline\n2 & 1 & - & - & - &- \\cr\\hline\n3 & 3 & 3 & - & - &- \\cr\\hline\n4 & 3 & 3 & 3 & - &- \\cr\\hline\n5 & 5 & 5 & 5 & 5 &- \\cr\\hline\n\\end{array}\n$$\n\n容易发现，在上图中，$1$ 出现了 $13$ 次，$2$ 出现了 $4$ 次，$3$ 出现了 $25$ 次，$4$ 出现了 $4$ 次，$5$ 出现了 $4$ 次。因此，$\\mathrm{LCAS}(1)=3\\times 13+1\\times 4+2\\times 25+1\\times 4+3\\times 4=109$。\n\n#### 样例 2 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/uwm8c9bk.png)\n\n我有一个精妙绝伦的方法解释样例 $2$，可惜这里空白太小写不下。\n\n**本题输入量较大。请采用较快的读入方式。**\n\n#### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le} & \\textbf{特殊性质} & \\textbf{分值}\\cr\\hline\n1 & 100 & - & 20 \\cr\\hline\n2 & 10^3 & - & 25 \\cr\\hline\n3 & 10^5 & \\text{A} & 10\\cr\\hline\n4 & 10^5 & \\text{B} & 10\\cr\\hline\n5 & 10^6 & - & 35\\cr\\hline\n\\end{array}\n$$\n\n**特殊性质** $\\textbf{A}$：保证第 $i$ 条边为 $u=i$，$v=i+1$。  \n**特殊性质** $\\textbf{B}$：保证第 $i$ 条边为 $u=1$，$v=i+1$。\n\n对于全部数据，保证 $1\\le n\\le 10^6$，$0\\le w_i<998,244,353$。", "locale": "zh-CN"}}}
{"pid": "P8010", "type": "P", "difficulty": 5, "samples": [["6 3\n1 1 4 5 1 4\n2 3 5\n1 2 5\n2 3 5", "0\n1"], ["10 6\n1 3 5 7 8 12 14 15 17 18\n2 5 9\n1 3 10\n2 4 5\n1 1 10\n2 4 6\n2 1 10", "0\n1\n3\n0"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["并查集", "O2优化"], "title": "「Wdsr-3」令人感伤的红雨", "background": "\n\n秋静叶是在秋季掌管落叶的神明。在秋季即将迎来落幕之时，因她的力量使然，山里会变得火红一片。同时，将红叶变为落叶也是她工作的一环。\n\n秋穰子是在秋季掌管丰收的神明。与秋静叶的职责相反，她掌管着秋天果实的成熟、秋粮的收获。\n\n交织着快乐与忧愁的秋天，怎能让人不有感而发呢？", "description": "秋穰子和秋静叶是掌管秋天的神灵，因而控制着田地的收成。具体而言，有 $n$ 块田依次排列，第 $i$ 块田的丰收程度为 $a_i$。秋之姐妹会据此得出一年的年成。\n\n在综合考察了各方面因素后，秋之姐妹得出了收获第 $l$ 块至第 $r$ 块田地可以获得的作物总量 $\\Omega(l,r)$。具体定义如下：\n\n$$\n\\begin{aligned}\n\\Alpha(l,r)&=\\max_{i=l}^r\\{i\\times[a_i=\\max_{j=l}^r\\{a_j\\}]\\}\\cr\n\\Beta(l,r)&=\\max_{i=l}^r\\{\\min_{j=1}^i\\{\\Alpha(j,i)\\}\\}-\\min_{i=l}^r\\{\\max_{j=1}^i\\{\\Alpha(j,i)\\}\\}\\cr\n\\Omega(l,r)&=\\min_{i=l}^r\\{\\min_{j=i}^r\\{|\\Beta(i,j)|\\}\\}\n\\end{aligned}$$\n\n在**提示说明**部分有相关符号的解释。\n\n---\n\n由于相关因素的影响，田地的丰收程度会发生变化。因此秋之姐妹会对 $a$ 进行 $q$ 次操作：\n\n1. 形如 $\\colorbox{f0f0f0}{\\verb!1 x y!}$，表示让 $a_1,a_{2},a_{3},\\cdots ,a_x$ **分别加上** $y$。\n2. 形如 $\\colorbox{f0f0f0}{\\verb!2 l r!}$，表示询问 $\\Omega(l,r)$ 的值。", "inputFormat": "- 第一行有两个正整数 $n,q$，分别表示田地总数、操作次数。  \n- 接下来一行有 $n$ 个整数，表示每块田地的丰收程度。  \n- 接下来 $q$ 行，第一个数字 $op$ 表示该操作的种类。  \n  - 如果 $op=1$，那么接下来会有两个整数 $x,y$，含义如题意所示。  \n  - 如果 $op=2$，那么接下来会有两个正整数 $l,r$，含义如题意所示。", "outputFormat": "- 输出若干行。对于每一个操作 $2$，输出对应的结果。", "hint": "样例 $3$ 见下发的附件 $\\textbf{\\textit{sequence3.in}}/\\textbf{\\textit{sequence3.ans}}$。\n\n#### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n,q\\le} & \\textbf{特殊性质} & \\textbf{分值}\\cr\\hline\n1 & 100 & - & 10\\cr\\hline\n2 & 5\\times 10^3 & - &15\\cr\\hline\n3 & 10^5 & \\text{A} &10\\cr\\hline\n4 & 10^5 & \\text{B} &5\\cr\\hline\n5 & 10^5 & - &30\\cr\\hline\n6 & 6\\times 10^6 & - & 30\\cr\\hline\n\\end{array}\n$$\n\n**特殊性质** $\\textbf{A}$：保证对于任意的 $i\\in[1,n-1]$，都有 $a_i<a_{i+1}$。  \n**特殊性质** $\\textbf{B}$：保证没有操作 $1$。\n\n对于全部数据，保证 $1 \\leq n,q \\leq 6\\times10^6$，$a_i,y_i\\in[0,10^9]$，$1\\le x_i\\le n$，$1\\le l_i\\le r_i \\le n$。\n\n#### 符号解释\n\n- $[P]$ 是艾弗森括号，其中 $P$ 是一个条件。如果 $P$ 为真，则该式子的值为 $1$；否则为 $0$。也就是说，  \n$$[P]=\\begin{cases}1 & \\text{$P$ 为真}\\cr 0 & \\text{$P$ 为假}\\end{cases}$$  \n- $\\min\\limits_{i=l}^r\\{P\\}$ 表示当 $i$ 取 $l,l+1,l+2,\\cdots,r$ 时，表达式 $P$ 的取值的最小值；同理定义了 $\\max\\limits_{i=l}^r\\{P\\}$。\n\n#### 提示\n\n本题输入输出量较大，请注意常数因子的影响。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdsr-3」令人感伤的红雨", "background": "\n\n秋静叶是在秋季掌管落叶的神明。在秋季即将迎来落幕之时，因她的力量使然，山里会变得火红一片。同时，将红叶变为落叶也是她工作的一环。\n\n秋穰子是在秋季掌管丰收的神明。与秋静叶的职责相反，她掌管着秋天果实的成熟、秋粮的收获。\n\n交织着快乐与忧愁的秋天，怎能让人不有感而发呢？", "description": "秋穰子和秋静叶是掌管秋天的神灵，因而控制着田地的收成。具体而言，有 $n$ 块田依次排列，第 $i$ 块田的丰收程度为 $a_i$。秋之姐妹会据此得出一年的年成。\n\n在综合考察了各方面因素后，秋之姐妹得出了收获第 $l$ 块至第 $r$ 块田地可以获得的作物总量 $\\Omega(l,r)$。具体定义如下：\n\n$$\n\\begin{aligned}\n\\Alpha(l,r)&=\\max_{i=l}^r\\{i\\times[a_i=\\max_{j=l}^r\\{a_j\\}]\\}\\cr\n\\Beta(l,r)&=\\max_{i=l}^r\\{\\min_{j=1}^i\\{\\Alpha(j,i)\\}\\}-\\min_{i=l}^r\\{\\max_{j=1}^i\\{\\Alpha(j,i)\\}\\}\\cr\n\\Omega(l,r)&=\\min_{i=l}^r\\{\\min_{j=i}^r\\{|\\Beta(i,j)|\\}\\}\n\\end{aligned}$$\n\n在**提示说明**部分有相关符号的解释。\n\n---\n\n由于相关因素的影响，田地的丰收程度会发生变化。因此秋之姐妹会对 $a$ 进行 $q$ 次操作：\n\n1. 形如 $\\colorbox{f0f0f0}{\\verb!1 x y!}$，表示让 $a_1,a_{2},a_{3},\\cdots ,a_x$ **分别加上** $y$。\n2. 形如 $\\colorbox{f0f0f0}{\\verb!2 l r!}$，表示询问 $\\Omega(l,r)$ 的值。", "inputFormat": "- 第一行有两个正整数 $n,q$，分别表示田地总数、操作次数。  \n- 接下来一行有 $n$ 个整数，表示每块田地的丰收程度。  \n- 接下来 $q$ 行，第一个数字 $op$ 表示该操作的种类。  \n  - 如果 $op=1$，那么接下来会有两个整数 $x,y$，含义如题意所示。  \n  - 如果 $op=2$，那么接下来会有两个正整数 $l,r$，含义如题意所示。", "outputFormat": "- 输出若干行。对于每一个操作 $2$，输出对应的结果。", "hint": "样例 $3$ 见下发的附件 $\\textbf{\\textit{sequence3.in}}/\\textbf{\\textit{sequence3.ans}}$。\n\n#### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n,q\\le} & \\textbf{特殊性质} & \\textbf{分值}\\cr\\hline\n1 & 100 & - & 10\\cr\\hline\n2 & 5\\times 10^3 & - &15\\cr\\hline\n3 & 10^5 & \\text{A} &10\\cr\\hline\n4 & 10^5 & \\text{B} &5\\cr\\hline\n5 & 10^5 & - &30\\cr\\hline\n6 & 6\\times 10^6 & - & 30\\cr\\hline\n\\end{array}\n$$\n\n**特殊性质** $\\textbf{A}$：保证对于任意的 $i\\in[1,n-1]$，都有 $a_i<a_{i+1}$。  \n**特殊性质** $\\textbf{B}$：保证没有操作 $1$。\n\n对于全部数据，保证 $1 \\leq n,q \\leq 6\\times10^6$，$a_i,y_i\\in[0,10^9]$，$1\\le x_i\\le n$，$1\\le l_i\\le r_i \\le n$。\n\n#### 符号解释\n\n- $[P]$ 是艾弗森括号，其中 $P$ 是一个条件。如果 $P$ 为真，则该式子的值为 $1$；否则为 $0$。也就是说，  \n$$[P]=\\begin{cases}1 & \\text{$P$ 为真}\\cr 0 & \\text{$P$ 为假}\\end{cases}$$  \n- $\\min\\limits_{i=l}^r\\{P\\}$ 表示当 $i$ 取 $l,l+1,l+2,\\cdots,r$ 时，表达式 $P$ 的取值的最小值；同理定义了 $\\max\\limits_{i=l}^r\\{P\\}$。\n\n#### 提示\n\n本题输入输出量较大，请注意常数因子的影响。", "locale": "zh-CN"}}}
