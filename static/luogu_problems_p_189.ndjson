{"pid": "P4821", "type": "P", "difficulty": 4, "samples": [["1\n2", "40"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["枚举", "图论建模"], "title": "[中山市选] 生成树", "background": null, "description": "有一种图形叫做五角形圈。一个五角形圈的中心有 $1$ 个由 $n$ 个顶点和 $n$ 条边组成的圈。在中心的这个 $n$ 边圈的每一条边同时也是某一个五角形的一条边，一共有 $n$ 个不同的五角形。这些五角形只在五角形圈的中心的圈上有公共的顶点。如图 0 所示是一个 $4$ -五角形圈。\n\n![https://cdn.luogu.com.cn/upload/pic/22665.png](https://cdn.luogu.com.cn/upload/pic/22665.png)\n\n现在给定一个 $n$ 五角形圈，你的任务就是求出 $n$ 五角形圈的不同生成树的数目。还记得什么是图的生成树吗？一个图的生成树是保留原图的所有顶点以及顶点的数目减去一这么多条边,从而生成的一棵树。\n注意：在给定的 $n$ 五角形圈中所有顶点均视为不同的顶点。", "inputFormat": "输入包含多组测试数据。第一行包含一个正整数 $T$，表示测试数据数目。每组测试数据包含一个整数 $n$，代表你需要求解的五角形圈中心的边数。", "outputFormat": "对每一组测试数据，输出一行包含一个整数 $n$，表示 $n$ 五角形圈的生成树数目模 $2007$ 之后的结果。", "hint": "$2\\leq n \\leq 100$", "locale": "zh-CN", "translations": {"en": {"title": "[Zhongshan City Selection] Spanning Tree", "background": "", "description": "There is a kind of graph called a pentagon ring. The center of a pentagon ring has one cycle consisting of $n$ vertices and $n$ edges. Each edge of this central $n$-cycle is also an edge of some pentagon, and there are exactly $n$ different pentagons in total. These pentagons share vertices only on the central cycle of the pentagon ring. Figure 0 shows a $4$-pentagon ring.\n\n![https://cdn.luogu.com.cn/upload/pic/22665.png](https://cdn.luogu.com.cn/upload/pic/22665.png)\n\nNow given an $n$-pentagon ring, your task is to find the number of different spanning trees of the $n$-pentagon ring. Do you still remember what a spanning tree is? A spanning tree of a graph is a tree formed by keeping all vertices of the original graph and keeping exactly one less edge than the number of vertices.\nNote: In the given $n$-pentagon ring, all vertices are considered distinct.", "inputFormat": "The input contains multiple test cases. The first line contains a positive integer $T$, which is the number of test cases. Each test case contains an integer $n$, which represents the number of edges of the central cycle in the $n$-pentagon ring you need to solve.", "outputFormat": "For each test case, output one line containing an integer, which is the number of spanning trees of the $n$-pentagon ring modulo $2007$.", "hint": "$2\\leq n \\leq 100$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[中山市选] 生成树", "background": null, "description": "有一种图形叫做五角形圈。一个五角形圈的中心有 $1$ 个由 $n$ 个顶点和 $n$ 条边组成的圈。在中心的这个 $n$ 边圈的每一条边同时也是某一个五角形的一条边，一共有 $n$ 个不同的五角形。这些五角形只在五角形圈的中心的圈上有公共的顶点。如图 0 所示是一个 $4$ -五角形圈。\n\n![https://cdn.luogu.com.cn/upload/pic/22665.png](https://cdn.luogu.com.cn/upload/pic/22665.png)\n\n现在给定一个 $n$ 五角形圈，你的任务就是求出 $n$ 五角形圈的不同生成树的数目。还记得什么是图的生成树吗？一个图的生成树是保留原图的所有顶点以及顶点的数目减去一这么多条边,从而生成的一棵树。\n注意：在给定的 $n$ 五角形圈中所有顶点均视为不同的顶点。", "inputFormat": "输入包含多组测试数据。第一行包含一个正整数 $T$，表示测试数据数目。每组测试数据包含一个整数 $n$，代表你需要求解的五角形圈中心的边数。", "outputFormat": "对每一组测试数据，输出一行包含一个整数 $n$，表示 $n$ 五角形圈的生成树数目模 $2007$ 之后的结果。", "hint": "$2\\leq n \\leq 100$", "locale": "zh-CN"}}}
{"pid": "P4822", "type": "P", "difficulty": 4, "samples": [["4 4 1 \n1 2 4 \n4 2 6 \n1 3 8 \n3 4 8 \n", "7"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "北京", "图论建模", "最短路"], "title": "[BJWC2012] 冻结", "background": "“我要成为魔法少女！”\n\n“那么，以灵魂为代价，你希望得到什么？”\n\n“我要将有关魔法和奇迹的一切，封印于卡片之中„„”\n\n在这个愿望被实现以后的世界里，人们享受着魔法卡片（SpellCard，又名符卡）带来的便捷。\n\n现在，不需要立下契约也可以使用魔法了！你还不来试一试？\n\n比如，我们在魔法百科全书（Encyclopedia of Spells）里用“freeze”作为关键字来查询，会有很多有趣的结果。\n\n例如，我们熟知的 Cirno，她的冰冻魔法当然会有对应的 SpellCard 了。当然，更加令人惊讶的是，居然有冻结时间的魔法，Cirno 的冻青蛙比起这些来真是小巫见大巫了。\n\n这说明之前的世界中有很多魔法少女曾许下控制时间的愿望，比如 Akemi Homura、Sakuya Izayoi、……\n\n当然，在本题中我们并不是要来研究历史的，而是研究魔法的应用。", "description": "我们考虑最简单的旅行问题吧： 现在这个大陆上有 $N$ 个城市，$M$ 条双向的道路。城市编号为 $1$ ~ $N$，我们在 $1$ 号城市，需要到 $N$ 号城市，怎样才能最快地到达呢？\n\n这不就是最短路问题吗？我们都知道可以用 Dijkstra、Bellman-Ford、Floyd-Warshall等算法来解决。\n\n现在，我们一共有 $K$ 张可以使时间变慢 $50\\%$ 的 SpellCard，也就是说，在通过某条路径时，我们可以选择使用一张卡片，这样，我们通过这一条道路的时间 就可以减少到原先的一半。需要注意的是：\n\n1. 在一条道路上最多只能使用一张 SpellCard。\n2. 使用一张SpellCard 只在一条道路上起作用。\n3. 你不必使用完所有的 SpellCard。\n\n给定以上的信息，你的任务是：求出在可以使用这不超过 $K$ 张时间减速的 SpellCard 之情形下，从城市 $1$ 到城市 $N$ 最少需要多长时间。", "inputFormat": "第一行包含三个整数：$N$、$M$、$K$。\n\n接下来 $M$ 行，每行包含三个整数：$A_i$、$B_i$、$Time_i$，表示存在一条  $A_i$ 与 $B_i$ 之间的双向道路，在不使用 SpellCard 之前提下，通过它需要 $Time_i$ 的时间。", "outputFormat": "输出一个整数，表示从 $1$ 号城市到 $N$ 号城市的最小用时。", "hint": "#### 样例 1 解释\n\n在不使用 SpellCard 时，最短路为 $1 \\to 2 \\to 4$，总时间为 $10$。现在我们可以使用 $1$ 次 SpellCard，那么我们将通过 $2 \\to 4$ 这条道路的时间减半，此时总时间为 $7$。\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证：\n\n- $1 \\leq K \\leq N \\leq 50$，$M \\leq 10^3$。\n- $1 \\leq A_i,B_i \\leq N$，$2 \\leq Time_i \\leq 2 \\times 10^3$。\n- 为保证答案为整数，保证所有的 $Time_i$ 均为偶数。\n- 所有数据中的无向图保证无自环、重边，且是连通的。", "locale": "zh-CN", "translations": {"en": {"title": "[BJWC2012] Freeze", "background": "“I want to become a magical girl.”\n\n“Then, in exchange for your soul, what do you wish to obtain?”\n\n“I want to seal everything about magic and miracles into cards...”\n\nIn the world after this wish comes true, people enjoy the convenience brought by magic cards (SpellCard, also known as “符卡”).\n\nNow, you can use magic without making a contract! Why not give it a try?\n\nFor example, if we search the Encyclopedia of Spells with the keyword “freeze”, we will get many interesting results.\n\nFor instance, the well-known Cirno surely has a corresponding SpellCard for her freezing magic. Even more surprising, there is actually magic that can freeze time. Compared with these, Cirno’s frozen frogs are nothing.\n\nThis shows that in the previous world, many magical girls once made wishes to control time, such as Akemi Homura, Sakuya Izayoi, ...\n\nOf course, in this problem we are not studying history, but the application of magic.", "description": "Let us consider the simplest travel problem: there are $N$ cities and $M$ bidirectional roads on this continent. The cities are numbered from $1$ to $N$. We start at city $1$ and need to reach city $N$. How can we arrive as fast as possible?\n\nIs this not just the shortest path problem? We all know it can be solved using algorithms such as Dijkstra, Bellman-Ford, and Floyd-Warshall.\n\nNow, we have $K$ SpellCards that can slow down time by $50\\%$. That is, when traveling along an edge, we may choose to use one card, so the time to pass that road becomes half of the original. Note that:\n\n1. On each road, at most one SpellCard can be used.\n2. Using one SpellCard only takes effect on one road.\n3. You do not have to use all SpellCards.\n\nGiven the above information, your task is to find the minimum time needed to travel from city $1$ to city $N$ when you may use at most $K$ time-slowing SpellCards.", "inputFormat": "The first line contains three integers: $N$, $M$, $K$.\n\nThe next $M$ lines each contain three integers: $A_i$, $B_i$, $Time_i$, meaning there is a bidirectional road between $A_i$ and $B_i$. Without using a SpellCard, passing through it takes $Time_i$ time.", "outputFormat": "Output one integer, the minimum time needed to travel from city $1$ to city $N$.", "hint": "#### Sample 1 Explanation\n\nWithout using any SpellCard, the shortest path is $1 \\to 2 \\to 4$, with total time $10$. Now we can use $1$ SpellCard, so we halve the time on the road $2 \\to 4$, and the total time becomes $7$.\n\n#### Constraints\n\nFor $100\\%$ of the testdata, it is guaranteed that:\n\n- $1 \\leq K \\leq N \\leq 50$, $M \\leq 10^3$.\n- $1 \\leq A_i,B_i \\leq N$, $2 \\leq Time_i \\leq 2 \\times 10^3$.\n- To ensure the answer is an integer, all $Time_i$ are even.\n- The undirected graph in all data has no self-loops or multiple edges, and is connected.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJWC2012] 冻结", "background": "“我要成为魔法少女！”\n\n“那么，以灵魂为代价，你希望得到什么？”\n\n“我要将有关魔法和奇迹的一切，封印于卡片之中„„”\n\n在这个愿望被实现以后的世界里，人们享受着魔法卡片（SpellCard，又名符卡）带来的便捷。\n\n现在，不需要立下契约也可以使用魔法了！你还不来试一试？\n\n比如，我们在魔法百科全书（Encyclopedia of Spells）里用“freeze”作为关键字来查询，会有很多有趣的结果。\n\n例如，我们熟知的 Cirno，她的冰冻魔法当然会有对应的 SpellCard 了。当然，更加令人惊讶的是，居然有冻结时间的魔法，Cirno 的冻青蛙比起这些来真是小巫见大巫了。\n\n这说明之前的世界中有很多魔法少女曾许下控制时间的愿望，比如 Akemi Homura、Sakuya Izayoi、……\n\n当然，在本题中我们并不是要来研究历史的，而是研究魔法的应用。", "description": "我们考虑最简单的旅行问题吧： 现在这个大陆上有 $N$ 个城市，$M$ 条双向的道路。城市编号为 $1$ ~ $N$，我们在 $1$ 号城市，需要到 $N$ 号城市，怎样才能最快地到达呢？\n\n这不就是最短路问题吗？我们都知道可以用 Dijkstra、Bellman-Ford、Floyd-Warshall等算法来解决。\n\n现在，我们一共有 $K$ 张可以使时间变慢 $50\\%$ 的 SpellCard，也就是说，在通过某条路径时，我们可以选择使用一张卡片，这样，我们通过这一条道路的时间 就可以减少到原先的一半。需要注意的是：\n\n1. 在一条道路上最多只能使用一张 SpellCard。\n2. 使用一张SpellCard 只在一条道路上起作用。\n3. 你不必使用完所有的 SpellCard。\n\n给定以上的信息，你的任务是：求出在可以使用这不超过 $K$ 张时间减速的 SpellCard 之情形下，从城市 $1$ 到城市 $N$ 最少需要多长时间。", "inputFormat": "第一行包含三个整数：$N$、$M$、$K$。\n\n接下来 $M$ 行，每行包含三个整数：$A_i$、$B_i$、$Time_i$，表示存在一条  $A_i$ 与 $B_i$ 之间的双向道路，在不使用 SpellCard 之前提下，通过它需要 $Time_i$ 的时间。", "outputFormat": "输出一个整数，表示从 $1$ 号城市到 $N$ 号城市的最小用时。", "hint": "#### 样例 1 解释\n\n在不使用 SpellCard 时，最短路为 $1 \\to 2 \\to 4$，总时间为 $10$。现在我们可以使用 $1$ 次 SpellCard，那么我们将通过 $2 \\to 4$ 这条道路的时间减半，此时总时间为 $7$。\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证：\n\n- $1 \\leq K \\leq N \\leq 50$，$M \\leq 10^3$。\n- $1 \\leq A_i,B_i \\leq N$，$2 \\leq Time_i \\leq 2 \\times 10^3$。\n- 为保证答案为整数，保证所有的 $Time_i$ 均为偶数。\n- 所有数据中的无向图保证无自环、重边，且是连通的。", "locale": "zh-CN"}}}
{"pid": "P4823", "type": "P", "difficulty": 5, "samples": [["2\n20 10\n5 5\n30", "2"], ["2\n20 10\n5 5\n35", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2013", "各省省选", "排序", "背包 DP", "天津"], "title": "[TJOI2013] 拯救小矮人", "background": "", "description": "一群小矮人掉进了一个很深的陷阱里，由于太矮爬不上来，于是他们决定搭一个人梯。即：一个小矮人站在另一小矮人的 肩膀上，直到最顶端的小矮人伸直胳膊可以碰到陷阱口。\n\n对于每一个小矮人，我们知道他从脚到肩膀的高度 $A_i$，并且他的胳膊长度为 $B_i$。陷阱深度为 $H$。\n\n如果我们利用矮人 $1$，矮人 $2$，矮人 $3$，……，矮人 $k$ 搭一个梯子，满足 $A_1+A_2+A_3+\\dots+A_k+B_k \\geq H$，那么矮人 $k$ 就可以离开陷阱逃跑了，一旦一个矮人逃跑了，他就不能再搭人梯了。  \n\n我们希望尽可能多的小矮人逃跑，问最多可以使多少个小矮人逃跑。", "inputFormat": "第一行一个整数 $N$，表示矮人的个数，接下来 $N$ 行每一行两个整数 $A_i$ 和 $B_i$，最后一行是 $H$。", "outputFormat": "一个整数表示最多可以逃跑多少小矮人。", "hint": "对于 $30\\%$ 的数据，$N\\leq 200$；  \n\n对于 $100\\%$ 的数据，$1 \\leq N\\leq 2000$，$1 \\leq A_i,B_i,H\\leq10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[TJOI2013] Saving the Dwarfs", "background": "", "description": "A group of dwarfs fell into a very deep pit. Because they are too short to climb out, they decide to build a human ladder. That is, one dwarf stands on another dwarf’s shoulders, until the dwarf at the top can touch the edge of the pit with his arms fully stretched.\n\nFor each dwarf, we know his height from feet to shoulders $A_i$, and his arm length $B_i$. The pit depth is $H$.\n\nIf we use dwarf $1$, dwarf $2$, dwarf $3$, $\\dots$, dwarf $k$ to build a ladder that satisfies $A_1+A_2+A_3+\\dots+A_k+B_k \\geq H$, then dwarf $k$ can leave the pit and escape. Once a dwarf escapes, he cannot be used to build the human ladder anymore.\n\nWe want as many dwarfs as possible to escape. Find the maximum number of dwarfs that can escape.", "inputFormat": "The first line contains an integer $N$, the number of dwarfs. The next $N$ lines each contain two integers $A_i$ and $B_i$. The last line contains $H$.", "outputFormat": "Output one integer, the maximum number of dwarfs that can escape.", "hint": "For $30\\%$ of the testdata, $N\\leq 200$.\n\nFor $100\\%$ of the testdata, $1 \\leq N\\leq 2000$, $1 \\leq A_i,B_i,H\\leq10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[TJOI2013] 拯救小矮人", "background": "", "description": "一群小矮人掉进了一个很深的陷阱里，由于太矮爬不上来，于是他们决定搭一个人梯。即：一个小矮人站在另一小矮人的 肩膀上，直到最顶端的小矮人伸直胳膊可以碰到陷阱口。\n\n对于每一个小矮人，我们知道他从脚到肩膀的高度 $A_i$，并且他的胳膊长度为 $B_i$。陷阱深度为 $H$。\n\n如果我们利用矮人 $1$，矮人 $2$，矮人 $3$，……，矮人 $k$ 搭一个梯子，满足 $A_1+A_2+A_3+\\dots+A_k+B_k \\geq H$，那么矮人 $k$ 就可以离开陷阱逃跑了，一旦一个矮人逃跑了，他就不能再搭人梯了。  \n\n我们希望尽可能多的小矮人逃跑，问最多可以使多少个小矮人逃跑。", "inputFormat": "第一行一个整数 $N$，表示矮人的个数，接下来 $N$ 行每一行两个整数 $A_i$ 和 $B_i$，最后一行是 $H$。", "outputFormat": "一个整数表示最多可以逃跑多少小矮人。", "hint": "对于 $30\\%$ 的数据，$N\\leq 200$；  \n\n对于 $100\\%$ 的数据，$1 \\leq N\\leq 2000$，$1 \\leq A_i,B_i,H\\leq10^5$。", "locale": "zh-CN"}}}
{"pid": "P4824", "type": "P", "difficulty": 5, "samples": [["whatthemomooofun\nmoo", "whatthefun"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "2015", "线段树", "USACO", "哈希 hashing", "栈", "AC 自动机", "KMP 算法"], "title": "[USACO15FEB] Censoring S", "background": "", "description": "Farmer John has purchased a subscription to Good Hooveskeeping magazine for his cows, so they have plenty of material to read while waiting around in the barn during milking sessions. Unfortunately, the latest issue contains a rather inappropriate article on how to cook the perfect steak, which FJ would rather his cows not see (clearly, the magazine is in need of better editorial oversight).\n\nFJ has taken all of the text from the magazine to create the string $S$ of length at most 10^6 characters. From this, he would like to remove occurrences of a substring $T$ to censor the inappropriate content. To do this, Farmer John finds the **_first_** occurrence of $T$ in $S$ and deletes it. He then repeats the process again, deleting the first occurrence of $T$ again, continuing until there are no more occurrences of $T$ in $S$. Note that the deletion of one occurrence might create a new occurrence of $T$ that didn't exist before.\n\nPlease help FJ determine the final contents of $S$ after censoring is complete.", "inputFormat": "The first line will contain $S$. The second line will contain $T$. The length of $T$ will be at most that of $S$, and all characters of $S$ and $T$ will be lower-case alphabet characters (in the range a..z). ", "outputFormat": "The string $S$ after all deletions are complete. It is guaranteed that $S$ will not become empty during the deletion process. ", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO15FEB] Censoring S", "background": "", "description": "Farmer John has purchased a subscription to Good Hooveskeeping magazine for his cows, so they have plenty of material to read while waiting around in the barn during milking sessions. Unfortunately, the latest issue contains a rather inappropriate article on how to cook the perfect steak, which FJ would rather his cows not see (clearly, the magazine is in need of better editorial oversight).\n\nFJ has taken all of the text from the magazine to create the string $S$ of length at most 10^6 characters. From this, he would like to remove occurrences of a substring $T$ to censor the inappropriate content. To do this, Farmer John finds the **_first_** occurrence of $T$ in $S$ and deletes it. He then repeats the process again, deleting the first occurrence of $T$ again, continuing until there are no more occurrences of $T$ in $S$. Note that the deletion of one occurrence might create a new occurrence of $T$ that didn't exist before.\n\nPlease help FJ determine the final contents of $S$ after censoring is complete.", "inputFormat": "The first line will contain $S$. The second line will contain $T$. The length of $T$ will be at most that of $S$, and all characters of $S$ and $T$ will be lower-case alphabet characters (in the range a..z). ", "outputFormat": "The string $S$ after all deletions are complete. It is guaranteed that $S$ will not become empty during the deletion process. ", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO15FEB] Censoring S", "background": "", "description": "Farmer John 为他的奶牛订阅了《Good Hooveskeeping》杂志，但最新一期包含了一篇不恰当的牛排烹饪文章。为此，FJ 需要将杂志文字组成的字符串 $S$（长度不超过 $10^6$）中所有出现的子串 $T$ 进行删除处理。\n\n删除规则如下：反复找到当前 $S$ 中第一个出现的子串 $T$ 并删除，直到 $S$ 中不再包含 $T$。注意，删除操作可能产生新的 $T$ 子串。\n\n请输出最终处理完成的字符串 $S$。", "inputFormat": "第一行输入字符串 $S$。  \n第二行输入字符串 $T$。  \n保证 $T$ 的长度不超过 $S$，且 $S$ 和 $T$ 均由小写字母组成。删除过程中保证 $S$ 不会变为空。", "outputFormat": "输出处理完成后的字符串 $S$。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4825", "type": "P", "difficulty": 3, "samples": [["4 4 4\n1 1 1 1\n1 3 2 1\n1 2 4 1\n1 1 1 1", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "USACO", "枚举", "前缀和"], "title": "[USACO15FEB] Cow Hopscotch S", "background": "", "description": "Just like humans enjoy playing the game of Hopscotch, Farmer John's cows have invented a variant of the game for themselves to play. Being played by clumsy animals weighing nearly a ton, Cow Hopscotch almost always ends in disaster, but this has surprisingly not deterred the cows from attempting to play nearly every afternoon.\n\nThe game is played on an $R$ by $C$ grid $(2 <= R <= 100,$ $2 <= C <= 100)$, where each square is labeled with an integer in the range $1...K (1 <= K <= R * C)$. Cows start in the top-left square and move to the bottom-right square by a sequence of jumps, where a jump is valid if and only if:\n\n1. You are jumping to a square labeled with a different integer than your current square,\n\n2. The square that you are jumping to is at least one row below the current square that you are on, and\n\n3. The square that you are jumping to is at least one column to the right of the current square that you are on.\n\nPlease help the cows compute the number of different possible sequences of valid jumps that will take them from the top-left square to the bottom-right square.", "inputFormat": "The first line contains the integers $R, C,$ and $K$. The next $R$ lines will each contain $C$ integers, each in the range $1..K$.", "outputFormat": "Output the number of different ways one can jump from the top-left square to the bottom-right square, mod $1000000007$. ", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO15FEB] Cow Hopscotch S", "background": "", "description": "Just like humans enjoy playing the game of Hopscotch, Farmer John's cows have invented a variant of the game for themselves to play. Being played by clumsy animals weighing nearly a ton, Cow Hopscotch almost always ends in disaster, but this has surprisingly not deterred the cows from attempting to play nearly every afternoon.\n\nThe game is played on an $R$ by $C$ grid $(2 <= R <= 100,$ $2 <= C <= 100)$, where each square is labeled with an integer in the range $1...K (1 <= K <= R * C)$. Cows start in the top-left square and move to the bottom-right square by a sequence of jumps, where a jump is valid if and only if:\n\n1. You are jumping to a square labeled with a different integer than your current square,\n\n2. The square that you are jumping to is at least one row below the current square that you are on, and\n\n3. The square that you are jumping to is at least one column to the right of the current square that you are on.\n\nPlease help the cows compute the number of different possible sequences of valid jumps that will take them from the top-left square to the bottom-right square.", "inputFormat": "The first line contains the integers $R, C,$ and $K$. The next $R$ lines will each contain $C$ integers, each in the range $1..K$.", "outputFormat": "Output the number of different ways one can jump from the top-left square to the bottom-right square, mod $1000000007$. ", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO15FEB] Cow Hopscotch S", "background": "", "description": "与人类喜欢玩跳格子游戏类似，Farmer John 的奶牛们也发明了自己的版本。游戏在一个 $R \\times C$ 的网格上进行（$2 \\leq R,C \\leq 100$），每个格子标有 $1 \\ldots K$ 的整数（$1 \\leq K \\leq R \\times C$）。奶牛从左上角出发，通过一系列有效跳跃到达右下角。跳跃被定义为有效当且仅当满足以下条件：\n\n1. 目标格子与当前格子的数字不同  \n2. 目标格子位于当前格子下方至少一行  \n3. 目标格子位于当前格子右侧至少一列  \n\n请计算从左上角到右下角的不同有效跳跃路径总数。", "inputFormat": "第一行包含三个整数 $R$, $C$, $K$。  \n接下来 $R$ 行每行包含 $C$ 个整数，每个数在 $1 \\ldots K$ 范围内。", "outputFormat": "输出从左上角到右下角的不同路径数量，结果对 $1000000007$ 取模。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4826", "type": "P", "difficulty": 3, "samples": [["4\n3\n6\n9\n10", "37"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "USACO", "图论建模", "生成树"], "title": "[USACO15FEB] Superbull S", "background": "", "description": "Bessie and her friends are playing hoofball in the annual Superbull championship, and Farmer John is in charge of making the tournament as exciting as possible. A total of $N$ $(1 <= N <= 2000)$ teams are playing in the Superbull. Each team is assigned a distinct integer team ID in the range 1...2^30-1 to distinguish it from the other teams. The Superbull is an elimination tournament -- after every game, Farmer John chooses which team to eliminate from the Superbull, and the eliminated team can no longer play in any more games. The Superbull ends when only one team remains.\n\nFarmer John notices a very unusual property about the scores in matches! In any game, the combined score of the two teams always ends up being the bitwise exclusive OR (XOR) of the two team IDs. For example, if teams 12 and 20 were to play, then 24 points would be scored in that game, since 01100 XOR 10100 = 11000.\n\nFarmer John believes that the more points are scored in a game, the more exciting the game is. Because of this, he wants to choose a series of games to be played such that the total number of points scored in the Superbull is maximized. Please help Farmer John organize the matches.", "inputFormat": "The first line contains the single integer $N$. The following $N$ lines contain the N team IDs.", "outputFormat": "Output the maximum possible number of points that can be scored in the Superbull.", "hint": "OUTPUT DETAILS: One way to achieve 37 is as follows: FJ matches teams 3 and 9, and decides that 9 wins, so teams 6, 9, and 10 are left in the tournament. He then matches teams 6 and 9, and lets team 6 win. Teams 6 and 10 are then left in the tournament. Finally, teams 6 and 10 face off, and team 10 wins. The total number of points scored is (3 XOR 9) + (6 XOR 9) + (6 XOR 10) = 10 + 15 + 12 = 37.\n\nNOTE: The bitwise exclusive OR operation, commonly denoted by the ^ symbol, is a bitwise operation that performs the logical exclusive OR operation on each position in two binary integers. The result in each position is 1 if only the first bit is 1 or only the second bit is 1, but is 0 if both bits are 0 or both are 1. For example: 10100 (decimal 20) XOR 01100 (decimal 12) = 11000 (decimal 24)\n\n[Problem credits: Alex Yang, 2015] ", "locale": "en", "translations": {"en": {"title": "[USACO15FEB] Superbull S", "background": "", "description": "Bessie and her friends are playing hoofball in the annual Superbull championship, and Farmer John is in charge of making the tournament as exciting as possible. A total of $N$ $(1 <= N <= 2000)$ teams are playing in the Superbull. Each team is assigned a distinct integer team ID in the range 1...2^30-1 to distinguish it from the other teams. The Superbull is an elimination tournament -- after every game, Farmer John chooses which team to eliminate from the Superbull, and the eliminated team can no longer play in any more games. The Superbull ends when only one team remains.\n\nFarmer John notices a very unusual property about the scores in matches! In any game, the combined score of the two teams always ends up being the bitwise exclusive OR (XOR) of the two team IDs. For example, if teams 12 and 20 were to play, then 24 points would be scored in that game, since 01100 XOR 10100 = 11000.\n\nFarmer John believes that the more points are scored in a game, the more exciting the game is. Because of this, he wants to choose a series of games to be played such that the total number of points scored in the Superbull is maximized. Please help Farmer John organize the matches.", "inputFormat": "The first line contains the single integer $N$. The following $N$ lines contain the N team IDs.", "outputFormat": "Output the maximum possible number of points that can be scored in the Superbull.", "hint": "OUTPUT DETAILS: One way to achieve 37 is as follows: FJ matches teams 3 and 9, and decides that 9 wins, so teams 6, 9, and 10 are left in the tournament. He then matches teams 6 and 9, and lets team 6 win. Teams 6 and 10 are then left in the tournament. Finally, teams 6 and 10 face off, and team 10 wins. The total number of points scored is (3 XOR 9) + (6 XOR 9) + (6 XOR 10) = 10 + 15 + 12 = 37.\n\nNOTE: The bitwise exclusive OR operation, commonly denoted by the ^ symbol, is a bitwise operation that performs the logical exclusive OR operation on each position in two binary integers. The result in each position is 1 if only the first bit is 1 or only the second bit is 1, but is 0 if both bits are 0 or both are 1. For example: 10100 (decimal 20) XOR 01100 (decimal 12) = 11000 (decimal 24)\n\n[Problem credits: Alex Yang, 2015] ", "locale": "en"}, "zh-CN": {"title": "[USACO15FEB] Superbull S", "background": null, "description": "Bessie 和她的朋友们正在一年一度的 Superbull 锦标赛中比赛，Farmer John 负责让比赛尽可能精彩。总共有 $N$ $(1 \\leq N \\leq 2000)$ 支队伍参加 Superbull。每支队伍都被分配了一个唯一的整数队伍 ID，范围在 $1 \\ldots 2^{30}-1$ 之间，用于区分不同队伍。Superbull 是淘汰制比赛——每场比赛后，Farmer John 会选择淘汰其中一支队伍，被淘汰的队伍将不再参与后续比赛。当只剩一支队伍时，Superbull 结束。\n\nFarmer John 发现比赛得分有一个特殊性质：任意一场比赛中，两支队伍的得分总和总是等于两队 ID 的按位异或（XOR）。例如，若队伍 12 和 20 比赛，则该场比赛总得分为 $24$，因为 $01100 \\oplus 10100 = 11000$（即 $12 \\oplus 20 = 24$）。\n\nFarmer John 认为比赛总得分越高越精彩。因此，他希望安排一系列比赛，使得 Superbull 所有比赛的总得分最大化。请帮助他设计比赛方案。", "inputFormat": "第一行包含整数 $N$。接下来的 $N$ 行每行包含一个队伍 ID。", "outputFormat": "输出 Superbull 所有比赛可能获得的最大总得分。", "hint": "**输出样例解释**：  \n一种获得 37 分的方案如下：  \n1. Farmer John 让队伍 3 和 9 比赛，选择淘汰 3，此时剩余队伍为 6、9、10  \n2. 让队伍 6 和 9 比赛，选择淘汰 9，此时剩余队伍为 6 和 10  \n3. 最后让队伍 6 和 10 比赛  \n总得分为 $(3 \\oplus 9) + (6 \\oplus 9) + (6 \\oplus 10) = 10 + 15 + 12 = 37$。\n\n**关于按位异或**：  \n按位异或运算（记作 $\\oplus$）对两个二进制数的每一位进行逻辑异或操作。当且仅当某一位上两个数不同时，结果的该位为 1。例如：  \n$10100$（十进制 20）$\\oplus$ $01100$（十进制 12）$= 11000$（十进制 24）", "locale": "zh-CN"}}}
{"pid": "P4827", "type": "P", "difficulty": 7, "samples": [["5 2\n1 2\n1 3\n2 4\n2 5\n", "10\n7\n23\n18\n18\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "数学", "2011", "集训队互测", "组合数学", "二项式定理", "容斥原理", "Stirling 数"], "title": "[集训队互测 2011] Crash 的文明世界", "background": "", "description": "Crash 小朋友最近迷上了一款游戏——文明5 (Civilization V)。在这个游戏中，玩家可以建立和发展自己的国家，通过外交和别的国家交流，或是通过战争征服别的国家。\n\n现在 Crash 已经拥有了一个 $n$ 个城市的国家，这些城市之间通过道路相连。由于建设道路是有花费的，因此 Crash 只修建了 $n-1$ 条道路连接这些城市，不过可以保证任意两个城市都有路径相通。\n\n在游戏中，Crash 需要选择一个城市作为他的国家的首都，选择首都需要考虑很多指标，有一个指标是这样的：\n\n$$S(i) = \\sum_{j = 1}^{n}{\\rm dist}(i, j) ^ k$$\n\n其中 $S(i)$ 表示第 $i$ 个城市的指标值，${\\rm dist}(i, j)$ 表示第 $i$ 个城市到第 $j$ 个城市需要经过的道路条数的最小值，$k$ 为一个常数且为正整数。\n\n因此 Crash 交给你一个简单的任务：给出城市之间的道路，对于每个城市，输出这个城市的指标值，由于指标值可能会很大，所以你只需要输出这个数 $\\bmod\\ 10007$ 的值。", "inputFormat": "输入的第一行包括两个正整数 $n$ 和 $k$。\n\n接下来有 $n-1$ 行，每行两个正整数 $u, v$（$1\\le u, v\\le n$），表示第 $u$ 个城市和第 $v$ 个城市之间有道路相连。这些道路保证能符合题目的要求。", "outputFormat": "输出共 $n$ 行，每行一个正整数，第 $i$ 行的正整数表示第 $i$ 个城市的指标值 $\\bmod\\ 10007$ 的值。", "hint": "对于 $20 \\%$ 的数据，$n\\le 5000$，$k\\le 30$。\n\n对于 $50 \\%$ 的数据，$n\\le 5\\times 10^4$，$k\\le 30$。\n\n对于 $100 \\%$ 的数据，$1\\le n\\le 5\\times 10^4$，$1\\le k\\le 150$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTT Mutual Test 2011] Crash’s Civilization World", "background": "", "description": "Crash has recently become obsessed with a game called Civilization V. In this game, players can build and develop their own countries, communicate with other countries through diplomacy, or conquer them through war.\n\nNow Crash already owns a country with $n$ cities. These cities are connected by roads. Since building roads costs money, Crash only built $n-1$ roads to connect these cities, but it is guaranteed that there is a path between any two cities.\n\nIn the game, Crash needs to choose one city as the capital of his country. Choosing the capital requires considering many indicators, and one of them is:\n\n$$S(i) = \\sum_{j = 1}^{n}{\\rm dist}(i, j) ^ k$$\n\nHere, $S(i)$ denotes the indicator value of the $i$-th city, ${\\rm dist}(i, j)$ is the minimum number of roads that must be traveled from city $i$ to city $j$, and $k$ is a constant positive integer.\n\nSo Crash gives you a simple task: given the roads between the cities, for each city output its indicator value. Since the value may be very large, you only need to output it $\\bmod\\ 10007$.", "inputFormat": "The first line contains two positive integers $n$ and $k$.\n\nThen there are $n-1$ lines. Each line contains two positive integers $u, v$ ($1\\le u, v\\le n$), indicating that there is a road connecting city $u$ and city $v$. These roads are guaranteed to satisfy the requirements of the problem.", "outputFormat": "Output $n$ lines in total, each with one positive integer. The integer on the $i$-th line represents the indicator value of the $i$-th city $\\bmod\\ 10007$.", "hint": "For $20\\%$ of the testdata, $n\\le 5000$, $k\\le 30$.\n\nFor $50\\%$ of the testdata, $n\\le 5\\times 10^4$, $k\\le 30$.\n\nFor $100\\%$ of the testdata, $1\\le n\\le 5\\times 10^4$, $1\\le k\\le 150$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[集训队互测 2011] Crash 的文明世界", "background": "", "description": "Crash 小朋友最近迷上了一款游戏——文明5 (Civilization V)。在这个游戏中，玩家可以建立和发展自己的国家，通过外交和别的国家交流，或是通过战争征服别的国家。\n\n现在 Crash 已经拥有了一个 $n$ 个城市的国家，这些城市之间通过道路相连。由于建设道路是有花费的，因此 Crash 只修建了 $n-1$ 条道路连接这些城市，不过可以保证任意两个城市都有路径相通。\n\n在游戏中，Crash 需要选择一个城市作为他的国家的首都，选择首都需要考虑很多指标，有一个指标是这样的：\n\n$$S(i) = \\sum_{j = 1}^{n}{\\rm dist}(i, j) ^ k$$\n\n其中 $S(i)$ 表示第 $i$ 个城市的指标值，${\\rm dist}(i, j)$ 表示第 $i$ 个城市到第 $j$ 个城市需要经过的道路条数的最小值，$k$ 为一个常数且为正整数。\n\n因此 Crash 交给你一个简单的任务：给出城市之间的道路，对于每个城市，输出这个城市的指标值，由于指标值可能会很大，所以你只需要输出这个数 $\\bmod\\ 10007$ 的值。", "inputFormat": "输入的第一行包括两个正整数 $n$ 和 $k$。\n\n接下来有 $n-1$ 行，每行两个正整数 $u, v$（$1\\le u, v\\le n$），表示第 $u$ 个城市和第 $v$ 个城市之间有道路相连。这些道路保证能符合题目的要求。", "outputFormat": "输出共 $n$ 行，每行一个正整数，第 $i$ 行的正整数表示第 $i$ 个城市的指标值 $\\bmod\\ 10007$ 的值。", "hint": "对于 $20 \\%$ 的数据，$n\\le 5000$，$k\\le 30$。\n\n对于 $50 \\%$ 的数据，$n\\le 5\\times 10^4$，$k\\le 30$。\n\n对于 $100 \\%$ 的数据，$1\\le n\\le 5\\times 10^4$，$1\\le k\\le 150$。", "locale": "zh-CN"}}}
{"pid": "P4828", "type": "P", "difficulty": 5, "samples": [["5\n1 2 3 4 5\n2\n1 2\n2 2", "5\n12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "数学", "洛谷月赛"], "title": "Nagisa loves Tomoya", "background": "", "description": "可爱的古河渚得到了一个序列。她定义一次操作为 将所有的 $a_i$ 变为 $a_i+a_{(i\\ mod \\ n+1)}$ \n然后她会向你进行 $Q$ 次询问，每次问你 $x,y$ ,意义为在第 $x$ 次操作后位置 $y $ 的元素是多少。\n\n这个问题太简单了，我们的 Nagisa 轻易地就解决了这个问题。请问您能解决这个问题吗？\n", "inputFormat": "一个整数 $n$，表示序列的长度。\n\n接下来一行 $n$ 个整数，表示这个序列。\n\n\n接下来一行一个整数 $Q$，表示询问次数\n\n接下来 $Q$ 行，每行两个整数 $x,y$，意义如题所示。", "outputFormat": "共 $Q$ 行，每行一个整数表示询问的答案，请注意对 $998244353$ 取模。", "hint": "对于$30 \\%$的数据，满足：\n$1 \\leq n \\leq 100$\n\n$1 \\leq x \\leq 100$\n\n$1 \\leq Q \\leq 100$\n\n对于 $50\\%$ 的数据：\n\n$1\\leq n \\leq 100000$\n\n$1 \\leq x \\leq 500$\n\n$1 \\leq Q \\leq 100$\n\n对于 $100 \\%$ 的数据，满足\n\n$1 \\leq n \\leq 10^6$\n\n$1 \\leq a_i \\leq 10^9$\n\n$1 \\leq x \\leq 2000$\n\n$1 \\leq Q \\leq 10^4$", "locale": "zh-CN", "translations": {"en": {"title": "Nagisa loves Tomoya", "background": "", "description": "Cute Furukawa Nagisa gets a sequence. She defines one operation as changing all $a_i$ to $a_i + a_{(i\\ mod\\ n + 1)}$. Then she will ask you $Q$ queries. Each query gives $x, y$, meaning: after the $x$-th operation, what is the value of the element at position $y$.\n\nThis problem is too easy, and our Nagisa solved it effortlessly. Can you solve it too?", "inputFormat": "An integer $n$, representing the length of the sequence.\n\nThe next line contains $n$ integers, representing this sequence.\n\nThe next line contains an integer $Q$, representing the number of queries.\n\nThe next $Q$ lines each contain two integers $x, y$, with the meaning as described in the statement.", "outputFormat": "Output $Q$ lines. Each line contains one integer, the answer to the query. Please output the result modulo $998244353$.", "hint": "For $30\\%$ of the testdata, it holds that:\n\n$1 \\leq n \\leq 100$\n\n$1 \\leq x \\leq 100$\n\n$1 \\leq Q \\leq 100$\n\nFor $50\\%$ of the testdata:\n\n$1 \\leq n \\leq 100000$\n\n$1 \\leq x \\leq 500$\n\n$1 \\leq Q \\leq 100$\n\nFor $100\\%$ of the testdata, it holds that:\n\n$1 \\leq n \\leq 10^6$\n\n$1 \\leq a_i \\leq 10^9$\n\n$1 \\leq x \\leq 2000$\n\n$1 \\leq Q \\leq 10^4$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Nagisa loves Tomoya", "background": "", "description": "可爱的古河渚得到了一个序列。她定义一次操作为 将所有的 $a_i$ 变为 $a_i+a_{(i\\ mod \\ n+1)}$ \n然后她会向你进行 $Q$ 次询问，每次问你 $x,y$ ,意义为在第 $x$ 次操作后位置 $y $ 的元素是多少。\n\n这个问题太简单了，我们的 Nagisa 轻易地就解决了这个问题。请问您能解决这个问题吗？\n", "inputFormat": "一个整数 $n$，表示序列的长度。\n\n接下来一行 $n$ 个整数，表示这个序列。\n\n\n接下来一行一个整数 $Q$，表示询问次数\n\n接下来 $Q$ 行，每行两个整数 $x,y$，意义如题所示。", "outputFormat": "共 $Q$ 行，每行一个整数表示询问的答案，请注意对 $998244353$ 取模。", "hint": "对于$30 \\%$的数据，满足：\n$1 \\leq n \\leq 100$\n\n$1 \\leq x \\leq 100$\n\n$1 \\leq Q \\leq 100$\n\n对于 $50\\%$ 的数据：\n\n$1\\leq n \\leq 100000$\n\n$1 \\leq x \\leq 500$\n\n$1 \\leq Q \\leq 100$\n\n对于 $100 \\%$ 的数据，满足\n\n$1 \\leq n \\leq 10^6$\n\n$1 \\leq a_i \\leq 10^9$\n\n$1 \\leq x \\leq 2000$\n\n$1 \\leq Q \\leq 10^4$", "locale": "zh-CN"}}}
{"pid": "P4829", "type": "P", "difficulty": 5, "samples": [["5 10 233", "24"], ["5 50 3", "48"], ["1000 1000 666", "374784"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["排序", "队列", "洛谷月赛"], "title": "kry loves 2048", "background": "kls是一个人赢。", "description": "kls最近在玩一款类似2048的游戏，规则是这样的：\n\n一开始，有$n$个方块，每个方块上有一个$1$到$m$的整数。\n\nkls可以进行两种操作：\n\n1. 选择两个数字相同的方块（不一定要相邻），将它们合并成一个数字为原来的两倍的方块；\n\n2. 减小一个方块上的数字。\n\n操作的次数没有限制，最终的得分为所有方块上的最大的数字。\n\n因为kls要去陪妹子了，没有时间继续玩，他想让你帮忙计算一下，最多能得到多少分。", "inputFormat": "因为数据可能很大，读入容易超时，所以kls给你们提供了一个c++的随机数生成器。\n\n```cpp\nvoid generate_array(int a[], int n, int m, int seed) {\n    unsigned x = seed;\n    for (int i = 0; i < n; ++i) {\n        x ^= x << 13;\n        x ^= x >> 17;\n        x ^= x << 5;\n        a[i] = x % m + 1;\n    }\n}\n```\n\n把这个函数复制到你的程序里。用一个足够大的数组，以及输入数据给出的$n$，$m$和$seed$作为参数，调用这个函数。然后这个数组里就是一开始的方块上的数字（下标从0开始）。\n\n输入一行三个数$n,m,seed$，含义如上。", "outputFormat": "一行一个数，表示最大得分。", "hint": "### 样例解释\n\n样例1生成出来的数是 6 10 7 5 4。\n\n样例2生成出来的数是 8 12 48 4 4。\n\n### 数据范围\n\n对于30%的数据，$n, m \\le 10$；\n\n对于60%的数据，$n, m \\le 10^5$；\n\n对于100%的数据，$n, m \\le 10^7$，$1 \\le seed \\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "kry loves 2048", "background": "kls is a person who always wins.", "description": "kls has recently been playing a game similar to 2048. The rules are as follows.\n\nAt the beginning, there are $n$ blocks, and each block has an integer from $1$ to $m$ written on it.\n\nkls can perform two kinds of operations.\n\n1. Choose two blocks with the same number (they do not have to be adjacent) and merge them into one block whose number is twice the original.\n2. Decrease the number on a block.\n\nThere is no limit on the number of operations. The final score is the maximum number among all blocks.\n\nSince kls is going to spend time with a girl and has no time to keep playing, he wants you to help him compute the maximum score he can get.", "inputFormat": "Because the testdata may be large and direct input may easily time out, kls provides you with a C++ random number generator.\n\n```cpp\nvoid generate_array(int a[], int n, int m, int seed) {\n    unsigned x = seed;\n    for (int i = 0; i < n; ++i) {\n        x ^= x << 13;\n        x ^= x >> 17;\n        x ^= x << 5;\n        a[i] = x % m + 1;\n    }\n}\n```\n\nCopy this function into your program. Use a sufficiently large array, and call this function with $n$, $m$, and $seed$ given in the input as parameters. Then the numbers in this array are the initial numbers on the blocks (the index starts from 0).\n\nInput one line with three numbers $n, m, seed$, with meanings as above.", "outputFormat": "Output one line with one number, representing the maximum score.", "hint": "### Sample Explanation\n\nThe numbers generated in sample 1 are 6 10 7 5 4.\n\nThe numbers generated in sample 2 are 8 12 48 4 4.\n\n### Constraints\n\nFor 30% of the testdata, $n, m \\le 10$.\n\nFor 60% of the testdata, $n, m \\le 10^5$.\n\nFor 100% of the testdata, $n, m \\le 10^7$, $1 \\le seed \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "kry loves 2048", "background": "kls是一个人赢。", "description": "kls最近在玩一款类似2048的游戏，规则是这样的：\n\n一开始，有$n$个方块，每个方块上有一个$1$到$m$的整数。\n\nkls可以进行两种操作：\n\n1. 选择两个数字相同的方块（不一定要相邻），将它们合并成一个数字为原来的两倍的方块；\n\n2. 减小一个方块上的数字。\n\n操作的次数没有限制，最终的得分为所有方块上的最大的数字。\n\n因为kls要去陪妹子了，没有时间继续玩，他想让你帮忙计算一下，最多能得到多少分。", "inputFormat": "因为数据可能很大，读入容易超时，所以kls给你们提供了一个c++的随机数生成器。\n\n```cpp\nvoid generate_array(int a[], int n, int m, int seed) {\n    unsigned x = seed;\n    for (int i = 0; i < n; ++i) {\n        x ^= x << 13;\n        x ^= x >> 17;\n        x ^= x << 5;\n        a[i] = x % m + 1;\n    }\n}\n```\n\n把这个函数复制到你的程序里。用一个足够大的数组，以及输入数据给出的$n$，$m$和$seed$作为参数，调用这个函数。然后这个数组里就是一开始的方块上的数字（下标从0开始）。\n\n输入一行三个数$n,m,seed$，含义如上。", "outputFormat": "一行一个数，表示最大得分。", "hint": "### 样例解释\n\n样例1生成出来的数是 6 10 7 5 4。\n\n样例2生成出来的数是 8 12 48 4 4。\n\n### 数据范围\n\n对于30%的数据，$n, m \\le 10$；\n\n对于60%的数据，$n, m \\le 10^5$；\n\n对于100%的数据，$n, m \\le 10^7$，$1 \\le seed \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P4830", "type": "P", "difficulty": 5, "samples": [["3 1", "666666672"], ["3 0", "333333336"], ["4 1", "750000006"], ["4 2", "625000005"], ["100000 99998", "439903656"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "贪心", "洛谷月赛"], "title": "选择题", "background": "", "description": "docriz 正在考试，他遇到了一个奇怪的选择题：这个选择题共有 $n$ 个选项，其中只有一个选项是正确的。他完全不会做这题，所以只能靠蒙。\n\n蒙这道题分为 $n - 2$ 轮，在第 $1$ 轮开始之前，docriz 会在这 $n$ 个选项中随机蒙一项，之后的每轮流程如下：首先，nocriz 会过来帮他排除一个选项，由于 nocriz 事先知道答案，所以他会在现有的除正确的那一项和 docirz 正在选的那一项外的选项里，随机删去一个。之后，docriz 可以选择是否更换自己蒙的选项，如果更换，则随机更换到除正在选的那一项之外的任意一项。\n\ndocriz 在这 $n - 2$ 轮中，由于和 nocriz 达成的神秘协定，需要恰好更换 $k$ 次选项。他想知道，如何更换，使得自己蒙对的概率最大，输出这个概率。为了方便，你需要输出这个概率的分数形式在模 $10^9 + 7$ 意义下的结果。", "inputFormat": "一行两个整数 $n, k$，意义如上所述。", "outputFormat": "一行一个数，表示答案。", "hint": "样例 $1$ 到 $4$ 分别为 $\\frac{2}{3}, \\frac{1}{3}, \\frac{3}{4}, \\frac{5}{8}$。\n\n对于 $30\\%$ 的数据，保证 $5 \\leq n \\leq 10$。\n\n对于另外 $5\\%$ 的数据，保证 $k = 0$。\n\n对于另外 $10\\%$ 的数据，保证 $k = 1$。\n\n对于另外 $10\\%$ 的数据，保证 $k = n - 2$。\n\n对于另外 $5\\%$ 的数据，保证 $n \\leq 10^2$。\n\n对于另外 $10\\%$ 的数据，保证 $n \\leq 10^3$。\n\n对于 $100\\%$ 的数据，保证 $5 \\leq n \\leq 10^5, 0 \\leq k \\leq n - 2$。", "locale": "zh-CN", "translations": {"en": {"title": "Multiple-choice Question.", "background": "", "description": "docriz is taking an exam, and he encounters a strange multiple-choice question: there are $n$ options in total, and only one option is correct. He cannot solve it at all, so he can only guess.\n\nGuessing this question consists of $n - 2$ rounds. Before round $1$ starts, docriz randomly guesses one of the $n$ options. Then, in each following round, the process is as follows: first, nocriz comes to help him eliminate one option. Since nocriz knows the answer in advance, he will randomly delete one option among the current options, excluding the correct option and the option that docriz is currently choosing. After that, docriz may choose whether to switch his guessed option. If he switches, he randomly switches to any option other than the one he is currently choosing.\n\nDuring these $n - 2$ rounds, due to a mysterious agreement with nocriz, docriz must switch options exactly $k$ times. He wants to know how to switch so that the probability of guessing correctly is maximized, and you should output this probability. For convenience, you need to output the result of this probability in fractional form modulo $10^9 + 7$.", "inputFormat": "One line with two integers $n, k$, with the meanings as described above.", "outputFormat": "One line with one number, representing the answer.", "hint": "Samples $1$ to $4$ are $\\frac{2}{3}, \\frac{1}{3}, \\frac{3}{4}, \\frac{5}{8}$, respectively.\n\nFor $30\\%$ of the testdata, it is guaranteed that $5 \\leq n \\leq 10$.\n\nFor another $5\\%$ of the testdata, it is guaranteed that $k = 0$.\n\nFor another $10\\%$ of the testdata, it is guaranteed that $k = 1$.\n\nFor another $10\\%$ of the testdata, it is guaranteed that $k = n - 2$.\n\nFor another $5\\%$ of the testdata, it is guaranteed that $n \\leq 10^2$.\n\nFor another $10\\%$ of the testdata, it is guaranteed that $n \\leq 10^3$.\n\nFor $100\\%$ of the testdata, it is guaranteed that $5 \\leq n \\leq 10^5, 0 \\leq k \\leq n - 2$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "选择题", "background": "", "description": "docriz 正在考试，他遇到了一个奇怪的选择题：这个选择题共有 $n$ 个选项，其中只有一个选项是正确的。他完全不会做这题，所以只能靠蒙。\n\n蒙这道题分为 $n - 2$ 轮，在第 $1$ 轮开始之前，docriz 会在这 $n$ 个选项中随机蒙一项，之后的每轮流程如下：首先，nocriz 会过来帮他排除一个选项，由于 nocriz 事先知道答案，所以他会在现有的除正确的那一项和 docirz 正在选的那一项外的选项里，随机删去一个。之后，docriz 可以选择是否更换自己蒙的选项，如果更换，则随机更换到除正在选的那一项之外的任意一项。\n\ndocriz 在这 $n - 2$ 轮中，由于和 nocriz 达成的神秘协定，需要恰好更换 $k$ 次选项。他想知道，如何更换，使得自己蒙对的概率最大，输出这个概率。为了方便，你需要输出这个概率的分数形式在模 $10^9 + 7$ 意义下的结果。", "inputFormat": "一行两个整数 $n, k$，意义如上所述。", "outputFormat": "一行一个数，表示答案。", "hint": "样例 $1$ 到 $4$ 分别为 $\\frac{2}{3}, \\frac{1}{3}, \\frac{3}{4}, \\frac{5}{8}$。\n\n对于 $30\\%$ 的数据，保证 $5 \\leq n \\leq 10$。\n\n对于另外 $5\\%$ 的数据，保证 $k = 0$。\n\n对于另外 $10\\%$ 的数据，保证 $k = 1$。\n\n对于另外 $10\\%$ 的数据，保证 $k = n - 2$。\n\n对于另外 $5\\%$ 的数据，保证 $n \\leq 10^2$。\n\n对于另外 $10\\%$ 的数据，保证 $n \\leq 10^3$。\n\n对于 $100\\%$ 的数据，保证 $5 \\leq n \\leq 10^5, 0 \\leq k \\leq n - 2$。", "locale": "zh-CN"}}}
{"pid": "P4831", "type": "P", "difficulty": 6, "samples": [["4 4", "90"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["多项式", "组合数学", "容斥原理", "生成函数", "洛谷月赛"], "title": "Scarlet loves WenHuaKe", "background": "Scarlet上大学了，在此之前，她加强了一道高考模拟题QAQ", "description": "Scarlet尝试在 $n$ 行 $m$ 列的中国象棋棋盘上放置 $2\\times n$ 个炮，使得它们互不攻击。\n\n大家都知道 Scarlet 沉迷搞事，她想问你有多少个方案。", "inputFormat": "一行两个整数，分别表示 $n$ 和 $m$。", "outputFormat": "一个整数，表示方案数对 $998244353$ 取模后的值。", "hint": "对于 $20\\%$ 的数据，$n,m\\leq5$；\n\n对于另 $25\\%$ 的数据，$n,m\\leq2000$；\n\n对于另 $20\\%$ 的数据，$n=m$；\n\n对于剩下的 $35\\%$ 的数据，$m-n\\leq10$；\n\n对于 $100\\%$ 的数据，有 $1\\leq n\\leq m\\leq100000$。", "locale": "zh-CN", "translations": {"en": {"title": "Scarlet Loves WenHuaKe", "background": "Scarlet has started college. Before that, she worked hard on a Gaokao mock exam problem QAQ.", "description": "Scarlet tries to place $2\\times n$ cannons on an $n$-row $m$-column Chinese chessboard such that none of them can attack each other.\n\nAs everyone knows, Scarlet loves making trouble. She wants to ask how many valid configurations there are.", "inputFormat": "One line with two integers, representing $n$ and $m$.", "outputFormat": "One integer, the number of configurations modulo $998244353$.", "hint": "For $20\\%$ of the testdata, $n,m\\leq5$.\n\nFor another $25\\%$ of the testdata, $n,m\\leq2000$.\n\nFor another $20\\%$ of the testdata, $n=m$.\n\nFor the remaining $35\\%$ of the testdata, $m-n\\leq10$.\n\nFor $100\\%$ of the testdata, $1\\leq n\\leq m\\leq100000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Scarlet loves WenHuaKe", "background": "Scarlet上大学了，在此之前，她加强了一道高考模拟题QAQ", "description": "Scarlet尝试在 $n$ 行 $m$ 列的中国象棋棋盘上放置 $2\\times n$ 个炮，使得它们互不攻击。\n\n大家都知道 Scarlet 沉迷搞事，她想问你有多少个方案。", "inputFormat": "一行两个整数，分别表示 $n$ 和 $m$。", "outputFormat": "一个整数，表示方案数对 $998244353$ 取模后的值。", "hint": "对于 $20\\%$ 的数据，$n,m\\leq5$；\n\n对于另 $25\\%$ 的数据，$n,m\\leq2000$；\n\n对于另 $20\\%$ 的数据，$n=m$；\n\n对于剩下的 $35\\%$ 的数据，$m-n\\leq10$；\n\n对于 $100\\%$ 的数据，有 $1\\leq n\\leq m\\leq100000$。", "locale": "zh-CN"}}}
{"pid": "P4832", "type": "P", "difficulty": 4, "samples": [["3\ns+c\ns+c+s\nc\n", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "背包 DP"], "title": "珈百璃堕落的开始", "background": "\n“恭喜你，珈百璃，你以学年首席的优秀成绩毕业。”\n\n珈百璃，一位优秀的天使，今天她以学年首席的成绩毕业，从今往后，她将前往人间进行进一步修炼。\n\n“我会努力给人类带来幸福的！”珈百璃憧憬着人间生活。\n\n开学第一天，珈百璃就凭借着她极其可爱的外表，受到了班级成员的追捧，不仅长得可爱，成绩还很优秀，简直就是女神啊！\n\n因为她的成绩优秀，所以她的作业也是很快就快要完成了，但是就在她快完成数学作业时，她的电脑传来了呼救的声音。\n\n“救命啊！”\n\n顺着这个呼救声，珈百璃望向了电脑。\n\n“原来是游戏啊。”珈百璃看着屏幕里一位倒在地上的残血战士，注册了账号，选择了牧师职业，对这位战士进行了救治。在珈百璃开心的同时，越来越多的呼救声传来，珈百璃一个一个进行救治，但她的 level 才 1，mp 肯定不足，当她想要继续进行救治的时候，系统提示 mp 不足，并给出了氪金的提示：“屠龙宝刀，点击就送。”\n\n“生活费天界学院倒是有给，但是……”珈百璃看着自己的存折，再看看屏幕，她纠结不已。\n\n“救命啊！”“救……救命啊……”“救命啊！”珈百璃看着这些人一个个喊出救命，自己却无能为力，终于，她控制不住自己，点下了“氪金”按钮。\n\n从此，珈百璃的堕落就开始了，她的作业，也停在了这道数学题上……\n\n“薇奈特，帮我写一下作业嘛。”珈百璃央求着薇奈特。\n\n“真是的，你好歹也是天使呢，也该自己做一点作业吧。”\n\n“不要，我还要打游戏呢。”\n\n“这怎么行，你是天使啊。”\n\n“我已经决定做一位成天打游戏不学习的堕天使了。”\n\n“真是服了你啊，那你好好打游戏吧，我帮你写。”\n", "description": "这道题是这样的：给定一些 $\\sin^2x$，$\\cos^2x\\ \\left(x=\\dfrac{\\pi}{7}\\right)$ 组成的式子，请你帮忙求出选择一些式子相加后得到的**最大整数答案**。", "inputFormat": "第一行一个整数 $n$，表示 $n$ 个式子\n\n接下来 $n$ 行每行一个字符串，由 $f(i)=\\sin^2x,\\cos^2x$ 和加号组成，$x=\\dfrac{\\pi}{7}$。\n\n为了简化输入，我们以 `s` 代表 $\\sin^2x$，以 `c` 代表 $\\cos^2x$，并省略 `f(i)=`。", "outputFormat": "一个数表示**最大整数答案**，计算全部为加法。\n", "hint": "### 样例解释\n\n三个式子都选，则加起来等于 $3$。\n\n### 数据范围\n\n设 `s` 和 `c` 的个数总和为 $m$。\n\n$10\\%$ 的数据 $n=1$。\n\n另外 $20\\%$ 的数据每行一个单项式。\n\n另有 $20\\%$ 的数据 $n\\le20$。\n\n$100\\%$ 的数据 $n\\times m\\le5\\times10^7,m\\le10^6$。\n\n### 提示\n\n - $\\forall x, \\sin^2x+\\cos^2x=1$。", "locale": "zh-CN", "translations": {"en": {"title": "The Beginning of Gabriel's Fall", "background": "\"Congratulations, Gabriel. You graduated as the top student of the year.\"\n\nGabriel, an excellent angel, graduated today as the valedictorian. From now on, she will go to the human world for further training.\n\n\"I will work hard to bring happiness to humans!\" Gabriel looked forward to life in the human world.\n\nOn the first day of school, thanks to her extremely cute appearance, Gabriel was adored by her classmates. Not only was she cute, but she also had excellent grades. She was practically a goddess!\n\nBecause of her excellent grades, she was about to finish her homework quickly. However, just as she was about to finish her math homework, a cry for help came from her computer.\n\n\"Help!\"\n\nFollowing the cry, Gabriel looked at the computer.\n\n\"So it was a game.\" Gabriel saw a critically wounded warrior lying on the ground on the screen. She registered an account, chose the priest class, and healed the warrior. While Gabriel felt happy, more and more cries for help came. Gabriel healed them one by one, but her level was only 1, and her MP was certainly insufficient. When she tried to continue healing, the system prompted that MP was insufficient and displayed a pay-to-win hint: \"Dragon-slaying blade, just click to get it.\"\n\n\"The Celestial Academy does give living expenses, but...\" Gabriel looked at her bankbook, then at the screen, torn.\n\n\"Help!\" \"He... help...\" \"Help!\" Gabriel watched as people cried for help one after another, yet she could do nothing. Finally, she could not hold herself back and clicked the \"pay\" button.\n\nFrom then on, Gabriel’s fall began, and her homework got stuck on this math problem...\n\n\"Vignette, help me with my homework, please,\" Gabriel pleaded.\n\n\"Honestly, you’re an angel at least. You should do some of your homework yourself.\"\n\n\"No, I still want to play games.\"\n\n\"That won’t do. You’re an angel.\"\n\n\"I’ve decided to become a fallen angel who plays games all day and doesn’t study.\"\n\n\"I give up. Fine, play your game. I’ll help you write it.\"", "description": "The problem is as follows: given some expressions composed of $\\sin^2 x$ and $\\cos^2 x$ with $x=\\dfrac{\\pi}{7}$, please find the maximum integer value you can obtain by selecting some of the expressions and summing them.", "inputFormat": "The first line contains an integer $n$, indicating $n$ expressions.\n\nEach of the next $n$ lines contains a string formed by $f(i)=\\sin^2 x$, $\\cos^2 x$ and plus signs, with $x=\\dfrac{\\pi}{7}$.\n\nTo simplify the input, we use `s` to represent $\\sin^2 x$, `c` to represent $\\cos^2 x$, and omit `f(i)=`.", "outputFormat": "Output a single number representing the maximum integer answer. All operations are addition.", "hint": "Sample Explanation:\n- If you pick all three expressions, their sum equals $3$.\n\nConstraints:\n- Let the total count of `s` and `c` be $m$.\n- For $10\\%$ of the testdata, $n=1$.\n- For another $20\\%$ of the testdata, each line is a single-term expression.\n- For another $20\\%$ of the testdata, $n \\le 20$.\n- For $100\\%$ of the testdata, $n \\times m \\le 5 \\times 10^7$, $m \\le 10^6$.\n\nTips:\n- $\\forall x,\\ \\sin^2 x + \\cos^2 x = 1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "珈百璃堕落的开始", "background": "\n“恭喜你，珈百璃，你以学年首席的优秀成绩毕业。”\n\n珈百璃，一位优秀的天使，今天她以学年首席的成绩毕业，从今往后，她将前往人间进行进一步修炼。\n\n“我会努力给人类带来幸福的！”珈百璃憧憬着人间生活。\n\n开学第一天，珈百璃就凭借着她极其可爱的外表，受到了班级成员的追捧，不仅长得可爱，成绩还很优秀，简直就是女神啊！\n\n因为她的成绩优秀，所以她的作业也是很快就快要完成了，但是就在她快完成数学作业时，她的电脑传来了呼救的声音。\n\n“救命啊！”\n\n顺着这个呼救声，珈百璃望向了电脑。\n\n“原来是游戏啊。”珈百璃看着屏幕里一位倒在地上的残血战士，注册了账号，选择了牧师职业，对这位战士进行了救治。在珈百璃开心的同时，越来越多的呼救声传来，珈百璃一个一个进行救治，但她的 level 才 1，mp 肯定不足，当她想要继续进行救治的时候，系统提示 mp 不足，并给出了氪金的提示：“屠龙宝刀，点击就送。”\n\n“生活费天界学院倒是有给，但是……”珈百璃看着自己的存折，再看看屏幕，她纠结不已。\n\n“救命啊！”“救……救命啊……”“救命啊！”珈百璃看着这些人一个个喊出救命，自己却无能为力，终于，她控制不住自己，点下了“氪金”按钮。\n\n从此，珈百璃的堕落就开始了，她的作业，也停在了这道数学题上……\n\n“薇奈特，帮我写一下作业嘛。”珈百璃央求着薇奈特。\n\n“真是的，你好歹也是天使呢，也该自己做一点作业吧。”\n\n“不要，我还要打游戏呢。”\n\n“这怎么行，你是天使啊。”\n\n“我已经决定做一位成天打游戏不学习的堕天使了。”\n\n“真是服了你啊，那你好好打游戏吧，我帮你写。”\n", "description": "这道题是这样的：给定一些 $\\sin^2x$，$\\cos^2x\\ \\left(x=\\dfrac{\\pi}{7}\\right)$ 组成的式子，请你帮忙求出选择一些式子相加后得到的**最大整数答案**。", "inputFormat": "第一行一个整数 $n$，表示 $n$ 个式子\n\n接下来 $n$ 行每行一个字符串，由 $f(i)=\\sin^2x,\\cos^2x$ 和加号组成，$x=\\dfrac{\\pi}{7}$。\n\n为了简化输入，我们以 `s` 代表 $\\sin^2x$，以 `c` 代表 $\\cos^2x$，并省略 `f(i)=`。", "outputFormat": "一个数表示**最大整数答案**，计算全部为加法。\n", "hint": "### 样例解释\n\n三个式子都选，则加起来等于 $3$。\n\n### 数据范围\n\n设 `s` 和 `c` 的个数总和为 $m$。\n\n$10\\%$ 的数据 $n=1$。\n\n另外 $20\\%$ 的数据每行一个单项式。\n\n另有 $20\\%$ 的数据 $n\\le20$。\n\n$100\\%$ 的数据 $n\\times m\\le5\\times10^7,m\\le10^6$。\n\n### 提示\n\n - $\\forall x, \\sin^2x+\\cos^2x=1$。", "locale": "zh-CN"}}}
{"pid": "P4833", "type": "P", "difficulty": 6, "samples": [["3 2\n1 2\n2 3\n", "2\n1 2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["图论", "枚举", "队列"], "title": "萨塔尼亚的一生之敌", "background": "“Trick or treat！”\n\n万圣节到了，薇奈特、萨塔尼亚和菈菲尔敲开了珈百璃的门，但果然不出所料，珈百璃在打网游，真是颓废啊。\n\n“干嘛，烦死了”珈百璃一脸嫌弃地看着她们\n\n“珈百璃，好歹也出来玩玩嘛，天天待在家里打游戏，会烂掉的”薇奈特抢先说道\n\n“哈？我每天都出去玩啊，去买泡面的时候顺路在家楼下逛了一圈啊”\n\n“这只能算是去小卖部吧，根本不算是出去玩吧”\n\n“对啊，而且万圣节到了，我们一起出去要糖果吃呀”\n\n“哈？你几岁了？还玩这么无聊的游戏”\n\n“不会啊，我觉得很有趣啊”三人异口同声\n\n“真是的，好吧好吧，就陪你们玩玩”\n\n于是珈百璃随着他们三个出去要糖果吃了\n\n“那么，先去谁家呢？”\n\n“我有提议！！”萨塔尼亚激动地抢着说\n\n于是，她们一行人来到了某人家。\n\n“咚咚咚”过了一会，门开了，走出来的，是一个光头吴克\n\n“Trick or treat！”萨塔尼亚开心地叫倒。面前站的，就是她们的班主任。但是，除了萨塔尼亚在开心的要糖果，其他三个人早已经吓得瑟瑟发抖了\n\n“呃。。班。。班主任。。。？老。。老师，这是有误会的。。。”薇奈特颤抖地说道\n\n“哪有什么误会啊？班主任，Trick or treat！哦~再不给糖，就把你画成鬼~”萨塔尼亚依旧天不怕地不怕\n\n“喂。。。”薇奈特微微后退了一步\n\n但令人惊讶的是，老师居然进房间，拿了一袋礼品出来，其中包括萨塔尼亚最喜欢的限量版菠萝包\n\n“啊！！！是限量版的！！！太好了！！！”当萨塔尼亚刚要伸手去拿菠萝包时，天使的走狗杀了出来，一把抢走了菠萝包。\n\n“喂！！那是我的！！你给我回来”萨塔尼亚生气地望着天使的走狗，宣誓自己一定要抢回来\n\n萨塔尼亚势力和天使的走狗势力占领着不同的区域，每个天使的走狗占领的区域都会有一个菠萝包，萨塔尼亚想抢回这些菠萝包，你能帮助她吗？\n", "description": "详情是这样的，在萨塔尼亚强大的立场下，这个世界被分成了若干区域，有一些区域有连边。为了能够抢回菠萝包，萨亚尼亚将这些区域再分成了若干领域，使得每个领域由一些区域组成，萨塔尼亚占领了一些领域，并以这些领域为基础向走狗发起进攻。为了成功夺回所有菠萝包，萨塔尼亚决定让这些自己占领的领域满足以下性质\n\n1、    为了能够及时支援友军，在自己占领的领域中，每两个存在于不同领域的两个点都要有连边\n\n2、    为了能够灵活的进攻，自己的任意一个领域中的任意一个点和走狗占领的任意一个领域中的任意一个点都要有连边\n\n当然走狗也不是吃干饭的，它为了羞辱萨塔尼亚，也选择了一些领域，这些领域满足的性质和萨塔尼亚选择的领域满足的性质一样，且走狗的领域和萨塔尼亚的领域互补\n\n萨塔尼亚觉得，只要将领域分的越分散，胜利的几率就越大，于是想分尽可能多的领域，请问最多能分多少领域？每个领域有多少个区域组成？\n\n\\*特殊的，一个人可能占领不到任何一个领域，即占领的领域数量为0。如果你能告诉萨塔尼亚答案，萨塔尼亚就会占领最大的领域向走狗发起进攻，并最终失败。\n", "inputFormat": "第一行两个整数n和m，表示n个区域m条边\n\n接下来m行每行两个数a，b表示a和b之间有连边，保证没有自环和重边\n", "outputFormat": "第一行输出一个整数s表示最多能分成领几个领域\n\n第二行s个数从小到大输出每个领域由几个区域组成\n", "hint": "样例解释：最多分成两个领域，区域1、3为一个领域，区域2为一个领域\n\n请结合样例仔细读题！\n\n对于40%的数据，n≤10^3，m≤5\\*10^5\n\n对于100%的数据，n≤10^5，m≤2\\*10^6\n", "locale": "zh-CN", "translations": {"en": {"title": "Satania's Archnemesis", "background": "\"Trick or treat!\"\n\nIt’s Halloween. Vignette, Satania, and Raphiel knock on Gabriel’s door—but as expected, Gabriel is playing online games. Truly decadent.\n\n\"What is it? So annoying.\" Gabriel looks at them with obvious disgust.\n\n\"Gabriel, at least come out and have some fun. Staying home gaming every day will rot your brain,\" Vignette says first.\n\n\"Huh? I go out every day. When I go to buy instant noodles, I take a stroll around the building downstairs.\"\n\n\"That only counts as going to the convenience store. It doesn’t count as going out to have fun.\"\n\n\"Yeah, and it’s Halloween. Let’s go get some candy together.\"\n\n\"Huh? How old are you? Still playing such a boring game.\"\n\n\"Not at all, I think it’s fun,\" the three say in unison.\n\n\"Good grief. Fine, fine, I’ll play along.\"\n\nSo Gabriel goes out with the three of them to ask for candy.\n\n\"So, whose place first?\"\n\n\"I have a suggestion!!\" Satania says excitedly, cutting in.\n\nThey arrive at someone’s home.\n\n\"Knock, knock.\" After a moment, the door opens, and out comes a bald man.\n\n\"Trick or treat!\" Satania calls out happily. Standing before them is their homeroom teacher. But while Satania is cheerfully asking for candy, the other three are already trembling in fear.\n\n\"Uh... ho- homeroom teacher...? T- teacher, there’s been a misunderstanding...\" Vignette says, shaking.\n\n\"What misunderstanding? Homeroom teacher, trick or treat! Oh~ if you don’t give us candy, we’ll draw you into a ghost~\" Satania remains fearless.\n\n\"Hey...\" Vignette takes a small step back.\n\nSurprisingly, the teacher goes back inside and takes out a bag of treats, including Satania’s favorite limited-edition pineapple bun.\n\n\"Ah!!! It’s the limited edition!!! Awesome!!!\" Just as Satania reaches for the bun, the angel’s lackey rushes out and snatches it away.\n\n\"Hey!! That’s mine!! Give it back!\" Satania glares at the angel’s lackey, vowing to take it back.\n\nSatania’s forces and the angel’s lackey’s forces occupy different areas. Each area occupied by the angel’s lackey contains one pineapple bun. Satania wants to take these pineapple buns back. Can you help her?", "description": "Here are the details. Under Satania’s overwhelming influence, the world is divided into several regions, with some pairs of regions connected by edges. To take back the pineapple buns, Satania further partitions these regions into several domains, each domain consisting of some regions. Satania occupies some of these domains and uses them as bases to attack the lackey. To successfully reclaim all pineapple buns, Satania decides that the domains she occupies must satisfy the following properties:\n\n1. To ensure timely support among allies, for any two vertices that lie in different domains among the domains she occupies, there must be an edge between them.\n\n2. To attack flexibly, for any vertex in any of her domains and any vertex in any domain occupied by the lackey, there must be an edge between them.\n\nOf course, the lackey is not idle either. To humiliate Satania, the lackey also chooses some domains. These domains satisfy the same property as Satania’s choices: for any two vertices that lie in different domains among the lackey’s domains, there must be an edge between them. Moreover, the lackey’s domains are the complement of Satania’s domains (together they cover all domains, and they are disjoint). A person may occupy zero domains.\n\nSatania believes that the more scattered the domains, the higher her chance of victory. She wants to split the regions into as many domains as possible. What is the maximum number of domains, and how many regions does each domain contain?\n\nIf you tell Satania the answer, she will gather the largest domain to attack the lackey and ultimately fail.", "inputFormat": "- The first line contains two integers $n$ and $m$, the number of regions and the number of edges.\n- Each of the next $m$ lines contains two integers $a$, $b$, indicating that there is an edge between $a$ and $b$.\n- There are no self-loops and no multiple edges.", "outputFormat": "- On the first line, output an integer $s$, the maximum possible number of domains.\n- On the second line, output $s$ integers in nondecreasing order, where each number is the size (number of regions) of one domain.", "hint": "Sample explanation: The maximum is two domains. Regions $1$ and $3$ form one domain, and region $2$ forms one domain. Please read the statement carefully together with the sample.\n\nConstraints:\n- For $40\\%$ of the testdata, $n \\le 10^3$, $m \\le 5 \\times 10^5$.\n- For $100\\%$ of the testdata, $n \\le 10^5$, $m \\le 2 \\times 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "萨塔尼亚的一生之敌", "background": "“Trick or treat！”\n\n万圣节到了，薇奈特、萨塔尼亚和菈菲尔敲开了珈百璃的门，但果然不出所料，珈百璃在打网游，真是颓废啊。\n\n“干嘛，烦死了”珈百璃一脸嫌弃地看着她们\n\n“珈百璃，好歹也出来玩玩嘛，天天待在家里打游戏，会烂掉的”薇奈特抢先说道\n\n“哈？我每天都出去玩啊，去买泡面的时候顺路在家楼下逛了一圈啊”\n\n“这只能算是去小卖部吧，根本不算是出去玩吧”\n\n“对啊，而且万圣节到了，我们一起出去要糖果吃呀”\n\n“哈？你几岁了？还玩这么无聊的游戏”\n\n“不会啊，我觉得很有趣啊”三人异口同声\n\n“真是的，好吧好吧，就陪你们玩玩”\n\n于是珈百璃随着他们三个出去要糖果吃了\n\n“那么，先去谁家呢？”\n\n“我有提议！！”萨塔尼亚激动地抢着说\n\n于是，她们一行人来到了某人家。\n\n“咚咚咚”过了一会，门开了，走出来的，是一个光头吴克\n\n“Trick or treat！”萨塔尼亚开心地叫倒。面前站的，就是她们的班主任。但是，除了萨塔尼亚在开心的要糖果，其他三个人早已经吓得瑟瑟发抖了\n\n“呃。。班。。班主任。。。？老。。老师，这是有误会的。。。”薇奈特颤抖地说道\n\n“哪有什么误会啊？班主任，Trick or treat！哦~再不给糖，就把你画成鬼~”萨塔尼亚依旧天不怕地不怕\n\n“喂。。。”薇奈特微微后退了一步\n\n但令人惊讶的是，老师居然进房间，拿了一袋礼品出来，其中包括萨塔尼亚最喜欢的限量版菠萝包\n\n“啊！！！是限量版的！！！太好了！！！”当萨塔尼亚刚要伸手去拿菠萝包时，天使的走狗杀了出来，一把抢走了菠萝包。\n\n“喂！！那是我的！！你给我回来”萨塔尼亚生气地望着天使的走狗，宣誓自己一定要抢回来\n\n萨塔尼亚势力和天使的走狗势力占领着不同的区域，每个天使的走狗占领的区域都会有一个菠萝包，萨塔尼亚想抢回这些菠萝包，你能帮助她吗？\n", "description": "详情是这样的，在萨塔尼亚强大的立场下，这个世界被分成了若干区域，有一些区域有连边。为了能够抢回菠萝包，萨亚尼亚将这些区域再分成了若干领域，使得每个领域由一些区域组成，萨塔尼亚占领了一些领域，并以这些领域为基础向走狗发起进攻。为了成功夺回所有菠萝包，萨塔尼亚决定让这些自己占领的领域满足以下性质\n\n1、    为了能够及时支援友军，在自己占领的领域中，每两个存在于不同领域的两个点都要有连边\n\n2、    为了能够灵活的进攻，自己的任意一个领域中的任意一个点和走狗占领的任意一个领域中的任意一个点都要有连边\n\n当然走狗也不是吃干饭的，它为了羞辱萨塔尼亚，也选择了一些领域，这些领域满足的性质和萨塔尼亚选择的领域满足的性质一样，且走狗的领域和萨塔尼亚的领域互补\n\n萨塔尼亚觉得，只要将领域分的越分散，胜利的几率就越大，于是想分尽可能多的领域，请问最多能分多少领域？每个领域有多少个区域组成？\n\n\\*特殊的，一个人可能占领不到任何一个领域，即占领的领域数量为0。如果你能告诉萨塔尼亚答案，萨塔尼亚就会占领最大的领域向走狗发起进攻，并最终失败。\n", "inputFormat": "第一行两个整数n和m，表示n个区域m条边\n\n接下来m行每行两个数a，b表示a和b之间有连边，保证没有自环和重边\n", "outputFormat": "第一行输出一个整数s表示最多能分成领几个领域\n\n第二行s个数从小到大输出每个领域由几个区域组成\n", "hint": "样例解释：最多分成两个领域，区域1、3为一个领域，区域2为一个领域\n\n请结合样例仔细读题！\n\n对于40%的数据，n≤10^3，m≤5\\*10^5\n\n对于100%的数据，n≤10^5，m≤2\\*10^6\n", "locale": "zh-CN"}}}
{"pid": "P4834", "type": "P", "difficulty": 6, "samples": [["1\n2\n", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["数学", "矩阵加速", "Fibonacci 数列", "逆元"], "title": "萨塔尼亚的期末考试", "background": "“呐，珈百璃，我说，暑假我们去哪里玩呢？”薇奈特拍拍珈百璃的肩膀\n\n“哈？暑假当然是在家里打游戏啦”珈百璃无精打采地回答道\n\n“怎么能这样呢？你好歹也是天使啊，给我拿出天使的样子来啊”\n\n“真麻烦”\n\n“所以，暑假我们去海边玩吧？”\n\n“赞成赞成！去海边玩的话，就可以好好调戏珈百璃了”菈菲尔不知道什么时候凑进来\n\n“麻烦死了。”\n\n这边一群人正讨论着暑假去哪玩，然而萨塔尼亚在旁边听得很纠结，因为没有人邀请她。。\n\n“哼哼哼哼，吾乃神魔萨塔尼亚，怎么可能主动去加入呢，我必须等她们邀请我”萨塔尼亚心理打着小算盘\n\n“呐，我说，萨塔尼亚貌似有点小不开心呀”\n\n“已经不是貌似了吧，她这表情完全没有掩盖的意思啊。。”\n\n“呐，我说，要不要邀请她去啊？”\n\n拉菲尓说着，走向了萨塔尼亚。“萨塔尼亚桑，暑假我们要去海边玩哟~”\n\n“哼哼哼，终于来邀请我了吗”萨塔尼亚心里有点小开心，小声嘀咕到\n\n“萨塔尼亚桑就好好待在这里哟~”\n\n“额。。。”萨塔尼亚受到了成吨的暴击，“喂，我说，哪有你这样的啊”\n\n“恩？因为，萨塔尼亚桑，暑假如果要出去玩的话，就要通过期末考试哟，不然会被留下来补课的”\n\n“补。。。补课。。。。”萨塔尼亚貌似意会到了什么，脸色大变，“补课。。。呐，拉菲尓。。你。。你能帮我。。补习吗？”\n\n“恩？可以呀~但是期末考试如何就得看你自己了”\n\n“谢谢，那帮我看看这些哪里错了吧？我完全不懂诶”\n\n“我看看。。。” 拉菲尓丢下珈百璃和薇奈特独自给萨塔尼亚开始了补习。\n\n终于，期末考来了，萨塔尼亚努力的这么久，就看这次考试了！经过长期的努力，期末考一切顺利，除了还没考的数学其他学科都及格啦！\n\n终于到了最后一场考试——物理考试。很不错的是，萨塔尼亚已经答完了59分而且全对，但是她遇到了一道绝世难题，而且她很惊奇的发现，总分100分，这题41分，如果不写出来，就会挂科。“期末考如果有某人有挂科，那么那个人的暑假要参加补课以及补考！”班主任的话萦绕在她的耳旁，这可怎么办啊。。。\n", "description": "这道题是这样的：\n\n有一个由 $n$ 个点电荷形成的电场。假定每个点电荷放出的电场都是匀强电场而不是点电荷电场，第 $i$ 个点电荷的电场强度 $E_i=i$。\n\n现放一个带负电的试探电荷到这个电场中，这个试探电荷只要触碰到任何一个点电荷就会和这个点电荷发生聚变放出巨大能量。\n\n因为点电荷放出的电场强度不同，所以试探电荷被吸引到每个点电荷的概率也不同，点电荷给试探电荷的吸引力越大被吸到这个点电荷的概率就越大，且成正比。\n\n我们假设最小的点电荷给试探电荷的吸引力为 $F$，那么对于其他点电荷给试探电荷和吸引力就是 $iF$，那么假设触碰最小的点电荷的概率为 $P$，则每个点的概率就是 $iP$，触碰到点电荷后发出的能量为 $\\mathrm{Fib}(E_i)$。\n\n求期望放出的能量。\n\n好消息是，只要这道题拿到分，萨塔尼亚就能及格啦！\n", "inputFormat": "第一行一个整数 $T$，表示共有 $T$ 组测试数据。\n\n接下来 $T$ 行每行一个整数 $n$，表示有 $n$ 个点电荷。\n", "outputFormat": "对于每次询问输出一行一个整数表示期望能量。为了避免精度问题，请输出答案对 $998{,}244{,}353$ 取模后的结果。", "hint": "### 样例解释\n\n$\\dfrac{1}{3}\\times \\mathrm{Fib}(1)+\\dfrac{2}{3}\\times \\mathrm{Fib}(2)=1$。\n\n请结合样例仔细再仔细的读题！\n\n### 数据范围\n\n- 对于 $10\\%$ 的数据 $T=1$，$n=2$；\n- 对于 $30\\%$ 的数据 $T≤10$，$1\\le n\\le 10^6$；\n- 对于 $60\\%$ 的数据 $T≤10^6$，$1\\le n\\le 10^6$；\n- 对于 $100\\%$ 的数据 $T≤10^6$，$1\\le n\\le 10^9$，保证 $n \\ne 998244352$ 且 $n \\ne 998244353$。\n\n$\\mathrm{Fib}(i)$ 为斐波那契数列。\n\n$$\\mathrm{Fib}(i)=\\begin{cases}\n1 & i\\le 2 \\cr\n\\mathrm{Fib}(i-1)+\\mathrm{Fib}(i-2) & i > 2\n\\end{cases}$$\n", "locale": "zh-CN", "translations": {"en": {"title": "Satania's Final Exam", "background": "\"Hey, Gabriel, where should we go to have fun during summer vacation?\" Vignette patted Gabriel on the shoulder.\n\n\"Huh? Of course I'll stay home and play games during summer vacation,\" Gabriel replied listlessly.\n\n\"You can't do that. You're an angel at least—act like one.\"\n\n\"What a pain.\"\n\n\"So, how about we go to the beach during summer vacation?\"\n\n\"Agreed, agreed! If we go to the beach, I can tease Gabriel to my heart's content,\" Raphiel slipped in before anyone noticed.\n\n\"Such a pain.\"\n\nWhile everyone was discussing where to go for summer vacation, Satania listened on the side feeling conflicted, because no one had invited her.\n\n\"Heh heh heh, I am the great demon Satania. How could I possibly join them on my own? I must wait for them to invite me,\" Satania schemed to herself.\n\n\"Hey, I think Satania looks a little unhappy.\"\n\n\"It's more than 'looks like'—she's not even trying to hide that expression.\"\n\n\"Hey, should we invite her?\"\n\nRaphiel said this as she walked over to Satania. \"Satania-san, we're going to the beach during summer vacation~\"\n\n\"Heh heh heh, finally here to invite me?\" Satania muttered softly, a little pleased.\n\n\"Satania-san, please stay right here obediently~\"\n\n\"Uh...\" Satania took massive psychological damage. \"Hey, what do you think you're doing?\"\n\n\"Hm? Because, Satania-san, if you want to go out and play during summer vacation, you have to pass the final exams, or else you'll be kept for remedial classes.\"\n\n\"Re... remedial...\" Satania seemed to realize something, her face changed dramatically. \"Remedial... hey, Raphiel... c-can you tutor me?\"\n\n\"Hm? Sure~ But how you do on the finals depends on you.\"\n\n\"Thanks. Then could you check where I got these wrong? I don't understand at all.\"\n\n\"Let me see...\" Raphiel left Gabriel and Vignette and started tutoring Satania alone.\n\nFinally, the finals arrived. Satania had worked hard for so long; it all came down to this exam! After sustained effort, everything on the finals went smoothly—apart from the math exam that hadn’t happened yet, she passed all the other subjects!\n\nAt last came the final test—the physics exam. The good news was that Satania had already answered 59 points worth of questions, all correct. But then she ran into a fiendishly difficult problem, and to her amazement, with a total of 100 points, this problem alone was worth 41. If she left it blank, she would fail. \"If anyone fails any subject in the finals, that person must attend remedial classes and make-up exams during summer vacation!\" The homeroom teacher’s words echoed in her ears. What should she do...", "description": "This problem is as follows:\n\nThere is an electric field formed by $n$ point charges. Assume each point charge produces a uniform electric field rather than a point-charge field, and the $i$-th point charge has field strength $E_i=i$.\n\nNow place a negatively charged test charge in this field. As soon as the test charge touches any point charge, it will \"fuse\" with that point charge and release a huge amount of energy.\n\nBecause the field strengths produced by the point charges differ, the test charge is attracted to each point charge with different force; the stronger the attraction a point charge exerts on the test charge, the greater the probability of being drawn to that point charge, and the probability is proportional to the attraction.\n\nAssume the smallest point charge exerts attraction $F$ on the test charge. Then another point charge exerts $iF$. Suppose the probability of touching the smallest point charge is $P$. Then the probability for each point is $iP$. After touching a point charge, the released energy is $\\mathrm{Fib}(E_i)$.\n\nFind the expected released energy.\n\nThe good news is that as long as she gets points on this problem, Satania will pass!", "inputFormat": "The first line contains an integer $T$, the number of test cases.\n\nEach of the next $T$ lines contains an integer $n$, the number of point charges.", "outputFormat": "For each query, output one integer representing the expected energy. To avoid precision issues, please output the answer modulo $998{,}244{,}353$.", "hint": "- Sample Explanation\n\n$\\dfrac{1}{3}\\times \\mathrm{Fib}(1)+\\dfrac{2}{3}\\times \\mathrm{Fib}(2)=1$.\n\nPlease read the problem carefully along with the sample.\n\n- Constraints\n\n- For $10\\%$ of the testdata, $T=1$, $n=2$.\n- For $30\\%$ of the testdata, $T \\le 10$, $1 \\le n \\le 10^6$.\n- For $60\\%$ of the testdata, $T \\le 10^6$, $1 \\le n \\le 10^6$.\n- For $100\\%$ of the testdata, $T \\le 10^6$, $1 \\le n \\le 10^9$, and it is guaranteed that $n \\ne 998244352$ and $n \\ne 998244353$.\n\n$\\mathrm{Fib}(i)$ is the Fibonacci sequence.\n\n$$\\mathrm{Fib}(i)=\\begin{cases}\n1 & i\\le 2 \\cr\n\\mathrm{Fib}(i-1)+\\mathrm{Fib}(i-2) & i > 2\n\\end{cases}$$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "萨塔尼亚的期末考试", "background": "“呐，珈百璃，我说，暑假我们去哪里玩呢？”薇奈特拍拍珈百璃的肩膀\n\n“哈？暑假当然是在家里打游戏啦”珈百璃无精打采地回答道\n\n“怎么能这样呢？你好歹也是天使啊，给我拿出天使的样子来啊”\n\n“真麻烦”\n\n“所以，暑假我们去海边玩吧？”\n\n“赞成赞成！去海边玩的话，就可以好好调戏珈百璃了”菈菲尔不知道什么时候凑进来\n\n“麻烦死了。”\n\n这边一群人正讨论着暑假去哪玩，然而萨塔尼亚在旁边听得很纠结，因为没有人邀请她。。\n\n“哼哼哼哼，吾乃神魔萨塔尼亚，怎么可能主动去加入呢，我必须等她们邀请我”萨塔尼亚心理打着小算盘\n\n“呐，我说，萨塔尼亚貌似有点小不开心呀”\n\n“已经不是貌似了吧，她这表情完全没有掩盖的意思啊。。”\n\n“呐，我说，要不要邀请她去啊？”\n\n拉菲尓说着，走向了萨塔尼亚。“萨塔尼亚桑，暑假我们要去海边玩哟~”\n\n“哼哼哼，终于来邀请我了吗”萨塔尼亚心里有点小开心，小声嘀咕到\n\n“萨塔尼亚桑就好好待在这里哟~”\n\n“额。。。”萨塔尼亚受到了成吨的暴击，“喂，我说，哪有你这样的啊”\n\n“恩？因为，萨塔尼亚桑，暑假如果要出去玩的话，就要通过期末考试哟，不然会被留下来补课的”\n\n“补。。。补课。。。。”萨塔尼亚貌似意会到了什么，脸色大变，“补课。。。呐，拉菲尓。。你。。你能帮我。。补习吗？”\n\n“恩？可以呀~但是期末考试如何就得看你自己了”\n\n“谢谢，那帮我看看这些哪里错了吧？我完全不懂诶”\n\n“我看看。。。” 拉菲尓丢下珈百璃和薇奈特独自给萨塔尼亚开始了补习。\n\n终于，期末考来了，萨塔尼亚努力的这么久，就看这次考试了！经过长期的努力，期末考一切顺利，除了还没考的数学其他学科都及格啦！\n\n终于到了最后一场考试——物理考试。很不错的是，萨塔尼亚已经答完了59分而且全对，但是她遇到了一道绝世难题，而且她很惊奇的发现，总分100分，这题41分，如果不写出来，就会挂科。“期末考如果有某人有挂科，那么那个人的暑假要参加补课以及补考！”班主任的话萦绕在她的耳旁，这可怎么办啊。。。\n", "description": "这道题是这样的：\n\n有一个由 $n$ 个点电荷形成的电场。假定每个点电荷放出的电场都是匀强电场而不是点电荷电场，第 $i$ 个点电荷的电场强度 $E_i=i$。\n\n现放一个带负电的试探电荷到这个电场中，这个试探电荷只要触碰到任何一个点电荷就会和这个点电荷发生聚变放出巨大能量。\n\n因为点电荷放出的电场强度不同，所以试探电荷被吸引到每个点电荷的概率也不同，点电荷给试探电荷的吸引力越大被吸到这个点电荷的概率就越大，且成正比。\n\n我们假设最小的点电荷给试探电荷的吸引力为 $F$，那么对于其他点电荷给试探电荷和吸引力就是 $iF$，那么假设触碰最小的点电荷的概率为 $P$，则每个点的概率就是 $iP$，触碰到点电荷后发出的能量为 $\\mathrm{Fib}(E_i)$。\n\n求期望放出的能量。\n\n好消息是，只要这道题拿到分，萨塔尼亚就能及格啦！\n", "inputFormat": "第一行一个整数 $T$，表示共有 $T$ 组测试数据。\n\n接下来 $T$ 行每行一个整数 $n$，表示有 $n$ 个点电荷。\n", "outputFormat": "对于每次询问输出一行一个整数表示期望能量。为了避免精度问题，请输出答案对 $998{,}244{,}353$ 取模后的结果。", "hint": "### 样例解释\n\n$\\dfrac{1}{3}\\times \\mathrm{Fib}(1)+\\dfrac{2}{3}\\times \\mathrm{Fib}(2)=1$。\n\n请结合样例仔细再仔细的读题！\n\n### 数据范围\n\n- 对于 $10\\%$ 的数据 $T=1$，$n=2$；\n- 对于 $30\\%$ 的数据 $T≤10$，$1\\le n\\le 10^6$；\n- 对于 $60\\%$ 的数据 $T≤10^6$，$1\\le n\\le 10^6$；\n- 对于 $100\\%$ 的数据 $T≤10^6$，$1\\le n\\le 10^9$，保证 $n \\ne 998244352$ 且 $n \\ne 998244353$。\n\n$\\mathrm{Fib}(i)$ 为斐波那契数列。\n\n$$\\mathrm{Fib}(i)=\\begin{cases}\n1 & i\\le 2 \\cr\n\\mathrm{Fib}(i-1)+\\mathrm{Fib}(i-2) & i > 2\n\\end{cases}$$\n", "locale": "zh-CN"}}}
{"pid": "P4835", "type": "P", "difficulty": 6, "samples": [["6\n0 2 3 4 5 6\n0 1 3 4 5 6\n1 6 5 4 2 1\n2 6 5 3 2 1\n1 1 2 3 4 6\n2 1 2 3 4 5", "4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2014", "二分", "各省省选", "江苏", "2-SAT", "强连通分量"], "title": "[JSOI2014] 学生选课", "background": "", "description": "进入大学以后，学生们将面临选课，有 $n$ 个学生需要选课，学校里有三个老师 JYY，YJY，YYJ。\n\n第一年里，每个学生们都选择了其中一位老师。经过了一年的学习，学生之间相互都有一定的印象，每个同学会根据自己的印象给另外 $n-1$ 个学生从好到坏排序。第二年的选课开始了，每个学生需要选择老师，可能是因为被坑多了，每一位同学都想换一个老师。这时需要你来调度同学们选课，使得上同一堂课的学生之间印象最坏的最好。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行 $n$ 个正整数，其中第 $i+1$ 行提供第 $i$ 个同学的信息。其中第一个整数 $A_i$，值为 $0,1,2$ 中的一个，表示第一年第 $i$ 个同学选的老师。\n接下来 $n-1$ 个数字，是 $1,2,\\cdots,i-1,i+1,\\cdots,n$ 的一个排列，表示第 $i$ 个同学对其他同学印象从好到坏的排序。", "outputFormat": "一行一个整数，为最小的非负整数 $T$，满足：\n\n- 所有同学选择了和第一年不同的老师。\n\n- 所有选择同一个老师的学生间彼此印象都是前 $T$ 好的。", "hint": "### 样例解释 1\n\n六名同学分别选择老师 $1,2,0,0,2,0$。\n\n此时老师 $0$ 的课中同学 $6$ 对同学 $4$ 的印象为第 $4$ 好，所以答案 $T$ 为 $4$，并且找不到更小的 $T$。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，$n\\leq 1000$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JSOI2014] 学生选课", "background": "", "description": "进入大学以后，学生们将面临选课，有 $n$ 个学生需要选课，学校里有三个老师 JYY，YJY，YYJ。\n\n第一年里，每个学生们都选择了其中一位老师。经过了一年的学习，学生之间相互都有一定的印象，每个同学会根据自己的印象给另外 $n-1$ 个学生从好到坏排序。第二年的选课开始了，每个学生需要选择老师，可能是因为被坑多了，每一位同学都想换一个老师。这时需要你来调度同学们选课，使得上同一堂课的学生之间印象最坏的最好。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行 $n$ 个正整数，其中第 $i+1$ 行提供第 $i$ 个同学的信息。其中第一个整数 $A_i$，值为 $0,1,2$ 中的一个，表示第一年第 $i$ 个同学选的老师。\n接下来 $n-1$ 个数字，是 $1,2,\\cdots,i-1,i+1,\\cdots,n$ 的一个排列，表示第 $i$ 个同学对其他同学印象从好到坏的排序。", "outputFormat": "一行一个整数，为最小的非负整数 $T$，满足：\n\n- 所有同学选择了和第一年不同的老师。\n\n- 所有选择同一个老师的学生间彼此印象都是前 $T$ 好的。", "hint": "### 样例解释 1\n\n六名同学分别选择老师 $1,2,0,0,2,0$。\n\n此时老师 $0$ 的课中同学 $6$ 对同学 $4$ 的印象为第 $4$ 好，所以答案 $T$ 为 $4$，并且找不到更小的 $T$。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，$n\\leq 1000$。", "locale": "zh-CN"}}}
{"pid": "P4838", "type": "P", "difficulty": 4, "samples": [["3\n1\n3\n6\n", "2\n7\n44\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["递推", "O2优化", "矩阵乘法"], "title": "P哥破解密码", "background": "P 哥是一个经常丢密码条的男孩子。\n\n在 ION8102 赛场上，P 哥又弄丢了密码条，笔试满分的他当然知道这可是要扣 $5$ 分作为惩罚的，于是他开始破解 IONXunil 系统的密码。", "description": "定义一个串合法，当且仅当串只由 $\\verb!A!$ 和 $\\verb!B!$ 构成，且没有连续的 $3$ 个 $\\verb!A!$。P 哥知道，密码就是长度为 $N$ 的合法字符串数量对 $19260817$ 取模的结果。但是 P 哥不会算，所以他只能把 $N$ 告诉你，让你来算。\n\n至于为什么要对这个数取模，好像是因为纪念某个人，但到底是谁，P 哥也不记得了。\n\n然而他忘记字符串长度 $N$ 应该是多少了，于是他准备试 $M$ 组数据。", "inputFormat": "第一行给出一个整数 $M$ 表示询问次数。\n\n接下来 $M$ 行每行给出一个正整数 $N$，表示该组询问中字符串的长度。", "outputFormat": "对于每一次询问输出一行一个整数表示答案。", "hint": "### 样例部分解释 :。\n\n长度为 $1$ 时只有 $\\verb!A!$ 和 $\\verb!B!$ 两种排列，都是合法的。\n\n长度为 $3$ 时除了 $\\verb!AAA!$ 是不合法的其他都是可以的，故有 $2^3-1$ 种。\n\n### 数据范围。\n\n- 对于 $20\\%$ 数据，全部 $N\\leq20$，$M\\leq2$；\n- 对于 $70\\%$ 数据，全部 $N\\leq10^7$；\n- 对于 $100\\%$ 数据，全部 $N\\leq10^9$，$M\\leq10$。", "locale": "zh-CN", "translations": {"en": {"title": "Brother P Cracks the Password", "background": "Brother P is a boy who often loses his password slips.\n\nAt the ION8102 contest site, Brother P lost his password slip again. As someone who can get full marks on the written test, he of course knows that this will cost him $5$ points as a penalty, so he started cracking the password of the IONXunil system.", "description": "Define a string as valid if and only if it is made up only of $\\verb!A!$ and $\\verb!B!$, and it does not contain $3$ consecutive $\\verb!A!$ characters. Brother P knows that the password is the number of valid strings of length $N$, taken modulo $19260817$. But Brother P cannot compute it, so he can only tell you $N$ and ask you to compute it.\n\nAs for why the result is taken modulo this number, it seems to be in memory of someone, but who exactly that is, Brother P does not remember either.\n\nHowever, he forgot what the string length $N$ should be, so he plans to try $M$ sets of testdata.", "inputFormat": "The first line gives an integer $M$, which represents the number of queries.\n\nThen follow $M$ lines, each giving a positive integer $N$, meaning the length of the string in that query.", "outputFormat": "For each query, output one integer per line, representing the answer.", "hint": "### Explanation of the samples.\n\nWhen the length is $1$, there are only two arrangements: $\\verb!A!$ and $\\verb!B!$, and both are valid.\n\nWhen the length is $3$, all strings are valid except $\\verb!AAA!$, so there are $2^3-1$ strings.\n\n### Constraints.\n\n- For $20\\%$ of the testdata, all $N\\leq20$, $M\\leq2$.\n- For $70\\%$ of the testdata, all $N\\leq10^7$.\n- For $100\\%$ of the testdata, all $N\\leq10^9$, $M\\leq10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "P哥破解密码", "background": "P 哥是一个经常丢密码条的男孩子。\n\n在 ION8102 赛场上，P 哥又弄丢了密码条，笔试满分的他当然知道这可是要扣 $5$ 分作为惩罚的，于是他开始破解 IONXunil 系统的密码。", "description": "定义一个串合法，当且仅当串只由 $\\verb!A!$ 和 $\\verb!B!$ 构成，且没有连续的 $3$ 个 $\\verb!A!$。P 哥知道，密码就是长度为 $N$ 的合法字符串数量对 $19260817$ 取模的结果。但是 P 哥不会算，所以他只能把 $N$ 告诉你，让你来算。\n\n至于为什么要对这个数取模，好像是因为纪念某个人，但到底是谁，P 哥也不记得了。\n\n然而他忘记字符串长度 $N$ 应该是多少了，于是他准备试 $M$ 组数据。", "inputFormat": "第一行给出一个整数 $M$ 表示询问次数。\n\n接下来 $M$ 行每行给出一个正整数 $N$，表示该组询问中字符串的长度。", "outputFormat": "对于每一次询问输出一行一个整数表示答案。", "hint": "### 样例部分解释 :。\n\n长度为 $1$ 时只有 $\\verb!A!$ 和 $\\verb!B!$ 两种排列，都是合法的。\n\n长度为 $3$ 时除了 $\\verb!AAA!$ 是不合法的其他都是可以的，故有 $2^3-1$ 种。\n\n### 数据范围。\n\n- 对于 $20\\%$ 数据，全部 $N\\leq20$，$M\\leq2$；\n- 对于 $70\\%$ 数据，全部 $N\\leq10^7$；\n- 对于 $100\\%$ 数据，全部 $N\\leq10^9$，$M\\leq10$。", "locale": "zh-CN"}}}
{"pid": "P4839", "type": "P", "difficulty": 6, "samples": [["5 3\n1 1 2\n1 2 3\n1 3 4\n2 1 2\n2 1 3", "3\n7"], ["11 10\n2 6 9\n1 9 1523456696\n1 1 1818963290\n2 6 7\n1 1 102229226\n2 1 9\n2 3 7\n1 5 34895532\n1 1 1652480680\n1 1 1477666032\n2 1 10", "0\n0\n1818963290\n0\n1857442578\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["线段树", "线性基"], "title": "P 哥的桶", "background": "", "description": "P 哥现在有 $n$ 个桶，它们排成了一排，这些桶可以装下任意多个球。每个球有一个固定的价值。\n\nP 哥时不时地会找新球，并把新找的球丢进某个桶里面。我们用 $1\\;k\\;x$ 来表示 P 哥找了一个价值为 $x$ 的球，并且丢进了 $k$ 号桶里面。\n\nP 哥每次会在特定的桶里面拿出一些球。我们用 $2\\;l\\;r$ 来表示 P 哥在 $l$ 号桶到 $r$ 号桶之间拿球。P 哥希望拿出来的球的价值异或和尽可能大。\n\n**注意：P 哥拿出这些球后会把它们物归原位。**", "inputFormat": "第一行两个整数 $n, m$，依次表示 P 哥的操作次数、这组数据会涉及到的最大编号。\n\n接下来 $n$ 行，每行三个整数，表示操作。操作格式如题。", "outputFormat": "对于每个 2 操作，输出 P 哥拿出的球的最大价值异或和。", "hint": "对于 $20 \\%$ 的数据，满足 $n,m\\leq 100$。\n\n对于 $40 \\%$ 的数据，满足 $n,m\\leq 1000$。\n\n另有 $20 \\%$ 的数据，所有询问满足 $l=1$，$r=m$。\n\n对于 $100 \\%$ 的数据，满足 $1 \\le n, m \\leq 5 \\times 10^4$，$1 \\le l\\leq r\\leq m$，$1 \\le k \\leq m$，$0 \\le x \\leq 2^{31}-1$。", "locale": "zh-CN", "translations": {"en": {"title": "P Bro’s Buckets", "background": "", "description": "P Bro now has $n$ buckets arranged in a row. These buckets can hold any number of balls. Each ball has a fixed value.\n\nFrom time to time, P Bro finds a new ball and throws it into a bucket. We use $1\\;k\\;x$ to mean that P Bro found a ball with value $x$ and threw it into bucket $k$.\n\nEach time, P Bro will take out some balls from a specific range of buckets. We use $2\\;l\\;r$ to mean that P Bro takes balls from buckets $l$ to $r$. P Bro wants the XOR sum of the values of the balls he takes out to be as large as possible.\n\n**Note: After taking out these balls, P Bro will put them back to their original places.**", "inputFormat": "The first line contains two integers $n, m$, which represent the number of operations P Bro performs, and the maximum index involved in this testdata, respectively.\n\nThe next $n$ lines each contain three integers describing an operation. The operation format is as described in the statement.", "outputFormat": "For each operation of type 2, output the maximum possible XOR sum of the values of the balls P Bro takes out.", "hint": "For $20\\%$ of the data, $n, m \\leq 100$.\n\nFor $40\\%$ of the data, $n, m \\leq 1000$.\n\nFor another $20\\%$ of the data, all queries satisfy $l = 1$ and $r = m$.\n\nFor $100\\%$ of the data, $1 \\le n, m \\leq 5 \\times 10^4$, $1 \\le l \\leq r \\leq m$, $1 \\le k \\leq m$, and $0 \\le x \\leq 2^{31}-1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "P 哥的桶", "background": "", "description": "P 哥现在有 $n$ 个桶，它们排成了一排，这些桶可以装下任意多个球。每个球有一个固定的价值。\n\nP 哥时不时地会找新球，并把新找的球丢进某个桶里面。我们用 $1\\;k\\;x$ 来表示 P 哥找了一个价值为 $x$ 的球，并且丢进了 $k$ 号桶里面。\n\nP 哥每次会在特定的桶里面拿出一些球。我们用 $2\\;l\\;r$ 来表示 P 哥在 $l$ 号桶到 $r$ 号桶之间拿球。P 哥希望拿出来的球的价值异或和尽可能大。\n\n**注意：P 哥拿出这些球后会把它们物归原位。**", "inputFormat": "第一行两个整数 $n, m$，依次表示 P 哥的操作次数、这组数据会涉及到的最大编号。\n\n接下来 $n$ 行，每行三个整数，表示操作。操作格式如题。", "outputFormat": "对于每个 2 操作，输出 P 哥拿出的球的最大价值异或和。", "hint": "对于 $20 \\%$ 的数据，满足 $n,m\\leq 100$。\n\n对于 $40 \\%$ 的数据，满足 $n,m\\leq 1000$。\n\n另有 $20 \\%$ 的数据，所有询问满足 $l=1$，$r=m$。\n\n对于 $100 \\%$ 的数据，满足 $1 \\le n, m \\leq 5 \\times 10^4$，$1 \\le l\\leq r\\leq m$，$1 \\le k \\leq m$，$0 \\le x \\leq 2^{31}-1$。", "locale": "zh-CN"}}}
{"pid": "P4840", "type": "P", "difficulty": 6, "samples": [["ioimoio\n", "7\n"], ["fcfcfcfcfczxqprvvlpstpasxvpyyhaejxehdlhckmwmibsjwqbmfzlwpjqjghmlxunefabkpryqxbkqridpqrzemvfcfcfcfcfc", "47"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": [], "title": "P哥旋转", "background": "P 哥开始学字符串了！", "description": "P 哥学会了字符串处理的新方法——旋转。\n\n“旋转”是这样一种操作：将原字符串最后面的字符抹去，然后把它加到最前面，得到一个新串。\n\nP 哥可以进行无数次“旋转”操作，**让得到的新串中本质不同的回文子串尽可能多**。\n\n两个回文串本质不同，当且仅当它们长度不同，或至少有一个相同位置的字符不同。\n\n现在 P 哥得到了一个串 $S$，请你通过“旋转”操作帮 P 哥达成他的目标（即上面的加粗字体部分），并输出新串中不同的回文子串的个数。", "inputFormat": "输入共一行，代表串 $S$，保证只有小写英文字母。", "outputFormat": "输出一个整数表示答案。", "hint": "设 $n$ 为串 $S$ 的长度。\n\n- 对于前 $20\\%$ 的数据，$n \\le 100$。\n- 对于前 $40\\%$ 的数据，$n \\le 2000$。\n- 对于另 $10\\%$ 的数据，保证得出正确答案不用进行旋转。\n- 对于 $100\\%$ 的数据，$n \\le 1.5\\times 10^6$。\n\n此外，对于后 $50\\%$ 的数据，保证串 $S$ 的非随机部分长度不超过 $5000$。\n\n**注意**：本题采用 subtask 方式计分。前 $50\\%$ 的数据是 subtask#1，该 subtask 采用加和的方式计分（你可以认为是传统计分方式）。后 $50\\%$ 的数据是 subtask#2，该 subtask 采用取 $\\min$ 的方式计分（即只要错一个点，后 $50$ 分全部没有）。", "locale": "zh-CN", "translations": {"en": {"title": "P-bro Rotation", "background": "P-bro has started learning strings.", "description": "P-bro has learned a new method for string processing: rotation.\n\nA “rotation” is an operation like this: remove the last character of the original string, then add it to the very front, obtaining a new string.\n\nP-bro can perform the “rotation” operation infinitely many times, in order to make the number of essentially different palindromic substrings in the resulting new string as large as possible.\n\nTwo palindromic strings are essentially different if and only if their lengths are different, or there exists at least one position where the characters are different.\n\nNow P-bro has obtained a string $S$. Please help P-bro achieve his goal through “rotation” operations (i.e., the bolded part above), and output the number of different palindromic substrings in the new string.", "inputFormat": "The input consists of one line, which is the string $S$, guaranteed to contain only lowercase English letters.", "outputFormat": "Output one integer, representing the answer.", "hint": "Let $n$ be the length of string $S$.\n\n- For the first $20\\%$ of the testdata, $n \\le 100$.\n- For the first $40\\%$ of the testdata, $n \\le 2000$.\n- For another $10\\%$ of the testdata, it is guaranteed that you can obtain the correct answer without performing any rotation.\n- For $100\\%$ of the testdata, $n \\le 1.5\\times 10^6$.\n\nIn addition, for the last $50\\%$ of the testdata, it is guaranteed that the length of the non-random part of string $S$ does not exceed $5000$.\n\n**Note**: This problem uses subtask scoring. The first $50\\%$ of the testdata is subtask#1, and this subtask uses additive scoring (you may consider it as traditional scoring). The last $50\\%$ of the testdata is subtask#2, and this subtask uses $\\min$ scoring (that is, if you get even one test wrong, you get $0$ points for the last $50$ points).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "P哥旋转", "background": "P 哥开始学字符串了！", "description": "P 哥学会了字符串处理的新方法——旋转。\n\n“旋转”是这样一种操作：将原字符串最后面的字符抹去，然后把它加到最前面，得到一个新串。\n\nP 哥可以进行无数次“旋转”操作，**让得到的新串中本质不同的回文子串尽可能多**。\n\n两个回文串本质不同，当且仅当它们长度不同，或至少有一个相同位置的字符不同。\n\n现在 P 哥得到了一个串 $S$，请你通过“旋转”操作帮 P 哥达成他的目标（即上面的加粗字体部分），并输出新串中不同的回文子串的个数。", "inputFormat": "输入共一行，代表串 $S$，保证只有小写英文字母。", "outputFormat": "输出一个整数表示答案。", "hint": "设 $n$ 为串 $S$ 的长度。\n\n- 对于前 $20\\%$ 的数据，$n \\le 100$。\n- 对于前 $40\\%$ 的数据，$n \\le 2000$。\n- 对于另 $10\\%$ 的数据，保证得出正确答案不用进行旋转。\n- 对于 $100\\%$ 的数据，$n \\le 1.5\\times 10^6$。\n\n此外，对于后 $50\\%$ 的数据，保证串 $S$ 的非随机部分长度不超过 $5000$。\n\n**注意**：本题采用 subtask 方式计分。前 $50\\%$ 的数据是 subtask#1，该 subtask 采用加和的方式计分（你可以认为是传统计分方式）。后 $50\\%$ 的数据是 subtask#2，该 subtask 采用取 $\\min$ 的方式计分（即只要错一个点，后 $50$ 分全部没有）。", "locale": "zh-CN"}}}
{"pid": "P4841", "type": "P", "difficulty": 6, "samples": [["3", "4"], ["4", "38"], ["100000", "829847355\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2013", "集训队互测", "生成函数", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "[集训队作业2013] 城市规划", "background": "", "description": "刚刚解决完电力网络的问题，阿狸又被领导的任务给难住了。\n\n刚才说过，阿狸的国家有 $n$ 个城市，现在国家需要在某些城市对之间建立一些贸易路线，使得整个国家的任意两个城市都直接或间接的连通。\n\n为了省钱, 每两个城市之间最多只能有一条直接的贸易路径。对于两个建立路线的方案，如果存在一个城市对，在两个方案中是否建立路线不一样，那么这两个方案就是不同的，否则就是相同的。现在你需要求出一共有多少不同的方案。\n\n好了，这就是困扰阿狸的问题。换句话说，你需要求出 $n$ 个点的简单 (无重边无自环) 有标号无向连通图数目。\n\n由于这个数字可能非常大, 你只需要输出方案数对 $1004535809$ ( $479 \\times 2 ^{21} + 1$ ) 取模即可。", "inputFormat": "仅一行一个整数 $n$", "outputFormat": "仅一行一个整数，为方案数 $\\bmod \\space 1004535809$。", "hint": "【数据范围】   \n对于 $20\\%$ 的数据，$n \\le 10$    \n对于 $40\\%$ 的数据，$n \\le 1000$     \n对于 $60\\%$ 的数据，$n \\le 30000$    \n对于 $80\\%$ 的数据，$n \\le 60000$     \n对于 $100\\%$ 的数据，$n \\le 130000$   \n\n试题来源：$2013$ 中国国家集训队第二次作业", "locale": "zh-CN", "translations": {"en": {"title": "[CTT Homework 2013] City Planning", "background": "", "description": "After just solving the problem of the power network, Ali is stuck again by a task from his leader.\n\nAs mentioned before, Ali’s country has $n$ cities. Now the country needs to build some trade routes between certain pairs of cities, so that any two cities in the whole country are connected directly or indirectly.\n\nTo save money, there can be at most one direct trade route between every pair of cities. For two route-building plans, if there exists a pair of cities such that whether a route is built between them is different in the two plans, then the two plans are different; otherwise, they are the same. Now you need to find how many different plans there are in total.\n\nThat is the problem troubling Ali. In other words, you need to count the number of simple (no multiple edges and no self-loops) labeled undirected connected graphs on $n$ vertices.\n\nSince this number may be very large, you only need to output the number of plans modulo $1004535809$ ( $479 \\times 2 ^{21} + 1$ ).", "inputFormat": "Only one line containing one integer $n$.", "outputFormat": "Only one line containing one integer, the number of plans $\\bmod \\space 1004535809$.", "hint": "Constraints  \nFor $20\\%$ of the testdata, $n \\le 10$.  \nFor $40\\%$ of the testdata, $n \\le 1000$.  \nFor $60\\%$ of the testdata, $n \\le 30000$.  \nFor $80\\%$ of the testdata, $n \\le 60000$.  \nFor $100\\%$ of the testdata, $n \\le 130000$.\n\nSource: the second homework of China CTT in $2013$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[集训队作业2013] 城市规划", "background": "", "description": "刚刚解决完电力网络的问题，阿狸又被领导的任务给难住了。\n\n刚才说过，阿狸的国家有 $n$ 个城市，现在国家需要在某些城市对之间建立一些贸易路线，使得整个国家的任意两个城市都直接或间接的连通。\n\n为了省钱, 每两个城市之间最多只能有一条直接的贸易路径。对于两个建立路线的方案，如果存在一个城市对，在两个方案中是否建立路线不一样，那么这两个方案就是不同的，否则就是相同的。现在你需要求出一共有多少不同的方案。\n\n好了，这就是困扰阿狸的问题。换句话说，你需要求出 $n$ 个点的简单 (无重边无自环) 有标号无向连通图数目。\n\n由于这个数字可能非常大, 你只需要输出方案数对 $1004535809$ ( $479 \\times 2 ^{21} + 1$ ) 取模即可。", "inputFormat": "仅一行一个整数 $n$", "outputFormat": "仅一行一个整数，为方案数 $\\bmod \\space 1004535809$。", "hint": "【数据范围】   \n对于 $20\\%$ 的数据，$n \\le 10$    \n对于 $40\\%$ 的数据，$n \\le 1000$     \n对于 $60\\%$ 的数据，$n \\le 30000$    \n对于 $80\\%$ 的数据，$n \\le 60000$     \n对于 $100\\%$ 的数据，$n \\le 130000$   \n\n试题来源：$2013$ 中国国家集训队第二次作业", "locale": "zh-CN"}}}
{"pid": "P4842", "type": "P", "difficulty": 6, "samples": [["4 5\n1 3 2 5\n1 2\n1 3\n2 4\n4 2 4\n1 2 4\n2 3 4\n3 1 4 1\n4 1 4", "16/3\n6/1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "城市旅行", "background": "", "description": "\nW 国地大物博，由 $n$ 座城市组成，共 $n-1$ 条双向道路连接其中的两座城市，且任意两座城市都可相互到达。\n\n风景秀美的 W 国吸引了无数慕名而来的游客，根据游客对每座城市的打分，我们定义第 $i$ 座城市的美丽度为 $a_i$。一次从城市 $x$ 到城市 $y$ 的旅行，所获得的的愉悦指数为从城市 $x$ 到城市 $y$ 所有城市的美丽度之和（包括 $x$ 和 $y$）。我们定义这个值为 $H(x,y)$。\n\n现在小 A 在城市 $X$，Sharon 在城市 $Y$，他们想知道如果在城市 $X$ 到城市 $Y$ 之间的所有城市中任选两座城市 $x$ 和 $y$（$x$ 可以等于 $y$），那么 $H(x,y)$ 的期望值是多少，我们记这个期望值为 $E(x,y)$。\n\n当然，城市之间的交通状况飘忽不定，因此我们不能排除某些时刻某些道路将无法通行。某些时刻会突然添加新的道路。以及游客们审美观的改变，某些城市的美丽度也会发生变化。作为 W 国负责旅游行业的 T 君，他要求你来写一个程序来模拟上面的所有过程。", "inputFormat": "第一行两个整数，$n,m$ 表示城市个数和操作个数。\n\n接下来一行 $n$ 个整数，第 $i$ 个表示 $a_i$。  \n接下来 $n-1$ 行，每行两个整数 $u,v$，表示 $u$ 和 $v$ 之间有一条路。  \n接下来 $m$ 行，是进行下面的操作：\n\n- `1 u v` 如果城市 $u$ 和城市 $v$ 已经无直接连接的道路，则忽略这个操作，否则删除 $u,v$ 之间的道路。\n- `2 u v` 如果城市 $u$ 和城市 $v$ 联通那么忽略。否则在 $u,v$ 之间添加一条道路。\n- `3 u v d` 如果城市 $u$ 和城市 $v$ 不连通，那么忽略。否则将城市 $u$ 到城市 $v$ 的路径中所有城市（包括 $u$ 和 $v$）的美丽度都增加 $d$。\n- `4 u v` 询问 $E(u,v)$ 的值。", "outputFormat": "对于操作 4，输出答案，一个经过化简的分数 $\\frac{p}{q}$。如果 $u$ 和 $v$ 不连通输出 `-1`。", "hint": "对于所有数据满足 $1\\le N\\le 50000,1\\le M\\le 50000,1\\le a_i\\le 10^6,1\\le D\\le 100,1\\le u,v\\le N$。", "locale": "zh-CN", "translations": {"en": {"title": "City Travel.", "background": "", "description": "Country W is vast and rich. It consists of $n$ cities, connected by $n-1$ bidirectional roads, each road connecting two cities. Any two cities can reach each other.\n\nThe beautiful scenery of Country W attracts many tourists. Based on the tourists' ratings for each city, we define the beauty of city $i$ as $a_i$. For a trip from city $x$ to city $y$, the happiness index gained is the sum of the beauties of all cities on the path from city $x$ to city $y$ (including $x$ and $y$). We define this value as $H(x,y)$.\n\nNow, Xiao A is in city $X$ and Sharon is in city $Y$. They want to know: if we choose any two cities $x$ and $y$ (where $x$ may equal $y$) among all cities on the path from city $X$ to city $Y$, what is the expected value of $H(x,y)$? We denote this expected value as $E(x,y)$.\n\nOf course, the traffic conditions between cities are unpredictable, so we cannot rule out that at some moments some roads become impassable. At some moments, new roads may be added. Also, as tourists' tastes change, the beauty of some cities may change as well. As Mr. T, who is responsible for the tourism industry in Country W, requires you to write a program to simulate all the processes above.", "inputFormat": "The first line contains two integers $n,m$, representing the number of cities and the number of operations.\n\nThe next line contains $n$ integers, where the $i$-th integer represents $a_i$.  \nThe next $n-1$ lines each contain two integers $u,v$, indicating there is a road between $u$ and $v$.  \nThe next $m$ lines describe the following operations:\n\n- `1 u v` If there is no road directly connecting cities $u$ and $v$, ignore this operation; otherwise, delete the road between $u$ and $v$.\n- `2 u v` If cities $u$ and $v$ are connected, ignore this operation; otherwise, add a road between $u$ and $v$.\n- `3 u v d` If cities $u$ and $v$ are not connected, ignore this operation; otherwise, increase the beauty of all cities on the path from city $u$ to city $v$ (including $u$ and $v$) by $d$.\n- `4 u v` Query the value of $E(u,v)$.", "outputFormat": "For operation 4, output the answer as a reduced fraction $\\frac{p}{q}$. If $u$ and $v$ are not connected, output `-1`.", "hint": "For all testdata, $1\\le N\\le 50000,1\\le M\\le 50000,1\\le a_i\\le 10^6,1\\le D\\le 100,1\\le u,v\\le N$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "城市旅行", "background": "", "description": "\nW 国地大物博，由 $n$ 座城市组成，共 $n-1$ 条双向道路连接其中的两座城市，且任意两座城市都可相互到达。\n\n风景秀美的 W 国吸引了无数慕名而来的游客，根据游客对每座城市的打分，我们定义第 $i$ 座城市的美丽度为 $a_i$。一次从城市 $x$ 到城市 $y$ 的旅行，所获得的的愉悦指数为从城市 $x$ 到城市 $y$ 所有城市的美丽度之和（包括 $x$ 和 $y$）。我们定义这个值为 $H(x,y)$。\n\n现在小 A 在城市 $X$，Sharon 在城市 $Y$，他们想知道如果在城市 $X$ 到城市 $Y$ 之间的所有城市中任选两座城市 $x$ 和 $y$（$x$ 可以等于 $y$），那么 $H(x,y)$ 的期望值是多少，我们记这个期望值为 $E(x,y)$。\n\n当然，城市之间的交通状况飘忽不定，因此我们不能排除某些时刻某些道路将无法通行。某些时刻会突然添加新的道路。以及游客们审美观的改变，某些城市的美丽度也会发生变化。作为 W 国负责旅游行业的 T 君，他要求你来写一个程序来模拟上面的所有过程。", "inputFormat": "第一行两个整数，$n,m$ 表示城市个数和操作个数。\n\n接下来一行 $n$ 个整数，第 $i$ 个表示 $a_i$。  \n接下来 $n-1$ 行，每行两个整数 $u,v$，表示 $u$ 和 $v$ 之间有一条路。  \n接下来 $m$ 行，是进行下面的操作：\n\n- `1 u v` 如果城市 $u$ 和城市 $v$ 已经无直接连接的道路，则忽略这个操作，否则删除 $u,v$ 之间的道路。\n- `2 u v` 如果城市 $u$ 和城市 $v$ 联通那么忽略。否则在 $u,v$ 之间添加一条道路。\n- `3 u v d` 如果城市 $u$ 和城市 $v$ 不连通，那么忽略。否则将城市 $u$ 到城市 $v$ 的路径中所有城市（包括 $u$ 和 $v$）的美丽度都增加 $d$。\n- `4 u v` 询问 $E(u,v)$ 的值。", "outputFormat": "对于操作 4，输出答案，一个经过化简的分数 $\\frac{p}{q}$。如果 $u$ 和 $v$ 不连通输出 `-1`。", "hint": "对于所有数据满足 $1\\le N\\le 50000,1\\le M\\le 50000,1\\le a_i\\le 10^6,1\\le D\\le 100,1\\le u,v\\le N$。", "locale": "zh-CN"}}}
