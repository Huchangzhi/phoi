{"pid": "P2375", "type": "P", "difficulty": 5, "samples": [["3\naaaaa\nab\nabcababc", "36\n1\n32 "]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["字符串", "递推", "2014", "NOI", "KMP 算法"], "title": "[NOI2014] 动物园", "background": null, "description": "近日，园长发现动物园中好吃懒做的动物越来越多了。例如企鹅，只会卖萌向游客要吃的。为了整治动物园的不良风气，让动物们凭自己的真才实学向游客要吃的，园长决定开设算法班，让动物们学习算法。\n\n某天，园长给动物们讲解 KMP 算法。\n\n园长：“对于一个字符串 $S$，它的长度为 $L$。我们可以在 $O(L)$ 的时间内，求出一个名为 $\\mathrm{next}$ 的数组。有谁预习了 $\\mathrm{next}$ 数组的含义吗？”\n\n熊猫：“对于字符串 $S$ 的前 $i$ 个字符构成的子串，既是它的后缀又是它的前缀的字符串中（它本身除外），最长的长度记作 $\\mathrm{next}[i]$。”\n\n园长：“非常好！那你能举个例子吗？”\n\n熊猫：“例 $S$ 为 $\\verb!abcababc!$，则 $\\mathrm{next}[5]=2$。因为 $S$ 的前 $5$ 个字符为 $\\verb!abcab!$，$\\verb!ab!$ 既是它的后缀又是它的前缀，并且找不到一个更长的字符串满足这个性质。同理，还可得出 $\\mathrm{next}[1] = \\mathrm{next}[2] = \\mathrm{next}[3] = 0$，$\\mathrm{next}[4] = \\mathrm{next}[6] = 1$，$\\mathrm{next}[7] = 2$，$\\mathrm{next}[8] = 3$。”\n\n园长表扬了认真预习的熊猫同学。随后，他详细讲解了如何在 $O(L)$ 的时间内求出 $\\mathrm{next}$ 数组。\n\n下课前，园长提出了一个问题：“KMP 算法只能求出 $\\mathrm{next}$ 数组。我现在希望求出一个更强大 $\\mathrm{num}$ 数组一一对于字符串 $S$ 的前 $i$ 个字符构成的子串，既是它的后缀同时又是它的前缀，并且该后缀与该前缀不重叠，将这种字符串的数量记作 $\\mathrm{num}[i]$。例如 $S$ 为 $\\verb!aaaaa!$，则 $\\mathrm{num}[4] = 2$。这是因为 $S$ 的前 $4$ 个字符为 $\\verb!aaaa!$，其中 $\\verb!a!$ 和 $\\verb!aa!$ 都满足性质‘既是后缀又是前缀’，同时保证这个后缀与这个前缀不重叠。而 $\\verb!aaa!$ 虽然满足性质‘既是后缀又是前缀’，但遗憾的是这个后缀与这个前缀重叠了，所以不能计算在内。同理，$\\mathrm{num}[1] = 0,\\mathrm{num}[2] = \\mathrm{num}[3] = 1,\\mathrm{num}[5] = 2$。”\n\n最后，园长给出了奖励条件，第一个做对的同学奖励巧克力一盒。听了这句话，睡了一节课的企鹅立刻就醒过来了！但企鹅并不会做这道题，于是向参观动物园的你寻求帮助。你能否帮助企鹅写一个程序求出 $\\mathrm{num}$ 数组呢？\n\n特别地，为了避免大量的输出，你不需要输出 $\\mathrm{num}[i]$ 分别是多少，你只需要输出所有 $(\\mathrm{num}[i]+1)$ 的乘积，对 $10^9 + 7$ 取模的结果即可。", "inputFormat": "第 $1$ 行仅包含一个正整数 $n$，表示测试数据的组数。  \n随后 $n$ 行，每行描述一组测试数据。每组测试数据仅含有一个字符串 $S$，$S$ 的定义详见题目描述。数据保证 $S$ 中仅含小写字母。输入文件中不会包含多余的空行，行末不会存在多余的空格。", "outputFormat": "包含 $n$ 行，每行描述一组测试数据的答案，答案的顺序应与输入数据的顺序保持一致。对于每组测试数据，仅需要输出一个整数，表示这组测试数据的答案对 $10^9+7$ 取模的结果。输出文件中不应包含多余的空行。", "hint": "测试点编号| 约定\n-|-  \n1| $n \\le 5, L \\le 50$  \n2| $n \\le 5, L \\le 200$  \n3| $n \\le 5, L \\le 200$  \n4| $n \\le 5, L \\le 10,000$  \n5| $n \\le 5, L \\le 10,000$  \n6| $n \\le 5, L \\le 100,000$  \n7| $n \\le 5, L \\le 200,000$   \n8| $n \\le 5, L \\le 500,000$  \n9| $n \\le 5, L \\le 1,000,000$  \n10| $n \\le 5, L \\le 1,000,000$", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2014] Zoo", "background": "", "description": "Recently, the director found that more and more animals in the zoo were lazy and only cared about eating. For example, penguins only act cute to ask visitors for food. To rectify this bad trend and make the animals ask for food with their real skills, the director decided to open an algorithms class so that the animals could learn algorithms.\n\nOne day, the director explained the KMP algorithm.\n\nDirector: \"For a string $S$ of length $L$, we can compute in $O(L)$ time an array called $\\mathrm{next}$. Has anyone previewed the meaning of the $\\mathrm{next}$ array?\"\n\nPanda: \"For the substring formed by the first $i$ characters of string $S$, among the strings that are both its suffix and its prefix (excluding the substring itself), the maximum length is denoted as $\\mathrm{next}[i]$.\"\n\nDirector: \"Very good! Can you give an example?\"\n\nPanda: \"For example, if $S$ is $\\verb!abcababc!$, then $\\mathrm{next}[5] = 2$. This is because the first $5$ characters of $S$ are $\\verb!abcab!$, and $\\verb!ab!$ is both its suffix and its prefix, and there is no longer string that satisfies this property. Similarly, we can also get $\\mathrm{next}[1] = \\mathrm{next}[2] = \\mathrm{next}[3] = 0$, $\\mathrm{next}[4] = \\mathrm{next}[6] = 1$, $\\mathrm{next}[7] = 2$, $\\mathrm{next}[8] = 3$.\"\n\nThe director praised Panda for previewing diligently. Then he explained in detail how to compute the $\\mathrm{next}$ array in $O(L)$ time.\n\nBefore class ended, the director posed a question: \"The KMP algorithm can only compute the $\\mathrm{next}$ array. I now want to compute a more powerful array $\\mathrm{num}$ — for the substring formed by the first $i$ characters of string $S$, count the number of strings that are both its suffix and its prefix, and moreover the suffix and the prefix do not overlap. Denote this count as $\\mathrm{num}[i]$. For example, if $S$ is $\\verb!aaaaa!$, then $\\mathrm{num}[4] = 2$. This is because the first $4$ characters of $S$ are $\\verb!aaaa!$, among which $\\verb!a!$ and $\\verb!aa!$ both satisfy the property 'being both a suffix and a prefix', while ensuring that the suffix and the prefix do not overlap. Although $\\verb!aaa!$ also satisfies 'being both a suffix and a prefix', unfortunately its suffix and prefix overlap, so it cannot be counted. Similarly, $\\mathrm{num}[1] = 0, \\mathrm{num}[2] = \\mathrm{num}[3] = 1, \\mathrm{num}[5] = 2$.\"\n\nFinally, the director announced a reward: the first student to solve it correctly would get a box of chocolates. Hearing this, the penguin who had slept through the class suddenly woke up! But the penguin could not solve the problem, so it asked you, a visitor to the zoo, for help. Can you help the penguin write a program to compute the $\\mathrm{num}$ array?\n\nIn particular, to avoid massive output, you do not need to print each $\\mathrm{num}[i]$. You only need to output the product of all $(\\mathrm{num}[i] + 1)$, modulo $10^9 + 7$.", "inputFormat": "The first line contains a single positive integer $n$, the number of test cases.  \nThen follow $n$ lines, each describing one test case. Each test case contains a single string $S$. See the problem statement for the definition of $S$. It is guaranteed that $S$ contains only lowercase letters. The input file will not contain extra blank lines, and there will be no trailing spaces at the end of lines.", "outputFormat": "Output $n$ lines, each describing the answer for one test case, in the same order as the input. For each test case, output a single integer, which is the answer modulo $10^9 + 7$. The output file should not contain extra blank lines.", "hint": "Test point ID | Constraints\n-|-  \n1 | $n \\le 5, L \\le 50$  \n2 | $n \\le 5, L \\le 200$  \n3 | $n \\le 5, L \\le 200$  \n4 | $n \\le 5, L \\le 10{,}000$  \n5 | $n \\le 5, L \\le 10{,}000$  \n6 | $n \\le 5, L \\le 100{,}000$  \n7 | $n \\le 5, L \\le 200{,}000$  \n8 | $n \\le 5, L \\le 500{,}000$  \n9 | $n \\le 5, L \\le 1{,}000{,}000$  \n10 | $n \\le 5, L \\le 1{,}000{,}000$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2014] 动物园", "background": null, "description": "近日，园长发现动物园中好吃懒做的动物越来越多了。例如企鹅，只会卖萌向游客要吃的。为了整治动物园的不良风气，让动物们凭自己的真才实学向游客要吃的，园长决定开设算法班，让动物们学习算法。\n\n某天，园长给动物们讲解 KMP 算法。\n\n园长：“对于一个字符串 $S$，它的长度为 $L$。我们可以在 $O(L)$ 的时间内，求出一个名为 $\\mathrm{next}$ 的数组。有谁预习了 $\\mathrm{next}$ 数组的含义吗？”\n\n熊猫：“对于字符串 $S$ 的前 $i$ 个字符构成的子串，既是它的后缀又是它的前缀的字符串中（它本身除外），最长的长度记作 $\\mathrm{next}[i]$。”\n\n园长：“非常好！那你能举个例子吗？”\n\n熊猫：“例 $S$ 为 $\\verb!abcababc!$，则 $\\mathrm{next}[5]=2$。因为 $S$ 的前 $5$ 个字符为 $\\verb!abcab!$，$\\verb!ab!$ 既是它的后缀又是它的前缀，并且找不到一个更长的字符串满足这个性质。同理，还可得出 $\\mathrm{next}[1] = \\mathrm{next}[2] = \\mathrm{next}[3] = 0$，$\\mathrm{next}[4] = \\mathrm{next}[6] = 1$，$\\mathrm{next}[7] = 2$，$\\mathrm{next}[8] = 3$。”\n\n园长表扬了认真预习的熊猫同学。随后，他详细讲解了如何在 $O(L)$ 的时间内求出 $\\mathrm{next}$ 数组。\n\n下课前，园长提出了一个问题：“KMP 算法只能求出 $\\mathrm{next}$ 数组。我现在希望求出一个更强大 $\\mathrm{num}$ 数组一一对于字符串 $S$ 的前 $i$ 个字符构成的子串，既是它的后缀同时又是它的前缀，并且该后缀与该前缀不重叠，将这种字符串的数量记作 $\\mathrm{num}[i]$。例如 $S$ 为 $\\verb!aaaaa!$，则 $\\mathrm{num}[4] = 2$。这是因为 $S$ 的前 $4$ 个字符为 $\\verb!aaaa!$，其中 $\\verb!a!$ 和 $\\verb!aa!$ 都满足性质‘既是后缀又是前缀’，同时保证这个后缀与这个前缀不重叠。而 $\\verb!aaa!$ 虽然满足性质‘既是后缀又是前缀’，但遗憾的是这个后缀与这个前缀重叠了，所以不能计算在内。同理，$\\mathrm{num}[1] = 0,\\mathrm{num}[2] = \\mathrm{num}[3] = 1,\\mathrm{num}[5] = 2$。”\n\n最后，园长给出了奖励条件，第一个做对的同学奖励巧克力一盒。听了这句话，睡了一节课的企鹅立刻就醒过来了！但企鹅并不会做这道题，于是向参观动物园的你寻求帮助。你能否帮助企鹅写一个程序求出 $\\mathrm{num}$ 数组呢？\n\n特别地，为了避免大量的输出，你不需要输出 $\\mathrm{num}[i]$ 分别是多少，你只需要输出所有 $(\\mathrm{num}[i]+1)$ 的乘积，对 $10^9 + 7$ 取模的结果即可。", "inputFormat": "第 $1$ 行仅包含一个正整数 $n$，表示测试数据的组数。  \n随后 $n$ 行，每行描述一组测试数据。每组测试数据仅含有一个字符串 $S$，$S$ 的定义详见题目描述。数据保证 $S$ 中仅含小写字母。输入文件中不会包含多余的空行，行末不会存在多余的空格。", "outputFormat": "包含 $n$ 行，每行描述一组测试数据的答案，答案的顺序应与输入数据的顺序保持一致。对于每组测试数据，仅需要输出一个整数，表示这组测试数据的答案对 $10^9+7$ 取模的结果。输出文件中不应包含多余的空行。", "hint": "测试点编号| 约定\n-|-  \n1| $n \\le 5, L \\le 50$  \n2| $n \\le 5, L \\le 200$  \n3| $n \\le 5, L \\le 200$  \n4| $n \\le 5, L \\le 10,000$  \n5| $n \\le 5, L \\le 10,000$  \n6| $n \\le 5, L \\le 100,000$  \n7| $n \\le 5, L \\le 200,000$   \n8| $n \\le 5, L \\le 500,000$  \n9| $n \\le 5, L \\le 1,000,000$  \n10| $n \\le 5, L \\le 1,000,000$", "locale": "zh-CN"}}}
{"pid": "P2376", "type": "P", "difficulty": 4, "samples": [["3 6\n10 1\n1 100\n5 120", "111"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2005", "2009", "USACO"], "title": "[USACO05OCT] Allowance S / [USACO09OCT] Allowance G", "background": null, "description": "作为创造产奶纪录的回报，Farmer John 决定开始每个星期给 Bessie 一点零花钱。\n\nFJ 有一些硬币，一共有 $N\\ (1 \\le N \\le 20)$ 种不同的面额。每一个面额都能整除所有比它大的面额。\n\n他想用给定的硬币的集合，每个星期至少给 Bessie 某个零花钱的数目 $C\\ (1 \\le C \\le 10^8)$。请帮他计算他最多能支付多少个星期的零花钱。", "inputFormat": "第 $1$ 行：两个由空格隔开的整数：$N$ 和 $C$。\n\n第 $2$ 到第 $N+1$ 行：每一行有两个整数表示一个面额的硬币：硬币面额 $V\\ (1 \\le V \\le 10^8)$ 拥有的该面额的硬币数 $B\\ (1 \\le B \\le 10^6)$。", "outputFormat": "第 $1$ 行：一个单独的整数，表示最多能支付多少个星期的零花钱。", "hint": "### 样例解释\nFJ 可以用一个面额为 $10$ 的硬币一次性支付 Bessie $1$ 周，用两个面额为 $5$ 的硬币支付 Bessie $10$ 周，用一个面额为 $1$ 的硬币和一个面额为 $5$ 的硬币支付 Bessie $100$ 周。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO05OCT] Allowance S / [USACO09OCT] Allowance G", "background": null, "description": "As a reward for setting a milk production record, Farmer John decides to give Bessie a weekly allowance.\n\nFJ has some coins, with $N (1 \\le N \\le 20)$ different denominations. Each denomination divides all larger denominations.\n\nUsing the given collection of coins, he wants to give Bessie at least $C (1 \\le C \\le 100000000)$ each week. Please compute the maximum number of weeks he can make such payments.", "inputFormat": "Line $1$: Two space-separated integers: $N$ and $C$.\n\nLines $2$ to $N+1$: Each line contains two integers describing one coin denomination: the coin value $V (1 \\le V \\le 100,000,000)$ and the number of coins of that denomination $B (1 \\le B \\le 1,000,000)$.", "outputFormat": "Line $1$: A single integer, the maximum number of weeks he can pay an allowance of at least $C$.", "hint": "FJ can overpay Bessie with the one $10$-cent coin for $1$ week, then pay Bessie two $5$-cent coins for $10$ weeks and then pay Bessie one $1$-cent coin and one $5$-cent coin for $100$ weeks.", "locale": "en"}, "zh-CN": {"title": "[USACO05OCT] Allowance S / [USACO09OCT] Allowance G", "background": null, "description": "作为创造产奶纪录的回报，Farmer John 决定开始每个星期给 Bessie 一点零花钱。\n\nFJ 有一些硬币，一共有 $N\\ (1 \\le N \\le 20)$ 种不同的面额。每一个面额都能整除所有比它大的面额。\n\n他想用给定的硬币的集合，每个星期至少给 Bessie 某个零花钱的数目 $C\\ (1 \\le C \\le 10^8)$。请帮他计算他最多能支付多少个星期的零花钱。", "inputFormat": "第 $1$ 行：两个由空格隔开的整数：$N$ 和 $C$。\n\n第 $2$ 到第 $N+1$ 行：每一行有两个整数表示一个面额的硬币：硬币面额 $V\\ (1 \\le V \\le 10^8)$ 拥有的该面额的硬币数 $B\\ (1 \\le B \\le 10^6)$。", "outputFormat": "第 $1$ 行：一个单独的整数，表示最多能支付多少个星期的零花钱。", "hint": "### 样例解释\nFJ 可以用一个面额为 $10$ 的硬币一次性支付 Bessie $1$ 周，用两个面额为 $5$ 的硬币支付 Bessie $10$ 周，用一个面额为 $1$ 的硬币和一个面额为 $5$ 的硬币支付 Bessie $100$ 周。", "locale": "zh-CN"}}}
{"pid": "P2377", "type": "P", "difficulty": 5, "samples": [["2\neee\ncedde\n", "1\ndede\n\n3\nbeddde cdecde cecece\n"], ["2\nadeccecced\ndddddd\n", "5\nacedccecced addebcecced adebebecced adecbedcced cceccecce\n\n1\ncddddce\n"], ["7\neee\ncedde\nadeccecced\ndddddd\nccdeccde\nbaedddcdde\nabcedcdcddde", "1\ndede\n\n3\nbeddde cdecde cecece\n\n5\nacedccecced addebcecced adebebecced adecbedcced cceccecce\n\n1\ncddddce\n\n4\nbcdeccdde bcedccece bdeccdebe cccedccde\n\n8\nabdecdcddde abececcddde abedcebddde abeddbecdde abeddccecde abeddcdcece abeddcddced addddcdde\n\n10\nabbeddcdcddde abcdeccdcddde abcecebdcddde abcedbeccddde abcedccebddde abcedcdbecdde abcedcdccecde abcedcdcdcece abcedcdcddced acedcdcdddd"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "字符串"], "title": "三角形图", "background": "请在 [这里](https://www.luogu.com.cn/paste/tre46v8i) 查看原题面。", "description": "UNowen 有 $n$ 个[平面向量](https://baike.baidu.com/item/%E5%B9%B3%E9%9D%A2%E5%90%91%E9%87%8F/448934?fr=ge_ala) $\\{\\bm L_n\\}$，其中：\n\n- $|\\bm L_1|=|\\bm L_2|=\\ldots=|\\bm L_n|=1$；\n- $\\bm L_1+\\bm L_2+\\ldots+\\bm L_n=\\bm 0$；\n- 对于任意正整数 $1 \\le i,j \\le n$，总存在整数 $k$ 使得 $\\langle\\bm L_i,\\bm L_j\\rangle=\\dfrac{k\\pi}{3}$；（[$\\dfrac{k\\pi}{3}=k \\times 60^\\circ$](https://baike.baidu.com/item/%E5%BC%A7%E5%BA%A6/1533188?fr=ge_ala)）\n- 除了整个向量序列以外（下同），向量序列中不存在和为 $\\bm 0$ 的一段。\n\n此处 $\\langle\\bm X,\\bm Y\\rangle$ 代指「将 $\\bm X$ 旋转至与 $\\bm Y$ 同向所旋转的角度」，逆时针为正角，顺时针为负角（例如，设 $\\bm X=(\\dfrac{\\sqrt{2}}{2},\\dfrac{\\sqrt{2}}{2})$，$\\bm Y=(1,0)$，则 $\\langle\\bm X,\\bm Y\\rangle=-\\dfrac{\\pi}{4}$）。\n\n**也就是说，这 $n$ 个向量的长度（模）均为 $1$，并且首尾拼接可以得到一个封闭多边形。保证这个封闭多边形的各个内角均为 $\\dfrac{\\pi}{3}$ 的正整数倍，内部没有其他向量，并且不是空心的。**\n\n为了表述方便，我们用一个长度为 $n$，字符集为 $\\{\\tt a,\\tt b,\\tt c,\\tt d,\\tt e,\\#\\}$ 的字符串 $S$ 来描述 $\\{\\bm L_n\\}$。\n\n具体地，对于 $S$ 的第 $i$ 个字符（特别地，$\\bm L_0$ 等价于 $\\bm L_n$，$\\bm L_{n+1}$ 等价于 $\\bm L_1$，下同）：\n\n| 字符 | 含义 |\n| :----------: | :----------: |\n| $\\tt a$ | $\\langle\\bm L_i,\\bm L_{i+1}\\rangle=\\dfrac{2\\pi}{3}$ |\n| $\\tt b$ | $\\langle\\bm L_i,\\bm L_{i+1}\\rangle=\\dfrac{\\pi}{3}$ |\n| $\\tt c$ | $\\langle\\bm L_i,\\bm L_{i+1}\\rangle=0$ |\n| $\\tt d$ | $\\langle\\bm L_i,\\bm L_{i+1}\\rangle=-\\dfrac{\\pi}{3}$ |\n| $\\tt e$ | $\\langle\\bm L_i,\\bm L_{i+1}\\rangle=-\\dfrac{2\\pi}{3}$ |\n| $\\tt \\#$ | $\\vert\\langle\\bm L_i,\\bm L_{i+1}\\rangle\\vert=\\pi$ |\n\n\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/68g5vnfv.png)\n\n此外，UNowen 按如下方式定义一个向量序列 $\\{\\bm L_1,\\bm L_2,\\ldots,\\bm L_n\\}$ 的「标准表示」：\n\n- 分别对于 $l=1,2,\\ldots,n$，求出向量序列 $\\{\\bm L_l,\\bm L_{l+1},\\ldots,\\bm L_n,\\bm L_1,\\bm L_2,\\ldots,\\bm L_{l-1}\\}$ 对应的字符串：\n- 取 $n$ 个字符串中[字典序](https://baike.baidu.com/item/%E5%AD%97%E5%85%B8%E5%BA%8F/7786229?fr=ge_ala)最小的字符串作为向量序列 $\\{\\bm L_1,\\bm L_2,\\ldots,\\bm L_n\\}$ 的「标准表示」。\n\n例如，上图中向量序列的「标准表示」是 $S=\\texttt{abcedcdcddde}$，而不能是 $S=\\texttt{dcdcdddeabce}$。\n\n现在，UNowen 把向量序列 $\\{\\bm L_1,\\bm L_2,\\ldots,\\bm L_n\\}$ 对应的字符串 $S$（不一定是「标准表示」）给了你。他希望你可以按如下方式对这个向量序列进行一次修改：\n\n- 选定一个正整数 $1 \\le k \\le n$；\n- 构造两个平面向量 $\\bm X,\\bm Y$，使得：\n  - $|\\bm X|=1$；\n  - $|\\bm Y|=1$；\n  - $\\langle\\bm L_k,\\bm X\\rangle=\\dfrac{\\pi}{3}$；\n  - $\\langle\\bm L_k,\\bm Y\\rangle=-\\dfrac{\\pi}{3}$。\n- 用 $\\bm X,\\bm Y$ 两项（$\\bm X$ 在前，$\\bm Y$ 在后）替换 $\\bm L_k$；\n- 若 $\\bm L_{k-1}+\\bm X=\\bm 0$，删除 $\\bm L_{k-1},\\bm X$；\n- 若 $\\bm L_{k+1}+\\bm Y=\\bm 0$，删除 $\\bm L_{k+1},\\bm Y$；\n- 若修改后的向量序列中存在和为 $\\bm 0$ 的一段（除了整个向量序列以外），那么 UNowen 称这次修改是不合法的。例如，在下面的图片中，如果选择 $k=3$，那么修改就是不合法的。\n- UNowen 会将修改后的向量序列的「标准表示」定义为该次修改的「修改结果」。\n- 对于任意两个修改方案，如果修改后的向量序列首尾拼接得到的图形全等，那么 UNowen 会认为这两个修改方案是等价的。例如，在下面的图片中，$k=1$ 和 $k=2$ 的两个修改方案就是等价的。\n- **也就是说，修改操作会对封闭多边形上的某个向量向外作等边三角形，使得修改后的图形仍为满足上述要求（各个内角均为 $\\dfrac{\\pi}{3}$ 的正整数倍，内部没有其他向量，并且不是空心的）的封闭多边形。对于任意两个修改方案，如果修改后的向量序列首尾拼接得到的图形全等，那么它们是等价的。**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/dgd779r1.png)\n\n请求出互不等价的合法的修改方案的个数，并按字典序从小到大输出每个修改方案的「修改结果」。", "inputFormat": "**本题有多组数据。**\n\n第一行一个正整数 $T$，表示数据组数。\n\n下面 $T$ 行，每行一个字符集为 $\\{\\tt a,\\tt b,\\tt c,\\tt d,\\tt e\\}$ 的非空字符串 $S$。保证 $\\tt \\#$ 不会出现。", "outputFormat": "对于每组数据，输出三行：\n\n第一行一个正整数 $K$，表示，并按字典序从小到大输出每个修改方案。\n\n第二行 $K$ 个字符集为 $\\{\\tt a,\\tt b,\\tt c,\\tt d,\\tt e\\}$ 的非空字符串（用空格隔开），表示每个可能出现的「修改结果」。你需要按字典序从小到大的顺序输出它们。可以证明 $\\tt \\#$ 不会出现。\n\n**第三行是空行。请特别注意这一点，因为它不符合传统题的一般数据格式。**", "hint": "设 $|S|$ 为字符串 $S$ 的长度。\n\n对于 $30\\%$ 的数据，$T \\le 5$，$|S| \\le 9$。\n\n对于 $50\\%$ 的数据，保证所有的修改方案都是合法的。\n\n对于 $100\\%$ 的数据，$1 \\le T \\le 100$，$3 \\le |S| \\le 75$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Triangle Graph", "background": "Please view the original statement [here](https://www.luogu.com.cn/paste/tre46v8i).", "description": "UNowen has $n$ [plane vectors](https://baike.baidu.com/item/%E5%B9%B3%E9%9D%A2%E5%90%91%E9%87%8F/448934?fr=ge_ala) $\\{\\bm L_n\\}$, where:\n\n- $|\\bm L_1|=|\\bm L_2|=\\ldots=|\\bm L_n|=1$;\n- $\\bm L_1+\\bm L_2+\\ldots+\\bm L_n=\\bm 0$;\n- For any positive integers $1 \\le i,j \\le n$, there always exists an integer $k$ such that $\\langle\\bm L_i,\\bm L_j\\rangle=\\dfrac{k\\pi}{3}$; ([$\\dfrac{k\\pi}{3}=k \\times 60^\\circ$](https://baike.baidu.com/item/%E5%BC%A7%E5%BA%A6/1533188?fr=ge_ala))\n- Except for the entire vector sequence (same below), there is no contiguous subsequence in the vector sequence whose sum is $\\bm 0$.\n\nHere $\\langle\\bm X,\\bm Y\\rangle$ denotes “the angle by which $\\bm X$ is rotated to point in the same direction as $\\bm Y$,” where counterclockwise is positive and clockwise is negative (for example, let $\\bm X=(\\dfrac{\\sqrt{2}}{2},\\dfrac{\\sqrt{2}}{2})$, $\\bm Y=(1,0)$, then $\\langle\\bm X,\\bm Y\\rangle=-\\dfrac{\\pi}{4}$).\n\nIn other words, all $n$ vectors have length $1$, and concatenating them head to tail forms a closed polygon. It is guaranteed that each interior angle of this polygon is an integer multiple of $\\dfrac{\\pi}{3}$, its interior contains no other vectors, and it is not hollow.\n\nFor convenience, we use a string $S$ of length $n$ over the alphabet $\\{\\tt a,\\tt b,\\tt c,\\tt d,\\tt e,\\#\\}$ to describe $\\{\\bm L_n\\}$.\n\nSpecifically, for the $i$-th character in $S$ (in particular, $\\bm L_0$ is equivalent to $\\bm L_n$, and $\\bm L_{n+1}$ is equivalent to $\\bm L_1$, similarly below):\n\n| 字符 | 含义 |\n| :----------: | :----------: |\n| $\\tt a$ | $\\langle\\bm L_i,\\bm L_{i+1}\\rangle=\\dfrac{2\\pi}{3}$ |\n| $\\tt b$ | $\\langle\\bm L_i,\\bm L_{i+1}\\rangle=\\dfrac{\\pi}{3}$ |\n| $\\tt c$ | $\\langle\\bm L_i,\\bm L_{i+1}\\rangle=0$ |\n| $\\tt d$ | $\\langle\\bm L_i,\\bm L_{i+1}\\rangle=-\\dfrac{\\pi}{3}$ |\n| $\\tt e$ | $\\langle\\bm L_i,\\bm L_{i+1}\\rangle=-\\dfrac{2\\pi}{3}$ |\n| $\\tt \\#$ | $\\vert\\langle\\bm L_i,\\bm L_{i+1}\\rangle\\vert=\\pi$ |\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/68g5vnfv.png)\n\nIn addition, UNowen defines a “standard representation” of a vector sequence $\\{\\bm L_1,\\bm L_2,\\ldots,\\bm L_n\\}$ as follows:\n\n- For $l=1,2,\\ldots,n$, compute the string corresponding to the vector sequence $\\{\\bm L_l,\\bm L_{l+1},\\ldots,\\bm L_n,\\bm L_1,\\bm L_2,\\ldots,\\bm L_{l-1}\\}$.\n- Among these $n$ strings, take the lexicographically smallest string as the “standard representation” of the vector sequence $\\{\\bm L_1,\\bm L_2,\\ldots,\\bm L_n\\}$.\n\nFor example, the “standard representation” of the vector sequence in the figure above is $S=\\texttt{abcedcdcddde}$, and not $S=\\texttt{dcdcdddeabce}$.\n\nNow, UNowen gives you the string $S$ corresponding to the vector sequence $\\{\\bm L_1,\\bm L_2,\\ldots,\\bm L_n\\}$ (which is not necessarily its “standard representation”). He hopes you can perform one modification to this vector sequence as follows:\n\n- Choose a positive integer $1 \\le k \\le n$.\n- Construct two plane vectors $\\bm X,\\bm Y$ such that:\n  - $|\\bm X|=1$;\n  - $|\\bm Y|=1$;\n  - $\\langle\\bm L_k,\\bm X\\rangle=\\dfrac{\\pi}{3}$;\n  - $\\langle\\bm L_k,\\bm Y\\rangle=-\\dfrac{\\pi}{3}$.\n- Replace $\\bm L_k$ with two items $\\bm X,\\bm Y$ (with $\\bm X$ before $\\bm Y$).\n- If $\\bm L_{k-1}+\\bm X=\\bm 0$, delete $\\bm L_{k-1}$ and $\\bm X$.\n- If $\\bm L_{k+1}+\\bm Y=\\bm 0$, delete $\\bm L_{k+1}$ and $\\bm Y$.\n- If after the modification there exists a contiguous subsequence whose sum is $\\bm 0$ (other than the entire vector sequence), then UNowen considers this modification invalid. For example, in the figure below, if you choose $k=3$, then the modification is invalid.\n- UNowen defines the “modification result” as the “standard representation” of the modified vector sequence.\n- For any two modification schemes, if the polygons obtained by concatenating the modified vector sequences head to tail are congruent, then UNowen considers the two modification schemes equivalent. For example, in the figure below, the two modification schemes $k=1$ and $k=2$ are equivalent.\n- That is, the modification operation constructs an outward equilateral triangle on some vector of the closed polygon, such that the modified shape is still a closed polygon satisfying the above requirements (each interior angle is an integer multiple of $\\dfrac{\\pi}{3}$, the interior contains no other vectors, and it is not hollow). For any two modification schemes, if the polygons obtained from the modified sequences are congruent, then they are equivalent.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/dgd779r1.png)\n\nFind the number of pairwise non-equivalent valid modification schemes, and output the “modification result” of each scheme in lexicographic order.", "inputFormat": "This problem contains multiple test cases.\n\nThe first line contains a positive integer $T$, the number of test cases.\n\nThe next $T$ lines each contain a non-empty string $S$ over the alphabet $\\{\\tt a,\\tt b,\\tt c,\\tt d,\\tt e\\}$. It is guaranteed that $\\tt \\#$ will not appear.", "outputFormat": "For each test case, output three lines:\n\n- The first line contains a positive integer $K$, the number of pairwise non-equivalent valid modification schemes.\n- The second line contains $K$ non-empty strings over the alphabet $\\{\\tt a,\\tt b,\\tt c,\\tt d,\\tt e\\}$ (separated by spaces), representing each possible “modification result.” You must output them in lexicographic order. It can be proven that $\\tt \\#$ will not appear.\n- The third line is an empty line. Please pay special attention to this, as it does not follow the usual data format of traditional problems.", "hint": "Let $|S|$ be the length of the string $S$.\n\n- For $30\\%$ of the testdata, $T \\le 5$, $|S| \\le 9$.\n- For $50\\%$ of the testdata, it is guaranteed that all modification schemes are valid.\n- For $100\\%$ of the testdata, $1 \\le T \\le 100$, $3 \\le |S| \\le 75$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "三角形图", "background": "请在 [这里](https://www.luogu.com.cn/paste/tre46v8i) 查看原题面。", "description": "UNowen 有 $n$ 个[平面向量](https://baike.baidu.com/item/%E5%B9%B3%E9%9D%A2%E5%90%91%E9%87%8F/448934?fr=ge_ala) $\\{\\bm L_n\\}$，其中：\n\n- $|\\bm L_1|=|\\bm L_2|=\\ldots=|\\bm L_n|=1$；\n- $\\bm L_1+\\bm L_2+\\ldots+\\bm L_n=\\bm 0$；\n- 对于任意正整数 $1 \\le i,j \\le n$，总存在整数 $k$ 使得 $\\langle\\bm L_i,\\bm L_j\\rangle=\\dfrac{k\\pi}{3}$；（[$\\dfrac{k\\pi}{3}=k \\times 60^\\circ$](https://baike.baidu.com/item/%E5%BC%A7%E5%BA%A6/1533188?fr=ge_ala)）\n- 除了整个向量序列以外（下同），向量序列中不存在和为 $\\bm 0$ 的一段。\n\n此处 $\\langle\\bm X,\\bm Y\\rangle$ 代指「将 $\\bm X$ 旋转至与 $\\bm Y$ 同向所旋转的角度」，逆时针为正角，顺时针为负角（例如，设 $\\bm X=(\\dfrac{\\sqrt{2}}{2},\\dfrac{\\sqrt{2}}{2})$，$\\bm Y=(1,0)$，则 $\\langle\\bm X,\\bm Y\\rangle=-\\dfrac{\\pi}{4}$）。\n\n**也就是说，这 $n$ 个向量的长度（模）均为 $1$，并且首尾拼接可以得到一个封闭多边形。保证这个封闭多边形的各个内角均为 $\\dfrac{\\pi}{3}$ 的正整数倍，内部没有其他向量，并且不是空心的。**\n\n为了表述方便，我们用一个长度为 $n$，字符集为 $\\{\\tt a,\\tt b,\\tt c,\\tt d,\\tt e,\\#\\}$ 的字符串 $S$ 来描述 $\\{\\bm L_n\\}$。\n\n具体地，对于 $S$ 的第 $i$ 个字符（特别地，$\\bm L_0$ 等价于 $\\bm L_n$，$\\bm L_{n+1}$ 等价于 $\\bm L_1$，下同）：\n\n| 字符 | 含义 |\n| :----------: | :----------: |\n| $\\tt a$ | $\\langle\\bm L_i,\\bm L_{i+1}\\rangle=\\dfrac{2\\pi}{3}$ |\n| $\\tt b$ | $\\langle\\bm L_i,\\bm L_{i+1}\\rangle=\\dfrac{\\pi}{3}$ |\n| $\\tt c$ | $\\langle\\bm L_i,\\bm L_{i+1}\\rangle=0$ |\n| $\\tt d$ | $\\langle\\bm L_i,\\bm L_{i+1}\\rangle=-\\dfrac{\\pi}{3}$ |\n| $\\tt e$ | $\\langle\\bm L_i,\\bm L_{i+1}\\rangle=-\\dfrac{2\\pi}{3}$ |\n| $\\tt \\#$ | $\\vert\\langle\\bm L_i,\\bm L_{i+1}\\rangle\\vert=\\pi$ |\n\n\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/68g5vnfv.png)\n\n此外，UNowen 按如下方式定义一个向量序列 $\\{\\bm L_1,\\bm L_2,\\ldots,\\bm L_n\\}$ 的「标准表示」：\n\n- 分别对于 $l=1,2,\\ldots,n$，求出向量序列 $\\{\\bm L_l,\\bm L_{l+1},\\ldots,\\bm L_n,\\bm L_1,\\bm L_2,\\ldots,\\bm L_{l-1}\\}$ 对应的字符串：\n- 取 $n$ 个字符串中[字典序](https://baike.baidu.com/item/%E5%AD%97%E5%85%B8%E5%BA%8F/7786229?fr=ge_ala)最小的字符串作为向量序列 $\\{\\bm L_1,\\bm L_2,\\ldots,\\bm L_n\\}$ 的「标准表示」。\n\n例如，上图中向量序列的「标准表示」是 $S=\\texttt{abcedcdcddde}$，而不能是 $S=\\texttt{dcdcdddeabce}$。\n\n现在，UNowen 把向量序列 $\\{\\bm L_1,\\bm L_2,\\ldots,\\bm L_n\\}$ 对应的字符串 $S$（不一定是「标准表示」）给了你。他希望你可以按如下方式对这个向量序列进行一次修改：\n\n- 选定一个正整数 $1 \\le k \\le n$；\n- 构造两个平面向量 $\\bm X,\\bm Y$，使得：\n  - $|\\bm X|=1$；\n  - $|\\bm Y|=1$；\n  - $\\langle\\bm L_k,\\bm X\\rangle=\\dfrac{\\pi}{3}$；\n  - $\\langle\\bm L_k,\\bm Y\\rangle=-\\dfrac{\\pi}{3}$。\n- 用 $\\bm X,\\bm Y$ 两项（$\\bm X$ 在前，$\\bm Y$ 在后）替换 $\\bm L_k$；\n- 若 $\\bm L_{k-1}+\\bm X=\\bm 0$，删除 $\\bm L_{k-1},\\bm X$；\n- 若 $\\bm L_{k+1}+\\bm Y=\\bm 0$，删除 $\\bm L_{k+1},\\bm Y$；\n- 若修改后的向量序列中存在和为 $\\bm 0$ 的一段（除了整个向量序列以外），那么 UNowen 称这次修改是不合法的。例如，在下面的图片中，如果选择 $k=3$，那么修改就是不合法的。\n- UNowen 会将修改后的向量序列的「标准表示」定义为该次修改的「修改结果」。\n- 对于任意两个修改方案，如果修改后的向量序列首尾拼接得到的图形全等，那么 UNowen 会认为这两个修改方案是等价的。例如，在下面的图片中，$k=1$ 和 $k=2$ 的两个修改方案就是等价的。\n- **也就是说，修改操作会对封闭多边形上的某个向量向外作等边三角形，使得修改后的图形仍为满足上述要求（各个内角均为 $\\dfrac{\\pi}{3}$ 的正整数倍，内部没有其他向量，并且不是空心的）的封闭多边形。对于任意两个修改方案，如果修改后的向量序列首尾拼接得到的图形全等，那么它们是等价的。**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/dgd779r1.png)\n\n请求出互不等价的合法的修改方案的个数，并按字典序从小到大输出每个修改方案的「修改结果」。", "inputFormat": "**本题有多组数据。**\n\n第一行一个正整数 $T$，表示数据组数。\n\n下面 $T$ 行，每行一个字符集为 $\\{\\tt a,\\tt b,\\tt c,\\tt d,\\tt e\\}$ 的非空字符串 $S$。保证 $\\tt \\#$ 不会出现。", "outputFormat": "对于每组数据，输出三行：\n\n第一行一个正整数 $K$，表示，并按字典序从小到大输出每个修改方案。\n\n第二行 $K$ 个字符集为 $\\{\\tt a,\\tt b,\\tt c,\\tt d,\\tt e\\}$ 的非空字符串（用空格隔开），表示每个可能出现的「修改结果」。你需要按字典序从小到大的顺序输出它们。可以证明 $\\tt \\#$ 不会出现。\n\n**第三行是空行。请特别注意这一点，因为它不符合传统题的一般数据格式。**", "hint": "设 $|S|$ 为字符串 $S$ 的长度。\n\n对于 $30\\%$ 的数据，$T \\le 5$，$|S| \\le 9$。\n\n对于 $50\\%$ 的数据，保证所有的修改方案都是合法的。\n\n对于 $100\\%$ 的数据，$1 \\le T \\le 100$，$3 \\le |S| \\le 75$。\n", "locale": "zh-CN"}}}
{"pid": "P2378", "type": "P", "difficulty": 3, "samples": [["x^2-4", "(x+2)(x-2)\r\n//而不能写成(x-2)(x+2)或者(x+2)(x+-2)"], ["x^2+5x+4", "(x+4)(x+1)\r\n//不能写成(x+1)(x+4)"], ["x^2-2x+1", "(x-1)^2"], ["x^2+x", "(x+1)x\r\n//反过来是不可以的。"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "2015", "洛谷原创", "洛谷月赛"], "title": "因式分解II", "background": null, "description": "小玉上了初中，开始学因式分解。可是她怎么都解不出来。所以她求你帮忙。\n\n她给你看了她的作业，就是因式分解。由于刚开始学，就降低了难度。\n\n我们假设作业里面的代数只有一个 $x$。最高指数是 $2$，且最高指数的系数是 $1$。当 $x$ 前的系数是 $1$ 时，$1$ 省去……（反正作业题目符合我们的日常写法）\n\n我们帮她解决下这个“简单”的问题吧！虽然听起来挺容易，但是编程需要考虑很多情况呢！\n\n保证作业答案的数字都是整数。\n\n\n// 这跟神器有什么关系么？神说，帮助他人，积累善行，神器自然出现。哈哈哈哈好牵强的解释~\n\n//为了帮助在5月月赛ac这道题目，kkksc03偷偷地进行以下的温馨提示：\n\n//数据可能会比较刁钻，请考虑到各种情况，包括只有输入一项的情况、中间过程会不会超maxlongint的情况等。\n\n//lzn：喂！你这是透题行为，是要上法庭的！\n\n//absi2011:样例输出里的\"//\"及以后字符只是注解,并不要你输出\n\n/\\*\nabsi2011:输入规范好不和谐啊...\n\n我只是来补充一下...\n\n如果 $x$ 或者常数项的系数是 $0$ 整个省略掉。\n\n哦,$x$ 的系数是 $-1$ 的话 也会把 $1$ 省去...\n\n保证输入的那玩意儿可以分解....而且分解出来都是整数...\n\n\\*/\n\n// 原作: 2022.7.24 没想到初中时候贡的题已经~~坑害了~~这么多人ac了.  现在已经大二，时过境迁，已经完全不会了哈哈哈", "inputFormat": "一个多项式，要求前面已述。各个系数 $\\leq\\text{maxlongint}$。", "outputFormat": "几个乘积。答案也符合日常写法。为了方便老师批改，若将答案表示成 $(x+a)(x+b)$，则 $a>b$。\n\n什么是日常写法？\n\n1. $(x+0)$写成 $x$。\n\n2. $(x+a)(x+a)$ 写成 $(x+a)^2$。\n\n3. 有时候可以这样写：$(x-3)$。但是不能出现类似于 $(x+-3)$ 这样的写法。", "hint": "$x$ 次数不高于 $2$ 次，项数不高于 $3$ 项，降幂排列。", "locale": "zh-CN", "translations": {"en": {"title": "Factorization II", "background": "", "description": "Xiaoyu has entered junior high and started learning factorization. However, she just cannot solve the problems, so she asks you for help.\n\nShe shows you her homework, which is about factorization. Since she has just started, the difficulty is lowered.\n\nWe assume the algebra in the homework uses only one variable $ x $. The highest degree is $ 2 $, and the leading coefficient is $ 1 $. When the coefficient in front of $ x $ is $ 1 $, the $ 1 $ is omitted. In short, the homework follows our usual writing style.\n\nLet’s help her solve this “simple” problem! Although it sounds easy, programming needs to consider many cases!\n\nIt is guaranteed that all numbers in the answer are integers.\n\n// What does this have to do with the “artifact”? God says, help others, accumulate good deeds, and the artifact will naturally appear. Hahaha, what a far-fetched explanation.\n\n// To help AC this problem in the May monthly contest, kkksc03 secretly provides the following gentle reminder:\n\n// The testdata may be tricky. Please consider various cases, including the case with only one input term, and whether intermediate results might overflow maxlongint, etc.\n\n// lzn: Hey! This is leaking the problem. You will go to court for this!\n\n// absi2011: The “//” and the characters after it in the sample output are just comments and should not be printed by your program.\n\n/*\nabsi2011: The input spec is not very harmonious...\n\nI just want to add...\n\nIf the coefficient of $ x $ or the constant term is $ 0 $, omit the entire term.\n\nOh, if the coefficient of $ x $ is $ -1 $, the $ 1 $ will also be omitted...\n\nWe guarantee the input can be factored, and the factorization has integer coefficients...\n*/\n\n// Original: 2022.7.24. I didn’t expect that the problem I posted in middle school has “trapped” so many people into AC-ing it. Now I’m a sophomore in college. Time flies, and I have completely forgotten how to do it, haha.", "inputFormat": "A single polynomial, as described above. Each coefficient is an integer not greater than maxlongint.", "outputFormat": "Output the product of factors. The answer should also follow the usual writing style. For easier grading, if the answer is written as $(x+a)(x+b)$, then $ a > b $.\n\nWhat is the usual writing style?\n\n1. $(x+0)$ is written as $ x $.\n2. $(x+a)(x+a)$ is written as $(x+a)^2$.\n3. Sometimes you can write $(x-3)$, but you must not write something like $(x+-3)$.", "hint": "The degree of $ x $ does not exceed $ 2 $, the number of terms does not exceed $ 3 $, and terms are in descending powers.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "因式分解II", "background": null, "description": "小玉上了初中，开始学因式分解。可是她怎么都解不出来。所以她求你帮忙。\n\n她给你看了她的作业，就是因式分解。由于刚开始学，就降低了难度。\n\n我们假设作业里面的代数只有一个 $x$。最高指数是 $2$，且最高指数的系数是 $1$。当 $x$ 前的系数是 $1$ 时，$1$ 省去……（反正作业题目符合我们的日常写法）\n\n我们帮她解决下这个“简单”的问题吧！虽然听起来挺容易，但是编程需要考虑很多情况呢！\n\n保证作业答案的数字都是整数。\n\n\n// 这跟神器有什么关系么？神说，帮助他人，积累善行，神器自然出现。哈哈哈哈好牵强的解释~\n\n//为了帮助在5月月赛ac这道题目，kkksc03偷偷地进行以下的温馨提示：\n\n//数据可能会比较刁钻，请考虑到各种情况，包括只有输入一项的情况、中间过程会不会超maxlongint的情况等。\n\n//lzn：喂！你这是透题行为，是要上法庭的！\n\n//absi2011:样例输出里的\"//\"及以后字符只是注解,并不要你输出\n\n/\\*\nabsi2011:输入规范好不和谐啊...\n\n我只是来补充一下...\n\n如果 $x$ 或者常数项的系数是 $0$ 整个省略掉。\n\n哦,$x$ 的系数是 $-1$ 的话 也会把 $1$ 省去...\n\n保证输入的那玩意儿可以分解....而且分解出来都是整数...\n\n\\*/\n\n// 原作: 2022.7.24 没想到初中时候贡的题已经~~坑害了~~这么多人ac了.  现在已经大二，时过境迁，已经完全不会了哈哈哈", "inputFormat": "一个多项式，要求前面已述。各个系数 $\\leq\\text{maxlongint}$。", "outputFormat": "几个乘积。答案也符合日常写法。为了方便老师批改，若将答案表示成 $(x+a)(x+b)$，则 $a>b$。\n\n什么是日常写法？\n\n1. $(x+0)$写成 $x$。\n\n2. $(x+a)(x+a)$ 写成 $(x+a)^2$。\n\n3. 有时候可以这样写：$(x-3)$。但是不能出现类似于 $(x+-3)$ 这样的写法。", "hint": "$x$ 次数不高于 $2$ 次，项数不高于 $3$ 项，降幂排列。", "locale": "zh-CN"}}}
{"pid": "P2379", "type": "P", "difficulty": 5, "samples": [["(a+b)*(a+b+c)", "a^2+2ab+ac+b^2+bc"], ["(a+b)*(a+b+c)", "a^2+2ab+ac+b^2+bc"], ["(2a+b)*(2a-b)", "4a^2-b^2"], ["(a+b)*(a+b)*(a+b)", "a^3+3a^2b+3ab^2+b^3"], ["f*(a+b+d+z)+f^2", "af+bf+df+fz+f^2"], ["(a+b+2c)*(a+b-2c)-(a+b)*(a+b)", "-4c^2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "字符串", "数学", "洛谷原创"], "title": "整式的计算【数据有误】", "background": "小明上了初中，整式计算总是出错，所以他找到了爱编程的你，让你设计一个程序帮帮他。\n", "description": "输入几个单项式或多项式，计算结果。\n", "inputFormat": "包括+，-,\\*,字母(只包括a到z26个小写字母)单项式两边没有括号，多项式两边有( )或[ ]，保证在每一个因式中，单项式在多项式前面。（长度不超过255）\n", "outputFormat": "输出这个表达式的结果，每个因式按字典序排列。\n", "hint": "水题一道。\n", "locale": "zh-CN", "translations": {"en": {"title": "Polynomial Calculation [Incorrect testdata]", "background": "Xiao Ming has started middle school. He keeps making mistakes in polynomial calculations, so he turned to you, a programming enthusiast, to design a program to help him.", "description": "Input several monomials or polynomials and compute the result.", "inputFormat": "The expression includes +, -, \\*, and letters (only the 26 lowercase letters a to z). A monomial has no surrounding brackets; a polynomial is enclosed in ( ) or [ ]. It is guaranteed that, within each multiplicative factor, monomials come before polynomials. The length does not exceed 255.", "outputFormat": "Output the result of the expression, with each factor arranged in lexicographic order.", "hint": "A simple problem.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "整式的计算【数据有误】", "background": "小明上了初中，整式计算总是出错，所以他找到了爱编程的你，让你设计一个程序帮帮他。\n", "description": "输入几个单项式或多项式，计算结果。\n", "inputFormat": "包括+，-,\\*,字母(只包括a到z26个小写字母)单项式两边没有括号，多项式两边有( )或[ ]，保证在每一个因式中，单项式在多项式前面。（长度不超过255）\n", "outputFormat": "输出这个表达式的结果，每个因式按字典序排列。\n", "hint": "水题一道。\n", "locale": "zh-CN"}}}
{"pid": "P2380", "type": "P", "difficulty": 4, "samples": [["4 4\n0 0 10 9 \n1 3 10 0\n4 2 1 3 \n1 1 20 0 \n10 0 0 0 \n1 1 1 30 \n0 0 5 5 \n5 10 10 10 \n0 0", "98"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP"], "title": "狗哥采矿", "background": "又是一节平静的语文课。\n\n狗哥闲来无事，出来了这么一道题。\n", "description": "一个 $n\\times m$ 的矩阵中，每个格子内有两种矿 yeyenum 和 bloggium，并且知道它们在每个格子内的数量是多少。最北边有 bloggium 的收集站，最西边有 yeyenum 的收集站。现在要你在这些格子上面安装向北或者向西的传送带（每个格子只能装一种）。问最多能采到多少矿？\n\n", "inputFormat": "第一行包含两个整数 $n,m,\\ ( 1 ≤ n ≤ 500, 1 ≤ m ≤ 500)$。接下来 $n$ 行 $m$ 列，表示每个格子中可以传送到 yeyenum 的数量（小于 $1000$），再接下来 $n$ 行 $m$ 列，表示每个格子中可以传送到 bloggium 的数量。$n, m$ 同时为 $0$ 时结束。\n", "outputFormat": "每组测试数据仅输出一个数，表示最多能采到的矿。\n", "hint": "传输过程中不能转弯，只能走直路。\n", "locale": "zh-CN", "translations": {"en": {"title": "Gou-ge's Mining", "background": "It is another calm Chinese class. Gou-ge (pinyin) was bored and came up with this problem.", "description": "In an $n\\times m$ grid, each cell contains two types of minerals: yeyenum and bloggium, and the amount of each in every cell is known. There is a collection station for bloggium at the northern edge, and a collection station for yeyenum at the western edge. You must install a conveyor belt in each cell that points either north or west (each cell can have only one direction). What is the maximum total amount of minerals that can be collected?", "inputFormat": "The first line contains two integers $n,m,\\ ( 1 ≤ n ≤ 500, 1 ≤ m ≤ 500)$. Then follow $n$ lines and $m$ columns giving, for each cell, the amount that can be transported as yeyenum (each value is less than $1000$). After that, another $n$ lines and $m$ columns follow, giving the amount that can be transported as bloggium for each cell. The input ends when $n, m$ are both $0$.", "outputFormat": "For each test case, output a single integer: the maximum total amount of minerals that can be collected.", "hint": "During transportation, turning is not allowed; items can only travel in a straight line.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "狗哥采矿", "background": "又是一节平静的语文课。\n\n狗哥闲来无事，出来了这么一道题。\n", "description": "一个 $n\\times m$ 的矩阵中，每个格子内有两种矿 yeyenum 和 bloggium，并且知道它们在每个格子内的数量是多少。最北边有 bloggium 的收集站，最西边有 yeyenum 的收集站。现在要你在这些格子上面安装向北或者向西的传送带（每个格子只能装一种）。问最多能采到多少矿？\n\n", "inputFormat": "第一行包含两个整数 $n,m,\\ ( 1 ≤ n ≤ 500, 1 ≤ m ≤ 500)$。接下来 $n$ 行 $m$ 列，表示每个格子中可以传送到 yeyenum 的数量（小于 $1000$），再接下来 $n$ 行 $m$ 列，表示每个格子中可以传送到 bloggium 的数量。$n, m$ 同时为 $0$ 时结束。\n", "outputFormat": "每组测试数据仅输出一个数，表示最多能采到的矿。\n", "hint": "传输过程中不能转弯，只能走直路。\n", "locale": "zh-CN"}}}
{"pid": "P2381", "type": "P", "difficulty": 3, "samples": [["5\n1\n2\n3\n4\n5\n", "7\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "双指针 two-pointer"], "title": "圆圆舞蹈", "background": "", "description": "熊大妈的奶牛在时针的带领下，围成了一个圆圈，由于没有严格的教育，奶牛们之间的间隔不一致。\n\n奶牛想知道两只最远的奶牛到底隔了多远。奶牛 $A$ 到 $B$ 的距离为 $A$ 顺时针走和逆时针走，到达 $B$ 的较短路程。告诉你相邻两个奶牛间的距离，请你求出两只最远的奶牛到底隔了多远。\n", "inputFormat": "第一行一个整数 $N$，表示有 $N$ 只奶牛，$2\\le N\\le 10^5$。\n\n接下 $2\\sim N+1$ 行，第 $i$ 行有一个数，表示第 $i-1$ 头奶牛顺时针到第 $i$ 头奶牛的距离 $d_i$，$1\\le d_i\\le 2^{31}-1$，所有距离之和 $\\le 2^{31}-1$。\n\n第 $N+1$ 行的数表示第 $N$ 头奶牛顺时针到第 $1$ 头奶牛的距离。\n", "outputFormat": "一行，表示最大距离。\n", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "Circular Dance", "background": "", "description": "Grandma Xiong’s cows have formed a circle in clockwise order. Because they lack strict training, the gaps between adjacent cows are unequal.\n\nThe cows want to know how far apart the farthest pair of cows are. The distance from cow $A$ to cow $B$ is defined as the shorter of the clockwise path and the counterclockwise path from $A$ to $B$. Given the distances between adjacent cows, please compute the maximum distance between any two cows.", "inputFormat": "The first line contains an integer $N$, the number of cows, $2\\le N\\le 10^5$.\n\nThe next $N$ lines each contain one integer. For $i=2,\\ldots,N$, line $i$ contains $d_i$, the clockwise distance from cow $i-1$ to cow $i$, where $1\\le d_i\\le 2^{31}-1$, and the sum of all distances is $\\le 2^{31}-1$.\n\nLine $N+1$ contains the clockwise distance from cow $N$ to cow $1$.", "outputFormat": "Output one line containing the maximum distance.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "圆圆舞蹈", "background": "", "description": "熊大妈的奶牛在时针的带领下，围成了一个圆圈，由于没有严格的教育，奶牛们之间的间隔不一致。\n\n奶牛想知道两只最远的奶牛到底隔了多远。奶牛 $A$ 到 $B$ 的距离为 $A$ 顺时针走和逆时针走，到达 $B$ 的较短路程。告诉你相邻两个奶牛间的距离，请你求出两只最远的奶牛到底隔了多远。\n", "inputFormat": "第一行一个整数 $N$，表示有 $N$ 只奶牛，$2\\le N\\le 10^5$。\n\n接下 $2\\sim N+1$ 行，第 $i$ 行有一个数，表示第 $i-1$ 头奶牛顺时针到第 $i$ 头奶牛的距离 $d_i$，$1\\le d_i\\le 2^{31}-1$，所有距离之和 $\\le 2^{31}-1$。\n\n第 $N+1$ 行的数表示第 $N$ 头奶牛顺时针到第 $1$ 头奶牛的距离。\n", "outputFormat": "一行，表示最大距离。\n", "hint": "", "locale": "zh-CN"}}}
{"pid": "P2382", "type": "P", "difficulty": 5, "samples": [["H 1\nHe 4\nC 12\nO 16\nF 19\nNe 20\nCu 64\nCc 333\nEND_OF_FIRST_PART\nH2C\n(MgF)2As\nCu(OH)2\nH((CO)2F)99\n0\n", "14\nUNKNOWN\n98\n7426\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学"], "title": "化学分子式", "background": "元首和元老正在共同努力学习化学，他们想让电脑帮助他模拟分子式减轻负担。请你帮他设计一个程序。\n", "description": "你的任务是编写一个能处理在虚拟的化学里分子式的程序，在真正的化学里，每个分子式描述分子包括一个或者多个原子，但是，它可能没有真正的化学药品。\n\n下面是原子符号和分子式的定义：\n\n分子中一个原子由一个原子符号表示，原子符号由单个大写字母或者一个大写字母和一个小写字母组成。例如：H和He都是原子符号。\n\n一个分子式是一个原子符号的非空序列，例如，HHHeHHHe是一个分子式，表示一个分子包括4个H和2个He。\n\n为了方便起见，一段相同的式子，如x….x(n个X，2<=n<=99)，可以被缩写为（X）n。如果X是一个原子符号，那么括号可以省略。例如，HHHeHHHe也可以写作H2HeH2He,(HHHe)2,(H2He)2,((H)2He)2。\n\n分子式的定义可以用一种规范的语言描述。简而言之，分子式的语法描述如下：\n\n分子：原子|原子数量|（分子）数字|分子 分子  \n原子：大写字母|大写字母 小写字母  \n\n数字：2|3|4|5|……|99|  \n大写字母：A|B|……|Z|  \n小写字母：a|b|c|……|z|  \n\n在我们这个虚拟的化学里的每一个原子都有自己的原子质量，给你原子的质量，你的程序必须输出一个用分子式表示的分子质量。分子的质量定义为所有包括的原子的质量之和。例如，假设H和He的原子质量为1和4，那么（H2He）2的分子量为12。\n", "inputFormat": "输入格式：\n\n输入由两部分组成。第一部分是原子表，由一些行组成，每行包括一个原子符号、一个或者多个空格，以及该原子的原子质量（<=1000）。没有两行包含相同的原子符号。\n\n第一部分最后仅包括一行字符串“END\\_OF\\_FIRST\\_PART”。\n\n第二部分是一些行的序列。每行是一个分子式，不多于80个字符，而且不包括空格。一个分子最多包括10^5个原子，一些分子中的原子可能没有在原子表中出现。\n\n最后一行仅一个零，表示输入结束。\n", "outputFormat": "输出格式：\n\n输出时一些行的序列，和输入文件的第二部分行数相同。如果分子中的每一个原子都在原子表中出现，输出一个整数，并表示分子质量。否者输出UNKNOWN。不要输出多余的字符。\n", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "Molecular Formula", "background": "Yuanshou (Yuánshǒu) and Yuanlao (Yuánlǎo) are working hard to learn chemistry, and they want the computer to help them simulate molecular formulas to reduce their workload. Please help them by designing a program.", "description": "Your task is to write a program that can process molecular formulas in a virtual chemistry setting. In real chemistry, each molecular formula describes a molecule consisting of one or more atoms, but it may not correspond to a real chemical substance.\n\nBelow are the definitions of atomic symbols and molecular formulas:\n\n- An atom in a molecule is represented by an atomic symbol. An atomic symbol consists of a single uppercase letter, or an uppercase letter followed by a lowercase letter. For example: H and He are both atomic symbols.\n\n- A molecular formula is a non-empty sequence of atomic symbols. For example, HHHeHHHe is a molecular formula that represents a molecule containing 4 H and 2 He.\n\n- For convenience, a consecutive repetition of the same expression, such as x...x (that is, $n$ copies of $X$, where $2 \\le n \\le 99$), can be abbreviated as (X)$n$. If $X$ is a single atomic symbol, the parentheses can be omitted. For example, HHHeHHHe can also be written as H2HeH2He, (HHHe)2, (H2He)2, or ((H)2He)2.\n\nThe definition of a molecular formula can be described using a formal grammar. In short, the syntax is as follows:\n\nMolecule: Atom | Atom Number | (Molecule) Number | Molecule Molecule\nAtom: Uppercase | Uppercase Lowercase\nNumber: 2 | 3 | 4 | 5 | … | 99\nUppercase: A | B | … | Z\nLowercase: a | b | c | … | z\n\nIn this virtual chemistry world, every atom has its atomic mass. Given the atomic masses, your program must output the molecular mass of a molecule represented by its formula. The mass of a molecule is defined as the sum of the masses of all atoms it contains. For example, if the atomic masses of H and He are 1 and 4, then the molecular mass of (H2He)2 is 12.", "inputFormat": "The input consists of two parts.\n\nThe first part is an atom table, consisting of several lines. Each line contains an atomic symbol, one or more spaces, and the atomic mass of that atom ($\\le 1000$). No two lines contain the same atomic symbol.\n\nThe last line of the first part contains only the string \"END_OF_FIRST_PART\".\n\nThe second part is a sequence of lines. Each line is a molecular formula, with no more than 80 characters and no spaces. A molecule contains at most $10^5$ atoms. Some molecules may contain atoms that do not appear in the atom table.\n\nThe last line contains a single zero, indicating the end of input.", "outputFormat": "Output a sequence of lines, with the same number of lines as the second part of the input. If every atom in the molecule appears in the atom table, output an integer representing the molecular mass. Otherwise, output UNKNOWN. Do not output extra characters.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "化学分子式", "background": "元首和元老正在共同努力学习化学，他们想让电脑帮助他模拟分子式减轻负担。请你帮他设计一个程序。\n", "description": "你的任务是编写一个能处理在虚拟的化学里分子式的程序，在真正的化学里，每个分子式描述分子包括一个或者多个原子，但是，它可能没有真正的化学药品。\n\n下面是原子符号和分子式的定义：\n\n分子中一个原子由一个原子符号表示，原子符号由单个大写字母或者一个大写字母和一个小写字母组成。例如：H和He都是原子符号。\n\n一个分子式是一个原子符号的非空序列，例如，HHHeHHHe是一个分子式，表示一个分子包括4个H和2个He。\n\n为了方便起见，一段相同的式子，如x….x(n个X，2<=n<=99)，可以被缩写为（X）n。如果X是一个原子符号，那么括号可以省略。例如，HHHeHHHe也可以写作H2HeH2He,(HHHe)2,(H2He)2,((H)2He)2。\n\n分子式的定义可以用一种规范的语言描述。简而言之，分子式的语法描述如下：\n\n分子：原子|原子数量|（分子）数字|分子 分子  \n原子：大写字母|大写字母 小写字母  \n\n数字：2|3|4|5|……|99|  \n大写字母：A|B|……|Z|  \n小写字母：a|b|c|……|z|  \n\n在我们这个虚拟的化学里的每一个原子都有自己的原子质量，给你原子的质量，你的程序必须输出一个用分子式表示的分子质量。分子的质量定义为所有包括的原子的质量之和。例如，假设H和He的原子质量为1和4，那么（H2He）2的分子量为12。\n", "inputFormat": "输入格式：\n\n输入由两部分组成。第一部分是原子表，由一些行组成，每行包括一个原子符号、一个或者多个空格，以及该原子的原子质量（<=1000）。没有两行包含相同的原子符号。\n\n第一部分最后仅包括一行字符串“END\\_OF\\_FIRST\\_PART”。\n\n第二部分是一些行的序列。每行是一个分子式，不多于80个字符，而且不包括空格。一个分子最多包括10^5个原子，一些分子中的原子可能没有在原子表中出现。\n\n最后一行仅一个零，表示输入结束。\n", "outputFormat": "输出格式：\n\n输出时一些行的序列，和输入文件的第二部分行数相同。如果分子中的每一个原子都在原子表中出现，输出一个整数，并表示分子质量。否者输出UNKNOWN。不要输出多余的字符。\n", "hint": "", "locale": "zh-CN"}}}
{"pid": "P2383", "type": "P", "difficulty": 3, "samples": [["3\n4 1 1 1 1 \n5 10 20 30 40 50 \n8 1 7 2 6 4 4 3 5", "yes\nno\nyes"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["搜索", "剪枝"], "title": "狗哥玩木棒", "background": "狗哥又趁着语文课干些无聊的事了...\n", "description": "现给出一些木棒长度，那么狗哥能否用给出的木棒(木棒全用完)组成一个正方形呢？\n", "inputFormat": "输入文件中的第一行是一个整数 $n(1\\le n\\le 10)$ 表示测试的组数，接下来 $n$ 行表示每组的测试数据。 每行的第一个数为 $m(4\\leq m\\leq 20)$,接下来 $m$ 个数 $a_i(1\\leq a_i\\le 2000)$ 表示木棒的长度。\n", "outputFormat": "对于每组测试数据，如果可以组成正方形输出“yes”，否则输出“no”。\n", "hint": "狗哥快抓狂了\n", "locale": "zh-CN", "translations": {"en": {"title": "Gou-ge Plays with Sticks", "background": "Gou-ge is once again doing something boring during Chinese class...", "description": "Given some stick lengths, can Gou-ge use all the given sticks (all sticks must be used) to form a square?", "inputFormat": "The first line of the input file is an integer $n(1\\le n\\le 10)$ indicating the number of test groups. The following $n$ lines describe each group's testdata. In each line, the first number is $m(4\\leq m\\leq 20)$, followed by $m$ numbers $a_i(1\\leq a_i\\le 2000)$ representing the lengths of the sticks.", "outputFormat": "For each group's testdata, output \"yes\" if it is possible to form a square, otherwise output \"no\".", "hint": "Gou-ge is about to go crazy.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "狗哥玩木棒", "background": "狗哥又趁着语文课干些无聊的事了...\n", "description": "现给出一些木棒长度，那么狗哥能否用给出的木棒(木棒全用完)组成一个正方形呢？\n", "inputFormat": "输入文件中的第一行是一个整数 $n(1\\le n\\le 10)$ 表示测试的组数，接下来 $n$ 行表示每组的测试数据。 每行的第一个数为 $m(4\\leq m\\leq 20)$,接下来 $m$ 个数 $a_i(1\\leq a_i\\le 2000)$ 表示木棒的长度。\n", "outputFormat": "对于每组测试数据，如果可以组成正方形输出“yes”，否则输出“no”。\n", "hint": "狗哥快抓狂了\n", "locale": "zh-CN"}}}
{"pid": "P2385", "type": "P", "difficulty": 3, "samples": [["4 5 1 2\n1 0 1 0 1\n3 0 2 0 4\n0 1 2 0 0\n0 0 0 1 0", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2007", "USACO"], "title": "[USACO07FEB] Bronze Lilypad Pond B", "background": "", "description": "为了让奶牛们娱乐和锻炼，农夫约翰建造了一个美丽的池塘。这个长方形的池子被分成了 M 行 N 列个方格（1 ≤ M, N ≤ 30） 。一些格子是坚固得令人惊讶的莲花，还有一些格子是岩石，其余的只是美丽、纯净、湛蓝的水。\n\n贝西正在练习芭蕾舞，她站在一朵莲花上，想跳到另一朵莲花上去，她只能从一朵莲花跳到另一朵莲花上，既不能跳到水里，也不能跳到岩石上。\n\n贝西的舞步很像象棋中的马步：每次总是先横向移动 M1 (1 ≤ M1 ≤ 30)格，再纵向移动 M2 (1 ≤ M2 ≤ 30, M1≠M2)格，或先纵向移动 M1 格，再横向移动 M2 格。最多时，贝西会有八个移动方向可供选择。\n\n给定池塘的布局和贝西的跳跃长度，请计算贝西从起点出发，到达目的地的最小步数，我们保证输入数据中的目的地一定是可达的。\n", "inputFormat": "第一行：四个用空格分开的整数：M，N，M1 和 M2\n\n第二行到 M + 1 行：第 i + 1 行有 N 个用空格分开的整数，描述了池塘第\n\ni 行的状态：0 为水，1 为莲花，2 为岩石，3 为贝西所在的起点，4 为贝西想去\n\n的终点。\n", "outputFormat": "第一行：从起点到终点的最少步数。\n", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[USACO07FEB] Bronze Lilypad Pond B", "background": "", "description": "To entertain and exercise the cows, Farmer John built a beautiful pond. This rectangular pond is divided into $M$ rows and $N$ columns ($1 \\le M, N \\le 30$). Some cells are surprisingly sturdy lilypads, some are rocks, and the rest are beautiful, pure, deep-blue water.\n\nBessie is practicing ballet. She stands on a lilypad and wants to jump to another lilypad. She can only jump from a lilypad to another lilypad; she cannot jump onto water or rocks.\n\nBessie’s steps are like a knight’s moves in chess: each time she either moves horizontally $M_1$ squares ($1 \\le M_1 \\le 30$) and then vertically $M_2$ squares ($1 \\le M_2 \\le 30$, $M_1 \\ne M_2$), or vertically $M_1$ squares and then horizontally $M_2$ squares. At most, Bessie has eight possible movement directions.\n\nGiven the pond layout and Bessie’s jump lengths, compute the minimum number of jumps needed for Bessie to go from the start to the destination. It is guaranteed that the destination in the input is reachable.", "inputFormat": "The first line contains four space-separated integers: $M$, $N$, $M_1$, and $M_2$.\n\nThe second line through line $M+1$: for each $i$ from $1$ to $M$, line $i+1$ contains $N$ space-separated integers describing row $i$ of the pond: $0$ for water, $1$ for lilypad, $2$ for rock, $3$ for Bessie’s starting cell, and $4$ for Bessie’s destination.", "outputFormat": "The first line contains the minimum number of moves from the start to the destination.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO07FEB] Bronze Lilypad Pond B", "background": "", "description": "为了让奶牛们娱乐和锻炼，农夫约翰建造了一个美丽的池塘。这个长方形的池子被分成了 M 行 N 列个方格（1 ≤ M, N ≤ 30） 。一些格子是坚固得令人惊讶的莲花，还有一些格子是岩石，其余的只是美丽、纯净、湛蓝的水。\n\n贝西正在练习芭蕾舞，她站在一朵莲花上，想跳到另一朵莲花上去，她只能从一朵莲花跳到另一朵莲花上，既不能跳到水里，也不能跳到岩石上。\n\n贝西的舞步很像象棋中的马步：每次总是先横向移动 M1 (1 ≤ M1 ≤ 30)格，再纵向移动 M2 (1 ≤ M2 ≤ 30, M1≠M2)格，或先纵向移动 M1 格，再横向移动 M2 格。最多时，贝西会有八个移动方向可供选择。\n\n给定池塘的布局和贝西的跳跃长度，请计算贝西从起点出发，到达目的地的最小步数，我们保证输入数据中的目的地一定是可达的。\n", "inputFormat": "第一行：四个用空格分开的整数：M，N，M1 和 M2\n\n第二行到 M + 1 行：第 i + 1 行有 N 个用空格分开的整数，描述了池塘第\n\ni 行的状态：0 为水，1 为莲花，2 为岩石，3 为贝西所在的起点，4 为贝西想去\n\n的终点。\n", "outputFormat": "第一行：从起点到终点的最少步数。\n", "hint": "", "locale": "zh-CN"}}}
{"pid": "P2386", "type": "P", "difficulty": 2, "samples": [["1\n7 3", "8"], ["3\n3 2\n4 3\n2 7\n", "2\n4\n2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "递归"], "title": "放苹果", "background": "", "description": "把 $m$ 个同样的苹果放在 $n$ 个同样的盘子里，允许有的盘子空着不放，问共有多少种不同的分法。（$5,1,1$ 和 $1,1,5$ 是同一种方法）\n", "inputFormat": "第一行是测试数据的数目 $t$，以下每行均包括二个整数 $m$ 和 $n$，以空格分开。", "outputFormat": "对输入的每组数据 $m$ 和 $n$，用一行输出相应的结果。\n", "hint": "对于所有数据，保证：$1\\leq m,n\\leq 10$，$0 \\leq t \\leq 20$。", "locale": "zh-CN", "translations": {"en": {"title": "Placing Apples", "background": "", "description": "Place $m$ identical apples into $n$ identical plates. Empty plates are allowed. How many different distributions are there? ($5,1,1$ and $1,1,5$ are considered the same way.)", "inputFormat": "The first line contains the number of testdata $t$. Each of the following lines contains two integers $m$ and $n$, separated by a space.", "outputFormat": "For each pair $m$ and $n$ in the input, output the corresponding result on a single line.", "hint": "For all testdata, it is guaranteed that $1 \\leq m, n \\leq 10$, $0 \\leq t \\leq 20$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "放苹果", "background": "", "description": "把 $m$ 个同样的苹果放在 $n$ 个同样的盘子里，允许有的盘子空着不放，问共有多少种不同的分法。（$5,1,1$ 和 $1,1,5$ 是同一种方法）\n", "inputFormat": "第一行是测试数据的数目 $t$，以下每行均包括二个整数 $m$ 和 $n$，以空格分开。", "outputFormat": "对输入的每组数据 $m$ 和 $n$，用一行输出相应的结果。\n", "hint": "对于所有数据，保证：$1\\leq m,n\\leq 10$，$0 \\leq t \\leq 20$。", "locale": "zh-CN"}}}
{"pid": "P2387", "type": "P", "difficulty": 6, "samples": [["4 5 \n1 2 19 1 \n2 3 8 12 \n2 4 12 15 \n1 3 17 8 \n3 4 1 17 ", "32\n"], ["3 1 \n1 2 1 1 ", "-1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "NOI", "生成树", "动态树 LCT"], "title": "[NOI2014] 魔法森林", "background": "[hack数据的提交link](https://www.luogu.com.cn/problem/U163126)", "description": "为了得到书法大家的真传，小 E 同学下定决心去拜访住在魔法森林中的隐士。魔法森林可以被看成一个包含 $n$ 个节点 $m$ 条边的无向图，节点标号为 $1,2,3,…,n$，边标号为 $1,2,3,…,m$。初始时小 E 同学在 $1$ 号节点，隐士则住在 $n$ 号节点。小 E 需要通过这一片魔法森林，才能够拜访到隐士。\n\n魔法森林中居住了一些妖怪。每当有人经过一条边的时候，这条边上的妖怪 就会对其发起攻击。幸运的是，在 $1$ 号节点住着两种守护精灵：A 型守护精灵与 B 型守护精灵。小 E 可以借助它们的力量，达到自己的目的。\n\n只要小 E 带上足够多的守护精灵，妖怪们就不会发起攻击了。具体来说，无向图中的每一条边 $e_i$ 包含两个权值 $a_i$ 与 $b_i$ 。若身上携带的 A 型守护精灵个数不少于 $a_i$ ，且 B 型守护精灵个数不少于 $b_i$ ，这条边上的妖怪就不会对通过这条边的人发起攻击。当且仅当通过这片魔法森林的过程中没有任意一条边的妖怪向 小 E 发起攻击，他才能成功找到隐士。\n\n由于携带守护精灵是一件非常麻烦的事，小 E 想要知道，要能够成功拜访到 隐士，最少需要携带守护精灵的总个数。守护精灵的总个数为 A 型守护精灵的个数与 B 型守护精灵的个数之和。\n", "inputFormat": "输入文件的第 $1$ 行包含两个整数 $n,m$，表示无向图共有 $n$ 个节点，$m$ 条边。 接下来 $m$ 行，第 $i+1$ 行包含 $4$ 个正整数 $X_i,Y_i,a_i,b_i$，描述第 $i$ 条无向边。 其中 $X_i$ 与 $Y_i$ 为该边两个端点的标号，$a_i$ 与 $b_i$ 的含义如题所述。 注意数据中可能包含重边与自环。\n", "outputFormat": "输出一行一个整数：如果小 E 可以成功拜访到隐士，输出小 E 最少需要携 带的守护精灵的总个数；如果无论如何小 E 都无法拜访到隐士，输出 `-1`。\n", "hint": "\\* 解释1\n\n如果小 E 走路径 $1\\to 2\\to 4$，需要携带 $19+15=34$ 个守护精灵； 如果小 E 走路径 $1\\to 3\\to 4$，需要携带 $17+17=34$ 个守护精灵； 如果小 E 走路径 $1\\to 2\\to 3\\to 4$，需要携带 $19+17=36$ 个守护精灵； 如果小 E 走路径  $1\\to 3\\to 2\\to 4$，需要携带 $17+15=32$ 个守护精灵。 综上所述，小 E 最少需要携带 $32$ 个守护精灵。\n\n\\* 解释2\n\n小 E 无法从 $1$ 号节点到达 $3$ 号节点，故输出 `-1`。\n\n![](https://cdn.luogu.com.cn/upload/pic/2593.png)\n", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2014] Magic Forest", "background": "[hack testdata submission link](https://www.luogu.com.cn/problem/U163126).", "description": "To receive the true teachings of a calligraphy master, Xiao E has decided to visit a hermit who lives in the Magic Forest. The Magic Forest can be regarded as an undirected graph with $n$ nodes and $m$ edges. The nodes are labeled $1, 2, 3, \\dots, n$, and the edges are labeled $1, 2, 3, \\dots, m$. Initially, Xiao E is at node $1$, and the hermit lives at node $n$. Xiao E needs to pass through this Magic Forest to visit the hermit.\n\nThere are some monsters living in the Magic Forest. Whenever someone passes an edge, the monsters on that edge will launch an attack. Fortunately, two kinds of guardian spirits live at node $1$: A-type guardian spirits and B-type guardian spirits. Xiao E can rely on their power to achieve his goal.\n\nAs long as Xiao E brings enough guardian spirits, the monsters will not attack. Specifically, each edge $e_i$ in the undirected graph has two weights $a_i$ and $b_i$. If the number of A-type guardian spirits carried is at least $a_i$, and the number of B-type guardian spirits carried is at least $b_i$, then the monsters on this edge will not attack people who pass through this edge. Xiao E can successfully find the hermit if and only if, during the traversal of the Magic Forest, the monsters on no edge launch an attack on him.\n\nSince carrying guardian spirits is very troublesome, Xiao E wants to know the minimum total number of guardian spirits required to successfully visit the hermit. The total number of guardian spirits is the sum of the number of A-type guardian spirits and B-type guardian spirits.", "inputFormat": "The first line of the input file contains two integers $n, m$, indicating that the undirected graph has $n$ nodes and $m$ edges. The next $m$ lines, where the $(i+1)$-th line contains $4$ positive integers $X_i, Y_i, a_i, b_i$, describe the $i$-th undirected edge. Here, $X_i$ and $Y_i$ are the labels of the two endpoints of the edge, and $a_i$ and $b_i$ have the meanings described above. Note that the testdata may contain multiple edges and self-loops.", "outputFormat": "Output one line with one integer: if Xiao E can successfully visit the hermit, output the minimum total number of guardian spirits Xiao E needs to carry; if Xiao E cannot visit the hermit under any circumstances, output `-1`.", "hint": "* Explanation 1\n\nIf Xiao E takes the path $1\\to 2\\to 4$, he needs to carry $19+15=34$ guardian spirits; if Xiao E takes the path $1\\to 3\\to 4$, he needs to carry $17+17=34$ guardian spirits; if Xiao E takes the path $1\\to 2\\to 3\\to 4$, he needs to carry $19+17=36$ guardian spirits; if Xiao E takes the path $1\\to 3\\to 2\\to 4$, he needs to carry $17+15=32$ guardian spirits. In summary, Xiao E needs to carry at least $32$ guardian spirits.\n\n* Explanation 2\n\nXiao E cannot reach node $3$ from node $1$, so output `-1`.\n\n![](https://cdn.luogu.com.cn/upload/pic/2593.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2014] 魔法森林", "background": "[hack数据的提交link](https://www.luogu.com.cn/problem/U163126)", "description": "为了得到书法大家的真传，小 E 同学下定决心去拜访住在魔法森林中的隐士。魔法森林可以被看成一个包含 $n$ 个节点 $m$ 条边的无向图，节点标号为 $1,2,3,…,n$，边标号为 $1,2,3,…,m$。初始时小 E 同学在 $1$ 号节点，隐士则住在 $n$ 号节点。小 E 需要通过这一片魔法森林，才能够拜访到隐士。\n\n魔法森林中居住了一些妖怪。每当有人经过一条边的时候，这条边上的妖怪 就会对其发起攻击。幸运的是，在 $1$ 号节点住着两种守护精灵：A 型守护精灵与 B 型守护精灵。小 E 可以借助它们的力量，达到自己的目的。\n\n只要小 E 带上足够多的守护精灵，妖怪们就不会发起攻击了。具体来说，无向图中的每一条边 $e_i$ 包含两个权值 $a_i$ 与 $b_i$ 。若身上携带的 A 型守护精灵个数不少于 $a_i$ ，且 B 型守护精灵个数不少于 $b_i$ ，这条边上的妖怪就不会对通过这条边的人发起攻击。当且仅当通过这片魔法森林的过程中没有任意一条边的妖怪向 小 E 发起攻击，他才能成功找到隐士。\n\n由于携带守护精灵是一件非常麻烦的事，小 E 想要知道，要能够成功拜访到 隐士，最少需要携带守护精灵的总个数。守护精灵的总个数为 A 型守护精灵的个数与 B 型守护精灵的个数之和。\n", "inputFormat": "输入文件的第 $1$ 行包含两个整数 $n,m$，表示无向图共有 $n$ 个节点，$m$ 条边。 接下来 $m$ 行，第 $i+1$ 行包含 $4$ 个正整数 $X_i,Y_i,a_i,b_i$，描述第 $i$ 条无向边。 其中 $X_i$ 与 $Y_i$ 为该边两个端点的标号，$a_i$ 与 $b_i$ 的含义如题所述。 注意数据中可能包含重边与自环。\n", "outputFormat": "输出一行一个整数：如果小 E 可以成功拜访到隐士，输出小 E 最少需要携 带的守护精灵的总个数；如果无论如何小 E 都无法拜访到隐士，输出 `-1`。\n", "hint": "\\* 解释1\n\n如果小 E 走路径 $1\\to 2\\to 4$，需要携带 $19+15=34$ 个守护精灵； 如果小 E 走路径 $1\\to 3\\to 4$，需要携带 $17+17=34$ 个守护精灵； 如果小 E 走路径 $1\\to 2\\to 3\\to 4$，需要携带 $19+17=36$ 个守护精灵； 如果小 E 走路径  $1\\to 3\\to 2\\to 4$，需要携带 $17+15=32$ 个守护精灵。 综上所述，小 E 最少需要携带 $32$ 个守护精灵。\n\n\\* 解释2\n\n小 E 无法从 $1$ 号节点到达 $3$ 号节点，故输出 `-1`。\n\n![](https://cdn.luogu.com.cn/upload/pic/2593.png)\n", "locale": "zh-CN"}}}
{"pid": "P2388", "type": "P", "difficulty": 3, "samples": [["10", "7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "洛谷原创"], "title": "阶乘之乘", "background": "不告诉你……\n", "description": "求出 $1!\\times 2!\\times 3!\\times 4!\\times \\cdots \\times n!$ 的末尾有几个零。\n", "inputFormat": "一行，一个整数 $n(n\\le 10^8)$。", "outputFormat": "输出答案，表示零的个数。\n", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "Product of Factorials", "background": "Not telling you...", "description": "Find the number of trailing zeros in $1!\\times 2!\\times 3!\\times 4!\\times \\cdots \\times n!$.", "inputFormat": "One line, a single integer $n(n\\le 10^8)$.", "outputFormat": "Output the answer, the number of trailing zeros.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "阶乘之乘", "background": "不告诉你……\n", "description": "求出 $1!\\times 2!\\times 3!\\times 4!\\times \\cdots \\times n!$ 的末尾有几个零。\n", "inputFormat": "一行，一个整数 $n(n\\le 10^8)$。", "outputFormat": "输出答案，表示零的个数。\n", "hint": "", "locale": "zh-CN"}}}
{"pid": "P2389", "type": "P", "difficulty": 3, "samples": [["5 3\n1 -1 1 -1 1", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "洛谷原创", "前缀和"], "title": "电脑班的裁员", "background": "隔壁的新初一电脑班刚考过一场试，又到了 BlingBling 的裁员时间，老师把这项工作交给了 ZZY 来进行。而 ZZY 最近忙着刷题，就把这重要的任务交（tui）给了你。", "description": "ZZY 有独特的裁员技巧：每个同学都有一个考试得分 $a_i$（$-1000\\le a_i\\le 1000$），在 $n$ 个同学（$n\\le 500$）中选出不大于 $k$ 段（$k\\le n$）相邻的同学留下，裁掉未被选中的同学，使剩下同学的得分和最大。要特别注意的是，这次考试答错要扣分【不要问我为什么】，所以得分有可能为负。", "inputFormat": "第一行为 $n, k$，第二行为第 $1$ 到 $n$ 位同学的得分。", "outputFormat": "一个数 $s$，为最大得分和。", "hint": "2014 彭鲲志：“题目这么短一看就很水。”", "locale": "zh-CN", "translations": {"en": {"title": "Downsizing in the Computer Class", "background": "The neighboring new Grade 7 computer class just finished an exam, and it is BlingBling’s downsizing time again. The teacher assigned this task to ZZY, but since ZZY is busy solving problems, he passed this important task onto you.", "description": "ZZY has a unique downsizing method: each student has an exam score $a_i$ ($-1000 \\le a_i \\le 1000$). Among $n$ students ($n \\le 500$), choose no more than $k$ ($k \\le n$) contiguous segments of students to keep, and dismiss the unselected students, so that the sum of the remaining students’ scores is maximized. Note that wrong answers deduct points [don’t ask me why], so scores may be negative.", "inputFormat": "The first line contains $n, k$. The second line contains the scores of students $1$ to $n$.", "outputFormat": "A single number $s$, the maximum sum of scores.", "hint": "2014 Peng Kunzhi: \"The statement is so short — looks trivial at first glance.\"\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "电脑班的裁员", "background": "隔壁的新初一电脑班刚考过一场试，又到了 BlingBling 的裁员时间，老师把这项工作交给了 ZZY 来进行。而 ZZY 最近忙着刷题，就把这重要的任务交（tui）给了你。", "description": "ZZY 有独特的裁员技巧：每个同学都有一个考试得分 $a_i$（$-1000\\le a_i\\le 1000$），在 $n$ 个同学（$n\\le 500$）中选出不大于 $k$ 段（$k\\le n$）相邻的同学留下，裁掉未被选中的同学，使剩下同学的得分和最大。要特别注意的是，这次考试答错要扣分【不要问我为什么】，所以得分有可能为负。", "inputFormat": "第一行为 $n, k$，第二行为第 $1$ 到 $n$ 位同学的得分。", "outputFormat": "一个数 $s$，为最大得分和。", "hint": "2014 彭鲲志：“题目这么短一看就很水。”", "locale": "zh-CN"}}}
{"pid": "P2390", "type": "P", "difficulty": 3, "samples": [["25 14\n16\n8\n-7\n3\n10\n-15\n-17\n6\n-12\n14\n-13\n2\n9\n-5\n", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "贪心", "二分", "洛谷原创"], "title": "地标访问", "background": "改编自 USACO2007Nov 铜组 Exploration\n", "description": "贝西在一条道路上旅行，道路上有许多地标，贝西想要在日落之前访问尽可能多的路标。贝西每分钟可以移动一单位距离。\n\n将道路视为一条数轴，贝西从原点出发，道路上有 $n(1 \\le n \\le 5\\times 10^4)$ 个地标，每个地标有一个坐标 $x_i(|x_i| \\le 10^5)$ 且地标的坐标各不相同，$t(1 \\le t \\le 10^9)$ 分钟之后将会日落。", "inputFormat": "第一行：两个整数 $t,n$。\n\n第二行至第 $n+1$ 行：地标的坐标 $x_i$。", "outputFormat": "一个整数，贝西能访问的最多的地标数\n", "hint": "1、贝西日落时不用回到原点。\n\n2、与原模拟水题不同。\n\n3、数据较原题有所修改\n", "locale": "zh-CN", "translations": {"en": {"title": "Visiting Landmarks", "background": "Adapted from USACO 2007 November Bronze \"Exploration\".", "description": "Bessie is traveling along a road with many landmarks and wants to visit as many landmarks as possible before sunset. Bessie can move one unit of distance per minute.\n\nTreat the road as a number line. Bessie starts at the origin. There are $n(1 \\le n \\le 5\\times 10^4)$ landmarks on the road, each with a distinct coordinate $x_i(|x_i| \\le 10^5)$. Sunset occurs after $t(1 \\le t \\le 10^9)$ minutes.", "inputFormat": "The first line: two integers $t,n$.\n\nThe second line to line $n+1$: the coordinates $x_i$.", "outputFormat": "A single integer: the maximum number of landmarks Bessie can visit.", "hint": "1. Bessie does not need to return to the origin at sunset.\n2. This differs from the original simple simulation problem.\n3. The testdata has been modified compared to the original problem.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "地标访问", "background": "改编自 USACO2007Nov 铜组 Exploration\n", "description": "贝西在一条道路上旅行，道路上有许多地标，贝西想要在日落之前访问尽可能多的路标。贝西每分钟可以移动一单位距离。\n\n将道路视为一条数轴，贝西从原点出发，道路上有 $n(1 \\le n \\le 5\\times 10^4)$ 个地标，每个地标有一个坐标 $x_i(|x_i| \\le 10^5)$ 且地标的坐标各不相同，$t(1 \\le t \\le 10^9)$ 分钟之后将会日落。", "inputFormat": "第一行：两个整数 $t,n$。\n\n第二行至第 $n+1$ 行：地标的坐标 $x_i$。", "outputFormat": "一个整数，贝西能访问的最多的地标数\n", "hint": "1、贝西日落时不用回到原点。\n\n2、与原模拟水题不同。\n\n3、数据较原题有所修改\n", "locale": "zh-CN"}}}
{"pid": "P2391", "type": "P", "difficulty": 5, "samples": [["4\n3\n2\n4", "2\n2\n3\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["模拟", "线段树", "并查集", "福建省历届夏令营"], "title": "白雪皑皑", "background": "“柴门闻犬吠，风雪夜归人”，冬天，不期而至。千里冰封，万里雪飘。空中刮起了鸭毛大雪。雪花纷纷，降落人间。 美能量星球（pty 在 spore 上的一个殖民地）上的人们被这美景所震撼。但是 pty 却不高兴，他不喜欢白色的世界，他觉得这样太单调了。所以他想对雪花进行染色，让世界变得多彩些。\n", "description": "现在有 $n$ 片雪花排成一列。 pty 要对雪花进行 $m$ 次染色操作，第 $i$ 次染色操作中，把第 $((i\\times p+q)\\bmod n)+1$ 片雪花和第 $((i\\times q+p)\\bmod n)+1$ 片雪花之间的雪花（包括端点）染成颜色 $i$。其中 $p,q$ 是给定的两个正整数。他想知道最后 $n$ 片雪花被染成了什么颜色。没有被染色输出 $0$。", "inputFormat": "输入共四行，每行一个整数，分别为 $n,m,p,q$，意义如题中所述。", "outputFormat": "输出共 $n$ 行，每行一个整数，第 $i$ 行表示第 $i$ 片雪花的颜色。", "hint": "- 对于 $20\\%$ 的数据满足：$n,m\\leq 1000$。\n- 对于 $40\\%$ 的数据满足：$n\\leq 8000$，$m\\leq 10^6$。\n- 对于 $80\\%$ 的数据满足：$n\\leq 5\\times 10^5$，$m\\leq 10^7$。\n- 对于 $100\\%$ 的数据满足：$1\\leq n\\leq 10^6$，$1\\leq m\\leq 10^7$。\n\n保证 $1\\leq m\\times p+q,m\\times q+p\\leq 2\\times 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "Snow-Covered", "background": "\"By the brushwood gate, a dog barks; through wind and snow, a traveler returns at night.\" Winter arrives unexpectedly. A thousand miles are frozen, and ten thousand miles are swept by snow. Feathery snow whirls in the air, and snowflakes drift down to the world. The people on the Planet of Positive Energy (a colony of pty on spore) are awed by this beauty. However, pty is not pleased; he dislikes a world of white and finds it too monotonous. So he wants to dye the snowflakes to make the world more colorful.", "description": "There are $n$ snowflakes arranged in a line. pty will perform $m$ coloring operations. In the $i$-th coloring operation, he colors all snowflakes between the $((i\\times p+q)\\bmod n)+1$-th snowflake and the $((i\\times q+p)\\bmod n)+1$-th snowflake (inclusive) with color $i$. Here $p, q$ are two given positive integers. He wants to know the final color of each of the $n$ snowflakes. Output $0$ for any snowflake that is never colored.", "inputFormat": "The input consists of four lines, each containing one integer, namely $n, m, p, q$, as described above.", "outputFormat": "Output $n$ lines. The $i$-th line contains one integer, the color of the $i$-th snowflake.", "hint": "- For $20\\%$ of the testdata: $n,m\\leq 1000$.\n- For $40\\%$ of the testdata: $n\\leq 8000$, $m\\leq 10^6$.\n- For $80\\%$ of the testdata: $n\\leq 5\\times 10^5$, $m\\leq 10^7$.\n- For $100\\%$ of the testdata: $1\\leq n\\leq 10^6$, $1\\leq m\\leq 10^7$.\n\nIt is guaranteed that $1\\leq m\\times p+q,m\\times q+p\\leq 2\\times 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "白雪皑皑", "background": "“柴门闻犬吠，风雪夜归人”，冬天，不期而至。千里冰封，万里雪飘。空中刮起了鸭毛大雪。雪花纷纷，降落人间。 美能量星球（pty 在 spore 上的一个殖民地）上的人们被这美景所震撼。但是 pty 却不高兴，他不喜欢白色的世界，他觉得这样太单调了。所以他想对雪花进行染色，让世界变得多彩些。\n", "description": "现在有 $n$ 片雪花排成一列。 pty 要对雪花进行 $m$ 次染色操作，第 $i$ 次染色操作中，把第 $((i\\times p+q)\\bmod n)+1$ 片雪花和第 $((i\\times q+p)\\bmod n)+1$ 片雪花之间的雪花（包括端点）染成颜色 $i$。其中 $p,q$ 是给定的两个正整数。他想知道最后 $n$ 片雪花被染成了什么颜色。没有被染色输出 $0$。", "inputFormat": "输入共四行，每行一个整数，分别为 $n,m,p,q$，意义如题中所述。", "outputFormat": "输出共 $n$ 行，每行一个整数，第 $i$ 行表示第 $i$ 片雪花的颜色。", "hint": "- 对于 $20\\%$ 的数据满足：$n,m\\leq 1000$。\n- 对于 $40\\%$ 的数据满足：$n\\leq 8000$，$m\\leq 10^6$。\n- 对于 $80\\%$ 的数据满足：$n\\leq 5\\times 10^5$，$m\\leq 10^7$。\n- 对于 $100\\%$ 的数据满足：$1\\leq n\\leq 10^6$，$1\\leq m\\leq 10^7$。\n\n保证 $1\\leq m\\times p+q,m\\times q+p\\leq 2\\times 10^9$。", "locale": "zh-CN"}}}
{"pid": "P2392", "type": "P", "difficulty": 2, "samples": [["1 2 1 3\t\t\n5\n4 3\n6\n2 4 3\n", "20"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "搜索", "2015", "递归", "洛谷原创", "背包 DP", "洛谷月赛"], "title": "kkksc03考前临时抱佛脚", "background": "kkksc03 的大学生活非常的颓废，平时根本不学习。但是，临近期末考试，他必须要开始抱佛脚，以求不挂科。", "description": "这次期末考试，kkksc03 需要考 $4$ 科。因此要开始刷习题集，每科都有一个习题集，分别有 $s_1,s_2,s_3,s_4$ 道题目，完成每道题目需要一些时间，可能不等（$A_1,A_2,\\ldots,A_{s_1}$，$B_1,B_2,\\ldots,B_{s_2}$，$C_1,C_2,\\ldots,C_{s_3}$，$D_1,D_2,\\ldots,D_{s_4}$）。\n\n\nkkksc03 有一个能力，他的左右两个大脑可以同时计算 $2$ 道不同的题目，但是仅限于同一科。因此，kkksc03 必须一科一科的复习。\n\n\n由于 kkksc03 还急着去处理洛谷的 bug，因此他希望尽快把事情做完，所以他希望知道能够完成复习的最短时间。", "inputFormat": "本题包含 $5$ 行数据：第 $1$ 行，为四个正整数 $s_1,s_2,s_3,s_4$。\n\n第 $2$ 行，为 $A_1,A_2,\\ldots,A_{s_1}$ 共 $s_1$ 个数，表示第一科习题集每道题目所消耗的时间。\n\n第 $3$ 行，为 $B_1,B_2,\\ldots,B_{s_2}$ 共 $s_2$ 个数。\n\n第 $4$ 行，为 $C_1,C_2,\\ldots,C_{s_3}$ 共 $s_3$ 个数。\n\n第 $5$ 行，为 $D_1,D_2,\\ldots,D_{s_4}$ 共 $s_4$ 个数，意思均同上。", "outputFormat": "输出一行，为复习完毕最短时间。", "hint": "$1\\leq s_1,s_2,s_3,s_4\\leq 20$。\n\n$1\\leq A_1,A_2,\\ldots,A_{s_1},B_1,B_2,\\ldots,B_{s_2},C_1,C_2,\\ldots,C_{s_3},D_1,D_2,\\ldots,D_{s_4}\\leq60$。", "locale": "zh-CN", "translations": {"en": {"title": "kkksc03's Last-Minute Cramming Before the Exam", "background": "kkksc03's college life is very unmotivated; he usually does not study. However, with the final exams approaching, he must start cramming to avoid failing.", "description": "For this final exam, kkksc03 needs to take $4$ subjects. Therefore, he begins practicing problem sets. Each subject has a problem set with $s_1,s_2,s_3,s_4$ problems, and each problem takes some (possibly different) amount of time to complete ($A_1,A_2,\\ldots,A_{s_1}$, $B_1,B_2,\\ldots,B_{s_2}$, $C_1,C_2,\\ldots,C_{s_3}$, $D_1,D_2,\\ldots,D_{s_4}$).\n\nkkksc03 has an ability: his left and right brains can work on $2$ different problems simultaneously, but only within the same subject. Therefore, kkksc03 must review one subject at a time.\n\nSince kkksc03 is also in a hurry to handle Luogu's bugs, he wants to finish as quickly as possible. He wants to know the minimum time required to complete all the review.", "inputFormat": "This problem contains $5$ lines of input.\n- The first line contains four positive integers $s_1,s_2,s_3,s_4$.\n- The second line contains $A_1,A_2,\\ldots,A_{s_1}$, a total of $s_1$ numbers, representing the time required for each problem in the first subject's problem set.\n- The third line contains $B_1,B_2,\\ldots,B_{s_2}$, a total of $s_2$ numbers.\n- The fourth line contains $C_1,C_2,\\ldots,C_{s_3}$, a total of $s_3$ numbers.\n- The fifth line contains $D_1,D_2,\\ldots,D_{s_4}$, a total of $s_4$ numbers, with the same meaning as above.", "outputFormat": "Output one line: the minimum time to finish all the review.", "hint": "$1\\leq s_1,s_2,s_3,s_4\\leq 20$.\n\n$1\\leq A_1,A_2,\\ldots,A_{s_1},B_1,B_2,\\ldots,B_{s_2},C_1,C_2,\\ldots,C_{s_3},D_1,D_2,\\ldots,D_{s_4}\\leq 60$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "kkksc03考前临时抱佛脚", "background": "kkksc03 的大学生活非常的颓废，平时根本不学习。但是，临近期末考试，他必须要开始抱佛脚，以求不挂科。", "description": "这次期末考试，kkksc03 需要考 $4$ 科。因此要开始刷习题集，每科都有一个习题集，分别有 $s_1,s_2,s_3,s_4$ 道题目，完成每道题目需要一些时间，可能不等（$A_1,A_2,\\ldots,A_{s_1}$，$B_1,B_2,\\ldots,B_{s_2}$，$C_1,C_2,\\ldots,C_{s_3}$，$D_1,D_2,\\ldots,D_{s_4}$）。\n\n\nkkksc03 有一个能力，他的左右两个大脑可以同时计算 $2$ 道不同的题目，但是仅限于同一科。因此，kkksc03 必须一科一科的复习。\n\n\n由于 kkksc03 还急着去处理洛谷的 bug，因此他希望尽快把事情做完，所以他希望知道能够完成复习的最短时间。", "inputFormat": "本题包含 $5$ 行数据：第 $1$ 行，为四个正整数 $s_1,s_2,s_3,s_4$。\n\n第 $2$ 行，为 $A_1,A_2,\\ldots,A_{s_1}$ 共 $s_1$ 个数，表示第一科习题集每道题目所消耗的时间。\n\n第 $3$ 行，为 $B_1,B_2,\\ldots,B_{s_2}$ 共 $s_2$ 个数。\n\n第 $4$ 行，为 $C_1,C_2,\\ldots,C_{s_3}$ 共 $s_3$ 个数。\n\n第 $5$ 行，为 $D_1,D_2,\\ldots,D_{s_4}$ 共 $s_4$ 个数，意思均同上。", "outputFormat": "输出一行，为复习完毕最短时间。", "hint": "$1\\leq s_1,s_2,s_3,s_4\\leq 20$。\n\n$1\\leq A_1,A_2,\\ldots,A_{s_1},B_1,B_2,\\ldots,B_{s_2},C_1,C_2,\\ldots,C_{s_3},D_1,D_2,\\ldots,D_{s_4}\\leq60$。", "locale": "zh-CN"}}}
{"pid": "P2393", "type": "P", "difficulty": 1, "samples": [["1\n", "1.00000\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "yyy loves Maths II", "background": "上次蒟蒻 redbag 可把 yyy 气坏了，yyy 说他只是小学生，蒟蒻 redbag 这次不坑他了。\n", "description": "redbag 给了 yyy 很多个数，要 yyy 计算这些数的和。\n\n必须要快，redbag 只给了 yyy $1$ 秒的时间！！！\n", "inputFormat": "一行，很多个数。", "outputFormat": "一行，一个实数(四舍五入精确到 $5$ 位小数)，表示这些数的和。\n", "hint": "对于 $100\\%$ 的数据，所有数 $ \\le 233,333,333 $，保证在小数点后最多有 $6$ 位数，最多共有 $5\\times 10^4$ 个数。", "locale": "zh-CN", "translations": {"en": {"title": "yyy loves Maths II", "background": "Last time, the noob (jǔruò) redbag made yyy very angry. yyy says he is only a primary school student, so the noob redbag will not trick him this time.", "description": "redbag gave yyy many numbers and asked yyy to compute their sum.\nIt must be fast; redbag only gave yyy $1$ second.", "inputFormat": "One line with many numbers.", "outputFormat": "One line with a real number (rounded to $5$ decimal places), representing the sum of these numbers.", "hint": "For $100\\%$ of the testdata, each number is $\\le 233,333,333$, there are at most $6$ digits after the decimal point, and there are at most $5\\times 10^4$ numbers.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "yyy loves Maths II", "background": "上次蒟蒻 redbag 可把 yyy 气坏了，yyy 说他只是小学生，蒟蒻 redbag 这次不坑他了。\n", "description": "redbag 给了 yyy 很多个数，要 yyy 计算这些数的和。\n\n必须要快，redbag 只给了 yyy $1$ 秒的时间！！！\n", "inputFormat": "一行，很多个数。", "outputFormat": "一行，一个实数(四舍五入精确到 $5$ 位小数)，表示这些数的和。\n", "hint": "对于 $100\\%$ 的数据，所有数 $ \\le 233,333,333 $，保证在小数点后最多有 $6$ 位数，最多共有 $5\\times 10^4$ 个数。", "locale": "zh-CN"}}}
{"pid": "P2394", "type": "P", "difficulty": 1, "samples": [["0.23", "0.01000000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "yyy loves Chemistry I", "background": "从前，有个人叫 yyy，他特别喜欢化学，尤其是一些很危（zuo）险（si）的实验。\n\n这一天，他开始研究起了一个神奇又有趣的方程式：\n\n$\\text{2Na + 2H}_{2}\\text{O == 2NaOH + H}_2\\uparrow$", "description": "现在 yyy 将一块质量为 $x\\ \\text{g}$ 的钠投入很多（过量）的水中，然后开始收集氢气。\n\n最终，我们知道，这块钠在水中游动着消失了。而 yyy 很厉害，把氢气全收集起来了。\n\n**已知每投入 $\\bm{23}$ 克的钠，就会生成 $\\bm1$ 克的氢气。**\n\n那么现在 yyy 收集了多少克氢气呢？\n\n**形式化题意：输入一个实数 $\\bm x$，输出 $\\bm{\\frac{x}{23}}$ 的前 $\\bm8$ 位小数值，要求四舍五入。**", "inputFormat": "一行一个实数 $x$，代表 yyy 将投入了水中的钠的质量（单位：$\\text{g}$）。\n\n输入文件行末一定**不会**有一只回车啦。", "outputFormat": "一行一个实数（四舍五入精确到 $8$ 位小数），代表生成了多少克氢气。", "hint": "### 数据规模与约定\n\n对于 $100\\%$ 的数据，满足 $0<x\\le1$。\n\n### 提示\n\n你想知道 $x$ 有几位小数吗？才不给你呢>\\_<  \nkkksc：没有数据范围怎么行！输入文件不超过 $5\\text M$！  \n出题人：怎么能这样！差评！我不好挖坑了！\n\n### 警告\n\n**请注意，题目中描述的实验具有很大风险，请勿轻易尝试：活泼金属 $\\bold{Na}$ 存在安全隐患、$\\bold{NaOH}$ 具有强烈的腐蚀性、$\\bold{NaOH}$ 溶解于水时会放出大量热量。**", "locale": "zh-CN", "translations": {"en": {"title": "yyy loves Chemistry I", "background": "Once, there was a person named yyy who especially loved chemistry, especially some very dangerous (\"zuo si\") experiments.\n\nThat day, he began to study a magical and interesting equation:\n\n$\\text{2Na + 2H}_{2}\\text{O == 2NaOH + H}_2\\uparrow$", "description": "Now yyy puts a piece of sodium with mass $x\\ \\text{g}$ into a lot (excess) of water and then starts collecting hydrogen gas.\n\nIn the end, we know that this piece of sodium swam around in the water and disappeared. And yyy is very capable and collected all the hydrogen gas.\n\nKnown that every $\\bm{23}$ grams of sodium added will produce $\\bm1$ gram of hydrogen gas.\n\nHow many grams of hydrogen did yyy collect?\n\nFormal statement: Given a real number $\\bm x$, output $\\bm{\\frac{x}{23}}$ rounded to $\\bm 8$ decimal places.", "inputFormat": "One line containing a real number $x$, representing the mass of sodium that yyy put into the water (unit: $\\text{g}$).\n\nThere will definitely not be a trailing newline at the end of the input file.", "outputFormat": "One line containing a real number (rounded to $8$ decimal places), representing how many grams of hydrogen gas were produced.", "hint": "### Constraints and Notes\n\nFor $100\\%$ of the testdata, $0 < x \\le 1$.\n\n### Hint\n\nDo you want to know how many decimal places $x$ has? Not telling you >_<  \nkkksc: How can there be no constraints! The input file is no more than $5\\text M$!  \nProblem setter: How could you do that! Bad review! Now I can't lay traps!\n\n### Warning\n\nPlease note that the experiment described in the problem is highly risky. Do not attempt it: the reactive metal $\\bold{Na}$ poses safety hazards, $\\bold{NaOH}$ is strongly corrosive, and dissolving $\\bold{NaOH}$ in water releases a large amount of heat.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "yyy loves Chemistry I", "background": "从前，有个人叫 yyy，他特别喜欢化学，尤其是一些很危（zuo）险（si）的实验。\n\n这一天，他开始研究起了一个神奇又有趣的方程式：\n\n$\\text{2Na + 2H}_{2}\\text{O == 2NaOH + H}_2\\uparrow$", "description": "现在 yyy 将一块质量为 $x\\ \\text{g}$ 的钠投入很多（过量）的水中，然后开始收集氢气。\n\n最终，我们知道，这块钠在水中游动着消失了。而 yyy 很厉害，把氢气全收集起来了。\n\n**已知每投入 $\\bm{23}$ 克的钠，就会生成 $\\bm1$ 克的氢气。**\n\n那么现在 yyy 收集了多少克氢气呢？\n\n**形式化题意：输入一个实数 $\\bm x$，输出 $\\bm{\\frac{x}{23}}$ 的前 $\\bm8$ 位小数值，要求四舍五入。**", "inputFormat": "一行一个实数 $x$，代表 yyy 将投入了水中的钠的质量（单位：$\\text{g}$）。\n\n输入文件行末一定**不会**有一只回车啦。", "outputFormat": "一行一个实数（四舍五入精确到 $8$ 位小数），代表生成了多少克氢气。", "hint": "### 数据规模与约定\n\n对于 $100\\%$ 的数据，满足 $0<x\\le1$。\n\n### 提示\n\n你想知道 $x$ 有几位小数吗？才不给你呢>\\_<  \nkkksc：没有数据范围怎么行！输入文件不超过 $5\\text M$！  \n出题人：怎么能这样！差评！我不好挖坑了！\n\n### 警告\n\n**请注意，题目中描述的实验具有很大风险，请勿轻易尝试：活泼金属 $\\bold{Na}$ 存在安全隐患、$\\bold{NaOH}$ 具有强烈的腐蚀性、$\\bold{NaOH}$ 溶解于水时会放出大量热量。**", "locale": "zh-CN"}}}
{"pid": "P2395", "type": "P", "difficulty": 4, "samples": [["[h1]Hello World![/h1]\n[h2]How are [i]you[/i]?[/h2]", "# Hello World! #\n## How are *you*? ##"], ["[h1]Introducing Swift.[/h1][quote]\nimport SpriteKit\nlet object = SKSpriteNode(imageNamed: “[L2/Ascention]”\n[/quote]", "# Introducing Swift. #\n> import SpriteKit\n> let object = SKSpriteNode(imageNamed: “[L2/Ascention]”"], ["[h1]I knew you were\ntrouble when you walked in[/h1]\n[url=http://www.example.com]By Taylor Swift[/url]", "# I knew you were\ntrouble when you walked in #\n[By Taylor Swift](http://www.example.com)"], ["[h1]Thanks for [i]inviting[/h1] me.[/i]", "Match Error"], ["[h2]Your gift is awesome!", "Unclosed Mark"], ["[quote][/quote][/quote]", "Match Error\n(对该数据的解释: 匹配到第一个关闭标签后即不认为后面的内容仍是代码段)"], ["[quote][quote][/quote]", "> [quote]"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "字符串", "2015", "洛谷原创", "栈", "洛谷月赛"], "title": "BBCode转换Markdown", "background": "BBCode 和 Markdown 是两种常用的格式语言。所谓格式语言指，例如在某些网站评论区发表评论时，可以使用其对你的评论进行修饰，使文字可以有颜色、粗体等各种样式。\n", "description": "#### ~~PDF版题目: http://pan.baidu.com/s/1i3mxk4t 提取密码 hayc~~\n\n### 2025-7-17：链接炸了\n\nBBCode的语法如下所示：\n\n```plain\n[h1]Hello World![/h1]\n[h2][i]This is a BBCode[/i][/h2]\n[b][i]I love[/i] Olympic [i]Informatics[/i][/b]\n```\n\n例如，在标签 `[h1]` 中，在 `[h1]` 和 `[/h1]` 之间包裹的内容属于一级标题，对于这之间的文字要按照一级标题的样式渲染。\n\n请注意 BBCode 要求标签的开闭必须**完整且且嵌套无误**，也就是说，如下列的例子都是不合法的 BBCode：\n\n```plain\n[h1]Hello World! //标签未闭合\n[h1]Hello World![/h2] //两个标签不匹配\n[h1][i]Hello World![/h1][/i] //嵌套次序错误\n```\n\n另外，极其重要的一点是，BBCode有一个特殊的标签[quote][/quote]，在其中的任意文字都不应被解析为BBCode代码，而应该对其进行Markdown化处理后被原样输出。\n\n现在介绍Markdown。其语法如下所示：\n\n```cpp\n# Hello World! #\n## *This is a Markdown* ##\n__*I love* Olympic *Informatics*__\n```\n\n你的任务就是将给定的一串 BBCode 转换成 Markdown，并对不合法的输入报错。\n\n题目数据中会出现的所有 BBCode 的标签与其对应 Markdown 对应关系如下，保证不出现除此之外的对应：\n\n ![](https://cdn.luogu.com.cn/upload/pic/1493.png) \n\n对于 `[quote]` 标签的附加说明：\n\n![](https://cdn.luogu.com.cn/upload/pic/1494.png)\n", "inputFormat": "所需转换的 BBCode。\n", "outputFormat": "", "hint": "为保证评测顺利不被误判，请注意下列要求：\n\n尊重原输入输出的换行，不自行添删。\n\n对于第一条的例外是， 遇到 `[quote]` 标签不在新的一行时，Markdown 中请另起一行。另外 `[quote]` 标签中的代码段头尾空行请去除，不会出现空白的 quote。\n\n请注意上表中的空格。\n\n对于不合法的 BBCode 输入，你的程序必须报错：\n\n- 对于匹配错误的标签输出 `Match Error`；\n- 对于未闭合的标签输出 `Unclosed Mark`，请参考样例。\n\n两种情况同时出现的时候（即同时有匹配错误和未闭合的标签时），按照匹配错误处理，输出 `Match Error`。\n\n由于 quote 标签的特殊性，为保证不出现歧义，数据保证 quote 标签不会出现错误。\n\n例如：对于出现如 `[i][h1]Text[/i]` 这样的情况，按照 `Match Error` 处理，对于 `[i][h1]Text[/h1]` 这样的情况，按照 `Unclosed Mark` 处理。\n\n由于洛谷限制，请大家在输出 `Unclosed Mark` 的时候在 `close` 中间切开分为两段字符串输出，否则会被吞记录。\n\n保证以下三种字符不出现在除quote标签包裹的段落中的文字中：`[` `]` `/` `*` `_` `#` `>`，但地址中可能会出现/字符。\n\n保证输入不会出现标签不完整的情况，例如 `[h1]Text[/h`。\n\n对于曾经在其他地方使用过 Markdown 与 BBCode 的同学：题中的格式不是严格的 BBCode 与 Markdown 格式，请勿被经验迷惑。\n", "locale": "zh-CN", "translations": {"en": {"title": "BBCode to Markdown", "background": "BBCode and Markdown are two commonly used formatting languages. A formatting language means, for example, when posting a comment on some websites, you can use it to style your comment so that text can have colors, boldface, and various other styles.", "description": "#### ~~PDF version of the problem: http://pan.baidu.com/s/1i3mxk4t Extraction code hayc~~\n\n### 2025-7-17: The link is down.\n\nThe syntax of BBCode is as follows:\n\n```plain\n[h1]Hello World![/h1]\n[h2][i]This is a BBCode[/i][/h2]\n[b][i]I love[/i] Olympic [i]Informatics[/i][/b]\n```\n\nFor example, in the tag `[h1]`, the content wrapped between `[h1]` and `[/h1]` is a level-1 heading, and the text within should be rendered in the style of a level-1 heading.\n\nPlease note that BBCode requires tags to be properly opened and closed and nested correctly, that is, the following examples are all invalid BBCode:\n\n```plain\n[h1]Hello World! // tag not closed\n[h1]Hello World![/h2] // two tags do not match\n[h1][i]Hello World![/h1][/i] // incorrect nesting order\n```\n\nIn addition, a very important point is that BBCode has a special tag [quote][/quote]. Any text inside it should not be parsed as BBCode code but should be converted to Markdown and then output verbatim.\n\nNow, introducing Markdown. Its syntax is as follows:\n\n```cpp\n# Hello World! #\n## *This is a Markdown* ##\n__*I love* Olympic *Informatics*__\n```\n\nYour task is to convert a given piece of BBCode into Markdown and report errors for invalid input.\n\nAll BBCode tags that will appear in the testdata and their corresponding Markdown counterparts are shown below. No other mappings will appear:\n\n ![](https://cdn.luogu.com.cn/upload/pic/1493.png) \n\nAdditional notes for the `[quote]` tag:\n\n![](https://cdn.luogu.com.cn/upload/pic/1494.png)", "inputFormat": "The BBCode that needs to be converted.", "outputFormat": "", "hint": "To ensure smooth judging and avoid misjudgment, please pay attention to the following requirements:\n\n- Respect the original line breaks in the input and output. Do not add or remove line breaks on your own.\n- The exception to the above: when encountering a `[quote]` tag that is not on a new line, please start a new line in Markdown. Also, please remove the leading and trailing blank lines of the code block inside the `[quote]` tag. There will be no empty quotes.\n- Please pay attention to the spaces in the table above.\n- For invalid BBCode input, your program must report an error:\n  - For mismatched tags, output `Match Error`.\n  - For unclosed tags, output `Unclosed Mark`. Please refer to the samples.\n- When both situations occur at the same time (that is, both a matching error and unclosed tags), handle it as a matching error and output `Match Error`.\n- Due to the special nature of the quote tag, to avoid ambiguity, the testdata guarantees that the quote tag will not be erroneous.\n- For example: for a case like `[i][h1]Text[/i]`, handle it as `Match Error`. For a case like `[i][h1]Text[/h1]`, handle it as `Unclosed Mark`.\n- Due to Luogu limitations, when outputting `Unclosed Mark`, please split `close` in the middle into two separate strings, otherwise the record will be swallowed.\n- It is guaranteed that the following characters will not appear in text outside segments wrapped by the quote tag: `[` `]` `/` `*` `_` `#` `>`. However, the `/` character may appear in URLs.\n- The input will not contain incomplete tags, such as `[h1]Text[/h`.\n- For those who have used Markdown and BBCode elsewhere: the formats in this problem are not strictly the standard BBCode or Markdown formats. Please do not be misled by prior experience.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "BBCode转换Markdown", "background": "BBCode 和 Markdown 是两种常用的格式语言。所谓格式语言指，例如在某些网站评论区发表评论时，可以使用其对你的评论进行修饰，使文字可以有颜色、粗体等各种样式。\n", "description": "#### ~~PDF版题目: http://pan.baidu.com/s/1i3mxk4t 提取密码 hayc~~\n\n### 2025-7-17：链接炸了\n\nBBCode的语法如下所示：\n\n```plain\n[h1]Hello World![/h1]\n[h2][i]This is a BBCode[/i][/h2]\n[b][i]I love[/i] Olympic [i]Informatics[/i][/b]\n```\n\n例如，在标签 `[h1]` 中，在 `[h1]` 和 `[/h1]` 之间包裹的内容属于一级标题，对于这之间的文字要按照一级标题的样式渲染。\n\n请注意 BBCode 要求标签的开闭必须**完整且且嵌套无误**，也就是说，如下列的例子都是不合法的 BBCode：\n\n```plain\n[h1]Hello World! //标签未闭合\n[h1]Hello World![/h2] //两个标签不匹配\n[h1][i]Hello World![/h1][/i] //嵌套次序错误\n```\n\n另外，极其重要的一点是，BBCode有一个特殊的标签[quote][/quote]，在其中的任意文字都不应被解析为BBCode代码，而应该对其进行Markdown化处理后被原样输出。\n\n现在介绍Markdown。其语法如下所示：\n\n```cpp\n# Hello World! #\n## *This is a Markdown* ##\n__*I love* Olympic *Informatics*__\n```\n\n你的任务就是将给定的一串 BBCode 转换成 Markdown，并对不合法的输入报错。\n\n题目数据中会出现的所有 BBCode 的标签与其对应 Markdown 对应关系如下，保证不出现除此之外的对应：\n\n ![](https://cdn.luogu.com.cn/upload/pic/1493.png) \n\n对于 `[quote]` 标签的附加说明：\n\n![](https://cdn.luogu.com.cn/upload/pic/1494.png)\n", "inputFormat": "所需转换的 BBCode。\n", "outputFormat": "", "hint": "为保证评测顺利不被误判，请注意下列要求：\n\n尊重原输入输出的换行，不自行添删。\n\n对于第一条的例外是， 遇到 `[quote]` 标签不在新的一行时，Markdown 中请另起一行。另外 `[quote]` 标签中的代码段头尾空行请去除，不会出现空白的 quote。\n\n请注意上表中的空格。\n\n对于不合法的 BBCode 输入，你的程序必须报错：\n\n- 对于匹配错误的标签输出 `Match Error`；\n- 对于未闭合的标签输出 `Unclosed Mark`，请参考样例。\n\n两种情况同时出现的时候（即同时有匹配错误和未闭合的标签时），按照匹配错误处理，输出 `Match Error`。\n\n由于 quote 标签的特殊性，为保证不出现歧义，数据保证 quote 标签不会出现错误。\n\n例如：对于出现如 `[i][h1]Text[/i]` 这样的情况，按照 `Match Error` 处理，对于 `[i][h1]Text[/h1]` 这样的情况，按照 `Unclosed Mark` 处理。\n\n由于洛谷限制，请大家在输出 `Unclosed Mark` 的时候在 `close` 中间切开分为两段字符串输出，否则会被吞记录。\n\n保证以下三种字符不出现在除quote标签包裹的段落中的文字中：`[` `]` `/` `*` `_` `#` `>`，但地址中可能会出现/字符。\n\n保证输入不会出现标签不完整的情况，例如 `[h1]Text[/h`。\n\n对于曾经在其他地方使用过 Markdown 与 BBCode 的同学：题中的格式不是严格的 BBCode 与 Markdown 格式，请勿被经验迷惑。\n", "locale": "zh-CN"}}}
