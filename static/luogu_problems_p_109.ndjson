{"pid": "P3209", "type": "P", "difficulty": 6, "samples": [["2\n6 9\n1 4\n1 5\n1 6\n2 4\n2 5\n2 6\n3 4\n3 5\n3 6\n1 4 2 5 3 6\n5 5\n1 2\n2 3\n3 4\n4 5\n5 1\n1 2 3 4 5", "NO\nYES"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2010", "线段树", "并查集", "各省省选", "湖南", "图论建模", "平面图", "2-SAT", "二分图"], "title": "[HNOI2010] 平面图判定", "background": null, "description": "若能将无向图 $G=(V, E)$ 画在平面上使得任意两条无重合顶点的边不相交，则称 $G$ 是平面图。判定一个图是否为平面图的问题是图论中的一个重要问题。现在假设你要判定的是一类特殊的图，图中存在一个包含所有顶点的环，即存在哈密顿回路。", "inputFormat": "输入文件的第一行是一个正整数 $T$，表示数据组数 (每组数据描述一个需要判定的图)。\n\n接下来从输入文件第二行开始有 $T$ 组数据，每组数据的第一行是用空格隔开的两个正整数 $N$ 和 $M$，分别表示对应图的顶点数和边数。\n\n紧接着的 $M$ 行，每行是用空格隔开的两个正整数 $u$ 和 $v$ $\\left(1\\leq u,v\\leq N\\right)$，表示对应图的一条边 $\\left(u,v\\right)$, 输入的数据保证所有边仅出现一次。\n\n每组数据的最后一行是用空格隔开的 $N$ 个正整数，从左到右表示对应图中的一个哈密顿回路：$V_1,V_2,…,V_N$，即对任意 $i\\not=j$ 有 $V_i\\not=V_j$ 且对任意 $1\\leq i\\leq N-1$ 有 $\\left(V_i,V_{i+1}\\right)\\in E$ 及 $\\left(V_1,V_N\\right)\\in E$。\n\n输入的数据保证 $100\\%$ 的数据满足 $T\\leq100,3\\leq N\\leq200,M\\leq10000$。", "outputFormat": "包含 $T$ 行，若输入文件的第 $i$ 组数据所对应图是平面图，则在第 $i$ 行输出 `YES`，否则在第 $i$ 行输出 `NO`，注意均为大写字母", "hint": "感谢@hibiki 对题目进行修正\n\n感谢@Anguei 提供 latex 题面", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2010] Planarity Testing", "background": "", "description": "If an undirected graph $G=(V, E)$ can be drawn in the plane such that any two edges that do not share an endpoint do not intersect, then $G$ is called a planar graph. Deciding whether a graph is planar is an important problem in graph theory. Now suppose you are to decide this for a special class of graphs that contain a cycle passing through all vertices, i.e., there exists a Hamiltonian cycle.", "inputFormat": "The first line of the input file contains a positive integer $T$, indicating the number of test cases (each test case describes one graph to be decided).\n\nStarting from the second line, there are $T$ test cases. For each test case, the first line contains two positive integers $N$ and $M$ separated by a space, representing the number of vertices and the number of edges of the corresponding graph, respectively.\n\nThe next $M$ lines each contain two positive integers $u$ and $v$ $\\left(1\\leq u,v\\leq N\\right)$ separated by a space, representing an edge $\\left(u,v\\right)$ of the graph. The input guarantees that each edge appears exactly once.\n\nThe last line of each test case contains $N$ integers, from left to right representing a Hamiltonian cycle of the corresponding graph: $V_1,V_2,\\dots,V_N$, i.e., for any $i\\not=j$ we have $V_i\\not=V_j$, and for any $1\\leq i\\leq N-1$ we have $\\left(V_i,V_{i+1}\\right)\\in E$ and $\\left(V_1,V_N\\right)\\in E$.\n\nThe input guarantees that $100\\%$ of the testdata satisfy $T\\leq 100$, $3\\leq N\\leq 200$, $M\\leq 10000$.", "outputFormat": "Output $T$ lines. If the graph in the $i$-th test case is planar, print `YES` on the $i$-th line; otherwise, print `NO`. Note that they must be uppercase letters.", "hint": "Thanks to @hibiki for correcting the problem.\n\nThanks to @Anguei for providing the LaTeX problem statement.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2010] 平面图判定", "background": null, "description": "若能将无向图 $G=(V, E)$ 画在平面上使得任意两条无重合顶点的边不相交，则称 $G$ 是平面图。判定一个图是否为平面图的问题是图论中的一个重要问题。现在假设你要判定的是一类特殊的图，图中存在一个包含所有顶点的环，即存在哈密顿回路。", "inputFormat": "输入文件的第一行是一个正整数 $T$，表示数据组数 (每组数据描述一个需要判定的图)。\n\n接下来从输入文件第二行开始有 $T$ 组数据，每组数据的第一行是用空格隔开的两个正整数 $N$ 和 $M$，分别表示对应图的顶点数和边数。\n\n紧接着的 $M$ 行，每行是用空格隔开的两个正整数 $u$ 和 $v$ $\\left(1\\leq u,v\\leq N\\right)$，表示对应图的一条边 $\\left(u,v\\right)$, 输入的数据保证所有边仅出现一次。\n\n每组数据的最后一行是用空格隔开的 $N$ 个正整数，从左到右表示对应图中的一个哈密顿回路：$V_1,V_2,…,V_N$，即对任意 $i\\not=j$ 有 $V_i\\not=V_j$ 且对任意 $1\\leq i\\leq N-1$ 有 $\\left(V_i,V_{i+1}\\right)\\in E$ 及 $\\left(V_1,V_N\\right)\\in E$。\n\n输入的数据保证 $100\\%$ 的数据满足 $T\\leq100,3\\leq N\\leq200,M\\leq10000$。", "outputFormat": "包含 $T$ 行，若输入文件的第 $i$ 组数据所对应图是平面图，则在第 $i$ 行输出 `YES`，否则在第 $i$ 行输出 `NO`，注意均为大写字母", "hint": "感谢@hibiki 对题目进行修正\n\n感谢@Anguei 提供 latex 题面", "locale": "zh-CN"}}}
{"pid": "P3210", "type": "P", "difficulty": 7, "samples": [["8\n1 2 0 3 7 4 0 9", "17 9\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "博弈论", "2010", "各省省选", "湖南"], "title": "[HNOI2010] 取石头游戏", "background": "", "description": "A 公司正在举办一个智力双人游戏比赛 - 取石子游戏，游戏的获胜者将会获得 A 公司提供的丰厚奖金，因此吸引了来自全国各地的许多聪明的选手前来参加比赛。\n\n与经典的取石子游戏相比，A 公司举办的这次比赛的取石子游戏规则复杂了很多：\n\n* 总共有 $N$ 堆石子依次排成一行，第 $i$ 堆石子有 $a_i$ 个石子。\n\n* 开始若干堆石子已被 A 公司故意拿走。\n\n* 然后两个玩家轮流来取石子，每次每个玩家可以取走一堆中的所有石子，但有一个限制条件：一个玩家若要取走一堆石子，则与这堆石子相邻的某堆石子已被取走(之前被某个玩家取走或开始被 A 公司故意拿走)。注意：第 $1$ 堆石子只与第 $2$ 堆石子相邻，第 $N$ 堆石子只与第 $N-1$ 堆石子相邻，其余的第 $i$ 堆石子与第 $i-1$ 堆和第 $i+1$ 堆石子相邻。\n\n* 所有石子都被取走时，游戏结束。谁最后取得的总石子数最多，谁就获得了这场游戏的胜利。\n\n作为这次比赛的参赛者之一，绝顶聪明的你，想知道对于任何一场比赛，如果先手者和后手者都使用最优的策略，最后先手者和后手者分别能够取得的总石子数分别是多少。\n", "inputFormat": "第一行是一个正整数 $N$，表示有多少堆石子。输入文件第二行是用空格隔开的 $N$ 个非负整数 $a_1, a_2,\\ldots, a_N$，其中 $a_i$ 表示第 $i$ 堆石子有多少个石子，$a_i  = 0$ 表示第 $i$ 堆石子开始被 A 公司故意拿走。输入的数据保证 $0\\leq a_i\\leq 10^8$，并且至少有一个 $i$ 使得 $a_i = 0$。", "outputFormat": "仅包含一行，为两个整数，分别表示都使用最优策略时，最后先手者和后手者各自能够取得的总石子数，并且两个整数间用一个空格隔开。\n", "hint": "样例解释：两个玩家都使用最优策略时取走石子的顺序依次为 $9, 2, 1, 4, 7, 3$，因此先手者取得 $9 + 1 + 7 = 17$ 个石子，后手者取得 $2 + 4 + 3 = 9$ 个石子。\n\n$30\\%$ 的数据满足 $2\\leq N\\leq 100$。\n\n$100\\%$ 的数据满足 $2\\leq N\\leq 10^6$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2010] Stone-Taking Game", "background": "", "description": "Company A is hosting a two-player puzzle contest — the stone-taking game. The winner will receive a generous prize provided by Company A, attracting many clever contestants from all over the country.\n\nCompared with the classic stone-taking game, the rules of this contest are much more complex:\n\n- There are $N$ piles of stones arranged in a row. The $i$-th pile contains $a_i$ stones.\n- Some piles have already been deliberately removed by Company A at the start.\n- The two players then take turns. On each turn, a player may take all the stones from exactly one pile, subject to the following constraint: to take a pile, at least one of its adjacent piles must have already been taken (either previously by a player or initially removed by Company A). Note: pile $1$ is adjacent only to pile $2$, pile $N$ is adjacent only to pile $N-1$, and any other pile $i$ is adjacent to piles $i-1$ and $i+1$.\n- The game ends when all stones have been taken. The player who has collected more stones in total wins.\n\nAs one of the contestants, you want to know, for any game, if both the first player and the second player play optimally, what total number of stones each will obtain.", "inputFormat": "The first line contains a positive integer $N$, the number of piles. The second line contains $N$ space-separated nonnegative integers $a_1, a_2, \\ldots, a_N$, where $a_i$ is the number of stones in the $i$-th pile, and $a_i = 0$ means the $i$-th pile was initially removed by Company A. The input guarantees $0 \\le a_i \\le 10^8$, and there exists at least one $i$ such that $a_i = 0$.", "outputFormat": "Output a single line containing two integers: the total stones obtained by the first player and by the second player under optimal play, separated by a single space.", "hint": "Sample explanation: when both players play optimally, the piles are taken in the order $9, 2, 1, 4, 7, 3$, so the first player gets $9 + 1 + 7 = 17$ stones and the second player gets $2 + 4 + 3 = 9$ stones.\n\nConstraints:\n- For $30\\%$ of the testdata, $2 \\le N \\le 100$.\n- For $100\\%$ of the testdata, $2 \\le N \\le 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2010] 取石头游戏", "background": "", "description": "A 公司正在举办一个智力双人游戏比赛 - 取石子游戏，游戏的获胜者将会获得 A 公司提供的丰厚奖金，因此吸引了来自全国各地的许多聪明的选手前来参加比赛。\n\n与经典的取石子游戏相比，A 公司举办的这次比赛的取石子游戏规则复杂了很多：\n\n* 总共有 $N$ 堆石子依次排成一行，第 $i$ 堆石子有 $a_i$ 个石子。\n\n* 开始若干堆石子已被 A 公司故意拿走。\n\n* 然后两个玩家轮流来取石子，每次每个玩家可以取走一堆中的所有石子，但有一个限制条件：一个玩家若要取走一堆石子，则与这堆石子相邻的某堆石子已被取走(之前被某个玩家取走或开始被 A 公司故意拿走)。注意：第 $1$ 堆石子只与第 $2$ 堆石子相邻，第 $N$ 堆石子只与第 $N-1$ 堆石子相邻，其余的第 $i$ 堆石子与第 $i-1$ 堆和第 $i+1$ 堆石子相邻。\n\n* 所有石子都被取走时，游戏结束。谁最后取得的总石子数最多，谁就获得了这场游戏的胜利。\n\n作为这次比赛的参赛者之一，绝顶聪明的你，想知道对于任何一场比赛，如果先手者和后手者都使用最优的策略，最后先手者和后手者分别能够取得的总石子数分别是多少。\n", "inputFormat": "第一行是一个正整数 $N$，表示有多少堆石子。输入文件第二行是用空格隔开的 $N$ 个非负整数 $a_1, a_2,\\ldots, a_N$，其中 $a_i$ 表示第 $i$ 堆石子有多少个石子，$a_i  = 0$ 表示第 $i$ 堆石子开始被 A 公司故意拿走。输入的数据保证 $0\\leq a_i\\leq 10^8$，并且至少有一个 $i$ 使得 $a_i = 0$。", "outputFormat": "仅包含一行，为两个整数，分别表示都使用最优策略时，最后先手者和后手者各自能够取得的总石子数，并且两个整数间用一个空格隔开。\n", "hint": "样例解释：两个玩家都使用最优策略时取走石子的顺序依次为 $9, 2, 1, 4, 7, 3$，因此先手者取得 $9 + 1 + 7 = 17$ 个石子，后手者取得 $2 + 4 + 3 = 9$ 个石子。\n\n$30\\%$ 的数据满足 $2\\leq N\\leq 100$。\n\n$100\\%$ 的数据满足 $2\\leq N\\leq 10^6$。\n", "locale": "zh-CN"}}}
{"pid": "P3211", "type": "P", "difficulty": 6, "samples": [["2 2\n1 1 2\n1 2 3", "2.333"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "各省省选", "湖南", "期望", "高斯消元", "位运算"], "title": "[HNOI2011] XOR和路径", "background": "", "description": "给定一个无向连通图，其节点编号为 $1$ 到 $N$，其边的权值为非负整数。试求出一条从 $1$ 号节点到 $N$ 号节点的路径，使得该路径上经过的边的权值的“XOR 和”最大。该路径可以重复经过某些节点或边，当一条边在路径中出现多次时，其权值在计算“XOR 和”时也要被重复计算相应多的次数。\n\n\n直接求解上述问题比较困难，于是你决定使用非完美算法。具体来说，从 $1$ 号节点开始，以相等的概率，随机选择与当前节点相关联的某条边，并沿这条边走到下一个节点，重复这个过程，直到走到 $N$ 号节点为止，便得到一条从 $1$ 号节点到 $N$ 号节点的路径。显然得到每条这样的路径的概率是不同的并且每条这样的路径的“XOR 和”也不一样。现在请你求出该算法得到的路径的“XOR 和”的期望值。", "inputFormat": "输入文件的第一行是用空格隔开的两个正整数 $N$ 和 $M$，分别表示该图的节点数和边数。紧接着的 $M$ 行，每行是用空格隔开的三个非负整数 $u,v$ 和 $w$。$(1\\le u,v\\le N$，$0\\le w\\le 10^9)$，表示该图的一条边 $(u,v)$，其权值为 $w$。输入的数据保证图连通。\n", "outputFormat": "输出文件仅包含一个实数，表示上述算法得到的路径的“XOR 和”的期望值，要求保留三位小数。（建议使用精度较高的数据类型进行计算）\n", "hint": "### 样例解释\n\n有 $\\dfrac{1}{2}$ 的概率直接从 $1$ 号节点走到 $2$ 号节点，该路径的“XOR和”为 $3$；有 $\\dfrac{1}{4}$ 的概率从 $1$ 号节点走一次 $1$ 号节点的自环后走到 $2$ 号节点，该路径的“XOR和”为 $1$；有 $\\dfrac{1}{8}$ 的概率从 $1$ 号节点走两次 $1$ 号节点的自环后走到 $2$ 号节点，该路径的“XOR和”为 $3$…依此类推，可知“XOR和”的期望值为：$\\dfrac{3}{2}+\\dfrac{1}{4}+\\dfrac{3}{8}+\\dfrac{1}{16}+\\dfrac{3}{32}+\\cdots=\\dfrac{7}{3}$，约等于 $2.333$。\n\n### 数据范围\n\n- $30\\%$ 的数据满足 $N\\le 30$。  \n- $100\\%$ 的数据满足 $2\\le N\\le 100$，$M\\le 10000$，但是图中可能有重边或自环。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2011] XOR and Path", "background": "", "description": "Given an undirected connected graph with nodes labeled from $1$ to $N$, each edge has a nonnegative integer weight. Find a path from node $1$ to node $N$ that maximizes the XOR sum of the weights of the edges along the path. The path may revisit nodes or edges. If an edge appears multiple times on the path, its weight is included in the XOR sum the corresponding number of times.\n\nDirectly solving the above problem is difficult, so you decide to use an imperfect algorithm. Specifically, starting from node $1$, at each step you uniformly at random choose one edge incident to the current node and move along it to the next node. Repeat this process until you reach node $N$ to obtain a path from node $1$ to node $N$. Clearly, different such paths occur with different probabilities, and each such path has a different XOR sum. Now compute the expected value of the XOR sum of the path produced by this algorithm.", "inputFormat": "The first line contains two positive integers $N$ and $M$ separated by a space, denoting the number of nodes and the number of edges. The next $M$ lines each contain three nonnegative integers $u, v$ and $w$ ($1\\le u,v\\le N$, $0\\le w\\le 10^9$), representing an edge $(u,v)$ with weight $w$. The testdata guarantees that the graph is connected.", "outputFormat": "Output a single real number, the expected XOR sum of the path produced by the algorithm above, with three decimal places. (It is recommended to use data types with higher precision.)", "hint": "### Sample Explanation\n\nWith probability $\\dfrac{1}{2}$ you go directly from node $1$ to node $2$, and the XOR sum of this path is $3$; with probability $\\dfrac{1}{4}$ you traverse the self-loop at node $1$ once and then go to node $2$, and the XOR sum is $1$; with probability $\\dfrac{1}{8}$ you traverse the self-loop at node $1$ twice and then go to node $2$, and the XOR sum is $3$; and so on. Therefore, the expected value of the XOR sum is $\\dfrac{3}{2}+\\dfrac{1}{4}+\\dfrac{3}{8}+\\dfrac{1}{16}+\\dfrac{3}{32}+\\cdots=\\dfrac{7}{3}$, which is approximately $2.333$.\n\n### Constraints\n\n- $30\\%$ of the testdata satisfies $N\\le 30$.\n- $100\\%$ of the testdata satisfies $2\\le N\\le 100$, $M\\le 10000$, and the graph may contain multiple edges or self-loops.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2011] XOR和路径", "background": "", "description": "给定一个无向连通图，其节点编号为 $1$ 到 $N$，其边的权值为非负整数。试求出一条从 $1$ 号节点到 $N$ 号节点的路径，使得该路径上经过的边的权值的“XOR 和”最大。该路径可以重复经过某些节点或边，当一条边在路径中出现多次时，其权值在计算“XOR 和”时也要被重复计算相应多的次数。\n\n\n直接求解上述问题比较困难，于是你决定使用非完美算法。具体来说，从 $1$ 号节点开始，以相等的概率，随机选择与当前节点相关联的某条边，并沿这条边走到下一个节点，重复这个过程，直到走到 $N$ 号节点为止，便得到一条从 $1$ 号节点到 $N$ 号节点的路径。显然得到每条这样的路径的概率是不同的并且每条这样的路径的“XOR 和”也不一样。现在请你求出该算法得到的路径的“XOR 和”的期望值。", "inputFormat": "输入文件的第一行是用空格隔开的两个正整数 $N$ 和 $M$，分别表示该图的节点数和边数。紧接着的 $M$ 行，每行是用空格隔开的三个非负整数 $u,v$ 和 $w$。$(1\\le u,v\\le N$，$0\\le w\\le 10^9)$，表示该图的一条边 $(u,v)$，其权值为 $w$。输入的数据保证图连通。\n", "outputFormat": "输出文件仅包含一个实数，表示上述算法得到的路径的“XOR 和”的期望值，要求保留三位小数。（建议使用精度较高的数据类型进行计算）\n", "hint": "### 样例解释\n\n有 $\\dfrac{1}{2}$ 的概率直接从 $1$ 号节点走到 $2$ 号节点，该路径的“XOR和”为 $3$；有 $\\dfrac{1}{4}$ 的概率从 $1$ 号节点走一次 $1$ 号节点的自环后走到 $2$ 号节点，该路径的“XOR和”为 $1$；有 $\\dfrac{1}{8}$ 的概率从 $1$ 号节点走两次 $1$ 号节点的自环后走到 $2$ 号节点，该路径的“XOR和”为 $3$…依此类推，可知“XOR和”的期望值为：$\\dfrac{3}{2}+\\dfrac{1}{4}+\\dfrac{3}{8}+\\dfrac{1}{16}+\\dfrac{3}{32}+\\cdots=\\dfrac{7}{3}$，约等于 $2.333$。\n\n### 数据范围\n\n- $30\\%$ 的数据满足 $N\\le 30$。  \n- $100\\%$ 的数据满足 $2\\le N\\le 100$，$M\\le 10000$，但是图中可能有重边或自环。", "locale": "zh-CN"}}}
{"pid": "P3212", "type": "P", "difficulty": 6, "samples": [["3\n3 5 7\n1 6 1 \n2 2 6\n", "14"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["搜索", "贪心", "2011", "各省省选", "湖南", "随机化", "状压 DP"], "title": "[HNOI2011] 任务调度", "background": "", "description": "\n有 $n$ 个任务和两台机器 A 与 B。每个任务都需要既在机器 A 上执行，又在机器 B 上执行，\n\n第 $i$ 个任务需要在机器 A 上执行时间 $a_i$，且需要在机器 B 上执行时间 $b_i$。最终的目标是所有任务在 A 和 B 上都执行完，且希望执行完所有任务的总时间尽量少。当然问题没有这么简单，有些任务对于先在机器 A 上执行还是先在机器 B 上执行有一定的限制。据此可将所有任务分为三类：\n\n1. 任务必须先在机器 A 上执行完然后再在机器 B 上执行。\n2. 任务必须先在机器 B 上执行完然后再在机器 A 上执行。\n3. 任务没有限制，既可先在机器 A 上执行，也可先在机器 B 上执行。\n\n现在给定每个任务的类别和需要在机器 A 和机器 B 上分别执行的时间，问使所有任务都能按规定完成所需要的最少总时间是多少。", "inputFormat": "输入的第一行只有一个正整数 $n$，表示任务的个数。\n\n接下来的 $n$ 行，每行是用空格隔开的三个正整数 $t_i,a_i,b_i$，分别表示第 $i$ 个任务的类别（类别 $1$，$2$，$3$ 的定义如上）以及第 $i$ 个任务需要在机器 A 和机器 B 上分别执行的时间。", "outputFormat": "输出仅包含一个正整数，表示所有任务都执行完所需要的最少总时间。", "hint": "#### 样例 1 解释\n\n一种最优任务调度方案为：\n\n机器 A 上执行的各任务依次安排如下：\n\n任务 $1\\ (0\\to 5)$，任务 $2\\ (5\\to 11)$, 任务 $3\\ (11\\to 13)$；\n\n机器 B 上执行的各任务依次安排如下：\n\n任务 $3\\ (0 \\to 6)$, 任务 $1\\ (6 \\to 13)$, 任务 $2\\ (13 \\to14)$，\n\n这样，所有任务都执行完所需要的总时间为 $14$。\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 20$，$1\\le a_i\\le 10^3$，$1\\le t_i\\le 3$，并保证 $t_i=3$ 的 $i$ 不超过 $10$ 个。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2011] Task Scheduling", "background": "", "description": "There are $n$ tasks and two machines, A and B. Each task must be processed on both machines.\n\nThe $i$-th task requires time $a_i$ on machine A and time $b_i$ on machine B. The goal is to finish all tasks on both A and B while minimizing the total time to complete all tasks. However, some tasks have restrictions on whether they must be processed on A first or on B first. Based on this, all tasks are divided into three categories:\n\n1. The task must be processed on machine A first, then on machine B.\n2. The task must be processed on machine B first, then on machine A.\n3. The task has no restriction and may be processed on machine A first or on machine B first.\n\nGiven each task’s category and its processing times on machines A and B, find the minimum total time required to finish all tasks according to the rules.", "inputFormat": "The first line contains a single positive integer $n$, the number of tasks.\n\nEach of the next $n$ lines contains three space-separated positive integers $t_i, a_i, b_i$, denoting the category of task $i$ (categories $1$, $2$, and $3$ are as defined above) and the processing times of task $i$ on machines A and B, respectively.", "outputFormat": "Output a single integer, the minimum total time required to finish all tasks.", "hint": "Sample 1 Explanation:\n\nOne optimal scheduling plan is:\n\nOn machine A, schedule the tasks in order:\nTask $1\\ (0\\to 5)$, task $2\\ (5\\to 11)$, task $3\\ (11\\to 13)$;\n\nOn machine B, schedule the tasks in order:\nTask $3\\ (0 \\to 6)$, task $1\\ (6 \\to 13)$, task $2\\ (13 \\to14)$,\n\nso the total time required to finish all tasks is $14$.\n\nConstraints:\n\nFor $100\\%$ of the testdata, it is guaranteed that $1 \\le n \\le 20$, $1 \\le a_i \\le 10^3$, $1 \\le t_i \\le 3$, and the number of tasks with $t_i = 3$ does not exceed $10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2011] 任务调度", "background": "", "description": "\n有 $n$ 个任务和两台机器 A 与 B。每个任务都需要既在机器 A 上执行，又在机器 B 上执行，\n\n第 $i$ 个任务需要在机器 A 上执行时间 $a_i$，且需要在机器 B 上执行时间 $b_i$。最终的目标是所有任务在 A 和 B 上都执行完，且希望执行完所有任务的总时间尽量少。当然问题没有这么简单，有些任务对于先在机器 A 上执行还是先在机器 B 上执行有一定的限制。据此可将所有任务分为三类：\n\n1. 任务必须先在机器 A 上执行完然后再在机器 B 上执行。\n2. 任务必须先在机器 B 上执行完然后再在机器 A 上执行。\n3. 任务没有限制，既可先在机器 A 上执行，也可先在机器 B 上执行。\n\n现在给定每个任务的类别和需要在机器 A 和机器 B 上分别执行的时间，问使所有任务都能按规定完成所需要的最少总时间是多少。", "inputFormat": "输入的第一行只有一个正整数 $n$，表示任务的个数。\n\n接下来的 $n$ 行，每行是用空格隔开的三个正整数 $t_i,a_i,b_i$，分别表示第 $i$ 个任务的类别（类别 $1$，$2$，$3$ 的定义如上）以及第 $i$ 个任务需要在机器 A 和机器 B 上分别执行的时间。", "outputFormat": "输出仅包含一个正整数，表示所有任务都执行完所需要的最少总时间。", "hint": "#### 样例 1 解释\n\n一种最优任务调度方案为：\n\n机器 A 上执行的各任务依次安排如下：\n\n任务 $1\\ (0\\to 5)$，任务 $2\\ (5\\to 11)$, 任务 $3\\ (11\\to 13)$；\n\n机器 B 上执行的各任务依次安排如下：\n\n任务 $3\\ (0 \\to 6)$, 任务 $1\\ (6 \\to 13)$, 任务 $2\\ (13 \\to14)$，\n\n这样，所有任务都执行完所需要的总时间为 $14$。\n\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 20$，$1\\le a_i\\le 10^3$，$1\\le t_i\\le 3$，并保证 $t_i=3$ 的 $i$ 不超过 $10$ 个。", "locale": "zh-CN"}}}
{"pid": "P3213", "type": "P", "difficulty": 6, "samples": [["4\t\t\t\t\n5 12 35 5\t\n", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "各省省选", "湖南", "枚举", "连通块", "最大公约数 gcd"], "title": "[HNOI2011] 勾股定理", "background": null, "description": "沫沫最近在研究勾股定理。对于两个正整数 $A$ 与 $B$，若存在正整数 $C$ 使得 $A^2+B^2=C^2$，且 $A$ 与 $B$ 互质，则称 $(A,B)$ 为一个互质勾股数对。\n\n\n有一天，沫沫得到了 $N$ 根木棍，其长度都是正整数，她准备从中挑选出若干根木棍来玩拼图游戏，为了使拼出的图案有凌乱美，她希望挑选出的木棍中任意两根的长度均不是互质勾股数对。现在，沫沫想知道有多少种满足要求的挑选木棍的方案。由于答案可能很大，你只要输出答案对 $10^9+7$ 取模的结果。", "inputFormat": "第一行是一个正整数 $N$，表示共有多少根木棍。\n\n第二行是用空格隔开的 $N$ 个正整数 $h_1, h_2, \\cdots, h_N$，其中对 $1≤i≤N$，$h_i$ 表示第 $i$ 根木棍的长度。\n\n输入的数据保证 $30\\%$ 的数据满足对 $1≤i≤N$ 有$1≤h_i≤3000$，\n\n另外 $30\\%$ 的数据满足对 $1≤i≤N$ 有 $1≤h_i≤2\\times10^5$，\n\n剩下的 $40\\%$ 的数据满足对 $1≤i≤N$ 有 $2\\times10^4≤h_i≤10^6$，\n\n$100\\%$ 的数据满足 $N≤10^6$。", "outputFormat": "输出仅包含一个非负整数，表示满足要求的挑选木棍的方案数对 $10^9+7$ 取模的结果。", "hint": "样例解释：$(5,12)$ 与 $(12,35)$ 是互质勾股数对，故满足要求的挑选木棍的方案有 $8$ 种，即：\n\n$\\{5\\},\\{12\\},\\{35\\},\\{5\\},\\{5,35\\},\\{35,5\\},\\{5,5\\},\\{5,35,5\\}$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2011] Pythagorean Theorem", "background": "", "description": "Momo has been studying the Pythagorean Theorem. For two positive integers $A$ and $B$, if there exists a positive integer $C$ such that $A^2 + B^2 = C^2$, and $A$ and $B$ are coprime, then $(A, B)$ is called a primitive Pythagorean pair.\n\nOne day, Momo obtained $N$ sticks, each with a positive integer length. She plans to select some of these sticks to play a puzzle game. To make the pattern look artfully messy, she wants the lengths of any two selected sticks to not form a primitive Pythagorean pair. Now, Momo wants to know how many selection schemes meet the requirement. Since the answer may be large, you only need to output the result modulo $10^9 + 7$.", "inputFormat": "The first line contains a positive integer $N$, the number of sticks.\n\nThe second line contains $N$ space-separated positive integers $h_1, h_2, \\cdots, h_N$, where for $1 \\le i \\le N$, $h_i$ denotes the length of the $i$-th stick.\n\nThe testdata guarantees that:\n- For $30\\%$ of the testdata, for all $1 \\le i \\le N$, $1 \\le h_i \\le 3000$.\n- For another $30\\%$ of the testdata, for all $1 \\le i \\le N$, $1 \\le h_i \\le 2 \\times 10^5$.\n- For the remaining $40\\%$ of the testdata, for all $1 \\le i \\le N$, $2 \\times 10^4 \\le h_i \\le 10^6$.\n- For $100\\%$ of the testdata, $N \\le 10^6$.", "outputFormat": "Output a single non-negative integer, the number of valid selection schemes modulo $10^9 + 7$.", "hint": "Sample explanation: $(5, 12)$ and $(12, 35)$ are primitive Pythagorean pairs, so there are $8$ valid selection schemes, namely:\n\n$\\{5\\}, \\{12\\}, \\{35\\}, \\{5\\}, \\{5,35\\}, \\{35,5\\}, \\{5,5\\}, \\{5,35,5\\}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2011] 勾股定理", "background": null, "description": "沫沫最近在研究勾股定理。对于两个正整数 $A$ 与 $B$，若存在正整数 $C$ 使得 $A^2+B^2=C^2$，且 $A$ 与 $B$ 互质，则称 $(A,B)$ 为一个互质勾股数对。\n\n\n有一天，沫沫得到了 $N$ 根木棍，其长度都是正整数，她准备从中挑选出若干根木棍来玩拼图游戏，为了使拼出的图案有凌乱美，她希望挑选出的木棍中任意两根的长度均不是互质勾股数对。现在，沫沫想知道有多少种满足要求的挑选木棍的方案。由于答案可能很大，你只要输出答案对 $10^9+7$ 取模的结果。", "inputFormat": "第一行是一个正整数 $N$，表示共有多少根木棍。\n\n第二行是用空格隔开的 $N$ 个正整数 $h_1, h_2, \\cdots, h_N$，其中对 $1≤i≤N$，$h_i$ 表示第 $i$ 根木棍的长度。\n\n输入的数据保证 $30\\%$ 的数据满足对 $1≤i≤N$ 有$1≤h_i≤3000$，\n\n另外 $30\\%$ 的数据满足对 $1≤i≤N$ 有 $1≤h_i≤2\\times10^5$，\n\n剩下的 $40\\%$ 的数据满足对 $1≤i≤N$ 有 $2\\times10^4≤h_i≤10^6$，\n\n$100\\%$ 的数据满足 $N≤10^6$。", "outputFormat": "输出仅包含一个非负整数，表示满足要求的挑选木棍的方案数对 $10^9+7$ 取模的结果。", "hint": "样例解释：$(5,12)$ 与 $(12,35)$ 是互质勾股数对，故满足要求的挑选木棍的方案有 $8$ 种，即：\n\n$\\{5\\},\\{12\\},\\{35\\},\\{5\\},\\{5,35\\},\\{35,5\\},\\{5,5\\},\\{5,35,5\\}$。", "locale": "zh-CN"}}}
{"pid": "P3214", "type": "P", "difficulty": 6, "samples": [["2 3", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "递推", "2011", "各省省选", "湖南", "组合数学", "逆元", "快速沃尔什变换 FWT"], "title": "[HNOI2011] 卡农", "background": "", "description": "众所周知卡农是一种复调音乐的写作技法，小余在听卡农音乐时灵感大发，发明了一种新的音乐谱写规则。  \n\n他将声音分成 $n$ 个音阶，并将音乐分成若干个片段。音乐的每个片段都是由 $1$ 到 $n$ 个音阶构成的和声，即从 $n$ 个音阶中挑选若干个音阶同时演奏出来。  \n\n为了强调与卡农的不同，他规定任意两个片段所包含的音阶集合都不同。同时为了保持音乐的规律性，他还规定在一段音乐中每个音阶被奏响的次数为偶数。  \n\n现在的问题是：小余想知道包含 $m$ 个片段的音乐一共有多少种。  \n两段音乐 $a$ 和 $b$ 同种当且仅当将 $a$ 的片段重新排列后可以得到 $b$。例如：假设 $a$ 为 $\\{\\{1,2\\},\\{2,3\\}\\}$，$b$ 为 $\\{\\{2,3\\},\\{1,2\\}\\}$，那么 $a$ 与 $b$ 就是同种音乐。\n\n答案对 $10^8+7$ 取模。\n\n", "inputFormat": "仅一行两个正整数 $n,m$\n", "outputFormat": "输出一行一个整数表示答案。", "hint": "【数据范围】  \n对于 $20\\%$ 的数据，$1\\le n,m \\le 5$；   \n对于 $50\\%$ 的数据，$1\\le n,m \\le 3000$；  \n对于 $100\\%$ 的数据，$1\\le n,m \\le 10^6$。 \n\n【样例解释】   \n音乐为 $\\{\\{1\\},\\{2\\},\\{1,2\\}\\}$\n", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2011] Canon", "background": "", "description": "As is well known, a canon is a polyphonic composition technique. While listening to canons, Xiao Yu had a burst of inspiration and invented a new rule for writing music.\n\nHe divides the sounds into $n$ notes and splits the music into several segments. Each segment is a harmony composed of $1$ to $n$ notes, i.e., selecting some of the $n$ notes to play simultaneously.\n\nTo distinguish it from canons, he stipulates that the set of notes contained in any two segments must be different. To maintain regularity, he also requires that in one piece of music each note is sounded an even number of times across all segments.\n\nNow the question is: how many pieces of music consisting of $m$ segments are there? Two pieces of music $a$ and $b$ are considered the same if and only if $b$ can be obtained by reordering the segments of $a$. For example, suppose $a$ is $\\{\\{1,2\\},\\{2,3\\}\\}$ and $b$ is $\\{\\{2,3\\},\\{1,2\\}\\}$, then $a$ and $b$ are the same music.\n\nThe answer should be taken modulo $10^8+7$.", "inputFormat": "One line containing two positive integers $n, m$.", "outputFormat": "Output one line with a single integer representing the answer.", "hint": "Constraints  \nFor $20\\%$ of the testdata, $1 \\le n, m \\le 5$.  \nFor $50\\%$ of the testdata, $1 \\le n, m \\le 3000$.  \nFor $100\\%$ of the testdata, $1 \\le n, m \\le 10^6$.\n\nSample Explanation  \nThe music is $\\{\\{1\\},\\{2\\},\\{1,2\\}\\}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2011] 卡农", "background": "", "description": "众所周知卡农是一种复调音乐的写作技法，小余在听卡农音乐时灵感大发，发明了一种新的音乐谱写规则。  \n\n他将声音分成 $n$ 个音阶，并将音乐分成若干个片段。音乐的每个片段都是由 $1$ 到 $n$ 个音阶构成的和声，即从 $n$ 个音阶中挑选若干个音阶同时演奏出来。  \n\n为了强调与卡农的不同，他规定任意两个片段所包含的音阶集合都不同。同时为了保持音乐的规律性，他还规定在一段音乐中每个音阶被奏响的次数为偶数。  \n\n现在的问题是：小余想知道包含 $m$ 个片段的音乐一共有多少种。  \n两段音乐 $a$ 和 $b$ 同种当且仅当将 $a$ 的片段重新排列后可以得到 $b$。例如：假设 $a$ 为 $\\{\\{1,2\\},\\{2,3\\}\\}$，$b$ 为 $\\{\\{2,3\\},\\{1,2\\}\\}$，那么 $a$ 与 $b$ 就是同种音乐。\n\n答案对 $10^8+7$ 取模。\n\n", "inputFormat": "仅一行两个正整数 $n,m$\n", "outputFormat": "输出一行一个整数表示答案。", "hint": "【数据范围】  \n对于 $20\\%$ 的数据，$1\\le n,m \\le 5$；   \n对于 $50\\%$ 的数据，$1\\le n,m \\le 3000$；  \n对于 $100\\%$ 的数据，$1\\le n,m \\le 10^6$。 \n\n【样例解释】   \n音乐为 $\\{\\{1\\},\\{2\\},\\{1,2\\}\\}$\n", "locale": "zh-CN"}}}
{"pid": "P3215", "type": "P", "difficulty": 6, "samples": [["4 5\n((((\nReplace 1 2 )\nQuery 1 2\nSwap 2 3\nInvert 3 4\nQuery 1 4", "1\n2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["字符串", "2011", "各省省选", "平衡树", "江苏", "湖南"], "title": "[HNOI2011] 括号修复 / [JSOI2011] 括号序列", "background": null, "description": "一个合法的括号序列是这样定义的：\n\n1.    空串是合法的。\n2.    如果字符串 `S` 是合法的，则`(S)`也是合法的。\n3.    如果字符串 `A` 和 `B` 是合法的，则 `AB` 也是合法的。\n\n现在给你一个长度为 $n$ 的由`(`和`)`组成的字符串，位置标号从 $1$ 到 $n$。对这个字符串有下列四种操作：\n\n\n-  `Replace a b c`：将 $[a,b]$ 之间的所有括号改成 $c$。假设原来的字符串为：`))())())(`，那么执行操作 `Replace 2 7 (`  后原来的字符串变为：`)(((((()(`。\n\n-  `Swap a b`：将 $[a,b]$ 之间的字符串翻转。假设原来的字符串为：`))())())(`，那么执行操作 `Swap 3 5` 后原来的字符串变为：`))))(())(`。\n\n-  `Invert a b`：将 $[a,b]$ 之间的 `(` 变成 `)` ，`)` 变成 `(`。假设原来的字符串为：`))())())(`，那么执行操作 `Invert 4 8` 后原来的字符串变为：`))((()(((`。\n\n-  `Query a b`：询问 $[a,b]$ 之间的字符串至少要改变多少位才能变成合法的括号序列。改变某位是指将该位的 `(` 变成 `)` 或 `)` 变成 `(`。注意执行操作 `Query` 并不改变当前的括号序列。假设原来的字符串为：`))())())(`，那么执行操作 `Query 3 6` 的结果为 $2$，因为要将位置 $5$ 的`)`变成`(`并将位置 $6$ 的`(`变成`)`。", "inputFormat": "输入文件的第一行是用空格隔开的两个正整数 $n,q$，分别表示字符串的长度和将执行的操作个数。  \n\n第二行是长度为 $n$ 的初始字符串 $S$。接下来的 $q$ 行是将依次执行的 $q$ 个操作，其中操作名与操作数之间以及相邻操作数之间均用空格隔开。", "outputFormat": "对于每个 `Query` 操作，输出一行一个整数表示答案。输入数据保证有解。", "hint": "### 样例解释\n\n输入中有 $2$ 个 `Query` 操作，所以输出有 $2$ 行。   \n执行第一个 `Query` 操作时的括号序列为 `))((`，因改变第 $1$ 位可使 $[1,2]$ 之间的字符串变成合法的括号序列，故输出的第一行为 `1`。  \n\n执行第二个 `Query` 操作时的括号序列为 `)(()`，因要改变第 $1$ 位和第 $2$ 位才能使 $[1,4]$ 之间的字符串变成合法的括号序列，故输出的第二行为 `2`。\n\n### 数据范围\n\n对于 $30\\%$ 的数据，$1\\le n,q \\le 3000$；   \n对于 $100\\%$ 的数据，$1\\le n,q \\le 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2011] Bracket Repair / [JSOI2011] Bracket Sequence", "background": "", "description": "A valid parenthesis sequence is defined as follows:\n\n1. The empty string is valid.\n2. If string `S` is valid, then `(S)` is also valid.\n3. If strings `A` and `B` are valid, then `AB` is also valid.\n\nYou are given a string of length $n$ consisting of `(` and `)`, with positions numbered from $1$ to $n$. The following four operations are supported on this string:\n\n- `Replace a b c`: change all parentheses in $[a, b]$ to $c$. For example, given the original string `))())())(`, after performing `Replace 2 7 (`, it becomes `)(((((()(`.\n\n- `Swap a b`: reverse the substring in $[a, b]$. For example, given the original string `))())())(`, after performing `Swap 3 5`, it becomes `))))(())(`.\n\n- `Invert a b`: flip `(` to `)` and `)` to `(` within $[a, b]$. For example, given the original string `))())())(`, after performing `Invert 4 8`, it becomes `))((()(((`.\n\n- `Query a b`: ask for the minimum number of positions in $[a, b]$ that must be changed to make the substring a valid parenthesis sequence. Changing a position means turning `(` into `)` or `)` into `(`. Note that `Query` does not modify the current sequence. For example, given the original string `))())())(`, the result of `Query 3 6` is $2$, because you need to change position $5$ from `)` to `(` and position $6$ from `(` to `)`.", "inputFormat": "The first line contains two space-separated positive integers $n, q$, denoting the length of the string and the number of operations, respectively.  \nThe second line contains the initial string $S$ of length $n$. The next $q$ lines each describe one operation to be performed in order. The operation name and its parameters are separated by single spaces.", "outputFormat": "For each `Query` operation, output a single line with one integer representing the answer. The input is guaranteed to be solvable.", "hint": "Sample Explanation:\n\nThere are $2$ `Query` operations in the input, so the output has $2$ lines.  \nWhen executing the first `Query`, the parenthesis sequence is `))((`. By changing position $1$, the substring over $[1, 2]$ becomes a valid parenthesis sequence, so the first output line is `1`.\n\nWhen executing the second `Query`, the parenthesis sequence is `)(()`. You need to change position $1$ and position $2$ to make the substring over $[1, 4]$ a valid parenthesis sequence, so the second output line is `2`.\n\nConstraints:\n\nFor $30\\%$ of the points, $1 \\le n, q \\le 3000$.  \nFor $100\\%$ of the points, $1 \\le n, q \\le 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2011] 括号修复 / [JSOI2011] 括号序列", "background": null, "description": "一个合法的括号序列是这样定义的：\n\n1.    空串是合法的。\n2.    如果字符串 `S` 是合法的，则`(S)`也是合法的。\n3.    如果字符串 `A` 和 `B` 是合法的，则 `AB` 也是合法的。\n\n现在给你一个长度为 $n$ 的由`(`和`)`组成的字符串，位置标号从 $1$ 到 $n$。对这个字符串有下列四种操作：\n\n\n-  `Replace a b c`：将 $[a,b]$ 之间的所有括号改成 $c$。假设原来的字符串为：`))())())(`，那么执行操作 `Replace 2 7 (`  后原来的字符串变为：`)(((((()(`。\n\n-  `Swap a b`：将 $[a,b]$ 之间的字符串翻转。假设原来的字符串为：`))())())(`，那么执行操作 `Swap 3 5` 后原来的字符串变为：`))))(())(`。\n\n-  `Invert a b`：将 $[a,b]$ 之间的 `(` 变成 `)` ，`)` 变成 `(`。假设原来的字符串为：`))())())(`，那么执行操作 `Invert 4 8` 后原来的字符串变为：`))((()(((`。\n\n-  `Query a b`：询问 $[a,b]$ 之间的字符串至少要改变多少位才能变成合法的括号序列。改变某位是指将该位的 `(` 变成 `)` 或 `)` 变成 `(`。注意执行操作 `Query` 并不改变当前的括号序列。假设原来的字符串为：`))())())(`，那么执行操作 `Query 3 6` 的结果为 $2$，因为要将位置 $5$ 的`)`变成`(`并将位置 $6$ 的`(`变成`)`。", "inputFormat": "输入文件的第一行是用空格隔开的两个正整数 $n,q$，分别表示字符串的长度和将执行的操作个数。  \n\n第二行是长度为 $n$ 的初始字符串 $S$。接下来的 $q$ 行是将依次执行的 $q$ 个操作，其中操作名与操作数之间以及相邻操作数之间均用空格隔开。", "outputFormat": "对于每个 `Query` 操作，输出一行一个整数表示答案。输入数据保证有解。", "hint": "### 样例解释\n\n输入中有 $2$ 个 `Query` 操作，所以输出有 $2$ 行。   \n执行第一个 `Query` 操作时的括号序列为 `))((`，因改变第 $1$ 位可使 $[1,2]$ 之间的字符串变成合法的括号序列，故输出的第一行为 `1`。  \n\n执行第二个 `Query` 操作时的括号序列为 `)(()`，因要改变第 $1$ 位和第 $2$ 位才能使 $[1,4]$ 之间的字符串变成合法的括号序列，故输出的第二行为 `2`。\n\n### 数据范围\n\n对于 $30\\%$ 的数据，$1\\le n,q \\le 3000$；   \n对于 $100\\%$ 的数据，$1\\le n,q \\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P3216", "type": "P", "difficulty": 5, "samples": [["13 13", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "递推", "2011", "各省省选", "湖南", "矩阵乘法"], "title": "[HNOI2011] 数学作业", "background": "", "description": "小 C 数学成绩优异，于是老师给小 C 留了一道非常难的数学作业题：\n\n给定正整数 $n,m$，要求计算 $\\text{Concatenate}(n) \\bmod \\ m$  的值，其中 $\\text{Concatenate}(n)$ 是将 $1 \\sim n$ 所有正整数 顺序连接起来得到的数。\n\n例如，$n = 13$，$\\text{Concatenate}(n) = 12345678910111213$。小 C 想了大半天终于意识到这是一道不可能手算出来的题目，于是他只好向你求助，希望你能编写一个程序帮他解决这个问题。\n\n", "inputFormat": "一行两个正整数 $n,m$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "【数据范围】\n\n对于 $30\\%$ 的数据，$1\\le n \\le 10^6$；  \n对于 $100\\%$ 的数据，$1\\le n \\le 10^{18}$，$1\\le m \\le 10^9$。\n\n- 2023.4.20 添加一组 hack 数据。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2011] Math Homework", "background": "", "description": "Xiao C excels in math, so the teacher assigned him a very difficult math homework problem:\n\nGiven positive integers $n,m$, compute $\\text{Concatenate}(n) \\bmod \\ m$, where $\\text{Concatenate}(n)$ is the number obtained by concatenating all positive integers $1 \\sim n$ in order.\n\nFor example, $n = 13$, $\\text{Concatenate}(n) = 12345678910111213$. After thinking for a long time, Xiao C realized that this problem is impossible to work out by hand, so he asks you to write a program to solve it for him.", "inputFormat": "One line with two positive integers $n,m$.", "outputFormat": "Output one integer on a single line representing the answer.", "hint": "Constraints\n\nFor $30\\%$ of the testdata, $1\\le n \\le 10^6$.  \nFor $100\\%$ of the testdata, $1\\le n \\le 10^{18}$, $1\\le m \\le 10^9$.\n\n- On 2023.4.20, one set of hack testdata was added.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2011] 数学作业", "background": "", "description": "小 C 数学成绩优异，于是老师给小 C 留了一道非常难的数学作业题：\n\n给定正整数 $n,m$，要求计算 $\\text{Concatenate}(n) \\bmod \\ m$  的值，其中 $\\text{Concatenate}(n)$ 是将 $1 \\sim n$ 所有正整数 顺序连接起来得到的数。\n\n例如，$n = 13$，$\\text{Concatenate}(n) = 12345678910111213$。小 C 想了大半天终于意识到这是一道不可能手算出来的题目，于是他只好向你求助，希望你能编写一个程序帮他解决这个问题。\n\n", "inputFormat": "一行两个正整数 $n,m$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "【数据范围】\n\n对于 $30\\%$ 的数据，$1\\le n \\le 10^6$；  \n对于 $100\\%$ 的数据，$1\\le n \\le 10^{18}$，$1\\le m \\le 10^9$。\n\n- 2023.4.20 添加一组 hack 数据。", "locale": "zh-CN"}}}
{"pid": "P3217", "type": "P", "difficulty": 6, "samples": [["8\n-2 3\n-2 -1\n0 3\n0 -1\n1 -1\n2 1 \n-3 1 \n-2 1\n", "10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["计算几何", "2011", "各省省选", "湖南", "枚举", "排序"], "title": "[HNOI2011] 数矩形", "background": null, "description": "最近某歌手在研究自己的全球巡回演出计划，他将所有心仪的城市都用平面上的一个点来表示，并打算从中挑选出 $4$ 个城市作为这次巡回演出的地点。\n\n为了显示自己与众不同，他要求存在一个矩形使得挑选出的 $4$ 个点恰好是这个矩形的 $4$ 个顶点，并且希望这个矩形的面积最大。\n\n这可急坏了其经纪人，于是他向全球歌迷征集方案，当然你这位歌迷一定不会错过这个机会。", "inputFormat": "输入的第一行是一个正整数 $N$，表示平面上点的个数（即歌手心仪的城市数）。接下来的 $N$ 行，每行是由空格隔开的两个整数 $X_i$ 和 $Y_i$，表示城市的坐标。", "outputFormat": "输出仅包含一个非负整数，表示最大的矩形面积。", "hint": "- $20\\%$ 的数据满足 $N\\leq 500$\n- $100\\%$ 的数据满足 $N\\leq 1500$，$-10^8\\leq X_i,Y_i\\leq 10^8$\n\n输入数据保证答案存在。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2011] Counting Rectangles", "background": "", "description": "A certain singer is planning a world tour. He represents each city he likes as a point on the plane and plans to select $4$ cities as the tour stops.\n\nTo be unique, he requires that there exists a rectangle such that the selected $4$ points are exactly the $4$ vertices of this rectangle, and he wants the area of this rectangle to be as large as possible.\n\nThis worries his agent, so he asks fans worldwide for solutions. Of course, you will not miss this opportunity.", "inputFormat": "The first line contains a positive integer $N$, the number of points on the plane (i.e., the number of cities the singer likes). The next $N$ lines each contain two integers $X_i$ and $Y_i$, separated by a space, representing the coordinates of a city.", "outputFormat": "Output a single non-negative integer, the maximum area of such a rectangle.", "hint": "- 20% of the testdata satisfies $N \\leq 500$.\n- 100% of the testdata satisfies $N \\leq 1500$, $-10^8 \\leq X_i, Y_i \\leq 10^8$.\n- The input guarantees that an answer exists.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2011] 数矩形", "background": null, "description": "最近某歌手在研究自己的全球巡回演出计划，他将所有心仪的城市都用平面上的一个点来表示，并打算从中挑选出 $4$ 个城市作为这次巡回演出的地点。\n\n为了显示自己与众不同，他要求存在一个矩形使得挑选出的 $4$ 个点恰好是这个矩形的 $4$ 个顶点，并且希望这个矩形的面积最大。\n\n这可急坏了其经纪人，于是他向全球歌迷征集方案，当然你这位歌迷一定不会错过这个机会。", "inputFormat": "输入的第一行是一个正整数 $N$，表示平面上点的个数（即歌手心仪的城市数）。接下来的 $N$ 行，每行是由空格隔开的两个整数 $X_i$ 和 $Y_i$，表示城市的坐标。", "outputFormat": "输出仅包含一个非负整数，表示最大的矩形面积。", "hint": "- $20\\%$ 的数据满足 $N\\leq 500$\n- $100\\%$ 的数据满足 $N\\leq 1500$，$-10^8\\leq X_i,Y_i\\leq 10^8$\n\n输入数据保证答案存在。", "locale": "zh-CN"}}}
{"pid": "P3218", "type": "P", "difficulty": 6, "samples": [["3\n10.0 1.0 150 0.0\n1\n100.0 -100.0\n10.0 100.0 150 1.0\n2\n100 0\n100 100\n0.5 0.1 100 10\n3\n1000 0\n100 10\n100 -10", "1.41421\nIMPOSSIBLE\n0.07212"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "各省省选", "湖南"], "title": "[HNOI2011] 赛车游戏", "background": "", "description": "名歌手LAALA最近迷上了一款赛车游戏，游戏中开车的玩家在不同的路段需要选择不同的速度，使得自己在最短的时间内到达终点。开始游戏时，车内的初始油量为f，所以游戏的关键是如何在速度和耗油量之间实现平衡。\n\n\nLAALA 经过一段时间的研究后，发现这款游戏可以用一个简单的数学模型来描述，具体来说：从起点到终点的路线可以被简化成折线段，每条线段代表一个上坡或者下坡，若在一段斜率为 s(s>0 代表上坡，s=0 代表平地，s<0 代表下坡)的道路上以速度 v km/h 行驶，则每公里的耗油量为 max(0,av+bs)，其中 a 和 b 为游戏的内置参数，分别表示在平地行驶时的耗油率及斜坡对耗油量的影响(b 恒为正)。这里假设，加速和减速不耗油，且看成是瞬间完成的，所以即使在同一条线段上也可采取以不同的速度行驶的策略来缩短耗费的时间。\n\n\n由于 LAALA 在以前的游戏中表现不佳，现在使用的车型依然是系统初始分配的，所以它的速度不能超过 vmax km/h。在获得这些参数后，LAALA 想知道在初始油量受限的情况下（中途不许加油）自己能得到的最佳成绩是多少。作为 LAALA 的歌迷，你能帮帮他吗?\n", "inputFormat": "从文件input.txt中读入数据，输入文件的第一行是一个正整数T，表示数据组数。对每组数据，第一行是用空格隔开的4个浮点数a、b、vmax和f，其中a、b和vmax的意义如前所述，f表示初始油量，其单位也与前面的描述保持一致。第二行是一个正整数r，表示线段的数目。接下来的r行，每行是用空格隔开的2个浮点数xi和yi，分别表示在标准笛卡耳坐标系下该线段在水平方向和垂直方向的改变量(单位为米)。\n", "outputFormat": "输出文件 output.txt 包含 T 行，依次对应输入中的 T 组数据。对某组数据，若基于初始油量无法到达终点，则对应行输出 IMPOSSIBLE，否则输出最少需要的时间(单位为小时)。\n", "hint": "【数据范围】\n\n\n100%的数据满足 T≤100,0.1≤a≤100,0.1≤b≤100,10≤vmax≤200,0≤f≤50,r≤10000,1≤xi≤1000,-1000≤yi≤1000，且如果问题有解，那么答案不超过 24。\n\n\n你所输出的答案需要恰好保留到小数点后 5 位,当且仅当你的输出与标准答案完全一致时你的输出才被视作正确。\n\n", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2011] Racing Game", "background": "", "description": "The famous singer LAALA recently got hooked on a racing game. In the game, the driver must choose different speeds on different road segments to reach the finish in the shortest possible time. At the start, the car has initial fuel amount $f$, so the key is to balance speed and fuel consumption.\n\nAfter some study, LAALA found that the game can be described by a simple mathematical model. The route from start to finish is simplified into a polyline, where each line segment represents an uphill or a downhill. If you drive on a road segment with slope $s$ ($s > 0$ means uphill, $s = 0$ means flat, $s < 0$ means downhill) at speed $v$ km/h, then the fuel consumption per kilometer is $\\max(0, a v + b s)$, where $a$ and $b$ are built-in parameters of the game, representing the fuel consumption rate on flat ground and the effect of slope on fuel consumption, respectively (with $b$ always positive). It is assumed that accelerating and decelerating consume no fuel and are instantaneous, so you may adopt different speeds even within the same segment to reduce the total time.\n\nBecause LAALA has not performed well in previous games, the current car is still the initial one assigned by the system, so its speed cannot exceed vmax km/h. Given these parameters, LAALA wants to know the best result possible under limited initial fuel (no refueling on the way). As a fan of LAALA, can you help?", "inputFormat": "The first line contains a positive integer $T$, the number of test cases.\n\nFor each test case:\n- The first line contains four floating-point numbers $a$, $b$, vmax, and $f$, where $a$, $b$, and vmax are as described above, and $f$ is the initial fuel amount (units consistent with the description above).\n- The second line contains a positive integer $r$, the number of line segments.\n- Each of the next $r$ lines contains two floating-point numbers $x_i$ and $y_i$, denoting the changes in the horizontal and vertical directions (in meters) of that segment in the standard Cartesian coordinate system.", "outputFormat": "Output $T$ lines, corresponding to the $T$ test cases in order. For a test case, if the finish cannot be reached with the given initial fuel, output IMPOSSIBLE. Otherwise, output the minimum required time in hours.", "hint": "Constraints:\n\nFor 100% of the testdata, $T \\le 100$, $0.1 \\le a \\le 100$, $0.1 \\le b \\le 100$, $10 \\le \\text{vmax} \\le 200$, $0 \\le f \\le 50$, $r \\le 10000$, $1 \\le x_i \\le 1000$, $-1000 \\le y_i \\le 1000$, and if the problem has a solution, the answer does not exceed $24$.\n\nYour output must have exactly 5 digits after the decimal point. Your output is considered correct if and only if it matches the standard answer exactly.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2011] 赛车游戏", "background": "", "description": "名歌手LAALA最近迷上了一款赛车游戏，游戏中开车的玩家在不同的路段需要选择不同的速度，使得自己在最短的时间内到达终点。开始游戏时，车内的初始油量为f，所以游戏的关键是如何在速度和耗油量之间实现平衡。\n\n\nLAALA 经过一段时间的研究后，发现这款游戏可以用一个简单的数学模型来描述，具体来说：从起点到终点的路线可以被简化成折线段，每条线段代表一个上坡或者下坡，若在一段斜率为 s(s>0 代表上坡，s=0 代表平地，s<0 代表下坡)的道路上以速度 v km/h 行驶，则每公里的耗油量为 max(0,av+bs)，其中 a 和 b 为游戏的内置参数，分别表示在平地行驶时的耗油率及斜坡对耗油量的影响(b 恒为正)。这里假设，加速和减速不耗油，且看成是瞬间完成的，所以即使在同一条线段上也可采取以不同的速度行驶的策略来缩短耗费的时间。\n\n\n由于 LAALA 在以前的游戏中表现不佳，现在使用的车型依然是系统初始分配的，所以它的速度不能超过 vmax km/h。在获得这些参数后，LAALA 想知道在初始油量受限的情况下（中途不许加油）自己能得到的最佳成绩是多少。作为 LAALA 的歌迷，你能帮帮他吗?\n", "inputFormat": "从文件input.txt中读入数据，输入文件的第一行是一个正整数T，表示数据组数。对每组数据，第一行是用空格隔开的4个浮点数a、b、vmax和f，其中a、b和vmax的意义如前所述，f表示初始油量，其单位也与前面的描述保持一致。第二行是一个正整数r，表示线段的数目。接下来的r行，每行是用空格隔开的2个浮点数xi和yi，分别表示在标准笛卡耳坐标系下该线段在水平方向和垂直方向的改变量(单位为米)。\n", "outputFormat": "输出文件 output.txt 包含 T 行，依次对应输入中的 T 组数据。对某组数据，若基于初始油量无法到达终点，则对应行输出 IMPOSSIBLE，否则输出最少需要的时间(单位为小时)。\n", "hint": "【数据范围】\n\n\n100%的数据满足 T≤100,0.1≤a≤100,0.1≤b≤100,10≤vmax≤200,0≤f≤50,r≤10000,1≤xi≤1000,-1000≤yi≤1000，且如果问题有解，那么答案不超过 24。\n\n\n你所输出的答案需要恰好保留到小数点后 5 位,当且仅当你的输出与标准答案完全一致时你的输出才被视作正确。\n\n", "locale": "zh-CN"}}}
{"pid": "P3219", "type": "P", "difficulty": 6, "samples": [["3\n1 1 4\n2 0 2\n3 2 2", "11.0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["计算几何", "2012", "各省省选", "平衡树", "湖南", "枚举"], "title": "[HNOI2012] 三角形覆盖问题", "background": null, "description": "二维平面中，给定 $N$ 个等腰直角三角形（每个三角形的两条直角边分别平行于坐标轴，斜边从左上到右下）。我们用三个非负整数 $(x,y,d)$ 来描述这样一个三角形，三角形三个顶点的坐标分别为 $(x,y)$，$(x+d,y)$ 和 $(x,y+d)$。要求计算这 $N$ 个三角形所覆盖的总面积。例如，下图有 $3$ 个三角形，覆盖的总面积为 $11.0$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1459ccln.png)", "inputFormat": "输入文件第一行为一个正整数 $N$，表示三角形的个数。\n\n接下来的 $N$ 行每行有用空格隔开的三个非负整数 $x,y,d$，描述一个三角形的顶点坐标，分别为 $(x,y)$，$(x+d,y)$，$(x,y+d)$，其中 $x,y,d$ 满足 $0 \\le x,y,d \\le 10^6$。", "outputFormat": "仅包含一行，为一个实数 $S$，表示所有三角形所覆盖的总面积，输出恰好保留一位小数。输入数据保证 $S \\le 2^{31}$。", "hint": "对于 $50\\%$ 的数据，$1 \\le N \\le 500$；\\\n对于 $100\\%$ 的数据，$1 \\le N \\le 10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2012] Triangle Coverage Problem", "background": "", "description": "In the two-dimensional plane, you are given $N$ isosceles right triangles (each triangle’s two legs are parallel to the coordinate axes, and the hypotenuse goes from top-left to bottom-right). We use three non-negative integers $(x, y, d)$ to describe such a triangle. The coordinates of its three vertices are $(x, y)$, $(x+d, y)$, and $(x, y+d)$. Compute the total area covered by these $N$ triangles. For example, in the figure below, there are $3$ triangles, and the total covered area is $11.0$.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1459ccln.png)", "inputFormat": "The first line contains a positive integer $N$, indicating the number of triangles.\nEach of the next $N$ lines contains three space-separated non-negative integers $x, y, d$, describing a triangle whose vertices are $(x, y)$, $(x+d, y)$, and $(x, y+d)$, where $x, y, d$ satisfy $0 \\le x, y, d \\le 10^6$.", "outputFormat": "Output a single line containing a real number $S$, the total area covered by all triangles, with exactly one decimal place. It is guaranteed that $S \\le 2^{31}$.", "hint": "For $50\\%$ of the testdata, $1 \\le N \\le 500$.\nFor $100\\%$ of the testdata, $1 \\le N \\le 10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2012] 三角形覆盖问题", "background": null, "description": "二维平面中，给定 $N$ 个等腰直角三角形（每个三角形的两条直角边分别平行于坐标轴，斜边从左上到右下）。我们用三个非负整数 $(x,y,d)$ 来描述这样一个三角形，三角形三个顶点的坐标分别为 $(x,y)$，$(x+d,y)$ 和 $(x,y+d)$。要求计算这 $N$ 个三角形所覆盖的总面积。例如，下图有 $3$ 个三角形，覆盖的总面积为 $11.0$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1459ccln.png)", "inputFormat": "输入文件第一行为一个正整数 $N$，表示三角形的个数。\n\n接下来的 $N$ 行每行有用空格隔开的三个非负整数 $x,y,d$，描述一个三角形的顶点坐标，分别为 $(x,y)$，$(x+d,y)$，$(x,y+d)$，其中 $x,y,d$ 满足 $0 \\le x,y,d \\le 10^6$。", "outputFormat": "仅包含一行，为一个实数 $S$，表示所有三角形所覆盖的总面积，输出恰好保留一位小数。输入数据保证 $S \\le 2^{31}$。", "hint": "对于 $50\\%$ 的数据，$1 \\le N \\le 500$；\\\n对于 $100\\%$ 的数据，$1 \\le N \\le 10^4$。", "locale": "zh-CN"}}}
{"pid": "P3220", "type": "P", "difficulty": 6, "samples": [["3  3 1 4\n3  4 5", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "并查集", "各省省选", "湖南", "位运算", "构造"], "title": "[HNOI2012] 与非", "background": "如果你能提供题面或者题意简述，请直接在讨论区发帖，感谢你的贡献。\n", "description": "NAND（与非）是一种二元逻辑运算，其运算结果为真当且仅当两个输入的布尔值不全为真。NAND运算的真值表如下（1表示真，0表示假）:\n\n ![](https://cdn.luogu.com.cn/upload/pic/7851.png) \n\n两个非负整数的NAND是指将它们表示成二进制数，再在对应的二进制位进行NAND运算。由于两个二进制数的长度可能不等，因此一般约定一个最高位K，使得两个数的二进制表示都不 超过K位，不足K位的在高位补零。给定N个非负整数A1,A2......AN和约定位数K，利用NAND运算与括号，每个数可以使用任意次，请你求出范围[L,R]内可以被计算出的数有多少个。\n", "inputFormat": "输入文件第一行是用空格隔开的四个正整数N，K，L和R，接下来的一行是N个非负整数A1,A2......AN，其含义如上所述。 100%的数据满足K<=60且N<=1000,0<=Ai<=2^k-1,0<=L<=R<=10^18\n", "outputFormat": "仅包含一个整数，表示[L,R]内可以被计算出的数的个数\n", "hint": "样例1中，(3 NAND 4) NAND (3 NAND 5) = 1，5 NAND 5 = 2，3和4直接可得。\n", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2012] NAND", "background": "If you can provide the full statement or a brief description of the problem, please post it directly in the discussion area. Thank you for your contribution.", "description": "NAND is a binary logical operation whose result is true if and only if the two input Boolean values are not both true. The truth table of the NAND operation is as follows (1 denotes true, 0 denotes false):\n\n![](https://cdn.luogu.com.cn/upload/pic/7851.png)\n\nThe NAND of two non-negative integers means writing them in binary and then applying the NAND operation bitwise on corresponding binary digits. Since the lengths of the two binary numbers may differ, we generally fix a most significant bit limit $K$ so that the binary representations of both numbers do not exceed $K$ bits; numbers shorter than $K$ bits are padded with leading zeros on the left.\n\nGiven $N$ non-negative integers $A_1, A_2, \\ldots, A_N$ and the designated bit-length $K$, using NAND operations and parentheses, where each number may be used any number of times, please determine how many numbers in the range $[L, R]$ can be obtained.", "inputFormat": "The first line contains four positive integers $N$, $K$, $L$, and $R$ separated by spaces.  \nThe second line contains $N$ non-negative integers $A_1, A_2, \\ldots, A_N$, as described above.\n\nConstraints: $K \\le 60$ and $N \\le 1000$, $0 \\le A_i \\le 2^K - 1$, $0 \\le L \\le R \\le 10^{18}$.", "outputFormat": "Output a single integer, the number of values in $[L, R]$ that can be computed.", "hint": "In Sample 1, $(3 \\text{ NAND } 4) \\text{ NAND } (3 \\text{ NAND } 5) = 1$, $5 \\text{ NAND } 5 = 2$, and $3$ and $4$ can be obtained directly.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2012] 与非", "background": "如果你能提供题面或者题意简述，请直接在讨论区发帖，感谢你的贡献。\n", "description": "NAND（与非）是一种二元逻辑运算，其运算结果为真当且仅当两个输入的布尔值不全为真。NAND运算的真值表如下（1表示真，0表示假）:\n\n ![](https://cdn.luogu.com.cn/upload/pic/7851.png) \n\n两个非负整数的NAND是指将它们表示成二进制数，再在对应的二进制位进行NAND运算。由于两个二进制数的长度可能不等，因此一般约定一个最高位K，使得两个数的二进制表示都不 超过K位，不足K位的在高位补零。给定N个非负整数A1,A2......AN和约定位数K，利用NAND运算与括号，每个数可以使用任意次，请你求出范围[L,R]内可以被计算出的数有多少个。\n", "inputFormat": "输入文件第一行是用空格隔开的四个正整数N，K，L和R，接下来的一行是N个非负整数A1,A2......AN，其含义如上所述。 100%的数据满足K<=60且N<=1000,0<=Ai<=2^k-1,0<=L<=R<=10^18\n", "outputFormat": "仅包含一个整数，表示[L,R]内可以被计算出的数的个数\n", "hint": "样例1中，(3 NAND 4) NAND (3 NAND 5) = 1，5 NAND 5 = 2，3和4直接可得。\n", "locale": "zh-CN"}}}
{"pid": "P3221", "type": "P", "difficulty": 6, "samples": [["6  8\n12\n1  2\n1  3\n1  4\n1  6\n2  2\n3  2\n3  3\n3  4\n3  7\n6  4\n6  6\n4  8", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "各省省选", "湖南"], "title": "[HNOI2012] 双十字", "background": "", "description": "在 C 部落，双十字是非常重要的一个部落标志。所谓双十字，如下面两个例子，由两条水平的和一条竖直的 `1` 线段组成：\n\n```\n..........\n....1.....      ..1..\n..11111...      .111.\n....1.....      ..1..\n.1111111..      11111\n....1.....      ..1..\n....1.....\n..........\n```\n\n合法的双十字要求满足以下几个限制：\n- 两条水平的线段不能在相邻的两行。\n- 竖直线段上端必须严格高于两条水平线段，下端必须严格低于两条水平线段。\n- 竖直线段必须将两条水平线段严格划分成相等的两半。\n- 上方的水平线段必须严格短于下方的水平线段。\n\n所以上面右边的例子是满足要求的最小的双十字。\n\n现在给定一个 $R\\times C$ 的 `01` 矩阵，要求计算出这个 `01` 矩阵中有多少个双十字。例如下面这个例子，`01` 矩阵如下：\n\n```\n10001011\n10111111\n10001101\n11111110\n11111111\n11101011\n```\n\n我们可以找到 $5$ 个满足条件的双十字，分别如下：\n\n```\n....1...  ....1...  ....1...\n...111..  ...111..  ...111..\n....1...  ....1...  ....1...\n..11111.  ..11111.  ....1...\n....1...  ....1...  ..11111.\n........  ....1...  ....1...\n\n....1...  ....1...\n...111..  ..11111.\n....1...  ....1...\n....1...  ....1...\n.1111111  .1111111\n....1...  ....1...\n```\n\n注意最终的结果可能很大，只要求输出双十字的个数 $\\bmod\\ 10^9+9$ 的值。", "inputFormat": "第一行为用空格隔开的两个正整数 $R$ 和 $C$，分别表示 `01` 矩阵的行数和列数。\n\n第二行是一个非负整数 $N$，表示 `01` 矩阵中 `0` 的个数。\n\n接下来的 $N$ 行，每行为用空格隔开的两个正整数 $x$ 和 $y$（$1\\le x\\le R,1\\le y\\le C$），表示 $(x,y)$ 是 `0`。数据保证 $N$ 个 `0` 的坐标两两不同。", "outputFormat": "一行一个整数，为双十字的个数 $\\bmod\\ 10^9+9$ 的值。", "hint": "对于 $100\\%$ 的数据，保证 $5\\le R,C\\le 10^4$，$0\\le N\\le 10^4$，$RC\\le 2\\times 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2012] Double Cross", "background": "", "description": "In the C tribe, the double cross is a very important tribal emblem. A double cross, as in the two examples below, consists of two horizontal segments of `1` and one vertical segment of `1`:\n\n```\n..........\n....1.....      ..1..\n..11111...      .111.\n....1.....      ..1..\n.1111111..      11111\n....1.....      ..1..\n....1.....\n..........\n```\n\nA valid double cross must satisfy the following constraints:\n- The two horizontal segments cannot be in two adjacent rows.\n- The top end of the vertical segment must be strictly above both horizontal segments, and the bottom end must be strictly below both horizontal segments.\n- The vertical segment must split each horizontal segment into two equal halves.\n- The upper horizontal segment must be strictly shorter than the lower horizontal segment.\n\nSo the example on the right above is the smallest valid double cross.\n\nNow given an $R \\times C$ `01` matrix, compute how many double crosses are in this `01` matrix. For example, consider the following `01` matrix:\n\n```\n10001011\n10111111\n10001101\n11111110\n11111111\n11101011\n```\n\nWe can find $5$ valid double crosses, shown as follows:\n\n```\n....1...  ....1...  ....1...\n...111..  ...111..  ...111..\n....1...  ....1...  ....1...\n..11111.  ..11111.  ....1...\n....1...  ....1...  ..11111.\n........  ....1...  ....1...\n\n....1...  ....1...\n...111..  ..11111.\n....1...  ....1...\n....1...  ....1...\n.1111111  .1111111\n....1...  ....1...\n```\n\nNote that the final result can be large; output the number of double crosses $\\bmod\\ 10^9+9$.", "inputFormat": "The first line contains two positive integers $R$ and $C$, separated by a space, denoting the numbers of rows and columns of the `01` matrix.\n\nThe second line contains a non-negative integer $N$, denoting the number of `0` in the `01` matrix.\n\nEach of the next $N$ lines contains two positive integers $x$ and $y$ ($1 \\le x \\le R, 1 \\le y \\le C$), indicating that $(x, y)$ is `0`. It is guaranteed that the coordinates of the $N$ zeros are pairwise distinct.", "outputFormat": "Output a single integer: the number of double crosses $\\bmod\\ 10^9+9$.", "hint": "For $100\\%$ of the testdata, it is guaranteed that $5 \\le R, C \\le 10^4$, $0 \\le N \\le 10^4$, and $RC \\le 2 \\times 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2012] 双十字", "background": "", "description": "在 C 部落，双十字是非常重要的一个部落标志。所谓双十字，如下面两个例子，由两条水平的和一条竖直的 `1` 线段组成：\n\n```\n..........\n....1.....      ..1..\n..11111...      .111.\n....1.....      ..1..\n.1111111..      11111\n....1.....      ..1..\n....1.....\n..........\n```\n\n合法的双十字要求满足以下几个限制：\n- 两条水平的线段不能在相邻的两行。\n- 竖直线段上端必须严格高于两条水平线段，下端必须严格低于两条水平线段。\n- 竖直线段必须将两条水平线段严格划分成相等的两半。\n- 上方的水平线段必须严格短于下方的水平线段。\n\n所以上面右边的例子是满足要求的最小的双十字。\n\n现在给定一个 $R\\times C$ 的 `01` 矩阵，要求计算出这个 `01` 矩阵中有多少个双十字。例如下面这个例子，`01` 矩阵如下：\n\n```\n10001011\n10111111\n10001101\n11111110\n11111111\n11101011\n```\n\n我们可以找到 $5$ 个满足条件的双十字，分别如下：\n\n```\n....1...  ....1...  ....1...\n...111..  ...111..  ...111..\n....1...  ....1...  ....1...\n..11111.  ..11111.  ....1...\n....1...  ....1...  ..11111.\n........  ....1...  ....1...\n\n....1...  ....1...\n...111..  ..11111.\n....1...  ....1...\n....1...  ....1...\n.1111111  .1111111\n....1...  ....1...\n```\n\n注意最终的结果可能很大，只要求输出双十字的个数 $\\bmod\\ 10^9+9$ 的值。", "inputFormat": "第一行为用空格隔开的两个正整数 $R$ 和 $C$，分别表示 `01` 矩阵的行数和列数。\n\n第二行是一个非负整数 $N$，表示 `01` 矩阵中 `0` 的个数。\n\n接下来的 $N$ 行，每行为用空格隔开的两个正整数 $x$ 和 $y$（$1\\le x\\le R,1\\le y\\le C$），表示 $(x,y)$ 是 `0`。数据保证 $N$ 个 `0` 的坐标两两不同。", "outputFormat": "一行一个整数，为双十字的个数 $\\bmod\\ 10^9+9$ 的值。", "hint": "对于 $100\\%$ 的数据，保证 $5\\le R,C\\le 10^4$，$0\\le N\\le 10^4$，$RC\\le 2\\times 10^6$。", "locale": "zh-CN"}}}
{"pid": "P3222", "type": "P", "difficulty": 6, "samples": [["5\n2  8 12\n5  4 5\n3  8 10\n6  2 3\n1  3 7", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "二分", "各省省选", "湖南", "凸包", "半平面交"], "title": "[HNOI2012] 射箭", "background": "", "description": "沫沫最近在玩一个二维的射箭游戏，如下图 $1$ 所示，这个游戏中的 $x$ 轴在地面，第一象限中有一些竖直线段作为靶子，任意两个靶子都没有公共部分，也不会接触坐标轴。\n\n沫沫控制一个位于 $(0,0)$ 的弓箭手，可以朝 $0$ 至 $90$ 中的任意角度（不包括 $0$ 度和 $90$ 度），以任意大小的力量射出带有穿透能力的光之箭。由于游戏中没有空气阻力，并且光之箭没有箭身，箭的轨迹会是一条标准的抛物线，被轨迹穿过的所有靶子都认为被沫沫射中了，包括那些只有端点被射中的靶子。\n\n这个游戏有多种模式，其中沫沫最喜欢的是闯关模式。\n\n在闯关模式中，第一关只有一个靶子，射中这个靶子即可进入第二关，这时在第一关的基础上会出现另外一个靶子，若能够一箭双雕射中这两个靶子便可进入第三关，这时会出现第三个靶子。依此类推，每过一关都会新出现一个靶子，在第 $K$ 关必须一箭射中前 $K$ 关出现的所有 $K$ 个靶子才能进入第 $K+1$ 关，否则游戏结束。\n\n沫沫花了很多时间在这个游戏上，却最多只能玩到第七关“七星连珠”，这让她非常困惑。于是她设法获得了每一关出现的靶子的位置，想让你告诉她，最多能通过多少关？", "inputFormat": "输入文件第一行是一个正整数 $N$，表示一共有 $N$ 关。\n\n接下来有 $N$ 行，第 $i+1$ 行是用空格隔开的三个正整数 $x_i,y_{i1},y_{i2}\\ (y_{i1}<y_{i2})$，表示第 $i$ 关出现的靶子的横坐标是 $x_i$，纵坐标的范围是从 $y_{i1}$ 到 $y_{i2}$。", "outputFormat": "仅包含一个整数，表示最多的通关数。\n", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/jv279yqz.png)\n\n### 数据范围及约定\n\n- $30\\%$ 的数据满足 $N \\le 100$；\n- $50\\%$ 的数据满足 $N \\le 5000$；\n- $100\\%$ 的数据满足 $N \\le 100000$ 且给出的所有坐标不超过 $10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2012] Archery", "background": "", "description": "Momo is playing a 2D archery game, as shown in Figure 1. In this game, the x-axis lies on the ground, and in the first quadrant there are several vertical segments serving as targets. Any two targets are disjoint, and none of them touch the coordinate axes.\n\nMomo controls an archer located at $(0, 0)$. She can shoot an arrow of light with piercing ability at any angle between 0 and 90 degrees (excluding 0 degrees and 90 degrees), with any power. Since there is no air resistance in the game and the arrow of light has no shaft, the trajectory is a standard parabola. All targets crossed by the trajectory are considered hit, including those whose endpoints are hit only.\n\nThis game has multiple modes, and Momo’s favorite is the challenge mode.\n\nIn challenge mode, the first level has only one target. Hitting this target allows her to enter level two, where one more target appears in addition to the first one. If she can hit both targets with a single shot, she can enter level three, where a third target appears. And so on: at each level, a new target appears. At level $K$, she must hit all $K$ targets that have appeared in the first $K$ levels with a single shot to enter level $K+1$; otherwise, the game ends.\n\nMomo has spent a lot of time on this game, but she can only reach level seven, “Seven Stars in a Row,” which confuses her. She has obtained the positions of the targets that appear in each level and wants you to tell her the maximum number of levels she can pass.", "inputFormat": "The first line of input contains a positive integer $N$, indicating that there are $N$ levels.\n\nThe next $N$ lines follow. Line $i+1$ contains three positive integers $x_i, y_{i1}, y_{i2}\\ (y_{i1}<y_{i2})$, meaning that in level $i$ the target’s x-coordinate is $x_i$, and its y-range is from $y_{i1}$ to $y_{i2}$.", "outputFormat": "Output a single integer, the maximum number of levels that can be cleared.", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/jv279yqz.png)\n\nConstraints:\n- 30% of the testdata satisfy $N \\le 100$.\n- 50% of the testdata satisfy $N \\le 5000$.\n- 100% of the testdata satisfy $N \\le 100000$, and all given coordinates do not exceed $10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2012] 射箭", "background": "", "description": "沫沫最近在玩一个二维的射箭游戏，如下图 $1$ 所示，这个游戏中的 $x$ 轴在地面，第一象限中有一些竖直线段作为靶子，任意两个靶子都没有公共部分，也不会接触坐标轴。\n\n沫沫控制一个位于 $(0,0)$ 的弓箭手，可以朝 $0$ 至 $90$ 中的任意角度（不包括 $0$ 度和 $90$ 度），以任意大小的力量射出带有穿透能力的光之箭。由于游戏中没有空气阻力，并且光之箭没有箭身，箭的轨迹会是一条标准的抛物线，被轨迹穿过的所有靶子都认为被沫沫射中了，包括那些只有端点被射中的靶子。\n\n这个游戏有多种模式，其中沫沫最喜欢的是闯关模式。\n\n在闯关模式中，第一关只有一个靶子，射中这个靶子即可进入第二关，这时在第一关的基础上会出现另外一个靶子，若能够一箭双雕射中这两个靶子便可进入第三关，这时会出现第三个靶子。依此类推，每过一关都会新出现一个靶子，在第 $K$ 关必须一箭射中前 $K$ 关出现的所有 $K$ 个靶子才能进入第 $K+1$ 关，否则游戏结束。\n\n沫沫花了很多时间在这个游戏上，却最多只能玩到第七关“七星连珠”，这让她非常困惑。于是她设法获得了每一关出现的靶子的位置，想让你告诉她，最多能通过多少关？", "inputFormat": "输入文件第一行是一个正整数 $N$，表示一共有 $N$ 关。\n\n接下来有 $N$ 行，第 $i+1$ 行是用空格隔开的三个正整数 $x_i,y_{i1},y_{i2}\\ (y_{i1}<y_{i2})$，表示第 $i$ 关出现的靶子的横坐标是 $x_i$，纵坐标的范围是从 $y_{i1}$ 到 $y_{i2}$。", "outputFormat": "仅包含一个整数，表示最多的通关数。\n", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/jv279yqz.png)\n\n### 数据范围及约定\n\n- $30\\%$ 的数据满足 $N \\le 100$；\n- $50\\%$ 的数据满足 $N \\le 5000$；\n- $100\\%$ 的数据满足 $N \\le 100000$ 且给出的所有坐标不超过 $10^9$。", "locale": "zh-CN"}}}
{"pid": "P3223", "type": "P", "difficulty": 4, "samples": [["1  1", "12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "高精度", "2012", "各省省选", "湖南", "组合数学"], "title": "[HNOI2012] 排队", "background": "", "description": "某中学有 $n$ 名男同学，$m$ 名女同学和两名老师要排队参加体检。他们排成一条直线，并且任意两名女同学不能相邻，两名老师也不能相邻，那么一共有多少种排法呢？（注意：任意两个人都是不同的）\n", "inputFormat": "只有一行且为用空格隔开的两个非负整数 $n$ 和 $m$，其含义如上所述。 ", "outputFormat": "仅一个非负整数，表示不同的排法个数。注意答案可能很大。\n", "hint": "对于 $30\\%$ 的数据 $n\\leq 100$，$m\\leq 100$。\n\n对于 $100\\%$ 的数据 $n\\leq 2000$，$m\\leq 2000$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2012] Queue", "background": "", "description": "A certain middle school has $n$ boys, $m$ girls, and two teachers who are to line up for a physical examination. They form a single straight line, and no two girls may stand adjacent, and the two teachers may not be adjacent either. How many different lineups are there? (Note: every individual is distinct.)", "inputFormat": "A single line containing two non-negative integers $n$ and $m$, separated by a space, as described above.", "outputFormat": "A single non-negative integer, denoting the number of different lineups. Note that the answer may be large.", "hint": "For $30\\%$ of the testdata, $n \\leq 100$, $m \\leq 100$.\n\nFor $100\\%$ of the testdata, $n \\leq 2000$, $m \\leq 2000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2012] 排队", "background": "", "description": "某中学有 $n$ 名男同学，$m$ 名女同学和两名老师要排队参加体检。他们排成一条直线，并且任意两名女同学不能相邻，两名老师也不能相邻，那么一共有多少种排法呢？（注意：任意两个人都是不同的）\n", "inputFormat": "只有一行且为用空格隔开的两个非负整数 $n$ 和 $m$，其含义如上所述。 ", "outputFormat": "仅一个非负整数，表示不同的排法个数。注意答案可能很大。\n", "hint": "对于 $30\\%$ 的数据 $n\\leq 100$，$m\\leq 100$。\n\n对于 $100\\%$ 的数据 $n\\leq 2000$，$m\\leq 2000$。\n", "locale": "zh-CN"}}}
{"pid": "P3224", "type": "P", "difficulty": 6, "samples": [["5 1\n4 3 2 5 1\n1 2\n7\nQ 3 2\nQ 2 1\nB 2 3\nB 1 5\nQ 2 1\nQ 2 4\nQ 2 3\n", "-1\n2\n5\n1\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2012", "线段树", "并查集", "各省省选", "平衡树", "湖南", "线段树合并", "启发式合并"], "title": "[HNOI2012] 永无乡", "background": "", "description": "永无乡包含 $n$ 座岛，编号从 $1$ 到 $n$ ，每座岛都有自己的独一无二的重要度，按照重要度可以将这 $n$ 座岛排名，名次用 $1$  到 $n$ 来表示。某些岛之间由巨大的桥连接，通过桥可以从一个岛到达另一个岛。如果从岛 $a$ 出发经过若干座（含 $0$ 座）桥可以 到达岛 $b$ ，则称岛 $a$ 和岛 $b$ 是连通的。\n\n现在有两种操作：\n\n`B x y` 表示在岛 $x$ 与岛 $y$ 之间修建一座新桥。\n\n`Q x k` 表示询问当前与岛 $x$ 连通的所有岛中第 $k$ 重要的是哪座岛，即所有与岛 $x$ 连通的岛中重要度排名第 $k$ 小的岛是哪座，请你输出那个岛的编号。", "inputFormat": "第一行是用空格隔开的两个整数，分别表示岛的个数 $n$ 以及一开始存在的桥数 $m$。\n\n第二行有 $n$ 个整数，第 $i$ 个整数表示编号为 $i$ 的岛屿的排名 $p_i$。\n\n接下来 $m$ 行，每行两个整数 $u, v$，表示一开始存在一座连接编号为 $u$ 的岛屿和编号为 $v$ 的岛屿的桥。\n\n接下来一行有一个整数，表示操作个数 $q$。\n\n接下来 $q$ 行，每行描述一个操作。每行首先有一个字符 $op$，表示操作类型，然后有两个整数 $x, y$。\n- 若 $op$ 为 `Q`，则表示询问所有与岛 $x$ 连通的岛中重要度排名第 $y$ 小的岛是哪座，请你输出那个岛的编号。\n- 若 $op$ 为 `B`，则表示在岛 $x$ 与岛 $y$ 之间修建一座新桥。\n", "outputFormat": "对于每个询问操作都要依次输出一行一个整数，表示所询问岛屿的编号。如果该岛屿不存在，则输出 $-1$ 。", "hint": "### 数据规模与约定\n\n- 对于 $20\\%$ 的数据，保证 $n \\leq 10^3$, $q \\leq 10^3$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq m \\leq n \\leq 10^5$, $1 \\leq q \\leq 3 \\times 10^5$，$p$ 为一个 $1 \\sim n$ 的排列，$op \\in \\{\\texttt Q, \\texttt B\\}$，$1 \\leq u, v, x, y \\leq n$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2012] Neverland", "background": "", "description": "Neverland contains $n$ islands, numbered from $1$ to $n$. Each island has its own unique importance. According to importance, these $n$ islands can be ranked, with ranks from $1$ to $n$. Some islands are connected by large bridges, through which one can travel from one island to another. If starting from island $a$ you can reach island $b$ after crossing several (including $0$) bridges, then islands $a$ and $b$ are said to be connected.\n\nThere are two operations:\n\n`B x y` means building a new bridge between island $x$ and island $y$.\n\n`Q x k` asks which island currently ranks the $k$-th by importance among all islands connected to island $x$, i.e., among all islands connected to $x$, which island has the $k$-th smallest importance rank. Please output the index of that island.", "inputFormat": "The first line contains two integers separated by a space, representing the number of islands $n$ and the initial number of bridges $m$.\n\nThe second line contains $n$ integers; the $i$-th integer is the rank $p_i$ of island $i$.\n\nThe next $m$ lines each contain two integers $u, v$, indicating that initially there is a bridge connecting island $u$ and island $v$.\n\nThe next line contains an integer, the number of operations $q$.\n\nThe next $q$ lines each describe an operation. Each line first contains a character $op$ indicating the operation type, followed by two integers $x, y$.\n- If $op$ is `Q`, it asks which island ranks the $y$-th smallest by importance among all islands connected to $x$; output the index of that island.\n- If $op$ is `B`, it means building a new bridge between island $x$ and island $y$.", "outputFormat": "For each query operation, output one integer on a separate line, indicating the index of the island being asked for. If such an island does not exist, output $-1$.", "hint": "### Constraints\n\n- For $20\\%$ of the testdata, $n \\leq 10^3$, $q \\leq 10^3$.\n- For $100\\%$ of the testdata, $1 \\leq m \\leq n \\leq 10^5$, $1 \\leq q \\leq 3 \\times 10^5$, $p$ is a permutation of $1 \\sim n$, $op \\in \\{\\texttt Q, \\texttt B\\}$, $1 \\leq u, v, x, y \\leq n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2012] 永无乡", "background": "", "description": "永无乡包含 $n$ 座岛，编号从 $1$ 到 $n$ ，每座岛都有自己的独一无二的重要度，按照重要度可以将这 $n$ 座岛排名，名次用 $1$  到 $n$ 来表示。某些岛之间由巨大的桥连接，通过桥可以从一个岛到达另一个岛。如果从岛 $a$ 出发经过若干座（含 $0$ 座）桥可以 到达岛 $b$ ，则称岛 $a$ 和岛 $b$ 是连通的。\n\n现在有两种操作：\n\n`B x y` 表示在岛 $x$ 与岛 $y$ 之间修建一座新桥。\n\n`Q x k` 表示询问当前与岛 $x$ 连通的所有岛中第 $k$ 重要的是哪座岛，即所有与岛 $x$ 连通的岛中重要度排名第 $k$ 小的岛是哪座，请你输出那个岛的编号。", "inputFormat": "第一行是用空格隔开的两个整数，分别表示岛的个数 $n$ 以及一开始存在的桥数 $m$。\n\n第二行有 $n$ 个整数，第 $i$ 个整数表示编号为 $i$ 的岛屿的排名 $p_i$。\n\n接下来 $m$ 行，每行两个整数 $u, v$，表示一开始存在一座连接编号为 $u$ 的岛屿和编号为 $v$ 的岛屿的桥。\n\n接下来一行有一个整数，表示操作个数 $q$。\n\n接下来 $q$ 行，每行描述一个操作。每行首先有一个字符 $op$，表示操作类型，然后有两个整数 $x, y$。\n- 若 $op$ 为 `Q`，则表示询问所有与岛 $x$ 连通的岛中重要度排名第 $y$ 小的岛是哪座，请你输出那个岛的编号。\n- 若 $op$ 为 `B`，则表示在岛 $x$ 与岛 $y$ 之间修建一座新桥。\n", "outputFormat": "对于每个询问操作都要依次输出一行一个整数，表示所询问岛屿的编号。如果该岛屿不存在，则输出 $-1$ 。", "hint": "### 数据规模与约定\n\n- 对于 $20\\%$ 的数据，保证 $n \\leq 10^3$, $q \\leq 10^3$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq m \\leq n \\leq 10^5$, $1 \\leq q \\leq 3 \\times 10^5$，$p$ 为一个 $1 \\sim n$ 的排列，$op \\in \\{\\texttt Q, \\texttt B\\}$，$1 \\leq u, v, x, y \\leq n$。", "locale": "zh-CN"}}}
{"pid": "P3225", "type": "P", "difficulty": 5, "samples": [["9\n1 3\n4 1\n3 5\n1 2\n2 6\n1 5\n6 3\n1 6\n3 2\n6\n1 2\n1 3\n2 4\n2 5\n3 6\n3 7\n0", "Case 1: 2 4\nCase 2: 4 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "各省省选", "湖南", "深度优先搜索 DFS", "Tarjan", "双连通分量"], "title": "[HNOI2012] 矿场搭建", "background": null, "description": "煤矿工地可以看成是由隧道连接挖煤点组成的无向图。为安全起见，希望在工地发生事故时所有挖煤点的工人都能有一条出路逃到救援出口处。于是矿主决定在某些挖煤点设立救援出口，使得无论哪一个挖煤点坍塌之后，其他挖煤点的工人都有一条道路通向救援出口。\n\n请写一个程序，用来计算至少需要设置几个救援出口，以及不同最少救援出口的设置方案总数。", "inputFormat": "输入文件有若干组数据。\n\n每组数据的第一行是一个正整数 $N\\ (N \\le 500)$，表示工地的隧道数。\n\n接下来的 $N$ 行每行是用空格隔开的两个整数 $S$ 和 $T$，表示挖煤点 $S$ 与挖煤点 $T$ 由隧道直接连接。\n\n输入数据以 $0$ 结尾。", "outputFormat": "对于每组数据，输出一行。\n\n第 $i$ 行组数据以 $\\verb!Case i: !$ 开始（注意大小写，$\\verb!Case!$ 与 $\\verb!i!$ 之间有空格，$\\verb!i!$ 与 $\\verb!:!$ 之间无空格，$\\verb!:!$ 之后有空格）。\n\n其后是用空格隔开的两个正整数，第一个正整数表示对于第 $i$ 组输入数据至少需要设置几个救援出口，第二个正整数表示对于第 $i$ 组输入数据不同最少救援出口的设置方案总数。\n\n输入数据保证答案小于 $2^{64}$。输出格式参照以下输入输出样例。", "hint": "### 样例解释\n\n- Case 1 的四组解分别是 $(2,4)$，$(3,4)$，$(4,5)$，$(4,6)$；\n- Case 2 的一组解为 $(4,5,6,7)$。\n\n### 数据范围及约定\n\n对于每组数据，设 $m$ 为各组 $S, T$ 中最大值，则有：\n\n- $1 \\le m \\le 10^3$；\n- 各组 $S, T$ 构成的集合 $V\\in[1, m] \\cap \\mathbb Z$。\n- $V$ 中任意两点连通。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2012] Building the Mine", "background": "", "description": "A coal mining site can be viewed as an undirected graph where tunnels connect mining points. For safety, we want that in case of an accident, all miners at the remaining mining points can have a way out to reach a rescue exit. Therefore, the owner decides to set up rescue exits at some mining points so that no matter which single mining point collapses, workers at all other mining points still have a path to a rescue exit.\n\nPlease write a program to compute the minimum number of rescue exits required, as well as the total number of distinct configurations that achieve this minimum.", "inputFormat": "The input file contains multiple test cases.\n\nFor each test case, the first line contains a positive integer $N\\ (N \\le 500)$, the number of tunnels.\n\nEach of the next $N$ lines contains two integers $S$ and $T$ separated by a space, indicating that mining point $S$ is directly connected to mining point $T$ by a tunnel.\n\nThe input ends with a single $0$.", "outputFormat": "For each test case, output one line.\n\nThe $i$-th test case output starts with $\\verb!Case i: !$ (note the letter case; there is a space between $\\verb!Case!$ and $\\verb!i!$, no space between $\\verb!i!$ and $\\verb!:!$, and there is one space after $\\verb!:!$).\n\nAfter that, output two space-separated positive integers: the first is the minimum number of rescue exits required for the $i$-th test case, and the second is the number of distinct configurations achieving this minimum.\n\nThe testdata guarantees the answer is less than $2^{64}$. Refer to the sample input and output format.", "hint": "### Sample Explanation\n\n- The four solutions for Case 1 are $(2, 4)$, $(3, 4)$, $(4, 5)$, $(4, 6)$.\n- One solution for Case 2 is $(4, 5, 6, 7)$.\n\n### Constraints\n\nFor each test case, let $m$ be the maximum value among all $S$ and $T$ in that case. Then:\n\n- $1 \\le m \\le 10^3$.\n- The set of vertices formed by all $S$ and $T$ values is $V \\subseteq [1, m] \\cap \\mathbb{Z}$.\n- The graph induced by $V$ is connected.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2012] 矿场搭建", "background": null, "description": "煤矿工地可以看成是由隧道连接挖煤点组成的无向图。为安全起见，希望在工地发生事故时所有挖煤点的工人都能有一条出路逃到救援出口处。于是矿主决定在某些挖煤点设立救援出口，使得无论哪一个挖煤点坍塌之后，其他挖煤点的工人都有一条道路通向救援出口。\n\n请写一个程序，用来计算至少需要设置几个救援出口，以及不同最少救援出口的设置方案总数。", "inputFormat": "输入文件有若干组数据。\n\n每组数据的第一行是一个正整数 $N\\ (N \\le 500)$，表示工地的隧道数。\n\n接下来的 $N$ 行每行是用空格隔开的两个整数 $S$ 和 $T$，表示挖煤点 $S$ 与挖煤点 $T$ 由隧道直接连接。\n\n输入数据以 $0$ 结尾。", "outputFormat": "对于每组数据，输出一行。\n\n第 $i$ 行组数据以 $\\verb!Case i: !$ 开始（注意大小写，$\\verb!Case!$ 与 $\\verb!i!$ 之间有空格，$\\verb!i!$ 与 $\\verb!:!$ 之间无空格，$\\verb!:!$ 之后有空格）。\n\n其后是用空格隔开的两个正整数，第一个正整数表示对于第 $i$ 组输入数据至少需要设置几个救援出口，第二个正整数表示对于第 $i$ 组输入数据不同最少救援出口的设置方案总数。\n\n输入数据保证答案小于 $2^{64}$。输出格式参照以下输入输出样例。", "hint": "### 样例解释\n\n- Case 1 的四组解分别是 $(2,4)$，$(3,4)$，$(4,5)$，$(4,6)$；\n- Case 2 的一组解为 $(4,5,6,7)$。\n\n### 数据范围及约定\n\n对于每组数据，设 $m$ 为各组 $S, T$ 中最大值，则有：\n\n- $1 \\le m \\le 10^3$；\n- 各组 $S, T$ 构成的集合 $V\\in[1, m] \\cap \\mathbb Z$。\n- $V$ 中任意两点连通。", "locale": "zh-CN"}}}
{"pid": "P3226", "type": "P", "difficulty": 6, "samples": [["4", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "各省省选", "湖南", "构造", "状压 DP"], "title": "[HNOI2012] 集合选数", "background": "", "description": "《集合论与图论》这门课程有一道作业题，要求同学们求出 $\\{1, 2, 3, 4, 5\\}$ 的所有满足以下条件的子集：若 $x$ 在该子集中，则 $2x$ 和 $3x$ 不能在该子集中。\n\n同学们不喜欢这种具有枚举性质的题目，于是把它变成了以下问题：对于任意一个正整数 $n\\,(1\\leq n\\leq 10^5)$，如何求出 $\\{1,2,\\dots,n\\}$ 的满足上述约束条件的子集的个数（只需输出对 $10^9+1$ 取模的结果），现在这个问题就交给你了。", "inputFormat": "只有一行，其中有一个正整数 $n$。", "outputFormat": "仅包含一个正整数，表示 $\\{1,2,\\dots,n\\}$ 有多少个满足上述约束条件的子集。", "hint": "**【样例解释】**\n \n有 $8$ 个集合满足要求，分别是 $\\varnothing$、$\\{1\\}$、$\\{1,4\\}$、$\\{2\\}$、$\\{2,3\\}$、$\\{3\\}$、$\\{3,4\\}$ 和 $\\{4\\}$。\n\n**【数据范围】**\n\n对于 $30\\%$ 的数据，$1\\le n\\le 20$。  \n对于 $100\\%$ 的数据，$1\\le n\\le 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2012] Set Selection", "background": "", "description": "The course \"Set Theory and Graph Theory\" has a homework problem asking students to find all subsets of $\\{1, 2, 3, 4, 5\\}$ that satisfy the following condition: if $x$ is in the subset, then $2x$ and $3x$ cannot be in the subset.\n\nStudents do not like such enumeration-style problems, so they turned it into the following question: for any positive integer $n\\,(1\\leq n\\leq 10^5)$, how many subsets of $\\{1,2,\\dots,n\\}$ satisfy the above constraint (you only need to output the result modulo $10^9+1$). Now this task is handed to you.", "inputFormat": "A single line containing a positive integer $n$.", "outputFormat": "Output a single positive integer, the number of subsets of $\\{1,2,\\dots,n\\}$ that satisfy the above constraint.", "hint": "Sample explanation:  \nThere are $8$ sets that meet the requirement, namely $\\varnothing$, $\\{1\\}$, $\\{1,4\\}$, $\\{2\\}$, $\\{2,3\\}$, $\\{3\\}$, $\\{3,4\\}$, and $\\{4\\}$.\n\nConstraints:  \nFor $30\\%$ of the testdata, $1 \\le n \\le 20$.  \nFor $100\\%$ of the testdata, $1 \\le n \\le 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2012] 集合选数", "background": "", "description": "《集合论与图论》这门课程有一道作业题，要求同学们求出 $\\{1, 2, 3, 4, 5\\}$ 的所有满足以下条件的子集：若 $x$ 在该子集中，则 $2x$ 和 $3x$ 不能在该子集中。\n\n同学们不喜欢这种具有枚举性质的题目，于是把它变成了以下问题：对于任意一个正整数 $n\\,(1\\leq n\\leq 10^5)$，如何求出 $\\{1,2,\\dots,n\\}$ 的满足上述约束条件的子集的个数（只需输出对 $10^9+1$ 取模的结果），现在这个问题就交给你了。", "inputFormat": "只有一行，其中有一个正整数 $n$。", "outputFormat": "仅包含一个正整数，表示 $\\{1,2,\\dots,n\\}$ 有多少个满足上述约束条件的子集。", "hint": "**【样例解释】**\n \n有 $8$ 个集合满足要求，分别是 $\\varnothing$、$\\{1\\}$、$\\{1,4\\}$、$\\{2\\}$、$\\{2,3\\}$、$\\{3\\}$、$\\{3,4\\}$ 和 $\\{4\\}$。\n\n**【数据范围】**\n\n对于 $30\\%$ 的数据，$1\\le n\\le 20$。  \n对于 $100\\%$ 的数据，$1\\le n\\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P3227", "type": "P", "difficulty": 6, "samples": [["2 2 2\n1\n6 1\n6 1\n2 6\n2 6", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "各省省选", "网络流", "湖南", "最小割"], "title": "[HNOI2013] 切糕", "background": "", "description": "经过千辛万苦小 A 得到了一块切糕，切糕的形状是长方体，小 A 打算拦腰将切糕切成两半分给小 B。出于美观考虑，小 A 希望切面能尽量光滑且和谐。于是她找到你，希望你能帮她找出最好的切割方案。\n\n出于简便考虑，我们将切糕视作一个长 $P$、宽 $Q$、高 $R$ 的长方体点阵。我们将位于第 $z$ 层中第 $x$ 行、第 $y$ 列上的点称 $(x,y,z)$，它有一个非负的不和谐值 $v(x,y,z)$。一个合法的切面满足以下两个条件：\n\n - 与每个纵轴（一共有 $P\\times Q$ 个纵轴）有且仅有一个交点。即切面是一个函数 $f(x,y)$，对于所有 $(x,y)(x\\in [1,P],y\\in[1,Q])$，我们需指定一个切割点 $f(x,y)$，且 $1\\le f(x,y)\\le R$。\n\n - 切面需要满足一定的光滑性要求，即相邻纵轴上的切割点不能相距太远。对于所有的 $1\\le x,x'\\le P$ 和 $1\\le y,y'\\le Q$，若 $|x-x'|+|y-y'|=1$，则 $|f(x,y)-f(x',y')| \\le D$，其中 $D$ 是给定的一个非负整数。\n\n可能有许多切面 $f$ 满足上面的条件，小 A 希望找出总的切割点上的不和谐值最小的那个。", "inputFormat": "第一行是三个正整数 $P,Q,R$，表示切糕的长宽高。\n\n第二行有一个非负整数 $D$，表示光滑性要求。\n\n接下来是 $R$ 个 $P$ 行 $Q$ 列的矩阵，第 $z$ 个矩阵的第 $x$ 行第 $y$ 列是 $v(x,y,z)(1\\le x\\le P,1\\le y\\le Q,1\\le z\\le R)$。", "outputFormat": "仅包含一个整数，表示在合法基础上最小的总不和谐值。", "hint": "#### 输入输出样例 1 解释\n\n最佳切面的 $f$ 为 $f(1,1)=f(2,1)=2,f(1,2)=f(2,2)=1$。\n\n---\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1 \\leq P,Q,R\\leq 40,0\\le D\\le R$，且给出的所有的不和谐值不超过 $1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2013] Qiegao", "background": "", "description": "After much effort, Xiao A obtained a piece of qiegao. The qiegao is a rectangular cuboid, and Xiao A plans to cut it in half horizontally to share it with Xiao B. For aesthetic reasons, Xiao A hopes the cutting surface can be as smooth and harmonious as possible. So she asks you to find the best cutting plan.\n\nFor simplicity, we view the qiegao as a cuboid grid with length $P$, width $Q$, and height $R$. We call the point at layer $z$, row $x$, and column $y$ the point $(x,y,z)$, and it has a nonnegative disharmony value $v(x,y,z)$. A valid cutting surface satisfies the following two conditions:\n\n- It has exactly one intersection with each vertical axis (there are $P \\times Q$ vertical axes). That is, the cutting surface is a function $f(x,y)$, and for all $(x,y)$ ($x \\in [1,P]$, $y \\in [1,Q]$), we specify a cutting point $f(x,y)$ with $1 \\le f(x,y) \\le R$.\n\n- The cutting surface needs to meet a smoothness requirement: cutting points on adjacent vertical axes cannot be too far apart. For all $1 \\le x,x' \\le P$ and $1 \\le y,y' \\le Q$, if $|x-x'|+|y-y'|=1$, then $|f(x,y)-f(x',y')| \\le D$, where $D$ is a given nonnegative integer.\n\nThere may be many cutting surfaces $f$ satisfying the above conditions. Xiao A wants the one that minimizes the total disharmony value at the cutting points.", "inputFormat": "The first line contains three positive integers $P,Q,R$, representing the length, width, and height of the qiegao.\n\nThe second line contains a nonnegative integer $D$, representing the smoothness requirement.\n\nThen follow $R$ matrices of size $P$ rows and $Q$ columns. In the $z$-th matrix, the entry at row $x$ and column $y$ is $v(x,y,z)$ ($1 \\le x \\le P$, $1 \\le y \\le Q$, $1 \\le z \\le R$).", "outputFormat": "Output a single integer, the minimal possible total disharmony value under the legality constraints.", "hint": "#### Explanation for Sample 1\n\nThe optimal cutting surface $f$ is $f(1,1)=f(2,1)=2$, $f(1,2)=f(2,2)=1$.\n\n---\n#### Constraints\n\nFor $100\\%$ of the testdata, $1 \\le P,Q,R \\le 40$, $0 \\le D \\le R$, and all given disharmony values do not exceed $1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2013] 切糕", "background": "", "description": "经过千辛万苦小 A 得到了一块切糕，切糕的形状是长方体，小 A 打算拦腰将切糕切成两半分给小 B。出于美观考虑，小 A 希望切面能尽量光滑且和谐。于是她找到你，希望你能帮她找出最好的切割方案。\n\n出于简便考虑，我们将切糕视作一个长 $P$、宽 $Q$、高 $R$ 的长方体点阵。我们将位于第 $z$ 层中第 $x$ 行、第 $y$ 列上的点称 $(x,y,z)$，它有一个非负的不和谐值 $v(x,y,z)$。一个合法的切面满足以下两个条件：\n\n - 与每个纵轴（一共有 $P\\times Q$ 个纵轴）有且仅有一个交点。即切面是一个函数 $f(x,y)$，对于所有 $(x,y)(x\\in [1,P],y\\in[1,Q])$，我们需指定一个切割点 $f(x,y)$，且 $1\\le f(x,y)\\le R$。\n\n - 切面需要满足一定的光滑性要求，即相邻纵轴上的切割点不能相距太远。对于所有的 $1\\le x,x'\\le P$ 和 $1\\le y,y'\\le Q$，若 $|x-x'|+|y-y'|=1$，则 $|f(x,y)-f(x',y')| \\le D$，其中 $D$ 是给定的一个非负整数。\n\n可能有许多切面 $f$ 满足上面的条件，小 A 希望找出总的切割点上的不和谐值最小的那个。", "inputFormat": "第一行是三个正整数 $P,Q,R$，表示切糕的长宽高。\n\n第二行有一个非负整数 $D$，表示光滑性要求。\n\n接下来是 $R$ 个 $P$ 行 $Q$ 列的矩阵，第 $z$ 个矩阵的第 $x$ 行第 $y$ 列是 $v(x,y,z)(1\\le x\\le P,1\\le y\\le Q,1\\le z\\le R)$。", "outputFormat": "仅包含一个整数，表示在合法基础上最小的总不和谐值。", "hint": "#### 输入输出样例 1 解释\n\n最佳切面的 $f$ 为 $f(1,1)=f(2,1)=2,f(1,2)=f(2,2)=1$。\n\n---\n#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1 \\leq P,Q,R\\leq 40,0\\le D\\le R$，且给出的所有的不和谐值不超过 $1000$。", "locale": "zh-CN"}}}
{"pid": "P3228", "type": "P", "difficulty": 6, "samples": [["7 3 2 997\n", "16\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2013", "各省省选", "湖南", "组合数学", "队列", "差分"], "title": "[HNOI2013] 数列", "background": null, "description": "小 T 最近在学着买股票，他得到内部消息：F 公司的股票将会疯涨。股票每天的价格已知是正整数，并且由于客观上的原因，最多只能为 $N$。在疯涨的 $K$ 天中小 T 观察到：除第一天外每天的股价都比前一天高，且高出的价格（即当天的股价与前一天的股价之差）不会超过 $M$，$M$ 为正整数。并且这些参数满足 $M(K-1)<N$。小 T 忘记了这 $K$ 天每天的具体股价了，他现在想知道这 $K$ 天的股价有多少种可能。", "inputFormat": "只有一行用空格隔开的四个数：$N$、$K$、$M$、$P$。对 $P$ 的说明参见后面“输出格式”中对 $P$ 的解释。输入保证 $20\\%$ 的数据 $M,N,K,P \\le 20000$，保证 $100\\%$ 的数据 $M,K,P \\le 10^9$，$N \\le 10^{18}$。", "outputFormat": "仅包含一个数，表示这 $K$ 天的股价的可能种数对于 $P$ 的模值。", "hint": "**样例解释**  \n\n输出样例的 $16$ 表示输入样例的股价有 $16$ 种可能：\n\n$\\{1, 2, 3\\}$，$\\{1, 2, 4\\}$，$\\{1, 3, 4\\}$，$\\{1, 3, 5\\}$，$\\{2, 3, 4\\}$，$\\{2, 3, 5\\}$，$\\{2, 4, 5\\}$，$\\{2, 4, 6\\}$，$\\{3, 4, 5\\}$，$\\{3, 4, 6\\}$，$\\{3, 5, 6\\}$，$\\{3, 5, 7\\}$，$\\{4, 5, 6\\}$，$\\{4, 5, 7\\}$，$\\{4, 6, 7\\}$，$\\{5, 6, 7\\}$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2013] Sequence", "background": "", "description": "Xiao T is learning to buy stocks. He got insider information: the stock of company F will soar. The price each day is a positive integer, and due to objective reasons, it can be at most $N$. During the $K$ days of soaring, Xiao T observed that: except for the first day, each day's price is higher than the previous day, and the increase (i.e., today's price minus yesterday's price) does not exceed $M$, where $M$ is a positive integer. Moreover, these parameters satisfy $M(K-1) < N$. Xiao T forgot the exact price on each of the $K$ days; he now wants to know how many possible price sequences there are for these $K$ days.", "inputFormat": "Only one line with four space-separated numbers: $N$, $K$, $M$, $P$. For $P$, see the explanation in the “Output Format” section below. It is guaranteed that for 20% of the testdata $M, N, K, P \\le 20000$, and for 100% of the testdata $M, K, P \\le 10^9$, $N \\le 10^{18}$.", "outputFormat": "Output a single number: the number of possible price sequences over $K$ days modulo $P$.", "hint": "**Sample Explanation**  \nThe output sample’s $16$ means there are $16$ possible price sequences for the input sample:\n\n$\\{1, 2, 3\\}$, $\\{1, 2, 4\\}$, $\\{1, 3, 4\\}$, $\\{1, 3, 5\\}$, $\\{2, 3, 4\\}$, $\\{2, 3, 5\\}$, $\\{2, 4, 5\\}$, $\\{2, 4, 6\\}$, $\\{3, 4, 5\\}$, $\\{3, 4, 6\\}$, $\\{3, 5, 6\\}$, $\\{3, 5, 7\\}$, $\\{4, 5, 6\\}$, $\\{4, 5, 7\\}$, $\\{4, 6, 7\\}$, $\\{5, 6, 7\\}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2013] 数列", "background": null, "description": "小 T 最近在学着买股票，他得到内部消息：F 公司的股票将会疯涨。股票每天的价格已知是正整数，并且由于客观上的原因，最多只能为 $N$。在疯涨的 $K$ 天中小 T 观察到：除第一天外每天的股价都比前一天高，且高出的价格（即当天的股价与前一天的股价之差）不会超过 $M$，$M$ 为正整数。并且这些参数满足 $M(K-1)<N$。小 T 忘记了这 $K$ 天每天的具体股价了，他现在想知道这 $K$ 天的股价有多少种可能。", "inputFormat": "只有一行用空格隔开的四个数：$N$、$K$、$M$、$P$。对 $P$ 的说明参见后面“输出格式”中对 $P$ 的解释。输入保证 $20\\%$ 的数据 $M,N,K,P \\le 20000$，保证 $100\\%$ 的数据 $M,K,P \\le 10^9$，$N \\le 10^{18}$。", "outputFormat": "仅包含一个数，表示这 $K$ 天的股价的可能种数对于 $P$ 的模值。", "hint": "**样例解释**  \n\n输出样例的 $16$ 表示输入样例的股价有 $16$ 种可能：\n\n$\\{1, 2, 3\\}$，$\\{1, 2, 4\\}$，$\\{1, 3, 4\\}$，$\\{1, 3, 5\\}$，$\\{2, 3, 4\\}$，$\\{2, 3, 5\\}$，$\\{2, 4, 5\\}$，$\\{2, 4, 6\\}$，$\\{3, 4, 5\\}$，$\\{3, 4, 6\\}$，$\\{3, 5, 6\\}$，$\\{3, 5, 7\\}$，$\\{4, 5, 6\\}$，$\\{4, 5, 7\\}$，$\\{4, 6, 7\\}$，$\\{5, 6, 7\\}$。", "locale": "zh-CN"}}}
