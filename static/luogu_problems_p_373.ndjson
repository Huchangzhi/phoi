{"pid": "P8565", "type": "P", "difficulty": 6, "samples": [["2\n2 5\n1 1\n3 5 7 9 11\n3 5\n1 2 5\n4 7 10 18 22", "3\n3\n3\n5\n5\n0\n1\n1\n1\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "O2优化", "洛谷月赛"], "title": "Sultan Rage", "background": "", "description": "有一个数列 $\\{a_n\\}$ 满足对 $n > m$ 均有 $a_n=\\sum\\limits_{j=1}^m a_{n-j}$，并且 $a_1,a_2,\\cdots,a_m$ 是输入中给出的正整数。\n\n$q$ 次询问，每一次给出一个正整数 $x$，问有多少个不可重正整数集 $S$ 满足 $\\sum\\limits_{s\\in S}a_s=x$。答案对质数 $998244353$ 取模。\n\n本题有多组数据。", "inputFormat": "**本题有多组数据。**\n\n第一行一个整数 $T$ 表示数据组数。对于每一组数据：\n\n第一行两个整数 $m,q$。\n\n第二行 $m$ 个整数 $a_1,a_2,\\cdots,a_m$。\n\n第三行 $q$ 个整数，每一个整数代表一次询问。", "outputFormat": "对于每组询问输出一行表示答案。", "hint": "对于所有数据，$T=5$，$2 \\le m \\le 100$，$1 \\le q,a_i \\le 100$，$1 \\le x \\le 10^{18}$。\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{c|c|c|c|c|c}\\hline \n\\textbf{测试点编号}&\\bm{m\\le}&\\bm{q \\le }&\\bm{a_i \\le }& \\bm{x \\le}&\\bm{\\textbf{特殊性质}}\\cr\\hline \n\\textsf1\\sim \\sf2 & 8&8  & 8 & 100\\cr\\hline \n\\sf3\\sim 5 & 15& &15&10^3 \\cr\\hline \n\\textsf6 & & & & 1 &\\cr\\hline \n\\sf7\\sim 11 & & 1& & & \\textsf{A}\\cr\\hline\n\\sf12\\sim 16 & 2& & &\\cr\\hline\n\\sf17\\sim 20 & &\\cr\\hline\n\\end{array}\n$$\n\n$\\textsf A$：$m=10$，且 $x$ 在所有可能的 $x$ 中随机生成。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "Sultan Rage", "background": "", "description": "有一个数列 $\\{a_n\\}$ 满足对 $n > m$ 均有 $a_n=\\sum\\limits_{j=1}^m a_{n-j}$，并且 $a_1,a_2,\\cdots,a_m$ 是输入中给出的正整数。\n\n$q$ 次询问，每一次给出一个正整数 $x$，问有多少个不可重正整数集 $S$ 满足 $\\sum\\limits_{s\\in S}a_s=x$。答案对质数 $998244353$ 取模。\n\n本题有多组数据。", "inputFormat": "**本题有多组数据。**\n\n第一行一个整数 $T$ 表示数据组数。对于每一组数据：\n\n第一行两个整数 $m,q$。\n\n第二行 $m$ 个整数 $a_1,a_2,\\cdots,a_m$。\n\n第三行 $q$ 个整数，每一个整数代表一次询问。", "outputFormat": "对于每组询问输出一行表示答案。", "hint": "对于所有数据，$T=5$，$2 \\le m \\le 100$，$1 \\le q,a_i \\le 100$，$1 \\le x \\le 10^{18}$。\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{c|c|c|c|c|c}\\hline \n\\textbf{测试点编号}&\\bm{m\\le}&\\bm{q \\le }&\\bm{a_i \\le }& \\bm{x \\le}&\\bm{\\textbf{特殊性质}}\\cr\\hline \n\\textsf1\\sim \\sf2 & 8&8  & 8 & 100\\cr\\hline \n\\sf3\\sim 5 & 15& &15&10^3 \\cr\\hline \n\\textsf6 & & & & 1 &\\cr\\hline \n\\sf7\\sim 11 & & 1& & & \\textsf{A}\\cr\\hline\n\\sf12\\sim 16 & 2& & &\\cr\\hline\n\\sf17\\sim 20 & &\\cr\\hline\n\\end{array}\n$$\n\n$\\textsf A$：$m=10$，且 $x$ 在所有可能的 $x$ 中随机生成。", "locale": "zh-CN"}}}
{"pid": "P8566", "type": "P", "difficulty": 7, "samples": [["5\n4 2\n1 3 0\n2 4 1\n5 4\n2 5 0\n1 4 0\n3 1 1\n2 4 0\n5 4\n1 3 0\n2 4 1\n2 5 0\n1 4 1\n5 4\n1 3 0\n5 3 0\n1 4 1\n2 5 0\n4 2\n1 3 0\n1 3 1", "0\nB 4\n0\nB 2\nB 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["洛谷原创", "O2优化", "洛谷月赛"], "title": "You are the Miserable", "background": "", "description": "小 A 和小 B 玩游戏。小 A 有一个凸 $n$ 边形以及 $n-3$ 条不交的对角线构成一个三角剖分。每一次，小 B 可以问小 A 某一条对角线 $x-y$ ，小 A 会回答他该对角线是否在他的三角剖分中。小 B 想要对于每一条 **三角剖分中** 的对角线得到至少一次肯定的答复。他希望询问的次数尽量少，而小 A 希望询问次数尽量多，并且有可能会根据小 B 的询问来改变他的三角剖分。但在这个过程中，小 A 的三角剖分不能与他曾做出的回答矛盾。\n\n现在，给出小 A 和小 B 玩的若干步，判断它们的游戏过程是否保持最优。如果是，输出 $0$；如果不是，输出第一次不是最优的操作，形如 `A x` 或者 `B x`，表示小 A 或者小 B 的第 $x$ 次操作不是最优的。\n\n具体地，保持最优的定义如下：假设最优情况下小 B 要询问 $k$ 次，那么每一步过后，双方最优的策略仍然使得总的询问次数为 $k$，第一次使得询问次数不为 $k$ 的步骤就是需要输出的步骤。\n\n他们玩了 $T$ 次独立的游戏，你需要对每一次询问作出回答。\n\n**注意：**\n\n-   数据保证，直到第一次不优的操作被做出，小 A 的回答都是合法的，即总存在一个三角剖分符合小 A 做出的所有回答。\n-   数据不保证，在第一次不优的操作被做出以后，小 A 的回答仍然保持合法，即可能不存在一个三角剖分符合小 A 做出的所有回答。\n\n**【提示】**\n\n1. 多边形的对角线指连接不相邻两个顶点的线段。\n2. 多边形的三角剖分指 $n-3$ 条仅可以在顶点处相交的对角线构成的集合。", "inputFormat": "第一行一个整数 $T$ 表示数据组数。\n\n对于每一组数据，第一行两个整数 $n,m$。\n\n接下来 $m$ 行，每一行三个整数 $x,y,z$，表示小 B 的询问和小 A 的回答。其中 $z=0$ 表示该对角线不存在，$z=1$ 则表示存在。", "outputFormat": "对于每组数据输出一行，若存在不优的操作则输出第一次不是最优的操作，否则输出 $0$。", "hint": "【样例解释】\n\n对于 $n=5$，最优的 $k=4$。对于 $n=4$，最优的 $k=2$。对于最后一组数据，B 重复询问同一条边已经不是最优，此时 A 的回答可以不合法。\n\n【数据范围】\n\n$1 \\le T\\le 10^3$，$4\\le n \\le 10^5$，$1 \\le \\sum n \\le 2\\times 10^5$，$1 \\le m \\le k$，$1 \\le x,y \\le n$，$0 \\le z \\le 1$。保证所有的 $x-y$ 都是合法的对角线，以及直到第一次不是最优的一步所有询问的回答都至少对应一种三角剖分。\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{c|c|c|c|c}\\hline \n\\textbf{~~测试点编号~~}&\\bm{~~T\\le~~}&\\bm{~~n \\le ~~}&\\bm{~~~~m~~~~}& ~\\bm{z}~\\cr\\hline \n\\textsf1\\sim \\sf2 &100 &5  &  \\cr\\hline \n\\sf3\\sim 4 & 100& 7& &\\cr\\hline \n\\sf5 \\sim 6 &100 &8 & & \\cr\\hline \n\\sf7 \\sim \\sf9 & & &=1 & \\cr\\hline \n\\sf10\\sim 12 & & & & =0\\cr\\hline\n\\sf13\\sim 16 &20 &200\\cr\\hline\n\\sf 17 \\sim 20\n\\end{array}\n$$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "You are the Miserable", "background": "", "description": "小 A 和小 B 玩游戏。小 A 有一个凸 $n$ 边形以及 $n-3$ 条不交的对角线构成一个三角剖分。每一次，小 B 可以问小 A 某一条对角线 $x-y$ ，小 A 会回答他该对角线是否在他的三角剖分中。小 B 想要对于每一条 **三角剖分中** 的对角线得到至少一次肯定的答复。他希望询问的次数尽量少，而小 A 希望询问次数尽量多，并且有可能会根据小 B 的询问来改变他的三角剖分。但在这个过程中，小 A 的三角剖分不能与他曾做出的回答矛盾。\n\n现在，给出小 A 和小 B 玩的若干步，判断它们的游戏过程是否保持最优。如果是，输出 $0$；如果不是，输出第一次不是最优的操作，形如 `A x` 或者 `B x`，表示小 A 或者小 B 的第 $x$ 次操作不是最优的。\n\n具体地，保持最优的定义如下：假设最优情况下小 B 要询问 $k$ 次，那么每一步过后，双方最优的策略仍然使得总的询问次数为 $k$，第一次使得询问次数不为 $k$ 的步骤就是需要输出的步骤。\n\n他们玩了 $T$ 次独立的游戏，你需要对每一次询问作出回答。\n\n**注意：**\n\n-   数据保证，直到第一次不优的操作被做出，小 A 的回答都是合法的，即总存在一个三角剖分符合小 A 做出的所有回答。\n-   数据不保证，在第一次不优的操作被做出以后，小 A 的回答仍然保持合法，即可能不存在一个三角剖分符合小 A 做出的所有回答。\n\n**【提示】**\n\n1. 多边形的对角线指连接不相邻两个顶点的线段。\n2. 多边形的三角剖分指 $n-3$ 条仅可以在顶点处相交的对角线构成的集合。", "inputFormat": "第一行一个整数 $T$ 表示数据组数。\n\n对于每一组数据，第一行两个整数 $n,m$。\n\n接下来 $m$ 行，每一行三个整数 $x,y,z$，表示小 B 的询问和小 A 的回答。其中 $z=0$ 表示该对角线不存在，$z=1$ 则表示存在。", "outputFormat": "对于每组数据输出一行，若存在不优的操作则输出第一次不是最优的操作，否则输出 $0$。", "hint": "【样例解释】\n\n对于 $n=5$，最优的 $k=4$。对于 $n=4$，最优的 $k=2$。对于最后一组数据，B 重复询问同一条边已经不是最优，此时 A 的回答可以不合法。\n\n【数据范围】\n\n$1 \\le T\\le 10^3$，$4\\le n \\le 10^5$，$1 \\le \\sum n \\le 2\\times 10^5$，$1 \\le m \\le k$，$1 \\le x,y \\le n$，$0 \\le z \\le 1$。保证所有的 $x-y$ 都是合法的对角线，以及直到第一次不是最优的一步所有询问的回答都至少对应一种三角剖分。\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{c|c|c|c|c}\\hline \n\\textbf{~~测试点编号~~}&\\bm{~~T\\le~~}&\\bm{~~n \\le ~~}&\\bm{~~~~m~~~~}& ~\\bm{z}~\\cr\\hline \n\\textsf1\\sim \\sf2 &100 &5  &  \\cr\\hline \n\\sf3\\sim 4 & 100& 7& &\\cr\\hline \n\\sf5 \\sim 6 &100 &8 & & \\cr\\hline \n\\sf7 \\sim \\sf9 & & &=1 & \\cr\\hline \n\\sf10\\sim 12 & & & & =0\\cr\\hline\n\\sf13\\sim 16 &20 &200\\cr\\hline\n\\sf 17 \\sim 20\n\\end{array}\n$$", "locale": "zh-CN"}}}
{"pid": "P8567", "type": "P", "difficulty": 1, "samples": [["2\n3 5\n15 20", "2\n3"]], "limits": {"time": [1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072]}, "tags": ["数学", "2022", "洛谷原创"], "title": "[JRKSJ R6] Nothing", "background": "【此处应有图】", "description": "我们定义 $f(x)$ 表示 $x$ 在 $2$ 进制下最低的 $1$ 的位置（你需要注意，二进制下的最低位是第 $0 $ 位）。以下是其在 `C++` 语言中的代码（未考虑数据类型造成的问题）：\n\n```c++\nint f(int x){\n\tint ans = 0;\n\twhile (x % 2 == 0){\n\t\tx /= 2;\n\t\tans += 1;\n\t}\n\treturn ans;\n}\n```\n\n共有 $T$ 组询问，每组询问给定区间 $[l,r]$，求有多少个 $i\\in [l,r]$ 使得 $f(i)< f(i+1)$。", "inputFormat": "第一行一个正整数 $T$。\\\n接下来 $T$ 行每行两个正整数 $l,r$ 表示一次询问。", "outputFormat": "$T$ 行每行一个整数表示答案。", "hint": "### 数据规模\n本题采用捆绑测试。\n\n| $\\text{Subtask}$ | $T\\le$ | 特殊限制 | $\\text{Score}$ |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $10^5$ | $l=r$ | $10$ |\n| $2$ | $10^4$ | $r-l\\le10^3$ | $30$ |\n| $3$ | $10^5$ | $r\\le10^6$ | $20$ |\n| $4$ | $10^5$ | 无 | $40$ |\n\n对于 $100\\%$ 的数据，$1\\le T\\le 10^5$，$1\\le l\\le r\\le 10^{18}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JRKSJ R6] Nothing", "background": "【此处应有图】", "description": "我们定义 $f(x)$ 表示 $x$ 在 $2$ 进制下最低的 $1$ 的位置（你需要注意，二进制下的最低位是第 $0 $ 位）。以下是其在 `C++` 语言中的代码（未考虑数据类型造成的问题）：\n\n```c++\nint f(int x){\n\tint ans = 0;\n\twhile (x % 2 == 0){\n\t\tx /= 2;\n\t\tans += 1;\n\t}\n\treturn ans;\n}\n```\n\n共有 $T$ 组询问，每组询问给定区间 $[l,r]$，求有多少个 $i\\in [l,r]$ 使得 $f(i)< f(i+1)$。", "inputFormat": "第一行一个正整数 $T$。\\\n接下来 $T$ 行每行两个正整数 $l,r$ 表示一次询问。", "outputFormat": "$T$ 行每行一个整数表示答案。", "hint": "### 数据规模\n本题采用捆绑测试。\n\n| $\\text{Subtask}$ | $T\\le$ | 特殊限制 | $\\text{Score}$ |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $10^5$ | $l=r$ | $10$ |\n| $2$ | $10^4$ | $r-l\\le10^3$ | $30$ |\n| $3$ | $10^5$ | $r\\le10^6$ | $20$ |\n| $4$ | $10^5$ | 无 | $40$ |\n\n对于 $100\\%$ 的数据，$1\\le T\\le 10^5$，$1\\le l\\le r\\le 10^{18}$。", "locale": "zh-CN"}}}
{"pid": "P8568", "type": "P", "difficulty": 6, "samples": [["1\n5 999 999\n\n0\n\n1\n\n1", "\n\n? 1 3 2\n\n? 4 5 2\n\n! 3"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "二分", "2022", "三分", "洛谷原创", "交互题", "Special Judge", "O2优化"], "title": "[JRKSJ R6] func", "background": "", "description": "**这是一道 IO 交互题．**\n\n你有一个一次函数 $f(x)=kx+b$（$1\\le x \\le n-1$）．这个一次函数满足 $k,b$ 均为整数且 $k>0$．\n\nvectorwyx 修改了这个函数，具体而言，他会选择一个整数 $t$（$1\\le t \\le n-1$），将这个函数在直线 $x=t$ 及右侧的部分向右平移一个单位长度，并把两部分的端点用直线段连接，得到一个分段函数 $g(x)$：\n\n$$\ng(x)=\\begin{cases}\nkx+b&1\\le x<t\\\\\nkt+b& t\\le x <t+1\\\\\nk(x-1)+b& t+1\\le x \\le n\n\\end{cases}\n$$\n\n请通过交互的方式得到 $t$ 的值．\n\n### 交互方式\n\n**本题单个测试点中含有多组数据．**\n\n1. 首先从标准输入流读入一个整数 $T$，表示数据组数．\n1. 接下来你将进行 $T$ 组数据的交互．对于每组数据，首先从标准输入流读入三个整数 $n,Q,P$．\n1. 你可以通过向标准输出流输出 `? l r p`（$1\\le l \\le r \\le n$，$2\\le p \\le P$）的方式来询问．在单组数据中，你最多只能进行 $Q$ 次 `?` 操作．交互库会根据你的询问依次做出以下判断并向标准输入流发送返回结果：\n    - 若你的询问数据范围错误，回答为 $-2$．此时交互库会直接返回 WA．你需要立刻退出你的程序来避免与已经结束程序的交互库交互引起超时．\n    - 若 $g(l)=g(r)$，回答为 $-1$．\n    - 否则回答为 $(g(l) + g(r))\\bmod p$．\n1. 你可以通过向标准输出流输出 `! t` 的方式来给出答案．你只能进行一次回答操作，且回答操作必须是你在每组数据中进行的最后一个操作．交互完成后，从标准输入流读入一个零或一的整数 $x$．若 $x=1$ 则代表当前数据回答正确，你需要回到步骤 $2$ 以进行下一组数据的交互．否则 $x=0$，你需要立刻退出自己的程序．\n\n**不要忘记在每次输出后刷新缓冲区，否则你将会 TLE．**\n\n下面是一些语言的刷新缓冲区操作：\n\n- C++：`fflush(stdout)` 或 `cout.flush()`．\n- C: `fflush(stdout)`．\n- Java: `System.out.flush()`．\n- Python: `stdout.flush()`．\n- Pascal: `flush(output)`．\n- 其他语言：请参考对应语言的帮助文档．\n", "inputFormat": "见「交互方式」．", "outputFormat": "见「交互方式」，", "hint": "### 样例解释\n\n请注意，样例仅用来表示交互的规则，不保证有逻辑性．\n\n#### 样例 #1\n\n$f(x)=3x-2$（$1\\le x \\le 4$），$t=3$．\n\n$$\ng(x)=\\begin{cases}\n3x-2&1\\le x<3\\\\\n7& 3\\le x <4\\\\\n3x-5& 4\\le x \\le 5.\n\\end{cases}\n$$\n\n所以第一次询问的结果 $(g(1) + g(3))\\bmod 2 = (1+7)\\bmod 2=0$，第二次询问的结果 $(g(4)+g(5))\\bmod 2 = (7+ 10)\\bmod 2=1$．\n\n### 数据范围与约束\n\n**本题采用捆绑测试．且不存在一个 Subtask 包含其它所有 Subtask 的限制．**\n\n| Subtask | 分值 |    $n$     | $Q=$ |       $P=$        | $g(x)\\le$ |    特殊性质     |\n| ------- | ---- | ---------- | ---- | ----------------- | --------- | --------------- |\n| $1$     | $10$ | $\\le 10^9$ | $42$ | $2\\times 10^{18}$ | $10^{18}$ | 无              |\n| $2$     | $20$ | $\\le 10^9$ | $30$ | $2$               | $10^{18}$ | 斜率 $k$ 为奇数 |\n| $3$     | $30$ | $\\le 10^9$ | $42$ | $50$              | $10^{18}$ | 无              |\n| $4$     | $39$ | $\\le 10^9$ | $32$ | $50$              | $10^{18}$ | 无              |\n|$5$|$1$|$ = 1162261531$| $32$| $50$| $7857125847061472735$|无|\n\n对于 $100\\%$ 的数据，保证 $1 \\le T \\le 10$，$2\\le n\\le 1162261531$．且满足 $\\forall x \\in [1,n], 0 \\le g(x)\\le 7857125847061472735$．\n\n### 提示\n\n由于本题不存在一个 Subtask 包含其它所有 Subtask 的限制．所以数据范围中「对于 $100\\%$ 的数据」部分的 $n$ 和 $g(x)$ 的上界没有任何意义．但由于直接写「对于 $100\\%$ 的数据，满足 $n \\ge 2$，$g(x)\\ge 0$」会被某些管理以「你管这叫数据范围」打回，故此题中保留该没有意义的上界．", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JRKSJ R6] func", "background": "", "description": "**这是一道 IO 交互题．**\n\n你有一个一次函数 $f(x)=kx+b$（$1\\le x \\le n-1$）．这个一次函数满足 $k,b$ 均为整数且 $k>0$．\n\nvectorwyx 修改了这个函数，具体而言，他会选择一个整数 $t$（$1\\le t \\le n-1$），将这个函数在直线 $x=t$ 及右侧的部分向右平移一个单位长度，并把两部分的端点用直线段连接，得到一个分段函数 $g(x)$：\n\n$$\ng(x)=\\begin{cases}\nkx+b&1\\le x<t\\\\\nkt+b& t\\le x <t+1\\\\\nk(x-1)+b& t+1\\le x \\le n\n\\end{cases}\n$$\n\n请通过交互的方式得到 $t$ 的值．\n\n### 交互方式\n\n**本题单个测试点中含有多组数据．**\n\n1. 首先从标准输入流读入一个整数 $T$，表示数据组数．\n1. 接下来你将进行 $T$ 组数据的交互．对于每组数据，首先从标准输入流读入三个整数 $n,Q,P$．\n1. 你可以通过向标准输出流输出 `? l r p`（$1\\le l \\le r \\le n$，$2\\le p \\le P$）的方式来询问．在单组数据中，你最多只能进行 $Q$ 次 `?` 操作．交互库会根据你的询问依次做出以下判断并向标准输入流发送返回结果：\n    - 若你的询问数据范围错误，回答为 $-2$．此时交互库会直接返回 WA．你需要立刻退出你的程序来避免与已经结束程序的交互库交互引起超时．\n    - 若 $g(l)=g(r)$，回答为 $-1$．\n    - 否则回答为 $(g(l) + g(r))\\bmod p$．\n1. 你可以通过向标准输出流输出 `! t` 的方式来给出答案．你只能进行一次回答操作，且回答操作必须是你在每组数据中进行的最后一个操作．交互完成后，从标准输入流读入一个零或一的整数 $x$．若 $x=1$ 则代表当前数据回答正确，你需要回到步骤 $2$ 以进行下一组数据的交互．否则 $x=0$，你需要立刻退出自己的程序．\n\n**不要忘记在每次输出后刷新缓冲区，否则你将会 TLE．**\n\n下面是一些语言的刷新缓冲区操作：\n\n- C++：`fflush(stdout)` 或 `cout.flush()`．\n- C: `fflush(stdout)`．\n- Java: `System.out.flush()`．\n- Python: `stdout.flush()`．\n- Pascal: `flush(output)`．\n- 其他语言：请参考对应语言的帮助文档．\n", "inputFormat": "见「交互方式」．", "outputFormat": "见「交互方式」，", "hint": "### 样例解释\n\n请注意，样例仅用来表示交互的规则，不保证有逻辑性．\n\n#### 样例 #1\n\n$f(x)=3x-2$（$1\\le x \\le 4$），$t=3$．\n\n$$\ng(x)=\\begin{cases}\n3x-2&1\\le x<3\\\\\n7& 3\\le x <4\\\\\n3x-5& 4\\le x \\le 5.\n\\end{cases}\n$$\n\n所以第一次询问的结果 $(g(1) + g(3))\\bmod 2 = (1+7)\\bmod 2=0$，第二次询问的结果 $(g(4)+g(5))\\bmod 2 = (7+ 10)\\bmod 2=1$．\n\n### 数据范围与约束\n\n**本题采用捆绑测试．且不存在一个 Subtask 包含其它所有 Subtask 的限制．**\n\n| Subtask | 分值 |    $n$     | $Q=$ |       $P=$        | $g(x)\\le$ |    特殊性质     |\n| ------- | ---- | ---------- | ---- | ----------------- | --------- | --------------- |\n| $1$     | $10$ | $\\le 10^9$ | $42$ | $2\\times 10^{18}$ | $10^{18}$ | 无              |\n| $2$     | $20$ | $\\le 10^9$ | $30$ | $2$               | $10^{18}$ | 斜率 $k$ 为奇数 |\n| $3$     | $30$ | $\\le 10^9$ | $42$ | $50$              | $10^{18}$ | 无              |\n| $4$     | $39$ | $\\le 10^9$ | $32$ | $50$              | $10^{18}$ | 无              |\n|$5$|$1$|$ = 1162261531$| $32$| $50$| $7857125847061472735$|无|\n\n对于 $100\\%$ 的数据，保证 $1 \\le T \\le 10$，$2\\le n\\le 1162261531$．且满足 $\\forall x \\in [1,n], 0 \\le g(x)\\le 7857125847061472735$．\n\n### 提示\n\n由于本题不存在一个 Subtask 包含其它所有 Subtask 的限制．所以数据范围中「对于 $100\\%$ 的数据」部分的 $n$ 和 $g(x)$ 的上界没有任何意义．但由于直接写「对于 $100\\%$ 的数据，满足 $n \\ge 2$，$g(x)\\ge 0$」会被某些管理以「你管这叫数据范围」打回，故此题中保留该没有意义的上界．", "locale": "zh-CN"}}}
{"pid": "P8569", "type": "P", "difficulty": 6, "samples": [["10 10\n2 8 9 1 9 2 7 1 2 10\n1 10 1 1", "544"]], "limits": {"time": [2077, 2077, 2077, 2077, 2077, 2077, 2077, 2077, 2077, 2077, 2077, 2077, 2077, 2077, 2077, 2077, 2077], "memory": [27648, 27648, 27648, 27648, 27648, 27648, 27648, 27648, 27648, 27648, 27648, 27648, 27648, 27648, 27648, 27648, 27648]}, "tags": ["2022", "洛谷原创", "O2优化", "分治", "位运算"], "title": "[JRKSJ R6] 第七学区", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/jswrnw5w.png)\n\n这个题本来是要拿到 Tree Diagram 上算的，但是 Tree Diagram 被某组织的宇宙射线射爆了，所以这个问题交给了你。\n\n不过你不需要计算出可能出现的最坏情况，只需要解决原问题就可以了。", "description": "给你一个长度为 $n$ 的序列 $a$，求其所有子区间的按位或和的和。", "inputFormat": "**本题采用特殊的读入方式。以下是[读入模板](https://www.luogu.com.cn/paste/rz2t978c)：**\n\n```cpp\n#include<bits/stdc++.h>\n#define Misaka namespace  \n#define Mikoto std \n#define ull unsigned long long \nusing Misaka Mikoto;\nnamespace READ\n{\n\tull Read()\n\t{\n\t\tchar ch=getchar();\n\t\tull s=0;\n\t\twhile(ch<'0'||ch>'9') ch=getchar();\n\t\twhile(ch>='0'&&ch<='9') s=s*10+ch-'0',ch=getchar();\n\t\treturn s;\n\t}\n\tull tp[10005];\n\tint l,r;\n\tull g1,g2;\n\tvoid init(int &n)\n\t{\n\t\tint i,k;\n\t\tn=Read(),k=Read(),l=1;\n\t\tfor(i=1;i<=k;i++)\n\t\t\ttp[i]=Read();\n\t}\n\tull read()\n\t{\n\t\tif(l>r)\n\t\t\tl=Read(),r=Read(),g1=Read(),g2=Read();\n\t\treturn tp[l++]*g1+g2;\n\t}\n}\nint main()\n{\n\tint n;\n   \tREAD::init(n);\n}\n```\n\n初始调用一次 `READ::init(n)`，之后你应调用 $n$ 次 `READ::read()`，第 $i$ 次 `READ::read` 返回 $a_i$。", "outputFormat": "一个整数，表示答案。答案对 $2^{64}$ 取模。", "hint": "保证读入模板消耗的时间少于 200ms，空间少于 1MB。\n\n### 数据规模\n\n本题采用捆绑测试。\n\n| $\\text{Subtask}$ | $n\\le$ | $\\text{Score}$ |\n| :----------: | :----------: | :----------: | \n| $1$ | $10^4$ | $10$ |\n| $2$ | $3\\times 10^6$ | $20$ |\n| $3$ | $4\\times 10^7$ | $30$ |\n| $4$ | $5\\times 10^7$ | $40$ |\n\n对于 $100\\%$ 的数据，$1\\le n\\le 5\\times 10^7$，$0\\le a_i <2^{64}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JRKSJ R6] 第七学区", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/jswrnw5w.png)\n\n这个题本来是要拿到 Tree Diagram 上算的，但是 Tree Diagram 被某组织的宇宙射线射爆了，所以这个问题交给了你。\n\n不过你不需要计算出可能出现的最坏情况，只需要解决原问题就可以了。", "description": "给你一个长度为 $n$ 的序列 $a$，求其所有子区间的按位或和的和。", "inputFormat": "**本题采用特殊的读入方式。以下是[读入模板](https://www.luogu.com.cn/paste/rz2t978c)：**\n\n```cpp\n#include<bits/stdc++.h>\n#define Misaka namespace  \n#define Mikoto std \n#define ull unsigned long long \nusing Misaka Mikoto;\nnamespace READ\n{\n\tull Read()\n\t{\n\t\tchar ch=getchar();\n\t\tull s=0;\n\t\twhile(ch<'0'||ch>'9') ch=getchar();\n\t\twhile(ch>='0'&&ch<='9') s=s*10+ch-'0',ch=getchar();\n\t\treturn s;\n\t}\n\tull tp[10005];\n\tint l,r;\n\tull g1,g2;\n\tvoid init(int &n)\n\t{\n\t\tint i,k;\n\t\tn=Read(),k=Read(),l=1;\n\t\tfor(i=1;i<=k;i++)\n\t\t\ttp[i]=Read();\n\t}\n\tull read()\n\t{\n\t\tif(l>r)\n\t\t\tl=Read(),r=Read(),g1=Read(),g2=Read();\n\t\treturn tp[l++]*g1+g2;\n\t}\n}\nint main()\n{\n\tint n;\n   \tREAD::init(n);\n}\n```\n\n初始调用一次 `READ::init(n)`，之后你应调用 $n$ 次 `READ::read()`，第 $i$ 次 `READ::read` 返回 $a_i$。", "outputFormat": "一个整数，表示答案。答案对 $2^{64}$ 取模。", "hint": "保证读入模板消耗的时间少于 200ms，空间少于 1MB。\n\n### 数据规模\n\n本题采用捆绑测试。\n\n| $\\text{Subtask}$ | $n\\le$ | $\\text{Score}$ |\n| :----------: | :----------: | :----------: | \n| $1$ | $10^4$ | $10$ |\n| $2$ | $3\\times 10^6$ | $20$ |\n| $3$ | $4\\times 10^7$ | $30$ |\n| $4$ | $5\\times 10^7$ | $40$ |\n\n对于 $100\\%$ 的数据，$1\\le n\\le 5\\times 10^7$，$0\\le a_i <2^{64}$。", "locale": "zh-CN"}}}
{"pid": "P8570", "type": "P", "difficulty": 7, "samples": [["5 5", "453"], ["20 20", "173825"]], "limits": {"time": [1700, 1700, 1700, 1700, 1700, 1700, 1700, 1700, 1700, 1700, 1700, 1700, 1700, 1700, 1700, 1700, 1700, 1700, 1700, 1700, 1700, 1700, 1700, 1700, 1700, 1700, 1700, 1700, 1700, 1700], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2022", "洛谷原创", "O2优化", "素数判断,质数,筛法", "莫比乌斯反演"], "title": "[JRKSJ R6] 牵连的世界", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/jdi9nrec.png)", "description": "给定 $n,m$，求\n\n$$\\sum_{i=1}^n \\sum_{j=1}^m \\sigma_0(ij)\\varphi(ij)$$", "inputFormat": "两个整数 $n,m$。", "outputFormat": "一个整数，表示答案。答案对 $10^9+7$ 取模。", "hint": "$\\sigma_0,\\varphi$ 分别为因数个数函数，欧拉函数。\n\n本题可能轻微卡常。\n\n### 数据规模\n本题采用捆绑测试。\n\n| $\\text{Subtask}$ | $n,m\\le$ |  $\\text{Score}$ |\n| :----------: | :----------: | :----------: |\n| $1$ | $10^3$ | $10$ |\n| $2$ | $10^5$ |  $30$ |\n| $3$ | $2\\times 10^5$ | $30$ |\n| $4$ | $5\\times 10^5$ | $30$ |\n| $5$ | $3\\times 10^6$ | $1$ |\n\n对于所有数据，$1\\le n,m\\le 3\\times 10^6$。\n\n出于某些原因，你只要得到了 $\\ge 100$ 分就可以通过此题。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JRKSJ R6] 牵连的世界", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/jdi9nrec.png)", "description": "给定 $n,m$，求\n\n$$\\sum_{i=1}^n \\sum_{j=1}^m \\sigma_0(ij)\\varphi(ij)$$", "inputFormat": "两个整数 $n,m$。", "outputFormat": "一个整数，表示答案。答案对 $10^9+7$ 取模。", "hint": "$\\sigma_0,\\varphi$ 分别为因数个数函数，欧拉函数。\n\n本题可能轻微卡常。\n\n### 数据规模\n本题采用捆绑测试。\n\n| $\\text{Subtask}$ | $n,m\\le$ |  $\\text{Score}$ |\n| :----------: | :----------: | :----------: |\n| $1$ | $10^3$ | $10$ |\n| $2$ | $10^5$ |  $30$ |\n| $3$ | $2\\times 10^5$ | $30$ |\n| $4$ | $5\\times 10^5$ | $30$ |\n| $5$ | $3\\times 10^6$ | $1$ |\n\n对于所有数据，$1\\le n,m\\le 3\\times 10^6$。\n\n出于某些原因，你只要得到了 $\\ge 100$ 分就可以通过此题。", "locale": "zh-CN"}}}
{"pid": "P8571", "type": "P", "difficulty": 7, "samples": [["6 3\ndedicatus\na\nmisaka\nmikoto\nmi\naaa\n1 5 6\n1 2 4\n1 5 4", "3\n0\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2022", "洛谷原创", "后缀自动机 SAM", "O2优化", "分治", "虚树", "分块", "AC 自动机"], "title": "[JRKSJ R6] Dedicatus545", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/im5jyatm.png)", "description": "对于字符串 $x,y$，定义 $w(x,y)$ 为 $x$ 在 $y$ 中的出现次数。\n\nIndex 给了你 $n$ 个字符串 $s_{1\\dots n}$，$m$ 次询问，每次询问给定 $l,r,k$，求 $\\max_{i=l}^r w(s_i,s_k)$。", "inputFormat": "第一行两个整数 $n,m$。\\\n下面 $n$ 行，每行一个只包含小写字母的字符串表示 $s_{1\\dots n}$\\\n下面 $m$ 行，每行三个整数 $l,r,k$ 表示询问。", "outputFormat": "对于每个询问，每行输出一个整数表示答案。", "hint": "### 数据规模\n本题采用捆绑测试。\n\n| $\\text{Subtask}$ | $n,q\\le$ | $\\sum\\vert s\\vert\\le$ | $\\text{Score}$ | 特殊性质 |\n| :----------: | :----------: | :----------: | :----------: |:----------: |\n| $1$ | $2\\times10^3$ | $10^4$ | $20$ | 无 |\n| $2$ | $5\\times10^4$ | $3\\times 10^5$ | $20$ | 无\n| $3$ | $10^5$ | $5\\times10^5$ | $20$ | 所有字符串互不相同 |\n| $4$ | $10^5$ | $5\\times10^5$ | $40$ | 无\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 10^5$，$1\\le \\sum |s|\\le 5\\times 10^5$，$1\\le l\\le r\\le n$，$1\\le k\\le n$。\n\nData：abruce&critnos&fjy666", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JRKSJ R6] Dedicatus545", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/im5jyatm.png)", "description": "对于字符串 $x,y$，定义 $w(x,y)$ 为 $x$ 在 $y$ 中的出现次数。\n\nIndex 给了你 $n$ 个字符串 $s_{1\\dots n}$，$m$ 次询问，每次询问给定 $l,r,k$，求 $\\max_{i=l}^r w(s_i,s_k)$。", "inputFormat": "第一行两个整数 $n,m$。\\\n下面 $n$ 行，每行一个只包含小写字母的字符串表示 $s_{1\\dots n}$\\\n下面 $m$ 行，每行三个整数 $l,r,k$ 表示询问。", "outputFormat": "对于每个询问，每行输出一个整数表示答案。", "hint": "### 数据规模\n本题采用捆绑测试。\n\n| $\\text{Subtask}$ | $n,q\\le$ | $\\sum\\vert s\\vert\\le$ | $\\text{Score}$ | 特殊性质 |\n| :----------: | :----------: | :----------: | :----------: |:----------: |\n| $1$ | $2\\times10^3$ | $10^4$ | $20$ | 无 |\n| $2$ | $5\\times10^4$ | $3\\times 10^5$ | $20$ | 无\n| $3$ | $10^5$ | $5\\times10^5$ | $20$ | 所有字符串互不相同 |\n| $4$ | $10^5$ | $5\\times10^5$ | $40$ | 无\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 10^5$，$1\\le \\sum |s|\\le 5\\times 10^5$，$1\\le l\\le r\\le n$，$1\\le k\\le n$。\n\nData：abruce&critnos&fjy666", "locale": "zh-CN"}}}
{"pid": "P8572", "type": "P", "difficulty": 4, "samples": [["7 2 3\n1 1 4 5 1 4 0\n1 9 1 9 8 1 0\n6 7\n5 7\n1 3", "4\n9\n11"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2022", "洛谷原创", "O2优化", "枚举", "前缀和", "根号分治"], "title": "[JRKSJ R6] Eltaw", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/at23jtmh.png?x-oss-process=image)\n\n你在月下独自行走，不禁想起了一道简单题。\n\n（题目背景图片来自 Phigros 曲绘，如有侵权，请告知出题人。）", "description": "给你 $k$ 个长为 $n$ 的序列 $a_{1\\dots k,1\\dots n}$，有 $q$ 次询问，每次询问给出一个区间 $[l,r]$，要求出 $\\displaystyle\\max_{i=1}^k\\sum_{j=l}^ra_{i,j}$，即求出所有序列中区间 $[l,r]$ 的和的最大值。", "inputFormat": "第一行三个整数 $n,k,q$。\\\n接下来 $k$ 行，每行 $n$ 个整数 $a_{i,j}$。\\\n接下来 $q$ 行，每行两个整数 $l,r$ 表示一次询问。", "outputFormat": "输出 $q$ 行表示每个询问的答案。", "hint": "Idea：cyffff，Solution：cyffff，Code：cyffff，Data：cyffff\n\n**Eltaw - Fl00t (IN Lv 14.8)**\n\n**本题输入输出文件较大，请使用恰当的输入输出方式。**\n### 数据规模\n本题采用捆绑测试。\n\n| $\\text{Subtask}$ | $n\\le$ | 特殊限制 | $\\text{Score}$ |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $5\\times10^3$ | $k\\le 100$ | $20$ |\n| $2$ | $5\\times10^5$ | 保证 $l=1$ | $30$ |\n| $3$ | $5\\times10^5$ | 无 | $50$ |\n\n对于 $100\\%$ 的数据，$1\\le n,k,q\\le5\\times 10^5$，$n\\times k\\le 5\\times10^5$，$1\\le l\\le r\\le n$，$0\\le a_{i,j}\\le 10^9$。\n### 数据更新记录\n$\\text{Upd 2022.10.05}$：更新了两组数据，分别卡掉了两种时间复杂度错误的做法。感谢 @[二叉苹果树](https://www.luogu.com.cn/user/270854) 指出。\n\n$\\text{Upd 2022.10.08}$：更新了一组数据，卡掉了记忆化不正确的做法。感谢 @[SweetOrangeOvO](https://www.luogu.com.cn/user/236862) 指出。\n\n如果你能通过现在的所有测试点，说明你的代码复杂度极可能是正确的。如果你仍认为你的复杂度是错误的，请联系出题人。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JRKSJ R6] Eltaw", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/at23jtmh.png?x-oss-process=image)\n\n你在月下独自行走，不禁想起了一道简单题。\n\n（题目背景图片来自 Phigros 曲绘，如有侵权，请告知出题人。）", "description": "给你 $k$ 个长为 $n$ 的序列 $a_{1\\dots k,1\\dots n}$，有 $q$ 次询问，每次询问给出一个区间 $[l,r]$，要求出 $\\displaystyle\\max_{i=1}^k\\sum_{j=l}^ra_{i,j}$，即求出所有序列中区间 $[l,r]$ 的和的最大值。", "inputFormat": "第一行三个整数 $n,k,q$。\\\n接下来 $k$ 行，每行 $n$ 个整数 $a_{i,j}$。\\\n接下来 $q$ 行，每行两个整数 $l,r$ 表示一次询问。", "outputFormat": "输出 $q$ 行表示每个询问的答案。", "hint": "Idea：cyffff，Solution：cyffff，Code：cyffff，Data：cyffff\n\n**Eltaw - Fl00t (IN Lv 14.8)**\n\n**本题输入输出文件较大，请使用恰当的输入输出方式。**\n### 数据规模\n本题采用捆绑测试。\n\n| $\\text{Subtask}$ | $n\\le$ | 特殊限制 | $\\text{Score}$ |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $5\\times10^3$ | $k\\le 100$ | $20$ |\n| $2$ | $5\\times10^5$ | 保证 $l=1$ | $30$ |\n| $3$ | $5\\times10^5$ | 无 | $50$ |\n\n对于 $100\\%$ 的数据，$1\\le n,k,q\\le5\\times 10^5$，$n\\times k\\le 5\\times10^5$，$1\\le l\\le r\\le n$，$0\\le a_{i,j}\\le 10^9$。\n### 数据更新记录\n$\\text{Upd 2022.10.05}$：更新了两组数据，分别卡掉了两种时间复杂度错误的做法。感谢 @[二叉苹果树](https://www.luogu.com.cn/user/270854) 指出。\n\n$\\text{Upd 2022.10.08}$：更新了一组数据，卡掉了记忆化不正确的做法。感谢 @[SweetOrangeOvO](https://www.luogu.com.cn/user/236862) 指出。\n\n如果你能通过现在的所有测试点，说明你的代码复杂度极可能是正确的。如果你仍认为你的复杂度是错误的，请联系出题人。", "locale": "zh-CN"}}}
{"pid": "P8573", "type": "P", "difficulty": 2, "samples": [["5\nCapsLock CapsLock a CapsLock B\n4\n1\n2\n3\n4", "a\nb\nA\nB"], ["7\nh W CapsLock I CapsLock j CapsLock\n8\n7\n9\n13\n45\n20\n28\n50\n101", "I\nh\nH\nH\nj\nj\nW\nH"], ["10\nOh P CapsLock CapsLock CapsLock Cv Ts CapsLock XU AR \n10\n84\n63\n414\n149\n25\n61\n50\n4043\n9111\n47", "AR\ncV\nAR\nXU\nOh\nOh\nP\nXU\ncV\nXU"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["模拟", "字符串"], "title": "「DTOI-2」星之灵", "background": "### 小提醒\n\n- 注意 $\\texttt{CapsLock}$ 的大小写。", "description": "### 简要题意\n\n重复输入 $n$ 个字符串，其中：\n\n- 当输入的字符串为 $\\texttt{CapsLock}$ 时，在此之后的字符串大小写互换，直到下一个 $\\texttt{CapsLock}$ 出现；\n- 给定 $q$ 组询问，每次询问第 $x$ 个不为 $\\texttt{CapsLock}$ 的字符串。\n\n### 原题面\n\n星之灵可以对你说 $n$ 句话，你需要对其做记录。\n\n每句话可能是一个不等于 $\\texttt{CapsLock}$ 的字符串，也可以是一个命令 $\\texttt{CapsLock}$，其作用是控制星之灵说出的所有字母的大小写，当说出一次 $\\texttt{CapsLock}$ 时，之后说出的所有小写字母均需变为大写，大写字母均需变为小写，第二次说出 $\\texttt{CapsLock}$ 时又变为正常，以此类推。特别地，对于星之灵说出的 $\\texttt{CapsLock}$ 命令，你无须记录。\n\n星之灵将会不断重复说出这 $n$ 句话，且不改变顺序，而且他有 $q$ 次询问，每次询问都请你告诉星之灵，你记录的第 $x$ 句话是什么。", "inputFormat": "**本题使用多组数据测试。**\n\n第一行一个整数 $n$；\n\n接下来一行 $n$ 个字符串；\n\n第三行一个整数 $q$；\n\n接下来 $q$ 行，每行一个正整数 $x$。\n\n$n,q,x$ 的含义见题面。", "outputFormat": "输出 $q$ 行，每行一个字符串对应一次询问的答案。", "hint": "### 样例 #1 解释\n\n前四次记录的语句分别为：$a,b,A,B$。\n\n### 数据范围\n\n| $\\textbf{Subtask}$ | $n,q \\le$ | $x\\le $ | 特殊性质 | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $10$ | $100$ | $A$ | $30$ |\n| $2$ | $10^4$ | $10^5$ | / | $30$ |\n| $3$ | $10^5$ | $10^{18}$ | / | $40$ |\n\n对于所有数据，$1 \\leq n,q \\leq 10^5,1 \\leq x \\leq 10^{18}$\n\n性质 $A$：输入字符串中不存在 $\\texttt{CapsLock}$。\n\n### 数据保证\n\n- 所有语句中至少包含一个不为 $\\texttt{CapsLock}$ 的字符串；\n- 所有输入的字符串长度不大于 $10$；\n- 所有输入的字符串不为空且仅包含大小写字母。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DTOI-2」星之灵", "background": "### 小提醒\n\n- 注意 $\\texttt{CapsLock}$ 的大小写。", "description": "### 简要题意\n\n重复输入 $n$ 个字符串，其中：\n\n- 当输入的字符串为 $\\texttt{CapsLock}$ 时，在此之后的字符串大小写互换，直到下一个 $\\texttt{CapsLock}$ 出现；\n- 给定 $q$ 组询问，每次询问第 $x$ 个不为 $\\texttt{CapsLock}$ 的字符串。\n\n### 原题面\n\n星之灵可以对你说 $n$ 句话，你需要对其做记录。\n\n每句话可能是一个不等于 $\\texttt{CapsLock}$ 的字符串，也可以是一个命令 $\\texttt{CapsLock}$，其作用是控制星之灵说出的所有字母的大小写，当说出一次 $\\texttt{CapsLock}$ 时，之后说出的所有小写字母均需变为大写，大写字母均需变为小写，第二次说出 $\\texttt{CapsLock}$ 时又变为正常，以此类推。特别地，对于星之灵说出的 $\\texttt{CapsLock}$ 命令，你无须记录。\n\n星之灵将会不断重复说出这 $n$ 句话，且不改变顺序，而且他有 $q$ 次询问，每次询问都请你告诉星之灵，你记录的第 $x$ 句话是什么。", "inputFormat": "**本题使用多组数据测试。**\n\n第一行一个整数 $n$；\n\n接下来一行 $n$ 个字符串；\n\n第三行一个整数 $q$；\n\n接下来 $q$ 行，每行一个正整数 $x$。\n\n$n,q,x$ 的含义见题面。", "outputFormat": "输出 $q$ 行，每行一个字符串对应一次询问的答案。", "hint": "### 样例 #1 解释\n\n前四次记录的语句分别为：$a,b,A,B$。\n\n### 数据范围\n\n| $\\textbf{Subtask}$ | $n,q \\le$ | $x\\le $ | 特殊性质 | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $10$ | $100$ | $A$ | $30$ |\n| $2$ | $10^4$ | $10^5$ | / | $30$ |\n| $3$ | $10^5$ | $10^{18}$ | / | $40$ |\n\n对于所有数据，$1 \\leq n,q \\leq 10^5,1 \\leq x \\leq 10^{18}$\n\n性质 $A$：输入字符串中不存在 $\\texttt{CapsLock}$。\n\n### 数据保证\n\n- 所有语句中至少包含一个不为 $\\texttt{CapsLock}$ 的字符串；\n- 所有输入的字符串长度不大于 $10$；\n- 所有输入的字符串不为空且仅包含大小写字母。", "locale": "zh-CN"}}}
{"pid": "P8574", "type": "P", "difficulty": 4, "samples": [["7\n1\n5\n12\n95\n2040\n1145141920209\n1070909051", "1.000000\n4.000000\n6.500000\n38.666667\n403.857143\n1475989956.412959\n1.000000"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["Special Judge", "O2优化"], "title": "「DTOI-2」星之影", "background": ">闻是白极影，见时方立竿。", "description": "白极影化为立竿之人莅临人间，带来了星之函数 $f(x)$，它的值为最接近于 $\\sqrt[4]x$ 的整数$\\\\$（即 $f(x)=\\left\\lfloor\\sqrt[4]x+\\dfrac12\\right\\rfloor$；$\\lfloor u\\rfloor$ 为对 $u$ 向下取整后的值）。\n\n现有 $t$ 个数字 $n$，对于每个 $n$，立竿人想知道 $\\sum\\limits_{i=1}^n\\dfrac1{f(i)}$ 的值是多少，请你告诉它吧。\n\n---\n~~因为立竿人很急，所以~~本题的 $t$ 组询问强制在线，后一个询问需通过前一个询问的答案生成。\n\n可用以下 `C++` 代码生成（其他语言同理；需包含 `<stdio.h>`）：\n```cpp\ntypedef long long ll;\nchar buf_ans[114];\nll next_n(double last_ans=0,ll get_n=0){\n\t//last_ans<n<=1e18\n\tsprintf(buf_ans,\"%.6f\",last_ans);\n\tfor(ll i=0,x=0;;i++){\n\t\tif(buf_ans[i]=='.')return get_n^x;\n\t\tif(i&1)x*=10;\n\t\telse x=x*10+(buf_ans[i]^48);\n\t}\n}\n```\n该函数第一个参数为上一次询问的答案（第一次询问时该值为 $0$，也就是说第一个数未经加密），第二个参数为这一次读入的被加密的数，函数返回解密后的 $n$。", "inputFormat": "\n\n第一行一个整数 $t$，表示数据组数（询问次数）。\n\n对于每组数据，仅一行一个整数表示加密后的 $n$（第一个 $n$ 未被加密）。", "outputFormat": "每行输出一个六位小数，表示答案。", "hint": "### 样例解释\n\n样例#1 解密后各组询问分别是：\n$$\n\\def\\r{\\cr\\hline}\n\\def\\arraystretch{1.5}\\begin{array}{|c|c|c|c|c|c|c|c|}\\hline\n\\textbf{t}&1&2&3&4&5&6&7\\r\n\\textbf{n}&1&4&8&89&2022&1145141919810&1\\r\n\\end{array}\n$$\n### 数据范围\n\n**本题采用捆绑测试。**\n$$\n\\def\\arraystretch{1.5}\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & t= & n\\le&\\bm{\\textbf{Score}} \\cr\\hline\n1 & 10&10^6 & 2 \\cr\\hline\n2&1000&10^6&13\\cr\\hline\n3&100&10^9&15\\cr\\hline\n4 &1000&10^{18}&40\\cr\\hline\n5 &%\\text{No Special Constraints}\n5\\times10^5&10^{18}& 30 \\cr\\hline\n\\end{array}\n$$\n\n对于 $100\\%$ 的数据，$10 \\le t \\le 5\\times10^5$，$1 \\le n \\le 10^{18}$。\n\n### 计分规则\n\n本题采用 $\\textbf{Special Judge}$，令你输出的答案为 $\\text{pans}$，标答答案为 $\\text{jans}$，如果 $\\vert \\text{pans}-\\text{jans}\\vert<\\text{jans}\\times10^{-5}$ 那么该组数据通过，在一个测试点内只有所有 $t$ 组数据通过该测试点才算通过。\n\n注意后一个 $\\text{Subtask}$ 对前一个 $\\text{Subtask}$ 有依赖关系，即如果你没有在前一个 $\\text{Subtask}$ 拿到分，那么你即使通过后一个 $\\text{Subtask}$ 的所有测试点，你也无法拿到后面的分数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DTOI-2」星之影", "background": ">闻是白极影，见时方立竿。", "description": "白极影化为立竿之人莅临人间，带来了星之函数 $f(x)$，它的值为最接近于 $\\sqrt[4]x$ 的整数$\\\\$（即 $f(x)=\\left\\lfloor\\sqrt[4]x+\\dfrac12\\right\\rfloor$；$\\lfloor u\\rfloor$ 为对 $u$ 向下取整后的值）。\n\n现有 $t$ 个数字 $n$，对于每个 $n$，立竿人想知道 $\\sum\\limits_{i=1}^n\\dfrac1{f(i)}$ 的值是多少，请你告诉它吧。\n\n---\n~~因为立竿人很急，所以~~本题的 $t$ 组询问强制在线，后一个询问需通过前一个询问的答案生成。\n\n可用以下 `C++` 代码生成（其他语言同理；需包含 `<stdio.h>`）：\n```cpp\ntypedef long long ll;\nchar buf_ans[114];\nll next_n(double last_ans=0,ll get_n=0){\n\t//last_ans<n<=1e18\n\tsprintf(buf_ans,\"%.6f\",last_ans);\n\tfor(ll i=0,x=0;;i++){\n\t\tif(buf_ans[i]=='.')return get_n^x;\n\t\tif(i&1)x*=10;\n\t\telse x=x*10+(buf_ans[i]^48);\n\t}\n}\n```\n该函数第一个参数为上一次询问的答案（第一次询问时该值为 $0$，也就是说第一个数未经加密），第二个参数为这一次读入的被加密的数，函数返回解密后的 $n$。", "inputFormat": "\n\n第一行一个整数 $t$，表示数据组数（询问次数）。\n\n对于每组数据，仅一行一个整数表示加密后的 $n$（第一个 $n$ 未被加密）。", "outputFormat": "每行输出一个六位小数，表示答案。", "hint": "### 样例解释\n\n样例#1 解密后各组询问分别是：\n$$\n\\def\\r{\\cr\\hline}\n\\def\\arraystretch{1.5}\\begin{array}{|c|c|c|c|c|c|c|c|}\\hline\n\\textbf{t}&1&2&3&4&5&6&7\\r\n\\textbf{n}&1&4&8&89&2022&1145141919810&1\\r\n\\end{array}\n$$\n### 数据范围\n\n**本题采用捆绑测试。**\n$$\n\\def\\arraystretch{1.5}\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & t= & n\\le&\\bm{\\textbf{Score}} \\cr\\hline\n1 & 10&10^6 & 2 \\cr\\hline\n2&1000&10^6&13\\cr\\hline\n3&100&10^9&15\\cr\\hline\n4 &1000&10^{18}&40\\cr\\hline\n5 &%\\text{No Special Constraints}\n5\\times10^5&10^{18}& 30 \\cr\\hline\n\\end{array}\n$$\n\n对于 $100\\%$ 的数据，$10 \\le t \\le 5\\times10^5$，$1 \\le n \\le 10^{18}$。\n\n### 计分规则\n\n本题采用 $\\textbf{Special Judge}$，令你输出的答案为 $\\text{pans}$，标答答案为 $\\text{jans}$，如果 $\\vert \\text{pans}-\\text{jans}\\vert<\\text{jans}\\times10^{-5}$ 那么该组数据通过，在一个测试点内只有所有 $t$ 组数据通过该测试点才算通过。\n\n注意后一个 $\\text{Subtask}$ 对前一个 $\\text{Subtask}$ 有依赖关系，即如果你没有在前一个 $\\text{Subtask}$ 拿到分，那么你即使通过后一个 $\\text{Subtask}$ 的所有测试点，你也无法拿到后面的分数。", "locale": "zh-CN"}}}
{"pid": "P8575", "type": "P", "difficulty": 6, "samples": [["10\n2 1\n3 1\n4 3\n5 1\n6 4\n7 2\n8 2\n9 4\n10 3\n3 1\n2 4\n-3 3\n4 -2\n-2 3\n-3 -6\n-5 -1\n-4 -7\n-5 -1\n-7 -7", "5\n2\n3\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["cdq 分治"], "title": "「DTOI-2」星之河", "background": "> 星稀河影转，霜重月华孤。", "description": "星之统治者有一个星盘，其可以被抽象为一棵根节点为 $1$ 的树。树上每个节点 $i$ 有一颗红星、一颗蓝星，亮度分别记为 $\\text{Red}_i,\\text{Blue}_i$。\n\n现在，星之统治者想要知道，对于每个节点 $x$，其子树内（不包括该节点）有多少节点满足：其红星亮度小于等于 $x$ 的红星亮度，且其蓝星亮度小于等于 $x$ 的蓝星亮度。\n\n你需要按编号顺序依次输出每个节点的答案。为减少输出量，**如果答案为 $0$ 则不必输出。**", "inputFormat": "第一行一个整数表示 $n$。\n\n接下来 $n-1$ 行每行两个正整数 $u,v$，表示存在 $(u,v)$ 这条树边。\n\n接下来 $n$ 行每行两个整数分别表示 $\\text{Red}_i, \\text{Blue}_i$。", "outputFormat": "每个答案非 $0$ 的节点一行，每行一个整数表示答案。", "hint": "### 样例解释\n\n对于节点 $1$，小于等于他的子节点有 $6,7,8,9,10$，因此输出 $5$。  \n对于节点 $4$，小于等于他的子节点有 $6$，因此输出 $1$。  \n对于节点 $5 $ 至 $10$，没有小于等于他的子节点，因此不输出。\n\n### 数据范围\n\n| $\\textbf{Subtask}$| $n\\le$ | 特殊性质 | 总分数 |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $1000$ | 无 | $10$ |\n| $2$ | $5\\times 10^4$ | 无 | $20$ ||\n| $3$ | $10^5$ | $-200\\le \\text{Red}_i, \\text{Blue}_i \\le 200$ | $20$ |\n| $4$ | $2\\times 10^5$ | 树的形态是链 | $20$ |\n| $5$ | $2\\times 10^5$ | 无 | $30$ |\n\n对于所有数据，保证 $n \\le 2\\times 10^5$，$-10^9 \\le \\text{Red}_i, \\text{Blue}_i \\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DTOI-2」星之河", "background": "> 星稀河影转，霜重月华孤。", "description": "星之统治者有一个星盘，其可以被抽象为一棵根节点为 $1$ 的树。树上每个节点 $i$ 有一颗红星、一颗蓝星，亮度分别记为 $\\text{Red}_i,\\text{Blue}_i$。\n\n现在，星之统治者想要知道，对于每个节点 $x$，其子树内（不包括该节点）有多少节点满足：其红星亮度小于等于 $x$ 的红星亮度，且其蓝星亮度小于等于 $x$ 的蓝星亮度。\n\n你需要按编号顺序依次输出每个节点的答案。为减少输出量，**如果答案为 $0$ 则不必输出。**", "inputFormat": "第一行一个整数表示 $n$。\n\n接下来 $n-1$ 行每行两个正整数 $u,v$，表示存在 $(u,v)$ 这条树边。\n\n接下来 $n$ 行每行两个整数分别表示 $\\text{Red}_i, \\text{Blue}_i$。", "outputFormat": "每个答案非 $0$ 的节点一行，每行一个整数表示答案。", "hint": "### 样例解释\n\n对于节点 $1$，小于等于他的子节点有 $6,7,8,9,10$，因此输出 $5$。  \n对于节点 $4$，小于等于他的子节点有 $6$，因此输出 $1$。  \n对于节点 $5 $ 至 $10$，没有小于等于他的子节点，因此不输出。\n\n### 数据范围\n\n| $\\textbf{Subtask}$| $n\\le$ | 特殊性质 | 总分数 |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $1000$ | 无 | $10$ |\n| $2$ | $5\\times 10^4$ | 无 | $20$ ||\n| $3$ | $10^5$ | $-200\\le \\text{Red}_i, \\text{Blue}_i \\le 200$ | $20$ |\n| $4$ | $2\\times 10^5$ | 树的形态是链 | $20$ |\n| $5$ | $2\\times 10^5$ | 无 | $30$ |\n\n对于所有数据，保证 $n \\le 2\\times 10^5$，$-10^9 \\le \\text{Red}_i, \\text{Blue}_i \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P8576", "type": "P", "difficulty": 6, "samples": [["3 3\n2 3 5\n2 1 3\n1 1 3 2 4\n2 1 2", "2520\n35"], ["5 5\n4 6 7 8 9\n1 2 4 9 8\n1 3 5 8 9\n2 3 5\n2 1 3\n2 1 2", "412013881\n4084080\n210"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [523264, 523264, 523264, 523264, 523264, 523264, 523264, 523264, 523264, 523264, 523264, 523264, 523264, 523264, 523264]}, "tags": ["O2优化", "分块"], "title": "「DTOI-2」星之界", "background": ">天仙开碧落，银界失黄昏。", "description": "夜空中的星星组成了一个序列 $a$，序列中的第 $i$ 个数表示第 $i$ 颗星星的亮度。\n\n现在，作为星之眷顾者的你，拥有两种方式来操作星星。\n\n- 操作一：输入格式为 $\\texttt{1 l r x y}$，表示将 $[l,r]$ 内所有亮为 $x$ 的星星的亮度改为 $y$。\n \n- 操作二：输入格式为 $\\texttt{2 l r}$，表示输出 $ \\prod\\limits_{i = l}^{r} C_{\\sum_{j = l}^{i}a_j}^{a_i}\\ \\bmod 998244353 $ 的值。", "inputFormat": "输入第一行，两个整数 $n,q$，表示序列长度与操作次数。\n\n第二行，$n$ 个整数，表示初始序列值。\n\n接下来 $q$ 行，每行一个操作，格式由上方给出。", "outputFormat": "对于每个 $2$ 操作，输出所求值。", "hint": "**样例解释#1**\n\n直接按照题意计算可得。\n\n\n\n| $\\textbf{Subtask}$ | $n \\le$ | $q \\le$ | 特殊性质 | 总分数 |\n| :----------: | :---------------: | :---------------: | :-------------: | :---: |\n| $1$ | $10$ | $15$ | 无 | $5$ |\n| $2$ | $10^3$ | $10^3$ | 无 | $10$ |\n| $3$ | $5\\times 10^4$ | $5\\times 10^4$ | 只有操作 $2$ | $10$ |\n| $4$ | $5\\times 10^4$ | $5\\times 10^4$ | 只有一次操作 $2$ | $10$ |\n| $5$ | $5\\times 10^4$ | $5\\times 10^4$ | 无 | $21$ |\n| $6$ | $10^5$ | $10^5$ | $\\sum a[i] \\le 5\\times 10^5$ | $14$ |\n| $7$ | $10^5$ | $10^5$ | 无 | $30$ |\n\n对于 $100\\%$ 的数据，$1 \\le n,q,a_i \\le 10^5$。有 $1 \\le l,r\\le n;1 \\le x,y\\le 10^5$。\n\n任意时刻 $\\sum a$ 不会超过 $10^7$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DTOI-2」星之界", "background": ">天仙开碧落，银界失黄昏。", "description": "夜空中的星星组成了一个序列 $a$，序列中的第 $i$ 个数表示第 $i$ 颗星星的亮度。\n\n现在，作为星之眷顾者的你，拥有两种方式来操作星星。\n\n- 操作一：输入格式为 $\\texttt{1 l r x y}$，表示将 $[l,r]$ 内所有亮为 $x$ 的星星的亮度改为 $y$。\n \n- 操作二：输入格式为 $\\texttt{2 l r}$，表示输出 $ \\prod\\limits_{i = l}^{r} C_{\\sum_{j = l}^{i}a_j}^{a_i}\\ \\bmod 998244353 $ 的值。", "inputFormat": "输入第一行，两个整数 $n,q$，表示序列长度与操作次数。\n\n第二行，$n$ 个整数，表示初始序列值。\n\n接下来 $q$ 行，每行一个操作，格式由上方给出。", "outputFormat": "对于每个 $2$ 操作，输出所求值。", "hint": "**样例解释#1**\n\n直接按照题意计算可得。\n\n\n\n| $\\textbf{Subtask}$ | $n \\le$ | $q \\le$ | 特殊性质 | 总分数 |\n| :----------: | :---------------: | :---------------: | :-------------: | :---: |\n| $1$ | $10$ | $15$ | 无 | $5$ |\n| $2$ | $10^3$ | $10^3$ | 无 | $10$ |\n| $3$ | $5\\times 10^4$ | $5\\times 10^4$ | 只有操作 $2$ | $10$ |\n| $4$ | $5\\times 10^4$ | $5\\times 10^4$ | 只有一次操作 $2$ | $10$ |\n| $5$ | $5\\times 10^4$ | $5\\times 10^4$ | 无 | $21$ |\n| $6$ | $10^5$ | $10^5$ | $\\sum a[i] \\le 5\\times 10^5$ | $14$ |\n| $7$ | $10^5$ | $10^5$ | 无 | $30$ |\n\n对于 $100\\%$ 的数据，$1 \\le n,q,a_i \\le 10^5$。有 $1 \\le l,r\\le n;1 \\le x,y\\le 10^5$。\n\n任意时刻 $\\sum a$ 不会超过 $10^7$。", "locale": "zh-CN"}}}
{"pid": "P8577", "type": "P", "difficulty": 2, "samples": [["4\n5 9\n46 50\n114 514\n19 19810", "18\n3\n1134\n74924"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["模拟", "洛谷原创", "O2优化", "前缀和", "洛谷月赛"], "title": "[CoE R5] 暴龙的白菜", "background": "暴龙爱吃白菜。", "description": "给定一个字符串，由 $1$ 个 $\\texttt{1}$，$2$ 个 $\\texttt{2}$，$3$ 个 $\\texttt{3}$，$4$ 个 $\\texttt{4}$，$5$ 个 $\\texttt{5}$，$6$ 个 $\\texttt{6}$，$7$ 个 $\\texttt{7}$，$8$ 个 $\\texttt{8}$，$9$ 个 $\\texttt{9}$，$10$ 个 $\\texttt{10}$……以此类推，依次拼接而成。\n\n询问字符串第 $l$ 位到第 $r$ 位的数字之和。", "inputFormat": "**输入包含多组测试数据。**\n\n第一行一个正整数 $T$。\n\n接下来 $T$ 组问询，每次两个正整数 $l,r$。", "outputFormat": "$T$ 行，每行一个整数代表答案。", "hint": "**样例解释**\n\n字符串为：\n\n$$\\texttt{12233344445555566666677777778888888899999999910101010101010101010}\\cdots\\cdots$$\n\n对于第一组询问，第 $5$ 位到第 $9$ 位的数字之和为 $3+3+4+4+4=18$。\n\n对于第二组询问，第 $46$ 位到第 $50$ 位的数字之和为 $1 + 0 + 1 + 0 + 1 = 3$。\n\n------------\n\n**数据范围**\n\n**本题采用捆绑测试。**\n\n- $\\texttt{Subtask 1(10 pts)：}T=1$，$1\\le l\\le r\\le 10$；\n- $\\texttt{Subtask 2(20 pts)：}1\\le T\\le 10$，$1\\le l\\le r\\le 10^3$；\n- $\\texttt{Subtask 3(30 pts)：}1\\le T\\le 10^3$，$1\\le l\\le r\\le 10^5$；\n- $\\texttt{Subtask 4(40 pts)：}$无特殊限制。\n\n对于 $100\\%$ 的数据，满足 $1\\le T\\le 10^5$，$1\\le l\\le r\\le 10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CoE R5] 暴龙的白菜", "background": "暴龙爱吃白菜。", "description": "给定一个字符串，由 $1$ 个 $\\texttt{1}$，$2$ 个 $\\texttt{2}$，$3$ 个 $\\texttt{3}$，$4$ 个 $\\texttt{4}$，$5$ 个 $\\texttt{5}$，$6$ 个 $\\texttt{6}$，$7$ 个 $\\texttt{7}$，$8$ 个 $\\texttt{8}$，$9$ 个 $\\texttt{9}$，$10$ 个 $\\texttt{10}$……以此类推，依次拼接而成。\n\n询问字符串第 $l$ 位到第 $r$ 位的数字之和。", "inputFormat": "**输入包含多组测试数据。**\n\n第一行一个正整数 $T$。\n\n接下来 $T$ 组问询，每次两个正整数 $l,r$。", "outputFormat": "$T$ 行，每行一个整数代表答案。", "hint": "**样例解释**\n\n字符串为：\n\n$$\\texttt{12233344445555566666677777778888888899999999910101010101010101010}\\cdots\\cdots$$\n\n对于第一组询问，第 $5$ 位到第 $9$ 位的数字之和为 $3+3+4+4+4=18$。\n\n对于第二组询问，第 $46$ 位到第 $50$ 位的数字之和为 $1 + 0 + 1 + 0 + 1 = 3$。\n\n------------\n\n**数据范围**\n\n**本题采用捆绑测试。**\n\n- $\\texttt{Subtask 1(10 pts)：}T=1$，$1\\le l\\le r\\le 10$；\n- $\\texttt{Subtask 2(20 pts)：}1\\le T\\le 10$，$1\\le l\\le r\\le 10^3$；\n- $\\texttt{Subtask 3(30 pts)：}1\\le T\\le 10^3$，$1\\le l\\le r\\le 10^5$；\n- $\\texttt{Subtask 4(40 pts)：}$无特殊限制。\n\n对于 $100\\%$ 的数据，满足 $1\\le T\\le 10^5$，$1\\le l\\le r\\le 10^6$。", "locale": "zh-CN"}}}
{"pid": "P8578", "type": "P", "difficulty": 3, "samples": [["3\n1 2\n1 3", "1 2 3"], ["2\n1 2", "1 2"], ["5\n1 2\n2 3\n3 4\n4 5", "1 2 3 4 5"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["搜索", "洛谷原创", "Special Judge", "O2优化", "构造", "洛谷月赛"], "title": "[CoE R5] So What Do We Do Now?", "background": "![396ac9d3c58dbf329d6ead206944a5a495930006.jpg](https://img-kysic-1258722770.file.myqcloud.com/f2a3112865eea75d3c27aae713e1a8a8/ae2c3e0c34910.jpg)\n\n>$\\texttt{I'm getting tired of hiding.}$\n\n声明：上述图片取自网络，`pid:6544352`，如有侵权，告知即删。", "description": "给定一棵 $n$ 个结点的有根树，根结点编号为 $1$。设以 $i$ 为根的子树为 $T_i$。你需要给每个结点赋一个正整数点权 $v_i$，使得所有点的点权恰为 $1,2,\\dots,n$ 各一个。记\n$$f=\\sum_{i=1}^{n}R_i,$$\n其中 $R_i$ 是以 $i$ 为根的子树中点权的极差，即\n$$R_i=\\max_{j \\in T_i}\\{v_j\\}-\\min_{j \\in T_i}\\{v_j\\}.$$\n对于所有的赋点权的方式，请求出一组使 $f$ 取到最小值的点权。\n", "inputFormat": "第一行一个正整数 $n$ 表示树的结点数。\n\n接下来 $n-1$ 行，每行两个正整数 $u,v$，表示 $u,v$ 之间有一条边。", "outputFormat": "第一行一个 $1,2,\\dots,n$ 的排列，表示结点 $1,2,\\dots,n$ 的点权。由于赋点权的方式可能有很多种，你只需要输出其中任意一种即可。", "hint": "**样例说明**\n\n输入 $\\#1$\n\n![graph.png](https://img-kysic-1258722770.file.myqcloud.com/4a372f1ae46e27a31fae60c4db5e439e/af9581fa182de.png)\n\n$R_1=3-1=2,R_2=2-2=0,R_3=3-3=0,f=R_1+R_2+R_3=2$，可以证明，不存在使得 $f$ 更小的构造。\n\n\n------------\n\n**数据范围**\n\n对于 $10\\%$ 的数据，$n \\le 10$；\n\n对于另外 $10\\%$ 的数据，树是一条链；\n\n对于另外 $20\\%$ 的数据，有一个结点与其他 $n-1$ 个结点都相连；\n\n对于另外 $20\\%$ 的数据，树是一棵完全二叉树，即除了叶子结点外每个结点都恰有两个子结点；\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CoE R5] So What Do We Do Now?", "background": "![396ac9d3c58dbf329d6ead206944a5a495930006.jpg](https://img-kysic-1258722770.file.myqcloud.com/f2a3112865eea75d3c27aae713e1a8a8/ae2c3e0c34910.jpg)\n\n>$\\texttt{I'm getting tired of hiding.}$\n\n声明：上述图片取自网络，`pid:6544352`，如有侵权，告知即删。", "description": "给定一棵 $n$ 个结点的有根树，根结点编号为 $1$。设以 $i$ 为根的子树为 $T_i$。你需要给每个结点赋一个正整数点权 $v_i$，使得所有点的点权恰为 $1,2,\\dots,n$ 各一个。记\n$$f=\\sum_{i=1}^{n}R_i,$$\n其中 $R_i$ 是以 $i$ 为根的子树中点权的极差，即\n$$R_i=\\max_{j \\in T_i}\\{v_j\\}-\\min_{j \\in T_i}\\{v_j\\}.$$\n对于所有的赋点权的方式，请求出一组使 $f$ 取到最小值的点权。\n", "inputFormat": "第一行一个正整数 $n$ 表示树的结点数。\n\n接下来 $n-1$ 行，每行两个正整数 $u,v$，表示 $u,v$ 之间有一条边。", "outputFormat": "第一行一个 $1,2,\\dots,n$ 的排列，表示结点 $1,2,\\dots,n$ 的点权。由于赋点权的方式可能有很多种，你只需要输出其中任意一种即可。", "hint": "**样例说明**\n\n输入 $\\#1$\n\n![graph.png](https://img-kysic-1258722770.file.myqcloud.com/4a372f1ae46e27a31fae60c4db5e439e/af9581fa182de.png)\n\n$R_1=3-1=2,R_2=2-2=0,R_3=3-3=0,f=R_1+R_2+R_3=2$，可以证明，不存在使得 $f$ 更小的构造。\n\n\n------------\n\n**数据范围**\n\n对于 $10\\%$ 的数据，$n \\le 10$；\n\n对于另外 $10\\%$ 的数据，树是一条链；\n\n对于另外 $20\\%$ 的数据，有一个结点与其他 $n-1$ 个结点都相连；\n\n对于另外 $20\\%$ 的数据，树是一棵完全二叉树，即除了叶子结点外每个结点都恰有两个子结点；\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^6$。", "locale": "zh-CN"}}}
{"pid": "P8579", "type": "P", "difficulty": 4, "samples": [["3 2 1 2\n1 2\n2 3\n", "2.0000000\n"], ["10 20 13 37\n1 2\n1 3\n1 5\n2 4\n2 5\n2 6\n3 4\n3 5\n3 7\n3 9\n3 10\n4 6\n4 7\n4 8\n5 7\n5 9\n7 8\n7 9\n7 10\n9 10\n", "3.6903390\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "图论", "二分", "洛谷原创", "Special Judge", "O2优化", "洛谷月赛", "2029"], "title": "[CoE R5/Stoi2029] 半岛铁盒", "background": "> 为什么这样子 你拉着我 说你有些犹豫  \n> 怎么这样子 雨还没停 你就撑伞要走  \n> 已经习惯 不去阻止你 过好一阵子 你就会回来  \n> 印象中的爱情 好像顶不住那时间  \n> ——《[半岛铁盒](https://www.bilibili.com/video/BV1fx411N7bU?p=26)》", "description": "**题意简述**\n\n给定一个 $n$ 个顶点 $m$ 条边的无向图，可能有重边自环，可能不连通。\n\n初始时每个顶点有点权，点权为随机正实数。现在需要重新分配每个顶点的点权，使得：\n\n1. 相邻顶点的点权中较大者与较小者之比不超过 $x$；\n\n2. 点权总和不变；\n\n3. 每个顶点的点权不小于初始时的 $\\dfrac{p}{q}$。\n\n求最小的 $x \\ge 1$，使得对于给定的图，无论初始点权如何，均存在一种满足上述要求的重新分配方式。\n\n---\n\n**原版题面**\n\n神在半岛铁盒里创建了一个世界。\n\n这个世界由 $n$ 个地域和地域之间的 $m$ 条通道组成，每条通道连接两个地域。创世时每个地域有一定的气压，气压为正数。\n\n由于世界刚刚创建，比较混乱，所以两个地域之间可能有多条通道相连，一个地域也有可能有通道连接到自身，两个地域也可能无法通过若干条通道相互通行。\n\n由于通道连接的两个地域气压之比（大比小，下同）过大时会在通道里形成强风，使得跨地域旅行非常危险，所以造世神决定调整每个地域的气压使得每条通道连接的两个地域气压之比都不超过安全比值 $x$。显然 $x \\ge 1$。\n\n由于各种守恒定律被打破会很麻烦，所以神希望调整前后所有地域的气压之和不变。\n\n由于世界中的生物无法在过低的气压中生存但对高气压的适应力强，因此每个地域改变后的气压必须不低于初始的 $\\dfrac{p}{q}$。\n\n由于创世时气压不受神控制地随机，所以神希望安全比值 $x$ 满足无论初始气压如何都存在一种合适的调整气压的方法。\n\n由于通道越宽敞，通行越舒适，但是安全比值 $x$ 也越小，因此神想要求出满足要求的最小安全比值 $x$。\n\n由于神忙着处理创世事务，所以他钦定你来解决这个问题。", "inputFormat": "第一行四个正整数 $n,m,p,q$，含义如题。\n\n接下来 $m$ 行，每行两个正整数 $u,v$ 表示一条通道连接的两个地域的编号。", "outputFormat": "输出一个实数表示 $x$ 的最小值，保留 $7$ 位小数。\n\n本题采用 Special Judge，如果你的答案与参考答案的差值不超过参考答案值的 $10^{-4}$ 倍即为通过。", "hint": "**数据范围**\n\n对于 $10\\%$ 的数据，$np \\le q$；\n\n对于另外 $20\\%$ 的数据，有一个地域和其他所有地域之间有通道相连；\n\n对于另外 $30\\%$ 的数据，通道构成一棵树。\n\n对于 $100\\%$ 的数据，$1 \\le u,v \\le n \\le 10^3$，$1 \\le m \\le 3 \\times 10^4$，$1 \\le p<q \\le 10^7$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CoE R5/Stoi2029] 半岛铁盒", "background": "> 为什么这样子 你拉着我 说你有些犹豫  \n> 怎么这样子 雨还没停 你就撑伞要走  \n> 已经习惯 不去阻止你 过好一阵子 你就会回来  \n> 印象中的爱情 好像顶不住那时间  \n> ——《[半岛铁盒](https://www.bilibili.com/video/BV1fx411N7bU?p=26)》", "description": "**题意简述**\n\n给定一个 $n$ 个顶点 $m$ 条边的无向图，可能有重边自环，可能不连通。\n\n初始时每个顶点有点权，点权为随机正实数。现在需要重新分配每个顶点的点权，使得：\n\n1. 相邻顶点的点权中较大者与较小者之比不超过 $x$；\n\n2. 点权总和不变；\n\n3. 每个顶点的点权不小于初始时的 $\\dfrac{p}{q}$。\n\n求最小的 $x \\ge 1$，使得对于给定的图，无论初始点权如何，均存在一种满足上述要求的重新分配方式。\n\n---\n\n**原版题面**\n\n神在半岛铁盒里创建了一个世界。\n\n这个世界由 $n$ 个地域和地域之间的 $m$ 条通道组成，每条通道连接两个地域。创世时每个地域有一定的气压，气压为正数。\n\n由于世界刚刚创建，比较混乱，所以两个地域之间可能有多条通道相连，一个地域也有可能有通道连接到自身，两个地域也可能无法通过若干条通道相互通行。\n\n由于通道连接的两个地域气压之比（大比小，下同）过大时会在通道里形成强风，使得跨地域旅行非常危险，所以造世神决定调整每个地域的气压使得每条通道连接的两个地域气压之比都不超过安全比值 $x$。显然 $x \\ge 1$。\n\n由于各种守恒定律被打破会很麻烦，所以神希望调整前后所有地域的气压之和不变。\n\n由于世界中的生物无法在过低的气压中生存但对高气压的适应力强，因此每个地域改变后的气压必须不低于初始的 $\\dfrac{p}{q}$。\n\n由于创世时气压不受神控制地随机，所以神希望安全比值 $x$ 满足无论初始气压如何都存在一种合适的调整气压的方法。\n\n由于通道越宽敞，通行越舒适，但是安全比值 $x$ 也越小，因此神想要求出满足要求的最小安全比值 $x$。\n\n由于神忙着处理创世事务，所以他钦定你来解决这个问题。", "inputFormat": "第一行四个正整数 $n,m,p,q$，含义如题。\n\n接下来 $m$ 行，每行两个正整数 $u,v$ 表示一条通道连接的两个地域的编号。", "outputFormat": "输出一个实数表示 $x$ 的最小值，保留 $7$ 位小数。\n\n本题采用 Special Judge，如果你的答案与参考答案的差值不超过参考答案值的 $10^{-4}$ 倍即为通过。", "hint": "**数据范围**\n\n对于 $10\\%$ 的数据，$np \\le q$；\n\n对于另外 $20\\%$ 的数据，有一个地域和其他所有地域之间有通道相连；\n\n对于另外 $30\\%$ 的数据，通道构成一棵树。\n\n对于 $100\\%$ 的数据，$1 \\le u,v \\le n \\le 10^3$，$1 \\le m \\le 3 \\times 10^4$，$1 \\le p<q \\le 10^7$。", "locale": "zh-CN"}}}
{"pid": "P8580", "type": "P", "difficulty": 6, "samples": [["2 8\n200 400\n200 400", "888921"], ["7 8\n321 637\n321 637\n321 637\n321 637\n321 637\n321 637\n321 637", "818968"], ["6 10\n338 270\n229 413\n132 133\n141 173\n157 686\n616 250", "315860"], ["8 10\n338 270\n229 413\n132 133\n141 173\n157 686\n616 250\n0 0\n0 0", "-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "数学", "洛谷原创", "O2优化", "期望", "高斯消元", "洛谷月赛"], "title": "[CoE R5] 罚球", "background": "", "description": "有 $n$ 个人在玩罚球游戏，游戏规则如下：\n- 每个人编号为 $1,2,\\dots,n$，最开始由 $1$ 号罚球，接下来让下一个没有出局的人罚球。特殊地，$n$ 号的下一个是 $1$ 号。\n- 如果罚球者没有碰到篮板，那么直接出局。\n- 如果罚球者碰到篮板但没有进球，那么如果上一个人进球了，这个人就会出局，否则不会出局。\n- 游戏结束的条件是最后只剩下一个人。\n\n注意最开始的那个人碰到篮板但没有进球不出局。\n\n这 $n$ 个人中，第 $i$ 个人碰不到篮板的概率为 $\\dfrac{a_i}{1000}$，碰到篮板但没有进球的概率为 $\\dfrac{b_i}{1000}$，求游戏结束时所有人总共罚球数量的期望值。", "inputFormat": "第一行两个整数 $n,t$，为人数和子任务编号。  \n接下来 $n$ 行，每行两个整数，为 $a_i,b_i$，保证 $0\\le a_i+b_i\\le1000$。", "outputFormat": "输出一行，为所有人总共罚球数量的期望值，如果永远不会结束，那么输出 $-1$。否则，输出对 $10^6+33$ 取模的值。", "hint": "**关于取模**\n\n不会有理数取模的看[这里](https://www.luogu.com.cn/problem/P2613)。\n\n\n\n------------\n**样例说明**\n\n输入 $\\#1$：\n\n所有人碰不到篮板的概率都是 $\\dfrac{1}{5}$，碰到篮板但不进球的概率都是 $\\dfrac{2}{5}$，罚球数量的期望值为 $\\dfrac{25}{9}$。\n\n计算如下（黑色表示出局，红色表示没进球但不出局，蓝色表示进球）：\n$$\\dfrac{1}{5}+\\red{\\dfrac{2}{5}}\\times(\\dfrac{1}{5}+\\red{\\dfrac{2}{5}}\\times(...)+\\blue{\\dfrac{2}{5}}\\times(...))+\\blue{\\dfrac{2}{5}}\\times(\\dfrac{3}{5}+\\blue{\\dfrac{2}{5}}\\times(...))=\\dfrac{25}{9}$$\n\n输入 $\\#2$：\n\n所有人碰不到篮板的概率都是 $\\dfrac{321}{1000}$，碰到篮板但不进球的概率都是 $\\dfrac{637}{1000}$，罚球数量的期望值为 $\\dfrac{1000000}{57959}$。\n\n------------\n\n**数据范围**\n\n**本题采用捆绑测试**。\n\n测试点性质：\n| $t=$ | 性质 | 分数 |\n| :----------: | :----------: | :----------: |\n| $1$ | $n=1$ | $2$ |\n| $2$ | $a_i=b_i=0$ | $2$ |\n| $3$ | $a_i=1000$ | $4$ |\n| $4$ | $b_i=1000$ | $4$ |\n| $5$ | $a_i=0,b_1=0,\\forall i>1,b_i=1000$ | $6$ |\n| $6$ | $a_i=b_i=500$ | $6$ |\n| $7$ | $a_i=0,b_i=500$ | $6$ |\n| $8$ | $a_i,b_i$ 均为定值，且答案不为 $-1$ | $19$ |\n| $9$ | $1 \\le n \\le 11$ | $26$ |\n| $10$ | $1 \\le n \\le 15$ | $8$ |\n| $11$ | 无特殊性质 | $17$ |\n\n**对于** $100\\%$ **的数据**，$1 \\le n \\le 18$，$0 \\le a_i,b_i,a_i+b_i \\le 1000$。\n\n本题的 $\\text{Subtask 10}$ 分为两部分计分，对应 $t \\in \\{10,11\\}$。\n\n保证不存在分母为 $10^6+33$ 的倍数的情况。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CoE R5] 罚球", "background": "", "description": "有 $n$ 个人在玩罚球游戏，游戏规则如下：\n- 每个人编号为 $1,2,\\dots,n$，最开始由 $1$ 号罚球，接下来让下一个没有出局的人罚球。特殊地，$n$ 号的下一个是 $1$ 号。\n- 如果罚球者没有碰到篮板，那么直接出局。\n- 如果罚球者碰到篮板但没有进球，那么如果上一个人进球了，这个人就会出局，否则不会出局。\n- 游戏结束的条件是最后只剩下一个人。\n\n注意最开始的那个人碰到篮板但没有进球不出局。\n\n这 $n$ 个人中，第 $i$ 个人碰不到篮板的概率为 $\\dfrac{a_i}{1000}$，碰到篮板但没有进球的概率为 $\\dfrac{b_i}{1000}$，求游戏结束时所有人总共罚球数量的期望值。", "inputFormat": "第一行两个整数 $n,t$，为人数和子任务编号。  \n接下来 $n$ 行，每行两个整数，为 $a_i,b_i$，保证 $0\\le a_i+b_i\\le1000$。", "outputFormat": "输出一行，为所有人总共罚球数量的期望值，如果永远不会结束，那么输出 $-1$。否则，输出对 $10^6+33$ 取模的值。", "hint": "**关于取模**\n\n不会有理数取模的看[这里](https://www.luogu.com.cn/problem/P2613)。\n\n\n\n------------\n**样例说明**\n\n输入 $\\#1$：\n\n所有人碰不到篮板的概率都是 $\\dfrac{1}{5}$，碰到篮板但不进球的概率都是 $\\dfrac{2}{5}$，罚球数量的期望值为 $\\dfrac{25}{9}$。\n\n计算如下（黑色表示出局，红色表示没进球但不出局，蓝色表示进球）：\n$$\\dfrac{1}{5}+\\red{\\dfrac{2}{5}}\\times(\\dfrac{1}{5}+\\red{\\dfrac{2}{5}}\\times(...)+\\blue{\\dfrac{2}{5}}\\times(...))+\\blue{\\dfrac{2}{5}}\\times(\\dfrac{3}{5}+\\blue{\\dfrac{2}{5}}\\times(...))=\\dfrac{25}{9}$$\n\n输入 $\\#2$：\n\n所有人碰不到篮板的概率都是 $\\dfrac{321}{1000}$，碰到篮板但不进球的概率都是 $\\dfrac{637}{1000}$，罚球数量的期望值为 $\\dfrac{1000000}{57959}$。\n\n------------\n\n**数据范围**\n\n**本题采用捆绑测试**。\n\n测试点性质：\n| $t=$ | 性质 | 分数 |\n| :----------: | :----------: | :----------: |\n| $1$ | $n=1$ | $2$ |\n| $2$ | $a_i=b_i=0$ | $2$ |\n| $3$ | $a_i=1000$ | $4$ |\n| $4$ | $b_i=1000$ | $4$ |\n| $5$ | $a_i=0,b_1=0,\\forall i>1,b_i=1000$ | $6$ |\n| $6$ | $a_i=b_i=500$ | $6$ |\n| $7$ | $a_i=0,b_i=500$ | $6$ |\n| $8$ | $a_i,b_i$ 均为定值，且答案不为 $-1$ | $19$ |\n| $9$ | $1 \\le n \\le 11$ | $26$ |\n| $10$ | $1 \\le n \\le 15$ | $8$ |\n| $11$ | 无特殊性质 | $17$ |\n\n**对于** $100\\%$ **的数据**，$1 \\le n \\le 18$，$0 \\le a_i,b_i,a_i+b_i \\le 1000$。\n\n本题的 $\\text{Subtask 10}$ 分为两部分计分，对应 $t \\in \\{10,11\\}$。\n\n保证不存在分母为 $10^6+33$ 的倍数的情况。", "locale": "zh-CN"}}}
{"pid": "P8581", "type": "P", "difficulty": 7, "samples": [["3\n1 2\n5 7 12\n1 1 10", "2"], ["3\n1 1\n2 2 12\n2 3 4", "9"], ["5\n1 2 2 1\n1 7 10 20 9\n1 1 1 1 1", "223"], ["12\n1 2 3 1 5 6 7 1 9 10 11\n4 10 2 1 50 1 20 9 40 2 15 10\n1 1 1 1 1 1 1 1 1 1 1 1", "124"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 3000, 3000, 3000, 3000, 3000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 327680, 327680, 327680, 327680, 327680, 262144, 262144, 262144, 262144, 262144, 327680, 327680, 327680, 327680, 327680]}, "tags": ["数学", "图论", "贪心", "堆", "洛谷原创", "O2优化", "洛谷月赛"], "title": "[CoE R5] X 细胞", "background": "", "description": "**题意简述**\n\n**有根树**为一个有向图，该有向图有一个特殊的顶点，称之为**根**，从根出发，存在唯一的有向路径到达图中的任意其他顶点。按照习惯，一般将有根树中的顶点称为**结点**。**子树**为有根树 $T$ 的一个子图且该子图是一棵以 $T$ 中某个结点为根的有根树。在有根树中，如果有一条边从结点 $i$ 出发，到达结点 $j$，则将结点 $i$ 称为结点 $j$ 的**父结点**，将结点 $j$ 称为结点 $i$ 的**子结点**。将有根树中不存在子结点的结点称为**叶结点**。\n\n给定有根树 $T$，第 $i$ 个结点具有权值 $a_i \\in \\mathbb{Z^+}$ 和 $b_i \\in \\mathbb{Z^+}$。\n\n令 $T'$ 为 $T$ 的一棵子树，$F_i$ 为 $T$ 中所有以结点 $i$ 为根的子树的集合。\n\n- 定义 $r(T') = \\frac {a(T')}{b(T')}$，其中 $a(T') = \\sum \\limits_{j \\in T'}{a_j}$，$b(T') = \\sum \\limits_{j \\in T'}{b_j}$。\n\n- 定义 $T_i$ 为一棵以结点 $i$ 为根的子树，$T_i$ 满足 $r(T_i) = \\min \\limits_{T' \\in F_i}r(T')$ 且具有最多的结点数量。\n\n- 定义 $S(T')$：对于 $T$ 中的某个结点 $j$，令其父结点为 $i$，则 $j \\in S(T')$ 当且仅当 $i \\in T'$ 但 $j \\notin T'$ 。\n\n给定一棵具有 $n$ 个结点的有根树 $T$，令根结点为 $i$，对其执行以下操作：\n\n（$1$）将根结点 $i$ 放入结点集合 $Q$，即初始时置 $Q \\leftarrow \\{i\\}$；\n\n（$2$）任取 $Q$ 中的一个元素，令其为 $j$，确定 $T_j$，对于结点 $k \\in S(T_j)$，置 $a_k \\leftarrow a_k + \\lceil r(T_j) \\rceil$；\n\n（$3$）从集合 $Q$ 中删除元素 $j$，并置 $Q \\leftarrow Q \\cup S(T_j)$；\n\n（$4$）若集合 $Q = \\varnothing $，结束操作，否则转步骤（$2$）。\n\n每执行一次步骤（$2$）就会确定一棵 $T$ 的子树，假设在结束操作时一共执行了  $m$ 次步骤（$2$）,令第 $i$ 次执行步骤（$2$）所确定的子树为 $K_i$，最小化以下 $W$ 值：\n\n$$W = 1 \\times \\lceil r(K_1) \\rceil + 2 \\times \\lceil r(K_2) \\rceil + \\cdots + m \\times \\lceil r(K_m) \\rceil = \\sum_{i = 1}^{m}i \\times \\lceil r(K_i) \\rceil$$\n\n$\\mathbb{Z^+}$ 表示全体正整数，$\\lceil x \\rceil$ 表示不小于 $x$ 的最小整数。\n\n------------\n\n**原版题面**\n\n$\\text{X}$ 细胞是来自于仙女座星系 $\\text{Gamma}$ 行星的一种古老生命形式。\n\n初始时，只有 $1$ 个 $\\text{X}$ 细胞，而 $\\text{X}$ 细胞可以通过直接分裂来产生后代 $\\text{X}$ 细胞。对于某个 $\\text{X}$ 细胞 $i$ 来说，如果它产生了一个直接后代 $\\text{X}$ 细胞 $j$，则将细胞 $i$ 称为细胞 $j$ 的**母细胞**，将细胞 $j$ 称为 $i$ 的**子细胞**。\n\n注意，母细胞、子细胞的定义不具有传递性。假设细胞 $i$ 产生了一个直接后代细胞 $j$，细胞 $j$ 又产生了一个直接后代细胞 $k$，则将 $j$ 称为 $i$ 的子细胞，$k$ 称为 $j$ 的子细胞，但 $k$ 不是 $i$ 的子细胞。\n\n每个 $\\text{X}$ 细胞具有活力值 $h_x$ 和体积 $v_x$，为了研究的方便，人们为 $\\text{X}$ 细胞定义了**变异指数**\n\n$$d_x = \\frac{h_x}{v_x}$$\n\n该指数用于衡量 $\\text{X}$ 细胞对环境的适应性，变异指数越低，细胞存活的概率越高。\n\n人们发现，当 $\\text{X}$ 细胞受到特定的外界刺激后，它会激活并开始一种被人们称为**同化**的过程来转变为一个 $\\text{Z}$ 细胞。在同化过程开始前，激活的 $\\text{X}$ 细胞会改变自身状态成为一个 $\\text{Y}$ 细胞，$\\text{Y}$ 细胞会不断吸收它的子细胞并进行融合，使得该子细胞成为 $\\text{Y}$ 细胞的一部分。\n\n在融合后，$\\text{Y}$ 细胞的活力值和体积为融合前的细胞活力值和体积的加和。也就是说，假设有 $n$ 个细胞经过融合成为一个 $\\text{Y}$ 细胞，这 $n$ 个细胞的活力值和体积分别为 $h_1$，$h_2$，…，$h_n$ 和 $v_1$，$v_2$，…，$v_n$，则融合完成后，该 $\\text{Y}$ 细胞的活力值 $h_y = \\sum_{i=1}^{n}h_i$，体积 $v_y = \\sum_{i=1}^{n}v_i$，变异指数 $d_y = \\frac{h_y}{v_y}$。\n\n在同化过程中，$\\text{Y}$ 细胞会遵循以下原则：\n\n- 如果某个子细胞 $j$ 的母细胞 $i$ 尚未被同化，则该子细胞 $j$ 不会被同化。\n- 能够使得 $\\text{Y}$ 细胞变异指数尽可能地小且同化尽可能多的细胞。\n\n当 $\\text{Y}$ 细胞无法再同化更多的细胞时，它会停止同化过程，转变为一个 $\\text{Z}$ 细胞并释放信息素（状态转变前后，细胞的活力值和体积不变）。该信息素会产生以下作用：令生成的 $\\text{Z}$ 细胞的变异指数为 $d_z = \\frac{h_z}{v_z}$，如果某个尚未被同化的子细胞 $j$ 的母细胞 $i$ 被该 $\\text{Z}$ 细胞同化，则该子细胞 $j$ 的活力值 $h_j$ 增加 $\\lceil d_z \\rceil$（$\\lceil x \\rceil$ 表示不小于 $x$ 的最小整数）。\n\n需要注意，在同化过程结束时，$\\text{Y}$ 细胞的变异指数要求尽可能地小，但在同化过程中，$\\text{Y}$ 细胞的变异指数并不要求时刻保持最小（参见输入 $\\#1$）。\n\n研究人员需要通过一种专用设备来产生激活 $\\text{X}$ 细胞的特定外界刺激，每次使用该设备都会消耗一定数量的激活剂，消耗的激活剂数量 $c_t$ 使用以下公式进行计算：\n\n$$c_t = t \\times \\lceil d_z \\rceil $$\n\n其中 $t$ 表示使用该设备的次数序号（初始时从 $1$ 开始计数），$d_z$ 表示该次激活最终生成的 $\\text{Z}$ 细胞的变异指数。\n\n由于母细胞会分泌信息素使得子细胞无法被激活，只能选择不存在母细胞或者母细胞已经被同化的 $\\text{X}$ 细胞作为特定外界刺激的对象，以使其激活并开始同化过程。\n\n给定所有 $\\text{X}$ 细胞之间的相互关系及其活力值和体积，鉴于激活剂非常难以制造，现在需要你制定一个最优的 $\\text{X}$ 细胞激活顺序方案，使得所有的 $\\text{X}$ 细胞均转变为 $\\text{Z}$ 细胞且消耗的激活剂数量最少。\n\n你只需要输出该最少值即可。\n", "inputFormat": "输入的第一行是一个整数 $n$，表示 $\\text{X}$ 细胞的数量。\n\n接下来的一行，包含 $n - 1$ 个整数，依次表示编号为 $2 \\sim n$ 的 $\\text{X}$ 细胞的母细胞的编号。\n\n接下来的一行，包含 $n$ 个整数，依次表示编号为 $i$ 的 $\\text{X}$ 细胞的活力值 $h_i$。\n\n再接下来的一行，包含 $n$ 个整数，依次表示编号为 $i$ 的 $\\text{X}$ 细胞的体积 $v_i$。\n\n初始的 $\\text{X}$ 细胞的编号为 $1$。\n\n\n------------\n\n**题意简述所对应的输入格式**：\n\n输入的第一行是一个整数 $n$，表示有根树结点的数量。\n\n接下来的一行，包含 $n - 1$ 个整数，依次表示编号为 $2 \\sim n$ 的结点的父结点的编号。\n\n接下来的一行，包含 $n$ 个整数，依次表示编号为 $i$ 的结点的权值 $a_i$。\n\n再接下来的一行，包含 $n$ 个整数，依次表示编号为 $i$ 的结点的权值 $b_i$。\n\n根结点的编号为 $1$。", "outputFormat": "输出一个整数，表示使得所有 $\\text{X}$ 细胞均转变为 $\\text{Z}$ 细胞所需消耗的激活剂数量的最少值。\n\n\n------------\n\n**题意简述所对应的输出格式**：\n\n输出一个整数，表示 $W$ 的最小值。", "hint": "**样例说明**\n\n输入 $\\#1$：\n\n- 激活细胞 $1$，同化细胞 $2、3$，产生的 $\\text{Z}$ 细胞活力值 $h_z = 24$，体积 $v_z = 12$，变异指数 $d_z = \\frac {h_z}{v_z} = \\frac {24}{12} = 2$。\n\n- $1$ 次激活总共最少需要消耗的激活剂数量为 $c_1 = t \\times \\lceil d_z \\rceil = 1 \\times \\lceil \\frac {24}{12} \\rceil = 1 \\times 2 = 2$。\n\n- 初始时 $\\text{Y}$ 细胞的变异指数为 $5$，当同化细胞 $2$ 后，变异指数为 $6$，当同化细胞 $3$ 后，变异指数变为 $2$。由此可见，在同化过程中，$\\text{Y}$ 细胞的变异指数并不是时刻都保持最小，只需在最后停止同化转变为 $\\text{Z}$ 细胞时为最小值即可。\n\n输入 $\\#2$：\n\n- 激活细胞 $1$，同化细胞 $2$，产生的 $\\text{Z}$ 细胞活力值 $h_z = 2 + 2 = 4$，体积 $v_z = 2 + 3 = 5$，变异指数 $d_z = \\frac {h_z}{v_z} = \\frac {4}{5}$，该次激活消耗的激活剂数量 $c_1 = t \\times \\lceil d_z \\rceil= 1 \\times \\lceil \\frac {4}{5} \\rceil = 1 \\times 1 = 1$，该 $\\text{Z}$ 细胞释放信息素使得细胞 $3$ 的活力值增加 $1$，则细胞 $3$ 的活力值变为 $13$；\n\n- 激活细胞 $3$，未同化其他细胞，产生的 $\\text{Z}$ 细胞活力值 $h_z = 13$，体积 $v_z = 4$，变异指数 $d_z = \\frac {h_z}{v_z} = \\frac {13}{4}$，该次激活消耗的激活剂数量 $c_2 = t \\times \\lceil d_z \\rceil = 2 \\times \\lceil \\frac {13}{4} \\rceil= 2 \\times 4 = 8$。\n\n- $2$ 次激活总共最少需要消耗的激活剂数量为 $c_1 + c_2 = 1 + 8 = 9$。\n\n\n输入 $\\#3$：\n\n- 激活细胞 $1$，未同化其他细胞，产生的 $\\text{Z}$ 细胞活力值 $h_z = 1$，体积 $v_z = 1$，变异指数 $d_z = \\frac {h_z}{v_z} = \\frac {1}{1} = 1$。总共消耗的激活剂数量 $c_1 = t \\times \\lceil d_z \\rceil = 1 \\times \\lceil 1 \\rceil = 1$。$\\text{Z}$ 细胞释放信息素，使得细胞 $2$、$5$ 的活力值各增加 $1$，细胞 $2$、$5$ 的活力值当前为 $8$、$10$。\n\n- 激活细胞 $2$，未同化其他细胞，产生的 $\\text{Z}$ 细胞活力值 $h_z = 8$，体积 $v_z = 1$，变异指数 $d_z = \\frac {h_z}{v_z} = \\frac {8}{1} = 8$。总共消耗的激活剂数量 $c_2 = t \\times \\lceil d_z \\rceil = 2 \\times \\lceil 8 \\rceil = 16$。$\\text{Z}$ 细胞释放信息素，使得细胞 $3$、$4$ 的活力值各增加 $8$，细胞 $3$、$4$ 的活力值当前为 $18$、$28$。\n\n- 激活细胞 $4$，未同化其他细胞，产生的 $\\text{Z}$ 细胞活力值 $h_z = 28$，体积 $v_z = 1$，变异指数 $d_z = \\frac {h_z}{v_z} = \\frac {28}{1} = 28$。总共消耗的激活剂数量 $c_3 = t \\times \\lceil d_z \\rceil = 3 \\times \\lceil 28 \\rceil = 84$。\n\n- 激活细胞 $3$，未同化其他细胞，产生的 $\\text{Z}$ 细胞活力值 $h_z = 18$，体积 $v_z = 1$，变异指数 $d_z = \\frac {h_z}{v_z} = \\frac {18}{1} = 18$。总共消耗的激活剂数量 $c_4 = t \\times \\lceil d_z \\rceil = 4 \\times \\lceil 18 \\rceil = 72$。\n\n- 激活细胞 $5$，未同化其他细胞，产生的 $\\text{Z}$ 细胞活力值 $h_z = 10$，体积 $v_z = 1$，变异指数 $d_z = \\frac {h_z}{v_z} = \\frac {10}{1} = 10$。总共消耗的激活剂数量 $c_5 = t \\times \\lceil d_z \\rceil = 5 \\times \\lceil 10 \\rceil = 50$。\n\n- $5$ 次激活总共最少需要消耗的激活剂数量为 $c_1 + c_2 + c_3 + c_4 + c_5 = 1 + 16 + 84 + 72 + 50 = 223$。\n\n输入 $\\#4$：\n\n- 激活细胞 $1$，未同化其他细胞，产生的 $\\text{Z}$ 细胞变异指数 $d_z = \\frac {h_z}{v_z} = \\frac {4}{1}$，释放信息素使得细胞 $2、5、9$ 的活力值增加 $4$，消耗激活剂 $c_1 = 1 \\times \\lceil \\frac {4}{1} \\rceil = 1 \\times 4 = 4$。\n\n- 激活细胞 $5$，同化细胞 $6、7、8$，产生的 $\\text{Z}$ 细胞变异指数 $d_z = \\frac {h_z}{v_z} = \\frac {84}{4}$，消耗激活剂 $c_2 = 2 \\times \\lceil \\frac {84}{4} \\rceil = 2 \\times 21 = 42$。\n\n- 激活细胞 $9$，同化细胞 $10、11、12$，产生的 $\\text{Z}$ 细胞变异指数 $d_z = \\frac {h_z}{v_z} = \\frac {71}{4}$，消耗激活剂 $c_3 = 3 \\times \\lceil \\frac {71}{4} \\rceil = 3 \\times 18 = 54$。\n\n- 激活细胞 $2$，同化细胞 $3、4$，产生的 $\\text{Z}$ 细胞变异指数 $d_z = \\frac {h_z}{v_z} = \\frac {17}{3}$，消耗激活剂 $c_4 = 4 \\times \\lceil \\frac {17}{3} \\rceil = 4 \\times 6 = 24$。\n\n- $4$ 次激活总共最少需要消耗的激活剂数量为 $c_1 + c_2 + c_3 + c_4 = 4 + 42 + 54 + 24 = 124$。\n\n------------\n\n**数据范围**\n\n**本题采用捆绑测试。某些子任务的输入文件较大，请使用合适的输入读取方式。**\n\n| 子任务 | 分值 | $n \\leq$ | 特殊性质 | 时间限制 | 内存限制 | 子任务依赖 |\n| :-: | :-: | :-: | :-: | :-: | :-: | :-: |\n| $1$ | $10$ | $20$ |   | $1 \\text{ s}$ |  $256 \\text{ MB}$ | |\n| $2$ | $30$ | $10^3$ |   | $1 \\text{ s}$ | $256 \\text{ MB}$ | $1$ |\n| $3$ | $10$ | $10^5$ |   | $1 \\text{ s}$ | $256 \\text{ MB}$ | $1 \\sim 2$ |\n| $4$ | $10$ | $10^6$ | $\\text{A}$ | $3 \\text{ s}$ | $256 \\text{ MB}$ |  |\n| $5$ | $20$ | $10^6$ | $\\text{B}$ | $1 \\text{ s}$ | $320 \\text{ MB}$ |  |\n| $6$ | $10$ | $10^6$ | $\\text{C}$ | $1 \\text{ s}$ | $256 \\text{ MB}$ |  |\n| $7$ | $10$ | $10^6$ |   | $3 \\text{ s}$ | $320 \\text{ MB}$ | $1 \\sim 6$ |\n\n- 特殊性质 $\\text{A}$：即给定的有根树所对应的图是星形图。$\\forall \\  2 \\leq i \\leq n$，$f_i = 1$。\n- 特殊性质 $\\text{B}$：给定的有根树所对应的图是有向链。$\\forall \\ 2 \\leq i \\leq n$，$f_i = i - 1$。\n- 特殊性质 $\\text{C}$：数据随机生成。$\\forall \\ 2 \\leq i \\leq n$，$f_i$ 是 $[1, i - 1]$ 中随机选取的整数。$h_i, v_i$ 是 $[1, 10^6]$ 中随机选取的整数。\n\n\n对于 $100 \\%$ 的数据，$1 \\leq n \\leq 10^6$，$1 \\leq h_i \\leq 10^6$，$1 \\leq v_i \\leq 10^6$，答案不超过 $10^{18}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CoE R5] X 细胞", "background": "", "description": "**题意简述**\n\n**有根树**为一个有向图，该有向图有一个特殊的顶点，称之为**根**，从根出发，存在唯一的有向路径到达图中的任意其他顶点。按照习惯，一般将有根树中的顶点称为**结点**。**子树**为有根树 $T$ 的一个子图且该子图是一棵以 $T$ 中某个结点为根的有根树。在有根树中，如果有一条边从结点 $i$ 出发，到达结点 $j$，则将结点 $i$ 称为结点 $j$ 的**父结点**，将结点 $j$ 称为结点 $i$ 的**子结点**。将有根树中不存在子结点的结点称为**叶结点**。\n\n给定有根树 $T$，第 $i$ 个结点具有权值 $a_i \\in \\mathbb{Z^+}$ 和 $b_i \\in \\mathbb{Z^+}$。\n\n令 $T'$ 为 $T$ 的一棵子树，$F_i$ 为 $T$ 中所有以结点 $i$ 为根的子树的集合。\n\n- 定义 $r(T') = \\frac {a(T')}{b(T')}$，其中 $a(T') = \\sum \\limits_{j \\in T'}{a_j}$，$b(T') = \\sum \\limits_{j \\in T'}{b_j}$。\n\n- 定义 $T_i$ 为一棵以结点 $i$ 为根的子树，$T_i$ 满足 $r(T_i) = \\min \\limits_{T' \\in F_i}r(T')$ 且具有最多的结点数量。\n\n- 定义 $S(T')$：对于 $T$ 中的某个结点 $j$，令其父结点为 $i$，则 $j \\in S(T')$ 当且仅当 $i \\in T'$ 但 $j \\notin T'$ 。\n\n给定一棵具有 $n$ 个结点的有根树 $T$，令根结点为 $i$，对其执行以下操作：\n\n（$1$）将根结点 $i$ 放入结点集合 $Q$，即初始时置 $Q \\leftarrow \\{i\\}$；\n\n（$2$）任取 $Q$ 中的一个元素，令其为 $j$，确定 $T_j$，对于结点 $k \\in S(T_j)$，置 $a_k \\leftarrow a_k + \\lceil r(T_j) \\rceil$；\n\n（$3$）从集合 $Q$ 中删除元素 $j$，并置 $Q \\leftarrow Q \\cup S(T_j)$；\n\n（$4$）若集合 $Q = \\varnothing $，结束操作，否则转步骤（$2$）。\n\n每执行一次步骤（$2$）就会确定一棵 $T$ 的子树，假设在结束操作时一共执行了  $m$ 次步骤（$2$）,令第 $i$ 次执行步骤（$2$）所确定的子树为 $K_i$，最小化以下 $W$ 值：\n\n$$W = 1 \\times \\lceil r(K_1) \\rceil + 2 \\times \\lceil r(K_2) \\rceil + \\cdots + m \\times \\lceil r(K_m) \\rceil = \\sum_{i = 1}^{m}i \\times \\lceil r(K_i) \\rceil$$\n\n$\\mathbb{Z^+}$ 表示全体正整数，$\\lceil x \\rceil$ 表示不小于 $x$ 的最小整数。\n\n------------\n\n**原版题面**\n\n$\\text{X}$ 细胞是来自于仙女座星系 $\\text{Gamma}$ 行星的一种古老生命形式。\n\n初始时，只有 $1$ 个 $\\text{X}$ 细胞，而 $\\text{X}$ 细胞可以通过直接分裂来产生后代 $\\text{X}$ 细胞。对于某个 $\\text{X}$ 细胞 $i$ 来说，如果它产生了一个直接后代 $\\text{X}$ 细胞 $j$，则将细胞 $i$ 称为细胞 $j$ 的**母细胞**，将细胞 $j$ 称为 $i$ 的**子细胞**。\n\n注意，母细胞、子细胞的定义不具有传递性。假设细胞 $i$ 产生了一个直接后代细胞 $j$，细胞 $j$ 又产生了一个直接后代细胞 $k$，则将 $j$ 称为 $i$ 的子细胞，$k$ 称为 $j$ 的子细胞，但 $k$ 不是 $i$ 的子细胞。\n\n每个 $\\text{X}$ 细胞具有活力值 $h_x$ 和体积 $v_x$，为了研究的方便，人们为 $\\text{X}$ 细胞定义了**变异指数**\n\n$$d_x = \\frac{h_x}{v_x}$$\n\n该指数用于衡量 $\\text{X}$ 细胞对环境的适应性，变异指数越低，细胞存活的概率越高。\n\n人们发现，当 $\\text{X}$ 细胞受到特定的外界刺激后，它会激活并开始一种被人们称为**同化**的过程来转变为一个 $\\text{Z}$ 细胞。在同化过程开始前，激活的 $\\text{X}$ 细胞会改变自身状态成为一个 $\\text{Y}$ 细胞，$\\text{Y}$ 细胞会不断吸收它的子细胞并进行融合，使得该子细胞成为 $\\text{Y}$ 细胞的一部分。\n\n在融合后，$\\text{Y}$ 细胞的活力值和体积为融合前的细胞活力值和体积的加和。也就是说，假设有 $n$ 个细胞经过融合成为一个 $\\text{Y}$ 细胞，这 $n$ 个细胞的活力值和体积分别为 $h_1$，$h_2$，…，$h_n$ 和 $v_1$，$v_2$，…，$v_n$，则融合完成后，该 $\\text{Y}$ 细胞的活力值 $h_y = \\sum_{i=1}^{n}h_i$，体积 $v_y = \\sum_{i=1}^{n}v_i$，变异指数 $d_y = \\frac{h_y}{v_y}$。\n\n在同化过程中，$\\text{Y}$ 细胞会遵循以下原则：\n\n- 如果某个子细胞 $j$ 的母细胞 $i$ 尚未被同化，则该子细胞 $j$ 不会被同化。\n- 能够使得 $\\text{Y}$ 细胞变异指数尽可能地小且同化尽可能多的细胞。\n\n当 $\\text{Y}$ 细胞无法再同化更多的细胞时，它会停止同化过程，转变为一个 $\\text{Z}$ 细胞并释放信息素（状态转变前后，细胞的活力值和体积不变）。该信息素会产生以下作用：令生成的 $\\text{Z}$ 细胞的变异指数为 $d_z = \\frac{h_z}{v_z}$，如果某个尚未被同化的子细胞 $j$ 的母细胞 $i$ 被该 $\\text{Z}$ 细胞同化，则该子细胞 $j$ 的活力值 $h_j$ 增加 $\\lceil d_z \\rceil$（$\\lceil x \\rceil$ 表示不小于 $x$ 的最小整数）。\n\n需要注意，在同化过程结束时，$\\text{Y}$ 细胞的变异指数要求尽可能地小，但在同化过程中，$\\text{Y}$ 细胞的变异指数并不要求时刻保持最小（参见输入 $\\#1$）。\n\n研究人员需要通过一种专用设备来产生激活 $\\text{X}$ 细胞的特定外界刺激，每次使用该设备都会消耗一定数量的激活剂，消耗的激活剂数量 $c_t$ 使用以下公式进行计算：\n\n$$c_t = t \\times \\lceil d_z \\rceil $$\n\n其中 $t$ 表示使用该设备的次数序号（初始时从 $1$ 开始计数），$d_z$ 表示该次激活最终生成的 $\\text{Z}$ 细胞的变异指数。\n\n由于母细胞会分泌信息素使得子细胞无法被激活，只能选择不存在母细胞或者母细胞已经被同化的 $\\text{X}$ 细胞作为特定外界刺激的对象，以使其激活并开始同化过程。\n\n给定所有 $\\text{X}$ 细胞之间的相互关系及其活力值和体积，鉴于激活剂非常难以制造，现在需要你制定一个最优的 $\\text{X}$ 细胞激活顺序方案，使得所有的 $\\text{X}$ 细胞均转变为 $\\text{Z}$ 细胞且消耗的激活剂数量最少。\n\n你只需要输出该最少值即可。\n", "inputFormat": "输入的第一行是一个整数 $n$，表示 $\\text{X}$ 细胞的数量。\n\n接下来的一行，包含 $n - 1$ 个整数，依次表示编号为 $2 \\sim n$ 的 $\\text{X}$ 细胞的母细胞的编号。\n\n接下来的一行，包含 $n$ 个整数，依次表示编号为 $i$ 的 $\\text{X}$ 细胞的活力值 $h_i$。\n\n再接下来的一行，包含 $n$ 个整数，依次表示编号为 $i$ 的 $\\text{X}$ 细胞的体积 $v_i$。\n\n初始的 $\\text{X}$ 细胞的编号为 $1$。\n\n\n------------\n\n**题意简述所对应的输入格式**：\n\n输入的第一行是一个整数 $n$，表示有根树结点的数量。\n\n接下来的一行，包含 $n - 1$ 个整数，依次表示编号为 $2 \\sim n$ 的结点的父结点的编号。\n\n接下来的一行，包含 $n$ 个整数，依次表示编号为 $i$ 的结点的权值 $a_i$。\n\n再接下来的一行，包含 $n$ 个整数，依次表示编号为 $i$ 的结点的权值 $b_i$。\n\n根结点的编号为 $1$。", "outputFormat": "输出一个整数，表示使得所有 $\\text{X}$ 细胞均转变为 $\\text{Z}$ 细胞所需消耗的激活剂数量的最少值。\n\n\n------------\n\n**题意简述所对应的输出格式**：\n\n输出一个整数，表示 $W$ 的最小值。", "hint": "**样例说明**\n\n输入 $\\#1$：\n\n- 激活细胞 $1$，同化细胞 $2、3$，产生的 $\\text{Z}$ 细胞活力值 $h_z = 24$，体积 $v_z = 12$，变异指数 $d_z = \\frac {h_z}{v_z} = \\frac {24}{12} = 2$。\n\n- $1$ 次激活总共最少需要消耗的激活剂数量为 $c_1 = t \\times \\lceil d_z \\rceil = 1 \\times \\lceil \\frac {24}{12} \\rceil = 1 \\times 2 = 2$。\n\n- 初始时 $\\text{Y}$ 细胞的变异指数为 $5$，当同化细胞 $2$ 后，变异指数为 $6$，当同化细胞 $3$ 后，变异指数变为 $2$。由此可见，在同化过程中，$\\text{Y}$ 细胞的变异指数并不是时刻都保持最小，只需在最后停止同化转变为 $\\text{Z}$ 细胞时为最小值即可。\n\n输入 $\\#2$：\n\n- 激活细胞 $1$，同化细胞 $2$，产生的 $\\text{Z}$ 细胞活力值 $h_z = 2 + 2 = 4$，体积 $v_z = 2 + 3 = 5$，变异指数 $d_z = \\frac {h_z}{v_z} = \\frac {4}{5}$，该次激活消耗的激活剂数量 $c_1 = t \\times \\lceil d_z \\rceil= 1 \\times \\lceil \\frac {4}{5} \\rceil = 1 \\times 1 = 1$，该 $\\text{Z}$ 细胞释放信息素使得细胞 $3$ 的活力值增加 $1$，则细胞 $3$ 的活力值变为 $13$；\n\n- 激活细胞 $3$，未同化其他细胞，产生的 $\\text{Z}$ 细胞活力值 $h_z = 13$，体积 $v_z = 4$，变异指数 $d_z = \\frac {h_z}{v_z} = \\frac {13}{4}$，该次激活消耗的激活剂数量 $c_2 = t \\times \\lceil d_z \\rceil = 2 \\times \\lceil \\frac {13}{4} \\rceil= 2 \\times 4 = 8$。\n\n- $2$ 次激活总共最少需要消耗的激活剂数量为 $c_1 + c_2 = 1 + 8 = 9$。\n\n\n输入 $\\#3$：\n\n- 激活细胞 $1$，未同化其他细胞，产生的 $\\text{Z}$ 细胞活力值 $h_z = 1$，体积 $v_z = 1$，变异指数 $d_z = \\frac {h_z}{v_z} = \\frac {1}{1} = 1$。总共消耗的激活剂数量 $c_1 = t \\times \\lceil d_z \\rceil = 1 \\times \\lceil 1 \\rceil = 1$。$\\text{Z}$ 细胞释放信息素，使得细胞 $2$、$5$ 的活力值各增加 $1$，细胞 $2$、$5$ 的活力值当前为 $8$、$10$。\n\n- 激活细胞 $2$，未同化其他细胞，产生的 $\\text{Z}$ 细胞活力值 $h_z = 8$，体积 $v_z = 1$，变异指数 $d_z = \\frac {h_z}{v_z} = \\frac {8}{1} = 8$。总共消耗的激活剂数量 $c_2 = t \\times \\lceil d_z \\rceil = 2 \\times \\lceil 8 \\rceil = 16$。$\\text{Z}$ 细胞释放信息素，使得细胞 $3$、$4$ 的活力值各增加 $8$，细胞 $3$、$4$ 的活力值当前为 $18$、$28$。\n\n- 激活细胞 $4$，未同化其他细胞，产生的 $\\text{Z}$ 细胞活力值 $h_z = 28$，体积 $v_z = 1$，变异指数 $d_z = \\frac {h_z}{v_z} = \\frac {28}{1} = 28$。总共消耗的激活剂数量 $c_3 = t \\times \\lceil d_z \\rceil = 3 \\times \\lceil 28 \\rceil = 84$。\n\n- 激活细胞 $3$，未同化其他细胞，产生的 $\\text{Z}$ 细胞活力值 $h_z = 18$，体积 $v_z = 1$，变异指数 $d_z = \\frac {h_z}{v_z} = \\frac {18}{1} = 18$。总共消耗的激活剂数量 $c_4 = t \\times \\lceil d_z \\rceil = 4 \\times \\lceil 18 \\rceil = 72$。\n\n- 激活细胞 $5$，未同化其他细胞，产生的 $\\text{Z}$ 细胞活力值 $h_z = 10$，体积 $v_z = 1$，变异指数 $d_z = \\frac {h_z}{v_z} = \\frac {10}{1} = 10$。总共消耗的激活剂数量 $c_5 = t \\times \\lceil d_z \\rceil = 5 \\times \\lceil 10 \\rceil = 50$。\n\n- $5$ 次激活总共最少需要消耗的激活剂数量为 $c_1 + c_2 + c_3 + c_4 + c_5 = 1 + 16 + 84 + 72 + 50 = 223$。\n\n输入 $\\#4$：\n\n- 激活细胞 $1$，未同化其他细胞，产生的 $\\text{Z}$ 细胞变异指数 $d_z = \\frac {h_z}{v_z} = \\frac {4}{1}$，释放信息素使得细胞 $2、5、9$ 的活力值增加 $4$，消耗激活剂 $c_1 = 1 \\times \\lceil \\frac {4}{1} \\rceil = 1 \\times 4 = 4$。\n\n- 激活细胞 $5$，同化细胞 $6、7、8$，产生的 $\\text{Z}$ 细胞变异指数 $d_z = \\frac {h_z}{v_z} = \\frac {84}{4}$，消耗激活剂 $c_2 = 2 \\times \\lceil \\frac {84}{4} \\rceil = 2 \\times 21 = 42$。\n\n- 激活细胞 $9$，同化细胞 $10、11、12$，产生的 $\\text{Z}$ 细胞变异指数 $d_z = \\frac {h_z}{v_z} = \\frac {71}{4}$，消耗激活剂 $c_3 = 3 \\times \\lceil \\frac {71}{4} \\rceil = 3 \\times 18 = 54$。\n\n- 激活细胞 $2$，同化细胞 $3、4$，产生的 $\\text{Z}$ 细胞变异指数 $d_z = \\frac {h_z}{v_z} = \\frac {17}{3}$，消耗激活剂 $c_4 = 4 \\times \\lceil \\frac {17}{3} \\rceil = 4 \\times 6 = 24$。\n\n- $4$ 次激活总共最少需要消耗的激活剂数量为 $c_1 + c_2 + c_3 + c_4 = 4 + 42 + 54 + 24 = 124$。\n\n------------\n\n**数据范围**\n\n**本题采用捆绑测试。某些子任务的输入文件较大，请使用合适的输入读取方式。**\n\n| 子任务 | 分值 | $n \\leq$ | 特殊性质 | 时间限制 | 内存限制 | 子任务依赖 |\n| :-: | :-: | :-: | :-: | :-: | :-: | :-: |\n| $1$ | $10$ | $20$ |   | $1 \\text{ s}$ |  $256 \\text{ MB}$ | |\n| $2$ | $30$ | $10^3$ |   | $1 \\text{ s}$ | $256 \\text{ MB}$ | $1$ |\n| $3$ | $10$ | $10^5$ |   | $1 \\text{ s}$ | $256 \\text{ MB}$ | $1 \\sim 2$ |\n| $4$ | $10$ | $10^6$ | $\\text{A}$ | $3 \\text{ s}$ | $256 \\text{ MB}$ |  |\n| $5$ | $20$ | $10^6$ | $\\text{B}$ | $1 \\text{ s}$ | $320 \\text{ MB}$ |  |\n| $6$ | $10$ | $10^6$ | $\\text{C}$ | $1 \\text{ s}$ | $256 \\text{ MB}$ |  |\n| $7$ | $10$ | $10^6$ |   | $3 \\text{ s}$ | $320 \\text{ MB}$ | $1 \\sim 6$ |\n\n- 特殊性质 $\\text{A}$：即给定的有根树所对应的图是星形图。$\\forall \\  2 \\leq i \\leq n$，$f_i = 1$。\n- 特殊性质 $\\text{B}$：给定的有根树所对应的图是有向链。$\\forall \\ 2 \\leq i \\leq n$，$f_i = i - 1$。\n- 特殊性质 $\\text{C}$：数据随机生成。$\\forall \\ 2 \\leq i \\leq n$，$f_i$ 是 $[1, i - 1]$ 中随机选取的整数。$h_i, v_i$ 是 $[1, 10^6]$ 中随机选取的整数。\n\n\n对于 $100 \\%$ 的数据，$1 \\leq n \\leq 10^6$，$1 \\leq h_i \\leq 10^6$，$1 \\leq v_i \\leq 10^6$，答案不超过 $10^{18}$。", "locale": "zh-CN"}}}
{"pid": "P8582", "type": "P", "difficulty": 6, "samples": [["0 16 3\n0 0 3\n1 3 3\n0 0 3\n1 1 2\n0 0 3\n2 1 3\n0 0 3\n1 0 0\n1 1 1\n0 0 3\n0 1 2\n0 1 3\n1 2 3\n0 2 3\n2 3 3\n0 2 3", "0\n1\n6\n0\n4\n2\n2\nDeath\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["线段树", "洛谷原创", "O2优化", "字典树 Trie", "位运算", "洛谷月赛"], "title": "[CoE R5] 斑马王子", "background": "#### 注意：此题 Sub #4 中 $opt_i=3$，可视作 $opt_i=0$。数据将稍后修复，修复后将另行通知。\n\n#### UPD: 已修复。", "description": "**题意简述**\n\n有一长度为 $k+1$ 的数组 $s$，下标依次为 $0$ 到 $k$，初始时有 $s_i = 0 \\ (0 \\leqslant i \\leqslant k)$。\n接下来给定 $n$ 个非负整数二元组 $(l_i,\\ r_i)$，记 $T = \\bigcup\\limits_{i = 1}^n [l_i,\\ r_i] $，将所有符合 $i \\in T \\bigcap \\mathbb{Z}$ 的 $s_i$ 赋值为 $1$。\n在任意时刻，记 $S =\\{ x |x \\in \\mathbb{Z} \\bigwedge x \\in [0,\\ k] \\bigwedge s_x = 0 \\}$。接下来给定 $m$ 个非负整数三元组 $(opt_i,\\ a_i,\\ b_i)$。\n\n当 $opt_i = 0$ 时，求：\n\n$$t_i = \\sum\\limits_{x = a_i}^{b_i} \\min\\limits_{y \\in S}(x \\oplus y)$$\n\n当 $opt_i = 1$ 时，将所有符合 $i \\in [a_i,\\ b_i] \\bigcap \\mathbb{Z}$ 的 $s_i$ 赋值为 $1$。\n\n当 $opt_i = 2$ 时，将所有符合 $i \\in [a_i,\\ b_i] \\bigcap \\mathbb{Z}$ 的 $s_i$ 赋值为 $0$。\n\n符号 $\\mathbb{Z}$ 表示全体整数，$\\oplus$ 表示异或。\n\n---\n\n**原版题面**\n\n『斑马王子』统治着无垠的草原。\n\n一条小河无息地流淌在草原的中央，与河流源头距离为 $y$ 的草地被赋予了 $y \\ (0 \\leqslant y \\leqslant k)$ 的『膜力』。\n\n第 $x \\ (0 \\leqslant x \\leqslant k)$ 天，『斑马王子』的『潜力智商』为 $x$。\n\n他会来到一片自己心仪的草地用膳，并以 $x \\oplus y$ 的『智商』开始新的一天。\n\n有一种叫『猎人』的生物，热衷于剥夺草原居民的生命。\n\n他们初始时设立了 $n$ 个形如 $(l_i,\\ r_i) \\ (0 \\leqslant l_i \\leqslant r_i \\leqslant k)$ 的营地，用『枪』屠杀着所有在 $[l_i,\\ r_i]$ 中驻足的生灵。\n\n作为『斑马王子』的得力大臣，你需要回答他的若干个问题，以保证草原的安全。\n\n在风云变幻的草原上，会依次发生 $m$ 个形如 $(opt_i,\\ a_i,\\ b_i) \\ (0 \\leqslant a_i \\leqslant b_i \\leqslant k , \\ opt_i \\in \\{0,\\ 1,\\ 2\\})$ 的事件。\n\n当 $opt_i = 1$ 时，事件 $i$ 代表猎人在 $[a_i,\\ b_i]$ 中全部驻扎了新营地。\n\n当 $opt_i = 2$ 时，事件 $i$ 代表斑马王子英勇的部队摧毁了 $[a_i,\\ b_i]$ 中的全部营地。\n\n而当 $opt_i = 0$ 时，斑马王子向你发出了灵魂拷问：\n\n每一个问题中，『斑马王子』希望从第 $a_i$ 到第 $b_i$ 天 $(0 \\leqslant a_i \\leqslant b_i \\leqslant k)$，在非『猎人』营地的草地用膳。『斑马王子』希望知道从第 $a_i$ 到 $b_i$ 天，『智商』之和的最小可能值 $t_i$。\n\n你苦思冥想，忽然，『枪』的吼叫声撕裂了空气，如果不在 $1 \\ sec$ 内回答问题 $\\dots \\dots$", "inputFormat": "第一行输入整数 $n, \\ m, \\ k$。\n\n接下来 $n$ 行，每行两个整数 $l_i, \\ r_i$，表示『猎人』的一个营地。\n\n接下来 $m$ 行，每行三个整数 $opt_i,\\ a_i,\\ b_i$，表示一组操作。", "outputFormat": "对于第 $i$ 组操作 $(1 \\leqslant i \\leqslant m)$，当 $opt_i = 1$ 或 $opt_i = 2$ 时，不需要输出。\n\n当 $opt_i = 0$ 时，当所有草地都属于猎人的营地时，输出一行 ``Death``,否则输出一行一个整数，表示 $t_i$。", "hint": "**数据范围**\n\n**本题采用捆绑测试。**\n\n$\\texttt{Subtask 1 (5 pts)}$：对于 $5\\%$ 的数据，保证 $0 \\leqslant n,m,k \\leqslant 20$。\n\n$\\texttt{Subtask 2 (5 pts)}$：对于 $5\\%$ 的数据，保证 $0 \\leqslant n,m,k \\leqslant 500$。\n\n$\\texttt{Subtask 3 (15 pts)}$：对于 $15\\%$ 的数据，保证 $0 \\leqslant n,m,k \\leqslant 4000$。\n\n$\\texttt{Subtask 4 (5 pts)}$：对于 $5\\%$ 的数据，保证 $opt_i = 0$。\n\n$\\texttt{Subtask 5 (70 pts)}$：无特殊限制。\n\n对于 $100 \\%$ 的数据， $0 \\leqslant n,\\ m,\\ k \\leqslant 2 \\times 10^5$，$0 \\leqslant l_i \\leqslant r_i \\leqslant k$，$0 \\leqslant a_i \\leqslant b_i \\leqslant k$，$opt_i \\in \\{0,\\ 1,\\ 2\\}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CoE R5] 斑马王子", "background": "#### 注意：此题 Sub #4 中 $opt_i=3$，可视作 $opt_i=0$。数据将稍后修复，修复后将另行通知。\n\n#### UPD: 已修复。", "description": "**题意简述**\n\n有一长度为 $k+1$ 的数组 $s$，下标依次为 $0$ 到 $k$，初始时有 $s_i = 0 \\ (0 \\leqslant i \\leqslant k)$。\n接下来给定 $n$ 个非负整数二元组 $(l_i,\\ r_i)$，记 $T = \\bigcup\\limits_{i = 1}^n [l_i,\\ r_i] $，将所有符合 $i \\in T \\bigcap \\mathbb{Z}$ 的 $s_i$ 赋值为 $1$。\n在任意时刻，记 $S =\\{ x |x \\in \\mathbb{Z} \\bigwedge x \\in [0,\\ k] \\bigwedge s_x = 0 \\}$。接下来给定 $m$ 个非负整数三元组 $(opt_i,\\ a_i,\\ b_i)$。\n\n当 $opt_i = 0$ 时，求：\n\n$$t_i = \\sum\\limits_{x = a_i}^{b_i} \\min\\limits_{y \\in S}(x \\oplus y)$$\n\n当 $opt_i = 1$ 时，将所有符合 $i \\in [a_i,\\ b_i] \\bigcap \\mathbb{Z}$ 的 $s_i$ 赋值为 $1$。\n\n当 $opt_i = 2$ 时，将所有符合 $i \\in [a_i,\\ b_i] \\bigcap \\mathbb{Z}$ 的 $s_i$ 赋值为 $0$。\n\n符号 $\\mathbb{Z}$ 表示全体整数，$\\oplus$ 表示异或。\n\n---\n\n**原版题面**\n\n『斑马王子』统治着无垠的草原。\n\n一条小河无息地流淌在草原的中央，与河流源头距离为 $y$ 的草地被赋予了 $y \\ (0 \\leqslant y \\leqslant k)$ 的『膜力』。\n\n第 $x \\ (0 \\leqslant x \\leqslant k)$ 天，『斑马王子』的『潜力智商』为 $x$。\n\n他会来到一片自己心仪的草地用膳，并以 $x \\oplus y$ 的『智商』开始新的一天。\n\n有一种叫『猎人』的生物，热衷于剥夺草原居民的生命。\n\n他们初始时设立了 $n$ 个形如 $(l_i,\\ r_i) \\ (0 \\leqslant l_i \\leqslant r_i \\leqslant k)$ 的营地，用『枪』屠杀着所有在 $[l_i,\\ r_i]$ 中驻足的生灵。\n\n作为『斑马王子』的得力大臣，你需要回答他的若干个问题，以保证草原的安全。\n\n在风云变幻的草原上，会依次发生 $m$ 个形如 $(opt_i,\\ a_i,\\ b_i) \\ (0 \\leqslant a_i \\leqslant b_i \\leqslant k , \\ opt_i \\in \\{0,\\ 1,\\ 2\\})$ 的事件。\n\n当 $opt_i = 1$ 时，事件 $i$ 代表猎人在 $[a_i,\\ b_i]$ 中全部驻扎了新营地。\n\n当 $opt_i = 2$ 时，事件 $i$ 代表斑马王子英勇的部队摧毁了 $[a_i,\\ b_i]$ 中的全部营地。\n\n而当 $opt_i = 0$ 时，斑马王子向你发出了灵魂拷问：\n\n每一个问题中，『斑马王子』希望从第 $a_i$ 到第 $b_i$ 天 $(0 \\leqslant a_i \\leqslant b_i \\leqslant k)$，在非『猎人』营地的草地用膳。『斑马王子』希望知道从第 $a_i$ 到 $b_i$ 天，『智商』之和的最小可能值 $t_i$。\n\n你苦思冥想，忽然，『枪』的吼叫声撕裂了空气，如果不在 $1 \\ sec$ 内回答问题 $\\dots \\dots$", "inputFormat": "第一行输入整数 $n, \\ m, \\ k$。\n\n接下来 $n$ 行，每行两个整数 $l_i, \\ r_i$，表示『猎人』的一个营地。\n\n接下来 $m$ 行，每行三个整数 $opt_i,\\ a_i,\\ b_i$，表示一组操作。", "outputFormat": "对于第 $i$ 组操作 $(1 \\leqslant i \\leqslant m)$，当 $opt_i = 1$ 或 $opt_i = 2$ 时，不需要输出。\n\n当 $opt_i = 0$ 时，当所有草地都属于猎人的营地时，输出一行 ``Death``,否则输出一行一个整数，表示 $t_i$。", "hint": "**数据范围**\n\n**本题采用捆绑测试。**\n\n$\\texttt{Subtask 1 (5 pts)}$：对于 $5\\%$ 的数据，保证 $0 \\leqslant n,m,k \\leqslant 20$。\n\n$\\texttt{Subtask 2 (5 pts)}$：对于 $5\\%$ 的数据，保证 $0 \\leqslant n,m,k \\leqslant 500$。\n\n$\\texttt{Subtask 3 (15 pts)}$：对于 $15\\%$ 的数据，保证 $0 \\leqslant n,m,k \\leqslant 4000$。\n\n$\\texttt{Subtask 4 (5 pts)}$：对于 $5\\%$ 的数据，保证 $opt_i = 0$。\n\n$\\texttt{Subtask 5 (70 pts)}$：无特殊限制。\n\n对于 $100 \\%$ 的数据， $0 \\leqslant n,\\ m,\\ k \\leqslant 2 \\times 10^5$，$0 \\leqslant l_i \\leqslant r_i \\leqslant k$，$0 \\leqslant a_i \\leqslant b_i \\leqslant k$，$opt_i \\in \\{0,\\ 1,\\ 2\\}$。", "locale": "zh-CN"}}}
{"pid": "P8584", "type": "P", "difficulty": 2, "samples": [["3\n3 5 1\n4 7 2\n7 3 1", "248/105"], ["4\n6 7 1\n8 3 2\n9 14 2\n5 17 1", "-1541/714"], ["3\n7 4 1\n3 8 2\n3 8 2\n", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": [], "title": "探索未知", "background": "下发文件：\n\n<https://luogu-ipic.oss-cn-shanghai.aliyuncs.com/watujir2-jdi92.zip>", "description": "2102 年，人类已经建立了从地球到室女座 $\\alpha $ 星的星际通道。通道绵延数百光年。\n\n而在通道上有许多路牌。第 $i$ 个路牌上写有一个分数 $\\dfrac{a_i}{b_i}$ 和一个分数运算符 $+$ 或 $-$。\n\n一开始，你的手上拿着一个数字 $0$。你沿着通道向后走。每走到一个路牌，**会用手上的数和路牌上的分数，用路牌上的运算符号进行计算，并把得到的新数拿在手中（丢弃掉手中原来的数）**。值得注意的是，如果你手中计算得到的数不是整数，则会保留既约分数的形式；否则直接保留整数形式。\n\n现在你想知道，当你走到通道的末端时，手中拿着的数是多少？", "inputFormat": "第 $1$ 行共一个正整数 $n$ 表示通道内共有 $n$ 个路牌。\n\n第 $2\\sim n+1$ 行每行三个正整数 $a_i,b_i,opt_i$ 表示第 $i$ 个路牌上写着的分数为 $\\dfrac{a_i}{b_i}$，运算符为 $opt_i$。\n\n其中，$+,-$ 两种运算分别用 $1,2$ 代替。", "outputFormat": "共一行一个数。\n\n若最终的结果可以保留为整数，则输出一个整数 $ans$ 表示结果。\n\n否则，若最终的结果只能保留为分数，则需要以 $a/b$ 的形式输出一个分数 $\\dfrac{a}{b}$。需要保证 $\\dfrac{a}{b}$ 为既约分数，即 $\\gcd(a,b)=1$ 。\n\n需要注意，结果可能出现负数，此时需要保留负号。例如，若结果为 $-\\dfrac{11451}{4}$，那么需要输出 `-11451/4`。", "hint": "对于 $20\\%$ 的数据，运算符只存在加法。\n\n另有 $20\\%$ 的数据，运算法只存在减法。\n\n对于 $100\\%$ 的数据，保证 $1\\leq n\\leq 10^3$，$0\\leq a \\leq 1000$，$0 < b \\leq 1000$，保证答案以及过程中全部数值(整数部分/分子/分母)不超过 $2\\times 10^9$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "探索未知", "background": "下发文件：\n\n<https://luogu-ipic.oss-cn-shanghai.aliyuncs.com/watujir2-jdi92.zip>", "description": "2102 年，人类已经建立了从地球到室女座 $\\alpha $ 星的星际通道。通道绵延数百光年。\n\n而在通道上有许多路牌。第 $i$ 个路牌上写有一个分数 $\\dfrac{a_i}{b_i}$ 和一个分数运算符 $+$ 或 $-$。\n\n一开始，你的手上拿着一个数字 $0$。你沿着通道向后走。每走到一个路牌，**会用手上的数和路牌上的分数，用路牌上的运算符号进行计算，并把得到的新数拿在手中（丢弃掉手中原来的数）**。值得注意的是，如果你手中计算得到的数不是整数，则会保留既约分数的形式；否则直接保留整数形式。\n\n现在你想知道，当你走到通道的末端时，手中拿着的数是多少？", "inputFormat": "第 $1$ 行共一个正整数 $n$ 表示通道内共有 $n$ 个路牌。\n\n第 $2\\sim n+1$ 行每行三个正整数 $a_i,b_i,opt_i$ 表示第 $i$ 个路牌上写着的分数为 $\\dfrac{a_i}{b_i}$，运算符为 $opt_i$。\n\n其中，$+,-$ 两种运算分别用 $1,2$ 代替。", "outputFormat": "共一行一个数。\n\n若最终的结果可以保留为整数，则输出一个整数 $ans$ 表示结果。\n\n否则，若最终的结果只能保留为分数，则需要以 $a/b$ 的形式输出一个分数 $\\dfrac{a}{b}$。需要保证 $\\dfrac{a}{b}$ 为既约分数，即 $\\gcd(a,b)=1$ 。\n\n需要注意，结果可能出现负数，此时需要保留负号。例如，若结果为 $-\\dfrac{11451}{4}$，那么需要输出 `-11451/4`。", "hint": "对于 $20\\%$ 的数据，运算符只存在加法。\n\n另有 $20\\%$ 的数据，运算法只存在减法。\n\n对于 $100\\%$ 的数据，保证 $1\\leq n\\leq 10^3$，$0\\leq a \\leq 1000$，$0 < b \\leq 1000$，保证答案以及过程中全部数值(整数部分/分子/分母)不超过 $2\\times 10^9$。\n", "locale": "zh-CN"}}}
{"pid": "P8585", "type": "P", "difficulty": 3, "samples": [["4\n1 3 5\n1 2 3\n2 2 3\n4 3 5", "0\n4\n6"], ["10\n2 5 5\n4 3 3\n1 3 2\n3 4 3\n3 2 5\n3 4 3\n2 3 4\n4 5 5\n2 3 4\n5 3 4", "1\n1 8\n31"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["Special Judge", "O2优化"], "title": "球状精灵的传说", "background": "", "description": "你在人马座的三叶星云里，发现了一类新生物：球状精灵。\n\n球状精灵是一类外形为标准椭球形的精灵。每只精灵有三个维度的**幅度** $\\{r_1,r_2,r_3\\}$，分别表示其三维世界中三个方向上的尺度。\n\n而关于球状精灵有一个传说：族群中**声望值最高**的球状精灵会获得升入四维宇宙的机会。而某个幅度为 $\\{r_1,r_2,r_3\\}$ 的球状精灵的声望值 $\\rho$ 定义为：\n\n$$\\rho=\\left\\lfloor{\\frac{1}{4}\\min\\{r_1,r_2,r_3\\}^3}\\right\\rfloor$$ \n\n其中 $\\left\\lfloor\\right\\rfloor$ 表示下取整。\n\n同时，每只球状精灵可以选择与别的精灵**拥抱至多一次**，之后两者会合成为**一个新的球状精灵**。两只球状精灵能够拥抱，当且仅当它们**存在至少一个幅度面能够重合**。具体来讲，即需要两只精灵的幅度**存在至少两个值相同**。\n\n例如，两只精灵三个方向上的幅度分别为 $\\{a,x,y\\}$ 和 $\\{b,x,y\\}$，那么他们可以选择拥抱并生成一只幅度为 $\\{a+b,x,y\\}$ 的新精灵。但是注意，精灵们都是漂浮在宇宙中的，所以他们可以任意旋转。比如幅度为 $\\{x,y,z\\}$ 的精灵可以任意旋转成为 $\\{x,z,y\\},\\{z,x,y\\},\\{z,y,x\\},\\{y,z,x\\},\\{y,x,z\\}$ 的精灵。**拥抱形成的新精灵不能再次参与拥抱。**\n\n现在球状精灵们想知道，族群中能够升入四维宇宙的精灵，声望值最高能是多少？\n\n请仔细阅读输入格式和输出格式以获取更详细的讯息。", "inputFormat": "第 $1$ 行共一个正整数 $n$，表示族群中最初的球状精灵数目。最初全部的球状精灵都没有拥抱过。\n\n第 $2\\sim n+1$ 行，每行三个非负整数 $r_{i,1},r_{i,2},r_{i,3}$，分别表示编号为 $i$ 的球状精灵三个维度的幅度。\n", "outputFormat": "第一行，输出一个整数 $opt$:\n\n  - 当最优情况下，升入四维空间的球状精灵是最初未拥抱过的精灵之一时，$opt=0$。\n\n  - 当最优情况下，升入四维空间的精灵是由原来的两只精灵拥抱生成时，$opt=1$。\n\n第二行，有两种情况：\n\n  - 当 $opt=0$ 时，输出一个整数 $i$，表示升入四维空间的精灵是编号为 $i$ 的精灵。\n\n  - 当 $opt=1$ 时，输出两个整数 $i,j$，表示最终升入四维空间的精灵由编号为 $i,j$ 的精灵拥抱生成。\n\n第三行，共一个整数，表示最优情况下升入四维空间精灵的声望值为多少。\n\n如果最优解有多种方案，输出任意一种情况即可。", "hint": "\n对于 $10\\%$ 的数据，$1\\leq n\\leq 20$。\n\n对于 $40\\%$ 的数据，$1\\leq n\\leq 800$。\n\n对于 $70\\%$ 的数据，$1\\leq n\\leq 5000$。\n\n对于 $85\\%$ 的数据，$1\\leq n\\leq 10^5$。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 5\\times 10^5$，$1\\leq r_{i,1},r_{i,2},r_{i,3} \\leq 10^3$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "球状精灵的传说", "background": "", "description": "你在人马座的三叶星云里，发现了一类新生物：球状精灵。\n\n球状精灵是一类外形为标准椭球形的精灵。每只精灵有三个维度的**幅度** $\\{r_1,r_2,r_3\\}$，分别表示其三维世界中三个方向上的尺度。\n\n而关于球状精灵有一个传说：族群中**声望值最高**的球状精灵会获得升入四维宇宙的机会。而某个幅度为 $\\{r_1,r_2,r_3\\}$ 的球状精灵的声望值 $\\rho$ 定义为：\n\n$$\\rho=\\left\\lfloor{\\frac{1}{4}\\min\\{r_1,r_2,r_3\\}^3}\\right\\rfloor$$ \n\n其中 $\\left\\lfloor\\right\\rfloor$ 表示下取整。\n\n同时，每只球状精灵可以选择与别的精灵**拥抱至多一次**，之后两者会合成为**一个新的球状精灵**。两只球状精灵能够拥抱，当且仅当它们**存在至少一个幅度面能够重合**。具体来讲，即需要两只精灵的幅度**存在至少两个值相同**。\n\n例如，两只精灵三个方向上的幅度分别为 $\\{a,x,y\\}$ 和 $\\{b,x,y\\}$，那么他们可以选择拥抱并生成一只幅度为 $\\{a+b,x,y\\}$ 的新精灵。但是注意，精灵们都是漂浮在宇宙中的，所以他们可以任意旋转。比如幅度为 $\\{x,y,z\\}$ 的精灵可以任意旋转成为 $\\{x,z,y\\},\\{z,x,y\\},\\{z,y,x\\},\\{y,z,x\\},\\{y,x,z\\}$ 的精灵。**拥抱形成的新精灵不能再次参与拥抱。**\n\n现在球状精灵们想知道，族群中能够升入四维宇宙的精灵，声望值最高能是多少？\n\n请仔细阅读输入格式和输出格式以获取更详细的讯息。", "inputFormat": "第 $1$ 行共一个正整数 $n$，表示族群中最初的球状精灵数目。最初全部的球状精灵都没有拥抱过。\n\n第 $2\\sim n+1$ 行，每行三个非负整数 $r_{i,1},r_{i,2},r_{i,3}$，分别表示编号为 $i$ 的球状精灵三个维度的幅度。\n", "outputFormat": "第一行，输出一个整数 $opt$:\n\n  - 当最优情况下，升入四维空间的球状精灵是最初未拥抱过的精灵之一时，$opt=0$。\n\n  - 当最优情况下，升入四维空间的精灵是由原来的两只精灵拥抱生成时，$opt=1$。\n\n第二行，有两种情况：\n\n  - 当 $opt=0$ 时，输出一个整数 $i$，表示升入四维空间的精灵是编号为 $i$ 的精灵。\n\n  - 当 $opt=1$ 时，输出两个整数 $i,j$，表示最终升入四维空间的精灵由编号为 $i,j$ 的精灵拥抱生成。\n\n第三行，共一个整数，表示最优情况下升入四维空间精灵的声望值为多少。\n\n如果最优解有多种方案，输出任意一种情况即可。", "hint": "\n对于 $10\\%$ 的数据，$1\\leq n\\leq 20$。\n\n对于 $40\\%$ 的数据，$1\\leq n\\leq 800$。\n\n对于 $70\\%$ 的数据，$1\\leq n\\leq 5000$。\n\n对于 $85\\%$ 的数据，$1\\leq n\\leq 10^5$。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 5\\times 10^5$，$1\\leq r_{i,1},r_{i,2},r_{i,3} \\leq 10^3$。\n", "locale": "zh-CN"}}}
