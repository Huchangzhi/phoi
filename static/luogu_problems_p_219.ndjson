{"pid": "P5429", "type": "P", "difficulty": 3, "samples": [["7 5\n0 5\n10 5\n5 0\n5 10\n6 7\n8 6\n8 4\n1 2\n2 3\n3 4\n5 6\n7 6", "10"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["模拟", "2019", "USACO", "并查集", "深度优先搜索 DFS"], "title": "[USACO19OPEN] Fence Planning S", "background": "", "description": "Farmer John 的 $ N $ 头奶牛，编号为 $ 1 \\ldots N $ （ $ 2 \\leq N \\leq 10^5 $ ），拥有一种围绕“哞网”，一些仅在组内互相交流却不与其他组进行交流的奶牛小组，组成的复杂的社交网络。\n\n每头奶牛位于农场的二维地图上的不同位置 $ (x,y) $ ，并且我们知道有 $ M $ 对奶牛( $ 1 \\leq M<10^5 $ )会相互哞叫。两头相互哞叫的奶牛属于同一哞网。\n\n为了升级他的农场，Farmer John 想要建造一个四边与 $ x $ 轴和 $ y $ 轴平行的长方形围栏。Farmer John 想要使得至少一个哞网完全被围栏所包围（在长方形边界上的奶牛计为被包围的）。请帮助 Farmer John 求出满足他的要求的围栏的最小可能周长。有可能出现这一围栏宽为 $0$ 或高为 $0$ 的情况。", "inputFormat": "输入的第一行包含 $ N $ 和 $ M $ 。以下 $ N $ 行每行包含一头奶牛的 $ x $ 坐标和 $ y $ 坐标（至多 $ 10^8 $ 的非负整数）。以下 $ M $ 行每行包含两个整数 $ a $ 和 $ b $ ，表示奶牛 $ a $ 和 $ b $ 之间有哞叫关系。每头奶牛都至少存在一个哞叫关系，并且输入中不会出现重复的哞叫关系。", "outputFormat": "输出满足 Farmer John 的要求的围栏的最小周长。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19OPEN] Fence Planning S", "background": "", "description": "Farmer John has $N$ cows, numbered $1 \\ldots N$ ($2 \\leq N \\leq 10^5$). They have a complex social network based on “moo-networks”: groups of cows that communicate with each other within the group but do not communicate with cows in other groups.\n\nEach cow is at a distinct position $(x, y)$ on a 2D map of the farm, and we know that there are $M$ pairs of cows ($1 \\leq M < 10^5$) that moo to each other. Two cows that moo to each other belong to the same moo-network.\n\nTo upgrade his farm, Farmer John wants to build a rectangular fence whose four sides are parallel to the $x$-axis and the $y$-axis. He wants at least one moo-network to be completely enclosed by the fence (cows on the boundary of the rectangle are considered enclosed). Please help Farmer John find the minimum possible perimeter of a fence that satisfies his requirement. It is possible that the fence has width $0$ or height $0$.", "inputFormat": "The first line contains $N$ and $M$. The next $N$ lines each contain the $x$ coordinate and $y$ coordinate of a cow (non-negative integers up to $10^8$). The next $M$ lines each contain two integers $a$ and $b$, indicating that cows $a$ and $b$ have a mooing relationship. Each cow has at least one mooing relationship, and there are no duplicate mooing relationships in the input.", "outputFormat": "Output the minimum perimeter of a fence that satisfies Farmer John’s requirement.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19OPEN] Fence Planning S", "background": "", "description": "Farmer John 的 $ N $ 头奶牛，编号为 $ 1 \\ldots N $ （ $ 2 \\leq N \\leq 10^5 $ ），拥有一种围绕“哞网”，一些仅在组内互相交流却不与其他组进行交流的奶牛小组，组成的复杂的社交网络。\n\n每头奶牛位于农场的二维地图上的不同位置 $ (x,y) $ ，并且我们知道有 $ M $ 对奶牛( $ 1 \\leq M<10^5 $ )会相互哞叫。两头相互哞叫的奶牛属于同一哞网。\n\n为了升级他的农场，Farmer John 想要建造一个四边与 $ x $ 轴和 $ y $ 轴平行的长方形围栏。Farmer John 想要使得至少一个哞网完全被围栏所包围（在长方形边界上的奶牛计为被包围的）。请帮助 Farmer John 求出满足他的要求的围栏的最小可能周长。有可能出现这一围栏宽为 $0$ 或高为 $0$ 的情况。", "inputFormat": "输入的第一行包含 $ N $ 和 $ M $ 。以下 $ N $ 行每行包含一头奶牛的 $ x $ 坐标和 $ y $ 坐标（至多 $ 10^8 $ 的非负整数）。以下 $ M $ 行每行包含两个整数 $ a $ 和 $ b $ ，表示奶牛 $ a $ 和 $ b $ 之间有哞叫关系。每头奶牛都至少存在一个哞叫关系，并且输入中不会出现重复的哞叫关系。", "outputFormat": "输出满足 Farmer John 的要求的围栏的最小周长。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5430", "type": "P", "difficulty": 7, "samples": [["4 2", "37"], ["2333333 2", "514898185"], ["1234567890000 3", "891659731"], ["1000000013 10", "616417347"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "递推", "2017", "洛谷原创", "O2优化"], "title": "[SNOI2017] 礼物 加强版", "background": "原题链接 [P5364](https://www.luogu.org/problemnew/show/P5364)", "description": "热情好客的**小猴子**请森林中的朋友们吃饭，他的朋友被编号为 $1\\sim n$，每个到来的朋友都会带给他一些礼物：**大香蕉**。其中，第一个朋友会带给他 $1$ 个**大香蕉**，之后，每一个朋友到来以后，都会带给他之前所有人带来的礼物个数再加他的编号的 $k$ 次方那么多个。所以，假设 $k=2$，前几位朋友带来的礼物个数分别是：\n\n$1,5,15,37,83,\\ldots$\n\n假设 $k=3$，前几位朋友带来的礼物个数分别是：\n\n$1,9,37,111,\\ldots$\n\n现在，**小猴子**好奇自己到底能收到第 $n$ 个朋友多少礼物，因此拜托于你了。\n\n已知 $n,k$，请输出第 $n$ 个朋友送的礼物个数 $\\bmod \\ 10^9+7$。", "inputFormat": "第一行，两个整数 $n,k$。", "outputFormat": "一个整数，表示第 $n$ 个朋友送的礼物个数 $\\bmod \\ 10^9+7$。", "hint": "$\\text{10}\\%$ 的数据：$n \\le 10^6$。\n \n另外 $\\text{10}\\%$ 的数据：$k \\le 3$。\n\n前 $\\text{40}\\%$ 的数据：$n \\le 10^{18}, k \\le 10$。\n\n前 $\\text{60}\\%$ 的数据：$n \\le 10^{18}, k \\le 1000$。\n\n前 $\\text{70}\\%$ 的数据：$k \\le 1000$。\n\n前 $\\text{90}\\%$ 的数据：$k \\le 10^6$。\n\n$\\text{100}\\%$ 的数据：$n\\le 10^{100000},k \\le 2\\times10^7$。\n\n最后一个测试点的时限为 $2s$，其余为 $1s$。\n****\nNaCly\\_Fish：本题原数据有误，现已修复。", "locale": "zh-CN", "translations": {"en": {"title": "[SNOI2017] Gift (Enhanced Version).", "background": "Original problem link: [P5364](https://www.luogu.org/problemnew/show/P5364).", "description": "The hospitable **little monkey** invites friends from the forest to dinner. His friends are numbered from $1$ to $n$. Each friend who arrives brings him some gifts: **big bananas**. The first friend brings him $1$ **big banana**. After that, when each friend arrives, they will bring the total number of gifts brought by all previous friends, plus their index raised to the $k$-th power.\n\nSo, if $k=2$, the number of gifts brought by the first few friends is:\n\n$1,5,15,37,83,\\ldots$\n\nIf $k=3$, the number of gifts brought by the first few friends is:\n\n$1,9,37,111,\\ldots$\n\nNow, the **little monkey** is curious about how many gifts he will receive from the $n$-th friend, so he asks you for help.\n\nGiven $n,k$, output the number of gifts brought by the $n$-th friend $\\bmod \\ 10^9+7$.", "inputFormat": "The first line contains two integers $n,k$.", "outputFormat": "Output one integer, representing the number of gifts brought by the $n$-th friend $\\bmod \\ 10^9+7$.", "hint": "$\\text{10}\\%$ of the testdata: $n \\le 10^6$.\n\nAnother $\\text{10}\\%$ of the testdata: $k \\le 3$.\n\nThe first $\\text{40}\\%$ of the testdata: $n \\le 10^{18}, k \\le 10$.\n\nThe first $\\text{60}\\%$ of the testdata: $n \\le 10^{18}, k \\le 1000$.\n\nThe first $\\text{70}\\%$ of the testdata: $k \\le 1000$.\n\nThe first $\\text{90}\\%$ of the testdata: $k \\le 10^6$.\n\n$\\text{100}\\%$ of the testdata: $n\\le 10^{100000},k \\le 2\\times10^7$.\n\nThe time limit for the last test point is $2s$, and for the others it is $1s$.\n\n****\nNaCly\\_Fish: The original testdata for this problem was incorrect and has now been fixed.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SNOI2017] 礼物 加强版", "background": "原题链接 [P5364](https://www.luogu.org/problemnew/show/P5364)", "description": "热情好客的**小猴子**请森林中的朋友们吃饭，他的朋友被编号为 $1\\sim n$，每个到来的朋友都会带给他一些礼物：**大香蕉**。其中，第一个朋友会带给他 $1$ 个**大香蕉**，之后，每一个朋友到来以后，都会带给他之前所有人带来的礼物个数再加他的编号的 $k$ 次方那么多个。所以，假设 $k=2$，前几位朋友带来的礼物个数分别是：\n\n$1,5,15,37,83,\\ldots$\n\n假设 $k=3$，前几位朋友带来的礼物个数分别是：\n\n$1,9,37,111,\\ldots$\n\n现在，**小猴子**好奇自己到底能收到第 $n$ 个朋友多少礼物，因此拜托于你了。\n\n已知 $n,k$，请输出第 $n$ 个朋友送的礼物个数 $\\bmod \\ 10^9+7$。", "inputFormat": "第一行，两个整数 $n,k$。", "outputFormat": "一个整数，表示第 $n$ 个朋友送的礼物个数 $\\bmod \\ 10^9+7$。", "hint": "$\\text{10}\\%$ 的数据：$n \\le 10^6$。\n \n另外 $\\text{10}\\%$ 的数据：$k \\le 3$。\n\n前 $\\text{40}\\%$ 的数据：$n \\le 10^{18}, k \\le 10$。\n\n前 $\\text{60}\\%$ 的数据：$n \\le 10^{18}, k \\le 1000$。\n\n前 $\\text{70}\\%$ 的数据：$k \\le 1000$。\n\n前 $\\text{90}\\%$ 的数据：$k \\le 10^6$。\n\n$\\text{100}\\%$ 的数据：$n\\le 10^{100000},k \\le 2\\times10^7$。\n\n最后一个测试点的时限为 $2s$，其余为 $1s$。\n****\nNaCly\\_Fish：本题原数据有误，现已修复。", "locale": "zh-CN"}}}
{"pid": "P5431", "type": "P", "difficulty": 4, "samples": [["6 233 42\n1 4 2 8 5 7", "91"]], "limits": {"time": [550, 550, 550, 550, 550], "memory": [131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "O2优化", "逆元", "模板题"], "title": "【模板】模意义下的乘法逆元 2", "background": "", "description": "给定 $n$ 个正整数 $a_i$ ，求它们在模 $p$ 意义下的乘法逆元。\n\n由于输出太多不好，所以将会给定常数 $k$，你要输出的答案为：  \n$$\\sum\\limits_{i=1}^n\\frac{k^i}{a_i}$$\n\n答案对 $p$ 取模。", "inputFormat": "第一行三个正整数 $n,p,k$，意义如题目描述。  \n第二行 $n$ 个正整数 $a_i$，是你要求逆元的数。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "对于 $30\\%$ 的数据，$1\\le n \\le 10^5$。\n\n对于 $100\\%$ 数据，$1\\le n \\le 5\\times 10^6$，$2\\le k < p \\le 10^9$，$1\\le a_i < p$，保证 $p$ 为质数。\n\n提示：本题时间限制较为严格，请注意使用较快的 IO 方式。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Multiplicative Inverse Modulo 2", "background": "", "description": "Given $n$ positive integers $a_i$, find their multiplicative inverses modulo $p$.\n\nSince outputting all inverses would be too much, a constant $k$ is given. The answer you need to output is:  \n$$\\sum\\limits_{i=1}^n\\frac{k^i}{a_i}$$\n\nOutput the answer modulo $p$.", "inputFormat": "The first line contains three positive integers $n, p, k$, with the meaning as described in the statement.  \nThe second line contains $n$ positive integers $a_i$, the numbers whose inverses you need to compute.", "outputFormat": "Output one integer in one line, representing the answer.", "hint": "For $30\\%$ of the testdata, $1 \\le n \\le 10^5$.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 5\\times 10^6$, $2 \\le k < p \\le 10^9$, $1 \\le a_i < p$, and $p$ is guaranteed to be prime.\n\nNote: The time limit for this problem is relatively strict. Please use faster I/O methods.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】模意义下的乘法逆元 2", "background": "", "description": "给定 $n$ 个正整数 $a_i$ ，求它们在模 $p$ 意义下的乘法逆元。\n\n由于输出太多不好，所以将会给定常数 $k$，你要输出的答案为：  \n$$\\sum\\limits_{i=1}^n\\frac{k^i}{a_i}$$\n\n答案对 $p$ 取模。", "inputFormat": "第一行三个正整数 $n,p,k$，意义如题目描述。  \n第二行 $n$ 个正整数 $a_i$，是你要求逆元的数。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "对于 $30\\%$ 的数据，$1\\le n \\le 10^5$。\n\n对于 $100\\%$ 数据，$1\\le n \\le 5\\times 10^6$，$2\\le k < p \\le 10^9$，$1\\le a_i < p$，保证 $p$ 为质数。\n\n提示：本题时间限制较为严格，请注意使用较快的 IO 方式。", "locale": "zh-CN"}}}
{"pid": "P5432", "type": "P", "difficulty": 7, "samples": [["19260817\n114514", "873463809 93585408 943652865 "]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "倍增", "O2优化", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "A/B Problem（高精度除法Ⅱ）", "background": "", "description": "给你两个正整数 $a,b$，求 $\\lfloor a/b \\rfloor$。  \n为了卡掉一些乱搞做法，你需要对答案进行如下处理：  \n设答案为 $r$，构造一个多项式 $F(x)$：\n\n$$ F(x) = \\sum\\limits_{i=0}^{\\lfloor \\lg r \\rfloor} (\\lfloor 10^{-i}r \\rfloor \\bmod 10) \\cdot x^i$$\n\n简单地说，就是从 $r$ 的低位到高位，每一位对应 $F(x)$ 一项的系数。\n\n设 $F(x)$ 的最高非零次数为 $n$，你需要求出一个 $n$ 次多项式 $G(x)$，使得：  \n$$ F(x) \\cdot G(x) \\equiv 1 \\pmod{x^{n+1}}$$   \n将 $G(x)$ 的系数对 $998244353$ 取模，然后升幂输出 $G(x)$ 的系数即可。\n\n保证满足条件的 $G(x)$ 存在。", "inputFormat": "两行，每行一个正整数，分别为 $a$ 和 $b$。", "outputFormat": "输出一行 $n+1$ 个整数，为 $G(x)$ 的系数", "hint": "**【样例解释】**\n\n$\\left\\lfloor \\dfrac{19260817}{114514} \\right\\rfloor = 168$。\n\n由此构造出的多项式 $F(x)=x^2+6x+8$  \n求出来对应的 $G(x)$ 就是 $943652865x^2 + 93585408x +  873463809$。\n\n**【数据范围】**\n\n对于 $100 \\%$ 的数据，$1\\le b \\le a \\le 10^{200000}$。", "locale": "zh-CN", "translations": {"en": {"title": "A/B Problem (High-Precision Division II)", "background": "", "description": "You are given two positive integers $a, b$. Find $\\lfloor a/b \\rfloor$.\n\nTo rule out some brute-force solutions, you must process the answer as follows.\n\nLet the answer be $r$, and construct a polynomial $F(x)$:\n\n$$ F(x) = \\sum\\limits_{i=0}^{\\lfloor \\lg r \\rfloor} (\\lfloor 10^{-i}r \\rfloor \\bmod 10) \\cdot x^i$$\n\nSimply put, from the lowest digit to the highest digit of $r$, each digit is used as the coefficient of one term of $F(x)$.\n\nLet the highest non-zero degree of $F(x)$ be $n$. You need to find a degree-$n$ polynomial $G(x)$ such that:\n\n$$ F(x) \\cdot G(x) \\equiv 1 \\pmod{x^{n+1}}$$\n\nTake the coefficients of $G(x)$ modulo $998244353$, then output the coefficients of $G(x)$ in increasing order of degree.\n\nIt is guaranteed that such a $G(x)$ exists.", "inputFormat": "Two lines, each containing one positive integer, which are $a$ and $b$, respectively.", "outputFormat": "Output one line with $n+1$ integers, the coefficients of $G(x)$.", "hint": "**Sample Explanation**\n\n$\\left\\lfloor \\dfrac{19260817}{114514} \\right\\rfloor = 168$.\n\nThe polynomial constructed is $F(x) = x^2 + 6x + 8$.\n\nThe corresponding $G(x)$ is $943652865x^2 + 93585408x + 873463809$.\n\n**Constraints**\n\nFor $100\\%$ of the testdata, $1 \\le b \\le a \\le 10^{200000}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "A/B Problem（高精度除法Ⅱ）", "background": "", "description": "给你两个正整数 $a,b$，求 $\\lfloor a/b \\rfloor$。  \n为了卡掉一些乱搞做法，你需要对答案进行如下处理：  \n设答案为 $r$，构造一个多项式 $F(x)$：\n\n$$ F(x) = \\sum\\limits_{i=0}^{\\lfloor \\lg r \\rfloor} (\\lfloor 10^{-i}r \\rfloor \\bmod 10) \\cdot x^i$$\n\n简单地说，就是从 $r$ 的低位到高位，每一位对应 $F(x)$ 一项的系数。\n\n设 $F(x)$ 的最高非零次数为 $n$，你需要求出一个 $n$ 次多项式 $G(x)$，使得：  \n$$ F(x) \\cdot G(x) \\equiv 1 \\pmod{x^{n+1}}$$   \n将 $G(x)$ 的系数对 $998244353$ 取模，然后升幂输出 $G(x)$ 的系数即可。\n\n保证满足条件的 $G(x)$ 存在。", "inputFormat": "两行，每行一个正整数，分别为 $a$ 和 $b$。", "outputFormat": "输出一行 $n+1$ 个整数，为 $G(x)$ 的系数", "hint": "**【样例解释】**\n\n$\\left\\lfloor \\dfrac{19260817}{114514} \\right\\rfloor = 168$。\n\n由此构造出的多项式 $F(x)=x^2+6x+8$  \n求出来对应的 $G(x)$ 就是 $943652865x^2 + 93585408x +  873463809$。\n\n**【数据范围】**\n\n对于 $100 \\%$ 的数据，$1\\le b \\le a \\le 10^{200000}$。", "locale": "zh-CN"}}}
{"pid": "P5433", "type": "P", "difficulty": 6, "samples": [["1\naabacabaaa", "15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": [], "title": "月宫的符卡序列", "background": "![](https://cdn.luogu.com.cn/upload/pic/60728.png)\n", "description": "**update：重新构造了两组数据，数据已加强**\n\n辉夜原本是生活在月宫的月之公主\n\n辉夜在淸理永远亭的仓库时，发现了一个古老的符卡序列 $S$，可能是很久很久以前的辉夜仍生活在月宫时创造的，但现在的她已经回忆不起来了。\n\n于是辉夜便决定对这个符卡序列进行研究，$S$ 中的符卡从0开始标号，并且辉夜创造它时使用的卡组大小不超过26,因此符卡被表示成了字母 $a$ 到字母 $z$。\n\n辉夜对从左往右读和从右往左读都一样的序列很感兴趣，对于$S$的某个满足上述条件连续子序列$a$,其价值为$a$在$S$中的所有出现位罝中点（即若a出现在$l...r$，那么中点为$\\lfloor  \\frac{l+r}{2} \\rfloor $）的异或值。\n\n\n辉夜想知道对于所有满足条件的$a$，最大的价值是多少\n", "inputFormat": "第一行一个整数$num$($≤5$)，表示数据组数\n\n每组数据占一行，有一个仅有小写字母的字符串$S$，表示符卡序列", "outputFormat": "对于每组数据，输出一行，表示辉夜想知道的答案", "hint": "$1≤|S|≤10^6$", "locale": "zh-CN", "translations": {"en": {"title": "Spell Card Sequence of the Moon Palace", "background": "![](https://cdn.luogu.com.cn/upload/pic/60728.png)", "description": "**Update: Two sets of testdata have been rebuilt, and the testdata has been strengthened.**\n\nKaguya was originally a princess of the Moon who lived in the Moon Palace.\n\nWhen Kaguya was cleaning the warehouse of Eientei, she found an ancient spell card sequence $S$. It might have been created a very, very long time ago, when Kaguya still lived in the Moon Palace, but now she cannot remember it anymore.\n\nSo Kaguya decided to study this spell card sequence. The spell cards in $S$ are indexed starting from $0$. Also, when she created it, the deck size did not exceed $26$, so each spell card is represented by a letter from $a$ to $z$.\n\nKaguya is very interested in sequences that read the same from left to right and from right to left. For any contiguous subsequence $a$ of $S$ that satisfies the above condition, its value is defined as the XOR of the midpoints of all occurrences of $a$ in $S$ (that is, if $a$ occurs at $l...r$, then the midpoint is $\\lfloor \\frac{l+r}{2} \\rfloor$).\n\nKaguya wants to know, among all such $a$, what the maximum value is.", "inputFormat": "The first line contains an integer $num$ ($\\le 5$), indicating the number of test cases.\n\nEach test case consists of one line containing a string $S$ with only lowercase letters, representing the spell card sequence.", "outputFormat": "For each test case, output one line representing the answer Kaguya wants to know.", "hint": "$1 \\le |S| \\le 10^6$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "月宫的符卡序列", "background": "![](https://cdn.luogu.com.cn/upload/pic/60728.png)\n", "description": "**update：重新构造了两组数据，数据已加强**\n\n辉夜原本是生活在月宫的月之公主\n\n辉夜在淸理永远亭的仓库时，发现了一个古老的符卡序列 $S$，可能是很久很久以前的辉夜仍生活在月宫时创造的，但现在的她已经回忆不起来了。\n\n于是辉夜便决定对这个符卡序列进行研究，$S$ 中的符卡从0开始标号，并且辉夜创造它时使用的卡组大小不超过26,因此符卡被表示成了字母 $a$ 到字母 $z$。\n\n辉夜对从左往右读和从右往左读都一样的序列很感兴趣，对于$S$的某个满足上述条件连续子序列$a$,其价值为$a$在$S$中的所有出现位罝中点（即若a出现在$l...r$，那么中点为$\\lfloor  \\frac{l+r}{2} \\rfloor $）的异或值。\n\n\n辉夜想知道对于所有满足条件的$a$，最大的价值是多少\n", "inputFormat": "第一行一个整数$num$($≤5$)，表示数据组数\n\n每组数据占一行，有一个仅有小写字母的字符串$S$，表示符卡序列", "outputFormat": "对于每组数据，输出一行，表示辉夜想知道的答案", "hint": "$1≤|S|≤10^6$", "locale": "zh-CN"}}}
{"pid": "P5434", "type": "P", "difficulty": 7, "samples": [["3", "8"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["O2优化", "生成函数", "快速数论变换 NTT"], "title": "有标号荒漠计数", "background": "众所周知 仙人掌计数 是一种很简单的计数，所以我们要加强它.jpg", "description": "仙人掌是一张无向连通图，在一个仙人掌上，任意一条边至多只会出现在一个环上。同时，在本题定义的仙人掌中，仙人掌应当**无重边**、**无自环**。  \n荒漠是一张无向图，一个荒漠的每个极大连通分量都是一个仙人掌\n\n---\n给出一个整数 $n$ ，请求出有多少种不同的含有 $n$ 个点的荒漠。（点有标号）\n\n由于答案可能太大，您只需要将您的结果对 $998244353$ 取模后输出即可。", "inputFormat": "一行一个整数 $n$ 。", "outputFormat": "一行一个整数，为您的答案对 $998244353$ 取模的结果。", "hint": "对于样例，所有可能的情况如下：  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/onuzh6bn.png)\n\n可以发现，不存在更多的荒漠\n\n---\n对于 $30\\%$ 的数据： $n\\leqslant5000$  \n对于 $100\\%$ 的数据： $3\\leqslant n\\leqslant100000$", "locale": "zh-CN", "translations": {"en": {"title": "Counting Labeled Deserts", "background": "As everyone knows, counting cacti is a very easy counting problem, so we are going to make it harder.jpg.", "description": "A cactus is an undirected connected graph. In a cactus, any edge appears in at most one cycle. Also, in the cactus defined in this problem, the cactus must have **no multiple edges** and **no self-loops**.  \nA desert is an undirected graph in which every maximal connected component is a cactus.\n\n---\n\nGiven an integer $n$, find how many different deserts with $n$ vertices there are (the vertices are labeled).\n\nSince the answer may be very large, you only need to output it modulo $998244353$.", "inputFormat": "One line with one integer $n$.", "outputFormat": "One line with one integer, the answer modulo $998244353$.", "hint": "For the sample, all possible cases are as follows:  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/onuzh6bn.png)\n\nYou can see that there are no more deserts.\n\n---\n\nConstraints:  \nFor $30\\%$ of the testdata: $n\\leqslant5000$.  \nFor $100\\%$ of the testdata: $3\\leqslant n\\leqslant100000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "有标号荒漠计数", "background": "众所周知 仙人掌计数 是一种很简单的计数，所以我们要加强它.jpg", "description": "仙人掌是一张无向连通图，在一个仙人掌上，任意一条边至多只会出现在一个环上。同时，在本题定义的仙人掌中，仙人掌应当**无重边**、**无自环**。  \n荒漠是一张无向图，一个荒漠的每个极大连通分量都是一个仙人掌\n\n---\n给出一个整数 $n$ ，请求出有多少种不同的含有 $n$ 个点的荒漠。（点有标号）\n\n由于答案可能太大，您只需要将您的结果对 $998244353$ 取模后输出即可。", "inputFormat": "一行一个整数 $n$ 。", "outputFormat": "一行一个整数，为您的答案对 $998244353$ 取模的结果。", "hint": "对于样例，所有可能的情况如下：  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/onuzh6bn.png)\n\n可以发现，不存在更多的荒漠\n\n---\n对于 $30\\%$ 的数据： $n\\leqslant5000$  \n对于 $100\\%$ 的数据： $3\\leqslant n\\leqslant100000$", "locale": "zh-CN"}}}
{"pid": "P5435", "type": "P", "difficulty": 6, "samples": [["5\n200 300 300 300 23333\n666 666 666 666 123456\n", "16\n564\n3636\n14328\n3905\n"]], "limits": {"time": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["数论", "O2优化", "最大公约数 gcd"], "title": "基于值域预处理的快速 GCD", "background": "", "description": "给定 $n$ 个正整数 $a_1,a_2,\\dots,a_n$，再给定 $n$ 个正整数 $b_1,b_2,\\dots,b_n$，你需要对每对 $(i,j)$ 求出 $a_i$ 与 $b_j$ 的最大公因数。\n\n不难发现你的输出应有 $n^2$ 个正整数。为了减少输出对程序的运行效率的影响，你只需要输出 $n$ 行，每行一个整数 $A_i$。\n\n其中对于 $i\\in[1,n]$，$A_i=\\sum_{j=1}^{n}i^j\\gcd(a_i,b_j)$。由于答案可能过大，你只需要输出模 $998,244,353$ 后的结果即可。", "inputFormat": "第一行一个正整数 $n$。\n\n第二行 $n$ 个正整数，表示 $a_1,a_2,\\dots,a_n$。\n\n第三行 $n$ 个正整数，表示 $b_1,b_2,\\dots,b_n$。", "outputFormat": "共 $n$ 行，第 $i$ 行应输出一个非负整数 $A_i$。意义见题目描述。", "hint": "对于 $20\\%$ 的数据，$1\\leqslant n\\leqslant 500$。\n\n对于 $100\\%$ 的数据，$1\\leqslant n\\leqslant 5000;1\\leqslant a_i,b_i\\leqslant 10^6$。\n\n**请注意常数因子对程序运行效率的影响**", "locale": "zh-CN", "translations": {"en": {"title": "Fast GCD Based on Value-Range Preprocessing", "background": "", "description": "Given $n$ positive integers $a_1,a_2,\\dots,a_n$, and another $n$ positive integers $b_1,b_2,\\dots,b_n$, you need to compute the greatest common divisor of $a_i$ and $b_j$ for every pair $(i,j)$.\n\nIt is not hard to see that the output should contain $n^2$ positive integers. To reduce the impact of output on the program’s running efficiency, you only need to output $n$ lines, with one integer $A_i$ per line.\n\nFor $i\\in[1,n]$, $A_i=\\sum_{j=1}^{n}i^j\\gcd(a_i,b_j)$. Since the answer may be too large, you only need to output the result modulo $998,244,353$.", "inputFormat": "The first line contains one positive integer $n$.\n\nThe second line contains $n$ positive integers, representing $a_1,a_2,\\dots,a_n$.\n\nThe third line contains $n$ positive integers, representing $b_1,b_2,\\dots,b_n$.", "outputFormat": "Output $n$ lines. The $i$-th line should contain one non-negative integer $A_i$. Its meaning is described in the statement.", "hint": "For $20\\%$ of the testdata, $1\\leqslant n\\leqslant 500$.\n\nFor $100\\%$ of the testdata, $1\\leqslant n\\leqslant 5000;1\\leqslant a_i,b_i\\leqslant 10^6$.\n\n**Please pay attention to the impact of constant factors on the program’s running efficiency.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "基于值域预处理的快速 GCD", "background": "", "description": "给定 $n$ 个正整数 $a_1,a_2,\\dots,a_n$，再给定 $n$ 个正整数 $b_1,b_2,\\dots,b_n$，你需要对每对 $(i,j)$ 求出 $a_i$ 与 $b_j$ 的最大公因数。\n\n不难发现你的输出应有 $n^2$ 个正整数。为了减少输出对程序的运行效率的影响，你只需要输出 $n$ 行，每行一个整数 $A_i$。\n\n其中对于 $i\\in[1,n]$，$A_i=\\sum_{j=1}^{n}i^j\\gcd(a_i,b_j)$。由于答案可能过大，你只需要输出模 $998,244,353$ 后的结果即可。", "inputFormat": "第一行一个正整数 $n$。\n\n第二行 $n$ 个正整数，表示 $a_1,a_2,\\dots,a_n$。\n\n第三行 $n$ 个正整数，表示 $b_1,b_2,\\dots,b_n$。", "outputFormat": "共 $n$ 行，第 $i$ 行应输出一个非负整数 $A_i$。意义见题目描述。", "hint": "对于 $20\\%$ 的数据，$1\\leqslant n\\leqslant 500$。\n\n对于 $100\\%$ 的数据，$1\\leqslant n\\leqslant 5000;1\\leqslant a_i,b_i\\leqslant 10^6$。\n\n**请注意常数因子对程序运行效率的影响**", "locale": "zh-CN"}}}
{"pid": "P5436", "type": "P", "difficulty": 2, "samples": [["1\n3\n", "6\n"]], "limits": {"time": [1000, 1000], "memory": [512000, 512000]}, "tags": ["数学", "O2优化", "最大公约数 gcd"], "title": "【XR-2】缘分", "background": "> 世间万物都置身于缘分编织的大网中。缘分未到，虽历经千劫，却不能相遇。缘分到了，在草原上都能等到一艘船。——《一禅小和尚》", "description": "一禅希望知道他和师父之间的缘分大小。可是如何才能知道呢？\n\n一禅想了个办法，他先和师父约定一个正整数 $n$，接着他们各自在心里想一个不超过 $n$ 的正整数。\n\n一禅认为，他和师父心里想的这两个数的**最小公倍数**越大，则意味着他和师父之间的缘分越大。\n\n师父觉得这个办法很合适，不过他想知道这两个数的最小公倍数最大会是多少。\n\n师父的数学不太好，于是问一禅。一禅也觉得这个问题很困难，他希望你能告诉他答案。", "inputFormat": "**本题有多组数据。**\n\n第一行一个正整数 $T$，表示数据组数。\n\n接下来的 $T$ 行，每行一个正整数 $n$，表示一禅和师父约定的正整数。", "outputFormat": "对每组数据，一行一个正整数，表示答案。", "hint": "【样例 $1$ 说明】\n\n不超过 $3$ 的两个正整数的最小公倍数的最大值为 $\\mathrm{lcm}(2,3) = 6$。\n\n【数据规模与约定】\n\n对 $50\\%$ 的数据，$1 \\le T,n \\le 100$。\n\n对 $100\\%$ 的数据，$1 \\le T \\le 100, 1 \\le n \\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-2] Fate", "background": "> All things in the world are within the great web woven by fate. If fate has not arrived, even after countless hardships, you still cannot meet. If fate has arrived, you can even wait for a ship on the grassland. — *Yi Chan, the Little Monk*", "description": "Yi Chan wants to know how strong the “fate” between him and his master is. But how can it be measured?\n\nYi Chan comes up with an idea. First, he and his master agree on a positive integer $n$. Then each of them silently thinks of a positive integer not greater than $n$.\n\nYi Chan believes that the larger the **least common multiple** of these two numbers is, the stronger the fate between him and his master is.\n\nHis master thinks this method is good, but he wants to know what the maximum possible least common multiple of the two numbers can be.\n\nHis master is not very good at math, so he asks Yi Chan. Yi Chan also finds this problem difficult, and he hopes you can tell him the answer.", "inputFormat": "**This problem contains multiple test cases.**\n\nThe first line contains a positive integer $T$, the number of test cases.\n\nThe next $T$ lines each contain a positive integer $n$, the positive integer agreed upon by Yi Chan and his master.", "outputFormat": "For each test case, output one positive integer per line, the answer.", "hint": "[Sample $1$ Explanation]\n\nAmong two positive integers not greater than $3$, the maximum least common multiple is $\\mathrm{lcm}(2,3) = 6$.\n\n[Constraints]\n\nFor $50\\%$ of the testdata, $1 \\le T,n \\le 100$.\n\nFor $100\\%$ of the testdata, $1 \\le T \\le 100$, $1 \\le n \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-2】缘分", "background": "> 世间万物都置身于缘分编织的大网中。缘分未到，虽历经千劫，却不能相遇。缘分到了，在草原上都能等到一艘船。——《一禅小和尚》", "description": "一禅希望知道他和师父之间的缘分大小。可是如何才能知道呢？\n\n一禅想了个办法，他先和师父约定一个正整数 $n$，接着他们各自在心里想一个不超过 $n$ 的正整数。\n\n一禅认为，他和师父心里想的这两个数的**最小公倍数**越大，则意味着他和师父之间的缘分越大。\n\n师父觉得这个办法很合适，不过他想知道这两个数的最小公倍数最大会是多少。\n\n师父的数学不太好，于是问一禅。一禅也觉得这个问题很困难，他希望你能告诉他答案。", "inputFormat": "**本题有多组数据。**\n\n第一行一个正整数 $T$，表示数据组数。\n\n接下来的 $T$ 行，每行一个正整数 $n$，表示一禅和师父约定的正整数。", "outputFormat": "对每组数据，一行一个正整数，表示答案。", "hint": "【样例 $1$ 说明】\n\n不超过 $3$ 的两个正整数的最小公倍数的最大值为 $\\mathrm{lcm}(2,3) = 6$。\n\n【数据规模与约定】\n\n对 $50\\%$ 的数据，$1 \\le T,n \\le 100$。\n\n对 $100\\%$ 的数据，$1 \\le T \\le 100, 1 \\le n \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5437", "type": "P", "difficulty": 6, "samples": [["3 1\n", "8\n"], ["4 3\n", "450\n"], ["1926 817\n", "984167516\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "生成树", "期望", "逆元"], "title": "【XR-2】约定", "background": ">「小圆，不要走！这一分离，我们何时才能重逢？」\n>\n>「小焰，我们一定还会相见的！在那之前，我们只是短暂的离别啊......」", "description": "只因为那一句约定，小焰开始了看不到尽头的等待。\n\n约定在小焰心中幻化成了一张 $n$ 个点的图。一开始，这是一张完全图，其中点的编号从 $1$ 到 $n$，连接点 $i,j$ 的边的权值为 $(i+j)^k$。\n\n然而等待的过程中，岁月也在逐渐消磨着她的信仰，因此图中的一些边被随机地删掉了。最终，图变成了一棵 $n$ 个点的树，永远地留在了小焰的心中。\n\n很久很久以后，小焰的魔力耗尽，在痛苦与绝望之中濒临崩溃。而就在这时，小圆终于来找小焰了。为了拯救自己唯一的朋友，她必须知道这棵树边权和的期望值对 $998244353$ 取模的结果是多少。\n\n你能帮小圆求出答案，让她完成那个约定吗？", "inputFormat": "一行两个正整数 $n,k$。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模后的值。", "hint": "【样例 $1$ 说明】\n\n这个完全图有 $3$ 个节点，$3$ 条边，形成了一个环。  \n这些边的权分别为：$3,4,5$   \n最后形成的树也有 $3$ 种可能，权值分别为：$7,8,9$  \n期望值为 $8$。\n\n【数据规模与约定】\n\n**本题采用捆绑测试。**\n\nSubtask 1（5 points）：$1 \\le n \\le 5$，$1\\le k \\le 10$。     \nSubtask 2（11 points）：$k = 1$。  \nSubtask 3（11 points）：$1 \\le n,k \\le 20000$。  \nSubtask 4（13 points）：$1 \\le n,k \\le 10^5$。   \nSubtask 5（23 points）：$1 \\le k \\le 10^5$。  \nSubtask 6（37 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le n \\le 998244352,1\\le k \\le 10^7$。\n****\n>「抱歉，让你久等了...... 你一直努力到了今天吧......」  \n>\n>「小圆......」\n>\n>「来，我们走吧。今后我们永不分离......」\n>\n>「是啊，我等这一刻——望眼欲穿。」", "locale": "zh-CN", "translations": {"en": {"title": "[XR-2] Promise", "background": "> \"Xiaoyuan, don't go! After we part, when will we meet again?\"\n>\n> \"Xiaoyan, we will definitely see each other again! Before that, this is only a short farewell...\"", "description": "Just because of that promise, Xiaoyan began a wait with no end in sight.\n\nIn Xiaoyan's heart, the promise turned into a graph with $n$ vertices. At the beginning, it was a complete graph. The vertices are numbered from $1$ to $n$, and the weight of the edge connecting vertices $i, j$ is $(i+j)^k$.\n\nHowever, during the waiting, time was also slowly wearing away her faith, so some edges in the graph were randomly deleted. In the end, the graph became a tree with $n$ vertices, and stayed in Xiaoyan's heart forever.\n\nA very, very long time later, Xiaoyan's magic ran out, and she was on the verge of breaking down in pain and despair. Just then, Xiaoyuan finally came to find Xiaoyan. To save her only friend, she must know the result of the expected total edge weight of this tree modulo $998244353$.\n\nCan you help Xiaoyuan compute the answer, so she can fulfill that promise?", "inputFormat": "One line with two positive integers $n, k$.", "outputFormat": "One line with one integer, the value of the answer modulo $998244353$.", "hint": "[Sample $1$ Explanation]\n\nThis complete graph has $3$ nodes and $3$ edges, forming a cycle.  \nThe weights of these edges are: $3, 4, 5$.  \nIn the end, there are also $3$ possible trees, with total weights $7, 8, 9$.  \nThe expected value is $8$.\n\n[Constraints and Agreements]\n\n**This problem uses bundled testdata.**\n\nSubtask 1 (5 points): $1 \\le n \\le 5$, $1 \\le k \\le 10$.  \nSubtask 2 (11 points): $k = 1$.  \nSubtask 3 (11 points): $1 \\le n, k \\le 20000$.  \nSubtask 4 (13 points): $1 \\le n, k \\le 10^5$.  \nSubtask 5 (23 points): $1 \\le k \\le 10^5$.  \nSubtask 6 (37 points): no special constraints.\n\nFor $100\\%$ of the data, $1 \\le n \\le 998244352$, $1 \\le k \\le 10^7$.\n\n****\n> \"Sorry to have kept you waiting... You have worked so hard until today...\"\n>\n> \"Xiaoyuan...\"\n>\n> \"Come, let's go. From now on, we will never be apart...\"\n>\n> \"Yes. I have been waiting for this moment—so long it felt like forever.\"\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-2】约定", "background": ">「小圆，不要走！这一分离，我们何时才能重逢？」\n>\n>「小焰，我们一定还会相见的！在那之前，我们只是短暂的离别啊......」", "description": "只因为那一句约定，小焰开始了看不到尽头的等待。\n\n约定在小焰心中幻化成了一张 $n$ 个点的图。一开始，这是一张完全图，其中点的编号从 $1$ 到 $n$，连接点 $i,j$ 的边的权值为 $(i+j)^k$。\n\n然而等待的过程中，岁月也在逐渐消磨着她的信仰，因此图中的一些边被随机地删掉了。最终，图变成了一棵 $n$ 个点的树，永远地留在了小焰的心中。\n\n很久很久以后，小焰的魔力耗尽，在痛苦与绝望之中濒临崩溃。而就在这时，小圆终于来找小焰了。为了拯救自己唯一的朋友，她必须知道这棵树边权和的期望值对 $998244353$ 取模的结果是多少。\n\n你能帮小圆求出答案，让她完成那个约定吗？", "inputFormat": "一行两个正整数 $n,k$。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模后的值。", "hint": "【样例 $1$ 说明】\n\n这个完全图有 $3$ 个节点，$3$ 条边，形成了一个环。  \n这些边的权分别为：$3,4,5$   \n最后形成的树也有 $3$ 种可能，权值分别为：$7,8,9$  \n期望值为 $8$。\n\n【数据规模与约定】\n\n**本题采用捆绑测试。**\n\nSubtask 1（5 points）：$1 \\le n \\le 5$，$1\\le k \\le 10$。     \nSubtask 2（11 points）：$k = 1$。  \nSubtask 3（11 points）：$1 \\le n,k \\le 20000$。  \nSubtask 4（13 points）：$1 \\le n,k \\le 10^5$。   \nSubtask 5（23 points）：$1 \\le k \\le 10^5$。  \nSubtask 6（37 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le n \\le 998244352,1\\le k \\le 10^7$。\n****\n>「抱歉，让你久等了...... 你一直努力到了今天吧......」  \n>\n>「小圆......」\n>\n>「来，我们走吧。今后我们永不分离......」\n>\n>「是啊，我等这一刻——望眼欲穿。」", "locale": "zh-CN"}}}
{"pid": "P5438", "type": "P", "difficulty": 7, "samples": [["2 10\n", "2\n"]], "limits": {"time": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "素数判断,质数,筛法", "容斥原理"], "title": "【XR-2】记忆", "background": "> 过去就像攥在手中的一把干沙，自以为攥得很紧，其实早就从指缝中流光了。记忆是一条早已干涸的河流，只在毫无生气的河床中剩下零落的砾石。——刘慈欣 《三体》", "description": "你的记忆被歌者拿走了。\n\n临走前，歌者告诉你，你的记忆中有一个序列，而且这个序列是所有 $l \\le x \\le r$ 的整数 $x$ 形成的一个排列。\n\n歌者想了想，决定再告诉你一点信息：\n\n如果把一个序列的权值定义为这个序列中相邻两个数的乘积为完全平方数的数量，那么你记忆中的这个序列是所有 $l \\le x \\le r$ 的整数 $x$ 形成的排列中**权值最大**的排列。\n\n歌者希望你能够把你记忆中的这个序列的权值告诉他，他才会把属于你的记忆还给你。", "inputFormat": "一行两个正整数 $l,r$。", "outputFormat": "一行一个整数，表示答案。", "hint": "【样例 $1$ 说明】\n\n一个满足权值为 $2$ 的排列为 $\\{8,2,4,9,3,10,7,5,6\\}$，其中 $8 \\times 2 = 16, 4 \\times 9=36$ 为完全平方数。这也是所有 $2 \\le x \\le 10$ 的整数 $x$ 形成的排列中权值最大的排列。\n\n【数据规模与约定】\n\n**本题采用捆绑测试。**\n\nSubtask 1（3 points）：$r \\le 10$。  \nSubtask 2（7 points）：$r \\le 100$。  \nSubtask 3（15 points）：$r \\le 100000$。  \nSubtask 4（11 points）：$l = 1$。  \nSubtask 5（8 points）：$l \\le 10$。  \nSubtask 6（19 points）：$l \\le 1000000$。  \nSubtask 7（37 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le l \\le r \\le 10^{14}$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-2] Memory", "background": "> The past is like a handful of dry sand clenched in your hand. You think you are holding it tightly, but it has already slipped away through the gaps between your fingers. Memory is a river that has long since dried up, leaving only scattered pebbles in a lifeless riverbed. — Liu Cixin, *The Three-Body Problem*.", "description": "Your memory was taken away by the Singer.\n\nBefore leaving, the Singer told you that there is a sequence in your memory, and this sequence is a permutation of all integers $x$ with $l \\le x \\le r$.\n\nAfter thinking for a moment, the Singer decided to tell you a bit more:\n\nIf we define the weight of a sequence as the number of adjacent pairs whose product is a perfect square, then the sequence in your memory is the permutation with the **maximum weight** among all permutations formed by the integers $x$ with $l \\le x \\le r$.\n\nThe Singer wants you to tell him the weight of the sequence in your memory. Only then will he return your memory to you.", "inputFormat": "One line containing two positive integers $l, r$.", "outputFormat": "One line containing one integer, which is the answer.", "hint": "[Sample $1$ Explanation]\n\nOne permutation with weight $2$ is $\\{8,2,4,9,3,10,7,5,6\\}$. In it, $8 \\times 2 = 16$ and $4 \\times 9 = 36$ are perfect squares. This is also the permutation with the maximum weight among all permutations formed by the integers $x$ with $2 \\le x \\le 10$.\n\n[Constraints]\n\n**This problem uses bundled tests.**\n\nSubtask 1 (3 points): $r \\le 10$.  \nSubtask 2 (7 points): $r \\le 100$.  \nSubtask 3 (15 points): $r \\le 100000$.  \nSubtask 4 (11 points): $l = 1$.  \nSubtask 5 (8 points): $l \\le 10$.  \nSubtask 6 (19 points): $l \\le 1000000$.  \nSubtask 7 (37 points): no special restrictions.\n\nFor $100\\%$ of the testdata, $1 \\le l \\le r \\le 10^{14}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-2】记忆", "background": "> 过去就像攥在手中的一把干沙，自以为攥得很紧，其实早就从指缝中流光了。记忆是一条早已干涸的河流，只在毫无生气的河床中剩下零落的砾石。——刘慈欣 《三体》", "description": "你的记忆被歌者拿走了。\n\n临走前，歌者告诉你，你的记忆中有一个序列，而且这个序列是所有 $l \\le x \\le r$ 的整数 $x$ 形成的一个排列。\n\n歌者想了想，决定再告诉你一点信息：\n\n如果把一个序列的权值定义为这个序列中相邻两个数的乘积为完全平方数的数量，那么你记忆中的这个序列是所有 $l \\le x \\le r$ 的整数 $x$ 形成的排列中**权值最大**的排列。\n\n歌者希望你能够把你记忆中的这个序列的权值告诉他，他才会把属于你的记忆还给你。", "inputFormat": "一行两个正整数 $l,r$。", "outputFormat": "一行一个整数，表示答案。", "hint": "【样例 $1$ 说明】\n\n一个满足权值为 $2$ 的排列为 $\\{8,2,4,9,3,10,7,5,6\\}$，其中 $8 \\times 2 = 16, 4 \\times 9=36$ 为完全平方数。这也是所有 $2 \\le x \\le 10$ 的整数 $x$ 形成的排列中权值最大的排列。\n\n【数据规模与约定】\n\n**本题采用捆绑测试。**\n\nSubtask 1（3 points）：$r \\le 10$。  \nSubtask 2（7 points）：$r \\le 100$。  \nSubtask 3（15 points）：$r \\le 100000$。  \nSubtask 4（11 points）：$l = 1$。  \nSubtask 5（8 points）：$l \\le 10$。  \nSubtask 6（19 points）：$l \\le 1000000$。  \nSubtask 7（37 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le l \\le r \\le 10^{14}$。", "locale": "zh-CN"}}}
{"pid": "P5439", "type": "P", "difficulty": 7, "samples": [["3 17\n2 0 2\n0 1 2 3 4 5 6 7 8 4 10 11 12 3 14 15 16\n0mayqueenkingrket\n9 13 17\n", "12\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 3000, 3000, 3000, 3000, 4000, 4000, 4000, 4000, 4000, 4000, 3000, 3000, 3000, 3000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["点分治", "O2优化", "虚树"], "title": "【XR-2】永恒", "background": "> 我一直认为这世界没有永恒，如果非要说永恒，宇宙间唯一的永恒就是——所有的一切都会随着时光消失。——梧桐《那片星空，那片海》", "description": "有一棵 $n$ 个点的永恒的树，树中每个点 $x(1 \\le x \\le n)$ 上都有一个永恒的字符串 $S(x)$。\n\n但这世界没有永恒，所有的一切都会随着时光消失。我们只能给每个所谓永恒的东西定义一个永恒值 $f$。这个值本身没有意义，只是一个象征罢了。\n\n- 一个字符串 $S$ 的永恒值 $f(S)$ 定义为它的长度 $\\mathrm{Len}(S)$，即：\n\n$$f(S) = \\mathrm{Len}(S)$$\n\n- 树上的一条无向路径 $K = [u, v](u < v)$ 指的是 $u,v$ 之间的简单路径（包括 $u, v$），其永恒值 $f(K)$ 定义为路径上所有不同的无序点对 $(x, y)(x \\in K, y \\in K, x < y)$ 上的字符串 $S(x), S(y)$ 的最长公共前缀 $\\mathrm{LCP}(S(x), S(y))$ 的永恒值 $f(\\mathrm{LCP}(S(x), S(y)))$ 之和，即：\n\n$$f(K) = \\sum_{x \\in K, y \\in K, x < y} f(\\mathrm{LCP}(S(x), S(y)))$$\n\n- 一棵树 $T$ 的永恒值 $f(T)$ 定义为树上所有的无向路径 $[u, v](u \\in T, v \\in T, u < v)$ 的永恒值之和，即：\n\n$$f(T) = \\sum_{u \\in T, v \\in T, u < v} f([u,v])$$\n\n特别的是，树中每个点上的字符串都来自一棵永恒的以点 $1$ 为根的 Trie 树，即每个树中的点都对应着一个 Trie 树中的点，点上的字符串就是 Trie 树中从根节点到其对应的点形成的字符串。\n\n你需要求出这棵树的永恒值，答案对 $998244353$ 取模。", "inputFormat": "第一行包含两个正整数 $n,m$，分别表示树的节点数和 Trie 树的节点数。\n\n第二行包含 $n$ 个非负整数，第 $i$ 个数为 $a_i$，表示点 $i$ 在树上的父亲节点为 $a_i$，对于树的根节点 $root$，保证 $a_{root} = 0$。\n\n第三行包含 $m$ 个非负整数，第 $i$ 个数为 $b_i$，表示点 $i$ 在 Trie 树上的父亲节点为 $b_i$，保证 $b_i < i$，$b_1=0$。\n\n第四行为一个由 $m$ 个字符构成的字符串，第 $i$ 个字符 $c_i$ 表示 Trie 树上点 $i$ 与它的父亲节点 $b_i$ 之间的边所代表的字符，保证 $c_1=\\texttt{0}$，$c_i(2 \\le i \\le m)\\in[\\texttt{a},\\texttt{z}]$。\n\n第五行包含 $n$ 个正整数 $d_i$，表示树上的点 $i$ 对应着 Trie 树上的点 $d_i$，保证 $2 \\le d_i \\le m$。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模后的值。", "hint": "【样例 $1$ 说明】\n\n所有的 $S(x)$ 为：\n\n$S(1) = \\texttt{\"mayqueen\"}$\n\n$S(2) = \\texttt{\"mayking\"}$\n\n$S(3) = \\texttt{\"market\"}$\n\n所有的 $f(\\mathrm{LCP}(S(x), S(y)))$ 为：\n\n$f(\\mathrm{LCP}(S(1), S(2))) = f(\\mathrm{LCP}(\\texttt{\"mayqueen\"}, \\texttt{\"mayking\"})) = f(\\texttt{\"may\"}) = \\mathrm{Len}(\\texttt{\"may\"}) = 3$\n\n$f(\\mathrm{LCP}(S(1), S(3))) = f(\\mathrm{LCP}(\\texttt{\"mayqueen\"}, \\texttt{\"market\"})) = f(\\texttt{\"ma\"}) = \\mathrm{Len}(\\texttt{\"ma\"}) = 2$\n\n$f(\\mathrm{LCP}(S(2), S(3))) = f(\\mathrm{LCP}(\\texttt{\"mayking\"}, \\texttt{\"market\"})) = f(\\texttt{\"ma\"}) = \\mathrm{Len}(\\texttt{\"ma\"}) = 2$\n\n所有的 $f([u, v])$ 为：\n\n$f([1,2]) = f(\\mathrm{LCP}(S(1), S(2))) = 3$\n\n$f([1,3]) = f(\\mathrm{LCP}(S(1), S(2))) + f(\\mathrm{LCP}(S(1), S(3))) + f(\\mathrm{LCP}(S(2), S(3))) = 3 + 2 + 2 = 7$\n\n$f([2,3]) = f(\\mathrm{LCP}(S(2), S(3))) = 2$\n\n所以：\n\n$f(T) = f([1,2]) + f([2,3]) + f([1,3]) = 3 + 7 + 2 = 12$\n\n【数据规模与约定】\n\n**本题采用捆绑测试。**\n\nSubtask 1（3 points）：$n, m \\le 10$，时限 1s。  \nSubtask 2（5 points）：$n, m \\le 100$，时限 1s。  \nSubtask 3（9 points）：$n, m \\le 1000$，时限 1s。  \nSubtask 4（7 points）：$n, m \\le 5000$，时限 2s。  \nSubtask 5（9 points）：$n, m \\le 20000$，时限 3s。  \nSubtask 6（11 points）：$n, m \\le 10^5$，时限 4s。  \nSubtask 7（19 points）：$m=2$，时限 3s。  \nSubtask 8（37 points）：无特殊限制，时限 10s。\n\n对于 $100\\%$ 的数据，$2 \\le n,m \\le 3\\times 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-2] Eternity", "background": "> I have always believed that there is no eternity in this world. If I must talk about eternity, the only eternity in the universe is that everything will disappear with time. — Wutong, *That Starry Sky, That Sea*.", "description": "There is an eternal tree with $n$ nodes. Each node $x(1 \\le x \\le n)$ has an eternal string $S(x)$.\n\nBut there is no eternity in this world. Everything will disappear with time. We can only define an “eternity value” $f$ for each so-called eternal thing. This value itself has no real meaning; it is just a symbol.\n\n- The eternity value $f(S)$ of a string $S$ is defined as its length $\\mathrm{Len}(S)$, i.e.:\n\n$$f(S) = \\mathrm{Len}(S)$$\n\n- An undirected path in the tree $K = [u, v](u < v)$ means the simple path between $u$ and $v$ (including $u$ and $v$). Its eternity value $f(K)$ is defined as the sum, over all distinct unordered pairs of nodes $(x, y)(x \\in K, y \\in K, x < y)$ on the path, of the eternity value $f(\\mathrm{LCP}(S(x), S(y)))$ of the longest common prefix $\\mathrm{LCP}(S(x), S(y))$ of the strings $S(x)$ and $S(y)$, i.e.:\n\n$$f(K) = \\sum_{x \\in K, y \\in K, x < y} f(\\mathrm{LCP}(S(x), S(y)))$$\n\n- The eternity value $f(T)$ of a tree $T$ is defined as the sum of the eternity values of all undirected paths $[u, v](u \\in T, v \\in T, u < v)$ in the tree, i.e.:\n\n$$f(T) = \\sum_{u \\in T, v \\in T, u < v} f([u,v])$$\n\nIn particular, the string on each node of the tree comes from an eternal Trie rooted at node $1$. That is, each node in the tree corresponds to a node in the Trie, and the string on that node is the string formed along the path from the Trie root to its corresponding node.\n\nYou need to compute the eternity value of this tree. Take the answer modulo $998244353$.", "inputFormat": "The first line contains two positive integers $n, m$, denoting the number of nodes in the tree and the number of nodes in the Trie, respectively.\n\nThe second line contains $n$ non-negative integers. The $i$-th number is $a_i$, meaning that the parent of node $i$ in the tree is $a_i$. For the root node $root$, it is guaranteed that $a_{root} = 0$.\n\nThe third line contains $m$ non-negative integers. The $i$-th number is $b_i$, meaning that the parent of node $i$ in the Trie is $b_i$. It is guaranteed that $b_i < i$ and $b_1 = 0$.\n\nThe fourth line is a string of $m$ characters. The $i$-th character $c_i$ represents the character on the edge between Trie node $i$ and its parent node $b_i$. It is guaranteed that $c_1=\\texttt{0}$ and $c_i(2 \\le i \\le m)\\in[\\texttt{a},\\texttt{z}]$.\n\nThe fifth line contains $n$ positive integers $d_i$, meaning that node $i$ in the tree corresponds to node $d_i$ in the Trie. It is guaranteed that $2 \\le d_i \\le m$.", "outputFormat": "Output one integer: the answer modulo $998244353$.", "hint": "[Sample $1$ Explanation]\n\nAll $S(x)$ are:\n\n$S(1) = \\texttt{\"mayqueen\"}$\n\n$S(2) = \\texttt{\"mayking\"}$\n\n$S(3) = \\texttt{\"market\"}$\n\nAll $f(\\mathrm{LCP}(S(x), S(y)))$ are:\n\n$f(\\mathrm{LCP}(S(1), S(2))) = f(\\mathrm{LCP}(\\texttt{\"mayqueen\"}, \\texttt{\"mayking\"})) = f(\\texttt{\"may\"}) = \\mathrm{Len}(\\texttt{\"may\"}) = 3$\n\n$f(\\mathrm{LCP}(S(1), S(3))) = f(\\mathrm{LCP}(\\texttt{\"mayqueen\"}, \\texttt{\"market\"})) = f(\\texttt{\"ma\"}) = \\mathrm{Len}(\\texttt{\"ma\"}) = 2$\n\n$f(\\mathrm{LCP}(S(2), S(3))) = f(\\mathrm{LCP}(\\texttt{\"mayking\"}, \\texttt{\"market\"})) = f(\\texttt{\"ma\"}) = \\mathrm{Len}(\\texttt{\"ma\"}) = 2$\n\nAll $f([u, v])$ are:\n\n$f([1,2]) = f(\\mathrm{LCP}(S(1), S(2))) = 3$\n\n$f([1,3]) = f(\\mathrm{LCP}(S(1), S(2))) + f(\\mathrm{LCP}(S(1), S(3))) + f(\\mathrm{LCP}(S(2), S(3))) = 3 + 2 + 2 = 7$\n\n$f([2,3]) = f(\\mathrm{LCP}(S(2), S(3))) = 2$\n\nTherefore:\n\n$f(T) = f([1,2]) + f([2,3]) + f([1,3]) = 3 + 7 + 2 = 12$\n\n[Constraints and Conventions]\n\n**This problem uses bundled testdata.**\n\nSubtask 1 (3 points): $n, m \\le 10$, time limit 1s.  \nSubtask 2 (5 points): $n, m \\le 100$, time limit 1s.  \nSubtask 3 (9 points): $n, m \\le 1000$, time limit 1s.  \nSubtask 4 (7 points): $n, m \\le 5000$, time limit 2s.  \nSubtask 5 (9 points): $n, m \\le 20000$, time limit 3s.  \nSubtask 6 (11 points): $n, m \\le 10^5$, time limit 4s.  \nSubtask 7 (19 points): $m = 2$, time limit 3s.  \nSubtask 8 (37 points): no special restrictions, time limit 10s.\n\nFor $100\\%$ of the testdata, $2 \\le n, m \\le 3\\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-2】永恒", "background": "> 我一直认为这世界没有永恒，如果非要说永恒，宇宙间唯一的永恒就是——所有的一切都会随着时光消失。——梧桐《那片星空，那片海》", "description": "有一棵 $n$ 个点的永恒的树，树中每个点 $x(1 \\le x \\le n)$ 上都有一个永恒的字符串 $S(x)$。\n\n但这世界没有永恒，所有的一切都会随着时光消失。我们只能给每个所谓永恒的东西定义一个永恒值 $f$。这个值本身没有意义，只是一个象征罢了。\n\n- 一个字符串 $S$ 的永恒值 $f(S)$ 定义为它的长度 $\\mathrm{Len}(S)$，即：\n\n$$f(S) = \\mathrm{Len}(S)$$\n\n- 树上的一条无向路径 $K = [u, v](u < v)$ 指的是 $u,v$ 之间的简单路径（包括 $u, v$），其永恒值 $f(K)$ 定义为路径上所有不同的无序点对 $(x, y)(x \\in K, y \\in K, x < y)$ 上的字符串 $S(x), S(y)$ 的最长公共前缀 $\\mathrm{LCP}(S(x), S(y))$ 的永恒值 $f(\\mathrm{LCP}(S(x), S(y)))$ 之和，即：\n\n$$f(K) = \\sum_{x \\in K, y \\in K, x < y} f(\\mathrm{LCP}(S(x), S(y)))$$\n\n- 一棵树 $T$ 的永恒值 $f(T)$ 定义为树上所有的无向路径 $[u, v](u \\in T, v \\in T, u < v)$ 的永恒值之和，即：\n\n$$f(T) = \\sum_{u \\in T, v \\in T, u < v} f([u,v])$$\n\n特别的是，树中每个点上的字符串都来自一棵永恒的以点 $1$ 为根的 Trie 树，即每个树中的点都对应着一个 Trie 树中的点，点上的字符串就是 Trie 树中从根节点到其对应的点形成的字符串。\n\n你需要求出这棵树的永恒值，答案对 $998244353$ 取模。", "inputFormat": "第一行包含两个正整数 $n,m$，分别表示树的节点数和 Trie 树的节点数。\n\n第二行包含 $n$ 个非负整数，第 $i$ 个数为 $a_i$，表示点 $i$ 在树上的父亲节点为 $a_i$，对于树的根节点 $root$，保证 $a_{root} = 0$。\n\n第三行包含 $m$ 个非负整数，第 $i$ 个数为 $b_i$，表示点 $i$ 在 Trie 树上的父亲节点为 $b_i$，保证 $b_i < i$，$b_1=0$。\n\n第四行为一个由 $m$ 个字符构成的字符串，第 $i$ 个字符 $c_i$ 表示 Trie 树上点 $i$ 与它的父亲节点 $b_i$ 之间的边所代表的字符，保证 $c_1=\\texttt{0}$，$c_i(2 \\le i \\le m)\\in[\\texttt{a},\\texttt{z}]$。\n\n第五行包含 $n$ 个正整数 $d_i$，表示树上的点 $i$ 对应着 Trie 树上的点 $d_i$，保证 $2 \\le d_i \\le m$。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模后的值。", "hint": "【样例 $1$ 说明】\n\n所有的 $S(x)$ 为：\n\n$S(1) = \\texttt{\"mayqueen\"}$\n\n$S(2) = \\texttt{\"mayking\"}$\n\n$S(3) = \\texttt{\"market\"}$\n\n所有的 $f(\\mathrm{LCP}(S(x), S(y)))$ 为：\n\n$f(\\mathrm{LCP}(S(1), S(2))) = f(\\mathrm{LCP}(\\texttt{\"mayqueen\"}, \\texttt{\"mayking\"})) = f(\\texttt{\"may\"}) = \\mathrm{Len}(\\texttt{\"may\"}) = 3$\n\n$f(\\mathrm{LCP}(S(1), S(3))) = f(\\mathrm{LCP}(\\texttt{\"mayqueen\"}, \\texttt{\"market\"})) = f(\\texttt{\"ma\"}) = \\mathrm{Len}(\\texttt{\"ma\"}) = 2$\n\n$f(\\mathrm{LCP}(S(2), S(3))) = f(\\mathrm{LCP}(\\texttt{\"mayking\"}, \\texttt{\"market\"})) = f(\\texttt{\"ma\"}) = \\mathrm{Len}(\\texttt{\"ma\"}) = 2$\n\n所有的 $f([u, v])$ 为：\n\n$f([1,2]) = f(\\mathrm{LCP}(S(1), S(2))) = 3$\n\n$f([1,3]) = f(\\mathrm{LCP}(S(1), S(2))) + f(\\mathrm{LCP}(S(1), S(3))) + f(\\mathrm{LCP}(S(2), S(3))) = 3 + 2 + 2 = 7$\n\n$f([2,3]) = f(\\mathrm{LCP}(S(2), S(3))) = 2$\n\n所以：\n\n$f(T) = f([1,2]) + f([2,3]) + f([1,3]) = 3 + 7 + 2 = 12$\n\n【数据规模与约定】\n\n**本题采用捆绑测试。**\n\nSubtask 1（3 points）：$n, m \\le 10$，时限 1s。  \nSubtask 2（5 points）：$n, m \\le 100$，时限 1s。  \nSubtask 3（9 points）：$n, m \\le 1000$，时限 1s。  \nSubtask 4（7 points）：$n, m \\le 5000$，时限 2s。  \nSubtask 5（9 points）：$n, m \\le 20000$，时限 3s。  \nSubtask 6（11 points）：$n, m \\le 10^5$，时限 4s。  \nSubtask 7（19 points）：$m=2$，时限 3s。  \nSubtask 8（37 points）：无特殊限制，时限 10s。\n\n对于 $100\\%$ 的数据，$2 \\le n,m \\le 3\\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P5440", "type": "P", "difficulty": 3, "samples": [["2\n53-7-3-7\n20190629\n", "6\n0\n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["搜索", "O2优化", "剪枝", "素数判断,质数,筛法"], "title": "【XR-2】奇迹", "background": "> 相信奇迹的人，本身就和奇迹一样了不起。——笛亚 《星游记》", "description": "我们称一个**日期**为一个八位数，第 $1\\sim 4$ 位构成年，第 $5\\sim 6$ 位构成月，第 $7\\sim 8$ 位构成日，不足位数用 $0$ 补足。同时，要求日期所代表的这一天真实存在，且年的范围为 $1\\sim 9999$。\n\n出现奇迹的日期都存在相同的特点：由“日”组成的两位数，由“月+日”组成的四位数，由“年+月+日”组成的八位数均为**质数**。但并不是所有存在这样特点的日期都一定会出现奇迹。\n\n现在，你得到了一个可能会出现奇迹的日期，然而不幸的是这个日期却是残缺的，八位中可能有若干位无法确定。你需要知道这个日期有多少种可能，这样你才能做好充足的准备去迎接奇迹的到来。", "inputFormat": "**本题有多组数据。**\n\n第一行一个正整数 $T$，表示数据组数。\n\n接下来的 $T$ 行，每行一个八位字符串。其中第 $i$ 位如果为 `-`，则表示日期的第 $i$ 位无法确定，否则表示日期的第 $i$ 位为字符串中第 $i$ 位上的数字。", "outputFormat": "对每组数据，一行一个整数，表示答案。", "hint": "【样例 $1$ 说明】\n\n`53-7-3-7` 的 $6$ 种可能的日期如下：\n\n```plain\n53070307\n53070317\n53170307\n53370307\n53570317\n53770307\n```\n\n【数据规模与约定】\n\n一共 $10$ 个测试点，记 $c$ 为八位字符串中 `-` 的个数。\n\n对前 $9$ 个测试点，在第 $i$ 个测试点中保证 $c = i - 1$。\n\n对 $100\\%$ 的数据保证 $1 \\le T \\le 10$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-2] Miracle", "background": "> Those who believe in miracles are, themselves, as amazing as miracles. — Diya, *Star Odyssey*.", "description": "We define a **date** as an 8-digit number. Digits $1 \\sim 4$ form the year, digits $5 \\sim 6$ form the month, and digits $7 \\sim 8$ form the day. If a part has fewer digits, it is padded with $0$. Also, the day represented by the date must really exist, and the year ranges from $1 \\sim 9999$.\n\nAll miracle dates share the same property: the 2-digit number formed by the “day”, the 4-digit number formed by “month + day”, and the 8-digit number formed by “year + month + day” are all **prime numbers**. However, not every date with this property will necessarily have a miracle.\n\nNow you are given a date that may have a miracle, but unfortunately this date is incomplete: among the 8 digits, some digits may be unknown. You need to determine how many possible dates it could be, so that you can be fully prepared to welcome the miracle.", "inputFormat": "**This problem has multiple test cases.**\n\nThe first line contains a positive integer $T$, the number of test cases.\n\nThe next $T$ lines each contain an 8-character string. If the $i$-th character is `-`, it means the $i$-th digit of the date is unknown; otherwise, it means the $i$-th digit of the date is the digit at position $i$ in the string.", "outputFormat": "For each test case, output one integer per line, representing the answer.", "hint": "[Sample $1$ Explanation]\n\nThe 6 possible dates for `53-7-3-7` are:\n\n```plain\n53070307\n53070317\n53170307\n53370307\n53570317\n53770307\n```\n\n[Constraints]\n\nThere are $10$ test points in total. Let $c$ be the number of `-` characters in the 8-character string.\n\nFor the first $9$ test points, in the $i$-th test point it is guaranteed that $c = i - 1$.\n\nFor $100\\%$ of the testdata, it is guaranteed that $1 \\le T \\le 10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-2】奇迹", "background": "> 相信奇迹的人，本身就和奇迹一样了不起。——笛亚 《星游记》", "description": "我们称一个**日期**为一个八位数，第 $1\\sim 4$ 位构成年，第 $5\\sim 6$ 位构成月，第 $7\\sim 8$ 位构成日，不足位数用 $0$ 补足。同时，要求日期所代表的这一天真实存在，且年的范围为 $1\\sim 9999$。\n\n出现奇迹的日期都存在相同的特点：由“日”组成的两位数，由“月+日”组成的四位数，由“年+月+日”组成的八位数均为**质数**。但并不是所有存在这样特点的日期都一定会出现奇迹。\n\n现在，你得到了一个可能会出现奇迹的日期，然而不幸的是这个日期却是残缺的，八位中可能有若干位无法确定。你需要知道这个日期有多少种可能，这样你才能做好充足的准备去迎接奇迹的到来。", "inputFormat": "**本题有多组数据。**\n\n第一行一个正整数 $T$，表示数据组数。\n\n接下来的 $T$ 行，每行一个八位字符串。其中第 $i$ 位如果为 `-`，则表示日期的第 $i$ 位无法确定，否则表示日期的第 $i$ 位为字符串中第 $i$ 位上的数字。", "outputFormat": "对每组数据，一行一个整数，表示答案。", "hint": "【样例 $1$ 说明】\n\n`53-7-3-7` 的 $6$ 种可能的日期如下：\n\n```plain\n53070307\n53070317\n53170307\n53370307\n53570317\n53770307\n```\n\n【数据规模与约定】\n\n一共 $10$ 个测试点，记 $c$ 为八位字符串中 `-` 的个数。\n\n对前 $9$ 个测试点，在第 $i$ 个测试点中保证 $c = i - 1$。\n\n对 $100\\%$ 的数据保证 $1 \\le T \\le 10$。", "locale": "zh-CN"}}}
{"pid": "P5441", "type": "P", "difficulty": 6, "samples": [["3\n", "0\n0 1 1\n0 0 1\n0 1 0\n"], ["5\n", "5\n0 1 0 1 1\n0 0 1 1 0\n1 0 0 0 1\n1 0 1 0 1\n1 1 0 0 0\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "Special Judge", "O2优化", "组合数学", "构造"], "title": "【XR-2】伤痕", "background": "> 长日尽处，我来到你的面前，你将看见我的伤痕，你会知晓我曾受伤，也曾痊愈。——泰戈尔《深爱你这城》", "description": "X 国经历了一场前所未有的大地震，人们伤痕累累，整个国家破碎不堪。\n\n为了帮助人们痊愈，也为了让 X 国能够生存下去，X 国国王决定重建 X 国。\n\n国王决定先建造 $n$ 座城市，由于国王喜欢奇数，所以 $n$ 为奇数。\n\n城市建造完后，需要给每两座城市之间都修建一条道路，即一共需要修建 $\\frac{n(n-1)}{2}$ 条道路。\n\n不过，修建双向道路的成本太高了，建造完 $n$ 座城市后剩下的经费最多只够修建 $n$ 条双向道路，而其余的道路只能修建成单向的。好在方向并不会影响修建单向道路所需的费用，因此所有单向道路的方向可以任意决定。\n\n另外，等到重建完成后，国王决定将 $4$ 座城市钦定为 X 国的核心城市。为促进 X 国的发展，这 $4$ 座核心城市中的任意两座城市，必须能够在不经过非核心城市的情况下相互到达。\n\n国王希望，你能够给他一种道路修建方案，使重建完成后选择 $4$ 座核心城市的方案数最大化。", "inputFormat": "一行一个正整数 $n(1 \\le n \\le 99)$，保证 $n$ 为奇数，表示有 $n$ 座城市。", "outputFormat": "第一行包含一个整数，表示最大的选择 $4$ 座核心城市的方案数。\n\n接下来的 $n$ 行每行 $n$ 个正整数描述一个邻接矩阵，表示你的道路修建方案。\n\n具体来说，第 $i$ 行的第 $j$ 个数为 $1$ 表示第 $i$ 座城市可以通过一条道路到达第 $j$ 座城市，为 $0$ 表示第 $i$ 座城市无法通过一条道路到达第 $j$ 座城市。我们分为 $3$ 种情况详细说明：\n\n1. $i, j$ 之前的道路为一条 $i$ 到 $j$ 的单向道路，则邻接矩阵的第 $i$ 行第 $j$ 个数为 $1$，第 $j$ 行第 $i$ 个数为 $0$。\n2. $i, j$ 之间的道路为一条双向道路，则邻接矩阵的第 $i$ 行第 $j$ 个数和第 $j$ 行第 $i$ 个数均为 $1$，你需要保证最多修建 $n$ 条双向道路。\n3. $i = j$，则第 $i$ 行第 $j$ 个数（第 $j$ 行第 $i$ 个数）为 $0$。", "hint": "【样例 $1$ 说明】\n\n由于一共只有 $3$ 个点，所以选择 $4$ 座核心城市的方案数一定为 $0$，那么只需要保证修建方案满足条件即可。\n\n【样例 $2$ 说明】\n\n![](https://cdn.luogu.com.cn/upload/pic/60711.png)\n\n显然，在 $5$ 个点中任意选 $4$ 个点，都满足核心城市的条件，因此方案数最大为 $5$。\n\n【数据规模与约定】\n\n本题一共有 $50$ 个测试点，每个测试点 $2$ 分。对于第 $i$ 个测试点，$n = 2i - 1$。\n\n对于每个测试点，有五种可能的结果：\n\n1. 输出格式错误，包括：没有输出最大方案数、没有输出邻接矩阵、输出了多余的信息等。你将无法得到该测试点的任何分数，同时我们无法确定 Special Judge 的返回结果。\n2. 没有正确计算最大方案数，即使构造的道路修建方案是正确的。你将得到该测试点 $0\\%$ 的分数（即 $0$ 分），Special Judge 将会返回 WA 的结果，同时输出 “The answer is wrong.”\n3. 正确计算了最大方案数，但是构造的道路修建方案不满足条件，包括：邻接矩阵中有不为 $0$ 或 $1$ 的数、有自环、有两座城市中没有道路、有多于 $n$ 条双向道路等。你将得到该测试点 $50\\%$ 的分数（即 $1$ 分），Special Judge 将会返回 WA 的结果，同时输出 “The answer is correct, but your plan breaks the rules.”\n4. 正确计算了最大方案数，构造的道路修建方案满足条件但没有将选择 $4$ 座核心城市的方案数最大化。你将得到该测试点 $50\\%$ 的分数（即 $1$ 分），Special Judge 将会返回 WA 的结果，同时输出 “The answer is correct, but your plan is wrong.”\n5. 正确计算了最大方案数，同时正确构造了道路修建方案。你将得到该测试点 $100\\%$ 的分数（即 $2$ 分），Special Judge 将会返回 AC 的结果，同时输出 “The answer is correct.”", "locale": "zh-CN", "translations": {"en": {"title": "[XR-2] Scars.", "background": "> At the end of a long day, I come before you. You will see my scars. You will know that I was once hurt, and that I have also healed. — Tagore, *Love This City Deeply*.", "description": "Country X has suffered an unprecedented earthquake. People are covered in scars, and the whole country is shattered.\n\nTo help people heal, and also to allow Country X to survive, the King of Country X decides to rebuild the country.\n\nThe King decides to first build $n$ cities. Since the King likes odd numbers, $n$ is odd.\n\nAfter the cities are built, a road must be built between every pair of cities, i.e., a total of $\\frac{n(n-1)}{2}$ roads.\n\nHowever, the cost of building bidirectional roads is too high. After building $n$ cities, the remaining budget is enough to build at most $n$ bidirectional roads, and all other roads can only be built as one-way roads. Fortunately, the direction does not affect the cost of building a one-way road, so the directions of all one-way roads can be chosen arbitrarily.\n\nIn addition, after the rebuilding is completed, the King will designate $4$ cities as the core cities of Country X. To promote the development of Country X, for any two of these $4$ core cities, they must be able to reach each other without passing through non-core cities.\n\nThe King hopes that you can provide him with a road construction plan such that, after the rebuilding is completed, the number of ways to choose $4$ core cities is maximized.", "inputFormat": "One line containing a positive integer $n(1 \\le n \\le 99)$, guaranteed that $n$ is odd, meaning there are $n$ cities.", "outputFormat": "The first line contains an integer, representing the maximum number of ways to choose $4$ core cities.\n\nThe next $n$ lines each contain $n$ positive integers describing an adjacency matrix, representing your road construction plan.\n\nSpecifically, the $j$-th number in the $i$-th line is $1$ if city $i$ can reach city $j$ via a road, and $0$ if city $i$ cannot reach city $j$ via a road. We explain in detail in $3$ cases:\n\n1. If the road between $i$ and $j$ is a one-way road from $i$ to $j$, then the number in row $i$, column $j$ of the adjacency matrix is $1$, and the number in row $j$, column $i$ is $0$.\n2. If the road between $i$ and $j$ is a bidirectional road, then both the number in row $i$, column $j$ and the number in row $j$, column $i$ are $1$. You must ensure that at most $n$ bidirectional roads are built.\n3. If $i = j$, then the number in row $i$, column $j$ (the number in row $j$, column $i$) is $0$.", "hint": "[Sample $1$ Explanation]\n\nSince there are only $3$ points in total, the number of ways to choose $4$ core cities must be $0$. So you only need to ensure that the construction plan satisfies the requirements.\n\n[Sample $2$ Explanation]\n\n![](https://cdn.luogu.com.cn/upload/pic/60711.png)\n\nObviously, among $5$ points, choosing any $4$ points satisfies the core-city condition, so the maximum number of ways is $5$.\n\n[Constraints]\n\nThis problem has $50$ test points, each worth $2$ points. For the $i$-th test point, $n = 2i - 1$.\n\nFor each test point, there are five possible outcomes:\n\n1. Output format error, including: not outputting the maximum number of ways, not outputting the adjacency matrix, outputting extra information, etc. You will not get any points for this test point, and we cannot determine the return result of the Special Judge.\n2. The maximum number of ways is not computed correctly, even if the constructed road plan is correct. You will get $0\\%$ of the score for this test point (i.e., $0$ points). The Special Judge will return WA and output “The answer is wrong.”\n3. The maximum number of ways is computed correctly, but the constructed road plan does not satisfy the requirements, including: numbers in the adjacency matrix that are not $0$ or $1$, self-loops, a pair of cities with no road between them, more than $n$ bidirectional roads, etc. You will get $50\\%$ of the score for this test point (i.e., $1$ point). The Special Judge will return WA and output “The answer is correct, but your plan breaks the rules.”\n4. The maximum number of ways is computed correctly, and the constructed road plan satisfies the requirements, but the number of ways to choose $4$ core cities is not maximized. You will get $50\\%$ of the score for this test point (i.e., $1$ point). The Special Judge will return WA and output “The answer is correct, but your plan is wrong.”\n5. The maximum number of ways is computed correctly, and the road construction plan is also constructed correctly. You will get $100\\%$ of the score for this test point (i.e., $2$ points). The Special Judge will return AC and output “The answer is correct.”\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-2】伤痕", "background": "> 长日尽处，我来到你的面前，你将看见我的伤痕，你会知晓我曾受伤，也曾痊愈。——泰戈尔《深爱你这城》", "description": "X 国经历了一场前所未有的大地震，人们伤痕累累，整个国家破碎不堪。\n\n为了帮助人们痊愈，也为了让 X 国能够生存下去，X 国国王决定重建 X 国。\n\n国王决定先建造 $n$ 座城市，由于国王喜欢奇数，所以 $n$ 为奇数。\n\n城市建造完后，需要给每两座城市之间都修建一条道路，即一共需要修建 $\\frac{n(n-1)}{2}$ 条道路。\n\n不过，修建双向道路的成本太高了，建造完 $n$ 座城市后剩下的经费最多只够修建 $n$ 条双向道路，而其余的道路只能修建成单向的。好在方向并不会影响修建单向道路所需的费用，因此所有单向道路的方向可以任意决定。\n\n另外，等到重建完成后，国王决定将 $4$ 座城市钦定为 X 国的核心城市。为促进 X 国的发展，这 $4$ 座核心城市中的任意两座城市，必须能够在不经过非核心城市的情况下相互到达。\n\n国王希望，你能够给他一种道路修建方案，使重建完成后选择 $4$ 座核心城市的方案数最大化。", "inputFormat": "一行一个正整数 $n(1 \\le n \\le 99)$，保证 $n$ 为奇数，表示有 $n$ 座城市。", "outputFormat": "第一行包含一个整数，表示最大的选择 $4$ 座核心城市的方案数。\n\n接下来的 $n$ 行每行 $n$ 个正整数描述一个邻接矩阵，表示你的道路修建方案。\n\n具体来说，第 $i$ 行的第 $j$ 个数为 $1$ 表示第 $i$ 座城市可以通过一条道路到达第 $j$ 座城市，为 $0$ 表示第 $i$ 座城市无法通过一条道路到达第 $j$ 座城市。我们分为 $3$ 种情况详细说明：\n\n1. $i, j$ 之前的道路为一条 $i$ 到 $j$ 的单向道路，则邻接矩阵的第 $i$ 行第 $j$ 个数为 $1$，第 $j$ 行第 $i$ 个数为 $0$。\n2. $i, j$ 之间的道路为一条双向道路，则邻接矩阵的第 $i$ 行第 $j$ 个数和第 $j$ 行第 $i$ 个数均为 $1$，你需要保证最多修建 $n$ 条双向道路。\n3. $i = j$，则第 $i$ 行第 $j$ 个数（第 $j$ 行第 $i$ 个数）为 $0$。", "hint": "【样例 $1$ 说明】\n\n由于一共只有 $3$ 个点，所以选择 $4$ 座核心城市的方案数一定为 $0$，那么只需要保证修建方案满足条件即可。\n\n【样例 $2$ 说明】\n\n![](https://cdn.luogu.com.cn/upload/pic/60711.png)\n\n显然，在 $5$ 个点中任意选 $4$ 个点，都满足核心城市的条件，因此方案数最大为 $5$。\n\n【数据规模与约定】\n\n本题一共有 $50$ 个测试点，每个测试点 $2$ 分。对于第 $i$ 个测试点，$n = 2i - 1$。\n\n对于每个测试点，有五种可能的结果：\n\n1. 输出格式错误，包括：没有输出最大方案数、没有输出邻接矩阵、输出了多余的信息等。你将无法得到该测试点的任何分数，同时我们无法确定 Special Judge 的返回结果。\n2. 没有正确计算最大方案数，即使构造的道路修建方案是正确的。你将得到该测试点 $0\\%$ 的分数（即 $0$ 分），Special Judge 将会返回 WA 的结果，同时输出 “The answer is wrong.”\n3. 正确计算了最大方案数，但是构造的道路修建方案不满足条件，包括：邻接矩阵中有不为 $0$ 或 $1$ 的数、有自环、有两座城市中没有道路、有多于 $n$ 条双向道路等。你将得到该测试点 $50\\%$ 的分数（即 $1$ 分），Special Judge 将会返回 WA 的结果，同时输出 “The answer is correct, but your plan breaks the rules.”\n4. 正确计算了最大方案数，构造的道路修建方案满足条件但没有将选择 $4$ 座核心城市的方案数最大化。你将得到该测试点 $50\\%$ 的分数（即 $1$ 分），Special Judge 将会返回 WA 的结果，同时输出 “The answer is correct, but your plan is wrong.”\n5. 正确计算了最大方案数，同时正确构造了道路修建方案。你将得到该测试点 $100\\%$ 的分数（即 $2$ 分），Special Judge 将会返回 AC 的结果，同时输出 “The answer is correct.”", "locale": "zh-CN"}}}
{"pid": "P5442", "type": "P", "difficulty": 6, "samples": [["3 1", "8"], ["4 3", "450"], ["1926 817", "984167516"], ["998244353 1", "998244352"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [614400, 614400, 614400, 614400, 614400, 614400, 614400, 614400, 614400, 614400]}, "tags": ["数学", "O2优化", "期望", "逆元"], "title": "【XR-2】约定 (加强版)", "background": "原题链接：[P5437](https://www.luogu.org/problemnew/show/P5437)\n\n其实在比赛时就想放上这个加强版了qwq    \n但是团队成员都强烈反对，于是就在赛后放上来啦", "description": "有一个 $n$ 个点的完全图，编号从 $1$ 到 $n$。  \n连接 $i$ 和 $j$ 节点的边，权值为 $(i+j)^k$。  \n定义一棵树的权值为其所有边的权值和。  \n从这个图的所有生成树中随机选择一个，求其权值的期望。  \n需要将答案对 $998244353$ 取模。", "inputFormat": "一行两个正整数 $n,k$。", "outputFormat": "一行一个整数表示答案对 $998244353$ 取模的结果。", "hint": "### 数据范围：   \n$1\\le n \\le 10^{10000}$  \n$1\\le k \\le 10^7$\n", "locale": "zh-CN", "translations": {"en": {"title": "[XR-2] Appointment (Enhanced Version)", "background": "Original problem link: [P5437](https://www.luogu.org/problemnew/show/P5437).\n\nActually, during the contest I wanted to include this enhanced version qwq.  \nBut the team members strongly disagreed, so I posted it after the contest.", "description": "There is a complete graph with $n$ vertices, numbered from $1$ to $n$.  \nFor the edge connecting vertices $i$ and $j$, its weight is $(i+j)^k$.  \nDefine the weight of a tree as the sum of the weights of all its edges.  \nRandomly choose a spanning tree from all spanning trees of this graph, and find the expected value of its weight.  \nYou need to output the answer modulo $998244353$.", "inputFormat": "One line containing two positive integers $n, k$.", "outputFormat": "One line containing one integer, representing the answer modulo $998244353$.", "hint": "### Constraints\n\n$1\\le n \\le 10^{10000}$  \n$1\\le k \\le 10^7$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-2】约定 (加强版)", "background": "原题链接：[P5437](https://www.luogu.org/problemnew/show/P5437)\n\n其实在比赛时就想放上这个加强版了qwq    \n但是团队成员都强烈反对，于是就在赛后放上来啦", "description": "有一个 $n$ 个点的完全图，编号从 $1$ 到 $n$。  \n连接 $i$ 和 $j$ 节点的边，权值为 $(i+j)^k$。  \n定义一棵树的权值为其所有边的权值和。  \n从这个图的所有生成树中随机选择一个，求其权值的期望。  \n需要将答案对 $998244353$ 取模。", "inputFormat": "一行两个正整数 $n,k$。", "outputFormat": "一行一个整数表示答案对 $998244353$ 取模的结果。", "hint": "### 数据范围：   \n$1\\le n \\le 10^{10000}$  \n$1\\le k \\le 10^7$\n", "locale": "zh-CN"}}}
{"pid": "P5443", "type": "P", "difficulty": 6, "samples": [["3 4\n1 2 5\n2 3 2\n3 1 4\n2 3 8\n5\n2 1 5\n1 4 1\n2 2 5\n1 1 1\n2 3 2", "3\n2\n3"], ["7 8\n1 2 5\n1 6 5\n2 3 5\n2 7 5\n3 4 5\n4 5 5\n5 6 5\n6 7 5\n12\n2 1 6\n1 1 1\n2 1 2\n1 2 3\n2 2 2\n1 5 2\n1 3 1\n2 2 4\n2 4 2\n1 8 1\n2 1 1\n2 1 3", "1\n7\n7\n5\n7\n7\n4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2019", "并查集", "APIO", "分块"], "title": "[APIO2019] 桥梁", "background": "圣彼得堡市内所有水路长度总和约 $282$ 千米，市内水域面积占城市面积的 $7\\%$。——来自维基百科", "description": "圣彼得堡位于由 $m$ 座桥梁连接而成的 $n$ 个岛屿上。岛屿用 $1$ 到 $n$ 的整数编号，桥梁用 $1$ 到 $m$ 的整数编号。每座桥连接两个不同的岛屿。有些桥梁是在彼得大帝时代建造的，其中一些是近期建造的。这导致了不同的桥梁可能有不同的重量限制。更具体地，只有重量不超过 $d_i$ 的汽车才能通过第 $i$ 座桥梁。有时圣彼得堡的一些桥梁会进行翻新，但这并不一定会使桥梁承重变得更好，也就是说，进行翻新的桥梁的 $d_i$ 可能会增加或减少。你准备开发一个产品，用于帮助公民和城市客人。目前，你开发的模块要能执行两种类型的操作：\n\n1. 将桥梁 $b_j$ 的重量限制改为 $r_j$。\n\n2. 统计一辆重为 $w_j$ 的汽车从岛屿 $s_j$ 出发能够到达多少个不同的岛屿。\n\n请你回答所有第二种操作的答案。\n\n", "inputFormat": "第一行包含两个整数 $n$ 和 $m$—— 表示圣彼得堡的岛屿数量与桥梁数量。\n\n接下来 $m$ 行，每行三个整数 $u_i,v_i,d_i$。第 $i$ 行的整数描述了一座连接岛屿 $u_i$ 和 $v_i$，初始时重量限制为 $d_i$ 的桥梁。\n\n接下来一行一个整数 $q$—— 表示操作的数量。\n\n接下来 $q$ 行按顺序每行描述一个操作。\n\n每行第一个整数 $t_j$ 表示操作类型：\n\n- 若 $t_j=1$，则该操作是第一种类型，该行接下来给定两个整数 $b_j$ 和 $r_j$，表示桥梁 $b_j$ 的重量限制将变为 $r_j$。\n\n- 若 $t_j=2$，则该操作是第二种类型，该行接下来给定两个整数 $s_j$ 和 $w_j$，表示一辆重为 $w_j$ 的汽车将要从第 $s_j$ 个岛屿出发。", "outputFormat": "对于每个第二种类型的询问，输出一行一个整数表示答案。", "hint": "对于全部数据，$1 \\leq n \\leq 5\\times 10^4$，$0 \\leq m \\leq 10^5$，$1 \\leq q \\leq 10^5$。保证 $1 \\leq u_i$，$v_i$, $s_j \\leq n$，$u_i \\neq v_i$，$1 \\leq d_i$, $r_j$, $w_j \\leq 10^9$，$1 \\leq b_j \\leq m$，$t_j \\in {1,2}$。\n\n详细子任务附加限制与分值如下表\n\n| 子任务 | 附加限制 | 分值 |\n| :----------: | :----------: | :----------: |\n| 1 | $n$, $m\\leq 10^3$，$q\\leq 10^4$ | 13 |\n| 2 | 岛屿和桥梁将形成一个树结构；$m=n-1$，$u_i=i$，$v_i=i+1$；（$1\\leq i\\leq m$） | 16 |\n| 3 | 岛屿和桥梁将形成一个完全二叉树结构；$n=2^k-1$，$m=n-1$，$u_i=\\frac{i+1}{2}$，$v_i=i+1$；（$1\\leq k\\leq 15$，$1\\leq i\\leq m$） | 17 |\n| 4 | 所有 $t_i$ 均为 $2$ | 14 |\n| 5 | 岛屿和桥梁将形成一个树结构 | 13 |\n| 6 | 无特殊限制 | 27 |", "locale": "zh-CN", "translations": {"en": {"title": "[APIO2019] Bridges", "background": "The total length of all waterways in Saint Petersburg is about $282$ km, and the water area accounts for $7\\%$ of the city area. — From Wikipedia.", "description": "Saint Petersburg is located on $n$ islands connected by $m$ bridges. The islands are numbered with integers from $1$ to $n$, and the bridges are numbered with integers from $1$ to $m$. Each bridge connects two different islands. Some bridges were built in the era of Peter the Great, while others were built more recently. As a result, different bridges may have different weight limits. More specifically, only cars with weight not exceeding $d_i$ can cross bridge $i$. Sometimes, some bridges in Saint Petersburg are renovated, but this does not necessarily make their load capacity better; that is, after renovation, the $d_i$ of a bridge may increase or decrease. You are going to develop a product to help citizens and city visitors. Currently, the module you are developing needs to support two types of operations:\n\n1. Change the weight limit of bridge $b_j$ to $r_j$.\n\n2. Count how many different islands a car of weight $w_j$ can reach starting from island $s_j$.\n\nPlease answer all queries of the second type.", "inputFormat": "The first line contains two integers $n$ and $m$, representing the number of islands and the number of bridges in Saint Petersburg.\n\nThe next $m$ lines each contain three integers $u_i, v_i, d_i$. Line $i$ describes a bridge connecting islands $u_i$ and $v_i$, with an initial weight limit of $d_i$.\n\nThe next line contains one integer $q$, representing the number of operations.\n\nThe next $q$ lines describe the operations in order, one per line.\n\nThe first integer on each line is $t_j$, indicating the operation type:\n\n- If $t_j = 1$, this is the first type of operation. The line then contains two integers $b_j$ and $r_j$, meaning the weight limit of bridge $b_j$ will become $r_j$.\n\n- If $t_j = 2$, this is the second type of operation. The line then contains two integers $s_j$ and $w_j$, meaning a car of weight $w_j$ will start from island $s_j$.", "outputFormat": "For each query of the second type, output one line with one integer representing the answer.", "hint": "For all testdata, $1 \\leq n \\leq 5 \\times 10^4$, $0 \\leq m \\leq 10^5$, $1 \\leq q \\leq 10^5$. It is guaranteed that $1 \\leq u_i, v_i, s_j \\leq n$, $u_i \\neq v_i$, $1 \\leq d_i, r_j, w_j \\leq 10^9$, $1 \\leq b_j \\leq m$, and $t_j \\in \\{1, 2\\}$.\n\nThe detailed additional constraints and scores for the subtasks are shown in the table below.\n\n| Subtask | Additional Constraints | Score |\n| :----------: | :----------: | :----------: |\n| 1 | $n, m \\leq 10^3$, $q \\leq 10^4$ | 13 |\n| 2 | The islands and bridges form a tree; $m = n - 1$, $u_i = i$, $v_i = i + 1$ ($1 \\leq i \\leq m$) | 16 |\n| 3 | The islands and bridges form a complete binary tree; $n = 2^k - 1$, $m = n - 1$, $u_i = \\frac{i+1}{2}$, $v_i = i + 1$ ($1 \\leq k \\leq 15$, $1 \\leq i \\leq m$) | 17 |\n| 4 | All $t_i$ are $2$ | 14 |\n| 5 | The islands and bridges form a tree | 13 |\n| 6 | No special constraints | 27 |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[APIO2019] 桥梁", "background": "圣彼得堡市内所有水路长度总和约 $282$ 千米，市内水域面积占城市面积的 $7\\%$。——来自维基百科", "description": "圣彼得堡位于由 $m$ 座桥梁连接而成的 $n$ 个岛屿上。岛屿用 $1$ 到 $n$ 的整数编号，桥梁用 $1$ 到 $m$ 的整数编号。每座桥连接两个不同的岛屿。有些桥梁是在彼得大帝时代建造的，其中一些是近期建造的。这导致了不同的桥梁可能有不同的重量限制。更具体地，只有重量不超过 $d_i$ 的汽车才能通过第 $i$ 座桥梁。有时圣彼得堡的一些桥梁会进行翻新，但这并不一定会使桥梁承重变得更好，也就是说，进行翻新的桥梁的 $d_i$ 可能会增加或减少。你准备开发一个产品，用于帮助公民和城市客人。目前，你开发的模块要能执行两种类型的操作：\n\n1. 将桥梁 $b_j$ 的重量限制改为 $r_j$。\n\n2. 统计一辆重为 $w_j$ 的汽车从岛屿 $s_j$ 出发能够到达多少个不同的岛屿。\n\n请你回答所有第二种操作的答案。\n\n", "inputFormat": "第一行包含两个整数 $n$ 和 $m$—— 表示圣彼得堡的岛屿数量与桥梁数量。\n\n接下来 $m$ 行，每行三个整数 $u_i,v_i,d_i$。第 $i$ 行的整数描述了一座连接岛屿 $u_i$ 和 $v_i$，初始时重量限制为 $d_i$ 的桥梁。\n\n接下来一行一个整数 $q$—— 表示操作的数量。\n\n接下来 $q$ 行按顺序每行描述一个操作。\n\n每行第一个整数 $t_j$ 表示操作类型：\n\n- 若 $t_j=1$，则该操作是第一种类型，该行接下来给定两个整数 $b_j$ 和 $r_j$，表示桥梁 $b_j$ 的重量限制将变为 $r_j$。\n\n- 若 $t_j=2$，则该操作是第二种类型，该行接下来给定两个整数 $s_j$ 和 $w_j$，表示一辆重为 $w_j$ 的汽车将要从第 $s_j$ 个岛屿出发。", "outputFormat": "对于每个第二种类型的询问，输出一行一个整数表示答案。", "hint": "对于全部数据，$1 \\leq n \\leq 5\\times 10^4$，$0 \\leq m \\leq 10^5$，$1 \\leq q \\leq 10^5$。保证 $1 \\leq u_i$，$v_i$, $s_j \\leq n$，$u_i \\neq v_i$，$1 \\leq d_i$, $r_j$, $w_j \\leq 10^9$，$1 \\leq b_j \\leq m$，$t_j \\in {1,2}$。\n\n详细子任务附加限制与分值如下表\n\n| 子任务 | 附加限制 | 分值 |\n| :----------: | :----------: | :----------: |\n| 1 | $n$, $m\\leq 10^3$，$q\\leq 10^4$ | 13 |\n| 2 | 岛屿和桥梁将形成一个树结构；$m=n-1$，$u_i=i$，$v_i=i+1$；（$1\\leq i\\leq m$） | 16 |\n| 3 | 岛屿和桥梁将形成一个完全二叉树结构；$n=2^k-1$，$m=n-1$，$u_i=\\frac{i+1}{2}$，$v_i=i+1$；（$1\\leq k\\leq 15$，$1\\leq i\\leq m$） | 17 |\n| 4 | 所有 $t_i$ 均为 $2$ | 14 |\n| 5 | 岛屿和桥梁将形成一个树结构 | 13 |\n| 6 | 无特殊限制 | 27 |", "locale": "zh-CN"}}}
{"pid": "P5444", "type": "P", "difficulty": 6, "samples": [["3 3 3\n4 4\n7 9\n17 18", "4"], ["3 5 10\n1 20\n50 68\n89 98", "31"], ["2 16 13\n2 5\n18 18", "5"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2019", "APIO"], "title": "[APIO2019] 奇怪装置", "background": "", "description": "考古学家发现古代文明留下了一种奇怪的装置。该装置包含两个屏幕，分别显示两个整数 $x$ 和 $y$ 。\n\n经过研究，科学家对该装置得出了一个结论：该装置是一个特殊的时钟，它从过去的某个时间点开始测量经过的时刻数 $t$，但该装置的创造者却将 $t$ 用奇怪的方式显示出来。若从该装置开始测量到现在所经过的时刻数为 $t$，装置会显示两个整数：$x = ((t + \\lfloor \\frac {t}{B} \\rfloor) \\bmod A)$，与 $y=(t \\bmod B)$。这里 $\\lfloor x \\rfloor$ 是下取整函数，表示小于或等于 $x$ 的最大整数。\n\n考古学家通过进一步研究还发现，该装置的屏幕无法一直工作。实际上，该装置的屏幕只在 $n$ 个连续的时间区间段中能正常工作。第 $i$ 个时间段从时刻 $l_i$ 到时刻 $r_i$。现在科学家想要知道有多少个不同的数对 $x,y$ 能够在该装置工作时被显示出来。\n\n两个数对 $(x_1,y_1)$ 和 $(x_2,y_2)$ 不同当且仅当 $x_1 \\neq x_2$ 或 $y_1 \\neq y_2$。\n", "inputFormat": "第一行包含三个整数 $n$，$A$ 与 $B$。\n接下来 $n$ 行每行两个整数 $l_i$，$r_i$ 表示装置可以工作的第 $i$ 个时间区间。", "outputFormat": "输出一行一个整数表示问题的答案。", "hint": "对于第一个样例，装置屏幕将显示如下这些数对。\n\n$t=4:(2,1)$\n\n$t=7:(0,1)$\n\n$t=8:(1,2)$\n\n$t=9:(0,0)$\n\n$t=17:(1,2)$\n\n$t=18:(0,0)$\n\n共有四个不同的数对：$(0,0),(0,1),(1,2),(2,1)$\n\n对于全部数据，$1 \\leq n \\leq 10^6,1 \\leq A,B \\leq 10^{18},0 \\leq l_i \\leq r_i \\leq 10^{18}$\n\n令 $S=\\sum_{i=1}^n (r_i-l_i+1)$ 与 $L=\\max_{i=1}^n (r_i-l_i+1)$\n\n详细子任务附加限制与分值如下表：\n\n| 子任务 | 附加限制 | 分值 |\n| :-----------: | :----------- | :-----------: |\n| 1 | $S\\leq 10^6$ | 10 |\n| 2 | $n=1$ | 5 |\n| 3 | $A\\times B \\leq 10^6$ | 5 |\n| 4 | $B=1$ | 5 |\n| 5 | $B\\leq 3$ | 5 |\n| 6 | $B\\leq 10^6$ | 20 |\n| 7 | $L\\leq B$ | 20 |\n| 8 | 无附加限制 | 30 |\n", "locale": "zh-CN", "translations": {"en": {"title": "[APIO2019] Strange Device", "background": "", "description": "Archaeologists have discovered a strange device left behind by an ancient civilization. The device has two screens, which display two integers $x$ and $y$.\n\nAfter research, scientists reached the following conclusion: the device is a special clock. It starts counting the number of moments $t$ that have passed since some point in the past, but the creator displays $t$ in a strange way. If the number of moments that have passed since the device started measuring is $t$, then it displays two integers:\n$x = ((t + \\lfloor \\frac {t}{B} \\rfloor) \\bmod A)$, and $y = (t \\bmod B)$.\nHere $\\lfloor x \\rfloor$ is the floor function, which means the greatest integer less than or equal to $x$.\n\nArchaeologists further found that the screens cannot work all the time. In fact, the screens work normally only during $n$ continuous time intervals. The $i$-th interval is from moment $l_i$ to moment $r_i$. Now scientists want to know how many different pairs $x,y$ can be displayed while the device is working.\n\nTwo pairs $(x_1,y_1)$ and $(x_2,y_2)$ are different if and only if $x_1 \\neq x_2$ or $y_1 \\neq y_2$.", "inputFormat": "The first line contains three integers $n$, $A$, and $B$.\nThe next $n$ lines each contain two integers $l_i$ and $r_i$, representing the $i$-th time interval during which the device can work.", "outputFormat": "Output one line containing one integer, the answer to the problem.", "hint": "For the first sample, the device screens will display the following pairs.\n\n$t=4:(2,1)$\n\n$t=7:(0,1)$\n\n$t=8:(1,2)$\n\n$t=9:(0,0)$\n\n$t=17:(1,2)$\n\n$t=18:(0,0)$\n\nThere are four different pairs in total: $(0,0),(0,1),(1,2),(2,1)$.\n\nFor all data, $1 \\leq n \\leq 10^6,1 \\leq A,B \\leq 10^{18},0 \\leq l_i \\leq r_i \\leq 10^{18}$.\n\nLet $S=\\sum_{i=1}^n (r_i-l_i+1)$ and $L=\\max_{i=1}^n (r_i-l_i+1)$.\n\nThe detailed additional constraints and scores for subtasks are shown in the table below:\n\n| Subtask | Additional Constraints | Score |\n| :-----------: | :----------- | :-----------: |\n| 1 | $S\\leq 10^6$ | 10 |\n| 2 | $n=1$ | 5 |\n| 3 | $A\\times B \\leq 10^6$ | 5 |\n| 4 | $B=1$ | 5 |\n| 5 | $B\\leq 3$ | 5 |\n| 6 | $B\\leq 10^6$ | 20 |\n| 7 | $L\\leq B$ | 20 |\n| 8 | No additional constraints. | 30 |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[APIO2019] 奇怪装置", "background": "", "description": "考古学家发现古代文明留下了一种奇怪的装置。该装置包含两个屏幕，分别显示两个整数 $x$ 和 $y$ 。\n\n经过研究，科学家对该装置得出了一个结论：该装置是一个特殊的时钟，它从过去的某个时间点开始测量经过的时刻数 $t$，但该装置的创造者却将 $t$ 用奇怪的方式显示出来。若从该装置开始测量到现在所经过的时刻数为 $t$，装置会显示两个整数：$x = ((t + \\lfloor \\frac {t}{B} \\rfloor) \\bmod A)$，与 $y=(t \\bmod B)$。这里 $\\lfloor x \\rfloor$ 是下取整函数，表示小于或等于 $x$ 的最大整数。\n\n考古学家通过进一步研究还发现，该装置的屏幕无法一直工作。实际上，该装置的屏幕只在 $n$ 个连续的时间区间段中能正常工作。第 $i$ 个时间段从时刻 $l_i$ 到时刻 $r_i$。现在科学家想要知道有多少个不同的数对 $x,y$ 能够在该装置工作时被显示出来。\n\n两个数对 $(x_1,y_1)$ 和 $(x_2,y_2)$ 不同当且仅当 $x_1 \\neq x_2$ 或 $y_1 \\neq y_2$。\n", "inputFormat": "第一行包含三个整数 $n$，$A$ 与 $B$。\n接下来 $n$ 行每行两个整数 $l_i$，$r_i$ 表示装置可以工作的第 $i$ 个时间区间。", "outputFormat": "输出一行一个整数表示问题的答案。", "hint": "对于第一个样例，装置屏幕将显示如下这些数对。\n\n$t=4:(2,1)$\n\n$t=7:(0,1)$\n\n$t=8:(1,2)$\n\n$t=9:(0,0)$\n\n$t=17:(1,2)$\n\n$t=18:(0,0)$\n\n共有四个不同的数对：$(0,0),(0,1),(1,2),(2,1)$\n\n对于全部数据，$1 \\leq n \\leq 10^6,1 \\leq A,B \\leq 10^{18},0 \\leq l_i \\leq r_i \\leq 10^{18}$\n\n令 $S=\\sum_{i=1}^n (r_i-l_i+1)$ 与 $L=\\max_{i=1}^n (r_i-l_i+1)$\n\n详细子任务附加限制与分值如下表：\n\n| 子任务 | 附加限制 | 分值 |\n| :-----------: | :----------- | :-----------: |\n| 1 | $S\\leq 10^6$ | 10 |\n| 2 | $n=1$ | 5 |\n| 3 | $A\\times B \\leq 10^6$ | 5 |\n| 4 | $B=1$ | 5 |\n| 5 | $B\\leq 3$ | 5 |\n| 6 | $B\\leq 10^6$ | 20 |\n| 7 | $L\\leq B$ | 20 |\n| 8 | 无附加限制 | 30 |\n", "locale": "zh-CN"}}}
{"pid": "P5445", "type": "P", "difficulty": 6, "samples": [["5 7\n11011\nquery 1 2\nquery 1 2\nquery 1 6\nquery 3 4\ntoggle 3\nquery 3 4\nquery 1 6", "1\n2\n0\n0\n1\n2"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2019", "APIO"], "title": "[APIO2019] 路灯", "background": "", "description": "一辆自动驾驶的出租车正在 Innopolis 的街道上行驶。该街道上有 $n+1$ 个停车站点，它们将街道划分成了 $n$ 条路段。每一路段都拥有一个路灯。当第 $i$ 个路灯亮起，它将照亮连接第 $i$ 与第 $i+1$ 个站点的路段。否则这条路段将是黑暗的。\n\n安全起见，出租车只能在被照亮的路段上行驶。换言之，出租车能从站点 $a$ 出发到达站点 $b (a<b)$ 的条件是：连接站点 $a$ 与 $a+1$，$a + 1$ 与 $a+2$，……，$b-1$ 与 $b$ 的路段都被照亮。\n\n在经过一些意外故障或修理之后，街道上的路灯可能是亮起的，也可能是熄灭的。\n\n现在给定 $0$ 时刻时，街道上路灯的初始状态。之后 $1,2,\\ldots,q$ 时刻，每时刻会发生下列两种事件之一：\n\n- $\\text{toggle} \\ i$：切换第 $i$ 个路灯的状态。具体地说，若路灯原来亮起，则现在将熄灭；若路灯原来熄灭，则现在将亮起。\n\n- $\\text{query}  \\  a  \\  b$：出租车部门的负责人想知道，从 $0$ 时刻起到当前时刻，有多少个时刻满足：出租车能够从站点 $a$ 出发到达站点 $b$。\n\n请你帮助出租车部门的负责人回答他们的问题。", "inputFormat": "第一行包含两个整数 $n$ 和 $q$，表示路灯的数量与时刻数。\n\n第二行包含一个字符串 $s$ 表示路灯的初始状态，$s_i$ 为 $1$ 表示第 $i$ 个路灯初始时亮起；$s_i$ 为 $0$ 表示第 $i$ 个路灯初始时熄灭。\n\n接下来 $q$ 行每行描述一个时刻的事件。第 $i$ 行描述时刻 $i$ 所发生的事件：\n\n- $\\text{toggle} \\ i$：该时刻切换了第 $i$ 个路灯的状态。\n\n- $\\text{query} \\ a \\ b$：计算从 $0$ 时刻起到该时刻，共有多少个时刻满足：出租车能从站点 $a$ 出发到达站点 $b$。\n\n至少有一个时刻的事件是 $\\text{query}$。", "outputFormat": "对于每个 $\\text{query}$ 的事件，输出一行单个整数，表示该问题的答案。", "hint": "对于全部数据，$1 \\leq n,q \\leq 3\\times 10^5$，$|s|=n$，$1 \\leq i \\leq n$，$1 \\leq a < b \\leq n+1$。\n\n详细子任务附加限制与分值如下表\n\n| 子任务 | 附加限制 | 分值 |\n| :----------: | :----------: | :----------: |\n| 1 | $n$, $q\\leq 100$ | 20 |\n| 2 | 对于所有 $\\text{query}\\ a\\ b$ 事件，满足 $a=b-1$ | 20 |\n| 3 | 对于所有 $\\text{toggle}\\ i$ 事件，第 $i$ 个路灯将被点亮 | 20 |\n| 4 | 所有 $\\text{toggle}$ 事件都发生在第一个 $\\text{query}$ 事件之前 | 20 |\n| 5 | 无特殊限制 | 20 |", "locale": "zh-CN", "translations": {"en": {"title": "[APIO2019] Street Lamps", "background": "", "description": "A self-driving taxi is driving along a street in Innopolis. There are $n+1$ stops on the street, which divide the street into $n$ road segments. Each segment has a street lamp. When the $i$-th lamp is on, it lights up the segment connecting stops $i$ and $i+1$. Otherwise, this segment is dark.\n\nFor safety reasons, the taxi can only drive on lit segments. In other words, the taxi can travel from stop $a$ to stop $b$ $(a<b)$ if and only if the segments connecting stops $a$ and $a+1$, $a+1$ and $a+2$, $\\ldots$, $b-1$ and $b$ are all lit.\n\nAfter some unexpected failures or repairs, the street lamps on the street may be on or off.\n\nYou are given the initial states of the street lamps at time $0$. Then at times $1,2,\\ldots,q$, one of the following two events happens at each time:\n\n- $\\text{toggle}\\ i$: Toggle the state of the $i$-th street lamp. Specifically, if it was on, it becomes off; if it was off, it becomes on.\n\n- $\\text{query}\\ a\\ b$: The head of the taxi department wants to know: from time $0$ up to the current time, how many times satisfy that the taxi can travel from stop $a$ to stop $b$.\n\nPlease help answer these queries for the head of the taxi department.", "inputFormat": "The first line contains two integers $n$ and $q$, representing the number of street lamps and the number of time moments.\n\nThe second line contains a string $s$ representing the initial states of the street lamps. $s_i=1$ means the $i$-th lamp is initially on, and $s_i=0$ means the $i$-th lamp is initially off.\n\nThe next $q$ lines each describe the event at a time moment. The $i$-th of these lines describes the event that happens at time $i$:\n\n- $\\text{toggle}\\ i$: At this time moment, the state of the $i$-th street lamp is toggled.\n\n- $\\text{query}\\ a\\ b$: Compute, from time $0$ up to this time moment, how many time moments satisfy that the taxi can travel from stop $a$ to stop $b$.\n\nAt least one event is $\\text{query}$.", "outputFormat": "For each $\\text{query}$ event, output a single integer on its own line, which is the answer to that query.", "hint": "For all data, $1 \\leq n,q \\leq 3\\times 10^5$, $|s|=n$, $1 \\leq i \\leq n$, $1 \\leq a < b \\leq n+1$.\n\nThe detailed additional constraints and scores for subtasks are as follows.\n\n| Subtask | Additional Constraints | Score |\n| :----------: | :----------: | :----------: |\n| 1 | $n$, $q \\leq 100$ | 20 |\n| 2 | For all $\\text{query}\\ a\\ b$ events, $a=b-1$ holds | 20 |\n| 3 | For all $\\text{toggle}\\ i$ events, the $i$-th lamp will be turned on | 20 |\n| 4 | All $\\text{toggle}$ events happen before the first $\\text{query}$ event | 20 |\n| 5 | No additional constraints | 20 |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[APIO2019] 路灯", "background": "", "description": "一辆自动驾驶的出租车正在 Innopolis 的街道上行驶。该街道上有 $n+1$ 个停车站点，它们将街道划分成了 $n$ 条路段。每一路段都拥有一个路灯。当第 $i$ 个路灯亮起，它将照亮连接第 $i$ 与第 $i+1$ 个站点的路段。否则这条路段将是黑暗的。\n\n安全起见，出租车只能在被照亮的路段上行驶。换言之，出租车能从站点 $a$ 出发到达站点 $b (a<b)$ 的条件是：连接站点 $a$ 与 $a+1$，$a + 1$ 与 $a+2$，……，$b-1$ 与 $b$ 的路段都被照亮。\n\n在经过一些意外故障或修理之后，街道上的路灯可能是亮起的，也可能是熄灭的。\n\n现在给定 $0$ 时刻时，街道上路灯的初始状态。之后 $1,2,\\ldots,q$ 时刻，每时刻会发生下列两种事件之一：\n\n- $\\text{toggle} \\ i$：切换第 $i$ 个路灯的状态。具体地说，若路灯原来亮起，则现在将熄灭；若路灯原来熄灭，则现在将亮起。\n\n- $\\text{query}  \\  a  \\  b$：出租车部门的负责人想知道，从 $0$ 时刻起到当前时刻，有多少个时刻满足：出租车能够从站点 $a$ 出发到达站点 $b$。\n\n请你帮助出租车部门的负责人回答他们的问题。", "inputFormat": "第一行包含两个整数 $n$ 和 $q$，表示路灯的数量与时刻数。\n\n第二行包含一个字符串 $s$ 表示路灯的初始状态，$s_i$ 为 $1$ 表示第 $i$ 个路灯初始时亮起；$s_i$ 为 $0$ 表示第 $i$ 个路灯初始时熄灭。\n\n接下来 $q$ 行每行描述一个时刻的事件。第 $i$ 行描述时刻 $i$ 所发生的事件：\n\n- $\\text{toggle} \\ i$：该时刻切换了第 $i$ 个路灯的状态。\n\n- $\\text{query} \\ a \\ b$：计算从 $0$ 时刻起到该时刻，共有多少个时刻满足：出租车能从站点 $a$ 出发到达站点 $b$。\n\n至少有一个时刻的事件是 $\\text{query}$。", "outputFormat": "对于每个 $\\text{query}$ 的事件，输出一行单个整数，表示该问题的答案。", "hint": "对于全部数据，$1 \\leq n,q \\leq 3\\times 10^5$，$|s|=n$，$1 \\leq i \\leq n$，$1 \\leq a < b \\leq n+1$。\n\n详细子任务附加限制与分值如下表\n\n| 子任务 | 附加限制 | 分值 |\n| :----------: | :----------: | :----------: |\n| 1 | $n$, $q\\leq 100$ | 20 |\n| 2 | 对于所有 $\\text{query}\\ a\\ b$ 事件，满足 $a=b-1$ | 20 |\n| 3 | 对于所有 $\\text{toggle}\\ i$ 事件，第 $i$ 个路灯将被点亮 | 20 |\n| 4 | 所有 $\\text{toggle}$ 事件都发生在第一个 $\\text{query}$ 事件之前 | 20 |\n| 5 | 无特殊限制 | 20 |", "locale": "zh-CN"}}}
{"pid": "P5446", "type": "P", "difficulty": 5, "samples": [["4\nabcdcb\nqwqwq\nqaqaqqq\ncarnation", "4 6\n2 3 4 5\n6 7\n9"]], "limits": {"time": [2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000]}, "tags": ["2018", "Manacher 算法", "THUPC"], "title": "[THUPC 2018] 绿绿和串串", "background": "绿绿和 Yazid 是好朋友。他们在一起做串串游戏。", "description": "绿绿有一个由小写字母组成的非空字符串 $R$，但 Yazid 不知道它具体是什么。\n\n我们定义**翻转**的操作：把一个串以最后一个字符作对称轴进行翻转复制。形式化地描述就是，如果他翻转的串为 $R$，那么他会将前 $\\left| R\\right|-1$ 个字符倒序排列后，插入到串的最后。\n\n举例而言，串`abcd`进行翻转操作后，将得到`abcdcba`；串`qw`连续进行 **$2$ 次**翻转操作后，将得到`qwqwq`；串`z`无论进行多少次翻转操作，都不会被改变。\n\n贪玩的绿绿进行了若干次（可能为 $0$ 次）翻转操作。\n\n淘气的绿绿又展示出了一个非空串 $S$，并表示 $S$ 是**最终**的串 $R$ 的前缀。现在，他想考考 Yazid，**初始**的串 $R$ 的长度可能是多少。\n\nYazid 找到了正在参加清华校赛的你，请你来帮他解决这个问题。但聪明的 Yazid 发现，所有超过 $\\left| S\\right|$ 的整数都一定是 $R$ 的可能长度，因此你只需要告诉他不超过的 $\\left| S\\right|$ 的 $R$ 的可能长度即可。\n\n为了帮助你理解问题，Yazid 还将对一些概念和记号做出解释：\n\n- 对于一个串 $S$，$\\left| S\\right|$ 表示的是该串的长度。\n- 对于一个串 $S$，我们定义串 $T$ 是它的前缀，当且仅当 $\\left| T\\right|\\leq\\left| S\\right|$，且对于任意整数 $i$ 满足 $1\\leq i\\leq\\left| T\\right|$，都有 $T$ 的左起第 $i$ 个字符与 $S$ 的左起第 $i$ 个字符相同。（形象地理解，即 $T$ 在 $S$ 的前部出现）\n  - 如：`abc`是`abcdefg`的前缀，`aba`**不**为`abba`的前缀，`z`为`z`的前缀，空串为任意一个串的前缀。", "inputFormat": "输入包含多组数据，第一行一个整数 $T$ 表示数据组数。接下来依次描述每组数据，对于每组数据：\n\n* 一行一个仅由小写字母组成的非空字符串 $S$。\n", "outputFormat": "对于每组数据，输出 $1$ 行：\n\n* 从小到大输出 $\\left| R\\right|$ 的所有不超过 $\\left| S\\right|$ 的可能值，所有值之间用单个空格隔开。", "hint": "### 数据范围\n\n保证 $\\left| S\\right|\\leq 10^6$，$\\sum\\left| S\\right|\\leq 5\\times 10^6$。\n\n$\\sum\\left| S\\right|$ 表示的是单个测试点中所有数据 $\\left| S\\right|$ 的总和。\n\n### 提示\n\n* 读入规模较大，请注意读入效率。\n\n* 样例中的最后一个字符串是什么意思呢？\n\n### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2018] Lvlvl and Skewers", "background": "Lvlvl and Yazid are good friends. They play a skewer game together.", "description": "Lvlvl has a non-empty string $R$ consisting of lowercase letters, but Yazid does not know what it is.\n\nWe define the **flip** operation: flip-copy a string using its last character as the axis of symmetry. Formally, if the string to be flipped is $R$, then take the first $\\left| R\\right|-1$ characters, reverse them, and append them to the end of the string.\n\nFor example, after applying the flip operation to `abcd`, we get `abcdcba`; if we apply the flip operation **$2$ times** in a row to `qw`, we get `qwqwq`; for `z`, no matter how many times we apply the flip operation, it will not change.\n\nThe playful Lvlvl performed the flip operation several times (possibly $0$ times).\n\nThen the naughty Lvlvl showed a non-empty string $S$, and said that $S$ is a prefix of the **final** string $R$. Now he wants to test Yazid: what lengths could the **initial** string $R$ have?\n\nYazid asked you, who are participating in the Tsinghua campus contest, to help solve this problem. But the clever Yazid noticed that every integer greater than $\\left| S\\right|$ must be a possible length of $R$, so you only need to tell him the possible lengths of $R$ that do not exceed $\\left| S\\right|$.\n\nTo help you understand the problem, Yazid also explains some concepts and notation:\n\n- For a string $S$, $\\left| S\\right|$ denotes its length.\n- For a string $S$, we say that a string $T$ is its prefix if and only if $\\left| T\\right|\\leq\\left| S\\right|$, and for every integer $i$ with $1\\leq i\\leq\\left| T\\right|$, the $i$-th character of $T$ from the left is the same as the $i$-th character of $S$ from the left. (Intuitively, $T$ appears at the beginning of $S$.)\n  - For example: `abc` is a prefix of `abcdefg`; `aba` is **not** a prefix of `abba`; `z` is a prefix of `z`; the empty string is a prefix of any string.", "inputFormat": "The input contains multiple test cases. The first line contains an integer $T$ indicating the number of test cases. Each test case is described as follows:\n\n- One line contains a non-empty string $S$ consisting only of lowercase letters.", "outputFormat": "For each test case, output one line:\n\n- Output all possible values of $\\left| R\\right|$ that do not exceed $\\left| S\\right|$, in increasing order, separated by a single space.", "hint": "### Constraints\n\nIt is guaranteed that $\\left| S\\right|\\leq 10^6$ and $\\sum\\left| S\\right|\\leq 5\\times 10^6$.\n\n$\\sum\\left| S\\right|$ denotes the total length $\\left| S\\right|$ of all test cases in a single test point.\n\n### Notes\n\n- The input size is large, so please pay attention to input efficiency.\n- What does the last string in the sample mean?\n\n### Copyright Information\n\nFrom the 2018 Tsinghua University Programming Contest and Collegiate Invitational (THUPC2018). Thanks to [Pony.ai](http://pony.ai/) for supporting this contest.\n\nResources such as the editorial can be found at <https://github.com/wangyurzee7/THUPC2018>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2018] 绿绿和串串", "background": "绿绿和 Yazid 是好朋友。他们在一起做串串游戏。", "description": "绿绿有一个由小写字母组成的非空字符串 $R$，但 Yazid 不知道它具体是什么。\n\n我们定义**翻转**的操作：把一个串以最后一个字符作对称轴进行翻转复制。形式化地描述就是，如果他翻转的串为 $R$，那么他会将前 $\\left| R\\right|-1$ 个字符倒序排列后，插入到串的最后。\n\n举例而言，串`abcd`进行翻转操作后，将得到`abcdcba`；串`qw`连续进行 **$2$ 次**翻转操作后，将得到`qwqwq`；串`z`无论进行多少次翻转操作，都不会被改变。\n\n贪玩的绿绿进行了若干次（可能为 $0$ 次）翻转操作。\n\n淘气的绿绿又展示出了一个非空串 $S$，并表示 $S$ 是**最终**的串 $R$ 的前缀。现在，他想考考 Yazid，**初始**的串 $R$ 的长度可能是多少。\n\nYazid 找到了正在参加清华校赛的你，请你来帮他解决这个问题。但聪明的 Yazid 发现，所有超过 $\\left| S\\right|$ 的整数都一定是 $R$ 的可能长度，因此你只需要告诉他不超过的 $\\left| S\\right|$ 的 $R$ 的可能长度即可。\n\n为了帮助你理解问题，Yazid 还将对一些概念和记号做出解释：\n\n- 对于一个串 $S$，$\\left| S\\right|$ 表示的是该串的长度。\n- 对于一个串 $S$，我们定义串 $T$ 是它的前缀，当且仅当 $\\left| T\\right|\\leq\\left| S\\right|$，且对于任意整数 $i$ 满足 $1\\leq i\\leq\\left| T\\right|$，都有 $T$ 的左起第 $i$ 个字符与 $S$ 的左起第 $i$ 个字符相同。（形象地理解，即 $T$ 在 $S$ 的前部出现）\n  - 如：`abc`是`abcdefg`的前缀，`aba`**不**为`abba`的前缀，`z`为`z`的前缀，空串为任意一个串的前缀。", "inputFormat": "输入包含多组数据，第一行一个整数 $T$ 表示数据组数。接下来依次描述每组数据，对于每组数据：\n\n* 一行一个仅由小写字母组成的非空字符串 $S$。\n", "outputFormat": "对于每组数据，输出 $1$ 行：\n\n* 从小到大输出 $\\left| R\\right|$ 的所有不超过 $\\left| S\\right|$ 的可能值，所有值之间用单个空格隔开。", "hint": "### 数据范围\n\n保证 $\\left| S\\right|\\leq 10^6$，$\\sum\\left| S\\right|\\leq 5\\times 10^6$。\n\n$\\sum\\left| S\\right|$ 表示的是单个测试点中所有数据 $\\left| S\\right|$ 的总和。\n\n### 提示\n\n* 读入规模较大，请注意读入效率。\n\n* 样例中的最后一个字符串是什么意思呢？\n\n### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN"}}}
{"pid": "P5447", "type": "P", "difficulty": 7, "samples": [["5 6 5\n000000\n001001\n000100\n001000\n000001\ndwdaa", "4"]], "limits": {"time": [12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000], "memory": [2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000, 2048000]}, "tags": ["2018", "THUPC"], "title": "[THUPC 2018] 赛艇", "background": "", "description": "Lavender、Caryophyllus、Jasmine、Dianthus现在在玩一款名叫“赛艇”的游戏。\n\n这个游戏的规则是这样的：\n\n1. 玩家自由组成两队，一个人当赛艇的艇长，另一个人当侦察兵；\n2. 每次游戏开始时，双方均拥有由系统生成的某张地图，该地图以01矩阵的形式表示，`1`表示有障碍物，无法通行，`0`表示水域空旷，可以通行；\n3. 第一回合，双方的赛艇艇长都要在地图上指定一个出发点，该出发点不能是障碍物，也就是只能为`0`；\n4. 在每个回合中，艇长可以指挥自己的赛艇向上/下/左/右四个方向的某一方向的空旷水域移动一个单位的距离，也就是说只能移向四个方向上的某个`0`上（当然，不能移动出地图之外）；在该操作完成之后，**必须向对方说出自己在该回合移动的方向**；\n5. 双方的侦察兵负责记录每一回合对方赛艇的移动方向，并负责推断此时对方赛艇可能的位置；如果某方的侦察兵推测出对方赛艇此时的精确位置，那么可以向其发射导弹，该侦察兵所在的一方胜利；\n\n现在，Jasmine记录了一些对方赛艇的路径，她想确定一下此时对方所有可能的位置共有几种。由于她不是很擅长计算，所以这个任务就交给你了。", "inputFormat": "输入第一行包含三个正整数 $n$，$m$，$k$，分别表示地图为 $n$ 行 $m$ 列，当前游戏已经进行了 $k$ 轮。保证 $2\\le n,m \\le 1500$，$1\\le k\\le 5\\times 10^6$。\n\n输入第二行到第 $n+1$ 行为一个 $n$ 行 $m$ 列的 01 矩阵，无任何分隔符号，表示地图的具体信息，具体含义如上所示。\n\n输入的最后一行为一个长度为 $k$ 的字符串 $s$，仅由字母 `w`、`a`、`s`、`d` 构成，从前往后第 $i$ 个字符 $s_i$ 表示对方在第 $i$ 轮中，对方赛艇向上/左/下/右移动一个单位距离。", "outputFormat": "输出一行一个正整数，表示在第 $k$ 轮游戏回合的时候，对方赛艇可能的位置的种数。对于所有输入数据，**保证有合法解**。", "hint": "### 样例解释\n\n![](https://i.loli.net/2018/05/14/5af98ebcd79df.png)\n\n上图显示了路径序列可视化之后的结果，下图用蓝色标出了此时对方赛艇可能的位置。\n\n![](https://i.loli.net/2018/05/14/5af98ed39a602.png)\n\n### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2018] Rowing", "background": "", "description": "Lavender, Caryophyllus, Jasmine, and Dianthus are now playing a game called \"Rowing\".\n\nThe rules of this game are as follows:\n\n1. Players freely form two teams. One person acts as the boat captain, and the other acts as the scout.\n2. At the start of each game, both sides are given a map generated by the system. The map is represented as a 0-1 matrix: `1` means there is an obstacle and it is impassable, while `0` means open water and it is passable.\n3. In the first round, both captains must choose a starting point on the map. This point cannot be an obstacle, so it must be `0`.\n4. In each round, the captain may command their boat to move by one unit to an adjacent open-water cell in one of the four directions: up/down/left/right. That is, the boat may only move onto a `0` in one of the four directions (and of course, it cannot move outside the map). After this operation is completed, they **must tell the opponent the direction they moved in that round**.\n5. The scouts on both sides are responsible for recording the opponent boat’s movement direction in each round, and for inferring the opponent boat’s possible position at that moment. If a scout can infer the opponent boat’s exact position at that moment, they may fire a missile at it, and the scout’s side wins.\n\nNow, Jasmine has recorded some movement directions of the opponent boat. She wants to determine how many possible positions the opponent boat may be at this moment. Since she is not good at calculations, she hands this task to you.", "inputFormat": "The first line contains three positive integers $n$, $m$, $k$, indicating that the map has $n$ rows and $m$ columns, and the game has currently proceeded for $k$ rounds. It is guaranteed that $2\\le n,m \\le 1500$, $1\\le k\\le 5\\times 10^6$.\n\nLines 2 to $n+1$ contain an $n$ by $m$ 0-1 matrix with no separators, describing the map information. The meaning is as described above.\n\nThe last line of the input is a string $s$ of length $k$, consisting only of the letters `w`, `a`, `s`, `d`. From left to right, the $i$-th character $s_i$ indicates that in round $i$, the opponent boat moved one unit up/left/down/right.", "outputFormat": "Output one line containing one positive integer, indicating the number of possible positions of the opponent boat in round $k$. For all input data, it is **guaranteed that a valid solution exists**.", "hint": "### Sample Explanation\n\n![](https://i.loli.net/2018/05/14/5af98ebcd79df.png)\n\nThe figure above shows the result after visualizing the path sequence. The figure below marks in blue the possible positions of the opponent boat at this moment.\n\n![](https://i.loli.net/2018/05/14/5af98ed39a602.png)\n\n### Copyright Information\n\nFrom the 2018 Tsinghua University Programming Contest and Collegiate Invitational Contest (THUPC2018). Thanks to [Pony.ai](http://pony.ai/) for supporting this contest.\n\nResources such as the editorial can be found at <https://github.com/wangyurzee7/THUPC2018>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2018] 赛艇", "background": "", "description": "Lavender、Caryophyllus、Jasmine、Dianthus现在在玩一款名叫“赛艇”的游戏。\n\n这个游戏的规则是这样的：\n\n1. 玩家自由组成两队，一个人当赛艇的艇长，另一个人当侦察兵；\n2. 每次游戏开始时，双方均拥有由系统生成的某张地图，该地图以01矩阵的形式表示，`1`表示有障碍物，无法通行，`0`表示水域空旷，可以通行；\n3. 第一回合，双方的赛艇艇长都要在地图上指定一个出发点，该出发点不能是障碍物，也就是只能为`0`；\n4. 在每个回合中，艇长可以指挥自己的赛艇向上/下/左/右四个方向的某一方向的空旷水域移动一个单位的距离，也就是说只能移向四个方向上的某个`0`上（当然，不能移动出地图之外）；在该操作完成之后，**必须向对方说出自己在该回合移动的方向**；\n5. 双方的侦察兵负责记录每一回合对方赛艇的移动方向，并负责推断此时对方赛艇可能的位置；如果某方的侦察兵推测出对方赛艇此时的精确位置，那么可以向其发射导弹，该侦察兵所在的一方胜利；\n\n现在，Jasmine记录了一些对方赛艇的路径，她想确定一下此时对方所有可能的位置共有几种。由于她不是很擅长计算，所以这个任务就交给你了。", "inputFormat": "输入第一行包含三个正整数 $n$，$m$，$k$，分别表示地图为 $n$ 行 $m$ 列，当前游戏已经进行了 $k$ 轮。保证 $2\\le n,m \\le 1500$，$1\\le k\\le 5\\times 10^6$。\n\n输入第二行到第 $n+1$ 行为一个 $n$ 行 $m$ 列的 01 矩阵，无任何分隔符号，表示地图的具体信息，具体含义如上所示。\n\n输入的最后一行为一个长度为 $k$ 的字符串 $s$，仅由字母 `w`、`a`、`s`、`d` 构成，从前往后第 $i$ 个字符 $s_i$ 表示对方在第 $i$ 轮中，对方赛艇向上/左/下/右移动一个单位距离。", "outputFormat": "输出一行一个正整数，表示在第 $k$ 轮游戏回合的时候，对方赛艇可能的位置的种数。对于所有输入数据，**保证有合法解**。", "hint": "### 样例解释\n\n![](https://i.loli.net/2018/05/14/5af98ebcd79df.png)\n\n上图显示了路径序列可视化之后的结果，下图用蓝色标出了此时对方赛艇可能的位置。\n\n![](https://i.loli.net/2018/05/14/5af98ed39a602.png)\n\n### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN"}}}
{"pid": "P5448", "type": "P", "difficulty": 7, "samples": [["2 233\n3\n4", "4\n10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "THUPC"], "title": "[THUPC 2018] 好图计数", "background": "这道题目非常简单，它甚至没有题目背景、没有任何故事。\n\n但为了能让你顺利理解题目，善良的 Yazid 将为你介绍一些概念。\n\n* 简单图：不存在重边、自环的图。（重边即为两条完全相同的边，自环即为两端点为同一节点的边）\n\n* 补图：一个图 $G$ 的补图有与 $G$ 完全相同的节点，且任意两点之间有边当且仅当他们在 $G$ 中不相邻。", "description": "我们归纳定义一个无向简单图是**好的**：\n\n1. 一个单点是好的。\n\n2. 若干个好的图分别作为联通块所形成的图是好的。\n\n3. 一个好的图的补图是好的。\n\n给定一个正整数 $n$。\n\n求 $n$ 个点的本质不同的好的图的数量对质数 $P$ 取模的结果。（这里的 $P$ 是一个常数，具体见【输入格式】）\n\n两个好的图的被认为是**本质不同的**，当且仅当无论如何将一个图重标号，它都不能与另一个图完全相同。", "inputFormat": "输入包含多组数据，第一行 $2$ 个用空格隔开的整数 $T,P$ 分别表示数据组数、以及模数。接下来依次描述每组数据，对于每组数据：\n\n* 一行一个整数 $n$，表示希望统计数目的好的图的节点数。", "outputFormat": "对于每组数据，输出 $1$ 行：\n\n* 一个整数，表示 $n$ 个节点的好的图的数目对 $P$ 取模的结果。", "hint": "### 样例解释\n\n下面是 $3$ 个点的所有好的图：\n\n![](https://i.loli.net/2018/05/14/5af990dbcfbc0.png)\n\n### 数据范围\n\n保证 $T\\leq 233$，$n\\leq 23333$，$2^{29} < P < 2^{30}$ 且保证 $P$ 为质数。\n\n### 提示\n\n能够通过本题的算法的时间复杂度可能比你想象的要糟糕一些、也可能比你想象的要优秀一些。\n\n### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2018] Good Graph Counting", "background": "This problem is very simple. It does not even have a background story.\n\nBut to help you understand the problem smoothly, the kind Yazid will introduce some concepts.\n\n* Simple graph: a graph with no multiple edges and no self-loops. (A multiple edge means two completely identical edges, and a self-loop means an edge whose two endpoints are the same vertex.)\n\n* Complement graph: the complement of a graph $G$ has exactly the same vertices as $G$, and there is an edge between any two vertices if and only if they are not adjacent in $G$.", "description": "We define an undirected simple graph to be **good** as follows:\n\n1. A single vertex is good.\n\n2. A graph formed by taking several good graphs as connected components is good.\n\n3. The complement of a good graph is good.\n\nGiven a positive integer $n$.\n\nFind, modulo the prime $P$, the number of essentially different good graphs on $n$ vertices. (Here $P$ is a constant; see **Input Format** for details.)\n\nTwo good graphs are considered **essentially different** if and only if, no matter how you relabel one graph, it still cannot become exactly the same as the other graph.", "inputFormat": "The input contains multiple test cases. The first line contains two integers $T, P$ separated by spaces, representing the number of test cases and the modulus. Then each test case is described as follows:\n\n* One line with one integer $n$, meaning the number of vertices of the good graphs to be counted.", "outputFormat": "For each test case, output one line:\n\n* One integer, the number of good graphs on $n$ vertices modulo $P$.", "hint": "### Sample Explanation\n\nBelow are all good graphs with $3$ vertices:\n\n![](https://i.loli.net/2018/05/14/5af990dbcfbc0.png)\n\n### Constraints\n\nIt is guaranteed that $T \\leq 233$, $n \\leq 23333$, $2^{29} < P < 2^{30}$, and $P$ is prime.\n\n### Hint\n\nThe time complexity of an algorithm that can pass this problem might be worse than you expect, or it might be better than you expect.\n\n### Copyright Information\n\nFrom the 2018 Tsinghua University Programming Contest and Collegiate Invitational (THUPC2018). Thanks to [Pony.ai](http://pony.ai/) for supporting this contest.\n\nResources such as editorials can be found at <https://github.com/wangyurzee7/THUPC2018>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2018] 好图计数", "background": "这道题目非常简单，它甚至没有题目背景、没有任何故事。\n\n但为了能让你顺利理解题目，善良的 Yazid 将为你介绍一些概念。\n\n* 简单图：不存在重边、自环的图。（重边即为两条完全相同的边，自环即为两端点为同一节点的边）\n\n* 补图：一个图 $G$ 的补图有与 $G$ 完全相同的节点，且任意两点之间有边当且仅当他们在 $G$ 中不相邻。", "description": "我们归纳定义一个无向简单图是**好的**：\n\n1. 一个单点是好的。\n\n2. 若干个好的图分别作为联通块所形成的图是好的。\n\n3. 一个好的图的补图是好的。\n\n给定一个正整数 $n$。\n\n求 $n$ 个点的本质不同的好的图的数量对质数 $P$ 取模的结果。（这里的 $P$ 是一个常数，具体见【输入格式】）\n\n两个好的图的被认为是**本质不同的**，当且仅当无论如何将一个图重标号，它都不能与另一个图完全相同。", "inputFormat": "输入包含多组数据，第一行 $2$ 个用空格隔开的整数 $T,P$ 分别表示数据组数、以及模数。接下来依次描述每组数据，对于每组数据：\n\n* 一行一个整数 $n$，表示希望统计数目的好的图的节点数。", "outputFormat": "对于每组数据，输出 $1$ 行：\n\n* 一个整数，表示 $n$ 个节点的好的图的数目对 $P$ 取模的结果。", "hint": "### 样例解释\n\n下面是 $3$ 个点的所有好的图：\n\n![](https://i.loli.net/2018/05/14/5af990dbcfbc0.png)\n\n### 数据范围\n\n保证 $T\\leq 233$，$n\\leq 23333$，$2^{29} < P < 2^{30}$ 且保证 $P$ 为质数。\n\n### 提示\n\n能够通过本题的算法的时间复杂度可能比你想象的要糟糕一些、也可能比你想象的要优秀一些。\n\n### 版权信息\n\n来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。", "locale": "zh-CN"}}}
