{"pid": "P8315", "type": "P", "difficulty": 5, "samples": [["3 1 2\n1 2\n2 3\n1 3\n", "2"], ["4 3 2\n1 2\n2 3\n4 2\n1 4\n1 3\n4 3\n", "0"], ["4 3 3\n1 2\n2 3\n4 2\n1 4\n1 3\n4 3", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["并查集", "2021", "状态合并", "容斥原理", "COCI（克罗地亚）"], "title": "[COCI 2021/2022 #4] Šarenlist", "background": "温暖的夏夜，Vito 和他的好朋友 Karlo 躺在森林的空地上看星星。突然，Vito 大喊：“Karlo，你看！我们周围的树都在变色！”“哇，真是五彩缤纷！”Karlo 惊讶地说。的确，森林中的树枝开始变色。", "description": "Vito 和 Karlo 被这些彩色的树迷住了，他们同时也注意到了一些事物。他们正在看的每棵树都可以看做是一个树图，即任意两点之间仅存在一条路径的无向图。他们正在看的每棵树都有这样的特点：每条边上的颜色都是 $k$ 种颜色中的一种。如果树上的一个路径是彩色的，意味着这条路径上至少包含两种不同颜色的边。\n\n早上树的魔力全部消失了。Vito 和 Karlo 还记得 $m$ 条彩色路径的起点和终点。他们想知道：满足条件的树的有多少种可能？由于答案可能很大，所以请将答案对 $10^9+7$ 取模。", "inputFormat": "第一行包含三个整数 $n,m,k$，分别表示树上的节点数、Vito 和 Karlo 所记得的彩色路径的个数和树枝的颜色总数。\n\n接下来 $n-1$ 行，第 $i+1$ 行包含两个整数 $a_i,b_i$，表示点 $a_i$ 和点 $b_i$ 之间有一条树边。\n\n接下来 $m$ 行，第 $n+j$ 行包含两个整数 $c_j,d_j$，表示从点 $c_j$ 到点 $d_j$ 之间有一条彩色路径。保证 $c_j$ 和 $d_j$ **不相邻**。", "outputFormat": "仅一行，输出满足条件的树的可能数，答案需对 $10^9+7$ 取模。", "hint": "**【样例 1 解释】**\n\n第一种情况是点 $1$ 和点 $2$ 之间的边涂颜色 $1$，点 $2$ 和点 $3$ 之间的边涂颜色 $2$。\n\n第二种情况是点 $1$ 和点 $2$ 之间的边涂颜色 $2$，点 $2$ 和点 $3$ 之间的边涂颜色 $1$。\n\n**【数据规模与约定】**\n\n**本题采用子任务捆绑测试。**\n\n- Subtask 1（10 pts）：$m = 1$。\n- Subtask 2（15 pts）：$m = 2$。\n- Subtask 3（10 pts）：每个树边最多属于 $m$ 条彩色路径中的一条。\n- Subtask 4（10 pts）：$1 ≤ n ≤ 15, k = 2$。\n- Subtask 5（65 pts）：没有额外限制。\n\n对于 $100\\%$ 的数据，$3 ≤ n ≤ 60, 1 ≤ m ≤ 15, 2 ≤ k ≤ 10^9, 1 ≤ a_i,b_i, c_j , d_j ≤ n$。\n\n**【提示与说明】**\n\n**本题分值按 COCI 原题设置，满分 $110$。**\n\n**题目译自 [COCI2021-2022](https://hsin.hr/coci/) [CONTEST #4](https://hsin.hr/coci/contest4_tasks.pdf) T5  Šarenlist。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2021/2022 #4] Šarenlist", "background": "温暖的夏夜，Vito 和他的好朋友 Karlo 躺在森林的空地上看星星。突然，Vito 大喊：“Karlo，你看！我们周围的树都在变色！”“哇，真是五彩缤纷！”Karlo 惊讶地说。的确，森林中的树枝开始变色。", "description": "Vito 和 Karlo 被这些彩色的树迷住了，他们同时也注意到了一些事物。他们正在看的每棵树都可以看做是一个树图，即任意两点之间仅存在一条路径的无向图。他们正在看的每棵树都有这样的特点：每条边上的颜色都是 $k$ 种颜色中的一种。如果树上的一个路径是彩色的，意味着这条路径上至少包含两种不同颜色的边。\n\n早上树的魔力全部消失了。Vito 和 Karlo 还记得 $m$ 条彩色路径的起点和终点。他们想知道：满足条件的树的有多少种可能？由于答案可能很大，所以请将答案对 $10^9+7$ 取模。", "inputFormat": "第一行包含三个整数 $n,m,k$，分别表示树上的节点数、Vito 和 Karlo 所记得的彩色路径的个数和树枝的颜色总数。\n\n接下来 $n-1$ 行，第 $i+1$ 行包含两个整数 $a_i,b_i$，表示点 $a_i$ 和点 $b_i$ 之间有一条树边。\n\n接下来 $m$ 行，第 $n+j$ 行包含两个整数 $c_j,d_j$，表示从点 $c_j$ 到点 $d_j$ 之间有一条彩色路径。保证 $c_j$ 和 $d_j$ **不相邻**。", "outputFormat": "仅一行，输出满足条件的树的可能数，答案需对 $10^9+7$ 取模。", "hint": "**【样例 1 解释】**\n\n第一种情况是点 $1$ 和点 $2$ 之间的边涂颜色 $1$，点 $2$ 和点 $3$ 之间的边涂颜色 $2$。\n\n第二种情况是点 $1$ 和点 $2$ 之间的边涂颜色 $2$，点 $2$ 和点 $3$ 之间的边涂颜色 $1$。\n\n**【数据规模与约定】**\n\n**本题采用子任务捆绑测试。**\n\n- Subtask 1（10 pts）：$m = 1$。\n- Subtask 2（15 pts）：$m = 2$。\n- Subtask 3（10 pts）：每个树边最多属于 $m$ 条彩色路径中的一条。\n- Subtask 4（10 pts）：$1 ≤ n ≤ 15, k = 2$。\n- Subtask 5（65 pts）：没有额外限制。\n\n对于 $100\\%$ 的数据，$3 ≤ n ≤ 60, 1 ≤ m ≤ 15, 2 ≤ k ≤ 10^9, 1 ≤ a_i,b_i, c_j , d_j ≤ n$。\n\n**【提示与说明】**\n\n**本题分值按 COCI 原题设置，满分 $110$。**\n\n**题目译自 [COCI2021-2022](https://hsin.hr/coci/) [CONTEST #4](https://hsin.hr/coci/contest4_tasks.pdf) T5  Šarenlist。**", "locale": "zh-CN"}}}
{"pid": "P8316", "type": "P", "difficulty": 6, "samples": [["12345 20", "9167"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "2016", "重庆", "各省省选", "优先队列", "可并堆", "可持久化", "素数判断,质数,筛法"], "title": "[CQOI2016] 伪光滑数 加强版", "background": "原题链接：[P4359 [CQOI2016] 伪光滑数](https://www.luogu.com.cn/problem/P4359)", "description": "若一个大于 $1$ 的整数 $m$ 的**不去重**质因数分解有 $k$ 项，其最大的质因子为 $a_k$，并且满足 $a_{k}^{k} \\leq n$，$a_k \\leq 397$，我们就称整数 $m$ 为 $n$ - 伪光滑数。\n\n给定整数 $n$，求出第 $k$ 大的 $n$ - 伪光滑数。", "inputFormat": "一行，两个整数 $n, k$。", "outputFormat": "一行，一个整数，表示所求的值。", "hint": "对于 $100\\%$ 的数据，$1 < n \\leq 10^{11}$，$k \\geq 1$，保证至少有 $k$ 个满足要求的数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CQOI2016] 伪光滑数 加强版", "background": "原题链接：[P4359 [CQOI2016] 伪光滑数](https://www.luogu.com.cn/problem/P4359)", "description": "若一个大于 $1$ 的整数 $m$ 的**不去重**质因数分解有 $k$ 项，其最大的质因子为 $a_k$，并且满足 $a_{k}^{k} \\leq n$，$a_k \\leq 397$，我们就称整数 $m$ 为 $n$ - 伪光滑数。\n\n给定整数 $n$，求出第 $k$ 大的 $n$ - 伪光滑数。", "inputFormat": "一行，两个整数 $n, k$。", "outputFormat": "一行，一个整数，表示所求的值。", "hint": "对于 $100\\%$ 的数据，$1 < n \\leq 10^{11}$，$k \\geq 1$，保证至少有 $k$ 个满足要求的数。", "locale": "zh-CN"}}}
{"pid": "P8317", "type": "P", "difficulty": 5, "samples": [["4\n8 1 2\n1 2 3 2 4 5 4 6\n4 3 2\n1 2 3 4 5 6 7 8 9 10 11 12\n6 2 3\n10 20 50 60 70 30 40 40 30 30 20 40\n10 1 3\n2 4 3 1 4 5 3 1 1 2", "Case #1: 1 3\nCase #2: 0 1\nCase #3: 1 5\nCase #4: 1 4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["搜索", "2021", "福建", "枚举", "分治", "深度优先搜索 DFS", "剪枝"], "title": "[FOI2021] 幸运区间", "background": "2021 年福建省青少年信息学编程水平认证 第四题。", "description": "一个抽奖活动正在进行。每个参加活动的人拿到了 $n$ 个序列，每个序列包含了 $d$ 个正整数，以及一个数字 $k$，代表这些正整数中，存在 $k$ 个幸运数字。\n\n每个拿到序列的人，会从自己手中的序列中选出连续的若干个序列形成一个区间，称之为待选区间。如果待选区间中的每一个序列都包含至少一个幸运数字，则称该区间为幸运区间。当然幸运区间可能不止一个。游戏规定，其中包含的序列最多的即总长度最长的那个幸运区间称为超级幸运区间。\n\n例如：$d=2,k=3$ 时，序列如下：\n\n- 序列 $0$：``115 120``。\n- 序列 $1$：``50 80``。\n- 序列 $2$：``199 30``。\n- 序列 $3$：``40 40``。\n- 序列 $4$：``30 30``。\n- 序列 $5$：``25 40``。\n\n从序列 $0$ 到序列 $2$ 的区间是幸运区间，因为从 $0$ 到 $2$ 中的每个序列都包含了 $120,50$ 或 $30$，共 $3$ 个幸运数字。从序列 $1$ 到序列 $5$ 的区间也是幸运区间，因为 $1$ 到 $5$ 的所有序列都包含 $80,30$ 或 $40$，并且包含了 $5$ 个序列，是总长度最大的超级幸运区间。\n\n每个有序列的人都想知道自己的超级幸运区间是怎样的。编程任务就是对于每个拿到序列的人，输出总长度最大的超级幸运区间的第一个元素的下标和最后一个元素的下标。如果有多个长度一样的，输出第一个元素下标最小的。请注意下标从 $0$ 开始。", "inputFormat": "第一行包含一个整数 $T$，表示拿到序列的人的数量。\n\n接下来 $T$ 组数字，每组描述的是每个人的序列信息。\n\n每组数据的第一行是三个正整数 $n,d,k$，描述如上。接下来一行，包含 $n\\times d$ 个整数，前 $d$ 个整数表示第 $0$ 个序列，接下来 $d$ 个表示第 $1$ 个序列，以此类推。", "outputFormat": "对于每个人，输出一行，``Case #x: y z``，$x$ 表示 $\\text{case}$ 标号（从 $1$ 开始），$y$ 和 $z$ 是答案区间的第一个和最后一个元素的下标。\n\n（``Case`` 与 ``#`` 之间有一个空格，``#`` 与 ``x`` 之间没有空格，``:`` 后面 ``y`` 之前有一个空格，``y`` 与 ``z`` 之间有一个空格）", "hint": "#### 数据范围\n\n对于 $45\\%$ 的数据，$n\\le1000$。\n\n对于 $50\\%$ 的数据，$k=2$。\n\n前两部分数据共计 $70\\%$。\n\n对于 $100\\%$ 的数据，$2\\le k\\le 3$。\n\n输入文件在 $\\text{4.8M}$ 以内，$T=10,1\\le d\\le 4,1\\le$ 每个序列中的数字 $\\le10^5$。\n\n对于最多 $6$ 个 $\\text{case}$，$1\\le n\\le 10^5$，对于其他所有的 $\\text{case}$，$1\\le n\\le 10^3$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[FOI2021] 幸运区间", "background": "2021 年福建省青少年信息学编程水平认证 第四题。", "description": "一个抽奖活动正在进行。每个参加活动的人拿到了 $n$ 个序列，每个序列包含了 $d$ 个正整数，以及一个数字 $k$，代表这些正整数中，存在 $k$ 个幸运数字。\n\n每个拿到序列的人，会从自己手中的序列中选出连续的若干个序列形成一个区间，称之为待选区间。如果待选区间中的每一个序列都包含至少一个幸运数字，则称该区间为幸运区间。当然幸运区间可能不止一个。游戏规定，其中包含的序列最多的即总长度最长的那个幸运区间称为超级幸运区间。\n\n例如：$d=2,k=3$ 时，序列如下：\n\n- 序列 $0$：``115 120``。\n- 序列 $1$：``50 80``。\n- 序列 $2$：``199 30``。\n- 序列 $3$：``40 40``。\n- 序列 $4$：``30 30``。\n- 序列 $5$：``25 40``。\n\n从序列 $0$ 到序列 $2$ 的区间是幸运区间，因为从 $0$ 到 $2$ 中的每个序列都包含了 $120,50$ 或 $30$，共 $3$ 个幸运数字。从序列 $1$ 到序列 $5$ 的区间也是幸运区间，因为 $1$ 到 $5$ 的所有序列都包含 $80,30$ 或 $40$，并且包含了 $5$ 个序列，是总长度最大的超级幸运区间。\n\n每个有序列的人都想知道自己的超级幸运区间是怎样的。编程任务就是对于每个拿到序列的人，输出总长度最大的超级幸运区间的第一个元素的下标和最后一个元素的下标。如果有多个长度一样的，输出第一个元素下标最小的。请注意下标从 $0$ 开始。", "inputFormat": "第一行包含一个整数 $T$，表示拿到序列的人的数量。\n\n接下来 $T$ 组数字，每组描述的是每个人的序列信息。\n\n每组数据的第一行是三个正整数 $n,d,k$，描述如上。接下来一行，包含 $n\\times d$ 个整数，前 $d$ 个整数表示第 $0$ 个序列，接下来 $d$ 个表示第 $1$ 个序列，以此类推。", "outputFormat": "对于每个人，输出一行，``Case #x: y z``，$x$ 表示 $\\text{case}$ 标号（从 $1$ 开始），$y$ 和 $z$ 是答案区间的第一个和最后一个元素的下标。\n\n（``Case`` 与 ``#`` 之间有一个空格，``#`` 与 ``x`` 之间没有空格，``:`` 后面 ``y`` 之前有一个空格，``y`` 与 ``z`` 之间有一个空格）", "hint": "#### 数据范围\n\n对于 $45\\%$ 的数据，$n\\le1000$。\n\n对于 $50\\%$ 的数据，$k=2$。\n\n前两部分数据共计 $70\\%$。\n\n对于 $100\\%$ 的数据，$2\\le k\\le 3$。\n\n输入文件在 $\\text{4.8M}$ 以内，$T=10,1\\le d\\le 4,1\\le$ 每个序列中的数字 $\\le10^5$。\n\n对于最多 $6$ 个 $\\text{case}$，$1\\le n\\le 10^5$，对于其他所有的 $\\text{case}$，$1\\le n\\le 10^3$。", "locale": "zh-CN"}}}
{"pid": "P8318", "type": "P", "difficulty": 2, "samples": [["5 5\n12 1 12 4 2\n1 3 2\n1 4 3\n2 3 4\n1 5 2\n2 1 3", "1 1 2 1 1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2022", "洛谷原创", "枚举", "洛谷月赛"], "title": "『JROI-4』淘气的猴子", "background": "众所周知，jockbutt 是一个可爱的女孩纸。\n![](https://cdn.luogu.com.cn/upload/image_hosting/73du6v88.png)", "description": "jockbutt 有一个正整数序列，长度为 $n$，分别为 $a_1,a_2...a_n$，她非常喜欢这个序列，平时都非常爱惜它们。\n\n可是有一天，当 jockbutt 在和你约会的时候，有一只淘气的小猴子改变了这个序列。\n\n猴子操作了 $m$ 次。  \n\n猴子的操作有两种类型：\n\n- $\\texttt{1 x y}$ 表示第 $x$ 个元素加上第 $y$ 个元素。\n- $\\texttt{2 x y}$ 表示第 $x$ 个元素乘上第 $y$ 个元素。\n\n特别且显然地，当 $x=y$，新的 $x$ 就等于原来的 $x$ 的两倍或平方。\n\n序列最后结果形如 $b_1,b_2...b_n$。\n\n等到 jockbutt 回来时，全洛谷的人都在看猴子。$\\colorbox{white}{\\color{white}{\\text{其实 jockbutt 才是他们看的猴子吧}}}$\n\njockbutt 非常生气，希望你能告诉她这个序列最初的形态，也就是 $a_1,a_2,a_3,...,a_n$，否则她就会嘤嘤嘤...", "inputFormat": "一共有 $m+2$ 行。\n\n第一行输入两个数 $n,m$。\n\n第二行输入 $n$ 个数 $b_1,b_2,\\cdots,b_n$，表示经过操作后的序列。\n\n第 $3\\sim m+2$ 行每一行输入 $3$ 个数 $k,x,y$ ，分别表示操作类型，以及操作中的 $x$ 和 $y$。\n\n", "outputFormat": "一行，$n$ 个整数 $a_1,a_2...a_n$，表示序列最初的样子。", "hint": "\n**本题采用捆绑测试。**\n\n|  子任务编号 | 分值 | 特殊限制 |\n| :-----------: | :---:| :-----------: |\n| 1 | 25 | $1\\leq n,m\\leq 10$ |\n| 2 | 25 | $1\\leq n\\leq 100$，$1\\leq m \\leq 50 $ |\n| 3 | 50 | 无 |\n\n- 对于 $100\\%$ 的数据满足 $1\\leq n\\le 10^3$，$1\\leq m\\le 200$，对于任意的 $ i $ $ ( 1\\leq i \\leq n ) $，有 $1\\leq a_{i},b_{i} \\leq 2^{60}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『JROI-4』淘气的猴子", "background": "众所周知，jockbutt 是一个可爱的女孩纸。\n![](https://cdn.luogu.com.cn/upload/image_hosting/73du6v88.png)", "description": "jockbutt 有一个正整数序列，长度为 $n$，分别为 $a_1,a_2...a_n$，她非常喜欢这个序列，平时都非常爱惜它们。\n\n可是有一天，当 jockbutt 在和你约会的时候，有一只淘气的小猴子改变了这个序列。\n\n猴子操作了 $m$ 次。  \n\n猴子的操作有两种类型：\n\n- $\\texttt{1 x y}$ 表示第 $x$ 个元素加上第 $y$ 个元素。\n- $\\texttt{2 x y}$ 表示第 $x$ 个元素乘上第 $y$ 个元素。\n\n特别且显然地，当 $x=y$，新的 $x$ 就等于原来的 $x$ 的两倍或平方。\n\n序列最后结果形如 $b_1,b_2...b_n$。\n\n等到 jockbutt 回来时，全洛谷的人都在看猴子。$\\colorbox{white}{\\color{white}{\\text{其实 jockbutt 才是他们看的猴子吧}}}$\n\njockbutt 非常生气，希望你能告诉她这个序列最初的形态，也就是 $a_1,a_2,a_3,...,a_n$，否则她就会嘤嘤嘤...", "inputFormat": "一共有 $m+2$ 行。\n\n第一行输入两个数 $n,m$。\n\n第二行输入 $n$ 个数 $b_1,b_2,\\cdots,b_n$，表示经过操作后的序列。\n\n第 $3\\sim m+2$ 行每一行输入 $3$ 个数 $k,x,y$ ，分别表示操作类型，以及操作中的 $x$ 和 $y$。\n\n", "outputFormat": "一行，$n$ 个整数 $a_1,a_2...a_n$，表示序列最初的样子。", "hint": "\n**本题采用捆绑测试。**\n\n|  子任务编号 | 分值 | 特殊限制 |\n| :-----------: | :---:| :-----------: |\n| 1 | 25 | $1\\leq n,m\\leq 10$ |\n| 2 | 25 | $1\\leq n\\leq 100$，$1\\leq m \\leq 50 $ |\n| 3 | 50 | 无 |\n\n- 对于 $100\\%$ 的数据满足 $1\\leq n\\le 10^3$，$1\\leq m\\le 200$，对于任意的 $ i $ $ ( 1\\leq i \\leq n ) $，有 $1\\leq a_{i},b_{i} \\leq 2^{60}$。", "locale": "zh-CN"}}}
{"pid": "P8319", "type": "P", "difficulty": 3, "samples": [["5\n1\n2\n5\n8\n114514", "1\n2\n5\n7\n114493\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "2022", "洛谷原创", "素数判断,质数,筛法", "洛谷月赛"], "title": "『JROI-4』分数", "background": "在 QQ 群中，经常会出现这样的接龙：\n- 万人血书 xxx（1/10000）$\\to$\n- 万人血书 xxx（1/5000）$\\to$\n- 万人血书 xxx（1/2500）$\\to$\n- 万人血书 xxx（1/1250）$\\to \\dots$\n\n以此类推，在可以约分的情况下，“万人血书”很快就能完成。", "description": "“$x$ 人血书”的过程可以看成一个函数 $f(x)$：\n\n有一个 $\\frac{0}{x}$ 的分数。重复以下步骤直到这个分数为 $1$：\n\n1. 分子 $+1$。\n2. 如果这个分数可以约分，约分到最简形式。\n\n现在小 D 给了你 $T$ 组数据，每组数据都是给定 $n$，求在 $1\\le x\\le n$ 的情况下 $f(x)$ 的最大操作次数。\n\n但是他太菜了，不会，你能帮帮他吗？", "inputFormat": "第一行一个正整数 $T$。\n\n接下来 $T$ 行，每行一个正整数 $n$。", "outputFormat": "共 $T$ 行，每行一个整数 $s$ 表示在 $1\\le x\\le n$ 的情况下 $f(x)$ 的最大操作次数。", "hint": "### 样例解释\n\n$f(1)=1,f(2)=2,f(3)=3,f(4)=3,f(5)=5$。\n\n我也想把更大的 $f(x)$ 列出来，但是地方不够了。\n\n### 数据范围\n\n\n对于全部数据，$1\\le T\\le 5\\times 10^5$，$1\\le n\\le 2\\times 10^6$。\n\nSubtask 中没填的部分表示和全部数据的范围一样。\n\n| 子任务编号 | $T$ 的范围 | $n$ 的范围 | 特殊性质 |分值|\n| -----------: | -----------: | -----------: | -----------: |-----------: |\n| Subtask $1$ | $T\\le 3$ | $n\\le 10$ |  |$10$|\n| Subtask $2$ | $T\\le 5$ | $n\\le 10^3$ |  |$30$|\n| Subtask $3$ |  |  | $n$ 为质数|$10$|\n| Subtask $4$  |  | $n\\le 5\\times 10^5$ |  |$20$|\n| Subtask $5$  |  |  |  |$30$|\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『JROI-4』分数", "background": "在 QQ 群中，经常会出现这样的接龙：\n- 万人血书 xxx（1/10000）$\\to$\n- 万人血书 xxx（1/5000）$\\to$\n- 万人血书 xxx（1/2500）$\\to$\n- 万人血书 xxx（1/1250）$\\to \\dots$\n\n以此类推，在可以约分的情况下，“万人血书”很快就能完成。", "description": "“$x$ 人血书”的过程可以看成一个函数 $f(x)$：\n\n有一个 $\\frac{0}{x}$ 的分数。重复以下步骤直到这个分数为 $1$：\n\n1. 分子 $+1$。\n2. 如果这个分数可以约分，约分到最简形式。\n\n现在小 D 给了你 $T$ 组数据，每组数据都是给定 $n$，求在 $1\\le x\\le n$ 的情况下 $f(x)$ 的最大操作次数。\n\n但是他太菜了，不会，你能帮帮他吗？", "inputFormat": "第一行一个正整数 $T$。\n\n接下来 $T$ 行，每行一个正整数 $n$。", "outputFormat": "共 $T$ 行，每行一个整数 $s$ 表示在 $1\\le x\\le n$ 的情况下 $f(x)$ 的最大操作次数。", "hint": "### 样例解释\n\n$f(1)=1,f(2)=2,f(3)=3,f(4)=3,f(5)=5$。\n\n我也想把更大的 $f(x)$ 列出来，但是地方不够了。\n\n### 数据范围\n\n\n对于全部数据，$1\\le T\\le 5\\times 10^5$，$1\\le n\\le 2\\times 10^6$。\n\nSubtask 中没填的部分表示和全部数据的范围一样。\n\n| 子任务编号 | $T$ 的范围 | $n$ 的范围 | 特殊性质 |分值|\n| -----------: | -----------: | -----------: | -----------: |-----------: |\n| Subtask $1$ | $T\\le 3$ | $n\\le 10$ |  |$10$|\n| Subtask $2$ | $T\\le 5$ | $n\\le 10^3$ |  |$30$|\n| Subtask $3$ |  |  | $n$ 为质数|$10$|\n| Subtask $4$  |  | $n\\le 5\\times 10^5$ |  |$20$|\n| Subtask $5$  |  |  |  |$30$|\n", "locale": "zh-CN"}}}
{"pid": "P8320", "type": "P", "difficulty": 4, "samples": [["1\n\n3\n\n1\n\n2\n\n3\n\n\n2\n\n", "\n\n\n? 1 1\n\n? 1 2\n\n? 1 3\n\n? 2 2\n? 1 3\n\n! 1 2 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["二分", "洛谷原创", "交互题", "Special Judge", "洛谷月赛"], "title": "『JROI-4』Sunset", "background": "写不出优美的文字，索性不放背景了。【背景待填充】\n\n> 由于这只是个 C，出题人打算良心点，于是加了几个 $0$（指交互次数）（确信）——验题人注。", "description": "**这是一道交互题。**\n\n落日可以抽象成一个序列 $\\{a_n\\}$.\n\n$\\{a_n\\}$ 是一个 $1\\sim n$ 的排列。\n\n你还有一个数列 $\\{d_n\\}$，为**当前** $a$ 数列的前缀最大值。\n\n换言之，\n$$d_i=\\max_{j=1}^i \\{a_j\\}$$\n\n注意：根据前文的定义，$\\{d_n\\}$ 可能随着 $\\{a_n\\}$ 数列的改变而改变。\n\n您可以进行两种不同的操作：\n\n- 指定一个 $i$，询问对于当前的 $a$ 数列， $d_{1\\sim i}$ 中有几个不同的值。\n- 指定一个 $i$，使得 $a_i\\leftarrow 0$.\n\n请使用不超过 $5500$ 次操作求出**原排列**。\n\n**保证交互库是静态的，即交互库不会在交互过程中改变 $a$ 数列。**", "inputFormat": "本题多测，第一行一个整数 $T$，表示测试组数，接下来 $T$ 行每行一个整数 $n$，表示本组数据下数列的长度。\n\n本题使用 IO 交互模式。\n### 交互格式\n- `? 1 i` 询问 $d_{1\\sim i}$ 中有几个不同的值，交互库会返回一个正整数 $x$ 表示答案。\n\n- `? 2 i` 使 $a_i=0$。\n\n- `! a1 a2 a3 ... an` 输出答案。\n\n请注意：在每组数据中，请保证前两种操作的次数总和不超过 $5500$。\n\n需要注意的是，在每一次操作后，需要调用以下函数刷新缓存：\n\n- 对于 C/C++：`fflush(stdout);`\n- 对于 C++：`std::cout << std::flush;`\n- 对于 Java：`System.out.flush();`\n- 对于 Python：`stdout.flush();`\n- 对于 Pascal：`flush(output);`\n\n对于其他语言，请自行查阅对应语言的帮助文档。", "outputFormat": "见「交互格式」。", "hint": "**样例仅供理解交互过程，可能不符合逻辑。**\n\n【样例解释】\n\n初始的序列 $a$ 为 `1 2 3`，$d$ 为 `1 2 3`.\n\n在对交互库输出了形如 `? 2 2` 的命令后，序列 $a$ 变为 `1 0 3`，$d$ 变为 `1 1 3`，此时 $d_1\\sim d_3$ 中有 $2$ 种不同的值，分别是 $1,3$.\n\n\n\n------------\n\n\n可供选手参考的资料：[OI Wiki-交互题](https://oi-wiki.org/contest/interaction/) **|** [猜数（IO交互版）\n](https://www.luogu.com.cn/problem/P1733)\n\n\n\n------------\n\n## 数据范围\n- 对于 $10\\%$ 的数据，$T=1$；\n- 对于 $30\\%$ 的数据，$n\\le 70$；\n- 对于另外 $20\\%$ 的数据，保证数列 $a$ 随机生成；\n- 对于全部数据：$T \\leq 10,1\\leq n\\leq 500$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『JROI-4』Sunset", "background": "写不出优美的文字，索性不放背景了。【背景待填充】\n\n> 由于这只是个 C，出题人打算良心点，于是加了几个 $0$（指交互次数）（确信）——验题人注。", "description": "**这是一道交互题。**\n\n落日可以抽象成一个序列 $\\{a_n\\}$.\n\n$\\{a_n\\}$ 是一个 $1\\sim n$ 的排列。\n\n你还有一个数列 $\\{d_n\\}$，为**当前** $a$ 数列的前缀最大值。\n\n换言之，\n$$d_i=\\max_{j=1}^i \\{a_j\\}$$\n\n注意：根据前文的定义，$\\{d_n\\}$ 可能随着 $\\{a_n\\}$ 数列的改变而改变。\n\n您可以进行两种不同的操作：\n\n- 指定一个 $i$，询问对于当前的 $a$ 数列， $d_{1\\sim i}$ 中有几个不同的值。\n- 指定一个 $i$，使得 $a_i\\leftarrow 0$.\n\n请使用不超过 $5500$ 次操作求出**原排列**。\n\n**保证交互库是静态的，即交互库不会在交互过程中改变 $a$ 数列。**", "inputFormat": "本题多测，第一行一个整数 $T$，表示测试组数，接下来 $T$ 行每行一个整数 $n$，表示本组数据下数列的长度。\n\n本题使用 IO 交互模式。\n### 交互格式\n- `? 1 i` 询问 $d_{1\\sim i}$ 中有几个不同的值，交互库会返回一个正整数 $x$ 表示答案。\n\n- `? 2 i` 使 $a_i=0$。\n\n- `! a1 a2 a3 ... an` 输出答案。\n\n请注意：在每组数据中，请保证前两种操作的次数总和不超过 $5500$。\n\n需要注意的是，在每一次操作后，需要调用以下函数刷新缓存：\n\n- 对于 C/C++：`fflush(stdout);`\n- 对于 C++：`std::cout << std::flush;`\n- 对于 Java：`System.out.flush();`\n- 对于 Python：`stdout.flush();`\n- 对于 Pascal：`flush(output);`\n\n对于其他语言，请自行查阅对应语言的帮助文档。", "outputFormat": "见「交互格式」。", "hint": "**样例仅供理解交互过程，可能不符合逻辑。**\n\n【样例解释】\n\n初始的序列 $a$ 为 `1 2 3`，$d$ 为 `1 2 3`.\n\n在对交互库输出了形如 `? 2 2` 的命令后，序列 $a$ 变为 `1 0 3`，$d$ 变为 `1 1 3`，此时 $d_1\\sim d_3$ 中有 $2$ 种不同的值，分别是 $1,3$.\n\n\n\n------------\n\n\n可供选手参考的资料：[OI Wiki-交互题](https://oi-wiki.org/contest/interaction/) **|** [猜数（IO交互版）\n](https://www.luogu.com.cn/problem/P1733)\n\n\n\n------------\n\n## 数据范围\n- 对于 $10\\%$ 的数据，$T=1$；\n- 对于 $30\\%$ 的数据，$n\\le 70$；\n- 对于另外 $20\\%$ 的数据，保证数列 $a$ 随机生成；\n- 对于全部数据：$T \\leq 10,1\\leq n\\leq 500$。", "locale": "zh-CN"}}}
{"pid": "P8321", "type": "P", "difficulty": 6, "samples": [["8\n15 14 13 10 9 6 3 2 \n2 10 8 2 9 1 10 2 ", "114102208"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "2022", "洛谷原创", "O2优化", "排序", "洛谷月赛"], "title": "『JROI-4』沈阳大街 2", "background": "", "description": "给定两个长度为 $n$ 的序列 $A,B$，满足：\n\n* $\\forall 1\\le i<n,A_i \\ge A_{i+1}$ \n\n* $A_n\\ge \\min\\limits_{i=1}^n(B_i)$\n\n$\\pi$ 是一个长度为 $n$ 的排列，定义价值函数 $f(\\pi)$：\n\n$$\nf(\\pi)=\\prod_{i=1}^n\\min(A_i,B_{\\pi(i)})\n$$\n\n每种排列出现的概率相等，求 $f(\\pi)$ 的期望对 $998244353$ 取模的结果。\n\n即求:\n\n$$\n\\left(\\dfrac{1}{n!}\\sum_\\pi f(\\pi)\\right) \\bmod 998244353\n$$\n", "inputFormat": "第一行输入一个整数 $n$。\n\n第二行 $n$ 个整数表示 $A_i$。\n\n第三行 $n$ 个整数表示 $B_i$。", "outputFormat": "输出一行一个整数，为答案。", "hint": "**本题采用捆绑测试。**\n\n|  子任务编号 | 分值 | 特殊限制 |\n| :-----------: | :---:| :-----------: |\n| 1 | 5 | $1\\le n\\le 8$ |\n| 2 | 35 | $1\\le n\\le 50$ |\n| 3 | 20 | $A_n\\ge \\max\\limits_{i=1}^n(B_i)$ |\n| 4 | 40 | 无 |\n\n对于 $100\\%$ 的数据满足 $1\\le n\\le 5000$，$1\\le A_i,B_i\\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『JROI-4』沈阳大街 2", "background": "", "description": "给定两个长度为 $n$ 的序列 $A,B$，满足：\n\n* $\\forall 1\\le i<n,A_i \\ge A_{i+1}$ \n\n* $A_n\\ge \\min\\limits_{i=1}^n(B_i)$\n\n$\\pi$ 是一个长度为 $n$ 的排列，定义价值函数 $f(\\pi)$：\n\n$$\nf(\\pi)=\\prod_{i=1}^n\\min(A_i,B_{\\pi(i)})\n$$\n\n每种排列出现的概率相等，求 $f(\\pi)$ 的期望对 $998244353$ 取模的结果。\n\n即求:\n\n$$\n\\left(\\dfrac{1}{n!}\\sum_\\pi f(\\pi)\\right) \\bmod 998244353\n$$\n", "inputFormat": "第一行输入一个整数 $n$。\n\n第二行 $n$ 个整数表示 $A_i$。\n\n第三行 $n$ 个整数表示 $B_i$。", "outputFormat": "输出一行一个整数，为答案。", "hint": "**本题采用捆绑测试。**\n\n|  子任务编号 | 分值 | 特殊限制 |\n| :-----------: | :---:| :-----------: |\n| 1 | 5 | $1\\le n\\le 8$ |\n| 2 | 35 | $1\\le n\\le 50$ |\n| 3 | 20 | $A_n\\ge \\max\\limits_{i=1}^n(B_i)$ |\n| 4 | 40 | 无 |\n\n对于 $100\\%$ 的数据满足 $1\\le n\\le 5000$，$1\\le A_i,B_i\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P8322", "type": "P", "difficulty": 7, "samples": [["3 1\n1 6\n2 6\n3 6", "3"], ["4 1\n11 45\n19 81\n31 53\n7 28", "6295"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["洛谷原创", "O2优化", "洛谷月赛"], "title": "『JROI-4』少女幻葬", "background": "[该题原题目背景](https://www.luogu.com.cn/paste/imhwx32x)\n\n[少女幻葬](https://thwiki.cc/%E5%B0%91%E5%A5%B3%E5%B9%BB%E8%91%AC_%EF%BD%9E_Necro-Fantasy)是八云蓝的主题曲，同样也是东方妖妖梦 extra stage 的 boss 战音乐。\n\n是使用 ZUN 号的音乐中最为经典的一首之一。钢琴声仿佛在描绘一个强大而又美丽的妖兽的形象，而嘹亮的 ZUN 号配合蓝华丽的弹幕将死亡的主题表现到了极致。", "description": "给定一个长度为 $n$ 的序列 $a$，并给出序列第 $i$ 个数 $a_i$ 的取值范围 $[l_i,r_i]$。现在蓝想知道有多少个序列 $a$ 满足对于给定的常数 $k$，有：\n\n- 任意相邻两数的最大公因数都不为 $k$； \n\n- 任意相邻三数的最大公因数都恰好为 $k$。\n\n 由于答案可能很大，请输出其 $\\bmod \\space998244353$ 的值。", "inputFormat": "第一行两个数 $n,k$。\n\n接下来 $n$ 行，每行两个数分别表示 $l_i,r_i$。", "outputFormat": "一行，答案对 $998244353$ 取模的结果。", "hint": "【样例解释】\n\n对于样例 $1$，可行的序列有：$[2,6,3],[3,6,4],[4,6,3]$。\n\n【数据范围及约定】\n\n- Subtask1（7pts）$3 \\leq n \\leq 5$，$1 \\leq m \\leq 10$。\n- Subtask2（23pts）$3 \\leq n \\leq 100$，$1 \\leq m \\leq 100$。\n- Subtask3（25pts）$3 \\leq n \\leq 1000$，$1 \\leq m \\leq 1000$。\n- Subtask4（45pts）无特殊限制。\n\n对于 $100\\%$ 的数据，满足 $3 \\leq n \\leq 2000$，$1 \\leq l_i \\leq r_i \\leq 5000$，$1 \\leq k \\leq 5000$。\n\n其中 $m=\\max_{i=1}^{n}r_i$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『JROI-4』少女幻葬", "background": "[该题原题目背景](https://www.luogu.com.cn/paste/imhwx32x)\n\n[少女幻葬](https://thwiki.cc/%E5%B0%91%E5%A5%B3%E5%B9%BB%E8%91%AC_%EF%BD%9E_Necro-Fantasy)是八云蓝的主题曲，同样也是东方妖妖梦 extra stage 的 boss 战音乐。\n\n是使用 ZUN 号的音乐中最为经典的一首之一。钢琴声仿佛在描绘一个强大而又美丽的妖兽的形象，而嘹亮的 ZUN 号配合蓝华丽的弹幕将死亡的主题表现到了极致。", "description": "给定一个长度为 $n$ 的序列 $a$，并给出序列第 $i$ 个数 $a_i$ 的取值范围 $[l_i,r_i]$。现在蓝想知道有多少个序列 $a$ 满足对于给定的常数 $k$，有：\n\n- 任意相邻两数的最大公因数都不为 $k$； \n\n- 任意相邻三数的最大公因数都恰好为 $k$。\n\n 由于答案可能很大，请输出其 $\\bmod \\space998244353$ 的值。", "inputFormat": "第一行两个数 $n,k$。\n\n接下来 $n$ 行，每行两个数分别表示 $l_i,r_i$。", "outputFormat": "一行，答案对 $998244353$ 取模的结果。", "hint": "【样例解释】\n\n对于样例 $1$，可行的序列有：$[2,6,3],[3,6,4],[4,6,3]$。\n\n【数据范围及约定】\n\n- Subtask1（7pts）$3 \\leq n \\leq 5$，$1 \\leq m \\leq 10$。\n- Subtask2（23pts）$3 \\leq n \\leq 100$，$1 \\leq m \\leq 100$。\n- Subtask3（25pts）$3 \\leq n \\leq 1000$，$1 \\leq m \\leq 1000$。\n- Subtask4（45pts）无特殊限制。\n\n对于 $100\\%$ 的数据，满足 $3 \\leq n \\leq 2000$，$1 \\leq l_i \\leq r_i \\leq 5000$，$1 \\leq k \\leq 5000$。\n\n其中 $m=\\max_{i=1}^{n}r_i$。", "locale": "zh-CN"}}}
{"pid": "P8323", "type": "P", "difficulty": 7, "samples": [["3\n1 2 2\n1 1 1\n\n2 1\n1 1\n1 2\n1 3\n\n3 2\n1 1\n1 2\n2 2\n2 5\n1 36\n\n0 2\n1 7\n2 6", "0\n1352\n10488222\n//下面是加密前的输出\n4\n676\n1682209\n3496074\n4354184"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 5000, 5000, 5000, 5000, 5000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "O2优化", "洛谷月赛"], "title": "『JROI-4』傀影与猩红孤钻", "background": "“水……”\n\n在沙尘暴中跋涉许久，又整整一天没有饮水，身体已经逐渐支撑不住了。\n\n凯尔希没有拿水瓶，而是冷冷地说了一句“再撑一会”，随后就自顾自继续向前赶路。\n\n我们已经在沙暴里跋涉了多久？三个小时？还是五个小时？黄沙不停往衣物里涌，狂风则不停将沙尘甩在脸上，刮得眼睛都睁不开。但我们还不能停步，后面的萨卡兹雇佣兵还在紧追不舍，他们尽职尽责，即使是沙暴都阻挡不了他们的脚步。\n\n至于水……或许早就喝完了吧。\n\n听说沙漠里有在空水壶中灌沙来给人以希望的传统，可现在，沙子我已经喝够了，水，我只想喝口水，哪怕用身上所有的硬币去换，我也愿意。\n\n只是在这荒野里，闪亮的金属毫无意义。\n\n紧紧抱着银色的手提箱，我咬紧牙关继续迈步。\n\n耳边都是凄厉的呼啸，像是亡者的哭号，又像是鬼魂的呼唤。索恩教授或许也在其中，呼唤着我的名字？\n\n但我听不太清了。\n\n脑中满是这样的响声，已经多久了？三分钟？三小时？还是三年？\n\n沙尘遮蔽了天空，白天和黑夜已经毫无区别，时间似乎都已凝滞，只有在其中求生的人们，还在忍受着此间种种刑罚。\n\n我只是想做研究，我只是想为科学进步奉献自己的力量，而不是像现在这样，倒在沙海里风干。\n\n脑袋又酸又胀又痛，身体好像早就没了知觉，我是在行走吗，还是在看着这具名为艾利奥特的躯壳蠕动？\n\n不……思考也成为了一种奢求，现在徘徊在脑袋里的，只有一个指令：移动。\n\n移动……移动……移动……\n\n……但沙海是无垠的。\n\n“艾利奥特，张嘴。”\n\n张嘴？\n\n我下意识地放松肌肉，让嘴唇和牙齿露出一条通往口腔的通道。\n\n一串沾满沙土的果实落到了口中。\n\n有些酸涩？有些甘甜？哦，是水，是水。\n\n是水啊。\n\n……\n\n不知从什么时候开始，耳边再也没有风声，大地回复了寂静，只有阳光，沙漠，和两个在沙丘间徒步的凡人。\n\n……\n\n我望向远方，除了黄沙，还是黄沙。\n\n一眼望不到尽头，就像散落满地又被浸湿的皮鞋踩上几脚的技术文件，再也归不拢，再也理不齐。\n\n我忿忿地踢了一脚沙子，看着它们从沙丘尖端翻滚滑落，然后重新融到沙漠中，好似什么都没有发生过。\n\n沙子，沙子。\n\n我生平第一次开始痛恨沙子。\n\n“走吧，很快就能获得补给了。”\n\n凯尔希打断了我的思绪。\n\n可，很快？能有多快？\n\n一些补给？又有多少呢？\n\n呵，凯尔希从来不向人许诺希望。\n\n但至少……\n\n我似乎看见了一颗仙人掌。", "description": "## 我们在题目描述的最下方提供了形式化题意，若您不想阅读整活部分可以直接跳到题目描述的最下方。\n\n神在猩红剧团的探索中取回了自己一部分的力量，不多，但够用。\n\n神见到了傀影。准备使用辉煌裂片对他进行审判。\n\n但是傀影躲进了一个被分成 $d$ 层的 DAG 中。\n\n具体地，DAG 上第 $i$ 层的节点只会连向第 $i+1$ 层的节点。\n\n“那就陪你继续玩玩吧。”神心想。\n\n神决定了一种审判的方式。\n\n具体地，神最开始有一些辉煌裂片。神认为，多项式具有强大的力量，所以辉煌裂片就是多项式。~~我才不告诉你是我懒得编题面。~~\n\n神有三种对辉煌裂片的操作：\n\n1. “无度”\n\n可以让辉煌裂片更加强大。具体地，对 $F(x)$ 进行这个操作就相当于令 $F(x)=F^2(x)$。\n\n2. “文明的存续”\n\n可以让“无度”后的辉煌裂片更加强大。具体地，对 $F(x)$ 进行这个操作就相当于令 $F(x)=F(x^2)$。\n\n3. “夜骇”\n\n可以让两个辉煌裂片进行融合，变得更加强大。具体地，如果对 $F(x)$ 和 $G(x)$ 进行这个操作会返回一个多项式为 $F(x)+G(x)$。\n\n神决定这样对傀影进行审判：\n\n在第一层的节点放置辉煌裂片。\n\n当辉煌裂片进入一个节点前，对自身进行“无度”。\n\n当两个辉煌裂片相遇，对这两个辉煌裂片进行“夜骇”，只会留下一个辉煌裂片为这两个辉煌裂片进行“夜骇”的结果。\n\n辉煌裂片只会在连接该节点的所有边都有辉煌裂片通过后，才会离开该节点。当辉煌裂片离开一个节点时，辉煌裂片会对进行“文明的存续”，然后分裂成若干个和原辉煌裂片相同的辉煌裂片，留下一个辉煌裂片在该节点。然后，每条边都将通过恰好一个辉煌裂片。\n\n若傀影在节点 $u$，而神有一个审判指数（execution points，EXP）$k$，该节点留下的辉煌裂片为 $F_u(x)$，那么傀影将会受到 $F_u(k)$ 伏特的电流。\n\n现在神有一些提问。每个提问类似于，若傀影藏在节点 $u$，且审判指数为 $k$，那么傀影将会受到多少伏特的电流？\n\n神是怜悯的。答案可能过大，他只要求你输出答案对 $7340033(2^{20}\\times7+1)$（一个质数）取模后的结果。\n### 形式化题意\n给你一张分为 $d$ 层的 DAG，每个节点都有一个多项式 $F_u(x)$。**可能会有重边。**\n\n这个 DAG 上第 $i$ 层的节点只会向第 $i+1$ 层的节点连边。\n\n若 $S_u$ 包含所有连向点 $u$ 的节点，那么满足 $F_u(x)=\\sum_{v \\in S_u}F_v^2(x^2)$。\n\n给出第一层节点的多项式，每次询问会给你 $u,k$，然后询问 $F_u(k)$ 对 $7340033(2^{20}\\times7+1)$（一个质数）取模后的结果。\n\n**请注意，重边算作一条边。**", "inputFormat": "第一行一个整数 $d$，表示 DAG 的层数。\n\n接下来一行会有 $d$ 个整数，第 $i$ 个数 $n_i$ 表示第 $i$ 层有 $n_i$ 个节点。\n\n接下来 $n_1$ 行，第 $i$ 行有若干个数表示第一层的 $i$ 号节点的多项式。\n\n具体地，每行第一个数 $p$ 表示多项式的最高次，接下来 $p+1$ 个数表示这个多项式的系数，若其中第 $i$ 个数（不包括 $p$）为 $f_{i-1}$，那么该多项式为 $\\sum_{i=0}^pf_ix^i$。\n\n接下来的输入分为 $d$ 段。第 $i$ 段的开头有两个数 $m,q$ 表示第 $i$ 层有 $m$ 条边，以及神在第 $i$ 层的点中有 $q$ 个询问。\n\n接下来 $m$ 行，每行两个数 $u,v$ 表示第 $i$ 层编号为 $u$ 的点连接了第 $i+1$ 层编号为 $v$ 的点。\n\n接下来 $q$ 行每行两个整数 $u,k$ 表示神询问当傀影在第 $i$ 层编号为 $u$ 的节点上时，且审判指数为 $k$ 时，傀影受到电流的伏特对 $7340033$ 取模后的结果。", "outputFormat": "由于输出可能过大，你需要对输出加密。\n\n具体地，对于第 $k$ 层的询问，若第 $i$ 个询问的答案为 $a_i$，你只需要输出 $(k \\times \\bigoplus_{i=1}^q(q-i) \\times a_i)\\bmod 2^{32}$ 即可。\n\n请注意，输出一共 $d$ 行，每行一个数字。", "hint": "- Subtask1（7pts）$1\\leq d\\leq 2$。\n- Subtask2（20pts）$1\\leq d\\leq 10,\\sum q=1$。\n- Subtask3（13pts）$n_1=2$，且时间限制为 5s。\n- Subtask4（60pts）无特殊限制。\n- Subtack5（0pts）Hack 数据。\n\n对于 $ 100\\% $ 的数据，满足 $1\\leq\\sum n<5060$，$1\\leq d\\leq 10$，$\\sum q\\leq 1.5 \\times 10^6$，$1\\leq w,k<7340033$，$0 \\leq p \\leq 2$。\n\n若第 $i$ 层有 $m_i$ 条边，对于 $i\\neq d$ 保证有 $n_i<n_{i+1}\\leq2\\times n_i$ 和 $n_i\\leq m_i\\leq 3\\times n_i$，且 $m_d=0,1 \\leq n_1 \\leq 5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『JROI-4』傀影与猩红孤钻", "background": "“水……”\n\n在沙尘暴中跋涉许久，又整整一天没有饮水，身体已经逐渐支撑不住了。\n\n凯尔希没有拿水瓶，而是冷冷地说了一句“再撑一会”，随后就自顾自继续向前赶路。\n\n我们已经在沙暴里跋涉了多久？三个小时？还是五个小时？黄沙不停往衣物里涌，狂风则不停将沙尘甩在脸上，刮得眼睛都睁不开。但我们还不能停步，后面的萨卡兹雇佣兵还在紧追不舍，他们尽职尽责，即使是沙暴都阻挡不了他们的脚步。\n\n至于水……或许早就喝完了吧。\n\n听说沙漠里有在空水壶中灌沙来给人以希望的传统，可现在，沙子我已经喝够了，水，我只想喝口水，哪怕用身上所有的硬币去换，我也愿意。\n\n只是在这荒野里，闪亮的金属毫无意义。\n\n紧紧抱着银色的手提箱，我咬紧牙关继续迈步。\n\n耳边都是凄厉的呼啸，像是亡者的哭号，又像是鬼魂的呼唤。索恩教授或许也在其中，呼唤着我的名字？\n\n但我听不太清了。\n\n脑中满是这样的响声，已经多久了？三分钟？三小时？还是三年？\n\n沙尘遮蔽了天空，白天和黑夜已经毫无区别，时间似乎都已凝滞，只有在其中求生的人们，还在忍受着此间种种刑罚。\n\n我只是想做研究，我只是想为科学进步奉献自己的力量，而不是像现在这样，倒在沙海里风干。\n\n脑袋又酸又胀又痛，身体好像早就没了知觉，我是在行走吗，还是在看着这具名为艾利奥特的躯壳蠕动？\n\n不……思考也成为了一种奢求，现在徘徊在脑袋里的，只有一个指令：移动。\n\n移动……移动……移动……\n\n……但沙海是无垠的。\n\n“艾利奥特，张嘴。”\n\n张嘴？\n\n我下意识地放松肌肉，让嘴唇和牙齿露出一条通往口腔的通道。\n\n一串沾满沙土的果实落到了口中。\n\n有些酸涩？有些甘甜？哦，是水，是水。\n\n是水啊。\n\n……\n\n不知从什么时候开始，耳边再也没有风声，大地回复了寂静，只有阳光，沙漠，和两个在沙丘间徒步的凡人。\n\n……\n\n我望向远方，除了黄沙，还是黄沙。\n\n一眼望不到尽头，就像散落满地又被浸湿的皮鞋踩上几脚的技术文件，再也归不拢，再也理不齐。\n\n我忿忿地踢了一脚沙子，看着它们从沙丘尖端翻滚滑落，然后重新融到沙漠中，好似什么都没有发生过。\n\n沙子，沙子。\n\n我生平第一次开始痛恨沙子。\n\n“走吧，很快就能获得补给了。”\n\n凯尔希打断了我的思绪。\n\n可，很快？能有多快？\n\n一些补给？又有多少呢？\n\n呵，凯尔希从来不向人许诺希望。\n\n但至少……\n\n我似乎看见了一颗仙人掌。", "description": "## 我们在题目描述的最下方提供了形式化题意，若您不想阅读整活部分可以直接跳到题目描述的最下方。\n\n神在猩红剧团的探索中取回了自己一部分的力量，不多，但够用。\n\n神见到了傀影。准备使用辉煌裂片对他进行审判。\n\n但是傀影躲进了一个被分成 $d$ 层的 DAG 中。\n\n具体地，DAG 上第 $i$ 层的节点只会连向第 $i+1$ 层的节点。\n\n“那就陪你继续玩玩吧。”神心想。\n\n神决定了一种审判的方式。\n\n具体地，神最开始有一些辉煌裂片。神认为，多项式具有强大的力量，所以辉煌裂片就是多项式。~~我才不告诉你是我懒得编题面。~~\n\n神有三种对辉煌裂片的操作：\n\n1. “无度”\n\n可以让辉煌裂片更加强大。具体地，对 $F(x)$ 进行这个操作就相当于令 $F(x)=F^2(x)$。\n\n2. “文明的存续”\n\n可以让“无度”后的辉煌裂片更加强大。具体地，对 $F(x)$ 进行这个操作就相当于令 $F(x)=F(x^2)$。\n\n3. “夜骇”\n\n可以让两个辉煌裂片进行融合，变得更加强大。具体地，如果对 $F(x)$ 和 $G(x)$ 进行这个操作会返回一个多项式为 $F(x)+G(x)$。\n\n神决定这样对傀影进行审判：\n\n在第一层的节点放置辉煌裂片。\n\n当辉煌裂片进入一个节点前，对自身进行“无度”。\n\n当两个辉煌裂片相遇，对这两个辉煌裂片进行“夜骇”，只会留下一个辉煌裂片为这两个辉煌裂片进行“夜骇”的结果。\n\n辉煌裂片只会在连接该节点的所有边都有辉煌裂片通过后，才会离开该节点。当辉煌裂片离开一个节点时，辉煌裂片会对进行“文明的存续”，然后分裂成若干个和原辉煌裂片相同的辉煌裂片，留下一个辉煌裂片在该节点。然后，每条边都将通过恰好一个辉煌裂片。\n\n若傀影在节点 $u$，而神有一个审判指数（execution points，EXP）$k$，该节点留下的辉煌裂片为 $F_u(x)$，那么傀影将会受到 $F_u(k)$ 伏特的电流。\n\n现在神有一些提问。每个提问类似于，若傀影藏在节点 $u$，且审判指数为 $k$，那么傀影将会受到多少伏特的电流？\n\n神是怜悯的。答案可能过大，他只要求你输出答案对 $7340033(2^{20}\\times7+1)$（一个质数）取模后的结果。\n### 形式化题意\n给你一张分为 $d$ 层的 DAG，每个节点都有一个多项式 $F_u(x)$。**可能会有重边。**\n\n这个 DAG 上第 $i$ 层的节点只会向第 $i+1$ 层的节点连边。\n\n若 $S_u$ 包含所有连向点 $u$ 的节点，那么满足 $F_u(x)=\\sum_{v \\in S_u}F_v^2(x^2)$。\n\n给出第一层节点的多项式，每次询问会给你 $u,k$，然后询问 $F_u(k)$ 对 $7340033(2^{20}\\times7+1)$（一个质数）取模后的结果。\n\n**请注意，重边算作一条边。**", "inputFormat": "第一行一个整数 $d$，表示 DAG 的层数。\n\n接下来一行会有 $d$ 个整数，第 $i$ 个数 $n_i$ 表示第 $i$ 层有 $n_i$ 个节点。\n\n接下来 $n_1$ 行，第 $i$ 行有若干个数表示第一层的 $i$ 号节点的多项式。\n\n具体地，每行第一个数 $p$ 表示多项式的最高次，接下来 $p+1$ 个数表示这个多项式的系数，若其中第 $i$ 个数（不包括 $p$）为 $f_{i-1}$，那么该多项式为 $\\sum_{i=0}^pf_ix^i$。\n\n接下来的输入分为 $d$ 段。第 $i$ 段的开头有两个数 $m,q$ 表示第 $i$ 层有 $m$ 条边，以及神在第 $i$ 层的点中有 $q$ 个询问。\n\n接下来 $m$ 行，每行两个数 $u,v$ 表示第 $i$ 层编号为 $u$ 的点连接了第 $i+1$ 层编号为 $v$ 的点。\n\n接下来 $q$ 行每行两个整数 $u,k$ 表示神询问当傀影在第 $i$ 层编号为 $u$ 的节点上时，且审判指数为 $k$ 时，傀影受到电流的伏特对 $7340033$ 取模后的结果。", "outputFormat": "由于输出可能过大，你需要对输出加密。\n\n具体地，对于第 $k$ 层的询问，若第 $i$ 个询问的答案为 $a_i$，你只需要输出 $(k \\times \\bigoplus_{i=1}^q(q-i) \\times a_i)\\bmod 2^{32}$ 即可。\n\n请注意，输出一共 $d$ 行，每行一个数字。", "hint": "- Subtask1（7pts）$1\\leq d\\leq 2$。\n- Subtask2（20pts）$1\\leq d\\leq 10,\\sum q=1$。\n- Subtask3（13pts）$n_1=2$，且时间限制为 5s。\n- Subtask4（60pts）无特殊限制。\n- Subtack5（0pts）Hack 数据。\n\n对于 $ 100\\% $ 的数据，满足 $1\\leq\\sum n<5060$，$1\\leq d\\leq 10$，$\\sum q\\leq 1.5 \\times 10^6$，$1\\leq w,k<7340033$，$0 \\leq p \\leq 2$。\n\n若第 $i$ 层有 $m_i$ 条边，对于 $i\\neq d$ 保证有 $n_i<n_{i+1}\\leq2\\times n_i$ 和 $n_i\\leq m_i\\leq 3\\times n_i$，且 $m_d=0,1 \\leq n_1 \\leq 5$。", "locale": "zh-CN"}}}
{"pid": "P8324", "type": "P", "difficulty": 2, "samples": [["3\nA+B->AB\nAB+CD->AC+DB\nAB+B->AB", "DA\nDA\nNE"], ["2\n2AB+A->3AB\n2AB+2AC+2BC->4ABC", "NE\nDA"], ["4\n2H2O+2CO2->2H2CO3\nH2SO4->H2O4\nNH3+H2SO4->NH4SO4\nCH4+2O2->CO2+2H2O", "DA\nNE\nNE\nDA"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "COCI（克罗地亚）"], "title": "[COCI 2021/2022 #5] Kemija", "background": "", "description": "给定 $n$ 个化学方程式。\n\n每个参与反应的分子由若干个原子组成，每个原子由一个字母和一个数字表示，分别代表元素名称和分子中该原子的数量。如果多个分子参与反应，则分子前添加一个数字表示化学计量数。本题中只需考虑每一原子的数量，而不必考虑方程式的合理性。例如，$\\texttt{3AC4B}$ 可以直接视为 $3$ 个 $\\texttt A$、$3$ 个 $\\texttt B$ 和 $12$ 个 $\\texttt C$ 参与反应。当有不同分子位于方程式同一边时，用 $\\texttt +$ 连接。\n\n你的任务是分别检查每个方程式是否已经配平（只需考虑左右原子数量是否都对应相等）。", "inputFormat": "第一行一个正整数 $n$，表示方程式的个数。\n\n接下来的 $n$ 行，每行一个方程式。数据保证每个方程式字符串长度不超过 $1000$，且每个元素都只包含一个大写字母。", "outputFormat": "对于每个方程式，如果已经配平则输出 $\\texttt{DA}$，否则输出 $\\texttt{NE}$。", "hint": "**【样例 3 解释】**\n\n|序号|左侧原子|右侧原子|结果|\n| :----------: | :----------: | :----------: | :----------: |\n|$1$|$4 \\times \\texttt H, 6 \\times \\texttt O, 2 \\times \\texttt C$|$4 \\times \\texttt H, 6 \\times \\texttt O, 2 \\times \\texttt C$|$\\green{\\texttt{DA}}$|\n|$2$|$2 \\times \\texttt H, \\red{1 \\times \\texttt S}, 4 \\times \\texttt O$|$2 \\times \\texttt H, 4 \\times \\texttt O$|$\\red{\\texttt{NE}}$|\n|$3$|$1 \\times \\texttt N, \\red{5 \\times \\texttt H}, 1 \\times \\texttt S, 4 \\times \\texttt O$|$1 \\times \\texttt N, \\red{4 \\times \\texttt H}, 1 \\times \\texttt S, 4 \\times \\texttt O$|$\\red{\\texttt{NE}}$|\n|$4$|$1 \\times \\texttt C, 4 \\times \\texttt H, 4 \\times \\texttt O$|$1 \\times \\texttt C, 4 \\times \\texttt H, 4 \\times \\texttt O$|$\\green{\\texttt{DA}}$|\n\n**【数据规模与约定】**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（10 pts）：方程式中均不含数字。\n- Subtask 2（10 pts）：分子式中均不含数字。\n- Subtask 3（30 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 1000$。\n\n**【来源】[COCI 2021-2022#5](https://hsin.hr/coci/contest5_tasks.pdf) Task 1 Kemija。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2021/2022 #5] Kemija", "background": "", "description": "给定 $n$ 个化学方程式。\n\n每个参与反应的分子由若干个原子组成，每个原子由一个字母和一个数字表示，分别代表元素名称和分子中该原子的数量。如果多个分子参与反应，则分子前添加一个数字表示化学计量数。本题中只需考虑每一原子的数量，而不必考虑方程式的合理性。例如，$\\texttt{3AC4B}$ 可以直接视为 $3$ 个 $\\texttt A$、$3$ 个 $\\texttt B$ 和 $12$ 个 $\\texttt C$ 参与反应。当有不同分子位于方程式同一边时，用 $\\texttt +$ 连接。\n\n你的任务是分别检查每个方程式是否已经配平（只需考虑左右原子数量是否都对应相等）。", "inputFormat": "第一行一个正整数 $n$，表示方程式的个数。\n\n接下来的 $n$ 行，每行一个方程式。数据保证每个方程式字符串长度不超过 $1000$，且每个元素都只包含一个大写字母。", "outputFormat": "对于每个方程式，如果已经配平则输出 $\\texttt{DA}$，否则输出 $\\texttt{NE}$。", "hint": "**【样例 3 解释】**\n\n|序号|左侧原子|右侧原子|结果|\n| :----------: | :----------: | :----------: | :----------: |\n|$1$|$4 \\times \\texttt H, 6 \\times \\texttt O, 2 \\times \\texttt C$|$4 \\times \\texttt H, 6 \\times \\texttt O, 2 \\times \\texttt C$|$\\green{\\texttt{DA}}$|\n|$2$|$2 \\times \\texttt H, \\red{1 \\times \\texttt S}, 4 \\times \\texttt O$|$2 \\times \\texttt H, 4 \\times \\texttt O$|$\\red{\\texttt{NE}}$|\n|$3$|$1 \\times \\texttt N, \\red{5 \\times \\texttt H}, 1 \\times \\texttt S, 4 \\times \\texttt O$|$1 \\times \\texttt N, \\red{4 \\times \\texttt H}, 1 \\times \\texttt S, 4 \\times \\texttt O$|$\\red{\\texttt{NE}}$|\n|$4$|$1 \\times \\texttt C, 4 \\times \\texttt H, 4 \\times \\texttt O$|$1 \\times \\texttt C, 4 \\times \\texttt H, 4 \\times \\texttt O$|$\\green{\\texttt{DA}}$|\n\n**【数据规模与约定】**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（10 pts）：方程式中均不含数字。\n- Subtask 2（10 pts）：分子式中均不含数字。\n- Subtask 3（30 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 1000$。\n\n**【来源】[COCI 2021-2022#5](https://hsin.hr/coci/contest5_tasks.pdf) Task 1 Kemija。**", "locale": "zh-CN"}}}
{"pid": "P8325", "type": "P", "difficulty": 3, "samples": [["7 25\n.#...#....#....#.....#...\n#.#..#...#.#...#....#.#..\n.#...#..#...#..#...#...#.\n.....#...#.#...#..#.....#\n.....#....#....#...#...#.\n.....#.........#....#.#..\n.....#.........#.....#...", "3"], ["11 17\n.....#........#..\n....#.#........#.\n...#...#....#...#\n..#.....#....#.#.\n.#....#..#....#..\n#....#.#..#......\n.#....#..#.......\n..#.....#........\n...#...#.........\n....#.#..........\n.....#...........", "1"], ["5 11\n##.#.#.#.##\n#.#.#.#.#.#\n.#.#.#.#.#.\n#.#.#.#.#.#\n##.#.#.#.##", "14"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "COCI（克罗地亚）"], "title": "[COCI 2021/2022 #5] Dijamant", "background": "", "description": "桌上摆放有若干颗『钻石』。\n\n当一个正方形旋转 $45^\\circ$ 时，它就形成了『菱形』的形状。规定外形形如『菱形』且外边框均为 $\\texttt \\#$ 但内部均为 $\\texttt .$ 的图形为一颗『钻石』。\n\n给定一个 $n \\times m$ 大小的桌面，统计桌上摆放有多少颗『钻石』。", "inputFormat": "第一行两个正整数 $n,m$，表示桌面的大小。\n\n接下来的 $n$ 行，每行 $m$ 个字符 $\\texttt \\#$ 或 $\\texttt .$，表示桌面。", "outputFormat": "『钻石』的数量。", "hint": "**【样例 2 解释】**\n\n看起来好像有 $3$ 颗，但实际上有两个『菱形』互相包含，因此不符合『外边框均为 $\\texttt \\#$ 但内部均为 $\\texttt .$』的定义。故只有 $1$ 颗『钻石』。\n\n**【数据规模与约定】**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（20 pts）：$1 \\le n,m \\le 100$。\n- Subtask 2（50 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n,m \\le 2000$。\n\n**【来源】[COCI 2021-2022#5](https://hsin.hr/coci/contest5_tasks.pdf) Task 2 Dijamant。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2021/2022 #5] Dijamant", "background": "", "description": "桌上摆放有若干颗『钻石』。\n\n当一个正方形旋转 $45^\\circ$ 时，它就形成了『菱形』的形状。规定外形形如『菱形』且外边框均为 $\\texttt \\#$ 但内部均为 $\\texttt .$ 的图形为一颗『钻石』。\n\n给定一个 $n \\times m$ 大小的桌面，统计桌上摆放有多少颗『钻石』。", "inputFormat": "第一行两个正整数 $n,m$，表示桌面的大小。\n\n接下来的 $n$ 行，每行 $m$ 个字符 $\\texttt \\#$ 或 $\\texttt .$，表示桌面。", "outputFormat": "『钻石』的数量。", "hint": "**【样例 2 解释】**\n\n看起来好像有 $3$ 颗，但实际上有两个『菱形』互相包含，因此不符合『外边框均为 $\\texttt \\#$ 但内部均为 $\\texttt .$』的定义。故只有 $1$ 颗『钻石』。\n\n**【数据规模与约定】**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（20 pts）：$1 \\le n,m \\le 100$。\n- Subtask 2（50 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n,m \\le 2000$。\n\n**【来源】[COCI 2021-2022#5](https://hsin.hr/coci/contest5_tasks.pdf) Task 2 Dijamant。**", "locale": "zh-CN"}}}
{"pid": "P8326", "type": "P", "difficulty": 6, "samples": [["4\n1 1 \\\n3 1 /\n3 2 \\\n1 2 /", "-1"], ["9\n1 2 \\\n1 3 /\n2 1 \\\n2 2 \\\n2 3 \\\n3 1 /\n3 2 \\\n4 2 /\n4 3 \\", "1 3 2 4 1 3 2 4 1"], ["12\n1 2 \\\n1 3 /\n2 1 \\\n2 2 \\\n2 3 \\\n2 4 /\n3 1 /\n3 2 \\\n3 3 \\\n3 4 \\\n4 2 /\n4 3 \\", "1 3 2 4 2 4 1 3 1 3 2 4"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "Special Judge", "COCI（克罗地亚）"], "title": "[COCI 2021/2022 #5] Fliper", "background": null, "description": "现有一个包含 $n$ 块挡板的旧弹球机。\n\n游戏在二维平面内进行，其中每块挡板与坐标轴所夹锐角总为 $45^\\circ$，长度为 $1$ 个单位。挡板用其中心坐标 $(x_i,y_i)$ 和字符 / 或 \\ 来表示。小球在碰到挡板后，其运动方向将会旋转 $90^\\circ$。注意，挡板的两面都可使小球的运动方向发生偏转。\n\n不难发现，当小球处于弹球机中时，它只有两种结局：\n\n- 沿着某一方向一直运动下去而不碰到挡板\n- 处于若干个挡板的循环之中\n\n在翻新弹球机的过程中，有四种颜色的染料可供选择。现要将弹球机中的每个挡板进行染色，使得**每一个**循环内经过每一种颜色的次数相同且为偶数。\n\n请给出一种符合题意的染色方式，或证明这样的染色方式不存在。如果不存在，输出 `-1`。", "inputFormat": "第一行一个正整数 $n$，表示挡板的数量。\n\n接下来的 $n$ 行，每行两个正整数 $x_i,y_i$ 和一个字符 $c_i$（/ 或 \\），表示一个挡板。数据保证，挡板的位置不会相互重合。", "outputFormat": "如果不存在符合题意的染色方式，输出 `-1`。\n\n否则输出 $n$ 个整数 $1 \\sim 4$，表示 $n$ 个挡板所选择的染料颜色。如果有多种符合题意的方式，输出任意一种。", "hint": "**【样例 2 图解】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ksajf2n4.png)\n\n**【数据规模与约定】**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（20 pts）：$1 \\le n \\le 40$。\n- Subtask 2（20 pts）：最多存在一个循环。\n- Subtask 3（70 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 5 \\times 10^5$，$0 \\le |x_i|,|y_i| \\le 10^9$。\n\n**【说明】**\n\n本题采用自行编写的 [Special Judge](https://www.luogu.com.cn/paste/g6cdziry)。如果对此有疑问或想要 hack，请[私信编写者](https://www.luogu.com.cn/chat?uid=137367)或[发帖](https://www.luogu.com.cn/discuss/lists?forumname=P8326)。\n\n**【来源】[COCI 2021-2022#5](https://hsin.hr/coci/archive/2021_2022/contest5_tasks.pdf) Task 3 Fliper。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2021/2022 #5] Fliper", "background": null, "description": "现有一个包含 $n$ 块挡板的旧弹球机。\n\n游戏在二维平面内进行，其中每块挡板与坐标轴所夹锐角总为 $45^\\circ$，长度为 $1$ 个单位。挡板用其中心坐标 $(x_i,y_i)$ 和字符 / 或 \\ 来表示。小球在碰到挡板后，其运动方向将会旋转 $90^\\circ$。注意，挡板的两面都可使小球的运动方向发生偏转。\n\n不难发现，当小球处于弹球机中时，它只有两种结局：\n\n- 沿着某一方向一直运动下去而不碰到挡板\n- 处于若干个挡板的循环之中\n\n在翻新弹球机的过程中，有四种颜色的染料可供选择。现要将弹球机中的每个挡板进行染色，使得**每一个**循环内经过每一种颜色的次数相同且为偶数。\n\n请给出一种符合题意的染色方式，或证明这样的染色方式不存在。如果不存在，输出 `-1`。", "inputFormat": "第一行一个正整数 $n$，表示挡板的数量。\n\n接下来的 $n$ 行，每行两个正整数 $x_i,y_i$ 和一个字符 $c_i$（/ 或 \\），表示一个挡板。数据保证，挡板的位置不会相互重合。", "outputFormat": "如果不存在符合题意的染色方式，输出 `-1`。\n\n否则输出 $n$ 个整数 $1 \\sim 4$，表示 $n$ 个挡板所选择的染料颜色。如果有多种符合题意的方式，输出任意一种。", "hint": "**【样例 2 图解】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ksajf2n4.png)\n\n**【数据规模与约定】**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（20 pts）：$1 \\le n \\le 40$。\n- Subtask 2（20 pts）：最多存在一个循环。\n- Subtask 3（70 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 5 \\times 10^5$，$0 \\le |x_i|,|y_i| \\le 10^9$。\n\n**【说明】**\n\n本题采用自行编写的 [Special Judge](https://www.luogu.com.cn/paste/g6cdziry)。如果对此有疑问或想要 hack，请[私信编写者](https://www.luogu.com.cn/chat?uid=137367)或[发帖](https://www.luogu.com.cn/discuss/lists?forumname=P8326)。\n\n**【来源】[COCI 2021-2022#5](https://hsin.hr/coci/archive/2021_2022/contest5_tasks.pdf) Task 3 Fliper。**", "locale": "zh-CN"}}}
{"pid": "P8327", "type": "P", "difficulty": 6, "samples": [["6 8\nS 1\nS 2\nS 3\nC 1 6\nS 6\nC 1 6\nS 2\nC 1 6", "NE\nDA\nDA"], ["11 6\nS 4\nS 10\nC 3 11\nC 2 7\nS 6\nC 2 7", "DA\nNE\nDA"], ["20 7\nS 10\nS 15\nS 3\nC 10 15\nS 10\nC 3 15\nC 3 10", "DA\nDA\nNE"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "COCI（克罗地亚）"], "title": "[COCI 2021/2022 #5] Radio", "background": "", "description": "克罗地亚有 $n$ 个初始状态下关闭的电台。当同时开启两个电台 $i,j$ 且 $i,j$ 不互质时，它们会互相干扰。\n\n你需要写一个支持下列操作的程序：\n\n1. `S x`：将电台的状态取反，即将原来开启的电台关闭，将原来关闭的开启。\n2. `C l r`：检查在 $[l,r]$ 内是否存在互相干扰的现象。如果存在，输出 `DA`，否则输出 `NE`。", "inputFormat": "第一行两个正整数 $n,q$，分别表示电台个数和操作次数。\n\n接下来的 $q$ 行，具体输入格式见题目描述。", "outputFormat": "对于每一次 C 操作，输出 `DA` 或者 `NE`。", "hint": "**【样例 1 解释】**\n\n|C 操作序号|开启电台|是否互相干扰|\n| :----------: | :----------: | :----------: |\n|$1$|$1,2,3$|否|\n|$2$|$1,2,3,6$|是|\n|$3$|$1,3,6$|是|\n\n**【数据规模与约定】**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（10 pts）：$1 \\le n \\le 100$，$1 \\le q \\le 200$。\n- Subtask 2（30 pts）：对于所有的 C 操作，$l=1,r=n$。\n- Subtask 3（70 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^6$，$1 \\le q \\le 2 \\times 10^5$，$1 \\le x \\le n$，$1 \\le l \\le r \\le n$。\n\n**【来源】[COCI 2021-2022#5](https://hsin.hr/coci/contest5_tasks.pdf) Task 4 Radio。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2021/2022 #5] Radio", "background": "", "description": "克罗地亚有 $n$ 个初始状态下关闭的电台。当同时开启两个电台 $i,j$ 且 $i,j$ 不互质时，它们会互相干扰。\n\n你需要写一个支持下列操作的程序：\n\n1. `S x`：将电台的状态取反，即将原来开启的电台关闭，将原来关闭的开启。\n2. `C l r`：检查在 $[l,r]$ 内是否存在互相干扰的现象。如果存在，输出 `DA`，否则输出 `NE`。", "inputFormat": "第一行两个正整数 $n,q$，分别表示电台个数和操作次数。\n\n接下来的 $q$ 行，具体输入格式见题目描述。", "outputFormat": "对于每一次 C 操作，输出 `DA` 或者 `NE`。", "hint": "**【样例 1 解释】**\n\n|C 操作序号|开启电台|是否互相干扰|\n| :----------: | :----------: | :----------: |\n|$1$|$1,2,3$|否|\n|$2$|$1,2,3,6$|是|\n|$3$|$1,3,6$|是|\n\n**【数据规模与约定】**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（10 pts）：$1 \\le n \\le 100$，$1 \\le q \\le 200$。\n- Subtask 2（30 pts）：对于所有的 C 操作，$l=1,r=n$。\n- Subtask 3（70 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^6$，$1 \\le q \\le 2 \\times 10^5$，$1 \\le x \\le n$，$1 \\le l \\le r \\le n$。\n\n**【来源】[COCI 2021-2022#5](https://hsin.hr/coci/contest5_tasks.pdf) Task 4 Radio。**", "locale": "zh-CN"}}}
{"pid": "P8328", "type": "P", "difficulty": 6, "samples": [["5 3\n4\n1 2\n2 3\n3 1\n5 3", "1\n1 1 0 0"], ["6 6\n4\n1 2\n3 2\n4 3\n5 6", "9\n1 0 1 1"], ["8 7\n7\n1 3\n2 1\n3 4\n5 6\n6 5\n6 7\n8 7", "5\n1 0 1 1 0 1 0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2021", "Special Judge", "COCI（克罗地亚）"], "title": "[COCI 2021/2022 #5] Usmjeravanje", "background": "", "description": "永无岛有两条河流。每条河流沿岸分布有若干个城市，其中城市数量分别为 $a,b$。\n\n对于位于同一条河流沿岸的 $i,j$ 两个城市，如果 $i \\lt j$，那么可以通过水路从城市 $i$ 到城市 $j$。\n\n永无岛的居民们已经决定修建 $m$ 条连接第一条河流的城市 $x_i$ 和第二条河流的城市 $y_i$ 的单向航线，但方向有待商榷。\n\n当两个城市之间可以通过水路或航线互相到达时，则称它们是连通的。在所有的城市中，存在若干个城市集合，使得集合中没有任何一对城市是连通的。请为每条航线选择一个方向，使得所有集合中包含元素最多的集合元素个数最少。", "inputFormat": "第一行两个正整数 $a,b$。\n\n第二行一个正整数 $m$。\n\n接下来的 $m$ 行，每行两个正整数 $x_i,y_i$，表示一条连接第一条河流的城市 $x_i$ 和第二条河流的城市 $y_i$ 的单向航线。数据保证没有重复的无序数对 $(x_i,y_i)$ 出现。", "outputFormat": "第一行一个正整数，表示最大集合元素个数的最小值。\n\n第二行 $m$ 个整数 $0$ 或 $1$。其中 $0$ 表示方向从第一条河流的城市 $x_i$ 到第二条河流的城市 $y_i$，$1$ 则相反。\n\n如果有多种符合题意的方案，输出任意一种。", "hint": "**【样例 1 解释】**\n\n最优的方案可以使得每对城市都连通，因此答案为 $1$。\n\n**【数据规模与约定】**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（20 pts）：$1 \\le a,b,m \\le 15$。\n- Subtask 2（30 pts）：$1 \\le a,b \\le 1000$。\n- Subtask 3（60 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le a,b,m \\le 2 \\times 10^5$，$1 \\le x_i \\le a$，$1 \\le y_i \\le b$。\n\n**【说明】**\n\n本题采用自行编写的 [Special Judge](https://www.luogu.com.cn/paste/uv2vgxxa)。如果对此有疑问或想要 hack，请[私信编写者](https://www.luogu.com.cn/chat?uid=137367)或发帖。\n\n**【来源】[COCI 2021-2022#5](https://hsin.hr/coci/contest5_tasks.pdf) Task 5 Usmjeravanje。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2021/2022 #5] Usmjeravanje", "background": "", "description": "永无岛有两条河流。每条河流沿岸分布有若干个城市，其中城市数量分别为 $a,b$。\n\n对于位于同一条河流沿岸的 $i,j$ 两个城市，如果 $i \\lt j$，那么可以通过水路从城市 $i$ 到城市 $j$。\n\n永无岛的居民们已经决定修建 $m$ 条连接第一条河流的城市 $x_i$ 和第二条河流的城市 $y_i$ 的单向航线，但方向有待商榷。\n\n当两个城市之间可以通过水路或航线互相到达时，则称它们是连通的。在所有的城市中，存在若干个城市集合，使得集合中没有任何一对城市是连通的。请为每条航线选择一个方向，使得所有集合中包含元素最多的集合元素个数最少。", "inputFormat": "第一行两个正整数 $a,b$。\n\n第二行一个正整数 $m$。\n\n接下来的 $m$ 行，每行两个正整数 $x_i,y_i$，表示一条连接第一条河流的城市 $x_i$ 和第二条河流的城市 $y_i$ 的单向航线。数据保证没有重复的无序数对 $(x_i,y_i)$ 出现。", "outputFormat": "第一行一个正整数，表示最大集合元素个数的最小值。\n\n第二行 $m$ 个整数 $0$ 或 $1$。其中 $0$ 表示方向从第一条河流的城市 $x_i$ 到第二条河流的城市 $y_i$，$1$ 则相反。\n\n如果有多种符合题意的方案，输出任意一种。", "hint": "**【样例 1 解释】**\n\n最优的方案可以使得每对城市都连通，因此答案为 $1$。\n\n**【数据规模与约定】**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（20 pts）：$1 \\le a,b,m \\le 15$。\n- Subtask 2（30 pts）：$1 \\le a,b \\le 1000$。\n- Subtask 3（60 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le a,b,m \\le 2 \\times 10^5$，$1 \\le x_i \\le a$，$1 \\le y_i \\le b$。\n\n**【说明】**\n\n本题采用自行编写的 [Special Judge](https://www.luogu.com.cn/paste/uv2vgxxa)。如果对此有疑问或想要 hack，请[私信编写者](https://www.luogu.com.cn/chat?uid=137367)或发帖。\n\n**【来源】[COCI 2021-2022#5](https://hsin.hr/coci/contest5_tasks.pdf) Task 5 Usmjeravanje。**", "locale": "zh-CN"}}}
{"pid": "P8329", "type": "P", "difficulty": 7, "samples": [["5 998244353\n", "1\n2\n12\n120\n"], ["见附件中的 tree/tree_ex2.in", "见附件中的 tree/tree_ex2.ans"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["各省省选", "2022", "浙江", "O2优化", "容斥原理"], "title": "[ZJOI2022] 树", "background": "一年一度的 ZJOI 又要举办了，但是老牌出题人九条可怜突然有急事要回趟英国。\n\n“就交给你们啦！一定没有问题 desu！”，说完可怜就跑远了。\n\n忍，爱丽丝，绫和阳子目送着远去的可怜，感到有点茫然，毕竞，ZJOI 只剩不到三星期了。\n\n既然是可怜酱留下的任务，那我们一定要努力完成了，毕竟我才是姐姐”，爱丽丝说。\n\n于是众人就开始热火朝天地出题了，“希望这是第一次也是最后一次了” 大家都不约而同地想。\n\n同时，题目主角就定为九条可怜了！", "description": "九条可怜是一个喜欢树的女孩子，她想生成两棵均有 $n$ 个节点的树。\n\n第一棵树的生成方式是：\n\n1. 节点 $1$ 作为树的根。\n2. 对于 $i \\in [2, n]$，从 $[1, i - 1]$ 中选取一个节点作为 $i$ 的父亲。\n\n第二棵树的生成方式是：\n\n1. 节点 $n$ 作为树的根。\n2. 对于 $i \\in [1, n - 1]$，从 $[i + 1, n]$ 中选取一个节点作为 $i$ 的父亲。\n\n九条可怜希望对于任意 $i \\in [1, n]$，若第一棵树中的节点 $i$ 为叶子，那么第二棵树中的节点 $i$ 为非叶子；若第一棵树中的节点 $i$ 为非叶子，那么第二棵树中的节点 $i$ 为叶子。一个节点被称为叶子当且仅当没有节点的父亲是它。\n\n九条可怜希望你统计生成两棵树的方案数是多少。具体地，你需要对于所有 $n \\in [2, N]$ 都计算方案数。两种方案不同当且仅当存在一棵树中的一个节点 $i$，两种方案中它的父亲不同。因为答案可能很大，你只需要输出答案对 $M$ 取模后的结果。", "inputFormat": "第一行输入两个整数 $N, M$，表示树的节点上限以及模数。", "outputFormat": "输出 $N - 1$ 行，每行一个整数。\n\n具体地，第 $i$ 行输出 $n = i + 1$ 时的答案对 $M$ 取模后的值。\n", "hint": "对于所有测试点：保证 $2 \\le N \\le 500$，$10 \\le M \\le 2^{30}$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | $N \\le$ | 特殊限制 |\n|:-:|:-:|:-:|\n| $1$ | $10$ | 无 |\n| $2$ | $20$ | 保证 $M$ 为质数 |\n| $3$ | $50$ | 无 |\n| $4$ | $50$ | 保证 $M$ 为质数 |\n| $5$ | $100$ | 无 |\n| $6$ | $100$ | 保证 $M$ 为质数 |\n| $7$ | $500$ | 无 |\n| $8$ | $500$ | 保证 $M$ 为质数 |\n| $9$ | $500$ | 无 |\n| $10$ | $500$ | 保证 $M$ 为质数 |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[ZJOI2022] 树", "background": "一年一度的 ZJOI 又要举办了，但是老牌出题人九条可怜突然有急事要回趟英国。\n\n“就交给你们啦！一定没有问题 desu！”，说完可怜就跑远了。\n\n忍，爱丽丝，绫和阳子目送着远去的可怜，感到有点茫然，毕竞，ZJOI 只剩不到三星期了。\n\n既然是可怜酱留下的任务，那我们一定要努力完成了，毕竟我才是姐姐”，爱丽丝说。\n\n于是众人就开始热火朝天地出题了，“希望这是第一次也是最后一次了” 大家都不约而同地想。\n\n同时，题目主角就定为九条可怜了！", "description": "九条可怜是一个喜欢树的女孩子，她想生成两棵均有 $n$ 个节点的树。\n\n第一棵树的生成方式是：\n\n1. 节点 $1$ 作为树的根。\n2. 对于 $i \\in [2, n]$，从 $[1, i - 1]$ 中选取一个节点作为 $i$ 的父亲。\n\n第二棵树的生成方式是：\n\n1. 节点 $n$ 作为树的根。\n2. 对于 $i \\in [1, n - 1]$，从 $[i + 1, n]$ 中选取一个节点作为 $i$ 的父亲。\n\n九条可怜希望对于任意 $i \\in [1, n]$，若第一棵树中的节点 $i$ 为叶子，那么第二棵树中的节点 $i$ 为非叶子；若第一棵树中的节点 $i$ 为非叶子，那么第二棵树中的节点 $i$ 为叶子。一个节点被称为叶子当且仅当没有节点的父亲是它。\n\n九条可怜希望你统计生成两棵树的方案数是多少。具体地，你需要对于所有 $n \\in [2, N]$ 都计算方案数。两种方案不同当且仅当存在一棵树中的一个节点 $i$，两种方案中它的父亲不同。因为答案可能很大，你只需要输出答案对 $M$ 取模后的结果。", "inputFormat": "第一行输入两个整数 $N, M$，表示树的节点上限以及模数。", "outputFormat": "输出 $N - 1$ 行，每行一个整数。\n\n具体地，第 $i$ 行输出 $n = i + 1$ 时的答案对 $M$ 取模后的值。\n", "hint": "对于所有测试点：保证 $2 \\le N \\le 500$，$10 \\le M \\le 2^{30}$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | $N \\le$ | 特殊限制 |\n|:-:|:-:|:-:|\n| $1$ | $10$ | 无 |\n| $2$ | $20$ | 保证 $M$ 为质数 |\n| $3$ | $50$ | 无 |\n| $4$ | $50$ | 保证 $M$ 为质数 |\n| $5$ | $100$ | 无 |\n| $6$ | $100$ | 保证 $M$ 为质数 |\n| $7$ | $500$ | 无 |\n| $8$ | $500$ | 保证 $M$ 为质数 |\n| $9$ | $500$ | 无 |\n| $10$ | $500$ | 保证 $M$ 为质数 |", "locale": "zh-CN"}}}
{"pid": "P8330", "type": "P", "difficulty": 7, "samples": [["4\n5\n1 2 3 2 1\n5\n1 1 3 1 1\n6\n2 4 2 4 8 8\n5\n1 2 3 4 5\n", "4\n1\n5\n1\n4\n2\n4\n8\n2\n1\n2\n3\n4\n5\n"], ["见附件中的 mode/mode_ex2.in", "见附件中的 mode/mode_ex2.ans"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["各省省选", "2022", "浙江", "O2优化", "根号分治"], "title": "[ZJOI2022] 众数", "background": "", "description": "九条可怜是一个有超能力的女孩子，但她的超能力只能作用于一些奇怪的事情上。\n\n有一天，可怜得到了一个序列 $a_1, a_2, \\ldots, a_n$，她可以对这个序列使用一次超能力: 选择一个区\n间 $[l, r]$（$1 \\le l \\le r \\le n$）和一个整数 $k \\in [-{10}^9, {10}^9]$，将区间内的所有数 $a_l, a_{l + 1}, \\ldots, a_r$ 加上 $k$。\n\n九条可怜很喜欢长得比较一致的序列，因此她希望最终的序列众数的出现次数尽可能多。给出序列 $a$，你需要输出最终序列的众数出现次数的最大值，并输出这个众数的所有可能取值。注意对于一个序列，众数的取值可能不止一个。", "inputFormat": "输入包含多组数据，第一行输入数据组数 $T$。\n\n对于接下来的每组数据，第一行输入序列长度 $n$，第二行包含 $n$ 个整数 $a_1, a_2, \\ldots, a_n$。", "outputFormat": "对于每组数据，第一行输出最终序列众数的出现次数的最大值。\n\n假设这个众数有 $k$ 种不同的可能取值，则接下来 $k$ 行，从小到大输出这些取值。", "hint": "对于所有测试点：$1 \\le T \\le 20$，$2 \\le n \\le 2 \\times {10}^5$，$1 \\le a_i \\le {10}^9$，保证 $\\sum n \\le 5 \\times {10}^5$，且 $a_i$ 不全相等。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | $\\sum n \\le$ | $n \\le$ | 特殊限制 |\n|:-:|:-:|:-:|:-:|\n| $1 \\sim 4$ | $3000$ | $300$ | 无 |\n| $5 \\sim 8$ | $5 \\times {10}^5$ | $2 \\times {10}^5$ | $a_i$ 只有 $5$ 种取值 |\n| $9 \\sim 10$ | $2 \\times {10}^5$ | $50000$ | 无 |\n| $11 \\sim 20$ | $5 \\times {10}^5$ | $2 \\times {10}^5$ | 无 |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[ZJOI2022] 众数", "background": "", "description": "九条可怜是一个有超能力的女孩子，但她的超能力只能作用于一些奇怪的事情上。\n\n有一天，可怜得到了一个序列 $a_1, a_2, \\ldots, a_n$，她可以对这个序列使用一次超能力: 选择一个区\n间 $[l, r]$（$1 \\le l \\le r \\le n$）和一个整数 $k \\in [-{10}^9, {10}^9]$，将区间内的所有数 $a_l, a_{l + 1}, \\ldots, a_r$ 加上 $k$。\n\n九条可怜很喜欢长得比较一致的序列，因此她希望最终的序列众数的出现次数尽可能多。给出序列 $a$，你需要输出最终序列的众数出现次数的最大值，并输出这个众数的所有可能取值。注意对于一个序列，众数的取值可能不止一个。", "inputFormat": "输入包含多组数据，第一行输入数据组数 $T$。\n\n对于接下来的每组数据，第一行输入序列长度 $n$，第二行包含 $n$ 个整数 $a_1, a_2, \\ldots, a_n$。", "outputFormat": "对于每组数据，第一行输出最终序列众数的出现次数的最大值。\n\n假设这个众数有 $k$ 种不同的可能取值，则接下来 $k$ 行，从小到大输出这些取值。", "hint": "对于所有测试点：$1 \\le T \\le 20$，$2 \\le n \\le 2 \\times {10}^5$，$1 \\le a_i \\le {10}^9$，保证 $\\sum n \\le 5 \\times {10}^5$，且 $a_i$ 不全相等。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | $\\sum n \\le$ | $n \\le$ | 特殊限制 |\n|:-:|:-:|:-:|:-:|\n| $1 \\sim 4$ | $3000$ | $300$ | 无 |\n| $5 \\sim 8$ | $5 \\times {10}^5$ | $2 \\times {10}^5$ | $a_i$ 只有 $5$ 种取值 |\n| $9 \\sim 10$ | $2 \\times {10}^5$ | $50000$ | 无 |\n| $11 \\sim 20$ | $5 \\times {10}^5$ | $2 \\times {10}^5$ | 无 |", "locale": "zh-CN"}}}
{"pid": "P8331", "type": "P", "difficulty": 7, "samples": [["5 5 6\n1 2 10\n2 3 2\n2 4 5\n2 5 4\n4 5 3\n1 5\n2 5\n3 5\n3 4\n4 5\n4 4\n", "32\n12\n16\n16\n12\n0\n"], ["见附件中的 simple/simple_ex2.in", "见附件中的 simple/simple_ex2.ans"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["各省省选", "2022", "浙江", "O2优化"], "title": "[ZJOI2022] 简单题", "background": "", "description": "九条可怜是一个喜欢出简单题的女孩子。顾名思义，简单题就是题目里面出现了很多 “简单”。\n\n可怜首先给出一张简单连通无向图，每条边有一个正整数边权。特别地，可怜保证图上任意两个简单环的边权和相等。\n\n后来可怜想要隐藏图里美好的性质，她将其中一部分边的权值改成了新的权值。因此，修改之后原本美好的性质可能就不存在了。\n\n现在她给出修改后的图，同时给出多组询问，每次询问两点 $S, T$ 间所有简单路径权值和。因为答案可能很大，你只需要输出答案对 $998244353$ 取模的结果。\n\n具体地，简单图指不存在重边和自环，简单环和简单路径指不包含重复节点。", "inputFormat": "第一行读入三个整数 $n, m, q$。\n\n接下来 $m$ 行，每行三个整数 $u, v, w$，代表一条权值为 $w$ 的无向边 $(u, v)$。\n\n接下来 $q$ 行，读入 $q$ 组询问，每组询问读入一行两个整数 $S, T$。", "outputFormat": "对于每个询问，输出一行一个整数代表答案对 $998244353$ 取模后的结果。", "hint": "对于所有测试点，满足 $1 \\le n, q \\le 5 \\times {10}^5$，$n - 1 \\le m \\le 6.4 \\times {10}^5$，$1 \\le u, v, S, T \\le n$，$1 \\le w \\le {10}^6$，无重边自环，图连通。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | 特殊限制 1 | 特殊限制 2 |\n|:-:|:-:|:-:|\n| $1$ | $m < n$ | 保证存在经过所有点的简单路径 |\n| $2$ | $m < n$ | 无 |\n| $3 \\sim 5$ | 任意一个点不在 $\\ge 2$ 个简单环上 | 保证存在经过所有点的简单路径 |\n| $6 \\sim 8$ | 任意一个点不在 $\\ge 2$ 个简单环上 | 无 |\n| $9 \\sim 14$ | 无 | 保证存在经过所有点的简单路径 |\n| $15 \\sim 20$ | 无 | 无 |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[ZJOI2022] 简单题", "background": "", "description": "九条可怜是一个喜欢出简单题的女孩子。顾名思义，简单题就是题目里面出现了很多 “简单”。\n\n可怜首先给出一张简单连通无向图，每条边有一个正整数边权。特别地，可怜保证图上任意两个简单环的边权和相等。\n\n后来可怜想要隐藏图里美好的性质，她将其中一部分边的权值改成了新的权值。因此，修改之后原本美好的性质可能就不存在了。\n\n现在她给出修改后的图，同时给出多组询问，每次询问两点 $S, T$ 间所有简单路径权值和。因为答案可能很大，你只需要输出答案对 $998244353$ 取模的结果。\n\n具体地，简单图指不存在重边和自环，简单环和简单路径指不包含重复节点。", "inputFormat": "第一行读入三个整数 $n, m, q$。\n\n接下来 $m$ 行，每行三个整数 $u, v, w$，代表一条权值为 $w$ 的无向边 $(u, v)$。\n\n接下来 $q$ 行，读入 $q$ 组询问，每组询问读入一行两个整数 $S, T$。", "outputFormat": "对于每个询问，输出一行一个整数代表答案对 $998244353$ 取模后的结果。", "hint": "对于所有测试点，满足 $1 \\le n, q \\le 5 \\times {10}^5$，$n - 1 \\le m \\le 6.4 \\times {10}^5$，$1 \\le u, v, S, T \\le n$，$1 \\le w \\le {10}^6$，无重边自环，图连通。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | 特殊限制 1 | 特殊限制 2 |\n|:-:|:-:|:-:|\n| $1$ | $m < n$ | 保证存在经过所有点的简单路径 |\n| $2$ | $m < n$ | 无 |\n| $3 \\sim 5$ | 任意一个点不在 $\\ge 2$ 个简单环上 | 保证存在经过所有点的简单路径 |\n| $6 \\sim 8$ | 任意一个点不在 $\\ge 2$ 个简单环上 | 无 |\n| $9 \\sim 14$ | 无 | 保证存在经过所有点的简单路径 |\n| $15 \\sim 20$ | 无 | 无 |", "locale": "zh-CN"}}}
{"pid": "P8332", "type": "P", "difficulty": 7, "samples": [["0 2 13\n4 2 1 3\n1 4 2 3\n6 2 3 3\n6 2 5 3 1 4\n", "5\n499122191\n"], ["见附件中的 noodle/noodle_ex2.in", "见附件中的 noodle/noodle_ex2.ans"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["各省省选", "2022", "浙江", "O2优化"], "title": "[ZJOI2022] 面条", "background": "忍，爱丽丝，绫和阳子一众千辛万苦地总算出好了第一试，按原先计划，可怜会出第二试。\n\n“不好了，可怜给我发信息说她降落后被拉去隔离 30 天了，没有电脑，出不了题”，绫突然收到了不幸的消息。\n\n“那咋办？没 idea 了，编不出来了啊！” 众人慌作一团。\n\n看了看日期，离 ZJOI 还有一周。\n\n欲知后事如何，请看下回分解。", "description": "九条可怜是一个喜欢吃拉面的女孩子。\n\n有一天她去吃拉面，她发现拉面师傅为她拉的是一个长度为 $n$ 的面条，$n$ 保证是偶数，一开始第 $i$ 个位置调料的数量是 $a_i$。\n\n如下过程称为一次 “拉面”：\n\n1. 将面条对折，面条的长度会变成 $\\frac{n}{2}$，第 $i$ 个位置的调料数量会变为原来第 $i$ 个位置的调料与第 $n - i + 1$ 个位置的调料数量之和，如果新面条第 $i$ 个位置的调料数量为 $b_i$，那么满足 $b_i = a_i + a_{n - i + 1}$。\n2. 将面条拉回原来的长度 $n$，每个位置会变为两个位置，并且调料数量会均分，如果现在的第 $i$ 个位置的调料数量是 $a'_i$，那么 $a'_i = \\frac{1}{2} \\times b_{\\left\\lceil \\frac{i}{2} \\right\\rceil}$。\n\n现在对于一个固定的 $x$，你需要回答 $q$ 个询问，每次面条经过 $k$ 次 “拉面” 后，第 $x$ 个位置的调料数量。你只需要求出答案对 $998244353$ 取模的结果。具体地，即如果答案的最简分数表示为 $\\frac{a}{b}$，输出 $a \\times b^{-1} \\bmod 998244353$。", "inputFormat": "第一行输入三个正整数 $test, T, seed$，代表测试点编号，数据组数和生成种子。\n\n接下来输入 $T$ 组数据，每组数据包含两行。\n\n第一行输入四个正整数 $n, q, x, k_{\\mathrm{max}}$，代表这组数据中面条的长度，询问的个数，询问的位置和生成询问中 $k$ 的上限。\n\n第二行输入 $n$ 个非负整数，第 $i$ 个整数 $a_i$ 代表初始面条第 $i$ 个位置的调料数量。\n\n为了避免大量的输入与输出，$q$ 个询问由我们提供的一个生成器生成。具体地，我们提供一个由 C++ 书写的代码框架 `noodle_template.cpp` 供选手使用，见附录，同时在这里我们做一定量的说明：\n\n首先我们从数据中依次读入两个 $32$ 位整型变量 $\\mathit{test}, T$，一个无符号 $64$ 位长整型变量 $\\mathit{seed}$。接下来循环 $T$ 次，代表 $T$ 组数据。\n\n在每次循环中，我们对一组数据进行计算。首先依次读入三个 $32$ 位整型变量 $n, q, x$，一个 $64$ 位整型变量 $k_{\\mathrm{max}}$。接下来读入 $n$ 个 $32$ 位整型变量放入数组 $a_1, \\ldots, a_n$ 中。\n\n接下来是生成 $q$ 个询问的部分，每次调用 `rd()` 函数，将 $\\mathit{seed}$ 作为引用参数传入，将返回值（返回值为无符号 $64$ 位长整型）对 $k_{\\mathrm{max}}$ 取模的结果作为该次询问的参数 $k$，注意到 $\\mathit{seed}$ 也会被修改。", "outputFormat": "输出 $T$ 行，每行一个整数代表该组数据的答案。具体地，假设该组数据有 $q$ 个询问，令第 $i$ 个询问的答案为 $\\mathrm{Ans}_i$，那么需要你输出 $\\bigoplus_{i = 1}^q (\\mathrm{Ans}_i \\cdot i)$，**注意这里不需要取模**。$\\bigoplus$ 指按位异或运算符。", "hint": "**【样例解释 #1】**\n\n第一组测试数据中，$\\{ a_i \\}$ 初始为 $\\{ 1, 4, 2, 3 \\}$。  \n操作一次后为 $\\{ 2, 2, 3, 3 \\}$。  \n操作两次后为 $\\{ \\frac{5}{2}, \\frac{5}{2}, \\frac{5}{2}, \\frac{5}{2} \\}$。\n\n其中生成询问为：  \n询问位置：$x = 1$；  \n第一个询问：$k = 0$，$a_x = 1$；  \n第二个询问：$k = 1$，$a_x = 2$；  \n答案为 $(1 \\times 1) \\oplus (2 \\times 2) = 4 \\oplus 1 = 5$。\n\n第二组测试数据中，$\\{ a_i \\}$ 初始为 $\\{ 6, 2, 5, 3, 1, 4 \\}$。  \n操作一次后为 $\\{ 5, 5, \\frac{3}{2}, \\frac{3}{2}, 4, 4 \\}$。  \n操作两次后为 $\\{ \\frac{9}{2}, \\frac{9}{2}, \\frac{9}{2}, \\frac{9}{2}, \\frac{3}{2}, \\frac{3}{2} \\}$。\n\n其中生成询问为：  \n询问位置：$x = 3$；  \n第一个询问 $k = 2$，$a_x = \\frac{9}{2}$，$\\frac{9}{2} \\equiv 499122181 \\pmod{998244353}$；  \n第二个询问 $k = 0$，$a_x = 5$；  \n答案为 $(499122181 \\times 1) \\oplus (5 \\times 2) = 499122181 \\oplus 10 = 499122191$。\n\n**【数据范围】**\n\n对于所有测试点：保证 $T \\le 10$，$\\sum n \\le 2 \\times {10}^6$，$\\sum q \\le 5 \\times {10}^7$，$k_{\\mathrm{max}} \\le {10}^{18}$，$1 \\le x \\le n$，$0 \\le a_i < 998244353$，$0 \\le \\mathit{seed} \\le 2^{60} - 1$，保证 $n$ 是偶数。\n\n注意，对于样例，测试点编号 $\\mathit{test}$ 为 $0$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | $\\sum n \\le$ | $\\sum q \\le$ | $k_{\\mathrm{max}} \\le $ | 特殊限制 |\n|:-:|:-:|:-:|:-:|:-:|\n| $1$ | $500$ | $500$ | $500$ | 无 |\n| $2$ | $2 \\times {10}^6$ | $2 \\times {10}^6$ | $10$ | 无 |\n| $3$ | $2 \\times {10}^6$ | $2 \\times {10}^6$ | ${10}^{18}$ | $n = 2^k$ |\n| $4$ | $50$ | $50$ | ${10}^{18}$ | 无 |\n| $5 \\sim 6$ | $150$ | $150$ | ${10}^{18}$ | 无 |\n| $7$ | $2 \\times {10}^6$ | $2 \\times {10}^6$ | ${10}^{18}$ | $n = 98304$ |\n| $8 \\sim 9$ | $500$ | $500$ | ${10}^{18}$ | 无 |\n| $10 \\sim 11$ | $5 \\times {10}^3$ | $2 \\times {10}^6$ | ${10}^{18}$ | 无 |\n| $12 \\sim 13$ | $2 \\times {10}^6$ | $50$ | ${10}^{18}$ | 无 |\n| $14 \\sim 16$ | ${10}^6$ | ${10}^5$ | ${10}^{18}$ | 无 |\n| $17 \\sim 18$ | $2 \\times {10}^6$ | $2 \\times {10}^7$ | ${10}^{18}$ | 无 |\n| $19 \\sim 20$ | $2 \\times {10}^6$ | $5 \\times {10}^7$ | ${10}^{18}$ | 无 |\n\n**【附录】**\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nunsigned long long rd (unsigned long long &x) {\n\tx ^= (x << 13);\n\tx ^= (x >> 7);\n\tx ^= (x << 17);\n\treturn x;\n}\n\nint main () {\n\tint test, T;\n\tunsigned long long seed;\n\tscanf(\"%d%d%llu\", &test, &T, &seed);\n\tfor (int Case = 1; Case <= T; Case ++) {\n\t\tint n, q, x;\n\t\tlong long k_max;\n\t\tscanf(\"%d%d%d%lld\", &n, &q, &x, &k_max);\n\t\tvector<int> a(n + 1);\n\t\tfor (int i = 1; i <= n; i ++) {\n\t\t\tscanf(\"%d\", &a[i]);\n\t\t}\n\t\tfor (int i = 1; i <= q; i ++) {\n\t\t\tlong long k = rd(seed) % k_max;\n\t\t\t/∗\n\t\t\tCode your solution here.\n\t\t\t∗/\n\t\t}\n\t}\n}\n```", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[ZJOI2022] 面条", "background": "忍，爱丽丝，绫和阳子一众千辛万苦地总算出好了第一试，按原先计划，可怜会出第二试。\n\n“不好了，可怜给我发信息说她降落后被拉去隔离 30 天了，没有电脑，出不了题”，绫突然收到了不幸的消息。\n\n“那咋办？没 idea 了，编不出来了啊！” 众人慌作一团。\n\n看了看日期，离 ZJOI 还有一周。\n\n欲知后事如何，请看下回分解。", "description": "九条可怜是一个喜欢吃拉面的女孩子。\n\n有一天她去吃拉面，她发现拉面师傅为她拉的是一个长度为 $n$ 的面条，$n$ 保证是偶数，一开始第 $i$ 个位置调料的数量是 $a_i$。\n\n如下过程称为一次 “拉面”：\n\n1. 将面条对折，面条的长度会变成 $\\frac{n}{2}$，第 $i$ 个位置的调料数量会变为原来第 $i$ 个位置的调料与第 $n - i + 1$ 个位置的调料数量之和，如果新面条第 $i$ 个位置的调料数量为 $b_i$，那么满足 $b_i = a_i + a_{n - i + 1}$。\n2. 将面条拉回原来的长度 $n$，每个位置会变为两个位置，并且调料数量会均分，如果现在的第 $i$ 个位置的调料数量是 $a'_i$，那么 $a'_i = \\frac{1}{2} \\times b_{\\left\\lceil \\frac{i}{2} \\right\\rceil}$。\n\n现在对于一个固定的 $x$，你需要回答 $q$ 个询问，每次面条经过 $k$ 次 “拉面” 后，第 $x$ 个位置的调料数量。你只需要求出答案对 $998244353$ 取模的结果。具体地，即如果答案的最简分数表示为 $\\frac{a}{b}$，输出 $a \\times b^{-1} \\bmod 998244353$。", "inputFormat": "第一行输入三个正整数 $test, T, seed$，代表测试点编号，数据组数和生成种子。\n\n接下来输入 $T$ 组数据，每组数据包含两行。\n\n第一行输入四个正整数 $n, q, x, k_{\\mathrm{max}}$，代表这组数据中面条的长度，询问的个数，询问的位置和生成询问中 $k$ 的上限。\n\n第二行输入 $n$ 个非负整数，第 $i$ 个整数 $a_i$ 代表初始面条第 $i$ 个位置的调料数量。\n\n为了避免大量的输入与输出，$q$ 个询问由我们提供的一个生成器生成。具体地，我们提供一个由 C++ 书写的代码框架 `noodle_template.cpp` 供选手使用，见附录，同时在这里我们做一定量的说明：\n\n首先我们从数据中依次读入两个 $32$ 位整型变量 $\\mathit{test}, T$，一个无符号 $64$ 位长整型变量 $\\mathit{seed}$。接下来循环 $T$ 次，代表 $T$ 组数据。\n\n在每次循环中，我们对一组数据进行计算。首先依次读入三个 $32$ 位整型变量 $n, q, x$，一个 $64$ 位整型变量 $k_{\\mathrm{max}}$。接下来读入 $n$ 个 $32$ 位整型变量放入数组 $a_1, \\ldots, a_n$ 中。\n\n接下来是生成 $q$ 个询问的部分，每次调用 `rd()` 函数，将 $\\mathit{seed}$ 作为引用参数传入，将返回值（返回值为无符号 $64$ 位长整型）对 $k_{\\mathrm{max}}$ 取模的结果作为该次询问的参数 $k$，注意到 $\\mathit{seed}$ 也会被修改。", "outputFormat": "输出 $T$ 行，每行一个整数代表该组数据的答案。具体地，假设该组数据有 $q$ 个询问，令第 $i$ 个询问的答案为 $\\mathrm{Ans}_i$，那么需要你输出 $\\bigoplus_{i = 1}^q (\\mathrm{Ans}_i \\cdot i)$，**注意这里不需要取模**。$\\bigoplus$ 指按位异或运算符。", "hint": "**【样例解释 #1】**\n\n第一组测试数据中，$\\{ a_i \\}$ 初始为 $\\{ 1, 4, 2, 3 \\}$。  \n操作一次后为 $\\{ 2, 2, 3, 3 \\}$。  \n操作两次后为 $\\{ \\frac{5}{2}, \\frac{5}{2}, \\frac{5}{2}, \\frac{5}{2} \\}$。\n\n其中生成询问为：  \n询问位置：$x = 1$；  \n第一个询问：$k = 0$，$a_x = 1$；  \n第二个询问：$k = 1$，$a_x = 2$；  \n答案为 $(1 \\times 1) \\oplus (2 \\times 2) = 4 \\oplus 1 = 5$。\n\n第二组测试数据中，$\\{ a_i \\}$ 初始为 $\\{ 6, 2, 5, 3, 1, 4 \\}$。  \n操作一次后为 $\\{ 5, 5, \\frac{3}{2}, \\frac{3}{2}, 4, 4 \\}$。  \n操作两次后为 $\\{ \\frac{9}{2}, \\frac{9}{2}, \\frac{9}{2}, \\frac{9}{2}, \\frac{3}{2}, \\frac{3}{2} \\}$。\n\n其中生成询问为：  \n询问位置：$x = 3$；  \n第一个询问 $k = 2$，$a_x = \\frac{9}{2}$，$\\frac{9}{2} \\equiv 499122181 \\pmod{998244353}$；  \n第二个询问 $k = 0$，$a_x = 5$；  \n答案为 $(499122181 \\times 1) \\oplus (5 \\times 2) = 499122181 \\oplus 10 = 499122191$。\n\n**【数据范围】**\n\n对于所有测试点：保证 $T \\le 10$，$\\sum n \\le 2 \\times {10}^6$，$\\sum q \\le 5 \\times {10}^7$，$k_{\\mathrm{max}} \\le {10}^{18}$，$1 \\le x \\le n$，$0 \\le a_i < 998244353$，$0 \\le \\mathit{seed} \\le 2^{60} - 1$，保证 $n$ 是偶数。\n\n注意，对于样例，测试点编号 $\\mathit{test}$ 为 $0$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | $\\sum n \\le$ | $\\sum q \\le$ | $k_{\\mathrm{max}} \\le $ | 特殊限制 |\n|:-:|:-:|:-:|:-:|:-:|\n| $1$ | $500$ | $500$ | $500$ | 无 |\n| $2$ | $2 \\times {10}^6$ | $2 \\times {10}^6$ | $10$ | 无 |\n| $3$ | $2 \\times {10}^6$ | $2 \\times {10}^6$ | ${10}^{18}$ | $n = 2^k$ |\n| $4$ | $50$ | $50$ | ${10}^{18}$ | 无 |\n| $5 \\sim 6$ | $150$ | $150$ | ${10}^{18}$ | 无 |\n| $7$ | $2 \\times {10}^6$ | $2 \\times {10}^6$ | ${10}^{18}$ | $n = 98304$ |\n| $8 \\sim 9$ | $500$ | $500$ | ${10}^{18}$ | 无 |\n| $10 \\sim 11$ | $5 \\times {10}^3$ | $2 \\times {10}^6$ | ${10}^{18}$ | 无 |\n| $12 \\sim 13$ | $2 \\times {10}^6$ | $50$ | ${10}^{18}$ | 无 |\n| $14 \\sim 16$ | ${10}^6$ | ${10}^5$ | ${10}^{18}$ | 无 |\n| $17 \\sim 18$ | $2 \\times {10}^6$ | $2 \\times {10}^7$ | ${10}^{18}$ | 无 |\n| $19 \\sim 20$ | $2 \\times {10}^6$ | $5 \\times {10}^7$ | ${10}^{18}$ | 无 |\n\n**【附录】**\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nunsigned long long rd (unsigned long long &x) {\n\tx ^= (x << 13);\n\tx ^= (x >> 7);\n\tx ^= (x << 17);\n\treturn x;\n}\n\nint main () {\n\tint test, T;\n\tunsigned long long seed;\n\tscanf(\"%d%d%llu\", &test, &T, &seed);\n\tfor (int Case = 1; Case <= T; Case ++) {\n\t\tint n, q, x;\n\t\tlong long k_max;\n\t\tscanf(\"%d%d%d%lld\", &n, &q, &x, &k_max);\n\t\tvector<int> a(n + 1);\n\t\tfor (int i = 1; i <= n; i ++) {\n\t\t\tscanf(\"%d\", &a[i]);\n\t\t}\n\t\tfor (int i = 1; i <= q; i ++) {\n\t\t\tlong long k = rd(seed) % k_max;\n\t\t\t/∗\n\t\t\tCode your solution here.\n\t\t\t∗/\n\t\t}\n\t}\n}\n```", "locale": "zh-CN"}}}
{"pid": "P8333", "type": "P", "difficulty": 7, "samples": [["6\n2 1 2\n1 1 137\n3 94 95\n3 1998 1996\n998244 353999 999999\n50 120 150\n", "7 4\n4 1\n1124 31585548\n23951 33873190\n1289433675488 748596399\n23600 480090154\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["各省省选", "2022", "浙江", "O2优化", "组合数学", "线性代数"], "title": "[ZJOI2022] 计算几何", "background": null, "description": "九条可怜是一个喜欢计算几何的女孩子，她画了一个特别的平面坐标系，其中 $x$ 轴正半轴与 $y$ 轴正半轴夹角为 $60$ 度。\n\n从中，她取出所有横纵坐标不全为偶数，且满足 $-2 a + 1 \\le x \\le 2 a - 1$，$-2 b + 1 \\le y \\le 2 b - 1$，$-2 c + 1 \\le x + y \\le 2 c - 1$ 的整点。\n\n可怜想将其中一些点染色，但相邻的点不能同时染色。具体地，对于点 $(x, y)$，它和 $(x, y + 1), (x, y - 1), (x + 1, y), (x - 1, y), (x + 1, y - 1), (x - 1, y + 1)$ 六个点相邻，可结合样例解释理解。\n\n可怜想知道在这个规则下最多能将多少点染色，以及染最多点的染色方案数。由于后者值可能很大，对于染色方案数，你只需要输出对 $998244353$ 取模后的结果。**注意不需要将最多染色点数取模。**", "inputFormat": "第一行一个整数 $T$ 代表数据组数。\n\n接下来 $T$ 行，每行三个整数 $a, b, c$ 代表一组数据。", "outputFormat": "输出共 $T$ 行，每行两个整数，代表最多能染的点数（**不取模**）和方案数对 $998244353$ 取模的结果。", "hint": "**【样例解释】**\n\n如下图所示，点 $J$ 的坐标为 $(2, 1)$，点 $F$ 的坐标为 $(-1, 0)$，点 $H$ 的坐标为 $(2, 0)$。在这三个点中，只有点 $H$ 是横纵坐标全为偶数的点。图中与点 $A$ 距离为 $1$ 的点有 $\\texttt{B C D E F G}$ 六个点。\n\n在样例的第一组数据中，满足条件的整点有 $\\texttt{R N G B I J P F C K M L E D S T}$。\n\n最多能染 $7$ 个点，方案共 $4$ 种，具体为：$\\texttt{P N L B D J T}$，$\\texttt{R M F B D J T}$，$\\texttt{R M G E C J T}$，$\\texttt{R M G E I S K}$。\n\n在样例的第二组数据中，满足条件的整点有 $\\texttt{G B I F C L E D}$。\n\n最多能染 $4$ 个点，方案共 $1$ 种，具体为：$\\texttt{L G I D}$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/a3lp43vq.png)\n\n**【数据范围】**\n\n对于所有测试点：$1 \\le T \\le 10$，$1 \\le a, b, c \\le {10}^6$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | $a \\le$ | $b, c \\le$ | 特殊限制 |\n|:-:|:-:|:-:|:-:|\n| $1$ | $3$ | $3$ | $a = b = c$ |\n| $2$ | $4$ | $4$ | $a = b = c$ |\n| $3$ | $4$ | $4$ | 无 |\n| $4$ | $3$ | $100$ | 无 |\n| $5 \\sim 6$ | $3$ | $1000$ | 无 |\n| $7 \\sim 8$ | $3$ | $5000$ | 无 |\n| $9 \\sim 10$ | $100$ | $100$ | $a = b = c$ |\n| $11 \\sim 14$ | $100$ | $100$ | 无 |\n| $15$ | ${10}^5$ | ${10}^5$ | $a = b = c$ |\n| $16$ | ${10}^5$ | ${10}^5$ | 无 |\n| $17 \\sim 18$ | ${10}^6$ | ${10}^6$ | $a \\cdot b \\cdot c \\le {10}^6$ |\n| $19$ | ${10}^6$ | ${10}^6$ | $a = b = c$ |\n| $20$ | ${10}^6$ | ${10}^6$ | 无 |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[ZJOI2022] 计算几何", "background": null, "description": "九条可怜是一个喜欢计算几何的女孩子，她画了一个特别的平面坐标系，其中 $x$ 轴正半轴与 $y$ 轴正半轴夹角为 $60$ 度。\n\n从中，她取出所有横纵坐标不全为偶数，且满足 $-2 a + 1 \\le x \\le 2 a - 1$，$-2 b + 1 \\le y \\le 2 b - 1$，$-2 c + 1 \\le x + y \\le 2 c - 1$ 的整点。\n\n可怜想将其中一些点染色，但相邻的点不能同时染色。具体地，对于点 $(x, y)$，它和 $(x, y + 1), (x, y - 1), (x + 1, y), (x - 1, y), (x + 1, y - 1), (x - 1, y + 1)$ 六个点相邻，可结合样例解释理解。\n\n可怜想知道在这个规则下最多能将多少点染色，以及染最多点的染色方案数。由于后者值可能很大，对于染色方案数，你只需要输出对 $998244353$ 取模后的结果。**注意不需要将最多染色点数取模。**", "inputFormat": "第一行一个整数 $T$ 代表数据组数。\n\n接下来 $T$ 行，每行三个整数 $a, b, c$ 代表一组数据。", "outputFormat": "输出共 $T$ 行，每行两个整数，代表最多能染的点数（**不取模**）和方案数对 $998244353$ 取模的结果。", "hint": "**【样例解释】**\n\n如下图所示，点 $J$ 的坐标为 $(2, 1)$，点 $F$ 的坐标为 $(-1, 0)$，点 $H$ 的坐标为 $(2, 0)$。在这三个点中，只有点 $H$ 是横纵坐标全为偶数的点。图中与点 $A$ 距离为 $1$ 的点有 $\\texttt{B C D E F G}$ 六个点。\n\n在样例的第一组数据中，满足条件的整点有 $\\texttt{R N G B I J P F C K M L E D S T}$。\n\n最多能染 $7$ 个点，方案共 $4$ 种，具体为：$\\texttt{P N L B D J T}$，$\\texttt{R M F B D J T}$，$\\texttt{R M G E C J T}$，$\\texttt{R M G E I S K}$。\n\n在样例的第二组数据中，满足条件的整点有 $\\texttt{G B I F C L E D}$。\n\n最多能染 $4$ 个点，方案共 $1$ 种，具体为：$\\texttt{L G I D}$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/a3lp43vq.png)\n\n**【数据范围】**\n\n对于所有测试点：$1 \\le T \\le 10$，$1 \\le a, b, c \\le {10}^6$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | $a \\le$ | $b, c \\le$ | 特殊限制 |\n|:-:|:-:|:-:|:-:|\n| $1$ | $3$ | $3$ | $a = b = c$ |\n| $2$ | $4$ | $4$ | $a = b = c$ |\n| $3$ | $4$ | $4$ | 无 |\n| $4$ | $3$ | $100$ | 无 |\n| $5 \\sim 6$ | $3$ | $1000$ | 无 |\n| $7 \\sim 8$ | $3$ | $5000$ | 无 |\n| $9 \\sim 10$ | $100$ | $100$ | $a = b = c$ |\n| $11 \\sim 14$ | $100$ | $100$ | 无 |\n| $15$ | ${10}^5$ | ${10}^5$ | $a = b = c$ |\n| $16$ | ${10}^5$ | ${10}^5$ | 无 |\n| $17 \\sim 18$ | ${10}^6$ | ${10}^6$ | $a \\cdot b \\cdot c \\le {10}^6$ |\n| $19$ | ${10}^6$ | ${10}^6$ | $a = b = c$ |\n| $20$ | ${10}^6$ | ${10}^6$ | 无 |", "locale": "zh-CN"}}}
{"pid": "P8334", "type": "P", "difficulty": 7, "samples": [["4\n1 1\n1\n3 3\n3 3 4\n3 1\n3 2\n6 1\n5 2 4 1 3 6\n1 2\n1 6\n2 3\n2 4\n4 5\n5 1\n5 4 3 2 1\n1 2\n1 3\n3 4\n3 5\n", "1\n16\n34\n499122202\n"], ["见附件中的 dfs/dfs_ex2.in", "见附件中的 dfs/dfs_ex2.ans"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["动态规划 DP", "线段树", "各省省选", "2022", "浙江", "O2优化", "树链剖分", "矩阵乘法"], "title": "[ZJOI2022] 深搜", "background": "", "description": "九条可怜是一个喜欢算法的女孩子，在众多算法中她尤其喜欢深度优先搜索（DFS）。\n\n有一天，可怜得到了一棵有根树，树根为 $\\mathit{root}$，树上每个节点 $x$ 有一个权值 $a_x$。\n\n在一棵树上从 $x$ 出发，寻找 $y$ 节点，如果使用深度优先搜索，则可描述为以下演算过程：\n\n1. 将递归栈设置为空。\n2. 首先将节点 $x$ 放入递归栈中。\n3. 从递归栈中取出栈顶节点，如果该节点为 $y$，则结束演算过程；否则，如果存在未访问的直接子节点，则以均等概率随机选择一个子节点加入递归栈中。\n4. 重复步骤 3，直到不存在未访问的直接子节点。\n5. 将上一级节点加入递归栈中，重复步骤 3。\n6. 重复步骤 5，直至当前一级节点为 $x$，演算过程结束。\n\n我们定义 $f(x, y)$ 合法当且仅当 $y$ 在 $x$ 的子树中。它的值为从 $x$ 出发，对 $x$ 的子树进行深度优先搜索寻找 $y$ 期间访问过的所有节点（包括 $x$ 和 $y$）权值最小值的期望。\n\n九条可怜想知道对于所有合法的点对 $(x, y)$，$\\sum f(x, y)$ 的值。你只需要输出答案对 $998244353$ 取模的结果。具体地，如果答案的最简分数表示为 $\\frac{a}{b}$，输出 $a \\times b^{-1} \\bmod 998244353$。", "inputFormat": "输入包含多组数据，第一行输入数据组数 $T$。\n\n对于接下来的每组数据，第一行两个整数 $n, \\mathit{root}$，分别表示树的大小，树根的编号。\n\n接下来一行 $n$ 个整数 $a_1, a_2, \\ldots, a_n$，表示树上每个节点的权值。\n\n接下来 $n - 1$ 行，每行包含两个整数 $u, v$，表示 $u$ 和 $v$ 之间有一条树边。", "outputFormat": "对于每组数据，输出一行，包含一个整数，代表对于所有合法点对 $(x, y)$，$\\sum f(x, y)$ 对 $998244353$ 取模的结果。", "hint": "对于所有测试点，满足 $1 \\le T \\le 100$，$\\sum n \\le 8 \\times {10}^5$，$1 \\le n \\le 4 \\times {10}^5$，$1 \\le \\mathit{root}, u, v \\le n$，$1 \\le a_i \\le {10}^9$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | $\\sum n \\le$ | $n \\le$ | 特殊限制 |\n|:-:|:-:|:-:|:-:|\n| $1$ | $50$ | $10$ | 无 |\n| $2 \\sim 4$ | $40000$ | $5000$ | 无 |\n| $5 \\sim 10$ | $4 \\times {10}^5$ | ${10}^5$ | 无 |\n| $11$ | $8 \\times {10}^5$ | $4 \\times {10}^5$ | 树的生成方式随机 |\n| $12$ | $8 \\times {10}^5$ | $4 \\times {10}^5$ | 树是一条链 |\n| $13$ | $8 \\times {10}^5$ | $4 \\times {10}^5$ | 根的度数为 $n - 1$ |\n| $14 \\sim 20$ | $8 \\times {10}^5$ | $4 \\times {10}^5$ | 无 |\n\n对于测试点 $11$，树的生成方式为：以 $1$ 为根，对于节点 $i \\in [2, n]$，从 $[1, i - 1]$ 中等概率随机选\n择一个点作为父亲。之后将编号随机重排。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[ZJOI2022] 深搜", "background": "", "description": "九条可怜是一个喜欢算法的女孩子，在众多算法中她尤其喜欢深度优先搜索（DFS）。\n\n有一天，可怜得到了一棵有根树，树根为 $\\mathit{root}$，树上每个节点 $x$ 有一个权值 $a_x$。\n\n在一棵树上从 $x$ 出发，寻找 $y$ 节点，如果使用深度优先搜索，则可描述为以下演算过程：\n\n1. 将递归栈设置为空。\n2. 首先将节点 $x$ 放入递归栈中。\n3. 从递归栈中取出栈顶节点，如果该节点为 $y$，则结束演算过程；否则，如果存在未访问的直接子节点，则以均等概率随机选择一个子节点加入递归栈中。\n4. 重复步骤 3，直到不存在未访问的直接子节点。\n5. 将上一级节点加入递归栈中，重复步骤 3。\n6. 重复步骤 5，直至当前一级节点为 $x$，演算过程结束。\n\n我们定义 $f(x, y)$ 合法当且仅当 $y$ 在 $x$ 的子树中。它的值为从 $x$ 出发，对 $x$ 的子树进行深度优先搜索寻找 $y$ 期间访问过的所有节点（包括 $x$ 和 $y$）权值最小值的期望。\n\n九条可怜想知道对于所有合法的点对 $(x, y)$，$\\sum f(x, y)$ 的值。你只需要输出答案对 $998244353$ 取模的结果。具体地，如果答案的最简分数表示为 $\\frac{a}{b}$，输出 $a \\times b^{-1} \\bmod 998244353$。", "inputFormat": "输入包含多组数据，第一行输入数据组数 $T$。\n\n对于接下来的每组数据，第一行两个整数 $n, \\mathit{root}$，分别表示树的大小，树根的编号。\n\n接下来一行 $n$ 个整数 $a_1, a_2, \\ldots, a_n$，表示树上每个节点的权值。\n\n接下来 $n - 1$ 行，每行包含两个整数 $u, v$，表示 $u$ 和 $v$ 之间有一条树边。", "outputFormat": "对于每组数据，输出一行，包含一个整数，代表对于所有合法点对 $(x, y)$，$\\sum f(x, y)$ 对 $998244353$ 取模的结果。", "hint": "对于所有测试点，满足 $1 \\le T \\le 100$，$\\sum n \\le 8 \\times {10}^5$，$1 \\le n \\le 4 \\times {10}^5$，$1 \\le \\mathit{root}, u, v \\le n$，$1 \\le a_i \\le {10}^9$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | $\\sum n \\le$ | $n \\le$ | 特殊限制 |\n|:-:|:-:|:-:|:-:|\n| $1$ | $50$ | $10$ | 无 |\n| $2 \\sim 4$ | $40000$ | $5000$ | 无 |\n| $5 \\sim 10$ | $4 \\times {10}^5$ | ${10}^5$ | 无 |\n| $11$ | $8 \\times {10}^5$ | $4 \\times {10}^5$ | 树的生成方式随机 |\n| $12$ | $8 \\times {10}^5$ | $4 \\times {10}^5$ | 树是一条链 |\n| $13$ | $8 \\times {10}^5$ | $4 \\times {10}^5$ | 根的度数为 $n - 1$ |\n| $14 \\sim 20$ | $8 \\times {10}^5$ | $4 \\times {10}^5$ | 无 |\n\n对于测试点 $11$，树的生成方式为：以 $1$ 为根，对于节点 $i \\in [2, n]$，从 $[1, i - 1]$ 中等概率随机选\n择一个点作为父亲。之后将编号随机重排。", "locale": "zh-CN"}}}
