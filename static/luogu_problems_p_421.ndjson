{"pid": "P9539", "type": "P", "difficulty": 2, "samples": [["3 1 2\naab", "aaa"], ["4 4 4\nawoi\n", "awoi"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["字符串", "贪心", "构造"], "title": "「AWOI Round 2 B」树学", "background": "HR 刚做完一个简单而又靓丽的题目，它想来试试这道题，可是它太蒻了，不会做，您能帮帮它吗？", "description": "构造一个长度为 $n$ 的小写字母串，要求和给定的长度为 $n$ 的小写字母串 $s$ 的相似度在 $[l,r]$ 范围内。\n\n定义两个长度都为 $n$ 的字符串 $a,b$ 的相似度为 $\\sum^{n}_{i=1}[a_i=b_i]$。\n\n您需要使构造出的字符串的字典序尽量小。", "inputFormat": "第一行三个正整数 $n,l,r$。\n\n接下来一行一个字符串，表示给定的小写字母串 $s$。", "outputFormat": "输出一行一个字符串，表示您构造的字典序最小的可行字符串。", "hint": "**【数据规模】**\n\n\n**本题使用捆绑测试。**\n\n| 子任务编号 | $n\\leqslant$ | 特殊性质 | 分值 |\n| -----------: | -----------: | -----------: | -----------: |\n| $1$ | $100$ | 无 | $20$ |\n| $2$ | $10^6$ | A | $10$ |\n| $3$ | $10^6$ | B | $10$ |\n| $4$ | $10^6$ | 无 | $60$ |\n\n特殊性质 A：$l=r=n$ 或 $l=0,r=n$。\n\n特殊性质 B：$s$ 的每一位都为 `a` 或都不为 `a`。\n\n对于 $100\\%$ 的数据，$1 \\leqslant n \\leqslant 10^6$，$0 \\leqslant l \\leqslant r \\leqslant n$，$s$ 的长度为 $n$。\n\n**【工作人员】**\n| $\\text{Idea}$ | $\\text{Data}$ | $\\text{Check}$ | $\\text{Solution}$ |\n| :----------: | :----------: | :----------: | :----------: | \n| [玄学OIER荷蒻](/user/671294) | [QwQ666\\_666](/user/677609) & [玄学OIER荷蒻](/user/671294) | [QwQ666\\_666](/user/677609)| [玄学OIER荷蒻](/user/671294) |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「AWOI Round 2 B」树学", "background": "HR 刚做完一个简单而又靓丽的题目，它想来试试这道题，可是它太蒻了，不会做，您能帮帮它吗？", "description": "构造一个长度为 $n$ 的小写字母串，要求和给定的长度为 $n$ 的小写字母串 $s$ 的相似度在 $[l,r]$ 范围内。\n\n定义两个长度都为 $n$ 的字符串 $a,b$ 的相似度为 $\\sum^{n}_{i=1}[a_i=b_i]$。\n\n您需要使构造出的字符串的字典序尽量小。", "inputFormat": "第一行三个正整数 $n,l,r$。\n\n接下来一行一个字符串，表示给定的小写字母串 $s$。", "outputFormat": "输出一行一个字符串，表示您构造的字典序最小的可行字符串。", "hint": "**【数据规模】**\n\n\n**本题使用捆绑测试。**\n\n| 子任务编号 | $n\\leqslant$ | 特殊性质 | 分值 |\n| -----------: | -----------: | -----------: | -----------: |\n| $1$ | $100$ | 无 | $20$ |\n| $2$ | $10^6$ | A | $10$ |\n| $3$ | $10^6$ | B | $10$ |\n| $4$ | $10^6$ | 无 | $60$ |\n\n特殊性质 A：$l=r=n$ 或 $l=0,r=n$。\n\n特殊性质 B：$s$ 的每一位都为 `a` 或都不为 `a`。\n\n对于 $100\\%$ 的数据，$1 \\leqslant n \\leqslant 10^6$，$0 \\leqslant l \\leqslant r \\leqslant n$，$s$ 的长度为 $n$。\n\n**【工作人员】**\n| $\\text{Idea}$ | $\\text{Data}$ | $\\text{Check}$ | $\\text{Solution}$ |\n| :----------: | :----------: | :----------: | :----------: | \n| [玄学OIER荷蒻](/user/671294) | [QwQ666\\_666](/user/677609) & [玄学OIER荷蒻](/user/671294) | [QwQ666\\_666](/user/677609)| [玄学OIER荷蒻](/user/671294) |", "locale": "zh-CN"}}}
{"pid": "P9540", "type": "P", "difficulty": 3, "samples": [["5 1 1\n1 1 45 1 4\n1 9 1 9 810", "1"], ["20 0 3\n1 0 0 8 6 10 0 8 6 1 0 0 86 1 0 0 8 6 0 0\n5 2 0 1 3 1 4 52 0 13 14 0 1 0 1 0 4 0 5 0", "4"], ["3 2 4\n110 105 117\n99 108 98", "1"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心"], "title": "「AWOI Round 2 C」数组操作？数组操作！", "background": "", "description": "给定两个长度为 $n$ 的数组 $a,b$ ，将它们合并得到一个长度为 $2\\times n$ 的数组 $c$。\n\n设 $a$ 数组第 $i$ 个元素合并后位于 $c$ 数组第 $lb_i$ 个位置，$b$ 数组第 $i$ 个元素合并后位于 $c$ 数组第 $lc_i$ 个位置，合并后需要满足：$lb_1 < lb_2 < ...< lb_{n-1} < lb_n$ 且 $lc_1 < lc_2< ...< lc_{n-1}< lc_n$，即两个数组中元素的相对位置不变。\n\n合并过后，你需要对 $c$ 数组进行下面操作：\n\n1. 变换操作：选择一个区间 $[l,r]$，对于每一个 $i \\in [l,r]$，如果 $c_i$ 为 $y$，则将其变成一个不同于 $y$ 的数，否则将其变为 $y$。\n2. 翻转操作：选择一个区间 $[l,r]$，翻转该数组区间中的数。此操作**必须刚好**操作 $z$ 次。\n\n请输出最少需要执行多少次变换操作才能使得 $c$ 数组中的数字都为 $y$。 ", "inputFormat": "第一行包含三个整数 $n,y,z$。\n\n第二行包含 $n$ 个整数，代表 $a$ 数组中的元素。\n\n第三行包含 $n$ 个整数，代表 $b$ 数组中的元素。", "outputFormat": "一个正整数，表示答案。", "hint": "**【样例说明】**\n\n对于样例 $1$，令 $c$ 为 $\\{1,1,1,9,45,1,1,9,4,810\\}$。\n\n其中 $c_1=a_1,c_2=b_1,c_3=a_2,c_4=b_2,c_5=a_3,c_6=a_4,c_7=b_3,c_8=b_4,c_9=a_5,c_{10}=b_5$。满足要求。\n\n然后翻转区间 $[4,7]$， $c$ 数组变为 $\\{1,1,1,1,1,45,9,9,4,810\\}$。\n\n接着执行变换操作，将 $[6,10]$ 中的数全部变成 $1$。\n\n所以最少只需要一次变换操作，可以证明没有比该方法更优的策略。\n\n**【数据规模】**\n\n请注意本题特殊的时间限制，并使用更快的 IO 方式。\n\n**本题使用捆绑测试。**\n\n| 子任务编号 | $n\\leqslant$ | 特殊性质 | 分值 |\n| -----------: | -----------: | -----------: | -----------: |\n| $1$ | $5$ | 无 | $20$ |\n| $2$ | $10^6$ | $z>n$ | $5$ |\n| $3$ | $10^6$ | 特殊性质 A | $10$ |\n| $4$ | $10^6$ | $z=0$ | $25$ |\n| $5$ | $10^6$ | 无 | $40$ |\n\n特殊性质 A：保证两个数组中的元素都为 $y$ 或都不为 $y$。\n\n对于全部数据，保证 $0 \\leqslant y,z \\leqslant 10^9$，输入数据全部在 `int` 范围内。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「AWOI Round 2 C」数组操作？数组操作！", "background": "", "description": "给定两个长度为 $n$ 的数组 $a,b$ ，将它们合并得到一个长度为 $2\\times n$ 的数组 $c$。\n\n设 $a$ 数组第 $i$ 个元素合并后位于 $c$ 数组第 $lb_i$ 个位置，$b$ 数组第 $i$ 个元素合并后位于 $c$ 数组第 $lc_i$ 个位置，合并后需要满足：$lb_1 < lb_2 < ...< lb_{n-1} < lb_n$ 且 $lc_1 < lc_2< ...< lc_{n-1}< lc_n$，即两个数组中元素的相对位置不变。\n\n合并过后，你需要对 $c$ 数组进行下面操作：\n\n1. 变换操作：选择一个区间 $[l,r]$，对于每一个 $i \\in [l,r]$，如果 $c_i$ 为 $y$，则将其变成一个不同于 $y$ 的数，否则将其变为 $y$。\n2. 翻转操作：选择一个区间 $[l,r]$，翻转该数组区间中的数。此操作**必须刚好**操作 $z$ 次。\n\n请输出最少需要执行多少次变换操作才能使得 $c$ 数组中的数字都为 $y$。 ", "inputFormat": "第一行包含三个整数 $n,y,z$。\n\n第二行包含 $n$ 个整数，代表 $a$ 数组中的元素。\n\n第三行包含 $n$ 个整数，代表 $b$ 数组中的元素。", "outputFormat": "一个正整数，表示答案。", "hint": "**【样例说明】**\n\n对于样例 $1$，令 $c$ 为 $\\{1,1,1,9,45,1,1,9,4,810\\}$。\n\n其中 $c_1=a_1,c_2=b_1,c_3=a_2,c_4=b_2,c_5=a_3,c_6=a_4,c_7=b_3,c_8=b_4,c_9=a_5,c_{10}=b_5$。满足要求。\n\n然后翻转区间 $[4,7]$， $c$ 数组变为 $\\{1,1,1,1,1,45,9,9,4,810\\}$。\n\n接着执行变换操作，将 $[6,10]$ 中的数全部变成 $1$。\n\n所以最少只需要一次变换操作，可以证明没有比该方法更优的策略。\n\n**【数据规模】**\n\n请注意本题特殊的时间限制，并使用更快的 IO 方式。\n\n**本题使用捆绑测试。**\n\n| 子任务编号 | $n\\leqslant$ | 特殊性质 | 分值 |\n| -----------: | -----------: | -----------: | -----------: |\n| $1$ | $5$ | 无 | $20$ |\n| $2$ | $10^6$ | $z>n$ | $5$ |\n| $3$ | $10^6$ | 特殊性质 A | $10$ |\n| $4$ | $10^6$ | $z=0$ | $25$ |\n| $5$ | $10^6$ | 无 | $40$ |\n\n特殊性质 A：保证两个数组中的元素都为 $y$ 或都不为 $y$。\n\n对于全部数据，保证 $0 \\leqslant y,z \\leqslant 10^9$，输入数据全部在 `int` 范围内。", "locale": "zh-CN"}}}
{"pid": "P9541", "type": "P", "difficulty": 3, "samples": [["5\n1\n2 3\n4 5 6\n10 9 8 7\n2 5 2 5 6", "40 10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP"], "title": "「AWOI Round 2 D」数字三角形", "background": "", "description": "Glad 发现了一个 $n$ 层数字三角形，他发现可以用魔法来操纵这个三角形！\n\n他可以先消耗 $nk_1$ 点消耗值，让将三角形旋转 $k_1$ 次。其中“旋转”指绕三角形中心顺时针旋转 $120^\\circ$。\n\n然后，他可以不停地进行下面操作：\n\n- 消耗 $1$ 点消耗值，选择一层，调换这一层任意两个数的位置。\n\n现在，Glad 要从三角形的最后一层走到最顶层，起点可以为最后一层的任意一个数，行走的每一步只能走到与当前数相邻的数上，且每一行只能经过一个数。\n\nGlad 想在经过数之和最大的前提下让消耗的消耗值最小，你可以帮帮他吗？", "inputFormat": "一个正整数 $n$，表示三角形的层数。\n\n后面 $n$ 行，表示数字三角形。其中第 $i$ 层有 $i$ 个数（$1\\leqslant i\\leqslant n$）。", "outputFormat": "两个整数，分别表示最大能经过的数之和以及最少要消耗多少消耗值。", "hint": "**【样例解释】**\n\n初始三角形为：\n\n```\n    1\n   2 3\n  4 5 6\n10 9 8 7\n2 5 2 5 6\n```\n\n\n将其向右翻转 $2$ 次，消耗 $10$ 点调换值，此时三角形变为：\n\n```\n    6\n   7 5\n  6 8 2\n 3 5 9 5\n1 2 4 10 2\n```\n\n无须调换数字，沿着 $6,7,8,9,10$ 走，可以得到最大值 $40$，共耗费 $10$ 点调换值。\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | 数据范围 | 特殊性质 | 分值 |  \n| :-----------: | :-----------: | :-----------: | :-----------: |  \n| $\\text{Subtask1}$ | $1\\leqslant n\\leqslant 10$ | AB | $10$ |  \n| $\\text{Subtask2}$ | $1\\leqslant n \\leqslant 10$ | A | $10$ |  \n| $\\text{Subtask3}$ | $1\\leqslant n \\leqslant 10$ | B | $10$ |  \n| $\\text{Subtask4}$ | $1\\leqslant n \\leqslant 10$ | 无 | $10$ | \n| $\\text{Subtask5}$ | $1\\leqslant n \\leqslant 40$ | 无 | $20$ | \n| $\\text{Subtask6}$ | $1\\leqslant n\\leqslant 10^3$ | 无 | $40$ |  \n\n特殊性质 A：不需要调换数字就可以得到最优解。\n\n特殊性质 B：不需要向右旋转就可以得到最优解。\n\n对于 $100\\%$ 的数据，保证：$1\\leqslant n\\leqslant 10^3$，$0\\leqslant a_i\\leqslant10^4$。\n\n**【工作人员】**\n\n| $\\text{Idea}$ | $\\text{Data}$ | $\\text{Check}$ | $\\text{Solution}$ |\n| :----------: | :----------: | :----------: | :----------: |\n|[S__X](/user/310466) |[S__X](/user/310466)|[I_am_AKed_by_NOI](/user/807853) | [I_am_AKed_by_NOI](/user/807853) |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「AWOI Round 2 D」数字三角形", "background": "", "description": "Glad 发现了一个 $n$ 层数字三角形，他发现可以用魔法来操纵这个三角形！\n\n他可以先消耗 $nk_1$ 点消耗值，让将三角形旋转 $k_1$ 次。其中“旋转”指绕三角形中心顺时针旋转 $120^\\circ$。\n\n然后，他可以不停地进行下面操作：\n\n- 消耗 $1$ 点消耗值，选择一层，调换这一层任意两个数的位置。\n\n现在，Glad 要从三角形的最后一层走到最顶层，起点可以为最后一层的任意一个数，行走的每一步只能走到与当前数相邻的数上，且每一行只能经过一个数。\n\nGlad 想在经过数之和最大的前提下让消耗的消耗值最小，你可以帮帮他吗？", "inputFormat": "一个正整数 $n$，表示三角形的层数。\n\n后面 $n$ 行，表示数字三角形。其中第 $i$ 层有 $i$ 个数（$1\\leqslant i\\leqslant n$）。", "outputFormat": "两个整数，分别表示最大能经过的数之和以及最少要消耗多少消耗值。", "hint": "**【样例解释】**\n\n初始三角形为：\n\n```\n    1\n   2 3\n  4 5 6\n10 9 8 7\n2 5 2 5 6\n```\n\n\n将其向右翻转 $2$ 次，消耗 $10$ 点调换值，此时三角形变为：\n\n```\n    6\n   7 5\n  6 8 2\n 3 5 9 5\n1 2 4 10 2\n```\n\n无须调换数字，沿着 $6,7,8,9,10$ 走，可以得到最大值 $40$，共耗费 $10$ 点调换值。\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | 数据范围 | 特殊性质 | 分值 |  \n| :-----------: | :-----------: | :-----------: | :-----------: |  \n| $\\text{Subtask1}$ | $1\\leqslant n\\leqslant 10$ | AB | $10$ |  \n| $\\text{Subtask2}$ | $1\\leqslant n \\leqslant 10$ | A | $10$ |  \n| $\\text{Subtask3}$ | $1\\leqslant n \\leqslant 10$ | B | $10$ |  \n| $\\text{Subtask4}$ | $1\\leqslant n \\leqslant 10$ | 无 | $10$ | \n| $\\text{Subtask5}$ | $1\\leqslant n \\leqslant 40$ | 无 | $20$ | \n| $\\text{Subtask6}$ | $1\\leqslant n\\leqslant 10^3$ | 无 | $40$ |  \n\n特殊性质 A：不需要调换数字就可以得到最优解。\n\n特殊性质 B：不需要向右旋转就可以得到最优解。\n\n对于 $100\\%$ 的数据，保证：$1\\leqslant n\\leqslant 10^3$，$0\\leqslant a_i\\leqslant10^4$。\n\n**【工作人员】**\n\n| $\\text{Idea}$ | $\\text{Data}$ | $\\text{Check}$ | $\\text{Solution}$ |\n| :----------: | :----------: | :----------: | :----------: |\n|[S__X](/user/310466) |[S__X](/user/310466)|[I_am_AKed_by_NOI](/user/807853) | [I_am_AKed_by_NOI](/user/807853) |", "locale": "zh-CN"}}}
{"pid": "P9542", "type": "P", "difficulty": 6, "samples": [["3 2 2\n1 0\n2 1\n1 2 1\n2 3 2\n", "2"], ["4 4 3\n1 1\n2 1\n3 0\n1 2 1\n2 3 1\n3 4 1\n4 1 3", "3"], ["见选手目录下的 alphago/alphago3.in 与 alphago/alphago3.ans。", "见选手目录下的 alphago/alphago3.in 与 alphago/alphago3.ans。"], ["见选手目录下的 alphago/alphago4.in 与 alphago/alphago4.ans。", "见选手目录下的 alphago/alphago4.in 与 alphago/alphago4.ans。"], ["见选手目录下的 alphago/alphago5.in 与 alphago/alphago5.ans。", "见选手目录下的 alphago/alphago5.in 与 alphago/alphago5.ans。"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["动态规划 DP", "图论", "2023", "O2优化", "二分图", "Ad-hoc", "湖北"], "title": "[湖北省选模拟 2023] 棋圣 / alphago", "background": "", "description": "小 K 是一名棋手，厌倦了传统围棋之后，他发明了一种新式围棋。\n\n新式围棋是一种单人游戏。这个游戏的棋盘是一张包含 $n$ 个顶点，$m$ 条边的无向连通图，并且不存在重边和自环。同时，每条边有一个权值，第 $i$ 条边的权值为 $w_i$。\n\n游戏开始时，每个顶点上可能有一颗黑棋或者一颗白棋，或者什么也没有。**至少有一个顶点上没有棋子。** 接下来，玩家需要进行若干次操作。每次的操作形式如下：\n\n首先，选定一个上面没有棋子的顶点 $u$。可以说明，在题目数据范围下，一定存在这样的顶点。\n\n接下来，对于每一颗棋子，若它位于顶点 $v$，则玩家需任选一条从 $v$ 到 $u$ 的**简单路径**，并将这颗棋子沿着这条简单路径移动一步。形式化地，一条简单路径为一个顶点序列 $\\{p_1,p_2 \\ldots p_k\\}$，满足 $p_1 = v$，$p_k = u$ ，$p_1,p_2 \\ldots p_k$ **互不相同**，且 $p_i$ 和 $p_{i+1}$ 之间存在一条边。在操作之后，这颗棋子将被移动至顶点 $p_2$。\n\n需要注意的是，虽然在游戏开始时每个顶点上至多存在一颗棋子，但在若干次操作之后一个顶点上可能有多个棋子。对于同一个顶点上的不同棋子，一次操作中选取的简单路径可以不同。\n\n玩家可以在进行任意次操作（可以是 $0$ 次）之后进行**点目**，即结算游戏分数。对于每一对颜色不同的棋子，若它们所在的顶点之间由一条权值为 $w$ 的边直接相连，则称它们**围住了这条边**，会使玩家得到 $w$ 的**目数**。而一个玩家所得到的**目数**即所有棋子对产生的**目数**之和。\n\n现小 K 给了你一张游戏开始时的棋盘，请你帮他求出在这张棋盘上最多可能得到的**目数**。", "inputFormat": "输入共 $m+k+1$ 行。\n\n第一行三个整数 $n,m,k$，分别表示点和边的数量，以及棋子的数量。\n\n接下来 $k$ 行，每行两个整数 $x,c$，表示顶点 $x$ 上有一颗颜色为 $c$ 的棋子。其中 $c=0$ 表示一颗黑棋，$c=1$ 表示一颗白棋。\n\n接下来 $m$ 行每行三个整数 $u,v,w$，表示图中有一条连接 $u$ 和 $v$ 的权值为 $w$ 的边。", "outputFormat": "输出一行一个整数，为所求答案。", "hint": "### 样例 1 解释\n\n对于第一组样例，可以选定顶点 $3$，然后将 $1$ 号点上的黑棋移动到顶点 $2$，将 $2$ 号点的黑棋移动到顶点 $3$，这样两颗棋子所在的顶点之间由一条边权为 $2$ 的边连接，产生的目数为 $2$。\n\n### 子任务\n\n对于所有测试数据，保证  $3 \\leq n \\leq 100$，$n-1 \\leq m \\leq \\frac{n(n-1)}{2}$，$1 \\leq k \\leq n-1$，$0 \\leq w_i \\leq 10^5$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5iu3ldkx.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[湖北省选模拟 2023] 棋圣 / alphago", "background": "", "description": "小 K 是一名棋手，厌倦了传统围棋之后，他发明了一种新式围棋。\n\n新式围棋是一种单人游戏。这个游戏的棋盘是一张包含 $n$ 个顶点，$m$ 条边的无向连通图，并且不存在重边和自环。同时，每条边有一个权值，第 $i$ 条边的权值为 $w_i$。\n\n游戏开始时，每个顶点上可能有一颗黑棋或者一颗白棋，或者什么也没有。**至少有一个顶点上没有棋子。** 接下来，玩家需要进行若干次操作。每次的操作形式如下：\n\n首先，选定一个上面没有棋子的顶点 $u$。可以说明，在题目数据范围下，一定存在这样的顶点。\n\n接下来，对于每一颗棋子，若它位于顶点 $v$，则玩家需任选一条从 $v$ 到 $u$ 的**简单路径**，并将这颗棋子沿着这条简单路径移动一步。形式化地，一条简单路径为一个顶点序列 $\\{p_1,p_2 \\ldots p_k\\}$，满足 $p_1 = v$，$p_k = u$ ，$p_1,p_2 \\ldots p_k$ **互不相同**，且 $p_i$ 和 $p_{i+1}$ 之间存在一条边。在操作之后，这颗棋子将被移动至顶点 $p_2$。\n\n需要注意的是，虽然在游戏开始时每个顶点上至多存在一颗棋子，但在若干次操作之后一个顶点上可能有多个棋子。对于同一个顶点上的不同棋子，一次操作中选取的简单路径可以不同。\n\n玩家可以在进行任意次操作（可以是 $0$ 次）之后进行**点目**，即结算游戏分数。对于每一对颜色不同的棋子，若它们所在的顶点之间由一条权值为 $w$ 的边直接相连，则称它们**围住了这条边**，会使玩家得到 $w$ 的**目数**。而一个玩家所得到的**目数**即所有棋子对产生的**目数**之和。\n\n现小 K 给了你一张游戏开始时的棋盘，请你帮他求出在这张棋盘上最多可能得到的**目数**。", "inputFormat": "输入共 $m+k+1$ 行。\n\n第一行三个整数 $n,m,k$，分别表示点和边的数量，以及棋子的数量。\n\n接下来 $k$ 行，每行两个整数 $x,c$，表示顶点 $x$ 上有一颗颜色为 $c$ 的棋子。其中 $c=0$ 表示一颗黑棋，$c=1$ 表示一颗白棋。\n\n接下来 $m$ 行每行三个整数 $u,v,w$，表示图中有一条连接 $u$ 和 $v$ 的权值为 $w$ 的边。", "outputFormat": "输出一行一个整数，为所求答案。", "hint": "### 样例 1 解释\n\n对于第一组样例，可以选定顶点 $3$，然后将 $1$ 号点上的黑棋移动到顶点 $2$，将 $2$ 号点的黑棋移动到顶点 $3$，这样两颗棋子所在的顶点之间由一条边权为 $2$ 的边连接，产生的目数为 $2$。\n\n### 子任务\n\n对于所有测试数据，保证  $3 \\leq n \\leq 100$，$n-1 \\leq m \\leq \\frac{n(n-1)}{2}$，$1 \\leq k \\leq n-1$，$0 \\leq w_i \\leq 10^5$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5iu3ldkx.png)", "locale": "zh-CN"}}}
{"pid": "P9543", "type": "P", "difficulty": 7, "samples": [["aab\nab", "7"], ["mikageandspica\nspica", "140"], ["见选手目录下的 diary/diary3.in 与 diary/diary3.ans。", "见选手目录下的 diary/diary3.in 与 diary/diary3.ans。"], ["见选手目录下的 diary/diary4.in 与 diary/diary4.ans。", "见选手目录下的 diary/diary4.in 与 diary/diary4.ans。"], ["见选手目录下的 diary/diary5.in 与 diary/diary5.ans。", "见选手目录下的 diary/diary5.in 与 diary/diary5.ans。"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2023", "O2优化", "湖北"], "title": "[湖北省选模拟 2023] 日记 / diary", "background": "", "description": "小 M 决定开始写日记，但她不愿意花费太多时间构思日记的内容。为此，她找来了一个长度为 $n$ 的字符串 $S$，决定任取 $S$ 的一个前缀 $P$，再任取 $S$ 的一个后缀 $Q$，将 $P$ 和 $Q$ 顺次连接起来得到的字符串 $P+Q$ 作为日记的内容。这里，空串也认为是 $S$ 的前缀和后缀，因此 $P$ 和 $Q$ 各有 $n+1$ 种取法。\n\n当然了，这样形成的很多字符串是无意义的。具体而言，小 M 认为一个已知的长度为 $m$ 的字符串 $T$ 为重要信息，所有包含该重要信息作为子串的字符串都是有意义的，反之则是无意义的。\n\n请你求出，小 M 一共能写出多少种本质不同的有意义的字符串。本质不同就是说，对于某个有意义的字符串 $A$ ，即使它可以被若干种取前缀和后缀的方式得到，也只应被计入一次。", "inputFormat": "输入共两行。\n\n第一行一个字符串 $S$。\n\n第二行一个字符串 $T$。", "outputFormat": "一行一个整数，所求答案。", "hint": "### 样例 1 解释\n\n对于第一组样例，所有能够形成的有意义字符串分别为  `ab`，`aab`，`aaab`，`aaaab`，`aabaab`，`aabab`，`aabb`，一共 $7$ 种。\n\n### 子任务\n\n对于所有测试数据，保证 $1 \\leq |S| \\leq 5 \\times 10^6$，$1 \\leq |T| \\leq 2|S|$，输入的字符串 $S$ 和 $T$ 仅包含小写英文字母。其中 $|S|,|T|$ 分别表示串 $S$ 和 $T$ 的长度。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/j2ymssdo.png)\n\n- 2023.8.21 添加一组 hack 数据。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[湖北省选模拟 2023] 日记 / diary", "background": "", "description": "小 M 决定开始写日记，但她不愿意花费太多时间构思日记的内容。为此，她找来了一个长度为 $n$ 的字符串 $S$，决定任取 $S$ 的一个前缀 $P$，再任取 $S$ 的一个后缀 $Q$，将 $P$ 和 $Q$ 顺次连接起来得到的字符串 $P+Q$ 作为日记的内容。这里，空串也认为是 $S$ 的前缀和后缀，因此 $P$ 和 $Q$ 各有 $n+1$ 种取法。\n\n当然了，这样形成的很多字符串是无意义的。具体而言，小 M 认为一个已知的长度为 $m$ 的字符串 $T$ 为重要信息，所有包含该重要信息作为子串的字符串都是有意义的，反之则是无意义的。\n\n请你求出，小 M 一共能写出多少种本质不同的有意义的字符串。本质不同就是说，对于某个有意义的字符串 $A$ ，即使它可以被若干种取前缀和后缀的方式得到，也只应被计入一次。", "inputFormat": "输入共两行。\n\n第一行一个字符串 $S$。\n\n第二行一个字符串 $T$。", "outputFormat": "一行一个整数，所求答案。", "hint": "### 样例 1 解释\n\n对于第一组样例，所有能够形成的有意义字符串分别为  `ab`，`aab`，`aaab`，`aaaab`，`aabaab`，`aabab`，`aabb`，一共 $7$ 种。\n\n### 子任务\n\n对于所有测试数据，保证 $1 \\leq |S| \\leq 5 \\times 10^6$，$1 \\leq |T| \\leq 2|S|$，输入的字符串 $S$ 和 $T$ 仅包含小写英文字母。其中 $|S|,|T|$ 分别表示串 $S$ 和 $T$ 的长度。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/j2ymssdo.png)\n\n- 2023.8.21 添加一组 hack 数据。", "locale": "zh-CN"}}}
{"pid": "P9544", "type": "P", "difficulty": 7, "samples": [["4 2 2 3\n1 1 5\n3 2 2\n3 3 1\n2 4 1\n1 2\n2 3\n2 4\n", "3"], ["8 3 269 1729\n607 777 617\n549 717 735\n341 672 988\n5 601 1395\n846 263 892\n796 954 251\n243 144 1614\n978 430 593\n2 1\n3 2\n4 1\n5 4\n6 2\n7 1\n8 5\n", "-1"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2023", "O2优化", "湖北"], "title": "[湖北省选模拟 2023] 调和 / concoct", "background": "", "description": "小 C 是一名药师，为了制作出某种药剂，她需要在 S 大陆上寻找一些药材。\n\nS 大陆可以抽象为一棵 $n$ 个顶点的无根树，每个顶点上都有一种药材。每种药材的属性可以描述为一个三元组 $(x,y,z)$，其中 $x$，$y$，$z$ 均为正整数。\n\n如果小 C 获得了 $n$ 种属性分别为 $(x_1,y_1,z_1), (x_2,y_2,z_2)  \\ldots  (x_n,y_n,z_n)$ 的 $n$ 种药材，她可以任取 $n$ 个不全为 $0$ 的非负实数 $a_1,a_2 \\ldots a_n$，将这些药材调和为一种属性为 $(\\sum a_i x_i,\\sum a_i y_i,\\sum a_i z_i)$ 的药剂。\n\n现在小 C 需要在 S 大陆上收集药材。具体而言，她需要选定树上的一个连通块，并获得连通块中所有顶点上的药材。现给定小 C 想制作的药剂的属性 $(a,b,c)$，请你求出，如果小 C 需要使用所获得的药材调和出属性为 $(a,b,c)$ 的药剂，她选定的连通块的大小至少是多少。", "inputFormat": "输入共 $2n$ 行。\n\n第一行四个正整数 $n,a,b,c$。\n\n接下来 $n$ 行，每行三个正整数 $x_i,y_i,z_i$，表示 $i$ 号节点上的药材的属性。\n\n接下来 $n-1$ 行，每行两个整数 $u$ 和 $v$，表示树上存在一条连接 $u$ 和 $v$ 的边。\n\n**保证输入的边描述的是一棵树。**\n\n**保证不存在两个完全相同的药材，但是可以存在某一个药材的属性和所需药剂完全一致。**\n\n**保证对于所有药材，都有 $x_i + y_i + z_i = a + b + c$。**", "outputFormat": "输出一行一个整数，为所求答案。", "hint": "### 样例 1 解释\n\n对于第一组样例，可以选择包含顶点 $1$，$2$ 和 $3$ 的连通块，取 $a_1,a_2,a_3$ 分别为 $\\dfrac{1}{2},0,\\dfrac{1}{2}$，即可得到属性为 $(\\dfrac{1}{2} + \\dfrac{3}{2},\\dfrac{1}{2} + \\dfrac{3}{2},\\dfrac{5}{2} + \\dfrac{1}{2}) = (2,2,3)$ 的药材。\n\n### 子任务\n\n对于所有测试数据，保证 $1 \\leq n \\leq 5 \\times 10^4$，$1 \\leq a,b,c,x_i,y_i,z_i \\leq 2 \\times 10^9$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qh0c3wfw.png)\n\n- 2023.8.25 添加一组 hack 数据。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[湖北省选模拟 2023] 调和 / concoct", "background": "", "description": "小 C 是一名药师，为了制作出某种药剂，她需要在 S 大陆上寻找一些药材。\n\nS 大陆可以抽象为一棵 $n$ 个顶点的无根树，每个顶点上都有一种药材。每种药材的属性可以描述为一个三元组 $(x,y,z)$，其中 $x$，$y$，$z$ 均为正整数。\n\n如果小 C 获得了 $n$ 种属性分别为 $(x_1,y_1,z_1), (x_2,y_2,z_2)  \\ldots  (x_n,y_n,z_n)$ 的 $n$ 种药材，她可以任取 $n$ 个不全为 $0$ 的非负实数 $a_1,a_2 \\ldots a_n$，将这些药材调和为一种属性为 $(\\sum a_i x_i,\\sum a_i y_i,\\sum a_i z_i)$ 的药剂。\n\n现在小 C 需要在 S 大陆上收集药材。具体而言，她需要选定树上的一个连通块，并获得连通块中所有顶点上的药材。现给定小 C 想制作的药剂的属性 $(a,b,c)$，请你求出，如果小 C 需要使用所获得的药材调和出属性为 $(a,b,c)$ 的药剂，她选定的连通块的大小至少是多少。", "inputFormat": "输入共 $2n$ 行。\n\n第一行四个正整数 $n,a,b,c$。\n\n接下来 $n$ 行，每行三个正整数 $x_i,y_i,z_i$，表示 $i$ 号节点上的药材的属性。\n\n接下来 $n-1$ 行，每行两个整数 $u$ 和 $v$，表示树上存在一条连接 $u$ 和 $v$ 的边。\n\n**保证输入的边描述的是一棵树。**\n\n**保证不存在两个完全相同的药材，但是可以存在某一个药材的属性和所需药剂完全一致。**\n\n**保证对于所有药材，都有 $x_i + y_i + z_i = a + b + c$。**", "outputFormat": "输出一行一个整数，为所求答案。", "hint": "### 样例 1 解释\n\n对于第一组样例，可以选择包含顶点 $1$，$2$ 和 $3$ 的连通块，取 $a_1,a_2,a_3$ 分别为 $\\dfrac{1}{2},0,\\dfrac{1}{2}$，即可得到属性为 $(\\dfrac{1}{2} + \\dfrac{3}{2},\\dfrac{1}{2} + \\dfrac{3}{2},\\dfrac{5}{2} + \\dfrac{1}{2}) = (2,2,3)$ 的药材。\n\n### 子任务\n\n对于所有测试数据，保证 $1 \\leq n \\leq 5 \\times 10^4$，$1 \\leq a,b,c,x_i,y_i,z_i \\leq 2 \\times 10^9$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qh0c3wfw.png)\n\n- 2023.8.25 添加一组 hack 数据。", "locale": "zh-CN"}}}
{"pid": "P9545", "type": "P", "difficulty": 6, "samples": [["5 2\n01001\n00110\n10001\n10101\n01000\n2 2 1 4\n5 2 4 1\n", "2\n3\n"], ["见选手目录下的 road/road2.in 与 road/road2.ans。", "见选手目录下的 road/road2.in 与 road/road2.ans。"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2023", "O2优化", "湖北"], "title": "[湖北省选模拟 2023] 环山危路 / road", "background": "", "description": "R 国有 $n$ 座城市，编号从 $1$ 到 $n$。这些城市两两之间都有道路连接，形成一个图的结构。不过，这些路修得很烂，每条路都有一个固定的方向，车只能按照这个方向行驶；路还是一次性的，也就是说最多只能过一辆车。\n\n现在 R 国正在制定防灾减灾预案。你需要帮助 R 国计算，如果 $t_i$ 号城市发生了灾难，并且 $s_{i,1},s_{i,2},\\dots,s_{i,k_i}$ 这些城市有充足的救灾物资（可以认为它们都拥有可以装无数辆车的物资），那么最多能从这些城市运送几车物资到达 $t_i$。车只能走城间的那些一次性道路，不过车在到达 $t_i$ 之前是可以经过多个城市和多条道路中转的。", "inputFormat": "输入共 $n+m +1$ 行。\n\n第一行两个正整数 $n,m$，表示城市个数和询问次数。\n\n第二行到第 $n+1$ 行，每行一个长为 $n$ 的 $01$ 字符串，第 $i+1$ 行第 $j$ 列表示是否有从 $i$ 通向 $j$ 的道路（$1$ 表示有，$0$ 表示无）。\n\n接下来 $m$ 行，每行第一个正整数为 $t_i$，第二个正整数为 $k_i$，接着 $k_i$ 个正整数 $s_{i,1},s_{i,2},\\dots,s_{i,k_i}$。保证 $s_{i,1},s_{i,2},\\dots,s_{i,k_i}$ 中没有重复的数且没有 $t_i$。", "outputFormat": "输出 $m$ 行，每行一个非负整数，表示第 $i$ 次询问的答案。", "hint": "### 样例 1 解释\n\n城市间的路如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3he9r0j2.png)\n\n这是答案对应的一种可能的方案：\n\n第一次询问中，一辆车走 $1 \\rightarrow 2$，另一辆走 $4 \\rightarrow 1 \\rightarrow 5 \\rightarrow 2$；\n\n第二次询问中，一辆车走 $1 \\rightarrow 5$，一辆走 $1 \\rightarrow 2 \\rightarrow 3 \\rightarrow5$，还有一辆走 $4 \\rightarrow 5$。\n\n### 子任务\n\n对于所有测试数据，保证 $1 \\le n \\le 3000$，$1 \\le m,\\sum\\limits_{i=1}^mk_i \\le 30000$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/d7a2om1c.png)\n\n特殊性质 A：保证所有询问的 $t_i$ 相等。\n\n特殊性质 B：保证 $u$ 与 $v$ 之间的路从 $\\min(u,v)$ 通向 $\\max(u,v)$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[湖北省选模拟 2023] 环山危路 / road", "background": "", "description": "R 国有 $n$ 座城市，编号从 $1$ 到 $n$。这些城市两两之间都有道路连接，形成一个图的结构。不过，这些路修得很烂，每条路都有一个固定的方向，车只能按照这个方向行驶；路还是一次性的，也就是说最多只能过一辆车。\n\n现在 R 国正在制定防灾减灾预案。你需要帮助 R 国计算，如果 $t_i$ 号城市发生了灾难，并且 $s_{i,1},s_{i,2},\\dots,s_{i,k_i}$ 这些城市有充足的救灾物资（可以认为它们都拥有可以装无数辆车的物资），那么最多能从这些城市运送几车物资到达 $t_i$。车只能走城间的那些一次性道路，不过车在到达 $t_i$ 之前是可以经过多个城市和多条道路中转的。", "inputFormat": "输入共 $n+m +1$ 行。\n\n第一行两个正整数 $n,m$，表示城市个数和询问次数。\n\n第二行到第 $n+1$ 行，每行一个长为 $n$ 的 $01$ 字符串，第 $i+1$ 行第 $j$ 列表示是否有从 $i$ 通向 $j$ 的道路（$1$ 表示有，$0$ 表示无）。\n\n接下来 $m$ 行，每行第一个正整数为 $t_i$，第二个正整数为 $k_i$，接着 $k_i$ 个正整数 $s_{i,1},s_{i,2},\\dots,s_{i,k_i}$。保证 $s_{i,1},s_{i,2},\\dots,s_{i,k_i}$ 中没有重复的数且没有 $t_i$。", "outputFormat": "输出 $m$ 行，每行一个非负整数，表示第 $i$ 次询问的答案。", "hint": "### 样例 1 解释\n\n城市间的路如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3he9r0j2.png)\n\n这是答案对应的一种可能的方案：\n\n第一次询问中，一辆车走 $1 \\rightarrow 2$，另一辆走 $4 \\rightarrow 1 \\rightarrow 5 \\rightarrow 2$；\n\n第二次询问中，一辆车走 $1 \\rightarrow 5$，一辆走 $1 \\rightarrow 2 \\rightarrow 3 \\rightarrow5$，还有一辆走 $4 \\rightarrow 5$。\n\n### 子任务\n\n对于所有测试数据，保证 $1 \\le n \\le 3000$，$1 \\le m,\\sum\\limits_{i=1}^mk_i \\le 30000$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/d7a2om1c.png)\n\n特殊性质 A：保证所有询问的 $t_i$ 相等。\n\n特殊性质 B：保证 $u$ 与 $v$ 之间的路从 $\\min(u,v)$ 通向 $\\max(u,v)$。", "locale": "zh-CN"}}}
{"pid": "P9546", "type": "P", "difficulty": 6, "samples": [["6 7\n0 1 0 2 3 0\n2 1 6\n1 1 1\n2 1 6\n2 4 5\n1 4 3\n2 3 5\n2 4 5\n", "3\n2\n2\n1\n0"], ["见选手目录下的 ring/ring2.in 与 ring/ring2.ans。", "见选手目录下的 ring/ring2.in 与 ring/ring2.ans。"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2023", "O2优化", "湖北"], "title": "[湖北省选模拟 2023] 山路长环 / ring", "background": null, "description": "张三和李四在玩游戏。游戏规则是这样的：\n\n在他们面前有一个棋盘，棋盘是一个由 $n$ 个节点和 $n$ 条边构成的环，边有边权。初始时，一枚棋子被放置在某个节点上。张三和李四轮流移动棋子，张三为先手，无法移动者败。每次移动时，必须选择棋子当前所在节点的某个相邻点（即有边相连的点），沿着边将棋子移动到这个相邻点去，并将边权减少任意正整数。需要注意的是，边权不允许被减小到负数。\n\n张三想让你算算，对于给定的棋盘，有多少种初始棋子的摆放方式能使得他有必胜策略。\n\n现在你有一个长为 $m$ 的序列 $a_1,a_2,\\dots,a_m$，你需要完成 $q$ 次操作。每次操作形式为如下之一：\n\n- `1 x y` 表示将 $a_x$ 赋值为 $y$；\n- `2 l r` 表示查询如果棋盘上共 $(r-l+1)$ 个节点，且边权以顺时针方向分别为 $a_l,a_{l+1},\\dots,a_r$，那么这样一盘游戏共有多少个不同的初始棋子位置可以让张三有必胜策略。", "inputFormat": "输入共 $q+2$ 行。\n\n第一行两个正整数 $m,q$。\n\n第二行 $m$ 个整数，第 $i$ 个数为 $a_i$。\n\n接下来 $q$ 行，每行三个整数，格式如题面所述。", "outputFormat": "输出若干行，每行一个非负整数，表示一次询问的答案。", "hint": "### 子任务\n\n对于所有测试数据，保证 $1 \\le m,q \\le 3 \\times 10^5$，$1 \\le l \\le r \\le m$，$1\\le x \\le m$，$0 \\le y,a_i \\le 10^6$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/j579v06f.png)\n\n特殊性质 A：保证 $0 \\le y,a_i \\le 1$。\n\n特殊性质 B：保证所有询问满足 $l=1$，$r=m$。\n\n特殊性质 C：保证没有修改操作。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[湖北省选模拟 2023] 山路长环 / ring", "background": null, "description": "张三和李四在玩游戏。游戏规则是这样的：\n\n在他们面前有一个棋盘，棋盘是一个由 $n$ 个节点和 $n$ 条边构成的环，边有边权。初始时，一枚棋子被放置在某个节点上。张三和李四轮流移动棋子，张三为先手，无法移动者败。每次移动时，必须选择棋子当前所在节点的某个相邻点（即有边相连的点），沿着边将棋子移动到这个相邻点去，并将边权减少任意正整数。需要注意的是，边权不允许被减小到负数。\n\n张三想让你算算，对于给定的棋盘，有多少种初始棋子的摆放方式能使得他有必胜策略。\n\n现在你有一个长为 $m$ 的序列 $a_1,a_2,\\dots,a_m$，你需要完成 $q$ 次操作。每次操作形式为如下之一：\n\n- `1 x y` 表示将 $a_x$ 赋值为 $y$；\n- `2 l r` 表示查询如果棋盘上共 $(r-l+1)$ 个节点，且边权以顺时针方向分别为 $a_l,a_{l+1},\\dots,a_r$，那么这样一盘游戏共有多少个不同的初始棋子位置可以让张三有必胜策略。", "inputFormat": "输入共 $q+2$ 行。\n\n第一行两个正整数 $m,q$。\n\n第二行 $m$ 个整数，第 $i$ 个数为 $a_i$。\n\n接下来 $q$ 行，每行三个整数，格式如题面所述。", "outputFormat": "输出若干行，每行一个非负整数，表示一次询问的答案。", "hint": "### 子任务\n\n对于所有测试数据，保证 $1 \\le m,q \\le 3 \\times 10^5$，$1 \\le l \\le r \\le m$，$1\\le x \\le m$，$0 \\le y,a_i \\le 10^6$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/j579v06f.png)\n\n特殊性质 A：保证 $0 \\le y,a_i \\le 1$。\n\n特殊性质 B：保证所有询问满足 $l=1$，$r=m$。\n\n特殊性质 C：保证没有修改操作。", "locale": "zh-CN"}}}
{"pid": "P9547", "type": "P", "difficulty": 7, "samples": [["3 2 1 0\n‐10838702 0 10838702\n‐1 1", "1 0"], ["4 4 2 0\n1 3 5 7\n2 4 6 8", "0.6648289523 ‐0.1433645347\n0.6172866488 1.3647253547"], ["见选手目录下的 mountain/mountain3.in 与 mountain/mountain3.ans。", "见选手目录下的 mountain/mountain3.in 与 mountain/mountain3.ans。"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2023", "Special Judge", "O2优化", "湖北"], "title": "[湖北省选模拟 2023] 路环群山 / mountain", "background": "", "description": "某二维世界中有一个山地，山体可以用一个函数 $f(x)$ 描述，其表示横坐标 $x$ 的位置海拔高度为 $h=f(x)$。这个世界里有 $n+m$ 只羊，其中有 $n$ 只山羊和 $m$ 只绵羊。我们知道第 $i$ 只山羊所在的横坐标是 $p_i$，第 $j$ 只绵羊所在的横坐标是 $q_j$，但不知道它们所在的高度。不过，我们知道山羊们所在的位置海拔集中在一个较高的范围，而绵羊们所在的位置海拔集中在一个较矮的范围。你需要根据山羊和绵羊的分布情况猜测山体形态 $f(x)$，使得山羊高度的方差和绵羊高度的方差都尽可能小，同时山羊高度尽可能高于绵羊高度。\n\n形式化地，令\n\n$$\n\\bar{u}=\\frac{1}{n}\\sum_{i=1}^n f(p_i)\n$$\n\n$$\n\\bar{v}=\\frac{1}{m}\\sum_{j=1}^m f(q_i)\n$$\n\n表示山羊、绵羊分别的平均高度，你的目标就是构造函数 $f$，最小化代价\n$$\n\\operatorname{cost}(f)=\\frac{1}{\\bar{u}-\\bar{v}}\\sqrt{\\left[\\sum_{i=1}^n (f(p_i)-\\bar{u})^2\\right]+\\left[\\sum_{j=1}^m (f(q_j)-\\bar{v})^2\\right]}\n$$\n当然，**你还需要保证 $\\bar u > \\bar v + 10^{-9}$**。\n\n方便起见，你需要使用傅里叶级数描述 $f$。即给定 $k$，你需要求出最优的形如 $f(x)=\\sum_{i=1}^k a_i\\cos(ix)+b_i\\sin(ix)$ 的函数 $f$，并输出 $a_i,b_i$ 表示答案。**请你保证 $10^{-9}\\le \\max_{i=1}^k\\{|a_i|,|b_i|\\} \\le 10^9$**。**数据保证存在满足上述限制的最优解。**\n\n本题开启 Special Judge。给定容错度 $\\epsilon=10^{-E}$。当你给出的函数 $f$ 与答案给出的函数 $f^*$ 满足 $\\operatorname{cost}(f)<\\max(\\epsilon+\\operatorname{cost}(f^*),(1+\\epsilon)\\operatorname{cost}(f^*))$ 时认为你的答案正确。", "inputFormat": "输入共三行。\n\n第一行三个整数 $n,m,k,E$；\n\n第二行 $n$ 个整数，第 $i$ 个数为 $p_i$；\n\n第三行 $m$ 个整数，第 $j$ 个数为 $q_j$。", "outputFormat": "输出 $k$ 行，每行两个浮点数 $a_i,b_i$。", "hint": "### 样例 1 解释\n\n观察到 $\\cos(10838702)=\\cos(-10838702)\\approx 1 =\\cos(0)$，$\\cos(1)=\\cos(-1)\\approx 0.5403023$。即当 $f(x)=\\cos(x)$ 时，所有山羊几乎均位于同一海拔、所有绵羊均位于同一海拔、山羊所在位置均高于绵羊所在位置。此时 $\\operatorname{cost}(f) \\approx 0$ 取得最优解。\n\n值得注意的是，对于任何非零数 $r$，函数 $f(x)=r\\cos(x)$ 均可视为最优解。\n\n### 样例 2 解释\n\n最优函数（之一）约为 $f(x)=0.6648289523\\cos(x)-0.1433645347\\sin(x)+0.6172866488\\cos(2x)+1.3647253547\\sin(2x)$，其代价约为 $3.908439063011$。\n\n### 子任务\n\n对于所有测试数据，保证 $1 \\le n,m \\le 600$，$1 \\le k \\le \\min\\{\\dfrac{n+m}{4},300\\}$，$0 \\le E \\le 9$，$0\\le |p_i|,|q_i| \\le 10^9$。\n\n**保证每个测试数据中，$p_i$ 和 $q_j$ 均在该测试点数据范围内以及问题有解的条件下均匀随机生成。**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/91am18bk.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[湖北省选模拟 2023] 路环群山 / mountain", "background": "", "description": "某二维世界中有一个山地，山体可以用一个函数 $f(x)$ 描述，其表示横坐标 $x$ 的位置海拔高度为 $h=f(x)$。这个世界里有 $n+m$ 只羊，其中有 $n$ 只山羊和 $m$ 只绵羊。我们知道第 $i$ 只山羊所在的横坐标是 $p_i$，第 $j$ 只绵羊所在的横坐标是 $q_j$，但不知道它们所在的高度。不过，我们知道山羊们所在的位置海拔集中在一个较高的范围，而绵羊们所在的位置海拔集中在一个较矮的范围。你需要根据山羊和绵羊的分布情况猜测山体形态 $f(x)$，使得山羊高度的方差和绵羊高度的方差都尽可能小，同时山羊高度尽可能高于绵羊高度。\n\n形式化地，令\n\n$$\n\\bar{u}=\\frac{1}{n}\\sum_{i=1}^n f(p_i)\n$$\n\n$$\n\\bar{v}=\\frac{1}{m}\\sum_{j=1}^m f(q_i)\n$$\n\n表示山羊、绵羊分别的平均高度，你的目标就是构造函数 $f$，最小化代价\n$$\n\\operatorname{cost}(f)=\\frac{1}{\\bar{u}-\\bar{v}}\\sqrt{\\left[\\sum_{i=1}^n (f(p_i)-\\bar{u})^2\\right]+\\left[\\sum_{j=1}^m (f(q_j)-\\bar{v})^2\\right]}\n$$\n当然，**你还需要保证 $\\bar u > \\bar v + 10^{-9}$**。\n\n方便起见，你需要使用傅里叶级数描述 $f$。即给定 $k$，你需要求出最优的形如 $f(x)=\\sum_{i=1}^k a_i\\cos(ix)+b_i\\sin(ix)$ 的函数 $f$，并输出 $a_i,b_i$ 表示答案。**请你保证 $10^{-9}\\le \\max_{i=1}^k\\{|a_i|,|b_i|\\} \\le 10^9$**。**数据保证存在满足上述限制的最优解。**\n\n本题开启 Special Judge。给定容错度 $\\epsilon=10^{-E}$。当你给出的函数 $f$ 与答案给出的函数 $f^*$ 满足 $\\operatorname{cost}(f)<\\max(\\epsilon+\\operatorname{cost}(f^*),(1+\\epsilon)\\operatorname{cost}(f^*))$ 时认为你的答案正确。", "inputFormat": "输入共三行。\n\n第一行三个整数 $n,m,k,E$；\n\n第二行 $n$ 个整数，第 $i$ 个数为 $p_i$；\n\n第三行 $m$ 个整数，第 $j$ 个数为 $q_j$。", "outputFormat": "输出 $k$ 行，每行两个浮点数 $a_i,b_i$。", "hint": "### 样例 1 解释\n\n观察到 $\\cos(10838702)=\\cos(-10838702)\\approx 1 =\\cos(0)$，$\\cos(1)=\\cos(-1)\\approx 0.5403023$。即当 $f(x)=\\cos(x)$ 时，所有山羊几乎均位于同一海拔、所有绵羊均位于同一海拔、山羊所在位置均高于绵羊所在位置。此时 $\\operatorname{cost}(f) \\approx 0$ 取得最优解。\n\n值得注意的是，对于任何非零数 $r$，函数 $f(x)=r\\cos(x)$ 均可视为最优解。\n\n### 样例 2 解释\n\n最优函数（之一）约为 $f(x)=0.6648289523\\cos(x)-0.1433645347\\sin(x)+0.6172866488\\cos(2x)+1.3647253547\\sin(2x)$，其代价约为 $3.908439063011$。\n\n### 子任务\n\n对于所有测试数据，保证 $1 \\le n,m \\le 600$，$1 \\le k \\le \\min\\{\\dfrac{n+m}{4},300\\}$，$0 \\le E \\le 9$，$0\\le |p_i|,|q_i| \\le 10^9$。\n\n**保证每个测试数据中，$p_i$ 和 $q_j$ 均在该测试点数据范围内以及问题有解的条件下均匀随机生成。**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/91am18bk.png)", "locale": "zh-CN"}}}
{"pid": "P9548", "type": "P", "difficulty": 2, "samples": [["4 4 2 2 3", "1 3"], ["7 5 3 2 2", "3 5"], ["214 748 3 64 8", "98 782"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["模拟", "贪心", "O2优化"], "title": "「PHOI-1」雨纷纷", "background": "**形式化题面的表述已更改。**\n\n今夜，雨纷纷……\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/aec4ykim.png)", "description": "在 $n$ 行 $m$ 列的空地上，有一个大小为 $x$ 行 $y$ 列的伞，雨伞不可以旋转。每天向空地随机洒下 $1 \\sim k$ 滴雨，已经有雨的格子不会再降下雨，有伞的格子不会被雨淋湿。\n\n但此伞比较特殊，它完全透明，小 X 无法直接得知伞的位置。但是每天结束后，小 X 都会得知空地上每个空格的状态，即有雨滴或无雨滴。注意，小 X 只会得知格子的状态。小 X 无法得知每天在哪里降了雨。\n\n现在小 X 想让你求出**在最好情况下**（即天数最少时）几天可以使伞的位置唯一，以及得到伞的位置后，场上至少的雨滴数量，数据保证有解。\n\n**形式化的讲**，有一个 $n \\times m$ 的矩形，你每天可以**至多**删除 $k$ 个格子。问至少需要多少天以及至少需要删除多少格子，才能使得图中完整的 $x\\times y$ 的矩形唯一。", "inputFormat": "一行，$5$ 个整数，分别为 $n,m,x,y,k$。", "outputFormat": "一行，分别为**在最好情况下**几天可以得知伞的位置，以及得到伞的位置后，场上至少的雨滴数量，两个数据用空格隔开。", "hint": "**本题采用捆绑测试。**\n\n| Subtask | $n,m$ | $x,y$ |  分值 |\n| :-: | :-: | :-: | :-: |\n| $0$ | $1\\le n,m\\le 10$ | 无特殊限制 | $10$ |\n| $1$ | $1\\le n,m\\le 10^3$ | 无特殊限制 | $30$ |\n| $2$ | 无特殊限制 | $x=y=2$ | $10$ |\n| $3$ | 无特殊限制 | $1 \\le x=y \\le 10^9$ | $10$ | \n| $4$ | 无特殊限制 | 无特殊限制 | $40$ | \n\n对于 $100\\%$ 的数据，保证 $1 \\le x \\le n \\le 10^9,1 \\le y \\le m \\le 10^9,1 \\le k \\le 10^9$。\n\n### 样例解释 #1：\n\n第一天在 $(2,2),(2,3),(3,2)$ 处落下雨滴，即可确定雨伞左上角以及右下角位置为 $(3,3),(4,4)$。\n\n图片解释：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/fp2m6ivv.png)\n### 样例解释 #2：\n\n第一天在 $(2,2),(7,1)$ 处落下雨滴，第二天在 $(5,4)$ 处落下雨滴，第三天在 $(4,2),(3,4)$ 处落下雨滴，即可确定雨伞左上角以及右下角位置为 $(5,2),(7,3)$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「PHOI-1」雨纷纷", "background": "**形式化题面的表述已更改。**\n\n今夜，雨纷纷……\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/aec4ykim.png)", "description": "在 $n$ 行 $m$ 列的空地上，有一个大小为 $x$ 行 $y$ 列的伞，雨伞不可以旋转。每天向空地随机洒下 $1 \\sim k$ 滴雨，已经有雨的格子不会再降下雨，有伞的格子不会被雨淋湿。\n\n但此伞比较特殊，它完全透明，小 X 无法直接得知伞的位置。但是每天结束后，小 X 都会得知空地上每个空格的状态，即有雨滴或无雨滴。注意，小 X 只会得知格子的状态。小 X 无法得知每天在哪里降了雨。\n\n现在小 X 想让你求出**在最好情况下**（即天数最少时）几天可以使伞的位置唯一，以及得到伞的位置后，场上至少的雨滴数量，数据保证有解。\n\n**形式化的讲**，有一个 $n \\times m$ 的矩形，你每天可以**至多**删除 $k$ 个格子。问至少需要多少天以及至少需要删除多少格子，才能使得图中完整的 $x\\times y$ 的矩形唯一。", "inputFormat": "一行，$5$ 个整数，分别为 $n,m,x,y,k$。", "outputFormat": "一行，分别为**在最好情况下**几天可以得知伞的位置，以及得到伞的位置后，场上至少的雨滴数量，两个数据用空格隔开。", "hint": "**本题采用捆绑测试。**\n\n| Subtask | $n,m$ | $x,y$ |  分值 |\n| :-: | :-: | :-: | :-: |\n| $0$ | $1\\le n,m\\le 10$ | 无特殊限制 | $10$ |\n| $1$ | $1\\le n,m\\le 10^3$ | 无特殊限制 | $30$ |\n| $2$ | 无特殊限制 | $x=y=2$ | $10$ |\n| $3$ | 无特殊限制 | $1 \\le x=y \\le 10^9$ | $10$ | \n| $4$ | 无特殊限制 | 无特殊限制 | $40$ | \n\n对于 $100\\%$ 的数据，保证 $1 \\le x \\le n \\le 10^9,1 \\le y \\le m \\le 10^9,1 \\le k \\le 10^9$。\n\n### 样例解释 #1：\n\n第一天在 $(2,2),(2,3),(3,2)$ 处落下雨滴，即可确定雨伞左上角以及右下角位置为 $(3,3),(4,4)$。\n\n图片解释：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/fp2m6ivv.png)\n### 样例解释 #2：\n\n第一天在 $(2,2),(7,1)$ 处落下雨滴，第二天在 $(5,4)$ 处落下雨滴，第三天在 $(4,2),(3,4)$ 处落下雨滴，即可确定雨伞左上角以及右下角位置为 $(5,2),(7,3)$。", "locale": "zh-CN"}}}
{"pid": "P9549", "type": "P", "difficulty": 4, "samples": [["5 8 6 1\n1 2 2\n1 0 3\n1 1 4\n3 1 0\n5 1 4\n1 2 1 4\n2 4 2 4\n3 4 0 2\n1 5 7 8\n1 3 1 2\n5 4 2 3\n2 5 2 4\n1 4 4 7", "4"], ["9 16 14 2\n1 7 2\n1 5 3\n1 6 4\n3 5 0\n1 6 5\n1 0 4\n1 7 5\n3 8 8\n3 8 6\n1 2 1 4\n8 5 2 6\n2 4 2 4\n8 6 3 5\n3 4 0 2\n6 7 1 4\n1 5 7 8\n5 9 16 21\n1 3 2 2\n7 6 2 3\n5 4 2 3\n6 9 3 5\n2 5 2 4\n8 9 4 7\n1 4 4 7\n6 5 6 9", "18"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["模拟", "图论", "O2优化", "最短路"], "title": "「PHOI-1」路虽远", "background": "$update$ $on$ $2023.8.17$ $12:25$ \n**数据修复&加强完成，可重新提交代码。**\n\n路虽远，行则将至。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ugqt01zi.png)", "description": "**请注意本题特殊的时限。**\n\n小 X 来到了 Z 市，Z 市有 $n$ 个交通路口，$m$ 条马路。其中第 $i$ 条马路连接着第 $u_i$ 个交通路口和第 $v_i$ 个交通路口（可以从 $u_i$ 到 $v_i$，也可以从 $v_i$ 到 $u_i$），小 X 通过这条马路时要花费 $p_i$ 秒，若有限速，则通过这条马路时要花费 $q_i$ 秒。\n\n现在，市长要在 $k$ 条马路上添加限速，然而，要在哪 $k$ 条马路上限速是小 X 自己规定的。\n\n同时，市长会在每个交通路口处添加红绿灯。第 $i$ 个交通路口的红绿灯先亮绿灯 $x_i$ 秒，再亮黄灯 $y_i$ 秒，之后亮红灯 $z_i$ 秒，然后再亮绿灯，黄灯，红灯，如此往复。如果一个交通路口的红绿灯不是红灯，小 X 可以从这个交通路口出发，到达另一个交通路口。若到达交通路口时，灯的颜色瞬间变了，则按照变了之后的灯计算，灯的黄灯和红灯的持续时间可能为 $0$。并且，小 X 最多只能闯 $g$ 次黄灯。\n\n过了一会儿，市长突然发现，所有的红绿灯在某一刻都变成了绿灯。与此同时，小 X 从第 $1$ 个路口出发，前往第 $n$ 个路口。他想问你，他至少要花多少时间才能到达第 $n$ 个路口？\n\n因为路虽远，行则将至，数据保证一定可以到达，即 $1\\sim n$ 一定连通。", "inputFormat": "第 $1$ 行 $4$ 个整数 $n,m,k,g$。\n\n接下来 $n$ 行，每行 $3$ 个整数 $x_i,y_i,z_i$。\n\n接下来 $m$ 行，每行 $4$ 个整数 $u_i,v_i,p_i,q_i$。", "outputFormat": "一行，为小 X 花费的最少的时间。", "hint": "**本题采用捆绑测试。**\n\n| Subtask | $n,m$ | $y_i,z_i$ | $k,g$ | 分值 |\n| :-: | :-: | :-: | :-: | :-: |\n| $0$ | $1 \\le n,m \\le 5$ | 无特殊限制 | 无特殊限制 | $20$ |\n| $1$ | 无特殊限制 | $y_i=z_i=0$ | $k=g=0$ | $5$ |\n| $2$ | 无特殊限制 | $y_i=0,0 \\le z_i \\le 10^9$ | 无特殊限制 | $25$ | \n| $3$ | 无特殊限制 | 无特殊限制 | 无特殊限制 | $50$ |\n\n对于 $100\\%$ 的数据，保证 $1 \\le n,m \\le 100$，$0 \\le k,g \\le m$，$1 \\le x_i \\le 10^9$，$0 \\le y_i,z_i \\le 10^9$，$1 \\le u,v \\le n$，$0 \\leq p_i \\leq q_i \\leq 10^9$。\n### 样例解释 #1：\n\n\n$1 \\to 3 \\to 4 \\to 5$ 并在编号为 $1,2,4,6,7,8$ 的马路上添加限速，到 $3$ 时闯黄灯，到 $4$ 时绿灯直接过，这时候，$1 \\to 3$ 花费 $1$ 秒，$3 \\to 4$ 花费 $0$ 秒，$4 \\to 5$ 花费 $3$ 秒，共花费 $4$ 秒。\n\n### 样例解释 #2：\n\n$1 \\to 2 \\to 5 \\to 6 \\to 9$ 并在编号为 $2,3,4,5,6,7,8,9,10,11,13,14,15,16$ 的马路上添加限速，到 $2,5$ 时闯黄灯，到 $4$ 时绿灯直接过，到 $6$ 时等 $1$ 秒红灯，这时候，$1 \\to 2$ 花费 $1$ 秒，$2 \\to 5$ 花费 $4$ 秒，$5 \\to 6$ 花费 $9$ 秒，$6 \\to 9$ 花费 $3$ 秒，加上等红灯的 $1$ 秒共花费 $18$ 秒。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「PHOI-1」路虽远", "background": "$update$ $on$ $2023.8.17$ $12:25$ \n**数据修复&加强完成，可重新提交代码。**\n\n路虽远，行则将至。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ugqt01zi.png)", "description": "**请注意本题特殊的时限。**\n\n小 X 来到了 Z 市，Z 市有 $n$ 个交通路口，$m$ 条马路。其中第 $i$ 条马路连接着第 $u_i$ 个交通路口和第 $v_i$ 个交通路口（可以从 $u_i$ 到 $v_i$，也可以从 $v_i$ 到 $u_i$），小 X 通过这条马路时要花费 $p_i$ 秒，若有限速，则通过这条马路时要花费 $q_i$ 秒。\n\n现在，市长要在 $k$ 条马路上添加限速，然而，要在哪 $k$ 条马路上限速是小 X 自己规定的。\n\n同时，市长会在每个交通路口处添加红绿灯。第 $i$ 个交通路口的红绿灯先亮绿灯 $x_i$ 秒，再亮黄灯 $y_i$ 秒，之后亮红灯 $z_i$ 秒，然后再亮绿灯，黄灯，红灯，如此往复。如果一个交通路口的红绿灯不是红灯，小 X 可以从这个交通路口出发，到达另一个交通路口。若到达交通路口时，灯的颜色瞬间变了，则按照变了之后的灯计算，灯的黄灯和红灯的持续时间可能为 $0$。并且，小 X 最多只能闯 $g$ 次黄灯。\n\n过了一会儿，市长突然发现，所有的红绿灯在某一刻都变成了绿灯。与此同时，小 X 从第 $1$ 个路口出发，前往第 $n$ 个路口。他想问你，他至少要花多少时间才能到达第 $n$ 个路口？\n\n因为路虽远，行则将至，数据保证一定可以到达，即 $1\\sim n$ 一定连通。", "inputFormat": "第 $1$ 行 $4$ 个整数 $n,m,k,g$。\n\n接下来 $n$ 行，每行 $3$ 个整数 $x_i,y_i,z_i$。\n\n接下来 $m$ 行，每行 $4$ 个整数 $u_i,v_i,p_i,q_i$。", "outputFormat": "一行，为小 X 花费的最少的时间。", "hint": "**本题采用捆绑测试。**\n\n| Subtask | $n,m$ | $y_i,z_i$ | $k,g$ | 分值 |\n| :-: | :-: | :-: | :-: | :-: |\n| $0$ | $1 \\le n,m \\le 5$ | 无特殊限制 | 无特殊限制 | $20$ |\n| $1$ | 无特殊限制 | $y_i=z_i=0$ | $k=g=0$ | $5$ |\n| $2$ | 无特殊限制 | $y_i=0,0 \\le z_i \\le 10^9$ | 无特殊限制 | $25$ | \n| $3$ | 无特殊限制 | 无特殊限制 | 无特殊限制 | $50$ |\n\n对于 $100\\%$ 的数据，保证 $1 \\le n,m \\le 100$，$0 \\le k,g \\le m$，$1 \\le x_i \\le 10^9$，$0 \\le y_i,z_i \\le 10^9$，$1 \\le u,v \\le n$，$0 \\leq p_i \\leq q_i \\leq 10^9$。\n### 样例解释 #1：\n\n\n$1 \\to 3 \\to 4 \\to 5$ 并在编号为 $1,2,4,6,7,8$ 的马路上添加限速，到 $3$ 时闯黄灯，到 $4$ 时绿灯直接过，这时候，$1 \\to 3$ 花费 $1$ 秒，$3 \\to 4$ 花费 $0$ 秒，$4 \\to 5$ 花费 $3$ 秒，共花费 $4$ 秒。\n\n### 样例解释 #2：\n\n$1 \\to 2 \\to 5 \\to 6 \\to 9$ 并在编号为 $2,3,4,5,6,7,8,9,10,11,13,14,15,16$ 的马路上添加限速，到 $2,5$ 时闯黄灯，到 $4$ 时绿灯直接过，到 $6$ 时等 $1$ 秒红灯，这时候，$1 \\to 2$ 花费 $1$ 秒，$2 \\to 5$ 花费 $4$ 秒，$5 \\to 6$ 花费 $9$ 秒，$6 \\to 9$ 花费 $3$ 秒，加上等红灯的 $1$ 秒共花费 $18$ 秒。", "locale": "zh-CN"}}}
{"pid": "P9550", "type": "P", "difficulty": 6, "samples": [["3\n0 1 1\n0 1 2\n0 0 2\n0 1 2\n2 0 4", "0 inf inf\ninf -2 inf\ninf 1 -4"], ["10\n0 1 1 2 2 2 3 3 3 3\n0 1 2 2 3 3 3 4 4 4\n0 1 2 2 3 3 3 3 4 4\n0 1 2 3 4 4 5 5 5 5\n8 4 2 1 2 4 8 4 2 1", "0 inf inf inf inf inf inf inf inf inf\ninf 18 inf inf inf inf inf inf inf inf\ninf 15 20 18 inf inf inf inf inf inf\ninf inf 18 16 inf inf inf inf inf inf\ninf inf 12 10 8 9 12 7 4 2\ninf inf 13 11 9 10 13 8 5 3\ninf inf 16 14 12 13 16 11 8 6\ninf inf 11 7 3 4 7 2 -1 -3\ninf inf 8 4 0 1 4 -1 -4 -6\ninf inf 6 2 -2 -1 2 -3 -6 -8"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["O2优化"], "title": "「PHOI-1」晚宴筵", "background": "小 X 在 Z 市长途奔波之后，他要去参加别人的晚宴。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2cpdwvwu.png)", "description": "Z 市形如一个 $n \\times n$ 的矩阵，小 X 打算仅使用瞬移机和时空穿越机到达别人的晚宴，若小 X 所在的位置 $(p,q)$ 满足 $l1_x \\le p \\le r1_x$ 且 $l2_y \\le q \\le r2_y(0 \\le l1_x \\le r1_x < x,0\\le l2_y\\le r2_y < y)$，那么小 X 就可以到达位置 $(x,y)$。\n\n但是由于瞬移技术不太成熟以及时空穿越机的影响，瞬移时需花费 $w_p+w_q+w_x+w_y-p-q-x-y$ 秒（由于时空穿越机的特性，时间可能为负）。若下标不是正整数，瞬移机就会被损坏，所以小 X 只能到达都是正整数的下标。\n\n现在小 X 在 $(1,1)$ 的位置，他要参加别人的晚宴，可是他目前不知道别人的晚宴在哪里，所以他想让你求，他到达每个地方 $(x,y)\\text{ }\\text{ }(1 \\leq x,y \\leq n)$ 所花费的最少时间，如果不能到达则输出 `inf`。", "inputFormat": "第 $1$ 行一个整数 $n$，表示矩阵的大小。\n\n第 $2$ 行 $n$ 个非负整数分别表示 $l1_1,l1_2 \\ldots l1_n$。\n\n第 $3$ 行 $n$ 个非负整数分别表示 $r1_1,r1_2 \\ldots r1_n$。\n\n第 $4$ 行 $n$ 个非负整数分别表示 $l2_1,l2_2 \\ldots l2_n$。\n\n第 $5$ 行 $n$ 个非负整数分别表示 $r2_1,r2_2 \\ldots r2_n$。\n\n第 $6$ 行 $n$ 个非负整数分别表示 $w_1,w_2 \\ldots w_n$。\n\n数据保证 $l1_i \\leq r1_i,l2_i \\leq r2_i$。", "outputFormat": "输出 $n$ 行，每行 $n$ 个整数，第 $i$ 行第 $j$ 列的整数表示小 X 从 $(1,1)$ 到 $(i,j)$ 的最短路。", "hint": "**本题采用捆绑测试。**\n\n| Subtask | $n$ | $l1_i,l2_i$ | $w_i$ | 分值 |\n| :-: | :-: | :-: | :-: | :-: |\n| $0$ | $1 \\le n \\le 70$ | 无特殊限制 | $i \\leq w_i \\leq 10^5(1 \\leq i \\leq n)$ | $15$ |\n| $1$ | $1 \\le n \\le 70$ | 无特殊限制 | 无特殊限制 | $25$ |\n| $2$ | 无特殊限制 | $l1_i=l2_i=r1_i=r2_i=1(2\\le i \\le n)$ | 无特殊限制 | $5$ |\n| $3$ | 无特殊限制 | 无特殊限制 | 无特殊限制 | $55$ | \n\n对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 10^3,0 \\leq l1_i \\leq r1_i \\leq n,0 \\leq l2_i \\leq r2_i \\leq n,0 \\leq w_i \\leq 10^5$ $,l1_i \\leq r1_i < i,l2_i \\leq r2_i < i $。\n\n### 样例解释 #1:\n\n- 从 $(1,1)$ 到 $(1,1)$ 显然要花费 $0$ 秒。\n\n- 从 $(1,1)$ 可以直接到 $(2,2)$, 花费 $w_1 + w_1 + w_2 + w_2 - 1 - 1 - 2 - 2 = -2$ 秒。\n\n- 从 $(1,1)$ 也可以直接到 $(3,2)$, 花费 $w_1 + w_1 + w_3 + w_2 - 1 - 1 - 3 - 2 = 1$ 秒。\n\n- 要从 $(1,1)$ 到达 $(3,3)$，要先从 $(1,1)$ 到达 $(2,2)$，再从 $(2,2)$ 到达 $(3,3)$。花费 $w_1 + w_1 + w_2 + w_2 - 1 - 1 - 2 - 2 + w_2 + w_2 + w_3 + w_3 - 2 - 2 - 3 - 3 = -4$ 秒。\n\n- 经过手算，可以发现，从 $(1,1)$ 不能到达其他位置。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「PHOI-1」晚宴筵", "background": "小 X 在 Z 市长途奔波之后，他要去参加别人的晚宴。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2cpdwvwu.png)", "description": "Z 市形如一个 $n \\times n$ 的矩阵，小 X 打算仅使用瞬移机和时空穿越机到达别人的晚宴，若小 X 所在的位置 $(p,q)$ 满足 $l1_x \\le p \\le r1_x$ 且 $l2_y \\le q \\le r2_y(0 \\le l1_x \\le r1_x < x,0\\le l2_y\\le r2_y < y)$，那么小 X 就可以到达位置 $(x,y)$。\n\n但是由于瞬移技术不太成熟以及时空穿越机的影响，瞬移时需花费 $w_p+w_q+w_x+w_y-p-q-x-y$ 秒（由于时空穿越机的特性，时间可能为负）。若下标不是正整数，瞬移机就会被损坏，所以小 X 只能到达都是正整数的下标。\n\n现在小 X 在 $(1,1)$ 的位置，他要参加别人的晚宴，可是他目前不知道别人的晚宴在哪里，所以他想让你求，他到达每个地方 $(x,y)\\text{ }\\text{ }(1 \\leq x,y \\leq n)$ 所花费的最少时间，如果不能到达则输出 `inf`。", "inputFormat": "第 $1$ 行一个整数 $n$，表示矩阵的大小。\n\n第 $2$ 行 $n$ 个非负整数分别表示 $l1_1,l1_2 \\ldots l1_n$。\n\n第 $3$ 行 $n$ 个非负整数分别表示 $r1_1,r1_2 \\ldots r1_n$。\n\n第 $4$ 行 $n$ 个非负整数分别表示 $l2_1,l2_2 \\ldots l2_n$。\n\n第 $5$ 行 $n$ 个非负整数分别表示 $r2_1,r2_2 \\ldots r2_n$。\n\n第 $6$ 行 $n$ 个非负整数分别表示 $w_1,w_2 \\ldots w_n$。\n\n数据保证 $l1_i \\leq r1_i,l2_i \\leq r2_i$。", "outputFormat": "输出 $n$ 行，每行 $n$ 个整数，第 $i$ 行第 $j$ 列的整数表示小 X 从 $(1,1)$ 到 $(i,j)$ 的最短路。", "hint": "**本题采用捆绑测试。**\n\n| Subtask | $n$ | $l1_i,l2_i$ | $w_i$ | 分值 |\n| :-: | :-: | :-: | :-: | :-: |\n| $0$ | $1 \\le n \\le 70$ | 无特殊限制 | $i \\leq w_i \\leq 10^5(1 \\leq i \\leq n)$ | $15$ |\n| $1$ | $1 \\le n \\le 70$ | 无特殊限制 | 无特殊限制 | $25$ |\n| $2$ | 无特殊限制 | $l1_i=l2_i=r1_i=r2_i=1(2\\le i \\le n)$ | 无特殊限制 | $5$ |\n| $3$ | 无特殊限制 | 无特殊限制 | 无特殊限制 | $55$ | \n\n对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 10^3,0 \\leq l1_i \\leq r1_i \\leq n,0 \\leq l2_i \\leq r2_i \\leq n,0 \\leq w_i \\leq 10^5$ $,l1_i \\leq r1_i < i,l2_i \\leq r2_i < i $。\n\n### 样例解释 #1:\n\n- 从 $(1,1)$ 到 $(1,1)$ 显然要花费 $0$ 秒。\n\n- 从 $(1,1)$ 可以直接到 $(2,2)$, 花费 $w_1 + w_1 + w_2 + w_2 - 1 - 1 - 2 - 2 = -2$ 秒。\n\n- 从 $(1,1)$ 也可以直接到 $(3,2)$, 花费 $w_1 + w_1 + w_3 + w_2 - 1 - 1 - 3 - 2 = 1$ 秒。\n\n- 要从 $(1,1)$ 到达 $(3,3)$，要先从 $(1,1)$ 到达 $(2,2)$，再从 $(2,2)$ 到达 $(3,3)$。花费 $w_1 + w_1 + w_2 + w_2 - 1 - 1 - 2 - 2 + w_2 + w_2 + w_3 + w_3 - 2 - 2 - 3 - 3 = -4$ 秒。\n\n- 经过手算，可以发现，从 $(1,1)$ 不能到达其他位置。", "locale": "zh-CN"}}}
{"pid": "P9551", "type": "P", "difficulty": 6, "samples": [["2 2\n2 1\n3\n4\n", "4\n7\n"], ["5 5\n1 2 1 2 1\n4\n6\n8\n10\n12\n", "0\n9\n119\n630\n2210"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "数论", "O2优化", "素数判断,质数,筛法", "快速数论变换 NTT"], "title": "「PHOI-1」斗之魂", "background": "**本题数据已加强。**\n\n小 X 忙了一天，于是打起了一款叫斗之魂的游戏。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5ha5fx0q.png)", "description": "小 X 要击败 $n$ 个 BOSS，他可以选择以下两种击败 BOSS 的方式：\n\n1. 独自一人击败第 $i$ 个 BOSS 并获得 $k_{i,0}$ 块稀有金属，且保证 $k_{i,0}=k_{i,1}=k_{i,2}$。\n2. 和小 Y 一起击败第 $i$ 个 BOSS ，小 X 理应获得 $k_{i,1}$ 块稀有金属，小 Y 理应获得 $k_{i,2}$ 块稀有金属，但是 BOSS 本身实力并没有因为人数的改变而改变，击败难度相对要简单一点，所以系统判定两人实际各获得 $k_{i,0}$ 块稀有金属，其中保证 $\\dfrac{1}{k_{i,0}}=\\dfrac{1}{k_{i,1}}+\\dfrac{1}{k_{i,2}}$。\n\n小 X 已经计划好用第 $b_i$ 种方式击败第 $i$ 个 BOSS，但是考虑到某些因素，小 X 有 $q$ 次询问，每次询问给定一个正整数 $m$，为小 X 击败完所有 BOSS 后获得的稀有金属总数，已知 $k_{i,0},k_{i,1},k_{i,2}$ 均为正整数，求每次询问后所有可能的 $k$ 的值的方案数，两种方案不同当且仅当至少存在一个 $k$ 的值不同，由于这个答案可能很大，你只需要输出它对 $998244353$ 取模后的结果。", "inputFormat": "第一行有两个整数 $n$ 和 $q$，分别表示 BOSS 个数和小 X 的询问次数。\n\n第二行有 $n$ 个正整数 $b_i$，表示小 X 用 $b_i$ 种方式击败第 $i$ 个 BOSS。\n\n接下来的 $q$ 行中每行有一个整数 $m$，为该次询问中小 X 击败完所有 BOSS 后获得的稀有金属总数。", "outputFormat": "输出共 $q$ 行，第 $i$ 行输出一个答案为当小 X 击败完所有 BOSS 后获得的稀有金属总数为 $m$ 时，所有可能的 $k$ 的值的方案数并对它取模 $998244353$ 后的结果。", "hint": "**本题采用捆绑测试。**\n\n| Subtask |      $n\\le$       |      $m \\le$      | $q \\le$ |  时限  | 分值 |\n| :-----: | :---------------: | :---------------: | :-----: | :----: | :--: |\n|   $0$   |       $10$        |       $20$        |   $5$   |  $1s$  | $8$  |\n|   $1$   |       $30$        |       $60$        |   $5$   |  $1s$  | $7$  |\n|   $2$   |       $40$        |       $100$       | $10^3$  |  $1s$  | $5$  |\n|   $3$   |       $150$       |       $500$       | $10^3$  |  $1s$  | $5$  |\n|   $4$   |       $200$       |      $5000$       | $10^4$  |  $1s$  | $20$ |\n|   $5$   |      $2000$       |  $5 \\times 10^4$  | $10^5$  |  $1s$  | $25$ |\n|   $6$   | $1.5 \\times 10^5$ | $2.5 \\times 10^5$ | $10^5$  | $1.8s$ | $30$ |\n\n对于 $100\\%$ 的数据，保证 $1 \\le n \\le 1.5 \\times 10^5$，$1 \\le m \\le 2.5 \\times 10^5$，$1 \\le b_i \\le 2$，$1 \\le q \\le 10^5$。\n\n### 样例解释 #1：\n\n- 当 $m=3$ 时，所有可能的 $k$ 的值的方案数为 $4$。\n\n    第 $1$ 种：$k_{1,0}=1,k_{1,1}=k_{1,2}=2,k_{2,0}=k_{2,1}=k_{2,2}=2$\n\n    第 $2$ 种：$k_{1,0}=2,k_{1,1}=3,k_{1,2}=6,k_{2,0}=k_{2,1}=k_{2,2}=1$\n\n    第 $3$ 种：$k_{1,0}=2,k_{1,1}=k_{1,2}=4,k_{2,0}=k_{2,1}=k_{2,2}=1$\n\n    第 $4$ 种：$k_{1,0}=2,k_{1,1}=6,k_{1,2}=3,k_{2,0}=k_{2,1}=k_{2,2}=1$\n\n- 当 $m=4$ 时，所有可能的 $k$ 的值的方案数为 $7$。\n\n    第 $1$ 种：$k_{1,0}=1,k_{1,1}=k_{1,2}=2,k_{2,0}=k_{2,1}=k_{2,2}=3$\n\n    第 $2$ 种：$k_{1,0}=2,k_{1,1}=3,k_{1,2}=6,k_{2,0}=k_{2,1}=k_{2,2}=2$\n\n    第 $3$ 种：$k_{1,0}=2,k_{1,1}=k_{1,2}=4,k_{2,0}=k_{2,1}=k_{2,2}=2$\n\n    第 $4$ 种：$k_{1,0}=2,k_{1,1}=6,k_{1,2}=3,k_{2,0}=k_{2,1}=k_{2,2}=2$\n\n    第 $5$ 种：$k_{1,0}=3,k_{1,1}=4,k_{1,2}=12,k_{2,0}=k_{2,1}=k_{2,2}=1$\n\n    第 $6$ 种：$k_{1,0}=3,k_{1,1}=6,k_{1,2}=6,k_{2,0}=k_{2,1}=k_{2,2}=1$\n\n    第 $7$ 种：$k_{1,0}=3,k_{1,1}=12,k_{1,2}=4,k_{2,0}=k_{2,1}=k_{2,2}=1$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「PHOI-1」斗之魂", "background": "**本题数据已加强。**\n\n小 X 忙了一天，于是打起了一款叫斗之魂的游戏。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5ha5fx0q.png)", "description": "小 X 要击败 $n$ 个 BOSS，他可以选择以下两种击败 BOSS 的方式：\n\n1. 独自一人击败第 $i$ 个 BOSS 并获得 $k_{i,0}$ 块稀有金属，且保证 $k_{i,0}=k_{i,1}=k_{i,2}$。\n2. 和小 Y 一起击败第 $i$ 个 BOSS ，小 X 理应获得 $k_{i,1}$ 块稀有金属，小 Y 理应获得 $k_{i,2}$ 块稀有金属，但是 BOSS 本身实力并没有因为人数的改变而改变，击败难度相对要简单一点，所以系统判定两人实际各获得 $k_{i,0}$ 块稀有金属，其中保证 $\\dfrac{1}{k_{i,0}}=\\dfrac{1}{k_{i,1}}+\\dfrac{1}{k_{i,2}}$。\n\n小 X 已经计划好用第 $b_i$ 种方式击败第 $i$ 个 BOSS，但是考虑到某些因素，小 X 有 $q$ 次询问，每次询问给定一个正整数 $m$，为小 X 击败完所有 BOSS 后获得的稀有金属总数，已知 $k_{i,0},k_{i,1},k_{i,2}$ 均为正整数，求每次询问后所有可能的 $k$ 的值的方案数，两种方案不同当且仅当至少存在一个 $k$ 的值不同，由于这个答案可能很大，你只需要输出它对 $998244353$ 取模后的结果。", "inputFormat": "第一行有两个整数 $n$ 和 $q$，分别表示 BOSS 个数和小 X 的询问次数。\n\n第二行有 $n$ 个正整数 $b_i$，表示小 X 用 $b_i$ 种方式击败第 $i$ 个 BOSS。\n\n接下来的 $q$ 行中每行有一个整数 $m$，为该次询问中小 X 击败完所有 BOSS 后获得的稀有金属总数。", "outputFormat": "输出共 $q$ 行，第 $i$ 行输出一个答案为当小 X 击败完所有 BOSS 后获得的稀有金属总数为 $m$ 时，所有可能的 $k$ 的值的方案数并对它取模 $998244353$ 后的结果。", "hint": "**本题采用捆绑测试。**\n\n| Subtask |      $n\\le$       |      $m \\le$      | $q \\le$ |  时限  | 分值 |\n| :-----: | :---------------: | :---------------: | :-----: | :----: | :--: |\n|   $0$   |       $10$        |       $20$        |   $5$   |  $1s$  | $8$  |\n|   $1$   |       $30$        |       $60$        |   $5$   |  $1s$  | $7$  |\n|   $2$   |       $40$        |       $100$       | $10^3$  |  $1s$  | $5$  |\n|   $3$   |       $150$       |       $500$       | $10^3$  |  $1s$  | $5$  |\n|   $4$   |       $200$       |      $5000$       | $10^4$  |  $1s$  | $20$ |\n|   $5$   |      $2000$       |  $5 \\times 10^4$  | $10^5$  |  $1s$  | $25$ |\n|   $6$   | $1.5 \\times 10^5$ | $2.5 \\times 10^5$ | $10^5$  | $1.8s$ | $30$ |\n\n对于 $100\\%$ 的数据，保证 $1 \\le n \\le 1.5 \\times 10^5$，$1 \\le m \\le 2.5 \\times 10^5$，$1 \\le b_i \\le 2$，$1 \\le q \\le 10^5$。\n\n### 样例解释 #1：\n\n- 当 $m=3$ 时，所有可能的 $k$ 的值的方案数为 $4$。\n\n    第 $1$ 种：$k_{1,0}=1,k_{1,1}=k_{1,2}=2,k_{2,0}=k_{2,1}=k_{2,2}=2$\n\n    第 $2$ 种：$k_{1,0}=2,k_{1,1}=3,k_{1,2}=6,k_{2,0}=k_{2,1}=k_{2,2}=1$\n\n    第 $3$ 种：$k_{1,0}=2,k_{1,1}=k_{1,2}=4,k_{2,0}=k_{2,1}=k_{2,2}=1$\n\n    第 $4$ 种：$k_{1,0}=2,k_{1,1}=6,k_{1,2}=3,k_{2,0}=k_{2,1}=k_{2,2}=1$\n\n- 当 $m=4$ 时，所有可能的 $k$ 的值的方案数为 $7$。\n\n    第 $1$ 种：$k_{1,0}=1,k_{1,1}=k_{1,2}=2,k_{2,0}=k_{2,1}=k_{2,2}=3$\n\n    第 $2$ 种：$k_{1,0}=2,k_{1,1}=3,k_{1,2}=6,k_{2,0}=k_{2,1}=k_{2,2}=2$\n\n    第 $3$ 种：$k_{1,0}=2,k_{1,1}=k_{1,2}=4,k_{2,0}=k_{2,1}=k_{2,2}=2$\n\n    第 $4$ 种：$k_{1,0}=2,k_{1,1}=6,k_{1,2}=3,k_{2,0}=k_{2,1}=k_{2,2}=2$\n\n    第 $5$ 种：$k_{1,0}=3,k_{1,1}=4,k_{1,2}=12,k_{2,0}=k_{2,1}=k_{2,2}=1$\n\n    第 $6$ 种：$k_{1,0}=3,k_{1,1}=6,k_{1,2}=6,k_{2,0}=k_{2,1}=k_{2,2}=1$\n\n    第 $7$ 种：$k_{1,0}=3,k_{1,1}=12,k_{1,2}=4,k_{2,0}=k_{2,1}=k_{2,2}=1$", "locale": "zh-CN"}}}
{"pid": "P9552", "type": "P", "difficulty": 2, "samples": [["2\n1\n2 3\n2\n2 3 10", "4\n12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "O2优化"], "title": "「CROI · R1」浣熊的小溪", "background": "> “从太阳里奔来，又迎着阳光走去；张开熊爪，与风相拥，离别之际，却低首自吟。”\\\n那梦枫畔嬉戏的成长，那阳光下不羁的信仰，历久弥坚，在无数浣熊的心畔回响。 \\\n> 可叹，灵溪上畔，一人意志，大小工事，割裂了纯真的年华，刀刻了落寞的隔阂。\\\n那明澈的小溪，那快乐的往日，还会，在感怀中驻足吗……", "description": "浣熊岭的森林可以看作一张 $n \\times m$ 的网格图。工厂排放的废水污染了纵贯森林的梦枫溪（一条直线），导致所经区域对浣熊是有害的。小浣熊 CleverRaccoon 为了研究废水对浣熊的危害，要寻求你的帮助。\n\n设 $f(n,m)$ 表示一条直线最多能穿过 $n\\times m$ 的网格图的格子数。\n\n小浣熊有两种问题想要问你：\n\n1.  给定 $n,m$，求 $f(n,m)$；\n2.  给定 $n,m,Q$，你需要找到 $n'\\ge n,m'\\ge m$，满足 $f(n',m')\\ge Q$，且 $n'\\times m'$ 尽可能小。求 $n'm'-nm$ 的最小值**对 $998244353$ 取模**的结果。数据保证 $f(n,m)<Q$。", "inputFormat": "**本题包含多组测试数据。**\n\n第一行，输入一个正整数 $T$，表示有 $T$ 次询问。\n\n对于每次询问：\n\n第一行，输入一个正整数 $op$，表示问题类型。\n\n第二行，若 $op=1$，输入 $2$ 个正整数 $n$ 和 $m$；若 $op=2$，输入 $3$ 个正整数 $n$、$m$ 和 $Q$。", "outputFormat": "共 $T$ 行，对于每次询问：一行输出 $1$ 个正整数，表示对应问题的答案。", "hint": "#### 样例解释 #1\n\n对于第一次询问：\n\n下图所示的情况是一种最佳构造方案，梦枫溪穿过 $2 \\times 3$ 的网格森林时，最多穿过 $4$ 个小网格（黄色部分为穿过的网格，灰色部分为未穿过的网格）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7dknua6w.png?x-oss-process=image/resize,m_lfit,h_360)\n\n下示方案不是一种最佳方案，梦枫溪是从两个绿色网格中间的一个顶点上穿过的，所以两个绿色区域都没有被穿过。因此梦枫溪只穿过了 $3$ 个小网格。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cgjzaf2i.png?x-oss-process=image/resize,m_lfit,h_360)\n\n对于第二次询问：\n\n如下图所示，当 $n'=2$, $m'=9$ 时，才能使梦枫溪穿过 $10$ 个网格的情况下，在原基础添加的 $n'm'-nm$ 个网格是最少的（红色虚线左边是原来的森林，右边是添加的部分）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/phkx3o46.png)\n\n#### 数据范围\n\n**本题采用 Subtask 捆绑测试。**\n\n| Subtask | $n$ | $m$ | $Q$ | 特殊性质 | Score |\n| :-: | :-: | :-: | :-: | :-: | :-: |\n| $0$ | $\\le10^{18}$ | $=1$ | $\\le2 \\times 10^{18}$  | $op=1$ | $5$ |\n| $1$ | $\\le10^{18}$ | $=1$ | $\\le2 \\times 10^{18}$  | $op=2$ | $5$ |\n| $2$ | $\\le10^{18}$ | $\\le10^{18}$ | $\\le2 \\times 10^{18}$ | $op=1$ | $25$ |\n| $3$ | $\\le10^{18}$ | $\\le10^{18}$ |$\\le2 \\times 10^{18}$ | $op=2$ | $25$ |\n| $4$ | $\\le10^9$ | $\\le10^9$ | $\\le2 \\times 10^9$ | 无特殊性质 | $30$ |\n| $5$ | $\\le10^{18}$ | $\\le10^{18}$ | $\\le2 \\times 10^{18}$ | 无特殊性质 | $10$ |\n\n对于 $100\\%$ 的数据，保证 $1 \\le T \\le 10$，$op \\in \\{1,2\\}$，$1 \\le n,m \\le 10^{18}$，$2 \\le n+m \\le Q \\le 2 \\times 10^{18}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「CROI · R1」浣熊的小溪", "background": "> “从太阳里奔来，又迎着阳光走去；张开熊爪，与风相拥，离别之际，却低首自吟。”\\\n那梦枫畔嬉戏的成长，那阳光下不羁的信仰，历久弥坚，在无数浣熊的心畔回响。 \\\n> 可叹，灵溪上畔，一人意志，大小工事，割裂了纯真的年华，刀刻了落寞的隔阂。\\\n那明澈的小溪，那快乐的往日，还会，在感怀中驻足吗……", "description": "浣熊岭的森林可以看作一张 $n \\times m$ 的网格图。工厂排放的废水污染了纵贯森林的梦枫溪（一条直线），导致所经区域对浣熊是有害的。小浣熊 CleverRaccoon 为了研究废水对浣熊的危害，要寻求你的帮助。\n\n设 $f(n,m)$ 表示一条直线最多能穿过 $n\\times m$ 的网格图的格子数。\n\n小浣熊有两种问题想要问你：\n\n1.  给定 $n,m$，求 $f(n,m)$；\n2.  给定 $n,m,Q$，你需要找到 $n'\\ge n,m'\\ge m$，满足 $f(n',m')\\ge Q$，且 $n'\\times m'$ 尽可能小。求 $n'm'-nm$ 的最小值**对 $998244353$ 取模**的结果。数据保证 $f(n,m)<Q$。", "inputFormat": "**本题包含多组测试数据。**\n\n第一行，输入一个正整数 $T$，表示有 $T$ 次询问。\n\n对于每次询问：\n\n第一行，输入一个正整数 $op$，表示问题类型。\n\n第二行，若 $op=1$，输入 $2$ 个正整数 $n$ 和 $m$；若 $op=2$，输入 $3$ 个正整数 $n$、$m$ 和 $Q$。", "outputFormat": "共 $T$ 行，对于每次询问：一行输出 $1$ 个正整数，表示对应问题的答案。", "hint": "#### 样例解释 #1\n\n对于第一次询问：\n\n下图所示的情况是一种最佳构造方案，梦枫溪穿过 $2 \\times 3$ 的网格森林时，最多穿过 $4$ 个小网格（黄色部分为穿过的网格，灰色部分为未穿过的网格）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7dknua6w.png?x-oss-process=image/resize,m_lfit,h_360)\n\n下示方案不是一种最佳方案，梦枫溪是从两个绿色网格中间的一个顶点上穿过的，所以两个绿色区域都没有被穿过。因此梦枫溪只穿过了 $3$ 个小网格。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cgjzaf2i.png?x-oss-process=image/resize,m_lfit,h_360)\n\n对于第二次询问：\n\n如下图所示，当 $n'=2$, $m'=9$ 时，才能使梦枫溪穿过 $10$ 个网格的情况下，在原基础添加的 $n'm'-nm$ 个网格是最少的（红色虚线左边是原来的森林，右边是添加的部分）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/phkx3o46.png)\n\n#### 数据范围\n\n**本题采用 Subtask 捆绑测试。**\n\n| Subtask | $n$ | $m$ | $Q$ | 特殊性质 | Score |\n| :-: | :-: | :-: | :-: | :-: | :-: |\n| $0$ | $\\le10^{18}$ | $=1$ | $\\le2 \\times 10^{18}$  | $op=1$ | $5$ |\n| $1$ | $\\le10^{18}$ | $=1$ | $\\le2 \\times 10^{18}$  | $op=2$ | $5$ |\n| $2$ | $\\le10^{18}$ | $\\le10^{18}$ | $\\le2 \\times 10^{18}$ | $op=1$ | $25$ |\n| $3$ | $\\le10^{18}$ | $\\le10^{18}$ |$\\le2 \\times 10^{18}$ | $op=2$ | $25$ |\n| $4$ | $\\le10^9$ | $\\le10^9$ | $\\le2 \\times 10^9$ | 无特殊性质 | $30$ |\n| $5$ | $\\le10^{18}$ | $\\le10^{18}$ | $\\le2 \\times 10^{18}$ | 无特殊性质 | $10$ |\n\n对于 $100\\%$ 的数据，保证 $1 \\le T \\le 10$，$op \\in \\{1,2\\}$，$1 \\le n,m \\le 10^{18}$，$2 \\le n+m \\le Q \\le 2 \\times 10^{18}$。", "locale": "zh-CN"}}}
{"pid": "P9553", "type": "P", "difficulty": 3, "samples": [["5 0 2\n1 1 1 2 3\n1 2", "5\n3 0\n1 3\n1 4\n0 2\n0 1"], ["5 1 2\n1 1 1 2 3\n1\n1 2", "5\n0 0\n4 0\n1 4\n0 5\n0 1"], ["5 1 3\n1 2 3 4 5\n3\n1 2 3", "8\n1 0\n1 1\n0 0\n2 4\n1 3\n0 3\n0 3\n0 1"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["模拟", "O2优化"], "title": "「CROI · R1」浣熊的语言", "background": "$\\texttt{[2023.08.17 21:44]：}$ 为防止神奇的暴力做法通过，本题时限改为 $500\\ ms$。\n\n> 他复瞑着，沙地上的文字。\\\n> 词句，日忆夜诵，挥翰成风；夜幕下，星罗棋布。\\\n> 新意，呼之欲出，似即却离；叹气里，功败垂成。\\\n> 她释然一笑，潇然起身，轻叩他的后背。\\\n> 却见流光间，熊爪翻飞；夜风中，新词真切。\\\n> “你做到了……”\\\n> 平凡的仲夏夜，深刻的文字。\\\n> 忆诵的努力，闪烁着星光……", "description": "小浣熊 CleverRaccoon 遵循浣熊的单词遗忘曲线，从第 $1$ 天开始背单词。\n\n一共有 $n$ 个单词，正常情况下，第 $i$ 个单词将在第 $d_i$ 天首次学习。\n\n同时，每个单词都会安排 $k$ 次复习，对于第 $j$ 次复习有复习点 $t_j$，表示正常情况下，每个单词在**首次学习后** $t_j$ 天都会安排这个单词的复习。换言之，第 $i$ 个单词的第 $j$ 次复习时间为第 $d_i+t_j$ 天。\n\n另外，还有 $m$ 天为特殊情况，第 $i$ 次特殊情况发生在 $s_i$ 天。小浣熊 CleverRaccoon 在当日忘记背单词了，与当日冲突的首次学习或复习时间将顺延至第二天学习或复习。\n- 若某单词的首次学习时间顺延至第二天，则该单词按**顺延后**的首次学习时间安排复习。\n- 若某单词的当次复习时间顺延至第二天，则**不影响**该单词的后续复习时间。\n- 若多个学习或复习时间重合于一天，则当天需要进行**多次**学习或复习。\n\n小浣熊 CleverRaccoon 想知道：学习和复习完所有单词需要的天数、每天新学单词数、每天复习单词数。", "inputFormat": "第一行，三个整数 $n,m,k$，表示需背单词的总数、特殊情况的天数、每个单词均需复习的次数。\n\n第二行，$n$ 个整数 $d_i$，表示每个单词的首次学习时间。保证 $d$ 单调不减。\n\n第三行，$m$ 个整数 $s_i$，表示特殊情况日期。保证 $s$ 单调递增。特别地，若 $m=0$，则没有该行数据。\n\n第四行，$k$ 个整数 $t_i$，表示所有单词的每个复习点。保证 $t$ 单调递增。", "outputFormat": "第一行，一个整数，表示小浣熊 CleverRaccoon 学习和复习完所有单词需要的天数 $x$。\n\n接下来有 $x$ 行，每行两个整数，表示每天的学习单词数量和复习单词数量。", "hint": "设依次输入的单词编号分别为 $1 \\sim n$。\n#### 样例解释 #1\n| 天数 | 新学单词编号 | 新学单词数量 | 复习单词编号 | 复习单词数量 |\n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | $1,2,3$ | $3$ | $-$ | $0$ |\n| $2$ | $4$ | $1$ | $1,2,3$ | $3$ |\n| $3$ | $5$ | $1$ | $1,2,3,4$ | $4$ |\n| $4$ | $-$ | $0$ | $4,5$ | $2$ |\n| $5$ | $-$ | $0$ | $5$ | $1$ |\n\n#### 样例解释 #2\n| 天数 | 新学单词编号 | 新学单词数量 | 复习单词编号 | 复习单词数量 |\n| :-: | :-: | :-: | :-: | :-: |\n| $1$ (special) | $-$ | $0$ | $-$ | $0$ |\n| $2$ | $1,2,3,4$ | $4$ | $-$ | $0$ |\n| $3$ | $5$ | $1$ | $1,2,3,4$ | $4$ |\n| $4$ | $-$ | $0$ | $1,2,3,4,5$ | $5$ |\n| $5$ | $-$ | $0$ | $5$ | $1$ |\n\n#### 样例解释 #3\n| 天数 | 新学单词编号 | 新学单词数量 | 复习单词编号 | 复习单词数量 |\n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | $1$ | $1$ | $-$ | $0$ |\n| $2$ | $2$ | $1$ | $1$ | $1$ |\n| $3$ (special) | $-$ | $0$ | $-$ | $0$ |\n| $4$ | $3,4$ | $2$ | $1,1,2,2$ | $4$ |\n| $5$ | $5$ | $1$ | $2,3,4$ | $3$ |\n| $6$ | $-$ | $0$ | $3,4,5$ | $3$ |\n| $7$ | $-$ | $0$ | $3,4,5$ | $3$ |\n| $8$ | $-$ | $0$ | $5$ | $1$ |\n\n#### 数据范围\n\n**本题采用 Subtask 捆绑测试。**\n\n对于 $100\\%$ 的数据，保证 $1\\leq n\\leq 10^6,0\\leq m\\leq 200,1\\leq k,d_i,t_i\\leq 10^3,s_m < d_n$。保证 $d$ 单调不减，$t,s$ 单调递增。\n\n|Subtask|$n$|$m$|$k$|$d_i$|$t_i$|Score|\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|$0$|$\\leq 100$|$=0$|$\\leq 10$|$\\leq 100$|$\\leq 100$|$5$|\n|$1$|$\\leq 10^3$|$=0$|$\\leq 100$|$\\leq 10^3$|$\\leq 100$|$20$|\n|$2$|$\\leq 100$|$\\leq 10$|$\\leq 10$|$\\leq 100$|$\\leq 100$|$15$|\n|$3$|$\\leq 10^3$|$\\leq 100$|$\\leq 100$|$\\leq 10^3$|$\\leq 100$|$25$|\n|$4$|$\\leq 10^6$|$\\leq 200$|$\\leq 10^3$|$\\leq 10^3$|$\\leq 10^3$|$35$|", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「CROI · R1」浣熊的语言", "background": "$\\texttt{[2023.08.17 21:44]：}$ 为防止神奇的暴力做法通过，本题时限改为 $500\\ ms$。\n\n> 他复瞑着，沙地上的文字。\\\n> 词句，日忆夜诵，挥翰成风；夜幕下，星罗棋布。\\\n> 新意，呼之欲出，似即却离；叹气里，功败垂成。\\\n> 她释然一笑，潇然起身，轻叩他的后背。\\\n> 却见流光间，熊爪翻飞；夜风中，新词真切。\\\n> “你做到了……”\\\n> 平凡的仲夏夜，深刻的文字。\\\n> 忆诵的努力，闪烁着星光……", "description": "小浣熊 CleverRaccoon 遵循浣熊的单词遗忘曲线，从第 $1$ 天开始背单词。\n\n一共有 $n$ 个单词，正常情况下，第 $i$ 个单词将在第 $d_i$ 天首次学习。\n\n同时，每个单词都会安排 $k$ 次复习，对于第 $j$ 次复习有复习点 $t_j$，表示正常情况下，每个单词在**首次学习后** $t_j$ 天都会安排这个单词的复习。换言之，第 $i$ 个单词的第 $j$ 次复习时间为第 $d_i+t_j$ 天。\n\n另外，还有 $m$ 天为特殊情况，第 $i$ 次特殊情况发生在 $s_i$ 天。小浣熊 CleverRaccoon 在当日忘记背单词了，与当日冲突的首次学习或复习时间将顺延至第二天学习或复习。\n- 若某单词的首次学习时间顺延至第二天，则该单词按**顺延后**的首次学习时间安排复习。\n- 若某单词的当次复习时间顺延至第二天，则**不影响**该单词的后续复习时间。\n- 若多个学习或复习时间重合于一天，则当天需要进行**多次**学习或复习。\n\n小浣熊 CleverRaccoon 想知道：学习和复习完所有单词需要的天数、每天新学单词数、每天复习单词数。", "inputFormat": "第一行，三个整数 $n,m,k$，表示需背单词的总数、特殊情况的天数、每个单词均需复习的次数。\n\n第二行，$n$ 个整数 $d_i$，表示每个单词的首次学习时间。保证 $d$ 单调不减。\n\n第三行，$m$ 个整数 $s_i$，表示特殊情况日期。保证 $s$ 单调递增。特别地，若 $m=0$，则没有该行数据。\n\n第四行，$k$ 个整数 $t_i$，表示所有单词的每个复习点。保证 $t$ 单调递增。", "outputFormat": "第一行，一个整数，表示小浣熊 CleverRaccoon 学习和复习完所有单词需要的天数 $x$。\n\n接下来有 $x$ 行，每行两个整数，表示每天的学习单词数量和复习单词数量。", "hint": "设依次输入的单词编号分别为 $1 \\sim n$。\n#### 样例解释 #1\n| 天数 | 新学单词编号 | 新学单词数量 | 复习单词编号 | 复习单词数量 |\n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | $1,2,3$ | $3$ | $-$ | $0$ |\n| $2$ | $4$ | $1$ | $1,2,3$ | $3$ |\n| $3$ | $5$ | $1$ | $1,2,3,4$ | $4$ |\n| $4$ | $-$ | $0$ | $4,5$ | $2$ |\n| $5$ | $-$ | $0$ | $5$ | $1$ |\n\n#### 样例解释 #2\n| 天数 | 新学单词编号 | 新学单词数量 | 复习单词编号 | 复习单词数量 |\n| :-: | :-: | :-: | :-: | :-: |\n| $1$ (special) | $-$ | $0$ | $-$ | $0$ |\n| $2$ | $1,2,3,4$ | $4$ | $-$ | $0$ |\n| $3$ | $5$ | $1$ | $1,2,3,4$ | $4$ |\n| $4$ | $-$ | $0$ | $1,2,3,4,5$ | $5$ |\n| $5$ | $-$ | $0$ | $5$ | $1$ |\n\n#### 样例解释 #3\n| 天数 | 新学单词编号 | 新学单词数量 | 复习单词编号 | 复习单词数量 |\n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | $1$ | $1$ | $-$ | $0$ |\n| $2$ | $2$ | $1$ | $1$ | $1$ |\n| $3$ (special) | $-$ | $0$ | $-$ | $0$ |\n| $4$ | $3,4$ | $2$ | $1,1,2,2$ | $4$ |\n| $5$ | $5$ | $1$ | $2,3,4$ | $3$ |\n| $6$ | $-$ | $0$ | $3,4,5$ | $3$ |\n| $7$ | $-$ | $0$ | $3,4,5$ | $3$ |\n| $8$ | $-$ | $0$ | $5$ | $1$ |\n\n#### 数据范围\n\n**本题采用 Subtask 捆绑测试。**\n\n对于 $100\\%$ 的数据，保证 $1\\leq n\\leq 10^6,0\\leq m\\leq 200,1\\leq k,d_i,t_i\\leq 10^3,s_m < d_n$。保证 $d$ 单调不减，$t,s$ 单调递增。\n\n|Subtask|$n$|$m$|$k$|$d_i$|$t_i$|Score|\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|$0$|$\\leq 100$|$=0$|$\\leq 10$|$\\leq 100$|$\\leq 100$|$5$|\n|$1$|$\\leq 10^3$|$=0$|$\\leq 100$|$\\leq 10^3$|$\\leq 100$|$20$|\n|$2$|$\\leq 100$|$\\leq 10$|$\\leq 10$|$\\leq 100$|$\\leq 100$|$15$|\n|$3$|$\\leq 10^3$|$\\leq 100$|$\\leq 100$|$\\leq 10^3$|$\\leq 100$|$25$|\n|$4$|$\\leq 10^6$|$\\leq 200$|$\\leq 10^3$|$\\leq 10^3$|$\\leq 10^3$|$35$|", "locale": "zh-CN"}}}
{"pid": "P9554", "type": "P", "difficulty": 3, "samples": [["3\n1 3\n2 2\n6 3", "5\n6\n666\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["O2优化"], "title": "「CROI · R1」浣熊的溪石", "background": ">回首往昔，碧空如洗，日暖风恬。\\\n溪石深浅有致地错落在明澈似玉的梦枫溪里。\\\n浣熊们水上跑酷的无限趣忆亦于此伊始……\n", "description": "日升月落，春去秋来，梦枫溪石的高度千变万化。\n爱思考的小浣熊 CleverRaccoon 想探寻这些溪石究竟能构成多少种不同的高度序列。\n\n现有若干个长度为 $n$ 的非负整数列 $a$。\n\n当 $n>1$ 时，$a_1,a_n$ 的取值为 $0\\sim m$，其它数 $a_i$ 的取值为 $0\\sim m-1$，其中 $2\\leq i \\leq n-1$。\n\n当 $n=1$ 时，$a_1$ 的取值为 $0\\sim m+1$。\n\n**定义**：当且仅当 $\\forall i\\in\\{1,2,\\dots ,n\\},a_i=b_i$ 或 $\\forall i\\in\\{1,2,\\dots ,n\\},a_i=b_{n-i+1}$ 时，数列 $a,b$ 相同。\n\n现给定 $n,m$，请求出最多有多少个**不同**的数列，答案对 $998244353$ 取模。", "inputFormat": "**本题包含多组测试数据。**\n\n第一行，输入一个正整数 $T$，表示数据组数。\n\n接下来 $T$ 行，每行输入以空格间隔的 $2$ 个正整数 $n,m$，意义见题目描述。", "outputFormat": "共 $T$ 行，对于每组数据，一行输出一个正整数，表示答案对 $998244353$ 取模的结果。", "hint": "#### 解释 #1\n\n当 $n=1,m=3$ 时，$a_i\\in\\{0,1,2,3,4\\}$，共有 $5$ 种不同的高度序列。\n\n当 $n=2,m=2$ 时，共有 $6$ 种不同的高度序列，详情如下：\n\n|序号|$a_1=$|$a_2=$|\n|:-:|:-:|:-:|\n|$1$|$0$|$0$|\n|$2$|$0$|$1$|\n|$3$|$0$|$2$|\n|$4$|$1$|$1$|\n|$5$|$1$|$2$|\n|$6$|$2$|$2$|\n\n#### 数据范围\n**本题采用 Subtask 捆绑测试。**\n\n|Subtask|$n\\leq$|$m\\leq$|$T\\leq$|特殊性质|Score|\n|:-:|:-:|:-:|:-:|:-:|:-:|\n|$0$|$10$|$10$|$10$|无特殊性质|$10$|\n|$1$|$10^3$|$1$|$10^3$|$m=1$|$5$|\n|$2$|$10^3$|$3$|$10$|$m=3$|$10$|\n|$3$|$10^3$|$10^3$|$1$|无特殊性质|$15$|\n|$4$|$10^6$|$10^3$|$100$|无特殊性质|$10$|\n|$5$|$10^6$|$10^6$|$10^6$|无特殊性质|$20$|\n|$6$|$10^9$|$10^9$|$10^6$| $n$ 为奇数|$10$|\n|$7$|$10^9$|$10^9$|$10^6$| $n$ 为偶数|$10$|\n|$8$|$10^{18}$|$10^9$|$10^6$|无特殊性质|$10$|\n\n对于 $100\\%$ 的数据，保证 $1\\leq n\\leq10^{18},1\\leq m\\leq10^9,1\\leq T\\leq10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「CROI · R1」浣熊的溪石", "background": ">回首往昔，碧空如洗，日暖风恬。\\\n溪石深浅有致地错落在明澈似玉的梦枫溪里。\\\n浣熊们水上跑酷的无限趣忆亦于此伊始……\n", "description": "日升月落，春去秋来，梦枫溪石的高度千变万化。\n爱思考的小浣熊 CleverRaccoon 想探寻这些溪石究竟能构成多少种不同的高度序列。\n\n现有若干个长度为 $n$ 的非负整数列 $a$。\n\n当 $n>1$ 时，$a_1,a_n$ 的取值为 $0\\sim m$，其它数 $a_i$ 的取值为 $0\\sim m-1$，其中 $2\\leq i \\leq n-1$。\n\n当 $n=1$ 时，$a_1$ 的取值为 $0\\sim m+1$。\n\n**定义**：当且仅当 $\\forall i\\in\\{1,2,\\dots ,n\\},a_i=b_i$ 或 $\\forall i\\in\\{1,2,\\dots ,n\\},a_i=b_{n-i+1}$ 时，数列 $a,b$ 相同。\n\n现给定 $n,m$，请求出最多有多少个**不同**的数列，答案对 $998244353$ 取模。", "inputFormat": "**本题包含多组测试数据。**\n\n第一行，输入一个正整数 $T$，表示数据组数。\n\n接下来 $T$ 行，每行输入以空格间隔的 $2$ 个正整数 $n,m$，意义见题目描述。", "outputFormat": "共 $T$ 行，对于每组数据，一行输出一个正整数，表示答案对 $998244353$ 取模的结果。", "hint": "#### 解释 #1\n\n当 $n=1,m=3$ 时，$a_i\\in\\{0,1,2,3,4\\}$，共有 $5$ 种不同的高度序列。\n\n当 $n=2,m=2$ 时，共有 $6$ 种不同的高度序列，详情如下：\n\n|序号|$a_1=$|$a_2=$|\n|:-:|:-:|:-:|\n|$1$|$0$|$0$|\n|$2$|$0$|$1$|\n|$3$|$0$|$2$|\n|$4$|$1$|$1$|\n|$5$|$1$|$2$|\n|$6$|$2$|$2$|\n\n#### 数据范围\n**本题采用 Subtask 捆绑测试。**\n\n|Subtask|$n\\leq$|$m\\leq$|$T\\leq$|特殊性质|Score|\n|:-:|:-:|:-:|:-:|:-:|:-:|\n|$0$|$10$|$10$|$10$|无特殊性质|$10$|\n|$1$|$10^3$|$1$|$10^3$|$m=1$|$5$|\n|$2$|$10^3$|$3$|$10$|$m=3$|$10$|\n|$3$|$10^3$|$10^3$|$1$|无特殊性质|$15$|\n|$4$|$10^6$|$10^3$|$100$|无特殊性质|$10$|\n|$5$|$10^6$|$10^6$|$10^6$|无特殊性质|$20$|\n|$6$|$10^9$|$10^9$|$10^6$| $n$ 为奇数|$10$|\n|$7$|$10^9$|$10^9$|$10^6$| $n$ 为偶数|$10$|\n|$8$|$10^{18}$|$10^9$|$10^6$|无特殊性质|$10$|\n\n对于 $100\\%$ 的数据，保证 $1\\leq n\\leq10^{18},1\\leq m\\leq10^9,1\\leq T\\leq10^6$。", "locale": "zh-CN"}}}
{"pid": "P9555", "type": "P", "difficulty": 6, "samples": [["9 3\n1 1 1 0 1 1 0 0 0\n1 2\n2 3\n3 4\n3 5\n1 6\n6 7\n7 8\n7 9\n2 9 4\n1 9\n2 4 9\n", "3\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化"], "title": "「CROI · R1」浣熊的阴阳鱼", "background": "> 往昔，阴阳由天地所创，孕大含深；今昔，时光为记忆所刻，随行如影。\\\n流水落花间，嬉闹于阴阳树的意境；沧海桑田间，铭心于阴阳忆的缤斓。\\\n阴鱼，阳鱼……挥翰着日月的闲情，留存着浣熊的惬意，却不复存在……\\\n小浣熊 CleverRaccoon 与最后一瞬阴阳，含泪而笑……", "description": "一棵树的各结点都悬挂着 $1$ 条阴鱼或阳鱼（分别用 $0,1$ 表示），它们可能在某刻由于基因突变互相转化。\n\n小浣熊 CleverRaccoon 带着一只能装 $2$ 条鱼的篮筐在此树的某条链上行走。当他所在点上的鱼与某条筐内鱼的属性相反时，他会将这 $2$ 条鱼合成 $1$ 条阴阳鱼并吃下；在筐中没有满的条件下，他会将所在点上的鱼放入筐中。\n\n现有两种操作：\n\n1. 一个结点上的阴阳鱼发生基因突变，变为另一种类型的阴阳鱼。\n2. 帮助聪明的小浣熊 CleverRaccoon 求出：当他沿着这棵树上的某条链行走时，能吃下的阴阳鱼的条数。", "inputFormat": "第一行，两个正整数 $n$ 和 $q$，表示结点个数、修改和询问总次数。\n\n第二行 $n$ 个整数，表示每个结点上悬挂的鱼的属性。\n\n接下来 $n−1$ 行，每行两个正整数 $u,v$，表示 $u$ 和 $v$ 两个点之间有一条边。\n\n接下来 $q$ 行，格式为 `1 u` 或 `2 u v`。\n\n若格式为 `1 u`，则表示结点 $u$ 上的鱼基因突变。\n\n若格式为 `2 u v`，则表示询问小浣熊  CleverRaccoon 在从 $u$ 到 $v$ 的简单路径中能吃下的阴阳鱼的条数。", "outputFormat": "对于每次询问，单行输出一个整数，表示小浣熊  CleverRaccoon 能吃下的阴阳鱼的条数。", "hint": "**数据范围**\n\n**本题采用 Subtask 捆绑测试**。\n\n- Subtask 0（10 points）：$n,q \\leq 10$。\n- Subtask 1（15 points）：$n,q \\leq 2\\times10^3$。\n- Subtask 2（15 points）：保证树的深度小于 $10^3$。\n- Subtask 3（60 points）：无特殊限制。\n\n对于所有测试数据： $1 \\leq n,q\\leq 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「CROI · R1」浣熊的阴阳鱼", "background": "> 往昔，阴阳由天地所创，孕大含深；今昔，时光为记忆所刻，随行如影。\\\n流水落花间，嬉闹于阴阳树的意境；沧海桑田间，铭心于阴阳忆的缤斓。\\\n阴鱼，阳鱼……挥翰着日月的闲情，留存着浣熊的惬意，却不复存在……\\\n小浣熊 CleverRaccoon 与最后一瞬阴阳，含泪而笑……", "description": "一棵树的各结点都悬挂着 $1$ 条阴鱼或阳鱼（分别用 $0,1$ 表示），它们可能在某刻由于基因突变互相转化。\n\n小浣熊 CleverRaccoon 带着一只能装 $2$ 条鱼的篮筐在此树的某条链上行走。当他所在点上的鱼与某条筐内鱼的属性相反时，他会将这 $2$ 条鱼合成 $1$ 条阴阳鱼并吃下；在筐中没有满的条件下，他会将所在点上的鱼放入筐中。\n\n现有两种操作：\n\n1. 一个结点上的阴阳鱼发生基因突变，变为另一种类型的阴阳鱼。\n2. 帮助聪明的小浣熊 CleverRaccoon 求出：当他沿着这棵树上的某条链行走时，能吃下的阴阳鱼的条数。", "inputFormat": "第一行，两个正整数 $n$ 和 $q$，表示结点个数、修改和询问总次数。\n\n第二行 $n$ 个整数，表示每个结点上悬挂的鱼的属性。\n\n接下来 $n−1$ 行，每行两个正整数 $u,v$，表示 $u$ 和 $v$ 两个点之间有一条边。\n\n接下来 $q$ 行，格式为 `1 u` 或 `2 u v`。\n\n若格式为 `1 u`，则表示结点 $u$ 上的鱼基因突变。\n\n若格式为 `2 u v`，则表示询问小浣熊  CleverRaccoon 在从 $u$ 到 $v$ 的简单路径中能吃下的阴阳鱼的条数。", "outputFormat": "对于每次询问，单行输出一个整数，表示小浣熊  CleverRaccoon 能吃下的阴阳鱼的条数。", "hint": "**数据范围**\n\n**本题采用 Subtask 捆绑测试**。\n\n- Subtask 0（10 points）：$n,q \\leq 10$。\n- Subtask 1（15 points）：$n,q \\leq 2\\times10^3$。\n- Subtask 2（15 points）：保证树的深度小于 $10^3$。\n- Subtask 3（60 points）：无特殊限制。\n\n对于所有测试数据： $1 \\leq n,q\\leq 10^5$。", "locale": "zh-CN"}}}
{"pid": "P9556", "type": "P", "difficulty": 2, "samples": [["2\n4 5\n6 12\n1 3\n6 15\n8 1\n3 100\n3 200\n4 300\n6 100", "Yes\nNo"]], "limits": {"time": [1000, 1000], "memory": [1048576, 1048576]}, "tags": ["2023", "山东", "O2优化", "省赛/邀请赛"], "title": "[SDCPC 2023] Orders", "background": "", "description": "A factory receives $n$ orders at the beginning of day $1$. The $i$-th order can be described as two integers $a_i$ and $b_i$, indicating that at the end of day $a_i$, the factory needs to deliver $b_i$ products to the customer.\n\nGiven that the factory can produce $k$ products each day, and at the beginning of day $1$ the factory has no product in stock, can the factory complete all orders?", "inputFormat": "There are multiple test cases. The first line of the input contains an integer $T$ ($1 \\le T \\le 100$) indicating the number of test cases. For each test case:\n\nThe first line contains two integers $n$ and $k$ ($1 \\le n \\le 100$, $1 \\le k \\le 10^9$) indicating the number of orders and the number of products the factory can produce each day.\n\nFor the following $n$ lines, the $i$-th line contains two integers $a_i$ and $b_i$ ($1 \\le a_i, b_i \\le 10^9$) indicating that the $i$-th order require the factory to deliver $b_i$ products at the end of day $a_i$.", "outputFormat": "For each test case output one line. If the factory can complete all orders output $\\texttt{Yes}$, otherwise output $\\texttt{No}$.", "hint": "For the first sample test case, the factory can produce $5$ products each day.\n\n- At the end of day $1$, there are $5$ products in stock so the factory can complete the $2$-nd order. After delivery, there are $2$ products left in stock.\n- At the end of day $6$, the factory produces $25$ more products. There are $27$ products in stock so the factory can complete the $1$-st and the $3$-rd order. After delivery, there are $0$ products left in stock.\n- At the end of day $8$, the factory produces $10$ more products. There are $10$ products in stock so the factory can complete the $4$-th order. After delivery, there are $9$ products left in stock.\n\nFor the second sample test case, the factory can produce $100$ products each day.\n\n- At the end of day $3$, there are $300$ products in stock and the factory can complete the $1$-st order. After delivery, there are $100$ products left in stock.\n- At the end of day $4$, the factory produces $100$ more products. There are only $200$ products in stock so the factory cannot complete the $2$-nd order.", "locale": "en", "translations": {"en": {"title": "[SDCPC 2023] Orders", "background": "", "description": "A factory receives $n$ orders at the beginning of day $1$. The $i$-th order can be described as two integers $a_i$ and $b_i$, indicating that at the end of day $a_i$, the factory needs to deliver $b_i$ products to the customer.\n\nGiven that the factory can produce $k$ products each day, and at the beginning of day $1$ the factory has no product in stock, can the factory complete all orders?", "inputFormat": "There are multiple test cases. The first line of the input contains an integer $T$ ($1 \\le T \\le 100$) indicating the number of test cases. For each test case:\n\nThe first line contains two integers $n$ and $k$ ($1 \\le n \\le 100$, $1 \\le k \\le 10^9$) indicating the number of orders and the number of products the factory can produce each day.\n\nFor the following $n$ lines, the $i$-th line contains two integers $a_i$ and $b_i$ ($1 \\le a_i, b_i \\le 10^9$) indicating that the $i$-th order require the factory to deliver $b_i$ products at the end of day $a_i$.", "outputFormat": "For each test case output one line. If the factory can complete all orders output $\\texttt{Yes}$, otherwise output $\\texttt{No}$.", "hint": "For the first sample test case, the factory can produce $5$ products each day.\n\n- At the end of day $1$, there are $5$ products in stock so the factory can complete the $2$-nd order. After delivery, there are $2$ products left in stock.\n- At the end of day $6$, the factory produces $25$ more products. There are $27$ products in stock so the factory can complete the $1$-st and the $3$-rd order. After delivery, there are $0$ products left in stock.\n- At the end of day $8$, the factory produces $10$ more products. There are $10$ products in stock so the factory can complete the $4$-th order. After delivery, there are $9$ products left in stock.\n\nFor the second sample test case, the factory can produce $100$ products each day.\n\n- At the end of day $3$, there are $300$ products in stock and the factory can complete the $1$-st order. After delivery, there are $100$ products left in stock.\n- At the end of day $4$, the factory produces $100$ more products. There are only $200$ products in stock so the factory cannot complete the $2$-nd order.", "locale": "en"}, "zh-CN": {"title": "[SDCPC 2023] Orders", "background": "", "description": "某工厂在第 $1$ 天开工之前收到了 $n$ 笔订单，第 $i$ 笔订单可以用两个整数 $a_i$ 和 $b_i$ 描述，表示工厂需要在第 $a_i$ 天结束时交付 $b_i$ 件货物。\n\n已知工厂每天能生产 $k$ 件货物，且第 $1$ 天开工之前没有任何存货，问该工厂能否完成所有订单。", "inputFormat": "有多组测试数据。第一行输入一个整数 $T$（$1 \\le T \\le 100$）表示测试数据组数，对于每组测试数据：\n\n第一行输入两个整数 $n$ 和 $k$（$1 \\le n \\le 100$，$1 \\le k \\le 10^9$）表示订单数量以及工厂每日能生产的货物数量。\n\n对于接下来 $n$ 行，第 $i$ 行输入两个整数 $a_i$ 和 $b_i$（$1 \\le a_i, b_i \\le 10^9$）表示第 $i$ 笔订单要求在第 $a_i$ 天结束时交付 $b_i$ 件货物。", "outputFormat": "每组数据输出一行。若工厂能完成所有订单输出 $\\texttt{Yes}$，否则输出 $\\texttt{No}$。\n\n**【样例解释】**\n\n对于第一组样例数据，工厂每天能生产 $5$ 件货物。\n-  在第 $1$ 天结束时，工厂共有 $5$ 件货物，可以完成第 $2$ 笔订单。交付后，工厂剩余 $2$ 件货物。\n-  在第 $6$ 天结束时，工厂又多生产了 $25$ 件货物，共有 $27$ 件货物，可以完成第 $1$ 和第 $3$ 笔订单。交付后，工厂剩余 $0$ 件货物。\n- 在第 $8$ 天结束时，工厂又多生产了 $10$ 件货物，共有 $10$ 件货物，可以完成第 $4$ 笔订单。交付后，工厂剩余 $9$ 件货物。\n\n对于第二组样例数据，工厂每天能生产 $100$ 件货物。\n- 在第 $3$ 天结束时，工厂共有 $300$ 件货物，可以完成第 $1$ 笔订单。交付后，工厂剩余 $100$ 件货物。\n- 在第 $4$ 天结束时，工厂又多生产了 $100$ 件货物，共有 $200$ 件货物，无法完成第 $2$ 笔订单。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P9557", "type": "P", "difficulty": 4, "samples": [["2 2 1 1 2\n5\n1 3 1\n0\n2 1 1 2 1\n2 3 2 2 1\n3 1 5 2 3 3 4\n1 2 5\n3 2 1 1 1 3 4\n1 1 3\n0\n1 3 2", "4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["模拟", "2023", "山东", "O2优化", "省赛/邀请赛"], "title": "[SDCPC 2023] Building Company", "background": "", "description": "You're the boss of a building company. At the beginning, there are $g$ types of employees in the company, and different types of employees have different occupations. For the $i$-th type of employees, their occupation can be numbered as $t_i$ and there are $u_i$ employees in total.\n\nThere are $n$ building projects in the market waiting to be undertaken. To undertake the $i$-th project, your company must meet $m_i$ requirements. The $j$-th requirement requires that your company has at least $b_{i, j}$ employees whose occupation is $a_{i, j}$. After undertaking the project, your company will become more famous and will attract $k_i$ types of employees to join your company. The occupation of the $j$-th type of employees is $c_{i, j}$ and there are $d_{i, j}$ employees in total.\n\nYou can undertake any number of projects in any order. Each project can be undertaken at most once. Calculate the maximum number of projects you can undertake.\n\nNote that employees are not consumables. After undertaking a project the number of employees in your company won't decrease.", "inputFormat": "There is only one test case in each test file.\n\nThe first line of the input first contains an integer $g$ ($1 \\le g \\le 10^5$) indicating the number of types of employees in the company at the beginning. Then $g$ pairs of integers $t_1, u_1, t_2, u_2, \\cdots t_g, u_g$ follow ($1 \\le t_i, u_i \\le 10^9$), where $t_i$ and $u_i$ indicate that there are $u_i$ employees whose occupation is $t_i$. It's guaranteed that for all $1 \\le i < j \\le g$ we have $t_i \\ne t_j$.\n\nThe second line contains an integer $n$ ($1 \\le n \\le 10^5$) indicating the number of projects waiting to be undertaken.\n\nFor the following $2n$ lines, each two lines describe a project.\n\nThe $(2i - 1)$-th line first contains an integer $m_i$ ($0 \\le m_i \\le 10^5$) indicating the number of requirements to undertake the $i$-th project. Then $m_i$ pairs of integers $a_{i, 1}, b_{i, 1}, a_{i, 2}, b_{i, 2}, \\cdots, a_{i, m_i}, b_{i, m_i}$ follow ($1 \\le a_{i, j}, b_{i, j} \\le 10^9$) where $a_{i, j}$ and $b_{i, j}$ indicate that the company is required to have at least $b_{i, j}$ employees whose occupation is $a_{i, j}$. It's guaranteed that for all $1 \\le x < y \\le m_i$ we have $a_{i, x} \\ne a_{i, y}$.\n\nThe $2i$-th line first contains an integer $k_i$ ($0 \\le k_i \\le 10^5$) indicating the number of types of employees to join the company after undertaking the $i$-th project. Then $k_i$ pairs of integers $c_{i, 1}, d_{i, 1}, c_{i, 2}, d_{i, 2}, \\cdots, c_{i, k_i}, d_{i, k_i}$ follow ($1 \\le c_{i, j}, d_{i, j} \\le 10^9$) where $c_{i, j}$ and $d_{i, j}$ indicate that there are $d_{i, j}$ employees whose occupation is $c_{i, j}$ joining the company. It's guaranteed that for all $1 \\le x < y \\le k_i$ we have $c_{i, x} \\ne c_{i, y}$.\n\nIt's guaranteed that neither the sum of $m_i$ nor the sum of $k_i$ will exceed $10^5$.", "outputFormat": "Output one line containing one integer indicating the maximum number of projects you can undertake.", "hint": "We explain the sample test case as follows. Let $(t, u)$ indicate $u$ employees whose occupation is $t$.\n\nFirst, undertake the $5$-th project with no requirements. After undertaking the project, there are $2$ employees, whose occupation is $3$, joining the company. The company now have these employees: $\\{(1, 2), (2, 1), (3, 2)\\}$.\n\nNext, undertake the $1$-st project. After undertaking the project, no employee joins the company. The company now still have these employees: $\\{(1, 2), (2, 1), (3, 2)\\}$.\n\nNext, undertake the $2$-nd project. After undertaking the project, there are $2$ employees, whose occupation is $3$, and $1$ employee, whose occupation is $2$, joining the company. The company now have these employees: $\\{(1, 2), (2, 2), (3, 4)\\}$.\n\nNext, undertake the $4$-th project. After undertaking the project, there are $3$ employees, whose occupation is $1$, joining the company. The company now have these employees: $\\{(1, 5), (2, 2), (3, 4)\\}$.\n\nAs the company does not have $3$ employees whose occupation is $2$, we cannot undertake the $3$-rd project.", "locale": "en", "translations": {"en": {"title": "[SDCPC 2023] Building Company", "background": "", "description": "You're the boss of a building company. At the beginning, there are $g$ types of employees in the company, and different types of employees have different occupations. For the $i$-th type of employees, their occupation can be numbered as $t_i$ and there are $u_i$ employees in total.\n\nThere are $n$ building projects in the market waiting to be undertaken. To undertake the $i$-th project, your company must meet $m_i$ requirements. The $j$-th requirement requires that your company has at least $b_{i, j}$ employees whose occupation is $a_{i, j}$. After undertaking the project, your company will become more famous and will attract $k_i$ types of employees to join your company. The occupation of the $j$-th type of employees is $c_{i, j}$ and there are $d_{i, j}$ employees in total.\n\nYou can undertake any number of projects in any order. Each project can be undertaken at most once. Calculate the maximum number of projects you can undertake.\n\nNote that employees are not consumables. After undertaking a project the number of employees in your company won't decrease.", "inputFormat": "There is only one test case in each test file.\n\nThe first line of the input first contains an integer $g$ ($1 \\le g \\le 10^5$) indicating the number of types of employees in the company at the beginning. Then $g$ pairs of integers $t_1, u_1, t_2, u_2, \\cdots t_g, u_g$ follow ($1 \\le t_i, u_i \\le 10^9$), where $t_i$ and $u_i$ indicate that there are $u_i$ employees whose occupation is $t_i$. It's guaranteed that for all $1 \\le i < j \\le g$ we have $t_i \\ne t_j$.\n\nThe second line contains an integer $n$ ($1 \\le n \\le 10^5$) indicating the number of projects waiting to be undertaken.\n\nFor the following $2n$ lines, each two lines describe a project.\n\nThe $(2i - 1)$-th line first contains an integer $m_i$ ($0 \\le m_i \\le 10^5$) indicating the number of requirements to undertake the $i$-th project. Then $m_i$ pairs of integers $a_{i, 1}, b_{i, 1}, a_{i, 2}, b_{i, 2}, \\cdots, a_{i, m_i}, b_{i, m_i}$ follow ($1 \\le a_{i, j}, b_{i, j} \\le 10^9$) where $a_{i, j}$ and $b_{i, j}$ indicate that the company is required to have at least $b_{i, j}$ employees whose occupation is $a_{i, j}$. It's guaranteed that for all $1 \\le x < y \\le m_i$ we have $a_{i, x} \\ne a_{i, y}$.\n\nThe $2i$-th line first contains an integer $k_i$ ($0 \\le k_i \\le 10^5$) indicating the number of types of employees to join the company after undertaking the $i$-th project. Then $k_i$ pairs of integers $c_{i, 1}, d_{i, 1}, c_{i, 2}, d_{i, 2}, \\cdots, c_{i, k_i}, d_{i, k_i}$ follow ($1 \\le c_{i, j}, d_{i, j} \\le 10^9$) where $c_{i, j}$ and $d_{i, j}$ indicate that there are $d_{i, j}$ employees whose occupation is $c_{i, j}$ joining the company. It's guaranteed that for all $1 \\le x < y \\le k_i$ we have $c_{i, x} \\ne c_{i, y}$.\n\nIt's guaranteed that neither the sum of $m_i$ nor the sum of $k_i$ will exceed $10^5$.", "outputFormat": "Output one line containing one integer indicating the maximum number of projects you can undertake.", "hint": "We explain the sample test case as follows. Let $(t, u)$ indicate $u$ employees whose occupation is $t$.\n\nFirst, undertake the $5$-th project with no requirements. After undertaking the project, there are $2$ employees, whose occupation is $3$, joining the company. The company now have these employees: $\\{(1, 2), (2, 1), (3, 2)\\}$.\n\nNext, undertake the $1$-st project. After undertaking the project, no employee joins the company. The company now still have these employees: $\\{(1, 2), (2, 1), (3, 2)\\}$.\n\nNext, undertake the $2$-nd project. After undertaking the project, there are $2$ employees, whose occupation is $3$, and $1$ employee, whose occupation is $2$, joining the company. The company now have these employees: $\\{(1, 2), (2, 2), (3, 4)\\}$.\n\nNext, undertake the $4$-th project. After undertaking the project, there are $3$ employees, whose occupation is $1$, joining the company. The company now have these employees: $\\{(1, 5), (2, 2), (3, 4)\\}$.\n\nAs the company does not have $3$ employees whose occupation is $2$, we cannot undertake the $3$-rd project.", "locale": "en"}, "zh-CN": {"title": "[SDCPC 2023] Building Company", "background": "", "description": "您是一家建筑公司的老板。一开始，公司共有 $g$ 类员工，每一类员工都属于一个工种。第 $i$ 类员工的工种编号为 $t_i$，共有 $u_i$ 人。\n\n市场上共有 $n$ 项工程等待承接。想要承接第 $i$ 项工程，您的公司需要满足 $m_i$ 项要求，其中第 $j$ 项要求您的公司至少有工种编号为 $a_{i, j}$ 的员工 $b_{i, j}$ 人。承接该工程后，您的公司将会更加有名，并吸引 $k_i$ 类员工加入公司，其中第 $j$ 类员工的工种编号为 $c_{i, j}$，共有 $d_{i, j}$ 人。\n\n您可以按任意顺序承接任意数量的工程，每项工程最多只能被承接一次。求最多能承接多少工程。\n\n请注意：员工不是消耗品。承接一项工程后，员工的数量不会减少。", "inputFormat": "每个测试文件仅有一组测试数据。\n\n第一行首先输入一个整数 $g$（$1 \\le g \\le 10^5$）表示一开始公司内员工的种类数。接下来输入 $g$ 对整数 $t_1, u_1, t_2, u_2, \\cdots t_g, u_g$（$1 \\le t_i, u_i \\le 10^9$），其中 $t_i$ 和 $u_i$ 表示一开始工种编号为 $t_i$ 的员工共有 $u_i$ 人。保证对于所有 $1 \\le i < j \\le g$ 有 $t_i \\ne t_j$。\n\n第二行输入一个整数 $n$（$1 \\le n \\le 10^5$）表示等待承接的工程数量。\n\n对于接下来 $2n$ 行，每两行描述一项工程。\n\n第 $(2i - 1)$ 行首先输入一个整数 $m_i$（$0 \\le m_i \\le 10^5$）表示承接第 $i$ 项工程有几项要求。接下来输入 $m_i$ 对整数 $a_{i, 1}, b_{i, 1}, a_{i, 2}, b_{i, 2}, \\cdots, a_{i, m_i}, b_{i, m_i}$（$1 \\le a_{i, j}, b_{i, j} \\le 10^9$），其中 $a_{i, j}$ 和 $b_{i, j}$ 表示公司至少要有工种编号为 $a_{i, j}$ 的员工 $b_{i, j}$ 人。保证对于所有 $1 \\le x < y \\le m_i$ 有 $a_{i, x} \\ne a_{i, y}$。\n\n第 $2i$ 行首先输入一个整数 $k_i$（$0 \\le k_i \\le 10^5$）表示承接第 $i$ 项工程之后有几类员工加入公司。接下来输入 $k_i$ 对整数  $c_{i, 1}, d_{i, 1}, c_{i, 2}, d_{i, 2}, \\cdots, c_{i, k_i}, d_{i, k_i}$（$1 \\le c_{i, j}, d_{i, j} \\le 10^9$），其中 $c_{i, j}$ 和 $d_{i, j}$ 表示工种编号为 $c_{i, j}$ 的员工共 $d_{i, j}$ 人加入公司。保证对于所有 $1 \\le x < y \\le k_i$ 有 $c_{i, x} \\ne c_{i, y}$。\n\n保证 $m_i$ 与 $k_i$ 之和均不超过 $10^5$。", "outputFormat": "输出一行一个整数表示最多能承接几项工程。\n\n**【样例解释】**\n\n样例解释如下，用 $(t, u)$ 表示工种为 $t$ 的员工有 $u$ 名。\n\n首先承接没有任何要求的第 $5$ 项工程，承接后工种为 $3$ 的 $2$ 名员工加入公司。公司内现有员工为 $\\{(1, 2), (2, 1), (3, 2)\\}$。\n\n接下来承接第 $1$ 项工程，承接后没有员工加入公司。公司内现有员工仍为 $\\{(1, 2), (2, 1), (3, 2)\\}$。\n\n接下来承接第 $2$ 项工程，承接后工种为 $3$ 的 $2$ 名员工，以及工种为 $2$ 的 $1$ 名员工加入公司。公司内现有员工为 $\\{(1, 2), (2, 2), (3, 4)\\}$。\n\n接下来承接第 $4$ 项工程，承接后工种为 $1$ 的 $3$ 名员工加入公司。公司内现有员工为 $\\{(1, 5), (2, 2), (3, 4)\\}$。\n\n由于工种为 $2$ 的员工不足 $3$ 名，因此无法承接仅剩的第 $3$ 项工程。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P9558", "type": "P", "difficulty": 6, "samples": [["2\n5 4\n0 1 1 2 2\n1 4 3 5\n1 1\n0\n1", "abaab\na"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2023", "山东", "O2优化", "省赛/邀请赛"], "title": "[SDCPC 2023] Trie", "background": "", "description": "Recall the definition of a trie:\n\n- A trie of size $n$ is a rooted tree with $n$ vertices and $(n - 1)$ edges, where each edge is marked with a character.\n- Each vertex in a trie represents a string. Let $s(x)$ be the string vertex $x$ represents.\n- The root of the trie represents an empty string. Let vertex $u$ be the parent of vertex $v$, and let $c$ be the character marked on the edge connecting vertex $u$ and $v$, we have $s(v) = s(u) + c$. Here $+$ indicates string concatenation, not the normal addition operation.\n- The string each vertex represents is distinct.\n\nWe now present you a rooted tree with $(n + 1)$ vertices. The vertices are numbered $0, 1, \\cdots, n$ and vertex $0$ is the root. There are $m$ key vertices in the tree where vertex $k_i$ is the $i$-th key vertex. It's guaranteed that all leaves are key vertices.\n\nPlease mark a lower-cased English letter on each edge so that the rooted tree changes into a trie of size $(n + 1)$. Let's consider the sequence $A = \\{s(k_1), s(k_2), \\cdots, s(k_m)\\}$ consisting of all strings represented by the key vertices. Let $B = \\{w_1, w_2, \\cdots, w_m\\}$ be the string sequence formed by sorting all strings in sequence $A$ from smallest to largest in lexicographic order. Please find a way to mark the edges so that sequence $B$ is minimized.\n\nWe say a string $P = p_1p_2\\cdots p_x$ of length $x$ is lexicographically smaller than a string $Q = q_1q_2\\cdots q_y$ of length $y$, if\n\n- $x < y$ and for all $1 \\le i \\le x$ we have $p_i = q_i$, or\n- there exists an integer $1 \\le t \\le \\min(x, y)$ such that for all $1 \\le i < t$ we have $p_i = q_i$, and $p_t < q_t$.\n\nWe say a string sequence $F = \\{f_1, f_2, \\cdots, f_m\\}$ of length $m$ is smaller than a string sequence $G = \\{g_1, g_2, \\cdots, g_m\\}$ of length $m$, if there exists an integer $1 \\le t \\le m$ such that for all $1 \\le i < t$ we have $f_i = g_i$, and $f_t$ is lexicographically smaller than $g_t$.", "inputFormat": "There are multiple test cases. The first line of th input contains an integer $T$ indicating the number of test cases. For each test case:\n\nThe first line contains two integers $n$ and $m$ ($1 \\le m \\le n \\le 2 \\times 10^5$) indicating the number of vertices other than the root and the number of key vertices.\n\nThe second line contains $n$ integers $a_1, a_2, \\cdots, a_n$ ($0 \\le a_i < i$) where $a_i$ is the parent of vertex $i$. It's guaranteed that each vertex has at most $26$ children.\n\nThe third line contains $m$ integers $k_1, k_2, \\cdots, k_m$ ($1 \\le k_i \\le n$) where $k_i$ is the $i$-th key vertex. It's guaranteed that all leaves are key vertices, and all key vertices are distinct.\n\nIt's guaranteed that the sum of $n$ of all test cases will not exceed $2 \\times 10^5$.", "outputFormat": "For each test case output one line containing one answer string $c_1c_2\\cdots c_n$ consisting of lower-cased English letters, where $c_i$ is the letter marked on the edge between $a_i$ and $i$. If there are multiple answers strings so that sequence $B$ is minimized, output the answer string with the smallest lexicographic order.", "hint": "The answer of the first sample test case is shown as follows.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zvhqplsb.png)\n\nThe string represented by vertex $1$ is ``a``. The string represented by vertex $4$ is ``aba``. The string represented by vertex $3$ is ``aa``. The string represented by vertex $5$ is ``abb``. So $B = \\{$``a``, ``aa``, ``aba``, ``abb``$\\}$.", "locale": "en", "translations": {"en": {"title": "[SDCPC 2023] Trie", "background": "", "description": "Recall the definition of a trie:\n\n- A trie of size $n$ is a rooted tree with $n$ vertices and $(n - 1)$ edges, where each edge is marked with a character.\n- Each vertex in a trie represents a string. Let $s(x)$ be the string vertex $x$ represents.\n- The root of the trie represents an empty string. Let vertex $u$ be the parent of vertex $v$, and let $c$ be the character marked on the edge connecting vertex $u$ and $v$, we have $s(v) = s(u) + c$. Here $+$ indicates string concatenation, not the normal addition operation.\n- The string each vertex represents is distinct.\n\nWe now present you a rooted tree with $(n + 1)$ vertices. The vertices are numbered $0, 1, \\cdots, n$ and vertex $0$ is the root. There are $m$ key vertices in the tree where vertex $k_i$ is the $i$-th key vertex. It's guaranteed that all leaves are key vertices.\n\nPlease mark a lower-cased English letter on each edge so that the rooted tree changes into a trie of size $(n + 1)$. Let's consider the sequence $A = \\{s(k_1), s(k_2), \\cdots, s(k_m)\\}$ consisting of all strings represented by the key vertices. Let $B = \\{w_1, w_2, \\cdots, w_m\\}$ be the string sequence formed by sorting all strings in sequence $A$ from smallest to largest in lexicographic order. Please find a way to mark the edges so that sequence $B$ is minimized.\n\nWe say a string $P = p_1p_2\\cdots p_x$ of length $x$ is lexicographically smaller than a string $Q = q_1q_2\\cdots q_y$ of length $y$, if\n\n- $x < y$ and for all $1 \\le i \\le x$ we have $p_i = q_i$, or\n- there exists an integer $1 \\le t \\le \\min(x, y)$ such that for all $1 \\le i < t$ we have $p_i = q_i$, and $p_t < q_t$.\n\nWe say a string sequence $F = \\{f_1, f_2, \\cdots, f_m\\}$ of length $m$ is smaller than a string sequence $G = \\{g_1, g_2, \\cdots, g_m\\}$ of length $m$, if there exists an integer $1 \\le t \\le m$ such that for all $1 \\le i < t$ we have $f_i = g_i$, and $f_t$ is lexicographically smaller than $g_t$.", "inputFormat": "There are multiple test cases. The first line of th input contains an integer $T$ indicating the number of test cases. For each test case:\n\nThe first line contains two integers $n$ and $m$ ($1 \\le m \\le n \\le 2 \\times 10^5$) indicating the number of vertices other than the root and the number of key vertices.\n\nThe second line contains $n$ integers $a_1, a_2, \\cdots, a_n$ ($0 \\le a_i < i$) where $a_i$ is the parent of vertex $i$. It's guaranteed that each vertex has at most $26$ children.\n\nThe third line contains $m$ integers $k_1, k_2, \\cdots, k_m$ ($1 \\le k_i \\le n$) where $k_i$ is the $i$-th key vertex. It's guaranteed that all leaves are key vertices, and all key vertices are distinct.\n\nIt's guaranteed that the sum of $n$ of all test cases will not exceed $2 \\times 10^5$.", "outputFormat": "For each test case output one line containing one answer string $c_1c_2\\cdots c_n$ consisting of lower-cased English letters, where $c_i$ is the letter marked on the edge between $a_i$ and $i$. If there are multiple answers strings so that sequence $B$ is minimized, output the answer string with the smallest lexicographic order.", "hint": "The answer of the first sample test case is shown as follows.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zvhqplsb.png)\n\nThe string represented by vertex $1$ is ``a``. The string represented by vertex $4$ is ``aba``. The string represented by vertex $3$ is ``aa``. The string represented by vertex $5$ is ``abb``. So $B = \\{$``a``, ``aa``, ``aba``, ``abb``$\\}$.", "locale": "en"}, "zh-CN": {"title": "[SDCPC 2023] Trie", "background": "", "description": "请回忆字典树的定义：\n\n- 一棵大小为 $n$ 的字典树是一棵有 $n$ 个节点和 $(n - 1)$ 条边的有根树，每一条边都标有一个字符。\n- 字典树中的每个节点都代表一个字符串，令 $s(x)$ 表示节点 $x$ 代表的字符串。\n- 字典树的根代表的是空字符串。设节点 $u$ 为节点 $v$ 的父节点，设 $c$ 表示节点 $u$ 和 $v$ 之间的边上标有的字符，则 $s(v) = s(u) + c$。这里的 $+$ 代表字符串连接，而不是普通的加法。\n- 所有节点代表的字符串互不相同。\n\n给定一棵有 $(n + 1)$ 个节点的有根树，节点编号为 $0, 1, \\cdots, n$，其中节点 $0$ 是根节点。树上共有 $m$ 个关键节点，其中第 $i$ 个关键节点的编号为 $k_i$。保证所有叶子节点都是关键节点。\n\n请为每一条边标上一个小写字母，使得这棵有根树变为一棵大小为 $(n + 1)$ 的字典树。考虑所有关键节点代表的字符串构成的序列 $A = \\{s(k_1), s(k_2), \\cdots, s(k_m)\\}$，设 $B = \\{w_1, w_2, \\cdots, w_m\\}$ 是由序列 $A$ 中所有字符串按字典序从小到大排序后得到的字符串序列，您需要找到一个标记字母的方案，使得序列 $B$ 最小。\n\n称长度为 $x$ 的字符串 $P = p_1p_2\\cdots p_x$ 的字典序小于长度为 $y$ 的字符串 $Q = q_1q_2\\cdots q_y$，若\n\n- $x < y$ 且对于所有 $1 \\le i \\le x$ 有 $p_i = q_i$，或者\n- 存在一个整数 $1 \\le t \\le \\min(x, y)$，对于所有 $1 \\le i < t$ 有 $p_i = q_i$，且 $p_t < q_t$。\n\n称长度为 $m$ 的字符串序列 $F = \\{f_1, f_2, \\cdots, f_m\\}$ 小于长度为 $m$ 的字符串序列 $G = \\{g_1, g_2, \\cdots, g_m\\}$，若存在一个整数 $1 \\le t \\le m$，对于所有 $1 \\le i < t$ 有 $f_i = g_i$，且 $f_t$ 的字典序小于 $g_t$ 的字典序。", "inputFormat": "有多组测试数据。第一行输入一个整数 $T$ 表示测试数据组数。对于每组测试数据：\n\n第一行输入两个正整数 $n$ 和 $m$（$1 \\le m \\le n \\le 2 \\times 10^5$）表示除了根节点以外的节点数量和关键节点的数量。\n\n第二行输入 $n$ 个整数 $a_1, a_2, \\cdots, a_n$（$0 \\le a_i < i$），其中 $a_i$ 代表节点 $i$ 的父节点。保证每个节点至多有 $26$ 个子节点。\n\n第三行输入 $m$ 个整数 $k_1, k_2, \\cdots, k_m$（$1 \\le k_i \\le n$），其中 $k_i$ 代表第 $i$ 个关键节点的编号。保证所有叶子节点都是关键节点，且没有重复的关键节点。\n\n保证所有测试数据 $n$ 之和不超过 $2 \\times 10^5$。", "outputFormat": "每组数据输出一行一个由小写字母组成的答案字符串 $c_1c_2\\cdots c_n$，其中 $c_i$ 表示节点 $a_i$ 到 $i$ 的边上标有的小写字母。若有多种答案字符串使得字符串序列 $B$ 最小，请输出字典序最小的答案字符串。\n\n**【样例解释】**\n\n第一组样例数据的答案如下图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zvhqplsb.png)\n\n其中，节点 $1$ 代表的字符串为 ``a``，节点 $4$ 代表的字符串为 ``aba``，节点 $3$ 代表的字符串为 ``aa``，节点 $5$ 代表的字符串为 ``abb``。因此 $B = \\{$``a``, ``aa``, ``aba``, ``abb``$\\}$。", "hint": "", "locale": "zh-CN"}}}
