{"pid": "P3289", "type": "P", "difficulty": 7, "samples": [["3\n3 4\n1 1\n5 1", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "四川", "各省省选"], "title": "[SCOI2014] 舌尖上的方伯伯", "background": "", "description": "方伯伯为了吃到最传统最纯净的美食，决定亲自开垦一片菜园。现有一片空地，方伯伯已经规划n个地点准备种上蔬菜。\n\n最新鲜的蔬菜需有最甘甜井水的灌溉，因此方伯伯将要打出两口井，分别记为井A、井B。现在问题来了，在何处打井？每颗蔬菜分别由哪口井来灌溉？方伯伯不善于计算，于是提出以下几个原则，再根据这些原则找方案。原则如下：\n\n1.井必须打在它负责灌溉的蔬菜的正中心，即设它的坐标为(X,Y)，X(Y)为它负责灌溉的所有蔬菜的横(纵)坐标之和的平均值。\n\n2.所有蔬菜都需要被灌溉。3.两口井都必须要灌溉至少一颗蔬菜。4.到A井更近的蔬菜，必须由A井灌溉，到B井更近的蔬菜，必须由B井灌溉。距离相等相等时则可任意一口井灌溉。\n\n当然两口井不能打到同一个位置，多株蔬菜当然也不会种在同一个位置。\n\n方伯伯把他的开垦原则告诉了你，请你告诉他有多少种满足这些原则方案。我们把灌溉1号蔬菜的井记为A号井，那么，只要A灌溉的蔬菜的集合不同，就是一种不同的方案。\n", "inputFormat": "输入1行包含1个整数n，代表方师傅的蔬菜的数目接下来n行，每行包含2个整数，xi，yi，代表第i棵蔬菜的坐标。\n", "outputFormat": "输出包含1个整数，代表方师傅可行的方案数\n", "hint": "1<=n<=60，0<=xi,yi<=60\n", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2014] Uncle Fang on the Tip of the Tongue", "background": "", "description": "To enjoy the most traditional and pure cuisine, Uncle Fang decides to cultivate a vegetable garden. There is a piece of open land with $n$ planned spots where he intends to plant vegetables.\n\nThe freshest vegetables must be irrigated with the sweetest well water, so Uncle Fang will dig two wells, called well A and well B. The questions are: where to dig the wells, and which vegetables should each well irrigate? Since Uncle Fang is not good at calculations, he proposes the following principles and asks you to find all schemes that satisfy them:\n\n1. Each well must be placed at the centroid of the vegetables it irrigates. That is, if a well’s coordinates are $(X, Y)$, then $X$ (respectively $Y$) equals the average of the $x$ (respectively $y$) coordinates of all vegetables it irrigates.\n2. All vegetables must be irrigated.\n3. Each of the two wells must irrigate at least one vegetable.\n4. Any vegetable that is closer to well A must be irrigated by well A; any vegetable that is closer to well B must be irrigated by well B. When the distances are equal, either well may irrigate that vegetable.\n\nOf course, the two wells cannot be at the same position, and no two vegetables are planted at the same position.\n\nWe define the well that irrigates vegetable $1$ as well A. Two schemes are considered different if and only if the set of vegetables irrigated by well A is different.", "inputFormat": "The first line contains an integer $n$, the number of vegetables.  \nThe next $n$ lines each contain two integers $x_i$, $y_i$, representing the coordinates of the $i$-th vegetable.", "outputFormat": "Output a single integer: the number of feasible schemes.", "hint": "Constraints: $1 \\le n \\le 60$, $0 \\le x_i, y_i \\le 60$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2014] 舌尖上的方伯伯", "background": "", "description": "方伯伯为了吃到最传统最纯净的美食，决定亲自开垦一片菜园。现有一片空地，方伯伯已经规划n个地点准备种上蔬菜。\n\n最新鲜的蔬菜需有最甘甜井水的灌溉，因此方伯伯将要打出两口井，分别记为井A、井B。现在问题来了，在何处打井？每颗蔬菜分别由哪口井来灌溉？方伯伯不善于计算，于是提出以下几个原则，再根据这些原则找方案。原则如下：\n\n1.井必须打在它负责灌溉的蔬菜的正中心，即设它的坐标为(X,Y)，X(Y)为它负责灌溉的所有蔬菜的横(纵)坐标之和的平均值。\n\n2.所有蔬菜都需要被灌溉。3.两口井都必须要灌溉至少一颗蔬菜。4.到A井更近的蔬菜，必须由A井灌溉，到B井更近的蔬菜，必须由B井灌溉。距离相等相等时则可任意一口井灌溉。\n\n当然两口井不能打到同一个位置，多株蔬菜当然也不会种在同一个位置。\n\n方伯伯把他的开垦原则告诉了你，请你告诉他有多少种满足这些原则方案。我们把灌溉1号蔬菜的井记为A号井，那么，只要A灌溉的蔬菜的集合不同，就是一种不同的方案。\n", "inputFormat": "输入1行包含1个整数n，代表方师傅的蔬菜的数目接下来n行，每行包含2个整数，xi，yi，代表第i棵蔬菜的坐标。\n", "outputFormat": "输出包含1个整数，代表方师傅可行的方案数\n", "hint": "1<=n<=60，0<=xi,yi<=60\n", "locale": "zh-CN"}}}
{"pid": "P3290", "type": "P", "difficulty": 7, "samples": [["3 1 1 2\nB\nW\nB\nB", "6\n5"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "2016", "四川", "各省省选", "KMP 算法"], "title": "[SCOI2016] 围棋", "background": "", "description": "近日，谷歌研发的围棋 AI——AlphaGo 以 $4:1$ 的比分战胜了曾经的世界冠军李世石，这是人工智能领域的又一里程碑。\n\n与传统的搜索式 AI 不同，AlphaGo 使用了最近十分流行的卷积神经网络模型。在卷积神经网络模型中，棋盘上每一块特定大小的区域都被当做一个窗口。例如棋盘的大小为 $5\\times 6$，窗口大小为 $2\\times 4$，那么棋盘中共有 $12$ 个窗口。此外，模型中预先设定了一些模板，模板的大小与窗口的大小是一样的。\n\n下图展现了一个 $5\\times 6$ 的棋盘和两个 $2\\times 4$ 的模板：\n\n![](https://i.loli.net/2020/03/05/24yfVvrmNScWF5g.jpg)\n\n对于一个模板，只要棋盘中有某个窗口与其完全匹配，我们称这个模板是被激活的，否则称这个模板没有被激活。\n\n例如图中第一个模板就是被激活的，而第二个模板就是没有被激活的。我们要研究的问题是：对于给定的模板，有多少个棋盘可以激活它。\n\n为了简化问题，我们抛开所有围棋的基本规则，只考虑一个 $n\\times m$ 的棋盘，每个位置只能是黑子、白子或无子三种情况，换句话说，这样的棋盘共有 $3^{n\\times m}$ 种。此外，我们会给出 $q$ 个 $2\\times c$ 的模板。\n\n我们希望知道，对于每个模板，有多少种棋盘可以激活它。强调：模板一定是两行的。\n", "inputFormat": "输入数据的第一行包含四个正整数 $n,m,c$ 和 $q$，分别表示棋盘的行数、列数、模板的列数和模板的数量。\n\n随后 $2\\times q$ 行，每连续两行描述一个模板。其中，每行包含 $c$ 个字符，字符一定是 ```W```，```B``` 或 ```X``` 中的一个，表示白子、黑子或无子三种情况的一种。", "outputFormat": "输出应包含 $q$ 行，每行一个整数，表示符合要求的棋盘数量。由于答案可能很大，你只需要输出答案对 $10^9+7$ 取模后的结果即可。\n", "hint": "对于所有测试点：$1\\leq n\\leq 100$，$1\\leq m\\leq 12$，$1\\leq c\\leq 6$，$1\\leq q\\leq 5$。\n\n| 测试点编号 | 约定 |\n| :----------: | :----------: |\n| $1$ | $n=3$，$m=4$，$c=2$ |\n| $2$ | $n=4$，$m=4$，$c=3$ |\n| $3$ | $n=2$，$m=9$，$c=6$ |\n| $4$ | $n=2$，$m=12$，$c=3$ |\n| $5$ | $n=2$，$m=12$，$c=5$ |\n| $6$ | $n=10$，$m=8$，$c=3$ |\n| $7$ | $n=10$，$m=10$，$c=5$ |\n| $8$ | $n=100$，$m=10$，$c=5$ |\n| $9$ | $n=100$，$m=12$，$c=5$ |\n| $10$ | $n=100$，$m=12$，$c=6$ |", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2016] Go", "background": "", "description": "Recently, Google’s Go AI—AlphaGo—defeated the former world champion Lee Sedol by a score of $4:1$, which is another milestone in the field of artificial intelligence.\n\nUnlike traditional search-based AI, AlphaGo uses the now very popular convolutional neural network model. In a convolutional neural network, every region of a specific size on the board is treated as a window. For example, if the board size is $5\\times 6$ and the window size is $2\\times 4$, then there are $12$ windows on the board. In addition, the model has some predefined templates whose size is the same as the window size.\n\nThe following figure shows a $5\\times 6$ board and two $2\\times 4$ templates:\n\n![](https://i.loli.net/2020/03/05/24yfVvrmNScWF5g.jpg)\n\nFor a template, as long as there exists a window on the board that matches it exactly, we say the template is activated; otherwise, the template is not activated.\n\nFor example, in the figure the first template is activated, while the second one is not. The question we study is: for a given template, how many boards can activate it.\n\nTo simplify the problem, we disregard all basic rules of Go and consider only an $n\\times m$ board, where each position can only be one of three states: black stone, white stone, or empty. In other words, there are $3^{n\\times m}$ such boards in total. In addition, we will give $q$ templates of size $2\\times c$.\n\nWe want to know, for each template, how many boards can activate it. Emphasis: templates always have exactly two rows.", "inputFormat": "The first line of input contains four positive integers $n, m, c$ and $q$, representing the number of rows of the board, the number of columns of the board, the number of columns of the template, and the number of templates, respectively.\n\nThen $2\\times q$ lines follow; every consecutive two lines describe one template. Each line contains $c$ characters, and each character is one of ```W```, ```B``` or ```X```, representing white stone, black stone, or empty, respectively.", "outputFormat": "Output should contain $q$ lines, each with one integer, representing the number of boards that meet the requirement. Since the answer can be large, you only need to output the result modulo $10^9+7$.", "hint": "For all test points: $1\\leq n\\leq 100$, $1\\leq m\\leq 12$, $1\\leq c\\leq 6$, $1\\leq q\\leq 5$.\n\n| Test point ID | Settings |\n| :----------: | :----------: |\n| $1$ | $n=3$, $m=4$, $c=2$ |\n| $2$ | $n=4$, $m=4$, $c=3$ |\n| $3$ | $n=2$, $m=9$, $c=6$ |\n| $4$ | $n=2$, $m=12$, $c=3$ |\n| $5$ | $n=2$, $m=12$, $c=5$ |\n| $6$ | $n=10$, $m=8$, $c=3$ |\n| $7$ | $n=10$, $m=10$, $c=5$ |\n| $8$ | $n=100$, $m=10$, $c=5$ |\n| $9$ | $n=100$, $m=12$, $c=5$ |\n| $10$ | $n=100$, $m=12$, $c=6$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2016] 围棋", "background": "", "description": "近日，谷歌研发的围棋 AI——AlphaGo 以 $4:1$ 的比分战胜了曾经的世界冠军李世石，这是人工智能领域的又一里程碑。\n\n与传统的搜索式 AI 不同，AlphaGo 使用了最近十分流行的卷积神经网络模型。在卷积神经网络模型中，棋盘上每一块特定大小的区域都被当做一个窗口。例如棋盘的大小为 $5\\times 6$，窗口大小为 $2\\times 4$，那么棋盘中共有 $12$ 个窗口。此外，模型中预先设定了一些模板，模板的大小与窗口的大小是一样的。\n\n下图展现了一个 $5\\times 6$ 的棋盘和两个 $2\\times 4$ 的模板：\n\n![](https://i.loli.net/2020/03/05/24yfVvrmNScWF5g.jpg)\n\n对于一个模板，只要棋盘中有某个窗口与其完全匹配，我们称这个模板是被激活的，否则称这个模板没有被激活。\n\n例如图中第一个模板就是被激活的，而第二个模板就是没有被激活的。我们要研究的问题是：对于给定的模板，有多少个棋盘可以激活它。\n\n为了简化问题，我们抛开所有围棋的基本规则，只考虑一个 $n\\times m$ 的棋盘，每个位置只能是黑子、白子或无子三种情况，换句话说，这样的棋盘共有 $3^{n\\times m}$ 种。此外，我们会给出 $q$ 个 $2\\times c$ 的模板。\n\n我们希望知道，对于每个模板，有多少种棋盘可以激活它。强调：模板一定是两行的。\n", "inputFormat": "输入数据的第一行包含四个正整数 $n,m,c$ 和 $q$，分别表示棋盘的行数、列数、模板的列数和模板的数量。\n\n随后 $2\\times q$ 行，每连续两行描述一个模板。其中，每行包含 $c$ 个字符，字符一定是 ```W```，```B``` 或 ```X``` 中的一个，表示白子、黑子或无子三种情况的一种。", "outputFormat": "输出应包含 $q$ 行，每行一个整数，表示符合要求的棋盘数量。由于答案可能很大，你只需要输出答案对 $10^9+7$ 取模后的结果即可。\n", "hint": "对于所有测试点：$1\\leq n\\leq 100$，$1\\leq m\\leq 12$，$1\\leq c\\leq 6$，$1\\leq q\\leq 5$。\n\n| 测试点编号 | 约定 |\n| :----------: | :----------: |\n| $1$ | $n=3$，$m=4$，$c=2$ |\n| $2$ | $n=4$，$m=4$，$c=3$ |\n| $3$ | $n=2$，$m=9$，$c=6$ |\n| $4$ | $n=2$，$m=12$，$c=3$ |\n| $5$ | $n=2$，$m=12$，$c=5$ |\n| $6$ | $n=10$，$m=8$，$c=3$ |\n| $7$ | $n=10$，$m=10$，$c=5$ |\n| $8$ | $n=100$，$m=10$，$c=5$ |\n| $9$ | $n=100$，$m=12$，$c=5$ |\n| $10$ | $n=100$，$m=12$，$c=6$ |", "locale": "zh-CN"}}}
{"pid": "P3291", "type": "P", "difficulty": 6, "samples": [["3\n1 1\n1 2\n2 2", "8.0000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["2016", "四川", "二分", "各省省选", "枚举", "凸包"], "title": "[SCOI2016] 妖怪", "background": "", "description": "\n邱老师是妖怪爱好者，他有 $n$ 只妖怪，每只妖怪有攻击力 $\\mathrm{atk}$ 和防御力 $\\mathrm{dnf}$ 两种属性。邱老师立志成为妖怪大师，于是他从真新镇出发，踏上未知的旅途，见识不同的风景。\n\n环境对妖怪的战斗力有很大影响，环境 $(a,b)$ 由 $a,b$ 两个参数定义，其中 $a,b$ 为**正实数**。在环境 $(a,b)$ 中，妖怪可以降低自己 $k\\times a$ 点攻击力，提升 $k\\times b$ 点防御力或者提升自己 $k\\times a$ 点攻击力，降低 $k\\times b$ 点防御力。其中 $k$ 为**任意实数**，但是 **$\\mathrm{atk}$ 和 $\\mathrm{dnf}$ 必须始终非负**。\n\n妖怪在环境 $(a,b)$ 中的**战斗力** $\\mathrm{strength}$ 定义为妖怪在该种环境中能达到的最大攻击力和最大防御力之和，即 $\\mathrm{strength}(a,b)=\\max(\\mathrm{atk}(a,b))+\\max(\\mathrm{dnf}(a,b))$。\n\n比如当前环境 $a=3,b=2$，那么攻击力为 $6$，防御力为 $2$ 的妖怪，能达到的最大攻击力为 $9$，最大防御力为 $6$。所以该妖怪在 $a=3,b=2$ 的环境下战斗力为 $15$。\n\n因此，在不同的环境，战斗力最强的妖怪可能发生变化。\n\n作为一名优秀的妖怪训练师，邱老师想发掘每一只妖怪的最大潜力，他想知道在**最为不利的情况下**，他的 $n$ 只妖怪能够达到的最强战斗力值。换言之，存在一组正实数 $(a,b)$ 使得 $n$ 只妖怪在该环境下最强战斗力最低，你需要输出这个最低的战斗力。", "inputFormat": "第一行一个n，表示有 $n$ 只妖怪。\n\n接下来 $n$ 行，每行两个整数 $\\mathrm{atk}_i$ 和 $\\mathrm{dnf}_i$，表示第 $i$ 只妖怪的攻击力和防御力。\n", "outputFormat": "输出在最不利情况下最强妖怪的战斗力值，保留 $4$ 位小数。", "hint": "\n对于 $100\\%$ 的数据，$1\\le n\\le 10^6$，$0\\lt \\mathrm{atk},\\mathrm{dnf}\\le 10^8$。\n\nStatement fixed by Starrykiller.", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2016] Monster", "background": "", "description": "Teacher Qiu is a monster enthusiast. He has $n$ monsters, each with two attributes: attack $\\mathrm{atk}$ and defense $\\mathrm{dnf}$. Determined to become a master of monsters, he sets off from Zhenxin Town on an unknown journey to see different sceneries.\n\nThe environment $(a, b)$ is defined by two parameters $a$ and $b$, where $a$ and $b$ are positive real numbers. In environment $(a, b)$, a monster may decrease its attack by $k \\times a$ and increase its defense by $k \\times b$, or increase its attack by $k \\times a$ and decrease its defense by $k \\times b$. Here $k$ can be any real number, but $\\mathrm{atk}$ and $\\mathrm{dnf}$ must always remain non-negative.\n\nIn environment $(a, b)$, the monster’s strength $\\mathrm{strength}$ is defined as the sum of the maximum attack it can achieve and the maximum defense it can achieve in that environment, i.e., $\\mathrm{strength}(a,b)=\\max(\\mathrm{atk}(a,b))+\\max(\\mathrm{dnf}(a,b))$.\n\nFor example, if the current environment has $a=3$, $b=2$, then for a monster with attack $6$ and defense $2$, the maximum achievable attack is $9$ and the maximum achievable defense is $6$. Therefore, this monster’s strength in the environment $a=3$, $b=2$ is $15$.\n\nThus, the strongest monster may change in different environments.\n\nAs an excellent monster trainer, Teacher Qiu wants to discover each monster’s maximum potential. He wants to know, in the most unfavorable case, the strongest strength value that his $n$ monsters can achieve. In other words, there exists a pair of positive real numbers $(a, b)$ such that the strongest strength among the $n$ monsters in that environment is minimized; you need to output this minimum strength.", "inputFormat": "The first line contains an integer $n$, the number of monsters.\n\nEach of the next $n$ lines contains two integers $\\mathrm{atk}_i$ and $\\mathrm{dnf}_i$, denoting the attack and defense of the $i$-th monster.", "outputFormat": "Output the strongest monster’s strength value in the most unfavorable case, with $4$ digits after the decimal point.", "hint": "Constraints: For $100\\%$ of the testdata, $1 \\le n \\le 10^6$, $0 \\lt \\mathrm{atk}, \\mathrm{dnf} \\le 10^8$.\n\nStatement fixed by Starrykiller.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2016] 妖怪", "background": "", "description": "\n邱老师是妖怪爱好者，他有 $n$ 只妖怪，每只妖怪有攻击力 $\\mathrm{atk}$ 和防御力 $\\mathrm{dnf}$ 两种属性。邱老师立志成为妖怪大师，于是他从真新镇出发，踏上未知的旅途，见识不同的风景。\n\n环境对妖怪的战斗力有很大影响，环境 $(a,b)$ 由 $a,b$ 两个参数定义，其中 $a,b$ 为**正实数**。在环境 $(a,b)$ 中，妖怪可以降低自己 $k\\times a$ 点攻击力，提升 $k\\times b$ 点防御力或者提升自己 $k\\times a$ 点攻击力，降低 $k\\times b$ 点防御力。其中 $k$ 为**任意实数**，但是 **$\\mathrm{atk}$ 和 $\\mathrm{dnf}$ 必须始终非负**。\n\n妖怪在环境 $(a,b)$ 中的**战斗力** $\\mathrm{strength}$ 定义为妖怪在该种环境中能达到的最大攻击力和最大防御力之和，即 $\\mathrm{strength}(a,b)=\\max(\\mathrm{atk}(a,b))+\\max(\\mathrm{dnf}(a,b))$。\n\n比如当前环境 $a=3,b=2$，那么攻击力为 $6$，防御力为 $2$ 的妖怪，能达到的最大攻击力为 $9$，最大防御力为 $6$。所以该妖怪在 $a=3,b=2$ 的环境下战斗力为 $15$。\n\n因此，在不同的环境，战斗力最强的妖怪可能发生变化。\n\n作为一名优秀的妖怪训练师，邱老师想发掘每一只妖怪的最大潜力，他想知道在**最为不利的情况下**，他的 $n$ 只妖怪能够达到的最强战斗力值。换言之，存在一组正实数 $(a,b)$ 使得 $n$ 只妖怪在该环境下最强战斗力最低，你需要输出这个最低的战斗力。", "inputFormat": "第一行一个n，表示有 $n$ 只妖怪。\n\n接下来 $n$ 行，每行两个整数 $\\mathrm{atk}_i$ 和 $\\mathrm{dnf}_i$，表示第 $i$ 只妖怪的攻击力和防御力。\n", "outputFormat": "输出在最不利情况下最强妖怪的战斗力值，保留 $4$ 位小数。", "hint": "\n对于 $100\\%$ 的数据，$1\\le n\\le 10^6$，$0\\lt \\mathrm{atk},\\mathrm{dnf}\\le 10^8$。\n\nStatement fixed by Starrykiller.", "locale": "zh-CN"}}}
{"pid": "P3292", "type": "P", "difficulty": 6, "samples": [["4 2\n11 5 7 9\n1 2\n1 3\n1 4\n2 3\n1 4", "14 \n11"]], "limits": {"time": [2000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2016", "四川", "倍增", "各省省选", "线性基"], "title": "[SCOI2016] 幸运数字", "background": "", "description": "\nA 国共有 $n$ 座城市，这些城市由 $n - 1$ 条道路相连，使得任意两座城市可以互达，且路径唯一。每座城市都有一个幸运数字，以纪念碑的形式矗立在这座城市的正中心，作为城市的象征。\n\n一些旅行者希望游览 A 国。旅行者计划乘飞机降落在 $x$ 号城市，沿着 $x$ 号城市到 $y$ 号城市之间那条唯一的路径游览，最终从 $y$ 城市起飞离开 A 国。在经过每一座城市时，游览者就会有机会与这座城市的幸运数字拍照，从而将这份幸运保存到自己身上。然而，幸运是不能简单叠加的，这一点游览者也十分清楚。他们迷信着幸运数字是以异或的方式保留在自己身上的。\n\n例如，游览者拍了 $3$ 张照片，幸运值分别是 $5, 7, 11$，那么最终保留在自己身上的幸运值就是 $5 \\operatorname{xor} 7 \\operatorname{xor} 11 = 9$。\n\n有些聪明的游览者发现，只要选择性地进行拍照，便能获得更大的幸运值。例如在上述三个幸运值中，只选择 $5$ 和 $11$ ，可以保留的幸运值为 $14$ 。现在，一些游览者找到了聪明的你，希望你帮他们计算出在他们的行程安排中可以保留的最大幸运值是多少。", "inputFormat": "第一行包含 $2$ 个正整数 $n, q$，分别表示城市的数量和旅行者数量。\n\n第二行包含 $n$ 个非负整数，其中第 $i$ 个整数 $G_i$ 表示 $i$ 号城市的幸运值。\n\n随后 $n - 1$ 行，每行包含两个正整数 $x, y$，表示 $x$ 号城市和 $y$ 号城市之间有一条道路相连。\n\n随后 $q$ 行，每行包含两个正整数 $x, y$，表示这名旅行者的旅行计划是从 $x$ 号城市到 $y$ 号城市。", "outputFormat": "输出需要包含 $q$ 行，每行包含 $1$ 个非负整数，表示这名旅行者可以保留的最大幸运值。", "hint": "对于 $100 \\%$ 的数据，保证 $n \\leq 2 \\times 10^4, q \\leq 2 \\times 10^5, G_i \\leq 2^{60}$。", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2016] Lucky Numbers", "background": "", "description": "Country A has $n$ cities connected by $n - 1$ roads, so that any two cities are mutually reachable and the path between them is unique. Each city has a lucky number, which stands at the very center of the city in the form of a monument, serving as the symbol of the city.\n\nSome travelers want to tour Country A. A traveler plans to land in city $x$, travel along the unique path from city $x$ to city $y$, and finally depart from city $y$. When passing through each city, the traveler has a chance to take a photo with that city's lucky number, thereby keeping this luck. However, luck cannot be simply stacked, and the traveler knows this well. They believe that luck is kept on them via xor.\n\nFor example, if a traveler takes $3$ photos with lucky values $5, 7, 11$, then the lucky value finally kept is $5 \\operatorname{xor} 7 \\operatorname{xor} 11 = 9$.\n\nSome smart travelers have found that by selectively taking photos, they can obtain a larger lucky value. For instance, among the three lucky values above, if they only choose $5$ and $11$, the lucky value kept is $14$. Now, some travelers have come to you for help. Given their itineraries, please compute the maximum lucky value they can keep.", "inputFormat": "The first line contains $2$ positive integers $n, q$, denoting the number of cities and the number of travelers.\n\nThe second line contains $n$ non-negative integers, where the $i$-th integer $G_i$ denotes the lucky value of city $i$.\n\nThe next $n - 1$ lines each contain two positive integers $x, y$, indicating that there is a road between city $x$ and city $y$.\n\nThe next $q$ lines each contain two positive integers $x, y$, indicating that this traveler’s plan is to go from city $x$ to city $y$.", "outputFormat": "Output $q$ lines. Each line contains one non-negative integer, the maximum lucky value that this traveler can keep.", "hint": "For $100\\%$ of the testdata, it is guaranteed that $n \\leq 2 \\times 10^4$, $q \\leq 2 \\times 10^5$, $G_i \\leq 2^{60}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2016] 幸运数字", "background": "", "description": "\nA 国共有 $n$ 座城市，这些城市由 $n - 1$ 条道路相连，使得任意两座城市可以互达，且路径唯一。每座城市都有一个幸运数字，以纪念碑的形式矗立在这座城市的正中心，作为城市的象征。\n\n一些旅行者希望游览 A 国。旅行者计划乘飞机降落在 $x$ 号城市，沿着 $x$ 号城市到 $y$ 号城市之间那条唯一的路径游览，最终从 $y$ 城市起飞离开 A 国。在经过每一座城市时，游览者就会有机会与这座城市的幸运数字拍照，从而将这份幸运保存到自己身上。然而，幸运是不能简单叠加的，这一点游览者也十分清楚。他们迷信着幸运数字是以异或的方式保留在自己身上的。\n\n例如，游览者拍了 $3$ 张照片，幸运值分别是 $5, 7, 11$，那么最终保留在自己身上的幸运值就是 $5 \\operatorname{xor} 7 \\operatorname{xor} 11 = 9$。\n\n有些聪明的游览者发现，只要选择性地进行拍照，便能获得更大的幸运值。例如在上述三个幸运值中，只选择 $5$ 和 $11$ ，可以保留的幸运值为 $14$ 。现在，一些游览者找到了聪明的你，希望你帮他们计算出在他们的行程安排中可以保留的最大幸运值是多少。", "inputFormat": "第一行包含 $2$ 个正整数 $n, q$，分别表示城市的数量和旅行者数量。\n\n第二行包含 $n$ 个非负整数，其中第 $i$ 个整数 $G_i$ 表示 $i$ 号城市的幸运值。\n\n随后 $n - 1$ 行，每行包含两个正整数 $x, y$，表示 $x$ 号城市和 $y$ 号城市之间有一条道路相连。\n\n随后 $q$ 行，每行包含两个正整数 $x, y$，表示这名旅行者的旅行计划是从 $x$ 号城市到 $y$ 号城市。", "outputFormat": "输出需要包含 $q$ 行，每行包含 $1$ 个非负整数，表示这名旅行者可以保留的最大幸运值。", "hint": "对于 $100 \\%$ 的数据，保证 $n \\leq 2 \\times 10^4, q \\leq 2 \\times 10^5, G_i \\leq 2^{60}$。", "locale": "zh-CN"}}}
{"pid": "P3293", "type": "P", "difficulty": 6, "samples": [["4 4\n1 2 3 4\n1 4 1 4\n2 3 2 3\n3 2 3 3\n4 1 2 4", "9 \n7 \n6 \n7"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000], "memory": [258048, 258048, 258048, 258048, 258048, 258048]}, "tags": ["贪心", "2016", "四川", "各省省选", "可持久化线段树", "可持久化"], "title": "[SCOI2016] 美味", "background": "", "description": "\n一家餐厅有 $n$ 道菜，编号 $1, 2, \\ldots, n$，大家对第 $i$ 道菜的评价值为 $a_i$。有 $m$ 位顾客，第 $i$ 位顾客的期望值为 $b_i$，而他的偏好值为 $x_i$。因此，第 $i$ 位顾客认为第 $j$ 道菜的美味度为 $b_i\\oplus (a_j + x_i)$，$\\oplus$ 表示异或运算。\n\n第 $i$ 位顾客希望从这些菜中挑出他认为最美味的菜，即美味值最大的菜，但由于价格等因素，他只能从第 $l_i$ 道到第 $r_i$ 道中选择。请你帮助他们找出最美味的菜。", "inputFormat": "第 $1$ 行两个整数 $n, m$，表示菜品数和顾客数。\n\n第 $2$ 行 $n$ 个整数 $a_1, a_2, \\ldots, a_n$，表示每道菜的评价值。\n\n第 $3$ 至 $m + 2$ 行，每行四个整数 $b,x,l,r$，表示该位顾客的期望值，偏好值，和可以选择菜品区间。", "outputFormat": "输出 $m$ 行，每行一个整数表示该位顾客选择的最美味的菜的美味值。", "hint": "对于 $100\\%$ 的数据，满足 $1 \\le n \\le 2 \\times 10^5$，$0 \\le a_i,b_i,x_i < 10^5$，$1 \\le l_i \\le r_i \\le n$（$1 \\le i \\le m$），$1 \\le m \\le 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2016] Delicious", "background": "", "description": "A restaurant has $n$ dishes, numbered $1, 2, \\ldots, n$. The evaluation value of dish $i$ is $a_i$. There are $m$ customers. The $i$-th customer's expected value is $b_i$, and their preference value is $x_i$. Therefore, the $i$-th customer considers the deliciousness of dish $j$ to be $b_i \\oplus (a_j + x_i)$, where $\\oplus$ denotes the XOR operation.\n\nThe $i$-th customer wants to pick the dish they consider the most delicious, i.e., the one with the maximum deliciousness value, but due to price and other factors, they can only choose from dishes $l_i$ through $r_i$. Please help them find the most delicious dish.", "inputFormat": "The first line contains two integers $n, m$, the number of dishes and the number of customers.\n\nThe second line contains $n$ integers $a_1, a_2, \\ldots, a_n$, the evaluation value of each dish.\n\nLines $3$ to $m + 2$ each contain four integers $b, x, l, r$, indicating the customer's expected value, preference value, and the allowed range of dishes.", "outputFormat": "Output $m$ lines, each containing one integer, the maximum deliciousness value chosen by that customer.", "hint": "Constraints.\n\nFor $100\\%$ of the testdata, it holds that $1 \\le n \\le 2 \\times 10^5$, $0 \\le a_i, b_i, x_i < 10^5$, $1 \\le l_i \\le r_i \\le n$ ($1 \\le i \\le m$), $1 \\le m \\le 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2016] 美味", "background": "", "description": "\n一家餐厅有 $n$ 道菜，编号 $1, 2, \\ldots, n$，大家对第 $i$ 道菜的评价值为 $a_i$。有 $m$ 位顾客，第 $i$ 位顾客的期望值为 $b_i$，而他的偏好值为 $x_i$。因此，第 $i$ 位顾客认为第 $j$ 道菜的美味度为 $b_i\\oplus (a_j + x_i)$，$\\oplus$ 表示异或运算。\n\n第 $i$ 位顾客希望从这些菜中挑出他认为最美味的菜，即美味值最大的菜，但由于价格等因素，他只能从第 $l_i$ 道到第 $r_i$ 道中选择。请你帮助他们找出最美味的菜。", "inputFormat": "第 $1$ 行两个整数 $n, m$，表示菜品数和顾客数。\n\n第 $2$ 行 $n$ 个整数 $a_1, a_2, \\ldots, a_n$，表示每道菜的评价值。\n\n第 $3$ 至 $m + 2$ 行，每行四个整数 $b,x,l,r$，表示该位顾客的期望值，偏好值，和可以选择菜品区间。", "outputFormat": "输出 $m$ 行，每行一个整数表示该位顾客选择的最美味的菜的美味值。", "hint": "对于 $100\\%$ 的数据，满足 $1 \\le n \\le 2 \\times 10^5$，$0 \\le a_i,b_i,x_i < 10^5$，$1 \\le l_i \\le r_i \\le n$（$1 \\le i \\le m$），$1 \\le m \\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P3294", "type": "P", "difficulty": 6, "samples": [["2\na\nba", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2016", "四川", "各省省选", "深度优先搜索 DFS", "字典树 Trie"], "title": "[SCOI2016] 背单词", "background": "", "description": "Lweb 面对如山的英语单词，陷入了深深的沉思：我怎么样才能快点学完，然后去玩三国杀呢？这时候睿智的凤老师从远处飘来，他送给了 Lweb 一本计划册和一大缸泡椒，他的计划册是长这样的：\n\n| 序号    | 单词 |\n| ------- | ---- |\n| $1$     |      |\n| $2$     |      |\n| $\\dots$ |      |\n| $n-1$    |      |\n| $n$     |      |\n\n然后凤老师告诉 Lweb ，我知道你要学习的单词总共有 $n$ 个，现在我们从上往下完成计划表，对于一个序号为 $x$ 的单词（序号 $1,\\dots ,x-1$ 都已经被填入）：\n\n1. 如果存在一个单词是它的后缀，并且当前没有被填入表内，那他需要吃 $n \\times n$ 颗泡椒才能学会；\n2. 当它的所有后缀都被填入表内的情况下，如果在 $1,\\dots,x-1$ 的位置上的单词都不是它的后缀，那么你吃 $x$ 颗泡椒就能记住它；\n3. 当它的所有后缀都被填入表内的情况下，如果 $1,\\dots,x-1$ 的位置上存在是它后缀的单词，所有是它后缀的单词中，序号最大为 $y$，那么你只要吃 $x-y$ 颗泡椒就能把它记住。\n\nLweb 是一个吃到辣辣的东西会暴走的奇怪小朋友，所以请你帮助 Lweb ，寻找一种最优的填写单词方案，使得他记住这 $n$ 个单词的情况下，吃最少的泡椒。\n\n形式化题意：\n\n你需要为 $n$ 个字符串排列一个顺序，每个字符串都会产生一定代价。\n\n对于一个字符串 $s$，其所在位置为 $x$：\n\n1. 如果存在至少一个其他字符串是 $s$ 后缀，且这个字符串的位置在 $s$ 后面， $s$ 将产生 $n \\times n$ 的代价。\n\n2. 如果不存在其他字符串是 $s$ 的后缀，则 $s$ 产生 $x$ 的代价。\n\n3. 如果所有是 $s$ 后缀的字符串的位置都在 $s$ 的前面，若这些字符串的位置的最大值为 $y$ ， 则 $s$ 产生 $x-y$ 的代价。\n\n为 $n$ 个字符串排列一个顺序，使总代价最小。", "inputFormat": "输入一个整数 $n$ ，表示 Lweb 要学习的单词数。\n\n接下来 $n$ 行，每行有一个单词（由小写字母构成，且保证任意单词两两互不相同）。", "outputFormat": "Lweb 吃的最少泡椒数。", "hint": "$1\\le n\\le100000$，所有字符的长度总和 $1\\le \\sum|S| \\le510000$。", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2016] Memorizing Words", "background": "", "description": "Lweb is facing a mountain of English words and falls into deep thought: how can I finish learning quickly and then go play Sanguosha (pinyin)? At this moment, the wise Teacher Feng drifts over from afar. He gives Lweb a planner and a big jar of pickled chili peppers. His planner looks like this:\n\n| Index   | Word |\n| ------- | ---- |\n| $1$     |      |\n| $2$     |      |\n| $\\dots$ |      |\n| $n-1$   |      |\n| $n$     |      |\n\nThen Teacher Feng tells Lweb: I know there are $n$ words you need to learn. We will fill the planner from top to bottom. For the word with index $x$ (the positions $1,\\dots ,x-1$ have already been filled):\n\n1. If there exists a word that is its suffix and has not yet been filled into the table, then he needs to eat $n \\times n$ chili peppers to learn it.\n2. If all of its suffixes have already been filled into the table, and none of the words at positions $1,\\dots ,x-1$ is its suffix, then you can remember it by eating $x$ chili peppers.\n3. If all of its suffixes have already been filled into the table, and among positions $1,\\dots ,x-1$ there exists a word that is its suffix, let the maximum index among its suffixes be $y$. Then you only need to eat $x-y$ chili peppers to remember it.\n\nLweb is a strange kid who goes berserk when he eats spicy things, so please help Lweb find an optimal way to fill the words so that he learns these $n$ words while eating the fewest chili peppers.\n\nFormal statement:\n\nYou need to arrange an order for $n$ strings. Each string incurs a certain cost.\n\nFor a string $s$ at position $x$:\n\n1. If there exists at least one other string that is a suffix of $s$, and that string’s position is after $s$, then $s$ incurs a cost of $n \\times n$.\n2. If no other string is a suffix of $s$, then $s$ incurs a cost of $x$.\n3. If all strings that are suffixes of $s$ appear before $s$, and the maximum position among them is $y$, then $s$ incurs a cost of $x-y$.\n\nArrange an order for the $n$ strings to minimize the total cost.", "inputFormat": "Input an integer $n$, the number of words Lweb needs to learn.\n\nThen follow $n$ lines, each containing one word (lowercase letters only, and all words are pairwise distinct).", "outputFormat": "The minimum number of chili peppers Lweb needs to eat.", "hint": "Constraints: $1\\le n\\le100000$, and the total length of all strings satisfies $1\\le \\sum|S| \\le510000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2016] 背单词", "background": "", "description": "Lweb 面对如山的英语单词，陷入了深深的沉思：我怎么样才能快点学完，然后去玩三国杀呢？这时候睿智的凤老师从远处飘来，他送给了 Lweb 一本计划册和一大缸泡椒，他的计划册是长这样的：\n\n| 序号    | 单词 |\n| ------- | ---- |\n| $1$     |      |\n| $2$     |      |\n| $\\dots$ |      |\n| $n-1$    |      |\n| $n$     |      |\n\n然后凤老师告诉 Lweb ，我知道你要学习的单词总共有 $n$ 个，现在我们从上往下完成计划表，对于一个序号为 $x$ 的单词（序号 $1,\\dots ,x-1$ 都已经被填入）：\n\n1. 如果存在一个单词是它的后缀，并且当前没有被填入表内，那他需要吃 $n \\times n$ 颗泡椒才能学会；\n2. 当它的所有后缀都被填入表内的情况下，如果在 $1,\\dots,x-1$ 的位置上的单词都不是它的后缀，那么你吃 $x$ 颗泡椒就能记住它；\n3. 当它的所有后缀都被填入表内的情况下，如果 $1,\\dots,x-1$ 的位置上存在是它后缀的单词，所有是它后缀的单词中，序号最大为 $y$，那么你只要吃 $x-y$ 颗泡椒就能把它记住。\n\nLweb 是一个吃到辣辣的东西会暴走的奇怪小朋友，所以请你帮助 Lweb ，寻找一种最优的填写单词方案，使得他记住这 $n$ 个单词的情况下，吃最少的泡椒。\n\n形式化题意：\n\n你需要为 $n$ 个字符串排列一个顺序，每个字符串都会产生一定代价。\n\n对于一个字符串 $s$，其所在位置为 $x$：\n\n1. 如果存在至少一个其他字符串是 $s$ 后缀，且这个字符串的位置在 $s$ 后面， $s$ 将产生 $n \\times n$ 的代价。\n\n2. 如果不存在其他字符串是 $s$ 的后缀，则 $s$ 产生 $x$ 的代价。\n\n3. 如果所有是 $s$ 后缀的字符串的位置都在 $s$ 的前面，若这些字符串的位置的最大值为 $y$ ， 则 $s$ 产生 $x-y$ 的代价。\n\n为 $n$ 个字符串排列一个顺序，使总代价最小。", "inputFormat": "输入一个整数 $n$ ，表示 Lweb 要学习的单词数。\n\n接下来 $n$ 行，每行有一个单词（由小写字母构成，且保证任意单词两两互不相同）。", "outputFormat": "Lweb 吃的最少泡椒数。", "hint": "$1\\le n\\le100000$，所有字符的长度总和 $1\\le \\sum|S| \\le510000$。", "locale": "zh-CN"}}}
{"pid": "P3295", "type": "P", "difficulty": 6, "samples": [["4 2\n1 2 3 4\n3 3 3 3", "90"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2016", "四川", "并查集", "各省省选", "枚举", "ST 表"], "title": "[SCOI2016] 萌萌哒", "background": "", "description": "一个长度为 $n$ 的大数，用 $S_1S_2S_3 \\cdots S_n$表示，其中 $S_i$ 表示数的第 $i$ 位, $S_1$ 是数的最高位。告诉你一些限制条件，每个条件表示为四个数，$l_1,r_1,l_2,r_2$，即两个长度相同的区间，表示子串 $S_{l_1}S_{l_1+1}S_{l_1+2} \\cdots S_{r_1}$ 与 $S_{l_2}S_{l_2+1}S_{l_2+2} \\cdots S_{r_2}$ 完全相同。\n\n比如 $n=6$ 时，某限制条件 $l_1=1,r_1=3,l_2=4,r_2=6$ ，那么 $123123$，$351351$ 均满足条件，但是 $12012$，$131141$ 不满足条件，前者数的长度不为 $6$ ，后者第二位与第五位不同。问满足以上所有条件的数有多少个。", "inputFormat": "第一行两个数 $n$ 和 $m$，分别表示大数的长度，以及限制条件的个数。\n\n接下来 $m$ 行，对于第 $i$ 行,有 $4$ 个数 $l_{i_1},r_{i_1},{l_{i_2}},r_{i_2}$，分别表示该限制条件对应的两个区间。\n\n$1\\le n\\le 10^5$，$1\\le m\\le 10^5$，$1\\le l_{i_1},r_{i_1},{l_{i_2}},r_{i_2}\\le n$ ；并且保证 $ r_{i_1}-l_{i_1}=r_{i_2}-l_{i_2}$ 。\n", "outputFormat": "一个数，表示满足所有条件且长度为 $n$ 的大数的个数，答案可能很大，因此输出答案模 $ 10^9+7 $ 的结果即可。\n", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2016] Mengmengda", "background": "", "description": "An $n$-digit number is denoted by $S_1 S_2 S_3 \\cdots S_n$, where $S_i$ is the $i$-th digit and $S_1$ is the most significant digit. You are given several constraints. Each constraint is given by four integers $l_1, r_1, l_2, r_2$, meaning two intervals of the same length, and it requires the substrings $S_{l_1} S_{l_1+1} S_{l_1+2} \\cdots S_{r_1}$ and $S_{l_2} S_{l_2+1} S_{l_2+2} \\cdots S_{r_2}$ to be exactly the same.\n\nFor example, when $n=6$ and there is a constraint $l_1=1, r_1=3, l_2=4, r_2=6$, then 123123 and 351351 both satisfy the condition, but 12012 and 131141 do not. The former is not of length $6$, and in the latter the second and fifth digits differ. Find how many numbers satisfy all the given conditions.", "inputFormat": "The first line contains two integers $n$ and $m$, representing the length of the number and the number of constraints.\n\nEach of the next $m$ lines contains four integers $l_{i_1}, r_{i_1}, {l_{i_2}}, r_{i_2}$ on the $i$-th line, representing the two intervals for that constraint.\n\n$1 \\le n \\le 10^5$, $1 \\le m \\le 10^5$, $1 \\le l_{i_1}, r_{i_1}, {l_{i_2}}, r_{i_2} \\le n$, and it is guaranteed that $r_{i_1} - l_{i_1} = r_{i_2} - l_{i_2}$.", "outputFormat": "Output a single integer, the number of $n$-digit numbers that satisfy all the constraints. Since the answer can be large, output it modulo $10^9+7$.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2016] 萌萌哒", "background": "", "description": "一个长度为 $n$ 的大数，用 $S_1S_2S_3 \\cdots S_n$表示，其中 $S_i$ 表示数的第 $i$ 位, $S_1$ 是数的最高位。告诉你一些限制条件，每个条件表示为四个数，$l_1,r_1,l_2,r_2$，即两个长度相同的区间，表示子串 $S_{l_1}S_{l_1+1}S_{l_1+2} \\cdots S_{r_1}$ 与 $S_{l_2}S_{l_2+1}S_{l_2+2} \\cdots S_{r_2}$ 完全相同。\n\n比如 $n=6$ 时，某限制条件 $l_1=1,r_1=3,l_2=4,r_2=6$ ，那么 $123123$，$351351$ 均满足条件，但是 $12012$，$131141$ 不满足条件，前者数的长度不为 $6$ ，后者第二位与第五位不同。问满足以上所有条件的数有多少个。", "inputFormat": "第一行两个数 $n$ 和 $m$，分别表示大数的长度，以及限制条件的个数。\n\n接下来 $m$ 行，对于第 $i$ 行,有 $4$ 个数 $l_{i_1},r_{i_1},{l_{i_2}},r_{i_2}$，分别表示该限制条件对应的两个区间。\n\n$1\\le n\\le 10^5$，$1\\le m\\le 10^5$，$1\\le l_{i_1},r_{i_1},{l_{i_2}},r_{i_2}\\le n$ ；并且保证 $ r_{i_1}-l_{i_1}=r_{i_2}-l_{i_2}$ 。\n", "outputFormat": "一个数，表示满足所有条件且长度为 $n$ 的大数的个数，答案可能很大，因此输出答案模 $ 10^9+7 $ 的结果即可。\n", "hint": "", "locale": "zh-CN"}}}
{"pid": "P3296", "type": "P", "difficulty": 6, "samples": [["4\n1 2\n2 3\n3 4\n0 0 1 1\n1 0 0 0", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2013", "各省省选", "山东", "费用流", "哈希 hashing"], "title": "[SDOI2013] 刺客信条", "background": "", "description": "故事发生在1486 年的意大利，Ezio 原本只是一个文艺复兴时期的贵族，后来因为家族成员受到圣殿骑士的杀害，决心成为一名刺客。最终，凭借着他的努力和出众的天赋，成为了杰出的刺客大师，他不仅是个身手敏捷的武林高手，飞檐走壁擅长各种暗杀术。刺客组织在他的带领下，为被剥削的平民声张正义，赶跑了原本统治意大利的圣殿骑士首领-教皇亚历山大六世。在他的一生中，经历了无数次惊心动魄、扣人心弦的探险和刺杀。\n\n\n曾经有一次，为了寻找Altair 留下的线索和装备，Ezio 在佛罗伦萨中的刺客墓穴进行探索。这个刺客墓穴中有许多密室，且任何两个密室之间只存在一条唯一的路径。这些密室里都有一个刺客标记，他可以启动或者关闭该刺客标记。为了打开储存着线索和装备的储藏室，Ezio 必须操作刺客标记来揭开古老的封印。要想解开这个封印，他需要通过改变某些刺客标记的启动情况，使得所有刺客标记与封印密码“看起来一样”。\n\n\n在这里，“看起来一样”的定义是：存在一种“标记”密室与“密码”密室之间一一对应的关系，使得密室间的连接情况和启动情况相同（提示中有更详细解释）。幸运的是，在Ezio 来到刺客墓穴之前，在Da Vinci 的帮助下，Ezio 已经得知了打开储藏室所需要的密码。\n\n\n而你的任务则是帮助Ezio 找出达成目标所需要最少的改动标记次数。\n", "inputFormat": "第一行给出一个整数n, 表示密室的个数,\n\n\n第二行至第 n 行, 每行绐出两个整数 a 和 b, 表示第 a 个密室和第 b 个密室之间存在一条通道.\n\n\n第 n+1行1 绐出 n 个整数1 分别表示当时每个密室的启动情况 {0表示关闭, 1表示启动).\n\n\n第 n+2 行7 给出 n 个整数, 分别表示密码中每个密室的启动情况.\n", "outputFormat": "输出只有一行，即输出最少改动标记次数\n", "hint": "密室的编号是可以变的！将第三个密室关闭后，在当前标记和密码之间，存在1->4,2->3,3->2,4->1 的对应关系，重新编号后连接情况没有改变，且标记与密码对应。对于更一般的情况，存在一个1 到n 的置换P，使得对于任意密室之间的道路u-v，都一定有密码密室中的道路P(u)-P(v)；如果不存在密室之间的道路u-v，则一定没有密码密室中的道路P(u)-P(v)。\n\n\n对于100%的数据，n<=700，且每个密室至多与11个密室相通\n", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2013] Assassin's Creed", "background": "", "description": "The story takes place in Italy in the year 1486. Ezio was originally a nobleman of the Renaissance. Later, after members of his family were killed by the Templars, he decided to become an assassin. In the end, with his effort and outstanding talent, he became an excellent Master Assassin. He was not only agile and skilled in martial arts, but also good at all kinds of assassination techniques such as parkour across rooftops. Under his leadership, the assassin brotherhood stood up for the oppressed common people and drove away the original ruler of Italy—the leader of the Templars, Pope Alexander VI. In his lifetime, he experienced countless thrilling adventures and assassinations.\n\nOnce, in order to find the clues and equipment left by Altair, Ezio explored an assassin tomb in Florence. This tomb has many secret rooms, and between any two rooms there is exactly one unique path. Each room has an assassin mark that he can turn on or off. To open the vault storing the clues and equipment, Ezio must operate the marks to lift an ancient seal. To break this seal, he needs to change the on/off state of some marks so that all marks “look the same” as the password.\n\nHere, “look the same” means: there exists a one-to-one correspondence between the rooms in the “mark” configuration and the rooms in the “password” configuration such that both the connections between rooms and the on/off states match (there is a more detailed explanation in the Hint). Fortunately, before Ezio arrived at the tomb, with the help of Da Vinci, he had already learned the required password to open the vault.\n\nYour task is to help Ezio find the minimum number of mark changes required to achieve the goal.", "inputFormat": "- Line 1: An integer n, the number of rooms.\n- Lines 2 to n: Each line contains two integers a and b, indicating there is a passage between room a and room b.\n- Line n+1: n integers, giving the current on/off state of each room (0 means off, 1 means on).\n- Line n+2: n integers, giving the on/off state of each room in the password.", "outputFormat": "Output a single line: the minimum number of mark changes.", "hint": "The room numbering can be changed. After turning off the third room in the current configuration, there exists a correspondence between the current marks and the password: 1 -> 4, 2 -> 3, 3 -> 2, 4 -> 1. After renumbering, the connections do not change, and the marks match the password.\n\nIn the general case, there exists a permutation P of 1 to n such that for any road u - v between rooms in the current configuration, there is a road P(u) - P(v) in the password configuration; and if there is no road u - v in the current configuration, then there is no road P(u) - P(v) in the password configuration.\n\nConstraints: For 100% of the testdata, $n \\le 700$, and each room is adjacent to at most $11$ rooms.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2013] 刺客信条", "background": "", "description": "故事发生在1486 年的意大利，Ezio 原本只是一个文艺复兴时期的贵族，后来因为家族成员受到圣殿骑士的杀害，决心成为一名刺客。最终，凭借着他的努力和出众的天赋，成为了杰出的刺客大师，他不仅是个身手敏捷的武林高手，飞檐走壁擅长各种暗杀术。刺客组织在他的带领下，为被剥削的平民声张正义，赶跑了原本统治意大利的圣殿骑士首领-教皇亚历山大六世。在他的一生中，经历了无数次惊心动魄、扣人心弦的探险和刺杀。\n\n\n曾经有一次，为了寻找Altair 留下的线索和装备，Ezio 在佛罗伦萨中的刺客墓穴进行探索。这个刺客墓穴中有许多密室，且任何两个密室之间只存在一条唯一的路径。这些密室里都有一个刺客标记，他可以启动或者关闭该刺客标记。为了打开储存着线索和装备的储藏室，Ezio 必须操作刺客标记来揭开古老的封印。要想解开这个封印，他需要通过改变某些刺客标记的启动情况，使得所有刺客标记与封印密码“看起来一样”。\n\n\n在这里，“看起来一样”的定义是：存在一种“标记”密室与“密码”密室之间一一对应的关系，使得密室间的连接情况和启动情况相同（提示中有更详细解释）。幸运的是，在Ezio 来到刺客墓穴之前，在Da Vinci 的帮助下，Ezio 已经得知了打开储藏室所需要的密码。\n\n\n而你的任务则是帮助Ezio 找出达成目标所需要最少的改动标记次数。\n", "inputFormat": "第一行给出一个整数n, 表示密室的个数,\n\n\n第二行至第 n 行, 每行绐出两个整数 a 和 b, 表示第 a 个密室和第 b 个密室之间存在一条通道.\n\n\n第 n+1行1 绐出 n 个整数1 分别表示当时每个密室的启动情况 {0表示关闭, 1表示启动).\n\n\n第 n+2 行7 给出 n 个整数, 分别表示密码中每个密室的启动情况.\n", "outputFormat": "输出只有一行，即输出最少改动标记次数\n", "hint": "密室的编号是可以变的！将第三个密室关闭后，在当前标记和密码之间，存在1->4,2->3,3->2,4->1 的对应关系，重新编号后连接情况没有改变，且标记与密码对应。对于更一般的情况，存在一个1 到n 的置换P，使得对于任意密室之间的道路u-v，都一定有密码密室中的道路P(u)-P(v)；如果不存在密室之间的道路u-v，则一定没有密码密室中的道路P(u)-P(v)。\n\n\n对于100%的数据，n<=700，且每个密室至多与11个密室相通\n", "locale": "zh-CN"}}}
{"pid": "P3297", "type": "P", "difficulty": 7, "samples": [["2\n4\n10 10 5 5\n5 6\n3 5\n7 5\n5 3\n17\n14 12 7 6\n7 11\n6 9\n7 7\n1 10\n2 20\n1 6\n2 6\n1 1\n2 2\n5 1\n5 2\n13 1\n12 2\n12 7\n13 7\n12 11\n13 11", "1\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["计算几何", "2013", "各省省选", "山东", "半平面交"], "title": "[SDOI2013] 逃考", "background": "", "description": "髙考又来了，对于不认真读书的来讲真不是个好消息为了小杨能在家里认真读书，他的亲戚决定驻扎在他的家里监督他学习，有爷爷奶奶、外公外婆、大舅、大嫂、阿姨 ......。\n\n小杨实在是忍无可忍了，这种生活跟监狱有什么区别！为了他亲爱的小红，为了他的 dota， 他决定越狱！\n\n假设小杨的家是个 $n\\times m$ 的矩阵，左下角坐标为（$0,0)$，右上角坐标为（$x_1,y_1)$。小杨有 $n$ 个亲戚，驻扎在矩阵里（位置不同，且不在矩阵的边上）。小杨家里的每个地方都被亲戚监控着，而且只被距离最近的亲戚监控：\n\n也就是说假设小杨所在的位置是（$3,3)$, 亲戚 $A$ 在（$3,0)$，A 距离小杨距离是 $3$；亲戚 $B$ 在（$6,7),$ 则 $B$ 距离小杨距离是 $5$。距离 $A<$ 距离 $B$，所以（$3,3)$ 位置由 $A$ 监控。\n\n如果“最近距离”出现同时有几个亲戚，那么那个位置同时被那几个亲戚监控。\n\n给出小杨的坐标（$x_0,y_0)$。因为被发现的人数越少，越狱成功的机会越大，所以小杨需要你设计一条越狱路线到达矩形的边上，且被发现的人数最少。\n\n小杨做的方向是任意的，也就是说路线上的任意位置 $H$ 需要是实数。\n\n保证一开始小杨只被一个亲戚监控着。", "inputFormat": "第一行一个正整数 $t \\le 3$ 表示数据个数。\n\n接下来 $t$ 个数据：\n\n第一行 $n$ 表示亲戚个数。\n\n第二行 $4$ 个正整数表示举行右上角坐标 $(x_1,y_1)$ 和小杨的坐标 $(x_0,y_0)$。\n\n接下来 $n$ 行，每行 $2$ 个正整数表示一个亲戚的位置。", "outputFormat": "每个数据一个正整数表示越狱被发现人数的最小值\n", "hint": "数据解释 :。\n\n第一个数据，小杨直接往上走，只被 $(5,6)$ 监控过。\n\n第二个数据，小杨被 $(7,7)$ 监控 - 走到 $(9,9)$ 被 $(7,11)$ 监控，然后直接往上走。\n\n数据规模 :\n\n前 $50\\%$ 数据, $n \\le 200$。\n\n其余数据 $n \\le 600$。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2013] Escape the Exam", "background": "", "description": "The Gaokao is coming again. For those who don’t study hard, this is really bad news. To make Xiao Yang study at home, his relatives decide to stay at his house and watch him: grandpa and grandma, maternal grandparents, uncle, sister-in-law, aunt, and so on.\n\nXiao Yang can’t stand it anymore. What’s the difference between this life and prison? For his beloved Xiao Hong and for his Dota, he decides to break out!\n\nAssume Xiao Yang’s house is a rectangle with lower-left corner at $ (0,0) $ and upper-right corner at $ (x_1,y_1) $. There are $ n $ relatives staying inside the rectangle (at distinct positions, and none of them lies on the boundary). Every location in the house is watched by the nearest relative(s):\n\nThat is, suppose Xiao Yang is at $ (3,3) $, relative $ A $ is at $ (3,0) $, then the distance from $ A $ to Xiao Yang is $ 3 $; relative $ B $ is at $ (6,7) $, then the distance from $ B $ to Xiao Yang is $ 5 $. Since $ \\text{dist}(A) < \\text{dist}(B) $, the position $ (3,3) $ is watched by $ A $.\n\nIf there are multiple relatives tying for the nearest distance, then that position is watched by all of them simultaneously.\n\nGiven Xiao Yang’s starting position $ (x_0,y_0) $. Since the fewer people who discover him, the greater the chance of a successful escape, your task is to design a route from his starting position to the boundary of the rectangle so that the number of people who discover him is minimized.\n\nXiao Yang may move in any direction; the route can be any continuous path, and all positions along the path may have real coordinates.\n\nIt is guaranteed that at the starting position, Xiao Yang is watched by exactly one relative.", "inputFormat": "- The first line contains a positive integer $ t \\le 3 $, the number of testdata.\n- For each of the $ t $ testdata:\n  - The first line contains an integer $ n $, the number of relatives.\n  - The second line contains four positive integers giving the rectangle’s upper-right corner $ (x_1,y_1) $ and Xiao Yang’s starting position $ (x_0,y_0) $.\n  - Each of the next $ n $ lines contains two positive integers, the position of one relative.", "outputFormat": "For each testdata, output a single positive integer: the minimum possible number of relatives who will discover Xiao Yang during his escape.", "hint": "Explanation:\n\n- In the first dataset, Xiao Yang goes straight up and is only watched by $ (5,6) $.\n- In the second dataset, Xiao Yang is watched by $ (7,7) $, goes to $ (9,9) $ where he is watched by $ (7,11) $, and then goes straight up.\n\nConstraints:\n\n- For the first $ 50\\% $ of the testdata, $ n \\le 200 $.\n- For the remaining testdata, $ n \\le 600 $.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2013] 逃考", "background": "", "description": "髙考又来了，对于不认真读书的来讲真不是个好消息为了小杨能在家里认真读书，他的亲戚决定驻扎在他的家里监督他学习，有爷爷奶奶、外公外婆、大舅、大嫂、阿姨 ......。\n\n小杨实在是忍无可忍了，这种生活跟监狱有什么区别！为了他亲爱的小红，为了他的 dota， 他决定越狱！\n\n假设小杨的家是个 $n\\times m$ 的矩阵，左下角坐标为（$0,0)$，右上角坐标为（$x_1,y_1)$。小杨有 $n$ 个亲戚，驻扎在矩阵里（位置不同，且不在矩阵的边上）。小杨家里的每个地方都被亲戚监控着，而且只被距离最近的亲戚监控：\n\n也就是说假设小杨所在的位置是（$3,3)$, 亲戚 $A$ 在（$3,0)$，A 距离小杨距离是 $3$；亲戚 $B$ 在（$6,7),$ 则 $B$ 距离小杨距离是 $5$。距离 $A<$ 距离 $B$，所以（$3,3)$ 位置由 $A$ 监控。\n\n如果“最近距离”出现同时有几个亲戚，那么那个位置同时被那几个亲戚监控。\n\n给出小杨的坐标（$x_0,y_0)$。因为被发现的人数越少，越狱成功的机会越大，所以小杨需要你设计一条越狱路线到达矩形的边上，且被发现的人数最少。\n\n小杨做的方向是任意的，也就是说路线上的任意位置 $H$ 需要是实数。\n\n保证一开始小杨只被一个亲戚监控着。", "inputFormat": "第一行一个正整数 $t \\le 3$ 表示数据个数。\n\n接下来 $t$ 个数据：\n\n第一行 $n$ 表示亲戚个数。\n\n第二行 $4$ 个正整数表示举行右上角坐标 $(x_1,y_1)$ 和小杨的坐标 $(x_0,y_0)$。\n\n接下来 $n$ 行，每行 $2$ 个正整数表示一个亲戚的位置。", "outputFormat": "每个数据一个正整数表示越狱被发现人数的最小值\n", "hint": "数据解释 :。\n\n第一个数据，小杨直接往上走，只被 $(5,6)$ 监控过。\n\n第二个数据，小杨被 $(7,7)$ 监控 - 走到 $(9,9)$ 被 $(7,11)$ 监控，然后直接往上走。\n\n数据规模 :\n\n前 $50\\%$ 数据, $n \\le 200$。\n\n其余数据 $n \\le 600$。", "locale": "zh-CN"}}}
{"pid": "P3298", "type": "P", "difficulty": 6, "samples": [["3 3\n1 2 3 4 5 6\n1 2 3 0 0 0\n0 0 0 4 5 6", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "各省省选", "山东", "哈希 hashing", "容斥原理"], "title": "[SDOI2013] 泉", "background": null, "description": "作为光荣的济南泉历史研究小组中的一员，铭铭收集了历史上 $N$ 个不同年份时不同泉区的水流指数，这个指数是一个小于 $2^{30}$ 的非负整数。第 $i$ 个年份时六个泉区的泉水流量指数分别为 $A_{i,1} \\sim A_{i,6}$。\n\n现在铭铭希望知道有多少对不同的年份 $i$ 和 $j$（$i<j$），满足这两年恰好有 $K$ 个泉区的泉水水流指数对应相同。", "inputFormat": "第一行两个整数 $N,K$。\n\n下面 $N$ 行，每行 $6$ 个整数 $A_{i,1} \\sim A_{i,6}$。", "outputFormat": "一行一个整数表示答案。", "hint": "$1 \\le N \\le 10^5$，$0 \\le A_{i,j} \\le 2^{30}$，且保证 $K$ 在 $[0,1,2,3,4,5,6]$ 中均匀随机选取。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2013] Springs", "background": "", "description": "As a proud member of the Jinan Springs History Research Group, Mingming has collected, for $N$ different years, the flow index of different spring zones. This index is a non-negative integer less than $2^{30}$. In year $i$, the flow indices of the six spring zones are $A_{i,1} \\sim A_{i,6}$.\n\nNow Mingming wants to know how many pairs of different years $i$ and $j$ ($i < j$) have exactly $K$ spring zones whose flow indices are equal in those two years.", "inputFormat": "The first line contains two integers $N, K$.\n\nThe next $N$ lines each contain $6$ integers $A_{i,1} \\sim A_{i,6}$.", "outputFormat": "Output a single integer on one line, representing the answer.", "hint": "Constraints: $1 \\le N \\le 10^5$，$0 \\le A_{i,j} \\le 2^{30}$，且保证 $K$ 在 $[0,1,2,3,4,5,6]$ 中均匀随机选取。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2013] 泉", "background": null, "description": "作为光荣的济南泉历史研究小组中的一员，铭铭收集了历史上 $N$ 个不同年份时不同泉区的水流指数，这个指数是一个小于 $2^{30}$ 的非负整数。第 $i$ 个年份时六个泉区的泉水流量指数分别为 $A_{i,1} \\sim A_{i,6}$。\n\n现在铭铭希望知道有多少对不同的年份 $i$ 和 $j$（$i<j$），满足这两年恰好有 $K$ 个泉区的泉水水流指数对应相同。", "inputFormat": "第一行两个整数 $N,K$。\n\n下面 $N$ 行，每行 $6$ 个整数 $A_{i,1} \\sim A_{i,6}$。", "outputFormat": "一行一个整数表示答案。", "hint": "$1 \\le N \\le 10^5$，$0 \\le A_{i,j} \\le 2^{30}$，且保证 $K$ 在 $[0,1,2,3,4,5,6]$ 中均匀随机选取。", "locale": "zh-CN"}}}
{"pid": "P3299", "type": "P", "difficulty": 6, "samples": [["5  2\n3  3\n1  1\n10 8\n4  8\n2  3", "7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "各省省选", "山东", "凸包"], "title": "[SDOI2013] 保护出题人", "background": null, "description": "出题人铭铭认为给 SDOI2012 出题太可怕了，因为总要被骂，于是他又给 SDOI2013 出题了。\n\n\n参加 SDOI2012 的小朋友们释放出大量的僵尸，企图攻击铭铭的家。而你作为 SDOI2013 的参赛者，你需要保护出题人铭铭。\n\n\n僵尸从唯一一条笔直道路接近，你们需要在铭铭的房门前放置植物攻击僵尸，避免僵尸碰到房子。\n\n\n第一关，一只血量为 $a_1$ 点的僵尸从距离房子 $x_1$ 米处匀速接近，你们放置了攻击力为 $y_1$ 点/秒的植物进行防御；第二关，在上一关基础上，僵尸队列排头增加一只血量为 $a_2$ 点的僵尸，与后一只僵尸距离 $d$ 米，从距离房 $x_2$ 米处匀速接近，你们重新放置攻击力为 $y_2$ 点/秒的植物；……；第 $n$ 关，僵尸队列共有 $n$ 只僵尸，相邻两只僵尸距离 $d$ 米，排头僵尸血量为 $a_n$ 点，排第二的僵尸血量 $a_{n-1}$，以此类推，排头僵尸从距离房子 $x_n$ 米处匀速接近，其余僵尸跟随排头同时接近，你们重新放置攻击力为 $y_n$ 点/秒的植物。\n\n\n每只僵尸直线移动速度均为 $1$ 米/秒，由于植物射击速度远大于僵尸移动速度，可忽略植物子弹在空中的时间。所有僵尸同时出现并接近，因此当一只僵尸死亡后，下一只僵尸立刻开始受到植物子弹的伤害。\n\n\n游戏得分取决于你们放置的植物攻击力的总和 $\\sum \\limits _{i=1} ^{n} y_i$，和越小分数越高，为了追求分数上界，你们每关都要放置攻击力尽量小的植物。\n\n\n作为 SDOI2013 的参赛选手，你们能保护出题人么？", "inputFormat": "第一行两个空格隔开的正整数 $n$ 和 $d$，分别表示关数和相邻僵尸间的距离。\n\n接下来n行每行两个空格隔开的正整数，第 $i+1$ 行为 $A_i$ 和 $X_i$，分别表示相比上一关在僵尸队列排头增加血量为 $A_i$ 点的僵尸，排头僵尸从距离房子 $X_i$ 米处开始接近。", "outputFormat": "一个整数，$n$ 关植物攻击力的最小总和，四舍五入到个位。", "hint": "第一关：距离房子 $3$ 米处有一只血量 $3$ 点的僵尸，植物最小攻击力为 $1.00000$；  \n第二关：距离房子 $1$ 米处有一只血量 $1$ 点的僵尸、$3$ 米处有血量 $3$ 点的僵尸，植物最小攻击力为 $1.33333$；  \n第三关：距离房子 $8$ 米处有一只血量 $10$ 点的僵尸、$10$ 米处有血量 $1$ 点的僵尸、$12$ 米处有血量 $3$ 点的僵尸，植物最小攻击力为 $1.25000$；  \n第四关：距离房子 $8$ 米处有一只血量 $4$ 点的僵尸、$10$ 米处有血量 $10$ 点的僵尸、$12$ 米处有血量 $1$ 点的僵尸、$14$ 米处有血量 $3$ 点的僵尸，植物最小攻击力为 $1.40000$；  \n第五关：距离房子 $3$ 米处有一只血量 $2$ 点的僵尸、 $5$ 米处有血量 $4$ 点的僵尸、$7$ 米处有血量 $10$ 点的僵尸、$9$ 米处有血量 $1$ 点的僵尸、$11$ 米处有血量 $3$ 点的僵尸，植物最小攻击力为 $2.28571$。  \n植物攻击力的最小总和为 $7.26905$。\n\n对于 $100\\%$ 的数据， $ 1\\le n \\le 10^5  ,1 \\le d,x,a \\le 10^{12} $ 。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2013] Protect the Problem Setter", "background": "", "description": "The problem setter Mingming felt that making problems for SDOI2012 was too scary because he would always be blamed, so he made problems again for SDOI2013.\n\nThe kids who participated in SDOI2012 released many zombies, trying to attack Mingming’s home. As a contestant of SDOI2013, you need to protect the problem setter Mingming.\n\nZombies approach along a single straight road. You need to place plants in front of Mingming’s door to attack the zombies, preventing them from reaching the house.\n\nLevel 1: a single zombie with HP $a_1$ starts uniformly approaching from $x_1$ meters away, and you place a plant with attack power $y_1$ points/second to defend. Level 2: based on the previous level, add a new zombie with HP $a_2$ to the front of the queue, at distance $d$ from the next zombie, and the front zombie starts uniformly approaching from $x_2$ meters away; you re-place a plant with attack power $y_2$ points/second. ... Level $n$: there are $n$ zombies in total, adjacent zombies are $d$ meters apart, the front zombie has HP $a_n$, the second has HP $a_{n-1}$, and so on. The front zombie starts uniformly approaching from $x_n$ meters away, and the other zombies follow while approaching at the same time. You re-place a plant with attack power $y_n$ points/second.\n\nEach zombie moves in a straight line at speed $1$ m/s. Since the plants’ firing speed is much higher than the zombies’ movement speed, the bullet travel time in the air can be ignored. All zombies appear and start approaching at the same time. Therefore, when one zombie dies, the next zombie immediately starts taking damage from the plant.\n\nThe game score depends on the total attack power you place, $\\sum \\limits _{i=1} ^{n} y_i$. The smaller the sum, the higher the score. To pursue the best possible score, you should place plants with the smallest possible attack power at every level.\n\nAs a contestant of SDOI2013, can you protect the problem setter?", "inputFormat": "The first line contains two space-separated positive integers $n$ and $d$, representing the number of levels and the distance between adjacent zombies.\n\nThe next $n$ lines each contain two space-separated positive integers. The $(i+1)$-th line contains $A_i$ and $X_i$, meaning that compared to the previous level, a new zombie with HP $A_i$ is added to the front of the queue, and the front zombie starts approaching from a distance of $X_i$ meters from the house.", "outputFormat": "Output an integer: the minimal total attack power over the $n$ levels, rounded to the nearest integer.", "hint": "Level 1: there is one zombie with HP $3$ at distance $3$ meters from the house, and the minimal plant attack power is $1.00000$.  \nLevel 2: there is one zombie with HP $1$ at $1$ meter and one zombie with HP $3$ at $3$ meters, and the minimal plant attack power is $1.33333$.  \nLevel 3: there is one zombie with HP $10$ at $8$ meters, one with HP $1$ at $10$ meters, and one with HP $3$ at $12$ meters, and the minimal plant attack power is $1.25000$.  \nLevel 4: there is one zombie with HP $4$ at $8$ meters, one with HP $10$ at $10$ meters, one with HP $1$ at $12$ meters, and one with HP $3$ at $14$ meters, and the minimal plant attack power is $1.40000$.  \nLevel 5: there is one zombie with HP $2$ at $3$ meters, one with HP $4$ at $5$ meters, one with HP $10$ at $7$ meters, one with HP $1$ at $9$ meters, and one with HP $3$ at $11$ meters, and the minimal plant attack power is $2.28571$.  \nThe minimal total plant attack power is $7.26905$.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 10^5$, $1 \\le d, x, a \\le 10^{12}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2013] 保护出题人", "background": null, "description": "出题人铭铭认为给 SDOI2012 出题太可怕了，因为总要被骂，于是他又给 SDOI2013 出题了。\n\n\n参加 SDOI2012 的小朋友们释放出大量的僵尸，企图攻击铭铭的家。而你作为 SDOI2013 的参赛者，你需要保护出题人铭铭。\n\n\n僵尸从唯一一条笔直道路接近，你们需要在铭铭的房门前放置植物攻击僵尸，避免僵尸碰到房子。\n\n\n第一关，一只血量为 $a_1$ 点的僵尸从距离房子 $x_1$ 米处匀速接近，你们放置了攻击力为 $y_1$ 点/秒的植物进行防御；第二关，在上一关基础上，僵尸队列排头增加一只血量为 $a_2$ 点的僵尸，与后一只僵尸距离 $d$ 米，从距离房 $x_2$ 米处匀速接近，你们重新放置攻击力为 $y_2$ 点/秒的植物；……；第 $n$ 关，僵尸队列共有 $n$ 只僵尸，相邻两只僵尸距离 $d$ 米，排头僵尸血量为 $a_n$ 点，排第二的僵尸血量 $a_{n-1}$，以此类推，排头僵尸从距离房子 $x_n$ 米处匀速接近，其余僵尸跟随排头同时接近，你们重新放置攻击力为 $y_n$ 点/秒的植物。\n\n\n每只僵尸直线移动速度均为 $1$ 米/秒，由于植物射击速度远大于僵尸移动速度，可忽略植物子弹在空中的时间。所有僵尸同时出现并接近，因此当一只僵尸死亡后，下一只僵尸立刻开始受到植物子弹的伤害。\n\n\n游戏得分取决于你们放置的植物攻击力的总和 $\\sum \\limits _{i=1} ^{n} y_i$，和越小分数越高，为了追求分数上界，你们每关都要放置攻击力尽量小的植物。\n\n\n作为 SDOI2013 的参赛选手，你们能保护出题人么？", "inputFormat": "第一行两个空格隔开的正整数 $n$ 和 $d$，分别表示关数和相邻僵尸间的距离。\n\n接下来n行每行两个空格隔开的正整数，第 $i+1$ 行为 $A_i$ 和 $X_i$，分别表示相比上一关在僵尸队列排头增加血量为 $A_i$ 点的僵尸，排头僵尸从距离房子 $X_i$ 米处开始接近。", "outputFormat": "一个整数，$n$ 关植物攻击力的最小总和，四舍五入到个位。", "hint": "第一关：距离房子 $3$ 米处有一只血量 $3$ 点的僵尸，植物最小攻击力为 $1.00000$；  \n第二关：距离房子 $1$ 米处有一只血量 $1$ 点的僵尸、$3$ 米处有血量 $3$ 点的僵尸，植物最小攻击力为 $1.33333$；  \n第三关：距离房子 $8$ 米处有一只血量 $10$ 点的僵尸、$10$ 米处有血量 $1$ 点的僵尸、$12$ 米处有血量 $3$ 点的僵尸，植物最小攻击力为 $1.25000$；  \n第四关：距离房子 $8$ 米处有一只血量 $4$ 点的僵尸、$10$ 米处有血量 $10$ 点的僵尸、$12$ 米处有血量 $1$ 点的僵尸、$14$ 米处有血量 $3$ 点的僵尸，植物最小攻击力为 $1.40000$；  \n第五关：距离房子 $3$ 米处有一只血量 $2$ 点的僵尸、 $5$ 米处有血量 $4$ 点的僵尸、$7$ 米处有血量 $10$ 点的僵尸、$9$ 米处有血量 $1$ 点的僵尸、$11$ 米处有血量 $3$ 点的僵尸，植物最小攻击力为 $2.28571$。  \n植物攻击力的最小总和为 $7.26905$。\n\n对于 $100\\%$ 的数据， $ 1\\le n \\le 10^5  ,1 \\le d,x,a \\le 10^{12} $ 。", "locale": "zh-CN"}}}
{"pid": "P3300", "type": "P", "difficulty": 7, "samples": [["4  4\n.O..\nO+O|\n.O.. \n..OO\n4\nQ 1 4\nC 2 4 + \nC 3 4 | \nQ 1 4", "2 \n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "线段树", "并查集", "各省省选", "山东"], "title": "[SDOI2013] 城市规划", "background": "", "description": "A 市的市长打算在海边开发一段地带。这个地带看成是一个 $N \\times M $ 的方格阵。每个格子可以是建筑、道路或者草地。这片地带是要出租给某些公司，但是这些公司的要求很奇怪。他们要求租给他们的建筑要通过道路形成一个连通块。同一个连通块只能租给一家公司。这个 $N\\times M$ 的方格阵是用字符组成的：`O`，`.`，`+`，`|`，`-`，其中 `O` 表示建筑，'.' 表示草地。`|`，`-`，`+` 表示道路，分别表示把上下，左右、上下左右的格子连起来。相邻的 `O` 表示这是一个建筑物。\n\n由于规划可能不太好，可能某些连通块里面只有道路，这里道路是不能出租的！由于最后这块地的选取可能有部分会与其他市共冋开发，所以最后会在这个 $N\\times M$ 中选取一段出来，最后选取出来的是一个 $N_i\\times M$（$0<N_1\\le N$）的地段。A 市的市长想弄要一个规划软件，支持以下功能：\n\n1. 改变一个格子。\n2. 询问某块地带有多少个带建筑的连通块。", "inputFormat": "第一行两个整数 $N, M$，如题意所示\n\n接下来的 $N$ 行，每行 $M$ 个字符表示这片地带的初始情况。  \n\n接下来的一行一个整数 $Q$，表示操作次数。接下来的 $Q$ 行，每行有两种格式：  \n- `C i j k` :  把第 $i$ 行第 $j$ 个格子修改成k；\n- `Q l r`:  询问 $(l, 1) (r, M)$ 这块地带连通块个数。  \n", "outputFormat": "对于每个询问中的 $Q$，输出一行，一个数字，表示当前的连通块个数。\n", "hint": "对于 $100\\%$ 的数据，$N\\le 100000, M\\le 6, Q\\le 10000$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2013] Urban Planning", "background": "", "description": "The mayor of City A plans to develop a coastal strip, modeled as an $N \\times M$ grid. Each cell can be a building, a road, or grassland. The strip is to be leased to companies, but the requirements are unusual: the buildings leased to a company must form a single connected component through roads. Each connected component can be leased to only one company.\n\nThe $N \\times M$ grid is represented by the characters `O`, `.`, `+`, `|`, `-`, where `O` denotes a building, `.` denotes grassland. The symbols `|`, `-`, `+` denote roads, connecting up–down, left–right, and both up–down and left–right respectively. Orthogonally adjacent `O` cells are considered part of the same building.\n\nDue to imperfect planning, some connected components may contain only roads; such components cannot be leased. Since the final selected plot may be co-developed with other cities, at the time of querying we will select a sub-rectangle of size $N_i \\times M$ with $(0 < N_i \\le N)$. The mayor wants software that supports:\n1. Modifying a single cell.\n2. Querying how many connected components within a specified strip contain at least one building.", "inputFormat": "- The first line contains two integers $N, M$ as described.\n- The next $N$ lines each contain $M$ characters describing the initial state of the strip.\n- The next line contains an integer $Q$, the number of operations.\n- Each of the following $Q$ lines is in one of the following formats:\n  - `C i j k`: Change the cell at row $i$, column $j$ to character `k`.\n    - `k` is one of `O`, `.`, `+`, `|`, `-`.\n  - `Q l r`: Query the number of connected components that contain at least one building within the sub-rectangle with corners $(l, 1)$ and $(r, M)$.\n\nRows and columns are 1-indexed.", "outputFormat": "For each `Q` operation, output one line with a single integer: the current number of connected components that contain at least one building in the specified strip.", "hint": "Constraints: For $100\\%$ of the testdata, $N \\le 100000$, $M \\le 6$, $Q \\le 10000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2013] 城市规划", "background": "", "description": "A 市的市长打算在海边开发一段地带。这个地带看成是一个 $N \\times M $ 的方格阵。每个格子可以是建筑、道路或者草地。这片地带是要出租给某些公司，但是这些公司的要求很奇怪。他们要求租给他们的建筑要通过道路形成一个连通块。同一个连通块只能租给一家公司。这个 $N\\times M$ 的方格阵是用字符组成的：`O`，`.`，`+`，`|`，`-`，其中 `O` 表示建筑，'.' 表示草地。`|`，`-`，`+` 表示道路，分别表示把上下，左右、上下左右的格子连起来。相邻的 `O` 表示这是一个建筑物。\n\n由于规划可能不太好，可能某些连通块里面只有道路，这里道路是不能出租的！由于最后这块地的选取可能有部分会与其他市共冋开发，所以最后会在这个 $N\\times M$ 中选取一段出来，最后选取出来的是一个 $N_i\\times M$（$0<N_1\\le N$）的地段。A 市的市长想弄要一个规划软件，支持以下功能：\n\n1. 改变一个格子。\n2. 询问某块地带有多少个带建筑的连通块。", "inputFormat": "第一行两个整数 $N, M$，如题意所示\n\n接下来的 $N$ 行，每行 $M$ 个字符表示这片地带的初始情况。  \n\n接下来的一行一个整数 $Q$，表示操作次数。接下来的 $Q$ 行，每行有两种格式：  \n- `C i j k` :  把第 $i$ 行第 $j$ 个格子修改成k；\n- `Q l r`:  询问 $(l, 1) (r, M)$ 这块地带连通块个数。  \n", "outputFormat": "对于每个询问中的 $Q$，输出一行，一个数字，表示当前的连通块个数。\n", "hint": "对于 $100\\%$ 的数据，$N\\le 100000, M\\le 6, Q\\le 10000$。\n", "locale": "zh-CN"}}}
{"pid": "P3301", "type": "P", "difficulty": 6, "samples": [["3 10007\n3 1 1 6\n3 3\n3 0 0 5\n\n3 1 1 3\n3 3\n", "3\n6\n0\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "各省省选", "山东", "中国剩余定理 CRT", "组合数学", "容斥原理"], "title": "[SDOI2013] 方程", "background": null, "description": "给定方程\n$x_1+x_2+\\dots +x_{n}=m$。\n\n我们对第 $1 \\sim n_1$ 个变量进行一些限制： $x_{1} \\le a_{1},x_{2} \\le a_{2},\\dots, x_{n_1} \\le a_{n_1}$。\n\n我们对第 $n_1+1\\sim n_1+n_2$ 个变量进行一些限制： $x_{n_1+1} \\ge a_{n_1+1},x_{n_1+2} \\ge a_{n_1+2},\\dots,x_{n_1+n_2} \\ge a_{n_1+n_2}$。\n\n求：在满足这些限制的前提下，该方程正整数解的个数。答案可能很大，请输出对 $p$ 取模后的答案。", "inputFormat": "输入含有多组数据。 \n\n第一行两个正整数 $T,p$。$T$  表示这个测试点内的数据组数，$p$ 的含义见题目描述。\n\n对于每组数据，第一行四个非负整数 $n,n_1,n_2,m$。 \n\n第二行 $n_1+n_2$ 个正整数，表示 $a_{1},a_2,\\dots, a_{n_1+n_2}$。请注意，如果 $n_1+n_2$ 等于 $0$，那么这一行会成为一个空行。", "outputFormat": "共 $T$ 行，每行一个正整数表示取模后的答案。", "hint": "**【样例解释】**\n\n对于第一组数据，三组解为 $(1,3,2)，(1,4,1),(2,3,1) $。  \n对于第二组数据，六组解为 $(1,1,3),(1,2,2),(1,3,1),(2,1,2),(2,2,1),(3,1,1)$。\n\n![](https://cdn.luogu.com.cn/upload/pic/17621.png)\n\n对于 $100\\%$ 的数据，$1\\le T \\le 5$，$1\\le m, n \\le 10^9$，$1 \\le a_i \\le m$，$0 \\le n_1,n_2 \\le \\min(8, m)$ 且 $n_1 + n_2 \\le n$，$1\\le p \\le 437367875$。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2013] Equation", "background": "", "description": "Given the equation\n$x_1+x_2+\\dots +x_{n}=m$.\n\nWe impose restrictions on variables $1$ through $n_1$: $x_{1} \\le a_{1},x_{2} \\le a_{2},\\dots, x_{n_1} \\le a_{n_1}$.\n\nWe impose restrictions on variables $n_1+1$ through $n_1+n_2$: $x_{n_1+1} \\ge a_{n_1+1},x_{n_1+2} \\ge a_{n_1+2},\\dots,x_{n_1+n_2} \\ge a_{n_1+n_2}$.\n\nFind the number of positive integer solutions of the equation under these restrictions. The answer can be large; please output it modulo $p$.", "inputFormat": "Multiple test cases.\n\nThe first line contains two positive integers $T,p$. $T$ denotes the number of test cases in this file, and the meaning of $p$ is as described above.\n\nFor each test case, the first line contains four non-negative integers $n,n_1,n_2,m$.\n\nThe second line contains $n_1+n_2$ positive integers, denoting $a_{1},a_2,\\dots, a_{n_1+n_2}$. Note that if $n_1+n_2$ equals $0$, this line will be empty.", "outputFormat": "Output $T$ lines, each containing a single integer representing the answer modulo $p$.", "hint": "【Sample explanation】\n\nFor the first test case, the three solutions are $(1,3,2)$, $(1,4,1)$, $(2,3,1)$.\nFor the second test case, the six solutions are $(1,1,3)$, $(1,2,2)$, $(1,3,1)$, $(2,1,2)$, $(2,2,1)$, $(3,1,1)$.\n\n![](https://cdn.luogu.com.cn/upload/pic/17621.png)\n\nConstraints: For $100\\%$ of the testdata, $1\\le T \\le 5$, $1\\le m, n \\le 10^9$, $1 \\le a_i \\le m$, $0 \\le n_1,n_2 \\le \\min(8, m)$ and $n_1 + n_2 \\le n$, $1\\le p \\le 437367875$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2013] 方程", "background": null, "description": "给定方程\n$x_1+x_2+\\dots +x_{n}=m$。\n\n我们对第 $1 \\sim n_1$ 个变量进行一些限制： $x_{1} \\le a_{1},x_{2} \\le a_{2},\\dots, x_{n_1} \\le a_{n_1}$。\n\n我们对第 $n_1+1\\sim n_1+n_2$ 个变量进行一些限制： $x_{n_1+1} \\ge a_{n_1+1},x_{n_1+2} \\ge a_{n_1+2},\\dots,x_{n_1+n_2} \\ge a_{n_1+n_2}$。\n\n求：在满足这些限制的前提下，该方程正整数解的个数。答案可能很大，请输出对 $p$ 取模后的答案。", "inputFormat": "输入含有多组数据。 \n\n第一行两个正整数 $T,p$。$T$  表示这个测试点内的数据组数，$p$ 的含义见题目描述。\n\n对于每组数据，第一行四个非负整数 $n,n_1,n_2,m$。 \n\n第二行 $n_1+n_2$ 个正整数，表示 $a_{1},a_2,\\dots, a_{n_1+n_2}$。请注意，如果 $n_1+n_2$ 等于 $0$，那么这一行会成为一个空行。", "outputFormat": "共 $T$ 行，每行一个正整数表示取模后的答案。", "hint": "**【样例解释】**\n\n对于第一组数据，三组解为 $(1,3,2)，(1,4,1),(2,3,1) $。  \n对于第二组数据，六组解为 $(1,1,3),(1,2,2),(1,3,1),(2,1,2),(2,2,1),(3,1,1)$。\n\n![](https://cdn.luogu.com.cn/upload/pic/17621.png)\n\n对于 $100\\%$ 的数据，$1\\le T \\le 5$，$1\\le m, n \\le 10^9$，$1 \\le a_i \\le m$，$0 \\le n_1,n_2 \\le \\min(8, m)$ 且 $n_1 + n_2 \\le n$，$1\\le p \\le 437367875$。", "locale": "zh-CN"}}}
{"pid": "P3302", "type": "P", "difficulty": 6, "samples": [["1\n8 4 8\n1 1 2 2 3 3 4 4\n4 7\n1 8\n2 4\n2 1\nQ 8 7 3\nQ 3 5 1\nQ 10 0 0\nL 5 4\nL 3 2\nL 0 7\nQ 9 2 5\nQ 6 1 6", "2 \n2\n1\n4\n2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2013", "线段树", "各省省选", "山东", "深度优先搜索 DFS", "可持久化线段树", "启发式合并"], "title": "[SDOI2013] 森林", "background": "", "description": "小 Z 有一片森林，含有 $N$ 个节点，每个节点上都有一个非负整数作为权值。初始的时候，森林中有 $M$ 条边。\n\n小Z希望执行 $T$ 个操作，操作有两类：\n\n - `Q x y k` 查询点 $x$ 到点 $y$ 路径上所有的权值中，第 $k$ 小的权值是多少。此操作保证点 $x$ 和点 $y$ 连通，同时这两个节点的路径上至少有 $k$ 个点。\n - `L x y` 在点 $x$ 和点 $y$ 之间连接一条边。保证完成此操作后，仍然是一片森林。\n\n为了体现程序的在线性，我们把输入数据进行了加密。设 $lastans$ 为程序上一次输出的结果，初始的时候 $lastans$ 为 $0$。\n\n对于一个输入的操作 `Q x y k`，其真实操作为 `Q x^lastans y^lastans k^lastans`。\n\n对于一个输入的操作 `L x y`，其真实操作为 `L x^lastans y^lastans`。其中 `^` 运算符表示异或，等价于 Pascal 中的 `xor` 运算符。\n\n请写一个程序来帮助小 Z 完成这些操作。", "inputFormat": "第一行包含一个正整数 $\\mathrm{testcase}$，表示当前测试数据的测试点编号。\n\n第二行包含三个整数 $N,M,T$，分别表示节点数、初始边数、操作数。\n\n第三行包含 $N$ 个非负整数表示 $N$ 个节点上的权值。\n\n接下来 $M$ 行，每行包含两个整数 $x$ 和 $y$，表示初始的时候，点 $x$ 和点 $y$ 之间有一条无向边。\n\n接下来 $T$ 行，每行描述一个操作，格式为 `Q x y k` 或者 `L x y`，其含义见题目描述部分。", "outputFormat": "对于每一个第一类操作，输出一个非负整数表示答案。", "hint": "**样例解释**\n\n对于第一个操作 `Q 8 7 3`，此时 $lastans=0$，所以真实操作为 `Q 8^0 7^0 3^0`，也即 `Q 8 7 3`。点 $8$ 到点 $7$ 的路径上一共有 $5$ 个点，其权值为 $4\\ 1\\ 1\\ 2\\ 4$。这些权值中，第三小的为 $2$，输出 $2$，$lastans$ 变为 $2$。\n\n对于第二个操作 `Q 3 5 1` ，此时 $lastans=2$，所以真实操作为 `Q 3^2 5^2 1^2`，也即 `Q 1 7 3`。点 $1$ 到点 $7$ 的路径上一共有 $4$ 个点，其权值为 $1\\ 1\\ 2\\ 4$ 。这些权值中，第三小的为 $2$，输出 $2$，$lastans$ 变为 $2$。之后的操作类似。\n\n-----\n**数据范围**\n\n| 测试点编号  | $N,M,T$ 的上界 |  `L` 操作   |  `Q` 操作  | 形态 |\n| :---------: | :------------: | :---------: | :--------: | :--: |\n|     $1$     |      $20$      |     N/A     |    N/A     | N/A  |\n|     $2$     |     $200$      |     N/A     |    N/A     | N/A  |\n|  $3\\sim 4$  | $4\\times 10^4$ | 无 `L` 操作 |    N/A     |  链  |\n|  $5\\sim 6$  | $8\\times 10^4$ | 无 `L` 操作 |    N/A     |  链  |\n|  $7\\sim 9$  | $8\\times 10^4$ | 无 `L` 操作 | 保证 $k=1$ | N/A  |\n| $10\\sim 11$ | $4\\times 10^4$ |     N/A     | 保证 $k=1$ | N/A  |\n| $12\\sim 13$ | $8\\times 10^4$ |     N/A     | 保证 $k=1$ | N/A  |\n| $14\\sim 15$ | $4\\times 10^4$ | 无 `L` 操作 |    N/A     | N/A  |\n| $16\\sim 17$ | $8\\times 10^4$ | 无 `L` 操作 |    N/A     | N/A  |\n|    $18$     | $4\\times 10^4$ |     N/A     |    N/A     | N/A  |\n| $19\\sim 20$ | $8\\times 10^4$ |     N/A     |    N/A     | N/A  |\n\n注：N/A 表示没有特殊性。\n\n对于 $100\\%$ 的测试数据，所有节点的编号在 $1\\sim N$ 的范围内。节点上的权值 $\\le 10^9$。$M<N$。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2013] Forest", "background": "", "description": "Xiao Z has a forest with $N$ nodes, and each node has a non-negative integer as its weight. Initially, there are $M$ edges in the forest.\n\nXiao Z wants to perform $T$ operations of two types:\n- `Q x y k` Query the $k$-th smallest weight among all the weights on the path from $x$ to $y$. It is guaranteed that $x$ and $y$ are connected, and there are at least $k$ nodes on this path.\n- `L x y` Add an edge between nodes $x$ and $y$. It is guaranteed that after this operation, the graph is still a forest.\n\nTo make the program online, the input is encrypted. Let $lastans$ be the last printed answer, initially $0$.\n\nFor an input operation `Q x y k`, the real operation is `Q x^lastans y^lastans k^lastans`.\n\nFor an input operation `L x y`, the real operation is `L x^lastans y^lastans`. Here the operator `^` denotes bitwise XOR, equivalent to `xor` in Pascal.\n\nPlease write a program to help Xiao Z finish these operations.", "inputFormat": "The first line contains a positive integer $\\mathrm{testcase}$, indicating the test point index of the current testdata.\n\nThe second line contains three integers $N, M, T$, denoting the number of nodes, the number of initial edges, and the number of operations, respectively.\n\nThe third line contains $N$ non-negative integers, representing the weights of the $N$ nodes.\n\nThe next $M$ lines each contain two integers $x$ and $y$, indicating that initially there is an undirected edge between $x$ and $y$.\n\nThe next $T$ lines each describe an operation, in the format `Q x y k` or `L x y`, as defined above.", "outputFormat": "For each operation of the first type, output a non-negative integer as the answer.", "hint": "Sample explanation:\n\nFor the first operation `Q 8 7 3`, at this time $lastans = 0$, so the real operation is `Q 8^0 7^0 3^0`, i.e., `Q 8 7 3`. There are $5$ nodes on the path from $8$ to $7$, and their weights are $4, 1, 1, 2, 4$. Among these weights, the $3$-rd smallest is $2$, so output $2$, and $lastans$ becomes $2$.\n\nFor the second operation `Q 3 5 1`, at this time $lastans = 2$, so the real operation is `Q 3^2 5^2 1^2`, i.e., `Q 1 7 3`. There are $4$ nodes on the path from $1$ to $7$, and their weights are $1, 1, 2, 4$. Among these weights, the $3$-rd smallest is $2$, so output $2$, and $lastans$ becomes $2$. The subsequent operations are similar.\n\n-----\n\nConstraints\n\n| Test point index | Upper bounds of $N, M, T$ | `L` operations | `Q` operations | Structure |\n| :--------------: | :-----------------------: | :------------: | :------------: | :-------: |\n|        $1$       |           $20$            |      N/A       |      N/A       |    N/A    |\n|        $2$       |           $200$           |      N/A       |      N/A       |    N/A    |\n|     $3\\sim 4$    |     $4\\times 10^4$        |  No `L` operations  |      N/A       |   Chain   |\n|     $5\\sim 6$    |     $8\\times 10^4$        |  No `L` operations  |      N/A       |   Chain   |\n|     $7\\sim 9$    |     $8\\times 10^4$        |  No `L` operations  | Guaranteed $k=1$ |    N/A    |\n|    $10\\sim 11$   |     $4\\times 10^4$        |      N/A       | Guaranteed $k=1$ |    N/A    |\n|    $12\\sim 13$   |     $8\\times 10^4$        |      N/A       | Guaranteed $k=1$ |    N/A    |\n|    $14\\sim 15$   |     $4\\times 10^4$        |  No `L` operations  |      N/A       |    N/A    |\n|    $16\\sim 17$   |     $8\\times 10^4$        |  No `L` operations  |      N/A       |    N/A    |\n|       $18$       |     $4\\times 10^4$        |      N/A       |      N/A       |    N/A    |\n|    $19\\sim 20$   |     $8\\times 10^4$        |      N/A       |      N/A       |    N/A    |\n\nNote: N/A means no special property.\n\nFor $100\\%$ of the testdata, all node indices are in the range $1 \\sim N$. Each node’s weight $\\le 10^9$. $M < N$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2013] 森林", "background": "", "description": "小 Z 有一片森林，含有 $N$ 个节点，每个节点上都有一个非负整数作为权值。初始的时候，森林中有 $M$ 条边。\n\n小Z希望执行 $T$ 个操作，操作有两类：\n\n - `Q x y k` 查询点 $x$ 到点 $y$ 路径上所有的权值中，第 $k$ 小的权值是多少。此操作保证点 $x$ 和点 $y$ 连通，同时这两个节点的路径上至少有 $k$ 个点。\n - `L x y` 在点 $x$ 和点 $y$ 之间连接一条边。保证完成此操作后，仍然是一片森林。\n\n为了体现程序的在线性，我们把输入数据进行了加密。设 $lastans$ 为程序上一次输出的结果，初始的时候 $lastans$ 为 $0$。\n\n对于一个输入的操作 `Q x y k`，其真实操作为 `Q x^lastans y^lastans k^lastans`。\n\n对于一个输入的操作 `L x y`，其真实操作为 `L x^lastans y^lastans`。其中 `^` 运算符表示异或，等价于 Pascal 中的 `xor` 运算符。\n\n请写一个程序来帮助小 Z 完成这些操作。", "inputFormat": "第一行包含一个正整数 $\\mathrm{testcase}$，表示当前测试数据的测试点编号。\n\n第二行包含三个整数 $N,M,T$，分别表示节点数、初始边数、操作数。\n\n第三行包含 $N$ 个非负整数表示 $N$ 个节点上的权值。\n\n接下来 $M$ 行，每行包含两个整数 $x$ 和 $y$，表示初始的时候，点 $x$ 和点 $y$ 之间有一条无向边。\n\n接下来 $T$ 行，每行描述一个操作，格式为 `Q x y k` 或者 `L x y`，其含义见题目描述部分。", "outputFormat": "对于每一个第一类操作，输出一个非负整数表示答案。", "hint": "**样例解释**\n\n对于第一个操作 `Q 8 7 3`，此时 $lastans=0$，所以真实操作为 `Q 8^0 7^0 3^0`，也即 `Q 8 7 3`。点 $8$ 到点 $7$ 的路径上一共有 $5$ 个点，其权值为 $4\\ 1\\ 1\\ 2\\ 4$。这些权值中，第三小的为 $2$，输出 $2$，$lastans$ 变为 $2$。\n\n对于第二个操作 `Q 3 5 1` ，此时 $lastans=2$，所以真实操作为 `Q 3^2 5^2 1^2`，也即 `Q 1 7 3`。点 $1$ 到点 $7$ 的路径上一共有 $4$ 个点，其权值为 $1\\ 1\\ 2\\ 4$ 。这些权值中，第三小的为 $2$，输出 $2$，$lastans$ 变为 $2$。之后的操作类似。\n\n-----\n**数据范围**\n\n| 测试点编号  | $N,M,T$ 的上界 |  `L` 操作   |  `Q` 操作  | 形态 |\n| :---------: | :------------: | :---------: | :--------: | :--: |\n|     $1$     |      $20$      |     N/A     |    N/A     | N/A  |\n|     $2$     |     $200$      |     N/A     |    N/A     | N/A  |\n|  $3\\sim 4$  | $4\\times 10^4$ | 无 `L` 操作 |    N/A     |  链  |\n|  $5\\sim 6$  | $8\\times 10^4$ | 无 `L` 操作 |    N/A     |  链  |\n|  $7\\sim 9$  | $8\\times 10^4$ | 无 `L` 操作 | 保证 $k=1$ | N/A  |\n| $10\\sim 11$ | $4\\times 10^4$ |     N/A     | 保证 $k=1$ | N/A  |\n| $12\\sim 13$ | $8\\times 10^4$ |     N/A     | 保证 $k=1$ | N/A  |\n| $14\\sim 15$ | $4\\times 10^4$ | 无 `L` 操作 |    N/A     | N/A  |\n| $16\\sim 17$ | $8\\times 10^4$ | 无 `L` 操作 |    N/A     | N/A  |\n|    $18$     | $4\\times 10^4$ |     N/A     |    N/A     | N/A  |\n| $19\\sim 20$ | $8\\times 10^4$ |     N/A     |    N/A     | N/A  |\n\n注：N/A 表示没有特殊性。\n\n对于 $100\\%$ 的测试数据，所有节点的编号在 $1\\sim N$ 的范围内。节点上的权值 $\\le 10^9$。$M<N$。", "locale": "zh-CN"}}}
{"pid": "P3303", "type": "P", "difficulty": 6, "samples": [["12 5", "18"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2013", "各省省选", "山东", "数位 DP"], "title": "[SDOI2013] 淘金", "background": "", "description": "小 Z 在玩一个叫做《淘金者》的游戏。游戏的世界是一个二维坐标。$X$ 轴、$Y$ 轴坐标范围均为$1\\ldots N$。初始的时候，所有的整数坐标点上均有一块金子，共 $N^2$ 块。\n\n一阵风吹过，金子的位置发生了一些变化。细心的小 Z 发现，初始在 $(i,j)$ 坐标处的金子会变到 $(f(i),f(j))$ 坐标处。其中 $f(x)$ 表示 $x$ 各位数字的乘积，例如 $f(99)=81,~f(12)=2,~f(10)=0$。\n\n如果金子变化后的坐标不在 $1\\ldots N$ 的范围内，我们认为这块金子已经被移出游戏。同时可以发现，对于变化之后的游戏局面，某些坐标上的金子数量可能不止一块，而另外一些坐标上可能已经没有金子。这次变化之后，游戏将不会再对金子的位置和数量进行改变，玩家可以开始进行采集工作。\n\n小 Z 很懒，打算只进行 $K$ 次采集。每次采集可以得到某一个坐标上的所有金子，采集之后，该坐标上的金子数变为 $0$。\n\n现在小 Z 希望知道，对于变化之后的游戏局面，在采集次数为 $K$ 的前提下，最多可以采集到多少块金子？ 答案可能很大，小 Z 希望得到对 $10^9+7$ 取模之后的答案。", "inputFormat": "共一行，包含两个正整数 $N, K$。\n", "outputFormat": "一个整数，表示最多可以采集到的金子数量。\n", "hint": "对于 $100\\%$ 的数据，$N \\leq 10^{12}, K \\leq \\min(N^2, 10^5)$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2013] Gold Mining", "background": "", "description": "Xiao Z is playing a game called \"Prospector.\" The game world is a 2D coordinate plane. The ranges of the $X$-axis and $Y$-axis coordinates are both $1\\ldots N$. Initially, there is one piece of gold at every integer coordinate point, for a total of $N^2$ pieces.\n\nA gust of wind blows by, and the positions of the gold pieces change. The observant Xiao Z notices that the piece initially at $(i,j)$ will move to $(f(i),f(j))$. Here $f(x)$ denotes the product of the digits of $x$, for example $f(99)=81,~f(12)=2,~f(10)=0$.\n\nIf the new coordinates of a piece of gold fall outside the range $1\\ldots N$, we consider this piece to have been removed from the game. It can also be observed that in the resulting state, some coordinates may have more than one piece of gold, while some coordinates may have none. After this change, the game will no longer alter the positions or quantities of gold; the player can begin collecting.\n\nXiao Z is lazy and plans to perform only $K$ collections. Each collection can obtain all the gold at a single coordinate; after collecting, the number of gold pieces at that coordinate becomes $0$.\n\nNow Xiao Z wants to know, in the resulting game state, with $K$ collections, what is the maximum number of gold pieces that can be collected? The answer may be large, so Xiao Z wants the answer modulo $10^9+7$.", "inputFormat": "One line containing two positive integers $N, K$.", "outputFormat": "A single integer, the maximum number of gold pieces that can be collected.", "hint": "For $100\\%$ of the testdata, $N \\leq 10^{12}, K \\leq \\min(N^2, 10^5)$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2013] 淘金", "background": "", "description": "小 Z 在玩一个叫做《淘金者》的游戏。游戏的世界是一个二维坐标。$X$ 轴、$Y$ 轴坐标范围均为$1\\ldots N$。初始的时候，所有的整数坐标点上均有一块金子，共 $N^2$ 块。\n\n一阵风吹过，金子的位置发生了一些变化。细心的小 Z 发现，初始在 $(i,j)$ 坐标处的金子会变到 $(f(i),f(j))$ 坐标处。其中 $f(x)$ 表示 $x$ 各位数字的乘积，例如 $f(99)=81,~f(12)=2,~f(10)=0$。\n\n如果金子变化后的坐标不在 $1\\ldots N$ 的范围内，我们认为这块金子已经被移出游戏。同时可以发现，对于变化之后的游戏局面，某些坐标上的金子数量可能不止一块，而另外一些坐标上可能已经没有金子。这次变化之后，游戏将不会再对金子的位置和数量进行改变，玩家可以开始进行采集工作。\n\n小 Z 很懒，打算只进行 $K$ 次采集。每次采集可以得到某一个坐标上的所有金子，采集之后，该坐标上的金子数变为 $0$。\n\n现在小 Z 希望知道，对于变化之后的游戏局面，在采集次数为 $K$ 的前提下，最多可以采集到多少块金子？ 答案可能很大，小 Z 希望得到对 $10^9+7$ 取模之后的答案。", "inputFormat": "共一行，包含两个正整数 $N, K$。\n", "outputFormat": "一个整数，表示最多可以采集到的金子数量。\n", "hint": "对于 $100\\%$ 的数据，$N \\leq 10^{12}, K \\leq \\min(N^2, 10^5)$。\n", "locale": "zh-CN"}}}
{"pid": "P3304", "type": "P", "difficulty": 4, "samples": [["6\n3 1 1000\n1 4 10\n4 2 100\n4 5 50\n4 6 100", "1110 \n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "各省省选", "山东", "深度优先搜索 DFS", "树的直径"], "title": "[SDOI2013] 直径", "background": null, "description": "小 Q 最近学习了一些图论知识。根据课本，有如下定义。树：无回路且连通的无向图，每条边都有正整数的权值来表示其长度。如果一棵树有 $N$ 个节点，可以证明其有且仅有 $N-1$ 条边。\n\n路径：一棵树上，任意两个节点之间最多有一条简单路径。我们用 $\\text{dis}(a,b)$ 表示点 $a$ 和点 $b$ 的路径上各边长度之和。称 $\\text{dis}(a,b)$ 为 $a,b$ 两个节点间的距离。\n\n直径：一棵树上，最长的路径为树的直径。树的直径可能不是唯一的。\n\n现在小 Q 想知道，对于给定的一棵树，其直径的长度是多少，以及有多少条边满足所有的直径都经过该边。", "inputFormat": "第一行包含一个整数 $N$，表示节点数。\n\n接下来 $N-1$ 行，每行三个整数 $a,b,c$，表示点 $a$ 和点 $b$ 之间有一条长度为 $c$ 的无向边。", "outputFormat": "共两行。第一行一个整数，表示直径的长度。第二行一个整数，表示被所有直径经过的边的数量。", "hint": "【样例说明】 \n\n直径共有两条，$3$ 到 $2$ 的路径和 $3$ 到 $6$ 的路径。这两条直径都经过边 $(3,1)$ 和边 $(1, 4)$。\n\n对于 $100\\%$ 的测试数据：$2\\le N\\le 2\\times 10^5$，$1\\le a,b\\le N$，$0\\le c \\le10^9$。输入的图构成一棵树。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2013] Diameter", "background": "", "description": "Xiao Q recently learned some graph theory. According to the textbook, we have the following definitions. A tree is an undirected graph that is connected and acyclic, where each edge has a positive integer weight representing its length. If a tree has $N$ nodes, it can be shown that it has exactly $N-1$ edges.\n\nPath: In a tree, between any two nodes there exists at most one simple path. We use $\\text{dis}(a,b)$ to denote the sum of the lengths of the edges on the path between $a$ and $b$. We call $\\text{dis}(a,b)$ the distance between nodes $a$ and $b$.\n\nDiameter: In a tree, the longest path is called the diameter of the tree. The tree’s diameter may not be unique.\n\nNow Xiao Q wants to know, for a given tree, what the length of its diameter is, and how many edges are traversed by all diameters.", "inputFormat": "The first line contains an integer $N$, the number of nodes.\n\nThe next $N-1$ lines each contain three integers $a,b,c$, indicating there is an undirected edge of length $c$ between nodes $a$ and $b$.", "outputFormat": "Output two lines. The first line contains one integer, the length of the diameter. The second line contains one integer, the number of edges that are traversed by all diameters.", "hint": "[Sample Explanation]\n\nThere are two diameters: the path from $3$ to $2$ and the path from $3$ to $6$. Both diameters pass through edge $(3,1)$ and edge $(1,4)$.\n\nFor $100\\%$ of the testdata: $2 \\le N \\le 2 \\times 10^5$, $1 \\le a,b \\le N$, $0 \\le c \\le 10^9$. The input graph forms a tree.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2013] 直径", "background": null, "description": "小 Q 最近学习了一些图论知识。根据课本，有如下定义。树：无回路且连通的无向图，每条边都有正整数的权值来表示其长度。如果一棵树有 $N$ 个节点，可以证明其有且仅有 $N-1$ 条边。\n\n路径：一棵树上，任意两个节点之间最多有一条简单路径。我们用 $\\text{dis}(a,b)$ 表示点 $a$ 和点 $b$ 的路径上各边长度之和。称 $\\text{dis}(a,b)$ 为 $a,b$ 两个节点间的距离。\n\n直径：一棵树上，最长的路径为树的直径。树的直径可能不是唯一的。\n\n现在小 Q 想知道，对于给定的一棵树，其直径的长度是多少，以及有多少条边满足所有的直径都经过该边。", "inputFormat": "第一行包含一个整数 $N$，表示节点数。\n\n接下来 $N-1$ 行，每行三个整数 $a,b,c$，表示点 $a$ 和点 $b$ 之间有一条长度为 $c$ 的无向边。", "outputFormat": "共两行。第一行一个整数，表示直径的长度。第二行一个整数，表示被所有直径经过的边的数量。", "hint": "【样例说明】 \n\n直径共有两条，$3$ 到 $2$ 的路径和 $3$ 到 $6$ 的路径。这两条直径都经过边 $(3,1)$ 和边 $(1, 4)$。\n\n对于 $100\\%$ 的测试数据：$2\\le N\\le 2\\times 10^5$，$1\\le a,b\\le N$，$0\\le c \\le10^9$。输入的图构成一棵树。", "locale": "zh-CN"}}}
{"pid": "P3305", "type": "P", "difficulty": 6, "samples": [["3 2 1\n1 2 10\n2 3 15", "10\n10.0000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "二分", "各省省选", "网络流", "山东", "Special Judge"], "title": "[SDOI2013] 费用流", "background": "", "description": "Alice 和 Bob 在图论课程上学习了最大流和最小费用最大流的相关知识。\n\n> 最大流问题：给定一张有向图表示运输网络，一个源点 $S$ 和一个汇点 $T$ ，每条边都有最大流量。\n> \n> 一个合法的网络流方案必须满足：\n> \n> 1. 每条边的实际流量都不超过其最大流量且非负；\n> 2. 除了源点 $S$ 和汇点 $T$ 之外，对于其余所有点，都满足该点总流入流量等于该点总流出流量；而 $S$ 点的净流出流量等于 $T$ 点的净流入流量，这个值也即该网络流方案的总运输量。\n>\n> 最大流问题就是对于给定的运输网络，求总运输量最大的网络流方案。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/20ipdo37.png)\n\n上图表示了一个最大流问题。对于每条边，右边的数代表该边的最大流量，左边的数代表在最优解中，该边的实际流量。需要注意到，一个最大流问题的解可能不是唯一的。\n\n对于一张给定的运输网络，Alice 先确定一个最大流，如果有多种解，Alice 可以任选一种；之后 Bob 在每条边上分配单位花费（单位花费必须是非负实数），要求所有边的单位花费之和等于 $P$。\n\n总费用等于每一条边的实际流量乘以该边的单位花费。需要注意到，Bob 在分配单位花费之前，已经知道 Alice 所给出的最大流方案。现在 Alice 希望总费用尽量小，而 Bob 希望总费用尽量大。我们想知道，如果两个人都执行最优策略，最大流的值和总费用分别为多少。\n", "inputFormat": "第一行三个整数 $N,M,P$。$N$ 表示给定运输网络中节点的数量，$M$ 表示有向边的数量，$P$ 的含义见问题描述部分。为了简化问题，我们假设源点 $S$ 是点 $1$，汇点 $T$ 是点 $N$。\n\n接下来 $M$ 行，每行三个整数 $A,B,C$，表示有一条从点 $A$ 到点 $B$ 的有向边，其最大流量是 $C$。", "outputFormat": "第一行一个整数，表示最大流的值。第二行一个实数，表示总费用。建议选手输出四位以上小数。\n", "hint": "**【样例说明】**\n\n对于 Alice，最大流的方案是固定的。两条边的实际流量都为 $10$。\n\n对于 Bob，给第一条边分配 $0.5$ 的费用，第二条边分配 $0.5$ 的费用。总费用为：$10\\times 0.5+10\\times 0.5=10$。可以证明不存在总费用更大的分配方案。\n\n**【数据规模和约定】**\n\n对于 $20\\%$ 的测试数据，所有有向边的最大流量都是 $1$。\n\n对于 $100\\%$ 的测试数据，$N\\le 100$，$M\\le 1000$。\n\n对于 $100\\%$ 的测试数据：所有点的编号在 $1\\sim N$ 范围内，$1 \\le \\text{每条边的最大流量} \\le 50000$，$1\\le P\\le 10$，给定运输网络中不会有起点和终点相同的边。\n", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2013] Cost Flow", "background": "", "description": "Alice and Bob studied maximum flow and minimum-cost maximum flow in their graph theory course.\n\n> Maximum flow problem: Given a directed graph representing a transportation network, a source $S$ and a sink $T$, each edge has a maximum capacity.\n> \n> A valid network flow must satisfy:\n> \n> 1. The actual flow on every edge is non-negative and does not exceed its capacity;\n> 2. Except for the source $S$ and the sink $T$, for every other vertex, the total inflow equals the total outflow; the net outflow from $S$ equals the net inflow to $T$, and this value is the total shipped amount (the value of the flow).\n>\n> The maximum flow problem is to find, for the given network, a flow with the maximum total shipped amount.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/20ipdo37.png)\n\nThe figure above illustrates a maximum flow instance. For each edge, the number on the right is the edge capacity, and the number on the left is the actual flow on that edge in an optimal solution. Note that a maximum flow solution may not be unique.\n\nFor a given transportation network, Alice first determines a maximum flow. If there are multiple solutions, Alice may choose any one of them. After that, Bob assigns a unit cost to each edge (each unit cost must be a non-negative real number), subject to the constraint that the sum of unit costs over all edges equals $P$.\n\nThe total cost equals the actual flow on each edge multiplied by its unit cost, summed over all edges. Note that Bob knows the maximum flow solution chosen by Alice before assigning unit costs. Alice wants to minimize the total cost, while Bob wants to maximize it. We want to know, if both players use optimal strategies, what are the maximum flow value and the total cost.", "inputFormat": "The first line contains three integers $N, M, P$. $N$ is the number of vertices in the transportation network, $M$ is the number of directed edges, and $P$ is as defined in the statement. To simplify the problem, assume the source $S$ is vertex $1$ and the sink $T$ is vertex $N$.\n\nEach of the next $M$ lines contains three integers $A, B, C$, indicating a directed edge from $A$ to $B$ with capacity $C$.", "outputFormat": "Output two lines. The first line contains an integer, the maximum flow value. The second line contains a real number, the total cost. It is recommended to print at least 4 decimal places.", "hint": "**【Sample Explanation】**\n\nFor Alice, the maximum flow is fixed. The actual flow on both edges is $10$.\n\nFor Bob, assign a cost of $0.5$ to the first edge and $0.5$ to the second edge. The total cost is $10 \\times 0.5 + 10 \\times 0.5 = 10$. It can be proven that no assignment yields a larger total cost.\n\n**【Constraints】**\n\nFor $20\\%$ of the testdata, the capacity of every directed edge is $1$.\n\nFor $100\\%$ of the testdata, $N \\le 100$, $M \\le 1000$.\n\nFor $100\\%$ of the testdata: all vertex labels are in the range $1 \\sim N$, $1 \\le \\text{capacity of each edge} \\le 50000$, $1 \\le P \\le 10$, and there are no self-loop edges.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2013] 费用流", "background": "", "description": "Alice 和 Bob 在图论课程上学习了最大流和最小费用最大流的相关知识。\n\n> 最大流问题：给定一张有向图表示运输网络，一个源点 $S$ 和一个汇点 $T$ ，每条边都有最大流量。\n> \n> 一个合法的网络流方案必须满足：\n> \n> 1. 每条边的实际流量都不超过其最大流量且非负；\n> 2. 除了源点 $S$ 和汇点 $T$ 之外，对于其余所有点，都满足该点总流入流量等于该点总流出流量；而 $S$ 点的净流出流量等于 $T$ 点的净流入流量，这个值也即该网络流方案的总运输量。\n>\n> 最大流问题就是对于给定的运输网络，求总运输量最大的网络流方案。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/20ipdo37.png)\n\n上图表示了一个最大流问题。对于每条边，右边的数代表该边的最大流量，左边的数代表在最优解中，该边的实际流量。需要注意到，一个最大流问题的解可能不是唯一的。\n\n对于一张给定的运输网络，Alice 先确定一个最大流，如果有多种解，Alice 可以任选一种；之后 Bob 在每条边上分配单位花费（单位花费必须是非负实数），要求所有边的单位花费之和等于 $P$。\n\n总费用等于每一条边的实际流量乘以该边的单位花费。需要注意到，Bob 在分配单位花费之前，已经知道 Alice 所给出的最大流方案。现在 Alice 希望总费用尽量小，而 Bob 希望总费用尽量大。我们想知道，如果两个人都执行最优策略，最大流的值和总费用分别为多少。\n", "inputFormat": "第一行三个整数 $N,M,P$。$N$ 表示给定运输网络中节点的数量，$M$ 表示有向边的数量，$P$ 的含义见问题描述部分。为了简化问题，我们假设源点 $S$ 是点 $1$，汇点 $T$ 是点 $N$。\n\n接下来 $M$ 行，每行三个整数 $A,B,C$，表示有一条从点 $A$ 到点 $B$ 的有向边，其最大流量是 $C$。", "outputFormat": "第一行一个整数，表示最大流的值。第二行一个实数，表示总费用。建议选手输出四位以上小数。\n", "hint": "**【样例说明】**\n\n对于 Alice，最大流的方案是固定的。两条边的实际流量都为 $10$。\n\n对于 Bob，给第一条边分配 $0.5$ 的费用，第二条边分配 $0.5$ 的费用。总费用为：$10\\times 0.5+10\\times 0.5=10$。可以证明不存在总费用更大的分配方案。\n\n**【数据规模和约定】**\n\n对于 $20\\%$ 的测试数据，所有有向边的最大流量都是 $1$。\n\n对于 $100\\%$ 的测试数据，$N\\le 100$，$M\\le 1000$。\n\n对于 $100\\%$ 的测试数据：所有点的编号在 $1\\sim N$ 范围内，$1 \\le \\text{每条边的最大流量} \\le 50000$，$1\\le P\\le 10$，给定运输网络中不会有起点和终点相同的边。\n", "locale": "zh-CN"}}}
{"pid": "P3306", "type": "P", "difficulty": 5, "samples": [["3\n7 1 1 3 3\n7 2 2 2 0\n7 2 2 2 1\n", "1 \n3 \n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "各省省选", "数论", "山东", "O2优化", "逆元", "大步小步算法 BSGS"], "title": "[SDOI2013] 随机数生成器", "background": "小 W 喜欢读书，尤其喜欢读《约翰克里斯朵夫》。", "description": "最近小 W 准备读一本新书，这本书一共有 $p$ 页，页码范围为 $0 \\sim p-1$。\n\n小 W 很忙，所以每天只能读一页书。为了使事情有趣一些，他打算使用 NOI2012 上学习的线性同余法生成一个序列，来决定每天具体读哪一页。\n\n我们用 $x_i$ 来表示通过这种方法生成出来的第 $i$ 个数，也即小 W 第 $i$ 天会读哪一页。这个方法需要设置 $3$ 个参数 $a,b,x_1$，满足 $0\\leq a,b,x_1\\lt p$，且 $a,b,x_1$ 都是整数。按照下面的公式生成出来一系列的整数：\n$$x_{i+1} \\equiv a \\times x_i+b \\pmod p$$\n其中 $\\bmod$ 表示取余操作。\n\n但是这种方法可能导致某两天读的页码一样。\n\n小 W 要读这本书的第 $t$ 页，所以他想知道最早在哪一天能读到第 $t$ 页，或者指出他永远不会读到第 $t$ 页。\n", "inputFormat": "**本题单测试点内有多组测试数据**。\n\n第一行是一个整数 $T$，表示测试数据组数。\n\n接下来 $T$ 行，每行有五个整数 $p, a, b, x_1, t$，表示一组数据。\n", "outputFormat": "对于每组数据，输出一行一个整数表示他最早读到第 $t$ 页是哪一天。如果他永远不会读到第 $t$ 页，输出$-1$。\n", "hint": "#### 数据规模与约定\n\n对于全部的测试点，保证：\n\n- $1 \\leq T \\leq 50$。\n- $0 \\leq a, b, x_1, t \\lt p$，$2 \\leq p \\leq 10^9$。\n- $p$ 为质数。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2013] Random Number Generator", "background": "Xiao W likes reading, and especially enjoys reading \"Jean-Christophe\".", "description": "Recently, Xiao W plans to read a new book that has $p$ pages, with page numbers ranging from $0 \\sim p-1$.\n\nXiao W is busy, so he can read only one page per day. To make things a bit more interesting, he plans to use the linear congruential method he learned at NOI2012 to generate a sequence to decide which page to read each day.\n\nLet $x_i$ denote the $i$-th number generated by this method, i.e., the page Xiao W will read on day $i$. This method requires three parameters $a, b, x_1$, satisfying $0 \\leq a, b, x_1 \\lt p$, and $a, b, x_1$ are integers. A sequence of integers is generated according to the following formula:\n$$x_{i+1} \\equiv a \\times x_i + b \\pmod p$$\nHere, $\\bmod$ denotes the remainder operation.\n\nHowever, this method may cause the same page number to be read on two different days.\n\nXiao W wants to read page $t$ of this book, so he wants to know the earliest day on which he can read page $t$, or determine that he will never read page $t$.", "inputFormat": "This problem contains multiple test cases in a single test point.\n\nThe first line contains an integer $T$, the number of test cases.\n\nEach of the next $T$ lines contains five integers $p, a, b, x_1, t$, representing one test case.", "outputFormat": "For each test case, output one line with a single integer indicating the earliest day on which he reads page $t$. If he will never read page $t$, output $-1$.", "hint": "#### Constraints\n\n- $1 \\leq T \\leq 50$.\n- $0 \\leq a, b, x_1, t \\lt p$, $2 \\leq p \\leq 10^9$.\n- $p$ is a prime.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2013] 随机数生成器", "background": "小 W 喜欢读书，尤其喜欢读《约翰克里斯朵夫》。", "description": "最近小 W 准备读一本新书，这本书一共有 $p$ 页，页码范围为 $0 \\sim p-1$。\n\n小 W 很忙，所以每天只能读一页书。为了使事情有趣一些，他打算使用 NOI2012 上学习的线性同余法生成一个序列，来决定每天具体读哪一页。\n\n我们用 $x_i$ 来表示通过这种方法生成出来的第 $i$ 个数，也即小 W 第 $i$ 天会读哪一页。这个方法需要设置 $3$ 个参数 $a,b,x_1$，满足 $0\\leq a,b,x_1\\lt p$，且 $a,b,x_1$ 都是整数。按照下面的公式生成出来一系列的整数：\n$$x_{i+1} \\equiv a \\times x_i+b \\pmod p$$\n其中 $\\bmod$ 表示取余操作。\n\n但是这种方法可能导致某两天读的页码一样。\n\n小 W 要读这本书的第 $t$ 页，所以他想知道最早在哪一天能读到第 $t$ 页，或者指出他永远不会读到第 $t$ 页。\n", "inputFormat": "**本题单测试点内有多组测试数据**。\n\n第一行是一个整数 $T$，表示测试数据组数。\n\n接下来 $T$ 行，每行有五个整数 $p, a, b, x_1, t$，表示一组数据。\n", "outputFormat": "对于每组数据，输出一行一个整数表示他最早读到第 $t$ 页是哪一天。如果他永远不会读到第 $t$ 页，输出$-1$。\n", "hint": "#### 数据规模与约定\n\n对于全部的测试点，保证：\n\n- $1 \\leq T \\leq 50$。\n- $0 \\leq a, b, x_1, t \\lt p$，$2 \\leq p \\leq 10^9$。\n- $p$ 为质数。", "locale": "zh-CN"}}}
{"pid": "P3307", "type": "P", "difficulty": 6, "samples": [["1\n2  2", "3"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2013", "各省省选", "山东", "最大公约数 gcd", "莫比乌斯反演", "逆元"], "title": "[SDOI2013] 项链", "background": "项链作为人体的装饰品之一，是最早出现的首饰。项链除了具有装饰功能之外，有些项链还具有特殊的显示作用，如天主教徒的十字架链和佛教徒的念珠。\n\n从古至今人们为了美化人体本身，也美化环境，制造了各种不同风格、不同特点、不同样式的项链，满足了不同肤色、不同民族、不同审美观的人的审美需要。就材料而论，首饰市场上的项链有黄金、白银、珠宝等几种。\n\n珍珠项链为珍珠制成的饰品，即将珍珠钻孔后用线串在一起，佩戴于项间，天然珍珠项链具有一定的护养作用。", "description": "最近，铭铭迷恋上了一种项链。与其他珍珠项链基本上相同，不过这种项链的珠子却与众不同，是正三菱柱的泰山石雕刻而成的。\n\n三菱柱的侧面是由正方形构成的，每个侧面都刻有数字。能够让铭铭满意的项链必须满足以下条件：\n\n1. 这串项链由 $n$ 颗珠子构成。\n\n2. 每一个珠子上面的每个数字 $x$，必须满足 $0<x\\le a$，且珠子上面三个数字的最大公约数要恰好为 $1$。\n\n3. 相邻的两个珠子必须不同。两个珠子被认为是相同的，当且仅当它们经过旋转，或者翻转后能够变成一样的。\n\n4. 两串项链如果能够经过旋转变成一样的，那么这两串项链被认为是相同的。 \n\n铭铭很好奇如果给定 $n$ 和 $a$，能够找到多少串不同的项链。由于答案可能很大，所以输出答案模上 $10^{9}+7$ 的值。", "inputFormat": "**本题有多组数据**。\n\n第一行给定一个整数 $T$，表示数据组数。  \n接下来 $T$ 行，每行两个整数 $n$ 和 $a$。\n", "outputFormat": "对于每组数据输出一个整数，表示有多少串不同的项链。", "hint": "满足条件的珠子共有三种：`[1,1,1]`,`[1,1,2]`,`[1,2,2]`。\n\n组成的满足条件的串有：`[1,2]`,`[1,3]`,`[2,3]`。\n\n对于 $100\\%$ 的数据，保证 $1 \\le T \\le 10$，$2 \\le n \\le 10^{14}$，$1 \\le a \\le 10^7$。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2013] Necklace", "background": "As one of the body ornaments, the necklace is among the earliest pieces of jewelry. Besides its decorative function, some necklaces also have special symbolic roles, such as the crucifix chain for Catholics and the prayer beads for Buddhists.\n\nFrom ancient times to the present, people have created necklaces of various styles, features, and forms to beautify the human body and the environment, meeting the aesthetic needs of people with different skin tones, ethnicities, and tastes. In terms of materials, necklaces on the jewelry market include gold, silver, gemstones, and more.\n\nA pearl necklace is an ornament made of pearls, which are pierced and strung together to be worn around the neck. Natural pearl necklaces are believed to have certain protective qualities.", "description": "Recently, Mingming has become obsessed with a certain kind of necklace. It is basically the same as other pearl necklaces, but its beads are special: they are carved from Taishan stone into regular triangular prisms.\n\nThe prism has three square lateral faces, and each face is engraved with a number. A necklace that satisfies Mingming must meet the following conditions:\n\n1. The necklace consists of $n$ beads.\n2. On each bead, every number $x$ must satisfy $0 < x \\le a$, and the greatest common divisor of the three numbers on the bead must be exactly $1$.\n3. Adjacent beads must be different. Two beads are considered the same if and only if they can be made identical by rotation or reflection.\n4. Two necklaces are considered the same if they can become identical after a rotation.\n\nMingming is curious: given $n$ and $a$, how many different necklaces are there? Since the answer can be large, output it modulo $10^{9}+7$.", "inputFormat": "This problem contains multiple test cases.\n\nThe first line contains an integer $T$, the number of test cases.  \nThen follow $T$ lines, each containing two integers $n$ and $a$.", "outputFormat": "For each test case, output one integer, the number of different necklaces.", "hint": "There are three kinds of beads that meet the conditions: `[1,1,1]`, `[1,1,2]`, `[1,2,2]`.\n\nThe valid sequences they can form are: `[1,2]`, `[1,3]`, `[2,3]`.\n\nFor $100\\%$ of the testdata, it is guaranteed that $1 \\le T \\le 10$, $2 \\le n \\le 10^{14}$, $1 \\le a \\le 10^7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2013] 项链", "background": "项链作为人体的装饰品之一，是最早出现的首饰。项链除了具有装饰功能之外，有些项链还具有特殊的显示作用，如天主教徒的十字架链和佛教徒的念珠。\n\n从古至今人们为了美化人体本身，也美化环境，制造了各种不同风格、不同特点、不同样式的项链，满足了不同肤色、不同民族、不同审美观的人的审美需要。就材料而论，首饰市场上的项链有黄金、白银、珠宝等几种。\n\n珍珠项链为珍珠制成的饰品，即将珍珠钻孔后用线串在一起，佩戴于项间，天然珍珠项链具有一定的护养作用。", "description": "最近，铭铭迷恋上了一种项链。与其他珍珠项链基本上相同，不过这种项链的珠子却与众不同，是正三菱柱的泰山石雕刻而成的。\n\n三菱柱的侧面是由正方形构成的，每个侧面都刻有数字。能够让铭铭满意的项链必须满足以下条件：\n\n1. 这串项链由 $n$ 颗珠子构成。\n\n2. 每一个珠子上面的每个数字 $x$，必须满足 $0<x\\le a$，且珠子上面三个数字的最大公约数要恰好为 $1$。\n\n3. 相邻的两个珠子必须不同。两个珠子被认为是相同的，当且仅当它们经过旋转，或者翻转后能够变成一样的。\n\n4. 两串项链如果能够经过旋转变成一样的，那么这两串项链被认为是相同的。 \n\n铭铭很好奇如果给定 $n$ 和 $a$，能够找到多少串不同的项链。由于答案可能很大，所以输出答案模上 $10^{9}+7$ 的值。", "inputFormat": "**本题有多组数据**。\n\n第一行给定一个整数 $T$，表示数据组数。  \n接下来 $T$ 行，每行两个整数 $n$ 和 $a$。\n", "outputFormat": "对于每组数据输出一个整数，表示有多少串不同的项链。", "hint": "满足条件的珠子共有三种：`[1,1,1]`,`[1,1,2]`,`[1,2,2]`。\n\n组成的满足条件的串有：`[1,2]`,`[1,3]`,`[2,3]`。\n\n对于 $100\\%$ 的数据，保证 $1 \\le T \\le 10$，$2 \\le n \\le 10^{14}$，$1 \\le a \\le 10^7$。", "locale": "zh-CN"}}}
{"pid": "P3308", "type": "P", "difficulty": 6, "samples": [["1\n6\n3 4 4 2 2 3\n2 1 1 1 1 2\n6 5 4 3 2 1", "4 3\n2 3 6\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "各省省选", "网络流", "山东", "最小割"], "title": "[SDOI2014] LIS", "background": "", "description": "给定序列 $A$，序列中的每一项 $A_i$ 有删除代价 $B_i$ 和附加属性 $C_i$。请删除若干项，使得 $A$ 的最长上升子序列长度减少至少 $1$，且付出的代价之和最小，并输出方案。\n\n如果有多种方案，请输出将删去项的附加属性排序之后，字典序最小的一种。\n", "inputFormat": "输入包含多组数据。    \n\n输入的第一行包含整数 $T$，表示数据组数。接下来 $4T$ 行描述每组数据。    \n\n每组数据的第一行包含一个整数 $N$，表示 $A$ 的项数。\n\n接下来三行，每行 $N$ 个整数 $A_1\\sim A_n$，$B_1\\sim B_n$，$C_1\\sim C_n$，满足 $1\\le A_i,B_i,C_i \\le 10^9$，且 $C_i$ 两两不同。\n", "outputFormat": "对每组数据，输出两行。第一行包含两个整数 $S,M$，依次表示删去项的代价和与数量；接下来一行 $M$ 个整数，表示删去项在 $A$ 中的的位置，按升序输出。\n", "hint": "【样例说明】\n\n删去 $(A_2,A_3,A_6),(A_1,A_6),(A_2,A_3,A_4,A_5)$ 等都是合法的方案，但$(A_2,A_3,A_6)$ 对应的 $C$ 值的字典序最小。\n\n对于 $100\\%$ 的数据，$1\\le N\\le 700$，$1\\le T\\le 5$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2014] LIS", "background": "", "description": "Given a sequence $A$, each element $A_i$ has a deletion cost $B_i$ and an additional attribute $C_i$. Delete some elements so that the length of the longest increasing subsequence of $A$ decreases by at least $1$, while minimizing the sum of deletion costs, and output the solution.\n\nIf there are multiple solutions, output the one whose deleted elements’ additional attributes, after sorting, form the lexicographically smallest sequence.", "inputFormat": "The input contains multiple test cases.\n\nThe first line contains an integer $T$, the number of test cases. The next $4T$ lines describe the test cases.\n\nFor each test case, the first line contains an integer $N$, the number of elements in $A$.\n\nThe next three lines each contain $N$ integers: $A_1\\sim A_n$, $B_1\\sim B_n$, $C_1\\sim C_n$, satisfying $1\\le A_i,B_i,C_i \\le 10^9$, and all $C_i$ are pairwise distinct.", "outputFormat": "For each test case, output two lines. The first line contains two integers $S, M$, denoting the total deletion cost and the number of deleted elements, respectively. The second line contains $M$ integers, the positions in $A$ of the deleted elements, in increasing order.", "hint": "[Sample explanation]\n\nDeleting $(A_2,A_3,A_6)$, $(A_1,A_6)$, $(A_2,A_3,A_4,A_5)$, etc., are all valid solutions, but $(A_2,A_3,A_6)$ yields the lexicographically smallest sequence of $C$ values.\n\nFor $100\\%$ of the testdata, $1\\le N\\le 700$, $1\\le T\\le 5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2014] LIS", "background": "", "description": "给定序列 $A$，序列中的每一项 $A_i$ 有删除代价 $B_i$ 和附加属性 $C_i$。请删除若干项，使得 $A$ 的最长上升子序列长度减少至少 $1$，且付出的代价之和最小，并输出方案。\n\n如果有多种方案，请输出将删去项的附加属性排序之后，字典序最小的一种。\n", "inputFormat": "输入包含多组数据。    \n\n输入的第一行包含整数 $T$，表示数据组数。接下来 $4T$ 行描述每组数据。    \n\n每组数据的第一行包含一个整数 $N$，表示 $A$ 的项数。\n\n接下来三行，每行 $N$ 个整数 $A_1\\sim A_n$，$B_1\\sim B_n$，$C_1\\sim C_n$，满足 $1\\le A_i,B_i,C_i \\le 10^9$，且 $C_i$ 两两不同。\n", "outputFormat": "对每组数据，输出两行。第一行包含两个整数 $S,M$，依次表示删去项的代价和与数量；接下来一行 $M$ 个整数，表示删去项在 $A$ 中的的位置，按升序输出。\n", "hint": "【样例说明】\n\n删去 $(A_2,A_3,A_6),(A_1,A_6),(A_2,A_3,A_4,A_5)$ 等都是合法的方案，但$(A_2,A_3,A_6)$ 对应的 $C$ 值的字典序最小。\n\n对于 $100\\%$ 的数据，$1\\le N\\le 700$，$1\\le T\\le 5$。\n", "locale": "zh-CN"}}}
