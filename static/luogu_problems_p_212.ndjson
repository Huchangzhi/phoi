{"pid": "P5289", "type": "P", "difficulty": 7, "samples": [["2\n2 1\n3 2 2 2\n1 1\n1 2\n1\n1 0\n4 2\n10 30 20 30\n1 6\n2 4\n1 7\n2 4\n2\n2 3\n3 1", "1\n22"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "O2优化"], "title": "[十二省联考 2019] 皮配", "background": "一年一度的综艺节目《中国好码农》又开始了。本季度，好码农由 Yazid、Zayid、小 R、大 R 四位梦想导师坐镇，他们都将组建自己的梦想战队，并率领队员向梦想发起冲击。  \n\n四位导师的**派系**不尽相同，节目组为了营造看点，又将导师分成了不同的**阵营**，与此同时对不同阵营、不同派系都作出了战队总人数限制：\n- 四位导师分成两个**阵营**：\n  - Yazid、小 R 两位导师组成**蓝阵营**，他们两位的战队人数**总和**不得超过 $C_0$。\n  - Zayid、大 R 两位导师组成**红阵营**，他们两位的战队人数**总和**不得超过 $C_1$。\n- 四位导师分成两个**派系**：\n  - Yazid、Zayid 两位导师属于**鸭派系**，他们两位的战队人数**总和**不得超过 $D_0$。\n  - 小 R、大 R 两位导师属于 **R 派系**，他们两位的战队人数**总和**不得超过 $D_1$。", "description": "本季好码农邀请到了全国各路学生精英参赛。他们来自全国 $c$ 个城市的 $n$ 所不同学校（城市的编号从 $1$ 至 $c$，学校的编号从 $1$ 至 $n$）。其中，第 $i$ 所学校所属的城市编号为 $b_i$，且共有 $s_i$ 名选手参赛。  \n\n在【题目背景】中提到的各总人数限制之外，本季度《中国好码农》的导师选择阶段有额外规则如下：\n- 来自同**城市**的所有选手必须加入相同的**阵营**。\n- 来自同**学校**的所有选手必须选择相同的**导师**。\n\n对于导师，大部分学校的学生对导师没有**偏好**。但是有 $k$ 所学校，其中每所学校的学生有且仅有一位他们不喜欢的导师。同一所学校的学生不喜欢的导师相同，他们**不会加入他们不喜欢的导师的战队**。  \n\n面对琳琅满目的规则和选手的偏好，作为好码农忠实观众的你想计算出，在所有选手都进行了战队选择后，战队组成共有多少种可能的局面？\n- 两种战队组成的局面被认为是不同的，当且仅当在存在一所学校，使得在这两种局面中这所学校的选手加入了不同导师的战队。\n- 由于答案可能很大，你只需输出可能局面数对 $998244353$ 取模的结果即可。", "inputFormat": "单个测试点中包含多组数据，输入的第一行包含一个非负整数 $T$ 表示数据组数。接下来依次描述每组数据，对于每组数据：\n- 第 $1$ 行 $2$ 个正整数 $n$, $c$，分别表示学校数目、城市数目。\n- 第 $2$ 行 $4$ 个正整数 $C_0$, $C_1$, $D_0$, $D_1$，分别表示题目中所描述的四个限制。\n- 接下来 $n$ 行每行 $2$ 个正整数：\n  - 这部分中第 $i$ 行的两个数依次为 $b_i$, $s_i$，分别表示第 $i$ 所学校的所属城市以及选手数目。\n  - 保证 $b_i \\leqslant c$，$s_i \\leqslant\\min\\left\\{M, 10\\right\\}$。其中 $M = \\max \\left\\{C_0, C_1, D_0, D_1\\right\\}$。\n- 接下来 $1$ 行一个非负整数 $k$，表示选手有偏好的学校数目。\n- 接下来 $k$ 行，每行 $2$ 个整数 $i$, $p$，描述编号为 $i$ 的学校选手有偏好：\n  - 其中，$p$ 为一个 $0$ 至 $3$ 之间的整数，描述该校选手不喜欢的导师：$0$ 代表 Yazid，$1$ 代表小 R，$2$ 代表 Zayid，$3$ 代表大 R。\n  - 保证 $1 \\leqslant i \\leqslant n$，且各行的 $i$ 互不相同。\n\n对于输入的每一行，如果其包含多个数，则用单个空格将它们隔开。", "outputFormat": "依次输出每组数据的答案，对于每组数据：\n- 一行一个整数，表示可能局面数对 $998244353$ 取模的结果。", "hint": "### 样例 1 解释\n对于第 $1$ 组数据：\n- 唯一的城市 $1$ 包含共 $3$ 名选手，但红阵营的总人数限制为 $2$，无法容纳这些选手，因此他们被迫只能选择蓝阵营。\n- 在此基础上，由于 $1$ 号学校的选手不喜欢 Yazid 老师，因此他们就必须加入 R 派系的小 R 老师麾下。\n- 由于 R 派系总人数限制为 $2$，因此小 R 老师战队无法容纳 $2$ 号学校的选手，所以他们只能被迫加入Yazid 老师战队。\n- 综上所述，可能的局面仅有这一种。\n\n对于第 $2$ 组数据：\n- 一个显然的事实是，$1$ 号城市的所有选手都无法加入蓝阵营，这是因为 $1$ 号城市的选手总人数超过了蓝阵营的总人数限制，因此他们被迫全部加入红阵营。\n- 对于 $2$ 号城市选手加入蓝阵营的情况，稍加计算可得出共有 $15$ 种可能的局面。\n- 对于 $2$ 号城市选手加入红阵营的情况，稍加计算可得出共有 $7$ 种可能的局面。\n- 综上所述，可能的局面数为 $15 + 7 = 22$ 种。\n\n### 数据规模与约定\n::cute-table{tuack}\n\n| 测试点 | $n$ | $c$ | $k$ | $m$ |\n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | $=1$ | $=n$ | $\\le1$ | $=1$ |\n| $2$ | $=10$ | ^ | $\\le10$ | $\\le100$ |\n| $3$ | $=20$ | ^ | $=0$ | ^ |\n| $4$ | $=30$ | ^ | ^ | ^ |\n| $5$ | ^ | ^ | $\\le30$ | $\\le500$ |\n| $6$ | $=500$ | ^ | $=0$ | $\\le1000$ |\n| $7$ | ^ | $=30$ | $=30$ | ^ |\n| $8$ | ^ | $=n$ | ^ | ^ |\n| $9$ | $=1000$ | ^ | $=0$ | $\\le2500$ |\n| $10$ | ^ | ^ | $= 30$ | ^ |\n\n其中，$M = \\max\\left\\{C_0, C_1, D_0, D_1\\right\\}$。\n\n对于所有测试点，保证 $T \\leqslant5$。\n\n对于所有测试点中的每一组数据， 保证 $c \\leqslant n \\leqslant 1000$，$k \\leqslant 30$，$M \\leqslant 2500$，$1 \\leqslant s_i \\leqslant \\min\\left\\{M, 10\\right\\}$。\n\n**另外，请你注意，数据并不保证所有的 $c$ 个城市都有参赛学校。**\n\n### 提示\n另外还有两组附加样例文件，请在附件中下载。\n\n\n十二省联考命题组温馨提醒您：\n\n**数据千万条，清空第一条。**  \n**多测不清空，爆零两行泪。**", "locale": "zh-CN", "translations": {"en": {"title": "[Twelve Provinces Joint Exam 2019] Pipei", "background": "The annual variety show “China’s Best Coder” has started again. This season, the show is led by four “dream mentors”: Yazid, Zayid, Little R, and Big R. Each mentor will form their own team and lead contestants to chase their dreams.\n\nThe four mentors belong to different **factions**. To make the show more interesting, the organizers also divide the mentors into different **camps**, and at the same time impose total team size limits for different camps and different factions:\n- The four mentors are divided into two **camps**:\n  - Yazid and Little R form the **Blue camp**, and the **sum** of their team sizes must not exceed $C_0$.\n  - Zayid and Big R form the **Red camp**, and the **sum** of their team sizes must not exceed $C_1$.\n- The four mentors are divided into two **factions**:\n  - Yazid and Zayid belong to the **Duck faction**, and the **sum** of their team sizes must not exceed $D_0$.\n  - Little R and Big R belong to the **R faction**, and the **sum** of their team sizes must not exceed $D_1$.", "description": "This season, “China’s Best Coder” invites student elites from all over the country to compete. They come from $n$ different schools in $c$ cities nationwide (cities are numbered from $1$ to $c$, and schools are numbered from $1$ to $n$). The city index of school $i$ is $b_i$, and there are $s_i$ contestants from this school.\n\nBesides the total size limits mentioned in **Background**, the mentor selection stage this season has additional rules:\n- All contestants from the same **city** must join the same **camp**.\n- All contestants from the same **school** must choose the same **mentor**.\n\nFor mentors, students from most schools have no **preference**. However, there are $k$ schools where, for each such school, the students have exactly one mentor they dislike. Students in the same school dislike the same mentor, and they **will not join the team of the mentor they dislike**.\n\nWith so many rules and preferences, as a loyal viewer you want to compute: after all contestants have chosen teams, how many different final outcomes are possible?\n- Two outcomes are considered different if and only if there exists a school such that, in the two outcomes, contestants from this school join teams led by different mentors.\n- Since the answer may be large, output it modulo $998244353$.", "inputFormat": "Each test file contains multiple test cases. The first line contains a non-negative integer $T$ indicating the number of test cases. Then each test case is described as follows:\n- Line $1$: two positive integers $n$, $c$, representing the number of schools and the number of cities.\n- Line $2$: four positive integers $C_0$, $C_1$, $D_0$, $D_1$, representing the four limits described in the statement.\n- Next $n$ lines, each with two positive integers:\n  - On line $i$ of this part, the two numbers are $b_i$, $s_i$, representing the city of school $i$ and its number of contestants.\n  - It is guaranteed that $b_i \\leqslant c$, $s_i \\leqslant\\min\\left\\{M, 10\\right\\}$. Here $M = \\max \\left\\{C_0, C_1, D_0, D_1\\right\\}$.\n- Next line: a non-negative integer $k$, the number of schools with preferences.\n- Next $k$ lines, each with two integers $i$, $p$, describing that contestants from school $i$ have a preference:\n  - Here $p$ is an integer from $0$ to $3$, describing the mentor disliked by this school: $0$ means Yazid, $1$ means Little R, $2$ means Zayid, $3$ means Big R.\n  - It is guaranteed that $1 \\leqslant i \\leqslant n$, and all $i$ are distinct.\n\nFor each input line, if it contains multiple numbers, they are separated by a single space.", "outputFormat": "Output the answer for each test case in order:\n- For each test case, output one line with one integer, the number of possible outcomes modulo $998244353$.", "hint": "### Sample 1 Explanation\nFor the $1$st test case:\n- The only city $1$ contains a total of $3$ contestants, but the total size limit of the Red camp is $2$, so it cannot hold these contestants. Therefore, they are forced to choose the Blue camp.\n- Based on this, since contestants from school $1$ dislike mentor Yazid, they must join mentor Little R in the R faction.\n- Because the total size limit of the R faction is $2$, mentor Little R’s team cannot hold the contestants from school $2$, so they are forced to join mentor Yazid’s team.\n- Therefore, there is only one possible outcome.\n\nFor the $2$nd test case:\n- An obvious fact is that all contestants in city $1$ cannot join the Blue camp, because the total number of contestants in city $1$ exceeds the total size limit of the Blue camp, so they are forced to all join the Red camp.\n- If contestants from city $2$ join the Blue camp, a small calculation shows there are $15$ possible outcomes.\n- If contestants from city $2$ join the Red camp, a small calculation shows there are $7$ possible outcomes.\n- Therefore, the number of possible outcomes is $15 + 7 = 22$.\n\n### Constraints and Notes\n::cute-table{tuack}\n\n| Test point | $n$ | $c$ | $k$ | $m$ |\n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | $=1$ | $=n$ | $\\le1$ | $=1$ |\n| $2$ | $=10$ | ^ | $\\le10$ | $\\le100$ |\n| $3$ | $=20$ | ^ | $=0$ | ^ |\n| $4$ | $=30$ | ^ | ^ | ^ |\n| $5$ | ^ | ^ | $\\le30$ | $\\le500$ |\n| $6$ | $=500$ | ^ | $=0$ | $\\le1000$ |\n| $7$ | ^ | $=30$ | $=30$ | ^ |\n| $8$ | ^ | $=n$ | ^ | ^ |\n| $9$ | $=1000$ | ^ | $=0$ | $\\le2500$ |\n| $10$ | ^ | ^ | $= 30$ | ^ |\n\nHere, $M = \\max\\left\\{C_0, C_1, D_0, D_1\\right\\}$.\n\nFor all test points, it is guaranteed that $T \\leqslant5$.\n\nFor each test case in all test points, it is guaranteed that $c \\leqslant n \\leqslant 1000$, $k \\leqslant 30$, $M \\leqslant 2500$, $1 \\leqslant s_i \\leqslant \\min\\left\\{M, 10\\right\\}$.\n\n**Also, note that the testdata does not guarantee that all $c$ cities have participating schools.**\n\n### Additional Hint\nThere are also two additional sample files. Please download them from the attachments.\n\nA warm reminder from the Twelve Provinces Joint Exam problem committee:\n\n**There are thousands of testdata, clearing arrays is the first rule.**  \n**If you forget to clear in multiple tests, you will cry with a zero score.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[十二省联考 2019] 皮配", "background": "一年一度的综艺节目《中国好码农》又开始了。本季度，好码农由 Yazid、Zayid、小 R、大 R 四位梦想导师坐镇，他们都将组建自己的梦想战队，并率领队员向梦想发起冲击。  \n\n四位导师的**派系**不尽相同，节目组为了营造看点，又将导师分成了不同的**阵营**，与此同时对不同阵营、不同派系都作出了战队总人数限制：\n- 四位导师分成两个**阵营**：\n  - Yazid、小 R 两位导师组成**蓝阵营**，他们两位的战队人数**总和**不得超过 $C_0$。\n  - Zayid、大 R 两位导师组成**红阵营**，他们两位的战队人数**总和**不得超过 $C_1$。\n- 四位导师分成两个**派系**：\n  - Yazid、Zayid 两位导师属于**鸭派系**，他们两位的战队人数**总和**不得超过 $D_0$。\n  - 小 R、大 R 两位导师属于 **R 派系**，他们两位的战队人数**总和**不得超过 $D_1$。", "description": "本季好码农邀请到了全国各路学生精英参赛。他们来自全国 $c$ 个城市的 $n$ 所不同学校（城市的编号从 $1$ 至 $c$，学校的编号从 $1$ 至 $n$）。其中，第 $i$ 所学校所属的城市编号为 $b_i$，且共有 $s_i$ 名选手参赛。  \n\n在【题目背景】中提到的各总人数限制之外，本季度《中国好码农》的导师选择阶段有额外规则如下：\n- 来自同**城市**的所有选手必须加入相同的**阵营**。\n- 来自同**学校**的所有选手必须选择相同的**导师**。\n\n对于导师，大部分学校的学生对导师没有**偏好**。但是有 $k$ 所学校，其中每所学校的学生有且仅有一位他们不喜欢的导师。同一所学校的学生不喜欢的导师相同，他们**不会加入他们不喜欢的导师的战队**。  \n\n面对琳琅满目的规则和选手的偏好，作为好码农忠实观众的你想计算出，在所有选手都进行了战队选择后，战队组成共有多少种可能的局面？\n- 两种战队组成的局面被认为是不同的，当且仅当在存在一所学校，使得在这两种局面中这所学校的选手加入了不同导师的战队。\n- 由于答案可能很大，你只需输出可能局面数对 $998244353$ 取模的结果即可。", "inputFormat": "单个测试点中包含多组数据，输入的第一行包含一个非负整数 $T$ 表示数据组数。接下来依次描述每组数据，对于每组数据：\n- 第 $1$ 行 $2$ 个正整数 $n$, $c$，分别表示学校数目、城市数目。\n- 第 $2$ 行 $4$ 个正整数 $C_0$, $C_1$, $D_0$, $D_1$，分别表示题目中所描述的四个限制。\n- 接下来 $n$ 行每行 $2$ 个正整数：\n  - 这部分中第 $i$ 行的两个数依次为 $b_i$, $s_i$，分别表示第 $i$ 所学校的所属城市以及选手数目。\n  - 保证 $b_i \\leqslant c$，$s_i \\leqslant\\min\\left\\{M, 10\\right\\}$。其中 $M = \\max \\left\\{C_0, C_1, D_0, D_1\\right\\}$。\n- 接下来 $1$ 行一个非负整数 $k$，表示选手有偏好的学校数目。\n- 接下来 $k$ 行，每行 $2$ 个整数 $i$, $p$，描述编号为 $i$ 的学校选手有偏好：\n  - 其中，$p$ 为一个 $0$ 至 $3$ 之间的整数，描述该校选手不喜欢的导师：$0$ 代表 Yazid，$1$ 代表小 R，$2$ 代表 Zayid，$3$ 代表大 R。\n  - 保证 $1 \\leqslant i \\leqslant n$，且各行的 $i$ 互不相同。\n\n对于输入的每一行，如果其包含多个数，则用单个空格将它们隔开。", "outputFormat": "依次输出每组数据的答案，对于每组数据：\n- 一行一个整数，表示可能局面数对 $998244353$ 取模的结果。", "hint": "### 样例 1 解释\n对于第 $1$ 组数据：\n- 唯一的城市 $1$ 包含共 $3$ 名选手，但红阵营的总人数限制为 $2$，无法容纳这些选手，因此他们被迫只能选择蓝阵营。\n- 在此基础上，由于 $1$ 号学校的选手不喜欢 Yazid 老师，因此他们就必须加入 R 派系的小 R 老师麾下。\n- 由于 R 派系总人数限制为 $2$，因此小 R 老师战队无法容纳 $2$ 号学校的选手，所以他们只能被迫加入Yazid 老师战队。\n- 综上所述，可能的局面仅有这一种。\n\n对于第 $2$ 组数据：\n- 一个显然的事实是，$1$ 号城市的所有选手都无法加入蓝阵营，这是因为 $1$ 号城市的选手总人数超过了蓝阵营的总人数限制，因此他们被迫全部加入红阵营。\n- 对于 $2$ 号城市选手加入蓝阵营的情况，稍加计算可得出共有 $15$ 种可能的局面。\n- 对于 $2$ 号城市选手加入红阵营的情况，稍加计算可得出共有 $7$ 种可能的局面。\n- 综上所述，可能的局面数为 $15 + 7 = 22$ 种。\n\n### 数据规模与约定\n::cute-table{tuack}\n\n| 测试点 | $n$ | $c$ | $k$ | $m$ |\n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | $=1$ | $=n$ | $\\le1$ | $=1$ |\n| $2$ | $=10$ | ^ | $\\le10$ | $\\le100$ |\n| $3$ | $=20$ | ^ | $=0$ | ^ |\n| $4$ | $=30$ | ^ | ^ | ^ |\n| $5$ | ^ | ^ | $\\le30$ | $\\le500$ |\n| $6$ | $=500$ | ^ | $=0$ | $\\le1000$ |\n| $7$ | ^ | $=30$ | $=30$ | ^ |\n| $8$ | ^ | $=n$ | ^ | ^ |\n| $9$ | $=1000$ | ^ | $=0$ | $\\le2500$ |\n| $10$ | ^ | ^ | $= 30$ | ^ |\n\n其中，$M = \\max\\left\\{C_0, C_1, D_0, D_1\\right\\}$。\n\n对于所有测试点，保证 $T \\leqslant5$。\n\n对于所有测试点中的每一组数据， 保证 $c \\leqslant n \\leqslant 1000$，$k \\leqslant 30$，$M \\leqslant 2500$，$1 \\leqslant s_i \\leqslant \\min\\left\\{M, 10\\right\\}$。\n\n**另外，请你注意，数据并不保证所有的 $c$ 个城市都有参赛学校。**\n\n### 提示\n另外还有两组附加样例文件，请在附件中下载。\n\n\n十二省联考命题组温馨提醒您：\n\n**数据千万条，清空第一条。**  \n**多测不清空，爆零两行泪。**", "locale": "zh-CN"}}}
{"pid": "P5290", "type": "P", "difficulty": 6, "samples": [["5\n10 20 20 30 30\n1 1 2 2", "60"], ["10\n2 1 1 1 1 2 1 1 1 2\n1 1 1 4 5 3 3 4 3", "6"], ["15\n10 1 10 10 2 6 9 6 8 6 3 4 4 5 5\n1 2 2 1 5 4 4 1 2 10 1 9 6 1", "31"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["贪心", "2019", "线段树", "各省省选", "树上启发式合并", "O2优化", "启发式合并"], "title": "[十二省联考 2019] 春节十二响", "background": "“清明时节雨纷纷，路上行人欲断魂。”\n\n$2075$ 年的清明没有春雨。在漫天飞雪的笼罩下，穿行在冰原间的，只有载着人类微薄希望的雪地车。\n\n遥遥 $4.22$ 光年的征途，对于地球这孤独的旅人而言，恐怕也是无比寂寞吧。", "description": "距离苏拉威西只有一百公里了，车内的空气比窗外更加冰冷。四双眼睛紧盯着艾莉\n芬面前的屏幕，那是控制行星发动机的关键程序：春节十二响。他需要将其部署到电力控制系统的一个芯片中。\n\n“春节十二响”由 $n$ 个子程序构成，第 $i$ 个子程序所需的内存空间是 $M_i$。这 $n$ 个子程序之间的调用关系构成了一棵以第 $1$ 个子程序为根的树，其中第 $i$ 个子程序在调用树上的父亲是第 $f_i$ 个子程序。\n\n由于内存紧张，电力控制芯片上提供了一种内存分段机制。你可以将内存分为若干\n个段 $S_1$, $S_2$, ..., $S_k$，并将每个程序预先分配到一个固定的段。如果两个子程序没有直接或间接的调用关系，则他们可以被分配到同一个段中，反之则不能。换言之，当且仅当 $a$ 和 $b$ 在调用树上**不是祖先—后代关系**，$a$ 和 $b$ 可以被分配到同一个段中。\n\n一个段的大小应当是所有分配到这个段的子程序所需内存大小的最大值，所有段\n大小的和不能超过系统的内存大小。\n\n现在艾莉芬想要知道，电力控制芯片至少要有多少内存，才能保证春节十二响的正\n确运行。即：最少需要多大的内存，才能通过先**将内存分成若干个段**，再**把每个子程序分配到一个段中，使得每个段中分配的所有子程序之间不存在祖先—后代关系**。", "inputFormat": "第一行包含一个正整数 $n$ 表示子程序的个数，其中 $n \\leqslant 2 \\times 10^5$。\n\n第二行有 $n$ 个用空格隔开的正整数 $M_1$, $M_2$, ..., $M_n$，$M_i$ 表示第 $i$ 个子程序所需的内存空间。\n\n第三行有 $n - 1$ 个用空格隔开的正整数 $f_2$, $f_3$, ..., $f_n$，满足 $f_i < i$，表示第 $i$ 个子程序在调用树上的父亲是第 $f_i$ 个子程序。", "outputFormat": "仅一个整数，表示最小的内存需求。", "hint": "#### 样例 $1$ 解释\n在最优方案中，内存被划分为大小为 $10$，$20$，$30$ 的三个段，其中第 $1$ 个子程序被分配在第 $1$ 个段中，第 $2$、$3$ 个子程序被分配在第 $2$ 个段中，第 $4$、$5$ 个子程序被分配在第 $3$ 个段中。可以证明，不存在更优的方案。\n\n#### 子任务\n![img](https://s2.ax1x.com/2019/04/07/AhSGzd.png)\n\n注意：在第 $10$、$11$、$12$ 号测试点中，$1$ 号子程序**不一定**是链的一个端点。\n\n其中 $M$ 是所有子内存需求的最大值，即 $\\max\\left\\{M_i\\right\\}$。\n\n对于全部数据，$1 \\leqslant n \\leqslant2 \\times 10^5$，$1 \\leqslant M \\leqslant 10^9$。\n\n艾莉芬经过仔细阅读题面、认真分析数据范围后，开始编写程序求解这个问题。\n\n$\\texttt{\\$$$ login Elephant}$\n\n$\\texttt{password: ********}$\n\n艾莉芬，高级程序员。豫阳市第三工程组提醒您：\n\n- 做题千万条，读题第一条；\n\n- 编程不规范，爆零两行泪。\n\n$\\texttt{\\$$$ cd spring}$\n\n$\\texttt{\\$$$ ac spring}$\n\n$\\texttt{Spring Accepted. Score: 100/100.}$", "locale": "zh-CN", "translations": {"en": {"title": "[12-Province Joint Exam 2019] Twelve Firecrackers for the Spring Festival", "background": "“During Qingming, the rain falls in torrents; on the road, travelers are heartbroken.”\n\nIn the year $2075$, there was no spring rain during Qingming. Under the cover of snow filling the sky, the only thing moving through the icy wasteland was a snow vehicle carrying humanity’s faint hope.\n\nA journey of $4.22$ light-years ahead, for Earth, this lonely traveler, is probably extremely lonely too.", "description": "Only one hundred kilometers remain to Sulawesi, and the air inside the vehicle is even colder than outside the window. Four pairs of eyes stare at the screen in front of Elephant, which shows the key program that controls the planetary engine: Twelve Firecrackers for the Spring Festival. He needs to deploy it onto a chip in the power control system.\n\n“Twelve Firecrackers for the Spring Festival” consists of $n$ subprograms. The memory required by the $i$-th subprogram is $M_i$. The call relationships among these $n$ subprograms form a tree rooted at subprogram $1$, where the parent of subprogram $i$ in the call tree is subprogram $f_i$.\n\nBecause memory is tight, the power-control chip provides a memory segmentation mechanism. You can divide memory into several segments $S_1$, $S_2$, ..., $S_k$, and pre-assign each program to a fixed segment. If two subprograms have neither a direct nor an indirect call relationship, then they can be assigned to the same segment; otherwise, they cannot. In other words, if and only if $a$ and $b$ are **not in an ancestor–descendant relationship** in the call tree, $a$ and $b$ may be assigned to the same segment.\n\nThe size of a segment should be the maximum memory requirement among all subprograms assigned to that segment. The sum of the sizes of all segments must not exceed the total memory size of the system.\n\nNow Elephant wants to know the minimum memory the power-control chip must have to guarantee the correct running of Twelve Firecrackers for the Spring Festival. That is: what is the minimum memory needed such that, by first **dividing memory into several segments**, and then **assigning each subprogram to one segment so that no two subprograms within the same segment have an ancestor–descendant relationship**, the program can run correctly.", "inputFormat": "The first line contains a positive integer $n$ representing the number of subprograms, where $n \\leqslant 2 \\times 10^5$.\n\nThe second line contains $n$ positive integers $M_1$, $M_2$, ..., $M_n$ separated by spaces, where $M_i$ denotes the memory required by the $i$-th subprogram.\n\nThe third line contains $n - 1$ positive integers $f_2$, $f_3$, ..., $f_n$ separated by spaces, satisfying $f_i < i$, meaning that the parent of the $i$-th subprogram in the call tree is subprogram $f_i$.", "outputFormat": "Only one integer, representing the minimum required memory.", "hint": "#### Explanation of Sample $1$.\nIn the optimal plan, the memory is divided into three segments of sizes $10$, $20$, and $30$. Subprogram $1$ is assigned to the first segment, subprograms $2$ and $3$ are assigned to the second segment, and subprograms $4$ and $5$ are assigned to the third segment. It can be proven that no better plan exists.\n\n#### Subtasks\n![img](https://s2.ax1x.com/2019/04/07/AhSGzd.png)\n\nNote: In test points $10$, $11$, and $12$, subprogram $1$ is **not necessarily** an endpoint of the chain.\n\nHere, $M$ is the maximum memory requirement among all subprograms, i.e., $\\max\\left\\{M_i\\right\\}$.\n\nFor all data, $1 \\leqslant n \\leqslant2 \\times 10^5$, $1 \\leqslant M \\leqslant 10^9$.\n\nAfter carefully reading the statement and analyzing the Constraints, Elephant begins to write a program to solve this problem.\n\n$\\texttt{\\$$$ login Elephant}$\n\n$\\texttt{password: ********}$\n\nElephant, senior programmer. The third engineering team of Yushi City reminds you:\n\n- There are a thousand rules for solving problems, but reading the statement is the first rule;\n\n- Non-standard coding leads to zero points and tears.\n\n$\\texttt{\\$$$ cd spring}$\n\n$\\texttt{\\$$$ ac spring}$\n\n$\\texttt{Spring Accepted. Score: 100/100.}$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[十二省联考 2019] 春节十二响", "background": "“清明时节雨纷纷，路上行人欲断魂。”\n\n$2075$ 年的清明没有春雨。在漫天飞雪的笼罩下，穿行在冰原间的，只有载着人类微薄希望的雪地车。\n\n遥遥 $4.22$ 光年的征途，对于地球这孤独的旅人而言，恐怕也是无比寂寞吧。", "description": "距离苏拉威西只有一百公里了，车内的空气比窗外更加冰冷。四双眼睛紧盯着艾莉\n芬面前的屏幕，那是控制行星发动机的关键程序：春节十二响。他需要将其部署到电力控制系统的一个芯片中。\n\n“春节十二响”由 $n$ 个子程序构成，第 $i$ 个子程序所需的内存空间是 $M_i$。这 $n$ 个子程序之间的调用关系构成了一棵以第 $1$ 个子程序为根的树，其中第 $i$ 个子程序在调用树上的父亲是第 $f_i$ 个子程序。\n\n由于内存紧张，电力控制芯片上提供了一种内存分段机制。你可以将内存分为若干\n个段 $S_1$, $S_2$, ..., $S_k$，并将每个程序预先分配到一个固定的段。如果两个子程序没有直接或间接的调用关系，则他们可以被分配到同一个段中，反之则不能。换言之，当且仅当 $a$ 和 $b$ 在调用树上**不是祖先—后代关系**，$a$ 和 $b$ 可以被分配到同一个段中。\n\n一个段的大小应当是所有分配到这个段的子程序所需内存大小的最大值，所有段\n大小的和不能超过系统的内存大小。\n\n现在艾莉芬想要知道，电力控制芯片至少要有多少内存，才能保证春节十二响的正\n确运行。即：最少需要多大的内存，才能通过先**将内存分成若干个段**，再**把每个子程序分配到一个段中，使得每个段中分配的所有子程序之间不存在祖先—后代关系**。", "inputFormat": "第一行包含一个正整数 $n$ 表示子程序的个数，其中 $n \\leqslant 2 \\times 10^5$。\n\n第二行有 $n$ 个用空格隔开的正整数 $M_1$, $M_2$, ..., $M_n$，$M_i$ 表示第 $i$ 个子程序所需的内存空间。\n\n第三行有 $n - 1$ 个用空格隔开的正整数 $f_2$, $f_3$, ..., $f_n$，满足 $f_i < i$，表示第 $i$ 个子程序在调用树上的父亲是第 $f_i$ 个子程序。", "outputFormat": "仅一个整数，表示最小的内存需求。", "hint": "#### 样例 $1$ 解释\n在最优方案中，内存被划分为大小为 $10$，$20$，$30$ 的三个段，其中第 $1$ 个子程序被分配在第 $1$ 个段中，第 $2$、$3$ 个子程序被分配在第 $2$ 个段中，第 $4$、$5$ 个子程序被分配在第 $3$ 个段中。可以证明，不存在更优的方案。\n\n#### 子任务\n![img](https://s2.ax1x.com/2019/04/07/AhSGzd.png)\n\n注意：在第 $10$、$11$、$12$ 号测试点中，$1$ 号子程序**不一定**是链的一个端点。\n\n其中 $M$ 是所有子内存需求的最大值，即 $\\max\\left\\{M_i\\right\\}$。\n\n对于全部数据，$1 \\leqslant n \\leqslant2 \\times 10^5$，$1 \\leqslant M \\leqslant 10^9$。\n\n艾莉芬经过仔细阅读题面、认真分析数据范围后，开始编写程序求解这个问题。\n\n$\\texttt{\\$$$ login Elephant}$\n\n$\\texttt{password: ********}$\n\n艾莉芬，高级程序员。豫阳市第三工程组提醒您：\n\n- 做题千万条，读题第一条；\n\n- 编程不规范，爆零两行泪。\n\n$\\texttt{\\$$$ cd spring}$\n\n$\\texttt{\\$$$ ac spring}$\n\n$\\texttt{Spring Accepted. Score: 100/100.}$", "locale": "zh-CN"}}}
{"pid": "P5291", "type": "P", "difficulty": 7, "samples": [["2 1 2\n1 2", "7"], ["4 1 1\n1 2\n2 3\n3 4", "9"], ["5 1 1\n1 2\n1 3\n2 4\n2 5", "14"], ["12 2 10\n1 2\n2 3\n3 5\n4 5\n5 7\n6 7\n7 8\n8 9\n9 10\n9 11\n11 12\n", "953325149\n"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864, 1572864]}, "tags": ["2019", "各省省选", "树形 DP", "树链剖分", "容斥原理"], "title": "[十二省联考 2019] 希望", "background": "我们所可以自慰的，想来想去，也还是所谓对于将来的希望。\n\n希望是附丽于存在的，有存在，便有希望，有希望，便是光明。", "description": "苏拉威西。距离地球进入木星洛希极限还有 $L$ 单位时间。\n\n蔡德仁收到了来自艾莉芬的“点燃木星计划”。计划要求他将附近所有救援队召集到同一台转向发动机处，清除障碍，并用“春节十二响”程序操纵发动机点燃木星。\n\n转向发动机共有 $n$ 个，它们由 $n - 1$ 条道路相连。任意两个转向发动机都可以通过道路互相到达，二者的距离为其间最短路径的**边数**。\n\n附近一共部署有 $k$ 支救援队 $s_1$, $s_2$, ..., $s_k$，每一支救援队有一个救援范围。救援范围是转向发动机集合的一个连通子集，其中任意两个发动机之间道路上的所有发动机都在救援范围中。\n\n我们称一个发动机 $u$ 可被救援范围为 $S$ 的救援队**到达**，当且仅当 $u$ 在 $S$ 中，且 $S$ 中任意一个发动机 $v$ 到 $u$ 的距离都**不大于** $L$。这样，无论救援队身在岗位的何处，他们都能在时间耗尽前抵达发动机 $u$。\n\n蔡德仁要指挥 $k$ 支救援队集中到同一台发动机处。但由于通讯中断，蔡德仁不知\n道每支救援队的救援范围。他想计算出可行的调度方案数，于是将问题输入电脑。\n\n在这台电脑的另一面——你，需要帮他统计出，在多少种可能的部署方案中存在一\n台能被所有救援队到达的发动机。一个**方案**指一组救援范围 $\\left\\{S_1, S_2, ..., S_k\\right\\}$；两个方案不同，当且仅当某个救援队 $s_i$ 在二者中的救援范围 $S_i$ 不同。在这次联合政府规划的饱和式救援中，两支队伍的救援范围可能**相交**甚至**相同**。\n\n你知道，答案非常大。雪地车在成千上万个地标间穿梭，可能的救援范围浩如烟海，集合所有队伍的方案却寥若晨星。但你没时间绝望，甚至没时间算出那个数字。\n\n你只能算出答案对 $998244353$ 取模的结果。\n\n那就是希望。\n\n即便需要取模，也是光明。", "inputFormat": "第一行包含三个数 $n$，$L$，$k$，依次表示转向发动机的个数，拯救地球剩余的时间，和救援队的个数。\n\n接下来 $n - 1$ 行，每行两个整数 $u$，$v$，表示第 $u$ 个和第 $v$ 个转向发动机之间有一条道路相连。", "outputFormat": "仅一个整数，表示方案数对 $998244353$ 取模的结果。", "hint": "#### 样例 $1$ 解释\n一共有以下几个可行的方案：\n\n| 1 号救援队 | 2 号救援队 |\n| :---------- | :---------- |\n| $\\texttt{\\{1\\}}$ | $\\texttt{\\{1\\}}$ |\n| $\\texttt{\\{1\\}}$ | $\\texttt{\\{1,2\\}}$ |\n| $\\texttt{\\{2\\}}$ | $\\texttt{\\{2\\}}$ |\n| $\\texttt{\\{2\\}}$ | $\\texttt{\\{1,2\\}}$ |\n| $\\texttt{\\{1,2\\}}$ | $\\texttt{\\{1\\}}$ |\n| $\\texttt{\\{1,2\\}}$ | $\\texttt{\\{2\\}}$ |\n| $\\texttt{\\{1,2\\}}$ | $\\texttt{\\{1,2\\}}$ |\n\n#### 样例 $2$ 解释\n只有一个救援队，除了这个救援队的救援范围是全集 $\\texttt{\\{1,2,3,4\\}}$ 之外的所有方案都可行。\n\n#### 样例 $4$ 解释\n\n这个测试点的图如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yownegrq.png)\n\n#### 子任务\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/h64qjcoa.png)\n\n对于所有数据，有 $1 \\leqslant n \\leqslant 10^6$，$0 \\leqslant L \\leqslant n$，$1 \\leqslant k \\leqslant 10$。\n\n~~**请确认程序使用了文件输入输出、没有输出多余调试信息。**~~\n\n蔡德仁抬起头。那是他从未见过的景象——木星占据了大半个天空，绚丽的色彩透过稀薄的大气，变得格外刺眼。\n\n无边的海洋里漂流的小船，不知何时就会被狂风所倾覆；而小船上平凡的我们，也只能怀着渺茫的希望，跟随着舵手指引的航向前行吧。\n\n他走上前按下了 $\\texttt{Enter}$。\n\n\\$ sudo ./spring12biubiu\n\n指令已经发出。\n", "locale": "zh-CN", "translations": {"en": {"title": "[12-Province Joint Exam 2019] Hope", "background": "What we can use to comfort ourselves, after thinking it over again and again, is still the so-called hope for the future.\n\nHope is attached to existence. If there is existence, then there is hope. If there is hope, then there is light.", "description": "Sulawesi. There are still $L$ units of time before Earth enters Jupiter's Roche limit.\n\nCai Deren received from Alifen the \"Ignite Jupiter Plan\". The plan requires him to gather all nearby rescue teams at the same steering engine, clear obstacles, and use the \"Spring Festival Twelve Bangs\" program to control the engine to ignite Jupiter.\n\nThere are $n$ steering engines in total, connected by $n - 1$ roads. Any two steering engines can reach each other through the roads, and the distance between them is the number of edges on the shortest path between them.\n\nThere are $k$ rescue teams deployed nearby: $s_1$, $s_2$, ..., $s_k$. Each rescue team has a rescue range. A rescue range is a connected subset of the set of steering engines, where for any two engines in it, all engines on the road path between them are also within the rescue range.\n\nWe say an engine $u$ can be **reached** by a rescue team whose rescue range is $S$ if and only if $u$ is in $S$, and for every engine $v$ in $S$, the distance from $v$ to $u$ is **no greater than** $L$. In this way, no matter where the rescue team is within its post, they can reach engine $u$ before time runs out.\n\nCai Deren wants to command the $k$ rescue teams to gather at the same engine. But due to communication interruption, Cai Deren does not know each rescue team's rescue range. He wants to compute the number of feasible scheduling plans, so he inputs the problem into a computer.\n\nOn the other side of this computer—you need to help him count, among how many possible deployment plans there exists an engine that can be reached by all rescue teams. A **plan** refers to a set of rescue ranges $\\left\\{S_1, S_2, ..., S_k\\right\\}$. Two plans are different if and only if for some rescue team $s_i$, its rescue range $S_i$ is different in the two plans. In this saturating rescue jointly planned by the government, the rescue ranges of two teams may **intersect** or even be **the same**.\n\nYou know the answer is extremely large. Snow vehicles shuttle among tens of thousands of landmarks; the possible rescue ranges are vast, yet the set of all teams' plans is like a morning star. But you have no time to despair, not even time to compute that number.\n\nYou can only compute the answer modulo $998244353$.\n\nThat is hope.\n\nEven if it needs to be taken modulo, it is still light.", "inputFormat": "The first line contains three numbers $n$, $L$, $k$, representing the number of steering engines, the remaining time to save Earth, and the number of rescue teams.\n\nThe next $n - 1$ lines each contain two integers $u$, $v$, indicating that there is a road connecting the $u$-th and the $v$-th steering engines.", "outputFormat": "Only one integer, representing the number of plans modulo $998244353$.", "hint": "#### Sample $1$ Explanation\nThere are the following feasible plans:\n\n| Rescue Team $1$ | Rescue Team $2$ |\n| :---------- | :---------- |\n| $\\texttt{\\{1\\}}$ | $\\texttt{\\{1\\}}$ |\n| $\\texttt{\\{1\\}}$ | $\\texttt{\\{1,2\\}}$ |\n| $\\texttt{\\{2\\}}$ | $\\texttt{\\{2\\}}$ |\n| $\\texttt{\\{2\\}}$ | $\\texttt{\\{1,2\\}}$ |\n| $\\texttt{\\{1,2\\}}$ | $\\texttt{\\{1\\}}$ |\n| $\\texttt{\\{1,2\\}}$ | $\\texttt{\\{2\\}}$ |\n| $\\texttt{\\{1,2\\}}$ | $\\texttt{\\{1,2\\}}$ |\n\n#### Sample $2$ Explanation\nThere is only one rescue team. All plans are feasible except the one where this rescue team's rescue range is the full set $\\texttt{\\{1,2,3,4\\}}$.\n\n#### Sample $4$ Explanation\n\nThe graph for this test point is shown in the figure below:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yownegrq.png)\n\n#### Subtasks\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/h64qjcoa.png)\n\nFor all data, $1 \\leqslant n \\leqslant 10^6$, $0 \\leqslant L \\leqslant n$, $1 \\leqslant k \\leqslant 10$.\n\n~~**Please confirm that your program uses file input/output and does not print extra debugging information.**~~\n\nCai Deren looked up. It was a scene he had never seen before—Jupiter took up most of the sky, and its brilliant colors, shining through the thin atmosphere, became especially dazzling.\n\nA small boat drifting in a boundless ocean may be overturned by a violent storm at any time; and ordinary people on the boat can only hold on to faint hope, following the heading guided by the helmsman.\n\nHe stepped forward and pressed $\\texttt{Enter}$.\n\n\\$ sudo ./spring12biubiu\n\nThe command has been issued.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[十二省联考 2019] 希望", "background": "我们所可以自慰的，想来想去，也还是所谓对于将来的希望。\n\n希望是附丽于存在的，有存在，便有希望，有希望，便是光明。", "description": "苏拉威西。距离地球进入木星洛希极限还有 $L$ 单位时间。\n\n蔡德仁收到了来自艾莉芬的“点燃木星计划”。计划要求他将附近所有救援队召集到同一台转向发动机处，清除障碍，并用“春节十二响”程序操纵发动机点燃木星。\n\n转向发动机共有 $n$ 个，它们由 $n - 1$ 条道路相连。任意两个转向发动机都可以通过道路互相到达，二者的距离为其间最短路径的**边数**。\n\n附近一共部署有 $k$ 支救援队 $s_1$, $s_2$, ..., $s_k$，每一支救援队有一个救援范围。救援范围是转向发动机集合的一个连通子集，其中任意两个发动机之间道路上的所有发动机都在救援范围中。\n\n我们称一个发动机 $u$ 可被救援范围为 $S$ 的救援队**到达**，当且仅当 $u$ 在 $S$ 中，且 $S$ 中任意一个发动机 $v$ 到 $u$ 的距离都**不大于** $L$。这样，无论救援队身在岗位的何处，他们都能在时间耗尽前抵达发动机 $u$。\n\n蔡德仁要指挥 $k$ 支救援队集中到同一台发动机处。但由于通讯中断，蔡德仁不知\n道每支救援队的救援范围。他想计算出可行的调度方案数，于是将问题输入电脑。\n\n在这台电脑的另一面——你，需要帮他统计出，在多少种可能的部署方案中存在一\n台能被所有救援队到达的发动机。一个**方案**指一组救援范围 $\\left\\{S_1, S_2, ..., S_k\\right\\}$；两个方案不同，当且仅当某个救援队 $s_i$ 在二者中的救援范围 $S_i$ 不同。在这次联合政府规划的饱和式救援中，两支队伍的救援范围可能**相交**甚至**相同**。\n\n你知道，答案非常大。雪地车在成千上万个地标间穿梭，可能的救援范围浩如烟海，集合所有队伍的方案却寥若晨星。但你没时间绝望，甚至没时间算出那个数字。\n\n你只能算出答案对 $998244353$ 取模的结果。\n\n那就是希望。\n\n即便需要取模，也是光明。", "inputFormat": "第一行包含三个数 $n$，$L$，$k$，依次表示转向发动机的个数，拯救地球剩余的时间，和救援队的个数。\n\n接下来 $n - 1$ 行，每行两个整数 $u$，$v$，表示第 $u$ 个和第 $v$ 个转向发动机之间有一条道路相连。", "outputFormat": "仅一个整数，表示方案数对 $998244353$ 取模的结果。", "hint": "#### 样例 $1$ 解释\n一共有以下几个可行的方案：\n\n| 1 号救援队 | 2 号救援队 |\n| :---------- | :---------- |\n| $\\texttt{\\{1\\}}$ | $\\texttt{\\{1\\}}$ |\n| $\\texttt{\\{1\\}}$ | $\\texttt{\\{1,2\\}}$ |\n| $\\texttt{\\{2\\}}$ | $\\texttt{\\{2\\}}$ |\n| $\\texttt{\\{2\\}}$ | $\\texttt{\\{1,2\\}}$ |\n| $\\texttt{\\{1,2\\}}$ | $\\texttt{\\{1\\}}$ |\n| $\\texttt{\\{1,2\\}}$ | $\\texttt{\\{2\\}}$ |\n| $\\texttt{\\{1,2\\}}$ | $\\texttt{\\{1,2\\}}$ |\n\n#### 样例 $2$ 解释\n只有一个救援队，除了这个救援队的救援范围是全集 $\\texttt{\\{1,2,3,4\\}}$ 之外的所有方案都可行。\n\n#### 样例 $4$ 解释\n\n这个测试点的图如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yownegrq.png)\n\n#### 子任务\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/h64qjcoa.png)\n\n对于所有数据，有 $1 \\leqslant n \\leqslant 10^6$，$0 \\leqslant L \\leqslant n$，$1 \\leqslant k \\leqslant 10$。\n\n~~**请确认程序使用了文件输入输出、没有输出多余调试信息。**~~\n\n蔡德仁抬起头。那是他从未见过的景象——木星占据了大半个天空，绚丽的色彩透过稀薄的大气，变得格外刺眼。\n\n无边的海洋里漂流的小船，不知何时就会被狂风所倾覆；而小船上平凡的我们，也只能怀着渺茫的希望，跟随着舵手指引的航向前行吧。\n\n他走上前按下了 $\\texttt{Enter}$。\n\n\\$ sudo ./spring12biubiu\n\n指令已经发出。\n", "locale": "zh-CN"}}}
{"pid": "P5292", "type": "P", "difficulty": 7, "samples": [["5 4 2\n00010\n4 5\n1 3\n4 2\n2 5\n3 5\n1 3\n", "NO\nYES"], ["10 11 10\n0011011111\n4 6\n10 6\n5 9\n4 7\n10 7\n5 8\n1 9\n5 7\n1 10\n5 1\n5 6\n10 3\n7 4\n8 10\n9 4\n8 9\n6 6\n2 2\n9 9\n10 9\n3 4", "NO\nYES\nYES\nNO\nYES\nYES\nYES\nYES\nYES\nNO"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "湖南"], "title": "[HNOI2019] 校园旅行", "background": "HNOI2019 Day2T1", "description": "某学校的每个建筑都有一个独特的编号。一天你在校园里无聊，决定在校园内随意地漫步。\n\n你已经在校园里呆过一段时间，对校园内每个建筑的编号非常熟悉，于是你情不自禁的把周围每个建筑的编号都记了下来——但其实你没有真的记下来，而是把每个建筑的编号除以 2 取余数得到 0 或 1，作为该建筑的标记，多个建筑物的标记连在一起形成一个 01 串。\n\n你对这个串很感兴趣，尤其是对于这个串是回文串的情况，于是你决定研究这个问题。\n\n学校可以看成一张图，建筑是图中的顶点，而某些顶点之间存在无向边。对于每个顶点我们有一个标记（0 或者 1）。每次你会选择图中两个顶点，你想知道这两个顶点之间是否存在一条路径使得路上经过的点的标记形成一个回文串。\n\n一个回文串是一个字符串使得它逆序之后形成的字符串和它自己相同，比如 “010”，“1001” 都是回文串，而 “01”，“110” 不是。注意长度为 1 的串总是回文串，因此如果询问的两个顶点相同，这样的路径总是存在。此外注意，经过的路径不一定为简单路径，也就是说每条边每个顶点都可以经过任意多次。\n", "inputFormat": "输入文件名为 tour.in。\n\n第一行三个整数 $n, m, q$，表示图中的顶点数和边数，以及询问数。\n\n第二行为一个长度为 $n$ 的 01 串，其中第 $i$ 个字符表示第 $i$ 个顶点（即顶点 $i$）的标记，点从 1 开始编号。\n\n接下来 $m$ 行，每一行是两个整数 $u_i, v_i$，表示顶点 $u_i$ 和顶点 $v_i$ 之间有一条无向边，不存在自环或者重边。\n\n接下来 $q$ 行，每一行存在两个整数 $x_i, y_i$，表示询问顶点 $x_i$ 和顶点 $y_i$ 的点之间是否有一条满足条件的路径。\n", "outputFormat": "输出文件名为 tour.out。\n\n输出 $q$ 行，每行一个字符串 “YES”，或者 “NO”（引号不输出）。输出 “YES” 表示满足条件的路径存在，输出 “NO” 表示不存在。", "hint": "【样例解释 1】\n\n对于第一个询问，3 号点和 2 号点不连通，因此答案为 “NO”。\n\n对于第二个询问，一条合法的路径是 1→3，路径上的标号形成的字符串为 “00”。注意合法路径不唯一。 \n\n【数据范围】\n\n对于 $30\\%$ 的数据，$1 \\leq m \\leq 10 ^ 4$；\n\n对于 $70\\%$ 的数据，$1 \\leq n \\leq 3000$，$1 \\leq m \\leq 5\\times 10 ^ 4$；\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 5000$，$1 \\leq m \\leq 5\\times 10 ^ 5$，$1 \\leq q \\leq 10 ^ 5$。\n\n【编译命令】\n\n对于 c++ 语言：g++ -o tour tour.cpp –lm -O2\n\n对于 c 语言：gcc -o tour tour.c –lm -O2\n\n对于 pascal 语言：fpc tour.pas -O2", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2019] Campus Tour", "background": "HNOI2019 Day2T1", "description": "Each building in a school has a unique ID. One day, you feel bored and decide to wander around the campus.\n\nYou have stayed on campus for a while and are very familiar with the IDs of all buildings, so you cannot help writing down the IDs of every nearby building. However, you do not really write down the IDs; instead, you take each building’s ID modulo $2$, getting $0$ or $1$ as the label of that building. Concatenating the labels of multiple buildings forms a 01 string.\n\nYou are very interested in this string, especially when it is a palindrome, so you decide to study this problem.\n\nThe school can be considered as a graph: buildings are vertices, and there are undirected edges between some pairs of vertices. Each vertex has a label ($0$ or $1$). Each time, you choose two vertices in the graph, and you want to know whether there exists a path between these two vertices such that the labels of the vertices visited along the path form a palindrome string.\n\nA palindrome string is a string that is the same after being reversed. For example, “010” and “1001” are palindromes, while “01” and “110” are not. Note that a string of length $1$ is always a palindrome, so if the two queried vertices are the same, such a path always exists. Also note that the path does not have to be a simple path, meaning each edge and each vertex may be visited any number of times.", "inputFormat": "The input file name is tour.in.\n\nThe first line contains three integers $n, m, q$, representing the number of vertices, the number of edges, and the number of queries.\n\nThe second line is a 01 string of length $n$, where the $i$-th character represents the label of the $i$-th vertex (i.e., vertex $i$). Vertices are numbered starting from $1$.\n\nThe next $m$ lines each contain two integers $u_i, v_i$, indicating that there is an undirected edge between vertex $u_i$ and vertex $v_i$. There are no self-loops or multiple edges.\n\nThe next $q$ lines each contain two integers $x_i, y_i$, asking whether there exists a valid path between vertex $x_i$ and vertex $y_i$.", "outputFormat": "The output file name is tour.out.\n\nOutput $q$ lines. Each line contains the string “YES” or “NO” (without quotes). Output “YES” if such a path exists, and “NO” otherwise.", "hint": "[Sample Explanation 1]\n\nFor the first query, vertex $3$ and vertex $2$ are not connected, so the answer is “NO”.\n\nFor the second query, one valid path is $1\\to 3$, and the string formed by the labels on the path is “00”. Note that the valid path is not unique.\n\n[Constraints]\n\nFor $30\\%$ of the testdata, $1 \\leq m \\leq 10 ^ 4$.\n\nFor $70\\%$ of the testdata, $1 \\leq n \\leq 3000$, $1 \\leq m \\leq 5\\times 10 ^ 4$.\n\nFor $100\\%$ of the testdata, $1 \\leq n \\leq 5000$, $1 \\leq m \\leq 5\\times 10 ^ 5$, $1 \\leq q \\leq 10 ^ 5$.\n\n[Compile Commands]\n\nFor C++: g++ -o tour tour.cpp –lm -O2\n\nFor C: gcc -o tour tour.c –lm -O2\n\nFor Pascal: fpc tour.pas -O2\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2019] 校园旅行", "background": "HNOI2019 Day2T1", "description": "某学校的每个建筑都有一个独特的编号。一天你在校园里无聊，决定在校园内随意地漫步。\n\n你已经在校园里呆过一段时间，对校园内每个建筑的编号非常熟悉，于是你情不自禁的把周围每个建筑的编号都记了下来——但其实你没有真的记下来，而是把每个建筑的编号除以 2 取余数得到 0 或 1，作为该建筑的标记，多个建筑物的标记连在一起形成一个 01 串。\n\n你对这个串很感兴趣，尤其是对于这个串是回文串的情况，于是你决定研究这个问题。\n\n学校可以看成一张图，建筑是图中的顶点，而某些顶点之间存在无向边。对于每个顶点我们有一个标记（0 或者 1）。每次你会选择图中两个顶点，你想知道这两个顶点之间是否存在一条路径使得路上经过的点的标记形成一个回文串。\n\n一个回文串是一个字符串使得它逆序之后形成的字符串和它自己相同，比如 “010”，“1001” 都是回文串，而 “01”，“110” 不是。注意长度为 1 的串总是回文串，因此如果询问的两个顶点相同，这样的路径总是存在。此外注意，经过的路径不一定为简单路径，也就是说每条边每个顶点都可以经过任意多次。\n", "inputFormat": "输入文件名为 tour.in。\n\n第一行三个整数 $n, m, q$，表示图中的顶点数和边数，以及询问数。\n\n第二行为一个长度为 $n$ 的 01 串，其中第 $i$ 个字符表示第 $i$ 个顶点（即顶点 $i$）的标记，点从 1 开始编号。\n\n接下来 $m$ 行，每一行是两个整数 $u_i, v_i$，表示顶点 $u_i$ 和顶点 $v_i$ 之间有一条无向边，不存在自环或者重边。\n\n接下来 $q$ 行，每一行存在两个整数 $x_i, y_i$，表示询问顶点 $x_i$ 和顶点 $y_i$ 的点之间是否有一条满足条件的路径。\n", "outputFormat": "输出文件名为 tour.out。\n\n输出 $q$ 行，每行一个字符串 “YES”，或者 “NO”（引号不输出）。输出 “YES” 表示满足条件的路径存在，输出 “NO” 表示不存在。", "hint": "【样例解释 1】\n\n对于第一个询问，3 号点和 2 号点不连通，因此答案为 “NO”。\n\n对于第二个询问，一条合法的路径是 1→3，路径上的标号形成的字符串为 “00”。注意合法路径不唯一。 \n\n【数据范围】\n\n对于 $30\\%$ 的数据，$1 \\leq m \\leq 10 ^ 4$；\n\n对于 $70\\%$ 的数据，$1 \\leq n \\leq 3000$，$1 \\leq m \\leq 5\\times 10 ^ 4$；\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 5000$，$1 \\leq m \\leq 5\\times 10 ^ 5$，$1 \\leq q \\leq 10 ^ 5$。\n\n【编译命令】\n\n对于 c++ 语言：g++ -o tour tour.cpp –lm -O2\n\n对于 c 语言：gcc -o tour tour.c –lm -O2\n\n对于 pascal 语言：fpc tour.pas -O2", "locale": "zh-CN"}}}
{"pid": "P5293", "type": "P", "difficulty": 7, "samples": [["2 2 3 1 1 998244353\n2 1\n1 0", "16\n18"], ["3 4 100 1 3 998244353\n1 1 1\n1 1 1\n1 1 1", "506551216\n528858062\n469849094\n818871911\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "2019", "各省省选", "湖南", "容斥原理", "快速傅里叶变换 FFT"], "title": "[HNOI2019] 白兔之舞", "background": "HNOI2019 day2t2", "description": "有一张顶点数为 $(L+1)\\times n$ 的有向图。这张图的每个顶点由一个二元组$(u,v)$表示$(0\\le u\\le L,1\\le v\\le n)$。\n这张图不是简单图，对于任意两个顶点 $(u_1,v_1)(u_2,v_2)$，如果 $u_1<u_2$，则从 $(u_1,v_1)$ 到 $(u_2,v_2)$ 一共有 $w[v_1][v_2]$ 条不同的边，如果 $u_1\\ge u_2$ 则没有边。\n\n白兔将在这张图上上演一支舞曲。白兔初始时位于该有向图的顶点 $(0,x)$。\n\n白兔将会跳若干步。每一步，白兔会从当前顶点沿任意一条出边跳到下一个顶点。白兔可以在任意时候停止跳舞（也可以没有跳就直接结束）。当到达第一维为 $L$ 的顶点就不得不停止，因为该顶点没有出边。\n\n假设白兔停止时，跳了 $m$ 步，白兔会把这只舞曲给记录下来成为一个序列。序列的第 $i$ 个元素为它第 $i$ 步经过的边。\n\n问题来了：给定正整数 $k$ 和 $y$（$1\\le y\\le n$），对于每个 $t$（$0\\le t<k$），求有多少种舞曲（假设其长度为 $m$）满足 $m \\bmod k=t$，且白兔最后停在了坐标第二维为 $y$ 的顶点？\n\n两支舞曲不同定义为它们的长度（$m$）不同或者存在某一步它们所走的边不同。\n\n输出的结果对 $p$ 取模。\n", "inputFormat": "输入文件名为 dance.in。\n\n第一行五个用空格隔开的整数 $n,k,L,x,y,p$。\n\n接下来 $n$ 行，每行有 $n$ 个用空格隔开的整数，第 $i$ 行的第 $j$ 个数表示 $w[i][j]$。\n", "outputFormat": "输出文件名为 dance.out。\n\n依次输出 $k$ 行，每行一个数表示答案对 $p$ 取模的结果。\n", "hint": "### 样例解释 1\n$t=0$：\n1. 路径长度为 $0$，方案数为 $1$。\n2. 路径长度为 $2$，一共有六类路径：\n    - $(0,1)\\to (1,1)\\to (2,1)$ 该路径有 $w(1,1)\\times w(1,1)=4$ 条；\n    - $(0,1)\\to (1,1)\\to (3,1)$ 该路径有 $w(1,1)\\times w(1,1)=4$ 条；\n    - $(0,1)\\to (2,1)\\to (3,1)$ 该路径有 $w(1,1)\\times w(1,1)=4$ 条；\n    - $(0,1)\\to (1,2)\\to (2,1)$ 该路径有 $w(1,2)\\times w(2,1)=1$ 条；\n    - $(0,1)\\to (1,2)\\to (3,1)$ 该路径有 $w(1,2)\\times w(2,1)=1$ 条；\n    - $(0,1)\\to (2,2)\\to (3,1)$ 该路径有 $w(1,2)\\times w(2,1)=1$ 条；\n\n答案就为 $1+4+4+4+1+1+1=16$。\n\n$t=1$：\n1. 路径长度为 $1$，一共有三类路径：\n    - $(0,1)\\to (1,1)$ 该路径有 $w(1,1)=2$ 条；\n    - $(0,1)\\to (2,1)$ 该路径有 $w(1,1)=2$ 条；\n    - $(0,1)\\to (3,1)$ 该路径有 $w(1,1)=2$ 条；\n2. 路径长度为 $3$，一共有三类路径：\n    - $(0,1)\\to (1,1)\\to (2,1)\\to (3,1)$ 该路径有 $w(1,1)\\times w(1,1)\\times w(1,1)=8$ 条；\n    - $(0,1)\\to (1,1)\\to (2,2)\\to (3,1)$ 该路径有 $w(1,1)\\times w(1,2)\\times w(2,1)=2$ 条；\n    - $(0,1)\\to (1,2)\\to (2,1)\\to (3,1)$ 该路径有 $w(1,2)\\times w(2,1)\\times w(1,1)=2$ 条；\n\n答案就为 $2+2+2+8+2+2=18$。\n\n### 数据范围\n\n对于全部数据，$p$ 为一个质数，$10^8<p<2^{30}$，$1\\le n\\le 3$，$1\\le x\\le n$，$1\\le y\\le n$，$0\\le w(i,j)<p$，$1\\le k\\le 65536$，$k$ 为 $p-1$ 的约数，$1\\le L\\le 10^8$。\n\n对于每组测试点，特殊限制如下：\n- 测试点 $1,2$：$L\\le 10^5$；\n- 测试点 $3$：$n=1,w(1,1)=1$，$k$ 的最大质因子为 $2$；\n- 测试点 $4$：$n=1$，$k$ 的最大质因子为 $2$；\n- 测试点 $5$：$n=1,w(1,1)=1$；\n- 测试点 $6$：$n=1$；\n- 测试点 $7,8$：$k$ 的最大质因子为 $2$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2019] White Rabbit’s Dance", "background": "HNOI2019 day2t2", "description": "There is a directed graph with $(L+1)\\times n$ vertices. Each vertex is represented by an ordered pair $(u,v)$, where $(0\\le u\\le L,1\\le v\\le n)$.\n\nThis graph is not a simple graph. For any two vertices $(u_1,v_1)(u_2,v_2)$, if $u_1<u_2$, then there are exactly $w[v_1][v_2]$ different edges from $(u_1,v_1)$ to $(u_2,v_2)$. If $u_1\\ge u_2$, then there is no edge.\n\nThe white rabbit will perform a dance on this graph. Initially, it is at vertex $(0,x)$.\n\nThe white rabbit will make several jumps. In each jump, it moves from the current vertex to the next vertex along any outgoing edge. It can stop at any time (it may also stop immediately without making any jump). When it reaches a vertex whose first coordinate is $L$, it must stop, because that vertex has no outgoing edges.\n\nSuppose the rabbit stops after making $m$ jumps. It will record this dance as a sequence, whose $i$-th element is the edge it took in its $i$-th jump.\n\nNow, given positive integers $k$ and $y$ ($1\\le y\\le n$), for each $t$ ($0\\le t<k$), find how many dances (with length $m$) satisfy $m \\bmod k=t$, and the rabbit finally stops at a vertex whose second coordinate is $y$.\n\nTwo dances are considered different if their lengths ($m$) are different, or there exists some step at which the edges they take are different.\n\nOutput the results modulo $p$.", "inputFormat": "The input file name is dance.in.\n\nThe first line contains five integers $n,k,L,x,y,p$ separated by spaces.\n\nThen follow $n$ lines, each containing $n$ integers separated by spaces. The $j$-th number in the $i$-th line denotes $w[i][j]$.", "outputFormat": "The output file name is dance.out.\n\nOutput $k$ lines in order, each containing one number: the answer modulo $p$.", "hint": "### Sample Explanation 1\n\n$t=0$:\n1. Path length is $0$, and the number of ways is $1$.\n2. Path length is $2$. There are six types of paths:\n    - $(0,1)\\to (1,1)\\to (2,1)$: this path has $w(1,1)\\times w(1,1)=4$ ways;\n    - $(0,1)\\to (1,1)\\to (3,1)$: this path has $w(1,1)\\times w(1,1)=4$ ways;\n    - $(0,1)\\to (2,1)\\to (3,1)$: this path has $w(1,1)\\times w(1,1)=4$ ways;\n    - $(0,1)\\to (1,2)\\to (2,1)$: this path has $w(1,2)\\times w(2,1)=1$ way;\n    - $(0,1)\\to (1,2)\\to (3,1)$: this path has $w(1,2)\\times w(2,1)=1$ way;\n    - $(0,1)\\to (2,2)\\to (3,1)$: this path has $w(1,2)\\times w(2,1)=1$ way;\n\nSo the answer is $1+4+4+4+1+1+1=16$.\n\n$t=1$:\n1. Path length is $1$. There are three types of paths:\n    - $(0,1)\\to (1,1)$: this path has $w(1,1)=2$ ways;\n    - $(0,1)\\to (2,1)$: this path has $w(1,1)=2$ ways;\n    - $(0,1)\\to (3,1)$: this path has $w(1,1)=2$ ways;\n2. Path length is $3$. There are three types of paths:\n    - $(0,1)\\to (1,1)\\to (2,1)\\to (3,1)$: this path has $w(1,1)\\times w(1,1)\\times w(1,1)=8$ ways;\n    - $(0,1)\\to (1,1)\\to (2,2)\\to (3,1)$: this path has $w(1,1)\\times w(1,2)\\times w(2,1)=2$ ways;\n    - $(0,1)\\to (1,2)\\to (2,1)\\to (3,1)$: this path has $w(1,2)\\times w(2,1)\\times w(1,1)=2$ ways;\n\nSo the answer is $2+2+2+8+2+2=18$.\n\n### Constraints\n\nFor all testdata, $p$ is a prime number, $10^8<p<2^{30}$, $1\\le n\\le 3$, $1\\le x\\le n$, $1\\le y\\le n$, $0\\le w(i,j)<p$, $1\\le k\\le 65536$, $k$ is a divisor of $p-1$, and $1\\le L\\le 10^8$.\n\nFor each test point, the special constraints are as follows:\n- Test points $1,2$: $L\\le 10^5$;\n- Test point $3$: $n=1,w(1,1)=1$, and the largest prime factor of $k$ is $2$;\n- Test point $4$: $n=1$, and the largest prime factor of $k$ is $2$;\n- Test point $5$: $n=1,w(1,1)=1$;\n- Test point $6$: $n=1$;\n- Test points $7,8$: the largest prime factor of $k$ is $2$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2019] 白兔之舞", "background": "HNOI2019 day2t2", "description": "有一张顶点数为 $(L+1)\\times n$ 的有向图。这张图的每个顶点由一个二元组$(u,v)$表示$(0\\le u\\le L,1\\le v\\le n)$。\n这张图不是简单图，对于任意两个顶点 $(u_1,v_1)(u_2,v_2)$，如果 $u_1<u_2$，则从 $(u_1,v_1)$ 到 $(u_2,v_2)$ 一共有 $w[v_1][v_2]$ 条不同的边，如果 $u_1\\ge u_2$ 则没有边。\n\n白兔将在这张图上上演一支舞曲。白兔初始时位于该有向图的顶点 $(0,x)$。\n\n白兔将会跳若干步。每一步，白兔会从当前顶点沿任意一条出边跳到下一个顶点。白兔可以在任意时候停止跳舞（也可以没有跳就直接结束）。当到达第一维为 $L$ 的顶点就不得不停止，因为该顶点没有出边。\n\n假设白兔停止时，跳了 $m$ 步，白兔会把这只舞曲给记录下来成为一个序列。序列的第 $i$ 个元素为它第 $i$ 步经过的边。\n\n问题来了：给定正整数 $k$ 和 $y$（$1\\le y\\le n$），对于每个 $t$（$0\\le t<k$），求有多少种舞曲（假设其长度为 $m$）满足 $m \\bmod k=t$，且白兔最后停在了坐标第二维为 $y$ 的顶点？\n\n两支舞曲不同定义为它们的长度（$m$）不同或者存在某一步它们所走的边不同。\n\n输出的结果对 $p$ 取模。\n", "inputFormat": "输入文件名为 dance.in。\n\n第一行五个用空格隔开的整数 $n,k,L,x,y,p$。\n\n接下来 $n$ 行，每行有 $n$ 个用空格隔开的整数，第 $i$ 行的第 $j$ 个数表示 $w[i][j]$。\n", "outputFormat": "输出文件名为 dance.out。\n\n依次输出 $k$ 行，每行一个数表示答案对 $p$ 取模的结果。\n", "hint": "### 样例解释 1\n$t=0$：\n1. 路径长度为 $0$，方案数为 $1$。\n2. 路径长度为 $2$，一共有六类路径：\n    - $(0,1)\\to (1,1)\\to (2,1)$ 该路径有 $w(1,1)\\times w(1,1)=4$ 条；\n    - $(0,1)\\to (1,1)\\to (3,1)$ 该路径有 $w(1,1)\\times w(1,1)=4$ 条；\n    - $(0,1)\\to (2,1)\\to (3,1)$ 该路径有 $w(1,1)\\times w(1,1)=4$ 条；\n    - $(0,1)\\to (1,2)\\to (2,1)$ 该路径有 $w(1,2)\\times w(2,1)=1$ 条；\n    - $(0,1)\\to (1,2)\\to (3,1)$ 该路径有 $w(1,2)\\times w(2,1)=1$ 条；\n    - $(0,1)\\to (2,2)\\to (3,1)$ 该路径有 $w(1,2)\\times w(2,1)=1$ 条；\n\n答案就为 $1+4+4+4+1+1+1=16$。\n\n$t=1$：\n1. 路径长度为 $1$，一共有三类路径：\n    - $(0,1)\\to (1,1)$ 该路径有 $w(1,1)=2$ 条；\n    - $(0,1)\\to (2,1)$ 该路径有 $w(1,1)=2$ 条；\n    - $(0,1)\\to (3,1)$ 该路径有 $w(1,1)=2$ 条；\n2. 路径长度为 $3$，一共有三类路径：\n    - $(0,1)\\to (1,1)\\to (2,1)\\to (3,1)$ 该路径有 $w(1,1)\\times w(1,1)\\times w(1,1)=8$ 条；\n    - $(0,1)\\to (1,1)\\to (2,2)\\to (3,1)$ 该路径有 $w(1,1)\\times w(1,2)\\times w(2,1)=2$ 条；\n    - $(0,1)\\to (1,2)\\to (2,1)\\to (3,1)$ 该路径有 $w(1,2)\\times w(2,1)\\times w(1,1)=2$ 条；\n\n答案就为 $2+2+2+8+2+2=18$。\n\n### 数据范围\n\n对于全部数据，$p$ 为一个质数，$10^8<p<2^{30}$，$1\\le n\\le 3$，$1\\le x\\le n$，$1\\le y\\le n$，$0\\le w(i,j)<p$，$1\\le k\\le 65536$，$k$ 为 $p-1$ 的约数，$1\\le L\\le 10^8$。\n\n对于每组测试点，特殊限制如下：\n- 测试点 $1,2$：$L\\le 10^5$；\n- 测试点 $3$：$n=1,w(1,1)=1$，$k$ 的最大质因子为 $2$；\n- 测试点 $4$：$n=1$，$k$ 的最大质因子为 $2$；\n- 测试点 $5$：$n=1,w(1,1)=1$；\n- 测试点 $6$：$n=1$；\n- 测试点 $7,8$：$k$ 的最大质因子为 $2$。", "locale": "zh-CN"}}}
{"pid": "P5294", "type": "P", "difficulty": 7, "samples": [["5 3\n9 2 4 6 4\n1 1\n1 4\n5 6", "28\n2\n4\n26"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "湖南"], "title": "[HNOI2019] 序列", "background": "HNOI2019 day2t3", "description": "给定一个长度为 $n$ 的序列 $A_1,A_2,\\dots, A_n$，以及 $m$ 个操作，每个操作将一个 $A_i$ 修改为 $k$。第一次修改之前及每次修改之后，都要求你找到一个同样长度为 $n$ 的**单调不降**序列 $B_1,B_2,\\dots ,B_n$，使得 $\\sum\\limits_{i=1}^n(A_i-B_i)^2$ 最小，并输出最小值。\n\n需要注意的是每次操作的影响都是独立的，也即每次操作只会对当前询问造成影响。\n\n为了避免精度问题，我们保证这个最小值是个分数，也即能表示为两个非负整数相除的形式：$\\dfrac{x}{y}$。那么你将要输出 $(x\\times y^{P-2}\\bmod P)$ 的值，表示模意义下 $\\dfrac{x}{y}$ 的值。其中 $P=998244353$ 是一个大质数。", "inputFormat": "第一行两个非负整数 $n,m$，代表序列长度和操作数。\n\n第二行有 $n$ 个由空格隔开的正整数，代表序列 $A_1\\sim A_n$。\n\n接下来 $m$ 行每行两个正整数 $i,k$，代表将 $A_i$ 修改为 $k$。", "outputFormat": "输出 $m+1$ 行每行一个整数，第 $i$ 行输出第 $i-1$ 次修改后的答案。特别的，第 $1$ 行应为初始局面的答案。", "hint": "### 【样例解释】\n\n第一个询问的最优 $B$ 序列为：$\\{5, 5, 5, 5, 5\\}$。\n\n第二个询问的最优 $B$ 序列为：$\\{1, 2, 4, 5, 5\\}$。\n\n第三个询问的最优 $B$ 序列为：$\\{3, 3, 4, 5, 5\\}$。\n\n第四个询问的最优 $B$ 序列为：$\\{5, 5, 5, 6, 6\\}$。\n\n样例是存在最优方案使 $B_i$ 皆为整数的特殊情况。\n\n### 【数据范围与约定】\n\n对于前 $10\\%$ 的数据，保证 $n,m\\le 10$，$k,A_i\\le 10^3$，且存在一种最优方案，使得 $B_i$ 皆为整数。\n\n对于前 $30\\%$ 的数据，保证 $n,m\\le 100$。\n\n对于另外 $20\\%$ 的数据，保证 $m = 0$。\n\n对于另外 $20\\%$ 的数据，保证 $n,m \\le 3 \\times  10^4$。\n\n对于所有数据，保证 $3 \\le n \\le 10^5,0 \\le m \\le 10^5,1 \\le k, A_i \\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2019] Sequence", "background": "HNOI2019 day2t3", "description": "Given a sequence $A_1,A_2,\\dots,A_n$ of length $n$, and $m$ operations. Each operation changes some $A_i$ to $k$. Before the first change and after each change, you need to find a **non-decreasing** sequence $B_1,B_2,\\dots,B_n$ of the same length $n$, such that $\\sum\\limits_{i=1}^n (A_i-B_i)^2$ is minimized, and output this minimum value.\n\nNote that the effect of each operation is independent, i.e. each operation only affects the current query.\n\nTo avoid precision issues, we guarantee that this minimum value is a fraction, i.e. it can be written as $\\dfrac{x}{y}$ where $x$ and $y$ are non-negative integers. Then you should output $(x \\times y^{P-2} \\bmod P)$, which represents $\\dfrac{x}{y}$ under modulo arithmetic. Here $P=998244353$ is a large prime.", "inputFormat": "The first line contains two non-negative integers $n,m$, representing the sequence length and the number of operations.\n\nThe second line contains $n$ positive integers separated by spaces, representing $A_1\\sim A_n$.\n\nThe next $m$ lines each contain two positive integers $i,k$, meaning to change $A_i$ to $k$.", "outputFormat": "Output $m+1$ lines, each containing one integer. The $i$-th line should output the answer after the $(i-1)$-th change. In particular, the first line should be the answer for the initial state.", "hint": "### Sample Explanation\n\nFor the first query, an optimal sequence $B$ is $\\{5, 5, 5, 5, 5\\}$.\n\nFor the second query, an optimal sequence $B$ is $\\{1, 2, 4, 5, 5\\}$.\n\nFor the third query, an optimal sequence $B$ is $\\{3, 3, 4, 5, 5\\}$.\n\nFor the fourth query, an optimal sequence $B$ is $\\{5, 5, 5, 6, 6\\}$.\n\nThe sample is a special case where there exists an optimal solution with all $B_i$ being integers.\n\n### Constraints and Notes\n\nFor the first $10\\%$ of the testdata, it is guaranteed that $n,m\\le 10$, $k,A_i\\le 10^3$, and there exists an optimal solution with all $B_i$ being integers.\n\nFor the first $30\\%$ of the testdata, it is guaranteed that $n,m\\le 100$.\n\nFor another $20\\%$ of the testdata, it is guaranteed that $m = 0$.\n\nFor another $20\\%$ of the testdata, it is guaranteed that $n,m \\le 3 \\times 10^4$.\n\nFor all testdata, it is guaranteed that $3 \\le n \\le 10^5$, $0 \\le m \\le 10^5$, $1 \\le k, A_i \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2019] 序列", "background": "HNOI2019 day2t3", "description": "给定一个长度为 $n$ 的序列 $A_1,A_2,\\dots, A_n$，以及 $m$ 个操作，每个操作将一个 $A_i$ 修改为 $k$。第一次修改之前及每次修改之后，都要求你找到一个同样长度为 $n$ 的**单调不降**序列 $B_1,B_2,\\dots ,B_n$，使得 $\\sum\\limits_{i=1}^n(A_i-B_i)^2$ 最小，并输出最小值。\n\n需要注意的是每次操作的影响都是独立的，也即每次操作只会对当前询问造成影响。\n\n为了避免精度问题，我们保证这个最小值是个分数，也即能表示为两个非负整数相除的形式：$\\dfrac{x}{y}$。那么你将要输出 $(x\\times y^{P-2}\\bmod P)$ 的值，表示模意义下 $\\dfrac{x}{y}$ 的值。其中 $P=998244353$ 是一个大质数。", "inputFormat": "第一行两个非负整数 $n,m$，代表序列长度和操作数。\n\n第二行有 $n$ 个由空格隔开的正整数，代表序列 $A_1\\sim A_n$。\n\n接下来 $m$ 行每行两个正整数 $i,k$，代表将 $A_i$ 修改为 $k$。", "outputFormat": "输出 $m+1$ 行每行一个整数，第 $i$ 行输出第 $i-1$ 次修改后的答案。特别的，第 $1$ 行应为初始局面的答案。", "hint": "### 【样例解释】\n\n第一个询问的最优 $B$ 序列为：$\\{5, 5, 5, 5, 5\\}$。\n\n第二个询问的最优 $B$ 序列为：$\\{1, 2, 4, 5, 5\\}$。\n\n第三个询问的最优 $B$ 序列为：$\\{3, 3, 4, 5, 5\\}$。\n\n第四个询问的最优 $B$ 序列为：$\\{5, 5, 5, 6, 6\\}$。\n\n样例是存在最优方案使 $B_i$ 皆为整数的特殊情况。\n\n### 【数据范围与约定】\n\n对于前 $10\\%$ 的数据，保证 $n,m\\le 10$，$k,A_i\\le 10^3$，且存在一种最优方案，使得 $B_i$ 皆为整数。\n\n对于前 $30\\%$ 的数据，保证 $n,m\\le 100$。\n\n对于另外 $20\\%$ 的数据，保证 $m = 0$。\n\n对于另外 $20\\%$ 的数据，保证 $n,m \\le 3 \\times  10^4$。\n\n对于所有数据，保证 $3 \\le n \\le 10^5,0 \\le m \\le 10^5,1 \\le k, A_i \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5295", "type": "P", "difficulty": 7, "samples": [["3\n3 3\n1 2\n1 3\n2 3\n2 3\n1 2\n1 2\n1 2\n4 6\n1 2\n1 3\n2 4\n1 3\n2 3\n3 4", "Yes\nNo\nYes"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["图论", "2019", "网络流", "北京", "O2优化"], "title": "[北京省选集训2019] 图的难题", "background": "标题是假的。", "description": "小 D 在图论习题书上遇到了一个问题：\n\n书上画出了一张无向图，要求把边染成黑白两色，要求所有白色边构成的子图没有环，且所有黑色边构成的子图没有环。\n\n小 D 无论怎样尝试都觉得书上的问题没有解，她想请你帮她确认一下。\n\n由于这道题有很多小问，小 D 每次会给你图的点数 $n$、边数 $m$ 与所有边集，你只需要告诉小 D 有没有解即可。", "inputFormat": "第一行一个正整数 $T$，表示数据组数。\n\n对于每组数据，第一行两个正整数 $n,m$，意义如题目描述。\n\n接下来 $m$ 行，每行两个正整数 $u,v$，表示一条 $u$ 到 $v$ 的无向边。", "outputFormat": "输出 $T$ 行，对于每组数据，若有解输出 `Yes`，否则输出 `No`。", "hint": "### 数据范围：  \n\n对于 $20\\%$ 的数据：$1\\le m \\le 10$。\n\n对于 $40\\%$ 的数据：$1\\le n \\le 15$。\n\n对于 $70\\%$ 的数据：$1\\le n \\le 50$。\n\n对于 $100\\%$ 的数据：$1\\le n \\le 501$，$1\\le m \\le 2n$，$1\\le T \\le 10$。", "locale": "zh-CN", "translations": {"en": {"title": "[Beijing NOI Qualifier Training 2019] A Hard Problem on Graphs", "background": "The title is fake.", "description": "Xiao D encountered a problem in a graph theory exercise book:\n\nThe book shows an undirected graph and asks you to color each edge either black or white, such that the subgraph formed by all white edges has no cycles, and the subgraph formed by all black edges also has no cycles.\n\nNo matter how she tries, Xiao D feels that the problem in the book has no solution. She wants you to help confirm this.\n\nSince this problem has many subtasks, each time Xiao D will give you the number of vertices $n$, the number of edges $m$, and the full edge set. You only need to tell Xiao D whether a solution exists.", "inputFormat": "The first line contains a positive integer $T$, denoting the number of test cases.\n\nFor each test case, the first line contains two positive integers $n,m$, with the meaning as described in the statement.\n\nThen follow $m$ lines. Each line contains two positive integers $u,v$, denoting an undirected edge from $u$ to $v$.", "outputFormat": "Output $T$ lines. For each test case, output `Yes` if a solution exists, otherwise output `No`.", "hint": "### Constraints\n\nFor $20\\%$ of the testdata: $1\\le m \\le 10$.\n\nFor $40\\%$ of the testdata: $1\\le n \\le 15$.\n\nFor $70\\%$ of the testdata: $1\\le n \\le 50$.\n\nFor $100\\%$ of the testdata: $1\\le n \\le 501$, $1\\le m \\le 2n$, $1\\le T \\le 10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[北京省选集训2019] 图的难题", "background": "标题是假的。", "description": "小 D 在图论习题书上遇到了一个问题：\n\n书上画出了一张无向图，要求把边染成黑白两色，要求所有白色边构成的子图没有环，且所有黑色边构成的子图没有环。\n\n小 D 无论怎样尝试都觉得书上的问题没有解，她想请你帮她确认一下。\n\n由于这道题有很多小问，小 D 每次会给你图的点数 $n$、边数 $m$ 与所有边集，你只需要告诉小 D 有没有解即可。", "inputFormat": "第一行一个正整数 $T$，表示数据组数。\n\n对于每组数据，第一行两个正整数 $n,m$，意义如题目描述。\n\n接下来 $m$ 行，每行两个正整数 $u,v$，表示一条 $u$ 到 $v$ 的无向边。", "outputFormat": "输出 $T$ 行，对于每组数据，若有解输出 `Yes`，否则输出 `No`。", "hint": "### 数据范围：  \n\n对于 $20\\%$ 的数据：$1\\le m \\le 10$。\n\n对于 $40\\%$ 的数据：$1\\le n \\le 15$。\n\n对于 $70\\%$ 的数据：$1\\le n \\le 50$。\n\n对于 $100\\%$ 的数据：$1\\le n \\le 501$，$1\\le m \\le 2n$，$1\\le T \\le 10$。", "locale": "zh-CN"}}}
{"pid": "P5296", "type": "P", "difficulty": 7, "samples": [["3 1\n0 0 1\n0 0 1\n1 1 0", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["数学", "2019", "矩阵树定理", "多项式", "北京", "O2优化", "二项式定理", "生成函数", "高斯消元", "行列式"], "title": "[北京省选集训2019] 生成树计数", "background": "", "description": "小S 刚刚学习了生成树的知识，聪明的他想出了一个问题：  \n给定一个 $n$ 个点的带权无向完全图，求其所有生成树权值的 $k$ 次方之和。  \n定义一个树的权值，为其所有边权值和。    \n\n因为他不会，所以你要来做这题。  \n由于答案可能很大，请输出答案对 $998244353$ 取模的结果。", "inputFormat": "第一行两个非负整数 $n,k$，意义如题目描述。   \n接下来 $n$ 行，每行 $n$ 个整数，为这个带权无向完全图的邻接矩阵表示。  \n设 $w_{i,j}$ 表示矩阵的第 $i$ 行第 $j$ 列，保证：  \n$w_{i,i}=0$，且 $w_{i,j}=w_{j,i}$", "outputFormat": "输出一行一个整数表示答案对 $998244353$ 取模的结果。", "hint": "### 数据范围：  \n对于 $20\\%$的数据：  $1\\le n\\le 5$   \n对于另外 $10\\%$ 的数据：  $k = 0$   \n对于另外 $10\\%$ 的数据：  $k = 1$    \n对于 $60\\%$ 的数据：  $1\\le n \\le 15$    \n对于另外 $15\\%$ 的数据： $1\\le k \\le 15$  \n对于 $100\\%$ 的数据：$1\\le n \\le 30$，$0 \\le k \\le 30$，$0\\le w_{i,j} \\le 998244352$  \n\n注意 $0^0 = 1$", "locale": "zh-CN", "translations": {"en": {"title": "[Beijing NOI Qualifier Training 2019] Spanning Tree Counting", "background": "", "description": "Little S has just learned about spanning trees. Being clever, he came up with a question:  \nGiven a weighted undirected complete graph with $n$ vertices, find the sum of the $k$-th powers of the weights of all spanning trees.  \nThe weight of a tree is defined as the sum of the weights of all its edges.\n\nSince he cannot solve it, you have to do it.  \nBecause the answer may be very large, output the result modulo $998244353$.", "inputFormat": "The first line contains two non-negative integers $n, k$, as described above.  \nThe next $n$ lines each contain $n$ integers, representing the adjacency matrix of this weighted undirected complete graph.  \nLet $w_{i,j}$ denote the entry in row $i$ and column $j$ of the matrix, and it is guaranteed that:  \n$w_{i,i} = 0$, and $w_{i,j} = w_{j,i}$.", "outputFormat": "Output one line containing one integer, representing the answer modulo $998244353$.", "hint": "### Constraints:  \nFor $20\\%$ of the testdata: $1 \\le n \\le 5$.  \nFor another $10\\%$ of the testdata: $k = 0$.  \nFor another $10\\%$ of the testdata: $k = 1$.  \nFor $60\\%$ of the testdata: $1 \\le n \\le 15$.  \nFor another $15\\%$ of the testdata: $1 \\le k \\le 15$.  \nFor $100\\%$ of the testdata: $1 \\le n \\le 30$, $0 \\le k \\le 30$, $0 \\le w_{i,j} \\le 998244352$.\n\nNote that $0^0 = 1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[北京省选集训2019] 生成树计数", "background": "", "description": "小S 刚刚学习了生成树的知识，聪明的他想出了一个问题：  \n给定一个 $n$ 个点的带权无向完全图，求其所有生成树权值的 $k$ 次方之和。  \n定义一个树的权值，为其所有边权值和。    \n\n因为他不会，所以你要来做这题。  \n由于答案可能很大，请输出答案对 $998244353$ 取模的结果。", "inputFormat": "第一行两个非负整数 $n,k$，意义如题目描述。   \n接下来 $n$ 行，每行 $n$ 个整数，为这个带权无向完全图的邻接矩阵表示。  \n设 $w_{i,j}$ 表示矩阵的第 $i$ 行第 $j$ 列，保证：  \n$w_{i,i}=0$，且 $w_{i,j}=w_{j,i}$", "outputFormat": "输出一行一个整数表示答案对 $998244353$ 取模的结果。", "hint": "### 数据范围：  \n对于 $20\\%$的数据：  $1\\le n\\le 5$   \n对于另外 $10\\%$ 的数据：  $k = 0$   \n对于另外 $10\\%$ 的数据：  $k = 1$    \n对于 $60\\%$ 的数据：  $1\\le n \\le 15$    \n对于另外 $15\\%$ 的数据： $1\\le k \\le 15$  \n对于 $100\\%$ 的数据：$1\\le n \\le 30$，$0 \\le k \\le 30$，$0\\le w_{i,j} \\le 998244352$  \n\n注意 $0^0 = 1$", "locale": "zh-CN"}}}
{"pid": "P5297", "type": "P", "difficulty": 7, "samples": [["3\n1 3\n-.-\n3 4\n#.##\n#--#\n####\n4 3\n.|.\n-//\n.-.\n#\\/", "IMPOSSIBLE\nPOSSIBLE\n#.##\n#||#\n####\nPOSSIBLE\n.-.\n|//\n.-.\n#\\/\n"]], "limits": {"time": [1000, 1000], "memory": [131072, 131072]}, "tags": ["2019", "北京", "Special Judge", "O2优化", "2-SAT"], "title": "[北京省选集训2019] 完美塔防", "background": "小N最近喜欢玩一款塔防游戏。", "description": "这款游戏的棋盘是一个 $n \\times m$ 的网格，每个格子上会有以下类型物件：  \n\n1. A 型炮台：会向上下两个方向同时发射激光，符号为 `|`; \n2. B 型炮台：会向左右两个方向同时发射激光，符号为 `-`; \n3. 空地：激光穿过该物件会保持方向前进，符号为 `.`;\n4. 障碍：激光到达该物件会消失，符号为 `#`;\n5. 正反射镜：激光到达该物件后，会依物理定律改变方向，但仍继续前进，符号为 `\\`;\n6. 副反射镜：激光到达该物件后，会依物理定律改变方向，但仍继续前进，符号为 `/`;\n\n注意激光之间可以互相穿过，但如果激光射出网格边界，也会消失。    \n小 N 是一个强迫症玩家，他想让每一处空地都会被至少一束激光打到，但不能让激光攻击到自己的炮台以致损坏。   \n小 N 可以将任意多的 A 型炮台改造成 B 型炮台，也可以把任意多的 B 型炮台改造成 A 型炮台。   \n你可以告诉他能否通过这些改造实现他的目标吗?", "inputFormat": "第一行一个正整数 $T$，表示数据组数。   \n每组数据第一行有两个正整数 $n,m$。   \n接下来 $n $ 行，每行一个长度为 $m$ 的字符串，表示棋盘。", "outputFormat": "对于每组数据，若无解则输出一行 `IMPOSSIBLE`，否则输出一行 `POSSIBLE`，再输出改造后的棋盘。  \n如果有多组解，输出任意一个即可。", "hint": "### 数据范围：\n\n对于$100\\%$的数据：\n\n- $1\\le T \\le 200$；\n- $1\\le n,m \\le 50$。\n\nSpecial Judge provided by @tiger2005.", "locale": "zh-CN", "translations": {"en": {"title": "[Beijing NOI Qualifier Training 2019] Perfect Tower Defense.", "background": "Xiao N has recently started to like playing a tower defense game.", "description": "The game board is an $n \\times m$ grid. Each cell may contain one of the following objects:\n\n1. Type A turret: shoots lasers in both up and down directions at the same time, represented by `|`.\n2. Type B turret: shoots lasers in both left and right directions at the same time, represented by `-`.\n3. Empty cell: a laser passes through and keeps moving in the same direction, represented by `.`.\n4. Obstacle: when a laser reaches it, the laser disappears, represented by `#`.\n5. Main mirror: when a laser reaches it, it changes direction according to the laws of physics and continues moving, represented by `\\`.\n6. Secondary mirror: when a laser reaches it, it changes direction according to the laws of physics and continues moving, represented by `/`.\n\nNote that lasers can pass through each other, but if a laser goes out of the grid boundary, it also disappears.  \nXiao N is a perfectionist player. He wants every empty cell to be hit by at least one laser, but he must not let any laser hit his own turrets and damage them.  \nXiao N can change any number of Type A turrets into Type B turrets, and can also change any number of Type B turrets into Type A turrets.  \nCan you tell whether he can achieve his goal through these modifications?", "inputFormat": "The first line contains a positive integer $T$, the number of test cases.  \nFor each test case, the first line contains two positive integers $n, m$.  \nThe next $n$ lines each contain a string of length $m$, describing the board.", "outputFormat": "For each test case, if there is no solution, output one line `IMPOSSIBLE`. Otherwise, output one line `POSSIBLE`, then output the modified board.  \nIf there are multiple solutions, output any one.", "hint": "### Constraints\n\nFor $100\\%$ of the testdata:\n\n- $1\\le T \\le 200$.\n- $1\\le n,m \\le 50$.\n\nSpecial Judge provided by @tiger2005.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[北京省选集训2019] 完美塔防", "background": "小N最近喜欢玩一款塔防游戏。", "description": "这款游戏的棋盘是一个 $n \\times m$ 的网格，每个格子上会有以下类型物件：  \n\n1. A 型炮台：会向上下两个方向同时发射激光，符号为 `|`; \n2. B 型炮台：会向左右两个方向同时发射激光，符号为 `-`; \n3. 空地：激光穿过该物件会保持方向前进，符号为 `.`;\n4. 障碍：激光到达该物件会消失，符号为 `#`;\n5. 正反射镜：激光到达该物件后，会依物理定律改变方向，但仍继续前进，符号为 `\\`;\n6. 副反射镜：激光到达该物件后，会依物理定律改变方向，但仍继续前进，符号为 `/`;\n\n注意激光之间可以互相穿过，但如果激光射出网格边界，也会消失。    \n小 N 是一个强迫症玩家，他想让每一处空地都会被至少一束激光打到，但不能让激光攻击到自己的炮台以致损坏。   \n小 N 可以将任意多的 A 型炮台改造成 B 型炮台，也可以把任意多的 B 型炮台改造成 A 型炮台。   \n你可以告诉他能否通过这些改造实现他的目标吗?", "inputFormat": "第一行一个正整数 $T$，表示数据组数。   \n每组数据第一行有两个正整数 $n,m$。   \n接下来 $n $ 行，每行一个长度为 $m$ 的字符串，表示棋盘。", "outputFormat": "对于每组数据，若无解则输出一行 `IMPOSSIBLE`，否则输出一行 `POSSIBLE`，再输出改造后的棋盘。  \n如果有多组解，输出任意一个即可。", "hint": "### 数据范围：\n\n对于$100\\%$的数据：\n\n- $1\\le T \\le 200$；\n- $1\\le n,m \\le 50$。\n\nSpecial Judge provided by @tiger2005.", "locale": "zh-CN"}}}
{"pid": "P5298", "type": "P", "difficulty": 7, "samples": [["3\n0 1 1\n5000 1 2", "748683266"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "线段树", "树形 DP", "概率论", "线段树合并"], "title": "[PKUWC2018] Minimax", "background": "", "description": "小 $C$ 有一棵 $n$ 个结点的有根树，根是 $1$ 号结点，且每个结点最多有两个子结点。\n\n定义结点 $x$ 的权值为：\n\n1.若 $x$ 没有子结点，那么它的权值会在输入里给出，**保证这类点中每个结点的权值互不相同**。\n\n2.若 $x$ 有子结点，那么它的权值有 $p_x$ 的概率是它的子结点的权值的最大值，有 $1-p_x$ 的概率是它的子结点的权值的最小值。\n\n现在小 $C$ 想知道，假设 $1$ 号结点的权值有 $m$ 种可能性，**权值第 $i$ 小**的可能性的权值是 $V_i$，它的概率为 $D_i(D_i>0)$，求：\n\n$$\\sum_{i=1}^{m}i\\cdot V_i\\cdot D_i^2$$\n\n你需要输出答案对 $998244353$ 取模的值。\n", "inputFormat": "第一行一个正整数 $n$；\n\n第二行 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个结点的父亲的编号，其中第 $1$ 个结点的父亲为 $0$；\n\n第三行 $n$ 个整数，若第 $i$ 个结点没有子结点，则第 $i$ 个数为它的权值，否则第 $i$ 个数为 $p_i\\cdot 10000$，保证 $p_i\\cdot 10000$ 是个正整数。", "outputFormat": "输出答案。\n", "hint": "\n#### 样例解释\n1号结点的权值有 $\\frac{1}{2}$ 的概率是 $1$，有 $\\frac{1}{2}$ 的概率是 $2$，所以答案是 $\\frac{5}{4}$。\n\n#### 数据范围\n\n- 对于 $10\\%$ 的数据，有 $1\\leq n\\leq 20$；  \n- 对于 $20\\%$ 的数据，有 $1\\leq n\\leq 400$；  \n- 对于 $40\\%$ 的数据，有 $1\\leq n\\leq 5000$；  \n- 对于 $60\\%$ 的数据，有 $1\\leq n\\leq 10^5$；  \n- 另有 $10\\%$ 的数据保证树的形态随机；  \n- 对于 $100\\%$ 的数据，有 $1\\leq n\\leq 3\\times 10^5$，$1\\leq w_i\\leq 10^9$。\n\n对于所有数据，满足 $0 < p_i \\cdot 10000 < 10000$，所以易证明所有叶子的权值都有概率被根取到。\n", "locale": "zh-CN", "translations": {"en": {"title": "[PKUWC2018] Minimax", "background": "", "description": "Little C has a rooted tree with $n$ nodes. The root is node $1$, and each node has at most two children.\n\nDefine the value of a node $x$ as follows:\n\n1. If $x$ has no children, then its value is given in the input. It is **guaranteed that all such nodes have pairwise distinct values**.\n\n2. If $x$ has children, then its value equals the maximum of its children’s values with probability $p_x$, and equals the minimum of its children’s values with probability $1-p_x$.\n\nNow Little C wants to know the following. Suppose the value of node $1$ has $m$ possible outcomes. Let the value of the $i$-th smallest outcome be $V_i$, and its probability be $D_i$ $(D_i>0)$. Compute:\n\n$$\\sum_{i=1}^{m}i\\cdot V_i\\cdot D_i^2$$\n\nYou need to output the answer modulo $998244353$.", "inputFormat": "The first line contains a positive integer $n$.\n\nThe second line contains $n$ integers. The $i$-th integer is the index of the parent of node $i$. The parent of node $1$ is $0$.\n\nThe third line contains $n$ integers. If node $i$ has no children, then the $i$-th number is its value; otherwise, the $i$-th number is $p_i\\cdot 10000$. It is guaranteed that $p_i\\cdot 10000$ is a positive integer.", "outputFormat": "Output the answer.", "hint": "#### Sample Explanation\n\nThe value of node $1$ is $1$ with probability $\\frac{1}{2}$, and $2$ with probability $\\frac{1}{2}$, so the answer is $\\frac{5}{4}$.\n\n#### Constraints\n\n- For $10\\%$ of the testdata, $1\\leq n\\leq 20$.  \n- For $20\\%$ of the testdata, $1\\leq n\\leq 400$.  \n- For $40\\%$ of the testdata, $1\\leq n\\leq 5000$.  \n- For $60\\%$ of the testdata, $1\\leq n\\leq 10^5$.  \n- Another $10\\%$ of the testdata guarantees that the shape of the tree is random.  \n- For $100\\%$ of the testdata, $1\\leq n\\leq 3\\times 10^5$, $1\\leq w_i\\leq 10^9$.\n\nFor all testdata, $0 < p_i \\cdot 10000 < 10000$, so it is easy to prove that every leaf value has a positive probability of being chosen by the root.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[PKUWC2018] Minimax", "background": "", "description": "小 $C$ 有一棵 $n$ 个结点的有根树，根是 $1$ 号结点，且每个结点最多有两个子结点。\n\n定义结点 $x$ 的权值为：\n\n1.若 $x$ 没有子结点，那么它的权值会在输入里给出，**保证这类点中每个结点的权值互不相同**。\n\n2.若 $x$ 有子结点，那么它的权值有 $p_x$ 的概率是它的子结点的权值的最大值，有 $1-p_x$ 的概率是它的子结点的权值的最小值。\n\n现在小 $C$ 想知道，假设 $1$ 号结点的权值有 $m$ 种可能性，**权值第 $i$ 小**的可能性的权值是 $V_i$，它的概率为 $D_i(D_i>0)$，求：\n\n$$\\sum_{i=1}^{m}i\\cdot V_i\\cdot D_i^2$$\n\n你需要输出答案对 $998244353$ 取模的值。\n", "inputFormat": "第一行一个正整数 $n$；\n\n第二行 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个结点的父亲的编号，其中第 $1$ 个结点的父亲为 $0$；\n\n第三行 $n$ 个整数，若第 $i$ 个结点没有子结点，则第 $i$ 个数为它的权值，否则第 $i$ 个数为 $p_i\\cdot 10000$，保证 $p_i\\cdot 10000$ 是个正整数。", "outputFormat": "输出答案。\n", "hint": "\n#### 样例解释\n1号结点的权值有 $\\frac{1}{2}$ 的概率是 $1$，有 $\\frac{1}{2}$ 的概率是 $2$，所以答案是 $\\frac{5}{4}$。\n\n#### 数据范围\n\n- 对于 $10\\%$ 的数据，有 $1\\leq n\\leq 20$；  \n- 对于 $20\\%$ 的数据，有 $1\\leq n\\leq 400$；  \n- 对于 $40\\%$ 的数据，有 $1\\leq n\\leq 5000$；  \n- 对于 $60\\%$ 的数据，有 $1\\leq n\\leq 10^5$；  \n- 另有 $10\\%$ 的数据保证树的形态随机；  \n- 对于 $100\\%$ 的数据，有 $1\\leq n\\leq 3\\times 10^5$，$1\\leq w_i\\leq 10^9$。\n\n对于所有数据，满足 $0 < p_i \\cdot 10000 < 10000$，所以易证明所有叶子的权值都有概率被根取到。\n", "locale": "zh-CN"}}}
{"pid": "P5299", "type": "P", "difficulty": 6, "samples": [["2\n2 3 2\n2 3\n1 2\n10 16 14\n2 3 4 5 6 7 8 9 10 11\n1 2 3 4 5 6 7 8 9 10", "19\n253973805"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018"], "title": "[PKUWC2018] Slay the Spire", "background": null, "description": "九条可怜在玩一个很好玩的策略游戏：Slay the Spire，一开始九条可怜的卡组里有 $2n$ 张牌，每张牌上都写着一个数字$w_i$，一共有两种类型的牌，每种类型各 $n$ 张：\n\n1. 攻击牌：打出后对对方造成等于牌上的数字的伤害。\n\n2. 强化牌：打出后，假设该强化牌上的数字为 $x$，则其他剩下的**攻击牌**的数字都会乘上 $x$。**保证强化牌上的数字都大于 1**。\n\n现在九条可怜会等概率随机从卡组中抽出 $m$ 张牌，由于费用限制，九条可怜最多打出 $k$ 张牌，假设九条可怜永远都会采取能造成最多伤害的策略，求她期望造成多少伤害。\n\n假设答案为 $\\text{ans}$ ，你只需要输出\n\n$$\\left (\\text{ans}\\times \\frac{(2n)!}{m!(2n-m)!}\\right) ~\\bmod 998244353$$\n\n即可。其中 $x!$ 表示 $\\prod_{i=1}^{x}i$，特别地，$0!=1$ 。", "inputFormat": "第一行一个正整数 $T$ 表示数据组数\n\n接下来对于每组数据：\n\n第一行三个正整数 $n,m,k$\n\n第二行 $n$ 个正整数 $w_i$，表示每张强化牌上的数值。\n\n第三行 $n$ 个正整数 $w_i$，表示每张攻击牌上的数值。", "outputFormat": "输出 $T$ 行，每行一个非负整数表示每组数据的答案。", "hint": "#### 样例解释\n例如九条可怜抽到了攻击牌 $\\{1,2\\}$ 和强化牌 $\\{3\\}$，那最优策略是先用掉强化牌 $3$，此时攻击牌的数值变成 $\\{3,6\\}$，然后打出 $6$。\n\n\n#### 数据范围\n\n对于所有数据，有 $1\\leq k\\leq m\\leq 2n\\leq 3000$，且$1\\leq w_i\\leq 10^8$。\n\n**保证强化牌上的数字都大于 1**。\n\n以下 $(\\sum 2n)$ 表示对于输入中所有数据的$2n$的和。\n\n对于 $10\\%$ 的数据，有 $1\\leq \\sum 2n\\leq 10$\n\n对于 $20\\%$ 的数据，有 $1\\leq \\sum 2n\\leq 100$\n\n对于 $30\\%$ 的数据，有 $1\\leq \\sum 2n\\leq 500$\n\n另有 $20\\%$ 的数据，满足所有攻击牌的数值相同。\n\n另有 $20\\%$ 的数据，满足 $m=k$。\n\n对于 $100\\%$ 的数据，有 $1\\leq \\sum 2n\\leq 3000$", "locale": "zh-CN", "translations": {"en": {"title": "[PKUWC2018] Slay the Spire", "background": "", "description": "Jiutiao Kelian is playing a very interesting strategy game: Slay the Spire. At the beginning, her deck contains $2n$ cards. Each card has a number $w_i$ written on it. There are two types of cards, with $n$ cards of each type:\n\n1. Attack cards: After playing one, it deals damage equal to the number on the card.\n\n2. Buff cards: After playing one, suppose the number on this buff card is $x$. Then the numbers on all remaining **attack cards** will be multiplied by $x$. **It is guaranteed that the numbers on buff cards are all greater than 1**.\n\nNow Jiutiao Kelian will randomly draw $m$ cards from the deck with equal probability. Due to energy limits, she can play at most $k$ cards. Assume she always uses the strategy that can deal the maximum damage. Find the expected damage she can deal.\n\nSuppose the answer is $\\text{ans}$. You only need to output\n\n$$\\left (\\text{ans}\\times \\frac{(2n)!}{m!(2n-m)!}\\right) ~\\bmod 998244353$$\n\nHere, $x!$ means $\\prod_{i=1}^{x}i$. In particular, $0!=1$.", "inputFormat": "The first line contains a positive integer $T$, denoting the number of test cases.\n\nFor each test case:\n\nThe first line contains three positive integers $n,m,k$.\n\nThe second line contains $n$ positive integers $w_i$, representing the values on each buff card.\n\nThe third line contains $n$ positive integers $w_i$, representing the values on each attack card.", "outputFormat": "Output $T$ lines. Each line contains a non-negative integer, representing the answer for each test case.", "hint": "#### Sample Explanation\n\nFor example, Jiutiao Kelian draws attack cards $\\{1,2\\}$ and a buff card $\\{3\\}$. The optimal strategy is to play the buff card $3$ first. Then the values of the attack cards become $\\{3,6\\}$, and then she plays $6$.\n\n#### Constraints\n\nFor all testdata, $1\\leq k\\leq m\\leq 2n\\leq 3000$, and $1\\leq w_i\\leq 10^8$.\n\n**It is guaranteed that the numbers on buff cards are all greater than 1**.\n\nLet $(\\sum 2n)$ denote the sum of $2n$ over all test cases in the input.\n\nFor $10\\%$ of the testdata, $1\\leq \\sum 2n\\leq 10$.\n\nFor $20\\%$ of the testdata, $1\\leq \\sum 2n\\leq 100$.\n\nFor $30\\%$ of the testdata, $1\\leq \\sum 2n\\leq 500$.\n\nFor another $20\\%$ of the testdata, all attack cards have the same value.\n\nFor another $20\\%$ of the testdata, $m=k$.\n\nFor $100\\%$ of the testdata, $1\\leq \\sum 2n\\leq 3000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[PKUWC2018] Slay the Spire", "background": null, "description": "九条可怜在玩一个很好玩的策略游戏：Slay the Spire，一开始九条可怜的卡组里有 $2n$ 张牌，每张牌上都写着一个数字$w_i$，一共有两种类型的牌，每种类型各 $n$ 张：\n\n1. 攻击牌：打出后对对方造成等于牌上的数字的伤害。\n\n2. 强化牌：打出后，假设该强化牌上的数字为 $x$，则其他剩下的**攻击牌**的数字都会乘上 $x$。**保证强化牌上的数字都大于 1**。\n\n现在九条可怜会等概率随机从卡组中抽出 $m$ 张牌，由于费用限制，九条可怜最多打出 $k$ 张牌，假设九条可怜永远都会采取能造成最多伤害的策略，求她期望造成多少伤害。\n\n假设答案为 $\\text{ans}$ ，你只需要输出\n\n$$\\left (\\text{ans}\\times \\frac{(2n)!}{m!(2n-m)!}\\right) ~\\bmod 998244353$$\n\n即可。其中 $x!$ 表示 $\\prod_{i=1}^{x}i$，特别地，$0!=1$ 。", "inputFormat": "第一行一个正整数 $T$ 表示数据组数\n\n接下来对于每组数据：\n\n第一行三个正整数 $n,m,k$\n\n第二行 $n$ 个正整数 $w_i$，表示每张强化牌上的数值。\n\n第三行 $n$ 个正整数 $w_i$，表示每张攻击牌上的数值。", "outputFormat": "输出 $T$ 行，每行一个非负整数表示每组数据的答案。", "hint": "#### 样例解释\n例如九条可怜抽到了攻击牌 $\\{1,2\\}$ 和强化牌 $\\{3\\}$，那最优策略是先用掉强化牌 $3$，此时攻击牌的数值变成 $\\{3,6\\}$，然后打出 $6$。\n\n\n#### 数据范围\n\n对于所有数据，有 $1\\leq k\\leq m\\leq 2n\\leq 3000$，且$1\\leq w_i\\leq 10^8$。\n\n**保证强化牌上的数字都大于 1**。\n\n以下 $(\\sum 2n)$ 表示对于输入中所有数据的$2n$的和。\n\n对于 $10\\%$ 的数据，有 $1\\leq \\sum 2n\\leq 10$\n\n对于 $20\\%$ 的数据，有 $1\\leq \\sum 2n\\leq 100$\n\n对于 $30\\%$ 的数据，有 $1\\leq \\sum 2n\\leq 500$\n\n另有 $20\\%$ 的数据，满足所有攻击牌的数值相同。\n\n另有 $20\\%$ 的数据，满足 $m=k$。\n\n对于 $100\\%$ 的数据，有 $1\\leq \\sum 2n\\leq 3000$", "locale": "zh-CN"}}}
{"pid": "P5300", "type": "P", "difficulty": 5, "samples": [["3\n1 0 0\n0 0 0\n0 0 0", "1 9"], ["3\n1 2 3\n4 5 6\n7 8 9", "73 314"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "贵州", "广西", "位运算", "单调栈"], "title": "[GXOI/GZOI2019] 与或和", "background": "", "description": "Freda 学习了位运算和矩阵以后，决定对这种简洁而优美的运算，以及蕴含深邃空间的结构进行更加深入的研究。\n\n对于一个由非负整数构成的矩阵，她定义矩阵的 $\\texttt{AND}$ 值为矩阵中所有数二进制 $\\texttt{AND(\\&)}$ 的运算结果；定义矩阵的 $\\texttt{OR}$ 值为矩阵中所有数二进制 $\\texttt{OR(|)}$ 的运算结果。\n\n给定一个 $N \\times N$ 的矩阵，她希望求出：\n1. 该矩阵的所有子矩阵的 $\\texttt{AND}$ 值之和（所有子矩阵 $\\texttt{AND}$ 值相加的结果）。\n2. 该矩阵的所有子矩阵的 $\\texttt{OR}$ 值之和（所有子矩阵 $\\texttt{OR}$ 值相加的结果）。\n\n接下来的剧情你应该已经猜到——Freda 并不想花费时间解决如此简单的问题，所以这个问题就交给你了。\n\n由于答案可能非常的大，你只需要输出答案对 $1,000,000,007 (10^9 + 7)$ 取模后的结果。", "inputFormat": "输入文件的第一行是一个正整数 $N$，表示矩阵的尺寸。\n\n接下来 $N$ 行，每行 $N$ 个自然数，代表矩阵的一行。相邻两个自然数之间由一个或多个空格隔开。", "outputFormat": "输出只有一行，包含两个用空格隔开的整数，第一个应为所有子矩阵 $\\texttt{AND}$ 值之和除以 $10^9 + 7$ 的余数，第二个应为所有子矩阵 $\\texttt{OR}$ 值之和除以 $10^9 + 7$ 的余数。", "hint": "### 样例1解释\n\n该 $3 \\times 3$ 矩阵共有 $9$ 个 $1 \\times 1$ 子矩阵、$6$ 个 $1 \\times 2$ 子矩阵、$6$ 个 $2 \\times 1$ 子矩阵、$4$ 个 $2 \\times 2$ 子矩阵、3 个 $1 \\times 3$ 子矩阵、$3$ 个 $3 \\times 1$ 子矩阵、$2$ 个 $2 \\times 3$ 子矩阵、$2$ 个 $3 \\times 2$ 子矩阵和 $1$ 个 $3 \\times 3$ 子矩阵。  \n只有一个子矩阵（仅由第一行第一列的那个元素构成的 $1 \\times 1$ 矩阵）$\\texttt{AND}$ 值为 $1$，其余子矩阵的 $\\texttt{AND}$ 值均为 $0$，总和为 $1$。  \n包含第一行第一列那个元素的子矩阵有 $9$ 个，它们的 $\\texttt{OR}$ 值为 $1$，其余子矩阵的 $\\texttt{OR}$ 值为 $0$，总和为 $9$。\n\n### 数据范围\n\n|测试点编号|$n$ 的规模|矩阵中的自然数|\n|:-:|:-:|:-:|\n|$1$|$1 \\le n \\le 10$|$\\le 100$|\n|$2$|$1 \\le n \\le 10$|$\\le 100$|\n|$3$|$1 \\le n \\le 100$|$\\le 100$|\n|$4$|$1 \\le n \\le 100$|$\\le 100$|\n|$5$|$1 \\le n \\le 100$|$\\le 100$|\n|$6$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n|$7$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n|$8$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n|$9$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n|$10$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n\n另外有一组不计分的 hack 数据，放在 subtask 1 中，数据范围与测试点 $6 \\sim 10$ 一致。", "locale": "zh-CN", "translations": {"en": {"title": "[GXOI/GZOI2019] AND and OR Sum", "background": "", "description": "After learning bitwise operations and matrices, Freda decided to further study these simple and elegant operations, as well as the structures that contain profound spaces.\n\nFor a matrix consisting of non-negative integers, she defines the $\\texttt{AND}$ value of the matrix as the result of applying bitwise $\\texttt{AND(\\&)}$ to all numbers in the matrix; she defines the $\\texttt{OR}$ value of the matrix as the result of applying bitwise $\\texttt{OR(|)}$ to all numbers in the matrix.\n\nGiven an $N \\times N$ matrix, she wants to compute:\n1. The sum of the $\\texttt{AND}$ values of all submatrices (the result of adding up the $\\texttt{AND}$ values of all submatrices).\n2. The sum of the $\\texttt{OR}$ values of all submatrices (the result of adding up the $\\texttt{OR}$ values of all submatrices).\n\nYou can probably guess what happens next—Freda does not want to spend time solving such a simple problem, so she leaves it to you.\n\nSince the answer may be very large, you only need to output the result modulo $1,000,000,007 (10^9 + 7)$.", "inputFormat": "The first line of the input file contains a positive integer $N$, which denotes the size of the matrix.\n\nThe next $N$ lines each contain $N$ natural numbers, representing one row of the matrix. Any two adjacent natural numbers are separated by one or more spaces.", "outputFormat": "Output a single line containing two integers separated by a space. The first should be the remainder when the sum of $\\texttt{AND}$ values of all submatrices is taken modulo $10^9 + 7$, and the second should be the remainder when the sum of $\\texttt{OR}$ values of all submatrices is taken modulo $10^9 + 7$.", "hint": "### Explanation of Sample 1\n\nThis $3 \\times 3$ matrix has $9$ submatrices of size $1 \\times 1$, $6$ submatrices of size $1 \\times 2$, $6$ submatrices of size $2 \\times 1$, $4$ submatrices of size $2 \\times 2$, $3$ submatrices of size $1 \\times 3$, $3$ submatrices of size $3 \\times 1$, $2$ submatrices of size $2 \\times 3$, $2$ submatrices of size $3 \\times 2$, and $1$ submatrix of size $3 \\times 3$.  \nOnly one submatrix (the $1 \\times 1$ matrix consisting only of the element in the first row and first column) has an $\\texttt{AND}$ value of $1$; all other submatrices have an $\\texttt{AND}$ value of $0$, so the total sum is $1$.  \nThere are $9$ submatrices that contain the element in the first row and first column. Their $\\texttt{OR}$ value is $1$, while all other submatrices have an $\\texttt{OR}$ value of $0$, so the total sum is $9$.\n\n### Constraints\n\n|Test Point ID|Scale of $n$|Natural numbers in the matrix|\n|:-:|:-:|:-:|\n|$1$|$1 \\le n \\le 10$|$\\le 100$|\n|$2$|$1 \\le n \\le 10$|$\\le 100$|\n|$3$|$1 \\le n \\le 100$|$\\le 100$|\n|$4$|$1 \\le n \\le 100$|$\\le 100$|\n|$5$|$1 \\le n \\le 100$|$\\le 100$|\n|$6$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n|$7$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n|$8$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n|$9$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n|$10$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n\nIn addition, there is a set of unscored hack testdata placed in subtask 1, with the same constraints as test points $6 \\sim 10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[GXOI/GZOI2019] 与或和", "background": "", "description": "Freda 学习了位运算和矩阵以后，决定对这种简洁而优美的运算，以及蕴含深邃空间的结构进行更加深入的研究。\n\n对于一个由非负整数构成的矩阵，她定义矩阵的 $\\texttt{AND}$ 值为矩阵中所有数二进制 $\\texttt{AND(\\&)}$ 的运算结果；定义矩阵的 $\\texttt{OR}$ 值为矩阵中所有数二进制 $\\texttt{OR(|)}$ 的运算结果。\n\n给定一个 $N \\times N$ 的矩阵，她希望求出：\n1. 该矩阵的所有子矩阵的 $\\texttt{AND}$ 值之和（所有子矩阵 $\\texttt{AND}$ 值相加的结果）。\n2. 该矩阵的所有子矩阵的 $\\texttt{OR}$ 值之和（所有子矩阵 $\\texttt{OR}$ 值相加的结果）。\n\n接下来的剧情你应该已经猜到——Freda 并不想花费时间解决如此简单的问题，所以这个问题就交给你了。\n\n由于答案可能非常的大，你只需要输出答案对 $1,000,000,007 (10^9 + 7)$ 取模后的结果。", "inputFormat": "输入文件的第一行是一个正整数 $N$，表示矩阵的尺寸。\n\n接下来 $N$ 行，每行 $N$ 个自然数，代表矩阵的一行。相邻两个自然数之间由一个或多个空格隔开。", "outputFormat": "输出只有一行，包含两个用空格隔开的整数，第一个应为所有子矩阵 $\\texttt{AND}$ 值之和除以 $10^9 + 7$ 的余数，第二个应为所有子矩阵 $\\texttt{OR}$ 值之和除以 $10^9 + 7$ 的余数。", "hint": "### 样例1解释\n\n该 $3 \\times 3$ 矩阵共有 $9$ 个 $1 \\times 1$ 子矩阵、$6$ 个 $1 \\times 2$ 子矩阵、$6$ 个 $2 \\times 1$ 子矩阵、$4$ 个 $2 \\times 2$ 子矩阵、3 个 $1 \\times 3$ 子矩阵、$3$ 个 $3 \\times 1$ 子矩阵、$2$ 个 $2 \\times 3$ 子矩阵、$2$ 个 $3 \\times 2$ 子矩阵和 $1$ 个 $3 \\times 3$ 子矩阵。  \n只有一个子矩阵（仅由第一行第一列的那个元素构成的 $1 \\times 1$ 矩阵）$\\texttt{AND}$ 值为 $1$，其余子矩阵的 $\\texttt{AND}$ 值均为 $0$，总和为 $1$。  \n包含第一行第一列那个元素的子矩阵有 $9$ 个，它们的 $\\texttt{OR}$ 值为 $1$，其余子矩阵的 $\\texttt{OR}$ 值为 $0$，总和为 $9$。\n\n### 数据范围\n\n|测试点编号|$n$ 的规模|矩阵中的自然数|\n|:-:|:-:|:-:|\n|$1$|$1 \\le n \\le 10$|$\\le 100$|\n|$2$|$1 \\le n \\le 10$|$\\le 100$|\n|$3$|$1 \\le n \\le 100$|$\\le 100$|\n|$4$|$1 \\le n \\le 100$|$\\le 100$|\n|$5$|$1 \\le n \\le 100$|$\\le 100$|\n|$6$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n|$7$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n|$8$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n|$9$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n|$10$|$1 \\le n \\le 1,000$|$\\le 2^{31} - 1$|\n\n另外有一组不计分的 hack 数据，放在 subtask 1 中，数据范围与测试点 $6 \\sim 10$ 一致。", "locale": "zh-CN"}}}
{"pid": "P5301", "type": "P", "difficulty": 6, "samples": [["2\n0\n0\n7m 4p 2s 7s 6p 8s 7p 5s 9s 9s 1p 5m 9m 5s 4p 5s E 1p 6s 5p B 4m 6m W 6p 6s E 9s 5p 2s 8s 8p 4m 3s 9m 5p 3s 2s 6s 8s 8p 6p 5m 4s 3m 4s 5s 4s 6m 9s 6p N 5m 7s 4m 2m 2s 6s 3m 7p B B N 1m 3m B 8p F 7p 0\nW 4p N 3m 2m B 9m 3p 1p 6p S 4s 5p 8s 4m 5s 2s 3s 0", "1308622848\n127401984"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "贵州", "广西"], "title": "[GXOI/GZOI2019] 宝牌一大堆", "background": "", "description": "麻将是一种传统的博弈游戏，由 $4$ 名玩家参与，轮流摸牌、打牌。在竞技比赛中主要有国标麻将（中国）和立直麻将（日本）两大规则。本题采用一种特别的规则——「宝牌一大堆」规则。\n\n#### 牌型\n一副麻将由 $136$ 张牌组成，其中包含 $34$ 种不同的牌，每种各有 $4$ 张。这 $34$ 种牌分别是：  \n一万到九万、一索到九索、一筒到九筒、东、南、西、北、中、白、发。\n\n![doraippai1.png](https://cdn.luogu.com.cn/upload/pic/56677.png)\n\n它们可以组合成不同的牌型：\n- 顺子：$3$ 张数字连续的万，或 $3$ 张数字连续的索，或 $3$ 张数字连续的筒。\n- 刻子：$3$ 张完全一样的牌。\n- 杠子：$4$ 张完全一样的牌。\n- 雀头：$2$ 张完全一样的牌。\n\n其中顺子和刻子统称为面子。\n\n#### 和牌\n手牌（一名玩家持有的牌）宣告胜利的状况称为「和牌」。\n- 当玩家持有 $14$ 张牌，并且满足以下三个条件之一时，判定为「和牌」：\n  1. 存在一种方案，使得这 $14$ 张牌可以分成 $4$ 组面子、$1$ 组雀头，简记为「$3 \\times 4 + 2$」。\n  2. 存在一种方案，使得这 $14$ 张牌可以分成 $7$ 组**不同的**雀头，称为「七对子」。\n  3. 这 $14$ 张牌**仅由**一万、九万、一索、九索、一筒、九筒、东、南、西、北、中、白、发这 $13$ 种牌组成，并且这 $13$ 种牌**每种至少有 $1$ 张**，称为「国士无双」。\n- 当玩家持有 $15$ 张牌，并且存在一种方案，使得这 $15$ 张牌可以分成 $1$ 组杠子、$3$ 组面子、$1$ 组雀头，判定为和牌。\n- 当玩家持有 $16$ 张牌，并且存在一种方案，使得这 $16$ 张牌可以分成 $2$ 组杠子、$2$ 组面子、$1$ 组雀头，判定为和牌。\n- 当玩家持有 $17$ 张牌，并且存在一种方案，使得这 $17$ 张牌可以分成 $3$ 组杠子、$1$ 组面子、$1$ 组雀头，判定为和牌。\n- 当玩家持有 $18$ 张牌，并且存在一种方案，使得这 $18$ 张牌可以分成 $4$ 组杠子、$1$ 组雀头，判定为和牌。\n\n#### 宝牌\n每局游戏还会指定若干张「宝牌」，和牌时，手牌中的每张宝牌会使收益翻一番（会在接下来详细介绍）。\n\n#### 达成分数\n由于可以「和牌」的手牌很多，可以给每种判定为「和牌」的手牌定义一个「达成分数」，这个分数等于从所有尚未打出的牌中选出若干张，能够组成该手牌的方法数，再乘上手牌中 $2$ 的「宝牌数」次方。  \n该分数综合考虑了和牌几率与和牌收益，理论上以分数较高的手牌为目标较好。\n\n例如下图手牌显然是可以「和牌」的，如果目前场上还剩 $3$ 张一万、$4$ 张九万，以及二到八万各 $2$ 张没有打出，宝牌为九万，那么下图手牌的「达成分数」就是 $C_3^3 C_4^3 C_2^2 (C_2^1)^6 2^3 = 2048$，其中 $C$ 表示组合数。\n\n![doraippai2.png](https://cdn.luogu.com.cn/upload/pic/56678.png)\n\n特别地，「七对子」和牌的手牌，达成分数额外乘 $7$。「国士无双」和牌的手牌，达成分数额外乘 $13$。\n\n有一天，小 L，小 Y，小 I 和小 W 正在打麻将，路过的雪野和看到了所有已经打出的牌，但不知道任何一名玩家的手牌。也许你已经猜到了下面的剧情—\n—雪野和想知道在所有尚未打出的牌中，「达成分数」最高的可以「和牌」的手牌有多少分，但是她还要观看麻将比赛，所以这个问题就交给你了。", "inputFormat": "每个测试点包含多组数据，第一行是一个整数 $T$，表示数据组数。注意各组数据之间是互相独立的。\n\n每组数据包含两行，第一行给出场上已经打出的牌，第二行给出该局的所有宝牌。\n\n规定用 $\\texttt{1m},\\texttt{2m},\\dots,\\texttt{9m}$ 代表万，$\\texttt{1p},\\texttt{2p},\\dots,\\texttt{9p}$ 代表筒，$\\texttt{1s},\\texttt{2s},\\dots,\\texttt{9s}$ 代表索，$\\texttt E,\\texttt S,\\texttt W,\\texttt N$ 代表东、南、西、北，$\\texttt Z,\\texttt B,\\texttt F$ 代表中、白、发，相邻两张牌之间用一个空格隔开，每行的末尾有一个单独的 $0$ 代表结束。", "outputFormat": "输出文件应包含 $T$ 行，对于每组数据，输出一个整数表示最高分数。", "hint": "### 样例解释\n\n在第一组数据中，没有打出过任何牌，没有宝牌，和「国士无双」分数最高，为 $13 \\times 6 \\times 4^{12}$。  \n和「$3 \\times 4 + 2$」和「七对子」的分数为 $100663296$ 和 $1959552$。\n\n在第二组数据中，和「$3 \\times 4 + 2$」分数最高，为 $127401984$，可以得到该分数的手牌之一为「$\\texttt{1m2m3m 7m8m9m 1p2p3p 3p4p5p SS}$」。  \n和「七对子」的分数为 $125411328$，不存在和「国士无双」的可能。\n\n### 数据范围\n\n保证已经打出的牌必定是合法的牌，且每种不超过 $4$ 张。宝牌不会重复给出。\n\n|测试点编号|$T$ 的规模|已经打出的牌|宝牌数|\n|:-:|:-:|:-:|:-:|\n|$1$|$T = 10$|无特殊限制|$\\le 20$ 张|\n|$2$|$T = 100$|至少包括所有数字为三到七的牌|$\\le 20$ 张|\n|$3$|$T = 500$|每种至少 $2$ 张|$\\le 20$ 张|\n|$4$|$T = 500$|每种至少 $3$ 张|$\\le 20$ 张|\n|$5$|$T = 500$|无特殊限制|$0$ 张|\n|$6$|$T = 1,000$|无特殊限制|$0$ 张|\n|$7$|$T = 1,000$|无特殊限制|$\\le 20$ 张|\n|$8$|$T = 1,500$|无特殊限制|$\\le 20$ 张|\n|$9$|$T = 2,000$|无特殊限制|$\\le 20$ 张|\n|$10$|$T = 2,500$|无特殊限制|$\\le 20$ 张|", "locale": "zh-CN", "translations": {"en": {"title": "[GXOI/GZOI2019] A Pile of Dora Tiles", "background": "", "description": "Mahjong is a traditional board game played by $4$ players, who take turns drawing and discarding tiles. In competitive matches, the two main rulesets are Chinese Official Mahjong (China) and Riichi Mahjong (Japan). This problem uses a special ruleset: “A Pile of Dora Tiles”.\n\n#### Tile Types\nA full mahjong set contains $136$ tiles, including $34$ different types of tiles, with $4$ copies of each type. These $34$ types are:  \n$1$-man to $9$-man, $1$-sou to $9$-sou, $1$-pin to $9$-pin, East, South, West, North, Red, White, Green.\n\n![doraippai1.png](https://cdn.luogu.com.cn/upload/pic/56677.png)\n\nThey can form different groups:\n- Sequence: $3$ consecutive number tiles in manzu, or $3$ consecutive number tiles in souzu, or $3$ consecutive number tiles in pinzu.\n- Triplet: $3$ identical tiles.\n- Quad: $4$ identical tiles.\n- Pair: $2$ identical tiles.\n\nSequences and triplets are collectively called melds.\n\n#### Winning Hand\nA hand (the tiles held by one player) that declares victory is called a “winning hand”.\n- When a player holds $14$ tiles and satisfies one of the following three conditions, it is a winning hand:\n  1. There exists a way to split these $14$ tiles into $4$ melds and $1$ pair, denoted as “$3 \\times 4 + 2$”.\n  2. There exists a way to split these $14$ tiles into $7$ **distinct** pairs, called “Seven Pairs”.\n  3. These $14$ tiles consist **only of** the following $13$ tile types: $1$-man, $9$-man, $1$-sou, $9$-sou, $1$-pin, $9$-pin, East, South, West, North, Red, White, Green; and among these $13$ types, **each type appears at least once**. This is called “Thirteen Orphans”.\n- When a player holds $15$ tiles and there exists a way to split these $15$ tiles into $1$ quad, $3$ melds, and $1$ pair, it is a winning hand.\n- When a player holds $16$ tiles and there exists a way to split these $16$ tiles into $2$ quads, $2$ melds, and $1$ pair, it is a winning hand.\n- When a player holds $17$ tiles and there exists a way to split these $17$ tiles into $3$ quads, $1$ meld, and $1$ pair, it is a winning hand.\n- When a player holds $18$ tiles and there exists a way to split these $18$ tiles into $4$ quads and $1$ pair, it is a winning hand.\n\n#### Dora Tiles\nIn each round, several “dora tiles” are also specified. When you win, each dora tile in your hand doubles the payoff (explained in detail below).\n\n#### Achieved Score\nSince there are many possible winning hands, we define an “achieved score” for each winning hand. This score equals: the number of ways to choose some tiles from all tiles that have not been discarded yet such that they form this hand, multiplied by $2^{(\\text{number of dora tiles in the hand})}$.  \nThis score considers both the chance to win and the payoff after winning. In theory, it is better to aim for hands with higher scores.\n\nFor example, the hand shown below is clearly a winning hand. If there are still $3$ copies of $1$-man, $4$ copies of $9$-man, and $2$ copies of each of $2$-man through $8$-man not yet discarded on the table, and the dora tile is $9$-man, then the achieved score of the hand below is $C_3^3 C_4^3 C_2^2 (C_2^1)^6 2^3 = 2048$, where $C$ denotes the binomial coefficient.\n\n![doraippai2.png](https://cdn.luogu.com.cn/upload/pic/56678.png)\n\nIn particular, for a “Seven Pairs” winning hand, the achieved score is additionally multiplied by $7$.  \nFor a “Thirteen Orphans” winning hand, the achieved score is additionally multiplied by $13$.\n\nOne day, Xiao L, Xiao Y, Xiao I, and Xiao W were playing mahjong. Yukino Wakana, who happened to pass by, saw all the tiles that had already been discarded, but did not know any player’s hand. Perhaps you have already guessed what happens next—  \n—Yukino Wakana wants to know, among all tiles not yet discarded, what is the maximum achieved score of any winning hand. But she still needs to watch the mahjong match, so she leaves this problem to you.", "inputFormat": "Each test point contains multiple test cases. The first line is an integer $T$, the number of test cases. Note that the test cases are independent.\n\nEach test case consists of two lines. The first line gives the tiles already discarded on the table, and the second line gives all dora tiles for this round.\n\nWe use $\\texttt{1m},\\texttt{2m},\\dots,\\texttt{9m}$ for manzu, $\\texttt{1p},\\texttt{2p},\\dots,\\texttt{9p}$ for pinzu, $\\texttt{1s},\\texttt{2s},\\dots,\\texttt{9s}$ for souzu, $\\texttt E,\\texttt S,\\texttt W,\\texttt N$ for East, South, West, North, and $\\texttt Z,\\texttt B,\\texttt F$ for Red, White, Green. Adjacent tiles are separated by a single space, and each line ends with a standalone $0$ indicating the end.", "outputFormat": "The output should contain $T$ lines. For each test case, output one integer, the maximum score.", "hint": "### Sample Explanation\n\nIn the first test case, no tiles have been discarded, and there are no dora tiles. “Thirteen Orphans” has the highest score, which is $13 \\times 6 \\times 4^{12}$.  \nThe scores for “$3 \\times 4 + 2$” and “Seven Pairs” are $100663296$ and $1959552$, respectively.\n\nIn the second test case, “$3 \\times 4 + 2$” has the highest score, which is $127401984$. One hand that achieves this score is “$\\texttt{1m2m3m 7m8m9m 1p2p3p 3p4p5p SS}$”.  \nThe score for “Seven Pairs” is $125411328$, and it is impossible to form “Thirteen Orphans”.\n\n### Constraints\n\nIt is guaranteed that the discarded tiles are always legal tiles, and for each type there are no more than $4$ copies. Dora tiles are given without repetition.\n\n|Test Point ID|Scale of $T$|Discarded Tiles|Number of Dora Tiles|\n|:-:|:-:|:-:|:-:|\n|$1$|$T = 10$|No special restrictions|$\\le 20$ tiles|\n|$2$|$T = 100$|Includes at least all number tiles from $3$ to $7$|$\\le 20$ tiles|\n|$3$|$T = 500$|At least $2$ copies of each type|$\\le 20$ tiles|\n|$4$|$T = 500$|At least $3$ copies of each type|$\\le 20$ tiles|\n|$5$|$T = 500$|No special restrictions|$0$ tiles|\n|$6$|$T = 1,000$|No special restrictions|$0$ tiles|\n|$7$|$T = 1,000$|No special restrictions|$\\le 20$ tiles|\n|$8$|$T = 1,500$|No special restrictions|$\\le 20$ tiles|\n|$9$|$T = 2,000$|No special restrictions|$\\le 20$ tiles|\n|$10$|$T = 2,500$|No special restrictions|$\\le 20$ tiles|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[GXOI/GZOI2019] 宝牌一大堆", "background": "", "description": "麻将是一种传统的博弈游戏，由 $4$ 名玩家参与，轮流摸牌、打牌。在竞技比赛中主要有国标麻将（中国）和立直麻将（日本）两大规则。本题采用一种特别的规则——「宝牌一大堆」规则。\n\n#### 牌型\n一副麻将由 $136$ 张牌组成，其中包含 $34$ 种不同的牌，每种各有 $4$ 张。这 $34$ 种牌分别是：  \n一万到九万、一索到九索、一筒到九筒、东、南、西、北、中、白、发。\n\n![doraippai1.png](https://cdn.luogu.com.cn/upload/pic/56677.png)\n\n它们可以组合成不同的牌型：\n- 顺子：$3$ 张数字连续的万，或 $3$ 张数字连续的索，或 $3$ 张数字连续的筒。\n- 刻子：$3$ 张完全一样的牌。\n- 杠子：$4$ 张完全一样的牌。\n- 雀头：$2$ 张完全一样的牌。\n\n其中顺子和刻子统称为面子。\n\n#### 和牌\n手牌（一名玩家持有的牌）宣告胜利的状况称为「和牌」。\n- 当玩家持有 $14$ 张牌，并且满足以下三个条件之一时，判定为「和牌」：\n  1. 存在一种方案，使得这 $14$ 张牌可以分成 $4$ 组面子、$1$ 组雀头，简记为「$3 \\times 4 + 2$」。\n  2. 存在一种方案，使得这 $14$ 张牌可以分成 $7$ 组**不同的**雀头，称为「七对子」。\n  3. 这 $14$ 张牌**仅由**一万、九万、一索、九索、一筒、九筒、东、南、西、北、中、白、发这 $13$ 种牌组成，并且这 $13$ 种牌**每种至少有 $1$ 张**，称为「国士无双」。\n- 当玩家持有 $15$ 张牌，并且存在一种方案，使得这 $15$ 张牌可以分成 $1$ 组杠子、$3$ 组面子、$1$ 组雀头，判定为和牌。\n- 当玩家持有 $16$ 张牌，并且存在一种方案，使得这 $16$ 张牌可以分成 $2$ 组杠子、$2$ 组面子、$1$ 组雀头，判定为和牌。\n- 当玩家持有 $17$ 张牌，并且存在一种方案，使得这 $17$ 张牌可以分成 $3$ 组杠子、$1$ 组面子、$1$ 组雀头，判定为和牌。\n- 当玩家持有 $18$ 张牌，并且存在一种方案，使得这 $18$ 张牌可以分成 $4$ 组杠子、$1$ 组雀头，判定为和牌。\n\n#### 宝牌\n每局游戏还会指定若干张「宝牌」，和牌时，手牌中的每张宝牌会使收益翻一番（会在接下来详细介绍）。\n\n#### 达成分数\n由于可以「和牌」的手牌很多，可以给每种判定为「和牌」的手牌定义一个「达成分数」，这个分数等于从所有尚未打出的牌中选出若干张，能够组成该手牌的方法数，再乘上手牌中 $2$ 的「宝牌数」次方。  \n该分数综合考虑了和牌几率与和牌收益，理论上以分数较高的手牌为目标较好。\n\n例如下图手牌显然是可以「和牌」的，如果目前场上还剩 $3$ 张一万、$4$ 张九万，以及二到八万各 $2$ 张没有打出，宝牌为九万，那么下图手牌的「达成分数」就是 $C_3^3 C_4^3 C_2^2 (C_2^1)^6 2^3 = 2048$，其中 $C$ 表示组合数。\n\n![doraippai2.png](https://cdn.luogu.com.cn/upload/pic/56678.png)\n\n特别地，「七对子」和牌的手牌，达成分数额外乘 $7$。「国士无双」和牌的手牌，达成分数额外乘 $13$。\n\n有一天，小 L，小 Y，小 I 和小 W 正在打麻将，路过的雪野和看到了所有已经打出的牌，但不知道任何一名玩家的手牌。也许你已经猜到了下面的剧情—\n—雪野和想知道在所有尚未打出的牌中，「达成分数」最高的可以「和牌」的手牌有多少分，但是她还要观看麻将比赛，所以这个问题就交给你了。", "inputFormat": "每个测试点包含多组数据，第一行是一个整数 $T$，表示数据组数。注意各组数据之间是互相独立的。\n\n每组数据包含两行，第一行给出场上已经打出的牌，第二行给出该局的所有宝牌。\n\n规定用 $\\texttt{1m},\\texttt{2m},\\dots,\\texttt{9m}$ 代表万，$\\texttt{1p},\\texttt{2p},\\dots,\\texttt{9p}$ 代表筒，$\\texttt{1s},\\texttt{2s},\\dots,\\texttt{9s}$ 代表索，$\\texttt E,\\texttt S,\\texttt W,\\texttt N$ 代表东、南、西、北，$\\texttt Z,\\texttt B,\\texttt F$ 代表中、白、发，相邻两张牌之间用一个空格隔开，每行的末尾有一个单独的 $0$ 代表结束。", "outputFormat": "输出文件应包含 $T$ 行，对于每组数据，输出一个整数表示最高分数。", "hint": "### 样例解释\n\n在第一组数据中，没有打出过任何牌，没有宝牌，和「国士无双」分数最高，为 $13 \\times 6 \\times 4^{12}$。  \n和「$3 \\times 4 + 2$」和「七对子」的分数为 $100663296$ 和 $1959552$。\n\n在第二组数据中，和「$3 \\times 4 + 2$」分数最高，为 $127401984$，可以得到该分数的手牌之一为「$\\texttt{1m2m3m 7m8m9m 1p2p3p 3p4p5p SS}$」。  \n和「七对子」的分数为 $125411328$，不存在和「国士无双」的可能。\n\n### 数据范围\n\n保证已经打出的牌必定是合法的牌，且每种不超过 $4$ 张。宝牌不会重复给出。\n\n|测试点编号|$T$ 的规模|已经打出的牌|宝牌数|\n|:-:|:-:|:-:|:-:|\n|$1$|$T = 10$|无特殊限制|$\\le 20$ 张|\n|$2$|$T = 100$|至少包括所有数字为三到七的牌|$\\le 20$ 张|\n|$3$|$T = 500$|每种至少 $2$ 张|$\\le 20$ 张|\n|$4$|$T = 500$|每种至少 $3$ 张|$\\le 20$ 张|\n|$5$|$T = 500$|无特殊限制|$0$ 张|\n|$6$|$T = 1,000$|无特殊限制|$0$ 张|\n|$7$|$T = 1,000$|无特殊限制|$\\le 20$ 张|\n|$8$|$T = 1,500$|无特殊限制|$\\le 20$ 张|\n|$9$|$T = 2,000$|无特殊限制|$\\le 20$ 张|\n|$10$|$T = 2,500$|无特殊限制|$\\le 20$ 张|", "locale": "zh-CN"}}}
{"pid": "P5302", "type": "P", "difficulty": 7, "samples": [["4 1 2 3 1 6\n1 2 3 4\n4 1 3 2\n2\n3 3 1\n5 2 2", "13 15"], ["10 73 28 13 0 100\n2 9 16 25 29 34 43 46 52 58\n8 25 35 52 41 5 16 3 19 48\n5\n46 40 1\n37 27 5\n67 34 1\n65 28 4\n29 38 1", "989 1619"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["计算几何", "2019", "各省省选", "离散化", "贵州", "广西", "扫描线"], "title": "[GXOI/GZOI2019] 特技飞行", "background": "", "description": "公元 $9012$ 年，Z 市的航空基地计划举行一场特技飞行表演。表演的场地可以看作一个二维平面直角坐标系，其中横坐标代表着水平位置，纵坐标代表着飞行高度。\n\n在最初的计划中，这 $n$ 架飞机首先会飞行到起点 $x = x_{st}$ 处，其中第 $i$ 架飞机在起点处的高度为 $y_{i,0}$。它们的目标是终点 $x = x_{ed}$ 处，其中第 $i$ 架飞机在终点处的高度应为 $y_{i,1}$。因此，每架飞机可以看作坐标系中的一个点，它的航线是从 $(x_{st},y_{i,0})$ 出发、到 $(x_{ed},y_{i,1})$ 结束的一条线段，如下图所示。\n\n![aerobatics1.png](https://cdn.luogu.com.cn/upload/pic/56679.png)\n\n这 $n$ 架飞机同时出发且始终保持一定的对地速度。因此，对于任意两条交叉的航线（线段），对应的两架飞机必然会同时到达交点处——这就是它们进行特技表演的时刻。它们将会偏转机翼，展现以极近的距离「擦身而过」特技，然后**继续保持各自的航线**。\n\n航空基地最近还研究了一种新的特技「对向交换」。当两架飞机到达交点处时，之前正在下降的那架立即转为执行抬升动作，之前正在上升的那架则执行一次空翻，两架飞机一上一下、机腹对机腹，同样以极近的距离经过交点，然后**互相交换接下来的航线**。\n\n我们不必关心特技动作在物理上究竟是如何实现的，飞机仍然看作一个点，在两种特技动作下，航线的变化如下图所示（$y_{i,1}'$ 表示交换航线后第 $i$ 架飞机在终点的新高度）。容易发现，「对向交换」会使它们的航线变为折线，并**保持它们在纵坐标上的相对顺序**；而「擦身而过」会**改变它们在纵坐标上的相对顺序**。\n\n![aerobatics2.png](https://cdn.luogu.com.cn/upload/pic/56680.png)\n\n现在，观看表演的嘉宾团提出了一个苛刻的要求——在终点 $x = x_{ed}$ 处，按照高度排序，$n$ 架飞机的相对顺序必须与 $x = x_{st}$ 处的相对顺序一致。嘉宾团还给「对向交换」特技和「擦身而过」特技分别评定了难度系数 $a$ 和 $b$，每次「对向交换」特技可以获得 $a$ 的分数，每次「擦身而过」特技可以获得 $b$ 的分数。\n\n除此以外，嘉宾团共有 $k$ 名成员，第 $i$ 名成员会乘热气球停留在位置 $(p_i,q_i)$ 处，具有 $r_i$ 的观测距离，可以观测到区域 $|x - p_i| + |y - q_i| \\le r_i$ 里的所有特技。  \n若某个交点处的特技被**一名或多名**嘉宾观测到，则可以获得 $c$ 的额外加分。  \n注意：**特技无论是否被观测到，均可以获得 $a$ 或者 $b$ 的得分**。\n\n下图是对本题第一幅图 $4$ 条航线 $4$ 个交点的一种满足要求的安排，包括 $2$ 次「对向交换」、$2$ 次「擦身而过」，$3$ 项特技被观测到，得分 $2a + 2b + 3c$。为了方便观察，图中展现「对向交换」特技的交点稍稍有些分离。\n\n![aerobatics3.png](https://cdn.luogu.com.cn/upload/pic/56681.png)\n\n在这次的剧情里，你成为了 Z 市航空基地的规划员，你可以决定在每个交点处是执行「对向交换」还是「擦身而过」。你被要求在保证嘉宾团要求的前提下，计算整个特技表演的可能得到的最低和最高分数。", "inputFormat": "第一行包含六个非负整数 $n,a,b,c,x_{st},x_{ed}$，分别表示航线（线段）总数、「对向交换」特技的得分、「擦身而过」特技的得分、观测对表演的额外分、飞行起点的横坐标、飞行终点的横坐标。\n\n第二行包含 $n$ 个非负整数 $y_{i,0}$，其中第 $i$ 个数表示第 $i$ 条航线起点的纵坐标，保证按照从低到高的顺序给出，即 $y_{i,0} < y_{i + 1,0}$。\n\n第三行包含 $n$ 个非负整数 $y_{i,1}$，其中第 $i$ 个数表示第 $i$ 条航线终点的纵坐标。\n\n第四行包含一个非负整数 $k$，表示嘉宾的数量。\n\n接下来 $k$ 行每行三个非负整数 $p_i,q_i,r_i$，分别表示第 $i$ 名嘉宾所在位置的横、纵坐标与观测距离。\n\n输入数据对于所有航线（线段）在直线 $x = x_{st}$ 和 $x = x_{ed}$ 之间的交点总数也有一些限制，详见「数据范围与提示」。", "outputFormat": "输出只有一行，包含两个整数，表示整个特技飞行表演的可能得到的最低和最高分数，中间用一个空格隔开。", "hint": "### 样例1解释\n\n该样例的航线就是题目描述的图中所画的情况，只是嘉宾所在的位置稍有不同。  \n最低得分的表演方案是在所有交点处均采用「对向交换」特技，得分 $4a + 3c = 13$。  \n最高得分的表演方案与题目描述的图中所画的情况一致，得分 $2a + 2b + 3c = 15$。\n\n### 数据范围\n\n不存在三条或三条以上的线段交于同一点。  \n所有坐标和 $r_i$ 均为 $5 \\times 10^7$ 以内的非负整数。  \n$y_{i,0} < y_{i + 1,0}$，$y_{i,1}$ 各不相同。  \n$x_{st} < p_i < x_{ed},1 ≤ a,b,c ≤ 10^3$。\n\n|测试点编号|$n,k$ 的规模|交点数的规模|约定|\n|:-:|:-:|:-:|:-:|\n|$1$|$n,k \\le 15$|$\\le 40$|无|\n|$2$|$n,k \\le 15$|$\\le 40$|无|\n|$3$|$n,k \\le 15$|$\\le 40$|无|\n|$4$|$n,k \\le 15$|$\\le 40$|无|\n|$5$|$n \\le 30,000,k \\le 100$|$\\le 200,000$|无|\n|$6$|$n \\le 30,000,k \\le 100$|$\\le 200,000$|无|\n|$7$|$n \\le 30,000,k \\le 100$|$\\le 200,000$|无|\n|$8$|$n \\le 30,000,k \\le 100$|$\\le 200,000$|无|\n|$9$|$n,k \\le 100,000$|$\\le 500,000$|$a = b$|\n|$10$|$n,k \\le 100,000$|$\\le 500,000$|$a = b$|\n|$11$|$n,k \\le 100,000$|$\\le 500,000$|$a = b$|\n|$12$|$n,k \\le 100,000$|$\\le 500,000$|$a = b$|\n|$13$|$n,k \\le 50,000$|$\\le 250,000$|无|\n|$14$|$n,k \\le 50,000$|$\\le 250,000$|无|\n|$15$|$n,k \\le 50,000$|$\\le 250,000$|无|\n|$16$|$n,k \\le 50,000$|$\\le 250,000$|无|\n|$17$|$n,k \\le 100,000$|$\\le 500,000$|无|\n|$18$|$n,k \\le 100,000$|$\\le 500,000$|无|\n|$19$|$n,k \\le 100,000$|$\\le 500,000$|无|\n|$20$|$n,k \\le 100,000$|$\\le 500,000$|无|", "locale": "zh-CN", "translations": {"en": {"title": "[GXOI/GZOI2019] Aerobatic Flight", "background": "", "description": "In the year $9012$, the aviation base of City Z plans to hold an aerobatic flight show. The show venue can be seen as a 2D Cartesian coordinate system, where the $x$-coordinate represents the horizontal position and the $y$-coordinate represents the flight altitude.\n\nIn the initial plan, these $n$ aircraft will first fly to the starting line $x = x_{st}$. For aircraft $i$, its altitude at the start is $y_{i,0}$. Their destination is the ending line $x = x_{ed}$, where aircraft $i$ should be at altitude $y_{i,1}$. Therefore, each aircraft can be viewed as a point in the coordinate system, and its route is a line segment starting from $(x_{st}, y_{i,0})$ and ending at $(x_{ed}, y_{i,1})$, as shown below.\n\n![aerobatics1.png](https://cdn.luogu.com.cn/upload/pic/56679.png)\n\nAll $n$ aircraft depart at the same time and always maintain a constant ground speed. Therefore, for any two intersecting routes (segments), the two corresponding aircraft will 반드시 reach the intersection point at the same time—this is the moment they perform an aerobatic stunt. They will bank their wings and perform a close “pass-by” stunt, and then **continue along their own routes**.\n\nThe aviation base has also recently developed a new stunt called “head-on swap”. When two aircraft reach the intersection point, the one that was descending immediately starts climbing, while the one that was climbing performs a flip. The two aircraft pass the intersection point one above the other, belly to belly, also at a very close distance, and then **swap their remaining routes**.\n\nWe do not need to care how these stunts are physically achieved. Aircraft are still treated as points. Under these two stunts, the route changes are shown below ($y_{i,1}'$ denotes the new ending altitude of aircraft $i$ after swapping routes). It is easy to see that “head-on swap” turns their routes into polylines and **keeps their relative order in the $y$-coordinate**; while “pass-by” **changes their relative order in the $y$-coordinate**.\n\n![aerobatics2.png](https://cdn.luogu.com.cn/upload/pic/56680.png)\n\nNow, the visiting guests提出 a strict requirement: at the ending line $x = x_{ed}$, when sorting by altitude, the relative order of the $n$ aircraft must be the same as the relative order at $x = x_{st}$. The guests also assign difficulty coefficients $a$ and $b$ to the “head-on swap” stunt and the “pass-by” stunt, respectively. Each “head-on swap” gives a score of $a$, and each “pass-by” gives a score of $b$.\n\nIn addition, there are $k$ guests. Guest $i$ stays in a hot-air balloon at position $(p_i, q_i)$ and has an observation range $r_i$, so they can observe all stunts within the region $|x - p_i| + |y - q_i| \\le r_i$.  \nIf a stunt at some intersection point is observed by **one or more** guests, an extra bonus score of $c$ is obtained.  \nNote: **Whether or not a stunt is observed, it still earns the score $a$ or $b$.**\n\nThe figure below shows, for the $4$ routes and $4$ intersections in the first figure, one arrangement that meets the requirement: it includes $2$ “head-on swap” stunts, $2$ “pass-by” stunts, and $3$ stunts are observed, for a total score of $2a + 2b + 3c$. For easier viewing, the intersections where “head-on swap” occurs are drawn slightly separated.\n\n![aerobatics3.png](https://cdn.luogu.com.cn/upload/pic/56681.png)\n\nIn this story, you are the planner of City Z’s aviation base. You can decide, at each intersection point, whether to perform “head-on swap” or “pass-by”. You are required, while ensuring the guests’ requirement, to compute the minimum and maximum total scores that the whole aerobatic show can achieve.", "inputFormat": "The first line contains six non-negative integers $n, a, b, c, x_{st}, x_{ed}$, representing the total number of routes (segments), the score for the “head-on swap” stunt, the score for the “pass-by” stunt, the extra bonus for being observed, the $x$-coordinate of the starting line, and the $x$-coordinate of the ending line.\n\nThe second line contains $n$ non-negative integers $y_{i,0}$. The $i$-th number is the $y$-coordinate of the start point of route $i$. It is guaranteed that they are given in increasing order, i.e. $y_{i,0} < y_{i + 1,0}$.\n\nThe third line contains $n$ non-negative integers $y_{i,1}$. The $i$-th number is the $y$-coordinate of the end point of route $i$.\n\nThe fourth line contains a non-negative integer $k$, the number of guests.\n\nThe next $k$ lines each contain three non-negative integers $p_i, q_i, r_i$, representing the $x$-coordinate, $y$-coordinate, and observation range of guest $i$.\n\nThe input also imposes some limits on the total number of intersection points of all routes (segments) between the lines $x = x_{st}$ and $x = x_{ed}$. See “Constraints and Hint” for details.", "outputFormat": "Output only one line containing two integers: the minimum and maximum possible total scores of the whole aerobatic show, separated by a space.", "hint": "### Sample 1 Explanation\n\nThe routes in this sample are exactly those shown in the figure in the statement, except that the guests’ positions are slightly different.  \nThe minimum-score plan uses the “head-on swap” stunt at all intersection points, with score $4a + 3c = 13$.  \nThe maximum-score plan is the same as the one shown in the figure in the statement, with score $2a + 2b + 3c = 15$.\n\n### Constraints\n\nNo three or more segments intersect at the same point.  \nAll coordinates and $r_i$ are non-negative integers not exceeding $5 \\times 10^7$.  \n$y_{i,0} < y_{i + 1,0}$, and all $y_{i,1}$ are distinct.  \n$x_{st} < p_i < x_{ed}, 1 \\le a, b, c \\le 10^3$.\n\n|Test Point ID|Scale of $n, k$|Scale of number of intersections|Notes|\n|:-:|:-:|:-:|:-:|\n|$1$|$n, k \\le 15$|$\\le 40$|None|\n|$2$|$n, k \\le 15$|$\\le 40$|None|\n|$3$|$n, k \\le 15$|$\\le 40$|None|\n|$4$|$n, k \\le 15$|$\\le 40$|None|\n|$5$|$n \\le 30,000, k \\le 100$|$\\le 200,000$|None|\n|$6$|$n \\le 30,000, k \\le 100$|$\\le 200,000$|None|\n|$7$|$n \\le 30,000, k \\le 100$|$\\le 200,000$|None|\n|$8$|$n \\le 30,000, k \\le 100$|$\\le 200,000$|None|\n|$9$|$n, k \\le 100,000$|$\\le 500,000$|$a = b$|\n|$10$|$n, k \\le 100,000$|$\\le 500,000$|$a = b$|\n|$11$|$n, k \\le 100,000$|$\\le 500,000$|$a = b$|\n|$12$|$n, k \\le 100,000$|$\\le 500,000$|$a = b$|\n|$13$|$n, k \\le 50,000$|$\\le 250,000$|None|\n|$14$|$n, k \\le 50,000$|$\\le 250,000$|None|\n|$15$|$n, k \\le 50,000$|$\\le 250,000$|None|\n|$16$|$n, k \\le 50,000$|$\\le 250,000$|None|\n|$17$|$n, k \\le 100,000$|$\\le 500,000$|None|\n|$18$|$n, k \\le 100,000$|$\\le 500,000$|None|\n|$19$|$n, k \\le 100,000$|$\\le 500,000$|None|\n|$20$|$n, k \\le 100,000$|$\\le 500,000$|None|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[GXOI/GZOI2019] 特技飞行", "background": "", "description": "公元 $9012$ 年，Z 市的航空基地计划举行一场特技飞行表演。表演的场地可以看作一个二维平面直角坐标系，其中横坐标代表着水平位置，纵坐标代表着飞行高度。\n\n在最初的计划中，这 $n$ 架飞机首先会飞行到起点 $x = x_{st}$ 处，其中第 $i$ 架飞机在起点处的高度为 $y_{i,0}$。它们的目标是终点 $x = x_{ed}$ 处，其中第 $i$ 架飞机在终点处的高度应为 $y_{i,1}$。因此，每架飞机可以看作坐标系中的一个点，它的航线是从 $(x_{st},y_{i,0})$ 出发、到 $(x_{ed},y_{i,1})$ 结束的一条线段，如下图所示。\n\n![aerobatics1.png](https://cdn.luogu.com.cn/upload/pic/56679.png)\n\n这 $n$ 架飞机同时出发且始终保持一定的对地速度。因此，对于任意两条交叉的航线（线段），对应的两架飞机必然会同时到达交点处——这就是它们进行特技表演的时刻。它们将会偏转机翼，展现以极近的距离「擦身而过」特技，然后**继续保持各自的航线**。\n\n航空基地最近还研究了一种新的特技「对向交换」。当两架飞机到达交点处时，之前正在下降的那架立即转为执行抬升动作，之前正在上升的那架则执行一次空翻，两架飞机一上一下、机腹对机腹，同样以极近的距离经过交点，然后**互相交换接下来的航线**。\n\n我们不必关心特技动作在物理上究竟是如何实现的，飞机仍然看作一个点，在两种特技动作下，航线的变化如下图所示（$y_{i,1}'$ 表示交换航线后第 $i$ 架飞机在终点的新高度）。容易发现，「对向交换」会使它们的航线变为折线，并**保持它们在纵坐标上的相对顺序**；而「擦身而过」会**改变它们在纵坐标上的相对顺序**。\n\n![aerobatics2.png](https://cdn.luogu.com.cn/upload/pic/56680.png)\n\n现在，观看表演的嘉宾团提出了一个苛刻的要求——在终点 $x = x_{ed}$ 处，按照高度排序，$n$ 架飞机的相对顺序必须与 $x = x_{st}$ 处的相对顺序一致。嘉宾团还给「对向交换」特技和「擦身而过」特技分别评定了难度系数 $a$ 和 $b$，每次「对向交换」特技可以获得 $a$ 的分数，每次「擦身而过」特技可以获得 $b$ 的分数。\n\n除此以外，嘉宾团共有 $k$ 名成员，第 $i$ 名成员会乘热气球停留在位置 $(p_i,q_i)$ 处，具有 $r_i$ 的观测距离，可以观测到区域 $|x - p_i| + |y - q_i| \\le r_i$ 里的所有特技。  \n若某个交点处的特技被**一名或多名**嘉宾观测到，则可以获得 $c$ 的额外加分。  \n注意：**特技无论是否被观测到，均可以获得 $a$ 或者 $b$ 的得分**。\n\n下图是对本题第一幅图 $4$ 条航线 $4$ 个交点的一种满足要求的安排，包括 $2$ 次「对向交换」、$2$ 次「擦身而过」，$3$ 项特技被观测到，得分 $2a + 2b + 3c$。为了方便观察，图中展现「对向交换」特技的交点稍稍有些分离。\n\n![aerobatics3.png](https://cdn.luogu.com.cn/upload/pic/56681.png)\n\n在这次的剧情里，你成为了 Z 市航空基地的规划员，你可以决定在每个交点处是执行「对向交换」还是「擦身而过」。你被要求在保证嘉宾团要求的前提下，计算整个特技表演的可能得到的最低和最高分数。", "inputFormat": "第一行包含六个非负整数 $n,a,b,c,x_{st},x_{ed}$，分别表示航线（线段）总数、「对向交换」特技的得分、「擦身而过」特技的得分、观测对表演的额外分、飞行起点的横坐标、飞行终点的横坐标。\n\n第二行包含 $n$ 个非负整数 $y_{i,0}$，其中第 $i$ 个数表示第 $i$ 条航线起点的纵坐标，保证按照从低到高的顺序给出，即 $y_{i,0} < y_{i + 1,0}$。\n\n第三行包含 $n$ 个非负整数 $y_{i,1}$，其中第 $i$ 个数表示第 $i$ 条航线终点的纵坐标。\n\n第四行包含一个非负整数 $k$，表示嘉宾的数量。\n\n接下来 $k$ 行每行三个非负整数 $p_i,q_i,r_i$，分别表示第 $i$ 名嘉宾所在位置的横、纵坐标与观测距离。\n\n输入数据对于所有航线（线段）在直线 $x = x_{st}$ 和 $x = x_{ed}$ 之间的交点总数也有一些限制，详见「数据范围与提示」。", "outputFormat": "输出只有一行，包含两个整数，表示整个特技飞行表演的可能得到的最低和最高分数，中间用一个空格隔开。", "hint": "### 样例1解释\n\n该样例的航线就是题目描述的图中所画的情况，只是嘉宾所在的位置稍有不同。  \n最低得分的表演方案是在所有交点处均采用「对向交换」特技，得分 $4a + 3c = 13$。  \n最高得分的表演方案与题目描述的图中所画的情况一致，得分 $2a + 2b + 3c = 15$。\n\n### 数据范围\n\n不存在三条或三条以上的线段交于同一点。  \n所有坐标和 $r_i$ 均为 $5 \\times 10^7$ 以内的非负整数。  \n$y_{i,0} < y_{i + 1,0}$，$y_{i,1}$ 各不相同。  \n$x_{st} < p_i < x_{ed},1 ≤ a,b,c ≤ 10^3$。\n\n|测试点编号|$n,k$ 的规模|交点数的规模|约定|\n|:-:|:-:|:-:|:-:|\n|$1$|$n,k \\le 15$|$\\le 40$|无|\n|$2$|$n,k \\le 15$|$\\le 40$|无|\n|$3$|$n,k \\le 15$|$\\le 40$|无|\n|$4$|$n,k \\le 15$|$\\le 40$|无|\n|$5$|$n \\le 30,000,k \\le 100$|$\\le 200,000$|无|\n|$6$|$n \\le 30,000,k \\le 100$|$\\le 200,000$|无|\n|$7$|$n \\le 30,000,k \\le 100$|$\\le 200,000$|无|\n|$8$|$n \\le 30,000,k \\le 100$|$\\le 200,000$|无|\n|$9$|$n,k \\le 100,000$|$\\le 500,000$|$a = b$|\n|$10$|$n,k \\le 100,000$|$\\le 500,000$|$a = b$|\n|$11$|$n,k \\le 100,000$|$\\le 500,000$|$a = b$|\n|$12$|$n,k \\le 100,000$|$\\le 500,000$|$a = b$|\n|$13$|$n,k \\le 50,000$|$\\le 250,000$|无|\n|$14$|$n,k \\le 50,000$|$\\le 250,000$|无|\n|$15$|$n,k \\le 50,000$|$\\le 250,000$|无|\n|$16$|$n,k \\le 50,000$|$\\le 250,000$|无|\n|$17$|$n,k \\le 100,000$|$\\le 500,000$|无|\n|$18$|$n,k \\le 100,000$|$\\le 500,000$|无|\n|$19$|$n,k \\le 100,000$|$\\le 500,000$|无|\n|$20$|$n,k \\le 100,000$|$\\le 500,000$|无|", "locale": "zh-CN"}}}
{"pid": "P5303", "type": "P", "difficulty": 6, "samples": [["3\n1\n2\n4", "0\n0\n6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "贵州", "广西"], "title": "[GXOI/GZOI2019] 逼死强迫症", "background": "", "description": "ITX351 要铺一条 $2 \\times N$ 的路，为此他购买了 $N$ 块 $2 \\times 1$ 的方砖。可是其中一块砖在运送的过程中从中间裂开了，变成了两块 $1 \\times 1$ 的砖块！  \nITX351 由此产生了一个邪恶的想法：他想要在这条路上故意把两块 $1 \\times 1$ 的砖块分开铺，**不让两块砖有相邻的边**，其他砖块可以随意铺，直到整条路铺满。这样一定可以逼死自身强迫症 sea5！\n\n也许下面的剧情你已经猜到了——他为此兴奋不已，以至于无法敲键盘。于是，他请你帮忙计算一下，有多少种方案可以让自己的阴谋得逞。", "inputFormat": "每个测试点包含多组数据，输入文件的第一行是一个正整数 $T$，表示数据的组数。注意各组数据之间是独立无关的。\n\n接下来 $T$ 行，每行包含一个正整数 $N$，代表一组数据中路的长度。", "outputFormat": "输出应包含 $T$ 行，对于每组数据，输出一个正整数，表示满足条件的方案数。\n\n由于答案可能非常的大，你只需要输出答案对 $1000000007 (10^9 + 7)$ 取模后的结果。", "hint": "样例中 $ N=4 $ 解释见下图：\n\n![](https://cdn.luogu.com.cn/upload/pic/56734.png)\n\n### 数据范围\n\n|测试点编号|$N$ 的规模|$T$ 的规模|\n|:-:|:-:|:-:|\n|$1$|$N \\le 10$|$T \\le 10$|\n|$2$|$N \\le 10$|$T \\le 10$|\n|$3$|$N \\le 10^5$|$T \\le 50$|\n|$4$|$N \\le 10^5$|$T \\le 50$|\n|$5$|$N \\le 10^5$|$T \\le 50$|\n|$6$|$N \\le 2 \\times 10^9$|$T \\le 50$|\n|$7$|$N \\le 2 \\times 10^9$|$T \\le 50$|\n|$8$|$N \\le 2 \\times 10^9$|$T \\le 50$|\n|$9$|$N \\le 2 \\times 10^9$|$T \\le 500$|\n|$10$|$N \\le 2 \\times 10^9$|$T \\le 500$|", "locale": "zh-CN", "translations": {"en": {"title": "[GXOI/GZOI2019] Forcing OCD to Death", "background": "", "description": "ITX351 wants to pave a $2 \\times N$ road, so he bought $N$ $2 \\times 1$ bricks. However, one brick cracked in the middle during transportation and became two $1 \\times 1$ blocks.  \nThis gave ITX351 an evil idea: he wants to deliberately place the two $1 \\times 1$ blocks separately on the road, **making sure the two blocks do not share any adjacent edge**. The other bricks can be placed in any way, until the whole road is fully covered. This will surely drive his own OCD (sea5) crazy!\n\nMaybe you have already guessed what happens next—he got so excited that he could not type anymore. So he asks you to help compute how many different ways there are to make his plot succeed.", "inputFormat": "Each test point contains multiple test cases. The first line of the input file is a positive integer $T$, which denotes the number of test cases. Note that different test cases are independent.\n\nThe next $T$ lines each contain a positive integer $N$, representing the length of the road in that test case.", "outputFormat": "The output should contain $T$ lines. For each test case, output a positive integer, representing the number of valid tilings that satisfy the condition.\n\nSince the answer may be very large, you only need to output the result modulo $1000000007 (10^9 + 7)$.", "hint": "For the sample, the explanation for $N = 4$ is shown in the figure below:\n\n![](https://cdn.luogu.com.cn/upload/pic/56734.png)\n\n### Constraints\n\n|Test point ID|Scale of $N$|Scale of $T$|\n|:-:|:-:|:-:|\n|$1$|$N \\le 10$|$T \\le 10$|\n|$2$|$N \\le 10$|$T \\le 10$|\n|$3$|$N \\le 10^5$|$T \\le 50$|\n|$4$|$N \\le 10^5$|$T \\le 50$|\n|$5$|$N \\le 10^5$|$T \\le 50$|\n|$6$|$N \\le 2 \\times 10^9$|$T \\le 50$|\n|$7$|$N \\le 2 \\times 10^9$|$T \\le 50$|\n|$8$|$N \\le 2 \\times 10^9$|$T \\le 50$|\n|$9$|$N \\le 2 \\times 10^9$|$T \\le 500$|\n|$10$|$N \\le 2 \\times 10^9$|$T \\le 500$|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[GXOI/GZOI2019] 逼死强迫症", "background": "", "description": "ITX351 要铺一条 $2 \\times N$ 的路，为此他购买了 $N$ 块 $2 \\times 1$ 的方砖。可是其中一块砖在运送的过程中从中间裂开了，变成了两块 $1 \\times 1$ 的砖块！  \nITX351 由此产生了一个邪恶的想法：他想要在这条路上故意把两块 $1 \\times 1$ 的砖块分开铺，**不让两块砖有相邻的边**，其他砖块可以随意铺，直到整条路铺满。这样一定可以逼死自身强迫症 sea5！\n\n也许下面的剧情你已经猜到了——他为此兴奋不已，以至于无法敲键盘。于是，他请你帮忙计算一下，有多少种方案可以让自己的阴谋得逞。", "inputFormat": "每个测试点包含多组数据，输入文件的第一行是一个正整数 $T$，表示数据的组数。注意各组数据之间是独立无关的。\n\n接下来 $T$ 行，每行包含一个正整数 $N$，代表一组数据中路的长度。", "outputFormat": "输出应包含 $T$ 行，对于每组数据，输出一个正整数，表示满足条件的方案数。\n\n由于答案可能非常的大，你只需要输出答案对 $1000000007 (10^9 + 7)$ 取模后的结果。", "hint": "样例中 $ N=4 $ 解释见下图：\n\n![](https://cdn.luogu.com.cn/upload/pic/56734.png)\n\n### 数据范围\n\n|测试点编号|$N$ 的规模|$T$ 的规模|\n|:-:|:-:|:-:|\n|$1$|$N \\le 10$|$T \\le 10$|\n|$2$|$N \\le 10$|$T \\le 10$|\n|$3$|$N \\le 10^5$|$T \\le 50$|\n|$4$|$N \\le 10^5$|$T \\le 50$|\n|$5$|$N \\le 10^5$|$T \\le 50$|\n|$6$|$N \\le 2 \\times 10^9$|$T \\le 50$|\n|$7$|$N \\le 2 \\times 10^9$|$T \\le 50$|\n|$8$|$N \\le 2 \\times 10^9$|$T \\le 50$|\n|$9$|$N \\le 2 \\times 10^9$|$T \\le 500$|\n|$10$|$N \\le 2 \\times 10^9$|$T \\le 500$|", "locale": "zh-CN"}}}
{"pid": "P5304", "type": "P", "difficulty": 5, "samples": [["2\n6 7 3\n1 5 3\n2 3 5\n1 4 3\n5 3 2\n4 6 5\n4 3 7\n5 6 4\n1 3 6\n7 7 4\n5 3 10\n6 2 7\n1 2 6\n5 4 2\n4 3 4\n1 7 3\n7 2 4\n1 2 5 3", "5\n6\n"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2019", "各省省选", "最短路", "贵州", "广西", "进制"], "title": "[GXOI/GZOI2019] 旅行者", "background": "", "description": "J 国有 $n$ 座城市，这些城市之间通过 $m$ 条单向道路相连，已知每条道路的长度。\n\n一次，居住在 J 国的 Rainbow 邀请 Vani 来作客。不过，作为一名资深的旅行者，Vani 只对 J 国的 $k$ 座历史悠久、自然风景独特的城市感兴趣。  \n为了提升旅行的体验，Vani 想要知道他感兴趣的城市之间「两两最短路」的最小值（即在他感兴趣的城市中，最近的一对的最短距离）。\n\n也许下面的剧情你已经猜到了—— Vani 这几天还要忙着去其他地方游山玩水，就请你帮他解决这个问题吧。", "inputFormat": "每个测试点包含多组数据，第一行是一个整数 $T$，表示数据组数。注意各组数据之间是互相独立的。\n\n对于每组数据，第一行包含三个正整数 $n,m,k$，表示 J 国的 $n$ 座城市（从 $1 \\sim n$ 编号），$m$ 条道路，Vani 感兴趣的城市的个数 $k$。\n\n接下来 $m$ 行，每行包括 $3$ 个正整数 $x,y,z$，表示从第 $x$ 号城市到第 $y$ 号城市有一条长度为 $z$ 的单向道路。注意 $x,y$ 可能相等，一对 $x,y$ 也可能重复出现。\n\n接下来一行包括 $k$ 个正整数，表示 Vani 感兴趣的城市的编号。", "outputFormat": "输出文件应包含 $T$ 行，对于每组数据，输出一个整数表示 $k$ 座城市之间两两最短路的最小值。", "hint": "### 样例解释\n对于第一组数据，$1$ 到 $3$ 最短路为 $5$；$1$ 到 $6$ 最短路为 $7$；$3,6$ 无法到达，所以最近的两点为 $1,3$，最近的距离为 $5$。\n\n对于第二组数据，$1$ 到 $2$ 最短路为 $6$；$5$ 到 $3$ 最短路为 $6$；其余的点均无法互相达，所以最近的两点为 $1,2$ 和 $5,3$，最近的距离为 $6$。\n\n### 数据范围\n\n$2 \\le k \\le n$，$1 \\le x,y \\le n$，$1 \\le z \\le 2 \\times 10^9$，$T \\leq 5$。\n\n|测试点编号|$n$ 的规模|$m$ 的规模|约定|\n|:-:|:-:|:-:|:-:|\n|$1$|$\\le 1,000$|$\\le 5,000$|无|\n|$2$|$\\le 1,000$|$\\le 5,000$|无|\n|$3$|$\\le 100,000$|$\\le 500,000$|保证数据为有向无环图|\n|$4$|$\\le 100,000$|$\\le 500,000$|保证数据为有向无环图|\n|$5$|$\\le 100,000$|$\\le 500,000$|保证数据为有向无环图|\n|$6$|$\\le 100,000$|$\\le 500,000$|无|\n|$7$|$\\le 100,000$|$\\le 500,000$|无|\n|$8$|$\\le 100,000$|$\\le 500,000$|无|\n|$9$|$\\le 100,000$|$\\le 500,000$|无|\n|$10$|$\\le 100,000$|$\\le 500,000$|无|\n\n2024-12-18 管理员注：[在测试点五中可能存在自环](https://www.luogu.com.cn/discuss/1022672)。", "locale": "zh-CN", "translations": {"en": {"title": "[GXOI/GZOI2019] Traveler", "background": "", "description": "Country J has $n$ cities, connected by $m$ one-way roads. The length of each road is known.\n\nOne day, Rainbow, who lives in Country J, invites Vani to visit. However, as an experienced traveler, Vani is only interested in $k$ cities in Country J that have a long history and unique natural scenery.  \nTo improve the travel experience, Vani wants to know the minimum value among the “pairwise shortest paths” between the cities he is interested in (that is, among all pairs of cities he is interested in, the shortest-path distance of the closest pair).\n\nYou may have already guessed the story — Vani will be busy traveling elsewhere these days, so please help him solve this problem.", "inputFormat": "Each test point contains multiple test cases. The first line is an integer $T$, the number of test cases. Note that the test cases are independent of each other.\n\nFor each test case, the first line contains three positive integers $n, m, k$, representing $n$ cities in Country J (numbered from $1 \\sim n$), $m$ roads, and the number $k$ of cities that Vani is interested in.\n\nThe next $m$ lines each contain $3$ positive integers $x, y, z$, indicating that there is a one-way road from city $x$ to city $y$ with length $z$. Note that $x$ and $y$ may be equal, and the same pair $(x, y)$ may appear multiple times.\n\nThe next line contains $k$ positive integers, the indices of the cities that Vani is interested in.", "outputFormat": "The output should contain $T$ lines. For each test case, output one integer: the minimum value among the pairwise shortest-path distances between the $k$ cities.", "hint": "### Sample Explanation\n\nFor the first test case, the shortest path from $1$ to $3$ is $5$; from $1$ to $6$ is $7$; $3$ and $6$ cannot reach each other. So the closest pair is $1, 3$, and the minimum distance is $5$.\n\nFor the second test case, the shortest path from $1$ to $2$ is $6$; from $5$ to $3$ is $6$; all other pairs of points cannot reach each other. So the closest pairs are $1, 2$ and $5, 3$, and the minimum distance is $6$.\n\n### Constraints\n\n$2 \\le k \\le n$, $1 \\le x, y \\le n$, $1 \\le z \\le 2 \\times 10^9$, $T \\leq 5$.\n\n|Test Point ID|Scale of $n$|Scale of $m$|Notes|\n|:-:|:-:|:-:|:-:|\n|$1$|$\\le 1,000$|$\\le 5,000$|None|\n|$2$|$\\le 1,000$|$\\le 5,000$|None|\n|$3$|$\\le 100,000$|$\\le 500,000$|The graph is guaranteed to be a directed acyclic graph|\n|$4$|$\\le 100,000$|$\\le 500,000$|The graph is guaranteed to be a directed acyclic graph|\n|$5$|$\\le 100,000$|$\\le 500,000$|The graph is guaranteed to be a directed acyclic graph|\n|$6$|$\\le 100,000$|$\\le 500,000$|None|\n|$7$|$\\le 100,000$|$\\le 500,000$|None|\n|$8$|$\\le 100,000$|$\\le 500,000$|None|\n|$9$|$\\le 100,000$|$\\le 500,000$|None|\n|$10$|$\\le 100,000$|$\\le 500,000$|None|\n\nAdmin note on 2024-12-18: [There may be self-loops in test point 5](https://www.luogu.com.cn/discuss/1022672)。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[GXOI/GZOI2019] 旅行者", "background": "", "description": "J 国有 $n$ 座城市，这些城市之间通过 $m$ 条单向道路相连，已知每条道路的长度。\n\n一次，居住在 J 国的 Rainbow 邀请 Vani 来作客。不过，作为一名资深的旅行者，Vani 只对 J 国的 $k$ 座历史悠久、自然风景独特的城市感兴趣。  \n为了提升旅行的体验，Vani 想要知道他感兴趣的城市之间「两两最短路」的最小值（即在他感兴趣的城市中，最近的一对的最短距离）。\n\n也许下面的剧情你已经猜到了—— Vani 这几天还要忙着去其他地方游山玩水，就请你帮他解决这个问题吧。", "inputFormat": "每个测试点包含多组数据，第一行是一个整数 $T$，表示数据组数。注意各组数据之间是互相独立的。\n\n对于每组数据，第一行包含三个正整数 $n,m,k$，表示 J 国的 $n$ 座城市（从 $1 \\sim n$ 编号），$m$ 条道路，Vani 感兴趣的城市的个数 $k$。\n\n接下来 $m$ 行，每行包括 $3$ 个正整数 $x,y,z$，表示从第 $x$ 号城市到第 $y$ 号城市有一条长度为 $z$ 的单向道路。注意 $x,y$ 可能相等，一对 $x,y$ 也可能重复出现。\n\n接下来一行包括 $k$ 个正整数，表示 Vani 感兴趣的城市的编号。", "outputFormat": "输出文件应包含 $T$ 行，对于每组数据，输出一个整数表示 $k$ 座城市之间两两最短路的最小值。", "hint": "### 样例解释\n对于第一组数据，$1$ 到 $3$ 最短路为 $5$；$1$ 到 $6$ 最短路为 $7$；$3,6$ 无法到达，所以最近的两点为 $1,3$，最近的距离为 $5$。\n\n对于第二组数据，$1$ 到 $2$ 最短路为 $6$；$5$ 到 $3$ 最短路为 $6$；其余的点均无法互相达，所以最近的两点为 $1,2$ 和 $5,3$，最近的距离为 $6$。\n\n### 数据范围\n\n$2 \\le k \\le n$，$1 \\le x,y \\le n$，$1 \\le z \\le 2 \\times 10^9$，$T \\leq 5$。\n\n|测试点编号|$n$ 的规模|$m$ 的规模|约定|\n|:-:|:-:|:-:|:-:|\n|$1$|$\\le 1,000$|$\\le 5,000$|无|\n|$2$|$\\le 1,000$|$\\le 5,000$|无|\n|$3$|$\\le 100,000$|$\\le 500,000$|保证数据为有向无环图|\n|$4$|$\\le 100,000$|$\\le 500,000$|保证数据为有向无环图|\n|$5$|$\\le 100,000$|$\\le 500,000$|保证数据为有向无环图|\n|$6$|$\\le 100,000$|$\\le 500,000$|无|\n|$7$|$\\le 100,000$|$\\le 500,000$|无|\n|$8$|$\\le 100,000$|$\\le 500,000$|无|\n|$9$|$\\le 100,000$|$\\le 500,000$|无|\n|$10$|$\\le 100,000$|$\\le 500,000$|无|\n\n2024-12-18 管理员注：[在测试点五中可能存在自环](https://www.luogu.com.cn/discuss/1022672)。", "locale": "zh-CN"}}}
{"pid": "P5305", "type": "P", "difficulty": 6, "samples": [["5 5 2\n1\n4\n1\n2\n4 3\n5 4\n2 5\n1 2\n3 2", "15\n11\n5\n1\n6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "线段树", "各省省选", "贵州", "广西", "树链剖分", "动态树 LCT", "分块"], "title": "[GXOI/GZOI2019] 旧词", "background": "", "description": "> 浮生有梦三千场  \n> 穷尽千里诗酒荒  \n> 徒把理想倾倒  \n> 不如早还乡\n>\n> 温一壶风尘的酒  \n> 独饮往事迢迢  \n> 举杯轻思量  \n> 泪如潮青丝留他方\n>\n> ——乌糟兽/愚青《旧词》\n\n你已经解决了五个问题，不妨在这大树之下，吟唱旧词一首抒怀。最后的问题就是关于这棵树的，它的描述很简单。\n\n给定一棵 $n$ 个点的有根树，节点标号 $1 \\sim n$，$1$ 号节点为根。  \n给定常数 $k$。  \n给定 $Q$ 个询问，每次询问给定 $x,y$。  \n求：\n\n$$\\sum\\limits_{i \\le x} \\text{depth}(\\text{lca}(i,y))^k$$\n\n$\\text{lca}(x,y)$ 表示节点 $x$ 与节点 $y$ 在有根树上的最近公共祖先。  \n$\\text{depth}(x)$ 表示节点 $x$ 的深度，根节点的深度为 $1$。  \n由于答案可能很大，你只需要输出答案模 $998244353$ 的结果。\n", "inputFormat": "输入包含 $n+Q$ 行。\n\n第 $1$ 行，三个正整数 $n,Q,k$。\n\n第 $i = 2 \\sim n$ 行，每行有一个正整数 $f_i(1 \\le f_i \\le n)$，表示编号为 $i$ 的节点的父亲节点的编号。\n\n接下来 $Q$ 行，每行两个正整数 $x,y(1 \\le x,y \\le n)$，表示一次询问。", "outputFormat": "输出包含 $Q$ 行，每行一个整数，表示答案模 $998244353$ 的结果。", "hint": "### 样例解释\n\n输入的树：\n\n![poetry.png](https://cdn.luogu.com.cn/upload/pic/56737.png)\n\n每个点的深度分别为 $1,2,3,2,3$。\n\n第一个询问 $x = 4,y = 3$，容易求出：  \n\n$$\\text{lca}(1, 3) = 1,\\text{lca}(2, 3) = 1,\\text{lca}(3, 3) = 3,\\text{lca}(4, 3) = 4$$\n\n于是 $\\text{depth}(1)^2+\\text{depth}(1)^2+\\text{depth}(3)^2+\\text{depth}(4)^2 = 1+1+9+4 = 15$。\n\n### 数据范围\n\n|测试点编号|$n$ 的规模|$Q$ 的规模|$k$ 的规模|约定|\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$n \\le 2,000$|$Q \\le 2,000$|$1 \\le k \\le 10^9$|无|\n|$2$|$n \\le 2,000$|$Q \\le 2,000$|$1 \\le k \\le 10^9$|无|\n|$3$|$n \\le 2,000$|$Q \\le 2,000$|$1 \\le k \\le 10^9$|无|\n|$4$|$n \\le 2,000$|$Q \\le 2,000$|$1 \\le k \\le 10^9$|无|\n|$5$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|存在某个点，其深度为 $n$|\n|$6$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|存在某个点，其深度为 $n$|\n|$7$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|存在某个点，其深度为 $n$|\n|$8$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|存在某个点，其深度为 $n$|\n|$9$|$n \\le 50,000$|$Q = n$|$1 \\le k \\le 10^9$|对于第 $i$ 个询问，有 $x = i$|\n|$10$|$n \\le 50,000$|$Q = n$|$1 \\le k \\le 10^9$|对于第 $i$ 个询问，有 $x = i$|\n|$11$|$n \\le 50,000$|$Q \\le 50,000$|$k = 1$|无|\n|$12$|$n \\le 50,000$|$Q \\le 50,000$|$k = 1$|无|\n|$13$|$n \\le 50,000$|$Q \\le 50,000$|$k = 2$|无|\n|$14$|$n \\le 50,000$|$Q \\le 50,000$|$k = 2$|无|\n|$15$|$n \\le 50,000$|$Q \\le 50,000$|$k = 3$|无|\n|$16$|$n \\le 50,000$|$Q \\le 50,000$|$k = 3$|无|\n|$17$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|无|\n|$18$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|无|\n|$19$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|无|\n|$20$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|无|", "locale": "zh-CN", "translations": {"en": {"title": "[GXOI/GZOI2019] Old Words", "background": "", "description": "> Life is but three thousand dreamlike scenes.  \n> I have searched a thousand miles, yet poetry and wine are barren.  \n> I only pour out my ideals in vain,  \n> Better to return home early.\n>\n> Warm a pot of dusty-world wine,  \n> Drink alone as the past stretches far away.  \n> Raise the cup and think lightly,  \n> Tears surge like tides, black hair left in a distant land.\n>\n> — Wuzhaoshou / Yuqing, \"Old Words\"\n\nYou have already solved five problems. Now, under this big tree, you may as well sing an old song to express your feelings. The last problem is about this tree, and its description is very simple.\n\nGiven a rooted tree with $n$ nodes, with nodes labeled $1 \\sim n$, and node $1$ as the root.  \nGiven a constant $k$.  \nGiven $Q$ queries, each query provides $x, y$.  \nCompute:\n\n$$\\sum\\limits_{i \\le x} \\text{depth}(\\text{lca}(i,y))^k$$\n\n$\\text{lca}(x,y)$ denotes the lowest common ancestor of nodes $x$ and $y$ in the rooted tree.  \n$\\text{depth}(x)$ denotes the depth of node $x$, where the root has depth $1$.  \nSince the answer may be very large, you only need to output the result modulo $998244353$.", "inputFormat": "The input contains $n+Q$ lines.\n\nLine $1$ contains three positive integers $n, Q, k$.\n\nFor lines $i = 2 \\sim n$, each line contains a positive integer $f_i(1 \\le f_i \\le n)$, which denotes the label of the parent of node $i$.\n\nNext come $Q$ lines, each containing two positive integers $x, y(1 \\le x,y \\le n)$, representing one query.", "outputFormat": "The output contains $Q$ lines, each with one integer, which is the answer modulo $998244353$.", "hint": "### Sample Explanation\n\nThe tree in the input:\n\n![poetry.png](https://cdn.luogu.com.cn/upload/pic/56737.png)\n\nThe depths of the nodes are $1,2,3,2,3$, respectively.\n\nFor the first query $x = 4, y = 3$, it is easy to compute:\n\n$$\\text{lca}(1, 3) = 1,\\text{lca}(2, 3) = 1,\\text{lca}(3, 3) = 3,\\text{lca}(4, 3) = 4$$\n\nSo $\\text{depth}(1)^2+\\text{depth}(1)^2+\\text{depth}(3)^2+\\text{depth}(4)^2 = 1+1+9+4 = 15$.\n\n### Constraints\n\n|Test Point ID|Size of $n$|Size of $Q$|Size of $k$|Note|\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$n \\le 2,000$|$Q \\le 2,000$|$1 \\le k \\le 10^9$|None|\n|$2$|$n \\le 2,000$|$Q \\le 2,000$|$1 \\le k \\le 10^9$|None|\n|$3$|$n \\le 2,000$|$Q \\le 2,000$|$1 \\le k \\le 10^9$|None|\n|$4$|$n \\le 2,000$|$Q \\le 2,000$|$1 \\le k \\le 10^9$|None|\n|$5$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|There exists a node whose depth is $n$|\n|$6$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|There exists a node whose depth is $n$|\n|$7$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|There exists a node whose depth is $n$|\n|$8$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|There exists a node whose depth is $n$|\n|$9$|$n \\le 50,000$|$Q = n$|$1 \\le k \\le 10^9$|For the $i$-th query, $x = i$|\n|$10$|$n \\le 50,000$|$Q = n$|$1 \\le k \\le 10^9$|For the $i$-th query, $x = i$|\n|$11$|$n \\le 50,000$|$Q \\le 50,000$|$k = 1$|None|\n|$12$|$n \\le 50,000$|$Q \\le 50,000$|$k = 1$|None|\n|$13$|$n \\le 50,000$|$Q \\le 50,000$|$k = 2$|None|\n|$14$|$n \\le 50,000$|$Q \\le 50,000$|$k = 2$|None|\n|$15$|$n \\le 50,000$|$Q \\le 50,000$|$k = 3$|None|\n|$16$|$n \\le 50,000$|$Q \\le 50,000$|$k = 3$|None|\n|$17$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|None|\n|$18$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|None|\n|$19$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|None|\n|$20$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|None|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[GXOI/GZOI2019] 旧词", "background": "", "description": "> 浮生有梦三千场  \n> 穷尽千里诗酒荒  \n> 徒把理想倾倒  \n> 不如早还乡\n>\n> 温一壶风尘的酒  \n> 独饮往事迢迢  \n> 举杯轻思量  \n> 泪如潮青丝留他方\n>\n> ——乌糟兽/愚青《旧词》\n\n你已经解决了五个问题，不妨在这大树之下，吟唱旧词一首抒怀。最后的问题就是关于这棵树的，它的描述很简单。\n\n给定一棵 $n$ 个点的有根树，节点标号 $1 \\sim n$，$1$ 号节点为根。  \n给定常数 $k$。  \n给定 $Q$ 个询问，每次询问给定 $x,y$。  \n求：\n\n$$\\sum\\limits_{i \\le x} \\text{depth}(\\text{lca}(i,y))^k$$\n\n$\\text{lca}(x,y)$ 表示节点 $x$ 与节点 $y$ 在有根树上的最近公共祖先。  \n$\\text{depth}(x)$ 表示节点 $x$ 的深度，根节点的深度为 $1$。  \n由于答案可能很大，你只需要输出答案模 $998244353$ 的结果。\n", "inputFormat": "输入包含 $n+Q$ 行。\n\n第 $1$ 行，三个正整数 $n,Q,k$。\n\n第 $i = 2 \\sim n$ 行，每行有一个正整数 $f_i(1 \\le f_i \\le n)$，表示编号为 $i$ 的节点的父亲节点的编号。\n\n接下来 $Q$ 行，每行两个正整数 $x,y(1 \\le x,y \\le n)$，表示一次询问。", "outputFormat": "输出包含 $Q$ 行，每行一个整数，表示答案模 $998244353$ 的结果。", "hint": "### 样例解释\n\n输入的树：\n\n![poetry.png](https://cdn.luogu.com.cn/upload/pic/56737.png)\n\n每个点的深度分别为 $1,2,3,2,3$。\n\n第一个询问 $x = 4,y = 3$，容易求出：  \n\n$$\\text{lca}(1, 3) = 1,\\text{lca}(2, 3) = 1,\\text{lca}(3, 3) = 3,\\text{lca}(4, 3) = 4$$\n\n于是 $\\text{depth}(1)^2+\\text{depth}(1)^2+\\text{depth}(3)^2+\\text{depth}(4)^2 = 1+1+9+4 = 15$。\n\n### 数据范围\n\n|测试点编号|$n$ 的规模|$Q$ 的规模|$k$ 的规模|约定|\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$n \\le 2,000$|$Q \\le 2,000$|$1 \\le k \\le 10^9$|无|\n|$2$|$n \\le 2,000$|$Q \\le 2,000$|$1 \\le k \\le 10^9$|无|\n|$3$|$n \\le 2,000$|$Q \\le 2,000$|$1 \\le k \\le 10^9$|无|\n|$4$|$n \\le 2,000$|$Q \\le 2,000$|$1 \\le k \\le 10^9$|无|\n|$5$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|存在某个点，其深度为 $n$|\n|$6$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|存在某个点，其深度为 $n$|\n|$7$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|存在某个点，其深度为 $n$|\n|$8$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|存在某个点，其深度为 $n$|\n|$9$|$n \\le 50,000$|$Q = n$|$1 \\le k \\le 10^9$|对于第 $i$ 个询问，有 $x = i$|\n|$10$|$n \\le 50,000$|$Q = n$|$1 \\le k \\le 10^9$|对于第 $i$ 个询问，有 $x = i$|\n|$11$|$n \\le 50,000$|$Q \\le 50,000$|$k = 1$|无|\n|$12$|$n \\le 50,000$|$Q \\le 50,000$|$k = 1$|无|\n|$13$|$n \\le 50,000$|$Q \\le 50,000$|$k = 2$|无|\n|$14$|$n \\le 50,000$|$Q \\le 50,000$|$k = 2$|无|\n|$15$|$n \\le 50,000$|$Q \\le 50,000$|$k = 3$|无|\n|$16$|$n \\le 50,000$|$Q \\le 50,000$|$k = 3$|无|\n|$17$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|无|\n|$18$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|无|\n|$19$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|无|\n|$20$|$n \\le 50,000$|$Q \\le 50,000$|$1 \\le k \\le 10^9$|无|", "locale": "zh-CN"}}}
{"pid": "P5306", "type": "P", "difficulty": 6, "samples": [["2\n3 1\n1 2 2", "1"], ["5\n3 1 2 4 5\n1 2 3\n3 2 2\n4 2 6\n5 4 3", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2018", "COCI（克罗地亚）"], "title": "[COCI 2018/2019 #5] Transport", "background": "", "description": "一个国家有 $n$ 个城市，每个城市中都有一个加油站，燃料储量为 $a_i$。  \n有 $n-1$ 条路径，将这些城市连接成一个树形结构。  \n\n一个货车能从城市 $u$ 到达城市 $v$ ，货车的燃料量必须不小于 $u,v$ 之间的距离。  \n每当货车抵达一个城市，就可以补充不超过加油站储量的燃料。  \n\n假设货车的油箱是无限大的，每行驶一公里需要消耗一单位燃料，请你算出有多少个有序数对 $(u,v)$ 满足：  \n\n一个油箱燃料量初始为 $0$ 的货车，可以从城市 $u$ 出发，抵达城市 $v$，且 $u\\neq v$。\n\n请注意，货车只能走简单路径，也就是说不能走回头路。", "inputFormat": "第一行一个正整数 $n$。  \n第二行有 $n$ 个正整数 $a_i$，表示每个加油站的燃料储量。  \n接下来 $n-1$ 行，每行三个正整数 $u,v,w$，表示城市 $u,v$ 之间有一条长为 $w$ 的路径。", "outputFormat": "一行一个整数表示答案。", "hint": "### 样例1解释：  \n唯一可行的是 $(1,2)$，即只有 $1\\rightarrow 2$ 是可行的。  \n\n### 数据范围：  \n对于 $20\\%$ 的数据：  \n$1\\le n \\le 5000$   \n对于 $40\\%$ 的数据：   \n树是一条链    \n对于 $100\\%$ 的数据：   \n$1\\le n \\le 10^5$      \n$1\\le u,v \\le n$     \n$1\\le w,a_i \\le 10^9$", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2018/2019 #5] Transport", "background": "", "description": "A country has $n$ cities. Each city has a gas station with fuel supply $a_i$.  \nThere are $n-1$ roads connecting these cities into a tree structure.\n\nFor a truck to travel from city $u$ to city $v$, the amount of fuel in the truck must be at least the distance between $u$ and $v$.  \nEach time the truck arrives at a city, it can refuel by an amount not exceeding the fuel supply of that city's gas station.\n\nAssume the truck's fuel tank has infinite capacity, and it consumes one unit of fuel for each kilometer traveled. Please calculate how many ordered pairs $(u,v)$ satisfy:\n\nA truck whose initial fuel is $0$ can start from city $u$, reach city $v$, and $u \\neq v$.\n\nNote that the truck can only travel along a simple path, meaning it cannot go back.", "inputFormat": "The first line contains a positive integer $n$.  \nThe second line contains $n$ positive integers $a_i$, representing the fuel supply of each gas station.  \nThe next $n-1$ lines each contain three positive integers $u,v,w$, indicating that there is a road of length $w$ between cities $u$ and $v$.", "outputFormat": "Output one integer in a single line, representing the answer.", "hint": "### Explanation for Sample 1:  \nThe only feasible pair is $(1,2)$, meaning only $1\\rightarrow 2$ is feasible.\n\n### Constraints:  \nFor $20\\%$ of the testdata:  \n$1\\le n \\le 5000$。  \nFor $40\\%$ of the testdata:  \nThe tree is a chain.  \nFor $100\\%$ of the testdata:  \n$1\\le n \\le 10^5$。  \n$1\\le u,v \\le n$。  \n$1\\le w,a_i \\le 10^9$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2018/2019 #5] Transport", "background": "", "description": "一个国家有 $n$ 个城市，每个城市中都有一个加油站，燃料储量为 $a_i$。  \n有 $n-1$ 条路径，将这些城市连接成一个树形结构。  \n\n一个货车能从城市 $u$ 到达城市 $v$ ，货车的燃料量必须不小于 $u,v$ 之间的距离。  \n每当货车抵达一个城市，就可以补充不超过加油站储量的燃料。  \n\n假设货车的油箱是无限大的，每行驶一公里需要消耗一单位燃料，请你算出有多少个有序数对 $(u,v)$ 满足：  \n\n一个油箱燃料量初始为 $0$ 的货车，可以从城市 $u$ 出发，抵达城市 $v$，且 $u\\neq v$。\n\n请注意，货车只能走简单路径，也就是说不能走回头路。", "inputFormat": "第一行一个正整数 $n$。  \n第二行有 $n$ 个正整数 $a_i$，表示每个加油站的燃料储量。  \n接下来 $n-1$ 行，每行三个正整数 $u,v,w$，表示城市 $u,v$ 之间有一条长为 $w$ 的路径。", "outputFormat": "一行一个整数表示答案。", "hint": "### 样例1解释：  \n唯一可行的是 $(1,2)$，即只有 $1\\rightarrow 2$ 是可行的。  \n\n### 数据范围：  \n对于 $20\\%$ 的数据：  \n$1\\le n \\le 5000$   \n对于 $40\\%$ 的数据：   \n树是一条链    \n对于 $100\\%$ 的数据：   \n$1\\le n \\le 10^5$      \n$1\\le u,v \\le n$     \n$1\\le w,a_i \\le 10^9$", "locale": "zh-CN"}}}
{"pid": "P5307", "type": "P", "difficulty": 6, "samples": [["2 3 200\n2 3 4\n5 6 7", "2"], ["3 3 90\n2 1 1\n45 1 1\n1 1 1", "3"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "分块", "COCI（克罗地亚）"], "title": "[COCI 2018/2019 #6] Mobitel", "background": "`Nikola`小朋友最近在学乘法口诀。  \n为了记得更牢，他决定做一个游戏进行练习。  ", "description": "他画了一个 $r$ 行 $s$ 列的矩阵，每个格子里都有一个正整数。  \n他想知道，如果从左上角走到右下角，且每次只能向右或向下走到相邻格子，那么使得路径上所有数的乘积不小于 $n$ 的路径有多少条？  \n\n由于答案可能很大，所以请输出答案对 $10^9 + 7$ 取模的结果。", "inputFormat": "第一行三个正整数 $r,s,n$  \n接下来 $r$ 行，每行 $s$ 个正整数，依次表示矩阵每一行的数。", "outputFormat": "输出一行一个整数表示答案。", "hint": "### 样例 $1$ 解释：  \n共有 $3$ 条路径，其中有 $2$ 条满足条件：  \n$2 \\rightarrow 3 \\rightarrow 6 \\rightarrow 7$，乘积为$252$  \n$2 \\rightarrow 5 \\rightarrow 6 \\rightarrow 7$，乘积为$420$  \n\n### 数据范围：  \n对于$20\\%$的数据：  \n矩阵中的数不超过$10$  \n对于$50\\%$的数据：  \n$1\\le r,s \\le 100$  \n对于$100\\%$的数据：  \n$1\\le r,s \\le 300$  \n$1\\le n \\le 10^6$  \n矩阵中的数不超过$10^6$", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2018/2019 #6] Mobitel", "background": "The child `Nikola` has recently been learning the multiplication table.  \nTo remember it better, he decided to make a game to practice.", "description": "He drew a matrix with $r$ rows and $s$ columns, and each cell contains a positive integer.  \nHe wants to know: if you walk from the top-left corner to the bottom-right corner, and each step can only go right or down to an adjacent cell, how many paths have the product of all numbers on the path not less than $n$?\n\nSince the answer may be very large, output the result modulo $10^9 + 7$.", "inputFormat": "The first line contains three positive integers $r, s, n$.  \nNext come $r$ lines, each containing $s$ positive integers, representing the numbers in each row of the matrix in order.", "outputFormat": "Output one line with one integer representing the answer.", "hint": "### Sample $1$ Explanation:  \nThere are $3$ paths in total, among which $2$ satisfy the condition:  \n$2 \\rightarrow 3 \\rightarrow 6 \\rightarrow 7$, with product $252$.  \n$2 \\rightarrow 5 \\rightarrow 6 \\rightarrow 7$, with product $420$.\n\n### Constraints:  \nFor $20\\%$ of the testdata:  \nThe numbers in the matrix do not exceed $10$.  \nFor $50\\%$ of the testdata:  \n$1 \\le r, s \\le 100$.  \nFor $100\\%$ of the testdata:  \n$1 \\le r, s \\le 300$.  \n$1 \\le n \\le 10^6$.  \nThe numbers in the matrix do not exceed $10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2018/2019 #6] Mobitel", "background": "`Nikola`小朋友最近在学乘法口诀。  \n为了记得更牢，他决定做一个游戏进行练习。  ", "description": "他画了一个 $r$ 行 $s$ 列的矩阵，每个格子里都有一个正整数。  \n他想知道，如果从左上角走到右下角，且每次只能向右或向下走到相邻格子，那么使得路径上所有数的乘积不小于 $n$ 的路径有多少条？  \n\n由于答案可能很大，所以请输出答案对 $10^9 + 7$ 取模的结果。", "inputFormat": "第一行三个正整数 $r,s,n$  \n接下来 $r$ 行，每行 $s$ 个正整数，依次表示矩阵每一行的数。", "outputFormat": "输出一行一个整数表示答案。", "hint": "### 样例 $1$ 解释：  \n共有 $3$ 条路径，其中有 $2$ 条满足条件：  \n$2 \\rightarrow 3 \\rightarrow 6 \\rightarrow 7$，乘积为$252$  \n$2 \\rightarrow 5 \\rightarrow 6 \\rightarrow 7$，乘积为$420$  \n\n### 数据范围：  \n对于$20\\%$的数据：  \n矩阵中的数不超过$10$  \n对于$50\\%$的数据：  \n$1\\le r,s \\le 100$  \n对于$100\\%$的数据：  \n$1\\le r,s \\le 300$  \n$1\\le n \\le 10^6$  \n矩阵中的数不超过$10^6$", "locale": "zh-CN"}}}
{"pid": "P5308", "type": "P", "difficulty": 6, "samples": [["5 3", "2.100000000"], ["10 10", "2.928968254"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2018", "斜率优化", "凸完全单调性（wqs 二分）", "COCI（克罗地亚）"], "title": "[COCI 2018/2019 #4] Akvizna", "background": "", "description": "你面临 $n$ 名参赛者的挑战，最终要将他们全部战胜。  \n每一轮中，都会淘汰一些选手；你会得到这一轮奖金池中 被淘汰者 除以 这一轮对手总数 比例的奖金。  \n\n例如某一轮有 $10$ 个对手，淘汰了 $3$ 个，那么你将获得奖金池中 $3/10$ 的奖金。  \n\n假设每一轮的奖金池均为一元，`Mirko` 希望通过恰好 $k$ 轮赢得比赛，那么他最多可能获得多少奖金呢？   \n\n你只需要输出答案保留 $9$ 位小数即可。", "inputFormat": "一行两个正整数 $n,k$。", "outputFormat": "输出一行一个实数表示答案。", "hint": "### 样例1解释：   \n\n最优的情况为：  \n第一轮淘汰 $3$ 人，剩下两轮各淘汰 $1$ 人。  \n获得奖金为 $\\frac{3}{5}+\\frac{1}{2}+\\frac{1}{1}=2.1$ 元。\n\n### 数据范围：   \n\n对于$20\\%$的数据，$1\\le n\\le 100$。\n\n对于$40\\%$的数据，$1\\le n \\le 3000$。\n\n对于$100\\%$的数据，$1\\le k \\le n \\le 10^5$。\n\n本题较卡精度，请留意。", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2018/2019 #4] Akvizna", "background": "", "description": "You are facing a challenge from $n$ contestants, and in the end you must defeat all of them.  \nIn each round, some contestants are eliminated. You will receive a share of the prize pool for that round equal to the ratio $\\dfrac{\\text{number eliminated in this round}}{\\text{total number of opponents in this round}}$.\n\nFor example, if there are $10$ opponents in a round and $3$ are eliminated, then you will receive $\\dfrac{3}{10}$ of the prize pool.\n\nAssume the prize pool in every round is 1 unit of money. Mirko wants to win the competition in exactly $k$ rounds. What is the maximum total prize he can get?\n\nYou only need to output the answer rounded to $9$ decimal places.", "inputFormat": "One line with two positive integers $n,k$.", "outputFormat": "Output one line with one real number representing the answer.", "hint": "### Explanation of Sample 1:\n\nThe best situation is:  \nEliminate $3$ people in the first round, and eliminate $1$ person in each of the remaining two rounds.  \nThe total prize is $\\frac{3}{5}+\\frac{1}{2}+\\frac{1}{1}=2.1$.\n\n### Constraints:\n\nFor $20\\%$ of the testdata, $1\\le n\\le 100$.\n\nFor $40\\%$ of the testdata, $1\\le n \\le 3000$.\n\nFor $100\\%$ of the testdata, $1\\le k \\le n \\le 10^5$.\n\nThis problem is quite strict about precision. Please be careful.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2018/2019 #4] Akvizna", "background": "", "description": "你面临 $n$ 名参赛者的挑战，最终要将他们全部战胜。  \n每一轮中，都会淘汰一些选手；你会得到这一轮奖金池中 被淘汰者 除以 这一轮对手总数 比例的奖金。  \n\n例如某一轮有 $10$ 个对手，淘汰了 $3$ 个，那么你将获得奖金池中 $3/10$ 的奖金。  \n\n假设每一轮的奖金池均为一元，`Mirko` 希望通过恰好 $k$ 轮赢得比赛，那么他最多可能获得多少奖金呢？   \n\n你只需要输出答案保留 $9$ 位小数即可。", "inputFormat": "一行两个正整数 $n,k$。", "outputFormat": "输出一行一个实数表示答案。", "hint": "### 样例1解释：   \n\n最优的情况为：  \n第一轮淘汰 $3$ 人，剩下两轮各淘汰 $1$ 人。  \n获得奖金为 $\\frac{3}{5}+\\frac{1}{2}+\\frac{1}{1}=2.1$ 元。\n\n### 数据范围：   \n\n对于$20\\%$的数据，$1\\le n\\le 100$。\n\n对于$40\\%$的数据，$1\\le n \\le 3000$。\n\n对于$100\\%$的数据，$1\\le k \\le n \\le 10^5$。\n\n本题较卡精度，请留意。", "locale": "zh-CN"}}}
