{"pid": "P5086", "type": "P", "difficulty": 3, "samples": [["7\n1 2 3 4\n2 3 4 5\n1 4 3 3\n5 2 3 5\n2 4 5 6\n1 4 3 3\n2 5 4 4", "1 13"], ["10\n1 4 3 2\n4 4 4 4\n2 3 4 5\n1 1 1 1\n1 2 3 1\n3 4 2 1\n2 4 5 2\n8 9 7 6\n0 0 0 0\n1 2 3 4", "2 14"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "排序"], "title": "坐标", "background": "题解：<https://blog.csdn.net/kkkksc03/article/details/84928342>。\n\n小奔知道 Minecraft 的坐标参数有三个，分别是 $X, Y, Z$，但是在小奔的眼中，有第四个参数 $Q$，表示对这个坐标的喜爱，比如有些位置是小奔的家，$Q$ 的值会大，而有些地方是危险的矿洞，所以 $Q$ 的值小。", "description": "有 $N$ 个坐标。对于第 $i$ 个坐标的参数 $\\{X _ i, Y _ i, Z _ i, Q _ i\\}$ 和 $\\{X _ j, Y _ j, Z _ j, Q _ j\\}$ 存在 $X _ i - X _ j = Y _ i - Y _ j = Z _ i - Z _ j = Q _ i - Q _ j$ 则称该坐标为优美坐标。现给出 $N$ 个坐标，小奔想知道所有优美坐标的 $j - i$ 的最小值和 $i + j$ 的最大值，你能帮帮他吗？", "inputFormat": "输入有 $n + 1$ 行，第一行为一个数 $n$，接下来输入 $n$ 行，每行 $X, Y, Z, Q$ 四个整数。", "outputFormat": "输出只有一行，包括 $j - i$ 的最小值和 $i + j$ 的最大值，中间用空格隔开，数据保证有解。", "hint": "### 样例 1 解释：\n\n$(1, 2, 3, 4)$ 和 $(2, 3, 4, 5)$ 或 $(1, 4, 3, 3)$ 和 $(2, 5, 4, 4)$ 构成最小值。\n\n$(1, 4, 3, 3)$ 和 $(2, 5, 4, 4)$，$6 + 7 = 13$ 为最大值。\n\n### 数据规模与约定\n\n对于 $30\\%$ 的数据，$n \\le 10 ^ 3$；    \n对于 $100\\%$ 的数据，$1 \\le n \\le 5 \\times 10 ^ 5 $，$X, Y, Z, Q$ 均在 `int` 范围内。", "locale": "zh-CN", "translations": {"en": {"title": "Coordinates", "background": "Solution write-up: <https://blog.csdn.net/kkkksc03/article/details/84928342>.\n\nXiaoben knows that Minecraft coordinates have three parameters: $X$, $Y$, and $Z$. But in Xiaoben’s eyes, there is a fourth parameter $Q$, which represents how much he likes this location. For example, some places are Xiaoben’s home, so $Q$ will be large; some places are dangerous mines, so $Q$ will be small.", "description": "There are $N$ coordinates. For the $i$-th coordinate with parameters $\\{X _ i, Y _ i, Z _ i, Q _ i\\}$ and the $j$-th coordinate with parameters $\\{X _ j, Y _ j, Z _ j, Q _ j\\}$, if\n$X _ i - X _ j = Y _ i - Y _ j = Z _ i - Z _ j = Q _ i - Q _ j$,\nthen these coordinates are called beautiful coordinates.\n\nGiven $N$ coordinates, Xiaoben wants to know the minimum value of $j - i$ and the maximum value of $i + j$ among all beautiful coordinate pairs. Can you help him?", "inputFormat": "The input has $n + 1$ lines. The first line contains an integer $n$. Then follow $n$ lines, each containing four integers $X$, $Y$, $Z$, and $Q$.", "outputFormat": "Output one line containing the minimum value of $j - i$ and the maximum value of $i + j$, separated by a space. The testdata guarantees that a solution exists.", "hint": "### Explanation for Sample 1\n\n$(1, 2, 3, 4)$ and $(2, 3, 4, 5)$, or $(1, 4, 3, 3)$ and $(2, 5, 4, 4)$, achieve the minimum value.\n\nFor $(1, 4, 3, 3)$ and $(2, 5, 4, 4)$, $6 + 7 = 13$ is the maximum value.\n\n### Constraints\n\nFor $30\\%$ of the data, $n \\le 10 ^ 3$.\n\nFor $100\\%$ of the data, $1 \\le n \\le 5 \\times 10 ^ 5$, and $X$, $Y$, $Z$, $Q$ are all within the `int` range.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "坐标", "background": "题解：<https://blog.csdn.net/kkkksc03/article/details/84928342>。\n\n小奔知道 Minecraft 的坐标参数有三个，分别是 $X, Y, Z$，但是在小奔的眼中，有第四个参数 $Q$，表示对这个坐标的喜爱，比如有些位置是小奔的家，$Q$ 的值会大，而有些地方是危险的矿洞，所以 $Q$ 的值小。", "description": "有 $N$ 个坐标。对于第 $i$ 个坐标的参数 $\\{X _ i, Y _ i, Z _ i, Q _ i\\}$ 和 $\\{X _ j, Y _ j, Z _ j, Q _ j\\}$ 存在 $X _ i - X _ j = Y _ i - Y _ j = Z _ i - Z _ j = Q _ i - Q _ j$ 则称该坐标为优美坐标。现给出 $N$ 个坐标，小奔想知道所有优美坐标的 $j - i$ 的最小值和 $i + j$ 的最大值，你能帮帮他吗？", "inputFormat": "输入有 $n + 1$ 行，第一行为一个数 $n$，接下来输入 $n$ 行，每行 $X, Y, Z, Q$ 四个整数。", "outputFormat": "输出只有一行，包括 $j - i$ 的最小值和 $i + j$ 的最大值，中间用空格隔开，数据保证有解。", "hint": "### 样例 1 解释：\n\n$(1, 2, 3, 4)$ 和 $(2, 3, 4, 5)$ 或 $(1, 4, 3, 3)$ 和 $(2, 5, 4, 4)$ 构成最小值。\n\n$(1, 4, 3, 3)$ 和 $(2, 5, 4, 4)$，$6 + 7 = 13$ 为最大值。\n\n### 数据规模与约定\n\n对于 $30\\%$ 的数据，$n \\le 10 ^ 3$；    \n对于 $100\\%$ 的数据，$1 \\le n \\le 5 \\times 10 ^ 5 $，$X, Y, Z, Q$ 均在 `int` 范围内。", "locale": "zh-CN"}}}
{"pid": "P5087", "type": "P", "difficulty": 3, "samples": [["3 3\n1 1 1", "1"], ["4 3\n1 1 1 2", "7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "数学", "background": "在```小奔```这片神奇的土地上，有一个毒瘤教练```小奔```。\n\n题解：https://blog.csdn.net/kkkksc03/article/details/84928333", "description": "小奔热衷于乘法，他最喜欢做的事情是：从一个有 $N$ 个元素的序列里取出 $K$ 个数，（注意：不能取同一个元素好几次，取不同但是值相同的元素则是允许的）\n然后算出这$K$个数的积作为这个组合的分数。\n\n小奔想试遍所有的这些组合，然后算出所有这些组合的分数之和。但是他还要\n出模拟赛虐爆我们这些蒟蒻，所以他只好把这个任务交给了你。\n\n小奔（~~在某些方面~~）还是很仁慈的，所以你不用写高精度，只要输出答案取模 $10^9+7$ 的结果就可以了。", "inputFormat": "第一行两个整数 $N$ 和 $K$。\n\n第二行 $N$ 个整数 $A_i$ 描述序列。", "outputFormat": "一行一个整数表示答案。", "hint": "#### 样例#2解释：\n\n```小奔```可以取```{A[1],A[2],A[3]},{A[1],A[2],A[4]},{A[1],A[3],A[4]},{A[2],A[3],A[4]}```四种组合，它们的分值分别是 $1,2,2,2$。加起来就是 $7$。\n\n#### 数据范围：\n\n对于 $10\\%$ 的数据，$N\\le 5000,K\\le 2$；\n\n对于 $30\\%$ 的数据，$N\\le 10^5,K\\le 3$；\n\n对于 $50\\%$ 的数据，$N\\le 10^5,K\\le 5$；\n\n对于 $100\\%$ 的数据，$1\\le N\\le 10^5,1\\le K \\le 300 \\& \\& K\\le N,1\\le A[i]\\le 10^8$。", "locale": "zh-CN", "translations": {"en": {"title": "Math.", "background": "On the magical land of `Xiaoben`, there is an infamous coach `Xiaoben`.\n\nSolution write-up: https://blog.csdn.net/kkkksc03/article/details/84928333.", "description": "`Xiaoben` loves multiplication. His favorite thing to do is: choose $K$ numbers from a sequence with $N$ elements (note: you cannot choose the same element multiple times, but choosing different elements with the same value is allowed), and then take the product of these $K$ numbers as the score of this combination.\n\n`Xiaoben` wants to try all such combinations and compute the sum of the scores of all combinations. But he also needs to run a mock contest to crush us newbies, so he has to hand this task to you.\n\n`Xiaoben` (~~in some ways~~) is still very kind, so you do not need to use big integers. You only need to output the answer modulo $10^9+7$.", "inputFormat": "The first line contains two integers $N$ and $K$.\n\nThe second line contains $N$ integers $A_i$ describing the sequence.", "outputFormat": "Output one integer in one line, representing the answer.", "hint": "#### Explanation for Sample #2:\n\n`Xiaoben` can choose four combinations: `{A[1],A[2],A[3]},{A[1],A[2],A[4]},{A[1],A[3],A[4]},{A[2],A[3],A[4]}`. Their scores are $1,2,2,2$ respectively. The total is $7$.\n\n#### Constraints:\n\nFor $10\\%$ of the testdata, $N\\le 5000, K\\le 2$.\n\nFor $30\\%$ of the testdata, $N\\le 10^5, K\\le 3$.\n\nFor $50\\%$ of the testdata, $N\\le 10^5, K\\le 5$.\n\nFor $100\\%$ of the testdata, $1\\le N\\le 10^5, 1\\le K \\le 300 \\& \\& K\\le N, 1\\le A[i]\\le 10^8$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "数学", "background": "在```小奔```这片神奇的土地上，有一个毒瘤教练```小奔```。\n\n题解：https://blog.csdn.net/kkkksc03/article/details/84928333", "description": "小奔热衷于乘法，他最喜欢做的事情是：从一个有 $N$ 个元素的序列里取出 $K$ 个数，（注意：不能取同一个元素好几次，取不同但是值相同的元素则是允许的）\n然后算出这$K$个数的积作为这个组合的分数。\n\n小奔想试遍所有的这些组合，然后算出所有这些组合的分数之和。但是他还要\n出模拟赛虐爆我们这些蒟蒻，所以他只好把这个任务交给了你。\n\n小奔（~~在某些方面~~）还是很仁慈的，所以你不用写高精度，只要输出答案取模 $10^9+7$ 的结果就可以了。", "inputFormat": "第一行两个整数 $N$ 和 $K$。\n\n第二行 $N$ 个整数 $A_i$ 描述序列。", "outputFormat": "一行一个整数表示答案。", "hint": "#### 样例#2解释：\n\n```小奔```可以取```{A[1],A[2],A[3]},{A[1],A[2],A[4]},{A[1],A[3],A[4]},{A[2],A[3],A[4]}```四种组合，它们的分值分别是 $1,2,2,2$。加起来就是 $7$。\n\n#### 数据范围：\n\n对于 $10\\%$ 的数据，$N\\le 5000,K\\le 2$；\n\n对于 $30\\%$ 的数据，$N\\le 10^5,K\\le 3$；\n\n对于 $50\\%$ 的数据，$N\\le 10^5,K\\le 5$；\n\n对于 $100\\%$ 的数据，$1\\le N\\le 10^5,1\\le K \\le 300 \\& \\& K\\le N,1\\le A[i]\\le 10^8$。", "locale": "zh-CN"}}}
{"pid": "P5088", "type": "P", "difficulty": 5, "samples": [["3 4\n1 1", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "矩形", "background": "小奔月考考的可棒了！作为奖励，老师给了他一只激光笔。", "description": "但老师永远不是白给小奔奖品的。他告诉小奔：反射角等于入射角。并让他解决下面的问题：\n\n如果有一个矩形，长和宽之比为 $N:M$，现在有一束激光从左上角射出，且与长 $N$ 的夹角为 $\\zeta°$（$0\\le \\zeta° \\le 90$），且满足 $\\cot \\zeta°  = A:B$，求最少需要多少次反射才能重新反射入四个角当中的任意一个角呢？\n\n![](https://cdn.luogu.com.cn/upload/pic/37985.png)", "inputFormat": "两行，第一行两个数 $N$，$M$，表示长和宽之比；\n\n第二行两个数 $A$，$B$，表示 $\\cot\\zeta°$ 。", "outputFormat": "一个正整数，表示最少需要的反射次数。", "hint": "对于 $10\\%$ 的数据, $A=B=1$。\n\n对于另 $10\\%$ 的数据，$N=M$。\n\n对于 $50\\%$ 的数据，$0\\le A,B,M,N\\le10^5$。\n\n对于 $100\\%$ 的数据，$0\\le A,B,M,N\\le10^{10}$。", "locale": "zh-CN", "translations": {"en": {"title": "Rectangle", "background": "Xiao Ben did very well on the monthly exam. As a reward, the teacher gave him a laser pointer.", "description": "However, the teacher never gives Xiao Ben a prize for free. He told Xiao Ben that the angle of reflection equals the angle of incidence, and asked him to solve the following problem.\n\nGiven a rectangle whose length-to-width ratio is $N:M$. A laser beam is emitted from the top-left corner, and the angle between the beam and the side of length $N$ is $\\zeta°$ ($0\\le \\zeta° \\le 90$). It also satisfies $\\cot \\zeta° = A:B$. Find the minimum number of reflections needed for the beam to enter (after reflections) any one of the four corners again.\n\n![](https://cdn.luogu.com.cn/upload/pic/37985.png)", "inputFormat": "Two lines.\n\nThe first line contains two numbers $N$ and $M$, representing the ratio of the length to the width.\n\nThe second line contains two numbers $A$ and $B$, representing $\\cot\\zeta°$.", "outputFormat": "One positive integer, representing the minimum number of reflections needed.", "hint": "For $10\\%$ of the testdata, $A=B=1$.\n\nFor another $10\\%$ of the testdata, $N=M$.\n\nFor $50\\%$ of the testdata, $0\\le A,B,M,N\\le10^5$.\n\nFor $100\\%$ of the testdata, $0\\le A,B,M,N\\le10^{10}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "矩形", "background": "小奔月考考的可棒了！作为奖励，老师给了他一只激光笔。", "description": "但老师永远不是白给小奔奖品的。他告诉小奔：反射角等于入射角。并让他解决下面的问题：\n\n如果有一个矩形，长和宽之比为 $N:M$，现在有一束激光从左上角射出，且与长 $N$ 的夹角为 $\\zeta°$（$0\\le \\zeta° \\le 90$），且满足 $\\cot \\zeta°  = A:B$，求最少需要多少次反射才能重新反射入四个角当中的任意一个角呢？\n\n![](https://cdn.luogu.com.cn/upload/pic/37985.png)", "inputFormat": "两行，第一行两个数 $N$，$M$，表示长和宽之比；\n\n第二行两个数 $A$，$B$，表示 $\\cot\\zeta°$ 。", "outputFormat": "一个正整数，表示最少需要的反射次数。", "hint": "对于 $10\\%$ 的数据, $A=B=1$。\n\n对于另 $10\\%$ 的数据，$N=M$。\n\n对于 $50\\%$ 的数据，$0\\le A,B,M,N\\le10^5$。\n\n对于 $100\\%$ 的数据，$0\\le A,B,M,N\\le10^{10}$。", "locale": "zh-CN"}}}
{"pid": "P5089", "type": "P", "difficulty": 5, "samples": [["2 2 3\n1 2\n2 2\n2 1", "0"], ["1 5 3\n1 3\n1 1\n1 5", "2"], ["4 3 6\n1 2\n1 3\n2 2\n2 3\n3 1\n3 3", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2018", "eJOI（欧洲）"], "title": "[eJOI 2018] 元素周期表", "background": "**本题译自 [eJOI2018](http://ejoi2018.org/) Problem D「Chemical table」**\n\n", "description": "Innopolis 大学的教授正努力研究元素周期表。他们知道，有 $n \\times m$ 种元素，形成了一个 $n$ 行 $m$ 列的矩阵。\n\n研究表明，如果元素周期表上有一个元素 A，且元素 B 与它在同一列（A 与 B 不能在同一周期），元素 C 在同一周期（A 与 C 不能在同一列），那么，科学家就可以用这三种元素通过核聚变合成第四种元素 D 的样品，D 与 B 在同一周期，与 C 在同一列。  \n简而言之，如果有在元素周期表中位置为 $(r_1, c_1),\\ (r_1, c_2),\\ (r_2, c_1)$ （其中 $r_1 \\neq r_2, c_1 \\neq c_2$）的三种元素的样品，就可以生成位置为 $(r_2, c_2)$ 的样品。如图所示：\n\n![](http://codeforces.com/predownloaded/95/22/95223620a323ec59470718b34958c7f295698ff1.png)\n\n**注意：在核聚变中被使用的样品并不会消失，它们可以参与之后的反应；反应得到的样品也可以参与反应。**\n\n他们已经获得了 $q$ 种元素的样品。为了集齐所有元素的样品，他们会购买一些样品，然后利用核聚变制造出剩下元素的样品。  \n请求出他们至少需要购买的元素样品的数量。", "inputFormat": "第一行， $3$ 个整数 $n, m, q \\ (1 \\le n, m \\le 2 \\times 10^5, 0 \\le q \\le \\min \\{n \\times m, 2 \\times 10^5\\})$ 。  \n之后的 $q$ 行，每行 $2$ 个整数 $r_i, c_i \\ (1 \\le r_i \\le n, 1 \\le c_i \\le m)$ 。保证给定的元素互不相同。", "outputFormat": "输出一个整数，表示至少需要购买的元素样品的数量。", "hint": "### 样例解释\n\n#### 说明\n每个样例解释中有两个矩阵。  \n第一个表示初始状况（其中，**打叉的是原本就有样品的元素**）。  \n第二个表示最终集齐样品时的状况（其中，**蓝圈代表核聚变得到的样品，蓝圈中的数字表示得到样品的顺序，红圈表示购买的样品**）。\n\n#### 样例解释 1\n\n通过给定的三种元素，可以得到第四种元素的样品。\n\n![](http://codeforces.com/predownloaded/ee/44/ee44494c3f7ff02138d16c3ee2119a4a528c893a.png)\n\n#### 样例解释 2\n\n由于给定的元素只有一行，无法使用核聚变，只能购买剩余的两种元素的样品。\n\n![](http://codeforces.com/predownloaded/db/b4/dbb4c8c683b0e23a35c204b500695c0efb59e587.png)\n\n#### 样例解释 3\n\n集齐所有元素的方法不唯一，以下是一种方法。其中，元素 $(4, 2)$ 只有在购买元素 $(4, 1)$ 的样品，和反应得到元素 $(1, 1)$的样品后才能得到。\n\n![](http://codeforces.com/predownloaded/0c/d8/0cd813ff41b05914fceb0e1f25c2907bcb020959.png)\n\n---\n\n### 子任务 \n\n**注意：当且仅当你通过了一个子任务下的所有测试点，你将获得此子任务的分数。**  \n\n\n|子任务编号|分数|$n$|$m$|$q$|\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$10$|$n=2$|$m=2$|$0 \\le q \\le 4$|\n|$2$|$17$|$1 \\le n \\le 2$|$1 \\le m \\le 20$|$0 \\le q \\le 20$|\n|$3$|$8$|$1 \\le n \\le 20$|$1 \\le m \\le 20$|$q=0$|\n|$4$|$20$|$1 \\le n \\le 20$|$1 \\le m \\le 20$|$0 \\le q \\le 400$|\n|$5$|$30$|$1 \\le n \\le 1 \\times 10^4$|$1 \\le m \\le 1 \\times 10^4$|$1 \\le q \\le 1 \\times 10^5$|\n|$6$|$15$|$1 \\le n \\le 2 \\times 10^5$|$1 \\le m \\le 2 \\times 10^5$|$1 \\le q \\le 2 \\times 10^5$|", "locale": "zh-CN", "translations": {"en": {"title": "[eJOI 2018] Periodic Table of Elements", "background": "**This problem is translated from [eJOI2018](http://ejoi2018.org/) Problem D “Chemical table”.**", "description": "Professors at Innopolis University are working hard on studying the periodic table of elements. They know that there are $n \\times m$ elements, forming a matrix with $n$ rows and $m$ columns.\n\nResearch shows that if there is an element $A$ in the periodic table, element $B$ is in the same column as it (but $A$ and $B$ cannot be in the same row), and element $C$ is in the same row as it (but $A$ and $C$ cannot be in the same column), then scientists can use these three elements to produce a sample of a fourth element $D$ by nuclear fusion. Element $D$ is in the same row as $B$ and in the same column as $C$.  \nIn short, if there are samples of three elements located at $(r_1, c_1),\\ (r_1, c_2),\\ (r_2, c_1)$ in the periodic table (where $r_1 \\neq r_2, c_1 \\neq c_2$), then a sample at $(r_2, c_2)$ can be produced, as shown in the figure:\n\n![](http://codeforces.com/predownloaded/95/22/95223620a323ec59470718b34958c7f295698ff1.png)\n\n**Note: The samples used in nuclear fusion do not disappear; they can take part in later reactions. Samples obtained from reactions can also take part in reactions.**\n\nThey have already obtained samples of $q$ elements. To collect samples of all elements, they will buy some samples and then use nuclear fusion to produce the remaining ones.  \nPlease find the minimum number of element samples they need to buy.", "inputFormat": "The first line contains $3$ integers $n, m, q \\ (1 \\le n, m \\le 2 \\times 10^5, 0 \\le q \\le \\min \\{n \\times m, 2 \\times 10^5\\})$.  \nThe next $q$ lines each contain $2$ integers $r_i, c_i \\ (1 \\le r_i \\le n, 1 \\le c_i \\le m)$. It is guaranteed that all given elements are distinct.", "outputFormat": "Output one integer, the minimum number of element samples that need to be bought.", "hint": "### Sample Explanation\n\n#### Notes\nIn each sample explanation, there are two matrices.  \nThe first shows the initial state (where **crosses mark the elements that already have samples**).  \nThe second shows the final state when all samples have been collected (where **blue circles represent samples obtained by nuclear fusion, the number inside a blue circle is the order in which it was obtained, and red circles represent purchased samples**).\n\n#### Sample Explanation 1\n\nWith the three given elements, a sample of the fourth element can be obtained.\n\n![](http://codeforces.com/predownloaded/ee/44/ee44494c3f7ff02138d16c3ee2119a4a528c893a.png)\n\n#### Sample Explanation 2\n\nSince the given elements are only in one row, nuclear fusion cannot be used, so the remaining two element samples can only be purchased.\n\n![](http://codeforces.com/predownloaded/db/b4/dbb4c8c683b0e23a35c204b500695c0efb59e587.png)\n\n#### Sample Explanation 3\n\nThe method for collecting all elements is not unique; the following is one possible method. In this method, element $(4, 2)$ can only be obtained after purchasing a sample of element $(4, 1)$ and obtaining a sample of element $(1, 1)$ from reactions.\n\n![](http://codeforces.com/predownloaded/0c/d8/0cd813ff41b05914fceb0e1f25c2907bcb020959.png)\n\n---\n\n### Subtasks\n\n**Note: You will receive the score for a subtask if and only if you pass all test points in that subtask.**\n\n|Subtask ID|Score|$n$|$m$|$q$|\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$10$|$n=2$|$m=2$|$0 \\le q \\le 4$|\n|$2$|$17$|$1 \\le n \\le 2$|$1 \\le m \\le 20$|$0 \\le q \\le 20$|\n|$3$|$8$|$1 \\le n \\le 20$|$1 \\le m \\le 20$|$q=0$|\n|$4$|$20$|$1 \\le n \\le 20$|$1 \\le m \\le 20$|$0 \\le q \\le 400$|\n|$5$|$30$|$1 \\le n \\le 1 \\times 10^4$|$1 \\le m \\le 1 \\times 10^4$|$1 \\le q \\le 1 \\times 10^5$|\n|$6$|$15$|$1 \\le n \\le 2 \\times 10^5$|$1 \\le m \\le 2 \\times 10^5$|$1 \\le q \\le 2 \\times 10^5$|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[eJOI 2018] 元素周期表", "background": "**本题译自 [eJOI2018](http://ejoi2018.org/) Problem D「Chemical table」**\n\n", "description": "Innopolis 大学的教授正努力研究元素周期表。他们知道，有 $n \\times m$ 种元素，形成了一个 $n$ 行 $m$ 列的矩阵。\n\n研究表明，如果元素周期表上有一个元素 A，且元素 B 与它在同一列（A 与 B 不能在同一周期），元素 C 在同一周期（A 与 C 不能在同一列），那么，科学家就可以用这三种元素通过核聚变合成第四种元素 D 的样品，D 与 B 在同一周期，与 C 在同一列。  \n简而言之，如果有在元素周期表中位置为 $(r_1, c_1),\\ (r_1, c_2),\\ (r_2, c_1)$ （其中 $r_1 \\neq r_2, c_1 \\neq c_2$）的三种元素的样品，就可以生成位置为 $(r_2, c_2)$ 的样品。如图所示：\n\n![](http://codeforces.com/predownloaded/95/22/95223620a323ec59470718b34958c7f295698ff1.png)\n\n**注意：在核聚变中被使用的样品并不会消失，它们可以参与之后的反应；反应得到的样品也可以参与反应。**\n\n他们已经获得了 $q$ 种元素的样品。为了集齐所有元素的样品，他们会购买一些样品，然后利用核聚变制造出剩下元素的样品。  \n请求出他们至少需要购买的元素样品的数量。", "inputFormat": "第一行， $3$ 个整数 $n, m, q \\ (1 \\le n, m \\le 2 \\times 10^5, 0 \\le q \\le \\min \\{n \\times m, 2 \\times 10^5\\})$ 。  \n之后的 $q$ 行，每行 $2$ 个整数 $r_i, c_i \\ (1 \\le r_i \\le n, 1 \\le c_i \\le m)$ 。保证给定的元素互不相同。", "outputFormat": "输出一个整数，表示至少需要购买的元素样品的数量。", "hint": "### 样例解释\n\n#### 说明\n每个样例解释中有两个矩阵。  \n第一个表示初始状况（其中，**打叉的是原本就有样品的元素**）。  \n第二个表示最终集齐样品时的状况（其中，**蓝圈代表核聚变得到的样品，蓝圈中的数字表示得到样品的顺序，红圈表示购买的样品**）。\n\n#### 样例解释 1\n\n通过给定的三种元素，可以得到第四种元素的样品。\n\n![](http://codeforces.com/predownloaded/ee/44/ee44494c3f7ff02138d16c3ee2119a4a528c893a.png)\n\n#### 样例解释 2\n\n由于给定的元素只有一行，无法使用核聚变，只能购买剩余的两种元素的样品。\n\n![](http://codeforces.com/predownloaded/db/b4/dbb4c8c683b0e23a35c204b500695c0efb59e587.png)\n\n#### 样例解释 3\n\n集齐所有元素的方法不唯一，以下是一种方法。其中，元素 $(4, 2)$ 只有在购买元素 $(4, 1)$ 的样品，和反应得到元素 $(1, 1)$的样品后才能得到。\n\n![](http://codeforces.com/predownloaded/0c/d8/0cd813ff41b05914fceb0e1f25c2907bcb020959.png)\n\n---\n\n### 子任务 \n\n**注意：当且仅当你通过了一个子任务下的所有测试点，你将获得此子任务的分数。**  \n\n\n|子任务编号|分数|$n$|$m$|$q$|\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$10$|$n=2$|$m=2$|$0 \\le q \\le 4$|\n|$2$|$17$|$1 \\le n \\le 2$|$1 \\le m \\le 20$|$0 \\le q \\le 20$|\n|$3$|$8$|$1 \\le n \\le 20$|$1 \\le m \\le 20$|$q=0$|\n|$4$|$20$|$1 \\le n \\le 20$|$1 \\le m \\le 20$|$0 \\le q \\le 400$|\n|$5$|$30$|$1 \\le n \\le 1 \\times 10^4$|$1 \\le m \\le 1 \\times 10^4$|$1 \\le q \\le 1 \\times 10^5$|\n|$6$|$15$|$1 \\le n \\le 2 \\times 10^5$|$1 \\le m \\le 2 \\times 10^5$|$1 \\le q \\le 2 \\times 10^5$|", "locale": "zh-CN"}}}
{"pid": "P5090", "type": "P", "difficulty": 7, "samples": [["2\n6\n1 3\n3 5\n3 6\n6 4\n6 2\n6\n1 2\n1 3\n1 4\n1 5\n1 6", "2 5 3 1 4 6\n5 1 2 3 4 6\n\n4 5 1 3 6 2 \n5 4 6 1 3 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2018", "提交答案", "Special Judge", "eJOI（欧洲）"], "title": "[eJOI 2018] 互素树", "background": "**本题译自 [eJOI2018](http://ejoi2018.org/) Problem E「Prime Tree」**\n\n", "description": "本题为提交答案，输入文件在附件中。\n\n设有一棵有 $n$ 个结点的树，其结点编号为 $1$ 到 $n$ 。  \n对于其中的任意一条边 $(u, v)$ ，如果存在一个正整数 $d>1$ 满足 $ d \\mid u, d\\mid v$ ，我们称它为一条**坏的边**。  \n下图中的树有三条坏的边—— $(6, 4)$（都被 $2$ 整除）， $(2, 6)$（都被 $2$ 整除）， $(3, 6)$（都被 $3$ 整除）。\n\n![](https://i.loli.net/2018/08/17/5b7633a4ceb38.png)\n\n你的任务是将结点重新编号，使得图中坏的边的数量尽量少。  \n对于上图中的树，按照下图中的方式将结点重新编号，会只剩一条坏的边 $(3, 6)$ 。\n\n![](https://i.loli.net/2018/08/17/5b7633a4cfebf.png)\n\n重新编号后，坏的边越少，你的得分越高。\n\n**这是一道提交答案题。你应当下载输出文件，然后在本地运行你的程序，将输出结果上传**。当然，在洛谷上你可以直接提交你的程序。", "inputFormat": "每个测试点中有多组测试数据。  \n第一行，一个整数 $T$，表示测试数据组数。  \n每组测试数据共 $n$ 行，其中 $n$ 表示树的结点个数。  \n第一行，一个整数 $n$；  \n接下来 $n-1$ 行，每行两个整数 $u$ 和 $v\\ ( 1 \\le u, v \\le n)$，表示一条边 $(u,v)$ 。\n\n**每个输入文件中，每棵树的结点个数相同。**", "outputFormat": "对于每组测试数据，输出一行 $n$ 个整数，表示原先编号为 $1$ 到 $n$ 的结点的新编号。   \n**每个结点的编号必须不同，也就是说同一组测试数据中输出的 $n$ 个整数必须互不相同。**", "hint": "### 计分方式\n对于每个测试点，设所有树的总边数为 $M=T \\times (n-1)$，你的输出中坏的边数为 $X$，记 $R=\\dfrac{X}{M}$ ，你的得分与 $R$ 的关系如下：\n\n|$R$|得分|$R$|得分|\n|:-:|:-:|:-:|:-:|\n|$0.33 < R \\le 0.4$|$1$|$0.01 < R \\le 0.05$|$6$|\n|$0.26 < R \\le 0.33$|$2$|$0.005 < R \\le 0.01$|$7$|\n|$0.19 < R \\le 0.26$|$3$|$0.001 < R \\le 0.005$|$8$|\n|$0.12 < R \\le 0.19$|$4$|$0  < R \\le 0.001$|$9$|\n|$0.05 < R \\le 0.12$|$5$|$R=0$|$10$|\n\n当 $R > 0.4$ 时，不能得分。\n\n**对于所有的测试点，保证存在 $X=0$ 的输出。**\n\n---\n\n### 样例解释\n注意样例中给出了两种合法的输出，为了方便，下称输出 1 和 输出 2。\n\n第一组测试数据已经在题目描述中讨论过。输出 1 中有一条坏的边 $(3, 6)$，输出 2 中没有坏的边。  \n第二组测试数据中，输出 1 和输出 2 都没有出现坏的边。\n\n样例中，$M=2 \\times 5=10$。  \n\n对于输出 1，$X=1, R=\\dfrac{1}{10}=0.1$，该输出将得到 $5$ 分。\n\n对于输出 2，$X=0, R=\\dfrac{0}{10}=0$，该输出将得到 $10$ 分。\n\n---\n\n### 数据范围和限制\n\n#### 数据限制\n- 对于测试点 1 （输入 `01`），$T=3, n=7$，三棵树分别如下所示：\n\n![](https://i.loli.net/2018/08/17/5b765edf30647.png)\n\n- 对于测试点 4 至 8 （输入 `04` 至 `08`），输入数据有特殊性质（如叶子结点较多，是二叉树等），且这些具有特殊性质的树在各个测试点中输入数据均匀分布。\n\n- 对于其他测试点，数据为随机生成。  \n\n#### 数据范围\n\n|测试点编号|1|2|3|4|5|6|7|8|9|10|\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|文件名|`01`|`02`|`03`|`04`|`05`|`06`|`07`|`08`|`09`|`10`|\n|$T$|$3$|$100$|$100$|$500$|$200$|$50$|$10$|$5$|$2$|$1$|\n|$n$|$7$|$10$|$30$|$100$|$500$|$2000$|$10000$|$20000$|$50000$|$100000$|", "locale": "zh-CN", "translations": {"en": {"title": "[eJOI 2018] Coprime Tree", "background": "**This problem is translated from [eJOI2018](http://ejoi2018.org/) Problem E \"Prime Tree\".**", "description": "This is an output-only problem. The input files are provided in the attachments.\n\nThere is a tree with $n$ nodes, numbered from $1$ to $n$.  \nFor any edge $(u, v)$, if there exists a positive integer $d > 1$ such that $d \\mid u$ and $d \\mid v$, then we call it a **bad edge**.  \nIn the tree shown below, there are three bad edges: $(6, 4)$ (both divisible by $2$), $(2, 6)$ (both divisible by $2$), and $(3, 6)$ (both divisible by $3$).\n\n![](https://i.loli.net/2018/08/17/5b7633a4ceb38.png)\n\nYour task is to renumber the nodes so that the number of bad edges is as small as possible.  \nFor the tree above, if you renumber the nodes as in the figure below, there will be only one bad edge left, $(3, 6)$.\n\n![](https://i.loli.net/2018/08/17/5b7633a4cfebf.png)\n\nAfter renumbering, the fewer bad edges you have, the higher your score will be.\n\n**This is an output-only problem. You should download the output file, then run your program locally and upload the output result.** Of course, on Luogu you may also submit your program directly.", "inputFormat": "Each test point contains multiple groups of testdata.  \nThe first line contains an integer $T$, the number of testdata groups.  \nEach group of testdata has $n$ lines in total, where $n$ is the number of nodes in the tree.  \nThe first line contains an integer $n$.  \nThe next $n - 1$ lines each contain two integers $u$ and $v \\ (1 \\le u, v \\le n)$, representing an edge $(u, v)$.\n\n**In each input file, all trees have the same number of nodes.**", "outputFormat": "For each group of testdata, output one line with $n$ integers, representing the new labels of the nodes originally labeled from $1$ to $n$.  \n**All node labels must be different. That is, the $n$ integers you output for the same group of testdata must be pairwise distinct.**", "hint": "### Scoring\n\nFor each test point, let the total number of edges in all trees be $M = T \\times (n - 1)$. Let the number of bad edges in your output be $X$, and define $R = \\dfrac{X}{M}$. Your score as a function of $R$ is as follows:\n\n|$R$|Score|$R$|Score|\n|:-:|:-:|:-:|:-:|\n|$0.33 < R \\le 0.4$|$1$|$0.01 < R \\le 0.05$|$6$|\n|$0.26 < R \\le 0.33$|$2$|$0.005 < R \\le 0.01$|$7$|\n|$0.19 < R \\le 0.26$|$3$|$0.001 < R \\le 0.005$|$8$|\n|$0.12 < R \\le 0.19$|$4$|$0  < R \\le 0.001$|$9$|\n|$0.05 < R \\le 0.12$|$5$|$R = 0$|$10$|\n\nWhen $R > 0.4$, you get no score.\n\n**For all test points, it is guaranteed that an output with $X = 0$ exists.**\n\n---\n\n### Sample Explanation\n\nNote that the sample provides two valid outputs. For convenience, call them Output 1 and Output 2.\n\nThe first group of testdata has already been discussed in the statement. In Output 1 there is one bad edge $(3, 6)$, while in Output 2 there are no bad edges.  \nIn the second group of testdata, neither Output 1 nor Output 2 contains any bad edges.\n\nIn the sample, $M = 2 \\times 5 = 10$.\n\nFor Output 1, $X = 1, R = \\dfrac{1}{10} = 0.1$, so this output gets $5$ points.\n\nFor Output 2, $X = 0, R = \\dfrac{0}{10} = 0$, so this output gets $10$ points.\n\n---\n\n### Constraints and Limits\n\n#### Limits\n- For test point 1 (input `01`), $T = 3, n = 7$. The three trees are as follows:\n\n![](https://i.loli.net/2018/08/17/5b765edf30647.png)\n\n- For test points 4 to 8 (inputs `04` to `08`), the input has special properties (for example, many leaf nodes, being a binary tree, etc.), and trees with these special properties are evenly distributed within each test point.\n\n- For the other test points, the data is randomly generated.\n\n#### Constraints\n\n|Test Point|1|2|3|4|5|6|7|8|9|10|\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|Filename|`01`|`02`|`03`|`04`|`05`|`06`|`07`|`08`|`09`|`10`|\n|$T$|$3$|$100$|$100$|$500$|$200$|$50$|$10$|$5$|$2$|$1$|\n|$n$|$7$|$10$|$30$|$100$|$500$|$2000$|$10000$|$20000$|$50000$|$100000$|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[eJOI 2018] 互素树", "background": "**本题译自 [eJOI2018](http://ejoi2018.org/) Problem E「Prime Tree」**\n\n", "description": "本题为提交答案，输入文件在附件中。\n\n设有一棵有 $n$ 个结点的树，其结点编号为 $1$ 到 $n$ 。  \n对于其中的任意一条边 $(u, v)$ ，如果存在一个正整数 $d>1$ 满足 $ d \\mid u, d\\mid v$ ，我们称它为一条**坏的边**。  \n下图中的树有三条坏的边—— $(6, 4)$（都被 $2$ 整除）， $(2, 6)$（都被 $2$ 整除）， $(3, 6)$（都被 $3$ 整除）。\n\n![](https://i.loli.net/2018/08/17/5b7633a4ceb38.png)\n\n你的任务是将结点重新编号，使得图中坏的边的数量尽量少。  \n对于上图中的树，按照下图中的方式将结点重新编号，会只剩一条坏的边 $(3, 6)$ 。\n\n![](https://i.loli.net/2018/08/17/5b7633a4cfebf.png)\n\n重新编号后，坏的边越少，你的得分越高。\n\n**这是一道提交答案题。你应当下载输出文件，然后在本地运行你的程序，将输出结果上传**。当然，在洛谷上你可以直接提交你的程序。", "inputFormat": "每个测试点中有多组测试数据。  \n第一行，一个整数 $T$，表示测试数据组数。  \n每组测试数据共 $n$ 行，其中 $n$ 表示树的结点个数。  \n第一行，一个整数 $n$；  \n接下来 $n-1$ 行，每行两个整数 $u$ 和 $v\\ ( 1 \\le u, v \\le n)$，表示一条边 $(u,v)$ 。\n\n**每个输入文件中，每棵树的结点个数相同。**", "outputFormat": "对于每组测试数据，输出一行 $n$ 个整数，表示原先编号为 $1$ 到 $n$ 的结点的新编号。   \n**每个结点的编号必须不同，也就是说同一组测试数据中输出的 $n$ 个整数必须互不相同。**", "hint": "### 计分方式\n对于每个测试点，设所有树的总边数为 $M=T \\times (n-1)$，你的输出中坏的边数为 $X$，记 $R=\\dfrac{X}{M}$ ，你的得分与 $R$ 的关系如下：\n\n|$R$|得分|$R$|得分|\n|:-:|:-:|:-:|:-:|\n|$0.33 < R \\le 0.4$|$1$|$0.01 < R \\le 0.05$|$6$|\n|$0.26 < R \\le 0.33$|$2$|$0.005 < R \\le 0.01$|$7$|\n|$0.19 < R \\le 0.26$|$3$|$0.001 < R \\le 0.005$|$8$|\n|$0.12 < R \\le 0.19$|$4$|$0  < R \\le 0.001$|$9$|\n|$0.05 < R \\le 0.12$|$5$|$R=0$|$10$|\n\n当 $R > 0.4$ 时，不能得分。\n\n**对于所有的测试点，保证存在 $X=0$ 的输出。**\n\n---\n\n### 样例解释\n注意样例中给出了两种合法的输出，为了方便，下称输出 1 和 输出 2。\n\n第一组测试数据已经在题目描述中讨论过。输出 1 中有一条坏的边 $(3, 6)$，输出 2 中没有坏的边。  \n第二组测试数据中，输出 1 和输出 2 都没有出现坏的边。\n\n样例中，$M=2 \\times 5=10$。  \n\n对于输出 1，$X=1, R=\\dfrac{1}{10}=0.1$，该输出将得到 $5$ 分。\n\n对于输出 2，$X=0, R=\\dfrac{0}{10}=0$，该输出将得到 $10$ 分。\n\n---\n\n### 数据范围和限制\n\n#### 数据限制\n- 对于测试点 1 （输入 `01`），$T=3, n=7$，三棵树分别如下所示：\n\n![](https://i.loli.net/2018/08/17/5b765edf30647.png)\n\n- 对于测试点 4 至 8 （输入 `04` 至 `08`），输入数据有特殊性质（如叶子结点较多，是二叉树等），且这些具有特殊性质的树在各个测试点中输入数据均匀分布。\n\n- 对于其他测试点，数据为随机生成。  \n\n#### 数据范围\n\n|测试点编号|1|2|3|4|5|6|7|8|9|10|\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|文件名|`01`|`02`|`03`|`04`|`05`|`06`|`07`|`08`|`09`|`10`|\n|$T$|$3$|$100$|$100$|$500$|$200$|$50$|$10$|$5$|$2$|$1$|\n|$n$|$7$|$10$|$30$|$100$|$500$|$2000$|$10000$|$20000$|$50000$|$100000$|", "locale": "zh-CN"}}}
{"pid": "P5091", "type": "P", "difficulty": 5, "samples": [["2 7 4", "2"], ["998244353 12345 98765472103312450233333333333", "5333"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "模板题"], "title": "【模板】扩展欧拉定理", "background": "出题人也想写有趣的题面，可惜并没有能力。", "description": "给你三个正整数，$a,m,b$，你需要求：$a^b \\bmod m$   \n", "inputFormat": "一行三个整数，$a,m,b$", "outputFormat": "一个整数表示答案", "hint": "注意输入格式，$a,m,b$ 依次代表的是底数、模数和次数   \n\n【样例 $1$ 解释】   \n$2^4 \\bmod 7 = 2$     \n     \n【数据范围】  \n对于 $100\\%$ 的数据，$1\\le a \\le 10^9$，$1\\le b \\le 10^{20000000}，1\\le m \\le 10^8$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Extended Euler Theorem", "background": "The problem setter also wants to write an interesting statement, but unfortunately does not have the ability.", "description": "You are given three positive integers $a$, $m$, and $b$. You need to compute: $a^b \\bmod m$.", "inputFormat": "One line with three integers, $a,m,b$.", "outputFormat": "Output one integer representing the answer.", "hint": "Pay attention to the input format: $a,m,b$ represent the base, the modulus, and the exponent, in this order.\n\n[Sample $1$ Explanation]  \n$2^4 \\bmod 7 = 2$.\n\n[Constraints]  \nFor $100\\%$ of the testdata, $1\\le a \\le 10^9$, $1\\le b \\le 10^{20000000}$, $1\\le m \\le 10^8$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】扩展欧拉定理", "background": "出题人也想写有趣的题面，可惜并没有能力。", "description": "给你三个正整数，$a,m,b$，你需要求：$a^b \\bmod m$   \n", "inputFormat": "一行三个整数，$a,m,b$", "outputFormat": "一个整数表示答案", "hint": "注意输入格式，$a,m,b$ 依次代表的是底数、模数和次数   \n\n【样例 $1$ 解释】   \n$2^4 \\bmod 7 = 2$     \n     \n【数据范围】  \n对于 $100\\%$ 的数据，$1\\le a \\le 10^9$，$1\\le b \\le 10^{20000000}，1\\le m \\le 10^8$。", "locale": "zh-CN"}}}
{"pid": "P5092", "type": "P", "difficulty": 4, "samples": [["6\nM 1 6\nC 1\nM 2 4\nM 2 6\nC 3\nC 4", "1\n0\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2004", "USACO", "并查集"], "title": "[USACO04OPEN] Cube Stacking", "background": null, "description": "约翰和贝茜在玩一个方块游戏。编号为 $ 1\\ldots n $ 的 $ n $（$ 1 \\leq n \\leq 30000 $）个方块正放在地上，每个构成一个立方柱。\n\n游戏开始后，约翰会给贝茜发出 $ P $（$ 1 \\leq P \\leq 100000 $）个指令。指令有两种：\n\n1. 移动（```M```）：将包含 ```X``` 的立方柱移动到包含 ```Y``` 的立方柱上。\n2. 统计（```C```）：统计含 ```X``` 的立方柱中，在 ```X``` 下方的方块数目。\n\n写个程序帮贝茜完成游戏。", "inputFormat": "第 $1$ 行输入 $ P $ ，之后 $ P $ 行每行输入一条指令，形式为 `M X Y` 或者 `C X`。\n\n输入保证不会有将立方柱放在自己头上的指令。", "outputFormat": "对于每个统计指令，输出一行一个整数，代表其结果。", "hint": "部分数据范围见输入格式。\n\n$1 \\le X, Y \\le n$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO04OPEN] Cube Stacking", "background": "", "description": "John and Bessie are playing a cube game. There are $n$ cubes numbered $1\\ldots n$ ($1 \\leq n \\leq 30000$) placed on the ground at the start, each forming a single-cube pile.\n\nAfter the game starts, John will give Bessie $P$ commands ($1 \\leq P \\leq 100000$). There are two types of commands:\n\n1. Move (`M`): Move the pile containing `X` onto the top of the pile containing `Y`.\n2. Count (`C`): Count how many cubes are below cube `X` in the pile containing `X`.\n\nWrite a program to help Bessie complete the game.", "inputFormat": "The first line contains $P$. The next $P$ lines each contain one command, in the form `M X Y` or `C X`.\n\nThe input guarantees that there will be no command that moves a pile onto itself.", "outputFormat": "For each count command, output one line with one integer, which is the result.", "hint": "Some Constraints are shown in the Input Format.\n\n$1 \\le X, Y \\le n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO04OPEN] Cube Stacking", "background": null, "description": "约翰和贝茜在玩一个方块游戏。编号为 $ 1\\ldots n $ 的 $ n $（$ 1 \\leq n \\leq 30000 $）个方块正放在地上，每个构成一个立方柱。\n\n游戏开始后，约翰会给贝茜发出 $ P $（$ 1 \\leq P \\leq 100000 $）个指令。指令有两种：\n\n1. 移动（```M```）：将包含 ```X``` 的立方柱移动到包含 ```Y``` 的立方柱上。\n2. 统计（```C```）：统计含 ```X``` 的立方柱中，在 ```X``` 下方的方块数目。\n\n写个程序帮贝茜完成游戏。", "inputFormat": "第 $1$ 行输入 $ P $ ，之后 $ P $ 行每行输入一条指令，形式为 `M X Y` 或者 `C X`。\n\n输入保证不会有将立方柱放在自己头上的指令。", "outputFormat": "对于每个统计指令，输出一行一个整数，代表其结果。", "hint": "部分数据范围见输入格式。\n\n$1 \\le X, Y \\le n$。", "locale": "zh-CN"}}}
{"pid": "P5093", "type": "P", "difficulty": 5, "samples": [["14 5\n1\n5\n3\n2\n5\n1\n3\n4\n4\n2\n5\n1\n2\n3", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2004", "USACO"], "title": "[USACO04OPEN] The Cow Lineup", "background": "", "description": "约翰的 $ N $（$ 1 \\leq N \\leq 100000 $）只奶牛站成了一列。每只奶牛都写有一个号牌，表示她的品种，号牌上的号码在 $ 1 \\ldots K $（$ 1 \\leq K \\leq 10000 $ ）范围内。\n\n比如有这样一个队列：1,5,3,2,5,3,4,4,2,5,1,2,3\n\n根据约翰敏锐的数学神经，他发现一些子序列在这个队列里出现，比如\"3,4,1,3\"，而另一些没有。子序列的各项之间穿插有其他数，也可认为这个子序列存在。现在，他想用 $1 \\sim K$ 之间的整数构造一个最短的子序列，使之不在奶牛序列里出现。达个子序列的长度是多少呢？", "inputFormat": "第1行输入两个整数 $ N $ 和 $ K $ ，接下来 $ N $ 行输入奶牛序列.", "outputFormat": "输出一行，最短的不出现子序列的长度。", "hint": "样例解释：\n\n所有长度为 $1$ 和 $2$ 的可能的子序列都出现了，但长度为 $3$ 的子序列\"2,2,4\"却没有出现。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO04OPEN] The Cow Lineup", "background": "", "description": "John’s $N$ cows ($1 \\leq N \\leq 100000$) are standing in a line. Each cow has a tag number that shows her breed, and the tag number is in the range $1 \\ldots K$ ($1 \\leq K \\leq 10000$).\n\nFor example, there is a lineup like this: 1,5,3,2,5,3,4,4,2,5,1,2,3.\n\nWith his sharp math sense, John finds that some subsequences appear in this lineup, such as \"3,4,1,3\", while others do not. Other numbers may appear between the elements of the subsequence; if so, the subsequence is still considered to exist. Now he wants to use integers from $1 \\sim K$ to construct the shortest subsequence that does not appear in the cow sequence. What is the length of such a subsequence?", "inputFormat": "The first line contains two integers $N$ and $K$. The next $N$ lines contain the cow sequence.", "outputFormat": "Output one line: the length of the shortest subsequence that does not appear.", "hint": "Explanation of the sample:\n\nAll possible subsequences of length $1$ and $2$ appear, but the subsequence of length $3$, \"2,2,4\", does not appear.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO04OPEN] The Cow Lineup", "background": "", "description": "约翰的 $ N $（$ 1 \\leq N \\leq 100000 $）只奶牛站成了一列。每只奶牛都写有一个号牌，表示她的品种，号牌上的号码在 $ 1 \\ldots K $（$ 1 \\leq K \\leq 10000 $ ）范围内。\n\n比如有这样一个队列：1,5,3,2,5,3,4,4,2,5,1,2,3\n\n根据约翰敏锐的数学神经，他发现一些子序列在这个队列里出现，比如\"3,4,1,3\"，而另一些没有。子序列的各项之间穿插有其他数，也可认为这个子序列存在。现在，他想用 $1 \\sim K$ 之间的整数构造一个最短的子序列，使之不在奶牛序列里出现。达个子序列的长度是多少呢？", "inputFormat": "第1行输入两个整数 $ N $ 和 $ K $ ，接下来 $ N $ 行输入奶牛序列.", "outputFormat": "输出一行，最短的不出现子序列的长度。", "hint": "样例解释：\n\n所有长度为 $1$ 和 $2$ 的可能的子序列都出现了，但长度为 $3$ 的子序列\"2,2,4\"却没有出现。", "locale": "zh-CN"}}}
{"pid": "P5094", "type": "P", "difficulty": 4, "samples": [["4\n3 1\n2 5\n2 6\n4 3", "57"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2004", "USACO", "树状数组", "cdq 分治", "分治"], "title": "[USACO04OPEN] MooFest G 加强版", "background": null, "description": "每一年，约翰的 $ N $ 只奶牛参加奶牛狂欢节。这是一个全世界奶牛都参加的大联欢。狂欢节包括很多有趣的活动，比如干草堆叠大赛、跳牛栏大赛，奶牛之间有时还相互扎屁股取乐。当然，她们会排成一列嚎叫，来欢庆她们的节日。奶牛们的叫声实在刺耳，以致于每只奶牛的听力都受到不同程度的损伤。现在告诉你奶牛 $ i $ 的听力为 $ v_i $ ，这表示如果奶牛 $ j $ 想说点什么让她听到，必须用高于 $ v_i \\times dis(i,j) $ 的音量。因此，如果奶牛 $ i $ 和 $ j $ 想相互交谈，她们的音量必须不小于 $ \\max (v_i,v_j) \\times dis(i,j) $。其中 $ dis(i,j) $ 表示她们间的距离。\n\n现在 $ N $ 只奶牛都站在一条直线上了，每只奶牛还有一个坐标 $ x_i $。如果每对奶牛都在交谈，并且使用最小音量，那所有 $ N(N-1)/2 $ 对奶牛间谈话的音量之和为多少？", "inputFormat": "第 $1$ 行输入一个整数 $ N $ 。\n\n接下来 $ N $ 行，每行输入两个数 $ v_i $ 和 $ x_i $ ，分别代表第 $ i $ 头奶牛的听力和坐标。", "outputFormat": "输出一个数，代表这 $ N(N-1)/2 $ 对奶牛谈话时的音量之和。", "hint": "### 数据范围\n\n因为原数据下 $O(N^2)$ 算法可以通过，所以新添加了一些增强数据。\n\n原数据作为子任务 $1$，新添加的数据作为子任务 $2$。\n\n- 子任务 $1$（$1$ 分）：$1 \\leq N,V_i,x_i \\leq 2 \\times 10^4$。\n- 子任务 $2$（$99$ 分）：$1 \\leq N,V_i,x_i \\leq 5 \\times 10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO04OPEN] MooFest G Enhanced Version", "background": "", "description": "Every year, John’s $N$ cows take part in the MooFest, a big festival for cows all over the world. The festival has many fun activities, such as haystack piling contests and cow-pen jumping contests. Sometimes the cows also poke each other for fun. Of course, they will line up and moo loudly to celebrate their holiday.\n\nThe cows’ moos are so noisy that each cow’s hearing is damaged to a different degree. Now you are given cow $i$’s hearing level $v_i$. This means that if cow $j$ wants to say something that cow $i$ can hear, cow $j$ must use a volume greater than $v_i \\times dis(i,j)$. Therefore, if cows $i$ and $j$ want to talk to each other, their volume must be at least $\\max(v_i, v_j) \\times dis(i,j)$, where $dis(i,j)$ is the distance between them.\n\nNow the $N$ cows are standing on a straight line, and each cow has a coordinate $x_i$. If every pair of cows is talking, and each pair uses the minimum required volume, what is the sum of the volumes over all $N(N-1)/2$ pairs?", "inputFormat": "The first line contains an integer $N$.\n\nThe next $N$ lines each contain two numbers $v_i$ and $x_i$, representing the $i$-th cow’s hearing level and coordinate, respectively.", "outputFormat": "Output one number, which is the sum of the volumes when these $N(N-1)/2$ pairs of cows talk.", "hint": "### Constraints\n\nSince an $O(N^2)$ algorithm can pass under the original data, some additional enhanced testdata has been added.\n\nThe original data is Subtask $1$, and the newly added data is Subtask $2$.\n\n- Subtask $1$ ($1$ point): $1 \\leq N, V_i, x_i \\leq 2 \\times 10^4$.\n- Subtask $2$ ($99$ points): $1 \\leq N, V_i, x_i \\leq 5 \\times 10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO04OPEN] MooFest G 加强版", "background": null, "description": "每一年，约翰的 $ N $ 只奶牛参加奶牛狂欢节。这是一个全世界奶牛都参加的大联欢。狂欢节包括很多有趣的活动，比如干草堆叠大赛、跳牛栏大赛，奶牛之间有时还相互扎屁股取乐。当然，她们会排成一列嚎叫，来欢庆她们的节日。奶牛们的叫声实在刺耳，以致于每只奶牛的听力都受到不同程度的损伤。现在告诉你奶牛 $ i $ 的听力为 $ v_i $ ，这表示如果奶牛 $ j $ 想说点什么让她听到，必须用高于 $ v_i \\times dis(i,j) $ 的音量。因此，如果奶牛 $ i $ 和 $ j $ 想相互交谈，她们的音量必须不小于 $ \\max (v_i,v_j) \\times dis(i,j) $。其中 $ dis(i,j) $ 表示她们间的距离。\n\n现在 $ N $ 只奶牛都站在一条直线上了，每只奶牛还有一个坐标 $ x_i $。如果每对奶牛都在交谈，并且使用最小音量，那所有 $ N(N-1)/2 $ 对奶牛间谈话的音量之和为多少？", "inputFormat": "第 $1$ 行输入一个整数 $ N $ 。\n\n接下来 $ N $ 行，每行输入两个数 $ v_i $ 和 $ x_i $ ，分别代表第 $ i $ 头奶牛的听力和坐标。", "outputFormat": "输出一个数，代表这 $ N(N-1)/2 $ 对奶牛谈话时的音量之和。", "hint": "### 数据范围\n\n因为原数据下 $O(N^2)$ 算法可以通过，所以新添加了一些增强数据。\n\n原数据作为子任务 $1$，新添加的数据作为子任务 $2$。\n\n- 子任务 $1$（$1$ 分）：$1 \\leq N,V_i,x_i \\leq 2 \\times 10^4$。\n- 子任务 $2$（$99$ 分）：$1 \\leq N,V_i,x_i \\leq 5 \\times 10^4$。", "locale": "zh-CN"}}}
{"pid": "P5095", "type": "P", "difficulty": 4, "samples": [["5 10\n5 7\n9 2\n8 5\n13 2\n3 8", "21"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "USACO"], "title": "[USACO12OPEN] Bookshelf S", "background": "", "description": "Farmer John 闲来无事的时候总喜欢坐下来看书。这些年来，他一共收集了 $N$ 本书（$1 \\leq N \\leq 2000$），他打算搭一个新的书架来装这些书。\n\n每本书都有个宽度 $w_i$ 和高度 $h_i$，书必须按顺序来摆放（即同一层书架摆的书必须是连续的一个区间）。每层书架的总宽度不能超过 $L$（$1 \\leq L \\leq 10^9$），每层书架的高度等于这一层最高的书的高度，整个书架的高度等于每层书架的高度之和。\n\n现在请你帮 FJ 求出书架高度的最小值。", "inputFormat": "第一行两个整数 $N,L$。\n\n接下来 $N$ 行，每行两个整数 $h_i,w_i$（$1 \\leq h_i \\leq 10^6$，$1 \\leq w_i \\leq L$）。", "outputFormat": "输出一个整数，书架高度最小值。", "hint": "第一层放第一本书，第二层放第二，三，四本书，第三层放第五本书，总高度为 $5+13+3=21$，可以证明不存在更优的方案。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO12OPEN] Bookshelf S", "background": "", "description": "Farmer John likes to sit down and read when he has nothing to do. Over the years, he has collected a total of $N$ books ($1 \\leq N \\leq 2000$), and he plans to build a new bookshelf to hold these books.\n\nEach book has a width $w_i$ and a height $h_i$. The books must be placed in order (that is, the books placed on the same shelf layer must form a consecutive interval). The total width of each shelf layer cannot exceed $L$ ($1 \\leq L \\leq 10^9$). The height of a shelf layer equals the height of the tallest book on that layer, and the total height of the bookshelf equals the sum of the heights of all layers.\n\nNow please help FJ find the minimum possible total height of the bookshelf.", "inputFormat": "The first line contains two integers $N, L$.\n\nThe next $N$ lines each contain two integers $h_i, w_i$ ($1 \\leq h_i \\leq 10^6$, $1 \\leq w_i \\leq L$).", "outputFormat": "Output one integer, the minimum possible height of the bookshelf.", "hint": "Put the first book on the first layer, the second, third, and fourth books on the second layer, and the fifth book on the third layer. The total height is $5+13+3=21$. It can be proven that there is no better arrangement.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO12OPEN] Bookshelf S", "background": "", "description": "Farmer John 闲来无事的时候总喜欢坐下来看书。这些年来，他一共收集了 $N$ 本书（$1 \\leq N \\leq 2000$），他打算搭一个新的书架来装这些书。\n\n每本书都有个宽度 $w_i$ 和高度 $h_i$，书必须按顺序来摆放（即同一层书架摆的书必须是连续的一个区间）。每层书架的总宽度不能超过 $L$（$1 \\leq L \\leq 10^9$），每层书架的高度等于这一层最高的书的高度，整个书架的高度等于每层书架的高度之和。\n\n现在请你帮 FJ 求出书架高度的最小值。", "inputFormat": "第一行两个整数 $N,L$。\n\n接下来 $N$ 行，每行两个整数 $h_i,w_i$（$1 \\leq h_i \\leq 10^6$，$1 \\leq w_i \\leq L$）。", "outputFormat": "输出一个整数，书架高度最小值。", "hint": "第一层放第一本书，第二层放第二，三，四本书，第三层放第五本书，总高度为 $5+13+3=21$，可以证明不存在更优的方案。", "locale": "zh-CN"}}}
{"pid": "P5096", "type": "P", "difficulty": 4, "samples": [["6 7 5\n1\n2\n3\n4\n5\n1 2 3\n3 6 2\n6 2 10\n2 4 1\n5 1 1\n4 5 1\n1 6 1", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2004", "USACO"], "title": "[USACO04OPEN] Cave Cows 1", "background": "", "description": "很少人知道其实奶牛非常喜欢到洞穴里面去探险。\n\n洞窟里有 $ N $ ( $ 1 \\leq N \\leq 100 $ )个洞室，由 $ M $ ( $ 1 \\leq M \\leq 1000 $ )条双向通道连接着它们。每对洞室间至多只有一条双向通道，有 $ K $ ( $ 1 \\leq K \\leq 14 $ )个洞室，里面放有1捆干草．牛吃1捆干草，体重指数就会增加1。\n\n贪吃的贝茜要到洞窟里面探险，她希望能吃尽量多的干草，但每条通道有一个宽度阈值，如果体重指数超过相应的阈值，贝茜就会被卡住。\n\n她从洞窟1出发，体重指数为0。在洞里溜达一圈后，她要返回洞窟1。\n\n那她最多能吃多少捆干草呢？注意，贝茜经过一个洞室，不一定非要吃掉里面的干草。", "inputFormat": "第1行输入 $ N,M,K $ 。\n\n之后 $ K $ 行每行一个整数，表示在这个洞室放有一捆干草；接下来 $ M $ 行每行三个整数，表示一条双向通道的起点终点和宽度阈值。", "outputFormat": "最多能吃掉的干草数。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[USACO04OPEN] Cave Cows 1", "background": "", "description": "Few people know that cows actually really like exploring caves.\n\nThere are $N$ ( $1 \\leq N \\leq 100$ ) chambers in the cave, connected by $M$ ( $1 \\leq M \\leq 1000$ ) bidirectional passages. Between any pair of chambers, there is at most one bidirectional passage. There are $K$ ( $1 \\leq K \\leq 14$ ) chambers, each containing one bale of hay. Every time a cow eats one bale of hay, her weight index increases by $1$.\n\nThe greedy Bessie wants to explore the cave and hopes to eat as much hay as possible, but each passage has a width threshold: if her weight index exceeds the corresponding threshold, Bessie will get stuck.\n\nShe starts from chamber $1$ with weight index $0$. After wandering around in the cave, she must return to chamber $1$.\n\nWhat is the maximum number of hay bales she can eat? Note that when Bessie passes through a chamber, she does not have to eat the hay in it.", "inputFormat": "The first line contains $N, M, K$.\n\nThe next $K$ lines each contain one integer, indicating a chamber that contains one bale of hay. Then the next $M$ lines each contain three integers, indicating the two endpoints of a bidirectional passage and its width threshold.", "outputFormat": "The maximum number of hay bales that can be eaten.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO04OPEN] Cave Cows 1", "background": "", "description": "很少人知道其实奶牛非常喜欢到洞穴里面去探险。\n\n洞窟里有 $ N $ ( $ 1 \\leq N \\leq 100 $ )个洞室，由 $ M $ ( $ 1 \\leq M \\leq 1000 $ )条双向通道连接着它们。每对洞室间至多只有一条双向通道，有 $ K $ ( $ 1 \\leq K \\leq 14 $ )个洞室，里面放有1捆干草．牛吃1捆干草，体重指数就会增加1。\n\n贪吃的贝茜要到洞窟里面探险，她希望能吃尽量多的干草，但每条通道有一个宽度阈值，如果体重指数超过相应的阈值，贝茜就会被卡住。\n\n她从洞窟1出发，体重指数为0。在洞里溜达一圈后，她要返回洞窟1。\n\n那她最多能吃多少捆干草呢？注意，贝茜经过一个洞室，不一定非要吃掉里面的干草。", "inputFormat": "第1行输入 $ N,M,K $ 。\n\n之后 $ K $ 行每行一个整数，表示在这个洞室放有一捆干草；接下来 $ M $ 行每行三个整数，表示一条双向通道的起点终点和宽度阈值。", "outputFormat": "最多能吃掉的干草数。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5097", "type": "P", "difficulty": 3, "samples": [["10 4\n75\n30\n100\n38\n50\n51\n52\n20\n81\n5\n1 10\n3 5\n6 9\n8 10", "5\n38\n20\n5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2004", "USACO"], "title": "[USACO04OPEN] Cave Cows 2", "background": "", "description": "洞窟里有一道长长的通道．它由 $ N $ ( $ 1 \\leq N \\leq 25000 $ )段道尾相连构成，编号分别为 $ 1 \\ldots N $ 。\n\n每个通道有一个阈值，其范围在 $ [1,10^9] $ 。依次通过 $ i \\ldots j $ 的通道，那奶牛的体重指数就不能超过 $ i \\ldots j $ 通道中阈值的最小值。贝茜有 \n$ Q $ ( $ 1 \\leq Q \\leq 25000 $ )个问题，想请教你由 $ i $ 到 $ j $ 的通道的阈值的最小值。", "inputFormat": "第1行输入 $ N $ 和 $ Q $ 。\n\n接下来 $ N $ 行输入每个通道的阈值，之后 $ Q $ 行每行两个整数，对应问题中的 $ i $ 和 $ j $（ $ i<j $ ）。", "outputFormat": "对于每个问题，输出其结果。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[USACO04OPEN] Cave Cows 2", "background": "", "description": "There is a long passage in a cave. It is made up of $N$ segments ($1 \\leq N \\leq 25000$) connected end to end, numbered $1 \\ldots N$.\n\nEach segment has a threshold value in the range $[1,10^9]$. If a cow passes through segments $i \\ldots j$ in order, then the cow’s weight index must not exceed the minimum threshold among segments $i \\ldots j$. Bessie has $Q$ questions ($1 \\leq Q \\leq 25000$) and wants to ask you for the minimum threshold value from segment $i$ to segment $j$.", "inputFormat": "The first line contains $N$ and $Q$.\n\nThe next $N$ lines contain the threshold value of each segment. After that, the next $Q$ lines each contain two integers, corresponding to $i$ and $j$ in the questions ($i < j$).", "outputFormat": "For each query, output the answer.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO04OPEN] Cave Cows 2", "background": "", "description": "洞窟里有一道长长的通道．它由 $ N $ ( $ 1 \\leq N \\leq 25000 $ )段道尾相连构成，编号分别为 $ 1 \\ldots N $ 。\n\n每个通道有一个阈值，其范围在 $ [1,10^9] $ 。依次通过 $ i \\ldots j $ 的通道，那奶牛的体重指数就不能超过 $ i \\ldots j $ 通道中阈值的最小值。贝茜有 \n$ Q $ ( $ 1 \\leq Q \\leq 25000 $ )个问题，想请教你由 $ i $ 到 $ j $ 的通道的阈值的最小值。", "inputFormat": "第1行输入 $ N $ 和 $ Q $ 。\n\n接下来 $ N $ 行输入每个通道的阈值，之后 $ Q $ 行每行两个整数，对应问题中的 $ i $ 和 $ j $（ $ i<j $ ）。", "outputFormat": "对于每个问题，输出其结果。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5098", "type": "P", "difficulty": 3, "samples": [["5\n1 1\n3 5\n2 7\n8 1\n4 4", "12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2004", "USACO"], "title": "[USACO04OPEN] Cave Cows 3", "background": null, "description": "约翰的 $ N $（$ 1 \\leq N \\leq 50000 $）只牛在一个黑魃魃的洞里探险，他们只能通过叫声交流。\n\n两只牛之间的曼哈顿距离决定了声音传播的时间。即牛一与牛二交流，需要的时间为 $ |x_1-x_2|+|y_1-y_2| $。其中 $ -10^6 \\leq x_1,x_2,y_1,y_2 \\leq 10^6 $。\n\n那任意一对牛之间交流时间的最大值为多少？", "inputFormat": "第 $1$ 行输入 $N$，接下来每行输入一只牛的坐标。", "outputFormat": "交流时间最大值（即最大曼哈顿距离）。", "hint": "样例解释：\n\n$ (2,7) $ 和 $ (8,1) $ 两点间的距离最大，为 $12$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO04OPEN] Cave Cows 3", "background": "", "description": "John’s $N$ ($1 \\leq N \\leq 50000$) cows are exploring in a pitch-black cave, and they can only communicate by calling.\n\nThe time for sound to travel is determined by the Manhattan distance between two cows. That is, for cow 1 and cow 2 to communicate, the required time is $|x_1-x_2|+|y_1-y_2|$. Here, $-10^6 \\leq x_1,x_2,y_1,y_2 \\leq 10^6$.\n\nWhat is the maximum communication time among all pairs of cows?", "inputFormat": "The first line contains $N$. Each of the following lines contains the coordinates of one cow.", "outputFormat": "The maximum communication time (i.e., the maximum Manhattan distance).", "hint": "Explanation of the sample:\n\nThe distance between $(2,7)$ and $(8,1)$ is the largest, which is $12$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO04OPEN] Cave Cows 3", "background": null, "description": "约翰的 $ N $（$ 1 \\leq N \\leq 50000 $）只牛在一个黑魃魃的洞里探险，他们只能通过叫声交流。\n\n两只牛之间的曼哈顿距离决定了声音传播的时间。即牛一与牛二交流，需要的时间为 $ |x_1-x_2|+|y_1-y_2| $。其中 $ -10^6 \\leq x_1,x_2,y_1,y_2 \\leq 10^6 $。\n\n那任意一对牛之间交流时间的最大值为多少？", "inputFormat": "第 $1$ 行输入 $N$，接下来每行输入一只牛的坐标。", "outputFormat": "交流时间最大值（即最大曼哈顿距离）。", "hint": "样例解释：\n\n$ (2,7) $ 和 $ (8,1) $ 两点间的距离最大，为 $12$。", "locale": "zh-CN"}}}
{"pid": "P5099", "type": "P", "difficulty": 4, "samples": [["5 3\n1 2\n6 3\n4 1\n3 2\n0 2", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2004", "USACO"], "title": "[USACO04OPEN] Cave Cows 4", "background": "", "description": "一道竖直的石墙横在贝茜前面，她必须越过去。\n\n石墙可以看成一个xz平面，贝茜开始的时候在(0，0)，只要她到达 $ z=T $ \n ( $ 1 \\leq T \\leq 200000 $ )的位置，就算翻越成功。\n\n墙上有 $ N $ ( $ 1 \\leq N \\leq 50000 $ )块石头突出，成为贝茜的落蹄石。如果两个落蹄石之间x方向和z方向的距离均不超过2，那贝茜就可以攀上另一块落蹄石。\n\n帮助贝茜计算她是否能够翻越石墙，如果可以，最少需要踩多少块落蹄石。", "inputFormat": "第1行输入 $ N $ 和 $ T $ 。\n\n接下来 $ N $ 行，每行输入坐标 $ (x,z) $ ，表示一个石头的位置．其中 $ x \\leq 10^6 $ ， $ z \\leq T $ ，保证 $ (0,0) $ 不会出现。", "outputFormat": "如果可以翻越则输出最少需要的落蹄石数（起点不计入），否则输出 $ -1 $ 。", "hint": "一种可行的方案是：(0,0) -> (1,2) -> (3,2) -> (4,1) -> (6,3) 。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO04OPEN] Cave Cows 4", "background": "", "description": "A vertical stone wall stands in front of Bessie, and she must climb over it.\n\nThe wall can be seen as the $ xz $ plane. Bessie starts at $ (0,0) $. As long as she reaches the position with $ z = T $ ( $ 1 \\leq T \\leq 200000 $ ), the climb is considered successful.\n\nThere are $ N $ ( $ 1 \\leq N \\leq 50000 $ ) stones protruding from the wall, which can be used as footholds. If the distances between two footholds in both the $ x $ direction and the $ z $ direction are no more than $ 2 $, then Bessie can climb from one foothold to the other.\n\nHelp Bessie determine whether she can climb over the wall. If she can, find the minimum number of footholds she needs to step on.", "inputFormat": "The first line contains $ N $ and $ T $.\n\nThe next $ N $ lines each contain the coordinates $ (x,z) $, representing the position of a stone. Here $ x \\leq 10^6 $ and $ z \\leq T $. It is guaranteed that $ (0,0) $ does not appear.", "outputFormat": "If Bessie can climb over the wall, output the minimum number of footholds needed (the starting point is not counted). Otherwise, output $ -1 $.", "hint": "One possible route is: (0,0) -> (1,2) -> (3,2) -> (4,1) -> (6,3).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO04OPEN] Cave Cows 4", "background": "", "description": "一道竖直的石墙横在贝茜前面，她必须越过去。\n\n石墙可以看成一个xz平面，贝茜开始的时候在(0，0)，只要她到达 $ z=T $ \n ( $ 1 \\leq T \\leq 200000 $ )的位置，就算翻越成功。\n\n墙上有 $ N $ ( $ 1 \\leq N \\leq 50000 $ )块石头突出，成为贝茜的落蹄石。如果两个落蹄石之间x方向和z方向的距离均不超过2，那贝茜就可以攀上另一块落蹄石。\n\n帮助贝茜计算她是否能够翻越石墙，如果可以，最少需要踩多少块落蹄石。", "inputFormat": "第1行输入 $ N $ 和 $ T $ 。\n\n接下来 $ N $ 行，每行输入坐标 $ (x,z) $ ，表示一个石头的位置．其中 $ x \\leq 10^6 $ ， $ z \\leq T $ ，保证 $ (0,0) $ 不会出现。", "outputFormat": "如果可以翻越则输出最少需要的落蹄石数（起点不计入），否则输出 $ -1 $ 。", "hint": "一种可行的方案是：(0,0) -> (1,2) -> (3,2) -> (4,1) -> (6,3) 。", "locale": "zh-CN"}}}
{"pid": "P5100", "type": "P", "difficulty": 6, "samples": [["6 5\n1 3 6\n3\n1 1\n0 4\n6 5", "26"], ["3 3\n0 50 10\n2\n0 0\n3 3", "60"], ["4 3\n0 15 10\n2\n0 0\n4 3", "45"], ["4 6\n0 5 1000\n6\n3 1\n4 6\n3 0\n3 0\n4 0\n0 4", "2020"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["图论", "2017", "最短路", "JOI（日本）"], "title": "[JOI 2017 Final] 足球 / Soccer", "background": "", "description": "**题目译自 [JOI 2017 Final](https://www.ioi-jp.org/joi/2016/2017-ho/) T4「[サッカー](https://www.ioi-jp.org/joi/2016/2017-ho/2017-ho.pdf) / [Soccer](https://www.ioi-jp.org/joi/2016/2017-ho/2017-ho-en.pdf)」**\n\n> 「假定球滚动时可以穿过其他球员」这句是在未修改数据的前提下，为了严谨我补上的，原题没有提这一点。如果撞到其他球员就停下的话似乎做法不同？\n\n你是 JOI 联赛中一所声名卓著的足球俱乐部的经理。\n\n俱乐部有 $N$ 名球员，编号为 $1\\ldots N$。球员们每天都刻苦地进行训练，剑指联赛冠军。足球场可视为一个底为 $W$ 米，高 $H$ 米的长方形，底平行于东西方向，高平行于南北方向。如果某个点向北走 $i$ 米，再向西走 $j$ 米恰好到达球场的西北角，这个点可用坐标 $(i, j)$ 来表示。\n\n练习结束后，你要回收练习用的足球。开始回收时，所有球员都在足球场上，球员 $i (1\\leqslant i\\leqslant N)$ 位于 $(S_i, T_i)$，球在球员 $1$ 脚下。你正和球员 $N$ 一起站在 $(S_N, T_N)$，并准备回收球。球员们把球传到 $(S_N, T_N)$ 时，你才会回收球。\n\n你可以指挥球员，但某些操作会提升球员的**疲劳度**。一个球员不能同时进行多项操作。  \n你可以指挥控球的球员进行如下操作：\n* **踢球**。在东西南北四个方向中任选一个，并指定一个正整数 $p$，该球员将球朝指定方向踢出恰好 $p$ 米。**假定球滚动时可以穿过其他球员**。该球员不会移动，且自动停止控球，疲劳度上升 $A\\times p+B$。\n* **运球**。在东西南北四个方向中任选一个，该球员带球，朝指定方向移动 $1$ 米。该球员仍然控球，疲劳度上升 $C$。\n* **停止控球**。该球员的疲劳度不改变。\n\n你可以指挥没有控球的球员进行如下操作：\n* **移动**。在东西南北四个方向中任选一个，该球员朝指定方向移动 $1$ 米，疲劳度上升 $C$。\n* **控球**。如果该球员所在的位置恰好有球，且没有其他球员控球，该球员才能控球。该球员的疲劳度不改变。\n\n球员和球有可能跑出场外，一个位置上可能有多个球员。  \n一天的训练结束后，球员们非常疲惫。你想知道在回收球的过程中，所有球员上升的疲劳度之和的最小值。", "inputFormat": "第一行有两个整数 $H, W$，用空格分隔。  \n第二行有三个整数 $A, B, C$，用空格分隔。  \n第三行有一个整数 $N$。  \n在接下来的 $N$ 行中，第 $i$ 行 $(1\\leqslant i\\leqslant N)$有两个整数 $S_i, T_i$，用空格分隔。  \n输入的所有数的含义见题目描述。", "outputFormat": "一行，一个整数，表示在回收球的过程中，所有球员上升的疲劳度之和的最小值。", "hint": "#### 样例解释 1\n在这组样例中，球场、球员、球处于如图所示的状态。图中，黑框空心圆圈表示球员，实心圆表示球，你在 $(6,5)$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7t23chgu.png)\n\n最优解如下：\n1. 球员 $1$ 把球向东踢出 $3$ 米。疲劳度上升了 $1\\times 3+3=6$，球移动到 $(1,4)$。\n2. 球员 $2$ 向南移动 $1$ 米。疲劳度又上升了 $6$。\n3. 球员 $2$ 开始控球。\n4. 球员 $2$ 向东运球 $1$ 米。疲劳度又上升了 $6$。\n5. 球员 $2$ 把球向南踢出 $5$ 米，疲劳度上升了 $1\\times 5+3=8$，球移动到 $(6,5)$。\n\n此时，疲劳度之和为 $6+6+6+8=26$。没有更好的方案。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x0a9bunu.png)\n\n#### 样例解释 2\n在最优解中，不需要踢球。\n\n#### 样例解释 4\n注意这组样例中有多个球员在同一位置的情况。\n\n#### 数据范围与提示\n对于 $5\\%$ 的数据，$N=2$。  \n对于另外 $30\\%$ 的数据，$N\\leqslant 1000, A=0$。  \n对于所有数据，$1\\leqslant H,W\\leqslant 500, 0\\leqslant A, B, C\\leqslant 10^9, 2\\leqslant N\\leqslant 10^5, 0\\leqslant S_i\\leqslant H, 0\\leqslant T_i\\leqslant W(1\\leqslant i\\leqslant N), (S_1, T_1)\\neq(S_N, T_N)$。", "locale": "zh-CN", "translations": {"en": {"title": "[JOI 2017 Final] Soccer / Soccer", "background": "", "description": "**This problem is translated from [JOI 2017 Final](https://www.ioi-jp.org/joi/2016/2017-ho/) T4「[サッカー](https://www.ioi-jp.org/joi/2016/2017-ho/2017-ho.pdf) / [Soccer](https://www.ioi-jp.org/joi/2016/2017-ho/2017-ho-en.pdf)」.**\n\n> The sentence “Assume that while the ball is rolling it can pass through other players” was added by me for strictness without changing the original testdata. The original statement did not mention this. If the ball stops when it hits other players, the solution seems to be different.\n\nYou are the manager of a famous soccer club in the JOI league.\n\nThe club has $N$ players, numbered $1 \\ldots N$. The players train hard every day, aiming for the league championship. The soccer field can be seen as a rectangle with width $W$ meters and height $H$ meters. The width is parallel to the east-west direction, and the height is parallel to the north-south direction. If from a point you go north $i$ meters and then go west $j$ meters and arrive exactly at the northwest corner of the field, then this point can be represented by coordinates $(i, j)$.\n\nAfter training, you need to collect the practice soccer ball. When you start collecting, all players are on the field. Player $i \\ (1 \\leqslant i \\leqslant N)$ is at $(S_i, T_i)$, and the ball is at the feet of player $1$. You are standing together with player $N$ at $(S_N, T_N)$, ready to collect the ball. You will collect the ball only when the players pass the ball to $(S_N, T_N)$.\n\nYou can give instructions to the players, but some operations will increase a player’s **fatigue**. A player cannot perform multiple operations at the same time.\n\nYou can instruct the player who currently controls the ball to perform the following operations:\n- **Kick**: Choose one of the four directions (east, west, south, north), and specify a positive integer $p$. The player kicks the ball exactly $p$ meters in the chosen direction. **Assume that while the ball is rolling it can pass through other players**. The player does not move, and automatically stops controlling the ball. The player’s fatigue increases by $A \\times p + B$.\n- **Dribble**: Choose one of the four directions (east, west, south, north). The player moves with the ball by $1$ meter in the chosen direction. The player still controls the ball. The player’s fatigue increases by $C$.\n- **Stop controlling the ball**: The player’s fatigue does not change.\n\nYou can instruct a player who does not control the ball to perform the following operations:\n- **Move**: Choose one of the four directions (east, west, south, north). The player moves by $1$ meter in the chosen direction. The player’s fatigue increases by $C$.\n- **Take control of the ball**: The player can take control only if the ball is exactly at the player’s position, and no other player is controlling the ball. The player’s fatigue does not change.\n\nPlayers and the ball may move outside the field, and there may be multiple players at the same position.\n\nAfter a day of training, the players are very tired. You want to know the minimum possible value of the sum of fatigue increases of all players during the process of collecting the ball.", "inputFormat": "The first line contains two integers $H, W$, separated by spaces.  \nThe second line contains three integers $A, B, C$, separated by spaces.  \nThe third line contains one integer $N$.  \nIn the next $N$ lines, line $i \\ (1 \\leqslant i \\leqslant N)$ contains two integers $S_i, T_i$, separated by spaces.  \nThe meanings of all input values are described in the statement.", "outputFormat": "One line with one integer, representing the minimum sum of fatigue increases of all players during the process of collecting the ball.", "hint": "#### Sample Explanation 1\nIn this sample, the field, the players, and the ball are in the state shown in the figure. In the figure, the hollow circles with black outlines represent players, the solid circle represents the ball, and you are at $(6,5)$.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7t23chgu.png)\n\nAn optimal solution is as follows:\n1. Player $1$ kicks the ball $3$ meters to the east. The fatigue increases by $1 \\times 3 + 3 = 6$, and the ball moves to $(1,4)$.\n2. Player $2$ moves $1$ meter to the south. The fatigue increases by another $6$.\n3. Player $2$ starts controlling the ball.\n4. Player $2$ dribbles $1$ meter to the east. The fatigue increases by another $6$.\n5. Player $2$ kicks the ball $5$ meters to the south. The fatigue increases by $1 \\times 5 + 3 = 8$, and the ball moves to $(6,5)$.\n\nAt this point, the total fatigue increase is $6 + 6 + 6 + 8 = 26$. There is no better plan.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x0a9bunu.png)\n\n#### Sample Explanation 2\nIn the optimal solution, kicking is not necessary.\n\n#### Sample Explanation 4\nNote that in this sample there are multiple players at the same position.\n\n#### Constraints and Hints\nFor $5\\%$ of the data, $N = 2$.  \nFor another $30\\%$ of the data, $N \\leqslant 1000$ and $A = 0$.  \nFor all data, $1 \\leqslant H, W \\leqslant 500$, $0 \\leqslant A, B, C \\leqslant 10^9$, $2 \\leqslant N \\leqslant 10^5$, $0 \\leqslant S_i \\leqslant H$, $0 \\leqslant T_i \\leqslant W \\ (1 \\leqslant i \\leqslant N)$, $(S_1, T_1) \\neq (S_N, T_N)$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JOI 2017 Final] 足球 / Soccer", "background": "", "description": "**题目译自 [JOI 2017 Final](https://www.ioi-jp.org/joi/2016/2017-ho/) T4「[サッカー](https://www.ioi-jp.org/joi/2016/2017-ho/2017-ho.pdf) / [Soccer](https://www.ioi-jp.org/joi/2016/2017-ho/2017-ho-en.pdf)」**\n\n> 「假定球滚动时可以穿过其他球员」这句是在未修改数据的前提下，为了严谨我补上的，原题没有提这一点。如果撞到其他球员就停下的话似乎做法不同？\n\n你是 JOI 联赛中一所声名卓著的足球俱乐部的经理。\n\n俱乐部有 $N$ 名球员，编号为 $1\\ldots N$。球员们每天都刻苦地进行训练，剑指联赛冠军。足球场可视为一个底为 $W$ 米，高 $H$ 米的长方形，底平行于东西方向，高平行于南北方向。如果某个点向北走 $i$ 米，再向西走 $j$ 米恰好到达球场的西北角，这个点可用坐标 $(i, j)$ 来表示。\n\n练习结束后，你要回收练习用的足球。开始回收时，所有球员都在足球场上，球员 $i (1\\leqslant i\\leqslant N)$ 位于 $(S_i, T_i)$，球在球员 $1$ 脚下。你正和球员 $N$ 一起站在 $(S_N, T_N)$，并准备回收球。球员们把球传到 $(S_N, T_N)$ 时，你才会回收球。\n\n你可以指挥球员，但某些操作会提升球员的**疲劳度**。一个球员不能同时进行多项操作。  \n你可以指挥控球的球员进行如下操作：\n* **踢球**。在东西南北四个方向中任选一个，并指定一个正整数 $p$，该球员将球朝指定方向踢出恰好 $p$ 米。**假定球滚动时可以穿过其他球员**。该球员不会移动，且自动停止控球，疲劳度上升 $A\\times p+B$。\n* **运球**。在东西南北四个方向中任选一个，该球员带球，朝指定方向移动 $1$ 米。该球员仍然控球，疲劳度上升 $C$。\n* **停止控球**。该球员的疲劳度不改变。\n\n你可以指挥没有控球的球员进行如下操作：\n* **移动**。在东西南北四个方向中任选一个，该球员朝指定方向移动 $1$ 米，疲劳度上升 $C$。\n* **控球**。如果该球员所在的位置恰好有球，且没有其他球员控球，该球员才能控球。该球员的疲劳度不改变。\n\n球员和球有可能跑出场外，一个位置上可能有多个球员。  \n一天的训练结束后，球员们非常疲惫。你想知道在回收球的过程中，所有球员上升的疲劳度之和的最小值。", "inputFormat": "第一行有两个整数 $H, W$，用空格分隔。  \n第二行有三个整数 $A, B, C$，用空格分隔。  \n第三行有一个整数 $N$。  \n在接下来的 $N$ 行中，第 $i$ 行 $(1\\leqslant i\\leqslant N)$有两个整数 $S_i, T_i$，用空格分隔。  \n输入的所有数的含义见题目描述。", "outputFormat": "一行，一个整数，表示在回收球的过程中，所有球员上升的疲劳度之和的最小值。", "hint": "#### 样例解释 1\n在这组样例中，球场、球员、球处于如图所示的状态。图中，黑框空心圆圈表示球员，实心圆表示球，你在 $(6,5)$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7t23chgu.png)\n\n最优解如下：\n1. 球员 $1$ 把球向东踢出 $3$ 米。疲劳度上升了 $1\\times 3+3=6$，球移动到 $(1,4)$。\n2. 球员 $2$ 向南移动 $1$ 米。疲劳度又上升了 $6$。\n3. 球员 $2$ 开始控球。\n4. 球员 $2$ 向东运球 $1$ 米。疲劳度又上升了 $6$。\n5. 球员 $2$ 把球向南踢出 $5$ 米，疲劳度上升了 $1\\times 5+3=8$，球移动到 $(6,5)$。\n\n此时，疲劳度之和为 $6+6+6+8=26$。没有更好的方案。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x0a9bunu.png)\n\n#### 样例解释 2\n在最优解中，不需要踢球。\n\n#### 样例解释 4\n注意这组样例中有多个球员在同一位置的情况。\n\n#### 数据范围与提示\n对于 $5\\%$ 的数据，$N=2$。  \n对于另外 $30\\%$ 的数据，$N\\leqslant 1000, A=0$。  \n对于所有数据，$1\\leqslant H,W\\leqslant 500, 0\\leqslant A, B, C\\leqslant 10^9, 2\\leqslant N\\leqslant 10^5, 0\\leqslant S_i\\leqslant H, 0\\leqslant T_i\\leqslant W(1\\leqslant i\\leqslant N), (S_1, T_1)\\neq(S_N, T_N)$。", "locale": "zh-CN"}}}
{"pid": "P5101", "type": "P", "difficulty": 7, "samples": [["5 3\n1 2 3 3 2", "2\n1\n1"], ["7 3\n1 2 2 1 3 3 3", "2\n2\n2"], ["10 3\n2 2 1 1 3 3 2 1 1 2", "3\n3\n4"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["贪心", "2017", "JOI（日本）", "Ad-hoc"], "title": "[JOI 2017 Final] 绳 / Rope", "background": "", "description": "**题目译自 [JOI 2017 Final](https://www.ioi-jp.org/joi/2016/2017-ho/) T5「[縄](https://www.ioi-jp.org/joi/2016/2017-ho/2017-ho.pdf) / [Rope](https://www.ioi-jp.org/joi/2016/2017-ho/2017-ho-en.pdf)」**\n\n JOI 小宝宝正拿着一根绳子玩。绳子可视为一条长度为 $N$ 的左右延伸的线段。绳子由 $N$ 根线连接而成，每根线的长度为 $1$，厚度为 $1$。绳子上的线共有 $M$ 种颜色，左数第 $i$ 根线 $(1\\leqslant i\\leqslant N)$ 的颜色为 $C_i(1\\leqslant C_i\\leqslant M)$。**绳子的左端点**意为左数第 $1$ 根线的左端点，**绳子的右端点**意为右数第 $1$ 根线的右端点。显然左数第 $i$ 根线 $(1\\leqslant i\\leqslant N)$ 的右端点 到 绳子的左端点 的距离为 $i$。\n\nJOI 把绳子的长度缩短了。具体来说，JOI 反复地进行以下过程，直到绳长缩短至 $2$。\n\n* 假设此时绳子的长度为 $L$。指定一个整数 $j(1\\leqslant j<L)$，使绳子左数第 $j$ 根线成为绳子的左端点（最左的线），并折叠绳子。也就是说，\n  - 如果 $j\\leqslant \\Large\\frac{L}{2}$，则将左数第 $i$ 根线 $(1\\leqslant i\\leqslant j)$ 与左数第 $(2j-i+1)$ 根线拧成一股。此时，绳子原本的右端点仍是右端点，绳长变为 $L-j$。\n  - 如果 $j> \\Large\\frac{L}{2}$，则将左数第 $i$ 根线 $(2j-L+1\\leqslant i\\leqslant j)$ 与左数第 $(2j-i+1)$ 根线拧成一股。此时，绳子原本的左端点变为右端点，绳长变为 $j$。\n* 两条线的颜色相同才能拧成一股。在将两条线拧成一股前，可以任意改变线的颜色。将线染成其他颜色所需的费用 等于 线的厚度。颜色匹配后，两条线将被拧成一股，新的一股线的厚度 将为 两条线的厚度之和。\n\n我们把绳长缩短至 $2$ 的绳子称为最终的绳子。JOI 希望使得将绳长缩短至 $2$ 所需的费用尽可能小。对于每种颜色，JOI 都想知道，在最终的绳子中包含这种颜色的情况下，将绳长缩短至 $2$ 所需的最小费用。\n\n你的任务是帮 JOI 解决这个问题。", "inputFormat": "第一行有两个整数 $N, M$，用空格分隔。  \n第二行有 $N$ 个用空格分隔的整数 $C_1, C_2, \\ldots, C_N$。  \n输入的所有数的含义见题目描述。", "outputFormat": "共 $M$ 行，第 $c$ 行 $(1\\leqslant c\\leqslant M)$ 有一个整数，表示在最终的绳子中包含颜色 $c$ 的情况下，将绳长缩短至 $2$ 所需的最小费用。", "hint": "#### 样例解释 1\n通过下述步骤，只需花费 $2$，就可以使得最终的绳子中包含颜色 $1$。\n* 把左数第 $2$ 根线染成颜色 $1$。折叠绳子使得 原本到左端点的距离为 $1$ 的端点 变为 新的左端点。现在，从左往右数，线的颜色依次是 $1,$ $ 3,$ $ 3,$ $ 2$，厚度依次是 $2,$ $ 1,$ $ 1,$ $ 1$。\n* 把左数第 $4$ 根线染成颜色 $1$。折叠绳子使得 原本到左端点的距离为 $2$ 的端点 变为 新的左端点。现在，从左往右数，线的颜色依次是 $3, 1$，厚度依次是 $2, 3$。\n\n通过下述步骤，只需花费 $1$，就可以使得最终的绳子中包含颜色 $2$ 和 $3$。\n* 折叠绳子使得 原本到左端点的距离为 $3$ 的端点 变为 新的左端点。现在，从左往右数，线的颜色依次是 $3,$ $ 2,$ $ 1$，厚度依次是 $2,$ $ 2,$ $ 1$。\n* 把左数第 $3$ 根线染成颜色 $2$。折叠绳子使得 原本到左端点的距离为 $2$ 的端点 变为 新的左端点。现在，从左往右数，线的颜色依次是 $2, 3$，厚度依次是 $3, 2$。\n\n#### 样例解释 2\n通过下述步骤，只需花费 $2$，就可以使得最终的绳子中包含颜色 $1$。\n* 折叠绳子使得 原本到左端点的距离为 $2$ 的端点 变为 新的左端点。\n* 把左数第 $1$ 根线染成颜色 $1$。折叠绳子使得 原本到左端点的距离为 $1$ 的端点 变为 新的左端点。注意这次染色的费用为 $2$，因为此时左数第 $1$ 根线的厚度为 $2$。\n* 折叠绳子使得 原本到左端点的距离为 $3$ 的端点 变为 新的左端点。\n* 折叠绳子使得 原本到左端点的距离为 $1$ 的端点 变为 新的左端点。\n\n#### 数据范围与提示\n对于 $15\\%$ 的数据，$N\\leqslant 15, M\\leqslant 10$。  \n对于另外 $30\\%$ 的数据，$N\\leqslant 10^5, M\\leqslant 10$。  \n对于另外 $10\\%$ 的数据，$N\\leqslant 10^5, M\\leqslant 500$。  \n对于另外 $20\\%$ 的数据，$N\\leqslant 10^5, M\\leqslant 5000$。  \n对于所有数据，$2\\leqslant N\\leqslant 10^6, 1\\leqslant M\\leqslant N, 1\\leqslant C_i\\leqslant M(1\\leqslant i\\leqslant N)$，在初始状态的绳子上，颜色 $1, 2, \\ldots, M$ 都至少出现了一次。", "locale": "zh-CN", "translations": {"en": {"title": "[JOI 2017 Final] Rope / Rope", "background": "", "description": "**This problem is translated from [JOI 2017 Final](https://www.ioi-jp.org/joi/2016/2017-ho/) T5 「[縄](https://www.ioi-jp.org/joi/2016/2017-ho/2017-ho.pdf) / [Rope](https://www.ioi-jp.org/joi/2016/2017-ho/2017-ho-en.pdf)」.**\n\nJOI is playing with a rope. The rope can be regarded as a line segment extending left and right with length $N$. The rope is made by connecting $N$ pieces of string. Each piece has length $1$ and thickness $1$. There are $M$ colors on the rope. The color of the $i$-th piece from the left $(1\\leqslant i\\leqslant N)$ is $C_i(1\\leqslant C_i\\leqslant M)$. The **left endpoint of the rope** means the left endpoint of the $1$-st piece from the left, and the **right endpoint of the rope** means the right endpoint of the $1$-st piece from the right. Clearly, the distance from the right endpoint of the $i$-th piece from the left $(1\\leqslant i\\leqslant N)$ to the left endpoint of the rope is $i$.\n\nJOI shortened the rope. More precisely, JOI repeatedly performs the following process until the rope length becomes $2$.\n\n- Suppose the current rope length is $L$. Choose an integer $j(1\\leqslant j<L)$, make the $j$-th piece from the left become the left endpoint of the rope (the leftmost piece), and fold the rope. That is,\n  - If $j\\leqslant \\Large\\frac{L}{2}$, then twist the $i$-th piece from the left $(1\\leqslant i\\leqslant j)$ together with the $(2j-i+1)$-th piece from the left. In this case, the original right endpoint of the rope remains the right endpoint, and the rope length becomes $L-j$.\n  - If $j> \\Large\\frac{L}{2}$, then twist the $i$-th piece from the left $(2j-L+1\\leqslant i\\leqslant j)$ together with the $(2j-i+1)$-th piece from the left. In this case, the original left endpoint of the rope becomes the right endpoint, and the rope length becomes $j$.\n- Two pieces can be twisted together only if they have the same color. Before twisting two pieces together, you may change their colors arbitrarily. The cost to dye a piece into another color is equal to the thickness of that piece. After the colors match, the two pieces are twisted into one, and the thickness of the new piece becomes the sum of the thicknesses of the two pieces.\n\nWe call the rope of length $2$ obtained after shortening the **final rope**. JOI wants to minimize the total cost required to shorten the rope to length $2$. For each color, JOI wants to know the minimum cost required to shorten the rope to length $2$ under the condition that the final rope contains this color.\n\nYour task is to help JOI solve this problem.", "inputFormat": "The first line contains two integers $N, M$, separated by spaces.  \nThe second line contains $N$ integers $C_1, C_2, \\ldots, C_N$, separated by spaces.  \nThe meanings of all numbers are given in the statement.", "outputFormat": "Output $M$ lines. The $c$-th line $(1\\leqslant c\\leqslant M)$ contains one integer, representing the minimum cost required to shorten the rope to length $2$ under the condition that the final rope contains color $c$.", "hint": "#### Sample Explanation 1\n\nWith the following steps, you can make the final rope contain color $1$ with total cost $2$.\n\n- Dye the $2$-nd piece from the left into color $1$. Fold the rope so that the endpoint that was originally at distance $1$ from the left endpoint becomes the new left endpoint. Now, from left to right, the colors are $1,$ $3,$ $3,$ $2$, and the thicknesses are $2,$ $1,$ $1,$ $1$.\n- Dye the $4$-th piece from the left into color $1$. Fold the rope so that the endpoint that was originally at distance $2$ from the left endpoint becomes the new left endpoint. Now, from left to right, the colors are $3, 1$, and the thicknesses are $2, 3$.\n\nWith the following steps, you can make the final rope contain colors $2$ and $3$ with total cost $1$.\n\n- Fold the rope so that the endpoint that was originally at distance $3$ from the left endpoint becomes the new left endpoint. Now, from left to right, the colors are $3,$ $2,$ $1$, and the thicknesses are $2,$ $2,$ $1$.\n- Dye the $3$-rd piece from the left into color $2$. Fold the rope so that the endpoint that was originally at distance $2$ from the left endpoint becomes the new left endpoint. Now, from left to right, the colors are $2, 3$, and the thicknesses are $3, 2$.\n\n#### Sample Explanation 2\n\nWith the following steps, you can make the final rope contain color $1$ with total cost $2$.\n\n- Fold the rope so that the endpoint that was originally at distance $2$ from the left endpoint becomes the new left endpoint.\n- Dye the $1$-st piece from the left into color $1$. Fold the rope so that the endpoint that was originally at distance $1$ from the left endpoint becomes the new left endpoint. Note that the cost of this dyeing is $2$, because at this time the thickness of the $1$-st piece from the left is $2$.\n- Fold the rope so that the endpoint that was originally at distance $3$ from the left endpoint becomes the new left endpoint.\n- Fold the rope so that the endpoint that was originally at distance $1$ from the left endpoint becomes the new left endpoint.\n\n#### Constraints and Hints\n\nFor $15\\%$ of the testdata, $N\\leqslant 15, M\\leqslant 10$.  \nFor another $30\\%$ of the testdata, $N\\leqslant 10^5, M\\leqslant 10$.  \nFor another $10\\%$ of the testdata, $N\\leqslant 10^5, M\\leqslant 500$.  \nFor another $20\\%$ of the testdata, $N\\leqslant 10^5, M\\leqslant 5000$.  \nFor all testdata, $2\\leqslant N\\leqslant 10^6, 1\\leqslant M\\leqslant N, 1\\leqslant C_i\\leqslant M(1\\leqslant i\\leqslant N)$, and in the initial rope, each color $1, 2, \\ldots, M$ appears at least once.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JOI 2017 Final] 绳 / Rope", "background": "", "description": "**题目译自 [JOI 2017 Final](https://www.ioi-jp.org/joi/2016/2017-ho/) T5「[縄](https://www.ioi-jp.org/joi/2016/2017-ho/2017-ho.pdf) / [Rope](https://www.ioi-jp.org/joi/2016/2017-ho/2017-ho-en.pdf)」**\n\n JOI 小宝宝正拿着一根绳子玩。绳子可视为一条长度为 $N$ 的左右延伸的线段。绳子由 $N$ 根线连接而成，每根线的长度为 $1$，厚度为 $1$。绳子上的线共有 $M$ 种颜色，左数第 $i$ 根线 $(1\\leqslant i\\leqslant N)$ 的颜色为 $C_i(1\\leqslant C_i\\leqslant M)$。**绳子的左端点**意为左数第 $1$ 根线的左端点，**绳子的右端点**意为右数第 $1$ 根线的右端点。显然左数第 $i$ 根线 $(1\\leqslant i\\leqslant N)$ 的右端点 到 绳子的左端点 的距离为 $i$。\n\nJOI 把绳子的长度缩短了。具体来说，JOI 反复地进行以下过程，直到绳长缩短至 $2$。\n\n* 假设此时绳子的长度为 $L$。指定一个整数 $j(1\\leqslant j<L)$，使绳子左数第 $j$ 根线成为绳子的左端点（最左的线），并折叠绳子。也就是说，\n  - 如果 $j\\leqslant \\Large\\frac{L}{2}$，则将左数第 $i$ 根线 $(1\\leqslant i\\leqslant j)$ 与左数第 $(2j-i+1)$ 根线拧成一股。此时，绳子原本的右端点仍是右端点，绳长变为 $L-j$。\n  - 如果 $j> \\Large\\frac{L}{2}$，则将左数第 $i$ 根线 $(2j-L+1\\leqslant i\\leqslant j)$ 与左数第 $(2j-i+1)$ 根线拧成一股。此时，绳子原本的左端点变为右端点，绳长变为 $j$。\n* 两条线的颜色相同才能拧成一股。在将两条线拧成一股前，可以任意改变线的颜色。将线染成其他颜色所需的费用 等于 线的厚度。颜色匹配后，两条线将被拧成一股，新的一股线的厚度 将为 两条线的厚度之和。\n\n我们把绳长缩短至 $2$ 的绳子称为最终的绳子。JOI 希望使得将绳长缩短至 $2$ 所需的费用尽可能小。对于每种颜色，JOI 都想知道，在最终的绳子中包含这种颜色的情况下，将绳长缩短至 $2$ 所需的最小费用。\n\n你的任务是帮 JOI 解决这个问题。", "inputFormat": "第一行有两个整数 $N, M$，用空格分隔。  \n第二行有 $N$ 个用空格分隔的整数 $C_1, C_2, \\ldots, C_N$。  \n输入的所有数的含义见题目描述。", "outputFormat": "共 $M$ 行，第 $c$ 行 $(1\\leqslant c\\leqslant M)$ 有一个整数，表示在最终的绳子中包含颜色 $c$ 的情况下，将绳长缩短至 $2$ 所需的最小费用。", "hint": "#### 样例解释 1\n通过下述步骤，只需花费 $2$，就可以使得最终的绳子中包含颜色 $1$。\n* 把左数第 $2$ 根线染成颜色 $1$。折叠绳子使得 原本到左端点的距离为 $1$ 的端点 变为 新的左端点。现在，从左往右数，线的颜色依次是 $1,$ $ 3,$ $ 3,$ $ 2$，厚度依次是 $2,$ $ 1,$ $ 1,$ $ 1$。\n* 把左数第 $4$ 根线染成颜色 $1$。折叠绳子使得 原本到左端点的距离为 $2$ 的端点 变为 新的左端点。现在，从左往右数，线的颜色依次是 $3, 1$，厚度依次是 $2, 3$。\n\n通过下述步骤，只需花费 $1$，就可以使得最终的绳子中包含颜色 $2$ 和 $3$。\n* 折叠绳子使得 原本到左端点的距离为 $3$ 的端点 变为 新的左端点。现在，从左往右数，线的颜色依次是 $3,$ $ 2,$ $ 1$，厚度依次是 $2,$ $ 2,$ $ 1$。\n* 把左数第 $3$ 根线染成颜色 $2$。折叠绳子使得 原本到左端点的距离为 $2$ 的端点 变为 新的左端点。现在，从左往右数，线的颜色依次是 $2, 3$，厚度依次是 $3, 2$。\n\n#### 样例解释 2\n通过下述步骤，只需花费 $2$，就可以使得最终的绳子中包含颜色 $1$。\n* 折叠绳子使得 原本到左端点的距离为 $2$ 的端点 变为 新的左端点。\n* 把左数第 $1$ 根线染成颜色 $1$。折叠绳子使得 原本到左端点的距离为 $1$ 的端点 变为 新的左端点。注意这次染色的费用为 $2$，因为此时左数第 $1$ 根线的厚度为 $2$。\n* 折叠绳子使得 原本到左端点的距离为 $3$ 的端点 变为 新的左端点。\n* 折叠绳子使得 原本到左端点的距离为 $1$ 的端点 变为 新的左端点。\n\n#### 数据范围与提示\n对于 $15\\%$ 的数据，$N\\leqslant 15, M\\leqslant 10$。  \n对于另外 $30\\%$ 的数据，$N\\leqslant 10^5, M\\leqslant 10$。  \n对于另外 $10\\%$ 的数据，$N\\leqslant 10^5, M\\leqslant 500$。  \n对于另外 $20\\%$ 的数据，$N\\leqslant 10^5, M\\leqslant 5000$。  \n对于所有数据，$2\\leqslant N\\leqslant 10^6, 1\\leqslant M\\leqslant N, 1\\leqslant C_i\\leqslant M(1\\leqslant i\\leqslant N)$，在初始状态的绳子上，颜色 $1, 2, \\ldots, M$ 都至少出现了一次。", "locale": "zh-CN"}}}
{"pid": "P5102", "type": "P", "difficulty": 7, "samples": [["12 1\nEENWSEEESWWS", "3"], ["12 2\nEENWSEEESWWS", "7"], ["7 1\nENNWNNE", "0"], ["16 5\nWSESSSWWWEEENNNW", "21"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2016", "JOI（日本）"], "title": "[JOI 2016 Final] 领地 / Territory", "background": "", "description": "**本题译自 [JOI 2016 Final](https://www.ioi-jp.org/joi/2015/2016-ho/index.html) T4「[縄張り](https://www.ioi-jp.org/joi/2015/2016-ho/2016-ho.pdf)」**\n\n有一个平面直角坐标系。JOI 君位于 $(0, 0)$ 。  \nJOI 君**每天**都按照一个固定的程序移动一轮。该程序有 $N$ 个步骤，用一个长度为 $N$ 的字符串 $S$ 描述。这个字符串仅由大写字母 $\\texttt{E, N, W, S}$ 构成。  \n左数第 $i$ 个字符 $C_i (1\\leqslant i\\leqslant N)$ 表示 JOI 君会移动到哪里。如果在执行步骤 $i$ 前，JOI 君位于 $(x, y)$：\n* $C_i=\\texttt{E}$：JOI 君将移动到 $(x+1,y)$；\n* $C_i=\\texttt{N}$：JOI 君将移动到 $(x,y+1)$；\n* $C_i=\\texttt{W}$：JOI 君将移动到 $(x-1,y)$；\n* $C_i=\\texttt{S}$：JOI 君将移动到 $(x,y-1)$。\n\n次日 JOI 君会从他前一天停止的位置开始执行程序。  \nJOI 君会把 $(0, 0)$ 以及每个步骤结束后到达的点作标记。开始时 JOI 君没有标记任何点。$K$ 天后，对于任意整数 $a, b$，如果 $(a,b),$ $(a+1,b),$ $(a,b+1),$ $(a+1,b+1)$ 这四个点都被标记了一次或以上，以这四个点为顶点的 $1\\times 1$ 的正方形就属于 JOI 君的领地。  \n请问 $K$ 天后，JOI 君有多少个领地。", "inputFormat": "第一行有两个整数 $N, K$，用空格分隔。  \n第二行有一个字符串 $S$，表示 JOI 君移动的程序。", "outputFormat": "一个整数，表示 JOI 君有多少个领地。", "hint": "#### 样例解释 1\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5h9x63g9.png)\n\n> 图中的字是之前完整题面的，懒得改了。「市政厅」表示 $(0, 0)$，「散步路径」表示移动路线。  \n> 图我没有仔细 PS 过，可能对不齐、不对称，强迫症的同学们麻烦忍一忍\n\n#### 样例解释 2\n样例 2 与样例 1 的不同在于在样例 2 中 JOI 君走了两天。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/26nj2fc2.png)\n\n#### 数据范围与提示\n对于所有数据，$1\\leqslant N\\leqslant 10^5, 1\\leqslant K\\leqslant 10^9$。\n\n|Subtask #|特殊限制|分值|\n|-|-|-|\n|1|$N\\leqslant 50, K = 1$|5|\n|2|$K = 1$|10|\n|3|$N\\leqslant 50$|23|\n|4|无|62|", "locale": "zh-CN", "translations": {"en": {"title": "[JOI 2016 Final] Territory / Territory", "background": "", "description": "**This problem is translated from [JOI 2016 Final](https://www.ioi-jp.org/joi/2015/2016-ho/index.html) T4 “[縄張り](https://www.ioi-jp.org/joi/2015/2016-ho/2016-ho.pdf)”.**\n\nThere is a Cartesian coordinate plane. JOI is at $(0, 0)$.  \nEvery day, JOI follows a fixed procedure and makes one round of moves. The procedure has $N$ steps and is described by a string $S$ of length $N$. This string consists only of the uppercase letters $\\texttt{E, N, W, S}$.  \nThe $i$-th character from the left, $C_i\\ (1\\leqslant i\\leqslant N)$, indicates where JOI will move. If before executing step $i$, JOI is at $(x, y)$:\n\n* If $C_i=\\texttt{E}$, JOI moves to $(x+1,y)$.\n* If $C_i=\\texttt{N}$, JOI moves to $(x,y+1)$.\n* If $C_i=\\texttt{W}$, JOI moves to $(x-1,y)$.\n* If $C_i=\\texttt{S}$, JOI moves to $(x,y-1)$.\n\nOn the next day, JOI starts executing the procedure from where he stopped the previous day.  \nJOI marks $(0, 0)$ and every point he reaches after finishing each step. At the beginning, JOI has not marked any points. After $K$ days, for any integers $a, b$, if the four points $(a,b)$, $(a+1,b)$, $(a,b+1)$, $(a+1,b+1)$ have each been marked at least once, then the $1\\times 1$ square with these four points as vertices belongs to JOI’s territory.  \nFind how many territories JOI has after $K$ days.", "inputFormat": "The first line contains two integers $N, K$, separated by spaces.  \nThe second line contains a string $S$, representing JOI’s movement procedure.", "outputFormat": "Output one integer, the number of territories JOI has.", "hint": "#### Sample Explanation 1\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5h9x63g9.png)\n\n> The text in the figure is from the previous full statement, and I was too lazy to modify it. “市政厅” means $(0, 0)$, and “散步路径” means the movement path.  \n> I did not carefully edit the image, so it may be misaligned or not symmetric. Please bear with it.\n\n#### Sample Explanation 2\n\nThe difference between Sample 2 and Sample 1 is that in Sample 2, JOI walked for two days.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/26nj2fc2.png)\n\n#### Constraints and Hints\n\nFor all testdata, $1\\leqslant N\\leqslant 10^5$, $1\\leqslant K\\leqslant 10^9$.\n\n|Subtask #|Special Constraints|Points|\n|-|-|-|\n|1|$N\\leqslant 50, K = 1$|5|\n|2|$K = 1$|10|\n|3|$N\\leqslant 50$|23|\n|4|None|62|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JOI 2016 Final] 领地 / Territory", "background": "", "description": "**本题译自 [JOI 2016 Final](https://www.ioi-jp.org/joi/2015/2016-ho/index.html) T4「[縄張り](https://www.ioi-jp.org/joi/2015/2016-ho/2016-ho.pdf)」**\n\n有一个平面直角坐标系。JOI 君位于 $(0, 0)$ 。  \nJOI 君**每天**都按照一个固定的程序移动一轮。该程序有 $N$ 个步骤，用一个长度为 $N$ 的字符串 $S$ 描述。这个字符串仅由大写字母 $\\texttt{E, N, W, S}$ 构成。  \n左数第 $i$ 个字符 $C_i (1\\leqslant i\\leqslant N)$ 表示 JOI 君会移动到哪里。如果在执行步骤 $i$ 前，JOI 君位于 $(x, y)$：\n* $C_i=\\texttt{E}$：JOI 君将移动到 $(x+1,y)$；\n* $C_i=\\texttt{N}$：JOI 君将移动到 $(x,y+1)$；\n* $C_i=\\texttt{W}$：JOI 君将移动到 $(x-1,y)$；\n* $C_i=\\texttt{S}$：JOI 君将移动到 $(x,y-1)$。\n\n次日 JOI 君会从他前一天停止的位置开始执行程序。  \nJOI 君会把 $(0, 0)$ 以及每个步骤结束后到达的点作标记。开始时 JOI 君没有标记任何点。$K$ 天后，对于任意整数 $a, b$，如果 $(a,b),$ $(a+1,b),$ $(a,b+1),$ $(a+1,b+1)$ 这四个点都被标记了一次或以上，以这四个点为顶点的 $1\\times 1$ 的正方形就属于 JOI 君的领地。  \n请问 $K$ 天后，JOI 君有多少个领地。", "inputFormat": "第一行有两个整数 $N, K$，用空格分隔。  \n第二行有一个字符串 $S$，表示 JOI 君移动的程序。", "outputFormat": "一个整数，表示 JOI 君有多少个领地。", "hint": "#### 样例解释 1\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5h9x63g9.png)\n\n> 图中的字是之前完整题面的，懒得改了。「市政厅」表示 $(0, 0)$，「散步路径」表示移动路线。  \n> 图我没有仔细 PS 过，可能对不齐、不对称，强迫症的同学们麻烦忍一忍\n\n#### 样例解释 2\n样例 2 与样例 1 的不同在于在样例 2 中 JOI 君走了两天。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/26nj2fc2.png)\n\n#### 数据范围与提示\n对于所有数据，$1\\leqslant N\\leqslant 10^5, 1\\leqslant K\\leqslant 10^9$。\n\n|Subtask #|特殊限制|分值|\n|-|-|-|\n|1|$N\\leqslant 50, K = 1$|5|\n|2|$K = 1$|10|\n|3|$N\\leqslant 50$|23|\n|4|无|62|", "locale": "zh-CN"}}}
{"pid": "P5103", "type": "P", "difficulty": 7, "samples": [["10 2\n12 1 3\n2 2 2", "3\n3\n5\n5\n5\n5\n5\n5\n2\n2"], ["10 6\n14 1 1\n17 1 1\n-6 2 1\n3 2 1\n4 1 1\n0 2 1", "5\n5\n4\n5\n5\n5\n5\n5\n4\n4"], ["15 10\n28 1 7\n-24 2 1\n1 1 1\n8 1 1\n6 2 1\n20 1 3\n12 2 2\n-10 1 3\n7 2 1\n5 1 2", "15\n14\n14\n14\n14\n12\n12\n12\n12\n12\n12\n12\n15\n15\n12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2016", "JOI（日本）"], "title": "[JOI 2016 Final] 断层 / Geologic Fault", "background": "", "description": "**译者水平有限，跪求各位大佬提供更好的译文**\n\n**本题译自 [JOI 2016 Final](https://www.ioi-jp.org/joi/2015/2016-ho/index.html) T5「[断層](https://www.ioi-jp.org/joi/2015/2016-ho/2016-ho.pdf)」**\n\n很久很久以前，一个叫做 IOI 的先进文明蓬勃发展。时过境迁，现代考古学家 JOI 博士决定挖掘 IOI 文明遗址。\n\nIOI 文明沿着笔直的河流发展。方便起见，IOI 文明遗址可以看作平面直角坐标系的 $x$ 轴，而 $y$ 轴表示海拔。IOI 文明地面平坦，也就是说，直线 $y=0$ 代表地面，而 $y>0$ 代表地面上空，$y<0$ 代表地下。另外，由于流水堆积，IOI 文明的地面一直在缓慢升高。IOI 文明灭亡前 $a$ 年 $(a\\geqslant 0)$ 时，直线 $y=-a$ 才是地平面。  \nIOI 文明灭亡后，它脚下的地层发生了 $Q$ 次运动。第 $i$ 次运动 $(1\\leqslant i\\leqslant Q)$ 可用位置 $X_i$，方向 $D_i$ 和变化量 $L_i$ 描述。$D_i = 1$ 或 $2$。具体来说，\n\n* $D_i=1$：断层视为一条过 $(X_i, 0)$，斜率为 $1$ 的直线。断层上方的地层斜向上移动，横坐标增加 $L_i$，纵坐标增加 $L_i$。也就是说，直线上方的所有点 $(x,y)$ 移动到 $(x+L_i, y+L_i)$。\n* $D_i=2$：断层视为一条过 $(X_i, 0)$，斜率为 $-1$ 的直线。断层上方的地层斜向上移动，横坐标减少 $L_i$，纵坐标增加 $L_i$。也就是说，直线上方的所有点 $(x,y)$ 移动到 $(x-L_i, y+L_i)$。\n\n每次地壳运动后，$y>0$ 的地层都会因风化作用而消失。\n\n试求：对于每一个 $i(1\\leqslant i\\leqslant N)$，**点 $(i-1,0)$ 和 点$(i,0)$ 之间的地层**是在 IOI 文明灭亡前哪一年的地层。 \n\n> 在 $y$ 轴上，断层都是经过整点的，$y$ 轴上的相邻整点间没有断层。这样讲能明白吧……\n", "inputFormat": "第一行有两个整数 $N,Q$，用空格分隔。  \n在接下来的 $Q$ 行中，第 $i$ 行 $(1\\leqslant i\\leqslant N)$ 有三个整数 $X_i, D_i, L_i$，用空格分隔。  \n输入的所有数的含义见题目描述。", "outputFormat": "输出共 $N$ 行，第 $i$ 行 $(1\\leqslant i\\leqslant N)$ 有一个整数，表示点 $(i-1,0)$ 和 点$(i,0)$ 之间的地层是在 IOI 文明灭亡前哪一年的地层。 ", "hint": "#### 样例解释 1\n![](https://cdn.luogu.com.cn/upload/image_hosting/uxq94hp7.png)\n\n#### 数据范围与提示\n对于所有数据，$1\\leqslant N, Q\\leqslant 2\\times 10^5, -10^9\\leqslant X_i\\leqslant 10^9, D_i=1$ 或 $2, 1\\leqslant L_i\\leqslant 10^9(1\\leqslant i\\leqslant Q)$。\n\n|Subtask #|$N,Q$|其他限制|分值|\n|-|-|-|-|\n|1|$N,Q\\leqslant 100$|$-100\\leqslant X_i\\leqslant 100, L_i=1(1\\leqslant i\\leqslant Q)$|18|\n|2|$N,Q\\leqslant 3000$|无|16|\n|3|$N,Q\\leqslant 2\\times10^5$|无|66|", "locale": "zh-CN", "translations": {"en": {"title": "[JOI 2016 Final] Fault / Geologic Fault", "background": "", "description": "**The translator’s ability is limited; I sincerely ask everyone to provide a better translation.**\n\n**This problem is translated from [JOI 2016 Final](https://www.ioi-jp.org/joi/2015/2016-ho/index.html) T5 “[断層](https://www.ioi-jp.org/joi/2015/2016-ho/2016-ho.pdf)”.**\n\nA very long time ago, an advanced civilization called IOI flourished. As time passed, the modern archaeologist Dr. JOI decided to excavate the ruins of the IOI civilization.\n\nThe IOI civilization developed along a straight river. For convenience, the ruins of the IOI civilization can be regarded as the $x$ axis of the Cartesian coordinate plane, and the $y$ axis represents altitude. The ground surface of the IOI civilization is flat; that is, the line $y=0$ represents the ground, $y>0$ is above the ground, and $y<0$ is underground. In addition, due to sediment deposition, the ground of the IOI civilization kept rising slowly. At $a$ years before the fall of the IOI civilization $(a\\geqslant 0)$, the line $y=-a$ was the ground surface.\n\nAfter the IOI civilization fell, the strata beneath it moved $Q$ times. The $i$-th movement $(1\\leqslant i\\leqslant Q)$ is described by position $X_i$, direction $D_i$, and amount $L_i$. $D_i$ is $1$ or $2$. Specifically,\n\n* $D_i=1$: The fault is considered to be a line passing through $(X_i, 0)$ with slope $1$. The strata above the fault move diagonally upward: the $x$ coordinate increases by $L_i$, and the $y$ coordinate increases by $L_i$. That is, every point $(x,y)$ above the line moves to $(x+L_i, y+L_i)$.\n* $D_i=2$: The fault is considered to be a line passing through $(X_i, 0)$ with slope $-1$. The strata above the fault move diagonally upward: the $x$ coordinate decreases by $L_i$, and the $y$ coordinate increases by $L_i$. That is, every point $(x,y)$ above the line moves to $(x-L_i, y+L_i)$.\n\nAfter each crustal movement, all strata with $y>0$ disappear due to weathering.\n\nYou are asked: for each $i$ $(1\\leqslant i\\leqslant N)$, determine **which year before the fall of the IOI civilization the stratum between point $(i-1,0)$ and point $(i,0)$ comes from**.\n\n> On the $y$ axis, every fault passes through an integer point, and there is no fault between two adjacent integer points on the $y$ axis. This should be clear, right……", "inputFormat": "The first line contains two integers $N, Q$, separated by spaces.  \nIn the next $Q$ lines, the $i$-th line $(1\\leqslant i\\leqslant Q)$ contains three integers $X_i, D_i, L_i$, separated by spaces.  \nThe meanings of all input values are given in the statement.", "outputFormat": "Output $N$ lines in total.  \nThe $i$-th line $(1\\leqslant i\\leqslant N)$ contains one integer, indicating which year before the fall of the IOI civilization the stratum between point $(i-1,0)$ and point $(i,0)$ comes from.", "hint": "#### Sample Explanation 1\n![](https://cdn.luogu.com.cn/upload/image_hosting/uxq94hp7.png)\n\n#### Constraints and Notes\nFor all testdata, $1\\leqslant N, Q\\leqslant 2\\times 10^5$, $-10^9\\leqslant X_i\\leqslant 10^9$, $D_i=1$ or $2$, $1\\leqslant L_i\\leqslant 10^9$ $(1\\leqslant i\\leqslant Q)$.\n\n|Subtask #|$N,Q$|Other Constraints|Score|\n|-|-|-|-|\n|1|$N,Q\\leqslant 100$|$-100\\leqslant X_i\\leqslant 100$, $L_i=1$ $(1\\leqslant i\\leqslant Q)$|18|\n|2|$N,Q\\leqslant 3000$|None.|16|\n|3|$N,Q\\leqslant 2\\times10^5$|None.|66|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JOI 2016 Final] 断层 / Geologic Fault", "background": "", "description": "**译者水平有限，跪求各位大佬提供更好的译文**\n\n**本题译自 [JOI 2016 Final](https://www.ioi-jp.org/joi/2015/2016-ho/index.html) T5「[断層](https://www.ioi-jp.org/joi/2015/2016-ho/2016-ho.pdf)」**\n\n很久很久以前，一个叫做 IOI 的先进文明蓬勃发展。时过境迁，现代考古学家 JOI 博士决定挖掘 IOI 文明遗址。\n\nIOI 文明沿着笔直的河流发展。方便起见，IOI 文明遗址可以看作平面直角坐标系的 $x$ 轴，而 $y$ 轴表示海拔。IOI 文明地面平坦，也就是说，直线 $y=0$ 代表地面，而 $y>0$ 代表地面上空，$y<0$ 代表地下。另外，由于流水堆积，IOI 文明的地面一直在缓慢升高。IOI 文明灭亡前 $a$ 年 $(a\\geqslant 0)$ 时，直线 $y=-a$ 才是地平面。  \nIOI 文明灭亡后，它脚下的地层发生了 $Q$ 次运动。第 $i$ 次运动 $(1\\leqslant i\\leqslant Q)$ 可用位置 $X_i$，方向 $D_i$ 和变化量 $L_i$ 描述。$D_i = 1$ 或 $2$。具体来说，\n\n* $D_i=1$：断层视为一条过 $(X_i, 0)$，斜率为 $1$ 的直线。断层上方的地层斜向上移动，横坐标增加 $L_i$，纵坐标增加 $L_i$。也就是说，直线上方的所有点 $(x,y)$ 移动到 $(x+L_i, y+L_i)$。\n* $D_i=2$：断层视为一条过 $(X_i, 0)$，斜率为 $-1$ 的直线。断层上方的地层斜向上移动，横坐标减少 $L_i$，纵坐标增加 $L_i$。也就是说，直线上方的所有点 $(x,y)$ 移动到 $(x-L_i, y+L_i)$。\n\n每次地壳运动后，$y>0$ 的地层都会因风化作用而消失。\n\n试求：对于每一个 $i(1\\leqslant i\\leqslant N)$，**点 $(i-1,0)$ 和 点$(i,0)$ 之间的地层**是在 IOI 文明灭亡前哪一年的地层。 \n\n> 在 $y$ 轴上，断层都是经过整点的，$y$ 轴上的相邻整点间没有断层。这样讲能明白吧……\n", "inputFormat": "第一行有两个整数 $N,Q$，用空格分隔。  \n在接下来的 $Q$ 行中，第 $i$ 行 $(1\\leqslant i\\leqslant N)$ 有三个整数 $X_i, D_i, L_i$，用空格分隔。  \n输入的所有数的含义见题目描述。", "outputFormat": "输出共 $N$ 行，第 $i$ 行 $(1\\leqslant i\\leqslant N)$ 有一个整数，表示点 $(i-1,0)$ 和 点$(i,0)$ 之间的地层是在 IOI 文明灭亡前哪一年的地层。 ", "hint": "#### 样例解释 1\n![](https://cdn.luogu.com.cn/upload/image_hosting/uxq94hp7.png)\n\n#### 数据范围与提示\n对于所有数据，$1\\leqslant N, Q\\leqslant 2\\times 10^5, -10^9\\leqslant X_i\\leqslant 10^9, D_i=1$ 或 $2, 1\\leqslant L_i\\leqslant 10^9(1\\leqslant i\\leqslant Q)$。\n\n|Subtask #|$N,Q$|其他限制|分值|\n|-|-|-|-|\n|1|$N,Q\\leqslant 100$|$-100\\leqslant X_i\\leqslant 100, L_i=1(1\\leqslant i\\leqslant Q)$|18|\n|2|$N,Q\\leqslant 3000$|无|16|\n|3|$N,Q\\leqslant 2\\times10^5$|无|66|", "locale": "zh-CN"}}}
{"pid": "P5104", "type": "P", "difficulty": 4, "samples": [["2 1 1", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["概率论", "期望", "逆元"], "title": "红包发红包", "background": "红包（redbag）发明了一个抢红包的系统。", "description": "这个抢红包系统是这样的：假如现在有 $w$ 元，那么你抢红包能抢到的钱就是 $[0,w]$ 等概率均匀随机出的一个实数 $x$。\n\n现在红包发了一个 $w$ 元的红包，有 $n$ 个人来抢。那么请问第 $k$ 个人期望抢到多少钱？\n\n输出答案对 $10^9+7$ 取模后的结果。\n", "inputFormat": "一行三个整数，$w,n,k$。", "outputFormat": "第 $k$ 个人期望抢到的钱数对 $10^9+7$ 取模后的结果。\n\n补充：期望可能是分数，关于分数取模，可以问度娘。\n", "hint": "注意红包发明的抢红包系统和微信的抢红包系统不一样，红包发明的抢红包系统中的钱不一定是整数分。\n\n- 对于 $30\\%$ 的数据，$k=1$\n- 另有 $30\\%$ 的数据，期望值取模前为整数，$k\\le 10$。\n\n对于全部数据，$0< w< (10^9+7)$，$n\\le 10^{18},k\\le n$。", "locale": "zh-CN", "translations": {"en": {"title": "Redbag Gives Redbags", "background": "Redbag invented a redbag-grabbing system.", "description": "This redbag-grabbing system works like this: suppose there are currently $w$ yuan. Then the amount of money you can get from grabbing a redbag is a real number $x$ chosen uniformly at random from $[0,w]$ with equal probability.\n\nNow Redbag releases a redbag worth $w$ yuan, and there are $n$ people grabbing it. What is the expected amount of money that the $k$-th person will get?\n\nOutput the result modulo $10^9+7$.", "inputFormat": "One line with three integers, $w,n,k$.", "outputFormat": "Output the expected amount of money the $k$-th person gets, taken modulo $10^9+7$.\n\nNote: The expectation may be a fraction. For how to take a fraction modulo, you can search online (Du Niang).", "hint": "Note that Redbag’s redbag-grabbing system is different from WeChat’s redbag system. In Redbag’s system, the money is not necessarily an integer number of cents.\n\n- For $30\\%$ of the testdata, $k=1$.\n- For another $30\\%$ of the testdata, the expectation is an integer before taking modulo, and $k\\le 10$.\n\nFor all testdata, $0< w< (10^9+7)$, $n\\le 10^{18},k\\le n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "红包发红包", "background": "红包（redbag）发明了一个抢红包的系统。", "description": "这个抢红包系统是这样的：假如现在有 $w$ 元，那么你抢红包能抢到的钱就是 $[0,w]$ 等概率均匀随机出的一个实数 $x$。\n\n现在红包发了一个 $w$ 元的红包，有 $n$ 个人来抢。那么请问第 $k$ 个人期望抢到多少钱？\n\n输出答案对 $10^9+7$ 取模后的结果。\n", "inputFormat": "一行三个整数，$w,n,k$。", "outputFormat": "第 $k$ 个人期望抢到的钱数对 $10^9+7$ 取模后的结果。\n\n补充：期望可能是分数，关于分数取模，可以问度娘。\n", "hint": "注意红包发明的抢红包系统和微信的抢红包系统不一样，红包发明的抢红包系统中的钱不一定是整数分。\n\n- 对于 $30\\%$ 的数据，$k=1$\n- 另有 $30\\%$ 的数据，期望值取模前为整数，$k\\le 10$。\n\n对于全部数据，$0< w< (10^9+7)$，$n\\le 10^{18},k\\le n$。", "locale": "zh-CN"}}}
{"pid": "P5105", "type": "P", "difficulty": 6, "samples": [["2\n1 1 1\n2\n", "0\n"], ["10\n1 22 27\n1 50 55\n1 82 87\n1 2 7\n2\n1 47 52\n1 62 67\n1 61 66\n1 41 46\n2", "2515\n2141\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["线段树", "O2优化", "差分"], "title": "不强制在线的动态快速排序", "background": "曦月最近学会了快速排序，但是她很快地想到了，如果要动态地排序，那要怎么办呢？\n", "description": "为了研究这个问题，曦月提出了一个十分简单的问题\n\n曦月希望维护一个允许重复的集合$S$，支持：\n\n* 插入$[L, R]$，也就是插入$L, L + 1 ... , R$，这$R - L + 1$个数\n\n* 询问$Sort(S)$\n\n---\n\n$Sort(S)$的定义为：\n\n我们将集合$S$中的元素**从小到大按照快速排序**排好序，记为$a_1, a_2 ... a_n$\n\n那么，$Sort(S) = \\bigoplus \\limits_{i = 2}^n (a_i^2 - a_{i - 1}^2)$，其中$\\bigoplus$表示异或和\n\n关于异或的定义，请咨询度娘", "inputFormat": "第一行，一个数$q$\n\n后$q$行，或者是$1\\;l\\;r$，表示插入$[l, r]$，或者是$2$，表示一次询问", "outputFormat": "对于每个询问，一行一个答案", "hint": "对于样例一的解释：\n\n$S$中只有一个数，因此返回$0$\n\n---\n\n对于$30$分的数据，$q \\leqslant 100$\n\n对于$50$分的数据，$q \\leqslant 5 * 10^4$\n\n对于另外的$20$分的数据，满足$L = R$\n\n对于$100$分的数据，$q \\leqslant 3 * 10^5$，$1 \\leqslant L \\leqslant R \\leqslant 10^9$\n\n保证数据有梯度，可能略微地有卡常，请把自己的常数优化到极致", "locale": "zh-CN", "translations": {"en": {"title": "Dynamic Quicksort Not Forced to Be Online", "background": "Xiyue recently learned quicksort, but she soon thought: if we need to sort dynamically, what should we do?", "description": "To study this problem, Xiyue proposed a very simple question.\n\nXiyue wants to maintain a multiset $S$ that allows duplicates, supporting:\n\n* Insert $[L, R]$, i.e., insert $L, L + 1 ... , R$, these $R - L + 1$ numbers.\n\n* Query $Sort(S)$.\n\n---\n\nThe definition of $Sort(S)$ is:\n\nWe sort the elements in $S$ from small to large **using quicksort**, denoted as $a_1, a_2 ... a_n$.\n\nThen, $Sort(S) = \\bigoplus \\limits_{i = 2}^n (a_i^2 - a_{i - 1}^2)$, where $\\bigoplus$ denotes XOR.\n\nFor the definition of XOR, please consult Baidu.", "inputFormat": "The first line contains an integer $q$.\n\nThe next $q$ lines are either $1\\;l\\;r$, meaning insert $[l, r]$, or $2$, meaning one query.", "outputFormat": "For each query, output one line with one answer.", "hint": "Explanation for Sample 1:\n\n$S$ contains only one number, so return $0$.\n\n---\n\nConstraints:\n\nFor the $30$ points testdata, $q \\leqslant 100$.\n\nFor the $50$ points testdata, $q \\leqslant 5 * 10^4$.\n\nFor the other $20$ points testdata, $L = R$.\n\nFor the $100$ points testdata, $q \\leqslant 3 * 10^5$, $1 \\leqslant L \\leqslant R \\leqslant 10^9$.\n\nThe testdata is guaranteed to have gradients. It may be slightly sensitive to constants, so please optimize your constants as much as possible.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "不强制在线的动态快速排序", "background": "曦月最近学会了快速排序，但是她很快地想到了，如果要动态地排序，那要怎么办呢？\n", "description": "为了研究这个问题，曦月提出了一个十分简单的问题\n\n曦月希望维护一个允许重复的集合$S$，支持：\n\n* 插入$[L, R]$，也就是插入$L, L + 1 ... , R$，这$R - L + 1$个数\n\n* 询问$Sort(S)$\n\n---\n\n$Sort(S)$的定义为：\n\n我们将集合$S$中的元素**从小到大按照快速排序**排好序，记为$a_1, a_2 ... a_n$\n\n那么，$Sort(S) = \\bigoplus \\limits_{i = 2}^n (a_i^2 - a_{i - 1}^2)$，其中$\\bigoplus$表示异或和\n\n关于异或的定义，请咨询度娘", "inputFormat": "第一行，一个数$q$\n\n后$q$行，或者是$1\\;l\\;r$，表示插入$[l, r]$，或者是$2$，表示一次询问", "outputFormat": "对于每个询问，一行一个答案", "hint": "对于样例一的解释：\n\n$S$中只有一个数，因此返回$0$\n\n---\n\n对于$30$分的数据，$q \\leqslant 100$\n\n对于$50$分的数据，$q \\leqslant 5 * 10^4$\n\n对于另外的$20$分的数据，满足$L = R$\n\n对于$100$分的数据，$q \\leqslant 3 * 10^5$，$1 \\leqslant L \\leqslant R \\leqslant 10^9$\n\n保证数据有梯度，可能略微地有卡常，请把自己的常数优化到极致", "locale": "zh-CN"}}}
