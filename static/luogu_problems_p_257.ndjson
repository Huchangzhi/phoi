{"pid": "P6198", "type": "P", "difficulty": 5, "samples": [["10\n1 -1 2 3 -1 3 1 -1 2 3 \n", "2 4 3 6 7 5 1 9 8 10\n"], ["10\n1 1 2 2 3 2 3 3 4 5 \n", "2 1 5 4 6 3 8 7 9 10\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "洛谷月赛"], "title": "[EER1] 单调栈", "background": "", "description": "单调栈是一种常见的数据结构，如果你之前没有了解过，可以参考 [单调栈教程](https://www.luogu.com.cn/problemnew/solution/P5788) 帮助理解题意。\n\n有一个长度为 $n$ 的**排列** $p_0, p_1, \\cdots, p_{n-1}$，通过这个排列生成了一个长度为 $n$ 的序列 $S$，其中 $S_i$ 表示由 $p_0, p_1, \\cdots, p_i$ 组成的递增单调栈的大小。\n\n换一种说法，序列 $S$ 是由如下代码生成的：\n```cpp\nstack<int> stk;\nint n = p.size();\nvector<int> S;\nfor (int i = 0; i < n; i++) {\n  while (!stk.empty() && p[i] <= p[stk.top()]) stk.pop();\n  stk.push(i);\n  S.push_back((int)stk.size());\n}\n```\n\n现在给你序列 $S$ 的**一部分**，没有给出的部分可以取任意值。请你根据给出的 $S$ 复原出排列 $p$。如果有多种可能，输出字典序最小的。保证一定有解。\n", "inputFormat": "第一行一个整数 $n$。表示排列的长度。\n\n接下来一行 $n$ 个整数，表示序列 $S$。其中部分项为 $-1$，表示可以取任意值。", "outputFormat": "一行 $n$ 个整数，一个排列。\n\n", "hint": "样例 #1 解释：样例 $1$ 的输出对应的 $S$ 序列为 1 2 2 3 4 3 1 2 2 3，可以匹配输入。可以证明这是字典序最小的可以匹配输入的排列。\n\n\n对于 $100\\%$ 的数据，满足 $1 \\leq n \\leq 10^6$。\n\n本题共有 $5$ 个子任务，每个子任务的限制如下：\n\n子任务 $1$ ($5$ 分)：保证 $1 \\leq n \\leq 10$。\n\n子任务 $2$ ($10$ 分)：保证给出的 $S$ 中没有 $-1$。\n\n子任务 $3$ ($20$ 分)：保证 $1 \\leq n \\leq 300$。\n\n子任务 $4$ ($20$ 分)：保证 $1 \\leq n \\leq 3000$。\n\n子任务 $5$ ($45$ 分)：无特殊限制。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[EER1] 单调栈", "background": "", "description": "单调栈是一种常见的数据结构，如果你之前没有了解过，可以参考 [单调栈教程](https://www.luogu.com.cn/problemnew/solution/P5788) 帮助理解题意。\n\n有一个长度为 $n$ 的**排列** $p_0, p_1, \\cdots, p_{n-1}$，通过这个排列生成了一个长度为 $n$ 的序列 $S$，其中 $S_i$ 表示由 $p_0, p_1, \\cdots, p_i$ 组成的递增单调栈的大小。\n\n换一种说法，序列 $S$ 是由如下代码生成的：\n```cpp\nstack<int> stk;\nint n = p.size();\nvector<int> S;\nfor (int i = 0; i < n; i++) {\n  while (!stk.empty() && p[i] <= p[stk.top()]) stk.pop();\n  stk.push(i);\n  S.push_back((int)stk.size());\n}\n```\n\n现在给你序列 $S$ 的**一部分**，没有给出的部分可以取任意值。请你根据给出的 $S$ 复原出排列 $p$。如果有多种可能，输出字典序最小的。保证一定有解。\n", "inputFormat": "第一行一个整数 $n$。表示排列的长度。\n\n接下来一行 $n$ 个整数，表示序列 $S$。其中部分项为 $-1$，表示可以取任意值。", "outputFormat": "一行 $n$ 个整数，一个排列。\n\n", "hint": "样例 #1 解释：样例 $1$ 的输出对应的 $S$ 序列为 1 2 2 3 4 3 1 2 2 3，可以匹配输入。可以证明这是字典序最小的可以匹配输入的排列。\n\n\n对于 $100\\%$ 的数据，满足 $1 \\leq n \\leq 10^6$。\n\n本题共有 $5$ 个子任务，每个子任务的限制如下：\n\n子任务 $1$ ($5$ 分)：保证 $1 \\leq n \\leq 10$。\n\n子任务 $2$ ($10$ 分)：保证给出的 $S$ 中没有 $-1$。\n\n子任务 $3$ ($20$ 分)：保证 $1 \\leq n \\leq 300$。\n\n子任务 $4$ ($20$ 分)：保证 $1 \\leq n \\leq 3000$。\n\n子任务 $5$ ($45$ 分)：无特殊限制。\n", "locale": "zh-CN"}}}
{"pid": "P6199", "type": "P", "difficulty": 7, "samples": [["5\n1 2 1\n1 3 1\n2 4 1\n2 5 1\n2 3 1\n2 4 1\n3 5 1\n3 1 1\n", "10\n"], ["4\n1 2 1\n1 3 1\n1 4 1\n1 2 1\n2 3 1\n3 4 1 \n", "8\n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "洛谷月赛"], "title": "[EER1] 河童重工", "background": "妖怪之山上生活着两种妖怪，鸦天狗和河童。从前，他们各有自己专属的交通线路，可以在妖怪之山的各个地点之间移动，但两套交通线路的维护成本实在是太高了！因此妖怪们现在想要把两套线路精简成一套。这个繁重的工程就被委托给河童重工了。", "description": "妖怪之山上有 $n$ 个地点，鸦天狗和河童的两套交通线路都是分别由一些连接这些地点的无向道路组成的，每条道路有自己的长度，把这些道路看成有权边，那么他们的两套线路分别可以表示成两棵 $n$ 个节点的树 $T_1, T_2$（有 $n-1$ 条边的有边权无向连通图），河童重工现在要新建一些无向道路，新建一条无向道路 $(i,j)$ 的花费是 $dist_{T_1}(i,j)+dist_{T_2}(i,j)$（即 $T_1,T_2$ 上 $i$ 到 $j$ 的距离之和），河童重工要保证妖怪之山的任意两个节点都能只通过新修建的道路互相到达。但由于如果花费过多可能引起异变，所以他们希望这个工程的总花费最少。\n\n荷取作为这个工程的总设计师，请你帮她算一算，修建新道路的总花费最少是多少？", "inputFormat": "第一行一个正整数 $n$，表示节点数量。\n\n接下来有 $n-1$ 行，其中第 $i$ 行有三个整数 $x_i, y_i, v_i(1 \\leq x_i, y_i \\leq n, 1 \\leq v_i \\leq 5000)$，表示 $T_1$ 中有一条长度为 $v_i$ 的边，连接 $x_i, y_i$ 两点。\n\n接下来有 $n-1$ 行，其中第 $j$ 行有三个整数 $x_j, y_j, v_j(1 \\leq x_j, y_j \\leq n, 1 \\leq v_j \\leq 5000)$，表示 $T_2$ 中有一条长度为 $v_j$ 的边，连接 $x_j, y_j$ 两点。\n", "outputFormat": "一行一个整数表示最少的总花费。\n", "hint": "对于 $100\\%$ 的数据，满足 $2 \\leq n \\leq 10^5$。\n\n本题共有 $5$ 个子任务，每个子任务的限制如下：\n\n子任务 $1$（$15$ 分)：保证 $2 \\leq n \\leq 1000$。\n\n子任务 $2$（$15$ 分)：保证 $T_1, T_2$ 分别是一条链。\n\n子任务 $3$（$5$ 分)：保证 $T_1, T_2$ 除了边权完全相同（即如果将两棵树看成无边权树，那么它们是相同的）。\n\n子任务 $4$（$5$ 分)：保证 $T_2$ 是一条链。\n\n子任务 $5$（$60$ 分)：无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[EER1] 河童重工", "background": "妖怪之山上生活着两种妖怪，鸦天狗和河童。从前，他们各有自己专属的交通线路，可以在妖怪之山的各个地点之间移动，但两套交通线路的维护成本实在是太高了！因此妖怪们现在想要把两套线路精简成一套。这个繁重的工程就被委托给河童重工了。", "description": "妖怪之山上有 $n$ 个地点，鸦天狗和河童的两套交通线路都是分别由一些连接这些地点的无向道路组成的，每条道路有自己的长度，把这些道路看成有权边，那么他们的两套线路分别可以表示成两棵 $n$ 个节点的树 $T_1, T_2$（有 $n-1$ 条边的有边权无向连通图），河童重工现在要新建一些无向道路，新建一条无向道路 $(i,j)$ 的花费是 $dist_{T_1}(i,j)+dist_{T_2}(i,j)$（即 $T_1,T_2$ 上 $i$ 到 $j$ 的距离之和），河童重工要保证妖怪之山的任意两个节点都能只通过新修建的道路互相到达。但由于如果花费过多可能引起异变，所以他们希望这个工程的总花费最少。\n\n荷取作为这个工程的总设计师，请你帮她算一算，修建新道路的总花费最少是多少？", "inputFormat": "第一行一个正整数 $n$，表示节点数量。\n\n接下来有 $n-1$ 行，其中第 $i$ 行有三个整数 $x_i, y_i, v_i(1 \\leq x_i, y_i \\leq n, 1 \\leq v_i \\leq 5000)$，表示 $T_1$ 中有一条长度为 $v_i$ 的边，连接 $x_i, y_i$ 两点。\n\n接下来有 $n-1$ 行，其中第 $j$ 行有三个整数 $x_j, y_j, v_j(1 \\leq x_j, y_j \\leq n, 1 \\leq v_j \\leq 5000)$，表示 $T_2$ 中有一条长度为 $v_j$ 的边，连接 $x_j, y_j$ 两点。\n", "outputFormat": "一行一个整数表示最少的总花费。\n", "hint": "对于 $100\\%$ 的数据，满足 $2 \\leq n \\leq 10^5$。\n\n本题共有 $5$ 个子任务，每个子任务的限制如下：\n\n子任务 $1$（$15$ 分)：保证 $2 \\leq n \\leq 1000$。\n\n子任务 $2$（$15$ 分)：保证 $T_1, T_2$ 分别是一条链。\n\n子任务 $3$（$5$ 分)：保证 $T_1, T_2$ 除了边权完全相同（即如果将两棵树看成无边权树，那么它们是相同的）。\n\n子任务 $4$（$5$ 分)：保证 $T_2$ 是一条链。\n\n子任务 $5$（$60$ 分)：无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P6200", "type": "P", "difficulty": 2, "samples": [["4 3\n2 1\n2 3\n4 1", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2007", "USACO"], "title": "[USACO07OCT] Super Paintball G", "background": "", "description": "奶牛们最近从玩具商那里，买来了一套仿真版彩弹游戏设备（类似于真人 CS）。Bessie 把她们玩游戏的草坪划分成了 $N \\times N$ 的矩阵（$1 \\leq N \\leq 100$），同时他算出了她的 $K$ 个对手在草地上的位置（$1 \\leq K \\leq 10^5$），现在你需要帮 Bessie 算些东西。\n\n在这个游戏中，奶牛们用一把枪向八个方向中的任意一个方向射出子弹，这八个方向分别是：正北，正南，正东，正西，东北，东南，西北，西南（东北指北偏东 $45^\\circ$，东南，西北，西南同理）。\n\nBessie 想要你算出，有多少个位置可以让她射到所有对手。特别地，Bessie 可以和她的某一个对手站在同一格子，这时候她可以射到和她同一格子的对手。", "inputFormat": "第一行两个整数 $N, K$。\n\n接下来 $K$ 行，每行两个整数 $R_i, C_i$，表示第 $i$ 头奶牛在第 $R_i$ 行第 $C_i$ 列。可能有两个奶牛在同一位置上。", "outputFormat": "输出 Bessie 可以选择的格子数目。", "hint": "可选的位置有：$(2,1),(2,3),(3,2),(4,1),(4,3)$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO07OCT] Super Paintball G", "background": "", "description": "奶牛们最近从玩具商那里，买来了一套仿真版彩弹游戏设备（类似于真人 CS）。Bessie 把她们玩游戏的草坪划分成了 $N \\times N$ 的矩阵（$1 \\leq N \\leq 100$），同时他算出了她的 $K$ 个对手在草地上的位置（$1 \\leq K \\leq 10^5$），现在你需要帮 Bessie 算些东西。\n\n在这个游戏中，奶牛们用一把枪向八个方向中的任意一个方向射出子弹，这八个方向分别是：正北，正南，正东，正西，东北，东南，西北，西南（东北指北偏东 $45^\\circ$，东南，西北，西南同理）。\n\nBessie 想要你算出，有多少个位置可以让她射到所有对手。特别地，Bessie 可以和她的某一个对手站在同一格子，这时候她可以射到和她同一格子的对手。", "inputFormat": "第一行两个整数 $N, K$。\n\n接下来 $K$ 行，每行两个整数 $R_i, C_i$，表示第 $i$ 头奶牛在第 $R_i$ 行第 $C_i$ 列。可能有两个奶牛在同一位置上。", "outputFormat": "输出 Bessie 可以选择的格子数目。", "hint": "可选的位置有：$(2,1),(2,3),(3,2),(4,1),(4,3)$。", "locale": "zh-CN"}}}
{"pid": "P6202", "type": "P", "difficulty": 4, "samples": [["3 4\n1\n0\n4", "26\n25\n29\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2007", "USACO"], "title": "[USACO07CHN] Summing Sums G", "background": "", "description": "$N$ 头奶牛（$1 \\leq N \\leq 5 \\times 10^4$）刚刚学习了不少密码学知识，终于，她们创造出了属于奶牛的加密方法，由于她们经验不足，她们的加密方法很简单：\n\n第 $i$ 头奶牛掌握着密码的第 $i$ 个数字，起始的时候是 $C_i$（$0 \\leq C_i \\lt 9 \\times 10^7$）。加密的时候，第 $i$ 头奶牛会计算其他所有奶牛的数字和，并将这个和对 $98\\,765\\,431$ 取模。在所有奶牛计算完成后，每头奶牛都会用自己算的数字代替原来的数字。即，\n\n$$\nC_{i}'=(\\sum_{k=1}^NC_k-C_i) \\bmod 98\\,765\\,431\n$$\n\n这样，她们完成了一次加密。\n\n在十一月，奶牛们把这个加密方法告诉了驼鹿卡门。卡门想了一会后，说：“你们的算法还很原始，为了达到加密效果，你们要重复这个加密过程 $T$ 次（$1 \\leq T \\leq 1\\,414\\,213\\,562$）”。\n\n奶牛们很懒，于是就把这个任务交给了你。", "inputFormat": "第一行两个整数 $N,T$。\n\n接下来 $N$ 行，第 $i$ 行一个整数 $C_i$。", "outputFormat": "输出 $N$ 行，第 $i$ 行一个整数，代表经过 $T$ 次加密后的 $C_i$。", "hint": "每次加密后的 $C_i$ 如下：\n\n| 次数 | $C_1$ | $C_2$ | $C_3$ |\n| ---- | ----- | ----- | ----- |\n| 0    | 1     | 0     | 4     |\n| 1    | 4     | 5     | 1     |\n| 2    | 6     | 5     | 9     |\n| 3    | 14    | 15    | 11    |\n| 4    | 26    | 25    | 29    |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO07CHN] Summing Sums G", "background": "", "description": "$N$ 头奶牛（$1 \\leq N \\leq 5 \\times 10^4$）刚刚学习了不少密码学知识，终于，她们创造出了属于奶牛的加密方法，由于她们经验不足，她们的加密方法很简单：\n\n第 $i$ 头奶牛掌握着密码的第 $i$ 个数字，起始的时候是 $C_i$（$0 \\leq C_i \\lt 9 \\times 10^7$）。加密的时候，第 $i$ 头奶牛会计算其他所有奶牛的数字和，并将这个和对 $98\\,765\\,431$ 取模。在所有奶牛计算完成后，每头奶牛都会用自己算的数字代替原来的数字。即，\n\n$$\nC_{i}'=(\\sum_{k=1}^NC_k-C_i) \\bmod 98\\,765\\,431\n$$\n\n这样，她们完成了一次加密。\n\n在十一月，奶牛们把这个加密方法告诉了驼鹿卡门。卡门想了一会后，说：“你们的算法还很原始，为了达到加密效果，你们要重复这个加密过程 $T$ 次（$1 \\leq T \\leq 1\\,414\\,213\\,562$）”。\n\n奶牛们很懒，于是就把这个任务交给了你。", "inputFormat": "第一行两个整数 $N,T$。\n\n接下来 $N$ 行，第 $i$ 行一个整数 $C_i$。", "outputFormat": "输出 $N$ 行，第 $i$ 行一个整数，代表经过 $T$ 次加密后的 $C_i$。", "hint": "每次加密后的 $C_i$ 如下：\n\n| 次数 | $C_1$ | $C_2$ | $C_3$ |\n| ---- | ----- | ----- | ----- |\n| 0    | 1     | 0     | 4     |\n| 1    | 4     | 5     | 1     |\n| 2    | 6     | 5     | 9     |\n| 3    | 14    | 15    | 11    |\n| 4    | 26    | 25    | 29    |", "locale": "zh-CN"}}}
{"pid": "P6203", "type": "P", "difficulty": 0, "samples": [["3\n1\n1\n5\n5\n1\n1", "17"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2007", "USACO"], "title": "[USACO07CHN] The Bovine Accordion and Banjo Orchestra G", "background": null, "description": "FJ 的 $2N$ 头奶牛（$3 \\leq N \\leq 1000$）准备举办一场音乐会。其中 $N$ 头奶牛是手风琴手，另外 $N$ 头奶牛是班卓琴手，每个手风琴手有一个天才指数 $A_i$（$0 \\leq A_i \\leq 1000$），每个班卓琴手也有一个天才指数 $B_i$（$0 \\leq B_i \\leq 1000$）。\n\nFJ 需要给手风琴手和班卓琴手配对。让第 $i$ 位手风琴手和第 $j$ 位班卓琴手配对，能产生 $A_i \\times B_j$ 的收益。\n\n不幸的是，FJ 的奶牛都存在一种怪癖：如果第 $i$ 位手风琴手和第 $j$ 位班卓琴手配对，那么第 $i+1 \\sim N$ 位手风琴手，不会选择与第 $1 \\sim j-1$ 位班卓琴手配对。这给 FJ 的配对计划带来了很多不便。\n\n更糟糕的是，那些失去演出机会的失落的奶牛，为了消解内心的失落感情，会成群结队地到酒吧喝酒。\n\n如果第 $x$ 号手风琴手到第 $y$ 号手风琴手都是失落的（$x-1$ 和 $y+1$ 号手风琴手不存在或是参加了演出），这些奶牛就会去结队去酒吧喝酒，开销为：\n\n$$\n(\\sum_{k=x}^y A_k)^2\n$$\n\n对于班卓琴手，也有类似的规律。\n\n现在 FJ 不得不好好考虑下他的计划了，他想让你算出他的最大的收益。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行一个整数 $A_i$。\n\n接下来 $N$ 行，每行一个整数 $B_i$。", "outputFormat": "输出 FJ 能获得的最大收益。", "hint": "手风琴手 $3$ 和班卓琴手 $1$ 搭配，收益 $25$。\n\n手风琴手 $1,2$ 一块喝酒，花费 $4$。\n\n班卓琴手 $2,3$ 一块喝酒，花费 $4$。\n\n最终收益为 $17$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO07CHN] The Bovine Accordion and Banjo Orchestra G", "background": null, "description": "FJ 的 $2N$ 头奶牛（$3 \\leq N \\leq 1000$）准备举办一场音乐会。其中 $N$ 头奶牛是手风琴手，另外 $N$ 头奶牛是班卓琴手，每个手风琴手有一个天才指数 $A_i$（$0 \\leq A_i \\leq 1000$），每个班卓琴手也有一个天才指数 $B_i$（$0 \\leq B_i \\leq 1000$）。\n\nFJ 需要给手风琴手和班卓琴手配对。让第 $i$ 位手风琴手和第 $j$ 位班卓琴手配对，能产生 $A_i \\times B_j$ 的收益。\n\n不幸的是，FJ 的奶牛都存在一种怪癖：如果第 $i$ 位手风琴手和第 $j$ 位班卓琴手配对，那么第 $i+1 \\sim N$ 位手风琴手，不会选择与第 $1 \\sim j-1$ 位班卓琴手配对。这给 FJ 的配对计划带来了很多不便。\n\n更糟糕的是，那些失去演出机会的失落的奶牛，为了消解内心的失落感情，会成群结队地到酒吧喝酒。\n\n如果第 $x$ 号手风琴手到第 $y$ 号手风琴手都是失落的（$x-1$ 和 $y+1$ 号手风琴手不存在或是参加了演出），这些奶牛就会去结队去酒吧喝酒，开销为：\n\n$$\n(\\sum_{k=x}^y A_k)^2\n$$\n\n对于班卓琴手，也有类似的规律。\n\n现在 FJ 不得不好好考虑下他的计划了，他想让你算出他的最大的收益。", "inputFormat": "第一行一个整数 $N$。\n\n接下来 $N$ 行，每行一个整数 $A_i$。\n\n接下来 $N$ 行，每行一个整数 $B_i$。", "outputFormat": "输出 FJ 能获得的最大收益。", "hint": "手风琴手 $3$ 和班卓琴手 $1$ 搭配，收益 $25$。\n\n手风琴手 $1,2$ 一块喝酒，花费 $4$。\n\n班卓琴手 $2,3$ 一块喝酒，花费 $4$。\n\n最终收益为 $17$。", "locale": "zh-CN"}}}
{"pid": "P6204", "type": "P", "difficulty": 0, "samples": [["4\n1 2\n2 3\n3 1\n1 4", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2007", "USACO"], "title": "[USACO07CHN] Treasure G", "background": "", "description": "卡门和他的朋友们最近挖到了一箱财宝，他们打算将这箱财宝埋在公路网的某个节点上。\n\n整个公路网有 $N$ 个节点，这些节点之间由 $N$ 条公路连接。公路都是双向通行的，任何一个节点至少与一条公路相连，且没有节点与超过 $4$ 条公路连接。卡门决定不将财宝埋在有 $4$ 条公路连接的节点上，因为那里交通繁忙，容易被暴露。\n\n卡门将公路网的地图画了出来，并在计划埋藏财宝的地方画了个叉。为了研究最佳埋藏方案，他把所有情况都画了出来，比如下面是一个 $N=4$ 时的所有埋藏情况：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1n2zbqb9.png)\n\n他仔细研究后，发现后两种方案是本质相同的。两种地图是本质相同的，当且仅当：\n\n- 宝藏埋藏地点相对应；\n- 如果两个节点间有路，则对应节点间也有路；\n- 如果两个节点间没有路，则对应节点间也没有路。\n\n现在你需要求出究竟有多少种本质不同的埋藏方案。", "inputFormat": "第一行一个整数 $N$（$4 \\leq N \\leq 10^5$）。\n\n接下来 $N$ 行，每行两个整数 $u,v$（$1 \\leq u,v \\leq N$），描述一条道路。\n\n保证两个节点间最多有一条道路直接相连，且不存在从节点 $u$ 到节点 $u$ 的道路。", "outputFormat": "输出本质不同的埋藏方案数。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO07CHN] Treasure G", "background": "", "description": "卡门和他的朋友们最近挖到了一箱财宝，他们打算将这箱财宝埋在公路网的某个节点上。\n\n整个公路网有 $N$ 个节点，这些节点之间由 $N$ 条公路连接。公路都是双向通行的，任何一个节点至少与一条公路相连，且没有节点与超过 $4$ 条公路连接。卡门决定不将财宝埋在有 $4$ 条公路连接的节点上，因为那里交通繁忙，容易被暴露。\n\n卡门将公路网的地图画了出来，并在计划埋藏财宝的地方画了个叉。为了研究最佳埋藏方案，他把所有情况都画了出来，比如下面是一个 $N=4$ 时的所有埋藏情况：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1n2zbqb9.png)\n\n他仔细研究后，发现后两种方案是本质相同的。两种地图是本质相同的，当且仅当：\n\n- 宝藏埋藏地点相对应；\n- 如果两个节点间有路，则对应节点间也有路；\n- 如果两个节点间没有路，则对应节点间也没有路。\n\n现在你需要求出究竟有多少种本质不同的埋藏方案。", "inputFormat": "第一行一个整数 $N$（$4 \\leq N \\leq 10^5$）。\n\n接下来 $N$ 行，每行两个整数 $u,v$（$1 \\leq u,v \\leq N$），描述一条道路。\n\n保证两个节点间最多有一条道路直接相连，且不存在从节点 $u$ 到节点 $u$ 的道路。", "outputFormat": "输出本质不同的埋藏方案数。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6205", "type": "P", "difficulty": 3, "samples": [["5 3", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2006", "USACO"], "title": "[USACO06JAN] Dollar Dayz S", "background": "", "description": "FJ 到商场买工具。商场里有 $K$ 种工具（$1 \\leq K \\leq 100$），价格分别为 $1,2,\\ldots,K$ 元。FJ 手里有 $N$ 元（$1 \\leq N \\leq 1000$），必须花完。他有多少种购买方案呢？", "inputFormat": "一行两个整数 $N,K$。", "outputFormat": "输出不同的购买方案数。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO06JAN] Dollar Dayz S", "background": "", "description": "FJ 到商场买工具。商场里有 $K$ 种工具（$1 \\leq K \\leq 100$），价格分别为 $1,2,\\ldots,K$ 元。FJ 手里有 $N$ 元（$1 \\leq N \\leq 1000$），必须花完。他有多少种购买方案呢？", "inputFormat": "一行两个整数 $N,K$。", "outputFormat": "输出不同的购买方案数。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P6206", "type": "P", "difficulty": 1, "samples": [["5", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "2006", "USACO"], "title": "[USACO06OCT] Another Cow Number Game G", "background": "", "description": "奶牛们在玩一种数字游戏，Bessie 想让你帮她预测一下结果。游戏开始时，Bessie 将得到一个正整数 $N$。此时她的分数为 $0$。\n\n奶牛们按照以下规则对 $N$ 进行变换：\n\n- 如果 $N$ 是奇数，那么将它乘以 $3$ 后再加 $1$。\n- 如果 $N$ 是偶数，那么将它除以 $2$。\n\n数字每变换一次，Bessie 就得到 $1$ 分。当 $N=1$ 时，游戏结束。此时的分数就是她的最终得分。", "inputFormat": "一行，一个整数 $N$。", "outputFormat": "一行，一个整数，为 Bessie 的最终得分。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le N\\le 10^6$。\n\n------------\n\n**【样例说明】**\n\n当 $N$ 的初始值为 $5$ 时，游戏的过程如下：\n\n| $N$ | 变换后的数字 | 变换过程 | 总分 |\n| :----------: | :----------: | :----------: | :----------: |\n| $5$ | $16$ | $3\\times 5+1$ | $1$ |\n| $16$ | $8$ | $16\\div 2$ | $2$ |\n| $8$ | $4$ | $8\\div 2$ | $3$ |\n| $4$ | $2$ | $4\\div 2$ | $4$ |\n| $2$ | $1$ | $2\\div 2$ | $5$ |\n\nBessie 的最终得分为 $5$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO06OCT] Another Cow Number Game G", "background": "", "description": "奶牛们在玩一种数字游戏，Bessie 想让你帮她预测一下结果。游戏开始时，Bessie 将得到一个正整数 $N$。此时她的分数为 $0$。\n\n奶牛们按照以下规则对 $N$ 进行变换：\n\n- 如果 $N$ 是奇数，那么将它乘以 $3$ 后再加 $1$。\n- 如果 $N$ 是偶数，那么将它除以 $2$。\n\n数字每变换一次，Bessie 就得到 $1$ 分。当 $N=1$ 时，游戏结束。此时的分数就是她的最终得分。", "inputFormat": "一行，一个整数 $N$。", "outputFormat": "一行，一个整数，为 Bessie 的最终得分。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le N\\le 10^6$。\n\n------------\n\n**【样例说明】**\n\n当 $N$ 的初始值为 $5$ 时，游戏的过程如下：\n\n| $N$ | 变换后的数字 | 变换过程 | 总分 |\n| :----------: | :----------: | :----------: | :----------: |\n| $5$ | $16$ | $3\\times 5+1$ | $1$ |\n| $16$ | $8$ | $16\\div 2$ | $2$ |\n| $8$ | $4$ | $8\\div 2$ | $3$ |\n| $4$ | $2$ | $4\\div 2$ | $4$ |\n| $2$ | $1$ | $2\\div 2$ | $5$ |\n\nBessie 的最终得分为 $5$。\n", "locale": "zh-CN"}}}
{"pid": "P6207", "type": "P", "difficulty": 3, "samples": [["5 8\n..*...**\n*.*.*.**\n*...*...\n*.*.*.*.\n....*.*.", "1 1\n1 2\n2 2\n3 2\n3 3\n3 4\n2 4\n1 4\n1 5\n1 6\n2 6\n3 6\n3 7\n3 8\n4 8\n5 8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2006", "USACO", "Special Judge", "广度优先搜索 BFS", "深度优先搜索 DFS"], "title": "[USACO06OCT] Cows on Skates G", "background": "", "description": "**本题使用 Special Judge。**\n\nFarmer John 把农场划分为了一个 $r$ 行 $c$ 列的矩阵，并发现奶牛们无法通过其中一些区域。此刻，Bessie 位于坐标为 $(1,1)$ 的区域，并想到坐标为 $(r,c)$ 的牛棚享用晚餐。她知道，以她所在的区域为起点，每次移动至相邻的四个区域之一，总有一些路径可以到达牛棚。\n\n这样的路径可能有无数种，请你输出任意一种，并保证所需移动次数不超过 $100000$。", "inputFormat": "第一行两个整数 $r,c$。\n \n接下来 $r$ 行，每行 $c$ 个字符，表示 Bessie 能否通过相应位置的区域。字符只可能是 `.` 或 `*`。\n\n- `.` 表示 Bessie 可以通过该区域。\n- `*` 表示 Bessie 无法通过该区域。", "outputFormat": "若干行，每行包含两个用空格隔开的整数，表示 Bessie 依次通过的区域的坐标。\n\n显然，输出的第一行是 `1 1` ，最后一行是 `r c`。\n\n相邻的两个坐标所表示的区域必须相邻。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le r\\le 113$，$1\\le c\\le 77$。\n\n------------\n\n**【样例说明】* *\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3gsutffb.png)\n\n图为样例输出的示意图。答案不唯一。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO06OCT] Cows on Skates G", "background": "", "description": "**本题使用 Special Judge。**\n\nFarmer John 把农场划分为了一个 $r$ 行 $c$ 列的矩阵，并发现奶牛们无法通过其中一些区域。此刻，Bessie 位于坐标为 $(1,1)$ 的区域，并想到坐标为 $(r,c)$ 的牛棚享用晚餐。她知道，以她所在的区域为起点，每次移动至相邻的四个区域之一，总有一些路径可以到达牛棚。\n\n这样的路径可能有无数种，请你输出任意一种，并保证所需移动次数不超过 $100000$。", "inputFormat": "第一行两个整数 $r,c$。\n \n接下来 $r$ 行，每行 $c$ 个字符，表示 Bessie 能否通过相应位置的区域。字符只可能是 `.` 或 `*`。\n\n- `.` 表示 Bessie 可以通过该区域。\n- `*` 表示 Bessie 无法通过该区域。", "outputFormat": "若干行，每行包含两个用空格隔开的整数，表示 Bessie 依次通过的区域的坐标。\n\n显然，输出的第一行是 `1 1` ，最后一行是 `r c`。\n\n相邻的两个坐标所表示的区域必须相邻。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le r\\le 113$，$1\\le c\\le 77$。\n\n------------\n\n**【样例说明】* *\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3gsutffb.png)\n\n图为样例输出的示意图。答案不唯一。", "locale": "zh-CN"}}}
{"pid": "P6208", "type": "P", "difficulty": 3, "samples": [["3 7\n6 5 3 7 9 2 7\n2 4 3 5 6 8 6\n4 9 9 9 1 5 8", "50"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2006", "USACO"], "title": "[USACO06OCT] Cow Pie Treasures G", "background": "", "description": "奶牛们制作了一些藏有金币的馅饼，并把它们排成了一个 $r$ 行 $c$ 列的矩阵。现在，你需要从坐标为 $(1,1)$ 的馅饼旁移动到坐标为 $(r,c)$ 的馅饼旁。对于每次移动，你必须向右移动一列，并且行数的变动不能超过 $1$。即如果你处于坐标为 $(x,y)$ 的馅饼旁，你只能移动到坐标为 $(x-1,y+1)$，$(x,y+1)$ 或 $(x+1,y+1)$ 的馅饼旁。在一个馅饼旁停留时，你可以拿走其中所有的金币。当然，你一定不愿意中途离开矩阵而放弃这些金币。\n\n奶牛们把标有矩阵中每一块馅饼所藏金币数的表格交给了你。你想知道按照以上规则，自己最多能拿到多少金币。", "inputFormat": "第一行两个整数 $r,c$。\n \n接下来 $r$ 行，每行 $c$ 个整数，表示矩阵中每一块馅饼所藏金币数 $t$。\n", "outputFormat": "一行，一个整数，表示你能拿到的最大金币数。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le r,c\\le 100$，$1\\le t\\le 25$。\n\n------------\n\n**【样例说明】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pgw19uqm.png)\n\n样例给出的矩阵如图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/hwhzq9oy.png)\n\n这是一种合法的移动方式。你可以拿到 $47$ 枚金币。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/sdyxlpv5.png)\n\n在这个矩阵中你最多能拿到 $50$ 枚金币，路线如图所示。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO06OCT] Cow Pie Treasures G", "background": "", "description": "奶牛们制作了一些藏有金币的馅饼，并把它们排成了一个 $r$ 行 $c$ 列的矩阵。现在，你需要从坐标为 $(1,1)$ 的馅饼旁移动到坐标为 $(r,c)$ 的馅饼旁。对于每次移动，你必须向右移动一列，并且行数的变动不能超过 $1$。即如果你处于坐标为 $(x,y)$ 的馅饼旁，你只能移动到坐标为 $(x-1,y+1)$，$(x,y+1)$ 或 $(x+1,y+1)$ 的馅饼旁。在一个馅饼旁停留时，你可以拿走其中所有的金币。当然，你一定不愿意中途离开矩阵而放弃这些金币。\n\n奶牛们把标有矩阵中每一块馅饼所藏金币数的表格交给了你。你想知道按照以上规则，自己最多能拿到多少金币。", "inputFormat": "第一行两个整数 $r,c$。\n \n接下来 $r$ 行，每行 $c$ 个整数，表示矩阵中每一块馅饼所藏金币数 $t$。\n", "outputFormat": "一行，一个整数，表示你能拿到的最大金币数。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le r,c\\le 100$，$1\\le t\\le 25$。\n\n------------\n\n**【样例说明】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pgw19uqm.png)\n\n样例给出的矩阵如图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/hwhzq9oy.png)\n\n这是一种合法的移动方式。你可以拿到 $47$ 枚金币。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/sdyxlpv5.png)\n\n在这个矩阵中你最多能拿到 $50$ 枚金币，路线如图所示。", "locale": "zh-CN"}}}
{"pid": "P6209", "type": "P", "difficulty": 2, "samples": [["1\n1\n", "1"], ["2\n233 23333\n", "23566"], ["3\n345 379 573\n", "2317"], ["4\n1234 567 89 10\n", "4000"], ["5\n19111010 19260817 19371213 19491001 20200110\n", "239635161"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟"], "title": "「SWTR-4」Calculating Machine", "background": "小 E 在用自己的 Calculating Machine 计算 $n$ 个**十进制**数 $a_1,a_2,\\cdots,a_n$ 的和。\n\n", "description": "小 E 计算几个数的和的方式为：\n\n- 如果参与运算的数不止 $2$ 个，那么**从左往右**依次计算。\n\n- 若两个数的位数不同，则位数少的数自动在前面补前导零，直到两数位数相同。\n\n- 从两个数的最低位开始，计算当前位两个数码的和加上前一位的进位，写上这个和除以 $10$ 的余数。\n\n- 进位规则：如果当前位两个数码的和加上前一位的进位小于 $7$，不进位；如果和大于等于 $7$ 且小于等于 $13$，则进一位；否则进两位。\n\n例如：$2+4=6$，$7+8=25$，$61+6=177$，$38+169=217$，$3+900=1903$。\n\n由于小 E 的计算机器被 360 安全病毒当成病毒杀死了，所以他想请你帮忙求出 $a_1+a_2+\\dots+a_n$。", "inputFormat": "第一行，一个整数 $n$ —— 表示参与运算的数的个数。\n\n第二行，$n$ 个整数，$a_1,a_2,\\cdots,a_n$ —— 表示从左往右所有参与运算的数，你也可以理解为 $a_i$ 在 $a_{i+1}$ 的左边。", "outputFormat": "一行一个整数 —— 表示 $a_1+a_2+\\cdots+a_n$。", "hint": "【样例 $3$ 说明】\n\n$345+379+573=1734+573=2317$。\n\n【样例 $4$ 说明】\n\n$1234+567+89+10=2801+89+10=3990+10=4000$。\n\n【数据范围与约定】\n\n对于 $10\\%$ 的数据，$n=1$。\n\n对于 $30\\%$ 的数据，$n \\leq 2$。\n\n对于 $60\\%$ 的数据，$n \\leq 10$，$a_i \\leq 10^5$。\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 2020$，$0 \\leq a_i \\leq 10^9$。\n\n【Source】\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $A\n\nidea：[ET2006](https://www.luogu.com.cn/user/115194)，std：[Alex_Wei](https://www.luogu.com.cn/user/123294)，验题：[Isaunoya](https://www.luogu.com.cn/user/96580) & [FrenkiedeJong21](https://www.luogu.com.cn/user/203968) & [chenxia25](https://www.luogu.com.cn/user/138400)", "locale": "zh-CN", "translations": {"en": {"title": "“SWTR-4” Calculating Machine", "background": "Little E is using his own Calculating Machine to compute the sum of $n$ **decimal** numbers $a_1,a_2,\\cdots,a_n$.", "description": "The way Little E computes the sum of several numbers is:\n\n- If there are more than $2$ numbers in the operation, compute **from left to right** in order.\n\n- If the two numbers have different lengths, the shorter one is automatically padded with leading zeros until the two numbers have the same length.\n\n- Starting from the least significant digit of the two numbers, compute the sum of the two digits at the current position plus the carry from the previous position, and write down the remainder of this sum divided by $10$.\n\n- Carry rule: if the sum of the two digits at the current position plus the carry from the previous position is less than $7$, do not carry; if the sum is greater than or equal to $7$ and less than or equal to $13$, carry $1$; otherwise, carry $2$.\n\nFor example: $2+4=6$, $7+8=25$, $61+6=177$, $38+169=217$, $3+900=1903$.\n\nBecause Little E’s calculating machine was killed by 360 Security as a virus, he wants you to help compute $a_1+a_2+\\dots+a_n$.", "inputFormat": "The first line contains an integer $n$ — the number of numbers involved in the operation.\n\nThe second line contains $n$ integers $a_1,a_2,\\cdots,a_n$ — all numbers involved in the operation from left to right. You can also understand this as $a_i$ is to the left of $a_{i+1}$.", "outputFormat": "Output one integer in one line — the value of $a_1+a_2+\\cdots+a_n$.", "hint": "[Sample $3$ Explanation]\n\n$345+379+573=1734+573=2317$.\n\n[Sample $4$ Explanation]\n\n$1234+567+89+10=2801+89+10=3990+10=4000$.\n\n[Constraints and Notes]\n\nFor $10\\%$ of the testdata, $n=1$.\n\nFor $30\\%$ of the testdata, $n \\leq 2$.\n\nFor $60\\%$ of the testdata, $n \\leq 10$, $a_i \\leq 10^5$.\n\nFor $100\\%$ of the testdata, $1 \\leq n \\leq 2020$, $0 \\leq a_i \\leq 10^9$.\n\n[Source]\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $A\n\nidea: [ET2006](https://www.luogu.com.cn/user/115194), std: [Alex_Wei](https://www.luogu.com.cn/user/123294), problem checking: [Isaunoya](https://www.luogu.com.cn/user/96580) & [FrenkiedeJong21](https://www.luogu.com.cn/user/203968) & [chenxia25](https://www.luogu.com.cn/user/138400)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「SWTR-4」Calculating Machine", "background": "小 E 在用自己的 Calculating Machine 计算 $n$ 个**十进制**数 $a_1,a_2,\\cdots,a_n$ 的和。\n\n", "description": "小 E 计算几个数的和的方式为：\n\n- 如果参与运算的数不止 $2$ 个，那么**从左往右**依次计算。\n\n- 若两个数的位数不同，则位数少的数自动在前面补前导零，直到两数位数相同。\n\n- 从两个数的最低位开始，计算当前位两个数码的和加上前一位的进位，写上这个和除以 $10$ 的余数。\n\n- 进位规则：如果当前位两个数码的和加上前一位的进位小于 $7$，不进位；如果和大于等于 $7$ 且小于等于 $13$，则进一位；否则进两位。\n\n例如：$2+4=6$，$7+8=25$，$61+6=177$，$38+169=217$，$3+900=1903$。\n\n由于小 E 的计算机器被 360 安全病毒当成病毒杀死了，所以他想请你帮忙求出 $a_1+a_2+\\dots+a_n$。", "inputFormat": "第一行，一个整数 $n$ —— 表示参与运算的数的个数。\n\n第二行，$n$ 个整数，$a_1,a_2,\\cdots,a_n$ —— 表示从左往右所有参与运算的数，你也可以理解为 $a_i$ 在 $a_{i+1}$ 的左边。", "outputFormat": "一行一个整数 —— 表示 $a_1+a_2+\\cdots+a_n$。", "hint": "【样例 $3$ 说明】\n\n$345+379+573=1734+573=2317$。\n\n【样例 $4$ 说明】\n\n$1234+567+89+10=2801+89+10=3990+10=4000$。\n\n【数据范围与约定】\n\n对于 $10\\%$ 的数据，$n=1$。\n\n对于 $30\\%$ 的数据，$n \\leq 2$。\n\n对于 $60\\%$ 的数据，$n \\leq 10$，$a_i \\leq 10^5$。\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 2020$，$0 \\leq a_i \\leq 10^9$。\n\n【Source】\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $A\n\nidea：[ET2006](https://www.luogu.com.cn/user/115194)，std：[Alex_Wei](https://www.luogu.com.cn/user/123294)，验题：[Isaunoya](https://www.luogu.com.cn/user/96580) & [FrenkiedeJong21](https://www.luogu.com.cn/user/203968) & [chenxia25](https://www.luogu.com.cn/user/138400)", "locale": "zh-CN"}}}
{"pid": "P6210", "type": "P", "difficulty": 5, "samples": [["12 3 8 10 17\n", "11\n6"], ["72 5 66 13 89\n", "94\n54"], ["360360 123 20200202 123456789 987654321\n", "21751721\n802555475"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "高精度", "莫比乌斯反演"], "title": "「SWTR-4」Easy Math Problems", "background": "数学老师给小 A 布置了 $2$ 道 Easy Math Problems。", "description": "给定 $n,c,f,l,r$，有集合 $S=\\{x\\in\\mathbb{N_+}\\mid\\gcd(x,n)\\leq c\\}$ 和集合 $Q=\\{x\\in S\\mid l\\leq x\\leq r\\}$。\n\n- 集合 $S$ 为所有与 $n$ 的 $\\gcd$ 不超过 $c$ 的正整数，集合 $Q$ 为 $S$ 中不小于 $l$，不大于 $r$ 的数。\n\n第一问：请求出集合 $S$ 中第 $f$ 小的数。\n\n第二问：请求出集合 $Q$ 中包含的元素个数。\n\n由于数字很大，所以小 A 想请你帮他求出问题的答案。", "inputFormat": "一行五个整数 $n,c,f,l,r$ —— 意义见题目描述。", "outputFormat": "输出两行整数 —— 第一行为第一问的答案，第二行为第二问的答案。", "hint": "【样例 $1$ 说明】\n\n$S=\\{1,2,3,5,7,9,10,11,13,14,15,17,\\dots\\},Q=\\{10,11,13,14,15,17\\}$，可知集合 $S$ 第 $8$ 小的数为 $11$，集合 $Q$ 中包含的元素个数为 $6$。\n\n【数据范围与约定】\n\n**本题使用捆绑测试**。\n\n子任务 $1(15\\%)$：$n\\leq 10^3$，$r\\leq 10^3$，$f\\leq 10^3$。\n\n子任务 $2(35\\%)$：$n\\leq 10^5$，$r\\leq 10^5$，$f\\leq 10^5$。\n\n子任务 $3(35\\%)$：$n\\leq 10^6$，$r\\leq 10^{12}$，$f\\leq 10^{12}$。\n\n子任务 $4(15\\%)$：$n\\leq 10^7$，$r\\leq 10^{10^5}$，$f\\leq 10^{10^5}$。\n\n对于 $100\\%$ 的数据，$1\\leq c\\leq n\\leq 10^7$，$1\\leq l\\leq r\\leq 10^{10^5}$，$1\\leq f\\leq 10^{10^5}$。\n\n【Tips】\n\n想用 $n\\log n$ 过这道题？\n\n【时间限制】\n\n对于前 $3$ 个子任务，时间限制 $1\\rm{s}$，剩下一个子任务 $500\\rm{ms}$。\n\n【Source】\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $B\n\nidea & std：[Alex_Wei](https://www.luogu.com.cn/user/123294)，验题：[xtx1092515503](https://www.luogu.com.cn/user/123369) & [FrenkiedeJong21](https://www.luogu.com.cn/user/203968) & [chenxia25](https://www.luogu.com.cn/user/138400)", "locale": "zh-CN", "translations": {"en": {"title": "\"SWTR-4\" Easy Math Problems", "background": "The math teacher assigned Little A $2$ Easy Math Problems.", "description": "Given $n,c,f,l,r$, define the set $S=\\{x\\in\\mathbb{N_+}\\mid\\gcd(x,n)\\leq c\\}$ and the set $Q=\\{x\\in S\\mid l\\leq x\\leq r\\}$.\n\n- Set $S$ contains all positive integers whose $\\gcd$ with $n$ is at most $c$, and set $Q$ contains the elements in $S$ that are not less than $l$ and not greater than $r$.\n\nQuestion 1: Find the $f$-th smallest number in set $S$.\n\nQuestion 2: Find the number of elements in set $Q$.\n\nSince the numbers are very large, Little A wants you to help compute the answers.", "inputFormat": "A single line with five integers $n,c,f,l,r$ — with meanings as described in the statement.", "outputFormat": "Output two lines of integers — the first line is the answer to Question 1, and the second line is the answer to Question 2.", "hint": "[Sample $1$ Explanation]\n\n$S=\\{1,2,3,5,7,9,10,11,13,14,15,17,\\dots\\},Q=\\{10,11,13,14,15,17\\}$. It can be seen that the $8$-th smallest number in $S$ is $11$, and the number of elements in $Q$ is $6$.\n\n[Constraints and Notes]\n\n**This problem uses bundled tests.**\n\nSubtask $1(15\\%)$: $n\\leq 10^3$, $r\\leq 10^3$, $f\\leq 10^3$.\n\nSubtask $2(35\\%)$: $n\\leq 10^5$, $r\\leq 10^5$, $f\\leq 10^5$.\n\nSubtask $3(35\\%)$: $n\\leq 10^6$, $r\\leq 10^{12}$, $f\\leq 10^{12}$.\n\nSubtask $4(15\\%)$: $n\\leq 10^7$, $r\\leq 10^{10^5}$, $f\\leq 10^{10^5}$.\n\nFor $100\\%$ of the testdata, $1\\leq c\\leq n\\leq 10^7$, $1\\leq l\\leq r\\leq 10^{10^5}$, $1\\leq f\\leq 10^{10^5}$.\n\n[Tips]\n\nWant to solve this problem with $n\\log n$?\n\n[Time Limit]\n\nFor the first $3$ subtasks, the time limit is $1\\rm{s}$, and for the remaining subtask it is $500\\rm{ms}$.\n\n[Source]\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $B\n\nidea & std: [Alex_Wei](https://www.luogu.com.cn/user/123294), verification: [xtx1092515503](https://www.luogu.com.cn/user/123369) & [FrenkiedeJong21](https://www.luogu.com.cn/user/203968) & [chenxia25](https://www.luogu.com.cn/user/138400)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「SWTR-4」Easy Math Problems", "background": "数学老师给小 A 布置了 $2$ 道 Easy Math Problems。", "description": "给定 $n,c,f,l,r$，有集合 $S=\\{x\\in\\mathbb{N_+}\\mid\\gcd(x,n)\\leq c\\}$ 和集合 $Q=\\{x\\in S\\mid l\\leq x\\leq r\\}$。\n\n- 集合 $S$ 为所有与 $n$ 的 $\\gcd$ 不超过 $c$ 的正整数，集合 $Q$ 为 $S$ 中不小于 $l$，不大于 $r$ 的数。\n\n第一问：请求出集合 $S$ 中第 $f$ 小的数。\n\n第二问：请求出集合 $Q$ 中包含的元素个数。\n\n由于数字很大，所以小 A 想请你帮他求出问题的答案。", "inputFormat": "一行五个整数 $n,c,f,l,r$ —— 意义见题目描述。", "outputFormat": "输出两行整数 —— 第一行为第一问的答案，第二行为第二问的答案。", "hint": "【样例 $1$ 说明】\n\n$S=\\{1,2,3,5,7,9,10,11,13,14,15,17,\\dots\\},Q=\\{10,11,13,14,15,17\\}$，可知集合 $S$ 第 $8$ 小的数为 $11$，集合 $Q$ 中包含的元素个数为 $6$。\n\n【数据范围与约定】\n\n**本题使用捆绑测试**。\n\n子任务 $1(15\\%)$：$n\\leq 10^3$，$r\\leq 10^3$，$f\\leq 10^3$。\n\n子任务 $2(35\\%)$：$n\\leq 10^5$，$r\\leq 10^5$，$f\\leq 10^5$。\n\n子任务 $3(35\\%)$：$n\\leq 10^6$，$r\\leq 10^{12}$，$f\\leq 10^{12}$。\n\n子任务 $4(15\\%)$：$n\\leq 10^7$，$r\\leq 10^{10^5}$，$f\\leq 10^{10^5}$。\n\n对于 $100\\%$ 的数据，$1\\leq c\\leq n\\leq 10^7$，$1\\leq l\\leq r\\leq 10^{10^5}$，$1\\leq f\\leq 10^{10^5}$。\n\n【Tips】\n\n想用 $n\\log n$ 过这道题？\n\n【时间限制】\n\n对于前 $3$ 个子任务，时间限制 $1\\rm{s}$，剩下一个子任务 $500\\rm{ms}$。\n\n【Source】\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $B\n\nidea & std：[Alex_Wei](https://www.luogu.com.cn/user/123294)，验题：[xtx1092515503](https://www.luogu.com.cn/user/123369) & [FrenkiedeJong21](https://www.luogu.com.cn/user/203968) & [chenxia25](https://www.luogu.com.cn/user/138400)", "locale": "zh-CN"}}}
{"pid": "P6211", "type": "P", "difficulty": 3, "samples": [["2\n-2 1\n1 1", "3"], ["3\n-3 0 4\n2 3 4", "999999997"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "「SWTR-4」Meeting in the Forest", "background": "每当月圆时分，五个族群的族猫们都会聚集在小岛上，进行每月的森林大会。蒟星为了了解其它五族猫的特点，就扮成了一只独行猫来到小岛上……", "description": "森林大会上有 $n$ 只猫，每只猫的武力值为 $a_i$，于是蒟星列出了下面这样一个方程：\n\n$$x^n+\\sum_{i=1}^{n}a_ix^{n-i}=0$$\n\n- 通俗地讲，这个方程就是 $x^n+a_1x^{n-1}+a_2x^{n-2}+\\cdots+a_{n-1}x+a_n=0$。\n\n蒟星根据 TA 优（cu）秀（bi）的数学知识可以知道，这个方程在复数集内有 $n$ 个根，不妨把这 $n$ 个根设为 $x_1, x_2, ..., x_n$。\n\n接下来蒟星想要知道森林大会上的猫的实力如何，于是列出了下面一个表达式：\n\n$$\\sum_{i=1}^{n}(b_i\\times \\sum_{1\\le j_1 < j_2 <\\cdots< j_i \\le n}^{n}x_{j_1}x_{j_2}\\cdots x_{j_i})$$\n\n- $\\sum_{1\\le j_1 < j_2 < \\cdots < j_i \\le n}^{n}x_{j_1}x_{j_2}\\cdots x_{j_i}$ 就是从方程的 $n$ 个根中选出 $i$ 个，求所有可能方案的 $i$ 个根的乘积之和。\n\n但蒟星只要这个表达式对 $10^9+7$ 取模后的值就好了。\n\n- 若答案为负数 $a$，请输出 $a + (10^9+7)$。\n\n蒟星把这个任务交给了您，不过他已经告诉你了 $n$，$a_i$ 和 $b_i$，您能帮帮 TA 吗？", "inputFormat": "第一行一个整数 $n$ —— 表示方程的次数。\n\n第二行 $n$ 个整数 $a_1, a_2, ... a_n$ —— 意义见题目描述。\n\n第三行 $n$ 个整数 $b_1, b_2, ... b_n$ —— 同上。", "outputFormat": "输出一行，一个数，表示这个表达式对 $10^9+7$ 取模后的值。", "hint": "【样例 $1$ 说明】\n\n原方程为 $x^2-2x+1=0$，此时 $x_1=x_2=1$。\n\n表达式的值为 $x_1+x_2+x_1x_2=1+1+1=3$。\n\n【样例 $2$ 说明】\n\n原方程为 $x^3-3x^2+4=0$，此时 $x_1=-1,x_2=x_3=2$。\n\n表达式的值为 \n\n$$\\begin{aligned}&2\\cdot (x_1+x_2+x_3)+3\\cdot(x_1x_2+x_1x_3+x_2x_3)+4\\cdot x_1x_2x_3\\\\=\\ &2\\times(-1+2+2)+3\\times(-2+(-2)+4)+4\\times (-4)\\\\=\\ &-10\\end{aligned}$$\n\n因为 $-10$ 为负数，所以输出 $-10+(10^9+7)=999999997$。\n\n【数据范围与约定】\n\n对于 $10\\%$ 的数据，$n=1$。\n\n对于另外 $20\\%$ 的数据，$n=2$。\n\n对于 $40\\%$ 的数据，$n\\leq 10$。\n\n对于 $60\\%$ 的数据，$n\\leq 10^3$。\n\n对于 $100\\%$ 的数据，$1\\leq n \\le 2 \\times 10^5$，$-10^9 \\le a_i, b_i \\le 10^9$。\n\n【Tips】\n\n[韦达定理](https://baike.baidu.com/item/%E9%9F%A6%E8%BE%BE%E5%AE%9A%E7%90%86/105027?fr=aladdin)也许会对你有帮助。\n\n【Source】\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $C\n\nidea & std：[蒟蒻的名字](https://www.luogu.com.cn/user/147999)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「SWTR-4」Meeting in the Forest", "background": "每当月圆时分，五个族群的族猫们都会聚集在小岛上，进行每月的森林大会。蒟星为了了解其它五族猫的特点，就扮成了一只独行猫来到小岛上……", "description": "森林大会上有 $n$ 只猫，每只猫的武力值为 $a_i$，于是蒟星列出了下面这样一个方程：\n\n$$x^n+\\sum_{i=1}^{n}a_ix^{n-i}=0$$\n\n- 通俗地讲，这个方程就是 $x^n+a_1x^{n-1}+a_2x^{n-2}+\\cdots+a_{n-1}x+a_n=0$。\n\n蒟星根据 TA 优（cu）秀（bi）的数学知识可以知道，这个方程在复数集内有 $n$ 个根，不妨把这 $n$ 个根设为 $x_1, x_2, ..., x_n$。\n\n接下来蒟星想要知道森林大会上的猫的实力如何，于是列出了下面一个表达式：\n\n$$\\sum_{i=1}^{n}(b_i\\times \\sum_{1\\le j_1 < j_2 <\\cdots< j_i \\le n}^{n}x_{j_1}x_{j_2}\\cdots x_{j_i})$$\n\n- $\\sum_{1\\le j_1 < j_2 < \\cdots < j_i \\le n}^{n}x_{j_1}x_{j_2}\\cdots x_{j_i}$ 就是从方程的 $n$ 个根中选出 $i$ 个，求所有可能方案的 $i$ 个根的乘积之和。\n\n但蒟星只要这个表达式对 $10^9+7$ 取模后的值就好了。\n\n- 若答案为负数 $a$，请输出 $a + (10^9+7)$。\n\n蒟星把这个任务交给了您，不过他已经告诉你了 $n$，$a_i$ 和 $b_i$，您能帮帮 TA 吗？", "inputFormat": "第一行一个整数 $n$ —— 表示方程的次数。\n\n第二行 $n$ 个整数 $a_1, a_2, ... a_n$ —— 意义见题目描述。\n\n第三行 $n$ 个整数 $b_1, b_2, ... b_n$ —— 同上。", "outputFormat": "输出一行，一个数，表示这个表达式对 $10^9+7$ 取模后的值。", "hint": "【样例 $1$ 说明】\n\n原方程为 $x^2-2x+1=0$，此时 $x_1=x_2=1$。\n\n表达式的值为 $x_1+x_2+x_1x_2=1+1+1=3$。\n\n【样例 $2$ 说明】\n\n原方程为 $x^3-3x^2+4=0$，此时 $x_1=-1,x_2=x_3=2$。\n\n表达式的值为 \n\n$$\\begin{aligned}&2\\cdot (x_1+x_2+x_3)+3\\cdot(x_1x_2+x_1x_3+x_2x_3)+4\\cdot x_1x_2x_3\\\\=\\ &2\\times(-1+2+2)+3\\times(-2+(-2)+4)+4\\times (-4)\\\\=\\ &-10\\end{aligned}$$\n\n因为 $-10$ 为负数，所以输出 $-10+(10^9+7)=999999997$。\n\n【数据范围与约定】\n\n对于 $10\\%$ 的数据，$n=1$。\n\n对于另外 $20\\%$ 的数据，$n=2$。\n\n对于 $40\\%$ 的数据，$n\\leq 10$。\n\n对于 $60\\%$ 的数据，$n\\leq 10^3$。\n\n对于 $100\\%$ 的数据，$1\\leq n \\le 2 \\times 10^5$，$-10^9 \\le a_i, b_i \\le 10^9$。\n\n【Tips】\n\n[韦达定理](https://baike.baidu.com/item/%E9%9F%A6%E8%BE%BE%E5%AE%9A%E7%90%86/105027?fr=aladdin)也许会对你有帮助。\n\n【Source】\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $C\n\nidea & std：[蒟蒻的名字](https://www.luogu.com.cn/user/147999)", "locale": "zh-CN"}}}
{"pid": "P6212", "type": "P", "difficulty": 5, "samples": [["3 1 2 1\nBG?\n", "500000004"], ["3 -1 4 3\n???\n", "750000006"], ["5 5 7 3\nG??B?\n", "625000005"], ["6 10 9 4\n??GB??\n", "937500007"], ["20 20 15 10\nB?G?B?G?????BBBG?GG?\n", "78125001"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192]}, "tags": ["动态规划 DP"], "title": "「SWTR-4」Lining up", "background": "作为班长的小 S 在指挥操场上的一群同学排队，Lining up 可不是一件容易的事情。", "description": "操场上有排成一列的 $n$ 个同学，每个同学要么是男生，用 ```B``` 表示；要么是女生，用 ```G``` 表示。\n\n我们定义两个相邻的同学的满意度如下：\n\n- 如果两个相邻的同学的性别相同，那么就会像普通同学一样聊天，产生 $0$ 点满意度。\n\n- 如果前面的同学是男生，后面的同学是女生，那么就不会有任何事件发生。同学们都很活跃，他们不希望这么无聊，产生 $-b$ 点满意度。\n\n- 如果前面的同学是女生，后面的同学是男生，那么他们就会聊得很开心，产生 $a$ 点满意度。\n\n由于小 S 是近视眼，所以他无法分辨有些同学的性别，用 ```?``` 表示。\n\n为了提高自己在大家心目中的地位，小 S 想保证所有相邻同学的满意度之和不小于 $m$。\n\n他想知道满足“所有相邻同学的满意度之和不小于 $m$”的概率是多少，对 $10^9+7$ 取模。", "inputFormat": "第一行，四个整数 $n,m,a,b$ —— 意义见题目描述。\n\n第二行，一个长度为 $n$ 的字符串 $s$ 表示队列 —— 第 $i$ 个字符表示**从前往后**数第 $i$ 位同学。", "outputFormat": "一行，表示概率。", "hint": "【样例 $1$ 说明】\n\n共有 $1$ 个满足题意的队形 $\\tt BGB$。概率为 $\\frac{1}{2} \\bmod (10^9+7)=500000004$。\n\n【样例 $2$ 说明】\n\n共有 $6$ 个满足题意的队形 $\\tt BBB,BGB,GBB,GBG,GGB,GGG$。概率为 $\\frac{6}{8} \\bmod (10^9+7)=750000006$。\n\n【样例 $5$ 说明】\n\n真实答案为 $\\dfrac{29}{64}$。\n\n【数据范围与约定】\n\n**本题使用捆绑测试。**\n\nSubtask 编号 | $n\\leq$ | 特殊性质 | 分数\n:-: | :-: | :-: | :-:\n$1$ | $2020$ | 没有```?``` | $8$\n$2$ | $20$ | 无 | $17$\n$3$ | $250$ | 无 | $29$\n$4$ | $2020$ | $a=1,b=1$ | $10$\n$5$ | $2020$ | 无 | $36$\n\n对于全部数据，$2 \\leq n \\leq 2020$，$1 \\leq |m| \\leq 10^{12}$，$1 \\leq a,b \\leq 10^9$，$s_i \\in \\tt{\\{B,G,?\\}}$。\n\n**请注意特殊的空间限制。**\n\n【Tips】\n\n如果你不会对分数取模，可以看看[这里](https://www.luogu.com.cn/problem/P2613)。\n\n【Source】\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $D\n\nidea：[ET2006](https://www.luogu.com.cn/user/115194)，std：[Isaunoya](https://www.luogu.com.cn/user/96580)，验题：[Isaunoya](https://www.luogu.com.cn/user/96580) & [FrenkiedeJong21](https://www.luogu.com.cn/user/203968) & [chenxia25](https://www.luogu.com.cn/user/138400)", "locale": "zh-CN", "translations": {"en": {"title": "\"SWTR-4\" Lining up", "background": "As the class monitor, Little S is directing a group of classmates to line up on the playground. Lining up is not an easy task.", "description": "There are $n$ students standing in a single line on the playground. Each student is either a boy, denoted by ```B```, or a girl, denoted by ```G```.\n\nWe define the satisfaction of two adjacent students as follows:\n\n- If the two adjacent students have the same gender, then they chat like ordinary classmates, producing $0$ satisfaction.\n\n- If the student in front is a boy and the one behind is a girl, then nothing happens. The students are very active and do not want it to be so boring, producing $-b$ satisfaction.\n\n- If the student in front is a girl and the one behind is a boy, then they chat very happily, producing $a$ satisfaction.\n\nSince Little S is nearsighted, he cannot tell the gender of some students, denoted by ```?```.\n\nTo improve his status in everyone’s eyes, Little S wants to ensure that the sum of satisfaction over all adjacent pairs is at least $m$.\n\nHe wants to know the probability that the condition “the sum of satisfaction over all adjacent pairs is at least $m$” holds, modulo $10^9+7$.", "inputFormat": "The first line contains four integers $n, m, a, b$ — as described in the statement.\n\nThe second line contains a string $s$ of length $n$ representing the line — the $i$-th character represents the $i$-th student **from front to back**.", "outputFormat": "Output one line containing the probability.", "hint": "[Sample $1$ Explanation]\n\nThere is $1$ lineup that satisfies the condition: $\\tt BGB$. The probability is $\\frac{1}{2} \\bmod (10^9+7)=500000004$.\n\n[Sample $2$ Explanation]\n\nThere are $6$ lineups that satisfy the condition: $\\tt BBB,BGB,GBB,GBG,GGB,GGG$. The probability is $\\frac{6}{8} \\bmod (10^9+7)=750000006$.\n\n[Sample $5$ Explanation]\n\nThe actual answer is $\\dfrac{29}{64}$.\n\n[Constraints and Notes]\n\n**This problem uses bundled testdata.**\n\nSubtask ID | $n\\leq$ | Special property | Score\n:-: | :-: | :-: | :-:\n$1$ | $2020$ | No ```?``` | $8$\n$2$ | $20$ | None | $17$\n$3$ | $250$ | None | $29$\n$4$ | $2020$ | $a=1,b=1$ | $10$\n$5$ | $2020$ | None | $36$\n\nFor all testdata: $2 \\leq n \\leq 2020$, $1 \\leq |m| \\leq 10^{12}$, $1 \\leq a,b \\leq 10^9$, $s_i \\in \\tt{\\{B,G,?\\}}$.\n\n**Please note the special memory limit.**\n\n[Tips]\n\nIf you do not know how to take a fraction modulo, you can read [here](https://www.luogu.com.cn/problem/P2613).\n\n[Source]\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $D\n\nidea: [ET2006](https://www.luogu.com.cn/user/115194), std: [Isaunoya](https://www.luogu.com.cn/user/96580), validator: [Isaunoya](https://www.luogu.com.cn/user/96580) & [FrenkiedeJong21](https://www.luogu.com.cn/user/203968) & [chenxia25](https://www.luogu.com.cn/user/138400)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「SWTR-4」Lining up", "background": "作为班长的小 S 在指挥操场上的一群同学排队，Lining up 可不是一件容易的事情。", "description": "操场上有排成一列的 $n$ 个同学，每个同学要么是男生，用 ```B``` 表示；要么是女生，用 ```G``` 表示。\n\n我们定义两个相邻的同学的满意度如下：\n\n- 如果两个相邻的同学的性别相同，那么就会像普通同学一样聊天，产生 $0$ 点满意度。\n\n- 如果前面的同学是男生，后面的同学是女生，那么就不会有任何事件发生。同学们都很活跃，他们不希望这么无聊，产生 $-b$ 点满意度。\n\n- 如果前面的同学是女生，后面的同学是男生，那么他们就会聊得很开心，产生 $a$ 点满意度。\n\n由于小 S 是近视眼，所以他无法分辨有些同学的性别，用 ```?``` 表示。\n\n为了提高自己在大家心目中的地位，小 S 想保证所有相邻同学的满意度之和不小于 $m$。\n\n他想知道满足“所有相邻同学的满意度之和不小于 $m$”的概率是多少，对 $10^9+7$ 取模。", "inputFormat": "第一行，四个整数 $n,m,a,b$ —— 意义见题目描述。\n\n第二行，一个长度为 $n$ 的字符串 $s$ 表示队列 —— 第 $i$ 个字符表示**从前往后**数第 $i$ 位同学。", "outputFormat": "一行，表示概率。", "hint": "【样例 $1$ 说明】\n\n共有 $1$ 个满足题意的队形 $\\tt BGB$。概率为 $\\frac{1}{2} \\bmod (10^9+7)=500000004$。\n\n【样例 $2$ 说明】\n\n共有 $6$ 个满足题意的队形 $\\tt BBB,BGB,GBB,GBG,GGB,GGG$。概率为 $\\frac{6}{8} \\bmod (10^9+7)=750000006$。\n\n【样例 $5$ 说明】\n\n真实答案为 $\\dfrac{29}{64}$。\n\n【数据范围与约定】\n\n**本题使用捆绑测试。**\n\nSubtask 编号 | $n\\leq$ | 特殊性质 | 分数\n:-: | :-: | :-: | :-:\n$1$ | $2020$ | 没有```?``` | $8$\n$2$ | $20$ | 无 | $17$\n$3$ | $250$ | 无 | $29$\n$4$ | $2020$ | $a=1,b=1$ | $10$\n$5$ | $2020$ | 无 | $36$\n\n对于全部数据，$2 \\leq n \\leq 2020$，$1 \\leq |m| \\leq 10^{12}$，$1 \\leq a,b \\leq 10^9$，$s_i \\in \\tt{\\{B,G,?\\}}$。\n\n**请注意特殊的空间限制。**\n\n【Tips】\n\n如果你不会对分数取模，可以看看[这里](https://www.luogu.com.cn/problem/P2613)。\n\n【Source】\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $D\n\nidea：[ET2006](https://www.luogu.com.cn/user/115194)，std：[Isaunoya](https://www.luogu.com.cn/user/96580)，验题：[Isaunoya](https://www.luogu.com.cn/user/96580) & [FrenkiedeJong21](https://www.luogu.com.cn/user/203968) & [chenxia25](https://www.luogu.com.cn/user/138400)", "locale": "zh-CN"}}}
{"pid": "P6213", "type": "P", "difficulty": 6, "samples": [["6 4\n1 2 3\n2 3 4\n2 4 5\n3 5 2\n3 6 3\n1 2 1 1 2 2\n", "5"], ["6 4\n1 2 3\n2 3 4\n2 4 5\n3 5 2\n3 6 3\n1 1 1 1 1 1\n", "0"], ["6 4\n1 2 3\n2 3 4\n2 4 5\n3 5 2\n3 6 3\n2 2 2 2 2 2\n", "12"], ["12 6\n1 4 33\n2 11 51\n3 9 100\n4 8 7\n5 9 35\n6 12 30\n7 11 58\n8 10 65\n9 10 59\n10 12 9\n11 12 72\n2 2 2 3 2 1 2 1 2 3 2 2\n", "263"]], "limits": {"time": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "树形 DP"], "title": "「SWTR-4」Collecting Coins", "background": "小 A 喜欢 Collecting Coins。他还有个好朋友叫做小 c。\n\n小 c 在外出游玩的时候被困在了一个迷宫里面，小 A 得知消息后，立刻放下了自己手中正在打的树套树套树套树，出发去营救她。", "description": "经过一番勘察，小 A 发现小 c 被困的迷宫由 $n$ 个房间组成，这些房间用 $n-1$ 扇门连接，**形成了一颗树**。小 c 被困在 $d$ 号房间。\n\n小 A 还发现每扇门上都写有一个数字 $v$，经过该扇门就会获得 $v$ 个金币，但每扇门上的金币只能获得一次。\n\n由于把小 c 困在迷宫里的坏人早已知道小 A 会来救她，所以他们在每个房间里都布下了陷阱，使得第 $i$ 个房间最多可以进入 $k_i$ 次，否则小 A 也会被困在迷宫里。Luckily，小 c 在向小 A 求救的时候，已经将这个陷阱告诉了他。\n\n小 A 在进入迷宫的时候可以任选初始房间 $r$（进入迷宫算一次进入房间 $r$）。**小 A 可以离开迷宫，当且仅当他在房间 $r$。**\n\n如果小 A 进入了 $d$ 号房间，我们就认为他成功地救下了小 c。在救下小 c 后，小 A 还可以带着她继续在迷宫中行动。\n\n虽然小 A 并不是一个非常贪财的人，但还是想知道：在**成功救下小 c** 且离开迷宫的前提下，他最多能获得多少金币。", "inputFormat": "第一行，两个整数 $n,d$ —— 表示房间个数和小 c 被困的房间号。\n\n接下来 $n-1$ 行，每行三个整数 $x_i,y_i,v_i$ —— 分别表示第 $i$ 扇门连接的两个房间编号和这扇门上写的数。\n\n接下来一行，$n$ 个整数 $k_1,k_2,\\cdots,k_n$ —— 表示每个房间最多可进入的次数。", "outputFormat": "一行一个整数，表示小 A 能获得的金币数量的最大值。", "hint": "【样例 $1$ 说明】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zwtjgksh.png)\n\n一种最优的走法为：$2\\to 4\\to 2$，共可获得 $5$ 金币。\n\n【样例 $2$ 说明】\n\n如上图，小 A 只能空降到 $4$ 号房间，然后再离开迷宫，共可获得 $0$ 金币。\n\n【样例 $4$ 说明】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/fmd43hzq.png)\n\n一种最优的走法为：$3\\to 9\\to 10\\to 8\\to 10\\to 12\\to 6\\to 12\\to 10\\to 9\\to 3$，共可获得 $100+59+65+9+30=263$ 金币。\n\n【数据范围与约定】\n\n**本题使用捆绑测试。**\n\nSubtask 编号 | $n\\leq$ | 特殊性质 | 分值 |\n:-: | :-: | :-: | :-: |\n$1$ | $12$ | $k_i=1$ | $3$ |\n$2$ | $12$ | $k_i\\leq 3$ | $12$ |\n$3$ | $10^3$ | 迷宫为一条链 | $9$ |\n$4$ | $10^3$ | 无 | $16$ |\n$5$ | $10^5$ | 迷宫为一条链 | $9$ |\n$6$ | $10^5$ | 迷宫为一个菊花图 | $16$ |\n$7$ | $10^5$ | 无 | $35$ |\n\n对于 $100\\%$ 的数据，$1\\leq d,k_i\\leq n\\leq 10^5$，$1\\leq v_i\\leq 10^4$。\n\n【Source】\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $E\n\nidea & std：[Alex_Wei](https://www.luogu.com.cn/user/123294)，验题：[chenxia25](https://www.luogu.com.cn/user/138400)", "locale": "zh-CN", "translations": {"en": {"title": "\"SWTR-4\" Collecting Coins", "background": "Little A likes Collecting Coins. He also has a good friend named little c.\n\nWhile traveling outside, little c got trapped in a maze. After hearing the news, little A immediately put down the “tree-of-trees-of-trees” he was playing and set off to rescue her.", "description": "After some investigation, little A found that the maze where little c is trapped consists of $n$ rooms, connected by $n-1$ doors, **forming a tree**. Little c is trapped in room $d$.\n\nLittle A also found that each door has a number $v$ written on it. Passing through that door gives $v$ coins, but the coins on each door can only be obtained once.\n\nSince the bad guys who trapped little c already knew little A would come to rescue her, they placed traps in every room, so that room $i$ can be entered at most $k_i$ times; otherwise, little A would also be trapped in the maze. Luckily, when asking little A for help, little c had already told him about this trap.\n\nWhen entering the maze, little A may choose any starting room $r$ (entering the maze counts as entering room $r$ once). **Little A can leave the maze if and only if he is in room $r$.**\n\nIf little A enters room $d$, we consider that he has successfully rescued little c. After rescuing little c, little A may continue moving in the maze with her.\n\nAlthough little A is not a very greedy person, he still wants to know: under the condition that he **successfully rescues little c** and leaves the maze, what is the maximum number of coins he can obtain.", "inputFormat": "The first line contains two integers $n,d$, representing the number of rooms and the room number where little c is trapped.\n\nThe next $n-1$ lines each contain three integers $x_i,y_i,v_i$, representing the two room numbers connected by the $i$-th door, and the number written on that door.\n\nThe next line contains $n$ integers $k_1,k_2,\\cdots,k_n$, representing the maximum number of times each room can be entered.", "outputFormat": "Output one integer in a single line, representing the maximum number of coins little A can obtain.", "hint": "[Sample $1$ Explanation]\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zwtjgksh.png)\n\nOne optimal route is: $2\\to 4\\to 2$, and it can obtain $5$ coins in total.\n\n[Sample $2$ Explanation]\n\nAs in the figure above, little A can only “airdrop” to room $4$, and then leave the maze, obtaining $0$ coins in total.\n\n[Sample $4$ Explanation]\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/fmd43hzq.png)\n\nOne optimal route is: $3\\to 9\\to 10\\to 8\\to 10\\to 12\\to 6\\to 12\\to 10\\to 9\\to 3$, and it can obtain $100+59+65+9+30=263$ coins in total.\n\n[Constraints and Notes]\n\n**This problem uses bundled testdata.**\n\nSubtask ID | $n\\leq$ | Special Property | Score |\n:-: | :-: | :-: | :-: |\n$1$ | $12$ | $k_i=1$ | $3$ |\n$2$ | $12$ | $k_i\\leq 3$ | $12$ |\n$3$ | $10^3$ | The maze is a chain | $9$ |\n$4$ | $10^3$ | None | $16$ |\n$5$ | $10^5$ | The maze is a chain | $9$ |\n$6$ | $10^5$ | The maze is a “chrysanthemum graph” (juhua tu) | $16$ |\n$7$ | $10^5$ | None | $35$ |\n\nFor $100\\%$ of the data, $1\\leq d,k_i\\leq n\\leq 10^5$, $1\\leq v_i\\leq 10^4$.\n\n[Source]\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $E\n\nidea & std: [Alex_Wei](https://www.luogu.com.cn/user/123294), validator: [chenxia25](https://www.luogu.com.cn/user/138400)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「SWTR-4」Collecting Coins", "background": "小 A 喜欢 Collecting Coins。他还有个好朋友叫做小 c。\n\n小 c 在外出游玩的时候被困在了一个迷宫里面，小 A 得知消息后，立刻放下了自己手中正在打的树套树套树套树，出发去营救她。", "description": "经过一番勘察，小 A 发现小 c 被困的迷宫由 $n$ 个房间组成，这些房间用 $n-1$ 扇门连接，**形成了一颗树**。小 c 被困在 $d$ 号房间。\n\n小 A 还发现每扇门上都写有一个数字 $v$，经过该扇门就会获得 $v$ 个金币，但每扇门上的金币只能获得一次。\n\n由于把小 c 困在迷宫里的坏人早已知道小 A 会来救她，所以他们在每个房间里都布下了陷阱，使得第 $i$ 个房间最多可以进入 $k_i$ 次，否则小 A 也会被困在迷宫里。Luckily，小 c 在向小 A 求救的时候，已经将这个陷阱告诉了他。\n\n小 A 在进入迷宫的时候可以任选初始房间 $r$（进入迷宫算一次进入房间 $r$）。**小 A 可以离开迷宫，当且仅当他在房间 $r$。**\n\n如果小 A 进入了 $d$ 号房间，我们就认为他成功地救下了小 c。在救下小 c 后，小 A 还可以带着她继续在迷宫中行动。\n\n虽然小 A 并不是一个非常贪财的人，但还是想知道：在**成功救下小 c** 且离开迷宫的前提下，他最多能获得多少金币。", "inputFormat": "第一行，两个整数 $n,d$ —— 表示房间个数和小 c 被困的房间号。\n\n接下来 $n-1$ 行，每行三个整数 $x_i,y_i,v_i$ —— 分别表示第 $i$ 扇门连接的两个房间编号和这扇门上写的数。\n\n接下来一行，$n$ 个整数 $k_1,k_2,\\cdots,k_n$ —— 表示每个房间最多可进入的次数。", "outputFormat": "一行一个整数，表示小 A 能获得的金币数量的最大值。", "hint": "【样例 $1$ 说明】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zwtjgksh.png)\n\n一种最优的走法为：$2\\to 4\\to 2$，共可获得 $5$ 金币。\n\n【样例 $2$ 说明】\n\n如上图，小 A 只能空降到 $4$ 号房间，然后再离开迷宫，共可获得 $0$ 金币。\n\n【样例 $4$ 说明】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/fmd43hzq.png)\n\n一种最优的走法为：$3\\to 9\\to 10\\to 8\\to 10\\to 12\\to 6\\to 12\\to 10\\to 9\\to 3$，共可获得 $100+59+65+9+30=263$ 金币。\n\n【数据范围与约定】\n\n**本题使用捆绑测试。**\n\nSubtask 编号 | $n\\leq$ | 特殊性质 | 分值 |\n:-: | :-: | :-: | :-: |\n$1$ | $12$ | $k_i=1$ | $3$ |\n$2$ | $12$ | $k_i\\leq 3$ | $12$ |\n$3$ | $10^3$ | 迷宫为一条链 | $9$ |\n$4$ | $10^3$ | 无 | $16$ |\n$5$ | $10^5$ | 迷宫为一条链 | $9$ |\n$6$ | $10^5$ | 迷宫为一个菊花图 | $16$ |\n$7$ | $10^5$ | 无 | $35$ |\n\n对于 $100\\%$ 的数据，$1\\leq d,k_i\\leq n\\leq 10^5$，$1\\leq v_i\\leq 10^4$。\n\n【Source】\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\\ \\ $E\n\nidea & std：[Alex_Wei](https://www.luogu.com.cn/user/123294)，验题：[chenxia25](https://www.luogu.com.cn/user/138400)", "locale": "zh-CN"}}}
{"pid": "P6214", "type": "P", "difficulty": 7, "samples": [["3 3 10\n0.00 0.00 0.00 1.00\n-1.00 -1.00 0.20\n10.00 10.00 0.41\n-4.56 -1.23 1.00\n-2.00 -1.00 0.40\n-10.00 -10.00 0.41\n9.87 6.54 1.00\n0.00 1\n1.00 1\n5.00 1\n5.00 3\n5.00 4\n10.00 2\n10.00 6\n28.28 1\n28.28 2\n28.29 1", "-4.66\n-2.33\n0.26970954\n0.83836048\n-4.66\n0.65792852\n-4.66\n0.40999665\n0.41005730\n-4.66"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["计算几何", "线段树", "Special Judge", "O2优化", "可持久化线段树", "可持久化"], "title": "「SWTR-4」Taking a Walk", "background": "小 A 喜欢在广场上散步。\n\n有一次在小 A 散步的时候，由于思考得过于投入，他不小心撞在了电线杆上。\n\n于是就有了这道题目（当然是假的）。", "description": "小 A 和 好友小 Y 站在一个平面上，他们的初始坐标分别是 $(Ax_0,Ay_0)$ 和 $(Bx_0,By_0)$。\n\n当然，站着实在是太无聊了，所以他们会不停地移动。\n\n准确来说，小 A 共有 $n$ 次移动，小 Y 共有 $m$ 次移动。\n\n小 A 在第 $At_{i-1}$ 到第 $At_i$ 时刻会从 $(Ax_{i-1},Ay_{i-1})$ **匀速直线运动**到 $(Ax_i,Ay_i)$。\n\n小 Y 在第 $Bt_{i-1}$ 到第 $Bt_i$ 时刻会从 $(Bx_{i-1},By_{i-1})$ **匀速直线运动**到 $(Bx_i,By_i)$。\n\n- $At_0=Bt_0=0$。\n\n小 A 还有 $q$ 次询问： 每次询问给出一个浮点数 $c$ 和一个整数 $f$，请求出他们第 $f$ 次相距 $c$ 的时刻。\n\n- **特殊的，如果他们之间相距 $c$ 的时刻有无数个**，输出 `-2.33`。\n\n- **特殊的，如果 $f$ 大于他们之间相距 $c$ 的次数**，输出 `-4.66`。\n\n- 如果不满足上面两个条件，输出他们第 $f$ 次相距 $c$ 的时刻。\n", "inputFormat": "第一行，三个整数 $n,m,q$ —— $n$ 表示小 A 的移动次数，$m$ 表示小 Y 的移动次数，$q$ 表示询问次数。\n\n第二行，四个两位浮点数 $Ax_0,Ay_0,Bx_0,By_0$ —— 表示小 A 和小 Y 的初始坐标。\n\n接下来 $n$ 行，第 $i$ 行三个两位浮点数 $Ax_i,Ay_i,At_i$ —— 意义见题目描述。\n\n接下来 $m$ 行，第 $i$ 行三个两位浮点数 $Bx_i,By_i,Bt_i$ —— 同上。\n\n接下来 $q$ 行，每行一个两位浮点数 $c$ 和一个整数 $f$ —— 描述一个询问。", "outputFormat": "共 $q$ 个浮点数，表示每个询问的答案。", "hint": "**「Special Judge」**\n\n**本题使用 Special judge。**\n\n如果你的输出与正确答案的**相对误差或绝对误差**不超过 $10^{-7}$，将会获得该测试点的满分，否则不得分。**建议输出至少 $8$ 位小数**。\n\n请不要输出除了题目要求以外的数字，否则可能获得 UKE。\n\n保证没有答案为 $0$ 的情况。\n\nSPJ 如下：\n\n```\n#include \"testlib.h\"\n#define double long double\nconst double eps=1e-7;\nbool Equal(double x,double y){\n\treturn abs(x-y)<=eps||abs((x-y)/y)<=eps;\n}\nint main(int argc, char* argv[]){\n    registerTestlibCmd(argc, argv);\n    int n=inf.readInt(),m=inf.readInt(),q=inf.readInt();\n    for(int i=1;i<=q;i++){\n    \tdouble x=ouf.readDouble(),y=ans.readDouble();\n    \tif(!Equal(x,y))quitf(_wa,\"On line %d the answer is wrong: expected = %.8LF, found = %.8LF\",i,y,x);\n\t}\n\tquitf(_ok, \"The answer is correct.\"); \n\treturn 0;\n}\n```\n\n**「数据范围与约定」**\n\n**本题使用捆绑测试。**\n\nSubtask 编号 | $n,m\\leq$ | $q\\leq$ | 得分\n:-: | :-: | :-: | :-:\n$1$ | $5\\times 10^2$ | $10^3$ | $10$\n$2$ | $2\\times 10^4$ | $2\\times 10^4$ | $20$\n$3$ | $4\\times 10^4$ | $5\\times 10^4$ | $30$\n$4$ | $8\\times 10^4$ | $3\\times 10^5$ | $40$\n\n对于 $100\\%$ 的数据，有 $1\\leq n,m\\leq 8\\times 10^4$，$1\\leq q\\leq 3\\times 10^5$，$At_n=Bt_m\\leq 6\\times 10^4$，$1\\leq f\\leq m+n$，$0\\leq c\\leq 3\\times 10^4$。\n\n为保证极端数据下的精度，所有坐标的绝对值不大于 $10^4$。\n\n保证 $At_i<At_{i+1}$，$Bt_i<Bt_{i+1}$，一次移动的时间不超过 $6\\times 10^2$。**不保证**某次移动没有改变位置。\n\n**请注意精度误差。**\n\n**「时间 & 空间限制」**\n\n对于第 $1$ 个子任务，时限 $\\rm{1s}$；其余子任务时限 $\\rm{2.5s}$。\n\n对于第 $1$ 个子任务，空限 $\\rm{128MB}$；其余子任务空限 $\\rm{256MB}$。\n\n**为了卡掉错解，出题人放短了时限，但时限仍在 std 的 $2$ 倍以上。**\n\n**std 轻微卡常，请注意 I/O/常数优化。**\n\n**本题开启自动 O2 优化。**\n\n**「来源」**\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414) F。  \nidea & std：[Alex_Wei](https://www.luogu.com.cn/user/123294)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「SWTR-4」Taking a Walk", "background": "小 A 喜欢在广场上散步。\n\n有一次在小 A 散步的时候，由于思考得过于投入，他不小心撞在了电线杆上。\n\n于是就有了这道题目（当然是假的）。", "description": "小 A 和 好友小 Y 站在一个平面上，他们的初始坐标分别是 $(Ax_0,Ay_0)$ 和 $(Bx_0,By_0)$。\n\n当然，站着实在是太无聊了，所以他们会不停地移动。\n\n准确来说，小 A 共有 $n$ 次移动，小 Y 共有 $m$ 次移动。\n\n小 A 在第 $At_{i-1}$ 到第 $At_i$ 时刻会从 $(Ax_{i-1},Ay_{i-1})$ **匀速直线运动**到 $(Ax_i,Ay_i)$。\n\n小 Y 在第 $Bt_{i-1}$ 到第 $Bt_i$ 时刻会从 $(Bx_{i-1},By_{i-1})$ **匀速直线运动**到 $(Bx_i,By_i)$。\n\n- $At_0=Bt_0=0$。\n\n小 A 还有 $q$ 次询问： 每次询问给出一个浮点数 $c$ 和一个整数 $f$，请求出他们第 $f$ 次相距 $c$ 的时刻。\n\n- **特殊的，如果他们之间相距 $c$ 的时刻有无数个**，输出 `-2.33`。\n\n- **特殊的，如果 $f$ 大于他们之间相距 $c$ 的次数**，输出 `-4.66`。\n\n- 如果不满足上面两个条件，输出他们第 $f$ 次相距 $c$ 的时刻。\n", "inputFormat": "第一行，三个整数 $n,m,q$ —— $n$ 表示小 A 的移动次数，$m$ 表示小 Y 的移动次数，$q$ 表示询问次数。\n\n第二行，四个两位浮点数 $Ax_0,Ay_0,Bx_0,By_0$ —— 表示小 A 和小 Y 的初始坐标。\n\n接下来 $n$ 行，第 $i$ 行三个两位浮点数 $Ax_i,Ay_i,At_i$ —— 意义见题目描述。\n\n接下来 $m$ 行，第 $i$ 行三个两位浮点数 $Bx_i,By_i,Bt_i$ —— 同上。\n\n接下来 $q$ 行，每行一个两位浮点数 $c$ 和一个整数 $f$ —— 描述一个询问。", "outputFormat": "共 $q$ 个浮点数，表示每个询问的答案。", "hint": "**「Special Judge」**\n\n**本题使用 Special judge。**\n\n如果你的输出与正确答案的**相对误差或绝对误差**不超过 $10^{-7}$，将会获得该测试点的满分，否则不得分。**建议输出至少 $8$ 位小数**。\n\n请不要输出除了题目要求以外的数字，否则可能获得 UKE。\n\n保证没有答案为 $0$ 的情况。\n\nSPJ 如下：\n\n```\n#include \"testlib.h\"\n#define double long double\nconst double eps=1e-7;\nbool Equal(double x,double y){\n\treturn abs(x-y)<=eps||abs((x-y)/y)<=eps;\n}\nint main(int argc, char* argv[]){\n    registerTestlibCmd(argc, argv);\n    int n=inf.readInt(),m=inf.readInt(),q=inf.readInt();\n    for(int i=1;i<=q;i++){\n    \tdouble x=ouf.readDouble(),y=ans.readDouble();\n    \tif(!Equal(x,y))quitf(_wa,\"On line %d the answer is wrong: expected = %.8LF, found = %.8LF\",i,y,x);\n\t}\n\tquitf(_ok, \"The answer is correct.\"); \n\treturn 0;\n}\n```\n\n**「数据范围与约定」**\n\n**本题使用捆绑测试。**\n\nSubtask 编号 | $n,m\\leq$ | $q\\leq$ | 得分\n:-: | :-: | :-: | :-:\n$1$ | $5\\times 10^2$ | $10^3$ | $10$\n$2$ | $2\\times 10^4$ | $2\\times 10^4$ | $20$\n$3$ | $4\\times 10^4$ | $5\\times 10^4$ | $30$\n$4$ | $8\\times 10^4$ | $3\\times 10^5$ | $40$\n\n对于 $100\\%$ 的数据，有 $1\\leq n,m\\leq 8\\times 10^4$，$1\\leq q\\leq 3\\times 10^5$，$At_n=Bt_m\\leq 6\\times 10^4$，$1\\leq f\\leq m+n$，$0\\leq c\\leq 3\\times 10^4$。\n\n为保证极端数据下的精度，所有坐标的绝对值不大于 $10^4$。\n\n保证 $At_i<At_{i+1}$，$Bt_i<Bt_{i+1}$，一次移动的时间不超过 $6\\times 10^2$。**不保证**某次移动没有改变位置。\n\n**请注意精度误差。**\n\n**「时间 & 空间限制」**\n\n对于第 $1$ 个子任务，时限 $\\rm{1s}$；其余子任务时限 $\\rm{2.5s}$。\n\n对于第 $1$ 个子任务，空限 $\\rm{128MB}$；其余子任务空限 $\\rm{256MB}$。\n\n**为了卡掉错解，出题人放短了时限，但时限仍在 std 的 $2$ 倍以上。**\n\n**std 轻微卡常，请注意 I/O/常数优化。**\n\n**本题开启自动 O2 优化。**\n\n**「来源」**\n\n[Sweet Round 04](https://www.luogu.com.cn/contest/26414) F。  \nidea & std：[Alex_Wei](https://www.luogu.com.cn/user/123294)。", "locale": "zh-CN"}}}
{"pid": "P6215", "type": "P", "difficulty": 5, "samples": [["10 10 1 1\n0 1 8 8 5 6 6 8 0 1 \n9 2 8 8 6 2 5 0 1 8 \n3 9\n1 2 3\n3 10\n3 5\n2 10 0\n3 10\n1 5 9\n2 9 7\n3 9\n3 4\n", "610\n1034\n390\n674\n1018\n246\n"], ["10 10 873892251 2\n393158301 365328187 234823508 38818450 963771276 826653462 358628534 626503513 239326879 647251399 \n1 1 1 1 1 1 1 1 1 1 \n1 6 861625956\n1 2 300158647\n1 2 84103073\n3 8\n1 1 942644245\n1 9 883742604\n1 2 974963615\n3 5\n1 8 710319943\n3 1\n", "35415628\n483475596\n154061492\n"], ["10 10 480345252 3\n494173949 364489100 93066339 249297520 207335443 117096873 864460454 113006173 214332928 582507765 \n5658914 222040024 221653308 296560771 594076100 151232714 410372721 23331041 374481229 184401699 \n3 6\n3 8\n1 1 931776921\n1 6 44943479\n1 6 946828878\n1 4 9046748\n3 3\n1 7 692410213\n1 10 483672045\n3 10\n", "214010503\n321766325\n894782746\n274293582\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["线段树"], "title": "函数求值", "background": "", "description": "有两个长度均为 $n$ 的权值序列 $a,b$，常数 $p,k$，以及两个函数：\n\n$$g(x) = \\sum_{i=1}^x p^i \\times a_i$$\n\n$$f(x) = \\sum_{i=1}^x g(i) ^ k \\times b_i$$\n\n有 $m$ 个操作，操作有以下三种：\n\n*  $1\\ x\\ y$，表示将 $a_x$ 修改为 $y$。\n\n*  $2\\ x\\ y$，表示将 $b_x$ 修改为 $y$。\n\n*  $3\\ x$，表示查询 $f(x)$ 对 $10 ^ 9 + 7$ 取模的值。", "inputFormat": "第一行四个整数，$n,m,p,k$。\n\n第二行 $n$ 个整数，表示序列 $a$。\n\n第三行 $n$ 个整数，表示序列 $b$。\n\n接下来 $m$ 行，每行描述一个操作。", "outputFormat": "对于每个 $3\\ x$ 操作，输出答案。", "hint": "**【样例解释】**\n\n   这是样例一操作四后的结果：\n\n| $/$  | $1$ | $2$ | $3$ | $4$ | $5$ |\n| :-: | :-: | :-: | :-: | :-: | :-: |\n| $a_i$ | $0$ | $3$ |  $8$ | $8$ | $5$ |\n| $b_i$ | $9$ | $2$ |  $8$ | $8$ | $6$ |\n| $g(i)$ | $0$ | $3$ |  $11$ | $19$ | $24$ |\n| $f(i)$ | $0$ | $6$ |  $94$ | $246$ | $390$ |\n\n----------------------\n\n**【数据范围】**\n\n- 对于 $100\\%%$ 的数据：\n\n    $1 \\le n,m \\le 2 \\times 10 ^ 5$。\n\n    $0 \\le a_i,b_i,p \\le 10 ^ 9 + 6$。\n\n    $1 \\le x \\le n$，$0 \\le y \\le 10 ^ 9 + 6$。\n\n    $1 \\le k \\le 3$。\n\n- **详细的数据范围：**\n\n     测试点编号 | $n,m \\le$ | $k$ | 特殊性质 \n     :-: | :-: | :-: | :-:\n     $1$ | $300$ | $\\le 3$ |  无\n     $2$ | $300$ | $\\le 3$ |  无\n     $3$ | $3 \\times 10 ^ 3$ | $\\le 3$ |  无\n     $4$ | $3 \\times 10 ^ 3$ | $\\le 3$ |  无\n     $5$ | $7 \\times 10 ^ 4$ | $= 1$ | A\n     $6$ | $7 \\times 10 ^ 4$ | $= 1$ |  A\n     $7$ | $7 \\times 10 ^ 4$ | $= 1$ |  A\n     $8$ | $7 \\times 10 ^ 4$ | $= 2$ |  A \n     $9$ | $7 \\times 10 ^ 4$ | $= 3$ |  A\n     $10$ | $7 \\times 10 ^ 4$ | $= 1$ |  B\n     $11$ | $7 \\times 10 ^ 4$ | $= 1$ |  B\n     $12$ | $7 \\times 10 ^ 4$ | $= 2$ | B\n     $13$ | $7 \\times 10 ^ 4$ | $= 3$ |  B\n     $14$ | $7 \\times 10 ^ 4$ | $= 3$ |  B\n     $15$ | $7 \\times 10 ^ 4$ | $= 1$ |  无\n     $16$ | $7 \\times 10 ^ 4$ | $= 2$ |  无\n     $17$ | $7 \\times 10 ^ 4$ | $= 3$ |  无\n     $18$ | $2 \\times 10 ^ 5$ | $= 1$ |  无\n     $19$ | $2 \\times 10 ^ 5$ | $= 2$ |  无\n     $20$ | $2 \\times 10 ^ 5$ | $= 3$ |  无\n\n     A：任意时刻所有 $b_i = 1$。\n\n     B：无操作二。\n\n---------------------\n\n**【提示】**\n\n样例二满足A类性质，样例三满足B类性质。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "函数求值", "background": "", "description": "有两个长度均为 $n$ 的权值序列 $a,b$，常数 $p,k$，以及两个函数：\n\n$$g(x) = \\sum_{i=1}^x p^i \\times a_i$$\n\n$$f(x) = \\sum_{i=1}^x g(i) ^ k \\times b_i$$\n\n有 $m$ 个操作，操作有以下三种：\n\n*  $1\\ x\\ y$，表示将 $a_x$ 修改为 $y$。\n\n*  $2\\ x\\ y$，表示将 $b_x$ 修改为 $y$。\n\n*  $3\\ x$，表示查询 $f(x)$ 对 $10 ^ 9 + 7$ 取模的值。", "inputFormat": "第一行四个整数，$n,m,p,k$。\n\n第二行 $n$ 个整数，表示序列 $a$。\n\n第三行 $n$ 个整数，表示序列 $b$。\n\n接下来 $m$ 行，每行描述一个操作。", "outputFormat": "对于每个 $3\\ x$ 操作，输出答案。", "hint": "**【样例解释】**\n\n   这是样例一操作四后的结果：\n\n| $/$  | $1$ | $2$ | $3$ | $4$ | $5$ |\n| :-: | :-: | :-: | :-: | :-: | :-: |\n| $a_i$ | $0$ | $3$ |  $8$ | $8$ | $5$ |\n| $b_i$ | $9$ | $2$ |  $8$ | $8$ | $6$ |\n| $g(i)$ | $0$ | $3$ |  $11$ | $19$ | $24$ |\n| $f(i)$ | $0$ | $6$ |  $94$ | $246$ | $390$ |\n\n----------------------\n\n**【数据范围】**\n\n- 对于 $100\\%%$ 的数据：\n\n    $1 \\le n,m \\le 2 \\times 10 ^ 5$。\n\n    $0 \\le a_i,b_i,p \\le 10 ^ 9 + 6$。\n\n    $1 \\le x \\le n$，$0 \\le y \\le 10 ^ 9 + 6$。\n\n    $1 \\le k \\le 3$。\n\n- **详细的数据范围：**\n\n     测试点编号 | $n,m \\le$ | $k$ | 特殊性质 \n     :-: | :-: | :-: | :-:\n     $1$ | $300$ | $\\le 3$ |  无\n     $2$ | $300$ | $\\le 3$ |  无\n     $3$ | $3 \\times 10 ^ 3$ | $\\le 3$ |  无\n     $4$ | $3 \\times 10 ^ 3$ | $\\le 3$ |  无\n     $5$ | $7 \\times 10 ^ 4$ | $= 1$ | A\n     $6$ | $7 \\times 10 ^ 4$ | $= 1$ |  A\n     $7$ | $7 \\times 10 ^ 4$ | $= 1$ |  A\n     $8$ | $7 \\times 10 ^ 4$ | $= 2$ |  A \n     $9$ | $7 \\times 10 ^ 4$ | $= 3$ |  A\n     $10$ | $7 \\times 10 ^ 4$ | $= 1$ |  B\n     $11$ | $7 \\times 10 ^ 4$ | $= 1$ |  B\n     $12$ | $7 \\times 10 ^ 4$ | $= 2$ | B\n     $13$ | $7 \\times 10 ^ 4$ | $= 3$ |  B\n     $14$ | $7 \\times 10 ^ 4$ | $= 3$ |  B\n     $15$ | $7 \\times 10 ^ 4$ | $= 1$ |  无\n     $16$ | $7 \\times 10 ^ 4$ | $= 2$ |  无\n     $17$ | $7 \\times 10 ^ 4$ | $= 3$ |  无\n     $18$ | $2 \\times 10 ^ 5$ | $= 1$ |  无\n     $19$ | $2 \\times 10 ^ 5$ | $= 2$ |  无\n     $20$ | $2 \\times 10 ^ 5$ | $= 3$ |  无\n\n     A：任意时刻所有 $b_i = 1$。\n\n     B：无操作二。\n\n---------------------\n\n**【提示】**\n\n样例二满足A类性质，样例三满足B类性质。", "locale": "zh-CN"}}}
{"pid": "P6216", "type": "P", "difficulty": 5, "samples": [["10 2\nccbccbbcbb bc", "4"], ["20 2\ncbcaacabcbacbbabacca ba\n", "4\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["前缀和", "KMP 算法", "Manacher 算法"], "title": "回文匹配", "background": "", "description": "对于一对字符串 $(s_1,s_2)$，若 $s_1$ 的长度为奇数的子串 $[l,r]$ 满足 $[l,r]$ 是回文的，那么 $s_1$ 的“分数”会增加 $s_2$ 在 $[l,r]$ 中出现的次数。\n\n现在给出一对 $(s_1,s_2)$，请计算出 $s_1$ 的“分数”。\n\n答案对 $2 ^ {32}$ 取模。", "inputFormat": "第一行两个整数，$n,m$，表示 $s_1$ 的长度和 $s_2$ 的长度。\n\n第二行两个字符串，$s_1,s_2$。", "outputFormat": "一行一个整数，表示 $s_1$ 的分数。", "hint": "**【样例解释】**\n\n   对于样例一：\n\n   子串 $[1,5]$ 中 $s_2$ 出现了一次，子串 $[2,4]$ 中 $s_2$ 出现了一次。\n\n   子串 $[7,9]$ 中 $s_2$ 出现了一次，子串 $[6,10]$ 中 $s_2$ 出现了一次。\n\n--------------------------------------\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n- 对于 $100\\%$ 的数据：$1 \\le n,m \\le 3 \\times 10 ^ 6$，字符串中的字符都是小写字母。\n\n- **详细的数据范围：**\n\n  | Subtask 编号 |     $n,m \\le$     | 分值 |\n  | :----------: | :---------------: | :--: |\n  |     $1$      |       $100$       | $15$ |\n  |     $2$      |     $10 ^ 3$      | $15$ |\n  |     $3$      | $5 \\times 10 ^ 3$ | $20$ |\n  |     $4$      | $4 \\times 10 ^ 5$ | $30$ |\n  |     $5$      | $3 \\times 10 ^ 6$ | $20$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "回文匹配", "background": "", "description": "对于一对字符串 $(s_1,s_2)$，若 $s_1$ 的长度为奇数的子串 $[l,r]$ 满足 $[l,r]$ 是回文的，那么 $s_1$ 的“分数”会增加 $s_2$ 在 $[l,r]$ 中出现的次数。\n\n现在给出一对 $(s_1,s_2)$，请计算出 $s_1$ 的“分数”。\n\n答案对 $2 ^ {32}$ 取模。", "inputFormat": "第一行两个整数，$n,m$，表示 $s_1$ 的长度和 $s_2$ 的长度。\n\n第二行两个字符串，$s_1,s_2$。", "outputFormat": "一行一个整数，表示 $s_1$ 的分数。", "hint": "**【样例解释】**\n\n   对于样例一：\n\n   子串 $[1,5]$ 中 $s_2$ 出现了一次，子串 $[2,4]$ 中 $s_2$ 出现了一次。\n\n   子串 $[7,9]$ 中 $s_2$ 出现了一次，子串 $[6,10]$ 中 $s_2$ 出现了一次。\n\n--------------------------------------\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n- 对于 $100\\%$ 的数据：$1 \\le n,m \\le 3 \\times 10 ^ 6$，字符串中的字符都是小写字母。\n\n- **详细的数据范围：**\n\n  | Subtask 编号 |     $n,m \\le$     | 分值 |\n  | :----------: | :---------------: | :--: |\n  |     $1$      |       $100$       | $15$ |\n  |     $2$      |     $10 ^ 3$      | $15$ |\n  |     $3$      | $5 \\times 10 ^ 3$ | $20$ |\n  |     $4$      | $4 \\times 10 ^ 5$ | $30$ |\n  |     $5$      | $3 \\times 10 ^ 6$ | $20$ |", "locale": "zh-CN"}}}
{"pid": "P6217", "type": "P", "difficulty": 5, "samples": [["5 5\n12 8 9 14 21\n1 5 2\n1 3 3\n3 5 7\n1 5 6\n2 3 7", "1016064\n2592\n18522\n9144576\n3528\n"], ["10 10\n47 47 47 3 7 19 2 7 31 31 \n1 3 53\n4 4 61\n2 8 73\n6 7 53\n1 5 47\n2 5 73\n5 6 71\n7 7 67\n4 7 83\n1 9 59\n", "456856666\n183\n802334105\n106742\n816245119\n365992530\n670453\n134\n871739899\n194416112\n"], ["10 10\n2 13 13 2 3 17 11 19 19 7 \n4 8 1\n1 2 7\n6 7 37\n9 10 7\n1 8 9\n3 8 47\n5 8 2\n3 6 9\n4 5 25\n4 5 8\n", "21318\n1274\n256003\n931\n819082258\n40076077\n170544\n2899962\n3750\n192\n"], ["10 10\n14 39 31 30 3 21 19 17 35 2 \n1 3 10\n6 6 19\n2 4 3\n6 8 18\n1 10 2\n5 6 49\n2 6 8\n7 9 26\n3 6 12\n1 1 10\n", "8463000\n399\n108810\n13186152\n23723126\n21609\n437603581\n198696680\n22498560\n70\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "最大公约数 gcd", "逆元"], "title": "简单数论题", "background": "", "description": "给出一个长度为 $n$ 的序列 $a$，$q$ 次询问 $\\prod_{i=l}^r \\operatorname{lcm}(a_i,x)$ 的值。\n\n答案对 $10 ^ 9 + 7$ 取模。", "inputFormat": "第一行两个整数 $n,q$。\n\n第二行 $n$ 个整数 $a_i$。\n\n接下来 $q$ 行，每行三个整数 $l,r,x$。", "outputFormat": "$q$ 行，一行一个答案。", "hint": "**【样例解释】**\n\n   对于样例一的第二个查询，答案是：\n\n   $\\quad \\operatorname{lcm}(12,3) \\times \\operatorname{lcm}(8,3) \\times \\operatorname{lcm}(9,3)$\n\n   $= 12 \\times 24 \\times 9$\n\n   $= 2592$\n\n------------------\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n\n- 对于 $100 \\%$ 的数据：$1 \\le l \\le r \\le n$，$1 \\le n,q,a_i,x \\le 2 \\times 10 ^ 5$。\n\n- **详细的数据范围：**\n\n  | Subtask 编号 | $n,q ,a_i,x\\le $  |              特殊性质               | 分值 |\n  | :---------: | :---------------: | :---------------------------------: | :--: |\n  |     $1$     |       $100$       |                 无                  | $10$ |\n  |     $2$     | $2 \\times 10 ^ 5$ | $a_i,x$ 是质数，任意 $a_i \\neq x$ | $10$ |\n  |     $3$     | $5 \\times 10 ^ 4$ |           $a_i$ 是质数            | $15$ |\n  |     $4$     | $5 \\times 10 ^ 4$ |           $μ(a_i) \\neq 0$           | $15$ |\n  |     $5$     | $5 \\times 10 ^ 4$ |                 无                  | $25$ |\n  |     $6$     | $2 \\times 10 ^ 5$ |                 无                  | $25$ |\n\n-------------------------\n\n**【提示】**\n\n- 样例二满足 Subtask2 的特殊性质，样例三满足 Subtask3 的特殊性质，样例四满足 Subtask4 的特殊性质。\n\n- $μ(x)$ 是莫比乌斯函数，它的定义如下：\n\n    设 $x = {p_1} ^ {q_1} \\times {p_2} ^ {q_2} \\times ... \\times {p_k} ^ {q_k}$。\n\n    $μ(x) =\\begin{cases}1&x=1\\\\(-1) ^ k&q_1,q_2...q_k \\le 1\\\\0&\\text{otherwise}\\end{cases}$ \n\n    注：$p_i$ 为质数，$q_i$ 为正整数。", "locale": "zh-CN", "translations": {"en": {"title": "Simple Number Theory Problem", "background": "", "description": "You are given a sequence $a$ of length $n$. There are $q$ queries asking for the value of $\\prod_{i=l}^r \\operatorname{lcm}(a_i,x)$.\n\nThe answer should be taken modulo $10 ^ 9 + 7$.", "inputFormat": "The first line contains two integers $n,q$.\n\nThe second line contains $n$ integers $a_i$.\n\nThe next $q$ lines each contain three integers $l,r,x$.", "outputFormat": "Output $q$ lines, one answer per line.", "hint": "**[Sample Explanation]**\n\nFor the second query in Sample 1, the answer is:\n\n$\\quad \\operatorname{lcm}(12,3) \\times \\operatorname{lcm}(8,3) \\times \\operatorname{lcm}(9,3)$\n\n$= 12 \\times 24 \\times 9$\n\n$= 2592$.\n\n------------------\n\n**[Constraints]**\n\n**This problem uses bundled testdata.**\n\n- For $100 \\%$ of the testdata: $1 \\le l \\le r \\le n$, $1 \\le n,q,a_i,x \\le 2 \\times 10 ^ 5$.\n\n- **Detailed constraints:**\n\n  | Subtask ID | $n,q ,a_i,x\\le $  |          Special Property           | Score |\n  | :--------: | :---------------: | :---------------------------------: | :---: |\n  |    $1$     |       $100$       |                None                 | $10$  |\n  |    $2$     | $2 \\times 10 ^ 5$ | $a_i,x$ are primes, and any $a_i \\neq x$ | $10$  |\n  |    $3$     | $5 \\times 10 ^ 4$ |            $a_i$ are primes         | $15$  |\n  |    $4$     | $5 \\times 10 ^ 4$ |           $μ(a_i) \\neq 0$           | $15$  |\n  |    $5$     | $5 \\times 10 ^ 4$ |                None                 | $25$  |\n  |    $6$     | $2 \\times 10 ^ 5$ |                None                 | $25$  |\n\n-------------------------\n\n**[Notes]**\n\n- Sample 2 satisfies the special property of Subtask 2, Sample 3 satisfies the special property of Subtask 3, and Sample 4 satisfies the special property of Subtask 4.\n\n- $μ(x)$ is the Möbius function, defined as follows:\n\n    Let $x = {p_1} ^ {q_1} \\times {p_2} ^ {q_2} \\times ... \\times {p_k} ^ {q_k}$.\n\n    $μ(x) =\\begin{cases}1&x=1\\\\(-1) ^ k&q_1,q_2...q_k \\le 1\\\\0&\\text{otherwise}\\end{cases}$.\n\n    Note: $p_i$ are primes, and $q_i$ are positive integers.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "简单数论题", "background": "", "description": "给出一个长度为 $n$ 的序列 $a$，$q$ 次询问 $\\prod_{i=l}^r \\operatorname{lcm}(a_i,x)$ 的值。\n\n答案对 $10 ^ 9 + 7$ 取模。", "inputFormat": "第一行两个整数 $n,q$。\n\n第二行 $n$ 个整数 $a_i$。\n\n接下来 $q$ 行，每行三个整数 $l,r,x$。", "outputFormat": "$q$ 行，一行一个答案。", "hint": "**【样例解释】**\n\n   对于样例一的第二个查询，答案是：\n\n   $\\quad \\operatorname{lcm}(12,3) \\times \\operatorname{lcm}(8,3) \\times \\operatorname{lcm}(9,3)$\n\n   $= 12 \\times 24 \\times 9$\n\n   $= 2592$\n\n------------------\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n\n- 对于 $100 \\%$ 的数据：$1 \\le l \\le r \\le n$，$1 \\le n,q,a_i,x \\le 2 \\times 10 ^ 5$。\n\n- **详细的数据范围：**\n\n  | Subtask 编号 | $n,q ,a_i,x\\le $  |              特殊性质               | 分值 |\n  | :---------: | :---------------: | :---------------------------------: | :--: |\n  |     $1$     |       $100$       |                 无                  | $10$ |\n  |     $2$     | $2 \\times 10 ^ 5$ | $a_i,x$ 是质数，任意 $a_i \\neq x$ | $10$ |\n  |     $3$     | $5 \\times 10 ^ 4$ |           $a_i$ 是质数            | $15$ |\n  |     $4$     | $5 \\times 10 ^ 4$ |           $μ(a_i) \\neq 0$           | $15$ |\n  |     $5$     | $5 \\times 10 ^ 4$ |                 无                  | $25$ |\n  |     $6$     | $2 \\times 10 ^ 5$ |                 无                  | $25$ |\n\n-------------------------\n\n**【提示】**\n\n- 样例二满足 Subtask2 的特殊性质，样例三满足 Subtask3 的特殊性质，样例四满足 Subtask4 的特殊性质。\n\n- $μ(x)$ 是莫比乌斯函数，它的定义如下：\n\n    设 $x = {p_1} ^ {q_1} \\times {p_2} ^ {q_2} \\times ... \\times {p_k} ^ {q_k}$。\n\n    $μ(x) =\\begin{cases}1&x=1\\\\(-1) ^ k&q_1,q_2...q_k \\le 1\\\\0&\\text{otherwise}\\end{cases}$ \n\n    注：$p_i$ 为质数，$q_i$ 为正整数。", "locale": "zh-CN"}}}
{"pid": "P6218", "type": "P", "difficulty": 5, "samples": [["2 12", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2006", "USACO", "数位 DP"], "title": "[USACO06NOV] Round Numbers S", "background": "", "description": "如果一个正整数的二进制表示中，$0$ 的数目不小于 $1$ 的数目，那么它就被称为「圆数」。\n\n例如，$9$ 的二进制表示为 $1001$，其中有 $2$ 个 $0$ 与 $2$ 个 $1$。因此，$9$ 是一个「圆数」。\n\n请你计算，区间 $[l,r]$ 中有多少个「圆数」。", "inputFormat": "一行，两个整数 $l,r$。", "outputFormat": "一行，一个整数，表示区间 $[l,r]$ 中「圆数」的个数。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le l,r\\le 2\\times 10^9$。\n\n------------\n\n**【样例说明】**\n\n区间 $[2,12]$ 中共有 $6$ 个「圆数」，分别为 $2,4,8,9,10,12$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO06NOV] Round Numbers S", "background": "", "description": "如果一个正整数的二进制表示中，$0$ 的数目不小于 $1$ 的数目，那么它就被称为「圆数」。\n\n例如，$9$ 的二进制表示为 $1001$，其中有 $2$ 个 $0$ 与 $2$ 个 $1$。因此，$9$ 是一个「圆数」。\n\n请你计算，区间 $[l,r]$ 中有多少个「圆数」。", "inputFormat": "一行，两个整数 $l,r$。", "outputFormat": "一行，一个整数，表示区间 $[l,r]$ 中「圆数」的个数。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le l,r\\le 2\\times 10^9$。\n\n------------\n\n**【样例说明】**\n\n区间 $[2,12]$ 中共有 $6$ 个「圆数」，分别为 $2,4,8,9,10,12$。", "locale": "zh-CN"}}}
