{"pid": "P10106", "type": "P", "difficulty": 7, "samples": [["2 499122177 2 1\n1 1 1 1", "374341633 374341633 873463809 374341633\n"], ["2 332748118 10 0\n1 2 4 8", "178690412 406663623 594339846 223292982"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2023", "广东"], "title": "[GDKOI2023 提高组] 马戏团里你最忙", "background": "", "description": "你正在马戏团里表演一个节目。\n\n有一个数字，初始是 $x_0$。进行 $K$ 次操作，第 $i$ 次操作从 $[0, 2^n)$ 均匀随机一个数字 $x$，$x_i$ 有 $p$ 的概率是 $x_{i - 1} \\operatorname{or} x$，有 $1 - p$ 的概率是 $x_{i - 1} \\operatorname{and} x$。\n\n一种方案的权值是 $\\sum_{i=1}^k c_{x_{i}}$。对每个 $i \\in [0, 2^n)$ 求出，$x_K = i$ 的所有方案中，权值乘概率之和，对 $998244353$ 取模。\n", "inputFormat": "第一行四个整数 $n, p', K, x_0$。$p'$ 为 $p$ 在模 $998244353$ 意义下的值。\n\n第二行 $2^n$ 个整数，第 $i$ 个表示 $c_{i - 1}$。", "outputFormat": "输出一行 $2^n$ 个用空格隔开整数，第 $i$ 个表示 $x_K = i - 1$ 的所有方案中，权值乘概率之和，对 $998244353$ 取模。\n", "hint": "对于 20% 的数据，满足 $K ≤ 20$。\n\n对于 40% 的数据，满足 $K ≤ 10^3$。\n\n对于另外 10% 的数据，满足 $n = 1$。\n\n对于另外 10% 的数据，满足 $n ≤ 8$。\n\n对于另外 10% 的数据，满足 $p' = 499122177$。\n\n对于另外 10% 的数据，满足 $c_i = 1$。\n\n对于 100% 的数据，满足 $0 ≤ n ≤ 17$，$ 1 ≤ K ≤ 10^9$，$ 0 ≤ x_0 < 2^n$，$ 0 ≤ p', c_i < 998244353$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[GDKOI2023 提高组] 马戏团里你最忙", "background": "", "description": "你正在马戏团里表演一个节目。\n\n有一个数字，初始是 $x_0$。进行 $K$ 次操作，第 $i$ 次操作从 $[0, 2^n)$ 均匀随机一个数字 $x$，$x_i$ 有 $p$ 的概率是 $x_{i - 1} \\operatorname{or} x$，有 $1 - p$ 的概率是 $x_{i - 1} \\operatorname{and} x$。\n\n一种方案的权值是 $\\sum_{i=1}^k c_{x_{i}}$。对每个 $i \\in [0, 2^n)$ 求出，$x_K = i$ 的所有方案中，权值乘概率之和，对 $998244353$ 取模。\n", "inputFormat": "第一行四个整数 $n, p', K, x_0$。$p'$ 为 $p$ 在模 $998244353$ 意义下的值。\n\n第二行 $2^n$ 个整数，第 $i$ 个表示 $c_{i - 1}$。", "outputFormat": "输出一行 $2^n$ 个用空格隔开整数，第 $i$ 个表示 $x_K = i - 1$ 的所有方案中，权值乘概率之和，对 $998244353$ 取模。\n", "hint": "对于 20% 的数据，满足 $K ≤ 20$。\n\n对于 40% 的数据，满足 $K ≤ 10^3$。\n\n对于另外 10% 的数据，满足 $n = 1$。\n\n对于另外 10% 的数据，满足 $n ≤ 8$。\n\n对于另外 10% 的数据，满足 $p' = 499122177$。\n\n对于另外 10% 的数据，满足 $c_i = 1$。\n\n对于 100% 的数据，满足 $0 ≤ n ≤ 17$，$ 1 ≤ K ≤ 10^9$，$ 0 ≤ x_0 < 2^n$，$ 0 ≤ p', c_i < 998244353$。", "locale": "zh-CN"}}}
{"pid": "P10107", "type": "P", "difficulty": 7, "samples": [["10\n9 3 0 7 4 8 8 7 2 5\n1 1 2 2 3 6 6 8 7\n10\n8 2\n2 1\n5 1\n4 1\n4 1\n1 4\n4 1\n6 3\n4 1\n1 4", "10\n14\n4\n7\n7\n55\n7\n30\n7\n55"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["倍增", "2023", "广东", "树链剖分", "前缀和", "位运算", "差分"], "title": "[GDKOI2023 提高组] 树", "background": null, "description": "给定一棵 $n$ 个结点的有根树 $T$，结点从 $1$ 开始编号，根结点为 $1$ 号结点，每个结点有一个正整数权值 $v_i$。\n\n有 $Q$ 次询问，对于一次询问，给定 $(x, k)$，设 $x$ 号结点的子树内（包含 $x$ 自身）的所有满足距离 $x$ 号结点不超过 $k$ 的结点编号为 $c_1, c_2, . . . , c_m$，则这次询问的答案为：\n\n$$(v_{c_1} ⊕ d(c_1, x)) + (v_{c_2} ⊕ d(c_2, x)) + \\cdots + (v_{c_m} ⊕ d(c_m, x))$$\n\n其中 $d(x, y)$ 表示树上 $x$ 号结点与 $y$ 号结点间唯一简单路径所包含的边数，$d(x, x) = 0$。$⊕$ 表示异或运算。", "inputFormat": "第一行一个整数 $n$ 表示树的大小。\n\n第二行 $n$ 个整数表示 $v_i$。\n\n第三行 $n - 1$ 个整数，依次表示 $2$ 号结点到 $n$ 号结点，每个结点的父亲编号 $p_i$。\n\n第四行一个整数 $Q$。\n\n接下来 $Q$ 行，每行两个整数 $x, k$，表示一个 $(x, k)$ 的查询。", "outputFormat": "输出共 $Q$ 行，第 $i$ 行一个整数表示第 $i$ 次询问的答案。", "hint": "对于 10% 的数据，满足 $n, Q ≤ 2 \\times 10^3$。\n\n对于 20% 的数据，满足 $n, Q ≤ 10^5$。\n\n对于另外 20% 的数据，满足 $p_i = i - 1$。\n\n对于另外 10% 的数据，满足 $k ≤ 20$。\n\n对于另外 20% 的数据，满足 $k = n$。\n\n对于另外 10% 的数据，满足 $v_i = 0$。\n\n对于 100% 的数据，满足 $1 ≤ n, Q ≤ 10^6$，$ 0 ≤ v ≤ 10^9$，$ 1 ≤ p_i < i$，$ 1 ≤ x, k ≤ n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[GDKOI2023 提高组] 树", "background": null, "description": "给定一棵 $n$ 个结点的有根树 $T$，结点从 $1$ 开始编号，根结点为 $1$ 号结点，每个结点有一个正整数权值 $v_i$。\n\n有 $Q$ 次询问，对于一次询问，给定 $(x, k)$，设 $x$ 号结点的子树内（包含 $x$ 自身）的所有满足距离 $x$ 号结点不超过 $k$ 的结点编号为 $c_1, c_2, . . . , c_m$，则这次询问的答案为：\n\n$$(v_{c_1} ⊕ d(c_1, x)) + (v_{c_2} ⊕ d(c_2, x)) + \\cdots + (v_{c_m} ⊕ d(c_m, x))$$\n\n其中 $d(x, y)$ 表示树上 $x$ 号结点与 $y$ 号结点间唯一简单路径所包含的边数，$d(x, x) = 0$。$⊕$ 表示异或运算。", "inputFormat": "第一行一个整数 $n$ 表示树的大小。\n\n第二行 $n$ 个整数表示 $v_i$。\n\n第三行 $n - 1$ 个整数，依次表示 $2$ 号结点到 $n$ 号结点，每个结点的父亲编号 $p_i$。\n\n第四行一个整数 $Q$。\n\n接下来 $Q$ 行，每行两个整数 $x, k$，表示一个 $(x, k)$ 的查询。", "outputFormat": "输出共 $Q$ 行，第 $i$ 行一个整数表示第 $i$ 次询问的答案。", "hint": "对于 10% 的数据，满足 $n, Q ≤ 2 \\times 10^3$。\n\n对于 20% 的数据，满足 $n, Q ≤ 10^5$。\n\n对于另外 20% 的数据，满足 $p_i = i - 1$。\n\n对于另外 10% 的数据，满足 $k ≤ 20$。\n\n对于另外 20% 的数据，满足 $k = n$。\n\n对于另外 10% 的数据，满足 $v_i = 0$。\n\n对于 100% 的数据，满足 $1 ≤ n, Q ≤ 10^6$，$ 0 ≤ v ≤ 10^9$，$ 1 ≤ p_i < i$，$ 1 ≤ x, k ≤ n$。", "locale": "zh-CN"}}}
{"pid": "P10108", "type": "P", "difficulty": 2, "samples": [["6 2 \n2 3\n1 0 30 100 30 30", "131"], ["6 2\n2 3\n1 0 30 100 30 -1", "101"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "2023", "GESP"], "title": "[GESP202312 六级] 闯关游戏", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1138>", "description": "你来到了一个闯关游戏。\n\n这个游戏总共有 $N$ 关，每关都有 $M$ 个通道，你需要选择一个通道并通往后续关卡。其中，第 $i$ 个通道可以让你前进 $a_i$ 关，也就是说，如果你现在在第 $x$ 关，那么选择第 $i$ 个通道后，你将直接来到第 $x+a_i$ 关（特别地，如果 $x + a_i \\geq N$，那么你就通关了）。此外，当你顺利离开第 $s$ 关时，你还将获得 $b_s$ 分。\n\n游戏开始时，你在第 $0$ 关。请问，你通关时最多能获得多少总分。", "inputFormat": "第一行两个整数 $N$，$M$，分别表示关卡数量和每关的通道数量。\n\n接下来一行 $M$ 个用单个空格隔开的整数 $a_0,a_1\\cdots,a_{M-1}$。保证 $1\\le a_i \\le N$。\n\n接下来一行 $N$ 个用单个空格隔开的整数 $b_0,b_1\\cdots,b_{N-1}$。保证 $|b_i|\\le 10^5$。", "outputFormat": "一行一个整数，表示你通关时最多能够获得的分数。", "hint": "**样例解释 1**\n\n你可以在第 $0$ 关选择第 $1$ 个通道，获得 $1$ 分并来到第 $3$ 关；随后再选择第 $0$ 个通道，获得 $100$ 分并来到第 $5$ 关；最后任选一个通道，都可以获得 $30$ 分并通关。如此，总得分为 $1+100+30=131$。\n\n**样例解释 2**\n\n请注意，一些关卡的得分可能是负数。\n\n\n**数据范围**\n\n对于 $20\\%$ 的测试点，保证 $M=1$。\n\n对于 $40\\%$ 的测试点，保证 $N \\le 20$；保证 $M\\le 2$。\n\n对于所有测试点，保证 $1 \\le N \\le 10^4$；保证 $1 \\le M\\le 100$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[GESP202312 六级] 闯关游戏", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1138>", "description": "你来到了一个闯关游戏。\n\n这个游戏总共有 $N$ 关，每关都有 $M$ 个通道，你需要选择一个通道并通往后续关卡。其中，第 $i$ 个通道可以让你前进 $a_i$ 关，也就是说，如果你现在在第 $x$ 关，那么选择第 $i$ 个通道后，你将直接来到第 $x+a_i$ 关（特别地，如果 $x + a_i \\geq N$，那么你就通关了）。此外，当你顺利离开第 $s$ 关时，你还将获得 $b_s$ 分。\n\n游戏开始时，你在第 $0$ 关。请问，你通关时最多能获得多少总分。", "inputFormat": "第一行两个整数 $N$，$M$，分别表示关卡数量和每关的通道数量。\n\n接下来一行 $M$ 个用单个空格隔开的整数 $a_0,a_1\\cdots,a_{M-1}$。保证 $1\\le a_i \\le N$。\n\n接下来一行 $N$ 个用单个空格隔开的整数 $b_0,b_1\\cdots,b_{N-1}$。保证 $|b_i|\\le 10^5$。", "outputFormat": "一行一个整数，表示你通关时最多能够获得的分数。", "hint": "**样例解释 1**\n\n你可以在第 $0$ 关选择第 $1$ 个通道，获得 $1$ 分并来到第 $3$ 关；随后再选择第 $0$ 个通道，获得 $100$ 分并来到第 $5$ 关；最后任选一个通道，都可以获得 $30$ 分并通关。如此，总得分为 $1+100+30=131$。\n\n**样例解释 2**\n\n请注意，一些关卡的得分可能是负数。\n\n\n**数据范围**\n\n对于 $20\\%$ 的测试点，保证 $M=1$。\n\n对于 $40\\%$ 的测试点，保证 $N \\le 20$；保证 $M\\le 2$。\n\n对于所有测试点，保证 $1 \\le N \\le 10^4$；保证 $1 \\le M\\le 100$。", "locale": "zh-CN"}}}
{"pid": "P10109", "type": "P", "difficulty": 2, "samples": [["5\n0 0 2 2\n3\n2 3 4\n3 2 3 4\n2 1 4", "2\n2\n0"], ["7\n0 1 0 2 1 2\n5\n2 4 6\n2 4 5\n3 4 5 6\n4 2 4 5 6\n2 3 4", "2\n1\n1\n1\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["图论", "2023", "图遍历", "GESP"], "title": "[GESP202312 六级] 工作沟通", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1138>", "description": "某公司有 $N$ 名员工，编号从 $0$ 至 $N-1$。其中，除了 $0$ 号员工是老板，其余每名员工都有一个直接领导。我们假设编号为 $i$ 的员工的直接领导是 $f_i$。\n\n该公司有严格的管理制度，每位员工只能受到本人或直接领导或间接领导的管理。具体来说，规定员工 $x$ 可以管理员工 $y$，当且仅当 $x=y$，或 $x=f_y$，或 $x$ 可以管理 $f_y$。特别地，$0$ 号员工老板只能自我管理，无法由其他任何员工管理。\n\n现在，有一些同事要开展合作，他们希望找到一位同事来主持这场合作，这位同事必须能够管理参与合作的所有同事。如果有多名满足这一条件的员工，他们希望找到编号最大的员工。你能帮帮他们吗？", "inputFormat": "第一行一个整数 $N$，表示员工的数量。\n\n第二行 $N - 1$ 个用空格隔开的正整数，依次为 $f_1,f_2,\\dots f_{N−1}$。\n\n第三行一个整数 $Q$，表示共有 $Q$ 场合作需要安排。\n\n接下来 $Q$ 行，每行描述一场合作：开头是一个整数 $m$（$2 \\le m \\le N$），表示参与本次合作的员工数量；接着是 $m$ 个整数，依次表示参与本次合作的员工编号（保证编号合法且不重复）。\n\n保证公司结构合法，即不存在任意一名员工，其本人是自己的直接或间接领导。", "outputFormat": "输出 $Q$ 行，每行一个整数，依次为每场合作的主持人选。\n", "hint": "**样例解释 1**\n\n对于第一场合作，员工 $3,4$ 有共同领导 $2$ ，可以主持合作。\n\n对于第二场合作，员工 $2$ 本人即可以管理所有参与者。\n\n对于第三场合作，只有 $0$ 号老板才能管理所有员工。\n\n**数据范围**\n\n对于 $50\\%$ 的测试点，保证 $N \\leq 50$。\n\n对于所有测试点，保证 $3 \\leq N \\leq 300$，$Q \\leq 100$。\n\n\n\n------------\n2024/1/28 添加一组 hack 数据。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[GESP202312 六级] 工作沟通", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1138>", "description": "某公司有 $N$ 名员工，编号从 $0$ 至 $N-1$。其中，除了 $0$ 号员工是老板，其余每名员工都有一个直接领导。我们假设编号为 $i$ 的员工的直接领导是 $f_i$。\n\n该公司有严格的管理制度，每位员工只能受到本人或直接领导或间接领导的管理。具体来说，规定员工 $x$ 可以管理员工 $y$，当且仅当 $x=y$，或 $x=f_y$，或 $x$ 可以管理 $f_y$。特别地，$0$ 号员工老板只能自我管理，无法由其他任何员工管理。\n\n现在，有一些同事要开展合作，他们希望找到一位同事来主持这场合作，这位同事必须能够管理参与合作的所有同事。如果有多名满足这一条件的员工，他们希望找到编号最大的员工。你能帮帮他们吗？", "inputFormat": "第一行一个整数 $N$，表示员工的数量。\n\n第二行 $N - 1$ 个用空格隔开的正整数，依次为 $f_1,f_2,\\dots f_{N−1}$。\n\n第三行一个整数 $Q$，表示共有 $Q$ 场合作需要安排。\n\n接下来 $Q$ 行，每行描述一场合作：开头是一个整数 $m$（$2 \\le m \\le N$），表示参与本次合作的员工数量；接着是 $m$ 个整数，依次表示参与本次合作的员工编号（保证编号合法且不重复）。\n\n保证公司结构合法，即不存在任意一名员工，其本人是自己的直接或间接领导。", "outputFormat": "输出 $Q$ 行，每行一个整数，依次为每场合作的主持人选。\n", "hint": "**样例解释 1**\n\n对于第一场合作，员工 $3,4$ 有共同领导 $2$ ，可以主持合作。\n\n对于第二场合作，员工 $2$ 本人即可以管理所有参与者。\n\n对于第三场合作，只有 $0$ 号老板才能管理所有员工。\n\n**数据范围**\n\n对于 $50\\%$ 的测试点，保证 $N \\leq 50$。\n\n对于所有测试点，保证 $3 \\leq N \\leq 300$，$Q \\leq 100$。\n\n\n\n------------\n2024/1/28 添加一组 hack 数据。", "locale": "zh-CN"}}}
{"pid": "P10110", "type": "P", "difficulty": 3, "samples": [["3 5 0 2\n1 2 4\n1 0\n2 0\n0 1\n2 1\n1 2", "5"], ["3 3 0 2\n100 2 4\n0 1\n1 2\n0 2", "-95"], ["4 4 3 0\n1 2 3 4\n1 0\n0 1\n3 2\n2 3", "No solution"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2023", "广度优先搜索 BFS", "最短路", "GESP"], "title": "[GESP202312 七级] 商品交易", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1139>", "description": "市场上共有 $N$ 种商品，编号从 $0$ 至 $N-1$ ，其中，第 $i$ 种商品价值 $v_i$ 元。\n\n现在共有 $M$ 个商人，编号从 $0$ 至 $M-1$ 。在第 $j$ 个商人这，你可以使用你手上的第 $x_j$ 种商品交换商人手上的第 $y_j$ 种商品。每个商人都会按照商品价值进行交易，具体来说，如果 $v_{x_j}>v_{y_j}$，他将会付给你 $v_{x_j}-v_{y_j}$元钱；否则，那么你需要付给商人 $v_{y_j}-v_{x_j}$ 元钱。除此之外，每次交易商人还会收取 $1$ 元作为手续费，不论交易商品的价值孰高孰低。\n\n你现在拥有商品 $a$ ，并希望通过一些交换来获得商品 $b$ 。请问你至少要花费多少钱？（当然，这个最小花费也可能是负数，这表示你可以在完成目标的同时赚取一些钱。）", "inputFormat": "第一行四个整数 $N , M , a , b$，分别表示商品的数量、商人的数量、你持有的商品以及你希望获得的商品。保证 $0 \\le a,b < N$ ，保证 $a \\ne b$。\n\n第二行 $N$ 个用单个空格隔开的正整数 $v_0,v_1,…,v_{N-1}$ ，依次表示每种商品的价值。保证 $1≤v_i≤10^9$。\n\n接下来 $M$ 行，每行两个整数 $x_j,y_j$ ，表示在第 $j$ 个商人这，你可以使用第 $x_j$ 种商品交换第 $y_j$ 种商品。保证 $0≤x_j,y_j<N$，保证 $x_j≠y_j$ 。", "outputFormat": "输出一行一个整数，表示最少的花费。特别地，如果无法通过交换换取商品 $b$ ，请输出 `No solution`。", "hint": "**数据范围**\n\n对于 30% 的测试点，保证 $N ≤ 10$，$M ≤ 20$。\n\n对于 70% 的测试点，保证 $N ≤10^3$，$M≤10^4$。\n\n对于 100% 的测试点，保证 $N≤10^5$，$M≤2×10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[GESP202312 七级] 商品交易", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1139>", "description": "市场上共有 $N$ 种商品，编号从 $0$ 至 $N-1$ ，其中，第 $i$ 种商品价值 $v_i$ 元。\n\n现在共有 $M$ 个商人，编号从 $0$ 至 $M-1$ 。在第 $j$ 个商人这，你可以使用你手上的第 $x_j$ 种商品交换商人手上的第 $y_j$ 种商品。每个商人都会按照商品价值进行交易，具体来说，如果 $v_{x_j}>v_{y_j}$，他将会付给你 $v_{x_j}-v_{y_j}$元钱；否则，那么你需要付给商人 $v_{y_j}-v_{x_j}$ 元钱。除此之外，每次交易商人还会收取 $1$ 元作为手续费，不论交易商品的价值孰高孰低。\n\n你现在拥有商品 $a$ ，并希望通过一些交换来获得商品 $b$ 。请问你至少要花费多少钱？（当然，这个最小花费也可能是负数，这表示你可以在完成目标的同时赚取一些钱。）", "inputFormat": "第一行四个整数 $N , M , a , b$，分别表示商品的数量、商人的数量、你持有的商品以及你希望获得的商品。保证 $0 \\le a,b < N$ ，保证 $a \\ne b$。\n\n第二行 $N$ 个用单个空格隔开的正整数 $v_0,v_1,…,v_{N-1}$ ，依次表示每种商品的价值。保证 $1≤v_i≤10^9$。\n\n接下来 $M$ 行，每行两个整数 $x_j,y_j$ ，表示在第 $j$ 个商人这，你可以使用第 $x_j$ 种商品交换第 $y_j$ 种商品。保证 $0≤x_j,y_j<N$，保证 $x_j≠y_j$ 。", "outputFormat": "输出一行一个整数，表示最少的花费。特别地，如果无法通过交换换取商品 $b$ ，请输出 `No solution`。", "hint": "**数据范围**\n\n对于 30% 的测试点，保证 $N ≤ 10$，$M ≤ 20$。\n\n对于 70% 的测试点，保证 $N ≤10^3$，$M≤10^4$。\n\n对于 100% 的测试点，保证 $N≤10^5$，$M≤2×10^5$。", "locale": "zh-CN"}}}
{"pid": "P10111", "type": "P", "difficulty": 3, "samples": [["4\n1 2 10 100\n1 100 1\n1 1 2 0", "219"], ["6\n3 7 2 8 9 4\n1 3 9 27 81\n0 1 2 1 2 0", "56"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "2023", "GESP"], "title": "[GESP202312 七级] 纸牌游戏", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1139>", "description": "你和小杨在玩一个纸牌游戏。\n\n你和小杨各有 $3$ 张牌，分别是 $0、1、2$。你们要进行 $N$ 轮游戏，每轮游戏双方都要出一张牌，并按 $1$ 战胜 $0$，$2$ 战胜 $1$，$0$ 战胜 $2$ 的规则决出胜负。第 $i$ 轮的胜者可以获得 $2 \\times a_i$ 分，败者不得分，如果双方出牌相同，则算平局，二人都可获得 $a_i$ 分 $(i=1,2,\\cdots,N)$。\n\n玩了一会后，你们觉得这样太过于单调，于是双方给自己制定了不同的新规则。小杨会在整局游戏开始前确定自己全部 $n$ 轮的出牌，并将他的全部计划告诉你；而你从第 $2$ 轮开始，要么继续出上一轮出的牌，要么记一次“换牌”。游戏结束时，你换了 $t$ 次牌，就要额外扣 $b_1+\\cdots+b_t$ 分。\n\n请计算出你最多能获得多少分。", "inputFormat": "第一行一个整数 $N$，表示游戏轮数。\n\n第二行 $N$ 个用单个空格隔开的非负整数 $a_1,\\cdots,a_N$，意义见题目描述。\n\n第三行 $N-1$ 个用单个空格隔开的非负整数 $b_1,\\cdots,b_{N-1}$，表示换牌的罚分，具体含义见题目描述。由于游戏进行 $N$ 轮，所以你至多可以换 $N-1$ 次牌。\n\n第四行 $N$ 个用单个空格隔开的整数 $c_1,\\cdots,c_N$，依次表示小杨从第 $1$ 轮至第 $N$ 轮出的牌。保证 $c\n_i\\in{0,1,2}$。", "outputFormat": "一行一个整数，表示你最多获得的分数。", "hint": "**样例解释 1**\n\n你可以第 $1$ 轮出 $0$，并在第 $2,3$ 轮保持不变，如此输掉第 $1,2$ 轮，但在第 $3$ 轮中取胜，获得 $2×10=20$ 分；\n\n随后，你可以在第 $4$ 轮中以扣 $1$ 分为代价改出 $1$ ，并在第 $4$ 轮中取得胜利，获得 $2×100=200$ 分。\n\n如此，你可以获得最高的总分 $20+200-1=219$。\n\n**数据范围**\n\n对于 $30\\%$ 的测试点，保证 $N\\le15$。\n\n对于 $60\\%$ 的测试点，保证 $N\\le100$。\n\n对于所有测试点，保证 $N \\le 1,000$；保证 $0 \\le a_i,b_i \\le 10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[GESP202312 七级] 纸牌游戏", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1139>", "description": "你和小杨在玩一个纸牌游戏。\n\n你和小杨各有 $3$ 张牌，分别是 $0、1、2$。你们要进行 $N$ 轮游戏，每轮游戏双方都要出一张牌，并按 $1$ 战胜 $0$，$2$ 战胜 $1$，$0$ 战胜 $2$ 的规则决出胜负。第 $i$ 轮的胜者可以获得 $2 \\times a_i$ 分，败者不得分，如果双方出牌相同，则算平局，二人都可获得 $a_i$ 分 $(i=1,2,\\cdots,N)$。\n\n玩了一会后，你们觉得这样太过于单调，于是双方给自己制定了不同的新规则。小杨会在整局游戏开始前确定自己全部 $n$ 轮的出牌，并将他的全部计划告诉你；而你从第 $2$ 轮开始，要么继续出上一轮出的牌，要么记一次“换牌”。游戏结束时，你换了 $t$ 次牌，就要额外扣 $b_1+\\cdots+b_t$ 分。\n\n请计算出你最多能获得多少分。", "inputFormat": "第一行一个整数 $N$，表示游戏轮数。\n\n第二行 $N$ 个用单个空格隔开的非负整数 $a_1,\\cdots,a_N$，意义见题目描述。\n\n第三行 $N-1$ 个用单个空格隔开的非负整数 $b_1,\\cdots,b_{N-1}$，表示换牌的罚分，具体含义见题目描述。由于游戏进行 $N$ 轮，所以你至多可以换 $N-1$ 次牌。\n\n第四行 $N$ 个用单个空格隔开的整数 $c_1,\\cdots,c_N$，依次表示小杨从第 $1$ 轮至第 $N$ 轮出的牌。保证 $c\n_i\\in{0,1,2}$。", "outputFormat": "一行一个整数，表示你最多获得的分数。", "hint": "**样例解释 1**\n\n你可以第 $1$ 轮出 $0$，并在第 $2,3$ 轮保持不变，如此输掉第 $1,2$ 轮，但在第 $3$ 轮中取胜，获得 $2×10=20$ 分；\n\n随后，你可以在第 $4$ 轮中以扣 $1$ 分为代价改出 $1$ ，并在第 $4$ 轮中取得胜利，获得 $2×100=200$ 分。\n\n如此，你可以获得最高的总分 $20+200-1=219$。\n\n**数据范围**\n\n对于 $30\\%$ 的测试点，保证 $N\\le15$。\n\n对于 $60\\%$ 的测试点，保证 $N\\le100$。\n\n对于所有测试点，保证 $N \\le 1,000$；保证 $0 \\le a_i,b_i \\le 10^6$。", "locale": "zh-CN"}}}
{"pid": "P10112", "type": "P", "difficulty": 3, "samples": [["3\n3 2 1 2\n3 2 1 3\n5 3 1 3 1 ", "3\n4\n20"], ["5\n100 1 100\n100 1 101\n20 2 12 8\n123 4 80 20 21 3\n999 5 101 234 499 66 99", "1\n1\n125970\n895031741\n307187590"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "2023", "组合数学", "排列组合", "GESP"], "title": "[GESP202312 八级] 奖品分配", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1140>", "description": "班上有 $N$ 名同学，学号从 $0$ 到 $N-1$。有 $M$ 种奖品要分给这些同学，其中，第 $i$ 种奖品总共有 $a_i$ 个 （$i=0,1, \\cdots ,M-1$）。\n\n巧合的是，奖品的数量不多不少，每位同学都可以恰好分到一个奖品，且最后剩余的奖品不超过 $1$ 个（即：$N\\le a_0+a_1+ \\cdots +a_{M-1}\\le N+1$）。\n\n现在，请你求出每个班级礼物分配的方案数，所谓方案，指的是为每位同学都分配一个种类的奖品。\n\n只要有一位同学获得了不同种类的奖品，即视为不同的方案。方便起见，你只需要输出方案数对 $10^{9}+7$ 取模后的结果即可。\n\n共有 $T$ 个班级都面临着奖品分配的问题，你需要依次为他们解答。", "inputFormat": "第一行一个整数 $T$，表示班级数量。\n\n接下来 $T$ 行，每行若干用单个空格隔开的正整数。首先是两个正整数$N,M$，接着是 $M$ 个正整数 $a_0,a_1...a_{M-1}$。保证 $N \\le a_0+a_1+\\cdots+a_{M-1} \\le N+1 $。", "outputFormat": "输出 $T$ 行，每行一个整数，表示该班级分配奖品的方案数对 $10^{9}+7$ 取模的结果。", "hint": "**样例解释 1**\n\n对于第 $1$ 个班级，学号为 $0,1,2$ 的同学可以依次分别获得奖品 $0,1,1$，也可以依次分别获得奖品 $1,0,1$，也可以依次分别获得奖品 $1,1,0$ ，因此共有 $3$ 种方案。\n\n对于第 $2$ 个班级，学号为 $0,1,2$ 的同学可以依次分别获得奖品 $0,1,1$ ，也可以依次分别获得奖品 $1,0,1$，也可以依次分别获得奖品 $1,1,0$，也可以依次分别获得奖品 $1,1,1$，因此共有 $4$ 种方案。\n\n对于第 $3$ 个班级，可以把编号为 $0$ 的奖品分配给 $5$ 名同学中的任意一名，共有 $5$ 种方案；再把编号为 $2$ 的奖品分配给剩余 $4$ 名同学中的任意一名，共有$4$ 种方案；最后给剩余 $3$ 名同学自然获得 $1$ 号奖品。因此，方案数为 $5 \\times 4 = 20$。\n\n**数据范围**\n\n对于 $30\\%$ 的测试点，保证 $N \\le 10$。\n\n对于另外 $30\\%$ 的测试点，保证 $M=2$。\n\n对于所有测试点，保证 $N \\le 1000$；保证 $T \\le 1000$ ；保证 $M \\le 1001$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[GESP202312 八级] 奖品分配", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1140>", "description": "班上有 $N$ 名同学，学号从 $0$ 到 $N-1$。有 $M$ 种奖品要分给这些同学，其中，第 $i$ 种奖品总共有 $a_i$ 个 （$i=0,1, \\cdots ,M-1$）。\n\n巧合的是，奖品的数量不多不少，每位同学都可以恰好分到一个奖品，且最后剩余的奖品不超过 $1$ 个（即：$N\\le a_0+a_1+ \\cdots +a_{M-1}\\le N+1$）。\n\n现在，请你求出每个班级礼物分配的方案数，所谓方案，指的是为每位同学都分配一个种类的奖品。\n\n只要有一位同学获得了不同种类的奖品，即视为不同的方案。方便起见，你只需要输出方案数对 $10^{9}+7$ 取模后的结果即可。\n\n共有 $T$ 个班级都面临着奖品分配的问题，你需要依次为他们解答。", "inputFormat": "第一行一个整数 $T$，表示班级数量。\n\n接下来 $T$ 行，每行若干用单个空格隔开的正整数。首先是两个正整数$N,M$，接着是 $M$ 个正整数 $a_0,a_1...a_{M-1}$。保证 $N \\le a_0+a_1+\\cdots+a_{M-1} \\le N+1 $。", "outputFormat": "输出 $T$ 行，每行一个整数，表示该班级分配奖品的方案数对 $10^{9}+7$ 取模的结果。", "hint": "**样例解释 1**\n\n对于第 $1$ 个班级，学号为 $0,1,2$ 的同学可以依次分别获得奖品 $0,1,1$，也可以依次分别获得奖品 $1,0,1$，也可以依次分别获得奖品 $1,1,0$ ，因此共有 $3$ 种方案。\n\n对于第 $2$ 个班级，学号为 $0,1,2$ 的同学可以依次分别获得奖品 $0,1,1$ ，也可以依次分别获得奖品 $1,0,1$，也可以依次分别获得奖品 $1,1,0$，也可以依次分别获得奖品 $1,1,1$，因此共有 $4$ 种方案。\n\n对于第 $3$ 个班级，可以把编号为 $0$ 的奖品分配给 $5$ 名同学中的任意一名，共有 $5$ 种方案；再把编号为 $2$ 的奖品分配给剩余 $4$ 名同学中的任意一名，共有$4$ 种方案；最后给剩余 $3$ 名同学自然获得 $1$ 号奖品。因此，方案数为 $5 \\times 4 = 20$。\n\n**数据范围**\n\n对于 $30\\%$ 的测试点，保证 $N \\le 10$。\n\n对于另外 $30\\%$ 的测试点，保证 $M=2$。\n\n对于所有测试点，保证 $N \\le 1000$；保证 $T \\le 1000$ ；保证 $M \\le 1001$。", "locale": "zh-CN"}}}
{"pid": "P10113", "type": "P", "difficulty": 3, "samples": [["5\n0 0 2 2\n3\n2 3 4\n3 2 3 4\n2 1 4", "2\n2\n0"], ["7\n0 1 0 2 1 2\n5\n2 4 6\n2 4 5\n3 4 5 6\n4 2 4 5 6\n2 3 4", "2\n1\n1\n1\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2023", "最近公共祖先 LCA", "GESP"], "title": "[GESP202312 八级] 大量的工作沟通", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1140>", "description": "某公司有 $N$ 名员工，编号从 $0$ 至 $N-1$。其中，除了 $0$ 号员工是老板，其余每名员工都有一个直接领导。我们假设编号为 $i$ 的员工的直接领导是 $f_i$。\n\n该公司有严格的管理制度，每位员工只能受到本人或直接领导或间接领导的管理。具体来说，规定员工 $x$ 可以管理员工 $y$，当且仅当 $x=y$，或 $x=f_y$，或 $x$ 可以管理 $f_y$。特别地，$0$ 号员工老板只能自我管理，无法由其他任何员工管理。\n\n现在，有一些同事要开展合作，他们希望找到一位同事来主持这场合作，这位同事必须能够管理参与合作的所有同事。如果有多名满足这一条件的员工，他们希望找到编号最大的员工。你能帮帮他们吗？", "inputFormat": "第一行一个整数 $N$ ，表示员工的数量。\n\n第二行 $N-1$ 个用空格隔开的正整数，依次为 $f_1, f_2, \\dots f_{N-1}$。\n\n第三行一个整数 $Q$ ，表示共有 $Q$ 场合作需要安排。\n\n接下来 $Q$ 行，每行描述一场合作：开头是一个整数 $m$（$2 \\leq m \\leq N$），表示参与本次合作的员工数量；接着是 $m$ 个整数，依次表示参与本次合作的员工编号（保证编号合法且不重复）。\n\n保证公司结构合法，即不存在任意一名员工，其本人是自己的直接或间接领导。", "outputFormat": "输出 $Q$ 行，每行一个整数，依次为每场合作的主持人选。\n", "hint": "**样例解释 1**\n\n对于第一场合作，员工 $3,4$ 有共同领导 $2$ ，可以主持合作。\n\n对于第二场合作，员工 $2$ 本人即可以管理所有参与者。\n\n对于第三场合作，只有 $0$ 号老板才能管理所有员工。\n\n**数据范围**\n\n对于 $25\\%$ 的测试点，保证 $N \\leq 50$。 \n\n对于 $50\\%$ 的测试点，保证 $N \\leq 300$。\n\n对于所有测试点，保证 $3 \\leq N \\leq 10^5$，$Q \\leq 100$，$m \\leq 10^4$。\n\n\n------------\n2024/2/8 添加一组 hack 数据。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[GESP202312 八级] 大量的工作沟通", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1140>", "description": "某公司有 $N$ 名员工，编号从 $0$ 至 $N-1$。其中，除了 $0$ 号员工是老板，其余每名员工都有一个直接领导。我们假设编号为 $i$ 的员工的直接领导是 $f_i$。\n\n该公司有严格的管理制度，每位员工只能受到本人或直接领导或间接领导的管理。具体来说，规定员工 $x$ 可以管理员工 $y$，当且仅当 $x=y$，或 $x=f_y$，或 $x$ 可以管理 $f_y$。特别地，$0$ 号员工老板只能自我管理，无法由其他任何员工管理。\n\n现在，有一些同事要开展合作，他们希望找到一位同事来主持这场合作，这位同事必须能够管理参与合作的所有同事。如果有多名满足这一条件的员工，他们希望找到编号最大的员工。你能帮帮他们吗？", "inputFormat": "第一行一个整数 $N$ ，表示员工的数量。\n\n第二行 $N-1$ 个用空格隔开的正整数，依次为 $f_1, f_2, \\dots f_{N-1}$。\n\n第三行一个整数 $Q$ ，表示共有 $Q$ 场合作需要安排。\n\n接下来 $Q$ 行，每行描述一场合作：开头是一个整数 $m$（$2 \\leq m \\leq N$），表示参与本次合作的员工数量；接着是 $m$ 个整数，依次表示参与本次合作的员工编号（保证编号合法且不重复）。\n\n保证公司结构合法，即不存在任意一名员工，其本人是自己的直接或间接领导。", "outputFormat": "输出 $Q$ 行，每行一个整数，依次为每场合作的主持人选。\n", "hint": "**样例解释 1**\n\n对于第一场合作，员工 $3,4$ 有共同领导 $2$ ，可以主持合作。\n\n对于第二场合作，员工 $2$ 本人即可以管理所有参与者。\n\n对于第三场合作，只有 $0$ 号老板才能管理所有员工。\n\n**数据范围**\n\n对于 $25\\%$ 的测试点，保证 $N \\leq 50$。 \n\n对于 $50\\%$ 的测试点，保证 $N \\leq 300$。\n\n对于所有测试点，保证 $3 \\leq N \\leq 10^5$，$Q \\leq 100$，$m \\leq 10^4$。\n\n\n------------\n2024/2/8 添加一组 hack 数据。", "locale": "zh-CN"}}}
{"pid": "P10114", "type": "P", "difficulty": 4, "samples": [["2\n1 3 ", "7"], ["10\n114514 19 19 810 1477 44151 15260 369 2010 222", "1396"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化"], "title": "[LMXOI Round 1] Size", "background": "在漆黑的夜晚，魔女带走了 LMX，HQZ 为了拯救 LMX。要完成魔女给出的任务。", "description": "魔女给出一个长度为 $n$ 的序列 $d$，魔女想要求得：\n\n$$\\sum\\limits_{i=1}^{ n}\\sum\\limits_{j=1}^{n}{((d_i\\oplus d_j)+(d_i \\otimes d_j))}$$\n\n其中定义 $\\oplus$ 代表二进制下两数相加的和数位上 $1$ 的个数， $\\otimes$ 代表二进制下较大减较小的差数位上 $1$ 的个数。", "inputFormat": "一行一个整数 $n$ 表示序列的长度。\n\n第二行 $n$ 个非负整数，表示序列 $d$。", "outputFormat": "一行一个整数表示答案。", "hint": "**样例解释 #1**\n\n如下表所示，因此答案为 $1 + 2 + 2 + 2 = 7$。\n| $i$ | $j$ | $ans$ |\n| :-----: | :-----: | :-------: |\n| $1$ | $1$ | $1$ |\n| $1$ | $2$ | $2$ |\n| $2$ | $1$ | $2$ |\n| $2$ | $2$ | $2$ |\n\n\n对于 $100 \\%$ 的数据，保证 $1 \\le n\\le 2\\times 10^6,\\sum\\limits d_i\\le5\\times10^7$。 \n| 子任务编号 |     $n$     |          特殊性质          | 分值 |\n| :--------: | :------------------: | :-------------------------: | :--: |\n| Subtask #1 |     $\\le 2\\times10^6 $     |   $d_i =1$       |  $10$  |\n| Subtask #2 |     $\\le 5000$     |      无      |  $20$  |\n| Subtask #3 | $\\le 2\\times 10^6$ | $d_i$ 是 $2$ 的次幂 |  $30$  |\n| Subtask #4 | $\\le 2\\times 10^6$ |      无      |  $40$  |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[LMXOI Round 1] Size", "background": "在漆黑的夜晚，魔女带走了 LMX，HQZ 为了拯救 LMX。要完成魔女给出的任务。", "description": "魔女给出一个长度为 $n$ 的序列 $d$，魔女想要求得：\n\n$$\\sum\\limits_{i=1}^{ n}\\sum\\limits_{j=1}^{n}{((d_i\\oplus d_j)+(d_i \\otimes d_j))}$$\n\n其中定义 $\\oplus$ 代表二进制下两数相加的和数位上 $1$ 的个数， $\\otimes$ 代表二进制下较大减较小的差数位上 $1$ 的个数。", "inputFormat": "一行一个整数 $n$ 表示序列的长度。\n\n第二行 $n$ 个非负整数，表示序列 $d$。", "outputFormat": "一行一个整数表示答案。", "hint": "**样例解释 #1**\n\n如下表所示，因此答案为 $1 + 2 + 2 + 2 = 7$。\n| $i$ | $j$ | $ans$ |\n| :-----: | :-----: | :-------: |\n| $1$ | $1$ | $1$ |\n| $1$ | $2$ | $2$ |\n| $2$ | $1$ | $2$ |\n| $2$ | $2$ | $2$ |\n\n\n对于 $100 \\%$ 的数据，保证 $1 \\le n\\le 2\\times 10^6,\\sum\\limits d_i\\le5\\times10^7$。 \n| 子任务编号 |     $n$     |          特殊性质          | 分值 |\n| :--------: | :------------------: | :-------------------------: | :--: |\n| Subtask #1 |     $\\le 2\\times10^6 $     |   $d_i =1$       |  $10$  |\n| Subtask #2 |     $\\le 5000$     |      无      |  $20$  |\n| Subtask #3 | $\\le 2\\times 10^6$ | $d_i$ 是 $2$ 的次幂 |  $30$  |\n| Subtask #4 | $\\le 2\\times 10^6$ |      无      |  $40$  |", "locale": "zh-CN"}}}
{"pid": "P10115", "type": "P", "difficulty": 4, "samples": [["5\n()(()\n1 3 2 3 5", "4"], ["10\n()((())())\n2 4 1 7 3 2 8 4 9 5", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "枚举"], "title": "[LMXOI Round 1] Placer", "background": "LMX 最近迷上了括号序列，她尤其钟爱合法括号序列。\n\nLMX 为了检验 HQZ 的真诚，于是她出一道题准备考验下 HQZ。\n", "description": "LMX 给出了一个长度为 $n$ 括号序列 $S$，以及一个长度为 $n$ 的序列 $a_i$。\n\n定义 $w(l,r)=\n\\begin{cases}\na_r-a_l, & S_{l..r} \\text{为合法括号序列}\\\\\n\\ 0 & \\text{otherwise}\n\\end{cases}$\n\n你可以将序列分成若干非空子段，定义整个序列的美丽度为每段的 $w(l , r)$ 之和。\n\n求美丽度最大为多少。", "inputFormat": "第一行一个整数 $n$。\n\n第二行一个字符串，代表括号序列。\n\n第三行代表序列 $a$。", "outputFormat": "第一行一个整数，表示最大的美丽度。", "hint": "**样例解释 #1**\n\n原串可以划分成三个区间：$[1,2],[3,3],[4,5]$。贡献为 $(a_2-a_1)+0+(a_5-a_4)=(3-1)+0+(5-3)=4$\n\n| 子任务编号 | $n$ | 特殊性质 | 分值 |\n| :--------: | :--------: | :-------------: | :--: |\n| Subtask #1 | $\\le 5000$ | 无 | $30$ |\n| Subtask #2 | $\\le 10 ^ 5$ | 无 | $20$ |\n| Subtask #3 | $\\le 3 \\times 10 ^ 6$ | 括号序列为 $()()\\dots()$ | $15$ |\n| Subtask #4 | $\\le 3 \\times 10 ^ 6$ | 无 | $35$ |\n\n对于 $100\\%$ 的数据，$1\\le a_i \\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[LMXOI Round 1] Placer", "background": "LMX 最近迷上了括号序列，她尤其钟爱合法括号序列。\n\nLMX 为了检验 HQZ 的真诚，于是她出一道题准备考验下 HQZ。\n", "description": "LMX 给出了一个长度为 $n$ 括号序列 $S$，以及一个长度为 $n$ 的序列 $a_i$。\n\n定义 $w(l,r)=\n\\begin{cases}\na_r-a_l, & S_{l..r} \\text{为合法括号序列}\\\\\n\\ 0 & \\text{otherwise}\n\\end{cases}$\n\n你可以将序列分成若干非空子段，定义整个序列的美丽度为每段的 $w(l , r)$ 之和。\n\n求美丽度最大为多少。", "inputFormat": "第一行一个整数 $n$。\n\n第二行一个字符串，代表括号序列。\n\n第三行代表序列 $a$。", "outputFormat": "第一行一个整数，表示最大的美丽度。", "hint": "**样例解释 #1**\n\n原串可以划分成三个区间：$[1,2],[3,3],[4,5]$。贡献为 $(a_2-a_1)+0+(a_5-a_4)=(3-1)+0+(5-3)=4$\n\n| 子任务编号 | $n$ | 特殊性质 | 分值 |\n| :--------: | :--------: | :-------------: | :--: |\n| Subtask #1 | $\\le 5000$ | 无 | $30$ |\n| Subtask #2 | $\\le 10 ^ 5$ | 无 | $20$ |\n| Subtask #3 | $\\le 3 \\times 10 ^ 6$ | 括号序列为 $()()\\dots()$ | $15$ |\n| Subtask #4 | $\\le 3 \\times 10 ^ 6$ | 无 | $35$ |\n\n对于 $100\\%$ 的数据，$1\\le a_i \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P10116", "type": "P", "difficulty": 5, "samples": [["3 2 2 2\n1 1", "4"], ["2 1 2 2\n1 1", "12"], ["10 3 114 51419\n19 2", "266405589"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "组合数学", "容斥原理"], "title": "[LMXOI Round 1] Random", "background": "LMX 给 HQZ 一个有趣的序列，HQZ 为了了解 LMX 的爱好，想要解决下面的问题。  ", "description": "给出一个初始全为 $0$ 长为 $n$ 的序列，我们会进行如下操作 $q$ 次。\n\n+ 任意选择一个位置 $t$ 并把上面的数字修改成任意一个 $1$ 到 $k$ 之间的数。\n\n也就是说我们一共会有 $(nk)^q$ 种不同的询问序列，而对于每一种不同的询问序列，对应的也就拥有了 $(nk)^q$ 个结果序列。\n\n接着，给出一个长度为 $m$ 匹配序列 $B$，需要求出这个匹配序列在每一个结果序列中出现的次数和。注意，一个结果序列中若出现多个匹配序列应当重复计算。\n\n由于答案太大，你只需要输出答案对 $998244353$ 取模后的结果。\n\n**本题使用特定方式生成输入数据。**\n\n生成格式如下： $x_i=(a \\times i+b)\\bmod k +1$ ，其中 $x_i$ 表示序列 $B$ 第 $i$ 位所需求的数字。", "inputFormat": "第一行四个整数 $n,m,q,k$ 其中 $m$ 为 $B$ 序列的长度。\n\n第二行二个整数 $a,b$。", "outputFormat": "一行一个整数表示答案。", "hint": "**样例解释 #1**\n\n下述操作序列，存在序列 $B$：\n+ $[1,1],[2,2]$ 序列为 $[1,2,0]$\n+ $[2,2],[1,1]$ 序列为 $[1,2,0]$\n+ $[2,1],[3,2]$ 序列为 $[0,1,2]$\n+ $[3,2],[2,1]$ 序列为 $[0,1,2]$\n\n对于 $100\\%$ 的数据，保证 $\\forall x_i \\in B, 1\\le x_i\\le k$，$0 \\le a,b\\le 10^9$，且 $m\\le n$。\n\n| 子任务编号 |      $n,q,k$      |    $m$    | 特殊性质 |  分值  |\n| :--------: | :------------------: | :----------: | :------: | :----: |\n| Subtask #1 |     $\\le 10^9$     | $\\le 200$ | $q< m$ | $5$ |\n| Subtask #2 |      $\\le 4$      |  $\\le 4$  |    无    | $10$ |\n| Subtask #3 |     $\\le 500$     | $\\le 200$ |    无    | $10$ |\n| Subtask #4 | $\\le 2\\times 10^5$ | $\\le 200$ |    无    | $20$ |\n| Subtask #5 |     $\\le 10^9$     | $\\le 200$ |    无    | $20$ |\n| Subtask #6 |     $\\le 10^9$     | $\\le 3\\times 10^6$ |    无    |   $35$   |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[LMXOI Round 1] Random", "background": "LMX 给 HQZ 一个有趣的序列，HQZ 为了了解 LMX 的爱好，想要解决下面的问题。  ", "description": "给出一个初始全为 $0$ 长为 $n$ 的序列，我们会进行如下操作 $q$ 次。\n\n+ 任意选择一个位置 $t$ 并把上面的数字修改成任意一个 $1$ 到 $k$ 之间的数。\n\n也就是说我们一共会有 $(nk)^q$ 种不同的询问序列，而对于每一种不同的询问序列，对应的也就拥有了 $(nk)^q$ 个结果序列。\n\n接着，给出一个长度为 $m$ 匹配序列 $B$，需要求出这个匹配序列在每一个结果序列中出现的次数和。注意，一个结果序列中若出现多个匹配序列应当重复计算。\n\n由于答案太大，你只需要输出答案对 $998244353$ 取模后的结果。\n\n**本题使用特定方式生成输入数据。**\n\n生成格式如下： $x_i=(a \\times i+b)\\bmod k +1$ ，其中 $x_i$ 表示序列 $B$ 第 $i$ 位所需求的数字。", "inputFormat": "第一行四个整数 $n,m,q,k$ 其中 $m$ 为 $B$ 序列的长度。\n\n第二行二个整数 $a,b$。", "outputFormat": "一行一个整数表示答案。", "hint": "**样例解释 #1**\n\n下述操作序列，存在序列 $B$：\n+ $[1,1],[2,2]$ 序列为 $[1,2,0]$\n+ $[2,2],[1,1]$ 序列为 $[1,2,0]$\n+ $[2,1],[3,2]$ 序列为 $[0,1,2]$\n+ $[3,2],[2,1]$ 序列为 $[0,1,2]$\n\n对于 $100\\%$ 的数据，保证 $\\forall x_i \\in B, 1\\le x_i\\le k$，$0 \\le a,b\\le 10^9$，且 $m\\le n$。\n\n| 子任务编号 |      $n,q,k$      |    $m$    | 特殊性质 |  分值  |\n| :--------: | :------------------: | :----------: | :------: | :----: |\n| Subtask #1 |     $\\le 10^9$     | $\\le 200$ | $q< m$ | $5$ |\n| Subtask #2 |      $\\le 4$      |  $\\le 4$  |    无    | $10$ |\n| Subtask #3 |     $\\le 500$     | $\\le 200$ |    无    | $10$ |\n| Subtask #4 | $\\le 2\\times 10^5$ | $\\le 200$ |    无    | $20$ |\n| Subtask #5 |     $\\le 10^9$     | $\\le 200$ |    无    | $20$ |\n| Subtask #6 |     $\\le 10^9$     | $\\le 3\\times 10^6$ |    无    |   $35$   |", "locale": "zh-CN"}}}
{"pid": "P10117", "type": "P", "difficulty": 5, "samples": [["5\n3 998244353\n3\n3 2\n5 1\n7 1\n4 1000000009\n2\n2 1\n3 2\n1 998244353\n2\n2 2\n3 1\n11451 191981012\n11\n2 1\n3 1\n5 1\n7 1\n11 1\n13 1\n17 1\n19 1\n23 1\n29 1\n31 1\n514 520\n2\n2 10\n3 10", "189282114\n124678\n14965\n82966193\n260\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [30720, 30720, 30720, 30720, 30720, 30720, 30720, 30720, 30720, 30720, 30720, 30720, 30720, 30720, 30720, 30720, 30720, 30720, 30720, 30720]}, "tags": ["数论", "O2优化"], "title": "[LMXOI Round 1] Dreamer", "background": "[加强版链接](https://www.luogu.com.cn/problem/U402756)。\n\n这是一道数学题，可是 LMX 给 HQZ 出的。", "description": "定义积性函数 $f(n)=(\\mu \\ast\\operatorname{Id_2})(n)$。\n\n给定 $n,k$，你需要求出 \n\n$$\\sum_{i_1\\mid n}\\sum_{i_2\\mid i_1}\\cdots\\sum_{i_k\\mid i_{k-1}}f(i_k)i_1i_k\\mu^2\\left(\\dfrac{i_1}{i_k}\\right)$$\n\n#### Tips：\n\n$\\mu$ 表示莫比乌斯函数。\n\n关于 $f$，$f(n)=\\displaystyle \\sum_{d\\mid n}\\mu(d)\\left(\\dfrac{n}{d}\\right)^2$。", "inputFormat": "本题有多组数据，第一行输入一个正整数 $T$，表示数据组数。\n\n考虑到 $n$ 很大，所以我们会给出 $n$ 的标准质因子分解 $n=\\displaystyle \\prod_{i=1}^t p_i^{\\alpha_i}$。\n\n对于每一组询问，我们首先给出两个整数 $k,m$。\n\n第二行给出 $t$，下面 $t$ 行每行两个整数表示 $p_i,\\alpha_i$。\n\n（保证 $p_i\\ge p_{i-1},i\\ge 2$，$\\alpha_i\\ge 1$）。\n", "outputFormat": "对于每个询问，输出一行表示答案 $\\mod m$ 的值。", "hint": "对于 $100\\%$ 的数据，有 $T \\le 20,n\\le 10^{24},1\\le k\\le 10^6,m\\le 1.14\\times 10^9$。\n\n| 测试点编号 |      $n$      |    $k$     |   $T$    | 特殊性质 |\n| :--------: | :-----------: | :--------: | :------: | :------: |\n|    $1$     |   $\\le 80$    |  $\\le 4$   | $\\le 5$  |   $N$    |\n|    $2$     |  $\\le 10^6$   |  $\\le 10$  | $\\le 5$  |   $N$    |\n|    $3$     | $\\le 10^{12}$ |  $\\le 20$  | $\\le 20$ |   $N$    |\n|    $4$     | $\\le 10^{18}$ |  $\\le 1$   | $\\le 20$ |   $N$    |\n|    $5$     | $\\le 10^{18}$ | $\\le 10^3$ | $\\le 20$ |   $N$    |\n|    $6$     | $\\le 10^{18}$ | $\\le 10^5$ | $\\le 20$ |   $A$    |\n|    $7$     | $\\le 10^{18}$ | $\\le 10^6$ | $\\le 20$ |   $B$    |\n|    $8$     | $\\le 10^{24}$ | $\\le 10^6$ | $\\le 20$ |   $B$    |\n|    $9$     | $\\le 10^{24}$ | $\\le 10^6$ | $\\le 20$ |   $C$    |\n|    $10\\sim20$    | $\\le 10^{24}$ | $\\le 10^6$ | $\\le 20$ |   $N$    |\n\n性质 $A$：保证 $t\\le 10$。\n\n性质 $B$：保证 $n$ 的质因子分解 $\\displaystyle\\prod_{i=1}^t p_i^{\\alpha_i}$ 中 $\\alpha_i=1$。\n\n性质 $C$：$m$ 是素数，且保证 $\\gcd(n,m)=1$。\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[LMXOI Round 1] Dreamer", "background": "[加强版链接](https://www.luogu.com.cn/problem/U402756)。\n\n这是一道数学题，可是 LMX 给 HQZ 出的。", "description": "定义积性函数 $f(n)=(\\mu \\ast\\operatorname{Id_2})(n)$。\n\n给定 $n,k$，你需要求出 \n\n$$\\sum_{i_1\\mid n}\\sum_{i_2\\mid i_1}\\cdots\\sum_{i_k\\mid i_{k-1}}f(i_k)i_1i_k\\mu^2\\left(\\dfrac{i_1}{i_k}\\right)$$\n\n#### Tips：\n\n$\\mu$ 表示莫比乌斯函数。\n\n关于 $f$，$f(n)=\\displaystyle \\sum_{d\\mid n}\\mu(d)\\left(\\dfrac{n}{d}\\right)^2$。", "inputFormat": "本题有多组数据，第一行输入一个正整数 $T$，表示数据组数。\n\n考虑到 $n$ 很大，所以我们会给出 $n$ 的标准质因子分解 $n=\\displaystyle \\prod_{i=1}^t p_i^{\\alpha_i}$。\n\n对于每一组询问，我们首先给出两个整数 $k,m$。\n\n第二行给出 $t$，下面 $t$ 行每行两个整数表示 $p_i,\\alpha_i$。\n\n（保证 $p_i\\ge p_{i-1},i\\ge 2$，$\\alpha_i\\ge 1$）。\n", "outputFormat": "对于每个询问，输出一行表示答案 $\\mod m$ 的值。", "hint": "对于 $100\\%$ 的数据，有 $T \\le 20,n\\le 10^{24},1\\le k\\le 10^6,m\\le 1.14\\times 10^9$。\n\n| 测试点编号 |      $n$      |    $k$     |   $T$    | 特殊性质 |\n| :--------: | :-----------: | :--------: | :------: | :------: |\n|    $1$     |   $\\le 80$    |  $\\le 4$   | $\\le 5$  |   $N$    |\n|    $2$     |  $\\le 10^6$   |  $\\le 10$  | $\\le 5$  |   $N$    |\n|    $3$     | $\\le 10^{12}$ |  $\\le 20$  | $\\le 20$ |   $N$    |\n|    $4$     | $\\le 10^{18}$ |  $\\le 1$   | $\\le 20$ |   $N$    |\n|    $5$     | $\\le 10^{18}$ | $\\le 10^3$ | $\\le 20$ |   $N$    |\n|    $6$     | $\\le 10^{18}$ | $\\le 10^5$ | $\\le 20$ |   $A$    |\n|    $7$     | $\\le 10^{18}$ | $\\le 10^6$ | $\\le 20$ |   $B$    |\n|    $8$     | $\\le 10^{24}$ | $\\le 10^6$ | $\\le 20$ |   $B$    |\n|    $9$     | $\\le 10^{24}$ | $\\le 10^6$ | $\\le 20$ |   $C$    |\n|    $10\\sim20$    | $\\le 10^{24}$ | $\\le 10^6$ | $\\le 20$ |   $N$    |\n\n性质 $A$：保证 $t\\le 10$。\n\n性质 $B$：保证 $n$ 的质因子分解 $\\displaystyle\\prod_{i=1}^t p_i^{\\alpha_i}$ 中 $\\alpha_i=1$。\n\n性质 $C$：$m$ 是素数，且保证 $\\gcd(n,m)=1$。\n\n", "locale": "zh-CN"}}}
{"pid": "P10118", "type": "P", "difficulty": 4, "samples": [["3 23\n8 1\n10 4\n6 0\n", "8\n2\n8\n"], ["6 883\n196483 132\n330788 4353\n137168 35030\n615316 264202\n387442 0\n407154 0\n", "579\n432\n0\n27\n807\n845\n"], ["3 30996377\n948664793464517468 401148893358688606\n945266152577109588 398323527798785832\n185133025738933982 77893802910442339\n", "29793121\n28589865\n30695563\n"], ["5 992362009\n248232552654965455 563160474979616\n553521216364206023 14357560845404368\n668113789984338832 146840018434951169\n620025528908068087 506797735136774536\n522926854352266209 860580850297773973\n", "150959267\n319548082\n888288513\n0\n0\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "O2优化", "组合数学", "位运算"], "title": "『STA - R4』And", "background": "", "description": "给定非负整数 $A, B$，定义有序非负整数对 $(x, y)$ 为好的当且仅当：\n\n- $0 \\le x \\le y$；\n- $x + y = A$；\n- $x \\operatorname{AND} y = B$。\n\n其中 $\\operatorname{AND}$ 代表按位与运算。在 C++ 语言中由 `&` 运算符表示。\n\n你需要求出所有好的有序非负整数对 $(x, y)$ 的 $y - x$ 的和。\n\n由于该值可能很大，你只需要输出其对 $M$ 取模后的结果。\n\n形式化的，你需要求出\n\n$$\\left(\\sum\\limits_{x \\ge 0}\\sum\\limits_{y \\ge 0}\\left(y - x\\right)\\left[\\operatorname{good}(x, y)\\right]\\right)\\bmod M$$\n\n其中 $\\operatorname{good}(x, y)$ 为真与有序非负整数对 $(x, y)$ 为好的等价。", "inputFormat": "**本题单个测试点内含有多组询问。**\n\n第一行两个整数 $T, M$，分别代表询问组数和模数。\n\n接下来 $T$ 行，每行两个非负整数 $A, B$，代表一组询问。", "outputFormat": "对于每组测试数据，输出一行一个整数，代表答案。", "hint": "**【样例 #1 解释】**\n\n对于第一组询问，好的数对有 $\\left(1, 7\\right)$ 和 $\\left(3, 5\\right)$，因此答案为 $\\left(7 - 1\\right) + \\left(5 - 3\\right) = 8$。\n\n对于第二组询问，好的数对只有 $\\left(4, 6\\right)$，因此答案为 $6 - 4 = 2$。\n\n对于第三组询问，好的数对有 $\\left(0, 6\\right)$ 和 $\\left(2, 4\\right)$，因此答案为 $\\left(6 - 0\\right) + \\left(4 - 2\\right) = 8$。\n\n**【样例 #2 解释】**\n\n其所有询问均满足子任务 1 的限制，且后两组询问同时满足子任务 3 的限制。\n\n特别的，在第三组询问的限制下，不存在好的有序非负整数对，因此答案为 $0$。\n\n**【样例 #3 解释】**\n\n其所有询问均满足子任务 2 的限制。\n\n**【样例 #4 解释】**\n\n其所有询问均满足子任务 4 的限制。\n\n特别的，在第四、五组询问的限制下，不存在好的有序非负整数对，因此答案为 $0$。\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n对于 $100\\%$ 的数据：\n\n- $1 \\le T \\le 3 \\times 10^5$；\n- $0 \\le A, B < 2^{60}$；\n- $5 \\le M \\le 1.1 \\times 10^9$；\n- $M$ 为质数。\n\n具体部分分分配如下：\n\n|Subtask 编号|数据范围|分值|\n|:--------:|:--------:|:--------:|\n|1|$T \\le 200, 0 \\le A, B \\le 8 \\times 10^5$|$15$|\n|2|对于每组询问，好的数对个数不超过 $1000$ 个|$25$|\n|3|$B = 0$|$25$|\n|4|无特殊限制|$35$|", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『STA - R4』And", "background": "", "description": "给定非负整数 $A, B$，定义有序非负整数对 $(x, y)$ 为好的当且仅当：\n\n- $0 \\le x \\le y$；\n- $x + y = A$；\n- $x \\operatorname{AND} y = B$。\n\n其中 $\\operatorname{AND}$ 代表按位与运算。在 C++ 语言中由 `&` 运算符表示。\n\n你需要求出所有好的有序非负整数对 $(x, y)$ 的 $y - x$ 的和。\n\n由于该值可能很大，你只需要输出其对 $M$ 取模后的结果。\n\n形式化的，你需要求出\n\n$$\\left(\\sum\\limits_{x \\ge 0}\\sum\\limits_{y \\ge 0}\\left(y - x\\right)\\left[\\operatorname{good}(x, y)\\right]\\right)\\bmod M$$\n\n其中 $\\operatorname{good}(x, y)$ 为真与有序非负整数对 $(x, y)$ 为好的等价。", "inputFormat": "**本题单个测试点内含有多组询问。**\n\n第一行两个整数 $T, M$，分别代表询问组数和模数。\n\n接下来 $T$ 行，每行两个非负整数 $A, B$，代表一组询问。", "outputFormat": "对于每组测试数据，输出一行一个整数，代表答案。", "hint": "**【样例 #1 解释】**\n\n对于第一组询问，好的数对有 $\\left(1, 7\\right)$ 和 $\\left(3, 5\\right)$，因此答案为 $\\left(7 - 1\\right) + \\left(5 - 3\\right) = 8$。\n\n对于第二组询问，好的数对只有 $\\left(4, 6\\right)$，因此答案为 $6 - 4 = 2$。\n\n对于第三组询问，好的数对有 $\\left(0, 6\\right)$ 和 $\\left(2, 4\\right)$，因此答案为 $\\left(6 - 0\\right) + \\left(4 - 2\\right) = 8$。\n\n**【样例 #2 解释】**\n\n其所有询问均满足子任务 1 的限制，且后两组询问同时满足子任务 3 的限制。\n\n特别的，在第三组询问的限制下，不存在好的有序非负整数对，因此答案为 $0$。\n\n**【样例 #3 解释】**\n\n其所有询问均满足子任务 2 的限制。\n\n**【样例 #4 解释】**\n\n其所有询问均满足子任务 4 的限制。\n\n特别的，在第四、五组询问的限制下，不存在好的有序非负整数对，因此答案为 $0$。\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n对于 $100\\%$ 的数据：\n\n- $1 \\le T \\le 3 \\times 10^5$；\n- $0 \\le A, B < 2^{60}$；\n- $5 \\le M \\le 1.1 \\times 10^9$；\n- $M$ 为质数。\n\n具体部分分分配如下：\n\n|Subtask 编号|数据范围|分值|\n|:--------:|:--------:|:--------:|\n|1|$T \\le 200, 0 \\le A, B \\le 8 \\times 10^5$|$15$|\n|2|对于每组询问，好的数对个数不超过 $1000$ 个|$25$|\n|3|$B = 0$|$25$|\n|4|无特殊限制|$35$|", "locale": "zh-CN"}}}
{"pid": "P10119", "type": "P", "difficulty": 5, "samples": [["0 2\n8 3 2 3\n0 -2\n5 -10\n8 0\n-10 -7\n0 -3\n-4 -9\n-9 -3\n-7 0\n8 3 2 -6\n9 6\n9 -6\n3 7\n-4 3\n8 -9\n6 0\n-10 9\n-8 -4\n", "5\n36\n"], ["0 1\n12 3 2 -35771156\n797235777 25138038\n801541087 -405462832\n936777370 -973167834\n74493410 60154946\n263320806 782480907\n-940214410 805511853\n806065179 463119365\n-295177485 -112301429\n-403964212 202831413\n122359196 611468120\n-555210139 549749508\n793784715 -38433603\n", "6706692096\n"], ["0 1\n5 2 1 -100\n-44 -72\n-36 -23\n-4 0\n-22 -1\n-88 3\n", "-65\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "单调队列", "O2优化", "动态规划优化", "前缀和"], "title": "『STA - R4』踱步", "background": "", "description": "小 X 特别喜欢安静的环境，因为那可以让他心情愉悦。\n\n现在给出 $N$ 分钟内每分钟屋内和屋外对小 X 的心情影响值，在这 $N$ 分钟内，小 X 可以从屋内踱步到屋外或是从屋外踱步到屋内**最多共** $K$ 次。（小 X 当且仅当每分钟初进行踱步，同一时刻至多踱步一次，并且踱步的时间忽略不计。第 $1$ 分钟初不可踱步，第 $N$ 分钟初可以踱步。但是在第 $1$ 分钟初可以自由选择初始状态）。\n\n同时，过于频繁的改变会让小 X 心情烦躁，所以如果两次踱步的间隔**小于等于** $T$ 分钟，会对小 X 的心情额外造成 $P$ 点影响。（如果此次踱步是在第 $t_a$ 分钟初，上一次踱步是在第 $t_b$ 分钟初，那么这两次踱步的时间间隔为 $t_a - t_b$ 分钟）。\n\n小 X 想知道自己的心情最好可以是多少，即第 $N$ 分钟末小 X 心情值的最大值。\n\n若某一时刻小 X 的心情值为 $a$，之后小 X 的心情被影响了 $b$，那么在此之后小 X 的心情值将变为 $a + b$。", "inputFormat": "**本题单个测试点内含有多组测试数据。**\n\n第一行两个正整数 $\\text{id},\\text{TEST}$。其中 $\\text{id}$ 代表 Subtask 编号，$\\text{TEST}$ 代表测试数据组数。特别的，样例的 $\\text{id}$ 为 $0$。\n\n对于每组测试数据：\n\n第一行为四个整数 $N, K, T, P$。\n\n接下来 $N$ 行每行两个整数。其中第 $i$ 行的两个整数 $a_i, b_i$ 分别代表第 $i$ 分钟屋内和屋外对小 X 心情的影响值。", "outputFormat": "对于每组测试数据，输出一行一个整数，代表第 $N$ 分钟末小 X 心情值的最大值。", "hint": "**【样例 #1 解释】**\n\n对于第 $1$ 组数据，最优方案为初始时选择在屋内，分别在第 $4, 5, 7$ 分钟初进行踱步。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cx7tr8m2.png)\n\n其中第 $2$ 次踱步与第 $1$ 次踱步之间的间隔为 $5 - 4 = 1$ 分钟，对小 $\\text{X}$ 的心情产生 $3$ 的贡献，第 $3$ 次踱步与第 $2$ 次踱步之间的间隔为 $7 - 5 = 2$ 分钟，对小 X 的心情产生 $3$ 的贡献。\n\n因此小 X 的心情值为\n\n$$\\left(0+5+8-7+0-4-3+0\\right) + 6 = 5$$\n\n前半部分为灰色格子的权值和，后半部分为两次频繁踱步产生的额外贡献，可以证明此方案最优。\n\n**【样例 #2 解释】**\n\n请注意答案可能超过 $32$ 位整型数字的范围。\n\n**【样例 #3 解释】**\n\n请注意答案可能为负数。\n\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据：\n\n- $1 \\le \\text{TEST} \\le 10^5$；\n- $2 \\le N \\le 2 \\times 10^5$；\n- $1 \\le K \\le \\min\\left\\{200, N\\right\\}$；\n- $1 \\le T \\le \\min\\left\\{2 \\times 10^4, N\\right\\}$；\n- $\\left\\lvert a_i \\right\\rvert,\\left\\lvert b_i \\right\\rvert,\\left\\lvert P \\right\\rvert \\le 10^9$。\n- $\\sum N \\cdot K \\le 5 \\times 10^7$。\n- 保证单个测试点输入数据规模不超过 10 MB。\n\n**本题采用捆绑测试。**\n\n|Subtask 编号|数据范围|分值|依赖子任务|\n|:--------:|:--------:|:--------:|:--------:|\n|1|$N \\le 20, \\text{TEST} \\le 10$|$5$||\n|2|$\\sum N^2K \\le 5 \\times 10^7$|$20$|$1$|\n|3|$K \\le 5, N \\le 5 \\times 10^4, \\text{TEST} \\le 10$|$15$||\n|4|$P=-10^9, 0 \\le \\left\\lvert a_i \\right\\rvert,\\left\\lvert b_i \\right\\rvert \\le 100$|$30$||\n|5|无特殊限制|$30$|$1,2,3,4$|", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『STA - R4』踱步", "background": "", "description": "小 X 特别喜欢安静的环境，因为那可以让他心情愉悦。\n\n现在给出 $N$ 分钟内每分钟屋内和屋外对小 X 的心情影响值，在这 $N$ 分钟内，小 X 可以从屋内踱步到屋外或是从屋外踱步到屋内**最多共** $K$ 次。（小 X 当且仅当每分钟初进行踱步，同一时刻至多踱步一次，并且踱步的时间忽略不计。第 $1$ 分钟初不可踱步，第 $N$ 分钟初可以踱步。但是在第 $1$ 分钟初可以自由选择初始状态）。\n\n同时，过于频繁的改变会让小 X 心情烦躁，所以如果两次踱步的间隔**小于等于** $T$ 分钟，会对小 X 的心情额外造成 $P$ 点影响。（如果此次踱步是在第 $t_a$ 分钟初，上一次踱步是在第 $t_b$ 分钟初，那么这两次踱步的时间间隔为 $t_a - t_b$ 分钟）。\n\n小 X 想知道自己的心情最好可以是多少，即第 $N$ 分钟末小 X 心情值的最大值。\n\n若某一时刻小 X 的心情值为 $a$，之后小 X 的心情被影响了 $b$，那么在此之后小 X 的心情值将变为 $a + b$。", "inputFormat": "**本题单个测试点内含有多组测试数据。**\n\n第一行两个正整数 $\\text{id},\\text{TEST}$。其中 $\\text{id}$ 代表 Subtask 编号，$\\text{TEST}$ 代表测试数据组数。特别的，样例的 $\\text{id}$ 为 $0$。\n\n对于每组测试数据：\n\n第一行为四个整数 $N, K, T, P$。\n\n接下来 $N$ 行每行两个整数。其中第 $i$ 行的两个整数 $a_i, b_i$ 分别代表第 $i$ 分钟屋内和屋外对小 X 心情的影响值。", "outputFormat": "对于每组测试数据，输出一行一个整数，代表第 $N$ 分钟末小 X 心情值的最大值。", "hint": "**【样例 #1 解释】**\n\n对于第 $1$ 组数据，最优方案为初始时选择在屋内，分别在第 $4, 5, 7$ 分钟初进行踱步。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cx7tr8m2.png)\n\n其中第 $2$ 次踱步与第 $1$ 次踱步之间的间隔为 $5 - 4 = 1$ 分钟，对小 $\\text{X}$ 的心情产生 $3$ 的贡献，第 $3$ 次踱步与第 $2$ 次踱步之间的间隔为 $7 - 5 = 2$ 分钟，对小 X 的心情产生 $3$ 的贡献。\n\n因此小 X 的心情值为\n\n$$\\left(0+5+8-7+0-4-3+0\\right) + 6 = 5$$\n\n前半部分为灰色格子的权值和，后半部分为两次频繁踱步产生的额外贡献，可以证明此方案最优。\n\n**【样例 #2 解释】**\n\n请注意答案可能超过 $32$ 位整型数字的范围。\n\n**【样例 #3 解释】**\n\n请注意答案可能为负数。\n\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据：\n\n- $1 \\le \\text{TEST} \\le 10^5$；\n- $2 \\le N \\le 2 \\times 10^5$；\n- $1 \\le K \\le \\min\\left\\{200, N\\right\\}$；\n- $1 \\le T \\le \\min\\left\\{2 \\times 10^4, N\\right\\}$；\n- $\\left\\lvert a_i \\right\\rvert,\\left\\lvert b_i \\right\\rvert,\\left\\lvert P \\right\\rvert \\le 10^9$。\n- $\\sum N \\cdot K \\le 5 \\times 10^7$。\n- 保证单个测试点输入数据规模不超过 10 MB。\n\n**本题采用捆绑测试。**\n\n|Subtask 编号|数据范围|分值|依赖子任务|\n|:--------:|:--------:|:--------:|:--------:|\n|1|$N \\le 20, \\text{TEST} \\le 10$|$5$||\n|2|$\\sum N^2K \\le 5 \\times 10^7$|$20$|$1$|\n|3|$K \\le 5, N \\le 5 \\times 10^4, \\text{TEST} \\le 10$|$15$||\n|4|$P=-10^9, 0 \\le \\left\\lvert a_i \\right\\rvert,\\left\\lvert b_i \\right\\rvert \\le 100$|$30$||\n|5|无特殊限制|$30$|$1,2,3,4$|", "locale": "zh-CN"}}}
{"pid": "P10120", "type": "P", "difficulty": 5, "samples": [["5 12\n1 3 4 8\n3\n2 3 4 6\n3\n1 2 2 3\n3\n2 1 5 6\n3\n1 2 3 3\n3\n2 1 5 3\n3\n", "5\n3\n3\n1\n1\n0\n"], ["9 18\n1 8 9 5\n3\n1 5 8 20\n3\n2 8 9 18\n3\n2 6 9 6\n3\n2 1 2 5\n3\n2 9 9 8\n3\n2 3 9 14\n3\n1 6 8 13\n3\n2 3 5 17\n3\n", "9\n9\n7\n5\n3\n3\n0\n0\n0\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["线段树", "O2优化"], "title": "『STA - R4』冰红茶", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/sdchy9ah.png)\n\n某编程网站 BTC 长期在它的 Beginner Contest 的最后一题放科技模板题，于是 APJifengc 愤怒地在它的评测机上洒了若干瓶冰红茶，导致一些评测单元的运行速度快了 $10^{12}$ 倍，暴力跑得和正解一样快。\n\n因为 BTC 不能出科技模板题了，所以 BTC 的站长想要让你维护一下 APJifengc 每次洒冰红茶后可用的评测单元个数，以便于统筹评测资源与灾后重建。\n\n**已加入 Hack 数据，位于 Subtask 5，不计分。**", "description": "有 $n$ 个 bot 排成一排，每天所有 bot 都会喝冰红茶。\n\n要求动态维护一排 bot，有三种操作或询问：\n- `1 l r k`，表示 $[l,r]$ 内的 bot 会喝 $k$ 瓶原味冰红茶、$[l,r]$ 外的 bot 会喝 $k$ 瓶热带风味冰红茶。\n- `2 l r k`，表示 BTC 站长愤怒地把 $[l,r]$ 中最后连续喝了至少 $k$ 瓶口味相同的冰红茶的 bot 击毁。\n- `3`，查询有多少个存活的 bot。\n\n注：在 2 操作中，击毁不会改变 bot 的编号。", "inputFormat": "第一行两个正整数 $n,q$。\n\n后 $q$ 行，每行描述一个操作或询问，形如以下三种中的一种：\n- `1 l r k`；\n- `2 l r k`；\n- `3`。", "outputFormat": "若干行，每行回答一个询问 3。", "hint": "### 样例 1 解释\n\n只说明操作 1 和操作 2。\n\n第一次操作，三号和四号 bot 喝了 8 瓶原味冰红茶，其他 bot 喝了 8 瓶热带风味冰红茶。\n\n第二次操作，三号和四号 bot 连续喝了 8 瓶原味冰红茶，被击毁，现在场上还有 3 个存活 bot。\n\n第三次操作，二号 bot 喝了 3 瓶原味冰红茶，其他 bot 喝了 3 瓶热带风味冰红茶。\n\n第四次操作，一号和五号 bot 连续喝了 11 瓶热带风味冰红茶，被击毁，现在场上还有 1 个存活 bot。\n\n第五次操作，二号 bot 喝了 3 瓶原味冰红茶。\n\n第六次操作，二号 bot 连续喝了 6 瓶原味冰红茶，被击毁，现在场上没有存活的 bot。\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n- Subtask 1 (5pts)：$n,q\\le 10^3$。\n- Subtask 2 (20pts)：所有操作 2 中 $k\\le 20$。\n- Subtask 3 (25pts)：保证数据随机生成。\n- Subtask 4 (50pts)：无特殊限制。\n\n其中 Subtask 3 的测试数据生成方式如下：\n\n1. 对于每次或询问，从三种类型中等概率选择一个；\n2. 若选取的操作不为 3，那么从 $\\left[1, n\\right]$ 中等概率生成两个数 $l, r$，若 $l > r$，则交换 $l, r$，并将 $l, r$ 作为操作的参数；\n3. 若选取的操作不为 3，那么从 $\\left[1, 10^6\\right]$ 中等概率生成一个数 $k$ 作为操作的参数。\n\n对于全部数据，保证 $1\\le n,q\\le 2\\times 10^5$，$1\\le k\\le 10^{6}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『STA - R4』冰红茶", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/sdchy9ah.png)\n\n某编程网站 BTC 长期在它的 Beginner Contest 的最后一题放科技模板题，于是 APJifengc 愤怒地在它的评测机上洒了若干瓶冰红茶，导致一些评测单元的运行速度快了 $10^{12}$ 倍，暴力跑得和正解一样快。\n\n因为 BTC 不能出科技模板题了，所以 BTC 的站长想要让你维护一下 APJifengc 每次洒冰红茶后可用的评测单元个数，以便于统筹评测资源与灾后重建。\n\n**已加入 Hack 数据，位于 Subtask 5，不计分。**", "description": "有 $n$ 个 bot 排成一排，每天所有 bot 都会喝冰红茶。\n\n要求动态维护一排 bot，有三种操作或询问：\n- `1 l r k`，表示 $[l,r]$ 内的 bot 会喝 $k$ 瓶原味冰红茶、$[l,r]$ 外的 bot 会喝 $k$ 瓶热带风味冰红茶。\n- `2 l r k`，表示 BTC 站长愤怒地把 $[l,r]$ 中最后连续喝了至少 $k$ 瓶口味相同的冰红茶的 bot 击毁。\n- `3`，查询有多少个存活的 bot。\n\n注：在 2 操作中，击毁不会改变 bot 的编号。", "inputFormat": "第一行两个正整数 $n,q$。\n\n后 $q$ 行，每行描述一个操作或询问，形如以下三种中的一种：\n- `1 l r k`；\n- `2 l r k`；\n- `3`。", "outputFormat": "若干行，每行回答一个询问 3。", "hint": "### 样例 1 解释\n\n只说明操作 1 和操作 2。\n\n第一次操作，三号和四号 bot 喝了 8 瓶原味冰红茶，其他 bot 喝了 8 瓶热带风味冰红茶。\n\n第二次操作，三号和四号 bot 连续喝了 8 瓶原味冰红茶，被击毁，现在场上还有 3 个存活 bot。\n\n第三次操作，二号 bot 喝了 3 瓶原味冰红茶，其他 bot 喝了 3 瓶热带风味冰红茶。\n\n第四次操作，一号和五号 bot 连续喝了 11 瓶热带风味冰红茶，被击毁，现在场上还有 1 个存活 bot。\n\n第五次操作，二号 bot 喝了 3 瓶原味冰红茶。\n\n第六次操作，二号 bot 连续喝了 6 瓶原味冰红茶，被击毁，现在场上没有存活的 bot。\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n- Subtask 1 (5pts)：$n,q\\le 10^3$。\n- Subtask 2 (20pts)：所有操作 2 中 $k\\le 20$。\n- Subtask 3 (25pts)：保证数据随机生成。\n- Subtask 4 (50pts)：无特殊限制。\n\n其中 Subtask 3 的测试数据生成方式如下：\n\n1. 对于每次或询问，从三种类型中等概率选择一个；\n2. 若选取的操作不为 3，那么从 $\\left[1, n\\right]$ 中等概率生成两个数 $l, r$，若 $l > r$，则交换 $l, r$，并将 $l, r$ 作为操作的参数；\n3. 若选取的操作不为 3，那么从 $\\left[1, 10^6\\right]$ 中等概率生成一个数 $k$ 作为操作的参数。\n\n对于全部数据，保证 $1\\le n,q\\le 2\\times 10^5$，$1\\le k\\le 10^{6}$。", "locale": "zh-CN"}}}
{"pid": "P10121", "type": "P", "difficulty": 7, "samples": [["7\n1 1 2 2 3 3\n", "8"], ["14\n1 2 3 3 2 6 6 6 9 9 10 11 12", "25"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["暴力数据结构", "线段树", "O2优化", "树论", "虚树", "其它技巧"], "title": "『STA - R4』保险丝", "background": "APJ：「？我家保险丝怎么又没了」\n", "description": "给一棵 $n$ 个点的有根树，根是 $1$ 号结点。\n\n定义两个点集 $S_1,S_2$ 的距离为从两个集合分别选出一个点，能得到两点间距离的最小值，即 $\\displaystyle\\operatorname{dist}(S_1,S_2)=\\min_{\\substack{u\\in S_1\\\\v\\in S_2}}\\operatorname{dist}(u,v)$，其中 $\\operatorname{dist}(u,v)$ 是点 $u,v$ 间的距离。\n\n定义 $\\operatorname{path}(u,v)$ 是 $u$ 到 $v$ 的简单路径上的所有点组成的集合，$\\mathcal L$ 是所有叶子组成的集合。\n\n对于固定正整数 $u$，定义满足如下条件的结点 $v$ 构成 $u$ 的半邻域 $\\mathring U(u)$：\n- $v$ 在 $u$ 子树内；\n- $\\operatorname{dist}(u,v)\\le\\operatorname{dist}(\\operatorname{path}(1,v),\\mathcal L)$。\n\n即 $u$ 的半邻域 $\\mathring U(u)$ 包含 $u$ 的子树内所有满足到 $u$ 的距离不大于它到根的路径上任意一点离最近叶子节点的距离的点。\n\n进而定义：\n$$f(x)=\\sum_{u\\in\\mathring U(x)}\\prod_{\\substack{v\\in\\operatorname{subtree}(u)\\\\v\\in\\mathring U(x)}}F_{\\deg v}$$\n其中 $\\operatorname{subtree}(u)$ 是 $u$ 子树中所有点组成的集合，$\\deg u$ 是 $u$ 的度数（与 $u$ 有连边的点的数量），$F$ 是 Fibonacci 数列：\n$$F_n=\\begin{cases}1&n\\le 2\\\\F_{n-1}+F_{n-2}&n\\ge 3\\end{cases}$$\n\n即 $f(x)$ 对应 $x$ 的半邻域中点对 $x$ 的贡献之和。而一个点 $u$ 对 $x$ 的贡献的计算方式为：取出每个 $u$ 子树内处在 $x$ 半邻域中的点 $v$，若 $v$ 的度数为 $d$，则将 $u$ 的贡献乘上 $F_d$，所有 $u$ 的贡献之和为结果。\n\n你需要求出 $f(1),f(2),\\cdots,f(n)$ 的值，为减少输出量，你只需要输出它们模 $994007158$ 后的异或和，即 $\\bigoplus_{x=1}^n(f(x)\\bmod 994007158)$ 即可。\n", "inputFormat": "第一行一个正整数 $n$ 表示点数。\n\n第二行 $n - 1$ 个正整数，第 $i$ 个正整数代表了结点 $i + 1$ 的父亲结点。", "outputFormat": "一行，表示 $\\bigoplus_{x=1}^n(f(x)\\bmod 994007158)$ 的值。", "hint": "### 样例解释\n第一组数据中 $f$ 在 $1\\dots 7$ 处的取值：$8,2,2,1,1,1,1$。\n\n第二组数据中 $f$ 在 $1\\dots14$ 处的取值：$4,17,2,1,1,8,1,1,4,2,1,1,1,1$。\n### 数据范围\n\n**本题采用捆绑测试。**\n- Subtask 1 (10pts)：$n\\le 5000$。\n- Subtask 2 (20pts)：树的叶子个数不大于 $30$。\n- Subtask 3 (20pts)：树中没有恰有一个儿子的结点。\n- Subtask 4 (50pts)：无特殊限制。\n\n对于全部数据，$2\\le n,q\\le 10^6$，每个非根结点父亲的编号小于它的编号。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『STA - R4』保险丝", "background": "APJ：「？我家保险丝怎么又没了」\n", "description": "给一棵 $n$ 个点的有根树，根是 $1$ 号结点。\n\n定义两个点集 $S_1,S_2$ 的距离为从两个集合分别选出一个点，能得到两点间距离的最小值，即 $\\displaystyle\\operatorname{dist}(S_1,S_2)=\\min_{\\substack{u\\in S_1\\\\v\\in S_2}}\\operatorname{dist}(u,v)$，其中 $\\operatorname{dist}(u,v)$ 是点 $u,v$ 间的距离。\n\n定义 $\\operatorname{path}(u,v)$ 是 $u$ 到 $v$ 的简单路径上的所有点组成的集合，$\\mathcal L$ 是所有叶子组成的集合。\n\n对于固定正整数 $u$，定义满足如下条件的结点 $v$ 构成 $u$ 的半邻域 $\\mathring U(u)$：\n- $v$ 在 $u$ 子树内；\n- $\\operatorname{dist}(u,v)\\le\\operatorname{dist}(\\operatorname{path}(1,v),\\mathcal L)$。\n\n即 $u$ 的半邻域 $\\mathring U(u)$ 包含 $u$ 的子树内所有满足到 $u$ 的距离不大于它到根的路径上任意一点离最近叶子节点的距离的点。\n\n进而定义：\n$$f(x)=\\sum_{u\\in\\mathring U(x)}\\prod_{\\substack{v\\in\\operatorname{subtree}(u)\\\\v\\in\\mathring U(x)}}F_{\\deg v}$$\n其中 $\\operatorname{subtree}(u)$ 是 $u$ 子树中所有点组成的集合，$\\deg u$ 是 $u$ 的度数（与 $u$ 有连边的点的数量），$F$ 是 Fibonacci 数列：\n$$F_n=\\begin{cases}1&n\\le 2\\\\F_{n-1}+F_{n-2}&n\\ge 3\\end{cases}$$\n\n即 $f(x)$ 对应 $x$ 的半邻域中点对 $x$ 的贡献之和。而一个点 $u$ 对 $x$ 的贡献的计算方式为：取出每个 $u$ 子树内处在 $x$ 半邻域中的点 $v$，若 $v$ 的度数为 $d$，则将 $u$ 的贡献乘上 $F_d$，所有 $u$ 的贡献之和为结果。\n\n你需要求出 $f(1),f(2),\\cdots,f(n)$ 的值，为减少输出量，你只需要输出它们模 $994007158$ 后的异或和，即 $\\bigoplus_{x=1}^n(f(x)\\bmod 994007158)$ 即可。\n", "inputFormat": "第一行一个正整数 $n$ 表示点数。\n\n第二行 $n - 1$ 个正整数，第 $i$ 个正整数代表了结点 $i + 1$ 的父亲结点。", "outputFormat": "一行，表示 $\\bigoplus_{x=1}^n(f(x)\\bmod 994007158)$ 的值。", "hint": "### 样例解释\n第一组数据中 $f$ 在 $1\\dots 7$ 处的取值：$8,2,2,1,1,1,1$。\n\n第二组数据中 $f$ 在 $1\\dots14$ 处的取值：$4,17,2,1,1,8,1,1,4,2,1,1,1,1$。\n### 数据范围\n\n**本题采用捆绑测试。**\n- Subtask 1 (10pts)：$n\\le 5000$。\n- Subtask 2 (20pts)：树的叶子个数不大于 $30$。\n- Subtask 3 (20pts)：树中没有恰有一个儿子的结点。\n- Subtask 4 (50pts)：无特殊限制。\n\n对于全部数据，$2\\le n,q\\le 10^6$，每个非根结点父亲的编号小于它的编号。\n", "locale": "zh-CN"}}}
{"pid": "P10122", "type": "P", "difficulty": 2, "samples": [["COW\nXXO\nABC", "0\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["模拟", "2018", "USACO", "枚举"], "title": "[USACO18OPEN] Team Tic Tac Toe B", "background": "", "description": "Farmer John 有 $26$ 头奶牛，恰好她们名字都以不同的字母开头，所以 Farmer John 用每头奶牛的名字的首字母来指代她——一个 `A-Z` 之间的字母。\n\n这些奶牛最近沉迷于井字游戏，但是由于她们并不满足只有两头奶牛可以一起玩，她们改编了这个游戏，可以让许多奶牛可以一块儿玩！就像常规的井字游戏一样，这个游戏是在一块 $3×3$\n的棋盘上进行的，只是与仅用 `X` 和 `O` 不同，每个格子用一个 `A-Z` 之间的字母标记，表示占有这个格子的奶牛名字的首字母。\n\n以下是一个棋盘的例子：\n\n```plain\nCOW\nXXO\nABC\n```\n\n这些奶牛会在她们迷惑于如何判断胜负之前就占满这九个格子。显然，就像常规的井字游戏一样，如果任何一头奶牛占有了一整行、一整列，或是一整条对角线，那么这头奶牛就获胜了。然而，由于奶牛认为多牛游戏中这并不容易出现，所以她们决定允许奶牛组成两牛一队，如果某一行、一列，或是一条对角线仅包含一队的两头奶牛的字母，并且同时包含了这两头奶牛（不仅仅是一头）的字母，那么这一队就获胜。\n\n请帮助奶牛们判断有多少头奶牛或是两头奶牛组成的队伍可以获胜。注意棋盘上的同一个格子可能在不同奶牛或队伍的获胜中均被用到。 ", "inputFormat": "输入包含三行，每行三个 `A-Z` 之间的字符。", "outputFormat": "输出包含两行。第一行，输出能够获胜的单独的奶牛的数量。第二行，输出能够获胜的两头奶牛组成的队伍的数量。 ", "hint": "在这个例子中，没有单独的奶牛可以获得胜利。但是，如果奶牛 `C` 和奶牛 `X` 组队，她们可以通过 `C-X-C` 对角线获胜。同样地，如果奶牛 `X` 和 `O` 组队，她们可以通过中间一行取胜。 ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO18OPEN] Team Tic Tac Toe B", "background": "", "description": "Farmer John 有 $26$ 头奶牛，恰好她们名字都以不同的字母开头，所以 Farmer John 用每头奶牛的名字的首字母来指代她——一个 `A-Z` 之间的字母。\n\n这些奶牛最近沉迷于井字游戏，但是由于她们并不满足只有两头奶牛可以一起玩，她们改编了这个游戏，可以让许多奶牛可以一块儿玩！就像常规的井字游戏一样，这个游戏是在一块 $3×3$\n的棋盘上进行的，只是与仅用 `X` 和 `O` 不同，每个格子用一个 `A-Z` 之间的字母标记，表示占有这个格子的奶牛名字的首字母。\n\n以下是一个棋盘的例子：\n\n```plain\nCOW\nXXO\nABC\n```\n\n这些奶牛会在她们迷惑于如何判断胜负之前就占满这九个格子。显然，就像常规的井字游戏一样，如果任何一头奶牛占有了一整行、一整列，或是一整条对角线，那么这头奶牛就获胜了。然而，由于奶牛认为多牛游戏中这并不容易出现，所以她们决定允许奶牛组成两牛一队，如果某一行、一列，或是一条对角线仅包含一队的两头奶牛的字母，并且同时包含了这两头奶牛（不仅仅是一头）的字母，那么这一队就获胜。\n\n请帮助奶牛们判断有多少头奶牛或是两头奶牛组成的队伍可以获胜。注意棋盘上的同一个格子可能在不同奶牛或队伍的获胜中均被用到。 ", "inputFormat": "输入包含三行，每行三个 `A-Z` 之间的字符。", "outputFormat": "输出包含两行。第一行，输出能够获胜的单独的奶牛的数量。第二行，输出能够获胜的两头奶牛组成的队伍的数量。 ", "hint": "在这个例子中，没有单独的奶牛可以获得胜利。但是，如果奶牛 `C` 和奶牛 `X` 组队，她们可以通过 `C-X-C` 对角线获胜。同样地，如果奶牛 `X` 和 `O` 组队，她们可以通过中间一行取胜。 ", "locale": "zh-CN"}}}
{"pid": "P10123", "type": "P", "difficulty": 3, "samples": [["6 3 2\n4 5 6\n5 3\n3 1", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["贪心", "2018", "USACO"], "title": "[USACO18OPEN] Milking Order B", "background": "", "description": "Farmer John 的 $N$ 头奶牛（$2\\le N\\le 100$），方便起见仍然编号为 $1\\ldots N$，正好闲得发慌。因此，她们发展了一个与 Farmer John 每天早上为她们挤牛奶的时候的排队顺序相关的复杂的社会结构。经过若干周的研究，Farmer John 发现这个结构基于两个关键特性。\n\n首先，由于奶牛们的社会阶层，某些奶牛会坚持要在其他奶牛之前挤奶，基于她们的社会地位等级。比方说，如果奶牛 $3$ 有最高的地位，奶牛 $2$ 位于中等地位，奶牛 $5$ 是低地位，那么奶牛 $3$ 会最早挤奶，然后是奶牛 $2$，最后是奶牛 $5$。\n\n然后，有些奶牛只允许她们在排队顺序中一个特定的位置挤奶。比方说，奶牛 $4$ 可能坚持要在所有奶牛中的第二位挤奶。\n\n幸运的是，Farmer John 总是能够以一种满足所有这些情况的顺序给他的奶牛们挤奶。\n\n不幸的是，奶牛 $1$ 最近生病了，所以 Farmer John 想要尽早给这头奶牛挤奶，使得她可以回到牛棚获得急需的休息。请帮助 Farmer John 求出奶牛 $1$ 可以在挤奶顺序中出现的最早位置。 ", "inputFormat": "第一行包含 $N$，$M$（$1\\le M<N$），和 $K$（$1\\le K<N$），表示 Farmer John 有 $N$ 头奶牛，其中 $M$ 头形成了社会阶层，$K$ 头需要在挤奶顺序中处于一个特定的位置。下一行包含 $M$ 个不同的整数 $m_i$（$1\\le m_i\\le N$）。在这一行出现的奶牛必须以与她们在这行出现的顺序相同的顺序进行挤奶。下面 $K$ 行，每行包含两个整数 $c_i$（$1\\le c_i\\le N$）和 $p_i$（$1\\le p_i\\le N$），表示奶牛 $c_i$ 一定要在第 $p_i$ 位进行挤奶。\n\n输入数据保证在这些限制之下，Farmer John 能够建立一个符合要求的挤奶顺序。 ", "outputFormat": "输出奶牛 $1$ 可以在挤奶顺序中出现的最早位置。 ", "hint": "在这个例子中，Farmer John 有六头奶牛，其中奶牛 $1$ 生病了。他的挤奶顺序应该为奶牛 $4$ 在奶牛 $5$ 之前，奶牛 $5$ 在奶牛 $6$ 之前。此外，Farmer John 必须要第一个给奶牛 $3$ 挤奶，第三个给奶牛 $5$ 挤奶。\n\nFJ 必须第一个给奶牛 $3$ 挤奶，由于奶牛 $4$ 必须要在奶牛 $5$ 之前，奶牛 $4$ 一定是第二个挤奶的，然后奶牛 $5$ 第三个。于是，奶牛 $1$ 最早在挤奶顺序中出现的位置是第四个。 ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO18OPEN] Milking Order B", "background": "", "description": "Farmer John 的 $N$ 头奶牛（$2\\le N\\le 100$），方便起见仍然编号为 $1\\ldots N$，正好闲得发慌。因此，她们发展了一个与 Farmer John 每天早上为她们挤牛奶的时候的排队顺序相关的复杂的社会结构。经过若干周的研究，Farmer John 发现这个结构基于两个关键特性。\n\n首先，由于奶牛们的社会阶层，某些奶牛会坚持要在其他奶牛之前挤奶，基于她们的社会地位等级。比方说，如果奶牛 $3$ 有最高的地位，奶牛 $2$ 位于中等地位，奶牛 $5$ 是低地位，那么奶牛 $3$ 会最早挤奶，然后是奶牛 $2$，最后是奶牛 $5$。\n\n然后，有些奶牛只允许她们在排队顺序中一个特定的位置挤奶。比方说，奶牛 $4$ 可能坚持要在所有奶牛中的第二位挤奶。\n\n幸运的是，Farmer John 总是能够以一种满足所有这些情况的顺序给他的奶牛们挤奶。\n\n不幸的是，奶牛 $1$ 最近生病了，所以 Farmer John 想要尽早给这头奶牛挤奶，使得她可以回到牛棚获得急需的休息。请帮助 Farmer John 求出奶牛 $1$ 可以在挤奶顺序中出现的最早位置。 ", "inputFormat": "第一行包含 $N$，$M$（$1\\le M<N$），和 $K$（$1\\le K<N$），表示 Farmer John 有 $N$ 头奶牛，其中 $M$ 头形成了社会阶层，$K$ 头需要在挤奶顺序中处于一个特定的位置。下一行包含 $M$ 个不同的整数 $m_i$（$1\\le m_i\\le N$）。在这一行出现的奶牛必须以与她们在这行出现的顺序相同的顺序进行挤奶。下面 $K$ 行，每行包含两个整数 $c_i$（$1\\le c_i\\le N$）和 $p_i$（$1\\le p_i\\le N$），表示奶牛 $c_i$ 一定要在第 $p_i$ 位进行挤奶。\n\n输入数据保证在这些限制之下，Farmer John 能够建立一个符合要求的挤奶顺序。 ", "outputFormat": "输出奶牛 $1$ 可以在挤奶顺序中出现的最早位置。 ", "hint": "在这个例子中，Farmer John 有六头奶牛，其中奶牛 $1$ 生病了。他的挤奶顺序应该为奶牛 $4$ 在奶牛 $5$ 之前，奶牛 $5$ 在奶牛 $6$ 之前。此外，Farmer John 必须要第一个给奶牛 $3$ 挤奶，第三个给奶牛 $5$ 挤奶。\n\nFJ 必须第一个给奶牛 $3$ 挤奶，由于奶牛 $4$ 必须要在奶牛 $5$ 之前，奶牛 $4$ 一定是第二个挤奶的，然后奶牛 $5$ 第三个。于是，奶牛 $1$ 最早在挤奶顺序中出现的位置是第四个。 ", "locale": "zh-CN"}}}
{"pid": "P10124", "type": "P", "difficulty": 3, "samples": [["7 AA BB\nMOTHER AA\nGGMOTHER BB\nMOTHER SISTER\nGMOTHER MOTHER\nGMOTHER AUNT\nAUNT COUSIN\nGGMOTHER GMOTHER", "BB is the great-aunt of AA"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["模拟", "2018", "USACO"], "title": "[USACO18OPEN] Family Tree B", "background": "", "description": "Farmer John 拥有一个传承数代的家族经营的农场，其中的奶牛的根源同样也可以在这个农场中追溯数代。通过检索古老的记录，Farmer John 好奇于现在的这群奶牛互相之间是什么关系。请帮帮他！ ", "inputFormat": "输入的第一行包含 $N$（$1\\le N\\le 100$），之后是两头奶牛的名字。每头奶牛的名字都是由至多 $10$ 个大写字母（`A-Z`）组成的字符串。Farmer John 好奇于这行输入中这两头奶牛之间的关系。\n\n接下来的 $N$ 行，每行包含两头奶牛的名字 $X$ 和 $Y$，表示 $X$ 是 $Y$ 的母亲。 ", "outputFormat": "输出包含一行，表示输入第一行指定的两头奶牛之间的关系（简单起见，在下面的例子中，将这两头奶牛称为 BESSIE 和 ELSIE）。下面是可能出现的不同种类的关系：\n\n- 如果BESSIE和ELSIE的母亲是同一头奶牛，输出 `SIBLINGS`。\n- BESSIE 可能是 ELSIE 的直系后代，也就是说 ELSIE 是BESSIE 的母亲（`mother`），外祖母（`grand-mother`），外曾外祖母（`great-grand-mother`），外曾外曾外祖母（`great-great-grand-mother`），等等。如果是这种情况，输出 `ELSIE is the (relation) of BESSIE`，其中 `(relation)` 是适当的关系，比如 `great-great-grand-mother`。\n- 如果 ELSIE 不是 BESSIE 的某个祖先或姐妹，但是是 BESSIE 的某个祖先的孩子，那么 ELSIE 就是 BESSIE 的姨母（`aunt`）。（译者注：英语原题在这里表述有误，供题人已作出声明。）如果 ELSIE 是 BESSIE 的外祖母的孩子，输出 `ELSIE is the aunt of BESSIE`；如果 ELSIE 是 BESSIE 的外曾外祖母的孩子，输出 `ELSIE is the great-aunt of BESSIE`；如果 ELSIE 是 BESSIE 的外曾外曾外祖母的孩子，输出 `ELSIE is the great-great-aunt of BESSIE`；以此类推。\n- 如果 BESSIE 和 ELSIE 有任何其他的亲戚关系（也就是说，她们有共同的祖先），她们就是表姐妹，输出 `COUSINS`。\n- 如果 BESSIE 和 ELSIE 既没有共同的祖先，其中任何一头也不是另一头的直系后代，输出 `NOT RELATED`。\n\n下图描述了上述关系，你只需考虑这些关系。观察到有一些像是“甥女（`niece`）”（姊妹的女儿）的关系是不必要的，这是由于如果 BESSIE 是 ELSIE 的甥女，那么 ELSIE 就是 BESSIE 的姨母。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xvfjp4u5.png)", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO18OPEN] Family Tree B", "background": "", "description": "Farmer John 拥有一个传承数代的家族经营的农场，其中的奶牛的根源同样也可以在这个农场中追溯数代。通过检索古老的记录，Farmer John 好奇于现在的这群奶牛互相之间是什么关系。请帮帮他！ ", "inputFormat": "输入的第一行包含 $N$（$1\\le N\\le 100$），之后是两头奶牛的名字。每头奶牛的名字都是由至多 $10$ 个大写字母（`A-Z`）组成的字符串。Farmer John 好奇于这行输入中这两头奶牛之间的关系。\n\n接下来的 $N$ 行，每行包含两头奶牛的名字 $X$ 和 $Y$，表示 $X$ 是 $Y$ 的母亲。 ", "outputFormat": "输出包含一行，表示输入第一行指定的两头奶牛之间的关系（简单起见，在下面的例子中，将这两头奶牛称为 BESSIE 和 ELSIE）。下面是可能出现的不同种类的关系：\n\n- 如果BESSIE和ELSIE的母亲是同一头奶牛，输出 `SIBLINGS`。\n- BESSIE 可能是 ELSIE 的直系后代，也就是说 ELSIE 是BESSIE 的母亲（`mother`），外祖母（`grand-mother`），外曾外祖母（`great-grand-mother`），外曾外曾外祖母（`great-great-grand-mother`），等等。如果是这种情况，输出 `ELSIE is the (relation) of BESSIE`，其中 `(relation)` 是适当的关系，比如 `great-great-grand-mother`。\n- 如果 ELSIE 不是 BESSIE 的某个祖先或姐妹，但是是 BESSIE 的某个祖先的孩子，那么 ELSIE 就是 BESSIE 的姨母（`aunt`）。（译者注：英语原题在这里表述有误，供题人已作出声明。）如果 ELSIE 是 BESSIE 的外祖母的孩子，输出 `ELSIE is the aunt of BESSIE`；如果 ELSIE 是 BESSIE 的外曾外祖母的孩子，输出 `ELSIE is the great-aunt of BESSIE`；如果 ELSIE 是 BESSIE 的外曾外曾外祖母的孩子，输出 `ELSIE is the great-great-aunt of BESSIE`；以此类推。\n- 如果 BESSIE 和 ELSIE 有任何其他的亲戚关系（也就是说，她们有共同的祖先），她们就是表姐妹，输出 `COUSINS`。\n- 如果 BESSIE 和 ELSIE 既没有共同的祖先，其中任何一头也不是另一头的直系后代，输出 `NOT RELATED`。\n\n下图描述了上述关系，你只需考虑这些关系。观察到有一些像是“甥女（`niece`）”（姊妹的女儿）的关系是不必要的，这是由于如果 BESSIE 是 ELSIE 的甥女，那么 ELSIE 就是 BESSIE 的姨母。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xvfjp4u5.png)", "hint": "", "locale": "zh-CN"}}}
{"pid": "P10125", "type": "P", "difficulty": 1, "samples": [["SVPOLL", "Genshin"], ["ACoiPP", "Luogu"], ["RECOLL", "Boring"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "O2优化"], "title": "「Daily OI Round 3」Simple", "background": "这是一道简单题。", "description": "Acoipp 的某个软件的账号叫做 Svpoll，并且这款软件的账号与洛谷账号均不区分大小写，例如 $\\texttt{SVPOLl}$ 和 $\\texttt{svPOLL}$ 等价，$\\texttt{aCoIPp}$ 和 $\\texttt{Acoipp}$ 等价。\n\n现在你想要知道某个账号名称是与 $\\texttt{Acoipp}$ 等价，还是与 $\\texttt{Svpoll}$ 等价，或者是与前两者都不等价。", "inputFormat": "一行一个字符串，表示账号名称。", "outputFormat": "一行一个字符串，如果输入的字符串与 $\\texttt{Acoipp}$ 等价，那么输出 $\\texttt{Luogu}$；如果输入的字符串与 $\\texttt{Svpoll}$ 等价，那么输出 $\\texttt{Genshin}$；如果输入的字符串与前两者都不等价，输出 $\\texttt{Boring}$。", "hint": "#### 【样例解释 #1】\n\n因为不区分大小写，所以 $\\texttt{SVPOLL}$ 中的 $\\texttt{V}$，$\\texttt{P}$，$\\texttt{O}$，$\\texttt{L}$ 分别与 $\\texttt{v}$，$\\texttt{p}$，$\\texttt{o}$，$\\texttt{l}$ 等价，所以 $\\texttt{SVPOLL}$ 与 $\\texttt{Svpoll}$ 等价。\n\n#### 【数据范围】\n\n设 $|S|$ 为字符串长度，对于全部数据保证：$|S|=6$ 并且输入的字符串只包含大小写英文字母。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Daily OI Round 3」Simple", "background": "这是一道简单题。", "description": "Acoipp 的某个软件的账号叫做 Svpoll，并且这款软件的账号与洛谷账号均不区分大小写，例如 $\\texttt{SVPOLl}$ 和 $\\texttt{svPOLL}$ 等价，$\\texttt{aCoIPp}$ 和 $\\texttt{Acoipp}$ 等价。\n\n现在你想要知道某个账号名称是与 $\\texttt{Acoipp}$ 等价，还是与 $\\texttt{Svpoll}$ 等价，或者是与前两者都不等价。", "inputFormat": "一行一个字符串，表示账号名称。", "outputFormat": "一行一个字符串，如果输入的字符串与 $\\texttt{Acoipp}$ 等价，那么输出 $\\texttt{Luogu}$；如果输入的字符串与 $\\texttt{Svpoll}$ 等价，那么输出 $\\texttt{Genshin}$；如果输入的字符串与前两者都不等价，输出 $\\texttt{Boring}$。", "hint": "#### 【样例解释 #1】\n\n因为不区分大小写，所以 $\\texttt{SVPOLL}$ 中的 $\\texttt{V}$，$\\texttt{P}$，$\\texttt{O}$，$\\texttt{L}$ 分别与 $\\texttt{v}$，$\\texttt{p}$，$\\texttt{o}$，$\\texttt{l}$ 等价，所以 $\\texttt{SVPOLL}$ 与 $\\texttt{Svpoll}$ 等价。\n\n#### 【数据范围】\n\n设 $|S|$ 为字符串长度，对于全部数据保证：$|S|=6$ 并且输入的字符串只包含大小写英文字母。", "locale": "zh-CN"}}}
