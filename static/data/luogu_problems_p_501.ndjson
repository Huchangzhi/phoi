{"pid": "P11163", "type": "P", "difficulty": 6, "samples": [["3 5\nS 2 W 2\nW 1 S 3\nW 4 W 3\n3 6 1 1\n2 2\n2 1\n1 3 2\n2 1\n2 3", "6\n12\n16\n4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2023", "BalkanOI（巴尔干半岛）"], "title": "[BalkanOI 2023] Weights", "background": "", "description": "**译自 [BalkanOI 2023](https://boi2023.zotks.si) Day1 T2「[Weights](https://boi2023.zotks.si/wp-content/uploads/day_1/d1_weights/en_EN.pdf)」**\n\n给你 $N$ 个天平，每个天平有两个质量可以忽略不计的盘子。天平用从 $1$ 到 $N$ 的整数编号。每个盘子上要么放着另一个天平，要么放着一个质量不可忽略的砝码。编号为 $1$ 的天平放在地上，其他的天平都放在某个天平的盘子上。一共有 $N+1$ 个砝码。砝码用 $1$ 到 $N+1$ 的整数编号，每个砝码的质量用 $N+1$ 个整数 $w_{1}, w_{2} \\cdots, w_{N+1}$ 表示。\n\n下图给出了一个由三个天平和四个砝码组成的例子。正体字的数字表示天平和砝码的编号，斜体字的数字表示砝码的质量。例如，编号为 $2$ 的天平放在编号为 $1$ 的天平的左盘上，编号为 $2$ 质量为 $6$ 的砝码放在编号为 $1$ 的天平的右盘上。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6sw0vac1.png)\n\n如果一个天平的左盘和右盘的总质量相等，我们说它是平衡的。如果一个天平是平衡的，并且它的两个盘子上要么都是超平衡的天平，要么都是砝码，我们说它是超平衡的。\n\n在上图中，只有天平 $3$ 是平衡的（也是超平衡的），但是如果我们把砝码 $3$ 和 $4$ 的质量都增加到 $1.5$，那么三个天平都会变成超平衡的。然而，如果我们把砝码 $1$ 的质量增加到 $4$，天平 $1$ 会变成平衡的但不是超平衡的，因为天平 $2$ 仍然不平衡。\n\n现在我们要处理 $Q$ 个两种类型的操作：\n\n- $1\\,k\\,w$ : 把砝码 $k$ 的质量改成整数 $w$。\n- $2\\,s$ : 假设我们想让天平 $s$ 变成超平衡的。我们可以用魔法把一些砝码变得更重！注意新的质量不一定是整数。要让天平 $s$ 变成超平衡的，天平 $s$ 上的最小总质量是多少？由于这个数可能很大，输出它对 $998244353$ 取模的结果。可以证明在给定的限制下，结果总是一个整数。\n\n注意，类型 $1$ 的操作会改变砝码的质量，而类型 $2$ 的操作不会。", "inputFormat": "第一行包含两个整数 $N$ 和 $Q$。\n\n接下来的 $N$ 行中的第 $i\\ (1\\leq i\\leq N)$ 行包含两对字符和数字，每对描述了第 $i$ 个天平的一个盘子：字符是 `S`（天平）或 `W`（砝码），表示盘子上的物体的类型，整数是相应物体的编号。保证一个天平永远不会放在一个编号更大的天平上。\n\n接下来的一行包含 $N+1$ 个整数 $w_{1}, w_{2}, \\cdots, w_{N+1}$，表示砝码的质量。\n\n最后的 $Q$ 行表示操作。每行要么是形如 $1\\,k\\,w$ 的，要么是形如 $2\\,s$ 的，如问题描述中所述。", "outputFormat": "对于每个类型 $2$ 的操作，在一行上输出相应的最小质量对 $998244353$ 取模的结果。", "hint": "### 样例解释\n\n为了让天平 $2$ 变成超平衡的，我们把砝码 $3$ 和 $4$ 的质量都增加到 $1.5$。这样，天平 $2$ 和 $3$ 都会变成平衡的，因此 $2$ 也就是超平衡的。天平 $2$ 上的总质量是 $3+1.5+1.5=6$。当我们这样做的时候，天平 $1$ 也会变成平衡的，所以它也是超平衡的，它的总质量是 $6+3+1.5+1.5=12$。当我们把砝码 $3$ 的质量改成 $2$ 的时候，这种方法就不行了。因此，为了让天平 $1$ 变成超平衡的，我们可以把砝码 $1$ 的质量改成 $4$，砝码 $2$ 的质量改成 $8$，砝码 $4$ 的质量改成 $2$。这样，天平 $1$ 上的总质量就是 $8+4+2+2=16$。\n\n### 数据范围\n\n对于所有输入数据，满足：\n\n- $1 \\leq N \\leq 2 \\cdot 10^{5}$\n- $1 \\leq Q \\leq 2 \\cdot 10^{5}$\n- $1 \\leq w_{i} \\leq 10^{9}$\n- 对于每个类型 $1$ 的操作：$1 \\leq k \\leq N+1$\n- 对于每个类型 $1$ 的操作：$1 \\leq w \\leq 10^{9}$\n- 对于每个类型 $2$ 的操作：$1 \\leq s \\leq N$\n\n详细子任务附加限制及分值如下表所示。令砝码的深度表示它直接或间接所在的盘子的数量。\n\n| 子任务编号 |  附加限制  | 分值 |\n| :--: | :--: | :--: |\n| $1$ | 每个天平的至少一个盘子上有砝码 | $9$ |\n| $2$ | 每个砝码的深度相同 | $8$ |\n| $3$ | 每个砝码的深度小于 $30$，且 $N, Q \\leq 5000$ | $24$ |\n| $4$ | 每个砝码的深度小于 $30$ | $14$ |\n| $5$ | $N, Q \\leq 5000$ | $14$ |\n| $6$ | 无附加限制 | $31$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalkanOI 2023] Weights", "background": "", "description": "**译自 [BalkanOI 2023](https://boi2023.zotks.si) Day1 T2「[Weights](https://boi2023.zotks.si/wp-content/uploads/day_1/d1_weights/en_EN.pdf)」**\n\n给你 $N$ 个天平，每个天平有两个质量可以忽略不计的盘子。天平用从 $1$ 到 $N$ 的整数编号。每个盘子上要么放着另一个天平，要么放着一个质量不可忽略的砝码。编号为 $1$ 的天平放在地上，其他的天平都放在某个天平的盘子上。一共有 $N+1$ 个砝码。砝码用 $1$ 到 $N+1$ 的整数编号，每个砝码的质量用 $N+1$ 个整数 $w_{1}, w_{2} \\cdots, w_{N+1}$ 表示。\n\n下图给出了一个由三个天平和四个砝码组成的例子。正体字的数字表示天平和砝码的编号，斜体字的数字表示砝码的质量。例如，编号为 $2$ 的天平放在编号为 $1$ 的天平的左盘上，编号为 $2$ 质量为 $6$ 的砝码放在编号为 $1$ 的天平的右盘上。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6sw0vac1.png)\n\n如果一个天平的左盘和右盘的总质量相等，我们说它是平衡的。如果一个天平是平衡的，并且它的两个盘子上要么都是超平衡的天平，要么都是砝码，我们说它是超平衡的。\n\n在上图中，只有天平 $3$ 是平衡的（也是超平衡的），但是如果我们把砝码 $3$ 和 $4$ 的质量都增加到 $1.5$，那么三个天平都会变成超平衡的。然而，如果我们把砝码 $1$ 的质量增加到 $4$，天平 $1$ 会变成平衡的但不是超平衡的，因为天平 $2$ 仍然不平衡。\n\n现在我们要处理 $Q$ 个两种类型的操作：\n\n- $1\\,k\\,w$ : 把砝码 $k$ 的质量改成整数 $w$。\n- $2\\,s$ : 假设我们想让天平 $s$ 变成超平衡的。我们可以用魔法把一些砝码变得更重！注意新的质量不一定是整数。要让天平 $s$ 变成超平衡的，天平 $s$ 上的最小总质量是多少？由于这个数可能很大，输出它对 $998244353$ 取模的结果。可以证明在给定的限制下，结果总是一个整数。\n\n注意，类型 $1$ 的操作会改变砝码的质量，而类型 $2$ 的操作不会。", "inputFormat": "第一行包含两个整数 $N$ 和 $Q$。\n\n接下来的 $N$ 行中的第 $i\\ (1\\leq i\\leq N)$ 行包含两对字符和数字，每对描述了第 $i$ 个天平的一个盘子：字符是 `S`（天平）或 `W`（砝码），表示盘子上的物体的类型，整数是相应物体的编号。保证一个天平永远不会放在一个编号更大的天平上。\n\n接下来的一行包含 $N+1$ 个整数 $w_{1}, w_{2}, \\cdots, w_{N+1}$，表示砝码的质量。\n\n最后的 $Q$ 行表示操作。每行要么是形如 $1\\,k\\,w$ 的，要么是形如 $2\\,s$ 的，如问题描述中所述。", "outputFormat": "对于每个类型 $2$ 的操作，在一行上输出相应的最小质量对 $998244353$ 取模的结果。", "hint": "### 样例解释\n\n为了让天平 $2$ 变成超平衡的，我们把砝码 $3$ 和 $4$ 的质量都增加到 $1.5$。这样，天平 $2$ 和 $3$ 都会变成平衡的，因此 $2$ 也就是超平衡的。天平 $2$ 上的总质量是 $3+1.5+1.5=6$。当我们这样做的时候，天平 $1$ 也会变成平衡的，所以它也是超平衡的，它的总质量是 $6+3+1.5+1.5=12$。当我们把砝码 $3$ 的质量改成 $2$ 的时候，这种方法就不行了。因此，为了让天平 $1$ 变成超平衡的，我们可以把砝码 $1$ 的质量改成 $4$，砝码 $2$ 的质量改成 $8$，砝码 $4$ 的质量改成 $2$。这样，天平 $1$ 上的总质量就是 $8+4+2+2=16$。\n\n### 数据范围\n\n对于所有输入数据，满足：\n\n- $1 \\leq N \\leq 2 \\cdot 10^{5}$\n- $1 \\leq Q \\leq 2 \\cdot 10^{5}$\n- $1 \\leq w_{i} \\leq 10^{9}$\n- 对于每个类型 $1$ 的操作：$1 \\leq k \\leq N+1$\n- 对于每个类型 $1$ 的操作：$1 \\leq w \\leq 10^{9}$\n- 对于每个类型 $2$ 的操作：$1 \\leq s \\leq N$\n\n详细子任务附加限制及分值如下表所示。令砝码的深度表示它直接或间接所在的盘子的数量。\n\n| 子任务编号 |  附加限制  | 分值 |\n| :--: | :--: | :--: |\n| $1$ | 每个天平的至少一个盘子上有砝码 | $9$ |\n| $2$ | 每个砝码的深度相同 | $8$ |\n| $3$ | 每个砝码的深度小于 $30$，且 $N, Q \\leq 5000$ | $24$ |\n| $4$ | 每个砝码的深度小于 $30$ | $14$ |\n| $5$ | $N, Q \\leq 5000$ | $14$ |\n| $6$ | 无附加限制 | $31$ |", "locale": "zh-CN"}}}
{"pid": "P11164", "type": "P", "difficulty": 7, "samples": [["5\n4 2 1 5 3\n4\n1 1\n2 3\n2 4\n1 3", "4\n5\n1\n0"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2023", "BalkanOI（巴尔干半岛）"], "title": "[BalkanOI 2023] Permutations", "background": "", "description": "**译自 [BalkanOI 2023](https://boi2023.zotks.si) Day1 T3「[Permutations](https://boi2023.zotks.si/wp-content/uploads/day_1/d1_permutations/en_EN.pdf)」**\n\n给你一个由数字 $1,2, \\ldots, n$ 组成的排列 $p_{1}, p_{2}, \\ldots, p_{n}$。你需要回答 $q$ 个查询。\n\n第 $i\\ (1\\leq i\\leq q)$ 个查询由两个数字 $L_{i},R_{i}\\ (1 \\leq L_{i} \\leq R_{i} \\leq n)$ 表示。你需要回答满足以下条件的排列个数：\n\n- 排列的长度为 $n$；\n- 以序列 $p_{L_{i}}, p_{L_{i}+1}, \\ldots, p_{R_{i}-1}, p_{R_{i}}$ 作为开头；\n- 排列的最长递减子序列的长度至多为 $2$。\n\n由于答案可能很大，输出它们对 $10^{9}+7$ 取模的结果。\n\n对于一个序列 $a_{1}, a_{2}, \\ldots, a_{k}$，它的最长递减子序列的长度是最大的整数 $t$，使得存在 $t$ 个下标 $s_{1}, s_{2}, \\ldots, s_{t}$，满足 $1 \\leq s_{1}<s_{2}<\\ldots<s_{t} \\leq k$ 且 $a_{s_{1}}>a_{s_{2}}>\\ldots>a_{s_{t}}$。", "inputFormat": "第一行包含一个整数 $n$。\n\n第二行包含 $n$ 个整数 $p_{1}, \\ldots, p_{n}$，即区间 $[1, n]$ 中的 $n$ 个不同的整数。\n\n第三行包含一个整数 $q$。\n\n接下来的 $q$ 行每行描述了一个查询。第 $i\\ (1\\leq i\\leq q)$ 行包含两个整数字 $L_{i}$ 和 $R_{i}$。", "outputFormat": "对于每个查询输出单独的一行，表示打印排列的个数对 $10^{9}+7$ 取模的结果。", "hint": "### 样例解释\n\n对于第一个查询，考虑到有四个序列 $\\langle 1,2,3,4,5\\rangle$ 的排列以 $4$ 开始，并且它们的最长递减子序列的长度至多为 $2$。这些排列是：\n\n- $\\langle 4,1,2,3,5\\rangle$；\n- $\\langle 4,1,2,5,3\\rangle$；\n- $\\langle 4,1,5,2,3\\rangle$；\n- $\\langle 4,5,1,2,3\\rangle$。\n\n### 数据范围\n\n对于所有输入数据，满足：\n\n- $1 \\leq n \\leq 3 \\cdot 10^{5}$\n- $1 \\leq q \\leq 3 \\cdot 10^{5}$\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务编号 |  附加限制  | 分值 |\n| :--: | :--: | :--: |\n| $1$ | $n \\leq 10, q \\leq 10$ | $6$ |\n| $2$ | $n \\leq 1000, q \\leq 1000$，每个查询的区间内都包含 $p_{j}=n$ | $7$ |\n| $3$ | 每个查询的区间内都包含 $p_{j}=n$ | $9$ |\n| $4$ | $n \\leq 1000, q \\leq 1000$，$p_{i}=i\\ (1\\leq i\\leq n)$，$L_{j}=1\\ (1\\leq j\\leq q)$ | $12$ |\n| $5$ |$p_{i}=i\\ (1\\leq i \\leq n)$，$L_{j}=1\\ (1\\leq j\\leq q)$ | $18$ |\n| $6$ | $n \\leq 1000, q \\leq 1000$ | $12$ |\n| $7$ | 无附加限制 | $36$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalkanOI 2023] Permutations", "background": "", "description": "**译自 [BalkanOI 2023](https://boi2023.zotks.si) Day1 T3「[Permutations](https://boi2023.zotks.si/wp-content/uploads/day_1/d1_permutations/en_EN.pdf)」**\n\n给你一个由数字 $1,2, \\ldots, n$ 组成的排列 $p_{1}, p_{2}, \\ldots, p_{n}$。你需要回答 $q$ 个查询。\n\n第 $i\\ (1\\leq i\\leq q)$ 个查询由两个数字 $L_{i},R_{i}\\ (1 \\leq L_{i} \\leq R_{i} \\leq n)$ 表示。你需要回答满足以下条件的排列个数：\n\n- 排列的长度为 $n$；\n- 以序列 $p_{L_{i}}, p_{L_{i}+1}, \\ldots, p_{R_{i}-1}, p_{R_{i}}$ 作为开头；\n- 排列的最长递减子序列的长度至多为 $2$。\n\n由于答案可能很大，输出它们对 $10^{9}+7$ 取模的结果。\n\n对于一个序列 $a_{1}, a_{2}, \\ldots, a_{k}$，它的最长递减子序列的长度是最大的整数 $t$，使得存在 $t$ 个下标 $s_{1}, s_{2}, \\ldots, s_{t}$，满足 $1 \\leq s_{1}<s_{2}<\\ldots<s_{t} \\leq k$ 且 $a_{s_{1}}>a_{s_{2}}>\\ldots>a_{s_{t}}$。", "inputFormat": "第一行包含一个整数 $n$。\n\n第二行包含 $n$ 个整数 $p_{1}, \\ldots, p_{n}$，即区间 $[1, n]$ 中的 $n$ 个不同的整数。\n\n第三行包含一个整数 $q$。\n\n接下来的 $q$ 行每行描述了一个查询。第 $i\\ (1\\leq i\\leq q)$ 行包含两个整数字 $L_{i}$ 和 $R_{i}$。", "outputFormat": "对于每个查询输出单独的一行，表示打印排列的个数对 $10^{9}+7$ 取模的结果。", "hint": "### 样例解释\n\n对于第一个查询，考虑到有四个序列 $\\langle 1,2,3,4,5\\rangle$ 的排列以 $4$ 开始，并且它们的最长递减子序列的长度至多为 $2$。这些排列是：\n\n- $\\langle 4,1,2,3,5\\rangle$；\n- $\\langle 4,1,2,5,3\\rangle$；\n- $\\langle 4,1,5,2,3\\rangle$；\n- $\\langle 4,5,1,2,3\\rangle$。\n\n### 数据范围\n\n对于所有输入数据，满足：\n\n- $1 \\leq n \\leq 3 \\cdot 10^{5}$\n- $1 \\leq q \\leq 3 \\cdot 10^{5}$\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务编号 |  附加限制  | 分值 |\n| :--: | :--: | :--: |\n| $1$ | $n \\leq 10, q \\leq 10$ | $6$ |\n| $2$ | $n \\leq 1000, q \\leq 1000$，每个查询的区间内都包含 $p_{j}=n$ | $7$ |\n| $3$ | 每个查询的区间内都包含 $p_{j}=n$ | $9$ |\n| $4$ | $n \\leq 1000, q \\leq 1000$，$p_{i}=i\\ (1\\leq i\\leq n)$，$L_{j}=1\\ (1\\leq j\\leq q)$ | $12$ |\n| $5$ |$p_{i}=i\\ (1\\leq i \\leq n)$，$L_{j}=1\\ (1\\leq j\\leq q)$ | $18$ |\n| $6$ | $n \\leq 1000, q \\leq 1000$ | $12$ |\n| $7$ | 无附加限制 | $36$ |", "locale": "zh-CN"}}}
{"pid": "P11165", "type": "P", "difficulty": 5, "samples": [["3 3\n0 0\n7 3 4\n1 6\n2 2\n0 3", "196 61\n169 50\n81 14\n25 6"], ["4 2\n0 0 1\n6 5 6 2\n1 2\n0 3", "256 84\n144 36\n16 4"], ["7 3\n0 0 1 1 2 2\n7 6 5 7 3 4 2\n4 4\n3 3\n2 1", "900 367\n784 311\n576 223\n256 83"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["2023", "Special Judge", "BalkanOI（巴尔干半岛）"], "title": "[BalkanOI 2023] Super Tree", "background": "**请仔细阅读【提示说明】中的【评分方式】。**", "description": "**译自 [BalkanOI 2023](https://boi2023.zotks.si) Day2 T1「[Super Tree](https://boi2023.zotks.si/wp-content/uploads/day_2/d2_tree/en.pdf)」**\n\n给定一棵有 $n$ 个节点的有根树，节点用 $0, \\ldots, n-1$ 的编号来标识。根节点的编号为 $0$。节点 $i\\ (0\\leq i\\leq n-1)$ 被赋予一个整数 $a_{i}$。令 $f_{v}$ 为从节点 $v$ 到根节点的简单路径（包括 $x$ 和 $y$ 本身）上所有 $a_{i}$ 的**按位与**（以下用 $\\&$ 表示）的值。令树的能量为\n\n$$\n\\sum_{0 \\leq u, v<n} f_{u} \\cdot f_{v}\n$$\n\n的值，令树的超能量为（注意范围的区别）\n\n$$\n\\sum_{0 \\leq u<v<n} f_{u} \\cdot f_{v}\n$$\n\n的值。为了说明清楚，可以参考下面的样例解释。\n\n我们说一个节点 $u$ 属于另一个节点 $v$ 的子树，如果 $v$ 在从节点 $u$ 到根节点的简单路径上。注意，一个节点 $x$ 的子树包括 $x$ 本身。\n\n给定 $q$ 次更新。每次更新由两个整数 $v$ 和 $x$ 描述，要求你对节点 $v$ 的子树中的每个节点 $u$，令 $a_{u}=a_{u} \\& x$。在每次更新后，你应该输出当前树的能量和超能量。\n\n由于输出值可能很大，你只需要求出答案对 $10^{9}+7$ 取模的结果。", "inputFormat": "第一行包含两个整数 $n$ 和 $q$。\n\n第二行包含 $n-1$ 个整数 $p_{1}, p_{2}, \\ldots, p_{n-1}$。$p_{i}\\ (0\\leq i\\leq n-1)$ 是节点 $i$ 的父节点的编号，且满足 $0 \\leq p_{i}<i$。\n\n第三行包含 $n$ 个整数 $a_{0}, a_{1}, \\ldots, a_{n-1}$。这些是赋给节点的值。\n\n接下来的 $q$ 行，每行包含两个整数 $v$（$0 \\leq v<n$）和 $x$。这些整数指定了各个更新。", "outputFormat": "输出 $q+1$ 行。每行包含两个用空格分隔的整数。第一行，输出初始树的能量和超能量对 $10^{9}+7$ 取模的结果。在剩下的 $q$ 行中，第 $i\\ (1\\leq i\\leq q)$ 行输出第 $i$ 次更新后的树的能量和超能量对 $10^{9}+7$ 取模的结果。\n\n", "hint": "### 样例 1 解释\n\n初始时，我们有\n\n$$\nf_{0}=7, f_{1}=7 \\& 3=3, f_{2}=7 \\& 4=4\n$$\n\n因此，树的能量等于\n\n$$\n\\begin{gathered}\nf_{0} \\cdot f_{0}+f_{0} \\cdot f_{1}+f_{0} \\cdot f_{2}+f_{1} \\cdot f_{0}+f_{1} \\cdot f_{1}+f_{1} \\cdot f_{2}+f_{2} \\cdot f_{0}+f_{2} \\cdot f_{1}+f_{2} \\cdot f_{2}= \\\\\n=7 \\cdot 7+7 \\cdot 3+7 \\cdot 4+3 \\cdot 7+3 \\cdot 3+3 \\cdot 4+4 \\cdot 7+4 \\cdot 3+4 \\cdot 4=196 .\n\\end{gathered}\n$$\n\n树的超能量等于\n\n$$\nf_{0} \\cdot f_{1}+f_{0} \\cdot f_{2}+f_{1} \\cdot f_{2}=7 \\cdot 3+7 \\cdot 4+3 \\cdot 4=61 \\text {. }\n$$\n\n第一次更新后：\n\n$$\n\\begin{gathered}\na_{0}=7, a_{1}=3 \\& 6=2, a_{2}=4 ; \\\\\nf_{0}=7, f_{1}=2, f_{2}=4 .\n\\end{gathered}\n$$\n\n第二次更新后：\n\n$$\n\\begin{gathered}\na_{0}=7, a_{1}=2, a_{2}=4 \\& 2=0 \\\\\nf_{0}=7, f_{1}=2, f_{2}=0\n\\end{gathered}\n$$\n\n第三次更新后：\n\n$$\n\\begin{gathered}\na_{0}=7 \\& 3=3, a_{1}=2 \\& 3=2, a_{2}=0 \\& 3=0 \\\\\nf_{0}=3, f_{1}=2, f_{2}=0\n\\end{gathered}\n$$\n\n### 样例 2 解释\n\n初始时，我们有\n\n$$\nf_{0}=6, f_{1}=6 \\& 5=4, f_{2}=6 \\& 6=6, f_{3}=2 \\& 5 \\& 6=0\n$$\n\n第一次更新后：\n\n$$\n\\begin{gathered}\na_{0}=6, a_{1}=5 \\& 2=0, a_{2}=6, a_{3}=2 \\& 2=2 ; \\\\\nf_{0}=6, f_{1}=0, f_{2}=6, f_{3}=2 \\& 0=0\n\\end{gathered}\n$$\n\n第二次更新后：\n\n$$\n\\begin{gathered}\na_{0}=7, a_{1}=2, a_{2}=4 \\& 2=0 \\\\\nf_{0}=7, f_{1}=2, f_{2}=0\n\\end{gathered}\n$$\n\n### 评分方式\n\n对于给定的测试点，如果你的代码正确计算了所有的能量值，但是至少有一个超能量值计算错误，那么你的代码将获得该测试点 $50 \\%$ 的分数。\n\n同样地，如果你的代码正确计算了所有的超能量值，但是至少有一个能量值计算错误，那么你的代码将获得该测试点 $50 \\%$ 的分数。\n\n### 数据范围\n\n对于所有输入数据，满足：\n\n- $1 \\leq n, q \\leq 10^{6}$\n- $0 \\leq a_{i}<2^{60}\\ (0\\leq i\\leq n-1)$\n- $0 \\leq x<2^{60}$\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务编号 |  附加限制  | 分值 |\n| :--: | :--: | :--: |\n| $1$ | $n=3$ | $4$ |\n| $2$ | $n, q \\leq 700$ | $7$ |\n| $3$ | $n, q \\leq 5000$ | $13$ |\n| $4$ | $n \\leq 10^{5}, p_{i}=i-1\\ (1\\leq i\\leq n-1);a_{i}, x<2^{20}\\ (0\\leq i\\leq n-1)$ | $6$ |\n| $5$ | $p_{i}=i-1\\ (1\\leq i\\leq n-1)$ | $7$ |\n| $6$ | $a_{i}, x<2^{20}\\ (0\\leq i\\leq n-1)$ | $12$ |\n| $7$ | $n \\leq 10^{5}$ | $14$ |\n| $8$ | $n \\leq 5 \\cdot 10^{5}$ | $11$ |\n| $9$ | 无附加限制 | $26$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalkanOI 2023] Super Tree", "background": "**请仔细阅读【提示说明】中的【评分方式】。**", "description": "**译自 [BalkanOI 2023](https://boi2023.zotks.si) Day2 T1「[Super Tree](https://boi2023.zotks.si/wp-content/uploads/day_2/d2_tree/en.pdf)」**\n\n给定一棵有 $n$ 个节点的有根树，节点用 $0, \\ldots, n-1$ 的编号来标识。根节点的编号为 $0$。节点 $i\\ (0\\leq i\\leq n-1)$ 被赋予一个整数 $a_{i}$。令 $f_{v}$ 为从节点 $v$ 到根节点的简单路径（包括 $x$ 和 $y$ 本身）上所有 $a_{i}$ 的**按位与**（以下用 $\\&$ 表示）的值。令树的能量为\n\n$$\n\\sum_{0 \\leq u, v<n} f_{u} \\cdot f_{v}\n$$\n\n的值，令树的超能量为（注意范围的区别）\n\n$$\n\\sum_{0 \\leq u<v<n} f_{u} \\cdot f_{v}\n$$\n\n的值。为了说明清楚，可以参考下面的样例解释。\n\n我们说一个节点 $u$ 属于另一个节点 $v$ 的子树，如果 $v$ 在从节点 $u$ 到根节点的简单路径上。注意，一个节点 $x$ 的子树包括 $x$ 本身。\n\n给定 $q$ 次更新。每次更新由两个整数 $v$ 和 $x$ 描述，要求你对节点 $v$ 的子树中的每个节点 $u$，令 $a_{u}=a_{u} \\& x$。在每次更新后，你应该输出当前树的能量和超能量。\n\n由于输出值可能很大，你只需要求出答案对 $10^{9}+7$ 取模的结果。", "inputFormat": "第一行包含两个整数 $n$ 和 $q$。\n\n第二行包含 $n-1$ 个整数 $p_{1}, p_{2}, \\ldots, p_{n-1}$。$p_{i}\\ (0\\leq i\\leq n-1)$ 是节点 $i$ 的父节点的编号，且满足 $0 \\leq p_{i}<i$。\n\n第三行包含 $n$ 个整数 $a_{0}, a_{1}, \\ldots, a_{n-1}$。这些是赋给节点的值。\n\n接下来的 $q$ 行，每行包含两个整数 $v$（$0 \\leq v<n$）和 $x$。这些整数指定了各个更新。", "outputFormat": "输出 $q+1$ 行。每行包含两个用空格分隔的整数。第一行，输出初始树的能量和超能量对 $10^{9}+7$ 取模的结果。在剩下的 $q$ 行中，第 $i\\ (1\\leq i\\leq q)$ 行输出第 $i$ 次更新后的树的能量和超能量对 $10^{9}+7$ 取模的结果。\n\n", "hint": "### 样例 1 解释\n\n初始时，我们有\n\n$$\nf_{0}=7, f_{1}=7 \\& 3=3, f_{2}=7 \\& 4=4\n$$\n\n因此，树的能量等于\n\n$$\n\\begin{gathered}\nf_{0} \\cdot f_{0}+f_{0} \\cdot f_{1}+f_{0} \\cdot f_{2}+f_{1} \\cdot f_{0}+f_{1} \\cdot f_{1}+f_{1} \\cdot f_{2}+f_{2} \\cdot f_{0}+f_{2} \\cdot f_{1}+f_{2} \\cdot f_{2}= \\\\\n=7 \\cdot 7+7 \\cdot 3+7 \\cdot 4+3 \\cdot 7+3 \\cdot 3+3 \\cdot 4+4 \\cdot 7+4 \\cdot 3+4 \\cdot 4=196 .\n\\end{gathered}\n$$\n\n树的超能量等于\n\n$$\nf_{0} \\cdot f_{1}+f_{0} \\cdot f_{2}+f_{1} \\cdot f_{2}=7 \\cdot 3+7 \\cdot 4+3 \\cdot 4=61 \\text {. }\n$$\n\n第一次更新后：\n\n$$\n\\begin{gathered}\na_{0}=7, a_{1}=3 \\& 6=2, a_{2}=4 ; \\\\\nf_{0}=7, f_{1}=2, f_{2}=4 .\n\\end{gathered}\n$$\n\n第二次更新后：\n\n$$\n\\begin{gathered}\na_{0}=7, a_{1}=2, a_{2}=4 \\& 2=0 \\\\\nf_{0}=7, f_{1}=2, f_{2}=0\n\\end{gathered}\n$$\n\n第三次更新后：\n\n$$\n\\begin{gathered}\na_{0}=7 \\& 3=3, a_{1}=2 \\& 3=2, a_{2}=0 \\& 3=0 \\\\\nf_{0}=3, f_{1}=2, f_{2}=0\n\\end{gathered}\n$$\n\n### 样例 2 解释\n\n初始时，我们有\n\n$$\nf_{0}=6, f_{1}=6 \\& 5=4, f_{2}=6 \\& 6=6, f_{3}=2 \\& 5 \\& 6=0\n$$\n\n第一次更新后：\n\n$$\n\\begin{gathered}\na_{0}=6, a_{1}=5 \\& 2=0, a_{2}=6, a_{3}=2 \\& 2=2 ; \\\\\nf_{0}=6, f_{1}=0, f_{2}=6, f_{3}=2 \\& 0=0\n\\end{gathered}\n$$\n\n第二次更新后：\n\n$$\n\\begin{gathered}\na_{0}=7, a_{1}=2, a_{2}=4 \\& 2=0 \\\\\nf_{0}=7, f_{1}=2, f_{2}=0\n\\end{gathered}\n$$\n\n### 评分方式\n\n对于给定的测试点，如果你的代码正确计算了所有的能量值，但是至少有一个超能量值计算错误，那么你的代码将获得该测试点 $50 \\%$ 的分数。\n\n同样地，如果你的代码正确计算了所有的超能量值，但是至少有一个能量值计算错误，那么你的代码将获得该测试点 $50 \\%$ 的分数。\n\n### 数据范围\n\n对于所有输入数据，满足：\n\n- $1 \\leq n, q \\leq 10^{6}$\n- $0 \\leq a_{i}<2^{60}\\ (0\\leq i\\leq n-1)$\n- $0 \\leq x<2^{60}$\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务编号 |  附加限制  | 分值 |\n| :--: | :--: | :--: |\n| $1$ | $n=3$ | $4$ |\n| $2$ | $n, q \\leq 700$ | $7$ |\n| $3$ | $n, q \\leq 5000$ | $13$ |\n| $4$ | $n \\leq 10^{5}, p_{i}=i-1\\ (1\\leq i\\leq n-1);a_{i}, x<2^{20}\\ (0\\leq i\\leq n-1)$ | $6$ |\n| $5$ | $p_{i}=i-1\\ (1\\leq i\\leq n-1)$ | $7$ |\n| $6$ | $a_{i}, x<2^{20}\\ (0\\leq i\\leq n-1)$ | $12$ |\n| $7$ | $n \\leq 10^{5}$ | $14$ |\n| $8$ | $n \\leq 5 \\cdot 10^{5}$ | $11$ |\n| $9$ | 无附加限制 | $26$ |", "locale": "zh-CN"}}}
{"pid": "P11166", "type": "P", "difficulty": 0, "samples": [["5 4\n8 3 4\n5 2 3\n10 9 10\n20 4 6\n12 7 9", "12"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2023", "BalkanOI（巴尔干半岛）"], "title": "[BalkanOI 2023] Save the Vine!", "background": "", "description": "**译自 [BalkanOI 2023](https://boi2023.zotks.si) Day2 T2「[Save the Vine!](https://boi2023.zotks.si/wp-content/uploads/day_2/d2_vine/en.pdf)」**\n\n一群又臭又丑的绿色小人准备毒死 450 年历史的葡萄藤，这是马里博尔的象征！他们正在 Kodžak 纪念碑周围聚集，制定他们的计划，准备向 Drava 河左岸的著名 Lent 街上的房子进军，那里就是那棵古老的葡萄藤生长的地方！你，强大的紫色战士，被召唤来在他们实施致命的行动之前消灭敌人！\n\n一共有 $n$ 个敌人，每个敌人都有三个属性：臭度、绿度和丑度。对于每个 $i \\in\\{1, \\ldots, n\\}$，整数 $a_{i}, b_{i}$ 和 $c_{i}$ 分别决定了第 $i$ 个敌人的臭度、绿度和丑度。而你有两个属性：力量 $X$ 和紫度 $Y$。\n\n作为一个自豪的马里博尔人，你的紫度 $Y$ 在你出生时就已经确定，永远不会改变。但是，通过击败敌人，你的力量 $X$ 会增加。特别地，当你击败敌人 $i$ 时，$X$ 会增加该敌人的丑度 $c_{i}$。你可以按任意顺序一个一个地击败敌人，但你只能在你的力量大于他的臭度（$X \\geq a_{i}$）且你的紫度大于他的绿度（$Y \\geq b_{i}$）时击败敌人 $i$。另外，你只能击败每个敌人一次。\n\n你肯定想知道，为了击败至少 $k$ 个敌人，你最初的力量和紫度（即 $X+Y$）的最小和是多少。编写一个程序来找到这个值！", "inputFormat": "第一行包含整数 $n$ 和 $k$。接下来的 $n$ 行中的第 $i\\ (1\\leq i\\leq n)$ 行包含整数 $a_{i}, b_{i}$ 和 $c_{i}$。", "outputFormat": "输出至少击败 $k$ 个敌人所需的 $X+Y$ 的最小初始值。", "hint": "### 样例解释\n\n为了击败至少四个敌人，只需要从 $X=5$ 和 $Y=7$ 开始。首先，你击败敌人 $2$，将你的 $X$ 提升到 $8$。现在，你可以摧毁敌人 $1$，并达到 $X=12$。有了这样的力量，你可以击败敌人 $5$，达到 $X=21$。你完成你的任务，消灭敌人 $4$。\n\n### 数据范围\n\n对于所有输入数据，满足：\n\n- $1 \\leq n \\leq 2 \\cdot 10^{5}$\n- $1 \\leq k \\leq n$\n- $0 \\leq a_{i}, b_{i}, c_{i} \\leq 10^{9}$\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务编号 | 附加限制 | 分值 |\n| :--: | :--: | :--: |\n| $1$ | $n \\leq 1000$ | $19$ |\n| $2$ | $b_{i}=0\\ (1\\leq i\\leq n)$ | $15$ |\n| $3$ | $c_{i}=0\\ (1\\leq i\\leq n)$ | $24$ |\n| $4$ | 无附加限制 | $42$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalkanOI 2023] Save the Vine!", "background": "", "description": "**译自 [BalkanOI 2023](https://boi2023.zotks.si) Day2 T2「[Save the Vine!](https://boi2023.zotks.si/wp-content/uploads/day_2/d2_vine/en.pdf)」**\n\n一群又臭又丑的绿色小人准备毒死 450 年历史的葡萄藤，这是马里博尔的象征！他们正在 Kodžak 纪念碑周围聚集，制定他们的计划，准备向 Drava 河左岸的著名 Lent 街上的房子进军，那里就是那棵古老的葡萄藤生长的地方！你，强大的紫色战士，被召唤来在他们实施致命的行动之前消灭敌人！\n\n一共有 $n$ 个敌人，每个敌人都有三个属性：臭度、绿度和丑度。对于每个 $i \\in\\{1, \\ldots, n\\}$，整数 $a_{i}, b_{i}$ 和 $c_{i}$ 分别决定了第 $i$ 个敌人的臭度、绿度和丑度。而你有两个属性：力量 $X$ 和紫度 $Y$。\n\n作为一个自豪的马里博尔人，你的紫度 $Y$ 在你出生时就已经确定，永远不会改变。但是，通过击败敌人，你的力量 $X$ 会增加。特别地，当你击败敌人 $i$ 时，$X$ 会增加该敌人的丑度 $c_{i}$。你可以按任意顺序一个一个地击败敌人，但你只能在你的力量大于他的臭度（$X \\geq a_{i}$）且你的紫度大于他的绿度（$Y \\geq b_{i}$）时击败敌人 $i$。另外，你只能击败每个敌人一次。\n\n你肯定想知道，为了击败至少 $k$ 个敌人，你最初的力量和紫度（即 $X+Y$）的最小和是多少。编写一个程序来找到这个值！", "inputFormat": "第一行包含整数 $n$ 和 $k$。接下来的 $n$ 行中的第 $i\\ (1\\leq i\\leq n)$ 行包含整数 $a_{i}, b_{i}$ 和 $c_{i}$。", "outputFormat": "输出至少击败 $k$ 个敌人所需的 $X+Y$ 的最小初始值。", "hint": "### 样例解释\n\n为了击败至少四个敌人，只需要从 $X=5$ 和 $Y=7$ 开始。首先，你击败敌人 $2$，将你的 $X$ 提升到 $8$。现在，你可以摧毁敌人 $1$，并达到 $X=12$。有了这样的力量，你可以击败敌人 $5$，达到 $X=21$。你完成你的任务，消灭敌人 $4$。\n\n### 数据范围\n\n对于所有输入数据，满足：\n\n- $1 \\leq n \\leq 2 \\cdot 10^{5}$\n- $1 \\leq k \\leq n$\n- $0 \\leq a_{i}, b_{i}, c_{i} \\leq 10^{9}$\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务编号 | 附加限制 | 分值 |\n| :--: | :--: | :--: |\n| $1$ | $n \\leq 1000$ | $19$ |\n| $2$ | $b_{i}=0\\ (1\\leq i\\leq n)$ | $15$ |\n| $3$ | $c_{i}=0\\ (1\\leq i\\leq n)$ | $24$ |\n| $4$ | 无附加限制 | $42$ |", "locale": "zh-CN"}}}
{"pid": "P11167", "type": "P", "difficulty": 6, "samples": [["5 1 5\n8 7 9 4 16 12\n1\n0 4\n3 1\n2 4\n5 4\n4 3\n1\n2 4 2 1\n2 3 2 1\n2 4 1 3\n2 5 2 3", "4\n1\n0\n2\n2"], ["10 2 11\n1 2 3 4 5 6 7 8 9 10 11\n9 3\n5 8\n2 7\n3 4\n6 8\n0 1\n2 9\n5 2\n4 5\n7 10\n1 2\n1\n2 5 1 2\n2 5 2 2\n2 5 2 3\n2 5 2 4\n2 9 3 2\n2 9 3 3\n2 9 4 1\n2 2 1 3\n2 2 2 4\n2 2 3 1", "7\n4\n3\n6\n7\n4\n8\n3\n7\n10\n3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2023", "BalkanOI（巴尔干半岛）"], "title": "[BalkanOI 2023] Aliens", "background": "", "description": "**译自 [BalkanOI 2023](https://boi2023.zotks.si) Day2 T3「[Aliens](https://boi2023.zotks.si/wp-content/uploads/day_2/d2_aliens/en.pdf)」**\n\n马里博尔刚刚被外星人拜访了！他们与你分享了他们的技术和历史。\n\n有 $N+1$ 个行星，从 $0$ 到 $N$ 编号，地球的编号为 $N$。每个行星都有一个唯一的人口数 $P_{i}\\ (0\\leq i\\leq N)$。行星之间用 $N$ 个双向传送门连接，你可以只用这些传送门在任意两个行星之间旅行。传送门 $i$（$0\\leq i\\leq N-1$）连接了行星 $U_{i}$ 和 $V_{i}$。两个行星之间的距离是旅行所需的最少传送门数。\n\n你从地球出发，想要去游览 $K$ 个其他行星 $A_{0}, A_{1}, \\ldots, A_{K-1}$。这些被称为**起源行星**。每个起源行星和地球只有一个传送门连接。你的旅程为从地球出发，访问所有起源行星以及沿途所有行星的最短路线。令 $S$ 为所有访问过的行星的集合。\n\n现在，外星人决定通过向你提问 $Q$ 个以下两种类型的问题来测试地球是否有资格加入他们的超级文明：\n\n- 类型 $1$：集合 $S$ 的大小是多少？\n- 类型 $2$：他们从 $S$ 中选出一个行星 $x$，一个距离 $d$，和一个数字 $r$。他们问你，在距离 $x$ 为 $d$ 的行星中，按人口数从小到大排列的第 $r$ 个行星是哪个。（例如，如果 $r=1$ 答案就是距离 $x$ 为 $d$ 的星球中人口数最少的行星。这个行星可以也可以不属于集合 $S$。）\n\n只有一个类型 $1$ 的查询。", "inputFormat": "第一行包含三个整数 $N, K, Q$。\n\n第二行包含 $N+1$ 个整数 $P_{0}, \\ldots, P_{N}$。\n\n第三行包含 $K$ 个整数 $A_{0}, \\ldots, A_{K-1}$。\n\n接下来的 $N$ 行中的第 $i\\ (1\\leq i\\leq N-1)$ 行包含两个整数 $U_{i}$ 和 $V_{i}$。\n\n接下来的 $Q$ 行满足以下格式之一：\n\n- $1$ 表示一个类型 $1$ 的查询；\n- $2\\,x\\,d\\,r$ 表示一个类型 $2$ 的查询。", "outputFormat": "对于每个查询，输出一行。对于类型 $1$ 的查询，输出游览期间访问的行星数；对于类型 $2$ 的查询，输出距离 $x$ 为 $d$ 的行星中按人口数排列的第 $r$ 个行星。", "hint": "### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7q7mu3wl.png)\n\n只有一个起源行星，我们在游览中访问了行星 $S=\\{1,3,4,5\\}$。类型 $2$ 的查询有：\n\n- $x=4, d=2, r=1$\n- 距离行星 $4$ 为 $2$ 的只有行星 $1$。\n- $x=3, d=2, r=1$\n- 距离行星 $3$ 为 $2$ 的有行星 $0,2,5$。其中，行星 $0$ 的人口数最少。\n- $x=4, d=1, r=3$\n- 距离行星 $4$ 为 $1$ 的有行星 $0,2,3,5$，它们按人口数的顺序是 $3,0,2,5$。其中第三个是行星 $2$。\n- $x=5, d=2, r=3$\n- 距离行星 $5$ 为 $2$ 的有行星 $0,2,3$，它们按人口数的顺序是 $3,0,2$。其中第三个是行星 $2$。\n\n### 样例 2 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/sytqzdyc.png)\n\n### 数据范围\n\n对于所有输入数据，满足：\n\n- $1 \\leq N \\leq 10^5$\n- $1 \\leq K \\leq 10$\n- $1 \\leq Q \\leq 10^5$\n- $1 \\leq P_{i} \\leq 10^{9}\\ (0 \\leq i \\leq N)$；\n- 所有的 $P_{i}$ 都是不同的\n- $0 \\leq A_{i} \\leq N-1\\ (0 \\leq i \\leq K-1)$\n- $0 \\leq U_{i}, V_{i} \\leq N\\ (0 \\leq i \\leq N-1)$\n- $K$ 个起源行星和地球只有一个传送门连接\n- 对于每个类型 $2$ 的查询，满足 $x \\in S, d \\geq 1$，且 $r \\geq 1$\n- 保证距离 $x$ 为 $d$ 的行星至少有 $r$ 个\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务编号 | 附加限制 | 分值 |\n| :--: | :--: | :--: |\n| $1$ | $Q=1$ | $3$ |\n| $2$ | $N \\leq 2000, Q \\leq 2000$ | $14$ |\n| $3$ | $K=1$ | $21$ |\n| $4$ | $N \\leq 10000$ | $12$ |\n| $5$ | $Q \\leq 10000$ | $13$ |\n| $6$ | 无附加限制 | $37$ |\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[BalkanOI 2023] Aliens", "background": "", "description": "**译自 [BalkanOI 2023](https://boi2023.zotks.si) Day2 T3「[Aliens](https://boi2023.zotks.si/wp-content/uploads/day_2/d2_aliens/en.pdf)」**\n\n马里博尔刚刚被外星人拜访了！他们与你分享了他们的技术和历史。\n\n有 $N+1$ 个行星，从 $0$ 到 $N$ 编号，地球的编号为 $N$。每个行星都有一个唯一的人口数 $P_{i}\\ (0\\leq i\\leq N)$。行星之间用 $N$ 个双向传送门连接，你可以只用这些传送门在任意两个行星之间旅行。传送门 $i$（$0\\leq i\\leq N-1$）连接了行星 $U_{i}$ 和 $V_{i}$。两个行星之间的距离是旅行所需的最少传送门数。\n\n你从地球出发，想要去游览 $K$ 个其他行星 $A_{0}, A_{1}, \\ldots, A_{K-1}$。这些被称为**起源行星**。每个起源行星和地球只有一个传送门连接。你的旅程为从地球出发，访问所有起源行星以及沿途所有行星的最短路线。令 $S$ 为所有访问过的行星的集合。\n\n现在，外星人决定通过向你提问 $Q$ 个以下两种类型的问题来测试地球是否有资格加入他们的超级文明：\n\n- 类型 $1$：集合 $S$ 的大小是多少？\n- 类型 $2$：他们从 $S$ 中选出一个行星 $x$，一个距离 $d$，和一个数字 $r$。他们问你，在距离 $x$ 为 $d$ 的行星中，按人口数从小到大排列的第 $r$ 个行星是哪个。（例如，如果 $r=1$ 答案就是距离 $x$ 为 $d$ 的星球中人口数最少的行星。这个行星可以也可以不属于集合 $S$。）\n\n只有一个类型 $1$ 的查询。", "inputFormat": "第一行包含三个整数 $N, K, Q$。\n\n第二行包含 $N+1$ 个整数 $P_{0}, \\ldots, P_{N}$。\n\n第三行包含 $K$ 个整数 $A_{0}, \\ldots, A_{K-1}$。\n\n接下来的 $N$ 行中的第 $i\\ (1\\leq i\\leq N-1)$ 行包含两个整数 $U_{i}$ 和 $V_{i}$。\n\n接下来的 $Q$ 行满足以下格式之一：\n\n- $1$ 表示一个类型 $1$ 的查询；\n- $2\\,x\\,d\\,r$ 表示一个类型 $2$ 的查询。", "outputFormat": "对于每个查询，输出一行。对于类型 $1$ 的查询，输出游览期间访问的行星数；对于类型 $2$ 的查询，输出距离 $x$ 为 $d$ 的行星中按人口数排列的第 $r$ 个行星。", "hint": "### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7q7mu3wl.png)\n\n只有一个起源行星，我们在游览中访问了行星 $S=\\{1,3,4,5\\}$。类型 $2$ 的查询有：\n\n- $x=4, d=2, r=1$\n- 距离行星 $4$ 为 $2$ 的只有行星 $1$。\n- $x=3, d=2, r=1$\n- 距离行星 $3$ 为 $2$ 的有行星 $0,2,5$。其中，行星 $0$ 的人口数最少。\n- $x=4, d=1, r=3$\n- 距离行星 $4$ 为 $1$ 的有行星 $0,2,3,5$，它们按人口数的顺序是 $3,0,2,5$。其中第三个是行星 $2$。\n- $x=5, d=2, r=3$\n- 距离行星 $5$ 为 $2$ 的有行星 $0,2,3$，它们按人口数的顺序是 $3,0,2$。其中第三个是行星 $2$。\n\n### 样例 2 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/sytqzdyc.png)\n\n### 数据范围\n\n对于所有输入数据，满足：\n\n- $1 \\leq N \\leq 10^5$\n- $1 \\leq K \\leq 10$\n- $1 \\leq Q \\leq 10^5$\n- $1 \\leq P_{i} \\leq 10^{9}\\ (0 \\leq i \\leq N)$；\n- 所有的 $P_{i}$ 都是不同的\n- $0 \\leq A_{i} \\leq N-1\\ (0 \\leq i \\leq K-1)$\n- $0 \\leq U_{i}, V_{i} \\leq N\\ (0 \\leq i \\leq N-1)$\n- $K$ 个起源行星和地球只有一个传送门连接\n- 对于每个类型 $2$ 的查询，满足 $x \\in S, d \\geq 1$，且 $r \\geq 1$\n- 保证距离 $x$ 为 $d$ 的行星至少有 $r$ 个\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务编号 | 附加限制 | 分值 |\n| :--: | :--: | :--: |\n| $1$ | $Q=1$ | $3$ |\n| $2$ | $N \\leq 2000, Q \\leq 2000$ | $14$ |\n| $3$ | $K=1$ | $21$ |\n| $4$ | $N \\leq 10000$ | $12$ |\n| $5$ | $Q \\leq 10000$ | $13$ |\n| $6$ | 无附加限制 | $37$ |\n", "locale": "zh-CN"}}}
{"pid": "P11168", "type": "P", "difficulty": 4, "samples": [["3 3\n2 2 1", "5"], ["2 5\n1 3 0", "7"], ["4 5\n3 2 0", "16"]], "limits": {"time": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "2024", "洛谷原创", "O2优化"], "title": "「CMOI R1」First Town of This Journey／Grid Covering", "background": "![Link:First Town of This Journey](bilibili:BV1ka411G78Y)$\\small\\color{white}/10^{\\text{th}}\\text{Problem by AtC}.$\n\n本题中认为两个点间的连线为以这两个点作为端点的线段。", "description": "$\\text{BiOI}$ 有一个 $n$ 行 $m$ 列的网格。你需要选出最少的格点，使得任意两个**不同的**格点的连线至少经过一个被选中的点（这里我们认为一条线段**经过了**它的两个端点）。\n\n$\\text{CmOI}$ 觉得这个问题太简单了，所以他会另外给定 $a,b,x$，表示第 $a$ 行第 $b$ 列的格点必须被或不被选中：\n\n* $x=0$ 时该格点不可选中；\n* $x=1$ 时该格点必须选中。\n\n你只需要求出最少选出几个格点，$\\text{BiOI}$ 和 $\\text{CmOI}$ 会把网格和你的答案一起丢给 $\\text{ArCu}$ 让他构造方案。", "inputFormat": "第一行两个整数 $n,m$；\n\n第二行三个整数 $a,b,x$。", "outputFormat": "一行一个整数，最少选出的格点数。", "hint": "$\\text{Details about Subtasks}:$\n\n所有数据满足 $1\\leq n,m<2^{32},1\\leq a\\leq n,1\\leq b\\leq m,0\\leq x\\leq 1$。\n\n* $\\text{Subtask 1}:1\\leq n,m\\leq 10,\\text{5 points.}$\n* $\\text{Subtask 2}:x=0,\\text{25 points}.$\n* $\\text{Subtask 3}:x=1,\\text{30 points.}$\n* $\\text{Subtask 4}:\\text{40 points.}$\n\n$\\text{Sample Explanation}:$\n\n* $\\text{Sample 1}:$\n\n此时网格有 $3$ 行 $3$ 列，要求第 $2$ 行第 $2$ 列的格点必须被选中。\n\n最优方案如下（黑色是被选中的格点）：\n\n![010111010](https://cdn.luogu.com.cn/upload/image_hosting/qltw919n.png)\n\n注意以下方案并不合法：\n\n* 图中给出了两种方法使得两个不同的格点间连线不经过黑点；\n* 第二行第二列的格点没有被选中，输入中要求这个格点必须被选中。\n\n![011100011](https://cdn.luogu.com.cn/upload/image_hosting/egvtdeq2.png)\n\n以及我们认为端点在黑点上算是经过黑点。也就是说下面的这种连线经过了一个黑色格点。\n\n![011110011](https://cdn.luogu.com.cn/upload/image_hosting/zk2d5ou2.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「CMOI R1」First Town of This Journey／Grid Covering", "background": "![Link:First Town of This Journey](bilibili:BV1ka411G78Y)$\\small\\color{white}/10^{\\text{th}}\\text{Problem by AtC}.$\n\n本题中认为两个点间的连线为以这两个点作为端点的线段。", "description": "$\\text{BiOI}$ 有一个 $n$ 行 $m$ 列的网格。你需要选出最少的格点，使得任意两个**不同的**格点的连线至少经过一个被选中的点（这里我们认为一条线段**经过了**它的两个端点）。\n\n$\\text{CmOI}$ 觉得这个问题太简单了，所以他会另外给定 $a,b,x$，表示第 $a$ 行第 $b$ 列的格点必须被或不被选中：\n\n* $x=0$ 时该格点不可选中；\n* $x=1$ 时该格点必须选中。\n\n你只需要求出最少选出几个格点，$\\text{BiOI}$ 和 $\\text{CmOI}$ 会把网格和你的答案一起丢给 $\\text{ArCu}$ 让他构造方案。", "inputFormat": "第一行两个整数 $n,m$；\n\n第二行三个整数 $a,b,x$。", "outputFormat": "一行一个整数，最少选出的格点数。", "hint": "$\\text{Details about Subtasks}:$\n\n所有数据满足 $1\\leq n,m<2^{32},1\\leq a\\leq n,1\\leq b\\leq m,0\\leq x\\leq 1$。\n\n* $\\text{Subtask 1}:1\\leq n,m\\leq 10,\\text{5 points.}$\n* $\\text{Subtask 2}:x=0,\\text{25 points}.$\n* $\\text{Subtask 3}:x=1,\\text{30 points.}$\n* $\\text{Subtask 4}:\\text{40 points.}$\n\n$\\text{Sample Explanation}:$\n\n* $\\text{Sample 1}:$\n\n此时网格有 $3$ 行 $3$ 列，要求第 $2$ 行第 $2$ 列的格点必须被选中。\n\n最优方案如下（黑色是被选中的格点）：\n\n![010111010](https://cdn.luogu.com.cn/upload/image_hosting/qltw919n.png)\n\n注意以下方案并不合法：\n\n* 图中给出了两种方法使得两个不同的格点间连线不经过黑点；\n* 第二行第二列的格点没有被选中，输入中要求这个格点必须被选中。\n\n![011100011](https://cdn.luogu.com.cn/upload/image_hosting/egvtdeq2.png)\n\n以及我们认为端点在黑点上算是经过黑点。也就是说下面的这种连线经过了一个黑色格点。\n\n![011110011](https://cdn.luogu.com.cn/upload/image_hosting/zk2d5ou2.png)", "locale": "zh-CN"}}}
{"pid": "P11169", "type": "P", "difficulty": 4, "samples": [["100", "50 30"], ["9876543", "4938272 3092277"], ["998877665544332211", "499438832772166106 312742219398875473"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "2024", "洛谷原创", "Special Judge", "O2优化"], "title": "「CMOI R1」Bismuth / Linear Sieve", "background": "![](bilibili:BV1qF4m157gc)\n\n> Can you imagine find wakeless,like a satellite,in the black sky?\n>\n> Somewhere,like a star.\n>\n> We dream about things way beyond this atmosphere.\n>\n> At we're now,on the air.\n>\n> ……\n>\n> But I eventually evaporates in a blackhole…\n>\n> Will I just stick up there?……", "description": "给定以下程序中的 $n$（即输入），求以下伪代码的输出结果。\n\n```\nInput n\nFor i := 1 to n\n\tis_not_prime[i] := 0\ncntp := 0\ncounter := 0\nFor i := 2 to n {\n\tIf is_not_prime[i] = 0 {\n\t\tcntp := cntp + 1\n\t\tprimes[cntp] := i\n\t}\n\tFor j := 1 to cntp {\n\t\tIf i * primes[j] > n\n\t\t\tbreak\n\t\tis_not_prime[i * primes[j]] := 1\n\t\tIf i Mod primes[j] > 0 // should be `If i Mod primes[j] = 0` in Sieve of Euler\n\t\t\tbreak\n\t\tcounter := counter + 1\n\t}\n}\nPrint cntp, counter\n```\n请注意此代码**不是线性筛**，差别在注释过的那一行。", "inputFormat": "一行一个整数，即输入，也就是给定的 $n$。", "outputFormat": "一行两个非负整数，即伪代码输出。", "hint": "**本题采用捆绑测试**，并且存在子任务依赖（只有你拿到了一个子任务前一个子任务的分，你才有可能拿到该子任务的分）。\n\n## 数据范围\n\n| $\\text{Subtask}$ | 约束条件 | 分值 |\n| :-----------: | :-----------: | :-----------: |\n| $1$ | $n\\leq 10^7$ |$10$|\n| $2$ | $n\\leq 10^9$ |$40$|\n| $3$ | $n\\leq 10^{18}$ |$50$|\n\n对于 $100\\%$ 的数据，满足 $1\\leq n\\leq 10^{18}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「CMOI R1」Bismuth / Linear Sieve", "background": "![](bilibili:BV1qF4m157gc)\n\n> Can you imagine find wakeless,like a satellite,in the black sky?\n>\n> Somewhere,like a star.\n>\n> We dream about things way beyond this atmosphere.\n>\n> At we're now,on the air.\n>\n> ……\n>\n> But I eventually evaporates in a blackhole…\n>\n> Will I just stick up there?……", "description": "给定以下程序中的 $n$（即输入），求以下伪代码的输出结果。\n\n```\nInput n\nFor i := 1 to n\n\tis_not_prime[i] := 0\ncntp := 0\ncounter := 0\nFor i := 2 to n {\n\tIf is_not_prime[i] = 0 {\n\t\tcntp := cntp + 1\n\t\tprimes[cntp] := i\n\t}\n\tFor j := 1 to cntp {\n\t\tIf i * primes[j] > n\n\t\t\tbreak\n\t\tis_not_prime[i * primes[j]] := 1\n\t\tIf i Mod primes[j] > 0 // should be `If i Mod primes[j] = 0` in Sieve of Euler\n\t\t\tbreak\n\t\tcounter := counter + 1\n\t}\n}\nPrint cntp, counter\n```\n请注意此代码**不是线性筛**，差别在注释过的那一行。", "inputFormat": "一行一个整数，即输入，也就是给定的 $n$。", "outputFormat": "一行两个非负整数，即伪代码输出。", "hint": "**本题采用捆绑测试**，并且存在子任务依赖（只有你拿到了一个子任务前一个子任务的分，你才有可能拿到该子任务的分）。\n\n## 数据范围\n\n| $\\text{Subtask}$ | 约束条件 | 分值 |\n| :-----------: | :-----------: | :-----------: |\n| $1$ | $n\\leq 10^7$ |$10$|\n| $2$ | $n\\leq 10^9$ |$40$|\n| $3$ | $n\\leq 10^{18}$ |$50$|\n\n对于 $100\\%$ 的数据，满足 $1\\leq n\\leq 10^{18}$。", "locale": "zh-CN"}}}
{"pid": "P11170", "type": "P", "difficulty": 5, "samples": [["3 3\n1 2 2\n2 3 3\n3 1 1", "Yes\n2 3 114514"], ["1 1\n1 1 1", "No"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "图论", "2024", "洛谷原创", "Special Judge", "O2优化", "构造", "Ad-hoc"], "title": "「CMOI R1」图上交互题 / Constructive Minimum Xor Path", "background": "2024 年 1 月 13 日 15:59:31，随着最后一发交互 J 题的提交出现了 Wrong Answer，小 G 的 EC-Final 比赛结束了，也意味着在 ICPC 生涯中第一次打铁。\n\n痛定思痛，小 G 决定批量生产交互题给自己做。如何批量生产交互题？只要在一个数据结构中有若干个未知量 $a_i$，每次询问给定向量 $x$，交互库会返回关于 $a_i$ 的函数 $f(x)$，这样就能批量生产交互题了！\n\n~~那为什么这题并不是交互题呢。~~", "description": "给定一个 $n$ 个点，$m$ 条边的**无向图**。第 $i$ 条边 $(u_i,v_i)$ 有一个**未知边权** $a_i$。\n\n对于任何一条**路径**，定义其**代价**如下：设路径为 $(p_0,p_1,...,p_k)$，其中要求 $(p_{i-1},p_i)$ 是无向图中的边，设其为第 $e_i$ 条边。那么路径的代价即为 $\\bigoplus\\limits_{i=1}^{k} a_{e_i}$。其中 $\\bigoplus$ 表示异或。（该路径可以经过重复点和重复边，即 $p$ 和 $e$ 可以包含重复的数）\n\n\n\n定义 $f(x,y)$ 为从 $x$ 到 $y$ 的所有路径中代价的**最小值**。特别地，当 $x=y$ 时，$f(x,y)=0$。\n\n给定 $n,m$，再对于每条边 $(u_i,v_i)$ 给定 $f(u_i,v_i)$，你需要求出是否存在一组合法的 $a_i$，如果有解，你还需要构造一组解。", "inputFormat": "第一行两个正整数 $n,m$。\n\n第 $2\\sim m+1$ 行每行两个正整数 $u_i,v_i$ 和一个非负整数 $f(u_i,v_i)$。\n\n**请注意：本题并不保证图连通；可能会存在重边和自环。**", "outputFormat": "如果不存在解，则仅输出 `No`。\n\n否则，在第一行输出 `Yes`，在第二行输出 $m$ 个非负整数 $a_i$ 表示一组合法的解。\n\n答案可能有很多组，此时输出任意一组解即可。你需要保证 输出的 $0\\le a_i<2^{63}$。", "hint": "### 样例解释\n\n答案输出的图如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/06683y6o.png)\n\n考虑 $f(1,2)$：\n\n+ 考虑路径 $1\\rightarrow 2$，路径的代价为 $2$。\n\n+ 考虑路径 $1\\rightarrow 2\\rightarrow 3\\rightarrow 1\\rightarrow 2$，路径的代价为 $2\\oplus3\\oplus114514\\oplus2=114513$。\n\n此外还存在其他路径，但可以证明不存在代价比 $2$ 更小的路径，故 $f(1,2)=2$。\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n|$\\text{Subtask}$ |特殊性质|分数|\n|-:|-:|-:|\n|$1$|保证有解|$20$|\n|$2$|$m\\le n+10$|$30$|\n|$3$||$50$|\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 5\\times 10^5$，$1\\le u_i,v_i\\le n$，$0\\le f(u_i,v_i)<2^{31}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「CMOI R1」图上交互题 / Constructive Minimum Xor Path", "background": "2024 年 1 月 13 日 15:59:31，随着最后一发交互 J 题的提交出现了 Wrong Answer，小 G 的 EC-Final 比赛结束了，也意味着在 ICPC 生涯中第一次打铁。\n\n痛定思痛，小 G 决定批量生产交互题给自己做。如何批量生产交互题？只要在一个数据结构中有若干个未知量 $a_i$，每次询问给定向量 $x$，交互库会返回关于 $a_i$ 的函数 $f(x)$，这样就能批量生产交互题了！\n\n~~那为什么这题并不是交互题呢。~~", "description": "给定一个 $n$ 个点，$m$ 条边的**无向图**。第 $i$ 条边 $(u_i,v_i)$ 有一个**未知边权** $a_i$。\n\n对于任何一条**路径**，定义其**代价**如下：设路径为 $(p_0,p_1,...,p_k)$，其中要求 $(p_{i-1},p_i)$ 是无向图中的边，设其为第 $e_i$ 条边。那么路径的代价即为 $\\bigoplus\\limits_{i=1}^{k} a_{e_i}$。其中 $\\bigoplus$ 表示异或。（该路径可以经过重复点和重复边，即 $p$ 和 $e$ 可以包含重复的数）\n\n\n\n定义 $f(x,y)$ 为从 $x$ 到 $y$ 的所有路径中代价的**最小值**。特别地，当 $x=y$ 时，$f(x,y)=0$。\n\n给定 $n,m$，再对于每条边 $(u_i,v_i)$ 给定 $f(u_i,v_i)$，你需要求出是否存在一组合法的 $a_i$，如果有解，你还需要构造一组解。", "inputFormat": "第一行两个正整数 $n,m$。\n\n第 $2\\sim m+1$ 行每行两个正整数 $u_i,v_i$ 和一个非负整数 $f(u_i,v_i)$。\n\n**请注意：本题并不保证图连通；可能会存在重边和自环。**", "outputFormat": "如果不存在解，则仅输出 `No`。\n\n否则，在第一行输出 `Yes`，在第二行输出 $m$ 个非负整数 $a_i$ 表示一组合法的解。\n\n答案可能有很多组，此时输出任意一组解即可。你需要保证 输出的 $0\\le a_i<2^{63}$。", "hint": "### 样例解释\n\n答案输出的图如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/06683y6o.png)\n\n考虑 $f(1,2)$：\n\n+ 考虑路径 $1\\rightarrow 2$，路径的代价为 $2$。\n\n+ 考虑路径 $1\\rightarrow 2\\rightarrow 3\\rightarrow 1\\rightarrow 2$，路径的代价为 $2\\oplus3\\oplus114514\\oplus2=114513$。\n\n此外还存在其他路径，但可以证明不存在代价比 $2$ 更小的路径，故 $f(1,2)=2$。\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n|$\\text{Subtask}$ |特殊性质|分数|\n|-:|-:|-:|\n|$1$|保证有解|$20$|\n|$2$|$m\\le n+10$|$30$|\n|$3$||$50$|\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 5\\times 10^5$，$1\\le u_i,v_i\\le n$，$0\\le f(u_i,v_i)<2^{31}$。", "locale": "zh-CN"}}}
{"pid": "P11171", "type": "P", "difficulty": 6, "samples": [["5\n120\n8128\n248\n0\n5", "7\n1 9 1 9 8 1 0\n13\n1 1 4 5 1 4 1 9 1 9 8 1 0\n8\n1 2 3 9 0 7 3 8\n7\n1 2 3 9 7 3 8\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "2024", "洛谷原创", "Special Judge", "O2优化", "深度优先搜索 DFS", "剪枝", "构造"], "title": "「CMOI R1」mex1", "background": "小 U 对于从一个集合映射到一个数的函数很感兴趣，而 $\\text{mex}$ 是一个很好的例子。\n\n$\\text{mex}(S)$ 指的是在集合 $S$ 中没有出现过的最小非负整数。", "description": "多组数据。\n\n每组数据，给定 $c$，要求构造序列 $a_1,a_2,...,a_n\\in [0,2\\times 10^9]$ 满足 \n\n$$\\sum\\limits_{S\\neq \\emptyset,S\\subseteq \\{1,2,...,n\\}}\\text{mex}(a_{S_1},a_{S_2},...,a_{S_{|S|}})=c$$\n\n\n其中要求 $1\\le n\\le40$。可以证明在该题的数据范围内如果存在解，则在 $1\\le n\\le 40$ 时一定存在解。", "inputFormat": "第一行一个整数，数据组数 $T$。\n\n之后 $T$ 行每行一个非负整数 $c$。", "outputFormat": "对于每组数据：\n\n如果无解，则仅输出一行一个整数 $-1$。\n\n否则，第一行输出一个正整数 $n$。\n\n第二行输出 $n$ 个非负整数 $a_1,a_2,...,a_n$。", "hint": "### 样例解释\n\n我有一个绝妙的解释，可惜这里写不下。\n\n### 数据范围\n\n$id$ 为 $\\text{subtask}$ 编号。\n\n|$id$|特殊性质|分数|$id$|特殊性质|分数|\n|-:|-:|-:|-:|-:|-:|\n|$1$|$c\\le10$|$3$|$6$|$c\\le1\\times 10^6$|$15$|\n|$2$|$c\\le30$|$6$|$7$|$T\\le 10$|$5$|\n|$3$|$c\\le500$|$6$|$8$|$T\\le 5\\times 10^4$|$15$|\n|$4$|$c\\le2\\times 10^3$|$5$|$9$|$T\\le 8\\times 10^4$|$10$|\n|$5$|$c\\le1\\times 10^5$|$20$|$10$||$15$|\n\n对于 $100\\%$ 的数据，$T\\le 10^5$，$0\\le c\\le 2\\times 10^9$。\n\n### 提示\n\n由于部分 STL 的常数较大，如果认为你的时间复杂度没有问题却 TLE，请不要使用 STL。\n\n请注意输出效率，这里提供一种快写模板（请不要用以下代码输出负数）：\n\n```cpp\nvoid write(int x){\n\tif(x>9)write(x/10);\n\tputchar(x%10+'0');\n}\n```", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「CMOI R1」mex1", "background": "小 U 对于从一个集合映射到一个数的函数很感兴趣，而 $\\text{mex}$ 是一个很好的例子。\n\n$\\text{mex}(S)$ 指的是在集合 $S$ 中没有出现过的最小非负整数。", "description": "多组数据。\n\n每组数据，给定 $c$，要求构造序列 $a_1,a_2,...,a_n\\in [0,2\\times 10^9]$ 满足 \n\n$$\\sum\\limits_{S\\neq \\emptyset,S\\subseteq \\{1,2,...,n\\}}\\text{mex}(a_{S_1},a_{S_2},...,a_{S_{|S|}})=c$$\n\n\n其中要求 $1\\le n\\le40$。可以证明在该题的数据范围内如果存在解，则在 $1\\le n\\le 40$ 时一定存在解。", "inputFormat": "第一行一个整数，数据组数 $T$。\n\n之后 $T$ 行每行一个非负整数 $c$。", "outputFormat": "对于每组数据：\n\n如果无解，则仅输出一行一个整数 $-1$。\n\n否则，第一行输出一个正整数 $n$。\n\n第二行输出 $n$ 个非负整数 $a_1,a_2,...,a_n$。", "hint": "### 样例解释\n\n我有一个绝妙的解释，可惜这里写不下。\n\n### 数据范围\n\n$id$ 为 $\\text{subtask}$ 编号。\n\n|$id$|特殊性质|分数|$id$|特殊性质|分数|\n|-:|-:|-:|-:|-:|-:|\n|$1$|$c\\le10$|$3$|$6$|$c\\le1\\times 10^6$|$15$|\n|$2$|$c\\le30$|$6$|$7$|$T\\le 10$|$5$|\n|$3$|$c\\le500$|$6$|$8$|$T\\le 5\\times 10^4$|$15$|\n|$4$|$c\\le2\\times 10^3$|$5$|$9$|$T\\le 8\\times 10^4$|$10$|\n|$5$|$c\\le1\\times 10^5$|$20$|$10$||$15$|\n\n对于 $100\\%$ 的数据，$T\\le 10^5$，$0\\le c\\le 2\\times 10^9$。\n\n### 提示\n\n由于部分 STL 的常数较大，如果认为你的时间复杂度没有问题却 TLE，请不要使用 STL。\n\n请注意输出效率，这里提供一种快写模板（请不要用以下代码输出负数）：\n\n```cpp\nvoid write(int x){\n\tif(x>9)write(x/10);\n\tputchar(x%10+'0');\n}\n```", "locale": "zh-CN"}}}
{"pid": "P11172", "type": "P", "difficulty": 6, "samples": [["4\n13\n25\n32\n0", "7\n1 9 1 9 8 1 0\n13\n1 1 4 5 1 4 1 9 1 9 8 1 0\n8\n1 2 3 9 0 7 3 8\n7\n1 2 3 9 7 3 8\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "2024", "洛谷原创", "Special Judge", "O2优化", "构造"], "title": "「CMOI R1」mex2", "background": "小 U 对于从一个集合映射到一个数的函数很感兴趣，而 $\\text{mex}$ 是一个很好的例子。\n\n$\\text{mex}(S)$ 指的是在集合 $S$ 中没有出现过的最小非负整数。", "description": "多组数据。\n\n每组数据，给定 $c$，要求构造序列 $a_1,a_2,...,a_n\\in [0,2\\times 10^9]$ 满足 \n\n$$\\sum\\limits_{1\\le l\\le r\\le n}\\text{mex}(a_l,a_{l+1},...,a_r)=c$$\n\n\n其中要求 $1\\le n\\le3000$。可以证明在该题的数据范围内如果存在解，则在 $1\\le n\\le 3000$ 时一定存在解。", "inputFormat": "第一行一个整数，数据组数 $T$。\n\n之后 $T$ 行每行一个非负整数 $c$。", "outputFormat": "对于每组数据：\n\n如果无解，则仅输出一行一个整数 $-1$。\n\n否则，第一行输出一个正整数 $n$。\n\n第二行输出 $n$ 个非负整数 $a_1,a_2,...,a_n$。", "hint": "### 样例解释\n\n对于样例 #1：只有 $\\text{mex}(a_7)=1$，且 $∀1\\le i\\le6$ 有 $\\text{mex}(a_i,a_{i+1},...,a_7)=2$，因而总和为 $13$。\n\n### 数据范围\n\n$id$ 为 $\\text{subtask}$ 编号。\n\n|$id$|特殊性质|分数|$id$|特殊性质|分数|\n|-:|-:|-:|-:|-:|-:|\n|$1$|$c\\le3\\times10^3$|$3$|$5$|$c\\le8\\times 10^6$|$10$|\n|$2$|$c\\le6\\times 10^3$|$7$|$6$|$c\\le1\\times 10^8$|$10$|\n|$3$|$c\\le8\\times10^4$|$10$|$7$|$c\\le1\\times 10^9$|$25$|\n|$4$|$c\\le4\\times 10^6$|$15$|$8$|$c\\le2\\times 10^9$|$20$|\n\n对于 $100\\%$ 的数据，$T\\le 310$，$0\\le c\\le 2\\times 10^9$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「CMOI R1」mex2", "background": "小 U 对于从一个集合映射到一个数的函数很感兴趣，而 $\\text{mex}$ 是一个很好的例子。\n\n$\\text{mex}(S)$ 指的是在集合 $S$ 中没有出现过的最小非负整数。", "description": "多组数据。\n\n每组数据，给定 $c$，要求构造序列 $a_1,a_2,...,a_n\\in [0,2\\times 10^9]$ 满足 \n\n$$\\sum\\limits_{1\\le l\\le r\\le n}\\text{mex}(a_l,a_{l+1},...,a_r)=c$$\n\n\n其中要求 $1\\le n\\le3000$。可以证明在该题的数据范围内如果存在解，则在 $1\\le n\\le 3000$ 时一定存在解。", "inputFormat": "第一行一个整数，数据组数 $T$。\n\n之后 $T$ 行每行一个非负整数 $c$。", "outputFormat": "对于每组数据：\n\n如果无解，则仅输出一行一个整数 $-1$。\n\n否则，第一行输出一个正整数 $n$。\n\n第二行输出 $n$ 个非负整数 $a_1,a_2,...,a_n$。", "hint": "### 样例解释\n\n对于样例 #1：只有 $\\text{mex}(a_7)=1$，且 $∀1\\le i\\le6$ 有 $\\text{mex}(a_i,a_{i+1},...,a_7)=2$，因而总和为 $13$。\n\n### 数据范围\n\n$id$ 为 $\\text{subtask}$ 编号。\n\n|$id$|特殊性质|分数|$id$|特殊性质|分数|\n|-:|-:|-:|-:|-:|-:|\n|$1$|$c\\le3\\times10^3$|$3$|$5$|$c\\le8\\times 10^6$|$10$|\n|$2$|$c\\le6\\times 10^3$|$7$|$6$|$c\\le1\\times 10^8$|$10$|\n|$3$|$c\\le8\\times10^4$|$10$|$7$|$c\\le1\\times 10^9$|$25$|\n|$4$|$c\\le4\\times 10^6$|$15$|$8$|$c\\le2\\times 10^9$|$20$|\n\n对于 $100\\%$ 的数据，$T\\le 310$，$0\\le c\\le 2\\times 10^9$。\n", "locale": "zh-CN"}}}
{"pid": "P11173", "type": "P", "difficulty": 6, "samples": [["2 2", "5"], ["3 4", "793"], ["5 10", "59350891"], ["18 15932416", "52138206"], ["1 1", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "数学", "2024", "洛谷原创", "O2优化", "动态规划优化", "图论建模", "线性代数"], "title": "「CMOI R1」We Want To Run / Nilpotent", "background": "![](bilibili:BV1qW4y1Q7Ce)\n\n$\\small\\color{white}54^{\\text{th}}\\text{Problem by ArCu}.$", "description": "对于 $n\\times n$ 矩阵 $A$，定义 $f(A)$ 为最小的满足 $A^b=O$ 的正整数 $b$，若不存在这样的数则 $f(A)=0$。其中 $O$ 是零矩阵，即所有元素都是 $0$ 的矩阵。\n\n给定 $n,a$，每个元素都是 $[0,a)$ 中整数的 $n\\times n$ 矩阵有 $a^{n^2}$ 种。对所有 $a^{n^2}$ 种可能的矩阵 $A$ 求 $f(A)$ 之和。\n\n答案对 $202407031$ 取模。", "inputFormat": "一行两个整数 $n,a(1\\leq n\\leq 600,0<a<2^{64})$。", "outputFormat": "一行一个整数，表示你求得的答案。", "hint": "$\\text{Sample 1 Explanation}:$\n\n注意到对于任意正整数 $b$，$\\begin{bmatrix}1&0\\\\1&1\\end{bmatrix}^b\\neq O$，所以 $f\\left(\\begin{bmatrix}1&0\\\\1&1\\end{bmatrix}\\right)=0$。而 $\\begin{bmatrix}0&0\\\\1&0\\end{bmatrix}^2=O$，所以 $f\\left(\\begin{bmatrix}0&0\\\\1&0\\end{bmatrix}\\right)=2$。\n\n一共有 $2^4=16$ 种可能的矩阵。其中 $f(A)$ 不为 $0$ 的只有\n\n$$f\\left(\\begin{bmatrix}0&0\\\\0&0\\end{bmatrix}\\right)=1,f\\left(\\begin{bmatrix}0&0\\\\1&0\\end{bmatrix}\\right)=f\\left(\\begin{bmatrix}0&1\\\\0&0\\end{bmatrix}\\right)=2$$\n\n答案即为 $1+2+2=5$。\n\n$\\text{Details of Subtasks}:$\n\n所有数据满足 $1\\leq n\\leq 600,0<a<2^{64}$。\n\n| $\\text{Subtask}$ | $\\text{Special Constraints}$ | $\\text{Score}$ |\n| :----------: | :----------: | :----------: | \n| $1$ | $n\\leq 5,a\\leq 2$ | $3$ |\n| $2$ | $n\\leq 5$ | $7$ | \n| $3$ | $n\\leq 10$ | $10$ | \n| $4$ | $n\\leq 40$ | $20$ | \n| $5$ | $n\\leq 200$ | $30$ |\n| $6$ |  | $30$ |\n\n$\\text{Hint}:202407031=13009\\times 15559.$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「CMOI R1」We Want To Run / Nilpotent", "background": "![](bilibili:BV1qW4y1Q7Ce)\n\n$\\small\\color{white}54^{\\text{th}}\\text{Problem by ArCu}.$", "description": "对于 $n\\times n$ 矩阵 $A$，定义 $f(A)$ 为最小的满足 $A^b=O$ 的正整数 $b$，若不存在这样的数则 $f(A)=0$。其中 $O$ 是零矩阵，即所有元素都是 $0$ 的矩阵。\n\n给定 $n,a$，每个元素都是 $[0,a)$ 中整数的 $n\\times n$ 矩阵有 $a^{n^2}$ 种。对所有 $a^{n^2}$ 种可能的矩阵 $A$ 求 $f(A)$ 之和。\n\n答案对 $202407031$ 取模。", "inputFormat": "一行两个整数 $n,a(1\\leq n\\leq 600,0<a<2^{64})$。", "outputFormat": "一行一个整数，表示你求得的答案。", "hint": "$\\text{Sample 1 Explanation}:$\n\n注意到对于任意正整数 $b$，$\\begin{bmatrix}1&0\\\\1&1\\end{bmatrix}^b\\neq O$，所以 $f\\left(\\begin{bmatrix}1&0\\\\1&1\\end{bmatrix}\\right)=0$。而 $\\begin{bmatrix}0&0\\\\1&0\\end{bmatrix}^2=O$，所以 $f\\left(\\begin{bmatrix}0&0\\\\1&0\\end{bmatrix}\\right)=2$。\n\n一共有 $2^4=16$ 种可能的矩阵。其中 $f(A)$ 不为 $0$ 的只有\n\n$$f\\left(\\begin{bmatrix}0&0\\\\0&0\\end{bmatrix}\\right)=1,f\\left(\\begin{bmatrix}0&0\\\\1&0\\end{bmatrix}\\right)=f\\left(\\begin{bmatrix}0&1\\\\0&0\\end{bmatrix}\\right)=2$$\n\n答案即为 $1+2+2=5$。\n\n$\\text{Details of Subtasks}:$\n\n所有数据满足 $1\\leq n\\leq 600,0<a<2^{64}$。\n\n| $\\text{Subtask}$ | $\\text{Special Constraints}$ | $\\text{Score}$ |\n| :----------: | :----------: | :----------: | \n| $1$ | $n\\leq 5,a\\leq 2$ | $3$ |\n| $2$ | $n\\leq 5$ | $7$ | \n| $3$ | $n\\leq 10$ | $10$ | \n| $4$ | $n\\leq 40$ | $20$ | \n| $5$ | $n\\leq 200$ | $30$ |\n| $6$ |  | $30$ |\n\n$\\text{Hint}:202407031=13009\\times 15559.$", "locale": "zh-CN"}}}
{"pid": "P11174", "type": "P", "difficulty": 7, "samples": [["3", "12"], ["4", "812"], ["5", "223440"], ["107", "404390093"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "2024", "O2优化", "组合数学", "容斥原理", "生成函数", "快速傅里叶变换 FFT", "快速数论变换 NTT", "拉格朗日反演", "洛谷比赛"], "title": "「CMOI R1」Looking For Edge Of Ground／City Planning", "background": "![](bilibili:BV1np4y19753)\n\n[如何对 $n$ 个点的简单有标号无向连通图计数？](https://www.luogu.com.cn/problem/P4841)$\\small\\color{white}/42^{\\text{nd}}\\text{Problem by ArCu}.$\n\n有一个显然错误的做法：枚举一棵树，然后在上面加边。\n\n你需要求每张图被统计的次数的平方和。", "description": "给定正整数 $n$。\n\n一开始，$\\text{ClBe}$ 会选定一棵 $n$ 个点的有标号无向无根树，将树上的边染成白色。然后他会在这棵树上加任意多条边，且满足：\n\n* 新加的边是黑色的无向边；\n* 加完边后的图忽略边的颜色后是一张简单图。\n\n接下来 $\\text{ClBe}$ 会将所有可能得到的结果放到一个集合 $S$ 中。\n\n显然这种统计连通图个数的方法会把一个图算很多遍，所以 $\\text{ClBe}$ 定义 $f(G)$：$S$ 中有 $f(G)$ 个图在忽略边的颜色后和 $G$ 相同（两个图 $A,B$ 相同指对于任意一条边 $(u,v)$，$(u,v)\\in A\\iff(u,v)\\in B$）。\n\n（$\\sum_G$ 代表对所有可能的图 $G$ 求和。）显然\n\n$$\\sum_{G}f(G)=n^{n-2}2^\\binom{n-1}2$$\n\n所以你需要求\n\n$$\\sum_{G}f(G)^2$$\n\n答案对 $998244353$ 取模。很可惜因为一些原因模数**不能**取 $1004535809$。", "inputFormat": "一行一个正整数 $n(0<n<2^{25})$。", "outputFormat": "一行一个整数，为你求得的答案。", "hint": "$\\text{Sample Explanation}:$\n\n集合 $S$ 中包含以下 $6$ 张图（边权为 $0$ 代表白边，为 $1$ 代表黑边，点的编号为 $1A$ 代表这是图 $A$ 的 $1$ 号点）：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/neuo34c3.png)\n\n$3$ 个点的连通图有 $4$ 种：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/q8kvdjgj.png)\n\n忽略颜色后，\n\n* 与 $G$ 相同的有 $B$；\n* 与 $H$ 相同的有 $A$；\n* 与 $I$ 相同的有 $C$；\n* 与 $J$ 相同的有 $D,E,F$；\n\n答案为 $f(G)^2+f(H)^2+f(I)^2+f(J)^2=1^2+1^2+1^2+3^2=12$。\n\n$\\text{Details of Subtasks}:$\n\n本题采用捆绑测试。\n\n| $\\text{Subtask}$ | $n<$ | $\\text{Score}$ |\n| :----------: | :----------: | :----------: | \n| $1$ | $10$ | $5$ |\n| $2$ | $500$ | $25$ |\n| $3$ | $1500$ | $30$ |\n| $4$ | $4500$ | $5$ |\n| $5$ | $2^{16}$ | $5$ |\n| $6$ | $2^{17}$ | $5$ |\n| $7$ | $2^{20}$ | $20$ |\n| $8$ | $2^{25}$ | $5$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「CMOI R1」Looking For Edge Of Ground／City Planning", "background": "![](bilibili:BV1np4y19753)\n\n[如何对 $n$ 个点的简单有标号无向连通图计数？](https://www.luogu.com.cn/problem/P4841)$\\small\\color{white}/42^{\\text{nd}}\\text{Problem by ArCu}.$\n\n有一个显然错误的做法：枚举一棵树，然后在上面加边。\n\n你需要求每张图被统计的次数的平方和。", "description": "给定正整数 $n$。\n\n一开始，$\\text{ClBe}$ 会选定一棵 $n$ 个点的有标号无向无根树，将树上的边染成白色。然后他会在这棵树上加任意多条边，且满足：\n\n* 新加的边是黑色的无向边；\n* 加完边后的图忽略边的颜色后是一张简单图。\n\n接下来 $\\text{ClBe}$ 会将所有可能得到的结果放到一个集合 $S$ 中。\n\n显然这种统计连通图个数的方法会把一个图算很多遍，所以 $\\text{ClBe}$ 定义 $f(G)$：$S$ 中有 $f(G)$ 个图在忽略边的颜色后和 $G$ 相同（两个图 $A,B$ 相同指对于任意一条边 $(u,v)$，$(u,v)\\in A\\iff(u,v)\\in B$）。\n\n（$\\sum_G$ 代表对所有可能的图 $G$ 求和。）显然\n\n$$\\sum_{G}f(G)=n^{n-2}2^\\binom{n-1}2$$\n\n所以你需要求\n\n$$\\sum_{G}f(G)^2$$\n\n答案对 $998244353$ 取模。很可惜因为一些原因模数**不能**取 $1004535809$。", "inputFormat": "一行一个正整数 $n(0<n<2^{25})$。", "outputFormat": "一行一个整数，为你求得的答案。", "hint": "$\\text{Sample Explanation}:$\n\n集合 $S$ 中包含以下 $6$ 张图（边权为 $0$ 代表白边，为 $1$ 代表黑边，点的编号为 $1A$ 代表这是图 $A$ 的 $1$ 号点）：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/neuo34c3.png)\n\n$3$ 个点的连通图有 $4$ 种：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/q8kvdjgj.png)\n\n忽略颜色后，\n\n* 与 $G$ 相同的有 $B$；\n* 与 $H$ 相同的有 $A$；\n* 与 $I$ 相同的有 $C$；\n* 与 $J$ 相同的有 $D,E,F$；\n\n答案为 $f(G)^2+f(H)^2+f(I)^2+f(J)^2=1^2+1^2+1^2+3^2=12$。\n\n$\\text{Details of Subtasks}:$\n\n本题采用捆绑测试。\n\n| $\\text{Subtask}$ | $n<$ | $\\text{Score}$ |\n| :----------: | :----------: | :----------: | \n| $1$ | $10$ | $5$ |\n| $2$ | $500$ | $25$ |\n| $3$ | $1500$ | $30$ |\n| $4$ | $4500$ | $5$ |\n| $5$ | $2^{16}$ | $5$ |\n| $6$ | $2^{17}$ | $5$ |\n| $7$ | $2^{20}$ | $20$ |\n| $8$ | $2^{25}$ | $5$ |", "locale": "zh-CN"}}}
{"pid": "P11175", "type": "P", "difficulty": 6, "samples": [["998244353 3\n9\n1\n11\n111\n1111\n11111\n111111\n1111111\n11111111\n111111111", "0\n258630203\n771331691\n346105458\n268271589\n571255383\n916731589\n304666893\n915484870"], ["1000000007 5\n13\n1\n5\n25\n125\n625\n3125\n15625\n78125\n390625\n1953125\n9765625\n48828125\n244140625", "0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "原根", "模板题"], "title": "【模板】基于值域预处理的快速离散对数", "background": "模板题，无背景。", "description": "给定质数 $P$ 以及它的一个原根 $g$。\n\n有 $q$ 组询问，每组询问给出整数 $y$，你需要找到最小的非负整数 $x$ 使得 $g^x\\equiv y\\pmod P$。", "inputFormat": "第一行两个整数 $P,g$，描述质数 $P$ 及其一个原根 $g$。\n\n第二行一个整数 $q$，表示询问次数。\n\n接下来 $q$ 行，每行一个整数 $y$，表示每次询问的值。", "outputFormat": "输出共 $q$ 行，每行一个整数表示答案。", "hint": "### 数据范围及约束\n\n- 对于前 $15\\%$ 的数据，满足 $1\\le g < P\\le 100$，$1\\le q\\le 100$；\n- 对于前 $30\\%$ 的数据，满足 $1\\le g < P\\le 10^9+7$，$1\\le q\\le 100$；\n- 另有 $15\\%$ 的数据，满足 $y_i=i$；\n- 另有 $15\\%$ 的数据，满足 $P=998244353$，$g=3$；\n- 对于全部数据，满足 $1\\le g,y_i<P\\le 10^9+7$，$1\\le q\\le 5\\times 10^5$。\n\n请注意读入效率对程序运行速度的影响。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】基于值域预处理的快速离散对数", "background": "模板题，无背景。", "description": "给定质数 $P$ 以及它的一个原根 $g$。\n\n有 $q$ 组询问，每组询问给出整数 $y$，你需要找到最小的非负整数 $x$ 使得 $g^x\\equiv y\\pmod P$。", "inputFormat": "第一行两个整数 $P,g$，描述质数 $P$ 及其一个原根 $g$。\n\n第二行一个整数 $q$，表示询问次数。\n\n接下来 $q$ 行，每行一个整数 $y$，表示每次询问的值。", "outputFormat": "输出共 $q$ 行，每行一个整数表示答案。", "hint": "### 数据范围及约束\n\n- 对于前 $15\\%$ 的数据，满足 $1\\le g < P\\le 100$，$1\\le q\\le 100$；\n- 对于前 $30\\%$ 的数据，满足 $1\\le g < P\\le 10^9+7$，$1\\le q\\le 100$；\n- 另有 $15\\%$ 的数据，满足 $y_i=i$；\n- 另有 $15\\%$ 的数据，满足 $P=998244353$，$g=3$；\n- 对于全部数据，满足 $1\\le g,y_i<P\\le 10^9+7$，$1\\le q\\le 5\\times 10^5$。\n\n请注意读入效率对程序运行速度的影响。", "locale": "zh-CN"}}}
{"pid": "P11176", "type": "P", "difficulty": 1, "samples": [["2\n0\n0", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "ROIR（俄罗斯）"], "title": "[ROIR 2018] 提高成绩 (Day1)", "background": "", "description": "**译自 ROI 2018 Regional. Day1 T1.** ***[Квадраты и кубы](http://neerc.ifmo.ru/school/archive/2017-2018/ru-olymp-regional-2018-day1.pdf)***\n\n在中学的计算机课上，学生的答案会被评为 $2$ 到 $5$ 分的整数分数。计算机课的最终成绩是所有课上分数的算术平均值，四舍五入到最接近的整数。如果平均值正好在两个整数之间，则向上取整。\n\n以下是分数四舍五入的示例：\n\n| 课上分数 | 算术平均值 | 最终成绩 |\n| :---: | :---: | :---: |\n| $2,3,5$ | $\\frac{2+3+5}{3}=3 \\frac{1}{3}$ | $3$ |\n| $3,3,4,4$ | $\\frac{3+3+4+4}{4}=3 \\frac{1}{2}$ | $4$ |\n| $5,5,5,3,5$ | $\\frac{5+5+5+3+5}{5}=4 \\frac{3}{5}$ | $5$ |\n\n所有中学的学生都希望计算机课的最终成绩不低于 $4$ 分。不幸的是，有一个学生在课上得了 $a$ 个 $2$ 分，$b$ 个 $3$ 分和 $c$ 个 $4$ 分。现在他计划获得一些 $5$ 分，以确保最终成绩不低于 $4$ 分。他需要知道，至少需要获得多少个 $5$ 分才能达到目标。\n\n需要编写一个程序，根据给定的非负整数 $a$、$b$ 和 $c$，确定学生至少需要获得多少个 $5$ 分，才能使他的计算机课最终成绩不低于 $4$ 分。", "inputFormat": "输入包含三行。第一行包含一个非负整数 $a$，第二行包含一个非负整数 $b$，第三行包含一个非负整数 $c$ $(0 \\leq a, b, c \\leq 10^{15}, a+b+c \\geq 1)$。", "outputFormat": "输出一个整数，表示学生至少需要获得的 $5$ 分的数量，以确保最终成绩不低于 $4$ 分。", "hint": "详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 分值 | 附加限制 |\n| :-: | :-: | :-: |\n| $1$ | $13$ | $1 \\leq a \\leq 100, b=0, c=0$（学生只得了 $2$ 分） |  \n| $2$ | $14$ | $a=0,1 \\leq b \\leq 100, c=0$（学生只得了 $3$ 分） |  \n| $3$ | $15$ | $0 \\leq a, b, c \\leq 100$ |\n| $4$ | $28$ | $0 \\leq a, b, c \\leq 10^{6}$ |\n| $5$ | $30$ | $0 \\leq a, b, c \\leq 10^{15}$ | ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[ROIR 2018] 提高成绩 (Day1)", "background": "", "description": "**译自 ROI 2018 Regional. Day1 T1.** ***[Квадраты и кубы](http://neerc.ifmo.ru/school/archive/2017-2018/ru-olymp-regional-2018-day1.pdf)***\n\n在中学的计算机课上，学生的答案会被评为 $2$ 到 $5$ 分的整数分数。计算机课的最终成绩是所有课上分数的算术平均值，四舍五入到最接近的整数。如果平均值正好在两个整数之间，则向上取整。\n\n以下是分数四舍五入的示例：\n\n| 课上分数 | 算术平均值 | 最终成绩 |\n| :---: | :---: | :---: |\n| $2,3,5$ | $\\frac{2+3+5}{3}=3 \\frac{1}{3}$ | $3$ |\n| $3,3,4,4$ | $\\frac{3+3+4+4}{4}=3 \\frac{1}{2}$ | $4$ |\n| $5,5,5,3,5$ | $\\frac{5+5+5+3+5}{5}=4 \\frac{3}{5}$ | $5$ |\n\n所有中学的学生都希望计算机课的最终成绩不低于 $4$ 分。不幸的是，有一个学生在课上得了 $a$ 个 $2$ 分，$b$ 个 $3$ 分和 $c$ 个 $4$ 分。现在他计划获得一些 $5$ 分，以确保最终成绩不低于 $4$ 分。他需要知道，至少需要获得多少个 $5$ 分才能达到目标。\n\n需要编写一个程序，根据给定的非负整数 $a$、$b$ 和 $c$，确定学生至少需要获得多少个 $5$ 分，才能使他的计算机课最终成绩不低于 $4$ 分。", "inputFormat": "输入包含三行。第一行包含一个非负整数 $a$，第二行包含一个非负整数 $b$，第三行包含一个非负整数 $c$ $(0 \\leq a, b, c \\leq 10^{15}, a+b+c \\geq 1)$。", "outputFormat": "输出一个整数，表示学生至少需要获得的 $5$ 分的数量，以确保最终成绩不低于 $4$ 分。", "hint": "详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 分值 | 附加限制 |\n| :-: | :-: | :-: |\n| $1$ | $13$ | $1 \\leq a \\leq 100, b=0, c=0$（学生只得了 $2$ 分） |  \n| $2$ | $14$ | $a=0,1 \\leq b \\leq 100, c=0$（学生只得了 $3$ 分） |  \n| $3$ | $15$ | $0 \\leq a, b, c \\leq 100$ |\n| $4$ | $28$ | $0 \\leq a, b, c \\leq 10^{6}$ |\n| $5$ | $30$ | $0 \\leq a, b, c \\leq 10^{15}$ | ", "locale": "zh-CN"}}}
{"pid": "P11177", "type": "P", "difficulty": 2, "samples": [["1\n30\n2", "3"]], "limits": {"time": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "ROIR（俄罗斯）"], "title": "[ROIR 2018] 平方与立方 (Day1)", "background": "", "description": "**译自 ROI 2018 Regional. Day1 T2.** ***[Квадраты и кубы](http://neerc.ifmo.ru/school/archive/2017-2018/ru-olymp-regional-2018-day1.pdf)***\n\n数学家们研究了「自然数的平方的分布」与「自然数的立方的分布」之间的关系。\n\n已知非负整数 $a,b,k$。考虑集合 $S=\\{a,a+1,\\ldots,b\\}$，该集合的「$k$ 密度」表示的是 $T$ 中元素的个数，其中 $T=\\{(x,y)|$ $x\\in\\mathbb{N},$ $y\\in\\mathbb{N},$ $x^2\\in S,$ $y^3\\in S,$ $|x^2 - y^3| ≤ k\\}$。请求出 $S$ 的 $k$ 密度。\n\n", "inputFormat": "输入包含三行，分别为 $a,b,k$。", "outputFormat": "输出一行，表示答案。", "hint": "### 样例解释\n- $x = 1, y = 1, |x^2 - y^3| = |1 - 1| = 0$;\n- $x = 3, y = 2, |x^2 - y^3| = |9 - 8| = 1$;\n- $x = 5, y = 3, |x^2 - y^3| = |25 - 27| = 2$.\n\n### 数据范围\n\n对于所有数据，$1 ≤ a ≤ b ≤ 10^{18},$ $0 ≤ k ≤ 10^{18}$.\n\n|子任务编号|分值|$1 ≤ a ≤ b ≤ $|$k$|\n|:-:|:-:|:-:|:-:|\n|1|10|$1000$|$k = 0$|\n|2|&nbsp;10&nbsp;|$10^{18}$|$k = 0$|\n|3|15|$1000$|$0 ≤ k ≤ 10$|\n|4|&nbsp;15&nbsp;|$10^6$|$0 ≤ k ≤ 10$|\n|5|15|$10^9$|$0 ≤ k ≤ 10$|\n|6|&nbsp;15&nbsp;|$10^9$|$0 ≤ k ≤ 10^9$|\n|7|20|$10^{18}$|$0 ≤ k ≤ 10^{18}$|", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[ROIR 2018] 平方与立方 (Day1)", "background": "", "description": "**译自 ROI 2018 Regional. Day1 T2.** ***[Квадраты и кубы](http://neerc.ifmo.ru/school/archive/2017-2018/ru-olymp-regional-2018-day1.pdf)***\n\n数学家们研究了「自然数的平方的分布」与「自然数的立方的分布」之间的关系。\n\n已知非负整数 $a,b,k$。考虑集合 $S=\\{a,a+1,\\ldots,b\\}$，该集合的「$k$ 密度」表示的是 $T$ 中元素的个数，其中 $T=\\{(x,y)|$ $x\\in\\mathbb{N},$ $y\\in\\mathbb{N},$ $x^2\\in S,$ $y^3\\in S,$ $|x^2 - y^3| ≤ k\\}$。请求出 $S$ 的 $k$ 密度。\n\n", "inputFormat": "输入包含三行，分别为 $a,b,k$。", "outputFormat": "输出一行，表示答案。", "hint": "### 样例解释\n- $x = 1, y = 1, |x^2 - y^3| = |1 - 1| = 0$;\n- $x = 3, y = 2, |x^2 - y^3| = |9 - 8| = 1$;\n- $x = 5, y = 3, |x^2 - y^3| = |25 - 27| = 2$.\n\n### 数据范围\n\n对于所有数据，$1 ≤ a ≤ b ≤ 10^{18},$ $0 ≤ k ≤ 10^{18}$.\n\n|子任务编号|分值|$1 ≤ a ≤ b ≤ $|$k$|\n|:-:|:-:|:-:|:-:|\n|1|10|$1000$|$k = 0$|\n|2|&nbsp;10&nbsp;|$10^{18}$|$k = 0$|\n|3|15|$1000$|$0 ≤ k ≤ 10$|\n|4|&nbsp;15&nbsp;|$10^6$|$0 ≤ k ≤ 10$|\n|5|15|$10^9$|$0 ≤ k ≤ 10$|\n|6|&nbsp;15&nbsp;|$10^9$|$0 ≤ k ≤ 10^9$|\n|7|20|$10^{18}$|$0 ≤ k ≤ 10^{18}$|", "locale": "zh-CN"}}}
{"pid": "P11178", "type": "P", "difficulty": 4, "samples": [["5 4\n2 3\n2 4\n5 2\n5 3\n9 3", "6\n12\n6\n12\n12"]], "limits": {"time": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["模拟", "2018", "ROIR（俄罗斯）"], "title": "[ROIR 2018] 电梯 (Day1)", "background": "", "description": "**译自 ROI 2018 Regional. Day1 T3.** ***[Лифт](http://neerc.ifmo.ru/school/archive/2017-2018/ru-olymp-regional-2018-day1.pdf)***\n\n某公司有一座大厦，大厦有 $m$ 层，自底向上依次称作 $1\\ldots m$ 楼（层）。\n\n有 $n$ 名雇员在大厦中工作，其编号分别为 $1\\ldots n$。每天下班时，所有雇员都需坐电梯下到一楼，并离开大厦。已知开始时 $i$ 号雇员位于 $a_i$ 层，该雇员在第 $t_i$ 秒到达该层的电梯口。\n\n每层都有可能有人在等电梯。当一名雇员到达电梯口时，如果这层已经有人摁电梯了，他会等电梯；如果这层没人摁电梯，则他会去摁电梯。摁电梯会给电梯主控发送一个请求信号。\n\n开始时电梯空闲，位于一楼。电梯每秒可以上升 / 下降一层。当第一次有人摁电梯时，电梯会响应该信号，到达对应楼层。如果电梯同时接受到多个信号，则它会响应编号较小的员工的请求信号。\n\n电梯上升至对应楼层时，所有在这层楼等电梯的人都会进入电梯，然后电梯以同样的速度下降，直到电梯到达一楼。对于电梯下降过程中会经过的楼层，如果电梯到达该楼层时该楼层有请求信号，则电梯会在该楼层停，所有在该楼层等电梯的人都会进入电梯。\n\n如果电梯空闲时有至少一个未响应的信号，则电梯会响应最早者。如果有多个最早者，则响应编号最小者。电梯会持续运作，直到 $n$ 名雇员全部到达一楼。\n\n雇员进出电梯的时间忽略不计。每一秒开始时，人们先摁电梯，然后进行对应的行为。（电梯上升 / 下降一层，人们进出电梯，电梯决定响应哪个信号）\n\n请求出每位雇员何时到达一楼。", "inputFormat": "- 第一行：$n,m$\n- 接下来 $n$ 行，每行两个整数，表示 $t_i,a_i$", "outputFormat": "$n$ 行，每行一个整数，表示答案。", "hint": "### 样例解释\n\n|时刻|1 楼| 2 楼| 3 楼| 4 楼|\n|-|-|-|-|-|\n|0|$\\tt []$|&nbsp;||&nbsp;|\n|1|$\\tt []$||&nbsp;||\n|2|$\\tt []↑3$|&nbsp;|$\\tt ☺\\:\\:1$|$\\tt ☺\\:\\:2$|\n|3||$\\tt []↑3$|$\\tt ☺\\:\\:1$|$\\tt ☺\\:\\:2$|\n|4|&nbsp;||$\\tt []←☺\\:\\:1$|$\\tt ☺\\:\\:2$|\n|5||$\\tt [☺\\:\\:1]←☺\\:\\:3$|$\\tt ☺\\:\\:4$|$\\tt ☺\\:\\:2$|\n|6|$\\tt [☺\\:\\:1→,☺\\:\\:3→]↑4$||$\\tt ☺\\:\\:4$|$\\tt ☺\\:\\:2$|\n|7||$\\tt []↑4$|$\\tt ☺\\:\\:4$|$\\tt ☺\\:\\:2$|\n|8|&nbsp;||$\\tt []↑4  ☺\\:\\:4$|$\\tt ☺\\:\\:2$|\n|9||&nbsp;|$\\tt ☺\\:\\:4,☺\\:\\:5$|$\\tt []←☺\\:\\:2$|\n|10|&nbsp;||$\\tt [☺\\:\\:2]←☺\\:\\:4,←☺\\:\\:5$||\n|11||$\\tt [☺\\:\\:2,☺\\:\\:4,☺\\:\\:5]$||&nbsp;|\n|12|$\\tt [☺\\:\\:2→,☺\\:\\:4→,☺\\:\\:5→]$||&nbsp;||\n\n---\n|符号|含义|符号|含义|\n|-|-|-|-|\n|$\\tt []↑3$|电梯将上到 3 楼|$\\tt []←☺\\:\\:1$|1 号雇员进入电梯|\n|$\\tt [☺\\:\\:1→,☺\\:\\:3→]$|1 号和 3 号雇员走出电梯|$\\tt [☺\\:\\:1→]↑4$|1 号雇员走出电梯后，电梯准备上到 4 楼|\n\n### 数据范围\n\n对于所有数据，$1 \\leqslant n \\leqslant 10^5,$ $2 \\leqslant m \\leqslant 10^9,$ $1 \\leqslant t_1 \\leqslant t_2 \\leqslant \\dots \\leqslant t_n \\leqslant 10^9, 2 \\leqslant a_i \\leqslant m$.\n\n|子任务 #|分值|$n$|$m$|$t_i$|\n|-|-|-|-|-|\n|1|15|$n = 1$|$2 \\leqslant m \\leqslant 100$|$1 \\leqslant t_i \\leqslant 100$|\n|2|30|$1 \\leqslant n \\leqslant 100$|$2 \\leqslant m \\leqslant 100$|$1 \\leqslant t_i \\leqslant 100$|\n|3|16|$1 \\leqslant n \\leqslant 100$&nbsp;|$2 \\leqslant m \\leqslant 10^9$|$1 \\leqslant t_i \\leqslant 10^9$|\n|4|12|$1 \\leqslant n \\leqslant 10^5$|$2 \\leqslant m \\leqslant 10^4$|$1 \\leqslant t_i \\leqslant 10^4$|\n|5|27|$1 \\leqslant n \\leqslant 10^5$&nbsp;|$2 \\leqslant m \\leqslant 10^9$|$1 \\leqslant t_i \\leqslant 10^9$|", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[ROIR 2018] 电梯 (Day1)", "background": "", "description": "**译自 ROI 2018 Regional. Day1 T3.** ***[Лифт](http://neerc.ifmo.ru/school/archive/2017-2018/ru-olymp-regional-2018-day1.pdf)***\n\n某公司有一座大厦，大厦有 $m$ 层，自底向上依次称作 $1\\ldots m$ 楼（层）。\n\n有 $n$ 名雇员在大厦中工作，其编号分别为 $1\\ldots n$。每天下班时，所有雇员都需坐电梯下到一楼，并离开大厦。已知开始时 $i$ 号雇员位于 $a_i$ 层，该雇员在第 $t_i$ 秒到达该层的电梯口。\n\n每层都有可能有人在等电梯。当一名雇员到达电梯口时，如果这层已经有人摁电梯了，他会等电梯；如果这层没人摁电梯，则他会去摁电梯。摁电梯会给电梯主控发送一个请求信号。\n\n开始时电梯空闲，位于一楼。电梯每秒可以上升 / 下降一层。当第一次有人摁电梯时，电梯会响应该信号，到达对应楼层。如果电梯同时接受到多个信号，则它会响应编号较小的员工的请求信号。\n\n电梯上升至对应楼层时，所有在这层楼等电梯的人都会进入电梯，然后电梯以同样的速度下降，直到电梯到达一楼。对于电梯下降过程中会经过的楼层，如果电梯到达该楼层时该楼层有请求信号，则电梯会在该楼层停，所有在该楼层等电梯的人都会进入电梯。\n\n如果电梯空闲时有至少一个未响应的信号，则电梯会响应最早者。如果有多个最早者，则响应编号最小者。电梯会持续运作，直到 $n$ 名雇员全部到达一楼。\n\n雇员进出电梯的时间忽略不计。每一秒开始时，人们先摁电梯，然后进行对应的行为。（电梯上升 / 下降一层，人们进出电梯，电梯决定响应哪个信号）\n\n请求出每位雇员何时到达一楼。", "inputFormat": "- 第一行：$n,m$\n- 接下来 $n$ 行，每行两个整数，表示 $t_i,a_i$", "outputFormat": "$n$ 行，每行一个整数，表示答案。", "hint": "### 样例解释\n\n|时刻|1 楼| 2 楼| 3 楼| 4 楼|\n|-|-|-|-|-|\n|0|$\\tt []$|&nbsp;||&nbsp;|\n|1|$\\tt []$||&nbsp;||\n|2|$\\tt []↑3$|&nbsp;|$\\tt ☺\\:\\:1$|$\\tt ☺\\:\\:2$|\n|3||$\\tt []↑3$|$\\tt ☺\\:\\:1$|$\\tt ☺\\:\\:2$|\n|4|&nbsp;||$\\tt []←☺\\:\\:1$|$\\tt ☺\\:\\:2$|\n|5||$\\tt [☺\\:\\:1]←☺\\:\\:3$|$\\tt ☺\\:\\:4$|$\\tt ☺\\:\\:2$|\n|6|$\\tt [☺\\:\\:1→,☺\\:\\:3→]↑4$||$\\tt ☺\\:\\:4$|$\\tt ☺\\:\\:2$|\n|7||$\\tt []↑4$|$\\tt ☺\\:\\:4$|$\\tt ☺\\:\\:2$|\n|8|&nbsp;||$\\tt []↑4  ☺\\:\\:4$|$\\tt ☺\\:\\:2$|\n|9||&nbsp;|$\\tt ☺\\:\\:4,☺\\:\\:5$|$\\tt []←☺\\:\\:2$|\n|10|&nbsp;||$\\tt [☺\\:\\:2]←☺\\:\\:4,←☺\\:\\:5$||\n|11||$\\tt [☺\\:\\:2,☺\\:\\:4,☺\\:\\:5]$||&nbsp;|\n|12|$\\tt [☺\\:\\:2→,☺\\:\\:4→,☺\\:\\:5→]$||&nbsp;||\n\n---\n|符号|含义|符号|含义|\n|-|-|-|-|\n|$\\tt []↑3$|电梯将上到 3 楼|$\\tt []←☺\\:\\:1$|1 号雇员进入电梯|\n|$\\tt [☺\\:\\:1→,☺\\:\\:3→]$|1 号和 3 号雇员走出电梯|$\\tt [☺\\:\\:1→]↑4$|1 号雇员走出电梯后，电梯准备上到 4 楼|\n\n### 数据范围\n\n对于所有数据，$1 \\leqslant n \\leqslant 10^5,$ $2 \\leqslant m \\leqslant 10^9,$ $1 \\leqslant t_1 \\leqslant t_2 \\leqslant \\dots \\leqslant t_n \\leqslant 10^9, 2 \\leqslant a_i \\leqslant m$.\n\n|子任务 #|分值|$n$|$m$|$t_i$|\n|-|-|-|-|-|\n|1|15|$n = 1$|$2 \\leqslant m \\leqslant 100$|$1 \\leqslant t_i \\leqslant 100$|\n|2|30|$1 \\leqslant n \\leqslant 100$|$2 \\leqslant m \\leqslant 100$|$1 \\leqslant t_i \\leqslant 100$|\n|3|16|$1 \\leqslant n \\leqslant 100$&nbsp;|$2 \\leqslant m \\leqslant 10^9$|$1 \\leqslant t_i \\leqslant 10^9$|\n|4|12|$1 \\leqslant n \\leqslant 10^5$|$2 \\leqslant m \\leqslant 10^4$|$1 \\leqslant t_i \\leqslant 10^4$|\n|5|27|$1 \\leqslant n \\leqslant 10^5$&nbsp;|$2 \\leqslant m \\leqslant 10^9$|$1 \\leqslant t_i \\leqslant 10^9$|", "locale": "zh-CN"}}}
{"pid": "P11179", "type": "P", "difficulty": 6, "samples": [["3 3 0\n1 a\n2 b\n3 a\n4 b\n2 a", "6"], ["7 3 1\n1 a\n2 a\n3 b\n3 b\n1 b\n6 b\n3 aab\n5 b\n2 ab", "15\n4\n1 4 1\n2 5 3\n1 6 2\n6 7 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "Special Judge", "ROIR（俄罗斯）"], "title": "[ROIR 2018] 管道监控 (Day1)", "background": "", "description": "**译自 ROI 2018 Regional. Day1 T4.** ***[Мониторинг труб](http://neerc.ifmo.ru/school/archive/2017-2018/ru-olymp-regional-2018-day1.pdf)***\n\n某输气系统包含 $n$ 个节点，编号分别为 $1\\ldots n$，某些节点间有单向管道连接。$1$ 号节点是中央储气设施。\n\n节点系统可用数列 $p_2,$ $p_3,$ $\\ldots,$ $p_n$ 来表示。对于 $i\\in[\\;\\!2,n\\;\\!],$ $p_i$ 号节点会有一条通向 $i$ 号节点的单向管道。已知中央储气设施可以将气体输送到系统中的所有节点。输气系统包含不同种类的管道，用英文小写字母 $\\texttt{a}\\sim\\texttt{z}$ 来表示。$p_i$ 号节点通向 $i$ 号节点的管道的类型为 $c_i$。\n\n有一种特殊的机器人被用来检查管道的质量。我们把「机器人从一个节点沿着一根管道前行到另一个节点，且机器人前进方向与气体方向一致」称作「一次移动」。\n\n机器人会先被放在一个节点中，然后它会进行一次或多次移动，最后被人从输气系统中取出。这被称为「机器人进行了一次执勤」。\n\n每次执勤时都需遵循 $m$ 种「规格」中的其中一种，这些规格的编号分别为 $1\\ldots m$。每种规格都用一个由英文小写字母组成的字符串 $st_k$ 来表示。如果在一次执勤中机器人遵循了 $k$ 号规范，则在这次执勤中，机器人移动的次数与 $\\mathrm{len}(st_k)$ 相等，并且对于 $j\\in[1,\\mathrm{len}(st_k)],$ $st_{k\\:\\!,\\;\\!j}$ 等于机器人第 $j$ 次经过的管道的类型。\n\n若某次执勤遵循了 $t$ 号规格，则这次的花费为 $w_t$。\n\n请问，要想让所有的管道都至少被检查一次，至少需要花费多少钱，并给出执勤路线的方案。\n", "inputFormat": "第一行：$n,m,t$，$t$ 的含义在【输出格式】中。\n\n接下来 $n-1$ 行：$p_i,$ $c_i$ 。\n\n接下来 $m$ 行：$w_i,$ $st_i$。", "outputFormat": "第一行包含一个整数，表示最小花费。若无解请输出 $-1$。\n\n若 $t=0$ 就不用管后续了，若 $t=1$ 且有解则需输出方案。 \n\n输出方案时，在第一行输出最小花费之后，第二行应包含方案中路径的数量 $k$，接下来 $k$ 行，每行包括三个整数 $a_i,$ $b_i,$ $c_i$，依次表示一条执勤路线的起点、终点，以及这次执勤所使用的规格。", "hint": "### 样例 2 解释\n\n![kxhEVg.png](https://s2.ax1x.com/2019/03/07/kxhEVg.png)\n\n### 数据范围\n\n对于所有数据，$1 ≤ n ≤ 500,$ $1 ≤ m ≤ 10^5,$ $t=0$ 或 $1,$ $1 ≤ p_i ≤ i-1,$ $1 ≤ w_i ≤ 10^9,$ $\\sum \\mathrm{len}(st_k) ≤ 10^6$.\n\n|子任务 #|分值|$n≤$|$m≤$|特殊条件|$t$|\n|:-:|:-:|:-:|:-:|:-:|:-:|\n|1|9|$500$| $10^5$|$\\mathrm{len}(st_i)=1$|$t = 0$|\n|2|10|$500$| $10^5$|$p_i=i-1$|$t = 0$|\n|3|22|$15$| $10^5$||$t = 0$||\n|4|20|$500$| $500$|&nbsp;|$t = 0$|\n|5|19|$500$| $10^5$||$t = 0$|\n|6|20|$500$| $10^5$|&nbsp;|$t = 1$|", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[ROIR 2018] 管道监控 (Day1)", "background": "", "description": "**译自 ROI 2018 Regional. Day1 T4.** ***[Мониторинг труб](http://neerc.ifmo.ru/school/archive/2017-2018/ru-olymp-regional-2018-day1.pdf)***\n\n某输气系统包含 $n$ 个节点，编号分别为 $1\\ldots n$，某些节点间有单向管道连接。$1$ 号节点是中央储气设施。\n\n节点系统可用数列 $p_2,$ $p_3,$ $\\ldots,$ $p_n$ 来表示。对于 $i\\in[\\;\\!2,n\\;\\!],$ $p_i$ 号节点会有一条通向 $i$ 号节点的单向管道。已知中央储气设施可以将气体输送到系统中的所有节点。输气系统包含不同种类的管道，用英文小写字母 $\\texttt{a}\\sim\\texttt{z}$ 来表示。$p_i$ 号节点通向 $i$ 号节点的管道的类型为 $c_i$。\n\n有一种特殊的机器人被用来检查管道的质量。我们把「机器人从一个节点沿着一根管道前行到另一个节点，且机器人前进方向与气体方向一致」称作「一次移动」。\n\n机器人会先被放在一个节点中，然后它会进行一次或多次移动，最后被人从输气系统中取出。这被称为「机器人进行了一次执勤」。\n\n每次执勤时都需遵循 $m$ 种「规格」中的其中一种，这些规格的编号分别为 $1\\ldots m$。每种规格都用一个由英文小写字母组成的字符串 $st_k$ 来表示。如果在一次执勤中机器人遵循了 $k$ 号规范，则在这次执勤中，机器人移动的次数与 $\\mathrm{len}(st_k)$ 相等，并且对于 $j\\in[1,\\mathrm{len}(st_k)],$ $st_{k\\:\\!,\\;\\!j}$ 等于机器人第 $j$ 次经过的管道的类型。\n\n若某次执勤遵循了 $t$ 号规格，则这次的花费为 $w_t$。\n\n请问，要想让所有的管道都至少被检查一次，至少需要花费多少钱，并给出执勤路线的方案。\n", "inputFormat": "第一行：$n,m,t$，$t$ 的含义在【输出格式】中。\n\n接下来 $n-1$ 行：$p_i,$ $c_i$ 。\n\n接下来 $m$ 行：$w_i,$ $st_i$。", "outputFormat": "第一行包含一个整数，表示最小花费。若无解请输出 $-1$。\n\n若 $t=0$ 就不用管后续了，若 $t=1$ 且有解则需输出方案。 \n\n输出方案时，在第一行输出最小花费之后，第二行应包含方案中路径的数量 $k$，接下来 $k$ 行，每行包括三个整数 $a_i,$ $b_i,$ $c_i$，依次表示一条执勤路线的起点、终点，以及这次执勤所使用的规格。", "hint": "### 样例 2 解释\n\n![kxhEVg.png](https://s2.ax1x.com/2019/03/07/kxhEVg.png)\n\n### 数据范围\n\n对于所有数据，$1 ≤ n ≤ 500,$ $1 ≤ m ≤ 10^5,$ $t=0$ 或 $1,$ $1 ≤ p_i ≤ i-1,$ $1 ≤ w_i ≤ 10^9,$ $\\sum \\mathrm{len}(st_k) ≤ 10^6$.\n\n|子任务 #|分值|$n≤$|$m≤$|特殊条件|$t$|\n|:-:|:-:|:-:|:-:|:-:|:-:|\n|1|9|$500$| $10^5$|$\\mathrm{len}(st_i)=1$|$t = 0$|\n|2|10|$500$| $10^5$|$p_i=i-1$|$t = 0$|\n|3|22|$15$| $10^5$||$t = 0$||\n|4|20|$500$| $500$|&nbsp;|$t = 0$|\n|5|19|$500$| $10^5$||$t = 0$|\n|6|20|$500$| $10^5$|&nbsp;|$t = 1$|", "locale": "zh-CN"}}}
{"pid": "P11180", "type": "P", "difficulty": 2, "samples": [["13\n2", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "ROIR（俄罗斯）"], "title": "[ROIR 2018] 删除数字 (Day2)", "background": "", "description": "**译自 ROI 2018 Regional. Day2 T1.** ***[Удаление чисел](http://neerc.ifmo.ru/school/archive/2017-2018/ru-olymp-regional-2018-day2.pdf)***\n\n给定一个从 $1$ 到 $n$ 的自然数序列和一个自然数 $k$。通过一个或多个操作删除序列中的数字。在每一个操作中，按升序查看剩余的数字，每隔 $k$ 个数字删除一个。如果在某一个操作之后剩余的数字少于 $k$ 个，则删除过程结束。\n\n需要确定在第几个操作删除数字 $n$，或者判断在删除过程结束前数字 $n$ 是否不会被删除。\n\n例如，设 $n=13, k=2$。\n\n- 第一个操作将删除数字 $2, 4, 6, 8, 10, 12$，剩下的数字是 $1, 3, 5, 7, 9, 11, 13$。\n- 第二个操作将删除数字 $3, 7, 11$，剩下的数字是 $1, 5, 9, 13$。\n- 第三个操作将删除数字 $5, 13$，剩下的数字是 $1, 9$。\n- 第四个操作将删除数字 $9$，剩下的数字是 $1$。由于只剩下一个数字，删除过程结束。\n\n因此，数字 $13$ 将在第三个操作被删除。\n\n需要编写一个程序，根据给定的 $n$ 和 $k$ 确定数字 $n$ 在第几个操作被删除。", "inputFormat": "第一行输入包含一个整数 $n$ $(3 \\leq n \\leq 10^{18})$。\n\n第二行输入包含一个整数 $k$ $(2 \\leq k \\leq 100, k < n)$。", "outputFormat": "输出一个整数，表示数字 $n$ 被删除的操作编号；如果数字 $n$ 不会被删除，则输出 $0$。", "hint": "详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 分值 | $n$ 的限制 | $k$ 的限制 |\n| :-: | :-: | :-: | :-: |\n| $1$ | $16$ | $3 \\leq n \\leq 1000$ | $k=2$ | \n| $2$ | $10$ | $3 \\leq n \\leq 10^{18}$ | $k=2$ |\n| $3$ | $14$ | $3 \\leq n \\leq 1000$ | $2 \\leq k \\leq 100, k < n$ |\n| $4$ | $20$ | $3 \\leq n \\leq 10^{6}$ | $2 \\leq k \\leq 100, k < n$ |\n| $5$ | $40$ | $3 \\leq n \\leq 10^{18}$ | $2 \\leq k \\leq 100, k < n$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[ROIR 2018] 删除数字 (Day2)", "background": "", "description": "**译自 ROI 2018 Regional. Day2 T1.** ***[Удаление чисел](http://neerc.ifmo.ru/school/archive/2017-2018/ru-olymp-regional-2018-day2.pdf)***\n\n给定一个从 $1$ 到 $n$ 的自然数序列和一个自然数 $k$。通过一个或多个操作删除序列中的数字。在每一个操作中，按升序查看剩余的数字，每隔 $k$ 个数字删除一个。如果在某一个操作之后剩余的数字少于 $k$ 个，则删除过程结束。\n\n需要确定在第几个操作删除数字 $n$，或者判断在删除过程结束前数字 $n$ 是否不会被删除。\n\n例如，设 $n=13, k=2$。\n\n- 第一个操作将删除数字 $2, 4, 6, 8, 10, 12$，剩下的数字是 $1, 3, 5, 7, 9, 11, 13$。\n- 第二个操作将删除数字 $3, 7, 11$，剩下的数字是 $1, 5, 9, 13$。\n- 第三个操作将删除数字 $5, 13$，剩下的数字是 $1, 9$。\n- 第四个操作将删除数字 $9$，剩下的数字是 $1$。由于只剩下一个数字，删除过程结束。\n\n因此，数字 $13$ 将在第三个操作被删除。\n\n需要编写一个程序，根据给定的 $n$ 和 $k$ 确定数字 $n$ 在第几个操作被删除。", "inputFormat": "第一行输入包含一个整数 $n$ $(3 \\leq n \\leq 10^{18})$。\n\n第二行输入包含一个整数 $k$ $(2 \\leq k \\leq 100, k < n)$。", "outputFormat": "输出一个整数，表示数字 $n$ 被删除的操作编号；如果数字 $n$ 不会被删除，则输出 $0$。", "hint": "详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 分值 | $n$ 的限制 | $k$ 的限制 |\n| :-: | :-: | :-: | :-: |\n| $1$ | $16$ | $3 \\leq n \\leq 1000$ | $k=2$ | \n| $2$ | $10$ | $3 \\leq n \\leq 10^{18}$ | $k=2$ |\n| $3$ | $14$ | $3 \\leq n \\leq 1000$ | $2 \\leq k \\leq 100, k < n$ |\n| $4$ | $20$ | $3 \\leq n \\leq 10^{6}$ | $2 \\leq k \\leq 100, k < n$ |\n| $5$ | $40$ | $3 \\leq n \\leq 10^{18}$ | $2 \\leq k \\leq 100, k < n$ |", "locale": "zh-CN"}}}
{"pid": "P11181", "type": "P", "difficulty": 3, "samples": [["1\n8", "3"]], "limits": {"time": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "ROIR（俄罗斯）"], "title": "[ROIR 2018] 书页 (Day2)", "background": "", "description": "**译自 ROI 2018 Regional. Day2 T2.** ***[Старая книга](http://neerc.ifmo.ru/school/archive/2017-2018/ru-olymp-regional-2018-day2.pdf)***\n\n一群年轻的考古学家正在发掘一座古图书馆。他们偶然发现了一本旧书的残片。经过研究，他们得出了以下结论。\n\n每一页上要么全是文本（称为文本页），要么全是插图（称为插图页）。已知前 $k$ 页全是插图页。这本书有页码，但只在文本页注明页码。已知注明的页码的总和为 $s$。\n\n很可惜，考古学家既无法确定这本书有多少页，也无法确定哪些页面是插图页。不过，考古学家想知道，这本书最少有几个插图页。", "inputFormat": "第一行一个整数 $k$，第二行一个整数 $s$。", "outputFormat": "输出一行，表示这本书最少有几个插图页。", "hint": "### 样例解释\n\n满足 $k=1,$ $s=8$ 的情况共有三种：\n- 图文图图图文（4 个插图页）\n- 图图文图文（3 个插图页）\n- 图图图图图图图文（7 个插图页）\n\n综上，至少会有 3 个插图页。\n\n### 数据范围\n\n|子任务编号|分值|$k$|$s$|\n|:-:|:-:|:-:|:-:|\n|1|15|$k = 0$|$1 ≤ s ≤ 200$|\n|2|20|$k = 0$|$1 ≤ s ≤ 10^{12}$|\n|3|30|$0 ≤ k ≤ 199$|$k + 1 ≤ s ≤ 200$|\n|4|35|$0 ≤ k ≤ 10^9$|$k + 1 ≤ s ≤ 10^{12}$|", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[ROIR 2018] 书页 (Day2)", "background": "", "description": "**译自 ROI 2018 Regional. Day2 T2.** ***[Старая книга](http://neerc.ifmo.ru/school/archive/2017-2018/ru-olymp-regional-2018-day2.pdf)***\n\n一群年轻的考古学家正在发掘一座古图书馆。他们偶然发现了一本旧书的残片。经过研究，他们得出了以下结论。\n\n每一页上要么全是文本（称为文本页），要么全是插图（称为插图页）。已知前 $k$ 页全是插图页。这本书有页码，但只在文本页注明页码。已知注明的页码的总和为 $s$。\n\n很可惜，考古学家既无法确定这本书有多少页，也无法确定哪些页面是插图页。不过，考古学家想知道，这本书最少有几个插图页。", "inputFormat": "第一行一个整数 $k$，第二行一个整数 $s$。", "outputFormat": "输出一行，表示这本书最少有几个插图页。", "hint": "### 样例解释\n\n满足 $k=1,$ $s=8$ 的情况共有三种：\n- 图文图图图文（4 个插图页）\n- 图图文图文（3 个插图页）\n- 图图图图图图图文（7 个插图页）\n\n综上，至少会有 3 个插图页。\n\n### 数据范围\n\n|子任务编号|分值|$k$|$s$|\n|:-:|:-:|:-:|:-:|\n|1|15|$k = 0$|$1 ≤ s ≤ 200$|\n|2|20|$k = 0$|$1 ≤ s ≤ 10^{12}$|\n|3|30|$0 ≤ k ≤ 199$|$k + 1 ≤ s ≤ 200$|\n|4|35|$0 ≤ k ≤ 10^9$|$k + 1 ≤ s ≤ 10^{12}$|", "locale": "zh-CN"}}}
{"pid": "P11182", "type": "P", "difficulty": 3, "samples": [["4 2\n1 1 2", "10"]], "limits": {"time": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "ROIR（俄罗斯）"], "title": "[ROIR 2018] 分形 (Day2)", "background": "", "description": "**译自 ROI 2018 Regional. Day2 T3.** ***[Красота фейерверка](http://neerc.ifmo.ru/school/archive/2017-2018/ru-olymp-regional-2018-day2.pdf)***\n\n已知一棵包含 $n$ 个元素的有根树 $T^1$。定义 $T^m$ 为一棵树，生成方式是在 $T^{m-1}$ 的每个叶结点下面连一棵 $T^1$ 而得。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/s596ep9z.png)\n\n试求 $T^m$ 的直径的长度（这里的长度指的是直径上的点数）。", "inputFormat": "第一行 $n,m$。  \n第二行 $p_2\\ldots p_n,\\ \\ $ $p_i$ 表示结点 $p_i$ 与结点 $i$ 有边连接。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "### 样例解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g4tsci1c.png)\n\n### 数据范围\n\n$3≤n≤2\\times 10^5,$ $1≤m≤2\\times 10^5,$ $1\\le p_i\\le i-1.$\n\n|子任务编号|分值|$n$|$m$|\n|:-:|:-:|:-:|:-:|\n|1|19|$3 ≤ n ≤ 5000$|$m = 1$|\n|2|10| |$m=1$|\n|3|20|$3 ≤ n ≤ 5000$|$1 ≤ m ≤ 5000$|\n|4|19|$3 ≤ n≤ 5000$||\n|5|32||&nbsp;|\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[ROIR 2018] 分形 (Day2)", "background": "", "description": "**译自 ROI 2018 Regional. Day2 T3.** ***[Красота фейерверка](http://neerc.ifmo.ru/school/archive/2017-2018/ru-olymp-regional-2018-day2.pdf)***\n\n已知一棵包含 $n$ 个元素的有根树 $T^1$。定义 $T^m$ 为一棵树，生成方式是在 $T^{m-1}$ 的每个叶结点下面连一棵 $T^1$ 而得。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/s596ep9z.png)\n\n试求 $T^m$ 的直径的长度（这里的长度指的是直径上的点数）。", "inputFormat": "第一行 $n,m$。  \n第二行 $p_2\\ldots p_n,\\ \\ $ $p_i$ 表示结点 $p_i$ 与结点 $i$ 有边连接。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "### 样例解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g4tsci1c.png)\n\n### 数据范围\n\n$3≤n≤2\\times 10^5,$ $1≤m≤2\\times 10^5,$ $1\\le p_i\\le i-1.$\n\n|子任务编号|分值|$n$|$m$|\n|:-:|:-:|:-:|:-:|\n|1|19|$3 ≤ n ≤ 5000$|$m = 1$|\n|2|10| |$m=1$|\n|3|20|$3 ≤ n ≤ 5000$|$1 ≤ m ≤ 5000$|\n|4|19|$3 ≤ n≤ 5000$||\n|5|32||&nbsp;|\n", "locale": "zh-CN"}}}
