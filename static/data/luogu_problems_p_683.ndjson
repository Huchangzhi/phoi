{"pid": "P14846", "type": "P", "difficulty": 5, "samples": [["ICPC", "2"], ["CCCIIIPPP", "69"], ["PICCICCIPPI", "24"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["动态规划 DP", "树状数组", "2022", "ICPC", "横浜"], "title": "[ICPC 2022 Yokohama R] Incredibly Cute Penguin Chicks", "background": "", "description": "The **Incredibly Cute Penguin Chicks** love to eat worms. One day, their mother found a long string-shaped worm with a number of letters on it. She decided to cut this worm into pieces and feed the chicks.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/lalf3ckw.png)\n:::\n\nThe chicks somehow love *International Collegiate Programming Contest* and want to eat pieces with **ICPC-ish** character strings on them. Here, a string is **ICPC-ish** if the following conditions hold.\n\n- It consists of only C’s, I’s, and P’s.\n- Two of these three characters appear the same number of times (possibly zero times) in the string and the remaining character appears strictly more times.\n\nFor example, ICPC and PPPPPP are ICPC-ish, but PIC, PIPCCC and PIPE are not.\n\nYou are given the string on the worm the mother found. The mother wants to provide one or more parts of the worm all with an ICPC-ish string, without wasting remains. Your task is to count the number of ways the worm can be prepared in such a manner.", "inputFormat": "The input is a single line containing a character string $S$ consisting of only C’s, I’s, and P’s, which is on the string-shaped worm the mother penguin found. The length of $S$ is between $1$ and $10^6$, inclusive.\n", "outputFormat": "Print in a line the number of ways to represent the string $S$ as a concatenation of one or more ICPC-ish strings modulo a prime number $998244353 = 2^{23} \\times 7 \\times 17 + 1$.", "hint": "In the first sample, the string “ICPC” can be represented in the following two ways.\n\n- A single ICPC-ish string, “ICPC”.\n- Concatenation of four ICPC-ish strings, “I”, “C”, “P”, and “C”.", "locale": "en", "translations": {"en": {"title": "[ICPC 2022 Yokohama R] Incredibly Cute Penguin Chicks", "background": "", "description": "The **Incredibly Cute Penguin Chicks** love to eat worms. One day, their mother found a long string-shaped worm with a number of letters on it. She decided to cut this worm into pieces and feed the chicks.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/lalf3ckw.png)\n:::\n\nThe chicks somehow love *International Collegiate Programming Contest* and want to eat pieces with **ICPC-ish** character strings on them. Here, a string is **ICPC-ish** if the following conditions hold.\n\n- It consists of only C’s, I’s, and P’s.\n- Two of these three characters appear the same number of times (possibly zero times) in the string and the remaining character appears strictly more times.\n\nFor example, ICPC and PPPPPP are ICPC-ish, but PIC, PIPCCC and PIPE are not.\n\nYou are given the string on the worm the mother found. The mother wants to provide one or more parts of the worm all with an ICPC-ish string, without wasting remains. Your task is to count the number of ways the worm can be prepared in such a manner.", "inputFormat": "The input is a single line containing a character string $S$ consisting of only C’s, I’s, and P’s, which is on the string-shaped worm the mother penguin found. The length of $S$ is between $1$ and $10^6$, inclusive.\n", "outputFormat": "Print in a line the number of ways to represent the string $S$ as a concatenation of one or more ICPC-ish strings modulo a prime number $998244353 = 2^{23} \\times 7 \\times 17 + 1$.", "hint": "In the first sample, the string “ICPC” can be represented in the following two ways.\n\n- A single ICPC-ish string, “ICPC”.\n- Concatenation of four ICPC-ish strings, “I”, “C”, “P”, and “C”.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2022 Yokohama R] Incredibly Cute Penguin Chicks", "background": "", "description": "**极其可爱的企鹅宝宝们** 喜欢吃蠕虫。一天，它们的妈妈发现了一条长条状的蠕虫，上面有一些字母。她决定将这条蠕虫切成几段喂给宝宝们。\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/lalf3ckw.png)\n:::\n\n企鹅宝宝们不知为何喜欢 **国际大学生程序设计竞赛**，并希望吃到带有 **ICPC-ish** 字符串的片段。这里，一个字符串是 **ICPC-ish** 的，如果满足以下条件：\n\n- 它仅由字母 C、I 和 P 组成。\n- 这三个字符中有两个在字符串中出现的次数相同（可能为零次），而剩余的字符出现次数严格更多。\n\n例如，ICPC 和 PPPPPP 是 ICPC-ish 的，但 PIC、PIPCCC 和 PIPE 不是。\n\n你被给予企鹅妈妈发现的蠕虫上的字符串。妈妈希望提供蠕虫的一个或多个部分，每部分都带有 ICPC-ish 字符串，且不浪费剩余部分。你的任务是计算可以以这种方式准备蠕虫的方法数量。", "inputFormat": "输入是一行，包含一个仅由字母 C、I 和 P 组成的字符串 $S$，即企鹅妈妈发现的长条状蠕虫上的字符串。$S$ 的长度在 $1$ 到 $10^6$ 之间（含）。", "outputFormat": "在一行中输出将字符串 $S$ 表示为一个或多个 ICPC-ish 字符串连接的方法数量，结果对质数 $998244353 = 2^{23} \\times 7 \\times 17 + 1$ 取模。", "hint": "在第一个样例中，字符串 \"ICPC\" 可以用以下两种方式表示：\n\n- 一个单独的 ICPC-ish 字符串：\"ICPC\"。\n- 四个 ICPC-ish 字符串的连接：\"I\"、\"C\"、\"P\"、\"C\"。", "locale": "zh-CN"}}}
{"pid": "P14847", "type": "P", "difficulty": 6, "samples": [["4\n1 1 1 1", "Yes"], ["6\n1 3 1 3 1 3", "Yes"], ["6\n2 2 1 1 1 1", "No"], ["8\n99 98 15 10 10 5 2 1", "Yes"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["动态规划 DP", "2022", "ICPC", "横浜"], "title": "[ICPC 2022 Yokohama R] Make a Loop", "background": "", "description": "Taro is playing with a set of toy rail tracks. All of the tracks are arc-shaped with a right central angle (an angle of $90$ degrees), but with many different radii. He is trying to construct a single **loop** using all of them. Here, a set of tracks is said to form a single loop when both ends of all the tracks are smoothly joined to some other track, and all the tracks are connected to all the other tracks directly or indirectly. Please tell Taro whether he can ever achieve that or not.\n\nTracks may be joined in an arbitrary order, but their directions are restricted by the directions of adjacent tracks, as they must be joined smoothly. For example, if you place a track so that a train enters eastward and turns $90$ degrees northward, you must place the next track so that the train enters northward and turns $90$ degrees to either east or west (Figure F.1). Tracks may cross or even overlap each other as elevated construction is possible.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/m5lfnz0z.png)\n\nFigure F.1. Example of smoothly joining tracks\n:::", "inputFormat": "The input consists of a single test case in the following format.\n\n$$\nn\n$$\n$$\nr_1 \\cdots r_n\n$$\n\n$n$ represents the number of tracks, which is an even integer satisfying $4 \\leq n \\leq 100$. Each $r_i$ represents the radius of the $i$-th track, which is an integer satisfying $1 \\leq r_i \\leq 10000$.\n", "outputFormat": "If it is possible to construct a single loop using all of the tracks, print **Yes**; otherwise, print **No**.", "hint": "Possible loops for the sample inputs 1, 2, and 4 are depicted in the following figures.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/u5mxti8n.png)\nFigure F.2. Possible loops for the sample inputs\n:::", "locale": "en", "translations": {"en": {"title": "[ICPC 2022 Yokohama R] Make a Loop", "background": "", "description": "Taro is playing with a set of toy rail tracks. All of the tracks are arc-shaped with a right central angle (an angle of $90$ degrees), but with many different radii. He is trying to construct a single **loop** using all of them. Here, a set of tracks is said to form a single loop when both ends of all the tracks are smoothly joined to some other track, and all the tracks are connected to all the other tracks directly or indirectly. Please tell Taro whether he can ever achieve that or not.\n\nTracks may be joined in an arbitrary order, but their directions are restricted by the directions of adjacent tracks, as they must be joined smoothly. For example, if you place a track so that a train enters eastward and turns $90$ degrees northward, you must place the next track so that the train enters northward and turns $90$ degrees to either east or west (Figure F.1). Tracks may cross or even overlap each other as elevated construction is possible.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/m5lfnz0z.png)\n\nFigure F.1. Example of smoothly joining tracks\n:::", "inputFormat": "The input consists of a single test case in the following format.\n\n$$\nn\n$$\n$$\nr_1 \\cdots r_n\n$$\n\n$n$ represents the number of tracks, which is an even integer satisfying $4 \\leq n \\leq 100$. Each $r_i$ represents the radius of the $i$-th track, which is an integer satisfying $1 \\leq r_i \\leq 10000$.\n", "outputFormat": "If it is possible to construct a single loop using all of the tracks, print **Yes**; otherwise, print **No**.", "hint": "Possible loops for the sample inputs 1, 2, and 4 are depicted in the following figures.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/u5mxti8n.png)\nFigure F.2. Possible loops for the sample inputs\n:::", "locale": "en"}, "zh-CN": {"title": "[ICPC 2022 Yokohama R] Make a Loop", "background": "", "description": "Taro 正在玩一套玩具铁轨。所有轨道都是圆弧形的，中心角为直角（$90$ 度），但半径各不相同。他试图用它们构建一个单一的 **环**。这里，当所有轨道的两端都与其他轨道平滑连接，并且所有轨道直接或间接地连接到其他所有轨道时，我们说这套轨道形成一个单一的环。请告诉 Taro 他是否能够实现这个目标。\n\n轨道可以按任意顺序连接，但它们的朝向受相邻轨道朝向的限制，因为它们必须平滑连接。例如，如果你放置一条轨道，使得火车向东进入并转向 $90$ 度向北，那么你必须放置下一条轨道，使得火车向北进入并转向 $90$ 度向东或向西（图 F.1）。轨道可以交叉甚至重叠，因为可以建造高架结构。\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/m5lfnz0z.png)\n\n图 F.1. 轨道平滑连接的例子\n:::", "inputFormat": "输入由单个测试用例组成，格式如下。\n\n$$\nn\n$$\n$$\nr_1 \\cdots r_n\n$$\n\n$n$ 表示轨道的数量，它是一个满足 $4 \\leq n \\leq 100$ 的偶数。每个 $r_i$ 表示第 $i$ 条轨道的半径，是一个满足 $1 \\leq r_i \\leq 10000$ 的整数。", "outputFormat": "如果可以使用所有轨道构建一个单一的环，则输出 **Yes**；否则输出 **No**。", "hint": "样例输入 1、2 和 4 的可能环如下图所示。\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/u5mxti8n.png)\n图 F.2. 样例输入的可能环\n:::", "locale": "zh-CN"}}}
{"pid": "P14848", "type": "P", "difficulty": 4, "samples": [["2 3\n+-+-+-+\n|.....|\n+.+.+.+\n|.|.|.|\n+-+-+-+", "6"], ["2 3\n+-+-+-+\n|...|.|\n+.+.+.+\n|.|...|\n+-+-+-+", "4"], ["5 5\n+-+-+-+-+-+\n|...|...|.|\n+-+.+.+.+.+\n|...|.|.|.|\n+.+.+.+-+.+\n|.|...|.|.|\n+.+.+-+.+.+\n|.|.....|.|\n+-+.+.+-+.+\n|...|.....|\n+-+-+-+-+-+", "15"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["搜索", "2022", "广度优先搜索 BFS", "ICPC", "横浜"], "title": "[ICPC 2022 Yokohama R] Remodeling the Dungeon", "background": "", "description": "The Queen of Icpca resides in a castle peacefully. One day, she heard that many secret agents had been active in other nations, and got worried about the security of the castle.\n\nThe castle has a rectangular dungeon consisting of $h$ rows of $w$ square rooms. Adjacent rooms are separated by a wall. Some walls have doorways making the separated rooms intercommunicate. The entrance and the exit of the dungeon are in the rooms located at two diagonal extreme corners. The dungeon rooms form a **tree**, that is, the exit room is reachable from every room in the dungeon through a unique route that passes all the rooms on the route only once.\n\nIn order to enhance the security of the castle, the Queen wants to remodel the dungeon so that the number of rooms on the route from the entrance room to the exit room is maximized. She likes the tree property of the current dungeon, so it must be preserved. Due to the cost limitation, what can be done in the remodeling is to block one doorway to make it unavailable and to construct one new doorway instead on a wall (possibly on the same wall).\n\nYour mission is to find a way to remodel the dungeon as the Queen wants.", "inputFormat": "The input consists of a single test case in the following format.\n\n$$\nh \\ w\n$$\n$$\nc_{1,1} c_{1,2} \\cdots c_{1,2w+1}\n$$\n$$\nc_{2,1} c_{2,2} \\cdots c_{2,2w+1}\n$$\n$$\n\\vdots\n$$\n$$\nc_{2h+1,1} c_{2h+1,2} \\cdots c_{2h+1,2w+1}\n$$\n\n$h$ and $w$ represent the size of the dungeon, each of which is an integer between $2$ and $500$, inclusive. The characters $c_{i,j}$ ($1 \\leq i \\leq 2h+1$, $1 \\leq j \\leq 2w+1$) represent the configuration of the dungeon as follows:\n\n- $c_{2i,2j} = \\text{'}.\\text{'}$ for $1 \\leq i \\leq h$ and $1 \\leq j \\leq w$, which corresponds to the room $i$-th from the north end and $j$-th from the west end of the dungeon; such a room is called the room $(i,j)$.\n- $c_{2i+1,2j} = \\text{'}.\\text{'}$ or $\\text{'}-\\text{'}$ for $1 \\leq i \\leq h-1$ and $1 \\leq j \\leq w$, which represents the wall between the rooms $(i,j)$ and $(i+1,j)$; the character $\\text{'}.\\text{'}$ means that the wall has a doorway and $\\text{'}-\\text{'}$ means it has no doorway.\n- $c_{2i,2j+1} = \\text{'}.\\text{'}$ or $\\text{'}|\\text{'}$ for $1 \\leq i \\leq h$ and $1 \\leq j \\leq w-1$, which represents the wall between the rooms $(i,j)$ and $(i,j+1)$; the character $\\text{'}.\\text{'}$ means that the wall has a doorway and $\\text{'}|\\text{'}$ means it has no doorway.\n- $c_{1,2j} = c_{2h+1,2j} = \\text{'}-\\text{'}$ ($1 \\leq j \\leq w$) and $c_{2i,1} = c_{2i,2w+1} = \\text{'}|\\text{'}$ ($1 \\leq i \\leq h$), which correspond to the outer walls of the dungeon.\n- $c_{2i+1,2j+1} = \\text{'}+\\text{'}$ for $0 \\leq i \\leq h$ and $0 \\leq j \\leq w$, which corresponds to an intersection of walls or outer walls.\n\nThe entrance and the exit of the dungeon are in the rooms $(1,1)$ and $(h,w)$, respectively. The configuration satisfies the tree property stated above.", "outputFormat": "Output the maximum length of the route from the entrance room to the exit room achievable by the remodeling, where the length of a route is the number of rooms passed including both the entrance and exit rooms.", "hint": "In the first sample, if you block the doorway between the rooms $(1,1)$ and $(1,2)$ and construct a new doorway between the rooms $(2,1)$ and $(2,2)$, then the unique route from $(1,1)$ to $(2,3)$ passes all of the 6 rooms, which is obviously the maximum.\n\nIn the second sample, any remodeling keeps the length of the unique route from $(1,1)$ to $(2,3)$ to be exactly 4.\n\nIn the third sample, one of the optimal ways is blocking the doorway between the rooms $(4,2)$ and $(4,3)$ and constructing a new doorway between the rooms $(2,4)$ and $(3,4)$.\n\nThe configurations after the remodeling described above are as follows.\n\n```\n+-+-+-+ +-+-+-+ +-+-+-+-+-+\n|.|...| |...|.| |...|...|.|\n+.+.+.+ +.+.+.+ +-+.+.+.+.+\n|...|.| |.|...| |...|.|.|.|\n+-+-+-+ +-+-+-+ +.+.+.+.+.+\n                |.|...|.|.|\n                +.+.+-+.+.+\n                |.|.|...|.|\n                +-+.+.+-+.+\n                |...|.....|\n                +-+-+-+-+-+\n```", "locale": "en", "translations": {"en": {"title": "[ICPC 2022 Yokohama R] Remodeling the Dungeon", "background": "", "description": "The Queen of Icpca resides in a castle peacefully. One day, she heard that many secret agents had been active in other nations, and got worried about the security of the castle.\n\nThe castle has a rectangular dungeon consisting of $h$ rows of $w$ square rooms. Adjacent rooms are separated by a wall. Some walls have doorways making the separated rooms intercommunicate. The entrance and the exit of the dungeon are in the rooms located at two diagonal extreme corners. The dungeon rooms form a **tree**, that is, the exit room is reachable from every room in the dungeon through a unique route that passes all the rooms on the route only once.\n\nIn order to enhance the security of the castle, the Queen wants to remodel the dungeon so that the number of rooms on the route from the entrance room to the exit room is maximized. She likes the tree property of the current dungeon, so it must be preserved. Due to the cost limitation, what can be done in the remodeling is to block one doorway to make it unavailable and to construct one new doorway instead on a wall (possibly on the same wall).\n\nYour mission is to find a way to remodel the dungeon as the Queen wants.", "inputFormat": "The input consists of a single test case in the following format.\n\n$$\nh \\ w\n$$\n$$\nc_{1,1} c_{1,2} \\cdots c_{1,2w+1}\n$$\n$$\nc_{2,1} c_{2,2} \\cdots c_{2,2w+1}\n$$\n$$\n\\vdots\n$$\n$$\nc_{2h+1,1} c_{2h+1,2} \\cdots c_{2h+1,2w+1}\n$$\n\n$h$ and $w$ represent the size of the dungeon, each of which is an integer between $2$ and $500$, inclusive. The characters $c_{i,j}$ ($1 \\leq i \\leq 2h+1$, $1 \\leq j \\leq 2w+1$) represent the configuration of the dungeon as follows:\n\n- $c_{2i,2j} = \\text{'}.\\text{'}$ for $1 \\leq i \\leq h$ and $1 \\leq j \\leq w$, which corresponds to the room $i$-th from the north end and $j$-th from the west end of the dungeon; such a room is called the room $(i,j)$.\n- $c_{2i+1,2j} = \\text{'}.\\text{'}$ or $\\text{'}-\\text{'}$ for $1 \\leq i \\leq h-1$ and $1 \\leq j \\leq w$, which represents the wall between the rooms $(i,j)$ and $(i+1,j)$; the character $\\text{'}.\\text{'}$ means that the wall has a doorway and $\\text{'}-\\text{'}$ means it has no doorway.\n- $c_{2i,2j+1} = \\text{'}.\\text{'}$ or $\\text{'}|\\text{'}$ for $1 \\leq i \\leq h$ and $1 \\leq j \\leq w-1$, which represents the wall between the rooms $(i,j)$ and $(i,j+1)$; the character $\\text{'}.\\text{'}$ means that the wall has a doorway and $\\text{'}|\\text{'}$ means it has no doorway.\n- $c_{1,2j} = c_{2h+1,2j} = \\text{'}-\\text{'}$ ($1 \\leq j \\leq w$) and $c_{2i,1} = c_{2i,2w+1} = \\text{'}|\\text{'}$ ($1 \\leq i \\leq h$), which correspond to the outer walls of the dungeon.\n- $c_{2i+1,2j+1} = \\text{'}+\\text{'}$ for $0 \\leq i \\leq h$ and $0 \\leq j \\leq w$, which corresponds to an intersection of walls or outer walls.\n\nThe entrance and the exit of the dungeon are in the rooms $(1,1)$ and $(h,w)$, respectively. The configuration satisfies the tree property stated above.", "outputFormat": "Output the maximum length of the route from the entrance room to the exit room achievable by the remodeling, where the length of a route is the number of rooms passed including both the entrance and exit rooms.", "hint": "In the first sample, if you block the doorway between the rooms $(1,1)$ and $(1,2)$ and construct a new doorway between the rooms $(2,1)$ and $(2,2)$, then the unique route from $(1,1)$ to $(2,3)$ passes all of the 6 rooms, which is obviously the maximum.\n\nIn the second sample, any remodeling keeps the length of the unique route from $(1,1)$ to $(2,3)$ to be exactly 4.\n\nIn the third sample, one of the optimal ways is blocking the doorway between the rooms $(4,2)$ and $(4,3)$ and constructing a new doorway between the rooms $(2,4)$ and $(3,4)$.\n\nThe configurations after the remodeling described above are as follows.\n\n```\n+-+-+-+ +-+-+-+ +-+-+-+-+-+\n|.|...| |...|.| |...|...|.|\n+.+.+.+ +.+.+.+ +-+.+.+.+.+\n|...|.| |.|...| |...|.|.|.|\n+-+-+-+ +-+-+-+ +.+.+.+.+.+\n                |.|...|.|.|\n                +.+.+-+.+.+\n                |.|.|...|.|\n                +-+.+.+-+.+\n                |...|.....|\n                +-+-+-+-+-+\n```", "locale": "en"}, "zh-CN": {"title": "[ICPC 2022 Yokohama R] Remodeling the Dungeon", "background": "", "description": "Icpca 的女王平静地居住在一座城堡中。一天，她听说许多特工在其他国家活跃，于是开始担忧城堡的安全。\n\n城堡有一个矩形地牢，由 $h$ 行 $w$ 列的正方形房间组成。相邻房间由墙壁隔开。有些墙壁上有门道，使得被隔开的房间可以互通。地牢的入口和出口位于两个对角线的角落房间。地牢的房间构成一棵 **树**，也就是说，从地牢的每个房间到出口房间都有一条唯一的路径可达，该路径上的每个房间仅经过一次。\n\n为了增强城堡的安全，女王想要改造地牢，使得从入口房间到出口房间的路径上的房间数量最大化。她喜欢当前地牢的树状属性，因此必须保留这一特性。由于成本限制，改造只能做两件事：封闭一个现有的门道使其不可用，并在另一面墙（可能是同一面墙）上建造一个新的门道。\n\n你的任务是找到一种改造地牢的方法，以满足女王的需求。", "inputFormat": "输入由单个测试用例组成，格式如下。\n\n$$\nh \\ w\n$$\n$$\nc_{1,1} c_{1,2} \\cdots c_{1,2w+1}\n$$\n$$\nc_{2,1} c_{2,2} \\cdots c_{2,2w+1}\n$$\n$$\n\\vdots\n$$\n$$\nc_{2h+1,1} c_{2h+1,2} \\cdots c_{2h+1,2w+1}\n$$\n\n$h$ 和 $w$ 表示地牢的大小，每个都是介于 $2$ 到 $500$ 之间（含）的整数。字符 $c_{i,j}$ ($1 \\leq i \\leq 2h+1$, $1 \\leq j \\leq 2w+1$) 表示地牢的配置，如下所示：\n\n- $c_{2i,2j} = \\text{'}.\\text{'}$ 对于 $1 \\leq i \\leq h$ 和 $1 \\leq j \\leq w$，对应地牢中从北端数第 $i$ 行、西端数第 $j$ 列的房间；这样的房间称为房间 $(i,j)$。\n- $c_{2i+1,2j} = \\text{'}.\\text{'}$ 或 $\\text{'}-\\text{'}$ 对于 $1 \\leq i \\leq h-1$ 和 $1 \\leq j \\leq w$，表示房间 $(i,j)$ 和 $(i+1,j)$ 之间的墙壁；字符 $\\text{'}.\\text{'}$ 表示该墙有门道，$\\text{'}-\\text{'}$ 表示没有门道。\n- $c_{2i,2j+1} = \\text{'}.\\text{'}$ 或 $\\text{'}|\\text{'}$ 对于 $1 \\leq i \\leq h$ 和 $1 \\leq j \\leq w-1$，表示房间 $(i,j)$ 和 $(i,j+1)$ 之间的墙壁；字符 $\\text{'}.\\text{'}$ 表示该墙有门道，$\\text{'}|\\text{'}$ 表示没有门道。\n- $c_{1,2j} = c_{2h+1,2j} = \\text{'}-\\text{'}$ ($1 \\leq j \\leq w$) 和 $c_{2i,1} = c_{2i,2w+1} = \\text{'}|\\text{'}$ ($1 \\leq i \\leq h$)，对应地牢的外墙。\n- $c_{2i+1,2j+1} = \\text{'}+\\text{'}$ 对于 $0 \\leq i \\leq h$ 和 $0 \\leq j \\leq w$，对应墙壁或外墙的交点。\n\n地牢的入口和出口分别位于房间 $(1,1)$ 和 $(h,w)$。配置满足上述的树状属性。", "outputFormat": "输出通过改造可以达到的从入口房间到出口房间的路径的最大长度，其中路径长度是经过的房间数量，包括入口和出口房间。\n", "hint": "在第一个样例中，如果你封闭房间 $(1,1)$ 和 $(1,2)$ 之间的门道，并在房间 $(2,1)$ 和 $(2,2)$ 之间建造一个新的门道，那么从 $(1,1)$ 到 $(2,3)$ 的唯一路径将经过全部 $6$ 个房间，这显然是最大值。\n\n在第二个样例中，任何改造都将使得从 $(1,1)$ 到 $(2,3)$ 的唯一路径长度保持恰好为 $4$。\n\n在第三个样例中，一种最优方式是封闭房间 $(4,2)$ 和 $(4,3)$ 之间的门道，并在房间 $(2,4)$ 和 $(3,4)$ 之间建造一个新的门道。\n\n上述改造后的配置如下所示。\n\n```\n+-+-+-+ +-+-+-+ +-+-+-+-+-+\n|.|...| |...|.| |...|...|.|\n+.+.+.+ +.+.+.+ +-+.+.+.+.+\n|...|.| |.|...| |...|.|.|.|\n+-+-+-+ +-+-+-+ +.+.+.+.+.+\n                |.|...|.|.|\n                +.+.+-+.+.+\n                |.|.|...|.|\n                +-+.+.+-+.+\n                |...|.....|\n                +-+-+-+-+-+\n```", "locale": "zh-CN"}}}
{"pid": "P14849", "type": "P", "difficulty": 6, "samples": [["24 4 6", "12"], ["30 5 6", "4"], ["30 9 20", "0"], ["100000000000000 1 100000000000000", "288287412"]], "limits": {"time": [10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["数学", "2022", "ICPC", "横浜"], "title": "[ICPC 2022 Yokohama R] Cake Decoration", "background": "", "description": "You are ordering a cake to celebrate the New Year. You have to decide the numbers of decoration items to be topped on the cake. Available items are dog figures, cat figures, red candies, and blue candies.\n\nYou want all four items to decorate the cake, and all the numbers of the four items to be different from each other. You also want the number of figures (the sum of dogs and cats) to be within a certain range.\n\nAn extra charge for the decoration items is added to the price of the cake. The extra is, although quite queer, the product of the numbers of the four decoration items. You want the cake to look gorgeous as far as the budget allows. Thus, you are not satisfied with a decoration if you can add any of the four items without violating the budget constraint.\n\nThe conditions stated above are summarized as follows. Let $d$, $c$, $r$, and $b$ be the numbers of dog figures, cat figures, red candies, and blue candies, respectively. All these numbers should be different positive integers satisfying the following conditions for given $X$, $L$, and $R$:\n\n- $L \\leq d + c < R$,\n- $d \\times c \\times r \\times b \\leq X$,\n- $(d+1) \\times c \\times r \\times b > X$,\n- $d \\times (c+1) \\times r \\times b > X$,\n- $d \\times c \\times (r+1) \\times b > X$, and\n- $d \\times c \\times r \\times (b+1) > X$.\n\nMore than one combination of four numbers of decoration items may satisfy the conditions. Your task is to find how many such combinations exist.", "inputFormat": "The input consists of a single test case of the following format.\n\n$$\nX \\ L \\ R\n$$\n\nHere, $X$, $L$, and $R$ are integers appearing in the conditions stated above. They satisfy $1 \\leq X \\leq 10^{14}$ and $1 \\leq L < R \\leq 10^{14}$.\n", "outputFormat": "Output the number of combinations of four numbers of decoration items that satisfy the conditions stated above modulo a prime number $998244353 = 2^{23} \\times 7 \\times 17 + 1$.", "hint": "For Sample Input 2, four combinations of $(d, c, r, b) = (2,3,1,5)$, $(2,3,5,1)$, $(3,2,1,5)$, and $(3,2,5,1)$ satisfy all the conditions. $(d, c, r, b) = (1,4,2,3)$ is not eligible because its extra cost for the decoration items does not exceed $X = 30$ even after adding one more cat figure. $(d, c, r, b) = (1,5,2,3)$ is also ineligible because $d + c < R = 6$ does not hold.\n", "locale": "en", "translations": {"en": {"title": "[ICPC 2022 Yokohama R] Cake Decoration", "background": "", "description": "You are ordering a cake to celebrate the New Year. You have to decide the numbers of decoration items to be topped on the cake. Available items are dog figures, cat figures, red candies, and blue candies.\n\nYou want all four items to decorate the cake, and all the numbers of the four items to be different from each other. You also want the number of figures (the sum of dogs and cats) to be within a certain range.\n\nAn extra charge for the decoration items is added to the price of the cake. The extra is, although quite queer, the product of the numbers of the four decoration items. You want the cake to look gorgeous as far as the budget allows. Thus, you are not satisfied with a decoration if you can add any of the four items without violating the budget constraint.\n\nThe conditions stated above are summarized as follows. Let $d$, $c$, $r$, and $b$ be the numbers of dog figures, cat figures, red candies, and blue candies, respectively. All these numbers should be different positive integers satisfying the following conditions for given $X$, $L$, and $R$:\n\n- $L \\leq d + c < R$,\n- $d \\times c \\times r \\times b \\leq X$,\n- $(d+1) \\times c \\times r \\times b > X$,\n- $d \\times (c+1) \\times r \\times b > X$,\n- $d \\times c \\times (r+1) \\times b > X$, and\n- $d \\times c \\times r \\times (b+1) > X$.\n\nMore than one combination of four numbers of decoration items may satisfy the conditions. Your task is to find how many such combinations exist.", "inputFormat": "The input consists of a single test case of the following format.\n\n$$\nX \\ L \\ R\n$$\n\nHere, $X$, $L$, and $R$ are integers appearing in the conditions stated above. They satisfy $1 \\leq X \\leq 10^{14}$ and $1 \\leq L < R \\leq 10^{14}$.\n", "outputFormat": "Output the number of combinations of four numbers of decoration items that satisfy the conditions stated above modulo a prime number $998244353 = 2^{23} \\times 7 \\times 17 + 1$.", "hint": "For Sample Input 2, four combinations of $(d, c, r, b) = (2,3,1,5)$, $(2,3,5,1)$, $(3,2,1,5)$, and $(3,2,5,1)$ satisfy all the conditions. $(d, c, r, b) = (1,4,2,3)$ is not eligible because its extra cost for the decoration items does not exceed $X = 30$ even after adding one more cat figure. $(d, c, r, b) = (1,5,2,3)$ is also ineligible because $d + c < R = 6$ does not hold.\n", "locale": "en"}, "zh-CN": {"title": "[ICPC 2022 Yokohama R] Cake Decoration", "background": "", "description": "你正在订购一个蛋糕来庆祝新年。你需要确定装饰物品在蛋糕上的数量。可用的物品有狗雕像、猫雕像、红色糖果和蓝色糖果。\n\n你希望用这四种物品装饰蛋糕，并且这四种物品的数量彼此不同。你还希望雕像（狗和猫的总数）的数量在某个范围内。\n\n装饰物品的额外费用会加到蛋糕的价格中。额外费用虽然相当奇怪，但却是四种装饰物品数量的乘积。你希望在预算允许的情况下，让蛋糕看起来尽可能华丽。因此，如果你可以在不违反预算限制的情况下增加四种物品中的任意一种，那么你对这种装饰方案就不满意。\n\n上述条件总结如下：设 $d$、$c$、$r$ 和 $b$ 分别表示狗雕像、猫雕像、红色糖果和蓝色糖果的数量。所有这些数量应是不同的正整数，并满足给定的 $X$、$L$ 和 $R$ 的以下条件：\n\n- $L \\leq d + c < R$，\n- $d \\times c \\times r \\times b \\leq X$，\n- $(d+1) \\times c \\times r \\times b > X$，\n- $d \\times (c+1) \\times r \\times b > X$，\n- $d \\times c \\times (r+1) \\times b > X$，以及\n- $d \\times c \\times r \\times (b+1) > X$。\n\n可能有多种装饰物品数量的组合满足这些条件。你的任务是找出有多少种这样的组合存在。", "inputFormat": "输入由单个测试用例组成，格式如下。\n\n$$\nX \\ L \\ R\n$$\n\n这里，$X$、$L$ 和 $R$ 是上述条件中出现的整数。它们满足 $1 \\leq X \\leq 10^{14}$ 和 $1 \\leq L < R \\leq 10^{14}$。", "outputFormat": "输出满足上述条件的装饰物品数量组合的数量，结果对质数 $998244353 = 2^{23} \\times 7 \\times 17 + 1$ 取模。\n", "hint": "对于样例输入 2，四种组合 $(d, c, r, b) = (2,3,1,5)$、$(2,3,5,1)$、$(3,2,1,5)$ 和 $(3,2,5,1)$ 满足所有条件。$(d, c, r, b) = (1,4,2,3)$ 不符合条件，因为即使再增加一只猫雕像，其装饰物品的额外费用也没有超过 $X = 30$。$(d, c, r, b) = (1,5,2,3)$ 也不符合条件，因为 $d + c < R = 6$ 不成立。", "locale": "zh-CN"}}}
{"pid": "P14850", "type": "P", "difficulty": 7, "samples": [["2 4\n2 2\n1 2", "20\n4"], ["4 6\n1 1 2 2\n1 1 1 2", "168\n168\n336\n48"], ["4 82\n20 22 12 28\n20 22 7 8", "746371221\n528486621\n148054814\n913602744"]], "limits": {"time": [8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2022", "快速数论变换 NTT", "ICPC", "横浜"], "title": "[ICPC 2022 Yokohama R] Quiz Contest", "background": "", "description": "The final round of the annual World Quiz Contest is now at the climax!\n\nIn this round, questions are asked one by one, and the competitor correctly answering the goal number of questions first will be the champion. Many questions have already been asked and answered. The numbers of questions correctly answered so far by competitors may differ, and thus the numbers of additional questions to answer correctly to win may be different.\n\nThe questions elaborated by the judge crew are quite difficult, and the competitors have completely distinct areas of expertise. Thus, for each question, exactly one competitor can find the correct answer.\n\nWho becomes the champion depends on the order of the questions asked. The judge crew know all the questions and who can answer which, but they do not know the order of the remaining questions, as the questions have been randomly shuffled. To help the judge crew guess the champion of this year, count the number of possible orders of the remaining questions that would make each competitor win. Note that the orders of the questions left unused after the decision of the champion should also be considered.", "inputFormat": "The input consists of a single test case of the following format.\n\n$$\nn \\ m\n$$\n$$\na_1 \\ \\cdots \\ a_n\n$$\n$$\nb_1 \\ \\cdots \\ b_n\n$$\n\nHere, $n$ is the number of competitors and $m$ is the number of remaining questions. Both $n$ and $m$ are integers satisfying $1 \\leq n \\leq m \\leq 2 \\times 10^5$. Competitors are numbered 1 through $n$. The following line contains $n$ integers, $a_1, \\ldots, a_n$, meaning that the number of remaining questions that the competitor $i$ can answer correctly is $a_i$, where $\\sum_{i=1}^{n} a_i = m$ holds. The last line contains $n$ integers, $b_1, \\ldots, b_n$, meaning that the competitor $i$ has to answer $b_i$ more questions correctly to win. $1 \\leq b_i \\leq a_i$ holds.\n", "outputFormat": "Let $c_i$ be the number of question orders that make the competitor $i$ the champion. Output $n$ lines, each containing an integer. The number on the $i$-th line should be $c_i$ modulo a prime number $998244353 = 2^{23} \\times 7 \\times 17 + 1$. Note that $\\sum_{i=1}^{n} c_i = m!$ holds.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2022 Yokohama R] Quiz Contest", "background": "", "description": "The final round of the annual World Quiz Contest is now at the climax!\n\nIn this round, questions are asked one by one, and the competitor correctly answering the goal number of questions first will be the champion. Many questions have already been asked and answered. The numbers of questions correctly answered so far by competitors may differ, and thus the numbers of additional questions to answer correctly to win may be different.\n\nThe questions elaborated by the judge crew are quite difficult, and the competitors have completely distinct areas of expertise. Thus, for each question, exactly one competitor can find the correct answer.\n\nWho becomes the champion depends on the order of the questions asked. The judge crew know all the questions and who can answer which, but they do not know the order of the remaining questions, as the questions have been randomly shuffled. To help the judge crew guess the champion of this year, count the number of possible orders of the remaining questions that would make each competitor win. Note that the orders of the questions left unused after the decision of the champion should also be considered.", "inputFormat": "The input consists of a single test case of the following format.\n\n$$\nn \\ m\n$$\n$$\na_1 \\ \\cdots \\ a_n\n$$\n$$\nb_1 \\ \\cdots \\ b_n\n$$\n\nHere, $n$ is the number of competitors and $m$ is the number of remaining questions. Both $n$ and $m$ are integers satisfying $1 \\leq n \\leq m \\leq 2 \\times 10^5$. Competitors are numbered 1 through $n$. The following line contains $n$ integers, $a_1, \\ldots, a_n$, meaning that the number of remaining questions that the competitor $i$ can answer correctly is $a_i$, where $\\sum_{i=1}^{n} a_i = m$ holds. The last line contains $n$ integers, $b_1, \\ldots, b_n$, meaning that the competitor $i$ has to answer $b_i$ more questions correctly to win. $1 \\leq b_i \\leq a_i$ holds.\n", "outputFormat": "Let $c_i$ be the number of question orders that make the competitor $i$ the champion. Output $n$ lines, each containing an integer. The number on the $i$-th line should be $c_i$ modulo a prime number $998244353 = 2^{23} \\times 7 \\times 17 + 1$. Note that $\\sum_{i=1}^{n} c_i = m!$ holds.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2022 Yokohama R] Quiz Contest", "background": "", "description": "年度世界知识竞赛总决赛现已进入高潮！\n\n在这一轮中，问题逐个提出，最先正确回答到目标数量的选手将成为冠军。许多问题已经被提出并回答。目前每位选手正确回答的问题数量可能不同，因此为了获胜需要额外正确回答的问题数量也可能不同。\n\n裁判团队精心设计的问题非常困难，选手们的专长领域完全不同。因此，对于每个问题，恰好有一位选手能找到正确答案。\n\n谁将成为冠军取决于提问的顺序。裁判团队知道所有问题以及谁能回答哪些问题，但他们不知道剩余问题的顺序，因为问题已经随机打乱。为了帮助裁判团队猜测今年的冠军，请计算使得每位选手获胜的剩余问题的可能顺序数量。注意，在冠军确定后未使用的问题的顺序也应考虑在内。", "inputFormat": "输入由单个测试用例组成，格式如下。\n\n$$\nn \\ m\n$$\n$$\na_1 \\ \\cdots \\ a_n\n$$\n$$\nb_1 \\ \\cdots \\ b_n\n$$\n\n这里，$n$ 是选手数量，$m$ 是剩余问题的数量。$n$ 和 $m$ 均为整数，满足 $1 \\leq n \\leq m \\leq 2 \\times 10^5$。选手编号为 $1$ 到 $n$。接下来一行包含 $n$ 个整数 $a_1, \\ldots, a_n$，表示选手 $i$ 能够正确回答的剩余问题数量为 $a_i$，其中 $\\sum_{i=1}^{n} a_i = m$ 成立。最后一行包含 $n$ 个整数 $b_1, \\ldots, b_n$，表示选手 $i$ 需要再正确回答 $b_i$ 个问题才能获胜。满足 $1 \\leq b_i \\leq a_i$。", "outputFormat": "设 $c_i$ 为使得选手 $i$ 成为冠军的问题顺序数量。输出 $n$ 行，每行包含一个整数。第 $i$ 行的数字应为 $c_i$ 对质数 $998244353 = 2^{23} \\times 7 \\times 17 + 1$ 取模的结果。注意 $\\sum_{i=1}^{n} c_i = m!$ 成立。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P14851", "type": "P", "difficulty": 6, "samples": [["4 4\n0 0\n2 0\n2 2\n0 2\n1 0\n1 2\n2 1\n0 1", "5.656854249492381"], ["8 2\n0 0\n4 0\n4 4\n0 4\n0 3\n3 3\n3 1\n0 1\n0 0\n0 4", "16.64911064067352"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["计算几何", "2022", "Special Judge", "最短路", "ICPC", "横浜"], "title": "[ICPC 2022 Yokohama R] Traveling Salesperson in an Island", "background": "", "description": "You are a salesperson at one of the ports in an island. You have to visit all the ports of the island and then come back to the starting port. Because you cannot swim and are scared of the sea, you have to stay on the land during your journey.\n\nThe island is modeled as a polygon on a two-dimensional plane. The polygon is *simple*, that is, its vertices are distinct and no two edges intersect or touch, other than consecutive edges which touch at their common vertex. In addition, no two consecutive edges are collinear. Each port in the island is modeled as a point on the boundary of the polygon. Your route is modeled as a closed curve that does not go outside of the polygon.\n\nIn preparation for the journey, you would like to compute the minimum length of a route to visit all the ports and return to the starting port.\n", "inputFormat": "The input consists of a single test case of the following format.\n\n$$\n\\begin{aligned}\n&n \\ m \\\\\n&x_1 \\ y_1 \\\\\n&\\vdots \\\\\n&x_n \\ y_n \\\\\n&x'_1 \\ y'_1 \\\\\n&\\vdots \\\\\n&x'_m \\ y'_m\n\\end{aligned}\n$$\n\nThe first line contains two integers $n$ and $m$, which satisfy $3 \\leq n \\leq 100$ and $2 \\leq m \\leq 100$. Here, $n$ is the number of vertices of the polygon modeling the island, and $m$ is the number of the ports in the island. Each of the next $n$ lines consists of two integers $x_i$ and $y_i$, which are the coordinates of the $i$-th vertex of the polygon, where $0 \\leq x_i \\leq 1000$ and $0 \\leq y_i \\leq 1000$. The vertices of the polygon are given in counterclockwise order. Each of the $m$ following lines consists of two integers $x'_j$ and $y'_j$, which are the coordinates of the $j$-th port. The route starts and ends at $(x'_1, y'_1)$. It is guaranteed that all the ports are on the boundary of the polygon and pairwise distinct.\n", "outputFormat": "Output in a line the minimum length of a route to visit all the ports and return to the starting port. The relative error of the output must be within $10^{-6}$.", "hint": "These samples are depicted in the following figures. The shortest routes are depicted by the thick lines. The gray polygons represent the islands. The small disks represent the ports in the islands. Note that the route does not have to be simple, i.e., the route may intersect or overlap itself as in the second sample, in which the same path between the two ports is used twice.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/ytcdxshj.png)\n\nFigure J.1. Sample 1\n\nFigure J.2. Sample 2\n:::", "locale": "en", "translations": {"en": {"title": "[ICPC 2022 Yokohama R] Traveling Salesperson in an Island", "background": "", "description": "You are a salesperson at one of the ports in an island. You have to visit all the ports of the island and then come back to the starting port. Because you cannot swim and are scared of the sea, you have to stay on the land during your journey.\n\nThe island is modeled as a polygon on a two-dimensional plane. The polygon is *simple*, that is, its vertices are distinct and no two edges intersect or touch, other than consecutive edges which touch at their common vertex. In addition, no two consecutive edges are collinear. Each port in the island is modeled as a point on the boundary of the polygon. Your route is modeled as a closed curve that does not go outside of the polygon.\n\nIn preparation for the journey, you would like to compute the minimum length of a route to visit all the ports and return to the starting port.\n", "inputFormat": "The input consists of a single test case of the following format.\n\n$$\n\\begin{aligned}\n&n \\ m \\\\\n&x_1 \\ y_1 \\\\\n&\\vdots \\\\\n&x_n \\ y_n \\\\\n&x'_1 \\ y'_1 \\\\\n&\\vdots \\\\\n&x'_m \\ y'_m\n\\end{aligned}\n$$\n\nThe first line contains two integers $n$ and $m$, which satisfy $3 \\leq n \\leq 100$ and $2 \\leq m \\leq 100$. Here, $n$ is the number of vertices of the polygon modeling the island, and $m$ is the number of the ports in the island. Each of the next $n$ lines consists of two integers $x_i$ and $y_i$, which are the coordinates of the $i$-th vertex of the polygon, where $0 \\leq x_i \\leq 1000$ and $0 \\leq y_i \\leq 1000$. The vertices of the polygon are given in counterclockwise order. Each of the $m$ following lines consists of two integers $x'_j$ and $y'_j$, which are the coordinates of the $j$-th port. The route starts and ends at $(x'_1, y'_1)$. It is guaranteed that all the ports are on the boundary of the polygon and pairwise distinct.\n", "outputFormat": "Output in a line the minimum length of a route to visit all the ports and return to the starting port. The relative error of the output must be within $10^{-6}$.", "hint": "These samples are depicted in the following figures. The shortest routes are depicted by the thick lines. The gray polygons represent the islands. The small disks represent the ports in the islands. Note that the route does not have to be simple, i.e., the route may intersect or overlap itself as in the second sample, in which the same path between the two ports is used twice.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/ytcdxshj.png)\n\nFigure J.1. Sample 1\n\nFigure J.2. Sample 2\n:::", "locale": "en"}, "zh-CN": {"title": "[ICPC 2022 Yokohama R] Traveling Salesperson in an Island", "background": "", "description": "你是岛上某个港口的销售员。你需要拜访岛上的所有港口，然后返回起始港口。因为你不会游泳且害怕大海，所以在旅途中必须停留在陆地上。\n\n该岛被建模为二维平面上的一个多边形。该多边形是 **简单的**，即其顶点互不相同，且除相邻边在其公共顶点处相接外，没有两条边相交或相触。此外，没有两条相邻边共线。岛上的每个港口被建模为多边形边界上的一个点。你的路线被建模为一条不超出多边形范围的闭合曲线。\n\n为了准备这次旅程，你想计算拜访所有港口并返回起始港口的最短路线长度。", "inputFormat": "输入由单个测试用例组成，格式如下。\n\n$$\n\\begin{aligned}\n&n \\ m \\\\\n&x_1 \\ y_1 \\\\\n&\\vdots \\\\\n&x_n \\ y_n \\\\\n&x'_1 \\ y'_1 \\\\\n&\\vdots \\\\\n&x'_m \\ y'_m\n\\end{aligned}\n$$\n\n第一行包含两个整数 $n$ 和 $m$，满足 $3 \\leq n \\leq 100$ 和 $2 \\leq m \\leq 100$。其中 $n$ 是建模岛屿的多边形的顶点数，$m$ 是岛上的港口数量。接下来的 $n$ 行，每行包含两个整数 $x_i$ 和 $y_i$，是多边形第 $i$ 个顶点的坐标，其中 $0 \\leq x_i \\leq 1000$ 且 $0 \\leq y_i \\leq 1000$。多边形的顶点按逆时针顺序给出。接下来的 $m$ 行，每行包含两个整数 $x'_j$ 和 $y'_j$，是第 $j$ 个港口的坐标。路线从 $(x'_1, y'_1)$ 开始并结束。保证所有港口都位于多边形的边界上且互不相同。\n", "outputFormat": "在一行中输出拜访所有港口并返回起始港口的最短路线长度。输出的相对误差必须在 $10^{-6}$ 以内。\n", "hint": "这些样例如下图所示。最短路线用粗线表示。灰色多边形代表岛屿。小圆盘代表岛上的港口。注意，路线不一定非得是简单的，即路线可以自相交或重叠，如第二个样例中，两个港口之间的同一条路径被使用了两次。\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/ytcdxshj.png)\n\n图 J.1. 样例 1\n\n图 J.2. 样例 2\n:::", "locale": "zh-CN"}}}
{"pid": "P14852", "type": "P", "difficulty": 6, "samples": [["3\n3 50\n300 2500\n350 0\n400 3000\n2 120\n380 0\n400 2400\n4 160\n0 800\n400 0\n450 100\n950 4600", "1460"], ["4\n2 160\n384 0\n1000 2464\n3 280\n0 2646\n441 0\n1000 2795\n1 160\n544 0\n2 240\n720 0\n1220 2000", "2022"]], "limits": {"time": [7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["动态规划 DP", "2022", "ICPC", "横浜"], "title": "[ICPC 2022 Yokohama R] New Year Festival", "background": "", "description": "The ICPC (Incredibly Colossal and Particularly Comfortable) Theater is giving a number of traditional events to celebrate the New Year!\n\nEach of the events has its own unalterable duration. Start times of the events are flexible as long as no two events overlap. An event may start immediately after another event ends.\n\nStart times of the events influence the costs. The cost of an event is given by a continuous piecewise linear function (a polygonal line function) of its start time. Different events may have different cost functions.\n\nYou are asked to schedule all the events minimizing the total cost.", "inputFormat": "The input consists of a single test case of the following format.\n\n$$\n\\begin{aligned}\n&n \\\\\n&\\text{Description}_1 \\\\\n&\\vdots \\\\\n&\\text{Description}_n\n\\end{aligned}\n$$\n\nThe first line contains an integer $n$, representing the number of events. $2 \\leq n \\leq 11$ holds. The descriptions of the events follow. The description of the $i$-th event, $\\text{Description}_i$ ($1 \\leq i \\leq n$), has the following format.\n\n$$\n\\begin{aligned}\n&m \\ l \\\\\n&x_1 \\ y_1 \\\\\n&\\vdots \\\\\n&x_m \\ y_m\n\\end{aligned}\n$$\n\nThe integer $m$ in the first line is the number of vertices of the cost function of the event. The integer $l$ in the same line is the duration of the event. $1 \\leq m \\leq 60$ and $1 \\leq l \\leq 10^8$ hold.\n\nThe following $m$ lines describe the cost function. The $j$-th line of the $m$ lines consists of the two integers $x_j$ and $y_j$ specifying the $j$-th vertex of the cost function. $0 \\leq x_1 < \\cdots < x_m \\leq 10^8$ and $0 \\leq y_j \\leq 10^8$ hold. In addition, $(y_{j+1} - y_j)/(x_{j+1} - x_j)$ is an integer for any $1 \\leq j < m$.\n\nThe start time $t$ of the event must satisfy $x_1 \\leq t \\leq x_m$. For $j$ ($1 \\leq j < m$) satisfying $x_j \\leq t \\leq x_{j+1}$, the cost of the event is given as $y_j + (t - x_j) \\times (y_{j+1} - y_j)/(x_{j+1} - x_j)$.\n\nThe total number of the vertices of all the cost functions is not greater than 60.", "outputFormat": "Output the minimum possible total cost of the events in a line.\n\nIt is guaranteed that there is at least one possible schedule containing no overlap. It can be proved that the answer is an integer.\n", "hint": "For Sample Input 1, making the (start time, end time) pairs of the three events to be $(330, 380)$, $(380, 500)$, and $(170, 330)$, respectively, achieves the minimum total cost without event overlaps. The cost of the event 1 is $2500 + (330 - 300) \\times (0 - 2500)/(350 - 300) = 1000$. Similarly, the costs of the events 2 and 3 are 0 and 460, respectively.\n\nFor Sample Input 2, the minimum cost is achieved by $(384, 544)$, $(104, 384)$, $(544, 704)$, and $(720, 960)$ for the four events.\n\n:::align{center}\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xlvvixpn.png)\n\nFigure K.1. Cost functions in Sample Input 1 and a sample schedule\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/bzrwpkvq.png)\n\nFigure K.2. Cost functions in Sample Input 2 and a sample schedule\n:::\n\nIn Figures K.1 and K.2, polylines in the top figure represent cost functions, and rectangles in the bottom figure represent event durations of a schedule achieving the minimum total cost.", "locale": "en", "translations": {"en": {"title": "[ICPC 2022 Yokohama R] New Year Festival", "background": "", "description": "The ICPC (Incredibly Colossal and Particularly Comfortable) Theater is giving a number of traditional events to celebrate the New Year!\n\nEach of the events has its own unalterable duration. Start times of the events are flexible as long as no two events overlap. An event may start immediately after another event ends.\n\nStart times of the events influence the costs. The cost of an event is given by a continuous piecewise linear function (a polygonal line function) of its start time. Different events may have different cost functions.\n\nYou are asked to schedule all the events minimizing the total cost.", "inputFormat": "The input consists of a single test case of the following format.\n\n$$\n\\begin{aligned}\n&n \\\\\n&\\text{Description}_1 \\\\\n&\\vdots \\\\\n&\\text{Description}_n\n\\end{aligned}\n$$\n\nThe first line contains an integer $n$, representing the number of events. $2 \\leq n \\leq 11$ holds. The descriptions of the events follow. The description of the $i$-th event, $\\text{Description}_i$ ($1 \\leq i \\leq n$), has the following format.\n\n$$\n\\begin{aligned}\n&m \\ l \\\\\n&x_1 \\ y_1 \\\\\n&\\vdots \\\\\n&x_m \\ y_m\n\\end{aligned}\n$$\n\nThe integer $m$ in the first line is the number of vertices of the cost function of the event. The integer $l$ in the same line is the duration of the event. $1 \\leq m \\leq 60$ and $1 \\leq l \\leq 10^8$ hold.\n\nThe following $m$ lines describe the cost function. The $j$-th line of the $m$ lines consists of the two integers $x_j$ and $y_j$ specifying the $j$-th vertex of the cost function. $0 \\leq x_1 < \\cdots < x_m \\leq 10^8$ and $0 \\leq y_j \\leq 10^8$ hold. In addition, $(y_{j+1} - y_j)/(x_{j+1} - x_j)$ is an integer for any $1 \\leq j < m$.\n\nThe start time $t$ of the event must satisfy $x_1 \\leq t \\leq x_m$. For $j$ ($1 \\leq j < m$) satisfying $x_j \\leq t \\leq x_{j+1}$, the cost of the event is given as $y_j + (t - x_j) \\times (y_{j+1} - y_j)/(x_{j+1} - x_j)$.\n\nThe total number of the vertices of all the cost functions is not greater than 60.", "outputFormat": "Output the minimum possible total cost of the events in a line.\n\nIt is guaranteed that there is at least one possible schedule containing no overlap. It can be proved that the answer is an integer.\n", "hint": "For Sample Input 1, making the (start time, end time) pairs of the three events to be $(330, 380)$, $(380, 500)$, and $(170, 330)$, respectively, achieves the minimum total cost without event overlaps. The cost of the event 1 is $2500 + (330 - 300) \\times (0 - 2500)/(350 - 300) = 1000$. Similarly, the costs of the events 2 and 3 are 0 and 460, respectively.\n\nFor Sample Input 2, the minimum cost is achieved by $(384, 544)$, $(104, 384)$, $(544, 704)$, and $(720, 960)$ for the four events.\n\n:::align{center}\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xlvvixpn.png)\n\nFigure K.1. Cost functions in Sample Input 1 and a sample schedule\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/bzrwpkvq.png)\n\nFigure K.2. Cost functions in Sample Input 2 and a sample schedule\n:::\n\nIn Figures K.1 and K.2, polylines in the top figure represent cost functions, and rectangles in the bottom figure represent event durations of a schedule achieving the minimum total cost.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2022 Yokohama R] New Year Festival", "background": "", "description": "ICPC（极其宏大且特别舒适）剧院正在举办一系列传统活动来庆祝新年！\n\n每个活动都有其固定的持续时间。活动的开始时间可以灵活安排，只要没有两个活动时间重叠。一个活动可以在另一个活动结束后立即开始。\n\n活动的开始时间会影响其成本。活动的成本由其开始时间的连续分段线性函数（折线函数）给出。不同的活动可能有不同的成本函数。\n\n你需要安排所有活动，使得总成本最小。", "inputFormat": "输入由单个测试用例组成，格式如下。\n\n$$\n\\begin{aligned}\n&n \\\\\n&\\text{Description}_1 \\\\\n&\\vdots \\\\\n&\\text{Description}_n\n\\end{aligned}\n$$\n\n第一行包含一个整数 $n$，表示活动的数量。满足 $2 \\leq n \\leq 11$。接下来是活动的描述。第 $i$ 个活动 ($1 \\leq i \\leq n$) 的描述 $\\text{Description}_i$ 格式如下。\n\n$$\n\\begin{aligned}\n&m \\ l \\\\\n&x_1 \\ y_1 \\\\\n&\\vdots \\\\\n&x_m \\ y_m\n\\end{aligned}\n$$\n\n第一行的整数 $m$ 是该活动成本函数的顶点数。同一行的整数 $l$ 是该活动的持续时间。满足 $1 \\leq m \\leq 60$ 和 $1 \\leq l \\leq 10^8$。\n\n接下来的 $m$ 行描述成本函数。这 $m$ 行中的第 $j$ 行由两个整数 $x_j$ 和 $y_j$ 组成，指定了成本函数的第 $j$ 个顶点。满足 $0 \\leq x_1 < \\cdots < x_m \\leq 10^8$ 和 $0 \\leq y_j \\leq 10^8$。此外，对于任意 $1 \\leq j < m$，$(y_{j+1} - y_j)/(x_{j+1} - x_j)$ 是整数。\n\n活动的开始时间 $t$ 必须满足 $x_1 \\leq t \\leq x_m$。对于满足 $x_j \\leq t \\leq x_{j+1}$ 的 $j$ ($1 \\leq j < m$)，活动的成本由 $y_j + (t - x_j) \\times (y_{j+1} - y_j)/(x_{j+1} - x_j)$ 给出。\n\n所有成本函数的顶点总数不超过 60。", "outputFormat": "在一行中输出可能的最小总成本。\n\n保证至少存在一个没有重叠的可能安排。可以证明答案是整数。", "hint": "对于样例输入 1，将三个活动的（开始时间，结束时间）对分别设为 $(330, 380)$、$(380, 500)$ 和 $(170, 330)$，可以在没有活动重叠的情况下实现最小总成本。活动 1 的成本为 $2500 + (330 - 300) \\times (0 - 2500)/(350 - 300) = 1000$。类似地，活动 2 和 3 的成本分别为 $0$ 和 $460$。\n\n对于样例输入 2，四个活动的最小成本安排为 $(384, 544)$、$(104, 384)$、$(544, 704)$ 和 $(720, 960)$。\n\n:::align{center}\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xlvvixpn.png)\n\n图 K.1. 样例输入 1 的成本函数及一个示例安排\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/bzrwpkvq.png)\n\n图 K.2. 样例输入 2 的成本函数及一个示例安排\n:::\n\n在图 K.1 和 K.2 中，上部图中的折线表示成本函数，下部图中的矩形表示实现最小总成本的安排中的活动持续时间。\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P14853", "type": "P", "difficulty": 2, "samples": [["6 9\n20 0 10\n20 10 0\n10 20 0\n0 20 10\n0 10 20\n10 0 20", "17149.528141"], ["4 12\n10 10 0\n10 -10 0\n-10 -10 0\n-10 10 0", "27813.56696"], ["6 9\n23 3 13\n20 10 0\n10 20 0\n3 23 13\n0 10 20\n10 0 20", "17470.837758"], ["4 2\n0 0 0\n3 0 0\n3 3 0\n0 3 0", "122.52211349"], ["8 70\n100 100 0\n0 100 0\n-100 100 0\n-100 0 0\n-100 -100 0\n0 -100 0\n100 -100 0\n100 0 0", "10220648.1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2021", "Special Judge", "ICPC", "横浜"], "title": "[ICPC 2021 Yokohama R] Loop of Chocolate", "background": "", "description": "Let’s make sweets of a fancy shape that is a loop of chocolate.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/e2a9zq60.png)\n\nFigure A.1. A loop of chocolate formed by a union of six spheres\n:::\n\nThe shape of a loop is formed by a union of a number of spheres of the same size, where every sphere intersects with exactly two others.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/zvv4ztdp.png)\n\n(a) Union of four spheres \n(b) Four intersections of the four spheres in (a)\n\nFigure A.2. A loop of chocolate formed by a union of four spheres\n:::\n\nYour job is to write a program that, for given the size and the positions of spheres, computes the total volume of the union of the spheres, i.e., the amount of chocolate required for filling the loop formed by the union.\n\n[Hints] Two spheres of the same radius $r$ intersect each other when the distance between their centers, $d$, is less than $2r$. The volume of the intersection is known to be\n\n$$\n\\frac{2}{3}\\pi(r - d/2)^2(2r + d/2).\n$$\n\nThe volume of the sphere of radius $r$ is $4\\pi r^3/3$.", "inputFormat": "The input consists of a single test case of the following format.\n\n$$\n\\begin{aligned}\n&n\\ r \\\\\n&x_1\\ y_1\\ z_1 \\\\\n&\\vdots \\\\\n&x_n\\ y_n\\ z_n\n\\end{aligned}\n$$\n\n$n$ and $r$ are integers. $n$ is the number of spheres ($4 \\leq n \\leq 100$). All the spheres have the same radius $r$ ($2 \\leq r \\leq 100$). $(x_k, y_k, z_k)$ indicates the coordinates of the center of the $k$-th sphere ($k = 1, \\dots, n$). All of $x_k$, $y_k$, and $z_k$ are integers between $-100$ and $100$, inclusive.\n\nThe $k$-th and the $k+1$-th spheres intersect each other for $1 \\leq k < n$. The 1-th and the $n$-th spheres also intersect. No other pairs of spheres intersect.", "outputFormat": "Output in a line the volume of the union of the spheres. Relative error of the output should be within $10^{-7}$.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2021 Yokohama R] Loop of Chocolate", "background": "", "description": "Let’s make sweets of a fancy shape that is a loop of chocolate.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/e2a9zq60.png)\n\nFigure A.1. A loop of chocolate formed by a union of six spheres\n:::\n\nThe shape of a loop is formed by a union of a number of spheres of the same size, where every sphere intersects with exactly two others.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/zvv4ztdp.png)\n\n(a) Union of four spheres \n(b) Four intersections of the four spheres in (a)\n\nFigure A.2. A loop of chocolate formed by a union of four spheres\n:::\n\nYour job is to write a program that, for given the size and the positions of spheres, computes the total volume of the union of the spheres, i.e., the amount of chocolate required for filling the loop formed by the union.\n\n[Hints] Two spheres of the same radius $r$ intersect each other when the distance between their centers, $d$, is less than $2r$. The volume of the intersection is known to be\n\n$$\n\\frac{2}{3}\\pi(r - d/2)^2(2r + d/2).\n$$\n\nThe volume of the sphere of radius $r$ is $4\\pi r^3/3$.", "inputFormat": "The input consists of a single test case of the following format.\n\n$$\n\\begin{aligned}\n&n\\ r \\\\\n&x_1\\ y_1\\ z_1 \\\\\n&\\vdots \\\\\n&x_n\\ y_n\\ z_n\n\\end{aligned}\n$$\n\n$n$ and $r$ are integers. $n$ is the number of spheres ($4 \\leq n \\leq 100$). All the spheres have the same radius $r$ ($2 \\leq r \\leq 100$). $(x_k, y_k, z_k)$ indicates the coordinates of the center of the $k$-th sphere ($k = 1, \\dots, n$). All of $x_k$, $y_k$, and $z_k$ are integers between $-100$ and $100$, inclusive.\n\nThe $k$-th and the $k+1$-th spheres intersect each other for $1 \\leq k < n$. The 1-th and the $n$-th spheres also intersect. No other pairs of spheres intersect.", "outputFormat": "Output in a line the volume of the union of the spheres. Relative error of the output should be within $10^{-7}$.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2021 Yokohama R] Loop of Chocolate", "background": "", "description": "让我们制作一种形状别致的糖果——巧克力环。\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/e2a9zq60.png)\n\n图 A.1. 由六个球体的并集形成的巧克力环\n:::\n\n环的形状由若干个相同大小的球体的并集形成，其中每个球体恰好与另外两个球体相交。\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/zvv4ztdp.png)\n\n(a) 四个球体的并集\n(b) (a) 中四个球体的四个交集\n\n图 A.2. 由四个球体的并集形成的巧克力环\n:::\n\n你的任务是编写一个程序，根据给定的球体大小和位置，计算这些球体并集的总体积，即填充该并集所形成的环所需的巧克力量。\n\n[提示] 两个相同半径 $r$ 的球体，当它们的中心距离 $d$ 小于 $2r$ 时相交。已知相交部分的体积为\n\n$$\n\\frac{2}{3}\\pi(r - d/2)^2(2r + d/2).\n$$\n\n半径为 $r$ 的球体体积为 $4\\pi r^3/3$。\n", "inputFormat": "输入由单个测试用例组成，格式如下。\n\n$$\n\\begin{aligned}\n&n\\ r \\\\\n&x_1\\ y_1\\ z_1 \\\\\n&\\vdots \\\\\n&x_n\\ y_n\\ z_n\n\\end{aligned}\n$$\n\n$n$ 和 $r$ 是整数。$n$ 是球体的数量 ($4 \\leq n \\leq 100$)。所有球体具有相同的半径 $r$ ($2 \\leq r \\leq 100$)。$(x_k, y_k, z_k)$ 表示第 $k$ 个球体 ($k = 1, \\dots, n$) 中心的坐标。$x_k$、$y_k$、$z_k$ 均为介于 $-100$ 到 $100$ 之间（含）的整数。\n\n对于 $1 \\leq k < n$，第 $k$ 个和第 $k+1$ 个球体相交。第 $1$ 个和第 $n$ 个球体也相交。没有其他球体对相交。", "outputFormat": "在一行中输出球体并集的体积。输出的相对误差应在 $10^{-7}$ 以内。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P14854", "type": "P", "difficulty": 2, "samples": [["7\n034207\n924837\n372745\n382947\n274637\n083907\n294837", "309500"], ["10\n012389\n456789\n234589\n678989\n890189\n567889\n123489\n263784\n901289\n345689", "304500"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["贪心", "2021", "枚举", "ICPC", "横浜"], "title": "[ICPC 2021 Yokohama R] Lottery Fun Time", "background": "", "description": ":::align{right}\n![](https://cdn.luogu.com.cn/upload/image_hosting/lm75f05j.png)\n:::\n\nThe biggest fun of lottery is not in receiving the (usually a tiny amount of) prize money, but in dreaming of the big fortune you may possibly (that is, virtually never) receive.\n\nYou have a number of lottery tickets at hand, each with a six-digit number. All the numbers are different, of course. Tomorrow is the drawing day and the prizes are the following.\n\n- The first prize of $300,000$ yen is won by the ticket with exact match of all the six digits with the six-digit first prize winning number.\n- The second prizes of $4,000$ yen are won by all of the tickets with their last four digits matching the four-digit second prize winning number.\n- The third prizes of $500$ yen are won by all of the tickets with their last two digits matching any of the three two-digit third prize winning numbers.\n\nThe six digits on the lottery tickets and all of the winning numbers may start with zeros.\n\nThe last two digits of all the prize winning numbers are made different so that tickets winning the third prize cannot also win the first nor the second prizes. Note that this rule also made the last two digits of the first and the second prize winning numbers different.\n\nTo enjoy the climax of the lottery fun time, you decided to calculate the possible maximum amount you may win with your tickets. You have too many tickets to hand-calculate it, but it should also be your joy to write a program for making the calculation.", "inputFormat": "The first line of the input has a positive integer $n$ ($n \\leq 10^5$), which is the number of tickets you have at hand. Each of the following $n$ lines has the six-digit number on one of your tickets. All the $n$ numbers are different from one another.", "outputFormat": "Output in a line a single integer, which is the maximum possible total of winning prizes with the tickets you have.", "hint": "For the first sample, the following combination of prize winners allows the maximum total amount of $309500$ yen.\n\n- The first prize winner of $382947$ makes one ticket with that number win $300000$ yen.\n- The second prize winner of $4837$ makes two tickets, $924837$ and $294837$, win $4000$ yen each.\n- The third prize winners $07$ and $45$ make three tickets, $034207$, $083907$, and $372745$, win $500$ yen each. $37$ cannot be a third prize winner, as the second prize winner, $4837$, has the final two digits of $37$. The ticket $274637$, thus, wins nothing. You have no more tickets to win whatever the remaining third prize winner may be.\n\nFor the second sample, nine out of the ten tickets have the same last two digits, $89$, and thus the third prize winner of $89$ allows nine third prizes, totaling $4500$ yen. This is more than the second prize of $4000$ yen possibly won by one of these nine tickets. The only remaining ticket $263784$ should, of course, win the first prize.\n", "locale": "en", "translations": {"en": {"title": "[ICPC 2021 Yokohama R] Lottery Fun Time", "background": "", "description": ":::align{right}\n![](https://cdn.luogu.com.cn/upload/image_hosting/lm75f05j.png)\n:::\n\nThe biggest fun of lottery is not in receiving the (usually a tiny amount of) prize money, but in dreaming of the big fortune you may possibly (that is, virtually never) receive.\n\nYou have a number of lottery tickets at hand, each with a six-digit number. All the numbers are different, of course. Tomorrow is the drawing day and the prizes are the following.\n\n- The first prize of $300,000$ yen is won by the ticket with exact match of all the six digits with the six-digit first prize winning number.\n- The second prizes of $4,000$ yen are won by all of the tickets with their last four digits matching the four-digit second prize winning number.\n- The third prizes of $500$ yen are won by all of the tickets with their last two digits matching any of the three two-digit third prize winning numbers.\n\nThe six digits on the lottery tickets and all of the winning numbers may start with zeros.\n\nThe last two digits of all the prize winning numbers are made different so that tickets winning the third prize cannot also win the first nor the second prizes. Note that this rule also made the last two digits of the first and the second prize winning numbers different.\n\nTo enjoy the climax of the lottery fun time, you decided to calculate the possible maximum amount you may win with your tickets. You have too many tickets to hand-calculate it, but it should also be your joy to write a program for making the calculation.", "inputFormat": "The first line of the input has a positive integer $n$ ($n \\leq 10^5$), which is the number of tickets you have at hand. Each of the following $n$ lines has the six-digit number on one of your tickets. All the $n$ numbers are different from one another.", "outputFormat": "Output in a line a single integer, which is the maximum possible total of winning prizes with the tickets you have.", "hint": "For the first sample, the following combination of prize winners allows the maximum total amount of $309500$ yen.\n\n- The first prize winner of $382947$ makes one ticket with that number win $300000$ yen.\n- The second prize winner of $4837$ makes two tickets, $924837$ and $294837$, win $4000$ yen each.\n- The third prize winners $07$ and $45$ make three tickets, $034207$, $083907$, and $372745$, win $500$ yen each. $37$ cannot be a third prize winner, as the second prize winner, $4837$, has the final two digits of $37$. The ticket $274637$, thus, wins nothing. You have no more tickets to win whatever the remaining third prize winner may be.\n\nFor the second sample, nine out of the ten tickets have the same last two digits, $89$, and thus the third prize winner of $89$ allows nine third prizes, totaling $4500$ yen. This is more than the second prize of $4000$ yen possibly won by one of these nine tickets. The only remaining ticket $263784$ should, of course, win the first prize.\n", "locale": "en"}, "zh-CN": {"title": "[ICPC 2021 Yokohama R] Lottery Fun Time", "background": "", "description": ":::align{right}\n![](https://cdn.luogu.com.cn/upload/image_hosting/lm75f05j.png)\n:::\n\n彩票最大的乐趣不在于获得（通常是微薄的）奖金，而在于梦想着你可能（实际上几乎永远不会）获得的大笔财富。\n\n你手头有一些彩票，每张上面都有一个六位数。当然，所有数字都各不相同。明天是开奖日，奖项设置如下：\n\n- 一等奖 $300,000$ 日元：彩票上的六位数字与一等奖中奖号码的六位数字完全匹配。\n- 二等奖 $4,000$ 日元：彩票上的最后四位数字与二等奖中奖号码的四位数字匹配。\n- 三等奖 $500$ 日元：彩票上的最后两位数字与三个三等奖中奖号码中的任意一个两位数字匹配。\n\n彩票上的六位数字以及所有中奖号码都可能以 $0$ 开头。\n\n所有中奖号码的最后两位数字都不同，以确保获得三等奖的彩票不能再同时获得一等奖或二等奖。注意，这条规则也使得一等奖和二等奖中奖号码的最后两位数字不同。\n\n为了享受彩票乐趣的高潮，你决定计算你手头的彩票可能赢得的最高金额。你的彩票太多，无法手工计算，但编写一个程序来计算也应该是你的乐趣。", "inputFormat": "输入的第一行是一个正整数 $n$ ($n \\leq 10^5$)，表示你手头的彩票数量。接下来的 $n$ 行，每行有一张彩票上的六位数字。所有 $n$ 个数字互不相同。", "outputFormat": "输出一行一个整数，表示你手头的彩票可能赢得的最高总奖金。", "hint": "对于第一个样例，以下的中奖组合允许获得 $309500$ 日元的最大总额：\n\n- 一等奖中奖号码 $382947$ 使得一张有该号码的彩票赢得 $300000$ 日元。\n- 二等奖中奖号码 $4837$ 使得两张彩票 $924837$ 和 $294837$ 各赢得 $4000$ 日元。\n- 三等奖中奖号码 $07$ 和 $45$ 使得三张彩票 $034207$、$083907$ 和 $372745$ 各赢得 $500$ 日元。$37$ 不能是三等奖中奖号码，因为二等奖中奖号码 $4837$ 的最后两位是 $37$。因此，彩票 $274637$ 没有中奖。无论剩余的二等奖中奖号码是什么，你都没有更多的彩票可以中奖。\n\n对于第二个样例，十张彩票中有九张的最后两位数字相同，都是 $89$，因此三等奖中奖号码 $89$ 允许获得九个三等奖，总计 $4500$ 日元。这比这九张彩票中任意一张可能获得的二等奖 $4000$ 日元要多。当然，唯一剩下的彩票 $263784$ 应该获得一等奖。\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P14855", "type": "P", "difficulty": 6, "samples": [["00000000000000000", "0015599100"], ["0101010 ", "000122221000"], ["123123123123123123123123123123", "01020336699993302010"], ["123456789", "010203040506070809908070605040302010"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2021", "广度优先搜索 BFS", "ICPC", "横浜"], "title": "[ICPC 2021 Yokohama R] Reversible Compression", "background": "", "description": "Data compression is an essential technology in our information society. It is to encode a given string into a (preferably) more compact code string so that it can be stored and/or transferred efficiently.\n\nYou are asked to design a novel compression algorithm such that even a code string is **reversed** it can be decoded into the given string.\n\nCurrently, you are considering the following specification as a candidate.\n\n- A given string is a sequence of decimal digits, namely, $0, 1, 2, 3, 4, 5, 6, 7, 8,$ and $9$.\n- A code string is a sequence of code words, and a code word consists of two decimal digits $A$ and $L$. So, a code string is a sequence of even number of decimal digits.\n- A code string $A_1L_1 \\cdots A_kL_k$ is decoded into a string by the following procedure. Here, for brevity, a decimal digit ($A_i$ or $L_i$) is also treated as the single digit decimal integer it represents.\n\n1. $i \\leftarrow 1$  \n2. while ($i$ is not greater than $k$) {  \n3.  if ($A_i$ is zero) { output $L_i$ }  \n4.  else if ($L_i$ is zero) { do nothing }  \n5.  else if ($A_i$ is larger than the number of digits output so far) { raise an error }  \n6.  else {  \n7.    repeat $L_i$ times {  \n8.      output the $A_i$-th of the already output digits counted backwards  \n9.    }  \n10.  }  \n11.  $i \\leftarrow i + 1$  \n12. }  \n\nFor example, a code string $00125$ is decoded into a string $0101010$ as follows:\n\n1. The first code word $00$ outputs $0$.\n2. The second code word $01$ outputs $1$.\n3. The first digit $2$ of the last code word $25$ means that the second digit in the already decoded digits, counted backwards, should be output. This should be repeated five times. For the first repetition, the decoded digits so far are $0$ and $1$, and thus the second last digit is $0$, which is output. For the second repetition, digits decoded so far are $0, 1,$ and $0$, and the second last is $1$, which is output. Repeating this three more times outputs $0, 1,$ and $0$.\n\nA sequence of code words that raises no error is a valid code string. A valid code string is said to be **reversible** when its reverse is also valid and both the original and its reverse are decoded into the same string.\n\nFor example, the code string $00125$ is not reversible, because its reverse, $521000$, raises an error and thus is not valid. The code string $0010$ is not reversible though its reverse is valid. It is decoded into $0$, but its reverse $0100$ is decoded into $10$. On the other hand, $0015599100$ is reversible, because this and its reverse, $0019955100$, are both decoded into $0000000000000000$.\n\nYou want to evaluate the performance of this compression method when applied to a variety of cases. Your task is to write a program that, for an arbitrary given digit string, finds the shortest reversible code string that is decoded into the given string.\n", "inputFormat": "The input consists of a single line containing a non-empty string $s$ of decimal digits. The length of $s$ does not exceed $500$.\n", "outputFormat": "Output the shortest reversible code string that is decoded into $s$. If there are multiple solutions with the same shortest length, output the earliest in the lexicographic order. Note that it is easily shown that a reversible code string always exists for any input string (e.g., see Sample Output 4).", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2021 Yokohama R] Reversible Compression", "background": "", "description": "Data compression is an essential technology in our information society. It is to encode a given string into a (preferably) more compact code string so that it can be stored and/or transferred efficiently.\n\nYou are asked to design a novel compression algorithm such that even a code string is **reversed** it can be decoded into the given string.\n\nCurrently, you are considering the following specification as a candidate.\n\n- A given string is a sequence of decimal digits, namely, $0, 1, 2, 3, 4, 5, 6, 7, 8,$ and $9$.\n- A code string is a sequence of code words, and a code word consists of two decimal digits $A$ and $L$. So, a code string is a sequence of even number of decimal digits.\n- A code string $A_1L_1 \\cdots A_kL_k$ is decoded into a string by the following procedure. Here, for brevity, a decimal digit ($A_i$ or $L_i$) is also treated as the single digit decimal integer it represents.\n\n1. $i \\leftarrow 1$  \n2. while ($i$ is not greater than $k$) {  \n3.  if ($A_i$ is zero) { output $L_i$ }  \n4.  else if ($L_i$ is zero) { do nothing }  \n5.  else if ($A_i$ is larger than the number of digits output so far) { raise an error }  \n6.  else {  \n7.    repeat $L_i$ times {  \n8.      output the $A_i$-th of the already output digits counted backwards  \n9.    }  \n10.  }  \n11.  $i \\leftarrow i + 1$  \n12. }  \n\nFor example, a code string $00125$ is decoded into a string $0101010$ as follows:\n\n1. The first code word $00$ outputs $0$.\n2. The second code word $01$ outputs $1$.\n3. The first digit $2$ of the last code word $25$ means that the second digit in the already decoded digits, counted backwards, should be output. This should be repeated five times. For the first repetition, the decoded digits so far are $0$ and $1$, and thus the second last digit is $0$, which is output. For the second repetition, digits decoded so far are $0, 1,$ and $0$, and the second last is $1$, which is output. Repeating this three more times outputs $0, 1,$ and $0$.\n\nA sequence of code words that raises no error is a valid code string. A valid code string is said to be **reversible** when its reverse is also valid and both the original and its reverse are decoded into the same string.\n\nFor example, the code string $00125$ is not reversible, because its reverse, $521000$, raises an error and thus is not valid. The code string $0010$ is not reversible though its reverse is valid. It is decoded into $0$, but its reverse $0100$ is decoded into $10$. On the other hand, $0015599100$ is reversible, because this and its reverse, $0019955100$, are both decoded into $0000000000000000$.\n\nYou want to evaluate the performance of this compression method when applied to a variety of cases. Your task is to write a program that, for an arbitrary given digit string, finds the shortest reversible code string that is decoded into the given string.\n", "inputFormat": "The input consists of a single line containing a non-empty string $s$ of decimal digits. The length of $s$ does not exceed $500$.\n", "outputFormat": "Output the shortest reversible code string that is decoded into $s$. If there are multiple solutions with the same shortest length, output the earliest in the lexicographic order. Note that it is easily shown that a reversible code string always exists for any input string (e.g., see Sample Output 4).", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2021 Yokohama R] Reversible Compression", "background": "", "description": "数据压缩是我们信息社会中的一项关键技术。它旨在将给定的字符串编码成（最好是）更紧凑的代码字符串，以便高效存储和/或传输。\n\n你需要设计一种新颖的压缩算法，使得即使代码字符串被 **反转**，也能解码成给定的字符串。\n\n目前，你正在考虑以下规范作为一个候选方案。\n\n- 给定的字符串是一个十进制数字序列，即 $0, 1, 2, 3, 4, 5, 6, 7, 8,$ 和 $9$。\n- 代码字符串是一个码字的序列，每个码字由两个十进制数字 $A$ 和 $L$ 组成。因此，代码字符串是一个由偶数个十进制数字组成的序列。\n- 代码字符串 $A_1L_1 \\cdots A_kL_k$ 通过以下过程解码为一个字符串。这里，为简洁起见，十进制数字（$A_i$ 或 $L_i$）也被视为其表示的单个十进制整数。\n\n1. $i \\leftarrow 1$  \n2. while ($i$ 不大于 $k$) {  \n3.  if ($A_i$ 为零) { 输出 $L_i$ }  \n4.  else if ($L_i$ 为零) { 不执行任何操作 }  \n5.  else if ($A_i$ 大于目前已输出的数字个数) { 引发错误 }  \n6.  else {  \n7.    重复 $L_i$ 次 {  \n8.      输出倒数第 $A_i$ 个已输出的数字  \n9.    }  \n10.  }  \n11.  $i \\leftarrow i + 1$  \n12. }  \n\n例如，代码字符串 $00125$ 被解码为字符串 $0101010$，过程如下：\n\n1. 第一个码字 $00$ 输出 $0$。\n2. 第二个码字 $01$ 输出 $1$。\n3. 最后一个码字 $25$ 的第一个数字 $2$ 表示应输出已解码数字中倒数第二个数字，并重复五次。第一次重复时，到目前为止解码的数字是 $0$ 和 $1$，因此倒数第二个数字是 $0$，将其输出。第二次重复时，到目前为止解码的数字是 $0, 1,$ 和 $0$，倒数第二个是 $1$，将其输出。再重复三次，输出 $0, 1,$ 和 $0$。\n\n不引发错误的码字序列是一个有效的代码字符串。如果一个有效的代码字符串的反转也是有效的，并且原始字符串及其反转都被解码成相同的字符串，则称该代码字符串是 **可逆的**。\n\n例如，代码字符串 $00125$ 不是可逆的，因为它的反转 $521000$ 会引发错误，因此无效。代码字符串 $0010$ 虽然其反转有效，但也不是可逆的。它被解码为 $0$，但其反转 $0100$ 被解码为 $10$。另一方面，$0015599100$ 是可逆的，因为该字符串及其反转 $0019955100$ 都被解码为 $0000000000000000$。\n\n你希望评估这种压缩方法在多种情况下的性能。你的任务是编写一个程序，对于任意给定的数字字符串，找出解码成给定字符串的最短可逆代码字符串。", "inputFormat": "输入包含一行，是一个非空的十进制数字字符串 $s$。$s$ 的长度不超过 $500$。\n", "outputFormat": "输出解码成 $s$ 的最短可逆代码字符串。如果有多个相同最短长度的解决方案，则输出字典序最早的那个。注意，可以很容易证明对于任何输入字符串，总是存在一个可逆代码字符串（例如，参见样例输出 4）。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P14856", "type": "P", "difficulty": 4, "samples": [["8\n1\n8\n2\n3\n5\n4\n6\n7", "6"], ["4\n1\n2\n3\n4", "3"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2021", "树的直径", "ICPC", "横浜"], "title": "[ICPC 2021 Yokohama R] Wireless Communication Network", "background": "", "description": "We are setting up a wireless communication network in a mountain range. Communication stations are to be located on the summits. The summits are on a straight line and have different altitudes.\n\nTo minimize the cost, our communication network should have a tree structure, which is a connected graph with the least number of edges. The structure of the network, that is, which stations to communicate with which other stations, should be decided in advance.\n\nWe construct the communication network as follows.\n\n1. Initially, each station forms a tree consisting of only that station.\n2. In each step, we merge two trees that are adjacent by making a link between two stations in different trees. Two trees are called **adjacent** when all the summits in between a summit in one tree and a summit in the other belong to one of these two trees. Stations to link are those on the highest summits of the two trees; they are uniquely determined because the altitudes of the summits are distinct.\n3. Repeat the step 2 until all the stations are connected, directly or indirectly.\n\nFigure D.1 depicts an example of the tree formation for Sample 1.\n\nWhen a station detects an emergency event, an alert message should be broadcast to all the stations. On receiving a message, each station relays the message to all the stations with direct links, except for one from which it has come. The diameter of the network, that is, how many hops are sufficient to distribute messages initiated at any stations, depends on the choice of the two trees in the step 2 above.\n\nTo estimate the worst case delay of broadcast, we want to find the largest diameter of the network possibly constructed by the above procedure.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/nynbd364.png)\n\nFigure D.1. The tree formation for Sample 1\n:::\n\nObtained after some repetitions of step 2 with a certain series of choices. There are three trees, $T_1$, $T_2$, and $T_3$. Here, the station $h$ forms the tree $T_3$ consisting of only the station $h$.\n\nObtained by linking stations $g$ and $h$ in step 2. Trees $T_2$ and $T_3$, with top summits $g$ and $h$ respectively, are adjacent.\n\nObtained by linking stations $b$ and $h$ in the next step 2, merging two adjacent trees. Now all the stations form a single tree.\n", "inputFormat": "The input consists of a single test case of the following format.\n\n$$n$$  \n$$h_1$$  \n$$\\vdots$$  \n$$h_n$$\n\nHere, $n$ is the number of communication stations ($3 \\leq n \\leq 10^6$), and $h_i$ is an integer representing the altitude of the $i$-th station ($1 \\leq h_i \\leq n$). The altitudes of the stations are distinct, that is, $h_i \\ne h_j$ if $i \\ne j$.\n", "outputFormat": "Output in a line a single integer representing the largest possible diameter of the tree.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2021 Yokohama R] Wireless Communication Network", "background": "", "description": "We are setting up a wireless communication network in a mountain range. Communication stations are to be located on the summits. The summits are on a straight line and have different altitudes.\n\nTo minimize the cost, our communication network should have a tree structure, which is a connected graph with the least number of edges. The structure of the network, that is, which stations to communicate with which other stations, should be decided in advance.\n\nWe construct the communication network as follows.\n\n1. Initially, each station forms a tree consisting of only that station.\n2. In each step, we merge two trees that are adjacent by making a link between two stations in different trees. Two trees are called **adjacent** when all the summits in between a summit in one tree and a summit in the other belong to one of these two trees. Stations to link are those on the highest summits of the two trees; they are uniquely determined because the altitudes of the summits are distinct.\n3. Repeat the step 2 until all the stations are connected, directly or indirectly.\n\nFigure D.1 depicts an example of the tree formation for Sample 1.\n\nWhen a station detects an emergency event, an alert message should be broadcast to all the stations. On receiving a message, each station relays the message to all the stations with direct links, except for one from which it has come. The diameter of the network, that is, how many hops are sufficient to distribute messages initiated at any stations, depends on the choice of the two trees in the step 2 above.\n\nTo estimate the worst case delay of broadcast, we want to find the largest diameter of the network possibly constructed by the above procedure.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/nynbd364.png)\n\nFigure D.1. The tree formation for Sample 1\n:::\n\nObtained after some repetitions of step 2 with a certain series of choices. There are three trees, $T_1$, $T_2$, and $T_3$. Here, the station $h$ forms the tree $T_3$ consisting of only the station $h$.\n\nObtained by linking stations $g$ and $h$ in step 2. Trees $T_2$ and $T_3$, with top summits $g$ and $h$ respectively, are adjacent.\n\nObtained by linking stations $b$ and $h$ in the next step 2, merging two adjacent trees. Now all the stations form a single tree.\n", "inputFormat": "The input consists of a single test case of the following format.\n\n$$n$$  \n$$h_1$$  \n$$\\vdots$$  \n$$h_n$$\n\nHere, $n$ is the number of communication stations ($3 \\leq n \\leq 10^6$), and $h_i$ is an integer representing the altitude of the $i$-th station ($1 \\leq h_i \\leq n$). The altitudes of the stations are distinct, that is, $h_i \\ne h_j$ if $i \\ne j$.\n", "outputFormat": "Output in a line a single integer representing the largest possible diameter of the tree.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2021 Yokohama R] Wireless Communication Network", "background": "", "description": "我们正在一个山脉地区建立无线通信网络。通信站将设立在各个山顶上。这些山顶位于一条直线上，且海拔各不相同。\n\n为了最小化成本，我们的通信网络应具有树形结构，即具有最少边数的连通图。网络的结构，也就是哪些站与哪些其他站通信，应事先确定。\n\n我们按以下步骤构建通信网络：\n\n1. 初始时，每个站自成一棵树，仅包含该站。\n2. 在每一步，我们通过在不同树中的两个站之间建立一条链路来合并两棵相邻的树。当一棵树中的一个山顶与另一棵树中的一个山顶之间的所有山顶都属于这两棵树之一时，称这两棵树 **相邻**。要建立链路的站是这两棵树中海拔最高的山顶上的站；由于山顶的海拔各不相同，这些站是唯一确定的。\n3. 重复步骤 2，直到所有站都直接或间接地连接起来。\n\n图 D.1 展示了样例 1 的树形结构形成示例。\n\n当一个站检测到紧急事件时，应广播警报消息给所有站。接收到消息后，每个站会将消息转发给所有与其有直接链路的站，除了消息来源的那个站。网络的直径，即从任意站发起消息传播所需的足够跳数，取决于上述步骤 2 中对两棵树的选择。\n\n为了估计广播的最坏情况延迟，我们希望找出通过上述过程可能构建的网络的**最大直径**。\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/nynbd364.png)\n\n图 D.1. 样例 1 的树形结构形成\n:::\n\n经过特定一系列选择重复步骤 2 后得到的结果。此时有三棵树：$T_1$、$T_2$ 和 $T_3$。这里，站 $h$ 形成了仅包含该站的树 $T_3$。\n\n通过在步骤 2 中连接站 $g$ 和 $h$ 得到的结果。树 $T_2$（最高山顶 $g$）和 $T_3$（最高山顶 $h$）是相邻的。\n\n通过在下一步步骤 2 中连接站 $b$ 和 $h$ 合并两棵相邻的树后得到的结果。现在所有站形成了一棵树。", "inputFormat": "输入由单个测试用例组成，格式如下。\n\n$$n$$  \n$$h_1$$  \n$$\\vdots$$  \n$$h_n$$\n\n这里，$n$ 是通信站的数量 ($3 \\leq n \\leq 10^6$)，$h_i$ 是一个整数，表示第 $i$ 个站的海拔 ($1 \\leq h_i \\leq n$)。各站的海拔互不相同，即如果 $i \\ne j$，则 $h_i \\ne h_j$。\n", "outputFormat": "输出一行一个整数，表示树可能的最大直径。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P14857", "type": "P", "difficulty": 7, "samples": [["2 1\n0 1 3\n3\n6 1\n4 2\n5 3\n1\n1", "24"], ["3 3\n0 1 7\n1 2 8\n2 0 5\n4\n8 1\n5 1\n9 3\n7 3\n2\n1\n2", "76"], ["5 8\n0 1 1\n2 1 2\n4 0 5\n3 4 7\n3 2 8\n0 2 4\n4 1 3\n2 4 6\n6\n3 2\n9 3\n7 1\n5 3\n3 2\n5 2\n4\n0\n2\n3\n4", "120"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2021", "生成树", "ICPC", "横浜"], "title": "[ICPC 2021 Yokohama R] Planning Railroad Discontinuation", "background": "", "description": "The ICPC Kingdom has a large round lake in its center, and all of its cities are developed around the lake, forming a circle of cities. Because all of them are developed under the same urban plan, the cities are made quite similar. They have exactly the same subway networks. Some of their stations are also stations of inter-city bullet trains connecting two corresponding stations of adjacent cities. All of the train routes provide two-way traffic between two terminal stations without any intermediate stations.\n\nThe cities have the same number of subway stations and subway routes. In each city, the stations are numbered sequentially as $0, 1, 2, \\dots$. Whether two stations in a city are connected by a subway route depends only on their station numbers and not on the city. If a station $v$ is connected to a station $u$ in one city, so is in all the other cities. The travel distance between two stations $v$ and $u$ are the same for all the cities.\n\nAll the cities have exactly the same list of station numbers of bullet train stations. If a station $s$ is a bullet train station in one city, so is in all the other cities. All the pairs of two bullet train stations of the same station number in two adjacent cities are connected by a bullet train route. If a station $s$ is one end of a bullet train route, the station $s$ in an adjacent city is the other end. There exist no other bullet train routes. One can travel between any two stations in the Kingdom via one or more subway and/or bullet train services.\n\nDue to financial difficulties in recent years, the Kingdom plans to discontinue some of the subway and bullet train services to reduce the maintenance cost of the railroad system. The maintenance cost is the sum of maintenance costs of the subway routes and the bullet train routes. The maintenance cost of a subway route is the sum of base cost depending on the city and cost proportional to the travel distance of the route. The maintenance cost of a bullet train route depends only on the two cities connected by the route.\n\nYou are asked to make a plan to discontinue some of the routes that minimizes the total maintenance cost. Of course, all the pairs of the stations in the Kingdom should still be connected through one or more subway and/or bullet train services after the discontinuation.", "inputFormat": "The input consists of a single test case of the following format.\n\n$$\n\\begin{aligned}\n&n\\ m \\\\\n&v_1\\ u_1\\ d_1 \\\\\n&\\vdots \\\\\n&v_m\\ u_m\\ d_m \\\\\n&l \\\\\n&a_0\\ b_0 \\\\\n&\\vdots \\\\\n&a_{l-1}\\ b_{l-1} \\\\\n&r \\\\\n&s_1 \\\\\n&\\vdots \\\\\n&s_r\n\\end{aligned}\n$$\n\nHere, $n$ is an integer satisfying $2 \\leq n \\leq 10^4$, which is the number of the subway stations in a city. The stations in each city are numbered from $0$ to $n-1$. $m$ is an integer satisfying $1 \\leq m \\leq 10^5$, which is the number of the subway routes in a city. The following $m$ lines are information on the subway system in a city. The $i$-th of the $m$ lines has three integers $v_i$, $u_i$, and $d_i$, satisfying $0 \\leq v_i < n$, $0 \\leq u_i < n$, $v_i \\ne u_i$, and $1 \\leq d_i \\leq 10^9$. They mean that a subway route connects stations numbered $v_i$ and $u_i$, and its maintenance cost proportional to the travel distance is $d_i$. There is at most one subway route between two stations. All the subway stations in a city are connected directly or indirectly via one or more subway routes.\n\n$l$ in the next line is an integer satisfying $3 \\leq l \\leq 10^5$, which is the number of cities in the Kingdom. The cities are numbered from $0$ to $l-1$, and the city $0$ is also called the city $l$. For each $0 \\leq j \\leq l-1$, the cities $j$ and $j+1$ are adjacent. $a_j$ and $b_j$ in the following $l$ lines are integers satisfying $1 \\leq a_j \\leq 10^9$ and $1 \\leq b_j \\leq 10^9$. $a_j$ is the maintenance cost of a bullet train route connecting the cities $j$ and $j+1$. $b_j$ is the base cost of the subway routes in the city $j$.\n\n$r$ is an integer satisfying $1 \\leq r \\leq n$, which is the number of the bullet train stations in each city. $s_1, s_2, \\dots, s_r$ are the station numbers of the bullet train stations in each city.\n", "outputFormat": "Output in a single line the integer representing the minimum maintenance cost of the railroad system after the discontinuation that minimizes the cost while keeping all the stations connected, directly or indirectly.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2021 Yokohama R] Planning Railroad Discontinuation", "background": "", "description": "The ICPC Kingdom has a large round lake in its center, and all of its cities are developed around the lake, forming a circle of cities. Because all of them are developed under the same urban plan, the cities are made quite similar. They have exactly the same subway networks. Some of their stations are also stations of inter-city bullet trains connecting two corresponding stations of adjacent cities. All of the train routes provide two-way traffic between two terminal stations without any intermediate stations.\n\nThe cities have the same number of subway stations and subway routes. In each city, the stations are numbered sequentially as $0, 1, 2, \\dots$. Whether two stations in a city are connected by a subway route depends only on their station numbers and not on the city. If a station $v$ is connected to a station $u$ in one city, so is in all the other cities. The travel distance between two stations $v$ and $u$ are the same for all the cities.\n\nAll the cities have exactly the same list of station numbers of bullet train stations. If a station $s$ is a bullet train station in one city, so is in all the other cities. All the pairs of two bullet train stations of the same station number in two adjacent cities are connected by a bullet train route. If a station $s$ is one end of a bullet train route, the station $s$ in an adjacent city is the other end. There exist no other bullet train routes. One can travel between any two stations in the Kingdom via one or more subway and/or bullet train services.\n\nDue to financial difficulties in recent years, the Kingdom plans to discontinue some of the subway and bullet train services to reduce the maintenance cost of the railroad system. The maintenance cost is the sum of maintenance costs of the subway routes and the bullet train routes. The maintenance cost of a subway route is the sum of base cost depending on the city and cost proportional to the travel distance of the route. The maintenance cost of a bullet train route depends only on the two cities connected by the route.\n\nYou are asked to make a plan to discontinue some of the routes that minimizes the total maintenance cost. Of course, all the pairs of the stations in the Kingdom should still be connected through one or more subway and/or bullet train services after the discontinuation.", "inputFormat": "The input consists of a single test case of the following format.\n\n$$\n\\begin{aligned}\n&n\\ m \\\\\n&v_1\\ u_1\\ d_1 \\\\\n&\\vdots \\\\\n&v_m\\ u_m\\ d_m \\\\\n&l \\\\\n&a_0\\ b_0 \\\\\n&\\vdots \\\\\n&a_{l-1}\\ b_{l-1} \\\\\n&r \\\\\n&s_1 \\\\\n&\\vdots \\\\\n&s_r\n\\end{aligned}\n$$\n\nHere, $n$ is an integer satisfying $2 \\leq n \\leq 10^4$, which is the number of the subway stations in a city. The stations in each city are numbered from $0$ to $n-1$. $m$ is an integer satisfying $1 \\leq m \\leq 10^5$, which is the number of the subway routes in a city. The following $m$ lines are information on the subway system in a city. The $i$-th of the $m$ lines has three integers $v_i$, $u_i$, and $d_i$, satisfying $0 \\leq v_i < n$, $0 \\leq u_i < n$, $v_i \\ne u_i$, and $1 \\leq d_i \\leq 10^9$. They mean that a subway route connects stations numbered $v_i$ and $u_i$, and its maintenance cost proportional to the travel distance is $d_i$. There is at most one subway route between two stations. All the subway stations in a city are connected directly or indirectly via one or more subway routes.\n\n$l$ in the next line is an integer satisfying $3 \\leq l \\leq 10^5$, which is the number of cities in the Kingdom. The cities are numbered from $0$ to $l-1$, and the city $0$ is also called the city $l$. For each $0 \\leq j \\leq l-1$, the cities $j$ and $j+1$ are adjacent. $a_j$ and $b_j$ in the following $l$ lines are integers satisfying $1 \\leq a_j \\leq 10^9$ and $1 \\leq b_j \\leq 10^9$. $a_j$ is the maintenance cost of a bullet train route connecting the cities $j$ and $j+1$. $b_j$ is the base cost of the subway routes in the city $j$.\n\n$r$ is an integer satisfying $1 \\leq r \\leq n$, which is the number of the bullet train stations in each city. $s_1, s_2, \\dots, s_r$ are the station numbers of the bullet train stations in each city.\n", "outputFormat": "Output in a single line the integer representing the minimum maintenance cost of the railroad system after the discontinuation that minimizes the cost while keeping all the stations connected, directly or indirectly.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2021 Yokohama R] Planning Railroad Discontinuation", "background": "", "description": "ICPC 王国的中心有一个巨大的圆形湖泊，其所有城市都围绕湖泊发展，形成一圈城市。由于所有城市都在相同的城市规划下发展，这些城市非常相似。它们拥有完全相同的地铁网络。其中一些车站也是连接相邻城市对应车站的城际高铁车站。所有列车线路在两个终点站之间提供双向交通，且没有任何中间站。\n\n各个城市拥有相同数量的地铁站和地铁线路。在每个城市中，车站按顺序编号为 $0, 1, 2, \\dots$。一个城市中的两个车站是否通过地铁线路连接，仅取决于它们的车站编号，而不取决于城市。如果一个城市中车站 $v$ 连接到车站 $u$，那么所有其他城市也是如此。任意两个车站 $v$ 和 $u$ 之间的旅行距离对所有城市都是相同的。\n\n所有城市都拥有完全相同的高铁车站编号列表。如果一个城市中车站 $s$ 是高铁车站，那么所有其他城市也是如此。所有相邻城市中相同编号的两个高铁车站之间都通过一条高铁线路连接。如果一个城市中车站 $s$ 是一条高铁线路的一端，那么相邻城市中的车站 $s$ 就是另一端。不存在其他高铁线路。人们可以通过一个或多个地铁和/或高铁服务在王国中的任意两个车站之间旅行。\n\n由于近年来的财政困难，王国计划停运部分地铁和高铁服务，以降低铁路系统的维护成本。维护成本是地铁线路和高铁线路维护成本的总和。一条地铁线路的维护成本包括取决于城市的基础成本和与线路旅行距离成比例的成本。一条高铁线路的维护成本仅取决于该线路连接的两个城市。\n\n你需要制定一个计划，停运部分线路，以最小化总维护成本。当然，停运后，王国中的所有车站对仍应通过一个或多个地铁和/或高铁服务连接。", "inputFormat": "输入由单个测试用例组成，格式如下。\n\n$$\n\\begin{aligned}\n&n\\ m \\\\\n&v_1\\ u_1\\ d_1 \\\\\n&\\vdots \\\\\n&v_m\\ u_m\\ d_m \\\\\n&l \\\\\n&a_0\\ b_0 \\\\\n&\\vdots \\\\\n&a_{l-1}\\ b_{l-1} \\\\\n&r \\\\\n&s_1 \\\\\n&\\vdots \\\\\n&s_r\n\\end{aligned}\n$$\n\n这里，$n$ 是一个满足 $2 \\leq n \\leq 10^4$ 的整数，表示一个城市中的地铁站数量。每个城市中的车站编号从 $0$ 到 $n-1$。$m$ 是一个满足 $1 \\leq m \\leq 10^5$ 的整数，表示一个城市中的地铁线路数量。接下来的 $m$ 行是一个城市地铁系统的信息。$m$ 行中的第 $i$ 行有三个整数 $v_i$、$u_i$ 和 $d_i$，满足 $0 \\leq v_i < n$、$0 \\leq u_i < n$、$v_i \\ne u_i$ 和 $1 \\leq d_i \\leq 10^9$。它们表示一条地铁线路连接编号为 $v_i$ 和 $u_i$ 的车站，其与旅行距离成比例的维护成本为 $d_i$。两个车站之间最多有一条地铁线路。一个城市中的所有地铁站通过一个或多个地铁线路直接或间接连接。\n\n下一行的 $l$ 是一个满足 $3 \\leq l \\leq 10^5$ 的整数，表示王国中的城市数量。城市编号从 $0$ 到 $l-1$，城市 $0$ 也称为城市 $l$。对于每个 $0 \\leq j \\leq l-1$，城市 $j$ 和 $j+1$ 相邻。接下来的 $l$ 行中的 $a_j$ 和 $b_j$ 是满足 $1 \\leq a_j \\leq 10^9$ 和 $1 \\leq b_j \\leq 10^9$ 的整数。$a_j$ 是连接城市 $j$ 和 $j+1$ 的高铁线路的维护成本。$b_j$ 是城市 $j$ 中地铁线路的基础成本。\n\n$r$ 是一个满足 $1 \\leq r \\leq n$ 的整数，表示每个城市中高铁车站的数量。$s_1, s_2, \\dots, s_r$ 是每个城市中高铁车站的编号。", "outputFormat": "输出一行一个整数，表示在保持所有车站直接或间接连接的前提下，通过停运使成本最小化后的铁路系统最小维护成本。\n", "hint": "", "locale": "zh-CN"}}}
{"pid": "P14858", "type": "P", "difficulty": 7, "samples": [["3 1", "2 1"], ["5 5", "0 0"], ["499979 1000000000000000000", "486292 0"]], "limits": {"time": [24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000, 24000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["数学", "2021", "数论", "快速傅里叶变换 FFT", "ICPC", "横浜"], "title": "[ICPC 2021 Yokohama R] It' s Surely Complex", "background": "", "description": "As you know, a complex number is often represented as the sum of a real part and an imaginary part. $3 + 2i$ is such an example, where $3$ is the real part, $2$ is the imaginary part, and $i$ is the imaginary unit.\n\nGiven a prime number $p$ and a positive integer $n$, your program for this problem should output the product of all the complex numbers satisfying the following conditions.\n\n- Both the real part and the imaginary part are non-negative integers less than or equal to $n$.\n- At least one of the real part and the imaginary part is not a multiple of $p$.\n\nFor instance, when $p = 3$ and $n = 1$, the complex numbers satisfying the conditions are $1$ ($= 1 + 0i$), $i$ ($= 0 + 1i$), and $1 + i$ ($= 1 + 1i$), and the product of these numbers, that is, $1 \\times i \\times (1 + i)$ is $-1 + i$.\n", "inputFormat": "The input consists of a single test case of the following format.\n\n$$p\\ n$$\n\n$p$ is a prime number less than $5 \\times 10^5$. $n$ is a positive integer less than or equal to $10^{18}$.\n", "outputFormat": "Output two integers separated by a space in a line. When the product of all the complex numbers satisfying the given conditions is $a + bi$, the first and the second integers should be $a \\bmod p$ and $b \\bmod p$, respectively. Here, $x \\bmod y$ means the integer $z$ between $0$ and $y-1$, inclusive, such that $x - z$ is divisible by $y$.\n\nAs exemplified in the main section, when $p = 3$ and $n = 1$, the product to be calculated is $-1 + i$. However, since $-1 \\bmod 3 = 2$, $2$ and $1$ are displayed in Sample Output 1.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2021 Yokohama R] It' s Surely Complex", "background": "", "description": "As you know, a complex number is often represented as the sum of a real part and an imaginary part. $3 + 2i$ is such an example, where $3$ is the real part, $2$ is the imaginary part, and $i$ is the imaginary unit.\n\nGiven a prime number $p$ and a positive integer $n$, your program for this problem should output the product of all the complex numbers satisfying the following conditions.\n\n- Both the real part and the imaginary part are non-negative integers less than or equal to $n$.\n- At least one of the real part and the imaginary part is not a multiple of $p$.\n\nFor instance, when $p = 3$ and $n = 1$, the complex numbers satisfying the conditions are $1$ ($= 1 + 0i$), $i$ ($= 0 + 1i$), and $1 + i$ ($= 1 + 1i$), and the product of these numbers, that is, $1 \\times i \\times (1 + i)$ is $-1 + i$.\n", "inputFormat": "The input consists of a single test case of the following format.\n\n$$p\\ n$$\n\n$p$ is a prime number less than $5 \\times 10^5$. $n$ is a positive integer less than or equal to $10^{18}$.\n", "outputFormat": "Output two integers separated by a space in a line. When the product of all the complex numbers satisfying the given conditions is $a + bi$, the first and the second integers should be $a \\bmod p$ and $b \\bmod p$, respectively. Here, $x \\bmod y$ means the integer $z$ between $0$ and $y-1$, inclusive, such that $x - z$ is divisible by $y$.\n\nAs exemplified in the main section, when $p = 3$ and $n = 1$, the product to be calculated is $-1 + i$. However, since $-1 \\bmod 3 = 2$, $2$ and $1$ are displayed in Sample Output 1.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2021 Yokohama R] It' s Surely Complex", "background": "", "description": "如你所知，复数通常表示为实部与虚部之和。$3 + 2i$ 就是这样一个例子，其中 $3$ 是实部，$2$ 是虚部，$i$ 是虚数单位。\n\n给定一个质数 $p$ 和一个正整数 $n$，你为本题编写的程序应输出所有满足以下条件的复数的乘积。\n\n- 实部和虚部均为小于或等于 $n$ 的非负整数。\n- 实部和虚部中至少有一个不是 $p$ 的倍数。\n\n例如，当 $p = 3$ 且 $n = 1$ 时，满足条件的复数是 $1$ ($= 1 + 0i$)、$i$ ($= 0 + 1i$) 和 $1 + i$ ($= 1 + 1i$)，这些数的乘积，即 $1 \\times i \\times (1 + i)$，等于 $-1 + i$。", "inputFormat": "输入由单个测试用例组成，格式如下。\n\n$$p\\ n$$\n\n$p$ 是一个小于 $5 \\times 10^5$ 的质数。$n$ 是一个小于或等于 $10^{18}$ 的正整数。", "outputFormat": "在一行中输出两个整数，用一个空格分隔。当满足给定条件的所有复数的乘积为 $a + bi$ 时，第一个和第二个整数应分别为 $a \\bmod p$ 和 $b \\bmod p$。这里，$x \\bmod y$ 表示介于 $0$ 到 $y-1$ 之间（含）的整数 $z$，使得 $x - z$ 能被 $y$ 整除。\n\n如题目描述部分所示，当 $p = 3$ 且 $n = 1$ 时，要计算的乘积是 $-1 + i$。然而，由于 $-1 \\bmod 3 = 2$，因此在样例输出 1 中显示的是 $2$ 和 $1$。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P14859", "type": "P", "difficulty": 5, "samples": [["3\n0 1\n1 2\n0  2", "6"], ["2\n0 2\n1 2", "0"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["动态规划 DP", "2021", "ICPC", "横浜"], "title": "[ICPC 2021 Yokohama R] Genealogy of Puppets", "background": "", "description": "The **Inventive and Creative Puppets Corporation (ICPC)** sells a variety of educational puppets for children, and also for grown-ups who were once children and still remember it. To celebrate its centennial anniversary, ICPC has decided to offer for sale a collection of many of its most popular puppets in its history of one hundred years, which will be a collectors’ envy for sure.\n\nEach puppet has a ring attached to its head, with which it can be hung below one of two toes of another puppet. At most one puppet can be hung on one toe. As puppets do not feel comfortable in handstand positions, loops of puppets should be avoided. A **tree** of puppets can thus be made by hanging all the puppets to a toe of another puppet, leaving the ring of the topmost puppet to be hung on the wall.\n\nYou are enthusiastic in ICPC puppets since childhood. You like imagining genealogies of the puppets, assuming that puppets are hung on a parent puppet. You also imagine personalities of puppets, and decided to obey the following rules on forming the tree:\n\n- each puppet has its own constraints on the number of children, that are its minimum and maximum, and\n- if a puppet has any children, at least one of them should have release date later than the parent.\n\nNote that, if a puppet has two children, one of them may have its release date earlier than the parent.\n\nYou want to write a program to calculate how many **different** trees can be made by the collection, satisfying the rules. Two trees are considered different if any of the puppets are hung on different parents, or hung on different toes of the same parent.\n", "inputFormat": "The input consists of a single test case of the following format.\n\n$$n$$\n\n$$x_1\\ y_1$$\n\n$$\\vdots$$\n\n$$x_n\\ y_n$$\n\nThe first line contains an integer $n$ ($2 \\leq n \\leq 300$), representing the number of puppets. The $i$-th line of the following $n$ lines describes the personality of a puppet. Lines are in the order of the release dates of the puppets, from older to newer. Two integers in the line, $x_i$ and $y_i$, are the minimum number and the maximum number of children of the puppet, respectively. $0 \\leq x_i \\leq y_i \\leq 2$ holds.", "outputFormat": "Output a single integer in a line which is the number of the different trees satisfying the rules modulo $10^9 + 7$.", "hint": "For Sample Input 1, there are 6 possible trees satisfying the rules shown in Figure G.1.\n\nFor Sample Input 2, no trees can satisfy the rules.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/vt5sj79p.png)\n\nFigure G.1. Trees satisfying the rules for Sample Input 1. The numbers on the puppets represent the release order.\n:::", "locale": "en", "translations": {"en": {"title": "[ICPC 2021 Yokohama R] Genealogy of Puppets", "background": "", "description": "The **Inventive and Creative Puppets Corporation (ICPC)** sells a variety of educational puppets for children, and also for grown-ups who were once children and still remember it. To celebrate its centennial anniversary, ICPC has decided to offer for sale a collection of many of its most popular puppets in its history of one hundred years, which will be a collectors’ envy for sure.\n\nEach puppet has a ring attached to its head, with which it can be hung below one of two toes of another puppet. At most one puppet can be hung on one toe. As puppets do not feel comfortable in handstand positions, loops of puppets should be avoided. A **tree** of puppets can thus be made by hanging all the puppets to a toe of another puppet, leaving the ring of the topmost puppet to be hung on the wall.\n\nYou are enthusiastic in ICPC puppets since childhood. You like imagining genealogies of the puppets, assuming that puppets are hung on a parent puppet. You also imagine personalities of puppets, and decided to obey the following rules on forming the tree:\n\n- each puppet has its own constraints on the number of children, that are its minimum and maximum, and\n- if a puppet has any children, at least one of them should have release date later than the parent.\n\nNote that, if a puppet has two children, one of them may have its release date earlier than the parent.\n\nYou want to write a program to calculate how many **different** trees can be made by the collection, satisfying the rules. Two trees are considered different if any of the puppets are hung on different parents, or hung on different toes of the same parent.\n", "inputFormat": "The input consists of a single test case of the following format.\n\n$$n$$\n\n$$x_1\\ y_1$$\n\n$$\\vdots$$\n\n$$x_n\\ y_n$$\n\nThe first line contains an integer $n$ ($2 \\leq n \\leq 300$), representing the number of puppets. The $i$-th line of the following $n$ lines describes the personality of a puppet. Lines are in the order of the release dates of the puppets, from older to newer. Two integers in the line, $x_i$ and $y_i$, are the minimum number and the maximum number of children of the puppet, respectively. $0 \\leq x_i \\leq y_i \\leq 2$ holds.", "outputFormat": "Output a single integer in a line which is the number of the different trees satisfying the rules modulo $10^9 + 7$.", "hint": "For Sample Input 1, there are 6 possible trees satisfying the rules shown in Figure G.1.\n\nFor Sample Input 2, no trees can satisfy the rules.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/vt5sj79p.png)\n\nFigure G.1. Trees satisfying the rules for Sample Input 1. The numbers on the puppets represent the release order.\n:::", "locale": "en"}, "zh-CN": {"title": "[ICPC 2021 Yokohama R] Genealogy of Puppets", "background": "", "description": "**创意与创新木偶公司 (ICPC)** 销售各种教育木偶，面向儿童，也面向那些曾是儿童并依然记得童年时光的成年人。为了庆祝其百年华诞，ICPC 决定发售其百年历史上许多最受欢迎木偶的合集，这无疑将成为收藏家们梦寐以求的珍品。\n\n每个木偶的头部都附有一个环，可以用它将木偶悬挂在另一个木偶的两个脚趾之一下方。一个脚趾最多只能悬挂一个木偶。由于木偶在倒立姿势下会感到不适，应避免形成木偶环。因此，可以通过将所有木偶悬挂在另一个木偶的脚趾上来制作一个木偶 **树**，最顶部的木偶的环则挂在墙上。\n\n你从小就热衷于 ICPC 的木偶。你喜欢想象木偶的家谱，假设木偶被悬挂在一个父木偶上。你还想象木偶的个性，并决定在构建树时遵循以下规则：\n\n- 每个木偶对其子木偶数量有自己的限制，即最小值和最大值；\n- 如果一个木偶有任何子木偶，则其中至少一个子木偶的发售日期应晚于父木偶。\n\n注意，如果一个木偶有两个子木偶，其中一个的发售日期可能早于父木偶。\n\n你想编写一个程序来计算该合集可以制作出多少种 **不同的** 树，且满足上述规则。如果任何木偶悬挂在不同的父木偶上，或悬挂在同一父木偶的不同脚趾上，则认为两棵树是不同的。\n", "inputFormat": "输入由单个测试用例组成，格式如下。\n\n$$n$$\n\n$$x_1\\ y_1$$\n\n$$\\vdots$$\n\n$$x_n\\ y_n$$\n\n第一行包含一个整数 $n$ ($2 \\leq n \\leq 300$)，表示木偶的数量。接下来的 $n$ 行中，第 $i$ 行描述一个木偶的个性。这些行按木偶的发售日期顺序排列，从较早到较晚。该行中的两个整数 $x_i$ 和 $y_i$ 分别是该木偶子木偶数量的最小值和最大值。满足 $0 \\leq x_i \\leq y_i \\leq 2$。\n", "outputFormat": "输出一行一个整数，表示满足规则的不同树的数量，结果对 $10^9 + 7$ 取模。", "hint": "对于样例输入 1，有 6 棵满足规则的树，如图 G.1 所示。\n\n对于样例输入 2，没有树能满足规则。\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/vt5sj79p.png)\n\n图 G.1. 满足样例输入 1 规则的树。木偶上的数字表示发售顺序。\n:::", "locale": "zh-CN"}}}
{"pid": "P14860", "type": "P", "difficulty": 6, "samples": [["3 1\nAC?", "0.0625"], ["6 2\nAC??A?\nA??A?T", "0.0302734375"], ["30 1\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA", "8.673617379884035e-19"]], "limits": {"time": [10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2021", "Special Judge", "随机化", "ICPC", "横浜"], "title": "[ICPC 2021 Yokohama R] Cancer DNA", "background": "", "description": "The **Investigation Center for Potential Cancer (ICPC)** found out patterns of a DNA sequence that cause cancer! We would like you to write a computer program that approximates the probability that a random DNA sequence matches one of the given patterns.\n\nA DNA sequence can be represented by a string consisting of four letters, ‘A’, ‘G’, ‘C’, and ‘T’. A **DNA pattern** is a string over the same four letters plus ‘?’. We say that a DNA pattern *matches* a DNA sequence of the same length if each of the characters in the pattern is either ‘?’ or is the same as the character at the corresponding position in the DNA sequence. For example, a pattern “AC?” matches DNA sequences “ACA”, “ACG”, “ACC”, and “ACT”.\n\nYour task is to write a program that, given a set of DNA patterns of the same length, computes the probability that a uniformly random DNA sequence of the same length matches any of the given patterns. A multiplicative error up to $5\\%$ is permissible.", "inputFormat": "The input consists of a single test case of the following format.\n\n$$n\\ m$$\n\n$$P_1$$\n\n$$\\vdots$$\n\n$$P_m$$\n\nThe first line of the input contains two positive integers $n$ and $m$ such that $1 \\leq n \\leq 100$ and $1 \\leq m \\leq 30$ hold. The next $m$ lines contain $m$ patterns $P_1, \\dots, P_m$. Each pattern $P_i$ is a string of length $n$ over ‘A’, ‘G’, ‘C’, ‘T’, and ‘?’.", "outputFormat": "Let $S$ be a DNA sequence of length $n$ chosen uniformly at random. Let $w$ be the probability that $S$ matches at least one of $P_1, \\dots, P_m$. The output is a real number $v$ that approximates $w$.\n\nThe output $v$ is judged to be correct if $v$ approximates $w$ within a multiplicative error of $5\\%$, i.e.,\n\n$$0.95 \\times w \\leq v \\leq 1.05 \\times w$$\n\n$v$ should be represented either with or without exponent component. For example, $0.045$ can be represented as $4.5\\text{e}-2$ or $0.045$.", "hint": "In the first sample, there are $4^3$ DNA sequences of length 3. There are 4 DNA sequences, “ACA”, “ACG”, “ACC”, and “ACT”, that match the pattern “AC?”. Thus, the probability is $4/4^3 = 0.0625$. Any real number between $0.059375$ and $0.065625$ is accepted as a correct output.\n\nAs in the third sample, the probability can be a small real number. Note that “0” is not a correct output, as $0$ is less than $95\\%$ of the precise probability.\n", "locale": "en", "translations": {"en": {"title": "[ICPC 2021 Yokohama R] Cancer DNA", "background": "", "description": "The **Investigation Center for Potential Cancer (ICPC)** found out patterns of a DNA sequence that cause cancer! We would like you to write a computer program that approximates the probability that a random DNA sequence matches one of the given patterns.\n\nA DNA sequence can be represented by a string consisting of four letters, ‘A’, ‘G’, ‘C’, and ‘T’. A **DNA pattern** is a string over the same four letters plus ‘?’. We say that a DNA pattern *matches* a DNA sequence of the same length if each of the characters in the pattern is either ‘?’ or is the same as the character at the corresponding position in the DNA sequence. For example, a pattern “AC?” matches DNA sequences “ACA”, “ACG”, “ACC”, and “ACT”.\n\nYour task is to write a program that, given a set of DNA patterns of the same length, computes the probability that a uniformly random DNA sequence of the same length matches any of the given patterns. A multiplicative error up to $5\\%$ is permissible.", "inputFormat": "The input consists of a single test case of the following format.\n\n$$n\\ m$$\n\n$$P_1$$\n\n$$\\vdots$$\n\n$$P_m$$\n\nThe first line of the input contains two positive integers $n$ and $m$ such that $1 \\leq n \\leq 100$ and $1 \\leq m \\leq 30$ hold. The next $m$ lines contain $m$ patterns $P_1, \\dots, P_m$. Each pattern $P_i$ is a string of length $n$ over ‘A’, ‘G’, ‘C’, ‘T’, and ‘?’.", "outputFormat": "Let $S$ be a DNA sequence of length $n$ chosen uniformly at random. Let $w$ be the probability that $S$ matches at least one of $P_1, \\dots, P_m$. The output is a real number $v$ that approximates $w$.\n\nThe output $v$ is judged to be correct if $v$ approximates $w$ within a multiplicative error of $5\\%$, i.e.,\n\n$$0.95 \\times w \\leq v \\leq 1.05 \\times w$$\n\n$v$ should be represented either with or without exponent component. For example, $0.045$ can be represented as $4.5\\text{e}-2$ or $0.045$.", "hint": "In the first sample, there are $4^3$ DNA sequences of length 3. There are 4 DNA sequences, “ACA”, “ACG”, “ACC”, and “ACT”, that match the pattern “AC?”. Thus, the probability is $4/4^3 = 0.0625$. Any real number between $0.059375$ and $0.065625$ is accepted as a correct output.\n\nAs in the third sample, the probability can be a small real number. Note that “0” is not a correct output, as $0$ is less than $95\\%$ of the precise probability.\n", "locale": "en"}, "zh-CN": {"title": "[ICPC 2021 Yokohama R] Cancer DNA", "background": "", "description": "**潜在癌症调查中心 (ICPC)** 发现了导致癌症的 DNA 序列模式！我们希望您编写一个计算机程序，近似计算一个随机 DNA 序列与给定模式之一匹配的概率。\n\nDNA 序列可以用由四个字母 ‘A’、‘G’、‘C’ 和 ‘T’ 组成的字符串表示。一个 **DNA 模式** 是一个由这四个字母加上 ‘?’ 组成的字符串。如果模式中的每个字符要么是 ‘?’，要么与 DNA 序列中对应位置的字符相同，我们就说该 DNA 模式匹配一个相同长度的 DNA 序列。例如，模式 “AC?” 匹配 DNA 序列 “ACA”、“ACG”、“ACC” 和 “ACT”。\n\n您的任务是编写一个程序，给定一组长度相同的 DNA 模式，计算一个均匀随机的相同长度 DNA 序列与任意给定模式匹配的概率。允许最多 $5\\%$ 的乘法误差。\n", "inputFormat": "输入由单个测试用例组成，格式如下。\n\n$$n\\ m$$\n\n$$P_1$$\n\n$$\\vdots$$\n\n$$P_m$$\n\n输入的第一行包含两个正整数 $n$ 和 $m$，满足 $1 \\leq n \\leq 100$ 和 $1 \\leq m \\leq 30$。接下来的 $m$ 行包含 $m$ 个模式 $P_1, \\dots, P_m$。每个模式 $P_i$ 是一个长度为 $n$ 的字符串，由 ‘A’、‘G’、‘C’、‘T’ 和 ‘?’ 组成。", "outputFormat": "设 $S$ 是一个均匀随机选择的长度为 $n$ 的 DNA 序列。设 $w$ 为 $S$ 与 $P_1, \\dots, P_m$ 中至少一个匹配的概率。输出是一个近似 $w$ 的实数 $v$。\n\n如果 $v$ 在 $5\\%$ 的乘法误差范围内近似 $w$，即\n\n$$0.95 \\times w \\leq v \\leq 1.05 \\times w$$\n\n则判断输出 $v$ 正确。\n\n$v$ 可以用指数部分表示，也可以不用。例如，$0.045$ 可以表示为 $4.5\\text{e}-2$ 或 $0.045$。", "hint": "在第一个样例中，长度为 3 的 DNA 序列有 $4^3$ 种。有 4 个 DNA 序列 “ACA”、“ACG”、“ACC” 和 “ACT” 匹配模式 “AC?”。因此，概率为 $4/4^3 = 0.0625$。任何介于 $0.059375$ 和 $0.065625$ 之间的实数都被接受为正确输出。\n\n如第三个样例所示，概率可能是一个很小的实数。注意，“0” 不是正确输出，因为 $0$ 小于精确概率的 $95\\%$。\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P14861", "type": "P", "difficulty": 6, "samples": [["8 9\n0 1\n1 2\n2 3\n0 4\n1 6\n3 7\n4 5\n5 6\n6 7", "3\n2 3 7\n2 4 5\n4 0 1 2 6"], ["2 1\n0 1", "1\n2 0 1"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2021", "Special Judge", "生成树", "ICPC", "横浜"], "title": "[ICPC 2021 Yokohama R] \"Even\" Division", "background": "", "description": "If you talk about an even division in the usual sense of the words, it means dividing a thing equally. Today, you need to think about something different. A graph is to be divided into subgraphs with their numbers of nodes being even, that is, multiples of two.\n\nYou are given an undirected connected graph with even number of nodes. The given graph is to be divided into its subgraphs so that all the subgraphs are connected and with even number of nodes, until no further such division is possible. Figure 1.1 illustrates an example. The original graph of 8 nodes is divided into subgraphs with 4, 2, and 2 nodes. All of them have even numbers of nodes.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/ce19w0k5.png)\n\nFigure I.1. Example of a division (Sample Input/Output 1)\n:::\n\nTo put it mathematically, an **even division** of a graph is the set of subsets $V_1, \\dots, V_k$ of the graph nodes satisfying the following conditions.\n\n1. $V_1 \\cup \\cdots \\cup V_k$ is the set of all the nodes of the input graph, and $V_i \\cap V_j = \\emptyset$ if $i \\neq j$.\n2. Each $V_i$ is non-empty, and has an even number of elements.\n3. Each $V_i$ induces a connected subgraph. In other words, any nodes in $V_i$ are reachable from each other by using only the edges of the input graph connecting two nodes in $V_i$.\n4. There is no further division. For any $U_1 \\cup U_2 = V_i$, the division obtained by replacing $V_i$ with the two sets, $U_1$ and $U_2$, does not satisfy either of the conditions 1, 2, or 3.\n\nYour task is to find an **even division** of the given graph.\n", "inputFormat": "The input consists of a single test case of the following format.\n\n$$\n\\begin{aligned}\n&n\\ m \\\\\n&x_1\\ y_1 \\\\\n&\\vdots \\\\\n&x_m\\ y_m\n\\end{aligned}\n$$\n\nThe first line consists of two integers $n$ and $m$. The first integer $n$ ($2 \\leq n \\leq 10^5$) is an even number representing the number of the nodes of the graph to be divided. The second integer $m$ ($n-1 \\leq m \\leq 10^5$) is the number of the edges of the graph.\n\nThe nodes of the graph are numbered from $0$ to $n-1$.\n\nThe subsequent $m$ lines represent the edges of the graph. A line $x_i\\ y_i$ ($0 \\leq x_i < y_i < n$) means that there is an edge connecting the two nodes $x_i$ and $y_i$. There are no duplicated edges. The input graph is guaranteed to be connected.", "outputFormat": "If there exists an **even division** of the node set of the given graph into subsets $V_1, \\dots, V_k$, print $k$ in the first line of the output. The next $k$ lines should describe the subsets $V_1, \\dots, V_k$. The order of the subsets does not matter. The $i$-th of them should begin with the size of $V_i$, followed by the node numbers of the elements of $V_i$, separated by a space. The order of the node numbers does not matter either.\n\nIf there are multiple even divisions, any of them are acceptable.", "hint": "In the Sample 2, the singleton set of the set of the nodes of the original graph is already an even division.", "locale": "en", "translations": {"en": {"title": "[ICPC 2021 Yokohama R] \"Even\" Division", "background": "", "description": "If you talk about an even division in the usual sense of the words, it means dividing a thing equally. Today, you need to think about something different. A graph is to be divided into subgraphs with their numbers of nodes being even, that is, multiples of two.\n\nYou are given an undirected connected graph with even number of nodes. The given graph is to be divided into its subgraphs so that all the subgraphs are connected and with even number of nodes, until no further such division is possible. Figure 1.1 illustrates an example. The original graph of 8 nodes is divided into subgraphs with 4, 2, and 2 nodes. All of them have even numbers of nodes.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/ce19w0k5.png)\n\nFigure I.1. Example of a division (Sample Input/Output 1)\n:::\n\nTo put it mathematically, an **even division** of a graph is the set of subsets $V_1, \\dots, V_k$ of the graph nodes satisfying the following conditions.\n\n1. $V_1 \\cup \\cdots \\cup V_k$ is the set of all the nodes of the input graph, and $V_i \\cap V_j = \\emptyset$ if $i \\neq j$.\n2. Each $V_i$ is non-empty, and has an even number of elements.\n3. Each $V_i$ induces a connected subgraph. In other words, any nodes in $V_i$ are reachable from each other by using only the edges of the input graph connecting two nodes in $V_i$.\n4. There is no further division. For any $U_1 \\cup U_2 = V_i$, the division obtained by replacing $V_i$ with the two sets, $U_1$ and $U_2$, does not satisfy either of the conditions 1, 2, or 3.\n\nYour task is to find an **even division** of the given graph.\n", "inputFormat": "The input consists of a single test case of the following format.\n\n$$\n\\begin{aligned}\n&n\\ m \\\\\n&x_1\\ y_1 \\\\\n&\\vdots \\\\\n&x_m\\ y_m\n\\end{aligned}\n$$\n\nThe first line consists of two integers $n$ and $m$. The first integer $n$ ($2 \\leq n \\leq 10^5$) is an even number representing the number of the nodes of the graph to be divided. The second integer $m$ ($n-1 \\leq m \\leq 10^5$) is the number of the edges of the graph.\n\nThe nodes of the graph are numbered from $0$ to $n-1$.\n\nThe subsequent $m$ lines represent the edges of the graph. A line $x_i\\ y_i$ ($0 \\leq x_i < y_i < n$) means that there is an edge connecting the two nodes $x_i$ and $y_i$. There are no duplicated edges. The input graph is guaranteed to be connected.", "outputFormat": "If there exists an **even division** of the node set of the given graph into subsets $V_1, \\dots, V_k$, print $k$ in the first line of the output. The next $k$ lines should describe the subsets $V_1, \\dots, V_k$. The order of the subsets does not matter. The $i$-th of them should begin with the size of $V_i$, followed by the node numbers of the elements of $V_i$, separated by a space. The order of the node numbers does not matter either.\n\nIf there are multiple even divisions, any of them are acceptable.", "hint": "In the Sample 2, the singleton set of the set of the nodes of the original graph is already an even division.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2021 Yokohama R] \"Even\" Division", "background": "", "description": "如果你谈论通常意义上的“偶数划分”，它意味着将事物等分。今天，你需要思考一些不同的东西。一个图需要被划分成子图，且每个子图的节点数为偶数，即二的倍数。\n\n你被给予一个具有偶数个节点的无向连通图。给定的图将被划分为子图，使得所有子图都是连通的且具有偶数个节点，直到无法再进行这样的划分为止。图 1.1 展示了一个例子。原始的 8 个节点的图被划分为具有 4、2 和 2 个节点的子图。所有这些子图都具有偶数个节点。\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/ce19w0k5.png)\n\n图 I.1. 一个划分示例（样例输入/输出 1）\n:::\n\n用数学术语来说，一个图的 **偶数划分** 是图节点子集 $V_1, \\dots, V_k$ 的集合，满足以下条件：\n\n1. $V_1 \\cup \\cdots \\cup V_k$ 是输入图的所有节点的集合，且若 $i \\neq j$，则 $V_i \\cap V_j = \\emptyset$。\n2. 每个 $V_i$ 非空，且具有偶数个元素。\n3. 每个 $V_i$ 导出一个连通的子图。换句话说，$V_i$ 中的任意节点都可以通过仅使用输入图中连接 $V_i$ 中两个节点的边相互可达。\n4. 不存在进一步的划分。对于任意 $U_1 \\cup U_2 = V_i$，用两个集合 $U_1$ 和 $U_2$ 替换 $V_i$ 得到的划分不满足条件 1、2 或 3 中的任意一条。\n\n你的任务是找到给定图的一个 **偶数划分**。", "inputFormat": "输入由单个测试用例组成，格式如下。\n\n$$\n\\begin{aligned}\n&n\\ m \\\\\n&x_1\\ y_1 \\\\\n&\\vdots \\\\\n&x_m\\ y_m\n\\end{aligned}\n$$\n\n第一行包含两个整数 $n$ 和 $m$。第一个整数 $n$ ($2 \\leq n \\leq 10^5$) 是一个偶数，表示要划分的图的节点数。第二个整数 $m$ ($n-1 \\leq m \\leq 10^5$) 是图的边数。\n\n图的节点编号从 $0$ 到 $n-1$。\n\n随后的 $m$ 行表示图的边。一行 $x_i\\ y_i$ ($0 \\leq x_i < y_i < n$) 意味着存在一条连接节点 $x_i$ 和 $y_i$ 的边。没有重复的边。保证输入图是连通的。", "outputFormat": "如果存在给定图的节点集到子集 $V_1, \\dots, V_k$ 的 **偶数划分**，则在输出的第一行打印 $k$。接下来的 $k$ 行应描述子集 $V_1, \\dots, V_k$。子集的顺序无关紧要。其中第 $i$ 行应以 $V_i$ 的大小开头，后跟 $V_i$ 中元素的节点编号，用一个空格分隔。节点编号的顺序也无关紧要。\n\n如果有多个偶数划分，其中任意一个都可以接受。", "hint": "在样例 2 中，原始图节点集的单元素集合本身已经是一个偶数划分。\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P14862", "type": "P", "difficulty": 4, "samples": [["4\n2 1\n1 2\n6 3\n5 4", "4"], ["20\n15 9\n14 13\n2 7\n10 5\n11 17\n13 8\n9 3\n8 12\n6 4\n19 18\n12 1\n3 2\n5 10\n18 11\n4 19\n20 16\n16 15\n1 14\n7 6\n17 20", "9"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["二分", "2021", "ICPC", "横浜"], "title": "[ICPC 2021 Yokohama R] The Cross Covers Everything", "background": "", "description": "A cross-shaped infinite area on the $x-y$ plane can be specified by two distinct points as depicted on the figure below.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/b51vi0am.png)\n\nFigure J.1. The cross area specified by two points numbered 2 and 4\n:::\n\nGiven a set of points on the plane, you are asked to figure out how many pairs of the points form a cross-shaped area that covers all the points. To be more precise, when $n$ points with coordinates $(x_i, y_i)$ ($i = 1, \\dots, n$) are given, the ordered pair $\\langle p, q \\rangle$ is said to cover a point $(x, y)$ if $x_p \\leq x \\leq x_q$, $y_p \\leq y \\leq y_q$, or both hold. Your task is to find how many pairs $\\langle p, q \\rangle$ cover all the $n$ points. No two given points have the same $x$-coordinate nor the same $y$-coordinate.", "inputFormat": "The input consists of a single test case of the following format.\n\n$$\n\\begin{aligned}\n&n \\\\\n&x_1\\ y_1 \\\\\n&\\vdots \\\\\n&x_n\\ y_n\n\\end{aligned}\n$$\n\nThe first line contains an integer $n$ ($2 \\leq n \\leq 2 \\times 10^5$), which is the number of points given. Two integers $x_i$ and $y_i$ in the $i$-th line of the following $n$ lines are the coordinates of the $i$-th point ($1 \\leq x_i \\leq 10^6$, $1 \\leq y_i \\leq 10^6$). You may assume that $x_j \\neq x_k$ and $y_j \\neq y_k$ hold for all $j \\neq k$.", "outputFormat": "Print in a line the number of ordered pairs of points that satisfy the condition.", "hint": "Figure J.1 depicts the cross specified by two points numbered 2 and 4, that are the second and the fourth points of the Sample Input 1. This is one of the crosses covering all the points.\n\n### Amendment\n\nThe conditions $x_p \\leq x_q$, and $y_p \\leq y_q$, have to be added to be satisfied for the ordered pair $\\langle p, q \\rangle$ that are counted. This was announced during the contest.", "locale": "en", "translations": {"en": {"title": "[ICPC 2021 Yokohama R] The Cross Covers Everything", "background": "", "description": "A cross-shaped infinite area on the $x-y$ plane can be specified by two distinct points as depicted on the figure below.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/b51vi0am.png)\n\nFigure J.1. The cross area specified by two points numbered 2 and 4\n:::\n\nGiven a set of points on the plane, you are asked to figure out how many pairs of the points form a cross-shaped area that covers all the points. To be more precise, when $n$ points with coordinates $(x_i, y_i)$ ($i = 1, \\dots, n$) are given, the ordered pair $\\langle p, q \\rangle$ is said to cover a point $(x, y)$ if $x_p \\leq x \\leq x_q$, $y_p \\leq y \\leq y_q$, or both hold. Your task is to find how many pairs $\\langle p, q \\rangle$ cover all the $n$ points. No two given points have the same $x$-coordinate nor the same $y$-coordinate.", "inputFormat": "The input consists of a single test case of the following format.\n\n$$\n\\begin{aligned}\n&n \\\\\n&x_1\\ y_1 \\\\\n&\\vdots \\\\\n&x_n\\ y_n\n\\end{aligned}\n$$\n\nThe first line contains an integer $n$ ($2 \\leq n \\leq 2 \\times 10^5$), which is the number of points given. Two integers $x_i$ and $y_i$ in the $i$-th line of the following $n$ lines are the coordinates of the $i$-th point ($1 \\leq x_i \\leq 10^6$, $1 \\leq y_i \\leq 10^6$). You may assume that $x_j \\neq x_k$ and $y_j \\neq y_k$ hold for all $j \\neq k$.", "outputFormat": "Print in a line the number of ordered pairs of points that satisfy the condition.", "hint": "Figure J.1 depicts the cross specified by two points numbered 2 and 4, that are the second and the fourth points of the Sample Input 1. This is one of the crosses covering all the points.\n\n### Amendment\n\nThe conditions $x_p \\leq x_q$, and $y_p \\leq y_q$, have to be added to be satisfied for the ordered pair $\\langle p, q \\rangle$ that are counted. This was announced during the contest.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2021 Yokohama R] The Cross Covers Everything", "background": "", "description": "在 $x-y$ 平面上，一个十字形无限区域可以由两个不同的点指定，如下图所示。\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/b51vi0am.png)\n\n图 J.1. 由编号为 2 和 4 的两个点指定的十字区域\n:::\n\n给定平面上的一组点，你需要计算有多少对点形成的十字形区域覆盖了所有点。更精确地说，当给定坐标为 $(x_i, y_i)$ ($i = 1, \\dots, n$) 的 $n$ 个点时，如果满足 $x_p \\leq x \\leq x_q$、$y_p \\leq y \\leq y_q$，或两者都成立，则有序对 $\\langle p, q \\rangle$ 称为覆盖点 $(x, y)$。你的任务是找出有多少对 $\\langle p, q \\rangle$ 覆盖了所有 $n$ 个点。给定的点中没有两个点具有相同的 $x$ 坐标或相同的 $y$ 坐标。", "inputFormat": "输入由单个测试用例组成，格式如下。\n\n$$\n\\begin{aligned}\n&n \\\\\n&x_1\\ y_1 \\\\\n&\\vdots \\\\\n&x_n\\ y_n\n\\end{aligned}\n$$\n\n第一行包含一个整数 $n$ ($2 \\leq n \\leq 2 \\times 10^5$)，表示给定点的数量。接下来 $n$ 行中的第 $i$ 行包含两个整数 $x_i$ 和 $y_i$，表示第 $i$ 个点的坐标 ($1 \\leq x_i \\leq 10^6$, $1 \\leq y_i \\leq 10^6$)。你可以假设对于所有 $j \\neq k$，有 $x_j \\neq x_k$ 且 $y_j \\neq y_k$。\n", "outputFormat": "输出一行，表示满足条件的有序点对的数量。", "hint": "图 J.1 描绘了由编号为 2 和 4 的两个点指定的十字区域，这两个点是样例输入 1 中的第二个和第四个点。这是覆盖所有点的十字之一。\n\n### 修正\n\n对于被计数的有序对 $\\langle p, q \\rangle$，需要满足条件 $x_p \\leq x_q$ 和 $y_p \\leq y_q$。这是在比赛期间宣布的。\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P14863", "type": "P", "difficulty": 7, "samples": [["2 3\n4 2 1\n3 3 3", "1 2 1"], ["1 7\n64 32 16 8 4 2 1", "1 1 1 1 1 1 1"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2021", "Special Judge", "二分图", "ICPC", "横浜"], "title": "[ICPC 2021 Yokohama R] Distributing the Treasure", "background": "", "description": "You are the leader of a treasure hunting team. Under your great direction, your team has made a big success in a quest, and got a lot of treasure. The only, but crucial, remaining issue is how to distribute the obtained treasure to the team members.\n\nThe excavated treasure includes a variety of precious items: gold ingots, jewelry with brilliant gem stones, exquisite craft works, etc. Each team member individually estimates the values of the items. The estimated values are consistent, in that, for any pair of two items, when some member estimates one to be strictly higher than the other, no member estimates oppositely, although some may give equal estimates.\n\nAll the members are sensible and thus understand the difficulty of even distribution of the items. Hence, no member will complain simply because, based on the member’s own estimation, the sum of the values of the member’s share is lower than that of another member’s share. The members, however, may get angry if their own shares look unreasonably shabby compared to some other member’s; what they cannot stand is when their own shares are estimated strictly lower than the share of that other member even after getting rid of one item with the least estimated value.\n\nYour last mission as the leader is to decide who receives which items so that no member gets angry. Some of the members may receive nothing as long as they do not get angry.\n", "inputFormat": "The input consists of a single test case of the following format.\n\n$$\n\\begin{aligned}\n&n\\ m \\\\\n&v_{1,1}\\ \\cdots\\ v_{1,m} \\\\\n&\\vdots \\\\\n&v_{n,1}\\ \\cdots\\ v_{n,m}\n\\end{aligned}\n$$\n\nThe first line of the input has two positive integers $n$ and $m$ whose product does not exceed $2 \\times 10^5$; $n$ is the number of members of your treasure hunting team, and $m$ is the number of treasure items. The members and items are numbered 1 through $n$ and 1 through $m$, respectively. The $i$-th of the following $n$ lines has $m$ positive integers not exceeding $2 \\times 10^5$ in descending order: $v_{i,1} \\geq v_{i,2} \\geq \\cdots \\geq v_{i,m}$. Here, $v_{i,j}$ is the value of the item $j$ estimated by the member $i$.", "outputFormat": "If you can distribute the items to the members without making any member angry, output such a distribution in a line as $m$ positive integers $x_1, x_2, \\dots, x_m$ separated by spaces. Here, $x_j = i$ means that the member $i$ receives the item $j$. If two or more such distributions exist, any of them shall be deemed correct. If there is no way to distribute the items without making any member angry, just output 0 in a line.", "hint": "Let $V_i(X)$ denote the sum of the values of items in the set $X$ estimated by the member $i$.\n\nIn Sample 1, $V_1(\\{1,3\\})$ is $4 + 1 = 5$, $V_1(\\{2\\})$ is 2, $V_2(\\{1,3\\})$ is $3 + 3 = 6$, and $V_2(\\{2\\})$ is 3. The distribution shown as output does not make the member 1 angry as $V_1(\\{1,3\\}) \\geq V_1(\\{2\\})$. The member 2 does not get angry either even though $V_2(\\{2\\}) < V_2(\\{1,3\\})$ holds. If the member 1 waives one of the two items, the sum of the values of items received by the member 1 would become $V_2(\\{1\\}) = 3$ or $V_2(\\{3\\}) = 3$, neither of which is higher than $V_2(\\{2\\}) = 3$.\n\nNote that their shares should not be exchanged. Suppose that the member 1 receives $\\{2\\}$ and the member 2 receives $\\{1,3\\}$. This makes the member 1 angry because $V_1(\\{2\\}) = 2 < 4 = V_1(\\{1\\})$ holds, meaning that, even if the member 2 waives the item 3, which is estimated to be the lesser of $\\{1,3\\}$, the value of the sole remaining item 1 is still estimated higher than $V_1(\\{2\\}) = 2$.\n\nIn Sample 2, you are the sole member of your team, so you can take them all. Congratulations!", "locale": "en", "translations": {"en": {"title": "[ICPC 2021 Yokohama R] Distributing the Treasure", "background": "", "description": "You are the leader of a treasure hunting team. Under your great direction, your team has made a big success in a quest, and got a lot of treasure. The only, but crucial, remaining issue is how to distribute the obtained treasure to the team members.\n\nThe excavated treasure includes a variety of precious items: gold ingots, jewelry with brilliant gem stones, exquisite craft works, etc. Each team member individually estimates the values of the items. The estimated values are consistent, in that, for any pair of two items, when some member estimates one to be strictly higher than the other, no member estimates oppositely, although some may give equal estimates.\n\nAll the members are sensible and thus understand the difficulty of even distribution of the items. Hence, no member will complain simply because, based on the member’s own estimation, the sum of the values of the member’s share is lower than that of another member’s share. The members, however, may get angry if their own shares look unreasonably shabby compared to some other member’s; what they cannot stand is when their own shares are estimated strictly lower than the share of that other member even after getting rid of one item with the least estimated value.\n\nYour last mission as the leader is to decide who receives which items so that no member gets angry. Some of the members may receive nothing as long as they do not get angry.\n", "inputFormat": "The input consists of a single test case of the following format.\n\n$$\n\\begin{aligned}\n&n\\ m \\\\\n&v_{1,1}\\ \\cdots\\ v_{1,m} \\\\\n&\\vdots \\\\\n&v_{n,1}\\ \\cdots\\ v_{n,m}\n\\end{aligned}\n$$\n\nThe first line of the input has two positive integers $n$ and $m$ whose product does not exceed $2 \\times 10^5$; $n$ is the number of members of your treasure hunting team, and $m$ is the number of treasure items. The members and items are numbered 1 through $n$ and 1 through $m$, respectively. The $i$-th of the following $n$ lines has $m$ positive integers not exceeding $2 \\times 10^5$ in descending order: $v_{i,1} \\geq v_{i,2} \\geq \\cdots \\geq v_{i,m}$. Here, $v_{i,j}$ is the value of the item $j$ estimated by the member $i$.", "outputFormat": "If you can distribute the items to the members without making any member angry, output such a distribution in a line as $m$ positive integers $x_1, x_2, \\dots, x_m$ separated by spaces. Here, $x_j = i$ means that the member $i$ receives the item $j$. If two or more such distributions exist, any of them shall be deemed correct. If there is no way to distribute the items without making any member angry, just output 0 in a line.", "hint": "Let $V_i(X)$ denote the sum of the values of items in the set $X$ estimated by the member $i$.\n\nIn Sample 1, $V_1(\\{1,3\\})$ is $4 + 1 = 5$, $V_1(\\{2\\})$ is 2, $V_2(\\{1,3\\})$ is $3 + 3 = 6$, and $V_2(\\{2\\})$ is 3. The distribution shown as output does not make the member 1 angry as $V_1(\\{1,3\\}) \\geq V_1(\\{2\\})$. The member 2 does not get angry either even though $V_2(\\{2\\}) < V_2(\\{1,3\\})$ holds. If the member 1 waives one of the two items, the sum of the values of items received by the member 1 would become $V_2(\\{1\\}) = 3$ or $V_2(\\{3\\}) = 3$, neither of which is higher than $V_2(\\{2\\}) = 3$.\n\nNote that their shares should not be exchanged. Suppose that the member 1 receives $\\{2\\}$ and the member 2 receives $\\{1,3\\}$. This makes the member 1 angry because $V_1(\\{2\\}) = 2 < 4 = V_1(\\{1\\})$ holds, meaning that, even if the member 2 waives the item 3, which is estimated to be the lesser of $\\{1,3\\}$, the value of the sole remaining item 1 is still estimated higher than $V_1(\\{2\\}) = 2$.\n\nIn Sample 2, you are the sole member of your team, so you can take them all. Congratulations!", "locale": "en"}, "zh-CN": {"title": "[ICPC 2021 Yokohama R] Distributing the Treasure", "background": null, "description": "你是一个寻宝团队的队长。在你的英明领导下，你的团队在一次探险中取得了巨大成功，获得了大量宝藏。唯一但至关重要的剩余问题是如何将这些获得的宝藏分配给团队成员。\n\n挖掘出的宝藏包括各种珍贵物品：金条、镶嵌璀璨宝石的珠宝、精美的工艺品等等。每位团队成员各自估计这些物品的价值。这些估值是一致的，也就是说，对于任意两个物品，如果某位成员估计其中一个严格高于另一个，则没有成员会给出相反的估计，尽管有些人可能给出相等的估值。\n\n所有成员都是理智的，因此理解均匀分配物品的困难。因此，没有成员会仅仅因为基于其自己的估值，其所获份额的价值总和低于另一位成员的份额而抱怨。然而，如果他们的份额与某些其他成员的份额相比显得不合理地寒酸，他们可能会生气；他们无法忍受的是，即使在舍弃另一位成员份额中估值最低的一件物品后，自己份额的估值仍然严格低于那位成员的份额。\n\n你作为队长的最后任务是决定谁获得哪些物品，以使没有成员生气。只要不生气，有些成员可能什么也得不到。", "inputFormat": "输入由单个测试用例组成，格式如下。\n\n$$\n\\begin{aligned}\n&n\\ m \\\\\n&v_{1,1}\\ \\cdots\\ v_{1,m} \\\\\n&\\vdots \\\\\n&v_{n,1}\\ \\cdots\\ v_{n,m}\n\\end{aligned}\n$$\n\n输入的第一行有两个正整数 $n$ 和 $m$，其乘积不超过 $2 \\times 10^5$；$n$ 是你的寻宝团队的成员数量，$m$ 是宝藏物品的数量。成员和物品分别编号为 $1$ 到 $n$ 和 $1$ 到 $m$。接下来的 $n$ 行中，第 $i$ 行有 $m$ 个不超过 $2 \\times 10^5$ 的正整数，按降序排列：$v_{i,1} \\geq v_{i,2} \\geq \\cdots \\geq v_{i,m}$。这里，$v_{i,j}$ 是成员 $i$ 对物品 $j$ 的估值。", "outputFormat": "如果你可以在不让任何成员生气的情况下将物品分配给成员，则在一行中输出这样的分配，为 $m$ 个正整数 $x_1, x_2, \\dots, x_m$，用空格分隔。这里，$x_j = i$ 表示成员 $i$ 获得物品 $j$。如果存在两个或更多这样的分配，其中任意一个都将被视为正确。如果无法在不惹怒任何成员的情况下分配物品，则只需在一行中输出 $0$。", "hint": "令 $V_i(X)$ 表示成员 $i$ 对集合 $X$ 中物品价值的估值总和。\n\n在样例 1 中，$V_1(\\{1,3\\})$ 是 $4 + 1 = 5$，$V_1(\\{2\\})$ 是 $2$，$V_2(\\{1,3\\})$ 是 $3 + 3 = 6$，$V_2(\\{2\\})$ 是 $3$。输出所示的分配不会让成员 $1$ 生气，因为 $V_1(\\{1,3\\}) \\geq V_1(\\{2\\})$。即使 $V_2(\\{2\\}) < V_2(\\{1,3\\})$ 成立，成员 $2$ 也不会生气。如果成员 $1$ 放弃两件物品中的一件，那么成员 $1$ 获得的物品价值总和将变为 $V_2(\\{1\\}) = 3$ 或 $V_2(\\{3\\}) = 3$，两者均不高于 $V_2(\\{2\\}) = 3$。\n\n注意，他们的份额不应交换。假设成员 $1$ 获得 $\\{2\\}$，成员 $2$ 获得 $\\{1,3\\}$。这会让成员 $1$ 生气，因为 $V_1(\\{2\\}) = 2 < 4 = V_1(\\{1\\})$ 成立，这意味着即使成员 $2$ 舍弃物品 $3$（这是 $\\{1,3\\}$ 中估值较低的一件），剩余的唯一物品 $1$ 的价值仍然被估值高于 $V_1(\\{2\\}) = 2$。\n\n在样例 2 中，你是团队的唯一成员，因此你可以全部拿走。恭喜！\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P14864", "type": "P", "difficulty": 3, "samples": [["3\n010\n010\n111\n100\n111\n101\n011\n111\n010", "Yes"], ["2\n00\n01\n00\n10\n10\n00", "Yes\n"], ["2\n00\n00\n00\n10\n10\n00", "No"], ["2\n01\n00\n00\n10\n10\n00", "No"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2020", "ICPC", "横浜"], "title": "[ICPC 2020 Yokohama R] Three-Axis Views", "background": "", "description": "A friend of yours is an artist designing **Image-Containing Projection Cubes (ICPCs)**. An ICPC is a crystal cube with its side of integer length. Some of its regions are made opaque through an elaborate laser machining process. Each of the opaque regions is a cube of unit size aligned with integer coordinates.\n\nFigure A.1 depicts an ICPC as given in the Sample Input 1. Here, the green wires correspond to the edges of the crystal cube. The blue small cubes correspond to the cubic opaque regions inside the crystal.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/uejbj6me.png)\n\nFigure A.1. ICPC of Sample Input 1\n:::\n\nICPCs are meant to enjoy the silhouettes of its opaque regions projected by three parallel lights perpendicular to its faces. Figure A.2 depicts the ICPC and its three silhouettes.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/gc1be0on.png)\n\nFigure A.2. ICPC of Sample Input 1 and its silhouettes (dashed-dotted lines are the edges of the parallel light perpendicular to the left face)\n:::\n\nYour job is to write a program that decides whether there exists an ICPC that makes the given silhouettes.", "inputFormat": "The input consists of a single test case of the following format.\n\n$$n$$\n\n$$s_1$$\n\n$$\\vdots$$\n\n$$s_n$$\n\n$$t_1$$\n\n$$\\vdots$$\n\n$$t_n$$\n\n$$u_1$$\n\n$$\\vdots$$\n\n$$u_n$$\n\nHere, $n$ is the size of the ICPC, an integer between 1 and 100, inclusive.\n\nThe ICPC of size $n$ makes three silhouettes of $n \\times n$ squares of dark and bright cells. Cells are dark if they are covered by the shadows of opaque unit cubes, and are bright, otherwise. The $3n$ lines, each with $n$ digits, starting from the second line of the input denote the three silhouettes of the ICPC, where ‘0’ represents a bright cell and ‘1’ represents a dark cell. At least one of the digits in the $3n$ lines is ‘1’.\n\nFirst comes the data for the silhouette on the $yz$-plane, where the first line $s_1$ gives the cells of the silhouettes with the largest $z$-coordinate value. They are in the order of their $y$-coordinates. The following lines, $s_2, \\dots, s_n$, give the cells with the decreasing values of their $z$-coordinates.\n\nThen comes the data for the silhouette on the $zx$-plane, where the first line, $t_1$, gives the cells with the largest $x$-coordinate value, in the order of their $z$-coordinates. The following lines, $t_2, \\dots, t_n$, give the cells with the decreasing values of their $x$-coordinates.\n\nFinally comes the data for the silhouette on the $xy$-plane, where the first line, $u_1$, gives the cells with the largest $y$-coordinate value, in the order of their $x$-coordinates. The following lines, $u_2, \\dots, u_n$, give the cells with the decreasing values of their $y$-coordinates.\n\nThe following figure depicts the three silhouettes of the ICPC given in the Sample Input 1.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/md9rxtw4.png)\n\nFigure A.3. 0-1 representations of silhouettes (Sample Input 1)\n:::", "outputFormat": "Print “Yes” if it is possible to make an ICPC with the given silhouettes. Print “No”, otherwise.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2020 Yokohama R] Three-Axis Views", "background": "", "description": "A friend of yours is an artist designing **Image-Containing Projection Cubes (ICPCs)**. An ICPC is a crystal cube with its side of integer length. Some of its regions are made opaque through an elaborate laser machining process. Each of the opaque regions is a cube of unit size aligned with integer coordinates.\n\nFigure A.1 depicts an ICPC as given in the Sample Input 1. Here, the green wires correspond to the edges of the crystal cube. The blue small cubes correspond to the cubic opaque regions inside the crystal.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/uejbj6me.png)\n\nFigure A.1. ICPC of Sample Input 1\n:::\n\nICPCs are meant to enjoy the silhouettes of its opaque regions projected by three parallel lights perpendicular to its faces. Figure A.2 depicts the ICPC and its three silhouettes.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/gc1be0on.png)\n\nFigure A.2. ICPC of Sample Input 1 and its silhouettes (dashed-dotted lines are the edges of the parallel light perpendicular to the left face)\n:::\n\nYour job is to write a program that decides whether there exists an ICPC that makes the given silhouettes.", "inputFormat": "The input consists of a single test case of the following format.\n\n$$n$$\n\n$$s_1$$\n\n$$\\vdots$$\n\n$$s_n$$\n\n$$t_1$$\n\n$$\\vdots$$\n\n$$t_n$$\n\n$$u_1$$\n\n$$\\vdots$$\n\n$$u_n$$\n\nHere, $n$ is the size of the ICPC, an integer between 1 and 100, inclusive.\n\nThe ICPC of size $n$ makes three silhouettes of $n \\times n$ squares of dark and bright cells. Cells are dark if they are covered by the shadows of opaque unit cubes, and are bright, otherwise. The $3n$ lines, each with $n$ digits, starting from the second line of the input denote the three silhouettes of the ICPC, where ‘0’ represents a bright cell and ‘1’ represents a dark cell. At least one of the digits in the $3n$ lines is ‘1’.\n\nFirst comes the data for the silhouette on the $yz$-plane, where the first line $s_1$ gives the cells of the silhouettes with the largest $z$-coordinate value. They are in the order of their $y$-coordinates. The following lines, $s_2, \\dots, s_n$, give the cells with the decreasing values of their $z$-coordinates.\n\nThen comes the data for the silhouette on the $zx$-plane, where the first line, $t_1$, gives the cells with the largest $x$-coordinate value, in the order of their $z$-coordinates. The following lines, $t_2, \\dots, t_n$, give the cells with the decreasing values of their $x$-coordinates.\n\nFinally comes the data for the silhouette on the $xy$-plane, where the first line, $u_1$, gives the cells with the largest $y$-coordinate value, in the order of their $x$-coordinates. The following lines, $u_2, \\dots, u_n$, give the cells with the decreasing values of their $y$-coordinates.\n\nThe following figure depicts the three silhouettes of the ICPC given in the Sample Input 1.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/md9rxtw4.png)\n\nFigure A.3. 0-1 representations of silhouettes (Sample Input 1)\n:::", "outputFormat": "Print “Yes” if it is possible to make an ICPC with the given silhouettes. Print “No”, otherwise.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2020 Yokohama R] Three-Axis Views", "background": "", "description": "你的一位朋友是设计 **图像投影立方体 (ICPC)** 的艺术家。ICPC 是一个边长为整数的水晶立方体。通过精密的激光加工工艺，其部分区域被制成不透明的。每个不透明区域都是一个与整数坐标对齐的单位立方体。\n\n图 A.1 描绘了如样例输入 1 中给出的一个 ICPC。图中，绿色线条对应水晶立方体的棱边。蓝色小立方体对应水晶内部的不透明立方区域。\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/uejbj6me.png)\n\n图 A.1. 样例输入 1 的 ICPC\n:::\n\nICPC 的乐趣在于欣赏其不透明区域在三个垂直于其表面的平行光源照射下产生的投影轮廓。图 A.2 描绘了该 ICPC 及其三个投影轮廓。\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/gc1be0on.png)\n\n图 A.2. 样例输入 1 的 ICPC 及其投影轮廓（点划线是垂直于左侧表面的平行光边缘）\n:::\n\n你的任务是编写一个程序，判断是否存在一个能产生给定投影轮廓的 ICPC。", "inputFormat": "输入由单个测试用例组成，格式如下。\n\n$$n$$\n\n$$s_1$$\n\n$$\\vdots$$\n\n$$s_n$$\n\n$$t_1$$\n\n$$\\vdots$$\n\n$$t_n$$\n\n$$u_1$$\n\n$$\\vdots$$\n\n$$u_n$$\n\n这里，$n$ 是 ICPC 的尺寸，是一个介于 $1$ 到 $100$ 之间（含）的整数。\n\n尺寸为 $n$ 的 ICPC 产生三个 $n \\times n$ 的深色和浅色单元格投影轮廓。如果不透明单位立方体的阴影覆盖了单元格，则该单元格为深色，否则为浅色。从输入的第二行开始的 $3n$ 行，每行有 $n$ 个数字，表示 ICPC 的三个投影轮廓，其中 ‘0’ 表示浅色单元格，‘1’ 表示深色单元格。这 $3n$ 行中至少有一个数字是 ‘1’。\n\n首先是 $yz$ 平面上的投影轮廓数据，其中第一行 $s_1$ 给出 $z$ 坐标值最大的轮廓单元格，按 $y$ 坐标顺序排列。接下来的行 $s_2, \\dots, s_n$ 给出 $z$ 坐标值递减的单元格。\n\n然后是 $zx$ 平面上的投影轮廓数据，其中第一行 $t_1$ 给出 $x$ 坐标值最大的轮廓单元格，按 $z$ 坐标顺序排列。接下来的行 $t_2, \\dots, t_n$ 给出 $x$ 坐标值递减的单元格。\n\n最后是 $xy$ 平面上的投影轮廓数据，其中第一行 $u_1$ 给出 $y$ 坐标值最大的轮廓单元格，按 $x$ 坐标顺序排列。接下来的行 $u_2, \\dots, u_n$ 给出 $y$ 坐标值递减的单元格。\n\n下图描绘了样例输入 1 中给出的 ICPC 的三个投影轮廓。\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/md9rxtw4.png)\n\n图 A.3. 投影轮廓的 0-1 表示（样例输入 1）\n:::", "outputFormat": "如果可能制作出具有给定投影轮廓的 ICPC，则输出 “Yes”。否则输出 “No”。\n", "hint": "", "locale": "zh-CN"}}}
{"pid": "P14865", "type": "P", "difficulty": 3, "samples": [["3 3\n0 0 0\n4 0 0", "1 2 3\n4 5 6"], ["6 7\n0 5 0 0 0 13\n0 0 3 0 8 0 12", "4 5 7 10 11 13\n1 2 3 6 8 9 12"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "2020", "Special Judge", "ICPC", "横浜"], "title": "[ICPC 2020 Yokohama R] Secrets of Legendary Treasure", "background": "", "description": "Finally, you have discovered the document with two integer sequences, the final keys to unlocking the secret of the legendary treasure! The ink on the document, however, has faded so much that some of the numbers in the sequences are too faint to read. Fortunately, you have heard of a legend on the characteristics of the key sequences that (1) the numbers in the two sequences are all different and are between 1 and the sum of the lengths of the two sequences, and (2) both sequences are arranged in ascending order.\n\nPlease restore the original sequences from the readable numbers and the legend.", "inputFormat": "The input consists of a single test case of the following format.\n\n$$\n\\begin{aligned}\n&n \\ m \\\\\n&a_1 \\ \\dots \\ a_n\\\\ \n&b_1 \\ \\dots \\ b_m \\\\\n\\end{aligned}\n$$\n\nThe first line consists of two integers $n$ ($1 \\le n \\le 100$) and $m$ ($1 \\le m \\le 100$). They are the lengths of the two sequences $A$ and $B$, respectively. The second line describes the sequence $A$. Each $a_i$ is either 0, meaning that the $i$-th element of $A$ is unreadable, or a positive integer $1 \\le a_i \\le n + m$ meaning that the element reads $a_i$. The third line describes the sequence $B$ in the same fashion.", "outputFormat": "Print a pair of restored sequences $A$ and $B$ in two lines. The sequences should be consistent with the input and the legendary characteristics of the sequences.\n\nThe elements of the sequence $A$ should be printed in the first line, separated by a space character. Then the elements of the sequence $B$ should be printed in the second line, in the same manner.\n\nIf there are multiple possibilities, print any one of such pairs. At least one sequence pair consistent with the input and conforming to the legend is guaranteed to exist.", "hint": "Note that there are other acceptable outputs for the second sample input, such as the one with the positions of 6 and 7 exchanged.", "locale": "en", "translations": {"en": {"title": "[ICPC 2020 Yokohama R] Secrets of Legendary Treasure", "background": "", "description": "Finally, you have discovered the document with two integer sequences, the final keys to unlocking the secret of the legendary treasure! The ink on the document, however, has faded so much that some of the numbers in the sequences are too faint to read. Fortunately, you have heard of a legend on the characteristics of the key sequences that (1) the numbers in the two sequences are all different and are between 1 and the sum of the lengths of the two sequences, and (2) both sequences are arranged in ascending order.\n\nPlease restore the original sequences from the readable numbers and the legend.", "inputFormat": "The input consists of a single test case of the following format.\n\n$$\n\\begin{aligned}\n&n \\ m \\\\\n&a_1 \\ \\dots \\ a_n\\\\ \n&b_1 \\ \\dots \\ b_m \\\\\n\\end{aligned}\n$$\n\nThe first line consists of two integers $n$ ($1 \\le n \\le 100$) and $m$ ($1 \\le m \\le 100$). They are the lengths of the two sequences $A$ and $B$, respectively. The second line describes the sequence $A$. Each $a_i$ is either 0, meaning that the $i$-th element of $A$ is unreadable, or a positive integer $1 \\le a_i \\le n + m$ meaning that the element reads $a_i$. The third line describes the sequence $B$ in the same fashion.", "outputFormat": "Print a pair of restored sequences $A$ and $B$ in two lines. The sequences should be consistent with the input and the legendary characteristics of the sequences.\n\nThe elements of the sequence $A$ should be printed in the first line, separated by a space character. Then the elements of the sequence $B$ should be printed in the second line, in the same manner.\n\nIf there are multiple possibilities, print any one of such pairs. At least one sequence pair consistent with the input and conforming to the legend is guaranteed to exist.", "hint": "Note that there are other acceptable outputs for the second sample input, such as the one with the positions of 6 and 7 exchanged.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2020 Yokohama R] Secrets of Legendary Treasure", "background": "", "description": "终于，你找到了记载着两个整数序列的文件，它们是解锁传说宝藏秘密的最终钥匙！然而，文件上的墨水已严重褪色，导致序列中的一些数字模糊难辨。幸运的是，你曾听闻一个关于钥匙序列特性的传说：**（1）** 两个序列中的所有数字互不相同，且大小介于 $1$ 到两序列长度之和之间；**（2）** 两个序列均按升序排列。\n\n请根据可读的数字与上述传说，还原出原始的序列。", "inputFormat": "输入包含单个测试用例，格式如下。\n\n$$\n\\begin{aligned}\n&n \\ m \\\\\n&a_1 \\ \\dots \\ a_n\\\\ \n&b_1 \\ \\dots \\ b_m \\\\\n\\end{aligned}\n$$\n\n第一行包含两个整数 $n$ （$1 \\le n \\le 100$）和 $m$ （$1 \\le m \\le 100$）。它们分别是两个序列 $A$ 和 $B$ 的长度。第二行描述序列 $A$。每个 $a_i$ 要么是 $0$（表示 $A$ 的第 $i$ 个元素不可读），要么是一个正整数 $1 \\le a_i \\le n + m$（表示该元素可读且值为 $a_i$）。第三行以相同格式描述序列 $B$。\n", "outputFormat": "输出两行，分别表示还原后的序列 $A$ 和 $B$。序列必须与输入以及传说中的序列特性一致。\n\n第一行输出序列 $A$ 的元素，各元素之间用一个空格分隔。第二行以相同方式输出序列 $B$ 的元素。\n\n如果有多种可能的答案，输出其中任意一种即可。输入保证至少存在一个满足传说条件的序列对。", "hint": "注意，对于第二个样例输入，存在其他可接受的输出，例如将数字 $6$ 和 $7$ 的位置交换后的结果。", "locale": "zh-CN"}}}
