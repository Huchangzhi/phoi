{"pid": "P5126", "type": "P", "difficulty": 7, "samples": [["4 1 3", "276"], ["3 2 3", "36"]], "limits": {"time": [600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2018", "洛谷原创"], "title": "鬼故事", "background": "### _给大家讲个鬼故事_\n有一天晚上，下着大暴雨。小 K 正在他那小小的书房里做着老师给他布置的、数也数不完的信息题目。关着门，关着窗难免有些闷热。小 K 起身，将书桌前的窗子打开一个小小的细缝，小到没有雨点能透过缝隙飘进来。\n\n今天正是农历七月十五日，中元节，俗称鬼节。小 K 从来都没有在这种日子这么晚睡过，因为小 K 迷信，害怕午夜之后，便有鬼怪出没。然而今天，小 K 无可奈何。\n\n小 K 看了看时间：$23:54$。看到 $4$，小 K 皱了皱眉眉头。$4$，谐音是“死”，特别不吉利。在这种日子看到这样的字眼，往往都是不祥之兆。\n\n小 K 的眼皮在打架。他从来都不会做毒瘤题。他索性趴到了书桌上面，两只眼睛渐渐朦胧了起来。\n\n“那儿有一个本子。”他想着。不知道何时，他的书桌靠窗的一角上，静静地躺着一个湿漉漉的本子，好像是刚刚淋过雨。“它是怎么进来的？”小 K 喃喃道。他下意识地翻开那本本子，看到里面有写了一些字。不知道为什么，那些字在发黄的纸页上看起来也那么红。\n\n左边的那一页写着：\n\n $$4^{4-4}\\le M\\le N\\le 4^{4^{(4+4-\\frac{4}{4})}},\\sqrt{4}\\le K\\le 4^{\\sqrt{4}}\\times(4-\\frac{4}{4})+\\sqrt{4}$$\n\n右边的那一页写着的似乎比左边的要长：\n\n $$a_{\\frac{4}{4}}=a_{\\sqrt{4}}=\\frac{4}{4},a_n=\\frac{\\sqrt{4}}{\\sqrt{4}}\\times a_{n-\\frac{4}{4}}+4^{4-4}\\times a_{n-\\sqrt{4}}(n\\ge \\sqrt{4}+\\frac{4}{4})$$  \n  \n$$b_n=\\prod^{n+K-\\frac{4}{4}}_{i=n}a_i$$   \n\n求 $\\sum\\limits_{i=m}^n b_i$\n\n角落里还有一行小字：**_ 不要翻到最后一页，不然会有可怕的事情发生 _**。但是在这个时候，小 K 早已经闭上了双眼，鼾声和远处的雷声混成一片。\n\n一阵微风吹来，轻轻地，谁也没有意识到。本子的一角被风扬起，滑过一个优美的弧线，落在了本子的另一边。风一阵一阵的吹来，拂过本子发黄的书页。渐渐地，右边的书页少了，左边的书页多了。风停了，本子的倒数第二页停在半空中。在一刹那，似乎一切都静止了。然后，它轻轻地落在了其它书页的最上面。\n\n最后一页上，赫然用鲜红色的歪歪扭扭的大字写着：\n\n# 这道题你已经拖了一个月了！限明天之前做完！\n\n这时候，你夜观天象，预测到了小 K 的这场劫难。时间已是 $23:59:59:400$，如果在这 $1000-400=600$ 毫秒内没有做完，小 K 的检讨将在劫难逃。身为小 K 的好朋友，你能帮他解决这个问题吗？\n", "description": "给定 $k,m,n$，求：  \n\n$$\\sum_{i=m}^n \\prod_{j=i}^{i+k-1} a_j$$\n\n答案对 $10^9 + 7$ 取模。   \n其中 $\\{ a\\}$ 为 fibonacci 数列。", "inputFormat": "三个正整数，分别表示 $k,m,n$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "$a_1=1,a_2=1,a_3=2,a_4=3,a_5=5,a_6=8$。\n\n对于样例1：\n\n$$K=4$$\n$$b_1=1\\times1\\times2\\times3=6,b_2=1\\times2\\times3\\times5=30,b_3=2\\times3\\times5\\times8=240$$\n$$\\sum_{i=1}^{3}b_i=276$$\n\n对于样例2：\n\n$$K=3$$\n$$b_2=1\\times2\\times3=6,b_3=2\\times3\\times5=30$$\n$$\\sum_{i=2}^{3}b_i=36$$\n\n本题共有 $20$ 个数据点，每个数据点的分数均为 $5$ 分，总分为 $100$ 分。每个数据点的性质如下：\n\n(**出题人不想再用 $4$ 表示任何数了！**~~真香~~)\n\n| 编号 | $K,M,N$范围 | 特殊性质 |\n| :-----------: | :-----------: | :-----------: |\n|  $1$ |$1\\le m\\le n\\le 10^6,k=4$|无 |\n|  $2$ |$1\\le m\\le n\\le 10^{18},k=4$  | $n-m\\le 10^6$ |\n|  $3\\sim 4$ | $1\\le m\\le n\\le 10^{18},k=4$  |无|\n| $5\\sim 6$  |  $1\\le m\\le n\\le 4^{4^4},k=4$  | $n-m\\le 10^6$ |\n|  $7\\sim 10$ | $1\\le m\\le n\\le 4^{4^7},k=4$ | 无 |\n|  $11\\sim 12$ | $1\\le m\\le n\\le 4^{6000},2\\le k\\le 10$| 无 |\n|  $13\\sim 14$ | $1\\le m\\le n\\le 10^{41},2\\le k\\le 10$| 无 |\n| $15\\sim 20$  |$1\\le m\\le n\\le 10^{41},2\\le k\\le 50$| 无 |\n\n**（注意，题面中的数据范围只是大致描述，请以以上具体范围为准）**\n\n$a^{b^c}=a^{(b^c)}$", "locale": "zh-CN", "translations": {"en": {"title": "Ghost Story", "background": "### _Let me tell you a ghost story_\nOne night, a heavy rainstorm was pouring down. Little K was doing the endless informatics problems assigned by his teacher in his tiny study. With the door and windows closed, it inevitably felt a bit hot and stuffy. Little K stood up and opened the window beside his desk by a tiny crack, so small that no raindrops could drift in through it.\n\nToday happened to be the 15th day of the 7th lunar month, the Zhongyuan Festival, also known as the Ghost Festival. Little K had never stayed up so late on such a day, because Little K was superstitious and afraid that after midnight, ghosts and monsters would appear. However, today, Little K had no choice.\n\nLittle K looked at the time: $23:54$. Seeing the $4$, Little K frowned. $4$ sounds like “death” in Chinese, which is especially unlucky. Seeing such a number on a day like this is often a bad omen.\n\nLittle K’s eyelids were fighting. He never did “toxic” problems. He simply lay down on the desk, and his eyes gradually became blurry.\n\n“There is a notebook over there,” he thought. At some point, on the corner of his desk near the window, a soaked notebook lay quietly, as if it had just been rained on. “How did it get in?” Little K murmured. Subconsciously, he flipped it open and saw that some words were written inside. For some reason, those words looked so red on the yellowing paper.\n\nThe page on the left said:\n\n $$4^{4-4}\\le M\\le N\\le 4^{4^{(4+4-\\frac{4}{4})}},\\sqrt{4}\\le K\\le 4^{\\sqrt{4}}\\times(4-\\frac{4}{4})+\\sqrt{4}$$\n\nThe page on the right seemed longer than the left:\n\n $$a_{\\frac{4}{4}}=a_{\\sqrt{4}}=\\frac{4}{4},a_n=\\frac{\\sqrt{4}}{\\sqrt{4}}\\times a_{n-\\frac{4}{4}}+4^{4-4}\\times a_{n-\\sqrt{4}}(n\\ge \\sqrt{4}+\\frac{4}{4})$$  \n  \n$$b_n=\\prod^{n+K-\\frac{4}{4}}_{i=n}a_i$$   \n\nFind $\\sum\\limits_{i=m}^n b_i$.\n\nIn the corner there was also a line of small text: **_Do not flip to the last page, or something terrifying will happen_**. But at this moment, Little K had already closed his eyes, and his snoring blended together with the distant thunder.\n\nA breeze came, softly, and no one noticed. One corner of the notebook was lifted by the wind, slid through a graceful arc, and fell onto the other side of the notebook. The wind blew in gusts, brushing over the notebook’s yellowed pages. Gradually, there were fewer pages on the right and more pages on the left. The wind stopped, and the second-to-last page hung in midair. In an instant, it seemed that everything froze. Then, it gently fell on top of the other pages.\n\nOn the last page, in bright red crooked large letters, it read:\n\n# You have been procrastinating on this problem for a whole month! Finish it before tomorrow!\n\nAt this time, by observing the sky, you predicted Little K’s coming disaster. The time was already $23:59:59:400$. If it was not finished within these $1000-400=600$ milliseconds, Little K’s self-criticism (jiǎntǎo) would be unavoidable. As Little K’s good friend, can you help him solve this problem?", "description": "Given $k,m,n$, find:\n\n$$\\sum_{i=m}^n \\prod_{j=i}^{i+k-1} a_j$$\n\nTake the answer modulo $10^9 + 7$.  \nHere $\\{ a\\}$ is the Fibonacci sequence.", "inputFormat": "Three positive integers, representing $k,m,n$ respectively.", "outputFormat": "Output one line with one integer, representing the answer.", "hint": "$a_1=1,a_2=1,a_3=2,a_4=3,a_5=5,a_6=8$.\n\nFor Sample 1:\n\n$$K=4$$\n$$b_1=1\\times1\\times2\\times3=6,b_2=1\\times2\\times3\\times5=30,b_3=2\\times3\\times5\\times8=240$$\n$$\\sum_{i=1}^{3}b_i=276$$\n\nFor Sample 2:\n\n$$K=3$$\n$$b_2=1\\times2\\times3=6,b_3=2\\times3\\times5=30$$\n$$\\sum_{i=2}^{3}b_i=36$$\n\nThis problem has $20$ test points. Each test point is worth $5$ points, for a total of $100$ points. The properties of each test point are as follows:\n\n(**The problem setter does not want to use $4$ to represent any number anymore!** ~~so true~~)\n\n| ID | Constraints on $K,M,N$ | Special Property |\n| :-----------: | :-----------: | :-----------: |\n|  $1$ |$1\\le m\\le n\\le 10^6,k=4$| None |\n|  $2$ |$1\\le m\\le n\\le 10^{18},k=4$  | $n-m\\le 10^6$ |\n|  $3\\sim 4$ | $1\\le m\\le n\\le 10^{18},k=4$  | None |\n| $5\\sim 6$  |  $1\\le m\\le n\\le 4^{4^4},k=4$  | $n-m\\le 10^6$ |\n|  $7\\sim 10$ | $1\\le m\\le n\\le 4^{4^7},k=4$ | None |\n|  $11\\sim 12$ | $1\\le m\\le n\\le 4^{6000},2\\le k\\le 10$| None |\n|  $13\\sim 14$ | $1\\le m\\le n\\le 10^{41},2\\le k\\le 10$| None |\n| $15\\sim 20$  |$1\\le m\\le n\\le 10^{41},2\\le k\\le 50$| None |\n\n**(Note: the Constraints described in the statement are only approximate. Please refer to the specific ranges above.)**\n\n$a^{b^c}=a^{(b^c)}$\n\n# Input Format\n\nThree positive integers, representing $k,m,n$ respectively.\n\n# Output Format\n\nOutput one line with one integer, representing the answer.\n\n# Hint\n\n$a_1=1,a_2=1,a_3=2,a_4=3,a_5=5,a_6=8$。\n\nFor Sample 1:\n\n$$K=4$$\n$$b_1=1\\times1\\times2\\times3=6,b_2=1\\times2\\times3\\times5=30,b_3=2\\times3\\times5\\times8=240$$\n$$\\sum_{i=1}^{3}b_i=276$$\n\nFor Sample 2:\n\n$$K=3$$\n$$b_2=1\\times2\\times3=6,b_3=2\\times3\\times5=30$$\n$$\\sum_{i=2}^{3}b_i=36$$\n\nThis problem has $20$ test points. Each test point is worth $5$ points, for a total of $100$ points. The properties of each test point are as follows:\n\n(**The problem setter does not want to use $4$ to represent any number anymore!** ~~so true~~)\n\n| ID | Constraints on $K,M,N$ | Special Property |\n| :-----------: | :-----------: | :-----------: |\n|  $1$ |$1\\le m\\le n\\le 10^6,k=4$| None |\n|  $2$ |$1\\le m\\le n\\le 10^{18},k=4$  | $n-m\\le 10^6$ |\n|  $3\\sim 4$ | $1\\le m\\le n\\le 10^{18},k=4$  | None |\n| $5\\sim 6$  |  $1\\le m\\le n\\le 4^{4^4},k=4$  | $n-m\\le 10^6$ |\n|  $7\\sim 10$ | $1\\le m\\le n\\le 4^{4^7},k=4$ | None |\n|  $11\\sim 12$ | $1\\le m\\le n\\le 4^{6000},2\\le k\\le 10$| None |\n|  $13\\sim 14$ | $1\\le m\\le n\\le 10^{41},2\\le k\\le 10$| None |\n| $15\\sim 20$  |$1\\le m\\le n\\le 10^{41},2\\le k\\le 50$| None |\n\n**(Note: the Constraints described in the statement are only approximate. Please refer to the specific ranges above.)**\n\n$a^{b^c}=a^{(b^c)}$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "鬼故事", "background": "### _给大家讲个鬼故事_\n有一天晚上，下着大暴雨。小 K 正在他那小小的书房里做着老师给他布置的、数也数不完的信息题目。关着门，关着窗难免有些闷热。小 K 起身，将书桌前的窗子打开一个小小的细缝，小到没有雨点能透过缝隙飘进来。\n\n今天正是农历七月十五日，中元节，俗称鬼节。小 K 从来都没有在这种日子这么晚睡过，因为小 K 迷信，害怕午夜之后，便有鬼怪出没。然而今天，小 K 无可奈何。\n\n小 K 看了看时间：$23:54$。看到 $4$，小 K 皱了皱眉眉头。$4$，谐音是“死”，特别不吉利。在这种日子看到这样的字眼，往往都是不祥之兆。\n\n小 K 的眼皮在打架。他从来都不会做毒瘤题。他索性趴到了书桌上面，两只眼睛渐渐朦胧了起来。\n\n“那儿有一个本子。”他想着。不知道何时，他的书桌靠窗的一角上，静静地躺着一个湿漉漉的本子，好像是刚刚淋过雨。“它是怎么进来的？”小 K 喃喃道。他下意识地翻开那本本子，看到里面有写了一些字。不知道为什么，那些字在发黄的纸页上看起来也那么红。\n\n左边的那一页写着：\n\n $$4^{4-4}\\le M\\le N\\le 4^{4^{(4+4-\\frac{4}{4})}},\\sqrt{4}\\le K\\le 4^{\\sqrt{4}}\\times(4-\\frac{4}{4})+\\sqrt{4}$$\n\n右边的那一页写着的似乎比左边的要长：\n\n $$a_{\\frac{4}{4}}=a_{\\sqrt{4}}=\\frac{4}{4},a_n=\\frac{\\sqrt{4}}{\\sqrt{4}}\\times a_{n-\\frac{4}{4}}+4^{4-4}\\times a_{n-\\sqrt{4}}(n\\ge \\sqrt{4}+\\frac{4}{4})$$  \n  \n$$b_n=\\prod^{n+K-\\frac{4}{4}}_{i=n}a_i$$   \n\n求 $\\sum\\limits_{i=m}^n b_i$\n\n角落里还有一行小字：**_ 不要翻到最后一页，不然会有可怕的事情发生 _**。但是在这个时候，小 K 早已经闭上了双眼，鼾声和远处的雷声混成一片。\n\n一阵微风吹来，轻轻地，谁也没有意识到。本子的一角被风扬起，滑过一个优美的弧线，落在了本子的另一边。风一阵一阵的吹来，拂过本子发黄的书页。渐渐地，右边的书页少了，左边的书页多了。风停了，本子的倒数第二页停在半空中。在一刹那，似乎一切都静止了。然后，它轻轻地落在了其它书页的最上面。\n\n最后一页上，赫然用鲜红色的歪歪扭扭的大字写着：\n\n# 这道题你已经拖了一个月了！限明天之前做完！\n\n这时候，你夜观天象，预测到了小 K 的这场劫难。时间已是 $23:59:59:400$，如果在这 $1000-400=600$ 毫秒内没有做完，小 K 的检讨将在劫难逃。身为小 K 的好朋友，你能帮他解决这个问题吗？\n", "description": "给定 $k,m,n$，求：  \n\n$$\\sum_{i=m}^n \\prod_{j=i}^{i+k-1} a_j$$\n\n答案对 $10^9 + 7$ 取模。   \n其中 $\\{ a\\}$ 为 fibonacci 数列。", "inputFormat": "三个正整数，分别表示 $k,m,n$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "$a_1=1,a_2=1,a_3=2,a_4=3,a_5=5,a_6=8$。\n\n对于样例1：\n\n$$K=4$$\n$$b_1=1\\times1\\times2\\times3=6,b_2=1\\times2\\times3\\times5=30,b_3=2\\times3\\times5\\times8=240$$\n$$\\sum_{i=1}^{3}b_i=276$$\n\n对于样例2：\n\n$$K=3$$\n$$b_2=1\\times2\\times3=6,b_3=2\\times3\\times5=30$$\n$$\\sum_{i=2}^{3}b_i=36$$\n\n本题共有 $20$ 个数据点，每个数据点的分数均为 $5$ 分，总分为 $100$ 分。每个数据点的性质如下：\n\n(**出题人不想再用 $4$ 表示任何数了！**~~真香~~)\n\n| 编号 | $K,M,N$范围 | 特殊性质 |\n| :-----------: | :-----------: | :-----------: |\n|  $1$ |$1\\le m\\le n\\le 10^6,k=4$|无 |\n|  $2$ |$1\\le m\\le n\\le 10^{18},k=4$  | $n-m\\le 10^6$ |\n|  $3\\sim 4$ | $1\\le m\\le n\\le 10^{18},k=4$  |无|\n| $5\\sim 6$  |  $1\\le m\\le n\\le 4^{4^4},k=4$  | $n-m\\le 10^6$ |\n|  $7\\sim 10$ | $1\\le m\\le n\\le 4^{4^7},k=4$ | 无 |\n|  $11\\sim 12$ | $1\\le m\\le n\\le 4^{6000},2\\le k\\le 10$| 无 |\n|  $13\\sim 14$ | $1\\le m\\le n\\le 10^{41},2\\le k\\le 10$| 无 |\n| $15\\sim 20$  |$1\\le m\\le n\\le 10^{41},2\\le k\\le 50$| 无 |\n\n**（注意，题面中的数据范围只是大致描述，请以以上具体范围为准）**\n\n$a^{b^c}=a^{(b^c)}$", "locale": "zh-CN"}}}
{"pid": "P5127", "type": "P", "difficulty": 6, "samples": [["3 4\n1 2\n1 3\n1 1 1\n1 1 1\n2 1 3 1\n2 3 3 1\n1 1 3", "1\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "子异和", "background": "", "description": "小L和小K正在激烈地讨论着。\n\n（你不用知道谁说的哪句话……）\n\n“你知道非空子集吗？”\n\n“当然知道啊！比如说集合$\\{1,2,3\\}$，它的所有非空子集就是$\\{1\\},\\{2\\},\\{3\\},\\{1,2\\},\\{2,3\\},\\{1,3\\},\\{1,2,3\\}$。”\n\n“那你知道每个非空子集里的数的亦或和是多少吗？”\n\n“也知道啊，不就是$1,2,3,1⊕2=3,2⊕3=1,1⊕3=2,1⊕2⊕3=0$吗。”\n\n“那你知道它们的和是多少吗？我们把它叫做子异和。”\n\n“子异和……这个名字好奇怪啊，不过我知道，是$1+2+3+3+1+2+0=12$。”\n\n“那我问你，$\\{a_1,a_2,...,a_n\\}$的子异和是多少？”\n\n“慢慢暴力算呗！”\n\n“如果$n\\le 200000$呢？”\n\n“……”\n\n“如果把问题放在一颗树上呢？”\n\n“……那你会不会做啊？”\n\n“当然……不会做……”\n\n现在，只有你能帮助小L和小K了，请你帮忙解决这个问题。\n\n**为了更清晰的表达题意，我们再做一次解释。**\n\n有一个$n$个节点的树，总共有$m$次操作。这些操作按照操作顺序输入。每次操作可能是询问或修改。\n\n每次询问操作会给出两个节点编号$a,b$。根据常识，$a,b$在树上有唯一路径。我们设这条路径经过的所有点的点权集合为$S$。你要输出$S$的子异和。答案$mod\\space(10^9+7)$。\n\n每次修改操作会给出两个节点编号$a,b$与一个整数值$c$。你要将节点$a$到节点$b$的唯一路径上的所有点的点权分别异或$c$。\n\n**这里的集合指可重集合**", "inputFormat": "第一行三个正整数$n,m$。\n\n接下来$n-1$行，每行两个正整数$a,b$，表示节点$a$和$b$之间有一条边。不会出现重边与自环。\n\n接下来一行$n$个非负整数，第$i$个非负整数表示$i$节点的初始点权。\n\n接下来$m$行，每行若干个整数，表示$m$个操作的信息。每行第一个整数只可能是$1$或$2$。如果是$1$，则此操作为询问，接下来两个数为$a,b$；如果是$2$，则此操作为修改，接下来三个数为$a,b,c$。", "outputFormat": "对于每一个询问，输出一行表示答案。", "hint": "样例解释：\n\n第一次询问，$1$到$1$的路径经过$1$号节点，点权组成的集合为$\\{1\\}$，子异和为$1$。\n\n两次修改后，$1$号点点权为$0$，$3$号点点权为$1$。\n\n第二次询问，$1$到$3$的路径经过的点权集合为$\\{0,1\\}$，子异和为$0+1+1=2$。\n\n本题共有$10$个测试点，每个测试点$10$分，总分为$100$分。\n\n| 测试点编号 | $n$的范围 | $m$的范围 | 特殊性质 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1-2$ | $1\\le n\\le 1000$ | $1\\le m\\le 1000$ | 无 |\n| $3-5$ | $1\\le n\\le 200000$ | $1\\le m\\le 200000$ | 每条边连接的两个节点编号均相邻 |\n| $6-10$ | $1\\le n\\le 200000$ | $1\\le m\\le 200000$ | 无 |\n\n对于$100\\%$的数据：\n\n输入的数均为不大于$10^9+7$的非负整数，$1\\le a,b\\le n$。", "locale": "zh-CN", "translations": {"en": {"title": "Subset XOR Sum.", "background": "", "description": "Xiao L and Xiao K are having a heated discussion.\n\n(You do not need to know who said which line...)\n\n“Do you know non-empty subsets?”\n\n“Of course! For example, for the set $\\{1,2,3\\}$, all of its non-empty subsets are $\\{1\\},\\{2\\},\\{3\\},\\{1,2\\},\\{2,3\\},\\{1,3\\},\\{1,2,3\\}$.”\n\n“Then do you know the XOR sum of the numbers in each non-empty subset?”\n\n“I do! It is just $1,2,3,1⊕2=3,2⊕3=1,1⊕3=2,1⊕2⊕3=0$.”\n\n“Then do you know what their total sum is? We call it the subset XOR sum.”\n\n“Subset XOR sum... what a strange name, but I know it is $1+2+3+3+1+2+0=12$.”\n\n“Then let me ask you, what is the subset XOR sum of $\\{a_1,a_2,...,a_n\\}$?”\n\n“Just brute force it slowly!”\n\n“What if $n\\le 200000$?”\n\n“...”\n\n“What if we put the problem on a tree?”\n\n“... Can you solve it then?”\n\n“Of course... I cannot...”\n\nNow only you can help Xiao L and Xiao K. Please solve this problem.\n\n**To express the statement more clearly, we explain it again.**\n\nThere is a tree with $n$ nodes, and there are $m$ operations in total. These operations are given in order. Each operation is either a query or a modification.\n\nEach query operation gives two node indices $a,b$. As is well known, there is a unique path between $a$ and $b$ on the tree. Let the multiset of node weights of all nodes on this path be $S$. You need to output the subset XOR sum of $S$. The answer is taken $mod\\space(10^9+7)$.\n\nEach modification operation gives two node indices $a,b$ and an integer value $c$. You need to XOR the weight of every node on the unique path from node $a$ to node $b$ by $c$.\n\n**Here, “set” means multiset.**", "inputFormat": "The first line contains three positive integers $n,m$.\n\nThe next $n-1$ lines each contain two positive integers $a,b$, meaning there is an edge between node $a$ and node $b$. There will be no multiple edges or self-loops.\n\nThe next line contains $n$ non-negative integers. The $i$-th non-negative integer is the initial weight of node $i$.\n\nThe next $m$ lines each contain several integers describing an operation. The first integer of each line is either $1$ or $2$. If it is $1$, then this operation is a query, and the next two numbers are $a,b$; if it is $2$, then this operation is a modification, and the next three numbers are $a,b,c$.", "outputFormat": "For each query, output one line containing the answer.", "hint": "Sample explanation:\n\nFor the first query, the path from $1$ to $1$ passes through node $1$, the multiset of node weights is $\\{1\\}$, and the subset XOR sum is $1$.\n\nAfter two modifications, the weight of node $1$ is $0$, and the weight of node $3$ is $1$.\n\nFor the second query, the multiset of node weights on the path from $1$ to $3$ is $\\{0,1\\}$, and the subset XOR sum is $0+1+1=2$.\n\nThis problem has $10$ test points. Each test point is worth $10$ points, for a total of $100$ points.\n\n| Test point ID | Range of $n$ | Range of $m$ | Special property |\n| :----------: | :----------: | :----------: | :----------: |\n| $1-2$ | $1\\le n\\le 1000$ | $1\\le m\\le 1000$ | None |\n| $3-5$ | $1\\le n\\le 200000$ | $1\\le m\\le 200000$ | The indices of the two nodes connected by each edge are adjacent |\n| $6-10$ | $1\\le n\\le 200000$ | $1\\le m\\le 200000$ | None |\n\nConstraints:\n\nFor $100\\%$ of the data, all input numbers are non-negative integers not greater than $10^9+7$, and $1\\le a,b\\le n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "子异和", "background": "", "description": "小L和小K正在激烈地讨论着。\n\n（你不用知道谁说的哪句话……）\n\n“你知道非空子集吗？”\n\n“当然知道啊！比如说集合$\\{1,2,3\\}$，它的所有非空子集就是$\\{1\\},\\{2\\},\\{3\\},\\{1,2\\},\\{2,3\\},\\{1,3\\},\\{1,2,3\\}$。”\n\n“那你知道每个非空子集里的数的亦或和是多少吗？”\n\n“也知道啊，不就是$1,2,3,1⊕2=3,2⊕3=1,1⊕3=2,1⊕2⊕3=0$吗。”\n\n“那你知道它们的和是多少吗？我们把它叫做子异和。”\n\n“子异和……这个名字好奇怪啊，不过我知道，是$1+2+3+3+1+2+0=12$。”\n\n“那我问你，$\\{a_1,a_2,...,a_n\\}$的子异和是多少？”\n\n“慢慢暴力算呗！”\n\n“如果$n\\le 200000$呢？”\n\n“……”\n\n“如果把问题放在一颗树上呢？”\n\n“……那你会不会做啊？”\n\n“当然……不会做……”\n\n现在，只有你能帮助小L和小K了，请你帮忙解决这个问题。\n\n**为了更清晰的表达题意，我们再做一次解释。**\n\n有一个$n$个节点的树，总共有$m$次操作。这些操作按照操作顺序输入。每次操作可能是询问或修改。\n\n每次询问操作会给出两个节点编号$a,b$。根据常识，$a,b$在树上有唯一路径。我们设这条路径经过的所有点的点权集合为$S$。你要输出$S$的子异和。答案$mod\\space(10^9+7)$。\n\n每次修改操作会给出两个节点编号$a,b$与一个整数值$c$。你要将节点$a$到节点$b$的唯一路径上的所有点的点权分别异或$c$。\n\n**这里的集合指可重集合**", "inputFormat": "第一行三个正整数$n,m$。\n\n接下来$n-1$行，每行两个正整数$a,b$，表示节点$a$和$b$之间有一条边。不会出现重边与自环。\n\n接下来一行$n$个非负整数，第$i$个非负整数表示$i$节点的初始点权。\n\n接下来$m$行，每行若干个整数，表示$m$个操作的信息。每行第一个整数只可能是$1$或$2$。如果是$1$，则此操作为询问，接下来两个数为$a,b$；如果是$2$，则此操作为修改，接下来三个数为$a,b,c$。", "outputFormat": "对于每一个询问，输出一行表示答案。", "hint": "样例解释：\n\n第一次询问，$1$到$1$的路径经过$1$号节点，点权组成的集合为$\\{1\\}$，子异和为$1$。\n\n两次修改后，$1$号点点权为$0$，$3$号点点权为$1$。\n\n第二次询问，$1$到$3$的路径经过的点权集合为$\\{0,1\\}$，子异和为$0+1+1=2$。\n\n本题共有$10$个测试点，每个测试点$10$分，总分为$100$分。\n\n| 测试点编号 | $n$的范围 | $m$的范围 | 特殊性质 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1-2$ | $1\\le n\\le 1000$ | $1\\le m\\le 1000$ | 无 |\n| $3-5$ | $1\\le n\\le 200000$ | $1\\le m\\le 200000$ | 每条边连接的两个节点编号均相邻 |\n| $6-10$ | $1\\le n\\le 200000$ | $1\\le m\\le 200000$ | 无 |\n\n对于$100\\%$的数据：\n\n输入的数均为不大于$10^9+7$的非负整数，$1\\le a,b\\le n$。", "locale": "zh-CN"}}}
{"pid": "P5128", "type": "P", "difficulty": 5, "samples": [["5 3", "8"], ["99 10", "189"], ["377377377377 60", "139733"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "好时光", "background": "# 如果您不想在读题上消耗太多时间，请直接滑到页面最底部查看简述版题面。\n\n光阴似箭，日月如梭。时光如流水般，一刻不停地冲刷着一切。转眼间，初三已经到来了。巨量的作业，紧张的考试，无不使小L和小K准备NOIP的时间越来越少……", "description": "逃不掉的一天还是来了，小L一个人坐在教室里，看着窗外发呆。\n\n操场还没修完，天上空空荡荡的，夕阳的余晖刚刚在灰色的高楼旁涂上一抹血红，瞬间便消失了，不留下一点痕迹。飒飒的秋风从窗外吹进来，教室里响起了哗啦啦的书页被翻动的声音，书被翻到了画上了小L和小K共同的涂鸦的那一页。被揉成一团的成绩条在桌上滚来滚去，像难解的心结。天上没有一颗星星——大概是因为心头吹不散的乌云吧。\n\n小L的文化课月考考炸了，NOIP初赛也极度不理想，很可能是进不了复赛了。\n\n至于心头吹不散的乌云，就让它在那里吧，反正自己也没有机会去改变什么了。\n\n如果不是初三的紧张的节奏，大家大概不会这么轻易地分道扬镳吧？ 只见一个又一个昔日的队友离开了机房。\n\n唉，自己也大概要离开机房了吧。小L想到。\n\n这时，他想起了与小K相处的每一个好时光。\n\n从初一的军训中一个个挺拔的身影，到讲台前两个激烈讨论着的声音,省赛时颓废的场景，以及一起在机房奋斗过的日日夜夜……\n\n忆起这些好时光，他的心里暖暖的。他觉得和小K在一起的每一秒都是值得珍惜的好时光。\n\n这时，小K来到了小L的身边，知道了小L的愿望。小L想对他与小K相处的每一秒计算一个值得珍惜的价值，如果把这些价值都加起来，小L就会将这些好时光都记在心里，心情也会好起来了。\n\n小L是这样计算一个时间的价值的：他先将每一秒从 $1$ 开始顺序编号，再将时间（这个秒数）转换为时-分-秒形式。由于某种原因，小L的一分钟只有 $k$ 秒（此处应有滑稽），所以小L认为一小时也只有 $k$ 分钟。你可以认为小L将秒数转成了$k$ 进制。由于小L没有那么毒瘤，所以这里的 $k$ 都是整数。然后他观察这个 $k$ 进制数，找到其中最长的连续等差数列的长度（只考虑单个数码组成的连续的区间的情况，也就是说如 $10$ 进制下的 $123456789101112$ 不能称为等差数列） ，将其记为这一秒的价值。\n\n小K非常想帮他算出这些秒（从 $1$ 秒到 $n$ 秒）的总价值，以安慰伤心的小L。但是这个总秒数 $n$ 实在是太长太长了，以至于小K要超过一秒的时间才能算出一秒的价值，这样小L和小K在一起的时间就可以**无限延长**了。小L非常希望能这样，但是显然他们并没有这么多这么多的时间。\n\n小K找到了精通 $OI$ 的你。为了避免计算过程中秒数还在增加，你需要在 $1$ 秒钟内计算出答案。由于答案可能会很大，小L愿意接受这个数取模 $19260821$ 后的结果。", "inputFormat": "输入共一行，两个整数 $n$ 和 $k$。输入的$n$为十进制表示形式。", "outputFormat": "输出共一行，一个整数，为价值之和取模 $19260821$ 后的值。", "hint": "样例 $\\#1$ 解释：\n\n$1$到$5$转成$3$进制分别是$1,2,10,11,12$，每个数的价值恰好是它的长度，所以总价值为$1+1+2+2+2=8$。\n\n对于 $10\\%$ 的数据， $1\\le n\\le 10^6,k=60$；\n\n对于另外 $10\\%$ 的数据， $k=10$；\n\n对于 $40\\%$ 的数据， $2\\le k\\le 20,1\\le n\\le k^{10}$； \n\n对于 $100\\%$  的数据， $2\\le k\\le 60,1\\le n\\le k^{18}$ 。\n\n** 数据没有梯度！！！ **\n\n# 小L教你学数学\n\n**等差数列**：等差数列是指从第二项起，每一项与它的前一项的差等于同一个常数的一种数列，这个常数叫做等差数列的公差。 ** 公差可以为任意实数。 ** 也就是说，这个数列可以是递增的，递减的，或者恒为定值的（公差为$0$）。\n\n## 简述版题面：\n\n给出 $n,k$ ， 求 $\\sum_{i=1}^n f(i,k)$ 的值， $f(i,k)$ 定义为将十进制整数 $i$ 表示为 $k$ 进制时写成一个数列的形式中的最长连续子串为等差数列的长度。答案取模 $19260821$ 。\n\n## 一些闲话\n\n由于小L被赶去学文化课了，所以本题题面的扩写就咕咕咕啦！", "locale": "zh-CN", "translations": {"en": {"title": "Good Times.", "background": "# If you do not want to spend too much time reading the statement, please scroll to the bottom of the page to see the simplified version.\n\nTime flies. Time is like running water, constantly washing over everything. In the blink of an eye, the third year of junior high has arrived. A huge amount of homework and tense exams leave Xiao L and Xiao K less and less time to prepare for NOIP.", "description": "The unavoidable day finally came. Xiao L sat alone in the classroom, staring out the window in a daze.\n\nThe playground was not finished yet, the sky was empty, and the afterglow of the sunset had just painted a trace of blood-red beside the gray high-rises, then vanished in an instant without leaving any mark. The rustling autumn wind blew in through the window, and the classroom filled with the sound of pages turning. The book was flipped to a page with the doodles that Xiao L and Xiao K had drawn together. A crumpled score slip rolled back and forth on the desk like a hard-to-untie knot. There was not a single star in the sky—perhaps because of the dark clouds in his heart that could not be blown away.\n\nXiao L did terribly on the monthly exam for general subjects, and the NOIP preliminary round also went extremely poorly. It was very likely that he would not make it to the next round.\n\nAs for those dark clouds that could not be blown away, let them stay there. Anyway, there was no chance to change anything.\n\nIf it were not for the stressful pace of the third year, perhaps everyone would not have gone their separate ways so easily. One former teammate after another left the computer room.\n\nSigh, I will probably have to leave the computer room too, Xiao L thought.\n\nAt that moment, he remembered every good time he had spent with Xiao K.\n\nFrom the upright figures during the military training in the first year, to the two voices arguing fiercely in front of the podium, to the depressing scenes at the provincial contest, and to the days and nights they struggled together in the computer room...\n\nThinking of those good times made his heart feel warm. He felt that every second with Xiao K was worth cherishing.\n\nThen Xiao K came to Xiao L, learned about Xiao L’s wish, and Xiao L wanted to assign a “value worth cherishing” to every second he spent with Xiao K. If he added up all these values, Xiao L would keep all those good times in his heart, and his mood would get better.\n\nXiao L computes the value of a time moment like this: he first numbers each second sequentially starting from $1$, then converts the time (this second number) into the hour-minute-second form. For some reason, one minute for Xiao L has only $k$ seconds (a joke should be here), so Xiao L thinks that one hour also has only $k$ minutes. You may regard this as converting the second number into base $k$. Since Xiao L is not that evil, $k$ is always an integer here. Then he looks at this base-$k$ number and finds the length of the longest consecutive arithmetic progression inside it (only considering the case of a consecutive interval made up of single digits; that is, something like $123456789101112$ in base $10$ cannot be considered an arithmetic progression), and he records this length as the value of that second.\n\nXiao K really wants to help compute the total value of these seconds (from second $1$ to second $n$) to comfort the sad Xiao L. But the total number of seconds $n$ is far, far too large, so large that Xiao K would need more than one second to compute the value of a single second, and then the time Xiao L and Xiao K spend together could be **extended infinitely**. Xiao L very much hopes for that, but clearly they do not have that much time.\n\nXiao K found you, who are proficient in $OI$. To avoid the second number increasing during computation, you need to compute the answer within $1$ second. Since the answer may be very large, Xiao L accepts the result modulo $19260821$.\n\n## Simplified statement:\n\nGiven $n,k$, compute $\\sum_{i=1}^n f(i,k)$, where $f(i,k)$ is defined as follows: write the decimal integer $i$ in base $k$ as a sequence of digits, and take the length of the longest contiguous substring that forms an arithmetic progression. Output the answer modulo $19260821$.\n\n## Some extra words\n\nBecause Xiao L was driven to study general subjects, the expanded story part of this statement is “to be continued”!", "inputFormat": "One line with two integers $n$ and $k$. The input $n$ is given in decimal.", "outputFormat": "One line with one integer: the sum of values modulo $19260821$.", "hint": "Explanation for sample $\\#1$:\n\n$1$ to $5$ in base $3$ are $1,2,10,11,12$. The value of each number is exactly its length, so the total value is $1+1+2+2+2=8$.\n\nFor $10\\%$ of the testdata, $1\\le n\\le 10^6,k=60$.\n\nFor another $10\\%$ of the testdata, $k=10$.\n\nFor $40\\%$ of the testdata, $2\\le k\\le 20,1\\le n\\le k^{10}$.\n\nFor $100\\%$ of the testdata, $2\\le k\\le 60,1\\le n\\le k^{18}$.\n\n**There are no subtasks (no gradient in the data)!!!**\n\n# Xiao L teaches you math\n\n**Arithmetic progression**: An arithmetic progression is a sequence in which, starting from the second term, the difference between each term and the previous term is the same constant. This constant is called the common difference of the arithmetic progression. **The common difference can be any real number.** That is, the sequence may be increasing, decreasing, or constant (common difference $0$).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "好时光", "background": "# 如果您不想在读题上消耗太多时间，请直接滑到页面最底部查看简述版题面。\n\n光阴似箭，日月如梭。时光如流水般，一刻不停地冲刷着一切。转眼间，初三已经到来了。巨量的作业，紧张的考试，无不使小L和小K准备NOIP的时间越来越少……", "description": "逃不掉的一天还是来了，小L一个人坐在教室里，看着窗外发呆。\n\n操场还没修完，天上空空荡荡的，夕阳的余晖刚刚在灰色的高楼旁涂上一抹血红，瞬间便消失了，不留下一点痕迹。飒飒的秋风从窗外吹进来，教室里响起了哗啦啦的书页被翻动的声音，书被翻到了画上了小L和小K共同的涂鸦的那一页。被揉成一团的成绩条在桌上滚来滚去，像难解的心结。天上没有一颗星星——大概是因为心头吹不散的乌云吧。\n\n小L的文化课月考考炸了，NOIP初赛也极度不理想，很可能是进不了复赛了。\n\n至于心头吹不散的乌云，就让它在那里吧，反正自己也没有机会去改变什么了。\n\n如果不是初三的紧张的节奏，大家大概不会这么轻易地分道扬镳吧？ 只见一个又一个昔日的队友离开了机房。\n\n唉，自己也大概要离开机房了吧。小L想到。\n\n这时，他想起了与小K相处的每一个好时光。\n\n从初一的军训中一个个挺拔的身影，到讲台前两个激烈讨论着的声音,省赛时颓废的场景，以及一起在机房奋斗过的日日夜夜……\n\n忆起这些好时光，他的心里暖暖的。他觉得和小K在一起的每一秒都是值得珍惜的好时光。\n\n这时，小K来到了小L的身边，知道了小L的愿望。小L想对他与小K相处的每一秒计算一个值得珍惜的价值，如果把这些价值都加起来，小L就会将这些好时光都记在心里，心情也会好起来了。\n\n小L是这样计算一个时间的价值的：他先将每一秒从 $1$ 开始顺序编号，再将时间（这个秒数）转换为时-分-秒形式。由于某种原因，小L的一分钟只有 $k$ 秒（此处应有滑稽），所以小L认为一小时也只有 $k$ 分钟。你可以认为小L将秒数转成了$k$ 进制。由于小L没有那么毒瘤，所以这里的 $k$ 都是整数。然后他观察这个 $k$ 进制数，找到其中最长的连续等差数列的长度（只考虑单个数码组成的连续的区间的情况，也就是说如 $10$ 进制下的 $123456789101112$ 不能称为等差数列） ，将其记为这一秒的价值。\n\n小K非常想帮他算出这些秒（从 $1$ 秒到 $n$ 秒）的总价值，以安慰伤心的小L。但是这个总秒数 $n$ 实在是太长太长了，以至于小K要超过一秒的时间才能算出一秒的价值，这样小L和小K在一起的时间就可以**无限延长**了。小L非常希望能这样，但是显然他们并没有这么多这么多的时间。\n\n小K找到了精通 $OI$ 的你。为了避免计算过程中秒数还在增加，你需要在 $1$ 秒钟内计算出答案。由于答案可能会很大，小L愿意接受这个数取模 $19260821$ 后的结果。", "inputFormat": "输入共一行，两个整数 $n$ 和 $k$。输入的$n$为十进制表示形式。", "outputFormat": "输出共一行，一个整数，为价值之和取模 $19260821$ 后的值。", "hint": "样例 $\\#1$ 解释：\n\n$1$到$5$转成$3$进制分别是$1,2,10,11,12$，每个数的价值恰好是它的长度，所以总价值为$1+1+2+2+2=8$。\n\n对于 $10\\%$ 的数据， $1\\le n\\le 10^6,k=60$；\n\n对于另外 $10\\%$ 的数据， $k=10$；\n\n对于 $40\\%$ 的数据， $2\\le k\\le 20,1\\le n\\le k^{10}$； \n\n对于 $100\\%$  的数据， $2\\le k\\le 60,1\\le n\\le k^{18}$ 。\n\n** 数据没有梯度！！！ **\n\n# 小L教你学数学\n\n**等差数列**：等差数列是指从第二项起，每一项与它的前一项的差等于同一个常数的一种数列，这个常数叫做等差数列的公差。 ** 公差可以为任意实数。 ** 也就是说，这个数列可以是递增的，递减的，或者恒为定值的（公差为$0$）。\n\n## 简述版题面：\n\n给出 $n,k$ ， 求 $\\sum_{i=1}^n f(i,k)$ 的值， $f(i,k)$ 定义为将十进制整数 $i$ 表示为 $k$ 进制时写成一个数列的形式中的最长连续子串为等差数列的长度。答案取模 $19260821$ 。\n\n## 一些闲话\n\n由于小L被赶去学文化课了，所以本题题面的扩写就咕咕咕啦！", "locale": "zh-CN"}}}
{"pid": "P5129", "type": "P", "difficulty": 5, "samples": [["4\n1 4 2\n4 2 2 \n3 4 2\n2 3 2", "8426611"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "不可思议的迷宫", "background": "融合了强力的装备,当然要去探索迷宫了  ", "description": "然而，在你用一套神装愉快的切瓜切菜时，慧音大小姐对你发动了忘却技能，于是，没有融合\"记\"印记的你忘记了迷宫的构造。  \n\n由于在忘却前你对这个迷宫的构造已经了如指掌，所以你知道这个迷宫的 $ n $ 个房间都是互相连通的，并且有 $ n $ 条道路连接这些房间(当然，道路从两个方向都可以经过)    \n\n即使在不可思议的幻想乡，基本的常识也是存在的，也就是说不会有连接两个相同房间的道路，也不会有两端是同一个房间的道路。  \n\n忘记了迷宫的构造后，你无从得知你在哪里，以及前往下一层的通道在哪里.幸运的是，你保存了一份这个迷宫大致的地图，知道了这 $ n $ 条道路分别连接哪两个房间以及每条道路的长度。  \n\n为了通关，你会从你所在的位置(某个随机的位置)不重复经过道路地走向前往下一层的通道(某个随机的位置)，显然，这种路径可能不止 $1$ 条，那么这时你会随机选取其中一条。  \n\n现在，你想知道自己走过的路径的期望长度，为了避免精度误差，只要对 $19260817$ 取模就好了。      \n", "inputFormat": "第一行一个整数 $n$，表示房间以及道路的个数。  \n \n下面 $n$ 行每行三个整数 $u,v,w$，表示从房间 $u$ 到房间 $v$ 有一条长度为 $w$ 的道路。     \n", "outputFormat": "一行一个整数，表示期望路径长度。", "hint": "#### 样例解释:  \n\n迷宫的结构如下:  \n![](https://cdn.luogu.com.cn/upload/pic/42707.png)  \n起始点和结束点都是随机的，用二元组$(x,y)$表示  \n\n以几个有代表性的二元组为例:  \n\n$(1,1)$，只有一条长度为$0$的路径  \n\n$(1,2)$，有两条路径$1-4-2,1-4-3-2$，期望路径长度为 $\\frac{4+6}{2}=5$   \n$(3,3)$，有两条路径$3-2-4,3$，期望路径长度为 $\\frac{6+0}{2}=3$   \n\n不难算出，将所有可能的二元组的期望路径长度加在一起为$57$，所以答案为 $\\frac{57}{16}$ ,在模意义下等于 $8426611$。\n\n#### 数据范围:  \n\n![](https://cdn.luogu.com.cn/upload/pic/42697.png)", "locale": "zh-CN", "translations": {"en": {"title": "Incredible Maze.", "background": "After merging powerful equipment, of course you have to explore the maze.", "description": "However, when you were happily crushing enemies with a set of divine gear, Lady Keine cast a forgetting skill on you. As a result, without merging the \"Ki\" mark, you forgot the structure of the maze.\n\nSince before forgetting you already knew this maze inside out, you do know that the $n$ rooms in this maze are all connected to each other, and there are $n$ roads connecting these rooms (of course, each road can be traveled in both directions).\n\nEven in the incredible Gensokyo, basic common sense still exists. That is, there will not be a road connecting two identical rooms, and there will not be a road whose two ends are the same room.\n\nAfter forgetting the maze structure, you have no way to know where you are, nor where the passage to the next floor is. Fortunately, you kept a rough map of this maze, so you know which two rooms each of these $n$ roads connects, as well as the length of each road.\n\nTo clear the level, you will go from your current position (a random location) to the passage to the next floor (also a random location) without traversing any road more than once. Obviously, there may be more than $1$ such path, and in that case you will randomly choose one of them.\n\nNow you want to know the expected length of the path you walk. To avoid precision errors, you only need to take the result modulo $19260817$.", "inputFormat": "The first line contains an integer $n$, indicating the number of rooms and the number of roads.\n\nThe next $n$ lines each contain three integers $u, v, w$, indicating that there is a road of length $w$ between room $u$ and room $v$.", "outputFormat": "Output one integer on one line, representing the expected path length.", "hint": "#### Sample Explanation:\n\nThe structure of the maze is as follows:\n![](https://cdn.luogu.com.cn/upload/pic/42707.png)\nBoth the start point and the end point are random, represented by an ordered pair $(x, y)$.\n\nTake a few representative ordered pairs as examples:\n\n$(1,1)$: there is only one path of length $0$.\n\n$(1,2)$: there are two paths $1-4-2$ and $1-4-3-2$, and the expected path length is $\\frac{4+6}{2}=5$.\n\n$(3,3)$: there are two paths $3-2-4$ and $3$, and the expected path length is $\\frac{6+0}{2}=3$.\n\nIt is not hard to calculate that the sum of the expected path lengths over all possible ordered pairs is $57$, so the answer is $\\frac{57}{16}$, which equals $8426611$ under modulo arithmetic.\n\n#### Constraints:\n\n![](https://cdn.luogu.com.cn/upload/pic/42697.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "不可思议的迷宫", "background": "融合了强力的装备,当然要去探索迷宫了  ", "description": "然而，在你用一套神装愉快的切瓜切菜时，慧音大小姐对你发动了忘却技能，于是，没有融合\"记\"印记的你忘记了迷宫的构造。  \n\n由于在忘却前你对这个迷宫的构造已经了如指掌，所以你知道这个迷宫的 $ n $ 个房间都是互相连通的，并且有 $ n $ 条道路连接这些房间(当然，道路从两个方向都可以经过)    \n\n即使在不可思议的幻想乡，基本的常识也是存在的，也就是说不会有连接两个相同房间的道路，也不会有两端是同一个房间的道路。  \n\n忘记了迷宫的构造后，你无从得知你在哪里，以及前往下一层的通道在哪里.幸运的是，你保存了一份这个迷宫大致的地图，知道了这 $ n $ 条道路分别连接哪两个房间以及每条道路的长度。  \n\n为了通关，你会从你所在的位置(某个随机的位置)不重复经过道路地走向前往下一层的通道(某个随机的位置)，显然，这种路径可能不止 $1$ 条，那么这时你会随机选取其中一条。  \n\n现在，你想知道自己走过的路径的期望长度，为了避免精度误差，只要对 $19260817$ 取模就好了。      \n", "inputFormat": "第一行一个整数 $n$，表示房间以及道路的个数。  \n \n下面 $n$ 行每行三个整数 $u,v,w$，表示从房间 $u$ 到房间 $v$ 有一条长度为 $w$ 的道路。     \n", "outputFormat": "一行一个整数，表示期望路径长度。", "hint": "#### 样例解释:  \n\n迷宫的结构如下:  \n![](https://cdn.luogu.com.cn/upload/pic/42707.png)  \n起始点和结束点都是随机的，用二元组$(x,y)$表示  \n\n以几个有代表性的二元组为例:  \n\n$(1,1)$，只有一条长度为$0$的路径  \n\n$(1,2)$，有两条路径$1-4-2,1-4-3-2$，期望路径长度为 $\\frac{4+6}{2}=5$   \n$(3,3)$，有两条路径$3-2-4,3$，期望路径长度为 $\\frac{6+0}{2}=3$   \n\n不难算出，将所有可能的二元组的期望路径长度加在一起为$57$，所以答案为 $\\frac{57}{16}$ ,在模意义下等于 $8426611$。\n\n#### 数据范围:  \n\n![](https://cdn.luogu.com.cn/upload/pic/42697.png)", "locale": "zh-CN"}}}
{"pid": "P5130", "type": "P", "difficulty": 6, "samples": [["1 1 2 1 1", "3"], ["1 1 2 1 5", "9630476"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "纯粹的弹幕地狱", "background": "除了丰富的迷宫系统之外,TODR的弹幕系统也富有趣味,不仅有多种华丽的特效,还有如咲夜的连发小刀,` The World `等特殊的攻击.  \n\n不仅自机如此,敌人也有自己独特的攻击方式,比如下图就是绵月丰姬的\"净化之风\"攻击模式    \n\n![](https://cdn.luogu.com.cn/upload/pic/42759.png)  \n", "description": "通过了不可思议的迷宫后,你一路顺利地过关斩将来到了最后一层,却遭遇了前所未有的强敌——纯狐  \n\n所幸的是,纯狐的弹幕不像绀珠转的强度一样大,房间的地形也比较特殊,可以为你所用.     \n\n形式化的来说,每一回合你和纯狐的行动模式如下:  \n\n1. 你可以将房间当成一张正方形网格图,左下角坐标为$(0,0)$,右上角的坐标为$(n,n)$,房间的有效位置为这$(n+1)*(n+1)$个格点,在一回合开始的时候,你会被随机传送到房间的任意一个有效位置  \n\n2. 之后,纯狐会随机出现在房间中的某个有效位置,当然,她不会和你出现在同一位置  \n\n3. 纯狐会发射纯粹的自机狙,也就是向你的方向发射一片弹幕,如果这片弹幕在飞行过程中经过了某个不是纯狐和自机所在的格点,则格点上的弹幕结界会被触发,将其传送到亚空间,如果这片弹幕顺利到达你所在的格点,那么你会受到一些伤害  \n\n4. 由于时间狂暴,纯狐在第$t$回合的弹幕伤害可以计算为$at^{2}+bt+c$  \n\n5. 回合结束,开始下一回合   \n\n经过粗略估计,你认为和纯狐的弹幕战会持续$k$回合,那么,为了稳妥起见,你想要算出自机受到的总期望伤害  \n\n答案可能很大也可能丢精度,所以对$19260817$取模就可以了", "inputFormat": "一行五个整数$n,a,b,c,k$,意义与题目描述保持一致", "outputFormat": "一行一个整数,表示期望受到总伤害的值", "hint": "样例$1$解释:  \n\n手画一个网格图,不难发现纯狐能打到你的情况有$12$种(先放自机再放纯狐即可得到)  \n\n所以第一发弹幕的伤害为$1*1*1+2*1+1=4$,期望伤害为$4*\\frac{12}{16}=3$  \n\n只有一回合,所以答案为$3$       \n\n数据范围:  \n\n![](https://cdn.luogu.com.cn/upload/pic/42785.png)  \n\n", "locale": "zh-CN", "translations": {"en": {"title": "Pure Bullet Hell", "background": "Besides the rich maze system, TODR’s bullet system is also very interesting. It not only has many gorgeous special effects, but also special attacks such as Sakuya’s rapid-fire knives and ` The World `.\n\nNot only the player character, but enemies also have their own unique attack patterns. For example, the picture below shows Toyohime Watatsuki’s \"Purifying Wind\" attack pattern.\n\n![](https://cdn.luogu.com.cn/upload/pic/42759.png)", "description": "After clearing the incredible maze, you fight your way smoothly to the final floor, but encounter an unprecedentedly strong enemy—Junko.\n\nFortunately, Junko’s bullet patterns are not as intense as in LoLK, and the room’s terrain is also quite special and can be used to your advantage.\n\nFormally, in each turn, the action process of you and Junko is as follows.\n\n1. You can treat the room as a square grid. The bottom-left corner has coordinates $(0,0)$, and the top-right corner has coordinates $(n,n)$. The valid positions in the room are these $(n+1)*(n+1)$ grid points. At the beginning of a turn, you will be randomly teleported to any valid position in the room.\n\n2. After that, Junko will randomly appear at some valid position in the room. Of course, she will not appear at the same position as you.\n\n3. Junko will fire a pure \"player-targeting shot\", i.e., she fires a wave of bullets toward your direction. If during the flight this wave of bullets passes through any grid point that is neither Junko’s position nor your position, then the bullet barrier on that grid point will be triggered and teleport the bullets into subspace. If this wave of bullets successfully reaches the grid point where you are, then you will take some damage.\n\n4. Due to time rampage, the bullet damage dealt by Junko in turn $t$ can be computed as $at^{2}+bt+c$.\n\n5. The turn ends, and the next turn begins.\n\nAfter a rough estimate, you think this bullet fight with Junko will last for $k$ turns. Then, to be safe, you want to compute the total expected damage taken by the player character.\n\nThe answer may be very large or may lose precision, so you only need to take it modulo $19260817$.", "inputFormat": "A single line contains five integers $n,a,b,c,k$, with meanings consistent with the problem statement.", "outputFormat": "Output one integer in a single line, representing the expected total damage taken.", "hint": "Explanation for Sample $1$:\n\nDraw a grid by hand. It is not hard to find that there are $12$ cases where Junko can hit you (place the player character first, then place Junko).\n\nSo the damage of the first wave of bullets is $1*1*1+2*1+1=4$, and the expected damage is $4*\\frac{12}{16}=3$.\n\nThere is only one turn, so the answer is $3$.\n\nConstraints:\n\n![](https://cdn.luogu.com.cn/upload/pic/42785.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "纯粹的弹幕地狱", "background": "除了丰富的迷宫系统之外,TODR的弹幕系统也富有趣味,不仅有多种华丽的特效,还有如咲夜的连发小刀,` The World `等特殊的攻击.  \n\n不仅自机如此,敌人也有自己独特的攻击方式,比如下图就是绵月丰姬的\"净化之风\"攻击模式    \n\n![](https://cdn.luogu.com.cn/upload/pic/42759.png)  \n", "description": "通过了不可思议的迷宫后,你一路顺利地过关斩将来到了最后一层,却遭遇了前所未有的强敌——纯狐  \n\n所幸的是,纯狐的弹幕不像绀珠转的强度一样大,房间的地形也比较特殊,可以为你所用.     \n\n形式化的来说,每一回合你和纯狐的行动模式如下:  \n\n1. 你可以将房间当成一张正方形网格图,左下角坐标为$(0,0)$,右上角的坐标为$(n,n)$,房间的有效位置为这$(n+1)*(n+1)$个格点,在一回合开始的时候,你会被随机传送到房间的任意一个有效位置  \n\n2. 之后,纯狐会随机出现在房间中的某个有效位置,当然,她不会和你出现在同一位置  \n\n3. 纯狐会发射纯粹的自机狙,也就是向你的方向发射一片弹幕,如果这片弹幕在飞行过程中经过了某个不是纯狐和自机所在的格点,则格点上的弹幕结界会被触发,将其传送到亚空间,如果这片弹幕顺利到达你所在的格点,那么你会受到一些伤害  \n\n4. 由于时间狂暴,纯狐在第$t$回合的弹幕伤害可以计算为$at^{2}+bt+c$  \n\n5. 回合结束,开始下一回合   \n\n经过粗略估计,你认为和纯狐的弹幕战会持续$k$回合,那么,为了稳妥起见,你想要算出自机受到的总期望伤害  \n\n答案可能很大也可能丢精度,所以对$19260817$取模就可以了", "inputFormat": "一行五个整数$n,a,b,c,k$,意义与题目描述保持一致", "outputFormat": "一行一个整数,表示期望受到总伤害的值", "hint": "样例$1$解释:  \n\n手画一个网格图,不难发现纯狐能打到你的情况有$12$种(先放自机再放纯狐即可得到)  \n\n所以第一发弹幕的伤害为$1*1*1+2*1+1=4$,期望伤害为$4*\\frac{12}{16}=3$  \n\n只有一回合,所以答案为$3$       \n\n数据范围:  \n\n![](https://cdn.luogu.com.cn/upload/pic/42785.png)  \n\n", "locale": "zh-CN"}}}
{"pid": "P5131", "type": "P", "difficulty": 4, "samples": [["3 2\n3 1 2", "16050685"], ["6 3\n1 1 4 5 1 4", "16509294"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "期望"], "title": "荷取融合", "background": "作为一款Rougelike类游戏，TODR具有丰富的装备系统。每一款装备独特的外观和华丽的特效，上百种各有效果的印记，复杂的炼成调和分解融合系统都塑造了这款游戏极高的游戏性。    \n\n现在你的装备刷到了满级，需要和其他装备融合来继续成长，当然，你需要让河城荷取将你原装备中的印记抽取出来以便和新装备合成。 ", "description": "已知原装备有 $n$ 个印记槽，每个印记槽中有无限多的一种印记，第 $i$ 个印记槽中的这种印记价值为 $a_{i}$。     \n\n河城荷取会用机械臂抽取印记槽内的印记，每一次抽取时，机械臂会向下抓取，从正下方的印记槽中抽取出一个印记，之后机械臂会向右移动或停留在原地(如果移动，那么可以移动任意格)，开始时机械臂的位置任意，但是任意时刻机械臂都必须在某个印记槽上。  \n\n河城荷取会进行 $k$ 次抓取，抓取结束后，你获得的总收益等于抓上来的 $k$ 个印记价值的乘积。\n\n假设河城荷取进行的一切操作都是随机的，那么你能获得的收益的平均值是多少呢?  \n\n由于答案可能不是整数，你只需输出答案对 $\\text{19260817}$ 取模后的结果。  ", "inputFormat": "第一行两个整数 $n,k$ ，表示印记槽的个数和抓取的次数。 \n  \n第二行 $n$ 个正整数 $a_{i}$ ，表示每个印记槽内印记的价值 。 ", "outputFormat": "一个整数，表示 $k$ 次抓取结束后的收益的平均值。", "hint": "#### 样例 $1$ 解释:  \n\n机械臂开始可以停在三个槽上方。  \n\n先后抓取的印记槽的位置可以是 $(1,1),(1,2),(1,3),(2,2),(2,3),(3,3)$ 六种,每一种抓取方案的收益分别是 $9,3,6,1,2,4$ ，平均值为 $\\frac{25}{6}$，在 $ \\text{mod 19260817}$ 的意义下等于 $16050685$   \n\n\n#### 数据范围:  \n\n$a_{i}<19260817$  \n\n![](https://cdn.luogu.com.cn/upload/pic/42182.png)   ", "locale": "zh-CN", "translations": {"en": {"title": "Nitori Fusion", "background": "As a Roguelike game, TODR has a rich equipment system. Each piece of equipment has a unique appearance and fancy special effects. Hundreds of different “marks” with different effects, plus a complex crafting / mixing / dismantling / fusion system, make this game highly replayable.\n\nNow your equipment has been leveled to the maximum. To keep growing, you need to fuse it with other equipment. Of course, you need Kawashiro Nitori to extract the marks from your original equipment so that they can be combined with the new equipment.", "description": "It is known that the original equipment has $n$ mark slots. In each mark slot, there are infinitely many copies of one kind of mark. The value of the mark in the $i$-th slot is $a_i$.\n\nKawashiro Nitori uses a mechanical arm to extract marks from the slots. Each time it extracts, the arm grabs downward and takes one mark from the slot directly below it. After that, the arm either moves to the right or stays in place (if it moves, it can move any number of slots). At the beginning, the arm can start at any position, but at any moment it must be above some mark slot.\n\nKawashiro Nitori will perform $k$ grabs. After all grabs, your total reward equals the product of the values of the $k$ extracted marks.\n\nAssuming all of Kawashiro Nitori’s operations are random, what is the expected value of the reward you can obtain?\n\nSince the answer may not be an integer, you only need to output the result modulo $\\text{19260817}$.", "inputFormat": "The first line contains two integers $n, k$, representing the number of mark slots and the number of grabs.\n\nThe second line contains $n$ positive integers $a_i$, representing the value of the mark in each slot.", "outputFormat": "Output one integer, representing the expected reward after $k$ grabs.", "hint": "#### Sample $1$ Explanation:\n\nAt the start, the mechanical arm can stay above any of the three slots.\n\nThe sequence of slots from which marks are grabbed can be one of the following six types: $(1,1), (1,2), (1,3), (2,2), (2,3), (3,3)$. The rewards for each plan are $9, 3, 6, 1, 2, 4$, respectively. The average is $\\frac{25}{6}$, which equals $16050685$ under $\\text{mod 19260817}$.\n\n#### Constraints:\n\n$a_i < 19260817$\n\n![](https://cdn.luogu.com.cn/upload/pic/42182.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "荷取融合", "background": "作为一款Rougelike类游戏，TODR具有丰富的装备系统。每一款装备独特的外观和华丽的特效，上百种各有效果的印记，复杂的炼成调和分解融合系统都塑造了这款游戏极高的游戏性。    \n\n现在你的装备刷到了满级，需要和其他装备融合来继续成长，当然，你需要让河城荷取将你原装备中的印记抽取出来以便和新装备合成。 ", "description": "已知原装备有 $n$ 个印记槽，每个印记槽中有无限多的一种印记，第 $i$ 个印记槽中的这种印记价值为 $a_{i}$。     \n\n河城荷取会用机械臂抽取印记槽内的印记，每一次抽取时，机械臂会向下抓取，从正下方的印记槽中抽取出一个印记，之后机械臂会向右移动或停留在原地(如果移动，那么可以移动任意格)，开始时机械臂的位置任意，但是任意时刻机械臂都必须在某个印记槽上。  \n\n河城荷取会进行 $k$ 次抓取，抓取结束后，你获得的总收益等于抓上来的 $k$ 个印记价值的乘积。\n\n假设河城荷取进行的一切操作都是随机的，那么你能获得的收益的平均值是多少呢?  \n\n由于答案可能不是整数，你只需输出答案对 $\\text{19260817}$ 取模后的结果。  ", "inputFormat": "第一行两个整数 $n,k$ ，表示印记槽的个数和抓取的次数。 \n  \n第二行 $n$ 个正整数 $a_{i}$ ，表示每个印记槽内印记的价值 。 ", "outputFormat": "一个整数，表示 $k$ 次抓取结束后的收益的平均值。", "hint": "#### 样例 $1$ 解释:  \n\n机械臂开始可以停在三个槽上方。  \n\n先后抓取的印记槽的位置可以是 $(1,1),(1,2),(1,3),(2,2),(2,3),(3,3)$ 六种,每一种抓取方案的收益分别是 $9,3,6,1,2,4$ ，平均值为 $\\frac{25}{6}$，在 $ \\text{mod 19260817}$ 的意义下等于 $16050685$   \n\n\n#### 数据范围:  \n\n$a_{i}<19260817$  \n\n![](https://cdn.luogu.com.cn/upload/pic/42182.png)   ", "locale": "zh-CN"}}}
{"pid": "P5132", "type": "P", "difficulty": 2, "samples": [["4\n2 5 1 7\n0 343 154 12\n343 0 214 132\n154 214 0 441\n12 132 441 0", "2179"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["洛谷原创"], "title": "Cozy Glow之拯救小马国", "background": "本题难度普及-，请noip两个组别的选手都把它AC（~~不然你noip省三都保不住了~~）\n\nps：三年OI一场空，day1T1见祖宗。。。", "description": "Cozy Glow偷偷摸摸的造了一个魔法阵，这个魔法阵在吸取小马国的魔力，所以你得赶紧把它毁掉。\n\n这个魔法阵由若干个神器组成，每个神器都有一个法力值，每两个神器之间也都有一个关联值。你要依次把这些神器拿走，但是，每拿走一个神器，你就会受到一定量的反噬，反噬的量为这个神器与其他还在神器的关联值乘以这个神器的法力值，为了减少反噬，tb148需要拿走每个神器，但由于他贪生怕死，他想让他受到的反噬值之和最小，现在tb148想知道，怎样拿走神器，才能让反噬值的和最小。", "inputFormat": "第一行，神器的个数\n\n第二行，每一个神器的法力值\n\n接下来，将以邻接矩阵的形式输入神器之间的关联值", "outputFormat": "最好的拿取方式所产生反噬值的和", "hint": "神器个数<=1000\n\n所有其他的值<=2000000\n\n正对角线上的数保证都是零。。。", "locale": "zh-CN", "translations": {"en": {"title": "Cozy Glow Saves Equestria.", "background": "This problem is at Junior- difficulty. Players from both NOIP groups, please all get it accepted (~~otherwise you might not even keep your NOIP provincial third prize~~).\n\nPS: Three years of OI end up as nothing, and on Day 1 T1 you meet your ancestors...", "description": "Cozy Glow secretly built a magic array. This magic array is absorbing the magic of Equestria, so you must destroy it as soon as possible.\n\nThis magic array consists of several artifacts. Each artifact has a magic power value, and every pair of artifacts also has an association value. You need to remove these artifacts one by one. However, every time you remove an artifact, you will suffer a certain amount of backlash. The amount of backlash equals the sum of the association values between this artifact and all other artifacts that are still present, multiplied by this artifact’s magic power value. In order to reduce the backlash, tb148 needs to take away every artifact. But because he is afraid of dying, he wants the total sum of backlash values to be as small as possible. Now tb148 wants to know: in what order should the artifacts be removed to make the total backlash minimum?", "inputFormat": "The first line contains the number of artifacts.\n\nThe second line contains the magic power value of each artifact.\n\nNext, the association values between artifacts are given in the form of an adjacency matrix.", "outputFormat": "Output the total backlash value produced by the best removal order.", "hint": "Constraints:\n\nNumber of artifacts $\\le 1000$.\n\nAll other values $\\le 2000000$.\n\nThe numbers on the main diagonal are guaranteed to be $0$...\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Cozy Glow之拯救小马国", "background": "本题难度普及-，请noip两个组别的选手都把它AC（~~不然你noip省三都保不住了~~）\n\nps：三年OI一场空，day1T1见祖宗。。。", "description": "Cozy Glow偷偷摸摸的造了一个魔法阵，这个魔法阵在吸取小马国的魔力，所以你得赶紧把它毁掉。\n\n这个魔法阵由若干个神器组成，每个神器都有一个法力值，每两个神器之间也都有一个关联值。你要依次把这些神器拿走，但是，每拿走一个神器，你就会受到一定量的反噬，反噬的量为这个神器与其他还在神器的关联值乘以这个神器的法力值，为了减少反噬，tb148需要拿走每个神器，但由于他贪生怕死，他想让他受到的反噬值之和最小，现在tb148想知道，怎样拿走神器，才能让反噬值的和最小。", "inputFormat": "第一行，神器的个数\n\n第二行，每一个神器的法力值\n\n接下来，将以邻接矩阵的形式输入神器之间的关联值", "outputFormat": "最好的拿取方式所产生反噬值的和", "hint": "神器个数<=1000\n\n所有其他的值<=2000000\n\n正对角线上的数保证都是零。。。", "locale": "zh-CN"}}}
{"pid": "P5133", "type": "P", "difficulty": 4, "samples": [["4\n1 4 2 3", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 512000]}, "tags": [], "title": "tb148 的客人", "background": "tb148 使用优惠券买来了许多食材后，请来了很多客人来吃饭。", "description": "tb148 和他的 $n$ 个客人，他们每人有一个编号（从 $1$ 开始的连续正整数）。目前，大家不按编号，乱序围坐在一张圆桌上。每次操作我们可以同时让任意多的客人沿顺时针或逆时针移动一个位置，我们称作一次操作。这个过程中一个位置可以没有客人或有多个客人。请问最少需要多少秒，使得每个位置仍恰好只有一个数，且客人的编号沿顺时针或逆时针依次为 $1 \\sim n$？", "inputFormat": "输入包含两行。\n\n第一行为一个正整数 $n$。\n\n第二行为 $n$ 个由空格隔开的正整数，为一个 $1 \\sim n$ 的排列，表示最开始时按顺时针顺序的客人编号。", "outputFormat": "输出一个整数表示答案。", "hint": "对于 $40 \\%$ 的数据，$1 \\le n \\le 3 \\times 10^3$。\n\n对于 $80 \\%$ 的数据，$1 \\le n \\le 3 \\times 10^5$。\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "Guests of tb148", "background": "After tb148 bought a lot of ingredients using coupons, he invited many guests to have a meal.", "description": "tb148 and his $n$ guests each have an ID number (consecutive positive integers starting from $1$). Currently, they are sitting around a round table in a random order, not by their IDs. In one operation, we may simultaneously let any number of guests move one position clockwise or counterclockwise; we call this one operation. During this process, a position may have no guest or multiple guests. Find the minimum number of seconds needed so that each position still has exactly one person, and the guests' IDs in clockwise order (or in counterclockwise order) are exactly $1 \\sim n$.", "inputFormat": "The input contains two lines.\n\nThe first line is a positive integer $n$.\n\nThe second line contains $n$ space-separated positive integers, a permutation of $1 \\sim n$, representing the guests' IDs in clockwise order at the beginning.", "outputFormat": "Output one integer, the answer.", "hint": "For $40\\%$ of the testdata, $1 \\le n \\le 3 \\times 10^3$.\n\nFor $80\\%$ of the testdata, $1 \\le n \\le 3 \\times 10^5$.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "tb148 的客人", "background": "tb148 使用优惠券买来了许多食材后，请来了很多客人来吃饭。", "description": "tb148 和他的 $n$ 个客人，他们每人有一个编号（从 $1$ 开始的连续正整数）。目前，大家不按编号，乱序围坐在一张圆桌上。每次操作我们可以同时让任意多的客人沿顺时针或逆时针移动一个位置，我们称作一次操作。这个过程中一个位置可以没有客人或有多个客人。请问最少需要多少秒，使得每个位置仍恰好只有一个数，且客人的编号沿顺时针或逆时针依次为 $1 \\sim n$？", "inputFormat": "输入包含两行。\n\n第一行为一个正整数 $n$。\n\n第二行为 $n$ 个由空格隔开的正整数，为一个 $1 \\sim n$ 的排列，表示最开始时按顺时针顺序的客人编号。", "outputFormat": "输出一个整数表示答案。", "hint": "对于 $40 \\%$ 的数据，$1 \\le n \\le 3 \\times 10^3$。\n\n对于 $80 \\%$ 的数据，$1 \\le n \\le 3 \\times 10^5$。\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le 10^6$。", "locale": "zh-CN"}}}
{"pid": "P5134", "type": "P", "difficulty": 6, "samples": [["10 10", "999989991"], ["6 2", "9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "好编号", "background": "", "description": "给定参数 $ N $、$ K $。一个编号 $ A $ 被称为好编号，当且仅当对于任意的 $ i \\in \\{ 1, 2, \\cdots, N-1 \\} $，均满足：$ \\dfrac{A}{K^i} - \\left\\lfloor \\dfrac{A}{K^i} \\right\\rfloor > \\dfrac{A}{K^N} $。\n\n求好编号的个数模 $ 10^9+7 $ 的值。", "inputFormat": "一行两个正整数 $N,K$。", "outputFormat": "一行，好编号个数模 $10 ^ 9 + 7$ 的值。", "hint": "- 对于 $20\\%$ 的数据，$K^N\\leq 5\\times 10 ^ 4$。\n- 对于 $60\\%$ 的数据， $N, K\\leq 10 ^ 6$。\n- 对于 $100\\%$ 的数据，$1\\leq N, K\\leq 10 ^ 9$。", "locale": "zh-CN", "translations": {"en": {"title": "Good Numbers", "background": "", "description": "Given parameters $N$ and $K$. A number $A$ is called a good number if and only if for every $i \\in \\{1, 2, \\cdots, N-1\\}$, the following holds: $\\dfrac{A}{K^i} - \\left\\lfloor \\dfrac{A}{K^i} \\right\\rfloor > \\dfrac{A}{K^N}$.\n\nFind the number of good numbers modulo $10^9+7$.", "inputFormat": "One line with two positive integers $N, K$.", "outputFormat": "One line, the number of good numbers modulo $10 ^ 9 + 7$.", "hint": "- For $20\\%$ of the testdata, $K^N \\leq 5\\times 10 ^ 4$.\n- For $60\\%$ of the testdata, $N, K \\leq 10 ^ 6$.\n- For $100\\%$ of the testdata, $1 \\leq N, K \\leq 10 ^ 9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "好编号", "background": "", "description": "给定参数 $ N $、$ K $。一个编号 $ A $ 被称为好编号，当且仅当对于任意的 $ i \\in \\{ 1, 2, \\cdots, N-1 \\} $，均满足：$ \\dfrac{A}{K^i} - \\left\\lfloor \\dfrac{A}{K^i} \\right\\rfloor > \\dfrac{A}{K^N} $。\n\n求好编号的个数模 $ 10^9+7 $ 的值。", "inputFormat": "一行两个正整数 $N,K$。", "outputFormat": "一行，好编号个数模 $10 ^ 9 + 7$ 的值。", "hint": "- 对于 $20\\%$ 的数据，$K^N\\leq 5\\times 10 ^ 4$。\n- 对于 $60\\%$ 的数据， $N, K\\leq 10 ^ 6$。\n- 对于 $100\\%$ 的数据，$1\\leq N, K\\leq 10 ^ 9$。", "locale": "zh-CN"}}}
{"pid": "P5135", "type": "P", "difficulty": 5, "samples": [["5\n5 2 1\n5 3 0\n3 4 0\n8 4 1\n6 2 1", "10\n35\n15\n70\n15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["组合数学", "逆元"], "title": "painting", "background": "Wolfycz很喜欢画画（雾", "description": "Wolfycz喜欢网格图，他希望在网格图上画上一些黑格子，使得每一列都恰好有一个黑格子。但是黑格子太乱了不好看，所以Wolfycz希望黑格子按列号依次连线是下降的，具体来讲，每列黑格子所在行号不得小于前一列黑格子所在行号（我们令左上角为第一行第一列）\n\nWolfycz觉得这样画出来的图非常漂亮，但是Wolfycz有时候觉得连线要严格下降才好看（即每列黑格子所在行号必须大于前一列黑格子所在行号），有时候觉得连线只要不上升就好看（即每列黑格子所在行号不得小于前一列黑格子所在行号）。现在Wolfycz想知道，对于一个$N×M$的网格图，他能画出多少个好看的图？两个图不相同，当且仅当存在某一列的黑格子，它在两个图中对应的行号不同\n\nUPD：$N$行$M$列", "inputFormat": "第一行读入$T$，表示有$T$组数据\n\n接下来每一行读入三个整数$N,M,opt$，表示$N×M$的矩阵，如果$opt$为1，则Wolfycz认为连线要严格下降才好看；如果$opt$为0，则Wolfycz认为连线只要不上升就好看", "outputFormat": "输出共$T$行，每行一个整数，表示Wolfycz能画出不同的图的个数，答案对$10^9+7$取模", "hint": "对于$20\\%$的数据，$T\\leqslant 5,N\\leqslant 8,M\\leqslant 8$\n\n对于另外$20\\%$的数据，$N=1$或$M=1$\n\n对于另外$20\\%$的数据，$N\\leqslant 10^6,M\\leqslant 10^6$\n\n对于$100\\%$的数据，$T\\leqslant 50,N\\leqslant 10^{18},M\\leqslant 10^6$", "locale": "zh-CN", "translations": {"en": {"title": "painting", "background": "Wolfycz really likes painting (sort of).", "description": "Wolfycz likes grid diagrams. He wants to paint some black cells on a grid so that each column has exactly one black cell. However, black cells look messy, so Wolfycz wants the polyline formed by connecting the black cells from left to right (in increasing column order) to be descending. More specifically, the row index of the black cell in each column must be no smaller than the row index of the black cell in the previous column (we define the top-left corner as row $1$, column $1$).\n\nWolfycz thinks such diagrams look very nice, but sometimes he feels that the polyline must be strictly descending to look good (i.e., the row index of the black cell in each column must be greater than that in the previous column). Sometimes he feels it is enough that the polyline does not go up (i.e., the row index of the black cell in each column must be no smaller than that in the previous column). Now Wolfycz wants to know: for an $N \\times M$ grid, how many nice diagrams can he draw? Two diagrams are different if and only if there exists a column whose black cell is in different rows in the two diagrams.\n\nUPD: $N$ rows and $M$ columns.", "inputFormat": "The first line contains $T$, meaning there are $T$ test cases.\n\nEach of the next $T$ lines contains three integers $N, M, opt$, describing an $N \\times M$ matrix. If $opt$ is $1$, then Wolfycz thinks the polyline must be strictly descending to look good. If $opt$ is $0$, then Wolfycz thinks it is enough that the polyline does not go up.", "outputFormat": "Output $T$ lines in total. Each line contains one integer, the number of different diagrams Wolfycz can draw, modulo $10^9 + 7$.", "hint": "For $20\\%$ of the testdata, $T \\leqslant 5, N \\leqslant 8, M \\leqslant 8$.\n\nFor another $20\\%$ of the testdata, $N = 1$ or $M = 1$.\n\nFor another $20\\%$ of the testdata, $N \\leqslant 10^6, M \\leqslant 10^6$.\n\nFor $100\\%$ of the testdata, $T \\leqslant 50, N \\leqslant 10^{18}, M \\leqslant 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "painting", "background": "Wolfycz很喜欢画画（雾", "description": "Wolfycz喜欢网格图，他希望在网格图上画上一些黑格子，使得每一列都恰好有一个黑格子。但是黑格子太乱了不好看，所以Wolfycz希望黑格子按列号依次连线是下降的，具体来讲，每列黑格子所在行号不得小于前一列黑格子所在行号（我们令左上角为第一行第一列）\n\nWolfycz觉得这样画出来的图非常漂亮，但是Wolfycz有时候觉得连线要严格下降才好看（即每列黑格子所在行号必须大于前一列黑格子所在行号），有时候觉得连线只要不上升就好看（即每列黑格子所在行号不得小于前一列黑格子所在行号）。现在Wolfycz想知道，对于一个$N×M$的网格图，他能画出多少个好看的图？两个图不相同，当且仅当存在某一列的黑格子，它在两个图中对应的行号不同\n\nUPD：$N$行$M$列", "inputFormat": "第一行读入$T$，表示有$T$组数据\n\n接下来每一行读入三个整数$N,M,opt$，表示$N×M$的矩阵，如果$opt$为1，则Wolfycz认为连线要严格下降才好看；如果$opt$为0，则Wolfycz认为连线只要不上升就好看", "outputFormat": "输出共$T$行，每行一个整数，表示Wolfycz能画出不同的图的个数，答案对$10^9+7$取模", "hint": "对于$20\\%$的数据，$T\\leqslant 5,N\\leqslant 8,M\\leqslant 8$\n\n对于另外$20\\%$的数据，$N=1$或$M=1$\n\n对于另外$20\\%$的数据，$N\\leqslant 10^6,M\\leqslant 10^6$\n\n对于$100\\%$的数据，$T\\leqslant 50,N\\leqslant 10^{18},M\\leqslant 10^6$", "locale": "zh-CN"}}}
{"pid": "P5136", "type": "P", "difficulty": 6, "samples": [["5\n1\n9\n20\n50\n100", "2\n77\n15127\n192911239\n996781931"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": [], "title": "sequence", "background": "Wolfycz很喜欢数列（雾", "description": "Wolfycz非常喜欢研究数列，同时他也喜欢研究黄金分割率，有一天Wolfycz写下了一个数列，他令$A_i=\\lceil(\\dfrac{\\sqrt{5}+1}{2})^i\\rceil$，但是Wolfycz并不知道$A_n$的值，所以希望你来帮帮他\n\n注：请注意常数因子对程序运行效率的影响", "inputFormat": "第一行读入$T$，表示有$T$组数据\n\n之后每一行一个整数$n$", "outputFormat": "输出共$T$行，每行一个整数，表示$\\lceil(\\dfrac{\\sqrt{5}+1}{2})^n\\rceil$的值，答案对998244353取模", "hint": "对于$5\\%$的数据，$n\\leqslant 20$\n\n对于$40\\%$的数据，$T\\leqslant 5×10^4$\n\n对于$100\\%$的数据，$T\\leqslant 10^5,n\\leqslant 10^{18}$", "locale": "zh-CN", "translations": {"en": {"title": "sequence", "background": "Wolfycz really likes sequences (just kidding).", "description": "Wolfycz really enjoys studying sequences, and he also likes the golden ratio. One day, Wolfycz wrote down a sequence and defined $A_i=\\lceil(\\dfrac{\\sqrt{5}+1}{2})^i\\rceil$. However, Wolfycz does not know the value of $A_n$, so he hopes you can help him.\n\nNote: Please pay attention to the impact of constant factors on the running time of your program.", "inputFormat": "The first line contains $T$, meaning there are $T$ test cases.\n\nThen each following line contains one integer $n$.", "outputFormat": "Output $T$ lines in total. Each line contains one integer, representing the value of $\\lceil(\\dfrac{\\sqrt{5}+1}{2})^n\\rceil$. Output the answer modulo 998244353.", "hint": "For $5\\%$ of the testdata, $n\\leqslant 20$.\n\nFor $40\\%$ of the testdata, $T\\leqslant 5×10^4$.\n\nFor $100\\%$ of the testdata, $T\\leqslant 10^5,n\\leqslant 10^{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "sequence", "background": "Wolfycz很喜欢数列（雾", "description": "Wolfycz非常喜欢研究数列，同时他也喜欢研究黄金分割率，有一天Wolfycz写下了一个数列，他令$A_i=\\lceil(\\dfrac{\\sqrt{5}+1}{2})^i\\rceil$，但是Wolfycz并不知道$A_n$的值，所以希望你来帮帮他\n\n注：请注意常数因子对程序运行效率的影响", "inputFormat": "第一行读入$T$，表示有$T$组数据\n\n之后每一行一个整数$n$", "outputFormat": "输出共$T$行，每行一个整数，表示$\\lceil(\\dfrac{\\sqrt{5}+1}{2})^n\\rceil$的值，答案对998244353取模", "hint": "对于$5\\%$的数据，$n\\leqslant 20$\n\n对于$40\\%$的数据，$T\\leqslant 5×10^4$\n\n对于$100\\%$的数据，$T\\leqslant 10^5,n\\leqslant 10^{18}$", "locale": "zh-CN"}}}
{"pid": "P5137", "type": "P", "difficulty": 6, "samples": [["5\n12 78 35 317\n35 57 19 193\n94 31 75 571\n64 80 14 857\n74 16 42 751\n", "254\n24\n283\n796\n407"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "polynomial", "background": "Wolfycz 很喜欢多项式（雾", "description": "Wolfycz 喜欢研究多项式，尤其喜欢研究 $(a+b)^n$ 这样简单的问题，我们知道 $(a+b)^n=\\sum\\limits_{i=0}^n\\binom{n}{i}a^ib^{n-i}$，但是 Wolfycz 对这样的式子并不满足，于是他把所有的系数全部改成了 $1$，即 $\\sum\\limits_{i=0}^na^ib^{n-i}$，但是 Wolfycz 发现自己太菜了，不会求答案，于是希望你来帮帮他。\n\nUPD：请注意常数因子对程序运行效率的影响。", "inputFormat": "第一行读入 $T$，表示有 $T$ 组数据。\n\n接下来每一行读入四个整数 $n,a,b,p$。", "outputFormat": "共 $T$ 行，每行一个整数，表示 $(\\sum\\limits_{i=0}^na^ib^{n-i})\\bmod p$ 后的值。", "hint": "对于$30\\%$的数据，$T\\leqslant 100,n,a,b,p\\leqslant 10^5$\n\n对于$100\\%$的数据，$T\\leqslant 10^5,n,a,b,p\\leqslant 10^{18}$\n\nUPD：不保证$p$为质数！！！", "locale": "zh-CN", "translations": {"en": {"title": "polynomial", "background": "Wolfycz really likes polynomials (just kidding).", "description": "Wolfycz likes studying polynomials, and especially likes simple problems like $(a+b)^n$. We know that $(a+b)^n=\\sum\\limits_{i=0}^n\\binom{n}{i}a^ib^{n-i}$, but Wolfycz is not satisfied with such an expression, so he changes all coefficients to $1$, i.e. $\\sum\\limits_{i=0}^na^ib^{n-i}$. However, Wolfycz finds that he is not skilled enough and cannot compute the answer, so he hopes you can help him.\n\nUPD: Please pay attention to the impact of constant factors on runtime efficiency.", "inputFormat": "The first line contains $T$, meaning there are $T$ test cases.\n\nEach of the next lines contains four integers $n,a,b,p$.", "outputFormat": "Output $T$ lines. Each line contains one integer, representing the value of $(\\sum\\limits_{i=0}^na^ib^{n-i})\\bmod p$.", "hint": "For $30\\%$ of the testdata, $T\\leqslant 100,n,a,b,p\\leqslant 10^5$.\n\nFor $100\\%$ of the testdata, $T\\leqslant 10^5,n,a,b,p\\leqslant 10^{18}$.\n\nUPD: $p$ is not guaranteed to be prime.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "polynomial", "background": "Wolfycz 很喜欢多项式（雾", "description": "Wolfycz 喜欢研究多项式，尤其喜欢研究 $(a+b)^n$ 这样简单的问题，我们知道 $(a+b)^n=\\sum\\limits_{i=0}^n\\binom{n}{i}a^ib^{n-i}$，但是 Wolfycz 对这样的式子并不满足，于是他把所有的系数全部改成了 $1$，即 $\\sum\\limits_{i=0}^na^ib^{n-i}$，但是 Wolfycz 发现自己太菜了，不会求答案，于是希望你来帮帮他。\n\nUPD：请注意常数因子对程序运行效率的影响。", "inputFormat": "第一行读入 $T$，表示有 $T$ 组数据。\n\n接下来每一行读入四个整数 $n,a,b,p$。", "outputFormat": "共 $T$ 行，每行一个整数，表示 $(\\sum\\limits_{i=0}^na^ib^{n-i})\\bmod p$ 后的值。", "hint": "对于$30\\%$的数据，$T\\leqslant 100,n,a,b,p\\leqslant 10^5$\n\n对于$100\\%$的数据，$T\\leqslant 10^5,n,a,b,p\\leqslant 10^{18}$\n\nUPD：不保证$p$为质数！！！", "locale": "zh-CN"}}}
{"pid": "P5138", "type": "P", "difficulty": 7, "samples": [["5 10\n2 1\n1 3\n2 4\n5 2\nQ 1 5\nU 1 1\nQ 1 1\nQ 1 2\nQ 1 3\nQ 1 4\nQ 1 5\nU 2 2\nQ 2 3\nQ 4 5", "0\n1\n2\n2\n4\n4\n4\n10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "fibonacci", "background": "Wolfycz 很喜欢 Fibonacci 数列（雾", "description": "Wolfycz 热衷于研究 Fibonacci 数列，他定义 $Fib_i$ 为Fibonacci 数列的第 $i$ 项，同时定义 $Fib_0=0,Fib_1=1$，并且对于任意的$i$，满足 $Fib_i=Fib_{i-1}+Fib_{i-2}$。\n\nWolfycz 也喜欢植树，有一天他植了一颗滑稽树（就是 OI 中所说的树，$n$ 个点，$n-1$ 条边，以 $1$ 为根），初始时树上的节点都没有滑稽果，于是 Wolfycz 不惜花重金购入了金坷垃，每次他给滑稽树上的节点 $x$ 施肥 $k$ 克，会使 $x$ 以及它的子树都长出一堆滑稽果，具体来讲，如果 $x$ 子树中的某个节点距离 $x$ 的距离为 $D$，那么这个节点就会长出 $Fib_{D+k}$ 个滑稽果\n\nWolfycz 觉得滑稽树上滑稽果已经够多了，因此他想 Van 游戏，所以他会时不时询问你两个节点路径上有多少个滑稽果。", "inputFormat": "第一行给出两个整数 $N,M$，表示树的节点个数和操作个数\n\n第 $2\\sim N$ 行，第 $i$ 行两个数 $x,y$，表示节点 $x,y$ 之间有一条边\n\n接下来 $M$ 行，每行一个形如 `U x k` 或 `Q x y` 的形式\n\n- `U x k`：$x$ 的子树内的节点，若其到 $x$ 的距离为 $D$，则该点长出 $Fib_{D+k}$ 个滑稽果，$x$ 也要长滑稽果\n- `Q x y`：询问路径 $x,y$ 上所有节点的滑稽果个数和（包括 $x,y$），答案对 $10^9+7$ 取模", "outputFormat": "对于每个 `Q x y` 询问，输出其答案。", "hint": "对于$30\\%$的数据，$N,M,k\\leqslant 10^3$\n\n对于$100\\%$的数据，$N,M\\leqslant 10^5$，$1\\leqslant x,y\\leqslant N$，$1\\leqslant k\\leqslant 10^{18}$。", "locale": "zh-CN", "translations": {"en": {"title": "fibonacci", "background": "Wolfycz really likes the Fibonacci sequence (just kidding).", "description": "Wolfycz is keen on studying the Fibonacci sequence. He defines $Fib_i$ as the $i$-th term of the Fibonacci sequence, and defines $Fib_0=0,Fib_1=1$. For any $i$, it satisfies $Fib_i=Fib_{i-1}+Fib_{i-2}$.\n\nWolfycz also likes planting trees. One day he planted a “funny tree” (that is, the tree in OI: $n$ nodes, $n-1$ edges, rooted at $1$). Initially, none of the nodes on the tree had any funny fruits. Then Wolfycz spent a lot of money to buy fertilizer. Each time he fertilizes a node $x$ on the tree with $k$ grams, node $x$ and its entire subtree will grow a bunch of funny fruits. Specifically, if a node in the subtree of $x$ has distance $D$ to $x$, then this node will grow $Fib_{D+k}$ funny fruits.\n\nWolfycz thinks there are already enough funny fruits on the tree, so he wants to play a game, and he will occasionally ask you how many funny fruits there are on the path between two nodes.", "inputFormat": "The first line contains two integers $N,M$, representing the number of nodes in the tree and the number of operations.\n\nLines $2$ to $N$ each contain two integers $x,y$, indicating that there is an edge between nodes $x$ and $y$.\n\nNext come $M$ lines, each in the form `U x k` or `Q x y`.\n\n- `U x k`: For each node in the subtree of $x$, if its distance to $x$ is $D$, then it grows $Fib_{D+k}$ funny fruits. Node $x$ also grows fruits.\n- `Q x y`: Query the sum of funny fruits on all nodes along the path from $x$ to $y$ (including $x$ and $y$). Output the answer modulo $10^9+7$.", "outputFormat": "For each `Q x y` query, output the answer.", "hint": "For $30\\%$ of the testdata, $N,M,k\\leqslant 10^3$.\n\nFor $100\\%$ of the testdata, $N,M\\leqslant 10^5$, $1\\leqslant x,y\\leqslant N$, $1\\leqslant k\\leqslant 10^{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "fibonacci", "background": "Wolfycz 很喜欢 Fibonacci 数列（雾", "description": "Wolfycz 热衷于研究 Fibonacci 数列，他定义 $Fib_i$ 为Fibonacci 数列的第 $i$ 项，同时定义 $Fib_0=0,Fib_1=1$，并且对于任意的$i$，满足 $Fib_i=Fib_{i-1}+Fib_{i-2}$。\n\nWolfycz 也喜欢植树，有一天他植了一颗滑稽树（就是 OI 中所说的树，$n$ 个点，$n-1$ 条边，以 $1$ 为根），初始时树上的节点都没有滑稽果，于是 Wolfycz 不惜花重金购入了金坷垃，每次他给滑稽树上的节点 $x$ 施肥 $k$ 克，会使 $x$ 以及它的子树都长出一堆滑稽果，具体来讲，如果 $x$ 子树中的某个节点距离 $x$ 的距离为 $D$，那么这个节点就会长出 $Fib_{D+k}$ 个滑稽果\n\nWolfycz 觉得滑稽树上滑稽果已经够多了，因此他想 Van 游戏，所以他会时不时询问你两个节点路径上有多少个滑稽果。", "inputFormat": "第一行给出两个整数 $N,M$，表示树的节点个数和操作个数\n\n第 $2\\sim N$ 行，第 $i$ 行两个数 $x,y$，表示节点 $x,y$ 之间有一条边\n\n接下来 $M$ 行，每行一个形如 `U x k` 或 `Q x y` 的形式\n\n- `U x k`：$x$ 的子树内的节点，若其到 $x$ 的距离为 $D$，则该点长出 $Fib_{D+k}$ 个滑稽果，$x$ 也要长滑稽果\n- `Q x y`：询问路径 $x,y$ 上所有节点的滑稽果个数和（包括 $x,y$），答案对 $10^9+7$ 取模", "outputFormat": "对于每个 `Q x y` 询问，输出其答案。", "hint": "对于$30\\%$的数据，$N,M,k\\leqslant 10^3$\n\n对于$100\\%$的数据，$N,M\\leqslant 10^5$，$1\\leqslant x,y\\leqslant N$，$1\\leqslant k\\leqslant 10^{18}$。", "locale": "zh-CN"}}}
{"pid": "P5139", "type": "P", "difficulty": 3, "samples": [["1\n1 0 0\n4\n1 3\n1 -4\n4 1 2\n5 -1 0 -3\n", "0.00 3.00\n0\n-1.00\n"], ["1\n-4 10 100\n15\n4 0 78\n5 -4 -95 -97\n1 -79\n4 12 54\n4 -60 11\n1 83\n4 68 80\n2 -63\n1 71\n1 80\n3 12 67\n1 60\n1 41\n3 35 -13\n4 6 26\n", "-23456.00 106.25\n2\n-11103.00 -435.00\n-14979.00 27.25\n-24696.00 -17712.00\n-6972.00 -1892.00\n0.25\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["模拟", "数学"], "title": "z小f的函数", "background": "z 小 f 热爱数学。\n\n由于 z 小 f 要复习 NOIp，而且他认为觉得数学作业太简单了，于是把数学作业交给了你。", "description": "给定二次函数 $y=ax^{2}+bx+c(a\\ne0)$，并给函数进行如下操作：\n\n- 操作 1：给定系数 $k$，将函数向上平移 $k$ 位（$k<0$ 则向下平移 $-k$ 位）；\n- 操作 2：给定系数 $k$，将函数向右平移 $k$ 位（$k<0$ 则向左平移 $-k$ 位）；\n- 操作 3：给定系数 $k_1,k_2$，将函数关于点 $(k_1,k_2)$ 进行对称变换；\n- 操作 4：给定系数 $k_1,k_2$，求函数在闭区间 $[k_1,k_2]$ 上的最小值和最大值；\n- 操作 5：给定系数 $u,v,w$，求出二次函数 $y$ 与二次函数 $y_2=ux^{2}+vx+w$ 是否有交点。\n\n此外，你还要输出最终的二次函数 $y$ 此时的最大（小）值。", "inputFormat": "第一行一个正整数 $T$，表示数学作业的题目数（即数据组数）。\n\n接下来 $T$ 组数据，对于每一组数据：\n\n> 第一行三个数 $a,b,c$，表示二次函数的系数 $a,b,c$；\n> \n> 第二行一个正整数 $n$，表示操作的数量。\n> \n> 接下来 $n$ 行，每一行都有一个整数 $p$，表示操作的编号，接下来的数即操作的内容（见题目描述）。\n\n数据保证合法。", "outputFormat": "对于每一个操作 4，输出两个小数，分别表示区间的最小值与最大值（保留两位小数）；\n\n对于每一个操作 5，输出一个整数，其中 $0$ 表示没有交点，$2$ 表示有交点；\n\n每组数据操作完成后，输出最终的二次函数 $y$ 此时的最大（小）值（保留两位小数）。", "hint": "对于 $30\\%$ 的数据，$n\\le100$，且没有操作 3。\n\n对于 $60\\%$ 的数据，$n\\le1000$。\n\n对于 $100\\%$ 的数据，$T\\le10$，$n\\le10000$。\n\n数据保证 $a\\ne0,u\\ne0,a\\ne u,1\\le p\\le5,-100\\le a,b,c,k1,k2,k,u,v,w\\le100$。", "locale": "zh-CN", "translations": {"en": {"title": "z Xiao f's Function", "background": "z Xiao f loves mathematics.\n\nBecause z Xiao f needs to review for NOIp, and he thinks the math homework is too easy, he handed the math homework to you.", "description": "Given a quadratic function $y=ax^{2}+bx+c(a\\ne0)$, perform the following operations on the function:\n\n- Operation 1: Given a coefficient $k$, shift the function upward by $k$ units (if $k<0$, shift downward by $-k$ units).\n- Operation 2: Given a coefficient $k$, shift the function rightward by $k$ units (if $k<0$, shift leftward by $-k$ units).\n- Operation 3: Given coefficients $k_1,k_2$, perform a symmetry transformation of the function with respect to the point $(k_1,k_2)$.\n- Operation 4: Given coefficients $k_1,k_2$, find the minimum and maximum values of the function on the closed interval $[k_1,k_2]$.\n- Operation 5: Given coefficients $u,v,w$, determine whether the quadratic function $y$ intersects with the quadratic function $y_2=ux^{2}+vx+w$.\n\nIn addition, you must output the maximum (or minimum) value of the final quadratic function $y$ at that time.", "inputFormat": "The first line contains a positive integer $T$, indicating the number of math homework problems (i.e., the number of test cases).\n\nThen follow $T$ test cases. For each test case:\n\n> The first line contains three numbers $a,b,c$, representing the coefficients $a,b,c$ of the quadratic function.\n>\n> The second line contains a positive integer $n$, representing the number of operations.\n>\n> The next $n$ lines: each line starts with an integer $p$, indicating the operation number, and the following numbers are the parameters of the operation (see the Description).\n\nThe testdata is guaranteed to be valid.", "outputFormat": "For each Operation 4, output two decimal numbers, representing the minimum and maximum values on the interval (keep two decimal places).\n\nFor each Operation 5, output one integer, where $0$ means there is no intersection point, and $2$ means there is an intersection point.\n\nAfter completing all operations of each test case, output the maximum (or minimum) value of the final quadratic function $y$ at that time (keep two decimal places).", "hint": "For $30\\%$ of the testdata, $n\\le100$, and there is no Operation 3.\n\nFor $60\\%$ of the testdata, $n\\le1000$.\n\nFor $100\\%$ of the testdata, $T\\le10$, $n\\le10000$.\n\nThe testdata guarantees $a\\ne0,u\\ne0,a\\ne u,1\\le p\\le5,-100\\le a,b,c,k1,k2,k,u,v,w\\le100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "z小f的函数", "background": "z 小 f 热爱数学。\n\n由于 z 小 f 要复习 NOIp，而且他认为觉得数学作业太简单了，于是把数学作业交给了你。", "description": "给定二次函数 $y=ax^{2}+bx+c(a\\ne0)$，并给函数进行如下操作：\n\n- 操作 1：给定系数 $k$，将函数向上平移 $k$ 位（$k<0$ 则向下平移 $-k$ 位）；\n- 操作 2：给定系数 $k$，将函数向右平移 $k$ 位（$k<0$ 则向左平移 $-k$ 位）；\n- 操作 3：给定系数 $k_1,k_2$，将函数关于点 $(k_1,k_2)$ 进行对称变换；\n- 操作 4：给定系数 $k_1,k_2$，求函数在闭区间 $[k_1,k_2]$ 上的最小值和最大值；\n- 操作 5：给定系数 $u,v,w$，求出二次函数 $y$ 与二次函数 $y_2=ux^{2}+vx+w$ 是否有交点。\n\n此外，你还要输出最终的二次函数 $y$ 此时的最大（小）值。", "inputFormat": "第一行一个正整数 $T$，表示数学作业的题目数（即数据组数）。\n\n接下来 $T$ 组数据，对于每一组数据：\n\n> 第一行三个数 $a,b,c$，表示二次函数的系数 $a,b,c$；\n> \n> 第二行一个正整数 $n$，表示操作的数量。\n> \n> 接下来 $n$ 行，每一行都有一个整数 $p$，表示操作的编号，接下来的数即操作的内容（见题目描述）。\n\n数据保证合法。", "outputFormat": "对于每一个操作 4，输出两个小数，分别表示区间的最小值与最大值（保留两位小数）；\n\n对于每一个操作 5，输出一个整数，其中 $0$ 表示没有交点，$2$ 表示有交点；\n\n每组数据操作完成后，输出最终的二次函数 $y$ 此时的最大（小）值（保留两位小数）。", "hint": "对于 $30\\%$ 的数据，$n\\le100$，且没有操作 3。\n\n对于 $60\\%$ 的数据，$n\\le1000$。\n\n对于 $100\\%$ 的数据，$T\\le10$，$n\\le10000$。\n\n数据保证 $a\\ne0,u\\ne0,a\\ne u,1\\le p\\le5,-100\\le a,b,c,k1,k2,k,u,v,w\\le100$。", "locale": "zh-CN"}}}
{"pid": "P5140", "type": "P", "difficulty": 5, "samples": [["4 2 1\n2 1 4\n4 1 2\n3 1 2\n1 2\n2 6\n3 3\n4 3", "40"], ["5 1 1\n1 2 2\n3 2 2\n4 1 2\n5 4 2\n1 1\n3 1\n5 1\n", "16"], ["20 10 18\n1 17 86406\n17 16 94583\n19 10 28177\n16 18 31981\n10 14 36241\n1 7 28919\n2 1 94673\n5 6 2801\n7 11 81927\n11 13 7779\n17 5 71948\n19 7 20264\n1 8 17736\n13 20 97181\n17 9 16807\n11 15 93705\n17 3 29601\n1 12 43829\n13 4 27537\n1 6\n20 23585\n9 8376\n12 3128\n15 5417\n8 4011\n3 1156\n6 1497\n", "1289613990"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["贪心", "高精度", "树形数据结构"], "title": "树枝修剪", "background": "$Daleva$ $Geoge$是一个热爱生活的园艺工。", "description": "$Daleva$ $Geoge$的花园里有一颗常年没有修剪的树，这一天，$Daleva$ $Geoge$家里来了客人，为了给客人一个好印象，他需要整理这个花园，但是那一颗树显得太碍眼了，他必须要给他好好地修剪一下。\n\n这是一颗以$root$为根的有根树，有$n$个节点。$Daleva$ $Geoge$在根节点，$Daleva$ $Geoge$对某些叶子的形态感到不满，需要剪去多余的枝条。\n\n有$S$个需要修剪的叶子节点,这些叶子节点有一些多余的枝条，这些叶子节点有着自己的权值$a_{i}$,表示这个节点上有多少个$Daleva$ $Geoge$不需要的枝条。同时，因为花园里没法容下这些枝条（否则就变得不和谐了），$Daleva$ $Geoge$需要把这些枝条安装到某些节点上。\n\n$Daleva$ $Geoge$有一个神奇的胶水和一把神奇的剪刀，因此你不需考虑每个树枝的固定形态，根据$Daleva$ $Geoge$的推测，一共有$T$个叶子节点需要安装这些枝条，这些节点有各自的权值$b_{i}$，表示需要$b_{i}$个枝条才能把这棵树变得很好看。\n\n为了修剪好这棵树，$Daleva$ $Geoge$不得不在树上跑边，把每个叶子节点中多余的枝条剪下，并用胶水粘在其他的有需要的叶子节点上。每条边都有不同的长度，现在，由于树太过庞大，$Daleva$ $Geoge$需要知道，他最少需要跑多远的路才能使这棵树被修剪好，$Daleva$ $Geoge$也要回到树根上下来。\n\n虽然$Daleva$ $Geoge$有这些神奇的工具，但他的口袋是有限的，容量为$G$,$Daleva$ $Geoge$不能一次带太多枝条，即不能超过$G$,这更使他懒于考虑这些繁琐的问题。$Daleva$ $Geoge$当然会算啦，他那么巨，但他为了养足精力去剪枝条，这一艰巨的任务就落在你身上了。\n\n$Daleva$ $Geoge$已经把心中树的形状告诉你了，他要躺在椅子上看你怎么算这些问题。", "inputFormat": "输入的第一行$3$个整数：$n,G,root$.\n\n接下来$n-1$行描述每个树边，每行$3$个整数：$u,v,w$表示$u$与$v$有一条长度为$w$的边。\n\n接下来一行$2$个整数：$S,T$;\n\n接下来$S$行，每行两个整数：$x,a_{i}$,表示在第$x$个节点有$a_{i}$个多余枝条，数据保证$x$为叶子节点。\n\n接下来$T$行，每行两个整数：$x,b_{i}$,表示在第$x$个节点需要$b_{i}$个枝条，数据保证$x$为叶子节点。\n\n数据保证$\\sum_{i=1}^{S}a_{i}=\\sum_{i=1}^{T}b_{i}$", "outputFormat": "一行，一个整数，表示$Daleva$ $Geoge$最少需要跑多长的路才能把树修剪好并回到树根爬下树。", "hint": "样例1解释：\n\n![](https://cdn.luogu.com.cn/upload/pic/37354.png)\n\n蓝色数字表示有多少多余枝条，黄色数字表示需要的枝条数。\n\n则最优方案为：$1→2→1→3→1→2→1→3→1→4→1→2→1→4→1$，答案为$40$;\n\n对于$5\\%$的数据，为样例1。\n\n对于$40\\%$的数据，$n\\leq 10,G\\leq 10;w \\leq 1000$\n\n对于$100\\%$的数据，$n\\leq 40,0000,G\\leq 1000;S+T\\leq n;a_{i},b_{i}\\leq 10^{9};w\\leq 10^{9}$\n\n数据保证不会有任意一个叶子节点既需要枝条又有多余枝条。", "locale": "zh-CN", "translations": {"en": {"title": "Branch Pruning.", "background": "$Daleva$ $Geoge$ is a gardener who loves life.", "description": "In $Daleva$ $Geoge$'s garden, there is a tree that has not been pruned for many years. One day, guests come to $Daleva$ $Geoge$'s home. To leave a good impression, he needs to tidy up the garden, but the tree looks too unpleasant, so he must prune it carefully.\n\nThis is a rooted tree with $root$ as the root, and it has $n$ nodes. $Daleva$ $Geoge$ is at the root node. He is not satisfied with the shape of some leaves and needs to cut off the extra branches.\n\nThere are $S$ leaf nodes that need to be pruned. These leaf nodes have some extra branches. Each such leaf node has a weight $a_{i}$, which means how many branches on that node are not needed by $Daleva$ $Geoge$. At the same time, because the garden cannot hold these branches (otherwise it would look disharmonious), $Daleva$ $Geoge$ needs to attach these branches onto some nodes.\n\n$Daleva$ $Geoge$ has magical glue and magical scissors, so you do not need to consider the exact shape of each branch. According to $Daleva$ $Geoge$'s estimate, there are $T$ leaf nodes that need to receive these branches. These nodes have weights $b_{i}$, meaning that $b_{i}$ branches are needed to make the tree look nice.\n\nTo prune the tree well, $Daleva$ $Geoge$ has to move around on the tree, cut the extra branches from those leaf nodes, and use glue to stick them onto other leaf nodes that need them. Each edge has a different length. Now, since the tree is very large, $Daleva$ $Geoge$ wants to know the minimum total distance he needs to travel to finish pruning the tree, and he also has to return to the root to climb down.\n\nAlthough $Daleva$ $Geoge$ has these magical tools, his pocket is limited, with capacity $G$. He cannot carry too many branches at once, i.e., no more than $G$. This makes him even less willing to think about these annoying details. Of course, $Daleva$ $Geoge$ can calculate it, but to save his energy for pruning, this hard task is left to you.\n\n$Daleva$ $Geoge$ has already told you the shape of the tree in his mind, and he will lie on a chair and watch you compute the answer.", "inputFormat": "The first line contains $3$ integers: $n,G,root$.\n\nThe next $n-1$ lines describe the edges of the tree. Each line contains $3$ integers: $u,v,w$, meaning there is an edge of length $w$ between $u$ and $v$.\n\nThe next line contains $2$ integers: $S,T$.\n\nThe next $S$ lines each contain two integers: $x,a_{i}$, meaning node $x$ has $a_{i}$ extra branches. The testdata guarantees that $x$ is a leaf node.\n\nThe next $T$ lines each contain two integers: $x,b_{i}$, meaning node $x$ needs $b_{i}$ branches. The testdata guarantees that $x$ is a leaf node.\n\nThe testdata guarantees that $\\sum_{i=1}^{S}a_{i}=\\sum_{i=1}^{T}b_{i}$.", "outputFormat": "One line with one integer, representing the minimum total distance $Daleva$ $Geoge$ needs to travel to prune the tree and return to the root to climb down.", "hint": "Explanation for Sample 1:\n\n![](https://cdn.luogu.com.cn/upload/pic/37354.png)\n\nThe blue numbers indicate how many extra branches there are, and the yellow numbers indicate how many branches are needed.\n\nThen the best plan is: $1→2→1→3→1→2→1→3→1→4→1→2→1→4→1$, and the answer is $40$.\n\nFor $5\\%$ of the testdata, it is Sample 1.\n\nFor $40\\%$ of the testdata, $n\\leq 10,G\\leq 10;w \\leq 1000$.\n\nFor $100\\%$ of the testdata, $n\\leq 40,0000,G\\leq 1000;S+T\\leq n;a_{i},b_{i}\\leq 10^{9};w\\leq 10^{9}$.\n\nThe testdata guarantees that no leaf node both needs branches and has extra branches.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "树枝修剪", "background": "$Daleva$ $Geoge$是一个热爱生活的园艺工。", "description": "$Daleva$ $Geoge$的花园里有一颗常年没有修剪的树，这一天，$Daleva$ $Geoge$家里来了客人，为了给客人一个好印象，他需要整理这个花园，但是那一颗树显得太碍眼了，他必须要给他好好地修剪一下。\n\n这是一颗以$root$为根的有根树，有$n$个节点。$Daleva$ $Geoge$在根节点，$Daleva$ $Geoge$对某些叶子的形态感到不满，需要剪去多余的枝条。\n\n有$S$个需要修剪的叶子节点,这些叶子节点有一些多余的枝条，这些叶子节点有着自己的权值$a_{i}$,表示这个节点上有多少个$Daleva$ $Geoge$不需要的枝条。同时，因为花园里没法容下这些枝条（否则就变得不和谐了），$Daleva$ $Geoge$需要把这些枝条安装到某些节点上。\n\n$Daleva$ $Geoge$有一个神奇的胶水和一把神奇的剪刀，因此你不需考虑每个树枝的固定形态，根据$Daleva$ $Geoge$的推测，一共有$T$个叶子节点需要安装这些枝条，这些节点有各自的权值$b_{i}$，表示需要$b_{i}$个枝条才能把这棵树变得很好看。\n\n为了修剪好这棵树，$Daleva$ $Geoge$不得不在树上跑边，把每个叶子节点中多余的枝条剪下，并用胶水粘在其他的有需要的叶子节点上。每条边都有不同的长度，现在，由于树太过庞大，$Daleva$ $Geoge$需要知道，他最少需要跑多远的路才能使这棵树被修剪好，$Daleva$ $Geoge$也要回到树根上下来。\n\n虽然$Daleva$ $Geoge$有这些神奇的工具，但他的口袋是有限的，容量为$G$,$Daleva$ $Geoge$不能一次带太多枝条，即不能超过$G$,这更使他懒于考虑这些繁琐的问题。$Daleva$ $Geoge$当然会算啦，他那么巨，但他为了养足精力去剪枝条，这一艰巨的任务就落在你身上了。\n\n$Daleva$ $Geoge$已经把心中树的形状告诉你了，他要躺在椅子上看你怎么算这些问题。", "inputFormat": "输入的第一行$3$个整数：$n,G,root$.\n\n接下来$n-1$行描述每个树边，每行$3$个整数：$u,v,w$表示$u$与$v$有一条长度为$w$的边。\n\n接下来一行$2$个整数：$S,T$;\n\n接下来$S$行，每行两个整数：$x,a_{i}$,表示在第$x$个节点有$a_{i}$个多余枝条，数据保证$x$为叶子节点。\n\n接下来$T$行，每行两个整数：$x,b_{i}$,表示在第$x$个节点需要$b_{i}$个枝条，数据保证$x$为叶子节点。\n\n数据保证$\\sum_{i=1}^{S}a_{i}=\\sum_{i=1}^{T}b_{i}$", "outputFormat": "一行，一个整数，表示$Daleva$ $Geoge$最少需要跑多长的路才能把树修剪好并回到树根爬下树。", "hint": "样例1解释：\n\n![](https://cdn.luogu.com.cn/upload/pic/37354.png)\n\n蓝色数字表示有多少多余枝条，黄色数字表示需要的枝条数。\n\n则最优方案为：$1→2→1→3→1→2→1→3→1→4→1→2→1→4→1$，答案为$40$;\n\n对于$5\\%$的数据，为样例1。\n\n对于$40\\%$的数据，$n\\leq 10,G\\leq 10;w \\leq 1000$\n\n对于$100\\%$的数据，$n\\leq 40,0000,G\\leq 1000;S+T\\leq n;a_{i},b_{i}\\leq 10^{9};w\\leq 10^{9}$\n\n数据保证不会有任意一个叶子节点既需要枝条又有多余枝条。", "locale": "zh-CN"}}}
{"pid": "P5141", "type": "P", "difficulty": 6, "samples": [["5 5\n0 1 0 1 0 \n0 4 5\n0 3 4\n0 0 1\n0 1 2\n4 4 1\n", "POOR AFO!\nPOOR AFO!\n0\n0\n4\n"], ["10 5\n1 1 0 1 1 0 0 1 0 0 \n0 56 7\n30 126 7\n62 116 5\n20 100 1\n8 108 1\n", "POOR AFO!\nPOOR AFO!\nPOOR AFO!\n100\n100\n"], ["5 1\n0 0 0 0 1\n0 999 1", "15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "进制"], "title": "列队", "background": "本题是数据加强版，弱化版请参考$NOIP2017$   $DAY2$   $T3$\n\n~~好了吓吓你们~~", "description": "前段时间，$k$小$l$参加了$CTYZ$高一的的军训。众所周知，军训的时候需要站方阵。\n\n$k$小$l$ 所在的队伍中有原本有蒟蒻（巨佬）$2*N$个，然而现在的只剩$k$小$l$等少数巨佬和一些蒟蒻了。\n\n巨佬 $dwq$ ：教官我还有今年$IOI$的最后一题没调完，我先回去把题切了。\n\n教官：行，准假，过十分钟调完了就先回去休息吧。\n\n蒟蒻 $yz$ ：教官我今天任务计划里的红题还没做完，我要回去做。\n\n教官：你现在回去也调不出来，乖乖站♂好，不要老是想偷懒。\n\n$k$小$l$是一个热爱学习的男♀孩子，现在他发现，操场上只剩两列队了，原本两列的长度都为$N$，并且这两列队还残缺不全，蒟蒻在第一列，巨佬在第二列，并且如果一行中有巨佬，其气场会导致旁边不敢站蒟蒻。\n\n#### 就算是这样，仅存巨佬们的战斗力还是比蒟蒻们的战斗力大（废话）\n\n在$CTYZ$里面，一列队战斗力值是这样定义的\n\n $Fight=\\sum_{i=0}^{n-1} p_{i}*2^{i}$ \n\n其中$i$为行标号，从$0$开始，$p_{i}=1/0$表示这一行是否有人，\n\n现在$k$小$l$已经知道目前巨佬队伍的站队情况，现在他想问你，蒟蒻们有多少种可能的站队方式。\n\n然而$k$小$l$觉得这样的太简单了，$k$小$l$现在有$M$个询问，每次会给你一个蒟蒻战斗力值范围$[a,b]$和一个$k$，表示他希望知道蒟蒻们的战斗力值在$[a,b]$之间，战斗力值第$k$大的蒟蒻站队方式的战斗力值，如果站队方式总数小于$k$，那么输出$POOR$ $AFO!$。\n\n\n\n\n\n", "inputFormat": "第一行两个个整数$N,M$表示队列有$N$行，$k$小$l$的询问有$M$次。\n\n第二行为一串$01$串，表示巨佬们的站队方式。\n\n接下来$M$行，每行三个数$a_{i},b_{i},k_{i}$，表示$k$小$l$的询问。", "outputFormat": "输出$M$行表示答案，$k$小$l$特别良心，允许你对于这个战斗力取模$20031102$输出。", "hint": "对于$50$%的数据，$N<=20,M<=50$\n\n对于$100$%的数据，$N<=62,M<=500000$\n\n时限很松，请放心食用。", "locale": "zh-CN", "translations": {"en": {"title": "Queue Formation", "background": "This problem is the strengthened version. For the weakened version, please refer to $NOIP2017$ $DAY2$ $T3$.\n\n~~Okay, just to scare you a bit.~~", "description": "Some time ago, $k$-xiao-$l$ joined the military training for Grade 10 at $CTYZ$. As everyone knows, during military training you need to stand in a square formation.\n\nIn the team where $k$-xiao-$l$ is, there were originally $2*N$ people (weak ones and top ones), but now only a few top ones including $k$-xiao-$l$ and some weak ones are left.\n\nTop one $dwq$: Instructor, I still haven't finished debugging the last problem of this year's $IOI$. I'll go back first and solve it.\n\nInstructor: OK, leave approved. If you finish debugging in ten minutes, go back and rest first.\n\nWeak one $yz$: Instructor, I haven't finished the hard problems in today's task plan. I want to go back and do them.\n\nInstructor: Even if you go back now you still can't debug it. Stand properly. Stop trying to slack off.\n\n$k$-xiao-$l$ is a boy who loves learning. Now he finds that there are only two columns left on the playground. Originally, both columns had length $N$, but now they are incomplete. The weak ones stand in the first column, and the top ones stand in the second column. Also, if there is a top one in a row, their presence will make the weak ones in the adjacent position not dare to stand there.\n\n#### Even so, the remaining top ones are still stronger than the weak ones (obviously).\n\nIn $CTYZ$, the fighting value of one column is defined as\n\n$$Fight=\\sum_{i=0}^{n-1} p_{i}*2^{i}$$\n\nwhere $i$ is the row index starting from $0$, and $p_{i}=1/0$ indicates whether there is a person in this row.\n\nNow $k$-xiao-$l$ already knows the current standing situation of the top-one column. He wants to ask you: how many possible standing ways can the weak ones have?\n\nHowever, $k$-xiao-$l$ thinks this is too easy. He now has $M$ queries. Each query gives you a weak-ones fighting value range $[a,b]$ and a $k$, meaning he wants to know: among the weak-ones standing ways whose fighting value is within $[a,b]$, what is the fighting value of the $k$-th largest one. If the total number of standing ways is less than $k$, then output $POOR$ $AFO!$.", "inputFormat": "The first line contains two integers $N,M$, meaning the queue has $N$ rows, and $k$-xiao-$l$ has $M$ queries.\n\nThe second line is a $01$ string, representing the standing way of the top ones.\n\nThe next $M$ lines each contain three numbers $a_{i},b_{i},k_{i}$, representing the queries of $k$-xiao-$l$.", "outputFormat": "Output $M$ lines, each being the answer. $k$-xiao-$l$ is very kind and allows you to output the fighting value modulo $20031102$.", "hint": "For $50\\%$ of the data, $N<=20,M<=50$.\n\nFor $100\\%$ of the data, $N<=62,M<=500000$.\n\nThe time limit is very loose, so feel free to enjoy it.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "列队", "background": "本题是数据加强版，弱化版请参考$NOIP2017$   $DAY2$   $T3$\n\n~~好了吓吓你们~~", "description": "前段时间，$k$小$l$参加了$CTYZ$高一的的军训。众所周知，军训的时候需要站方阵。\n\n$k$小$l$ 所在的队伍中有原本有蒟蒻（巨佬）$2*N$个，然而现在的只剩$k$小$l$等少数巨佬和一些蒟蒻了。\n\n巨佬 $dwq$ ：教官我还有今年$IOI$的最后一题没调完，我先回去把题切了。\n\n教官：行，准假，过十分钟调完了就先回去休息吧。\n\n蒟蒻 $yz$ ：教官我今天任务计划里的红题还没做完，我要回去做。\n\n教官：你现在回去也调不出来，乖乖站♂好，不要老是想偷懒。\n\n$k$小$l$是一个热爱学习的男♀孩子，现在他发现，操场上只剩两列队了，原本两列的长度都为$N$，并且这两列队还残缺不全，蒟蒻在第一列，巨佬在第二列，并且如果一行中有巨佬，其气场会导致旁边不敢站蒟蒻。\n\n#### 就算是这样，仅存巨佬们的战斗力还是比蒟蒻们的战斗力大（废话）\n\n在$CTYZ$里面，一列队战斗力值是这样定义的\n\n $Fight=\\sum_{i=0}^{n-1} p_{i}*2^{i}$ \n\n其中$i$为行标号，从$0$开始，$p_{i}=1/0$表示这一行是否有人，\n\n现在$k$小$l$已经知道目前巨佬队伍的站队情况，现在他想问你，蒟蒻们有多少种可能的站队方式。\n\n然而$k$小$l$觉得这样的太简单了，$k$小$l$现在有$M$个询问，每次会给你一个蒟蒻战斗力值范围$[a,b]$和一个$k$，表示他希望知道蒟蒻们的战斗力值在$[a,b]$之间，战斗力值第$k$大的蒟蒻站队方式的战斗力值，如果站队方式总数小于$k$，那么输出$POOR$ $AFO!$。\n\n\n\n\n\n", "inputFormat": "第一行两个个整数$N,M$表示队列有$N$行，$k$小$l$的询问有$M$次。\n\n第二行为一串$01$串，表示巨佬们的站队方式。\n\n接下来$M$行，每行三个数$a_{i},b_{i},k_{i}$，表示$k$小$l$的询问。", "outputFormat": "输出$M$行表示答案，$k$小$l$特别良心，允许你对于这个战斗力取模$20031102$输出。", "hint": "对于$50$%的数据，$N<=20,M<=50$\n\n对于$100$%的数据，$N<=62,M<=500000$\n\n时限很松，请放心食用。", "locale": "zh-CN"}}}
{"pid": "P5142", "type": "P", "difficulty": 5, "samples": [["4 8\n0 0 0 0\n1 1 1\n1 2 2\n1 3 3\n1 4 4\n2 1 1\n2 1 2\n2 1 3\n2 1 4", "0\n250000002\n666666672\n250000003"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "线段树", "树状数组", "洛谷原创", "洛谷比赛"], "title": "区间方差", "background": "出题人并没有能力写有趣的题面……\n", "description": "对于一个长度为 $n$ 的序列 $a_1,a_2,a_3\\cdots a_n$，我们定义它的平均数 $a$ 为:\n\n$$a=\\frac{1}{n}\\sum_{i=1}^{n}a_i$$\n\n并定义它的方差 $d$ 为:\n\n$$d=\\frac{1}{n}\\sum_{i=1}^{n}(a_i-a)^2$$\n\n现在给定一个长度为 $n$ 的序列 $b_1,b_2\\cdots b_n$。你需要支持两种操作。每种操作的格式为 `c x y`。\n\n若 $c=1$，为修改操作，代表将 $b_x$ 赋值为 $y$。\n\n若 $c=2$，为查询操作，代表查询 $b_x$ 到 $b_y$ 的方差。\n\n为了避免浮点数误差，请以分数取模形式输出结果（对 $1000000007$（$10^9+7$）取模）。", "inputFormat": "第一行两个整数 $n,m$，代表序列 $b$ 的长度为 $n$，有 $m$ 个操作。\n\n第二行 $n$ 个整数 $b_i$，表示序列 $b$ 的初始值。\n\n下面有 $m$ 行整数，每行格式为 `c x y`，含义如上文所示。保证所有操作合法。", "outputFormat": "对于每个操作 2，输出一行。\n", "hint": "#### 样例 1 解释\n四次修改后，序列 $b$ 为：$\\{1,2,3,4\\}$。\n\n区间 $[1,1]$ 的方差为 $0$。\n\n区间 $[1,2]$ 的方差为 $\\frac{1}{4}$ 。$4$ 的逆元为 $250000002$。\n\n区间 $[1,3]$ 的方差为 $\\frac{2}{3}$。$3$ 的逆元为 $333333336$，$2\\times333333336\\bmod M=666666672$。\n\n#### 数据规模与约定\n\n- 对于 $50\\%$ 的数据，$n\\leq 1000$，$m\\leq 1000$。\n- 对于 $100\\%$ 的数据，$1\\leq n,m\\leq 1\\times 10^5$，$0\\leq b_i\\leq 1\\times 10^9$，$1\\leq x\\leq n$。对于操作 1，$0\\leq y\\leq 1\\times 10^9$。对于操作2，$x\\leq y\\leq n$。", "locale": "zh-CN", "translations": {"en": {"title": "Interval Variance", "background": "The problem setter is not able to write an interesting statement...", "description": "For a sequence of length $n$, $a_1,a_2,a_3\\cdots a_n$, we define its mean $a$ as:\n$$a=\\frac{1}{n}\\sum_{i=1}^{n}a_i$$\nand define its variance $d$ as:\n$$d=\\frac{1}{n}\\sum_{i=1}^{n}(a_i-a)^2$$\n\nNow you are given a sequence $b_1,b_2\\cdots b_n$ of length $n$. You need to support two operations. Each operation has the format `c x y`.\n\nIf $c=1$, it is an update: set $b_x$ to $y$.\n\nIf $c=2$, it is a query: compute the variance of $b_x$ through $b_y$ (inclusive).\n\nTo avoid floating-point errors, output the result as a fraction modulo (mod $1000000007$ ($10^9+7$)).", "inputFormat": "The first line contains two integers $n,m$, meaning the sequence $b$ has length $n$ and there are $m$ operations.\n\nThe second line contains $n$ integers $b_i$, representing the initial values of sequence $b$.\n\nThen there are $m$ lines, each in the format `c x y`, with meanings as described above. All operations are guaranteed to be valid.", "outputFormat": "For each operation $2$, output one line.", "hint": "#### Explanation for Sample 1\nAfter four updates, the sequence $b$ is: $\\{1,2,3,4\\}$.\n\nThe variance of interval $[1,1]$ is $0$.\n\nThe variance of interval $[1,2]$ is $\\frac{1}{4}$. The modular inverse of $4$ is $250000002$.\n\nThe variance of interval $[1,3]$ is $\\frac{2}{3}$. The modular inverse of $3$ is $333333336$, and $2\\times333333336\\bmod M=666666672$.\n\n#### Constraints\n\n- For $50\\%$ of the testdata, $n\\leq 1000$, $m\\leq 1000$.\n- For $100\\%$ of the testdata, $1\\leq n,m\\leq 1\\times 10^5$, $1\\leq b_i\\leq 1\\times 10^9$, $1\\leq x\\leq n$. For operation $1$, $1\\leq y\\leq 1\\times 10^9$. For operation $2$, $x\\leq y\\leq n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "区间方差", "background": "出题人并没有能力写有趣的题面……\n", "description": "对于一个长度为 $n$ 的序列 $a_1,a_2,a_3\\cdots a_n$，我们定义它的平均数 $a$ 为:\n\n$$a=\\frac{1}{n}\\sum_{i=1}^{n}a_i$$\n\n并定义它的方差 $d$ 为:\n\n$$d=\\frac{1}{n}\\sum_{i=1}^{n}(a_i-a)^2$$\n\n现在给定一个长度为 $n$ 的序列 $b_1,b_2\\cdots b_n$。你需要支持两种操作。每种操作的格式为 `c x y`。\n\n若 $c=1$，为修改操作，代表将 $b_x$ 赋值为 $y$。\n\n若 $c=2$，为查询操作，代表查询 $b_x$ 到 $b_y$ 的方差。\n\n为了避免浮点数误差，请以分数取模形式输出结果（对 $1000000007$（$10^9+7$）取模）。", "inputFormat": "第一行两个整数 $n,m$，代表序列 $b$ 的长度为 $n$，有 $m$ 个操作。\n\n第二行 $n$ 个整数 $b_i$，表示序列 $b$ 的初始值。\n\n下面有 $m$ 行整数，每行格式为 `c x y`，含义如上文所示。保证所有操作合法。", "outputFormat": "对于每个操作 2，输出一行。\n", "hint": "#### 样例 1 解释\n四次修改后，序列 $b$ 为：$\\{1,2,3,4\\}$。\n\n区间 $[1,1]$ 的方差为 $0$。\n\n区间 $[1,2]$ 的方差为 $\\frac{1}{4}$ 。$4$ 的逆元为 $250000002$。\n\n区间 $[1,3]$ 的方差为 $\\frac{2}{3}$。$3$ 的逆元为 $333333336$，$2\\times333333336\\bmod M=666666672$。\n\n#### 数据规模与约定\n\n- 对于 $50\\%$ 的数据，$n\\leq 1000$，$m\\leq 1000$。\n- 对于 $100\\%$ 的数据，$1\\leq n,m\\leq 1\\times 10^5$，$0\\leq b_i\\leq 1\\times 10^9$，$1\\leq x\\leq n$。对于操作 1，$0\\leq y\\leq 1\\times 10^9$。对于操作2，$x\\leq y\\leq n$。", "locale": "zh-CN"}}}
{"pid": "P5143", "type": "P", "difficulty": 2, "samples": [["5\n2 2 2\n1 1 1\n4 4 4\n3 3 3\n5 5 5\n", "6.928"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["洛谷原创", "排序", "洛谷比赛"], "title": "攀爬者", "background": "HKE 考完 GDOI 之后跟他的神犇小伙伴们一起去爬山。", "description": "HKE 在地形图上标记了 $N$ 个点，每个点 $P_i$ 都有一个坐标 $(x_i,y_i,z_i)$，且在所有点对中，高度值 $z$ 不会相等。HKE 准备从最低的点爬到最高的点，他的攀爬满足以下条件：\n\n1. 经过他标记的每一个点；\n2. 从第二个点开始，他经过的每一个点高度 $z$ 都比上一个点高；\n3. HKE 会飞，他从一个点 $P_i$ 爬到 $P_j$ 的距离为两个点的欧几里得距离，即 $\\sqrt{(X_i-X_j)^2+(Y_i-Y_j)^2+(Z_i-Z_j)^2}$。\n\n现在，HKE 希望你能求出他攀爬的总距离。", "inputFormat": "第一行，一个整数 $N$ 表示地图上的点数。\n\n接下来 $N$ 行，每行三个整数 $x_i,y_i,z_i$，表示第 $i$ 个点的坐标。", "outputFormat": "一个实数，表示 HKE 需要攀爬的总距离（保留三位小数）。", "hint": "对于 $100\\%$ 的数据，$1\\leq N\\leq 50000$，答案在 `double` 类型的表示范围内。", "locale": "zh-CN", "translations": {"en": {"title": "Climber", "background": "After finishing GDOI, HKE went to climb a mountain with his \"shenben\" friends.", "description": "He marked $N$ points on a topographic map, where each point $P_i$ has coordinates $(x_i, y_i, z_i)$. Among all points, the height values $z$ are pairwise distinct. HKE plans to climb from the lowest point to the highest point, and his climbing satisfies the following conditions:\n\n(1) He visits every point he marked.\n\n(2) Starting from the second point, the height $z$ of each visited point is higher than that of the previous point.\n\n(3) HKE can fly. The distance he travels from a point $P_i$ to $P_j$ is the Euclidean distance between the two points, i.e., $\\sqrt{(X_i-X_j)^2+(Y_i-Y_j)^2+(Z_i-Z_j)^2}$.\n\nNow, HKE wants you to compute the total distance of his climb.", "inputFormat": "The first line contains an integer $N$ indicating the number of points on the map.\n\nEach of the next $N$ lines contains three integers $x_i, y_i, z_i$, representing the coordinates of the $i$-th point.", "outputFormat": "Output a real number representing the total distance HKE needs to climb (rounded to three decimal places).", "hint": "For 100% of the testdata, $1\\leq N\\leq 50000$, and the answer is within the range of a double.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "攀爬者", "background": "HKE 考完 GDOI 之后跟他的神犇小伙伴们一起去爬山。", "description": "HKE 在地形图上标记了 $N$ 个点，每个点 $P_i$ 都有一个坐标 $(x_i,y_i,z_i)$，且在所有点对中，高度值 $z$ 不会相等。HKE 准备从最低的点爬到最高的点，他的攀爬满足以下条件：\n\n1. 经过他标记的每一个点；\n2. 从第二个点开始，他经过的每一个点高度 $z$ 都比上一个点高；\n3. HKE 会飞，他从一个点 $P_i$ 爬到 $P_j$ 的距离为两个点的欧几里得距离，即 $\\sqrt{(X_i-X_j)^2+(Y_i-Y_j)^2+(Z_i-Z_j)^2}$。\n\n现在，HKE 希望你能求出他攀爬的总距离。", "inputFormat": "第一行，一个整数 $N$ 表示地图上的点数。\n\n接下来 $N$ 行，每行三个整数 $x_i,y_i,z_i$，表示第 $i$ 个点的坐标。", "outputFormat": "一个实数，表示 HKE 需要攀爬的总距离（保留三位小数）。", "hint": "对于 $100\\%$ 的数据，$1\\leq N\\leq 50000$，答案在 `double` 类型的表示范围内。", "locale": "zh-CN"}}}
{"pid": "P5144", "type": "P", "difficulty": 4, "samples": [["5 3\n1 2 3 4 5\n", "15\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "洛谷原创", "洛谷比赛"], "title": "蜈蚣", "background": "一群人在山上遇见了一条蜈蚣。", "description": "在一条山路的转角处，WYH 发现了一条有中指一样粗的有 $N$ 节的蜈蚣。这只蜈蚣马上就吸引了 HKE 的眼球，HKE 深深地爱上了这条魔性的蜈蚣。它的很多对足在前进的时候像波浪一样，颇是有毒。\n\n但是，热爱解剖动物的 MZL 却准备把蜈蚣切了。HKE 很失落，于是 MZL 承诺不会完全肢解它，只把它的 $N$ 节切成 $M$ 段，每一段包含原蜈蚣完整的一节或多节。\n\nHKE 看到他心爱的蜈蚣会切掉是会觉得恶心的。蜈蚣的每一节都有一个权值 $W_i$，切下来的一段 $(W_i, W_{i + 1}, \\ldots, W_j)$ 带给 HKE 的恶心值是 $W_i \\mathbin{\\mathrm{xor}} W_{i + 1} \\mathbin{\\mathrm{xor}} \\cdots \\mathbin{\\mathrm{xor}} W_j$，这里的 $\\mathbin{\\mathrm{xor}}$ 代表按位异或操作。邪恶的 LJC 希望 HKE 受到的总恶心值 —— 也就是每一段子蜈蚣带给 HKE 的恶心值的和最大，请你求出 HKE 的最大恶心值。\n\n（注：按位异或，其运算符号在 Pascal 中为 `xor`，在 C++ 中为 `^` 或 `xor`；请注意加法与异或运算的优先级先后顺序）", "inputFormat": "第一行，两个整数 $N, M$，表示蜈蚣长 $N$ 节，切成 $M$ 段。\n\n第二行 $N$ 个整数用空格分开，表示蜈蚣每一节的权值 $W_1, W_2, \\ldots, W_n$。", "outputFormat": "一个整数表示最大恶心值。", "hint": "**【样例解释 \\#1】**\n\n第一段的恶心值为 $1 \\mathbin{\\mathrm{xor}} 2 = 3$。\n\n第二段的恶心值为 $3 \\mathbin{\\mathrm{xor}} 4 = 7$\n\n第三段的恶心值为 $5$\n\n总恶心值为 $3 + 7 + 5 = 15$。此时为最优解。\n\n**【数据范围】**\n\n对于 $30 \\%$ 的数据，$1 \\le N \\le 100$，$1 \\le M \\le 10$；\n\n对于 $100 \\%$ 的数据，$1 \\le N \\le 1000$，$1 \\le M \\le 100$，保证结果在 $2^{30} - 1$ 内；\n", "locale": "zh-CN", "translations": {"en": {"title": "Centipede", "background": "A group of people encountered a centipede on a mountain.", "description": "At a turn on a mountain path, WYH found a centipede as thick as a middle finger with $N$ segments. This centipede immediately caught HKE's eye, and HKE fell deeply in love with this uncanny centipede. Many pairs of its legs move like waves when it crawls.\n\nHowever, MZL, who loves dissecting animals, planned to cut the centipede. HKE felt upset, so MZL promised not to dismember it completely, but to cut its $N$ segments into $M$ parts, each part containing one or more consecutive original segments.\n\nHKE feels sick when he sees his beloved centipede being cut. Each segment has a weight $W_i$. The nausea value of a cut part $(W_i, W_{i + 1}, \\ldots, W_j)$ is $W_i \\mathbin{\\mathrm{xor}} W_{i + 1} \\mathbin{\\mathrm{xor}} \\cdots \\mathbin{\\mathrm{xor}} W_j$, where $\\mathbin{\\mathrm{xor}}$ denotes the bitwise XOR operation. The evil LJC wants the total nausea value — that is, the sum of the nausea values of all parts — to be as large as possible. Please compute the maximum total nausea value that HKE can suffer.\n\n(Note: For bitwise XOR, the operator is `xor` in Pascal, and `^` or `xor` in C++. Please pay attention to the precedence between addition and XOR operations.).", "inputFormat": "The first line contains two integers $N, M$, meaning the centipede has $N$ segments and will be cut into $M$ parts.\n\nThe second line contains $N$ integers separated by spaces, representing the weights $W_1, W_2, \\ldots, W_N$ of the segments.", "outputFormat": "Output a single integer, the maximum total nausea value.", "hint": "[Sample Explanation #1]\n\nThe nausea value of the first part is $1 \\mathbin{\\mathrm{xor}} 2 = 3$.\n\nThe nausea value of the second part is $3 \\mathbin{\\mathrm{xor}} 4 = 7$.\n\nThe nausea value of the third part is $5$.\n\nThe total nausea value is $3 + 7 + 5 = 15$. This is optimal.\n\n[Constraints]\n\nFor $30\\%$ of the testdata, $1 \\le N \\le 100$, $1 \\le M \\le 10$.\n\nFor $100\\%$ of the testdata, $1 \\le N \\le 1000$, $1 \\le M \\le 100$, and the result is guaranteed to be within $2^{30} - 1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "蜈蚣", "background": "一群人在山上遇见了一条蜈蚣。", "description": "在一条山路的转角处，WYH 发现了一条有中指一样粗的有 $N$ 节的蜈蚣。这只蜈蚣马上就吸引了 HKE 的眼球，HKE 深深地爱上了这条魔性的蜈蚣。它的很多对足在前进的时候像波浪一样，颇是有毒。\n\n但是，热爱解剖动物的 MZL 却准备把蜈蚣切了。HKE 很失落，于是 MZL 承诺不会完全肢解它，只把它的 $N$ 节切成 $M$ 段，每一段包含原蜈蚣完整的一节或多节。\n\nHKE 看到他心爱的蜈蚣会切掉是会觉得恶心的。蜈蚣的每一节都有一个权值 $W_i$，切下来的一段 $(W_i, W_{i + 1}, \\ldots, W_j)$ 带给 HKE 的恶心值是 $W_i \\mathbin{\\mathrm{xor}} W_{i + 1} \\mathbin{\\mathrm{xor}} \\cdots \\mathbin{\\mathrm{xor}} W_j$，这里的 $\\mathbin{\\mathrm{xor}}$ 代表按位异或操作。邪恶的 LJC 希望 HKE 受到的总恶心值 —— 也就是每一段子蜈蚣带给 HKE 的恶心值的和最大，请你求出 HKE 的最大恶心值。\n\n（注：按位异或，其运算符号在 Pascal 中为 `xor`，在 C++ 中为 `^` 或 `xor`；请注意加法与异或运算的优先级先后顺序）", "inputFormat": "第一行，两个整数 $N, M$，表示蜈蚣长 $N$ 节，切成 $M$ 段。\n\n第二行 $N$ 个整数用空格分开，表示蜈蚣每一节的权值 $W_1, W_2, \\ldots, W_n$。", "outputFormat": "一个整数表示最大恶心值。", "hint": "**【样例解释 \\#1】**\n\n第一段的恶心值为 $1 \\mathbin{\\mathrm{xor}} 2 = 3$。\n\n第二段的恶心值为 $3 \\mathbin{\\mathrm{xor}} 4 = 7$\n\n第三段的恶心值为 $5$\n\n总恶心值为 $3 + 7 + 5 = 15$。此时为最优解。\n\n**【数据范围】**\n\n对于 $30 \\%$ 的数据，$1 \\le N \\le 100$，$1 \\le M \\le 10$；\n\n对于 $100 \\%$ 的数据，$1 \\le N \\le 1000$，$1 \\le M \\le 100$，保证结果在 $2^{30} - 1$ 内；\n", "locale": "zh-CN"}}}
{"pid": "P5145", "type": "P", "difficulty": 3, "samples": [["6\n2 1\n3 2\n1 3\n5 2\n6 2\n4 2\n", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索"], "title": "漂浮的鸭子", "background": null, "description": "下雨时地上会有一个个水坑，但一个水坑只会流向另一个特定的水坑，而且水不会回流。可能会有多个水坑同时流向一个水坑。这天又下起了雨夹鸭，每个水坑里都漂浮着一只鸭子。WYH 在每个水坑旁派遣了一个特派员，特派员会在鸭子上做记号。在某一时刻，全部鸭子开始顺水漂浮，同时特派员开始计时。当某个特派员发现他做的那个记号的鸭子漂浮回来的时候，他就会停止计时，把时间上报给 WYH。现在 WYH 探勘了地形后把每段水流的关系与时间告诉了你，他想知道他所获得的所有数据中最大的那个是？", "inputFormat": "第一行一个正整数 $n$，代表有 $n$ 个水坑（从 $1$ 到 $n$ 编号）。\n\n第 $2 \\sim n+1 $ 行每行两个正整数，其中第 $i+1$ 行的两个整数为 $D_i$ 与 $T_i$，代表第 $i$ 号水坑的水会流向 $D_i$ 号坑，流动所需时间为 $T_i$。保证 $D_i \\neq i$。", "outputFormat": "一个整数，代表 WYH 手上获得的特派员数据中最大的那个数。", "hint": "$30\\%$ 的数据保证 $n \\leq 100$；\n\n$100\\%$ 的数据保证 $n \\leq 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "Floating Ducks", "background": "", "description": "When it rains, puddles form on the ground. Each puddle flows to exactly one specific other puddle, and the flow is one-way (no backflow). Multiple puddles may flow into the same puddle. On this day, it started to rain \"mixed with ducks\", and there is a duck floating in every puddle. WYH dispatches an agent beside every puddle, and each agent marks the duck in his puddle. At a certain moment, all ducks start drifting along with the water simultaneously, and all agents start timing. When an agent sees the duck he marked drift back, he stops timing and reports the time to WYH. After surveying the terrain, WYH tells you the flow relation and travel time for every segment, and he wants to know the maximum among all the numbers he obtained.", "inputFormat": "The first line contains a positive integer $n$, meaning there are $n$ puddles (numbered from $1$ to $n$).\n\nLines $2 \\sim n+1$ each contain two positive integers. On line $i+1$, the two integers are $D_i$ and $T_i$, meaning the water of puddle $i$ flows to puddle $D_i$, and the flow takes time $T_i$. It is guaranteed that $D_i \\neq i$.", "outputFormat": "Output a single integer, the maximum among the agent-reported times that WYH has.", "hint": "For $30\\%$ of the testdata, $n \\leq 100$.\n\nFor $100\\%$ of the testdata, $n \\leq 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "漂浮的鸭子", "background": null, "description": "下雨时地上会有一个个水坑，但一个水坑只会流向另一个特定的水坑，而且水不会回流。可能会有多个水坑同时流向一个水坑。这天又下起了雨夹鸭，每个水坑里都漂浮着一只鸭子。WYH 在每个水坑旁派遣了一个特派员，特派员会在鸭子上做记号。在某一时刻，全部鸭子开始顺水漂浮，同时特派员开始计时。当某个特派员发现他做的那个记号的鸭子漂浮回来的时候，他就会停止计时，把时间上报给 WYH。现在 WYH 探勘了地形后把每段水流的关系与时间告诉了你，他想知道他所获得的所有数据中最大的那个是？", "inputFormat": "第一行一个正整数 $n$，代表有 $n$ 个水坑（从 $1$ 到 $n$ 编号）。\n\n第 $2 \\sim n+1 $ 行每行两个正整数，其中第 $i+1$ 行的两个整数为 $D_i$ 与 $T_i$，代表第 $i$ 号水坑的水会流向 $D_i$ 号坑，流动所需时间为 $T_i$。保证 $D_i \\neq i$。", "outputFormat": "一个整数，代表 WYH 手上获得的特派员数据中最大的那个数。", "hint": "$30\\%$ 的数据保证 $n \\leq 100$；\n\n$100\\%$ 的数据保证 $n \\leq 10^5$。", "locale": "zh-CN"}}}
