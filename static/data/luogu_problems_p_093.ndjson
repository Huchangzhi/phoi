{"pid": "P2888", "type": "P", "difficulty": 3, "samples": [["5 6 3\n1 2 12\n3 2 8\n1 3 5\n2 5 3\n3 4 4\n2 4 8\n3 4\n1 2\n5 1\n", "4\n8\n-1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2007", "USACO", "最短路"], "title": "[USACO07NOV] Cow Hurdles S", "background": null, "description": "Farmer John 想让她的奶牛准备郡级跳跃比赛，Bessie 和她的伙伴们正在练习跨栏。她们很累，所以她们想消耗最少的能量来跨栏。 显然，对于一头奶牛跳过几个矮栏是很容易的，但是高栏却很难。于是，奶牛们总是关心路径上最高的栏的高度。 \n\n奶牛的训练场中有 $N$ 个站台，分别标记为 $1,\\dots,N$。所有站台之间有 $M$ 条单向路径，第 $i$ 条路经是从站台 $S_i$ 开始，到站台 $E_i$，其中最高的栏的高度为 $H_i$。无论如何跑，奶牛们都要跨栏。 \n\n奶牛们有 $T$ 个训练任务要完成。第 $i$ 个任务包含两个数字 $A_i$ 和 $B_i$，表示奶牛必须从站台 $A_i$ 跑到站台 $B_i$，可以路过别的站台。奶牛们想找一条路径从站台 $A_i$ 到站台 $B_i$，使路径上最高的栏的高度最小。 你的任务就是写一个程序，计算出路径上最高的栏的高度的最小值。", "inputFormat": "第一行：三个空格隔开的整数 $N, M, T$。\n\n接下来 $M$ 行：第 $i$ 行包含三个空格隔开的整数 $S_i, E_i, H_i$。\n\n接下来 $T$ 行：第 $i$ 行包含两个空格隔开的整数，表示任务 $i$ 的起始站台和目标站台 $A_i, B_i$。", "outputFormat": "$T$ 行：第 $i$ 行为一个整数，表示任务 $i$ 路径上最高的栏的高度的最小值。如果无法到达，输出 `-1`。", "hint": "对于 $100\\%$ 的数据，$1 \\le N \\le 300$，$1 \\le M \\le 2.5 \\times 10^4$，$1 \\le H_i \\le 1 \\times 10^6$，$1 \\le T \\le 4 \\times 10^4$，$1 \\le A_i,B_i \\le N$。\n\n感谢 @gaozhiyong @_Cppsteve_ 提供翻译", "locale": "zh-CN", "translations": {"en": {"title": "[USACO07NOV] Cow Hurdles S", "background": null, "description": "Farmer John wants the cows to prepare for the county jumping competition, so Bessie and the gang are practicing jumping over hurdles. They are getting tired, though, so they want to be able to use as little energy as possible to jump over the hurdles.\n\nObviously, it is not very difficult for a cow to jump over several very short hurdles, but one tall hurdle can be very stressful. Thus, the cows are only concerned about the height of the tallest hurdle they have to jump over.\n\nThe cows' practice room has $N$ stations, conveniently labeled $1,\\dots,N$. A set of $M$ one-way paths connects pairs of stations; the paths are also conveniently labeled $1,\\dots,M$. Path $i$ travels from station $S_i$ to station $E_i$ and contains exactly one hurdle of height $H_i$. Cows must jump hurdles in any path they traverse.\n\nThe cows have $T$ tasks to complete. Task $i$ comprises two distinct numbers, $A_i$ and $B_i$, which connote that a cow has to travel from station $A_i$ to station $B_i$ (by traversing over one or more paths over some route). The cows want to take a path the minimizes the height of the tallest hurdle they jump over when traveling from $A_i$ to $B_i$ . Your job is to write a program that determines the path whose tallest hurdle is smallest and report that height.", "inputFormat": "\\* Line $1$: Three space-separated integers: $N$, $M$, and $T$\n\n\\* Lines $2,\\dots,M+1$: Line $i+1$ contains three space-separated integers: $S_i$ , $E_i$ , and $H_i$\n\n\\* Lines $M+2,\\dots,M+T+1$: Line $i+M+1$ contains two space-separated integers that describe task $i$: $A_i$ and $B_i$", "outputFormat": "\\* Lines $1,\\dots,T$: Line $i$ contains the result for task $i$ and tells the smallest possible maximum height necessary to travel between the stations. Output `-1` if it is impossible to travel between the two stations.", "hint": null, "locale": "en"}, "zh-CN": {"title": "[USACO07NOV] Cow Hurdles S", "background": null, "description": "Farmer John 想让她的奶牛准备郡级跳跃比赛，Bessie 和她的伙伴们正在练习跨栏。她们很累，所以她们想消耗最少的能量来跨栏。 显然，对于一头奶牛跳过几个矮栏是很容易的，但是高栏却很难。于是，奶牛们总是关心路径上最高的栏的高度。 \n\n奶牛的训练场中有 $N$ 个站台，分别标记为 $1,\\dots,N$。所有站台之间有 $M$ 条单向路径，第 $i$ 条路经是从站台 $S_i$ 开始，到站台 $E_i$，其中最高的栏的高度为 $H_i$。无论如何跑，奶牛们都要跨栏。 \n\n奶牛们有 $T$ 个训练任务要完成。第 $i$ 个任务包含两个数字 $A_i$ 和 $B_i$，表示奶牛必须从站台 $A_i$ 跑到站台 $B_i$，可以路过别的站台。奶牛们想找一条路径从站台 $A_i$ 到站台 $B_i$，使路径上最高的栏的高度最小。 你的任务就是写一个程序，计算出路径上最高的栏的高度的最小值。", "inputFormat": "第一行：三个空格隔开的整数 $N, M, T$。\n\n接下来 $M$ 行：第 $i$ 行包含三个空格隔开的整数 $S_i, E_i, H_i$。\n\n接下来 $T$ 行：第 $i$ 行包含两个空格隔开的整数，表示任务 $i$ 的起始站台和目标站台 $A_i, B_i$。", "outputFormat": "$T$ 行：第 $i$ 行为一个整数，表示任务 $i$ 路径上最高的栏的高度的最小值。如果无法到达，输出 `-1`。", "hint": "对于 $100\\%$ 的数据，$1 \\le N \\le 300$，$1 \\le M \\le 2.5 \\times 10^4$，$1 \\le H_i \\le 1 \\times 10^6$，$1 \\le T \\le 4 \\times 10^4$，$1 \\le A_i,B_i \\le N$。\n\n感谢 @gaozhiyong @_Cppsteve_ 提供翻译", "locale": "zh-CN"}}}
{"pid": "P2889", "type": "P", "difficulty": 3, "samples": [["12 4 2\n1 2 8\n10 12 19\n3 6 24\n7 10 31", "43"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2007", "USACO", "排序", "背包 DP"], "title": "[USACO07NOV] Milking Time S", "background": "", "description": "Bessie 可以在接下来 $N$ 个小时内产奶，为了方便，我们把这 $N$ 个小时 $1\\dots N$ 编号。\n\nFJ 在这 $N$ 个小时内有 $M$ 段时间可以来给 Bessie 挤奶，第 $i$ 段时间从 $Start_i$ 开始到 $End_i$ 结束，可以得到 $Eff_i$ 加仑牛奶。\n\n每次 FJ 给 Bessie 挤奶之后，Bessie 都要休息 $R$ 个小时，FJ 才能开始下一次挤奶。\n\n现在，FJ 需要您计算出 Bessie 在这 $N$ 个小时内最多产多少奶。", "inputFormat": "第一行有三个整数，分别表示 $N,M,R$。\n\n第 $2\\dots M+1$ 行，第 $i+1$ 行有三个整数 $Start_i,End_i,Eff_i$，描述一段挤奶的时间。", "outputFormat": "输出一行一个整数表示答案。", "hint": "#### 数据规模与约定\n对于全部的测试点，保证 $1\\le N\\le 10^6$，$1\\le M\\le 10^3$，$1\\le Start_i<end_i\\le N$，$1\\le Eff_i\\le 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO07NOV] Milking Time S", "background": "", "description": "Bessie can produce milk in the next $N$ hours. For convenience, we number these $N$ hours $1 \\dots N$.\n\nWithin these $N$ hours, FJ has $M$ intervals during which he can milk Bessie. The $i$-th interval runs from $Start_i$ to $End_i$ and yields $Eff_i$ gallons of milk.\n\nAfter each milking, Bessie must rest for $R$ hours before FJ can start the next milking.\n\nNow, FJ needs you to compute the maximum total milk Bessie can produce within these $N$ hours.", "inputFormat": "The first line contains three integers, representing $N$, $M$, and $R$.\n\nLines $2 \\dots M+1$: the $(i+1)$-th line contains three integers $Start_i$, $End_i$, and $Eff_i$, describing one milking interval.", "outputFormat": "Output a single integer on one line: the answer.", "hint": "#### Constraints\nFor all testdata, it is guaranteed that $1 \\le N \\le 10^6$, $1 \\le M \\le 10^3$, $1 \\le Start_i < End_i \\le N$, and $1 \\le Eff_i \\le 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO07NOV] Milking Time S", "background": "", "description": "Bessie 可以在接下来 $N$ 个小时内产奶，为了方便，我们把这 $N$ 个小时 $1\\dots N$ 编号。\n\nFJ 在这 $N$ 个小时内有 $M$ 段时间可以来给 Bessie 挤奶，第 $i$ 段时间从 $Start_i$ 开始到 $End_i$ 结束，可以得到 $Eff_i$ 加仑牛奶。\n\n每次 FJ 给 Bessie 挤奶之后，Bessie 都要休息 $R$ 个小时，FJ 才能开始下一次挤奶。\n\n现在，FJ 需要您计算出 Bessie 在这 $N$ 个小时内最多产多少奶。", "inputFormat": "第一行有三个整数，分别表示 $N,M,R$。\n\n第 $2\\dots M+1$ 行，第 $i+1$ 行有三个整数 $Start_i,End_i,Eff_i$，描述一段挤奶的时间。", "outputFormat": "输出一行一个整数表示答案。", "hint": "#### 数据规模与约定\n对于全部的测试点，保证 $1\\le N\\le 10^6$，$1\\le M\\le 10^3$，$1\\le Start_i<end_i\\le N$，$1\\le Eff_i\\le 10^6$。", "locale": "zh-CN"}}}
{"pid": "P2890", "type": "P", "difficulty": 4, "samples": [["3 4\nabcb\na 1000 1100\nb 350 700\nc 200 800\n", "900\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "动态规划 DP", "递推", "2007", "USACO", "区间 DP"], "title": "[USACO07OPEN] Cheapest Palindrome G", "background": "", "description": "Keeping track of all the cows can be a tricky task so Farmer John has installed a system to automate it. He has installed on each cow an electronic ID tag that the system will read as the cows pass by a scanner. Each ID tag's contents are currently a single string with length M (1 ≤ M ≤ 2,000) characters drawn from an alphabet of N (1 ≤ N ≤ 26) different symbols (namely, the lower-case roman alphabet).\n\nCows, being the mischievous creatures they are, sometimes try to spoof the system by walking backwards. While a cow whose ID is \"abcba\" would read the same no matter which direction the she walks, a cow with the ID \"abcb\" can potentially register as two different IDs (\"abcb\" and \"bcba\").\n\nFJ would like to change the cows's ID tags so they read the same no matter which direction the cow walks by. For example, \"abcb\" can be changed by adding \"a\" at the end to form \"abcba\" so that the ID is palindromic (reads the same forwards and backwards). Some other ways to change the ID to be palindromic are include adding the three letters \"bcb\" to the begining to yield the ID \"bcbabcb\" or removing the letter \"a\" to yield the ID \"bcb\". One can add or remove characters at any location in the string yielding a string longer or shorter than the original string.\n\nUnfortunately as the ID tags are electronic, each character insertion or deletion has a cost (0 ≤ cost ≤ 10,000) which varies depending on exactly which character value to be added or deleted. Given the content of a cow's ID tag and the cost of inserting or deleting each of the alphabet's characters, find the minimum cost to change the ID tag so it satisfies FJ's requirements. An empty ID tag is considered to satisfy the requirements of reading the same forward and backward. Only letters with associated costs can be added to a string.\n", "inputFormat": "Line 1: Two space-separated integers: N and M\n\n\nLine 2: This line contains exactly M characters which constitute the initial ID string\n\n\nLines 3..N+2: Each line contains three space-separated entities: a character of the input alphabet and two integers which are respectively the cost of adding and deleting that character.\n", "outputFormat": "Line 1: A single line with a single integer that is the minimum cost to change the given name tag.\n", "hint": "If we insert an \"a\" on the end to get \"abcba\", the cost would be 1000. If we delete the \"a\" on the beginning to get \"bcb\", the cost would be 1100. If we insert \"bcb\" at the begining of the string, the cost would be 350 + 200 + 350 = 900, which is the minimum.\n", "locale": "en", "translations": {"en": {"title": "[USACO07OPEN] Cheapest Palindrome G", "background": "", "description": "Keeping track of all the cows can be a tricky task so Farmer John has installed a system to automate it. He has installed on each cow an electronic ID tag that the system will read as the cows pass by a scanner. Each ID tag's contents are currently a single string with length M (1 ≤ M ≤ 2,000) characters drawn from an alphabet of N (1 ≤ N ≤ 26) different symbols (namely, the lower-case roman alphabet).\n\nCows, being the mischievous creatures they are, sometimes try to spoof the system by walking backwards. While a cow whose ID is \"abcba\" would read the same no matter which direction the she walks, a cow with the ID \"abcb\" can potentially register as two different IDs (\"abcb\" and \"bcba\").\n\nFJ would like to change the cows's ID tags so they read the same no matter which direction the cow walks by. For example, \"abcb\" can be changed by adding \"a\" at the end to form \"abcba\" so that the ID is palindromic (reads the same forwards and backwards). Some other ways to change the ID to be palindromic are include adding the three letters \"bcb\" to the begining to yield the ID \"bcbabcb\" or removing the letter \"a\" to yield the ID \"bcb\". One can add or remove characters at any location in the string yielding a string longer or shorter than the original string.\n\nUnfortunately as the ID tags are electronic, each character insertion or deletion has a cost (0 ≤ cost ≤ 10,000) which varies depending on exactly which character value to be added or deleted. Given the content of a cow's ID tag and the cost of inserting or deleting each of the alphabet's characters, find the minimum cost to change the ID tag so it satisfies FJ's requirements. An empty ID tag is considered to satisfy the requirements of reading the same forward and backward. Only letters with associated costs can be added to a string.\n", "inputFormat": "Line 1: Two space-separated integers: N and M\n\n\nLine 2: This line contains exactly M characters which constitute the initial ID string\n\n\nLines 3..N+2: Each line contains three space-separated entities: a character of the input alphabet and two integers which are respectively the cost of adding and deleting that character.\n", "outputFormat": "Line 1: A single line with a single integer that is the minimum cost to change the given name tag.\n", "hint": "If we insert an \"a\" on the end to get \"abcba\", the cost would be 1000. If we delete the \"a\" on the beginning to get \"bcb\", the cost would be 1100. If we insert \"bcb\" at the begining of the string, the cost would be 350 + 200 + 350 = 900, which is the minimum.\n", "locale": "en"}, "zh-CN": {"title": "[USACO07OPEN] Cheapest Palindrome G", "background": "", "description": "给定一个由 $n$ 个不同的小写字母构成的长 $m$ 的字符串 $s$。可以通过**在 $\\bm{s}$ 的任意位置**增减字母将 $s$ 改为回文串。增减字母的花费不同，求最小花费。", "inputFormat": "第 $1$ 行是两个整数 $n,m$。\n\n第 $2$ 行是字符串 $s$。\n\n接下 $n$ 行，每行一个字符 $c$ 和两个整数 $x,y$，表示添加一个 $c$ 的花费为 $x$，删除一个 $c$ 的花费为 $y$。", "outputFormat": "只有 $1$ 行，表示最小花费。", "hint": "对于 $100\\%$ 的数据，$1\\le m\\le2\\times10^3,1\\le n\\le 26,0\\le x,y\\le 10^4$。\n\n$\\mathrm{by\\ @}$[$\\mathrm{Fish\\_Know\\_Forever}$](/user/663215)", "locale": "zh-CN"}}}
{"pid": "P2891", "type": "P", "difficulty": 5, "samples": [["4 3 3\n2 2 1 2 3 1\n2 2 2 3 1 2\n2 2 1 3 1 2\n2 1 1 3 3", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["递推", "2007", "USACO", "网络流"], "title": "[USACO07OPEN] Dining G", "background": "", "description": "Cows are such finicky eaters. Each cow has a preference for certain foods and drinks, and she will consume no others.\n\nFarmer John has cooked fabulous meals for his cows, but he forgot to check his menu against their preferences. Although he might not be able to stuff everybody, he wants to give a complete meal of both food and drink to as many cows as possible.\n\nFarmer John has cooked F (1 ≤ F ≤ 100) types of foods and prepared D (1 ≤ D ≤ 100) types of drinks. Each of his N (1 ≤ N ≤ 100) cows has decided whether she is willing to eat a particular food or drink a particular drink. Farmer John must assign a food type and a drink type to each cow to maximize the number of cows who get both.\n\nEach dish or drink can only be consumed by one cow (i.e., once food type 2 is assigned to a cow, no other cow can be assigned food type 2).\n", "inputFormat": "Line 1: Three space-separated integers: N, F, and D\n\n\nLines 2..N+1: Each line i starts with a two integers Fi and Di, the number of dishes that cow i likes and the number of drinks that cow i likes. The next Fi integers  denote the dishes that cow i will eat, and the Di integers following that denote the drinks that cow i will drink.\n", "outputFormat": "Line 1: A single integer that is the maximum number of cows that can be fed both food and drink that conform to their wishes\n", "hint": "One way to satisfy three cows is:\n\n\nCow 1: no meal\n\n\nCow 2: Food #2, Drink #2\n\n\nCow 3: Food #1, Drink #1\n\n\nCow 4: Food #3, Drink #3\n\n\nThe pigeon-hole principle tells us we can do no better since there are only three kinds of food or drink. Other test data sets are more challenging, of course.\n", "locale": "en", "translations": {"en": {"title": "[USACO07OPEN] Dining G", "background": "", "description": "Cows are such finicky eaters. Each cow has a preference for certain foods and drinks, and she will consume no others.\n\nFarmer John has cooked fabulous meals for his cows, but he forgot to check his menu against their preferences. Although he might not be able to stuff everybody, he wants to give a complete meal of both food and drink to as many cows as possible.\n\nFarmer John has cooked F (1 ≤ F ≤ 100) types of foods and prepared D (1 ≤ D ≤ 100) types of drinks. Each of his N (1 ≤ N ≤ 100) cows has decided whether she is willing to eat a particular food or drink a particular drink. Farmer John must assign a food type and a drink type to each cow to maximize the number of cows who get both.\n\nEach dish or drink can only be consumed by one cow (i.e., once food type 2 is assigned to a cow, no other cow can be assigned food type 2).\n", "inputFormat": "Line 1: Three space-separated integers: N, F, and D\n\n\nLines 2..N+1: Each line i starts with a two integers Fi and Di, the number of dishes that cow i likes and the number of drinks that cow i likes. The next Fi integers  denote the dishes that cow i will eat, and the Di integers following that denote the drinks that cow i will drink.\n", "outputFormat": "Line 1: A single integer that is the maximum number of cows that can be fed both food and drink that conform to their wishes\n", "hint": "One way to satisfy three cows is:\n\n\nCow 1: no meal\n\n\nCow 2: Food #2, Drink #2\n\n\nCow 3: Food #1, Drink #1\n\n\nCow 4: Food #3, Drink #3\n\n\nThe pigeon-hole principle tells us we can do no better since there are only three kinds of food or drink. Other test data sets are more challenging, of course.\n", "locale": "en"}, "zh-CN": {"title": "[USACO07OPEN] Dining G", "background": "", "description": "奶牛是如此挑剔的食客。每头奶牛都有自己偏好的食物和饮料，她们不会吃其他的东西。\n\n农夫约翰为他的奶牛们准备了丰盛的饭菜，但他忘记检查菜单是否符合她们的偏好。虽然他可能无法满足所有奶牛，但他希望尽可能多地为奶牛提供一份完整的食物和饮料。\n\n农夫约翰准备了 $F$ 种食物（$1 \\le F \\le 100$）和 $D$ 种饮料（$1 \\le D \\le 100$）。他的 $N$ 头奶牛（$1 \\le N \\le 100$）已经决定她们愿意吃某种食物或喝某种饮料。农夫约翰必须为每头奶牛分配一种食物类型和一种饮料类型，以最大化同时获得食物和饮料的奶牛数量。\n\n每种食物或饮料只能被一头奶牛消费（即，一旦食物类型 2 被分配给一头奶牛，其他奶牛就不能再被分配食物类型 2）。\n", "inputFormat": "第 1 行：三个用空格分隔的整数：$N$，$F$ 和 $D$。\n\n\n第 2 行到第 $N+1$ 行：每行 $i$ 以两个整数 $F_i$ 和 $D_i$ 开始，分别表示奶牛 $i$ 喜欢的食物数量和饮料数量。接下来的 $F_i$ 个整数表示奶牛 $i$ 会吃的食物，接下来的 $D_i$ 个整数表示奶牛 $i$ 会喝的饮料。\n", "outputFormat": "第 1 行：一个整数，表示可以同时满足食物和饮料愿望的最大奶牛数量。\n", "hint": "一种满足三头奶牛的方法是：\n\n\n奶牛 1：没有餐食\n\n\n奶牛 2：食物 #2，饮料 #2\n\n\n奶牛 3：食物 #1，饮料 #1\n\n\n奶牛 4：食物 #3，饮料 #3\n\n\n鸽巢原理告诉我们，由于只有三种食物或饮料，我们不能做得更好。当然，其他测试数据集更具挑战性。\n（由 ChatGPT 4o 翻译）", "locale": "zh-CN"}}}
{"pid": "P2892", "type": "P", "difficulty": 7, "samples": [["4\n1 2\n3 2\n2 4", "2\n7\nL 2\nL 2\nM 2 1\nB 1\nL 3\nM 3 2\nM 2 4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2007", "NOI", "提交答案", "Special Judge", "O2优化"], "title": "[NOI2007] 追捕盗贼", "background": "SPJ 来源：loj-Robin。已获得授权。\n\nhttps://www.luogu.com.cn/paste/dxytr6gc \n\n附 SPJ，一些修改部分未按照代码规范，请各位谅解。", "description": "魔法国度 Magic Land 里最近出现了一个大盗 Frank，他在 Magic Land 四处作案，专门窃取政府机关的机密文件（因而有人怀疑 Frank 是敌国派来的间谍）。\n\n为了捉住 Frank，Magic Land 的安全局重拳出击！\n\nMagic Land 由 $N$ 个城市组成，并且这 $N$ 个城市又由恰好 $N-1$ 条公路彼此连接起来，使得任意两个城市间都可以通过若干条公路互达。从数据结构的角度我们也可以说，这 $N$ 个城市和 $N-1$ 条公路形成了一棵树。\n\n例如，下图就是 Magic Land 的一个可能格局（$4$ 个城市用数字编号，$3$ 条公路用字母编号）：\n\n ![](https://cdn.luogu.com.cn/upload/pic/12794.png) \n\n大盗 Frank 能够在公路上以任意速度移动。\n\n比方说，对于上图给出的格局，在 $0.00001$ 秒钟内（或者任意短的一段时间内），Frank 就可以从城市 $1$ 经过城市 $2$ 到达城市 $4$，中间经过了两条公路。\n\n想要生擒 Frank 困难重重，所以安全局派出了经验丰富的警探，这些警探具有非凡的追捕才能：\n\n1.  只要有警探和 Frank 同处一个城市，那么就能够立刻察觉到 Frank，并且将其逮捕。\n2.  虽然 Frank 可以在公路上以任意快的速度移动，但是如果有警探和 Frank 在同一条公路上相遇，那么警探也可以立刻察觉到 Frank 并将其逮捕。\n\n安全局完全不知道 Frank 躲在哪个城市，或者正在哪条公路上移动，所以需要制定一个周密的抓捕计划，计划由若干步骤组成。在每一步中，可以做如下几件事中的一个：\n\n1.  在某个城市空降一位警探。警探可以直接从指挥部空降到 Magic Land 的任意一个城市里。此操作记为 `L x`，表示在编号为 $x$ 的城市里空降一位警探。耗时 $1$ 秒。\n2.  把留在某个城市里的一位警探直接召回指挥部。以备在以后的步骤中再度空降到某个城市里。此操作记为 `B x`。表示把编号为 $x$ 的城市里的一位警探召回指挥部。耗时 $1$ 秒。\n3.  让待在城市 $x$ 的一位警探沿着公路移动到城市 $y$，此操作记为 `M x y`。耗时 $1$ 秒。当然，前提是城市 $x$ 和城市 $y$ 之间有公路。如果在警探移动的过程中，大盗 Frank 也在同一条公路上，那么警探就抓捕到了Frank。\n\n现在，由你来制定一套追捕计划，也就是给出若干个步骤，需要保证：无论大盗 Frank 一开始躲在哪儿，也无论 Frank 在整个过程中如何狡猾地移动（Frank 大盗可能会窃取到追捕行动的计划书，所以他一定会想尽办法逃避），他一定会被缉拿归案。\n\n希望参与的警探越少越好，因为经验丰富的警探毕竟不多。\n\n例如对于前面所给的那个图示格局，一个可行的计划如下：\n\n1.  `L 2`：在城市 $2$ 空降一位警探。注意这一步完成之后，城市 $2$ 里不会有 Frank，否则他将被捉住。\n2.  `L 2`：再在城市 $2$ 空降一位警探。\n3.  `M 2 1`：让城市 $2$ 的一位警探移动到城市 $1$。注意城市 $2$ 里还留有另一位警探。这一步完成之后，城市 $1$ 里不会有 Frank，公路 $A$ 上也不会有 Frank。也就是说，假如 Frank 还没有被逮捕，那么他只能是在城市 $3$ 或城市 $4$ 里，或者公路 $B$ 或公路 $C$ 上。\n4.  `B 1`：召回城市 $1$ 的一位警探。注意虽然召回了这位警探，但是由于我们始终留了一位警探在城市 $2$ 把守，所以 Frank 仍然不可能跑到城市 $1$ 或者是公路 $A$ 上。\n5.  `L 3`：在城市 $3$ 空降一位警探。注意这一步可以空降在此之前被召回的那位警探。这一步完成之后，城市 $3$ 里不会有 Frank，否则他会被捉住。\n6.  `M 3 2`：让城市 $3$ 里的一位警探移动到城市 $2$。这一步完成之后，如果 Frank 还没有被捉住，那他只能是在公路 $C$ 上或者城市 $4$ 里。注意这一步之后，城市 $2$ 里有两位警探。\n7.  `M 2 4` 让城市 $2$ 里的一位警探移动到城市 $4$。这一步完成之后，Frank 一定会被捉住，除非他根本就没来 Magic Land。\n\n这个计划总共需要 $2$ 位警探的参与。可以证明：如果自始至终只有 $1$ 名或者更少的警探参与，则 Frank 就会逍遥法外。\n\n你的任务很简单：对于一个输入的 Magic Land 的格局，计算 $S$，也就是为了追捕 Frank 至少需要投入多少位警探，并且给出相应的追捕计划步骤。", "inputFormat": "输入文件给出了 Magic Land 的格局。\n\n第一行一个整数 $N$，代表有 $N$ 个城市，城市的编号是 $1\\sim N$。\n\n接下来 $N-1$ 行，每行有两个用空格分开的整数 $x_i,y_i$，代表城市 $x_i,y_i$ 之间有公路相连。保证 $1\\le x_i,y_i \\le N$。", "outputFormat": "向输出文件输出你所给出的追捕计划。\n\n第一行请输出一个整数 $S$，代表追捕计划需要多少位警探。\n\n第二行请输出一个整数 $T$，代表追捕计划总共有多少步。\n\n接下来请输出 $T$ 行，依次描述了追捕计划的每一步。每行必须是以下三种形式之一：\n\n\n`L x`，其中 `L` 是大写字母，接着是一个空格，再接着是整数 $x$，代表在城市 $x$ 空降一位警探。你必须保证 $1\\le x\\le N$。\n\n`B x`，其中 `B` 是大写字母，接着是一个空格，再接着是整数 $x$，代表召回城市 $x$ 的一位警探。你必须保证 $1\\le x\\le N$，且你的计划执行到这一步之前，城市 $x$ 里面确实至少有一位警探。\n\n\n`M x y`，其中 `M` 是大写字母，接着是一个空格，再接着是整数 $x$，再跟一个空格，最后一个是整数 $y$。代表让城市 $x$ 的一位警探沿着公路移动到城市 $y$。你必须保证 $1\\le x,y\\le N$，且你的计划执行到这一步之前，城市 $x$ 里面确实至少有一位警探，且城市 $x,y$ 之前确实有公路。\n\n\n必须保证输出的 $S$ 确实等于追捕计划中所需要的警探数目。", "hint": "对于任何一个测试点：\n\n如果输出的追捕计划不合法，或者整个追捕计划的步骤数 $T$ 超过了 $20000$，或者追捕计划结束之后，不能保证捉住 Frank，则不能得分。\n\n否则，用你输出的 $S$ 和我们已知的标准答案 $S ^* $ 相比较：\n1. 若 $S<S ^* $，则得到 $120\\%$ 的分。\n2. 若 $S=S ^* $，则得到 $100\\%$ 的分。\n3. 若 $S ^* <S \\le S ^* +2$，则得到 $60\\%$ 的分。\n4. 若 $S ^* +2<S \\le S ^* +4$，则得到 $40\\%$ 的分。\n5. 若 $S ^* +4<S \\le S ^* +8$，则得到 $20\\%$ 的分。\n6. 若 $S>S ^* +8$，则得到 $10\\%$ 的分。\n\n输入保证描述了一棵连通的 $N$ 结点树，$1 \\le N \\le 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2007] Hunting the Thief", "background": "SPJ source: loj-Robin. Authorization obtained.\n\nhttps://www.luogu.com.cn/paste/dxytr6gc\n\nSPJ attached; some modified parts do not follow coding conventions, please excuse.", "description": "A notorious thief named Frank has recently appeared in the magical kingdom Magic Land. He commits crimes all over Magic Land, specializing in stealing confidential government documents (so some suspect Frank is a spy sent by an enemy nation).\n\nTo capture Frank, the Security Bureau of Magic Land is taking strong action!\n\nMagic Land consists of $N$ cities, and these $N$ cities are connected by exactly $N-1$ roads so that any two cities can be reached via some sequence of roads. From a data structure perspective, these $N$ cities and $N-1$ roads form a tree.\n\nFor example, the following diagram shows one possible layout of Magic Land ($4$ cities labeled with numbers, $3$ roads labeled with letters):\n\n![](https://cdn.luogu.com.cn/upload/pic/12794.png)\n\nFrank can move along roads at any speed.\n\nFor instance, in the layout above, within $0.00001$ seconds (or any arbitrarily short period of time), Frank can go from city $1$ through city $2$ to city $4$, passing along two roads.\n\nCapturing Frank alive is extremely difficult, so the Bureau has dispatched experienced detectives with exceptional pursuit skills:\n\n1. If a detective and Frank are in the same city, the detective immediately detects Frank and arrests him.\n2. Although Frank can move arbitrarily fast along roads, if a detective and Frank meet on the same road, the detective can also immediately detect Frank and arrest him.\n\nThe Bureau has no idea which city Frank is hiding in, nor on which road he might be moving, so they must devise a meticulous capture plan consisting of several steps. In each step, exactly one of the following actions can be performed:\n\n1. Airdrop a detective into some city. A detective can be airdropped directly from headquarters into any city in Magic Land. This operation is denoted as `L x`, meaning a detective is airdropped into city $x$. It takes $1$ second.\n2. Recall a detective who is staying in some city back to headquarters, to be available for later airdrop into some city. This operation is denoted as `B x`, meaning a detective in city $x$ is recalled to headquarters. It takes $1$ second.\n3. Move a detective in city $x$ along a road to city $y$. This operation is denoted as `M x y`. It takes $1$ second. Of course, this requires that there is a road between cities $x$ and $y$. If, during the detective’s move, Frank is also on the same road, then the detective will capture Frank.\n\nNow it is your turn to devise a capture plan, i.e., to output a sequence of steps, ensuring that no matter where Frank initially hides and no matter how cunningly he moves throughout the process (Frank might steal the plan, so he will try every means to evade capture), he is guaranteed to be apprehended.\n\nWe want to use as few detectives as possible, since experienced detectives are scarce.\n\nFor the layout shown earlier, one feasible plan is as follows:\n\n1. `L 2`: Airdrop a detective into city $2$. Note that after this step is completed, Frank cannot be in city $2$, otherwise he would have been captured.\n2. `L 2`: Airdrop another detective into city $2$.\n3. `M 2 1`: Move one detective from city $2$ to city $1$. Note that another detective remains in city $2$. After this step, Frank cannot be in city $1$, nor on road $A$. In other words, if Frank has not been arrested yet, he can only be in city $3$ or city $4$, or on road $B$ or road $C$.\n4. `B 1`: Recall the detective in city $1$. Note that although this detective is recalled, since we have kept a detective guarding city $2$ the whole time, Frank still cannot get to city $1$ or road $A$.\n5. `L 3`: Airdrop a detective into city $3$. Note that this step can airdrop the detective who was recalled earlier. After this step is completed, Frank cannot be in city $3$, otherwise he would be captured.\n6. `M 3 2`: Move a detective from city $3$ to city $2$. After this step, if Frank has still not been captured, then he can only be on road $C$ or in city $4$. Note that after this step there are two detectives in city $2$.\n7. `M 2 4`: Move a detective from city $2$ to city $4$. After this step, Frank is guaranteed to be captured, unless he never came to Magic Land at all.\n\nThis plan requires a total of $2$ detectives. It can be proved that if at all times only $1$ detective (or fewer) participates, Frank will escape.\n\nYour task is simple: for a given layout of Magic Land, compute $S$, the minimum number of detectives required to capture Frank, and output a corresponding capture plan.", "inputFormat": "The input file gives the layout of Magic Land.\n\nThe first line contains an integer $N$, the number of cities, numbered $1$ to $N$.\n\nThe next $N-1$ lines each contain two integers $x_i,y_i$ separated by a space, indicating that cities $x_i$ and $y_i$ are connected by a road. It is guaranteed that $1\\le x_i,y_i \\le N$.", "outputFormat": "Output your capture plan.\n\nOn the first line, output an integer $S$, the number of detectives required by your plan.\n\nOn the second line, output an integer $T$, the total number of steps in your plan.\n\nThen output $T$ lines, each describing one step of the plan. Each line must be in one of the following three forms:\n\n`L x`, where `L` is an uppercase letter, followed by a space, then an integer $x$, meaning a detective is airdropped into city $x$. You must ensure $1\\le x\\le N$.\n\n`B x`, where `B` is an uppercase letter, followed by a space, then an integer $x$, meaning a detective in city $x$ is recalled. You must ensure $1\\le x\\le N$, and that prior to this step, there is indeed at least one detective in city $x$.\n\n`M x y`, where `M` is an uppercase letter, followed by a space, then an integer $x$, followed by a space, and finally an integer $y$, meaning a detective in city $x$ moves along a road to city $y$. You must ensure $1\\le x,y\\le N$, that prior to this step there is indeed at least one detective in city $x$, and that there is a road between cities $x$ and $y$.\n\nYou must ensure that the output $S$ is exactly the number of detectives used by your plan.", "hint": "For any test point:\n\nIf the output plan is invalid, or the total number of steps $T$ exceeds $20000$, or after the plan ends Frank is not guaranteed to be captured, you will receive no points.\n\nOtherwise, compare your output $S$ with our known optimal answer $S ^* $:\n1. If $S<S ^* $, you get $120\\%$ of the points.\n2. If $S=S ^* $, you get $100\\%$ of the points.\n3. If $S ^* <S \\le S ^* +2$, you get $60\\%$ of the points.\n4. If $S ^* +2<S \\le S ^* +4$, you get $40\\%$ of the points.\n5. If $S ^* +4<S \\le S ^* +8$, you get $20\\%$ of the points.\n6. If $S>S ^* +8$, you get $10\\%$ of the points.\n\nThe input is guaranteed to describe a connected tree with $N$ nodes, $1 \\le N \\le 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2007] 追捕盗贼", "background": "SPJ 来源：loj-Robin。已获得授权。\n\nhttps://www.luogu.com.cn/paste/dxytr6gc \n\n附 SPJ，一些修改部分未按照代码规范，请各位谅解。", "description": "魔法国度 Magic Land 里最近出现了一个大盗 Frank，他在 Magic Land 四处作案，专门窃取政府机关的机密文件（因而有人怀疑 Frank 是敌国派来的间谍）。\n\n为了捉住 Frank，Magic Land 的安全局重拳出击！\n\nMagic Land 由 $N$ 个城市组成，并且这 $N$ 个城市又由恰好 $N-1$ 条公路彼此连接起来，使得任意两个城市间都可以通过若干条公路互达。从数据结构的角度我们也可以说，这 $N$ 个城市和 $N-1$ 条公路形成了一棵树。\n\n例如，下图就是 Magic Land 的一个可能格局（$4$ 个城市用数字编号，$3$ 条公路用字母编号）：\n\n ![](https://cdn.luogu.com.cn/upload/pic/12794.png) \n\n大盗 Frank 能够在公路上以任意速度移动。\n\n比方说，对于上图给出的格局，在 $0.00001$ 秒钟内（或者任意短的一段时间内），Frank 就可以从城市 $1$ 经过城市 $2$ 到达城市 $4$，中间经过了两条公路。\n\n想要生擒 Frank 困难重重，所以安全局派出了经验丰富的警探，这些警探具有非凡的追捕才能：\n\n1.  只要有警探和 Frank 同处一个城市，那么就能够立刻察觉到 Frank，并且将其逮捕。\n2.  虽然 Frank 可以在公路上以任意快的速度移动，但是如果有警探和 Frank 在同一条公路上相遇，那么警探也可以立刻察觉到 Frank 并将其逮捕。\n\n安全局完全不知道 Frank 躲在哪个城市，或者正在哪条公路上移动，所以需要制定一个周密的抓捕计划，计划由若干步骤组成。在每一步中，可以做如下几件事中的一个：\n\n1.  在某个城市空降一位警探。警探可以直接从指挥部空降到 Magic Land 的任意一个城市里。此操作记为 `L x`，表示在编号为 $x$ 的城市里空降一位警探。耗时 $1$ 秒。\n2.  把留在某个城市里的一位警探直接召回指挥部。以备在以后的步骤中再度空降到某个城市里。此操作记为 `B x`。表示把编号为 $x$ 的城市里的一位警探召回指挥部。耗时 $1$ 秒。\n3.  让待在城市 $x$ 的一位警探沿着公路移动到城市 $y$，此操作记为 `M x y`。耗时 $1$ 秒。当然，前提是城市 $x$ 和城市 $y$ 之间有公路。如果在警探移动的过程中，大盗 Frank 也在同一条公路上，那么警探就抓捕到了Frank。\n\n现在，由你来制定一套追捕计划，也就是给出若干个步骤，需要保证：无论大盗 Frank 一开始躲在哪儿，也无论 Frank 在整个过程中如何狡猾地移动（Frank 大盗可能会窃取到追捕行动的计划书，所以他一定会想尽办法逃避），他一定会被缉拿归案。\n\n希望参与的警探越少越好，因为经验丰富的警探毕竟不多。\n\n例如对于前面所给的那个图示格局，一个可行的计划如下：\n\n1.  `L 2`：在城市 $2$ 空降一位警探。注意这一步完成之后，城市 $2$ 里不会有 Frank，否则他将被捉住。\n2.  `L 2`：再在城市 $2$ 空降一位警探。\n3.  `M 2 1`：让城市 $2$ 的一位警探移动到城市 $1$。注意城市 $2$ 里还留有另一位警探。这一步完成之后，城市 $1$ 里不会有 Frank，公路 $A$ 上也不会有 Frank。也就是说，假如 Frank 还没有被逮捕，那么他只能是在城市 $3$ 或城市 $4$ 里，或者公路 $B$ 或公路 $C$ 上。\n4.  `B 1`：召回城市 $1$ 的一位警探。注意虽然召回了这位警探，但是由于我们始终留了一位警探在城市 $2$ 把守，所以 Frank 仍然不可能跑到城市 $1$ 或者是公路 $A$ 上。\n5.  `L 3`：在城市 $3$ 空降一位警探。注意这一步可以空降在此之前被召回的那位警探。这一步完成之后，城市 $3$ 里不会有 Frank，否则他会被捉住。\n6.  `M 3 2`：让城市 $3$ 里的一位警探移动到城市 $2$。这一步完成之后，如果 Frank 还没有被捉住，那他只能是在公路 $C$ 上或者城市 $4$ 里。注意这一步之后，城市 $2$ 里有两位警探。\n7.  `M 2 4` 让城市 $2$ 里的一位警探移动到城市 $4$。这一步完成之后，Frank 一定会被捉住，除非他根本就没来 Magic Land。\n\n这个计划总共需要 $2$ 位警探的参与。可以证明：如果自始至终只有 $1$ 名或者更少的警探参与，则 Frank 就会逍遥法外。\n\n你的任务很简单：对于一个输入的 Magic Land 的格局，计算 $S$，也就是为了追捕 Frank 至少需要投入多少位警探，并且给出相应的追捕计划步骤。", "inputFormat": "输入文件给出了 Magic Land 的格局。\n\n第一行一个整数 $N$，代表有 $N$ 个城市，城市的编号是 $1\\sim N$。\n\n接下来 $N-1$ 行，每行有两个用空格分开的整数 $x_i,y_i$，代表城市 $x_i,y_i$ 之间有公路相连。保证 $1\\le x_i,y_i \\le N$。", "outputFormat": "向输出文件输出你所给出的追捕计划。\n\n第一行请输出一个整数 $S$，代表追捕计划需要多少位警探。\n\n第二行请输出一个整数 $T$，代表追捕计划总共有多少步。\n\n接下来请输出 $T$ 行，依次描述了追捕计划的每一步。每行必须是以下三种形式之一：\n\n\n`L x`，其中 `L` 是大写字母，接着是一个空格，再接着是整数 $x$，代表在城市 $x$ 空降一位警探。你必须保证 $1\\le x\\le N$。\n\n`B x`，其中 `B` 是大写字母，接着是一个空格，再接着是整数 $x$，代表召回城市 $x$ 的一位警探。你必须保证 $1\\le x\\le N$，且你的计划执行到这一步之前，城市 $x$ 里面确实至少有一位警探。\n\n\n`M x y`，其中 `M` 是大写字母，接着是一个空格，再接着是整数 $x$，再跟一个空格，最后一个是整数 $y$。代表让城市 $x$ 的一位警探沿着公路移动到城市 $y$。你必须保证 $1\\le x,y\\le N$，且你的计划执行到这一步之前，城市 $x$ 里面确实至少有一位警探，且城市 $x,y$ 之前确实有公路。\n\n\n必须保证输出的 $S$ 确实等于追捕计划中所需要的警探数目。", "hint": "对于任何一个测试点：\n\n如果输出的追捕计划不合法，或者整个追捕计划的步骤数 $T$ 超过了 $20000$，或者追捕计划结束之后，不能保证捉住 Frank，则不能得分。\n\n否则，用你输出的 $S$ 和我们已知的标准答案 $S ^* $ 相比较：\n1. 若 $S<S ^* $，则得到 $120\\%$ 的分。\n2. 若 $S=S ^* $，则得到 $100\\%$ 的分。\n3. 若 $S ^* <S \\le S ^* +2$，则得到 $60\\%$ 的分。\n4. 若 $S ^* +2<S \\le S ^* +4$，则得到 $40\\%$ 的分。\n5. 若 $S ^* +4<S \\le S ^* +8$，则得到 $20\\%$ 的分。\n6. 若 $S>S ^* +8$，则得到 $10\\%$ 的分。\n\n输入保证描述了一棵连通的 $N$ 结点树，$1 \\le N \\le 1000$。", "locale": "zh-CN"}}}
{"pid": "P2893", "type": "P", "difficulty": 5, "samples": [["7\n1\n3\n2\n4\n5\n3\n9\n", "3\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "递推", "2008", "USACO", "O2优化", "斜率维护技巧 slope trick"], "title": "[USACO08FEB] Making the Grade G", "background": null, "description": "农夫约翰想改造一条长度为 $N$ 的路，原来的路的每一段海拔是 $A_i$，修理后是 $B_i$，花费 $|A_i - B_i|$。我们要求修好的路，即你构造的 $B_i$，是单调不升或者单调不降的。求最小花费 $\\sum_{i=1}^{N} |A_i - B_i|$。", "inputFormat": "第一行包含一个整数 $N$。\n\n接下来 $N$ 行，每行包含一个整数 $A_i$。", "outputFormat": "一行一个整数，表示最小花费。", "hint": "数据范围为 $1\\le N\\le 2000, 0\\le A_i\\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO08FEB] Making the Grade G", "background": "", "description": "Farmer John wants to renovate a road of length $N$. The original elevation of each segment is $A_i$, and after repair it becomes $B_i$, with a cost of $|A_i - B_i|$. We require the repaired road, that is, the sequence $B_i$ you construct, to be monotone nonincreasing or monotone nondecreasing. Find the minimum total cost $\\sum_{i=1}^{N} |A_i - B_i|$.", "inputFormat": "The first line contains an integer $N$.\n\nThe next $N$ lines each contain an integer $A_i$.", "outputFormat": "Output a single integer, the minimum cost.", "hint": "Constraints: $1 \\le N \\le 2000$, $0 \\le A_i \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO08FEB] Making the Grade G", "background": null, "description": "农夫约翰想改造一条长度为 $N$ 的路，原来的路的每一段海拔是 $A_i$，修理后是 $B_i$，花费 $|A_i - B_i|$。我们要求修好的路，即你构造的 $B_i$，是单调不升或者单调不降的。求最小花费 $\\sum_{i=1}^{N} |A_i - B_i|$。", "inputFormat": "第一行包含一个整数 $N$。\n\n接下来 $N$ 行，每行包含一个整数 $A_i$。", "outputFormat": "一行一个整数，表示最小花费。", "hint": "数据范围为 $1\\le N\\le 2000, 0\\le A_i\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P2894", "type": "P", "difficulty": 5, "samples": [["10 6\n1 3\n1 3\n1 3\n1 3\n2 5 5\n1 6\n", "1\n4\n7\n0\n5\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2008", "线段树", "USACO", "栈"], "title": "[USACO08FEB] Hotel G", "background": "", "description": "对一家有 $n$ 个房间（编号为 $1 \\sim n$，开始都为空房）的宾馆维护以下操作：\n\n- 查询房间：你需要在 $1,2,\\ldots,n$ 房间中找到长度为 $x$ 的连续空房。若找得到，在这 $x$ 个空房间中住上人。\n- 退房：房间号 $x \\sim x+y-1$ 退房，即让房间为空。", "inputFormat": "第一行输入 $n,m$，$n$ 代表有 $n$ 个房间 $(1\\leq n \\leq 50,000)$，编号为 $1 \\sim n$，开始都为空房，$m$ 表示以下有 $m$ 行操作 $(1\\leq m \\leq 50,000)$，以下每行先输入一个数 $i$，表示一种操作：\n\n若 $i$ 为 $1$，表示查询房间，再输入一个数 $x$。\n\n若 $i$ 为 $2$，表示退房，再输入两个数 $x,y$。", "outputFormat": "对每个输入 $1$，输出连续 $x$ 个房间中左端的房间号，尽量让这个房间号最小，若找不到长度为 $x$ 的连续空房，输出 $0$。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[USACO08FEB] Hotel G", "background": null, "description": "The cows are journeying north to Thunder Bay in Canada to gain cultural enrichment and enjoy a vacation on the sunny shores of Lake Superior. Bessie, ever the competent travel agent, has named the Bullmoose Hotel on famed Cumberland Street as their vacation residence. This immense hotel has N (1 ≤ N ≤ 50,000) rooms all located on the same side of an extremely long hallway (all the better to see the lake, of course).\n\nThe cows and other visitors arrive in groups of size Di (1 ≤ Di ≤ N) and approach the front desk to check in. Each group i requests a set of Di contiguous rooms from Canmuu, the moose staffing the counter. He assigns them some set of consecutive room numbers r..r+Di-1 if they are available or, if no contiguous set of rooms is available, politely suggests alternate lodging. Canmuu always chooses the value of r to be the smallest possible.\n\nVisitors also depart the hotel from groups of contiguous rooms. Checkout i has the parameters Xi and Di which specify the vacating of rooms Xi ..Xi +Di-1 (1 ≤ Xi ≤ N-Di+1). Some (or all) of those rooms might be empty before the checkout.\n\nYour job is to assist Canmuu by processing M (1 ≤ M < 50,000) checkin/checkout requests. The hotel is initially unoccupied.", "inputFormat": "* Line 1: Two space-separated integers: N and M\n\n* Lines 2..M+1: Line i+1 contains request expressed as one of two possible formats: (a) Two space separated integers representing a check-in request: 1 and Di (b) Three space-separated integers representing a check-out: 2, Xi, and Di", "outputFormat": "* Lines 1.....: For each check-in request, output a single line with a single integer r, the first room in the contiguous sequence of rooms to be occupied. If the request cannot be satisfied, output 0.", "hint": null, "locale": "en"}, "zh-CN": {"title": "[USACO08FEB] Hotel G", "background": "", "description": "对一家有 $n$ 个房间（编号为 $1 \\sim n$，开始都为空房）的宾馆维护以下操作：\n\n- 查询房间：你需要在 $1,2,\\ldots,n$ 房间中找到长度为 $x$ 的连续空房。若找得到，在这 $x$ 个空房间中住上人。\n- 退房：房间号 $x \\sim x+y-1$ 退房，即让房间为空。", "inputFormat": "第一行输入 $n,m$，$n$ 代表有 $n$ 个房间 $(1\\leq n \\leq 50,000)$，编号为 $1 \\sim n$，开始都为空房，$m$ 表示以下有 $m$ 行操作 $(1\\leq m \\leq 50,000)$，以下每行先输入一个数 $i$，表示一种操作：\n\n若 $i$ 为 $1$，表示查询房间，再输入一个数 $x$。\n\n若 $i$ 为 $2$，表示退房，再输入两个数 $x,y$。", "outputFormat": "对每个输入 $1$，输出连续 $x$ 个房间中左端的房间号，尽量让这个房间号最小，若找不到长度为 $x$ 的连续空房，输出 $0$。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P2895", "type": "P", "difficulty": 3, "samples": [["4\n0 0 2\n2 1 2\n1 1 2\n0 3 5\n", "5\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2008", "USACO", "广度优先搜索 BFS"], "title": "[USACO08FEB] Meteor Shower S", "background": "", "description": "Bessie hears that an extraordinary meteor shower is coming; reports say that these meteors will crash into earth and destroy anything they hit. Anxious for her safety, she vows to find her way to a safe location (one that is never destroyed by a meteor) . She is currently grazing at the origin in the coordinate plane and wants to move to a new, safer location while avoiding being destroyed by meteors along her way.\n\nThe reports say that M meteors (1 ≤ M ≤ 50,000) will strike, with meteor i will striking point (Xi, Yi) (0 ≤ Xi ≤ 300; 0 ≤ Yi ≤ 300) at time Ti (0 ≤ Ti  ≤ 1,000). Each meteor destroys the point that it strikes and also the four rectilinearly adjacent lattice points.\n\nBessie leaves the origin at time 0 and can travel in the first quadrant and parallel to the axes at the rate of one distance unit per second to any of the (often 4) adjacent rectilinear points that are not yet destroyed by a meteor. She cannot be located on a point at any time greater than or equal to the time it is destroyed).\n\nDetermine the minimum time it takes Bessie to get to a safe place.\n", "inputFormat": "\\* Line 1: A single integer: M\n\n\\* Lines 2..M+1: Line i+1 contains three space-separated integers: Xi, Yi, and Ti\n", "outputFormat": "\\* Line 1: The minimum time it takes Bessie to get to a safe place or -1 if it is impossible.\n", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO08FEB] Meteor Shower S", "background": "", "description": "Bessie hears that an extraordinary meteor shower is coming; reports say that these meteors will crash into earth and destroy anything they hit. Anxious for her safety, she vows to find her way to a safe location (one that is never destroyed by a meteor) . She is currently grazing at the origin in the coordinate plane and wants to move to a new, safer location while avoiding being destroyed by meteors along her way.\n\nThe reports say that M meteors (1 ≤ M ≤ 50,000) will strike, with meteor i will striking point (Xi, Yi) (0 ≤ Xi ≤ 300; 0 ≤ Yi ≤ 300) at time Ti (0 ≤ Ti  ≤ 1,000). Each meteor destroys the point that it strikes and also the four rectilinearly adjacent lattice points.\n\nBessie leaves the origin at time 0 and can travel in the first quadrant and parallel to the axes at the rate of one distance unit per second to any of the (often 4) adjacent rectilinear points that are not yet destroyed by a meteor. She cannot be located on a point at any time greater than or equal to the time it is destroyed).\n\nDetermine the minimum time it takes Bessie to get to a safe place.\n", "inputFormat": "\\* Line 1: A single integer: M\n\n\\* Lines 2..M+1: Line i+1 contains three space-separated integers: Xi, Yi, and Ti\n", "outputFormat": "\\* Line 1: The minimum time it takes Bessie to get to a safe place or -1 if it is impossible.\n", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO08FEB] Meteor Shower S", "background": "", "description": "贝茜听说一场特别的流星雨即将到来：这些流星会撞向地球，并摧毁它们所撞击的任何东西。她为自己的安全感到焦虑，发誓要找到一个安全的地方（一个永远不会被流星摧毁的地方）。\n\n如果将牧场放入一个直角坐标系中，贝茜现在的位置是原点，并且，贝茜不能踏上一块被流星砸过的土地。\n\n根据预报，一共有 $M$ 颗流星 $(1\\leq M\\leq 50,000)$ 会坠落在农场上，其中第 $i$ 颗流星会在时刻 $T_i$（$0 \\leq T _ i \\leq 1000$）砸在坐标为 $(X_i,Y_i)(0\\leq X_i\\leq 300$，$0\\leq Y_i\\leq 300)$ 的格子里。流星的力量会将它所在的格子，以及周围 $4$ 个相邻的格子都化为焦土，当然贝茜也无法再在这些格子上行走。\n\n贝茜在时刻 $0$ 开始行动，她只能在会在横纵坐标 $X,Y\\ge 0$ 的区域中，平行于坐标轴行动，每 $1$ 个时刻中，她能移动到相邻的（一般是 $4$ 个）格子中的任意一个，当然目标格子要没有被烧焦才行。如果一个格子在时刻 $t$ 被流星撞击或烧焦，那么贝茜只能在 $t$ 之前的时刻在这个格子里出现。 贝茜一开始在 $(0,0)$。\n\n请你计算一下，贝茜最少需要多少时间才能到达一个安全的格子。如果不可能到达输出 $−1$。", "inputFormat": "共 $M+1$ 行，第 $1$ 行输入一个整数 $M$，接下来的 $M$ 行每行输入三个整数分别为 $X_i, Y_i, T_i$。", "outputFormat": "贝茜到达安全地点所需的最短时间，如果不可能，则为 $-1$。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P2896", "type": "P", "difficulty": 3, "samples": [["5\n1\n3\n2\n1\n1\n", "1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "递推", "2008", "USACO", "队列"], "title": "[USACO08FEB] Eating Together S", "background": null, "description": "FJ 的奶牛们在吃晚饭时很傻。他们把自己组织成三组（为了方便，将它们编号为 $1,2,3$），坚持一起用餐。当他们在谷仓排队进入喂食区时，麻烦就开始了。\n\n每头奶牛都随身带着一张小卡片，小卡片上刻的是 $D_i$（$1\\le D_i\\le 3$）表示她属于哪一组。所有的 $N$（$1\\le N\\le 30000$）头奶牛排队吃饭，但他们并不能按卡片上的分组站好。\n\n\nFJ 的工作并不是那么难。他只是沿着牛的路线走下去，把旧的号码标出来，换上一个新的。通过这样做，他使奶牛的就餐组按他们的晚餐卡片按升序或降序排列，比如 `111222333` 或 `333222111`。\n\n\nFJ 和其他人一样懒惰。他很好奇：怎样他才能进行适当的分组，使得他只要修改最少次数的数字？由于奶牛们已经很长时间没有吃到饭了，所以“哞哞”的声音到处都是，FJ 只能更换卡号，而不能重新排列已经排好队的奶牛。", "inputFormat": "- 第 $1$ 行：一个整数：$n$\n- 第 $2\\sim n+1$ 行：第 $i+1$ 行描述第 $i$ 个奶牛目前的分组", "outputFormat": "一个整数，表示必须做出的最小变化数，使得奶牛的就餐组按他们的晚餐卡片按升序或降序排列。", "hint": "感谢@一思千年 提供翻译", "locale": "zh-CN", "translations": {"en": {"title": "[USACO08FEB] Eating Together S", "background": null, "description": "The cows are so very silly about their dinner partners. They have organized themselves into three groups (conveniently numbered 1, 2, and 3) that insist upon dining together. The trouble starts when they line up at the barn to enter the feeding area.\n\nEach cow i carries with her a small card upon which is engraved Di (1 ≤ Di ≤ 3) indicating her dining group membership. The entire set of N (1 ≤ N ≤ 30,000) cows has lined up for dinner but it's easy for anyone to see that they are not grouped by their dinner-partner cards.\n\nFJ's job is not so difficult. He just walks down the line of cows changing their dinner partner assignment by marking out the old number and writing in a new one. By doing so, he creates groups of cows like 111222333 or 333222111 where the cows' dining groups are sorted in either ascending or descending order by their dinner cards.\n\nFJ is just as lazy as the next fellow. He's curious: what is the absolute mminimum number of cards he must change to create a proper grouping of dining partners? He must only change card numbers and must not rearrange the cows standing in line.", "inputFormat": "* Line 1: A single integer: N\n\n* Lines 2..N+1: Line i describes the i-th cow's current dining group with a single integer: Di", "outputFormat": "* Line 1: A single integer representing the minimum number of changes that must be made so that the final sequence of cows is sorted in either ascending or descending order", "hint": null, "locale": "en"}, "zh-CN": {"title": "[USACO08FEB] Eating Together S", "background": null, "description": "FJ 的奶牛们在吃晚饭时很傻。他们把自己组织成三组（为了方便，将它们编号为 $1,2,3$），坚持一起用餐。当他们在谷仓排队进入喂食区时，麻烦就开始了。\n\n每头奶牛都随身带着一张小卡片，小卡片上刻的是 $D_i$（$1\\le D_i\\le 3$）表示她属于哪一组。所有的 $N$（$1\\le N\\le 30000$）头奶牛排队吃饭，但他们并不能按卡片上的分组站好。\n\n\nFJ 的工作并不是那么难。他只是沿着牛的路线走下去，把旧的号码标出来，换上一个新的。通过这样做，他使奶牛的就餐组按他们的晚餐卡片按升序或降序排列，比如 `111222333` 或 `333222111`。\n\n\nFJ 和其他人一样懒惰。他很好奇：怎样他才能进行适当的分组，使得他只要修改最少次数的数字？由于奶牛们已经很长时间没有吃到饭了，所以“哞哞”的声音到处都是，FJ 只能更换卡号，而不能重新排列已经排好队的奶牛。", "inputFormat": "- 第 $1$ 行：一个整数：$n$\n- 第 $2\\sim n+1$ 行：第 $i+1$ 行描述第 $i$ 个奶牛目前的分组", "outputFormat": "一个整数，表示必须做出的最小变化数，使得奶牛的就餐组按他们的晚餐卡片按升序或降序排列。", "hint": "感谢@一思千年 提供翻译", "locale": "zh-CN"}}}
{"pid": "P2897", "type": "P", "difficulty": 5, "samples": [["3\n4 2\n2 7\n6 4", "4\n50\n26"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2008", "USACO", "栈"], "title": "[USACO08JAN] Artificial Lake G", "background": "USACO 2008 January Gold", "description": "夏日那让人喘不过气的酷热将奶牛们的烦躁情绪推到了最高点。最终，FJ 决定建一个人工湖供奶牛消暑之用。为了使湖看起来更加真实，FJ 决定将湖的横截面建成 $N(1\\le N\\le 100,000)$ 个连续的平台高低错落的组合状，所有的平台从左到右按 $1\\sim N$ 依次编号。当然咯，在湖中注入水后，这些平台都将被淹没。平台 $i$ 在设计图上用它的宽度 $W_i(1\\le W_i\\le1,000)$ 和高度（你可以理解为该平台顶离 FJ 挖的地基的高度）$H_i(1\\le H_i\\le 1,000,000)$ 来描述的。所有平台的高度都是独一无二的。湖的边缘可以视为无限高的平台。下面给出了一张 FJ 的设计图：\n          \n```plain\n         *             *  :\n         *             *  :\n         *             *  8\n         *    ***      *  7\n         *    ***      *  6\n         *    ***      *  5\n         *    **********  4 <- height\n         *    **********  3\n         ***************  2\n         ***************  1\nLevel    |  1 |2|  3   |\n```\n\n按 FJ 的设想，在坑挖好后，他会以 $1$ 单位每分钟的速度往最低的那个平台上注水。水在离开水管后立即下落，直到撞到平台顶或是更早些时候注入的水。然后，与所有常温下的水一样，它会迅速地流动、扩散。简单起见，你可以认为这些都是在瞬间完成的。FJ 想知道，对于每一个平台，它的顶部是从哪个时刻开始，与水面的距离至少为 $1$ 单位长度。\n\n\n```plain\nWATER              WATER OVERFLOWS                     \n       |                       |                           \n     * |          *      *     |      *      *            *\n     * V          *      *     V      *      *            *\n     *            *      *    ....    *      *~~~~~~~~~~~~*\n     *    **      *      *~~~~** :    *      *~~~~**~~~~~~*\n     *    **      *      *~~~~** :    *      *~~~~**~~~~~~*\n     *    **      *      *~~~~**~~~~~~*      *~~~~**~~~~~~*\n     *    *********      *~~~~*********      *~~~~*********\n     *~~~~*********      *~~~~*********      *~~~~*********\n     **************      **************      **************\n     **************      **************      **************\n     After 4 mins        After 26 mins       After 50 mins\n\n     Lvl 1 submerged     Lvl 3 submerged     Lvl 2 submerged\n```", "inputFormat": "第一行一个正整数 $N$。\n\n下面 $N$ 行，每行两个正整数 $W_i,H_i$。", "outputFormat": "$N$ 行，每行一个正整数，表示：对于每一个平台，它的顶部是从哪个时刻开始，与水面的距离至少为 $1$ 单位长度。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "[USACO08JAN] Artificial Lake G", "background": null, "description": "The oppressively hot summer days have raised the cows' clamoring to its highest level. Farmer John has finally decided to build an artificial lake. For his engineering studies, he is modeling the lake as a two-dimensional landscape consisting of a contiguous sequence of N soon-to-be-submerged levels (1 ≤ N ≤ 100,000) conveniently numbered 1..N from left to right.\n\nEach level i is described by two integers, its width Wi (1 ≤ Wi ≤ 1,000) and height (like a relative elevation) Hi (1 ≤ Hi ≤ 1,000,000). The heights of FJ's levels are unique. An infinitely tall barrier encloses the lake's model on the left and right. One example lake profile is shown below.\n\n```plain\n         *             *  :\n         *             *  :\n         *             *  8\n         *    ***      *  7\n         *    ***      *  6\n         *    ***      *  5\n         *    **********  4 <- height\n         *    **********  3\n         ***************  2\n         ***************  1\nLevel    |  1 |2|  3   |\n```\n\nIn FJ's model, he starts filling his lake at sunrise by flowing water into the bottom of the lowest elevation at a rate of 1 square unit of water per minute. The water falls directly downward until it hits something, and then it flows and spreads as room-temperature water always does. As in all good models, assume that falling and flowing happen instantly. Determine the time at which each elevation's becomes submerged by a single unit of water.\n\n```plain\nWATER              WATER OVERFLOWS                     \n       |                       |                           \n     * |          *      *     |      *      *            *\n     * V          *      *     V      *      *            *\n     *            *      *    ....    *      *~~~~~~~~~~~~*\n     *    **      *      *~~~~** :    *      *~~~~**~~~~~~*\n     *    **      *      *~~~~** :    *      *~~~~**~~~~~~*\n     *    **      *      *~~~~**~~~~~~*      *~~~~**~~~~~~*\n     *    *********      *~~~~*********      *~~~~*********\n     *~~~~*********      *~~~~*********      *~~~~*********\n     **************      **************      **************\n     **************      **************      **************\n     After 4 mins        After 26 mins       After 50 mins\n\n     Lvl 1 submerged     Lvl 3 submerged     Lvl 2 submerged\n```\n\nWarning: The answer will not always fit in 32 bits.", "inputFormat": "* Line 1: A single integer: N\n\n* Lines 2..N+1: Line i+1 describes level i with two space-separated integers: Wi and Hi", "outputFormat": "Lines 1..N: Line i contains a single integer that is the number of minutes that since sunrise when level #i is covered by water of height 1.", "hint": null, "locale": "en"}, "zh-CN": {"title": "[USACO08JAN] Artificial Lake G", "background": "USACO 2008 January Gold", "description": "夏日那让人喘不过气的酷热将奶牛们的烦躁情绪推到了最高点。最终，FJ 决定建一个人工湖供奶牛消暑之用。为了使湖看起来更加真实，FJ 决定将湖的横截面建成 $N(1\\le N\\le 100,000)$ 个连续的平台高低错落的组合状，所有的平台从左到右按 $1\\sim N$ 依次编号。当然咯，在湖中注入水后，这些平台都将被淹没。平台 $i$ 在设计图上用它的宽度 $W_i(1\\le W_i\\le1,000)$ 和高度（你可以理解为该平台顶离 FJ 挖的地基的高度）$H_i(1\\le H_i\\le 1,000,000)$ 来描述的。所有平台的高度都是独一无二的。湖的边缘可以视为无限高的平台。下面给出了一张 FJ 的设计图：\n          \n```plain\n         *             *  :\n         *             *  :\n         *             *  8\n         *    ***      *  7\n         *    ***      *  6\n         *    ***      *  5\n         *    **********  4 <- height\n         *    **********  3\n         ***************  2\n         ***************  1\nLevel    |  1 |2|  3   |\n```\n\n按 FJ 的设想，在坑挖好后，他会以 $1$ 单位每分钟的速度往最低的那个平台上注水。水在离开水管后立即下落，直到撞到平台顶或是更早些时候注入的水。然后，与所有常温下的水一样，它会迅速地流动、扩散。简单起见，你可以认为这些都是在瞬间完成的。FJ 想知道，对于每一个平台，它的顶部是从哪个时刻开始，与水面的距离至少为 $1$ 单位长度。\n\n\n```plain\nWATER              WATER OVERFLOWS                     \n       |                       |                           \n     * |          *      *     |      *      *            *\n     * V          *      *     V      *      *            *\n     *            *      *    ....    *      *~~~~~~~~~~~~*\n     *    **      *      *~~~~** :    *      *~~~~**~~~~~~*\n     *    **      *      *~~~~** :    *      *~~~~**~~~~~~*\n     *    **      *      *~~~~**~~~~~~*      *~~~~**~~~~~~*\n     *    *********      *~~~~*********      *~~~~*********\n     *~~~~*********      *~~~~*********      *~~~~*********\n     **************      **************      **************\n     **************      **************      **************\n     After 4 mins        After 26 mins       After 50 mins\n\n     Lvl 1 submerged     Lvl 3 submerged     Lvl 2 submerged\n```", "inputFormat": "第一行一个正整数 $N$。\n\n下面 $N$ 行，每行两个正整数 $W_i,H_i$。", "outputFormat": "$N$ 行，每行一个正整数，表示：对于每一个平台，它的顶部是从哪个时刻开始，与水面的距离至少为 $1$ 单位长度。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P2898", "type": "P", "difficulty": 5, "samples": [["20 4\n1 10 7\n5 19 7\n3 12 8\n11 15 12\n", "3\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2008", "线段树", "二分", "USACO", "并查集"], "title": "[USACO08JAN] Haybale Guessing G", "background": "", "description": "The cows, who always have an inferiority complex about their intelligence, have a new guessing game to sharpen their brains.\n\nA designated 'Hay Cow' hides behind the barn and creates N (1 ≤ N ≤ 1,000,000) uniquely-sized stacks (conveniently numbered 1..N) of hay bales, each with 1..1,000,000,000 bales of hay.\n\nThe other cows then ask the Hay Cow a series of Q (1 ≤ Q ≤ 25,000) questions about the the stacks, all having the same form:\n\nWhat is the smallest number of bales of any stack in the range of stack numbers Ql..Qh (1 ≤ Ql ≤ N; Ql ≤ Qh ≤ N)?The Hay Cow answers each of these queries with a single integer A whose truthfulness is not guaranteed.\n\nHelp the other cows determine if the answers given by the Hay Cow are self-consistent or if certain answers contradict others.\n\n", "inputFormat": "\\* Line 1: Two space-separated integers: N and Q\n\n\\* Lines 2..Q+1: Each line contains three space-separated integers that represent a single query and its reply: Ql, Qh, and A\n", "outputFormat": "\\* Line 1: Print the single integer 0 if there are no inconsistencies among the replies (i.e., if there exists a valid realization of the hay stacks that agrees with all Q queries). Otherwise, print the index from 1..Q of the earliest query whose answer is inconsistent with the answers to the queries before it.\n", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO08JAN] Haybale Guessing G", "background": "", "description": "The cows, who always have an inferiority complex about their intelligence, have a new guessing game to sharpen their brains.\n\nA designated 'Hay Cow' hides behind the barn and creates N (1 ≤ N ≤ 1,000,000) uniquely-sized stacks (conveniently numbered 1..N) of hay bales, each with 1..1,000,000,000 bales of hay.\n\nThe other cows then ask the Hay Cow a series of Q (1 ≤ Q ≤ 25,000) questions about the the stacks, all having the same form:\n\nWhat is the smallest number of bales of any stack in the range of stack numbers Ql..Qh (1 ≤ Ql ≤ N; Ql ≤ Qh ≤ N)?The Hay Cow answers each of these queries with a single integer A whose truthfulness is not guaranteed.\n\nHelp the other cows determine if the answers given by the Hay Cow are self-consistent or if certain answers contradict others.\n\n", "inputFormat": "\\* Line 1: Two space-separated integers: N and Q\n\n\\* Lines 2..Q+1: Each line contains three space-separated integers that represent a single query and its reply: Ql, Qh, and A\n", "outputFormat": "\\* Line 1: Print the single integer 0 if there are no inconsistencies among the replies (i.e., if there exists a valid realization of the hay stacks that agrees with all Q queries). Otherwise, print the index from 1..Q of the earliest query whose answer is inconsistent with the answers to the queries before it.\n", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO08JAN] Haybale Guessing G", "background": null, "description": "给一个长度为 $n$ 的数组 $q$ 个条件，数组中的数字互不相同，每个条件格式形如  $l_i,r_i,x_i$ 表示这个数组的区间 $[l_i,r_i]$ 内的最小值为 $x_i$，输出最早与前面的条件有矛盾的条件的编号，如果所有条件都不发生矛盾，输出 $0$。", "inputFormat": "第一行两个整数，分别是  $n$ 和  $q$。\n\n第二行至第 $q+1$ 行，每行三个整 $l_i,r_i,x_i$ 描述一个条件。", "outputFormat": "仅一个整数，表示最早发生矛盾的条件的编号。如果所有条件都没有发生矛盾，输出 $0$。", "hint": "对于 $100\\%$ 的数据，保证：\n  - $1 \\le q \\le 25000$\n  - $1 \\le n \\le 10^6$\n  - $1 \\le l_i \\le r_i \\le n$\n  - $1 \\le x_i \\le 10^9$", "locale": "zh-CN"}}}
{"pid": "P2899", "type": "P", "difficulty": 3, "samples": [["5\n1 3\n5 2\n4 3\n3 5\n", "2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2008", "USACO", "排序", "树形 DP", "拓扑排序"], "title": "[USACO08JAN] Cell Phone Network G", "background": null, "description": "Farmer John 想让他的所有牛用上手机以便相互交流。他需要建立几座信号塔在 $N$ 块草地中。已知与信号塔相邻的草地和信号塔所在的草地均能收到信号。给你 $N-1$ 个草地 $(A,B)$ 的相邻关系，问：最少需要建多少个信号塔能实现所有草地都有信号。", "inputFormat": "第 $1$ 行：一个整数 $N$。\n\n第 $2$ 行到第 $N$ 行：每一行两个整数，用空格分隔，给出一对相邻的草地 $A$ 和 $B$。", "outputFormat": "一个整数，表示要安装的最少信号塔数。", "hint": "对于所有的数据，$1 \\leq N \\leq 10^4$，$1 \\leq A,B \\leq N$，$A \\neq B$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO08JAN] Cell Phone Network G", "background": "", "description": "Farmer John wants all his cows to use cell phones so that they can communicate. He needs to build several cell towers among $N$ pastures. A tower provides coverage to the pasture it is placed on and to any pasture adjacent to it. You are given $N-1$ adjacency pairs $(A, B)$ between pastures. What is the minimum number of towers required so that every pasture has coverage?", "inputFormat": "Line 1: an integer $N$.\n\nLines 2 through $N$: each line contains two integers separated by a space, giving one adjacent pair of pastures $A$ and $B$.", "outputFormat": "A single integer, the minimum number of towers to install.", "hint": "For all testdata, $1 \\leq N \\leq 10^4$, $1 \\leq A, B \\leq N$, $A \\neq B$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO08JAN] Cell Phone Network G", "background": null, "description": "Farmer John 想让他的所有牛用上手机以便相互交流。他需要建立几座信号塔在 $N$ 块草地中。已知与信号塔相邻的草地和信号塔所在的草地均能收到信号。给你 $N-1$ 个草地 $(A,B)$ 的相邻关系，问：最少需要建多少个信号塔能实现所有草地都有信号。", "inputFormat": "第 $1$ 行：一个整数 $N$。\n\n第 $2$ 行到第 $N$ 行：每一行两个整数，用空格分隔，给出一对相邻的草地 $A$ 和 $B$。", "outputFormat": "一个整数，表示要安装的最少信号塔数。", "hint": "对于所有的数据，$1 \\leq N \\leq 10^4$，$1 \\leq A,B \\leq N$，$A \\neq B$。", "locale": "zh-CN"}}}
{"pid": "P2900", "type": "P", "difficulty": 6, "samples": [["4 \n100 1 \n15 15 \n20 5 \n1 100 \n", "500 \n"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "2008", "USACO", "斜率优化"], "title": "[USACO08MAR] Land Acquisition G", "background": "", "description": "Farmer John 准备扩大他的农场，眼前他正在考虑购买 $N$ 块长方形的土地。\n\n如果 FJ 单买一块土地，价格就是土地的面积。但他可以选择并购一组土地，并购的价格为这些土地中最大的长乘以最大的宽。比如 FJ 并购一块 $3 \\times 5$ 和一块 $5 \\times 3$ 的土地，他只需要支付 $5 \\times 5=25$ 元， 比单买合算。\n\nFJ 希望买下所有的土地。他发现，将这些土地分成不同的小组来并购可以节省经费。 给定每份土地的尺寸，请你帮助他计算购买所有土地所需的最小费用。", "inputFormat": "第一行一个整数 $N$（$1 \\leq N \\leq 5 \\times 10^4$）。\n\n接下来 $N$ 行，每行两个整数 $w_i$ 和 $l_i$，代表第 $i$ 块土地的长和宽。保证土地的长和宽不超过 $10^6$。", "outputFormat": "输出买下所有土地的最小费用。", "hint": "将所有土地分为三组：\n\n- 第一块土地为第一组，花费 $100 \\times 1=100$；\n- 第二，三块土地为第二组，花费 $20 \\times 15=300$；\n- 第四块土地为第三组，花费 $1 \\times 100=100$；\n\n总花费为 $500$，可以证明不存在更优的方案。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO08MAR] Land Acquisition G", "background": "", "description": "Farmer John is planning to expand his farm and is considering buying $N$ rectangular plots.\n\nIf FJ buys a single plot, the price equals the area of the plot. But he can choose to acquire a group of plots together, where the price of the group is the maximum length times the maximum width among those plots. For example, if FJ acquires a $3 \\times 5$ plot and a $5 \\times 3$ plot together, he only pays $5 \\times 5=25$, which is cheaper than buying them separately.\n\nFJ wants to buy all the plots. He found that partitioning the plots into different groups can save money. Given the dimensions of each plot, please help him compute the minimum total cost to purchase all plots.", "inputFormat": "The first line contains an integer $N$ ($1 \\leq N \\leq 5 \\times 10^4$).\n\nEach of the next $N$ lines contains two integers $w_i$ and $l_i$, denoting the length and the width of the $i$-th plot. It is guaranteed that both the length and the width do not exceed $10^6$.", "outputFormat": "Output the minimum cost to buy all the plots.", "hint": "Divide all plots into three groups:\n\n- The first plot is in the first group, costing $100 \\times 1=100$.\n- The second and third plots are in the second group, costing $20 \\times 15=300$.\n- The fourth plot is in the third group, costing $1 \\times 100=100$.\n\nThe total cost is $500$, and it can be proven that no better plan exists.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO08MAR] Land Acquisition G", "background": "", "description": "Farmer John 准备扩大他的农场，眼前他正在考虑购买 $N$ 块长方形的土地。\n\n如果 FJ 单买一块土地，价格就是土地的面积。但他可以选择并购一组土地，并购的价格为这些土地中最大的长乘以最大的宽。比如 FJ 并购一块 $3 \\times 5$ 和一块 $5 \\times 3$ 的土地，他只需要支付 $5 \\times 5=25$ 元， 比单买合算。\n\nFJ 希望买下所有的土地。他发现，将这些土地分成不同的小组来并购可以节省经费。 给定每份土地的尺寸，请你帮助他计算购买所有土地所需的最小费用。", "inputFormat": "第一行一个整数 $N$（$1 \\leq N \\leq 5 \\times 10^4$）。\n\n接下来 $N$ 行，每行两个整数 $w_i$ 和 $l_i$，代表第 $i$ 块土地的长和宽。保证土地的长和宽不超过 $10^6$。", "outputFormat": "输出买下所有土地的最小费用。", "hint": "将所有土地分为三组：\n\n- 第一块土地为第一组，花费 $100 \\times 1=100$；\n- 第二，三块土地为第二组，花费 $20 \\times 15=300$；\n- 第四块土地为第三组，花费 $1 \\times 100=100$；\n\n总花费为 $500$，可以证明不存在更优的方案。", "locale": "zh-CN"}}}
{"pid": "P2901", "type": "P", "difficulty": 5, "samples": [["5 8 7 \n5 4 1 \n5 3 1 \n5 2 1 \n5 1 1 \n4 3 4 \n3 1 1 \n3 2 1 \n2 1 1 \n", "1 \n2 \n2 \n3 \n6 \n7 \n-1 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2008", "USACO", "广度优先搜索 BFS", "A*  算法"], "title": "[USACO08MAR] Cow Jogging G", "background": "", "description": "\n贝西终于尝到了懒惰的后果，决定每周从谷仓到池塘慢跑几次来健身。当然，她不想跑得太累，所以她只打算从谷仓慢跑下山到池塘，然后悠闲地散步回谷仓。\n\n同时，贝西不想跑得太远，所以她只想沿着通向池塘的最短路径跑步。一共有 $M$ 条道路，其中每一条都连接了两个牧场。这些牧场从 $1$ 到 $N$ 编号，如果 $X>Y$，则说明牧场 $X$ 的地势高于牧场 $Y$，即下坡的道路是从 $X$ 通向 $Y$ 的，$N$ 为贝西所在的牛棚（最高点），$1$ 为池塘（最低点）。\n\n然而，一周之后，贝西开始对单调的路线感到厌烦，她希望可以跑不同的路线。比如说，她希望能有 $K$ 种不同的路线。同时，为了避免跑得太累，她希望这 $K$ 条路线是从牛棚到池塘的路线中最短的 $K$ 条。如果两条路线包含的道路组成的序列不同，则这两条路线被认为是不同的。\n\n请帮助贝西算算她的训练强度，即将牧场网络里最短的 $K$ 条路径的长度分别算出来。你将会被提供一份牧场间路线的列表，每条道路用 $(X_i, Y_i, D_i)$ 表示，意为从 $X_i$ 到 $Y_i$ 有一条长度为 $D_i$ 的下坡道路。", "inputFormat": "第一行三个用空格分开的整数 $N,M,K$，其中 。\n\n第二行到第 $M+1$ 行每行有三个用空格分开的整数 $X_i,Y_i,D_i$，描述一条下坡的道路。", "outputFormat": "共 $K$ 行，在第 $i$ 行输出第 $i$ 短的路线长度，如果不存在则输出 $-1$。如果出现多种有相同长度的路线，务必将其全部输出。", "hint": "#### 样例 1 解释\n\n这些路线分别为 $(5\\to 1)$、$(5\\to 3\\to 1)$、$(5\\to 2\\to 1)$、$(5\\to 3\\to 2\\to 1)$、$(5\\to 4\\to 3\\to 1)$ 和 $(5\\to 4\\to 3\\to 2\\to 1)$。\n\n#### 数据规模与约定\n\n对于全部的测试点，保证 $1 \\le N \\le 1,000$，$1 \\le M \\le 1\\times10^4$，$1 \\le K \\le 100$，$1 \\le Y_i < X_i\\le N$，$1 \\le D_i \\le 1\\times 10^6$， ", "locale": "zh-CN", "translations": {"en": {"title": "[USACO08MAR] Cow Jogging G", "background": "", "description": "Bessie has finally tasted the consequences of laziness and decides to jog from the barn to the pond several times a week to get in shape. Of course, she does not want to overexert herself, so she only plans to jog downhill from the barn to the pond, then leisurely walk back to the barn.\n\nAt the same time, Bessie does not want to run too far, so she wants to run along the shortest route to the pond. There are $M$ roads in total, each connecting two pastures. The pastures are numbered from $1$ to $N$. If $X > Y$, it means pasture $X$ is higher than pasture $Y$, i.e., downhill roads go from $X$ to $Y$. Pasture $N$ is the barn (the highest point), and pasture $1$ is the pond (the lowest point).\n\nHowever, after a week, Bessie gets bored of the monotony and wants to try different routes. For example, she hopes there can be $K$ different routes. To avoid getting too tired, she wants these $K$ routes to be the $K$ shortest routes from the barn to the pond. Two routes are considered different if the sequences of roads they contain are different.\n\nPlease help Bessie compute her training intensity by finding the lengths of the $K$ shortest paths in the pasture network. You are given a list of roads between pastures, where each road is represented by $(X_i, Y_i, D_i)$, meaning there is a downhill road from $X_i$ to $Y_i$ of length $D_i$.", "inputFormat": "The first line contains three space-separated integers $N, M, K$.\n\nEach of the next $M$ lines contains three space-separated integers $X_i, Y_i, D_i$, describing a downhill road.", "outputFormat": "Output $K$ lines. On the $i$-th line, output the length of the $i$-th shortest route. If fewer than $K$ routes exist, output $-1$ for the remaining lines. If multiple distinct routes have the same length, they should all be counted; equal lengths may appear multiple times.", "hint": "Sample 1 Explanation:\nThese routes are $(5 \\to 1)$, $(5 \\to 3 \\to 1)$, $(5 \\to 2 \\to 1)$, $(5 \\to 3 \\to 2 \\to 1)$, $(5 \\to 4 \\to 3 \\to 1)$, and $(5 \\to 4 \\to 3 \\to 2 \\to 1)$.\n\nConstraints:\nFor all test points, it is guaranteed that $1 \\le N \\le 1,000$, $1 \\le M \\le 1 \\times 10^4$, $1 \\le K \\le 100$, $1 \\le Y_i < X_i \\le N$, $1 \\le D_i \\le 1 \\times 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO08MAR] Cow Jogging G", "background": "", "description": "\n贝西终于尝到了懒惰的后果，决定每周从谷仓到池塘慢跑几次来健身。当然，她不想跑得太累，所以她只打算从谷仓慢跑下山到池塘，然后悠闲地散步回谷仓。\n\n同时，贝西不想跑得太远，所以她只想沿着通向池塘的最短路径跑步。一共有 $M$ 条道路，其中每一条都连接了两个牧场。这些牧场从 $1$ 到 $N$ 编号，如果 $X>Y$，则说明牧场 $X$ 的地势高于牧场 $Y$，即下坡的道路是从 $X$ 通向 $Y$ 的，$N$ 为贝西所在的牛棚（最高点），$1$ 为池塘（最低点）。\n\n然而，一周之后，贝西开始对单调的路线感到厌烦，她希望可以跑不同的路线。比如说，她希望能有 $K$ 种不同的路线。同时，为了避免跑得太累，她希望这 $K$ 条路线是从牛棚到池塘的路线中最短的 $K$ 条。如果两条路线包含的道路组成的序列不同，则这两条路线被认为是不同的。\n\n请帮助贝西算算她的训练强度，即将牧场网络里最短的 $K$ 条路径的长度分别算出来。你将会被提供一份牧场间路线的列表，每条道路用 $(X_i, Y_i, D_i)$ 表示，意为从 $X_i$ 到 $Y_i$ 有一条长度为 $D_i$ 的下坡道路。", "inputFormat": "第一行三个用空格分开的整数 $N,M,K$，其中 。\n\n第二行到第 $M+1$ 行每行有三个用空格分开的整数 $X_i,Y_i,D_i$，描述一条下坡的道路。", "outputFormat": "共 $K$ 行，在第 $i$ 行输出第 $i$ 短的路线长度，如果不存在则输出 $-1$。如果出现多种有相同长度的路线，务必将其全部输出。", "hint": "#### 样例 1 解释\n\n这些路线分别为 $(5\\to 1)$、$(5\\to 3\\to 1)$、$(5\\to 2\\to 1)$、$(5\\to 3\\to 2\\to 1)$、$(5\\to 4\\to 3\\to 1)$ 和 $(5\\to 4\\to 3\\to 2\\to 1)$。\n\n#### 数据规模与约定\n\n对于全部的测试点，保证 $1 \\le N \\le 1,000$，$1 \\le M \\le 1\\times10^4$，$1 \\le K \\le 100$，$1 \\le Y_i < X_i\\le N$，$1 \\le D_i \\le 1\\times 10^6$， ", "locale": "zh-CN"}}}
{"pid": "P2902", "type": "P", "difficulty": 3, "samples": [["8 3 \n2 \n2 \n4 \n", "1 3 \n1 3 \n2 3 \n3 2 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2008", "USACO", "Special Judge"], "title": "[USACO08MAR] Pearl Pairing G", "background": null, "description": "在 Bessie 最近的生日聚会上，她收到 $N(2\\le N \\le 10^5,N\\equiv0\\pmod{2})$ 颗珍珠。一共有 $C$ 种颜色的珍珠（$1\\le C \\le N$），第 $i$ 种颜色的珍珠有 $C_i$ 颗。\n\n\n观察到珍珠的数量 $N$ 总是偶数，她的创意来了，决定配对珍珠，使每对珍珠有两种不同的颜色。数据保证存在答案。请帮助 Bessie 执行这样的配对，如果有多种配对的方法，输出任意一种即可。", "inputFormat": "第 $1$ 行：两个空格分隔的整数：$N$ 和 $C$。\n\n第 $2\\ldots C+1$行：第 $i+1$ 为颜色 $i$ 的珍珠数 $C_i$。", "outputFormat": "第 $1\\ldots \\dfrac{N}{2}$ 行：第 $i$ 行包含两个整数 $a_i$ 和 $b_i$，表示 Bessie 可以将各自颜色为 $a_i$ 和 $b_i$ 的两个珍珠配对。", "hint": "说明：有 $8$ 颗珍珠和 $3$ 种不同的颜色。两颗珍珠颜色为 $1$，两颗珍珠颜色为 $2$，四颗珍珠颜色为 $3$。\n\nBessie 将每颗颜色为 $3$ 的珍珠与颜色为 $1$ 和 $2$ 的珍珠配对。\n\n感谢@[线段木](https://www.luogu.com.cn/user/33930) 提供翻译，@[PineappleSummer](https://www.luogu.com.cn/user/880187) 修正翻译以及提供 $\\LaTeX$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO08MAR] Pearl Pairing G", "background": null, "description": "At Bessie's recent birthday party, she received $N(2 \\le N \\le 10^5,N\\equiv0\\pmod{2})$ pearls, each painted one of C different colors ($1\\le C \\le N$).\n\nUpon observing that the number of pearls $N$ is always even, her creative juices flowed and she decided to pair the pearls so that each pair of pearls has two different colors.\n\nKnowing that such a set of pairings is always possible for the supplied testcases, help Bessie perform such a pairing. If there are multiple ways of creating a pairing, any solution suffices.", "inputFormat": "Line $1$: Two space-separated integers: $N$ and $C$.\n\nLines $2 \\ldots C+1$: Line $i+1$ tells the count of pearls with color $i$: $C_i$.", "outputFormat": "Lines $1\\ldots \\dfrac{N}{2}$: Line $i$ contains two integers $a_i$ and $b_i$ indicating that Bessie can pair two pearls with respective colors $a_i$ and $b_i$.", "hint": "There are $8$ pearls and $3$ different colors. Two pearls have color $\\mathrm{I}$; two have color $\\mathrm{II}$; four have color $\\mathrm{III}$.\n\n\nBessie pairs each pearl of color $\\mathrm{III}$ with one of color $\\mathrm{I}$ and $\\mathrm{Ii}$.", "locale": "en"}, "zh-CN": {"title": "[USACO08MAR] Pearl Pairing G", "background": null, "description": "在 Bessie 最近的生日聚会上，她收到 $N(2\\le N \\le 10^5,N\\equiv0\\pmod{2})$ 颗珍珠。一共有 $C$ 种颜色的珍珠（$1\\le C \\le N$），第 $i$ 种颜色的珍珠有 $C_i$ 颗。\n\n\n观察到珍珠的数量 $N$ 总是偶数，她的创意来了，决定配对珍珠，使每对珍珠有两种不同的颜色。数据保证存在答案。请帮助 Bessie 执行这样的配对，如果有多种配对的方法，输出任意一种即可。", "inputFormat": "第 $1$ 行：两个空格分隔的整数：$N$ 和 $C$。\n\n第 $2\\ldots C+1$行：第 $i+1$ 为颜色 $i$ 的珍珠数 $C_i$。", "outputFormat": "第 $1\\ldots \\dfrac{N}{2}$ 行：第 $i$ 行包含两个整数 $a_i$ 和 $b_i$，表示 Bessie 可以将各自颜色为 $a_i$ 和 $b_i$ 的两个珍珠配对。", "hint": "说明：有 $8$ 颗珍珠和 $3$ 种不同的颜色。两颗珍珠颜色为 $1$，两颗珍珠颜色为 $2$，四颗珍珠颜色为 $3$。\n\nBessie 将每颗颜色为 $3$ 的珍珠与颜色为 $1$ 和 $2$ 的珍珠配对。\n\n感谢@[线段木](https://www.luogu.com.cn/user/33930) 提供翻译，@[PineappleSummer](https://www.luogu.com.cn/user/880187) 修正翻译以及提供 $\\LaTeX$。", "locale": "zh-CN"}}}
{"pid": "P2903", "type": "P", "difficulty": 3, "samples": [["4 32 54 \n0 0 10 \n0 30 20 \n32 54 20 \n-40 30 20 \n", "20000 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "搜索", "2008", "USACO", "广度优先搜索 BFS"], "title": "[USACO08MAR] The Loathesome Hay Baler S", "background": "", "description": "Farmer John has purchased the world's most loathesome hay baler. Instead of having a drive-roller that drives maybe an idler roller that drives the power take-off for the baler, it has N rollers (2 <= N <= 1050) which drive and are driven by various rollers.\n\nFJ has meticulously cataloged data for each roller i: X\\_i,Y\\_i are the center of the roller (-5000 <= X\\_i <= 5000; -5000 <= Y\\_i <= 5000); R\\_i is the roller's radius (3 <= R\\_i <= 800). The drive-roller is located at 0,0; the baler power take-off is located at X\\_t,Y\\_t (numbers supplied in the input).\n\nThe drive-roller turns clockwise at 10,000 revolutions per hour. Your job is to determine the speeds of all the rollers that are in the power-train: from the drive-roller through the power take-off roller. Rollers that do not transfer power to the take-off roller are to be ignored. A roller of radius Rd that is turning at S rph and driving another roller of radius Rx will cause the second roller to turn at the speed -S\\*Rd/Rx (where the sign denotes whether the roller is turning clockwise or counterclockwise (anticlockwise for our British friends)).\n\nDetermine the power-train path and report the sum of the absolute values of all those rollers' speeds. All the rollers in the input set except the driver-roller are driven by some other roller; power is never transferred to a roller from more than one other roller.\n\nReport your answer as an integer that is the truncated value after summing all the speeds.", "inputFormat": "\\* Line 1: Three space-separated integers: N, X\\_t, and Y\\_t\n\n\\* Lines 2..N+1: Line i+1 describes roller i's properties: X\\_i, Y\\_i, and R\\_i", "outputFormat": "\\* Line 1: A single integer that is the truncated version of the sum of the absolute value of the speeds of the rollers in the power-train including the drive-roller, all the driven rollers, and the power take-off roller.", "hint": "$2 \\leq N \\leq 1050$，$-5000 \\leq x,y \\leq 5000$，$3 \\leq r \\leq 800$。\n\n\n\n\nFour rollers: the drive-roller at 0,0 with radius 10. It drives the roller above it at 0,30 with radius 20. That roller drives both the power take-off roller at 32,54 (r=20) and a random roller (not in the power train) at -40,30 (r=20).\n\n\nRoller   Radius   Speed\n\n1 (0,0)     10     10,000 \n\n2 (0,30)    20     -5,000 \n\n3 (32,54)   20      5,000 \n\n------\nSum of abs values: 20,000\n", "locale": "en", "translations": {"en": {"title": "[USACO08MAR] The Loathesome Hay Baler S", "background": "", "description": "Farmer John has purchased the world's most loathesome hay baler. Instead of having a drive-roller that drives maybe an idler roller that drives the power take-off for the baler, it has N rollers (2 <= N <= 1050) which drive and are driven by various rollers.\n\nFJ has meticulously cataloged data for each roller i: X\\_i,Y\\_i are the center of the roller (-5000 <= X\\_i <= 5000; -5000 <= Y\\_i <= 5000); R\\_i is the roller's radius (3 <= R\\_i <= 800). The drive-roller is located at 0,0; the baler power take-off is located at X\\_t,Y\\_t (numbers supplied in the input).\n\nThe drive-roller turns clockwise at 10,000 revolutions per hour. Your job is to determine the speeds of all the rollers that are in the power-train: from the drive-roller through the power take-off roller. Rollers that do not transfer power to the take-off roller are to be ignored. A roller of radius Rd that is turning at S rph and driving another roller of radius Rx will cause the second roller to turn at the speed -S\\*Rd/Rx (where the sign denotes whether the roller is turning clockwise or counterclockwise (anticlockwise for our British friends)).\n\nDetermine the power-train path and report the sum of the absolute values of all those rollers' speeds. All the rollers in the input set except the driver-roller are driven by some other roller; power is never transferred to a roller from more than one other roller.\n\nReport your answer as an integer that is the truncated value after summing all the speeds.", "inputFormat": "\\* Line 1: Three space-separated integers: N, X\\_t, and Y\\_t\n\n\\* Lines 2..N+1: Line i+1 describes roller i's properties: X\\_i, Y\\_i, and R\\_i", "outputFormat": "\\* Line 1: A single integer that is the truncated version of the sum of the absolute value of the speeds of the rollers in the power-train including the drive-roller, all the driven rollers, and the power take-off roller.", "hint": "$2 \\leq N \\leq 1050$，$-5000 \\leq x,y \\leq 5000$，$3 \\leq r \\leq 800$。\n\n\n\n\nFour rollers: the drive-roller at 0,0 with radius 10. It drives the roller above it at 0,30 with radius 20. That roller drives both the power take-off roller at 32,54 (r=20) and a random roller (not in the power train) at -40,30 (r=20).\n\n\nRoller   Radius   Speed\n\n1 (0,0)     10     10,000 \n\n2 (0,30)    20     -5,000 \n\n3 (32,54)   20      5,000 \n\n------\nSum of abs values: 20,000\n", "locale": "en"}, "zh-CN": {"title": "[USACO08MAR] The Loathesome Hay Baler S", "background": null, "description": "Farmer John 新买的干草打包机的内部结构大概算世界上最混乱的了，它不像普通的机器一样有明确的内部传动装置，而是 $N$ 个齿轮互相作用，每个齿轮都可能驱动着多个齿轮。 FJ 记录了对于每个齿轮 $i$，记录了它的 $3$ 个参数，以一个三元组 $(x,y,r)$ 表示，$x$ 和 $y$ 表示齿轮中心的位置坐标，$r$ 表示该齿轮的半径。\n\n驱动齿轮的位置为 $(0,0)$，并且 FJ 也知道最终的工作齿轮位于 $(X_t,Y_t)$。 驱动齿轮顺时针转动，转速为 $10,000$ 转/小时。你的任务是，确定传动序列中所有齿轮的转速。传动序列的定义为，能量由驱动齿轮传送到工作齿轮的过程中用到的所有齿轮的集合。对能量传送无意义的齿轮都应当被忽略。\n\n在一个半径为 $R_d$，转速为 $S$ 转/每小时的齿轮的带动下，与它相接的半径为 $R_x$ 的齿轮的转速将为 $-S\\times \\frac{R_d}{R_x}$ 转/小时。$S$ 前的负号的意思是，一个齿轮带动的另一个齿轮的转向会与它的转向相反。\n\nFJ 只对整个传动序列中所有齿轮速度的绝对值之和感兴趣，你的任务也就相应转化成求这个值。机器中除了驱动齿轮以外的所有齿轮都被另外某个齿轮带动，并且不会出现 $2$ 个不同的齿轮带动同一个齿轮的情况。", "inputFormat": "第一行，三个整数，分别代表 $N,X_t,Y_t$；\n\n第 $2$ 行到第 $N+1$ 行，每行三个整数，代表一个三元组 $(x,y,r)$。", "outputFormat": "输出共一行，一个整数，代表整个传动序列中所有齿轮速度的绝对值之和。", "hint": "$2 \\leq N \\leq 1050$，$-5000 \\leq x,y \\leq 5000$，$3 \\leq r \\leq 800$。\n\n有四个齿轮：驱动齿轮位于 $0,0$，半径为 $10$。它驱动位于 $0,30$、半径为 $20$ 的齿轮。该齿轮又驱动动力输出齿轮，位于 $32,54$（$r=20$）和一个随机齿轮（不在动力传动系统中），位于 $-40,30$（$r=20$）。\n\n|齿轮 |半径 |速度 |\n|:-:|:-:|:-:|\n|  $1$ $(0,0)$ | $10$  | $10000$  |\n|  $2$ $(0,30)$ | $20$  | $5000$  |\n|  $3$ $(32,54)$ | $20$  |  $-5000$ |\n\n\n绝对值之和：$20000$。", "locale": "zh-CN"}}}
{"pid": "P2904", "type": "P", "difficulty": 3, "samples": [["5 10 \n3 \n4 \n6 \n100 \n1 \n", "50 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2008", "USACO", "背包 DP"], "title": "[USACO08MAR] River Crossing S", "background": "", "description": "Farmer John is herding his N cows (1 <= N <= 2,500) across the expanses of his farm when he finds himself blocked by a river. A single raft is available for transportation.\n\nFJ knows that he must ride on the raft for all crossings and that that adding cows to the raft makes it traverse the river more slowly.\n\nWhen FJ is on the raft alone, it can cross the river in M minutes (1 <= M <= 1000).  When the i cows are added, it takes M\\_i minutes (1 <= M\\_i <= 1000) longer to cross the river than with i-1 cows (i.e., total M+M\\_1 minutes with one cow, M+M\\_1+M\\_2 with two, etc.). Determine the minimum time it takes for Farmer John to get all of the cows across the river (including time returning to get more cows).", "inputFormat": "\\* Line 1: Two space-separated integers: N and M\n\n\\* Lines 2..N+1: Line i+1 contains a single integer: M\\_i\n", "outputFormat": "\\* Line 1: The minimum time it takes for Farmer John to get all of the cows across the river.\n", "hint": "There are five cows. Farmer John takes 10 minutes to cross the river alone, 13 with one cow, 17 with two cows, 23 with three, 123 with four, and 124 with all five.\n\n\nFarmer John can first cross with three cows (23 minutes), then return (10 minutes), and then cross with the last two (17 minutes). 23+10+17 = 50 minutes total.\n", "locale": "en", "translations": {"en": {"title": "[USACO08MAR] River Crossing S", "background": "", "description": "Farmer John is herding his N cows (1 <= N <= 2,500) across the expanses of his farm when he finds himself blocked by a river. A single raft is available for transportation.\n\nFJ knows that he must ride on the raft for all crossings and that that adding cows to the raft makes it traverse the river more slowly.\n\nWhen FJ is on the raft alone, it can cross the river in M minutes (1 <= M <= 1000).  When the i cows are added, it takes M\\_i minutes (1 <= M\\_i <= 1000) longer to cross the river than with i-1 cows (i.e., total M+M\\_1 minutes with one cow, M+M\\_1+M\\_2 with two, etc.). Determine the minimum time it takes for Farmer John to get all of the cows across the river (including time returning to get more cows).", "inputFormat": "\\* Line 1: Two space-separated integers: N and M\n\n\\* Lines 2..N+1: Line i+1 contains a single integer: M\\_i\n", "outputFormat": "\\* Line 1: The minimum time it takes for Farmer John to get all of the cows across the river.\n", "hint": "There are five cows. Farmer John takes 10 minutes to cross the river alone, 13 with one cow, 17 with two cows, 23 with three, 123 with four, and 124 with all five.\n\n\nFarmer John can first cross with three cows (23 minutes), then return (10 minutes), and then cross with the last two (17 minutes). 23+10+17 = 50 minutes total.\n", "locale": "en"}, "zh-CN": {"title": "[USACO08MAR] River Crossing S", "background": null, "description": "农夫约翰以及他的 $N(1 \\le N \\le 2500)$ 头奶牛打算过一条河，但他们所有的渡河工具，仅仅是一个木筏。 \n\n由于奶牛不会划船，在整个渡河过程中，约翰必须始终在木筏上。在这个基础上，木筏上的奶牛数目每增加 $1$，FJ把木筏划到对岸就得花更多的时间。 \n\n当约翰一个人坐在木筏上，他把木筏划到对岸需要 $M(1 \\le M \\le 1000)$ 分钟。当木筏搭载的奶牛数目从 $i-1$ 增加到 $i$ 时，约翰得多花 $M_i(1 \\le M_i \\le 1000)$ 分钟才能把木筏划过河（也就是说，船上有 $1$ 头奶牛时，约翰得花 $M+M_1$ 分钟渡河；船上有 $2$ 头奶牛时，时间就变成 $M+M_1+M_2$ 分钟。后面的以此类推）。那么，约翰最少要花多少时间，才能把所有奶牛带到对岸呢？当然，这个时间得包括约翰一个人把木筏从对岸划回来接下一批的奶牛的时间。", "inputFormat": "* 第一行包含 $2$ 个整数 $N$ 和 $M$。\n* 第 $2$ 行至第 $N + 1$ 行，其中第 $i + 1$ 行包含 $1$ 个整数 $M_i$。", "outputFormat": "* 输出共 $1$ 行，为农夫约翰让所有奶牛过河所需的最短时间。", "hint": "有五头牛，农夫约翰独自过河需要 $10$ 分钟，带一头牛需要 $13$ 分钟，带两头牛需要 $17$ 分钟，带三头牛需要 $23$ 分钟，带四头牛需要 $123$ 分钟，带五头牛需要 $124$ 分钟。\n\n农夫约翰可以先带三头牛过河（$23$ 分钟），然后独自返回（$10$ 分钟），再带最后两头牛过河（$17$ 分钟）。总共耗时 $23+10+17=50$ 分钟。", "locale": "zh-CN"}}}
{"pid": "P2905", "type": "P", "difficulty": 5, "samples": [["3 6 3 \n3 4 \n6 2 \n5 7 \n8 2 \n9 2 \n6 4 \n5 4 \n6 7 \n8 7 \n", "6 \nEEE \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "搜索", "2008", "USACO"], "title": "[USACO08OPEN] Crisis on the Farm G", "background": null, "description": "约翰和他的奶牛组建了一只乐队“后街奶牛”，现在他们正在牧场里排练。奶牛们分成一堆一堆，共 $N$ 堆。每一堆里，$30$ 只奶牛一只踩在另一只的背上，叠成一座牛塔。牧场里还有 $M$ 个高高的草垛。\n\n作为出色的指挥家，约翰可以通过口哨指挥奶牛们移动。他的口哨有四个音，分别能使所有的牛塔向东南西北四个方向移动一格。\n\n每一次，当一个牛塔到达了一个草垛所在的格子，牛塔最上方的奶牛就会跳到草垛上，而且不再下来，而其他奶牛仍然呈塔状站在草垛所在的格子里。当牛塔只剩一只奶牛时，这只奶牛也会跳到草垛上。\n\n突然，约翰大惊失色：原来邻家的奶缸爆炸了！滚滚而下的牛奶正朝着约翰的牧场冲来，不久就要将牧场淹没。约翰必须马上行动，用口哨声挽救奶牛们的生命。他要指挥奶牛尽量多地跳上草垛，草垛上的奶牛将不会被淹死。\n\n约翰还有 $K$ 次吹口哨的机会。那他最多还能救多少奶牛呢？请计算最多能挽救的奶牛数，以及达到这个数目约翰需要吹的口哨调子序列。序列用 $\\mathtt{E,W,S,N}$ 表示东西南北。如果有多种序列能达到要求，输出字典序最小的。", "inputFormat": "第一行三个正整数 $N,M,K$。\n\n下面 $N$ 行，每行两个正整数 $X_i,Y_i$，表示一个奶牛堆的坐标 $(X_i,Y_i)$。\n\n下面 $M$ 行，每行两个正整数 $X_i,Y_i$，表示一个草垛的坐标 $(X_i,Y_i)$。", "outputFormat": "第一行输出一个整数表示最多能挽救的奶牛数。\n\n第一行输出一个长度为 $K$ 的字符串表示达到这个数目约翰需要吹的字典序最小的口哨调子序列。", "hint": "样例解释：\n\n$3$ 声哨子吹完后，$3$ 个草堆各挽救了一只奶牛。\n\n---\n\n对于 $100\\%$ 的数据，$1\\le K\\le 30$，$1\\le N,M,X_i,Y_i\\le 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO08OPEN] Crisis on the Farm G", "background": "", "description": "John and his cows have formed a band called \"Backstreet Cows,\" and they are rehearsing on the pasture. The cows are grouped into $N$ piles. In each pile, $30$ cows stand one on another, forming a tower. There are also $M$ tall haystacks on the pasture.\n\nAs a skilled conductor, John can use four whistle tones. Each tone makes all towers move one cell in one of the four directions: east, west, south, or north.\n\nEach time a tower reaches a cell that contains a haystack, the cow at the top of the tower jumps onto the haystack and stays there, while the remaining cows continue to stand as a tower on that cell. When only one cow remains in a tower, that cow also jumps onto the haystack.\n\nSuddenly, the neighbor’s milk tank explodes. A torrent of milk is rushing toward John’s pasture and will flood it soon. John must act immediately and use whistle tones to save as many cows as possible. Cows on haystacks will not drown.\n\nJohn has $K$ whistle blows left. How many cows can he save at most? Compute the maximum number of cows that can be saved, and a sequence of whistle tones to achieve it. The sequence is represented by $\\mathtt{E, W, S, N}$ for east, west, south, and north. If multiple sequences achieve the maximum, output the lexicographically smallest one.", "inputFormat": "- The first line contains three positive integers $N, M, K$.\n- The next $N$ lines each contain two positive integers $X_i, Y_i$, the coordinates $(X_i, Y_i)$ of a cow pile.\n- The next $M$ lines each contain two positive integers $X_i, Y_i$, the coordinates $(X_i, Y_i)$ of a haystack.", "outputFormat": "- The first line contains an integer, the maximum number of cows that can be saved.\n- The second line contains a string of length $K$ that is the lexicographically smallest whistle tone sequence achieving that maximum.", "hint": "Sample explanation:\n\nAfter $3$ whistles, $3$ haystacks each save one cow.\n\nConstraints:\n\nFor $100\\%$ of the testdata, $1 \\le K \\le 30$, $1 \\le N, M, X_i, Y_i \\le 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO08OPEN] Crisis on the Farm G", "background": null, "description": "约翰和他的奶牛组建了一只乐队“后街奶牛”，现在他们正在牧场里排练。奶牛们分成一堆一堆，共 $N$ 堆。每一堆里，$30$ 只奶牛一只踩在另一只的背上，叠成一座牛塔。牧场里还有 $M$ 个高高的草垛。\n\n作为出色的指挥家，约翰可以通过口哨指挥奶牛们移动。他的口哨有四个音，分别能使所有的牛塔向东南西北四个方向移动一格。\n\n每一次，当一个牛塔到达了一个草垛所在的格子，牛塔最上方的奶牛就会跳到草垛上，而且不再下来，而其他奶牛仍然呈塔状站在草垛所在的格子里。当牛塔只剩一只奶牛时，这只奶牛也会跳到草垛上。\n\n突然，约翰大惊失色：原来邻家的奶缸爆炸了！滚滚而下的牛奶正朝着约翰的牧场冲来，不久就要将牧场淹没。约翰必须马上行动，用口哨声挽救奶牛们的生命。他要指挥奶牛尽量多地跳上草垛，草垛上的奶牛将不会被淹死。\n\n约翰还有 $K$ 次吹口哨的机会。那他最多还能救多少奶牛呢？请计算最多能挽救的奶牛数，以及达到这个数目约翰需要吹的口哨调子序列。序列用 $\\mathtt{E,W,S,N}$ 表示东西南北。如果有多种序列能达到要求，输出字典序最小的。", "inputFormat": "第一行三个正整数 $N,M,K$。\n\n下面 $N$ 行，每行两个正整数 $X_i,Y_i$，表示一个奶牛堆的坐标 $(X_i,Y_i)$。\n\n下面 $M$ 行，每行两个正整数 $X_i,Y_i$，表示一个草垛的坐标 $(X_i,Y_i)$。", "outputFormat": "第一行输出一个整数表示最多能挽救的奶牛数。\n\n第一行输出一个长度为 $K$ 的字符串表示达到这个数目约翰需要吹的字典序最小的口哨调子序列。", "hint": "样例解释：\n\n$3$ 声哨子吹完后，$3$ 个草堆各挽救了一只奶牛。\n\n---\n\n对于 $100\\%$ 的数据，$1\\le K\\le 30$，$1\\le N,M,X_i,Y_i\\le 1000$。", "locale": "zh-CN"}}}
{"pid": "P2906", "type": "P", "difficulty": 6, "samples": [["4 2 \n1 1 \n3 3 \n2 2 \n10 10 \n", "2 3 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2008", "USACO", "并查集", "平衡树", "生成树"], "title": "[USACO08OPEN] Cow Neighborhoods G", "background": "", "description": "了解奶牛的人都知道奶牛是如何组成「奶牛社区」的。他们观察了 Farmer John 的 $N$ 头奶牛（编号为 $1 \\sim N$），它们在 $X$ 和 $Y$ 坐标范围为 $1$ 的牧场上放牧，每头奶牛都在自己唯一的整数直线坐标上。\n\n如果满足以下两个标准中的至少一个，则两头奶牛是邻居：\n\n1. 两只奶牛的曼哈顿距离不超过 $C$，即 $|X_i - x_i| + |Y_i - y_i| \\leq C$；\n2. 两只奶牛有共同的邻居。即存在一只奶牛 $k$，使 $i$ 与 $k$，$j$ 与 $k$ 均同属一个群。\n\n给定奶牛的位置和距离 $C$，确定「奶牛社区」的数量和最大的「奶牛社区」中的奶牛数量。\n\n例如，考虑下面的牧场。 当 $C = 4$ 时，这个牧场有四个社区：左边的一个大社区，两个大小为 1 的社区，右边有一个巨大的社区，里面有 $60$ 头不同的奶牛。\n\n```text\n.....................................*.................\n....*...*..*.......................***.................\n......*...........................****.................\n..*....*..*.......................*...*.******.*.*.....\n........................*.............***...***...*....\n*..*..*...*..........................*..*...*..*...*...\n.....................................*..*...*..*.......\n.....................................*..*...*..*.......\n...*................*..................................\n.*..*............................*.*.*.*.*.*.*.*.*.*.*.\n.*.....*..........................*.*.*.*.*.*.*.*.*.*.*\n....*..................................................\n```", "inputFormat": "第 $1$ 行包含两个用空格分隔的整数 $N, C$。\n\n第 $2$ 到第 $N + 1$ 行每行包含两个用空格分隔的整数 $X_i, Y_i$，表示一头牛的坐标。\n", "outputFormat": "\n共一行，为两个用空格分隔的整数，为「奶牛社区」的数量和最大的「奶牛社区」内牛的数量。", "hint": "### 样例说明 #1\n\n样例中有 $2$ 个社区，一个由前三头奶牛组成，另一个是最后一头奶牛。因此，最大的社区大小为 $3$。\n\n### 数据范围与约定\n\n对于 $100\\%$ 的数据，$1 \\leq N \\leq 10^5$，$1 \\leq C \\leq 10^9$，$1 \\leq X_i, Y_i \\leq 10^9$，$X_i, Y_i$ 均为整数。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO08OPEN] Cow Neighborhoods G", "background": "", "description": "People who know cows understand how they form \"cow neighborhoods.\" They observed Farmer John’s $N$ cows (numbered $1$ through $N$) grazing on a pasture modeled as a plane with $X$ and $Y$ coordinates starting from $1$, where each cow is located at a unique integer lattice point.\n\nTwo cows are neighbors if at least one of the following criteria holds:\n1. Their Manhattan distance is at most $C$, i.e., $|X_i - X_j| + |Y_i - Y_j| \\leq C$.\n2. They share a common neighbor; that is, there exists a cow $k$ such that $i$ and $k$, and $j$ and $k$, both belong to the same group.\n\nGiven the cows’ positions and the distance $C$, determine the number of \"cow neighborhoods\" and the number of cows in the largest \"cow neighborhood.\"\n\nFor example, consider the pasture below. When $C = 4$, this pasture has four neighborhoods: one large neighborhood on the left, two neighborhoods of size $1$, and a huge neighborhood on the right containing $60$ distinct cows.\n\n```text\n.....................................*.................\n....*...*..*.......................***.................\n......*...........................****.................\n..*....*..*.......................*...*.******.*.*.....\n........................*.............***...***...*....\n*..*..*...*..........................*..*...*..*...*...\n.....................................*..*...*..*.......\n.....................................*..*...*..*.......\n...*................*..................................\n.*..*............................*.*.*.*.*.*.*.*.*.*.*.\n.*.....*..........................*.*.*.*.*.*.*.*.*.*.*\n....*..................................................\n```", "inputFormat": "The first line contains two space-separated integers $N, C$.\n\nEach of the next $N$ lines contains two space-separated integers $X_i, Y_i$, giving the coordinates of a cow.", "outputFormat": "Output a single line with two space-separated integers: the number of \"cow neighborhoods\" and the size of the largest \"cow neighborhood.\"", "hint": "Sample Explanation #1\n\nThere are $2$ neighborhoods in the sample: one formed by the first three cows, and the other by the last cow. Therefore, the largest neighborhood size is $3$.\n\nConstraints\n\nFor $100\\%$ of the testdata, $1 \\leq N \\leq 10^5$, $1 \\leq C \\leq 10^9$, $1 \\leq X_i, Y_i \\leq 10^9$, and $X_i, Y_i$ are integers.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO08OPEN] Cow Neighborhoods G", "background": "", "description": "了解奶牛的人都知道奶牛是如何组成「奶牛社区」的。他们观察了 Farmer John 的 $N$ 头奶牛（编号为 $1 \\sim N$），它们在 $X$ 和 $Y$ 坐标范围为 $1$ 的牧场上放牧，每头奶牛都在自己唯一的整数直线坐标上。\n\n如果满足以下两个标准中的至少一个，则两头奶牛是邻居：\n\n1. 两只奶牛的曼哈顿距离不超过 $C$，即 $|X_i - x_i| + |Y_i - y_i| \\leq C$；\n2. 两只奶牛有共同的邻居。即存在一只奶牛 $k$，使 $i$ 与 $k$，$j$ 与 $k$ 均同属一个群。\n\n给定奶牛的位置和距离 $C$，确定「奶牛社区」的数量和最大的「奶牛社区」中的奶牛数量。\n\n例如，考虑下面的牧场。 当 $C = 4$ 时，这个牧场有四个社区：左边的一个大社区，两个大小为 1 的社区，右边有一个巨大的社区，里面有 $60$ 头不同的奶牛。\n\n```text\n.....................................*.................\n....*...*..*.......................***.................\n......*...........................****.................\n..*....*..*.......................*...*.******.*.*.....\n........................*.............***...***...*....\n*..*..*...*..........................*..*...*..*...*...\n.....................................*..*...*..*.......\n.....................................*..*...*..*.......\n...*................*..................................\n.*..*............................*.*.*.*.*.*.*.*.*.*.*.\n.*.....*..........................*.*.*.*.*.*.*.*.*.*.*\n....*..................................................\n```", "inputFormat": "第 $1$ 行包含两个用空格分隔的整数 $N, C$。\n\n第 $2$ 到第 $N + 1$ 行每行包含两个用空格分隔的整数 $X_i, Y_i$，表示一头牛的坐标。\n", "outputFormat": "\n共一行，为两个用空格分隔的整数，为「奶牛社区」的数量和最大的「奶牛社区」内牛的数量。", "hint": "### 样例说明 #1\n\n样例中有 $2$ 个社区，一个由前三头奶牛组成，另一个是最后一头奶牛。因此，最大的社区大小为 $3$。\n\n### 数据范围与约定\n\n对于 $100\\%$ 的数据，$1 \\leq N \\leq 10^5$，$1 \\leq C \\leq 10^9$，$1 \\leq X_i, Y_i \\leq 10^9$，$X_i, Y_i$ 均为整数。", "locale": "zh-CN"}}}
{"pid": "P2907", "type": "P", "difficulty": 1, "samples": [["6 2 \n", "3 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2008", "USACO", "递归"], "title": "[USACO08OPEN] Roads Around The Farm S", "background": "", "description": "Farmer John's cows have taken an interest in exploring the territory around the farm. Initially, all N (1 <= N <= 1,000,000,000) cows commence traveling down a road in one big group. Upon encountering a fork in the road, the group sometimes chooses to break into two smaller (nonempty) groups with each group continuing down one of the roads.  When one of those groups arrives at another fork, it might split again, and so on.\n\nThe cows have crafted a peculiar way of splitting: if they can split into two groups such that the sizes of the groups differ by exactly K (1 <= K <= 1000), then they will split in that way; otherwise, they stop exploring and just start grazing peacefully.\n\nAssuming that there will always be new forks in the road, compute the final number of groups of peacefully grazing cows.", "inputFormat": "\\* Line 1: Two space-separated integers: N and K\n", "outputFormat": "\\* Line 1: A single integer representing the number of groups of grazing cows\n", "hint": "There are 6 cows and the difference in group sizes is 2.\n\n\nThere are 3 final groups (with 2, 1, and 3 cows in them). \n\n```plain\n  6\n / \\\n2   4\n   / \\\n  1   3\n```", "locale": "en", "translations": {"en": {"title": "[USACO08OPEN] Roads Around The Farm S", "background": "", "description": "Farmer John's cows have taken an interest in exploring the territory around the farm. Initially, all N (1 <= N <= 1,000,000,000) cows commence traveling down a road in one big group. Upon encountering a fork in the road, the group sometimes chooses to break into two smaller (nonempty) groups with each group continuing down one of the roads.  When one of those groups arrives at another fork, it might split again, and so on.\n\nThe cows have crafted a peculiar way of splitting: if they can split into two groups such that the sizes of the groups differ by exactly K (1 <= K <= 1000), then they will split in that way; otherwise, they stop exploring and just start grazing peacefully.\n\nAssuming that there will always be new forks in the road, compute the final number of groups of peacefully grazing cows.", "inputFormat": "\\* Line 1: Two space-separated integers: N and K\n", "outputFormat": "\\* Line 1: A single integer representing the number of groups of grazing cows\n", "hint": "There are 6 cows and the difference in group sizes is 2.\n\n\nThere are 3 final groups (with 2, 1, and 3 cows in them). \n\n```plain\n  6\n / \\\n2   4\n   / \\\n  1   3\n```", "locale": "en"}, "zh-CN": {"title": "[USACO08OPEN] Roads Around The Farm S", "background": null, "description": "Farmer John 的奶牛对探索农场周围的领地产生了兴趣。最初，所有 $N$ 头奶牛（$1 \\leq N \\leq 10^9$）以一个大群体的形式开始沿着一条道路旅行。当遇到岔路时，群体有时会选择分成两个较小的（非空）群体，每个群体沿着一条道路继续前进。当其中一个群体到达另一个岔路时，它可能会再次分裂，依此类推。\n\n奶牛们设计了一种特殊的分裂方式：如果它们可以分裂成两个群体，使得群体的大小正好相差 $K$（$1 \\leq K \\leq 1000$），那么它们就会以这种方式分裂；否则，它们就停止探索，开始安静地吃草。\n\n假设总是会有新的岔路，计算最终安静吃草的奶牛群的数量。", "inputFormat": "两个空格分隔的整数，$N$ 和 $K$。", "outputFormat": "一个整数，表示安静吃草的奶牛群的数量。", "hint": "有 $6$ 头奶牛，群体大小的差异是 $2$。\n\n最终有 $3$ 个群体（分别有 $2$、$1$ 和 $3$ 头奶牛）。\n\n```plain\n  6\n / \\\n2   4\n   / \\\n  1   3\n```\n\n（由 ChatGPT 4o 翻译）", "locale": "zh-CN"}}}
