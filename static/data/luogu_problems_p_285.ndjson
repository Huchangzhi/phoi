{"pid": "P6770", "type": "P", "difficulty": 3, "samples": [["7 6 5 8\n1 4 2\n1 2 1\n2 3 6\n3 5 5\n5 4 6\n1 7 9\n1\n4\n5\n3\n7", "4\n1\n2\n3\n4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2005", "USACO", "最短路"], "title": "[USACO05MAR] Checking an Alibi 不在场的证明", "background": null, "description": "谷仓里发现谷物被盗！FJ 正试图从 $C$ 只奶牛里找出那个偷谷物的罪犯。幸运的是，一个恰好路过的卫星拍下谷物被盗前 $M$ 秒的农场的图片。这样约翰就能通过牛们的位置来判断谁有足够的时间来盗窃谷物。\n\n约翰农场有 $F$ 片草地，标号 $1$ 到 $F$，还有 $P$ 条双向路连接着它们。通过这些路需要的时间在 $1$ 到 $7\\times 10^4$ 秒的范围内。草地 $1$ 上建有那个被盗的谷仓。给出农场地图，以及卫星照片里每只牛所在的位置，请判断哪些牛有可能犯罪。\n\n请注意：数据里可能存在重边（起点和终点相同的边）。\n\n题目中所说的“可能犯罪的牛”指的是在 $M$ 秒内能从照片内的位置到达 $1$ 号草地的牛。", "inputFormat": "第 $1$ 行：四个以空格分隔的整数：$F,P,C$ 和 $M$。\n\n第 $2$ 行至 $P+1$ 行：三个以空格分隔的整数，描述一个路径。连接 $F_1$ 和 $F_2$ 的路径需要 $T$ 秒。\n\n第 $P+2$ 行至 $P+C+1$ 行：每行一个整数，是一头牛的位置。", "outputFormat": "第 $1$ 行输出嫌疑犯的数目，接下来每一行输出一只嫌疑犯的编号，按编号从小到大排序。", "hint": "#### 数据约定\n\n对于 $100\\%$ 的数据：$1 \\le M \\le 7\\times 10^4$，$1 \\le C \\le 100$，$1 \\le P \\le 1000$，$1 \\le F \\le 500$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO05MAR] Checking an Alibi 不在场的证明", "background": null, "description": "谷仓里发现谷物被盗！FJ 正试图从 $C$ 只奶牛里找出那个偷谷物的罪犯。幸运的是，一个恰好路过的卫星拍下谷物被盗前 $M$ 秒的农场的图片。这样约翰就能通过牛们的位置来判断谁有足够的时间来盗窃谷物。\n\n约翰农场有 $F$ 片草地，标号 $1$ 到 $F$，还有 $P$ 条双向路连接着它们。通过这些路需要的时间在 $1$ 到 $7\\times 10^4$ 秒的范围内。草地 $1$ 上建有那个被盗的谷仓。给出农场地图，以及卫星照片里每只牛所在的位置，请判断哪些牛有可能犯罪。\n\n请注意：数据里可能存在重边（起点和终点相同的边）。\n\n题目中所说的“可能犯罪的牛”指的是在 $M$ 秒内能从照片内的位置到达 $1$ 号草地的牛。", "inputFormat": "第 $1$ 行：四个以空格分隔的整数：$F,P,C$ 和 $M$。\n\n第 $2$ 行至 $P+1$ 行：三个以空格分隔的整数，描述一个路径。连接 $F_1$ 和 $F_2$ 的路径需要 $T$ 秒。\n\n第 $P+2$ 行至 $P+C+1$ 行：每行一个整数，是一头牛的位置。", "outputFormat": "第 $1$ 行输出嫌疑犯的数目，接下来每一行输出一只嫌疑犯的编号，按编号从小到大排序。", "hint": "#### 数据约定\n\n对于 $100\\%$ 的数据：$1 \\le M \\le 7\\times 10^4$，$1 \\le C \\le 100$，$1 \\le P \\le 1000$，$1 \\le F \\le 500$。", "locale": "zh-CN"}}}
{"pid": "P6771", "type": "P", "difficulty": 3, "samples": [["3\n7 40 3\n5 23 8\n2 52 6\n", "48\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "贪心", "2005", "USACO"], "title": "[USACO05MAR] Space Elevator 太空电梯", "background": "", "description": "奶牛们要去太空了！它们打算用方块建造一座太空电梯。现在它们有 $N$ 种方块，第 $i$ 种方块有一个特定的高度 $h_i$，一定的数量 $c_i$。为了防止宇宙射线破坏方块，第 $i$ 种方块的任何部分不能超过高度 $a_i$。\\\n请用这些方块堆出最高的太空电梯。", "inputFormat": "第一行，一个整数 $N$；\\\n第二行到 $N+1$ 行，第 $i+1$ 行三个整数 $h_i,a_i,c_i$，数字之间用空格分隔。", "outputFormat": "共一行，一个整数，为太空电梯的高度。", "hint": "对于 $100\\%$ 的数据：$1\\le N\\le 400$，$1\\le h_i \\le 100$，$1\\le c_i\\le 10$，$1\\le a_i\\le 4\\times 10^4$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USACO05MAR] Space Elevator 太空电梯", "background": "", "description": "奶牛们要去太空了！它们打算用方块建造一座太空电梯。现在它们有 $N$ 种方块，第 $i$ 种方块有一个特定的高度 $h_i$，一定的数量 $c_i$。为了防止宇宙射线破坏方块，第 $i$ 种方块的任何部分不能超过高度 $a_i$。\\\n请用这些方块堆出最高的太空电梯。", "inputFormat": "第一行，一个整数 $N$；\\\n第二行到 $N+1$ 行，第 $i+1$ 行三个整数 $h_i,a_i,c_i$，数字之间用空格分隔。", "outputFormat": "共一行，一个整数，为太空电梯的高度。", "hint": "对于 $100\\%$ 的数据：$1\\le N\\le 400$，$1\\le h_i \\le 100$，$1\\le c_i\\le 10$，$1\\le a_i\\le 4\\times 10^4$。", "locale": "zh-CN"}}}
{"pid": "P6772", "type": "P", "difficulty": 6, "samples": [["3 4 11 0\n1 3 4\n1 2 1\n2 1 3\n2 3 2\n3 1 4", "13"], ["4 8 16 3\n3 1 2 4\n1 2 1\n1 3 1\n1 3 2\n3 4 3\n2 3 2\n3 2 1\n4 2 1\n4 1 5\n3 3 5\n1 2 5\n5 4 20", "39"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "2020", "NOI", "O2优化", "动态规划优化", "矩阵加速"], "title": "[NOI2020] 美食家", "background": "", "description": "坐落在 Bzeroth 大陆上的精灵王国击退地灾军团的入侵后，经过十余年的休养生息，重新成为了一片欣欣向荣的乐土，吸引着八方游客。小 W 是一位游历过世界各地的著名美食家，现在也慕名来到了精灵王国。\n\n精灵王国共有 $n$ 座城市，城市从 $1$ 到 $n$ 编号，其中城市 $i$ 的美食能为小 W 提供 $c_i$ 的愉悦值。精灵王国的城市通过 $m$ 条**单向道路**连接，道路从 $1$ 到 $m$ 编号，其中道路 $i$ 的起点为城市 $u_i$ ，终点为城市 $v_i$，沿它通行需要花费 $w_i$ 天。也就是说，若小 W 在第 $d$ 天从城市 $u_i$ 沿道路 $i$ 通行，那么他会在第 $d + w_i$ 天到达城市 $v_i$。\n\n小 W 计划在精灵王国进行一场为期 $T$ 天的旅行，更具体地：他会在第 $0$ 天从城市 $1$ 出发，经过 $T$ 天的旅行，最终在**恰好第 $T$ 天**回到城市 $1$ 结束旅行。由于小 W 是一位美食家，每当他到达一座城市时（包括第 $0$ 天和第 $T$ 天的城市 $1$），他都会品尝该城市的美食并获得其所提供的愉悦值，若小 W 多次到达同一座城市，他将**获得多次愉悦值**。注意旅行途中小 W **不能在任何城市停留**，即当他到达一座城市且还未结束旅行时，他当天必须立即从该城市出发前往其他城市。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2svum9ge.png)\n\n对于上图，小 W 一种为期 $11$ 天的可行旅游方案为 $1 \\to 2 \\to 1 \\to 2 \\to 3 \\to 1$：\n- 第 $0$ 天，小 W 从城市 $1$ 开始旅行，获得愉悦值 $1$ 并向城市 $2$ 出发。\n- 第 $1$ 天，小 W 到达城市 $2$，获得愉悦值 $3$ 并向城市 $1$ 出发。\n- 第 $4$ 天，小 W 到达城市 $1$，获得愉悦值 $1$ 并向城市 $2$ 出发。\n- 第 $5$ 天，小 W 到达城市 $2$，获得愉悦值 $3$ 并向城市 $3$ 出发。\n- 第 $7$ 天，小 W 到达城市 $3$，获得愉悦值 $4$ 并向城市 $1$ 出发。\n- 第 $11$ 天，小 W 到达城市 $1$，获得愉悦值 $1$ 并结束旅行。\n- 小 W 在该旅行中获得的愉悦值之和为 $13$。\n\n此外，精灵王国会在**不同**的时间举办 $k$ 次美食节。具体来说，第 $i$ 次美食节将于第 $t_i$ 天在城市 $x_i$ 举办，若小 W 第 $t_i$ 天时恰好在城市 $x_i$，那么他在品尝城市 $x_i$ 的美食时会**额外得到** $y_i$ 的愉悦值。现在小 W 想请作为精灵王国接待使者的你帮他算出，他在旅行中能获得的愉悦值之和的**最大值**。", "inputFormat": "从标准输入中读入数据。\n\n第一行四个整数 $n, m, T, k$，依次表示城市数、道路条数、旅行天数与美食节次数。\n\n第二行 $n$ 个整数 $c_i$，表示每座城市的美食所能提供的愉悦值。接下来 $m$ 行每行三个整数 $u_i, v_i, w_i$，依次表示每条道路的起点、终点与通行天数。\n\n最后 $k$ 行每行三个整数 $t_i, x_i, y_i$，依次表示每次美食节的举办时间、举办城市与提供的额外愉悦值。\n\n本题中数据保证：\n- 对所有 $1 \\leq i \\leq m$，有 $u_i\\neq v_i$。但数据中可能存在路线重复的单向道路，即可能存在 $1 \\leq i < j \\leq m，使得 u_i = u_j, v_i = v_j$。\n- 对每座城市都满足：至少存在一条以该该城市为起点的单向道路。\n- 每次美食节的举办时间 $t_i$ 互不相同。", "outputFormat": "输出到标准输出中。\n\n仅一行一个整数，表示小 W 通过旅行能获得的愉悦值之和的最大值。\n\n**若小 W 无法在第 $T$ 天回到城市 $1$，则输出 $-1$**。", "hint": "#### 样例 1 解释\n\n该样例为题目描述中的例子，最优旅行方案见题目描述。\n\n#### 样例 2 解释\n\n最优方案为 $1 \\to 3 \\to 4 \\to 2 \\to 3 \\to 4 \\to 1$。\n- 第 $0$ 天，小 W 从城市 $1$ 开始旅行，获得愉悦值 $3$ 并沿道路 $3$ 通行。\n- 第 $2$ 天，小 W 到达城市 $3$，获得愉悦值 $2$ 并沿道路 $4$ 通行。\n- 第 $5$ 天，小 W 到达城市 $4$，由于美食节获得愉悦值 $20 + 4$ 并沿道路 $7$ 通行。\n- 第 $6$ 天，小 W 到达城市 $2$，获得愉悦值 $1$ 并沿道路 $5$ 通行。\n- 第 $8$ 天，小 W 到达城市 $3$，获得愉悦值 $2$ 并沿道路 $4$ 通行。\n- 第 $11$ 天，小 W 到达城市 $4$，获得愉悦值 $4$ 并沿道路 $8$ 通行。\n- 第 $16$ 天，小 W 到达城市 $1$，获得愉悦值 $3$ 并结束旅行。\n- 小 W 获得的愉悦值之和为 $39$。\n\n#### 样例 3\n\n见选手目录下的 delicacy/delicacy3.in 与 delicacy/delicacy3.ans。\n\n该样例满足 $k=0$\n\n---\n\n### 测试点约束\n\n对于所有测试点：\n\n$1 \\leq n \\leq 50$，$n \\leq m \\leq 501$，$0 \\leq k \\leq 200$，$1 \\leq t_i \\leq T \\leq 10^9$。\n\n$1 \\leq w_i \\leq 5$，$1 \\leq c_i \\leq 52501$，$1 \\leq u_i, v_i, x_i \\leq n$，$1 \\leq y_i \\leq 10^9$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 |  $n$ |  $m$ |  $T$ | 特殊限制 |\n| :-: | :-:| :-: |:-:| :-:|\n|  $1\\sim 4$ |  $\\le 5$ |  $\\le 50$ |  $\\le 5$ | 无 |\n|  $5\\sim 8$ |  $\\le 50$ |  $\\le 50$ |  $\\le 52501$ | 无 |\n|  $9\\sim 10$ |  $\\le 50$ |  $\\le 50$ |  $\\le 10^9$ | A | \n|  $11\\sim 13$ |  $\\le 50$ |  $\\le 50$ |  $\\le 10^9$ |  $k=0$ |\n|  $14\\sim 15$ |  $\\le 50$ |  $\\le 50$ |  $\\le 10^9$ |  $k\\le 10$ |\n|  $16\\sim 17$ |  $\\le 50$ |  $\\le 50$ |  $\\le 10^9$ | 无 |\n|  $18\\sim 20$ |  $\\le 50$ |  $\\le 501$ |  $\\le 10^9$ | 无 |\n\n特殊限制 A：$n = m$ 且 $u_i = i,v_i = (i \\bmod n) + 1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI2020] 美食家", "background": "", "description": "坐落在 Bzeroth 大陆上的精灵王国击退地灾军团的入侵后，经过十余年的休养生息，重新成为了一片欣欣向荣的乐土，吸引着八方游客。小 W 是一位游历过世界各地的著名美食家，现在也慕名来到了精灵王国。\n\n精灵王国共有 $n$ 座城市，城市从 $1$ 到 $n$ 编号，其中城市 $i$ 的美食能为小 W 提供 $c_i$ 的愉悦值。精灵王国的城市通过 $m$ 条**单向道路**连接，道路从 $1$ 到 $m$ 编号，其中道路 $i$ 的起点为城市 $u_i$ ，终点为城市 $v_i$，沿它通行需要花费 $w_i$ 天。也就是说，若小 W 在第 $d$ 天从城市 $u_i$ 沿道路 $i$ 通行，那么他会在第 $d + w_i$ 天到达城市 $v_i$。\n\n小 W 计划在精灵王国进行一场为期 $T$ 天的旅行，更具体地：他会在第 $0$ 天从城市 $1$ 出发，经过 $T$ 天的旅行，最终在**恰好第 $T$ 天**回到城市 $1$ 结束旅行。由于小 W 是一位美食家，每当他到达一座城市时（包括第 $0$ 天和第 $T$ 天的城市 $1$），他都会品尝该城市的美食并获得其所提供的愉悦值，若小 W 多次到达同一座城市，他将**获得多次愉悦值**。注意旅行途中小 W **不能在任何城市停留**，即当他到达一座城市且还未结束旅行时，他当天必须立即从该城市出发前往其他城市。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2svum9ge.png)\n\n对于上图，小 W 一种为期 $11$ 天的可行旅游方案为 $1 \\to 2 \\to 1 \\to 2 \\to 3 \\to 1$：\n- 第 $0$ 天，小 W 从城市 $1$ 开始旅行，获得愉悦值 $1$ 并向城市 $2$ 出发。\n- 第 $1$ 天，小 W 到达城市 $2$，获得愉悦值 $3$ 并向城市 $1$ 出发。\n- 第 $4$ 天，小 W 到达城市 $1$，获得愉悦值 $1$ 并向城市 $2$ 出发。\n- 第 $5$ 天，小 W 到达城市 $2$，获得愉悦值 $3$ 并向城市 $3$ 出发。\n- 第 $7$ 天，小 W 到达城市 $3$，获得愉悦值 $4$ 并向城市 $1$ 出发。\n- 第 $11$ 天，小 W 到达城市 $1$，获得愉悦值 $1$ 并结束旅行。\n- 小 W 在该旅行中获得的愉悦值之和为 $13$。\n\n此外，精灵王国会在**不同**的时间举办 $k$ 次美食节。具体来说，第 $i$ 次美食节将于第 $t_i$ 天在城市 $x_i$ 举办，若小 W 第 $t_i$ 天时恰好在城市 $x_i$，那么他在品尝城市 $x_i$ 的美食时会**额外得到** $y_i$ 的愉悦值。现在小 W 想请作为精灵王国接待使者的你帮他算出，他在旅行中能获得的愉悦值之和的**最大值**。", "inputFormat": "从标准输入中读入数据。\n\n第一行四个整数 $n, m, T, k$，依次表示城市数、道路条数、旅行天数与美食节次数。\n\n第二行 $n$ 个整数 $c_i$，表示每座城市的美食所能提供的愉悦值。接下来 $m$ 行每行三个整数 $u_i, v_i, w_i$，依次表示每条道路的起点、终点与通行天数。\n\n最后 $k$ 行每行三个整数 $t_i, x_i, y_i$，依次表示每次美食节的举办时间、举办城市与提供的额外愉悦值。\n\n本题中数据保证：\n- 对所有 $1 \\leq i \\leq m$，有 $u_i\\neq v_i$。但数据中可能存在路线重复的单向道路，即可能存在 $1 \\leq i < j \\leq m，使得 u_i = u_j, v_i = v_j$。\n- 对每座城市都满足：至少存在一条以该该城市为起点的单向道路。\n- 每次美食节的举办时间 $t_i$ 互不相同。", "outputFormat": "输出到标准输出中。\n\n仅一行一个整数，表示小 W 通过旅行能获得的愉悦值之和的最大值。\n\n**若小 W 无法在第 $T$ 天回到城市 $1$，则输出 $-1$**。", "hint": "#### 样例 1 解释\n\n该样例为题目描述中的例子，最优旅行方案见题目描述。\n\n#### 样例 2 解释\n\n最优方案为 $1 \\to 3 \\to 4 \\to 2 \\to 3 \\to 4 \\to 1$。\n- 第 $0$ 天，小 W 从城市 $1$ 开始旅行，获得愉悦值 $3$ 并沿道路 $3$ 通行。\n- 第 $2$ 天，小 W 到达城市 $3$，获得愉悦值 $2$ 并沿道路 $4$ 通行。\n- 第 $5$ 天，小 W 到达城市 $4$，由于美食节获得愉悦值 $20 + 4$ 并沿道路 $7$ 通行。\n- 第 $6$ 天，小 W 到达城市 $2$，获得愉悦值 $1$ 并沿道路 $5$ 通行。\n- 第 $8$ 天，小 W 到达城市 $3$，获得愉悦值 $2$ 并沿道路 $4$ 通行。\n- 第 $11$ 天，小 W 到达城市 $4$，获得愉悦值 $4$ 并沿道路 $8$ 通行。\n- 第 $16$ 天，小 W 到达城市 $1$，获得愉悦值 $3$ 并结束旅行。\n- 小 W 获得的愉悦值之和为 $39$。\n\n#### 样例 3\n\n见选手目录下的 delicacy/delicacy3.in 与 delicacy/delicacy3.ans。\n\n该样例满足 $k=0$\n\n---\n\n### 测试点约束\n\n对于所有测试点：\n\n$1 \\leq n \\leq 50$，$n \\leq m \\leq 501$，$0 \\leq k \\leq 200$，$1 \\leq t_i \\leq T \\leq 10^9$。\n\n$1 \\leq w_i \\leq 5$，$1 \\leq c_i \\leq 52501$，$1 \\leq u_i, v_i, x_i \\leq n$，$1 \\leq y_i \\leq 10^9$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 |  $n$ |  $m$ |  $T$ | 特殊限制 |\n| :-: | :-:| :-: |:-:| :-:|\n|  $1\\sim 4$ |  $\\le 5$ |  $\\le 50$ |  $\\le 5$ | 无 |\n|  $5\\sim 8$ |  $\\le 50$ |  $\\le 50$ |  $\\le 52501$ | 无 |\n|  $9\\sim 10$ |  $\\le 50$ |  $\\le 50$ |  $\\le 10^9$ | A | \n|  $11\\sim 13$ |  $\\le 50$ |  $\\le 50$ |  $\\le 10^9$ |  $k=0$ |\n|  $14\\sim 15$ |  $\\le 50$ |  $\\le 50$ |  $\\le 10^9$ |  $k\\le 10$ |\n|  $16\\sim 17$ |  $\\le 50$ |  $\\le 50$ |  $\\le 10^9$ | 无 |\n|  $18\\sim 20$ |  $\\le 50$ |  $\\le 501$ |  $\\le 10^9$ | 无 |\n\n特殊限制 A：$n = m$ 且 $u_i = i,v_i = (i \\bmod n) + 1$。", "locale": "zh-CN"}}}
{"pid": "P6773", "type": "P", "difficulty": 7, "samples": [["5\n1 2\n2 3\n3 4\n3 5\n2\n1 3\n2 5", "10"], ["15\n2 1\n3 1\n4 3\n5 2\n6 3\n7 6\n8 4\n9 5\n10 7\n11 5\n12 10\n13 3\n14 9\n15 8\n6\n3 12\n5 11\n2 5\n3 13\n8 15\n1 13", "960"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2020", "NOI", "O2优化"], "title": "[NOI2020] 命运", "background": "", "description": "**提示**：我们在题目描述的最后一段提供了一份简要的、形式化描述的题面。\n\n在遥远的未来，物理学家终于发现了时间和因果的自然规律。即使在一个人出生前，我们也可以通过理论分析知晓他或她人生的一些信息，换言之，物理学允许我们从一定程度上“预言”一个人的“命运”。\n\n简单来说，一个人的命运是一棵由时间点构成的有根树 $T$：树的根结点代表着出生，而叶结点代表着死亡。每个非叶结点 $u$ 都有一个或多个孩子 $v_1, v_2,\\dots , v_{c_u}$，表示这个人在 $u$ 所代表的时间点做出的 $c_u$ 个不同的选择可以导向的不同的可能性。形式化的，一个选择就是树上的一条边 $(u, v_i)$，其中 $u$ 是 $v_i$ 的父结点。\n\n一个人的一生是从出生（即根结点）到死亡（即某一个叶子结点）的一条不经过重复结点的路径，这条路径上任何一个包含至少一条边的子路径都是这个人的一段**人生经历**，而他或她以所有可能的方式度过一生，从而拥有的所有人生经历，都被称为**潜在的人生经历**。换言之，所有潜在的人生经历就是所有 $u$ 到 $v$ 的路径，满足 $u, v \\in T$，$u \\neq v$，并且 $u$ 是 $v$ 的祖先。在数学上，这样一个潜在的人生经历被记作有序对 $(u, v)$，树 $T$ 所有潜在的人生经历的集合记作 $\\mathcal P_T$。\n\n物理理论不仅允许我们观测代表命运的树，还能让我们分析一些潜在的人生经历是否是“重要”的。一个人所作出的每一个选择——即树上的每一条边——都可能是**重要**或**不重要**的。一段潜在的人生经历被称为重要的，当且仅当其对应的路径上存在一条边是重要的。我们可以观测到一些潜在的人生经历是重要的：换言之，我们可以观测得到一个集合 $\\mathcal Q \\subseteq \\mathcal P_T$，满足其中的所有潜在的人生经历 $(u, v) \\in \\mathcal Q$ 都是重要的。\n\n树 $T$ 的形态早已被计算确定，集合 $\\mathcal Q$ 也早已被观测得到，一个人命运的不确定性已经大大降低了。但不确定性仍然是巨大的——来计算一下吧，对于给定的树 $T$ 和集合 $\\mathcal Q$，存在多少种不同的方案确定每条边是否是重要的，使之满足所观测到的 $\\mathcal Q$ 所对应的限制：即对于任意 $(u, v) \\in \\mathcal Q$，都存在一条 $u$ 到 $v$ 路径上的边被确定为重要的。\n\n**形式化的**：给定一棵树 $T = (V, E)$ 和点对集合 $\\mathcal Q \\subseteq V \\times V$ ，满足对于所有 $(u, v) \\in \\mathcal Q$，都有 $u \\neq v$，并且 $u$ 是 $v$ 在树 $T$ 上的祖先。其中 $V$ 和 $E$ 分别代表树 $T$ 的结点集和边集。求有多少个不同的函数 $f$ : $E \\to \\{0, 1\\}$（将每条边 $e \\in E$ 的 $f(e)$ 值置为 $0$ 或 $1$），满足对于任何 $(u, v) \\in \\mathcal Q$，都存在 $u$ 到 $v$ 路径上的一条边 $e$ 使得 $f(e) = 1$。由于答案可能非常大，你只需要输出结果对 $998,244,353$（一个素数）取模的结果。\n", "inputFormat": "从标准输入读入数据。\n\n第一行包含一个正整数 $n$，表示树 $T$ 的大小，树上结点从 $1$ 到 $n$ 编号，$1$ 号结点为根结点；\n\n接下来 $n - 1$ 行每行包含空格隔开的两个数 $x_i, y_i$，满足 $1 \\leq x_i, y_i \\leq n$，表示树上的结点 $x_i$ 和 $y_i$ 之间存在一条边，但并不保证这条边的方向；\n\n接下来一行包含一个非负整数 $m$，表示所观测得到信息的条数。\n\n接下来 $m$ 行每行包含空格隔开的两个数 $u_i, v_i$，表示 $(u_i, v_i) \\in \\mathcal Q$。**请注意**：输入数据可能包含重复的信息，换言之可能存在 $i \\neq j$，满足 $u_i = u_j$ 且 $v_i = v_j$。\n\n输入数据规模和限制参见本题末尾的表格。", "outputFormat": "输出到标准输出中。\n\n输出仅一行一个整数，表示方案数对 $998, 244, 353$ 取模的结果。", "hint": "#### 样例 1 解释\n\n共有 $16$ 种方案，其中不满足题意的方案有以下 $6$ 种：\n\n- $(1, 2),(2, 3),(3, 5)$ 确定为不重要，$(3, 4)$ 确定为重要：集合 $\\mathcal Q$ 中没有限制被满足。\n- $(1, 2),(2, 3),(3, 4),(3, 5)$ 确定为不重要：集合 $\\mathcal Q$ 中没有限制被满足。\n- $(1, 2),(2, 3)$ 确定为不重要，$(3, 4),(3, 5)$ 确定为重要：集合 $\\mathcal Q$ 中 $(1, 3)$ 没被满足。\n- $(1, 2),(2, 3),(3, 4)$ 确定为不重要，$(3, 5)$ 确定为重要：集合 $\\mathcal Q$ 中 $(1, 3)$ 没被满足。\n- $(2, 3),(3, 5)$ 确定为不重要，$(1, 2),(3, 4)$ 确定为重要：集合 $\\mathcal Q$ 中 $(2, 5)$ 没被满足。\n- $(2, 3),(3, 4),(3, 5)$ 确定为不重要，$(1, 2)$ 确定为重要：集合 $\\mathcal Q$ 中 $(2, 5)$ 没被满足。\n- 其他方案下，集合 $\\mathcal Q$ 中的限制都被满足了。\n\n\n#### 样例 3\n\n见选手目录下的 destiny/destiny3.in 与 destiny/destiny3.ans。\n\n#### 样例 4\n\n见选手目录下的 destiny/destiny4.in 与 destiny/destiny4.ans。\n\n| 测试点编号 |  $n$ |  $m$ |  $T$ 为完全二叉树 |\n| :-: | :-:| :-: |:-:|\n|  $1\\sim 4$ |  $\\le 10$ |  $\\le 10$ | 否 |\n|  $5$ |  $\\le 500$ |  $\\le 15$ | 否 |\n|  $6$ |  $\\le 10^4$ |  $\\le 10$ | 否 | \n|  $7$ |  $\\le 10^5$ |  $\\le 16$ | 否 |\n|  $8$ |  $\\le 5\\times 10^5$ |  $\\le 16$ | 否 |\n|  $9$ |  $\\le 10^5$ |  $\\le 22$ | 否 |\n|  $10$ |  $\\le 5\\times 10^5$ |  $\\le 22$ | 否 |\n|  $11$ |  $\\le 600$ |  $\\le 600$ | 否 |\n|  $12$ |  $\\le 10^3$ |  $\\le 10^3$ | 否 |\n|  $13\\sim 14$ |  $\\le 2\\times 10^3$ |  $\\le 5\\times 10^5$ | 否 |\n|  $15\\sim 16$ |  $\\le 5\\times 10^5$ |  $\\le 2\\times 10^3$ | 否 |\n|  $17\\sim 18$ |  $\\le 10^5$ |  $\\le 10^5$ | 是 |\n|  $19$ |  $\\le 5\\times 10^4$ |  $\\le 10^5$ | 否 |\n|  $20$ |  $\\le 8\\times 10^4$ |  $\\le 10^5$ | 否 |\n|  $21\\sim 22$ |  $\\le 10^5$ |  $\\le 5\\times 10^5$ | 否 |\n|  $23\\sim 25$ |  $\\le 5\\times 10^5$ |  $\\le 5\\times 10^5$ | 否 |\n\n---\n\n### 测试点约束\n\n**全部数据满足**：$n \\leq 5 \\times 10^5$，$m \\leq 5 \\times 10^5$。输入构成一棵树，并且对于 $1 \\leq i \\leq m$，$u_i$ 始终为 $v_i$ 的祖先结点。\n\n**完全二叉树**：在本题中，每个非叶结点都有左右子结点，且所有叶子结点深度相同的树称为满二叉树；将满二叉树中的结点按照从上到下、从左向右的顺序编号，编号最小的若干个结点形成的树称为完全二叉树。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI2020] 命运", "background": "", "description": "**提示**：我们在题目描述的最后一段提供了一份简要的、形式化描述的题面。\n\n在遥远的未来，物理学家终于发现了时间和因果的自然规律。即使在一个人出生前，我们也可以通过理论分析知晓他或她人生的一些信息，换言之，物理学允许我们从一定程度上“预言”一个人的“命运”。\n\n简单来说，一个人的命运是一棵由时间点构成的有根树 $T$：树的根结点代表着出生，而叶结点代表着死亡。每个非叶结点 $u$ 都有一个或多个孩子 $v_1, v_2,\\dots , v_{c_u}$，表示这个人在 $u$ 所代表的时间点做出的 $c_u$ 个不同的选择可以导向的不同的可能性。形式化的，一个选择就是树上的一条边 $(u, v_i)$，其中 $u$ 是 $v_i$ 的父结点。\n\n一个人的一生是从出生（即根结点）到死亡（即某一个叶子结点）的一条不经过重复结点的路径，这条路径上任何一个包含至少一条边的子路径都是这个人的一段**人生经历**，而他或她以所有可能的方式度过一生，从而拥有的所有人生经历，都被称为**潜在的人生经历**。换言之，所有潜在的人生经历就是所有 $u$ 到 $v$ 的路径，满足 $u, v \\in T$，$u \\neq v$，并且 $u$ 是 $v$ 的祖先。在数学上，这样一个潜在的人生经历被记作有序对 $(u, v)$，树 $T$ 所有潜在的人生经历的集合记作 $\\mathcal P_T$。\n\n物理理论不仅允许我们观测代表命运的树，还能让我们分析一些潜在的人生经历是否是“重要”的。一个人所作出的每一个选择——即树上的每一条边——都可能是**重要**或**不重要**的。一段潜在的人生经历被称为重要的，当且仅当其对应的路径上存在一条边是重要的。我们可以观测到一些潜在的人生经历是重要的：换言之，我们可以观测得到一个集合 $\\mathcal Q \\subseteq \\mathcal P_T$，满足其中的所有潜在的人生经历 $(u, v) \\in \\mathcal Q$ 都是重要的。\n\n树 $T$ 的形态早已被计算确定，集合 $\\mathcal Q$ 也早已被观测得到，一个人命运的不确定性已经大大降低了。但不确定性仍然是巨大的——来计算一下吧，对于给定的树 $T$ 和集合 $\\mathcal Q$，存在多少种不同的方案确定每条边是否是重要的，使之满足所观测到的 $\\mathcal Q$ 所对应的限制：即对于任意 $(u, v) \\in \\mathcal Q$，都存在一条 $u$ 到 $v$ 路径上的边被确定为重要的。\n\n**形式化的**：给定一棵树 $T = (V, E)$ 和点对集合 $\\mathcal Q \\subseteq V \\times V$ ，满足对于所有 $(u, v) \\in \\mathcal Q$，都有 $u \\neq v$，并且 $u$ 是 $v$ 在树 $T$ 上的祖先。其中 $V$ 和 $E$ 分别代表树 $T$ 的结点集和边集。求有多少个不同的函数 $f$ : $E \\to \\{0, 1\\}$（将每条边 $e \\in E$ 的 $f(e)$ 值置为 $0$ 或 $1$），满足对于任何 $(u, v) \\in \\mathcal Q$，都存在 $u$ 到 $v$ 路径上的一条边 $e$ 使得 $f(e) = 1$。由于答案可能非常大，你只需要输出结果对 $998,244,353$（一个素数）取模的结果。\n", "inputFormat": "从标准输入读入数据。\n\n第一行包含一个正整数 $n$，表示树 $T$ 的大小，树上结点从 $1$ 到 $n$ 编号，$1$ 号结点为根结点；\n\n接下来 $n - 1$ 行每行包含空格隔开的两个数 $x_i, y_i$，满足 $1 \\leq x_i, y_i \\leq n$，表示树上的结点 $x_i$ 和 $y_i$ 之间存在一条边，但并不保证这条边的方向；\n\n接下来一行包含一个非负整数 $m$，表示所观测得到信息的条数。\n\n接下来 $m$ 行每行包含空格隔开的两个数 $u_i, v_i$，表示 $(u_i, v_i) \\in \\mathcal Q$。**请注意**：输入数据可能包含重复的信息，换言之可能存在 $i \\neq j$，满足 $u_i = u_j$ 且 $v_i = v_j$。\n\n输入数据规模和限制参见本题末尾的表格。", "outputFormat": "输出到标准输出中。\n\n输出仅一行一个整数，表示方案数对 $998, 244, 353$ 取模的结果。", "hint": "#### 样例 1 解释\n\n共有 $16$ 种方案，其中不满足题意的方案有以下 $6$ 种：\n\n- $(1, 2),(2, 3),(3, 5)$ 确定为不重要，$(3, 4)$ 确定为重要：集合 $\\mathcal Q$ 中没有限制被满足。\n- $(1, 2),(2, 3),(3, 4),(3, 5)$ 确定为不重要：集合 $\\mathcal Q$ 中没有限制被满足。\n- $(1, 2),(2, 3)$ 确定为不重要，$(3, 4),(3, 5)$ 确定为重要：集合 $\\mathcal Q$ 中 $(1, 3)$ 没被满足。\n- $(1, 2),(2, 3),(3, 4)$ 确定为不重要，$(3, 5)$ 确定为重要：集合 $\\mathcal Q$ 中 $(1, 3)$ 没被满足。\n- $(2, 3),(3, 5)$ 确定为不重要，$(1, 2),(3, 4)$ 确定为重要：集合 $\\mathcal Q$ 中 $(2, 5)$ 没被满足。\n- $(2, 3),(3, 4),(3, 5)$ 确定为不重要，$(1, 2)$ 确定为重要：集合 $\\mathcal Q$ 中 $(2, 5)$ 没被满足。\n- 其他方案下，集合 $\\mathcal Q$ 中的限制都被满足了。\n\n\n#### 样例 3\n\n见选手目录下的 destiny/destiny3.in 与 destiny/destiny3.ans。\n\n#### 样例 4\n\n见选手目录下的 destiny/destiny4.in 与 destiny/destiny4.ans。\n\n| 测试点编号 |  $n$ |  $m$ |  $T$ 为完全二叉树 |\n| :-: | :-:| :-: |:-:|\n|  $1\\sim 4$ |  $\\le 10$ |  $\\le 10$ | 否 |\n|  $5$ |  $\\le 500$ |  $\\le 15$ | 否 |\n|  $6$ |  $\\le 10^4$ |  $\\le 10$ | 否 | \n|  $7$ |  $\\le 10^5$ |  $\\le 16$ | 否 |\n|  $8$ |  $\\le 5\\times 10^5$ |  $\\le 16$ | 否 |\n|  $9$ |  $\\le 10^5$ |  $\\le 22$ | 否 |\n|  $10$ |  $\\le 5\\times 10^5$ |  $\\le 22$ | 否 |\n|  $11$ |  $\\le 600$ |  $\\le 600$ | 否 |\n|  $12$ |  $\\le 10^3$ |  $\\le 10^3$ | 否 |\n|  $13\\sim 14$ |  $\\le 2\\times 10^3$ |  $\\le 5\\times 10^5$ | 否 |\n|  $15\\sim 16$ |  $\\le 5\\times 10^5$ |  $\\le 2\\times 10^3$ | 否 |\n|  $17\\sim 18$ |  $\\le 10^5$ |  $\\le 10^5$ | 是 |\n|  $19$ |  $\\le 5\\times 10^4$ |  $\\le 10^5$ | 否 |\n|  $20$ |  $\\le 8\\times 10^4$ |  $\\le 10^5$ | 否 |\n|  $21\\sim 22$ |  $\\le 10^5$ |  $\\le 5\\times 10^5$ | 否 |\n|  $23\\sim 25$ |  $\\le 5\\times 10^5$ |  $\\le 5\\times 10^5$ | 否 |\n\n---\n\n### 测试点约束\n\n**全部数据满足**：$n \\leq 5 \\times 10^5$，$m \\leq 5 \\times 10^5$。输入构成一棵树，并且对于 $1 \\leq i \\leq m$，$u_i$ 始终为 $v_i$ 的祖先结点。\n\n**完全二叉树**：在本题中，每个非叶结点都有左右子结点，且所有叶子结点深度相同的树称为满二叉树；将满二叉树中的结点按照从上到下、从左向右的顺序编号，编号最小的若干个结点形成的树称为完全二叉树。\n", "locale": "zh-CN"}}}
{"pid": "P6774", "type": "P", "difficulty": 7, "samples": [["9 9\n9 8 7 6 2 4 5 3 1\n4 9 3 6\n2 9 1 8\n3 8 2 4\n3 9 2 7\n2 8 1 6\n1 9 1 9\n1 3 5 7\n2 3 3 3\n6 6 6 6", "1\n4\n2\n4\n4\n4\n0\n0\n0"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2020", "NOI", "O2优化"], "title": "[NOI2020] 时代的眼泪", "background": "", "description": "小 L 喜欢与智者交流讨论，而智者也经常为小 L 出些思考题。\n\n这天智者又为小 L 构思了一个问题。智者首先将时空抽象为了一个二维平面，进而将一个事件抽象为该平面上的一个点，将一个时代抽象为该平面上的一个矩形。\n\n为了方便，下面记 $(a, b) \\leq (c, d)$ 表示平面上两个点 $(a, b),(c, d)$ 满足 $a \\leq c$，$b \\leq d$。\n\n更具体地，智者给定了 $n$ 个**事件**，他们用平面上 $n$ 个不同的点 $\\{(x_i, y_i)\\}^n_{i=1}$ 来表示；智者还给定了 $m$ 个**时代**，每个时代用平面上一个矩形 $(r_{i,1}, r_{i,2}, c_{i,1}, c_{i,2})$ 来表示，其中 $(r_{i,1}, c_{i,1})$ 是矩形的左下角，$(r_{i,2}, c_{i,2})$ 是矩形的右上角，保证 $(r_{i,1}, c_{i,1}) \\leq (r_{i,2}, c_{i,2})$。我们称时代 $i$ 包含了事件 $j$ 当且仅当 $(r_{i,1}, c_{i,1}) \\leq (x_j, y_j ) \\leq (r_{i,2}, c_{i,2})$。\n\n智者认为若两个事件 $i, j$ 满足 $(x_i, y_i) \\leq (x_j, y_j)$，则这两个事件形成了一次**遗憾**。而对一个时代内包含的所有事件，它们所形成的遗憾被称为这个**时代的眼泪**，而形成的遗憾次数则称为该时代的眼泪的大小。现在智者想要小 L 计算**每个时代的眼泪的大小**。\n\n小 L 明白，如果他回答不了这个问题，他也将成为时代的眼泪，请你帮帮他。\n", "inputFormat": "从标准输入中读入数据。\n\n第一行两个整数 $n, m$，分别表示事件数与时代数。\n\n第二行 $n$ 个整数 $p_i$，其中第 $i$ 个数表示事件 $i$ 在平面上的坐标为 $(i, p_i)$。保证 $p_i$ 为一个 $1$ 到 $n$ 的排列。\n\n之后 $m$ 行，每行四个整数 $r_{i,1}, r_{i,2}, c_{i,1}, c_{i,2}$，表示每个时代对应的矩形。\n", "outputFormat": "输出到文件标准输出中。\n\n输出 $m$ 行，每行包含一个整数，第 $i$ 行输出第 $i$ 个时代的眼泪的大小。", "hint": "#### 样例 1 解释\n\n对于时代 $1$，包含的遗憾有 $(6, 7)$（即事件 $6$ 与事件 $7$ 形成的遗憾，下同）。\n\n对于时代 $2$，包含的遗憾有 $(5, 6),(6, 7),(5, 7),(5, 8)$。\n\n对于时代 $3$，包含的遗憾有 $(5, 6),(5, 8)$。\n\n对于时代 $4$，包含的遗憾有 $(5, 6),(6, 7),(5, 7),(5, 8)$。\n\n对于时代 $5$，包含的遗憾有 $(5, 6),(6, 7),(5, 7),(5, 8)$。\n\n对于时代 $6$，包含的遗憾有 $(5, 6),(6, 7),(5, 7),(5, 8)$。\n\n对于时代 $7, 8, 9$，它们均不包含任何遗憾。\n\n\n#### 样例 2\n\n见选手目录下的 tears/tears2.in 与 tears/tears2.ans。\n\n该样例满足特殊限制 A（具体限制见测试点约束）。\n\n\n#### 样例 3\n\n见选手目录下的 tears/tears3.in 与 tears/tears3.ans。\n\n该样例满足特殊限制 B（具体限制见测试点约束）。\n\n对于所有测试点：$1 \\leq n \\leq 10^5$，$1 \\leq m \\leq 2 \\times 10^5$，$1 \\leq r_{i,1}, r_{i,2}, c_{i,1}, c_{i,2} \\leq n$。\n\n---\n\n### 测试点约束\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 |  $n\\le $ |  $m\\le $ | 特殊限制 |\n| :-: | :-: | :-: | :-: |\n|  $1\\sim 3$ |  $10$ |  $10$ | 无 |\n|  $4$ |  $3\\times 10^3$ |  $3\\times 10^3$ | 无 |\n|  $5$ |  $4\\times 10^3$ |  $4\\times 10^3$ | 无 |\n|  $6$ |  $5\\times 10^3$ |  $5\\times 10^3$ | 无 |\n|  $7$ |  $2.5\\times 10^4$ |  $5\\times 10^4$ |  $\\text{A}$ |\n|  $8$ |  $5\\times 10^4$ |  $10^5$ |  $\\text{A}$ |\n|  $9$ |  $7.5\\times 10^4$ |  $1.5\\times 10^5$ |  $\\text{A}$ |\n|  $10$ |  $10^5$ |  $2\\times 10^5$ |  $\\text{A}$ |\n|  $11$ |  $6\\times 10^4$ |  $1.2\\times 10^5$ |  $\\text{B}$ |\n|  $12$ |  $8\\times 10^4$ |  $1.6\\times 10^5$ |  $\\text{B}$ |\n|  $13$ |  $10^5$ |  $2\\times 10^5$ |  $\\text{B}$ |\n|  $14$ |  $2\\times 10^4$ |  $4\\times 10^4$ | 无 |\n|  $15$ |  $3\\times 10^4$ |  $6\\times 10^4$ | 无 |\n|  $16$ |  $4\\times 10^4$ |  $8\\times 10^4$ | 无 |\n|  $17$ |  $5\\times 10^4$ |  $10^5$ | 无 |\n|  $18$ |  $6\\times 10^4$ |  $1.2\\times 10^5$ | 无 |\n|  $19$ |  $7\\times 10^4$ |  $1.4\\times 10^5$ | 无 |\n|  $20\\sim 22$ |  $10^5$ |  $2\\times 10^5$ |  $\\text{C}$ |\n|  $23\\sim 25$ |  $10^5$ |  $2\\times 10^5$ | 无 |\n\n特殊限制 A：对于所有时代 $i$ 有 $c_{i,1} = 1, c_{i,2} = n$。\n\n特殊限制 B：任意两个不同时代所代表的矩形，它们要么是包含关系（一个矩形在另一个矩形内，边界允许重合），要么是相离关系（两矩形不包含共同点，边界不允许重合）。\n\n特殊限制 C：最多有 $50$ 对事件 $(i, j)(1 \\leq i < j \\leq n)$ 不满足 $(i, p_i) \\leq (j, p_j)$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI2020] 时代的眼泪", "background": "", "description": "小 L 喜欢与智者交流讨论，而智者也经常为小 L 出些思考题。\n\n这天智者又为小 L 构思了一个问题。智者首先将时空抽象为了一个二维平面，进而将一个事件抽象为该平面上的一个点，将一个时代抽象为该平面上的一个矩形。\n\n为了方便，下面记 $(a, b) \\leq (c, d)$ 表示平面上两个点 $(a, b),(c, d)$ 满足 $a \\leq c$，$b \\leq d$。\n\n更具体地，智者给定了 $n$ 个**事件**，他们用平面上 $n$ 个不同的点 $\\{(x_i, y_i)\\}^n_{i=1}$ 来表示；智者还给定了 $m$ 个**时代**，每个时代用平面上一个矩形 $(r_{i,1}, r_{i,2}, c_{i,1}, c_{i,2})$ 来表示，其中 $(r_{i,1}, c_{i,1})$ 是矩形的左下角，$(r_{i,2}, c_{i,2})$ 是矩形的右上角，保证 $(r_{i,1}, c_{i,1}) \\leq (r_{i,2}, c_{i,2})$。我们称时代 $i$ 包含了事件 $j$ 当且仅当 $(r_{i,1}, c_{i,1}) \\leq (x_j, y_j ) \\leq (r_{i,2}, c_{i,2})$。\n\n智者认为若两个事件 $i, j$ 满足 $(x_i, y_i) \\leq (x_j, y_j)$，则这两个事件形成了一次**遗憾**。而对一个时代内包含的所有事件，它们所形成的遗憾被称为这个**时代的眼泪**，而形成的遗憾次数则称为该时代的眼泪的大小。现在智者想要小 L 计算**每个时代的眼泪的大小**。\n\n小 L 明白，如果他回答不了这个问题，他也将成为时代的眼泪，请你帮帮他。\n", "inputFormat": "从标准输入中读入数据。\n\n第一行两个整数 $n, m$，分别表示事件数与时代数。\n\n第二行 $n$ 个整数 $p_i$，其中第 $i$ 个数表示事件 $i$ 在平面上的坐标为 $(i, p_i)$。保证 $p_i$ 为一个 $1$ 到 $n$ 的排列。\n\n之后 $m$ 行，每行四个整数 $r_{i,1}, r_{i,2}, c_{i,1}, c_{i,2}$，表示每个时代对应的矩形。\n", "outputFormat": "输出到文件标准输出中。\n\n输出 $m$ 行，每行包含一个整数，第 $i$ 行输出第 $i$ 个时代的眼泪的大小。", "hint": "#### 样例 1 解释\n\n对于时代 $1$，包含的遗憾有 $(6, 7)$（即事件 $6$ 与事件 $7$ 形成的遗憾，下同）。\n\n对于时代 $2$，包含的遗憾有 $(5, 6),(6, 7),(5, 7),(5, 8)$。\n\n对于时代 $3$，包含的遗憾有 $(5, 6),(5, 8)$。\n\n对于时代 $4$，包含的遗憾有 $(5, 6),(6, 7),(5, 7),(5, 8)$。\n\n对于时代 $5$，包含的遗憾有 $(5, 6),(6, 7),(5, 7),(5, 8)$。\n\n对于时代 $6$，包含的遗憾有 $(5, 6),(6, 7),(5, 7),(5, 8)$。\n\n对于时代 $7, 8, 9$，它们均不包含任何遗憾。\n\n\n#### 样例 2\n\n见选手目录下的 tears/tears2.in 与 tears/tears2.ans。\n\n该样例满足特殊限制 A（具体限制见测试点约束）。\n\n\n#### 样例 3\n\n见选手目录下的 tears/tears3.in 与 tears/tears3.ans。\n\n该样例满足特殊限制 B（具体限制见测试点约束）。\n\n对于所有测试点：$1 \\leq n \\leq 10^5$，$1 \\leq m \\leq 2 \\times 10^5$，$1 \\leq r_{i,1}, r_{i,2}, c_{i,1}, c_{i,2} \\leq n$。\n\n---\n\n### 测试点约束\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 |  $n\\le $ |  $m\\le $ | 特殊限制 |\n| :-: | :-: | :-: | :-: |\n|  $1\\sim 3$ |  $10$ |  $10$ | 无 |\n|  $4$ |  $3\\times 10^3$ |  $3\\times 10^3$ | 无 |\n|  $5$ |  $4\\times 10^3$ |  $4\\times 10^3$ | 无 |\n|  $6$ |  $5\\times 10^3$ |  $5\\times 10^3$ | 无 |\n|  $7$ |  $2.5\\times 10^4$ |  $5\\times 10^4$ |  $\\text{A}$ |\n|  $8$ |  $5\\times 10^4$ |  $10^5$ |  $\\text{A}$ |\n|  $9$ |  $7.5\\times 10^4$ |  $1.5\\times 10^5$ |  $\\text{A}$ |\n|  $10$ |  $10^5$ |  $2\\times 10^5$ |  $\\text{A}$ |\n|  $11$ |  $6\\times 10^4$ |  $1.2\\times 10^5$ |  $\\text{B}$ |\n|  $12$ |  $8\\times 10^4$ |  $1.6\\times 10^5$ |  $\\text{B}$ |\n|  $13$ |  $10^5$ |  $2\\times 10^5$ |  $\\text{B}$ |\n|  $14$ |  $2\\times 10^4$ |  $4\\times 10^4$ | 无 |\n|  $15$ |  $3\\times 10^4$ |  $6\\times 10^4$ | 无 |\n|  $16$ |  $4\\times 10^4$ |  $8\\times 10^4$ | 无 |\n|  $17$ |  $5\\times 10^4$ |  $10^5$ | 无 |\n|  $18$ |  $6\\times 10^4$ |  $1.2\\times 10^5$ | 无 |\n|  $19$ |  $7\\times 10^4$ |  $1.4\\times 10^5$ | 无 |\n|  $20\\sim 22$ |  $10^5$ |  $2\\times 10^5$ |  $\\text{C}$ |\n|  $23\\sim 25$ |  $10^5$ |  $2\\times 10^5$ | 无 |\n\n特殊限制 A：对于所有时代 $i$ 有 $c_{i,1} = 1, c_{i,2} = n$。\n\n特殊限制 B：任意两个不同时代所代表的矩形，它们要么是包含关系（一个矩形在另一个矩形内，边界允许重合），要么是相离关系（两矩形不包含共同点，边界不允许重合）。\n\n特殊限制 C：最多有 $50$ 对事件 $(i, j)(1 \\leq i < j \\leq n)$ 不满足 $(i, p_i) \\leq (j, p_j)$。", "locale": "zh-CN"}}}
{"pid": "P6775", "type": "P", "difficulty": 7, "samples": [["4\n1 1 10\n10\n4 3 100\n80 30 90 100\n5 3 1000\n200 400 500 900 1000\n6 4 100\n25 30 50 80 95 120", "1 10\n1 80 2 20\n2 10 3 90\n4 100\n-1\n1 5 5 95\n1 20 4 80\n2 30 6 70\n3 50 6 50"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2020", "NOI", "Special Judge", "O2优化"], "title": "[NOI2020] 制作菜品", "background": "", "description": "厨师准备给小朋友们制作 $m$ 道菜，每道菜均使用 $k$ 克原材料。为此，厨师购入了 $n$ 种原材料，原材料从 $1$ 到 $n$ 编号，第 $i$ 种原材料的质量为 $d_i$ 克。$n$ 种原材料的**质量之和恰好为 $m \\times k$ 克**，其中 $d_i$ 与 $k$ 都是**正整数**。\n\n制作菜品时，一种原材料可以被用于多道菜，但为了让菜品的味道更纯粹，厨师打算每道菜**至多使用 $2$ 种**原材料。现在请你判断是否存在一种满足要求的制作方案。更具体地，方案应满足下列要求：\n- 共做出 $m$ 道菜。\n- 每道菜至多使用 $2$ 种原材料。\n- 每道菜恰好使用 $k$ 克原材料。\n- 每道菜使用的每种原材料的质量都为正整数克。\n- $n$ 种原材料都被恰好用完。\n\n若存在满足要求的制作方案，你还应该给出一种具体的制作方案。", "inputFormat": "**本题单个测试点包含多组测试数据**。\n\n第一行一个整数 $T$ 表示数据组数。对于每组数据：\n- 第一行三个正整数 $n, m, k$ 分别表示原材料种数、需要制作的菜品道数、每道菜品需使用的原材料的质量。\n- 第二行 $n$ 个整数，第 $i$ 个整数表示第 $i$ 种原材料的质量 $d_i$。", "outputFormat": "对于每组测试数据：\n- **若不存在满足要求的制作方案，则输出一行一个整数 $-1$**;\n- 否则你需要输出 $m$ 行，每行表示一道菜品的制作方案，根据使用的原材料种数，格式为下列两种之一：\n  - 依次输出一行两个整数 $i$ 和 $x$，表示该道菜使用 $x$ 克第 $i$ 种原材料制作。你应保证 $1 \\leq i \\leq n$，$x = k$。\n  - 依次输出一行四个整数 $i$、$x$、$j$ 和 $y$，表示该道菜使用 $x$ 克第 $i$ 种原材料与 $y$ 克第 $j$ 种原材料制作。你应保证$1 \\leq i, j \\leq n$，$i \\not= j$，$x + y = k$，$x, y > 0$。\n\n本题使用**自定义校验器**检验你的答案是否正确，因此若有多种满足条件的方案，你只需要输出**任意一种**。\n\n你应保证方案输出的格式正确，且同一行中相邻的两个数使用单个空格分隔，除此之外你的输出中**不应包含其他多余字符**。", "hint": "#### 样例 1 解释\n\n对于第二组数据，一种满足要求的制作方案为：\n- 使用 $80$ 克原材料 $1$ 与 $20$ 克原材料 $2$ 做第一道菜。\n- 使用 $10$ 克原材料 $2$ 与 $90$ 克原材料 $3$ 做第二道菜。\n- 使用 $100$ 克原材料 $4$ 做第三道菜。\n\n#### 样例 2\n\n见选手目录下的 dish/dish2.in 与 dish/dish2.ans。\n\n#### 样例 3\n\n见选手目录下的 dish/dish3.in 与 dish/dish3.ans。\n\n---\n\n### 测试点约束\n\n对于所有测试点：\n$1 \\leq T \\leq 10$，$1 \\leq n \\leq 500$，$n - 2 \\leq m \\leq 5000$，$m \\geq 1$，$1 \\leq k \\leq 5000$，$\\sum_{i=1}^{n}d_i = m \\times k$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 |  $n$ |  $m$ |  $k$ |\n| :-: | :-: | :-: | :-: |\n|  $1\\sim 3$ |  $\\le 4$ |  $\\le 4$ |  $\\le 50$ |\n|  $4\\sim 5$ |  $\\le 10$ |  $\\le 10$ |  $\\le 5\\times 10^3$ |\n|  $6\\sim 7$ |  $\\le 500$ |  $=n-1$ |  $\\le 5\\times 10^3$ |\n|  $8\\sim 9$ |  $\\le 500$ |  $n-1\\le m\\le 5\\times 10^3$ |  $\\le 5\\times 10^3$ |\n|  $10$ |  $\\le 25$ |  $\\le 5\\times 10^3$ |  $\\le 5\\times 10^3$ |\n|  $11\\sim 12$ |  $\\le 25$ |  $\\le 5\\times 10^3$ |  $\\le 500$ |\n|  $13\\sim 14$ |  $\\le 50$ |  $\\le 5\\times 10^3$ |  $\\le 500$ |\n|  $15\\sim 17$ |  $\\le 100$ |  $\\le 5\\times 10^3$ |  $\\le 5\\times 10^3$ |\n|  $18\\sim 20$ |  $\\le 500$ | $\\le 5\\times 10^3$ |  $\\le 5\\times 10^3$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI2020] 制作菜品", "background": "", "description": "厨师准备给小朋友们制作 $m$ 道菜，每道菜均使用 $k$ 克原材料。为此，厨师购入了 $n$ 种原材料，原材料从 $1$ 到 $n$ 编号，第 $i$ 种原材料的质量为 $d_i$ 克。$n$ 种原材料的**质量之和恰好为 $m \\times k$ 克**，其中 $d_i$ 与 $k$ 都是**正整数**。\n\n制作菜品时，一种原材料可以被用于多道菜，但为了让菜品的味道更纯粹，厨师打算每道菜**至多使用 $2$ 种**原材料。现在请你判断是否存在一种满足要求的制作方案。更具体地，方案应满足下列要求：\n- 共做出 $m$ 道菜。\n- 每道菜至多使用 $2$ 种原材料。\n- 每道菜恰好使用 $k$ 克原材料。\n- 每道菜使用的每种原材料的质量都为正整数克。\n- $n$ 种原材料都被恰好用完。\n\n若存在满足要求的制作方案，你还应该给出一种具体的制作方案。", "inputFormat": "**本题单个测试点包含多组测试数据**。\n\n第一行一个整数 $T$ 表示数据组数。对于每组数据：\n- 第一行三个正整数 $n, m, k$ 分别表示原材料种数、需要制作的菜品道数、每道菜品需使用的原材料的质量。\n- 第二行 $n$ 个整数，第 $i$ 个整数表示第 $i$ 种原材料的质量 $d_i$。", "outputFormat": "对于每组测试数据：\n- **若不存在满足要求的制作方案，则输出一行一个整数 $-1$**;\n- 否则你需要输出 $m$ 行，每行表示一道菜品的制作方案，根据使用的原材料种数，格式为下列两种之一：\n  - 依次输出一行两个整数 $i$ 和 $x$，表示该道菜使用 $x$ 克第 $i$ 种原材料制作。你应保证 $1 \\leq i \\leq n$，$x = k$。\n  - 依次输出一行四个整数 $i$、$x$、$j$ 和 $y$，表示该道菜使用 $x$ 克第 $i$ 种原材料与 $y$ 克第 $j$ 种原材料制作。你应保证$1 \\leq i, j \\leq n$，$i \\not= j$，$x + y = k$，$x, y > 0$。\n\n本题使用**自定义校验器**检验你的答案是否正确，因此若有多种满足条件的方案，你只需要输出**任意一种**。\n\n你应保证方案输出的格式正确，且同一行中相邻的两个数使用单个空格分隔，除此之外你的输出中**不应包含其他多余字符**。", "hint": "#### 样例 1 解释\n\n对于第二组数据，一种满足要求的制作方案为：\n- 使用 $80$ 克原材料 $1$ 与 $20$ 克原材料 $2$ 做第一道菜。\n- 使用 $10$ 克原材料 $2$ 与 $90$ 克原材料 $3$ 做第二道菜。\n- 使用 $100$ 克原材料 $4$ 做第三道菜。\n\n#### 样例 2\n\n见选手目录下的 dish/dish2.in 与 dish/dish2.ans。\n\n#### 样例 3\n\n见选手目录下的 dish/dish3.in 与 dish/dish3.ans。\n\n---\n\n### 测试点约束\n\n对于所有测试点：\n$1 \\leq T \\leq 10$，$1 \\leq n \\leq 500$，$n - 2 \\leq m \\leq 5000$，$m \\geq 1$，$1 \\leq k \\leq 5000$，$\\sum_{i=1}^{n}d_i = m \\times k$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 |  $n$ |  $m$ |  $k$ |\n| :-: | :-: | :-: | :-: |\n|  $1\\sim 3$ |  $\\le 4$ |  $\\le 4$ |  $\\le 50$ |\n|  $4\\sim 5$ |  $\\le 10$ |  $\\le 10$ |  $\\le 5\\times 10^3$ |\n|  $6\\sim 7$ |  $\\le 500$ |  $=n-1$ |  $\\le 5\\times 10^3$ |\n|  $8\\sim 9$ |  $\\le 500$ |  $n-1\\le m\\le 5\\times 10^3$ |  $\\le 5\\times 10^3$ |\n|  $10$ |  $\\le 25$ |  $\\le 5\\times 10^3$ |  $\\le 5\\times 10^3$ |\n|  $11\\sim 12$ |  $\\le 25$ |  $\\le 5\\times 10^3$ |  $\\le 500$ |\n|  $13\\sim 14$ |  $\\le 50$ |  $\\le 5\\times 10^3$ |  $\\le 500$ |\n|  $15\\sim 17$ |  $\\le 100$ |  $\\le 5\\times 10^3$ |  $\\le 5\\times 10^3$ |\n|  $18\\sim 20$ |  $\\le 500$ | $\\le 5\\times 10^3$ |  $\\le 5\\times 10^3$ |", "locale": "zh-CN"}}}
{"pid": "P6776", "type": "P", "difficulty": 7, "samples": [["1\n1\n1\n0 0", "Almost Complete"], ["1\n3\n3\n2 3\n0 0\n0 0\n2\n2 0\n0 0\n2\n0 2\n0 0", "Almost Complete"], ["1\n2\n3\n2 3\n0 0\n0 0\n2\n2 0\n0 0", "No"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2020", "NOI", "O2优化"], "title": "[NOI2020] 超现实树", "background": "下课铃声响起，机房里的两位女生从座位上站起来。（下面用 $\\mathbf{X1}$, $\\mathbf{X2}$ 代指两人）\n\n$\\mathbf{X2}$：省选前的集训真难熬啊…… 听课、考试、讲评、补题 —— 对于现在的我来说，即使在梦里想到一道数据结构题，也会不由自主地开始思考吧。\n\n$\\mathbf{X1}$：重复训练对我来说似乎并不是什么负担，但我确实感觉到解决题目带来的愉悦感在最近逐渐减弱了。也许我们需要一些精神上的 “刺激”：一些不拘泥于繁复技术的智力游戏，来让我们找回对于数学和算法的兴趣。\n\n$\\mathbf{X2}$：咦，我好像收到了一封用英文写的短信，似乎是…… 数学书上的一些片段。", "description": "$\\mathbf{X1}$：我来翻译一下短信的内容。\n\n> 定义：本文所述的树是归纳定义的：单独的结点构成一棵树，以一棵树作为左（或右）孩子可以构成一棵树，以两棵树分别作为左、右孩子也可以构成一棵树。仅由以上规则用有限步生成的所有结构被称为树。\n\n$\\mathbf{X2}$：也就是说，这里所说的树是指**非空、有根、区分左右孩子的二叉树**。\n\n$\\mathbf{X1}$：的确如此。接下来书上定义了两棵树的同构。\n\n> 定义：称两棵树 $T$, $T^{\\prime}$ 同构，记做 $T \\equiv T^{\\prime}$，由以下四条规则定义：\n> 1. 由单独结点构成的树是彼此同构的；\n> 2. 如果两棵树的根结点均只有左子树，并且它们的左子树同构，那么这两棵树是同构的；\n> 3. 如果两棵树的根结点均只有右子树，并且它们的右子树同构，那么这两棵树是同构的；\n> 4. 如果两棵树的根结点均有左、右子树，并且它们的左、右子树分别对应同构，那么这两棵树是同构的。\n> \n> 很明显，同构关系构成了所有树上的一个等价关系。为了方便，我们将同构的树看作相同的树。\n\n$\\mathbf{X2}$：将同构的树看成相同的树就是说树的结点是彼此相同的。简单地说，两棵树同构当且仅当**他们在结点无标号、区分左右孩子的意义下相同**；我们说两棵树不同，当且仅当它们不同构。\n\n$\\mathbf{X1}$：书里还定义了树的**叶子**：和通常的定义一样，叶子指**没有任何孩子的结点**。\n\n$\\mathbf{X2}$：这和我们熟悉的定义完全一致。嘛，数学家真是有点啰嗦…… 恐怕只有 $\\mathbf{X3}$ 那种家伙会喜欢这种做派吧。\n\n$\\mathbf{X1}$：我倒是对此不太反感 —— 比起基于经验的 “直觉”，准确的定义和严谨的证明还是更加让人安心。你看，下一个定义就没有那么直观了。\n\n> 定义：称一棵树 $T$ **单步替换**成为 $T^{\\prime}$，如果将 $T$ 的某一**叶子结点**替换为另一棵树 $T^{\\prime \\prime}$ 得到的树与 $T^{\\prime}$ 同构，记做 $T \\rightarrow T^{\\prime}$；称一棵树 $T$ **替换**成为 $T^{\\prime}$，记做 $T \\rightarrow^{\\star} T^{\\prime}$，如果存在自然数 $n \\geq 1$ 和树 $T_{1}, T_{2}, \\ldots, T_{n}$，使得 $T \\equiv T_{1} \\rightarrow T_{2} \\rightarrow \\cdots \\rightarrow T_{n} \\equiv T^{\\prime}$。\n\n$\\mathbf{X2}$：我来想想…… 所谓替换，就是删掉某个叶子结点并在对应的位置放入另一棵树，就像那个叶子结点 “长出了” 一个更大的子树一样；一棵树替换成为另一棵树，说明它可以经由**零次、一次或多次**单步替换得到那棵树。哦…… 我明白了！举例来说，任何一棵树都可以替换成它本身，换言之对于树 $T$，都有 $T \\rightarrow^{\\star} T^{\\prime}$。下面这个图片可以帮助理解单步替换和替换的含义。\n\n![img](https://cdn.luogu.com.cn/upload/image_hosting/0o4pfqui.png)\n\n$\\mathbf{X1}$：你说得对。特别地，任何一棵树都可以替换得到无穷多棵不同的树，并且仅有一个结点构成的树可以替换得到任意其他的树。书上也有定义这样的东西。\n\n> 定义：对于一棵树 $T$，定义 $\\operatorname{grow}(T)$ 表示 T 所能替换构成的树的集合，即 $\\operatorname{grow}(T)=\\left\\{T^{\\prime} \\mid T \\rightarrow^{\\star} T^{\\prime}\\right\\}$。更近一步，如果 $\\mathscr{T}=\\left\\{T_{1}, T_{2}, \\ldots, T_{n}\\right\\}$ 是一个树的有限集合，定义 $\\operatorname{grow}(\\mathscr{T})$ 为所有 $\\operatorname{grow}\\left(T_{i}\\right)$ 的并集，其中 $i=1,2, \\ldots, n$。即 \n> $$\\operatorname{grow}(\\mathscr{T})=\\bigcup_{T_{i} \\in \\mathscr{T}} \\operatorname{grow}\\left(T_{i}\\right)$$\n\n$\\mathbf{X2}$：我们把 $\\operatorname{grow}(\\mathscr{T})$ 称作树的集合 $\\mathscr{T}$ **所生长得到的集合**吧 —— 也就是说，树的集合 $\\mathscr{T}$ 所生长得到的集合包含所有可以被某个 $T \\in \\mathscr{T}$ 替换得到的树。不妨把树的集合叫做**树林**。不太严谨地说，一个树林所生长得到的新树林就是其中所有树、以所有可能的方式生长得到的树林。显而易见，一个非空树林所生长得到的树林都是无穷树林。但这个无穷树林，或者说 $\\operatorname{grow}(\\mathscr{T})$，并不一定包含所有的树 —— 更进一步，它甚至不一定包含 “几乎所有” 的树。\n\n$\\mathbf{X1}$：让我来补充一下：我们称一个树林是**几乎完备**的（或称**几乎包含了所有的树**），如果仅有有限多的树不在其中。对于一个有限树林 $\\mathscr{T}$，$\\operatorname{grow}(\\mathscr{T})$ 要么包含了所有的树，要么包含了几乎所有的树，要么存在无穷多棵树不在其中。如果这是一道 OI 题，出题人一定会**在样例中给出三种情况的例子**吧。书上的关键定理也用了和我们相同的定义。\n\n> **定理**（**几乎完备的可判定性**）：一个树的集合是**几乎完备**的，如果仅有有限棵树不在其中。那么，对于一个给定的树的有限集合 $\\mathscr{T}$，存在高效的算法判定 $\\operatorname{grow}(\\mathscr{T})$ 是否是几乎完备的。\n\n$\\mathbf{X2}$：这个问题变成一个纯粹的 OI 题目了！让我用我们的语言来重述一下题意：**给定一个有限大小的树林 $\\mathscr{T}$，判定 $\\operatorname{grow}(\\mathscr{T})$ 是否是几乎完备的，即是否仅有有限棵树不能被树林中所包含的树生长得到**。\n\n$\\mathbf{X1}$：也就是说，给定一个有限的树的集合 $\\mathscr{T}$，判定是否仅有有限个树 $T$，满足 $T \\notin \\operatorname{grow}(\\mathscr{T})$。所谓 $T \\notin \\operatorname{grow}(\\mathscr{T})$，就是说不存在 $T^{\\prime} \\in \\mathscr{T}$，使得 $T^{\\prime} \\rightarrow^{\\star} T$。这和通常的 OI 题目的确非常不同：我甚至没有想到这个问题的一个算法。\n\n$\\mathbf{X2}$：我也一样，不过我很久没有感受到这种解决未知问题的冲动了。", "inputFormat": "本题有多组测试数据，输入文件的第一行包含一个正整数 $N$，表示测试数据的组数。接下来包含恰好 $N$ 组测试数据，每组测试数据具有以下的格式：\n\n第一行是一个正整数 $m$，表示树的集合中树的个数。接下来按照以下格式输入 $m$ 棵树：\n- 首先是一个正整数 $n$，表示树中的结点个数，结点编号为 $1,2, \\ldots, n$；\n- 接下来 $n$ 行每行两个非负整数，其中第 $i$ 行从左到右包含用空格隔开的 $l_i$ 和 $r_i$，分别表示 $i$ 号结点左、右孩子结点的编号。如果左（或右）孩子不存在，那么 $l_i$（或 $r_i$）为 $0$。当然，叶结点一定满足 $l_i = r_i = 0$。\n- 输入数据保证构成一棵以 $1$ 号结点作为根结点的树。**请注意**：结点的编号只是为了方便输入，任何同构的树都被视为是相同的。\n\n所输入的 $m$ 棵树中可能存在彼此同构的树；如果去除这些重复的树（即每种同构的树只留下一个），它们可以构成一个树的集合 $\\mathscr{T}$。你需要判定这一树的集合所生长得到的集合 $\\operatorname{grow}(\\mathscr{T})$ 是否是几乎完备的。", "outputFormat": "输出包含 $N$ 行，分别表示 $N$ 组测试数据的答案。其中，第 $i$ 行输出一个字符串：如果第 $i$ 组测试数据所输入的树的集合所生长得到的集合是几乎完备的（换言之，仅有有限棵树不能被其生长得到），那么输出 `Almost Complete`；否则输出 `No`。**请注意输出字符串的拼写和大小写**。", "hint": "#### 样例 2 解释\n这一样例仅包含一组测试数据，其中树的集合 $\\mathscr{T}$ 包含三棵树，如下图所示。容易发现，仅有单个结点构成的树不在 $\\operatorname{grow}(\\mathscr{T})$ 中，其包含了几乎所有树，因而是几乎完备的。\n\n![img2](https://cdn.luogu.com.cn/upload/image_hosting/394s081s.png)\n\n#### 样例 3 解释\n这一样例仅包含一组测试数据，其中树的集合 $\\mathscr{T}$ 包含两棵树。容易发现，对于所有的 $n \\geq 2$，包含 $n$ 个结点，每个非叶结点仅有右孩子的链状树都不在 $\\operatorname{grow}(\\mathscr{T})$ 中，因而存在无穷多棵树不在 $\\operatorname{grow}(\\mathscr{T})$ 中，$\\mathscr{T}$ 不是几乎完备的。\n\n#### 样例 4\n见选手目录下的 surreal/surreal4.in 与 surreal/surreal4.ans。\n\n---\n\n### 测试点约束\n\n**全部数据满足**：$\\sum n \\leq 2 \\times 10^{6}$， $\\sum m \\leq 2 \\times 10^{6}$， $\\max h \\leq 2 \\times 10^{6}$， $N \\leq 10^{2}$。其中，$\\sum n$ 表示这一测试点所有测试数据中所出现的所有树的结点个数之和；$\\sum m$ 表示这一测试点中所有测试数据中所出现的树的个数；$\\max h$ 表示这一测试点中所出现的所有树的最高高度（仅包含一个结点的树高度为 $1$）。下表中的表项 $\\sum n$，$\\sum m$ 和 $\\max h$ 含义与上面相同，描述了每一组测试点的数据范围。\n\n**特殊性质**：下面是下表中会涉及的四种特殊性质的解释。\n- 特殊性质 $1$：对于这一测试点中的每一组测试数据，都有 $m \\leq 4$，即树的集合中包括不超过 $4$ 棵树；\n- 特殊性质 $2$：对于这一测试点中的每一组测试数据，树的集合中所有的树具有相同的高度；\n- 特殊性质 $3$：对于这一测试点中的每一组测试数据，树的集合仅包含链（换言之，每个非叶结点仅包含一个孩子）；\n- 特殊性质 $4$：对于这一测试点中的每一组测试数据，树的集合仅包含满足以下两个条件之一的树：\n  - 每个非叶结点仅包含一个孩子；\n  - 恰好有两个叶结点，它们具有相同的父结点，并且除这三个结点外，其余结点均有且仅有一个孩子。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 |  $N$ |  $\\sum n$ |  $\\sum m$ |  $\\max h$ | 特殊性质 |\n| :-: | :-: | :-: | :-: | :-: |:-:  |\n|  $1$ |  $100$ |  $\\le 10^3$ |  $\\le 10^3$ |  $\\le 1$ | 无 |\n|  $2\\sim 3$ |  $100$ |  $\\le 10^3$ |  $\\le 10^3$ |  $\\le 2$ | 性质  $1$ |\n|  $4$ |  $100$ |  $\\le 10^6$ |  $\\le 10^6$ |  $\\le 4$ | 无 | \n|  $5$ |  $100$ |  $\\le 10^6$ |  $\\le 10^6$ |  $\\le 5$ | 性质  $2$ | \n|  $6$ |  $100$ |  $\\le 10^6$ |  $\\le 10^6$ |  $\\le 8$ | 无 | \n|  $7$ |  $100$ |  $\\le 10^6$ |  $\\le 10^6$ |  $\\le 9$ | 性质  $2$ | \n|  $8$ |  $100$ |  $\\le 10^6$ |  $\\le 10^6$ |  $\\le 10$ | 无 | \n|  $9$ |  $100$ |  $\\le 10^6$ |  $\\le 10^6$ |  $\\le 10^6$ | 性质  $3$ | \n|  $10$ |  $20$ |  $\\le 10^3$ |  $\\le 100$ |  $\\le 10^3$ | 性质  $4$ | \n|  $11$ |  $20$ |  $\\le 2\\times 10^3$ |  $\\le 2\\times 10^3$ |  $\\le 2\\times 10^3$ | 性质  $4$ | \n|  $12$ |  $20$ |  $\\le 10^5$ |  $\\le 10^5$ |  $\\le 10^5$ | 性质  $4$ | \n|  $13$ |  $20$ |  $\\le 2\\times 10^5$ |  $\\le 2\\times 10^5$ |  $\\le 2\\times 10^5$ | 性质  $4$ | \n|  $14$ |  $20$ |  $\\le 800$ |  $\\le 200$ |  $\\le 800$ | 无 |\n|  $15$ |  $20$ |  $\\le 10^3$ |  $\\le 100$ |  $\\le 10^3$ | 无 |\n|  $16$ |  $20$ |  $\\le 2\\times 10^3$ |  $\\le 2\\times 10^3$ |  $\\le 2\\times 10^3$ | 无 |\n|  $17$ |  $40$ |  $\\le 3\\times 10^5$ |  $\\le 3\\times 10^5$ |  $\\le 3\\times 10^5$ | 无 |\n|  $18$ |  $40$ |  $\\le 6\\times 10^5$ |  $\\le 6\\times 10^5$ |  $\\le 6\\times 10^5$ | 无 |\n|  $19$ |  $40$ |  $\\le 9\\times 10^5$ |  $\\le 9\\times 10^5$ |  $\\le 9\\times 10^5$ | 无 |\n|  $20$ |  $40$ |  $\\le 1.2\\times 10^6$ |  $\\le 1.2\\times 10^6$ |  $\\le 1.2\\times 10^6$ | 无 |\n|  $21$ |  $40$ |  $\\le 1.5\\times 10^6$ |  $\\le 1.5\\times 10^6$ |  $\\le 1.5\\times 10^6$ | 无 |\n|  $22\\sim 25$ |  $40$ |  $\\le 2\\times 10^6$ |  $\\le 2\\times 10^6$ |  $\\le 2\\times 10^6$ | 无 |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI2020] 超现实树", "background": "下课铃声响起，机房里的两位女生从座位上站起来。（下面用 $\\mathbf{X1}$, $\\mathbf{X2}$ 代指两人）\n\n$\\mathbf{X2}$：省选前的集训真难熬啊…… 听课、考试、讲评、补题 —— 对于现在的我来说，即使在梦里想到一道数据结构题，也会不由自主地开始思考吧。\n\n$\\mathbf{X1}$：重复训练对我来说似乎并不是什么负担，但我确实感觉到解决题目带来的愉悦感在最近逐渐减弱了。也许我们需要一些精神上的 “刺激”：一些不拘泥于繁复技术的智力游戏，来让我们找回对于数学和算法的兴趣。\n\n$\\mathbf{X2}$：咦，我好像收到了一封用英文写的短信，似乎是…… 数学书上的一些片段。", "description": "$\\mathbf{X1}$：我来翻译一下短信的内容。\n\n> 定义：本文所述的树是归纳定义的：单独的结点构成一棵树，以一棵树作为左（或右）孩子可以构成一棵树，以两棵树分别作为左、右孩子也可以构成一棵树。仅由以上规则用有限步生成的所有结构被称为树。\n\n$\\mathbf{X2}$：也就是说，这里所说的树是指**非空、有根、区分左右孩子的二叉树**。\n\n$\\mathbf{X1}$：的确如此。接下来书上定义了两棵树的同构。\n\n> 定义：称两棵树 $T$, $T^{\\prime}$ 同构，记做 $T \\equiv T^{\\prime}$，由以下四条规则定义：\n> 1. 由单独结点构成的树是彼此同构的；\n> 2. 如果两棵树的根结点均只有左子树，并且它们的左子树同构，那么这两棵树是同构的；\n> 3. 如果两棵树的根结点均只有右子树，并且它们的右子树同构，那么这两棵树是同构的；\n> 4. 如果两棵树的根结点均有左、右子树，并且它们的左、右子树分别对应同构，那么这两棵树是同构的。\n> \n> 很明显，同构关系构成了所有树上的一个等价关系。为了方便，我们将同构的树看作相同的树。\n\n$\\mathbf{X2}$：将同构的树看成相同的树就是说树的结点是彼此相同的。简单地说，两棵树同构当且仅当**他们在结点无标号、区分左右孩子的意义下相同**；我们说两棵树不同，当且仅当它们不同构。\n\n$\\mathbf{X1}$：书里还定义了树的**叶子**：和通常的定义一样，叶子指**没有任何孩子的结点**。\n\n$\\mathbf{X2}$：这和我们熟悉的定义完全一致。嘛，数学家真是有点啰嗦…… 恐怕只有 $\\mathbf{X3}$ 那种家伙会喜欢这种做派吧。\n\n$\\mathbf{X1}$：我倒是对此不太反感 —— 比起基于经验的 “直觉”，准确的定义和严谨的证明还是更加让人安心。你看，下一个定义就没有那么直观了。\n\n> 定义：称一棵树 $T$ **单步替换**成为 $T^{\\prime}$，如果将 $T$ 的某一**叶子结点**替换为另一棵树 $T^{\\prime \\prime}$ 得到的树与 $T^{\\prime}$ 同构，记做 $T \\rightarrow T^{\\prime}$；称一棵树 $T$ **替换**成为 $T^{\\prime}$，记做 $T \\rightarrow^{\\star} T^{\\prime}$，如果存在自然数 $n \\geq 1$ 和树 $T_{1}, T_{2}, \\ldots, T_{n}$，使得 $T \\equiv T_{1} \\rightarrow T_{2} \\rightarrow \\cdots \\rightarrow T_{n} \\equiv T^{\\prime}$。\n\n$\\mathbf{X2}$：我来想想…… 所谓替换，就是删掉某个叶子结点并在对应的位置放入另一棵树，就像那个叶子结点 “长出了” 一个更大的子树一样；一棵树替换成为另一棵树，说明它可以经由**零次、一次或多次**单步替换得到那棵树。哦…… 我明白了！举例来说，任何一棵树都可以替换成它本身，换言之对于树 $T$，都有 $T \\rightarrow^{\\star} T^{\\prime}$。下面这个图片可以帮助理解单步替换和替换的含义。\n\n![img](https://cdn.luogu.com.cn/upload/image_hosting/0o4pfqui.png)\n\n$\\mathbf{X1}$：你说得对。特别地，任何一棵树都可以替换得到无穷多棵不同的树，并且仅有一个结点构成的树可以替换得到任意其他的树。书上也有定义这样的东西。\n\n> 定义：对于一棵树 $T$，定义 $\\operatorname{grow}(T)$ 表示 T 所能替换构成的树的集合，即 $\\operatorname{grow}(T)=\\left\\{T^{\\prime} \\mid T \\rightarrow^{\\star} T^{\\prime}\\right\\}$。更近一步，如果 $\\mathscr{T}=\\left\\{T_{1}, T_{2}, \\ldots, T_{n}\\right\\}$ 是一个树的有限集合，定义 $\\operatorname{grow}(\\mathscr{T})$ 为所有 $\\operatorname{grow}\\left(T_{i}\\right)$ 的并集，其中 $i=1,2, \\ldots, n$。即 \n> $$\\operatorname{grow}(\\mathscr{T})=\\bigcup_{T_{i} \\in \\mathscr{T}} \\operatorname{grow}\\left(T_{i}\\right)$$\n\n$\\mathbf{X2}$：我们把 $\\operatorname{grow}(\\mathscr{T})$ 称作树的集合 $\\mathscr{T}$ **所生长得到的集合**吧 —— 也就是说，树的集合 $\\mathscr{T}$ 所生长得到的集合包含所有可以被某个 $T \\in \\mathscr{T}$ 替换得到的树。不妨把树的集合叫做**树林**。不太严谨地说，一个树林所生长得到的新树林就是其中所有树、以所有可能的方式生长得到的树林。显而易见，一个非空树林所生长得到的树林都是无穷树林。但这个无穷树林，或者说 $\\operatorname{grow}(\\mathscr{T})$，并不一定包含所有的树 —— 更进一步，它甚至不一定包含 “几乎所有” 的树。\n\n$\\mathbf{X1}$：让我来补充一下：我们称一个树林是**几乎完备**的（或称**几乎包含了所有的树**），如果仅有有限多的树不在其中。对于一个有限树林 $\\mathscr{T}$，$\\operatorname{grow}(\\mathscr{T})$ 要么包含了所有的树，要么包含了几乎所有的树，要么存在无穷多棵树不在其中。如果这是一道 OI 题，出题人一定会**在样例中给出三种情况的例子**吧。书上的关键定理也用了和我们相同的定义。\n\n> **定理**（**几乎完备的可判定性**）：一个树的集合是**几乎完备**的，如果仅有有限棵树不在其中。那么，对于一个给定的树的有限集合 $\\mathscr{T}$，存在高效的算法判定 $\\operatorname{grow}(\\mathscr{T})$ 是否是几乎完备的。\n\n$\\mathbf{X2}$：这个问题变成一个纯粹的 OI 题目了！让我用我们的语言来重述一下题意：**给定一个有限大小的树林 $\\mathscr{T}$，判定 $\\operatorname{grow}(\\mathscr{T})$ 是否是几乎完备的，即是否仅有有限棵树不能被树林中所包含的树生长得到**。\n\n$\\mathbf{X1}$：也就是说，给定一个有限的树的集合 $\\mathscr{T}$，判定是否仅有有限个树 $T$，满足 $T \\notin \\operatorname{grow}(\\mathscr{T})$。所谓 $T \\notin \\operatorname{grow}(\\mathscr{T})$，就是说不存在 $T^{\\prime} \\in \\mathscr{T}$，使得 $T^{\\prime} \\rightarrow^{\\star} T$。这和通常的 OI 题目的确非常不同：我甚至没有想到这个问题的一个算法。\n\n$\\mathbf{X2}$：我也一样，不过我很久没有感受到这种解决未知问题的冲动了。", "inputFormat": "本题有多组测试数据，输入文件的第一行包含一个正整数 $N$，表示测试数据的组数。接下来包含恰好 $N$ 组测试数据，每组测试数据具有以下的格式：\n\n第一行是一个正整数 $m$，表示树的集合中树的个数。接下来按照以下格式输入 $m$ 棵树：\n- 首先是一个正整数 $n$，表示树中的结点个数，结点编号为 $1,2, \\ldots, n$；\n- 接下来 $n$ 行每行两个非负整数，其中第 $i$ 行从左到右包含用空格隔开的 $l_i$ 和 $r_i$，分别表示 $i$ 号结点左、右孩子结点的编号。如果左（或右）孩子不存在，那么 $l_i$（或 $r_i$）为 $0$。当然，叶结点一定满足 $l_i = r_i = 0$。\n- 输入数据保证构成一棵以 $1$ 号结点作为根结点的树。**请注意**：结点的编号只是为了方便输入，任何同构的树都被视为是相同的。\n\n所输入的 $m$ 棵树中可能存在彼此同构的树；如果去除这些重复的树（即每种同构的树只留下一个），它们可以构成一个树的集合 $\\mathscr{T}$。你需要判定这一树的集合所生长得到的集合 $\\operatorname{grow}(\\mathscr{T})$ 是否是几乎完备的。", "outputFormat": "输出包含 $N$ 行，分别表示 $N$ 组测试数据的答案。其中，第 $i$ 行输出一个字符串：如果第 $i$ 组测试数据所输入的树的集合所生长得到的集合是几乎完备的（换言之，仅有有限棵树不能被其生长得到），那么输出 `Almost Complete`；否则输出 `No`。**请注意输出字符串的拼写和大小写**。", "hint": "#### 样例 2 解释\n这一样例仅包含一组测试数据，其中树的集合 $\\mathscr{T}$ 包含三棵树，如下图所示。容易发现，仅有单个结点构成的树不在 $\\operatorname{grow}(\\mathscr{T})$ 中，其包含了几乎所有树，因而是几乎完备的。\n\n![img2](https://cdn.luogu.com.cn/upload/image_hosting/394s081s.png)\n\n#### 样例 3 解释\n这一样例仅包含一组测试数据，其中树的集合 $\\mathscr{T}$ 包含两棵树。容易发现，对于所有的 $n \\geq 2$，包含 $n$ 个结点，每个非叶结点仅有右孩子的链状树都不在 $\\operatorname{grow}(\\mathscr{T})$ 中，因而存在无穷多棵树不在 $\\operatorname{grow}(\\mathscr{T})$ 中，$\\mathscr{T}$ 不是几乎完备的。\n\n#### 样例 4\n见选手目录下的 surreal/surreal4.in 与 surreal/surreal4.ans。\n\n---\n\n### 测试点约束\n\n**全部数据满足**：$\\sum n \\leq 2 \\times 10^{6}$， $\\sum m \\leq 2 \\times 10^{6}$， $\\max h \\leq 2 \\times 10^{6}$， $N \\leq 10^{2}$。其中，$\\sum n$ 表示这一测试点所有测试数据中所出现的所有树的结点个数之和；$\\sum m$ 表示这一测试点中所有测试数据中所出现的树的个数；$\\max h$ 表示这一测试点中所出现的所有树的最高高度（仅包含一个结点的树高度为 $1$）。下表中的表项 $\\sum n$，$\\sum m$ 和 $\\max h$ 含义与上面相同，描述了每一组测试点的数据范围。\n\n**特殊性质**：下面是下表中会涉及的四种特殊性质的解释。\n- 特殊性质 $1$：对于这一测试点中的每一组测试数据，都有 $m \\leq 4$，即树的集合中包括不超过 $4$ 棵树；\n- 特殊性质 $2$：对于这一测试点中的每一组测试数据，树的集合中所有的树具有相同的高度；\n- 特殊性质 $3$：对于这一测试点中的每一组测试数据，树的集合仅包含链（换言之，每个非叶结点仅包含一个孩子）；\n- 特殊性质 $4$：对于这一测试点中的每一组测试数据，树的集合仅包含满足以下两个条件之一的树：\n  - 每个非叶结点仅包含一个孩子；\n  - 恰好有两个叶结点，它们具有相同的父结点，并且除这三个结点外，其余结点均有且仅有一个孩子。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 |  $N$ |  $\\sum n$ |  $\\sum m$ |  $\\max h$ | 特殊性质 |\n| :-: | :-: | :-: | :-: | :-: |:-:  |\n|  $1$ |  $100$ |  $\\le 10^3$ |  $\\le 10^3$ |  $\\le 1$ | 无 |\n|  $2\\sim 3$ |  $100$ |  $\\le 10^3$ |  $\\le 10^3$ |  $\\le 2$ | 性质  $1$ |\n|  $4$ |  $100$ |  $\\le 10^6$ |  $\\le 10^6$ |  $\\le 4$ | 无 | \n|  $5$ |  $100$ |  $\\le 10^6$ |  $\\le 10^6$ |  $\\le 5$ | 性质  $2$ | \n|  $6$ |  $100$ |  $\\le 10^6$ |  $\\le 10^6$ |  $\\le 8$ | 无 | \n|  $7$ |  $100$ |  $\\le 10^6$ |  $\\le 10^6$ |  $\\le 9$ | 性质  $2$ | \n|  $8$ |  $100$ |  $\\le 10^6$ |  $\\le 10^6$ |  $\\le 10$ | 无 | \n|  $9$ |  $100$ |  $\\le 10^6$ |  $\\le 10^6$ |  $\\le 10^6$ | 性质  $3$ | \n|  $10$ |  $20$ |  $\\le 10^3$ |  $\\le 100$ |  $\\le 10^3$ | 性质  $4$ | \n|  $11$ |  $20$ |  $\\le 2\\times 10^3$ |  $\\le 2\\times 10^3$ |  $\\le 2\\times 10^3$ | 性质  $4$ | \n|  $12$ |  $20$ |  $\\le 10^5$ |  $\\le 10^5$ |  $\\le 10^5$ | 性质  $4$ | \n|  $13$ |  $20$ |  $\\le 2\\times 10^5$ |  $\\le 2\\times 10^5$ |  $\\le 2\\times 10^5$ | 性质  $4$ | \n|  $14$ |  $20$ |  $\\le 800$ |  $\\le 200$ |  $\\le 800$ | 无 |\n|  $15$ |  $20$ |  $\\le 10^3$ |  $\\le 100$ |  $\\le 10^3$ | 无 |\n|  $16$ |  $20$ |  $\\le 2\\times 10^3$ |  $\\le 2\\times 10^3$ |  $\\le 2\\times 10^3$ | 无 |\n|  $17$ |  $40$ |  $\\le 3\\times 10^5$ |  $\\le 3\\times 10^5$ |  $\\le 3\\times 10^5$ | 无 |\n|  $18$ |  $40$ |  $\\le 6\\times 10^5$ |  $\\le 6\\times 10^5$ |  $\\le 6\\times 10^5$ | 无 |\n|  $19$ |  $40$ |  $\\le 9\\times 10^5$ |  $\\le 9\\times 10^5$ |  $\\le 9\\times 10^5$ | 无 |\n|  $20$ |  $40$ |  $\\le 1.2\\times 10^6$ |  $\\le 1.2\\times 10^6$ |  $\\le 1.2\\times 10^6$ | 无 |\n|  $21$ |  $40$ |  $\\le 1.5\\times 10^6$ |  $\\le 1.5\\times 10^6$ |  $\\le 1.5\\times 10^6$ | 无 |\n|  $22\\sim 25$ |  $40$ |  $\\le 2\\times 10^6$ |  $\\le 2\\times 10^6$ |  $\\le 2\\times 10^6$ | 无 |", "locale": "zh-CN"}}}
{"pid": "P6777", "type": "P", "difficulty": 7, "samples": [["4 5\n1 2 1\n2 3 1\n3 4 1\n1 3 5\n2 4 6\n1 4\n", "6"], ["2 1\n1 2 1\n1 2\n", "-1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2020", "NOI", "O2优化", "弦图"], "title": "[NOI2020] 翻修道路【数据有误】", "background": "本题官方数据有误。正确的解法见 [Shortest non-separating st-path on chordal graphs](https://arxiv.org/abs/2101.03519)。", "description": "C 国中包含 $n$ 座城市，这些城市通过 $m$ 条双向道路连接。城市从 $1$ 到 $n$ 编号，道路从 $1$ 到 $m$ 编号，$i$ 号道路两端连接着城市 $u_i$ 与城市 $v_i$，它的长度为 $w_i$ 米。经由这些道路，从 C 国中任意一个城市出发，均能到达其他所有城市。\n\nC 国人民喜欢环路旅程，但又不喜欢经过太多条道路，为此 C 国的道路被建造得非常特殊。更具体地，对于一条经过 $l$ 条道路的简单环路（即除起点城市外**不经过重复城市**的环路），它可以表示为 $c_{1} \\rightarrow c_{2} \\rightarrow \\cdots \\rightarrow c_{l} \\rightarrow c_{1}$（其中对于所有 $1 \\leq i<l$，城市 $c_i$ 与城市 $c_{i+1}$ 有道路相连；城市 $c_l$ 与城市 $c_1$ 有道路相连；对于所有 $1 \\leq i<j \\leq l$，有 $c_{i} \\neq c_{j}$），若 $l > 3$，则 C 国的道路将满足下列条件：\n  - 存在两个在该环路上**不相邻**的城市 $u$, $v$，满足两个城市间有道路直接相连。即：存在 $1 \\leq u<v \\leq l$，使得 $v-u \\geq 2$，$u$ 和 $v$ 不同时为 $1$ 和 $l$，并且城市 $c_u$ 与城市 $c_v$ 间有道路直接相连。\n\n现在 C 国有了新的翻修计划，需要在城市 $s$ 与城市 $t$ 间寻找一条路径进行翻修。翻修时路径中包含的所有道路将无法通行，为了保障人民的日常生活，C 国希望在翻修这条路径时，经由**剩余**的道路（即没被包含在翻修路径内的道路）依然能满足：**从 C 国中任意一个城市出发，均能到达其他所有城市**。\n\nC 国找到了身为工程大师的你，请你帮助 C 国找出一条满足上述要求的翻修路径，并使得这条路径的总长**尽量小**。", "inputFormat": "第一行两个整数 $n$, $m$ 分别表示城市个数与道路条数。\n\n接下来 $m$ 行每行三个整数 $u_i$, $v_i$, $w_i$，依次表示每条道路的两个端点与它的长度。\n\n数据保证每条道路都一定连接两个不同城市，即 $u_i \\not= v_i$。\n\n最后一行两个整数 $s$, $t$，分别表示需要翻修的路径的两个端点。", "outputFormat": "仅一行一个整数，表示满足题目要求的情况下，翻修路径的总长的最小值。\n\n**如果不存在满足题目要求的路径，输出一行一个整数$-1$。**", "hint": "#### 样例 1 解释\n\n路径 $(1,2,1),(2,3,1),(3,4,1)$ 是城市 $1$ 和城市 $4$ 间总长最小的路径，但不符合要求。\n\n路径 $(1,3,5),(3,4,1)$ 符合要求，长度为 $6$。\n\n路径 $(1,2,1),(2,4,6)$ 符合要求，长度为 $7$。\n\n除上述两条路径外，没有其他满足要求的路径。\n\n#### 样例 3\n\n见选手目录下的 road/road3.in 与 road/road3.ans。该样例与测试点 $1 \\sim 6$ 限制相同。\n\n#### 样例 4\n\n见选手目录下的 road/road4.in 与 road/road4.ans。该样例与测试点 $7 \\sim 10$ 限制相同。\n\n#### 样例 5\n\n见选手目录下的 road/road5.in 与 road/road5.ans。该样例与测试点 $11 \\sim 15$ 限制相同。\n\n#### 样例 6\n\n见选手目录下的 road/road6.in 与 road/road6.ans。该样例与测试点 $16 \\sim 20$ 限制相同。\n\n---\n\n### 测试点约束\n\n对于所有测试点：$2 \\leq n \\leq 5 \\times 10^{5}$，$2 \\leq m \\leq 10^{6}$，$s \\neq t$。\n\n$1 \\leq u_{i}, v_{i} \\leq n$，$u_{i} \\neq v_{i}$，$1 \\leq w_{i} \\leq 10^{9}$，保证任意两条道路它们的端点不全相同。\n\n保证给出的道路满足题面描述第二段中的性质。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 |  $n\\le $ |  $m\\le $ | 特殊限制 |\n| :-: | :-: | :-:| :-: |\n|  $1\\sim 6$ |  $2\\times 10^3$ |  $4\\times 10^3$ | 无 |\n|  $7\\sim 10$ |  $5\\times 10^5$ |  $10^6$ |  $\\text{A}$ |\n|  $11\\sim 15$ |  $5\\times 10^5$ |  $10^6$ |  $\\text{B}$ |\n|  $16\\sim 20$ |  $5\\times 10^5$ |  $10^6$ | 无 |\n\n特殊限制 A：所有道路的长度均相等。\n\n特殊限制 B：所有 $w_i = 1$ 的道路恰好构成 $s$ 到 $t$ 的一条路径，且其他 $w_i \\not= 1$ 的道路的两条端点在这条路径上距离为 $2$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI2020] 翻修道路【数据有误】", "background": "本题官方数据有误。正确的解法见 [Shortest non-separating st-path on chordal graphs](https://arxiv.org/abs/2101.03519)。", "description": "C 国中包含 $n$ 座城市，这些城市通过 $m$ 条双向道路连接。城市从 $1$ 到 $n$ 编号，道路从 $1$ 到 $m$ 编号，$i$ 号道路两端连接着城市 $u_i$ 与城市 $v_i$，它的长度为 $w_i$ 米。经由这些道路，从 C 国中任意一个城市出发，均能到达其他所有城市。\n\nC 国人民喜欢环路旅程，但又不喜欢经过太多条道路，为此 C 国的道路被建造得非常特殊。更具体地，对于一条经过 $l$ 条道路的简单环路（即除起点城市外**不经过重复城市**的环路），它可以表示为 $c_{1} \\rightarrow c_{2} \\rightarrow \\cdots \\rightarrow c_{l} \\rightarrow c_{1}$（其中对于所有 $1 \\leq i<l$，城市 $c_i$ 与城市 $c_{i+1}$ 有道路相连；城市 $c_l$ 与城市 $c_1$ 有道路相连；对于所有 $1 \\leq i<j \\leq l$，有 $c_{i} \\neq c_{j}$），若 $l > 3$，则 C 国的道路将满足下列条件：\n  - 存在两个在该环路上**不相邻**的城市 $u$, $v$，满足两个城市间有道路直接相连。即：存在 $1 \\leq u<v \\leq l$，使得 $v-u \\geq 2$，$u$ 和 $v$ 不同时为 $1$ 和 $l$，并且城市 $c_u$ 与城市 $c_v$ 间有道路直接相连。\n\n现在 C 国有了新的翻修计划，需要在城市 $s$ 与城市 $t$ 间寻找一条路径进行翻修。翻修时路径中包含的所有道路将无法通行，为了保障人民的日常生活，C 国希望在翻修这条路径时，经由**剩余**的道路（即没被包含在翻修路径内的道路）依然能满足：**从 C 国中任意一个城市出发，均能到达其他所有城市**。\n\nC 国找到了身为工程大师的你，请你帮助 C 国找出一条满足上述要求的翻修路径，并使得这条路径的总长**尽量小**。", "inputFormat": "第一行两个整数 $n$, $m$ 分别表示城市个数与道路条数。\n\n接下来 $m$ 行每行三个整数 $u_i$, $v_i$, $w_i$，依次表示每条道路的两个端点与它的长度。\n\n数据保证每条道路都一定连接两个不同城市，即 $u_i \\not= v_i$。\n\n最后一行两个整数 $s$, $t$，分别表示需要翻修的路径的两个端点。", "outputFormat": "仅一行一个整数，表示满足题目要求的情况下，翻修路径的总长的最小值。\n\n**如果不存在满足题目要求的路径，输出一行一个整数$-1$。**", "hint": "#### 样例 1 解释\n\n路径 $(1,2,1),(2,3,1),(3,4,1)$ 是城市 $1$ 和城市 $4$ 间总长最小的路径，但不符合要求。\n\n路径 $(1,3,5),(3,4,1)$ 符合要求，长度为 $6$。\n\n路径 $(1,2,1),(2,4,6)$ 符合要求，长度为 $7$。\n\n除上述两条路径外，没有其他满足要求的路径。\n\n#### 样例 3\n\n见选手目录下的 road/road3.in 与 road/road3.ans。该样例与测试点 $1 \\sim 6$ 限制相同。\n\n#### 样例 4\n\n见选手目录下的 road/road4.in 与 road/road4.ans。该样例与测试点 $7 \\sim 10$ 限制相同。\n\n#### 样例 5\n\n见选手目录下的 road/road5.in 与 road/road5.ans。该样例与测试点 $11 \\sim 15$ 限制相同。\n\n#### 样例 6\n\n见选手目录下的 road/road6.in 与 road/road6.ans。该样例与测试点 $16 \\sim 20$ 限制相同。\n\n---\n\n### 测试点约束\n\n对于所有测试点：$2 \\leq n \\leq 5 \\times 10^{5}$，$2 \\leq m \\leq 10^{6}$，$s \\neq t$。\n\n$1 \\leq u_{i}, v_{i} \\leq n$，$u_{i} \\neq v_{i}$，$1 \\leq w_{i} \\leq 10^{9}$，保证任意两条道路它们的端点不全相同。\n\n保证给出的道路满足题面描述第二段中的性质。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 |  $n\\le $ |  $m\\le $ | 特殊限制 |\n| :-: | :-: | :-:| :-: |\n|  $1\\sim 6$ |  $2\\times 10^3$ |  $4\\times 10^3$ | 无 |\n|  $7\\sim 10$ |  $5\\times 10^5$ |  $10^6$ |  $\\text{A}$ |\n|  $11\\sim 15$ |  $5\\times 10^5$ |  $10^6$ |  $\\text{B}$ |\n|  $16\\sim 20$ |  $5\\times 10^5$ |  $10^6$ | 无 |\n\n特殊限制 A：所有道路的长度均相等。\n\n特殊限制 B：所有 $w_i = 1$ 的道路恰好构成 $s$ 到 $t$ 的一条路径，且其他 $w_i \\not= 1$ 的道路的两条端点在这条路径上距离为 $2$。", "locale": "zh-CN"}}}
{"pid": "P6778", "type": "P", "difficulty": 7, "samples": [["6 6\n2 1 1\n5 1 1\n3 1 3\n4 5 1\n6 3 3\n2 5\n1 5\n1 4\n3 6\n2 6\n1 1", "19\n26\n18\n28\n44\n0"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2009", "莫队", "O2优化", "分块", "Ynoi"], "title": "[Ynoi2009] rpdq", "background": "", "description": "给定一棵 $n$ 个节点的无根，有边权的树，每个点有个编号，编号为一个 $1 \\sim n$ 的排列。\n\n共 $m$ 组询问，每次询问给出 $l,r$，求所有点编号的二元组 $(i,j)$ 满足 $l \\le i<j \\le r$ 在树上的距离的和，两个点的距离定义为连接其的简单路径上的所有边的边权和。", "inputFormat": "第一行两个空格隔开的数 $n$ $m$。\n\n之后 $n-1$ 行，每行三个空格隔开的数 $u$ $v$ $d$ 表示一条 $u$ 和 $v$ 之间边权为 $d$ 的边。\n\n之后 $m$ 行，每行两个空格隔开的数 $l$ $r$ 表示一次询问。", "outputFormat": "共 $m$ 行，表示每个询问对应的答案，答案对 $2^{32}$ 取模。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：zx2003，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\le n,m,d\\le 2\\cdot 10^5$，所有数值均为整数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2009] rpdq", "background": "", "description": "给定一棵 $n$ 个节点的无根，有边权的树，每个点有个编号，编号为一个 $1 \\sim n$ 的排列。\n\n共 $m$ 组询问，每次询问给出 $l,r$，求所有点编号的二元组 $(i,j)$ 满足 $l \\le i<j \\le r$ 在树上的距离的和，两个点的距离定义为连接其的简单路径上的所有边的边权和。", "inputFormat": "第一行两个空格隔开的数 $n$ $m$。\n\n之后 $n-1$ 行，每行三个空格隔开的数 $u$ $v$ $d$ 表示一条 $u$ 和 $v$ 之间边权为 $d$ 的边。\n\n之后 $m$ 行，每行两个空格隔开的数 $l$ $r$ 表示一次询问。", "outputFormat": "共 $m$ 行，表示每个询问对应的答案，答案对 $2^{32}$ 取模。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：zx2003，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\le n,m,d\\le 2\\cdot 10^5$，所有数值均为整数。", "locale": "zh-CN"}}}
{"pid": "P6779", "type": "P", "difficulty": 7, "samples": [["5 6 2\n3 2 2\n5 3 3\n1 2 4\n4 2 3\n3 3 3 1 2\n2 1 1\n2 2 3\n2 4 5\n1 2 3\n1 4 4\n2 1 2", "2\n2\n0\n0"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2009", "O2优化", "Ynoi"], "title": "[Ynoi2009] rla1rmdq", "background": "", "description": "给定一棵 $n$ 个节点的树，树有边权，与一个长为 $n$ 的序列 $a$。\n\n定义节点 $x$ 的父亲为 $fa(x)$，根 $rt$ 满足 $fa(rt)=rt$。\n\n定义节点 $x$ 的深度 $dep(x)$ 为其到根简单路径上所有边权和。\n\n有 $m$ 次操作：\n\n`1 l r`：对于 $l \\le i \\le r$， $a_i := fa(a_i)$ 。 \n\n`2 l r `：查询对于 $l \\le i \\le r$，最小的 $dep(a_i)$。", "inputFormat": "第一行三个空格隔开的数 $n$ $m$ $rt$，其中 $rt$ 表示根节点的编号。\n\n之后 $n-1$ 行，每行三个空格隔开的数 $u,v,w$ 表示一条 $u$ 与 $v$ 之间，边权为 $w$ 的边。\n\n之后一行 $n$ 个空格隔开的数表示这个序列。\n\n之后 $m$ 行，每行三个用空格隔开的数，表示一次操作。", "outputFormat": "对每个 $2$ 操作，输出一行一个数表示其对应的答案。", "hint": "Idea：yummy，Solution：nzhtl1477&memset0，Code：nzhtl1477，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 2\\cdot 10^5$，$1\\le a_i\\le n$，边权在 $[0,10^9]$ 之间。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2009] rla1rmdq", "background": "", "description": "给定一棵 $n$ 个节点的树，树有边权，与一个长为 $n$ 的序列 $a$。\n\n定义节点 $x$ 的父亲为 $fa(x)$，根 $rt$ 满足 $fa(rt)=rt$。\n\n定义节点 $x$ 的深度 $dep(x)$ 为其到根简单路径上所有边权和。\n\n有 $m$ 次操作：\n\n`1 l r`：对于 $l \\le i \\le r$， $a_i := fa(a_i)$ 。 \n\n`2 l r `：查询对于 $l \\le i \\le r$，最小的 $dep(a_i)$。", "inputFormat": "第一行三个空格隔开的数 $n$ $m$ $rt$，其中 $rt$ 表示根节点的编号。\n\n之后 $n-1$ 行，每行三个空格隔开的数 $u,v,w$ 表示一条 $u$ 与 $v$ 之间，边权为 $w$ 的边。\n\n之后一行 $n$ 个空格隔开的数表示这个序列。\n\n之后 $m$ 行，每行三个用空格隔开的数，表示一次操作。", "outputFormat": "对每个 $2$ 操作，输出一行一个数表示其对应的答案。", "hint": "Idea：yummy，Solution：nzhtl1477&memset0，Code：nzhtl1477，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 2\\cdot 10^5$，$1\\le a_i\\le n$，边权在 $[0,10^9]$ 之间。", "locale": "zh-CN"}}}
{"pid": "P6780", "type": "P", "difficulty": 7, "samples": [["5 10 2\n0 -5 -3 8 -3\n1 5 -1\n1 2 3\n1 5 -6\n1 2 9\n2 5 5\n2 3 3\n1 1 -3\n2 4 4\n1 1 4\n1 3 3\n", "0\n0\n8\n"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2009", "O2优化", "Ynoi"], "title": "[Ynoi2009] pmrllcsrms", "background": "", "description": "给你一个长度为 $n$ 的整数序列 $a$，和一个常数 $c$ 。\n\n\n有 $m$ 次操作：\n\n`1 x y`：将位置 $x$ 的值修改为 $y$。\n\n`2 l r`：表示询问区间 $[l,r]$ 中 $\\max\\left(\\max_{l \\leq l' \\leq r' \\leq r\\atop r'-l'+1\\leq c}  ~~ \\left(\\sum_{i=l'} ^{r'} a_i\\right), 0\\right)$。", "inputFormat": "第一行三个正整数 $n,m,c$ ，分别表示序列长度，操作次数，以及给定的常数。\n\n之后一行 $n$ 个整数 $a_1,\\dots,a_n$ 表示序列 $a$ 。\n\n之后 $m$ 行，每行三个数表示一次操作，意义如上述。", "outputFormat": "对每个询问，输出一行一个数表示答案。", "hint": "Idea：chenkuowen&nzhtl1477，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n对于 $100\\%$ 的数据，$1 \\le n\\le 10^6, 1\\le  m\\le 2\\times10^6, 1\\le x,c\\le n, 1\\le l\\le r\\le n, -10^9 \\le a_i,y \\le 10^9$ 。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2009] pmrllcsrms", "background": "", "description": "给你一个长度为 $n$ 的整数序列 $a$，和一个常数 $c$ 。\n\n\n有 $m$ 次操作：\n\n`1 x y`：将位置 $x$ 的值修改为 $y$。\n\n`2 l r`：表示询问区间 $[l,r]$ 中 $\\max\\left(\\max_{l \\leq l' \\leq r' \\leq r\\atop r'-l'+1\\leq c}  ~~ \\left(\\sum_{i=l'} ^{r'} a_i\\right), 0\\right)$。", "inputFormat": "第一行三个正整数 $n,m,c$ ，分别表示序列长度，操作次数，以及给定的常数。\n\n之后一行 $n$ 个整数 $a_1,\\dots,a_n$ 表示序列 $a$ 。\n\n之后 $m$ 行，每行三个数表示一次操作，意义如上述。", "outputFormat": "对每个询问，输出一行一个数表示答案。", "hint": "Idea：chenkuowen&nzhtl1477，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n对于 $100\\%$ 的数据，$1 \\le n\\le 10^6, 1\\le  m\\le 2\\times10^6, 1\\le x,c\\le n, 1\\le l\\le r\\le n, -10^9 \\le a_i,y \\le 10^9$ 。", "locale": "zh-CN"}}}
{"pid": "P6781", "type": "P", "difficulty": 7, "samples": [["10 10\n0 1\n1 9\n1 2\n0 5\n1 1\n0 6\n1 1\n0 4\n0 8\n1 7\n2 5 7\n3 1 10\n1 1 3\n2 1 3\n3 2 9\n3 4 10\n3 7 8\n1 10 2\n3 3 4\n2 5 7", "4294967295\n4294967284\n4294967281"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2008", "O2优化", "Ynoi"], "title": "[Ynoi2008] rupq", "background": "", "description": "给定一个长为 $n$ 的括号序列，每个位置有一个括号 $a_i$，其中 $a_i=1$ 代表是左括号 $'('$，$a_i=0$ 代表是右括号 $')'$。 $a_i$ 位置的括号有一个权值 $b_i$。\n\n对任意括号序列，通过不断删除形如 $'()'$ 的子段直到无法操作，最终可以得到一个唯一的序列，这个序列称为不匹配括号，如 $a_1=')',a_2='(',a_3='(',a_4=')',a_5='('$，这个括号序列的不匹配括号序列为 $')(('$，其不匹配括号对应位置为 $1,2,5$，其不匹配括号对应位置的 $b$ 为 $b_1,b_2,b_5$。\n\n有 $m$ 次操作，操作有以下三类：\n\n`1 x y`：进行单点修改，即 $a_x:=1-a_x; b_x:=y$。\n\n`2 l r`：求 $a[l..r]$ 中不匹配括号对应位置的 $b$ 从左到右的 $\\texttt {NAND}$ （$32$ 位的按位与非，可以见 https://en.wikipedia.org/wiki/NAND_logic ）， $\\texttt {max}$（最大值） ，将二者 $\\texttt {xor}$ 后输出。如果不匹配括号为空序列，则 $\\texttt {NAND}$ 的答案为 $2^{32}-1$， $\\texttt {max}$ 的答案为 $0$。\n\n$\\texttt {NAND}$ 即以 $c_0=2^{32}-1$ 为初值，然后依次 $c_i=\\texttt {NAND}(c_{i-1},b_i)$，对于一个 $n$ 个值的序列 $b$，最后答案为 $c_n$。\n\n`3 l r`：将 $a[l..r]$ 和 $a[r+1..n]$ 交换位置，$b$ 也做同样的操作。\n", "inputFormat": "第一行用空格隔开的两个数 $n,m$。\n\n之后 $n$ 行每行用空格隔开的两个数，第 $i$ 行为 $a_i,b_i$。\n\n之后 $m$ 行，每行表示一个操作。", "outputFormat": "对每个操作 $2$ 输出一行表示答案。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，\n\n$0 \\le a[i] \\le 1$。\n\n$0 \\le b[i] \\le 10^9$。\n\n$1 \\le n \\le 2\\times10^6,1 \\le m \\le 2\\times10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2008] rupq", "background": "", "description": "给定一个长为 $n$ 的括号序列，每个位置有一个括号 $a_i$，其中 $a_i=1$ 代表是左括号 $'('$，$a_i=0$ 代表是右括号 $')'$。 $a_i$ 位置的括号有一个权值 $b_i$。\n\n对任意括号序列，通过不断删除形如 $'()'$ 的子段直到无法操作，最终可以得到一个唯一的序列，这个序列称为不匹配括号，如 $a_1=')',a_2='(',a_3='(',a_4=')',a_5='('$，这个括号序列的不匹配括号序列为 $')(('$，其不匹配括号对应位置为 $1,2,5$，其不匹配括号对应位置的 $b$ 为 $b_1,b_2,b_5$。\n\n有 $m$ 次操作，操作有以下三类：\n\n`1 x y`：进行单点修改，即 $a_x:=1-a_x; b_x:=y$。\n\n`2 l r`：求 $a[l..r]$ 中不匹配括号对应位置的 $b$ 从左到右的 $\\texttt {NAND}$ （$32$ 位的按位与非，可以见 https://en.wikipedia.org/wiki/NAND_logic ）， $\\texttt {max}$（最大值） ，将二者 $\\texttt {xor}$ 后输出。如果不匹配括号为空序列，则 $\\texttt {NAND}$ 的答案为 $2^{32}-1$， $\\texttt {max}$ 的答案为 $0$。\n\n$\\texttt {NAND}$ 即以 $c_0=2^{32}-1$ 为初值，然后依次 $c_i=\\texttt {NAND}(c_{i-1},b_i)$，对于一个 $n$ 个值的序列 $b$，最后答案为 $c_n$。\n\n`3 l r`：将 $a[l..r]$ 和 $a[r+1..n]$ 交换位置，$b$ 也做同样的操作。\n", "inputFormat": "第一行用空格隔开的两个数 $n,m$。\n\n之后 $n$ 行每行用空格隔开的两个数，第 $i$ 行为 $a_i,b_i$。\n\n之后 $m$ 行，每行表示一个操作。", "outputFormat": "对每个操作 $2$ 输出一行表示答案。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，\n\n$0 \\le a[i] \\le 1$。\n\n$0 \\le b[i] \\le 10^9$。\n\n$1 \\le n \\le 2\\times10^6,1 \\le m \\le 2\\times10^5$。", "locale": "zh-CN"}}}
{"pid": "P6782", "type": "P", "difficulty": 6, "samples": [["10 10 7\n4 2\n10 4\n3 2\n6 10\n9 2\n7 3\n1 4\n8 2\n5 3\n8 10 10\n2 6 2\n3 6 2\n4 6 4\n3 10 2\n8 8 10\n3 10 4\n2 3 2\n2 6 4\n1 7 10", "0\n2\n0\n1\n7\n0\n2\n0\n1\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2008", "莫队", "O2优化", "分块", "Ynoi", "根号分治"], "title": "[Ynoi2008] rplexq", "background": "", "description": "给定一棵 $n$ 个节点的有根树，第 $i$ 个点的编号是 $i$。\n\n有 $m$ 次询问，每次询问给出 $l,r,x$，求有多少点编号的二元组 $(i,j)$ 满足 $l \\le i < j \\le r$ 且 $i$ 和 $j$ 的最近公共祖先是节点 $x$。", "inputFormat": "第一行三个数 $n$ $m$ $rt$，其中 $rt$ 表示根节点的编号。\n\n之后 $n-1$ 行，每行两个数 $u$ $v$ 表示一条边。\n\n之后 $m$ 行，每行三个数 $l$ $r$ $x$ 表示一次询问。", "outputFormat": "共 $m$ 行，表示每个询问对应的答案", "hint": "Idea：Ynoi，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 2\\cdot 10^5$，$1 \\le l,r,x \\le n$。\n\n#### 样例解释 ####\n\n`2 6 2`：符合条件的有 $(2,4)$，$(2,6)$。\n\n`4 6 4`：符合条件的有 $(4,6)$ 。\n\n`3 10 2`：符合条件的有 $(4,8)$ ，$(4,9)$，$(6,8)$，$(6,9)$，$(8,9)$，$(8,10)$，$(9,10)$。\n\n`3 10 4`：符合条件的有 $(4,6)$，$(4,10)$。\n\n`2 6 4`：符合条件的有 $(4,6)$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2008] rplexq", "background": "", "description": "给定一棵 $n$ 个节点的有根树，第 $i$ 个点的编号是 $i$。\n\n有 $m$ 次询问，每次询问给出 $l,r,x$，求有多少点编号的二元组 $(i,j)$ 满足 $l \\le i < j \\le r$ 且 $i$ 和 $j$ 的最近公共祖先是节点 $x$。", "inputFormat": "第一行三个数 $n$ $m$ $rt$，其中 $rt$ 表示根节点的编号。\n\n之后 $n-1$ 行，每行两个数 $u$ $v$ 表示一条边。\n\n之后 $m$ 行，每行三个数 $l$ $r$ $x$ 表示一次询问。", "outputFormat": "共 $m$ 行，表示每个询问对应的答案", "hint": "Idea：Ynoi，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 2\\cdot 10^5$，$1 \\le l,r,x \\le n$。\n\n#### 样例解释 ####\n\n`2 6 2`：符合条件的有 $(2,4)$，$(2,6)$。\n\n`4 6 4`：符合条件的有 $(4,6)$ 。\n\n`3 10 2`：符合条件的有 $(4,8)$ ，$(4,9)$，$(6,8)$，$(6,9)$，$(8,9)$，$(8,10)$，$(9,10)$。\n\n`3 10 4`：符合条件的有 $(4,6)$，$(4,10)$。\n\n`2 6 4`：符合条件的有 $(4,6)$。", "locale": "zh-CN"}}}
{"pid": "P6783", "type": "P", "difficulty": 7, "samples": [["10\n6 4\n2 3\n4 3\n10 8\n8 8\n9 9\n7 3\n1 9\n5 7\n3 7\n10\n1 3 2 5\n3 7 8 10\n3 4 3 6\n3 4 5 7\n6 8 1 8\n4 9 6 9\n1 5 6 9\n4 9 2 7\n1 1 1 5\n1 1 4 9\n10\n2 6\n7 8\n2 8\n6 9\n9 10\n4 5\n5 6\n3 7\n7 10\n1 2", "40\n22\n51\n31\n4\n12\n29\n36\n22\n31"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2008", "O2优化", "洛谷月赛", "Ynoi"], "title": "[Ynoi2008] rrusq", "background": "", "description": "给定一个二维平面，有 $n$ 个关键点，$m$ 个矩形，以及 $q$ 个询问，每个关键点有一个权值 $a_i$。\n\n定义一个左下角为 $(x_i,y_i)$，右上角为 $(x'_i,y'_i)$ 的矩形包含一个点 $a,b$，当且仅当 $x_i\\le a\\le x'_i$ 且 $y_i\\le b\\le y'_i$。\n\n每次询问给定 $[l,r]$，对于一个关键点 $i$ ，如果点 $i$ 在编号在 $[l,r]$ 内的任意一个矩形中，则认为 $i$ 被区间 $[l,r]$ 的矩形并包含，输出区间 $[l,r]$ 的矩形并包含的所有关键点的权值和。", "inputFormat": "第一行一个数 $n$。\n\n之后 $n$ 行每行两个元素 $p_i,a_i$，表示第 $i$ 个关键点 $(i,p_i)$，权值为 $a_i$，保证 $p$ 为一个 $1$ 到 $n$ 的排列。\n\n之后一行一个数 $m$。\n\n之后 $m$ 行每行四个元素 $x_i,x'_i,y_i,y'_i$，表示第 $i$ 个矩形左下角为 $(x_i,y_i)$，右上角为 $(x'_i,y'_i)$。\n\n之后一行一个数 $q$。\n\n之后 $q$ 行每行两个元素 $l,r$，表示一次对区间 $[l,r]$ 的询问。", "outputFormat": "对于每次询问，输出一行一个数表示答案。", "hint": "Idea：nzhtl1477&ccz181078，Solution：zx2003，Code：ccz181078，Data：nzhtl1477\n\n注意：本题采用**捆绑测试**，只有当你通过一个 subtask 中的所有测试点后，你才能拿到这个 subtask 的分数。\n\n对于其中 $5\\%$ 的数据，为样例 1。\n\n对于另外 $14\\%$ 的数据，$q=1$。\n\n对于另外 $19\\%$ 的数据，$n,m,q\\leq 500$。\n\n对于另外 $19\\%$ 的数据，$n,m\\leq 500$。\n\n对于另外 $19\\%$ 的数据，$n,m,q\\leq 2000$。\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 10^5$，$1\\leq q \\leq 10^6$。\n\n$1\\leq a_i \\leq 10000$，$1\\leq x_i\\leq x_i'\\leq n$，$1\\leq y_i\\leq y_i'\\leq n$，$1\\leq l\\leq r\\leq m$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2008] rrusq", "background": "", "description": "给定一个二维平面，有 $n$ 个关键点，$m$ 个矩形，以及 $q$ 个询问，每个关键点有一个权值 $a_i$。\n\n定义一个左下角为 $(x_i,y_i)$，右上角为 $(x'_i,y'_i)$ 的矩形包含一个点 $a,b$，当且仅当 $x_i\\le a\\le x'_i$ 且 $y_i\\le b\\le y'_i$。\n\n每次询问给定 $[l,r]$，对于一个关键点 $i$ ，如果点 $i$ 在编号在 $[l,r]$ 内的任意一个矩形中，则认为 $i$ 被区间 $[l,r]$ 的矩形并包含，输出区间 $[l,r]$ 的矩形并包含的所有关键点的权值和。", "inputFormat": "第一行一个数 $n$。\n\n之后 $n$ 行每行两个元素 $p_i,a_i$，表示第 $i$ 个关键点 $(i,p_i)$，权值为 $a_i$，保证 $p$ 为一个 $1$ 到 $n$ 的排列。\n\n之后一行一个数 $m$。\n\n之后 $m$ 行每行四个元素 $x_i,x'_i,y_i,y'_i$，表示第 $i$ 个矩形左下角为 $(x_i,y_i)$，右上角为 $(x'_i,y'_i)$。\n\n之后一行一个数 $q$。\n\n之后 $q$ 行每行两个元素 $l,r$，表示一次对区间 $[l,r]$ 的询问。", "outputFormat": "对于每次询问，输出一行一个数表示答案。", "hint": "Idea：nzhtl1477&ccz181078，Solution：zx2003，Code：ccz181078，Data：nzhtl1477\n\n注意：本题采用**捆绑测试**，只有当你通过一个 subtask 中的所有测试点后，你才能拿到这个 subtask 的分数。\n\n对于其中 $5\\%$ 的数据，为样例 1。\n\n对于另外 $14\\%$ 的数据，$q=1$。\n\n对于另外 $19\\%$ 的数据，$n,m,q\\leq 500$。\n\n对于另外 $19\\%$ 的数据，$n,m\\leq 500$。\n\n对于另外 $19\\%$ 的数据，$n,m,q\\leq 2000$。\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 10^5$，$1\\leq q \\leq 10^6$。\n\n$1\\leq a_i \\leq 10000$，$1\\leq x_i\\leq x_i'\\leq n$，$1\\leq y_i\\leq y_i'\\leq n$，$1\\leq l\\leq r\\leq m$。\n", "locale": "zh-CN"}}}
{"pid": "P6784", "type": "P", "difficulty": 2, "samples": [["1 2 3", "2"], ["1 5 3", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["模拟", "贪心", "2020", "洛谷原创", "枚举", "洛谷月赛"], "title": "「EZEC-3」造房子", "background": "pigstd 要去造房子了。", "description": "pigstd 有 $a$ 个 A 材料和 $b$ 个 B 材料，造**第** $i$ 层楼需要 $i$ 个 A 材料与 $i$ 个 B 材料。\n\n但是 pigstd 觉得房子不够高，于是他拿出了 $c$ 块钱，每块钱都可以用来买 $1$ 个 A 材料或者 $1$ 个 B 材料。\n\n现在 pigstd 想知道，他最多能建多少层楼的房子。", "inputFormat": "第一行三个整数 $a,b,c$。", "outputFormat": "一行一个整数，表示 pigstd 最多能建多少层楼的房子。", "hint": "**【样例 1 说明】**\n\npigstd 买 $2$ 个 A 材料和 $1$ 个 B 材料后就有 $3$ 个 A 材料和 $3$ 个 B 材料，最多可以建 $2$ 层楼的房子。\n\n（花费 $1+2$ 个 A 材料和 $1+2$ 个 B 材料）\n\n**【样例 2 说明】**\n\npigstd 买 $3$ 个 A 材料后就有 $4$ 个 A 材料和 $5$ 个 B 材料，最多可以建 $2$ 层楼的房子。\n\n（花费 $1+2$ 个 A 材料和 $1+2$ 个 B 材料）\n\n**【数据规模与约定】**\n\n对于 $100\\%$ 的数据，$0 \\le a,b,c \\le 10^{12}$。\n\n| 数据点编号 | 满足的条件 |\n| :----------: | :----------: |\n|$1-4,22$| $c = 0$ |\n|$5-8,21$| $a,b,c \\le 10^{3}$ |\n|$9-12$| $a,b,c \\le 10^{6}$ |\n|$13-20$| $a,b,c \\le 10^{12}$ | ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-3」造房子", "background": "pigstd 要去造房子了。", "description": "pigstd 有 $a$ 个 A 材料和 $b$ 个 B 材料，造**第** $i$ 层楼需要 $i$ 个 A 材料与 $i$ 个 B 材料。\n\n但是 pigstd 觉得房子不够高，于是他拿出了 $c$ 块钱，每块钱都可以用来买 $1$ 个 A 材料或者 $1$ 个 B 材料。\n\n现在 pigstd 想知道，他最多能建多少层楼的房子。", "inputFormat": "第一行三个整数 $a,b,c$。", "outputFormat": "一行一个整数，表示 pigstd 最多能建多少层楼的房子。", "hint": "**【样例 1 说明】**\n\npigstd 买 $2$ 个 A 材料和 $1$ 个 B 材料后就有 $3$ 个 A 材料和 $3$ 个 B 材料，最多可以建 $2$ 层楼的房子。\n\n（花费 $1+2$ 个 A 材料和 $1+2$ 个 B 材料）\n\n**【样例 2 说明】**\n\npigstd 买 $3$ 个 A 材料后就有 $4$ 个 A 材料和 $5$ 个 B 材料，最多可以建 $2$ 层楼的房子。\n\n（花费 $1+2$ 个 A 材料和 $1+2$ 个 B 材料）\n\n**【数据规模与约定】**\n\n对于 $100\\%$ 的数据，$0 \\le a,b,c \\le 10^{12}$。\n\n| 数据点编号 | 满足的条件 |\n| :----------: | :----------: |\n|$1-4,22$| $c = 0$ |\n|$5-8,21$| $a,b,c \\le 10^{3}$ |\n|$9-12$| $a,b,c \\le 10^{6}$ |\n|$13-20$| $a,b,c \\le 10^{12}$ | ", "locale": "zh-CN"}}}
{"pid": "P6785", "type": "P", "difficulty": 3, "samples": [["4 3 \n1 5\n2 4\n3 3\n0 2", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["模拟", "2020", "洛谷原创", "洛谷月赛"], "title": "「EZEC-3」排列", "background": "", "description": "pigstd 有一堆数，他想在这么多数中选出若干个数排成一列，记为 $x_{1},x_{2},\\cdots,x_{p}$（$p$ 为数的个数）。\n\n这一列数合法**当且仅当**满足以下条件：\n\n- $p \\ge 2$。\n- 令 $y_{i} = x_{i + 1} - x_{i}$（特别的，$y_{p}=x_{1}-x_{p}$），如果把 $y_{1}$ 到 $y_{p}$ 按 $y_1,y_2,\\cdots,y_p$ 的顺序排成**一圈**，那么每两个相邻的数互为相反数且绝对值都为 $k$。\n\npigstd 想知道，在所有合法的数列中，所有在这个数列中的数之和**最大**是多少。", "inputFormat": "第一行两个整数 $n,k$。\n\n接下来 $n$ 行，每行两个整数 $a_{i},b_{i}$，表示 pigstd 有 $b_{i}$ 个 $a_{i}$。\n\n**不保证 $a_{i}$ 互不相同，若有 $a_{i}$ 相同则累加其个数计算。**", "outputFormat": "一行一个整数，表示在每一种排列中，所有在这个排列中的数的**最大**的和。\n\n**若没有合法的排列，则只输出 $\\texttt{NO}$。**", "hint": "**【样例 1 说明】**\n\n当 pigstd 的排列为：$0,3,0,3$ 或 $3,0,3,0$ 时，总和最大，为 $6$。\n\n**【数据规模与约定】**\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^6$，$0 \\le k,a_{i} \\le 10^6$，$1 \\le b_{i} \\le 10^6$。\n\n**本题采用捆绑测试。**\n\n- Subtask 1（5 points）：保证无合法的数列；\n- Subtask 2（15 points）：$k = 0$；\n- Subtask 3（5 points）：$n = 1$；\n- Subtask 4（5 points）：$n = 2$；\n- Subtask 5（30 points）：$n,k,a_i,b_i \\le 10^3$；\n- Subtask 6（40 points）：无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-3」排列", "background": "", "description": "pigstd 有一堆数，他想在这么多数中选出若干个数排成一列，记为 $x_{1},x_{2},\\cdots,x_{p}$（$p$ 为数的个数）。\n\n这一列数合法**当且仅当**满足以下条件：\n\n- $p \\ge 2$。\n- 令 $y_{i} = x_{i + 1} - x_{i}$（特别的，$y_{p}=x_{1}-x_{p}$），如果把 $y_{1}$ 到 $y_{p}$ 按 $y_1,y_2,\\cdots,y_p$ 的顺序排成**一圈**，那么每两个相邻的数互为相反数且绝对值都为 $k$。\n\npigstd 想知道，在所有合法的数列中，所有在这个数列中的数之和**最大**是多少。", "inputFormat": "第一行两个整数 $n,k$。\n\n接下来 $n$ 行，每行两个整数 $a_{i},b_{i}$，表示 pigstd 有 $b_{i}$ 个 $a_{i}$。\n\n**不保证 $a_{i}$ 互不相同，若有 $a_{i}$ 相同则累加其个数计算。**", "outputFormat": "一行一个整数，表示在每一种排列中，所有在这个排列中的数的**最大**的和。\n\n**若没有合法的排列，则只输出 $\\texttt{NO}$。**", "hint": "**【样例 1 说明】**\n\n当 pigstd 的排列为：$0,3,0,3$ 或 $3,0,3,0$ 时，总和最大，为 $6$。\n\n**【数据规模与约定】**\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^6$，$0 \\le k,a_{i} \\le 10^6$，$1 \\le b_{i} \\le 10^6$。\n\n**本题采用捆绑测试。**\n\n- Subtask 1（5 points）：保证无合法的数列；\n- Subtask 2（15 points）：$k = 0$；\n- Subtask 3（5 points）：$n = 1$；\n- Subtask 4（5 points）：$n = 2$；\n- Subtask 5（30 points）：$n,k,a_i,b_i \\le 10^3$；\n- Subtask 6（40 points）：无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P6786", "type": "P", "difficulty": 4, "samples": [["4\n4 3 2 1", "5"], ["10\n6 7 18 4 17 10 9 1 3 8", "19"], ["3\n123456789 234567890 123456789", "246913578"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "数学", "2020", "洛谷原创", "O2优化", "枚举", "洛谷月赛"], "title": "「SWTR-6」GCD & LCM", "background": "", "description": "小 A 有一个长度为 $n$ 的序列 $a_1,a_2,\\cdots,a_n$。\n\n他想从这些数中选出一些数 $b_1,b_2,\\cdots,b_k$ 满足：对于所有 $i\\ (1\\leq i\\leq k)$，$b_i$ 要么是序列 $b$ 中的最大值，要么存在一个位置 $j$ 使得 $b_j>b_i$ 且 $b_i+b_j+\\gcd(b_i,b_j)=\\mathrm{lcm}(b_i,b_j)$。\n\n- 如果你不知道 $\\gcd$ 和 $\\mathrm{lcm}$ 是什么，可以点击最底部的「帮助/提示」部分的链接。\n\n小 A 想让选出的数之和尽量大。请求出这个最大值。", "inputFormat": "第一行一个整数 $n$，表示序列的长度。\n\n第二行 $n$ 个整数 $a_1,a_2,\\cdots,a_n$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "**「样例 1 说明」**\n\n可以选择 $b=\\{2,3\\}$，因为 $2+3+\\gcd(2,3)=\\mathrm{lcm}(2,3)$。\n\n**「数据范围与约定」**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（5 points）：$n\\leq2$；\n- Subtask 2（20 points）：$n\\leq 17$；\n- Subtask 3（15 points）：$a_i\\leq 2\\times 10^3$；\n- Subtask 4（15 points）：$n\\leq 2\\times 10^3$；\n- Subtask 5（10 points）：$n\\leq 5\\times 10^4$；\n- Subtask 6（10 points）：$a_i\\leq 10^7$；\n- Subtask 7（25 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 3\\times 10^5$，$1\\leq a_i\\leq 10^9$。\n\n**「帮助/提示」**\n\n$\\gcd$ 表示[最大公约数](https://baike.baidu.com/item/%E6%9C%80%E5%A4%A7%E5%85%AC%E7%BA%A6%E6%95%B0/869308?fr=aladdin)，$\\mathrm{lcm}$ 表示[最小公倍数](https://baike.baidu.com/item/%E6%9C%80%E5%B0%8F%E5%85%AC%E5%80%8D%E6%95%B0/6192375?fr=aladdin)。\n\n**「来源」**\n\n[【LGR-075】洛谷 8 月月赛 II Div.2 & SWTR-06 & EZEC Round 3](https://www.luogu.com.cn/contest/33190)。\n\nidea & solution & data by [Alex_Wei](https://www.luogu.com.cn/user/123294)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「SWTR-6」GCD & LCM", "background": "", "description": "小 A 有一个长度为 $n$ 的序列 $a_1,a_2,\\cdots,a_n$。\n\n他想从这些数中选出一些数 $b_1,b_2,\\cdots,b_k$ 满足：对于所有 $i\\ (1\\leq i\\leq k)$，$b_i$ 要么是序列 $b$ 中的最大值，要么存在一个位置 $j$ 使得 $b_j>b_i$ 且 $b_i+b_j+\\gcd(b_i,b_j)=\\mathrm{lcm}(b_i,b_j)$。\n\n- 如果你不知道 $\\gcd$ 和 $\\mathrm{lcm}$ 是什么，可以点击最底部的「帮助/提示」部分的链接。\n\n小 A 想让选出的数之和尽量大。请求出这个最大值。", "inputFormat": "第一行一个整数 $n$，表示序列的长度。\n\n第二行 $n$ 个整数 $a_1,a_2,\\cdots,a_n$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "**「样例 1 说明」**\n\n可以选择 $b=\\{2,3\\}$，因为 $2+3+\\gcd(2,3)=\\mathrm{lcm}(2,3)$。\n\n**「数据范围与约定」**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（5 points）：$n\\leq2$；\n- Subtask 2（20 points）：$n\\leq 17$；\n- Subtask 3（15 points）：$a_i\\leq 2\\times 10^3$；\n- Subtask 4（15 points）：$n\\leq 2\\times 10^3$；\n- Subtask 5（10 points）：$n\\leq 5\\times 10^4$；\n- Subtask 6（10 points）：$a_i\\leq 10^7$；\n- Subtask 7（25 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 3\\times 10^5$，$1\\leq a_i\\leq 10^9$。\n\n**「帮助/提示」**\n\n$\\gcd$ 表示[最大公约数](https://baike.baidu.com/item/%E6%9C%80%E5%A4%A7%E5%85%AC%E7%BA%A6%E6%95%B0/869308?fr=aladdin)，$\\mathrm{lcm}$ 表示[最小公倍数](https://baike.baidu.com/item/%E6%9C%80%E5%B0%8F%E5%85%AC%E5%80%8D%E6%95%B0/6192375?fr=aladdin)。\n\n**「来源」**\n\n[【LGR-075】洛谷 8 月月赛 II Div.2 & SWTR-06 & EZEC Round 3](https://www.luogu.com.cn/contest/33190)。\n\nidea & solution & data by [Alex_Wei](https://www.luogu.com.cn/user/123294)。", "locale": "zh-CN"}}}
{"pid": "P6787", "type": "P", "difficulty": 5, "samples": [["4\n1 4 2 3\n3 -1 -1 2", "4\n3 2\n1 4"], ["4\n5 7 1 3\n-1 -1 1 1", "7\n1 2\n3 4"], ["4\n1 9 4 5\n4 -1 4 2", "-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "2020", "Special Judge", "O2优化", "构造", "洛谷月赛"], "title": "「SWTR-6」Snow Mountain", "background": "**题目背景与解题无关。**\n\n**题目描述最下方有简化版题意。**\n\n天空中飘着雪，放眼望去白茫茫一片。小 A 拿着地图，四处探寻着。\n\n突然，只见前方有一个洞穴。出于好奇心，小 A 走了进去。\n\n洞穴里黑漆漆一片，一眼望不到尽头。道路的两旁尽是白骨，显然，这是曾经来这里探险的人们的残骸。小 A 打了一个冷颤。\n\n这时，小 A 留意到了地上的一张纸片。打开来一看，上面竟写着：\n\n$$\\texttt{Please contact lydsy2012@163.com!}$$", "description": "> 洞穴里有一些水晶，每个水晶有一个能量值 $a_i$。**能量值有大有小，但不会相同。** 这些神秘的水晶上附着邪恶势力的灵魂。现在你的任务是摧毁这些水晶，并让它们释放出的邪恶能量能量尽可能小。\n> \n> 你可以选择两个未被摧毁的水晶 $i,j$，将它们摧毁并释放出 $\\min(a_i,a_j)\\times k$ 的邪恶能量。其中 $k$ 表示这是第 $k$ 次摧毁。\n> \n> 不过有一些**无序**水晶对 $(x,y)$，如果你将它们一并摧毁，就会发生强大的共振导致山洞倒塌，使你葬身其中！\n\n带着这张纸片，小 A 来到了山洞的尽头，果然发现了 $n$ 个水晶（$n$ 为偶数）。正如纸片上所说，每个水晶都有一个能量值 $a_i$。\n\n对这些水晶进行一番观察，小 A 发现了一个规律：每个水晶 $i$ 在**所有能量值比它大**的水晶中，只会和**最多一个**发生共振，记其编号为 $x_i$。\n\n现在小 A 知道了 $a_i,x_i$，你能帮助他求出摧毁这些水晶释放出邪恶能量之和的最小值吗？无法摧毁输出 $\\texttt{-1}$。否则先输出最小值，再输出摧毁方案。\n\n若摧毁方案有多种，输出任意一种即可。\n\n- 需要注意的是，摧毁后水晶编号不会发生改变。\n\n---\n\n简化版题意：\n\n给定两个长为 $n\\ (2|n)$ 的序列 $a,x$，满足 $a_i$ 互不相同且如果 $x_i \\neq -1$，那么 $a_{x_i}>a_i$。\n\n现在需要进行 $\\frac{n}{2}$ 次删除操作：选择两个未被删除的数 $a_i,a_j$ 满足 $x_i\\neq j$ 且 $x_j\\neq i$，并用 $\\min(a_i,a_j)\\times k$ 的代价将这两个数从序列 $a$ 中删去（删除后剩余元素下标不变），其中 $k$ 表示这是第 $k$ 次删除。\n\n求删除所有数的最小代价与方案。无解输出 $\\texttt{-1}$。若方案有多种，输出任意一种即可。", "inputFormat": "第一行一个整数 $n$，保证 $n$ 是偶数。\n\n第二行 $n$ 个整数 $a_1,a_2,\\cdots,a_n$，保证 $a_i$ 互不相同。\n\n接下来一行 $n$ 个整数 $x_i$，如果 $x_i=-1$ 则表示第 $i$ 个水晶不与能量值比它大的水晶发生共振；否则保证 $a_{x_i}>a_i$。\n\n**题目输入量较大，建议使用 `scanf`。**", "outputFormat": "若题目无解，输出一行 $\\texttt{-1}$。\n\n否则首先输出一行一个整数，表示释放出邪恶能量之和的最小值。\n\n接下来 $\\dfrac{n}{2}$ 行每行两个由空格隔开的整数，表示被摧毁的水晶对。\n\n**题目输出量较大，建议使用 `printf`。**", "hint": "**「样例 3 说明」**\n\n无法摧毁所有水晶，因为水晶 $4$ 无法被摧毁。\n\n**「数据范围与约定」**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（5 points）：$n=2$；\n- Subtask 2（20 points）：$n \\leq 10$；\n- Subtask 3（15 points）：$x_i=-1$；\n- Subtask 4（20 points）：$n\\leq 3\\times 10^3$；\n- Subtask 5（15 points）：$a_i$ 升序排列，即 $a_i<a_{i+1}\\ (1\\leq i<n)$；\n- Subtask 6（24 points）：无特殊限制。\n- Subtask 7（1 point）：hack 数据。\n\n对于 $100\\%$ 的数据，$2 \\leq n \\leq 5 \\times 10^5$，$1 \\leq a_i \\leq 10^9$。  \n保证 $n$ 为偶数且 $a_i$ 互不相同。  \n保证答案不超过 $2^{63}-1$。\n\n**「帮助/提示」**\n\n请注意 IO 优化。\n\n**「Special Judge」**\n\n**本题使用 SPJ。**\n\n**请认真阅读输出格式。** 输出格式有误可能导致 UKE。\n\n若你的输出的第一行与答案的第一行不同，你将获得本测试点的 $0\\%$ 分数。\n\n若无解且第一行相同，你将获得本测试点的 $100\\%$ 分数。\n\n若有解且第一行相同，但方案有误，你将获得本测试点的 $60\\%$ 分数。\n\n若有解且第一行相同，方案正确，你将获得本测试点的 $100\\%$ 分数。\n\n另附 `checker` 与 `testlib.h`。\n\n百度网盘链接：[link](https://pan.baidu.com/s/1Tk-8-UiLzCpOuPVuoCcbbQ)，提取码：b7eg。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「SWTR-6」Snow Mountain", "background": "**题目背景与解题无关。**\n\n**题目描述最下方有简化版题意。**\n\n天空中飘着雪，放眼望去白茫茫一片。小 A 拿着地图，四处探寻着。\n\n突然，只见前方有一个洞穴。出于好奇心，小 A 走了进去。\n\n洞穴里黑漆漆一片，一眼望不到尽头。道路的两旁尽是白骨，显然，这是曾经来这里探险的人们的残骸。小 A 打了一个冷颤。\n\n这时，小 A 留意到了地上的一张纸片。打开来一看，上面竟写着：\n\n$$\\texttt{Please contact lydsy2012@163.com!}$$", "description": "> 洞穴里有一些水晶，每个水晶有一个能量值 $a_i$。**能量值有大有小，但不会相同。** 这些神秘的水晶上附着邪恶势力的灵魂。现在你的任务是摧毁这些水晶，并让它们释放出的邪恶能量能量尽可能小。\n> \n> 你可以选择两个未被摧毁的水晶 $i,j$，将它们摧毁并释放出 $\\min(a_i,a_j)\\times k$ 的邪恶能量。其中 $k$ 表示这是第 $k$ 次摧毁。\n> \n> 不过有一些**无序**水晶对 $(x,y)$，如果你将它们一并摧毁，就会发生强大的共振导致山洞倒塌，使你葬身其中！\n\n带着这张纸片，小 A 来到了山洞的尽头，果然发现了 $n$ 个水晶（$n$ 为偶数）。正如纸片上所说，每个水晶都有一个能量值 $a_i$。\n\n对这些水晶进行一番观察，小 A 发现了一个规律：每个水晶 $i$ 在**所有能量值比它大**的水晶中，只会和**最多一个**发生共振，记其编号为 $x_i$。\n\n现在小 A 知道了 $a_i,x_i$，你能帮助他求出摧毁这些水晶释放出邪恶能量之和的最小值吗？无法摧毁输出 $\\texttt{-1}$。否则先输出最小值，再输出摧毁方案。\n\n若摧毁方案有多种，输出任意一种即可。\n\n- 需要注意的是，摧毁后水晶编号不会发生改变。\n\n---\n\n简化版题意：\n\n给定两个长为 $n\\ (2|n)$ 的序列 $a,x$，满足 $a_i$ 互不相同且如果 $x_i \\neq -1$，那么 $a_{x_i}>a_i$。\n\n现在需要进行 $\\frac{n}{2}$ 次删除操作：选择两个未被删除的数 $a_i,a_j$ 满足 $x_i\\neq j$ 且 $x_j\\neq i$，并用 $\\min(a_i,a_j)\\times k$ 的代价将这两个数从序列 $a$ 中删去（删除后剩余元素下标不变），其中 $k$ 表示这是第 $k$ 次删除。\n\n求删除所有数的最小代价与方案。无解输出 $\\texttt{-1}$。若方案有多种，输出任意一种即可。", "inputFormat": "第一行一个整数 $n$，保证 $n$ 是偶数。\n\n第二行 $n$ 个整数 $a_1,a_2,\\cdots,a_n$，保证 $a_i$ 互不相同。\n\n接下来一行 $n$ 个整数 $x_i$，如果 $x_i=-1$ 则表示第 $i$ 个水晶不与能量值比它大的水晶发生共振；否则保证 $a_{x_i}>a_i$。\n\n**题目输入量较大，建议使用 `scanf`。**", "outputFormat": "若题目无解，输出一行 $\\texttt{-1}$。\n\n否则首先输出一行一个整数，表示释放出邪恶能量之和的最小值。\n\n接下来 $\\dfrac{n}{2}$ 行每行两个由空格隔开的整数，表示被摧毁的水晶对。\n\n**题目输出量较大，建议使用 `printf`。**", "hint": "**「样例 3 说明」**\n\n无法摧毁所有水晶，因为水晶 $4$ 无法被摧毁。\n\n**「数据范围与约定」**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（5 points）：$n=2$；\n- Subtask 2（20 points）：$n \\leq 10$；\n- Subtask 3（15 points）：$x_i=-1$；\n- Subtask 4（20 points）：$n\\leq 3\\times 10^3$；\n- Subtask 5（15 points）：$a_i$ 升序排列，即 $a_i<a_{i+1}\\ (1\\leq i<n)$；\n- Subtask 6（24 points）：无特殊限制。\n- Subtask 7（1 point）：hack 数据。\n\n对于 $100\\%$ 的数据，$2 \\leq n \\leq 5 \\times 10^5$，$1 \\leq a_i \\leq 10^9$。  \n保证 $n$ 为偶数且 $a_i$ 互不相同。  \n保证答案不超过 $2^{63}-1$。\n\n**「帮助/提示」**\n\n请注意 IO 优化。\n\n**「Special Judge」**\n\n**本题使用 SPJ。**\n\n**请认真阅读输出格式。** 输出格式有误可能导致 UKE。\n\n若你的输出的第一行与答案的第一行不同，你将获得本测试点的 $0\\%$ 分数。\n\n若无解且第一行相同，你将获得本测试点的 $100\\%$ 分数。\n\n若有解且第一行相同，但方案有误，你将获得本测试点的 $60\\%$ 分数。\n\n若有解且第一行相同，方案正确，你将获得本测试点的 $100\\%$ 分数。\n\n另附 `checker` 与 `testlib.h`。\n\n百度网盘链接：[link](https://pan.baidu.com/s/1Tk-8-UiLzCpOuPVuoCcbbQ)，提取码：b7eg。", "locale": "zh-CN"}}}
{"pid": "P6788", "type": "P", "difficulty": 6, "samples": [["4 998244353", "648735108"], ["10 1000000007", "872041698"]], "limits": {"time": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "2020", "洛谷原创", "O2优化", "素数判断,质数,筛法", "洛谷月赛"], "title": "「EZEC-3」四月樱花", "background": "$$又到樱花曼舞的春日，$$\n\n$$花蕾，像无数星星闪烁在枝头含春嬉戏，$$\n\n$$心有灵犀；$$\n\n$$又是为花吹雪的季节，$$\n\n$$花蕊，引万千蜂蝶赶树梢抱春絮语，$$\n\n$$心有念想。$$\n\n$$开了，一夜乍起，$$\n\n$$火树樱花汇聚开遍山野好似茫茫沧海；$$\n\n$$大地樱花，$$\n\n$$赏心悦目怒放层林尽染好似朵朵云霞；$$\n\n$$纵有三千烦恼，$$\n\n$$不过灿烂阳光下释然地娓娓一笑；$$\n\n$$纵有万般郁闷，$$\n\n$$不如和煦暖风里淡淡地悠悠一了；$$\n\n\n\n[——《四月樱花》](http://music.163.com/song?id=1355079681&userid=587823498)\n\n![樱花](https://cdn.luogu.com.cn/upload/image_hosting/g5m4h8a3.png)", "description": "在樱花盛开的四月，```Muxii``` 望着满天飘落的樱花，向身旁的 ```ZZH``` 问道：\n\n“究竟有多少朵樱花在这个四月飘落？”\n\n```ZZH``` 答道：“樱花飘落的朵数 $s$ 与时间 $t$ 有如下关系：\n\n$$s=\\prod_{x=1}^t\\prod_{y|x}\\frac{y^{d(y)}}{\\prod_{z|y}(z+1)^2}$$\n\n其中 $d(y)$ 表示 $y$ 的约数个数。”\n\n但作为一个~~文科生~~萌新，```Muxii``` 显然无法清楚地知道具体的数目，因此他只好继续向 ```ZZH``` 询问这个问题的答案。\n\n由于数量可能很大，所以你只需要替 ```ZZH``` 告诉 ```Muxii``` 他所需要的答案对 $p$ 取模的结果就好了。", "inputFormat": "两个正整数 $t$ 和 $p$，分别表示 ```Muxii``` 询问的时间、模数。", "outputFormat": "输出一个正整数 $s$，表示樱花飘落的朵数。答案对 $p$ 取模。", "hint": "**「样例 1 说明」**\n\n代入计算可得答案为 $\\frac1{2073600}$，由于 $2073600$ 在模 $998244353$ 意义下的逆元为 $648735108$，故最终答案为 $1×648735108\\bmod998244353 = 648735108$。\n\n**「数据范围与约定」**\n\n**数据保证答案的最简表示中分母不含 $p$ 和 $p$ 的倍数。**\n\n对于所有数据，保证 $1\\leq t\\leq 2.5×10^9$，$9.9×10^8<p<1.1×10^9$ 且 $p$ 为质数。\n|子任务编号|$t≤$|分值|\n|:-:|:-:|:-:|\n|$1$|$10^3$|$5$|\n|$2$|$10^4$|$5$|\n|$3$|$2×10^5$|$10$|\n|$4$|$2×10^6$|$20$|\n|$5$|$10^7$|$20$|\n|$6$|$10^8$|$20$|\n|$7$|$2.5×10^9$|$20$|\n\n注：本题采用**捆绑测试**，即必须通过单个子任务的所有测试点才可获得该子任务的分数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-3」四月樱花", "background": "$$又到樱花曼舞的春日，$$\n\n$$花蕾，像无数星星闪烁在枝头含春嬉戏，$$\n\n$$心有灵犀；$$\n\n$$又是为花吹雪的季节，$$\n\n$$花蕊，引万千蜂蝶赶树梢抱春絮语，$$\n\n$$心有念想。$$\n\n$$开了，一夜乍起，$$\n\n$$火树樱花汇聚开遍山野好似茫茫沧海；$$\n\n$$大地樱花，$$\n\n$$赏心悦目怒放层林尽染好似朵朵云霞；$$\n\n$$纵有三千烦恼，$$\n\n$$不过灿烂阳光下释然地娓娓一笑；$$\n\n$$纵有万般郁闷，$$\n\n$$不如和煦暖风里淡淡地悠悠一了；$$\n\n\n\n[——《四月樱花》](http://music.163.com/song?id=1355079681&userid=587823498)\n\n![樱花](https://cdn.luogu.com.cn/upload/image_hosting/g5m4h8a3.png)", "description": "在樱花盛开的四月，```Muxii``` 望着满天飘落的樱花，向身旁的 ```ZZH``` 问道：\n\n“究竟有多少朵樱花在这个四月飘落？”\n\n```ZZH``` 答道：“樱花飘落的朵数 $s$ 与时间 $t$ 有如下关系：\n\n$$s=\\prod_{x=1}^t\\prod_{y|x}\\frac{y^{d(y)}}{\\prod_{z|y}(z+1)^2}$$\n\n其中 $d(y)$ 表示 $y$ 的约数个数。”\n\n但作为一个~~文科生~~萌新，```Muxii``` 显然无法清楚地知道具体的数目，因此他只好继续向 ```ZZH``` 询问这个问题的答案。\n\n由于数量可能很大，所以你只需要替 ```ZZH``` 告诉 ```Muxii``` 他所需要的答案对 $p$ 取模的结果就好了。", "inputFormat": "两个正整数 $t$ 和 $p$，分别表示 ```Muxii``` 询问的时间、模数。", "outputFormat": "输出一个正整数 $s$，表示樱花飘落的朵数。答案对 $p$ 取模。", "hint": "**「样例 1 说明」**\n\n代入计算可得答案为 $\\frac1{2073600}$，由于 $2073600$ 在模 $998244353$ 意义下的逆元为 $648735108$，故最终答案为 $1×648735108\\bmod998244353 = 648735108$。\n\n**「数据范围与约定」**\n\n**数据保证答案的最简表示中分母不含 $p$ 和 $p$ 的倍数。**\n\n对于所有数据，保证 $1\\leq t\\leq 2.5×10^9$，$9.9×10^8<p<1.1×10^9$ 且 $p$ 为质数。\n|子任务编号|$t≤$|分值|\n|:-:|:-:|:-:|\n|$1$|$10^3$|$5$|\n|$2$|$10^4$|$5$|\n|$3$|$2×10^5$|$10$|\n|$4$|$2×10^6$|$20$|\n|$5$|$10^7$|$20$|\n|$6$|$10^8$|$20$|\n|$7$|$2.5×10^9$|$20$|\n\n注：本题采用**捆绑测试**，即必须通过单个子任务的所有测试点才可获得该子任务的分数。", "locale": "zh-CN"}}}
{"pid": "P6789", "type": "P", "difficulty": 7, "samples": [["4 6\n2 3 294405877\n3 4 340909188\n1 2 7718822\n2 4 340754548\n1 4 209906514\n1 3 810986947\n", "121593921\n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["O2优化", "洛谷月赛"], "title": "寒妖王", "background": "寒冷的保加利亚小屋里，你发现了寒妖王给你提出的一个问题。", "description": "给定一张 $n$ 个点 $m$ 条边的图，保证无重边与自环。第 $i$ 条边有权值 $w _i$。\n\n定义一个边集是好的，当且仅当将这些边和与这些边相连的点取出来形成的图没有两个或以上处在同一个连通块的不同的环（两个环不同指的是构成环的边集不能完全相同）。同时定义一个边集的权值为边集中所有边的边权之和。\n\n现在，每条边均有 $50\\%$ 的概率消失。求在消失过程完成后，图中权值最大的好边集的权值的期望。\n\n输出该期望值对一个大质数 $998244353$ 取模的结果。\n\n可以知道这里的期望值是一个有理数。其对 $998244353$ 取模的结果相当于是将其写为最简分数形式 $\\frac x y$（其中 $x$ 与 $y$ 互质）后 $x \\times y ^{998244351}$ 对 $998244353$ 取模的结果。", "inputFormat": "第一行两个正整数 $n, m$，表示该图的点数和边数。\n\n接下来 $m$ 行，每行三个整数 $u _i, v _i, w_i$，分别描述了图中第 $i$ 条边的两个端点与这条边的权值。", "outputFormat": "一行一个正整数表示答案。", "hint": "**「数据范围与约定」**\n\n- 对于前 $20\\%$ 的数据，保证 $n \\le 10$，$m \\le 20$；\n- 对于前 $40\\%$ 的数据，保证 $n \\le 10$，$m \\le 30$；\n- 对于另外 $30\\%$ 的数据，保证所有边的权值均相等；\n- 对于所有数据，保证 $1 \\le n \\le 15$，$1 \\le m \\le 60$，$1 \\le u _i, v _i \\le n$，$0 \\le w _i < 998244353$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "寒妖王", "background": "寒冷的保加利亚小屋里，你发现了寒妖王给你提出的一个问题。", "description": "给定一张 $n$ 个点 $m$ 条边的图，保证无重边与自环。第 $i$ 条边有权值 $w _i$。\n\n定义一个边集是好的，当且仅当将这些边和与这些边相连的点取出来形成的图没有两个或以上处在同一个连通块的不同的环（两个环不同指的是构成环的边集不能完全相同）。同时定义一个边集的权值为边集中所有边的边权之和。\n\n现在，每条边均有 $50\\%$ 的概率消失。求在消失过程完成后，图中权值最大的好边集的权值的期望。\n\n输出该期望值对一个大质数 $998244353$ 取模的结果。\n\n可以知道这里的期望值是一个有理数。其对 $998244353$ 取模的结果相当于是将其写为最简分数形式 $\\frac x y$（其中 $x$ 与 $y$ 互质）后 $x \\times y ^{998244351}$ 对 $998244353$ 取模的结果。", "inputFormat": "第一行两个正整数 $n, m$，表示该图的点数和边数。\n\n接下来 $m$ 行，每行三个整数 $u _i, v _i, w_i$，分别描述了图中第 $i$ 条边的两个端点与这条边的权值。", "outputFormat": "一行一个正整数表示答案。", "hint": "**「数据范围与约定」**\n\n- 对于前 $20\\%$ 的数据，保证 $n \\le 10$，$m \\le 20$；\n- 对于前 $40\\%$ 的数据，保证 $n \\le 10$，$m \\le 30$；\n- 对于另外 $30\\%$ 的数据，保证所有边的权值均相等；\n- 对于所有数据，保证 $1 \\le n \\le 15$，$1 \\le m \\le 60$，$1 \\le u _i, v _i \\le n$，$0 \\le w _i < 998244353$。", "locale": "zh-CN"}}}
