{"pid": "P11760", "type": "P", "difficulty": 3, "samples": [["4\n6 36\n6 35\n5 30\n5 31", "0101"]], "limits": {"time": [500, 500, 500, 500], "memory": [131072, 131072, 131072, 131072]}, "tags": ["数学", "洛谷原创", "位运算", "洛谷比赛"], "title": "[IAMOI R1] 智力检测", "background": "小 C 拉小 L 去见岳父岳母。\n\n岳父岳母决定考验小 L 的智商，于是他们出了一道题。", "description": "岳父给定一个下标从 $1$ 开始的数组 $a$，初始时 $a_i = 2^{i-1}$。\n\n岳母让小 L 对这个数组进行如下操作若干次：\n\n第 $i$ 次操作中，选择两个数 $u_i,v_i\\ (2 \\le u_i<v_i)$，依次执行：\n\n- $a_{v_i} \\gets a_{v_i}+a_{u_i}+a_{u_i-1}$\n\n- $a_{u_i} \\gets -\\infty$\n\n- $a_{u_i-1} \\gets -\\infty$\n\n对于第一次操作没有特殊限制，但对于之后的每一次操作，都必须保证 $v_i > v_{i-1}$。\n\n给出 $T$ 次询问，每次两个数 $k$ 和 $x$，请回答能否通过有限次操作，使 $a_k = x$。\n\n询问之间相互独立（即每次询问后应重置 $a$ 数组）。", "inputFormat": "本题读入量较大，建议采用较快的读入方式。\n\n输入共 $T+1$ 行。\n\n第一行，一个正整数 $T$，表示询问的次数。\n\n接下来 $T$ 行，每行两个正整数 $k$ 和 $x$，表示一组询问。", "outputFormat": "输出一行一个 01 串。\n\n01 串的第 $i$ 位表示第 $i$ 个询问的答案：\n\n- 如果对于第 $i$ 个询问，答案是“能”，则 01 串的第 $i$ 位为 `1`。\n\n- 如果对于第 $i$ 个询问，答案是“不能”，则 01 串的第 $i$ 位为 `0`。", "hint": "对于 $100\\%$ 的数据，$1\\le T\\le5\\times10^6$，$1\\le k \\le 60$，$0\\le x \\le 4 \\times 10^{18}$。\n\n| 测试点编号 | $T$ | $k$ | 特殊性质 | 分数 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\le100$ | $\\le10$  | 无 | 20 |\n| $2$ | $\\le60$ | $\\le60$ | A | 20 |\n| $3$ | $\\le1\\times10^5$ | $\\le60$ | 无 | 30 |\n| $4$ | $\\le5\\times10^6$ | $\\le60$ | 无 | 30 |\n\n\n特殊性质 A：保证 $x=2^{k}-1$。\n\n请注意您实现的常数复杂度。\n\n时空限制均在标程（加快读优化）的 **2.5** 倍以上。\n\n本题输入输出量较大，我们强烈建议您使用快速读入模板：\n\n```cpp\nchar *p1,*p2,buf[1<<20];\ninline char gc(){if(p1==p2)p2=(p1=buf)+fread(buf,1,1<<20,stdin);return p1==p2?' ':*p1++;}\ninline long long read(){\n\tregister long long s=0; register char c=gc();\n\twhile(c<'0'||c>'9') c=gc();\n\twhile(c>='0'&&c<='9') s=(s<<3)+(s<<1)+(c^48),c=gc();\n\treturn s;\n}\n\nx = read() //读入x\n```\n", "locale": "zh-CN", "translations": {"en": {"title": "[IAMOI R1] Intelligence Test", "background": "Xiao C brought Xiao L to meet his parents-in-law.  \n\nThe parents-in-law decided to test Xiao L's intelligence by posing a problem.", "description": "The father-in-law gives an array $a$ indexed from $1$, where initially $a_i = 2^{i-1}$.  \n\nThe mother-in-law asks Xiao L to perform the following operations several times:  \n\nIn the $i$-th operation, choose two numbers $u_i, v_i\\ (2 \\le u_i < v_i)$, then execute sequentially:  \n- $a_{v_i} \\gets a_{v_i} + a_{u_i} + a_{u_i - 1}$  \n- $a_{u_i} \\gets -\\infty$  \n- $a_{u_i - 1} \\gets -\\infty$  \n\nThe first operation has no special restrictions, but for each subsequent operation, it must satisfy $v_i > v_{i-1}$.  \n\nGiven $T$ queries, each with two numbers $k$ and $x$, determine whether it's possible to make $a_k = x$ through a finite number of operations.  \n\nThe queries are independent (i.e., the array $a$ should be reset after each query).", "inputFormat": "Due to large input size, it's recommended to use fast input methods.  \n\nThe input consists of $T + 1$ lines:  \n- The first line contains a positive integer $T$, the number of queries.  \n- The next $T$ lines each contain two positive integers $k$ and $x$, representing a query.", "outputFormat": "Output a binary string of length $T$.  \nThe $i$-th character of the string indicates the answer to the $i$-th query:  \n- `1` if it's possible to make $a_k = x$;  \n- `0` otherwise.", "hint": "For $100\\%$ of the data:  \n- $1 \\le T \\le 5 \\times 10^6$  \n- $1 \\le k \\le 60$  \n- $0 \\le x \\le 4 \\times 10^{18}$  \n\n| Test Case | $T$ | $k$ | Special Property | Score |  \n| :-------: | :-------: | :-------: | :-------: | :-------: |  \n| 1 | $\\le 100$ | $\\le 10$ | None | 20 |  \n| 2 | $\\le 60$ | $\\le 60$ | A | 20 |  \n| 3 | $\\le 1 \\times 10^5$ | $\\le 60$ | None | 30 |  \n| 4 | $\\le 5 \\times 10^6$ | $\\le 60$ | None | 30 |  \n\nSpecial Property A: Guarantees $x = 2^{k} - 1$.  \n\nPlease optimize your code for constant factors.  \n\nThe time and memory limits are at least 2.5 times those of the standard solution (with fast I/O).  \n\nDue to large input/output volume, we strongly recommend using fast I/O templates.  \n\n```cpp\nchar *p1,*p2,buf[1<<20];\ninline char gc(){if(p1==p2)p2=(p1=buf)+fread(buf,1,1<<20,stdin);return p1==p2?' ':*p1++;}\ninline long long read(){\n\tregister long long s=0; register char c=gc();\n\twhile(c<'0'||c>'9') c=gc();\n\twhile(c>='0'&&c<='9') s=(s<<3)+(s<<1)+(c^48),c=gc();\n\treturn s;\n}\n\nx = read() //input x\n```\n\nTranslation by DeepSeek R1  ", "locale": "en"}, "zh-CN": {"title": "[IAMOI R1] 智力检测", "background": "小 C 拉小 L 去见岳父岳母。\n\n岳父岳母决定考验小 L 的智商，于是他们出了一道题。", "description": "岳父给定一个下标从 $1$ 开始的数组 $a$，初始时 $a_i = 2^{i-1}$。\n\n岳母让小 L 对这个数组进行如下操作若干次：\n\n第 $i$ 次操作中，选择两个数 $u_i,v_i\\ (2 \\le u_i<v_i)$，依次执行：\n\n- $a_{v_i} \\gets a_{v_i}+a_{u_i}+a_{u_i-1}$\n\n- $a_{u_i} \\gets -\\infty$\n\n- $a_{u_i-1} \\gets -\\infty$\n\n对于第一次操作没有特殊限制，但对于之后的每一次操作，都必须保证 $v_i > v_{i-1}$。\n\n给出 $T$ 次询问，每次两个数 $k$ 和 $x$，请回答能否通过有限次操作，使 $a_k = x$。\n\n询问之间相互独立（即每次询问后应重置 $a$ 数组）。", "inputFormat": "本题读入量较大，建议采用较快的读入方式。\n\n输入共 $T+1$ 行。\n\n第一行，一个正整数 $T$，表示询问的次数。\n\n接下来 $T$ 行，每行两个正整数 $k$ 和 $x$，表示一组询问。", "outputFormat": "输出一行一个 01 串。\n\n01 串的第 $i$ 位表示第 $i$ 个询问的答案：\n\n- 如果对于第 $i$ 个询问，答案是“能”，则 01 串的第 $i$ 位为 `1`。\n\n- 如果对于第 $i$ 个询问，答案是“不能”，则 01 串的第 $i$ 位为 `0`。", "hint": "对于 $100\\%$ 的数据，$1\\le T\\le5\\times10^6$，$1\\le k \\le 60$，$0\\le x \\le 4 \\times 10^{18}$。\n\n| 测试点编号 | $T$ | $k$ | 特殊性质 | 分数 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\le100$ | $\\le10$  | 无 | 20 |\n| $2$ | $\\le60$ | $\\le60$ | A | 20 |\n| $3$ | $\\le1\\times10^5$ | $\\le60$ | 无 | 30 |\n| $4$ | $\\le5\\times10^6$ | $\\le60$ | 无 | 30 |\n\n\n特殊性质 A：保证 $x=2^{k}-1$。\n\n请注意您实现的常数复杂度。\n\n时空限制均在标程（加快读优化）的 **2.5** 倍以上。\n\n本题输入输出量较大，我们强烈建议您使用快速读入模板：\n\n```cpp\nchar *p1,*p2,buf[1<<20];\ninline char gc(){if(p1==p2)p2=(p1=buf)+fread(buf,1,1<<20,stdin);return p1==p2?' ':*p1++;}\ninline long long read(){\n\tregister long long s=0; register char c=gc();\n\twhile(c<'0'||c>'9') c=gc();\n\twhile(c>='0'&&c<='9') s=(s<<3)+(s<<1)+(c^48),c=gc();\n\treturn s;\n}\n\nx = read() //读入x\n```\n", "locale": "zh-CN"}}}
{"pid": "P11761", "type": "P", "difficulty": 5, "samples": [["3\n1 2 3", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "二分", "洛谷原创", "洛谷比赛"], "title": "[IAMOI R1] 明码标价", "background": "小 C 拉小 L 去买东西。", "description": "商场里有 $n$ 个商品，第 $i$ 个商品的价格为 $a_i$。由于小 C 具有选择困难症，所以小 L 想通过以下方式挑选购买一个商品：\n\n小 L 既不想要选择最便宜的商品（质量差），也不想要选择最贵的商品（性价比低），于是，他定义 $m$ 个商品价格的中位数为按照价格从小排序后最中间的商品价格。具体的说，排序后第 $\\lfloor\\frac{m+1}{2}\\rfloor$ 个商品的价格就是这 $m$ 个商品价格的中位数。\n\n同时，小 L 准备把这 $n$ 个商品按照用处分为连续的 $k$ 段，并在每段中取出价格为中位数的商品。接下来，他再次取出这些商品之中价格为中位数的商品，选出这个唯一的商品购买。\n\n然而小 C 似乎并不同意这个方案，原因是小 C 的划分与小 L 的划分并不相同。于是，他们决定各退一步，采取最公平的方式选择商品。具体的，他们找出按照**任意划分方案**而得出的商品价格（可能存在一个商品被找出多次，也要计算多次），再次取出价格为中位数的商品，选出这个唯一的商品购买。\n\n然而划分的方案可能有很多种，小 L 和小 C 被绕晕了。所以，他们想请你帮忙，他们最后选出的商品价格是多少？\n\n### 形式化题意\n\n定义 $\\operatorname{mid}(\\{a_1,a_2,\\cdots,a_n\\})$ 表示在可重集合中 $a_1\\sim a_n$ 的中位数。形式化地来说，$a_1\\sim a_n$ 的中位数为将 $a_1$ 到 $a_n$ 从小到大排序后， $a_{\\lfloor\\frac{n+1}{2}\\rfloor}$ 的值。\n\n现有一个长度为 $n$ 的数列 $a_1\\sim a_n$。定义了 $f(l,r)=\\operatorname{mid}(\\{a_l,a_{l+1},\\cdots,a_r\\})$。\n\n定义划分和划分的权值：\n\n+ 一个划分被定义为一个长度为任意一个在 $[0,n]$ 的整数 $k$ 的序列 $l$，满足 $1\\ {\\color{red}{\\le}}\\ l_1<l_2<\\cdots<l_k<n$。\n\n+ 两个划分不同当且仅当两个划分的 $k$ 不相同或者存在一个位置使得两个划分的 $l$ 不相同。\n\n+ 当 $k\\not=0$ 时，划分的权值是 $\\operatorname{mid}(\\{f(1,l_1),f(l_1+1,l_2),\\cdots,f(l_k+1,n)\\})$。\n\n+ 否则，划分的权值是 $\\operatorname{mid}(\\{f(1,n)\\})$。\n\n求所有互不相同的划分权值的可重集合的 $\\operatorname{mid}$。", "inputFormat": "第一行，共一个整数 $n$。\n\n第二行，共 $n$ 个整数，表示 $a_1\\sim a_n$。", "outputFormat": "共一个整数，表示最后选出的商品价格。", "hint": "### 样例解释\n\n共有 $4$ 种划分方案，分别为 $\\{\\{1\\},\\{2\\},\\{3\\}\\},\\{\\{1,2\\},\\{3\\}\\},\\{\\{1\\},\\{2,3\\}\\},\\{\\{1,2,3\\}\\}$，其中：\n\n$\\operatorname{mid}(\\{1\\})=1,\\operatorname{mid}(\\{2\\})=2,\\operatorname{mid}(\\{3\\})=3,\\operatorname{mid}(\\{1,2\\})=1,\\operatorname{mid}(\\{2,3\\})=2,\\operatorname{mid}(\\{1,2,3\\})=2$；\n\n这 $4$ 种划分的权值分别为 $\\operatorname{mid}(\\{1,2,3\\})=2,\\operatorname{mid}(\\{1,3\\})=1,\\operatorname{mid}(\\{1,2\\})=1,\\operatorname{mid}(\\{2\\})=2$；\n\n最终答案即为 $\\operatorname{mid}(\\{1,1,2,2\\})=1$。\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n| Subtask | $n\\le$ | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $15$ | 无 | $13$ |\n| $2$ | $40$ | A | $17$ |\n| $3$ | $40$ | 无 | $20$ |\n| $4$ | $100$ | A | $23$ |\n| $5$ | $100$ | 无 | $27$ |\n\n特殊性质 A：保证 $a$ 为一个 $1\\sim n$ 的排列。\n\n对于所有数据，保证 $2\\le n\\le 100$，$1\\le a_i\\le 10^9$。\n\n注：在 C++ 语言中，你可以使用类型 `__int128` 来存储范围在 $-2^{128}\\sim 2^{128}-1$ 的整数。", "locale": "zh-CN", "translations": {"en": {"title": "[IAMOI R1] Clear Pricing", "background": "Xiao C brought Xiao L to go shopping.", "description": "There are $n$ items in the mall, where the $i$-th item has price $a_i$. Since Xiao C has decision fatigue, Xiao L wants to select an item through the following method:  \n\nXiao L neither wants the cheapest item (poor quality) nor the most expensive one (low cost-effectiveness). Therefore, he defines the median of $m$ item prices as the price of the middle item after sorting prices in ascending order. Specifically, the median is the price of the $\\lfloor\\frac{m+1}{2}\\rfloor$-th item after sorting.  \n\nXiao L plans to divide these $n$ items into continuous $k$ segments based on their utility, then take the median-priced item from each segment. Next, he will take the median of these selected items as the final purchase choice.  \n\nHowever, Xiao C disagrees with this plan because her partitioning differs from Xiao L's. They compromise by adopting the fairest approach: considering all possible partitioning schemes, collect all possible median prices (including duplicates from multiple schemes), then take the median of this collection as the final price.  \n\nGiven the complexity of possible partitions, they need your help to determine the final selected price.\n\n### Formal Problem Statement\n\nDefine $\\operatorname{mid}(\\{a_1,a_2,\\cdots,a_n\\})$ as the median of multiset $\\{a_1,\\cdots,a_n\\}$, which equals the $\\lfloor\\frac{n+1}{2}\\rfloor$-th element after sorting in ascending order.  \n\nGiven a sequence $a_1\\sim a_n$ of length $n$, define $f(l,r)=\\operatorname{mid}(\\{a_l,a_{l+1},\\cdots,a_r\\})$.  \n\nA partition is defined as:  \n+ A sequence $l$ of length $k$ (where $0 \\le k \\le n$) satisfying $1 \\le l_1 < l_2 < \\cdots < l_k < n$ when $k \\neq 0$.  \n+ Two partitions are different if their $k$ values differ or any position in $l$ differs.  \n\nThe weight of a partition is:  \n+ When $k \\neq 0$: $\\operatorname{mid}(\\{f(1,l_1), f(l_1+1,l_2), \\cdots, f(l_k+1,n)\\})$  \n+ When $k = 0$: $\\operatorname{mid}(\\{f(1,n)\\})$  \n\nFind the median of the multiset containing weights of all distinct partitions.", "inputFormat": "- The first line contains a single integer $n$.  \n- The second line contains $n$ integers $a_1\\sim a_n$.", "outputFormat": "Output a single integer representing the final selected price.", "hint": "### Sample Explanation\n\nFor $n=3$, there are 4 partition schemes:  \n1. $\\{\\{1\\},\\{2\\},\\{3\\}\\}$ → weight $\\operatorname{mid}(1,2,3)=2$  \n2. $\\{\\{1,2\\},\\{3\\}\\}$ → weight $\\operatorname{mid}(1,3)=1$  \n3. $\\{\\{1\\},\\{2,3\\}\\}$ → weight $\\operatorname{mid}(1,2)=1$  \n4. $\\{\\{1,2,3\\}\\}$ → weight $\\operatorname{mid}(2)=2$  \n\nThe final multiset is $\\{1,1,2,2\\}$ with median $1$.\n\n### Constraints\n\n**Subtask scoring is used.**  \n\n| Subtask | $n\\le$ | Special Property | Score |  \n| :-----: | :----: | :--------------: | :---: |  \n| 1 | 15 | None | 13 |  \n| 2 | 40 | A | 17 |  \n| 3 | 40 | None | 20 |  \n| 4 | 100 | A | 23 |  \n| 5 | 100 | None | 27 |  \n\nSpecial Property A: $a$ is a permutation of $1\\sim n$.  \n\nFor all data: $2 \\le n \\le 100$, $1 \\le a_i \\le 10^9$.  \n\nNote: In C++, you may use `__int128` to store integers in $[-2^{128}, 2^{128}-1]$.  \n\nTranslation by DeepSeek R1  ", "locale": "en"}, "zh-CN": {"title": "[IAMOI R1] 明码标价", "background": "小 C 拉小 L 去买东西。", "description": "商场里有 $n$ 个商品，第 $i$ 个商品的价格为 $a_i$。由于小 C 具有选择困难症，所以小 L 想通过以下方式挑选购买一个商品：\n\n小 L 既不想要选择最便宜的商品（质量差），也不想要选择最贵的商品（性价比低），于是，他定义 $m$ 个商品价格的中位数为按照价格从小排序后最中间的商品价格。具体的说，排序后第 $\\lfloor\\frac{m+1}{2}\\rfloor$ 个商品的价格就是这 $m$ 个商品价格的中位数。\n\n同时，小 L 准备把这 $n$ 个商品按照用处分为连续的 $k$ 段，并在每段中取出价格为中位数的商品。接下来，他再次取出这些商品之中价格为中位数的商品，选出这个唯一的商品购买。\n\n然而小 C 似乎并不同意这个方案，原因是小 C 的划分与小 L 的划分并不相同。于是，他们决定各退一步，采取最公平的方式选择商品。具体的，他们找出按照**任意划分方案**而得出的商品价格（可能存在一个商品被找出多次，也要计算多次），再次取出价格为中位数的商品，选出这个唯一的商品购买。\n\n然而划分的方案可能有很多种，小 L 和小 C 被绕晕了。所以，他们想请你帮忙，他们最后选出的商品价格是多少？\n\n### 形式化题意\n\n定义 $\\operatorname{mid}(\\{a_1,a_2,\\cdots,a_n\\})$ 表示在可重集合中 $a_1\\sim a_n$ 的中位数。形式化地来说，$a_1\\sim a_n$ 的中位数为将 $a_1$ 到 $a_n$ 从小到大排序后， $a_{\\lfloor\\frac{n+1}{2}\\rfloor}$ 的值。\n\n现有一个长度为 $n$ 的数列 $a_1\\sim a_n$。定义了 $f(l,r)=\\operatorname{mid}(\\{a_l,a_{l+1},\\cdots,a_r\\})$。\n\n定义划分和划分的权值：\n\n+ 一个划分被定义为一个长度为任意一个在 $[0,n]$ 的整数 $k$ 的序列 $l$，满足 $1\\ {\\color{red}{\\le}}\\ l_1<l_2<\\cdots<l_k<n$。\n\n+ 两个划分不同当且仅当两个划分的 $k$ 不相同或者存在一个位置使得两个划分的 $l$ 不相同。\n\n+ 当 $k\\not=0$ 时，划分的权值是 $\\operatorname{mid}(\\{f(1,l_1),f(l_1+1,l_2),\\cdots,f(l_k+1,n)\\})$。\n\n+ 否则，划分的权值是 $\\operatorname{mid}(\\{f(1,n)\\})$。\n\n求所有互不相同的划分权值的可重集合的 $\\operatorname{mid}$。", "inputFormat": "第一行，共一个整数 $n$。\n\n第二行，共 $n$ 个整数，表示 $a_1\\sim a_n$。", "outputFormat": "共一个整数，表示最后选出的商品价格。", "hint": "### 样例解释\n\n共有 $4$ 种划分方案，分别为 $\\{\\{1\\},\\{2\\},\\{3\\}\\},\\{\\{1,2\\},\\{3\\}\\},\\{\\{1\\},\\{2,3\\}\\},\\{\\{1,2,3\\}\\}$，其中：\n\n$\\operatorname{mid}(\\{1\\})=1,\\operatorname{mid}(\\{2\\})=2,\\operatorname{mid}(\\{3\\})=3,\\operatorname{mid}(\\{1,2\\})=1,\\operatorname{mid}(\\{2,3\\})=2,\\operatorname{mid}(\\{1,2,3\\})=2$；\n\n这 $4$ 种划分的权值分别为 $\\operatorname{mid}(\\{1,2,3\\})=2,\\operatorname{mid}(\\{1,3\\})=1,\\operatorname{mid}(\\{1,2\\})=1,\\operatorname{mid}(\\{2\\})=2$；\n\n最终答案即为 $\\operatorname{mid}(\\{1,1,2,2\\})=1$。\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n| Subtask | $n\\le$ | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $15$ | 无 | $13$ |\n| $2$ | $40$ | A | $17$ |\n| $3$ | $40$ | 无 | $20$ |\n| $4$ | $100$ | A | $23$ |\n| $5$ | $100$ | 无 | $27$ |\n\n特殊性质 A：保证 $a$ 为一个 $1\\sim n$ 的排列。\n\n对于所有数据，保证 $2\\le n\\le 100$，$1\\le a_i\\le 10^9$。\n\n注：在 C++ 语言中，你可以使用类型 `__int128` 来存储范围在 $-2^{128}\\sim 2^{128}-1$ 的整数。", "locale": "zh-CN"}}}
{"pid": "P11762", "type": "P", "difficulty": 5, "samples": [["5 5 10 4\n1 3\n2 5\n2 3\n4 5\n1 5", "2\n4 1\n2 0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["图论", "洛谷原创", "Special Judge", "欧拉回路", "洛谷比赛"], "title": "[IAMOI R1] 走亲访友", "background": "小 C 拉小 L 去走亲戚。", "description": "小 C 共有 $n$ 个亲戚，某些亲戚家之间有 $m$ 条双向的道路，保证亲戚家之间两两可达。\n\n小 C 要亲自去走亲戚。具体的，小 C 一开始在第 $s$ 个亲戚家。每次她可以前往一个与她现在的位置有道路相连的亲戚家。然而小 C 太有魅力了。每当她走过一条道路时，追求她的人便会从四面八方涌来，导致这条路堵车。当然，她也可以躲在车里面，收起她的迷人魅力，这样这条路就不会堵车了。\n\n因为小 L 是路痴，所以小 C 希望最后剩下尽量少的 $n-1$ 条没有堵车的道路，并使得只保留着 $n-1$ 条道路后，亲戚家之间仍两两可达。\n\n因为小 C 不想四处奔波这么久，所以最多只会走过 $k$ 条道路。\n\n请你为她输出一种走亲戚的方案。\n\n### 形式化题意\n\n给定一个 $n$ 个点 $m$ 条边的简单无向连通图，你需要构造一组满足下面要求的路径：\n\n+ 起点为 $s$，终点不限。\n\n+ 对于走过的每一组边 $(u_i,v_i)$，你需要额外决定 $p_i\\in\\{0,1\\}$，满足：\n\n1. $p_i=0$ 表示删除这条边，**且不能再使用，即之后不能再次经过这条边**；$p_i=1$ 表示不删除这条边。\n\n2. 如果 $i>1$，那么 $u_i=v_{i-1}$。**即使 $p_i=0$，也需要满足这条限制。**\n\n+ 路径的长度不能超过 $k$。\n\n+ 最后未删除的边组成一棵 $n$ 个节点的树。\n\n特别的，一组边在被删除前可以经过多次。\n\n若有多组满足条件的路径，可以输出任意一组。\n\n可以证明在本题的限制条件下，一定存在合法的方案。", "inputFormat": "第一行输入四个整数 $n,m,k$ 和 $s$。\n\n接下来 $m$ 行每行输入整数 $u$ 和 $v$，表示第 $u$ 个亲戚家和第 $v$ 个亲戚家之间有一条双向道路。", "outputFormat": "第一行输出一个整数，表示走过的道路的数量。\n\n接下来若干行输出你的方案。具体的，每行输出两个整数。第一个整数表示道路的编号，第二个整数的值为 $0$ 或 $1$，若是 $0$ 表示让这条路堵车（删除这条边），若是 $1$ 表示让这条路保持畅通（保留这条边）。\n\n如果有多种方案，任意输出一种也将被视为正确。", "hint": "### 样例解释\n![](https://cdn.luogu.com.cn/upload/image_hosting/qr0blgk5.png)\n\n首先我们从第 $4$ 条道路后到达 $5$ 号亲戚家，再通过第 $2$ 条道路到达 $2$ 号亲戚，并让第 $2$ 条道路堵车。此时，只剩下 $n-1$ 条没有堵车的道路，并且亲戚家之间仍然两两可达。\n\n对于以下输出：\n\n```\n2\n4 1\n5 0\n```\n\n或者以下输出：\n\n```\n3\n4 1\n2 1\n3 0\n```\n\n也将视作正确。\n### 数据范围\n\n**本题采用捆绑测试**。\n\n| Subtask | $n\\le$ | $m$ | $k=$ | 分数 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| 1 | $10$ | $\\le 10$ | $100$ | $20$ |\n| 2 | $100$ | $\\le \\frac{n(n-1)}{2}$ | $10^6$ | $10$ |\n| 3 | $10^3$ | $=n$ | $n+m$ | $10$ |\n| 4 | $10^3$ | $\\le \\frac{n(n-1)}{2}$ | $n^2$ | $20$ |\n| 5 | $10^3$ | $\\le \\frac{n(n-1)}{2}$ | $n+m$ | $40$ |\n\n\n对于 $100\\%$ 的数据，$n-1\\le m\\le\\dfrac{n(n-1)}{2}$，$1\\le u,v \\le n$，且图中无自环、重边。\n\n后话：这并非此题的原版，而是改版。然而[原版](https://www.luogu.com.cn/problem/T565042)我们目前并没有想到做法，有思路可以联系 [Down_syndrome](https://www.luogu.com.cn/user/984018)。", "locale": "zh-CN", "translations": {"en": {"title": "[IAMOI R1] Visiting Relatives", "background": "Xiao C took Xiao L to visit relatives.", "description": "Xiao C has $n$ relatives connected by $m$ bidirectional roads, ensuring all relatives are mutually reachable.  \n\nXiao C will personally visit them starting from the $s$-th relative's home. Each time she can move to a relative's home connected by a road. However, whenever she traverses a road, admirers swarm in causing congestion. She can choose to hide her charm (marking $p_i=1$) to prevent congestion, otherwise (marking $p_i=0$) the road becomes permanently blocked after this traversal.  \n\nXiao L is bad with directions, so Xiao C wants to leave exactly $n-1$ unblocked roads forming a connected tree, while traversing at most $k$ roads. Construct such a traversal plan.\n\n### Formal Problem Statement\n\nGiven a simple undirected connected graph with $n$ nodes and $m$ edges, construct a path satisfying:  \n1. Starts at node $s$ (end node unrestricted).  \n2. For each traversed edge $(u_i, v_i)$, assign $p_i \\in \\{0,1\\}$ where:  \n   - $p_i=0$: Delete this edge (cannot be reused).  \n   - $p_i=1$: Keep this edge.  \n   - Path continuity: $u_i = v_{i-1}$ for $i>1$ (even if edge is deleted).  \n3. Path length ≤ $k$.  \n4. Remaining edges form a spanning tree.  \n\nMultiple traversals allowed before deletion. Solution always exists under given constraints.", "inputFormat": "- First line: four integers $n$, $m$, $k$, $s$.  \n- Next $m$ lines: two integers $u$ and $v$ per line, representing a bidirectional road.", "outputFormat": "- First line: integer $t$ (number of traversed edges).  \n- Next $t$ lines: two integers per line - edge index (1-based input order) and $p_i$ (0/1).\n\nAny valid solution is accepted.", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/qr0blgk5.png)\n\nAfter traversing edge 4 (keep) to node 5, then edge 2 (block), remaining edges form a tree. Alternative solutions like \n\n```\n2\n4 1\n5 0\n```\n\nor \n\n```\n3\n4 1\n2 1\n3 0\n```\n\nare also valid.\n\n### Constraints  \n**Subtask scoring**  \n\n| Subtask | $n \\le$ | $m$ | $k=$ | Score |  \n| :-----: | :-----: | :-----: | :-----: | :---: |  \n| 1 | 10 | ≤10 | 100 | 20 |  \n| 2 | 100 | ≤$\\frac{n(n-1)}{2}$ | $10^6$ | 10 |  \n| 3 | $10^3$ | $n$ | $n+m$ | 10 |  \n| 4 | $10^3$ | ≤$\\frac{n(n-1)}{2}$ | $n^2$ | 20 |  \n| 5 | $10^3$ | ≤$\\frac{n(n-1)}{2}$ | $n+m$ | 40 |  \n\nFor 100% data:  \n- $n-1 \\le m \\le \\frac{n(n-1)}{2}$  \n- No self-loops or duplicate edges  \n\nPostscript: This is a modified version. The [original problem](https://www.luogu.com.cn/problem/T565042) remains unsolved. Contact [Down_syndrome](https://www.luogu.com.cn/user/984018) for ideas.  \n\nTranslation by DeepSeek R1  ", "locale": "en"}, "zh-CN": {"title": "[IAMOI R1] 走亲访友", "background": "小 C 拉小 L 去走亲戚。", "description": "小 C 共有 $n$ 个亲戚，某些亲戚家之间有 $m$ 条双向的道路，保证亲戚家之间两两可达。\n\n小 C 要亲自去走亲戚。具体的，小 C 一开始在第 $s$ 个亲戚家。每次她可以前往一个与她现在的位置有道路相连的亲戚家。然而小 C 太有魅力了。每当她走过一条道路时，追求她的人便会从四面八方涌来，导致这条路堵车。当然，她也可以躲在车里面，收起她的迷人魅力，这样这条路就不会堵车了。\n\n因为小 L 是路痴，所以小 C 希望最后剩下尽量少的 $n-1$ 条没有堵车的道路，并使得只保留着 $n-1$ 条道路后，亲戚家之间仍两两可达。\n\n因为小 C 不想四处奔波这么久，所以最多只会走过 $k$ 条道路。\n\n请你为她输出一种走亲戚的方案。\n\n### 形式化题意\n\n给定一个 $n$ 个点 $m$ 条边的简单无向连通图，你需要构造一组满足下面要求的路径：\n\n+ 起点为 $s$，终点不限。\n\n+ 对于走过的每一组边 $(u_i,v_i)$，你需要额外决定 $p_i\\in\\{0,1\\}$，满足：\n\n1. $p_i=0$ 表示删除这条边，**且不能再使用，即之后不能再次经过这条边**；$p_i=1$ 表示不删除这条边。\n\n2. 如果 $i>1$，那么 $u_i=v_{i-1}$。**即使 $p_i=0$，也需要满足这条限制。**\n\n+ 路径的长度不能超过 $k$。\n\n+ 最后未删除的边组成一棵 $n$ 个节点的树。\n\n特别的，一组边在被删除前可以经过多次。\n\n若有多组满足条件的路径，可以输出任意一组。\n\n可以证明在本题的限制条件下，一定存在合法的方案。", "inputFormat": "第一行输入四个整数 $n,m,k$ 和 $s$。\n\n接下来 $m$ 行每行输入整数 $u$ 和 $v$，表示第 $u$ 个亲戚家和第 $v$ 个亲戚家之间有一条双向道路。", "outputFormat": "第一行输出一个整数，表示走过的道路的数量。\n\n接下来若干行输出你的方案。具体的，每行输出两个整数。第一个整数表示道路的编号，第二个整数的值为 $0$ 或 $1$，若是 $0$ 表示让这条路堵车（删除这条边），若是 $1$ 表示让这条路保持畅通（保留这条边）。\n\n如果有多种方案，任意输出一种也将被视为正确。", "hint": "### 样例解释\n![](https://cdn.luogu.com.cn/upload/image_hosting/qr0blgk5.png)\n\n首先我们从第 $4$ 条道路后到达 $5$ 号亲戚家，再通过第 $2$ 条道路到达 $2$ 号亲戚，并让第 $2$ 条道路堵车。此时，只剩下 $n-1$ 条没有堵车的道路，并且亲戚家之间仍然两两可达。\n\n对于以下输出：\n\n```\n2\n4 1\n5 0\n```\n\n或者以下输出：\n\n```\n3\n4 1\n2 1\n3 0\n```\n\n也将视作正确。\n### 数据范围\n\n**本题采用捆绑测试**。\n\n| Subtask | $n\\le$ | $m$ | $k=$ | 分数 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| 1 | $10$ | $\\le 10$ | $100$ | $20$ |\n| 2 | $100$ | $\\le \\frac{n(n-1)}{2}$ | $10^6$ | $10$ |\n| 3 | $10^3$ | $=n$ | $n+m$ | $10$ |\n| 4 | $10^3$ | $\\le \\frac{n(n-1)}{2}$ | $n^2$ | $20$ |\n| 5 | $10^3$ | $\\le \\frac{n(n-1)}{2}$ | $n+m$ | $40$ |\n\n\n对于 $100\\%$ 的数据，$n-1\\le m\\le\\dfrac{n(n-1)}{2}$，$1\\le u,v \\le n$，且图中无自环、重边。\n\n后话：这并非此题的原版，而是改版。然而[原版](https://www.luogu.com.cn/problem/T565042)我们目前并没有想到做法，有思路可以联系 [Down_syndrome](https://www.luogu.com.cn/user/984018)。", "locale": "zh-CN"}}}
{"pid": "P11763", "type": "P", "difficulty": 6, "samples": [["4\n4 0\n5 1\n3 0\n2 1\n2\n3 1\n1 2", "1\n5"]], "limits": {"time": [1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["莫队", "洛谷原创", "分块", "洛谷比赛"], "title": "[IAMOI R1] 家庭矛盾", "background": "小 L 和小 C 发生了一些家庭矛盾，小 C 和小 L 徘徊在分手的边缘。", "description": "小 L 和小 C 在一起生活的的每一天都可以用一个二元组 $(a_i,c_i)$ 表示。$c_i$ 要么是 $0$ ，要么是 $1$，代表这天小 L 和小 C 有没有吵架。而 $a_i$ 则是一个整数，代表这一天小 C 的心情值。\n\n小 L 和小 C 正在同时进行 $m$ 场家庭战争。第 $k$ 场战争从第 $l_k$ 天开始。\n\n由于他们的战争非常激烈，你不知道他们在第几天会结束这场战争。但如果这场战争于第 $r$ 天结束，且从第 $l_k$ 天到第 $r$ 天吵架的天数恰好为 $d_k$，那么这场战争就会给小 C 带来一定的怨气值。怨气值为第 $l_k$ 天到第 $r$ 天小 C 心情值的逆序对个数。否则，小 C 的怨气值就为 $0$。\n\n现在，小 L 把这 $n$ 天的 $(a_i,c_i)$ 和 $m$ 场战争的 $l_k$ 和 $d_k$ 告诉了你。对于每场战争，小 L 希望知道对于所有可能的结束时间，小 C 的怨气值之和，以便他挽回和小 L 的感情。他会非常感激你的帮助，并给你 $7420738134810 \\bmod 12673$ 元作为感谢。\n\n### 形式化题意\n\n你有 $n$ 个二元组 $(a_{i},c_{i})$，其中满足 $c_{i} \\in \\{0,1\\}$。\n\n现在有 $m$ 个询问，每次询问给出两个整数 $l_{k},d_{k}$，求：\n\n$$\n\\sum_{r=l_{k}}^{n} \\left[\\left(\\sum_{i=l_{k}}^{r} c_{i}\\right)=d_{k}\\right] \\sum_{i=l_{k}}^{r} \\sum_{j=i+1}^{r} [a_{j}<a_{i}]\n$$\n其中中括号内的式子若为真，则其值为 $1$，否则为 $0$。", "inputFormat": "第一行一个整数 $n$，表示序列长度。\n\n接下来 $n$ 行，每行两个整数 $a_{i},c_{i}$，表示小 L 和小 C 在一起生活的第 $n$ 天的描述二元组。\n\n然后一行一个整数 $m$，表示战争的场数。\n\n接下来 $m$ 行，每行两个整数 $l_{k},d_{k}$，代表一次战争。", "outputFormat": "输出 $m$ 行，表示每次战争中，对于的所有可能的结束时间，小 C 的怨气值之和。", "hint": "### 样例解释 $1$\n\n对于询问 $1$，只有区间 $[3,4]$ 符合条件，所以答案为 $1$。\n\n对于询问 $2$，只有区间 $[1,4]$ 符合条件，所以答案为 $5$。\n\n### 数据范围\n\n|测试点编号| $n,m\\le$ | 特殊性质 |\n| :-----------: | :-----------: | :-----------: |\n| $1$ | $100$ | 无 | \n| $2,3$ | $10^3$ | 无 |\n| $4,5$ | $10^5$ | A |\n| $6\\sim8$ | $10^5$ | B |\n| $9,10$ | $10^5$ | CD |\n| $11,12$ | $5\\times10^4$ | C |\n| $13,14$ | $10^5$ | C |\n| $15\\sim 17$ | $10^5$ | D |\n| $18\\sim20$ | $5\\times10^4$ | 无 |\n| $21\\sim25$ | $10^5$ | 无 |\n\n特殊性质 A：保证 $c_i=0$。\n\n特殊性质 B：保证 $d_{k}=1$。\n\n特殊性质 C：保证 $c_i=1$。\n\n特殊性质 D：保证询问中 $\\forall k<m,l_{k} \\le l_{k+1},d_{k} \\le d_{k+1}$。\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le10^5$，$1\\le l_k\\le n$，$1\\le a_i\\le10^9$，$c_{i} \\in \\{0,1\\}$，$0\\le d_k\\le 10^9$。\n\n保证此题的时空限制是标程的 **2** 倍及以上。", "locale": "zh-CN", "translations": {"en": {"title": "[IAMOI R1] Family Conflict", "background": "Xiao L and Xiao C have had some family conflicts, and they are on the verge of breaking up.", "description": "Each day that Xiao L and Xiao C spend together can be represented by a tuple $(a_i, c_i)$. Here, $c_i$ is either $0$ or $1$, indicating whether Xiao L and Xiao C had a quarrel on that day. $a_i$ is an integer representing Xiao C's mood value on that day.\n\nXiao L and Xiao C are simultaneously engaged in $m$ family wars. The $k$-th war starts on the $l_k$-th day.\n\nSince their wars are very intense, you do not know on which day they will end. However, if the war ends on the $r$-th day, and the number of quarrel days from the $l_k$-th day to the $r$-th day is exactly $d_k$, then this war will bring Xiao C a certain amount of resentment value. The resentment value is the number of inversion pairs in Xiao C's mood values from the $l_k$-th day to the $r$-th day. Otherwise, Xiao C's resentment value is $0$.\n\nNow, Xiao L has provided you with the $(a_i, c_i)$ for all $n$ days and the $l_k$ and $d_k$ for the $m$ wars. For each war, Xiao L wants to know the sum of Xiao C's resentment values over all possible ending times, so he can try to mend their relationship. He will be very grateful for your help and reward you with $7420738134810 \\bmod 12673$ yuan as thanks.\n\n### Formal Description\n\nYou have $n$ tuples $(a_{i}, c_{i})$, where $c_{i} \\in \\{0,1\\}$.\n\nThere are $m$ queries. Each query provides two integers $l_{k}$ and $d_{k}$. Compute:\n\n$$\n\\sum_{r=l_{k}}^{n} \\left[\\left(\\sum_{i=l_{k}}^{r} c_{i}\\right)=d_{k}\\right] \\sum_{i=l_{k}}^{r} \\sum_{j=i+1}^{r} [a_{j}<a_{i}]\n$$\n\nHere, the expression in square brackets evaluates to $1$ if true, and $0$ otherwise.", "inputFormat": "The first line contains an integer $n$, the length of the sequence.\n\nThe next $n$ lines each contain two integers $a_{i}$ and $c_{i}$, describing the tuple for the $i$-th day.\n\nThe next line contains an integer $m$, the number of wars.\n\nThe next $m$ lines each contain two integers $l_{k}$ and $d_{k}$, representing a war.", "outputFormat": "Output $m$ lines, each indicating the sum of resentment values for all possible ending times in the corresponding war.", "hint": "### Sample Explanation 1\n\nFor the first query, only the interval $[3,4]$ meets the condition, so the answer is $1$.\n\nFor the second query, only the interval $[1,4]$ meets the condition, so the answer is $5$.\n\n### Data Range\n\n| Test Case ID | $n,m \\leq$ | Special Properties |\n| :----------: | :--------: | :----------------: |\n| $1$          | $100$      | None               |\n| $2,3$        | $10^3$     | None               |\n| $4,5$        | $10^5$     | A                  |\n| $6\\sim8$     | $10^5$     | B                  |\n| $9,10$       | $10^5$     | CD                 |\n| $11,12$      | $5\\times10^4$ | C               |\n| $13,14$      | $10^5$     | C                  |\n| $15\\sim17$   | $10^5$     | D                  |\n| $18\\sim20$   | $5\\times10^4$ | None            |\n| $21\\sim25$   | $10^5$     | None               |\n\nSpecial Property A: All $c_i=0$.\n\nSpecial Property B: All $d_{k}=1$.\n\nSpecial Property C: All $c_i=1$.\n\nSpecial Property D: For all queries, $\\forall k<m$, $l_{k} \\le l_{k+1}$ and $d_{k} \\le d_{k+1}$.\n\nFor $100\\%$ of the data: $1\\le n,m\\le10^5$, $1\\le l_k\\le n$, $1\\le a_i\\le10^9$, $c_{i} \\in \\{0,1\\}$, $0\\le d_k\\le 10^9$.\n\nThe time and memory limits for this problem are at least **twice** those of the standard solution.\n\nTranslation by DeepSeek R1", "locale": "en"}, "zh-CN": {"title": "[IAMOI R1] 家庭矛盾", "background": "小 L 和小 C 发生了一些家庭矛盾，小 C 和小 L 徘徊在分手的边缘。", "description": "小 L 和小 C 在一起生活的的每一天都可以用一个二元组 $(a_i,c_i)$ 表示。$c_i$ 要么是 $0$ ，要么是 $1$，代表这天小 L 和小 C 有没有吵架。而 $a_i$ 则是一个整数，代表这一天小 C 的心情值。\n\n小 L 和小 C 正在同时进行 $m$ 场家庭战争。第 $k$ 场战争从第 $l_k$ 天开始。\n\n由于他们的战争非常激烈，你不知道他们在第几天会结束这场战争。但如果这场战争于第 $r$ 天结束，且从第 $l_k$ 天到第 $r$ 天吵架的天数恰好为 $d_k$，那么这场战争就会给小 C 带来一定的怨气值。怨气值为第 $l_k$ 天到第 $r$ 天小 C 心情值的逆序对个数。否则，小 C 的怨气值就为 $0$。\n\n现在，小 L 把这 $n$ 天的 $(a_i,c_i)$ 和 $m$ 场战争的 $l_k$ 和 $d_k$ 告诉了你。对于每场战争，小 L 希望知道对于所有可能的结束时间，小 C 的怨气值之和，以便他挽回和小 L 的感情。他会非常感激你的帮助，并给你 $7420738134810 \\bmod 12673$ 元作为感谢。\n\n### 形式化题意\n\n你有 $n$ 个二元组 $(a_{i},c_{i})$，其中满足 $c_{i} \\in \\{0,1\\}$。\n\n现在有 $m$ 个询问，每次询问给出两个整数 $l_{k},d_{k}$，求：\n\n$$\n\\sum_{r=l_{k}}^{n} \\left[\\left(\\sum_{i=l_{k}}^{r} c_{i}\\right)=d_{k}\\right] \\sum_{i=l_{k}}^{r} \\sum_{j=i+1}^{r} [a_{j}<a_{i}]\n$$\n其中中括号内的式子若为真，则其值为 $1$，否则为 $0$。", "inputFormat": "第一行一个整数 $n$，表示序列长度。\n\n接下来 $n$ 行，每行两个整数 $a_{i},c_{i}$，表示小 L 和小 C 在一起生活的第 $n$ 天的描述二元组。\n\n然后一行一个整数 $m$，表示战争的场数。\n\n接下来 $m$ 行，每行两个整数 $l_{k},d_{k}$，代表一次战争。", "outputFormat": "输出 $m$ 行，表示每次战争中，对于的所有可能的结束时间，小 C 的怨气值之和。", "hint": "### 样例解释 $1$\n\n对于询问 $1$，只有区间 $[3,4]$ 符合条件，所以答案为 $1$。\n\n对于询问 $2$，只有区间 $[1,4]$ 符合条件，所以答案为 $5$。\n\n### 数据范围\n\n|测试点编号| $n,m\\le$ | 特殊性质 |\n| :-----------: | :-----------: | :-----------: |\n| $1$ | $100$ | 无 | \n| $2,3$ | $10^3$ | 无 |\n| $4,5$ | $10^5$ | A |\n| $6\\sim8$ | $10^5$ | B |\n| $9,10$ | $10^5$ | CD |\n| $11,12$ | $5\\times10^4$ | C |\n| $13,14$ | $10^5$ | C |\n| $15\\sim 17$ | $10^5$ | D |\n| $18\\sim20$ | $5\\times10^4$ | 无 |\n| $21\\sim25$ | $10^5$ | 无 |\n\n特殊性质 A：保证 $c_i=0$。\n\n特殊性质 B：保证 $d_{k}=1$。\n\n特殊性质 C：保证 $c_i=1$。\n\n特殊性质 D：保证询问中 $\\forall k<m,l_{k} \\le l_{k+1},d_{k} \\le d_{k+1}$。\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le10^5$，$1\\le l_k\\le n$，$1\\le a_i\\le10^9$，$c_{i} \\in \\{0,1\\}$，$0\\le d_k\\le 10^9$。\n\n保证此题的时空限制是标程的 **2** 倍及以上。", "locale": "zh-CN"}}}
{"pid": "P11764", "type": "P", "difficulty": 3, "samples": [["2\n4 4\n4 1 6 1\n3 20 10 12\n2 3 4 4\n4 9 10 10\n3 2\n1 2 6 0\n1 3 6 0", "6 20 18 4\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "Special Judge", "O2优化", "构造", "洛谷比赛"], "title": "「KFCOI Round #1」生成序列", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/w0cqwhal.png)", "description": "你需要生成一个长度为 $n$ 的非负整数序列 $a$。\n\n$a$ 满足 $m$ 条限制，第 $i$ 条限制形如：\n\n* 若将 $a_{x_i}$ 修改为 $y_i$，则序列中恰好有 $k_i$ 个区间满足修改前后，其区间和的变化量不超过 $p_i$。\n\n各个限制间独立，即修改操作没有真的执行。\n\n为了防止序列中的数过大，如果存在 $a_i>2\\times 10^9$，则认为序列 $a$ 不满足限制。\n\n若有多个满足条件的序列，输出任意一个即可。若无解，输出 `-1`。", "inputFormat": "本题输入均为正整数。\n\n第一行一个数 $T$。\n\n对于每组数据：\n\n第一行两个数 $n,m$。\n\n接下来 $m$ 行，每行四个数 $x_i,y_i,k_i,p_i$。", "outputFormat": "**本题使用 SPJ**。\n\n每组数据一行。\n\n若有解，输出 $n$ 个非负整数，第 $i$ 个数代表 $a_i$。\n\n若无解，输出 `-1`。", "hint": "### 样例解释\n\n对于第一组数据：\n\n$a_1=6$，$a_2=20$，$a_3=18$，$a_4=4$。\n\n若将 $a_4$ 改为 $1$，则有 $6$ 个区间的区间和变化量不超过 $1$，分别为：\n\n`[1,1],[1,2],[1,3],[2,2],[2,3],[3,3]`。\n\n若将 $a_3$ 改为 $20$，则所有区间的区间和变化量均不超过 $12$。\n\n若将 $a_2$ 改为 $3$，则有 $4$ 个区间的区间和变化量不超过 $4$，分别为：\n\n`[1,1],[3,3],[3,4],[4,4]`。\n\n若将 $a_4$ 改为 $9$，则所有区间的区间和变化量均不超过 $10$。\n\n可能存在其他解，输出任意一个即可。\n\n对于第二组数据，可以证明没有符合条件的序列满足限制。\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试**。\n\n\n- Subtask 1（10 points）：$1 \\le n \\le 10$，$1 \\le m \\le 10$，$1 \\le y_i \\le 10$，$1 \\le p_i\\le 10$。\n- Subtask 2（10 points）：$m=1$。\n- Subtask 3（10 points）：$k_i=\\frac{n(n+1)}{2}$。\n- Subtask 4（20 points）：$1 \\le n \\le 10 ^ 4$，$1 \\le m \\le 10 ^ 4$，$1 \\le y_i \\le 10 ^4$，$1 \\le p_i\\le 10^4$。\n- Subtask 5（50 points）：无特殊限制。\n\n\n对于所有测试数据，$1 \\le n\\le 10^5$，$1\\le m\\le 10^5$，$1 \\le T\\le 10$，$1\\le x_i\\le n$，$1 \\le k_i\\le \\frac{n(n+1)}{2}$，$1 \\le y_i \\le 10 ^ 9$，$0 \\le p_i\\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「KFCOI Round #1」生成序列", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/w0cqwhal.png)", "description": "你需要生成一个长度为 $n$ 的非负整数序列 $a$。\n\n$a$ 满足 $m$ 条限制，第 $i$ 条限制形如：\n\n* 若将 $a_{x_i}$ 修改为 $y_i$，则序列中恰好有 $k_i$ 个区间满足修改前后，其区间和的变化量不超过 $p_i$。\n\n各个限制间独立，即修改操作没有真的执行。\n\n为了防止序列中的数过大，如果存在 $a_i>2\\times 10^9$，则认为序列 $a$ 不满足限制。\n\n若有多个满足条件的序列，输出任意一个即可。若无解，输出 `-1`。", "inputFormat": "本题输入均为正整数。\n\n第一行一个数 $T$。\n\n对于每组数据：\n\n第一行两个数 $n,m$。\n\n接下来 $m$ 行，每行四个数 $x_i,y_i,k_i,p_i$。", "outputFormat": "**本题使用 SPJ**。\n\n每组数据一行。\n\n若有解，输出 $n$ 个非负整数，第 $i$ 个数代表 $a_i$。\n\n若无解，输出 `-1`。", "hint": "### 样例解释\n\n对于第一组数据：\n\n$a_1=6$，$a_2=20$，$a_3=18$，$a_4=4$。\n\n若将 $a_4$ 改为 $1$，则有 $6$ 个区间的区间和变化量不超过 $1$，分别为：\n\n`[1,1],[1,2],[1,3],[2,2],[2,3],[3,3]`。\n\n若将 $a_3$ 改为 $20$，则所有区间的区间和变化量均不超过 $12$。\n\n若将 $a_2$ 改为 $3$，则有 $4$ 个区间的区间和变化量不超过 $4$，分别为：\n\n`[1,1],[3,3],[3,4],[4,4]`。\n\n若将 $a_4$ 改为 $9$，则所有区间的区间和变化量均不超过 $10$。\n\n可能存在其他解，输出任意一个即可。\n\n对于第二组数据，可以证明没有符合条件的序列满足限制。\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试**。\n\n\n- Subtask 1（10 points）：$1 \\le n \\le 10$，$1 \\le m \\le 10$，$1 \\le y_i \\le 10$，$1 \\le p_i\\le 10$。\n- Subtask 2（10 points）：$m=1$。\n- Subtask 3（10 points）：$k_i=\\frac{n(n+1)}{2}$。\n- Subtask 4（20 points）：$1 \\le n \\le 10 ^ 4$，$1 \\le m \\le 10 ^ 4$，$1 \\le y_i \\le 10 ^4$，$1 \\le p_i\\le 10^4$。\n- Subtask 5（50 points）：无特殊限制。\n\n\n对于所有测试数据，$1 \\le n\\le 10^5$，$1\\le m\\le 10^5$，$1 \\le T\\le 10$，$1\\le x_i\\le n$，$1 \\le k_i\\le \\frac{n(n+1)}{2}$，$1 \\le y_i \\le 10 ^ 9$，$0 \\le p_i\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P11765", "type": "P", "difficulty": 4, "samples": [["5 5 3\n1 2 3 4 5\n1 2\n2 3\n1 4\n2 4\n4 5", "6 5 1 8 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "O2优化", "矩阵加速", "矩阵乘法", "洛谷比赛"], "title": "「KFCOI Round #1」回首", "background": "控制住不爱一个人很难，因为爱是自由意识的沉沦。\n\n其实从始至终，只要你回首，他就永远都陪伴在你身后。", "description": "你一共有 $n$ 条重要的回忆，每条回忆有一个重要系数 $k_i$，并且这 $n$ 条回忆彼此之间有 $m$ 个前后关系。\n\n每一条关系 $u,v(1\\le u,v\\le n)$ 表示 $u$ 发生的时间**恰好**在 $v$ 前。\n\n可能是因为时间过久导致你的记忆错乱，在时间线中可能会出现环。\n\n一开始，所有点的重要度均为 $0$，一共你会进行 $T$ 次回想操作。\n\n若当前正在进行第 $t$ 次操作：\n\n* 操作前，对于一条回忆 $x_i$，它的重要度会乘上重要系数 $k_i$。\n\n* 操作中，对于一条回忆 $x_i$，如果有**恰好**发生在回忆 $x_i$ 前的回忆 $y_i$，那么将回忆 $x_i$ 的重要度增加 $y_i$ 在本次乘上重要系数 $k_i$ **之前**的重要度。否则回忆 $x_i$ 的重要度增加 $t$。\n\n当然，为了防止一条回忆过于重要，输出每条回忆的重要度对 $998244353$ 取余的结果。\n\n****\n\n形式化题意：\n\n给定一个 $n$ 个节点，$m$ 条边的有向图，并保证不会出现重边。初始所有点的点权都为 $0$。\n\n一共将进行 $T$ 次操作。\n\n对于第 $t$ 次操作，首先将所有点的点权乘上一个给定的值 $k_i$。\n\n接下来，对于一个点 $x_i$，如果有连向它的点 $y_i$，那么将 $x_i$ 的权值加上 $y_i$ 在本次乘上 $k_i$ 之前的权值。否则如果没有连向它的点，$x_i$ 的权值加上 $t$。\n\n输出的所有点的权值对 $998244353$ 取余的结果。", "inputFormat": "本题输入均为正整数。\n\n第一行三个数 $n,m,T$，表示一共有 $n$ 条回忆，$m$ 个关系，以及一共进行 $T$ 次回想操作。\n\n第二行 $n$ 个数，表示重要系数 $k_i$。\n\n接下来 $m$ 行，每行两个数 $x_i,y_i$，表示 $x_i$ 发生的时间恰好先于 $y_i$。", "outputFormat": "输出共一行 $n$ 个数，第 $i$ 个数表示第 $i$ 个点的重要度对 $998244353$ 取余的结果。", "hint": "样例解释 1：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9h5jwi1l.png)\n\n第一次操作时，所有的点重要度为 $0$。\n\n乘上重要系数后依旧为 $0$。\n\n第一个点的重要度加上当前正在进行的回想操作次数 $1$。\n\n其余点均加上 $0$。\n\n第一次操作后，所有点的重要度分别为 `1,0,0,0,0`。\n\n类似的，第二次操作后，所有点的重要度分别为 `3,1,0,1,0`。\n\n第三次操作后，所有点的重要度分别为 `6,5,1,8,1`。\n\n****\n\n### 数据范围\n\n**本题采用捆绑测试**。\n\n- Subtask 1（20 points）：$1\\le n \\le 10$，$1\\le T \\le 10$。\n- Subtask 2（20 points）：$1\\le T\\le 10^5$。\n- Subtask 3（60 points）：无特殊限制。\n\n对于所有测试数据，$1\\le n\\le100$，$1\\le m\\le300$，$1\\le T\\le10^{18}$，$1\\le k_i\\le10^9$，$1\\le x_i,y_i\\le n$。\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「KFCOI Round #1」回首", "background": "控制住不爱一个人很难，因为爱是自由意识的沉沦。\n\n其实从始至终，只要你回首，他就永远都陪伴在你身后。", "description": "你一共有 $n$ 条重要的回忆，每条回忆有一个重要系数 $k_i$，并且这 $n$ 条回忆彼此之间有 $m$ 个前后关系。\n\n每一条关系 $u,v(1\\le u,v\\le n)$ 表示 $u$ 发生的时间**恰好**在 $v$ 前。\n\n可能是因为时间过久导致你的记忆错乱，在时间线中可能会出现环。\n\n一开始，所有点的重要度均为 $0$，一共你会进行 $T$ 次回想操作。\n\n若当前正在进行第 $t$ 次操作：\n\n* 操作前，对于一条回忆 $x_i$，它的重要度会乘上重要系数 $k_i$。\n\n* 操作中，对于一条回忆 $x_i$，如果有**恰好**发生在回忆 $x_i$ 前的回忆 $y_i$，那么将回忆 $x_i$ 的重要度增加 $y_i$ 在本次乘上重要系数 $k_i$ **之前**的重要度。否则回忆 $x_i$ 的重要度增加 $t$。\n\n当然，为了防止一条回忆过于重要，输出每条回忆的重要度对 $998244353$ 取余的结果。\n\n****\n\n形式化题意：\n\n给定一个 $n$ 个节点，$m$ 条边的有向图，并保证不会出现重边。初始所有点的点权都为 $0$。\n\n一共将进行 $T$ 次操作。\n\n对于第 $t$ 次操作，首先将所有点的点权乘上一个给定的值 $k_i$。\n\n接下来，对于一个点 $x_i$，如果有连向它的点 $y_i$，那么将 $x_i$ 的权值加上 $y_i$ 在本次乘上 $k_i$ 之前的权值。否则如果没有连向它的点，$x_i$ 的权值加上 $t$。\n\n输出的所有点的权值对 $998244353$ 取余的结果。", "inputFormat": "本题输入均为正整数。\n\n第一行三个数 $n,m,T$，表示一共有 $n$ 条回忆，$m$ 个关系，以及一共进行 $T$ 次回想操作。\n\n第二行 $n$ 个数，表示重要系数 $k_i$。\n\n接下来 $m$ 行，每行两个数 $x_i,y_i$，表示 $x_i$ 发生的时间恰好先于 $y_i$。", "outputFormat": "输出共一行 $n$ 个数，第 $i$ 个数表示第 $i$ 个点的重要度对 $998244353$ 取余的结果。", "hint": "样例解释 1：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9h5jwi1l.png)\n\n第一次操作时，所有的点重要度为 $0$。\n\n乘上重要系数后依旧为 $0$。\n\n第一个点的重要度加上当前正在进行的回想操作次数 $1$。\n\n其余点均加上 $0$。\n\n第一次操作后，所有点的重要度分别为 `1,0,0,0,0`。\n\n类似的，第二次操作后，所有点的重要度分别为 `3,1,0,1,0`。\n\n第三次操作后，所有点的重要度分别为 `6,5,1,8,1`。\n\n****\n\n### 数据范围\n\n**本题采用捆绑测试**。\n\n- Subtask 1（20 points）：$1\\le n \\le 10$，$1\\le T \\le 10$。\n- Subtask 2（20 points）：$1\\le T\\le 10^5$。\n- Subtask 3（60 points）：无特殊限制。\n\n对于所有测试数据，$1\\le n\\le100$，$1\\le m\\le300$，$1\\le T\\le10^{18}$，$1\\le k_i\\le10^9$，$1\\le x_i,y_i\\le n$。\n\n", "locale": "zh-CN"}}}
{"pid": "P11766", "type": "P", "difficulty": 5, "samples": [["6\n1 2 1\n2 3 1\n2 4 1\n4 5 1\n4 6 1", "44"], ["10\n6 10 3\n9 5 4\n6 7 10\n6 5 9\n10 4 8\n5 1 9\n8 10 10\n2 7 1\n3 1 3", "52"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["线段树", "洛谷原创", "O2优化", "树形 DP", "树的直径", "洛谷比赛"], "title": "「KFCOI Round #1」遥不可及", "background": "你未曾料到，烟火散尽，余烬渐冷，那一转身的轻易告别，却成了永远的诀别。\n\n但是，你决意追寻她的身影，哪怕在这永无止境的重逢梦中。", "description": " $n$ 个地点构成了复杂的关系网。\n\n但是现在这些地点复杂的路线关系被简化成为了**一棵树**。\n\n\n你从每个点均出发一次，当你从点 $u$ 出发时，你会找到这个点能到达的所有最远点 $v_1,v_2,\\cdots v_k$，并对每个 $v_i$，将 $u$ 到 $v_i$ 简单路径上的点权值加 $1$。\n\n\n询问最终所有地点的权值总和。", "inputFormat": "本题输入均为正整数。\n\n第一行一个数 $n$，表示有 $n$ 个地点。\n\n接下来 $n−1$ 行，每行三个整数 $a_i,b_i,w_i$ 表示一条边。", "outputFormat": "一行一个数，表示所有地点最后的权值总和。", "hint": "样例一解释：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6viyvcu1.png)\n\n从 $1$ 出发，最远距离为 $3$，故到达 $5$ 和 $6$，各点权为 $[2,2,0,2,1,1]$；\n\n从 $2$ 出发，最远距离为 $2$，故到达 $5$ 和 $6$，各点权为 $[2,4,0,4,2,2]$；\n\n从 $3$ 出发，最远距离为 $3$，故到达 $5$ 和 $6$，各点权为 $[2,6,2,6,3,3]$；\n\n从 $4$ 出发，最远距离为 $2$，故到达 $1$ 和 $3$，各点权为 $[3,8,3,8,3,3]$；\n\n从 $5$ 出发，最远距离为 $3$，故到达 $1$ 和 $3$，各点权为 $[4,10,4,10,5,3]$；\n\n从 $6$ 出发，最远距离为 $3$，故到达 $1$ 和 $3$，各点权为 $[5,12,5,12,5,5]$。\n\n所以最终各点权和为 $44$。\n\n（黄色为 $1$ 出发的路径；红色为 $2$；蓝色为 $3$；绿色为 $4$；青色为 $5$；紫色为 $6$。）\n\n***\n\n**本题采用捆绑测试**。\n\n- Subtask 1（20 points，1 s）：$1\\le n \\le 5000$。\n- Subtask 2（40 points，1 s）：$1\\le n \\le 5\\times 10^5$。\n- Subtask 3（10 points，1 s）：树的形态为链。\n- Subtask 4（10 points，2 s）：树的形态为菊花。\n- Subtask 5（20 points，2 s）：无特殊限制。\n\n对于所有测试数据，$1\\le n\\le 10^6$，$1\\le w_i \\le 10^9$，$1\\le a_i \\le n$，$1 \\le b_i\\le n$。\n\n\n本题输入数据较大，请使用较快的读入方式和实现方式。请注意本题的栈空间。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「KFCOI Round #1」遥不可及", "background": "你未曾料到，烟火散尽，余烬渐冷，那一转身的轻易告别，却成了永远的诀别。\n\n但是，你决意追寻她的身影，哪怕在这永无止境的重逢梦中。", "description": " $n$ 个地点构成了复杂的关系网。\n\n但是现在这些地点复杂的路线关系被简化成为了**一棵树**。\n\n\n你从每个点均出发一次，当你从点 $u$ 出发时，你会找到这个点能到达的所有最远点 $v_1,v_2,\\cdots v_k$，并对每个 $v_i$，将 $u$ 到 $v_i$ 简单路径上的点权值加 $1$。\n\n\n询问最终所有地点的权值总和。", "inputFormat": "本题输入均为正整数。\n\n第一行一个数 $n$，表示有 $n$ 个地点。\n\n接下来 $n−1$ 行，每行三个整数 $a_i,b_i,w_i$ 表示一条边。", "outputFormat": "一行一个数，表示所有地点最后的权值总和。", "hint": "样例一解释：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6viyvcu1.png)\n\n从 $1$ 出发，最远距离为 $3$，故到达 $5$ 和 $6$，各点权为 $[2,2,0,2,1,1]$；\n\n从 $2$ 出发，最远距离为 $2$，故到达 $5$ 和 $6$，各点权为 $[2,4,0,4,2,2]$；\n\n从 $3$ 出发，最远距离为 $3$，故到达 $5$ 和 $6$，各点权为 $[2,6,2,6,3,3]$；\n\n从 $4$ 出发，最远距离为 $2$，故到达 $1$ 和 $3$，各点权为 $[3,8,3,8,3,3]$；\n\n从 $5$ 出发，最远距离为 $3$，故到达 $1$ 和 $3$，各点权为 $[4,10,4,10,5,3]$；\n\n从 $6$ 出发，最远距离为 $3$，故到达 $1$ 和 $3$，各点权为 $[5,12,5,12,5,5]$。\n\n所以最终各点权和为 $44$。\n\n（黄色为 $1$ 出发的路径；红色为 $2$；蓝色为 $3$；绿色为 $4$；青色为 $5$；紫色为 $6$。）\n\n***\n\n**本题采用捆绑测试**。\n\n- Subtask 1（20 points，1 s）：$1\\le n \\le 5000$。\n- Subtask 2（40 points，1 s）：$1\\le n \\le 5\\times 10^5$。\n- Subtask 3（10 points，1 s）：树的形态为链。\n- Subtask 4（10 points，2 s）：树的形态为菊花。\n- Subtask 5（20 points，2 s）：无特殊限制。\n\n对于所有测试数据，$1\\le n\\le 10^6$，$1\\le w_i \\le 10^9$，$1\\le a_i \\le n$，$1 \\le b_i\\le n$。\n\n\n本题输入数据较大，请使用较快的读入方式和实现方式。请注意本题的栈空间。", "locale": "zh-CN"}}}
{"pid": "P11767", "type": "P", "difficulty": 4, "samples": [["6 3 3\n1 3\n2 3\n3 5", "42\n30\n60"], ["10 7 5\n3 9\n8 6\n5 7\n9 6\n10 7", "181440\n5040\n15120\n10080\n75600"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "O2优化", "组合数学", "洛谷比赛"], "title": "「KFCOI Round #1」缥缈", "background": "这个世界这么大，是机缘让我们相遇，也是机缘促使我们分开。\n\n是爱情促使我们沉沦，也是爱情让我们形同陌路。\n\n在这一路上，为什么就刚好喜欢上你呢？", "description": "你需要求出满足如下条件的长度为 $m$ 的序列 $B$ 的个数：\n- $B$ 中全为正整数。\n- $B$ 中不包含 $x$。\n- $B$ 中元素两两不同。\n- $B$ 中元素在范围 $[1,n]$ 中。\n- $B$ 中任意两个元素相差不会超过 $t$。\n\n$q$ 次询问，每次给出 $x$ 和 $t$。\n\n由于结果可能很大，输出答案对 $10^9+7$ 取余的结果。", "inputFormat": "本题输入均为正整数。\n\n第一行三个数 $n,m,q$。\n\n接下来 $q$ 行，每行两个数 $x,t$ 代表一个询问。", "outputFormat": "输出 $q$ 行，每行一个数，第 $i$ 行代表第 $i$ 次询问的答案对 $10^9+7$ 取余的结果。", "hint": "### 数据范围\n\n**本题采用捆绑测试**。\n\n- Subtask 1（10 points）：$n \\le 12$，$m\\le 7$，$q\\le 10$。\n- Subtask 2（15 points）：$n \\le 2000$，$m=2$，$q\\le 2000$。\n- Subtask 3（15 points）：$m=2$。\n- Subtask 4（20 points）：$x\\le t$。\n- Subtask 5（40 points）：无特殊限制。\n\n对于所有测试数据，$2\\le n \\le 2 \\times 10 ^5$，$2 \\le m \\le n$，$1 \\le x \\le n$，$m - 1\\le t < n$，$1 \\le q \\le 2\\times 10^5$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「KFCOI Round #1」缥缈", "background": "这个世界这么大，是机缘让我们相遇，也是机缘促使我们分开。\n\n是爱情促使我们沉沦，也是爱情让我们形同陌路。\n\n在这一路上，为什么就刚好喜欢上你呢？", "description": "你需要求出满足如下条件的长度为 $m$ 的序列 $B$ 的个数：\n- $B$ 中全为正整数。\n- $B$ 中不包含 $x$。\n- $B$ 中元素两两不同。\n- $B$ 中元素在范围 $[1,n]$ 中。\n- $B$ 中任意两个元素相差不会超过 $t$。\n\n$q$ 次询问，每次给出 $x$ 和 $t$。\n\n由于结果可能很大，输出答案对 $10^9+7$ 取余的结果。", "inputFormat": "本题输入均为正整数。\n\n第一行三个数 $n,m,q$。\n\n接下来 $q$ 行，每行两个数 $x,t$ 代表一个询问。", "outputFormat": "输出 $q$ 行，每行一个数，第 $i$ 行代表第 $i$ 次询问的答案对 $10^9+7$ 取余的结果。", "hint": "### 数据范围\n\n**本题采用捆绑测试**。\n\n- Subtask 1（10 points）：$n \\le 12$，$m\\le 7$，$q\\le 10$。\n- Subtask 2（15 points）：$n \\le 2000$，$m=2$，$q\\le 2000$。\n- Subtask 3（15 points）：$m=2$。\n- Subtask 4（20 points）：$x\\le t$。\n- Subtask 5（40 points）：无特殊限制。\n\n对于所有测试数据，$2\\le n \\le 2 \\times 10 ^5$，$2 \\le m \\le n$，$1 \\le x \\le n$，$m - 1\\le t < n$，$1 \\le q \\le 2\\times 10^5$。\n", "locale": "zh-CN"}}}
{"pid": "P11768", "type": "P", "difficulty": 2, "samples": [["3\n4 5 3 2\n1 1 4 5\n8 8 4 8", "3\n2\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "洛谷原创", "O2优化", "洛谷月赛"], "title": "破自行车", "background": "某个夏天，18071 号工作室的 staff 集体转业了。辗转至年末，天依终于在 40312 号工作室拉到了合作。但是……看着编号的差距，按时到班可不是一件容易的事情。\n\n七点半，闹铃声响起，早高峰即将迎接起床气！", "description": "天依住在的城市像一个无穷大的曼哈顿。如果把城市地图放在平面直角坐标系中，任何一个**整点** $(x,y)$ 都是一个十字路口。天依家门口的十字路口为 $(0,0)$，天依需要从这里出发，尽快抵达工作室所在的十字路口 $(a,b)$。每分钟，天依可以从她所在的十字路口 $(x,y)$ 移动至 $(x+1,y)$，$(x-1,y)$，$(x,y+1)$ 或者 $(x,y-1)$。\n\n天依怎么会走路上班呢？她可以使用一辆很快很邪门的破自行车！骑上它，天依可以从 $(x,y)$ 瞬间冲到 $(x+l,y)$，$(x,y+l)$，$(x-l,y)$，$(x,y-l)$ 四个位置中的一个，不花费任何时间。但为了避免破自行车散架，天依最多使用 $k$ 次自行车。\n\n那么，在破自行车的助力下，天依至少需要多少时间才能从 $(0,0)$ 出发到达 $(a,b)$ 呢?\n\n因为工作室经常搬家，所以有多组测试数据。", "inputFormat": "第一行一个整数 $T$，表示测试数据组数。\n\n接下来 $T$ 行，每行四个整数 $a,b,k,l$，分别表示工作室所在的十字路口的横纵坐标，自行车的使用次数限制和自行车的移动距离。", "outputFormat": "输出 $T$ 行，第 $i$ 行一个整数，表示第 $i$ 组数据中到达工作室的最小时间。", "hint": "### 样例解释：\n\n我们使用 $>$ 表示猛冲，$\\to$ 表示行走。\n\n对于样例一，一种可能的移动方式是：$(0,0)>(2,0)\\to(3,0)\\to(4,0)\\to(4,1)>(4,3)>(4,5)$。\n\n对于样例二，一种可能的移动方式是：$(0,0)\\to(0,1)\\to(1,1)$。\n\n对于样例三，一种可能的移动方式是：$(0,0)>(0,8)>(8,8)$。\n\n### 数据规模与约定\n\n**本题采用捆绑测试。** 仅当你通过了该子任务的全部测试数据才能获得该子任务的分值。\n\n对于 $100\\%$ 的数据，$1 \\leq T \\leq 10^5$，$0 \\leq a,b,k,l\\leq 10^{9}$。\n\n对于不同的子任务，作如下约定：\n\n| 子任务编号 | $T$ | $a,b,l$ | $k$ | 特殊性质 | 子任务分值 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\le10^5$ | $\\le10^9$ | $=0$ | 无 | $15$ |\n| $2$ | $\\le10$ | $\\le10$ | $\\le10$ | 无 | $10$ |\n| $3$ | $\\le10$ | $\\le10^9$ | $\\le20$ | 无 | $15$ |\n| $4$ | $\\le10$ | $\\le10^9$ | $\\le10^3$ | 无 | $20$ |\n| $5$ | $\\le10^5$ | $\\le10^9$ | $\\le10^9$ | $a,b\\le l$ | $15$ |\n| $6$ | $\\le10^5$ | $\\le10^9$ | $\\le10^9$ | 无 | $25$ |\n", "locale": "zh-CN", "translations": {"en": {"title": "Broken Bicycle", "background": "Once in a summer, the entire staff of Studio 18071 transferred to new careers collectively. By the end of the year, Tianyi finally secured a collaboration in Studio 40312. However... Judging from the far cry in the studio numbers, getting to work on time was no easy task.\n\nAt 7:30 a.m., the alarm clock rang, signaling the dawn of the morning rush hour and the impending battle against the grogginess of waking up!", "description": "The city where Tianyi lives is like an infinitely large Manhattan. If we place the city map on a Cartesian coordinate system, any **integer point** $(x,y)$ represents an intersection. Tianyi's doorstep intersection is at $(0,0)$, and she needs to start from here and reach the intersection $(a,b)$ of the studio as soon as possible. Every minute, Tianyi can move from her current intersection $(x,y)$ to $(x+1,y)$, $(x-1,y)$, $(x,y+1)$, or $(x,y-1)$.\n\nBut why would Tianyi walk to work? She has a very fast and mysterious broken bicycle! With it, Tianyi can instantly charge from $(x,y)$ to any one of the four positions $(x+l,y)$, $(x,y+l)$, $(x-l,y)$, $(x,y-l)$, without spending any time. However, to prevent the broken bicycle from falling apart, Tianyi can only use it up to $k$ times.\n\nSo, with the help of the broken bicycle, what is the minimum time Tianyi needs to travel from $(0,0)$ to $(a,b)$?\n\nDue to the frequent moving of the studio, there are multiple test cases.", "inputFormat": "The first line of the input contains an integer $T$ — the number of test cases.\n\nThe only line of each test case contains four intergers $a,b,k,l$ — the x,y coordinates of the intersection where the studio is located, the usage limit of the bicycle, and the charging distance of the bicycle.", "outputFormat": "For each test case, output a single integer — the minimum time Tianyi needs to travel from $(0,0)$ to $(a,b)$.", "hint": "### Sample Explanation \n\nWe use $>$ to represent charging, and $\\to$ to represent walking.\n\nFor the first test case, a possible moving way is: $(0,0)>(2,0)\\to(3,0)\\to(4,0)\\to(4,1)>(4,3)>(4,5)$.\n\nFor the second test case, a possible moving way is: $(0,0)\\to(0,1)\\to(1,1)$.\n\nFor the third test case, a possible moving way is: $(0,0)>(0,8)>(8,8)$.\n\n### Constraints\n\n**Subtasks applied.** You can only gain the score of the subtask if you accepted all the tests in the subtask.\n\n| Subtask ID | $T$ | $a,b,l$ | $k$ | Special Property | Score |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\le10^5$ | $\\le10^9$ | $=0$ | $-$ | $15$ |\n| $2$ | $\\le10$ | $\\le10$ | $\\le10$ | $-$ | $10$ |\n| $3$ | $\\le10$ | $\\le10^9$ | $\\le20$ | $-$ | $15$ |\n| $4$ | $\\le10$ | $\\le10^9$ | $\\le10^3$ | $-$ | $20$ |\n| $5$ | $\\le10^5$ | $\\le10^9$ | $\\le10^9$ | $a,b\\le l$ | $15$ |\n| $6$ | $\\le10^5$ | $\\le10^9$ | $\\le10^9$ | $-$ | $25$ |\n\nFor all tests, it is guaranteed that $1 \\leq T \\leq 10^5$，$0 \\leq a,b,k,l\\leq 10^{9}$.", "locale": "en"}, "zh-CN": {"title": "破自行车", "background": "某个夏天，18071 号工作室的 staff 集体转业了。辗转至年末，天依终于在 40312 号工作室拉到了合作。但是……看着编号的差距，按时到班可不是一件容易的事情。\n\n七点半，闹铃声响起，早高峰即将迎接起床气！", "description": "天依住在的城市像一个无穷大的曼哈顿。如果把城市地图放在平面直角坐标系中，任何一个**整点** $(x,y)$ 都是一个十字路口。天依家门口的十字路口为 $(0,0)$，天依需要从这里出发，尽快抵达工作室所在的十字路口 $(a,b)$。每分钟，天依可以从她所在的十字路口 $(x,y)$ 移动至 $(x+1,y)$，$(x-1,y)$，$(x,y+1)$ 或者 $(x,y-1)$。\n\n天依怎么会走路上班呢？她可以使用一辆很快很邪门的破自行车！骑上它，天依可以从 $(x,y)$ 瞬间冲到 $(x+l,y)$，$(x,y+l)$，$(x-l,y)$，$(x,y-l)$ 四个位置中的一个，不花费任何时间。但为了避免破自行车散架，天依最多使用 $k$ 次自行车。\n\n那么，在破自行车的助力下，天依至少需要多少时间才能从 $(0,0)$ 出发到达 $(a,b)$ 呢?\n\n因为工作室经常搬家，所以有多组测试数据。", "inputFormat": "第一行一个整数 $T$，表示测试数据组数。\n\n接下来 $T$ 行，每行四个整数 $a,b,k,l$，分别表示工作室所在的十字路口的横纵坐标，自行车的使用次数限制和自行车的移动距离。", "outputFormat": "输出 $T$ 行，第 $i$ 行一个整数，表示第 $i$ 组数据中到达工作室的最小时间。", "hint": "### 样例解释：\n\n我们使用 $>$ 表示猛冲，$\\to$ 表示行走。\n\n对于样例一，一种可能的移动方式是：$(0,0)>(2,0)\\to(3,0)\\to(4,0)\\to(4,1)>(4,3)>(4,5)$。\n\n对于样例二，一种可能的移动方式是：$(0,0)\\to(0,1)\\to(1,1)$。\n\n对于样例三，一种可能的移动方式是：$(0,0)>(0,8)>(8,8)$。\n\n### 数据规模与约定\n\n**本题采用捆绑测试。** 仅当你通过了该子任务的全部测试数据才能获得该子任务的分值。\n\n对于 $100\\%$ 的数据，$1 \\leq T \\leq 10^5$，$0 \\leq a,b,k,l\\leq 10^{9}$。\n\n对于不同的子任务，作如下约定：\n\n| 子任务编号 | $T$ | $a,b,l$ | $k$ | 特殊性质 | 子任务分值 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\le10^5$ | $\\le10^9$ | $=0$ | 无 | $15$ |\n| $2$ | $\\le10$ | $\\le10$ | $\\le10$ | 无 | $10$ |\n| $3$ | $\\le10$ | $\\le10^9$ | $\\le20$ | 无 | $15$ |\n| $4$ | $\\le10$ | $\\le10^9$ | $\\le10^3$ | 无 | $20$ |\n| $5$ | $\\le10^5$ | $\\le10^9$ | $\\le10^9$ | $a,b\\le l$ | $15$ |\n| $6$ | $\\le10^5$ | $\\le10^9$ | $\\le10^9$ | 无 | $25$ |\n", "locale": "zh-CN"}}}
{"pid": "P11769", "type": "P", "difficulty": 4, "samples": [["3\n3 2 3\n2 -1 1", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["贪心", "洛谷原创", "O2优化", "洛谷月赛"], "title": "歌唱练习", "background": "2077 年，万众瞩目的天依 v100 声库发布了！\n\n但是要熟悉这套新声库可不是件容易的事。", "description": "天依制定了一个长为 $n$ 天的练习计划。天依十分努力，她每天的练习时长必须**单调不降**。同时，为了保护嗓子，第 $i$ 天**最多**练习 $t_i$ 个单位时间。每一天练习的效果都是不同的，受到天气等多种因素影响，我们用 $w_i$ 量化第 $i$ 天的练习效果，表示她在第 $i$ 天每练习一个单位时间会使她的熟悉度提升 $w_i$。注意 $w_i<0$ 也是可能发生的，或许这天太热她越练越糟。\n\n现在，天依已经查明了 $n$ 天的天气预报并估算出了每天的 $t_i$ 与 $w_i$，请问她至多能将她的熟悉度提升多少？", "inputFormat": "第一行包含一个整数 $n$，表示天依练习计划的天数。\n\n第二行包含 $n$ 个整数，第 $i$ 个整数为 $t_i$，表示第 $i$ 天天依不能超过的练习时长。\n\n第三行包含 $n$ 个整数，第 $i$ 个整数为 $w_i$，表示第 $i$ 天天依每练习一个单位时间的熟悉度增加量。", "outputFormat": "输出一行，包含一个整数，表示天依最多能将她的熟悉度提升的量。", "hint": "### 样例解释\n第 $1$ 天练习 $2$ 个单位时间，使熟悉度提高 $4$；  \n第 $2$ 天练习 $2$ 个单位时间，使熟悉度提高 $-2$（降低 $2$）；  \n第 $3$ 天练习 $3$ 个单位时间，使熟悉度提高 $3$。  \n天依的熟悉度总共提高了 $5$。\n\n可以证明，不存在比上述方案更优的选择。\n\n### 数据规模与约定\n\n**本题采用捆绑测试。** 仅当你通过了该子任务的全部测试数据才能获得该子任务的分值。\n\n对于 $100\\%$ 的数据，$1\\le n\\le10^6$，$0\\le t_i\\le10^9$，$-1000\\le w_i\\le1000$。\n\n对于不同的子任务，作如下约定：\n\n|子任务编号|$n\\le$|$t_i\\le$|特殊性质|子任务分值|\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$15$|$15$|无|$10$|\n|$2$|$15$|$10^9$|无|$10$|\n|$3$|$100$|$100$|无|$10$|\n|$4$|$5000$|$5000$|无|$10$|\n|$5$|$5000$|$10^9$|无|$10$|\n|$6$|$10^5$|$10^5$|无|$10$|\n|$7$|$10^6$|$1$|无|$5$|\n|$8$|$10^6$|$10^9$|有|$15$|\n|$9$|$10^6$|$10^9$|无|$20$|\n\n特殊性质：保证 $t_i$ 在 $[0,10^9]$ 中均匀随机生成。", "locale": "zh-CN", "translations": {"en": {"title": "Singing Practice", "background": "In 2077, the highly anticipated Tianyi v100 voicebank was released! \n\nHowever, getting familiar with this new voicebank is not an easy task.", "description": "Tianyi has made a practice plan spanning $n$ days. She works extremely hard, and her daily practice duration must be **monotonically non-decreasing**. Meanwhile, to protect her voice, she can practice for a **maximum** of $t_i$ units of time on the $i$-th day. The effectiveness of practice varies from day to day, influenced by factors such as weather, and we quantify the effectiveness of practice on the $i$-th day as $w_i$, indicating that every unit of time she practices on that day will increase her familiarity by $w_i$. Note that it is possible for $w_i$ to be less than $0$, meaning that perhaps due to factors like excessive heat, her practice may have a negative impact.\n\nNow, Tianyi has researched the weather forecast for the next $n$ days and estimated the values of $t_i$ and $w_i$ for each day. Please determine the maximum amount her familiarity can be improved.", "inputFormat": "The first line of input contains an integer $n$ — the number of days in Tianyi's practice plan.\n\nThe second line of input contains $n$ integers $t_i$ — the maximum units of time Tianyi can spend on practicing on each day.\n\nThe third line of input contains $n$ integers $w_i$ — the effectiveness of practice on each day.", "outputFormat": "The only line of output contains an integer — the maximum amount her familiarity can be improved.", "hint": "### Sample Explanation\n\nShe practices for $2$ units of time on the first day,increasing her familarity by $4$;  \nShe practices for $2$ units of time on the second day,increasing her familarity by $-2$ (decreasing by $2$);  \nShe practices for $3$ units of time on the third day,increasing her familarity by $3$.  \nTianyi's familiarity has increased by a total of 5.\n\nIt can be proved that there is no way to increase her familiarity higher than $5$.\n\n### Constraints\n\n**Subtasks Applied.** You can only gain the score of the subtask if you accepted all the tests in the subtask.\n\n|Subtask ID|$n\\le$|$t_i\\le$|Special Property|Score|\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$10$|$10$|No|$10$|\n|$2$|$10$|$10^9$|No|$10$|\n|$3$|$100$|$100$|No|$10$|\n|$4$|$5000$|$5000$|No|$10$|\n|$5$|$5000$|$10^9$|No|$10$|\n|$6$|$10^5$|$10^5$|No|$10$|\n|$7$|$10^6$|$1$|No|$5$|\n|$8$|$10^6$|$10^9$|Yes|$15$|\n|$9$|$10^6$|$10^9$|No|$20$|\n\nSpecial Property: $t_i$ is uniformly randomly generated in $[0,10^9]$\n\nFor all tests, it is guaranteed that $1\\le n\\le10^6$，$0\\le t_i\\le10^9$，$-1000\\le w_i\\le1000$.", "locale": "en"}, "zh-CN": {"title": "歌唱练习", "background": "2077 年，万众瞩目的天依 v100 声库发布了！\n\n但是要熟悉这套新声库可不是件容易的事。", "description": "天依制定了一个长为 $n$ 天的练习计划。天依十分努力，她每天的练习时长必须**单调不降**。同时，为了保护嗓子，第 $i$ 天**最多**练习 $t_i$ 个单位时间。每一天练习的效果都是不同的，受到天气等多种因素影响，我们用 $w_i$ 量化第 $i$ 天的练习效果，表示她在第 $i$ 天每练习一个单位时间会使她的熟悉度提升 $w_i$。注意 $w_i<0$ 也是可能发生的，或许这天太热她越练越糟。\n\n现在，天依已经查明了 $n$ 天的天气预报并估算出了每天的 $t_i$ 与 $w_i$，请问她至多能将她的熟悉度提升多少？", "inputFormat": "第一行包含一个整数 $n$，表示天依练习计划的天数。\n\n第二行包含 $n$ 个整数，第 $i$ 个整数为 $t_i$，表示第 $i$ 天天依不能超过的练习时长。\n\n第三行包含 $n$ 个整数，第 $i$ 个整数为 $w_i$，表示第 $i$ 天天依每练习一个单位时间的熟悉度增加量。", "outputFormat": "输出一行，包含一个整数，表示天依最多能将她的熟悉度提升的量。", "hint": "### 样例解释\n第 $1$ 天练习 $2$ 个单位时间，使熟悉度提高 $4$；  \n第 $2$ 天练习 $2$ 个单位时间，使熟悉度提高 $-2$（降低 $2$）；  \n第 $3$ 天练习 $3$ 个单位时间，使熟悉度提高 $3$。  \n天依的熟悉度总共提高了 $5$。\n\n可以证明，不存在比上述方案更优的选择。\n\n### 数据规模与约定\n\n**本题采用捆绑测试。** 仅当你通过了该子任务的全部测试数据才能获得该子任务的分值。\n\n对于 $100\\%$ 的数据，$1\\le n\\le10^6$，$0\\le t_i\\le10^9$，$-1000\\le w_i\\le1000$。\n\n对于不同的子任务，作如下约定：\n\n|子任务编号|$n\\le$|$t_i\\le$|特殊性质|子任务分值|\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$15$|$15$|无|$10$|\n|$2$|$15$|$10^9$|无|$10$|\n|$3$|$100$|$100$|无|$10$|\n|$4$|$5000$|$5000$|无|$10$|\n|$5$|$5000$|$10^9$|无|$10$|\n|$6$|$10^5$|$10^5$|无|$10$|\n|$7$|$10^6$|$1$|无|$5$|\n|$8$|$10^6$|$10^9$|有|$15$|\n|$9$|$10^6$|$10^9$|无|$20$|\n\n特殊性质：保证 $t_i$ 在 $[0,10^9]$ 中均匀随机生成。", "locale": "zh-CN"}}}
{"pid": "P11770", "type": "P", "difficulty": 5, "samples": [["5\n1\n5\n3\n114514\n2000000", "1\n18\n6\n18057023450\n5575638612615"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数论", "洛谷原创", "O2优化", "洛谷月赛"], "title": "檐牙覆雪", "background": "“雨打在窗沿，下坠，一级一级。”\n\n但这次是雪啦！天依与阿绫靠在窗边，赏着乍到的飞雪。", "description": "还是熟悉的地方：一共有 $n$ 级窗沿，从高到低编号，最高层编号为 $1$，最底层编号为 $n$。天依注意到，每一级窗沿上的积雪都可以看作包含若干雪团的可重集合，一开始，第 $1$ 级窗沿上有一团体积为 $1$ 的雪，其他窗沿上没有任何积雪。忽然，一阵夹杂着雪的风刮过，片刻间积雪产生了 $n$ 次变换——\n\n第 $i$ 次变换中，第 $i$ 级窗沿上的**每一团**雪都会被卷起，由于奇妙的物理原因，所有编号是 $i$ 的整数倍（**不包括** $i$ 自身）的窗沿都会接收到新的积雪。具体地，设一团被卷起的雪体积为 $V$，则在上述窗沿中，编号最大者会得到一团体积为 $V+1$ 的积雪，次大者会得到一团体积为 $V+2$ 的积雪，以此类推。最后，被卷起的雪团神奇地回到第 $i$ 级窗沿，也就是说本次变换后，第 $i$ 级窗沿上的积雪没有任何变化。\n\n阿绫知道天依正在好奇：$n$ 次变换之后，每级窗沿上**体积最大的一团**雪的总体积是多少呢？既然她们正静静赏雪，就由你来回答这个问题叭！", "inputFormat": "第一行一个整数 $T$，表示数据组数。\n\n第 $2\\sim T+1$ 行每行一个整数，分别表示每组数据的 $n$。", "outputFormat": "共 $T$ 行，分别表示每组数据的答案。", "hint": "**样例解释**\n\n$n=5$ 时的终态如下：\n\n第 $1$ 级窗沿上有体积为 $1$ 的雪团；  \n第 $2$ 级窗沿上有体积为 $5$ 的雪团；  \n第 $3$ 级窗沿上有体积为 $4$ 的雪团；  \n第 $4$ 级窗沿上有体积为 $3,6$ 的雪团；  \n第 $5$ 级窗沿上有体积为 $2$ 的雪团；  \n\n体积最大值之和为 $1+5+4+6+2=18$。\n\n### 数据规模与约定\n\n**本题采用捆绑测试。** 仅当你通过了该子任务的全部测试数据才能获得该子任务的分值。\n\n对于 $100\\%$ 的数据，$1\\le T\\le5\\times10^5$，$1\\le n\\le2\\times10^6$。\n\n对于不同的子任务，作如下约定：\n\n| 子任务编号 | $T$ | $n$ | 子任务分值 |\n| :---: | :---: | :---: | :---: |\n| 1 | $\\leq 100$ | $\\leq 3\\times10^4$ | $15$ |\n| 2 | $\\leq 100$ | $\\leq 2\\times10^6$ | $35$ |\n| 3 | $\\leq 3\\times10^4$ | $\\leq 3\\times10^4$ | $15$ |\n| 4 | $\\leq 2\\times10^5$ | $\\leq 2\\times10^5$ | $15$ |\n| 5 | $\\leq 5\\times10^5$ | $\\leq 2\\times 10^6$ | $20$ |", "locale": "zh-CN", "translations": {"en": {"title": "Eaves cloaked in snow", "background": "*The rain taps against the windowsill, cascading down, step by step, in a poetic dance.*\n\nBut it's snow! Leaning against the window, Tianyi and Ling admire the suddenly arrived flurries of snow.", "description": "Still in the familiar place: there are a total of $n$ window ledges, numbered from top to bottom, with the topmost being numbered $1$ and the bottommost being numbered $n$. Tianyi notices that the snow accumulations on each ledge can be viewed as a multiset of snowballs, where initially, the first ledge holds a single snowball with a volume of $1$, while the other ledges are devoid of any snow. Suddenly, a gust of wind laden with snow blows through, instigating $n$ transformations in the snow accumulations -\n\nIn the $i$-th transformation, **every** snowball  on the $i$-th ledge is lifted up. Due to peculiar physical phenomena, all ledges whose numbers are multiples of $i$ (**excluding** $i$ itself) receive new snow accumulations. Specifically, let the volume of a lifted snowball be $V$. Among these receiving ledges, the one with the largest number receives a snowball of volume $V+1$, the second largest receives a snowball of volume $V+2$, and so on. In the end, the lifted snowball mysteriously returns to the $i$-th ledge, leaving the snow accumulation on the $i$-th ledge unchanged after this transformation.\n\nLing knows that Tianyi is intrigued by the question: After the $n$ transformations, what is the total volume of **the largest** snowball on each ledge? As they sit peacefully admiring the snow, you are tasked with answering this question for them.", "inputFormat": "The first line of the input contains an integer $T$ — the number of test cases.\n\nThe only line of each test case contains an intergers $n$ — the number of window ledges.", "outputFormat": "For each test case, output a single integer — the total volume of the largest snowball on each ledge.", "hint": "### Sample Explanation\n\nThe final state when $n=5$ is as follows:\n\nOn the first ledge is a snowball with a volume of $1$;  \nOn the second ledge is a snowball with a volume of $5$;  \nOn the third ledge is a snowball with a volume of $4$;  \nOn the fourth ledge are two snowballs with volumes of $3,6$;  \nOn the fifth ledge is a snowball with a volume of $2$;  \n\nThe total volume of the largest snowball on each ledge is $1+5+4+6+2=18$.\n\n### Constrains\n\n**Subtasks applied.** You can only gain the score of the subtask if you accepted all the tests in the subtask.\n\n| Subtask ID | $T\\leq$ | $n\\leq$ | Score |\n| :---: | :---: | :---: | :---: |\n| 1 | $100$ | $ 3\\times10^4$ | $15$ |\n| 2 | $ 100$ | $ 2\\times10^6$ | $35$ |\n| 3 | $ 3\\times10^4$ | $ 3\\times10^4$ | $15$ |\n| 4 | $ 2\\times10^5$ | $ 2\\times10^5$ | $15$ |\n| 5 | $ 5\\times10^5$ | $ 2\\times 10^6$ | $20$ |\n\nFor all tests, it is guaranteed that $1\\le T\\le5\\times10^5$，$1\\le n\\le2\\times10^6$.", "locale": "en"}, "zh-CN": {"title": "檐牙覆雪", "background": "“雨打在窗沿，下坠，一级一级。”\n\n但这次是雪啦！天依与阿绫靠在窗边，赏着乍到的飞雪。", "description": "还是熟悉的地方：一共有 $n$ 级窗沿，从高到低编号，最高层编号为 $1$，最底层编号为 $n$。天依注意到，每一级窗沿上的积雪都可以看作包含若干雪团的可重集合，一开始，第 $1$ 级窗沿上有一团体积为 $1$ 的雪，其他窗沿上没有任何积雪。忽然，一阵夹杂着雪的风刮过，片刻间积雪产生了 $n$ 次变换——\n\n第 $i$ 次变换中，第 $i$ 级窗沿上的**每一团**雪都会被卷起，由于奇妙的物理原因，所有编号是 $i$ 的整数倍（**不包括** $i$ 自身）的窗沿都会接收到新的积雪。具体地，设一团被卷起的雪体积为 $V$，则在上述窗沿中，编号最大者会得到一团体积为 $V+1$ 的积雪，次大者会得到一团体积为 $V+2$ 的积雪，以此类推。最后，被卷起的雪团神奇地回到第 $i$ 级窗沿，也就是说本次变换后，第 $i$ 级窗沿上的积雪没有任何变化。\n\n阿绫知道天依正在好奇：$n$ 次变换之后，每级窗沿上**体积最大的一团**雪的总体积是多少呢？既然她们正静静赏雪，就由你来回答这个问题叭！", "inputFormat": "第一行一个整数 $T$，表示数据组数。\n\n第 $2\\sim T+1$ 行每行一个整数，分别表示每组数据的 $n$。", "outputFormat": "共 $T$ 行，分别表示每组数据的答案。", "hint": "**样例解释**\n\n$n=5$ 时的终态如下：\n\n第 $1$ 级窗沿上有体积为 $1$ 的雪团；  \n第 $2$ 级窗沿上有体积为 $5$ 的雪团；  \n第 $3$ 级窗沿上有体积为 $4$ 的雪团；  \n第 $4$ 级窗沿上有体积为 $3,6$ 的雪团；  \n第 $5$ 级窗沿上有体积为 $2$ 的雪团；  \n\n体积最大值之和为 $1+5+4+6+2=18$。\n\n### 数据规模与约定\n\n**本题采用捆绑测试。** 仅当你通过了该子任务的全部测试数据才能获得该子任务的分值。\n\n对于 $100\\%$ 的数据，$1\\le T\\le5\\times10^5$，$1\\le n\\le2\\times10^6$。\n\n对于不同的子任务，作如下约定：\n\n| 子任务编号 | $T$ | $n$ | 子任务分值 |\n| :---: | :---: | :---: | :---: |\n| 1 | $\\leq 100$ | $\\leq 3\\times10^4$ | $15$ |\n| 2 | $\\leq 100$ | $\\leq 2\\times10^6$ | $35$ |\n| 3 | $\\leq 3\\times10^4$ | $\\leq 3\\times10^4$ | $15$ |\n| 4 | $\\leq 2\\times10^5$ | $\\leq 2\\times10^5$ | $15$ |\n| 5 | $\\leq 5\\times10^5$ | $\\leq 2\\times 10^6$ | $20$ |", "locale": "zh-CN"}}}
{"pid": "P11771", "type": "P", "difficulty": 6, "samples": [["4\n3 4 5\n2 4 3 1", "39"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["线段树", "洛谷原创", "O2优化", "容斥原理", "洛谷月赛"], "title": "调的啥啊", "background": "**为避免卡常，本题时限为比赛时的 2 倍。**\n\n你试过用笔记本的触摸板操作扒谱吗？\n\n阿绫正在玩天依——最新的 X Studio 声库，由于触控板和鼠标神秘失踪，她每调整一个音符都极其费力……\n", "description": "在阿绫正在调的序列中一共有 $n$ 个音符，从左至右第 $i$ 个音符的音高为 $s_i$。阿绫发现其中三个音符 $s_i,s_j,s_k~(1\\le i<j<k\\le n)$ 产生的听感不佳，她决定将它们调整为 $s_i',s_j',s_k'$，使得 $s_i'\\le s_k'$ 且 $s_j'\\le s_k'$。扒拉触摸板真的很难受：\n\n- 调节 $s_i$ 到 $s_i'$ 需要耗费阿绫 $a\\times|s_i-s_i'|$ 的精力；\n- 调节 $s_j$ 到 $s_j'$ 需要耗费阿绫 $b\\times|s_j-s_j'|$ 的精力；\n- 调节 $s_k$ 到 $s_k'$ 需要耗费阿绫 $c\\times|s_k-s_k'|$ 的精力。\n\n于是，调节完这三个音符，阿绫耗费的精力为：\n$$\nz=a\\cdot|s_i-s_i'|+b\\cdot|s_j-s_j'|+c\\cdot|s_k-s_k'|.\n$$\n\n阿绫自然会找到使得 $z$ 值最小的 $(s_i',s_j',s_k')$，记此时的 $z$ 值为 $f(i,j,k)$。现在阿绫想知道，对于所有满足 $i<j<k$ 的 $(i,j,k)$，$f(i,j,k)$ 之和是多少呢？你只需要回答她这一答案对 $2^{32}$ 取模的结果。", "inputFormat": "第一行一个整数 $n$ 表示音符序列的长度。\n\n第二行三个整数 $a$，$b$，$c$。\n\n第三行 $n$ 个整数表示 $s$ 序列，也就是每个音符的音高。", "outputFormat": "一行一个整数即答案。", "hint": "### 样例解释\n\n$f(1,2,3)=4$，其中一组最优的 $(s_i',s_j',s_k')$ 为 $(2,3,3)$。\n\n$f(1,2,4)=13$，其中一组最优的 $(s_i',s_j',s_k')$ 为 $(2,2,2)$。\n\n$f(1,3,4)=9$，其中一组最优的 $(s_i',s_j',s_k')$ 为 $(2,2,2)$。\n\n$f(2,3,4)=13$，其中一组最优的 $(s_i',s_j',s_k')$ 为 $(3,3,3)$。\n\n$f(i,j,k)$ 的总和为 $4+13+9+13=39$。\n\n### 数据规模与约定\n\n**本题采用捆绑测试。** 仅当你通过了该子任务的全部测试数据才能获得该子任务的分值。\n\n对于 $100\\%$ 的数据，$3\\le n\\le5\\times10^5$，$1\\le s_i,a,b,c\\le 10^9$。\n\n对于不同的子任务，作如下约定：\n\n| 子任务编号\t| $n$ | 特殊性质 | 子任务分值 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $=3$ | 无 | $5$ |\n| $2$ | $\\le300$ | 无 | $5$ |\n| $3$ | $\\le1000$ | 无 | $10$ |\n| $4$ | $\\le5\\times10^3$ | 无 | $20$ |\n| $5$ | $\\le5\\times10^4$ | 无 | $20$ |\n| $6$ | $\\le5\\times10^5$ | 有 | $20$ |\n| $7$ | $\\le5\\times10^5$ | 无 | $20$ |\n\n特殊性质：出现的不同音高不超过 $10$ 种。", "locale": "zh-CN", "translations": {"en": {"title": "Attunement is hard", "background": "Have you tried to do attunement with the touchpad of a notebook?\n\nAling is playing Tianyi — 's newest X Studio voicebank. Due to the mysterious disappearance of her mouse, it takes an extreme effort for her to adjust every note......", "description": "In the note sequence Aling is adjusting is $n$ notes in total. The $i$-th note from the left has a pitch of $s_i$. Aling discovered that three of the notes $s_i,s_j,s_k~(1\\le i<j<k\\le n)$ is bad to listen to, thus she decided to change them into $s_i',s_j',s_k'$, where $s_i'\\le s_k'$ and $s_j'\\le s_k'$. However, operating on a touchpad is tough:\n\n- Adjusting $s_i$ to $s_i'$ takes her $a\\times|s_i-s_i'|$ points of energy.\n\n- Adjusting $s_j$ to $s_j'$ takes her $b\\times|s_j-s_j'|$ points of energy.\n\n- Adjusting $s_k$ to $s_k'$ takes her $c\\times|s_k-s_k'|$ points of energy.\n\nTherefore, to finish the adjusting work on all the three notes, the points of energy she need is:\n\n$$\nz=a\\cdot|s_i-s_i'|+b\\cdot|s_j-s_j'|+c\\cdot|s_k-s_k'|.\n$$\n\nAling surely will find $(s_i',s_j',s_k')$ that makes $z$ minimum. Let $f(i,j,k)$ denote the minimum $z$. Aling now wants to know the sum over all the $f(i,j,k)$s that $i<j<k$. You're only required to output the ans modulo $2^{32}$.", "inputFormat": "The first line of input contains an integer $n$ — the length to the note sequence.\n\nThe second line of input contains three integers $a,b,c$ — the mentioned constants in the description.\n\nThe third line od input contains $n$ integers $s_i$ — the pitch of each note.", "outputFormat": "One integer — the remainder of the sum over all the $f(i,j,k)$s that $i<j<k$.", "hint": "### Sample Explanation\n\n$f(1,2,3)=4$, one of the ideal $(s_i',s_j',s_k')$s is $(2,3,3)$.\n\n$f(1,2,4)=13$, one of the ideal $(s_i',s_j',s_k')$s is $(2,2,2)$.\n\n$f(1,3,4)=9$, one of the ideal $(s_i',s_j',s_k')$s is $(2,2,2)$.\n\n$f(2,3,4)=13$, one of the ideal $(s_i',s_j',s_k')$s is $(3,3,3)$.\n\nThe sum of the $f(i,j,k)$s is $4+13+9+13=39$.\n\n### Constraints\n\n**Subtasks Applied.** You can only gain the score of the subtask if you accepted all the tests in the subtask.\n\n| Subtask ID\t| $n$ | Special Property | Score |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $=3$ | No | $5$ |\n| $2$ | $\\le300$ | No | $5$ |\n| $3$ | $\\le900$ | No | $10$ |\n| $4$ | $\\le3\\times10^3$ | No | $20$ |\n| $5$ | $\\le5\\times10^4$ | No | $20$ |\n| $6$ | $\\le5\\times10^5$ | Yes | $20$ |\n| $7$ | $\\le5\\times10^5$ | No | $20$ |\n\nSpecial Property: the quantity of different pitches is at most $10$.(i.e. there is at most 10 kinds of pitches.)\n\nFor all tests, it is guaranteed that $3\\le n\\le5\\times10^5$，$1\\le s_i,a,b,c\\le 10^9$.", "locale": "en"}, "zh-CN": {"title": "调的啥啊", "background": "**为避免卡常，本题时限为比赛时的 2 倍。**\n\n你试过用笔记本的触摸板操作扒谱吗？\n\n阿绫正在玩天依——最新的 X Studio 声库，由于触控板和鼠标神秘失踪，她每调整一个音符都极其费力……\n", "description": "在阿绫正在调的序列中一共有 $n$ 个音符，从左至右第 $i$ 个音符的音高为 $s_i$。阿绫发现其中三个音符 $s_i,s_j,s_k~(1\\le i<j<k\\le n)$ 产生的听感不佳，她决定将它们调整为 $s_i',s_j',s_k'$，使得 $s_i'\\le s_k'$ 且 $s_j'\\le s_k'$。扒拉触摸板真的很难受：\n\n- 调节 $s_i$ 到 $s_i'$ 需要耗费阿绫 $a\\times|s_i-s_i'|$ 的精力；\n- 调节 $s_j$ 到 $s_j'$ 需要耗费阿绫 $b\\times|s_j-s_j'|$ 的精力；\n- 调节 $s_k$ 到 $s_k'$ 需要耗费阿绫 $c\\times|s_k-s_k'|$ 的精力。\n\n于是，调节完这三个音符，阿绫耗费的精力为：\n$$\nz=a\\cdot|s_i-s_i'|+b\\cdot|s_j-s_j'|+c\\cdot|s_k-s_k'|.\n$$\n\n阿绫自然会找到使得 $z$ 值最小的 $(s_i',s_j',s_k')$，记此时的 $z$ 值为 $f(i,j,k)$。现在阿绫想知道，对于所有满足 $i<j<k$ 的 $(i,j,k)$，$f(i,j,k)$ 之和是多少呢？你只需要回答她这一答案对 $2^{32}$ 取模的结果。", "inputFormat": "第一行一个整数 $n$ 表示音符序列的长度。\n\n第二行三个整数 $a$，$b$，$c$。\n\n第三行 $n$ 个整数表示 $s$ 序列，也就是每个音符的音高。", "outputFormat": "一行一个整数即答案。", "hint": "### 样例解释\n\n$f(1,2,3)=4$，其中一组最优的 $(s_i',s_j',s_k')$ 为 $(2,3,3)$。\n\n$f(1,2,4)=13$，其中一组最优的 $(s_i',s_j',s_k')$ 为 $(2,2,2)$。\n\n$f(1,3,4)=9$，其中一组最优的 $(s_i',s_j',s_k')$ 为 $(2,2,2)$。\n\n$f(2,3,4)=13$，其中一组最优的 $(s_i',s_j',s_k')$ 为 $(3,3,3)$。\n\n$f(i,j,k)$ 的总和为 $4+13+9+13=39$。\n\n### 数据规模与约定\n\n**本题采用捆绑测试。** 仅当你通过了该子任务的全部测试数据才能获得该子任务的分值。\n\n对于 $100\\%$ 的数据，$3\\le n\\le5\\times10^5$，$1\\le s_i,a,b,c\\le 10^9$。\n\n对于不同的子任务，作如下约定：\n\n| 子任务编号\t| $n$ | 特殊性质 | 子任务分值 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $=3$ | 无 | $5$ |\n| $2$ | $\\le300$ | 无 | $5$ |\n| $3$ | $\\le1000$ | 无 | $10$ |\n| $4$ | $\\le5\\times10^3$ | 无 | $20$ |\n| $5$ | $\\le5\\times10^4$ | 无 | $20$ |\n| $6$ | $\\le5\\times10^5$ | 有 | $20$ |\n| $7$ | $\\le5\\times10^5$ | 无 | $20$ |\n\n特殊性质：出现的不同音高不超过 $10$ 种。", "locale": "zh-CN"}}}
{"pid": "P11772", "type": "P", "difficulty": 6, "samples": [["5\n1 5\n2 2 5\n3 1 3\n1 5\n1 6", "4\n6\n12"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数论", "洛谷原创", "O2优化", "分块", "洛谷月赛", "整除分块"], "title": "报社天狗", "background": "因为天依想不到新歌歌词怎么写破防了，所以这题的主人公不是天依。", "description": "新一期《文文。新闻》开售了！\n\n$n$ 只$^\\dag$妖怪排队购买《文文。新闻》，将她们依次编号 $1\\sim n$，每一只妖怪会购买若干份。然而，她们购买《文文。新闻》并不是为了阅读，而是是为了送给所有编号是自己倍数的的妖怪一份（自己可以不留）。也就是说，对于 $1\\sim n$ 的每只妖怪，依次进行：当手上的《文文。新闻》数量足够时，不进行购买，直接赠送；而不够时便会先向文文购买至刚好足够，再进行赠送。\n\n文文为了使收益最大化，为每只妖怪详细制定了价格方案。具体地，第 $i$ 只妖怪在已有 $j$ 份《文文。新闻》时再买一份花费的价钱是 $a_i\\times b_{j+1}$，其中 $a,b$ 是两个从 $1$ 开始的长为 $10^6+1$ 的正整数序列。\n\n现在文文需要一个合理的定价方案，她决定从 $a,b$ 全为 $1$ 时开始调整。具体地，有以下三种操作：\n\n- `1 x` 询问以当前的 $a,b$ 数组，$n=x$ 时文文能有多少营业额，因为结果可能很大，你需要求出答案对 $2^{32}$ 取模后的结果。\n- `2 x y` 适当地调整 $a$ 数组的值：令 $a_x=y$；\n- `3 x y` 适当地调整 $b$ 数组的值：令 $b_x=y$。\n\n$\\dag$：经查证，量词为『只』和『个』的情况均有出现，THBwiki 中『一只妖怪』的匹配量显著多于『一个妖怪』，于是本题中采用『只』，并不是出题人的种族歧视。", "inputFormat": "第一行一个整数 $T$ 表示操作的数量。\n\n第 $2\\sim T+1$ 行，每行 $2$ 或 $3$ 个整数，表示题目中的一次操作。", "outputFormat": "每行一个整数，表示每次询问的获利对 $2^{32}$ 取模后的结果。", "hint": "### 样例解释\n\n第一个询问中，$n=5$，两个序列中所有的元素均为 $1$。$1$ 号妖怪买了 $4$ 份报纸，每份报纸的收益都是 $1$，其他的妖怪都没有买报纸，总收益为 $4$。\n\n第二个询问中，有 $n=5,a_2=3,b_1=5$，序列中其他元素均为 $1$。$1$ 号妖怪买了 $4$ 份报纸，其中第 $1$ 份报纸的收益是 $3$，第 $2$ 份到第 $4$ 份报纸的收益都是 $1$，其他的妖怪都没有买报纸，总收益为 $6$。\n\n第三个询问中，有 $n=6,a_2=3,b_1=5$，序列中其他元素均为 $1$。让我们具体来看看这次询问中的过程：\n\n+ $1$ 号妖怪需要送其他每个妖怪各一份报纸，但是她没有报纸。于是她需要买 $5$ 份报纸。其中第一份报纸的收益是 $a_1\\times b_1=3$，第 $2$ 份到第 $5$ 份报纸的收益都是 $1$。然后她给了其他每个妖怪各一份报纸。\n\n+ $2$ 号妖怪需要送 $4$ 号妖怪和 $6$ 号妖怪各一份报纸，她已经从 $1$ 号妖怪手中获得了一份报纸。于是她还需要买 $1$ 份报纸，这份报纸的收益是 $a_2\\times b_2=5$。\n\n+ $3$ 号妖怪需要送 $6$ 号妖怪一份报纸，她已经从 $1$ 号妖怪手中获得了一份报纸，不需要再买报纸。\n\n+ $4$ 号妖怪到 $6$ 号妖怪都不需要送出报纸，也不需要再买报纸。\n\n总收益为 $12$。\n\n### 数据规模与约定\n\n**本题采用捆绑测试。** 仅当你通过了该子任务的全部测试数据才能获得该子任务的分值。\n\n对于 $100\\%$ 的数据，$1 \\leq T \\leq 10^5$，$1 \\leq x,n\\leq 10^6$，$1\\le y\\le 10^9$。\n\n对于不同的子任务，作如下约定：\n\n| 子任务编号 |  特殊性质                  | 子任务分值 |\n| :-----: | :----------------------------------: | :----: |\n|    $1$    |      没有修改操作                      | $10$ |\n|    $2$    | 第一种操作中的每个 $n$ 都相等 | $20$ |\n|    $3$    |    $n,T \\leq 10^5$                   | $30$ |\n|    $4$    | 无 | $40$ |", "locale": "zh-CN", "translations": {"en": {"title": "The Newspaper Tengu", "background": "Tianyi couldn't think of one single line of lyrics for her new song and got depressed, thus the main character of the problem is not Tianyi.", "description": "New issue of Bunbunmaru Newspaper is on sale!\n\n$n$ youkais numbered $1$ to $n$ waits in a line buying the newspaper. Each of them may buy multiple pieces, one single piece or none, depending on their goal — Instead of buying to read, they buy the newspaper to share. One will give a piece of newspaper to everyone whose ID is a multiple of her own ID, even without leaving herself one piece. Youkais numbered $1$ to $n$ will follow this process in sequence: If the number of newspaper pieces she have is sufficient, she will proceed directly to the giveaway. If not, she will purchase the exact number of newspapers needed before completing the giveaway.\n\nTo maximize her profit, Syameimaru Aya, the writer of Bunbunmaru Newspaper, is planning to make a pricing scheme. The scheme is described by two 1-indexed arrays of positive integers $a,b$, which have a length of $10^6+1$ each. When a youkai with ID $i$ holding $j$ pieces of newspaper buy one another piece of newspaper, she should pay $a_i\\times b_{j+1}$ yen.\n\nNow Aya needs a fair pricing scheme. She chose to begin adjusting the sequences starting when all elements in $a$ and $b$ are initialized to $1$. And then there's three types of $T$ operations:\n\n- `1 x` Aya asks you how much revenue she can make in the current state of sequences $a$ and $b$. Since the answer could be too large, you should output the answer $\\bmod~ 2^{32}$.\n\n- `2 x y` Aya changes the $x$-th element of array $a$ to $y$.\n\n- `3 x y` Aya changes the $x$-th element of array $b$ to $y$.\n\nCan you answer all of her questions?", "inputFormat": "The first line of input contains an integer $T$ — the amount of operations.\n\nThe following $T$ rows each contain $2$ or $3$ integers, representing an operation as described in the problem.", "outputFormat": "For each operation of the first type, print the answer, modulo $2^{32$.", "hint": "### Sample Explanation \n\nIn the first question, $n=5$, all the elements in two arrays equal to $1$. the youkai with ID $1$ need to buy $4$ pieces of newspaper and cost $1$ yen for each piece. Other youkais don't need to buy any newspaper. the revenue in total will be $4$ yen.\n\nIn the second question, $n=5,a_2=5,b_1=3$, other elements in two arrays equal to $1$. the youkai with ID $1$ need to buy $4$ pieces of newspaper and cost $3$ yen for the first piece, $1$ yen for the other pieces. Other youkais don't need to buy any newspaper. the revenue in total will be $6$ yen.\n\nIn the third question, $n=6,a_2=5,b_1=3$, other elements in two arrays equal to $1$. Let's check out the details in this question:\n\n+ The youkai with ID $1$ needs to give other youkais one pieces of newspaper each, but she has none, so she needs to buy $5$ pieces of newspaper. the first piece costs $a_1\\times b_1=3$ yen and the others cost $1$ yen each.\n\n+ The youkai with ID $2$ needs to give youkais with ID $4$ or $6$ one pieces of newspaper each. She has got a piece from the youkai with ID $1$, so she needs to buy $1$ piece of newspaper which costs $a_2\\times b_1=5$ yen.\n\n+ The youkai with ID $3$ needs to give youkai with ID $6$ one piece of newspaper, she has got a piece from the youkai with ID $1$, so she doesn't need to buy newspaper.\n\n+ the youkais with ID $4,5,6$ don't need to give out newspaper, so they doesn't need to buy newspaper.\n\nthe revenue in total will be $12$ yen.\n\n### Constraints\n\n**Subtasks applied.** You can only gain the score of the subtask if you accepted all the tests in the subtask.\n\n| Subtask ID | Special Property | Score |\n| :----------: | :----------: | :----------: |\n| $1$ | No modification operations exist | $10$ |\n| $2$ | $n$ in every operation of first type is same | $20$ |\n| $3$ | $n,T \\leq 10^5$ | $30$ |\n| $4$ | - | $40$ |\n\nFor all tests, it is guaranteed that $1 \\leq T \\leq 10^6$，$1 \\leq x,n\\leq 10^5$.", "locale": "en"}, "zh-CN": {"title": "报社天狗", "background": "因为天依想不到新歌歌词怎么写破防了，所以这题的主人公不是天依。", "description": "新一期《文文。新闻》开售了！\n\n$n$ 只$^\\dag$妖怪排队购买《文文。新闻》，将她们依次编号 $1\\sim n$，每一只妖怪会购买若干份。然而，她们购买《文文。新闻》并不是为了阅读，而是是为了送给所有编号是自己倍数的的妖怪一份（自己可以不留）。也就是说，对于 $1\\sim n$ 的每只妖怪，依次进行：当手上的《文文。新闻》数量足够时，不进行购买，直接赠送；而不够时便会先向文文购买至刚好足够，再进行赠送。\n\n文文为了使收益最大化，为每只妖怪详细制定了价格方案。具体地，第 $i$ 只妖怪在已有 $j$ 份《文文。新闻》时再买一份花费的价钱是 $a_i\\times b_{j+1}$，其中 $a,b$ 是两个从 $1$ 开始的长为 $10^6+1$ 的正整数序列。\n\n现在文文需要一个合理的定价方案，她决定从 $a,b$ 全为 $1$ 时开始调整。具体地，有以下三种操作：\n\n- `1 x` 询问以当前的 $a,b$ 数组，$n=x$ 时文文能有多少营业额，因为结果可能很大，你需要求出答案对 $2^{32}$ 取模后的结果。\n- `2 x y` 适当地调整 $a$ 数组的值：令 $a_x=y$；\n- `3 x y` 适当地调整 $b$ 数组的值：令 $b_x=y$。\n\n$\\dag$：经查证，量词为『只』和『个』的情况均有出现，THBwiki 中『一只妖怪』的匹配量显著多于『一个妖怪』，于是本题中采用『只』，并不是出题人的种族歧视。", "inputFormat": "第一行一个整数 $T$ 表示操作的数量。\n\n第 $2\\sim T+1$ 行，每行 $2$ 或 $3$ 个整数，表示题目中的一次操作。", "outputFormat": "每行一个整数，表示每次询问的获利对 $2^{32}$ 取模后的结果。", "hint": "### 样例解释\n\n第一个询问中，$n=5$，两个序列中所有的元素均为 $1$。$1$ 号妖怪买了 $4$ 份报纸，每份报纸的收益都是 $1$，其他的妖怪都没有买报纸，总收益为 $4$。\n\n第二个询问中，有 $n=5,a_2=3,b_1=5$，序列中其他元素均为 $1$。$1$ 号妖怪买了 $4$ 份报纸，其中第 $1$ 份报纸的收益是 $3$，第 $2$ 份到第 $4$ 份报纸的收益都是 $1$，其他的妖怪都没有买报纸，总收益为 $6$。\n\n第三个询问中，有 $n=6,a_2=3,b_1=5$，序列中其他元素均为 $1$。让我们具体来看看这次询问中的过程：\n\n+ $1$ 号妖怪需要送其他每个妖怪各一份报纸，但是她没有报纸。于是她需要买 $5$ 份报纸。其中第一份报纸的收益是 $a_1\\times b_1=3$，第 $2$ 份到第 $5$ 份报纸的收益都是 $1$。然后她给了其他每个妖怪各一份报纸。\n\n+ $2$ 号妖怪需要送 $4$ 号妖怪和 $6$ 号妖怪各一份报纸，她已经从 $1$ 号妖怪手中获得了一份报纸。于是她还需要买 $1$ 份报纸，这份报纸的收益是 $a_2\\times b_2=5$。\n\n+ $3$ 号妖怪需要送 $6$ 号妖怪一份报纸，她已经从 $1$ 号妖怪手中获得了一份报纸，不需要再买报纸。\n\n+ $4$ 号妖怪到 $6$ 号妖怪都不需要送出报纸，也不需要再买报纸。\n\n总收益为 $12$。\n\n### 数据规模与约定\n\n**本题采用捆绑测试。** 仅当你通过了该子任务的全部测试数据才能获得该子任务的分值。\n\n对于 $100\\%$ 的数据，$1 \\leq T \\leq 10^5$，$1 \\leq x,n\\leq 10^6$，$1\\le y\\le 10^9$。\n\n对于不同的子任务，作如下约定：\n\n| 子任务编号 |  特殊性质                  | 子任务分值 |\n| :-----: | :----------------------------------: | :----: |\n|    $1$    |      没有修改操作                      | $10$ |\n|    $2$    | 第一种操作中的每个 $n$ 都相等 | $20$ |\n|    $3$    |    $n,T \\leq 10^5$                   | $30$ |\n|    $4$    | 无 | $40$ |", "locale": "zh-CN"}}}
{"pid": "P11773", "type": "P", "difficulty": 7, "samples": [["5\n3 2\n3 2 1\n7 3\n4 1 3 2 5 7 6\n3 3\n2 1 3\n7 5\n1 2 3 4 5 6 7\n6 4\n1 1 4 5 1 4", "Yes\nl 1\nr 1\nl 1\no\nNo\nNo\nYes\no\nYes\nr 1\nl 1\no"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "Special Judge", "O2优化", "构造", "洛谷月赛"], "title": "巅峰手速", "background": "“老妹儿啊，今天该你做家务吧……”\n\n龙牙哥于是自愿体验了阿绫为他量身定制的游戏，把做家务的命运推上赌桌——", "description": "阿绫给了龙牙哥 $n$ 张卡牌，它们已经整齐码在了桌上，从左至右第 $i$ 张的卡牌上的数字为 $a_i$，龙牙哥需要通过一系列操作让卡牌上的数字从左至右**不降**。每次操作中，他可以抽出从左至右第 $k$（$k$ 为给定常数）张卡牌，然后将它放在这些牌的最左侧或最右侧。请帮助龙牙判断自己是否有可能完成目标，如果能，请顺便告诉他一种比较简单的操作方案。", "inputFormat": "首先输入一个整数 $T$，表示数据组数。\n\n对于每组数据，输入两行：\n\n第一行为两个整数 $n,k$，分别表示卡牌数量和给定常数。\n\n第二行为 $n$ 个整数，第 $i$ 个数表示第 $i$ 卡片上的数字 $a_i$。", "outputFormat": "对于每组数据，输出若干行。格式如下：\n\n- 若龙牙哥无法完成目标，只输出一行 `No`。\n\n- 若他能够完成目标，先输出一行 `Yes`，然后若干行形如 `l c` 或 `r c`，表示他连续做了 `c` 次将第 $k$ 张卡牌放到最左侧或最右侧的操作。最后再输出一个 `o`，表示操作结束。\n\n你的得分将与**操作方案的行数**（而非**操作次数**）有关。（详见**得分计算方式**）", "hint": "### 样例解释\n\n对于第一组样例：\n\n将第二张卡牌（$2$）放到最左侧，卡牌数字变为 $2,3,1$。  \n将第二张卡牌（$3$）放到最右侧，卡牌数字变为 $2,1,3$。  \n将第二张卡牌（$1$）放到最左侧，卡牌数字变为 $1,2,3$。\n\n此时卡牌上的数字不降，操作结束。\n\n### 得分计算方式\n\n在一个测试数据中，是否有解判断正确可获得 $20\\%$ 的分数。如果操作方案也正确，则会跟据操作方案的行数（不包含最后一行的 `o`）按下表得分。\n\n| 行数 | 得分 |\n| :-----------: | :-----------: |\n| $>7n$ | $40\\%$ |\n| $\\le7n$ | $60\\%$ |\n| $\\le5n$ | $80\\%$ |\n| $\\le3n$ | $100\\%$ |\n\n一个测试点的得分是其中每组测试数据得分的最小值。\n\n### 注意事项\n\n为了方便选手调试，本题下发了校验器用于本地自测校验得分，使用方法见后。需要注意下发的校验器与实际使用校验器的可能并不相同。我们保证实际使用的校验器在输出的操作序列行数不超过 $7n$ 的情况下用时不超过 500ms。\n\n如果输出格式有误，你将会获得 $0$ 分。因此，如果你会判断是否有解但无法给出操作方案，也需要在判断有解后输出一行 `o` 表示操作结束。\n\n为了避免无意义的反复操作，你需要保证每一次操作均有 $1\\leq c \\leq n$，否则将会获得 $0$ 分。\n\n### 校验器使用方法\n\n下载文件 `testlib.h` 与 `checker.cpp` 并将其置于同一文件夹。在该目录下运行命令 `g++ checker.cpp -o checker -std=c++14` 编译得到可执行文件 `checker.exe` (windows) / `checker` (linux)。\n\n假如自测输入为 `in.txt`，程序输出为 `out.txt`。由于校验器无法判断是否有解，你需要创建一个答案文件（假如叫作 `ans.txt`），并在其中每行一个地写入每组数据的有解情况。例如对于样例，答案文件应为\n\n```plain\nYes\nNo\nNo\nYes\nYes\n```\n\n将上述提到的输入、输出、答案三个文件与刚刚编译出来的校验器可执行文件置与同一文件夹。\n\n- 如果是 Windows Powershell，输入 `.\\checker.exe in.txt out.txt ans.txt`。\n\n- 如果是 Linux 终端，输入 `./checker in.txt out.txt ans.txt`。\n\n校验器有三种可能的输出：`wrong answer` / `ok` / `points x`，分别表示对于该测试点你没有分 / 满分 / 获得了占比为 `x` 的分。\n\n### 数据规模与约定\n\n**本题采用捆绑测试并开启所有合理的子任务依赖**\n\n对于 $100\\%$ 的数据，$1\\le T\\le10^5$，$1\\le k\\le n\\le 2\\times10^5$，$\\sum n\\le5\\times10^{5}$，$1\\le a_i\\le 10^9$。\n\n对于不同的子任务，作如下约定：\n\n| 子任务编号\t| $n$ | $k$ | 子任务分值 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $=5$ | $\\in[1,n]$ | $10$ |\n| $2$ | $\\le200$ | $\\in[1,n]$ | $40$ |\n| $3$ | $\\le2\\times10^5$ | $=2$ | $20$ |\n| $4$ | $\\le2\\times10^5$ | $\\in[1,n]$ | $30$ |", "locale": "zh-CN", "translations": {"en": {"title": " Ultra dexterity", "background": "\"It's you to do the housework today my lil sis!\"\n\nLongya therefore voluntarily tried Aling's tailor-made game for him, pushing his destiny onto the gambling table...", "description": "Aling gives Longya $n$ cards, which have been put on the table neatly in a row. The $i$-th card on the table from the left has a number $a_i$ written on it. Longya needs to make the written numbers arranged in a **non-descending order** with any number of operations decribed below:\n\n- draw out the $k$-th card from the left and put it on either the leftmost or the rightmost side of the cards, where $k$ is a given constant.\n\nLongya wants to know if he can reach the goal and also a simple plan if possible.", "inputFormat": "The first row of input contains an integer $T$ — the number of test cases.\n\nEach test case contains two rows:\n\nThe first row of a tast case contains two integers $n,k$ — the amount of the cards and the given constant.\n\nThe Second row of a test case contains $n$ integers $a_i$ — the written numbers on each card.", "outputFormat": "For all tests, output any row in the format described below:\n\n- If Longya can't reach the goal, output a line of a single `No`.\n\n- If Longya can reach the goal, output a line of a single `Yes`, then any number of rows to describe your plan in the format of `l c` or `r c`, denoting that he will do `c` consecutive operations to move the $k$-th card to the **l**eftmost or the **r**ightmost side of the sequence. Finally ouput a line of a single `o` denoting the end of the plan.\n\nYour score will be related to **the number of rows** of your plan (instead of **the number of operations**). (Further information is given in the **Score Calculation** part below.)", "hint": "### Sample Explanation\n\nFor test case 1:\n\nPut the second card ($2$) to the leftmost side, making the sequence $2,3,1$.\n\nPut the second card ($3$) to the rightmost side, making the sequence $2,1,3$.\n\nPut the second card ($1$) to the leftmost side, making the sequence $1,2,3$.\n\nThe sequence is now non-descending, thus the operations end.\n\n### Score Calculation\n\nThe score of a test data is the minimum score of the test cases.\n\nIn a test case, if you successfully determined if Longya can reach the goal, you will gain $20\\%$ of the maximum point. And if your plan is also right, you can gain a certain ratio of score where the ratio is described below:\n\n| Number of Rows | Ratio |\n| :-----------: | :-----------: |\n| $>7n$ | $40\\%$ |\n| $\\le7n$ | $60\\%$ |\n| $\\le5n$ | $80\\%$ |\n| $\\le3n$ | $100\\%$ |\n\n### Note\n\nTo make the your debug easier, we attached a checker file for calculating your score locally. The usage is described below in the next part.\n\nIf your output format is wrong, you will gain $0$ point. Therefore if you know whether it is possible to reach the goal but you can't construct a plan, please still output an `o` after your `Yes` to represent the end of your plan.\n\nTo avoid meaningless repeatition, you should guarantee $1\\leq c\\leq n$ for every line of your plan.\n\n### Usage of the checker\n\nDownload files `checker.cpp` and `testlib.h` **from the buttom of the Chinese statement**. Put them in the same folder and run command `g++ checker.cpp -o checker -std=c++14` in the directory to get the executable file `checker.exe` (Windows) / `checker` (Linux).\n\nAssume your custom input is in `in.txt` and you program output is `out.txt`. Since the checker can't determine whether it is possible to reach the goal, you should create an answer file (Assume it is `ans.txt`), and input the possibility one per  line. For example, the answer file of the sample input should be:\n\n```plain\nYes\nNo\nNo\nYes\nYes\n```\n\nPut the input, output and answer file in the same folder with the excutable checker file.\n\n- run `.\\checker.exe in.txt out.txt ans.txt` if you are in Windows Powershell.\n\n- run `./checker in.txt out.txt ans.txt` if you are in Linux Terminal.\n\nThere are three possible kinds output of the checker: `wrong answer` / `ok` / `points x`, which means you can gain score at a ratio of $0\\%$ / $100\\%$ / `x`.\n\n### Constraints\n\n**There exist subtasks and subtask dependency.** Your score in a subtask is the minimum score of the datas in the subtask and the depended subtasks. A subtask will be depended on all of which is a subset of it.\n\n| Subtask ID\t| $T$ | $n$ | $k$ | Score |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\le10^5$ | $=5$ | $\\in[1,n]$ | $10$ |\n| $2$ | $\\le100$ | $\\le500$ | $\\in[1,n]$ | $40$ |\n| $3$ | $\\le10^5$ | $\\le2\\times10^5$ | $=2$ | $20$ |\n| $4$ | $\\le10^5$ | $\\le2\\times10^5$ | $\\in[1,n]$ | $30$ |\n\nFor all tests, it is guaranteed that $1\\le T\\le10^5$，$1\\le k\\le n\\le 2\\times10^5$，$\\sum n\\le5\\times10^{5}$，$1\\le a_i\\le 10^9$.", "locale": "en"}, "zh-CN": {"title": "巅峰手速", "background": "“老妹儿啊，今天该你做家务吧……”\n\n龙牙哥于是自愿体验了阿绫为他量身定制的游戏，把做家务的命运推上赌桌——", "description": "阿绫给了龙牙哥 $n$ 张卡牌，它们已经整齐码在了桌上，从左至右第 $i$ 张的卡牌上的数字为 $a_i$，龙牙哥需要通过一系列操作让卡牌上的数字从左至右**不降**。每次操作中，他可以抽出从左至右第 $k$（$k$ 为给定常数）张卡牌，然后将它放在这些牌的最左侧或最右侧。请帮助龙牙判断自己是否有可能完成目标，如果能，请顺便告诉他一种比较简单的操作方案。", "inputFormat": "首先输入一个整数 $T$，表示数据组数。\n\n对于每组数据，输入两行：\n\n第一行为两个整数 $n,k$，分别表示卡牌数量和给定常数。\n\n第二行为 $n$ 个整数，第 $i$ 个数表示第 $i$ 卡片上的数字 $a_i$。", "outputFormat": "对于每组数据，输出若干行。格式如下：\n\n- 若龙牙哥无法完成目标，只输出一行 `No`。\n\n- 若他能够完成目标，先输出一行 `Yes`，然后若干行形如 `l c` 或 `r c`，表示他连续做了 `c` 次将第 $k$ 张卡牌放到最左侧或最右侧的操作。最后再输出一个 `o`，表示操作结束。\n\n你的得分将与**操作方案的行数**（而非**操作次数**）有关。（详见**得分计算方式**）", "hint": "### 样例解释\n\n对于第一组样例：\n\n将第二张卡牌（$2$）放到最左侧，卡牌数字变为 $2,3,1$。  \n将第二张卡牌（$3$）放到最右侧，卡牌数字变为 $2,1,3$。  \n将第二张卡牌（$1$）放到最左侧，卡牌数字变为 $1,2,3$。\n\n此时卡牌上的数字不降，操作结束。\n\n### 得分计算方式\n\n在一个测试数据中，是否有解判断正确可获得 $20\\%$ 的分数。如果操作方案也正确，则会跟据操作方案的行数（不包含最后一行的 `o`）按下表得分。\n\n| 行数 | 得分 |\n| :-----------: | :-----------: |\n| $>7n$ | $40\\%$ |\n| $\\le7n$ | $60\\%$ |\n| $\\le5n$ | $80\\%$ |\n| $\\le3n$ | $100\\%$ |\n\n一个测试点的得分是其中每组测试数据得分的最小值。\n\n### 注意事项\n\n为了方便选手调试，本题下发了校验器用于本地自测校验得分，使用方法见后。需要注意下发的校验器与实际使用校验器的可能并不相同。我们保证实际使用的校验器在输出的操作序列行数不超过 $7n$ 的情况下用时不超过 500ms。\n\n如果输出格式有误，你将会获得 $0$ 分。因此，如果你会判断是否有解但无法给出操作方案，也需要在判断有解后输出一行 `o` 表示操作结束。\n\n为了避免无意义的反复操作，你需要保证每一次操作均有 $1\\leq c \\leq n$，否则将会获得 $0$ 分。\n\n### 校验器使用方法\n\n下载文件 `testlib.h` 与 `checker.cpp` 并将其置于同一文件夹。在该目录下运行命令 `g++ checker.cpp -o checker -std=c++14` 编译得到可执行文件 `checker.exe` (windows) / `checker` (linux)。\n\n假如自测输入为 `in.txt`，程序输出为 `out.txt`。由于校验器无法判断是否有解，你需要创建一个答案文件（假如叫作 `ans.txt`），并在其中每行一个地写入每组数据的有解情况。例如对于样例，答案文件应为\n\n```plain\nYes\nNo\nNo\nYes\nYes\n```\n\n将上述提到的输入、输出、答案三个文件与刚刚编译出来的校验器可执行文件置与同一文件夹。\n\n- 如果是 Windows Powershell，输入 `.\\checker.exe in.txt out.txt ans.txt`。\n\n- 如果是 Linux 终端，输入 `./checker in.txt out.txt ans.txt`。\n\n校验器有三种可能的输出：`wrong answer` / `ok` / `points x`，分别表示对于该测试点你没有分 / 满分 / 获得了占比为 `x` 的分。\n\n### 数据规模与约定\n\n**本题采用捆绑测试并开启所有合理的子任务依赖**\n\n对于 $100\\%$ 的数据，$1\\le T\\le10^5$，$1\\le k\\le n\\le 2\\times10^5$，$\\sum n\\le5\\times10^{5}$，$1\\le a_i\\le 10^9$。\n\n对于不同的子任务，作如下约定：\n\n| 子任务编号\t| $n$ | $k$ | 子任务分值 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $=5$ | $\\in[1,n]$ | $10$ |\n| $2$ | $\\le200$ | $\\in[1,n]$ | $40$ |\n| $3$ | $\\le2\\times10^5$ | $=2$ | $20$ |\n| $4$ | $\\le2\\times10^5$ | $\\in[1,n]$ | $30$ |", "locale": "zh-CN"}}}
{"pid": "P11774", "type": "P", "difficulty": 5, "samples": [["4 3 \n4 \n2 2 5 5 \n8 2 11 5 \n1 7 4 10 \n7 7 10 10", "3"], ["7 4 \n6 \n5 1 8 2 \n2 2 4 7 \n5 3 8 6 \n9 2 11 7 \n5 8 6 9 \n7 8 8 9", "5"], ["3 3 \n3 \n1 1 5 5 \n5 1 9 5 \n8 5 10 10", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2013", "COTS（克罗地亚）"], "title": "[COTS 2013] 矩形覆盖 / BAKTERIJE", "background": "", "description": "在平面直角坐标系上有 $N$ 个边与坐标轴平行，且互不重叠的矩形，给定它们的左下角坐标 $(x_1,y_1)$ 和右上角坐标 $(x_2,y_2)$。\n\n你现在有一个长为 $W$，宽为 $H$ 的矩形 $S$，你需要选择一个位置放置这个矩形，使得原坐标系上的矩形和 $S$ 有交的矩形的数量尽可能多。\n\n注意：\n\n- 矩形 $S$ 顶点不必放置在整数坐标上（见样例 $1$ 图片）。\n- 有交指两个矩形重叠位置的面积 $>0$。", "inputFormat": "第一行两个整数 $W,H$，表示 $S$ 的长宽。\n\n第二行一个整数 $N$，表示矩形数量。\n\n以下 $N$ 行，每行四个整数 $x_1,y_1,x_2,y_2$，表示每个矩形的左下角和右上角坐标。", "outputFormat": "一行一个整数，即和 $S$ 有交的矩形的最多的数量。", "hint": "【样例解释】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/f9olyi3c.png)\n\n【数据范围与约定】\n\n- 对于 $30 \\%$ 的数据，满足 $N\\le 30$。\n\n- 对于 $60 \\%$ 的数据，满足 $N\\le 1000$。\n\n- 对于 $100 \\%$ 的数据，满足 $1 \\le N \\le 100000,1\\le W,H \\le 50000,0 \\le x_1<x_2 \\le 50000,0 \\le y_1<y_2 \\le 50000$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COTS 2013] 矩形覆盖 / BAKTERIJE", "background": "", "description": "在平面直角坐标系上有 $N$ 个边与坐标轴平行，且互不重叠的矩形，给定它们的左下角坐标 $(x_1,y_1)$ 和右上角坐标 $(x_2,y_2)$。\n\n你现在有一个长为 $W$，宽为 $H$ 的矩形 $S$，你需要选择一个位置放置这个矩形，使得原坐标系上的矩形和 $S$ 有交的矩形的数量尽可能多。\n\n注意：\n\n- 矩形 $S$ 顶点不必放置在整数坐标上（见样例 $1$ 图片）。\n- 有交指两个矩形重叠位置的面积 $>0$。", "inputFormat": "第一行两个整数 $W,H$，表示 $S$ 的长宽。\n\n第二行一个整数 $N$，表示矩形数量。\n\n以下 $N$ 行，每行四个整数 $x_1,y_1,x_2,y_2$，表示每个矩形的左下角和右上角坐标。", "outputFormat": "一行一个整数，即和 $S$ 有交的矩形的最多的数量。", "hint": "【样例解释】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/f9olyi3c.png)\n\n【数据范围与约定】\n\n- 对于 $30 \\%$ 的数据，满足 $N\\le 30$。\n\n- 对于 $60 \\%$ 的数据，满足 $N\\le 1000$。\n\n- 对于 $100 \\%$ 的数据，满足 $1 \\le N \\le 100000,1\\le W,H \\le 50000,0 \\le x_1<x_2 \\le 50000,0 \\le y_1<y_2 \\le 50000$。", "locale": "zh-CN"}}}
{"pid": "P11775", "type": "P", "difficulty": 6, "samples": [["2", "jutro \n1 2 \nkraj"], ["3", "jutro \n1 2 \njutro \n1 3 \njutro \n2 3 \nkraj"], ["4", "jutro \n1 2 \n3 4 \njutro \n1 3 \n2 4 \nkraj"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2013", "Special Judge", "COTS（克罗地亚）"], "title": "[COTS 2013] 集合合并 / RAZGOVORI", "background": "", "description": "给定 $n$ 个集合，第 $i$ 个集合内开始只有元素 $i$。\n\n你每天可以进行任意次这样的操作：\n\n- 选择两个集合 $A,B$，令 $C=A \\cup B$，让 $A\n\\gets C,B\\gets C$。对于一个集合，你每天只能选择一次。\n\n你需要求出最小的天数，使得操作完后每个集合都为 $\\{1,2,3,\\dots,n\\}$。", "inputFormat": "一行一个整数 $n$。", "outputFormat": "若干行。对于每一天的开始，都要输出 `jutro`，然后输出若干行，每行两个整数，表示选择的两个集合。\n\n在完成全部操作后，需要在最后打印 `kraj`。", "hint": "首先，天数不能超过 $500$ 天。对于一个测试点，如果你的方案的天数和答案相同且合法，则获得满分的 $10\\%$。\n\n否则如果方案合法，且最终每个集合均为 $\\{1,2,3,\\dots,n\\}$，记你实现的天数为 $ans$，答案天数为 $ans1$，你该测试点得分为：\n\n$$\\max(1,9-2\\times (ans-ans1))$$\n\n\n对于 $100 \\%$ 的数据，满足 $1\\le n \\le 1000$。\n\n共 $10$ 个测试点。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COTS 2013] 集合合并 / RAZGOVORI", "background": "", "description": "给定 $n$ 个集合，第 $i$ 个集合内开始只有元素 $i$。\n\n你每天可以进行任意次这样的操作：\n\n- 选择两个集合 $A,B$，令 $C=A \\cup B$，让 $A\n\\gets C,B\\gets C$。对于一个集合，你每天只能选择一次。\n\n你需要求出最小的天数，使得操作完后每个集合都为 $\\{1,2,3,\\dots,n\\}$。", "inputFormat": "一行一个整数 $n$。", "outputFormat": "若干行。对于每一天的开始，都要输出 `jutro`，然后输出若干行，每行两个整数，表示选择的两个集合。\n\n在完成全部操作后，需要在最后打印 `kraj`。", "hint": "首先，天数不能超过 $500$ 天。对于一个测试点，如果你的方案的天数和答案相同且合法，则获得满分的 $10\\%$。\n\n否则如果方案合法，且最终每个集合均为 $\\{1,2,3,\\dots,n\\}$，记你实现的天数为 $ans$，答案天数为 $ans1$，你该测试点得分为：\n\n$$\\max(1,9-2\\times (ans-ans1))$$\n\n\n对于 $100 \\%$ 的数据，满足 $1\\le n \\le 1000$。\n\n共 $10$ 个测试点。", "locale": "zh-CN"}}}
{"pid": "P11776", "type": "P", "difficulty": 6, "samples": [["2 2 ", "13"], ["3 2", "40"], ["3 3 ", "213 "]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2013", "COTS（克罗地亚）"], "title": "[COTS 2013] 图形计数 / POLIGONI", "background": "", "description": "枚举平面直角坐标系具有下列性质的多边形：\n\n- 多边形顶点为坐标系整数点。\n- 多边形每条边平行于坐标轴。\n- 对于顶点 $(x,y)$，满足 $0 \\le x \\le N,0\\le y\\le K$。\n\n形状相同，位置不同的两个多边形我们认为是不同的，且根据定义，多边形的边是一条不接触自身的闭合多边形线。\n\n下图显示了一个合法的多边形：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/at50ulf8.png)\n\n下图显示了两个不合法的多边形：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/snvgig3p.png)", "inputFormat": "一行两个整数 $K,N$。", "outputFormat": "一行一个整数，为多边形的数量，答案对 $10007$ 取模。", "hint": "【数据范围与约定】\n\n- 对于所有数据，均满足 $1\\le K \\le 6,1 \\le N \\le 1000$。\n\n| 测试点编号 | $K=$ | $N\\le$ | 特殊性质 | 分值 |\n| -----------: | -----------: | -----------: | -----------: | -----------: |\n| $1$ | $1$ | $1000$ | 是 | $5$  |\n| $2$ | $1$ | $1000$ | 否 | $5$ |\n| $3$ | $2$ | $1000$ | 是 | $5$ |\n| $4$ | $2$ |$1000$  | 否 | $5$  |\n| $5$ | $3$ | $1000$ | 是 | $10$ |\n| $6$ | $3$ |$1000$  | 否 |$10$  |\n| $7$ | $4$ |$1000$  | 是 | $10$ |\n| $8$ | $4$ | $1000$ | 否 | $10$ |\n| $9,10$ | $5$ | $1000$ | 否 |$10$  |\n| $11,12$ | $6$ |$1000$  | 否  |$10$  |\n\n- 特殊性质： $N\\times K \\le 20$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COTS 2013] 图形计数 / POLIGONI", "background": "", "description": "枚举平面直角坐标系具有下列性质的多边形：\n\n- 多边形顶点为坐标系整数点。\n- 多边形每条边平行于坐标轴。\n- 对于顶点 $(x,y)$，满足 $0 \\le x \\le N,0\\le y\\le K$。\n\n形状相同，位置不同的两个多边形我们认为是不同的，且根据定义，多边形的边是一条不接触自身的闭合多边形线。\n\n下图显示了一个合法的多边形：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/at50ulf8.png)\n\n下图显示了两个不合法的多边形：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/snvgig3p.png)", "inputFormat": "一行两个整数 $K,N$。", "outputFormat": "一行一个整数，为多边形的数量，答案对 $10007$ 取模。", "hint": "【数据范围与约定】\n\n- 对于所有数据，均满足 $1\\le K \\le 6,1 \\le N \\le 1000$。\n\n| 测试点编号 | $K=$ | $N\\le$ | 特殊性质 | 分值 |\n| -----------: | -----------: | -----------: | -----------: | -----------: |\n| $1$ | $1$ | $1000$ | 是 | $5$  |\n| $2$ | $1$ | $1000$ | 否 | $5$ |\n| $3$ | $2$ | $1000$ | 是 | $5$ |\n| $4$ | $2$ |$1000$  | 否 | $5$  |\n| $5$ | $3$ | $1000$ | 是 | $10$ |\n| $6$ | $3$ |$1000$  | 否 |$10$  |\n| $7$ | $4$ |$1000$  | 是 | $10$ |\n| $8$ | $4$ | $1000$ | 否 | $10$ |\n| $9,10$ | $5$ | $1000$ | 否 |$10$  |\n| $11,12$ | $6$ |$1000$  | 否  |$10$  |\n\n- 特殊性质： $N\\times K \\le 20$。", "locale": "zh-CN"}}}
{"pid": "P11777", "type": "P", "difficulty": 4, "samples": [["3 \n1 \n2 1 2", "3"], ["10 \n2 \n6 3 4 5 6 7 8 \n2 5 6", "7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2013", "COTS（克罗地亚）"], "title": "[COTS 2013]  集合求解 / BOMBONI", "background": "", "description": "存在若干个集合（集合数量未知，不存在空集），给定 $n$，每个集合中元素 $x$ 满足 $1 \\le x \\le n$，你现在已知 $M$ 个集合内的元素情况。\n\n定义全集 $U=\\{1,2,\\dots ,n\\}$，这若干个集合间满足两个性质：\n\n- 若集合 $A$ 存在，那么 $\\complement_UA$ 也存在。\n- 对于当前的两个集合 $A,B$，集合 $C=A \\cup B$ 也存在。\n\n希望你求出最小的集合数量，把它对 $10^9+9$ 取模的结果。", "inputFormat": "第一行一个整数 $n$。\n\n第二行一个整数 $M$，表示已知的集合数量。\n\n以下 $M$ 行，一行一个整数 $B$，表示当前集合元素数量，随后是 $B$ 个数字，表示集合元素。", "outputFormat": "一行一个整数，即最小集合数量对 $10^9+9$ 取模的结果。", "hint": "【样例解释】\n\n- 对于第一个样例，集合为 $\\{1,2\\},\\{3\\},\\{1,2,3\\}$。\n\n- 对于第二个样例，另外的 $5$ 个集合为 $\\{1, 2, 9, 10\\},\\{1,2,3,4,7,8,9,10\\},\\{1,2,3,4,5,6,7,8,9,10\\},\\{3,4,7,8\\},\\{1,2,5,6,9,10\\}$。\n\n【数据范围与约定】\n\n- 对于 $40\\%$ 的数据，满足 $n \\le 30$，答案不超过 $5000$。\n\n- 对于 $100 \\%$ 的数据，满足 $1\\le n \\le 2\\times 10^5,1\\le M \\le 50$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COTS 2013]  集合求解 / BOMBONI", "background": "", "description": "存在若干个集合（集合数量未知，不存在空集），给定 $n$，每个集合中元素 $x$ 满足 $1 \\le x \\le n$，你现在已知 $M$ 个集合内的元素情况。\n\n定义全集 $U=\\{1,2,\\dots ,n\\}$，这若干个集合间满足两个性质：\n\n- 若集合 $A$ 存在，那么 $\\complement_UA$ 也存在。\n- 对于当前的两个集合 $A,B$，集合 $C=A \\cup B$ 也存在。\n\n希望你求出最小的集合数量，把它对 $10^9+9$ 取模的结果。", "inputFormat": "第一行一个整数 $n$。\n\n第二行一个整数 $M$，表示已知的集合数量。\n\n以下 $M$ 行，一行一个整数 $B$，表示当前集合元素数量，随后是 $B$ 个数字，表示集合元素。", "outputFormat": "一行一个整数，即最小集合数量对 $10^9+9$ 取模的结果。", "hint": "【样例解释】\n\n- 对于第一个样例，集合为 $\\{1,2\\},\\{3\\},\\{1,2,3\\}$。\n\n- 对于第二个样例，另外的 $5$ 个集合为 $\\{1, 2, 9, 10\\},\\{1,2,3,4,7,8,9,10\\},\\{1,2,3,4,5,6,7,8,9,10\\},\\{3,4,7,8\\},\\{1,2,5,6,9,10\\}$。\n\n【数据范围与约定】\n\n- 对于 $40\\%$ 的数据，满足 $n \\le 30$，答案不超过 $5000$。\n\n- 对于 $100 \\%$ 的数据，满足 $1\\le n \\le 2\\times 10^5,1\\le M \\le 50$。", "locale": "zh-CN"}}}
{"pid": "P11779", "type": "P", "difficulty": 5, "samples": [], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2012", "交互题", "Special Judge", "COTS（克罗地亚）"], "title": "[COTS 2012]  宿舍移动 / BUKA", "background": "", "description": "**本题为交互题。**\n\n有一棵 $n$ 个节点的有根满二叉树，若 $n=1$ 则根度数为 $0$ 否则根度数为 $2$，每个点的编号未知。\n\n你每次可以询问两个点 $a,b$，交互库返回树上 $a$ 到 $b$ 的路径中离根最近的点的编号，你需要在 $5 \\times 10^4$ 次询问内求出每个点的父亲。特别地，根的父亲为根。\n\n### 交互方式\n\n这是一道 IO 交互题，你需要从标准输入输出中与交互库交互。\n\n首先，从标准输入中读取满二叉树点数 $n$。\n\n然后，你可以进行不超过 $5 \\times 10^4$ 次交互，形式为 `pitaj a b`，其中需要满足 $1 \\leq a, b \\leq n$，交互库返回树上 $a$ 到 $b$ 路径中到根最近的点的编号。在你确定答案后，首先输出 `kraj` 并换行，然后输出 $n$ 行，第 $i$ 行表示编号为 $i$ 的点在二叉树上的父亲。\n\n在每次询问后以及最终输出答案后，你需要刷新缓冲区。", "inputFormat": "见「交互方式」。", "outputFormat": "见「交互方式」。", "hint": "$1 \\leq n \\leq 10^4$，保证 $n = 2^k-1$，$k$ 为正整数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COTS 2012]  宿舍移动 / BUKA", "background": "", "description": "**本题为交互题。**\n\n有一棵 $n$ 个节点的有根满二叉树，若 $n=1$ 则根度数为 $0$ 否则根度数为 $2$，每个点的编号未知。\n\n你每次可以询问两个点 $a,b$，交互库返回树上 $a$ 到 $b$ 的路径中离根最近的点的编号，你需要在 $5 \\times 10^4$ 次询问内求出每个点的父亲。特别地，根的父亲为根。\n\n### 交互方式\n\n这是一道 IO 交互题，你需要从标准输入输出中与交互库交互。\n\n首先，从标准输入中读取满二叉树点数 $n$。\n\n然后，你可以进行不超过 $5 \\times 10^4$ 次交互，形式为 `pitaj a b`，其中需要满足 $1 \\leq a, b \\leq n$，交互库返回树上 $a$ 到 $b$ 路径中到根最近的点的编号。在你确定答案后，首先输出 `kraj` 并换行，然后输出 $n$ 行，第 $i$ 行表示编号为 $i$ 的点在二叉树上的父亲。\n\n在每次询问后以及最终输出答案后，你需要刷新缓冲区。", "inputFormat": "见「交互方式」。", "outputFormat": "见「交互方式」。", "hint": "$1 \\leq n \\leq 10^4$，保证 $n = 2^k-1$，$k$ 为正整数。", "locale": "zh-CN"}}}
{"pid": "P11780", "type": "P", "difficulty": 0, "samples": [["3 \n300 300 300 \n2 \n0 3 400 \n2 1 400 \n99", "700"], ["10 \n1 3 3 1 1 1 2 2 2 3 \n5 \n0 10 2 \n1 5 4 \n1 4 4 \n9 0 2 \n10 9 4 \n2 ", "15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2012", "COTS（克罗地亚）"], "title": "[COTS 2012] 卡车通行 / AUTOCESTA", "background": "", "description": "有一条长为 $L$ 公里的高速公路，开始的时候你有这里面 $0$ 公里的高速公路，公路按照 $1$ 公里进行划分，第 $i$ 公里购买的代价为 $X_i$。\n\n你有 $n$ 辆卡车，每个卡车都有一条路线，用三个参数 $A,B,C$ 表示，即车从距离起点 $A$ 公里进入，然后从距离起点 $B$ 公里的位置离开，如果路上只要经过了未购买的高速公路，你就要花费 $C$ 的代价。\n\n如果某公里的高速公路没有购买，那么这公里只能允许正方向和反方向不超过 $K$ 辆卡车通行。\n\n你希望购买公路的代价和为车子缴纳的代价和最小，求出这个值。", "inputFormat": "在第一行中，有一个整数 $L$，以公里为单位的高速公路长度。\n\n在下一行中，有 $L$ 个整数 $X_i$ 表高速公路每公里的购买价格。\n\n接下来的一行一个整数 $n$，表卡车数量。\n\n接下来 $n$ 行，每行三个整数 $a_i,b_i,c_i$，表示卡车的三个参数。\n\n接下来一行一个整数 $K$，表示限制卡车的通过数的数量。", "outputFormat": "一行一个整数，表示最小代价。", "hint": "【样例解释】\n\n关于第一个样例的解释：\n\n- 如果不购买任何公里的高速公路，代价为 $800$ （两条路线每条代价 $400$ ）。\n\n- 如果该买下整条高速公路，代价为 $900$。\n\n- 如果以 $300$ 代价从位置 $1$ 到位置 $2$ 购买了一公里的高速公路，那么它将只支付第一条路线的通行费，因此总代价为   $700$。\n\n\n【数据范围与约定】\n\n对于全部数据，有 $1\\le L,n \\le 10^5,0\\le X_i \\le 10^9,1\\le K \\le100,0  \\le a_i,b_i\\le L,a_i \\neq b_i,0\\le c_i \\le 10^6 $。\n\n- 对于 $50 \\%$ 的数据中，满足 $K = 1$ 。\n- 对于 $34 \\%$ 的数据中，满足 $n \\le 10$ 。\n- 对于 $68 \\%$ 的数据中，上述两个条件中的至少一个将适用。\n- 对于 $50 \\%$ 的数据中，满足 $L  \\le 1000$。\n- 对于 $66 \\%$ 的数据中，满足 $n \\le 1000$。\n- 对于其他的数据，无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COTS 2012] 卡车通行 / AUTOCESTA", "background": "", "description": "有一条长为 $L$ 公里的高速公路，开始的时候你有这里面 $0$ 公里的高速公路，公路按照 $1$ 公里进行划分，第 $i$ 公里购买的代价为 $X_i$。\n\n你有 $n$ 辆卡车，每个卡车都有一条路线，用三个参数 $A,B,C$ 表示，即车从距离起点 $A$ 公里进入，然后从距离起点 $B$ 公里的位置离开，如果路上只要经过了未购买的高速公路，你就要花费 $C$ 的代价。\n\n如果某公里的高速公路没有购买，那么这公里只能允许正方向和反方向不超过 $K$ 辆卡车通行。\n\n你希望购买公路的代价和为车子缴纳的代价和最小，求出这个值。", "inputFormat": "在第一行中，有一个整数 $L$，以公里为单位的高速公路长度。\n\n在下一行中，有 $L$ 个整数 $X_i$ 表高速公路每公里的购买价格。\n\n接下来的一行一个整数 $n$，表卡车数量。\n\n接下来 $n$ 行，每行三个整数 $a_i,b_i,c_i$，表示卡车的三个参数。\n\n接下来一行一个整数 $K$，表示限制卡车的通过数的数量。", "outputFormat": "一行一个整数，表示最小代价。", "hint": "【样例解释】\n\n关于第一个样例的解释：\n\n- 如果不购买任何公里的高速公路，代价为 $800$ （两条路线每条代价 $400$ ）。\n\n- 如果该买下整条高速公路，代价为 $900$。\n\n- 如果以 $300$ 代价从位置 $1$ 到位置 $2$ 购买了一公里的高速公路，那么它将只支付第一条路线的通行费，因此总代价为   $700$。\n\n\n【数据范围与约定】\n\n对于全部数据，有 $1\\le L,n \\le 10^5,0\\le X_i \\le 10^9,1\\le K \\le100,0  \\le a_i,b_i\\le L,a_i \\neq b_i,0\\le c_i \\le 10^6 $。\n\n- 对于 $50 \\%$ 的数据中，满足 $K = 1$ 。\n- 对于 $34 \\%$ 的数据中，满足 $n \\le 10$ 。\n- 对于 $68 \\%$ 的数据中，上述两个条件中的至少一个将适用。\n- 对于 $50 \\%$ 的数据中，满足 $L  \\le 1000$。\n- 对于 $66 \\%$ 的数据中，满足 $n \\le 1000$。\n- 对于其他的数据，无特殊限制。", "locale": "zh-CN"}}}
