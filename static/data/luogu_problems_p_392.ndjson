{"pid": "P8948", "type": "P", "difficulty": 3, "samples": [["4\n2000\n1319\n1476\n996", "233 525\n147 361\n200 324\n0 523"], ["4\n2000\n1704\n1658\n1542", "400 454\n352 374\n352 353\n320 337"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["洛谷原创", "Special Judge"], "title": "[YsOI2022] NOIp 和省选", "background": "Ysuperman 为了检验他的教学水平，决定给幼儿园的小朋友们来两场摸底考试！", "description": "其中一场考试有四道题目，满分 $400$；另一场考试有六道题目，满分 $600$。每个人每场考试得分都是一个 $0$ 到满分间的一个**非负整数**（可以为 $0$ 或者满分）。\n\n有 $n$ 名同学参加了这两场考试，其中第 $i$ 名同学第一场得分 $a_i$，第二场得分 $b_i$，Ysuperman 通过以下规则计算第 $i$ 名同学的**标准得分** $c_i$：\n\n1. 分别统计两场比赛的最高分 $A,B$，有 $A\\ne 0$，$B\\ne 0$。\n2. 令 $c_i=1000(\\frac{a_i}{A}+\\frac{b_i}{B})$，其中 $c_i$ **四舍五入保留到整数**。\n\n在算出了每位同学的标准得分后，Ysuperman 粗心地弄丢了每位同学的原始分，你能帮 TA 找到任意一组可能的原始分吗？\n\n简单来说，已知 $n$ 和每位同学的**标准得分** $c_{1\\sim n}$，Ysuperman 希望你找到一组合法的 $a_{1\\sim n}$，$b_{1\\sim n}$ 满足上述要求。\n\n特别的，有个十分强的小朋友 Qiu 在两场考试中都拿到了**最高分**，也就是保证 $c_1=2000$。另外其他小朋友水平都差不多，所以保证有 $\\forall i>1,c_i\\in [10,1990]$。", "inputFormat": "第一行一个正整数 $n$。\n\n接下来 $n$ 行，第 $i$ 行一个正整数 $c_i$。", "outputFormat": "输出共 $n$ 行，第 $i$ 行两个非负整数 $a_i,b_i$，由题意可知你需要保证 $a_i\\in [0,400]$，$b_i\\in [0,600]$ 并且 $\\max a_i>0$，$\\max b_i>0$。", "hint": "样例一中构造的 $a,b$ 合法，理由如下：\n\n两场比赛最高得分分别为 $233$ 和 $525$。\n\n$1000\\times (233\\div 233 + 525\\div 525)=2000$。\n\n$1000\\times (147\\div 233 + 361\\div 525) \\approx 1318.520\\approx 1319$。\n\n$1000\\times (200\\div 233 + 324\\div 525)\\approx 1475.512\\approx 1476$。\n\n$1000\\times (0\\div 233 + 523\\div 525)\\approx 996.190\\approx 996$。\n\n前 $20\\%$ 的数据保证 $n\\le 20$。\n\n另外 $20\\%$ 的数据保证 $c_i$ 是 $10$ 的倍数。\n\n另外 $20\\%$ 的数据保证 $c_i$ 是 $5$ 的倍数。\n\n另外 $20\\%$ 的数据保证 $c_i$ 是 $2$ 的倍数。\n\n对于 $100\\%$ 的数据，满足 $1\\le n\\le 10^4$，$c_1=2000$，$\\forall i>1,c_i\\in[10,1990]$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[YsOI2022] NOIp 和省选", "background": "Ysuperman 为了检验他的教学水平，决定给幼儿园的小朋友们来两场摸底考试！", "description": "其中一场考试有四道题目，满分 $400$；另一场考试有六道题目，满分 $600$。每个人每场考试得分都是一个 $0$ 到满分间的一个**非负整数**（可以为 $0$ 或者满分）。\n\n有 $n$ 名同学参加了这两场考试，其中第 $i$ 名同学第一场得分 $a_i$，第二场得分 $b_i$，Ysuperman 通过以下规则计算第 $i$ 名同学的**标准得分** $c_i$：\n\n1. 分别统计两场比赛的最高分 $A,B$，有 $A\\ne 0$，$B\\ne 0$。\n2. 令 $c_i=1000(\\frac{a_i}{A}+\\frac{b_i}{B})$，其中 $c_i$ **四舍五入保留到整数**。\n\n在算出了每位同学的标准得分后，Ysuperman 粗心地弄丢了每位同学的原始分，你能帮 TA 找到任意一组可能的原始分吗？\n\n简单来说，已知 $n$ 和每位同学的**标准得分** $c_{1\\sim n}$，Ysuperman 希望你找到一组合法的 $a_{1\\sim n}$，$b_{1\\sim n}$ 满足上述要求。\n\n特别的，有个十分强的小朋友 Qiu 在两场考试中都拿到了**最高分**，也就是保证 $c_1=2000$。另外其他小朋友水平都差不多，所以保证有 $\\forall i>1,c_i\\in [10,1990]$。", "inputFormat": "第一行一个正整数 $n$。\n\n接下来 $n$ 行，第 $i$ 行一个正整数 $c_i$。", "outputFormat": "输出共 $n$ 行，第 $i$ 行两个非负整数 $a_i,b_i$，由题意可知你需要保证 $a_i\\in [0,400]$，$b_i\\in [0,600]$ 并且 $\\max a_i>0$，$\\max b_i>0$。", "hint": "样例一中构造的 $a,b$ 合法，理由如下：\n\n两场比赛最高得分分别为 $233$ 和 $525$。\n\n$1000\\times (233\\div 233 + 525\\div 525)=2000$。\n\n$1000\\times (147\\div 233 + 361\\div 525) \\approx 1318.520\\approx 1319$。\n\n$1000\\times (200\\div 233 + 324\\div 525)\\approx 1475.512\\approx 1476$。\n\n$1000\\times (0\\div 233 + 523\\div 525)\\approx 996.190\\approx 996$。\n\n前 $20\\%$ 的数据保证 $n\\le 20$。\n\n另外 $20\\%$ 的数据保证 $c_i$ 是 $10$ 的倍数。\n\n另外 $20\\%$ 的数据保证 $c_i$ 是 $5$ 的倍数。\n\n另外 $20\\%$ 的数据保证 $c_i$ 是 $2$ 的倍数。\n\n对于 $100\\%$ 的数据，满足 $1\\le n\\le 10^4$，$c_1=2000$，$\\forall i>1,c_i\\in[10,1990]$。", "locale": "zh-CN"}}}
{"pid": "P8949", "type": "P", "difficulty": 7, "samples": [["5 3\n1 2\n1 3\n3 4\n3 5\n3 2\n3 4\n3 5\n1 2", "1\n2 3 0 3 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["点分治", "洛谷原创", "Special Judge", "构造"], "title": "[YsOI2022] 淀粉树", "background": "Ysuperman 教大家淀粉质和淀粉树。", "description": "Ysuperman 定义一棵**有根树** $S$ 是树 $T$ 的一棵淀粉树当且仅当 $S$ 满足如下两个条件（记 $s_i$ 表示 $S$ 中以 $i$ 为根的子树中所有点构成的点集）：\n\n1. $S$ 与 $T$ 点数相同（不妨设为 $n$）且编号为 $1\\sim n$。\n1. 对于 $S$ 中任意一个有儿子的点 $i$，对于其任意一个儿子 $j$，满足在 $T$ 中 $i$ 与 $s_j$ 中至少一个点有直接连边。\n\n容易发现一棵树 $T$ 的淀粉树可能有很多棵。\n\nYsuperman 现在给定 $n$ 以及两棵点编号 $1\\sim n$ 的树 $T$ 和树 $S$，设树 $S$ 中度数最大的点的度数为 $d$，TA 需要你进行至少一次且不超过 $d$ 次操作，每次操作把 $T$ 替换成它的任意一棵淀粉树，使得最终 $T$ 变成 $S$。\n\n请注意，这里给定的 $S$ 是没有给定根的，你只需要满足最后 $T$ 的连边情况和 $S$ 相同我们就认为 $T$ 变成了 $S$。\n\n输入保证存在至少一组解。", "inputFormat": "第一行两个数 $n,d$，保证 $d$ 等于 $S$ 中度数最大的点的度数。\n\n接下来 $n-1$ 行每行两个数 $u,v$ 表示 $T$ 中 $u,v$ 有连边。保证形成一棵树。\n\n接下来 $n-1$ 行每行两个数 $u,v$ 表示 $S$ 中 $u,v$ 有连边。保证形成一棵树。", "outputFormat": "为了方便检验，Ysuperman 需要你按照有根树的形式输出答案。\n\n答案第一行一个正整数 $k(1\\le k\\le d)$ 表示你进行的操作数。\n\n接下来 $k$ 行第 $i$ 行 $n$ 个整数表示你进行第 $i$ 次操作后 $T$ 变成的有根树中 $1\\sim n$ 各个点的父亲编号，根的父亲编号规定为 $0$，**请保证你输出树的根是淀粉树的根**。", "hint": "#### 样例 1 解释\n\n这是 $T$：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5qlv4q4t.png)\n\n这是 $S$：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xoyaon7y.png)\n\n该输出仅对 $T$ 进行了一次操作，即将 $T$ 变成了下面这棵有根树：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0kozi468.png)\n\n这棵有根树是 $T$ 的一棵淀粉树，理由如下：\n\n1. 对于 $2$ 的儿子 $1$，在 $T$ 中 $2$ 与 $s_1=\\{1\\}$ 中的 $1$ 有直接连边。\n2. 对于 $3$ 的儿子 $2$，在 $T$ 中 $3$ 与 $s_2=\\{1,2\\}$ 中的 $1$ 有直接连边。\n3. 对于 $3$ 的儿子 $4$，在 $T$ 中 $3$ 与 $s_4=\\{4\\}$ 中的 $4$ 有直接连边。\n4. 对于 $3$ 的儿子 $5$，在 $T$ 中 $3$ 与 $s_5=\\{5\\}$ 中的 $5$ 有直接连边。\n\n最终得到的有根树和 $S$ 的连边情况相同，所以这份输出将被判定为正确。\n\n#### 数据范围\n\n子任务 $1$（$20$ 分），满足 $n\\le 6$。\n\n子任务 $2$（$20$ 分），满足 $d=2$。\n\n子任务 $3$（$20$ 分），满足 $T$ 可以只进行一次操作即可变成 $S$ 且 $n\\le 447$。\n\n子任务 $4$（$20$ 分），满足 $n\\le 2000$。\n\n子任务 $5$（$20$ 分），无特殊限制。\n\n对于所有数据，满足 $2\\le n\\le 10^5$，$d\\times n\\le 2\\times 10^5$。\n\n#### 提示\n\n附件下发了本题 checker。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[YsOI2022] 淀粉树", "background": "Ysuperman 教大家淀粉质和淀粉树。", "description": "Ysuperman 定义一棵**有根树** $S$ 是树 $T$ 的一棵淀粉树当且仅当 $S$ 满足如下两个条件（记 $s_i$ 表示 $S$ 中以 $i$ 为根的子树中所有点构成的点集）：\n\n1. $S$ 与 $T$ 点数相同（不妨设为 $n$）且编号为 $1\\sim n$。\n1. 对于 $S$ 中任意一个有儿子的点 $i$，对于其任意一个儿子 $j$，满足在 $T$ 中 $i$ 与 $s_j$ 中至少一个点有直接连边。\n\n容易发现一棵树 $T$ 的淀粉树可能有很多棵。\n\nYsuperman 现在给定 $n$ 以及两棵点编号 $1\\sim n$ 的树 $T$ 和树 $S$，设树 $S$ 中度数最大的点的度数为 $d$，TA 需要你进行至少一次且不超过 $d$ 次操作，每次操作把 $T$ 替换成它的任意一棵淀粉树，使得最终 $T$ 变成 $S$。\n\n请注意，这里给定的 $S$ 是没有给定根的，你只需要满足最后 $T$ 的连边情况和 $S$ 相同我们就认为 $T$ 变成了 $S$。\n\n输入保证存在至少一组解。", "inputFormat": "第一行两个数 $n,d$，保证 $d$ 等于 $S$ 中度数最大的点的度数。\n\n接下来 $n-1$ 行每行两个数 $u,v$ 表示 $T$ 中 $u,v$ 有连边。保证形成一棵树。\n\n接下来 $n-1$ 行每行两个数 $u,v$ 表示 $S$ 中 $u,v$ 有连边。保证形成一棵树。", "outputFormat": "为了方便检验，Ysuperman 需要你按照有根树的形式输出答案。\n\n答案第一行一个正整数 $k(1\\le k\\le d)$ 表示你进行的操作数。\n\n接下来 $k$ 行第 $i$ 行 $n$ 个整数表示你进行第 $i$ 次操作后 $T$ 变成的有根树中 $1\\sim n$ 各个点的父亲编号，根的父亲编号规定为 $0$，**请保证你输出树的根是淀粉树的根**。", "hint": "#### 样例 1 解释\n\n这是 $T$：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5qlv4q4t.png)\n\n这是 $S$：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xoyaon7y.png)\n\n该输出仅对 $T$ 进行了一次操作，即将 $T$ 变成了下面这棵有根树：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0kozi468.png)\n\n这棵有根树是 $T$ 的一棵淀粉树，理由如下：\n\n1. 对于 $2$ 的儿子 $1$，在 $T$ 中 $2$ 与 $s_1=\\{1\\}$ 中的 $1$ 有直接连边。\n2. 对于 $3$ 的儿子 $2$，在 $T$ 中 $3$ 与 $s_2=\\{1,2\\}$ 中的 $1$ 有直接连边。\n3. 对于 $3$ 的儿子 $4$，在 $T$ 中 $3$ 与 $s_4=\\{4\\}$ 中的 $4$ 有直接连边。\n4. 对于 $3$ 的儿子 $5$，在 $T$ 中 $3$ 与 $s_5=\\{5\\}$ 中的 $5$ 有直接连边。\n\n最终得到的有根树和 $S$ 的连边情况相同，所以这份输出将被判定为正确。\n\n#### 数据范围\n\n子任务 $1$（$20$ 分），满足 $n\\le 6$。\n\n子任务 $2$（$20$ 分），满足 $d=2$。\n\n子任务 $3$（$20$ 分），满足 $T$ 可以只进行一次操作即可变成 $S$ 且 $n\\le 447$。\n\n子任务 $4$（$20$ 分），满足 $n\\le 2000$。\n\n子任务 $5$（$20$ 分），无特殊限制。\n\n对于所有数据，满足 $2\\le n\\le 10^5$，$d\\times n\\le 2\\times 10^5$。\n\n#### 提示\n\n附件下发了本题 checker。", "locale": "zh-CN"}}}
{"pid": "P8950", "type": "P", "difficulty": 6, "samples": [["3 4 1\n1 2 1\n2 1 2\n2 3 3\n3 1 4", "5"], ["4 6 2\n1 2 1\n1 3 3\n2 3 2\n3 4 5\n4 1 4\n4 2 6", "6"], ["8 16 3\n5 6 7\n7 2 10\n4 6 4\n5 7 5\n8 4 12\n1 3 8\n2 3 6\n4 1 8\n1 7 2\n8 3 1\n2 5 3\n6 4 11\n7 3 14\n3 8 9\n8 1 13\n6 7 16", "160432162"], ["4 1 3\n2 4 1", "-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["堆", "洛谷原创", "生成树", "可并堆"], "title": "[YsOI2022] 道路修建", "background": "Ysuperman 正在给他幼儿园里的小朋友们准备一场模板测试，下面是一道模板题，他希望你可以帮他验一下题目。", "description": "某地新建了 $n$ 座城市，拟定建造 $m$ 条**单向**道路，其中第 $i$ 条道路起点为 $u_i$，终点为 $v_i$，建造费用为正整数 $w_i$。\n\n然而在道路开始修建之前突发紧急情况，需要马上选择这些道路中的一些来修建使得所有城市的人都可以走到某 $k$ 座城市中（也就是说，所有城市的人都可以走到这 $k$ 座城市中的**至少一座**城市中），你想要知道，如果这 $k$ 座城市是等概率随机在 $n$ 座城市中的选定的，那么期望的最小修建费用是多少。\n\n为了避免分数输入输出，你只需要输出答案对 $998244353$ 取模的结果。", "inputFormat": "第一行三个非负整数 $n,m,k$ 表示城市数量、拟定建造公路数量以及待选定的城市数量。\n\n接下来 $m$ 行，每行三个正整数 $u_i,v_i,w_i$ 描述一条拟定建造的单向公路。", "outputFormat": "特别的，如果存在一种选定 $k$ 座城市的方式使得无论如何修建道路都总存在某座城市无法到达这 $k$ 座城市中的任意一座，请输出 `-1`。\n\n否则输出一行一个整数表示答案对 $998244353$ 取模的结果。", "hint": "#### 样例 1 解释\n\n总共有三种选定集合城市的方案：\n\n1. 选定集合在城市 $1$，那么选择建造 $2\\to 1,3\\to 1$ 两条道路花费最少，为 $2+4=6$。\n\n2. 选定集合在城市 $2$，那么选择建造 $1\\to 2,3\\to 1$ 两条道路花费最少，为 $1+4=5$。\n\n3. 选定集合在城市 $3$，那么选择建造 $1\\to 2,2\\to 3$ 两条道路花费最少，为 $1+3=4$。\n\n所以期望最小花费为 $(6+5+4)/3=5$。\n\n#### 样例 2 解释\n\n有 $6$ 种选择集合城市的方法：\n\n1. 选城市 $1,2$，最小花费 $9$。\n\n2. 选城市 $1,3$，最小花费 $6$。\n\n3. 选城市 $1,4$，最小花费 $7$。\n\n4. 选城市 $2,3$，最小花费 $5$。\n\n5. 选城市 $2,4$，最小花费 $6$。\n\n6. 选城市 $3,4$，最小花费 $3$。\n\n所以期望最小花费为 $(9+6+7+5+6+3)\\div 6=6$。\n\n#### 样例 3 解释\n\n这里太小写不下，只配个图算了：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cdnuoook.png)\n\n#### 样例 4 解释\n\n当集合城市选在 $1,2,3$ 时，城市 $4$ 无论如何都无法达到 $1,2,3$ 中的任意一个，所以答案为 $-1$。\n\n#### 数据范围\n\n对于 $10\\%$ 的数据，满足 $n\\le 15$，$m\\le 30$。\n\n对于 $30\\%$ 的数据，满足 $n\\le 20$，$m\\le 50$。\n\n另有 $5\\%$ 的数据，满足所有 $w_i$ 相等。\n\n另有 $5\\%$ 的数据，满足 $k=n$。\n\n另有 $5\\%$ 的数据，满足 $k=n-1$。\n\n另有 $10\\%$ 的数据，满足 $m=n$。\n\n另有 $20\\%$ 的数据，满足 $k=1$。\n\n对于 $100\\%$ 的数据，满足 $2\\le n\\le 10^5$，$1\\le m\\le 2\\times 10^5$，$1\\le k\\le n$，$1\\le u_i,v_i\\le n$，$0\\le w_i\\le 998244352$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[YsOI2022] 道路修建", "background": "Ysuperman 正在给他幼儿园里的小朋友们准备一场模板测试，下面是一道模板题，他希望你可以帮他验一下题目。", "description": "某地新建了 $n$ 座城市，拟定建造 $m$ 条**单向**道路，其中第 $i$ 条道路起点为 $u_i$，终点为 $v_i$，建造费用为正整数 $w_i$。\n\n然而在道路开始修建之前突发紧急情况，需要马上选择这些道路中的一些来修建使得所有城市的人都可以走到某 $k$ 座城市中（也就是说，所有城市的人都可以走到这 $k$ 座城市中的**至少一座**城市中），你想要知道，如果这 $k$ 座城市是等概率随机在 $n$ 座城市中的选定的，那么期望的最小修建费用是多少。\n\n为了避免分数输入输出，你只需要输出答案对 $998244353$ 取模的结果。", "inputFormat": "第一行三个非负整数 $n,m,k$ 表示城市数量、拟定建造公路数量以及待选定的城市数量。\n\n接下来 $m$ 行，每行三个正整数 $u_i,v_i,w_i$ 描述一条拟定建造的单向公路。", "outputFormat": "特别的，如果存在一种选定 $k$ 座城市的方式使得无论如何修建道路都总存在某座城市无法到达这 $k$ 座城市中的任意一座，请输出 `-1`。\n\n否则输出一行一个整数表示答案对 $998244353$ 取模的结果。", "hint": "#### 样例 1 解释\n\n总共有三种选定集合城市的方案：\n\n1. 选定集合在城市 $1$，那么选择建造 $2\\to 1,3\\to 1$ 两条道路花费最少，为 $2+4=6$。\n\n2. 选定集合在城市 $2$，那么选择建造 $1\\to 2,3\\to 1$ 两条道路花费最少，为 $1+4=5$。\n\n3. 选定集合在城市 $3$，那么选择建造 $1\\to 2,2\\to 3$ 两条道路花费最少，为 $1+3=4$。\n\n所以期望最小花费为 $(6+5+4)/3=5$。\n\n#### 样例 2 解释\n\n有 $6$ 种选择集合城市的方法：\n\n1. 选城市 $1,2$，最小花费 $9$。\n\n2. 选城市 $1,3$，最小花费 $6$。\n\n3. 选城市 $1,4$，最小花费 $7$。\n\n4. 选城市 $2,3$，最小花费 $5$。\n\n5. 选城市 $2,4$，最小花费 $6$。\n\n6. 选城市 $3,4$，最小花费 $3$。\n\n所以期望最小花费为 $(9+6+7+5+6+3)\\div 6=6$。\n\n#### 样例 3 解释\n\n这里太小写不下，只配个图算了：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cdnuoook.png)\n\n#### 样例 4 解释\n\n当集合城市选在 $1,2,3$ 时，城市 $4$ 无论如何都无法达到 $1,2,3$ 中的任意一个，所以答案为 $-1$。\n\n#### 数据范围\n\n对于 $10\\%$ 的数据，满足 $n\\le 15$，$m\\le 30$。\n\n对于 $30\\%$ 的数据，满足 $n\\le 20$，$m\\le 50$。\n\n另有 $5\\%$ 的数据，满足所有 $w_i$ 相等。\n\n另有 $5\\%$ 的数据，满足 $k=n$。\n\n另有 $5\\%$ 的数据，满足 $k=n-1$。\n\n另有 $10\\%$ 的数据，满足 $m=n$。\n\n另有 $20\\%$ 的数据，满足 $k=1$。\n\n对于 $100\\%$ 的数据，满足 $2\\le n\\le 10^5$，$1\\le m\\le 2\\times 10^5$，$1\\le k\\le n$，$1\\le u_i,v_i\\le n$，$0\\le w_i\\le 998244352$。", "locale": "zh-CN"}}}
{"pid": "P8954", "type": "P", "difficulty": 5, "samples": [["30 6\n1 6\n1 4\n2 9\n1 3\n2 2\n1 16", "1\n4\n2\n2"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "并查集", "深度优先搜索 DFS"], "title": "「VUSC」Math Game", "background": "**upd 2023.1.22**：新增一组 Hack 数据 by @[MCRS_lizi](https://www.luogu.com.cn/user/585805)。\n\n远在哞利坚的 Bessie 也要在新春之际走亲访友！为了打发时间，她常和 Farmer John 玩一个有趣的数字游戏。", "description": "Farmer John 有一个集合 $S$，集合初始为 $\\{2,3,4,...,N\\}$。\n\n对于两个**在集合 $S$ 内的**正整数 $p,q$，我们称它们为「一对好数」当且仅当 $p^k=q(k\\ge 2\\land k\\in\\N)$。\n\n我们将每个 $S$ 中的数看成一张**无向图**中的节点，对于每一对「好数」，我们在这两个数间连一条无向边。\n\nFarmer John 会进行 $Q$ 次操作，操作有以下两种：\n\n1. 给出 $x$，询问结点 $x$ 所在的连通块大小。\n2. 给出 $x$，从 $S$ 中移除 $x$。**与此同时，无向图中的结点 $x$ 也被移除。**\n\n由于 Bessie 的速度太慢了，她想要你来帮忙。", "inputFormat": "第 $1$ 行 $2$ 个正整数，$N,Q$。\n\n接下来 $Q$ 行，每行一个正整数，$op_i,x_i$。\n其中，$op_i$ 表示操作的序号。\n\n**数据保证 $x_i$ 在集合 $S$ 中**。", "outputFormat": "对于操作 $1$，每行输出一个正整数，表示询问的答案。", "hint": "#### 【样例解释】\n\n这是原始无向图（上面一排都是孤点）：\n![](https://cdn.luogu.com.cn/upload/image_hosting/utsz04dt.png)\n\n这是进行第一次操作 $2$ 后的无向图（删除了结点 $9$）：\n![](https://cdn.luogu.com.cn/upload/image_hosting/wmexc9ks.png)\n\n这是进行第二次操作 $2$ 后的无向图（删除了结点 $2$）：\n![](https://cdn.luogu.com.cn/upload/image_hosting/9mi0l18p.png)\n\n---\n\n#### 【数据范围】\n\n全部数据满足：\n- $2\\le N \\le 10^{18}$\n- $1\\le Q \\le 10^6$\n- $x_i\\in S$\n- $op_i \\in \\{1,2\\}$\n\n测试点 $1\\sim2$ 另外满足 $2\\le N \\le 10^5$，$1\\le Q \\le 10^4$。\n\n测试点 $3\\sim4$ 另外满足所有 $x_i=m^{p_i}$，其中 $m$ 为一满足 $m\\ge 2 \\land m\\in \\N$ 的**常数**。\n\n测试点 $5\\sim10$ 没有额外限制。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「VUSC」Math Game", "background": "**upd 2023.1.22**：新增一组 Hack 数据 by @[MCRS_lizi](https://www.luogu.com.cn/user/585805)。\n\n远在哞利坚的 Bessie 也要在新春之际走亲访友！为了打发时间，她常和 Farmer John 玩一个有趣的数字游戏。", "description": "Farmer John 有一个集合 $S$，集合初始为 $\\{2,3,4,...,N\\}$。\n\n对于两个**在集合 $S$ 内的**正整数 $p,q$，我们称它们为「一对好数」当且仅当 $p^k=q(k\\ge 2\\land k\\in\\N)$。\n\n我们将每个 $S$ 中的数看成一张**无向图**中的节点，对于每一对「好数」，我们在这两个数间连一条无向边。\n\nFarmer John 会进行 $Q$ 次操作，操作有以下两种：\n\n1. 给出 $x$，询问结点 $x$ 所在的连通块大小。\n2. 给出 $x$，从 $S$ 中移除 $x$。**与此同时，无向图中的结点 $x$ 也被移除。**\n\n由于 Bessie 的速度太慢了，她想要你来帮忙。", "inputFormat": "第 $1$ 行 $2$ 个正整数，$N,Q$。\n\n接下来 $Q$ 行，每行一个正整数，$op_i,x_i$。\n其中，$op_i$ 表示操作的序号。\n\n**数据保证 $x_i$ 在集合 $S$ 中**。", "outputFormat": "对于操作 $1$，每行输出一个正整数，表示询问的答案。", "hint": "#### 【样例解释】\n\n这是原始无向图（上面一排都是孤点）：\n![](https://cdn.luogu.com.cn/upload/image_hosting/utsz04dt.png)\n\n这是进行第一次操作 $2$ 后的无向图（删除了结点 $9$）：\n![](https://cdn.luogu.com.cn/upload/image_hosting/wmexc9ks.png)\n\n这是进行第二次操作 $2$ 后的无向图（删除了结点 $2$）：\n![](https://cdn.luogu.com.cn/upload/image_hosting/9mi0l18p.png)\n\n---\n\n#### 【数据范围】\n\n全部数据满足：\n- $2\\le N \\le 10^{18}$\n- $1\\le Q \\le 10^6$\n- $x_i\\in S$\n- $op_i \\in \\{1,2\\}$\n\n测试点 $1\\sim2$ 另外满足 $2\\le N \\le 10^5$，$1\\le Q \\le 10^4$。\n\n测试点 $3\\sim4$ 另外满足所有 $x_i=m^{p_i}$，其中 $m$ 为一满足 $m\\ge 2 \\land m\\in \\N$ 的**常数**。\n\n测试点 $5\\sim10$ 没有额外限制。\n", "locale": "zh-CN"}}}
{"pid": "P8955", "type": "P", "difficulty": 5, "samples": [["5 7 10\n1 2 3 4 5\n1 1 1\n1 1 10\n2 5 4\n2 3 8\n5 5 2\n5 5 1\n5 5 16", "2 4 4 -1 7"], ["10 10 86\n26 27 33 1 21 31 9 22 17 14\n6 10 76\n5 8 85\n4 5 89\n3 9 87\n2 9 100\n7 10 83\n1 6 75\n1 4 66\n3 10 68\n3 4 72", "7 5 4 3 3 1 2 1 1 6"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400, 102400]}, "tags": ["线段树", "二分", "整体二分"], "title": "「VUSC」Card Tricks", "background": "**upd 2023.1.17 数据已加强。** \n\n**upd 2023.10.18 空间限制调整为 100 MiB。**\n\nBessie 正在玩一场卡牌游戏！\n\n这个游戏有一些~~神秘的~~规则。Bessie 需要用一些编程技巧，加快计算。", "description": "牌堆可以看成一个长度为 $N$ 的数列，下标为 $i$ 的位置值为 $a_i$。$(1\\le i\\le N)$\n\n有 $Q$ 次操作，每次操作给定 $l_i,r_i,v_i$，$\\forall l_i\\le j \\le r_i,a_j\\gets a_j \\lor v_i$。\n\n其中 $\\lor$ 表示按位或操作，即 C++ 中的 `|`。\n\n对于 $i=1,2,\\dots,N$，求出在哪一次操作后，$a_i$ **首次严格大于** $P$，其中 $P$ 为一给定常数。\n\n数据保证在初始情况下，$P\\ge\\max\\{a_i\\}$。", "inputFormat": "第一行三个整数 $N,Q,P$。\n\n第二行 $N$ 个整数，第 $i$ 个数为 $a_i$ 的初始值。\n\n接下来 $Q$ 行，每行三个整数，$l_i,r_i,v_i$。", "outputFormat": "输出 $N$ 个数 $id_1,id_2,\\dots,id_N$，第 $i$ 个数表示在第 $id_i$ 次操作后，$a_i$ 首次严格大于 $P$。\n\n**如果 $a_i$ 始终小于等于 $P$，请在这一位输出 $-1$。**", "hint": "#### 样例 #1 解释\n\n第一次操作后的数列为 $1,2,3,4,5$。\n\n第二次操作后的数列为 $11,2,3,4,5$。\n\n第三次操作后的数列为 $11,6,7,4,5$。\n\n……\n\n最终的数列为 $11,14,15,4,23$。\n\n---\n\n#### 数据范围\n全部数据满足：$1\\le N,Q \\le 10^6$，$1\\le l_i\\le r_i \\le N$，$1\\le a_i,v_i,P\\le 10^9$。\n\n测试点 $1\\sim2$ 另满足 $1\\le N,Q\\le 10^3$。\n\n测试点 $3$ 另满足 $l_i=r_i$。\n\n测试点 $4$ 另满足 $l_i=1,r_i=N$。\n\n测试点 $5\\sim10$ 无额外限制。\n\n**本题数据规模较大，请注意常数优化。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「VUSC」Card Tricks", "background": "**upd 2023.1.17 数据已加强。** \n\n**upd 2023.10.18 空间限制调整为 100 MiB。**\n\nBessie 正在玩一场卡牌游戏！\n\n这个游戏有一些~~神秘的~~规则。Bessie 需要用一些编程技巧，加快计算。", "description": "牌堆可以看成一个长度为 $N$ 的数列，下标为 $i$ 的位置值为 $a_i$。$(1\\le i\\le N)$\n\n有 $Q$ 次操作，每次操作给定 $l_i,r_i,v_i$，$\\forall l_i\\le j \\le r_i,a_j\\gets a_j \\lor v_i$。\n\n其中 $\\lor$ 表示按位或操作，即 C++ 中的 `|`。\n\n对于 $i=1,2,\\dots,N$，求出在哪一次操作后，$a_i$ **首次严格大于** $P$，其中 $P$ 为一给定常数。\n\n数据保证在初始情况下，$P\\ge\\max\\{a_i\\}$。", "inputFormat": "第一行三个整数 $N,Q,P$。\n\n第二行 $N$ 个整数，第 $i$ 个数为 $a_i$ 的初始值。\n\n接下来 $Q$ 行，每行三个整数，$l_i,r_i,v_i$。", "outputFormat": "输出 $N$ 个数 $id_1,id_2,\\dots,id_N$，第 $i$ 个数表示在第 $id_i$ 次操作后，$a_i$ 首次严格大于 $P$。\n\n**如果 $a_i$ 始终小于等于 $P$，请在这一位输出 $-1$。**", "hint": "#### 样例 #1 解释\n\n第一次操作后的数列为 $1,2,3,4,5$。\n\n第二次操作后的数列为 $11,2,3,4,5$。\n\n第三次操作后的数列为 $11,6,7,4,5$。\n\n……\n\n最终的数列为 $11,14,15,4,23$。\n\n---\n\n#### 数据范围\n全部数据满足：$1\\le N,Q \\le 10^6$，$1\\le l_i\\le r_i \\le N$，$1\\le a_i,v_i,P\\le 10^9$。\n\n测试点 $1\\sim2$ 另满足 $1\\le N,Q\\le 10^3$。\n\n测试点 $3$ 另满足 $l_i=r_i$。\n\n测试点 $4$ 另满足 $l_i=1,r_i=N$。\n\n测试点 $5\\sim10$ 无额外限制。\n\n**本题数据规模较大，请注意常数优化。**", "locale": "zh-CN"}}}
{"pid": "P8956", "type": "P", "difficulty": 3, "samples": [["4\n5 2 10 1 8\n11 4 5 1 4\n19 1 9 8 10\n114 51 4 1919 810", "998244317\n998242817\n939523984\n604148977"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["洛谷原创"], "title": "「CGOI-3」招魂术", "background": "墓园的骷髅海！\n\n要塞的禁魔球！\n\n塔楼的三后排！\n\n据点的破甲比蒙！\n\n地下城的满魔抗黑龙！\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/j0kff14j.png)\n\n###### 塔楼↑\n\n-----\n燊队来打英雄无敌 3 了。", "description": "招魂术是墓园阵营的核心法术。\n\n拥有招魂术的英雄，在每场战争结束后，能根据消灭的敌军数目来获得一定数量的骷髅。我们可以用整数 $A,B$ 来描述招魂术。设 $F_{A,B}(i)$ 表示消灭 $i$ 个敌人所能获得的骷髅数量，有：\n\n$$F_{A,B}(1)=A,F_{A,B}(2)=B,F_{A,B}(x)=\\lfloor \\sqrt{F_{A,B}(x-2)F_{A,B}(x-1)}\\rfloor+1\\;(x \\ge 3)$$\n\n现在燊队要在酒馆招募一个英雄，英雄甲招魂术的属性为 $A,B$，英雄乙招魂术的属性为 $X,Y$。为了比较两个英雄招魂术的强弱，请你计算以下式子的值：\n\n$$\\prod_{i=1}^nF_{X,Y}(i)-F_{A,B}(i)$$\n\n燊队当然知道怎么做，但他想考考你。", "inputFormat": "第一行一个整数 $T$，表示询问组数。\n\n接下来 $T$ 行，每行五个整数 $n,A,B,X,Y$。", "outputFormat": "输出为 $T$ 行，即每组询问答案对 $998244353$ 取模的结果。\n\n建议使用 `sqrtl` 和 `long double` 进行开平方。", "hint": "#### 样例说明\n\n在样例说明中，设 $F_{A,B}$ 为 $f$，$F_{X,Y}$ 为 $g$。\n\n对于第一组询问：\n\n- $f$ 的前 $n$ 位为 $f=\\{2,10,5,8,7\\}$。\n\n- $g$ 的前 $n$ 位为 $g=\\{1,8,3,5,4\\}$。\n\n所以最终的答案为 $(1-2)\\times(8-10)\\times(3-5)\\times(5-8)\\times(4-7)=-36$，对 $998244353$ 取模后的结果是 $998244317$。\n\n---\n\n#### 数据范围\n\n对于 $40\\%$ 的数据，$n \\le 100$。\n\n对于另外 $10\\%$ 的数据，每组询问满足 $A=B,X=Y$。\n\n对于另外 $10\\%$ 的数据，$T=1$。\n\n对于 $100\\%$ 的数据，$1 \\le A,B,X,Y,n \\le 10^9$，$1 \\le T \\le 5\\times 10^4$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「CGOI-3」招魂术", "background": "墓园的骷髅海！\n\n要塞的禁魔球！\n\n塔楼的三后排！\n\n据点的破甲比蒙！\n\n地下城的满魔抗黑龙！\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/j0kff14j.png)\n\n###### 塔楼↑\n\n-----\n燊队来打英雄无敌 3 了。", "description": "招魂术是墓园阵营的核心法术。\n\n拥有招魂术的英雄，在每场战争结束后，能根据消灭的敌军数目来获得一定数量的骷髅。我们可以用整数 $A,B$ 来描述招魂术。设 $F_{A,B}(i)$ 表示消灭 $i$ 个敌人所能获得的骷髅数量，有：\n\n$$F_{A,B}(1)=A,F_{A,B}(2)=B,F_{A,B}(x)=\\lfloor \\sqrt{F_{A,B}(x-2)F_{A,B}(x-1)}\\rfloor+1\\;(x \\ge 3)$$\n\n现在燊队要在酒馆招募一个英雄，英雄甲招魂术的属性为 $A,B$，英雄乙招魂术的属性为 $X,Y$。为了比较两个英雄招魂术的强弱，请你计算以下式子的值：\n\n$$\\prod_{i=1}^nF_{X,Y}(i)-F_{A,B}(i)$$\n\n燊队当然知道怎么做，但他想考考你。", "inputFormat": "第一行一个整数 $T$，表示询问组数。\n\n接下来 $T$ 行，每行五个整数 $n,A,B,X,Y$。", "outputFormat": "输出为 $T$ 行，即每组询问答案对 $998244353$ 取模的结果。\n\n建议使用 `sqrtl` 和 `long double` 进行开平方。", "hint": "#### 样例说明\n\n在样例说明中，设 $F_{A,B}$ 为 $f$，$F_{X,Y}$ 为 $g$。\n\n对于第一组询问：\n\n- $f$ 的前 $n$ 位为 $f=\\{2,10,5,8,7\\}$。\n\n- $g$ 的前 $n$ 位为 $g=\\{1,8,3,5,4\\}$。\n\n所以最终的答案为 $(1-2)\\times(8-10)\\times(3-5)\\times(5-8)\\times(4-7)=-36$，对 $998244353$ 取模后的结果是 $998244317$。\n\n---\n\n#### 数据范围\n\n对于 $40\\%$ 的数据，$n \\le 100$。\n\n对于另外 $10\\%$ 的数据，每组询问满足 $A=B,X=Y$。\n\n对于另外 $10\\%$ 的数据，$T=1$。\n\n对于 $100\\%$ 的数据，$1 \\le A,B,X,Y,n \\le 10^9$，$1 \\le T \\le 5\\times 10^4$。", "locale": "zh-CN"}}}
{"pid": "P8957", "type": "P", "difficulty": 4, "samples": [["3\n1 2 1\n3 2 3", "9\n1 2\n1 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "Special Judge", "O2优化", "构造", "Ad-hoc"], "title": "「CGOI-3」巫泡弹弹乐", "background": "mc 正在挑战弹弹乐。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yaye0cgu.png)", "description": "弹弹乐由 $n$ 个弹力菇组成，每个弹力菇有 $a,b$ 两个属性。\n\n对于弹力菇 $i$ 会向弹力菇 $j$ 连一条边权为 $\\max(a_i,a_j)+\\max(b_i,b_j)$ 的双向弹力通道。现在 mc 想知道弹力菇组成的图的最小生成树，以便他打破记录。", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n$ 个整数，第 $i$ 个数表示 $a_i$。\n\n第三行 $n$ 个整数，第 $i$ 个数表示 $b_i$。", "outputFormat": "第一行输出这个最小生成树的边权和。\n\n接下来 $n-1$ 行，每行输出两个整数表示一条树边。你可以输出任意一种合法方案。", "hint": "#### 数据范围\n\n**「本题采用捆绑测试」**\n\n$$\\def\\arraystretch{1.5}\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n} & \\textbf{特殊性质} & \\textbf{分值}\\cr\\hline\n1 & n\\le 500 & \\text{无} & 20 \\cr\\hline\n2 & n\\le 5\\times 10^4 & \\text{无} & 20\\cr\\hline\n3 & \\text{无特殊限制} & \\text{数据随机} & 20\\cr\\hline\n4 & \\text{无特殊限制} & \\text{无} & 40 \\cr\\hline\n\\end{array}$$\n\n- 对于 $100\\%$ 的数据，满足：$1\\le n\\le 10^6$，$1\\le a_i,b_i\\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「CGOI-3」巫泡弹弹乐", "background": "mc 正在挑战弹弹乐。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yaye0cgu.png)", "description": "弹弹乐由 $n$ 个弹力菇组成，每个弹力菇有 $a,b$ 两个属性。\n\n对于弹力菇 $i$ 会向弹力菇 $j$ 连一条边权为 $\\max(a_i,a_j)+\\max(b_i,b_j)$ 的双向弹力通道。现在 mc 想知道弹力菇组成的图的最小生成树，以便他打破记录。", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n$ 个整数，第 $i$ 个数表示 $a_i$。\n\n第三行 $n$ 个整数，第 $i$ 个数表示 $b_i$。", "outputFormat": "第一行输出这个最小生成树的边权和。\n\n接下来 $n-1$ 行，每行输出两个整数表示一条树边。你可以输出任意一种合法方案。", "hint": "#### 数据范围\n\n**「本题采用捆绑测试」**\n\n$$\\def\\arraystretch{1.5}\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n} & \\textbf{特殊性质} & \\textbf{分值}\\cr\\hline\n1 & n\\le 500 & \\text{无} & 20 \\cr\\hline\n2 & n\\le 5\\times 10^4 & \\text{无} & 20\\cr\\hline\n3 & \\text{无特殊限制} & \\text{数据随机} & 20\\cr\\hline\n4 & \\text{无特殊限制} & \\text{无} & 40 \\cr\\hline\n\\end{array}$$\n\n- 对于 $100\\%$ 的数据，满足：$1\\le n\\le 10^6$，$1\\le a_i,b_i\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P8958", "type": "P", "difficulty": 6, "samples": [["2\n114 514 1919 810", "2691692"], ["3\n1 1 4 5 1 4", "98"], ["8\n275272885 418731188 289662326 114331587 192436268 885936831 877490593 508774565 633402863 149033362 995239139 494498006 168828873 138947653 983144753 844326228", "349824160"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["洛谷原创", "O2优化", "Catalan 数", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "「CGOI-3」残暴圣所", "background": "终于打过春二心门的 ac 来到了春三，并决定预测一下残暴圣所（Ferocious Sanctuary）的难度。\n\n[![](https://cdn.luogu.com.cn/upload/image_hosting/xolrra48.png?x-oss-process=image/resize,m_lfit,h_340,w_450)](//www.bilibili.com/video/BV1Cg411v7Ji)", "description": "为了通关残暴圣所，ac 需要在接下来的 $2n$ 个时刻进行 $n$ 次操作。第 $i$ 次操作需要在时刻 $l_i$ 按下某个按键，此后一直按住这个按键，直到时刻 $r_i$ 松开它（$l_i<r_i$）。在每个时刻，ac 要么按下一个按键，要么松开一个按键，但是可以同时按住多个按键。\n\n第 $i$ 次操作形成了一个操作区间 $[l_i,r_i]$，满足 $l_i$ 严格递增。并且，由于残暴圣所的关卡设计，任意两个操作形成的操作区间之间，要么不交，要么包含。\n\nac 设计了 $2n$ 个难度系数 $a_1,a_2,\\dots,a_{2n}$。第 $i$ 次操作的难度可以用 $a_{l_i}\\times a_{r_i}$ 来评估，而通关残暴圣所的难度即为所有操作的难度之和。\n\n然而，由于 ac 卡在了残暴圣所的第一面，所以他并不知道每个操作的操作区间。在给定 $n$ 和 $\\{a\\}$ 的前提下，请你计算对于所有可能的情况，通关残暴圣所的难度之和，对 $998244353$ 取模。\n\n#### 形式化题意：\n\n给定一个长为 $2n$ 的数列 $a_1,a_2,\\dots,a_{2n}$。\n\n定义“区间组”由 $n$ 个区间组成，第 $i$ 个区间为 $[l_i,r_i]\\ (1\\le l_i<r_i\\le2n)$，求所有满足下列条件的区间组的 $\\sum_{i=1}^na_{l_i}\\times a_{r_i}$ 之和对 $998244353$ 取模：\n\n1. $l_1,r_1,l_2,r_2,\\dots,l_n,r_n$ 是 $1,2,\\dots,2n$ 的一个排列。\n2. $\\forall 1\\le i<n$，$l_i<l_{i+1}$。\n3. $\\forall i,j$，$[l_i,r_i]\\cap[l_j,r_j]=\\varnothing$ 或 $[l_i,r_i]\\sube[l_j,r_j]$ 或 $[l_j,r_j]\\sube[l_i,r_i]$。\n", "inputFormat": "第一行一个整数 $n$，表示区间数。\n\n第二行 $2n$ 个整数 $a_i$，含义如上所述。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模的值。", "hint": "#### 样例说明\n\n对于样例 1，可能的两个操作区间只有两种情况：\n\n1. $[1,2],[3,4]$，通关难度为 $a_1a_2+a_3a_4=1612986$。\n2. $[1,4],[2,3]$，通关难度为 $a_1a_4+a_2a_3=1078706$。\n\n难度之和为 $1612986+1078706=2691692$，对 $998244353$ 取模后仍为 $2691692$。\n\n以下几种情况是不合法的：\n\n1. $[3,4],[1,2]$，因为要求 $l_i$ 严格递增，而 $l_1\\ge l_2$。\n2. $[1,1],[2,4]$，因为要求 $l_i<r_i$，而 $l_1\\ge r_1$。\n3. $[1,3],[2,3]$，因为要求在每个时刻，要么按下一个按键，要么松开一个按键，而第三个时刻松开了两个按键，第四个时刻没有按下或松开任何一个按键。\n4. $[1,3],[2,4]$，因为要求任意两个操作区间不交或包含，而这两个区间之间有交，并且没有包含关系。\n\n---\n\n#### 数据范围\n\n对于 $10\\%$ 的数据，$n\\le15$。\n\n对于 $30\\%$ 的数据，$n\\le200$。\n\n对于 $50\\%$ 的数据，$n\\le3000$。\n\n对于另 $5\\%$ 的数据，$a_i=1$。\n\n对于 $100\\%$ 的数据，$1\\le n\\le5\\times10^5$，$0\\le a_i<998244353$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「CGOI-3」残暴圣所", "background": "终于打过春二心门的 ac 来到了春三，并决定预测一下残暴圣所（Ferocious Sanctuary）的难度。\n\n[![](https://cdn.luogu.com.cn/upload/image_hosting/xolrra48.png?x-oss-process=image/resize,m_lfit,h_340,w_450)](//www.bilibili.com/video/BV1Cg411v7Ji)", "description": "为了通关残暴圣所，ac 需要在接下来的 $2n$ 个时刻进行 $n$ 次操作。第 $i$ 次操作需要在时刻 $l_i$ 按下某个按键，此后一直按住这个按键，直到时刻 $r_i$ 松开它（$l_i<r_i$）。在每个时刻，ac 要么按下一个按键，要么松开一个按键，但是可以同时按住多个按键。\n\n第 $i$ 次操作形成了一个操作区间 $[l_i,r_i]$，满足 $l_i$ 严格递增。并且，由于残暴圣所的关卡设计，任意两个操作形成的操作区间之间，要么不交，要么包含。\n\nac 设计了 $2n$ 个难度系数 $a_1,a_2,\\dots,a_{2n}$。第 $i$ 次操作的难度可以用 $a_{l_i}\\times a_{r_i}$ 来评估，而通关残暴圣所的难度即为所有操作的难度之和。\n\n然而，由于 ac 卡在了残暴圣所的第一面，所以他并不知道每个操作的操作区间。在给定 $n$ 和 $\\{a\\}$ 的前提下，请你计算对于所有可能的情况，通关残暴圣所的难度之和，对 $998244353$ 取模。\n\n#### 形式化题意：\n\n给定一个长为 $2n$ 的数列 $a_1,a_2,\\dots,a_{2n}$。\n\n定义“区间组”由 $n$ 个区间组成，第 $i$ 个区间为 $[l_i,r_i]\\ (1\\le l_i<r_i\\le2n)$，求所有满足下列条件的区间组的 $\\sum_{i=1}^na_{l_i}\\times a_{r_i}$ 之和对 $998244353$ 取模：\n\n1. $l_1,r_1,l_2,r_2,\\dots,l_n,r_n$ 是 $1,2,\\dots,2n$ 的一个排列。\n2. $\\forall 1\\le i<n$，$l_i<l_{i+1}$。\n3. $\\forall i,j$，$[l_i,r_i]\\cap[l_j,r_j]=\\varnothing$ 或 $[l_i,r_i]\\sube[l_j,r_j]$ 或 $[l_j,r_j]\\sube[l_i,r_i]$。\n", "inputFormat": "第一行一个整数 $n$，表示区间数。\n\n第二行 $2n$ 个整数 $a_i$，含义如上所述。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模的值。", "hint": "#### 样例说明\n\n对于样例 1，可能的两个操作区间只有两种情况：\n\n1. $[1,2],[3,4]$，通关难度为 $a_1a_2+a_3a_4=1612986$。\n2. $[1,4],[2,3]$，通关难度为 $a_1a_4+a_2a_3=1078706$。\n\n难度之和为 $1612986+1078706=2691692$，对 $998244353$ 取模后仍为 $2691692$。\n\n以下几种情况是不合法的：\n\n1. $[3,4],[1,2]$，因为要求 $l_i$ 严格递增，而 $l_1\\ge l_2$。\n2. $[1,1],[2,4]$，因为要求 $l_i<r_i$，而 $l_1\\ge r_1$。\n3. $[1,3],[2,3]$，因为要求在每个时刻，要么按下一个按键，要么松开一个按键，而第三个时刻松开了两个按键，第四个时刻没有按下或松开任何一个按键。\n4. $[1,3],[2,4]$，因为要求任意两个操作区间不交或包含，而这两个区间之间有交，并且没有包含关系。\n\n---\n\n#### 数据范围\n\n对于 $10\\%$ 的数据，$n\\le15$。\n\n对于 $30\\%$ 的数据，$n\\le200$。\n\n对于 $50\\%$ 的数据，$n\\le3000$。\n\n对于另 $5\\%$ 的数据，$a_i=1$。\n\n对于 $100\\%$ 的数据，$1\\le n\\le5\\times10^5$，$0\\le a_i<998244353$。", "locale": "zh-CN"}}}
{"pid": "P8959", "type": "P", "difficulty": 7, "samples": [["5 7\n1 2 3 4 5\n1 2\n3 1\n4 3\n3 5\n1 4\n3 1\n2 4\n1 3\n1 5\n3 1\n3 5", "4\n4\n8"], ["8 7\n4 1 3 5 8 6 2 9\n1 2\n3 1\n4 2\n5 1\n5 6\n7 5\n6 8\n1 1\n1 5\n3 7\n3 1\n1 2\n2 5\n3 5\n", "0\n12\n8\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "树链剖分", "线段树合并"], "title": "「CGOI-3」灵气", "background": ">「地牢中回荡着尖叫声...」\n\n打完世花的 ac 进入地牢刷灵气……\n\n花后地牢十分险恶，ac 想在地牢里搭满单向门。\n\n[![](https://cdn.luogu.com.cn/upload/image_hosting/a1ewte9n.png)](https://www.bilibili.com/video/BV1jf4y1Z7RB)", "description": "ac 世界里的地牢有 $n$ 个小房间，恰好存在 $n-1$ 条过道，并且每个小房间连通。第 $i$ 个小房间生成的怪在一个时刻**最多只会存在一个**，且**伤害为 $a_i$**。\n\n为了方便刷灵气，ac 在每个过道上建了一个单向门。\n\n每一秒会发生以下几个事件之一：\n\n1. 第 $x$ 个房间生成了一个怪。怪**不会穿墙**，只会顺着单向门方向移动。\n\n2. 第 $x$ 个房间生成的怪被 ac 的仆从干掉了。\n\n3. ac 想要挂机刷怪，于是他希望知道，如果从时刻 1 开始站在房间 $x$ 一直到当前时刻，受到伤害最多的一个时刻所受伤害是多少。\n\n这里定义一个时刻受到伤害为可以走到 ac 所在房间的怪的伤害值总和，“可以走到”定义为可以穿过若干条单向门到达 ac 的房间（若干可以为 $0$）。ac 非常强大，不会中途被怪打死。\n\n当然，ac 所在的位置**不会改变怪的刷新**和**仆从的行为**。\n\n#### 简化版题面\n\n一棵树，每个点有个点权，每条边有个方向。\n\n有个集合，一开始为空，三个操作：\n\n1. 在集合中加入一个点。\n2. 删除集合中的一个点。\n3. 给出一个点 $x$，询问集合中满足可以走到 $x$ 的点的点权之和的历史最大值。", "inputFormat": "第一行，两个整数 $n,m$，分别表示房间个数和事件个数。\n\n接下来一行，共 $n$ 个整数，第 $i$ 个数表示 $i$ 房间中怪的伤害 $a_i$。\n\n接下来 $n-1$ 行，每行两个整数 $x,y$，表示 $x$ 与 $y$ 有一条过道，单向门方向为 $x\\rightarrow y$ 。\n\n接下来 $m$ 行，第 $i$ 行两个整数 $fl,x$，表示第 $x$ 号房间发生了 $fl$ 号事件。\n\n对于 $fl=1$ 的操作，保证 $x$ 号房间没有怪。\n\n对于 $fl=2$ 的操作，保证 $x$ 号房间有怪。", "outputFormat": "对每一个 $fl=3$ 的事件，输出一个整数表示答案，并用换行隔开。", "hint": "#### 样例一说明\n第一个询问中，时刻 $1$ 存在怪的房间为 $\\{4\\}$，$4$ 号房间的怪可以走到 $1$ 号房间，因此答案为 $a_4=4$。\n\n第二个询问中，受到伤害最大的时刻为时刻 $1$，答案为 $a_4=4$。其中时刻 $5$ 存在怪的房间为 $\\{3,5\\}$，而 $5$ 号房间的怪走不到 $1$ 号房间，因此此时刻受到伤害为 $a_3=3<4$，不是最大值。\n\n第三个询问中，受到伤害最大的时刻为时刻 $5$，$3,5$ 号房间的怪均可走到 $5$，因此答案为 $a_3+a_5=8$。\n\n---\n\n#### 数据范围\n**「本题采用捆绑测试」**\n\n对于 $10\\%$ 的数据，$n,m \\leq 2000$。\n\n对于另 $10\\%$ 的数据，过道 $(x,y)$ 单向门满足 $x<y$。\n\n对于另 $30\\%$ 的数据，不存在 2 事件。\n\n对于 $100\\%$ 的数据，$1\\leq n,m \\leq 2\\times 10^5$，$1\\leq a_i\\leq10^4$。\n\n~~但是地牢幽魂就是穿墙怪（）（）（）~~\n\n~~不会真的有人会在地牢里搭满单向门吧。~~\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「CGOI-3」灵气", "background": ">「地牢中回荡着尖叫声...」\n\n打完世花的 ac 进入地牢刷灵气……\n\n花后地牢十分险恶，ac 想在地牢里搭满单向门。\n\n[![](https://cdn.luogu.com.cn/upload/image_hosting/a1ewte9n.png)](https://www.bilibili.com/video/BV1jf4y1Z7RB)", "description": "ac 世界里的地牢有 $n$ 个小房间，恰好存在 $n-1$ 条过道，并且每个小房间连通。第 $i$ 个小房间生成的怪在一个时刻**最多只会存在一个**，且**伤害为 $a_i$**。\n\n为了方便刷灵气，ac 在每个过道上建了一个单向门。\n\n每一秒会发生以下几个事件之一：\n\n1. 第 $x$ 个房间生成了一个怪。怪**不会穿墙**，只会顺着单向门方向移动。\n\n2. 第 $x$ 个房间生成的怪被 ac 的仆从干掉了。\n\n3. ac 想要挂机刷怪，于是他希望知道，如果从时刻 1 开始站在房间 $x$ 一直到当前时刻，受到伤害最多的一个时刻所受伤害是多少。\n\n这里定义一个时刻受到伤害为可以走到 ac 所在房间的怪的伤害值总和，“可以走到”定义为可以穿过若干条单向门到达 ac 的房间（若干可以为 $0$）。ac 非常强大，不会中途被怪打死。\n\n当然，ac 所在的位置**不会改变怪的刷新**和**仆从的行为**。\n\n#### 简化版题面\n\n一棵树，每个点有个点权，每条边有个方向。\n\n有个集合，一开始为空，三个操作：\n\n1. 在集合中加入一个点。\n2. 删除集合中的一个点。\n3. 给出一个点 $x$，询问集合中满足可以走到 $x$ 的点的点权之和的历史最大值。", "inputFormat": "第一行，两个整数 $n,m$，分别表示房间个数和事件个数。\n\n接下来一行，共 $n$ 个整数，第 $i$ 个数表示 $i$ 房间中怪的伤害 $a_i$。\n\n接下来 $n-1$ 行，每行两个整数 $x,y$，表示 $x$ 与 $y$ 有一条过道，单向门方向为 $x\\rightarrow y$ 。\n\n接下来 $m$ 行，第 $i$ 行两个整数 $fl,x$，表示第 $x$ 号房间发生了 $fl$ 号事件。\n\n对于 $fl=1$ 的操作，保证 $x$ 号房间没有怪。\n\n对于 $fl=2$ 的操作，保证 $x$ 号房间有怪。", "outputFormat": "对每一个 $fl=3$ 的事件，输出一个整数表示答案，并用换行隔开。", "hint": "#### 样例一说明\n第一个询问中，时刻 $1$ 存在怪的房间为 $\\{4\\}$，$4$ 号房间的怪可以走到 $1$ 号房间，因此答案为 $a_4=4$。\n\n第二个询问中，受到伤害最大的时刻为时刻 $1$，答案为 $a_4=4$。其中时刻 $5$ 存在怪的房间为 $\\{3,5\\}$，而 $5$ 号房间的怪走不到 $1$ 号房间，因此此时刻受到伤害为 $a_3=3<4$，不是最大值。\n\n第三个询问中，受到伤害最大的时刻为时刻 $5$，$3,5$ 号房间的怪均可走到 $5$，因此答案为 $a_3+a_5=8$。\n\n---\n\n#### 数据范围\n**「本题采用捆绑测试」**\n\n对于 $10\\%$ 的数据，$n,m \\leq 2000$。\n\n对于另 $10\\%$ 的数据，过道 $(x,y)$ 单向门满足 $x<y$。\n\n对于另 $30\\%$ 的数据，不存在 2 事件。\n\n对于 $100\\%$ 的数据，$1\\leq n,m \\leq 2\\times 10^5$，$1\\leq a_i\\leq10^4$。\n\n~~但是地牢幽魂就是穿墙怪（）（）（）~~\n\n~~不会真的有人会在地牢里搭满单向门吧。~~\n", "locale": "zh-CN"}}}
{"pid": "P8960", "type": "P", "difficulty": 3, "samples": [["7\n3 1\n010\n3 2\n010\n3 3\n010\n3 4\n010\n3 5\n010\n3 6\n010\n3 7\n010", "Down\nUp\nUp\nDown\nDown\nDown\nUp"], ["7\n3 1\n011\n3 2\n011\n3 3\n011\n3 4\n011\n3 5\n011\n3 6\n011\n3 7\n011", "Down\nUp\nUp\nDown\nDown\nDown\nUp\n"], ["2\n13 114\n1101101111010\n13 514\n1101101111010", "Up\nUp"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["模拟", "O2优化", "进制"], "title": "「WHOI-4」折纸", "background": "吉尼斯记录：一张纸（如果接近 $4$ 公里的卫生纸可以算作一张纸）最多可以对折 $13$ 次。小 X 吹牛说打破了这个记录，但是吹太大了。", "description": "小 X 向吉尼斯世界纪录组织申请了这个记录，但是他正好隔离在家，无法证明。他只好允许他们问 $t$ 个问题，确认他确实打破了记录。\n\n他们每个问题可以要求小 X 把一张纸按照一个给定 $01$ 串 $s$ 的规则对折 $n$ 次后展开。对于第 $i$ 次折叠，如果 $s_i=0$，将纸从左到右对折，使左边对齐右边；如果 $s_i=1$，将纸从右到左对折，使右边对齐左边。对折全部是从上方翻。**接下来将会展开，展开后纸片在原位，只是保留了折痕。看看自己是否实现了这一点。**\n\n他们想要知道，从左往右数第 $k$ 个折痕是峰折（向上突起的折痕）还是谷折（向下凹陷的折痕）。如果该询问的答案是峰折，输出 `Up`；否则输出 `Down`。请你帮帮可怜的小 X。\n\n峰折，谷折的图示见样例解释。", "inputFormat": "**本题采用多测。**\n\n第一行一行一个正整数 $t$，代表数据组数。\n\n接下来 $2t$ 行，每两行是一组数据。每组数据，第一行两个正整数 $n,k$。接下来一行一个长度为 $n$ 的 $01$ 串，代表 $s$。", "outputFormat": "$t$ 行，每行一个字符串，代表该组数据的答案。\n", "hint": "**样例解释**\n\n样例 #1 解释：\n\n动态地址：[here](http://img-blog.csdnimg.cn/c68f2ba917504417b109eb1606f4a3a5.gif)。不知道为什么洛谷显示不了了。\n\n由于技术原因，动图帧数略低。\n\n样例 #2 请手动模拟。\n\n**数据范围**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（$20$ pts）：$t=10$，$1\\le n\\le5$；\n- Subtask 2（$80$ pts）：$t=10^5$。\n\n对于 $100\\%$ 的数据，有 $1\\le t\\le 10^5$，$1\\le n\\le60$，$1\\le k<2^n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「WHOI-4」折纸", "background": "吉尼斯记录：一张纸（如果接近 $4$ 公里的卫生纸可以算作一张纸）最多可以对折 $13$ 次。小 X 吹牛说打破了这个记录，但是吹太大了。", "description": "小 X 向吉尼斯世界纪录组织申请了这个记录，但是他正好隔离在家，无法证明。他只好允许他们问 $t$ 个问题，确认他确实打破了记录。\n\n他们每个问题可以要求小 X 把一张纸按照一个给定 $01$ 串 $s$ 的规则对折 $n$ 次后展开。对于第 $i$ 次折叠，如果 $s_i=0$，将纸从左到右对折，使左边对齐右边；如果 $s_i=1$，将纸从右到左对折，使右边对齐左边。对折全部是从上方翻。**接下来将会展开，展开后纸片在原位，只是保留了折痕。看看自己是否实现了这一点。**\n\n他们想要知道，从左往右数第 $k$ 个折痕是峰折（向上突起的折痕）还是谷折（向下凹陷的折痕）。如果该询问的答案是峰折，输出 `Up`；否则输出 `Down`。请你帮帮可怜的小 X。\n\n峰折，谷折的图示见样例解释。", "inputFormat": "**本题采用多测。**\n\n第一行一行一个正整数 $t$，代表数据组数。\n\n接下来 $2t$ 行，每两行是一组数据。每组数据，第一行两个正整数 $n,k$。接下来一行一个长度为 $n$ 的 $01$ 串，代表 $s$。", "outputFormat": "$t$ 行，每行一个字符串，代表该组数据的答案。\n", "hint": "**样例解释**\n\n样例 #1 解释：\n\n动态地址：[here](http://img-blog.csdnimg.cn/c68f2ba917504417b109eb1606f4a3a5.gif)。不知道为什么洛谷显示不了了。\n\n由于技术原因，动图帧数略低。\n\n样例 #2 请手动模拟。\n\n**数据范围**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（$20$ pts）：$t=10$，$1\\le n\\le5$；\n- Subtask 2（$80$ pts）：$t=10^5$。\n\n对于 $100\\%$ 的数据，有 $1\\le t\\le 10^5$，$1\\le n\\le60$，$1\\le k<2^n$。", "locale": "zh-CN"}}}
{"pid": "P8961", "type": "P", "difficulty": 5, "samples": [["1 10\n4", "6\n-6"], ["1 10\n7", "7\n7"], ["2 9\n3 3", "6\n12 -6"], ["10 7\n1 2 3 4 5 6 0 1 2 3", "6\n36 30 24 18 12 6 42 -6 30 24"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数论", "Special Judge", "O2优化", "素数判断,质数,筛法", "中国剩余定理 CRT"], "title": "「WHOI-4」ggcd", "background": "如何输入输出 `__int128`：\n\n```cpp\n__int128 read() {\n  char c = getchar();\n  __int128 x = 0;\n  bool f = 0;\n  for (; !isdigit(c); c = getchar()) f ^= !(c ^ 45);\n  for (; isdigit(c); c = getchar()) x = (x << 1) + (x << 3) + (c ^ 48);\n  if (f) x = -x;\n  return x;\n}\nvoid write(__int128 x, char c = '\\0') {\n  if (x < 0) putchar('-'), x = -x;\n  if (x > 9) write(x / 10);\n  putchar(x % 10 + '0');\n  if (c != '\\0') putchar(c);\n}\n```", "description": "**本题已新增一组样例，请注意查看。**\n\n小 Y 给了你长度为 $n$ 的数组 $y$ 以及一个正整数 $m$，保证 $0\\le y_i<m$，请你构造一个同样长为 $n$ 的数组 $x$，使得：\n\n1. $x_i$ 在 `__int128` 范围内；\n2. $x_i\\bmod m=y_i$；\n3. $\\gcd(|x_1|,\\cdots,|x_n|)\\bmod m$ 最大。\n\n注意，$x_i$ **可以为负**，此时 $m\\mid (x_i-y_i)$ 且 $0\\le y_i<m$。 ", "inputFormat": "第一行两个正整数 $n,m$。\n\n接下来一行 $n$ 个非负整数，代表 $x_i \\bmod m$ 的值。", "outputFormat": "第一行一个非负整数 $g$，代表 $\\gcd(|x_1|,|x_2|,\\cdots,|x_n|)\\mod m$ 的可能最大值。\n\n接下来一行 $n$ 个整数，代表 $x_i$。", "hint": "**数据范围**\n\n**本题采用捆绑测试。**\n\nSubtask 1（$30$ pts）：$m$ 是素数。\n\nSubtask 2（$70$ pts）：无特殊限制。\n\n对于所有数据，保证 $2\\le m \\le10^9$，$1\\le n\\le10^6$。\n\n**关于 Special Judge**\n\n对于每个测试点：\n\n如果你输出的格式不正确，你将会获得 $0$ 分。\n\n如果你输出的数中有不在 `__int128` 范围的数，可能导致溢出所以你可能无法获得预期的分数。\n\n如果你的数列 $x$ 不符合题目给定的 $y$，你将会获得 $0$ 分。\n\n如果你的数列 $x$ 不符合你输出的 $g$，你将会获得 $0$ 分。\n\n如果你的 $g$ 不为最大，你将会获得 $0$ 分。\n\n否则你将获得该测试点的所有分数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「WHOI-4」ggcd", "background": "如何输入输出 `__int128`：\n\n```cpp\n__int128 read() {\n  char c = getchar();\n  __int128 x = 0;\n  bool f = 0;\n  for (; !isdigit(c); c = getchar()) f ^= !(c ^ 45);\n  for (; isdigit(c); c = getchar()) x = (x << 1) + (x << 3) + (c ^ 48);\n  if (f) x = -x;\n  return x;\n}\nvoid write(__int128 x, char c = '\\0') {\n  if (x < 0) putchar('-'), x = -x;\n  if (x > 9) write(x / 10);\n  putchar(x % 10 + '0');\n  if (c != '\\0') putchar(c);\n}\n```", "description": "**本题已新增一组样例，请注意查看。**\n\n小 Y 给了你长度为 $n$ 的数组 $y$ 以及一个正整数 $m$，保证 $0\\le y_i<m$，请你构造一个同样长为 $n$ 的数组 $x$，使得：\n\n1. $x_i$ 在 `__int128` 范围内；\n2. $x_i\\bmod m=y_i$；\n3. $\\gcd(|x_1|,\\cdots,|x_n|)\\bmod m$ 最大。\n\n注意，$x_i$ **可以为负**，此时 $m\\mid (x_i-y_i)$ 且 $0\\le y_i<m$。 ", "inputFormat": "第一行两个正整数 $n,m$。\n\n接下来一行 $n$ 个非负整数，代表 $x_i \\bmod m$ 的值。", "outputFormat": "第一行一个非负整数 $g$，代表 $\\gcd(|x_1|,|x_2|,\\cdots,|x_n|)\\mod m$ 的可能最大值。\n\n接下来一行 $n$ 个整数，代表 $x_i$。", "hint": "**数据范围**\n\n**本题采用捆绑测试。**\n\nSubtask 1（$30$ pts）：$m$ 是素数。\n\nSubtask 2（$70$ pts）：无特殊限制。\n\n对于所有数据，保证 $2\\le m \\le10^9$，$1\\le n\\le10^6$。\n\n**关于 Special Judge**\n\n对于每个测试点：\n\n如果你输出的格式不正确，你将会获得 $0$ 分。\n\n如果你输出的数中有不在 `__int128` 范围的数，可能导致溢出所以你可能无法获得预期的分数。\n\n如果你的数列 $x$ 不符合题目给定的 $y$，你将会获得 $0$ 分。\n\n如果你的数列 $x$ 不符合你输出的 $g$，你将会获得 $0$ 分。\n\n如果你的 $g$ 不为最大，你将会获得 $0$ 分。\n\n否则你将获得该测试点的所有分数。", "locale": "zh-CN"}}}
{"pid": "P8962", "type": "P", "difficulty": 4, "samples": [["998244353 5\n", "1\n1 2\n4 4 4\n12 12 14 18\n48 54 60 66 72"]], "limits": {"time": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "二分", "O2优化"], "title": "「WHOI-4」yadiw. Slua, gassp, lhtubs.", "background": "> If you know at least 3 of these things and you are not red — you are doing it wrong. Stop learning useless algorithms, go and solve some problems, learn how to use binary search.\n", "description": "小 F 有一个奇妙的数组 $a$，$a$ 中没有重复的元素，长度为 $n$，他使用`std::sort`将他排序了，认为它是有序的，所以他正在使用这样的方法进行二分查找。显然，能否查到只和数列的离散化结果有关，所以你可以直接把 $a$ 看作 $1\\sim n$ 的一个排列。\n\n```cpp\nint search(int key) {\n  int l = 1, r = n;\n  while (l <= r) {\n    int mid = (l + r) / 2;\n    if (a[mid] < key)\n      l = mid + 1;\n    else if (a[mid] == key)\n      return mid;\n    else\n      r = mid - 1;\n  }\n  return -1;\n}\n```\n\n不幸的是，小 W 为了让他戒掉万能头，在`bits/stdc++.h`中写了`#define sort random_shuffle`，这意味着 $a$ 实际是一个随机的排列。\n\n现在，对于所有在 $1$ 到 $N$ 范围内的 $n$，以及所有在 $1$ 到 $n$ 范围内的 $k$，在 $a$ 数列的所有排列中，有几个可以正确地找到第 $k$ 小的元素 $key$（即返回值非 $-1$）？由于答案可能过大，请输出它对给定模数 $p$ 取模的结果。", "inputFormat": "一行两个正整数 $p,N$。", "outputFormat": "$N$ 行，第 $n$ 行 $n$ 个正整数，代表在 $n$ 个元素中找 $k$ 能找到的方案数。", "hint": "**数据范围**\n\n**本题采用 Subtask 评测。**\n\n- Subtask 1（$10$ pts）：$N=10$，$ p\\ge998244352$；\n- Subtask 2（$25$ pts）：$N=100$，$p\\ge1009$ **且为素数**；\n- Subtask 3（$25$ pts）：$N=400$，$p\\ge1009$ **且为素数**；\n- Subtask 4（$40$ pts）：$N=400$。\n\n对于所有数据，$10\\le N\\le 400$，$ 2\\le p\\le998244353$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「WHOI-4」yadiw. Slua, gassp, lhtubs.", "background": "> If you know at least 3 of these things and you are not red — you are doing it wrong. Stop learning useless algorithms, go and solve some problems, learn how to use binary search.\n", "description": "小 F 有一个奇妙的数组 $a$，$a$ 中没有重复的元素，长度为 $n$，他使用`std::sort`将他排序了，认为它是有序的，所以他正在使用这样的方法进行二分查找。显然，能否查到只和数列的离散化结果有关，所以你可以直接把 $a$ 看作 $1\\sim n$ 的一个排列。\n\n```cpp\nint search(int key) {\n  int l = 1, r = n;\n  while (l <= r) {\n    int mid = (l + r) / 2;\n    if (a[mid] < key)\n      l = mid + 1;\n    else if (a[mid] == key)\n      return mid;\n    else\n      r = mid - 1;\n  }\n  return -1;\n}\n```\n\n不幸的是，小 W 为了让他戒掉万能头，在`bits/stdc++.h`中写了`#define sort random_shuffle`，这意味着 $a$ 实际是一个随机的排列。\n\n现在，对于所有在 $1$ 到 $N$ 范围内的 $n$，以及所有在 $1$ 到 $n$ 范围内的 $k$，在 $a$ 数列的所有排列中，有几个可以正确地找到第 $k$ 小的元素 $key$（即返回值非 $-1$）？由于答案可能过大，请输出它对给定模数 $p$ 取模的结果。", "inputFormat": "一行两个正整数 $p,N$。", "outputFormat": "$N$ 行，第 $n$ 行 $n$ 个正整数，代表在 $n$ 个元素中找 $k$ 能找到的方案数。", "hint": "**数据范围**\n\n**本题采用 Subtask 评测。**\n\n- Subtask 1（$10$ pts）：$N=10$，$ p\\ge998244352$；\n- Subtask 2（$25$ pts）：$N=100$，$p\\ge1009$ **且为素数**；\n- Subtask 3（$25$ pts）：$N=400$，$p\\ge1009$ **且为素数**；\n- Subtask 4（$40$ pts）：$N=400$。\n\n对于所有数据，$10\\le N\\le 400$，$ 2\\le p\\le998244353$。", "locale": "zh-CN"}}}
{"pid": "P8963", "type": "P", "difficulty": 5, "samples": [["5 10\n2 3 8 5 4", "-1 6\n2 3 4 5 6"], ["7 100\n11 45 14 19 19 8 10", "-17 51\n16 15 14 13 12 11 10"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "Special Judge", "O2优化"], "title": "「WHOI-4」加减法构造", "background": "", "description": "小 W 给了你一个长度为 $n$ 的**整数**数组 $x$。你需要构造一个长度也为 $n$ 的**整数**数组 $y$，并满足：\n\n1. $\\forall 1\\le i,j,i+j\\le n,y_{i+j}=y_i+y_j+k$，$k$ 是一个你需要钦定的整数。\n3. $d(x,y)=\\sum\\limits_{i=1}^n|x_i-y_i|$ 最小。\n3. $-V\\le y_i\\le V$，$V$ 是输入中给定的数。 ", "inputFormat": "第一行两个整数 $n,V$。\n\n接下来一行 $n$ 个整数，第 $i$ 个代表 $x_i$。", "outputFormat": "第一行两个整数 $k,d$，代表你钦定的值和你的答案。\n\n接下来一行 $n$ 个整数，第 $i$ 个代表 $y_i$。\n\n题目保证 $d$ 的最小值在 `long long` 范围内。", "hint": "**数据范围**\n\n- Subtask 1（$20$ pts）：$n\\le10$，$ V\\le10$，$ |x_i|\\le10$；\n- Subtask 2（$20$ pts）：$n\\le100$，$ |x_i|\\le100$，$V\\le1000$；\n- Subtask 3（$20$ pts）：$n\\le10^6$，$ |x_i|\\le10^6$，$V=10^{12}$；\n- Subtask 4（$20$ pts）：$n\\le10^7$，$|x_i|\\le10^7$，$V\\le10^7$;\n- Subtask 5（$20$ pts）：$n\\le10^7$，$|x_i|\\le10^7$，$V\\le 10^{12}$。\n\n对于所有数据，保证 $1\\le n\\le 10^7$，$|x_i|\\le10^7$，$1\\le V\\le10^{12}$。\n\n**关于 Special Judge 的说明**\n\n对于每个测试点：\n\n如果你输出的格式不正确，你将会获得 $0$ 分。\n\n如果你输出的数中有不在 $[-V,V]$ 范围的数，你将会获得 $0$ 分。\n\n如果你的数列 $y$ 不符合你输出的 $k$，你将会获得 $0$ 分。\n\n如果你的数列 $y$ 不符合你输出的 $d$，你将会获得 $0$ 分。\n\n否则你将会获得的分数为该测试点总分的百分之 $\\max\\{0,\\min\\{100,10100-\\frac{10000d}{d'}\\}\\}$，$d'$ 是答案的 $d$ 值。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「WHOI-4」加减法构造", "background": "", "description": "小 W 给了你一个长度为 $n$ 的**整数**数组 $x$。你需要构造一个长度也为 $n$ 的**整数**数组 $y$，并满足：\n\n1. $\\forall 1\\le i,j,i+j\\le n,y_{i+j}=y_i+y_j+k$，$k$ 是一个你需要钦定的整数。\n3. $d(x,y)=\\sum\\limits_{i=1}^n|x_i-y_i|$ 最小。\n3. $-V\\le y_i\\le V$，$V$ 是输入中给定的数。 ", "inputFormat": "第一行两个整数 $n,V$。\n\n接下来一行 $n$ 个整数，第 $i$ 个代表 $x_i$。", "outputFormat": "第一行两个整数 $k,d$，代表你钦定的值和你的答案。\n\n接下来一行 $n$ 个整数，第 $i$ 个代表 $y_i$。\n\n题目保证 $d$ 的最小值在 `long long` 范围内。", "hint": "**数据范围**\n\n- Subtask 1（$20$ pts）：$n\\le10$，$ V\\le10$，$ |x_i|\\le10$；\n- Subtask 2（$20$ pts）：$n\\le100$，$ |x_i|\\le100$，$V\\le1000$；\n- Subtask 3（$20$ pts）：$n\\le10^6$，$ |x_i|\\le10^6$，$V=10^{12}$；\n- Subtask 4（$20$ pts）：$n\\le10^7$，$|x_i|\\le10^7$，$V\\le10^7$;\n- Subtask 5（$20$ pts）：$n\\le10^7$，$|x_i|\\le10^7$，$V\\le 10^{12}$。\n\n对于所有数据，保证 $1\\le n\\le 10^7$，$|x_i|\\le10^7$，$1\\le V\\le10^{12}$。\n\n**关于 Special Judge 的说明**\n\n对于每个测试点：\n\n如果你输出的格式不正确，你将会获得 $0$ 分。\n\n如果你输出的数中有不在 $[-V,V]$ 范围的数，你将会获得 $0$ 分。\n\n如果你的数列 $y$ 不符合你输出的 $k$，你将会获得 $0$ 分。\n\n如果你的数列 $y$ 不符合你输出的 $d$，你将会获得 $0$ 分。\n\n否则你将会获得的分数为该测试点总分的百分之 $\\max\\{0,\\min\\{100,10100-\\frac{10000d}{d'}\\}\\}$，$d'$ 是答案的 $d$ 值。", "locale": "zh-CN"}}}
{"pid": "P8964", "type": "P", "difficulty": 2, "samples": [["3\n4 4\ntnalp\nwoem\nkcarrab\nhctam\n\nfreopen(\"tnalp.in\",\"r\",stdin);\nfreopen(\"tnalp.out\",\"w\",stdout);\nfreopen(\"woem.in\",\"r\",stdin);\nfreopen(\"woem.out\",\"w\",stdout);\nfreopen(\"kcarrab.in\",\"r\",stdin);\nfreopen(\"kcarrab.out\",\"w\",stdout);\nfreopen(\"hctam.in\",\"r\",stdin);\nfreopen(\"hctam.out\",\"w\",stdout);\n\nfreopen(\"tnalp.in\",\"r\",stdin);\nfreopen(\"tnalp.out\",\"w\",stdout);\n//freopen(\"woem.in\",\"r\",stdin);\nfreopen(\"woem.out\",\"w\",stdout);\nfreopen(\"kcarrab.in\",\"r\",stdin);\n//I_AK_IOI!!!\nfreopen(\"hctam.in\",\"r\",stdin);\nfreopen(\"hctam.out\",\"w\",stdout);\n\nfreopen(\"tnalp.in\",\"r\",stdin);\nfreopen(\"tnalp.out\",\"w\",stdout)\nfreopen(\"owem.in\",\"r\",stdin);\nfreopen(\"woem.out\",\"w\",stdout);\nfreopen(\"kcarrab.in\",\"r\",stdout);\nfreopen(\"kcarrab.out\",\"w\",stdin);\nfreopen(\"hctam.out\",\"w\",stdout);\nfreopen(\"hctam.in\",\"r\",stdin);\n\nfreopen(\"tnalp.in\",\"r\",stdin);//I_LOVE_CCF\nfreopen(\"tnalp.out\",\"w\",stdout);\nfreopen(\"woem.in\",\"r\",stdin);//I_HATE_THIS\nfreopen(\"woem.out\",\"w\",stdout);\nfreopen(\"kcarrab.in\"/*I_FORGET_HOW_TO_FIND_BRIDGES!!!!!!*/,\"r\",stdin);\nfreopen(\"kcarrab.out\",\"w\",stdout);\nfreopen(\"hctam.in\",\"r\",stdin);//I_CAN_GET_ONLY_8PTSqwq\nfreopen(\"hctam.out\",\"w\",stdout);\n", "PION2202 RP++.\nWrong file operation takes you to your ancestors along with your 3 years' efforts on OI.\nGood luck and have fun.\nGood luck and have fun.\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["模拟", "字符串", "洛谷原创", "O2优化", "洛谷月赛"], "title": "梦幻 | Reopening of  Dream", "background": "_望你没有因此而功亏一篑过_\n\n花开不是为了花落，而是为了更加灿烂。\n\n最初拥有的只是理想和自信，但所有的一切都从这里交错着生长，在努力与汗水铺成的路上走下去不会是错误的选择——至少你为此喜怒哀乐过。\n\n**祝每一位有理想的参赛者都能取得理想的成绩！**\n", "description": "PION2202 的选手代码公布了。作为一个~~连续编写了十年迷惑行为大赏~~的人，你当然是要抢先把代码中的各种事迹发出来啦。\n\n首先关注的肯定是大家的文件输入输出有没写对。你已经让小 E 把每道题的题目名称和每位选手的 `freopen` 语句整理出来了。\n\nPION2202 一共有 $m$ 道题，有 $n$ 位选手参与。你决定把选手分成三类：\n\n1. 普通人：最正常不过的 `freopen` 语句；\n2. 见祖宗人：被注释的 `freopen` 语句；\n3. 乐子人：其他形式的 `freopen` 语句。\n\n形式化地，普通人的所有题目的 `freopen` 语句都应该恰好是\n\n```cpp\nfreopen(\"<title>.in\",\"r\",stdin);\nfreopen(\"<title>.out\",\"w\",stdout);\n```\n\n其中的 `<title>` 应替换成对应的题目名称。\n\n见祖宗人的 `freopen` 语句中存在至少一道题的至少一行语句以 `//freopen(` 开头，以 `);` 结尾。\n\n如果一位选手的 `freopen` 语句不满足上面两种情况，则称这位选手为乐子人。\n\n你需要判断每位选手是普通人，见祖宗人还是乐子人。", "inputFormat": "第一行一个正整数 $T$，表示子任务编号。\n\n第二行两个正整数 $n,m$，分别表示选手数和题目数。\n\n接下来 $m$ 行，每行包含一个仅由小写字母构成的字符串，其中第 $i$ 行表示第 $i$ 道题目的题目名称。保证题目名称的长度在 $1$ 到 $10$ 之间。\n\n接下来 $n\\times(2m+1)$ 行，在每 $2m+1$ 行中，第一行为空行，后 $2m$ 行表示一位选手的所有题目的 `freopen` 语句，按照题目顺序给出。前两行为第一题的 `freopen` 语句，依次类推，最后两行为最后一题的 `freopen` 语句。\n\n保证所有的 `freopen` 语句的每个字符的 ASCII 码均在 $33$ 到 $126$ 之间，即不含空格等不可见字符。\n\n保证每一行 `freopen` 语句的长度在 $1$ 到 $100$ 之间。", "outputFormat": "输出 $n$ 行，其中第 $i$ 行表示第 $i$ 位选手的分类。\n\n如果是普通人，就要祝他 RP++，所以就输出一行 `PION2202 RP++.`。\n\n如果是见祖宗人，那就只好输出一行 `Wrong file operation takes you to your ancestors along with your 3 years' efforts on OI.`。\n\n如果是乐子人，就祝他在玩得开心的同时注意不要弄错了，于是输出一行 `Good luck and have fun.`。", "hint": "**【样例解释】**\n\n第一位选手所有的 `freopen` 语句都很正常，所以是普通人。\n\n第二位选手注释了题目 `woem` 的输入文件语句，所以是见祖宗人。虽然该选手在题目 `kcarrab` 中有乐子行为但由于已经满足了见祖宗人的条件，所以该选手被分类为见祖宗人。\n\n第三位选手四道题的 `freopen` 语句都不是正常的。`tnalp` 的输出文件语句少了分号；`woem` 被打成了 `owem`；打反了 `kcarrab` 一题中的 `stdin` 和 `stdout`；交换了 `hctam` 的两个语句的顺序。在本题中算作乐子人。\n\n第四位选手的 `freopen` 语句虽然能够正常工作，但是因为与正常的 `freopen` 语句不同而在本题中被算作乐子人。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n子任务 1（30 分）：$T = 1$。$m = 1$ 且题目名称为 `yxalag`。但是，如果你输出 `No, general!` 是不能得到分数的。  \n子任务 2（30 分）：$T = 2$。保证没有见祖宗人。  \n子任务 3（40 分）：$T = 3$。无特殊性质。\n\n对于 $100\\%$ 的数据：\n\n- 保证 $1\\le T \\le 3$。\n- 保证 $1\\le n\\le 1000$。\n- 保证 $1\\le m \\le 4$。\n- 保证题目名称的长度在 $1$ 到 $10$ 之间。\n- 保证每一行 `freopen` 语句的长度在 $1$ 到 $100$ 之间。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "梦幻 | Reopening of  Dream", "background": "_望你没有因此而功亏一篑过_\n\n花开不是为了花落，而是为了更加灿烂。\n\n最初拥有的只是理想和自信，但所有的一切都从这里交错着生长，在努力与汗水铺成的路上走下去不会是错误的选择——至少你为此喜怒哀乐过。\n\n**祝每一位有理想的参赛者都能取得理想的成绩！**\n", "description": "PION2202 的选手代码公布了。作为一个~~连续编写了十年迷惑行为大赏~~的人，你当然是要抢先把代码中的各种事迹发出来啦。\n\n首先关注的肯定是大家的文件输入输出有没写对。你已经让小 E 把每道题的题目名称和每位选手的 `freopen` 语句整理出来了。\n\nPION2202 一共有 $m$ 道题，有 $n$ 位选手参与。你决定把选手分成三类：\n\n1. 普通人：最正常不过的 `freopen` 语句；\n2. 见祖宗人：被注释的 `freopen` 语句；\n3. 乐子人：其他形式的 `freopen` 语句。\n\n形式化地，普通人的所有题目的 `freopen` 语句都应该恰好是\n\n```cpp\nfreopen(\"<title>.in\",\"r\",stdin);\nfreopen(\"<title>.out\",\"w\",stdout);\n```\n\n其中的 `<title>` 应替换成对应的题目名称。\n\n见祖宗人的 `freopen` 语句中存在至少一道题的至少一行语句以 `//freopen(` 开头，以 `);` 结尾。\n\n如果一位选手的 `freopen` 语句不满足上面两种情况，则称这位选手为乐子人。\n\n你需要判断每位选手是普通人，见祖宗人还是乐子人。", "inputFormat": "第一行一个正整数 $T$，表示子任务编号。\n\n第二行两个正整数 $n,m$，分别表示选手数和题目数。\n\n接下来 $m$ 行，每行包含一个仅由小写字母构成的字符串，其中第 $i$ 行表示第 $i$ 道题目的题目名称。保证题目名称的长度在 $1$ 到 $10$ 之间。\n\n接下来 $n\\times(2m+1)$ 行，在每 $2m+1$ 行中，第一行为空行，后 $2m$ 行表示一位选手的所有题目的 `freopen` 语句，按照题目顺序给出。前两行为第一题的 `freopen` 语句，依次类推，最后两行为最后一题的 `freopen` 语句。\n\n保证所有的 `freopen` 语句的每个字符的 ASCII 码均在 $33$ 到 $126$ 之间，即不含空格等不可见字符。\n\n保证每一行 `freopen` 语句的长度在 $1$ 到 $100$ 之间。", "outputFormat": "输出 $n$ 行，其中第 $i$ 行表示第 $i$ 位选手的分类。\n\n如果是普通人，就要祝他 RP++，所以就输出一行 `PION2202 RP++.`。\n\n如果是见祖宗人，那就只好输出一行 `Wrong file operation takes you to your ancestors along with your 3 years' efforts on OI.`。\n\n如果是乐子人，就祝他在玩得开心的同时注意不要弄错了，于是输出一行 `Good luck and have fun.`。", "hint": "**【样例解释】**\n\n第一位选手所有的 `freopen` 语句都很正常，所以是普通人。\n\n第二位选手注释了题目 `woem` 的输入文件语句，所以是见祖宗人。虽然该选手在题目 `kcarrab` 中有乐子行为但由于已经满足了见祖宗人的条件，所以该选手被分类为见祖宗人。\n\n第三位选手四道题的 `freopen` 语句都不是正常的。`tnalp` 的输出文件语句少了分号；`woem` 被打成了 `owem`；打反了 `kcarrab` 一题中的 `stdin` 和 `stdout`；交换了 `hctam` 的两个语句的顺序。在本题中算作乐子人。\n\n第四位选手的 `freopen` 语句虽然能够正常工作，但是因为与正常的 `freopen` 语句不同而在本题中被算作乐子人。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n子任务 1（30 分）：$T = 1$。$m = 1$ 且题目名称为 `yxalag`。但是，如果你输出 `No, general!` 是不能得到分数的。  \n子任务 2（30 分）：$T = 2$。保证没有见祖宗人。  \n子任务 3（40 分）：$T = 3$。无特殊性质。\n\n对于 $100\\%$ 的数据：\n\n- 保证 $1\\le T \\le 3$。\n- 保证 $1\\le n\\le 1000$。\n- 保证 $1\\le m \\le 4$。\n- 保证题目名称的长度在 $1$ 到 $10$ 之间。\n- 保证每一行 `freopen` 语句的长度在 $1$ 到 $100$ 之间。", "locale": "zh-CN"}}}
{"pid": "P8965", "type": "P", "difficulty": 3, "samples": [["3 2\n1 2 1\n2 3 1\n1 2 1 3\n2 3 2 3\n", "1\n0\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "O2优化", "前缀和", "洛谷月赛"], "title": "坠梦 | Falling into Dream", "background": "神明愚弄凡间，所谓命运，不过是神明掷出的一颗骰子而已。\n\n花朵等不到的蝴蝶，终究成了一分蹊跷的梦，一轮轮再次重启。\n\n神明的提线木偶一次又一次的被扼住脖颈, 以爱的名义，消逝在时间的花海里。\n\n无数的执念背后，都有一个被扭曲的“真理”。\n \n 你所承诺的没有出现，彻夜无眠，或许我只是自作主张的，替你爱了一次人间\n\n“最虔诚者只祝祷，不虔诚者才有所求。”\n\n没有过信仰，因为舍命救了一个人，有幸来到了天堂。\n ", "description": "给定一棵 $n$ 个结点的无根树，每条边有非负整数边权。结点由 $1 \\sim n$ 编号。\n\n对于每一个点对 $(x, y)$，定义 $(x, y)$ 的距离 $\\operatorname{dis}(x, y)$ 为 $x,y$ 两点之间唯一简单路径上边权的异或和。\n\n给定两个结点 $x, y$，定义点 $i$ 的价值 $\\operatorname{val}_{x, y}(i)$ 为 $(x, i)$ 与 $(y, i)$ 的距离的异或和，即\n\n$$ \\operatorname{val}_{x, y}(i) = \\operatorname{dis}(x, i) \\oplus \\operatorname{dis}(y, i) \\textsf{。} $$\n\n现在有 $q$ 次询问，每次询问给出四个整数 $x, y, l, r$，求 $\\displaystyle \\bigoplus_{i = l}^{r} \\operatorname{val}_{x, y}(i)$ 的值，即求\n\n$$ \\operatorname{val}_{x, y}(l) \\oplus \\operatorname{val}_{x, y}(l + 1) \\oplus \\cdots \\oplus \\operatorname{val}_{x, y}(r - 1) \\oplus \\operatorname{val}_{x, y}(r) \\textsf{。} $$\n\n上述公式中，$\\oplus$ 表示二进制按位异或。", "inputFormat": "第一行，两个整数 $n, q$。\n\n接下来 $n - 1$ 行，每行三个整数 $u, v, w$，表示 $u, v$ 之间有一条权值为 $w$ 的边。\n\n接下来 $q$ 行，每行四个整数 $x,y,l,r$，表示一次询问。", "outputFormat": "输出 $q$ 行，每行一个整数，为每次询问的答案。", "hint": "**【样例解释】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/oew00pa7.png)\n\n输入给出的树如上图所示。对于点对的距离，有\n\n- $\\operatorname{dis}(1, 1) = \\operatorname{dis}(1, 3) = \\operatorname{dis}(2, 2) = \\operatorname{dis}(3, 1) = \\operatorname{dis}(3, 3) = 0$ 以及\n- $\\operatorname{dis}(1, 2) = \\operatorname{dis}(2, 1) = \\operatorname{dis}(2, 3) = \\operatorname{dis}(3, 2) = 1$。\n\n第 $1$ 问：$\\operatorname{val}_{1, 2}(1) \\oplus \\operatorname{val}_{1, 2}(2) \\oplus \\operatorname{val}_{1, 2}(3) = (0 \\oplus 1) \\oplus (1 \\oplus 0) \\oplus (0 \\oplus 1) = 1 \\oplus 1 \\oplus 1 = 1$。\n\n第 $2$ 问：$\\operatorname{val}_{2, 3}(2) \\oplus \\operatorname{val}_{2, 3}(3) = (0 \\oplus 1) \\oplus (1 \\oplus 0) = 1 \\oplus 1 = 0$。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | $n \\le$ | $q \\le$ | 分值 |\n| :----------: | :----------: | :----------: | :----------: |\n| 1 | $100$ | $10$ | 24 |\n| 2 | $10^6$ | $10$ | 14 |\n| 3 | $100$ | $10^6$ | 14 |\n| 4 | $10^6$ | $10^6$ | 48 |\n\n对于 $100\\%$ 的数据，保证 $1 \\le n, q \\le {10}^6$，$1 \\le u, v, x, y \\le n$，$1 \\le l \\le r \\le n$，$0 \\le w < 2^{31}$。\n\n---\n\n**【提示】**\n\n本题最大 I/O 量达到 60 MiB，请注意 I/O 效率。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "坠梦 | Falling into Dream", "background": "神明愚弄凡间，所谓命运，不过是神明掷出的一颗骰子而已。\n\n花朵等不到的蝴蝶，终究成了一分蹊跷的梦，一轮轮再次重启。\n\n神明的提线木偶一次又一次的被扼住脖颈, 以爱的名义，消逝在时间的花海里。\n\n无数的执念背后，都有一个被扭曲的“真理”。\n \n 你所承诺的没有出现，彻夜无眠，或许我只是自作主张的，替你爱了一次人间\n\n“最虔诚者只祝祷，不虔诚者才有所求。”\n\n没有过信仰，因为舍命救了一个人，有幸来到了天堂。\n ", "description": "给定一棵 $n$ 个结点的无根树，每条边有非负整数边权。结点由 $1 \\sim n$ 编号。\n\n对于每一个点对 $(x, y)$，定义 $(x, y)$ 的距离 $\\operatorname{dis}(x, y)$ 为 $x,y$ 两点之间唯一简单路径上边权的异或和。\n\n给定两个结点 $x, y$，定义点 $i$ 的价值 $\\operatorname{val}_{x, y}(i)$ 为 $(x, i)$ 与 $(y, i)$ 的距离的异或和，即\n\n$$ \\operatorname{val}_{x, y}(i) = \\operatorname{dis}(x, i) \\oplus \\operatorname{dis}(y, i) \\textsf{。} $$\n\n现在有 $q$ 次询问，每次询问给出四个整数 $x, y, l, r$，求 $\\displaystyle \\bigoplus_{i = l}^{r} \\operatorname{val}_{x, y}(i)$ 的值，即求\n\n$$ \\operatorname{val}_{x, y}(l) \\oplus \\operatorname{val}_{x, y}(l + 1) \\oplus \\cdots \\oplus \\operatorname{val}_{x, y}(r - 1) \\oplus \\operatorname{val}_{x, y}(r) \\textsf{。} $$\n\n上述公式中，$\\oplus$ 表示二进制按位异或。", "inputFormat": "第一行，两个整数 $n, q$。\n\n接下来 $n - 1$ 行，每行三个整数 $u, v, w$，表示 $u, v$ 之间有一条权值为 $w$ 的边。\n\n接下来 $q$ 行，每行四个整数 $x,y,l,r$，表示一次询问。", "outputFormat": "输出 $q$ 行，每行一个整数，为每次询问的答案。", "hint": "**【样例解释】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/oew00pa7.png)\n\n输入给出的树如上图所示。对于点对的距离，有\n\n- $\\operatorname{dis}(1, 1) = \\operatorname{dis}(1, 3) = \\operatorname{dis}(2, 2) = \\operatorname{dis}(3, 1) = \\operatorname{dis}(3, 3) = 0$ 以及\n- $\\operatorname{dis}(1, 2) = \\operatorname{dis}(2, 1) = \\operatorname{dis}(2, 3) = \\operatorname{dis}(3, 2) = 1$。\n\n第 $1$ 问：$\\operatorname{val}_{1, 2}(1) \\oplus \\operatorname{val}_{1, 2}(2) \\oplus \\operatorname{val}_{1, 2}(3) = (0 \\oplus 1) \\oplus (1 \\oplus 0) \\oplus (0 \\oplus 1) = 1 \\oplus 1 \\oplus 1 = 1$。\n\n第 $2$ 问：$\\operatorname{val}_{2, 3}(2) \\oplus \\operatorname{val}_{2, 3}(3) = (0 \\oplus 1) \\oplus (1 \\oplus 0) = 1 \\oplus 1 = 0$。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | $n \\le$ | $q \\le$ | 分值 |\n| :----------: | :----------: | :----------: | :----------: |\n| 1 | $100$ | $10$ | 24 |\n| 2 | $10^6$ | $10$ | 14 |\n| 3 | $100$ | $10^6$ | 14 |\n| 4 | $10^6$ | $10^6$ | 48 |\n\n对于 $100\\%$ 的数据，保证 $1 \\le n, q \\le {10}^6$，$1 \\le u, v, x, y \\le n$，$1 \\le l \\le r \\le n$，$0 \\le w < 2^{31}$。\n\n---\n\n**【提示】**\n\n本题最大 I/O 量达到 60 MiB，请注意 I/O 效率。", "locale": "zh-CN"}}}
{"pid": "P8966", "type": "P", "difficulty": 4, "samples": [["5\n1 1 2 2\n1 1 1 1 1\n", "5 4 2 3 3"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["博弈论", "洛谷原创", "O2优化", "洛谷月赛"], "title": "觅光 | Searching for Hope (easy ver.)", "background": "**这是本题的简单版本。两个版本在 $\\bm{100 \\%}$ 数据范围的唯一区别是关于 $\\bm{n}$ 的限制。此版本中 $\\bm{n \\le 1000}$。**\n\n---\n\n有梦中所向往的地方，也有现实中可望不可触及的远方。\n\n我们正等待无数次的希望，新的纪元，生命不曾奏响终章。\n\n顷刻间颠覆中的一切，天空坠落到海底，死死卡住呼吸者的全部。羽翼裹满刺骨的海水，悲伤到从此遗忘呼吸的意义。\n\n明明与空气只隔着毫厘，却不想再尝试去呼吸。我开始明白，悲伤到了极点，也许不会流泪\n\n神明借着生的名义，捏造出灰暗的真理。\n\n\n\n泪水模糊眼眶，身躯坠进天空，泛白的天光，不得已照亮这一日的希望。", "description": "现在有一棵 $n$ 个节点的有根二叉树。\n\n凡人与神明在这棵树上进行一个游戏。凡人需要从根投下若干个球，每个球带 $1$ 单位正电荷或带 $1$ 单位负电荷。\n\n树上每一个点有容量，第 $i$ 个点可以容纳 $c_i$ 个球。初始每一个点容纳的球数为 $0$。我们称一个点被充满当且仅当它容纳的球的个数等于它的容量。\n\n每一次一个球下落到一个点时：\n\n- 如果该点没有孩子节点或者所有孩子节点上都已经充满球，则停止，该点容纳的球的个数 $+1$；\n- 如果该点恰有一个孩子节点未充满，则向那个孩子下落；\n- 如果有 $2$ 个孩子节点均未充满：\n\t- 如果左侧子树中所有球的电荷代数和大于右侧子树所有球的电荷代数和，则如果当前球带正电则向右下落，否则向左下落；\n   - 如果左侧子树中所有球的电荷代数和小于右侧子树所有球的电荷代数和，则如果当前球带正电则向左下落，否则向右下落；\n   - 如果左侧子树中所有球的电荷代数和等于右侧子树所有球的电荷代数和，则由神明决定向哪个方向下落。\n   \n其中，电荷代数和指的是正电荷的数量减去负电荷的数量。\n   \n在游戏开始前，双方约定目标点 $u$。在一个回合中，凡人选择这次投下的球的电性，神明按上述规则控制球的下落过程。当 $u$ 被充满时，游戏结束。\n\n凡人希望游戏回合数尽量少，神明希望游戏回合数尽量多。假设双方足够聪明。\n\n对所有：$1\\leq u\\leq n$，求游戏轮数 $r_u$。", "inputFormat": "第一行，一个正整数 $n$。\n\n第二行，$n-1$ 个整数 $f_2, f_3, \\ldots, f_n$，其中 $f_i$ 代表 $i$ 的父亲的编号。\n\n第三行，$n$ 个整数 $c_1, c_2, \\ldots, c_n$。", "outputFormat": "输出一行，$n$ 个整数 $r_1, r_2, \\ldots, r_n$。", "hint": "**【数据范围】**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | $n \\le$ | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: |:-:|\n| 1 | $1000$ | A | 11 |\n| 2 | $10$ | B | 27 |\n| 3 | $1000$ | | 62 |\n\n- 特殊性质 A：树退化成一条以 $1$ 为一端的链。\n- 特殊性质 B：$c_i = 1$。\n\n对于 $100\\%$ 的数据，$2 \\le n \\le 1000$，满足树是以 $1$ 为根的二叉树，$1 \\le f_i < i$，$1 \\le c_i \\le {10}^{12}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "觅光 | Searching for Hope (easy ver.)", "background": "**这是本题的简单版本。两个版本在 $\\bm{100 \\%}$ 数据范围的唯一区别是关于 $\\bm{n}$ 的限制。此版本中 $\\bm{n \\le 1000}$。**\n\n---\n\n有梦中所向往的地方，也有现实中可望不可触及的远方。\n\n我们正等待无数次的希望，新的纪元，生命不曾奏响终章。\n\n顷刻间颠覆中的一切，天空坠落到海底，死死卡住呼吸者的全部。羽翼裹满刺骨的海水，悲伤到从此遗忘呼吸的意义。\n\n明明与空气只隔着毫厘，却不想再尝试去呼吸。我开始明白，悲伤到了极点，也许不会流泪\n\n神明借着生的名义，捏造出灰暗的真理。\n\n\n\n泪水模糊眼眶，身躯坠进天空，泛白的天光，不得已照亮这一日的希望。", "description": "现在有一棵 $n$ 个节点的有根二叉树。\n\n凡人与神明在这棵树上进行一个游戏。凡人需要从根投下若干个球，每个球带 $1$ 单位正电荷或带 $1$ 单位负电荷。\n\n树上每一个点有容量，第 $i$ 个点可以容纳 $c_i$ 个球。初始每一个点容纳的球数为 $0$。我们称一个点被充满当且仅当它容纳的球的个数等于它的容量。\n\n每一次一个球下落到一个点时：\n\n- 如果该点没有孩子节点或者所有孩子节点上都已经充满球，则停止，该点容纳的球的个数 $+1$；\n- 如果该点恰有一个孩子节点未充满，则向那个孩子下落；\n- 如果有 $2$ 个孩子节点均未充满：\n\t- 如果左侧子树中所有球的电荷代数和大于右侧子树所有球的电荷代数和，则如果当前球带正电则向右下落，否则向左下落；\n   - 如果左侧子树中所有球的电荷代数和小于右侧子树所有球的电荷代数和，则如果当前球带正电则向左下落，否则向右下落；\n   - 如果左侧子树中所有球的电荷代数和等于右侧子树所有球的电荷代数和，则由神明决定向哪个方向下落。\n   \n其中，电荷代数和指的是正电荷的数量减去负电荷的数量。\n   \n在游戏开始前，双方约定目标点 $u$。在一个回合中，凡人选择这次投下的球的电性，神明按上述规则控制球的下落过程。当 $u$ 被充满时，游戏结束。\n\n凡人希望游戏回合数尽量少，神明希望游戏回合数尽量多。假设双方足够聪明。\n\n对所有：$1\\leq u\\leq n$，求游戏轮数 $r_u$。", "inputFormat": "第一行，一个正整数 $n$。\n\n第二行，$n-1$ 个整数 $f_2, f_3, \\ldots, f_n$，其中 $f_i$ 代表 $i$ 的父亲的编号。\n\n第三行，$n$ 个整数 $c_1, c_2, \\ldots, c_n$。", "outputFormat": "输出一行，$n$ 个整数 $r_1, r_2, \\ldots, r_n$。", "hint": "**【数据范围】**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | $n \\le$ | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: |:-:|\n| 1 | $1000$ | A | 11 |\n| 2 | $10$ | B | 27 |\n| 3 | $1000$ | | 62 |\n\n- 特殊性质 A：树退化成一条以 $1$ 为一端的链。\n- 特殊性质 B：$c_i = 1$。\n\n对于 $100\\%$ 的数据，$2 \\le n \\le 1000$，满足树是以 $1$ 为根的二叉树，$1 \\le f_i < i$，$1 \\le c_i \\le {10}^{12}$。", "locale": "zh-CN"}}}
{"pid": "P8967", "type": "P", "difficulty": 6, "samples": [["2 1\n1 1\n0 0 50000000\n", "14\n"], ["2 1\n1 2\n0 0 20000000\n", "291154624\n"], ["3 3\n2 3 4\n2 1 0 30000000\n1 2 3 19000000\n2 3 4 1000000\n", "430536142\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "洛谷原创", "O2优化", "排列组合", "期望", "高斯消元", "洛谷月赛"], "title": "追寻 | Pursuit of Dream", "background": "“遇到自己喜欢的人或事情的时候，千万不要放弃”\n\n“要一直追寻下去…”\n\n“因为即使成功希望渺茫，也有可能”\n\n有谁和我说过这句话，脑海中忽然闪过一下，被当做无用的激励一同忘却了。现在想要回忆，却总也记不起来。\n\n好不容易来人间一趟，那就别留下遗憾。\n\n房檐落下的雨滴有规律的敲着石砖，那夜的雨声中，却也悄无声息了。\n\n逆着风吹干眼泪，说不出口的痛越藏越多，腐烂在肚子里，却又不知道彼此心知且肚明，所以无法孕育出美好的结局，只会是恋者相残的戏码不停上演。\n\n---\n\n 看见了漫天星野坠落在你的眼底，从此甘愿在那海底般低压的梦境中堕落。\n\n三千尺星空的光辉映照不出那人的身影，璀璨中徒留神明思故人；那人却散入了或许碎散的星辰大海，让神明寻觅了一生。\n\n那些无法兑现的渴望，会日渐荒芜，然后梦境会失去生机，裂缝中会蔓出黑暗，泪无葬身之地。\n\n是神明告诉我的，可是我不信，因为没有时间还等着我空想了。\n\n神明还说，人死了以后，提前离开的亲人都会在另外一个世界等你。\n\n其实，我也会想，这一定就是另外一个世界。", "description": "在 $n$ 维空间中有一个梦想。这梦想坐落在 $(d_1, d_2, \\ldots, d_n)$ 的地方。而你从 $(0, 0, \\ldots, 0)$ 开始，开启寻梦的旅程。\n\n你的步伐轻缓，每一步只能走一个单位长度。你并不知道你的梦想位于哪里，所以你只能随机选择 $n$ 个正方向中的一个，然后向这个方向走一步。也就是说，在 $[1, n]$ 中均匀随机选择一个正整数 $h$，然后，使你在第 $h$ 维的坐标变成原来的坐标加一。\n\n然而，天有不测风云。在你走每一步的过程中，你会有 $p = \\sum_{i = 1}^k p_i$ 的概率散入天际，并开始一段新的旅程。你会在 $k$ 个地点中的一个重新开始这段旅程，其中第 $i$ 个地点的坐标是 $(a_{i,1}, a_{i,2}, \\ldots, a_{i,n})$，从这里重新开始的概率为 $p_i$。\n\n那么，期望下，你离到达这个梦想还需要多少步呢？", "inputFormat": "第一行，两个正整数 $n,k$。\n\n第二行，$n$ 个非负整数 $d_1, d_2, \\ldots, d_n$。\n\n接下来 $k$ 行，第 $i$ 行 $n + 1$ 个整数 $a_{i, 1}, a_{i, 2}, \\ldots, a_{i, n}, x_i$，每行最后一个整数 $x_i$ 表示 $p_i=x_i\\times 10^{-8}$。\n\n输入的 $x_i$ 保证了 $p_i > 0$ 且 $p < 1$。\n\n保证每个 $x_i$ 在所有可能的组合中等概率随机生成。", "outputFormat": "一行，一个整数，表示答案对 $998244353$ 取模的结果。\n\n如果你不知道如何进行实数取模：可以说明答案一定是有限的，且是有理数，设它的最简分数形式为 $\\frac{p}{q}$。如果存在一个整数 $x$ 满足 $x \\cdot q \\equiv p \\pmod{998244353}$ 且 $0 \\le x < 998244353$，那么你只需输出 $x$ 的值即可。\n\n由于保证了 $x_i$ 是随机生成的，可以说明以接近 $1$ 的概率答案在模意义下存在。事实上，一个当 $x_i$ 尚不确定时以合理地高的概率给出正确答案的算法足以通过本题，考察复杂的模意义下的有理数的处理不是我们的本意。", "hint": "**【样例解释 \\#1】**\n\n这是你的一种追寻梦想的方式：\n\n你从 $(0,0)$ 出发，走一步到 $(1,0)$，再走一步到 $(2,0)$，再走一步到 $(3,0)$，但是在路上散入天际，从 $(0,0)$ 重新开始旅程。\n\n然后继续从 $(0,0)$ 出发，走一步到 $(0,1)$，再走一步到 $(1,1)$，但是在路上散入天际，从 $(0,0)$ 重新开始旅程。\n\n接着从 $(0,0)$ 出发，走一步到 $(1,0)$，再走一步到 $(1,1)$，找到了你的梦想。\n\n在这种情况下，你需要 $7$ 步到达这个梦想。发生这种情况的概率是 $4^{-7}$。\n\n---\n\n**【样例解释 \\#2】**\n\n答案为 $\\frac{505}{24} \\approx 21.041667$。  \n不难验证 $291154624 \\times 24 \\equiv 505 \\pmod{998244353}$，故应输出 $291154624$。\n\n---\n\n**【样例解释 \\#3】**\n\n答案为 $\\frac{1399505}{21519} \\approx 65.035782$。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试且使用子任务依赖。**\n\n| 子任务编号 | 特殊限制 | 分值 |\n| :----------: | :----------: | :----------: |\n| 1 | $n=1$，$k=1$ | 11 |\n| 2 | $n=1$ | 12 |\n| 3 | $k=1$ | 12 |\n| 4 | $n=2$，$1 \\le d_1 \\cdot d_2 \\le 200$ | 13 |\n| 5 | $k \\le 200$ | 22 |\n| 6 | 无特殊限制 | 30 |\n\n对于 $100 \\%$ 的数据：\n\n- $1 \\le n \\le 100$，$1 \\le k \\le 10000$。\n- $d_i \\ge 0$，$\\sum_i d_i \\le 10^7$。\n- $0 \\le a_{i, j} \\le {10}^7$。\n- $x_i \\ge 1$，$\\sum_i x_i < {10}^8$。此即保证了 $p_i > 0$ 和 $p < 1$。\n- 保证存在一个 $i \\in [1, k]$ 使得对于每个 $j \\in [1, n]$ 均有 $a_{i,j} \\le d_j$。\n- 保证每个 $(a_{i, 1}, a_{i, 2}, \\ldots, a_{i, n})$ 作为空间中的点互不相同。\n- 保证每个 $x_i$ 在所有可能的组合中等概率随机生成。\n\n---\n\n**【提示】**\n\n由于保证了 $x_i$ 是随机生成的，可以说明以接近 $1$ 的概率答案在模意义下存在。事实上，一个当 $x_i$ 尚不确定时以合理地高的概率给出正确答案的算法足以通过本题，考察复杂的模意义下的有理数的处理不是我们的本意。\n\n样例中的 $x_i$ 不是随机生成的，仅为理解题意所用。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "追寻 | Pursuit of Dream", "background": "“遇到自己喜欢的人或事情的时候，千万不要放弃”\n\n“要一直追寻下去…”\n\n“因为即使成功希望渺茫，也有可能”\n\n有谁和我说过这句话，脑海中忽然闪过一下，被当做无用的激励一同忘却了。现在想要回忆，却总也记不起来。\n\n好不容易来人间一趟，那就别留下遗憾。\n\n房檐落下的雨滴有规律的敲着石砖，那夜的雨声中，却也悄无声息了。\n\n逆着风吹干眼泪，说不出口的痛越藏越多，腐烂在肚子里，却又不知道彼此心知且肚明，所以无法孕育出美好的结局，只会是恋者相残的戏码不停上演。\n\n---\n\n 看见了漫天星野坠落在你的眼底，从此甘愿在那海底般低压的梦境中堕落。\n\n三千尺星空的光辉映照不出那人的身影，璀璨中徒留神明思故人；那人却散入了或许碎散的星辰大海，让神明寻觅了一生。\n\n那些无法兑现的渴望，会日渐荒芜，然后梦境会失去生机，裂缝中会蔓出黑暗，泪无葬身之地。\n\n是神明告诉我的，可是我不信，因为没有时间还等着我空想了。\n\n神明还说，人死了以后，提前离开的亲人都会在另外一个世界等你。\n\n其实，我也会想，这一定就是另外一个世界。", "description": "在 $n$ 维空间中有一个梦想。这梦想坐落在 $(d_1, d_2, \\ldots, d_n)$ 的地方。而你从 $(0, 0, \\ldots, 0)$ 开始，开启寻梦的旅程。\n\n你的步伐轻缓，每一步只能走一个单位长度。你并不知道你的梦想位于哪里，所以你只能随机选择 $n$ 个正方向中的一个，然后向这个方向走一步。也就是说，在 $[1, n]$ 中均匀随机选择一个正整数 $h$，然后，使你在第 $h$ 维的坐标变成原来的坐标加一。\n\n然而，天有不测风云。在你走每一步的过程中，你会有 $p = \\sum_{i = 1}^k p_i$ 的概率散入天际，并开始一段新的旅程。你会在 $k$ 个地点中的一个重新开始这段旅程，其中第 $i$ 个地点的坐标是 $(a_{i,1}, a_{i,2}, \\ldots, a_{i,n})$，从这里重新开始的概率为 $p_i$。\n\n那么，期望下，你离到达这个梦想还需要多少步呢？", "inputFormat": "第一行，两个正整数 $n,k$。\n\n第二行，$n$ 个非负整数 $d_1, d_2, \\ldots, d_n$。\n\n接下来 $k$ 行，第 $i$ 行 $n + 1$ 个整数 $a_{i, 1}, a_{i, 2}, \\ldots, a_{i, n}, x_i$，每行最后一个整数 $x_i$ 表示 $p_i=x_i\\times 10^{-8}$。\n\n输入的 $x_i$ 保证了 $p_i > 0$ 且 $p < 1$。\n\n保证每个 $x_i$ 在所有可能的组合中等概率随机生成。", "outputFormat": "一行，一个整数，表示答案对 $998244353$ 取模的结果。\n\n如果你不知道如何进行实数取模：可以说明答案一定是有限的，且是有理数，设它的最简分数形式为 $\\frac{p}{q}$。如果存在一个整数 $x$ 满足 $x \\cdot q \\equiv p \\pmod{998244353}$ 且 $0 \\le x < 998244353$，那么你只需输出 $x$ 的值即可。\n\n由于保证了 $x_i$ 是随机生成的，可以说明以接近 $1$ 的概率答案在模意义下存在。事实上，一个当 $x_i$ 尚不确定时以合理地高的概率给出正确答案的算法足以通过本题，考察复杂的模意义下的有理数的处理不是我们的本意。", "hint": "**【样例解释 \\#1】**\n\n这是你的一种追寻梦想的方式：\n\n你从 $(0,0)$ 出发，走一步到 $(1,0)$，再走一步到 $(2,0)$，再走一步到 $(3,0)$，但是在路上散入天际，从 $(0,0)$ 重新开始旅程。\n\n然后继续从 $(0,0)$ 出发，走一步到 $(0,1)$，再走一步到 $(1,1)$，但是在路上散入天际，从 $(0,0)$ 重新开始旅程。\n\n接着从 $(0,0)$ 出发，走一步到 $(1,0)$，再走一步到 $(1,1)$，找到了你的梦想。\n\n在这种情况下，你需要 $7$ 步到达这个梦想。发生这种情况的概率是 $4^{-7}$。\n\n---\n\n**【样例解释 \\#2】**\n\n答案为 $\\frac{505}{24} \\approx 21.041667$。  \n不难验证 $291154624 \\times 24 \\equiv 505 \\pmod{998244353}$，故应输出 $291154624$。\n\n---\n\n**【样例解释 \\#3】**\n\n答案为 $\\frac{1399505}{21519} \\approx 65.035782$。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试且使用子任务依赖。**\n\n| 子任务编号 | 特殊限制 | 分值 |\n| :----------: | :----------: | :----------: |\n| 1 | $n=1$，$k=1$ | 11 |\n| 2 | $n=1$ | 12 |\n| 3 | $k=1$ | 12 |\n| 4 | $n=2$，$1 \\le d_1 \\cdot d_2 \\le 200$ | 13 |\n| 5 | $k \\le 200$ | 22 |\n| 6 | 无特殊限制 | 30 |\n\n对于 $100 \\%$ 的数据：\n\n- $1 \\le n \\le 100$，$1 \\le k \\le 10000$。\n- $d_i \\ge 0$，$\\sum_i d_i \\le 10^7$。\n- $0 \\le a_{i, j} \\le {10}^7$。\n- $x_i \\ge 1$，$\\sum_i x_i < {10}^8$。此即保证了 $p_i > 0$ 和 $p < 1$。\n- 保证存在一个 $i \\in [1, k]$ 使得对于每个 $j \\in [1, n]$ 均有 $a_{i,j} \\le d_j$。\n- 保证每个 $(a_{i, 1}, a_{i, 2}, \\ldots, a_{i, n})$ 作为空间中的点互不相同。\n- 保证每个 $x_i$ 在所有可能的组合中等概率随机生成。\n\n---\n\n**【提示】**\n\n由于保证了 $x_i$ 是随机生成的，可以说明以接近 $1$ 的概率答案在模意义下存在。事实上，一个当 $x_i$ 尚不确定时以合理地高的概率给出正确答案的算法足以通过本题，考察复杂的模意义下的有理数的处理不是我们的本意。\n\n样例中的 $x_i$ 不是随机生成的，仅为理解题意所用。", "locale": "zh-CN"}}}
{"pid": "P8968", "type": "P", "difficulty": 6, "samples": [["5\n1 1 2 2\n1 1 1 1 1\n", "5 4 2 3 3"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["暴力数据结构", "博弈论", "洛谷原创", "O2优化", "洛谷月赛"], "title": "觅光 | Searching for Hope (hard ver.)", "background": "**这是本题的困难版本。两个版本在 $\\bm{100 \\%}$ 数据范围的唯一区别是关于 $\\bm{n}$ 的限制。此版本中 $\\bm{n \\le {10}^6}$。**\n\n---\n\n有梦中所向往的地方，也有现实中可望不可触及的远方。\n\n我们正等待无数次的希望，新的纪元，生命不曾奏响终章。\n\n顷刻间颠覆中的一切，天空坠落到海底，死死卡住呼吸者的全部。羽翼裹满刺骨的海水，悲伤到从此遗忘呼吸的意义。\n\n明明与空气只隔着毫厘，却不想再尝试去呼吸。我开始明白，悲伤到了极点，也许不会流泪\n\n神明借着生的名义，捏造出灰暗的真理。\n\n\n\n泪水模糊眼眶，身躯坠进天空，泛白的天光，不得已照亮这一日的希望。", "description": "现在有一棵 $n$ 个节点的有根二叉树。\n\n凡人与神明在这棵树上进行一个游戏。凡人需要从根投下若干个球，每个球带 $1$ 单位正电荷或带 $1$ 单位负电荷。\n\n树上每一个点有容量，第 $i$ 个点可以容纳 $c_i$ 个球。初始每一个点容纳的球数为 $0$。我们称一个点被充满当且仅当它容纳的球的个数等于它的容量。\n\n每一次一个球下落到一个点时：\n\n- 如果该点没有孩子节点或者所有孩子节点上都已经充满球，则停止，该点容纳的球的个数 $+1$；\n- 如果该点恰有一个孩子节点未充满，则向那个孩子下落；\n- 如果有 $2$ 个孩子节点均未充满：\n\t- 如果左侧子树中所有球的电荷代数和大于右侧子树所有球的电荷代数和，则如果当前球带正电则向右下落，否则向左下落；\n   - 如果左侧子树中所有球的电荷代数和小于右侧子树所有球的电荷代数和，则如果当前球带正电则向左下落，否则向右下落；\n   - 如果左侧子树中所有球的电荷代数和等于右侧子树所有球的电荷代数和，则由神明决定向哪个方向下落。\n\n其中，电荷代数和指的是正电荷的数量减去负电荷的数量。\n\n在游戏开始前，双方约定目标点 $u$。在一个回合中，凡人选择这次投下的球的电性，神明按上述规则控制球的下落过程。当 $u$ 被充满时，游戏结束。\n\n凡人希望游戏回合数尽量少，神明希望游戏回合数尽量多。假设双方足够聪明。\n\n对所有：$1\\leq u\\leq n$，求游戏轮数 $r_u$。", "inputFormat": "第一行，一个正整数 $n$。\n\n第二行，$n-1$ 个整数 $f_2, f_3, \\ldots, f_n$，其中 $f_i$ 代表 $i$ 的父亲的编号。\n\n第三行，$n$ 个整数 $c_1, c_2, \\ldots, c_n$。", "outputFormat": "输出一行，$n$ 个整数 $r_1, r_2, \\ldots, r_n$。", "hint": "**【数据范围】**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | $n \\le$ | 分值 |\n| :----------: | :----------: | :----------: |\n| 4 | ${10}^5$ | 33 |\n| 5 | ${10}^6$ | 67 |\n\n对于 $100\\%$ 的数据，$2 \\le n \\le {10}^6$，满足树是以 $1$ 为根的二叉树，$1 \\le f_i < i$，$1 \\le c_i \\le {10}^{12}$。\n\n---\n\n**【提示】**\n\n本题最大 I/O 量达到 20 MiB，请注意 I/O 效率。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "觅光 | Searching for Hope (hard ver.)", "background": "**这是本题的困难版本。两个版本在 $\\bm{100 \\%}$ 数据范围的唯一区别是关于 $\\bm{n}$ 的限制。此版本中 $\\bm{n \\le {10}^6}$。**\n\n---\n\n有梦中所向往的地方，也有现实中可望不可触及的远方。\n\n我们正等待无数次的希望，新的纪元，生命不曾奏响终章。\n\n顷刻间颠覆中的一切，天空坠落到海底，死死卡住呼吸者的全部。羽翼裹满刺骨的海水，悲伤到从此遗忘呼吸的意义。\n\n明明与空气只隔着毫厘，却不想再尝试去呼吸。我开始明白，悲伤到了极点，也许不会流泪\n\n神明借着生的名义，捏造出灰暗的真理。\n\n\n\n泪水模糊眼眶，身躯坠进天空，泛白的天光，不得已照亮这一日的希望。", "description": "现在有一棵 $n$ 个节点的有根二叉树。\n\n凡人与神明在这棵树上进行一个游戏。凡人需要从根投下若干个球，每个球带 $1$ 单位正电荷或带 $1$ 单位负电荷。\n\n树上每一个点有容量，第 $i$ 个点可以容纳 $c_i$ 个球。初始每一个点容纳的球数为 $0$。我们称一个点被充满当且仅当它容纳的球的个数等于它的容量。\n\n每一次一个球下落到一个点时：\n\n- 如果该点没有孩子节点或者所有孩子节点上都已经充满球，则停止，该点容纳的球的个数 $+1$；\n- 如果该点恰有一个孩子节点未充满，则向那个孩子下落；\n- 如果有 $2$ 个孩子节点均未充满：\n\t- 如果左侧子树中所有球的电荷代数和大于右侧子树所有球的电荷代数和，则如果当前球带正电则向右下落，否则向左下落；\n   - 如果左侧子树中所有球的电荷代数和小于右侧子树所有球的电荷代数和，则如果当前球带正电则向左下落，否则向右下落；\n   - 如果左侧子树中所有球的电荷代数和等于右侧子树所有球的电荷代数和，则由神明决定向哪个方向下落。\n\n其中，电荷代数和指的是正电荷的数量减去负电荷的数量。\n\n在游戏开始前，双方约定目标点 $u$。在一个回合中，凡人选择这次投下的球的电性，神明按上述规则控制球的下落过程。当 $u$ 被充满时，游戏结束。\n\n凡人希望游戏回合数尽量少，神明希望游戏回合数尽量多。假设双方足够聪明。\n\n对所有：$1\\leq u\\leq n$，求游戏轮数 $r_u$。", "inputFormat": "第一行，一个正整数 $n$。\n\n第二行，$n-1$ 个整数 $f_2, f_3, \\ldots, f_n$，其中 $f_i$ 代表 $i$ 的父亲的编号。\n\n第三行，$n$ 个整数 $c_1, c_2, \\ldots, c_n$。", "outputFormat": "输出一行，$n$ 个整数 $r_1, r_2, \\ldots, r_n$。", "hint": "**【数据范围】**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | $n \\le$ | 分值 |\n| :----------: | :----------: | :----------: |\n| 4 | ${10}^5$ | 33 |\n| 5 | ${10}^6$ | 67 |\n\n对于 $100\\%$ 的数据，$2 \\le n \\le {10}^6$，满足树是以 $1$ 为根的二叉树，$1 \\le f_i < i$，$1 \\le c_i \\le {10}^{12}$。\n\n---\n\n**【提示】**\n\n本题最大 I/O 量达到 20 MiB，请注意 I/O 效率。", "locale": "zh-CN"}}}
{"pid": "P8969", "type": "P", "difficulty": 6, "samples": [["5 5\n1 2 3 4 5\nJ 2\nA 2 4 3\nJ 4\nP 1 4\nJ 3\n", "2\n7\n2\n"]], "limits": {"time": [10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["线段树", "洛谷原创", "O2优化", "洛谷月赛", "均摊分析", "线段树合并"], "title": "幻梦 | Dream with Dynamic", "background": "“那以后见到她，会不会笑出来啊？”\n\n“哈，一时半会见不到她的。”\n\n小时候说要一起去看尘寰间的人间烟火，有人欣然接受，长大了说遗忘过去，那人也没有反驳。\n\n其实吧，她们彼此明白，小时候在意的不是什么人间烟火，而是一起。\n\n黑夜里，没有早晨的绯红，也褪去了天边的白光，留下的是她心头的散不去的灰暗。没有星光璀璨，没有满天繁星，她不在乎。她在乎的是那个人心中闪烁的星辰大海。\n\n----\n\n察觉所谓规则秘密，不过取悦于创世神明，早已知晓光明同黑暗般腥风血雨\n\n", "description": "有一个长度为 $n$ 的序列，开始时第 $i$ 位为 $a_i$。你需要完成 $q$ 次操作：\n\n- `A l r x`，对于所有的 $l\\le i\\le r$，令 $a_i\\gets a_i+x$。\n- `P l r`，对于所有的 $l\\le i\\le r$，令 $a_i\\gets\\operatorname{popcount}(a_i)$。\n- `J p`，查询 $a_p$ 的值。\n\n注：$\\operatorname{popcount}(x)$ 为 $x$ 的二进制表示中 $1$ 的个数。", "inputFormat": "第一行两个正整数 $n,q$。\n\n第二行 $n$ 个正整数 $a_1, a_2, \\ldots, a_n$。\n\n接下来 $q$ 行，每行描述一个操作，形如以下三种中的一种：\n\n- `A l r x`\n- `P l r`\n- `J p`", "outputFormat": "对于每个 `J` 操作，输出一行，一个整数，表示答案。", "hint": "**【样例解释】**\n\n- 开始时，$a = [1, 2, 3, 4, 5]$。\n- 对询问 `J 2`，应回答 $a_2 = 2$。\n- 操作 `A 2 4 3` 后，$a = [1, 5, 6, 7, 5]$。\n- 对询问 `J 4`，应回答 $a_4 = 7$。\n- 操作 `P 1 4` 后，$a = [1, 2, 2, 3, 5]$。\n- 对询问 `J 3`，应回答 $a_3 = 2$。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | 特殊限制 | 分值 |\n| :----------: | :----------: | :----------: |\n| 1 |$n,q\\le 2000$| 3 |\n| 2 |没有 `P` 操作| 7 |\n| 3 |没有 `A` 操作| 15 |\n| 4 |数据随机生成| 15 |\n| 5 |无特殊限制| 60 |\n\n对于全部数据，保证 $1\\leq n\\leq 3\\times 10^5$，$1 \\le q \\le 10^6$，$1 \\le l \\le r \\le n$，$1 \\le p \\le n$，$1\\le a_i, x\\le 10^9$。\n\n子任务 4 的随机方式：\n\n- 取 $n=3\\times 10^5$，$q=10^6$；\n- $a_i$ 从 $[1,10^9]$ 均匀随机选取；\n- 对于每一个操作：\n\t- 从 3 种操作中均匀随机选取一个；\n   - 如果是 `A` 操作，均匀随机从 $[1,n]$ 中选取 2 个整数，将较小的作为区间左端点，较大的作为区间右端点，再从 $[1,10^9]$ 中选取一个整数作为参数 `x`；\n   - 如果是 `P` 操作，均匀随机从 $[1,n]$ 中选取 2 个整数，将较小的作为区间左端点，较大的作为区间右端点；\n   - 如果是 `J` 操作，均匀随机从 $[1,n]$ 中选取一个整数作为参数 `p`。\n\n---\n\n**【提示】**\n\n本题最大 I/O 量达到 30 MiB，请注意 I/O 效率。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "幻梦 | Dream with Dynamic", "background": "“那以后见到她，会不会笑出来啊？”\n\n“哈，一时半会见不到她的。”\n\n小时候说要一起去看尘寰间的人间烟火，有人欣然接受，长大了说遗忘过去，那人也没有反驳。\n\n其实吧，她们彼此明白，小时候在意的不是什么人间烟火，而是一起。\n\n黑夜里，没有早晨的绯红，也褪去了天边的白光，留下的是她心头的散不去的灰暗。没有星光璀璨，没有满天繁星，她不在乎。她在乎的是那个人心中闪烁的星辰大海。\n\n----\n\n察觉所谓规则秘密，不过取悦于创世神明，早已知晓光明同黑暗般腥风血雨\n\n", "description": "有一个长度为 $n$ 的序列，开始时第 $i$ 位为 $a_i$。你需要完成 $q$ 次操作：\n\n- `A l r x`，对于所有的 $l\\le i\\le r$，令 $a_i\\gets a_i+x$。\n- `P l r`，对于所有的 $l\\le i\\le r$，令 $a_i\\gets\\operatorname{popcount}(a_i)$。\n- `J p`，查询 $a_p$ 的值。\n\n注：$\\operatorname{popcount}(x)$ 为 $x$ 的二进制表示中 $1$ 的个数。", "inputFormat": "第一行两个正整数 $n,q$。\n\n第二行 $n$ 个正整数 $a_1, a_2, \\ldots, a_n$。\n\n接下来 $q$ 行，每行描述一个操作，形如以下三种中的一种：\n\n- `A l r x`\n- `P l r`\n- `J p`", "outputFormat": "对于每个 `J` 操作，输出一行，一个整数，表示答案。", "hint": "**【样例解释】**\n\n- 开始时，$a = [1, 2, 3, 4, 5]$。\n- 对询问 `J 2`，应回答 $a_2 = 2$。\n- 操作 `A 2 4 3` 后，$a = [1, 5, 6, 7, 5]$。\n- 对询问 `J 4`，应回答 $a_4 = 7$。\n- 操作 `P 1 4` 后，$a = [1, 2, 2, 3, 5]$。\n- 对询问 `J 3`，应回答 $a_3 = 2$。\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | 特殊限制 | 分值 |\n| :----------: | :----------: | :----------: |\n| 1 |$n,q\\le 2000$| 3 |\n| 2 |没有 `P` 操作| 7 |\n| 3 |没有 `A` 操作| 15 |\n| 4 |数据随机生成| 15 |\n| 5 |无特殊限制| 60 |\n\n对于全部数据，保证 $1\\leq n\\leq 3\\times 10^5$，$1 \\le q \\le 10^6$，$1 \\le l \\le r \\le n$，$1 \\le p \\le n$，$1\\le a_i, x\\le 10^9$。\n\n子任务 4 的随机方式：\n\n- 取 $n=3\\times 10^5$，$q=10^6$；\n- $a_i$ 从 $[1,10^9]$ 均匀随机选取；\n- 对于每一个操作：\n\t- 从 3 种操作中均匀随机选取一个；\n   - 如果是 `A` 操作，均匀随机从 $[1,n]$ 中选取 2 个整数，将较小的作为区间左端点，较大的作为区间右端点，再从 $[1,10^9]$ 中选取一个整数作为参数 `x`；\n   - 如果是 `P` 操作，均匀随机从 $[1,n]$ 中选取 2 个整数，将较小的作为区间左端点，较大的作为区间右端点；\n   - 如果是 `J` 操作，均匀随机从 $[1,n]$ 中选取一个整数作为参数 `p`。\n\n---\n\n**【提示】**\n\n本题最大 I/O 量达到 30 MiB，请注意 I/O 效率。", "locale": "zh-CN"}}}
{"pid": "P8970", "type": "P", "difficulty": 7, "samples": [["1 1\n1 1\n", "1\n"], ["3 2\n1 2\n1 3\n2 1\n111111 1111111\n3 45\n", "2\n"], ["4 2\n1 2\n1 3\n2 4\n3 1\n2 1\n1 1\n1 2\n", "2\n"]], "limits": {"time": [600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "O2优化", "分治", "树形 DP", "洛谷月赛", "状压 DP"], "title": "宿命 | Regulation of Destiny", "background": "压抑是有实质的，从躯壳到内脏，密不透风地包裹，药物仅仅像缝隙里挤进去的一滴水，浇不灭深幽的火焰。\n\n时间治愈不了一切，它只把泥泞日复一日地堆积。她的眼睛没有焦点，偶尔仿佛睡梦中惊醒，喊我的名字。\n\n街道乱糟糟，各家店铺放着音乐，公交车轮胎碾过柏油路，小孩打闹，玻璃瓶砸碎，电瓶车相撞……但我清楚地听见自己的呼吸声。后视镜里，我又一次看到她没有焦点的眼神，裹住眼球的眼泪，水的表面张力“嗒”的一声失效。\n\n\n撕开雨天，潜入他乡，所向往的尽头是天堂。\n\n浅蓝天光，云层泛紫，微弱的灯光嵌进夕阳。\n \n----\n \n \n “…你知道吗，所谓的力量，其实，就是心中的执念。”\n \n “执念？”\n \n “是啊…就是，必须要做的事，必须守护的人，必须…”\n \n “实现的心愿。”\n \n “那么…你心中有这样的执念吗？”\n \n “呃……有啊！我的执念，就是保护姐姐！”\n \n “傻小子，想保护你姐，等下辈子再说吧”\n \n", "description": "A 国为了防御 B 国的进攻，准备兴建一系列防御措施。\n\nA 国有 $n$ 艘恒星级战舰，这些战舰无论如何都是要被保护的。为了节省材料，总司令用了 $n-1$ 条双向加速通道将这些战舰连接了起来。每个战舰有两个属性 $a_i,b_i$，分别代表战舰的人口数，科技程度。\n\n在每艘战舰上有两种防御措施可以选择。你可以选择建设其中的一种，也可以选择不建设，但不能两种都建设。\n\n在 $i$ 号战舰上建设 I 类防御措施需要 $a_i$ 的金钱，可以保护 $i$ 号战舰本身和与其直接相连的战舰。\n\n在 $i$ 号战舰上建设 II 类防御措施需要 $b_i$ 的金钱，可以保护 $i$ 号战舰本身以及所有与 $i$ 号战舰的距离**恰好**为 $r$ 的战舰。\n\n定义战舰 $u$ 和战舰 $v$ 的距离为从 $u$ 到 $v$ 需要经过最少多少条加速通道。\n\n现在，请你求出保护所有战舰需要的最少金钱。", "inputFormat": "第一行，两个正整数 $n, r$。\n\n接下来 $n-1$ 行，每行两个正整数 $u, v$，代表一条通道所连接的两艘战舰编号为 $u, v$。\n\n接下来 $n$ 行，第 $i$ 行两个正整数 $a_i, b_i$，分别表示在 $i$ 号战舰上建设 I 类和 II 类防御措施所需要的金钱。", "outputFormat": "一行，一个整数，表示保护所有战舰需要的最少金钱。", "hint": "**【样例解释 \\#1】**\n\n在 $1$ 号战舰上建设任意一种防御措施，所花金钱为 $1$。\n\n---\n\n**【样例解释 \\#2】**\n\n在 $1$ 号战舰上建设 I 类防御措施，所花金钱为 $2$。\n\n---\n\n**【样例解释 \\#3】**\n\n在 $1,2$ 号战舰上各建设一个 II 类防御措施，所花金钱为 $2$。\n\n------------\n\n**【数据范围】**\n\n**本题采用捆绑测试且使用子任务依赖。**\n\n| 子任务编号 | $n \\le$ | $r \\le$ | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| 1 | $10$ | $5$ | 5 |\n| 2 | $200$ | $1$ | 5 |\n| 3 | $20$ | $7$ | 10 |\n| 4 | $100$ | $2$ | 8 |\n| 5 | $100$ | $4$ | 11 |\n| 6 | $100$ | $5$ | 8 |\n| 7 | $200$ | $6$ | 34 |\n| 8 | $200$ | $7$ | 19 |\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 200$，$1 \\le r \\le 7$，$1 \\le a_i, b_i \\le {10}^9$，$1 \\le u, v \\le n$，保证任意两艘战舰可以通过若干条加速通道到达。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "宿命 | Regulation of Destiny", "background": "压抑是有实质的，从躯壳到内脏，密不透风地包裹，药物仅仅像缝隙里挤进去的一滴水，浇不灭深幽的火焰。\n\n时间治愈不了一切，它只把泥泞日复一日地堆积。她的眼睛没有焦点，偶尔仿佛睡梦中惊醒，喊我的名字。\n\n街道乱糟糟，各家店铺放着音乐，公交车轮胎碾过柏油路，小孩打闹，玻璃瓶砸碎，电瓶车相撞……但我清楚地听见自己的呼吸声。后视镜里，我又一次看到她没有焦点的眼神，裹住眼球的眼泪，水的表面张力“嗒”的一声失效。\n\n\n撕开雨天，潜入他乡，所向往的尽头是天堂。\n\n浅蓝天光，云层泛紫，微弱的灯光嵌进夕阳。\n \n----\n \n \n “…你知道吗，所谓的力量，其实，就是心中的执念。”\n \n “执念？”\n \n “是啊…就是，必须要做的事，必须守护的人，必须…”\n \n “实现的心愿。”\n \n “那么…你心中有这样的执念吗？”\n \n “呃……有啊！我的执念，就是保护姐姐！”\n \n “傻小子，想保护你姐，等下辈子再说吧”\n \n", "description": "A 国为了防御 B 国的进攻，准备兴建一系列防御措施。\n\nA 国有 $n$ 艘恒星级战舰，这些战舰无论如何都是要被保护的。为了节省材料，总司令用了 $n-1$ 条双向加速通道将这些战舰连接了起来。每个战舰有两个属性 $a_i,b_i$，分别代表战舰的人口数，科技程度。\n\n在每艘战舰上有两种防御措施可以选择。你可以选择建设其中的一种，也可以选择不建设，但不能两种都建设。\n\n在 $i$ 号战舰上建设 I 类防御措施需要 $a_i$ 的金钱，可以保护 $i$ 号战舰本身和与其直接相连的战舰。\n\n在 $i$ 号战舰上建设 II 类防御措施需要 $b_i$ 的金钱，可以保护 $i$ 号战舰本身以及所有与 $i$ 号战舰的距离**恰好**为 $r$ 的战舰。\n\n定义战舰 $u$ 和战舰 $v$ 的距离为从 $u$ 到 $v$ 需要经过最少多少条加速通道。\n\n现在，请你求出保护所有战舰需要的最少金钱。", "inputFormat": "第一行，两个正整数 $n, r$。\n\n接下来 $n-1$ 行，每行两个正整数 $u, v$，代表一条通道所连接的两艘战舰编号为 $u, v$。\n\n接下来 $n$ 行，第 $i$ 行两个正整数 $a_i, b_i$，分别表示在 $i$ 号战舰上建设 I 类和 II 类防御措施所需要的金钱。", "outputFormat": "一行，一个整数，表示保护所有战舰需要的最少金钱。", "hint": "**【样例解释 \\#1】**\n\n在 $1$ 号战舰上建设任意一种防御措施，所花金钱为 $1$。\n\n---\n\n**【样例解释 \\#2】**\n\n在 $1$ 号战舰上建设 I 类防御措施，所花金钱为 $2$。\n\n---\n\n**【样例解释 \\#3】**\n\n在 $1,2$ 号战舰上各建设一个 II 类防御措施，所花金钱为 $2$。\n\n------------\n\n**【数据范围】**\n\n**本题采用捆绑测试且使用子任务依赖。**\n\n| 子任务编号 | $n \\le$ | $r \\le$ | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| 1 | $10$ | $5$ | 5 |\n| 2 | $200$ | $1$ | 5 |\n| 3 | $20$ | $7$ | 10 |\n| 4 | $100$ | $2$ | 8 |\n| 5 | $100$ | $4$ | 11 |\n| 6 | $100$ | $5$ | 8 |\n| 7 | $200$ | $6$ | 34 |\n| 8 | $200$ | $7$ | 19 |\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 200$，$1 \\le r \\le 7$，$1 \\le a_i, b_i \\le {10}^9$，$1 \\le u, v \\le n$，保证任意两艘战舰可以通过若干条加速通道到达。", "locale": "zh-CN"}}}
