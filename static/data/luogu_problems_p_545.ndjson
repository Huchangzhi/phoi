{"pid": "P12062", "type": "P", "difficulty": 6, "samples": [["2 2 10\n1 4\n2 3\n2 1 2\n1 1 1 1 2\n2 1 2\n1 1 1 1 2\n1 1 2 2 1\n2 2 1\n2 2 2\n1 1 1 2 2\n2 1 1\n2 2 1\n", "4\n3\n3\n4\n1\n2\n"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["2025", "THUPC"], "title": "[THUPC 2025 决赛] 列队", "background": "……所以这个题意和标题是什么关系？", "description": "定义 $f(A)$ 为 矩阵 $A$ 经过如下操作后得到的结果：\n\n1. 独立地对矩阵 $A$ 的每行进行排序，使得各行中的元素从左到右单调不降。如果排序过后的矩阵和排序之前完全相同，则此次变换停止，否则再进行 2. 中描述的操作。\n2. 独立地对矩阵 $A$ 的每列进行排序，使得各列中的元素从上到下单调不降。如果排序过后的矩阵和排序之前完全相同，则此次变换停止，否则再进行 1. 中描述的操作。\n\n现给定一个 $n$ 行 $m$ 列的整数矩阵 $P$，满足$1\\le P_{ij}\\le n\\times m$ 且矩阵中元素互不相同。\n\n接下来有 $q$ 次操作，操作有以下两种：\n\n- 修改操作：给定矩阵中的两个位置 $(x_1,y_1)$ 和 $(x_2,y_2)$，将这两个位置上的元素交换，即交换 $P_{x_1y_1}$ 和 $P_{x_2y_2}$。\n- 查询操作：给定矩阵中的一个位置 $(x,y)$，输出矩阵 $f(P)$ 中该位置的元素，即$f(P)_{xy}$。注意，**查询操作并不会真的改变矩阵形态**。", "inputFormat": "第一行依次输入三个整数 $n,m,q\\ (1\\le n\\times m\\le2\\times10^5,1\\le q\\le2\\times10^5)$。\n\n接下来 $n$ 行，每行 $m$ 个整数，依次描述矩阵 $P$ 各行各列的元素。保证这些元素均在 $1\\sim n\\times m$ 之间且互不相同。\n\n接下来 $q$ 行，每行先是一个整数 $\\text{opt}\\in\\{1,2\\}$，表示操作种类。\n\n\n- $\\text{opt}=1$ 代表一个修改操作。接下来读入四个整数 $x_1,y_1,x_2,y_2\\ (1\\le x_1,x_2\\le n,1\\le y_1,y_2\\le m)$，表示交换 $P_{x_1y_1}$ 和 $P_{x_2y_2}$。\n\n- $\\text{opt}=2$ 代表一个查询操作。接下来读入两个整数 $x,y\\ (1\\le x\\le n,1\\le y\\le m)$，表示查询 $f(P)_{xy}$ 的值。", "outputFormat": "对每组查询操作，输出对应元素的值。", "hint": "### 样例 #1 解释\n\n第一次查询的时候矩阵形如\n\n```plain\n1 4\n2 3\n```\n\n我们发现第一次按行排列时就没能使得矩阵改变，因此答案就是第一行第二列的元素，也就是 $4$。\n\n第二次查询的时候矩阵形如\n\n```plain\n4 1\n2 3\n```\n\n我们先按行排序，变成\n\n```plain\n1 4\n2 3\n```\n\n再按列排序，变成\n\n```plain\n1 3\n2 4\n```\n\n再尝试按行排序，发现不能成功排序。因此答案就是此时第一行第二列的元素，也就是 $3$。\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2025 决赛] 列队", "background": "……所以这个题意和标题是什么关系？", "description": "定义 $f(A)$ 为 矩阵 $A$ 经过如下操作后得到的结果：\n\n1. 独立地对矩阵 $A$ 的每行进行排序，使得各行中的元素从左到右单调不降。如果排序过后的矩阵和排序之前完全相同，则此次变换停止，否则再进行 2. 中描述的操作。\n2. 独立地对矩阵 $A$ 的每列进行排序，使得各列中的元素从上到下单调不降。如果排序过后的矩阵和排序之前完全相同，则此次变换停止，否则再进行 1. 中描述的操作。\n\n现给定一个 $n$ 行 $m$ 列的整数矩阵 $P$，满足$1\\le P_{ij}\\le n\\times m$ 且矩阵中元素互不相同。\n\n接下来有 $q$ 次操作，操作有以下两种：\n\n- 修改操作：给定矩阵中的两个位置 $(x_1,y_1)$ 和 $(x_2,y_2)$，将这两个位置上的元素交换，即交换 $P_{x_1y_1}$ 和 $P_{x_2y_2}$。\n- 查询操作：给定矩阵中的一个位置 $(x,y)$，输出矩阵 $f(P)$ 中该位置的元素，即$f(P)_{xy}$。注意，**查询操作并不会真的改变矩阵形态**。", "inputFormat": "第一行依次输入三个整数 $n,m,q\\ (1\\le n\\times m\\le2\\times10^5,1\\le q\\le2\\times10^5)$。\n\n接下来 $n$ 行，每行 $m$ 个整数，依次描述矩阵 $P$ 各行各列的元素。保证这些元素均在 $1\\sim n\\times m$ 之间且互不相同。\n\n接下来 $q$ 行，每行先是一个整数 $\\text{opt}\\in\\{1,2\\}$，表示操作种类。\n\n\n- $\\text{opt}=1$ 代表一个修改操作。接下来读入四个整数 $x_1,y_1,x_2,y_2\\ (1\\le x_1,x_2\\le n,1\\le y_1,y_2\\le m)$，表示交换 $P_{x_1y_1}$ 和 $P_{x_2y_2}$。\n\n- $\\text{opt}=2$ 代表一个查询操作。接下来读入两个整数 $x,y\\ (1\\le x\\le n,1\\le y\\le m)$，表示查询 $f(P)_{xy}$ 的值。", "outputFormat": "对每组查询操作，输出对应元素的值。", "hint": "### 样例 #1 解释\n\n第一次查询的时候矩阵形如\n\n```plain\n1 4\n2 3\n```\n\n我们发现第一次按行排列时就没能使得矩阵改变，因此答案就是第一行第二列的元素，也就是 $4$。\n\n第二次查询的时候矩阵形如\n\n```plain\n4 1\n2 3\n```\n\n我们先按行排序，变成\n\n```plain\n1 4\n2 3\n```\n\n再按列排序，变成\n\n```plain\n1 3\n2 4\n```\n\n再尝试按行排序，发现不能成功排序。因此答案就是此时第一行第二列的元素，也就是 $3$。\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN"}}}
{"pid": "P12063", "type": "P", "difficulty": 2, "samples": [["4 2\n1\n2\n2\n1\n", "White\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2025", "THUPC"], "title": "[THUPC 2025 决赛] 我的围棋", "background": "", "description": "小 K 和小 S 在下围棋。\n\n小 K 和小 S 在下的并不完全是围棋。\n\n小 K 和小 S 在下的有点像围棋：一方执黑棋一方执白棋，轮流在棋盘上落子，黑方先行。如果有一片相连的棋子没有“气”了，就会被提掉。最终这些棋子由提子一方装到自己的棋盒盖里。具体来说，如果现在执黑棋的小 K 提掉了小 S 的两个白子，他必须将这两个白子装进自己的棋盒盖。\n\n因为蒜协的棋牌室有超强的后勤供应，所以我们可以认为两人都有无限多的棋子可以下。但超强的后勤供应也会百密一疏，两人都有且仅有一个棋盒盖，而棋盒盖的大小是有限的。精通三维最密堆积的小 K 和小 S 在测算后得出，一个棋盒盖里至多能装 $M$ 颗棋子。\n\n基于此，小 K 和小 S 开发出了一套船新的游戏方法，不同于中国传统围棋的排兵布阵攻守兼备，现在二人的策略都是疯狂送子，塞爆对方的棋盒盖。观战的小 Z 觉得非常有趣，于是记下了二人每一步的操作。\n\n根据小 Z 的记载，这局棋二人一共下了 $n$ 手棋，其中第 $i$ 手棋提走了 $a_i$ 颗子。我们认为棋盒盖先装不下自己提走的棋子的人输掉这局棋（此时棋盒盖需要装的棋子应该严格大于 $M$ 颗）。如果棋盒盖溢出的情况在整局中都没有发生，则认为是平局。\n\n现在你需要通过小 Z 的记载判断谁获得了胜利。\n\n小 K 和小 S 都很有体育精神，因此在某人的棋盒盖被塞爆之后，他们不一定会马上结束棋局。\n\n同时，因为这不是正经围棋，所以棋盘上的棋子可能会异常多，在棋局刚开始时也可以提走棋子。", "inputFormat": "第一行两个整数 $n\\ (1\\le n\\le 10^5)$ 和 $M\\ (1\\le M\\le 10^9)$，表示棋局一共下的手数和棋盒盖能装下的棋子数。\n\n之后 $n$ 行每行一个整数 $a_i\\ (0\\le a_i\\le 10^9)$，表示第 $i$ 手棋提走的棋子数目。", "outputFormat": "输出一行一个字符串表示答案。\n\n如果最终黑方获胜，输出`Black`。\n\n如果最终白方获胜，输出`White`。\n\n如果最终平局，输出`Draw`。", "hint": "### 样例 #1 解释\n\n棋盒盖能装下 $2$ 颗棋子。\n\n首先黑方落子，提走 $1$ 颗棋子，此时黑方棋盒盖里有 $1$ 颗棋子。\n\n第二手白方落子，提走 $2$ 颗棋子，此时白方棋盒盖里有 $2$ 颗棋子。\n\n第三手黑方落子，提走 $2$ 颗棋子，棋盒盖装不下了。所以白方获胜。\n\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2025 决赛] 我的围棋", "background": "", "description": "小 K 和小 S 在下围棋。\n\n小 K 和小 S 在下的并不完全是围棋。\n\n小 K 和小 S 在下的有点像围棋：一方执黑棋一方执白棋，轮流在棋盘上落子，黑方先行。如果有一片相连的棋子没有“气”了，就会被提掉。最终这些棋子由提子一方装到自己的棋盒盖里。具体来说，如果现在执黑棋的小 K 提掉了小 S 的两个白子，他必须将这两个白子装进自己的棋盒盖。\n\n因为蒜协的棋牌室有超强的后勤供应，所以我们可以认为两人都有无限多的棋子可以下。但超强的后勤供应也会百密一疏，两人都有且仅有一个棋盒盖，而棋盒盖的大小是有限的。精通三维最密堆积的小 K 和小 S 在测算后得出，一个棋盒盖里至多能装 $M$ 颗棋子。\n\n基于此，小 K 和小 S 开发出了一套船新的游戏方法，不同于中国传统围棋的排兵布阵攻守兼备，现在二人的策略都是疯狂送子，塞爆对方的棋盒盖。观战的小 Z 觉得非常有趣，于是记下了二人每一步的操作。\n\n根据小 Z 的记载，这局棋二人一共下了 $n$ 手棋，其中第 $i$ 手棋提走了 $a_i$ 颗子。我们认为棋盒盖先装不下自己提走的棋子的人输掉这局棋（此时棋盒盖需要装的棋子应该严格大于 $M$ 颗）。如果棋盒盖溢出的情况在整局中都没有发生，则认为是平局。\n\n现在你需要通过小 Z 的记载判断谁获得了胜利。\n\n小 K 和小 S 都很有体育精神，因此在某人的棋盒盖被塞爆之后，他们不一定会马上结束棋局。\n\n同时，因为这不是正经围棋，所以棋盘上的棋子可能会异常多，在棋局刚开始时也可以提走棋子。", "inputFormat": "第一行两个整数 $n\\ (1\\le n\\le 10^5)$ 和 $M\\ (1\\le M\\le 10^9)$，表示棋局一共下的手数和棋盒盖能装下的棋子数。\n\n之后 $n$ 行每行一个整数 $a_i\\ (0\\le a_i\\le 10^9)$，表示第 $i$ 手棋提走的棋子数目。", "outputFormat": "输出一行一个字符串表示答案。\n\n如果最终黑方获胜，输出`Black`。\n\n如果最终白方获胜，输出`White`。\n\n如果最终平局，输出`Draw`。", "hint": "### 样例 #1 解释\n\n棋盒盖能装下 $2$ 颗棋子。\n\n首先黑方落子，提走 $1$ 颗棋子，此时黑方棋盒盖里有 $1$ 颗棋子。\n\n第二手白方落子，提走 $2$ 颗棋子，此时白方棋盒盖里有 $2$ 颗棋子。\n\n第三手黑方落子，提走 $2$ 颗棋子，棋盒盖装不下了。所以白方获胜。\n\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN"}}}
{"pid": "P12064", "type": "P", "difficulty": 0, "samples": [["5 7\n2 4\n5 4\n3 2\n3 4\n3 1\n5 3\n5 1", "0\n0\n1\n0\n0"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2012", "THUSC"], "title": "[THOI 2012] 社交网络结构洞", "background": "搬运自 [2012 年清华大学信息学邀请赛](https://gitlink.org.cn/thusaa/thoi2012)。", "description": "近日，社交网络研究的鼻祖 Jon Kleinberg 教授在清华大学给同学们带来了一个关于社交网络结构洞（Structural Hole）的主题演讲。对社交网络有着浓厚兴趣的小 W 也旁听了这次演讲。在演讲中 Jon Kleinberg 教授讲到社交网络结构洞是描述一个人在一个社交网络中重要程度的一个指标，那么如何定量地分析每一个人在社交网络的重要程度呢？\n\n小 W 阅读很多参考文献，发现有一种通过计算社会关系跨度的方法。\n\n- **【定义】社交网络**：用 $G=(V,E)$ 表示一个社交网络，其中 $V$ 是网络中人的集合，$E\\subseteq V\\times V$ 是人与人之间的关系集合。\n- **【定义】社交网络距离**：$v_i$ 和 $v_j$ 两个人的社交网络距离 $dist_{i,j}$ 为 $v_i$ 和 $v_j$ 之间的最短距离。\n- **【定义】社会关系跨度**：用 $span_k(i,j)$ 表示，是在社交网络中去掉所有与 $v_k$ 相关的边（即边的一个端点为 $v_k$）之后 $v_i$ 和 $v_j$ 之间的最短距离。\n\n那么描述每一个人的结构洞值 $sh_i$ 表示其所有邻居节点之间社会关系跨度与社交网络距离差值的和。\n\n$$sh_i=\\sum\\limits_{v_j,v_k\\in N(v_i),j\\neq k}(span_i(j,k)-dist_{j,k})$$\n\n其中 $N(v_i)$ 表示 $v_i$ 的邻居节点集合。\n\n由于社交网络中人的数量十分庞大，计算每个人的结构洞值也变得十分困难。小 W 想请你帮助设计出一种好的计算方法，求出社交网络中所有人的结构洞值。", "inputFormat": "输入的第一行包含两个整数 $n,m$，表示社交网络中人的数量（人从 $1$ 到 $n$ 编号）和关系的数量。\n\n接下来 $m$ 行描述人们的关系情况，其中第 $i$ 行包含两个整数 $a_i$ 和 $b_i$（$1\\le a_i,b_i\\le n$），表示 $a_i$ 和 $b_i$ 两个人之间在社交网络中有直接关系。", "outputFormat": "输出一共 $n$ 行，每行一个整数，表示每个人在社交网络中的结构洞值。", "hint": "### 【对样例的说明】\n\n样例输入中的社交网络如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/083tihb3.png)\n\n$v_3$ 的结构洞值是 $1$，因为 $v_1$ 和 $v_2$ 的距离原本是 $2$，而去掉 $v_3$ 之后变成 $3$。而其他人的结构洞值都是 $0$，因为去掉他们并不会影响他们的邻居之间的距离。\n\n### 【数据规模与约定】\n\n所有测试数据的范围和特点如下表所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2cv7ssy2.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THOI 2012] 社交网络结构洞", "background": "搬运自 [2012 年清华大学信息学邀请赛](https://gitlink.org.cn/thusaa/thoi2012)。", "description": "近日，社交网络研究的鼻祖 Jon Kleinberg 教授在清华大学给同学们带来了一个关于社交网络结构洞（Structural Hole）的主题演讲。对社交网络有着浓厚兴趣的小 W 也旁听了这次演讲。在演讲中 Jon Kleinberg 教授讲到社交网络结构洞是描述一个人在一个社交网络中重要程度的一个指标，那么如何定量地分析每一个人在社交网络的重要程度呢？\n\n小 W 阅读很多参考文献，发现有一种通过计算社会关系跨度的方法。\n\n- **【定义】社交网络**：用 $G=(V,E)$ 表示一个社交网络，其中 $V$ 是网络中人的集合，$E\\subseteq V\\times V$ 是人与人之间的关系集合。\n- **【定义】社交网络距离**：$v_i$ 和 $v_j$ 两个人的社交网络距离 $dist_{i,j}$ 为 $v_i$ 和 $v_j$ 之间的最短距离。\n- **【定义】社会关系跨度**：用 $span_k(i,j)$ 表示，是在社交网络中去掉所有与 $v_k$ 相关的边（即边的一个端点为 $v_k$）之后 $v_i$ 和 $v_j$ 之间的最短距离。\n\n那么描述每一个人的结构洞值 $sh_i$ 表示其所有邻居节点之间社会关系跨度与社交网络距离差值的和。\n\n$$sh_i=\\sum\\limits_{v_j,v_k\\in N(v_i),j\\neq k}(span_i(j,k)-dist_{j,k})$$\n\n其中 $N(v_i)$ 表示 $v_i$ 的邻居节点集合。\n\n由于社交网络中人的数量十分庞大，计算每个人的结构洞值也变得十分困难。小 W 想请你帮助设计出一种好的计算方法，求出社交网络中所有人的结构洞值。", "inputFormat": "输入的第一行包含两个整数 $n,m$，表示社交网络中人的数量（人从 $1$ 到 $n$ 编号）和关系的数量。\n\n接下来 $m$ 行描述人们的关系情况，其中第 $i$ 行包含两个整数 $a_i$ 和 $b_i$（$1\\le a_i,b_i\\le n$），表示 $a_i$ 和 $b_i$ 两个人之间在社交网络中有直接关系。", "outputFormat": "输出一共 $n$ 行，每行一个整数，表示每个人在社交网络中的结构洞值。", "hint": "### 【对样例的说明】\n\n样例输入中的社交网络如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/083tihb3.png)\n\n$v_3$ 的结构洞值是 $1$，因为 $v_1$ 和 $v_2$ 的距离原本是 $2$，而去掉 $v_3$ 之后变成 $3$。而其他人的结构洞值都是 $0$，因为去掉他们并不会影响他们的邻居之间的距离。\n\n### 【数据规模与约定】\n\n所有测试数据的范围和特点如下表所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2cv7ssy2.png)", "locale": "zh-CN"}}}
{"pid": "P12065", "type": "P", "difficulty": 6, "samples": [["1 3 1 1\n0 0\nQ 0 2\nA 0 3\nQ 0 2", "2.0000\n1.0000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2012", "K-D Tree", "THUSC"], "title": "[THOI 2012] 森林旅店", "background": "搬运自 [2012 年清华大学信息学邀请赛](https://gitlink.org.cn/thusaa/thoi2012)。", "description": "小 H 家旁边的树林可是一年四季度假的好地方。为了整合资源扩大效益，小 H 打算在树林中建立一些“泰山的小屋”，即在一些树木上建造一些小屋，让大家更加近距离地体会自然的美。\n\n不过有一个问题一直困扰着小 H 的计划，那就是森林中白蚁泛滥。大家都知道白蚁对于树木和木制品的危害，如果建造的房子周围白蚁成灾，那无疑就是将游客的人身安全置于一个危险的境地中了。因此小 H 在建造小屋的时候必须更加合理地考量房子的安全性。\n\n简而言之，我们可以认为森林里有许多的树木，其中有 $N$ 个白蚁穴在这些树木上。在同一棵树上最多只有一个白蚁穴。\n\n小 H 想知道，如果他希望在某棵树上建立一座小屋，那么周围离它最近的 $P$ 个白蚁穴的距离分别是多少呢？\n\n同时由于随时可能发现新的白蚁穴，你的程序还应该支持动态地加入新发现的蚁穴。", "inputFormat": "第一行包含四个整数 $N,Q,K$ 和 $P$。$N$ 为初始时的白蚁穴数量，$Q$ 是操作数量，$K$ 是距离度量函数的参数，$P$ 为每次查询要输出的蚁穴个数。\n\n对于坐标位置为 $(X_1,X_2)$ 和 $(Y_1,Y_2)$ 的距离，我们定义为：\n\n$$(|X_1-X_2|^K+|Y_1-Y_2|^K)^{\\frac{1}{K}}$$\n\n接下来 $N$ 行，每行两个整数，表示初始时白蚁穴的坐标。\n\n再接下来 $Q$ 行，每行有一个字符 $C$ 和两个整数 $X$ 和 $Y$。字符 $C$ 是 `A` 表示加入一个坐标为 $(X,Y)$ 的白蚁穴，`Q` 表示询问如果在 $(X,Y)$ 建造一个小屋，请告知周边的蚁穴情况。", "outputFormat": "对于每组询问，输出 $P$ 个实数，以单个空格隔开，表示距离最近的 $P$  个蚁穴的距离，按照升序排序，精确到小数点后 $4$ 位。", "hint": "本题的测试数据均以以下方式生成。\n\n假设所有出现的蚁穴是：$\\{(X_i,Y_i)\\}$，$1\\le i\\le M$。设函数 $f(x),g(x)$ 是两个单调函数。数据生成方法如下：\n\n- 生成 $M$ 个随机点 $(x_i,y_i)$，满足 $0\\le x_i,y_i\\le 1$；\n- 最终输入数据为 $X_i=f(x_i),Y_i=g(y_i)$，且满足 $0\\le X_i,Y_i\\le10^7$。\n\n测试数据共分 $10$ 组，每组包括 $5$ 个测试点，共 $50$ 个测试点。同一组的 $5$ 个测试数据的蚁穴的初始位置由同一组随机点经不同的函数变换产生。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/w3m0sotf.png)\n\n表中所有数据均为数据上界。\n\n每组测试点集合中 $40\\%$ 的数据不包含插入操作。\n\n所有数据中查询次数不超过 $5000$ 次。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THOI 2012] 森林旅店", "background": "搬运自 [2012 年清华大学信息学邀请赛](https://gitlink.org.cn/thusaa/thoi2012)。", "description": "小 H 家旁边的树林可是一年四季度假的好地方。为了整合资源扩大效益，小 H 打算在树林中建立一些“泰山的小屋”，即在一些树木上建造一些小屋，让大家更加近距离地体会自然的美。\n\n不过有一个问题一直困扰着小 H 的计划，那就是森林中白蚁泛滥。大家都知道白蚁对于树木和木制品的危害，如果建造的房子周围白蚁成灾，那无疑就是将游客的人身安全置于一个危险的境地中了。因此小 H 在建造小屋的时候必须更加合理地考量房子的安全性。\n\n简而言之，我们可以认为森林里有许多的树木，其中有 $N$ 个白蚁穴在这些树木上。在同一棵树上最多只有一个白蚁穴。\n\n小 H 想知道，如果他希望在某棵树上建立一座小屋，那么周围离它最近的 $P$ 个白蚁穴的距离分别是多少呢？\n\n同时由于随时可能发现新的白蚁穴，你的程序还应该支持动态地加入新发现的蚁穴。", "inputFormat": "第一行包含四个整数 $N,Q,K$ 和 $P$。$N$ 为初始时的白蚁穴数量，$Q$ 是操作数量，$K$ 是距离度量函数的参数，$P$ 为每次查询要输出的蚁穴个数。\n\n对于坐标位置为 $(X_1,X_2)$ 和 $(Y_1,Y_2)$ 的距离，我们定义为：\n\n$$(|X_1-X_2|^K+|Y_1-Y_2|^K)^{\\frac{1}{K}}$$\n\n接下来 $N$ 行，每行两个整数，表示初始时白蚁穴的坐标。\n\n再接下来 $Q$ 行，每行有一个字符 $C$ 和两个整数 $X$ 和 $Y$。字符 $C$ 是 `A` 表示加入一个坐标为 $(X,Y)$ 的白蚁穴，`Q` 表示询问如果在 $(X,Y)$ 建造一个小屋，请告知周边的蚁穴情况。", "outputFormat": "对于每组询问，输出 $P$ 个实数，以单个空格隔开，表示距离最近的 $P$  个蚁穴的距离，按照升序排序，精确到小数点后 $4$ 位。", "hint": "本题的测试数据均以以下方式生成。\n\n假设所有出现的蚁穴是：$\\{(X_i,Y_i)\\}$，$1\\le i\\le M$。设函数 $f(x),g(x)$ 是两个单调函数。数据生成方法如下：\n\n- 生成 $M$ 个随机点 $(x_i,y_i)$，满足 $0\\le x_i,y_i\\le 1$；\n- 最终输入数据为 $X_i=f(x_i),Y_i=g(y_i)$，且满足 $0\\le X_i,Y_i\\le10^7$。\n\n测试数据共分 $10$ 组，每组包括 $5$ 个测试点，共 $50$ 个测试点。同一组的 $5$ 个测试数据的蚁穴的初始位置由同一组随机点经不同的函数变换产生。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/w3m0sotf.png)\n\n表中所有数据均为数据上界。\n\n每组测试点集合中 $40\\%$ 的数据不包含插入操作。\n\n所有数据中查询次数不超过 $5000$ 次。", "locale": "zh-CN"}}}
{"pid": "P12066", "type": "P", "difficulty": 0, "samples": [["4 3\n1 1 1 1\n1 2 2 2\n1 2 3 3\n1 2 3 2", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2012", "THUSC"], "title": "[THOI 2012] 水位", "background": "搬运自 [2012 年清华大学信息学邀请赛](https://gitlink.org.cn/thusaa/thoi2012)。", "description": "有一个正方形的地区，该地区特点鲜明：如果把它等分为 $N\\times N$ 个小正方形格子的话，在每个格子内的任意地点的地表高度是相同的，并且是一个 $0$ 到 $M$ 之间的整数。正方形地区的外部被无限高的边界包围。\n\n该地区可能会有积水。经过多年的观察，人们发现了几个关于积水的重要规律：\n1. 每个格子要么完全没有积水，要么它内部的任意地点的水面高度都是相同的。并且水面高度一定大于地表高度。\n2. 每个格子的水面高度在 $0\\sim m$之间，并且一定是整数。\n3. 对于相邻（必须为边相邻）的两个格子，一定不会出现水自动从一个格子流向另一个格子的情况。也就是说，一定不能出现这两个格子都有水且水面高度不同，或者有水格子的水面比无水格子的地表要高的情况。\n\n例如，下面图中每个格子里有两个数 $a/b$，说明该格子的地表高度是 $a$，水面高度是 $b$（均为海拔高度），而没有水的格子中 $b$ 以 `-` 表示。则左边的情况是符合规律的，而右边的情况并不符合以上规律，因为水可以由 $2/4$ 的格子流向 $3/-$ 的格子。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jqf6xalu.png)\n\n该地区水文站的工作人员小 A 想知道，该地区中有多少种不同的水位情况符合规律。你能回答他的这个问题吗？", "inputFormat": "输入文件的第一行包含两个正整数 $N$ 和 $M$。\n\n随后的 $N$ 行，每行包含 $N$ 个非负整数。其中第 $i+1$ 行的第 $j$ 个数表示该地区第 $i$ 行第 $j$ 列格子的地表高度。", "outputFormat": "输出文件只包含一个整数，即该地区符合规律的水位情况种数。", "hint": "### 【对样例的说明】\n\n符合规律的水位情况有以下六种：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/sqbxns6x.png)\n\n### 【数据规模与约定】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/a7y6bd80.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THOI 2012] 水位", "background": "搬运自 [2012 年清华大学信息学邀请赛](https://gitlink.org.cn/thusaa/thoi2012)。", "description": "有一个正方形的地区，该地区特点鲜明：如果把它等分为 $N\\times N$ 个小正方形格子的话，在每个格子内的任意地点的地表高度是相同的，并且是一个 $0$ 到 $M$ 之间的整数。正方形地区的外部被无限高的边界包围。\n\n该地区可能会有积水。经过多年的观察，人们发现了几个关于积水的重要规律：\n1. 每个格子要么完全没有积水，要么它内部的任意地点的水面高度都是相同的。并且水面高度一定大于地表高度。\n2. 每个格子的水面高度在 $0\\sim m$之间，并且一定是整数。\n3. 对于相邻（必须为边相邻）的两个格子，一定不会出现水自动从一个格子流向另一个格子的情况。也就是说，一定不能出现这两个格子都有水且水面高度不同，或者有水格子的水面比无水格子的地表要高的情况。\n\n例如，下面图中每个格子里有两个数 $a/b$，说明该格子的地表高度是 $a$，水面高度是 $b$（均为海拔高度），而没有水的格子中 $b$ 以 `-` 表示。则左边的情况是符合规律的，而右边的情况并不符合以上规律，因为水可以由 $2/4$ 的格子流向 $3/-$ 的格子。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jqf6xalu.png)\n\n该地区水文站的工作人员小 A 想知道，该地区中有多少种不同的水位情况符合规律。你能回答他的这个问题吗？", "inputFormat": "输入文件的第一行包含两个正整数 $N$ 和 $M$。\n\n随后的 $N$ 行，每行包含 $N$ 个非负整数。其中第 $i+1$ 行的第 $j$ 个数表示该地区第 $i$ 行第 $j$ 列格子的地表高度。", "outputFormat": "输出文件只包含一个整数，即该地区符合规律的水位情况种数。", "hint": "### 【对样例的说明】\n\n符合规律的水位情况有以下六种：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/sqbxns6x.png)\n\n### 【数据规模与约定】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/a7y6bd80.png)", "locale": "zh-CN"}}}
{"pid": "P12067", "type": "P", "difficulty": 0, "samples": [["3 2 5\n5 30 5\n20 10 3\n100 5 1", "41 10 5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2013", "Special Judge", "THUSC"], "title": "[THOI 2013] 魔塔", "background": "搬运自 [2013 年清华大学信息学邀请赛](https://gitlink.org.cn/thusaa/thoi2013)。", "description": "沫沫最近迷上了一款名叫魔塔的角色扮演类游戏。在游戏中，玩家需要控制勇士在魔塔内行走，消灭怪物，积累宝物，最终解救出困在塔顶的公主。\n\n勇士的能力通过生命值、攻击力和防御力三个属性值来表示（均为正整数），怪物的能力表示与勇士相同。勇士在和一个怪物战斗时，双方会面对面站好，然后每秒钟攻击对方一次。当勇士攻击力大于怪物防御力时，怪物将被扣除勇士攻击力减去怪物防御力的血量，否则怪物不扣血。同时，当怪物攻击力大于勇士防御力时，勇士将被扣除怪物攻击力减去勇士防御力的血量，否则勇士不扣血。若经过若干秒的攻击后，有至少一方的血量小于等于零，则此次战斗结束。注意，由于双方同时攻击，所以可能会出现战斗结束时双方血量均小于等于零的情况。当且仅当战斗在有限回合内结束且勇士的剩余血量大于零时，勇士获得胜利。\n\n例如：下图勇士与怪物的战斗中，每秒钟勇士的攻击使怪物扣除 $9$ 点血量，怪物的攻击使勇士扣除 $10$ 点血量，$6$ 秒钟后怪物的血量低于零，勇士剩余 $940$ 点生命值并取得胜利。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/q1zd7ltr.png)\n\n沫沫喜欢上魔塔的主要原因是，她不需要用精妙的操作来打败怪物。相反，一旦勇士的属性确定，勇士与每只怪物的战斗结果就已经确定。游戏中，勇士必须击败 $n$ 只怪物才能救出公主，沫沫需要决定勇士的初始属性与消灭怪物的顺序。\n\n在踏入魔塔之前，沫沫可以用金币为勇士购买初始属性，每一点生命值需要 $1$ 枚金币，每一点攻击力需要 $C_A$ 枚金币，每一点防御力需要 $C_D$ 枚金币。沫沫想通过选择合理的消灭怪物的顺序，以减少金币的花费，并让勇士战胜所有 $n$ 只怪物，成功救出公主。现在请你来计算最少需要多少金币才能完成该任务。", "inputFormat": "输入的第一行包含三个正整数 $n,C_A,C_D$，分别表示怪物数量、购买单位攻击力的价格以及购买单位防御力的价格。\n\n接下来 $n$ 行描述怪物的属性，其中第 $i$ 行包含三个正整数 $H_i,A_i,D_i$，表示第只怪物的生命值、攻击力和防御力。", "outputFormat": "输出为一行，包含三个正整数，表示勇士的生命值、攻击力和防御力，如果有多种方案均能战胜所有怪物且花费金币数最少，输出任意一种即可。注意：尽管防御力为零可能更优，但本题要求输出的防御力必须**大于零**。", "hint": "### 【对样例的说明】\n\n- 首先，与第一只怪物战斗，经过 $1$ 秒钟勇士损失 $25$ 点生命值并取得胜利；\n- 然后，与第二只怪物战斗，经过 $3$ 秒钟勇士损失 $15$ 点生命值并取得胜利；\n- 最后，与第三只怪物战斗，经过 $12$ 秒钟勇士取得胜利且未损失生命值；\n- 最终，勇士消灭了所有怪物，剩余 $1$ 点血量，共花费 $41+2\\times10+5\\times5=86$ 枚金币。\n\n### 【数据规模与约定】\n\n- $10\\%$ 的测试数据满足 $n\\le50$，$H_i,A_i,D_i\\le1000$。\n- $40\\%$ 的测试数据满足 $n\\le1000$，$H_i,A_i,D_i\\le10^5$。\n- $70\\%$ 的测试数据满足 $n\\le2500$，$H_i,A_i,D_i\\le5\\times10^5$。\n- 所有的测试数据满足 $n\\le5000$，$H_i,A_i,D_i\\le10^6$，$C_A,C_D\\le10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THOI 2013] 魔塔", "background": "搬运自 [2013 年清华大学信息学邀请赛](https://gitlink.org.cn/thusaa/thoi2013)。", "description": "沫沫最近迷上了一款名叫魔塔的角色扮演类游戏。在游戏中，玩家需要控制勇士在魔塔内行走，消灭怪物，积累宝物，最终解救出困在塔顶的公主。\n\n勇士的能力通过生命值、攻击力和防御力三个属性值来表示（均为正整数），怪物的能力表示与勇士相同。勇士在和一个怪物战斗时，双方会面对面站好，然后每秒钟攻击对方一次。当勇士攻击力大于怪物防御力时，怪物将被扣除勇士攻击力减去怪物防御力的血量，否则怪物不扣血。同时，当怪物攻击力大于勇士防御力时，勇士将被扣除怪物攻击力减去勇士防御力的血量，否则勇士不扣血。若经过若干秒的攻击后，有至少一方的血量小于等于零，则此次战斗结束。注意，由于双方同时攻击，所以可能会出现战斗结束时双方血量均小于等于零的情况。当且仅当战斗在有限回合内结束且勇士的剩余血量大于零时，勇士获得胜利。\n\n例如：下图勇士与怪物的战斗中，每秒钟勇士的攻击使怪物扣除 $9$ 点血量，怪物的攻击使勇士扣除 $10$ 点血量，$6$ 秒钟后怪物的血量低于零，勇士剩余 $940$ 点生命值并取得胜利。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/q1zd7ltr.png)\n\n沫沫喜欢上魔塔的主要原因是，她不需要用精妙的操作来打败怪物。相反，一旦勇士的属性确定，勇士与每只怪物的战斗结果就已经确定。游戏中，勇士必须击败 $n$ 只怪物才能救出公主，沫沫需要决定勇士的初始属性与消灭怪物的顺序。\n\n在踏入魔塔之前，沫沫可以用金币为勇士购买初始属性，每一点生命值需要 $1$ 枚金币，每一点攻击力需要 $C_A$ 枚金币，每一点防御力需要 $C_D$ 枚金币。沫沫想通过选择合理的消灭怪物的顺序，以减少金币的花费，并让勇士战胜所有 $n$ 只怪物，成功救出公主。现在请你来计算最少需要多少金币才能完成该任务。", "inputFormat": "输入的第一行包含三个正整数 $n,C_A,C_D$，分别表示怪物数量、购买单位攻击力的价格以及购买单位防御力的价格。\n\n接下来 $n$ 行描述怪物的属性，其中第 $i$ 行包含三个正整数 $H_i,A_i,D_i$，表示第只怪物的生命值、攻击力和防御力。", "outputFormat": "输出为一行，包含三个正整数，表示勇士的生命值、攻击力和防御力，如果有多种方案均能战胜所有怪物且花费金币数最少，输出任意一种即可。注意：尽管防御力为零可能更优，但本题要求输出的防御力必须**大于零**。", "hint": "### 【对样例的说明】\n\n- 首先，与第一只怪物战斗，经过 $1$ 秒钟勇士损失 $25$ 点生命值并取得胜利；\n- 然后，与第二只怪物战斗，经过 $3$ 秒钟勇士损失 $15$ 点生命值并取得胜利；\n- 最后，与第三只怪物战斗，经过 $12$ 秒钟勇士取得胜利且未损失生命值；\n- 最终，勇士消灭了所有怪物，剩余 $1$ 点血量，共花费 $41+2\\times10+5\\times5=86$ 枚金币。\n\n### 【数据规模与约定】\n\n- $10\\%$ 的测试数据满足 $n\\le50$，$H_i,A_i,D_i\\le1000$。\n- $40\\%$ 的测试数据满足 $n\\le1000$，$H_i,A_i,D_i\\le10^5$。\n- $70\\%$ 的测试数据满足 $n\\le2500$，$H_i,A_i,D_i\\le5\\times10^5$。\n- 所有的测试数据满足 $n\\le5000$，$H_i,A_i,D_i\\le10^6$，$C_A,C_D\\le10^6$。", "locale": "zh-CN"}}}
{"pid": "P12068", "type": "P", "difficulty": 0, "samples": [["4\n1 1\n0 1\n1 0\n-1 0\n0 -1", "2\n2\n1 2 1 0"], ["8\n1 1\n-1 0\n0 1\n1 2\n2 3\n0 -1\n0 -2\n3 -3\n3 -3", "9\n117\n18 72 100 117 106 97 90 73"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2013", "Special Judge", "THUSC"], "title": "[THOI 2013] 宇宙飞艇", "background": "搬运自 [2013 年清华大学信息学邀请赛](https://gitlink.org.cn/thusaa/thoi2013)。\n\nupd 2025.4.7 10:20：本题 spj 已修复。\n\nudp 2025.4.16 19:19：添加了一组 Hack 数据，位于 Subtask #1。感谢 @[AL8624](/user/913226) 的贡献。", "description": "小胜是宇宙飞艇神舟 $100$ 号的指挥官，正在指挥神舟 $100$ 号进行航行任务。\n\n神舟 $100$ 号上一共有 $n$ 个能够在水平方向产生推力的引擎（至于垂直的第三维方向，小胜对此并不关心），其中第 $i$ 个引擎能够使飞艇获得的水平速度为 $\\overrightarrow{p_i}=(x_i,y_i)$。由于采用了特殊技术，飞艇在运行过程中不会发生旋转。\n\n为了能够尽快的执行任务，小胜希望你帮助他解决下列问题：\n1. 飞艇利用这些引擎在 $\\overrightarrow{q}=(x_q,y_q)$ 方向上获得的最大分速度是多少？\n2. 飞艇利用这些引擎所能获得的最大速度是多少？\n3. 飞艇恰好使用 $k$ 个引擎，所能获得的最大速度是多少？\n\n为了方便表达，对于问题 $1$，请输出最大分速度与 $|\\overrightarrow{q}|$（$\\overrightarrow{q}$ 的模长，即 $\\sqrt{x_q^2+y_q^2}$）的乘积；对于问题 $2$ 和问题 $3$，请输出最大速度的平方。", "inputFormat": "第一行包含一个正整数 $n$，表示引擎的个数。\n\n第二行包含两个整数 $x_q$ 和 $y_q$，表示方向 $\\overrightarrow{q}=(x_q,y_q)$。\n\n接下来 $n$ 行，每行包含两个整数 $x_i$ 和 $y_i$，表示第 $i$ 个引擎所能提供的速度为 $\\overrightarrow{p_i}=(x_i,y_i)$。", "outputFormat": "第一行为一个整数，表示神舟 $100$ 号在 $\\overrightarrow{q}$ 方向上最大分速度与 $|\\overrightarrow{q}|$ 的乘积的值。\n\n第二行为一个整数，表示通过这 $n$ 个引擎所能得到的最大速度值的平方。\n\n第三行包含 $n$ 个用空格隔开的整数，其中第 $k$ 个整数表示恰好开启 $k$ 个引擎所能得到的最大速度的平方。", "hint": "### 【对样例的说明】\n\n对于样例 1，要获得在 $\\overrightarrow{q}=(1,1)$ 方向的最大分速度，最佳方案是打开前两个引擎，而打开这两个引擎也可以使得飞艇获得最大速度。\n\n对于样例 2，要使得飞艇获得在 $\\overrightarrow{q}=(1,1)$ 方向的最大分速度，需要打开 $2,3,4$ 号引擎，而要使得飞艇获得最大速度，则需要打开 $5,6,7,8$ 号引擎。\n\n### 【数据规模与约定】\n\n$25\\%$ 的数据满足 $n\\le300$。\n\n$50\\%$ 的数据满足对于任意 $1\\le i<j<k\\le n$，$(x_i,y_i),(x_j,y_j),(x_k,y_k)$ 三点不共线。\n\n$100\\%$ 的数据满足 $3\\le n\\le1000$，$0<|\\overrightarrow{q}|\\le1000$ 并且对于任意 $1\\le i\\le n$，$|\\overrightarrow{p_i}|>0,|x_i|\\le 10^5,|y_i|\\le 10^5$。\n\n### 【数学小贴士】\n\n对于两个二维向量与 $\\overrightarrow{u}=(x_u,y_u)$ 与 $\\overrightarrow{v}=(x_v,y_v)$，我们用 $u\\cdot v$ 表示向量的内积，用 $u\\times v$ 表示向量的叉积。向量的内积和叉积的计算满足如下恒等式：\n\n$$\\overrightarrow{u}\\cdot \\overrightarrow{v}=\\overrightarrow{v}\\cdot \\overrightarrow{u}=x_ux_v+y_uy_v=|\\overrightarrow{u}|| \\overrightarrow{v}|\\cos \\theta$$\n\n$$\\overrightarrow{u}\\times \\overrightarrow{v}=-\\overrightarrow{v}\\times \\overrightarrow{u}=x_uy_v-x_vy_u=|\\overrightarrow{u}|| \\overrightarrow{v}|\\sin \\theta$$\n\n这里 $\\theta$ 表示向量 $\\overrightarrow{u}$ 和 $\\overrightarrow{v}$ 的夹角大小。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THOI 2013] 宇宙飞艇", "background": "搬运自 [2013 年清华大学信息学邀请赛](https://gitlink.org.cn/thusaa/thoi2013)。\n\nupd 2025.4.7 10:20：本题 spj 已修复。\n\nudp 2025.4.16 19:19：添加了一组 Hack 数据，位于 Subtask #1。感谢 @[AL8624](/user/913226) 的贡献。", "description": "小胜是宇宙飞艇神舟 $100$ 号的指挥官，正在指挥神舟 $100$ 号进行航行任务。\n\n神舟 $100$ 号上一共有 $n$ 个能够在水平方向产生推力的引擎（至于垂直的第三维方向，小胜对此并不关心），其中第 $i$ 个引擎能够使飞艇获得的水平速度为 $\\overrightarrow{p_i}=(x_i,y_i)$。由于采用了特殊技术，飞艇在运行过程中不会发生旋转。\n\n为了能够尽快的执行任务，小胜希望你帮助他解决下列问题：\n1. 飞艇利用这些引擎在 $\\overrightarrow{q}=(x_q,y_q)$ 方向上获得的最大分速度是多少？\n2. 飞艇利用这些引擎所能获得的最大速度是多少？\n3. 飞艇恰好使用 $k$ 个引擎，所能获得的最大速度是多少？\n\n为了方便表达，对于问题 $1$，请输出最大分速度与 $|\\overrightarrow{q}|$（$\\overrightarrow{q}$ 的模长，即 $\\sqrt{x_q^2+y_q^2}$）的乘积；对于问题 $2$ 和问题 $3$，请输出最大速度的平方。", "inputFormat": "第一行包含一个正整数 $n$，表示引擎的个数。\n\n第二行包含两个整数 $x_q$ 和 $y_q$，表示方向 $\\overrightarrow{q}=(x_q,y_q)$。\n\n接下来 $n$ 行，每行包含两个整数 $x_i$ 和 $y_i$，表示第 $i$ 个引擎所能提供的速度为 $\\overrightarrow{p_i}=(x_i,y_i)$。", "outputFormat": "第一行为一个整数，表示神舟 $100$ 号在 $\\overrightarrow{q}$ 方向上最大分速度与 $|\\overrightarrow{q}|$ 的乘积的值。\n\n第二行为一个整数，表示通过这 $n$ 个引擎所能得到的最大速度值的平方。\n\n第三行包含 $n$ 个用空格隔开的整数，其中第 $k$ 个整数表示恰好开启 $k$ 个引擎所能得到的最大速度的平方。", "hint": "### 【对样例的说明】\n\n对于样例 1，要获得在 $\\overrightarrow{q}=(1,1)$ 方向的最大分速度，最佳方案是打开前两个引擎，而打开这两个引擎也可以使得飞艇获得最大速度。\n\n对于样例 2，要使得飞艇获得在 $\\overrightarrow{q}=(1,1)$ 方向的最大分速度，需要打开 $2,3,4$ 号引擎，而要使得飞艇获得最大速度，则需要打开 $5,6,7,8$ 号引擎。\n\n### 【数据规模与约定】\n\n$25\\%$ 的数据满足 $n\\le300$。\n\n$50\\%$ 的数据满足对于任意 $1\\le i<j<k\\le n$，$(x_i,y_i),(x_j,y_j),(x_k,y_k)$ 三点不共线。\n\n$100\\%$ 的数据满足 $3\\le n\\le1000$，$0<|\\overrightarrow{q}|\\le1000$ 并且对于任意 $1\\le i\\le n$，$|\\overrightarrow{p_i}|>0,|x_i|\\le 10^5,|y_i|\\le 10^5$。\n\n### 【数学小贴士】\n\n对于两个二维向量与 $\\overrightarrow{u}=(x_u,y_u)$ 与 $\\overrightarrow{v}=(x_v,y_v)$，我们用 $u\\cdot v$ 表示向量的内积，用 $u\\times v$ 表示向量的叉积。向量的内积和叉积的计算满足如下恒等式：\n\n$$\\overrightarrow{u}\\cdot \\overrightarrow{v}=\\overrightarrow{v}\\cdot \\overrightarrow{u}=x_ux_v+y_uy_v=|\\overrightarrow{u}|| \\overrightarrow{v}|\\cos \\theta$$\n\n$$\\overrightarrow{u}\\times \\overrightarrow{v}=-\\overrightarrow{v}\\times \\overrightarrow{u}=x_uy_v-x_vy_u=|\\overrightarrow{u}|| \\overrightarrow{v}|\\sin \\theta$$\n\n这里 $\\theta$ 表示向量 $\\overrightarrow{u}$ 和 $\\overrightarrow{v}$ 的夹角大小。\n", "locale": "zh-CN"}}}
{"pid": "P12070", "type": "P", "difficulty": 7, "samples": [["2 2\n2 1\n3 2", "2.4849"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2014", "THUSC"], "title": "[THOI 2014] 函数求解", "background": "搬运自 [2014 年清华大学信息学邀请赛](https://gitlink.org.cn/thusaa/thoi2014)。", "description": "定义正整数域上的函数 $f(x): \\N^+ \\to \\N^+$ 满足：\n\n$$f(t^mf(s))=sf(t)^m,\\forall s,t \\in \\N^+$$\n\n满足条件的函数会有很多，例如 $f(x)=x$ 就是一个解。\n\n现给定 $m,n$，求 $f(n)$ 的最小值。", "inputFormat": "由于输入的 $n$ 可能很大，我们按照质因数分解的形式输入：\n\n$$n=\\displaystyle\\prod_{i=1}^{d}p_i^{q_i}$$\n\n输入第一行包含两个整数 $m,d$。接下来 $d$ 行，第 $i$ 行包含一对整数 $p,q$。数据保证 $p$ 为质数且 $q_i \\gt 0$。", "outputFormat": "输出一行表示最小的 $f(n)$，由于数值较大，请将输出答案以 $e$ 为底取对数输出，即 $\\ln(f(n))$。结果保留四位小数。", "hint": "**【样例解释】**\n\n$n=2\\times3^2=18$。\n\n一个可行的最优解为：\n\n|$n$|$f(n)$|\n|:-:|:-:|\n|$1$|$1$|\n|$2$|$3$|\n|$3$|$2$|\n|$4$|$9$|\n|$5$|$7$|\n|$6$|$6$|\n|$7$|$5$|\n|$8$|$27$|\n|$9$|$4$|\n|$10$|$21$|\n|$11$|$13$|\n|$12$|$18$|\n|$13$|$11$|\n|$14$|$15$|\n|$15$|$14$|\n|$16$|$81$|\n|$17$|$23$|\n|$18$|$12$|\n\n$f(n)=12$，而这个可行解是让 $f(n)$ 最小的解之一，故最终答案为 $\\ln(12)\\approx2.4849$。\n\n**【小贴士】**\n\n在 C/C++ 中，包含在 `<math.h>`（或 `<cmath>` ）中的 `log` 函数，即 $\\ln$ 函数。\n\n对于保留 $4$ 位有效数字的输出，C/C++ 输出语句举例：\n`printf(\"%.4f\\n\", answer);`\n\n在 Pascal 中直接使用函数 `ln` 即可。\n\n对于保留 $4$ 位有效数字的输出，Pascal 输出语句举例：\n`writeln(answer:0:4);`\n\n**【数据范围】**\n\n本题共 $20$ 个测试点，每个测试点等分。\n\n|测试点|特殊性质|\n|:-:|:-:|\n|$1 \\sim 2$|$m \\le 2, n \\le 10$|\n|$3 \\sim 5$|$p_i \\le 100, q_i \\le 1,m \\le 2, d \\le 10$|\n|$6 \\sim 7$|$p_i \\le 1000, q_i \\le 1, m \\le 2, d \\le 50$|\n|$8 \\sim 10$|$p_i \\le 1000, q_i \\le 2, m \\le 2, d \\le 50$|\n|$11 \\sim 15$|$p_i \\le 2000, q_i \\le 5, m \\le 10, d \\le 50$|\n|$16 \\sim 20$|$p_i \\le 2000, q_i \\le 5, m \\le 10, d \\le 100$|", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THOI 2014] 函数求解", "background": "搬运自 [2014 年清华大学信息学邀请赛](https://gitlink.org.cn/thusaa/thoi2014)。", "description": "定义正整数域上的函数 $f(x): \\N^+ \\to \\N^+$ 满足：\n\n$$f(t^mf(s))=sf(t)^m,\\forall s,t \\in \\N^+$$\n\n满足条件的函数会有很多，例如 $f(x)=x$ 就是一个解。\n\n现给定 $m,n$，求 $f(n)$ 的最小值。", "inputFormat": "由于输入的 $n$ 可能很大，我们按照质因数分解的形式输入：\n\n$$n=\\displaystyle\\prod_{i=1}^{d}p_i^{q_i}$$\n\n输入第一行包含两个整数 $m,d$。接下来 $d$ 行，第 $i$ 行包含一对整数 $p,q$。数据保证 $p$ 为质数且 $q_i \\gt 0$。", "outputFormat": "输出一行表示最小的 $f(n)$，由于数值较大，请将输出答案以 $e$ 为底取对数输出，即 $\\ln(f(n))$。结果保留四位小数。", "hint": "**【样例解释】**\n\n$n=2\\times3^2=18$。\n\n一个可行的最优解为：\n\n|$n$|$f(n)$|\n|:-:|:-:|\n|$1$|$1$|\n|$2$|$3$|\n|$3$|$2$|\n|$4$|$9$|\n|$5$|$7$|\n|$6$|$6$|\n|$7$|$5$|\n|$8$|$27$|\n|$9$|$4$|\n|$10$|$21$|\n|$11$|$13$|\n|$12$|$18$|\n|$13$|$11$|\n|$14$|$15$|\n|$15$|$14$|\n|$16$|$81$|\n|$17$|$23$|\n|$18$|$12$|\n\n$f(n)=12$，而这个可行解是让 $f(n)$ 最小的解之一，故最终答案为 $\\ln(12)\\approx2.4849$。\n\n**【小贴士】**\n\n在 C/C++ 中，包含在 `<math.h>`（或 `<cmath>` ）中的 `log` 函数，即 $\\ln$ 函数。\n\n对于保留 $4$ 位有效数字的输出，C/C++ 输出语句举例：\n`printf(\"%.4f\\n\", answer);`\n\n在 Pascal 中直接使用函数 `ln` 即可。\n\n对于保留 $4$ 位有效数字的输出，Pascal 输出语句举例：\n`writeln(answer:0:4);`\n\n**【数据范围】**\n\n本题共 $20$ 个测试点，每个测试点等分。\n\n|测试点|特殊性质|\n|:-:|:-:|\n|$1 \\sim 2$|$m \\le 2, n \\le 10$|\n|$3 \\sim 5$|$p_i \\le 100, q_i \\le 1,m \\le 2, d \\le 10$|\n|$6 \\sim 7$|$p_i \\le 1000, q_i \\le 1, m \\le 2, d \\le 50$|\n|$8 \\sim 10$|$p_i \\le 1000, q_i \\le 2, m \\le 2, d \\le 50$|\n|$11 \\sim 15$|$p_i \\le 2000, q_i \\le 5, m \\le 10, d \\le 50$|\n|$16 \\sim 20$|$p_i \\le 2000, q_i \\le 5, m \\le 10, d \\le 100$|", "locale": "zh-CN"}}}
{"pid": "P12071", "type": "P", "difficulty": 7, "samples": [["3 3\n903527 47001 10 10 675 293 A", "11\n5\n9"], ["8 5\n903527 47001 5 5 190 338 A", "9\n8\n7\n7\n8\n7\n8\n4"], ["5 7\n903527 47001 1000 1000 190 338 B", "3364\n3305\n4076\n3714\n2969"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2014", "THUSC"], "title": "[THOI 2014] 印刷电路板", "background": "搬运自 [2014 年清华大学信息学邀请赛](https://gitlink.org.cn/thusaa/thoi2014)。", "description": "Printed Circuit Board（简称PCB），印刷电路板，它可以固定各种电子元器件，然后将它们连接起来，使得整个系统能够实现我们所需要的功能。因此，“焊板子”是一个很多工科学生（尤其是电子、自动化系的同学）都需要掌握的技能。\n\n现代电路板多用印刷技术制成。印刷线路板的最大特点是装配的元件紧凑、美观，并且适合于工厂的大规模生产。当然也适合各种电子小制作。这种线路板的基板是矩形的，用环氧板或纸质板制成。在基板上面用热压工艺贴上一层很薄的铜箔。用印刷法把电路印在铜箔上，再用腐蚀法把不需要的铜箔去掉，留下的铜箔便构成电路，最后钻上小孔，涂上助焊保护剂，电路板便制成了。\n\n由于技术的限制，电路板上铜线的宽度是确定的，并且铜线必须平行于电路板的边界（也就是说铜线必须平行于坐标轴）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/c0efse5g.png)\n\n例如以上两幅图都是可行的电路板。\n\n现在 R 同学需要制作很多很多电路板，每个电路板上有若干个电子元件。他需要合理布置电路使得铜箔将所有电子元件都连通，并且消耗的铜最少。", "inputFormat": "第一行输入两个正整数 $T,n$，表示R同学需要制作的电路板数量和每块电路板上的电子元件数。\n\n由于输入数据规模庞大，因此采用输入种子后随机生成的方式。\n\n第二行输入 $6$ 个正整数 $a,c,Mx,My,seedx,seedy$，以及一个字符 $datatype$，并用以下方式生成序列 $X_i,Y_i$：\n\n$$X_0=seedx, X_i=((aX_{i-1}+c) \\div 2^{16})\\bmod 2^{16}$$\n\n$$Y_0=seedy, Y_i=((aY_{i-1}+c) \\div 2^{16})\\bmod 2^{16}$$\n\n若 $datatype$ 为 `B`，则：\n\n$$(X_{in}\\bmod Mx+Mx,Y_{in}\\bmod My+My)$$\n$$(X_{in+1}\\bmod Mx+Mx,Y_{in+1}\\bmod My+My)$$\n$$(X_{in+2}\\bmod Mx+Mx,Y_{in+2}\\bmod My+My)$$\n$$(X_{in+3}\\bmod Mx+Mx,Y_{in+}\\bmod My+My)$$\n$$\\dots$$\n$$(X_{in+n-1}\\bmod Mx_+Mx,Y_{in+n-1}\\bmod My+My)$$\n\n为第 $i (0 \\le i \\lt T)$ 组数据中的 $n$ 个电子元件的坐标。\n\n若 $datatype$ 为 `B`，则：\n\n$$(X_{in}\\bmod Mx+Mx,Y_{in}\\bmod My+My)$$\n$$(X_{in+1}\\bmod Mx+Mx,Y_{in+1}\\bmod My+My)$$\n$$(X_{in+2}\\bmod Mx+Mx,Y_{in+2}\\bmod My+My)$$\n$$(X_{in+3}\\bmod Mx,Y_{in+3}\\bmod My)$$\n$$\\dots$$\n$$(X_{in+n-1}\\bmod Mx,Y_{in+n-1}\\bmod My)$$\n\n为第 $i (0 \\le i \\lt T)$ 组数据中的 $n$ 个电子元件的坐标。（**即前三个点的横纵坐标分别加上 $Mx$ 和 $My$**）。", "outputFormat": "每组数据输出一行，仅包含一个数，表示最短的铜线长度。", "hint": "**【样例 #1 解释】**\n\n```\ncase0:(5,3) (6,0) (4,9) \ncase1:(2,1) (1,4) (2,0) \ncase2:(1,3) (0,7) (3,1)\n```\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/8jkdlqid.png)\n\n**【样例 #2 解释】**\n\n```\ncase0: (0,3) (0,0) (1,1) (4,4) (0,1)\ncase1: (3,1) (2,3) (2,4) (4,3) (1,0)\ncase2: (3,2) (2,1) (0,2) (0,4) (3,1)\n```\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wj9yxar1.png)\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$n \\le 7,T \\le 10^6, a,c < 2^{31},Mx,My \\le 2^{16}$。\n\n本题共 $20$ 组数据，每组 $5$ 分。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/n3tts4tp.png)\n\n**【小贴士】**\n\n为了方便大家编写程序，在这里提供一个上述的数据生成的代码，仅供大家参考（不必以此为模板）。\n\n## C/C++：\n\n```cpp\nint X[7000010],Y[7000010];\nint n,T,a,c,Mx,My;\nlong long seedx,seedy;\nchar datatype[4];\n//生成数据，并将其对Mx，My取模后的值保存在X,Y这两个数组中\nvoid createList() {\nint AD = (1 << 16) - 1;\n  int i;\n  for (i = 0;i < n*T;i++) {\n    X[i] = seedx % Mx;\n    Y[i] = seedy % My;\nif (i % n < 3 && datatype[0] == 'B')\nX[i] += Mx,Y[i] += My;\n    seedx = (((a * seedx + c) >> 16) & AD);\n    seedy = (((a * seedy + c) >> 16) & AD);\n  }\n}\n\nint main() {\n  scanf(\"%d%d%d%d%d%d%d%d%s\",\n&T, &n, &a, &c, &Mx, &My, &seedx, &seedy, datatype);\n  createList();\n//你的计算代码\n  return 0;\n}\n```\n\n## Pascal：\n\n```pas\nvar \n  ax,ay:array[0..7000000] of longint;\n  n,T,a,c,Mx,My:longint;\n  seedx,seedy:int64;\n  datatype:char;\n  i,j:longint;\n//生成数据，并将其对Mx，My取模后的值保存在ax,ay这两个数组中\nprocedure createList;\nvar AD,i:longint;\nbegin\n  AD := (1 shl 16) - 1;\n  for i:=0 to n * T - 1 do\n  begin\n    ax[i] := seedx mod Mx;\n    ay[i] := seedy mod My;\n    if ((i mod n < 3) and (datatype = 'B')) then\n    begin\n      ax[i] := ax[i] + Mx;\n      ay[i] := ay[i] + My;\n    end;\n    seedx := (((a * seedx + c) shr 16) and AD);\n    seedy := (((a * seedy + c) shr 16) and AD);\n  end;\nend;\nbegin\n  read(T,n,a,c,Mx,My,seedx,seedy);\n  read(datatype);\n  while (datatype = ' ') do read(datatype);\n  createList;\n  //你的计算代码\nend.\n```", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THOI 2014] 印刷电路板", "background": "搬运自 [2014 年清华大学信息学邀请赛](https://gitlink.org.cn/thusaa/thoi2014)。", "description": "Printed Circuit Board（简称PCB），印刷电路板，它可以固定各种电子元器件，然后将它们连接起来，使得整个系统能够实现我们所需要的功能。因此，“焊板子”是一个很多工科学生（尤其是电子、自动化系的同学）都需要掌握的技能。\n\n现代电路板多用印刷技术制成。印刷线路板的最大特点是装配的元件紧凑、美观，并且适合于工厂的大规模生产。当然也适合各种电子小制作。这种线路板的基板是矩形的，用环氧板或纸质板制成。在基板上面用热压工艺贴上一层很薄的铜箔。用印刷法把电路印在铜箔上，再用腐蚀法把不需要的铜箔去掉，留下的铜箔便构成电路，最后钻上小孔，涂上助焊保护剂，电路板便制成了。\n\n由于技术的限制，电路板上铜线的宽度是确定的，并且铜线必须平行于电路板的边界（也就是说铜线必须平行于坐标轴）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/c0efse5g.png)\n\n例如以上两幅图都是可行的电路板。\n\n现在 R 同学需要制作很多很多电路板，每个电路板上有若干个电子元件。他需要合理布置电路使得铜箔将所有电子元件都连通，并且消耗的铜最少。", "inputFormat": "第一行输入两个正整数 $T,n$，表示R同学需要制作的电路板数量和每块电路板上的电子元件数。\n\n由于输入数据规模庞大，因此采用输入种子后随机生成的方式。\n\n第二行输入 $6$ 个正整数 $a,c,Mx,My,seedx,seedy$，以及一个字符 $datatype$，并用以下方式生成序列 $X_i,Y_i$：\n\n$$X_0=seedx, X_i=((aX_{i-1}+c) \\div 2^{16})\\bmod 2^{16}$$\n\n$$Y_0=seedy, Y_i=((aY_{i-1}+c) \\div 2^{16})\\bmod 2^{16}$$\n\n若 $datatype$ 为 `B`，则：\n\n$$(X_{in}\\bmod Mx+Mx,Y_{in}\\bmod My+My)$$\n$$(X_{in+1}\\bmod Mx+Mx,Y_{in+1}\\bmod My+My)$$\n$$(X_{in+2}\\bmod Mx+Mx,Y_{in+2}\\bmod My+My)$$\n$$(X_{in+3}\\bmod Mx+Mx,Y_{in+}\\bmod My+My)$$\n$$\\dots$$\n$$(X_{in+n-1}\\bmod Mx_+Mx,Y_{in+n-1}\\bmod My+My)$$\n\n为第 $i (0 \\le i \\lt T)$ 组数据中的 $n$ 个电子元件的坐标。\n\n若 $datatype$ 为 `B`，则：\n\n$$(X_{in}\\bmod Mx+Mx,Y_{in}\\bmod My+My)$$\n$$(X_{in+1}\\bmod Mx+Mx,Y_{in+1}\\bmod My+My)$$\n$$(X_{in+2}\\bmod Mx+Mx,Y_{in+2}\\bmod My+My)$$\n$$(X_{in+3}\\bmod Mx,Y_{in+3}\\bmod My)$$\n$$\\dots$$\n$$(X_{in+n-1}\\bmod Mx,Y_{in+n-1}\\bmod My)$$\n\n为第 $i (0 \\le i \\lt T)$ 组数据中的 $n$ 个电子元件的坐标。（**即前三个点的横纵坐标分别加上 $Mx$ 和 $My$**）。", "outputFormat": "每组数据输出一行，仅包含一个数，表示最短的铜线长度。", "hint": "**【样例 #1 解释】**\n\n```\ncase0:(5,3) (6,0) (4,9) \ncase1:(2,1) (1,4) (2,0) \ncase2:(1,3) (0,7) (3,1)\n```\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/8jkdlqid.png)\n\n**【样例 #2 解释】**\n\n```\ncase0: (0,3) (0,0) (1,1) (4,4) (0,1)\ncase1: (3,1) (2,3) (2,4) (4,3) (1,0)\ncase2: (3,2) (2,1) (0,2) (0,4) (3,1)\n```\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wj9yxar1.png)\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$n \\le 7,T \\le 10^6, a,c < 2^{31},Mx,My \\le 2^{16}$。\n\n本题共 $20$ 组数据，每组 $5$ 分。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/n3tts4tp.png)\n\n**【小贴士】**\n\n为了方便大家编写程序，在这里提供一个上述的数据生成的代码，仅供大家参考（不必以此为模板）。\n\n## C/C++：\n\n```cpp\nint X[7000010],Y[7000010];\nint n,T,a,c,Mx,My;\nlong long seedx,seedy;\nchar datatype[4];\n//生成数据，并将其对Mx，My取模后的值保存在X,Y这两个数组中\nvoid createList() {\nint AD = (1 << 16) - 1;\n  int i;\n  for (i = 0;i < n*T;i++) {\n    X[i] = seedx % Mx;\n    Y[i] = seedy % My;\nif (i % n < 3 && datatype[0] == 'B')\nX[i] += Mx,Y[i] += My;\n    seedx = (((a * seedx + c) >> 16) & AD);\n    seedy = (((a * seedy + c) >> 16) & AD);\n  }\n}\n\nint main() {\n  scanf(\"%d%d%d%d%d%d%d%d%s\",\n&T, &n, &a, &c, &Mx, &My, &seedx, &seedy, datatype);\n  createList();\n//你的计算代码\n  return 0;\n}\n```\n\n## Pascal：\n\n```pas\nvar \n  ax,ay:array[0..7000000] of longint;\n  n,T,a,c,Mx,My:longint;\n  seedx,seedy:int64;\n  datatype:char;\n  i,j:longint;\n//生成数据，并将其对Mx，My取模后的值保存在ax,ay这两个数组中\nprocedure createList;\nvar AD,i:longint;\nbegin\n  AD := (1 shl 16) - 1;\n  for i:=0 to n * T - 1 do\n  begin\n    ax[i] := seedx mod Mx;\n    ay[i] := seedy mod My;\n    if ((i mod n < 3) and (datatype = 'B')) then\n    begin\n      ax[i] := ax[i] + Mx;\n      ay[i] := ay[i] + My;\n    end;\n    seedx := (((a * seedx + c) shr 16) and AD);\n    seedy := (((a * seedy + c) shr 16) and AD);\n  end;\nend;\nbegin\n  read(T,n,a,c,Mx,My,seedx,seedy);\n  read(datatype);\n  while (datatype = ' ') do read(datatype);\n  createList;\n  //你的计算代码\nend.\n```", "locale": "zh-CN"}}}
{"pid": "P12072", "type": "P", "difficulty": 7, "samples": [["4 2 10007\n4\n1\n2\n3", "14\n6\n6\n14"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2014", "THUSC"], "title": "[THOI 2014] 超立方体", "background": "搬运自 [2014 年清华大学信息学邀请赛](https://gitlink.org.cn/thusaa/thoi2014)。", "description": "$\\bf{B}$ 君得到了一个神奇的超立方体，具体来说这是一个 $m$ 维的超立方体，一共有 $n=2^m$ 个顶点，我们将这些点从 $0$ 到 $n-1$ 标号。\n\n对于点 $i$，我们可以把 $i$ 转换成 $m$ 位二进制表示，如果不足 $m$ 位则高位补 $0$。这样得到的一个 $m$ 维坐标就是这个点的坐标。\n\n如果两个点的欧几里得距离为 $1$（也就是说，在原先的超立方体中有一条边连接它们），那么它们是相邻的。\n\n点 $i$ 有 $p_i$ 个信息，每过一个周期，每个点都会向相邻节点发送这些信息，且自己不保留这些信息。具体来说，点 $i$ 的信息总和变为它相邻的 $m$ 个点的信息和。\n\n现在 $\\bf{B}$ 君已知 $n$ 个点的初始信息 $p_i$，他想预言 $t$ 个周期之后所有点的信息分别是多少。\n\n$\\bf{B}$ 君对此一筹莫展，于是找到了他的好朋友 $\\bf{R}$ 君。\n\n$\\bf{R}$ 君：“$n$ 和 $t$ 有多大？”\n\n$\\bf{B}$ 君：“$n$ 大约是 $2^{20}$，$t$ 大约是 $10^{18}$。”\n\n$\\bf{R}$ 君：“那这个结果太大了，即便算出来，也根本存不下。”\n\n$\\bf{B}$ 君：“那么就将最终结果模一个数吧。”\n\n$\\bf{R}$ 君：“那我再来想想看。”", "inputFormat": "第一行三个整数 $n,t$ 和 $K$，其中 $K$ 为 $32$ 位无符号整数。\n\n以下 $n$ 行，每行一个整数 $p_i(p_i<K)$，含义如题目描述。", "outputFormat": "一共 $n$ 行，每行一个整数 $q_i$，表示 $t$ 个周期后 $i$ 节点信息总和除以 $K$ 的余数。", "hint": "### 【对样例的说明】\n![](https://cdn.luogu.com.cn/upload/image_hosting/hyzquwpk.png)\n\n### 【数据规模与约定】\n![](https://cdn.luogu.com.cn/upload/image_hosting/8d8u0jng.png)\n\n- 特别说明 $1$：所有编号为奇数的测试点，$K$ 为合数；所有编号为偶数的测试点，$K$ 为质数。\n- 特别说明 $2$：最开始时，有超过 $20$ 个点上没有任何信息。\n- 特别说明 $3$：最开始时，仅有 $5$ 个点上存有信息。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THOI 2014] 超立方体", "background": "搬运自 [2014 年清华大学信息学邀请赛](https://gitlink.org.cn/thusaa/thoi2014)。", "description": "$\\bf{B}$ 君得到了一个神奇的超立方体，具体来说这是一个 $m$ 维的超立方体，一共有 $n=2^m$ 个顶点，我们将这些点从 $0$ 到 $n-1$ 标号。\n\n对于点 $i$，我们可以把 $i$ 转换成 $m$ 位二进制表示，如果不足 $m$ 位则高位补 $0$。这样得到的一个 $m$ 维坐标就是这个点的坐标。\n\n如果两个点的欧几里得距离为 $1$（也就是说，在原先的超立方体中有一条边连接它们），那么它们是相邻的。\n\n点 $i$ 有 $p_i$ 个信息，每过一个周期，每个点都会向相邻节点发送这些信息，且自己不保留这些信息。具体来说，点 $i$ 的信息总和变为它相邻的 $m$ 个点的信息和。\n\n现在 $\\bf{B}$ 君已知 $n$ 个点的初始信息 $p_i$，他想预言 $t$ 个周期之后所有点的信息分别是多少。\n\n$\\bf{B}$ 君对此一筹莫展，于是找到了他的好朋友 $\\bf{R}$ 君。\n\n$\\bf{R}$ 君：“$n$ 和 $t$ 有多大？”\n\n$\\bf{B}$ 君：“$n$ 大约是 $2^{20}$，$t$ 大约是 $10^{18}$。”\n\n$\\bf{R}$ 君：“那这个结果太大了，即便算出来，也根本存不下。”\n\n$\\bf{B}$ 君：“那么就将最终结果模一个数吧。”\n\n$\\bf{R}$ 君：“那我再来想想看。”", "inputFormat": "第一行三个整数 $n,t$ 和 $K$，其中 $K$ 为 $32$ 位无符号整数。\n\n以下 $n$ 行，每行一个整数 $p_i(p_i<K)$，含义如题目描述。", "outputFormat": "一共 $n$ 行，每行一个整数 $q_i$，表示 $t$ 个周期后 $i$ 节点信息总和除以 $K$ 的余数。", "hint": "### 【对样例的说明】\n![](https://cdn.luogu.com.cn/upload/image_hosting/hyzquwpk.png)\n\n### 【数据规模与约定】\n![](https://cdn.luogu.com.cn/upload/image_hosting/8d8u0jng.png)\n\n- 特别说明 $1$：所有编号为奇数的测试点，$K$ 为合数；所有编号为偶数的测试点，$K$ 为质数。\n- 特别说明 $2$：最开始时，有超过 $20$ 个点上没有任何信息。\n- 特别说明 $3$：最开始时，仅有 $5$ 个点上存有信息。", "locale": "zh-CN"}}}
{"pid": "P12073", "type": "P", "difficulty": 7, "samples": [["5 1 5 1 1 9\n5 1\n5 1\n0 0\n0 1\n0 2\n1 0\n1 1\n1 2\n2 0\n2 1\n2 2", "Yes\nNo\nYes\nNo\nNo\nYes\nYes\nYes\nYes"], ["7 3 7 3 2 12\n2 1\n3 2\n2 1\n2 2\n3 1\n2 2\n0 2\n0 3\n0 4\n1 2\n1 3\n1 4\n2 5\n2 6\n3 5\n3 6\n4 5\n4 6", "Yes\nNo\nYes\nYes\nNo\nYes\nNo\nYes\nNo\nYes\nYes\nYes"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2025", "Moscow Olympiad"], "title": "[OOI 2025] Alice, Bob, and two arrays.", "background": "", "description": "There is an array $a$ of length $N$ and an array $b$ of length $M$. All numbers in the arrays are integers and lie in the range from 1 to $k$. There is also an initially empty array $c$.\n\nAlice and Bob play the following game on these arrays: the players take turns, and on their turn, a player must append a number to the end of the array $c$ such that $c$ remains a subsequence of both $a$ and $b$. The player who cannot make a move loses. Alice goes first.\n\nThey will play the game $q$ times. For the $i$-th game, they will choose two numbers $x_i$ and $y_i$ ($0 \\le x_i < N, 0 \\le y_i < M$), then remove the first $x_i$ elements from array $a$ and the first $y_i$ elements from array $b$, and then play the game on the resulting arrays. After each deletion operation and before the next one, the arrays $a$ and $b$ are restored to their initial state, meaning that the numbers deleted from the arrays in one game may not be deleted in subsequent games. Also, the array $c$ is cleared between games.\n\nThe guys have their quirks, so they always choose $x_i$ and $y_i$ in such a way that after the deletions, **the remaining parts of arrays $a$ and $b$ start with the same value**.\n\nAlice really wants to win, so she asks you to determine for each game whether she can win, assuming both players play optimally.\n\nNote that the arrays can be very long, so they are provided in a special format. Each array is given as a sequence of segments of equal numbers. Array $a$ consists of $n$ such segments, and array $b$ consists of $m$ such segments. Each segment is defined by its length and the number that occupies that segment.", "inputFormat": "The first line contains six integers $N, n, M, m, k, q$ ($1 \\le N, M \\le 10^9, 1 \\le n, m, k \\le 1600, 1 \\le q \\le 10^6$) — the length of the first array, the number of segments in the first array, the length of the second array, the number of segments in the second array, the number limit, and the number of games, respectively.\n\nThe next $n$ lines contain two integers $l_i^a$ and $v_i^a$ ($1 \\le l_i^a \\le N, 1 \\le v_i^a \\le k$) — the length of the segment and the number written in that segment. These numbers define array $a$: the first $l_1^a$ numbers of array $a$ are equal to $v_1^a$, the next $l_2^a$ numbers are equal to $v_2^a$, ..., the last $l_n^a$ numbers are equal to $v_n^a$.\n\nThe next $m$ lines contain two integers $l_i^b$ and $v_i^b$ ($1 \\le l_i^b \\le N, 1 \\le v_i^b \\le k$) — the length of the segment and the number written in that segment. These numbers define array $b$. The format is similar to array $a$. It is guaranteed that $\\sum l_i^a = N, \\sum l_i^b = M, v_i^a \\ne v_{i+1}^a$, and $v_i^b \\ne v_{i+1}^b$.\n\nThe next $q$ lines contain pairs of integers $x_i$ and $y_i$ ($0 \\le x_i < N, 0 \\le y_i < M$) — descriptions of the games.\n\nFor each game $i$, it is guaranteed that if we remove the first $x_i$ elements from $a$ and the first $y_i$ elements from $b$, the remaining parts of the arrays will start with the same value.", "outputFormat": "For each of the $q$ games, print \"Yes\" if Alice wins with optimal strategy, and \"No\" if Bob wins.", "hint": "**Note**\n\nIn the first example, the arrays look like this: $a = (1, 1, 1, 1, 1)$ and $b = (1, 1, 1, 1, 1)$.\n\n*   In the first query, $x = 0, y = 0$, so the game will be played on the arrays $a = (1, 1, 1, 1, 1)$ and $b = (1, 1, 1, 1, 1)$. In this case, players can only append the number 1 to the array $c$, so after 5 moves the game will end, and Bob will lose because he won't be able to make a move.\n*   In the second query, $x = 0, y = 1$, so the game will be played on the arrays $a = (1, 1, 1, 1, 1)$ and $b = (1, 1, 1, 1)$. In this case, the game will end after 4 moves, and Alice will lose.\n*   In the last query, $x = 2, y = 2$, so the game will be played on the arrays $a = (1, 1, 1)$ and $b = (1, 1, 1)$. In this case, Bob will lose.\n\nIn the second example, $a = (1, 1, 2, 2, 2, 1, 1)$, $b = (2, 2, 1, 1, 1, 2, 2)$.\n\n*   In the first query, $x = 0$ and $y = 2$, so the game will be played on the arrays $a = (1, 1, 2, 2, 2, 1, 1)$ and $b = (1, 1, 1, 2, 2)$. If Alice appends the number 2 to the array $c$, Bob will also append the number 2, and then no moves will be left, so Alice will lose. Therefore, Alice must first append the number 1 to $c$. After this, for similar reasons, if Bob appends the number 2 to the array, he will lose. So, he is forced to append the number 1, and the array $c$ becomes $(1, 1)$. Then Alice again appends the number 1 to the array $c$, and Bob has no more moves left, so Alice wins.\n*   In the second query, $x = 0$ and $y = 3$, so the game will be played on the arrays $a = (1, 1, 2, 2, 2, 1, 1)$ and $b = (1, 1, 1, 2, 2)$. Following the reasoning in the previous example, Alice cannot append the number 2 to the array $c$, because then she will lose. But if Alice appends the number 1, then Bob will also append the number 1, and after that, Alice will lose for similar reasons. Therefore, Bob wins in this case.\n\n**Scoring**\n\nThe tests for this problem consist of eleven groups. Points for each group are given only if all tests of the group and all tests of the required groups are passed. Please note that passing the example tests is not required for some groups. $\\textbf{Offline-evaluation}$ means that the results of testing your solution on this group will only be available after the end of the competition.\n\n| Group | Points | Additional constraints |             |             | Required Groups | Comment                                                                                                                               |\n| :---- | :----- | :------------------- | :---------- | :---------- | :-------------- | :------------------------------------------------------------------------------------------------------------------------------------ |\n|       |        | $N, M$               | $n, m$      | $q$         |                 |                                                                                                                                       |\n| 0     | 0      | -                    | -           | -           | -               | Examples.                                                                                                                             |\n| 1     | 13     | $N, M \\le 300$       | -           | $q \\le 10^5$ | 0               |                                                                                                                                       |\n| 2     | 12     | $N, M \\le 5000$      | -           | $q \\le 10^5$ | 0, 1            |                                                                                                                                       |\n| 3     | 11     | -                    | -           | $q \\le 10^5$ | -               | $l_i^a \\le 1000$ and all $v_i^a$ are distinct, $l_i^b \\le 1000$ and all $v_i^b$ are distinct                                       |\n| 4     | 8      | -                    | -           | $q \\le 10^5$ | 3               | $l_i^a \\le 1000$ and all $v_i^a$ are distinct                                                                                         |\n| 5     | 10     | -                    | -           | $q \\le 10^5$ | -               | $l_1^a \\ge N - 500$ and $v_1^a = 1$, $l_1^b \\ge M - 500$ and $v_1^b = 1$                                                            |\n| 6     | 7      | $N, M \\le 10^5$      | $n, m \\le 100$ | $q \\le 10^5$ | -               | $k \\le 5$                                                                                                                             |\n| 7     | 6      | $N, M \\le 10^5$      | $n, m \\le 100$ | $q \\le 10^5$ | 0, 6            | $k \\le 50$                                                                                                                             |\n| 8     | 7      | -                    | $n, m \\le 100$ | $q \\le 10^5$ | 0, 6, 7         | $k \\le 50$                                                                                                                             |\n| 9     | 9      | -                    | $n, m \\le 800$ | $q \\le 10^5$ | 0, 6 - 8        |                                                                                                                                       |\n| 10    | 10     | -                    | -           | $q \\le 10^5$ | 0 - 9           | **Offline-evaluation.**                                                                                                                |\n| 11    | 7      | -                    | -           | -           | 0 - 10          | **Offline-evaluation.**                                                                                                                |\n", "locale": "en", "translations": {"en": {"title": "[OOI 2025] Alice, Bob, and two arrays.", "background": "", "description": "There is an array $a$ of length $N$ and an array $b$ of length $M$. All numbers in the arrays are integers and lie in the range from 1 to $k$. There is also an initially empty array $c$.\n\nAlice and Bob play the following game on these arrays: the players take turns, and on their turn, a player must append a number to the end of the array $c$ such that $c$ remains a subsequence of both $a$ and $b$. The player who cannot make a move loses. Alice goes first.\n\nThey will play the game $q$ times. For the $i$-th game, they will choose two numbers $x_i$ and $y_i$ ($0 \\le x_i < N, 0 \\le y_i < M$), then remove the first $x_i$ elements from array $a$ and the first $y_i$ elements from array $b$, and then play the game on the resulting arrays. After each deletion operation and before the next one, the arrays $a$ and $b$ are restored to their initial state, meaning that the numbers deleted from the arrays in one game may not be deleted in subsequent games. Also, the array $c$ is cleared between games.\n\nThe guys have their quirks, so they always choose $x_i$ and $y_i$ in such a way that after the deletions, **the remaining parts of arrays $a$ and $b$ start with the same value**.\n\nAlice really wants to win, so she asks you to determine for each game whether she can win, assuming both players play optimally.\n\nNote that the arrays can be very long, so they are provided in a special format. Each array is given as a sequence of segments of equal numbers. Array $a$ consists of $n$ such segments, and array $b$ consists of $m$ such segments. Each segment is defined by its length and the number that occupies that segment.", "inputFormat": "The first line contains six integers $N, n, M, m, k, q$ ($1 \\le N, M \\le 10^9, 1 \\le n, m, k \\le 1600, 1 \\le q \\le 10^6$) — the length of the first array, the number of segments in the first array, the length of the second array, the number of segments in the second array, the number limit, and the number of games, respectively.\n\nThe next $n$ lines contain two integers $l_i^a$ and $v_i^a$ ($1 \\le l_i^a \\le N, 1 \\le v_i^a \\le k$) — the length of the segment and the number written in that segment. These numbers define array $a$: the first $l_1^a$ numbers of array $a$ are equal to $v_1^a$, the next $l_2^a$ numbers are equal to $v_2^a$, ..., the last $l_n^a$ numbers are equal to $v_n^a$.\n\nThe next $m$ lines contain two integers $l_i^b$ and $v_i^b$ ($1 \\le l_i^b \\le N, 1 \\le v_i^b \\le k$) — the length of the segment and the number written in that segment. These numbers define array $b$. The format is similar to array $a$. It is guaranteed that $\\sum l_i^a = N, \\sum l_i^b = M, v_i^a \\ne v_{i+1}^a$, and $v_i^b \\ne v_{i+1}^b$.\n\nThe next $q$ lines contain pairs of integers $x_i$ and $y_i$ ($0 \\le x_i < N, 0 \\le y_i < M$) — descriptions of the games.\n\nFor each game $i$, it is guaranteed that if we remove the first $x_i$ elements from $a$ and the first $y_i$ elements from $b$, the remaining parts of the arrays will start with the same value.", "outputFormat": "For each of the $q$ games, print \"Yes\" if Alice wins with optimal strategy, and \"No\" if Bob wins.", "hint": "**Note**\n\nIn the first example, the arrays look like this: $a = (1, 1, 1, 1, 1)$ and $b = (1, 1, 1, 1, 1)$.\n\n*   In the first query, $x = 0, y = 0$, so the game will be played on the arrays $a = (1, 1, 1, 1, 1)$ and $b = (1, 1, 1, 1, 1)$. In this case, players can only append the number 1 to the array $c$, so after 5 moves the game will end, and Bob will lose because he won't be able to make a move.\n*   In the second query, $x = 0, y = 1$, so the game will be played on the arrays $a = (1, 1, 1, 1, 1)$ and $b = (1, 1, 1, 1)$. In this case, the game will end after 4 moves, and Alice will lose.\n*   In the last query, $x = 2, y = 2$, so the game will be played on the arrays $a = (1, 1, 1)$ and $b = (1, 1, 1)$. In this case, Bob will lose.\n\nIn the second example, $a = (1, 1, 2, 2, 2, 1, 1)$, $b = (2, 2, 1, 1, 1, 2, 2)$.\n\n*   In the first query, $x = 0$ and $y = 2$, so the game will be played on the arrays $a = (1, 1, 2, 2, 2, 1, 1)$ and $b = (1, 1, 1, 2, 2)$. If Alice appends the number 2 to the array $c$, Bob will also append the number 2, and then no moves will be left, so Alice will lose. Therefore, Alice must first append the number 1 to $c$. After this, for similar reasons, if Bob appends the number 2 to the array, he will lose. So, he is forced to append the number 1, and the array $c$ becomes $(1, 1)$. Then Alice again appends the number 1 to the array $c$, and Bob has no more moves left, so Alice wins.\n*   In the second query, $x = 0$ and $y = 3$, so the game will be played on the arrays $a = (1, 1, 2, 2, 2, 1, 1)$ and $b = (1, 1, 1, 2, 2)$. Following the reasoning in the previous example, Alice cannot append the number 2 to the array $c$, because then she will lose. But if Alice appends the number 1, then Bob will also append the number 1, and after that, Alice will lose for similar reasons. Therefore, Bob wins in this case.\n\n**Scoring**\n\nThe tests for this problem consist of eleven groups. Points for each group are given only if all tests of the group and all tests of the required groups are passed. Please note that passing the example tests is not required for some groups. $\\textbf{Offline-evaluation}$ means that the results of testing your solution on this group will only be available after the end of the competition.\n\n| Group | Points | Additional constraints |             |             | Required Groups | Comment                                                                                                                               |\n| :---- | :----- | :------------------- | :---------- | :---------- | :-------------- | :------------------------------------------------------------------------------------------------------------------------------------ |\n|       |        | $N, M$               | $n, m$      | $q$         |                 |                                                                                                                                       |\n| 0     | 0      | -                    | -           | -           | -               | Examples.                                                                                                                             |\n| 1     | 13     | $N, M \\le 300$       | -           | $q \\le 10^5$ | 0               |                                                                                                                                       |\n| 2     | 12     | $N, M \\le 5000$      | -           | $q \\le 10^5$ | 0, 1            |                                                                                                                                       |\n| 3     | 11     | -                    | -           | $q \\le 10^5$ | -               | $l_i^a \\le 1000$ and all $v_i^a$ are distinct, $l_i^b \\le 1000$ and all $v_i^b$ are distinct                                       |\n| 4     | 8      | -                    | -           | $q \\le 10^5$ | 3               | $l_i^a \\le 1000$ and all $v_i^a$ are distinct                                                                                         |\n| 5     | 10     | -                    | -           | $q \\le 10^5$ | -               | $l_1^a \\ge N - 500$ and $v_1^a = 1$, $l_1^b \\ge M - 500$ and $v_1^b = 1$                                                            |\n| 6     | 7      | $N, M \\le 10^5$      | $n, m \\le 100$ | $q \\le 10^5$ | -               | $k \\le 5$                                                                                                                             |\n| 7     | 6      | $N, M \\le 10^5$      | $n, m \\le 100$ | $q \\le 10^5$ | 0, 6            | $k \\le 50$                                                                                                                             |\n| 8     | 7      | -                    | $n, m \\le 100$ | $q \\le 10^5$ | 0, 6, 7         | $k \\le 50$                                                                                                                             |\n| 9     | 9      | -                    | $n, m \\le 800$ | $q \\le 10^5$ | 0, 6 - 8        |                                                                                                                                       |\n| 10    | 10     | -                    | -           | $q \\le 10^5$ | 0 - 9           | **Offline-evaluation.**                                                                                                                |\n| 11    | 7      | -                    | -           | -           | 0 - 10          | **Offline-evaluation.**                                                                                                                |\n", "locale": "en"}, "zh-CN": {"title": "[OOI 2025] Alice, Bob, and two arrays.", "background": "[试题来源](https://inf-open.ru/2024-25/final-materials/)。", "description": "给定一个长度为 $N$ 的数组 $a$ 和一个长度为 $M$ 的数组 $b$。数组中的所有数字都是整数，且范围在 $1$ 到 $k$ 之间。还有一个初始为空的数组 $c$。\n\nAlice 和 Bob 在这些数组上玩以下游戏：玩家轮流进行，轮到某个玩家时，他必须在数组 $c$ 的末尾追加一个数字，使得 $c$ 仍然是 $a$ 和 $b$ 共同的子序列。无法进行移动的玩家失败。Alice 先手。\n\n他们将进行 $q$ 次游戏。对于第 $i$ 场游戏，他们会选择两个数 $x_i$ 和 $y_i$（$0 \\le x_i < N，0 \\le y_i < M$），然后从数组 $a$ 中移除前 $x_i$ 个元素，从数组 $b$ 中移除前 $y_i$ 个元素，接着在得到的数组上进行游戏。每次删除操作之后、下一次操作之前，数组 $a$ 和 $b$ 会恢复到它们的初始状态，这意味着在一场游戏中从数组中删除的数字可能不会在后续游戏中被删除。此外，数组 $c$ 在两场游戏之间会被清空。\n\n这两个人有他们的怪癖，所以他们总是以这样的方式选择 $x_i$ 和 $y_i$：在删除之后，**数组 $a$ 和 $b$ 的剩余部分以相同的值开头**。\n\nAlice 非常想赢，所以她请你判断对于每场游戏，假设双方都进行最优策略，她是否能赢。\n\n注意，数组可能非常长，因此它们以特殊格式给出。每个数组都表示为由等值数字组成的段的序列。数组 $a$ 由 $n$ 个这样的段组成，数组 $b$ 由 $m$ 个这样的段组成。每个段由其长度和该段中的数字定义。", "inputFormat": "第一行包含六个整数 $N、n、M、m、k、q$（$1 \\le N, M \\le 10^9，1 \\le n, m, k \\le 1600，1 \\le q \\le 10^6$）—— 分别是第一个数组的长度、第一个数组中的段数、第二个数组的长度、第二个数组中的段数、数值上限和游戏次数。\n\n接下来的 $n$ 行，每行包含两个整数 $l_i^a$ 和 $v_i^a$（$1 \\le l_i^a \\le N，1 \\le v_i^a \\le k$）—— 该段的长度和该段中的数字。这些数字定义了数组 $a$：数组 $a$ 的前 $l_1^a$ 个数等于 $v_1^a$，接下来的 $l_2^a$ 个数等于 $v_2^a$，……，最后 $l_n^a$ 个数等于 $v_n^a$。\n\n接下来的 $m$ 行，每行包含两个整数 $l_i^b$ 和 $v_i^b$（$1 \\le l_i^b \\le N，1 \\le v_i^b \\le k$）—— 该段的长度和该段中的数字。这些数字定义了数组 $b$。格式与数组 $a$ 类似。保证 $\\sum l_i^a = N$，$\\sum l_i^b = M$，$v_i^a \\ne v_{i+1}^a$ 且 $v_i^b \\ne v_{i+1}^b$。\n\n接下来的 $q$ 行包含整数对 $x_i$ 和 $y_i$（$0 \\le x_i < N，0 \\le y_i < M$）—— 游戏的描述。\n\n对于每场游戏 $i$，保证如果我们从 $a$ 中移除前 $x_i$ 个元素，并从 $b$ 中移除前 $y_i$ 个元素，则数组的剩余部分将以相同的值开头。", "outputFormat": "对于 $q$ 场游戏中的每一场，如果 Alice 在最优策略下获胜，则打印 `Yes`，如果 Bob 获胜，则打印 `No`。", "hint": "**样例解释**\n\n在第一个示例中，数组看起来像这样：$a = (1, 1, 1, 1, 1)$ 且 $b = (1, 1, 1, 1, 1)$。\n\n*   在第一个查询中，$x = 0，y = 0$，因此游戏将在数组 $a = (1, 1, 1, 1, 1)$ 和 $b = (1, 1, 1, 1, 1)$ 上进行。在这种情况下，玩家只能将数字 $1$ 追加到数组 $c$ 中，因此 5 步之后游戏将结束，Bob 将会失败，因为他无法再进行移动。\n*   在第二个查询中，$x = 0，y = 1$，因此游戏将在数组 $a = (1, 1, 1, 1, 1)$ 和 $b = (1, 1, 1, 1)$ 上进行。在这种情况下，游戏将在 4 步之后结束，Alice 将会失败。\n*   在最后一个查询中，$x = 2，y = 2$，因此游戏将在数组 $a = (1, 1, 1)$ 和 $b = (1, 1, 1)$ 上进行。在这种情况下，Bob 将会失败。\n\n在第二个示例中，$a = (1, 1, 2, 2, 2, 1, 1)$，$b = (2, 2, 1, 1, 1, 2, 2)$。\n\n*   在第一个查询中，$x = 0$ 且 $y = 2$，因此游戏将在数组 $a = (1, 1, 2, 2, 2, 1, 1)$ 和 $b = (1, 1, 1, 2, 2)$ 上进行。如果 Alice 将数字 $2$ 追加到数组 $c$ 中，Bob 也会追加数字 $2$，然后就没有移动机会了，所以 Alice 会失败。因此，Alice 必须首先将数字 $1$ 追加到 $c$。此后，出于类似的原因，如果 Bob 将数字 $2$ 追加到数组中，他将会失败。所以，他被迫追加数字 $1$，数组 $c$ 变为 $(1, 1)$。然后 Alice 再次将数字 $1$ 追加到数组 $c$ 中，Bob 没有更多移动机会了，所以 Alice 获胜。\n*   在第二个查询中，$x = 0$ 且 $y = 3$，因此游戏将在数组 $a = (1, 1, 2, 2, 2, 1, 1)$ 和 $b = (1, 1, 1, 2, 2)$ 上进行。根据上一个示例的推理，Alice 不能将数字 $2$ 追加到数组 $c$ 中，因为那样她会失败。但是如果 Alice 追加数字 $1$，那么 Bob 也会追加数字 $1$，之后，Alice 会因为类似的原因而失败。因此，在这种情况下 Bob 获胜。\n\n**评分**\n\n本题的测试点包含十一个分组。每个分组的分数只有在该分组的所有测试点以及所有依赖分组的测试点都通过时才能获得。请注意，通过样例测试点对于某些分组不是必需的。Offline-evaluation 表示该分组的测试结果将在比赛结束后才可查看。\n\n| Subtask | 分数 | 额外限制             |             |             | 依赖组别 | 说明                                                                                                                                  |\n| :--- | :--- | :------------------- | :---------- | :---------- | :------- | :------------------------------------------------------------------------------------------------------------------------------------ |\n|      |      | $N, M$               | $n, m$      | $q$         |          |                                                                                                                                       |\n| 0    | 0    | -                    | -           | -           | -        | 样例。                                                                                                                                |\n| 1    | 13   | $N, M \\le 300$       | -           | $q \\le 10^5$ | 0        |                                                                                                                                       |\n| 2    | 12   | $N, M \\le 5000$      | -           | $q \\le 10^5$ | 0, 1     |                                                                                                                                       |\n| 3    | 11   | -                    | -           | $q \\le 10^5$ | -        | $l_i^a \\le 1000$ 且所有 $v_i^a$ 不同，$l_i^b \\le 1000$ 且所有 $v_i^b$ 不同                                                        |\n| 4    | 8    | -                    | -           | $q \\le 10^5$ | 3        | $l_i^a \\le 1000$ 且所有 $v_i^a$ 不同                                                                                                  |\n| 5    | 10   | -                    | -           | $q \\le 10^5$ | -        | $l_1^a \\ge N - 500$ 且 $v_1^a = 1$，$l_1^b \\ge M - 500$ 且 $v_1^b = 1$                                                              |\n| 6    | 7    | $N, M \\le 10^5$      | $n, m \\le 100$ | $q \\le 10^5$ | -        | $k \\le 5$                                                                                                                             |\n| 7    | 6    | $N, M \\le 10^5$      | $n, m \\le 100$ | $q \\le 10^5$ | 0, 6     | $k \\le 50$                                                                                                                            |\n| 8    | 7    | -                    | $n, m \\le 100$ | $q \\le 10^5$ | 0, 6, 7  | $k \\le 50$                                                                                                                            |\n| 9    | 9    | -                    | $n, m \\le 800$ | $q \\le 10^5$ | 0, 6 - 8 |                                                                                                                                       |\n| 10   | 10   | -                    | -           | $q \\le 10^5$ | 0 - 9    | Offline-evaluation。                                                                                                                 |\n| 11   | 7    | -                    | -           | -           | 0 - 10   | Offline-evaluation。                                                                                                                 |", "locale": "zh-CN"}}}
{"pid": "P12074", "type": "P", "difficulty": 7, "samples": [["4\n1 4\n1 2 3 4\n2 7\n10 3 7 1 4 6 3\n4 10\n103 354 1 227 179 189 142 201 165 140\n5 3\n-10 11 -4", "2\n18\n1085\n17"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "贪心", "2025", "动态规划优化", "斜率维护技巧 slope trick", "Moscow Olympiad"], "title": "[OOI 2025] The Arithmetic exercise", "background": "", "description": "Oleg and Dasha participated in a team competition, but unfortunately, they were unable to solve any problems. Oleg immediately realized that their team wasn't training enough. Then, their mutual friend suggested an interesting exercise. The exercise was quite simple, and to solve it, they only needed to know the rules of addition and subtraction of integers.\n\nYou are given an array $a$ of length $n$, where initially all values are zero. You are also given $m$ numbers $x_1,\\ x_2,\\ \\ldots\\ x_m$. Then, for each $i$ from $1$ to $m$, you choose some index $j_i$ and make the change $a_{j_i} = x_i - a_{j_i}$.\n\nHelp Oleg and Dasha determine what the maximum possible sum of the elements of array $a$ can be after all the changes, if the choices are made optimally.", "inputFormat": "Each test consists of several input data sets. The first line contains a single integer $t$ ($1 \\le t \\le 10\\,000$) --- the number of input data sets. Then follows the description of the data sets.\n\nThe first line of each data set contains two integers $n$ and $m$ ($1 \\le n, m \\le 300\\,000$) --- the length of the array $a$ and the number of values $x_i$, respectively.\n\nThe second line of each data set contains $m$ integers $x_1$, $x_2$, $\\ldots$, $x_m$ ($-10^9 \\le x_i \\le 10^9$) --- the description of the values.\n\nLet $N$ be the sum of $n$ over all data sets, and $M$ be the sum of $m$ over all data sets.\n\nIt is guaranteed that $N$ and $M$ do not exceed $300\\,000$.", "outputFormat": "For each data set, output a single number on a new line --- the maximum sum of the array $a$ that can be obtained.", "hint": "**Note**\n\nIn the first data set, all operations are applied to the first element of the array $a$. It sequentially becomes $1 - 0 = 1$, $2 - 1 = 1$, $3 - 1 = 2$, $4 - 2 = 2$, so the answer is $2$.\n\nIn the second data set, the following sequence of changes can be performed:\n\n\n- Apply the change to the first element: $a_1 = 10 - a_1 = 10 - 0 = 10$, $a = [10, 0]$.\n- Apply the change to the first element: $a_1 = 3 - a_1 = 3 - 10 = -7$, $a = [-7, 0]$.\n- Apply the change to the first element: $a_1 = 7 - a_1 = 7 - (-7) = 14$, $a = [14, 0]$.\n- Apply the change to the first element: $a_1 = 1 - a_1 = 1 - 14 = -13$, $a = [-13, 0]$.\n- Apply the change to the second element: $a_2 = 4 - a_2 = 4 - 0 = 4$, $a = [-13, 4]$.\n- Apply the change to the first element: $a_1 = 6 - a_1 = 6 - (-13) = 19$, $a = [19, 4]$.\n- Apply the change to the second element: $a_2 = 3 - a_2 = 3 - 4 = -1$, $a = [19, -1]$.\n\nAt the end, we have $a = [19, -1]$, so the final sum is $18$.\n\nIt can be shown that a better result is not possible.\n\n**Scoring**\n\nThe tests for this problem consist of ten groups. Points for each group are given only if all tests of the group and all tests of the required groups are passed. Please note that passing the example tests is not required for some groups. $\\textbf{Offline-evaluation}$ means that the results of testing your solution on this group will only be available after the end of the competition.\n\n| Group | Points | Additional constraints: $n, N$ | Additional constraints: $m, M$ | Additional constraints: $x_i$ | Required Groups | Comment                                                      |\n| :---- | :----- | :----------------------------- | :----------------------------- | :---------------------------- | :-------------- | :----------------------------------------------------------- |\n| 0     | 0      | --                             | --                             | --                            | --              | Examples.                                                    |\n| 1     | 4      | --                             | --                             | $0 \\le x_i$                   | --              | All $x_i$ are same                                           |\n| 2     | 8      | $n=2$                          | $M \\le 30$, $m \\le 18$      | --                            | --              |                                                              |\n| 3     | 11     | $n=2$                          | $M \\le 50$                     | $-10 \\le x_i \\le 10$          | --              |                                                              |\n| 4     | 9      | $n=2$                          | $M \\le 400$                    | $-400 \\le x_i \\le 400$        | 3               |                                                              |\n| 5     | 8      | $N \\le 30$, $n \\le 18$      | $M \\le 30$, $m \\le 18$      | --                            | 0               |                                                              |\n| 6     | 10     | $N \\le 2000$                   | $M \\le 2000$                   | $0 \\le x_i$                   | --              |                                                              |\n| 7     | 12     | $N \\le 2000$                   | $M \\le 2000$                   | --                            | 0, 2 -- 6       |                                                              |\n| 8     | 10     | --                             | --                             | $0 \\le x_i$                   | 1               | There are no more than two different values among $x_i$      |\n| 9     | 17     | --                             | --                             | $0 \\le x_i$                   | 1, 6, 8         |                                                              |\n| 10    | 11     | --                             | --                             | --                            | 0 -- 9          | **Offline-evaluation.**                                      |", "locale": "en", "translations": {"en": {"title": "[OOI 2025] The Arithmetic exercise", "background": "", "description": "Oleg and Dasha participated in a team competition, but unfortunately, they were unable to solve any problems. Oleg immediately realized that their team wasn't training enough. Then, their mutual friend suggested an interesting exercise. The exercise was quite simple, and to solve it, they only needed to know the rules of addition and subtraction of integers.\n\nYou are given an array $a$ of length $n$, where initially all values are zero. You are also given $m$ numbers $x_1,\\ x_2,\\ \\ldots\\ x_m$. Then, for each $i$ from $1$ to $m$, you choose some index $j_i$ and make the change $a_{j_i} = x_i - a_{j_i}$.\n\nHelp Oleg and Dasha determine what the maximum possible sum of the elements of array $a$ can be after all the changes, if the choices are made optimally.", "inputFormat": "Each test consists of several input data sets. The first line contains a single integer $t$ ($1 \\le t \\le 10\\,000$) --- the number of input data sets. Then follows the description of the data sets.\n\nThe first line of each data set contains two integers $n$ and $m$ ($1 \\le n, m \\le 300\\,000$) --- the length of the array $a$ and the number of values $x_i$, respectively.\n\nThe second line of each data set contains $m$ integers $x_1$, $x_2$, $\\ldots$, $x_m$ ($-10^9 \\le x_i \\le 10^9$) --- the description of the values.\n\nLet $N$ be the sum of $n$ over all data sets, and $M$ be the sum of $m$ over all data sets.\n\nIt is guaranteed that $N$ and $M$ do not exceed $300\\,000$.", "outputFormat": "For each data set, output a single number on a new line --- the maximum sum of the array $a$ that can be obtained.", "hint": "**Note**\n\nIn the first data set, all operations are applied to the first element of the array $a$. It sequentially becomes $1 - 0 = 1$, $2 - 1 = 1$, $3 - 1 = 2$, $4 - 2 = 2$, so the answer is $2$.\n\nIn the second data set, the following sequence of changes can be performed:\n\n\n- Apply the change to the first element: $a_1 = 10 - a_1 = 10 - 0 = 10$, $a = [10, 0]$.\n- Apply the change to the first element: $a_1 = 3 - a_1 = 3 - 10 = -7$, $a = [-7, 0]$.\n- Apply the change to the first element: $a_1 = 7 - a_1 = 7 - (-7) = 14$, $a = [14, 0]$.\n- Apply the change to the first element: $a_1 = 1 - a_1 = 1 - 14 = -13$, $a = [-13, 0]$.\n- Apply the change to the second element: $a_2 = 4 - a_2 = 4 - 0 = 4$, $a = [-13, 4]$.\n- Apply the change to the first element: $a_1 = 6 - a_1 = 6 - (-13) = 19$, $a = [19, 4]$.\n- Apply the change to the second element: $a_2 = 3 - a_2 = 3 - 4 = -1$, $a = [19, -1]$.\n\nAt the end, we have $a = [19, -1]$, so the final sum is $18$.\n\nIt can be shown that a better result is not possible.\n\n**Scoring**\n\nThe tests for this problem consist of ten groups. Points for each group are given only if all tests of the group and all tests of the required groups are passed. Please note that passing the example tests is not required for some groups. $\\textbf{Offline-evaluation}$ means that the results of testing your solution on this group will only be available after the end of the competition.\n\n| Group | Points | Additional constraints: $n, N$ | Additional constraints: $m, M$ | Additional constraints: $x_i$ | Required Groups | Comment                                                      |\n| :---- | :----- | :----------------------------- | :----------------------------- | :---------------------------- | :-------------- | :----------------------------------------------------------- |\n| 0     | 0      | --                             | --                             | --                            | --              | Examples.                                                    |\n| 1     | 4      | --                             | --                             | $0 \\le x_i$                   | --              | All $x_i$ are same                                           |\n| 2     | 8      | $n=2$                          | $M \\le 30$, $m \\le 18$      | --                            | --              |                                                              |\n| 3     | 11     | $n=2$                          | $M \\le 50$                     | $-10 \\le x_i \\le 10$          | --              |                                                              |\n| 4     | 9      | $n=2$                          | $M \\le 400$                    | $-400 \\le x_i \\le 400$        | 3               |                                                              |\n| 5     | 8      | $N \\le 30$, $n \\le 18$      | $M \\le 30$, $m \\le 18$      | --                            | 0               |                                                              |\n| 6     | 10     | $N \\le 2000$                   | $M \\le 2000$                   | $0 \\le x_i$                   | --              |                                                              |\n| 7     | 12     | $N \\le 2000$                   | $M \\le 2000$                   | --                            | 0, 2 -- 6       |                                                              |\n| 8     | 10     | --                             | --                             | $0 \\le x_i$                   | 1               | There are no more than two different values among $x_i$      |\n| 9     | 17     | --                             | --                             | $0 \\le x_i$                   | 1, 6, 8         |                                                              |\n| 10    | 11     | --                             | --                             | --                            | 0 -- 9          | **Offline-evaluation.**                                      |", "locale": "en"}, "zh-CN": {"title": "[OOI 2025] The arithmetic exercise", "background": "[试题来源](https://inf-open.ru/2024-25/final-materials/)。", "description": "Oleg 和 Dasha 参加了一场团队竞赛，但不幸的是，他们未能解决任何问题。Oleg 立刻意识到他们的队伍训练不足。然后，他们共同的朋友提出了一个有趣的练习。这个练习相当简单，要解决它，只需要知道整数加减法的规则。\n\n给定一个长度为 $n$ 的数组 $a$，初始时所有值均为零。同时给定 $m$ 个数 $x_1, x_2, \\ldots, x_m$。然后，对于从 $1$ 到 $m$ 的每个 $i$，你需要选择某个下标 $j_i$，并执行更改 $a_{j_i} = x_i - a_{j_i}$。\n\n请帮助 Oleg 和 Dasha 确定，如果每次选择都最优，那么在所有更改完成之后，数组 $a$ 的元素之和的最大值可能为多少。", "inputFormat": "每个测试包含多个输入数据集。第一行包含一个整数 $t$（$1 \\le t \\le 10\\,000$）—— 输入数据集的数量。\n\n每个数据集的第一行包含两个整数 $n$ 和 $m$。（$1 \\le n, m \\le 300\\,000$）\n\n每个数据集的第二行包含 $m$ 个整数 $x_1, x_2, \\ldots, x_m$。（$-10^9 \\le x_i \\le 10^9$）\n\n设 $N$ 为所有数据集中 $n$ 的总和，$M$ 为所有数据集中 $m$ 的总和。\n\n保证 $N$ 和 $M$ 均不超过 $300\\,000$。", "outputFormat": "对于每个数据集，在新的一行输出一个数字 —— 可以得到的数组 $a$ 的和的最大值。", "hint": "**样例解释**\n\n在第一个数据集中，所有操作都应用于数组 $a$ 的第一个元素。它依次变为 $1 - 0 = 1$，$2 - 1 = 1$，$3 - 1 = 2$，$4 - 2 = 2$，所以答案是 $2$。\n\n在第二个数据集中，可以执行以下更改序列：\n\n1.  将更改应用于第一个元素：$a_1 = 10 - a_1 = 10 - 0 = 10$，此时 $a = [10, 0]$。\n2.  将更改应用于第一个元素：$a_1 = 3 - a_1 = 3 - 10 = -7$，此时 $a = [-7, 0]$。\n3.  将更改应用于第一个元素：$a_1 = 7 - a_1 = 7 - (-7) = 14$，此时 $a = [14, 0]$。\n4.  将更改应用于第一个元素：$a_1 = 1 - a_1 = 1 - 14 = -13$，此时 $a = [-13, 0]$。\n5.  将更改应用于第二个元素：$a_2 = 4 - a_2 = 4 - 0 = 4$，此时 $a = [-13, 4]$。\n6.  将更改应用于第一个元素：$a_1 = 6 - a_1 = 6 - (-13) = 19$，此时 $a = [19, 4]$。\n7.  将更改应用于第二个元素：$a_2 = 3 - a_2 = 3 - 4 = -1$，此时 $a = [19, -1]$。\n\n最后，我们得到 $a = [19, -1]$，所以最终的和是 $18$。\n\n可以证明不可能得到更好的结果。\n\n**评分**\n\n本题的测试点包含十个分组。每个分组的分数只有在该分组的所有测试点以及所有依赖分组的测试点都通过时才能获得。请注意，通过样例测试点对于某些分组不是必需的。**Offline-evaluation** 表示该分组的测试结果将在比赛结束后才可查看。\n\n| Subtask | 分数 | 额外限制：$n, N$ | 额外限制：$m, M$ | 额外限制：$x_i$ | 依赖组别 | 说明                                                 |\n| :--- | :--- | :--------------- | :--------------- | :--------------- | :------- | :--------------------------------------------------- |\n| 0    | 0    | --               | --               | --               | --       | 样例。                                               |\n| 1    | 4    | --               | --               | $0 \\le x_i$      | --       | 所有 $x_i$ 都相同。                                  |\n| 2    | 8    | $n=2$            | $M \\le 30$，$m \\le 18$ | --               | --       |                                                      |\n| 3    | 11   | $n=2$            | $M \\le 50$       | $-10 \\le x_i \\le 10$ | --       |                                                      |\n| 4    | 9    | $n=2$            | $M \\le 400$      | $-400 \\le x_i \\le 400$ | 3        |                                                      |\n| 5    | 8    | $N \\le 30$，$n \\le 18$ | $M \\le 30$，$m \\le 18$ | --               | 0        |                                                      |\n| 6    | 10   | $N \\le 2000$     | $M \\le 2000$     | $0 \\le x_i$      | --       |                                                      |\n| 7    | 12   | $N \\le 2000$     | $M \\le 2000$     | --               | 0, 2 -- 6 |                                                      |\n| 8    | 10   | --               | --               | $0 \\le x_i$      | 1        | $x_i$ 中最多只有两个不同的值。                       |\n| 9    | 17   | --               | --               | $0 \\le x_i$      | 1, 6, 8  |                                                      |\n| 10   | 11   | --               | --               | --               | 0 -- 9   | **Offline-evaluation**。                             |", "locale": "zh-CN"}}}
{"pid": "P12075", "type": "P", "difficulty": 5, "samples": [["5 4\n1 2 2 1\n3 5 1 2 4\n5 3 1 4", "1 3 0 2"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2025", "Moscow Olympiad"], "title": "[OOI 2025] Dreaming is not harmful", "background": "", "description": "In the wedding agency M., mass layoffs are planned. All employees are busy counting the days until, with a favorable turn of events, they can head the company instead of working.\n\nThe structure of the company represents a suspended tree with the root at vertex number $1$. The immediate supervisor of employee number $v$ is the employee with number $p_v$. The level of competence of employee $v$ is defined by the parameter $s_v$. This parameter is different for all employees. The higher the level of competence, the more useful the employee is to the company. Note that as a result of an opaque hiring process, it may happen that a less competent employee is the supervisor of a more competent one.\n\nAs a result of significant personnel restructuring, every day the CEO, who is at the root of the working hierarchy, will be fired. If there are employees left in the company, the most competent immediate subordinate will take their place. After that, the other subordinates of the former director will become subordinates of the new director. See the explanations in the examples for a better understanding of the condition.\n\nEach employee easily calculated how many days it would take for them to become the CEO. Many were not ready to wait that long, as they would only get to be the director for one day! To speed up this process, they are ready to ``cancel`` one of their colleagues. The ``canceled`` employee's level of competence drops to $0$, as no one is willing to interact with them anymore.\n\nYou will need to answer $q$ queries. In the $k$-th query, employee number $v_k$ is interested in the minimum number of days until they can head the company if they are willing to ``cancel`` exactly one employee. All queries are imaginary and independent, and the real levels of competence of the employees remain unchanged for all queries.", "inputFormat": "The first line contains two integers $n$, $q$ ($2 \\le n \\le 300\\,000$, $1 \\le q \\le n$) --- the number of employees and the number of queries.\n\nThe second line contains $n - 1$ integers $p_2$, $p_3$, $\\ldots$, $p_{n}$ ($1 \\le p_i < i$) --- the immediate supervisors of employees numbered from $2$ to $n$.\n\nThe third line contains $n$ integers $s_1$, $s_2$, $\\ldots$, $s_n$ ($1 \\le s_i \\le n$) --- the levels of competence of the employees. It is guaranteed that they are all different.\n\nThe fourth line contains $q$ integers $v_1$, $v_2$, $\\dots$, $v_q$ ($1 \\le v_i \\le n$) --- the promotion queries. It is guaranteed that all numbers $v_i$ are distinct.", "outputFormat": "Output $q$ integers separated by spaces --- the minimum number of days after which employees $v_1, v_2, \\dots, v_q$ can become directors.", "hint": "**Note**\n\nIn the test example, the fifth employee can head the company in 1 day. To do this, it is enough to ``cancel`` the second employee. The structure of the company will change as follows:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/4ihwvwsj.png)\n\nThe third employee can head the company in 3 days. To do this, it is enough to ``cancel`` the fifth or fourth employee. If the fifth is canceled, the structure of the company will change as follows:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/grptp827.png)\n\nThe first employee is already the head of the company, so the answer to the corresponding query is $0$.\n\nThe fourth employee can become the head of the company in two days. It is enough, similarly to the previous example, to ``cancel`` the fifth employee.\n\n**Scoring**\n\nThe tests for this problem consist of nine groups. Points for each group are given only if all tests of the group and all tests of the required groups are passed. Please note that passing the example tests is not required for some groups. $\\textbf{Offline-evaluation}$ means that the results of testing your solution on this group will only be available after the end of the competition.\n\n| Group | Points | Additional constraints: n | Additional constraints: q | Required Groups | Comment                                                                       |\n| :---- | :----- | :------------------------ | :------------------------ | :-------------- | :---------------------------------------------------------------------------- |\n| 0     | 0      | --                        | --                        | --              | Examples.                                                                     |\n| 1     | 10     | --                        | --                        | --              | $p_i = 1$ or $p_i = i - 1$, with $p_i = 1$ for no more than two numbers $i$ |\n| 2     | 6      | --                        | --                        | 1               | $p_i = 1$ or $p_i = i - 1$                                                    |\n| 3     | 8      | $n \\le 50$                | $q \\le 50$                | 0               |                                                                               |\n| 4     | 13     | $n \\le 1000$              | $q \\le 1000$              | 0, 3            |                                                                               |\n| 5     | 11     | --                        | $q \\le 100$               | 0, 3            |                                                                               |\n| 6     | 9      | --                        | --                        | --              | $p_i = \\lfloor \\frac{i}{2} \\rfloor$                                           |\n| 7     | 11     | --                        | --                        | 0, 3, 6         | The number of supervisors* for any employee does not exceed $100$             |\n| 8     | 14     | --                        | --                        | --              | $s_i > s_{p_i}$ for any $i > 1$                                               |\n| 9     | 18     | --                        | --                        | 0 -- 8          | **Offline-evaluation.**                                                       |\n\nSupervisors* of an employee --- the set of their immediate supervisor and all supervisors of their immediate supervisor.", "locale": "en", "translations": {"en": {"title": "[OOI 2025] Dreaming is not harmful", "background": "", "description": "In the wedding agency M., mass layoffs are planned. All employees are busy counting the days until, with a favorable turn of events, they can head the company instead of working.\n\nThe structure of the company represents a suspended tree with the root at vertex number $1$. The immediate supervisor of employee number $v$ is the employee with number $p_v$. The level of competence of employee $v$ is defined by the parameter $s_v$. This parameter is different for all employees. The higher the level of competence, the more useful the employee is to the company. Note that as a result of an opaque hiring process, it may happen that a less competent employee is the supervisor of a more competent one.\n\nAs a result of significant personnel restructuring, every day the CEO, who is at the root of the working hierarchy, will be fired. If there are employees left in the company, the most competent immediate subordinate will take their place. After that, the other subordinates of the former director will become subordinates of the new director. See the explanations in the examples for a better understanding of the condition.\n\nEach employee easily calculated how many days it would take for them to become the CEO. Many were not ready to wait that long, as they would only get to be the director for one day! To speed up this process, they are ready to ``cancel`` one of their colleagues. The ``canceled`` employee's level of competence drops to $0$, as no one is willing to interact with them anymore.\n\nYou will need to answer $q$ queries. In the $k$-th query, employee number $v_k$ is interested in the minimum number of days until they can head the company if they are willing to ``cancel`` exactly one employee. All queries are imaginary and independent, and the real levels of competence of the employees remain unchanged for all queries.", "inputFormat": "The first line contains two integers $n$, $q$ ($2 \\le n \\le 300\\,000$, $1 \\le q \\le n$) --- the number of employees and the number of queries.\n\nThe second line contains $n - 1$ integers $p_2$, $p_3$, $\\ldots$, $p_{n}$ ($1 \\le p_i < i$) --- the immediate supervisors of employees numbered from $2$ to $n$.\n\nThe third line contains $n$ integers $s_1$, $s_2$, $\\ldots$, $s_n$ ($1 \\le s_i \\le n$) --- the levels of competence of the employees. It is guaranteed that they are all different.\n\nThe fourth line contains $q$ integers $v_1$, $v_2$, $\\dots$, $v_q$ ($1 \\le v_i \\le n$) --- the promotion queries. It is guaranteed that all numbers $v_i$ are distinct.", "outputFormat": "Output $q$ integers separated by spaces --- the minimum number of days after which employees $v_1, v_2, \\dots, v_q$ can become directors.", "hint": "**Note**\n\nIn the test example, the fifth employee can head the company in 1 day. To do this, it is enough to ``cancel`` the second employee. The structure of the company will change as follows:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/4ihwvwsj.png)\n\nThe third employee can head the company in 3 days. To do this, it is enough to ``cancel`` the fifth or fourth employee. If the fifth is canceled, the structure of the company will change as follows:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/grptp827.png)\n\nThe first employee is already the head of the company, so the answer to the corresponding query is $0$.\n\nThe fourth employee can become the head of the company in two days. It is enough, similarly to the previous example, to ``cancel`` the fifth employee.\n\n**Scoring**\n\nThe tests for this problem consist of nine groups. Points for each group are given only if all tests of the group and all tests of the required groups are passed. Please note that passing the example tests is not required for some groups. $\\textbf{Offline-evaluation}$ means that the results of testing your solution on this group will only be available after the end of the competition.\n\n| Group | Points | Additional constraints: n | Additional constraints: q | Required Groups | Comment                                                                       |\n| :---- | :----- | :------------------------ | :------------------------ | :-------------- | :---------------------------------------------------------------------------- |\n| 0     | 0      | --                        | --                        | --              | Examples.                                                                     |\n| 1     | 10     | --                        | --                        | --              | $p_i = 1$ or $p_i = i - 1$, with $p_i = 1$ for no more than two numbers $i$ |\n| 2     | 6      | --                        | --                        | 1               | $p_i = 1$ or $p_i = i - 1$                                                    |\n| 3     | 8      | $n \\le 50$                | $q \\le 50$                | 0               |                                                                               |\n| 4     | 13     | $n \\le 1000$              | $q \\le 1000$              | 0, 3            |                                                                               |\n| 5     | 11     | --                        | $q \\le 100$               | 0, 3            |                                                                               |\n| 6     | 9      | --                        | --                        | --              | $p_i = \\lfloor \\frac{i}{2} \\rfloor$                                           |\n| 7     | 11     | --                        | --                        | 0, 3, 6         | The number of supervisors* for any employee does not exceed $100$             |\n| 8     | 14     | --                        | --                        | --              | $s_i > s_{p_i}$ for any $i > 1$                                               |\n| 9     | 18     | --                        | --                        | 0 -- 8          | **Offline-evaluation.**                                                       |\n\nSupervisors* of an employee --- the set of their immediate supervisor and all supervisors of their immediate supervisor.", "locale": "en"}, "zh-CN": {"title": "[OOI 2025] Dreaming is not harmful", "background": "[试题来源](https://inf-open.ru/2024-25/final-materials/)。", "description": "在婚礼策划公司 M.，计划进行大规模裁员。所有员工都在忙着计算天数，期待着在有利的情况下，他们能够取代现有的领导，执掌公司。\n\n公司的结构表示为一个以顶点 $1$ 为根的悬挂树。员工编号 $v$ 的直接主管是编号为 $p_v$ 的员工。员工 $v$ 的能力水平由参数 $s_v$ 定义。这个参数是所有员工的独立值，且能力水平越高，员工对公司越有用。注意，由于不透明的招聘过程，可能会出现能力较低的员工是能力较高员工的主管的情况。\n\n由于公司进行大规模人员调整，每天位于工作层级结构根部的 CEO 会被解雇。如果公司中还有员工，则能力最强的直接下属会接替 CEO 的位置。之后，前任主管的其他下属将成为新任主管的下属。为了更好地理解这个条件，可以参考样例中的说明。\n\n每个员工都轻松地计算出自己成为 CEO 需要多少天。许多人不愿意等那么久，因为他们只能当一天的主管！为了加速这个过程，他们准备“拉黑”（cancel）一位同事。被“拉黑”的员工的能力水平会降至 $0$，因为没有人再愿意与他们互动。\n\n您需要回答 $q$ 个询问。在第 $k$ 个询问中，编号为 $v_k$ 的员工想知道，如果他们愿意“拉黑”**恰好**一名员工，他们能够领导公司的最少等待天数是多少。所有询问都是假想且独立的，员工的实际能力水平在所有询问中保持不变。", "inputFormat": "第一行包含两个整数 $n$ 和 $q$（$2 \\le n \\le 300\\,000$，$1 \\le q \\le n$）—— 员工数量和询问数量。\n\n第二行包含 $n - 1$ 个整数 $p_2, p_3, \\ldots, p_n$（$1 \\le p_i < i$）—— 编号从 $2$ 到 $n$ 的员工的直接主管。\n\n第三行包含 $n$ 个整数 $s_1, s_2, \\ldots, s_n$（$1 \\le s_i \\le n$）—— 员工的能力水平。保证它们都是不同的。\n\n第四行包含 $q$ 个整数 $v_1, v_2, \\dots, v_q$（$1 \\le v_i \\le n$）—— 晋升询问。保证所有数字 $v_i$ 都是不同的。", "outputFormat": "输出 $q$ 个用空格分隔的整数 —— 员工 $v_1, v_2, \\dots, v_q$ 能够成为主管的最少天数。", "hint": "**样例解释**\n\n在测试样例中，第五名员工可以在 1 天后领导公司。为此，只需“拉黑”第二名员工即可。公司结构将如下改变：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/4ihwvwsj.png)\n\n第三名员工可以在 3 天后领导公司。为此，只需“拉黑”第五名或第四名员工即可。如果拉黑第五名员工，公司结构将如下改变：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/grptp827.png)\n\n第一名员工已经是公司的领导者，因此对应查询的答案是 $0$。\n\n第四名员工可以在两天后成为公司领导。与前一个例子类似，只需“拉黑”第五名员工即可。\n\n**评分**\n\n本题的测试点包含九个分组。每个分组的分数只有在该分组的所有测试点以及所有依赖分组的测试点都通过时才能获得。请注意，通过样例测试点对于某些分组不是必需的。$\\textbf{Offline-evaluation}$ 表示该分组的测试结果将在比赛结束后才可查看。\n\n| Subtask | 分数 | 额外限制：$n$ | 额外限制：$q$ | 依赖组别 | 说明                                                                  |\n| :--- | :--- | :---------- | :---------- | :------- | :-------------------------------------------------------------------- |\n| 0    | 0    | --          | --          | --       | 样例。                                                                |\n| 1    | 10   | --          | --          | --       | $p_i = 1$ 或 $p_i = i - 1$，其中 $p_i = 1$ 的 $i$ 不超过两个。       |\n| 2    | 6    | --          | --          | 1        | $p_i = 1$ 或 $p_i = i - 1$。                                          |\n| 3    | 8    | $n \\le 50$  | $q \\le 50$  | 0        |                                                                      |\n| 4    | 13   | $n \\le 1000$ | $q \\le 1000$ | 0, 3     |                                                                      |\n| 5    | 11   | --          | $q \\le 100$ | 0, 3     |                                                                      |\n| 6    | 9    | --          | --          | --       | $p_i = \\lfloor \\frac{i}{2} \\rfloor$。                                 |\n| 7    | 11   | --          | --          | 0, 3, 6  | 任何员工的主管\\*数量不超过 $100$。                                    |\n| 8    | 14   | --          | --          | --       | $s_i > s_{p_i}$ 对于任何 $i > 1$。                                    |\n| 9    | 18   | --          | --          | 0 -- 8   | **Offline-evaluation.**                                               |\n\n主管\\*：直接或者间接的主管。", "locale": "zh-CN"}}}
{"pid": "P12076", "type": "P", "difficulty": 4, "samples": [["5 3\n3 7 10 1 2", "24"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2025", "Moscow Olympiad"], "title": "[OOI 2025] Cute Subsequences", "background": "", "description": "You are given an array of $n$ positive integers $a_1$, $a_2$, $\\ldots$, $a_n$, as well as a positive integer $k$. You need to divide the array into $k$ non-empty subsequences such that each element of the array belongs to exactly one subsequence. A subsequence is a sequence that can be obtained from another sequence by deleting some elements without changing the order of the remaining elements.\n\nLet the $i$-th subsequence contain elements with indices $j_1 < \\ldots < j_l$. The $\\textit{value}$ of this subsequence is defined as the maximum value of $a_{j_m} + m$ for all $m$ from $1$ to $l$.\n\nThe $\\textit{cost}$ of dividing the array into $k$ subsequences is the sum of the $\\textit{values}$ of these subsequences.\n\nFind the maximum $\\textit{cost}$ of the division.", "inputFormat": "The first line contains two positive integers $n$ and $k$ ($1 \\leq k \\leq n \\leq 500\\,000$) --- the size of the array and the number of subsequences to divide it into.\n\nThe second line contains $n$ positive integers $a_1$, $a_2$, $\\ldots$, $a_n$ ($1 \\leq a_i \\leq 10^9$) --- the elements of the array.", "outputFormat": "Output the maximum $\\textit{cost}$ of dividing the given array into $k$ non-empty subsequences.", "hint": "**Note**\n\nIn the sample test, the array can be divided into $[3, 10]$, $[7]$, $[1, 2]$. Then the answer will be $(10 + 2) + (7 + 1) + (2 + 2) = 12 + 8 + 4 = 24$.\n\n**Scoring**\n\nThe tests for this problem consist of six groups. Points for each group are given only if all tests of the group and all tests of the required groups are passed.\n\n| Group | Points | Additional Constraints: $n$ | Additional Constraints: $k$ | Required Groups | Comment                        |\n| :---- | :----- | :---------------------------- | :---------------------------- | :-------------- | :----------------------------- |\n| 0     | 0      | --                            | --                            | --              | Examples.                      |\n| 1     | 14     | $n \\le 8$                   | --                            | 0               |                                |\n| 2     | 19     | --                            | $k = 2$                     | --              |                                |\n| 3     | 17     | --                            | --                            | --              | $a_{i+1} \\leq a_i$           |\n| 4     | 21     | --                            | --                            | --              | $a_{i+1} \\geq a_i - 1$       |\n| 5     | 15     | $n \\leq 1000$               | --                            | 0, 1            |                                |\n| 6     | 14     | --                            | --                            | 0 -- 5          |                                |", "locale": "en", "translations": {"en": {"title": "[OOI 2025] Cute Subsequences", "background": "", "description": "You are given an array of $n$ positive integers $a_1$, $a_2$, $\\ldots$, $a_n$, as well as a positive integer $k$. You need to divide the array into $k$ non-empty subsequences such that each element of the array belongs to exactly one subsequence. A subsequence is a sequence that can be obtained from another sequence by deleting some elements without changing the order of the remaining elements.\n\nLet the $i$-th subsequence contain elements with indices $j_1 < \\ldots < j_l$. The $\\textit{value}$ of this subsequence is defined as the maximum value of $a_{j_m} + m$ for all $m$ from $1$ to $l$.\n\nThe $\\textit{cost}$ of dividing the array into $k$ subsequences is the sum of the $\\textit{values}$ of these subsequences.\n\nFind the maximum $\\textit{cost}$ of the division.", "inputFormat": "The first line contains two positive integers $n$ and $k$ ($1 \\leq k \\leq n \\leq 500\\,000$) --- the size of the array and the number of subsequences to divide it into.\n\nThe second line contains $n$ positive integers $a_1$, $a_2$, $\\ldots$, $a_n$ ($1 \\leq a_i \\leq 10^9$) --- the elements of the array.", "outputFormat": "Output the maximum $\\textit{cost}$ of dividing the given array into $k$ non-empty subsequences.", "hint": "**Note**\n\nIn the sample test, the array can be divided into $[3, 10]$, $[7]$, $[1, 2]$. Then the answer will be $(10 + 2) + (7 + 1) + (2 + 2) = 12 + 8 + 4 = 24$.\n\n**Scoring**\n\nThe tests for this problem consist of six groups. Points for each group are given only if all tests of the group and all tests of the required groups are passed.\n\n| Group | Points | Additional Constraints: $n$ | Additional Constraints: $k$ | Required Groups | Comment                        |\n| :---- | :----- | :---------------------------- | :---------------------------- | :-------------- | :----------------------------- |\n| 0     | 0      | --                            | --                            | --              | Examples.                      |\n| 1     | 14     | $n \\le 8$                   | --                            | 0               |                                |\n| 2     | 19     | --                            | $k = 2$                     | --              |                                |\n| 3     | 17     | --                            | --                            | --              | $a_{i+1} \\leq a_i$           |\n| 4     | 21     | --                            | --                            | --              | $a_{i+1} \\geq a_i - 1$       |\n| 5     | 15     | $n \\leq 1000$               | --                            | 0, 1            |                                |\n| 6     | 14     | --                            | --                            | 0 -- 5          |                                |", "locale": "en"}, "zh-CN": {"title": "[OOI 2025] Cute Subsequences", "background": "[试题来源](https://inf-open.ru/2024-25/final-materials/)。", "description": "给定一个长度为 $n$ 的正整数数组 $a_1, a_2, \\ldots, a_n$，以及一个正整数 $k$。你需要将该数组划分为 $k$ 个非空子序列，使得每个元素恰好属于一个子序列。\n\n子序列指的是从原始序列中删除若干个元素（可以为零），但不改变剩余元素的相对顺序后所得到的序列。\n\n设第 $i$ 个子序列包含的是原数组中下标为 $j_1 < \\ldots < j_l$ 的元素。该子序列的「价值」定义为 $\\max\\limits_{1 \\le m \\le l}(a_{j_m} + m)$。\n\n将数组划分为 $k$ 个子序列的「代价」是这 $k$ 个子序列的价值之和。\n\n请你计算出数组在划分方案最优时所能获得的最大代价。", "inputFormat": "第一行包含两个正整数 $n$ 和 $k$（$1 \\le k \\le n \\le 500\\,000$）—— 分别表示数组的长度以及要划分出的子序列数量。\n\n第二行包含 $n$ 个正整数 $a_1, a_2, \\ldots, a_n$（$1 \\le a_i \\le 10^9$）—— 表示数组中的元素。", "outputFormat": "输出一个整数，表示将给定数组划分为 $k$ 个非空子序列所能获得的最大代价。", "hint": "**样例解释**\n\n在样例中，可以将数组划分为 $[3, 10]$、$[7]$、$[1, 2]$。那么答案为：\n\n$$(10 + 2) + (7 + 1) + (2 + 2) = 12 + 8 + 4 = 24.$$\n\n本题的测试点共包含六个分组。只有当某个分组的所有测试点**以及**其依赖的所有分组测试点均通过时，才能获得该分组的分数。\n\n| Subtask | 分值 | 限制条件：$n$ | 限制条件：$k$ | 依赖分组 | 说明                            |\n| :--- | :--- | :------------- | :------------- | :------- | :----------------------------- |\n| 0    | 0    | --             | --             | --       | 样例测试点。                   |\n| 1    | 14   | $n \\le 8$      | --             | 0        |                                 |\n| 2    | 19   | --             | $k = 2$        | --       |                                 |\n| 3    | 17   | --             | --             | --       | 满足 $a_{i+1} \\le a_i$。       |\n| 4    | 21   | --             | --             | --       | 满足 $a_{i+1} \\ge a_i - 1$。   |\n| 5    | 15   | $n \\le 1000$   | --             | 0, 1     |                                 |\n| 6    | 14   | --             | --             | 0 -- 5   |                                 |", "locale": "zh-CN"}}}
{"pid": "P12077", "type": "P", "difficulty": 7, "samples": [["5 6 0\n1 2\n1 5\n2 3\n3 4\n3 5\n4 2", "3\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2025", "Special Judge", "Moscow Olympiad"], "title": "[OOI 2025] Strong Connectivity Strikes Back", "background": "", "description": "Vertices $u$ and $v$ of a directed graph are called strongly connected if there exists a path from $u$ to $v$ and a path from $v$ to $u$ in the graph. Note that if $u$ and $v$ are strongly connected, and $v$ and $w$ are strongly connected, then $u$ and $w$ are also strongly connected. Therefore, the vertices of the graph are divided into sets---strongly connected components. A vertex belonging to a strongly connected component is strongly connected to all vertices in the component (including itself) and is not strongly connected to any vertices outside the component.\n\nDuring a graph class, Alice drew a directed graph with $n$ vertices on the board and highlighted its strongly connected components. During the break, Bob decided to play a trick on Alice and erase the directions on some edges of the graph. He wants Alice to be able to uniquely restore the erased directions based on the remaining edges and the partition into strongly connected components after the break.\n\nHelp Bob by determining the maximum number of edges in the graph whose directions he can erase, as well as the number of ways he can do this.\n\nMore formally, find the maximum size of a subset of edges $A$ that has the following property: if the directions of the edges in the set $A$ are erased, then based on the information about the old strongly connected components and the directions of the edges not in the set $A$, the directions of the edges in the set $A$ can be uniquely restored in such a way that the strongly connected components remain unchanged.\n\nSince the number of such maximum subsets can be very large, output it modulo $10^9 + 7$.\n\nSolutions that correctly determine the maximum size of the set $A$ but incorrectly present the number of such subsets will receive partial points.", "inputFormat": "The first line contains three integers $n$, $m$, and $g$ ($2 \\le n \\le 2000$, $1 \\le m \\le 2000$, $0 \\le g \\le 7$)---the number of vertices and edges in the graph, respectively, as well as the test group number.\n\nThe next $m$ lines contain two integers $u_i$ and $v_i$ ($1 \\le u_i, v_i \\le n$, $u_i \\neq v_i$)---the numbers of the vertices that are the start and end of the $i$-th edge.\n\nIt is guaranteed that for any $1 \\le i, j \\le n$ $(u_i, v_i) \\neq (u_j, v_j)$ and $(u_i, v_i) \\neq (v_j, u_j)$, meaning that any two vertices are connected by at most one edge, regardless of direction.", "outputFormat": "In the first line, output a single number---the size of the maximum subset of edges whose directions can be erased.\n\nIn the second line, output a single number---the number of such subsets modulo $10^9 + 7$. If you do not want to present the number of such subsets, then in the second line, instead, output any number from $-1$ to $10^9 + 6$. In this case, your solution will receive partial points for the test.\n\nNote that omitting any number in the second line leads to a verdict of \"Wrong Answer\" and zero points for this test, regardless of the correctness of the size of the subset.", "hint": "**Note**\n\nThe graph from the example with strongly connected components highlighted:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5fould0s.png)\n\nThe directions on the dashed edges can be removed. Indeed, the edge $(1, 5)$ cannot be oriented in the opposite direction, because otherwise, vertices $1$, $2$, $3$, and $5$ would belong to the same strongly connected component. The edges $(3, 4)$ and $(4, 2)$ cannot be oriented differently either, because then vertices $2$, $3$, and $4$ would not belong to the same strongly connected component.\n\nNow, let's consider an incorrect way of selecting a subset of edges:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yxvk46vo.png)\n\nHere, the directions on the bold dashed edges cannot be removed. For example, if we reverse the orientation of edges $(1, 2)$ and $(1, 5)$, we get a graph with the same decomposition into strongly connected components.\n\nIt can be shown that the directions on exactly $4$ edges cannot be removed, so the answer is $3$.\n\n**Scoring**\n\nThe tests for this problem consist of seven groups. The rules for scoring the subgroups are described below.\n\nIf the size of the maximum subset of edges whose directions can be erased and the number of such subsets are correctly calculated in all tests of the group, full points are awarded for the group.\n\nOtherwise, if the size of the maximum subset of edges whose directions can be erased is correctly calculated in all tests of the group, but the number is incorrect in at least one test of the group, partial points are awarded for the group. Note that dependent groups will be tested in this case and may even be scored full points.\n\n| Group | Partial Points | Full Points | Additional Constraints: $n$ | Additional Constraints: $m$ | Required Groups | Comment |\n| :---- | :------------- | :---------- | :-------------------------- | :-------------------------- | :-------------- | :------ |\n| 0     | 0              | 0           | --                          | --                          | --              | Examples. |\n| 1     | 7              | 11          | $n \\le 14$                  | $m \\le 14$                  | 0               |          |\n| 2     | 5              | 9           | $n \\le 20$                  | $m \\le 20$                  | 0, 1            |          |\n| 3     | 8              | 12          | --                          | --                          | --              | $u_i < v_i$, for all $1 \\le i \\le n - 1$ there is an edge $(i, i + 1)$ |\n| 4     | 8              | 13          | --                          | --                          | 3               | $u_i < v_i$。 |\n| 5     | 12             | 20          | --                          | --                          | --              | for all $1 \\leqslant i \\leqslant n - 1$ there is an edge $(i, i + 1)$, there is an edge $(n, 1)$ |\n| 6     | 13             | 21          | --                          | --                          | 5               | the graph consists of one strongly connected component |\n| 7     | 8              | 14          | --                          | --                          | 0 -- 6          |          |", "locale": "en", "translations": {"en": {"title": "[OOI 2025] Strong Connectivity Strikes Back", "background": "", "description": "Vertices $u$ and $v$ of a directed graph are called strongly connected if there exists a path from $u$ to $v$ and a path from $v$ to $u$ in the graph. Note that if $u$ and $v$ are strongly connected, and $v$ and $w$ are strongly connected, then $u$ and $w$ are also strongly connected. Therefore, the vertices of the graph are divided into sets---strongly connected components. A vertex belonging to a strongly connected component is strongly connected to all vertices in the component (including itself) and is not strongly connected to any vertices outside the component.\n\nDuring a graph class, Alice drew a directed graph with $n$ vertices on the board and highlighted its strongly connected components. During the break, Bob decided to play a trick on Alice and erase the directions on some edges of the graph. He wants Alice to be able to uniquely restore the erased directions based on the remaining edges and the partition into strongly connected components after the break.\n\nHelp Bob by determining the maximum number of edges in the graph whose directions he can erase, as well as the number of ways he can do this.\n\nMore formally, find the maximum size of a subset of edges $A$ that has the following property: if the directions of the edges in the set $A$ are erased, then based on the information about the old strongly connected components and the directions of the edges not in the set $A$, the directions of the edges in the set $A$ can be uniquely restored in such a way that the strongly connected components remain unchanged.\n\nSince the number of such maximum subsets can be very large, output it modulo $10^9 + 7$.\n\nSolutions that correctly determine the maximum size of the set $A$ but incorrectly present the number of such subsets will receive partial points.", "inputFormat": "The first line contains three integers $n$, $m$, and $g$ ($2 \\le n \\le 2000$, $1 \\le m \\le 2000$, $0 \\le g \\le 7$)---the number of vertices and edges in the graph, respectively, as well as the test group number.\n\nThe next $m$ lines contain two integers $u_i$ and $v_i$ ($1 \\le u_i, v_i \\le n$, $u_i \\neq v_i$)---the numbers of the vertices that are the start and end of the $i$-th edge.\n\nIt is guaranteed that for any $1 \\le i, j \\le n$ $(u_i, v_i) \\neq (u_j, v_j)$ and $(u_i, v_i) \\neq (v_j, u_j)$, meaning that any two vertices are connected by at most one edge, regardless of direction.", "outputFormat": "In the first line, output a single number---the size of the maximum subset of edges whose directions can be erased.\n\nIn the second line, output a single number---the number of such subsets modulo $10^9 + 7$. If you do not want to present the number of such subsets, then in the second line, instead, output any number from $-1$ to $10^9 + 6$. In this case, your solution will receive partial points for the test.\n\nNote that omitting any number in the second line leads to a verdict of \"Wrong Answer\" and zero points for this test, regardless of the correctness of the size of the subset.", "hint": "**Note**\n\nThe graph from the example with strongly connected components highlighted:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5fould0s.png)\n\nThe directions on the dashed edges can be removed. Indeed, the edge $(1, 5)$ cannot be oriented in the opposite direction, because otherwise, vertices $1$, $2$, $3$, and $5$ would belong to the same strongly connected component. The edges $(3, 4)$ and $(4, 2)$ cannot be oriented differently either, because then vertices $2$, $3$, and $4$ would not belong to the same strongly connected component.\n\nNow, let's consider an incorrect way of selecting a subset of edges:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yxvk46vo.png)\n\nHere, the directions on the bold dashed edges cannot be removed. For example, if we reverse the orientation of edges $(1, 2)$ and $(1, 5)$, we get a graph with the same decomposition into strongly connected components.\n\nIt can be shown that the directions on exactly $4$ edges cannot be removed, so the answer is $3$.\n\n**Scoring**\n\nThe tests for this problem consist of seven groups. The rules for scoring the subgroups are described below.\n\nIf the size of the maximum subset of edges whose directions can be erased and the number of such subsets are correctly calculated in all tests of the group, full points are awarded for the group.\n\nOtherwise, if the size of the maximum subset of edges whose directions can be erased is correctly calculated in all tests of the group, but the number is incorrect in at least one test of the group, partial points are awarded for the group. Note that dependent groups will be tested in this case and may even be scored full points.\n\n| Group | Partial Points | Full Points | Additional Constraints: $n$ | Additional Constraints: $m$ | Required Groups | Comment |\n| :---- | :------------- | :---------- | :-------------------------- | :-------------------------- | :-------------- | :------ |\n| 0     | 0              | 0           | --                          | --                          | --              | Examples. |\n| 1     | 7              | 11          | $n \\le 14$                  | $m \\le 14$                  | 0               |          |\n| 2     | 5              | 9           | $n \\le 20$                  | $m \\le 20$                  | 0, 1            |          |\n| 3     | 8              | 12          | --                          | --                          | --              | $u_i < v_i$, for all $1 \\le i \\le n - 1$ there is an edge $(i, i + 1)$ |\n| 4     | 8              | 13          | --                          | --                          | 3               | $u_i < v_i$。 |\n| 5     | 12             | 20          | --                          | --                          | --              | for all $1 \\leqslant i \\leqslant n - 1$ there is an edge $(i, i + 1)$, there is an edge $(n, 1)$ |\n| 6     | 13             | 21          | --                          | --                          | 5               | the graph consists of one strongly connected component |\n| 7     | 8              | 14          | --                          | --                          | 0 -- 6          |          |", "locale": "en"}, "zh-CN": {"title": "[OOI 2025] Strong Connectivity Strikes Back", "background": "[试题来源](https://inf-open.ru/2024-25/final-materials/)。", "description": "有向图的顶点 $u$ 和 $v$ 被称为强连通的，如果存在一条从 $u$ 到 $v$ 的路径，并且存在一条从 $v$ 到 $u$ 的路径。注意，如果 $u$ 和 $v$ 强连通，且 $v$ 和 $w$ 强连通，那么 $u$ 和 $w$ 也强连通。因此，图中的顶点被划分为若干个强连通分量。属于同一个强连通分量的顶点彼此强连通（包括其本身），并且与任何不属于该分量的顶点都不强连通。\n\n在一次图论课上，Alice 在黑板上画了一个包含 $n$ 个顶点的有向图，并且高亮了图中的强连通分量。课间，Bob 决定恶作剧，他想删除图中一些边的方向，并且希望 Alice 能够根据剩下的边和课间的强连通分量划分，唯一地恢复这些被删除方向的边。\n\n帮助 Bob 确定最大可以删除的边数，以及可以删除这些边的方案数。\n\n更正式地说，找到一个边的子集 $A$，使得如果我们删除集合 $A$ 中边的方向，则根据剩下的边的方向以及强连通分量的划分信息，可以唯一地恢复集合 $A$ 中边的方向，从而保持图的强连通分量不变。并且，求出这个子集 $A$ 的最大大小，以及这个子集的方案数。\n\n由于这样的方案数可能非常大，输出该数对 $10^9 + 7$ 取模的结果。\n\n如果正确计算了最大子集的大小，但方案数计算错误，则将获得部分分数。", "inputFormat": "第一行包含三个整数 $n$、$m$ 和 $g$（$2 \\le n \\le 2000$，$1 \\le m \\le 2000$，$0 \\le g \\le 7$）—— 图中的顶点数、边数以及测试组编号。\n\n接下来 $m$ 行，每行包含两个整数 $u_i$ 和 $v_i$（$1 \\le u_i, v_i \\le n$，$u_i \\neq v_i$）—— 第 $i$ 条边的起点和终点。\n\n保证对于任意的 $1 \\le i, j \\le n$，$ (u_i, v_i) \\neq (u_j, v_j)$ 且 $ (u_i, v_i) \\neq (v_j, u_j)$，即任意两点之间最多有一条边，无论方向如何。", "outputFormat": "输出两行。\n\n第一行输出一个整数——可以删除的最大边子集的大小。\n\n第二行输出一个整数——该子集的方案数对 $10^9 + 7$ 取模的结果。如果你不想输出方案数，则在第二行输出任意一个从 $-1$ 到 $10^9 + 6$ 之间的数字。若第二行没有输出正确的数字，则无论子集大小是否正确，都会被判定为“错误答案”，并且该测试得分为零。", "hint": "**样例解释**\n\n在这个样例中，图的强连通分量如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5fould0s.png)\n\n可以删除虚线边的方向。实际上，边 $(1, 5)$ 不能反向，因为如果反向，顶点 $1$、$2$、$3$、$5$ 将属于同一个强连通分量。同样，边 $(3, 4)$ 和 $(4, 2)$ 也不能反向，因为这样 $2$、$3$、$4$ 将不属于同一个强连通分量。\n\n现在，考虑一个错误的子集选择方式：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yxvk46vo.png)\n\n这里，虚线加粗边的方向不能删除。例如，如果我们将边 $(1, 2)$ 和 $(1, 5)$ 的方向反向，得到的图依然会有相同的强连通分量划分。\n\n可以证明，有 $4$ 条边的方向不能删除，因此正确答案是 $3$。\n\n**评分**\n\n本题的测试点共包含七个分组。分组的分数规则如下：\n\n如果正确计算了最大边子集的大小和该子集的方案数，并且在该分组的所有测试点中都正确，用户将获得该分组的满分。\n\n如果正确计算了最大子集的大小，但方案数计算错误，则将为该分组获得部分分数。此时，依赖该分组的分组也将进行测试，并且可能获得满分。\n\n| 组别 | 部分分数 | 满分分数 | 限制条件：$n$ | 限制条件：$m$ | 依赖组别 | 说明                           |\n| :--- | :------- | :------- | :----------- | :----------- | :------- | :---------------------------- |\n| 0    | 0        | 0        | --            | --            | --       | 样例测试点。                  |\n| 1    | 7        | 11       | $n \\le 14$    | $m \\le 14$    | 0        |                               |\n| 2    | 5        | 9        | $n \\le 20$    | $m \\le 20$    | 0, 1     |                               |\n| 3    | 8        | 12       | --            | --            | --       | 满足 $u_i < v_i$，对于所有 $1 \\le i \\le n - 1$，存在一条边 $(i, i + 1)$。 |\n| 4    | 8        | 13       | --            | --            | 3        | 满足 $u_i < v_i$。            |\n| 5    | 12       | 20       | --            | --            | --       | 对于所有 $1 \\leqslant i \\leqslant n - 1$，存在一条边 $(i, i + 1)$，且存在一条边 $(n, 1)$。 |\n| 6    | 13       | 21       | --            | --            | 5        | 图是一个强连通分量。         |\n| 7    | 8        | 14       | --            | --            | 0 -- 6   |                               |", "locale": "zh-CN"}}}
{"pid": "P12078", "type": "P", "difficulty": 4, "samples": [["5 3 10\n4 5 2 7 1\n1 2 4", "4"], ["4 2 11\n4 5 7 10\n2 3", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2025", "Moscow Olympiad"], "title": "[OOI 2025] Best Runner", "background": "", "description": "There are $n$ running tracks in the stadium with lengths $a_1$, $a_2$, $\\ldots$, $a_n$. There are also $m$ runners, with the $i$-th runner starting at the beginning of track $b_i$.\n\nAll runners will train for $T$ seconds. The training of a runner proceeds as follows:\n\nLet the runner currently be at the beginning of track $i$. They will run to the end of the current track in $a_i$ seconds. After that, they can either instantly return to the beginning of the current track, or move to the beginning of track $(i - 1)$ (if $i > 1$), or to the beginning of track $(i + 1)$ (if $i < n$). After this, they continue running from the track they moved to. Once the training duration reaches $T$ seconds, they finish their training.\n\nWe define the best runner as the one who runs the most number of $\\textbf{full}$ tracks during the training time (there may be several such runners). Determine how many tracks the best runner will run.", "inputFormat": "The first line contains three integers $n$, $m$, and $T$ ($1 \\le m \\le n \\le 300\\,000$, $1 \\le T \\le 10^9$) --- the number of tracks, the number of runners, and the duration of the training.\n\nThe second line contains $n$ integers $a_1$, $a_2$, $\\ldots$, $a_n$ ($1 \\le a_i \\le 10^9$) --- the lengths of the tracks.\n\nThe third line contains $m$ integers $b_1$, $b_2$, $\\ldots$, $b_m$ ($1 \\le b_1 < b_2 < \\ldots < b_m \\le n$) --- the track numbers from which the runners start.", "outputFormat": "Output a single integer --- the maximum number of full tracks that one of the runners can run during the training time.", "hint": "**Note**\n\nIn the first example, the runner starting on track $4$ can run the most tracks: they should run track $4$, then move to track $5$ and run it $3$ times.\n\nIn the second example, the runner starting on track $2$ can run the second track $2$ times.\n\n**Scoring**\n\nThe tests for this problem consist of six groups. Points for each group are given only if all tests of the group and all tests of the required groups are passed.\n\n| Group | Points | Additional constraints: $n$ | $T$ | $a_i$ | Required Groups | Comment |\n| :---- | :----- | :--------------------------- | :-- | :---- | :-------------- | :------ |\n| 0     | 0      | --                           | --  | --    | --              | Examples. |\n| 1     | 23     | $n \\le 1000$                 | --  | --    | 0               |          |\n| 2     | 10     | --                           | --  | --    | --              | $a_i \\le a_{i + 1}$ for all $1 \\le i < n$ |\n| 3     | 16     | --                           | $T \\le 20$ | -- | 0           |          |\n| 4     | 19     | --                           | --  | $a_i \\le 20$ | 0       |          |\n| 5     | 11     | --                           | --  | --    | --              | $m = n$ |\n| 6     | 21     | --                           | --  | --    | 0 -- 5          |          |", "locale": "en", "translations": {"en": {"title": "[OOI 2025] Best Runner", "background": "", "description": "There are $n$ running tracks in the stadium with lengths $a_1$, $a_2$, $\\ldots$, $a_n$. There are also $m$ runners, with the $i$-th runner starting at the beginning of track $b_i$.\n\nAll runners will train for $T$ seconds. The training of a runner proceeds as follows:\n\nLet the runner currently be at the beginning of track $i$. They will run to the end of the current track in $a_i$ seconds. After that, they can either instantly return to the beginning of the current track, or move to the beginning of track $(i - 1)$ (if $i > 1$), or to the beginning of track $(i + 1)$ (if $i < n$). After this, they continue running from the track they moved to. Once the training duration reaches $T$ seconds, they finish their training.\n\nWe define the best runner as the one who runs the most number of $\\textbf{full}$ tracks during the training time (there may be several such runners). Determine how many tracks the best runner will run.", "inputFormat": "The first line contains three integers $n$, $m$, and $T$ ($1 \\le m \\le n \\le 300\\,000$, $1 \\le T \\le 10^9$) --- the number of tracks, the number of runners, and the duration of the training.\n\nThe second line contains $n$ integers $a_1$, $a_2$, $\\ldots$, $a_n$ ($1 \\le a_i \\le 10^9$) --- the lengths of the tracks.\n\nThe third line contains $m$ integers $b_1$, $b_2$, $\\ldots$, $b_m$ ($1 \\le b_1 < b_2 < \\ldots < b_m \\le n$) --- the track numbers from which the runners start.", "outputFormat": "Output a single integer --- the maximum number of full tracks that one of the runners can run during the training time.", "hint": "**Note**\n\nIn the first example, the runner starting on track $4$ can run the most tracks: they should run track $4$, then move to track $5$ and run it $3$ times.\n\nIn the second example, the runner starting on track $2$ can run the second track $2$ times.\n\n**Scoring**\n\nThe tests for this problem consist of six groups. Points for each group are given only if all tests of the group and all tests of the required groups are passed.\n\n| Group | Points | Additional constraints: $n$ | $T$ | $a_i$ | Required Groups | Comment |\n| :---- | :----- | :--------------------------- | :-- | :---- | :-------------- | :------ |\n| 0     | 0      | --                           | --  | --    | --              | Examples. |\n| 1     | 23     | $n \\le 1000$                 | --  | --    | 0               |          |\n| 2     | 10     | --                           | --  | --    | --              | $a_i \\le a_{i + 1}$ for all $1 \\le i < n$ |\n| 3     | 16     | --                           | $T \\le 20$ | -- | 0           |          |\n| 4     | 19     | --                           | --  | $a_i \\le 20$ | 0       |          |\n| 5     | 11     | --                           | --  | --    | --              | $m = n$ |\n| 6     | 21     | --                           | --  | --    | 0 -- 5          |          |", "locale": "en"}, "zh-CN": {"title": "[OOI 2025] Best Runner", "background": "[试题来源](https://inf-open.ru/2024-25/final-materials/)。", "description": "体育场内共有 $n$ 条跑道，其长度分别为 $a_1, a_2, \\ldots, a_n$。此外还有 $m$ 名跑者，第 $i$ 名跑者从编号为 $b_i$ 的跑道起点开始训练。\n\n所有跑者将训练 $T$ 秒。训练过程如下：\n\n- 设当前跑者位于第 $i$ 条跑道的起点，他们将用 $a_i$ 秒从起点跑到终点。随后，跑者可以立刻选择以下操作之一：返回当前跑道的起点、移动到第 $i - 1$ 条跑道的起点（如果 $i > 1$）、或移动到第 $i + 1$ 条跑道的起点（如果 $i < n$）。完成选择后，跑者继续在新选择的跑道上训练。训练将在总时间达到 $T$ 秒时结束。\n\n我们将「最强跑者」定义为在训练时间内完整跑完跑道次数最多的跑者（可能存在多位最强跑者）。请你计算最强跑者最多能完整跑完多少条跑道。", "inputFormat": "第一行包含三个整数 $n$、$m$ 和 $T$（$1 \\le m \\le n \\le 300\\,000$，$1 \\le T \\le 10^9$）—— 跑道数量、跑者数量和训练时间。\n\n第二行包含 $n$ 个整数 $a_1, a_2, \\ldots, a_n$（$1 \\le a_i \\le 10^9$）—— 各条跑道的长度。\n\n第三行包含 $m$ 个严格递增的整数 $b_1, b_2, \\ldots, b_m$（$1 \\le b_1 < b_2 < \\ldots < b_m \\le n$）—— 各位跑者的起始跑道编号。", "outputFormat": "输出一个整数，表示在训练时间内任意一位跑者最多能完整跑完多少条跑道。\n", "hint": "**样例解释**\n\n在第一个样例中，从第 $4$ 条跑道出发的跑者可以取得最多的成绩。他可以先跑完第 $4$ 条跑道，然后移动到第 $5$ 条跑道并跑完 $3$ 次，共计跑完 $4$ 条完整跑道。\n\n在第二个样例中，从第 $2$ 条跑道出发的跑者可以在第 $2$ 条跑道上跑完 $2$ 次。\n\n**评分**\n\n本题的测试点共包含六个分组。只有当该分组的所有测试点及其依赖分组的测试点均通过时，才能获得该分组的分数。\n\n| Subtask | 分数 | 限制条件：$n$ | $T$ | $a_i$ 的限制 | 依赖分组 | 说明 |\n| :--- | :--- | :------------- | :-- | :------------- | :-------- | :---- |\n| 0    | 0    | --             | --  | --             | --        | 样例测试点。 |\n| 1    | 23   | $n \\le 1000$   | --  | --             | 0         |             |\n| 2    | 10   | --             | --  | 所有 $1 \\le i < n$ 满足 $a_i \\le a_{i + 1}$ | -- |             |\n| 3    | 16   | --             | $T \\le 20$ | --         | 0         |             |\n| 4    | 19   | --             | --  | $a_i \\le 20$   | 0         |             |\n| 5    | 11   | --             | --  | --             | --        | $m = n$。     |\n| 6    | 21   | --             | --  | --             | 0 -- 5    |             |", "locale": "zh-CN"}}}
{"pid": "P12079", "type": "P", "difficulty": 5, "samples": [["2 1\n5 3\n1 2\n4", "First"], ["1 2\n2\n3\n4 1", "Second"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2025", "Moscow Olympiad"], "title": "[OOI 2025] Card Flip", "background": "", "description": "Petya and Vasya bought a new card game called ''Flip''. The game contains $n$ double-sided cards and $m$ single-sided cards:\n- $\\textbf{Double-sided card.}$ The front side of the card has the number $a_i$, and the back side has the number $b_i$.\n- $\\textbf{Single-sided card.}$ The front side of the card has a single number $c_i$.\n\nAll numbers written on the cards on all sides are distinct. Initially, all cards are placed on the table with the front side up. On his turn, a player can perform exactly one of two actions:\n- Remove from the table the card with the smallest number among the remaining cards.\n- If the card with the smallest number is double-sided and facing up, it can be flipped.\n\nThe player who removes the last card from the table wins. Determine the winner of the game if Petya goes first.", "inputFormat": "The first line contains two integers $n$ and $m$ ($1 \\le n, m \\le 500\\,000$) --- the number of double-sided and single-sided cards, respectively.\n\nThe second line contains $n$ integers $a_1$, $a_2$, $\\ldots$, $a_n$ ($1 \\le a_i \\le 2 \\cdot n + m$) --- the numbers written on the front side of the double-sided cards.\n\nThe third line contains $n$ integers $b_1$, $b_2$, $\\ldots$, $b_n$ ($1 \\le b_i \\le 2 \\cdot n + m$) --- the numbers written on the back side of the double-sided cards.\n\nThe fourth line contains $m$ integers $c_1$, $c_2$, $\\ldots$, $c_m$ ($1 \\le c_i \\le 2 \\cdot n + m$) --- the numbers written on the single-sided cards.\n\nIt is guaranteed that each number from $1$ to $2\\cdot n + m$ appears exactly once in one of the arrays $a$, $b$, or $c$.", "outputFormat": "Print `First` if Petya wins in this game, and `Second` if Vasya wins.", "hint": "**Note**\n\nIn the first example, initially, the cards 3, 4, and 5 are on the table. To win, Petya discards card 3 on his turn, after which Vasya must discard card 4, as it is single-sided. Finally, Petya discards card 5, meaning there will be no cards left for Vasya, and Petya wins.\n\nIn the second example, initially, the cards 1, 2, and 4 are on the table. Petya must discard the first card, as it is single-sided. Then, to win, Vasya flips card 2, so there will be cards 3 and 4 on the table. Petya must discard the flipped card number 3, after which Vasya will discard card 4. Since the cards will run out, Vasya will win.\n\n**Scoring**\n\nThe tests for this problem consist of nine groups. Points for each group are given only if all tests of the group and all tests of the required groups are passed. Please note that passing the example tests is not required for some groups. $\\textbf{Offline-evaluation}$ means that the results of testing your solution on this group will only be available after the end of the competition.\n\n| Group | Points | Additional constraints: $n$ | Additional constraints: $m$ | Required Groups | Comment |\n| :---- | :----- | :-------------------------- | :--------------------------- | :-------------- | :------ |\n| 0     | 0      | --                           | --                           | --              | Examples. |\n| 1     | 12     | $n \\le 20$                   | $m \\le 10$                   | 0               |          |\n| 2     | 13     | $n \\le 20$                   | --                           | 0, 1            |          |\n| 3     | 9      | --                           | --                           | --              | $a_i > b_i$ |\n| 4     | 10     | --                           | --                           | --              | $\\max_{i = 1}^n(a_i) < \\min_{i = 1}^n(b_i)$ |\n| 5     | 6      | --                           | --                           | --              | The segments $[ \\min(a_i, b_i); \\max(a_i, b_i)]$ do not intersect. |\n| 6     | 11     | $n \\le 200$                  | $m \\le 200$                  | --              | The segments $[ \\min(a_i, b_i); \\max(a_i, b_i)]$ are nested or do not intersect. |\n| 7     | 14     | --                           | --                           | 5, 6            | The segments $[ \\min(a_i, b_i); \\max(a_i, b_i)]$ are nested or do not intersect. |\n| 8     | 13     | $n \\le 5000$                 | $m \\le 5000$                 | 0, 1, 6         |          |\n| 9     | 12     | --                           | --                           | 0 -- 8          | **Offline-evaluation.** |", "locale": "en", "translations": {"en": {"title": "[OOI 2025] Card Flip", "background": "", "description": "Petya and Vasya bought a new card game called ''Flip''. The game contains $n$ double-sided cards and $m$ single-sided cards:\n- $\\textbf{Double-sided card.}$ The front side of the card has the number $a_i$, and the back side has the number $b_i$.\n- $\\textbf{Single-sided card.}$ The front side of the card has a single number $c_i$.\n\nAll numbers written on the cards on all sides are distinct. Initially, all cards are placed on the table with the front side up. On his turn, a player can perform exactly one of two actions:\n- Remove from the table the card with the smallest number among the remaining cards.\n- If the card with the smallest number is double-sided and facing up, it can be flipped.\n\nThe player who removes the last card from the table wins. Determine the winner of the game if Petya goes first.", "inputFormat": "The first line contains two integers $n$ and $m$ ($1 \\le n, m \\le 500\\,000$) --- the number of double-sided and single-sided cards, respectively.\n\nThe second line contains $n$ integers $a_1$, $a_2$, $\\ldots$, $a_n$ ($1 \\le a_i \\le 2 \\cdot n + m$) --- the numbers written on the front side of the double-sided cards.\n\nThe third line contains $n$ integers $b_1$, $b_2$, $\\ldots$, $b_n$ ($1 \\le b_i \\le 2 \\cdot n + m$) --- the numbers written on the back side of the double-sided cards.\n\nThe fourth line contains $m$ integers $c_1$, $c_2$, $\\ldots$, $c_m$ ($1 \\le c_i \\le 2 \\cdot n + m$) --- the numbers written on the single-sided cards.\n\nIt is guaranteed that each number from $1$ to $2\\cdot n + m$ appears exactly once in one of the arrays $a$, $b$, or $c$.", "outputFormat": "Print `First` if Petya wins in this game, and `Second` if Vasya wins.", "hint": "**Note**\n\nIn the first example, initially, the cards 3, 4, and 5 are on the table. To win, Petya discards card 3 on his turn, after which Vasya must discard card 4, as it is single-sided. Finally, Petya discards card 5, meaning there will be no cards left for Vasya, and Petya wins.\n\nIn the second example, initially, the cards 1, 2, and 4 are on the table. Petya must discard the first card, as it is single-sided. Then, to win, Vasya flips card 2, so there will be cards 3 and 4 on the table. Petya must discard the flipped card number 3, after which Vasya will discard card 4. Since the cards will run out, Vasya will win.\n\n**Scoring**\n\nThe tests for this problem consist of nine groups. Points for each group are given only if all tests of the group and all tests of the required groups are passed. Please note that passing the example tests is not required for some groups. $\\textbf{Offline-evaluation}$ means that the results of testing your solution on this group will only be available after the end of the competition.\n\n| Group | Points | Additional constraints: $n$ | Additional constraints: $m$ | Required Groups | Comment |\n| :---- | :----- | :-------------------------- | :--------------------------- | :-------------- | :------ |\n| 0     | 0      | --                           | --                           | --              | Examples. |\n| 1     | 12     | $n \\le 20$                   | $m \\le 10$                   | 0               |          |\n| 2     | 13     | $n \\le 20$                   | --                           | 0, 1            |          |\n| 3     | 9      | --                           | --                           | --              | $a_i > b_i$ |\n| 4     | 10     | --                           | --                           | --              | $\\max_{i = 1}^n(a_i) < \\min_{i = 1}^n(b_i)$ |\n| 5     | 6      | --                           | --                           | --              | The segments $[ \\min(a_i, b_i); \\max(a_i, b_i)]$ do not intersect. |\n| 6     | 11     | $n \\le 200$                  | $m \\le 200$                  | --              | The segments $[ \\min(a_i, b_i); \\max(a_i, b_i)]$ are nested or do not intersect. |\n| 7     | 14     | --                           | --                           | 5, 6            | The segments $[ \\min(a_i, b_i); \\max(a_i, b_i)]$ are nested or do not intersect. |\n| 8     | 13     | $n \\le 5000$                 | $m \\le 5000$                 | 0, 1, 6         |          |\n| 9     | 12     | --                           | --                           | 0 -- 8          | **Offline-evaluation.** |", "locale": "en"}, "zh-CN": {"title": "[OOI 2025] Card Flip", "background": "[试题来源](https://inf-open.ru/2024-25/final-materials/)。", "description": "Petya 和 Vasya 买了一款新卡片游戏，名为“Flip”。游戏中有 $n$ 张双面卡片和 $m$ 张单面卡片：\n- **双面卡片**：卡片正面写有数字 $a_i$，背面写有数字 $b_i$。\n- **单面卡片**：卡片正面写有数字 $c_i$。\n\n所有卡片上数字均不相同。初始时，所有卡片正面朝上，放置在桌面上。在每轮回合中，玩家可以执行以下两个动作之一：\n- 从桌面上移除剩余卡片中数字最小的那一张卡片。\n- 如果数字最小的卡片是双面卡片并且正面朝上，可以将其翻转。\n\n谁先移除桌面上的最后一张卡片，谁就获胜。Petya 先行，确定游戏的胜者。", "inputFormat": "第一行包含两个整数 $n$、$m$（$1 \\le m \\le n \\le 500\\,000$）—— 双面卡片的数量、单面卡片的数量。\n\n第二行包含 $n$ 个整数 $a_1, a_2, \\ldots, a_n$（$1 \\le a_i \\le 2 \\cdot n + m$）—— 双面卡片正面数字的列表。\n\n第三行包含 $n$ 个整数 $b_1, b_2, \\ldots, b_n$（$1 \\le b_i \\le 2 \\cdot n + m$）—— 双面卡片背面数字的列表。\n\n第四行包含 $m$ 个整数 $c_1, c_2, \\ldots, c_m$（$1 \\le c_i \\le 2 \\cdot n + m$）—— 单面卡片正面数字的列表。\n\n保证每个 $1$ 到 $2\\cdot n + m$ 的数字仅在数组 $a$、$b$ 或 $c$ 中出现一次。", "outputFormat": "如果 Petya 获胜，则输出 `First`，否则输出 `Second`。", "hint": "**样例解释**\n\n在第一个样例中，初始时桌面上是数字 $3$、$4$ 和 $5$。Petya 先手移除数字 $3$，接着 Vasya 只能移除单面牌 $4$，最后 Petya 再移除 $5$，此时卡牌全部被移除，Petya 获胜。\n\n在第二个样例中，初始桌面为 $1$、$2$、$4$。Petya 必须移除单面牌 $1$，然后 Vasya 可以翻转双面牌 $2$（反面是 $3$），使桌面为 $3$、$4$。Petya 只能移除 $3$，接着 Vasya 移除 $4$，最终 Vasya 获胜。\n\n**评分**\n\n本题包含九个测试点分组。只有在该分组的所有测试点以及其所有依赖分组的测试点全部通过的情况下，才能获得该分组的分数。请注意，通过样例测试点对于部分分组不是必需的。**Offline-evaluation** 表示该分组的评测将在比赛结束后进行。\n\n| 组别 | 分数 | 限制条件：$n$ | 限制条件：$m$ | 依赖组别 | 说明 |\n| :--- | :--- | :------------- | :------------- | :------- | :---- |\n| 0    | 0    | --             | --             | --       | 样例测试点。 |\n| 1    | 12   | $n \\le 20$     | $m \\le 10$     | 0        |          |\n| 2    | 13   | $n \\le 20$     | --             | 0, 1     |          |\n| 3    | 9    | --             | --             | --       | 满足 $a_i > b_i$。 |\n| 4    | 10   | --             | --             | --       | 满足 $\\max_{i = 1}^n a_i < \\min_{i = 1}^n b_i$。 |\n| 5    | 6    | --             | --             | --       | 所有区间 $[\\min(a_i, b_i), \\max(a_i, b_i)]$ 两两不相交。 |\n| 6    | 11   | $n \\le 200$    | $m \\le 200$    | --       | 所有区间 $[\\min(a_i, b_i), \\max(a_i, b_i)]$ 要么嵌套，要么不相交。 |\n| 7    | 14   | --             | --             | 5, 6     | 所有区间 $[\\min(a_i, b_i), \\max(a_i, b_i)]$ 要么嵌套，要么不相交。 |\n| 8    | 13   | $n \\le 5000$   | $m \\le 5000$   | 0, 1, 6  |          |\n| 9    | 12   | --             | --             | 0 -- 8   | **Offline-evaluation.** |", "locale": "zh-CN"}}}
{"pid": "P12080", "type": "P", "difficulty": 7, "samples": [["8 3 2 16\n3 1 2 -1 0 2 -1 4\n3 3 2 2 6\n1 3 2 4\n3 4 5 3 5\n1 4 5 6\n2 5 -1\n2 6 3\n1 3 2 1\n1 3 2 3\n1 3 2 4\n1 3 2 8\n1 0 5 6\n2 1 5\n3 1 3 7 8\n3 2 3 5 8\n3 3 3 4 7\n3 4 3 4 7", "-1 -1 0 1 1 1 1 2\n2\n1\n-4\n-1\n-1\n-1\n1\n2\n3\n7\n8\n4\n2"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2025", "Moscow Olympiad"], "title": "[OOI 2025] Order Statistics", "background": "", "description": "You are given an array $a_1$, $a_2$, $\\ldots$, $a_n$, consisting of integers, as well as integers $k$ and $m$.\nThe following operation is performed $m$ times on the array:\n\n- Select $i_1$, $i_2$, $\\ldots$, $i_k$ --- the positions of the $k$ largest elements in the array $a$. If two elements are equal, the element that appears earlier in the array is considered larger.\n- Decrease $a_{i_1}$, $a_{i_2}$, $\\ldots$, $a_{i_k}$ by $1$.\n\nFor $x$ from $1$ to $n$, let $F_{m,k}(x)$ denote the value of the $x$-th order statistic in the array obtained from $a$ after applying the operation $m$ times with the given parameter $k$. For $x$ from $1$ to $n$, the $x$-th order statistic of the array $a_1,a_2,\\ldots,a_n$ is the element that would be in position $x$ if the array $a$ were sorted in non-decreasing order.\n\nFor all $l, r$ such that $1 \\le l \\le r \\le n$, let $S_{m,k}(l,r)$ denote the sum of $F_{m,k}(x)$ for all integers $x$ from $l$ to $r$.\nMore formally:\n$$\nS_{m,k}(l,r)=\\sum_{x=l}^r F_{m,k}(x)\n$$\nYou are given integers $m_0$ and $k_0$.\nYou must compute the values of $F_{m_0,k_0}(x)$ for all $x$ from $1$ to $n$.\n\nAfter that, you must process $q$ queries. The $j$-th query ($1 \\le j \\le q$) can be one of three types:\n\n- Compute the value of $F_{m_j,k_j}(x_j)$.\n- Change the value of $a_{p_j}$ to $v_j$.\n- Compute the value of $S_{m_j,k_j}(l_j,r_j)$.\n\nAll calculations of the functions $F$ and $S$ are performed independently each time and do not change the array. All changes to the array in queries of the second type are preserved for subsequent queries.", "inputFormat": "The first line contains four integers $n$, $m_0$, $k_0$, and $q$ ($1 \\le n \\le 200\\,000$, $0 \\le m_0 \\le 10^9$,\n$1 \\le k_0 \\le n$, $0 \\le q \\le 200\\,000$) --- the length of the array $a$;\nthe number of operations; the number of largest elements decreased in each operation, and the number of queries.\n\nThe second line contains $n$ integers $a_1,\\ a_2,\\ \\ldots,\\ a_n$ ($-10^9 \\le a_i \\le 10^9$, $1 \\le i \\le n$) --- the elements of the array $a$.\n\nThe next $q$ lines contain the queries. In the $j$-th query, the first number is $t_j$ ($1 \\le t_j \\le 3$) --- the type of the $j$-th query.\n\n- If $t_j=1$, then the next line contains three integers $m_j$, $k_j$, and $x_j$ ($0 \\le m_j \\le 10^9$, $1 \\le k_j,x_j \\le n$)--- the parameters of the first type query.\n- If $t_j=2$, then the next line contains two integers $p_j$ and $v_j$ ($1 \\le p_j \\le n$, $-10^9 \\le v_j \\le 10^9$)--- the parameters of the second type query.\n- If $t_j=3$, then the next line contains four integers $m_j$, $k_j$, $l_j$, and $r_j$ ($0 \\le m_j \\le 10^9$, $1 \\le k_j,l_j,r_j \\le n$, $l_j \\le r_j$)--- the parameters of the third type query.", "outputFormat": "In the first line, output $n$ integers $F_{m_0,k_0}(1),F_{m_0,k_0}(2),\\ldots,F_{m_0,k_0}(n)$.\n\nThen, for each first type query, output the value $F_{m_j, k_j}(x_j)$ on a separate line, and for each third type query, output the value $S_{m_j,k_j}(l_j,r_j)$~--- the answer to the $j$-th query.", "hint": "In the example, $n=8$, $m_0=3$, $k_0=2$, $q=16$. Initially, the array $a$ is $[3, 1, 2, -1, 0, 2, -1, 4]$.\nLet's see how the array will change if we apply the operation $m_0$ times with parameter $k_0$:\n\n- The array is $[3,1,2,-1,0,2,-1,4]$. The two largest elements are in positions $1$ and $8$. \nThey are decreased by $1$, after which the array becomes $[2,1,2,-1,0,2,-1,3]$.\n- The array is $[2,1,2,-1,0,2,-1,3]$. The two largest elements are in positions $1$ and $8$. \nThey are decreased by $1$, after which the array becomes $[1,1,2,-1,0,2,-1,2]$.\n- The array is $[1,1,2,-1,0,2,-1,2]$. The two largest elements are in positions $3$ and $6$. They are decreased by $1$, after which the array becomes $[1,1,1,-1,0,1,-1,2]$.\n\nWe find that after applying the operation $3$ times with parameter $2$ to the array $a$, it becomes\n$[1,1,1,-1,0,1,-1,2]$. If this array is sorted, it results in \nthe array $[-1,-1,0,1,1,1,1,2]$. Thus, the order statistics are $F_{3,2}(1)=-1$, $F_{3,2}(2)=-1$, $F_{3,2}(3)=0$, $F_{3,2}(4)=1$, $F_{3,2}(5)=1$,\n$F_{3,2}(6)=1$, $F_{3,2}(7)=1$, $F_{3,2}(8)=2$.\n\nIn the example, we need to process $16$ queries; let's analyze the first $10$ of them in detail:\n- The first query is of type $t_1=3$, with parameters $m_1=3$, $k_1=2$, $l_1=2$, $r_1=6$ and requires computing the value of $S_{3,2}(2,6)$. We have already computed the values of $F_{3,2}(x)$\nfor $x$ from $1$ to $8$, from which we find the answer to the query:\n$$S_{3,2}(2,6)=F_{3,2}(2)+F_{3,2}(3)+F_{3,2}(4)+F_{3,2}(5)+F_{3,2}(6)=(-1)+0+1+1+1=2$$\n- The second query is of type $t_2=1$, with parameters $m_2=3$, $k_2=2$, $x_2=4$ and \nrequires computing the value of $F_{3,2}(4)$. We have already computed it, and it equals $1$.\n- The third query is of type $t_3=3$, with parameters $m_3=4$, $k_3=5$, $l_3=3$, $r_3=5$ and requires computing the value of $S_{4,5}(3,5)$, that is, to calculate the sum of the order statistics from the third to the fifth in the array obtained from $a$ after applying the operation $m_3=4$ times with parameter $k_3=5$. At the time of the third query, the array $a$ is $[3, 1, 2, -1, 0, 2, -1, 4]$. The five largest elements are in positions $1,2,3,6,8$. Decreasing them by $1$, we get the array $[2,0,1,-1,0,1,-1,3]$. Applying the operation three more times, we get the array $[-1,-2,-2,-2,-1,-1,-1,0]$. After sorting, it becomes $[-2,-2,-2,-1,-1,-1,-1,0]$. Thus, the answer to the query is \n$$S_{4,5}(3,5)=F_{4,5}(3)+F_{4,5}(4)+F_{4,5}(5)=(-2)+(-1)+(-1)=-4$$\n- The fourth query is of type $t_4=1$, with parameters $m_4=4$, $k_4=5$, $x_4=6$. After applying four operations with parameter $5$ and sorting the array $a$, it will be $[-2,-2,-2,-1,-1,-1,-1,0]$, so the sixth order statistic is $-1$.\n- The fifth query is of type $t_5=2$, with parameters $p_5=5$ and $v_5=-1$. It changes the value of $a_5$ to $-1$, after which the array $a$ becomes $[3,1,2,-1,-1,2,-1,4]$.\n- The sixth query is of type $t_6=2$, with parameters $p_6=6$ and $v_6=3$. It changes the value of $a_6$ to $3$, after which the array $a$ becomes $[3,1,2,-1,-1,3,-1,4]$.\n- The seventh query requires finding the value of $F_{3,2}(1)$. At the time of the seventh query, the array $a$ is $[3,1,2,-1,-1,3,-1,4]$. After applying $3$ times the operation with parameter $2$, it will be $[1, 1, 1, -1, -1, 2, -1, 2]$. The first order statistic of this array is $-1$.\n- The eighth, ninth, and tenth queries require finding the values of $F_{3,2}(3)$, $F_{3,2}(4)$ and $F_{3,2}(8)$, that is, the third, fourth, and eighth order statistics in the array $[1, 1, 1, -1, -1, 2, -1, 2]$. They are equal to $-1$, $1$, and $2$, respectively.\n\n**Scoring**\n\nThe tests for this problem consist of eleven groups. Points for each group are given only if all tests of the group and all tests of the required groups are passed. Please note that passing the example tests is not required for some groups. $\\textbf{Offline-evaluation}$ means that the results of testing your solution on this group will only be available after the end of the competition.\n\nIf there are constraints on $m$ or $k$ in a subtask, they apply to both $m_0$ and $k_0$, as well as to the parameters of all first and third type queries.\n\n| Group | Points | Additional constraints: $n$ | $m$ | $k$ | $q$ | Required Groups | Comment |\n| :---- | :----- | :-------------------------- | :-- | :-- | :-- | :-------------- | :------ |\n| 0     | 0      | --                           | --  | --  | --  | --              | Examples. |\n| 1     | 4      | $n \\le 1000$                 | $m \\le 1000$ | --  | $q=0$ | --              | -- |\n| 2     | 5      | --                           | --  | $k=1$ | $q=0$ | --              | -- |\n| 3     | 6      | --                           | --  | $k=1$ | $q \\le 100\\,000$ | 2  | $t_j=1$ for all queries |\n| 4     | 7      | --                           | --  | $k=1$ | $q \\le 100\\,000$ | 2, 3  | $t_j \\ne 3$ for all queries |\n| 5     | 11     | --                           | --  | $k=2$ | $q=0$ | --              | -- |\n| 6     | 9      | --                           | $m \\le 10^6$ | --  | $q=0$ | 1  | -- |\n| 7     | 10     | $n \\le 1000$                 | --  | --  | $q=0$ | 1  | -- |\n| 8     | 7      | --                           | --  | --  | $q=0$ | 1, 2, 5 -- 7  | -- |\n| 9     | 11     | --                           | --  | --  | $q \\le 100\\,000$ | 1 -- 3, 5 -- 8 | $t_j=1$ for all queries |\n| 10    | 13     | --                           | --  | --  | $q \\le 100\\,000$ | 1 -- 3, 5 -- 9 | $t_j\\ne 2$ for all queries |\n| 11    | 9      | --                           | --  | --  | $q \\le 100\\,000$ | 0 -- 10  | -- |\n| 12    | 8      | --                           | --  | --  | --  | 0 -- 11  | **Offline-evaluation.** |", "locale": "en", "translations": {"en": {"title": "[OOI 2025] Order Statistics", "background": "", "description": "You are given an array $a_1$, $a_2$, $\\ldots$, $a_n$, consisting of integers, as well as integers $k$ and $m$.\nThe following operation is performed $m$ times on the array:\n\n- Select $i_1$, $i_2$, $\\ldots$, $i_k$ --- the positions of the $k$ largest elements in the array $a$. If two elements are equal, the element that appears earlier in the array is considered larger.\n- Decrease $a_{i_1}$, $a_{i_2}$, $\\ldots$, $a_{i_k}$ by $1$.\n\nFor $x$ from $1$ to $n$, let $F_{m,k}(x)$ denote the value of the $x$-th order statistic in the array obtained from $a$ after applying the operation $m$ times with the given parameter $k$. For $x$ from $1$ to $n$, the $x$-th order statistic of the array $a_1,a_2,\\ldots,a_n$ is the element that would be in position $x$ if the array $a$ were sorted in non-decreasing order.\n\nFor all $l, r$ such that $1 \\le l \\le r \\le n$, let $S_{m,k}(l,r)$ denote the sum of $F_{m,k}(x)$ for all integers $x$ from $l$ to $r$.\nMore formally:\n$$\nS_{m,k}(l,r)=\\sum_{x=l}^r F_{m,k}(x)\n$$\nYou are given integers $m_0$ and $k_0$.\nYou must compute the values of $F_{m_0,k_0}(x)$ for all $x$ from $1$ to $n$.\n\nAfter that, you must process $q$ queries. The $j$-th query ($1 \\le j \\le q$) can be one of three types:\n\n- Compute the value of $F_{m_j,k_j}(x_j)$.\n- Change the value of $a_{p_j}$ to $v_j$.\n- Compute the value of $S_{m_j,k_j}(l_j,r_j)$.\n\nAll calculations of the functions $F$ and $S$ are performed independently each time and do not change the array. All changes to the array in queries of the second type are preserved for subsequent queries.", "inputFormat": "The first line contains four integers $n$, $m_0$, $k_0$, and $q$ ($1 \\le n \\le 200\\,000$, $0 \\le m_0 \\le 10^9$,\n$1 \\le k_0 \\le n$, $0 \\le q \\le 200\\,000$) --- the length of the array $a$;\nthe number of operations; the number of largest elements decreased in each operation, and the number of queries.\n\nThe second line contains $n$ integers $a_1,\\ a_2,\\ \\ldots,\\ a_n$ ($-10^9 \\le a_i \\le 10^9$, $1 \\le i \\le n$) --- the elements of the array $a$.\n\nThe next $q$ lines contain the queries. In the $j$-th query, the first number is $t_j$ ($1 \\le t_j \\le 3$) --- the type of the $j$-th query.\n\n- If $t_j=1$, then the next line contains three integers $m_j$, $k_j$, and $x_j$ ($0 \\le m_j \\le 10^9$, $1 \\le k_j,x_j \\le n$)--- the parameters of the first type query.\n- If $t_j=2$, then the next line contains two integers $p_j$ and $v_j$ ($1 \\le p_j \\le n$, $-10^9 \\le v_j \\le 10^9$)--- the parameters of the second type query.\n- If $t_j=3$, then the next line contains four integers $m_j$, $k_j$, $l_j$, and $r_j$ ($0 \\le m_j \\le 10^9$, $1 \\le k_j,l_j,r_j \\le n$, $l_j \\le r_j$)--- the parameters of the third type query.", "outputFormat": "In the first line, output $n$ integers $F_{m_0,k_0}(1),F_{m_0,k_0}(2),\\ldots,F_{m_0,k_0}(n)$.\n\nThen, for each first type query, output the value $F_{m_j, k_j}(x_j)$ on a separate line, and for each third type query, output the value $S_{m_j,k_j}(l_j,r_j)$~--- the answer to the $j$-th query.", "hint": "In the example, $n=8$, $m_0=3$, $k_0=2$, $q=16$. Initially, the array $a$ is $[3, 1, 2, -1, 0, 2, -1, 4]$.\nLet's see how the array will change if we apply the operation $m_0$ times with parameter $k_0$:\n\n- The array is $[3,1,2,-1,0,2,-1,4]$. The two largest elements are in positions $1$ and $8$. \nThey are decreased by $1$, after which the array becomes $[2,1,2,-1,0,2,-1,3]$.\n- The array is $[2,1,2,-1,0,2,-1,3]$. The two largest elements are in positions $1$ and $8$. \nThey are decreased by $1$, after which the array becomes $[1,1,2,-1,0,2,-1,2]$.\n- The array is $[1,1,2,-1,0,2,-1,2]$. The two largest elements are in positions $3$ and $6$. They are decreased by $1$, after which the array becomes $[1,1,1,-1,0,1,-1,2]$.\n\nWe find that after applying the operation $3$ times with parameter $2$ to the array $a$, it becomes\n$[1,1,1,-1,0,1,-1,2]$. If this array is sorted, it results in \nthe array $[-1,-1,0,1,1,1,1,2]$. Thus, the order statistics are $F_{3,2}(1)=-1$, $F_{3,2}(2)=-1$, $F_{3,2}(3)=0$, $F_{3,2}(4)=1$, $F_{3,2}(5)=1$,\n$F_{3,2}(6)=1$, $F_{3,2}(7)=1$, $F_{3,2}(8)=2$.\n\nIn the example, we need to process $16$ queries; let's analyze the first $10$ of them in detail:\n- The first query is of type $t_1=3$, with parameters $m_1=3$, $k_1=2$, $l_1=2$, $r_1=6$ and requires computing the value of $S_{3,2}(2,6)$. We have already computed the values of $F_{3,2}(x)$\nfor $x$ from $1$ to $8$, from which we find the answer to the query:\n$$S_{3,2}(2,6)=F_{3,2}(2)+F_{3,2}(3)+F_{3,2}(4)+F_{3,2}(5)+F_{3,2}(6)=(-1)+0+1+1+1=2$$\n- The second query is of type $t_2=1$, with parameters $m_2=3$, $k_2=2$, $x_2=4$ and \nrequires computing the value of $F_{3,2}(4)$. We have already computed it, and it equals $1$.\n- The third query is of type $t_3=3$, with parameters $m_3=4$, $k_3=5$, $l_3=3$, $r_3=5$ and requires computing the value of $S_{4,5}(3,5)$, that is, to calculate the sum of the order statistics from the third to the fifth in the array obtained from $a$ after applying the operation $m_3=4$ times with parameter $k_3=5$. At the time of the third query, the array $a$ is $[3, 1, 2, -1, 0, 2, -1, 4]$. The five largest elements are in positions $1,2,3,6,8$. Decreasing them by $1$, we get the array $[2,0,1,-1,0,1,-1,3]$. Applying the operation three more times, we get the array $[-1,-2,-2,-2,-1,-1,-1,0]$. After sorting, it becomes $[-2,-2,-2,-1,-1,-1,-1,0]$. Thus, the answer to the query is \n$$S_{4,5}(3,5)=F_{4,5}(3)+F_{4,5}(4)+F_{4,5}(5)=(-2)+(-1)+(-1)=-4$$\n- The fourth query is of type $t_4=1$, with parameters $m_4=4$, $k_4=5$, $x_4=6$. After applying four operations with parameter $5$ and sorting the array $a$, it will be $[-2,-2,-2,-1,-1,-1,-1,0]$, so the sixth order statistic is $-1$.\n- The fifth query is of type $t_5=2$, with parameters $p_5=5$ and $v_5=-1$. It changes the value of $a_5$ to $-1$, after which the array $a$ becomes $[3,1,2,-1,-1,2,-1,4]$.\n- The sixth query is of type $t_6=2$, with parameters $p_6=6$ and $v_6=3$. It changes the value of $a_6$ to $3$, after which the array $a$ becomes $[3,1,2,-1,-1,3,-1,4]$.\n- The seventh query requires finding the value of $F_{3,2}(1)$. At the time of the seventh query, the array $a$ is $[3,1,2,-1,-1,3,-1,4]$. After applying $3$ times the operation with parameter $2$, it will be $[1, 1, 1, -1, -1, 2, -1, 2]$. The first order statistic of this array is $-1$.\n- The eighth, ninth, and tenth queries require finding the values of $F_{3,2}(3)$, $F_{3,2}(4)$ and $F_{3,2}(8)$, that is, the third, fourth, and eighth order statistics in the array $[1, 1, 1, -1, -1, 2, -1, 2]$. They are equal to $-1$, $1$, and $2$, respectively.\n\n**Scoring**\n\nThe tests for this problem consist of eleven groups. Points for each group are given only if all tests of the group and all tests of the required groups are passed. Please note that passing the example tests is not required for some groups. $\\textbf{Offline-evaluation}$ means that the results of testing your solution on this group will only be available after the end of the competition.\n\nIf there are constraints on $m$ or $k$ in a subtask, they apply to both $m_0$ and $k_0$, as well as to the parameters of all first and third type queries.\n\n| Group | Points | Additional constraints: $n$ | $m$ | $k$ | $q$ | Required Groups | Comment |\n| :---- | :----- | :-------------------------- | :-- | :-- | :-- | :-------------- | :------ |\n| 0     | 0      | --                           | --  | --  | --  | --              | Examples. |\n| 1     | 4      | $n \\le 1000$                 | $m \\le 1000$ | --  | $q=0$ | --              | -- |\n| 2     | 5      | --                           | --  | $k=1$ | $q=0$ | --              | -- |\n| 3     | 6      | --                           | --  | $k=1$ | $q \\le 100\\,000$ | 2  | $t_j=1$ for all queries |\n| 4     | 7      | --                           | --  | $k=1$ | $q \\le 100\\,000$ | 2, 3  | $t_j \\ne 3$ for all queries |\n| 5     | 11     | --                           | --  | $k=2$ | $q=0$ | --              | -- |\n| 6     | 9      | --                           | $m \\le 10^6$ | --  | $q=0$ | 1  | -- |\n| 7     | 10     | $n \\le 1000$                 | --  | --  | $q=0$ | 1  | -- |\n| 8     | 7      | --                           | --  | --  | $q=0$ | 1, 2, 5 -- 7  | -- |\n| 9     | 11     | --                           | --  | --  | $q \\le 100\\,000$ | 1 -- 3, 5 -- 8 | $t_j=1$ for all queries |\n| 10    | 13     | --                           | --  | --  | $q \\le 100\\,000$ | 1 -- 3, 5 -- 9 | $t_j\\ne 2$ for all queries |\n| 11    | 9      | --                           | --  | --  | $q \\le 100\\,000$ | 0 -- 10  | -- |\n| 12    | 8      | --                           | --  | --  | --  | 0 -- 11  | **Offline-evaluation.** |", "locale": "en"}, "zh-CN": {"title": "[OOI 2025] Order Statistics", "background": "[试题来源](https://inf-open.ru/2024-25/final-materials/)。", "description": "给定一个由整数组成的数组 $a_1, a_2, \\ldots, a_n$，以及整数 $k$ 和 $m$。\n对该数组执行以下操作 $m$ 次：\n\n- 选出数组 $a$ 中 $k$ 个最大元素的位置 $i_1, i_2, \\ldots, i_k$。如果两个元素相等，则认为数组中较早出现的元素更大。\n- 将 $a_{i_1}, a_{i_2}, \\ldots, a_{i_k}$ 的值各减 $1$。\n\n对于从 $1$ 到 $n$ 的 $x$，令 $F_{m,k}(x)$ 表示对数组 $a$ 应用 $m$ 次参数为 $k$ 的操作后得到的数组中第 $x$ 个顺序统计量的值。对于从 $1$ 到 $n$ 的 $x$，数组 $a_1, a_2, \\ldots, a_n$ 的第 $x$ 个顺序统计量是指如果将数组 $a$ 按非递减顺序排序后，位于位置 $x$ 的元素。\n\n对于所有满足 $1 \\le l \\le r \\le n$ 的 $l, r$，令 $S_{m,k}(l,r)$ 表示所有从 $l$ 到 $r$ 的整数 $x$ 的 $F_{m,k}(x)$ 之和。\n更正式地：\n$$\nS_{m,k}(l,r)=\\sum_{x=l}^r F_{m,k}(x)\n$$\n给定整数 $m_0$ 和 $k_0$。\n你必须计算所有从 $1$ 到 $n$ 的 $x$ 的 $F_{m_0,k_0}(x)$ 的值。\n\n之后，你必须处理 $q$ 个查询。第 $j$ 个查询（$1 \\le j \\le q$）可以是以下三种类型之一：\n\n- 计算 $F_{m_j,k_j}(x_j)$ 的值。\n- 将 $a_{p_j}$ 的值修改为 $v_j$。\n- 计算 $S_{m_j,k_j}(l_j,r_j)$ 的值。\n\n所有函数 $F$ 和 $S$ 的计算每次都是独立进行的，并且不会改变数组。第二种类型查询对数组的所有修改都会保留到后续查询中。", "inputFormat": "第一行包含四个整数 $n$、$m_0$、$k_0$ 和 $q$（$1 \\le n \\le 200\\,000$，$0 \\le m_0 \\le 10^9$，$1 \\le k_0 \\le n$，$0 \\le q \\le 200\\,000$）—— 分别表示数组 $a$ 的长度、操作次数、每次操作中减少的最大的元素数量以及查询的数量。\n\n第二行包含 $n$ 个整数 $a_1, a_2, \\ldots, a_n$（$-10^9 \\le a_i \\le 10^9$，$1 \\le i \\le n$）—— 数组 $a$ 的元素。\n\n接下来的 $q$ 行包含查询。在第 $j$ 个查询中，第一个数字是 $t_j$（$1 \\le t_j \\le 3$）—— 第 $j$ 个查询的类型。\n\n- 如果 $t_j=1$，则下一行包含三个整数 $m_j$、$k_j$ 和 $x_j$（$0 \\le m_j \\le 10^9$，$1 \\le k_j, x_j \\le n$）—— 第一类查询的参数。\n- 如果 $t_j=2$，则下一行包含两个整数 $p_j$ 和 $v_j$（$1 \\le p_j \\le n$，$-10^9 \\le v_j \\le 10^9$）—— 第二类查询的参数。\n- 如果 $t_j=3$，则下一行包含四个整数 $m_j$、$k_j$、$l_j$ 和 $r_j$（$0 \\le m_j \\le 10^9$，$1 \\le k_j, l_j, r_j \\le n$，$l_j \\le r_j$）—— 第三类查询的参数。", "outputFormat": "第一行输出 $n$ 个整数 $F_{m_0,k_0}(1), F_{m_0,k_0}(2), \\ldots, F_{m_0,k_0}(n)$。\n\n然后，对于每个第一类查询，单独一行输出值 $F_{m_j, k_j}(x_j)$；对于每个第三类查询，单独一行输出值 $S_{m_j, k_j}(l_j, r_j)$ —— 即第 $j$ 个查询的答案。", "hint": "**样例解释**\n\n在样例中，$n=8$，$m_0=3$，$k_0=2$，$q=16$。初始时，数组 $a$ 为 $[3, 1, 2, -1, 0, 2, -1, 4]$。\n让我们看看如果用参数 $k_0$ 对数组应用 $m_0$ 次操作，数组会如何变化：\n\n- 数组为 $[3,1,2,-1,0,2,-1,4]$。两个最大的元素位于位置 $1$ 和 $8$。将它们减 $1$ 后，数组变为 $[2,1,2,-1,0,2,-1,3]$。\n- 数组为 $[2,1,2,-1,0,2,-1,3]$。两个最大的元素位于位置 $1$ 和 $8$。将它们减 $1$ 后，数组变为 $[1,1,2,-1,0,2,-1,2]$。\n- 数组为 $[1,1,2,-1,0,2,-1,2]$。两个最大的元素位于位置 $3$ 和 $6$。将它们减 $1$ 后，数组变为 $[1,1,1,-1,0,1,-1,2]$。\n\n我们发现，对数组 $a$ 应用 $3$ 次参数为 $2$ 的操作后，它变成了 $[1,1,1,-1,0,1,-1,2]$。如果对这个数组排序，会得到数组 $[-1,-1,0,1,1,1,1,2]$。因此，顺序统计量为 $F_{3,2}(1)=-1$，$F_{3,2}(2)=-1$，$F_{3,2}(3)=0$，$F_{3,2}(4)=1$，$F_{3,2}(5)=1$，$F_{3,2}(6)=1$，$F_{3,2}(7)=1$，$F_{3,2}(8)=2$。\n\n在样例中，我们需要处理 $16$ 个查询；让我们详细分析前 $10$ 个查询：\n- 第一个查询类型为 $t_1=3$，参数为 $m_1=3$，$k_1=2$，$l_1=2$，$r_1=6$，需要计算 $S_{3,2}(2,6)$ 的值。我们已经计算了从 $1$ 到 $8$ 的 $x$ 的 $F_{3,2}(x)$ 值，由此可以找到查询的答案：$$S_{3,2}(2,6)=F_{3,2}(2)+F_{3,2}(3)+F_{3,2}(4)+F_{3,2}(5)+F_{3,2}(6)=(-1)+0+1+1+1=2$$\n- 第二个查询类型为 $t_2=1$，参数为 $m_2=3$，$k_2=2$，$x_2=4$，需要计算 $F_{3,2}(4)$ 的值。我们已经计算过，它等于 $1$。\n- 第三个查询类型为 $t_3=3$，参数为 $m_3=4$，$k_3=5$，$l_3=3$，$r_3=5$，需要计算 $S_{4,5}(3,5)$ 的值，即计算对数组 $a$ 应用 $m_3=4$ 次参数为 $k_3=5$ 的操作后得到的数组中，从第三个到第五个顺序统计量的和。在第三个查询时，数组 $a$ 为 $[3, 1, 2, -1, 0, 2, -1, 4]$。五个最大的元素位于位置 $1,2,3,6,8$。将它们减 $1$，得到数组 $[2,0,1,-1,0,1,-1,3]$。再应用三次操作，得到数组 $[-1,-2,-2,-2,-1,-1,-1,0]$。排序后变为 $[-2,-2,-2,-1,-1,-1,-1,0]$。因此，查询的答案是 $$S_{4,5}(3,5)=F_{4,5}(3)+F_{4,5}(4)+F_{4,5}(5)=(-2)+(-1)+(-1)=-4$$\n- 第四个查询类型为 $t_4=1$，参数为 $m_4=4$，$k_4=5$，$x_4=6$。在应用 $4$ 次参数为 $5$ 的操作并对数组 $a$ 排序后，数组将变为 $[-2,-2,-2,-1,-1,-1,-1,0]$，所以第六个顺序统计量是 $-1$。\n- 第五个查询类型为 $t_5=2$，参数为 $p_5=5$ 和 $v_5=-1$。它将 $a_5$ 的值修改为 $-1$，之后数组 $a$ 变为 $[3,1,2,-1,-1,2,-1,4]$。\n- 第六个查询类型为 $t_6=2$，参数为 $p_6=6$ 和 $v_6=3$。它将 $a_6$ 的值修改为 $3$，之后数组 $a$ 变为 $[3,1,2,-1,-1,3,-1,4]$。\n- 第七个查询需要找到 $F_{3,2}(1)$ 的值。在第七个查询时，数组 $a$ 为 $[3,1,2,-1,-1,3,-1,4]$。应用 $3$ 次参数为 $2$ 的操作后，它将变为 $[1, 1, 1, -1, -1, 2, -1, 2]$。这个数组的第一个顺序统计量是 $-1$。\n- 第八、第九和第十个查询需要找到 $F_{3,2}(3)$、$F_{3,2}(4)$ 和 $F_{3,2}(8)$ 的值，即数组 $[1, 1, 1, -1, -1, 2, -1, 2]$ 中的第三、第四和第八个顺序统计量。它们分别等于 $-1$、$1$ 和 $2$。\n\n**说明提示**\n\n本题的测试点包含十二个分组。每个分组的分数只有在该分组的所有测试点以及所有依赖分组的测试点都通过时才能获得。请注意，通过样例测试点对于某些分组不是必需的。**Offline-evaluation** 表示该分组的测试结果将在比赛结束后才可查看。\n\n如果某个子任务对 $m$ 或 $k$ 有限制，那么这些限制同时适用于 $m_0$ 和 $k_0$，以及所有第一类和第三类查询的参数。\n\n| Subtask | 分数 | 限制条件：$n$ | $m$ | $k$ | $q$ | 依赖组别 | 说明 |\n| :--- | :--- | :------------- | :-- | :-- | :-- | :-------- | :---- |\n| 0    | 0    | --             | --  | --  | --  | --        | 样例测试点。 |\n| 1    | 4    | $n \\le 1000$   | $m \\le 1000$  | --  | $q=0$ | --        | -- |\n| 2    | 5    | --             | --  | $k=1$  | $q=0$ | --        | -- |\n| 3    | 6    | --             | --  | $k=1$  | $q \\le 100\\,000$ | 2  | 所有查询中 $t_j=1$。 |\n| 4    | 7    | --             | --  | $k=1$  | $q \\le 100\\,000$ | 2, 3  | 所有查询中 $t_j \\ne 3$。 |\n| 5    | 11   | --             | --  | $k=2$  | $q=0$ | --        | -- |\n| 6    | 9    | --             | $m \\le 10^6$  | --  | $q=0$ | 1  | -- |\n| 7    | 10   | $n \\le 1000$   | --  | --  | $q=0$ | 1  | -- |\n| 8    | 7    | --             | --  | --  | $q=0$ | 1, 2, 5 -- 7  | -- |\n| 9    | 11   | --             | --  | --  | $q \\le 100\\,000$ | 1 -- 3, 5 -- 8 | 所有查询中 $t_j=1$。 |\n| 10   | 13   | --             | --  | --  | $q \\le 100\\,000$ | 1 -- 3, 5 -- 9 | 所有查询中 $t_j\\ne 2$。 |\n| 11   | 9    | --             | --  | --  | $q \\le 100\\,000$ | 0 -- 10  | -- |\n| 12   | 8    | --             | --  | --  | --  | 0 -- 11  | **Offline-evaluation.** |", "locale": "zh-CN"}}}
{"pid": "P12081", "type": "P", "difficulty": 7, "samples": [], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["搜索", "网络流", "交互题", "Special Judge", "剪枝", "构造", "通信题"], "title": "基础构造练习题 2（P11635 加强版）", "background": "本题较 P11635（CTS 2025 Day 2 T2）添加了 $K = 8, 9, 10$ 的情形，并提高了 $K = 6, 7$ 时 $N$ 的限制。注意：P11635 的所有 `unsigned int` 需要修改为 `unsigned long long`。", "description": "**这是一道通信题。**\n\n有若干个节点，它们一开始分别存储有一个数字 $a_i \\in \\{0, 1\\}$，它们想要通过 $K$ 轮通信知道其它每个节点存储的数字。\n\n每一轮通信开始的时候，每个节点 $i$ 对每个节点 $j$，都会选择一个数字 $c_{i,j} \\in \\{0, 1\\}$，表示它将会向节点 $j$ 发送数字 $c_{i,j}$，而在这轮通信结束的时候，节点 $j$ 会收到所有节点向它发送的数字的和，具体而言节点 $j$ 会收到一个数字 $s_j = \\sum_{i} c_{i,j}$。\n\n现在给定 $K$，你需要找到一个尽量大的 $N$，满足在通过 $K$ 轮通信之后每个节点都可以知道所有节点存储的数字。\n\n### 实现细节\n\n**你不需要，也不应该实现 `main` 函数。**\n\n你需要实现以下函数：\n\n1. `int init(int K);`\n   - 该函数传入通信总轮数 $K$ 的值。**保证** $1 \\leq K \\leq 10$。\n   - 该函数需要返回你选择的节点数量 $N$，**你需要保证** $1 \\leq N \\leq 60$。\n   - 对于每次代码运行，**保证在任意 `send` 函数调用前，该函数会被交互库调用恰好一次**。\n\n2. `unsigned long long send(int K, int N, int round, int number, const std::vector<int>& received);`\n   - 该函数传入通信总轮数 $K$，你实现的 `init` 函数返回的节点数量 $N$，当前通信的轮数 `round`，当前你需要实现的节点的编号 `number`，当前节点之前通信的轮数中收到的数字 `received`，其中 `received[0]` 表示这个节点一开始存储的数字，而 `received[i] (1 \\leq i < \\text{round})` 表示这个节点第 $i$ 轮通信结束的时候收到的数字。**保证** $1 \\leq K \\leq 10$，$1 \\leq \\text{round} \\leq K + 1$，$0 \\leq \\text{number} < N$，**且 `received` 的长度为 `round`**。\n   - 若 $1 \\leq \\text{round} \\leq K$，你需要返回一个无符号 $64$ 位整数 $x$ 表示在这轮通信中节点 `number` 发送给所有节点的数字，其中 $x$ 的第 $i$ 位为节点 `number` 发送给节点 $i$ 的数字，高位用 $0$ 补齐。\n   - 若 $\\text{round} = K + 1$，你需要返回一个无符号 $64$ 位整数 $x$ 表示节点 `number` 经过 $K$ 轮通信后确定的每个节点存储的数字，其中 $x$ 的第 $i$ 位为编号为 $i$ 的节点存储的数字，高位用 $0$ 补齐。\n   - 对于每次代码运行，**保证该函数会被交互库调用不超过 $10^5$ 次**。\n\n注意：你需要保证，对于任意两次传入参数相同的函数调用（包括 `init` 和 `send`），返回值也应当相同，否则你的程序将会直接被判定为错误。\n\n题目保证在规定的限制下，交互库在每次代码运行中的运行时间不会超过 $100\\, \\mathrm{ms}$；交互库使用的内存大小固定，且不超过 $64\\, \\mathrm{MiB}$。这意味着在每次代码运行中你的代码可以使用至少 $900\\, \\mathrm{ms}$ 的时间和 $448\\,\\mathrm{MiB}$ 的空间。\n", "inputFormat": "", "outputFormat": "", "hint": "### 测试程序方式\n\n**下发文件中的 `grader.cpp` 是提供的交互库参考实现，最终测试时所用的交互库实现与该参考实现有所不同，因此你的解法不应该依赖交互库实现。**\n\n将你的程序命名为 `message.cpp` 并放置于下发文件目录下后，你可以在下发文件目录下使用如下命令进行测试：\n\n```bash\ng++ grader.cpp message.cpp -o grader -std=c++17 -O2\n./grader\n```\n\n上述脚本将从**标准输入**读入以下格式的数据：\n\n- 输入的第一行一个整数 $0$。\n- 输入的第二行两个正整数 $T, K$，其中 $T$ 表示进行通信的次数，$K$ 表示每次通信的轮数。你需要保证 $1 \\leq T \\leq 101$，$1 \\leq K \\leq 10$。\n- 输入的第 $i + 2 (0 \\leq i < T)$ 行一个无符号 $64$ 位整数 $x_i$，表示第 $i$ 次通信时每个节点初始存储的数字，其中 $x_i$ 的第 $j$ 位表示 $j$ 号节点初始存储的数字。你需要保证 $\\forall 0 \\leq i < T, 0 \\leq x_i < 2^{64}$。\n\n上述脚本将输出以下格式的数据到**标准输出**：\n\n- 若通信结果正确，则输出 `Accepted! (N = [N], K = [K])`；\n- 若通信结果错误，则输出 `Wrong answer!`。\n\n### 下发文件说明\n\n在下发文件中：\n\n1. `grader.cpp` 是提供的交互库参考实现。\n2. `template_message.cpp` 是提供的示例代码，你可以在此代码的基础上实现。\n\n### 子任务\n\n本题共有 $10$ 个子任务，每个子任务分值为 $100$ 分，总分为 $1000$ 分。一个子任务的得分为其中所有测试点的得分最小值。\n\n对于所有测试数据，保证 $1 \\leq K \\leq 10$，且对于每次代码运行，`send` 会被交互库调用不超过 $10^5$ 次。**对于第 $i$ 个子任务，保证 $K = i$。**\n\n### 评分方式\n\n**注意**：\n\n- 你不应当通过非法方式获取交互库的内部信息，如试图直接读取交互库中存储的值，或直接与标准输入、输出流进行交互。此类行为将被视为作弊；\n- **最终的评测交互库与样例交互库的实现有所不同，因此你的解法不应该依赖交互库实现。**\n\n**本题首先会受到和传统题相同的限制**，例如编译错误会导致整道题目得 0 分，运行时错误、超过时间限制、超过空间限制等会导致相应测试点得 0 分等。你只能在程序中访问自己定义的和交互库给出的变量及其对应的内存空间，尝试访问其他空间将可能导致编译错误或运行错误。\n\n在上述条件基础上，在每个测试点中，程序得到的分数将按照以下方式计算：\n\n- 若对于任意两次传入参数相同的该函数调用，返回值不同，则获得 0 分；\n- 若 $K$ 轮通信后确定的每个节点存储的数字与每个节点初始存储的数字不同，则获得 0 分；\n- 否则设 $N$ 为调用函数 `init()` 得到的结果，则该测试点的得分为 $s \\times {0.7}^{\\max(C(K) - N, 0)}$，其中 $s$ 为该测试点的分值，$C(K)$ 的计算方式如下表所示：\n\n| 子任务编号 $= K =$ | $C(K) =$ |\n| :-: | :-: |\n| $1$ | $2$ |\n| $2$ | $4$ |\n| $3$ | $6$ |\n| $4$ | $11$ |\n| $5$ | $14$ |\n| $6$ | $22$ |\n| $7$ | $26$ |\n| $8$ | $36$ |\n| $9$ | $41$ |\n| $10$ | $47$ |\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "基础构造练习题 2（P11635 加强版）", "background": "本题较 P11635（CTS 2025 Day 2 T2）添加了 $K = 8, 9, 10$ 的情形，并提高了 $K = 6, 7$ 时 $N$ 的限制。注意：P11635 的所有 `unsigned int` 需要修改为 `unsigned long long`。", "description": "**这是一道通信题。**\n\n有若干个节点，它们一开始分别存储有一个数字 $a_i \\in \\{0, 1\\}$，它们想要通过 $K$ 轮通信知道其它每个节点存储的数字。\n\n每一轮通信开始的时候，每个节点 $i$ 对每个节点 $j$，都会选择一个数字 $c_{i,j} \\in \\{0, 1\\}$，表示它将会向节点 $j$ 发送数字 $c_{i,j}$，而在这轮通信结束的时候，节点 $j$ 会收到所有节点向它发送的数字的和，具体而言节点 $j$ 会收到一个数字 $s_j = \\sum_{i} c_{i,j}$。\n\n现在给定 $K$，你需要找到一个尽量大的 $N$，满足在通过 $K$ 轮通信之后每个节点都可以知道所有节点存储的数字。\n\n### 实现细节\n\n**你不需要，也不应该实现 `main` 函数。**\n\n你需要实现以下函数：\n\n1. `int init(int K);`\n   - 该函数传入通信总轮数 $K$ 的值。**保证** $1 \\leq K \\leq 10$。\n   - 该函数需要返回你选择的节点数量 $N$，**你需要保证** $1 \\leq N \\leq 60$。\n   - 对于每次代码运行，**保证在任意 `send` 函数调用前，该函数会被交互库调用恰好一次**。\n\n2. `unsigned long long send(int K, int N, int round, int number, const std::vector<int>& received);`\n   - 该函数传入通信总轮数 $K$，你实现的 `init` 函数返回的节点数量 $N$，当前通信的轮数 `round`，当前你需要实现的节点的编号 `number`，当前节点之前通信的轮数中收到的数字 `received`，其中 `received[0]` 表示这个节点一开始存储的数字，而 `received[i] (1 \\leq i < \\text{round})` 表示这个节点第 $i$ 轮通信结束的时候收到的数字。**保证** $1 \\leq K \\leq 10$，$1 \\leq \\text{round} \\leq K + 1$，$0 \\leq \\text{number} < N$，**且 `received` 的长度为 `round`**。\n   - 若 $1 \\leq \\text{round} \\leq K$，你需要返回一个无符号 $64$ 位整数 $x$ 表示在这轮通信中节点 `number` 发送给所有节点的数字，其中 $x$ 的第 $i$ 位为节点 `number` 发送给节点 $i$ 的数字，高位用 $0$ 补齐。\n   - 若 $\\text{round} = K + 1$，你需要返回一个无符号 $64$ 位整数 $x$ 表示节点 `number` 经过 $K$ 轮通信后确定的每个节点存储的数字，其中 $x$ 的第 $i$ 位为编号为 $i$ 的节点存储的数字，高位用 $0$ 补齐。\n   - 对于每次代码运行，**保证该函数会被交互库调用不超过 $10^5$ 次**。\n\n注意：你需要保证，对于任意两次传入参数相同的函数调用（包括 `init` 和 `send`），返回值也应当相同，否则你的程序将会直接被判定为错误。\n\n题目保证在规定的限制下，交互库在每次代码运行中的运行时间不会超过 $100\\, \\mathrm{ms}$；交互库使用的内存大小固定，且不超过 $64\\, \\mathrm{MiB}$。这意味着在每次代码运行中你的代码可以使用至少 $900\\, \\mathrm{ms}$ 的时间和 $448\\,\\mathrm{MiB}$ 的空间。\n", "inputFormat": "", "outputFormat": "", "hint": "### 测试程序方式\n\n**下发文件中的 `grader.cpp` 是提供的交互库参考实现，最终测试时所用的交互库实现与该参考实现有所不同，因此你的解法不应该依赖交互库实现。**\n\n将你的程序命名为 `message.cpp` 并放置于下发文件目录下后，你可以在下发文件目录下使用如下命令进行测试：\n\n```bash\ng++ grader.cpp message.cpp -o grader -std=c++17 -O2\n./grader\n```\n\n上述脚本将从**标准输入**读入以下格式的数据：\n\n- 输入的第一行一个整数 $0$。\n- 输入的第二行两个正整数 $T, K$，其中 $T$ 表示进行通信的次数，$K$ 表示每次通信的轮数。你需要保证 $1 \\leq T \\leq 101$，$1 \\leq K \\leq 10$。\n- 输入的第 $i + 2 (0 \\leq i < T)$ 行一个无符号 $64$ 位整数 $x_i$，表示第 $i$ 次通信时每个节点初始存储的数字，其中 $x_i$ 的第 $j$ 位表示 $j$ 号节点初始存储的数字。你需要保证 $\\forall 0 \\leq i < T, 0 \\leq x_i < 2^{64}$。\n\n上述脚本将输出以下格式的数据到**标准输出**：\n\n- 若通信结果正确，则输出 `Accepted! (N = [N], K = [K])`；\n- 若通信结果错误，则输出 `Wrong answer!`。\n\n### 下发文件说明\n\n在下发文件中：\n\n1. `grader.cpp` 是提供的交互库参考实现。\n2. `template_message.cpp` 是提供的示例代码，你可以在此代码的基础上实现。\n\n### 子任务\n\n本题共有 $10$ 个子任务，每个子任务分值为 $100$ 分，总分为 $1000$ 分。一个子任务的得分为其中所有测试点的得分最小值。\n\n对于所有测试数据，保证 $1 \\leq K \\leq 10$，且对于每次代码运行，`send` 会被交互库调用不超过 $10^5$ 次。**对于第 $i$ 个子任务，保证 $K = i$。**\n\n### 评分方式\n\n**注意**：\n\n- 你不应当通过非法方式获取交互库的内部信息，如试图直接读取交互库中存储的值，或直接与标准输入、输出流进行交互。此类行为将被视为作弊；\n- **最终的评测交互库与样例交互库的实现有所不同，因此你的解法不应该依赖交互库实现。**\n\n**本题首先会受到和传统题相同的限制**，例如编译错误会导致整道题目得 0 分，运行时错误、超过时间限制、超过空间限制等会导致相应测试点得 0 分等。你只能在程序中访问自己定义的和交互库给出的变量及其对应的内存空间，尝试访问其他空间将可能导致编译错误或运行错误。\n\n在上述条件基础上，在每个测试点中，程序得到的分数将按照以下方式计算：\n\n- 若对于任意两次传入参数相同的该函数调用，返回值不同，则获得 0 分；\n- 若 $K$ 轮通信后确定的每个节点存储的数字与每个节点初始存储的数字不同，则获得 0 分；\n- 否则设 $N$ 为调用函数 `init()` 得到的结果，则该测试点的得分为 $s \\times {0.7}^{\\max(C(K) - N, 0)}$，其中 $s$ 为该测试点的分值，$C(K)$ 的计算方式如下表所示：\n\n| 子任务编号 $= K =$ | $C(K) =$ |\n| :-: | :-: |\n| $1$ | $2$ |\n| $2$ | $4$ |\n| $3$ | $6$ |\n| $4$ | $11$ |\n| $5$ | $14$ |\n| $6$ | $22$ |\n| $7$ | $26$ |\n| $8$ | $36$ |\n| $9$ | $41$ |\n| $10$ | $47$ |\n", "locale": "zh-CN"}}}
{"pid": "P12082", "type": "P", "difficulty": 7, "samples": [["5 5\n1 1 3\n1 2 4\n3 1 4\n2 1\n3 1 4", "Y\nN"], ["9 17\n1 6 9\n1 1 8\n1 5 7\n1 6 8\n1 8 9\n3 4 5\n3 1 7\n3 8 9\n1 4 9\n3 1 8\n3 1 7\n1 6 9\n3 2 6\n2 2\n1 1 3\n3 1 2\n1 4 6", "N\nN\nY\nY\nN\nN\nN"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["1998", "O2优化", "Ynoi"], "title": "[Ynoi1998] Frühlingsbeginn", "background": "![](https://free.picui.cn/free/2025/04/03/67ee78ef1f378.png)", "description": "给定 $n,m$，你需要维护一个 $[1,n)$ 的数轴上区间的初始为空的可重集合，支持三种操作共 $m$ 次：\n\n1. 插入一个区间 $[l,r)$。\n2. 删除第 $t$ 次操作插入的区间。\n3. 给出一个区间 $[l,r)$，判断当前可重集合是否存在一个子集，使得子集中所有区间的并恰好是 $[l,r)$。", "inputFormat": "第一行两个整数 $n,m$。\n\n下面 $m$ 行，每行若干个整数描述一次操作，可能是 `1 l r`、`2 t` 或 `3 l r`。", "outputFormat": "对于每个询问，输出一行一个大写字母 `Y` 或 `N`。`Y` 表示存在这样的子集，`N` 反之。", "hint": "Idea：critnos，Solution：critnos，Code：fjy666，Data：critnos\n\n所有数据保证 $2\\le n\\le 10^6$，$1\\le m\\le 5\\times 10^5$，$1\\le l<r\\le n$。所有操作 $2$ 对应的 $t$ 都是此前的操作 $1$ 且所有 $t$ 互不相同。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi1998] Frühlingsbeginn", "background": "![](https://free.picui.cn/free/2025/04/03/67ee78ef1f378.png)", "description": "给定 $n,m$，你需要维护一个 $[1,n)$ 的数轴上区间的初始为空的可重集合，支持三种操作共 $m$ 次：\n\n1. 插入一个区间 $[l,r)$。\n2. 删除第 $t$ 次操作插入的区间。\n3. 给出一个区间 $[l,r)$，判断当前可重集合是否存在一个子集，使得子集中所有区间的并恰好是 $[l,r)$。", "inputFormat": "第一行两个整数 $n,m$。\n\n下面 $m$ 行，每行若干个整数描述一次操作，可能是 `1 l r`、`2 t` 或 `3 l r`。", "outputFormat": "对于每个询问，输出一行一个大写字母 `Y` 或 `N`。`Y` 表示存在这样的子集，`N` 反之。", "hint": "Idea：critnos，Solution：critnos，Code：fjy666，Data：critnos\n\n所有数据保证 $2\\le n\\le 10^6$，$1\\le m\\le 5\\times 10^5$，$1\\le l<r\\le n$。所有操作 $2$ 对应的 $t$ 都是此前的操作 $1$ 且所有 $t$ 互不相同。", "locale": "zh-CN"}}}
