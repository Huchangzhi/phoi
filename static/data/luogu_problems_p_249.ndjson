{"pid": "P6035", "type": "P", "difficulty": 5, "samples": [["5\n0 3 0 0 0\n", "1\n1 5 2 3 4"], ["5\n0 3 -1 0 0\n", "3\n1 5 2 3 4"], ["5\n0 3 -1 0 1\n", "0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2020", "线段树"], "title": "Ryoku 的逆序对", "background": "Ryoku 并不知道这题的背景是什么。", "description": "Ryoku 有一个正整数 $\\{1,2,\\cdots,n\\}$ 的排列 $A = \\{a_i\\}$。\n\n她告诉你一个序列 $B = \\{b_i\\}$，表示对于每个数 $a_i$，对于所有 $j>i$ 有 $b_i$ 个数可以与 $a_i$ 组成逆序对（逆序对的定义是：满足 $i>j$ 且 $a_i < a_j$ 的一组 $(a_i, a_j)$ 称作一对逆序对）。\n\n不幸的是，Ryoku 给你的序列 $B$ 有一些位置污损了，你想知道有多少个可能的排列 $A$ 能符合条件。\n\n请你输出答案并构造一个**字典序最小**的排列 $A$（对于排列 $A = \\{a_i\\},\\ A' = \\{a'_i\\}$ 若存在某个位置 $i$，使得 $\\forall j < i, a_j = a'_j$ 且 $a_i < a'_i$，则 $A$ 的字典序小于 $A'$）。", "inputFormat": "输入包含两行。  \n第一行包含一个整数 $n$。  \n第二行包含 $n$ 个整数，为序列 $B$。若给出的 $b_i = -1$，则代表这个位置被污损了。", "outputFormat": "输出包含两行。  \n第一行包含一个整数，为可能的排列 $A$ 的方案数，对 $10^9 + 7$ 取模。  \n第二行包含 $n$ 个整数，为字典序最小的符合条件的排列。若第一行答案为 $0$，则第二行无需输出。", "hint": "**【样例 1 说明】**\n\n对于 $5$，存在逆序对 $(5,2),(5,3),(5,4)$ 共三对。\n\n**【样例 2 说明】**\n\n符合条件的排列有：$\\{1, 5, 4, 2, 3\\}, \\{1, 5, 3, 2, 4\\}, \\{1, 5, 2, 3, 4\\}$。共三种，其中字典序最小的为 $\\{1, 5, 2, 3, 4\\}$。\n\n---\n\n**【数据规模与约定】**\n\n对于 $10\\%$ 的数据，$b_i \\neq -1$。  \n对于另外 $10\\%$ 的数据，$n \\le 10$。  \n对于另外 $10\\%$ 的数据，$b_i = -1$。  \n对于另外 $30\\%$ 的数据，$n \\le 10^3$。  \n对于另外 $30\\%$ 的数据，$n \\le 10^5$。  \n对于 $100\\%$ 的数据，$0< n \\le 10^6$，$-1 \\le b_i \\le n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "Ryoku 的逆序对", "background": "Ryoku 并不知道这题的背景是什么。", "description": "Ryoku 有一个正整数 $\\{1,2,\\cdots,n\\}$ 的排列 $A = \\{a_i\\}$。\n\n她告诉你一个序列 $B = \\{b_i\\}$，表示对于每个数 $a_i$，对于所有 $j>i$ 有 $b_i$ 个数可以与 $a_i$ 组成逆序对（逆序对的定义是：满足 $i>j$ 且 $a_i < a_j$ 的一组 $(a_i, a_j)$ 称作一对逆序对）。\n\n不幸的是，Ryoku 给你的序列 $B$ 有一些位置污损了，你想知道有多少个可能的排列 $A$ 能符合条件。\n\n请你输出答案并构造一个**字典序最小**的排列 $A$（对于排列 $A = \\{a_i\\},\\ A' = \\{a'_i\\}$ 若存在某个位置 $i$，使得 $\\forall j < i, a_j = a'_j$ 且 $a_i < a'_i$，则 $A$ 的字典序小于 $A'$）。", "inputFormat": "输入包含两行。  \n第一行包含一个整数 $n$。  \n第二行包含 $n$ 个整数，为序列 $B$。若给出的 $b_i = -1$，则代表这个位置被污损了。", "outputFormat": "输出包含两行。  \n第一行包含一个整数，为可能的排列 $A$ 的方案数，对 $10^9 + 7$ 取模。  \n第二行包含 $n$ 个整数，为字典序最小的符合条件的排列。若第一行答案为 $0$，则第二行无需输出。", "hint": "**【样例 1 说明】**\n\n对于 $5$，存在逆序对 $(5,2),(5,3),(5,4)$ 共三对。\n\n**【样例 2 说明】**\n\n符合条件的排列有：$\\{1, 5, 4, 2, 3\\}, \\{1, 5, 3, 2, 4\\}, \\{1, 5, 2, 3, 4\\}$。共三种，其中字典序最小的为 $\\{1, 5, 2, 3, 4\\}$。\n\n---\n\n**【数据规模与约定】**\n\n对于 $10\\%$ 的数据，$b_i \\neq -1$。  \n对于另外 $10\\%$ 的数据，$n \\le 10$。  \n对于另外 $10\\%$ 的数据，$b_i = -1$。  \n对于另外 $30\\%$ 的数据，$n \\le 10^3$。  \n对于另外 $30\\%$ 的数据，$n \\le 10^5$。  \n对于 $100\\%$ 的数据，$0< n \\le 10^6$，$-1 \\le b_i \\le n$。", "locale": "zh-CN"}}}
{"pid": "P6036", "type": "P", "difficulty": 6, "samples": [["3 0.5 0.5\n2 3 3\n0.5 0.5 0.5\n", "3.097"], ["6 0.8 0.2\n1 1 4 5 1 4\n0.9 0.6 0.7 0.7 0.6 0.8\n", "10.521"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "2020", "Special Judge", "期望"], "title": "Ryoku 爱学习", "background": "Ryoku 继承了 Riri 在学习方面的天赋，所以她非常热爱学习。但是，不管再怎么热爱学习，Ryoku 也会疲倦的。", "description": "Ryoku 在第 $i$ 时刻会了解到有一个新知识 $i$，这个新知识的实际价值为 $w_i$，由于 Ryoku 爱学习，所以她不会选择不学习知识，但她只有 $p_i$ 的概率能成功掌握这个知识。\n\n然而如果 Ryoku 同时掌握了太多知识，由于 Ryoku 内心的疲倦等因素，Ryoku 感受到的对知识的喜爱程度会改变，我们用一个数值 $R$ 来描述**喜爱程度**的大小。具体而言，设 $R=f(l,r)$ 代表 Ryoku **连续掌握**时刻 $l$ 至时刻 $r$ 的知识时对这些知识的喜爱程度的总和，有参数 $a, b$（$0 < a, b<1$），则有：\n\n$$ f(l,r)=a^{b(r-l)}  \\sum_{i=l}^r w_i$$\n\nRyoku 想要知道她期望能**掌握的每一段连续时刻的知识**的喜爱程度之和是多少（需要注意的是，这里所说的连续时刻的知识不能被一段更长的所包含）。你能帮帮她吗？\n", "inputFormat": "输入包含三行。  \n第一行包含一个整数 $n$，两个实数 $a,b$。  \n第二行包含 $n$ 个整数，为 $w_i$。  \n第三行包含 $n$ 个实数，为 $p_i$。", "outputFormat": "输出包含一行一个正实数，为答案。", "hint": "**【样例 1 说明】**\n\n掌握知识 $1$、知识 $2$、知识 $3$ 时，每一段连续掌握知识的喜爱程度之和为 $\\left(\\dfrac 12\\right)^{\\frac12\\times 2}(2+3+3)=4$。\n\n掌握知识 $1$、知识 $2$ 时，每一段连续掌握知识的喜爱程度之和为 $\\left(\\dfrac 12\\right)^{\\frac12\\times 1}(2+3)=\\dfrac {5\\sqrt2}2\\approx 3.536$。\n\n掌握知识 $1$、知识 $3$ 时，每一段连续掌握知识的喜爱程度之和为 $\\left(\\dfrac 12\\right)^{\\frac12\\times 0}\\times 2 +\\left(\\dfrac 12\\right)^{\\frac12\\times 0}\\times 3  = 5$。\n\n掌握知识 $2$、知识 $3$ 时，每一段连续掌握知识的喜爱程度之和为 $\\left(\\dfrac 12\\right)^{\\frac12\\times 1}(3+3)=3\\sqrt 2\\approx 4.243$。\n\n只掌握知识 $1$ 时，每一段连续掌握知识的喜爱程度之和为 $\\left(\\dfrac 12\\right)^{\\frac12\\times 0}\\times 2  = 2$。\n\n只掌握知识 $2$ 时，每一段连续掌握知识的喜爱程度之和为 $\\left(\\dfrac 12\\right)^{\\frac12\\times 0}\\times 3  = 3$。\n\n只掌握宝物 $3$ 时，每一段连续掌握知识的喜爱程度之和为 $\\left(\\dfrac 12\\right)^{\\frac12\\times 0}\\times 3  = 3$。\n\n什么都不掌握时，每一段连续掌握知识的喜爱程度之和为 $0$。\n\n以上 $8$ 种情况出现的概率均为 $\\dfrac 18$，所以答案约为：\n\n$$(4+3.536+5+4.243+2+3+3+0)\\times \\dfrac 18\\approx3.0973$$\n\n---\n\n**【数据规模与约定】**\n\n对于 $20\\%$ 的数据，$n \\le 18$。  \n对于另外 $15\\%$ 的数据，$w_i = 1$。  \n对于 $55\\%$ 的数据，$n \\le 10^3$。  \n对于另外 $15\\%$ 的数据，$w_i = 1$。  \n对于另外 $15\\%$ 的数据，$b_i \\le 0.2$。  \n\n此外，对于 $100\\%$ 的数据，$0<n\\le10^5$，$0<a,b,p_i<1$，$0<w_i\\le10^3$。保证输入数据的精度不超过 $10^{-2}$。\n\n**本题使用 Special Judge，如果某个测试点中你的答案与标准答案相差小于等于 $10^{-3}$，你就可以通过该测试点。**\n", "locale": "zh-CN", "translations": {"en": {"title": "Ryoku Loves Studying", "background": "Ryoku inherited Riri’s talent for studying, so she really loves studying. However, no matter how much she loves it, Ryoku can still get tired.", "description": "At time $i$, Ryoku will learn that there is a new piece of knowledge $i$. The actual value of this knowledge is $w_i$. Since Ryoku loves studying, she will not choose to skip any knowledge, but she only has probability $p_i$ of successfully mastering this knowledge.\n\nHowever, if Ryoku masters too much knowledge at the same time, due to factors such as her inner tiredness, Ryoku’s level of “liking” for knowledge will change. We use a value $R$ to describe the magnitude of this **liking level**. Specifically, let $R=f(l,r)$ represent the total liking level for the knowledge from time $l$ to time $r$ that Ryoku **masters continuously**. With parameters $a, b$ ($0 < a, b<1$), we have:\n\n$$ f(l,r)=a^{b(r-l)}  \\sum_{i=l}^r w_i$$\n\nRyoku wants to know the expected total liking level of **every continuous segment of time that she can master** (note that the continuous segment here must not be contained in a longer one). Can you help her?", "inputFormat": "The input contains three lines.  \nThe first line contains an integer $n$ and two real numbers $a,b$.  \nThe second line contains $n$ integers, which are $w_i$.  \nThe third line contains $n$ real numbers, which are $p_i$.", "outputFormat": "Output one line containing one positive real number, which is the answer.", "hint": "**[Sample 1 Explanation]**\n\nWhen mastering knowledge $1$, knowledge $2$, and knowledge $3$, the sum of liking levels over each continuously mastered segment is $\\left(\\dfrac 12\\right)^{\\frac12\\times 2}(2+3+3)=4$.\n\nWhen mastering knowledge $1$ and knowledge $2$, the sum of liking levels over each continuously mastered segment is $\\left(\\dfrac 12\\right)^{\\frac12\\times 1}(2+3)=\\dfrac {5\\sqrt2}2\\approx 3.536$.\n\nWhen mastering knowledge $1$ and knowledge $3$, the sum of liking levels over each continuously mastered segment is $\\left(\\dfrac 12\\right)^{\\frac12\\times 0}\\times 2 +\\left(\\dfrac 12\\right)^{\\frac12\\times 0}\\times 3  = 5$.\n\nWhen mastering knowledge $2$ and knowledge $3$, the sum of liking levels over each continuously mastered segment is $\\left(\\dfrac 12\\right)^{\\frac12\\times 1}(3+3)=3\\sqrt 2\\approx 4.243$.\n\nWhen only mastering knowledge $1$, the sum of liking levels over each continuously mastered segment is $\\left(\\dfrac 12\\right)^{\\frac12\\times 0}\\times 2  = 2$.\n\nWhen only mastering knowledge $2$, the sum of liking levels over each continuously mastered segment is $\\left(\\dfrac 12\\right)^{\\frac12\\times 0}\\times 3  = 3$.\n\nWhen only mastering “treasure” $3$, the sum of liking levels over each continuously mastered segment is $\\left(\\dfrac 12\\right)^{\\frac12\\times 0}\\times 3  = 3$.\n\nWhen mastering nothing, the sum of liking levels over each continuously mastered segment is $0$.\n\nThe probabilities of the above $8$ cases are all $\\dfrac 18$, so the answer is approximately:\n\n$$(4+3.536+5+4.243+2+3+3+0)\\times \\dfrac 18\\approx3.0973$$\n\n---\n\n**[Constraints]**\n\nFor $20\\%$ of the testdata, $n \\le 18$.  \nFor another $15\\%$ of the testdata, $w_i = 1$.  \nFor $55\\%$ of the testdata, $n \\le 10^3$.  \nFor another $15\\%$ of the testdata, $w_i = 1$.  \nFor another $15\\%$ of the testdata, $b_i \\le 0.2$.  \n\nIn addition, for $100\\%$ of the testdata, $0<n\\le10^5$, $0<a,b,p_i<1$, $0<w_i\\le10^3$. It is guaranteed that the input precision does not exceed $10^{-2}$.\n\n**This problem uses Special Judge. If, for some test point, the difference between your answer and the standard answer is less than or equal to $10^{-3}$, you can pass that test point.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Ryoku 爱学习", "background": "Ryoku 继承了 Riri 在学习方面的天赋，所以她非常热爱学习。但是，不管再怎么热爱学习，Ryoku 也会疲倦的。", "description": "Ryoku 在第 $i$ 时刻会了解到有一个新知识 $i$，这个新知识的实际价值为 $w_i$，由于 Ryoku 爱学习，所以她不会选择不学习知识，但她只有 $p_i$ 的概率能成功掌握这个知识。\n\n然而如果 Ryoku 同时掌握了太多知识，由于 Ryoku 内心的疲倦等因素，Ryoku 感受到的对知识的喜爱程度会改变，我们用一个数值 $R$ 来描述**喜爱程度**的大小。具体而言，设 $R=f(l,r)$ 代表 Ryoku **连续掌握**时刻 $l$ 至时刻 $r$ 的知识时对这些知识的喜爱程度的总和，有参数 $a, b$（$0 < a, b<1$），则有：\n\n$$ f(l,r)=a^{b(r-l)}  \\sum_{i=l}^r w_i$$\n\nRyoku 想要知道她期望能**掌握的每一段连续时刻的知识**的喜爱程度之和是多少（需要注意的是，这里所说的连续时刻的知识不能被一段更长的所包含）。你能帮帮她吗？\n", "inputFormat": "输入包含三行。  \n第一行包含一个整数 $n$，两个实数 $a,b$。  \n第二行包含 $n$ 个整数，为 $w_i$。  \n第三行包含 $n$ 个实数，为 $p_i$。", "outputFormat": "输出包含一行一个正实数，为答案。", "hint": "**【样例 1 说明】**\n\n掌握知识 $1$、知识 $2$、知识 $3$ 时，每一段连续掌握知识的喜爱程度之和为 $\\left(\\dfrac 12\\right)^{\\frac12\\times 2}(2+3+3)=4$。\n\n掌握知识 $1$、知识 $2$ 时，每一段连续掌握知识的喜爱程度之和为 $\\left(\\dfrac 12\\right)^{\\frac12\\times 1}(2+3)=\\dfrac {5\\sqrt2}2\\approx 3.536$。\n\n掌握知识 $1$、知识 $3$ 时，每一段连续掌握知识的喜爱程度之和为 $\\left(\\dfrac 12\\right)^{\\frac12\\times 0}\\times 2 +\\left(\\dfrac 12\\right)^{\\frac12\\times 0}\\times 3  = 5$。\n\n掌握知识 $2$、知识 $3$ 时，每一段连续掌握知识的喜爱程度之和为 $\\left(\\dfrac 12\\right)^{\\frac12\\times 1}(3+3)=3\\sqrt 2\\approx 4.243$。\n\n只掌握知识 $1$ 时，每一段连续掌握知识的喜爱程度之和为 $\\left(\\dfrac 12\\right)^{\\frac12\\times 0}\\times 2  = 2$。\n\n只掌握知识 $2$ 时，每一段连续掌握知识的喜爱程度之和为 $\\left(\\dfrac 12\\right)^{\\frac12\\times 0}\\times 3  = 3$。\n\n只掌握宝物 $3$ 时，每一段连续掌握知识的喜爱程度之和为 $\\left(\\dfrac 12\\right)^{\\frac12\\times 0}\\times 3  = 3$。\n\n什么都不掌握时，每一段连续掌握知识的喜爱程度之和为 $0$。\n\n以上 $8$ 种情况出现的概率均为 $\\dfrac 18$，所以答案约为：\n\n$$(4+3.536+5+4.243+2+3+3+0)\\times \\dfrac 18\\approx3.0973$$\n\n---\n\n**【数据规模与约定】**\n\n对于 $20\\%$ 的数据，$n \\le 18$。  \n对于另外 $15\\%$ 的数据，$w_i = 1$。  \n对于 $55\\%$ 的数据，$n \\le 10^3$。  \n对于另外 $15\\%$ 的数据，$w_i = 1$。  \n对于另外 $15\\%$ 的数据，$b_i \\le 0.2$。  \n\n此外，对于 $100\\%$ 的数据，$0<n\\le10^5$，$0<a,b,p_i<1$，$0<w_i\\le10^3$。保证输入数据的精度不超过 $10^{-2}$。\n\n**本题使用 Special Judge，如果某个测试点中你的答案与标准答案相差小于等于 $10^{-3}$，你就可以通过该测试点。**\n", "locale": "zh-CN"}}}
{"pid": "P6037", "type": "P", "difficulty": 4, "samples": [["5\n4 1 2 1\n1 2 3 2\n3 1 1 4\n3 5 2 5\n2 3 2 3\n", "7\n7\n8\n7\n8"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2020", "深度优先搜索 DFS", "基环树"], "title": "Ryoku 的探索", "background": "Ryoku 对自己所处的世界充满了好奇，她希望能够在她「死」之前尽可能能多地探索世界。\n\n这一天，Ryoku 得到了一张这个世界的地图，她十分高兴。然而，Ryoku 并不知道自己所处的位置到底在哪里，她也不知道她会什么时候死去。她想要知道如何才能尽可能多的探索这个世界。", "description": "Ryoku 所处的世界可以抽象成一个有 $n$ 个点， $n$ 条边的带权无向连通图 $G$。每条边有美观度和长度。\n\nRyoku 会使用这样一个策略探索世界：在每个点寻找一个**端点她未走过**的边中**美观度最高**的走，如果没有边走，就沿着她前往这个点的边返回，类似于图的**深度优先遍历**。\n\n探索的一个方案的长度是这个方案所经过的所有边长度的和（返回时经过的长度不用计算）。\n\n她想知道，对于每一个起点 $s=1,2,\\cdots,n$，她需要走过的长度是多少？\n\n", "inputFormat": "输入包含 $n + 1$  行，其中第一行包含一个整数 $n$。  \n接下来 $n$ 行每行包含四个整数 $u,v,w,p$，描述了一条连接 $u$ 和 $v$，长度为 $w$，美观度为 $p$ 的无向边。", "outputFormat": "输出包含 $n$ 行，每行一个整数，第 $i$ 行为 $s=i$ 时的答案。", "hint": "**【样例 1 说明】**\n\n以下为输入输出样例 1 中的图： （边上红色数组为 $p$，黑色为 $w$）\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rmk07281.png)\n\n若起点为 $1$，顺序为 $1\\to3\\to5\\to2\\to4$，长度之和为 $7$。  \n若起点为 $2$，顺序为 $2\\to3\\to5\\to1\\to4$，长度之和为 $7$。  \n若起点为 $3$，顺序为 $3\\to5\\to1\\to2\\to4$，长度之和为 $8$。  \n若起点为 $4$，顺序为 $4\\to1\\to3\\to5\\to2$，长度之和为 $7$。  \n若起点为 $5$，顺序为 $5\\to3\\to1\\to2\\to4$，长度之和为 $8$。  \n\n---\n\n**【数据规模与约定】**\n\n对于 $40\\%$ 的数据，$n\\le 10^3$。    \n对于 $100\\%$ 的数据，$3 \\le n \\le 10^6$，$1 \\le u,v,p \\le n$，$0\\le w\\le 10^9$，保证 $p$ 互不相同。", "locale": "zh-CN", "translations": {"en": {"title": "Ryoku’s Exploration.", "background": "Ryoku is very curious about the world she lives in. Before she “dies”, she hopes to explore as much of the world as possible.\n\nOne day, Ryoku got a map of this world and was very happy. However, Ryoku does not know where she is, and she also does not know when she will die. She wants to know how to explore as much of this world as possible.", "description": "Ryoku’s world can be modeled as a weighted, undirected, connected graph $G$ with $n$ vertices and $n$ edges. Each edge has a beauty value and a length.\n\nRyoku explores the world using the following strategy: at each vertex, among the edges whose **endpoint she has not visited yet**, she chooses the one with the **highest beauty value** to walk along. If there is no edge to take, she returns along the edge she used to reach this vertex, similar to a graph **depth-first traversal**.\n\nThe length of an exploration plan is the sum of the lengths of all edges that the plan walks through (the distance walked when returning does not need to be counted).\n\nShe wants to know, for every starting vertex $s=1,2,\\cdots,n$, what total length she needs to walk.", "inputFormat": "The input contains $n+1$ lines. The first line contains an integer $n$.  \nThe next $n$ lines each contain four integers $u,v,w,p$, describing an undirected edge connecting $u$ and $v$, with length $w$ and beauty value $p$.", "outputFormat": "Output $n$ lines, each containing one integer. The $i$-th line is the answer when $s=i$.", "hint": "**[Sample 1 Explanation]**\n\nThe following is the graph in Sample Input/Output 1 (the red numbers on edges are $p$, and the black numbers are $w$).\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rmk07281.png)\n\nIf the starting point is $1$, the order is $1\\to3\\to5\\to2\\to4$, and the sum of lengths is $7$.  \nIf the starting point is $2$, the order is $2\\to3\\to5\\to1\\to4$, and the sum of lengths is $7$.  \nIf the starting point is $3$, the order is $3\\to5\\to1\\to2\\to4$, and the sum of lengths is $8$.  \nIf the starting point is $4$, the order is $4\\to1\\to3\\to5\\to2$, and the sum of lengths is $7$.  \nIf the starting point is $5$, the order is $5\\to3\\to1\\to2\\to4$, and the sum of lengths is $8$.\n\n---\n\n**[Constraints]**\n\nFor $40\\%$ of the testdata, $n\\le 10^3$.  \nFor $100\\%$ of the testdata, $3 \\le n \\le 10^6$, $1 \\le u,v,p \\le n$, $0\\le w\\le 10^9$. It is guaranteed that all $p$ are distinct.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Ryoku 的探索", "background": "Ryoku 对自己所处的世界充满了好奇，她希望能够在她「死」之前尽可能能多地探索世界。\n\n这一天，Ryoku 得到了一张这个世界的地图，她十分高兴。然而，Ryoku 并不知道自己所处的位置到底在哪里，她也不知道她会什么时候死去。她想要知道如何才能尽可能多的探索这个世界。", "description": "Ryoku 所处的世界可以抽象成一个有 $n$ 个点， $n$ 条边的带权无向连通图 $G$。每条边有美观度和长度。\n\nRyoku 会使用这样一个策略探索世界：在每个点寻找一个**端点她未走过**的边中**美观度最高**的走，如果没有边走，就沿着她前往这个点的边返回，类似于图的**深度优先遍历**。\n\n探索的一个方案的长度是这个方案所经过的所有边长度的和（返回时经过的长度不用计算）。\n\n她想知道，对于每一个起点 $s=1,2,\\cdots,n$，她需要走过的长度是多少？\n\n", "inputFormat": "输入包含 $n + 1$  行，其中第一行包含一个整数 $n$。  \n接下来 $n$ 行每行包含四个整数 $u,v,w,p$，描述了一条连接 $u$ 和 $v$，长度为 $w$，美观度为 $p$ 的无向边。", "outputFormat": "输出包含 $n$ 行，每行一个整数，第 $i$ 行为 $s=i$ 时的答案。", "hint": "**【样例 1 说明】**\n\n以下为输入输出样例 1 中的图： （边上红色数组为 $p$，黑色为 $w$）\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rmk07281.png)\n\n若起点为 $1$，顺序为 $1\\to3\\to5\\to2\\to4$，长度之和为 $7$。  \n若起点为 $2$，顺序为 $2\\to3\\to5\\to1\\to4$，长度之和为 $7$。  \n若起点为 $3$，顺序为 $3\\to5\\to1\\to2\\to4$，长度之和为 $8$。  \n若起点为 $4$，顺序为 $4\\to1\\to3\\to5\\to2$，长度之和为 $7$。  \n若起点为 $5$，顺序为 $5\\to3\\to1\\to2\\to4$，长度之和为 $8$。  \n\n---\n\n**【数据规模与约定】**\n\n对于 $40\\%$ 的数据，$n\\le 10^3$。    \n对于 $100\\%$ 的数据，$3 \\le n \\le 10^6$，$1 \\le u,v,p \\le n$，$0\\le w\\le 10^9$，保证 $p$ 互不相同。", "locale": "zh-CN"}}}
{"pid": "P6038", "type": "P", "difficulty": 6, "samples": [["5 10\n5 9 6 4 2\n3 1\n3 4\n1 2\n1 5\n", "2"], ["7 5\n6 7 4 5 7 8 9\n1 2\n2 3\n2 4\n1 5\n5 6\n5 7\n", "16"], ["8 5\n4 3 2 5 6 7 6 2\n1 2\n1 5\n2 3\n2 4\n5 6\n5 7\n6 8\n", "16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2020", "线段树", "倍增", "二分", "O2优化", "ST 表"], "title": "「ACOI2020」惊吓路径", "background": "![T6](https://s2.ax1x.com/2020/01/12/lopZpq.png)\n\n3 年 E 班的同学们赢得了去南方的冲绳小岛的机会，在渚打败了鹰冈之后，他们受杀老师的邀请参加“试胆大会”。\n\n试胆大会在一个黑漆漆的洞窟里面进行。赤羽 業（Akabane Karma）现在和奧田 愛美站在洞窟的门口。突然，業想到了一个事情。。。", "description": "杀老师告诉过他们，洞窟可以近似地看成 $n$ 个点的外向树，因为地形原因，所以一个点到另一个点的边是有方向的，且边的方向都是同向的。这棵树的树根为入度为 $0$ 的点。每个点都有一个惊吓值，给出每个点的惊吓值 $a_i$。\n\n杀老师告诉他们，这个洞穴有很多惊吓路径。如果两个节点 $u,v$ 构成的路径是一条惊吓路径的话，满足以下条件：\n\n- $v$ 一定在 $u$ 的子树中。\n\n- $u, v$ 这条路径上的所有的点的惊吓值的或值 $\\geq k$。\n\n走过一条惊吓路径就会收到杀老师的惊喜大礼。杀老师已经提前准备好了惊喜大礼，但是業当然已经知道杀老师有一些下流的意图，更别说惊喜大礼的数量可能不够！杀老师已经承诺有多少条惊吓路径就有多少个惊喜大礼。業已经通过一些神奇的途径知道了杀老师准备的惊喜大礼的个数，现在他想知道有多少条惊吓路径，也就是杀老师最少需要准备惊喜大礼的个数。如果不够，他就会揭穿杀老师的意图。现在業当然想赚，好好捉弄一下杀老师。所以他~~作弊~~提前得到了杀老师的地图，想问这个图里面有多少条惊吓路径？", "inputFormat": "第一行两个整数 $n,k$。\n\n第二行 $n$ 个整数，表示每个点的惊吓值。\n\n接下来 $n-1$ 行，每行有两个整数 $u,v$ 表示节点 $u,v$ 之间有一条有向边，节点 $u$ 可以到达节点 $v$，**节点 $v$ 不可以到达节点 $u$**。\n\n\n\n", "outputFormat": "一行一个整数，表示这个洞穴的惊吓路径条数。", "hint": "#### 样例解释 #1\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/lqu4ejku.png)\n\n只有两条路径满足条件：\n\n1. $3\\to 1\\to 2$，这条路径的所有点的惊吓值的或值是 $6\\operatorname{or}5\\operatorname{or}9=15$。\n\n2. $1 \\to 2$，这条路径的所有点的惊吓值的或值是 $5\\operatorname{or}9=13$。\n\n------------\n#### 数据范围 \n**本题采用捆绑测试**。\n\n- Subtask 1（10 points）：$n \\leq 5 \\times 10^3$，$k \\leq 10^5$。    \n- Subtask 2（30 points）：对于任意一条边，$v=u+1$，$n \\leq 10^6$，$k,a_i \\leq 10^9$。     \n- Subtask 3（20 points）：$n \\leq 10^5$，$k,a_i \\leq 10^9$。    \n- Subtask 4（40 points）：$n \\leq 5 \\times 10^5$，$k,a_i \\leq 10^9$。\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^6$，$1 \\leq k,a_i \\leq 10^9$。\n\n------------\n#### 提示\n**第四个子任务中的测试点空间 256MB，其余子任务中的测试点空间 128MB。**", "locale": "zh-CN", "translations": {"en": {"title": "\"ACOI2020\" Scare Paths.", "background": "![T6](https://s2.ax1x.com/2020/01/12/lopZpq.png)\n\nThe students of Class E, Year 3 won a chance to go to the southern Okinawa island. After defeating Takaoka at Nagisa, they were invited by Koro-sensei to join a “courage test”.\n\nThe courage test takes place in a pitch-dark cave. Akabane Karma is now standing at the entrance of the cave with Okuda Manami. Suddenly, Karma thought of something...", "description": "Koro-sensei told them that the cave can be approximately seen as an out-tree with $n$ nodes. Due to the terrain, the edge from one node to another has a direction, and the directions of all edges are consistent. The root of this tree is the node with in-degree $0$. Each node has a scare value; the scare value of node $i$ is $a_i$.\n\nKoro-sensei told them that there are many scare paths in this cave. If the path formed by two nodes $u, v$ is a scare path, then it satisfies:\n\n- $v$ must be in the subtree of $u$.\n- The bitwise OR of the scare values of all nodes on the path from $u$ to $v$ is $\\geq k$.\n\nWalking through a scare path will earn a “surprise gift” from Koro-sensei. Koro-sensei has prepared the gifts in advance, but Karma already knows Koro-sensei has some improper intentions, not to mention the number of gifts might not be enough. Koro-sensei promised that there would be as many surprise gifts as there are scare paths. Karma has learned, through some mysterious means, how many surprise gifts Koro-sensei prepared. Now he wants to know how many scare paths there are, i.e., the minimum number of gifts Koro-sensei must prepare. If it is not enough, he will expose Koro-sensei’s intentions. Of course, Karma wants to take advantage of this and mess with Koro-sensei. So he ~~cheated~~ got Koro-sensei’s map in advance, and wants to ask: how many scare paths are there in this graph?", "inputFormat": "The first line contains two integers $n, k$.\n\nThe second line contains $n$ integers, representing the scare value of each node.\n\nThe next $n - 1$ lines each contain two integers $u, v$, indicating that there is a directed edge between nodes $u$ and $v$, and node $u$ can reach node $v$. **Node $v$ cannot reach node $u$.**", "outputFormat": "Output one integer in one line, representing the number of scare paths in this cave.", "hint": "#### Sample Explanation #1\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/lqu4ejku.png)\n\nOnly two paths satisfy the conditions:\n\n1. $3 \\to 1 \\to 2$. The bitwise OR of the scare values of all nodes on this path is $6\\operatorname{or}5\\operatorname{or}9=15$.\n2. $1 \\to 2$. The bitwise OR of the scare values of all nodes on this path is $5\\operatorname{or}9=13$.\n\n------------\n#### Constraints\n\n**This problem uses bundled testdata.**\n\n- Subtask 1 (10 points): $n \\leq 5 \\times 10^3$, $k \\leq 10^5$.  \n- Subtask 2 (30 points): For any edge, $v = u + 1$, $n \\leq 10^6$, $k, a_i \\leq 10^9$.  \n- Subtask 3 (20 points): $n \\leq 10^5$, $k, a_i \\leq 10^9$.  \n- Subtask 4 (40 points): $n \\leq 5 \\times 10^5$, $k, a_i \\leq 10^9$.\n\nFor $100\\%$ of the testdata: $1 \\leq n \\leq 10^6$, $1 \\leq k, a_i \\leq 10^9$.\n\n------------\n#### Note\n\n**In the fourth subtask, the memory limit is 256MB; in the other subtasks, the memory limit is 128MB.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「ACOI2020」惊吓路径", "background": "![T6](https://s2.ax1x.com/2020/01/12/lopZpq.png)\n\n3 年 E 班的同学们赢得了去南方的冲绳小岛的机会，在渚打败了鹰冈之后，他们受杀老师的邀请参加“试胆大会”。\n\n试胆大会在一个黑漆漆的洞窟里面进行。赤羽 業（Akabane Karma）现在和奧田 愛美站在洞窟的门口。突然，業想到了一个事情。。。", "description": "杀老师告诉过他们，洞窟可以近似地看成 $n$ 个点的外向树，因为地形原因，所以一个点到另一个点的边是有方向的，且边的方向都是同向的。这棵树的树根为入度为 $0$ 的点。每个点都有一个惊吓值，给出每个点的惊吓值 $a_i$。\n\n杀老师告诉他们，这个洞穴有很多惊吓路径。如果两个节点 $u,v$ 构成的路径是一条惊吓路径的话，满足以下条件：\n\n- $v$ 一定在 $u$ 的子树中。\n\n- $u, v$ 这条路径上的所有的点的惊吓值的或值 $\\geq k$。\n\n走过一条惊吓路径就会收到杀老师的惊喜大礼。杀老师已经提前准备好了惊喜大礼，但是業当然已经知道杀老师有一些下流的意图，更别说惊喜大礼的数量可能不够！杀老师已经承诺有多少条惊吓路径就有多少个惊喜大礼。業已经通过一些神奇的途径知道了杀老师准备的惊喜大礼的个数，现在他想知道有多少条惊吓路径，也就是杀老师最少需要准备惊喜大礼的个数。如果不够，他就会揭穿杀老师的意图。现在業当然想赚，好好捉弄一下杀老师。所以他~~作弊~~提前得到了杀老师的地图，想问这个图里面有多少条惊吓路径？", "inputFormat": "第一行两个整数 $n,k$。\n\n第二行 $n$ 个整数，表示每个点的惊吓值。\n\n接下来 $n-1$ 行，每行有两个整数 $u,v$ 表示节点 $u,v$ 之间有一条有向边，节点 $u$ 可以到达节点 $v$，**节点 $v$ 不可以到达节点 $u$**。\n\n\n\n", "outputFormat": "一行一个整数，表示这个洞穴的惊吓路径条数。", "hint": "#### 样例解释 #1\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/lqu4ejku.png)\n\n只有两条路径满足条件：\n\n1. $3\\to 1\\to 2$，这条路径的所有点的惊吓值的或值是 $6\\operatorname{or}5\\operatorname{or}9=15$。\n\n2. $1 \\to 2$，这条路径的所有点的惊吓值的或值是 $5\\operatorname{or}9=13$。\n\n------------\n#### 数据范围 \n**本题采用捆绑测试**。\n\n- Subtask 1（10 points）：$n \\leq 5 \\times 10^3$，$k \\leq 10^5$。    \n- Subtask 2（30 points）：对于任意一条边，$v=u+1$，$n \\leq 10^6$，$k,a_i \\leq 10^9$。     \n- Subtask 3（20 points）：$n \\leq 10^5$，$k,a_i \\leq 10^9$。    \n- Subtask 4（40 points）：$n \\leq 5 \\times 10^5$，$k,a_i \\leq 10^9$。\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^6$，$1 \\leq k,a_i \\leq 10^9$。\n\n------------\n#### 提示\n**第四个子任务中的测试点空间 256MB，其余子任务中的测试点空间 128MB。**", "locale": "zh-CN"}}}
{"pid": "P6039", "type": "P", "difficulty": 2, "samples": [["11 0\n5\n", "1.000000\nError"], ["6 8\n4\n", "2.000000\n0.75"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "2020", "Special Judge"], "title": "「ACOI2020」音速", "background": "![T1](https://s2.ax1x.com/2020/01/12/loSQJI.png)\n\n防卫省的 乌间 惟臣（Tadaomi Karasuma）老师来到了椚丘中學给予了三年 E 班的同学们重大的任务：在一年内暗杀掉一个超生物（被 茅野 カエデ 取名为杀老师）。于是同学们开始努力地训练。但是很快的，杀老师展现了它的本领，可以以 20 马赫的超高速持久飞行，导致同学们根本碰不到杀老师。于是他们准备找乌间购买一个传送器。", "description": "现在同学们在后山埋伏。同学们对后山足够熟悉，并且后山足够宽广，可以看做一个无限大的平面直角坐标系，而同学们在 $(0,0)$ 这个位置。这时候杀老师在 $(x,y)$ 这个位置捡到了 岡島 大河 所放置的小黄书认真地读了起来。同学们现在可以以自己为圆心，$r$ 为半径画一个圆然后把传送器抛出去，落在圆上一点 $S$，传送器可以在落点处作一条与刚才的圆相切的直线 $PQ$，现在这条直线就是我们的传送器了。\n\n传送器的作用是：把同学们传送到他们所站的点关于 $PQ$ 的对称点。而且他们必须要**传送后移动**到杀老师的位置才能攻击它。现在，乌间看了他们的计划之后十分感叹，但是他有两个问题想问同学：\n\n- 他们用了传送器之后，至少需要移动多远？\n\n- 在保证移动距离最短的方案下，$PQ$ 与 $x$ 轴夹角的 $\\tan$ 值为多少？我们认为夹角在 $[0,180]$ ° 。", "inputFormat": "第一行两个实数 $x,y$，表示杀老师和小黄书的位置，自动抹去无意义的 $0$；   \n第二行一个实数 $r$，意义见题目描述。", "outputFormat": "第一行请输出他们用了传送器之后，至少需要移动的距离，**保留六位小数**。\n     \n第二行请在保证移动距离最短的方案下输出 $PQ$ 与 $x$ 轴夹角的 $\\tan$ 值，**保留二位小数**。  \n\n特殊地，当 $\\tan$ 值无意义的时候，输出 ```Error```；否则，如果有多个角度都可以满足条件，输出 $\\tan$ 值最小的一个，可以把 ```Error``` 视作无穷大。\n\n**注意，$\\tan$ 值为负数的时候，将这个 $\\tan$ 值视作无穷大。夹角指的是那个锐角。**", "hint": "#### 数据范围 \n\n**本题采用捆绑测试**。\n\n- Subtask 1（10 points）：$x,y,r$ 满足 $x^2+y^2=r^2$。     \n- Subtask 2（20 points）：$x,y$ 中至少有一个为 $0$。     \n- Subtask 3（70 points）：数据无特殊限制。    \n\n对于 $100\\%$ 的数据， $0 \\leq |x|,|y|,r \\leq 10^{10}$。\n\n---\n####  提示\n\n1. **本题含有 SPJ**，如果第一个问题的答案与标准答案差的绝对值不大于 $10^{-6}$ 时就能获得该测试点的分数的 $50\\%$。当第一个问题的答案正确时：      \n- 若第二个问题的答案不为 ```Error``` 时，当输出答案与标准答案差的绝对值不大于 $10^{-2}$ 时能得到该测试点的所有分数；\n- 当第二个问题的答案为 ```Error``` 时，只有输出 ```Error``` 才能得到该测试点的所有分数。  \n**因为 SPJ 敏感，如果只能回答第一个问题，也请在第二行随意输出一些值，不要输出 `Error`**。\n\n2. $\\tan$ 值表示在一个 **直角三角形** 中，一个角相对的直角边与其相邻的直角边的比值，比如 $\\tan\\ 45°= 1$。特殊地，$90°$ 的 $\\tan$ 值**无意义**。\n\n3. 和圆只有一个公共交点的直线叫做圆的**切线**，连接切点与圆心的半径**垂直**于切线。", "locale": "zh-CN", "translations": {"en": {"title": "\"ACOI2020\" Speed of Sound.", "background": "![T1](https://s2.ax1x.com/2020/01/12/loSQJI.png)\n\nTeacher Tadaomi Karasuma from the Ministry of Defense came to Kunugigaoka Junior High School and gave the students of Class 3-E an important mission: assassinate a super creature (named Koro-sensei by Kaede Kayano) within one year. So the students began training hard. But soon, Koro-sensei showed his ability: he can fly continuously at an ultra-high speed of 20 Mach, so the students could not even touch him. Therefore, they decided to buy a teleporter from Karasuma.", "description": "Now the students are ambushing in the back mountain. They are very familiar with the terrain, and the back mountain is wide enough to be regarded as an infinite 2D Cartesian coordinate plane. The students are at $(0,0)$. At this moment, Koro-sensei is at $(x,y)$, seriously reading a “little yellow book” left by Taiga Okajima. The students can draw a circle centered at themselves with radius $r$, then throw the teleporter so that it lands at a point $S$ on the circle. At the landing point, the teleporter can create a line $PQ$ tangent to that circle. Now this line is the teleporter.\n\nThe teleporter works as follows: it teleports the students to the point symmetric to where they stand with respect to $PQ$. Also, they must **move after teleporting** to reach Koro-sensei’s position to attack him. After seeing their plan, Karasuma was very impressed, but he has two questions for the students:\n\n- After using the teleporter, what is the minimum distance they need to move?\n\n- Under the plan that guarantees the minimum movement distance, what is the value of $\\tan$ of the angle between $PQ$ and the $x$-axis? We consider the angle to be in $[0,180]^\\circ$.", "inputFormat": "The first line contains two real numbers $x,y$, indicating the positions of Koro-sensei and the little yellow book, with meaningless trailing $0$ automatically removed.  \nThe second line contains one real number $r$, with the meaning described above.", "outputFormat": "On the first line, output the minimum distance they need to move after using the teleporter, **rounded to 6 decimal places**.  \n\nOn the second line, under the plan that guarantees the minimum movement distance, output the value of $\\tan$ of the angle between $PQ$ and the $x$-axis, **rounded to 2 decimal places**.\n\nIn particular, when the $\\tan$ value is undefined, output ```Error```. Otherwise, if multiple angles can satisfy the condition, output the smallest $\\tan$ value. You may treat ```Error``` as $+\\infty$.\n\n**Note: when $\\tan$ is negative, treat this $\\tan$ value as $+\\infty$. The angle refers to the acute angle.**", "hint": "#### Constraints\n\n**This problem uses bundled testdata**.\n\n- Subtask 1 (10 points): $x,y,r$ satisfy $x^2+y^2=r^2$.  \n- Subtask 2 (20 points): at least one of $x,y$ is $0$.  \n- Subtask 3 (70 points): no special constraints on the data.\n\nFor $100\\%$ of the data, $0 \\leq |x|,|y|,r \\leq 10^{10}$.\n\n---\n#### Hint\n\n1. **This problem includes an SPJ**. If the absolute difference between the answer to the first question and the standard answer is at most $10^{-6}$, you can get $50\\%$ of the score for that test point. When the answer to the first question is correct:  \n- If the answer to the second question is not ```Error```, you can get full score for that test point when the absolute difference between your output and the standard answer is at most $10^{-2}$.  \n- If the answer to the second question is ```Error```, only outputting ```Error``` can get full score for that test point.  \n**Because the SPJ is sensitive, if you can only answer the first question, please output any value on the second line, and do not output `Error`.**\n\n2. The $\\tan$ value means: in a **right triangle**, the ratio of the length of the leg opposite an angle to the length of the leg adjacent to it. For example, $\\tan\\ 45^\\circ = 1$. In particular, $\\tan$ at $90^\\circ$ is **undefined**.\n\n3. A line that has exactly one common intersection point with a circle is called a **tangent line** of the circle. The radius connecting the tangency point and the circle center is **perpendicular** to the tangent line.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「ACOI2020」音速", "background": "![T1](https://s2.ax1x.com/2020/01/12/loSQJI.png)\n\n防卫省的 乌间 惟臣（Tadaomi Karasuma）老师来到了椚丘中學给予了三年 E 班的同学们重大的任务：在一年内暗杀掉一个超生物（被 茅野 カエデ 取名为杀老师）。于是同学们开始努力地训练。但是很快的，杀老师展现了它的本领，可以以 20 马赫的超高速持久飞行，导致同学们根本碰不到杀老师。于是他们准备找乌间购买一个传送器。", "description": "现在同学们在后山埋伏。同学们对后山足够熟悉，并且后山足够宽广，可以看做一个无限大的平面直角坐标系，而同学们在 $(0,0)$ 这个位置。这时候杀老师在 $(x,y)$ 这个位置捡到了 岡島 大河 所放置的小黄书认真地读了起来。同学们现在可以以自己为圆心，$r$ 为半径画一个圆然后把传送器抛出去，落在圆上一点 $S$，传送器可以在落点处作一条与刚才的圆相切的直线 $PQ$，现在这条直线就是我们的传送器了。\n\n传送器的作用是：把同学们传送到他们所站的点关于 $PQ$ 的对称点。而且他们必须要**传送后移动**到杀老师的位置才能攻击它。现在，乌间看了他们的计划之后十分感叹，但是他有两个问题想问同学：\n\n- 他们用了传送器之后，至少需要移动多远？\n\n- 在保证移动距离最短的方案下，$PQ$ 与 $x$ 轴夹角的 $\\tan$ 值为多少？我们认为夹角在 $[0,180]$ ° 。", "inputFormat": "第一行两个实数 $x,y$，表示杀老师和小黄书的位置，自动抹去无意义的 $0$；   \n第二行一个实数 $r$，意义见题目描述。", "outputFormat": "第一行请输出他们用了传送器之后，至少需要移动的距离，**保留六位小数**。\n     \n第二行请在保证移动距离最短的方案下输出 $PQ$ 与 $x$ 轴夹角的 $\\tan$ 值，**保留二位小数**。  \n\n特殊地，当 $\\tan$ 值无意义的时候，输出 ```Error```；否则，如果有多个角度都可以满足条件，输出 $\\tan$ 值最小的一个，可以把 ```Error``` 视作无穷大。\n\n**注意，$\\tan$ 值为负数的时候，将这个 $\\tan$ 值视作无穷大。夹角指的是那个锐角。**", "hint": "#### 数据范围 \n\n**本题采用捆绑测试**。\n\n- Subtask 1（10 points）：$x,y,r$ 满足 $x^2+y^2=r^2$。     \n- Subtask 2（20 points）：$x,y$ 中至少有一个为 $0$。     \n- Subtask 3（70 points）：数据无特殊限制。    \n\n对于 $100\\%$ 的数据， $0 \\leq |x|,|y|,r \\leq 10^{10}$。\n\n---\n####  提示\n\n1. **本题含有 SPJ**，如果第一个问题的答案与标准答案差的绝对值不大于 $10^{-6}$ 时就能获得该测试点的分数的 $50\\%$。当第一个问题的答案正确时：      \n- 若第二个问题的答案不为 ```Error``` 时，当输出答案与标准答案差的绝对值不大于 $10^{-2}$ 时能得到该测试点的所有分数；\n- 当第二个问题的答案为 ```Error``` 时，只有输出 ```Error``` 才能得到该测试点的所有分数。  \n**因为 SPJ 敏感，如果只能回答第一个问题，也请在第二行随意输出一些值，不要输出 `Error`**。\n\n2. $\\tan$ 值表示在一个 **直角三角形** 中，一个角相对的直角边与其相邻的直角边的比值，比如 $\\tan\\ 45°= 1$。特殊地，$90°$ 的 $\\tan$ 值**无意义**。\n\n3. 和圆只有一个公共交点的直线叫做圆的**切线**，连接切点与圆心的半径**垂直**于切线。", "locale": "zh-CN"}}}
{"pid": "P6040", "type": "P", "difficulty": 4, "samples": [["5 3 4 1 0\n1 2 3 4 5\n", "27"], ["10 30630 56910 2 0\n7484 99194 86969 17540 29184 68691 91892 81564 93999 74280 \n", "717318"], ["10000000 899999999 923456655 213111 1\n1314520", "9231813656566921"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "2020", "单调队列", "O2优化", "动态规划优化"], "title": "「ACOI2020」课后期末考试滑溜滑溜补习班", "background": "![T2](https://s2.ax1x.com/2020/01/12/lopS6f.png)\n\n潮田 渚（Shiota Nagisa）因为理科不大好，自然会被仔细观察学生的杀老师发现，于是渚同学只得加入杀老师举办的课后期末考试滑溜滑溜补习班。至于为什么叫这个名字，额，你不能问我啊。", "description": "在补习班上，因为多个学生会同时有需求，所以杀老师会制造分身用音速移动来回回答问题。\n\n补习班上有 $n$ 个同学，他们每一个人都有一个问题。杀老师为了有序回答学生的问题，把所有学生排成了一列。第 $i$ 个学生的问题有一个困难值 $a_i$，杀老师回答第 $i$ 个学生的问题需要花费 $a_i$ 的精力。杀老师到了哪里，它就要解决那个学生的问题。杀老师最开始会解决序列中第一个同学的问题，他最后会去解决最后一个同学的问题。\n\n杀老师每次解决完一个同学的问题到下一个同学的座位上就要花费 $k$ 点精力值。特殊的，如果杀老师想让自己轻松一点，可以不移动到下一个，可以直接到下两个，下三个，就不用解决跳过的同学的问题了。对应的，它会被学生调侃。受到打击的杀老师自然会花费格外的精力，花费的精力为 $k+(q-p-1) \\times d$（当前位置为 $p$，跳到的位置为 $q$）。\n\n当然的，杀老师也是有速度的啊，并且它想解决学生的一些问题，所以说杀老师最多只会跳过 $x-1$ 个学生，去解决下 $x$ 个学生的问题。", "inputFormat": "第一行五个整数 $n,k,d,x,tp$，表示有 $n$ 个学生，只按顺序去到下一个学生的座位需要花费 $k$ 点精力，每多跳过一个学生就要多花费 $d$ 点精力值，每一次最多只能跳过 $x-1$ 个学生，是否是特殊数据。\n\n- $tp=0$，第二行 $n$ 个整数 $a_{1\\dots n}$，$a_i$ 表示第 $i$ 个学生的问题的困难值为 $a_i$。\n\n- $tp=1$，第二行一个整数 $Seed$，作为种子，然后调用 $rnd$ 函数**依次**生成 $n$ 个整数，作为 $a$ 数组，$a_i$ 表示第 $i$ 个学生的问题的困难值为 $a_i$。\n\n```cpp\ninline int rnd () {\n\tstatic const int MOD = 1e9;\n\treturn Seed = ( 1LL * Seed * 0x66CCFF % MOD + 20120712 ) % MOD;\n}\n```", "outputFormat": "一行一个整数，表示杀老师解决完最后一个同学的问题最少需要花费多少精力。", "hint": "#### 样例解释 #1\n\n杀老师每次不能跳过学生，因此他必须依次移动并解决所有问题，故答案为解决问题所需的精力 $1+2+3+4+5=15$ 与移动所需的精力 $4 \\times 3=12$，所以花费精力之和为 $27$。\n\n------------\n#### 数据范围\n\n**本题采用捆绑测试**。\n\n- Subtask 1（20 points），学生们学习认真听话，留下来的同学也会更少：$tp=0$，$n \\leq 10^3$。     \n- Subtask 2（30 points），杀老师的速度快极了，并且学生们没时间吐槽它：$tp=0$，$n \\leq 10^6$。     \n- Subtask 3（50 points），$tp=1$，其余无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^7$，$0 \\leq k,d,a_i \\leq 10^9$，$1 \\leq x \\leq n-1$。\n\n------------\n#### 提示\n\n对于 $tp=1$ 的数据，$rnd$ 函数只用于减小输入量，标准算法不依赖该数据生成方式。", "locale": "zh-CN", "translations": {"en": {"title": "\"ACOI2020\" After-class Final Exam Slippery Slippery Tutoring Class", "background": "![T2](https://s2.ax1x.com/2020/01/12/lopS6f.png)\n\nShiota Nagisa (潮田 渚) is not very good at science subjects, so Koro-sensei (杀老师), who carefully observes students, would naturally notice. Therefore, Nagisa has to join the after-class final exam Slippery Slippery Tutoring Class held by Koro-sensei. As for why it has this name, well, you cannot ask me.", "description": "In the tutoring class, because multiple students may have needs at the same time, Koro-sensei will create clones and move back and forth at the speed of sound to answer questions.\n\nThere are $n$ students in the class, and each of them has one question. In order to answer students' questions in an orderly way, Koro-sensei lines up all students into a single row. The question of the $i$-th student has a difficulty value $a_i$, and answering the $i$-th student's question costs Koro-sensei $a_i$ energy. Wherever Koro-sensei goes, it must solve that student's question. Koro-sensei will start by solving the first student's question in the sequence, and it will finally go to solve the last student's question.\n\nEach time after solving one student's question and moving to the next student's seat, Koro-sensei needs to spend $k$ energy. Specially, if Koro-sensei wants to make things easier, it can choose not to move to the next one, but jump directly to the second next, the third next, and so on, so it does not need to solve the questions of the skipped students. Correspondingly, it will be teased by the students. Feeling upset, Koro-sensei will naturally spend extra energy, and the energy cost is $k+(q-p-1) \\times d$ (the current position is $p$, and it jumps to position $q$).\n\nOf course, Koro-sensei also has speed, and it still wants to solve some students' questions. Therefore, Koro-sensei will skip at most $x-1$ students at a time, i.e. it will go on to solve the question of the next $x$-th student.", "inputFormat": "The first line contains five integers $n,k,d,x,tp$, meaning there are $n$ students; moving only in order to the next student's seat costs $k$ energy; for each additional skipped student, it costs an extra $d$ energy; each move can skip at most $x-1$ students; and whether this is special testdata.\n\n- If $tp=0$, the second line contains $n$ integers $a_{1\\dots n}$, where $a_i$ is the difficulty value of the $i$-th student's question.\n\n- If $tp=1$, the second line contains one integer $Seed$ as the seed, and then call the $rnd$ function to generate $n$ integers **in order** as the array $a$, where $a_i$ is the difficulty value of the $i$-th student's question.\n\n```cpp\ninline int rnd () {\n\tstatic const int MOD = 1e9;\n\treturn Seed = ( 1LL * Seed * 0x66CCFF % MOD + 20120712 ) % MOD;\n}\n```", "outputFormat": "One line with one integer, meaning the minimum total energy Koro-sensei needs to spend to finish solving the last student's question.", "hint": "#### Sample Explanation #1\n\nKoro-sensei cannot skip students each time, so it must move in order and solve all questions. Therefore, the answer is the energy needed to solve the questions $1+2+3+4+5=15$ plus the energy needed for moving $4 \\times 3=12$, so the total energy cost is $27$.\n\n------------\n\n#### Constraints\n\n**This problem uses bundled testdata.**\n\n- Subtask 1 (20 points): the students study seriously and behave well, so fewer students will remain: $tp=0$, $n \\leq 10^3$.  \n- Subtask 2 (30 points): Koro-sensei is extremely fast, and the students have no time to tease it: $tp=0$, $n \\leq 10^6$.  \n- Subtask 3 (50 points): $tp=1$, with no other special constraints.\n\nFor $100\\%$ of the testdata, $1 \\leq n \\leq 10^7$, $0 \\leq k,d,a_i \\leq 10^9$, $1 \\leq x \\leq n-1$.\n\n------------\n\n#### Hint\n\nFor $tp=1$ testdata, the $rnd$ function is only used to reduce input size. The standard algorithm does not depend on this generation method.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「ACOI2020」课后期末考试滑溜滑溜补习班", "background": "![T2](https://s2.ax1x.com/2020/01/12/lopS6f.png)\n\n潮田 渚（Shiota Nagisa）因为理科不大好，自然会被仔细观察学生的杀老师发现，于是渚同学只得加入杀老师举办的课后期末考试滑溜滑溜补习班。至于为什么叫这个名字，额，你不能问我啊。", "description": "在补习班上，因为多个学生会同时有需求，所以杀老师会制造分身用音速移动来回回答问题。\n\n补习班上有 $n$ 个同学，他们每一个人都有一个问题。杀老师为了有序回答学生的问题，把所有学生排成了一列。第 $i$ 个学生的问题有一个困难值 $a_i$，杀老师回答第 $i$ 个学生的问题需要花费 $a_i$ 的精力。杀老师到了哪里，它就要解决那个学生的问题。杀老师最开始会解决序列中第一个同学的问题，他最后会去解决最后一个同学的问题。\n\n杀老师每次解决完一个同学的问题到下一个同学的座位上就要花费 $k$ 点精力值。特殊的，如果杀老师想让自己轻松一点，可以不移动到下一个，可以直接到下两个，下三个，就不用解决跳过的同学的问题了。对应的，它会被学生调侃。受到打击的杀老师自然会花费格外的精力，花费的精力为 $k+(q-p-1) \\times d$（当前位置为 $p$，跳到的位置为 $q$）。\n\n当然的，杀老师也是有速度的啊，并且它想解决学生的一些问题，所以说杀老师最多只会跳过 $x-1$ 个学生，去解决下 $x$ 个学生的问题。", "inputFormat": "第一行五个整数 $n,k,d,x,tp$，表示有 $n$ 个学生，只按顺序去到下一个学生的座位需要花费 $k$ 点精力，每多跳过一个学生就要多花费 $d$ 点精力值，每一次最多只能跳过 $x-1$ 个学生，是否是特殊数据。\n\n- $tp=0$，第二行 $n$ 个整数 $a_{1\\dots n}$，$a_i$ 表示第 $i$ 个学生的问题的困难值为 $a_i$。\n\n- $tp=1$，第二行一个整数 $Seed$，作为种子，然后调用 $rnd$ 函数**依次**生成 $n$ 个整数，作为 $a$ 数组，$a_i$ 表示第 $i$ 个学生的问题的困难值为 $a_i$。\n\n```cpp\ninline int rnd () {\n\tstatic const int MOD = 1e9;\n\treturn Seed = ( 1LL * Seed * 0x66CCFF % MOD + 20120712 ) % MOD;\n}\n```", "outputFormat": "一行一个整数，表示杀老师解决完最后一个同学的问题最少需要花费多少精力。", "hint": "#### 样例解释 #1\n\n杀老师每次不能跳过学生，因此他必须依次移动并解决所有问题，故答案为解决问题所需的精力 $1+2+3+4+5=15$ 与移动所需的精力 $4 \\times 3=12$，所以花费精力之和为 $27$。\n\n------------\n#### 数据范围\n\n**本题采用捆绑测试**。\n\n- Subtask 1（20 points），学生们学习认真听话，留下来的同学也会更少：$tp=0$，$n \\leq 10^3$。     \n- Subtask 2（30 points），杀老师的速度快极了，并且学生们没时间吐槽它：$tp=0$，$n \\leq 10^6$。     \n- Subtask 3（50 points），$tp=1$，其余无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^7$，$0 \\leq k,d,a_i \\leq 10^9$，$1 \\leq x \\leq n-1$。\n\n------------\n#### 提示\n\n对于 $tp=1$ 的数据，$rnd$ 函数只用于减小输入量，标准算法不依赖该数据生成方式。", "locale": "zh-CN"}}}
{"pid": "P6041", "type": "P", "difficulty": 5, "samples": [["3 1\n1 1 1\n1 2 3\n1 1\n2 1\n", "5"], ["5 3\n1 2 2 1 1\n1 5 2 4 2\n1 1 2 3\n3 1\n4 2\n5 1\n", "0\n6\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2020", "线段树", "倍增", "二分", "树上启发式合并", "树链剖分", "可持久化线段树"], "title": "「ACOI2020」布丁暗杀计划", "background": "![T3](https://s2.ax1x.com/2020/01/12/lopanO.png)\n\n茅野 カエデ（Kayano Kaede）制定了一个用布丁暗杀杀老师的计划。他们用剩余的鸡蛋加工制成一个布丁。为了外观和味道，他们会在里面加上一些用糯米纸包着的改变口味的食材。为了好看，这些食材从上至下排成了树的模样。在布丁的最底下铺满了对老师炸弹。杀老师吃到那里去之后就会引爆。", "description": "终于，同学们把布丁做好了。最爱吃布丁的茅野开始想，这个布丁有多好吃呢？\n\n一个布丁的好吃程度，取决于里面的改变口味的食材。材料不同的话，颜色和美味度也是不一样的。\n\n布丁里面有 $n$ 种调味食材，有 $n-1$ 个东西连接着，第一种食材在最上面，相当于这一棵树的根。\n\n现在，茅野制定一个布丁的好吃程度与指定的某两个值 $u,k$ 有关，这个好吃程度为，第 $u$ 种食材的 $k$ 级祖先 $v$ 食材的所有 $k$ 级儿子与 $v$ 食材颜色相同的那些 $k$ 级儿子的美味度之和。可以发现，$u$ 或者 $k$ 不同，一般情况下美味度是不同的。所以有 $q$ 个问题想要问你。\n\n**特殊地，如果第 $u$ 种食材没有 $k$ 级祖先，直接输出 $0$ 即可。**", "inputFormat": "第一行两个整数 $n,q$，表示有 $n$ 个食材，$q$ 个询问。\n\n第二行 $n$ 个整数，第 $i$ 个整数表示食材 $i$ 的颜色 $color_i$。\n\n第三行 $n$ 个整数，第 $i$ 个整数表示食材 $i$ 的美味值 $d_i$。\n\n第四行 $n-1$ 个整数，第 $i$ 个整数表示食材 $i+1$ 的父节点 $fa_i$。\n\n接下来 $q$ 行，每行两个整数 $u,k$ 表示询问。", "outputFormat": "有 $q$ 行，每行一个整数，表示询问的结果。", "hint": "#### 样例解释 #1\n![](https://cdn.luogu.com.cn/upload/image_hosting/ap9imym3.png)\n\n食材 $2$ 的 $1$ 级祖先是食材 $1$，食材 $1$ 的 $1$ 级儿子有食材 $2$ 与食材 $3$，食材 $2$ 与食材 $3$ 的颜色都与食材 $1$ 的颜色相同，所以美味度之和为 $2+3=5$。\n\n------------\n#### 数据范围\n**本题采用捆绑测试**。\n\n- Subtask 1（30 points），鸡蛋缺乏，布丁不大：$n \\leq 10^3$，$q \\leq 10^4$。\n- Subtask 2（20 points），食材构成了一条链：$n \\leq 5 \\times 10^5$，$q \\leq 10^5$，$color_i \\leq 10^2$。     \n- Subtask 3（50 points）：数据无特殊限制。 \n\n\n对于 $100\\%$ 的数据，$1 \\leq n,q,color_i \\leq 5 \\times 10^5$，$1 \\leq d_i \\leq 10^5$。\n\n------------\n#### 提示\n\n**第二个子任务中的测试点与第三个子任务中的测试点时限 2S。**", "locale": "zh-CN", "translations": {"en": {"title": "\"ACOI2020\" Pudding Assassination Plan", "background": "![T3](https://s2.ax1x.com/2020/01/12/lopanO.png)\n\nKayano Kaede (茅野 カエデ) made a plan to assassinate Koro-sensei using pudding. They used the remaining eggs to make a pudding. For appearance and taste, they add some ingredients wrapped in rice paper to change the flavor. For better looks, these ingredients are arranged from top to bottom in the shape of a tree. At the very bottom of the pudding, it is filled with bombs for Koro-sensei. When Koro-sensei eats to that part, it will explode.", "description": "Finally, the students finished the pudding. Kaede, who loves pudding the most, started thinking: how tasty is this pudding?\n\nHow tasty a pudding is depends on the flavor-changing ingredients inside. Different ingredients have different colors and tastiness values.\n\nThere are $n$ kinds of flavoring ingredients in the pudding, connected by $n-1$ links. The first ingredient is at the top, which is the root of this tree.\n\nNow, Kaede defines that the tastiness of the pudding depends on two given values $u, k$. This tastiness is defined as follows: let $v$ be the $k$-th ancestor of ingredient $u$. Consider all $k$-th level children of ingredient $v$, and among them, take those $k$-th level children whose color is the same as the color of ingredient $v$. The answer is the sum of the tastiness values of these selected nodes. It can be seen that when $u$ or $k$ changes, in general the tastiness value also changes. Therefore, there are $q$ queries to ask you.\n\n**In particular, if ingredient $u$ does not have a $k$-th ancestor, output $0$ directly.**", "inputFormat": "The first line contains two integers $n, q$, meaning there are $n$ ingredients and $q$ queries.\n\nThe second line contains $n$ integers. The $i$-th integer represents the color of ingredient $i$, $color_i$.\n\nThe third line contains $n$ integers. The $i$-th integer represents the tastiness value of ingredient $i$, $d_i$.\n\nThe fourth line contains $n-1$ integers. The $i$-th integer represents the parent node of the ingredient $i+1$, $fa_i$.\n\nThe next $q$ lines each contain two integers $u, k$, representing a query.", "outputFormat": "There are $q$ lines, each containing one integer, representing the answer to the query.", "hint": "#### Sample Explanation #1\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ap9imym3.png)\n\nThe $1$-st ancestor of ingredient $2$ is ingredient $1$. The $1$-st level children of ingredient $1$ are ingredients $2$ and $3$. The colors of ingredients $2$ and $3$ are both the same as the color of ingredient $1$, so the sum of tastiness values is $2 + 3 = 5$.\n\n------------\n\n#### Constraints\n\n**This problem uses bundled testdata.**\n\n- Subtask 1 (30 points): Eggs are scarce, the pudding is small: $n \\leq 10^3$, $q \\leq 10^4$.\n- Subtask 2 (20 points): The ingredients form a chain: $n \\leq 5 \\times 10^5$, $q \\leq 10^5$, $color_i \\leq 10^2$.\n- Subtask 3 (50 points): No special restrictions on the testdata.\n\nFor $100\\%$ of the testdata, $1 \\leq n, q, color_i \\leq 5 \\times 10^5$, $1 \\leq d_i \\leq 10^5$.\n\n------------\n\n#### Hint\n\n**The time limit for the test points in Subtask 2 and Subtask 3 is 2S.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「ACOI2020」布丁暗杀计划", "background": "![T3](https://s2.ax1x.com/2020/01/12/lopanO.png)\n\n茅野 カエデ（Kayano Kaede）制定了一个用布丁暗杀杀老师的计划。他们用剩余的鸡蛋加工制成一个布丁。为了外观和味道，他们会在里面加上一些用糯米纸包着的改变口味的食材。为了好看，这些食材从上至下排成了树的模样。在布丁的最底下铺满了对老师炸弹。杀老师吃到那里去之后就会引爆。", "description": "终于，同学们把布丁做好了。最爱吃布丁的茅野开始想，这个布丁有多好吃呢？\n\n一个布丁的好吃程度，取决于里面的改变口味的食材。材料不同的话，颜色和美味度也是不一样的。\n\n布丁里面有 $n$ 种调味食材，有 $n-1$ 个东西连接着，第一种食材在最上面，相当于这一棵树的根。\n\n现在，茅野制定一个布丁的好吃程度与指定的某两个值 $u,k$ 有关，这个好吃程度为，第 $u$ 种食材的 $k$ 级祖先 $v$ 食材的所有 $k$ 级儿子与 $v$ 食材颜色相同的那些 $k$ 级儿子的美味度之和。可以发现，$u$ 或者 $k$ 不同，一般情况下美味度是不同的。所以有 $q$ 个问题想要问你。\n\n**特殊地，如果第 $u$ 种食材没有 $k$ 级祖先，直接输出 $0$ 即可。**", "inputFormat": "第一行两个整数 $n,q$，表示有 $n$ 个食材，$q$ 个询问。\n\n第二行 $n$ 个整数，第 $i$ 个整数表示食材 $i$ 的颜色 $color_i$。\n\n第三行 $n$ 个整数，第 $i$ 个整数表示食材 $i$ 的美味值 $d_i$。\n\n第四行 $n-1$ 个整数，第 $i$ 个整数表示食材 $i+1$ 的父节点 $fa_i$。\n\n接下来 $q$ 行，每行两个整数 $u,k$ 表示询问。", "outputFormat": "有 $q$ 行，每行一个整数，表示询问的结果。", "hint": "#### 样例解释 #1\n![](https://cdn.luogu.com.cn/upload/image_hosting/ap9imym3.png)\n\n食材 $2$ 的 $1$ 级祖先是食材 $1$，食材 $1$ 的 $1$ 级儿子有食材 $2$ 与食材 $3$，食材 $2$ 与食材 $3$ 的颜色都与食材 $1$ 的颜色相同，所以美味度之和为 $2+3=5$。\n\n------------\n#### 数据范围\n**本题采用捆绑测试**。\n\n- Subtask 1（30 points），鸡蛋缺乏，布丁不大：$n \\leq 10^3$，$q \\leq 10^4$。\n- Subtask 2（20 points），食材构成了一条链：$n \\leq 5 \\times 10^5$，$q \\leq 10^5$，$color_i \\leq 10^2$。     \n- Subtask 3（50 points）：数据无特殊限制。 \n\n\n对于 $100\\%$ 的数据，$1 \\leq n,q,color_i \\leq 5 \\times 10^5$，$1 \\leq d_i \\leq 10^5$。\n\n------------\n#### 提示\n\n**第二个子任务中的测试点与第三个子任务中的测试点时限 2S。**", "locale": "zh-CN"}}}
{"pid": "P6042", "type": "P", "difficulty": 5, "samples": [["5\n1\n2\n3\n4\n5\n", "1\n4\n10\n20\n36\n"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "递推", "2020", "前缀和", "差分"], "title": "「ACOI2020」学园祭", "background": "![T4](https://s2.ax1x.com/2020/01/12/lopWDS.md.png)\n\n秋天，是学习之秋，食欲之秋，更是，学园祭之秋！随着时间流逝，学园祭也越来越近。终于等到这一天，可是没想到在冲绳岛上邂逅到女装的渚同学的勇次竟然来了！中村 莉櫻（Nakamura Rio）见到这个情况，忙给渚同学换上女装。没办法，勇次已经来了，于是渚同学鼓起勇气迈出了第一步。（为什么自顾自地加提示框啊喂！）", "description": "莉櫻为了利用这个人傻钱多的少爷，尽全力提高消费额，努力地暗示渚同学。没办法，于是渚同学想了一下，提出了一个问题：\n\n给出一个 $n$，定义：\n$$\n\\Gamma(0)=1,\\Gamma(n)={n!}\n$$\n\n$$\nA_i^j=\\frac{\\Gamma(i)}{\\Gamma(j)}\n$$\n求\n$$\n\\sum_{i=1}^n \\sum_{j=1}^i \\sum_{k=1}^j \\gcd(A_{i-j}^j \\times \\Gamma(j),A_{j-k}^k \\times \\Gamma(k)) \n$$\n\n渚同学念着莉櫻举起的对话板上写的字：如果不能在规定时间回答出问题的话，就要把菜单全部买一遍哦！\n\n尽管勇次钱多，但是他并不想吃得太多，因为这个问题有 $T$ 个小问题！\n\n**由于答案可能太大，请将答案对 $10086001$ 取模。**", "inputFormat": "**本题有多组数据**。\n\n第一行一个整数 $T$，表示数据组数。\n\n对于每组数据：\n\n只有一行一个整数 $n$。", "outputFormat": "对于每组数据，一行一个整数，表示问题的答案对 $10086001$ 取模后的值。", "hint": "#### 数据范围\n**本题采用捆绑测试**。\n\n- Subtask 1（20 points）：$T \\leq 10^3$，$n \\leq 10^2$。   \n- Subtask 2（30 points）：$T \\leq 10^6$，$n \\leq 5 \\times 10^3$。  \n- Subtask 3（50 points）：$T \\leq 10^6$，$n \\leq 10^6$。   \n\n对于 $100\\%$ 的数据，$1 \\leq T,n \\leq 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "\"ACOI2020\" School Festival", "background": "![T4](https://s2.ax1x.com/2020/01/12/lopWDS.md.png)\n\nAutumn is the season of studying, the season of eating, and, even more, the season of the school festival. As time passes, the school festival is getting closer and closer. Finally, the day has come, but unexpectedly, Yuji, who once ran into Nagisa wearing women’s clothing on Okinawa Island, actually showed up. Nakamura Rio (Nakamura Rio) saw this and hurriedly had Nagisa put on women’s clothing. There was no choice: since Yuji was already here, Nagisa gathered his courage and took the first step. (Why are you adding a hint box on your own!)", "description": "To take advantage of this rich-but-foolish young master and increase his spending as much as possible, Rio tried hard to hint at Nagisa. With no other choice, Nagisa thought for a while and raised a question:\n\nGiven an $n$, define:\n$$\n\\Gamma(0)=1,\\Gamma(n)={n!}\n$$\n\n$$\nA_i^j=\\frac{\\Gamma(i)}{\\Gamma(j)}\n$$\nCompute:\n$$\n\\sum_{i=1}^n \\sum_{j=1}^i \\sum_{k=1}^j \\gcd(A_{i-j}^j \\times \\Gamma(j),A_{j-k}^k \\times \\Gamma(k)) \n$$\n\nNagisa read out the words written on the conversation board Rio held up: If you cannot answer the question within the given time, you have to buy the entire menu once!\n\nAlthough Yuji has a lot of money, he does not want to eat too much, because this problem has $T$ subproblems.\n\n**Since the answer may be very large, output the answer modulo $10086001$.**", "inputFormat": "**This problem contains multiple test cases.**\n\nThe first line contains an integer $T$, the number of test cases.\n\nFor each test case:\n\nThere is only one line with one integer $n$.", "outputFormat": "For each test case, output one integer per line: the answer modulo $10086001$.", "hint": "#### Constraints\n\n**This problem uses bundled testdata.**\n\n- Subtask 1 (20 points): $T \\leq 10^3$, $n \\leq 10^2$.  \n- Subtask 2 (30 points): $T \\leq 10^6$, $n \\leq 5 \\times 10^3$.  \n- Subtask 3 (50 points): $T \\leq 10^6$, $n \\leq 10^6$.  \n\nFor $100\\%$ of the testdata, $1 \\leq T,n \\leq 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「ACOI2020」学园祭", "background": "![T4](https://s2.ax1x.com/2020/01/12/lopWDS.md.png)\n\n秋天，是学习之秋，食欲之秋，更是，学园祭之秋！随着时间流逝，学园祭也越来越近。终于等到这一天，可是没想到在冲绳岛上邂逅到女装的渚同学的勇次竟然来了！中村 莉櫻（Nakamura Rio）见到这个情况，忙给渚同学换上女装。没办法，勇次已经来了，于是渚同学鼓起勇气迈出了第一步。（为什么自顾自地加提示框啊喂！）", "description": "莉櫻为了利用这个人傻钱多的少爷，尽全力提高消费额，努力地暗示渚同学。没办法，于是渚同学想了一下，提出了一个问题：\n\n给出一个 $n$，定义：\n$$\n\\Gamma(0)=1,\\Gamma(n)={n!}\n$$\n\n$$\nA_i^j=\\frac{\\Gamma(i)}{\\Gamma(j)}\n$$\n求\n$$\n\\sum_{i=1}^n \\sum_{j=1}^i \\sum_{k=1}^j \\gcd(A_{i-j}^j \\times \\Gamma(j),A_{j-k}^k \\times \\Gamma(k)) \n$$\n\n渚同学念着莉櫻举起的对话板上写的字：如果不能在规定时间回答出问题的话，就要把菜单全部买一遍哦！\n\n尽管勇次钱多，但是他并不想吃得太多，因为这个问题有 $T$ 个小问题！\n\n**由于答案可能太大，请将答案对 $10086001$ 取模。**", "inputFormat": "**本题有多组数据**。\n\n第一行一个整数 $T$，表示数据组数。\n\n对于每组数据：\n\n只有一行一个整数 $n$。", "outputFormat": "对于每组数据，一行一个整数，表示问题的答案对 $10086001$ 取模后的值。", "hint": "#### 数据范围\n**本题采用捆绑测试**。\n\n- Subtask 1（20 points）：$T \\leq 10^3$，$n \\leq 10^2$。   \n- Subtask 2（30 points）：$T \\leq 10^6$，$n \\leq 5 \\times 10^3$。  \n- Subtask 3（50 points）：$T \\leq 10^6$，$n \\leq 10^6$。   \n\n对于 $100\\%$ 的数据，$1 \\leq T,n \\leq 10^6$。", "locale": "zh-CN"}}}
{"pid": "P6043", "type": "P", "difficulty": 7, "samples": [["5\n5 3\n7 3\n9 6\n100 50\n44 22\n\n", "26\n64\n466\n41441083\n461961723\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 2000, 2000, 2000, 5000, 5000, 5000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "2020", "倍增", "O2优化", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "「ACOI2020」修学旅行", "background": "![T5](https://s2.ax1x.com/2020/01/12/loS0Wq.md.png)\n\n第一学期开学没多久，E 班的各位就要去修学旅行了！", "description": "现在，六个人 赤羽 業，杉野 友人，奧田 愛美，茅野 楓，神崎 有希子，潮田 渚 为一组，他们将在京都进行一次暗杀旅行。他们的目标仍然是狙击杀老师。政府同时派来了职业狙击手 赤红之眼。但是完成任务的同时，他们想让快乐度尽量的高。\n\n聪明的神崎 有希子（Kanzaki Yukiko）终于求出了快乐度的表达式，令人感到震惊的是，快乐度竟然和旅行景点个数和暗杀杀老师次数有关！\n\n假设他们经过了 $n$ 个景点，暗杀了 $m$ 次杀老师，且定义：\n\n$$\n\\Gamma(a,b)=\\left\\{\n    \\begin{aligned}\n    & 1,a>b&\\\\\n    &  \\prod_{i=a}^b i,a \\le b&\\\\\n    \\end{aligned}\n    \\right.\n$$\n\n那么快乐度为：\n\n$$\n\\sum_{i=0}^m \\lgroup \\frac{\\sqrt{\\sum_{j=0}^i (C_i^j)^2C_{n+2i-j}^{2i}}}{\\Gamma(n+1,n+i)} \\times \\Gamma(n-i+1,n) \\rgroup \n$$\n\n**我们保证** $\\frac{\\sqrt{\\sum_{j=0}^i (C_i^j)^2C_{n+2i-j}^{2i}}}{\\Gamma(n+1,n+i)} \\times \\Gamma(n-i+1,n)$ **是一个整数。**\n\n现在他们有 $T$ 个问题想要问你，如果他们经过了 $n$ 个景点并且暗杀 $m$ 次杀老师，能否告诉他们快乐度呢？\n\n**由于答案可能太大，请将答案对 $998244353$ 取模。**", "inputFormat": "**本题有多组数据**。\n\n第一行一个整数 $T$，表示数据组数。\n\n对于每组数据：\n\n只有一行两个整数 $n$ 和 $m$。", "outputFormat": "对于每组数据，只有一行一个整数，表示他们经过了 $n$ 个景点，暗杀了 $m$ 次杀老师的快乐度对 $998244353$ 取模后的值。\n\n#### 样例有更新", "hint": "#### 数据范围\n\n**本题采用捆绑测试**。\n\n- Subtask 1（10 points）：$T \\leq 10$，$n,m \\leq 10$。     \n- Subtask 2（20 points）：$T \\leq 100$，$n,m \\leq 5 \\times 10^4$。      \n- Subtask 3（30 points）：$T \\leq 50$，$n,m \\leq 9 \\times 10^8$。  \n- Subtask 4（40 points）：数据无特殊限制。  \n\n对于 $100\\%$ 的数据，$m \\leq n$，$1 \\leq T \\le 10^2$，$1 \\leq n,m \\leq 9 \\times 10^8$。\n\n---\n#### 提示\n\n**第三个子任务中的测试点时限 2S，第四个子任务中的测试点时限 5S。**", "locale": "zh-CN", "translations": {"en": {"title": "\"ACOI2020\" Study Trip", "background": "![T5](https://s2.ax1x.com/2020/01/12/loS0Wq.md.png)\n\nNot long after the first semester begins, everyone in Class E is going on a study trip.", "description": "Now, six people—Akabane Karma, Sugino Tomohito, Okuda Manami, Kayano Kaede, Kanzaki Yukiko, and Shiota Nagisa—form a group. They will go on an assassination trip in Kyoto. Their goal is still to snipe and kill their teacher. The government has also sent a professional sniper, \"Akame no Eye\". While completing the mission, they want the happiness value to be as large as possible.\n\nThe clever Kanzaki Yukiko (Kanzaki Yukiko) finally worked out the expression for the happiness value. Shockingly, the happiness value is actually related to the number of sightseeing spots in the trip and the number of times they assassinate their teacher.\n\nSuppose they pass through $n$ sightseeing spots and assassinate their teacher $m$ times, and define:\n\n$$\n\\Gamma(a,b)=\\left\\{\n    \\begin{aligned}\n    & 1,a>b&\\\\\n    &  \\prod_{i=a}^b i,a \\le b&\\\\\n    \\end{aligned}\n    \\right.\n$$\n\nThen the happiness value is:\n\n$$\n\\sum_{i=0}^m \\lgroup \\frac{\\sqrt{\\sum_{j=0}^i (C_i^j)^2C_{n+2i-j}^{2i}}}{\\Gamma(n+1,n+i)} \\times \\Gamma(n-i+1,n) \\rgroup \n$$\n\n**We guarantee** that $\\frac{\\sqrt{\\sum_{j=0}^i (C_i^j)^2C_{n+2i-j}^{2i}}}{\\Gamma(n+1,n+i)} \\times \\Gamma(n-i+1,n)$ **is an integer.**\n\nNow they have $T$ questions to ask you. If they pass through $n$ sightseeing spots and assassinate their teacher $m$ times, can you tell them the happiness value?\n\n**Since the answer may be very large, output the answer modulo $998244353$.**", "inputFormat": "**This problem contains multiple test cases.**\n\nThe first line contains an integer $T$, the number of test cases.\n\nFor each test case:\n\nThere is only one line with two integers $n$ and $m$.", "outputFormat": "For each test case, output one line containing one integer: the happiness value modulo $998244353$ when they pass through $n$ sightseeing spots and assassinate their teacher $m$ times.\n\n#### The sample has been updated.", "hint": "#### Constraints\n\n**This problem uses bundled testdata.**\n\n- Subtask 1 (10 points): $T \\leq 10$, $n,m \\leq 10$.  \n- Subtask 2 (20 points): $T \\leq 100$, $n,m \\leq 5 \\times 10^4$.  \n- Subtask 3 (30 points): $T \\leq 50$, $n,m \\leq 9 \\times 10^8$.  \n- Subtask 4 (40 points): No special constraints on the testdata.  \n\nFor $100\\%$ of the testdata, $m \\leq n$, $1 \\leq T \\le 10^2$, $1 \\leq n,m \\leq 9 \\times 10^8$.\n\n---\n\n#### Notes\n\n**The time limit is 2 s for the test points in the third subtask, and 5 s for the test points in the fourth subtask.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「ACOI2020」修学旅行", "background": "![T5](https://s2.ax1x.com/2020/01/12/loS0Wq.md.png)\n\n第一学期开学没多久，E 班的各位就要去修学旅行了！", "description": "现在，六个人 赤羽 業，杉野 友人，奧田 愛美，茅野 楓，神崎 有希子，潮田 渚 为一组，他们将在京都进行一次暗杀旅行。他们的目标仍然是狙击杀老师。政府同时派来了职业狙击手 赤红之眼。但是完成任务的同时，他们想让快乐度尽量的高。\n\n聪明的神崎 有希子（Kanzaki Yukiko）终于求出了快乐度的表达式，令人感到震惊的是，快乐度竟然和旅行景点个数和暗杀杀老师次数有关！\n\n假设他们经过了 $n$ 个景点，暗杀了 $m$ 次杀老师，且定义：\n\n$$\n\\Gamma(a,b)=\\left\\{\n    \\begin{aligned}\n    & 1,a>b&\\\\\n    &  \\prod_{i=a}^b i,a \\le b&\\\\\n    \\end{aligned}\n    \\right.\n$$\n\n那么快乐度为：\n\n$$\n\\sum_{i=0}^m \\lgroup \\frac{\\sqrt{\\sum_{j=0}^i (C_i^j)^2C_{n+2i-j}^{2i}}}{\\Gamma(n+1,n+i)} \\times \\Gamma(n-i+1,n) \\rgroup \n$$\n\n**我们保证** $\\frac{\\sqrt{\\sum_{j=0}^i (C_i^j)^2C_{n+2i-j}^{2i}}}{\\Gamma(n+1,n+i)} \\times \\Gamma(n-i+1,n)$ **是一个整数。**\n\n现在他们有 $T$ 个问题想要问你，如果他们经过了 $n$ 个景点并且暗杀 $m$ 次杀老师，能否告诉他们快乐度呢？\n\n**由于答案可能太大，请将答案对 $998244353$ 取模。**", "inputFormat": "**本题有多组数据**。\n\n第一行一个整数 $T$，表示数据组数。\n\n对于每组数据：\n\n只有一行两个整数 $n$ 和 $m$。", "outputFormat": "对于每组数据，只有一行一个整数，表示他们经过了 $n$ 个景点，暗杀了 $m$ 次杀老师的快乐度对 $998244353$ 取模后的值。\n\n#### 样例有更新", "hint": "#### 数据范围\n\n**本题采用捆绑测试**。\n\n- Subtask 1（10 points）：$T \\leq 10$，$n,m \\leq 10$。     \n- Subtask 2（20 points）：$T \\leq 100$，$n,m \\leq 5 \\times 10^4$。      \n- Subtask 3（30 points）：$T \\leq 50$，$n,m \\leq 9 \\times 10^8$。  \n- Subtask 4（40 points）：数据无特殊限制。  \n\n对于 $100\\%$ 的数据，$m \\leq n$，$1 \\leq T \\le 10^2$，$1 \\leq n,m \\leq 9 \\times 10^8$。\n\n---\n#### 提示\n\n**第三个子任务中的测试点时限 2S，第四个子任务中的测试点时限 5S。**", "locale": "zh-CN"}}}
{"pid": "P6044", "type": "P", "difficulty": 3, "samples": [["6 3\n3 8\n4 12\n2 6\n1 10\n5 9\n11 12\n", "4\n1 2 4\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "2018", "堆", "POI（波兰）", "Special Judge"], "title": "[POI 2018] Prawnicy", "background": "**题目译自 [POI XXV - I etap](https://sio2.mimuw.edu.pl/c/oi25-1/dashboard/) 「[Prawnicy](https://sio2.mimuw.edu.pl/c/oi25-1/p/pra/)」**", "description": "“Bajtazar 父子”律师事务所刚刚收到一位非常重要的客户的订单。案件严重、紧急，需要与律师事务所的律师举行会议。每个律师都有一段固定的空闲时间可以参加会议。你应该选择这样的 $k$ 位律师，以便召开会议的时间（即他们都空闲的时间）尽可能长。\n\n[简要题意](https://www.luogu.com.cn/problem/U252799)", "inputFormat": "第一行包含两个整数 $n$ 和 $k\\ (1\\le k\\le n)$，以一个空格隔开，表示事务所雇用的律师人数和召开会议所需的律师人数。\n\n接下来 $n$ 行，第 $i$ 行包含两个整数 $a_i$ 和 $b_i\\ (1\\le a_i<b_i\\le 10^9)$，以一个空格隔开，表示第 $i$ 个律师在**时刻 $a_i$ 和时刻 $b_i$ 之间**是空闲的。", "outputFormat": "第一行输出一个整数，表示会议可能的最大时长。你可以假设你能够召开至少 $1$ 人的会议。\n\n第二行输出空格分隔的 $k$ 个数，代表参加会议的律师编号（从 $1$ 开始）。如果有多个正确答案，您的程序应输出其中任何一个。", "hint": "#### 样例解释\n\n三位律师会议可能的最大时长是 $4$。编号为 $1$、$2$ 和 $4$ 的律师可以参加，持续时间从 $4$ 到 $8$。另一个同样好的方案是让编号为 $2$、$4$ 和 $5$ 的律师参加，持续时间从 $5$ 到 $9$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/187yuqy1.png)\n\n#### 附加样例\n\n参见 `pra/pra*.in` 和 `pra/pra*.out`：\n\n- 附加样例 $1$：$1$ 组数据，$n=7$，$k=3$，且选择律师的方案有两种。\n\n- 附加样例 $2$：$1$ 组数据，$n=k=1000$，$a_i=i$，$b_i=10^6+i$；\n\n- 附加样例 $3$：$1$ 组数据，$n=1000$，$k=1$，$a_i=2i-1$，$b_i=2i$；\n\n#### 数据范围与提示\n\n测试集分为以下子任务。每个子任务的测试由一个或多个单独的测试组组成。\n\n| Subtask # | 额外限制                         | 分值  |\n|:---------:|:----------------------------:|:---:|\n| $1$         | $n\\le 20$       | $20$  |\n| $2$         | $n\\le 300$，$a_i,b_i\\le 300$      | $15$  |\n| $3$         | $n\\le 5000$       | $15$  |\n| $4$         | $n\\le 10^6$，$k\\in \\{1,n\\}$       | $15$  |\n| $5$         | $n\\le 10^6$       | $35$  |\n\n如果你的程序在第一行输出了正确的时长，但其余的输出是错误的，那么你将获得 $40\\%$ 的分数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[POI 2018] Prawnicy", "background": "**题目译自 [POI XXV - I etap](https://sio2.mimuw.edu.pl/c/oi25-1/dashboard/) 「[Prawnicy](https://sio2.mimuw.edu.pl/c/oi25-1/p/pra/)」**", "description": "“Bajtazar 父子”律师事务所刚刚收到一位非常重要的客户的订单。案件严重、紧急，需要与律师事务所的律师举行会议。每个律师都有一段固定的空闲时间可以参加会议。你应该选择这样的 $k$ 位律师，以便召开会议的时间（即他们都空闲的时间）尽可能长。\n\n[简要题意](https://www.luogu.com.cn/problem/U252799)", "inputFormat": "第一行包含两个整数 $n$ 和 $k\\ (1\\le k\\le n)$，以一个空格隔开，表示事务所雇用的律师人数和召开会议所需的律师人数。\n\n接下来 $n$ 行，第 $i$ 行包含两个整数 $a_i$ 和 $b_i\\ (1\\le a_i<b_i\\le 10^9)$，以一个空格隔开，表示第 $i$ 个律师在**时刻 $a_i$ 和时刻 $b_i$ 之间**是空闲的。", "outputFormat": "第一行输出一个整数，表示会议可能的最大时长。你可以假设你能够召开至少 $1$ 人的会议。\n\n第二行输出空格分隔的 $k$ 个数，代表参加会议的律师编号（从 $1$ 开始）。如果有多个正确答案，您的程序应输出其中任何一个。", "hint": "#### 样例解释\n\n三位律师会议可能的最大时长是 $4$。编号为 $1$、$2$ 和 $4$ 的律师可以参加，持续时间从 $4$ 到 $8$。另一个同样好的方案是让编号为 $2$、$4$ 和 $5$ 的律师参加，持续时间从 $5$ 到 $9$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/187yuqy1.png)\n\n#### 附加样例\n\n参见 `pra/pra*.in` 和 `pra/pra*.out`：\n\n- 附加样例 $1$：$1$ 组数据，$n=7$，$k=3$，且选择律师的方案有两种。\n\n- 附加样例 $2$：$1$ 组数据，$n=k=1000$，$a_i=i$，$b_i=10^6+i$；\n\n- 附加样例 $3$：$1$ 组数据，$n=1000$，$k=1$，$a_i=2i-1$，$b_i=2i$；\n\n#### 数据范围与提示\n\n测试集分为以下子任务。每个子任务的测试由一个或多个单独的测试组组成。\n\n| Subtask # | 额外限制                         | 分值  |\n|:---------:|:----------------------------:|:---:|\n| $1$         | $n\\le 20$       | $20$  |\n| $2$         | $n\\le 300$，$a_i,b_i\\le 300$      | $15$  |\n| $3$         | $n\\le 5000$       | $15$  |\n| $4$         | $n\\le 10^6$，$k\\in \\{1,n\\}$       | $15$  |\n| $5$         | $n\\le 10^6$       | $35$  |\n\n如果你的程序在第一行输出了正确的时长，但其余的输出是错误的，那么你将获得 $40\\%$ 的分数。", "locale": "zh-CN"}}}
{"pid": "P6045", "type": "P", "difficulty": 3, "samples": [["2", "650"], ["105383595", "114514"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2020"], "title": "后缀树", "background": "Eztsu 是一个可爱的女孩子，最近她学习了[后缀树](https://www.luogu.com.cn/blog/EternalAlexander/xuan-ku-hou-zhui-shu-mo-shu)，并打算用它来解决如下问题。", "description": "对于一个字符串 $S$，我们定义 $|S|$ 表示 $S$ 的长度。\n\n接着，我们定义 $S_i$ 表示 $S$ 中第 $i$ 个字符，$S_{L...R}$ 表示由 $S$ 中从左往右数，第 $L$ 个字符到第 $R$ 个字符依次连接形成的字符串。\n\n给定 $n$，求有多少种不同的满足下列要求的串 $S$：\n\n- $|S|=n$。\n- $S$ 中仅包含小写字母。\n- 不存在整数 $i \\in [1,n)$ 使得 $S_{1...i}$ 是 $S_{i+1...n}$ 的子串。\n\n对于第三个限制，用通俗一点的说法解释的话，就是不存在一种将这个串分成两段的方式，使得前面一段是后面一段的子串。\n\n两个串 $S$ 和 $T$ 不同当且仅当 $|S|\\neq|T|$ 或 $\\exists i \\in [1,|S|] S_i \\neq T_i$。如果你不知道这是什么意思，你可以理解为它们看起来不同。\n\n可怜的 Eztsu 不会做，所以你要帮她做这道题。\n\n答案可能很大，你只需要输出答案对 $998244353$ 取模的值。\n\n题面补充：\n\n$S$ 是 $T$ 的子串当且仅当存在 $L,R \\in [1,|T|]$ 使得 $T_{L...R}=S$。", "inputFormat": "一行一个正整数 $n$，意义见题目描述。", "outputFormat": "一行一个整数，答案对 $998244353$ 取模的值。", "hint": "#### 样例解释\n\n对于第一组样例，不难发现，这个串符合题意当且仅当两个字符不同，因此答案为 $26 \\times 26 - 26$，可以理解为两个字符任意的方案数减去两个字符相同的方案数。\n\n---\n\n#### 数据范围\n\n**「本题采用捆绑测试」**\n\n对于所有测试点，保证 $1 \\leq n \\leq 10^9$。\n\n$\\text{Subtask 1 (17 pts)}$ $n \\leq 4$。\n\n$\\text{Subtask 2 (78 pts)}$ $n \\leq 2\\times 10^3$。\n\n$\\text{Subtask 3 (5 pts)}$ 没有特殊限制。\n\n---\n\n#### 提示\n\n小写字母一共有 $26$ 个。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "后缀树", "background": "Eztsu 是一个可爱的女孩子，最近她学习了[后缀树](https://www.luogu.com.cn/blog/EternalAlexander/xuan-ku-hou-zhui-shu-mo-shu)，并打算用它来解决如下问题。", "description": "对于一个字符串 $S$，我们定义 $|S|$ 表示 $S$ 的长度。\n\n接着，我们定义 $S_i$ 表示 $S$ 中第 $i$ 个字符，$S_{L...R}$ 表示由 $S$ 中从左往右数，第 $L$ 个字符到第 $R$ 个字符依次连接形成的字符串。\n\n给定 $n$，求有多少种不同的满足下列要求的串 $S$：\n\n- $|S|=n$。\n- $S$ 中仅包含小写字母。\n- 不存在整数 $i \\in [1,n)$ 使得 $S_{1...i}$ 是 $S_{i+1...n}$ 的子串。\n\n对于第三个限制，用通俗一点的说法解释的话，就是不存在一种将这个串分成两段的方式，使得前面一段是后面一段的子串。\n\n两个串 $S$ 和 $T$ 不同当且仅当 $|S|\\neq|T|$ 或 $\\exists i \\in [1,|S|] S_i \\neq T_i$。如果你不知道这是什么意思，你可以理解为它们看起来不同。\n\n可怜的 Eztsu 不会做，所以你要帮她做这道题。\n\n答案可能很大，你只需要输出答案对 $998244353$ 取模的值。\n\n题面补充：\n\n$S$ 是 $T$ 的子串当且仅当存在 $L,R \\in [1,|T|]$ 使得 $T_{L...R}=S$。", "inputFormat": "一行一个正整数 $n$，意义见题目描述。", "outputFormat": "一行一个整数，答案对 $998244353$ 取模的值。", "hint": "#### 样例解释\n\n对于第一组样例，不难发现，这个串符合题意当且仅当两个字符不同，因此答案为 $26 \\times 26 - 26$，可以理解为两个字符任意的方案数减去两个字符相同的方案数。\n\n---\n\n#### 数据范围\n\n**「本题采用捆绑测试」**\n\n对于所有测试点，保证 $1 \\leq n \\leq 10^9$。\n\n$\\text{Subtask 1 (17 pts)}$ $n \\leq 4$。\n\n$\\text{Subtask 2 (78 pts)}$ $n \\leq 2\\times 10^3$。\n\n$\\text{Subtask 3 (5 pts)}$ 没有特殊限制。\n\n---\n\n#### 提示\n\n小写字母一共有 $26$ 个。", "locale": "zh-CN"}}}
{"pid": "P6046", "type": "P", "difficulty": 5, "samples": [["3\n3 1 2", "2 0 1"], ["3\n1 2 3", "499122177 499122177 2"], ["5\n1 4 2 3 5", "499122178 249561091 665496236 582309207 4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "数学", "2020", "期望"], "title": "纯粹容器", "background": "白王正在挑选容器。", "description": "白王制造了 $n$ 个容器，并将它们排成了一队，从左到右依次编号为 $1 \\sim n$。第 $i$ 个容器的**强度**为 $a_i$，保证 $a_i$ 互不相同。为了挑选出最纯粹的容器，白王会进行 $n-1$ 轮操作，每轮操作中，他会等概率随机挑选两个 **位置相邻** 且 **未被击倒** 的容器，令它们进行决斗，在一次决斗中，强度较小的容器将会被击倒并移出队列。\n\n显然最后留下的是强度最大的容器，但是，可怜的容器们很想知道自己能够活多久，于是，它们请你对每个容器求出它存活轮数的期望。答案对 $998244353$ 取模。\n\n一个容器的存活轮数为最大的非负整数 $x < n$ 满足它在第 $x$ 轮未被击倒。\n\n两个容器 $i$ 和 $j$ 位置相邻当且仅当不存在 $k$ 满足 $i<k<j$ 且 $k$ 号容器未被击倒。", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n$ 个整数 $a_1, a_2,\\cdots,a_n$，意义见题目描述。", "outputFormat": "一行 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个容器的存活轮数的期望。为了避免浮点误差，保证答案可以表示为最简分数 $\\frac{p}{q}$，你只需要输出一个 $x (0 \\leq x < 998244353)$ 使得 $qx \\equiv p \\pmod {998244353}$。\n", "hint": "#### 样例解释\n\n在第一组样例中，第一个容器无论如何不可能被击倒，第二个容器在第一轮一定会被击倒，第三个容器第一轮一定不被击倒，第二轮一定被击倒。\n\n第二组样例的真实答案为 $\\frac{1}{2}$，$\\frac{1}{2}$，$2$。\n\n---\n\n#### 数据范围\n\n对于所有测试点，保证 $1 \\leq n \\leq 50$，$1 \\leq a_i \\leq n$，$a_i$ 两两不同。\n\n$\\text{Subtask 1 (2 pts)}$ $n \\leq 2$。\n\n$\\text{Subtask 2 (23 pts)}$ $n \\leq 6$。\n\n$\\text{Subtask 3 (31 pts)}$ $n \\leq 18$。\n\n$\\text{Subtask 4 (19 pts)}​$ $a_i = i$。\n\n$\\text{Subtask 5 (25 pts)}$ 无特殊限制。\n\n---\n\n#### 提示\n\n如果你不知道怎么对分数取模，可以参考[这里](https://www.luogu.com.cn/problem/P3811)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "纯粹容器", "background": "白王正在挑选容器。", "description": "白王制造了 $n$ 个容器，并将它们排成了一队，从左到右依次编号为 $1 \\sim n$。第 $i$ 个容器的**强度**为 $a_i$，保证 $a_i$ 互不相同。为了挑选出最纯粹的容器，白王会进行 $n-1$ 轮操作，每轮操作中，他会等概率随机挑选两个 **位置相邻** 且 **未被击倒** 的容器，令它们进行决斗，在一次决斗中，强度较小的容器将会被击倒并移出队列。\n\n显然最后留下的是强度最大的容器，但是，可怜的容器们很想知道自己能够活多久，于是，它们请你对每个容器求出它存活轮数的期望。答案对 $998244353$ 取模。\n\n一个容器的存活轮数为最大的非负整数 $x < n$ 满足它在第 $x$ 轮未被击倒。\n\n两个容器 $i$ 和 $j$ 位置相邻当且仅当不存在 $k$ 满足 $i<k<j$ 且 $k$ 号容器未被击倒。", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n$ 个整数 $a_1, a_2,\\cdots,a_n$，意义见题目描述。", "outputFormat": "一行 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个容器的存活轮数的期望。为了避免浮点误差，保证答案可以表示为最简分数 $\\frac{p}{q}$，你只需要输出一个 $x (0 \\leq x < 998244353)$ 使得 $qx \\equiv p \\pmod {998244353}$。\n", "hint": "#### 样例解释\n\n在第一组样例中，第一个容器无论如何不可能被击倒，第二个容器在第一轮一定会被击倒，第三个容器第一轮一定不被击倒，第二轮一定被击倒。\n\n第二组样例的真实答案为 $\\frac{1}{2}$，$\\frac{1}{2}$，$2$。\n\n---\n\n#### 数据范围\n\n对于所有测试点，保证 $1 \\leq n \\leq 50$，$1 \\leq a_i \\leq n$，$a_i$ 两两不同。\n\n$\\text{Subtask 1 (2 pts)}$ $n \\leq 2$。\n\n$\\text{Subtask 2 (23 pts)}$ $n \\leq 6$。\n\n$\\text{Subtask 3 (31 pts)}$ $n \\leq 18$。\n\n$\\text{Subtask 4 (19 pts)}​$ $a_i = i$。\n\n$\\text{Subtask 5 (25 pts)}$ 无特殊限制。\n\n---\n\n#### 提示\n\n如果你不知道怎么对分数取模，可以参考[这里](https://www.luogu.com.cn/problem/P3811)。", "locale": "zh-CN"}}}
{"pid": "P6047", "type": "P", "difficulty": 6, "samples": [["5 2\n3 9 1 9 9\n9 9 1 9 3\n2 1\n5 4", "6"], ["5 1\n9 9 9 9 1\n1 9 9 9 9\n3 3", "81"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "贪心", "2020", "排序", "斜率优化"], "title": "丝之割", "background": "Pharloom 是一个神秘的王国，[丝线与歌](https://www.bilibili.com/video/av43623335)是那里最强大的力量。多弦琴是 Pharloom 的一种强大武器，正如多项式是 OI 中的强大武器。\n\n因为你很讨厌多项式，你决定摧毁多弦琴。", "description": "下面这部分题面只是为了帮助你理解题意，并没有详细的解释。更为严谨清晰的叙述见形式化题意。\n\n多弦琴由两根支柱和连接两根支柱的 $m$ 条弦组成。每根支柱上都均匀安放着 $n$ 个固定点，第 $i$ 条弦连接上方支柱的第 $u_i$ 个固定点和下方支柱的第 $v_i$ 个固定点。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/14igq7bn.png)\n\n> 上图是一把多弦琴\n\n为了摧毁多弦琴，你可以进行若干次切割操作。在一次切割操作中，你可以选择上方支柱的某一个固定点 $u$ 和下方支柱的一个固定点 $v$，所有被 $u$ 到 $v$ 的连线**从左到右**穿过的弦都将被破坏。但同时，你需要付出 $a_u \\times b_v$ 的代价。\n\n形式化题意：有 $m$ 条弦，一条弦可以抽象为一个二元组 $(u,v)$，你可以进行任意次切割操作，一次切割操作你将选择两个下标 $i$ 和 $j$ 满足 $i,j \\in [1,n]$，然后所有满足 $u>i,v<j$ 的弦 $(u,v)$ 都将被破坏，同时你将付出 $a_i \\times b_j​$ 的代价。求破坏所有弦的最小代价和。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数 $a_1,a_2,\\dots,a_n$。\n\n第三行 $n$ 个整数 $b_1,b_2,\\dots,b_n$。\n\n接下来 $m$ 行每行两个整数 $u,v$，表示有一条弦 $(u,v)$。\n\n以上输入的意义见题目描述。", "outputFormat": "一行一个整数，答案。", "hint": "#### 样例解释\n\n对于第一组样例，使用两次切割，分别为 $(1,3)$，$(3,5)$，花费代价 $3 \\times 1 + 1 \\times 3 = 6$。\n\n对于第二组样例，注意切割 $(5,1)$ 不能使弦 $(3,3)$ 消失。\n\n---\n\n#### 数据范围\n\n**「本题采用捆绑测试」**\n\n对于所有测试点，保证 $1 \\leq n, m \\leq 3\\times 10^5$，$2 \\leq u \\leq n$，$1 \\leq v \\leq n-1$，$1 \\leq a_i,b_i \\leq 10^6$。\n\n$\\text{Subtask 1 (21 pts)}$ $n,m \\leq 6$。\n\n$\\text{Subtask 2 (3 pts)}$ $m=1$。\n\n$\\text{Subtask 3 (1 pts)}$ $a_1=b_n = 1$。\n\n$\\text{Subtask 4 (25 pts)}$ $n,m \\leq 100$。\n\n$\\text{Subtask 5 (29 pts)}$ $n,m \\leq 10^3$。\n\n$\\text{Subtask 6 (21 pts)}$ 无特殊限制。\n\n---\n#### 提示\n\n如果你认真观察了数据范围，你会发现这把多弦琴一定能够被破坏。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "丝之割", "background": "Pharloom 是一个神秘的王国，[丝线与歌](https://www.bilibili.com/video/av43623335)是那里最强大的力量。多弦琴是 Pharloom 的一种强大武器，正如多项式是 OI 中的强大武器。\n\n因为你很讨厌多项式，你决定摧毁多弦琴。", "description": "下面这部分题面只是为了帮助你理解题意，并没有详细的解释。更为严谨清晰的叙述见形式化题意。\n\n多弦琴由两根支柱和连接两根支柱的 $m$ 条弦组成。每根支柱上都均匀安放着 $n$ 个固定点，第 $i$ 条弦连接上方支柱的第 $u_i$ 个固定点和下方支柱的第 $v_i$ 个固定点。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/14igq7bn.png)\n\n> 上图是一把多弦琴\n\n为了摧毁多弦琴，你可以进行若干次切割操作。在一次切割操作中，你可以选择上方支柱的某一个固定点 $u$ 和下方支柱的一个固定点 $v$，所有被 $u$ 到 $v$ 的连线**从左到右**穿过的弦都将被破坏。但同时，你需要付出 $a_u \\times b_v$ 的代价。\n\n形式化题意：有 $m$ 条弦，一条弦可以抽象为一个二元组 $(u,v)$，你可以进行任意次切割操作，一次切割操作你将选择两个下标 $i$ 和 $j$ 满足 $i,j \\in [1,n]$，然后所有满足 $u>i,v<j$ 的弦 $(u,v)$ 都将被破坏，同时你将付出 $a_i \\times b_j​$ 的代价。求破坏所有弦的最小代价和。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数 $a_1,a_2,\\dots,a_n$。\n\n第三行 $n$ 个整数 $b_1,b_2,\\dots,b_n$。\n\n接下来 $m$ 行每行两个整数 $u,v$，表示有一条弦 $(u,v)$。\n\n以上输入的意义见题目描述。", "outputFormat": "一行一个整数，答案。", "hint": "#### 样例解释\n\n对于第一组样例，使用两次切割，分别为 $(1,3)$，$(3,5)$，花费代价 $3 \\times 1 + 1 \\times 3 = 6$。\n\n对于第二组样例，注意切割 $(5,1)$ 不能使弦 $(3,3)$ 消失。\n\n---\n\n#### 数据范围\n\n**「本题采用捆绑测试」**\n\n对于所有测试点，保证 $1 \\leq n, m \\leq 3\\times 10^5$，$2 \\leq u \\leq n$，$1 \\leq v \\leq n-1$，$1 \\leq a_i,b_i \\leq 10^6$。\n\n$\\text{Subtask 1 (21 pts)}$ $n,m \\leq 6$。\n\n$\\text{Subtask 2 (3 pts)}$ $m=1$。\n\n$\\text{Subtask 3 (1 pts)}$ $a_1=b_n = 1$。\n\n$\\text{Subtask 4 (25 pts)}$ $n,m \\leq 100$。\n\n$\\text{Subtask 5 (29 pts)}$ $n,m \\leq 10^3$。\n\n$\\text{Subtask 6 (21 pts)}$ 无特殊限制。\n\n---\n#### 提示\n\n如果你认真观察了数据范围，你会发现这把多弦琴一定能够被破坏。", "locale": "zh-CN"}}}
{"pid": "P6048", "type": "P", "difficulty": 6, "samples": [["4\n1 1 3", "499122180"], ["3\n1 2", "3"], ["13\n1 1 1 3 5 4 2 3 7 4 4 6", "776412285"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["搜索", "数学", "2020", "线段树", "剪枝", "树链剖分", "期望"], "title": "最优性剪枝", "background": "Nauuo 是一名出题人。\n\n众所周知，某些出题人非常懒，导致[随便爆搜](https://www.luogu.com.cn/discuss/show/185420)加上一个[最优性剪枝](https://www.luogu.com.cn/discuss/show/184641)就能通过。Nauuo 决定把这些 naive 的暴力都卡掉。", "description": "Nauuo 决定卡一个暴力搜索程序，为此她构建了一组数据。为了简化题目，你将得到这组数据产生的搜索树 $T$。$T$ 中包含 $n$ 个节点，依次编号为 $1 \\sim n$，其中 $1$ 号点是 $T$ 的根节点。一个节点的深度是它到 $1$ 号点的简单路径上的节点个数。\n\n这个程序的伪代码如下\n\n```cpp\nanswer := inf\n\nprocedure dfs(node,depth)\n\tif (node is leaf) \n\t\tanswer := min(answer,depth)\n\t\treturn\n\tif (depth < answer)\n\t\tfor i in children of node\n\t\t\tdfs(i,depth+1)\n\ndfs(1,1)\n```\n\n其中，`:=` 表示赋值运算。\n\n翻译成人话就是说，这个暴力搜索程序将**深度优先**地遍历这棵搜索树，当访问到一个叶节点时，这个程序将用这个叶节点的深度更新答案。\n\n同时，这个程序有一个最优性剪枝，也就是说，当这个程序访问到任意一个深度等于答案的节点时，它将不会再访问这个节点的子节点。\n\n然而，可怜的 Nauuo 并不知道这个程序在某个节点时访问自己子节点的顺序，因此她认为每个节点访问子节点的顺序都是在所有可能的情况中等概率随机的，显然，一共有 $\\prod d_i!$ 种情况，其中 $d_i$ 表示 $i$ 号节点的子节点数量。\n\n现在她想知道这个程序访问到的节点数量的期望，以确定这个程序会不会被自己的数据卡掉。\n\n为了避免浮点误差，答案对 $998244353$ 取模。保证答案能被表示为最简分数 $\\frac{p}{q}$，你只需要输出一个 $x (0\\leq x < 998244353)$ 使得 $qx \\equiv p \\pmod {998244353}$。", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n-1$ 个整数 $p_2, p_3 \\cdots p_n$，其中 $p_i$ 表示 $i$ 号节点的父节点编号。", "outputFormat": "一行一个整数，所求 $x$。", "hint": "#### 样例解释\n\n第一组样例的真实答案为 $\\frac{7}{2}$。\n\n一共只有两种情况，如果 $1$ 号节点先遍历 $3$ 号节点，则程序将访问到搜索树中所有节点。如果 $1$ 号节点先遍历 $2$ 号节点，则 $4$ 号节点不会被访问到。\n\n第二组样例中，每个非叶节点的子节点都是唯一的，因此只有一种可能的情况，所有节点都必然被访问到。\n\n第三组样例的真实答案为 $\\frac{94}{9}$。\n\n---\n\n#### 数据范围\n\n**「本题采用捆绑测试」**\n\n对于所有测试点，保证 $1 \\leq n \\leq 3\\times 10^5$，$1 \\leq p_i < i$。\n\n$\\text{Subtask 1 (11 pts)}$ $n \\leq 9$。\n\n$\\text{Subtask 2 (18 pts)}$ $n \\leq 100$。\n\n$\\text{Subtask 3 (19 pts)}$ $n\\leq 10^3$。\n\n$\\text{Subtask 4 (4 pts)}$ $p_i = i-1$。\n\n$\\text{Subtask 5 (8 pts)}$ $p_i =\\lfloor \\frac{i}{2} \\rfloor$。\n\n$\\text{Subtask 6 (40 pts)}$ 无特殊限制。\n\n---\n\n#### 提示\n\n如果你不知道怎么对分数取模，可以参考[这里](https://www.luogu.com.cn/problem/P3811)。\n\n", "locale": "zh-CN", "translations": {"en": {"title": "Optimality Pruning.", "background": "Nauuo is a problem setter.\n\nAs everyone knows, some problem setters are very lazy, so “[random brute force search](https://www.luogu.com.cn/discuss/show/185420)” plus an “[optimality pruning](https://www.luogu.com.cn/discuss/show/184641)” can pass. Nauuo decides to break all these naive brute-force solutions.", "description": "Nauuo decides to break a brute-force search program, so she constructs a set of testdata. To simplify the problem, you are given the search tree $T$ generated by this testdata. $T$ contains $n$ nodes, numbered $1 \\sim n$ in order, where node $1$ is the root of $T$. The depth of a node is the number of nodes on the simple path from it to node $1$.\n\nThe pseudocode of this program is as follows.\n\n```cpp\nanswer := inf\n\nprocedure dfs(node,depth)\n\tif (node is leaf) \n\t\tanswer := min(answer,depth)\n\t\treturn\n\tif (depth < answer)\n\t\tfor i in children of node\n\t\t\tdfs(i,depth+1)\n\ndfs(1,1)\n```\n\nHere, `:=` denotes assignment.\n\nIn plain words, this brute-force search program traverses the search tree in **depth-first** order. When it reaches a leaf node, it updates the answer using the depth of that leaf node.\n\nMeanwhile, this program has an optimality pruning. That is, when the program reaches any node whose depth equals the current answer, it will not visit this node’s children.\n\nHowever, poor Nauuo does not know the order in which the program visits a node’s children. Therefore, she assumes that for each node, the order of visiting its children is uniformly random among all possible orders. Clearly, there are $\\prod d_i!$ possible cases in total, where $d_i$ is the number of children of node $i$.\n\nNow she wants to know the expected number of nodes visited by this program, to determine whether the program will be broken by her testdata.\n\nTo avoid floating-point errors, take the answer modulo $998244353$. The answer is guaranteed to be representable as an irreducible fraction $\\frac{p}{q}$. You only need to output an $x (0\\leq x < 998244353)$ such that $qx \\equiv p \\pmod {998244353}$.", "inputFormat": "The first line contains an integer $n$.\n\nThe second line contains $n-1$ integers $p_2, p_3 \\cdots p_n$, where $p_i$ is the index of the parent of node $i$.", "outputFormat": "One line with an integer, the required $x$.", "hint": "#### Sample Explanation\n\nFor the first sample, the true answer is $\\frac{7}{2}$.\n\nThere are only two cases in total. If node $1$ traverses node $3$ first, then the program will visit all nodes in the search tree. If node $1$ traverses node $2$ first, then node $4$ will not be visited.\n\nIn the second sample, each non-leaf node has only one child, so there is only one possible case, and all nodes will definitely be visited.\n\nFor the third sample, the true answer is $\\frac{94}{9}$.\n\n---\n\n#### Constraints\n\n**This problem uses bundled test cases.**\n\nFor all test points, it is guaranteed that $1 \\leq n \\leq 3\\times 10^5$, $1 \\leq p_i < i$.\n\n$\\text{Subtask 1 (11 pts)}$ $n \\leq 9$.\n\n$\\text{Subtask 2 (18 pts)}$ $n \\leq 100$.\n\n$\\text{Subtask 3 (19 pts)}$ $n\\leq 10^3$.\n\n$\\text{Subtask 4 (4 pts)}$ $p_i = i-1$.\n\n$\\text{Subtask 5 (8 pts)}$ $p_i =\\lfloor \\frac{i}{2} \\rfloor$.\n\n$\\text{Subtask 6 (40 pts)}$ No special constraints.\n\n---\n\n#### Hint\n\nIf you do not know how to take a fraction modulo a number, you can refer to [here](https://www.luogu.com.cn/problem/P3811).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "最优性剪枝", "background": "Nauuo 是一名出题人。\n\n众所周知，某些出题人非常懒，导致[随便爆搜](https://www.luogu.com.cn/discuss/show/185420)加上一个[最优性剪枝](https://www.luogu.com.cn/discuss/show/184641)就能通过。Nauuo 决定把这些 naive 的暴力都卡掉。", "description": "Nauuo 决定卡一个暴力搜索程序，为此她构建了一组数据。为了简化题目，你将得到这组数据产生的搜索树 $T$。$T$ 中包含 $n$ 个节点，依次编号为 $1 \\sim n$，其中 $1$ 号点是 $T$ 的根节点。一个节点的深度是它到 $1$ 号点的简单路径上的节点个数。\n\n这个程序的伪代码如下\n\n```cpp\nanswer := inf\n\nprocedure dfs(node,depth)\n\tif (node is leaf) \n\t\tanswer := min(answer,depth)\n\t\treturn\n\tif (depth < answer)\n\t\tfor i in children of node\n\t\t\tdfs(i,depth+1)\n\ndfs(1,1)\n```\n\n其中，`:=` 表示赋值运算。\n\n翻译成人话就是说，这个暴力搜索程序将**深度优先**地遍历这棵搜索树，当访问到一个叶节点时，这个程序将用这个叶节点的深度更新答案。\n\n同时，这个程序有一个最优性剪枝，也就是说，当这个程序访问到任意一个深度等于答案的节点时，它将不会再访问这个节点的子节点。\n\n然而，可怜的 Nauuo 并不知道这个程序在某个节点时访问自己子节点的顺序，因此她认为每个节点访问子节点的顺序都是在所有可能的情况中等概率随机的，显然，一共有 $\\prod d_i!$ 种情况，其中 $d_i$ 表示 $i$ 号节点的子节点数量。\n\n现在她想知道这个程序访问到的节点数量的期望，以确定这个程序会不会被自己的数据卡掉。\n\n为了避免浮点误差，答案对 $998244353$ 取模。保证答案能被表示为最简分数 $\\frac{p}{q}$，你只需要输出一个 $x (0\\leq x < 998244353)$ 使得 $qx \\equiv p \\pmod {998244353}$。", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n-1$ 个整数 $p_2, p_3 \\cdots p_n$，其中 $p_i$ 表示 $i$ 号节点的父节点编号。", "outputFormat": "一行一个整数，所求 $x$。", "hint": "#### 样例解释\n\n第一组样例的真实答案为 $\\frac{7}{2}$。\n\n一共只有两种情况，如果 $1$ 号节点先遍历 $3$ 号节点，则程序将访问到搜索树中所有节点。如果 $1$ 号节点先遍历 $2$ 号节点，则 $4$ 号节点不会被访问到。\n\n第二组样例中，每个非叶节点的子节点都是唯一的，因此只有一种可能的情况，所有节点都必然被访问到。\n\n第三组样例的真实答案为 $\\frac{94}{9}$。\n\n---\n\n#### 数据范围\n\n**「本题采用捆绑测试」**\n\n对于所有测试点，保证 $1 \\leq n \\leq 3\\times 10^5$，$1 \\leq p_i < i$。\n\n$\\text{Subtask 1 (11 pts)}$ $n \\leq 9$。\n\n$\\text{Subtask 2 (18 pts)}$ $n \\leq 100$。\n\n$\\text{Subtask 3 (19 pts)}$ $n\\leq 10^3$。\n\n$\\text{Subtask 4 (4 pts)}$ $p_i = i-1$。\n\n$\\text{Subtask 5 (8 pts)}$ $p_i =\\lfloor \\frac{i}{2} \\rfloor$。\n\n$\\text{Subtask 6 (40 pts)}$ 无特殊限制。\n\n---\n\n#### 提示\n\n如果你不知道怎么对分数取模，可以参考[这里](https://www.luogu.com.cn/problem/P3811)。\n\n", "locale": "zh-CN"}}}
{"pid": "P6049", "type": "P", "difficulty": 6, "samples": [["2 2", "6"], ["4 6", "13524"], ["9 34", "857311624"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "数学", "2020", "堆"], "title": "燔祭", "background": "", "description": "计算满足如下条件的带标号有根树数量：\n\n- 这棵树一共有 $n$ 个节点。\n- 每个节点都有一个整数权值，且在区间 $[1,m]$ 内。\n- 每个节点的权值都**不大于**其父节点的权值。\n\n答案可能很大，只需输出答案对 $998244353$ 取模的值。\n\n两棵树 $T_1$ 和 $T_2$ 不同当且仅当两棵树的节点数不同或者根节点不同或者存在一个编号 $i$ 使得 $T_1$ 和 $T_2$ 中 $i$ 号节点的父节点编号不同或者 $i$ 号节点的权值不同。", "inputFormat": "一行两个正整数 $n,m$，意义见题目描述。", "outputFormat": "一行一个整数，所求答案。", "hint": "#### 样例解释\n\n对于第一组样例，\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9b2jvz82.png)\n\n六棵树如上图所示，其中圈内的数字是节点编号，圈外的数字是节点权值。\n\n---\n\n#### 数据范围\n\n**「本题采用捆绑测试」**\n\n对于所有测试点，保证 $1 \\leq n \\leq 400$，$1 \\leq m < 998244353$。\n\n$\\text{Subtask 1 (7 pts)}$ $n = 3,m=3 $。\n\n$\\text{Subtask 2 (11 pts)}$ $m=1$。\n\n$\\text{Subtask 3 (19 pts)}$ $n,m\\leq 6$。\n\n$\\text{Subtask 4 (17 pts)}$ $n \\leq 7$。\n\n$\\text{Subtask 5 (11 pts)}$ $n,m \\leq 50$。\n\n$\\text{Subtask 6 (35 pts)}$ 无特殊限制。\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "燔祭", "background": "", "description": "计算满足如下条件的带标号有根树数量：\n\n- 这棵树一共有 $n$ 个节点。\n- 每个节点都有一个整数权值，且在区间 $[1,m]$ 内。\n- 每个节点的权值都**不大于**其父节点的权值。\n\n答案可能很大，只需输出答案对 $998244353$ 取模的值。\n\n两棵树 $T_1$ 和 $T_2$ 不同当且仅当两棵树的节点数不同或者根节点不同或者存在一个编号 $i$ 使得 $T_1$ 和 $T_2$ 中 $i$ 号节点的父节点编号不同或者 $i$ 号节点的权值不同。", "inputFormat": "一行两个正整数 $n,m$，意义见题目描述。", "outputFormat": "一行一个整数，所求答案。", "hint": "#### 样例解释\n\n对于第一组样例，\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9b2jvz82.png)\n\n六棵树如上图所示，其中圈内的数字是节点编号，圈外的数字是节点权值。\n\n---\n\n#### 数据范围\n\n**「本题采用捆绑测试」**\n\n对于所有测试点，保证 $1 \\leq n \\leq 400$，$1 \\leq m < 998244353$。\n\n$\\text{Subtask 1 (7 pts)}$ $n = 3,m=3 $。\n\n$\\text{Subtask 2 (11 pts)}$ $m=1$。\n\n$\\text{Subtask 3 (19 pts)}$ $n,m\\leq 6$。\n\n$\\text{Subtask 4 (17 pts)}$ $n \\leq 7$。\n\n$\\text{Subtask 5 (11 pts)}$ $n,m \\leq 50$。\n\n$\\text{Subtask 6 (35 pts)}$ 无特殊限制。\n\n", "locale": "zh-CN"}}}
{"pid": "P6050", "type": "P", "difficulty": 5, "samples": [["4 1\n1 4 1 3", "0"], ["4 2\n1 3 2 3\n3 4 3 3\n", "1\nhhll\nh..l\n..ll\nhh.l"], ["6 7\n1 3 2 3\n4 1 4 2\n3 1 4 1\n6 4 5 4\n2 1 3 1\n5 4 6 4\n1 1 2 1", "1\n.hhh..\nh..l.l\n.h...l\nh....l\nh....l\nhhhlll"], ["6 22\n1 3 2 3\n4 1 4 2\n3 1 4 1\n6 4 5 4\n2 1 3 1\n5 4 6 4\n1 1 2 1\n6 2 5 2\n3 1 3 2\n6 4 5 4\n2 1 2 2\n4 6 4 5\n3 6 4 6\n5 4 6 4\n2 6 3 6\n6 4 5 4\n1 6 2 6\n6 5 6 6\n2 6 2 5\n6 6 5 6\n2 5 2 6\n6 6 5 6", "2\nred\n...h..\nhhh...\n.h...l\nh...l.\nh..l..\n.hhh.."]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": [], "title": "[RC-02] 游戏", "background": "", "description": "Shik 大佬发明了一种游戏。这种游戏在 $N \\times N$ （$N$ 为偶数）的网格上进行，如图所示（左上角为 $(1,1)$，右下角为 $(N,N)$）：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/fl8gbzim.png)\n\n这种游戏的规则如下：\n- 初始局面为：在最左边一列和最右边一列的网格上分别放置着红方和蓝方的棋子，在最上面一行左半部分和最下面一行左半部分也放置着红方的棋子，在最上面一行右半部分和最下面一行右半部分也放置着蓝方的棋子；\n- 红方先走，蓝方后走；\n- 有一方只剩下 $N\\div 2$ 颗棋子时，游戏结束，另一方获胜；\n- 有一方无棋可走时，游戏结束，另一方获胜；\n- 每次走棋可以让一颗棋子往上下左右方向移动 $1$ 格，但目标格上不能有棋子；\n- 同时满足以下条件时可以吃掉对方棋子：在一行（或一列上），有且仅有 $N-1$ 颗棋子（当 $N>4$ 时为 $N-2$ 颗也可），其中有 $N-2$ 颗己方棋子（当 $N>4$ 时为 $N-3$ 颗也可），另外 $1$ （当 $N>4$ 时为 $2$ 颗也可）颗棋子为敌方的，我方的棋子全部相邻，敌方棋子全部相邻，并且我方有一颗棋子与敌方相邻，**而且此局面为我方主动走成**，则我方可以把这一列上敌方的棋子全部吃掉。\n\n现在，请你模拟走棋的过程。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2rn7td02.png)\n\n以上为一个不可以吃子的局面。（红吃蓝）\n\n但假如蓝棋本来就在 $(3,3)$，红棋从 $(2,2)$ 走到 $(2,3)$，就可以吃子。\n\n**若不能理解，强烈建议手推一遍样例。**", "inputFormat": "输入文件的第一行有两个整数 $N$ 和 $K$，表示棋盘的大小和走棋的总步数。\n\n接下来 $K$ 行，每行四个整数 $a,b,c,d$，表示某一方的原本在 $(a,b)$ 的棋子走到了 $(c,d)$。从第二行开始算起，第偶数行表示蓝方，第奇数行表示红方。", "outputFormat": "分三种情况输出答案：\n- 数据不合法：输出 $0$。\n- 这一局还没有结束：第一行输出 $1$，接下来 $N$ 行，每行 $N$ 个字符，表示目前的局面状态。用```h```表示红方棋子，```l```表示蓝方棋子，```.```表示此网格为空。若此局面某一方可以吃子，输出吃子后的状态。\n- 这一局已经结束：第一行输出 $2$，第二行输出```red```或```blue```，表示哪一方获胜。第三行至第 $N+2$ 行，输出获胜时的局面。用```h```表示红方棋子，```l```表示蓝方棋子，```.```表示此网格为空。若此局面某一方可以吃子，输出吃子后的状态。**你的程序应该忽略使你判断出胜负那一行之后的所有输入。**", "hint": "样例 4 说明：第 21 歩时，红方已胜，因此第 22 歩的非法移动应该忽略。\n\n对于 $30\\%$ 的数据，不存在吃子的情况；\n\n对于 $60\\%$ 的数据，$N=4$；\n\n对于 $80\\%$ 的数据，$4\\le N\\le 6$；\n\n对于 $100\\%$ 的数据，$4\\le N\\le 10$，$1 \\le K \\le 10^3$。", "locale": "zh-CN", "translations": {"en": {"title": "[RC-02] Game", "background": "", "description": "Expert Shik invented a game. The game is played on an $N \\times N$ grid (where $N$ is even), as shown in the figure (top-left is $(1,1)$, bottom-right is $(N,N)$):\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/fl8gbzim.png)\n\nThe rules are as follows:\n- Initial position: Red pieces are placed on all cells in the leftmost column, and Blue pieces are placed on all cells in the rightmost column. In addition, on the top row and the bottom row, Red pieces are placed on the left half, and Blue pieces are placed on the right half.\n- Red moves first, Blue moves second.\n- When one side has only $N\\div 2$ pieces left, the game ends and the other side wins.\n- When one side has no legal move, the game ends and the other side wins.\n- Each move: move one piece by $1$ cell in one of the four directions (up, down, left, right), and the destination cell must be empty.\n- Capturing is allowed when all of the following are satisfied: in a single row (or a single column), there are exactly $N-1$ pieces (when $N>4$, having $N-2$ pieces is also allowed). Among them, $N-2$ are your own pieces (when $N>4$, having $N-3$ is also allowed), and the remaining $1$ piece (when $N>4$, having $2$ pieces is also allowed) belongs to the opponent. All of your pieces are consecutive, all opponent pieces are consecutive, and at least one of your pieces is adjacent to an opponent piece. **Moreover, this position must be formed by your active move**. Then you may capture (remove) all opponent pieces in that row/column.\n\nNow, please simulate the game process.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2rn7td02.png)\n\nThe position above is one where capturing is not allowed. (Red captures Blue.)\n\nBut if the Blue piece was originally at $(3,3)$, and the Red piece moves from $(2,2)$ to $(2,3)$, then capturing is allowed.\n\n**If you cannot understand this, it is strongly recommended that you manually work through the sample once.**", "inputFormat": "The first line of the input contains two integers $N$ and $K$, representing the board size and the total number of moves.\n\nThe next $K$ lines each contain four integers $a,b,c,d$, meaning that a piece originally at $(a,b)$ moves to $(c,d)$. Counting from the second line of the file, even-numbered lines represent Blue, and odd-numbered lines represent Red.", "outputFormat": "Output the answer in three cases:\n- Invalid testdata: output $0$.\n- The game has not ended yet: output $1$ on the first line. Then output $N$ lines, each with $N$ characters, representing the current board. Use ```h``` for a Red piece, ```l``` for a Blue piece, and ```.``` for an empty cell. If in this position one side can capture, output the state after capturing.\n- The game has ended: output $2$ on the first line. Output ```red``` or ```blue``` on the second line to indicate the winner. From the third line to line $N+2$, output the board position when the winner is determined. Use ```h``` for a Red piece, ```l``` for a Blue piece, and ```.``` for an empty cell. If in this position one side can capture, output the state after capturing. **Your program should ignore all remaining input after the move that allows you to determine the winner.**", "hint": "Explanation for Sample 4: at move 21, Red has already won, so the illegal move at move 22 should be ignored.\n\nFor $30\\%$ of the testdata, there is no capturing.\n\nFor $60\\%$ of the testdata, $N=4$.\n\nFor $80\\%$ of the testdata, $4\\le N\\le 6$.\n\nFor $100\\%$ of the testdata, $4\\le N\\le 10$, $1 \\le K \\le 10^3$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[RC-02] 游戏", "background": "", "description": "Shik 大佬发明了一种游戏。这种游戏在 $N \\times N$ （$N$ 为偶数）的网格上进行，如图所示（左上角为 $(1,1)$，右下角为 $(N,N)$）：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/fl8gbzim.png)\n\n这种游戏的规则如下：\n- 初始局面为：在最左边一列和最右边一列的网格上分别放置着红方和蓝方的棋子，在最上面一行左半部分和最下面一行左半部分也放置着红方的棋子，在最上面一行右半部分和最下面一行右半部分也放置着蓝方的棋子；\n- 红方先走，蓝方后走；\n- 有一方只剩下 $N\\div 2$ 颗棋子时，游戏结束，另一方获胜；\n- 有一方无棋可走时，游戏结束，另一方获胜；\n- 每次走棋可以让一颗棋子往上下左右方向移动 $1$ 格，但目标格上不能有棋子；\n- 同时满足以下条件时可以吃掉对方棋子：在一行（或一列上），有且仅有 $N-1$ 颗棋子（当 $N>4$ 时为 $N-2$ 颗也可），其中有 $N-2$ 颗己方棋子（当 $N>4$ 时为 $N-3$ 颗也可），另外 $1$ （当 $N>4$ 时为 $2$ 颗也可）颗棋子为敌方的，我方的棋子全部相邻，敌方棋子全部相邻，并且我方有一颗棋子与敌方相邻，**而且此局面为我方主动走成**，则我方可以把这一列上敌方的棋子全部吃掉。\n\n现在，请你模拟走棋的过程。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2rn7td02.png)\n\n以上为一个不可以吃子的局面。（红吃蓝）\n\n但假如蓝棋本来就在 $(3,3)$，红棋从 $(2,2)$ 走到 $(2,3)$，就可以吃子。\n\n**若不能理解，强烈建议手推一遍样例。**", "inputFormat": "输入文件的第一行有两个整数 $N$ 和 $K$，表示棋盘的大小和走棋的总步数。\n\n接下来 $K$ 行，每行四个整数 $a,b,c,d$，表示某一方的原本在 $(a,b)$ 的棋子走到了 $(c,d)$。从第二行开始算起，第偶数行表示蓝方，第奇数行表示红方。", "outputFormat": "分三种情况输出答案：\n- 数据不合法：输出 $0$。\n- 这一局还没有结束：第一行输出 $1$，接下来 $N$ 行，每行 $N$ 个字符，表示目前的局面状态。用```h```表示红方棋子，```l```表示蓝方棋子，```.```表示此网格为空。若此局面某一方可以吃子，输出吃子后的状态。\n- 这一局已经结束：第一行输出 $2$，第二行输出```red```或```blue```，表示哪一方获胜。第三行至第 $N+2$ 行，输出获胜时的局面。用```h```表示红方棋子，```l```表示蓝方棋子，```.```表示此网格为空。若此局面某一方可以吃子，输出吃子后的状态。**你的程序应该忽略使你判断出胜负那一行之后的所有输入。**", "hint": "样例 4 说明：第 21 歩时，红方已胜，因此第 22 歩的非法移动应该忽略。\n\n对于 $30\\%$ 的数据，不存在吃子的情况；\n\n对于 $60\\%$ 的数据，$N=4$；\n\n对于 $80\\%$ 的数据，$4\\le N\\le 6$；\n\n对于 $100\\%$ 的数据，$4\\le N\\le 10$，$1 \\le K \\le 10^3$。", "locale": "zh-CN"}}}
{"pid": "P6051", "type": "P", "difficulty": 3, "samples": [["su57jdkjth54hjsns-321d 8 ejre\nerg(&-^%\n\nweruy4uhnd-", "-202\n4"], ["          4532984       d    -1", "4532983"], ["1-1\n1 -1\n1--5\n1-----------1\n-1-1\n--1\n-2.3", "2\n0\n-4\n0\n0\n-1\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串"], "title": "[RC-02] 求和", "background": "", "description": "小 Q 给你了几行字符串，字符串中间包含有一些整数，整数之间可能会有其他字符。你需要输出每行中所有整数的和。如果一个行里面一个数都没有则不要输出。**每两个整数之间一定有间隔字符（见样例 $3$）。**\n\n请注意，题目中的整数都是简单的整数，即：整数前面没有多余的符号。假如数据中有 `.`，视作分隔符。", "inputFormat": "每行一个字符串。", "outputFormat": "对于每一个包含了整数的字符串，输出一行一个数，即其中数的和。", "hint": "【样例解释】\n\n- 第一个样例中，第一行有 $57,54,-321,8$ 几个数，和为 $-202$；第二、三行没有数字；第四行只有一个 $4$，输出 $4$。\n- 第二个样例中只有一行，有两个数，和为 $4532893$。\n- 第三个样例的第一行，由于每两个整数之间一定有间隔字符，所以把 `-` 视为间隔字符，输出 $2$。第五行，第一个数为 $-1$，因此把第二个 `-` 视为间隔字符，和为 $-1+1=0$。第七行，将 `.` 视为间隔字符，和为 $-2+3=1$。\n\n【数据范围】\n\n说明：「条件 A」指数据中不存在除数字、空格、换行、水平制表符之外的其他字符；「条件 B」指每两个数之间一定用且只用一个空格隔开。\n\n**由于数据在 Windows 下制造，行末可能有多余的 `\\r` 字符。请注意。**\n\n对于 $10\\%$ 的数据，满足条件 A 和 B，每行一定有且仅有 $10$ 个数；\n\n对于 $40\\%$ 的数据，满足条件 A 和 B，且不存在空行；\n\n对于 $50\\%$ 的数据，满足条件 A 和 B；\n\n对于 $70\\%$ 的数据，满足条件 A；\n\n对于 $100\\%$ 的数据，不存在除水平制表符、空格、换行外的不可见字符，每行不超过 $1000$ 个字符，每行最多包含 $200$ 个整数，不超过 $100$ 行，每个整数均 $\\in[-10^7,10^7]$。", "locale": "zh-CN", "translations": {"en": {"title": "[RC-02] Summation", "background": "", "description": "Xiao Q gives you several lines of strings. Each string contains some integers, and there may be other characters between the integers. You need to output the sum of all integers in each line. If a line contains no numbers at all, do not output anything for that line. **There is guaranteed to be at least one separator character between every two integers (see sample $3$).**\n\nPlease note that the integers in this problem are simple integers, meaning there are no extra symbols before an integer. If the testdata contains `.`, treat it as a separator.", "inputFormat": "Each line contains one string.", "outputFormat": "For each string that contains integers, output one line with one number: the sum of the integers in that string.", "hint": "【Sample Explanation】\n\n- In the first sample, the first line contains $57,54,-321,8$, and their sum is $-202$. The second and third lines contain no digits. The fourth line contains only one number $4$, so output $4$.\n- In the second sample, there is only one line, containing two numbers, and the sum is $4532893$.\n- In the third sample, for the first line, since there is guaranteed to be a separator character between every two integers, `-` is treated as a separator, so output $2$. For the fifth line, the first number is $-1$, so the second `-` is treated as a separator, and the sum is $-1+1=0$. For the seventh line, treat `.` as a separator, so the sum is $-2+3=1$.\n\n【Constraints】\n\nNote: “Condition A” means there are no other characters in the testdata except digits, spaces, newlines, and horizontal tabs. “Condition B” means every two numbers are separated by exactly one space.\n\n**Since the data is created on Windows, there may be extra `\\r` characters at the end of lines. Please be careful.**\n\nFor $10\\%$ of the data, Conditions A and B are satisfied, and each line has exactly $10$ numbers.\n\nFor $40\\%$ of the data, Conditions A and B are satisfied, and there are no empty lines.\n\nFor $50\\%$ of the data, Conditions A and B are satisfied.\n\nFor $70\\%$ of the data, Condition A is satisfied.\n\nFor $100\\%$ of the data, there are no invisible characters other than horizontal tabs, spaces, and newlines. Each line has at most $1000$ characters, each line contains at most $200$ integers, there are at most $100$ lines, and each integer is $\\in[-10^7,10^7]$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[RC-02] 求和", "background": "", "description": "小 Q 给你了几行字符串，字符串中间包含有一些整数，整数之间可能会有其他字符。你需要输出每行中所有整数的和。如果一个行里面一个数都没有则不要输出。**每两个整数之间一定有间隔字符（见样例 $3$）。**\n\n请注意，题目中的整数都是简单的整数，即：整数前面没有多余的符号。假如数据中有 `.`，视作分隔符。", "inputFormat": "每行一个字符串。", "outputFormat": "对于每一个包含了整数的字符串，输出一行一个数，即其中数的和。", "hint": "【样例解释】\n\n- 第一个样例中，第一行有 $57,54,-321,8$ 几个数，和为 $-202$；第二、三行没有数字；第四行只有一个 $4$，输出 $4$。\n- 第二个样例中只有一行，有两个数，和为 $4532893$。\n- 第三个样例的第一行，由于每两个整数之间一定有间隔字符，所以把 `-` 视为间隔字符，输出 $2$。第五行，第一个数为 $-1$，因此把第二个 `-` 视为间隔字符，和为 $-1+1=0$。第七行，将 `.` 视为间隔字符，和为 $-2+3=1$。\n\n【数据范围】\n\n说明：「条件 A」指数据中不存在除数字、空格、换行、水平制表符之外的其他字符；「条件 B」指每两个数之间一定用且只用一个空格隔开。\n\n**由于数据在 Windows 下制造，行末可能有多余的 `\\r` 字符。请注意。**\n\n对于 $10\\%$ 的数据，满足条件 A 和 B，每行一定有且仅有 $10$ 个数；\n\n对于 $40\\%$ 的数据，满足条件 A 和 B，且不存在空行；\n\n对于 $50\\%$ 的数据，满足条件 A 和 B；\n\n对于 $70\\%$ 的数据，满足条件 A；\n\n对于 $100\\%$ 的数据，不存在除水平制表符、空格、换行外的不可见字符，每行不超过 $1000$ 个字符，每行最多包含 $200$ 个整数，不超过 $100$ 行，每个整数均 $\\in[-10^7,10^7]$。", "locale": "zh-CN"}}}
{"pid": "P6052", "type": "P", "difficulty": 5, "samples": [["100000 1 2", "321"]], "limits": {"time": [600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 700, 700, 700, 700, 700, 700, 700, 700], "memory": [15360, 15360, 15360, 15360, 15360, 15360, 15360, 15360, 15360, 15360, 15360, 15360, 15360, 15360, 15360, 15360, 15360, 15360, 15360, 15360]}, "tags": ["O2优化"], "title": "[RC-02] yltx 数对", "background": "yltx 又双叒叕出自己不会做的题了……", "description": "yltx 定义若一个**素数**数对 $(x,y)$ 满足 $x\\times y-3\\times (x-y)$ 是素数，则称其为一个 yltx 数对。\n\n他给了你 $T$ 对 $(x,y)$，请你检查他们是否为 yltx 数对。\n\n数据以种子$(x_0,y_0)$的形式给出。\n\n执行 $T$ 次 $x_0\\leftarrow (7x_0+13)\\ \\mathrm{xor}\\ (x_0\\div 13-7)$，第 $i$ 次执行得到的数先取模 $10^4$、加上 $10^4$、取模 $10^4$，再加 $1$，就得到了第 $i$ 组数据的 $x$。这里的除法就是整除，把 $x_0$ 视作 32 位有符号整数。\n\n用同样的方法得到 $y$。\n\n数据生成模板：\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint T,x_0,y_0;\nint main() {\n\tscanf(\"%d%d%d\",&T,&x_0,&y_0);\n\twhile(T--){\n\t\tx_0=((7*x_0+13)^(x_0/13-7));\n\t\ty_0=((7*y_0+13)^(y_0/13-7));\n\t\tint x=(x_0%10000+10000)%10000+1,y=(y_0%10000+10000)%10000+1;\n\t\t//x,y即为一组(x,y)。\n\t}\n\treturn 0;\n}\n```", "inputFormat": "第一行三个整数 $T,x_0,y_0$。\n\n", "outputFormat": "$1$行，输出有几对数是 yltx 数对。", "hint": "各测试点数据范围如下：\n\n| 测试点 | T | Subtask |\n| :---: | :---: | :---: |\n| 1 | $\\le10$ | 1 |\n| 2 | $\\le20$ | 1 |\n| 3 | $\\le50$ | 1 |\n| 4 | $\\le100$ | 1 |\n| 5 | $\\le500$ | 1 |\n| 6 | $\\le1000$ | 1 |\n| 7 | $\\le5000$ | 2 |\n| 8 | $\\le10^4$ | 2 |\n| 9 | $\\le5\\times10^4$ | 2 |\n| 10 | $\\le4\\times10^5$ | 2 |\n| 11 | $\\le10^6$ | 2 |\n| 12 | $\\le5\\times10^6$ | 2 |\n| 13 | $\\le4\\times10^7$ | 3 |\n| 14 | $\\le4\\times10^7$ | 3 |\n| 15 | $\\le4\\times10^7$ | 3 |\n| 16 | $\\le4\\times10^7$ | 3 |\n| 17 | $\\le4\\times10^7$ | 3 |\n| 18 | $\\le4\\times10^7$ | 3 |\n| 19 | $\\le4\\times10^7$ | 3 |\n| 20 | $\\le4\\times10^7$ | 3 |\n\n各Subtask捆绑测试。\n\n本题开放数据下载，但希望您能用数据做正确的事。", "locale": "zh-CN", "translations": {"en": {"title": "[RC-02] yltx Prime Pair", "background": "yltx has once again come up with a problem that they cannot solve...", "description": "yltx defines that if a **prime** pair $(x,y)$ satisfies that $x\\times y-3\\times (x-y)$ is prime, then it is called a yltx pair.\n\nHe gives you $T$ pairs $(x,y)$. Please check whether they are yltx pairs.\n\nThe data is given in the form of a seed $(x_0,y_0)$.\n\nPerform $T$ times of $x_0\\leftarrow (7x_0+13)\\ \\mathrm{xor}\\ (x_0\\div 13-7)$. For the value obtained in the $i$-th execution, first take modulo $10^4$, add $10^4$, take modulo $10^4$ again, then add $1$, and you get the $x$ of the $i$-th test case. Here division means integer division, and $x_0$ is treated as a 32-bit signed integer.\n\nUse the same method to get $y$.\n\nData generation template:\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint T,x_0,y_0;\nint main() {\n\tscanf(\"%d%d%d\",&T,&x_0,&y_0);\n\twhile(T--){\n\t\tx_0=((7*x_0+13)^(x_0/13-7));\n\t\ty_0=((7*y_0+13)^(y_0/13-7));\n\t\tint x=(x_0%10000+10000)%10000+1,y=(y_0%10000+10000)%10000+1;\n\t\t//x,y即为一组(x,y)。\n\t}\n\treturn 0;\n}\n```", "inputFormat": "The first line contains three integers $T,x_0,y_0$.", "outputFormat": "$1$ line. Output how many pairs are yltx pairs.", "hint": "The Constraints for each test point are as follows:\n\n| Test Point | T | Subtask |\n| :---: | :---: | :---: |\n| 1 | $\\le10$ | 1 |\n| 2 | $\\le20$ | 1 |\n| 3 | $\\le50$ | 1 |\n| 4 | $\\le100$ | 1 |\n| 5 | $\\le500$ | 1 |\n| 6 | $\\le1000$ | 1 |\n| 7 | $\\le5000$ | 2 |\n| 8 | $\\le10^4$ | 2 |\n| 9 | $\\le5\\times10^4$ | 2 |\n| 10 | $\\le4\\times10^5$ | 2 |\n| 11 | $\\le10^6$ | 2 |\n| 12 | $\\le5\\times10^6$ | 2 |\n| 13 | $\\le4\\times10^7$ | 3 |\n| 14 | $\\le4\\times10^7$ | 3 |\n| 15 | $\\le4\\times10^7$ | 3 |\n| 16 | $\\le4\\times10^7$ | 3 |\n| 17 | $\\le4\\times10^7$ | 3 |\n| 18 | $\\le4\\times10^7$ | 3 |\n| 19 | $\\le4\\times10^7$ | 3 |\n| 20 | $\\le4\\times10^7$ | 3 |\n\nEach Subtask is tested as a bundled group of test points.\n\nThis problem provides testdata for download, but we hope you will use the data to do the right thing.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[RC-02] yltx 数对", "background": "yltx 又双叒叕出自己不会做的题了……", "description": "yltx 定义若一个**素数**数对 $(x,y)$ 满足 $x\\times y-3\\times (x-y)$ 是素数，则称其为一个 yltx 数对。\n\n他给了你 $T$ 对 $(x,y)$，请你检查他们是否为 yltx 数对。\n\n数据以种子$(x_0,y_0)$的形式给出。\n\n执行 $T$ 次 $x_0\\leftarrow (7x_0+13)\\ \\mathrm{xor}\\ (x_0\\div 13-7)$，第 $i$ 次执行得到的数先取模 $10^4$、加上 $10^4$、取模 $10^4$，再加 $1$，就得到了第 $i$ 组数据的 $x$。这里的除法就是整除，把 $x_0$ 视作 32 位有符号整数。\n\n用同样的方法得到 $y$。\n\n数据生成模板：\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint T,x_0,y_0;\nint main() {\n\tscanf(\"%d%d%d\",&T,&x_0,&y_0);\n\twhile(T--){\n\t\tx_0=((7*x_0+13)^(x_0/13-7));\n\t\ty_0=((7*y_0+13)^(y_0/13-7));\n\t\tint x=(x_0%10000+10000)%10000+1,y=(y_0%10000+10000)%10000+1;\n\t\t//x,y即为一组(x,y)。\n\t}\n\treturn 0;\n}\n```", "inputFormat": "第一行三个整数 $T,x_0,y_0$。\n\n", "outputFormat": "$1$行，输出有几对数是 yltx 数对。", "hint": "各测试点数据范围如下：\n\n| 测试点 | T | Subtask |\n| :---: | :---: | :---: |\n| 1 | $\\le10$ | 1 |\n| 2 | $\\le20$ | 1 |\n| 3 | $\\le50$ | 1 |\n| 4 | $\\le100$ | 1 |\n| 5 | $\\le500$ | 1 |\n| 6 | $\\le1000$ | 1 |\n| 7 | $\\le5000$ | 2 |\n| 8 | $\\le10^4$ | 2 |\n| 9 | $\\le5\\times10^4$ | 2 |\n| 10 | $\\le4\\times10^5$ | 2 |\n| 11 | $\\le10^6$ | 2 |\n| 12 | $\\le5\\times10^6$ | 2 |\n| 13 | $\\le4\\times10^7$ | 3 |\n| 14 | $\\le4\\times10^7$ | 3 |\n| 15 | $\\le4\\times10^7$ | 3 |\n| 16 | $\\le4\\times10^7$ | 3 |\n| 17 | $\\le4\\times10^7$ | 3 |\n| 18 | $\\le4\\times10^7$ | 3 |\n| 19 | $\\le4\\times10^7$ | 3 |\n| 20 | $\\le4\\times10^7$ | 3 |\n\n各Subtask捆绑测试。\n\n本题开放数据下载，但希望您能用数据做正确的事。", "locale": "zh-CN"}}}
{"pid": "P6053", "type": "P", "difficulty": 6, "samples": [["5 4 4\n0 0 2 2 1\n1 2\n1 3\n2 4\n2 5\n1 1\n1 1\n1 1\n2 3 0\n4 3 3\n5 1\n1 2\n3 1 2\n", "3\n3\n3\n0\n3\n0\n2\n"], ["10 8 8\n5 6 2 1 0 4 0 0 0 3\n1 2\n1 3\n2 4\n2 5\n3 6\n3 7\n4 8\n4 9\n5 10\n3 10 9\n2 1 6\n1 5\n1 4\n1 7\n1 7\n5 1\n1 1\n3 1 5\n1 7\n1 9\n2 5 0\n4 9 6\n1 10\n4 10 7\n5 1\n", "2\n3\n3\n3\n3\n2\n3\n1\n3\n7\n7\n7\n1\n0\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1800, 2300], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "[RC-02] XOR", "background": "FangZeLi 喜欢异或，所以就有了这道题（然而这并不是他出这种题的理由）。", "description": "**注意，本题中一切 $\\sum$ 均表示求异或和！**\n\n一棵 $n$ 个节点，$n-1$ 条边的有根树，初始时以 $1$ 节点为根。\n\n这棵树上的每个节点 $i$ 都有其点权 $V_{i}$。\n\n令函数 $\\operatorname{Xor}(x)=\\sum_{y\\in  \\operatorname{Subtree}(x)}{V_{y}}$，其中 $\\operatorname{Subtree}(x)$ 表示 $x$ 的子树。\n\n现需支持以下五种操作：\n\n1. `1 x`，表示将 $x$ 换为根，且查询 $\\sum_{i=1}^{n}{\\operatorname{Xor}(i)}$。\n2. `2 x y`，表示令 $V_{x}=y$。\n3. `3 x y` ，表示查询 $\\operatorname{LCA}(x,y)$。\n4. `4 x y`，表示查询 $x$ 到 $y$ 路径上的点的点权异或和。\n5. `5 x`，表示查询 $\\operatorname{Xor}(x)$。", "inputFormat": "第一行三个整数，$n,m,q$，分别表示节点数，$1$ 操作个数，其余操作个数。\n\n接下来一行 $n$ 个整数，表示 $V_{1}\\dots V_{n}$。\n\n接下来 $n-1$ 行，每行两个整数 $x,y$，表示 $x$ 和 $y$ 间有一条边。\n\n接下来 $m+q$ 行，每行两到三个整数，第一个数为操作序号，接下来为相应的操作。", "outputFormat": "若干行，表示 $1,3,4,5$ 操作的结果。", "hint": "对于所有数据，保证 $100\\le n,m,q\\le 10^6$，$0\\le V_i\\le 2^{31}-1$。详细数据范围如下表。\n\n| 测试点编号 | 时间限制/秒 | $n$                | $m$                | $q$                 |\n| :-----: | :--------: | :------------------: | :------------------: | :-------------------: |\n| $1$   |  $1$     | $ 100 $            | $ 100 $            | $ 4 \\times 10 ^ 5 $ |\n| $2,3$   |$1$     | $ 100 $            | $10^ { 6 }$ | $ 4 \\times 10 ^ 5 $ |\n| $4,5$   | $1$     | $ 10 ^ 4$ | $100$              | $ 4 \\times 10 ^ 5 $ |\n| $6,7,8$ |  $ 1 $   | $ 10 ^ 4$ | $10 ^ 6$    | $ 4 \\times 10 ^ 5 $ |\n| $9$    | $ 1.8 $ | $ 10 ^ 6$ | $100$              | $ 10^6$      |\n| $10$   | $ 2.3 $ | $ 10 ^ 6$ | $ 10^6$     | $ 10 ^ 6$    |", "locale": "zh-CN", "translations": {"en": {"title": "[RC-02] XOR", "background": "FangZeLi likes XOR, so this problem was created (though that is not really why he makes such problems).", "description": "**Note: In this problem, every $\\sum$ means taking the XOR-sum.**\n\nThere is a rooted tree with $n$ nodes and $n-1$ edges. Initially, node $1$ is the root.\n\nEach node $i$ on the tree has a node value $V_{i}$.\n\nDefine the function $\\operatorname{Xor}(x)=\\sum_{y\\in \\operatorname{Subtree}(x)}{V_{y}}$, where $\\operatorname{Subtree}(x)$ denotes the subtree of $x$.\n\nYou need to support the following five operations:\n\n1. `1 x`: Make $x$ the root, and query $\\sum_{i=1}^{n}{\\operatorname{Xor}(i)}$.\n2. `2 x y`: Set $V_{x}=y$.\n3. `3 x y`: Query $\\operatorname{LCA}(x,y)$.\n4. `4 x y`: Query the XOR-sum of node values along the path from $x$ to $y$.\n5. `5 x`: Query $\\operatorname{Xor}(x)$.", "inputFormat": "The first line contains three integers $n,m,q$, representing the number of nodes, the number of operation type $1$, and the number of the remaining operations.\n\nThe next line contains $n$ integers, representing $V_{1}\\dots V_{n}$.\n\nThe next $n-1$ lines each contain two integers $x,y$, indicating that there is an edge between $x$ and $y$.\n\nThe next $m+q$ lines each contain two or three integers. The first number is the operation type, followed by the parameters of that operation.", "outputFormat": "Output several lines, each being the result of operations $1,3,4,5$.", "hint": "For all testdata, it is guaranteed that $100\\le n,m,q\\le 10^6$, $0\\le V_i\\le 2^{31}-1$. The detailed Constraints are shown in the table below.\n\n| Test Point ID | Time Limit / s | $n$ | $m$ | $q$ |\n| :-----: | :--------: | :------------------: | :------------------: | :-------------------: |\n| $1$ | $1$ | $ 100 $ | $ 100 $ | $ 4 \\times 10 ^ 5 $ |\n| $2,3$ | $1$ | $ 100 $ | $10^ { 6 }$ | $ 4 \\times 10 ^ 5 $ |\n| $4,5$ | $1$ | $ 10 ^ 4$ | $100$ | $ 4 \\times 10 ^ 5 $ |\n| $6,7,8$ | $ 1 $ | $ 10 ^ 4$ | $10 ^ 6$ | $ 4 \\times 10 ^ 5 $ |\n| $9$ | $ 1.8 $ | $ 10 ^ 6$ | $100$ | $ 10^6$ |\n| $10$ | $ 2.3 $ | $ 10 ^ 6$ | $ 10^6$ | $ 10 ^ 6$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[RC-02] XOR", "background": "FangZeLi 喜欢异或，所以就有了这道题（然而这并不是他出这种题的理由）。", "description": "**注意，本题中一切 $\\sum$ 均表示求异或和！**\n\n一棵 $n$ 个节点，$n-1$ 条边的有根树，初始时以 $1$ 节点为根。\n\n这棵树上的每个节点 $i$ 都有其点权 $V_{i}$。\n\n令函数 $\\operatorname{Xor}(x)=\\sum_{y\\in  \\operatorname{Subtree}(x)}{V_{y}}$，其中 $\\operatorname{Subtree}(x)$ 表示 $x$ 的子树。\n\n现需支持以下五种操作：\n\n1. `1 x`，表示将 $x$ 换为根，且查询 $\\sum_{i=1}^{n}{\\operatorname{Xor}(i)}$。\n2. `2 x y`，表示令 $V_{x}=y$。\n3. `3 x y` ，表示查询 $\\operatorname{LCA}(x,y)$。\n4. `4 x y`，表示查询 $x$ 到 $y$ 路径上的点的点权异或和。\n5. `5 x`，表示查询 $\\operatorname{Xor}(x)$。", "inputFormat": "第一行三个整数，$n,m,q$，分别表示节点数，$1$ 操作个数，其余操作个数。\n\n接下来一行 $n$ 个整数，表示 $V_{1}\\dots V_{n}$。\n\n接下来 $n-1$ 行，每行两个整数 $x,y$，表示 $x$ 和 $y$ 间有一条边。\n\n接下来 $m+q$ 行，每行两到三个整数，第一个数为操作序号，接下来为相应的操作。", "outputFormat": "若干行，表示 $1,3,4,5$ 操作的结果。", "hint": "对于所有数据，保证 $100\\le n,m,q\\le 10^6$，$0\\le V_i\\le 2^{31}-1$。详细数据范围如下表。\n\n| 测试点编号 | 时间限制/秒 | $n$                | $m$                | $q$                 |\n| :-----: | :--------: | :------------------: | :------------------: | :-------------------: |\n| $1$   |  $1$     | $ 100 $            | $ 100 $            | $ 4 \\times 10 ^ 5 $ |\n| $2,3$   |$1$     | $ 100 $            | $10^ { 6 }$ | $ 4 \\times 10 ^ 5 $ |\n| $4,5$   | $1$     | $ 10 ^ 4$ | $100$              | $ 4 \\times 10 ^ 5 $ |\n| $6,7,8$ |  $ 1 $   | $ 10 ^ 4$ | $10 ^ 6$    | $ 4 \\times 10 ^ 5 $ |\n| $9$    | $ 1.8 $ | $ 10 ^ 6$ | $100$              | $ 10^6$      |\n| $10$   | $ 2.3 $ | $ 10 ^ 6$ | $ 10^6$     | $ 10 ^ 6$    |", "locale": "zh-CN"}}}
{"pid": "P6054", "type": "P", "difficulty": 6, "samples": [["4\n3 2 4 0\n10 10 10 20\n0.3 0.5 0.7 0.4\n0.2 0.6 0.2 0.2\n0.7 0.1 0.8 0.2\n0.5 0.5 0.5 0.5\n0.2 0.5 0.3 0.6\n0.3 0.5 0.4 0.1\n3 2 4 1\n10 10 10 20\n0.3 0.5 0.7 0.4\n0.2 0.6 0.2 0.2\n0.7 0.1 0.8 0.2\n0.5 0.5 0.5 0.5\n0.2 0.5 0.3 0.6\n0.3 0.5 0.4 0.1\n2 3 1\n3 2 4 1\n10 10 10 20\n0.3 0.5 0.7 0.4\n0.2 0.6 0.2 0.2\n0.7 0.1 0.8 0.2\n0.5 0.5 0.5 0.5\n0.2 0.5 0.3 0.6\n0.3 0.5 0.4 0.1\n1 2 1\n3 2 4 2\n10 10 10 20\n0.3 0.5 0.7 0.4\n0.2 0.6 0.2 0.2\n0.7 0.1 0.8 0.2\n0.5 0.5 0.5 0.5\n0.2 0.5 0.3 0.6\n0.3 0.5 0.4 0.1\n1 2 1\n2 3 1", "15.1460\n18.5340\n18.7560\n-1"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["网络流", "Special Judge", "O2优化", "最小割", "期望"], "title": "[RC-02] 开门大吉", "background": "", "description": "$n$ 位选手去参加节目“开门大吉”。共有 $m$ 套题，每套题包含 $p$ 个题目，第 $i$ 位选手答对第 $j$ 套题中第 $k$ 道的概率为 $f_{i,j,k}$。若某题答错则该选手的答题流程将直接结束。\n\n若一位选手答对第 $i$ 题，会在已得到奖励的基础上，再得到 $c_i$ 元奖励。选手总是从第一道开始，按顺序答题的。\n\n同时，为了防止过多的选手做同一套题，还有 $y$ 条形如“第 $i$ 位选手的套题编号必须至少比第 $j$ 位的大 $k$”的限制。\n\n你需要给每一位选手分配一套题（不同选手可以相同），使得所有人的期望奖励和最小。", "inputFormat": "输入包含多组数据。第一行是一个整数 $T$，为数据组数。\n\n对于每组数据，第一行四个整数 $n,m,p,y$。\n\n接下来一行 $p$ 个整数，第 $i$ 个为 $c_i$。 \n\n接下来 $m$ 个 $n\\times p$ 的矩阵，第 $j$ 个矩阵中第 $i$ 行第 $k$ 个实数为 $f_{i,j,k}$。\n\n接下来 $y$ 行，每行三个整数 $i,j,k$（$1\\le i,j\\le n$，$-m<k<m$），描述一条限制。", "outputFormat": "对于每组数据，输出一个实数，为答案。无解输出 `-1`。\n\n本题有 Special Judge，答案误差在 $5\\times 10^{-4}$ 以内都算对。\n\n由于 SPJ 敏感，请在每组数据末尾都输出一个换行符，并不要再输出其它字符。", "hint": "【样例解释】\n\n这里只解释第二组数据。\n\n一共只有两套题，而第二个人的套题编号大于第三个人，因此第二个人一定是选第二套，第三个人选第一套。\n\n第二个人选第二套，期望支出：$0.2\\times (1-0.5)\\times 10+0.2\\times 0.5 \\times (1-0.3) \\times 20+0.2\\times 0.5 \\times 0.3\\times (1-0.6)  \\times 30+0.2\\times 0.5 \\times 0.3\\times 0.6  \\times 50=3.66$。\n\n其他人的计算方法类似。\n\n【数据范围】\n\n**本题捆绑测试。**\n\n对于所有数据，$1\\le n,m,p\\le 80$，$0\\le y\\le 10^3$，$0\\le f_{i,j,k} \\le 1$，$0\\le c_i\\le 10^5$，$1 \\le T\\le 50$。保证每个测试点的输入数据大小小于 $10\\text{MB}$。\n\nSubtask 1（20 pts）：$n,m,p,y\\le 7$；\n\nSubtask 2（20 pts）：$T\\le 6$，$y=0$；\n\nSubtask 3（20 pts）：$n,m,p\\le 30$，$y\\le 200$；\n\nSubtask 4（20 pts）：$T=1$；\n\nSubtask 5（20 pts）：$T\\le 5$。", "locale": "zh-CN", "translations": {"en": {"title": "[RC-02] Open the Door and Win Big", "background": "", "description": "There are $n$ contestants participating in the show “Open the Door and Win Big”. There are $m$ sets of questions. Each set contains $p$ questions. The probability that contestant $i$ answers question $k$ in set $j$ correctly is $f_{i,j,k}$. If a contestant answers any question wrong, their answering process ends immediately.\n\nIf a contestant answers question $i$ correctly, they receive an additional reward of $c_i$ yuan on top of the rewards already obtained. Contestants always start from the first question and answer in order.\n\nAt the same time, to prevent too many contestants from doing the same set, there are also $y$ constraints of the form: “the set index of contestant $i$ must be at least $k$ larger than that of contestant $j$”.\n\nYou need to assign one set of questions to each contestant (different contestants may be assigned the same set), so that the sum of everyone’s expected rewards is minimized.", "inputFormat": "The input contains multiple test cases. The first line is an integer $T$, the number of test cases.\n\nFor each test case, the first line contains four integers $n,m,p,y$.\n\nThe next line contains $p$ integers, where the $i$-th one is $c_i$.\n\nThen follow $m$ matrices of size $n\\times p$. In the $j$-th matrix, the real number in row $i$ and column $k$ is $f_{i,j,k}$.\n\nThen follow $y$ lines, each containing three integers $i,j,k$ ($1\\le i,j\\le n$, $-m<k<m$), describing one constraint.", "outputFormat": "For each test case, output one real number, the answer. If there is no solution, output `-1`.\n\nThis problem uses a Special Judge. Any answer with an error within $5\\times 10^{-4}$ is accepted.\n\nBecause the SPJ is sensitive, please output a newline at the end of each test case, and do not output any other characters.", "hint": "[Sample Explanation]\n\nOnly the second test case is explained here.\n\nThere are only two sets of questions, and the set index of the second person is larger than that of the third person. Therefore, the second person must choose the second set, and the third person chooses the first set.\n\nIf the second person chooses the second set, the expected cost is: $0.2\\times (1-0.5)\\times 10+0.2\\times 0.5 \\times (1-0.3) \\times 20+0.2\\times 0.5 \\times 0.3\\times (1-0.6)  \\times 30+0.2\\times 0.5 \\times 0.3\\times 0.6  \\times 50=3.66$.\n\nThe calculation method for other people is similar.\n\n[Constraints]\n\n**This problem uses bundled testdata.**\n\nFor all data, $1\\le n,m,p\\le 80$, $0\\le y\\le 10^3$, $0\\le f_{i,j,k} \\le 1$, $0\\le c_i\\le 10^5$, $1 \\le T\\le 50$. It is guaranteed that the input size of each test point is less than $10\\text{MB}$.\n\nSubtask 1 (20 pts): $n,m,p,y\\le 7$.\n\nSubtask 2 (20 pts): $T\\le 6$, $y=0$.\n\nSubtask 3 (20 pts): $n,m,p\\le 30$, $y\\le 200$.\n\nSubtask 4 (20 pts): $T=1$.\n\nSubtask 5 (20 pts): $T\\le 5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[RC-02] 开门大吉", "background": "", "description": "$n$ 位选手去参加节目“开门大吉”。共有 $m$ 套题，每套题包含 $p$ 个题目，第 $i$ 位选手答对第 $j$ 套题中第 $k$ 道的概率为 $f_{i,j,k}$。若某题答错则该选手的答题流程将直接结束。\n\n若一位选手答对第 $i$ 题，会在已得到奖励的基础上，再得到 $c_i$ 元奖励。选手总是从第一道开始，按顺序答题的。\n\n同时，为了防止过多的选手做同一套题，还有 $y$ 条形如“第 $i$ 位选手的套题编号必须至少比第 $j$ 位的大 $k$”的限制。\n\n你需要给每一位选手分配一套题（不同选手可以相同），使得所有人的期望奖励和最小。", "inputFormat": "输入包含多组数据。第一行是一个整数 $T$，为数据组数。\n\n对于每组数据，第一行四个整数 $n,m,p,y$。\n\n接下来一行 $p$ 个整数，第 $i$ 个为 $c_i$。 \n\n接下来 $m$ 个 $n\\times p$ 的矩阵，第 $j$ 个矩阵中第 $i$ 行第 $k$ 个实数为 $f_{i,j,k}$。\n\n接下来 $y$ 行，每行三个整数 $i,j,k$（$1\\le i,j\\le n$，$-m<k<m$），描述一条限制。", "outputFormat": "对于每组数据，输出一个实数，为答案。无解输出 `-1`。\n\n本题有 Special Judge，答案误差在 $5\\times 10^{-4}$ 以内都算对。\n\n由于 SPJ 敏感，请在每组数据末尾都输出一个换行符，并不要再输出其它字符。", "hint": "【样例解释】\n\n这里只解释第二组数据。\n\n一共只有两套题，而第二个人的套题编号大于第三个人，因此第二个人一定是选第二套，第三个人选第一套。\n\n第二个人选第二套，期望支出：$0.2\\times (1-0.5)\\times 10+0.2\\times 0.5 \\times (1-0.3) \\times 20+0.2\\times 0.5 \\times 0.3\\times (1-0.6)  \\times 30+0.2\\times 0.5 \\times 0.3\\times 0.6  \\times 50=3.66$。\n\n其他人的计算方法类似。\n\n【数据范围】\n\n**本题捆绑测试。**\n\n对于所有数据，$1\\le n,m,p\\le 80$，$0\\le y\\le 10^3$，$0\\le f_{i,j,k} \\le 1$，$0\\le c_i\\le 10^5$，$1 \\le T\\le 50$。保证每个测试点的输入数据大小小于 $10\\text{MB}$。\n\nSubtask 1（20 pts）：$n,m,p,y\\le 7$；\n\nSubtask 2（20 pts）：$T\\le 6$，$y=0$；\n\nSubtask 3（20 pts）：$n,m,p\\le 30$，$y\\le 200$；\n\nSubtask 4（20 pts）：$T=1$；\n\nSubtask 5（20 pts）：$T\\le 5$。", "locale": "zh-CN"}}}
