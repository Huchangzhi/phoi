{"pid": "P4098", "type": "P", "difficulty": 6, "samples": [["5 \n9 2 1 4 7", "14"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2013", "各省省选", "河北", "枚举", "可持久化", "字典树 Trie"], "title": "[HEOI2013] ALO", "background": "", "description": "Welcome to ALO (Arithmetic and Logistic Online）。这是一个 VR MMORPG，如名字所见，到处充满了数学的谜题。\n\n现在你拥有 $n$ 颗宝石，第 $i$ 颗宝石有一个能量密度，记为 $a_i$，这些宝石的能量密度**两两不同**。现在你可以选取**连续**的一些宝石（必须多于一个）进行融合，设他们的能量密度为 $a_i,a_{i+1},\\cdots,a_j$，则融合而成的宝石的能量密度为这些宝石中能量密度的次大值与其他任意一颗宝石的能量密度按位异或的值的最大值。即，假设该段宝石能量密度次大值为 $k$，则生成的宝石的能量密度为 $\\max\\{k\\oplus a_p\\mid a_p\\ne k, i\\le p\\le j\\}$。\n\n现在你需要知道你怎么选取需要融合的宝石，才能使生成的宝石能量密度最大。", "inputFormat": "第一行，一个整数 $n$，表示宝石个数。\n\n第二行，$n$ 个整数，分别表示 $a_1$ 至 $a_n$，表示每颗宝石的能量密度，保证对于 $i\\ne j$ 有 $a_i\\ne a_j$。", "outputFormat": "输出一行一个整数，表示最大能生成的宝石能量密度。\n", "hint": "### 样例解释\n\n选择区间 $[1,5]$，最大值为 $7\\oplus 9 = 14$。\n\n### 数据规模与约定\n\n- 对于 $20\\%$ 的数据有 $n\\le 100$；\n- 对于 $50\\%$ 的数据有 $n\\le 2000$；\n- 对于 $100\\%$ 的数据有 $1\\le n\\le 50000$，$0\\le a_i\\le 10^9$。\n\n2023.4.28：添加两组 hack 数据，不计分。", "locale": "zh-CN", "translations": {"en": {"title": "[HEOI2013] ALO", "background": "", "description": "Welcome to ALO (Arithmetic and Logistic Online). This is a VR MMORPG. As the name suggests, it is full of math puzzles.\n\nYou have $n$ gems. The $i$-th gem has an energy density $a_i$, and all energy densities are pairwise distinct. You may select a contiguous segment of gems (with at least two gems) to fuse. Suppose their energy densities are $a_i, a_{i+1}, \\cdots, a_j$. The fused gem’s energy density is the maximum value of the bitwise XOR between the second largest energy density in this segment and any other gem in the same segment. That is, if the second largest in this segment is $k$, the generated energy density equals $\\max\\{k \\oplus a_p \\mid a_p \\ne k,\\ i \\le p \\le j\\}$.\n\nFind how to choose the segment to maximize the fused gem’s energy density.", "inputFormat": "The first line contains an integer $n$, the number of gems.\n\nThe second line contains $n$ integers, $a_1$ through $a_n$, the energy density of each gem. It is guaranteed that for $i \\ne j$ we have $a_i \\ne a_j$.", "outputFormat": "Output one integer, the maximum possible fused gem energy density.", "hint": "### Sample Explanation\n\nChoose the segment $[1, 5]$. The maximum is $7 \\oplus 9 = 14$.\n\n### Constraints\n\n- For $20\\%$ of the testdata, $n \\le 100$.\n- For $50\\%$ of the testdata, $n \\le 2000$.\n- For $100\\%$ of the testdata, $1 \\le n \\le 50000$, $0 \\le a_i \\le 10^9$.\n\n2023-04-28: Added two hack testdata, not scored.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HEOI2013] ALO", "background": "", "description": "Welcome to ALO (Arithmetic and Logistic Online）。这是一个 VR MMORPG，如名字所见，到处充满了数学的谜题。\n\n现在你拥有 $n$ 颗宝石，第 $i$ 颗宝石有一个能量密度，记为 $a_i$，这些宝石的能量密度**两两不同**。现在你可以选取**连续**的一些宝石（必须多于一个）进行融合，设他们的能量密度为 $a_i,a_{i+1},\\cdots,a_j$，则融合而成的宝石的能量密度为这些宝石中能量密度的次大值与其他任意一颗宝石的能量密度按位异或的值的最大值。即，假设该段宝石能量密度次大值为 $k$，则生成的宝石的能量密度为 $\\max\\{k\\oplus a_p\\mid a_p\\ne k, i\\le p\\le j\\}$。\n\n现在你需要知道你怎么选取需要融合的宝石，才能使生成的宝石能量密度最大。", "inputFormat": "第一行，一个整数 $n$，表示宝石个数。\n\n第二行，$n$ 个整数，分别表示 $a_1$ 至 $a_n$，表示每颗宝石的能量密度，保证对于 $i\\ne j$ 有 $a_i\\ne a_j$。", "outputFormat": "输出一行一个整数，表示最大能生成的宝石能量密度。\n", "hint": "### 样例解释\n\n选择区间 $[1,5]$，最大值为 $7\\oplus 9 = 14$。\n\n### 数据规模与约定\n\n- 对于 $20\\%$ 的数据有 $n\\le 100$；\n- 对于 $50\\%$ 的数据有 $n\\le 2000$；\n- 对于 $100\\%$ 的数据有 $1\\le n\\le 50000$，$0\\le a_i\\le 10^9$。\n\n2023.4.28：添加两组 hack 数据，不计分。", "locale": "zh-CN"}}}
{"pid": "P4099", "type": "P", "difficulty": 6, "samples": [["2 \n5 \n0 < 2 \n1 < 2 \n2 < 3 \n2 < 4 \n4 \n0 < 1 \n0 < 2 \n0 < 3", "4 \n6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2013", "各省省选", "河北", "枚举", "拓扑排序", "前缀和"], "title": "[HEOI2013] SAO", "background": null, "description": "Welcome to SAO ( Strange and Abnormal Online)。这是一个 VR MMORPG， 含有 $n$ 个关卡。但是，挑战不同关卡的顺序是一个很大的问题。\n\n某款游戏有 $n-1$ 个对于挑战关卡的限制，诸如第 $i$ 个关卡必须在第 $j$ 个关卡前挑战，或者完成了第 $k$ 个关卡才能挑战第 $l$ 个关卡。并且，如果不考虑限制的方向性，那么在这 $n-1$ 个限制的情况下，任何两个关卡都存在某种程度的关联性。即，我们不能把所有关卡分成两个非空且不相交的子集，使得这两个子集之间没有任何限制。", "inputFormat": "第一行，一个整数 $T$，表示数据组数。\n\n对于每组数据，第一行一个整数 $n$，表示关卡数。接下来 $n - 1$ 行，每行为 $i \\text{ sign } j$，其中 $0 \\leq i, j \\leq n - 1$ 且 $i \\neq j$，$\\text{sign}$ 为 $\\tt{<}$ 或者 $\\tt{>}$，表示第 $i$ 个关卡必须在第 $j$ 个关卡前或后完成。", "outputFormat": "对于每个数据，输出一行一个整数，为攻克关卡的顺序方案个数，$\\bmod (10^9+7)$ 输出。", "hint": "对于 $20\\%$ 的数据有 $n \\le 10$。\n\n对于 $40\\%$ 的数据有 $n \\le 100$。\n\n对于另外 $20\\%$ 的数据有，保证数据中 sign 只会是 <，并且 $i<j$。\n\n对于 $100\\%$ 的数据有 $T \\le 5$，$1 \\le n \\le 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[HEOI2013] SAO", "background": "", "description": "Welcome to SAO (Strange and Abnormal Online). This is a VR MMORPG with $n$ levels. However, deciding the order to challenge the levels is a big problem.\n\nThe game imposes $n-1$ constraints on the order of levels, such as level $i$ must be challenged before level $j$, or you can attempt level $l$ only after finishing level $k$. Moreover, if we ignore the directions of the constraints, then under these $n-1$ constraints, any two levels are connected in some way. That is, we cannot partition all levels into two nonempty disjoint subsets such that there is no constraint between the two subsets.", "inputFormat": "The first line contains an integer $T$, the number of test cases.\n\nFor each test case, the first line contains an integer $n$, the number of levels. Then follow $n - 1$ lines, each in the form $i \\text{ sign } j$, where $0 \\leq i, j \\leq n - 1$ and $i \\neq j$, and $\\text{sign}$ is $\\tt{<}$ or $\\tt{>}$, meaning level $i$ must be completed before (if $\\text{sign}$ is $\\tt{<}$) or after (如果 $\\text{sign}$ is $\\tt{>}$) level $j$.", "outputFormat": "For each test case, output one integer on a single line: the number of valid orders to conquer the levels, output $\\bmod (10^9+7)$.", "hint": "- For $20\\%$ of the testdata, $n \\le 10$.\n- For $40\\%$ of the testdata, $n \\le 100$.\n- For another $20\\%$ of the testdata, it is guaranteed that $\\text{sign}$ is only $\\tt{<}$ and $i<j$.\n- For $100\\%$ of the testdata, $T \\le 5$ and $1 \\le n \\le 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HEOI2013] SAO", "background": null, "description": "Welcome to SAO ( Strange and Abnormal Online)。这是一个 VR MMORPG， 含有 $n$ 个关卡。但是，挑战不同关卡的顺序是一个很大的问题。\n\n某款游戏有 $n-1$ 个对于挑战关卡的限制，诸如第 $i$ 个关卡必须在第 $j$ 个关卡前挑战，或者完成了第 $k$ 个关卡才能挑战第 $l$ 个关卡。并且，如果不考虑限制的方向性，那么在这 $n-1$ 个限制的情况下，任何两个关卡都存在某种程度的关联性。即，我们不能把所有关卡分成两个非空且不相交的子集，使得这两个子集之间没有任何限制。", "inputFormat": "第一行，一个整数 $T$，表示数据组数。\n\n对于每组数据，第一行一个整数 $n$，表示关卡数。接下来 $n - 1$ 行，每行为 $i \\text{ sign } j$，其中 $0 \\leq i, j \\leq n - 1$ 且 $i \\neq j$，$\\text{sign}$ 为 $\\tt{<}$ 或者 $\\tt{>}$，表示第 $i$ 个关卡必须在第 $j$ 个关卡前或后完成。", "outputFormat": "对于每个数据，输出一行一个整数，为攻克关卡的顺序方案个数，$\\bmod (10^9+7)$ 输出。", "hint": "对于 $20\\%$ 的数据有 $n \\le 10$。\n\n对于 $40\\%$ 的数据有 $n \\le 100$。\n\n对于另外 $20\\%$ 的数据有，保证数据中 sign 只会是 <，并且 $i<j$。\n\n对于 $100\\%$ 的数据有 $T \\le 5$，$1 \\le n \\le 1000$。", "locale": "zh-CN"}}}
{"pid": "P4100", "type": "P", "difficulty": 7, "samples": [["3 \n1 0 0 \n0 1 0 \n0 0 1 \n2 3 0 \n0 7 8 \n0 0 9", "TAK \n1 \n2 \n3"], ["4 \n2 0 1 3 \n0 1 0 4 \n1 9 9 4 \n0 4 1 7 \n1 10 9 8 \n1 13 10 11 \n1 2 1 5 \n2 1 1 7", "TAK \n3 \n4 \n1 \n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "各省省选", "河北"], "title": "[HEOI2013] 钙铁锌硒维生素", "background": "", "description": "银河队选手名单出来了！小林，作为特聘的营养师，将负责银河队选手参加宇宙比赛的饮食。\n\n众所周知，前往宇宙的某个星球，通常要花费好长好长的时间，人体情况在这之间会发生变化，因此，需要根据每天的情况搭配伙食，来保证营养。\n\n小林把人体需要的营养分成了 $n$ 种，这些营养包括但不限于铁，钙。他准备 了 $2$ 套厨师机器人，一套厨师机器人有 $n$ 个，每个厨师机器人只会做一道菜，这道菜一斤能提供第 $i$ 种营养 $x_i$ 微克。想要吃这道菜的时候，只要输入一个数，就 能吃到对应数量的这道菜了。为防止摄入过量对身体造成的伤害，每个机器人还有防过量摄入药，只要输入一个数，就能生成一定剂量的药，吃了这些药，就能 减少相当于食用对应数目的这道菜提供的营养。\n\n小林之所以准备 $2$ 套厨师机器人，正是因为旅途漫漫，难以预计，也许某一 个厨师机器人在途中坏掉，要是影响了银河队选手的身体，就不好了。因此，第 $2$ 套厨师机器人被用来做第 $1$ 套的备用。小林需要为每一个第 $1$ 套厨师机器人选 一个第 $2$ 套厨师机器人作备份，使得当这个机器人坏掉时，用备份顶替，整套厨师机器人仍然能搭配出任何营养需求，而且，每个第 $2$ 套厨师机器人只能当一个第 $1$ 套厨师机器人的备份。\n", "inputFormat": "输入文件的第一行包含一个正整数 $n$。接下来 $n$ 行，每行 $n$ 个整数，表示第 $1$ 套厨师机器人做的菜每一斤提供的每种营养。再接下来 $n$ 行，每行 $n$ 个整数， 表示第 $2$ 套厨师机器人做的菜每一斤提供的每种营养。\n", "outputFormat": "输出文件的第一行是一个字符串，如果无法完成任务，输出 `NIE`，否则输出 `TAK`，并跟着 $n$ 行，第 $i$ 行表示第 $i$ 个第 $1$ 套机器人的备份是哪一个第 $2$ 套机器人。\n\n为了避免麻烦，如果有多种可能的答案，请给出字典序最小的那一组。", "hint": "- 对于 $10\\%$ 的数据，$n = 2$；\n- 对于 $20\\%$ 的数据，$n \\leq 10$；\n- 对于 $40\\%$ 的数据，$n \\leq 30$；\n- 对于 $60\\%$ 的数据，$n \\leq 50$；\n- 对于 $80\\%$ 的数据，$n \\leq 100$；\n- 对于 $100\\%$ 的数据，$1 \\leq n \\leq 300$，所有出现的整数均非负，且不超过 $10\\,000$。", "locale": "zh-CN", "translations": {"en": {"title": "[HEOI2013] Calcium, Iron, Zinc, Selenium, Vitamins", "background": "", "description": "The Galaxy Team roster is out. As a specially hired nutritionist, Kobayashi will take charge of the team’s diet for the interstellar competition.\n\nAs we all know, traveling to a certain planet usually takes a very long time. The human body changes during the journey, so meals must be adjusted daily to ensure adequate nutrition.\n\nKobayashi divides the required nutrients into $n$ kinds, including but not limited to iron and calcium. He prepares $2$ sets of chef robots, with $n$ robots in each set. Each robot can cook exactly one dish, and this dish provides $x_i$ micrograms of the $i$-th nutrient per jin (jin). Whenever you want to eat this dish, you can enter a number to get the corresponding amount of this dish. To prevent harm from overdosing, each robot also has anti-overdose medicine. By entering a number, it generates a certain dose of medicine; after taking it, it reduces the nutrients by the same amount as eating the corresponding amount of this dish would provide.\n\nKobayashi prepares $2$ sets precisely because the journey is long and uncertain; a robot may fail during the trip, and it would be bad if that affected the Galaxy Team’s health. Therefore, the second set is used as a backup for the first set. Kobayashi needs to choose, for each robot in the first set, one robot from the second set as its backup, so that if a robot fails, replacing it with its backup still allows the entire set of chef robots to meet any nutritional requirement. Moreover, each robot in the second set can serve as the backup for at most one robot in the first set.", "inputFormat": "The first line contains a positive integer $n$. The next $n$ lines each contain $n$ integers, describing how much of each nutrient is provided per jin by the dishes made by the first set of chef robots. The following $n$ lines each contain $n$ integers, describing the same for the second set of chef robots.", "outputFormat": "The first line contains a string. If the task is impossible, output `NIE`. Otherwise, output `TAK`, followed by $n$ lines; the $i$-th line indicates which robot in the second set is the backup for the $i$-th robot in the first set.\n\nTo avoid trouble, if there are multiple possible answers, output the lexicographically smallest one.", "hint": "- For $10\\%$ of the testdata, $n = 2$.\n- For $20\\%$ of the testdata, $n \\leq 10$.\n- For $40\\%$ of the testdata, $n \\leq 30$.\n- For $60\\%$ of the testdata, $n \\leq 50$.\n- For $80\\%$ of the testdata, $n \\leq 100$.\n- For $100\\%$ of the testdata, $1 \\leq n \\leq 300$. All integers that appear are non-negative and do not exceed $10\\,000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HEOI2013] 钙铁锌硒维生素", "background": "", "description": "银河队选手名单出来了！小林，作为特聘的营养师，将负责银河队选手参加宇宙比赛的饮食。\n\n众所周知，前往宇宙的某个星球，通常要花费好长好长的时间，人体情况在这之间会发生变化，因此，需要根据每天的情况搭配伙食，来保证营养。\n\n小林把人体需要的营养分成了 $n$ 种，这些营养包括但不限于铁，钙。他准备 了 $2$ 套厨师机器人，一套厨师机器人有 $n$ 个，每个厨师机器人只会做一道菜，这道菜一斤能提供第 $i$ 种营养 $x_i$ 微克。想要吃这道菜的时候，只要输入一个数，就 能吃到对应数量的这道菜了。为防止摄入过量对身体造成的伤害，每个机器人还有防过量摄入药，只要输入一个数，就能生成一定剂量的药，吃了这些药，就能 减少相当于食用对应数目的这道菜提供的营养。\n\n小林之所以准备 $2$ 套厨师机器人，正是因为旅途漫漫，难以预计，也许某一 个厨师机器人在途中坏掉，要是影响了银河队选手的身体，就不好了。因此，第 $2$ 套厨师机器人被用来做第 $1$ 套的备用。小林需要为每一个第 $1$ 套厨师机器人选 一个第 $2$ 套厨师机器人作备份，使得当这个机器人坏掉时，用备份顶替，整套厨师机器人仍然能搭配出任何营养需求，而且，每个第 $2$ 套厨师机器人只能当一个第 $1$ 套厨师机器人的备份。\n", "inputFormat": "输入文件的第一行包含一个正整数 $n$。接下来 $n$ 行，每行 $n$ 个整数，表示第 $1$ 套厨师机器人做的菜每一斤提供的每种营养。再接下来 $n$ 行，每行 $n$ 个整数， 表示第 $2$ 套厨师机器人做的菜每一斤提供的每种营养。\n", "outputFormat": "输出文件的第一行是一个字符串，如果无法完成任务，输出 `NIE`，否则输出 `TAK`，并跟着 $n$ 行，第 $i$ 行表示第 $i$ 个第 $1$ 套机器人的备份是哪一个第 $2$ 套机器人。\n\n为了避免麻烦，如果有多种可能的答案，请给出字典序最小的那一组。", "hint": "- 对于 $10\\%$ 的数据，$n = 2$；\n- 对于 $20\\%$ 的数据，$n \\leq 10$；\n- 对于 $40\\%$ 的数据，$n \\leq 30$；\n- 对于 $60\\%$ 的数据，$n \\leq 50$；\n- 对于 $80\\%$ 的数据，$n \\leq 100$；\n- 对于 $100\\%$ 的数据，$1 \\leq n \\leq 300$，所有出现的整数均非负，且不超过 $10\\,000$。", "locale": "zh-CN"}}}
{"pid": "P4101", "type": "P", "difficulty": 5, "samples": [["5\n7 3\n1 5\n4 3\n6 1\n2 2", "1\n1\n1\n1\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["博弈论", "2014", "各省省选", "河北"], "title": "[HEOI2014] 人人尽说江南好", "background": "", "description": "小 Z 是一个不折不扣的 ZRP（Zealot Round-game Player，回合制游戏狂热玩家），最近他想起了小时候在江南玩过的一个游戏。\n\n在过去，人们是要边玩游戏边填词的，比如这首《菩萨蛮》就是当年韦庄在玩游戏时填的：人 人 尽 说 江 南 好， 游 人 只 合 江 南 老。\n\n然而我们今天不太关心人们填的词是什么，我们只关心小 Z 那时玩过的游戏。游戏的规则是这样的，给定 $n$ 堆石子，每堆石子一开始只有 $1$ 个。小 Z 和他的小伙伴轮流操作，小 Z 先行操作。操作可以将任意两堆石子合并成为一堆，当谁不再能操作的时候，谁就输掉了。\n\n不过，当一堆石子堆的太高时可能发生危险，因此小 Z 和他的小伙伴规定，任何时刻任意一堆石子的数量不能超过 $m$。即假如现在有两堆石子分别有 $a$ 个和 $b$ 个，而且 $a + b > m$，那么这两堆石子就不能合成一堆。\n\n小 Z 和他的小伙伴都是很聪明的，所以他们总是会选择对自己最有利的策略。现在小 Z 想要知道，在这种情况下，对于一个给定的 $n$ 和 $m$，到底是谁能够获得胜利呢？\n", "inputFormat": "本题包括多组数据  数据第一行为一个数 $T$，为数据组数。\n\n以下 $T$ 行，每行两个正整数 $n,m$。\n", "outputFormat": "输出 $T$ 行，每行为 $0$ 或 $1$，如果为 $0$ 意为小 Z（即先手）会取得胜利，为 $1$ 则为后手会取得胜利。\n", "hint": "对于 $10 \\%$ 的数据，$m \\ge n$；  \n对于 $20 \\%$ 的数据，$n, m \\le 10$；  \n对于 $30 \\%$ 的数据，$n, m \\le 50$，$2 \\cdot m \\ge n$；  \n对于 $50 \\%$ 的数据，$n, m \\le 100$；  \n对于 $70 \\%$ 的数据，$n, m \\le {10}^6$；  \n对于 $100 \\%$ 的数据，$1 \\le n, m \\le {10}^9$，$1 \\le T \\le 100$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[HEOI2014] Everyone Says Jiangnan Is Good", "background": "", "description": "Xiao Z is a hardcore ZRP (Zealot Round-game Player), and he recently recalled a game he played in Jiangnan when he was a child.\n\nIn the past, people would compose lyrics while playing games. For example, this piece “Pusaman (Púsà Mán)” was written by Wei Zhuang while playing: 人 人 尽 说 江 南 好， 游 人 只 合 江 南 老。\n\nHowever, today we are not very concerned about what people wrote. We only care about the game that Xiao Z played. The rules are as follows: there are $n$ piles of stones, each initially having $1$ stone. Xiao Z and his friend take turns, and Xiao Z moves first. A move can merge any two piles into one pile. Whoever cannot move loses.\n\nHowever, if a pile becomes too high, it might be dangerous. Therefore, they agreed that at any time, the number of stones in any pile cannot exceed $m$. That is, if there are two piles with $a$ and $b$ stones and $a + b > m$, then these two piles cannot be merged.\n\nXiao Z and his friend are very smart, so they always choose optimal strategies. Now Xiao Z wants to know, given $n$ and $m$, who will win.", "inputFormat": "This problem contains multiple test cases. The first line contains a single integer $T$, the number of test cases.\n\nEach of the following $T$ lines contains two positive integers $n, m$.", "outputFormat": "Output $T$ lines, each being $0$ or $1$. If it is $0$, it means Xiao Z (the first player) will win. If it is $1$, it means the second player will win.", "hint": "For $10 \\%$ of the testdata, $m \\ge n$.  \nFor $20 \\%$ of the testdata, $n, m \\le 10$.  \nFor $30 \\%$ of the testdata, $n, m \\le 50$, $2 \\cdot m \\ge n$.  \nFor $50 \\%$ of the testdata, $n, m \\le 100$.  \nFor $70 \\%$ of the testdata, $n, m \\le {10}^6$.  \nFor $100 \\%$ of the testdata, $1 \\le n, m \\le {10}^9$, $1 \\le T \\le 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HEOI2014] 人人尽说江南好", "background": "", "description": "小 Z 是一个不折不扣的 ZRP（Zealot Round-game Player，回合制游戏狂热玩家），最近他想起了小时候在江南玩过的一个游戏。\n\n在过去，人们是要边玩游戏边填词的，比如这首《菩萨蛮》就是当年韦庄在玩游戏时填的：人 人 尽 说 江 南 好， 游 人 只 合 江 南 老。\n\n然而我们今天不太关心人们填的词是什么，我们只关心小 Z 那时玩过的游戏。游戏的规则是这样的，给定 $n$ 堆石子，每堆石子一开始只有 $1$ 个。小 Z 和他的小伙伴轮流操作，小 Z 先行操作。操作可以将任意两堆石子合并成为一堆，当谁不再能操作的时候，谁就输掉了。\n\n不过，当一堆石子堆的太高时可能发生危险，因此小 Z 和他的小伙伴规定，任何时刻任意一堆石子的数量不能超过 $m$。即假如现在有两堆石子分别有 $a$ 个和 $b$ 个，而且 $a + b > m$，那么这两堆石子就不能合成一堆。\n\n小 Z 和他的小伙伴都是很聪明的，所以他们总是会选择对自己最有利的策略。现在小 Z 想要知道，在这种情况下，对于一个给定的 $n$ 和 $m$，到底是谁能够获得胜利呢？\n", "inputFormat": "本题包括多组数据  数据第一行为一个数 $T$，为数据组数。\n\n以下 $T$ 行，每行两个正整数 $n,m$。\n", "outputFormat": "输出 $T$ 行，每行为 $0$ 或 $1$，如果为 $0$ 意为小 Z（即先手）会取得胜利，为 $1$ 则为后手会取得胜利。\n", "hint": "对于 $10 \\%$ 的数据，$m \\ge n$；  \n对于 $20 \\%$ 的数据，$n, m \\le 10$；  \n对于 $30 \\%$ 的数据，$n, m \\le 50$，$2 \\cdot m \\ge n$；  \n对于 $50 \\%$ 的数据，$n, m \\le 100$；  \n对于 $70 \\%$ 的数据，$n, m \\le {10}^6$；  \n对于 $100 \\%$ 的数据，$1 \\le n, m \\le {10}^9$，$1 \\le T \\le 100$。\n", "locale": "zh-CN"}}}
{"pid": "P4102", "type": "P", "difficulty": 7, "samples": [["2 0 1 1 \n1 2", "0"], ["2 2 2 1 \n1 2 \n2 1 \n1 1", "4"], ["2 2 100 1 \n1 2 \n2 1 \n1 2", "166650"], ["2 3 100 2 \n1 2 \n1 2 \n2 1 \n2 2 \n2 1", "632506153\n518794755"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "各省省选", "河北"], "title": "[HEOI2014] 林中路径", "background": "", "description": "Alice 和 Marisa 都住在一个巨大的由 $N$ 个路口与 $M$ 条单向小道构成的森林中。Marisa 非常喜欢到 Alice 家里去玩，但是 Alice 并不喜欢这位鲁莽的来客。Alice 非常擅长观察， 因此每当她发现 Marisa 走了一条与之前完全相同的路径来到她家时，她就会装作不在家， Marisa 就只好败兴而归。Marisa 发现了这个秘密，因此她决定每次走不同的路径到 Alice 家。\n\nMarisa 体力有限，她不想走超过 K 条边到达 Alice 家，并且，每当她走 $t$（ $t$ $\\leq$ $K$ ）条边 到达 Alice 家时，她需要付出 $t^2$ 的体力。Marisa 想知道，在 Alice 无论如何都不想接见她之前（即 Marisa 无法走一条长度不超过 $K$ 的与之前不同的路径），她会消耗多少体力。\n\n现在 Marisa 拿到了一张森林的地图，但因为 Marisa 非常笨，她并不知道自己的家和 Alice 的家在哪一个路口，因此她会给询问你 $Q$ 次，每次询问假如 Marisa 的家的位置在 $S$ 而 Alice 的家的位置在 $T$ 时的答案。\n\n一条路径 $A$ 的定义是指一个长度为 $P$（$P$ 可以为任意正整数或零）的边的序列 $A_{m_0},A_{m_1},A_{m_2},…,A_{m_{T-1}}$，其中对于任意 $1 \\leq i ＜ P$，有 $A_{m_{i-1}}$ 的结束节点是 $Am_i$ 的起始节点。\n\n两条路径 $A$ 和 $B$ 完全相同是指两条路径的长度均为 T 并且对任意 $0\\leq i＜P$，有 $A_{m_i} = B_{m_i}$。", "inputFormat": "输入数据第一行包含四个整数 $N$ , $M$ , $K$ , $Q$ ，含义如题所述。\n\n接下来 $M$ 行，每行两个整数 $X$ , $Y$ ，表示从第 $X$ 个路口到第 $Y$ 个路口有一条单向小道。路口的标号为 $1,2,3,…,N$ ，在输入数据第 $i+1$ 行的边的标号为 $i$。  接下来 $Q$ 行，每行两个整数 $S$ 和 $T$，含义如题所述。", "outputFormat": "对于每个询问，输出一行，表示这次询问的答案。由于 Marisa 接受不了非常大的数， 你只需要输出答案模 $10^9+7$ 的值。", "hint": "对于 $20\\%$ 的数据，$N\\leq  5$，$M\\leq 10$，$K\\leq 3$，$Q\\leq 10$。\n\n对于 $40\\%$ 的数据，$N\\leq  30$，$M\\leq 900$，$K\\leq 100$，$Q\\leq 100$。\n\n对于 $60\\%$ 的数据，$N\\leq  50$，$M\\leq 2,500$，$K\\leq 10,000,000$，$Q\\leq 1,000$。\n\n对于 $100\\%$ 的数据，$2\\leq  N\\leq 100$，$0\\leq M\\leq 100,000$，$0\\leq K\\leq 1,000,000,000$，$0\\leq Q\\leq 10,000$，$1\\leq X,Y,S,T\\leq N$。\n\n```cpp\ng++ paths.cpp –o paths –Wl,--stack=268435456 –O2 \n```\n样例一解释 从 $S$ 到 $T$ 不存在路径\n\n \n样例二解释 Marisa 可以重复经过一个路口，即使这个路口就是 Alice 的家或 Marisa 的家\n", "locale": "zh-CN", "translations": {"en": {"title": "[HEOI2014] Paths in the Forest", "background": "", "description": "Alice and Marisa both live in a huge forest consisting of $N$ vertices and $M$ directed edges. Marisa loves visiting Alice, but Alice does not like this reckless guest. Alice is very observant, so whenever she notices that Marisa has taken a path to her home that is exactly the same as a previous one, she pretends not to be at home, and Marisa has to go back disappointed. Marisa has discovered this secret, so she decides to take a different path to Alice’s home each time.\n\nMarisa has limited stamina. She does not want to walk more than $K$ edges to reach Alice’s home, and each time she reaches Alice’s home after walking $t$ edges (where $t \\le K$), she must spend $t^2$ stamina. Marisa wants to know how much total stamina she will spend before Alice refuses to see her no matter what (that is, when Marisa can no longer find a path of length at most $K$ that is different from all the previous ones).\n\nNow Marisa has a map of the forest, but because she is very clumsy, she does not know which vertices are her home and Alice’s home. Therefore, she will ask you $Q$ times; in each query, you are asked to determine the answer if Marisa’s home is at $S$ and Alice’s home is at $T$.\n\nA path $A$ of length $P$ (where $P$ can be any nonnegative integer) is defined as a sequence of edges $A_{m_0}, A_{m_1}, A_{m_2}, \\dots, A_{m_{P-1}}$, such that for any $1 \\le i < P$, the ending vertex of $A_{m_{i-1}}$ is the starting vertex of $A_{m_i}$.\n\nTwo paths $A$ and $B$ are exactly the same if both have length $P$ and, for any $0 \\le i < P$, $A_{m_i} = B_{m_i}$.", "inputFormat": "The first line contains four integers $N$, $M$, $K$, $Q$, as described above.\n\nThe next $M$ lines each contain two integers $X$, $Y$, indicating a directed edge from vertex $X$ to vertex $Y$. Vertices are numbered $1, 2, 3, \\dots, N$. The edge on the $(i+1)$-th line has index $i$. The following $Q$ lines each contain two integers $S$ and $T$, as described above.", "outputFormat": "For each query, output one line with the answer. Since Marisa cannot accept very large numbers, you only need to output the answer modulo $10^9+7$.", "hint": "For $20\\%$ of the testdata, $N \\le 5$, $M \\le 10$, $K \\le 3$, $Q \\le 10$.\n\nFor $40\\%$ of the testdata, $N \\le 30$, $M \\le 900$, $K \\le 100$, $Q \\le 100$.\n\nFor $60\\%$ of the testdata, $N \\le 50$, $M \\le 2,500$, $K \\le 10,000,000$, $Q \\le 1,000$.\n\nFor $100\\%$ of the testdata, $2 \\le N \\le 100$, $0 \\le M \\le 100,000$, $0 \\le K \\le 1,000,000,000$, $0 \\le Q \\le 10,000$, $1 \\le X, Y, S, T \\le N$.\n\n```cpp\ng++ paths.cpp –o paths –Wl,--stack=268435456 –O2 \n```\nExplanation for Sample 1: There is no path from $S$ to $T$.\n\nExplanation for Sample 2: Marisa may pass through a vertex multiple times, even if that vertex is Alice’s home or Marisa’s home.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HEOI2014] 林中路径", "background": "", "description": "Alice 和 Marisa 都住在一个巨大的由 $N$ 个路口与 $M$ 条单向小道构成的森林中。Marisa 非常喜欢到 Alice 家里去玩，但是 Alice 并不喜欢这位鲁莽的来客。Alice 非常擅长观察， 因此每当她发现 Marisa 走了一条与之前完全相同的路径来到她家时，她就会装作不在家， Marisa 就只好败兴而归。Marisa 发现了这个秘密，因此她决定每次走不同的路径到 Alice 家。\n\nMarisa 体力有限，她不想走超过 K 条边到达 Alice 家，并且，每当她走 $t$（ $t$ $\\leq$ $K$ ）条边 到达 Alice 家时，她需要付出 $t^2$ 的体力。Marisa 想知道，在 Alice 无论如何都不想接见她之前（即 Marisa 无法走一条长度不超过 $K$ 的与之前不同的路径），她会消耗多少体力。\n\n现在 Marisa 拿到了一张森林的地图，但因为 Marisa 非常笨，她并不知道自己的家和 Alice 的家在哪一个路口，因此她会给询问你 $Q$ 次，每次询问假如 Marisa 的家的位置在 $S$ 而 Alice 的家的位置在 $T$ 时的答案。\n\n一条路径 $A$ 的定义是指一个长度为 $P$（$P$ 可以为任意正整数或零）的边的序列 $A_{m_0},A_{m_1},A_{m_2},…,A_{m_{T-1}}$，其中对于任意 $1 \\leq i ＜ P$，有 $A_{m_{i-1}}$ 的结束节点是 $Am_i$ 的起始节点。\n\n两条路径 $A$ 和 $B$ 完全相同是指两条路径的长度均为 T 并且对任意 $0\\leq i＜P$，有 $A_{m_i} = B_{m_i}$。", "inputFormat": "输入数据第一行包含四个整数 $N$ , $M$ , $K$ , $Q$ ，含义如题所述。\n\n接下来 $M$ 行，每行两个整数 $X$ , $Y$ ，表示从第 $X$ 个路口到第 $Y$ 个路口有一条单向小道。路口的标号为 $1,2,3,…,N$ ，在输入数据第 $i+1$ 行的边的标号为 $i$。  接下来 $Q$ 行，每行两个整数 $S$ 和 $T$，含义如题所述。", "outputFormat": "对于每个询问，输出一行，表示这次询问的答案。由于 Marisa 接受不了非常大的数， 你只需要输出答案模 $10^9+7$ 的值。", "hint": "对于 $20\\%$ 的数据，$N\\leq  5$，$M\\leq 10$，$K\\leq 3$，$Q\\leq 10$。\n\n对于 $40\\%$ 的数据，$N\\leq  30$，$M\\leq 900$，$K\\leq 100$，$Q\\leq 100$。\n\n对于 $60\\%$ 的数据，$N\\leq  50$，$M\\leq 2,500$，$K\\leq 10,000,000$，$Q\\leq 1,000$。\n\n对于 $100\\%$ 的数据，$2\\leq  N\\leq 100$，$0\\leq M\\leq 100,000$，$0\\leq K\\leq 1,000,000,000$，$0\\leq Q\\leq 10,000$，$1\\leq X,Y,S,T\\leq N$。\n\n```cpp\ng++ paths.cpp –o paths –Wl,--stack=268435456 –O2 \n```\n样例一解释 从 $S$ 到 $T$ 不存在路径\n\n \n样例二解释 Marisa 可以重复经过一个路口，即使这个路口就是 Alice 的家或 Marisa 的家\n", "locale": "zh-CN"}}}
{"pid": "P4103", "type": "P", "difficulty": 6, "samples": [["10 \n2 1 \n3 2 \n4 1 \n5 2 \n6 4 \n7 5 \n8 6 \n9 7 \n10 9 \n5 \n2 \n5 4 \n2\n10 4 \n2 \n5 2 \n2\n6 1 \n2 \n6 1", "3 3 3 \n6 6 6 \n1 1 1 \n2 2 2 \n2 2 2"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2014", "倍增", "各省省选", "河北", "虚树", "栈"], "title": "[HEOI2014] 大工程", "background": null, "description": "国家有一个大工程，要给一个非常大的交通网络里建一些新的通道。\n\n我们这个国家位置非常特殊，可以看成是一个单位边权的树，城市位于顶点上。\n\n在 $2$ 个国家 $a,b$ 之间建一条新通道需要的代价为树上 $a,b$ 的最短路径的长度。\n\n现在国家有很多个计划，每个计划都是这样，我们选中了 $k$ 个点，然后在它们两两之间 新建 $\\dbinom{k}{2}$ 条新通道（任意两点间都新建 $1$ 条）。\n\n现在对于每个计划，我们想知道： \n1. 这些新通道的代价和。\n2. 这些新通道中代价最小的是多少。\n3. 这些新通道中代价最大的是多少。", "inputFormat": "第一行 $n$ 表示点数。\n\n接下来 $n-1$ 行，每行两个数 $a,b$ 表示 $a$ 和 $b$ 之间有一条边。点从 $1$ 开始标号。\n\n接下来一行 $q$ 表示计划数。对每个计划有 $2$ 行，第一行 $k$ 表示这个计划选中了几个点。\n\n第二行用空格隔开的 $k$ 个互不相同的数表示选了哪 $k$ 个点。", "outputFormat": "输出 $q$ 行，每行三个数分别表示代价和，最小代价，最大代价。", "hint": "对于 $100\\%$ 的数据，$1\\le n\\le 10^6,1\\le q\\le 5\\times 10^4,\\sum k\\le 2\\times n$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | $n$ | 特殊性质 |\n| :-----------: | :-----------: | :-----------: |\n| $1\\sim 2$ | $\\le 10^4$ |  |\n|$3\\sim 5$  | $\\le 10^5$ | 树的形态是链 |\n| $6\\sim 7$ | $\\le 10^5$ |  |\n| $8\\sim 10$ | $\\le 10^6$ |  |", "locale": "zh-CN", "translations": {"en": {"title": "[HEOI2014] Major Project", "background": "", "description": "The country is undertaking a major project to build some new channels in a very large transportation network.\n\nOur country has a very special layout. It can be regarded as a tree with unit edge weights, with cities at the vertices.\n\nThe cost of building a new channel between two cities $a,b$ is the length of the shortest path between $a,b$ on the tree.\n\nThere are many plans. In each plan, we select $k$ vertices, and then build $\\dbinom{k}{2}$ new channels between every pair of them (exactly one between any two vertices).\n\nFor each plan, we want to know:\n1. The sum of the costs of these new channels.\n2. The minimum cost among these new channels.\n3. The maximum cost among these new channels.", "inputFormat": "The first line contains $n$, the number of vertices.\n\nThe next $n-1$ lines each contain two integers $a,b$, indicating there is an edge between $a$ and $b$. Vertices are numbered starting from $1$.\n\nThe next line contains $q$, the number of plans. For each plan, there are $2$ lines. The first line contains $k$, the number of selected vertices in this plan.\n\nThe second line contains $k$ distinct integers separated by spaces, indicating which $k$ vertices are selected.", "outputFormat": "Output $q$ lines. Each line contains three numbers: the sum of costs, the minimum cost, and the maximum cost.", "hint": "For $100\\%$ of the testdata, $1 \\le n \\le 10^6, 1 \\le q \\le 5 \\times 10^4, \\sum k \\le 2 \\times n$.\n\nThe specific limits for each test point are shown in the table below:\n\n| Test point ID | $n$ | Special property |\n| :-----------: | :-----------: | :-----------: |\n| $1\\sim 2$ | $\\le 10^4$ |  |\n| $3\\sim 5$ | $\\le 10^5$ | The tree is a chain |\n| $6\\sim 7$ | $\\le 10^5$ |  |\n| $8\\sim 10$ | $\\le 10^6$ |  |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HEOI2014] 大工程", "background": null, "description": "国家有一个大工程，要给一个非常大的交通网络里建一些新的通道。\n\n我们这个国家位置非常特殊，可以看成是一个单位边权的树，城市位于顶点上。\n\n在 $2$ 个国家 $a,b$ 之间建一条新通道需要的代价为树上 $a,b$ 的最短路径的长度。\n\n现在国家有很多个计划，每个计划都是这样，我们选中了 $k$ 个点，然后在它们两两之间 新建 $\\dbinom{k}{2}$ 条新通道（任意两点间都新建 $1$ 条）。\n\n现在对于每个计划，我们想知道： \n1. 这些新通道的代价和。\n2. 这些新通道中代价最小的是多少。\n3. 这些新通道中代价最大的是多少。", "inputFormat": "第一行 $n$ 表示点数。\n\n接下来 $n-1$ 行，每行两个数 $a,b$ 表示 $a$ 和 $b$ 之间有一条边。点从 $1$ 开始标号。\n\n接下来一行 $q$ 表示计划数。对每个计划有 $2$ 行，第一行 $k$ 表示这个计划选中了几个点。\n\n第二行用空格隔开的 $k$ 个互不相同的数表示选了哪 $k$ 个点。", "outputFormat": "输出 $q$ 行，每行三个数分别表示代价和，最小代价，最大代价。", "hint": "对于 $100\\%$ 的数据，$1\\le n\\le 10^6,1\\le q\\le 5\\times 10^4,\\sum k\\le 2\\times n$。\n\n每个测试点的具体限制见下表：\n\n| 测试点编号 | $n$ | 特殊性质 |\n| :-----------: | :-----------: | :-----------: |\n| $1\\sim 2$ | $\\le 10^4$ |  |\n|$3\\sim 5$  | $\\le 10^5$ | 树的形态是链 |\n| $6\\sim 7$ | $\\le 10^5$ |  |\n| $8\\sim 10$ | $\\le 10^6$ |  |", "locale": "zh-CN"}}}
{"pid": "P4104", "type": "P", "difficulty": 6, "samples": [["10\n6 5 10000  \n4 1 10000 \n9 6 10000 \n4 6 10000 \n5 1 10000 \n8318 10 9973 \n9862 9 9973 \n8234 9 9973 \n9424 9 9973 \n9324 9 9973", "73\n1\n920\n8\n1\n4421\n2565\n0\n446\n2549"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "各省省选", "河北"], "title": "[HEOI2014] 平衡", "background": "", "description": "下课了，露露、花花和萱萱在课桌上用正三棱柱教具和尺子摆起了一个“跷跷板”。\n\n这个“跷跷板”的结构是这样的：底部是一个侧面平行于地平面的正三棱柱教具，上面 摆着一个尺子，尺子上摆着若干个相同的橡皮。尺子有 2n + 1 条等距的刻度线，第 n + 1 条 刻度线恰好在尺子的中心，且与正三棱柱的不在课桌上的棱完全重合。\n\n露露发现这个“跷跷板”是不平衡的（尺子不平行于地平面）。于是，她又在尺子上放 了几个橡皮，并移动了一些橡皮的位置，使得尺子的 2n + 1 条刻度线上都恰有一块相同质 量的橡皮。“跷跷板”平衡了，露露感到很高兴。\n\n花花觉得这样太没有意思，于是从尺子上随意拿走了 k 个橡皮。令她惊讶的事情发生了： 尺子依然保持着平衡！     萱萱是一个善于思考的孩子，她当然不对尺子依然保持平衡感到吃惊，因为这只是一个 偶然的事件罢了。令她感兴趣的是，花花有多少种拿走 k 个橡皮的方法，使得尺子依然保 持平衡？当然，为了简化问题，她不得不做一些牺牲——假设所有橡皮都是拥有相同质量的 质点。但即使是这样，她也没能计算出这个数目。放学后，她把这个问题交给了她的哥哥/ 姐姐——Hibarigasaki 学园学生会会长，也就是你。当然，由于这个问题的答案也许会过于 庞大，你只需要告诉她答案 mod p 的值。\n", "inputFormat": "第一行，一个正整数，表示数据组数 T（萱萱向你询问的次数）。\n\n接下来 T 行，每行 3 个正整数 n, k, p。\n", "outputFormat": "共 T 行，每行一个正整数，代表你得出的对应问题的答案。\n", "hint": "10%的数据满足：n <= 10。\n\n30%的数据满足：n <= 50。\n\n50%的数据满足：n <= 1000。\n\n另有 10%的数据满足：k = 3。\n\n在此基础上，另有 10%的数据满足：p = 2。\n\n100%的数据满足：T <= 20，1 <= n <= 10000，1 <= k <= 10，2 <= p <= 10000，且 k <= 2n+1。\n", "locale": "zh-CN", "translations": {"en": {"title": "[HEOI2014] Balance", "background": "", "description": "After class, Lulu, Huahua, and Xuanxuan set up a “seesaw” on the desk using a regular triangular prism teaching aid and a ruler.\n\nThe structure of this “seesaw” is as follows: at the bottom is a regular triangular prism with one of its lateral faces parallel to the ground, and on top lies a ruler. Several identical erasers are placed on the ruler. The ruler has $2n+1$ equally spaced tick marks; the $(n+1)$-th tick is exactly at the center of the ruler and exactly coincides with the edge of the regular triangular prism that is not on the desk.\n\nLulu notices that the “seesaw” is unbalanced (the ruler is not parallel to the ground). So she adds a few more erasers and moves some erasers so that each of the $2n+1$ tick marks on the ruler has exactly one eraser of the same mass. The “seesaw” becomes balanced, and Lulu is happy.\n\nHuahua thinks this is too boring, so she randomly removes $k$ erasers from the ruler. To her surprise, the ruler remains balanced!\n\nXuanxuan is a thoughtful child, so she is not surprised that the ruler remains balanced, as this is merely a coincidence. What interests her is: in how many ways can Huahua remove $k$ erasers so that the ruler remains balanced? Of course, to simplify the problem, she has to make some sacrifices—assume all erasers are point masses with equal mass. Even so, she cannot compute this number. After school, she brings this problem to her older brother/sister—the student council president of Hibarigasaki Academy, that is, you. Since the answer may be too large, you only need to tell her the value modulo $p$.", "inputFormat": "The first line contains a positive integer $T$ (the number of times Xuanxuan asks you).\n\nEach of the next $T$ lines contains three positive integers $n$, $k$, and $p$.", "outputFormat": "Output $T$ lines, each containing one positive integer, the answer for the corresponding query.", "hint": "- 10% of the testdata satisfy $n \\le 10$.\n- 30% of the testdata satisfy $n \\le 50$.\n- 50% of the testdata satisfy $n \\le 1000$.\n- Additionally, 10% of the testdata satisfy $k = 3$.\n- Additionally, 10% of the testdata satisfy $p = 2$.\n- 100% of the testdata satisfy $T \\le 20$, $1 \\le n \\le 10000$, $1 \\le k \\le 10$, $2 \\le p \\le 10000$, and $k \\le 2n+1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HEOI2014] 平衡", "background": "", "description": "下课了，露露、花花和萱萱在课桌上用正三棱柱教具和尺子摆起了一个“跷跷板”。\n\n这个“跷跷板”的结构是这样的：底部是一个侧面平行于地平面的正三棱柱教具，上面 摆着一个尺子，尺子上摆着若干个相同的橡皮。尺子有 2n + 1 条等距的刻度线，第 n + 1 条 刻度线恰好在尺子的中心，且与正三棱柱的不在课桌上的棱完全重合。\n\n露露发现这个“跷跷板”是不平衡的（尺子不平行于地平面）。于是，她又在尺子上放 了几个橡皮，并移动了一些橡皮的位置，使得尺子的 2n + 1 条刻度线上都恰有一块相同质 量的橡皮。“跷跷板”平衡了，露露感到很高兴。\n\n花花觉得这样太没有意思，于是从尺子上随意拿走了 k 个橡皮。令她惊讶的事情发生了： 尺子依然保持着平衡！     萱萱是一个善于思考的孩子，她当然不对尺子依然保持平衡感到吃惊，因为这只是一个 偶然的事件罢了。令她感兴趣的是，花花有多少种拿走 k 个橡皮的方法，使得尺子依然保 持平衡？当然，为了简化问题，她不得不做一些牺牲——假设所有橡皮都是拥有相同质量的 质点。但即使是这样，她也没能计算出这个数目。放学后，她把这个问题交给了她的哥哥/ 姐姐——Hibarigasaki 学园学生会会长，也就是你。当然，由于这个问题的答案也许会过于 庞大，你只需要告诉她答案 mod p 的值。\n", "inputFormat": "第一行，一个正整数，表示数据组数 T（萱萱向你询问的次数）。\n\n接下来 T 行，每行 3 个正整数 n, k, p。\n", "outputFormat": "共 T 行，每行一个正整数，代表你得出的对应问题的答案。\n", "hint": "10%的数据满足：n <= 10。\n\n30%的数据满足：n <= 50。\n\n50%的数据满足：n <= 1000。\n\n另有 10%的数据满足：k = 3。\n\n在此基础上，另有 10%的数据满足：p = 2。\n\n100%的数据满足：T <= 20，1 <= n <= 10000，1 <= k <= 10，2 <= p <= 10000，且 k <= 2n+1。\n", "locale": "zh-CN"}}}
{"pid": "P4105", "type": "P", "difficulty": 3, "samples": [["3 815 6901 3839 178 199 10007 ", "1334"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["模拟", "贪心", "2014", "二分", "各省省选", "河北"], "title": "[HEOI2014] 南园满地堆轻絮", "background": null, "description": "小 Z 是 ZRP（Zombies’ Republic of Poetry，僵尸诗歌共和国）的一名诗歌爱好者，最近他研究起了诗词音律的问题。\n\n在过去，诗词是需要编成曲子唱出来的，比如下面这首《菩萨蛮》，唱出来的话其对应的音符就是这样的：\n\n```\n 南  园  满 地 堆 轻 絮， 愁 闻 一 霎 清 明 雨   \n 1   1  5 5 6 6 5  4 4 3 3 2 2 1  \n```\n因而可以发现，`1 1 5 5 6 6 5 4 4 3 3 2 2 1` 这串音符就成为了研究音律的关键。\n\n小 Z 翻阅了众多史料发现，过去的一首曲子的音调是不下降的。小 Z 想要知道对于一首给定的曲子，如何通过提高音调或者降低音调，将它的音调修改的不下降，而且使得修改幅度最大的那个音符的修改幅度尽量小。即如果把一个包含 $n$ 个音符的曲子看做是一个正整数数列 $A_1 \\cdots A_n$，那么目标是求另一个正整数数列 $B_1 \\cdots B_n$，使得对于任意的 $1 \\leq i<n$ 有 $B_i \\leq B_{i+1}$，而且使得 $\\texttt{Ans} = \\max\\{\\lvert A_j-B_j\\rvert,1\\leq j\\leq n\\}$ 尽量小。\n\n小 Z 很快就想清楚了做法，但是鉴于他还忙着写诗，所以这个任务就交给了你。", "inputFormat": "由于数据规模可能较大，因此采用如下方式生成数据。\n\n每个数据包含 $7$ 个数：$n,S_a,S_b,S_c,S_d,A_1,\\texttt{Mod}$，即共有 $n$ 个音符，第一个音符为 $A_1$。\n\n生成规则如下：定义生成函数 $F(x) = S_a\\times x^3 + S_b\\times x^2 + S_c\\times x + S_d$；那么给出递推公式 $A_i =( F(A_{i-1}) + F(A_{i-2}) )\\bmod \\texttt{Mod}$，此处规定 $A_0 = 0$。由于中间过程的数可能会特别大，所以要求每一步与 $A$ 中的每个数都对一个给定的数 $\\texttt{Mod}$ 取模。", "outputFormat": "输出一行，包含一个正整数 $\\texttt{Ans}$。", "hint": "【数据范围】\n\n对于 $10\\%$ 的数据，$n\\leq3$\n\n对于 $20\\%$ 的数据，$n\\leq10$\n\n对于 $30\\%$ 的数据，$n\\leq10^2$\n\n对于 $50\\%$ 的数据，$n\\leq10^3$\n\n对于 $70\\%$ 的数据，$n\\leq10^5$\n\n对于 $100\\%$ 的数据，$2<n\\leq 5 \\times 10^6$，$S_a,S_b,S_c,S_d,A_1 \\leq \\min\\{10^4,\\texttt{Mod}\\}$，$1 < \\texttt{Mod}\\leq 10^9+7$，所有输入的数都是正整数。\n\n【友情提示】\n\n样例中生成的数列为：$199,4568,1901$，此时将 $4568$ 修改为 $3234$，$1901$ 也修改为 $3234$ 即可，代价为 $1334$。", "locale": "zh-CN", "translations": {"en": {"title": "[HEOI2014] Light Catkins Piled All Over the Southern Garden", "background": "", "description": "Xiao Z is a poetry enthusiast in the ZRP (Zombies’ Republic of Poetry). Recently, he has been studying the prosody of classical poetry.\n\nIn the past, poems were meant to be sung to melodies. For example, consider the following tune of “Bodhisattva Man.” When sung, the corresponding notes are:\n\n```\n 南  园  满 地 堆 轻 絮， 愁 闻 一 霎 清 明 雨   \n 1   1  5 5 6 6 5  4 4 3 3 2 2 1  \n```\nTherefore, one can see that the sequence of notes `1 1 5 5 6 6 5 4 4 3 3 2 2 1` becomes the key to studying prosody.\n\nFrom many historical sources, Xiao Z found that the pitch of an ancient tune is non-decreasing. He wants to know, for a given piece, how to raise or lower its notes to make the sequence non-decreasing, while making the largest adjustment among all notes as small as possible. That is, if a piece with $n$ notes is viewed as a positive integer sequence $A_1 \\cdots A_n$, the goal is to find another positive integer sequence $B_1 \\cdots B_n$ such that for every $1 \\leq i < n$ we have $B_i \\leq B_{i+1}$, and $\\texttt{Ans} = \\max\\{\\lvert A_j - B_j \\rvert, 1 \\leq j \\leq n\\}$ is minimized.\n\nXiao Z quickly figured out a method, but since he is busy writing poetry, the task is handed over to you.", "inputFormat": "Since the testdata size may be large, the data are generated as follows.\n\nEach test consists of $7$ numbers: $n, S_a, S_b, S_c, S_d, A_1, \\texttt{Mod}$, meaning there are $n$ notes and the first note is $A_1$.\n\nThe generation rules are: define $F(x) = S_a \\times x^3 + S_b \\times x^2 + S_c \\times x + S_d$; then the recurrence is\n$A_i = \\bigl( F(A_{i-1}) + F(A_{i-2}) \\bigr) \\bmod \\texttt{Mod}$, with $A_0 = 0$. Since intermediate values may be very large, at each step and for every number in $A$, take modulo $\\texttt{Mod}$.", "outputFormat": "Output one line containing a positive integer $\\texttt{Ans}$.", "hint": "Constraints\n\n- For $10\\%$ of the testdata, $n \\leq 3$.\n- For $20\\%$ of the testdata, $n \\leq 10$.\n- For $30\\%$ of the testdata, $n \\leq 10^2$.\n- For $50\\%$ of the testdata, $n \\leq 10^3$.\n- For $70\\%$ of the testdata, $n \\leq 10^5$.\n- For $100\\%$ of the testdata, $2 < n \\leq 5 \\times 10^6$, $S_a, S_b, S_c, S_d, A_1 \\leq \\min\\{10^4, \\texttt{Mod}\\}$, $1 < \\texttt{Mod} \\leq 10^9 + 7$, and all input numbers are positive integers.\n\nFriendly hint\n\nIn the sample, the generated sequence is $199, 4568, 1901$. If you change $4568$ to $3234$ and also change $1901$ to $3234$, the cost is $1334$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HEOI2014] 南园满地堆轻絮", "background": null, "description": "小 Z 是 ZRP（Zombies’ Republic of Poetry，僵尸诗歌共和国）的一名诗歌爱好者，最近他研究起了诗词音律的问题。\n\n在过去，诗词是需要编成曲子唱出来的，比如下面这首《菩萨蛮》，唱出来的话其对应的音符就是这样的：\n\n```\n 南  园  满 地 堆 轻 絮， 愁 闻 一 霎 清 明 雨   \n 1   1  5 5 6 6 5  4 4 3 3 2 2 1  \n```\n因而可以发现，`1 1 5 5 6 6 5 4 4 3 3 2 2 1` 这串音符就成为了研究音律的关键。\n\n小 Z 翻阅了众多史料发现，过去的一首曲子的音调是不下降的。小 Z 想要知道对于一首给定的曲子，如何通过提高音调或者降低音调，将它的音调修改的不下降，而且使得修改幅度最大的那个音符的修改幅度尽量小。即如果把一个包含 $n$ 个音符的曲子看做是一个正整数数列 $A_1 \\cdots A_n$，那么目标是求另一个正整数数列 $B_1 \\cdots B_n$，使得对于任意的 $1 \\leq i<n$ 有 $B_i \\leq B_{i+1}$，而且使得 $\\texttt{Ans} = \\max\\{\\lvert A_j-B_j\\rvert,1\\leq j\\leq n\\}$ 尽量小。\n\n小 Z 很快就想清楚了做法，但是鉴于他还忙着写诗，所以这个任务就交给了你。", "inputFormat": "由于数据规模可能较大，因此采用如下方式生成数据。\n\n每个数据包含 $7$ 个数：$n,S_a,S_b,S_c,S_d,A_1,\\texttt{Mod}$，即共有 $n$ 个音符，第一个音符为 $A_1$。\n\n生成规则如下：定义生成函数 $F(x) = S_a\\times x^3 + S_b\\times x^2 + S_c\\times x + S_d$；那么给出递推公式 $A_i =( F(A_{i-1}) + F(A_{i-2}) )\\bmod \\texttt{Mod}$，此处规定 $A_0 = 0$。由于中间过程的数可能会特别大，所以要求每一步与 $A$ 中的每个数都对一个给定的数 $\\texttt{Mod}$ 取模。", "outputFormat": "输出一行，包含一个正整数 $\\texttt{Ans}$。", "hint": "【数据范围】\n\n对于 $10\\%$ 的数据，$n\\leq3$\n\n对于 $20\\%$ 的数据，$n\\leq10$\n\n对于 $30\\%$ 的数据，$n\\leq10^2$\n\n对于 $50\\%$ 的数据，$n\\leq10^3$\n\n对于 $70\\%$ 的数据，$n\\leq10^5$\n\n对于 $100\\%$ 的数据，$2<n\\leq 5 \\times 10^6$，$S_a,S_b,S_c,S_d,A_1 \\leq \\min\\{10^4,\\texttt{Mod}\\}$，$1 < \\texttt{Mod}\\leq 10^9+7$，所有输入的数都是正整数。\n\n【友情提示】\n\n样例中生成的数列为：$199,4568,1901$，此时将 $4568$ 修改为 $3234$，$1901$ 也修改为 $3234$ 即可，代价为 $1334$。", "locale": "zh-CN"}}}
{"pid": "P4106", "type": "P", "difficulty": 5, "samples": [["2 \n++ 0 \n+- 1 \n-+ 2 \n-- 3 \n \n", "3/2 \n-1 x1 \n-1/2 x2 "], ["3 \n--- -1.0\n-++ -1.0\n+-+ -1.0\n++- -1.0\n--+ 1.0\n-+- 1.0\n+-- 1.0\n+++ 1.0\n", "1 x1x2x3"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [17000, 17000, 17000, 17000, 17000, 17000, 17000]}, "tags": ["2014", "各省省选", "河北"], "title": "[HEOI2014] 逻辑翻译", "background": null, "description": "在人类的神经系统中，每个信号都可以用 $−1$ 或 $+1$ 来表示。这些信号组合起来最后形成了喜怒哀乐，酸甜苦辣，红黄绿蓝等各种各样的复杂信息。纳米探测科技的突破让生物学家可以测量大脑中特定区域的完整逻辑功能。然而超大数据的处理一直是令 H 教授头疼的问题。\n\n假设一个逻辑单元接受 $N$ 个信号输入，并产生一个代表某种意义的实数值 $r$ 。那么总共可能的情况有 $2^N$ 种。通过长时间的累积测量， H 教授可以准确地获得输入信号与 $r$ 的关系表：\n\n$$f :\\{-1,1\\}^N \\to \\mathbb{R} $$\n\n然而进一步研究发现，神经元的运算方式可以被建模为人们熟知的多项式。由于一个输入信号值的平方一定为 $1$，所以我们可以用不含幂的 $2^N$ 项的多项式来唯一表示任何一个逻辑 $f$。\n\n例如\n$x_1=+1; x_2=+1 \\to 0$\n\n$x_1=+1; x_2=-1 \\to 1$\n\n$x_1=-1; x_2=+1 \\to 2$\n\n$x_1=-1; x_2=-1 \\to 3$\n\n可以写成\n\n$$f(x_1,x_2)=1.5-0.5x_2-x_1$$\n\n研究一个逻辑单元的多项式形式对了解大脑工作十分有意义，于是小 M 决定帮 H 教授把测量出的逻辑关系表全部转换成多项式的形式。这么简单的工作一定难不倒编程能手小 M 的吧？", "inputFormat": "第一行是 $N$ ($1\\le N \\le20$)，接下来共 $2^N$ 行，每一行是一组逻辑输入和一个对应值，代表 $x_1...x_N$ 的符号以及对应的 $r$。详见样例。数据保证所有逻辑值的绝对值不超过 $100$，且不包含超过 $2$ 位小数。保证所有逻辑的输入串都互不相同。", "outputFormat": "最多 $2^N$ 行，代表多项式每一项的系数，如果答案为整数，输出整数形式。否则输出最简分数形式。如果系数恰好为 $0$，则省略整行。变量和系数用空格隔开，常数项不用加空格。\n\n顺序按多项式的字典序：\n\n1. 常数项优先；\n\n2. 没有常数项时，最小 $x$ 下标更小的项优先；\n\n3. 当两项含有相同最小下标时，按除掉最小下标 $x$ 以后，以同样规则递归比较。\n\n例：$1$，$x1$，$x1x2$，$x1x2x3$，$x1x3$，$x2$，$x2x3$，$x3$。详见样例。", "hint": "本题共有 $10$ 个测试数据。\n\n对于第 $1$ 个数据， $N\\le3$;\n\n对于第 $2$ 个数据， $N\\le8$;\n\n对于第 $3$，$4$ 个数据，$N\\le11$;\n\n对于第 $5$，$6$ 个数据， 答案多项式中只有一个非零项，如样例#2。\n\n对于第 $7$，$8$ 个数据， 答案多项式中最多有 $5$ 个非零项。\n\n对于 $100\\%$ 的数据， $1 \\le N \\le 20,|r| \\le 100, 100r\\in \\mathbb{Z} $\n\n友情提示\n\n请注意输入输出的效率。", "locale": "zh-CN", "translations": {"en": {"title": "[HEOI2014] Logic Translation", "background": "", "description": "In the human nervous system, each signal can be represented by $−1$ or $+1$. These signals combine to eventually form complex information such as joy, anger, sorrow, and happiness; sour, sweet, bitter, and spicy; red, yellow, green, and blue. Breakthroughs in nano-probing technology have enabled biologists to measure the complete logical function of specific regions of the brain. However, processing ultra-large data has always been a headache for Professor H.\n\nSuppose a logical unit accepts $N$ signal inputs and produces a real value $r$ representing some meaning. Then there are $2^N$ possible cases in total. Through long-term cumulative measurements, Professor H can accurately obtain the mapping between input signals and $r$:\n\n$$f :\\{-1,1\\}^N \\to \\mathbb{R} $$\n\nFurther research has found that the neuron’s computation can be modeled as a well-known polynomial. Since the square of an input signal value is always $1$, we can uniquely represent any logic $f$ by a polynomial without powers consisting of $2^N$ terms.\n\nFor example\nx1=+1; x2=+1 -> 0\n\nx1=+1; x2=-1 -> 1\n\nx1=-1; x2=+1 -> 2\n\nx1=-1; x2=-1 -> 3\n\ncan be written as\n\n$$f(x_1,x_2)=1.5-0.5x_2-x_1$$\n\nStudying the polynomial form of a logical unit is very meaningful for understanding how the brain works, so Xiao M decided to help Professor H convert all measured logic tables into polynomial form. Such a simple task should be no problem for the coding ace Xiao M, right?", "inputFormat": "The first line is $N$ ($1\\le N \\le20$). Then there are $2^N$ lines. Each line contains one set of logical inputs and one corresponding value, representing the signs of $x_1...x_N$ and the corresponding $r$. See the sample. The testdata guarantees that the absolute value of every logical value does not exceed $100$, and it contains no more than $2$ decimal places. All logical input strings are guaranteed to be pairwise distinct.", "outputFormat": "Up to $2^N$ lines, representing the coefficient of each term in the polynomial. If a coefficient is an integer, output it in integer form; otherwise, output it as an irreducible fraction. If a coefficient is exactly $0$, omit the entire line. Separate variables and the coefficient with a space; the constant term should not have a space.\n\nOrder by the polynomial’s lexicographic order:\n\n1. The constant term comes first.\n\n2. Among non-constant terms, the term with the smaller smallest $x$ index comes first.\n\n3. If two terms share the same smallest index, remove that smallest-indexed $x$ and compare recursively using the same rule.\n\nExample: $1$, $x1$, $x1x2$, $x1x2x3$, $x1x3$, $x2$, $x2x3$, $x3$. See the sample.", "hint": "This problem has $10$ testdata.\n\nFor the $1$st testdata, $N\\le3$;\nfor the $2$nd testdata, $N\\le8$;\nfor the $3$rd and $4$th testdata, $N\\le11$;\nfor the $5$th and $6$th testdata, the answer polynomial has only one nonzero term, as in Sample #2;\nfor the $7$th and $8$th testdata, the answer polynomial has at most $5$ nonzero terms.\n\nFor $100\\%$ of the testdata, $1 \\le N \\le 20, |r| \\le 100, 100r\\in \\mathbb{Z}$.\n\nFriendly reminder\n\nPlease pay attention to input and output efficiency.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HEOI2014] 逻辑翻译", "background": null, "description": "在人类的神经系统中，每个信号都可以用 $−1$ 或 $+1$ 来表示。这些信号组合起来最后形成了喜怒哀乐，酸甜苦辣，红黄绿蓝等各种各样的复杂信息。纳米探测科技的突破让生物学家可以测量大脑中特定区域的完整逻辑功能。然而超大数据的处理一直是令 H 教授头疼的问题。\n\n假设一个逻辑单元接受 $N$ 个信号输入，并产生一个代表某种意义的实数值 $r$ 。那么总共可能的情况有 $2^N$ 种。通过长时间的累积测量， H 教授可以准确地获得输入信号与 $r$ 的关系表：\n\n$$f :\\{-1,1\\}^N \\to \\mathbb{R} $$\n\n然而进一步研究发现，神经元的运算方式可以被建模为人们熟知的多项式。由于一个输入信号值的平方一定为 $1$，所以我们可以用不含幂的 $2^N$ 项的多项式来唯一表示任何一个逻辑 $f$。\n\n例如\n$x_1=+1; x_2=+1 \\to 0$\n\n$x_1=+1; x_2=-1 \\to 1$\n\n$x_1=-1; x_2=+1 \\to 2$\n\n$x_1=-1; x_2=-1 \\to 3$\n\n可以写成\n\n$$f(x_1,x_2)=1.5-0.5x_2-x_1$$\n\n研究一个逻辑单元的多项式形式对了解大脑工作十分有意义，于是小 M 决定帮 H 教授把测量出的逻辑关系表全部转换成多项式的形式。这么简单的工作一定难不倒编程能手小 M 的吧？", "inputFormat": "第一行是 $N$ ($1\\le N \\le20$)，接下来共 $2^N$ 行，每一行是一组逻辑输入和一个对应值，代表 $x_1...x_N$ 的符号以及对应的 $r$。详见样例。数据保证所有逻辑值的绝对值不超过 $100$，且不包含超过 $2$ 位小数。保证所有逻辑的输入串都互不相同。", "outputFormat": "最多 $2^N$ 行，代表多项式每一项的系数，如果答案为整数，输出整数形式。否则输出最简分数形式。如果系数恰好为 $0$，则省略整行。变量和系数用空格隔开，常数项不用加空格。\n\n顺序按多项式的字典序：\n\n1. 常数项优先；\n\n2. 没有常数项时，最小 $x$ 下标更小的项优先；\n\n3. 当两项含有相同最小下标时，按除掉最小下标 $x$ 以后，以同样规则递归比较。\n\n例：$1$，$x1$，$x1x2$，$x1x2x3$，$x1x3$，$x2$，$x2x3$，$x3$。详见样例。", "hint": "本题共有 $10$ 个测试数据。\n\n对于第 $1$ 个数据， $N\\le3$;\n\n对于第 $2$ 个数据， $N\\le8$;\n\n对于第 $3$，$4$ 个数据，$N\\le11$;\n\n对于第 $5$，$6$ 个数据， 答案多项式中只有一个非零项，如样例#2。\n\n对于第 $7$，$8$ 个数据， 答案多项式中最多有 $5$ 个非零项。\n\n对于 $100\\%$ 的数据， $1 \\le N \\le 20,|r| \\le 100, 100r\\in \\mathbb{Z} $\n\n友情提示\n\n请注意输入输出的效率。", "locale": "zh-CN"}}}
{"pid": "P4107", "type": "P", "difficulty": 6, "samples": [["10 4\n0 2 2 2 4 1 0 4 1 1\n3 6 2 3\n1 9\n1 8\n1 1\n0\n0\n2 7 4\n0\n1 5\n0", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2015", "各省省选", "河北"], "title": "[HEOI2015] 兔子与樱花", "background": "", "description": "很久很久之前，森林里住着一群兔子。有一天，兔子们突然决定要去看樱花。\n\n兔子们所在森林里的樱花树很特殊。樱花树由 $n$ 个树枝分叉点组成，编号从 $0$ 到 $n-1$，这 $n$ 个分叉点由 $n-1$ 个树枝连接，我们可以把它看成一个有根树结构，其中 $0$ 号节点是根节点。\n\n这个树的每个节点上都会有一些樱花，其中第 $i$ 个节点有 $c_i$ 朵樱花。樱花树的每一个节点都有最大的载重 $m$，对于每一个节点 $i$，它的儿子节点的个数和 $i$ 节点上樱花个数之和不能超过 $m$，即 $son(i) + c_i \\leq m$，其中 $son(i)$ 表示 $i$ 的儿子的个数，如果 $i$ 为叶子节点，则 $son(i) = 0$。\n\n现在兔子们觉得樱花树上节点太多，希望去掉一些节点。当一个节点被去掉之后，这个节点上的樱花和它的儿子节点都被连到删掉节点的父节点上。如果父节点也被删除，那么就会继续向上连接，直到第一个没有被删除的节点为止。\n\n现在兔子们希望计算在不违背最大载重的情况下，最多能删除多少节点。\n\n注意根节点不能被删除，被删除的节点不被计入载重。", "inputFormat": "第一行输入两个正整数，$n$ 和 $m$ 分别表示节点个数和最大载重。\n\n第二行 $n$ 个整数 $c_i$，表示第 $i$ 个节点上的樱花个数。\n\n接下来 $n$ 行，每行第一个数 $k_i$ 表示这个节点的儿子个数，接下来 $k_i$ 个整数表示这个节点儿子的编号。", "outputFormat": "一行一个整数，表示最多能删除多少节点。\n", "hint": "- 对于 $30\\%$ 的数据，$n \\leq 5 \\times 10^3$，$m \\leq 100$，$c_i \\leq 100$；\n- 对于 $70\\%$ 的数据，$n \\leq 2 \\times 10^5$，$m \\leq 2 \\times 10^3$，$c_i \\leq 10^3$；\n- 对于 $100\\%$ 的数据，$1 \\leq n \\leq 2 \\times 10^6$，$1 \\leq m \\leq 10^5$，$0 \\leq c_i \\leq 10^3$，保证初始时，每个节点樱花数与儿子节点个数之和大于 $0$ 且不超过 $m$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[HEOI2015] Rabbits and Sakura", "background": "", "description": "A long time ago, a group of rabbits lived in a forest. One day, they suddenly decided to go see sakura.\n\nThe sakura tree in their forest is special. It consists of $n$ branch fork points, numbered from $0$ to $n-1$. These $n$ fork points are connected by $n-1$ branches, and we can regard it as a rooted tree where node $0$ is the root.\n\nEach node of the tree has some cherry blossoms; specifically, node $i$ has $c_i$ blossoms. Every node of the sakura tree has a maximum load $m$. For each node $i$, the sum of the number of its children and the number of blossoms on node $i$ must not exceed $m$, i.e., $son(i) + c_i \\leq m$, where $son(i)$ denotes the number of children of $i$. If $i$ is a leaf, then $son(i) = 0$.\n\nNow the rabbits think there are too many nodes on the sakura tree and want to remove some nodes. When a node is removed, the blossoms on this node and all its children are attached to the parent of the removed node. If the parent is also removed, they continue to attach upward until the first node that is not removed.\n\nThe rabbits want to compute the maximum number of nodes that can be removed without violating the maximum load.\n\nNote that the root cannot be removed, and deleted nodes are not counted toward the load.", "inputFormat": "The first line contains two positive integers, $n$ and $m$, denoting the number of nodes and the maximum load.\n\nThe second line contains $n$ integers $c_i$, where $c_i$ is the number of blossoms on node $i$.\n\nThen follow $n$ lines. In each line, the first number $k_i$ is the number of children of this node, followed by $k_i$ integers giving the indices of its children.", "outputFormat": "Output a single integer: the maximum number of nodes that can be removed.", "hint": "- For $30\\%$ of the testdata, $n \\leq 5 \\times 10^3$, $m \\leq 100$, $c_i \\leq 100$.\n- For $70\\%$ of the testdata, $n \\leq 2 \\times 10^5$, $m \\leq 2 \\times 10^3$, $c_i \\leq 10^3$.\n- For $100\\%$ of the testdata, $1 \\leq n \\leq 2 \\times 10^6$, $1 \\leq m \\leq 10^5$, $0 \\leq c_i \\leq 10^3$. It is guaranteed that initially, for every node, the sum of its number of blossoms and its number of children is greater than $0$ and does not exceed $m$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HEOI2015] 兔子与樱花", "background": "", "description": "很久很久之前，森林里住着一群兔子。有一天，兔子们突然决定要去看樱花。\n\n兔子们所在森林里的樱花树很特殊。樱花树由 $n$ 个树枝分叉点组成，编号从 $0$ 到 $n-1$，这 $n$ 个分叉点由 $n-1$ 个树枝连接，我们可以把它看成一个有根树结构，其中 $0$ 号节点是根节点。\n\n这个树的每个节点上都会有一些樱花，其中第 $i$ 个节点有 $c_i$ 朵樱花。樱花树的每一个节点都有最大的载重 $m$，对于每一个节点 $i$，它的儿子节点的个数和 $i$ 节点上樱花个数之和不能超过 $m$，即 $son(i) + c_i \\leq m$，其中 $son(i)$ 表示 $i$ 的儿子的个数，如果 $i$ 为叶子节点，则 $son(i) = 0$。\n\n现在兔子们觉得樱花树上节点太多，希望去掉一些节点。当一个节点被去掉之后，这个节点上的樱花和它的儿子节点都被连到删掉节点的父节点上。如果父节点也被删除，那么就会继续向上连接，直到第一个没有被删除的节点为止。\n\n现在兔子们希望计算在不违背最大载重的情况下，最多能删除多少节点。\n\n注意根节点不能被删除，被删除的节点不被计入载重。", "inputFormat": "第一行输入两个正整数，$n$ 和 $m$ 分别表示节点个数和最大载重。\n\n第二行 $n$ 个整数 $c_i$，表示第 $i$ 个节点上的樱花个数。\n\n接下来 $n$ 行，每行第一个数 $k_i$ 表示这个节点的儿子个数，接下来 $k_i$ 个整数表示这个节点儿子的编号。", "outputFormat": "一行一个整数，表示最多能删除多少节点。\n", "hint": "- 对于 $30\\%$ 的数据，$n \\leq 5 \\times 10^3$，$m \\leq 100$，$c_i \\leq 100$；\n- 对于 $70\\%$ 的数据，$n \\leq 2 \\times 10^5$，$m \\leq 2 \\times 10^3$，$c_i \\leq 10^3$；\n- 对于 $100\\%$ 的数据，$1 \\leq n \\leq 2 \\times 10^6$，$1 \\leq m \\leq 10^5$，$0 \\leq c_i \\leq 10^3$，保证初始时，每个节点樱花数与儿子节点个数之和大于 $0$ 且不超过 $m$。\n", "locale": "zh-CN"}}}
{"pid": "P4108", "type": "P", "difficulty": 6, "samples": [["10\n1353600 5821200 10752000 1670400 3729600 6844320 12544000 117600 59400 640\n10\nMODIFY 7 20321280\nQUERY 162343680\nQUERY 1832232960000\nMODIFY 0 92160\nQUERY 1234567\nQUERY 3989856000\nQUERY 833018560\nMODIFY 3 8600\nMODIFY 5 5306112\nQUERY 148900352", "6\n0\nno\n2\n8\n8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2015", "各省省选", "数论", "河北", "枚举", "分块"], "title": "[HEOI2015] 公约数数列", "background": "", "description": "设计一个数据结构. 给定一个正整数数列 $a_0, a_1, \\cdots, a_{n - 1}$，你需要支持以下两种操作：\n\n\n1. $\\text{\\texttt{MODIFY} \\textit{id} \\textit{x}}$：将 $a_{id}$ 修改为 $x$；\n2. $\\text{\\texttt{QUERY} \\textit{x}}$：求最小的整数 $p \\ (0 \\le p < n)$，使得 $\\gcd(a_0, a_1, \\cdots, a_p) \\times  \\operatorname{xor}(a_0, a_1, \\cdots, a_p) = x$。其中 $\\operatorname{xor}(a_0, a_1, \\cdots, a_p)$ 代表 $a_0, a_1, \\cdots, a_p$ 的异或和，$\\gcd$ 表示最大公约数。\n", "inputFormat": "第一行包含一个正整数 $n$。\n\n接下来一行包含 $n$ 个正整数 $a_0,a_1,\\cdots,a_{n-1}$。\n\n之后一行包含一个正整数 $q$，表示询问的个数。\n\n之后 $q$ 行，每行包含一个询问。格式如题目中所述。", "outputFormat": "对于每个 $\\texttt{QUERY}$ 询问，在单独的一行中输出结果。如果不存在这样的 $p$，输出 `no`。", "hint": "### 数据范围及约定\n\n- 对于 $30\\%$ 的数据，$n\\le10^4$，$q\\le 1000$。\n- 对于 $100\\%$ 的数据，$n\\le10^5$，$q\\le 10000$，$1\\le a_i\\le 10^9$，询问操作中 $x \\le 10^{18}$，修改操作中 $0\\le id<n$，$1\\le x\\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[HEOI2015] Common Divisor Sequence", "background": "", "description": "Design a data structure. Given a sequence of positive integers $a_0, a_1, \\cdots, a_{n - 1}$, you need to support the following two operations:\n1. $\\text{\\texttt{MODIFY} \\textit{id} \\textit{x}}$: set $a_{id}$ to $x$.\n2. $\\text{\\texttt{QUERY} \\textit{x}}$: find the smallest integer $p$ ($0 \\le p < n$) such that $\\gcd(a_0, a_1, \\cdots, a_p) \\times \\operatorname{xor}(a_0, a_1, \\cdots, a_p) = x$. Here $\\operatorname{xor}(a_0, a_1, \\cdots, a_p)$ denotes the xor-sum of $a_0, a_1, \\cdots, a_p$, and $\\gcd$ denotes the greatest common divisor.", "inputFormat": "The first line contains a positive integer $n$.\nThe next line contains $n$ positive integers $a_0, a_1, \\cdots, a_{n - 1}$.\nThe next line contains a positive integer $q$, the number of queries.\nEach of the next $q$ lines contains one query, in the format described above.", "outputFormat": "For each $\\texttt{QUERY}$, output the result on a separate line. If no such $p$ exists, output `no`.", "hint": "Constraints\n- For 30% of the testdata, $n \\le 10^4$, $q \\le 1000$.\n- For 100% of the testdata, $n \\le 10^5$, $q \\le 10000$, $1 \\le a_i \\le 10^9$, in $\\texttt{QUERY}$ operations $x \\le 10^{18}$, in modify operations $0 \\le id < n$, $1 \\le x \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HEOI2015] 公约数数列", "background": "", "description": "设计一个数据结构. 给定一个正整数数列 $a_0, a_1, \\cdots, a_{n - 1}$，你需要支持以下两种操作：\n\n\n1. $\\text{\\texttt{MODIFY} \\textit{id} \\textit{x}}$：将 $a_{id}$ 修改为 $x$；\n2. $\\text{\\texttt{QUERY} \\textit{x}}$：求最小的整数 $p \\ (0 \\le p < n)$，使得 $\\gcd(a_0, a_1, \\cdots, a_p) \\times  \\operatorname{xor}(a_0, a_1, \\cdots, a_p) = x$。其中 $\\operatorname{xor}(a_0, a_1, \\cdots, a_p)$ 代表 $a_0, a_1, \\cdots, a_p$ 的异或和，$\\gcd$ 表示最大公约数。\n", "inputFormat": "第一行包含一个正整数 $n$。\n\n接下来一行包含 $n$ 个正整数 $a_0,a_1,\\cdots,a_{n-1}$。\n\n之后一行包含一个正整数 $q$，表示询问的个数。\n\n之后 $q$ 行，每行包含一个询问。格式如题目中所述。", "outputFormat": "对于每个 $\\texttt{QUERY}$ 询问，在单独的一行中输出结果。如果不存在这样的 $p$，输出 `no`。", "hint": "### 数据范围及约定\n\n- 对于 $30\\%$ 的数据，$n\\le10^4$，$q\\le 1000$。\n- 对于 $100\\%$ 的数据，$n\\le10^5$，$q\\le 10000$，$1\\le a_i\\le 10^9$，询问操作中 $x \\le 10^{18}$，修改操作中 $0\\le id<n$，$1\\le x\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P4109", "type": "P", "difficulty": 3, "samples": [["3\n998 1002\n998 2002\n4000 6000", "1000\n1000\n5000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "各省省选", "河北", "枚举", "分块"], "title": "[HEOI2015] 定价", "background": "", "description": "在市场上有很多商品的定价类似于 999 元、4999 元、8999 元这样。它们和 1000 元、5000 元和 9000 元并没有什么本质区别，但是在心理学上会让人感觉便宜很多，因此也是商家常用的价格策略。不过在你看来，这种价格十分荒谬。于是你如此计算一个价格 $p$（$p$ 为正整数）的荒谬程度：\n\n1. 首先将 $p$ 看做一个由数字组成的字符串（不带前导 $0$）；\n2. 然后，如果 $p$ 的最后一个字符是 $0$，就去掉它。重复这一过程，直到 $p$ 的最后一个字符不是 $0$；\n3. 记 $p$ 的长度为 $a$，如果此时 $p$ 的最后一位是 $5$，则荒谬程度为 $2a - 1$；否则为 $2a$。\n\n例如，$850$ 的荒谬程度为 $3$，而 $880$ 则为 $4$，$9999$ 的荒谬程度为 $8$。\n\n现在，你要出售一样闲置物品，你能接受的定价在 $[L, R]$ 范围内，你想要给出一个荒谬度最低的价格。", "inputFormat": "输入文件的第一行包含一个正整数 $T$，表示测试数据的数目。\n\n每个测试数据占单独的一行，包含两个空格分隔的正整数 $L, R$，表示定价的区间。", "outputFormat": "对于每个测试数据，在单独的一行内输出结果。如果荒谬度最低的价格不唯一，输出最小的那个。", "hint": "- 对于 $20\\%$ 的数据，$L, R \\leq 2000$；\n- 对于 $100\\%$ 的数据，$T \\leq 100$，$1 \\leq L \\leq R \\leq 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[HEOI2015] Pricing", "background": "", "description": "In the market, many goods are priced like 999 yuan, 4999 yuan, 8999 yuan. They are essentially no different from 1000 yuan, 5000 yuan, and 9000 yuan, but psychologically they make people feel much cheaper, so this is a common pricing strategy used by merchants. However, in your view, such prices are absurd. Therefore, you define the absurdity of a price $p$ ($p$ is a positive integer) as follows:\n\n1. First, treat $p$ as a string of digits (without leading $0$).\n2. Then, if the last character of $p$ is $0$, remove it. Repeat this process until the last character of $p$ is not $0$.\n3. Let the length of $p$ be $a$. If the last digit is $5$, the absurdity is $2a - 1$; otherwise, it is $2a$.\n\nFor example, the absurdity of 850 is 3, for 880 it is 4, and the absurdity of 9999 is 8.\n\nNow, you want to sell an idle item. The acceptable price is within the range $[L, R]$. You want to choose a price with the lowest absurdity.", "inputFormat": "The first line of input contains a positive integer $T$, indicating the number of testdata.\n\nEach test case is on a separate line and contains two space-separated positive integers $L, R$, indicating the pricing interval.", "outputFormat": "For each test case, output the result on a separate line. If the price with the lowest absurdity is not unique, output the smallest one.", "hint": "- For $20\\%$ of the testdata, $L, R \\leq 2000$.\n- For $100\\%$ of the testdata, $T \\leq 100$, $1 \\leq L \\leq R \\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HEOI2015] 定价", "background": "", "description": "在市场上有很多商品的定价类似于 999 元、4999 元、8999 元这样。它们和 1000 元、5000 元和 9000 元并没有什么本质区别，但是在心理学上会让人感觉便宜很多，因此也是商家常用的价格策略。不过在你看来，这种价格十分荒谬。于是你如此计算一个价格 $p$（$p$ 为正整数）的荒谬程度：\n\n1. 首先将 $p$ 看做一个由数字组成的字符串（不带前导 $0$）；\n2. 然后，如果 $p$ 的最后一个字符是 $0$，就去掉它。重复这一过程，直到 $p$ 的最后一个字符不是 $0$；\n3. 记 $p$ 的长度为 $a$，如果此时 $p$ 的最后一位是 $5$，则荒谬程度为 $2a - 1$；否则为 $2a$。\n\n例如，$850$ 的荒谬程度为 $3$，而 $880$ 则为 $4$，$9999$ 的荒谬程度为 $8$。\n\n现在，你要出售一样闲置物品，你能接受的定价在 $[L, R]$ 范围内，你想要给出一个荒谬度最低的价格。", "inputFormat": "输入文件的第一行包含一个正整数 $T$，表示测试数据的数目。\n\n每个测试数据占单独的一行，包含两个空格分隔的正整数 $L, R$，表示定价的区间。", "outputFormat": "对于每个测试数据，在单独的一行内输出结果。如果荒谬度最低的价格不唯一，输出最小的那个。", "hint": "- 对于 $20\\%$ 的数据，$L, R \\leq 2000$；\n- 对于 $100\\%$ 的数据，$T \\leq 100$，$1 \\leq L \\leq R \\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P4110", "type": "P", "difficulty": 6, "samples": [["3\n1 2\n0/1 3\n1 2\n1/1 3\n1 2\n1/2 3", "0.000000\n0.000000\n0.250000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "各省省选", "河北"], "title": "[HEOI2015] 小L的白日梦", "background": null, "description": "在某一天，你有了一个女性朋友。\n\n你打算利用 $k$ 天时间陪她，每天有很多种娱乐方式可供选择，你需要从中选择一种进行（一天只能进行一个项目），比如说一起去看电影、一起去主题公园，一起去逛街等等，一共 $n$ 种项目。当然每个项目重复太多次你都会觉得无聊，因此第 $i$ 个项目最多进行 $c_i$ 次。\n\n你虽然智商很高，但是情商堪忧，即使这些你准备的活动都是希望让她开心的，不过由于你笨拙的语言表达和过于理智的行动，可能使这些活动出现意外。经过你悉心的计算，你发现如果某一天进行了第 $i$ 个项目，如果一切顺利的话她应该是很高兴的，但她会有一定概率不高兴。如果她本来是很高兴的，但突然今天你让她不高兴了，她就会觉得很失落，并且对你的好感度大大下降。你希望尽可能避免这种情况发生，因此你要安排这 $k$ 天之内每天进行的项目，最小化她感到失落的期望次数。\n\n你的女性朋友十分在意你，所以她的心情只会因为你发生改变。第一天之前，因为你没有邀请她进行任何活动，所以她是不高兴的。", "inputFormat": "第一行有一个非负整数 $t$，表示一共有 $t$ 组数据。\n\n对于每组数据，第一行有两个非负整数 $n,k$，分别表示你准备的项目个数和你用来陪她的天数。$(1 \\le n \\le 10^5,1 \\le k \\le 10^9)$\n\n接下来 $n$ 行，每一行描述一个项目，形如 `x/y c` 且三个数均为非负整数，表示进行完这个项目之后她有 $\\dfrac{x_i}{y_i}$ 的概率不高兴，并且这个项目只能进行不超过 $c_i$ 次。$(x_i,y_i \\le 10^4,c_i \\le 10^9)$", "outputFormat": "一共 $t$ 行，对于每组数据输出使她感到失落的最小期望次数，四舍五入保留 $6$ 位小数。", "hint": "【样例说明】\n\n考虑第三组数据，因为只有一个项目所以只好每天都安排这个。\n\n在第一天之前她总是不高兴的，一共有：\n\n第一天不高兴，第二天也不高兴、\n\n第一天高兴，第二天不高兴、\n\n第一天不高兴，第二天高兴、\n\n第一天高兴，第二天也高兴。\n\n这四种情况，又因为每天的项目让她高兴或者是不高兴的概率都是 $50\\%$，因此这四种情况是等概率发生的。\n\n只有在第二种情况下，她会感到失落一次。\n\n因此答案是 $\\dfrac{0+1+0+0}{4}=0.25$。\n\n【数据规模与约定】\n\n对于前10%的数据，$n,k \\le 5$。\n\n对于前30%的数据，$n,k \\le 7$。\n\n对于前40%的数据，$n,k \\le 10$。\n\n对于前60%的数据，$n \\le 10^3,k \\le 10^5$。\n\n对于100%的数据，$1 \\le n \\le 10^5,1 \\le k \\le 10^9，1 \\le t \\le 10$，数据保证分数有意义并且 $\\sum\\limits_{i=1}^nc_i \\ge k$。", "locale": "zh-CN", "translations": {"en": {"title": "[HEOI2015] Xiao L's Daydream", "background": "", "description": "One day, you made a female friend.\n\nYou plan to spend $k$ days with her. Each day there are many types of activities to choose from, and you must choose exactly one to do that day (only one activity per day), such as going to the movies, going to a theme park, going shopping, and so on, for a total of $n$ activities. Of course, repeating the same activity too many times will feel boring to you, so the $i$-th activity can be done at most $c_i$ times.\n\nAlthough you have a high IQ, your EQ leaves much to be desired. Even though these activities are meant to make her happy, your awkward words and overly rational behavior may cause mishaps. After careful calculation, you find that if on some day you do the $i$-th activity, she should be happy if everything goes well, but there is a certain probability that she will be unhappy. If she would otherwise be happy but you make her unhappy today, she will feel very let down, and her favorable impression of you will drop sharply. You want to avoid this as much as possible, so you must schedule which activity to do each of the $k$ days to minimize the expected number of times she feels let down.\n\nShe cares a lot about you, so her mood changes only because of you. Before day 1, since you have not invited her to do any activity, she is unhappy.", "inputFormat": "The first line contains a non-negative integer $t$, the number of test cases.\n\nFor each test case, the first line contains two non-negative integers $n, k$, representing the number of activities you prepared and the number of days you will spend with her. $(1 \\le n \\le 10^5, 1 \\le k \\le 10^9)$\n\nThen follow $n$ lines, each describing one activity, in the form `x/y c`, where all three numbers are non-negative integers. It means that after doing this activity, she will be unhappy with probability $\\dfrac{x_i}{y_i}$, and this activity can be done at most $c_i$ times. $(x_i, y_i \\le 10^4, c_i \\le 10^9)$", "outputFormat": "Output $t$ lines. For each test case, print the minimal expected number of times she feels let down, rounded to 6 decimal places.", "hint": "[Sample Explanation]\n\nConsider the third test case. Since there is only one activity, you have to schedule it every day.\n\nBefore day 1 she is always unhappy. There are four cases:\nunhappy on day 1 and unhappy on day 2, happy on day 1 and unhappy on day 2, unhappy on day 1 and happy on day 2, happy on day 1 and happy on day 2. These four cases are equally likely because the activity makes her happy or unhappy each day with probability $50\\%$.\n\nOnly in the second case does she feel let down once.\n\nTherefore the answer is $\\dfrac{0+1+0+0}{4}=0.25$.\n\n[Constraints and Conventions]\n\nFor the first 10% of the testdata, $n, k \\le 5$.\n\nFor the first 30% of the testdata, $n, k \\le 7$.\n\nFor the first 40% of the testdata, $n, k \\le 10$.\n\nFor the first 60% of the testdata, $n \\le 10^3, k \\le 10^5$.\n\nFor 100% of the testdata, $1 \\le n \\le 10^5, 1 \\le k \\le 10^9, 1 \\le t \\le 10$. The testdata guarantees the fractions are meaningful and $\\sum\\limits_{i=1}^n c_i \\ge k$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HEOI2015] 小L的白日梦", "background": null, "description": "在某一天，你有了一个女性朋友。\n\n你打算利用 $k$ 天时间陪她，每天有很多种娱乐方式可供选择，你需要从中选择一种进行（一天只能进行一个项目），比如说一起去看电影、一起去主题公园，一起去逛街等等，一共 $n$ 种项目。当然每个项目重复太多次你都会觉得无聊，因此第 $i$ 个项目最多进行 $c_i$ 次。\n\n你虽然智商很高，但是情商堪忧，即使这些你准备的活动都是希望让她开心的，不过由于你笨拙的语言表达和过于理智的行动，可能使这些活动出现意外。经过你悉心的计算，你发现如果某一天进行了第 $i$ 个项目，如果一切顺利的话她应该是很高兴的，但她会有一定概率不高兴。如果她本来是很高兴的，但突然今天你让她不高兴了，她就会觉得很失落，并且对你的好感度大大下降。你希望尽可能避免这种情况发生，因此你要安排这 $k$ 天之内每天进行的项目，最小化她感到失落的期望次数。\n\n你的女性朋友十分在意你，所以她的心情只会因为你发生改变。第一天之前，因为你没有邀请她进行任何活动，所以她是不高兴的。", "inputFormat": "第一行有一个非负整数 $t$，表示一共有 $t$ 组数据。\n\n对于每组数据，第一行有两个非负整数 $n,k$，分别表示你准备的项目个数和你用来陪她的天数。$(1 \\le n \\le 10^5,1 \\le k \\le 10^9)$\n\n接下来 $n$ 行，每一行描述一个项目，形如 `x/y c` 且三个数均为非负整数，表示进行完这个项目之后她有 $\\dfrac{x_i}{y_i}$ 的概率不高兴，并且这个项目只能进行不超过 $c_i$ 次。$(x_i,y_i \\le 10^4,c_i \\le 10^9)$", "outputFormat": "一共 $t$ 行，对于每组数据输出使她感到失落的最小期望次数，四舍五入保留 $6$ 位小数。", "hint": "【样例说明】\n\n考虑第三组数据，因为只有一个项目所以只好每天都安排这个。\n\n在第一天之前她总是不高兴的，一共有：\n\n第一天不高兴，第二天也不高兴、\n\n第一天高兴，第二天不高兴、\n\n第一天不高兴，第二天高兴、\n\n第一天高兴，第二天也高兴。\n\n这四种情况，又因为每天的项目让她高兴或者是不高兴的概率都是 $50\\%$，因此这四种情况是等概率发生的。\n\n只有在第二种情况下，她会感到失落一次。\n\n因此答案是 $\\dfrac{0+1+0+0}{4}=0.25$。\n\n【数据规模与约定】\n\n对于前10%的数据，$n,k \\le 5$。\n\n对于前30%的数据，$n,k \\le 7$。\n\n对于前40%的数据，$n,k \\le 10$。\n\n对于前60%的数据，$n \\le 10^3,k \\le 10^5$。\n\n对于100%的数据，$1 \\le n \\le 10^5,1 \\le k \\le 10^9，1 \\le t \\le 10$，数据保证分数有意义并且 $\\sum\\limits_{i=1}^nc_i \\ge k$。", "locale": "zh-CN"}}}
{"pid": "P4111", "type": "P", "difficulty": 6, "samples": [["2 2\n..\n..\n", "4\n"], ["2 2\n*.\n.*\n", "0\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "各省省选", "矩阵树定理", "河北", "生成树", "素数判断,质数,筛法", "高斯消元"], "title": "[HEOI2015] 小 Z 的房间", "background": "", "description": "你突然有了一个大房子，房子里面有一些房间。事实上，你的房子可以看做是一个包含 $n\\times m$ 个格子的格状矩形，每个格子是一个房间或者是一个柱子。在一开始的时候，相邻的格子之间都有墙隔着。\n\n你想要打通一些相邻房间的墙，使得所有房间能够互相到达。在此过程中，你不能把房子给打穿，或者打通柱子（以及柱子旁边的墙）。同时，你不希望在房子中有小偷的时候会很难抓，所以你希望任意两个房间之间都只有一条通路。现在，你希望统计一共有多少种可行的方案，答案对 $10^9$ 取模。\n", "inputFormat": "第一行两个整数 $n,m$。\n\n接下来 $n$ 行，每行 $m$ 个字符 `.` 或 `*`，其中 `.` 代表房间，`*` 代表柱子。\n", "outputFormat": "一行一个整数，表示合法的方案数对 $10^9$ 取模后的值。", "hint": "#### 数据规模与约定\n\n- 对于 $20\\%$ 的数据，$n,m \\le 3$。\n- 对于 $50\\%$ 的数据，$n,m \\le 5$。\n- 有 $40\\%$ 的数据，$\\min(n,m) \\le 3$。\n- 有 $30\\%$ 的数据，不存在柱子。\n- 对于 $100\\%$ 的数据，$1 \\le n,m \\le 9$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[HEOI2015] Xiao Z's Room", "background": "", "description": "You suddenly have a big house, which contains some rooms. In fact, your house can be regarded as a grid rectangle with $n\\times m$ cells, where each cell is either a room or a pillar. Initially, there is a wall between every pair of adjacent cells.\n\nYou want to knock down some walls between adjacent rooms so that all rooms become mutually reachable. During this process, you must not break through the house boundary, nor open a pillar (as well as the walls next to a pillar). Meanwhile, you do not want it to be hard to catch thieves, so you require that there be exactly one path between any two rooms. Now, count how many feasible plans there are; output the answer modulo $10^9$.", "inputFormat": "The first line contains two integers $n,m$.\n\nThen follow $n$ lines, each containing $m$ characters `.` or `*`, where `.` denotes a room and `*` denotes a pillar.", "outputFormat": "Output a single integer, the number of valid plans modulo $10^9$.", "hint": "Constraints\n\n- For $20\\%$ of the testdata, $n,m \\le 3$.\n- For $50\\%$ of the testdata, $n,m \\le 5$.\n- For $40\\%$ of the testdata, $\\min(n,m) \\le 3$.\n- For $30\\%$ of the testdata, there are no pillars.\n- For $100\\%$ of the testdata, $1 \\le n,m \\le 9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HEOI2015] 小 Z 的房间", "background": "", "description": "你突然有了一个大房子，房子里面有一些房间。事实上，你的房子可以看做是一个包含 $n\\times m$ 个格子的格状矩形，每个格子是一个房间或者是一个柱子。在一开始的时候，相邻的格子之间都有墙隔着。\n\n你想要打通一些相邻房间的墙，使得所有房间能够互相到达。在此过程中，你不能把房子给打穿，或者打通柱子（以及柱子旁边的墙）。同时，你不希望在房子中有小偷的时候会很难抓，所以你希望任意两个房间之间都只有一条通路。现在，你希望统计一共有多少种可行的方案，答案对 $10^9$ 取模。\n", "inputFormat": "第一行两个整数 $n,m$。\n\n接下来 $n$ 行，每行 $m$ 个字符 `.` 或 `*`，其中 `.` 代表房间，`*` 代表柱子。\n", "outputFormat": "一行一个整数，表示合法的方案数对 $10^9$ 取模后的值。", "hint": "#### 数据规模与约定\n\n- 对于 $20\\%$ 的数据，$n,m \\le 3$。\n- 对于 $50\\%$ 的数据，$n,m \\le 5$。\n- 有 $40\\%$ 的数据，$\\min(n,m) \\le 3$。\n- 有 $30\\%$ 的数据，不存在柱子。\n- 对于 $100\\%$ 的数据，$1 \\le n,m \\le 9$。\n", "locale": "zh-CN"}}}
{"pid": "P4112", "type": "P", "difficulty": 6, "samples": [["aabbcc\nabcabc", "2\n4\n2\n4"], ["aabbcc\naabbcc", "-1\n-1\n2\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "各省省选", "河北", "后缀自动机 SAM", "O2优化", "广度优先搜索 BFS", "后缀数组 SA"], "title": "[HEOI2015] 最短不公共子串", "background": null, "description": "在虐各种最长公共子串、子序列的题虐的不耐烦了之后，你决定反其道而行之。\n\n下面给出一些定义：\n\n- 一个串的“子串”指的是它的连续的一段，例如 `bcd` 是 `abcdef` 的子串，但 `bde` 不是。\n- 一个串的“子序列”指的是它的可以不连续的一段，例如 `bde` 是 `abcdef` 的子序列，但 `bdd` 不是。\n\n下面，给两个小写字母串 $a, b$，请你计算：\n\n1. $a$ 的一个最短的子串，它不是 $b$ 的子串。\n2. $a$ 的一个最短的子串，它不是 $b$ 的子序列。\n3. $a$ 的一个最短的子序列，它不是 $b$ 的子串。\n4. $a$ 的一个最短的子序列，它不是 $b$ 的子序列。", "inputFormat": "有两行，每行一个小写字母组成的字符串，分别代表 $a$ 和 $b$。", "outputFormat": "输出 $4$ 行，每行一个整数，依次表示以上 $4$ 个问题的答案的长度。如果没有符合要求的答案，输出 $-1$。", "hint": "#### 数据规模与约定\n\n- 对于 $20\\%$ 的数据，保证 $a$ 和 $b$ 的长度都不超过 $20$。\n- 对于 $50\\%$ 的数据，保证 $a$ 和 $b$ 的长度都不超过 $500$。\n- 对于 $100\\%$ 的数据，保证 $a$ 和 $b$ 的长度都不超过 $2000$。", "locale": "zh-CN", "translations": {"en": {"title": "[HEOI2015] Shortest Uncommon Substring", "background": "", "description": "Tired of problems about the longest common substrings and subsequences, you decide to go the other way.\n\nDefinitions:\n- A \"substring\" of a string is a contiguous segment of it. For example, `bcd` is a substring of `abcdef`, but `bde` is not.\n- A \"subsequence\" of a string is a segment that does not need to be contiguous. For example, `bde` is a subsequence of `abcdef`, but `bdd` is not.\n\nGiven two lowercase strings $a, b$, please compute:\n1. A shortest substring of $a$ that is not a substring of $b$.\n2. A shortest substring of $a$ that is not a subsequence of $b$.\n3. A shortest subsequence of $a$ that is not a substring of $b$.\n4. A shortest subsequence of $a$ that is not a subsequence of $b$.", "inputFormat": "There are two lines, each containing a string of lowercase letters, representing $a$ and $b$ respectively.", "outputFormat": "Output $4$ lines, each containing one integer, representing the lengths of the answers to the above $4$ questions in order. If there is no valid answer, output $-1$.", "hint": "Constraints:\n- For $20\\%$ of the testdata, the lengths of $a$ and $b$ do not exceed $20$.\n- For $50\\%$ of the testdata, the lengths of $a$ and $b$ do not exceed $500$.\n- For $100\\%$ of the testdata, the lengths of $a$ and $b$ do not exceed $2000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HEOI2015] 最短不公共子串", "background": null, "description": "在虐各种最长公共子串、子序列的题虐的不耐烦了之后，你决定反其道而行之。\n\n下面给出一些定义：\n\n- 一个串的“子串”指的是它的连续的一段，例如 `bcd` 是 `abcdef` 的子串，但 `bde` 不是。\n- 一个串的“子序列”指的是它的可以不连续的一段，例如 `bde` 是 `abcdef` 的子序列，但 `bdd` 不是。\n\n下面，给两个小写字母串 $a, b$，请你计算：\n\n1. $a$ 的一个最短的子串，它不是 $b$ 的子串。\n2. $a$ 的一个最短的子串，它不是 $b$ 的子序列。\n3. $a$ 的一个最短的子序列，它不是 $b$ 的子串。\n4. $a$ 的一个最短的子序列，它不是 $b$ 的子序列。", "inputFormat": "有两行，每行一个小写字母组成的字符串，分别代表 $a$ 和 $b$。", "outputFormat": "输出 $4$ 行，每行一个整数，依次表示以上 $4$ 个问题的答案的长度。如果没有符合要求的答案，输出 $-1$。", "hint": "#### 数据规模与约定\n\n- 对于 $20\\%$ 的数据，保证 $a$ 和 $b$ 的长度都不超过 $20$。\n- 对于 $50\\%$ 的数据，保证 $a$ 和 $b$ 的长度都不超过 $500$。\n- 对于 $100\\%$ 的数据，保证 $a$ 和 $b$ 的长度都不超过 $2000$。", "locale": "zh-CN"}}}
{"pid": "P4113", "type": "P", "difficulty": 5, "samples": [["5 3 5\n1 2 2 3 1\n1 5\n1 2\n2 2\n2 3\n3 5", "2\n0\n0\n1\n0\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2012", "线段树", "各省省选", "树状数组", "河北", "排序", "前缀和", "扫描线", "离线处理"], "title": "[HEOI2012] 采花", "background": "", "description": "萧薰儿是古国的公主，平时的一大爱好是采花。\n\n今天天气晴朗，阳光明媚，公主清晨便去了皇宫中新建的花园采花。\n\n花园足够大，容纳了 $n$ 朵花，共有 $c$ 种颜色，用整数 $1 \\sim c$ 表示。且花是排成一排的，以便于公主采花。公主每次采花后会统计采到的花的颜色数，颜色数越多她会越高兴。同时，她有一癖好，她不允许最后自己采到的花中，某一颜色的花只有一朵。为此，公主每采一朵花，要么此前已采到此颜色的花，要么有相当正确的直觉告诉她，她必能再次采到此颜色的花。\n\n由于时间关系，公主只能走过花园连续的一段进行采花，便让女仆福涵洁安排行程。福涵洁综合各种因素拟定了 $m$ 个行程，然后一一向你询问公主能采到的花共有几种不同的颜色。", "inputFormat": "输入的第一行是三个用空格隔开的整数，分别代表花的个数 $n$，花的颜色数 $c$，以及行程数 $m$。\n\n输入的第二行是 $n$ 个用空格隔开的整数，第 $i$ 个整数代表第 $i$ 朵花的颜色 $x_i$。\n\n第 $3$ 行到第 $(m + 2)$ 行，每行两个整数 $l, r$，第 $(i + 2)$ 行的数字代表第 $i$ 次行程为第 $l$ 到第 $r$ 朵花。", "outputFormat": "共输出 $m$ 行，每行一个整数。第 $i$ 行的整数代表第 $i$ 次行程公主能采到的花共有几种不同的颜色。", "hint": "#### 输入输出样例 $1$ 解释\n\n共有五朵花，颜色分别为 $1,~2,~2,~3,~1$。\n\n对于第一次行程，公主采花的区间为 $[1, 5]$，可以采位置 $1,~2,~3,~5$ 处的花，共有 $1$ 和 $2$ 两种不同的颜色。\n\n对于第二次行程，公主采花的区间为 $[1, 2]$，但是颜色为 $1$ 和 $2$ 的花都只出现了一次，因此公主无花可采。\n\n对于第三次行程，公主采花的区间为 $[2, 2]$，但是颜色为 $2$ 的花只出现了一次，公主无花可采。\n\n对于第四次行程，公主采花的区间为 $[2, 3]$，可以采 $2,~3$ 位置的花，只有 $2$ 这一种颜色。\n\n对于第五次行程，公主采花的区间为 $[3,5]$，但是颜色为 $1, 2, 3$ 的花都只出现了一次，因此公主无花可采。\n\n#### 数据范围与约定\n\n**本题采用多测试点捆绑测试，共有两个子任务**。\n\n对于子任务 $1$，分值为 $100$ 分，保证 $1 \\leq n, c, m \\leq 3 \\times 10^5$。\n\n对于子任务 $2$，分值为 $100$ 分，保证 $1 \\leq n, c, m \\leq 2 \\times 10^6$。\n\n对于全部的测试点，保证 $1 \\leq x_i \\leq c$，$1 \\leq l \\leq r \\leq n$。", "locale": "zh-CN", "translations": {"en": {"title": "[HEOI2012] Picking Flowers", "background": "", "description": "Xiao Xun'er is the princess of an ancient kingdom, and one of her hobbies is picking flowers.\n\nToday the weather is fine and sunny, so the princess went to the newly built palace garden in the morning to pick flowers.\n\nThe garden is large enough to hold $n$ flowers in total, with $c$ colors labeled by integers $1 \\sim c$. The flowers are arranged in a single row to make it convenient for the princess to pick. After each picking session, the princess counts how many different colors she has collected; the more colors, the happier she is. At the same time, she has a quirk: she does not allow that, among the flowers she finally picks, any color appears only once. For this reason, every time she picks a flower, either she has already picked a flower of that color before, or her accurate intuition tells her she will be able to pick that color again.\n\nDue to time constraints, the princess can only walk through one continuous segment of the garden to pick flowers, so the maid Fuhan Jie arranged $m$ trips after considering various factors. For each trip, you are asked how many different colors the princess can collect.", "inputFormat": "The first line contains three space-separated integers, representing the number of flowers $n$, the number of colors $c$, and the number of trips $m$.\n\nThe second line contains $n$ space-separated integers. The $i$-th integer is the color $x_i$ of the $i$-th flower.\n\nFrom line $3$ to line $(m + 2)$, each line contains two integers $l, r$. On line $(i + 2)$, the numbers represent that the $i$-th trip covers flowers from the $l$-th to the $r$-th.", "outputFormat": "Output $m$ lines, one integer per line. The integer on the $i$-th line is the number of different colors the princess can collect on the $i$-th trip.", "hint": "Explanation for Sample 1:\n\nThere are five flowers, and their colors are $1,~2,~2,~3,~1$.\n\nFor the first trip, the picking interval is $[1, 5]$. She can pick the flowers at positions $1,~2,~3,~5$, so there are two different colors, $1$ and $2$.\n\nFor the second trip, the picking interval is $[1, 2]$, but the flowers of colors $1$ and $2$ each appear only once, so the princess cannot pick any flower.\n\nFor the third trip, the picking interval is $[2, 2]$, but color $2$ appears only once, so the princess cannot pick any flower.\n\nFor the fourth trip, the picking interval is $[2, 3]$. She can pick the flowers at positions $2,~3$, and there is only one color, $2$.\n\nFor the fifth trip, the picking interval is $[3,5]$, but colors $1, 2, 3$ each appear only once, so the princess cannot pick any flower.\n\nConstraints:\n\nThis problem uses bundled multi-test-point evaluation and has two subtasks.\n\nFor subtask $1$ (worth $100$ points), it is guaranteed that $1 \\leq n, c, m \\leq 3 \\times 10^5$.\n\nFor subtask $2$ (worth $100$ points), it is guaranteed that $1 \\leq n, c, m \\leq 2 \\times 10^6$.\n\nFor all test points, it is guaranteed that $1 \\leq x_i \\leq c$, $1 \\leq l \\leq r \\leq n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HEOI2012] 采花", "background": "", "description": "萧薰儿是古国的公主，平时的一大爱好是采花。\n\n今天天气晴朗，阳光明媚，公主清晨便去了皇宫中新建的花园采花。\n\n花园足够大，容纳了 $n$ 朵花，共有 $c$ 种颜色，用整数 $1 \\sim c$ 表示。且花是排成一排的，以便于公主采花。公主每次采花后会统计采到的花的颜色数，颜色数越多她会越高兴。同时，她有一癖好，她不允许最后自己采到的花中，某一颜色的花只有一朵。为此，公主每采一朵花，要么此前已采到此颜色的花，要么有相当正确的直觉告诉她，她必能再次采到此颜色的花。\n\n由于时间关系，公主只能走过花园连续的一段进行采花，便让女仆福涵洁安排行程。福涵洁综合各种因素拟定了 $m$ 个行程，然后一一向你询问公主能采到的花共有几种不同的颜色。", "inputFormat": "输入的第一行是三个用空格隔开的整数，分别代表花的个数 $n$，花的颜色数 $c$，以及行程数 $m$。\n\n输入的第二行是 $n$ 个用空格隔开的整数，第 $i$ 个整数代表第 $i$ 朵花的颜色 $x_i$。\n\n第 $3$ 行到第 $(m + 2)$ 行，每行两个整数 $l, r$，第 $(i + 2)$ 行的数字代表第 $i$ 次行程为第 $l$ 到第 $r$ 朵花。", "outputFormat": "共输出 $m$ 行，每行一个整数。第 $i$ 行的整数代表第 $i$ 次行程公主能采到的花共有几种不同的颜色。", "hint": "#### 输入输出样例 $1$ 解释\n\n共有五朵花，颜色分别为 $1,~2,~2,~3,~1$。\n\n对于第一次行程，公主采花的区间为 $[1, 5]$，可以采位置 $1,~2,~3,~5$ 处的花，共有 $1$ 和 $2$ 两种不同的颜色。\n\n对于第二次行程，公主采花的区间为 $[1, 2]$，但是颜色为 $1$ 和 $2$ 的花都只出现了一次，因此公主无花可采。\n\n对于第三次行程，公主采花的区间为 $[2, 2]$，但是颜色为 $2$ 的花只出现了一次，公主无花可采。\n\n对于第四次行程，公主采花的区间为 $[2, 3]$，可以采 $2,~3$ 位置的花，只有 $2$ 这一种颜色。\n\n对于第五次行程，公主采花的区间为 $[3,5]$，但是颜色为 $1, 2, 3$ 的花都只出现了一次，因此公主无花可采。\n\n#### 数据范围与约定\n\n**本题采用多测试点捆绑测试，共有两个子任务**。\n\n对于子任务 $1$，分值为 $100$ 分，保证 $1 \\leq n, c, m \\leq 3 \\times 10^5$。\n\n对于子任务 $2$，分值为 $100$ 分，保证 $1 \\leq n, c, m \\leq 2 \\times 10^6$。\n\n对于全部的测试点，保证 $1 \\leq x_i \\leq c$，$1 \\leq l \\leq r \\leq n$。", "locale": "zh-CN"}}}
{"pid": "P4114", "type": "P", "difficulty": 5, "samples": [["3\n1 2 1\n2 3 2\nQUERY 1 2\nCHANGE 1 3\nQUERY 1 2\nDONE", "1\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["线段树", "树链剖分"], "title": "Qtree1", "background": "**数据规模和 spoj 上有所不同**。", "description": "给定一棵 $n$ 个节点的树，有两种操作：  \n- `CHANGE i t` 把第 $i$ 条边的边权变成 $t$  \n- `QUERY a b` 输出从 $a$ 到 $b$ 的路径上最大的边权。当 $a=b$ 时，输出 $0$  ", "inputFormat": "第一行是一个整数 $n$，表示节点个数。  \n第二行到第 $n$ 行每行输入三个整数 $u,v,w$ ，分别表示 $u$ 与 $v$ 有一条边，边权是 $w$。  \n第 $n+1$ 行开始，一共有不定数量行，每一行先包含一个字符串，分别有以下三种可能：  \n\n- `CHANGE`  接下来包含两个整数 $x, t$ ，表示一次修改操作。  \n- `QUERY`  接下来包含两个正整数 $a, b$ ， 表示一次查询操作。  \n- `DONE`  表示输入结束。\n", "outputFormat": "对于每个 `QUERY` 操作，输出一行一个数，表示 $a,b$ 的路径上最大的边权。  ", "hint": "#### 数据规模与约定\n\n对于全部的测试点，保证：\n\n- $1 \\leq n \\leq 10^5$。\n- $1 \\leq u, v, a, b \\leq n$，$1 \\leq x < n$。\n- $1 \\leq w, t \\leq 2^{31} - 1$。\n- 操作次数不大于 $3 \\times 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "Qtree1", "background": "The constraints differ from those on SPOJ.", "description": "Given a tree with $n$ nodes, there are two operations:\n- `CHANGE i t` set the weight of the $i$-th edge to $t$.\n- `QUERY a b` output the maximum edge weight on the path from $a$ to $b$. When $a = b$, output $0$.", "inputFormat": "The first line contains an integer $n$, the number of nodes.\nLines $2$ through $n$ each contain three integers $u, v, w$, indicating that there is an edge between $u$ and $v$ with weight $w$.\nStarting from line $n + 1$, there are an unspecified number of lines. Each line starts with a string, which can be one of:\n- `CHANGE` followed by two integers $x, t$, indicating an update operation.\n- `QUERY` followed by two positive integers $a, b$, indicating a query operation.\n- `DONE` indicating the end of input.", "outputFormat": "For each `QUERY` operation, output one line with a single number: the maximum edge weight on the path between $a$ and $b$.", "hint": "Constraints\n\nFor all test points, it is guaranteed that:\n- $1 \\leq n \\leq 10^5$.\n- $1 \\leq u, v, a, b \\leq n$, $1 \\leq x < n$.\n- $1 \\leq w, t \\leq 2^{31} - 1$.\n- The number of operations does not exceed $3 \\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Qtree1", "background": "**数据规模和 spoj 上有所不同**。", "description": "给定一棵 $n$ 个节点的树，有两种操作：  \n- `CHANGE i t` 把第 $i$ 条边的边权变成 $t$  \n- `QUERY a b` 输出从 $a$ 到 $b$ 的路径上最大的边权。当 $a=b$ 时，输出 $0$  ", "inputFormat": "第一行是一个整数 $n$，表示节点个数。  \n第二行到第 $n$ 行每行输入三个整数 $u,v,w$ ，分别表示 $u$ 与 $v$ 有一条边，边权是 $w$。  \n第 $n+1$ 行开始，一共有不定数量行，每一行先包含一个字符串，分别有以下三种可能：  \n\n- `CHANGE`  接下来包含两个整数 $x, t$ ，表示一次修改操作。  \n- `QUERY`  接下来包含两个正整数 $a, b$ ， 表示一次查询操作。  \n- `DONE`  表示输入结束。\n", "outputFormat": "对于每个 `QUERY` 操作，输出一行一个数，表示 $a,b$ 的路径上最大的边权。  ", "hint": "#### 数据规模与约定\n\n对于全部的测试点，保证：\n\n- $1 \\leq n \\leq 10^5$。\n- $1 \\leq u, v, a, b \\leq n$，$1 \\leq x < n$。\n- $1 \\leq w, t \\leq 2^{31} - 1$。\n- 操作次数不大于 $3 \\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P4115", "type": "P", "difficulty": 6, "samples": [["3\n1 2 1\n1 3 1\n7\nA\nC 1\nA\nC 2\nA\nC 3\nA", "2\n2\n0\nThey have disappeared."]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["点分治", "堆", "O2优化", "分治", "树链剖分"], "title": "Qtree4", "background": "数据范围和 SPOJ 略有不同。", "description": "给出一棵边带权的节点数量为 $n$ 的树，初始树上所有节点都是白色。有两种操作：\n\n- `C x`，改变节点 $x$ 的颜色，即白变黑，黑变白。\n\n- `A`，询问树中最远的两个白色节点的距离，这两个白色节点可以重合（此时距离为 $0$）。", "inputFormat": "第一行，输入一个正整数 $n\\ (n \\le {10}^5$)。\n\n接下来 $n-1$ 行，每行有 $3$ 个整数 $a,b,c$，代表节点 $a$ 和节点 $b$ 之间连一条边权为 $c\\ (|c|\\le{10}^3)$ 的边。\n\n接下来一行，一个正整数 $q\\ (q\\le 2\\times 10^5)$，表示操作的数量。\n\n接下来 $q$ 行，每行一次操作。", "outputFormat": "对于每次 `A` 操作，如果树上不存在白点，输出一行一个字符串 `They have disappeared.`，否则输出一行一个整数代表树上最远的两个白色节点的距离。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "Qtree4", "background": "The Constraints here differ slightly from SPOJ.", "description": "You are given a tree with $n$ nodes, where each edge has a weight. Initially, all nodes are white. There are two types of operations:\n- `C x`: toggle the color of node $x$; white becomes black, and black becomes white.\n- `A`: query the distance between the farthest two white nodes in the tree. These two white nodes may coincide (in which case the distance is $0$).", "inputFormat": "The first line contains a positive integer $n$ ($n \\le 10^5$).\n\nEach of the next $n-1$ lines contains three integers $a$, $b$, $c$, representing an edge between nodes $a$ and $b$ with weight $c$ ($|c| \\le 10^3$).\n\nThe next line contains a positive integer $q$ ($q \\le 2\\times 10^5$), the number of operations.\n\nEach of the next $q$ lines contains one operation.", "outputFormat": "For each `A` operation, if there are no white nodes in the tree, output a line with the string `They have disappeared.`. Otherwise, output a line with one integer, the distance between the farthest two white nodes in the tree.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Qtree4", "background": "数据范围和 SPOJ 略有不同。", "description": "给出一棵边带权的节点数量为 $n$ 的树，初始树上所有节点都是白色。有两种操作：\n\n- `C x`，改变节点 $x$ 的颜色，即白变黑，黑变白。\n\n- `A`，询问树中最远的两个白色节点的距离，这两个白色节点可以重合（此时距离为 $0$）。", "inputFormat": "第一行，输入一个正整数 $n\\ (n \\le {10}^5$)。\n\n接下来 $n-1$ 行，每行有 $3$ 个整数 $a,b,c$，代表节点 $a$ 和节点 $b$ 之间连一条边权为 $c\\ (|c|\\le{10}^3)$ 的边。\n\n接下来一行，一个正整数 $q\\ (q\\le 2\\times 10^5)$，表示操作的数量。\n\n接下来 $q$ 行，每行一次操作。", "outputFormat": "对于每次 `A` 操作，如果树上不存在白点，输出一行一个字符串 `They have disappeared.`，否则输出一行一个整数代表树上最远的两个白色节点的距离。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4116", "type": "P", "difficulty": 5, "samples": [["9 8\n1 2\n1 3\n2 4\n2 9\n5 9\n7 9\n8 9\n6 8\n1 3\n0 8\n1 6\n1 7\n0 2\n1 9\n0 2\n1 9 ", "-1\n8\n-1\n2\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["线段树", "树状数组", "O2优化", "枚举", "树链剖分", "动态树 LCT", "分块"], "title": "Qtree3", "background": "", "description": "给出 $N$ 个点的一棵树（$N-1$ 条边），节点有白有黑，初始全为白。\n\n有两种操作：\n\n`0 i`：改变某点的颜色（原来是黑的变白，原来是白的变黑）。\n\n`1 v`：询问 $1$ 到 $v$ 的路径上的第一个黑点，若无，输出 $-1$。", "inputFormat": "第一行 $N$，$Q$，表示 $N$ 个点和 $Q$ 个操作。\n\n第二行到第 $N$ 行 $N-1$ 条无向边。\n\n再之后 $Q$ 行，每行一个操作 `0 i` 或者 `1 v`。", "outputFormat": "对每个 `1 v` 操作输出结果\n", "hint": "对于 $1/3$ 的数据有 $N=5000,Q=400000$。\n\n对于 $1/3$ 的数据有 $N=10000,Q=300000$。\n\n对于 $1/3$ 的数据有 $N=100000, Q=100000$。\n\n此外，有$1 \\le i,v \\le N$。", "locale": "zh-CN", "translations": {"en": {"title": "Qtree3", "background": "", "description": "Given a tree with $N$ nodes ($N-1$ edges). Each node is either white or black, and initially all nodes are white.\n\nThere are two operations:\n\n`0 i`: Toggle the color of a node (black becomes white, white becomes black).\n\n`1 v`: Query the first black node on the path from $1$ to $v$; if none, output -1.", "inputFormat": "The first line contains $N$ and $Q$, the number of nodes and the number of operations.\n\nLines $2$ through $N$ contain the $N-1$ undirected edges.\n\nThen $Q$ lines follow, each containing one operation `0 i` or `1 v`.", "outputFormat": "For each `1 v` operation, output the result.", "hint": "For $1/3$ of the testdata, $N=5000,Q=400000$.\n\nFor $1/3$ of the testdata, $N=10000,Q=300000$.\n\nFor $1/3$ of the testdata, $N=100000, Q=100000$.\n\nIn addition, $1 \\le i,v \\le N$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Qtree3", "background": "", "description": "给出 $N$ 个点的一棵树（$N-1$ 条边），节点有白有黑，初始全为白。\n\n有两种操作：\n\n`0 i`：改变某点的颜色（原来是黑的变白，原来是白的变黑）。\n\n`1 v`：询问 $1$ 到 $v$ 的路径上的第一个黑点，若无，输出 $-1$。", "inputFormat": "第一行 $N$，$Q$，表示 $N$ 个点和 $Q$ 个操作。\n\n第二行到第 $N$ 行 $N-1$ 条无向边。\n\n再之后 $Q$ 行，每行一个操作 `0 i` 或者 `1 v`。", "outputFormat": "对每个 `1 v` 操作输出结果\n", "hint": "对于 $1/3$ 的数据有 $N=5000,Q=400000$。\n\n对于 $1/3$ 的数据有 $N=10000,Q=300000$。\n\n对于 $1/3$ 的数据有 $N=100000, Q=100000$。\n\n此外，有$1 \\le i,v \\le N$。", "locale": "zh-CN"}}}
{"pid": "P4117", "type": "P", "difficulty": 7, "samples": [["5 6\n1 5 5 5 8\n2 2 5 5\n1 2 4 3\n2 2 5 2\n2 2 5 5\n1 3 5 1\n2 1 5 1", "3\n3\n0\n3"]], "limits": {"time": [7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2018", "并查集", "O2优化", "分块", "Ynoi"], "title": "[Ynoi2018] 五彩斑斓的世界", "background": "……羽毛\n\n从天而降的羽毛\n\n如雪一般的纯白，\n\n在海风中摇曳，\n\n在凉风中舞动，\n\n仿佛要将谁的心带走一样——神仙的羽毛。\n\n……\n\n“求求你”\n\n谁这样说到\n\n“求求你了”\n\n“救救我们”\n\n……梦\n\n我知道的，这是一场梦\n\n随即，那个人又说话了，在我这纯白的梦里\n\n“我们会一直在这里等着的……”\n\n于是，我踏上了漫长的旅途\n\n我有着非去不可的地方\n\n为了实现那个人的愿望\n\n所以我想，如果……\n\n如果，我的愿望能够实现的话。\n\n那样的话，或许，我和你……\n \n![](https://cdn.luogu.com.cn/upload/pic/13166.png) \n\n……世界终结了\n\n已经终结了\n\n我没赶上，不管什么，所有的事情……\n\n……可憎\n\n不可原谅\n\n我……\n\n……我、绝对、不会原谅你\n\n现在、就出发……\n\n我一定……一定要，把你……！\n\n![](https://cdn.luogu.com.cn/upload/pic/13167.png) \n\n手……牵着手，就能连着心\n\n……我的左手，没有牵着任何人的，我的手\n\n ![](https://cdn.luogu.com.cn/upload/image_hosting/of3qws6f.png)\n\n实现愿望。\n\n只留下这个事实，然后我们两人就会分别。\n\n就是希望着这一点，我们才会两个人一起走到今天。\n\n是这样吧？\n\n![](https://cdn.luogu.com.cn/upload/pic/13168.png) \n\n来，出发吧，去选择那独一无二的明天\n\n![](https://cdn.luogu.com.cn/upload/pic/13169.png)\n", "description": "二阶堂真红给了你一个长为 $n$ 的序列 $a$，有 $m$ 次操作\n\n1. 把区间 $[l,r]$ 中大于 $x$ 的数减去 $x$。\n2. 查询区间 $[l,r]$ 中 $x$ 的出现次数。\n", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示序列 $a$。\n\n接下来 $m$ 行，每行四个整数：\n\n- `1 l r x`：把区间 $[l,r]$ 所有大于 $x$ 的数减去 $x$。\n- `2 l r x`：查询区间 $[l,r]$ 内的 $x$ 的出现次数。\n", "outputFormat": "对于每个询问，输出一个整数表示答案。\n", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^6$，$1\\le m\\le 5\\times 10^5$，$1\\le l\\le r \\le n$，$0 \\le a_i,x \\le 10^5+1$。\n\nBy nzhtl1477\n", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2018] The Colorful World", "background": "...Feathers.\n\nFeathers falling from the sky.\n\nPure white, like snow,\n\nswaying in the sea breeze,\n\ndancing in the cool wind,\n\nas if trying to carry away someone's heart—divine feathers.\n\n...\n\n\"Please.\"\n\nWho said that?\n\n\"Please.\"\n\n\"Save us.\"\n\n...A dream.\n\nI know this is a dream.\n\nThen, that person spoke again, in my pure white dream:\n\n\"We will always be waiting here...\"\n\nSo, I set off on a long journey.\n\nThere is a place I must go.\n\nTo fulfill that person's wish.\n\nSo I think, if...\n\nif my wish could come true,\n\nthen maybe, you and I...\n\n![](https://cdn.luogu.com.cn/upload/pic/13166.png)\n\n...The world has ended.\n\nIt has already ended.\n\nI was too late—no matter what, everything...\n\n...Hateful.\n\nUnforgivable.\n\nI...\n\n...I will absolutely never forgive you.\n\nNow, set out...\n\nI will... I will definitely... take you...!\n\n![](https://cdn.luogu.com.cn/upload/pic/13167.png)\n\nHand... hand in hand, and hearts can be connected.\n\n...My left hand is not holding anyone. It is my hand.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/of3qws6f.png)\n\nGrant the wish.\n\nOnly this fact will remain, and then the two of us will part.\n\nIt was in hope of this that the two of us walked together until today.\n\nIs that so?\n\n![](https://cdn.luogu.com.cn/upload/pic/13168.png)\n\nCome, let's set out, to choose that one-and-only tomorrow.\n\n![](https://cdn.luogu.com.cn/upload/pic/13169.png)", "description": "Erjiedang Zhenhong gives you a sequence $a$ of length $n$, with $m$ operations.\n\n1. For every number greater than $x$ in the interval $[l,r]$, subtract $x$ from it.\n2. Query the number of occurrences of $x$ in the interval $[l,r]$.", "inputFormat": "The first line contains two integers $n$ and $m$.\n\nThe second line contains $n$ integers representing the sequence $a$.\n\nThen follow $m$ lines, each containing four integers:\n\n- `1 l r x`: For all numbers greater than $x$ in $[l,r]$, subtract $x$.\n- `2 l r x`: Query the number of occurrences of $x$ in $[l,r]`.", "outputFormat": "For each type-2 query, output one integer representing the answer.", "hint": "Idea: nzhtl1477, Solution: nzhtl1477, Code: nzhtl1477, Data: nzhtl1477.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 10^6$, $1 \\le m \\le 5 \\times 10^5$, $1 \\le l \\le r \\le n$, $0 \\le a_i, x \\le 10^5 + 1$.\n\nBy nzhtl1477.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2018] 五彩斑斓的世界", "background": "……羽毛\n\n从天而降的羽毛\n\n如雪一般的纯白，\n\n在海风中摇曳，\n\n在凉风中舞动，\n\n仿佛要将谁的心带走一样——神仙的羽毛。\n\n……\n\n“求求你”\n\n谁这样说到\n\n“求求你了”\n\n“救救我们”\n\n……梦\n\n我知道的，这是一场梦\n\n随即，那个人又说话了，在我这纯白的梦里\n\n“我们会一直在这里等着的……”\n\n于是，我踏上了漫长的旅途\n\n我有着非去不可的地方\n\n为了实现那个人的愿望\n\n所以我想，如果……\n\n如果，我的愿望能够实现的话。\n\n那样的话，或许，我和你……\n \n![](https://cdn.luogu.com.cn/upload/pic/13166.png) \n\n……世界终结了\n\n已经终结了\n\n我没赶上，不管什么，所有的事情……\n\n……可憎\n\n不可原谅\n\n我……\n\n……我、绝对、不会原谅你\n\n现在、就出发……\n\n我一定……一定要，把你……！\n\n![](https://cdn.luogu.com.cn/upload/pic/13167.png) \n\n手……牵着手，就能连着心\n\n……我的左手，没有牵着任何人的，我的手\n\n ![](https://cdn.luogu.com.cn/upload/image_hosting/of3qws6f.png)\n\n实现愿望。\n\n只留下这个事实，然后我们两人就会分别。\n\n就是希望着这一点，我们才会两个人一起走到今天。\n\n是这样吧？\n\n![](https://cdn.luogu.com.cn/upload/pic/13168.png) \n\n来，出发吧，去选择那独一无二的明天\n\n![](https://cdn.luogu.com.cn/upload/pic/13169.png)\n", "description": "二阶堂真红给了你一个长为 $n$ 的序列 $a$，有 $m$ 次操作\n\n1. 把区间 $[l,r]$ 中大于 $x$ 的数减去 $x$。\n2. 查询区间 $[l,r]$ 中 $x$ 的出现次数。\n", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示序列 $a$。\n\n接下来 $m$ 行，每行四个整数：\n\n- `1 l r x`：把区间 $[l,r]$ 所有大于 $x$ 的数减去 $x$。\n- `2 l r x`：查询区间 $[l,r]$ 内的 $x$ 的出现次数。\n", "outputFormat": "对于每个询问，输出一个整数表示答案。\n", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^6$，$1\\le m\\le 5\\times 10^5$，$1\\le l\\le r \\le n$，$0 \\le a_i,x \\le 10^5+1$。\n\nBy nzhtl1477\n", "locale": "zh-CN"}}}
