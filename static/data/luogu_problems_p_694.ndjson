{"pid": "P15067", "type": "P", "difficulty": 1, "samples": [["3", "41 60"], ["14", "261 280"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2024", "UOI（乌克兰）"], "title": "[UOI 2024 II Stage] Job Applications", "background": "", "description": "After finishing university, Anton decided to start looking for a job.\n\nHe immediately went to the $\\tt{ConnectedIn}$ website. When he went to the \"Vacancies\" tab, he saw a lot of job openings. However, the exact number of vacancies was not specified on the website. He knows that there are a maximum of $20$ vacancies on each page, and the vacancies take up $n$ pages.\n\nYou have a good understanding of how the website works. When a new vacancy is added, it is added to the last page. If there are already $20$ vacancies on the last page before adding a new one, a new page is created and the vacancy is added there.\n\nKnowing this information, determine the minimum and maximum number of vacancies.", "inputFormat": "The first line of the input contains a single integer $n$ ($1 \\le n \\le 100$) --- the number of pages with vacancies.", "outputFormat": "Print two integers --- the minimum and maximum number of vacancies that could be on the website.", "hint": "", "locale": "en", "translations": {"en": {"title": "[UOI 2024 II Stage] Job Applications", "background": "", "description": "After finishing university, Anton decided to start looking for a job.\n\nHe immediately went to the $\\tt{ConnectedIn}$ website. When he went to the \"Vacancies\" tab, he saw a lot of job openings. However, the exact number of vacancies was not specified on the website. He knows that there are a maximum of $20$ vacancies on each page, and the vacancies take up $n$ pages.\n\nYou have a good understanding of how the website works. When a new vacancy is added, it is added to the last page. If there are already $20$ vacancies on the last page before adding a new one, a new page is created and the vacancy is added there.\n\nKnowing this information, determine the minimum and maximum number of vacancies.", "inputFormat": "The first line of the input contains a single integer $n$ ($1 \\le n \\le 100$) --- the number of pages with vacancies.", "outputFormat": "Print two integers --- the minimum and maximum number of vacancies that could be on the website.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[UOI 2024 II Stage] Job Applications", "background": "", "description": "大学毕业后，Anton 决定开始找工作。\n\n他立刻访问了 $\\tt{ConnectedIn}$ 网站。当他打开“职位”标签时，看到了很多工作机会。然而，网站上并未明确标注职位的具体数量。他知道每页最多显示 $20$ 个职位，且职位总共占据 $n$ 页。\n\n你非常了解该网站的工作原理。当新增一个职位时，它会被添加到最后一页。如果在添加新职位之前，最后一页已经包含了 $20$ 个职位，则会创建一个新页，并将该职位添加到新页中。\n\n根据这些信息，请确定职位数量的最小值和最大值。", "inputFormat": "输入的第一行包含一个整数 $n$（$1 \\le n \\le 100$）——显示职位的页面数。\n", "outputFormat": "输出两个整数——网站可能拥有的职位数量的最小值和最大值。\n", "hint": "", "locale": "zh-CN"}}}
{"pid": "P15068", "type": "P", "difficulty": 2, "samples": [[".X.\n.X.\n00.\n.X.\n.X.\n000", "NO"], [".XX\n.00\n...\nXXX\n.00\n...", "YES"], ["XXX\n000\n...\nXXX\n000\n.X.", "YES"], ["0X0\nX.X\n0X0\nX0X\n0.0\nX0X", "NO"], [".X.\n...\n...\n.X.\n...\n...", "YES"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2024", "枚举", "UOI（乌克兰）"], "title": "[UOI 2024 II Stage] Tic-Tac-Toe", "background": "", "description": "You were playing tic-tac-toe with a friend online. However, there was a problem, another air raid in your area! Being a responsible person, you go to the bomb shelter. After the alarm is over, you come back to finish the game, but something is not right. Your friend may have cheated and changed the board.\n\nYou remember the game board $A$ as it was. Upon returning, you see the same game and the board $B$. Can you tell if it is possible to obtain board $B$ from board $A$ in no more than one move, made according to the rules?\n\nPlease note that the first move is made by the player placing the $\\textbf{X}$. Also, the standard rule that the game stops if there are three X's or O's in a row does not apply here.", "inputFormat": "The first three lines contain three symbols $A_{i, j}$ each, describing the initial board.\n\nThe next three lines contain three symbols $B_{i, j}$ each, describing the final board.\n\nEach cell of the board is described by three symbols:\n- $\\tt{.}$ --- denotes an empty cell;\n- $\\tt{0}$ --- denotes a placed O;\n- $\\tt{X}$ --- denotes a placed X.\n\nIt is guaranteed that board A can be obtained by a sequence of valid moves from an empty board.", "outputFormat": "Output $\\tt{YES}$ or $\\tt{NO}$ (in any case) depending on whether it was possible to obtain board $B$ from board $A$.", "hint": "In the first example, one O is added, but it is now the turn to place an X.\n\nIn the second example, one X is added.\n\nIn the third example, one X is also added. Note that despite having three O's (and X's) in a row, the game does not stop.\n\nIn the fourth example, the board is altered.\n\nIn the fifth example, no moves were made.", "locale": "en", "translations": {"en": {"title": "[UOI 2024 II Stage] Tic-Tac-Toe", "background": "", "description": "You were playing tic-tac-toe with a friend online. However, there was a problem, another air raid in your area! Being a responsible person, you go to the bomb shelter. After the alarm is over, you come back to finish the game, but something is not right. Your friend may have cheated and changed the board.\n\nYou remember the game board $A$ as it was. Upon returning, you see the same game and the board $B$. Can you tell if it is possible to obtain board $B$ from board $A$ in no more than one move, made according to the rules?\n\nPlease note that the first move is made by the player placing the $\\textbf{X}$. Also, the standard rule that the game stops if there are three X's or O's in a row does not apply here.", "inputFormat": "The first three lines contain three symbols $A_{i, j}$ each, describing the initial board.\n\nThe next three lines contain three symbols $B_{i, j}$ each, describing the final board.\n\nEach cell of the board is described by three symbols:\n- $\\tt{.}$ --- denotes an empty cell;\n- $\\tt{0}$ --- denotes a placed O;\n- $\\tt{X}$ --- denotes a placed X.\n\nIt is guaranteed that board A can be obtained by a sequence of valid moves from an empty board.", "outputFormat": "Output $\\tt{YES}$ or $\\tt{NO}$ (in any case) depending on whether it was possible to obtain board $B$ from board $A$.", "hint": "In the first example, one O is added, but it is now the turn to place an X.\n\nIn the second example, one X is added.\n\nIn the third example, one X is also added. Note that despite having three O's (and X's) in a row, the game does not stop.\n\nIn the fourth example, the board is altered.\n\nIn the fifth example, no moves were made.", "locale": "en"}, "zh-CN": {"title": "[UOI 2024 II Stage] Tic-Tac-Toe", "background": "", "description": "你正在网上和朋友玩井字棋。然而，出了点问题，你所在的地区又发生了空袭！作为一个有责任心的人，你前往防空洞躲避。警报解除后，你回来想完成游戏，但有些不对劲。你的朋友可能作弊并改变了棋盘。\n\n你记得游戏棋盘 $A$ 原来的样子。回来后，你看到的是同一局游戏和棋盘 $B$。你能判断是否有可能在不超过一步合法操作的情况下，从棋盘 $A$ 得到棋盘 $B$ 吗？\n\n请注意，**X** 玩家先手。此外，标准的“当一行中出现三个 X 或 O 时游戏结束”规则在这里不适用。", "inputFormat": "-   前三行每行包含三个符号 $A_{i, j}$，描述初始棋盘。\n-   接下来三行每行包含三个符号 $B_{i, j}$，描述最终棋盘。\n\n棋盘的每个单元格由以下三种符号描述：\n-   $\\tt{.}$ —— 表示空单元格；\n-   $\\tt{0}$ —— 表示已放置的 O；\n-   $\\tt{X}$ —— 表示已放置的 X。\n\n保证棋盘 A 可以通过一系列合法操作从空棋盘得到。", "outputFormat": "根据是否可能从棋盘 $A$ 得到棋盘 $B$，输出 `YES` 或 `NO`（大小写均可）。\n", "hint": "在第一个示例中，添加了一个 O，但现在应该是放置 X 的回合。\n\n在第二个示例中，添加了一个 X。\n\n在第三个示例中，也添加了一个 X。请注意，尽管有三个 O（和 X）连成一行，但游戏并未停止。\n\n在第四个示例中，棋盘被修改了。\n\n在第五个示例中，没有进行任何操作。\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P15069", "type": "P", "difficulty": 3, "samples": [["2 2\n1 2\n2 3", "0.600000"], ["5 2\n1 2 3 2 3\n2 4 2 5 3", "1.200000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "二分", "2024", "Special Judge", "分数规划", "UOI（乌克兰）"], "title": "[UOI 2024 II Stage] Disco", "background": "", "description": "Anton, as a teacher at school, is organizing a disco for the children. He has been tasked with selecting a playlist so that everyone is thrilled with the celebration. But Anton has a huge database of songs, and unfortunately, the time for the disco is limited :(.\n\nSpecifically, there are $n$ songs in the database. Each song can be characterized by two integers $t_i$ and $r_i$ --- the length of the song and its rating. As a music lover, Anton wants to select $\\textbf{exactly}$ $k$ songs (i.e., not fewer) to maximize the ratio of the sum of ratings to the sum of lengths.\n\nMore formally, let $S$ be the set of songs and $X \\subseteq S$, $|X|=k$ --- a subset of songs that have been selected for the playlist. The goal is to maximize $\\displaystyle \\frac{\\sum_{i \\in X} r_i}{\\sum_{i \\in X} t_i}$. In other words, it is necessary to find the sum of the numbers $r_i$ of all the songs that will be played at the disco, find the sum of the numbers $t_i$ of all the songs that will be played at the disco, and divide the former by the latter. This number needs to be maximized.\n\nFind and output the maximum possible ratio.", "inputFormat": "The first line contains two integers $n$, $k$ ($1 \\le k \\le n \\le 10^5$) --- the total number of songs and the number of songs to be selected for the playlist.\n\nThe second line contains $n$ integers $r_i$ ($1 \\le r_i \\le 10^5$).\n\nThe third line contains $n$ integers $t_i$ ($1 \\le t_i \\le 10^5$).", "outputFormat": "Output a single number --- the maximum ratio.\n\nYour answer will be considered correct if its absolute or relative error does not exceed $10^{-4}$.\n\nFormally, let your answer be $a$, and the jury's answer be $b$. Your answer will be accepted if and only if $\\frac{|a - b|}{\\max{(1, |b|)}} \\le 10^{-4}$.", "hint": "In the first example, there are two songs that need to be added to the playlist. Therefore, the ratio will be:\n$$\\frac{1+2}{2+3}=\\frac{3}{5}=0.6$$\n\nIn the second example, it is best to take the third and fifth songs. Therefore, the ratio will be:\n$$\\frac{3+3}{2+3}=\\frac{6}{5}=1.2$$", "locale": "en", "translations": {"en": {"title": "[UOI 2024 II Stage] Disco", "background": "", "description": "Anton, as a teacher at school, is organizing a disco for the children. He has been tasked with selecting a playlist so that everyone is thrilled with the celebration. But Anton has a huge database of songs, and unfortunately, the time for the disco is limited :(.\n\nSpecifically, there are $n$ songs in the database. Each song can be characterized by two integers $t_i$ and $r_i$ --- the length of the song and its rating. As a music lover, Anton wants to select $\\textbf{exactly}$ $k$ songs (i.e., not fewer) to maximize the ratio of the sum of ratings to the sum of lengths.\n\nMore formally, let $S$ be the set of songs and $X \\subseteq S$, $|X|=k$ --- a subset of songs that have been selected for the playlist. The goal is to maximize $\\displaystyle \\frac{\\sum_{i \\in X} r_i}{\\sum_{i \\in X} t_i}$. In other words, it is necessary to find the sum of the numbers $r_i$ of all the songs that will be played at the disco, find the sum of the numbers $t_i$ of all the songs that will be played at the disco, and divide the former by the latter. This number needs to be maximized.\n\nFind and output the maximum possible ratio.", "inputFormat": "The first line contains two integers $n$, $k$ ($1 \\le k \\le n \\le 10^5$) --- the total number of songs and the number of songs to be selected for the playlist.\n\nThe second line contains $n$ integers $r_i$ ($1 \\le r_i \\le 10^5$).\n\nThe third line contains $n$ integers $t_i$ ($1 \\le t_i \\le 10^5$).", "outputFormat": "Output a single number --- the maximum ratio.\n\nYour answer will be considered correct if its absolute or relative error does not exceed $10^{-4}$.\n\nFormally, let your answer be $a$, and the jury's answer be $b$. Your answer will be accepted if and only if $\\frac{|a - b|}{\\max{(1, |b|)}} \\le 10^{-4}$.", "hint": "In the first example, there are two songs that need to be added to the playlist. Therefore, the ratio will be:\n$$\\frac{1+2}{2+3}=\\frac{3}{5}=0.6$$\n\nIn the second example, it is best to take the third and fifth songs. Therefore, the ratio will be:\n$$\\frac{3+3}{2+3}=\\frac{6}{5}=1.2$$", "locale": "en"}, "zh-CN": {"title": "[UOI 2024 II Stage] Disco", "background": "", "description": "Anton 作为一名学校教师，正在为孩子们组织一场迪斯科舞会。他的任务是挑选一份播放列表，让每个人都对庆祝活动兴奋不已。但 Anton 有一个庞大的歌曲数据库，遗憾的是，迪斯科舞会的时间有限 :(。\n\n具体来说，数据库中有 $n$ 首歌曲。每首歌曲可以用两个整数 $t_i$ 和 $r_i$ 来描述——歌曲的时长和评分。作为一名音乐爱好者，Anton 希望**恰好**选择 $k$ 首歌曲（即不少于 $k$ 首），以最大化评分总和与时长总和的比值。\n\n更正式地说，设 $S$ 为歌曲集合，$X \\subseteq S$，$|X|=k$ 为已选入播放列表的歌曲子集。目标是最大化 $\\displaystyle \\frac{\\sum_{i \\in X} r_i}{\\sum_{i \\in X} t_i}$。换句话说，需要找出将在迪斯科舞会上播放的所有歌曲的 $r_i$ 之和，再找出将在迪斯科舞会上播放的所有歌曲的 $t_i$ 之和，并用前者除以后者。需要最大化这个数值。\n\n请找出并输出可能的最大比值。", "inputFormat": "-   第一行包含两个整数 $n$、$k$（$1 \\le k \\le n \\le 10^5$）——歌曲总数和需选入播放列表的歌曲数量。\n-   第二行包含 $n$ 个整数 $r_i$（$1 \\le r_i \\le 10^5$）。\n-   第三行包含 $n$ 个整数 $t_i$（$1 \\le t_i \\le 10^5$）。", "outputFormat": "输出一个数字——最大比值。\n\n只要你的答案的绝对误差或相对误差不超过 $10^{-4}$，即被视为正确。\n\n形式化地说，设你的答案为 $a$，标准的答案为 $b$。当且仅当 $\\frac{|a - b|}{\\max{(1, |b|)}} \\le 10^{-4}$ 时，你的答案会被接受。", "hint": "在第一个示例中，需要将两首歌曲加入播放列表。因此，比值为：\n$$\\frac{1+2}{2+3}=\\frac{3}{5}=0.6$$\n\n在第二个示例中，最好选择第三首和第五首歌曲。因此，比值为：\n$$\\frac{3+3}{2+3}=\\frac{6}{5}=1.2$$\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P15070", "type": "P", "difficulty": 4, "samples": [["5 2 6\n1 3 4 2 5", "3"], ["2 1 1\n1 1", "1"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "线段树", "2024", "UOI（乌克兰）"], "title": "[UOI 2024 II Stage] Sequence", "background": "", "description": "Anton is under pressure --- he has to submit all the assignments. As often happens --- he cannot extend the deadline...\n\nYou are given a sequence $a$ of $n$ integers, and two integers $l$ and $r$. You need to find the longest subsequence $b$ of the sequence $a$ such that $l \\le b_i + b_{i+1} \\le r$ ($1 \\le i < |b|$). Here, $|b|$ denotes the number of elements in the sequence $b$. In other words, you need to select a subsequence such that the sum of any two adjacent numbers is not less than $l$ and not greater than $r$.\n\nA subsequence of an array is a sequence that can be obtained by deleting several (possibly none) elements from the original sequence.", "inputFormat": "The first line contains three integers $n$, $l$, $r$ ($1 \\le n \\le 5 \\cdot 10^5$, $1 \\le l \\le r \\le 10^{17}$).\n\nThe second line contains $n$ integers $a_i$ ($1 \\le a_i \\le r$) --- the description of the sequence.", "outputFormat": "Output a single integer --- the maximum length of such a subsequence $b$.", "hint": "In the first example, you can select the subsequence $[1, 3, 2]$. $2 \\leq 1 + 3 \\leq 6$. $2 \\leq 3 + 2 \\leq 6$.\n\nYou can also select $[1, 4, 2]$.\n\n### Scoring\n\n- ($1$ point): all $a_i$ are the same;\n- ($3$ points): $a_i = a_{i+2}$ for all $1 \\le i \\le n-2$;\n- ($9$ points): $n \\le 20$;\n- ($8$ points): $n \\le 5000$;\n- ($9$ points): $r - l \\le 10$;\n- ($10$ points): $l = 1, r \\le 10^6$;\n- ($13$ points): $r \\le 10^6$;\n- ($10$ points): $l = 1$;\n- ($24$ points): $n \\le 10^5$;\n- ($13$ points): no additional constraints.", "locale": "en", "translations": {"en": {"title": "[UOI 2024 II Stage] Sequence", "background": "", "description": "Anton is under pressure --- he has to submit all the assignments. As often happens --- he cannot extend the deadline...\n\nYou are given a sequence $a$ of $n$ integers, and two integers $l$ and $r$. You need to find the longest subsequence $b$ of the sequence $a$ such that $l \\le b_i + b_{i+1} \\le r$ ($1 \\le i < |b|$). Here, $|b|$ denotes the number of elements in the sequence $b$. In other words, you need to select a subsequence such that the sum of any two adjacent numbers is not less than $l$ and not greater than $r$.\n\nA subsequence of an array is a sequence that can be obtained by deleting several (possibly none) elements from the original sequence.", "inputFormat": "The first line contains three integers $n$, $l$, $r$ ($1 \\le n \\le 5 \\cdot 10^5$, $1 \\le l \\le r \\le 10^{17}$).\n\nThe second line contains $n$ integers $a_i$ ($1 \\le a_i \\le r$) --- the description of the sequence.", "outputFormat": "Output a single integer --- the maximum length of such a subsequence $b$.", "hint": "In the first example, you can select the subsequence $[1, 3, 2]$. $2 \\leq 1 + 3 \\leq 6$. $2 \\leq 3 + 2 \\leq 6$.\n\nYou can also select $[1, 4, 2]$.\n\n### Scoring\n\n- ($1$ point): all $a_i$ are the same;\n- ($3$ points): $a_i = a_{i+2}$ for all $1 \\le i \\le n-2$;\n- ($9$ points): $n \\le 20$;\n- ($8$ points): $n \\le 5000$;\n- ($9$ points): $r - l \\le 10$;\n- ($10$ points): $l = 1, r \\le 10^6$;\n- ($13$ points): $r \\le 10^6$;\n- ($10$ points): $l = 1$;\n- ($24$ points): $n \\le 10^5$;\n- ($13$ points): no additional constraints.", "locale": "en"}, "zh-CN": {"title": "[UOI 2024 II Stage] Sequence", "background": "", "description": "Anton 感到压力山大——他必须提交所有作业。但正如常有的情况——他无法延长期限……\n\n给定一个包含 $n$ 个整数的序列 $a$，以及两个整数 $l$ 和 $r$。你需要找到序列 $a$ 的最长子序列 $b$，使得对于所有 $1 \\le i < |b|$，满足 $l \\le b_i + b_{i+1} \\le r$。这里 $|b|$ 表示序列 $b$ 的元素个数。换句话说，你需要选择一个子序列，使得任意相邻两个数的和既不小于 $l$，也不大于 $r$。\n\n一个数组的子序列是指通过从原序列中删除若干（可以是零个）元素得到的序列。", "inputFormat": "-   第一行包含三个整数 $n$、$l$、$r$（$1 \\le n \\le 5 \\cdot 10^5$，$1 \\le l \\le r \\le 10^{17}$）。\n-   第二行包含 $n$ 个整数 $a_i$（$1 \\le a_i \\le r$）——序列的描述。", "outputFormat": "输出一个整数——这样的子序列 $b$ 的最大长度。\n", "hint": "在第一个示例中，你可以选择子序列 $[1, 3, 2]$。$2 \\leq 1 + 3 \\leq 6$，$2 \\leq 3 + 2 \\leq 6$。\n\n你也可以选择 $[1, 4, 2]$。\n\n### 评分细则\n\n-   （$1$ 分）：所有 $a_i$ 都相同；\n-   （$3$ 分）：对所有 $1 \\le i \\le n-2$，$a_i = a_{i+2}$；\n-   （$9$ 分）：$n \\le 20$；\n-   （$8$ 分）：$n \\le 5000$；\n-   （$9$ 分）：$r - l \\le 10$；\n-   （$10$ 分）：$l = 1$，$r \\le 10^6$；\n-   （$13$ 分）：$r \\le 10^6$；\n-   （$10$ 分）：$l = 1$；\n-   （$24$ 分）：$n \\le 10^5$；\n-   （$13$ 分）：无额外限制。\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P15071", "type": "P", "difficulty": 5, "samples": [["3 3\n1 2\n2 3\n1 3", "2"], ["5 10\n2 4\n1 2\n3 4\n1 3\n1 5\n4 5\n2 3\n3 5\n1 4\n2 5", "3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["贪心", "并查集", "2024", "二分图", "UOI（乌克兰）"], "title": "[UOI 2024 II Stage] Matches", "background": "", "description": "Anton has invented a new team sport called waterball (similar to paintball, but with water). He wants to share his invention with his $n$ friends. Anton has good relationships with all his friends, but it's not guaranteed that his friends have the same relationships with each other. Specifically, we know that friend number $a_i$ conflicts with friend $b_i$.\n\nAnton was given a list of $m$ conflicting pairs ($a_i;b_i$). Now, it seems like it would be possible to divide the players into two teams, but it's not that simple for Anton...\n\nHe wants to divide these $m$ conflicting pairs into segments in such a way that:\n\n- each conflicting pair belongs to exactly one segment;\n- considering only the relationships within each segment, it should be possible to divide all the people into two teams in such a way that there are no two conflicting people in the same team.\n\nFor example, let's say we have an array of conflicting pairs $[(1, 2), (2, 3), (1, 3)]$. We can take the first two pairs in the first segment. In this case, we can form the teams: $[1, 3]$ and $[2]$. In the second segment, we can take the last pair. $1$ and $3$ must be in different teams, and $2$ can be in either team. Alternatively, we can assign the first pair to the first segment, and the last two to the second segment. Note that we cannot assign the first and third pairs to the same segment, and the second pair to another. This is because a segment should only contain consecutive pairs. We also cannot assign all pairs to the same segment, as there would always be a team where people conflict.\n\nAnton has made the statement complicated again, and now he can't solve the problem. Help him by telling him the minimum number of segments into which he can divide the pairs to satisfy the above conditions.\n", "inputFormat": "The first line contains two integers $n$, $m$ ($1 \\le n, m \\le 10^6$) --- the number of friends and the number of conflicting relationships among friends.\n\nThe next $m$ lines contain two integers each, $a_i$, $b_i$ ($1 \\le a_i, b_i \\le n$, $a_i \\neq b_i$), indicating that friend $a_i$ conflicts with friend $b_i$.\n\nIt is guaranteed that no pair ($a;b$) is repeated more than once.", "outputFormat": "Print a single integer --- the answer to the problem.", "hint": "The first example is explained in the legend above.\n\nIn the second example, for instance, it is possible to divide into the following segments: $[1;6]$, $[7;9]$, $[10;10]$.\n\nIn the first segment, the teams can be formed as $[1,4]$, $[2,3,5]$ --- $1$ and $4$ do not conflict with each other, as well as the pairs $(2;3)$, $(2;5)$, $(3;5)$.\n\nIn the second segment, the teams can be formed as $[1,3]$, $[2,4,5]$ --- $1$ and $3$ do not conflict with each other, as well as the pairs $(2;4)$, $(2;5)$, $(4;5)$.\n\nIn the third segment, the teams can be formed as $[1,2]$, $[3,4,5]$ --- $1$ and $2$ do not conflict with each other, as well as the pairs $(3;4)$, $(3;5)$, $(4;5)$.\n\n### Scoring\n\n- ($4$ points): $n \\le 3$;\n- ($7$ points): $n \\le 10$;\n- ($15$ points): $n, m \\le 5000$;\n- ($13$ points): conflicting pairs in the input are randomly generated; this means that $m$ pairs were randomly selected from all $\\frac{n (n-1)}{2}$ pairs;\n- ($14$ points): each person conflicts with no more than $10$ people;\n- ($19$ points): $n \\le 10^5$;\n- ($17$ points): $n \\le 2 \\cdot 10^5$;\n- ($11$ points): without additional restrictions.", "locale": "en", "translations": {"en": {"title": "[UOI 2024 II Stage] Matches", "background": "", "description": "Anton has invented a new team sport called waterball (similar to paintball, but with water). He wants to share his invention with his $n$ friends. Anton has good relationships with all his friends, but it's not guaranteed that his friends have the same relationships with each other. Specifically, we know that friend number $a_i$ conflicts with friend $b_i$.\n\nAnton was given a list of $m$ conflicting pairs ($a_i;b_i$). Now, it seems like it would be possible to divide the players into two teams, but it's not that simple for Anton...\n\nHe wants to divide these $m$ conflicting pairs into segments in such a way that:\n\n- each conflicting pair belongs to exactly one segment;\n- considering only the relationships within each segment, it should be possible to divide all the people into two teams in such a way that there are no two conflicting people in the same team.\n\nFor example, let's say we have an array of conflicting pairs $[(1, 2), (2, 3), (1, 3)]$. We can take the first two pairs in the first segment. In this case, we can form the teams: $[1, 3]$ and $[2]$. In the second segment, we can take the last pair. $1$ and $3$ must be in different teams, and $2$ can be in either team. Alternatively, we can assign the first pair to the first segment, and the last two to the second segment. Note that we cannot assign the first and third pairs to the same segment, and the second pair to another. This is because a segment should only contain consecutive pairs. We also cannot assign all pairs to the same segment, as there would always be a team where people conflict.\n\nAnton has made the statement complicated again, and now he can't solve the problem. Help him by telling him the minimum number of segments into which he can divide the pairs to satisfy the above conditions.\n", "inputFormat": "The first line contains two integers $n$, $m$ ($1 \\le n, m \\le 10^6$) --- the number of friends and the number of conflicting relationships among friends.\n\nThe next $m$ lines contain two integers each, $a_i$, $b_i$ ($1 \\le a_i, b_i \\le n$, $a_i \\neq b_i$), indicating that friend $a_i$ conflicts with friend $b_i$.\n\nIt is guaranteed that no pair ($a;b$) is repeated more than once.", "outputFormat": "Print a single integer --- the answer to the problem.", "hint": "The first example is explained in the legend above.\n\nIn the second example, for instance, it is possible to divide into the following segments: $[1;6]$, $[7;9]$, $[10;10]$.\n\nIn the first segment, the teams can be formed as $[1,4]$, $[2,3,5]$ --- $1$ and $4$ do not conflict with each other, as well as the pairs $(2;3)$, $(2;5)$, $(3;5)$.\n\nIn the second segment, the teams can be formed as $[1,3]$, $[2,4,5]$ --- $1$ and $3$ do not conflict with each other, as well as the pairs $(2;4)$, $(2;5)$, $(4;5)$.\n\nIn the third segment, the teams can be formed as $[1,2]$, $[3,4,5]$ --- $1$ and $2$ do not conflict with each other, as well as the pairs $(3;4)$, $(3;5)$, $(4;5)$.\n\n### Scoring\n\n- ($4$ points): $n \\le 3$;\n- ($7$ points): $n \\le 10$;\n- ($15$ points): $n, m \\le 5000$;\n- ($13$ points): conflicting pairs in the input are randomly generated; this means that $m$ pairs were randomly selected from all $\\frac{n (n-1)}{2}$ pairs;\n- ($14$ points): each person conflicts with no more than $10$ people;\n- ($19$ points): $n \\le 10^5$;\n- ($17$ points): $n \\le 2 \\cdot 10^5$;\n- ($11$ points): without additional restrictions.", "locale": "en"}, "zh-CN": {"title": "[UOI 2024 II Stage] Matches", "background": "", "description": "Anton 发明了一项名为水球（类似彩弹，但用水）的新团队运动。他想与他的 $n$ 个朋友分享这项发明。Anton 与所有朋友关系都很好，但不能保证他的朋友们彼此之间关系同样融洽。具体来说，我们知道编号为 $a_i$ 的朋友与编号为 $b_i$ 的朋友存在冲突。\n\nAnton 得到了一个包含 $m$ 个冲突对 ($a_i;b_i$) 的列表。现在，看似可以将玩家分成两队，但对 Anton 来说并不那么简单……\n\n他想要将这些 $m$ 个冲突对划分成若干段，使得：\n\n- 每个冲突对恰好属于一段；\n- 仅考虑每段内的冲突关系时，可以将所有人分成两队，使得同一队中没有两个相互冲突的人。\n\n例如，假设我们有冲突对数组 $[(1, 2), (2, 3), (1, 3)]$。我们可以将前两个对放在第一段。此时，可以组成队伍：$[1, 3]$ 和 $[2]$。在第二段中，我们可以取最后一个对。$1$ 和 $3$ 必须分在不同队伍，$2$ 可以在任意一队。或者，我们可以将第一个对分配给第一段，最后两个对分配给第二段。注意，我们不能将第一个和第三个对放在同一段，而将第二个对放在另一段，因为一段应当只包含连续的冲突对。我们也不能将所有对放在同一段，因为那样总会存在一个队伍中有相互冲突的人。\n\nAnton 又把问题描述复杂化了，现在他自己无法解决这个问题。请帮助他，告诉他满足上述条件时，最少可以将这些对划分成多少段。", "inputFormat": "-   第一行包含两个整数 $n$、$m$（$1 \\le n, m \\le 10^6$）——朋友数量和冲突关系数量。\n-   接下来的 $m$ 行，每行包含两个整数 $a_i$、$b_i$（$1 \\le a_i, b_i \\le n$，$a_i \\neq b_i$），表示朋友 $a_i$ 与朋友 $b_i$ 存在冲突。\n\n保证任何冲突对 ($a;b$) 不会重复出现。", "outputFormat": "输出一个整数——问题的答案。\n", "hint": "第一个示例已在题目描述中解释。\n\n在第二个示例中，例如可以划分成以下三段：$[1;6]$、$[7;9]$、$[10;10]$。\n\n-   在第一段中，可以组成队伍 $[1,4]$ 和 $[2,3,5]$ —— $1$ 和 $4$ 不冲突，且 $(2;3)$、$(2;5)$、$(3;5)$ 也不冲突。\n-   在第二段中，可以组成队伍 $[1,3]$ 和 $[2,4,5]$ —— $1$ 和 $3$ 不冲突，且 $(2;4)$、$(2;5)$、$(4;5)$ 也不冲突。\n-   在第三段中，可以组成队伍 $[1,2]$ 和 $[3,4,5]$ —— $1$ 和 $2$ 不冲突，且 $(3;4)$、$(3;5)$、$(4;5)$ 也不冲突。\n\n### 评分细则\n\n-   （$4$ 分）：$n \\le 3$；\n-   （$7$ 分）：$n \\le 10$；\n-   （$15$ 分）：$n, m \\le 5000$；\n-   （$13$ 分）：输入中的冲突对随机生成；这意味着从所有 $\\frac{n (n-1)}{2}$ 个对中随机选择了 $m$ 个对；\n-   （$14$ 分）：每个人冲突的对象不超过 $10$ 个；\n-   （$19$ 分）：$n \\le 10^5$；\n-   （$17$ 分）：$n \\le 2 \\cdot 10^5$；\n-   （$11$ 分）：无额外限制。\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P15072", "type": "P", "difficulty": 3, "samples": [["4\n>>->>>\n>>>->\n>>>>>\n>->>>>>>", "Yes 2\n1 5\n2 5\nNo\nNo\nYes 2\n2 7\n1 5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2024", "Special Judge", "ICPC"], "title": "[ICPC 2024 Chengdu R] Arrow a Row", "background": "", "description": "Define an \"arrow string\" as a string that meets the following conditions:\n\n- The length of the string is at least $5$.\n- The string starts with $\\tt{>}$ and ends with $\\tt{>}\\tt{>}\\tt{>}$. \n- The rest of the string consists only of $\\tt{-}$.\n\nFor example, $\\tt{>}\\tt{-}\\tt{-}\\tt{>}\\tt{>}\\tt{>}$ and $\\tt{>}\\tt{-}\\tt{-}\\tt{-}\\tt{>}\\tt{>}\\tt{>}$ are valid arrow strings, while $\\tt{>}\\tt{-}\\tt{>}\\tt{>}$ and $\\tt{>}\\tt{-}\\tt{>}\\tt{-}\\tt{>}\\tt{>}\\tt{>}$ are not.\n\nSauden gives you a string $s$ of length $n$, consisting of $\\tt{>}$ and $\\tt{-}$. You need to create $s$ by performing a series of painting operations on a string of the same length $n$ that consists entirely of $\\tt{*}$. In one painting operation, you can choose a substring of length at least $5$ and transform it into an arrow string. The total number of operations you perform cannot exceed $n$.\n\nIf it is impossible to obtain the string $s$ using no more than $n$ painting operations, output $\\texttt{No}$. Otherwise, output $\\texttt{Yes}$ and provide the details of the painting operations. If there are multiple solutions, output any.", "inputFormat": "The first line contains a single integer $T$ ($1\\le T\\le 10^4$), indicating the number of test cases.\n\nEach test case contains a string $s$ of length $n$ ($5 \\le n \\le 10^5$) in a single line, consisting only of $\\tt{>}$ and $\\tt{-}$.\n\nIt is guaranteed that the sum of $n$ over all test cases does not exceed $5 \\cdot 10^5$.", "outputFormat": "For each test case, if the given string cannot be obtained by performing no more than $n$ painting operations, output $\\texttt{No}$ in a single line. Otherwise, output $\\texttt{Yes}$ and a positive integer $m$ ($1 \\le m \\le n$), which denotes the number of painting operations to perform. Then output $m$ lines, each contains two integers $p$ ($1\\le p\\le n-4$) and $l$ ($5\\le l\\le n+1-p$), indicating the starting position of the selected substring and its length.", "hint": "For the fourth test case in the example, the painting process is shown below:\n\n:::align{center}\n$\\tt{*}\\tt{*}\\tt{*}\\tt{*}\\tt{*}\\tt{*}\\tt{*}\\tt{*}$ $\\rightarrow$ $\\tt{*}\\underline{\\tt{>}\\tt{-}\\tt{-}\\tt{-}\\tt{>}\\tt{>}\\tt{>}}$ $\\rightarrow$ $\\underline{\\tt{>}\\tt{-}\\tt{>}\\tt{>}\\tt{>}}\\tt{>}\\tt{>}\\tt{>}$\n:::", "locale": "en", "translations": {"en": {"title": "[ICPC 2024 Chengdu R] Arrow a Row", "background": "", "description": "Define an \"arrow string\" as a string that meets the following conditions:\n\n- The length of the string is at least $5$.\n- The string starts with $\\tt{>}$ and ends with $\\tt{>}\\tt{>}\\tt{>}$. \n- The rest of the string consists only of $\\tt{-}$.\n\nFor example, $\\tt{>}\\tt{-}\\tt{-}\\tt{>}\\tt{>}\\tt{>}$ and $\\tt{>}\\tt{-}\\tt{-}\\tt{-}\\tt{>}\\tt{>}\\tt{>}$ are valid arrow strings, while $\\tt{>}\\tt{-}\\tt{>}\\tt{>}$ and $\\tt{>}\\tt{-}\\tt{>}\\tt{-}\\tt{>}\\tt{>}\\tt{>}$ are not.\n\nSauden gives you a string $s$ of length $n$, consisting of $\\tt{>}$ and $\\tt{-}$. You need to create $s$ by performing a series of painting operations on a string of the same length $n$ that consists entirely of $\\tt{*}$. In one painting operation, you can choose a substring of length at least $5$ and transform it into an arrow string. The total number of operations you perform cannot exceed $n$.\n\nIf it is impossible to obtain the string $s$ using no more than $n$ painting operations, output $\\texttt{No}$. Otherwise, output $\\texttt{Yes}$ and provide the details of the painting operations. If there are multiple solutions, output any.", "inputFormat": "The first line contains a single integer $T$ ($1\\le T\\le 10^4$), indicating the number of test cases.\n\nEach test case contains a string $s$ of length $n$ ($5 \\le n \\le 10^5$) in a single line, consisting only of $\\tt{>}$ and $\\tt{-}$.\n\nIt is guaranteed that the sum of $n$ over all test cases does not exceed $5 \\cdot 10^5$.", "outputFormat": "For each test case, if the given string cannot be obtained by performing no more than $n$ painting operations, output $\\texttt{No}$ in a single line. Otherwise, output $\\texttt{Yes}$ and a positive integer $m$ ($1 \\le m \\le n$), which denotes the number of painting operations to perform. Then output $m$ lines, each contains two integers $p$ ($1\\le p\\le n-4$) and $l$ ($5\\le l\\le n+1-p$), indicating the starting position of the selected substring and its length.", "hint": "For the fourth test case in the example, the painting process is shown below:\n\n:::align{center}\n$\\tt{*}\\tt{*}\\tt{*}\\tt{*}\\tt{*}\\tt{*}\\tt{*}\\tt{*}$ $\\rightarrow$ $\\tt{*}\\underline{\\tt{>}\\tt{-}\\tt{-}\\tt{-}\\tt{>}\\tt{>}\\tt{>}}$ $\\rightarrow$ $\\underline{\\tt{>}\\tt{-}\\tt{>}\\tt{>}\\tt{>}}\\tt{>}\\tt{>}\\tt{>}$\n:::", "locale": "en"}, "zh-CN": {"title": "[ICPC 2024 Chengdu R] Arrow a Row", "background": "", "description": "定义一个“箭头字符串”为满足以下条件的字符串：\n\n- 字符串长度至少为 $5$。\n- 字符串以 $\\tt{>}$ 开头，以 $\\tt{>}\\tt{>}\\tt{>}$ 结尾。\n- 字符串的其余部分仅由 $\\tt{-}$ 组成。\n\n例如，$\\tt{>}\\tt{-}\\tt{-}\\tt{>}\\tt{>}\\tt{>}$ 和 $\\tt{>}\\tt{-}\\tt{-}\\tt{-}\\tt{>}\\tt{>}\\tt{>}$ 是有效的箭头字符串，而 $\\tt{>}\\tt{-}\\tt{>}\\tt{>}$ 和 $\\tt{>}\\tt{-}\\tt{>}\\tt{-}\\tt{>}\\tt{>}\\tt{>}$ 则不是。\n\nSauden 给你一个长度为 $n$ 的字符串 $s$，仅由 $\\tt{>}$ 和 $\\tt{-}$ 组成。你需要通过对一个同样长度为 $n$、完全由 $\\tt{*}$ 组成的字符串执行一系列绘制操作来创建 $s$。在一次绘制操作中，你可以选择一个长度至少为 $5$ 的子串，并将其转换为一个箭头字符串。你执行的操作总数不能超过 $n$。\n\n如果无法在不超过 $n$ 次绘制操作的情况下获得字符串 $s$，则输出 $\\texttt{No}$。否则，输出 $\\texttt{Yes}$ 并提供绘制操作的详细信息。如果有多种解决方案，输出任意一种即可。", "inputFormat": "-   第一行包含一个整数 $T$（$1\\le T\\le 10^4$），表示测试用例的数量。\n-   每个测试用例包含一行，为一个长度为 $n$（$5 \\le n \\le 10^5$）的字符串 $s$，仅由 $\\tt{>}$ 和 $\\tt{-}$ 组成。\n\n保证所有测试用例的 $n$ 之和不超过 $5 \\cdot 10^5$。", "outputFormat": "对于每个测试用例，如果无法在不超过 $n$ 次绘制操作的情况下获得给定字符串，则输出一行 $\\texttt{No}$。否则，输出 $\\texttt{Yes}$ 和一个正整数 $m$（$1 \\le m \\le n$），表示需要执行的绘制操作次数。随后输出 $m$ 行，每行包含两个整数 $p$（$1\\le p\\le n-4$）和 $l$（$5\\le l\\le n+1-p$），分别表示所选子串的起始位置和长度。\n", "hint": "对于示例中的第四个测试用例，绘制过程如下所示：\n\n:::align{center}\n$\\tt{*}\\tt{*}\\tt{*}\\tt{*}\\tt{*}\\tt{*}\\tt{*}\\tt{*}$ $\\rightarrow$ $\\tt{*}\\underline{\\tt{>}\\tt{-}\\tt{-}\\tt{-}\\tt{>}\\tt{>}\\tt{>}}$ $\\rightarrow$ $\\underline{\\tt{>}\\tt{-}\\tt{>}\\tt{>}\\tt{>}}\\tt{>}\\tt{>}\\tt{>}$\n:::\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P15073", "type": "P", "difficulty": 4, "samples": [["6 3\na?b??c\n2 2 2\n1 1 1\n1 0 2", "3\n1\n1"], ["6 3\n??????\n2 2 2\n2 3 3\n3 3 3", "30\n72\n96"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["动态规划 DP", "2024", "ICPC"], "title": "[ICPC 2024 Chengdu R] Athlete Welcome Ceremony", "background": "", "description": "Chengdu is about to host the 2025 World Games. During the athlete welcome ceremony at the opening event, there will be $n$ volunteers dressed in one of three different types of traditional folk costumes, lined up to welcome the athletes. These costumes are denoted by type $\\texttt{a}$, $\\texttt{b}$, and $\\texttt{c}$. The positions of the volunteers have been determined, and now we need to assign costumes to the volunteers. To achieve a specific visual effect, adjacent volunteers must not wear the same type of costume.\n\nAmong the $n$ volunteers, some already have one of the three types of folk costumes, while others do not have any and require custom-made costumes provided by the organizers. There are $Q$ custom-making plans, each specifying: making $x$ sets of costumes $\\texttt{a}$, $y$ sets of costumes $\\texttt{b}$, and $z$ sets of costumes $\\texttt{c}$.\n\nFor each custom-making plan, determine how many different valid costume arrangements can be made after distributing the custom-made costumes to the volunteers who do not have any costumes. Specifically, determine the number of ways for assigning costumes $\\texttt{a}$, $\\texttt{b}$ and $\\texttt{c}$ under the condition of not exceeding the limits of the given plan. If two arrangements differ in the type of costume assigned to the same volunteer, they are considered different. Note that the same type of costumes are not distinguished from each other. As the number may be very large, please output the answer modulo $10^9+7$.", "inputFormat": "The first line contains two integers $n$ ($1\\le n\\le 300$) and $Q$ ($1\\le Q\\le 10^5$), representing the number of volunteers and the number of custom-making plans, respectively.\n\nThe second line is a string $s$ of length $n$. It is guaranteed that the string $s$ contains only the characters $\\texttt{a}$, $\\texttt{b}$, $\\texttt{c}$, and $\\texttt{?}$. If the $i$-th character is one of $\\texttt{a}$, $\\texttt{b}$, and $\\texttt{c}$, it indicates that the $i$-th volunteer already has the corresponding costume; otherwise, if it is $\\texttt{?}$, it indicates that the $i$-th volunteer does not have any costume.\n\nEach of the next $Q$ lines contains three integers $x, y, z$ ($0 \\le x, y, z \\le 300$), representing a custom-making plan. It is guaranteed that the sum $x+y+z$ is no less than the number of volunteers without costumes.", "outputFormat": "Output $Q$ lines, with the $i$-th line containing an integer that represents the number of valid costume arrangements that satisfy the requirements for the $i$-th custom-making plan. Please output the answer modulo $10^9+7$.", "hint": "In the first sample, the valid costume arrangements for the first custom-making plan are $\\texttt{acbabc}$, $\\texttt{acbcac}$, and $\\texttt{acbcbc}$.", "locale": "en", "translations": {"en": {"title": "[ICPC 2024 Chengdu R] Athlete Welcome Ceremony", "background": "", "description": "Chengdu is about to host the 2025 World Games. During the athlete welcome ceremony at the opening event, there will be $n$ volunteers dressed in one of three different types of traditional folk costumes, lined up to welcome the athletes. These costumes are denoted by type $\\texttt{a}$, $\\texttt{b}$, and $\\texttt{c}$. The positions of the volunteers have been determined, and now we need to assign costumes to the volunteers. To achieve a specific visual effect, adjacent volunteers must not wear the same type of costume.\n\nAmong the $n$ volunteers, some already have one of the three types of folk costumes, while others do not have any and require custom-made costumes provided by the organizers. There are $Q$ custom-making plans, each specifying: making $x$ sets of costumes $\\texttt{a}$, $y$ sets of costumes $\\texttt{b}$, and $z$ sets of costumes $\\texttt{c}$.\n\nFor each custom-making plan, determine how many different valid costume arrangements can be made after distributing the custom-made costumes to the volunteers who do not have any costumes. Specifically, determine the number of ways for assigning costumes $\\texttt{a}$, $\\texttt{b}$ and $\\texttt{c}$ under the condition of not exceeding the limits of the given plan. If two arrangements differ in the type of costume assigned to the same volunteer, they are considered different. Note that the same type of costumes are not distinguished from each other. As the number may be very large, please output the answer modulo $10^9+7$.", "inputFormat": "The first line contains two integers $n$ ($1\\le n\\le 300$) and $Q$ ($1\\le Q\\le 10^5$), representing the number of volunteers and the number of custom-making plans, respectively.\n\nThe second line is a string $s$ of length $n$. It is guaranteed that the string $s$ contains only the characters $\\texttt{a}$, $\\texttt{b}$, $\\texttt{c}$, and $\\texttt{?}$. If the $i$-th character is one of $\\texttt{a}$, $\\texttt{b}$, and $\\texttt{c}$, it indicates that the $i$-th volunteer already has the corresponding costume; otherwise, if it is $\\texttt{?}$, it indicates that the $i$-th volunteer does not have any costume.\n\nEach of the next $Q$ lines contains three integers $x, y, z$ ($0 \\le x, y, z \\le 300$), representing a custom-making plan. It is guaranteed that the sum $x+y+z$ is no less than the number of volunteers without costumes.", "outputFormat": "Output $Q$ lines, with the $i$-th line containing an integer that represents the number of valid costume arrangements that satisfy the requirements for the $i$-th custom-making plan. Please output the answer modulo $10^9+7$.", "hint": "In the first sample, the valid costume arrangements for the first custom-making plan are $\\texttt{acbabc}$, $\\texttt{acbcac}$, and $\\texttt{acbcbc}$.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2024 Chengdu R] Athlete Welcome Ceremony", "background": "", "description": "成都即将举办 2025 年世界运动会。在开幕式运动员欢迎仪式上，将有 $n$ 名志愿者穿着三种不同类型的传统民俗服装，列队欢迎运动员。这些服装类型用 $\\texttt{a}$、$\\texttt{b}$ 和 $\\texttt{c}$ 表示。志愿者的位置已经确定，现在我们需要为他们分配服装。为了实现特定的视觉效果，相邻的志愿者不能穿着相同类型的服装。\n\n在这 $n$ 名志愿者中，一些人已经拥有三种民俗服装中的一种，而另一些人则没有任何服装，需要主办方提供定制服装。共有 $Q$ 个定制计划，每个计划指定：制作 $x$ 套 $\\texttt{a}$ 型服装、$y$ 套 $\\texttt{b}$ 型服装和 $z$ 套 $\\texttt{c}$ 型服装。\n\n对于每个定制计划，确定在将定制服装分发给没有服装的志愿者后，可以形成多少种不同的有效服装安排。具体来说，在不超过给定计划限制的条件下，计算分配 $\\texttt{a}$、$\\texttt{b}$ 和 $\\texttt{c}$ 型服装的方案数。如果两种安排中同一名志愿者分配的服装类型不同，则视为不同的安排。注意，同一类型的服装彼此不作区分。由于数量可能非常大，请输出答案对 $10^9+7$ 取模的结果。", "inputFormat": "-   第一行包含两个整数 $n$（$1\\le n\\le 300$）和 $Q$（$1\\le Q\\le 10^5$），分别表示志愿者人数和定制计划的数量。\n-   第二行是一个长度为 $n$ 的字符串 $s$。保证字符串 $s$ 仅包含字符 $\\texttt{a}$、$\\texttt{b}$、$\\texttt{c}$ 和 $\\texttt{?}$。如果第 $i$ 个字符是 $\\texttt{a}$、$\\texttt{b}$、$\\texttt{c}$ 之一，则表示第 $i$ 名志愿者已经拥有对应的服装；否则，如果是 $\\texttt{?}$，则表示第 $i$ 名志愿者没有任何服装。\n-   接下来的 $Q$ 行，每行包含三个整数 $x, y, z$（$0 \\le x, y, z \\le 300$），表示一个定制计划。保证 $x+y+z$ 不小于没有服装的志愿者人数。\n", "outputFormat": "输出 $Q$ 行，第 $i$ 行包含一个整数，表示满足第 $i$ 个定制计划要求的有效服装安排数量。请输出答案对 $10^9+7$ 取模的结果。", "hint": "在第一个样例中，第一个定制计划的有效服装安排是 $\\texttt{acbabc}$、$\\texttt{acbcac}$ 和 $\\texttt{acbcbc}$。\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P15074", "type": "P", "difficulty": 6, "samples": [["1\n9 0\n\n\n6", "\n\n1\n? 3 6\n\n! S"], ["4\n2 1\n2 3\n2 5\n2 7\n\n\n3\n\n1", "\n\n\n\n\n2\n? 0 0\n\n? 2 0\n\n! J"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2024", "交互题", "Special Judge", "ICPC"], "title": "[ICPC 2024 Chengdu R] Chinese Chess", "background": "", "description": "$\\textbf{This is an interactive problem.}$\n\nChinese chess is a two-player strategy board game that is very popular in China. There are $10$ rows and $9$ columns on a Chinese chess board. We denote the point on the $r$-th row from bottom to top and on the $c$-th column from left to right by $(r,c)$ ($0 \\le r \\le 9$, $0\\le c \\le 8$).\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/bmxvzs86.png)\n:::\n\nThere are six types of pieces in this problem: kings, mandarins, rooks, knights, bishops, and pawns. Note that cannons are not considered. Additionally, all pieces can be moved anywhere on the board, which differs slightly from the original rules. The movement rules for each piece are as follows (assuming the current position is $(r, c)$):\n\n$$\n\\begin{array}{|c|c|c|}\n\\hline\n\\textbf{\\text{Chess}} & \\textbf{\\text{Symbol}} & \\textbf{\\text{Possible positions in one move}} \\\\\n\\hline\n\\text{King} & J & (r+1, c)\\ (r-1, c)\\ (r, c+1)\\ (r, c-1) \\\\\n\\hline\n\\text{Mandarin} & S & (r+1, c+1)\\ (r+1, c-1)\\ (r-1, c+1)\\ (r-1, c-1) \\\\\n\\hline\n\\text{Rook} & C & \\text{all }(r', c')\\text{ such that }r'=r\\text{ or }c'=c\\text{ except }(r, c)\\text{ itself} \\\\\n\\hline\n\\text{Knight} & M & (r+2, c+1)\\ (r+2, c-1)\\ (r-2, c+1)\\ (r-2, c-1) \\\\\n &  & (r+1, c+2)\\ (r+1, c-2)\\ (r-1, c+2)\\ (r-1, c-2) \\\\\n\\hline\n\\text{Bishop} & X & (r+2,c+2)\\ (r+2,c-2)\\ (r-2,c+2)\\ (r-2,c-2) \\\\\n\\hline\n\\text{Pawn} & B & (r+1, c)\\text{ if }r \\le 4\\text{, otherwise }(r+1,c)\\ (r,c+1)\\ (r,c-1) \\\\\n\\hline\n\\end{array}\n$$\n\nOf course, pieces cannot move outside the board's boundaries. Now that you understand the rules, let's play a game.\n\nI have placed a piece on the board, and you cannot see its position or type. However, I will provide a set $A$ of $n$ possible positions where the piece might be located. Your goal is to determine the type of the piece using the minimum number of queries. For each query, you can select a position on the board, and I will tell you the minimum number of moves required for the piece to move to that position, or I will tell you if it is impossible for the piece to reach that position.\n\nInteresting, isn't it? What is even more interesting is that I am actually gaming against you in secret. Truth be told, although set $A$ is fixed, I have not fixed the type and position of this piece from the start. My strategy is to adjust the answer to each of your queries in a way that maximizes the number of queries you make, without contradicting the information already given. In the case where both of our strategies are optimal, your number of queries $m$ is actually determinable. I am sure you are smart enough to figure it out. Let the game begin!\n\n### Interaction Protocol\n\nFirstly, you should read an integer $n$ ($1\\le n\\le 90$) from standard input, indicating the size of the set $A$.\n\nThen, read $n$ lines. Each line contains two integers $r$ and $c$, indicating a position in the set $A$. All positions are guaranteed to be distinct.\n\nAfter reading these $n+1$ lines, you should output an integer $m$ to standard output, indicating the number of queries. If your output $m$ is incorrect, you will get a $\\texttt{Wrong answer}$ verdict. You must then make exactly $m$ queries.\n\nTo make a query, output $\\texttt{? r c}$ ($0\\le r\\le 9, 0\\le c\\le 8$) in a single line. Then you should read an integer from standard input, indicating the minimum number of moves required for the piece to reach the selected position, or $-1$ if the piece cannot move to that position. If your program makes an invalid query or exceeds the number of queries, the interactor will terminate immediately, and you will receive a $\\texttt{Wrong answer}$ verdict.\n\nTo output your guess about the type of the piece, you need to output $\\texttt{! ch}$, where $\\texttt{ch}$ means the symbol representing the piece that is shown in the statement.\n\nAfter you make a query or output your answer, including the $m$ and the type of the piece, do not forget to output the End of Line $\\backslash\\texttt{n}$ and flush the output. To do this, use:\n\n- $\\texttt{fflush(stdout)}$ or $\\texttt{cout.flush()}$ in C++;\n- $\\texttt{System.out.flush()}$ in Java;\n- $\\texttt{stdout.flush()}$ in Python;", "inputFormat": "", "outputFormat": "", "hint": "For the first example, the number of moves required for each of the six types of pieces to move from position $(9, 0)$ to $(3, 6)$ is as follows:\n\n$$\n\\begin{array}{|c|c|c|c|c|c|}\n\\hline\n\\text{King (J)} & \\text{Mandarins (S)} & \\text{Rooks (C)} & \\text{Knights (M)} & \\text{Bishops (X)} & \\text{Pawns (B)} \\\\\n\\hline\n12 & 6 & 2 & 4 & 3 & -1 \\\\\n\\hline\n\\end{array}\n$$\n\nThus, you only need to make one query to determine the answer.", "locale": "en", "translations": {"en": {"title": "[ICPC 2024 Chengdu R] Chinese Chess", "background": "", "description": "$\\textbf{This is an interactive problem.}$\n\nChinese chess is a two-player strategy board game that is very popular in China. There are $10$ rows and $9$ columns on a Chinese chess board. We denote the point on the $r$-th row from bottom to top and on the $c$-th column from left to right by $(r,c)$ ($0 \\le r \\le 9$, $0\\le c \\le 8$).\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/bmxvzs86.png)\n:::\n\nThere are six types of pieces in this problem: kings, mandarins, rooks, knights, bishops, and pawns. Note that cannons are not considered. Additionally, all pieces can be moved anywhere on the board, which differs slightly from the original rules. The movement rules for each piece are as follows (assuming the current position is $(r, c)$):\n\n$$\n\\begin{array}{|c|c|c|}\n\\hline\n\\textbf{\\text{Chess}} & \\textbf{\\text{Symbol}} & \\textbf{\\text{Possible positions in one move}} \\\\\n\\hline\n\\text{King} & J & (r+1, c)\\ (r-1, c)\\ (r, c+1)\\ (r, c-1) \\\\\n\\hline\n\\text{Mandarin} & S & (r+1, c+1)\\ (r+1, c-1)\\ (r-1, c+1)\\ (r-1, c-1) \\\\\n\\hline\n\\text{Rook} & C & \\text{all }(r', c')\\text{ such that }r'=r\\text{ or }c'=c\\text{ except }(r, c)\\text{ itself} \\\\\n\\hline\n\\text{Knight} & M & (r+2, c+1)\\ (r+2, c-1)\\ (r-2, c+1)\\ (r-2, c-1) \\\\\n &  & (r+1, c+2)\\ (r+1, c-2)\\ (r-1, c+2)\\ (r-1, c-2) \\\\\n\\hline\n\\text{Bishop} & X & (r+2,c+2)\\ (r+2,c-2)\\ (r-2,c+2)\\ (r-2,c-2) \\\\\n\\hline\n\\text{Pawn} & B & (r+1, c)\\text{ if }r \\le 4\\text{, otherwise }(r+1,c)\\ (r,c+1)\\ (r,c-1) \\\\\n\\hline\n\\end{array}\n$$\n\nOf course, pieces cannot move outside the board's boundaries. Now that you understand the rules, let's play a game.\n\nI have placed a piece on the board, and you cannot see its position or type. However, I will provide a set $A$ of $n$ possible positions where the piece might be located. Your goal is to determine the type of the piece using the minimum number of queries. For each query, you can select a position on the board, and I will tell you the minimum number of moves required for the piece to move to that position, or I will tell you if it is impossible for the piece to reach that position.\n\nInteresting, isn't it? What is even more interesting is that I am actually gaming against you in secret. Truth be told, although set $A$ is fixed, I have not fixed the type and position of this piece from the start. My strategy is to adjust the answer to each of your queries in a way that maximizes the number of queries you make, without contradicting the information already given. In the case where both of our strategies are optimal, your number of queries $m$ is actually determinable. I am sure you are smart enough to figure it out. Let the game begin!\n\n### Interaction Protocol\n\nFirstly, you should read an integer $n$ ($1\\le n\\le 90$) from standard input, indicating the size of the set $A$.\n\nThen, read $n$ lines. Each line contains two integers $r$ and $c$, indicating a position in the set $A$. All positions are guaranteed to be distinct.\n\nAfter reading these $n+1$ lines, you should output an integer $m$ to standard output, indicating the number of queries. If your output $m$ is incorrect, you will get a $\\texttt{Wrong answer}$ verdict. You must then make exactly $m$ queries.\n\nTo make a query, output $\\texttt{? r c}$ ($0\\le r\\le 9, 0\\le c\\le 8$) in a single line. Then you should read an integer from standard input, indicating the minimum number of moves required for the piece to reach the selected position, or $-1$ if the piece cannot move to that position. If your program makes an invalid query or exceeds the number of queries, the interactor will terminate immediately, and you will receive a $\\texttt{Wrong answer}$ verdict.\n\nTo output your guess about the type of the piece, you need to output $\\texttt{! ch}$, where $\\texttt{ch}$ means the symbol representing the piece that is shown in the statement.\n\nAfter you make a query or output your answer, including the $m$ and the type of the piece, do not forget to output the End of Line $\\backslash\\texttt{n}$ and flush the output. To do this, use:\n\n- $\\texttt{fflush(stdout)}$ or $\\texttt{cout.flush()}$ in C++;\n- $\\texttt{System.out.flush()}$ in Java;\n- $\\texttt{stdout.flush()}$ in Python;", "inputFormat": "", "outputFormat": "", "hint": "For the first example, the number of moves required for each of the six types of pieces to move from position $(9, 0)$ to $(3, 6)$ is as follows:\n\n$$\n\\begin{array}{|c|c|c|c|c|c|}\n\\hline\n\\text{King (J)} & \\text{Mandarins (S)} & \\text{Rooks (C)} & \\text{Knights (M)} & \\text{Bishops (X)} & \\text{Pawns (B)} \\\\\n\\hline\n12 & 6 & 2 & 4 & 3 & -1 \\\\\n\\hline\n\\end{array}\n$$\n\nThus, you only need to make one query to determine the answer.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2024 Chengdu R] Chinese Chess", "background": "", "description": "**这是一道交互题。**\n\n中国象棋是一种在中国非常流行的双人策略棋盘游戏。中国象棋棋盘共有 $10$ 行 $9$ 列。我们用 $(r,c)$ 表示从下往上数第 $r$ 行、从左往右数第 $c$ 列的点（$0 \\le r \\le 9$，$0\\le c \\le 8$）。\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/bmxvzs86.png)\n:::\n\n本题中涉及六种棋子：将（帅）、士、车、马、象（相）和兵（卒）。注意，炮不考虑在内。此外，所有棋子都可以移动到棋盘上的任何位置，这与原始规则略有不同。每种棋子的移动规则如下（假设当前位置为 $(r, c)$）：\n\n$$\n\\begin{array}{|c|c|c|}\n\\hline\n\\textbf{\\text{棋子}} & \\textbf{\\text{符号}} & \\textbf{\\text{一次移动可到达的位置}} \\\\\n\\hline\n\\text{将（帅）} & J & (r+1, c)\\ (r-1, c)\\ (r, c+1)\\ (r, c-1) \\\\\n\\hline\n\\text{士} & S & (r+1, c+1)\\ (r+1, c-1)\\ (r-1, c+1)\\ (r-1, c-1) \\\\\n\\hline\n\\text{车} & C & \\text{所有满足 }r'=r\\text{ 或 }c'=c\\text{ 的 }(r', c')\\text{，除了 }(r, c)\\text{ 本身} \\\\\n\\hline\n\\text{马} & M & (r+2, c+1)\\ (r+2, c-1)\\ (r-2, c+1)\\ (r-2, c-1) \\\\\n &  & (r+1, c+2)\\ (r+1, c-2)\\ (r-1, c+2)\\ (r-1, c-2) \\\\\n\\hline\n\\text{象（相）} & X & (r+2,c+2)\\ (r+2,c-2)\\ (r-2,c+2)\\ (r-2,c-2) \\\\\n\\hline\n\\text{兵（卒）} & B & (r+1, c)\\text{ 如果 }r \\le 4\\text{，否则 }(r+1,c)\\ (r,c+1)\\ (r,c-1) \\\\\n\\hline\n\\end{array}\n$$\n\n当然，棋子不能移出棋盘边界。现在你已经了解了规则，让我们开始游戏。\n\n我在棋盘上放置了一枚棋子，你看不到它的位置或类型。但是，我会提供一个可能包含棋子位置的集合 $A$，其大小为 $n$。你的目标是使用最少的查询次数来确定棋子的类型。对于每次查询，你可以选择一个棋盘上的位置，我将告诉你棋子移动到该位置所需的最少步数，或者告诉你棋子不可能到达该位置。\n\n这很有趣，不是吗？更有趣的是，我其实在暗中与你对抗。实话实说，尽管集合 $A$ 是固定的，但我并没有从一开始就固定这枚棋子的类型和位置。我的策略是调整对你每次查询的回应，以最大化你的查询次数，同时不与已给出的信息相矛盾。在我们双方都采用最优策略的情况下，你的查询次数 $m$ 实际上是可确定的。我相信你足够聪明，能够将其推算出来。游戏开始！\n\n### 交互方式\n\n首先，你应该从标准输入读取一个整数 $n$（$1\\le n\\le 90$），表示集合 $A$ 的大小。\n\n然后，读取 $n$ 行。每行包含两个整数 $r$ 和 $c$，表示集合 $A$ 中的一个位置。保证所有位置互不相同。\n\n读取这 $n+1$ 行后，你应该向标准输出输出一个整数 $m$，表示查询次数。如果你的输出 $m$ 不正确，你将得到 **Wrong answer** 的判定。然后你必须恰好进行 $m$ 次查询。\n\n要进行一次查询，请在一行中输出 `? r c`（$0\\le r\\le 9, 0\\le c\\le 8$）。然后你应该从标准输入读取一个整数，表示棋子移动到所选位置所需的最少步数，如果棋子无法移动到该位置，则为 $-1$。如果你的程序进行了无效查询或超过了查询次数，交互器将立即终止，你将收到 **Wrong answer** 的判定。\n\n要输出你对棋子类型的猜测，你需要输出 `! ch`，其中 `ch` 表示题目描述中代表该棋子的符号。\n\n在你进行一次查询或输出你的答案（包括 $m$ 和棋子类型）后，请不要忘记输出换行符 `\\n` 并刷新输出缓冲区。为此，请使用：\n\n- C++ 中的 `fflush(stdout)` 或 `cout.flush()`；\n- Java 中的 `System.out.flush()`；\n- Python 中的 `stdout.flush()`。", "inputFormat": "", "outputFormat": "", "hint": "对于第一个示例，六种棋子从位置 $(9, 0)$ 移动到 $(3, 6)$ 所需步数如下：\n\n$$\n\\begin{array}{|c|c|c|c|c|c|}\n\\hline\n\\text{将（帅） (J)} & \\text{士 (S)} & \\text{车 (C)} & \\text{马 (M)} & \\text{象（相） (X)} & \\text{兵（卒） (B)} \\\\\n\\hline\n12 & 6 & 2 & 4 & 3 & -1 \\\\\n\\hline\n\\end{array}\n$$\n\n因此，你只需要进行一次查询即可确定答案。\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P15075", "type": "P", "difficulty": 6, "samples": [["2\n2 2\n2 1\n3 2\n1 2 3", "-1\n3 1 2"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2024", "ICPC"], "title": "[ICPC 2024 Chengdu R] Closest Derangement", "background": "", "description": "Blackbird has a permutation $p$ of length $n$. He wants to find a derangement $q$ of $p$, which means $q$ is another permutation of length $n$ satisfying  $q_i\\neq p_i$ for each $i=1,2,\\ldots,n$. At the same time, $\\sum_{i=1}^{n}|p_i-q_i|$ should be minimized. A permutation $q$ that satisfies the above conditions is called the closest derangement of $p$.\n\nThere may be multiple closest derangements of $p$, and your task is to output the $k$-th smallest closest derangement in lexicographical order. If there are fewer than $k$ closest derangements of $p$, output $-1$.\n\nA permutation of length $n$ refers to a sequence of length $n$ where all elements are distinct and are positive integers from $1$ to $n$. Permutations can be sorted in lexicographical order. Let $a$ and $b$ be two distinct permutations of length $n$. Then, $a < b$ if and only if at the smallest index $i$ where $a_i \\neq b_i$, it holds that $a_i < b_i$.", "inputFormat": "The first line contains an integer $T$ ($1\\le T\\le 10^4$), representing the number of test cases.\n\nFor each test case, the first line contains two positive integers $n$ ($2\\le n \\le 2 \\cdot 10^5$) and $k$ ($1\\le k \\le 10^9$). The second line contains $n$ positive integers $p_1, p_2, \\ldots, p_n$, representing the permutation $p$.\n\nIt is guaranteed that the sum of $n$ over all test cases does not exceed $10^6$.", "outputFormat": "For each test case, if there are at least $k$ closest derangements, output $n$ positive integers $q_1, q_2, \\ldots, q_n$ in a single line separated by spaces, representing the $k$-th smallest closest derangement of $p$ in lexicographical order. Otherwise, output $-1$.", "hint": "For the first test case, $[1,2]$ is the only closest derangement, so output $-1$.\n\nFor the second test case, $[2,3,1]$ and $[3,1,2]$ are closest derangements of $p$, and $[3,1,2]$ is larger than $[2,3,1]$ in lexicographical order.", "locale": "en", "translations": {"en": {"title": "[ICPC 2024 Chengdu R] Closest Derangement", "background": "", "description": "Blackbird has a permutation $p$ of length $n$. He wants to find a derangement $q$ of $p$, which means $q$ is another permutation of length $n$ satisfying  $q_i\\neq p_i$ for each $i=1,2,\\ldots,n$. At the same time, $\\sum_{i=1}^{n}|p_i-q_i|$ should be minimized. A permutation $q$ that satisfies the above conditions is called the closest derangement of $p$.\n\nThere may be multiple closest derangements of $p$, and your task is to output the $k$-th smallest closest derangement in lexicographical order. If there are fewer than $k$ closest derangements of $p$, output $-1$.\n\nA permutation of length $n$ refers to a sequence of length $n$ where all elements are distinct and are positive integers from $1$ to $n$. Permutations can be sorted in lexicographical order. Let $a$ and $b$ be two distinct permutations of length $n$. Then, $a < b$ if and only if at the smallest index $i$ where $a_i \\neq b_i$, it holds that $a_i < b_i$.", "inputFormat": "The first line contains an integer $T$ ($1\\le T\\le 10^4$), representing the number of test cases.\n\nFor each test case, the first line contains two positive integers $n$ ($2\\le n \\le 2 \\cdot 10^5$) and $k$ ($1\\le k \\le 10^9$). The second line contains $n$ positive integers $p_1, p_2, \\ldots, p_n$, representing the permutation $p$.\n\nIt is guaranteed that the sum of $n$ over all test cases does not exceed $10^6$.", "outputFormat": "For each test case, if there are at least $k$ closest derangements, output $n$ positive integers $q_1, q_2, \\ldots, q_n$ in a single line separated by spaces, representing the $k$-th smallest closest derangement of $p$ in lexicographical order. Otherwise, output $-1$.", "hint": "For the first test case, $[1,2]$ is the only closest derangement, so output $-1$.\n\nFor the second test case, $[2,3,1]$ and $[3,1,2]$ are closest derangements of $p$, and $[3,1,2]$ is larger than $[2,3,1]$ in lexicographical order.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2024 Chengdu R] Closest Derangement", "background": "", "description": "Blackbird 有一个长度为 $n$ 的排列 $p$，他想找到 $p$ 的一个错位排列 $q$，即 $q$ 是另一个长度为 $n$ 的排列，且对于 $i=1,2,\\ldots,n$，都有 $q_i\\neq p_i$。与此同时，他希望 $\\sum_{i=1}^{n}|p_i-q_i|$ 取到最小值。满足上述条件的排列 $q$，称为 $p$ 的最近错位排列。\n\n$p$ 的最近错位排列可能有多个，你需要输出字典序第 $k$ 小的最近错位排列。如果 $p$ 的最近错位排列少于 $k$ 个，则输出 $-1$。\n\n一个长度为 $n$ 的排列，是指一个长度为 $n$ 的序列，满足所有元素互不相同且均为从 $1$ 到 $n$ 的正整数。排列可以按字典序排序。设 $a$ 和 $b$ 是两个长度为 $n$ 的不同的排列。那么，$a < b$ 当且仅当对于满足 $a_i \\neq b_i$ 的最小下标 $i$，有 $a_i < b_i$。", "inputFormat": "第一行包含一个整数 $T$（$1\\le T\\le 10^4$），表示测试数据组数。\n\n对于每组数据，第一行包含两个正整数 $n$（$2\\le n \\le 2 \\cdot 10^5$）和 $k$（$1\\le k \\le 10^9$）。第二行包含 $n$ 个正整数 $p_1, p_2, \\ldots, p_n$ 。保证 $p$ 是一个排列。\n\n保证每组数据中 $n$ 之和不超过 $10^6$。", "outputFormat": "对于每组数据，如果最近错位排列的数量不少于 $k$，则输出 $n$ 个正整数 $q_1, q_2, \\ldots, q_n$ ，表示 $p$ 的字典序第 $k$ 小的最近错位排列。否则输出 $-1$。", "hint": "第一个测试用例中，$[1,2]$ 是唯一的最近错位排列，所以输出 $-1$。\n\n第二个测试用例中，$[2,3,1]$ 和 $[3,1,2]$ 是 $p$ 的最近错位排列，且 $[3,1,2]$ 的字典序大于 $[2,3,1]$。", "locale": "zh-CN"}}}
{"pid": "P15076", "type": "P", "difficulty": 5, "samples": [["2\n3 2\n1 1\n2 3\n1 2\n5 3\n1 1 2 2\n4 5\n2 4\n2 3", "6\n5\n14\n13\n15"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2024", "ICPC"], "title": "[ICPC 2024 Chengdu R] Disrupting Communications", "background": "", "description": "The enemy has established communication outposts across several locations, which can be represented as nodes and edges in a network. This network forms a tree --- a type of graph that is connected and has no cycles. As a specialist in communications engineering, your task is to disrupt their communications.\n\nEach communication occurs along a simple path between two nodes in the tree. You have the ability to select a subgraph of this tree and disrupt every node in that subgraph. If the communication path includes a disrupted node, the communication is successfully disrupted. The subgraph you select must consist of a subset of nodes and edges from the original tree, and it must be connected, meaning it is also a tree.\n\nThe communication network consists of $n$ nodes, labeled from $1$ to $n$. Your mission involves answering $q$ separate queries. For each query, you are given two nodes, $u_i$ and $v_i$, and you must determine how many different subgraphs you can select to disrupt the communication between the two nodes. Since the number may be very large, you should provide the answer modulo $998244353$. It is possible that $u_i=v_i$, which indicates an internal communication within a node, and you are also able to disrupt it by selecting a subgraph that contains the node.", "inputFormat": "The first line contains a single integer $T$ ($1\\le T \\le 10^4$), indicating the number of test cases.\n\nThe first line of each test case contains two integers $n$ ($2\\le n\\le 10^5$) and $q$ ($1\\le q \\le 10^5$), denoting the number of nodes and the number of queries.\n\nThe second line contains $n-1$ integers $p_2,p_3,\\ldots ,p_n$ ($1\\le p_i < i$), indicating that nodes $i$ and $p_i$ are connected by an edge.\n\nEach of the next $q$ lines contains two integers $u_i,v_i$ ($1\\le u_i,v_i \\le n$), representing the $i$-th query.\n\nIt is guaranteed that the sum of $n$ and the sum of $q$ over all test cases do not exceed $3\\cdot 10^5$, respectively.", "outputFormat": "For each test case, output $q$ lines, each containing the result modulo $998244353$ for one of the $q$ queries.", "hint": "In the first case of the example, $6$ connected subgraphs can be selected in total. For the first query, all of them can disrupt the communication. For the second query, $5$ of them can disrupt the communication; the exception is the subgraph consisting only of node $3$.", "locale": "en", "translations": {"en": {"title": "[ICPC 2024 Chengdu R] Disrupting Communications", "background": "", "description": "The enemy has established communication outposts across several locations, which can be represented as nodes and edges in a network. This network forms a tree --- a type of graph that is connected and has no cycles. As a specialist in communications engineering, your task is to disrupt their communications.\n\nEach communication occurs along a simple path between two nodes in the tree. You have the ability to select a subgraph of this tree and disrupt every node in that subgraph. If the communication path includes a disrupted node, the communication is successfully disrupted. The subgraph you select must consist of a subset of nodes and edges from the original tree, and it must be connected, meaning it is also a tree.\n\nThe communication network consists of $n$ nodes, labeled from $1$ to $n$. Your mission involves answering $q$ separate queries. For each query, you are given two nodes, $u_i$ and $v_i$, and you must determine how many different subgraphs you can select to disrupt the communication between the two nodes. Since the number may be very large, you should provide the answer modulo $998244353$. It is possible that $u_i=v_i$, which indicates an internal communication within a node, and you are also able to disrupt it by selecting a subgraph that contains the node.", "inputFormat": "The first line contains a single integer $T$ ($1\\le T \\le 10^4$), indicating the number of test cases.\n\nThe first line of each test case contains two integers $n$ ($2\\le n\\le 10^5$) and $q$ ($1\\le q \\le 10^5$), denoting the number of nodes and the number of queries.\n\nThe second line contains $n-1$ integers $p_2,p_3,\\ldots ,p_n$ ($1\\le p_i < i$), indicating that nodes $i$ and $p_i$ are connected by an edge.\n\nEach of the next $q$ lines contains two integers $u_i,v_i$ ($1\\le u_i,v_i \\le n$), representing the $i$-th query.\n\nIt is guaranteed that the sum of $n$ and the sum of $q$ over all test cases do not exceed $3\\cdot 10^5$, respectively.", "outputFormat": "For each test case, output $q$ lines, each containing the result modulo $998244353$ for one of the $q$ queries.", "hint": "In the first case of the example, $6$ connected subgraphs can be selected in total. For the first query, all of them can disrupt the communication. For the second query, $5$ of them can disrupt the communication; the exception is the subgraph consisting only of node $3$.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2024 Chengdu R] Disrupting Communications", "background": "", "description": "敌人在多个地点建立了通信前哨站，这些站点可以表示为一个网络中的节点和边。该网络形成一棵**树**——这是一种连通且无环的图。作为一名通信工程专家，你的任务是破坏他们的通信。\n\n每次通信发生在树中两个节点之间的一条简单路径上。你有能力选择这棵树的一个子图，并破坏该子图中的每个节点。如果通信路径包含一个被破坏的节点，则该通信被成功破坏。你选择的子图必须由原树的一个节点和边的子集构成，并且它必须是连通的，即它本身也是一棵树。\n\n通信网络包含 $n$ 个节点，编号从 $1$ 到 $n$。你的任务包括回答 $q$ 个独立的查询。对于每个查询，给定两个节点 $u_i$ 和 $v_i$，你必须确定可以选择多少种不同的子图来破坏这两个节点之间的通信。由于数量可能非常大，你应该输出答案对 $998244353$ 取模的结果。可能出现 $u_i = v_i$ 的情况，这表示节点内部的通信，你也可以通过选择一个包含该节点的子图来破坏它。", "inputFormat": "-   第一行包含一个整数 $T$（$1\\le T \\le 10^4$），表示测试用例的数量。\n-   每个测试用例的第一行包含两个整数 $n$（$2\\le n\\le 10^5$）和 $q$（$1\\le q \\le 10^5$），分别表示节点数量和查询数量。\n-   第二行包含 $n-1$ 个整数 $p_2, p_3, \\ldots, p_n$（$1\\le p_i < i$），表示节点 $i$ 和 $p_i$ 之间由一条边连接。\n-   接下来的 $q$ 行，每行包含两个整数 $u_i, v_i$（$1\\le u_i, v_i \\le n$），表示第 $i$ 个查询。\n\n保证所有测试用例的 $n$ 之和以及 $q$ 之和分别不超过 $3 \\cdot 10^5$。", "outputFormat": "对于每个测试用例，输出 $q$ 行，每行包含一个查询的结果，对 $998244353$ 取模。", "hint": "在示例的第一个测试用例中，总共可以选择 $6$ 个连通子图。对于第一个查询，所有这些子图都能破坏通信。对于第二个查询，其中有 $5$ 个子图可以破坏通信；例外是仅包含节点 $3$ 的子图。\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P15077", "type": "P", "difficulty": 7, "samples": [["4 2\n1 2 3 4", "6.1911471295571"], ["10 3\n1 2 3 4 5 6 7 8 9 10", "22.5916253665141"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2024", "Special Judge", "ICPC"], "title": "[ICPC 2024 Chengdu R] Double 11", "background": "", "description": "With the Double 11 Shopping Festival approaching, a store is managing its best-selling products for the event.\n\nThere are $n$ types of best-selling products, and the daily sales volume for each type is $s_i$. Products need to be replenished multiple times to meet sales demand, and due to limited warehouse space, the total inventory must not exceed the storage capacity.\n\nIf only one type of product is replenished at a time, the workload becomes too high. To optimize replenishment, the store decides to divide the product types into $m$ groups, assigning a replenishment parameter to each group. For group $j$, the replenishment parameter $k_j$ is a positive real number, which means for each product type $i$ in this group, a volume of $k_j \\cdot s_i$ will be prepared for each replenishment, and it will be replenished $\\frac{1}{k_j}$ times per day on average. Note that $k_j$ can be either greater than, less than or equal to $1$.\n\nLet $c_i$ be the group index of product type $i$. The maximum inventory in the warehouse can be represented by $\\sum_{i=1}^{n}{k_{c_i} \\cdot s_i}$. Due to the warehouse capacity limitation, this value cannot exceed $1$.\n\nYour task is to find a scheme that divides the $n$ product types into $m$ groups and assigns a replenishment parameter to each group such that the total number of replenishments per day is minimized while satisfying the warehouse capacity limitation, i.e., minimize $\\sum_{i=1}^n{\\frac{1}{k_{c_i}}}$, subject to $\\sum_{i=1}^{n}{k_{c_i} \\cdot s_i} \\le 1$. For convenience, you should output the square root of the minimal answer, i.e., $\\sqrt{\\sum_{i=1}^n{\\frac{1}{k_{c_i}}}}$. Note that you can assign the same replenishment parameters to different groups.", "inputFormat": "The first line contains two integers $n$ and $m$ ($1 \\le m \\le n \\le 2 \\cdot 10^5$), indicating the number of product types and the number of groups.\n\nThe second line contains $n$ integers $s_i$ ($1\\le s_i \\le 10^5$), indicating the sales volume of product type $i$.", "outputFormat": "Output one real number, indicating the answer. Your output will be considered correct if the relative or absolute error does not exceed $10^{-9}$.", "hint": "For the first example, let $k_1=\\frac{1}{3+\\sqrt{21}}, k_2=\\frac{1}{7+\\sqrt{21}}$, and $c_1=c_2=1,c_3=c_4=2$. We will get the maximum inventory as $(1+2)k_1 + (3+4)k_2 = 1$, and the total number of replenishments is $\\frac{2}{k_1}+\\frac{2}{k_2}=20+4\\sqrt{21}$. Therefore, the answer is $\\sqrt{20+4\\sqrt{21}} \\approx 6.1911471295571$, which is the minimum.", "locale": "en", "translations": {"en": {"title": "[ICPC 2024 Chengdu R] Double 11", "background": "", "description": "With the Double 11 Shopping Festival approaching, a store is managing its best-selling products for the event.\n\nThere are $n$ types of best-selling products, and the daily sales volume for each type is $s_i$. Products need to be replenished multiple times to meet sales demand, and due to limited warehouse space, the total inventory must not exceed the storage capacity.\n\nIf only one type of product is replenished at a time, the workload becomes too high. To optimize replenishment, the store decides to divide the product types into $m$ groups, assigning a replenishment parameter to each group. For group $j$, the replenishment parameter $k_j$ is a positive real number, which means for each product type $i$ in this group, a volume of $k_j \\cdot s_i$ will be prepared for each replenishment, and it will be replenished $\\frac{1}{k_j}$ times per day on average. Note that $k_j$ can be either greater than, less than or equal to $1$.\n\nLet $c_i$ be the group index of product type $i$. The maximum inventory in the warehouse can be represented by $\\sum_{i=1}^{n}{k_{c_i} \\cdot s_i}$. Due to the warehouse capacity limitation, this value cannot exceed $1$.\n\nYour task is to find a scheme that divides the $n$ product types into $m$ groups and assigns a replenishment parameter to each group such that the total number of replenishments per day is minimized while satisfying the warehouse capacity limitation, i.e., minimize $\\sum_{i=1}^n{\\frac{1}{k_{c_i}}}$, subject to $\\sum_{i=1}^{n}{k_{c_i} \\cdot s_i} \\le 1$. For convenience, you should output the square root of the minimal answer, i.e., $\\sqrt{\\sum_{i=1}^n{\\frac{1}{k_{c_i}}}}$. Note that you can assign the same replenishment parameters to different groups.", "inputFormat": "The first line contains two integers $n$ and $m$ ($1 \\le m \\le n \\le 2 \\cdot 10^5$), indicating the number of product types and the number of groups.\n\nThe second line contains $n$ integers $s_i$ ($1\\le s_i \\le 10^5$), indicating the sales volume of product type $i$.", "outputFormat": "Output one real number, indicating the answer. Your output will be considered correct if the relative or absolute error does not exceed $10^{-9}$.", "hint": "For the first example, let $k_1=\\frac{1}{3+\\sqrt{21}}, k_2=\\frac{1}{7+\\sqrt{21}}$, and $c_1=c_2=1,c_3=c_4=2$. We will get the maximum inventory as $(1+2)k_1 + (3+4)k_2 = 1$, and the total number of replenishments is $\\frac{2}{k_1}+\\frac{2}{k_2}=20+4\\sqrt{21}$. Therefore, the answer is $\\sqrt{20+4\\sqrt{21}} \\approx 6.1911471295571$, which is the minimum.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2024 Chengdu R] Double 11", "background": "", "description": "随着双十一购物节临近，一家商店正在为活动筹备其畅销商品。\n\n共有 $n$ 种畅销商品，每种商品的日销售量为 $s_i$。商品需要多次补货以满足销售需求，并且由于仓库空间有限，总库存不得超过存储容量。\n\n如果每次只补货一种商品，工作量会过于繁重。为了优化补货流程，商店决定将这 $n$ 种商品划分为 $m$ 个组，并为每个组分配一个补货参数。对于第 $j$ 组，其补货参数 $k_j$ 是一个正实数，这意味着对于该组中的每种商品 $i$，每次补货将准备 $k_j \\cdot s_i$ 的货量，并且平均每天将补货 $\\frac{1}{k_j}$ 次。注意，$k_j$ 可以大于、小于或等于 $1$。\n\n令 $c_i$ 表示商品 $i$ 所属的组别索引。仓库中的最大库存量可以表示为 $\\sum_{i=1}^{n}{k_{c_i} \\cdot s_i}$。由于仓库容量限制，该值不能超过 $1$。\n\n你的任务是找到一个方案，将 $n$ 种商品划分为 $m$ 个组，并为每个组分配一个补货参数，使得在满足仓库容量限制（即 $\\sum_{i=1}^{n}{k_{c_i} \\cdot s_i} \\le 1$）的前提下，最小化每日的总补货次数 $\\sum_{i=1}^n{\\frac{1}{k_{c_i}}}$。为方便起见，你需要输出最小答案的平方根，即 $\\sqrt{\\sum_{i=1}^n{\\frac{1}{k_{c_i}}}}$。注意，不同的组可以分配相同的补货参数。", "inputFormat": "-   第一行包含两个整数 $n$ 和 $m$（$1 \\le m \\le n \\le 2 \\cdot 10^5$），分别表示商品种类数和组数。\n-   第二行包含 $n$ 个整数 $s_i$（$1\\le s_i \\le 10^5$），表示第 $i$ 种商品的销售量。", "outputFormat": "输出一个实数，表示答案。当你的输出的相对误差或绝对误差不超过 $10^{-9}$ 时，即被视为正确。\n", "hint": "对于第一个示例，设 $k_1=\\frac{1}{3+\\sqrt{21}}, k_2=\\frac{1}{7+\\sqrt{21}}$，且 $c_1=c_2=1, c_3=c_4=2$。则最大库存为 $(1+2)k_1 + (3+4)k_2 = 1$，总补货次数为 $\\frac{2}{k_1}+\\frac{2}{k_2}=20+4\\sqrt{21}$。因此，答案为 $\\sqrt{20+4\\sqrt{21}} \\approx 6.1911471295571$，这是最小值。\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P15078", "type": "P", "difficulty": 3, "samples": [["2\n2 3", "4"], ["2\n3 4", "4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["数学", "2024", "ICPC"], "title": "[ICPC 2024 Chengdu R] Expanding Array", "background": "", "description": "Given an integer array $a_1, a_2, \\ldots, a_n$ of length $n$, you can perform any number of operations on this array. In each operation, you can choose two adjacent elements $a_i$ and $a_{i+1}$ ($1 \\le i < n$), and insert one of the following three values between them: $a_i \\ \\texttt{and}\\ a_{i+1}$, $a_i \\ \\texttt{or}\\ a_{i+1}$, or $a_i \\oplus a_{i+1}$. Your task is to determine the maximum number of distinct values that can exist in the array after performing any number of operations.\n\n$\\textbf{Note:}$ $x \\ \\texttt{and}\\ y$ represents the bitwise AND of $x$ and $y$. $x \\ \\texttt{or}\\ y$ represents the bitwise OR of $x$ and $y$. $x \\oplus y$ represents the bitwise XOR (exclusive OR) of $x$ and $y$.", "inputFormat": "The first line contains a single integer $n$ ($2 \\le n \\le 10^5$), representing the length of the array.\n\nThe second line contains $n$ integers $a_1, a_2, \\ldots, a_n$ ($0 \\le a_i \\le 10^9$), representing the elements of the array.\n", "outputFormat": "Output a single integer, representing the maximum number of distinct values that can be obtained in the array after performing any number of operations.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2024 Chengdu R] Expanding Array", "background": "", "description": "Given an integer array $a_1, a_2, \\ldots, a_n$ of length $n$, you can perform any number of operations on this array. In each operation, you can choose two adjacent elements $a_i$ and $a_{i+1}$ ($1 \\le i < n$), and insert one of the following three values between them: $a_i \\ \\texttt{and}\\ a_{i+1}$, $a_i \\ \\texttt{or}\\ a_{i+1}$, or $a_i \\oplus a_{i+1}$. Your task is to determine the maximum number of distinct values that can exist in the array after performing any number of operations.\n\n$\\textbf{Note:}$ $x \\ \\texttt{and}\\ y$ represents the bitwise AND of $x$ and $y$. $x \\ \\texttt{or}\\ y$ represents the bitwise OR of $x$ and $y$. $x \\oplus y$ represents the bitwise XOR (exclusive OR) of $x$ and $y$.", "inputFormat": "The first line contains a single integer $n$ ($2 \\le n \\le 10^5$), representing the length of the array.\n\nThe second line contains $n$ integers $a_1, a_2, \\ldots, a_n$ ($0 \\le a_i \\le 10^9$), representing the elements of the array.\n", "outputFormat": "Output a single integer, representing the maximum number of distinct values that can be obtained in the array after performing any number of operations.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2024 Chengdu R] Expanding Array", "background": "", "description": "给定一个长度为 $n$ 的整数数组 $a_1, a_2, \\ldots, a_n$，你可以对该数组执行任意次操作。在每次操作中，你可以选择两个相邻元素 $a_i$ 和 $a_{i+1}$（$1 \\le i < n$），并在它们之间插入以下三个值之一：$a_i \\ \\texttt{and}\\ a_{i+1}$、$a_i \\ \\texttt{or}\\ a_{i+1}$ 或 $a_i \\oplus a_{i+1}$。你的任务是确定在执行任意次操作后，数组中最多可以存在多少种不同的值。\n\n$\\textbf{注意：}$ $x \\ \\texttt{and}\\ y$ 表示 $x$ 和 $y$ 的按位与。$x \\ \\texttt{or}\\ y$ 表示 $x$ 和 $y$ 的按位或。$x \\oplus y$ 表示 $x$ 和 $y$ 的按位异或。", "inputFormat": "-   第一行包含一个整数 $n$（$2 \\le n \\le 10^5$），表示数组的长度。\n-   第二行包含 $n$ 个整数 $a_1, a_2, \\ldots, a_n$（$0 \\le a_i \\le 10^9$），表示数组的元素。\n", "outputFormat": "输出一个整数，表示在执行任意次操作后，数组中最多可以获得的不同的值的数量。\n", "hint": "翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P15079", "type": "P", "difficulty": 7, "samples": [["2\n108 112\n114514 1919810", "31\n86328270"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2024", "ICPC"], "title": "[ICPC 2024 Chengdu R] Friendship is Magic", "background": "", "description": "Rockdu is a pony living in Ponyville. His best friend, Macaronlin, also lives there. Rockdu values friendship so much that he shares everything with Macaronlin, even integers.\n\nHere comes the question: how to share an integer with someone else? For an integer $x$, Rockdu splits it into two parts. Specifically, he treats $x$ in decimal form as a string without leading zeros, and splits it into two non-empty substrings at a certain position. He then considers these two substrings as two separate decimal integers, denoted as $x_1$ (the former) and $x_2$ (the latter).\n\nRockdu wants $x_1$ and $x_2$ to be as close in value as possible. Therefore, among all possible splits, he chooses the one that minimizes the absolute difference between $x_1$ and $x_2$. For example, if $x = 1003$, there are three possible ways to split it: $1|003$, $10|03$, and $100|3$. Rockdu chooses the first way because it yields the smallest absolute difference: $|1 - 3| = 2$, whereas the other ways give $|10 - 3| = 7$ and $|100 - 3| = 97$.\n\nLet $f(x)$ be defined as the smallest absolute difference between the two integers resulting from splitting $x$. For example, $f(1003)=2$. Given two integers $l$ and $r$, Rockdu wants to calculate the sum of $f(i)$ for all $i$ in the range $[l, r]$. Since the answer may be very large, please output it modulo $10^9 + 7$.", "inputFormat": "The first line contains an integer $T$ ($1 \\le T \\le 1000$), indicating the number of test cases.\n\nEach test case contains two integers $l,r$ ($10 \\le l \\le r \\le 10^{18}$) in a single line.", "outputFormat": "For each test case, output the answer modulo $10^9+7$ in a single line.", "hint": "For the first test case in the sample:\n\n- $f(108)=\\min(|1-8|,|10-8|)=\\min(7,2)=2$\n- $f(109)=\\min(|1-9|,|10-9|)=\\min(8,1)=1$\n- $f(110)=\\min(|1-10|,|11-0|)=\\min(9,11)=9$\n- $f(111)=\\min(|1-11|,|11-1|)=\\min(10,10)=10$\n- $f(112)=\\min(|1-12|,|11-2|)=\\min(11,9)=9$\n\nTherefore, $\\sum_{i=108}^{112}f(i)=2+1+9+10+9=31$.", "locale": "en", "translations": {"en": {"title": "[ICPC 2024 Chengdu R] Friendship is Magic", "background": "", "description": "Rockdu is a pony living in Ponyville. His best friend, Macaronlin, also lives there. Rockdu values friendship so much that he shares everything with Macaronlin, even integers.\n\nHere comes the question: how to share an integer with someone else? For an integer $x$, Rockdu splits it into two parts. Specifically, he treats $x$ in decimal form as a string without leading zeros, and splits it into two non-empty substrings at a certain position. He then considers these two substrings as two separate decimal integers, denoted as $x_1$ (the former) and $x_2$ (the latter).\n\nRockdu wants $x_1$ and $x_2$ to be as close in value as possible. Therefore, among all possible splits, he chooses the one that minimizes the absolute difference between $x_1$ and $x_2$. For example, if $x = 1003$, there are three possible ways to split it: $1|003$, $10|03$, and $100|3$. Rockdu chooses the first way because it yields the smallest absolute difference: $|1 - 3| = 2$, whereas the other ways give $|10 - 3| = 7$ and $|100 - 3| = 97$.\n\nLet $f(x)$ be defined as the smallest absolute difference between the two integers resulting from splitting $x$. For example, $f(1003)=2$. Given two integers $l$ and $r$, Rockdu wants to calculate the sum of $f(i)$ for all $i$ in the range $[l, r]$. Since the answer may be very large, please output it modulo $10^9 + 7$.", "inputFormat": "The first line contains an integer $T$ ($1 \\le T \\le 1000$), indicating the number of test cases.\n\nEach test case contains two integers $l,r$ ($10 \\le l \\le r \\le 10^{18}$) in a single line.", "outputFormat": "For each test case, output the answer modulo $10^9+7$ in a single line.", "hint": "For the first test case in the sample:\n\n- $f(108)=\\min(|1-8|,|10-8|)=\\min(7,2)=2$\n- $f(109)=\\min(|1-9|,|10-9|)=\\min(8,1)=1$\n- $f(110)=\\min(|1-10|,|11-0|)=\\min(9,11)=9$\n- $f(111)=\\min(|1-11|,|11-1|)=\\min(10,10)=10$\n- $f(112)=\\min(|1-12|,|11-2|)=\\min(11,9)=9$\n\nTherefore, $\\sum_{i=108}^{112}f(i)=2+1+9+10+9=31$.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2024 Chengdu R] Friendship is Magic", "background": "", "description": "Rockdu 是住在小马谷的一匹小马。他最好的朋友 Macaronlin 也住在那里。Rockdu 非常珍视友谊，以至于他与 Macaronlin 分享一切，甚至包括整数。\n\n问题来了：如何与别人分享一个整数呢？对于一个整数 $x$，Rockdu 会将其分成两部分。具体来说，他将 $x$ 的十进制形式视为一个没有前导零的字符串，并在某个位置将其分割成两个非空子串。然后，他将这两个子串视为两个独立的十进制整数，分别记为 $x_1$（前半部分）和 $x_2$（后半部分）。\n\nRockdu 希望 $x_1$ 和 $x_2$ 的值尽可能接近。因此，在所有可能的分割方式中，他选择使 $x_1$ 和 $x_2$ 的绝对差最小化的那一种。例如，如果 $x = 1003$，有三种可能的分割方式：$1|003$、$10|03$ 和 $100|3$。Rockdu 选择第一种方式，因为它产生的绝对差最小：$|1 - 3| = 2$，而其他方式分别给出 $|10 - 3| = 7$ 和 $|100 - 3| = 97$。\n\n定义 $f(x)$ 为将 $x$ 分割后得到的两个整数之间的最小绝对差。例如，$f(1003) = 2$。给定两个整数 $l$ 和 $r$，Rockdu 想要计算区间 $[l, r]$ 内所有 $i$ 的 $f(i)$ 之和。由于答案可能非常大，请输出其对 $10^9 + 7$ 取模的结果。", "inputFormat": "-   第一行包含一个整数 $T$（$1 \\le T \\le 1000$），表示测试用例的数量。\n-   每个测试用例在一行中包含两个整数 $l, r$（$10 \\le l \\le r \\le 10^{18}$）。\n", "outputFormat": "对于每个测试用例，在一行中输出答案对 $10^9+7$ 取模的结果。\n", "hint": "对于样例中的第一个测试用例：\n\n- $f(108)=\\min(|1-8|,|10-8|)=\\min(7,2)=2$\n- $f(109)=\\min(|1-9|,|10-9|)=\\min(8,1)=1$\n- $f(110)=\\min(|1-10|,|11-0|)=\\min(9,11)=9$\n- $f(111)=\\min(|1-11|,|11-1|)=\\min(10,10)=10$\n- $f(112)=\\min(|1-12|,|11-2|)=\\min(11,9)=9$\n\n因此，$\\sum_{i=108}^{112}f(i)=2+1+9+10+9=31$。\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P15080", "type": "P", "difficulty": 4, "samples": [["1\n5 2\n4 3 2 6 1\n2 5\n3 5", "1\n2\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["数学", "线段树", "2024", "最大公约数 gcd", "ICPC"], "title": "[ICPC 2024 Chengdu R] Good Partitions", "background": "", "description": "Lawliet has a sequence of numbers of length $n$, denoted as $a_1, a_2, \\ldots, a_n$, and he wants to determine how many good partitions exist.\n\nA partition size $k$ is considered a good partition size if it satisfies $1 \\leq k \\leq n$ and, after dividing the sequence $a$ into parts by partition size, each resulting sub-sequence is non-decreasing. The partitioning method is as follows:\n\n- The sequence $a$ is divided into $\\lceil \\frac{n}{k} \\rceil$ parts.\n- For the $i$-th part ($1 \\leq i \\leq \\lceil \\frac{n}{k} \\rceil - 1$), the elements are $a_{(i - 1) \\times k + 1}, a_{(i - 1) \\times k + 2}, \\ldots, a_{i \\times k}$.\n- For the $\\lceil \\frac{n}{k} \\rceil$-th part, the elements are $a_{(\\lceil \\frac{n}{k} \\rceil - 1) \\times k + 1}, \\ldots, a_n$. Note that the length of the last part may be less than $k$.\n\nLawliet finds this problem too simple, so he will make $q$ modifications. Each modification provides two positive integers $p$ and $v$, indicating that the value of $a_p$ will be changed to $v$.\n\nYour task is to help Lawliet calculate the number of good partition sizes before any modifications and after each modification.", "inputFormat": "The first line contains an integer $T$ ($1\\le T \\le 10$), representing the number of test cases.\n\nFor each test case, the first line contains two integers $n$ ($1 \\le n \\le 2 \\cdot 10^5$) and $q$ ($1 \\le q \\le 2 \\cdot 10^5$), representing the length of the sequence and the number of modifications.\n\nThe second line contains $n$ integers, representing the sequence $a_1, a_2, \\ldots, a_n$ ($1\\le a_i\\le 2\\cdot 10^9$).\n\nThe following $q$ lines each contain two integers $p$ ($1 \\le p \\le n$) and $v$ ($1 \\le v \\le 2 \\cdot 10^9$), indicating that the element at the $p$-th position in the sequence will be modified to $v$.\n\nIt is guaranteed that the sum of $n$ and the sum of $q$ over all test cases do not exceed $2\\cdot 10^5$, respectively.", "outputFormat": "For each test case, output $q + 1$ lines, representing the number of good partition sizes before any modifications and after each modification.", "hint": "Initially, the only good partition size is $k = 1$.\n\nAfter the first modification, the sequence becomes $[4, 5, 2, 6, 1]$. Both $k = 1$ and $k = 2$ are good partition sizes.\n\nAfter the second modification, the sequence becomes $[4, 5, 5, 6, 1]$. The good partition sizes are $k = 1$, $k = 2$, and $k = 4$.", "locale": "en", "translations": {"en": {"title": "[ICPC 2024 Chengdu R] Good Partitions", "background": "", "description": "Lawliet has a sequence of numbers of length $n$, denoted as $a_1, a_2, \\ldots, a_n$, and he wants to determine how many good partitions exist.\n\nA partition size $k$ is considered a good partition size if it satisfies $1 \\leq k \\leq n$ and, after dividing the sequence $a$ into parts by partition size, each resulting sub-sequence is non-decreasing. The partitioning method is as follows:\n\n- The sequence $a$ is divided into $\\lceil \\frac{n}{k} \\rceil$ parts.\n- For the $i$-th part ($1 \\leq i \\leq \\lceil \\frac{n}{k} \\rceil - 1$), the elements are $a_{(i - 1) \\times k + 1}, a_{(i - 1) \\times k + 2}, \\ldots, a_{i \\times k}$.\n- For the $\\lceil \\frac{n}{k} \\rceil$-th part, the elements are $a_{(\\lceil \\frac{n}{k} \\rceil - 1) \\times k + 1}, \\ldots, a_n$. Note that the length of the last part may be less than $k$.\n\nLawliet finds this problem too simple, so he will make $q$ modifications. Each modification provides two positive integers $p$ and $v$, indicating that the value of $a_p$ will be changed to $v$.\n\nYour task is to help Lawliet calculate the number of good partition sizes before any modifications and after each modification.", "inputFormat": "The first line contains an integer $T$ ($1\\le T \\le 10$), representing the number of test cases.\n\nFor each test case, the first line contains two integers $n$ ($1 \\le n \\le 2 \\cdot 10^5$) and $q$ ($1 \\le q \\le 2 \\cdot 10^5$), representing the length of the sequence and the number of modifications.\n\nThe second line contains $n$ integers, representing the sequence $a_1, a_2, \\ldots, a_n$ ($1\\le a_i\\le 2\\cdot 10^9$).\n\nThe following $q$ lines each contain two integers $p$ ($1 \\le p \\le n$) and $v$ ($1 \\le v \\le 2 \\cdot 10^9$), indicating that the element at the $p$-th position in the sequence will be modified to $v$.\n\nIt is guaranteed that the sum of $n$ and the sum of $q$ over all test cases do not exceed $2\\cdot 10^5$, respectively.", "outputFormat": "For each test case, output $q + 1$ lines, representing the number of good partition sizes before any modifications and after each modification.", "hint": "Initially, the only good partition size is $k = 1$.\n\nAfter the first modification, the sequence becomes $[4, 5, 2, 6, 1]$. Both $k = 1$ and $k = 2$ are good partition sizes.\n\nAfter the second modification, the sequence becomes $[4, 5, 5, 6, 1]$. The good partition sizes are $k = 1$, $k = 2$, and $k = 4$.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2024 Chengdu R] Good Partitions", "background": "", "description": "Lawliet 拥有一个长度为 $n$ 的数字序列 $a_1, a_2, \\ldots, a_n$，他希望知道「好数字」的个数。\n\n定义一个整数 $k$ 是「好数字」，如果它满足以下条件：\n  - $1 \\leq k \\leq n$；\n  - 将序列 $a$ 依据 $k$ 按照以下划分方法分成若干份后，每一份序列都是单调不降的。\n\n划分方法为：\n  - 将序列 $a$ 分成 $\\lceil \\frac{n}{k} \\rceil$ 份；\n  - 对于第 $i$ 份（$1 \\leq i \\leq \\lceil \\frac{n}{k} \\rceil - 1$），包含的元素是 $a_{(i - 1) \\times k + 1}, a_{(i - 1) \\times k + 2}, \\ldots, a_{i \\times k}$；\n  - 对于第 $\\lceil \\frac{n}{k} \\rceil$ 份，包含的元素是 $a_{(\\lceil \\frac{n}{k} \\rceil - 1) \\times k + 1}, \\ldots, a_n$。\n\nLawliet 认为这个问题太过简单了，于是他会进行 $q$ 次修改，每次修改会给出两个正整数 $p$ 和 $v$，然后将 $a_p$ 的数值修改为 $v$。\n\nLawliet 需要你帮助计算，对于未进行任何修改前以及序列 $a$ 每次修改后，满足上述条件的「好数字」的个数。\n", "inputFormat": "第一行包含一个整数 $t$（$1\\le t\\le 10$），代表测试组数。\n\n对于每组测试数据，第一行包含两个整数 $n$（$1 \\le n \\le 2 \\cdot 10^5$）和 $q$（$1 \\le q \\le 2 \\cdot 10^5$），分别表示序列的长度和修改次数。\n\n第二行包含 $n$ 个整数，表示序列 $a_1, a_2, \\ldots, a_n$（$1\\le a_i\\le 2\\cdot 10^9$）。\n\n接下来的 $q$ 行，每行包含两个整数 $p$（$1 \\le p \\le n$）和 $v$（$1 \\le v \\le 2 \\cdot 10^9$），表示将序列中的第 $p$ 个位置的元素修改为 $v$。\n\n单个测试点中 $n$ 之和与 $q$ 之和均不超过 $2\\cdot 10^5$。", "outputFormat": "对于每组测试数据，输出 $q + 1$ 行，分别代表未进行任何修改前以及序列 $a$ 每次修改后，序列中的「好数字」的个数。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P15081", "type": "P", "difficulty": 3, "samples": [["3\n3 4 6\n1 2\n2 1 1\n2 2 2\n3 3 2\n2 3 2\n2 1 2\n3 4 8\n1 2\n2 1 1\n2 2 2\n3 3 2\n2 3 2\n2 1 2\n1 1\n2 1 1\n3 4 7\n1 2\n2 1 1\n2 2 2\n3 3 2\n2 3 2\n2 1 2\n1 1", "2 4\n1 3\n3 0\n4 0\n1 7\n2 4\n3 0\n4 0\n2 4\n1 3\n3 0\n4 0"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["模拟", "2024", "ICPC"], "title": "[ICPC 2024 Chengdu R] Grand Prix of Ballance", "background": "", "description": "Ballance is a classic game where players use the keyboard to control a ball through complex structures high above the ground, avoiding falls while solving puzzles to reach the end of each level. Recently, the player community has developed online mods and hosts regular online competitions, such as the Grand Prix of Ballance.\n\nThe Grand Prix consists of $n$ levels, numbered from $1$ to $n$, with $m$ participants, numbered from $1$ to $m$. The competition uses a point system: players earn points based on their ranking in each level, and the sum of their points across all levels determines the final standings. Each level has a designated start time, and participants must complete the level as quickly as possible. As a staff member, you receive a server log during the match containing three types of messages (it is guaranteed that $1\\le x\\le n$ and $1\\le id\\le m$):\n\n- $\\tt{1\\ x}$ --- Type 1: the match on Level $x$ has started.\n- $\\tt{2\\ id\\ x}$ --- Type 2: participant indexed $id$ has completed Level $x$.\n- $\\tt{3\\ id\\ x}$ --- Type 3: participant indexed $id$ voluntarily gives up completing Level $x$.\n\nA Type 1 message indicates the start of Level $x$ until a new Type 1 message appears for a different level. Only messages that correspond to the currently active level are considered valid; all messages for other levels should be ignored. Messages before the first Type 1 message are also ignored. Each level appears at most once in a Type 1 message.\n\nEach player may yield multiple Type 2 and Type 3 messages per level, but only the first valid message counts. Specifically:\n\n- Messages are ignored if they do not match the active level indicated by the Type 1 message.\n- If a player's first valid message for a level is Type 2, they are considered to have completed the level successfully at that moment, and the player's any subsequent messages for that level are ignored.\n- If a player's first valid message for a level is Type 3, they are considered to have given up completing the level at that moment, and the player's any subsequent messages for that level are ignored.\n- If a player yields no messages for a level, they are considered not to have completed the level.\n\nPoints are awarded to participants who complete the level as follows: the first player to complete the level receives $m$ points, the second receives $m-1$ points, and so on. Participants who do not complete the level, including those who give up, receive no points.\n\nYour task is to output the current total points of each participant in descending order based on the log. If multiple participants have the same points, they should be listed in ascending order by their index.\n", "inputFormat": "The first line contains an integer $T$ ($1 \\leq T \\leq 10^4$), indicating the number of test cases.\n\nFor each test case, the first line contains three integers $n$, $m$, and $q$ ($1 \\leq n \\leq 10^5$, $2 \\leq m \\leq 10^5$, $1 \\leq q \\leq 2 \\cdot 10^5$), indicating  the number of levels, participants, and log messages, respectively.\n\nThe following $q$ lines contain the log messages as specified above. Of course, the messages are presented in chronological order. The log may not contain all levels, as you may receive it midway through the competition. You only need to process the current results.\n\nIt is guaranteed that the sum of $n$, the sum of $m$, and the sum of $q$ over all test cases do not exceed $5 \\cdot 10^5$, respectively.", "outputFormat": "For each test case, output $m$ lines, each containing two integers: $id$ and $x$, where $id$ is the participant's index and $x$ is their total points, sorted in descending order of points. If multiple participants have the same points, list them in ascending order by their index.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2024 Chengdu R] Grand Prix of Ballance", "background": "", "description": "Ballance is a classic game where players use the keyboard to control a ball through complex structures high above the ground, avoiding falls while solving puzzles to reach the end of each level. Recently, the player community has developed online mods and hosts regular online competitions, such as the Grand Prix of Ballance.\n\nThe Grand Prix consists of $n$ levels, numbered from $1$ to $n$, with $m$ participants, numbered from $1$ to $m$. The competition uses a point system: players earn points based on their ranking in each level, and the sum of their points across all levels determines the final standings. Each level has a designated start time, and participants must complete the level as quickly as possible. As a staff member, you receive a server log during the match containing three types of messages (it is guaranteed that $1\\le x\\le n$ and $1\\le id\\le m$):\n\n- $\\tt{1\\ x}$ --- Type 1: the match on Level $x$ has started.\n- $\\tt{2\\ id\\ x}$ --- Type 2: participant indexed $id$ has completed Level $x$.\n- $\\tt{3\\ id\\ x}$ --- Type 3: participant indexed $id$ voluntarily gives up completing Level $x$.\n\nA Type 1 message indicates the start of Level $x$ until a new Type 1 message appears for a different level. Only messages that correspond to the currently active level are considered valid; all messages for other levels should be ignored. Messages before the first Type 1 message are also ignored. Each level appears at most once in a Type 1 message.\n\nEach player may yield multiple Type 2 and Type 3 messages per level, but only the first valid message counts. Specifically:\n\n- Messages are ignored if they do not match the active level indicated by the Type 1 message.\n- If a player's first valid message for a level is Type 2, they are considered to have completed the level successfully at that moment, and the player's any subsequent messages for that level are ignored.\n- If a player's first valid message for a level is Type 3, they are considered to have given up completing the level at that moment, and the player's any subsequent messages for that level are ignored.\n- If a player yields no messages for a level, they are considered not to have completed the level.\n\nPoints are awarded to participants who complete the level as follows: the first player to complete the level receives $m$ points, the second receives $m-1$ points, and so on. Participants who do not complete the level, including those who give up, receive no points.\n\nYour task is to output the current total points of each participant in descending order based on the log. If multiple participants have the same points, they should be listed in ascending order by their index.\n", "inputFormat": "The first line contains an integer $T$ ($1 \\leq T \\leq 10^4$), indicating the number of test cases.\n\nFor each test case, the first line contains three integers $n$, $m$, and $q$ ($1 \\leq n \\leq 10^5$, $2 \\leq m \\leq 10^5$, $1 \\leq q \\leq 2 \\cdot 10^5$), indicating  the number of levels, participants, and log messages, respectively.\n\nThe following $q$ lines contain the log messages as specified above. Of course, the messages are presented in chronological order. The log may not contain all levels, as you may receive it midway through the competition. You only need to process the current results.\n\nIt is guaranteed that the sum of $n$, the sum of $m$, and the sum of $q$ over all test cases do not exceed $5 \\cdot 10^5$, respectively.", "outputFormat": "For each test case, output $m$ lines, each containing two integers: $id$ and $x$, where $id$ is the participant's index and $x$ is their total points, sorted in descending order of points. If multiple participants have the same points, list them in ascending order by their index.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2024 Chengdu R] Grand Prix of Ballance", "background": "", "description": "Ballance 是一款经典游戏，玩家使用键盘控制一颗球在高空复杂的结构中穿行，避免坠落，同时解开谜题以抵达每个关卡的终点。最近，玩家社区开发了在线模组，并定期举办在线比赛，例如 Ballance 大奖赛。\n\n大奖赛包含 $n$ 个关卡，编号从 $1$ 到 $n$，以及 $m$ 名参与者，编号从 $1$ 到 $m$。比赛采用积分制：玩家根据他们在每个关卡中的排名获得积分，他们在所有关卡中的积分总和决定了最终排名。每个关卡都有指定的开始时间，参与者必须尽快完成该关卡。作为工作人员，你在比赛期间收到一份服务器日志，其中包含三种类型的消息（保证 $1\\le x\\le n$ 且 $1\\le id\\le m$）：\n\n- $\\tt{1\\ x}$ —— 类型 1：第 $x$ 关的比赛开始。\n- $\\tt{2\\ id\\ x}$ —— 类型 2：编号为 $id$ 的参与者完成了第 $x$ 关。\n- $\\tt{3\\ id\\ x}$ —— 类型 3：编号为 $id$ 的参与者自愿放弃完成第 $x$ 关。\n\n一条类型 1 的消息标志着第 $x$ 关的开始，直到出现针对另一关卡的新类型 1 消息为止。只有与当前活动关卡对应的消息才被视为有效；所有针对其他关卡的消息都应被忽略。第一条类型 1 消息之前的消息也一并忽略。每个关卡在类型 1 消息中最多出现一次。\n\n每名玩家在每个关卡可能产生多条类型 2 和类型 3 消息，但只有第一条有效消息会被计入。具体规则如下：\n\n- 如果消息与类型 1 消息指示的活动关卡不匹配，则忽略该消息。\n- 如果玩家对某关卡的第一条有效消息是类型 2，则认为他在该时刻成功完成了该关卡，并且该玩家针对该关卡的后续所有消息都将被忽略。\n- 如果玩家对某关卡的第一条有效消息是类型 3，则认为他在该时刻放弃了完成该关卡，并且该玩家针对该关卡的后续所有消息都将被忽略。\n- 如果玩家对某关卡没有产生任何消息，则认为他未完成该关卡。\n\n完成关卡的参与者将按如下规则获得积分：第一个完成关卡的玩家获得 $m$ 分，第二个获得 $m-1$ 分，以此类推。未完成关卡的参与者（包括放弃者）不得分。\n\n你的任务是根据日志输出每位参与者当前的总积分，并按积分降序排序。如果多名参与者积分相同，则按他们的编号升序列出。", "inputFormat": "-   第一行包含一个整数 $T$（$1 \\leq T \\leq 10^4$），表示测试用例的数量。\n-   对于每个测试用例，第一行包含三个整数 $n$、$m$ 和 $q$（$1 \\leq n \\leq 10^5$，$2 \\leq m \\leq 10^5$，$1 \\leq q \\leq 2 \\cdot 10^5$），分别表示关卡数、参与者人数和日志消息数。\n-   接下来的 $q$ 行包含如上所述的日志消息。消息按时间顺序给出。日志可能不包含所有关卡，因为你可能是在比赛中途收到它的。你只需要处理当前的结果。\n\n保证所有测试用例的 $n$ 之和、$m$ 之和以及 $q$ 之和分别不超过 $5 \\cdot 10^5$。", "outputFormat": "对于每个测试用例，输出 $m$ 行，每行包含两个整数：$id$ 和 $x$，其中 $id$ 是参与者的编号，$x$ 是其总积分，按积分降序排序。如果多名参与者积分相同，则按编号升序列出。", "hint": "翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P15082", "type": "P", "difficulty": 6, "samples": [["3\n2 4 6", "3"], ["6\n2 3 5 6 10 12", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2024", "ICPC"], "title": "[ICPC 2024 Chengdu R] Magical Set", "background": "", "description": "You have a magical set that initially contains $n$ distinct integers. You discover that these numbers can generate energy by dividing into their factors. In each step, you can select any number greater than $1$ from the set, remove it, and insert one of its factors. The factor you insert must not be equal to the original number. Additionally, due to the instability of the magical set, your operation must ensure that the numbers in the set remain distinct.\n\nEach operation generates one unit of energy, and your goal is to maximize the total energy generated by performing as many operations as possible. Given the initial numbers in the set, determine the maximum amount of energy that can be generated, i.e., the maximum number of operations that can be performed.", "inputFormat": "The first line contains an integer $n$ ($1 \\le n \\le 300$), indicating the number of integers in the initial set.\n\nThe second line contains $n$ distinct integers $a_i$ ($1 \\le a_i \\le 10^9$), representing the numbers in the initial set.", "outputFormat": "Output a single integer indicating the maximum amount of energy that can be generated, i.e., the maximum number of operations that can be performed.", "hint": "", "locale": "en", "translations": {"en": {"title": "[ICPC 2024 Chengdu R] Magical Set", "background": "", "description": "You have a magical set that initially contains $n$ distinct integers. You discover that these numbers can generate energy by dividing into their factors. In each step, you can select any number greater than $1$ from the set, remove it, and insert one of its factors. The factor you insert must not be equal to the original number. Additionally, due to the instability of the magical set, your operation must ensure that the numbers in the set remain distinct.\n\nEach operation generates one unit of energy, and your goal is to maximize the total energy generated by performing as many operations as possible. Given the initial numbers in the set, determine the maximum amount of energy that can be generated, i.e., the maximum number of operations that can be performed.", "inputFormat": "The first line contains an integer $n$ ($1 \\le n \\le 300$), indicating the number of integers in the initial set.\n\nThe second line contains $n$ distinct integers $a_i$ ($1 \\le a_i \\le 10^9$), representing the numbers in the initial set.", "outputFormat": "Output a single integer indicating the maximum amount of energy that can be generated, i.e., the maximum number of operations that can be performed.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[ICPC 2024 Chengdu R] Magical Set", "background": "", "description": "你有一个魔法集合，初始包含 $n$ 个互不相同的整数。你发现这些数字可以通过分解为因数来产生能量。每一步中，你可以从集合中任意选择一个大于 $1$ 的数字，将其移除，并插入它的一个因数。你插入的因数不能等于原数字。此外，由于魔法集合的不稳定性，你的操作必须保证集合中的数字始终保持互不相同。\n\n每次操作产生一个单位的能量，你的目标是通过执行尽可能多的操作来最大化总能量。给定集合中的初始数字，确定可以产生的最大能量，即可以执行的最大操作次数。", "inputFormat": "-   第一行包含一个整数 $n$（$1 \\le n \\le 300$），表示初始集合中整数的个数。\n-   第二行包含 $n$ 个互不相同的整数 $a_i$（$1 \\le a_i \\le 10^9$），表示初始集合中的数字。\n", "outputFormat": "输出一个整数，表示可以产生的最大能量，即可以执行的最大操作次数。\n", "hint": "翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P15083", "type": "P", "difficulty": 1, "samples": [["50\n95\n99", "100\n1 2 ... 100"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2024", "Special Judge", "枚举", "构造", "ICPC"], "title": "[ICPC 2024 Chengdu R] Recover Statistics", "background": "", "description": "You recently conducted a survey on how much time university students spend commuting from their dorms to school buildings. You believe that this survey could significantly improve campus planning, making commuting easier for both students and faculty. As part of your analysis, you calculated the P50, P95, and P99 commute times to support your conclusions. Here, P$x$ commute time being $y$ means that $\\textbf{exactly}$ $x\\%$ of the commute times in the entire dataset are less than or equal to $y$. For example, the P50 of the set $\\{1, 1, 4, 5, 1, 4\\}$ can be $1$, $2$ or $3$, since there are $\\textbf{exactly}$ $6 \\times 50\\% = 3$ values less than or equal to $1$, $2$ or $3$. However, there are no valid P95 or P99 for these values because $6 \\times 95\\%$ and $6 \\times 99\\%$ are not integers.\n\nUnfortunately, something went wrong --- you accidentally deleted the entire dataset. The only values you have left are the P50, P95, and P99 of the commute times. Since you do not have time to redo the survey, you need to reconstruct a set of data that matches all of the P50, P95, and P99 values.", "inputFormat": "The input consists of three lines. The first line contains a single integer $a$, representing the P50 value. The second line contains a single integer $b$, representing the P95 value. The third line contains a single integer $c$, representing the P99 value. ($1 \\le a < b < c < 10^9$)", "outputFormat": "Output two lines. The first line should contain a single integer $n$ ($100 \\le n \\le 10^5$), representing the length of the data set.\n\nThe second line should contain $n$ integers $a_1, a_2, \\ldots, a_n$ ($1 \\le a_i \\le 10^9$), representing the reconstructed data set. The integers can be in any order. Any output that meets the requirements will be considered correct.", "hint": "The example output omits the values between $3$ and $99$ (inclusive) for display purposes. In your output, you must include all of these values.\n\nPlease note that the definition of P$x$ values in this problem is different from the $x$-th percentile.", "locale": "en", "translations": {"en": {"title": "[ICPC 2024 Chengdu R] Recover Statistics", "background": "", "description": "You recently conducted a survey on how much time university students spend commuting from their dorms to school buildings. You believe that this survey could significantly improve campus planning, making commuting easier for both students and faculty. As part of your analysis, you calculated the P50, P95, and P99 commute times to support your conclusions. Here, P$x$ commute time being $y$ means that $\\textbf{exactly}$ $x\\%$ of the commute times in the entire dataset are less than or equal to $y$. For example, the P50 of the set $\\{1, 1, 4, 5, 1, 4\\}$ can be $1$, $2$ or $3$, since there are $\\textbf{exactly}$ $6 \\times 50\\% = 3$ values less than or equal to $1$, $2$ or $3$. However, there are no valid P95 or P99 for these values because $6 \\times 95\\%$ and $6 \\times 99\\%$ are not integers.\n\nUnfortunately, something went wrong --- you accidentally deleted the entire dataset. The only values you have left are the P50, P95, and P99 of the commute times. Since you do not have time to redo the survey, you need to reconstruct a set of data that matches all of the P50, P95, and P99 values.", "inputFormat": "The input consists of three lines. The first line contains a single integer $a$, representing the P50 value. The second line contains a single integer $b$, representing the P95 value. The third line contains a single integer $c$, representing the P99 value. ($1 \\le a < b < c < 10^9$)", "outputFormat": "Output two lines. The first line should contain a single integer $n$ ($100 \\le n \\le 10^5$), representing the length of the data set.\n\nThe second line should contain $n$ integers $a_1, a_2, \\ldots, a_n$ ($1 \\le a_i \\le 10^9$), representing the reconstructed data set. The integers can be in any order. Any output that meets the requirements will be considered correct.", "hint": "The example output omits the values between $3$ and $99$ (inclusive) for display purposes. In your output, you must include all of these values.\n\nPlease note that the definition of P$x$ values in this problem is different from the $x$-th percentile.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2024 Chengdu R] Recover Statistics", "background": "", "description": "你最近进行了一项关于大学生从宿舍到教学楼通勤时间的调查。你认为这项调查可以显著改善校园规划，使师生通勤更加便利。作为分析的一部分，你计算了 P50、P95 和 P99 通勤时间以支持你的结论。这里，P$x$ 通勤时间为 $y$ 意味着在整个数据集中，**恰好**有 $x\\%$ 的通勤时间小于或等于 $y$。例如，集合 $\\{1, 1, 4, 5, 1, 4\\}$ 的 P50 可以是 $1$、$2$ 或 $3$，因为**恰好**有 $6 \\times 50\\% = 3$ 个值小于或等于 $1$、$2$ 或 $3$。然而，这些值不存在有效的 P95 或 P99，因为 $6 \\times 95\\%$ 和 $6 \\times 99\\%$ 不是整数。\n\n不幸的是，出了点问题——你不小心删除了整个数据集。你唯一剩下的数据是通勤时间的 P50、P95 和 P99 值。由于你没有时间重新进行这项调查，你需要重建一个与所有 P50、P95 和 P99 值都匹配的数据集。", "inputFormat": "输入包含三行。第一行包含一个整数 $a$，表示 P50 值。第二行包含一个整数 $b$，表示 P95 值。第三行包含一个整数 $c$，表示 P99 值。（$1 \\le a < b < c < 10^9$）\n", "outputFormat": "输出两行。第一行应包含一个整数 $n$（$100 \\le n \\le 10^5$），表示数据集的长度。\n\n第二行应包含 $n$ 个整数 $a_1, a_2, \\ldots, a_n$（$1 \\le a_i \\le 10^9$），表示重建的数据集。整数可以按任意顺序排列。任何满足要求的输出都将被视为正确。", "hint": "示例输出为显示方便省略了 $3$ 到 $99$（含）之间的值。在你的输出中，必须包含所有这些值。\n\n请注意，本题中 P$x$ 值的定义与第 $x$ 百分位数不同。\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P15084", "type": "P", "difficulty": 7, "samples": [["1\n0 0 3 0 -1\n4 1\n1 0\n3 0\n3 2\n1 2\n4 2\n0 0\n1 0\n1 1\n0 1\n3\n0 10\n1 2\n1 1", "0.450000000\n1.125000000\n2.250000000"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2024", "Special Judge", "ICPC"], "title": "[ICPC 2024 Chengdu R] Two Convex Holes", "background": "", "description": "Consider two opaque planes $z = z_1$ and $z = z_2$ ($z_1 < z_2$) in a three-dimensional Cartesian coordinate system. Each plane has a convex polygonal hole, denoted as $P_1$ and $P_2$ respectively, which allows light to pass through.\n\nThere is a point light source $L$ moving in the plane $z = z_0$ ($z_2 < z_0$), in a direction parallel to the $xOy$ plane. The light source starts at the initial position $(x_0, y_0, z_0)$ at time $t = 0$ and moves with a constant velocity $\\boldsymbol{v} = (v_x, v_y, 0)$. Therefore, at any time $t$, the position of the light source is given by $(x_0 + v_x t, y_0 + v_y t, z_0)$.\n\nFor a point $A$ in the plane $z = 0$, define it as $\\textbf{illuminated}$ at time $t$ if and only if the segment $LA$ intersects the interiors (including boundaries) of both polygons $P_1$ and $P_2$. The $\\textbf{illuminated area}$ at time $t$, denoted as $f(t)$, is the area formed by all illuminated points in the plane $z = 0$.\n\nDefine the $\\textbf{average illuminated area}$ over the time period $[t_1, t_2]$, denoted as $\\mathbb{E}[f(t) | t \\sim U(t_1,t_2)]$, as the expected value of $f(t)$ over the interval $[t_1, t_2]$, assuming $t$ is a uniformly distributed random variable over $[t_1, t_2]$.\n\nGiven multiple time periods $[t_1, t_2]$, your task is to find the average illuminated area for each of these periods.", "inputFormat": "The first line contains a single integer $T$ ($1\\le T\\le 10^4$) indicating the number of test cases.\n\nFor each test case, the first line contains five integers $x_0$, $y_0$, $z_0$, $v_x$, $v_y$ ($-10^5 \\le x_0, y_0 \\le 10^5$, $1 \\le z_0 \\le 10^5$, $-10^3 \\le v_x, v_y \\le 10^3$), representing the initial position of the light source $(x_0, y_0, z_0)$ and its velocity vector $\\boldsymbol{v} = (v_x, v_y, 0)$. It is guaranteed that $\\boldsymbol{v} \\neq (0, 0, 0)$.\n\nThe second line contains two integers $n_1$ and $z_1$ ($3 \\le n_1 \\le 10^5$, $1 \\le z_1 \\le 10^5$), indicating the number of vertices of polygon $P_1$ and the value of $z_1$. Each of the following $n_1$ lines contains two integers $x_i$ and $y_i$ ($-10^5 \\le x_i, y_i \\le 10^5$), describing the vertices of $P_1$ in counterclockwise order.\n\nThe following line contains two integers $n_2$ and $z_2$ ($3 \\le n_2 \\le 10^5$, $1 \\le z_2 \\le 10^5$), indicating the number of vertices of polygon $P_2$ and the value of $z_2$. Each of the following $n_2$ lines contains two integers $x_j$ and $y_j$ ($-10^5 \\le x_j, y_j \\le 10^5$), describing the vertices of polygon $P_2$ in counterclockwise order.\n\nIt is guaranteed that no three or more vertices are collinear for $P_1$ and $P_2$.\n\nThe following line contains an integer $q$ ($1 \\le q \\le 10^5$), indicating the number of queries. Each of the following $q$ lines contains two integers $t_1$ and $t_2$ ($0 \\le t_1 \\le t_2 \\le 10^3$), representing a time period.\n\nIt is guaranteed that the sum of $n_1+n_2$ and the sum of $q$ over all test cases do not exceed $10^5$, respectively, and $z_1 < z_2 < z_0$.", "outputFormat": "For each query, output a real number representing the average illuminated area. Your answer will be considered correct only if the relative or absolute error between your answer and the correct answer does not exceed $10^{-4}$.", "hint": "For the example, the projections of convex polygons $P_1$ and $P_2$ onto the $xOy$ plane at $t=0$, and the movement of these projections, are illustrated below. Polygon $A_1B_1C_1D_1$ is the projection of polygon $P_1$, and polygon $A_2B_2C_2D_2$ is the projection of polygon $P_2$.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/97m7npfm.png)\n:::", "locale": "en", "translations": {"en": {"title": "[ICPC 2024 Chengdu R] Two Convex Holes", "background": "", "description": "Consider two opaque planes $z = z_1$ and $z = z_2$ ($z_1 < z_2$) in a three-dimensional Cartesian coordinate system. Each plane has a convex polygonal hole, denoted as $P_1$ and $P_2$ respectively, which allows light to pass through.\n\nThere is a point light source $L$ moving in the plane $z = z_0$ ($z_2 < z_0$), in a direction parallel to the $xOy$ plane. The light source starts at the initial position $(x_0, y_0, z_0)$ at time $t = 0$ and moves with a constant velocity $\\boldsymbol{v} = (v_x, v_y, 0)$. Therefore, at any time $t$, the position of the light source is given by $(x_0 + v_x t, y_0 + v_y t, z_0)$.\n\nFor a point $A$ in the plane $z = 0$, define it as $\\textbf{illuminated}$ at time $t$ if and only if the segment $LA$ intersects the interiors (including boundaries) of both polygons $P_1$ and $P_2$. The $\\textbf{illuminated area}$ at time $t$, denoted as $f(t)$, is the area formed by all illuminated points in the plane $z = 0$.\n\nDefine the $\\textbf{average illuminated area}$ over the time period $[t_1, t_2]$, denoted as $\\mathbb{E}[f(t) | t \\sim U(t_1,t_2)]$, as the expected value of $f(t)$ over the interval $[t_1, t_2]$, assuming $t$ is a uniformly distributed random variable over $[t_1, t_2]$.\n\nGiven multiple time periods $[t_1, t_2]$, your task is to find the average illuminated area for each of these periods.", "inputFormat": "The first line contains a single integer $T$ ($1\\le T\\le 10^4$) indicating the number of test cases.\n\nFor each test case, the first line contains five integers $x_0$, $y_0$, $z_0$, $v_x$, $v_y$ ($-10^5 \\le x_0, y_0 \\le 10^5$, $1 \\le z_0 \\le 10^5$, $-10^3 \\le v_x, v_y \\le 10^3$), representing the initial position of the light source $(x_0, y_0, z_0)$ and its velocity vector $\\boldsymbol{v} = (v_x, v_y, 0)$. It is guaranteed that $\\boldsymbol{v} \\neq (0, 0, 0)$.\n\nThe second line contains two integers $n_1$ and $z_1$ ($3 \\le n_1 \\le 10^5$, $1 \\le z_1 \\le 10^5$), indicating the number of vertices of polygon $P_1$ and the value of $z_1$. Each of the following $n_1$ lines contains two integers $x_i$ and $y_i$ ($-10^5 \\le x_i, y_i \\le 10^5$), describing the vertices of $P_1$ in counterclockwise order.\n\nThe following line contains two integers $n_2$ and $z_2$ ($3 \\le n_2 \\le 10^5$, $1 \\le z_2 \\le 10^5$), indicating the number of vertices of polygon $P_2$ and the value of $z_2$. Each of the following $n_2$ lines contains two integers $x_j$ and $y_j$ ($-10^5 \\le x_j, y_j \\le 10^5$), describing the vertices of polygon $P_2$ in counterclockwise order.\n\nIt is guaranteed that no three or more vertices are collinear for $P_1$ and $P_2$.\n\nThe following line contains an integer $q$ ($1 \\le q \\le 10^5$), indicating the number of queries. Each of the following $q$ lines contains two integers $t_1$ and $t_2$ ($0 \\le t_1 \\le t_2 \\le 10^3$), representing a time period.\n\nIt is guaranteed that the sum of $n_1+n_2$ and the sum of $q$ over all test cases do not exceed $10^5$, respectively, and $z_1 < z_2 < z_0$.", "outputFormat": "For each query, output a real number representing the average illuminated area. Your answer will be considered correct only if the relative or absolute error between your answer and the correct answer does not exceed $10^{-4}$.", "hint": "For the example, the projections of convex polygons $P_1$ and $P_2$ onto the $xOy$ plane at $t=0$, and the movement of these projections, are illustrated below. Polygon $A_1B_1C_1D_1$ is the projection of polygon $P_1$, and polygon $A_2B_2C_2D_2$ is the projection of polygon $P_2$.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/97m7npfm.png)\n:::", "locale": "en"}, "zh-CN": {"title": "[ICPC 2024 Chengdu R] Two Convex Holes", "background": "", "description": "考虑三维笛卡尔坐标系中的两个不透明平面 $z = z_1$ 和 $z = z_2$（$z_1 < z_2$）。每个平面上都有一个凸多边形孔洞，分别记为 $P_1$ 和 $P_2$，允许光线通过。\n\n有一个点光源 $L$ 在平面 $z = z_0$（$z_2 < z_0$）上沿平行于 $xOy$ 平面的方向移动。光源在时刻 $t = 0$ 从初始位置 $(x_0, y_0, z_0)$ 出发，以恒定速度 $\\boldsymbol{v} = (v_x, v_y, 0)$ 运动。因此，在任意时刻 $t$，光源的位置为 $(x_0 + v_x t, y_0 + v_y t, z_0)$。\n\n对于平面 $z = 0$ 上的一个点 $A$，定义它在时刻 $t$ 被**照亮**，当且仅当线段 $LA$ 与两个多边形 $P_1$ 和 $P_2$ 的内部（包括边界）均相交。时刻 $t$ 的**照亮面积**，记为 $f(t)$，是平面 $z = 0$ 上所有被照亮点形成的面积。\n\n定义在时间段 $[t_1, t_2]$ 上的**平均照亮面积**，记为 $\\mathbb{E}[f(t) | t \\sim U(t_1,t_2)]$，为 $f(t)$ 在区间 $[t_1, t_2]$ 上的期望值，其中 $t$ 假设为 $[t_1, t_2]$ 上均匀分布的随机变量。\n\n给定多个时间段 $[t_1, t_2]$，你的任务是找出每个时间段内的平均照亮面积。", "inputFormat": "-   第一行包含一个整数 $T$（$1\\le T\\le 10^4$），表示测试用例的数量。\n-   对于每个测试用例：\n    -   第一行包含五个整数 $x_0$、$y_0$、$z_0$、$v_x$、$v_y$（$-10^5 \\le x_0, y_0 \\le 10^5$，$1 \\le z_0 \\le 10^5$，$-10^3 \\le v_x, v_y \\le 10^3$），分别表示光源的初始位置 $(x_0, y_0, z_0)$ 及其速度向量 $\\boldsymbol{v} = (v_x, v_y, 0)$。保证 $\\boldsymbol{v} \\neq (0, 0, 0)$。\n    -   第二行包含两个整数 $n_1$ 和 $z_1$（$3 \\le n_1 \\le 10^5$，$1 \\le z_1 \\le 10^5$），分别表示多边形 $P_1$ 的顶点数和 $z_1$ 的值。接下来的 $n_1$ 行每行包含两个整数 $x_i$ 和 $y_i$（$-10^5 \\le x_i, y_i \\le 10^5$），按逆时针顺序描述 $P_1$ 的顶点。\n    -   接下来一行包含两个整数 $n_2$ 和 $z_2$（$3 \\le n_2 \\le 10^5$，$1 \\le z_2 \\le 10^5$），分别表示多边形 $P_2$ 的顶点数和 $z_2$ 的值。接下来的 $n_2$ 行每行包含两个整数 $x_j$ 和 $y_j$（$-10^5 \\le x_j, y_j \\le 10^5$），按逆时针顺序描述多边形 $P_2$ 的顶点。\n    -   保证 $P_1$ 和 $P_2$ 均无三点或更多点共线。\n    -   接下来一行包含一个整数 $q$（$1 \\le q \\le 10^5$），表示查询的数量。接下来的 $q$ 行每行包含两个整数 $t_1$ 和 $t_2$（$0 \\le t_1 \\le t_2 \\le 10^3$），表示一个时间段。\n-   保证所有测试用例的 $n_1+n_2$ 之和以及 $q$ 之和分别不超过 $10^5$，且 $z_1 < z_2 < z_0$。", "outputFormat": "对于每个查询，输出一个实数表示平均照亮面积。只有当你的答案与正确答案的相对误差或绝对误差不超过 $10^{-4}$ 时，才被视为正确。", "hint": "对于此示例，凸多边形 $P_1$ 和 $P_2$ 在 $t=0$ 时刻在 $xOy$ 平面上的投影，以及这些投影的运动，如下图所示。多边形 $A_1B_1C_1D_1$ 是多边形 $P_1$ 的投影，多边形 $A_2B_2C_2D_2$ 是多边形 $P_2$ 的投影。\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/97m7npfm.png)\n:::\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P15085", "type": "P", "difficulty": 1, "samples": [["1 5 2 4", "2 5"], ["10 6 9 7", "10 7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "2025", "UOI（乌克兰）"], "title": "[UOI 2025 II Stage] Family", "background": "", "description": "The friends of Vus the Cossack: Fedir and Ksenia --- twins in a large family.\n\nOne day, during a lunch break, Vus asked the twins to tell something about their family. Fedir said that he has $b_1$ brothers and $s_1$ sisters, while Ksenia has $b_2$ brothers and $s_2$ sisters.\n\nVus the Cossack remembered these four numbers, but he forgot who among the twins answered first.\n\nThat is, remembering that four numbers $b_1,s_1,b_2,s_2$ were mentioned, he is not sure whether $b_1,s_1$ is Fedir's answer or Ksenia's. However, he is sure that $b_1$ and $b_2$ denote brothers, while $s_1$ and $s_2$ denote sisters.\n\nVus became curious about how many brothers and sisters there are in their family in total, so with these four numbers, he turned to you for help.", "inputFormat": "The first line contains four integers $b_1$, $s_1$, $b_2$, and $s_2$ ($0 \\leq b_i,s_i\\leq 20$; $|b_1 - b_2| = 1$; $|s_1 - s_2|=1$) --- the responses of the twins.\n\nIt is guaranteed that a solution exists.", "outputFormat": "In a single line, output two integers --- the number of brothers and sisters in the family, respectively.", "hint": "", "locale": "en", "translations": {"en": {"title": "[UOI 2025 II Stage] Family", "background": "", "description": "The friends of Vus the Cossack: Fedir and Ksenia --- twins in a large family.\n\nOne day, during a lunch break, Vus asked the twins to tell something about their family. Fedir said that he has $b_1$ brothers and $s_1$ sisters, while Ksenia has $b_2$ brothers and $s_2$ sisters.\n\nVus the Cossack remembered these four numbers, but he forgot who among the twins answered first.\n\nThat is, remembering that four numbers $b_1,s_1,b_2,s_2$ were mentioned, he is not sure whether $b_1,s_1$ is Fedir's answer or Ksenia's. However, he is sure that $b_1$ and $b_2$ denote brothers, while $s_1$ and $s_2$ denote sisters.\n\nVus became curious about how many brothers and sisters there are in their family in total, so with these four numbers, he turned to you for help.", "inputFormat": "The first line contains four integers $b_1$, $s_1$, $b_2$, and $s_2$ ($0 \\leq b_i,s_i\\leq 20$; $|b_1 - b_2| = 1$; $|s_1 - s_2|=1$) --- the responses of the twins.\n\nIt is guaranteed that a solution exists.", "outputFormat": "In a single line, output two integers --- the number of brothers and sisters in the family, respectively.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[UOI 2025 II Stage] Family", "background": "", "description": "哥萨克人 Vus 的朋友们：Fedir 和 Ksenia ——一个大家庭中的双胞胎。\n\n一天午休时，Vus 请双胞胎说说他们的家庭情况。Fedir 说他有 $b_1$ 个兄弟和 $s_1$ 个姐妹，而 Ksenia 有 $b_2$ 个兄弟和 $s_2$ 个姐妹。\n\n哥萨克人 Vus 记住了这四个数字，但他忘了双胞胎中谁先回答。\n\n也就是说，他记得提到了四个数字 $b_1,s_1,b_2,s_2$，但不确定 $b_1,s_1$ 是 Fedir 的回答还是 Ksenia 的回答。不过，他确定 $b_1$ 和 $b_2$ 表示兄弟的数量，$s_1$ 和 $s_2$ 表示姐妹的数量。\n\nVus 很好奇他们家总共有多少个兄弟和姐妹，于是他带着这四个数字向你求助。\n", "inputFormat": "第一行包含四个整数 $b_1$、$s_1$、$b_2$ 和 $s_2$（$0 \\leq b_i,s_i\\leq 20$；$|b_1 - b_2| = 1$；$|s_1 - s_2|=1$）——双胞胎的回答。\n\n保证存在解决方案。", "outputFormat": "在一行中输出两个整数——分别表示家庭中兄弟和姐妹的数量。\n", "hint": "", "locale": "zh-CN"}}}
{"pid": "P15086", "type": "P", "difficulty": 2, "samples": [["4 8 2", "Yes"], ["5 0 5", "Yes"], ["1 5 8", "No"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2025", "枚举", "UOI（乌克兰）"], "title": "[UOI 2025 II Stage] A+B=C", "background": "", "description": "Us the Cossack laid out matches on the table to form the expression (not necessarily correct) $a+b=c$, where $a,b,c$ are single-digit integers from $0$ to $9$.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/06ofp8gs.png)\n:::\n\nVus the Cossack noticed this expression and wants to move the matches $\\textbf{only}$ in the numbers $a$ and $b$ so that the expression becomes correct. That is, the $\\tt{+}$, $\\tt{=}$ and $c$ cannot be changed.\n\nCan Vus make the expression correct?", "inputFormat": "The first line contains three integers $a$, $b$, and $c$ $(0\\leq a,b,c\\leq 9)$.", "outputFormat": "Print $\\tt{Yes}$, if it is possible to do so, or $\\tt{No}$ otherwise.", "hint": "In the first example:\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/a5ff8epb.png)\n:::\n\nIn the second example, the equality holds immediately.\n\nIn the third example, it is impossible to rearrange the matches.", "locale": "en", "translations": {"en": {"title": "[UOI 2025 II Stage] A+B=C", "background": "", "description": "Us the Cossack laid out matches on the table to form the expression (not necessarily correct) $a+b=c$, where $a,b,c$ are single-digit integers from $0$ to $9$.\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/06ofp8gs.png)\n:::\n\nVus the Cossack noticed this expression and wants to move the matches $\\textbf{only}$ in the numbers $a$ and $b$ so that the expression becomes correct. That is, the $\\tt{+}$, $\\tt{=}$ and $c$ cannot be changed.\n\nCan Vus make the expression correct?", "inputFormat": "The first line contains three integers $a$, $b$, and $c$ $(0\\leq a,b,c\\leq 9)$.", "outputFormat": "Print $\\tt{Yes}$, if it is possible to do so, or $\\tt{No}$ otherwise.", "hint": "In the first example:\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/a5ff8epb.png)\n:::\n\nIn the second example, the equality holds immediately.\n\nIn the third example, it is impossible to rearrange the matches.", "locale": "en"}, "zh-CN": {"title": "[UOI 2025 II Stage] A+B=C", "background": "", "description": "哥萨克人 Us 在桌上用火柴摆出了一个表达式（不一定正确）$a+b=c$，其中 $a,b,c$ 是 $0$ 到 $9$ 之间的个位数整数。\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/06ofp8gs.png)\n:::\n\n哥萨克人 Vus 注意到了这个表达式，他想**仅**通过移动数字 $a$ 和 $b$ 中的火柴，使得表达式变得正确。也就是说，$\\tt{+}$、$\\tt{=}$ 和 $c$ 不能改变。\n\nVus 能否使表达式正确？", "inputFormat": "第一行包含三个整数 $a$、$b$ 和 $c$（$0\\leq a,b,c\\leq 9$）。", "outputFormat": "如果可能做到，输出 `Yes`；否则输出 `No`。\n", "hint": "在第一个示例中：\n\n:::align{center}\n![](https://cdn.luogu.com.cn/upload/image_hosting/a5ff8epb.png)\n:::\n\n在第二个示例中，等式原本就成立。\n\n在第三个示例中，无法通过移动火柴使等式成立。\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
