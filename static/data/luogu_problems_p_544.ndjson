{"pid": "P12042", "type": "P", "difficulty": 4, "samples": [["3 3\n1 2 2\n2 3 2\n3 1 2", "Yes\n0 1 114514"], ["1 1\n1 1 114514", "NO"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["图论", "并查集", "2025", "Special Judge", "构造", "高校校赛"], "title": "[USTCPC 2025] 图上交互题 3 / Constructive Maximum Mex Path", "background": "USTCPC 设置 3s 时限为了使得 python 通过。洛谷改为 1s 时限。\n\n2024 年 12 月 28 日 14:59:50，随着最后一发 E 题的提交出现了 Wrong Answer，小 G 的 EC-Final 比赛结束了。\n\n小 G 的 EC-Final 连续两年都在不同的细节题上倒闭了。克露丝卡尔酱想要帮助她的同学小 G！很可惜细节题是不能批量生产的，但刚好克露丝卡尔酱想到了这样一个细节题，考验大家的细节题能力。希望大家不要在细节题上倒闭！\n\n~~为什么这个系列的题目还在继续呢？~~", "description": "给定一个 $n$ 个点，$m$ 条边的**无向图**。第 $i$ 条边 $(u_i,v_i)$ 有一个**未知边权** $a_i$。\n\n对于任何一条**路径**，定义其**代价**如下：设路径为 $(p_0,p_1,...,p_k)$，其中要求 $(p_{i-1},p_i)$ 是无向图中的边，设其为第 $e_i$ 条边。那么路径的代价即为 $\\mathop{\\text{mex}}\\limits_{i=1}^{k} a_{e_i}$。（该路径可以经过重复点和重复边，即 $p$ 和 $e$ 可以包含重复的数）\n\n$\\text{mex}$ 是一种定义域为一个非负整数的可重集合，函数值为非负整数的映射，定义为集合内最小未在集合内出现过的非负整数。\n\n定义 $f(x,y)$ 为从 $x$ 到 $y$ 的所有路径中代价的**最大值**。\n\n给定 $n,m$，再对于每条边 $(u_i,v_i)$ 给定 $f(u_i,v_i)$，你需要求出是否存在一组合法的 $a_i$，如果有解，你还需要构造一组解。", "inputFormat": "第一行两个正整数 $n,m$ $(1\\le n,m\\le 10^5)$。\n\n第 $2\\sim m+1$ 行每行两个正整数 $u_i,v_i$ $(1\\le u_i,v_i\\le n)$ 和一个非负整数 $f(u_i,v_i)$ $(0\\le f(u_i,v_i)<2^{31})$。\n\n**请注意：本题并不保证图连通；可能会存在重边和自环。**", "outputFormat": "如果不存在解，则仅输出 `No`。\n\n否则，在第一行输出 `Yes`，在第二行输出 $m$ 个非负整数 $a_i$ 表示一组合法的解。\n\n答案可能有很多组，此时输出任意一组解即可。你需要保证 输出的 $0\\le a_i<2^{31}$。\n\n你可以以任意的大小写形式输出 `Yes` 或 `No`。例如，`yEs`，`yes`，`Yes` 和 `YES` 都将被视为肯定的回复。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/chqq6le8.png)\n\n考虑 $f(1,2)$：\n\n+ 考虑路径 $1\\rightarrow 2$，路径的代价为 $\\text{mex}\\{0\\}=1$。\n+ 考虑路径 $1\\rightarrow 2\\rightarrow 3\\rightarrow 1\\rightarrow 2$，路径的代价为 $\\text{mex}\\{0,1,114514,0\\}=2$。\n+ 考虑路径 $1\\rightarrow 3\\rightarrow 2$，路径的代价为 $\\text{mex}\\{1,114514\\}=0$。\n\n此外还存在其他路径，但可以证明不存在代价比 $2$ 更大的路径，故 $f(1,2)=2$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USTCPC 2025] 图上交互题 3 / Constructive Maximum Mex Path", "background": "USTCPC 设置 3s 时限为了使得 python 通过。洛谷改为 1s 时限。\n\n2024 年 12 月 28 日 14:59:50，随着最后一发 E 题的提交出现了 Wrong Answer，小 G 的 EC-Final 比赛结束了。\n\n小 G 的 EC-Final 连续两年都在不同的细节题上倒闭了。克露丝卡尔酱想要帮助她的同学小 G！很可惜细节题是不能批量生产的，但刚好克露丝卡尔酱想到了这样一个细节题，考验大家的细节题能力。希望大家不要在细节题上倒闭！\n\n~~为什么这个系列的题目还在继续呢？~~", "description": "给定一个 $n$ 个点，$m$ 条边的**无向图**。第 $i$ 条边 $(u_i,v_i)$ 有一个**未知边权** $a_i$。\n\n对于任何一条**路径**，定义其**代价**如下：设路径为 $(p_0,p_1,...,p_k)$，其中要求 $(p_{i-1},p_i)$ 是无向图中的边，设其为第 $e_i$ 条边。那么路径的代价即为 $\\mathop{\\text{mex}}\\limits_{i=1}^{k} a_{e_i}$。（该路径可以经过重复点和重复边，即 $p$ 和 $e$ 可以包含重复的数）\n\n$\\text{mex}$ 是一种定义域为一个非负整数的可重集合，函数值为非负整数的映射，定义为集合内最小未在集合内出现过的非负整数。\n\n定义 $f(x,y)$ 为从 $x$ 到 $y$ 的所有路径中代价的**最大值**。\n\n给定 $n,m$，再对于每条边 $(u_i,v_i)$ 给定 $f(u_i,v_i)$，你需要求出是否存在一组合法的 $a_i$，如果有解，你还需要构造一组解。", "inputFormat": "第一行两个正整数 $n,m$ $(1\\le n,m\\le 10^5)$。\n\n第 $2\\sim m+1$ 行每行两个正整数 $u_i,v_i$ $(1\\le u_i,v_i\\le n)$ 和一个非负整数 $f(u_i,v_i)$ $(0\\le f(u_i,v_i)<2^{31})$。\n\n**请注意：本题并不保证图连通；可能会存在重边和自环。**", "outputFormat": "如果不存在解，则仅输出 `No`。\n\n否则，在第一行输出 `Yes`，在第二行输出 $m$ 个非负整数 $a_i$ 表示一组合法的解。\n\n答案可能有很多组，此时输出任意一组解即可。你需要保证 输出的 $0\\le a_i<2^{31}$。\n\n你可以以任意的大小写形式输出 `Yes` 或 `No`。例如，`yEs`，`yes`，`Yes` 和 `YES` 都将被视为肯定的回复。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/chqq6le8.png)\n\n考虑 $f(1,2)$：\n\n+ 考虑路径 $1\\rightarrow 2$，路径的代价为 $\\text{mex}\\{0\\}=1$。\n+ 考虑路径 $1\\rightarrow 2\\rightarrow 3\\rightarrow 1\\rightarrow 2$，路径的代价为 $\\text{mex}\\{0,1,114514,0\\}=2$。\n+ 考虑路径 $1\\rightarrow 3\\rightarrow 2$，路径的代价为 $\\text{mex}\\{1,114514\\}=0$。\n\n此外还存在其他路径，但可以证明不存在代价比 $2$ 更大的路径，故 $f(1,2)=2$。", "locale": "zh-CN"}}}
{"pid": "P12043", "type": "P", "difficulty": 4, "samples": [["3 3\n1 2 0\n2 3 1\n3 1 1", "Yes\n0 1 114514"], ["1 1\n1 1 114514", "NO"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["图论", "2025", "Special Judge", "最短路", "构造", "高校校赛", "Floyd 算法"], "title": "[USTCPC 2025] 图上交互题4 / Constructive Shortest Path", "background": "USTCPC 设置 3s 时限为了使得 python 通过。洛谷改为 1s 时限。\n\n2024 年 12 月 28 日 14:59:50，随着最后一发 E 题的提交出现了 Wrong Answer，小 G 的 EC-Final 比赛结束了。\n\n虽然这道铜牌细节题没有通过，但小 G 还是如愿以偿的获得了银牌。为什么呢？他的队友和他合力砍下了一道金牌题 K，这题非常考验对于最短路算法的理解。\n\n克露丝卡尔酱衷心地希望大家能够对于不同的算法有深刻的理解而非仅仅是背诵，因而出了这道题同样也考验对于最短路算法的理解。\n\n~~小 G 的竞赛生涯还会继续吗？谁知道呢？~~", "description": "给定一个 $n$ 个点，$m$ 条边的**无向图**。第 $i$ 条边 $(u_i,v_i)$ 有一个**未知边权** $a_i$。\n\n对于任何一条**路径**，定义其**代价**如下：设路径为 $(p_0,p_1,...,p_k)$，其中要求 $(p_{i-1},p_i)$ 是无向图中的边，设其为第 $e_i$ 条边。那么路径的代价即为 $\\sum\\limits_{i=1}^{k} a_{e_i}$。（该路径可以经过重复点和重复边，即 $p$ 和 $e$ 可以包含重复的数）\n\n定义 $f(x,y)$ 为从 $x$ 到 $y$ 的所有路径中代价的**最小值**。特别地，当 $x=y$ 时，$f(x,y)=0$。\n\n给定 $n,m$，再对于每条边 $(u_i,v_i)$ 给定 $f(u_i,v_i)$，你需要求出是否存在一组合法的 $a_i$，如果有解，你还需要构造一组解。\n\n注： $f(x,y)$ 就是最短路径的长度，这么写题面只是为了与该系列其它题目风格类似。", "inputFormat": "第一行两个正整数 $n,m$ $(1\\le n\\le 500,1\\le m\\le 10^5)$。请注意本题数据范围 $n$ 的不同。\n\n第 $2\\sim m+1$ 行每行两个正整数 $u_i,v_i$ $(1\\le u_i,v_i\\le n)$ 和一个非负整数 $f(u_i,v_i)$ $(0\\le f(u_i,v_i)<2^{31})$。\n\n**请注意：本题并不保证图连通；可能会存在重边和自环。**", "outputFormat": "如果不存在解，则仅输出 `No`。\n\n否则，在第一行输出 `Yes`，在第二行输出 $m$ 个非负整数 $a_i$ 表示一组合法的解。\n\n答案可能有很多组，此时输出任意一组解即可。你需要保证 输出的 $0\\le a_i<2^{31}$。\n\n你可以以任意的大小写形式输出 `Yes` 或 `No`。例如，`yEs`，`yes`，`Yes` 和 `YES` 都将被视为肯定的回复。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/chqq6le8.png)\n\n考虑 $f(3,1)$：\n\n+ 考虑路径 $3\\rightarrow 1$，路径的代价为 $114514$。\n+ 考虑路径 $3\\rightarrow 1\\rightarrow 2\\rightarrow 3\\rightarrow 1$，路径的代价为 $114514+0+1+114514=114515$。\n+ 考虑路径 $3\\rightarrow 2\\rightarrow 1$，路径的代价为 $1+0=1$。\n\n此外还存在其他路径，但可以证明不存在代价比 $1$ 更小的路径，故 $f(3,1)=1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USTCPC 2025] 图上交互题4 / Constructive Shortest Path", "background": "USTCPC 设置 3s 时限为了使得 python 通过。洛谷改为 1s 时限。\n\n2024 年 12 月 28 日 14:59:50，随着最后一发 E 题的提交出现了 Wrong Answer，小 G 的 EC-Final 比赛结束了。\n\n虽然这道铜牌细节题没有通过，但小 G 还是如愿以偿的获得了银牌。为什么呢？他的队友和他合力砍下了一道金牌题 K，这题非常考验对于最短路算法的理解。\n\n克露丝卡尔酱衷心地希望大家能够对于不同的算法有深刻的理解而非仅仅是背诵，因而出了这道题同样也考验对于最短路算法的理解。\n\n~~小 G 的竞赛生涯还会继续吗？谁知道呢？~~", "description": "给定一个 $n$ 个点，$m$ 条边的**无向图**。第 $i$ 条边 $(u_i,v_i)$ 有一个**未知边权** $a_i$。\n\n对于任何一条**路径**，定义其**代价**如下：设路径为 $(p_0,p_1,...,p_k)$，其中要求 $(p_{i-1},p_i)$ 是无向图中的边，设其为第 $e_i$ 条边。那么路径的代价即为 $\\sum\\limits_{i=1}^{k} a_{e_i}$。（该路径可以经过重复点和重复边，即 $p$ 和 $e$ 可以包含重复的数）\n\n定义 $f(x,y)$ 为从 $x$ 到 $y$ 的所有路径中代价的**最小值**。特别地，当 $x=y$ 时，$f(x,y)=0$。\n\n给定 $n,m$，再对于每条边 $(u_i,v_i)$ 给定 $f(u_i,v_i)$，你需要求出是否存在一组合法的 $a_i$，如果有解，你还需要构造一组解。\n\n注： $f(x,y)$ 就是最短路径的长度，这么写题面只是为了与该系列其它题目风格类似。", "inputFormat": "第一行两个正整数 $n,m$ $(1\\le n\\le 500,1\\le m\\le 10^5)$。请注意本题数据范围 $n$ 的不同。\n\n第 $2\\sim m+1$ 行每行两个正整数 $u_i,v_i$ $(1\\le u_i,v_i\\le n)$ 和一个非负整数 $f(u_i,v_i)$ $(0\\le f(u_i,v_i)<2^{31})$。\n\n**请注意：本题并不保证图连通；可能会存在重边和自环。**", "outputFormat": "如果不存在解，则仅输出 `No`。\n\n否则，在第一行输出 `Yes`，在第二行输出 $m$ 个非负整数 $a_i$ 表示一组合法的解。\n\n答案可能有很多组，此时输出任意一组解即可。你需要保证 输出的 $0\\le a_i<2^{31}$。\n\n你可以以任意的大小写形式输出 `Yes` 或 `No`。例如，`yEs`，`yes`，`Yes` 和 `YES` 都将被视为肯定的回复。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/chqq6le8.png)\n\n考虑 $f(3,1)$：\n\n+ 考虑路径 $3\\rightarrow 1$，路径的代价为 $114514$。\n+ 考虑路径 $3\\rightarrow 1\\rightarrow 2\\rightarrow 3\\rightarrow 1$，路径的代价为 $114514+0+1+114514=114515$。\n+ 考虑路径 $3\\rightarrow 2\\rightarrow 1$，路径的代价为 $1+0=1$。\n\n此外还存在其他路径，但可以证明不存在代价比 $1$ 更小的路径，故 $f(3,1)=1$。", "locale": "zh-CN"}}}
{"pid": "P12044", "type": "P", "difficulty": 6, "samples": [["2\n011\n110", "2\n1 2"], ["4\n110000000\n001100000\n000011000\n000000111", "2\n3 4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2025", "Special Judge", "线性代数", "高斯消元", "线性基", "构造", "高校校赛", "bitset"], "title": "[USTCPC 2025] Algorithm Duel", "background": "考虑到评测机性能差异，改为 1s 时限。USTCPC 时限为 3s。", "description": "Algorithm Duel （在线算法题单挑）是大家非常喜欢的活动之一。而这样的团建活动称为  Algorithm Duel 团建活动（以下简称**团建活动**）。\n\n社团群内共有 $n$ 位群友。克露丝卡尔酱从题库中挑选了 $m=3n-3$ 道题目，**每位群友都有至少其中的一些题没有做过**。①\n\n一场**标准的团建活动**定义如下：对于 $m$ 道题目中的任意一道题目，有偶数位群友没有做过这道题目，这样他们能两两配对举行 Algorithm Duel。\n\n克露丝卡尔酱很遗憾地发现无论从 $n$ 位群友挑选任何非空子集，都不能进行一场**标准的团建活动**。②\n\n但是，她还是非常想举办一场 Algorithm Duel 团建活动，她作为活动负责人只能亲自加入该场活动。为了尽可能保证活动的公正性，她可以任意选择 $n\\sim m-n+1$ 道题目给一位群友送分（即这些题目可以有奇数位位群友没有做过这道题目）。这样的活动称为**非标准的团建活动**。\n\n好了，现在请帮助她决定应该邀请哪些群友参加这场活动能成为一场**非标准的团建活动**吧？应该能有解的，不是吗？", "inputFormat": "第一行一个整数 $n(2\\le n\\le 1000)$。$m=3n-3$。\n\n接下来 $n$ 行长度为 $m$ 的 01 串 $s$。**若 $s_j=1$ 则表示编号为 $i$ 的群友没有做过题目 $j$；$s_j=0$ 则表示编号为 $i$ 的群友做过题目 $j$**。\n\n保证输入的数据满足题面中①②的条件。", "outputFormat": "输出的第一行一个正整数 $k(1\\le k\\le n)$，表示邀请的群友的数目。\n\n输出的第二行 $k$ 个正整数 $x_1,x_2,\\dots,x_k$，表示邀请了编号为 $x_1,x_2,\\dots x_k$ 的群友参加活动。\n\n要求 $1\\le x_i\\le n$ 且 $x_i$ 两两不同。", "hint": "对于样例 $1$，邀请所有群友后，有题目 $1$ 和 $3$ 两道题目只有奇数个群友没有做过。$n=2$ 时，**非标准的团建活动**必须恰好 $2$ 道题目有奇数个群友没有做过，满足条件。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USTCPC 2025] Algorithm Duel", "background": "考虑到评测机性能差异，改为 1s 时限。USTCPC 时限为 3s。", "description": "Algorithm Duel （在线算法题单挑）是大家非常喜欢的活动之一。而这样的团建活动称为  Algorithm Duel 团建活动（以下简称**团建活动**）。\n\n社团群内共有 $n$ 位群友。克露丝卡尔酱从题库中挑选了 $m=3n-3$ 道题目，**每位群友都有至少其中的一些题没有做过**。①\n\n一场**标准的团建活动**定义如下：对于 $m$ 道题目中的任意一道题目，有偶数位群友没有做过这道题目，这样他们能两两配对举行 Algorithm Duel。\n\n克露丝卡尔酱很遗憾地发现无论从 $n$ 位群友挑选任何非空子集，都不能进行一场**标准的团建活动**。②\n\n但是，她还是非常想举办一场 Algorithm Duel 团建活动，她作为活动负责人只能亲自加入该场活动。为了尽可能保证活动的公正性，她可以任意选择 $n\\sim m-n+1$ 道题目给一位群友送分（即这些题目可以有奇数位位群友没有做过这道题目）。这样的活动称为**非标准的团建活动**。\n\n好了，现在请帮助她决定应该邀请哪些群友参加这场活动能成为一场**非标准的团建活动**吧？应该能有解的，不是吗？", "inputFormat": "第一行一个整数 $n(2\\le n\\le 1000)$。$m=3n-3$。\n\n接下来 $n$ 行长度为 $m$ 的 01 串 $s$。**若 $s_j=1$ 则表示编号为 $i$ 的群友没有做过题目 $j$；$s_j=0$ 则表示编号为 $i$ 的群友做过题目 $j$**。\n\n保证输入的数据满足题面中①②的条件。", "outputFormat": "输出的第一行一个正整数 $k(1\\le k\\le n)$，表示邀请的群友的数目。\n\n输出的第二行 $k$ 个正整数 $x_1,x_2,\\dots,x_k$，表示邀请了编号为 $x_1,x_2,\\dots x_k$ 的群友参加活动。\n\n要求 $1\\le x_i\\le n$ 且 $x_i$ 两两不同。", "hint": "对于样例 $1$，邀请所有群友后，有题目 $1$ 和 $3$ 两道题目只有奇数个群友没有做过。$n=2$ 时，**非标准的团建活动**必须恰好 $2$ 道题目有奇数个群友没有做过，满足条件。", "locale": "zh-CN"}}}
{"pid": "P12045", "type": "P", "difficulty": 4, "samples": [["4 10", "21"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "2025", "高校校赛"], "title": "[USTCPC 2025] 一道数学题", "background": "", "description": "克露丝卡尔酱不明白，在算法竞赛中怎么会出现一道数学题呢？  \n~~因为我们是中国数学物理大学~~  \n克露丝卡尔酱不是一个合格的中国数学物理大学的学生，帮帮她吧！  \n\n对所有可能的 $m$ 个和为 $n$ 的**不同**正整数 $a_1,a_2,\\cdots$ $a_m$，求 $a_1a_2+a_2a_3+a_3a_4+\\cdots+a_ma_1$ 的最小值。\n\n答案对 $998244353$ **取模**。", "inputFormat": "一行，两个用空格隔开的整数 $m$ 和 $n$ $(2\\le n,m\\le 1\\times10^{10})$。保证 $n\\ge\\dfrac {m(m+1)}{2}$。", "outputFormat": "输出仅包含 $1$ 行 $1$ 个数字，为上述最小值  $998244353$ **取模**的值。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USTCPC 2025] 一道数学题", "background": "", "description": "克露丝卡尔酱不明白，在算法竞赛中怎么会出现一道数学题呢？  \n~~因为我们是中国数学物理大学~~  \n克露丝卡尔酱不是一个合格的中国数学物理大学的学生，帮帮她吧！  \n\n对所有可能的 $m$ 个和为 $n$ 的**不同**正整数 $a_1,a_2,\\cdots$ $a_m$，求 $a_1a_2+a_2a_3+a_3a_4+\\cdots+a_ma_1$ 的最小值。\n\n答案对 $998244353$ **取模**。", "inputFormat": "一行，两个用空格隔开的整数 $m$ 和 $n$ $(2\\le n,m\\le 1\\times10^{10})$。保证 $n\\ge\\dfrac {m(m+1)}{2}$。", "outputFormat": "输出仅包含 $1$ 行 $1$ 个数字，为上述最小值  $998244353$ **取模**的值。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P12046", "type": "P", "difficulty": 6, "samples": [["4 1", "45"], ["6 2", "50"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "2025", "矩阵加速", "高校校赛"], "title": "[USTCPC 2025] 生成树！", "background": "克露丝卡尔酱喜欢生成树！\n\n克露丝卡尔酱认为对称结构十分完美！\n\n克露丝卡尔酱可爱！", "description": "克露丝卡尔酱想要计数 **$n+1$ 个点的 $k$ 阶轮**的生成树个数。\n\n**$n+1$ 个点的 $k$ 阶轮**的定义为：\n\n- $0$ 为中心，$1\\sim n$ 构成一个环（对于 $1 \\le i <n$，$i$ 和 $i+1$ 之间有连边，$1$ 和 $n$ 之间有连边）。\n- 对于 $1 \\le i \\le \\dfrac{n}{k}$，$0$ 和 $ik$ 之间有额外连边。\n\n**保证 $n \\bmod k = 0$，答案对 $10^9+7$ 取模。**", "inputFormat": "一行两个正整数 $n,k$。$1 \\le k \\le n \\le 10^{18}$，$n \\ge 3$，**保证 $n \\bmod k = 0$**。", "outputFormat": "一行一个正整数，表示答案。**答案对 $10^9+7$ 取模。**", "hint": "两个样例中的轮分别为：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/4fgbshrn.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USTCPC 2025] 生成树！", "background": "克露丝卡尔酱喜欢生成树！\n\n克露丝卡尔酱认为对称结构十分完美！\n\n克露丝卡尔酱可爱！", "description": "克露丝卡尔酱想要计数 **$n+1$ 个点的 $k$ 阶轮**的生成树个数。\n\n**$n+1$ 个点的 $k$ 阶轮**的定义为：\n\n- $0$ 为中心，$1\\sim n$ 构成一个环（对于 $1 \\le i <n$，$i$ 和 $i+1$ 之间有连边，$1$ 和 $n$ 之间有连边）。\n- 对于 $1 \\le i \\le \\dfrac{n}{k}$，$0$ 和 $ik$ 之间有额外连边。\n\n**保证 $n \\bmod k = 0$，答案对 $10^9+7$ 取模。**", "inputFormat": "一行两个正整数 $n,k$。$1 \\le k \\le n \\le 10^{18}$，$n \\ge 3$，**保证 $n \\bmod k = 0$**。", "outputFormat": "一行一个正整数，表示答案。**答案对 $10^9+7$ 取模。**", "hint": "两个样例中的轮分别为：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/4fgbshrn.png)", "locale": "zh-CN"}}}
{"pid": "P12047", "type": "P", "difficulty": 7, "samples": [["1958", "10695"], ["0595588119519515955880115851881598599518850811185891881850801018159809101088511509958819091819010858", "784814030"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500], "memory": [524288, 524288, 524288, 524288, 524288]}, "tags": ["2025", "高校校赛"], "title": "[USTCPC 2025] 翻转数字", "background": "考虑到评测机性能差异，改为 2.5s 时限。USTCPC 时限为 3s。\n\n克露丝卡尔酱喜欢车万！\n\n鬼人正邪（きじん せいじゃ）是东方 Project 系列中的角色，首次登场于《东方辉针城 ～ Double Dealing Character.》（第 14 作）。她是来自妖怪之山的天邪鬼，种族特性为天生喜欢与人作对、颠覆常理的「反逆者」，拥有「颠覆事物性质程度的能力」（如让弹幕反转、规则倒错）。在《辉针城》中，她策划了「下克上异变」，赋予道具自主意识反抗主人，意图颠覆妖怪世界的等级制度。其能力可令弹幕方向/判定反转，战斗中需要玩家逆向操作。\n\n一天，正邪在 USTC 1958 咖啡馆引发了异变。咖啡馆内排列着一串以数字 $1$、$9$、$5$、$8$、$0$ 为形状的装饰气球，原本它们是降序排列的，即 $99\\dots988\\dots855\\dots511\\dots100\\dots0$。但是在异变的影响下，它们的顺序完全被打乱了(即数据随机生成)，并且你只能以翻转相邻两个气球的形式将气球进行重排。由于 $5$、$9$ 的不对称性，显然将气球完全恢复到初始状态是不大可能的。你想要尽量将气球恢复有序，即找到一个可以通过原串操作得到的最大的数字串，并且没有气球是颠倒的(即 $5$、$9$ 在最终状态没有被翻转奇数次)。更进一步地，你想要对原数字串的每个子串都求出这一答案。", "description": "形式化地，定义一个数字串为 $0$、$1$、$5$、$8$、$9$、$5^R$、$9^R$ 组成的字符串(允许含有前导零)。数字串的一次翻转操作为：将相邻两个数字 $XY$ 变为 $Y^RX^R$，$^R$ 表示左右颠倒状态。特别地，$0$、$1$、$8$ 由于对称有 $0=0^R$，$1=1^R$，$8=8^R$，$5$、$9$ 翻转两次得到本身，即 $5=5^{RR}\\neq 5^R$，$9=9^{RR}\\neq 9^R$。不含 $5^R$、$9^R$ 的数字串称为正常数字串。一个正常数字串的权值定义为它通过任意次翻转(中间状态可以不正常)最终得到的最大正常数字串对应的十进制整数。请求出给定正常数字串 $S$ 的所有子串的权值和，答案模 $998244353$。**保证数据随机生成且生成各数字的概率相等。**", "inputFormat": "一行，代表这个串 $S$。$|S|\\leq50000$。", "outputFormat": "一行一个整数，代表答案。", "hint": "对于样例 $1$：\n\n$1$、$9$、$5$、$8$、$19$、$95$、$58$、$958$ 权值为其本身。\n\n$195 \\rightarrow 15^R9^R \\rightarrow 519^R \\rightarrow 591$，权值为 $591$。\n\n$1958 \\rightarrow 1985^R \\rightarrow 189^R5^R \\rightarrow 819^R5^R \\rightarrow 8915^R \\rightarrow  8951$，权值为 $8951$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USTCPC 2025] 翻转数字", "background": "考虑到评测机性能差异，改为 2.5s 时限。USTCPC 时限为 3s。\n\n克露丝卡尔酱喜欢车万！\n\n鬼人正邪（きじん せいじゃ）是东方 Project 系列中的角色，首次登场于《东方辉针城 ～ Double Dealing Character.》（第 14 作）。她是来自妖怪之山的天邪鬼，种族特性为天生喜欢与人作对、颠覆常理的「反逆者」，拥有「颠覆事物性质程度的能力」（如让弹幕反转、规则倒错）。在《辉针城》中，她策划了「下克上异变」，赋予道具自主意识反抗主人，意图颠覆妖怪世界的等级制度。其能力可令弹幕方向/判定反转，战斗中需要玩家逆向操作。\n\n一天，正邪在 USTC 1958 咖啡馆引发了异变。咖啡馆内排列着一串以数字 $1$、$9$、$5$、$8$、$0$ 为形状的装饰气球，原本它们是降序排列的，即 $99\\dots988\\dots855\\dots511\\dots100\\dots0$。但是在异变的影响下，它们的顺序完全被打乱了(即数据随机生成)，并且你只能以翻转相邻两个气球的形式将气球进行重排。由于 $5$、$9$ 的不对称性，显然将气球完全恢复到初始状态是不大可能的。你想要尽量将气球恢复有序，即找到一个可以通过原串操作得到的最大的数字串，并且没有气球是颠倒的(即 $5$、$9$ 在最终状态没有被翻转奇数次)。更进一步地，你想要对原数字串的每个子串都求出这一答案。", "description": "形式化地，定义一个数字串为 $0$、$1$、$5$、$8$、$9$、$5^R$、$9^R$ 组成的字符串(允许含有前导零)。数字串的一次翻转操作为：将相邻两个数字 $XY$ 变为 $Y^RX^R$，$^R$ 表示左右颠倒状态。特别地，$0$、$1$、$8$ 由于对称有 $0=0^R$，$1=1^R$，$8=8^R$，$5$、$9$ 翻转两次得到本身，即 $5=5^{RR}\\neq 5^R$，$9=9^{RR}\\neq 9^R$。不含 $5^R$、$9^R$ 的数字串称为正常数字串。一个正常数字串的权值定义为它通过任意次翻转(中间状态可以不正常)最终得到的最大正常数字串对应的十进制整数。请求出给定正常数字串 $S$ 的所有子串的权值和，答案模 $998244353$。**保证数据随机生成且生成各数字的概率相等。**", "inputFormat": "一行，代表这个串 $S$。$|S|\\leq50000$。", "outputFormat": "一行一个整数，代表答案。", "hint": "对于样例 $1$：\n\n$1$、$9$、$5$、$8$、$19$、$95$、$58$、$958$ 权值为其本身。\n\n$195 \\rightarrow 15^R9^R \\rightarrow 519^R \\rightarrow 591$，权值为 $591$。\n\n$1958 \\rightarrow 1985^R \\rightarrow 189^R5^R \\rightarrow 819^R5^R \\rightarrow 8915^R \\rightarrow  8951$，权值为 $8951$。", "locale": "zh-CN"}}}
{"pid": "P12048", "type": "P", "difficulty": 3, "samples": [["2 4 3 4", "8"], ["3 4 4 4", "24"], ["3 3 4 4", "24"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "2025", "最大公约数 gcd", "高校校赛"], "title": "[USTCPC 2025] 多边形转动", "background": "", "description": "回レ回レ回レ回レ回レ回レ回レ回レ回レ！（旋转吧旋转吧旋转吧旋转吧旋转吧旋转吧旋转吧旋转吧旋转吧！）\n\n克露丝卡尔酱特别喜欢旋转，不光是雪月花，也有好看的圆圈（并不一定绿色），更有正多边形。\n\n现在她操控着一个边长为 $a$ 的正 $m$ 边形，绕着一个边长为 $b$ 的正 $n$ 边形**顺时针转动**。初始状态是前者紧挨着后者的一条边的一端，每次旋转以正多边形公共边上的一点为中心点。她想知道，多少次转动之后，多边形会回到原位置？（只要求多边形回到原位，不要求各条边回到原位，即边是全同的）", "inputFormat": "一行四个正整数 $a,m,b,n$ $(3\\leq m,n\\leq 10^9, 1\\leq a\\leq b \\leq 10^9)$，表示边长为 $a$ 的正 $m$ 边形绕着边长为 $b$ 的正 $n$ 边形转动。", "outputFormat": "一个正整数表示要转几次。", "hint": "样例 1 解释：\n![](https://cdn.luogu.com.cn/upload/image_hosting/362c49xj.png)\n\n样例 3 解释：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7tbjx06k.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[USTCPC 2025] 多边形转动", "background": "", "description": "回レ回レ回レ回レ回レ回レ回レ回レ回レ！（旋转吧旋转吧旋转吧旋转吧旋转吧旋转吧旋转吧旋转吧旋转吧！）\n\n克露丝卡尔酱特别喜欢旋转，不光是雪月花，也有好看的圆圈（并不一定绿色），更有正多边形。\n\n现在她操控着一个边长为 $a$ 的正 $m$ 边形，绕着一个边长为 $b$ 的正 $n$ 边形**顺时针转动**。初始状态是前者紧挨着后者的一条边的一端，每次旋转以正多边形公共边上的一点为中心点。她想知道，多少次转动之后，多边形会回到原位置？（只要求多边形回到原位，不要求各条边回到原位，即边是全同的）", "inputFormat": "一行四个正整数 $a,m,b,n$ $(3\\leq m,n\\leq 10^9, 1\\leq a\\leq b \\leq 10^9)$，表示边长为 $a$ 的正 $m$ 边形绕着边长为 $b$ 的正 $n$ 边形转动。", "outputFormat": "一个正整数表示要转几次。", "hint": "样例 1 解释：\n![](https://cdn.luogu.com.cn/upload/image_hosting/362c49xj.png)\n\n样例 3 解释：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7tbjx06k.png)", "locale": "zh-CN"}}}
{"pid": "P12049", "type": "P", "difficulty": 7, "samples": [["1\na\n1\n2 1 1 1 1", "1"], ["4\naabb\naaaa\naaaa\nbbaa\n3\n2 1 1 4 4\n2 2 2 3 3\n2 1 1 2 4", "3\n1\n2"], ["5\naaaaa\nababa\naabaa\nababa\naaaaa\n9\n2 1 1 5 5\n1 3 3 a\n2 1 1 5 5\n1 2 3 b\n1 4 3 b\n1 3 2 b\n1 3 4 b\n2 1 1 5 5\n2 3 1 3 5", "6\n5\n3\n5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2022", "北京", "Special Judge", "O2优化"], "title": "KMN の培养皿", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/4jaeyd5d.png)  \n**请仔细阅读提示说明部分。**  \nKMN 是生竞大佬。她有一个培养皿，里面有很多个细胞。每个细胞占据一定的单元格。单元格上会有一个字母表示这个单元格被哪个细胞占据。相同的细胞用相同的字母表示。不同且相邻的细胞用不同的字母表示。\n\nKMN 每次会询问你一个矩形框，如果用这个矩形框去切培养皿，切出来的部分（矩形内部）会包含多少个细胞。如果一个细胞被切成了多份，那么算是多个。  \n但是，这些细胞也会发生分裂或吞并，所以你还需要维护修改操作。", "description": "有一个 $n\\times n$ 的有色矩阵\n\n连通块是你熟知的网格图四连通定义：从一个单元格 $A$ 开始，每次走到曼哈顿距离不超过 $1$ 的同色单元格，若能走到另一个单元格 $B$，则这两个单元格 $A,B$ 在同一连通块。\n\n有 $q$ 次操作。\n+ 单点修改操作：修改单元格 $(x,y)$ 的颜色。\n+ 区域查询操作：给出 $(l,r,u,d)$，问如果只保留 $[u,d]$ 行与 $[l,r]$ 列交部分的子矩阵，会有多少个连通块。注意：按照上述定义判定两个单元格是否在同一连通块时，不能走到被查询区域之外。\n\n查询操作互相独立。", "inputFormat": "第一行一个正整数 $n$。  \n接下来 $n$ 行，每行 $n$ 个小写字母，表示有色矩阵。矩阵中颜色不超过 $26$ 种，分别对应 $26$ 个小写字母。  \n\n接下来一行一个正整数 $q$，表示操作个数。  \n接下来 $q$ 行每行先是一个正整数 $op$，表示操作类型。  \n+ 修改操作，$op=1$，同行接下来两个正整数 $x,y$ 和一个字符 $c$，表示修改 $(x,y)$ 字符为 $c$。\n+ 查询操作，$op=2$，同行接下来四个正整数 $u, l, d, r$，含义如上。", "outputFormat": "$q\\div 2$ 行每行一个正整数表示答案。保证 $2$ 类操作恰好占到一半。", "hint": "**本题满分为  $3\\times 10^5$ 分。**  \n对于 $100\\%$ 的数据：  \n$1\\le l,r,u,d\\le n\\le 500$。  \n$1\\le q\\le 5000$。  \n\n\n保证 $1,2$ 操作个数相等。  \n本题 SubTask 只是为了把同规模数据分到一起，不存在捆绑关系。  \n测试点信息  \n|SubTask 编号|$n=$|$q=$|\n|:-:|:-:|:-:|\n|$1$|$50$|$1000$|\n|$2$|$50$|$5000$|\n|$3$|$100$|$1000$|\n|$4$|$100$|$5000$|\n|$5$|$300$|$1000$|\n|$6$|$300$|$3000$|\n|$7$|$300$|$5000$|\n|$8$|$500$|$1000$|\n|$9$|$500$|$3000$|\n|$10$|$500$|$5000$|\n\n对于 $100\\%$ 的数据，保证 KMN 是生竞大神，即使对于 $500\\operatorname{cm}\\times500\\operatorname{cm}$ 的培养皿也能准确无误地观测到每个格子及变化。  \n本题采用 `Special Judge`。当一个测试点有 $x$ 次 II 类操作时对于一次 II 类操作，若您的答案和标准答案一致，那么您获得 $\\frac{10000}{x}$ 的分数。  \n因此，若您的程序无法解决某次查询问题，请输出一行单个整数（需在 int 范围内），以保证后面的询问能正常获得分数。  ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "KMN の培养皿", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/4jaeyd5d.png)  \n**请仔细阅读提示说明部分。**  \nKMN 是生竞大佬。她有一个培养皿，里面有很多个细胞。每个细胞占据一定的单元格。单元格上会有一个字母表示这个单元格被哪个细胞占据。相同的细胞用相同的字母表示。不同且相邻的细胞用不同的字母表示。\n\nKMN 每次会询问你一个矩形框，如果用这个矩形框去切培养皿，切出来的部分（矩形内部）会包含多少个细胞。如果一个细胞被切成了多份，那么算是多个。  \n但是，这些细胞也会发生分裂或吞并，所以你还需要维护修改操作。", "description": "有一个 $n\\times n$ 的有色矩阵\n\n连通块是你熟知的网格图四连通定义：从一个单元格 $A$ 开始，每次走到曼哈顿距离不超过 $1$ 的同色单元格，若能走到另一个单元格 $B$，则这两个单元格 $A,B$ 在同一连通块。\n\n有 $q$ 次操作。\n+ 单点修改操作：修改单元格 $(x,y)$ 的颜色。\n+ 区域查询操作：给出 $(l,r,u,d)$，问如果只保留 $[u,d]$ 行与 $[l,r]$ 列交部分的子矩阵，会有多少个连通块。注意：按照上述定义判定两个单元格是否在同一连通块时，不能走到被查询区域之外。\n\n查询操作互相独立。", "inputFormat": "第一行一个正整数 $n$。  \n接下来 $n$ 行，每行 $n$ 个小写字母，表示有色矩阵。矩阵中颜色不超过 $26$ 种，分别对应 $26$ 个小写字母。  \n\n接下来一行一个正整数 $q$，表示操作个数。  \n接下来 $q$ 行每行先是一个正整数 $op$，表示操作类型。  \n+ 修改操作，$op=1$，同行接下来两个正整数 $x,y$ 和一个字符 $c$，表示修改 $(x,y)$ 字符为 $c$。\n+ 查询操作，$op=2$，同行接下来四个正整数 $u, l, d, r$，含义如上。", "outputFormat": "$q\\div 2$ 行每行一个正整数表示答案。保证 $2$ 类操作恰好占到一半。", "hint": "**本题满分为  $3\\times 10^5$ 分。**  \n对于 $100\\%$ 的数据：  \n$1\\le l,r,u,d\\le n\\le 500$。  \n$1\\le q\\le 5000$。  \n\n\n保证 $1,2$ 操作个数相等。  \n本题 SubTask 只是为了把同规模数据分到一起，不存在捆绑关系。  \n测试点信息  \n|SubTask 编号|$n=$|$q=$|\n|:-:|:-:|:-:|\n|$1$|$50$|$1000$|\n|$2$|$50$|$5000$|\n|$3$|$100$|$1000$|\n|$4$|$100$|$5000$|\n|$5$|$300$|$1000$|\n|$6$|$300$|$3000$|\n|$7$|$300$|$5000$|\n|$8$|$500$|$1000$|\n|$9$|$500$|$3000$|\n|$10$|$500$|$5000$|\n\n对于 $100\\%$ 的数据，保证 KMN 是生竞大神，即使对于 $500\\operatorname{cm}\\times500\\operatorname{cm}$ 的培养皿也能准确无误地观测到每个格子及变化。  \n本题采用 `Special Judge`。当一个测试点有 $x$ 次 II 类操作时对于一次 II 类操作，若您的答案和标准答案一致，那么您获得 $\\frac{10000}{x}$ 的分数。  \n因此，若您的程序无法解决某次查询问题，请输出一行单个整数（需在 int 范围内），以保证后面的询问能正常获得分数。  ", "locale": "zh-CN"}}}
{"pid": "P12050", "type": "P", "difficulty": 7, "samples": [["7\n1 3 99\n2 3 82\n3 4 4\n4 5 43\n5 6 5\n4 7 3", "181 280 287"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": [], "title": "三叶虫树", "background": "此题由 [QOJ 6350](https://qoj.ac/problem/6350) 加强得到。\n\n题目背景和题意无关，可以跳过\n\n斜二进制看上去没什么用。但是不屈的三叶虫很快发现了它的优秀性质。\n\n不屈的三叶虫提出了一种叫三叶虫树的结构：一棵三叶虫树维护一个长度为 $2^n-1$ 的序列，其中 $n\\ge 1$。\n\n三叶虫树的根管辖整个区间，根的左子树是区间的前 $2^{n-1}-1$ 个元素构建的三叶虫树，右子树是区间的接下来 $2^{n-1}-1$ 个元素构建的三叶虫树。注意最后一个元素不属于任何一棵子树，它是特别的——也正因如此，我们可以将一棵三叶虫树的根编号为它最后一个元素的下标。\n\n不难发现，如果假设整个序列从一开始编号并把三叶虫树的每个节点的斜二进制写出，那么根管辖的斜二进制区间将是 $(0,100\\cdots0]$，左子树的管辖区间是 $ (0,10\\cdots0]$，右子树的管辖区间是 $(10\\cdots0,20\\cdots0]$。我们不难证明，一个点 $i$ 为根的子树的管辖区间的左端点 $j=i-{skew\\_lowbit}(i)$，其中 ${skew\\_lowbit}(i)$ 表示 $i$ 在斜二进制下的最低有效位。\n\n考虑将 $n$ 进行斜二进制分解并用一系列三叶虫树来维护序列，可以实现一些简单的操作。", "description": "为了建立伟大的三叶虫帝国，不屈的三叶虫给了你一棵大小为 $n$ 的边带正权的树 $T$，对于每个 $i=1...\\lfloor\\frac n2\\rfloor$ 求完全图 $G$ 的大小为 $i$ 的最大权匹配，其中在 $G$ 中连接 $i$ 和 $j$ 的边权与 $T$ 中 $i$ 到 $j$ 的距离相等。", "inputFormat": "第一行一个正整数 $n$。\n\n接下来 $n-1$ 行，每行三个正整数 $u,v,w$，表示树上一条边。", "outputFormat": "一行 $\\lfloor\\frac n2\\rfloor$ 个整数，表示答案。", "hint": "样例中，对于匹配大小分别为 $1,2,3$ 的情况，最优的方案分别为 $(1,2)$，$(1,5),(2,6)$，$(1,7),(2,5),(3,6)$。请注意这并非唯一的方案。\n\n对于全部的数据，$1\\le n,w\\le 10^6$。\n\n|子任务编号|分值|$n\\le$|特殊限制|\n|:-:|:-:|:-:|:-:|\n|$1$|$5$|$7$|-|\n|$2$|$5$|$80$|$w=1$|\n|$3$|$20$|$10^3$|-|\n|$4$|$20$|$10^4$|-|\n|$5$|$10$|$10^5$|度数为 $1$ 的点至多有 $25$ 个|\n|$6$|$5$|$10^5$|度数为 $1$ 的点至少有 $n-1$ 个|\n|$7$|$15$|$10^5$|-|\n|$8$|$20$|$10^6$|-|", "locale": "zh-CN", "translations": {"zh-CN": {"title": "三叶虫树", "background": "此题由 [QOJ 6350](https://qoj.ac/problem/6350) 加强得到。\n\n题目背景和题意无关，可以跳过\n\n斜二进制看上去没什么用。但是不屈的三叶虫很快发现了它的优秀性质。\n\n不屈的三叶虫提出了一种叫三叶虫树的结构：一棵三叶虫树维护一个长度为 $2^n-1$ 的序列，其中 $n\\ge 1$。\n\n三叶虫树的根管辖整个区间，根的左子树是区间的前 $2^{n-1}-1$ 个元素构建的三叶虫树，右子树是区间的接下来 $2^{n-1}-1$ 个元素构建的三叶虫树。注意最后一个元素不属于任何一棵子树，它是特别的——也正因如此，我们可以将一棵三叶虫树的根编号为它最后一个元素的下标。\n\n不难发现，如果假设整个序列从一开始编号并把三叶虫树的每个节点的斜二进制写出，那么根管辖的斜二进制区间将是 $(0,100\\cdots0]$，左子树的管辖区间是 $ (0,10\\cdots0]$，右子树的管辖区间是 $(10\\cdots0,20\\cdots0]$。我们不难证明，一个点 $i$ 为根的子树的管辖区间的左端点 $j=i-{skew\\_lowbit}(i)$，其中 ${skew\\_lowbit}(i)$ 表示 $i$ 在斜二进制下的最低有效位。\n\n考虑将 $n$ 进行斜二进制分解并用一系列三叶虫树来维护序列，可以实现一些简单的操作。", "description": "为了建立伟大的三叶虫帝国，不屈的三叶虫给了你一棵大小为 $n$ 的边带正权的树 $T$，对于每个 $i=1...\\lfloor\\frac n2\\rfloor$ 求完全图 $G$ 的大小为 $i$ 的最大权匹配，其中在 $G$ 中连接 $i$ 和 $j$ 的边权与 $T$ 中 $i$ 到 $j$ 的距离相等。", "inputFormat": "第一行一个正整数 $n$。\n\n接下来 $n-1$ 行，每行三个正整数 $u,v,w$，表示树上一条边。", "outputFormat": "一行 $\\lfloor\\frac n2\\rfloor$ 个整数，表示答案。", "hint": "样例中，对于匹配大小分别为 $1,2,3$ 的情况，最优的方案分别为 $(1,2)$，$(1,5),(2,6)$，$(1,7),(2,5),(3,6)$。请注意这并非唯一的方案。\n\n对于全部的数据，$1\\le n,w\\le 10^6$。\n\n|子任务编号|分值|$n\\le$|特殊限制|\n|:-:|:-:|:-:|:-:|\n|$1$|$5$|$7$|-|\n|$2$|$5$|$80$|$w=1$|\n|$3$|$20$|$10^3$|-|\n|$4$|$20$|$10^4$|-|\n|$5$|$10$|$10^5$|度数为 $1$ 的点至多有 $25$ 个|\n|$6$|$5$|$10^5$|度数为 $1$ 的点至少有 $n-1$ 个|\n|$7$|$15$|$10^5$|-|\n|$8$|$20$|$10^6$|-|", "locale": "zh-CN"}}}
{"pid": "P12051", "type": "P", "difficulty": 4, "samples": [["2\n2\n3\n", "2 1\n2 1 3\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2025", "Special Judge", "构造", "THUPC"], "title": "[THUPC 2025 决赛] 排列与质数", "background": "", "description": "给定正整数 $n$，构造一个 $1$ 至 $n$ 的排列 $p_1,p_2,\\dots,p_n$ 满足以下条件：\n\n对于 $1 \\le i \\le n$，设 $c_i = \\lceil \\frac{p_1+p_2+\\dots +p_i}{i} \\rceil$，则在 $c_1,c_2,\\dots,c_n$ 中至少有 $\\lfloor \\frac{n}{3} \\rfloor - 1$ 个质数。", "inputFormat": "本题有多组测试数据。输入的第一行一个整数 $t\\ (1 \\le t \\le 10)$ 表示测试数据组数，接下来依次描述每组测试数据。\n\n每组测试数据输入一行一个整数 $n\\ (2 \\le n \\le 10 ^ 5)$。", "outputFormat": "对于每组数据输出满足题设条件的任意一个排列 $p_1,p_2,\\dots,p_n$。保证这样的排列存在。\n\n", "hint": "### 样例 #1 解释\n\n对于第一组测试数据，我们有 $c_1 = \\lceil \\frac{2}{1} \\rceil = 2$ 和 $c_2 = \\lceil \\frac{2+1}{2} \\rceil = 2$。两个都是质数。\n\n对于第二组测试数据，$c_1 = c_2 = c_3 = 2$。\n\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2025 决赛] 排列与质数", "background": "", "description": "给定正整数 $n$，构造一个 $1$ 至 $n$ 的排列 $p_1,p_2,\\dots,p_n$ 满足以下条件：\n\n对于 $1 \\le i \\le n$，设 $c_i = \\lceil \\frac{p_1+p_2+\\dots +p_i}{i} \\rceil$，则在 $c_1,c_2,\\dots,c_n$ 中至少有 $\\lfloor \\frac{n}{3} \\rfloor - 1$ 个质数。", "inputFormat": "本题有多组测试数据。输入的第一行一个整数 $t\\ (1 \\le t \\le 10)$ 表示测试数据组数，接下来依次描述每组测试数据。\n\n每组测试数据输入一行一个整数 $n\\ (2 \\le n \\le 10 ^ 5)$。", "outputFormat": "对于每组数据输出满足题设条件的任意一个排列 $p_1,p_2,\\dots,p_n$。保证这样的排列存在。\n\n", "hint": "### 样例 #1 解释\n\n对于第一组测试数据，我们有 $c_1 = \\lceil \\frac{2}{1} \\rceil = 2$ 和 $c_2 = \\lceil \\frac{2+1}{2} \\rceil = 2$。两个都是质数。\n\n对于第二组测试数据，$c_1 = c_2 = c_3 = 2$。\n\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN"}}}
{"pid": "P12052", "type": "P", "difficulty": 5, "samples": [["3\n2\n1 2\n4\n1 0 1 1\n7\n1 2 3 4 5 6 7\n", "2\n6\n1044\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2025", "THUPC"], "title": "[THUPC 2025 决赛] 图，距离，最优化", "background": "", "description": "给定 $n$ 个非负整数 $x_1,x_2,\\dots,x_n$。\n\n对于任意 $n$ 个节点的无向连通图 $G$，将其节点由 $1$ 至 $n$ 标号，则其分数定义为：\n\n$$\\text{score}(G) = \\sum_{i=1}^n \\sum_{j=i+1}^n \\text{dist}_G(i, j)x_ix_j$$\n\n其中 $\\text{dist}_G(i,j)$ 表示图 $G$ 上 $i$ 到 $j$ 的最短路径长度。\n\n你的任务是输出所有 $n$ 个节点的无向连通图中分数的最大值。", "inputFormat": "本题有多组测试数据。输入的第一行一个整数 $t\\ (1 \\le t \\le 300)$ 表示测试数据组数，接下来依次输入每组测试数据。\n\n每组测试数据的的第一行一个整数 $n\\ (1 \\le n \\le 300)$。\n\n每组测试数据的第二行 $n$ 个整数 $x_1,x_2,\\dots,x_n\\ (0 \\le x_i \\le 2000)$ 描述序列 $x$。\n\n保证所有测试数据的 $n$ 的和不超过 $300$。", "outputFormat": "对于每组测试数据输出一行一个整数，表示所有无向连通图中分数的最大值。", "hint": "### 样例 #1 解释\n\n对于第一组测试数据，只有一种合法方案 $G = \\{(1,2)\\}$。\n\n对于第二组测试数据，一个最优方案为 $G = \\{(1,2),(2,3),(2,4)\\}$。\n\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2025 决赛] 图，距离，最优化", "background": "", "description": "给定 $n$ 个非负整数 $x_1,x_2,\\dots,x_n$。\n\n对于任意 $n$ 个节点的无向连通图 $G$，将其节点由 $1$ 至 $n$ 标号，则其分数定义为：\n\n$$\\text{score}(G) = \\sum_{i=1}^n \\sum_{j=i+1}^n \\text{dist}_G(i, j)x_ix_j$$\n\n其中 $\\text{dist}_G(i,j)$ 表示图 $G$ 上 $i$ 到 $j$ 的最短路径长度。\n\n你的任务是输出所有 $n$ 个节点的无向连通图中分数的最大值。", "inputFormat": "本题有多组测试数据。输入的第一行一个整数 $t\\ (1 \\le t \\le 300)$ 表示测试数据组数，接下来依次输入每组测试数据。\n\n每组测试数据的的第一行一个整数 $n\\ (1 \\le n \\le 300)$。\n\n每组测试数据的第二行 $n$ 个整数 $x_1,x_2,\\dots,x_n\\ (0 \\le x_i \\le 2000)$ 描述序列 $x$。\n\n保证所有测试数据的 $n$ 的和不超过 $300$。", "outputFormat": "对于每组测试数据输出一行一个整数，表示所有无向连通图中分数的最大值。", "hint": "### 样例 #1 解释\n\n对于第一组测试数据，只有一种合法方案 $G = \\{(1,2)\\}$。\n\n对于第二组测试数据，一个最优方案为 $G = \\{(1,2),(2,3),(2,4)\\}$。\n\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN"}}}
{"pid": "P12053", "type": "P", "difficulty": 7, "samples": [["5 3 2\n2 3\n", "4\n"], ["6 4 2\n2 3\n", "10\n"], ["2 2 2\n1 1\n", "0\n"], ["11 5 2\n6 4\n", "198198\n"], ["20 10 5\n13 17 10 6 5\n", "392592366\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["2025", "THUPC"], "title": "[THUPC 2025 决赛] 对脑电波", "background": "", "description": "你和他曾一起尝试过解决一道题目。\n\n一道题目的解决方案可以看作从 $1$ 到 $n$ 编号的 $n$ 个性质。每个性质都可以通过一个特点 $p_i$ 来代表，$p_i$ 越大说明这个性质越智力，$p_i$ 越小表示这个性质越套路。由于每个性质都不完全相同，因此 $p$ 组成了一个长度为 $n$ 的排列。\n\n他是日本题领域大神。他经过思考想出了 $k$ 个性质，这 $k$ 个性质组成的子序列 $S_0$ 恰好是 $p$ 的所有长度为 $k$ 的子序列中字典序最**大**的那个。\n\n你是中国题领域大神。你经过思考也想出了 $k$ 个性质，这 $k$ 个性质组成的子序列 $S_1$ 恰好是 $p$ 的所有长度为 $k$ 的子序列中字典序最**小**的那个。\n\n你们把你们思考出的性质分别罗列。你们在一张纸条上记录下了 $S_0$ 和 $S_1$ 之间的**某一个**最长公共子序列。\n\n这时下课铃响了，你们一起去吃饭了。\n\n后来过去了好久啊，你们也早已分道扬镳。在某一天，你在整理物品的时候又发现了这张纸条。你又想起了这道没能解决的难题。你想知道，当年的那道题目，有多少种可能的解决方案，最终**可能**会导致这张纸条的出现。\n\n答案对 $998244353$ 取模。", "inputFormat": "第一行包括三个正整数 $n,k,m\\ (2\\leq m\\leq k\\leq n\\leq 400)$，分别表示题目性质的总数量、你和他找出的性质的数量和最长公共子序列的长度。\n\n第二行包括 $m$ 个正整数 $S_1,S_2,\\cdots,S_m\\ (1 \\leq S_i \\leq n)$，表示记录在纸条上的最长公共子序列。\n", "outputFormat": "\n输出一行一个整数，表示满足要求的排列数量对 $998244353$ 取模后的结果。\n", "hint": "### 样例 #1 解释\n\n以下为满足要求的 $4$ 种排列：\n\n$1,4,5,2,3$\n\n$4,1,5,2,3$\n\n$4,5,1,2,3$\n\n$4,5,2,1,3$\n\n### 样例 #2 解释\n\n\n以下为满足要求的 $10$ 种排列：\n\n$1,4,5,6,2,3$\n\n$1,4,6,5,2,3$\n\n$1,5,4,6,2,3$\n\n$1,6,4,5,2,3$\n\n$4,6,5,1,2,3$\n\n$4,6,5,2,1,3$\n\n$5,1,4,6,2,3$\n\n$6,1,4,5,2,3$\n\n$6,4,5,1,2,3$\n\n$6,4,5,2,1,3$\n\n\n### 样例 #3 解释\n\n显然无满足要求的排列。\n\n### 提示\n\nBonus: $n \\leq 5000$。\n\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2025 决赛] 对脑电波", "background": "", "description": "你和他曾一起尝试过解决一道题目。\n\n一道题目的解决方案可以看作从 $1$ 到 $n$ 编号的 $n$ 个性质。每个性质都可以通过一个特点 $p_i$ 来代表，$p_i$ 越大说明这个性质越智力，$p_i$ 越小表示这个性质越套路。由于每个性质都不完全相同，因此 $p$ 组成了一个长度为 $n$ 的排列。\n\n他是日本题领域大神。他经过思考想出了 $k$ 个性质，这 $k$ 个性质组成的子序列 $S_0$ 恰好是 $p$ 的所有长度为 $k$ 的子序列中字典序最**大**的那个。\n\n你是中国题领域大神。你经过思考也想出了 $k$ 个性质，这 $k$ 个性质组成的子序列 $S_1$ 恰好是 $p$ 的所有长度为 $k$ 的子序列中字典序最**小**的那个。\n\n你们把你们思考出的性质分别罗列。你们在一张纸条上记录下了 $S_0$ 和 $S_1$ 之间的**某一个**最长公共子序列。\n\n这时下课铃响了，你们一起去吃饭了。\n\n后来过去了好久啊，你们也早已分道扬镳。在某一天，你在整理物品的时候又发现了这张纸条。你又想起了这道没能解决的难题。你想知道，当年的那道题目，有多少种可能的解决方案，最终**可能**会导致这张纸条的出现。\n\n答案对 $998244353$ 取模。", "inputFormat": "第一行包括三个正整数 $n,k,m\\ (2\\leq m\\leq k\\leq n\\leq 400)$，分别表示题目性质的总数量、你和他找出的性质的数量和最长公共子序列的长度。\n\n第二行包括 $m$ 个正整数 $S_1,S_2,\\cdots,S_m\\ (1 \\leq S_i \\leq n)$，表示记录在纸条上的最长公共子序列。\n", "outputFormat": "\n输出一行一个整数，表示满足要求的排列数量对 $998244353$ 取模后的结果。\n", "hint": "### 样例 #1 解释\n\n以下为满足要求的 $4$ 种排列：\n\n$1,4,5,2,3$\n\n$4,1,5,2,3$\n\n$4,5,1,2,3$\n\n$4,5,2,1,3$\n\n### 样例 #2 解释\n\n\n以下为满足要求的 $10$ 种排列：\n\n$1,4,5,6,2,3$\n\n$1,4,6,5,2,3$\n\n$1,5,4,6,2,3$\n\n$1,6,4,5,2,3$\n\n$4,6,5,1,2,3$\n\n$4,6,5,2,1,3$\n\n$5,1,4,6,2,3$\n\n$6,1,4,5,2,3$\n\n$6,4,5,1,2,3$\n\n$6,4,5,2,1,3$\n\n\n### 样例 #3 解释\n\n显然无满足要求的排列。\n\n### 提示\n\nBonus: $n \\leq 5000$。\n\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN"}}}
{"pid": "P12054", "type": "P", "difficulty": 5, "samples": [["10\n1 0\n1 0\n2 1 1\n2 2 2\n1 0\n1 1\n1 2\n1 2\n1 2\n1 1\n", "1 1\n1 4\nout\nin\n4 1\n1 1\n1 2\n2 1\n1 5\n1 7\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2025", "THUPC"], "title": "[THUPC 2025 决赛] 食堂", "background": "……所以为什么会有两道食堂题？", "description": "\n有一个位于第一象限的食堂。\n\n食堂被划分为若干个 $1\\times 1$ 的区域，区域 $(x,y)$ 为以 $(x,y),(x,y+1),(x+1,y),(x+1,y+1)$ 为顶点的正方形。称两个区域 $(x_1,y_1)$ 和 $(x_2,y_2)$ **相邻**当且仅当 $|x_1-x_2|+|y_1-y_2|=1$。\n\n区域有两种类型，一种是可供顾客自由走动的过道，另一种是可供顾客坐下用餐的座位。食堂里的座位非常多，而且排布得很有规律：所有满足 $x\\bmod 3\\ne 0$ 且 $y\\bmod 3\\ne 0$ 的区域 $(x,y)$ 是座位，其他区域都是过道。四个相连的座位构成一张餐桌。\n\n从上空俯瞰，食堂中座位的排布方式如下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/lbsgpuuw.png)\n\n\n在过道上，顾客可以自由移动。具体地，如果顾客当前位于过道 $(x,y)$，他可以走一步，移动到相邻的区域。如果顾客移动到了座位，他就会在此坐下。\n\n顾客对座位的偏好可以用容忍度 $o\\in\\{0,1,2\\}$ 来描述，其中：\n\n- $o=0$ 的顾客只愿意坐到对应**餐桌**没有人的**空座位**上吃饭。\n\n- $o=1$ 的顾客只愿意坐到相邻**座位**没有人的**空座位**上吃饭。\n\n- $o=2$ 的顾客愿意坐在任何**空座位**上吃饭。\n\n当一个顾客坐下之后，他就会专注地吃饭，就算有其他顾客出现，导致当前的座位变成他不愿意坐的座位，他也不会因此离开。\n\n最开始的时候，餐厅里一个顾客也没有。接下来**依次**发生了 $q$ 个事件，每个事件是以下两种之一：\n\n- 第一种事件：具有某个容忍度 $o$ 的顾客从区域 $(0,0)$ 进入餐厅，他会寻找移动步数最少的、他愿意坐的座位坐下，如果这样的座位有多个，顾客会选择 $x$ 坐标最小的，如果还有多个则会选择 $y$ 坐标最小的。\n- 第二种事件：座位 $(x,y)$ 的状态发生了变化，如果原来有顾客坐在这里，这个顾客会立刻离开餐厅；如果原来这个座位上没有顾客，则会出现一个顾客坐在这里。\n\n你需要对于第一种事件求出顾客选择的座位，对于第二种事件求出是有人离开还是有人坐下。\n", "inputFormat": "\n第一行一个正整数 $q\\ (1\\le q\\le5\\times10^5)$。\n\n接下来 $q$ 行，每行先是一个整数 $t\\in\\{1,2\\}$，表示事件种类。\n\n当 $t=1$ 时，接下来读入一个整数 $o\\in\\{0,1,2\\}$，表示来了一位容忍度为 $o$ 的顾客。\n\n当 $t=2$ 时，接下来读入两个正整数 $x,y\\ (1\\le x,y\\le10^4)$，满足 $x\\bmod3\\in\\{1,2\\}$ 与 $y\\bmod3\\in\\{1,2\\}$，表示座位 $(x,y)$ 的状态发生了变化。\n", "outputFormat": "\n对每个操作输出一行。\n\n- 对于 $t=1$ 的操作，依次输出两个整数 $x,y$，表示顾客坐到了座位 $(x,y)$。\n- 对于 $t=2$ 的操作，如果该座位上有人，输出 `out`，否则输出 `in`。\n", "hint": "### 样例 #1 解释\n\n\n以下图片展示了每一步操作影响的位置。数字标识了操作的编号。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6b57o2dl.png)\n\n\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2025 决赛] 食堂", "background": "……所以为什么会有两道食堂题？", "description": "\n有一个位于第一象限的食堂。\n\n食堂被划分为若干个 $1\\times 1$ 的区域，区域 $(x,y)$ 为以 $(x,y),(x,y+1),(x+1,y),(x+1,y+1)$ 为顶点的正方形。称两个区域 $(x_1,y_1)$ 和 $(x_2,y_2)$ **相邻**当且仅当 $|x_1-x_2|+|y_1-y_2|=1$。\n\n区域有两种类型，一种是可供顾客自由走动的过道，另一种是可供顾客坐下用餐的座位。食堂里的座位非常多，而且排布得很有规律：所有满足 $x\\bmod 3\\ne 0$ 且 $y\\bmod 3\\ne 0$ 的区域 $(x,y)$ 是座位，其他区域都是过道。四个相连的座位构成一张餐桌。\n\n从上空俯瞰，食堂中座位的排布方式如下图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/lbsgpuuw.png)\n\n\n在过道上，顾客可以自由移动。具体地，如果顾客当前位于过道 $(x,y)$，他可以走一步，移动到相邻的区域。如果顾客移动到了座位，他就会在此坐下。\n\n顾客对座位的偏好可以用容忍度 $o\\in\\{0,1,2\\}$ 来描述，其中：\n\n- $o=0$ 的顾客只愿意坐到对应**餐桌**没有人的**空座位**上吃饭。\n\n- $o=1$ 的顾客只愿意坐到相邻**座位**没有人的**空座位**上吃饭。\n\n- $o=2$ 的顾客愿意坐在任何**空座位**上吃饭。\n\n当一个顾客坐下之后，他就会专注地吃饭，就算有其他顾客出现，导致当前的座位变成他不愿意坐的座位，他也不会因此离开。\n\n最开始的时候，餐厅里一个顾客也没有。接下来**依次**发生了 $q$ 个事件，每个事件是以下两种之一：\n\n- 第一种事件：具有某个容忍度 $o$ 的顾客从区域 $(0,0)$ 进入餐厅，他会寻找移动步数最少的、他愿意坐的座位坐下，如果这样的座位有多个，顾客会选择 $x$ 坐标最小的，如果还有多个则会选择 $y$ 坐标最小的。\n- 第二种事件：座位 $(x,y)$ 的状态发生了变化，如果原来有顾客坐在这里，这个顾客会立刻离开餐厅；如果原来这个座位上没有顾客，则会出现一个顾客坐在这里。\n\n你需要对于第一种事件求出顾客选择的座位，对于第二种事件求出是有人离开还是有人坐下。\n", "inputFormat": "\n第一行一个正整数 $q\\ (1\\le q\\le5\\times10^5)$。\n\n接下来 $q$ 行，每行先是一个整数 $t\\in\\{1,2\\}$，表示事件种类。\n\n当 $t=1$ 时，接下来读入一个整数 $o\\in\\{0,1,2\\}$，表示来了一位容忍度为 $o$ 的顾客。\n\n当 $t=2$ 时，接下来读入两个正整数 $x,y\\ (1\\le x,y\\le10^4)$，满足 $x\\bmod3\\in\\{1,2\\}$ 与 $y\\bmod3\\in\\{1,2\\}$，表示座位 $(x,y)$ 的状态发生了变化。\n", "outputFormat": "\n对每个操作输出一行。\n\n- 对于 $t=1$ 的操作，依次输出两个整数 $x,y$，表示顾客坐到了座位 $(x,y)$。\n- 对于 $t=2$ 的操作，如果该座位上有人，输出 `out`，否则输出 `in`。\n", "hint": "### 样例 #1 解释\n\n\n以下图片展示了每一步操作影响的位置。数字标识了操作的编号。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6b57o2dl.png)\n\n\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN"}}}
{"pid": "P12055", "type": "P", "difficulty": 7, "samples": [["2\n10101\n", "Yes\n(1?0:1)?0:1\n"], ["2\n00000\n", "No\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2025", "Special Judge", "THUPC"], "title": "[THUPC 2025 决赛] 一个 01 串，n 次三目运算符，最后值为 1", "background": "\n三目运算符表达式 `a?b:c` 的含义是，如果 `a` 为真，那么返回 `b`，否则返回 `c`。\n\n三目运算符是右结合的：`a?b:c?d:e` 和 `a?b:(c?d:e)` 等价。如果你不记得运算顺序，可以总是使用括号。\n\n$0$ 为假，$1$ 为真。", "description": "\n\n给定一个长为 $2n+1$ 的 01 串，你需要使用 $n$ 次三目运算符，即在中间插入恰好 $n$ 个 `?` 和 $n$ 个 `:` 以及若干括号，使得表达式的结果为 $1$，或判断无解。\n", "inputFormat": "\n第一行一个正整数 $n\\ (1\\le n \\le 1.5\\times 10^5)$。\n\n第二行一个长为 $2n+1$ 的 01 串，表示给定的字符串。\n", "outputFormat": "\n如果无解，输出一行 `No`。\n\n如果有解，第一行输出 `Yes`，第二行输出一个值为 $1$ 的表达式。你可以使用括号，但是需要保证你的表达式中数字的顺序和原串相同。你需要保证你输出的表达式长度不超过 $10n+1000$。可以证明如果存在解，则一定存在满足条件的构造方案。\n", "hint": "### 样例 #1 解释\n\n\n你如果输出 `(((1?0:((((1)))))?0:1))` 等表达式也算正确。\n\n### 提示\n\n\n你可以直接使用 g++ 编译你的表达式来检查表达式的值，但是这种方法并不能检测数字的顺序是否一致，也不能检测你使用三目运算符的次数是否恰好为 $n$，即是否每两个相邻的数字之间都有一个 `?` 或 `:`：\n\n```c++\n#include <cassert>\n#define YOUR_EXPRESSION <your_expression>\nint main(){\n    assert(YOUR_EXPRESSION);\n    return 0;\n}\n```\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2025 决赛] 一个 01 串，n 次三目运算符，最后值为 1", "background": "\n三目运算符表达式 `a?b:c` 的含义是，如果 `a` 为真，那么返回 `b`，否则返回 `c`。\n\n三目运算符是右结合的：`a?b:c?d:e` 和 `a?b:(c?d:e)` 等价。如果你不记得运算顺序，可以总是使用括号。\n\n$0$ 为假，$1$ 为真。", "description": "\n\n给定一个长为 $2n+1$ 的 01 串，你需要使用 $n$ 次三目运算符，即在中间插入恰好 $n$ 个 `?` 和 $n$ 个 `:` 以及若干括号，使得表达式的结果为 $1$，或判断无解。\n", "inputFormat": "\n第一行一个正整数 $n\\ (1\\le n \\le 1.5\\times 10^5)$。\n\n第二行一个长为 $2n+1$ 的 01 串，表示给定的字符串。\n", "outputFormat": "\n如果无解，输出一行 `No`。\n\n如果有解，第一行输出 `Yes`，第二行输出一个值为 $1$ 的表达式。你可以使用括号，但是需要保证你的表达式中数字的顺序和原串相同。你需要保证你输出的表达式长度不超过 $10n+1000$。可以证明如果存在解，则一定存在满足条件的构造方案。\n", "hint": "### 样例 #1 解释\n\n\n你如果输出 `(((1?0:((((1)))))?0:1))` 等表达式也算正确。\n\n### 提示\n\n\n你可以直接使用 g++ 编译你的表达式来检查表达式的值，但是这种方法并不能检测数字的顺序是否一致，也不能检测你使用三目运算符的次数是否恰好为 $n$，即是否每两个相邻的数字之间都有一个 `?` 或 `:`：\n\n```c++\n#include <cassert>\n#define YOUR_EXPRESSION <your_expression>\nint main(){\n    assert(YOUR_EXPRESSION);\n    return 0;\n}\n```\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN"}}}
{"pid": "P12056", "type": "P", "difficulty": 5, "samples": [["4\n3 0\n1 1 4\n5 1 4\n4 0\n1 2 3 4\n4 3 2 1\n3 6\n1 1 4\n5 1 4\n4 1\n1 2 3 4\n4 3 2 1\n", "1\n4\n0\n2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2025", "THUPC"], "title": "[THUPC 2025 决赛] 石墨烯", "background": "", "description": "Ecrade_ 看着食堂里来回游走等位的人们陷入了沉思，于是他想到了这样一个问题。\n\n食堂中共有 $n$ 个区域，在食堂即将开门时，第 $i$ 个区域中有 $a_i$ 名正在等位的学生和 $b_i$ 个空位。保证 $\\sum\\limits_{i=1}^{n}a_i\\le \\sum\\limits_{i=1}^{n}b_i$。\n\n食堂开门后的每个时刻，都会**依次**发生如下两个事件：\n\n1. 每个区域中当前正在等位的学生都会尽可能地坐到该区域的空位上。具体而言，假设第 $i$ 个区域中当前有 $x_i$ 名正在等位的学生和 $y_i$ 个空位。\n\n     - 若 $x_i\\le y_i$，那么所有正在等位的学生都会坐到空位上，此时第 $i$ 个区域中没有正在等位的学生，且会剩下 $y_i-x_i$ 个空位；\n     - 若 $x_i>y_i$，那么会有恰好 $y_i$ 名正在等位的学生坐到所有空位上，此时第 $i$ 个区域中剩下 $x_i-y_i$ 名正在等位的学生，且没有剩余的空位。\n2. 每个区域中当前正在等位的所有学生都会**同时**移动到下一个区域中。具体而言，第 $i$ 个区域中所有正在等位的学生都会移动到第 $(i\\bmod n) +1$ 个区域中。\n\n\n在这群学生中，有恰好 $k$ 名学生因为赶时间上课，在食堂开门的瞬间就打包离开了。而 Ecrade_ 并不清楚这 $k$ 名学生都在哪些区域，所以他想知道，在这 $k$ 名学生所有可能的分布情况中，在食堂开门后，最少经过多少个时刻，就能够使得每个区域中都没有正在等位的学生。\n", "inputFormat": "\n第一行一个整数 $T\\ (1\\le T\\le 5\\times 10^5)$，表示测试数据组数。\n\n对于每组测试数据：\n\n- 第一行两个整数 $n,k\\ (1\\le n\\le 5\\times 10^5)$。\n- 第二行 $n$ 个整数 $a_1,a_2,...,a_n\\ (1\\le a_i\\le 10^9)$。\n- 第三行 $n$ 个整数 $b_1,b_2,...,b_n\\ (1\\le b_i\\le 10^9)$。\n\n保证 $0\\le k\\le \\sum\\limits_{i=1}^n a_i\\le \\sum\\limits_{i=1}^{n}b_i$，所有测试数据的 $n$ 的和不超过 $5\\times 10^5$。\n", "outputFormat": "\n对于每组测试数据，输出一行一个整数表示答案。\n", "hint": "### 样例 #1 解释\n\n为方便表述，下直接用数组 $a,b$ 表示每个时刻后每个区域中正在等位的学生数以及剩余空位数。\n\n对于第一组测试数据，没有学生会离开食堂：\n\n- 第一个时刻后，$a=[0,0,0],b=[4,0,0]$。\n\n对于第二组测试数据，没有学生会离开食堂：\n\n- 第一个时刻后，$a=[3,0,0,1],b=[3,1,0,0]$；\n- 第二个时刻后，$a=[1,0,0,0],b=[0,1,0,0]$；\n- 第三个时刻后，$a=[0,1,0,0],b=[0,1,0,0]$；\n- 第四个时刻后，$a=[0,0,0,0],b=[0,0,0,0]$。\n\n对于第三组测试数据，所有学生都会离开食堂。\n\n对于第四组测试数据，仅有一名学生会离开食堂：\n\n- 若这名学生在第 $1$ 个区域，则 $a$ 会变为 $[0,2,3,4]$：\n  - 第一个时刻后，$a=[3,0,0,1],b=[4,1,0,0]$；\n  - 第二个时刻后，$a=[1,0,0,0],b=[1,1,0,0]$；\n  - 第三个时刻后，$a=[0,0,0,0],b=[0,1,0,0]$。\n- 若这名学生在第 $2$ 个区域，则 $a$ 会变为 $[1,1,3,4]$：\n  - 第一个时刻后，$a=[3,0,0,1],b=[3,2,0,0]$；\n  - 第二个时刻后，$a=[1,0,0,0],b=[0,2,0,0]$；\n  - 第三个时刻后，$a=[0,1,0,0],b=[0,2,0,0]$；\n  - 第四个时刻后，$a=[0,0,0,0],b=[0,1,0,0]$。\n- 若这名学生在第 $3$ 个区域，则 $a$ 会变为 $[1,2,2,4]$：\n  - 第一个时刻后，$a=[3,0,0,0],b=[3,1,0,0]$；\n  - 第二个时刻后，$a=[0,0,0,0],b=[0,1,0,0]$。\n- 若这名学生在第 $4$ 个区域，则 $a$ 会变为 $[1,2,3,3]$：\n  - 第一个时刻后，$a=[2,0,0,1],b=[3,1,0,0]$；\n  - 第二个时刻后，$a=[1,0,0,0],b=[1,1,0,0]$；\n  - 第三个时刻后，$a=[0,0,0,0],b=[0,1,0,0]$。\n- 因此，当这名学生在第 $3$ 个区域时，最少经过 $2$ 个时刻，就能够使得每个区域中都没有正在等位的学生。\n\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2025 决赛] 石墨烯", "background": "", "description": "Ecrade_ 看着食堂里来回游走等位的人们陷入了沉思，于是他想到了这样一个问题。\n\n食堂中共有 $n$ 个区域，在食堂即将开门时，第 $i$ 个区域中有 $a_i$ 名正在等位的学生和 $b_i$ 个空位。保证 $\\sum\\limits_{i=1}^{n}a_i\\le \\sum\\limits_{i=1}^{n}b_i$。\n\n食堂开门后的每个时刻，都会**依次**发生如下两个事件：\n\n1. 每个区域中当前正在等位的学生都会尽可能地坐到该区域的空位上。具体而言，假设第 $i$ 个区域中当前有 $x_i$ 名正在等位的学生和 $y_i$ 个空位。\n\n     - 若 $x_i\\le y_i$，那么所有正在等位的学生都会坐到空位上，此时第 $i$ 个区域中没有正在等位的学生，且会剩下 $y_i-x_i$ 个空位；\n     - 若 $x_i>y_i$，那么会有恰好 $y_i$ 名正在等位的学生坐到所有空位上，此时第 $i$ 个区域中剩下 $x_i-y_i$ 名正在等位的学生，且没有剩余的空位。\n2. 每个区域中当前正在等位的所有学生都会**同时**移动到下一个区域中。具体而言，第 $i$ 个区域中所有正在等位的学生都会移动到第 $(i\\bmod n) +1$ 个区域中。\n\n\n在这群学生中，有恰好 $k$ 名学生因为赶时间上课，在食堂开门的瞬间就打包离开了。而 Ecrade_ 并不清楚这 $k$ 名学生都在哪些区域，所以他想知道，在这 $k$ 名学生所有可能的分布情况中，在食堂开门后，最少经过多少个时刻，就能够使得每个区域中都没有正在等位的学生。\n", "inputFormat": "\n第一行一个整数 $T\\ (1\\le T\\le 5\\times 10^5)$，表示测试数据组数。\n\n对于每组测试数据：\n\n- 第一行两个整数 $n,k\\ (1\\le n\\le 5\\times 10^5)$。\n- 第二行 $n$ 个整数 $a_1,a_2,...,a_n\\ (1\\le a_i\\le 10^9)$。\n- 第三行 $n$ 个整数 $b_1,b_2,...,b_n\\ (1\\le b_i\\le 10^9)$。\n\n保证 $0\\le k\\le \\sum\\limits_{i=1}^n a_i\\le \\sum\\limits_{i=1}^{n}b_i$，所有测试数据的 $n$ 的和不超过 $5\\times 10^5$。\n", "outputFormat": "\n对于每组测试数据，输出一行一个整数表示答案。\n", "hint": "### 样例 #1 解释\n\n为方便表述，下直接用数组 $a,b$ 表示每个时刻后每个区域中正在等位的学生数以及剩余空位数。\n\n对于第一组测试数据，没有学生会离开食堂：\n\n- 第一个时刻后，$a=[0,0,0],b=[4,0,0]$。\n\n对于第二组测试数据，没有学生会离开食堂：\n\n- 第一个时刻后，$a=[3,0,0,1],b=[3,1,0,0]$；\n- 第二个时刻后，$a=[1,0,0,0],b=[0,1,0,0]$；\n- 第三个时刻后，$a=[0,1,0,0],b=[0,1,0,0]$；\n- 第四个时刻后，$a=[0,0,0,0],b=[0,0,0,0]$。\n\n对于第三组测试数据，所有学生都会离开食堂。\n\n对于第四组测试数据，仅有一名学生会离开食堂：\n\n- 若这名学生在第 $1$ 个区域，则 $a$ 会变为 $[0,2,3,4]$：\n  - 第一个时刻后，$a=[3,0,0,1],b=[4,1,0,0]$；\n  - 第二个时刻后，$a=[1,0,0,0],b=[1,1,0,0]$；\n  - 第三个时刻后，$a=[0,0,0,0],b=[0,1,0,0]$。\n- 若这名学生在第 $2$ 个区域，则 $a$ 会变为 $[1,1,3,4]$：\n  - 第一个时刻后，$a=[3,0,0,1],b=[3,2,0,0]$；\n  - 第二个时刻后，$a=[1,0,0,0],b=[0,2,0,0]$；\n  - 第三个时刻后，$a=[0,1,0,0],b=[0,2,0,0]$；\n  - 第四个时刻后，$a=[0,0,0,0],b=[0,1,0,0]$。\n- 若这名学生在第 $3$ 个区域，则 $a$ 会变为 $[1,2,2,4]$：\n  - 第一个时刻后，$a=[3,0,0,0],b=[3,1,0,0]$；\n  - 第二个时刻后，$a=[0,0,0,0],b=[0,1,0,0]$。\n- 若这名学生在第 $4$ 个区域，则 $a$ 会变为 $[1,2,3,3]$：\n  - 第一个时刻后，$a=[2,0,0,1],b=[3,1,0,0]$；\n  - 第二个时刻后，$a=[1,0,0,0],b=[1,1,0,0]$；\n  - 第三个时刻后，$a=[0,0,0,0],b=[0,1,0,0]$。\n- 因此，当这名学生在第 $3$ 个区域时，最少经过 $2$ 个时刻，就能够使得每个区域中都没有正在等位的学生。\n\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN"}}}
{"pid": "P12057", "type": "P", "difficulty": 5, "samples": [["3\n900\n090\n009\n", "4\n"], ["3\n999\n999\n999\n", "1\n"], ["10\n0123456789\n1234567890\n2345678901\n", "612360617\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2025", "THUPC"], "title": "[THUPC 2025 决赛] 好串", "background": "", "description": "对于三个长度为 $n$ 的 01 字符串 $s_1,s_2,s_3$，称长度为 $n$ 的 01 字符串 $t$ 是**好的**当且仅当 $\\forall 1 \\le i,j \\le n, \\exists k \\in \\{1,2,3\\}, s_{k,i} = t_i, s_{k,j} = t_j$。设 $f(s_1,s_2,s_3)$ 为这样的好的串的数量。\n\n现在我们有三个长度为 $n$ 的随机 01 字符串 $s_1,s_2,s_3$，其中 $s_i (1 \\le i \\le 3)$ 的第 $j (1 \\le j \\le n)$ 个字符有 $\\frac{p_{i,j}}{9}$ 的概率为 `1`，$\\left(1 - \\frac{p_{i,j}}{9}\\right)$ 的概率为 `0`，其中 $p_{i,j}$ 是一个 $0$ 至 $9$ 的整数。所有的随机事件是独立的。你需要求 $f(s_1,s_2,s_3)$ 的期望，对 $998244353$ 取模。", "inputFormat": "输入第一行一个整数 $n\\ (3 \\le n \\le 3 \\times 10^5)$ 表示字符串长度，接下来一个 $3$ 行 $n$ 列的数字矩阵，其中第 $i$ 行第 $j$ 列的字符表示 $p_{i,j}$。", "outputFormat": "输出一个整数表示答案对 $998244353$ 取模的值。\n\n", "hint": "### 样例 #1 解释\n\n在该组样例中，$s_1, s_2, s_3$ 分别为 `100`, `010`, `001`，四种方案分别为 `100`、`010`、`001`、`000`。\n\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2025 决赛] 好串", "background": "", "description": "对于三个长度为 $n$ 的 01 字符串 $s_1,s_2,s_3$，称长度为 $n$ 的 01 字符串 $t$ 是**好的**当且仅当 $\\forall 1 \\le i,j \\le n, \\exists k \\in \\{1,2,3\\}, s_{k,i} = t_i, s_{k,j} = t_j$。设 $f(s_1,s_2,s_3)$ 为这样的好的串的数量。\n\n现在我们有三个长度为 $n$ 的随机 01 字符串 $s_1,s_2,s_3$，其中 $s_i (1 \\le i \\le 3)$ 的第 $j (1 \\le j \\le n)$ 个字符有 $\\frac{p_{i,j}}{9}$ 的概率为 `1`，$\\left(1 - \\frac{p_{i,j}}{9}\\right)$ 的概率为 `0`，其中 $p_{i,j}$ 是一个 $0$ 至 $9$ 的整数。所有的随机事件是独立的。你需要求 $f(s_1,s_2,s_3)$ 的期望，对 $998244353$ 取模。", "inputFormat": "输入第一行一个整数 $n\\ (3 \\le n \\le 3 \\times 10^5)$ 表示字符串长度，接下来一个 $3$ 行 $n$ 列的数字矩阵，其中第 $i$ 行第 $j$ 列的字符表示 $p_{i,j}$。", "outputFormat": "输出一个整数表示答案对 $998244353$ 取模的值。\n\n", "hint": "### 样例 #1 解释\n\n在该组样例中，$s_1, s_2, s_3$ 分别为 `100`, `010`, `001`，四种方案分别为 `100`、`010`、`001`、`000`。\n\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN"}}}
{"pid": "P12058", "type": "P", "difficulty": 6, "samples": [["3\n4 2\n6 1\n9 5\n", "Yes\n#..#\n.##.\n.##.\n#..#\nNo\nYes\n.#.#..##.\n#.#.##..#\n#.##..##.\n.#..##.##\n#..##.#.#\n.##..#.#.\n##.##.#.#\n#.##.##..\n.##.##.##\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2025", "Special Judge", "THUPC"], "title": "[THUPC 2025 决赛] 三元链", "background": "", "description": "\n给定正整数 $n,k$，请在一个 $n\\times n$ 的网格中将 $kn$ 个方格染成黑色，其余方格染成白色，满足：\n\n- 在水平或竖直方向上不存在连续的三个同色格。具体地：\n\n  1. 不存在 $1\\le i\\le n,1\\le j \\le n-2$ 满足坐标为 $(i,j),(i,j+1),(i,j+2)$ 的格子均为黑色或均为白色。\n  2. 不存在 $1\\le i\\le n-2,1\\le j \\le n$ 满足坐标为 $(i,j),(i+1,j),(i+2,j)$ 的格子均为黑色或均为白色。\n  \n- 每列中有恰好 $k$ 个黑色格。\n\n- 对于任意 $i=1,2,\\dots,k$，任意相邻的两列中从上至下第 $i$ 个黑色格的行坐标之差不超过 $1$。具体地，记第 $j$ 列的黑色格的坐标分别为 $(x_{1,j},j),(x_{2,j},j),\\dots,(x_{k,j},j)$，其中 $x_{1,j}<x_{2,j}<\\dots<x_{k,j}$，那么对于 $1\\le i\\le k,1\\le j< m$ 有 $|x_{i,j}-x_{i,j+1}|\\le 1$。\n\n给出一种合法的方案，或判定无解。\n", "inputFormat": "\n第一行包含一个正整数 $T$ $(1\\le T\\le 500)$，表示数据组数。\n\n每组数据包含一行两个正整数 $n,k$ $(4\\le n \\le 1000,1\\le k \\le n)$，分别表示网格的大小与每列中黑色格的数量。\n\n保证单个测试点中所有数据 $n^2$ 的和不超过 $10^6$。 \n", "outputFormat": "\n对于每组测试数据：\n\n- 若不存在合法的染色方案，则仅输出一行一个字符串 `No`；\n- 否则，先输出一行一个字符串 `Yes`，然后接下来 $n$ 行每行输出一个长度为 $n$，仅包含字符 `#` 与 `.` 的字符串，代表你染色方案中从上到下每一行的染色情况，其中字符 `#` 代表对应格染为黑色，字符 `.` 代表对应格染为白色。如果有多种合法的染色方案，输出任意一种即可。\n", "hint": "### 样例 #1 解释\n\n\n对于第一组数据，以下为若干不符合条件的示例：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7tghzsoe.png)\n\n示例 $1$ 中左下角有连续的三个白色格，示例 $2$ 中第一列与第四列黑色格数量不正确，示例 $3$ 中左上角有连续的三个黑色格，示例 $4$ 中第三、四列的第二个黑色格行坐标之差大于 $1$。\n\n对于第二组数据，容易发现不存在合法的染色方案。\n\n对于第三组数据，下图中不同方位的黑色格用不同颜色标注后易见答案的合法性：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/v4bhosde.png)\n\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2025 决赛] 三元链", "background": "", "description": "\n给定正整数 $n,k$，请在一个 $n\\times n$ 的网格中将 $kn$ 个方格染成黑色，其余方格染成白色，满足：\n\n- 在水平或竖直方向上不存在连续的三个同色格。具体地：\n\n  1. 不存在 $1\\le i\\le n,1\\le j \\le n-2$ 满足坐标为 $(i,j),(i,j+1),(i,j+2)$ 的格子均为黑色或均为白色。\n  2. 不存在 $1\\le i\\le n-2,1\\le j \\le n$ 满足坐标为 $(i,j),(i+1,j),(i+2,j)$ 的格子均为黑色或均为白色。\n  \n- 每列中有恰好 $k$ 个黑色格。\n\n- 对于任意 $i=1,2,\\dots,k$，任意相邻的两列中从上至下第 $i$ 个黑色格的行坐标之差不超过 $1$。具体地，记第 $j$ 列的黑色格的坐标分别为 $(x_{1,j},j),(x_{2,j},j),\\dots,(x_{k,j},j)$，其中 $x_{1,j}<x_{2,j}<\\dots<x_{k,j}$，那么对于 $1\\le i\\le k,1\\le j< m$ 有 $|x_{i,j}-x_{i,j+1}|\\le 1$。\n\n给出一种合法的方案，或判定无解。\n", "inputFormat": "\n第一行包含一个正整数 $T$ $(1\\le T\\le 500)$，表示数据组数。\n\n每组数据包含一行两个正整数 $n,k$ $(4\\le n \\le 1000,1\\le k \\le n)$，分别表示网格的大小与每列中黑色格的数量。\n\n保证单个测试点中所有数据 $n^2$ 的和不超过 $10^6$。 \n", "outputFormat": "\n对于每组测试数据：\n\n- 若不存在合法的染色方案，则仅输出一行一个字符串 `No`；\n- 否则，先输出一行一个字符串 `Yes`，然后接下来 $n$ 行每行输出一个长度为 $n$，仅包含字符 `#` 与 `.` 的字符串，代表你染色方案中从上到下每一行的染色情况，其中字符 `#` 代表对应格染为黑色，字符 `.` 代表对应格染为白色。如果有多种合法的染色方案，输出任意一种即可。\n", "hint": "### 样例 #1 解释\n\n\n对于第一组数据，以下为若干不符合条件的示例：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7tghzsoe.png)\n\n示例 $1$ 中左下角有连续的三个白色格，示例 $2$ 中第一列与第四列黑色格数量不正确，示例 $3$ 中左上角有连续的三个黑色格，示例 $4$ 中第三、四列的第二个黑色格行坐标之差大于 $1$。\n\n对于第二组数据，容易发现不存在合法的染色方案。\n\n对于第三组数据，下图中不同方位的黑色格用不同颜色标注后易见答案的合法性：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/v4bhosde.png)\n\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN"}}}
{"pid": "P12059", "type": "P", "difficulty": 7, "samples": [["4\n1 2\n2 3\n2 4\n", "1 3 3 1\n"], ["7\n4 2\n6 1\n5 1\n7 6\n2 3\n1 2\n", "1 6 23 48 43 17 1\n"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [786432, 786432, 786432, 786432, 786432, 786432, 786432, 786432, 786432, 786432, 786432, 786432, 786432]}, "tags": ["2025", "THUPC"], "title": "[THUPC 2025 决赛] I'm Here", "background": "", "description": "\n黑猫的世界正在走向终结。 \n\n在这个正在走向终结的世界里，Liki 和 Sasami 需要找到世界的真相。具体来说，这个世界可以看做一棵 $n$ 个结点的有根树，根结点的编号为 $1$。并且存在一种对树进行深度优先搜索的方案，使第 $i$ 次访问的结点为 $i$。也就是说 **$1\\sim n$ 可以构成这棵树的一个 dfs 序**。在最开始，所有的结点都没有崩溃。\n\n每一天，Liki 和 Sasami 会探索一个没有崩坏的结点 $u$。在这次探索后，为了引导他们发现世界真相，黑猫会使 $u$ 及子树中所有点崩坏。 \n\n同时，在第 $i$ 天 Liki 和 Sasami 的探索结束后，由于自身力量枯竭，第 $n-i+1$ 号结点若没有崩坏，则会崩坏。 \n\n分别对 $i \\in [1,n]$ 求 Liki 和 Sasami 有多少种恰好探索 $i$ 天的探索方案，满足最后一次探索的是 $1$ 号结点，对 $998244353$ 取模。\n", "inputFormat": "\n第一行一个数，$n\\ (1\\le n\\le80)$，代表树的结点数 。 \n\n接下来 $n-1$ 行每行两个数 $u,v\\ (1\\le u,v\\le n)$，代表结点 $u$ 和结点 $v$ 之间有一条边。\n", "outputFormat": "\n输出 $n$ 个数，第 $i$ 个数代表探索 $i$ 天的方案数，对 $998244353$ 取模。\n", "hint": "### 样例 #1 解释\n\n\n对于样例 $1$，以下 $8$ 种探索序列合法：\n\n$\\{1\\},\\{2,1\\},\\{3,1\\},\\{4,1\\},\\{3,2,1\\},\\{4,2,1\\},\\{4,3,1\\},\\{4,3,2,1\\}$。\n\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2025 决赛] I'm Here", "background": "", "description": "\n黑猫的世界正在走向终结。 \n\n在这个正在走向终结的世界里，Liki 和 Sasami 需要找到世界的真相。具体来说，这个世界可以看做一棵 $n$ 个结点的有根树，根结点的编号为 $1$。并且存在一种对树进行深度优先搜索的方案，使第 $i$ 次访问的结点为 $i$。也就是说 **$1\\sim n$ 可以构成这棵树的一个 dfs 序**。在最开始，所有的结点都没有崩溃。\n\n每一天，Liki 和 Sasami 会探索一个没有崩坏的结点 $u$。在这次探索后，为了引导他们发现世界真相，黑猫会使 $u$ 及子树中所有点崩坏。 \n\n同时，在第 $i$ 天 Liki 和 Sasami 的探索结束后，由于自身力量枯竭，第 $n-i+1$ 号结点若没有崩坏，则会崩坏。 \n\n分别对 $i \\in [1,n]$ 求 Liki 和 Sasami 有多少种恰好探索 $i$ 天的探索方案，满足最后一次探索的是 $1$ 号结点，对 $998244353$ 取模。\n", "inputFormat": "\n第一行一个数，$n\\ (1\\le n\\le80)$，代表树的结点数 。 \n\n接下来 $n-1$ 行每行两个数 $u,v\\ (1\\le u,v\\le n)$，代表结点 $u$ 和结点 $v$ 之间有一条边。\n", "outputFormat": "\n输出 $n$ 个数，第 $i$ 个数代表探索 $i$ 天的方案数，对 $998244353$ 取模。\n", "hint": "### 样例 #1 解释\n\n\n对于样例 $1$，以下 $8$ 种探索序列合法：\n\n$\\{1\\},\\{2,1\\},\\{3,1\\},\\{4,1\\},\\{3,2,1\\},\\{4,2,1\\},\\{4,3,1\\},\\{4,3,2,1\\}$。\n\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN"}}}
{"pid": "P12060", "type": "P", "difficulty": 5, "samples": [["1 3 2\n110\n010\n101\n", "100\n101\n"], ["2 4 4\n1100\n1010\n1000\n0001\n0110\n0011\n", "1000\n1101\n0000\n1111\n"], ["3 9 7\n011001111\n101110001\n110010100\n010110110\n101010100\n000101101\n001011100\n100011111\n100111000\n001000101\n", "111101101\n110110001\n110111001\n111100010\n111111010\n111110111\n111111011\n"], ["9 24 9\n100001011101000000000000\n100011001100100001000000\n010101000010100111110100\n101110000010101110110010\n100110110010011100000000\n111111000010100101111011\n000010110001001011010101\n010101100111000010100111\n111001111111000000000000\n111000110110110000000000\n011100101000100001000000\n101001101000111011001100\n100011100011110001000000\n100001001011000000000000\n101110110001111100000000\n100011100101100010110000\n101001001100101011000000\n100101100110100111000000\n", "111111111100001001010011\n111111101111001101010101\n111111101100001011000101\n111111101101110101111011\n111111111111000010111011\n111111111111110101011010\n111111101110101001001101\n111111101101111110011010\n111111111110100001000000\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2025", "THUPC"], "title": "[THUPC 2025 决赛] Now or Never", "background": "", "description": "\n对于一个长度为 $l$ 的 01 串 $w=w_1w_2\\dots w_l$，定义其**支撑序列** $\\mathrm{supp}(w)$ 为 $[1, 2, \\dots, l]$ 的一个子序列，其中 $i\\in \\mathrm{supp}(w)$ 当且仅当 $w_i = 1$。例如，$\\mathrm{supp}(001100110) = [3, 4, 7, 8]$。特别地，全零串的支撑序列为空序列 $\\varepsilon$。\n\n给定一个 01 串集合 $S$，其中包含 $n$ 个长度为 $m$ 的 01 串 $s_1, s_2, \\dots, s_n$。再给定 $q$ 组询问，第 $i$ 组询问给出一个长度为 $m$ 的 01 串 $t_i$。你需要输出一个长度为 $m$ 的 01 串 $u_i$ 满足以下条件：\n\n1. 存在一个 $S$ 的子集 $T$，其中 $T$ 可以为空也可以为 $S$ 本身，满足 $u_i = t_i \\oplus \\bigoplus_{v \\in T} v$，其中 $\\oplus$ 表示按位异或操作，即 $u_i$ 为 $t_i$ 与 $T$ 中所有 01 串的异或和；\n2. 在以上条件的基础之上，$u_i$ 的支撑序列的字典序尽可能小。\n\n对于两个序列 $A, B$，称 $A$ 的字典序小于 $B$，当且仅当 $A$ 是 $B$ 的一个真前缀，或者 $A$ 和 $B$ 在第一个相异的位置 $p$ 上满足 $A_p < B_p$。", "inputFormat": "\n输入的第一行三个正整数 $n, m, q\\ (1\\le n, m, q\\le 2000)$，分别表示集合 $S$ 的大小、01 串的长度以及询问组数。\n\n接下来 $n$ 行，第 $i$ 行一个长度为 $m$ 的 01 串 $s_i$。\n\n最后 $q$ 行，第 $i$ 行一个长度为 $m$ 的 01 串 $t_i$ 描述一组询问。\n", "outputFormat": "\n对于第 $i$ 组询问输出一行表示满足题设条件的长度为 $m$ 的 01 串 $u_i$。\n", "hint": "### 样例 #1 解释\n\n\n对于第一组测试数据，满足第一个条件的串有 `010` 和 `100`。二者支撑序列分别为 $\\mathrm{supp}(010) = [2]$，$\\mathrm{supp}(100) = [1]$，其中字典序更小的是 $[1]$。\n\n对于第二组测试数据，满足第一个条件的串有 `101` 和 `011`。二者支撑序列分别为 $\\mathrm{supp}(101) = [1, 3]$，$\\mathrm{supp}(011) = [2, 3]$，其中字典序更小的是 $[1, 3]$。\n\n### 样例 #2 解释\n\n\n对于第一组测试数据，满足第一个条件的串有 `1000`、`0100`、`0010` 和 `1110`，其中字典序最小的支撑序列是 $\\mathrm{supp}(1000) = [1]$。\n\n对于第二组测试数据，满足第一个条件的串有 `0001`、`1101`、`1011` 和 `0111`，其中字典序最小的支撑序列是 $\\mathrm{supp}(1101) = [1, 2, 4]$。\n\n对于第三组测试数据，满足第一个条件的串有 `0110`、`1010`、`1100` 和 `0000`，其中字典序最小的支撑序列是 $\\mathrm{supp}(0000) = \\varepsilon$，也即空序列。\n\n对于第四组测试数据，满足第一个条件的串有`0011`、`1111`、`1001` 和 `0101`，其中字典序最小的支撑序列是 $\\mathrm{supp}(1111) = [1, 2, 3, 4]$。\n\n### 提示\n\n题目名称是什么意思？\n\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2025 决赛] Now or Never", "background": "", "description": "\n对于一个长度为 $l$ 的 01 串 $w=w_1w_2\\dots w_l$，定义其**支撑序列** $\\mathrm{supp}(w)$ 为 $[1, 2, \\dots, l]$ 的一个子序列，其中 $i\\in \\mathrm{supp}(w)$ 当且仅当 $w_i = 1$。例如，$\\mathrm{supp}(001100110) = [3, 4, 7, 8]$。特别地，全零串的支撑序列为空序列 $\\varepsilon$。\n\n给定一个 01 串集合 $S$，其中包含 $n$ 个长度为 $m$ 的 01 串 $s_1, s_2, \\dots, s_n$。再给定 $q$ 组询问，第 $i$ 组询问给出一个长度为 $m$ 的 01 串 $t_i$。你需要输出一个长度为 $m$ 的 01 串 $u_i$ 满足以下条件：\n\n1. 存在一个 $S$ 的子集 $T$，其中 $T$ 可以为空也可以为 $S$ 本身，满足 $u_i = t_i \\oplus \\bigoplus_{v \\in T} v$，其中 $\\oplus$ 表示按位异或操作，即 $u_i$ 为 $t_i$ 与 $T$ 中所有 01 串的异或和；\n2. 在以上条件的基础之上，$u_i$ 的支撑序列的字典序尽可能小。\n\n对于两个序列 $A, B$，称 $A$ 的字典序小于 $B$，当且仅当 $A$ 是 $B$ 的一个真前缀，或者 $A$ 和 $B$ 在第一个相异的位置 $p$ 上满足 $A_p < B_p$。", "inputFormat": "\n输入的第一行三个正整数 $n, m, q\\ (1\\le n, m, q\\le 2000)$，分别表示集合 $S$ 的大小、01 串的长度以及询问组数。\n\n接下来 $n$ 行，第 $i$ 行一个长度为 $m$ 的 01 串 $s_i$。\n\n最后 $q$ 行，第 $i$ 行一个长度为 $m$ 的 01 串 $t_i$ 描述一组询问。\n", "outputFormat": "\n对于第 $i$ 组询问输出一行表示满足题设条件的长度为 $m$ 的 01 串 $u_i$。\n", "hint": "### 样例 #1 解释\n\n\n对于第一组测试数据，满足第一个条件的串有 `010` 和 `100`。二者支撑序列分别为 $\\mathrm{supp}(010) = [2]$，$\\mathrm{supp}(100) = [1]$，其中字典序更小的是 $[1]$。\n\n对于第二组测试数据，满足第一个条件的串有 `101` 和 `011`。二者支撑序列分别为 $\\mathrm{supp}(101) = [1, 3]$，$\\mathrm{supp}(011) = [2, 3]$，其中字典序更小的是 $[1, 3]$。\n\n### 样例 #2 解释\n\n\n对于第一组测试数据，满足第一个条件的串有 `1000`、`0100`、`0010` 和 `1110`，其中字典序最小的支撑序列是 $\\mathrm{supp}(1000) = [1]$。\n\n对于第二组测试数据，满足第一个条件的串有 `0001`、`1101`、`1011` 和 `0111`，其中字典序最小的支撑序列是 $\\mathrm{supp}(1101) = [1, 2, 4]$。\n\n对于第三组测试数据，满足第一个条件的串有 `0110`、`1010`、`1100` 和 `0000`，其中字典序最小的支撑序列是 $\\mathrm{supp}(0000) = \\varepsilon$，也即空序列。\n\n对于第四组测试数据，满足第一个条件的串有`0011`、`1111`、`1001` 和 `0101`，其中字典序最小的支撑序列是 $\\mathrm{supp}(1111) = [1, 2, 3, 4]$。\n\n### 提示\n\n题目名称是什么意思？\n\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN"}}}
{"pid": "P12061", "type": "P", "difficulty": 6, "samples": [["3 1 4\n", "800000006 800000006 400000003\n"], ["3 2 0\n", "500000004 1 500000004\n"], ["25 2 5\n", "142857144 166666668 615646263 639455787 234126986 257936510 195918369 502040820 478316330 81264173 190523433 471438023 23809524 0 0 0 0 0 0 0 0 0 0 0 0\n"], ["4 102 9\n", "568832210 85779764 969938175 375449967\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2025", "THUPC"], "title": "[THUPC 2025 决赛] 喜爱之钥", "background": "", "description": "\n玩具箱承载着幼时的欢乐。喜爱、软弱、苦恼、希望……当沉睡的玩具箱再次被打开时，重见天日的宝物将会带来怎样的惊喜？\n\nM 就有一个这样的玩具箱，那是身为宝石设计师的母亲送给她的生日礼物。精心打磨的宝石像夜空中的繁星一般点缀着玩具箱，而玩具箱上更有造型各异的 $L$ 把锁严防死守着宝贝女儿的小宇宙：花朵发夹、羽毛笔、字母 M 造型的气球……每一件都浓缩着 M 的回忆。\n\n前几天，M 在整理房间时翻出了这个玩具箱，以及一串专门为这个玩具箱打造的钥匙。钥匙串上共挂着 $(L+K)$ 把钥匙，其中有 $L$ 把钥匙，每把分别可以打开其中一把锁；而剩下的 $K$ 把钥匙仅仅是增加暴力破解难度的干扰项。为了方便记忆，M 的母亲在设计钥匙时，给每一把钥匙镶嵌了一颗不同的宝石，可惜 M 已经忘记了正确的对应关系。\n\n“……所以我只好向大家求助了。” M 说着把手里的钥匙串摆在了桌面上。\n\nK 拿起了钥匙串仔细端详。“仅凭外表似乎无法推断出任何有用的信息，恐怕只能逐把尝试。”\n\n虽然大家都愿意帮助 M，但是面对这么多把钥匙，不免感到无从下手。看着大家的反应，T 提议：“要不我们来玩个游戏吧。每个人按顺序试一把钥匙，最终打开最多锁的人最厉害。”\n\n包括 M 在内，总共有 $N$ 个人按相同的顺序轮流尝试解锁玩具箱，直到 $L$ 把锁都被打开。每人每次操作时只选择一把钥匙，且只用这把钥匙试着打开其中一把锁。为了尽快打开玩具箱，所有人的策略都是尝试能最大化这次选择的钥匙打开这次选择的锁的概率的组合；如果有多种概率最大的钥匙和锁的组合，则等概率地选取任意一种这样的组合。显然，如果之前成功用一把钥匙打开了一把锁，那么之后所有人在尝试的时候，都不会再选择相同的钥匙或者相同的锁。\n\n假设在最开始的时候，任意一把钥匙打开任意一把锁的概率都相等。如果每个人都能根据之前尝试的所有钥匙和锁的组合，选择最优的组合进行尝试，那么每个人成功解锁的期望次数分别是多少？", "inputFormat": "\n输入仅一行，包括三个非负整数 $N\\ (1\\le N\\le 50), L\\ (1\\le L\\le 5000), K\\ (0\\le K\\le 50)$，分别表示参加游戏的人数，锁的数量和假钥匙的数量。\n", "outputFormat": "\n输出一行 $N$ 个非负整数 $E_1, \\cdots, E_N$，其中 $E_i$ 表示按顺序第 $i$ 个人成功解锁的期望次数。显然 $E_i$ 是有理数；不妨假设其化为最简分式后的形式为 $p_i/q_i$（即其中 $p_i, q_i$ 互质），则 $E_i$ 为满足 $q_i E_i\\equiv p_i \\pmod{10^9+7}$ 和 $0\\le E_i < 10^9+7$ 的整数解。可以证明，在本题数据范围下，各 $E_i$ 存在且唯一。\n", "hint": "### 样例 #1 解释\n\n\n当只有 $1$ 把锁时，每个人的策略都是随机选择一把尚未有人试过的钥匙开锁。由于总共有 $1+4=5$ 把钥匙，每个人打开门的概率分别为 $2/5, 2/5, 1/5$，这也是每个人成功解锁的期望次数。\n\n### 样例 #2 解释\n\n\n此时有 $2$ 把锁和 $2$ 把钥匙，每把钥匙恰好可以打开其中一把锁。由于没有任何已知信息，第 $1$ 个人只能随机选择一把钥匙和一把锁，此时成功解锁的概率为 $1/2$。\n\n- 如果第 $1$ 个人打开了这把锁，那么第 $2$ 个人可以直接用另外一把钥匙打开另外一把锁。\n\n- 如果第 $1$ 个人没有打开这把锁，那么第 $1$ 个人选择的钥匙一定对应另一把锁，且另一把钥匙一定可以打开第 $1$ 个人选择的锁。根据这个信息，第 $2$ 个人和第 $3$ 个人可以各打开一把锁。\n\n综上所述，每个人成功解锁的期望次数分别为\n\n$$\n\\begin{split}\nE_1 &= \\frac{1}{2}\\times 1 + \\frac{1}{2}\\times 0 = \\frac{1}{2} \\equiv 500,000,004 \\pmod {10^9+7},\\\\\nE_2 &= \\frac{1}{2}\\times 1 + \\frac{1}{2} \\times 1 = 1,\\\\\nE_3 &= \\frac{1}{2}\\times 0 + \\frac{1}{2} \\times 1 = \\frac{1}{2} \\equiv 500,000,004\\pmod {10^9+7}.\n\\end{split}\n$$\n\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2025 决赛] 喜爱之钥", "background": "", "description": "\n玩具箱承载着幼时的欢乐。喜爱、软弱、苦恼、希望……当沉睡的玩具箱再次被打开时，重见天日的宝物将会带来怎样的惊喜？\n\nM 就有一个这样的玩具箱，那是身为宝石设计师的母亲送给她的生日礼物。精心打磨的宝石像夜空中的繁星一般点缀着玩具箱，而玩具箱上更有造型各异的 $L$ 把锁严防死守着宝贝女儿的小宇宙：花朵发夹、羽毛笔、字母 M 造型的气球……每一件都浓缩着 M 的回忆。\n\n前几天，M 在整理房间时翻出了这个玩具箱，以及一串专门为这个玩具箱打造的钥匙。钥匙串上共挂着 $(L+K)$ 把钥匙，其中有 $L$ 把钥匙，每把分别可以打开其中一把锁；而剩下的 $K$ 把钥匙仅仅是增加暴力破解难度的干扰项。为了方便记忆，M 的母亲在设计钥匙时，给每一把钥匙镶嵌了一颗不同的宝石，可惜 M 已经忘记了正确的对应关系。\n\n“……所以我只好向大家求助了。” M 说着把手里的钥匙串摆在了桌面上。\n\nK 拿起了钥匙串仔细端详。“仅凭外表似乎无法推断出任何有用的信息，恐怕只能逐把尝试。”\n\n虽然大家都愿意帮助 M，但是面对这么多把钥匙，不免感到无从下手。看着大家的反应，T 提议：“要不我们来玩个游戏吧。每个人按顺序试一把钥匙，最终打开最多锁的人最厉害。”\n\n包括 M 在内，总共有 $N$ 个人按相同的顺序轮流尝试解锁玩具箱，直到 $L$ 把锁都被打开。每人每次操作时只选择一把钥匙，且只用这把钥匙试着打开其中一把锁。为了尽快打开玩具箱，所有人的策略都是尝试能最大化这次选择的钥匙打开这次选择的锁的概率的组合；如果有多种概率最大的钥匙和锁的组合，则等概率地选取任意一种这样的组合。显然，如果之前成功用一把钥匙打开了一把锁，那么之后所有人在尝试的时候，都不会再选择相同的钥匙或者相同的锁。\n\n假设在最开始的时候，任意一把钥匙打开任意一把锁的概率都相等。如果每个人都能根据之前尝试的所有钥匙和锁的组合，选择最优的组合进行尝试，那么每个人成功解锁的期望次数分别是多少？", "inputFormat": "\n输入仅一行，包括三个非负整数 $N\\ (1\\le N\\le 50), L\\ (1\\le L\\le 5000), K\\ (0\\le K\\le 50)$，分别表示参加游戏的人数，锁的数量和假钥匙的数量。\n", "outputFormat": "\n输出一行 $N$ 个非负整数 $E_1, \\cdots, E_N$，其中 $E_i$ 表示按顺序第 $i$ 个人成功解锁的期望次数。显然 $E_i$ 是有理数；不妨假设其化为最简分式后的形式为 $p_i/q_i$（即其中 $p_i, q_i$ 互质），则 $E_i$ 为满足 $q_i E_i\\equiv p_i \\pmod{10^9+7}$ 和 $0\\le E_i < 10^9+7$ 的整数解。可以证明，在本题数据范围下，各 $E_i$ 存在且唯一。\n", "hint": "### 样例 #1 解释\n\n\n当只有 $1$ 把锁时，每个人的策略都是随机选择一把尚未有人试过的钥匙开锁。由于总共有 $1+4=5$ 把钥匙，每个人打开门的概率分别为 $2/5, 2/5, 1/5$，这也是每个人成功解锁的期望次数。\n\n### 样例 #2 解释\n\n\n此时有 $2$ 把锁和 $2$ 把钥匙，每把钥匙恰好可以打开其中一把锁。由于没有任何已知信息，第 $1$ 个人只能随机选择一把钥匙和一把锁，此时成功解锁的概率为 $1/2$。\n\n- 如果第 $1$ 个人打开了这把锁，那么第 $2$ 个人可以直接用另外一把钥匙打开另外一把锁。\n\n- 如果第 $1$ 个人没有打开这把锁，那么第 $1$ 个人选择的钥匙一定对应另一把锁，且另一把钥匙一定可以打开第 $1$ 个人选择的锁。根据这个信息，第 $2$ 个人和第 $3$ 个人可以各打开一把锁。\n\n综上所述，每个人成功解锁的期望次数分别为\n\n$$\n\\begin{split}\nE_1 &= \\frac{1}{2}\\times 1 + \\frac{1}{2}\\times 0 = \\frac{1}{2} \\equiv 500,000,004 \\pmod {10^9+7},\\\\\nE_2 &= \\frac{1}{2}\\times 1 + \\frac{1}{2} \\times 1 = 1,\\\\\nE_3 &= \\frac{1}{2}\\times 0 + \\frac{1}{2} \\times 1 = \\frac{1}{2} \\equiv 500,000,004\\pmod {10^9+7}.\n\\end{split}\n$$\n\n\n### 来源与致谢\n\n来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。\n\n数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。", "locale": "zh-CN"}}}
