{"pid": "P7830", "type": "P", "difficulty": 6, "samples": [["5 6\n1 2\n3 3 1 4\n1 2\n2 5 2\n1 4\n1\n2\n3\n4\n5\n6", "2\n1\n2\n4\n2\n3"]], "limits": {"time": [8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2021", "CCO（加拿大）", "深度优先搜索 DFS", "可持久化线段树"], "title": "[CCO 2021] Through Another Maze Darkly", "background": "**警告：滥用本题评测将被封号！**", "description": "黑暗迷宫是一个树形结构，有 $n$ 个房间和 $n - 1$ 个走廊，房间编号 $1, 2, \\cdots, n$。\n\n黑暗迷宫里面漆黑一片，你看不见自己在哪里。为了辨别方向，每个房间有一个激光指示器，初始指向连接这个房间的某一个走廊。你重复执行如下策略行动：\n\n- 将当前房间的激光指示器按顺时针方向旋转到下一个走廊\n- 沿着激光指示器指向的走廊走到另一个房间\n\n你打算从编号为 $1$ 的房间开始，将这个策略重复执行 $k$ 次，想知道自己会到达哪个房间。你觉得这个问题太简单了，于是进行了 $q$ 次询问。每次询问是相互独立的，即激光指示器每次都会回到初始状态。", "inputFormat": "第一行，两个整数 $n, q$；\n\n接下来 $n$ 行，第 $i$ 行描述第 $i$ 个房间。首先，一个整数 $k$ 表示房间 $i$ 连接的走廊数量，接下来 $k$ 个整数 $c_1, c_2, \\cdots, c_k$，表示按顺时针顺序每个走廊另一头的房间编号。第 $i$ 个房间的激光指示器初始指向通往房间 $c_1$ 的走廊。\n\n接下来 $q$ 行，每行一个正整数 $k$。", "outputFormat": "对于每组询问，输出一行，表示所求的值。", "hint": "#### 样例 #1 解释\n初始激光指示器的指向如图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2k48xyl0.png)\n#### 数据范围\n对于 $\\frac{7}{45}$ 的数据，第 $i$ 个房间连接第 $i - 1$ 和第 $i + 1$ 个房间（如果这两个房间存在）；\n\n对于另 $\\frac{14}{45}$ 的数据，$2 \\leq n \\leq 2 \\times 10^3$，$1 \\leq q \\leq 2 \\times 10^3$；\n\n对于另 $\\frac{4}{15}$ 的数据，$q = 1$；\n\n对于 $100\\%$ 的数据，$2 \\leq n \\leq 8 \\times 10^5$，$1 \\leq q \\leq 8 \\times 10^5$，$1 \\leq k \\leq 10^{15}$，保证数据给出的是**一棵树**。\n#### 题目来源\n[CCO2021](https://cemc.math.uwaterloo.ca/contests/computing/2021/index.html) D1T3", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCO 2021] Through Another Maze Darkly", "background": "**警告：滥用本题评测将被封号！**", "description": "黑暗迷宫是一个树形结构，有 $n$ 个房间和 $n - 1$ 个走廊，房间编号 $1, 2, \\cdots, n$。\n\n黑暗迷宫里面漆黑一片，你看不见自己在哪里。为了辨别方向，每个房间有一个激光指示器，初始指向连接这个房间的某一个走廊。你重复执行如下策略行动：\n\n- 将当前房间的激光指示器按顺时针方向旋转到下一个走廊\n- 沿着激光指示器指向的走廊走到另一个房间\n\n你打算从编号为 $1$ 的房间开始，将这个策略重复执行 $k$ 次，想知道自己会到达哪个房间。你觉得这个问题太简单了，于是进行了 $q$ 次询问。每次询问是相互独立的，即激光指示器每次都会回到初始状态。", "inputFormat": "第一行，两个整数 $n, q$；\n\n接下来 $n$ 行，第 $i$ 行描述第 $i$ 个房间。首先，一个整数 $k$ 表示房间 $i$ 连接的走廊数量，接下来 $k$ 个整数 $c_1, c_2, \\cdots, c_k$，表示按顺时针顺序每个走廊另一头的房间编号。第 $i$ 个房间的激光指示器初始指向通往房间 $c_1$ 的走廊。\n\n接下来 $q$ 行，每行一个正整数 $k$。", "outputFormat": "对于每组询问，输出一行，表示所求的值。", "hint": "#### 样例 #1 解释\n初始激光指示器的指向如图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/2k48xyl0.png)\n#### 数据范围\n对于 $\\frac{7}{45}$ 的数据，第 $i$ 个房间连接第 $i - 1$ 和第 $i + 1$ 个房间（如果这两个房间存在）；\n\n对于另 $\\frac{14}{45}$ 的数据，$2 \\leq n \\leq 2 \\times 10^3$，$1 \\leq q \\leq 2 \\times 10^3$；\n\n对于另 $\\frac{4}{15}$ 的数据，$q = 1$；\n\n对于 $100\\%$ 的数据，$2 \\leq n \\leq 8 \\times 10^5$，$1 \\leq q \\leq 8 \\times 10^5$，$1 \\leq k \\leq 10^{15}$，保证数据给出的是**一棵树**。\n#### 题目来源\n[CCO2021](https://cemc.math.uwaterloo.ca/contests/computing/2021/index.html) D1T3", "locale": "zh-CN"}}}
{"pid": "P7831", "type": "P", "difficulty": 6, "samples": [["5 5\n3 1 4 0\n2 1 3 0\n1 3 1 1\n3 2 3 1\n4 2 0 2", "2 3 3 1 -1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "图论", "贪心", "2021", "CCO（加拿大）", "拓扑排序"], "title": "[CCO 2021] Travelling Merchant", "background": "", "description": "一个国家有 $n$ 个城市和 $m$ 条单向道路，一个旅行商在这些城市之间旅行。\n\n第 $i$ 条道路从城市 $a_i$ 到城市 $b_i$，只有当他的资产不少于 $r_i$ 元才可以走这条道路，走过这条道路之后他的资产会增加 $p_i$ 元。\n\n他希望自己可以永远不停的游走下去，于是他想知道从任意一个城市出发至少需要多少元初始资产。", "inputFormat": "第一行，两个整数 $n, m$；\n\n接下来 $m$ 行，第 $i$ 行有四个整数 $a_i, b_i, r_i, p_i$。", "outputFormat": "一行，$n$ 个整数，若第 $i$ 个城市无解，第 $i$ 个整数为 $-1$；否则，为至少需要的初始资产（单位为元）。", "hint": "#### 样例 #1 解释\n以第 $2$ 座城市为例：从第 $2$ 座城市出发，初始资产 $3$ 元，则可以在第 $2, 1, 3$ 三座城市无限绕圈。\n#### 数据范围\n对于 $\\frac{2}{7}$ 的数据，$2 \\leq n, m \\leq 2 \\times 10^3$；\n\n对于另 $\\frac{15}{49}$ 的数据，$p_i = 0$；\n\n对于 $100\\%$ 的数据，$2 \\leq n, m \\leq 2 \\times 10^5$，$1 \\leq a_i, b_i \\leq n$，$a_i \\neq b_i$，$0 \\leq r_i, p_i \\leq 10^9$，**保证没有自环但可能有重边**。\n#### 题目来源\n[CCO2021](https://cemc.math.uwaterloo.ca/contests/computing/2021/index.html) D2T1", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCO 2021] Travelling Merchant", "background": "", "description": "一个国家有 $n$ 个城市和 $m$ 条单向道路，一个旅行商在这些城市之间旅行。\n\n第 $i$ 条道路从城市 $a_i$ 到城市 $b_i$，只有当他的资产不少于 $r_i$ 元才可以走这条道路，走过这条道路之后他的资产会增加 $p_i$ 元。\n\n他希望自己可以永远不停的游走下去，于是他想知道从任意一个城市出发至少需要多少元初始资产。", "inputFormat": "第一行，两个整数 $n, m$；\n\n接下来 $m$ 行，第 $i$ 行有四个整数 $a_i, b_i, r_i, p_i$。", "outputFormat": "一行，$n$ 个整数，若第 $i$ 个城市无解，第 $i$ 个整数为 $-1$；否则，为至少需要的初始资产（单位为元）。", "hint": "#### 样例 #1 解释\n以第 $2$ 座城市为例：从第 $2$ 座城市出发，初始资产 $3$ 元，则可以在第 $2, 1, 3$ 三座城市无限绕圈。\n#### 数据范围\n对于 $\\frac{2}{7}$ 的数据，$2 \\leq n, m \\leq 2 \\times 10^3$；\n\n对于另 $\\frac{15}{49}$ 的数据，$p_i = 0$；\n\n对于 $100\\%$ 的数据，$2 \\leq n, m \\leq 2 \\times 10^5$，$1 \\leq a_i, b_i \\leq n$，$a_i \\neq b_i$，$0 \\leq r_i, p_i \\leq 10^9$，**保证没有自环但可能有重边**。\n#### 题目来源\n[CCO2021](https://cemc.math.uwaterloo.ca/contests/computing/2021/index.html) D2T1", "locale": "zh-CN"}}}
{"pid": "P7832", "type": "P", "difficulty": 6, "samples": [["2 0", "1"], ["6 3\n1 3\n2 6\n4 5", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "线段树", "2021", "CCO（加拿大）", "广度优先搜索 BFS"], "title": "[CCO 2021] Bread First Search", "background": "", "description": "这个国家有 $n$ 个城市和 $m$ 条双向道路。\n\n有一个人要游览这个国家，但他很讲究。他要求游览线路必须是一个 BFS（Bread First Search，面包优先搜索）序，必须访问每个城市各一次，且满足以下条件：\n\n- 首个城市可以任选；\n- 除了首个城市外，每个城市被访问前至少有一个相邻城市已经被访问过；\n- 每个城市与首个城市的距离单调不降。其中两个城市的距离定义为它们路径边数的最小值。\n\n这个人还有强迫症，一定要按照编号 $1 \\sim n$ 的顺序将每个城市访问一次。为了使这条游览线路符合上述所有要求，政府需要新修若干条道路。请问最少需要新修多少条道路？", "inputFormat": "第一行，两个整数 $n, m$；\n\n接下来 $m$ 行，每行两个整数 $a, b$，表示这个国家的一条双向道路。", "outputFormat": "一行，一个整数，表示所求的值。", "hint": "#### 样例 #2 解释\n一种符合要求的方式是，在城市 $1, 2$ 之间修一条路，在城市 $1, 4$ 之间修一条路。此时城市 $1$ 与城市 $1 \\sim 6$ 的距离分别是 $0, 1, 1, 1, 2, 2$。\n#### 数据范围\n对于 $\\frac{11}{32}$ 的数据，$1 \\leq n \\leq 200$；\n\n对于 $\\frac{5}{8}$ 的数据，$1 \\leq n \\leq 5 \\times 10^3$；\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 2 \\times 10^5$，$0 \\leq m \\leq \\min(2 \\times 10^5, \\frac{n(n - 1)}{2})$，$1 \\leq a, b \\leq n$，**保证没有重边和自环**。\n#### 题目来源\n[CCO2021](https://cemc.math.uwaterloo.ca/contests/computing/2021/index.html) D2T2", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCO 2021] Bread First Search", "background": "", "description": "这个国家有 $n$ 个城市和 $m$ 条双向道路。\n\n有一个人要游览这个国家，但他很讲究。他要求游览线路必须是一个 BFS（Bread First Search，面包优先搜索）序，必须访问每个城市各一次，且满足以下条件：\n\n- 首个城市可以任选；\n- 除了首个城市外，每个城市被访问前至少有一个相邻城市已经被访问过；\n- 每个城市与首个城市的距离单调不降。其中两个城市的距离定义为它们路径边数的最小值。\n\n这个人还有强迫症，一定要按照编号 $1 \\sim n$ 的顺序将每个城市访问一次。为了使这条游览线路符合上述所有要求，政府需要新修若干条道路。请问最少需要新修多少条道路？", "inputFormat": "第一行，两个整数 $n, m$；\n\n接下来 $m$ 行，每行两个整数 $a, b$，表示这个国家的一条双向道路。", "outputFormat": "一行，一个整数，表示所求的值。", "hint": "#### 样例 #2 解释\n一种符合要求的方式是，在城市 $1, 2$ 之间修一条路，在城市 $1, 4$ 之间修一条路。此时城市 $1$ 与城市 $1 \\sim 6$ 的距离分别是 $0, 1, 1, 1, 2, 2$。\n#### 数据范围\n对于 $\\frac{11}{32}$ 的数据，$1 \\leq n \\leq 200$；\n\n对于 $\\frac{5}{8}$ 的数据，$1 \\leq n \\leq 5 \\times 10^3$；\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 2 \\times 10^5$，$0 \\leq m \\leq \\min(2 \\times 10^5, \\frac{n(n - 1)}{2})$，$1 \\leq a, b \\leq n$，**保证没有重边和自环**。\n#### 题目来源\n[CCO2021](https://cemc.math.uwaterloo.ca/contests/computing/2021/index.html) D2T2", "locale": "zh-CN"}}}
{"pid": "P7833", "type": "P", "difficulty": 7, "samples": [["3 100\n10 50\n30 20\n60 40", "0"], ["4 100\n30 70\n10 12\n60 75\n90 50", "1"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["树状数组", "2021", "离散化", "CCO（加拿大）"], "title": "[CCO 2021] Loop Town", "background": "", "description": "循环镇有 $n$ 个公民、$n$ 座房子、$n$ 个办公室。每个公民住在一座房子中，并在一个办公室工作。没有两个公民住在同一座房子，也没有两个公民在同一个办公室工作。\n\n循环镇是一个环形城市，绕城一圈路程为 $l$。循环镇的 $2n$ 栋建筑（房子和办公室）都在环上的整点上，其位置可以用 $[0, l - 1]$ 范围内的整数来描述，且这 $2n$ 栋建筑位置是互不相同的。\n\n每天早上，每个公民同时从自己的房子出发，沿着环路走到自己的办公室。公民到达办公室之后不会立刻进去工作，而是要等到所有公民都到达办公室之后才会同时进入办公室开始工作。\n\n一场疫情的到来打破了常规，领导人要求每个公民保持社交距离。围绕城市的环状道路很窄，两个公民的线路存在相互交叉时会很不方便（必须一个人暂时离开道路才能使另一个人通过），而三个人或以上禁止同时走到同一个地方。\n\n领导人可以给每个公民规定上班路线，即走城市环路的哪一边。领导人的目标是任意两个公民线路交叉的总次数最小，求这个最小值。", "inputFormat": "第一行，两个整数 $n, l$；\n\n接下来 $n$ 行，每行两个整数 $a_i, b_i$，表示第 $i$ 个公民的房子和办公室的位置。", "outputFormat": "一行，一个整数，表示所求的值。", "hint": "#### 数据范围\n对于 $\\frac{4}{13}$ 的数据，$1 \\leq n \\leq 5 \\times 10^3$；\n\n对于 $\\frac{8}{13}$ 的数据，$1 \\leq n \\leq 10^5$；\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^6$，$1 \\leq l \\leq 10^9$，$0 \\leq a_i, b_i < l$，**保证 $a_i, b_i$ 互不相同**。\n#### 题目来源\n[CCO2021](https://cemc.math.uwaterloo.ca/contests/computing/2021/index.html) D2T3", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCO 2021] Loop Town", "background": "", "description": "循环镇有 $n$ 个公民、$n$ 座房子、$n$ 个办公室。每个公民住在一座房子中，并在一个办公室工作。没有两个公民住在同一座房子，也没有两个公民在同一个办公室工作。\n\n循环镇是一个环形城市，绕城一圈路程为 $l$。循环镇的 $2n$ 栋建筑（房子和办公室）都在环上的整点上，其位置可以用 $[0, l - 1]$ 范围内的整数来描述，且这 $2n$ 栋建筑位置是互不相同的。\n\n每天早上，每个公民同时从自己的房子出发，沿着环路走到自己的办公室。公民到达办公室之后不会立刻进去工作，而是要等到所有公民都到达办公室之后才会同时进入办公室开始工作。\n\n一场疫情的到来打破了常规，领导人要求每个公民保持社交距离。围绕城市的环状道路很窄，两个公民的线路存在相互交叉时会很不方便（必须一个人暂时离开道路才能使另一个人通过），而三个人或以上禁止同时走到同一个地方。\n\n领导人可以给每个公民规定上班路线，即走城市环路的哪一边。领导人的目标是任意两个公民线路交叉的总次数最小，求这个最小值。", "inputFormat": "第一行，两个整数 $n, l$；\n\n接下来 $n$ 行，每行两个整数 $a_i, b_i$，表示第 $i$ 个公民的房子和办公室的位置。", "outputFormat": "一行，一个整数，表示所求的值。", "hint": "#### 数据范围\n对于 $\\frac{4}{13}$ 的数据，$1 \\leq n \\leq 5 \\times 10^3$；\n\n对于 $\\frac{8}{13}$ 的数据，$1 \\leq n \\leq 10^5$；\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^6$，$1 \\leq l \\leq 10^9$，$0 \\leq a_i, b_i < l$，**保证 $a_i, b_i$ 互不相同**。\n#### 题目来源\n[CCO2021](https://cemc.math.uwaterloo.ca/contests/computing/2021/index.html) D2T3", "locale": "zh-CN"}}}
{"pid": "P7834", "type": "P", "difficulty": 6, "samples": [["10 11 3\n1 2 3 4 5 6 7 8 9 10\n1 4 4\n2 5 3\n9 8 2\n7 8 10\n7 1 4\n6 7 1\n6 4 8\n2 1 5\n10 8 10\n3 4 7\n3 4 6\n0 5 5\n1 6 8\n7 8 1", "1\n-1\n8"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500], "memory": [131072, 131072, 131072, 131072, 131072]}, "tags": ["2010", "倍增", "Kruskal 重构树", "深度优先搜索 DFS", "可持久化线段树"], "title": "[ONTAK2010] Peaks 加强版", "background": "原题链接：[P4197 Peaks](https://www.luogu.com.cn/problem/P4197)", "description": "给定一张 $n$ 个点、$m$ 条边的无向图，第 $i$ 个点的权值为 $a_i$，边有边权。\n\n有 $q$ 组询问，每组询问给定三个整数 $u, x, k$，求从 $u$ 开始只经过权值 $\\leq x$ 的边所能到达的权值第 $k$ 大的点的权值，如果不存在输出 $-1$。\n\n**本题强制在线。即：每次查询输入的是 $u', x', k'$，则 $u = (u' \\operatorname{xor} \\text{lastans}) \\bmod n + 1$，$k$ 的解密方式与之相同，$x = x' \\operatorname{xor} \\text{lastans}$**。", "inputFormat": "第一行，三个整数 $n, m, q$；\n\n第二行，$n$ 个整数 $a_1, a_2, \\cdots, a_n$；\n\n接下来 $m$ 行，每行三个整数 $s, t, w$，表示一条边的两个端点和权值；\n\n接下来 $q$ 行，每行三个整数 $u', x', k'$。\n\n**注意：处理第一组数据和无解时的 $\\text{lastans} = 0$。**", "outputFormat": "对于每组询问，输出一行，一个整数，表示所求的值。", "hint": "对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^5$，$1 \\leq m, q \\leq 5 \\times 10^5$，$1 \\leq s, t \\leq n$，$1 \\leq a_i, w \\leq 10^9$，$0 \\leq u', x', k' < 2^{31}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[ONTAK2010] Peaks 加强版", "background": "原题链接：[P4197 Peaks](https://www.luogu.com.cn/problem/P4197)", "description": "给定一张 $n$ 个点、$m$ 条边的无向图，第 $i$ 个点的权值为 $a_i$，边有边权。\n\n有 $q$ 组询问，每组询问给定三个整数 $u, x, k$，求从 $u$ 开始只经过权值 $\\leq x$ 的边所能到达的权值第 $k$ 大的点的权值，如果不存在输出 $-1$。\n\n**本题强制在线。即：每次查询输入的是 $u', x', k'$，则 $u = (u' \\operatorname{xor} \\text{lastans}) \\bmod n + 1$，$k$ 的解密方式与之相同，$x = x' \\operatorname{xor} \\text{lastans}$**。", "inputFormat": "第一行，三个整数 $n, m, q$；\n\n第二行，$n$ 个整数 $a_1, a_2, \\cdots, a_n$；\n\n接下来 $m$ 行，每行三个整数 $s, t, w$，表示一条边的两个端点和权值；\n\n接下来 $q$ 行，每行三个整数 $u', x', k'$。\n\n**注意：处理第一组数据和无解时的 $\\text{lastans} = 0$。**", "outputFormat": "对于每组询问，输出一行，一个整数，表示所求的值。", "hint": "对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^5$，$1 \\leq m, q \\leq 5 \\times 10^5$，$1 \\leq s, t \\leq n$，$1 \\leq a_i, w \\leq 10^9$，$0 \\leq u', x', k' < 2^{31}$。", "locale": "zh-CN"}}}
{"pid": "P7835", "type": "P", "difficulty": 2, "samples": [["4 3\n2 1 2\n3 1 1\n4 2 1", "3"], ["2 2\n2 1 2\n3 0 1", "Mystia will cook forever..."]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["最大公约数 gcd"], "title": "「Wdoi-3」夜雀 dreaming", "background": "作为幻想乡食物链顶端的幽幽子，一直都是老板娘米斯蒂娅的噩梦！\n\n尽管幽幽子一般而言是不会选择吃她的，但奈何日有所思夜有所梦，米斯蒂娅做了一个梦，一个交杂着幻想与现实的梦，或者说，那就是幻想中的现实……\n\n尽管米斯蒂娅不知道这天什么时候会到来，但她不敢放松警惕，于是老板娘向你求助了……", "description": "作为一道签到题，为了能让选手更好的发挥手速，米斯蒂娅决定提供这题的题意简述：[隙间传送](https://www.luogu.com.cn/paste/2dwm3f7z)。\n\n---\n\n在梦中，幽幽子来到了夜雀餐厅。似乎是由于异变的影响，本来就贪吃的幽幽子此刻变得更加可怕。\n\n米斯蒂娅一共会做 $n$ 道菜，用来满足所有顾客的需求，并试图增加自己存活的概率。这些菜的编号为 $0,1,2$ 直到 $n-1$。同时，幽幽子会进行 $k$ 次点餐。\n\n- 本题中，我们记**点菜事件**为 $\\operatorname{order}(t,x)$ ，表示顾客向米斯蒂娅发起一份请求，希望她在 $t$ 时刻制作并端上菜品 $x$ 。\n- 我们用一个三元组 $(t_i,x_i,y_i)$ 描述幽幽子发起第 $i$ 次点餐。在每次点餐中，幽幽子会发起 $\\operatorname{order}(t_i,x_i)$ 。然而幽幽子的欲望是不能被满足的。因此，当幽幽子在 $t_i$ 时刻收到菜品时，会再次发起 $\\operatorname{order}(2\\cdot t_i,(x_i+y_i)\\bmod n)$ ！更加不幸地，此过程会不断累加，接着她会发起 $\\operatorname{order}(3\\cdot t_i,(x_i+2\\cdot y_i)\\bmod n)$ 乃至更多……\n- 总而言之，幽幽子的第 $i$ 次点餐 $(t_i,x_i,y_i)$ 会执行这样的操作：\n\n$$\\operatorname{order}(j\\cdot t_i,(x_i+(j-1)\\cdot y_i)\\bmod n)(j=1,2,3,\\cdots)$$\n\n由于幽幽子会发起无数次点餐请求，所以米斯蒂娅是不可能使她满足的。但为了不辜负大家的期望，米斯蒂娅决定竭尽全力拖延时间。作为老板娘，她有着超凡的厨艺：\n\n- 每一个时刻，米斯蒂娅都能做出**无限**份菜，**但菜只能是同一种类**。\n\n如果一个时刻幽幽子点的菜没能被立即做好（幽幽子并不愿意吃上一个时刻做好的菜哦），那么她就会大发雷霆，在这一时刻**立即**摧毁夜雀餐厅。米斯蒂娅想知道她能坚持多久（坚持多久指的是最多能坚持多少个时刻使得这些时刻内幽幽子不会摧毁餐厅，时刻**从 $1$ 开始计数**）。如果她能坚持 $9961^{9961}$ 时刻或以上的话（在此题中，你可以认为 $9961^{9961}$ 是无穷大），请输出 `Mystia will cook forever...`。\n", "inputFormat": "第一行有两个整数 $n,k$ ，含义如题面所示。\n\n接下来 $k$ 行，每行给定三个整数 $(t_i,x_i,y_i)$ ，描述一组询问。", "outputFormat": "共一行。输出米斯蒂娅最多能支撑多久，或者输出 `Mystia will cook forever...`。", "hint": "#### 样例 1 解释\n\n在时刻 $4$，幽幽子同时点了菜品 $3$ 和菜品 $2$，于是夜雀餐厅会被摧毁，答案为 $4-1=3$。\n\n---\n\n#### 数据范围及约定\n\n$$\\def\\arraystretch{1.5}\\begin{array}{|c|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{k} & \\bm{\\max\\{t_i\\}} & \\textbf{特殊性质} & \\textbf{分值}\\cr\\hline\n\\textsf1 & =1 & \\text{无特殊限制} & \\text{无} & 10 \\cr\\hline\n\\textsf2 & \\leq 10 & \\leq 10 & \\text{无} & 20 \\cr\\hline\n\\textsf3 & \\text{无特殊限制} & \\text{无特殊限制} & \\text{A} & 30\\cr\\hline\n\\textsf4 & \\text{无特殊限制} & \\text{无特殊限制}& \\text{无}& 40 \\cr\\hline\n\\end{array}$$\n\n特殊性质 $\\text{A}$ ：保证对于所有的 $i$ ，满足 $y_i = 0$ 。\n\n对于 $100\\%$ 的数据，满足：\n- $1 \\le t_i,n \\leq 10 ^ 9$。\n- $0 \\le x_i,y_i  \\leq 10 ^ 9$。\n- $1 \\le k \\leq 1000 $。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdoi-3」夜雀 dreaming", "background": "作为幻想乡食物链顶端的幽幽子，一直都是老板娘米斯蒂娅的噩梦！\n\n尽管幽幽子一般而言是不会选择吃她的，但奈何日有所思夜有所梦，米斯蒂娅做了一个梦，一个交杂着幻想与现实的梦，或者说，那就是幻想中的现实……\n\n尽管米斯蒂娅不知道这天什么时候会到来，但她不敢放松警惕，于是老板娘向你求助了……", "description": "作为一道签到题，为了能让选手更好的发挥手速，米斯蒂娅决定提供这题的题意简述：[隙间传送](https://www.luogu.com.cn/paste/2dwm3f7z)。\n\n---\n\n在梦中，幽幽子来到了夜雀餐厅。似乎是由于异变的影响，本来就贪吃的幽幽子此刻变得更加可怕。\n\n米斯蒂娅一共会做 $n$ 道菜，用来满足所有顾客的需求，并试图增加自己存活的概率。这些菜的编号为 $0,1,2$ 直到 $n-1$。同时，幽幽子会进行 $k$ 次点餐。\n\n- 本题中，我们记**点菜事件**为 $\\operatorname{order}(t,x)$ ，表示顾客向米斯蒂娅发起一份请求，希望她在 $t$ 时刻制作并端上菜品 $x$ 。\n- 我们用一个三元组 $(t_i,x_i,y_i)$ 描述幽幽子发起第 $i$ 次点餐。在每次点餐中，幽幽子会发起 $\\operatorname{order}(t_i,x_i)$ 。然而幽幽子的欲望是不能被满足的。因此，当幽幽子在 $t_i$ 时刻收到菜品时，会再次发起 $\\operatorname{order}(2\\cdot t_i,(x_i+y_i)\\bmod n)$ ！更加不幸地，此过程会不断累加，接着她会发起 $\\operatorname{order}(3\\cdot t_i,(x_i+2\\cdot y_i)\\bmod n)$ 乃至更多……\n- 总而言之，幽幽子的第 $i$ 次点餐 $(t_i,x_i,y_i)$ 会执行这样的操作：\n\n$$\\operatorname{order}(j\\cdot t_i,(x_i+(j-1)\\cdot y_i)\\bmod n)(j=1,2,3,\\cdots)$$\n\n由于幽幽子会发起无数次点餐请求，所以米斯蒂娅是不可能使她满足的。但为了不辜负大家的期望，米斯蒂娅决定竭尽全力拖延时间。作为老板娘，她有着超凡的厨艺：\n\n- 每一个时刻，米斯蒂娅都能做出**无限**份菜，**但菜只能是同一种类**。\n\n如果一个时刻幽幽子点的菜没能被立即做好（幽幽子并不愿意吃上一个时刻做好的菜哦），那么她就会大发雷霆，在这一时刻**立即**摧毁夜雀餐厅。米斯蒂娅想知道她能坚持多久（坚持多久指的是最多能坚持多少个时刻使得这些时刻内幽幽子不会摧毁餐厅，时刻**从 $1$ 开始计数**）。如果她能坚持 $9961^{9961}$ 时刻或以上的话（在此题中，你可以认为 $9961^{9961}$ 是无穷大），请输出 `Mystia will cook forever...`。\n", "inputFormat": "第一行有两个整数 $n,k$ ，含义如题面所示。\n\n接下来 $k$ 行，每行给定三个整数 $(t_i,x_i,y_i)$ ，描述一组询问。", "outputFormat": "共一行。输出米斯蒂娅最多能支撑多久，或者输出 `Mystia will cook forever...`。", "hint": "#### 样例 1 解释\n\n在时刻 $4$，幽幽子同时点了菜品 $3$ 和菜品 $2$，于是夜雀餐厅会被摧毁，答案为 $4-1=3$。\n\n---\n\n#### 数据范围及约定\n\n$$\\def\\arraystretch{1.5}\\begin{array}{|c|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{k} & \\bm{\\max\\{t_i\\}} & \\textbf{特殊性质} & \\textbf{分值}\\cr\\hline\n\\textsf1 & =1 & \\text{无特殊限制} & \\text{无} & 10 \\cr\\hline\n\\textsf2 & \\leq 10 & \\leq 10 & \\text{无} & 20 \\cr\\hline\n\\textsf3 & \\text{无特殊限制} & \\text{无特殊限制} & \\text{A} & 30\\cr\\hline\n\\textsf4 & \\text{无特殊限制} & \\text{无特殊限制}& \\text{无}& 40 \\cr\\hline\n\\end{array}$$\n\n特殊性质 $\\text{A}$ ：保证对于所有的 $i$ ，满足 $y_i = 0$ 。\n\n对于 $100\\%$ 的数据，满足：\n- $1 \\le t_i,n \\leq 10 ^ 9$。\n- $0 \\le x_i,y_i  \\leq 10 ^ 9$。\n- $1 \\le k \\leq 1000 $。", "locale": "zh-CN"}}}
{"pid": "P7836", "type": "P", "difficulty": 6, "samples": [["5 3 4\n7 11 7 11 \n1 0 0 1 \n2 1 0 0 \n1 1 0 0 \n1 0 2 0 \n1 0 0 2 \n", "29\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "贪心", "O2优化"], "title": "「Wdoi-3」夜雀 collecting", "background": "巧妇难为无米之炊。在制作菜品之前，米斯蒂娅必然要四处收集食材了。\n\n然而幻想乡实在是太大，四处散落着各种各样的食材。米斯蒂娅的背包却非常有限，以至于四处采集时不得不考虑取舍的问题了。米斯蒂娅的时间非常有限，因为她必须要在夜晚摆摊之前准备好所有的食材。\n\n于是她来向你求助，希望精通计算的你帮助她收集食材。", "description": "米斯蒂娅有一个容量为 $v$ 的背包，而食材有 $x$ 种。当背包被塞满后，米斯蒂娅就不能够采集更多的食材了。\n\n为了尽可能地收集到更多食材，又要节省更多时间，她会**依次**经过 $n$ 个采集点。每个采集点都会有一定量的食材可供采集。\n\n具体来说，对于第 $i$ 个采集点，每种食材的个数分别为 $C_{i,1},C_{i,2}\\cdots C_{i,x}$ ，其中 $C_{i,j}$ 代表该采集点有多少个第 $j$ 种食材。保证对于所有 $i$ ，都有 $\\displaystyle C_{i,1}+C_{i,2}+\\cdots+C_{i,x}=\\sum_{j=1}^{x}C_{i,j} \\leq v$ 。\n\n每到一个采集点，米斯蒂娅都会决定是否开始采集食材。因为她非常享受采集新食材带来的愉悦感，一旦开始采集，她会将这个采集点的食材**全部采集完**。因此，如果此时她背包不足以塞下这里所有的食物，她将**不能进行**采集。尽管如此，米斯蒂娅也可以选择在采集前丢弃背包里的一些食材。\n\n不同的食材在烹饪中的泛用性是不同的，一些食材会经常使用，而一些食材则只会出现于少数菜品。因此，每种食材在米斯蒂亚心中有着不同的价值，第 $i$ 种的价值为 $A_i$。\n\n为了菜品的多样性，米斯蒂娅会尽可能采集更多种类的食材。于是她想知道，在经过了这 $n$ 个采集点后，她的背包中至少有 $1$ 个的食材的价值和最大是多少（也就是说，如果一种食材有多个，那么只计算一次）。", "inputFormat": "第一行三个整数 $n,v,x$。  \n第二行 $x$ 个整数，表示每种食材的价值。  \n接下来 $n$ 行，每行 $x$ 个整数，第 $i$ 行的第 $j$ 个整数表示 $C_{i,j}$。", "outputFormat": "一行一个整数，表示价值和。", "hint": "#### 样例 1 解释\n\n在第一个和第三个采集点收集食材。要注意的是，在采集第三个采集点前，丢弃一个第一种食材。最终，四个食材的数量分别是 $\\{1,1,0,1\\}$，于是获得的价值和为 $7+11+11=29$。可以证明，没有更优的方案。\n\n---\n\n#### 数据范围及约定\n\n$$\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm x & \\bm n & \\textbf{分值}\\cr \\hline\n1 & 1\\le x \\le 10 & 1\\le n\\le 2\\times 10^3 & 20 \\cr\\hline\n2 & 1\\le x \\le 14 & 1\\le n\\le 10^6 & 40 \\cr\\hline\n3 & 1\\le x \\le 18 & 1\\le n\\le 1000 & 40 \\cr\\hline\n\\end{array}\n$$\n\n对于 $100\\%$ 的数据，有 $1 \\le n \\le 10^6$，$1 \\le x \\le 18$，$1 \\le v \\le 2000$，$0 \\le C_{i,j}$，$\\sum_{j=1}^x C_{i,j} \\le v$，$0 \\le A_i \\le 1000$。\n\nSubtask 4 为不计分的 Hack 数据， 保证满足 Subtask 2 或 Subtask 3 的限制。\n\n特别感谢 chenxinyang2006 对本题解法的巨大贡献。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdoi-3」夜雀 collecting", "background": "巧妇难为无米之炊。在制作菜品之前，米斯蒂娅必然要四处收集食材了。\n\n然而幻想乡实在是太大，四处散落着各种各样的食材。米斯蒂娅的背包却非常有限，以至于四处采集时不得不考虑取舍的问题了。米斯蒂娅的时间非常有限，因为她必须要在夜晚摆摊之前准备好所有的食材。\n\n于是她来向你求助，希望精通计算的你帮助她收集食材。", "description": "米斯蒂娅有一个容量为 $v$ 的背包，而食材有 $x$ 种。当背包被塞满后，米斯蒂娅就不能够采集更多的食材了。\n\n为了尽可能地收集到更多食材，又要节省更多时间，她会**依次**经过 $n$ 个采集点。每个采集点都会有一定量的食材可供采集。\n\n具体来说，对于第 $i$ 个采集点，每种食材的个数分别为 $C_{i,1},C_{i,2}\\cdots C_{i,x}$ ，其中 $C_{i,j}$ 代表该采集点有多少个第 $j$ 种食材。保证对于所有 $i$ ，都有 $\\displaystyle C_{i,1}+C_{i,2}+\\cdots+C_{i,x}=\\sum_{j=1}^{x}C_{i,j} \\leq v$ 。\n\n每到一个采集点，米斯蒂娅都会决定是否开始采集食材。因为她非常享受采集新食材带来的愉悦感，一旦开始采集，她会将这个采集点的食材**全部采集完**。因此，如果此时她背包不足以塞下这里所有的食物，她将**不能进行**采集。尽管如此，米斯蒂娅也可以选择在采集前丢弃背包里的一些食材。\n\n不同的食材在烹饪中的泛用性是不同的，一些食材会经常使用，而一些食材则只会出现于少数菜品。因此，每种食材在米斯蒂亚心中有着不同的价值，第 $i$ 种的价值为 $A_i$。\n\n为了菜品的多样性，米斯蒂娅会尽可能采集更多种类的食材。于是她想知道，在经过了这 $n$ 个采集点后，她的背包中至少有 $1$ 个的食材的价值和最大是多少（也就是说，如果一种食材有多个，那么只计算一次）。", "inputFormat": "第一行三个整数 $n,v,x$。  \n第二行 $x$ 个整数，表示每种食材的价值。  \n接下来 $n$ 行，每行 $x$ 个整数，第 $i$ 行的第 $j$ 个整数表示 $C_{i,j}$。", "outputFormat": "一行一个整数，表示价值和。", "hint": "#### 样例 1 解释\n\n在第一个和第三个采集点收集食材。要注意的是，在采集第三个采集点前，丢弃一个第一种食材。最终，四个食材的数量分别是 $\\{1,1,0,1\\}$，于是获得的价值和为 $7+11+11=29$。可以证明，没有更优的方案。\n\n---\n\n#### 数据范围及约定\n\n$$\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm x & \\bm n & \\textbf{分值}\\cr \\hline\n1 & 1\\le x \\le 10 & 1\\le n\\le 2\\times 10^3 & 20 \\cr\\hline\n2 & 1\\le x \\le 14 & 1\\le n\\le 10^6 & 40 \\cr\\hline\n3 & 1\\le x \\le 18 & 1\\le n\\le 1000 & 40 \\cr\\hline\n\\end{array}\n$$\n\n对于 $100\\%$ 的数据，有 $1 \\le n \\le 10^6$，$1 \\le x \\le 18$，$1 \\le v \\le 2000$，$0 \\le C_{i,j}$，$\\sum_{j=1}^x C_{i,j} \\le v$，$0 \\le A_i \\le 1000$。\n\nSubtask 4 为不计分的 Hack 数据， 保证满足 Subtask 2 或 Subtask 3 的限制。\n\n特别感谢 chenxinyang2006 对本题解法的巨大贡献。", "locale": "zh-CN"}}}
{"pid": "P7837", "type": "P", "difficulty": 5, "samples": [["1\n12 4 2 1\n\n13\n\n20\n\n22", "\n\n10 12\n\n2 7\n\n4 8\n\n-1 4 7 10 11"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["二分", "交互题", "Special Judge", "O2优化", "分块"], "title": "「Wdoi-3」夜雀 cooking", "background": "作为幻想乡的大厨，米斯蒂娅当然能用准备的食材制作出各色各样的饭菜。晚上，就是夜雀餐厅营业的时间，凭着这些料理，餐厅总是生意兴隆——甚至一些「特殊顾客」也会前来！\n\n特殊顾客就是一些幻想乡里大家再熟悉不过的角色啦，顾名思义，她们会提出特殊要求，不过如果满足了她们的要求，她们也会好好地奖励小夜雀。\n\n不幸的是，紫决定做一个恶作剧，她悄悄使用能力清除了米斯蒂娅的部分记忆，现在她分不清哪些顾客是特殊顾客，哪些顾客是普通顾客了！看着米斯蒂娅快要哭了，于心不忍的紫决定和米斯蒂娅做一个数学游戏，她将特殊顾客的编号隐藏在了数字之中。米斯蒂娅对数学一窍不通，于是她只能向你求助了......", "description": "**本题为交互题。**\n\n紫给出了一个长度为 $n$ 的数列，其第 $i$ 项就对应了编号为 $i$ 的顾客。她将所有普通顾客对应的位置染上蓝色，把特殊顾客对应的位置染上紫色。紫告诉了米斯蒂娅特殊顾客一共有 $m$ 位。并且，由于特殊顾客非常的特殊，所以紫色位置数量很少，而且**基本均匀随机**。\n\n接下来，她给数列的每一项赋上了值。第 $i$ 项的值 $a_i$ 可以用如下的式子推出：（$s$ 和 $k$ 紫都会给出）\n  $$a_i=\\begin{cases} s & i=1\\cr a_{i-1}+k & i>1\\end{cases}$$\n\n米斯蒂娅可以向紫提出形如 `l r` 的问题，然后紫就会迅速算出区间 $[l,r]$ 内所有被染成蓝色位置的 $a_i$ 的和。当然啦，你需要输出 `l r` 来告诉米斯蒂娅她该如何提问，如果你成功找出了所有特殊顾客的编号（即所有紫色点的位置），那么你需要输出 `-1 p1 p2 ... pm` 来告诉米斯蒂娅所有特殊顾客的编号，注意要保证 $p_i\\le p_{i+1}(1\\le i<m)$。\n\n**注意：在进行这两种操作后，需要刷新缓存区，下面是一些常见语言的刷新缓存区方式：**\n\n- C++：`fflush(stdout)` 或 `cout.flush()`。\n- C: `fflush(stdout)`。\n- Java: `System.out.flush()`。\n- Python: `stdout.flush()`。\n- Pascal: `flush(output)`。\n- 其他语言：请参考对应语言的帮助文档。", "inputFormat": "**本题有多组数据。**\n\n第一行是一个正整数 $T$，表示数据组数。\n\n接下来进行每组数据。首先夜雀会传达紫所说的信息，也就是 $n,m,s,k$ 的值，接着你可以发起若干次询问，直到你告诉了米斯蒂娅所有特殊顾客的编号。此时该组数据结束，进入到下一组。", "outputFormat": "输出若干行。你可以向标准输出中发起询问来得到米斯蒂娅的回答。\n\n**注意：** 如果你在询问过程中出了问题（包括但不限于询问次数过多，询问越界等），此时米斯蒂娅会告诉你 $-1$（代表紫不想理她了）。此时你应立即停止，否则可能会出现奇怪的状况。", "hint": "#### 样例解释\n\n神秘顾客的编号为 $\\{4,7,10,11\\}$ 。这个样例象征性地抽取了 $3$ 个询问，以便选手理解交互的过程。\n\n- 对于第一次询问 $[10,12]$ ，结果为 $13=13$。\n- 对于第二次询问 $[2,7]$ ，结果为 $3+4+6+7=20$。\n- 对于第三次询问 $[4,8]$ ，结果为 $6+7+9=22$。\n\n---\n\n#### 数据范围及约定\n\n$$\\def\\arraystretch{1.8}\n\\begin{array}{|c|c|c|}\\hline\n\\textbf{Subtask} & \\textbf{特殊性质} & \\textbf{分值} \\cr\\hline\n1 & m=1 & 5 \\cr\\hline\n2 & - & 95 \\cr\\hline\n\\end{array}$$\n\n- 对于所有数据，满足 $1\\le T\\le 500$，$1 \\leq \\sum n_i \\leq 10^5$，$1 \\leq \\sum m_i \\leq \\min\\{ n,100\\}$，$1\\le s,k\\le 10^9$。\n\n每一个 Subtask 的得分为当前 Subtask 所有测试点的最低分。\n\n#### 判分方式\n\n令 $q_i$ 为对于第 $i$ 组数据你所用的询问次数，你需要满足 $\\sum q_i \\leq 200 \\times T$ ，并且每组询问的结果都是正确的，你才能获得该测试点的满分。\n\n- 如果询问次数满足 $1000 \\times T<\\sum q_i \\leq 2000 \\times T$，可以拿到 $20\\%$ 的分数。\n- 如果询问次数满足 $600 \\times T<\\sum q_i \\leq 1000 \\times T$，可以拿到 $40\\%$ 的分数。  \n- 如果询问次数满足 $400 \\times T<\\sum q_i \\leq 600 \\times T$，可以拿到 $50\\%$ 的分数。\n- 如果询问次数满足 $300 \\times T<\\sum q_i \\leq 400 \\times T$，可以拿到 $60\\%$ 的分数。\n- 如果询问次数满足 $200 \\times T<\\sum q_i \\leq 300 \\times T$，可以拿到 $80\\%$ 的分数。\n\n#### 说明\n\n选择 $m$ 个点染为紫色的生成方式是对一个 $1 \\sim n$ 的排列调用 `random_shuffle`，然后取前 $m$ 项的数值作为特殊顾客的编号。一个可被参考的代码如下：\n\n```cpp\nnamespace Gen{\n\ttypedef unsigned int       u32;\n\ttypedef unsigned long long u64;\n\tu32 MT[624],idx;\n\tvoid iit(u32 seed){\n    \tMT[0]=seed; idx=0; for(u32 i = 1;i < 624;++ i)\n    \tMT[i]=(0x6c078965U * (MT[i - 1] ^ ((MT[i - 1]) >> 30)) + i);\n\t}\n\tvoid gen(){\n\t\tu32 x; for(u32 i = 0;i < 624; ++ i){\n\t\t\tx = (MT[i] & 0x80000000U) +\n\t\t\t\t(MT[(i + 1) % 624] & 0x7fffffffU );\n\t\t\tMT[i] = MT[(i + 397) % 624] ^ (x >> 1);\n\t\t\tif(x & 1) MT[i] ^= 0x9908b0dfU;\n\t\t}\n\t}\n\tu32  clc(){\n\t\tif(!idx) gen(); u32 x = MT[idx];\n\t\tx ^= x >> 11, x ^= (x << 7) & 0x9d2c5680U;\n\t\tx ^= (x << 15) & 0xefc60000U,x ^= x >> 18;\n\t\tidx = (idx + 1) % 624; return x;\n\t}\n\tu32  clc(u32 n){\t//均匀随机地返回 [0,n) 内的整数\n\t\treturn 1ull * n * clc() >> 32;\n\t}\n\tvoid sfl(int n, int *A) {\n\t\tfor(int i = n;i >= 1; --i) swap(A[clc(i) + 1], A[i]);\n\t}\n\tvoid gen(u32 seed,int n, int *A) {\n\t\tiit(seed); for(int i = 1;i <= n; ++i) A[i] = i; sfl(n, A);\n\t}\n}\n```\n\n**注**：该代码片段会使用符合标准的梅森旋转算法生成随机数。其生成随机数的周期为 $2^{19937}-1$ ，生成的随机数是均匀随机的。因此你大可不必担心我们在里面做了任何手脚。\n\n调用 `gen(seed,n,A)` 可以生成一个长度为 $n$ 的**基本均匀随机**序列，我们将会取其前 $m$ 项作为特殊顾客的编号。例如，对于样例，我们调用了 `gen(9961U,12,A)` ，并选取了 $A$ 的前 $4$ 项 $\\{4,7,10,11\\}$ 作为神秘顾客的编号。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdoi-3」夜雀 cooking", "background": "作为幻想乡的大厨，米斯蒂娅当然能用准备的食材制作出各色各样的饭菜。晚上，就是夜雀餐厅营业的时间，凭着这些料理，餐厅总是生意兴隆——甚至一些「特殊顾客」也会前来！\n\n特殊顾客就是一些幻想乡里大家再熟悉不过的角色啦，顾名思义，她们会提出特殊要求，不过如果满足了她们的要求，她们也会好好地奖励小夜雀。\n\n不幸的是，紫决定做一个恶作剧，她悄悄使用能力清除了米斯蒂娅的部分记忆，现在她分不清哪些顾客是特殊顾客，哪些顾客是普通顾客了！看着米斯蒂娅快要哭了，于心不忍的紫决定和米斯蒂娅做一个数学游戏，她将特殊顾客的编号隐藏在了数字之中。米斯蒂娅对数学一窍不通，于是她只能向你求助了......", "description": "**本题为交互题。**\n\n紫给出了一个长度为 $n$ 的数列，其第 $i$ 项就对应了编号为 $i$ 的顾客。她将所有普通顾客对应的位置染上蓝色，把特殊顾客对应的位置染上紫色。紫告诉了米斯蒂娅特殊顾客一共有 $m$ 位。并且，由于特殊顾客非常的特殊，所以紫色位置数量很少，而且**基本均匀随机**。\n\n接下来，她给数列的每一项赋上了值。第 $i$ 项的值 $a_i$ 可以用如下的式子推出：（$s$ 和 $k$ 紫都会给出）\n  $$a_i=\\begin{cases} s & i=1\\cr a_{i-1}+k & i>1\\end{cases}$$\n\n米斯蒂娅可以向紫提出形如 `l r` 的问题，然后紫就会迅速算出区间 $[l,r]$ 内所有被染成蓝色位置的 $a_i$ 的和。当然啦，你需要输出 `l r` 来告诉米斯蒂娅她该如何提问，如果你成功找出了所有特殊顾客的编号（即所有紫色点的位置），那么你需要输出 `-1 p1 p2 ... pm` 来告诉米斯蒂娅所有特殊顾客的编号，注意要保证 $p_i\\le p_{i+1}(1\\le i<m)$。\n\n**注意：在进行这两种操作后，需要刷新缓存区，下面是一些常见语言的刷新缓存区方式：**\n\n- C++：`fflush(stdout)` 或 `cout.flush()`。\n- C: `fflush(stdout)`。\n- Java: `System.out.flush()`。\n- Python: `stdout.flush()`。\n- Pascal: `flush(output)`。\n- 其他语言：请参考对应语言的帮助文档。", "inputFormat": "**本题有多组数据。**\n\n第一行是一个正整数 $T$，表示数据组数。\n\n接下来进行每组数据。首先夜雀会传达紫所说的信息，也就是 $n,m,s,k$ 的值，接着你可以发起若干次询问，直到你告诉了米斯蒂娅所有特殊顾客的编号。此时该组数据结束，进入到下一组。", "outputFormat": "输出若干行。你可以向标准输出中发起询问来得到米斯蒂娅的回答。\n\n**注意：** 如果你在询问过程中出了问题（包括但不限于询问次数过多，询问越界等），此时米斯蒂娅会告诉你 $-1$（代表紫不想理她了）。此时你应立即停止，否则可能会出现奇怪的状况。", "hint": "#### 样例解释\n\n神秘顾客的编号为 $\\{4,7,10,11\\}$ 。这个样例象征性地抽取了 $3$ 个询问，以便选手理解交互的过程。\n\n- 对于第一次询问 $[10,12]$ ，结果为 $13=13$。\n- 对于第二次询问 $[2,7]$ ，结果为 $3+4+6+7=20$。\n- 对于第三次询问 $[4,8]$ ，结果为 $6+7+9=22$。\n\n---\n\n#### 数据范围及约定\n\n$$\\def\\arraystretch{1.8}\n\\begin{array}{|c|c|c|}\\hline\n\\textbf{Subtask} & \\textbf{特殊性质} & \\textbf{分值} \\cr\\hline\n1 & m=1 & 5 \\cr\\hline\n2 & - & 95 \\cr\\hline\n\\end{array}$$\n\n- 对于所有数据，满足 $1\\le T\\le 500$，$1 \\leq \\sum n_i \\leq 10^5$，$1 \\leq \\sum m_i \\leq \\min\\{ n,100\\}$，$1\\le s,k\\le 10^9$。\n\n每一个 Subtask 的得分为当前 Subtask 所有测试点的最低分。\n\n#### 判分方式\n\n令 $q_i$ 为对于第 $i$ 组数据你所用的询问次数，你需要满足 $\\sum q_i \\leq 200 \\times T$ ，并且每组询问的结果都是正确的，你才能获得该测试点的满分。\n\n- 如果询问次数满足 $1000 \\times T<\\sum q_i \\leq 2000 \\times T$，可以拿到 $20\\%$ 的分数。\n- 如果询问次数满足 $600 \\times T<\\sum q_i \\leq 1000 \\times T$，可以拿到 $40\\%$ 的分数。  \n- 如果询问次数满足 $400 \\times T<\\sum q_i \\leq 600 \\times T$，可以拿到 $50\\%$ 的分数。\n- 如果询问次数满足 $300 \\times T<\\sum q_i \\leq 400 \\times T$，可以拿到 $60\\%$ 的分数。\n- 如果询问次数满足 $200 \\times T<\\sum q_i \\leq 300 \\times T$，可以拿到 $80\\%$ 的分数。\n\n#### 说明\n\n选择 $m$ 个点染为紫色的生成方式是对一个 $1 \\sim n$ 的排列调用 `random_shuffle`，然后取前 $m$ 项的数值作为特殊顾客的编号。一个可被参考的代码如下：\n\n```cpp\nnamespace Gen{\n\ttypedef unsigned int       u32;\n\ttypedef unsigned long long u64;\n\tu32 MT[624],idx;\n\tvoid iit(u32 seed){\n    \tMT[0]=seed; idx=0; for(u32 i = 1;i < 624;++ i)\n    \tMT[i]=(0x6c078965U * (MT[i - 1] ^ ((MT[i - 1]) >> 30)) + i);\n\t}\n\tvoid gen(){\n\t\tu32 x; for(u32 i = 0;i < 624; ++ i){\n\t\t\tx = (MT[i] & 0x80000000U) +\n\t\t\t\t(MT[(i + 1) % 624] & 0x7fffffffU );\n\t\t\tMT[i] = MT[(i + 397) % 624] ^ (x >> 1);\n\t\t\tif(x & 1) MT[i] ^= 0x9908b0dfU;\n\t\t}\n\t}\n\tu32  clc(){\n\t\tif(!idx) gen(); u32 x = MT[idx];\n\t\tx ^= x >> 11, x ^= (x << 7) & 0x9d2c5680U;\n\t\tx ^= (x << 15) & 0xefc60000U,x ^= x >> 18;\n\t\tidx = (idx + 1) % 624; return x;\n\t}\n\tu32  clc(u32 n){\t//均匀随机地返回 [0,n) 内的整数\n\t\treturn 1ull * n * clc() >> 32;\n\t}\n\tvoid sfl(int n, int *A) {\n\t\tfor(int i = n;i >= 1; --i) swap(A[clc(i) + 1], A[i]);\n\t}\n\tvoid gen(u32 seed,int n, int *A) {\n\t\tiit(seed); for(int i = 1;i <= n; ++i) A[i] = i; sfl(n, A);\n\t}\n}\n```\n\n**注**：该代码片段会使用符合标准的梅森旋转算法生成随机数。其生成随机数的周期为 $2^{19937}-1$ ，生成的随机数是均匀随机的。因此你大可不必担心我们在里面做了任何手脚。\n\n调用 `gen(seed,n,A)` 可以生成一个长度为 $n$ 的**基本均匀随机**序列，我们将会取其前 $m$ 项作为特殊顾客的编号。例如，对于样例，我们调用了 `gen(9961U,12,A)` ，并选取了 $A$ 的前 $4$ 项 $\\{4,7,10,11\\}$ 作为神秘顾客的编号。", "locale": "zh-CN"}}}
{"pid": "P7838", "type": "P", "difficulty": 6, "samples": [["3\n4 7 3 6 1 2 5", "3"], ["7\n1 15 2 14 3 13 4 12 5 11 6 10 7 9 8", "8"], ["1\n1 2 3", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["贪心", "线段树", "O2优化"], "title": "「Wdoi-3」夜雀 treating", "background": "经历了一整天的磨难，米斯蒂娅终于迎来了这一天最后一位客人——蓬莱山辉夜。\n\n作为永远亭的大小姐、月之都的公主，辉夜对于经营着平凡小吃摊的米斯蒂娅，向来是一个巨大的挑战。辉夜的口味极其挑剔，以至于米斯蒂娅常常难以满足她的需求。更棘手的是，如果辉夜认为米斯蒂娅招待不周，那么夜雀食堂的后果可能并不会比被幽幽子摧毁好多少。\n\n于是可怜的小夜雀只能向你求助了。", "description": "为了伺候这位主客，米斯蒂娅事先准备好了 $2n+1$ 种食材，并排成了一排，第 $i$ 种食材在左起第 $i$ 位，作为**预选食材**。\n\n接着，辉夜对所有食材进行了打分，每个食材被给予了一个在 $[1,2n+1]$ 当中的**互不相等**的分数。其中第 $i$ 种食材的评分为 $A_i$。\n\n由于月之民的奇怪癖好，辉夜喜欢一组连续的数字。因此，她对最终选出来的食材（不妨称为**最终食材**）的满意度，定义为将这些食材**按照其评分从小到大排序后**，其中**最长**的**评分连续**的食材的**长度**。评分连续，也就是这些食材的评分形成了公差为 $1$ 的等差数列。例如，$\\{1,4,5,6,8,10,11\\}$ 当中，能挑选出来的最长的评分连续的序列是 $\\{4,5,6\\}$，因此对于这套方案，辉夜的满意度是 $3$。\n\n然而喜欢看乐子的辉夜，决定使用一种诡异的选择方式来折磨米斯蒂娅——\n\n1. 设当前一共有 $2k+1$ 种食材。这些食材被依次排开，米斯蒂娅将这些食材从左到右依次编号为 $1,2,3\\cdots (2k+1)$。\n2. 米斯蒂娅选择当前处于**中间位置**的材料（也就是编号为 $k+1$ 的材料），并加入最终食材。注意，加入最终食材的食材会被**移出**候选食材。\n3. 米斯蒂娅**任选**候选食材中的一种食材，**并移除**。保持剩余食材的相对位置不变。特别的，如果候选食材已空，那么米斯蒂娅不做任何操作。\n\n米斯蒂娅将会不断进行 $1\\sim3$ 操作，直到最终食材当中已经有了恰好 $n+1$ 种食材。她想知道，如果按照最优的操作方案，辉夜能获得的最大的满意度是多少。", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $2n + 1$ 个整数，表示每种食材的评分。", "outputFormat": "一行一个整数，表示按照最优操作方案能得到的最大满意度。", "hint": "#### 样例 1 解释\n\n$$\n\\def\\arraystretch{1.7}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{候选食材} & \\textbf{选择} & \\textbf{删除} & \\textbf{最终食材} \\cr\\hline\n4,7,3,6,1,2,5 & 6 & 1 & 6\\cr \\hline\n4,7,3,2,5 & 3 & 7 & 3,6\\cr \\hline\n4,2,5 & 2 & 5 & 2,3,6\\cr \\hline\n4 & 4 & - & 2,3,4,6\\cr \\hline\n\\end{array}$$\n\n此时最终食材中最长连续食材编号为 $\\{2,3,4\\}$ ，长度为 $3$ 。可以证明，没有更优方案。\n\n---\n\n#### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.7}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le} & \\textbf{特殊性质} & \\textbf{分值} \\cr\\hline\n1 & 5 & - & 10\\cr\\hline\n2 & 200 & - & 15\\cr\\hline\n3 & 800 & - & 15\\cr\\hline\n4 & 5\\times 10^3& - & 20\\cr\\hline\n5 & 2\\times 10^5& \\text{A} & 5\\cr\\hline\n6 & 2\\times 10^5& - & 35\\cr\\hline\n\\end{array}\n$$\n\n- 特殊性质 A ：保证 $\\forall i\\in[1,2n+1]$ 有 $A_i=i$ 。样例 3 即满足该性质。\n- 对于 $100\\%$ 的数据，有 $1 \\leq n \\leq 2 \\times 10^5$，并且 $A$ 是一个 $1 \\sim 2n+1$ 的排列。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdoi-3」夜雀 treating", "background": "经历了一整天的磨难，米斯蒂娅终于迎来了这一天最后一位客人——蓬莱山辉夜。\n\n作为永远亭的大小姐、月之都的公主，辉夜对于经营着平凡小吃摊的米斯蒂娅，向来是一个巨大的挑战。辉夜的口味极其挑剔，以至于米斯蒂娅常常难以满足她的需求。更棘手的是，如果辉夜认为米斯蒂娅招待不周，那么夜雀食堂的后果可能并不会比被幽幽子摧毁好多少。\n\n于是可怜的小夜雀只能向你求助了。", "description": "为了伺候这位主客，米斯蒂娅事先准备好了 $2n+1$ 种食材，并排成了一排，第 $i$ 种食材在左起第 $i$ 位，作为**预选食材**。\n\n接着，辉夜对所有食材进行了打分，每个食材被给予了一个在 $[1,2n+1]$ 当中的**互不相等**的分数。其中第 $i$ 种食材的评分为 $A_i$。\n\n由于月之民的奇怪癖好，辉夜喜欢一组连续的数字。因此，她对最终选出来的食材（不妨称为**最终食材**）的满意度，定义为将这些食材**按照其评分从小到大排序后**，其中**最长**的**评分连续**的食材的**长度**。评分连续，也就是这些食材的评分形成了公差为 $1$ 的等差数列。例如，$\\{1,4,5,6,8,10,11\\}$ 当中，能挑选出来的最长的评分连续的序列是 $\\{4,5,6\\}$，因此对于这套方案，辉夜的满意度是 $3$。\n\n然而喜欢看乐子的辉夜，决定使用一种诡异的选择方式来折磨米斯蒂娅——\n\n1. 设当前一共有 $2k+1$ 种食材。这些食材被依次排开，米斯蒂娅将这些食材从左到右依次编号为 $1,2,3\\cdots (2k+1)$。\n2. 米斯蒂娅选择当前处于**中间位置**的材料（也就是编号为 $k+1$ 的材料），并加入最终食材。注意，加入最终食材的食材会被**移出**候选食材。\n3. 米斯蒂娅**任选**候选食材中的一种食材，**并移除**。保持剩余食材的相对位置不变。特别的，如果候选食材已空，那么米斯蒂娅不做任何操作。\n\n米斯蒂娅将会不断进行 $1\\sim3$ 操作，直到最终食材当中已经有了恰好 $n+1$ 种食材。她想知道，如果按照最优的操作方案，辉夜能获得的最大的满意度是多少。", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $2n + 1$ 个整数，表示每种食材的评分。", "outputFormat": "一行一个整数，表示按照最优操作方案能得到的最大满意度。", "hint": "#### 样例 1 解释\n\n$$\n\\def\\arraystretch{1.7}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{候选食材} & \\textbf{选择} & \\textbf{删除} & \\textbf{最终食材} \\cr\\hline\n4,7,3,6,1,2,5 & 6 & 1 & 6\\cr \\hline\n4,7,3,2,5 & 3 & 7 & 3,6\\cr \\hline\n4,2,5 & 2 & 5 & 2,3,6\\cr \\hline\n4 & 4 & - & 2,3,4,6\\cr \\hline\n\\end{array}$$\n\n此时最终食材中最长连续食材编号为 $\\{2,3,4\\}$ ，长度为 $3$ 。可以证明，没有更优方案。\n\n---\n\n#### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.7}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le} & \\textbf{特殊性质} & \\textbf{分值} \\cr\\hline\n1 & 5 & - & 10\\cr\\hline\n2 & 200 & - & 15\\cr\\hline\n3 & 800 & - & 15\\cr\\hline\n4 & 5\\times 10^3& - & 20\\cr\\hline\n5 & 2\\times 10^5& \\text{A} & 5\\cr\\hline\n6 & 2\\times 10^5& - & 35\\cr\\hline\n\\end{array}\n$$\n\n- 特殊性质 A ：保证 $\\forall i\\in[1,2n+1]$ 有 $A_i=i$ 。样例 3 即满足该性质。\n- 对于 $100\\%$ 的数据，有 $1 \\leq n \\leq 2 \\times 10^5$，并且 $A$ 是一个 $1 \\sim 2n+1$ 的排列。", "locale": "zh-CN"}}}
{"pid": "P7839", "type": "P", "difficulty": 4, "samples": [["5 3 4\n1 2 1 4 5\n5 3 2 \n", "2\n"], ["10 7 9\n8 1 1 5 13 10 1 1 6 3 \n2 4 7 10 6 8 9 \n", "3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["贪心", "O2优化"], "title": "「Wdoi-3」夜雀 singing", "background": "“唉，今天可真是多事的一天呢。不过一晚的忙碌结束了，接下来就是我尽展歌喉的时刻啦！”\n\n作为幻想乡妖精中的一份子，米斯蒂娅在闲暇之余（也就是夜雀食堂闭店之后）也会去参加由夜雀们自发组织而成的夜雀歌会。夜雀们会按照一种约定好的方式进行歌唱。在今夜的歌会中，米斯蒂娅成为了歌会的组织者。\n\n然而因为大家都是夜雀，因此所谓的“舞台”其实是由若干个高度不一的树组成的。夜雀都会飞（显然），因此它们可以不断地变换自己的位置。\n\n然而，由于夜雀的数目实在是太多，以至于作为组织者的米斯蒂娅搞不清楚活动的组织方案了。你能帮帮她吗？", "description": "我们可以将这 $n$ 棵树从 $1$ 到 $n$ 编号。其中，在 $m$ 个点上分布着参加舞会的夜雀。第 $i$ 棵树的高度为 $h_i$ 。\n\n夜雀们的歌会一共会进行 $t$ 时刻。第 $i$ 个时刻，夜雀们**只能**在高度严格大于 $i$ 的树上唱歌。因为这些树木都是事先被选择好的，因此总是有 $\\max\\{h_i\\}>t$。夜雀们每个时刻，**可以选择站着不动**，或移动到**编号相邻**的一棵树上（例如，原先在编号为 $i$ 的树上的夜雀，下个时刻可以移动到编号为 $i-1$ 或者 $i+1$ 的树上。不过，她们不能移动到编号为 $0$ 或 $n+1$ 的树上）。初始时为第 $0$ 时刻。也就是说，假使一个夜雀初始时在高度为 $1$ 的树上，那么她下一时刻不得不去高度大于 $1$ 的树上。\n\n但这样一些夜雀可能无法顺利完成歌会，会遇到“无处可走”的情况，于是夜雀们决定选择若干个大树作为飞行点。如果一个夜雀到达了某个飞行点，那么下一时刻她除了能移动到编号相邻的树上，还能**到达其他的飞行点**。\n\n然而，飞行点太多容易使得歌会变得非常混乱。因此，米斯蒂娅希望最小化飞行点的数目。你能帮帮她吗？", "inputFormat": "第一行三个整数 $n,m,t$。含义如题面所示。  \n第二行 $n$ 个整数，第 $i$ 个整数表示 $h_i$。  \n第三行 $m$ 个整数，第 $i$ 个整数表示第 $i$ 只夜雀的位置 $p_i$。", "outputFormat": "输出一行，一个整数，表示最少的飞行点数量。", "hint": "#### 样例 1 解释\n\n一个最优方案是，分别在第 $2,5$ 棵树建立飞行点，下表为各夜雀的一个可行移动方案：\n\n$$\\def\\arraystretch{1.8}\n\\begin{array}{|c|c|c|c|} \\hline\n\\textsf{\\textbf{夜雀编号}} & \\textsf{\\textbf{时刻 $0$ 所在位置}} & \\textsf{\\textbf{时刻 $1$ 所在位置}} & \\textsf{\\textbf{时刻 $2 \\sim 4$ 所在位置}} \\cr\\hline\n\\textsf1 & 5 & 5 & 5 \\cr\\hline\n\\textsf2 & 3 & 2 & 5 \\cr\\hline\n\\textsf3 & 2 & 5 & 5 \\cr\\hline\n\\end{array}$$  \n\n可以证明不存在更优解。\n\n---\n\n#### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.6}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le} & \\textbf{特殊性质} & \\textbf{分值} \\cr\\hline\n1 & 16 & - & 15 \\cr\\hline\n2 & 5\\times 10^5 & \\text{A} & 5 \\cr\\hline\n3 & 5\\times 10^5 & \\text{B} & 15 \\cr\\hline\n4 & 10^3 & - & 25 \\cr\\hline\n5 & 5\\times 10^5 & - & 20 \\cr\\hline\n6 & 5\\times 10^6 & - & 20 \\cr\\hline\n\\end{array}$$\n\n- 特殊性质 A：$\\min(h_i) > t$。\n- 特殊性质 B：$t > n$ 且 $h_i \\in \\{1,t-1,t+1\\}$。\n\n对于 $100\\%$ 的数据，满足 $1 \\le n,m \\le 5 \\times 10^6$，$1 \\le h_i,t \\le 10^9$，$1 \\le p_i \\le n$。保证 $p$ 互不相同，且 $\\max(h_i) > t$。\n\n---\n    \n#### 提示\n\n显然你可以将所有位置都作为飞行点，然后在第 1 时刻让所有夜雀都飞到一棵 $h_i > t$ 的树来得到一组答案为 $n$ 的合法解。因此本题不会存在无解情况。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdoi-3」夜雀 singing", "background": "“唉，今天可真是多事的一天呢。不过一晚的忙碌结束了，接下来就是我尽展歌喉的时刻啦！”\n\n作为幻想乡妖精中的一份子，米斯蒂娅在闲暇之余（也就是夜雀食堂闭店之后）也会去参加由夜雀们自发组织而成的夜雀歌会。夜雀们会按照一种约定好的方式进行歌唱。在今夜的歌会中，米斯蒂娅成为了歌会的组织者。\n\n然而因为大家都是夜雀，因此所谓的“舞台”其实是由若干个高度不一的树组成的。夜雀都会飞（显然），因此它们可以不断地变换自己的位置。\n\n然而，由于夜雀的数目实在是太多，以至于作为组织者的米斯蒂娅搞不清楚活动的组织方案了。你能帮帮她吗？", "description": "我们可以将这 $n$ 棵树从 $1$ 到 $n$ 编号。其中，在 $m$ 个点上分布着参加舞会的夜雀。第 $i$ 棵树的高度为 $h_i$ 。\n\n夜雀们的歌会一共会进行 $t$ 时刻。第 $i$ 个时刻，夜雀们**只能**在高度严格大于 $i$ 的树上唱歌。因为这些树木都是事先被选择好的，因此总是有 $\\max\\{h_i\\}>t$。夜雀们每个时刻，**可以选择站着不动**，或移动到**编号相邻**的一棵树上（例如，原先在编号为 $i$ 的树上的夜雀，下个时刻可以移动到编号为 $i-1$ 或者 $i+1$ 的树上。不过，她们不能移动到编号为 $0$ 或 $n+1$ 的树上）。初始时为第 $0$ 时刻。也就是说，假使一个夜雀初始时在高度为 $1$ 的树上，那么她下一时刻不得不去高度大于 $1$ 的树上。\n\n但这样一些夜雀可能无法顺利完成歌会，会遇到“无处可走”的情况，于是夜雀们决定选择若干个大树作为飞行点。如果一个夜雀到达了某个飞行点，那么下一时刻她除了能移动到编号相邻的树上，还能**到达其他的飞行点**。\n\n然而，飞行点太多容易使得歌会变得非常混乱。因此，米斯蒂娅希望最小化飞行点的数目。你能帮帮她吗？", "inputFormat": "第一行三个整数 $n,m,t$。含义如题面所示。  \n第二行 $n$ 个整数，第 $i$ 个整数表示 $h_i$。  \n第三行 $m$ 个整数，第 $i$ 个整数表示第 $i$ 只夜雀的位置 $p_i$。", "outputFormat": "输出一行，一个整数，表示最少的飞行点数量。", "hint": "#### 样例 1 解释\n\n一个最优方案是，分别在第 $2,5$ 棵树建立飞行点，下表为各夜雀的一个可行移动方案：\n\n$$\\def\\arraystretch{1.8}\n\\begin{array}{|c|c|c|c|} \\hline\n\\textsf{\\textbf{夜雀编号}} & \\textsf{\\textbf{时刻 $0$ 所在位置}} & \\textsf{\\textbf{时刻 $1$ 所在位置}} & \\textsf{\\textbf{时刻 $2 \\sim 4$ 所在位置}} \\cr\\hline\n\\textsf1 & 5 & 5 & 5 \\cr\\hline\n\\textsf2 & 3 & 2 & 5 \\cr\\hline\n\\textsf3 & 2 & 5 & 5 \\cr\\hline\n\\end{array}$$  \n\n可以证明不存在更优解。\n\n---\n\n#### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.6}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le} & \\textbf{特殊性质} & \\textbf{分值} \\cr\\hline\n1 & 16 & - & 15 \\cr\\hline\n2 & 5\\times 10^5 & \\text{A} & 5 \\cr\\hline\n3 & 5\\times 10^5 & \\text{B} & 15 \\cr\\hline\n4 & 10^3 & - & 25 \\cr\\hline\n5 & 5\\times 10^5 & - & 20 \\cr\\hline\n6 & 5\\times 10^6 & - & 20 \\cr\\hline\n\\end{array}$$\n\n- 特殊性质 A：$\\min(h_i) > t$。\n- 特殊性质 B：$t > n$ 且 $h_i \\in \\{1,t-1,t+1\\}$。\n\n对于 $100\\%$ 的数据，满足 $1 \\le n,m \\le 5 \\times 10^6$，$1 \\le h_i,t \\le 10^9$，$1 \\le p_i \\le n$。保证 $p$ 互不相同，且 $\\max(h_i) > t$。\n\n---\n    \n#### 提示\n\n显然你可以将所有位置都作为飞行点，然后在第 1 时刻让所有夜雀都飞到一棵 $h_i > t$ 的树来得到一组答案为 $n$ 的合法解。因此本题不会存在无解情况。", "locale": "zh-CN"}}}
{"pid": "P7840", "type": "P", "difficulty": 4, "samples": [["4\n2 3 4 4", "28"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "O2优化", "凸完全单调性（wqs 二分）"], "title": "「C.E.L.U-03」重构", "background": "罗司机最近发现服务器运行速度很慢，于是他准备重构整个服务器的网络以提升效率。", "description": "罗司机有 $n$ 台服务器，每个服务器有一个繁忙度 $v_i$。罗司机将用 $n-1$ 条网络将它们连接在一起，于是每台服务器有一个连接网络数量 $d_i$。这个服务器网络运行的总时间是 $\\sum\\limits_{i=1}^nd_i^2v_i$。请你最小化这个值。", "inputFormat": "第一行一个数，$n$。  \n第二行 $n$ 个数，第 $i$ 个数代表 $v_i$。", "outputFormat": "第一行一个数，答案。  ", "hint": "**样例解释：**  \n连接 $1-2,1-4,2-3$ 三条边，度数分别为 $2,2,1,1$。\n\n|数据编号|$n$|特殊性质|\n|:-:|:-:|:-:|\n|$1$|$\\le5$|无|\n|$2\\sim 3$|$\\le300$|无|\n|$4\\sim 5$|$\\le3\\times10^3$|无|\n|$6$|$\\le3\\times10^4$|所有 $v_i$ 相等|\n|$7\\sim 8$|$\\le3\\times10^4$|无|\n|$9\\sim 10$|$\\le3\\times10^5$|无|  \n\n对于 $100\\%$ 的数据，$1\\leq n\\le3\\times10^5,1\\leq v_i\\le10^3$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「C.E.L.U-03」重构", "background": "罗司机最近发现服务器运行速度很慢，于是他准备重构整个服务器的网络以提升效率。", "description": "罗司机有 $n$ 台服务器，每个服务器有一个繁忙度 $v_i$。罗司机将用 $n-1$ 条网络将它们连接在一起，于是每台服务器有一个连接网络数量 $d_i$。这个服务器网络运行的总时间是 $\\sum\\limits_{i=1}^nd_i^2v_i$。请你最小化这个值。", "inputFormat": "第一行一个数，$n$。  \n第二行 $n$ 个数，第 $i$ 个数代表 $v_i$。", "outputFormat": "第一行一个数，答案。  ", "hint": "**样例解释：**  \n连接 $1-2,1-4,2-3$ 三条边，度数分别为 $2,2,1,1$。\n\n|数据编号|$n$|特殊性质|\n|:-:|:-:|:-:|\n|$1$|$\\le5$|无|\n|$2\\sim 3$|$\\le300$|无|\n|$4\\sim 5$|$\\le3\\times10^3$|无|\n|$6$|$\\le3\\times10^4$|所有 $v_i$ 相等|\n|$7\\sim 8$|$\\le3\\times10^4$|无|\n|$9\\sim 10$|$\\le3\\times10^5$|无|  \n\n对于 $100\\%$ 的数据，$1\\leq n\\le3\\times10^5,1\\leq v_i\\le10^3$。", "locale": "zh-CN"}}}
{"pid": "P7841", "type": "P", "difficulty": 6, "samples": [["2\n9\n9 5\n2 1\n9 8\n3 2\n5 6\n7 9\n4 3\n5 2\n3\n1 2\n2 3", "Play now\nRestart"], ["附加两组样例详见\nhttps://www.luogu.com.cn/paste/b6mh7ido", "附加两组样例详见\nhttps://www.luogu.com.cn/paste/b6mh7ido"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["博弈论", "O2优化", "树形 DP"], "title": "「C.E.L.U-03」100%不公平的游戏", "background": "今天 ice 出去玩了。原准备与 Alice 玩游戏的 Bob 只能和 Al 玩一场博弈游戏。", "description": "这个游戏是在树上进行的。Bob 先手。Bob 和 Al 轮流进行以下操作，首先无法操作者判负。\n\n- 在树上标记一条未被标记过的边。满足在每一次操作之后，存在一条简单路径遍历所有标记过的边。注意：这条简单路径**可以经过未标记过的边**。\n\n如果给定的树对于 Bob 有必胜方案，输出 `Play now`，否则输出 `Restart`。", "inputFormat": "本题多测，第一行输入一个整数表示数据组数 $T$。\n\n对于每组测试数据，第一行输入一个整数 $n$ 表示树的节点数。\n\n接下来 $n-1$ 行，每行输入两个整数 $u,v$ 表示 $(u,v)$ 是树上的一条边。", "outputFormat": "对于每组测试数据，输出一个字符串，大小写敏感。", "hint": "**样例数据也可见附件** $\\textbf{\\textit{game.in}/\\textit{game.out}}$。\n\n### 样例解释 1\n\n**第一组数据：**\n\n先手选择边 $(2,5)$ 必胜：  \n若后手选择 $(1,2)$，先手选择 $(5,6)$ 可以获胜。  \n若后手选择 $(2,3)$，先手选择 $(5,9)$ 可以获胜。  \n若后手选择 $(3,4)$，先手选择 $(5,9)$ 可以获胜。  \n若后手选择 $(5,6)$，先手选择 $(1,2)$ 可以获胜。  \n若后手选择 $(5,9)$，先手选择 $(3,4)$ 可以获胜。  \n若后手选择 $(7,9)$，先手选择 $(2,3)$ 可以获胜。  \n若后手选择 $(8,9)$，先手选择 $(3,4)$ 可以获胜。  \n综上，无论后手选那一条边，都不会获得胜利。  \n\n**第二组数据：**\n\n先手不存在必胜策略：  \n若先手选择 $(1,2)$，后手选择 $(2,3)$ 获胜。  \n若先手选择 $(2,3)$，后手选择 $(1,2)$ 获胜。\n\n\n### 样例解释 2\n\n各组数据详见下图，其中前两组数据与样例一相同。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/imht95gt.png)\n\n---\n\n### 数据范围\n\n$2\\leq n\\leq5\\times10^5$\n\n$1\\leq T\\leq10^4$\n\n$\\sum n\\leq1.5\\times10^6$\n\n数据保证给定的图是一棵树。\n\n### 子任务  \n1. （8分）$n\\leq6$。\n2. （18分）$n\\leq12,T\\leq10$。\n3. （6分） $n\\leq28,T\\leq10$。\n4. （8分）$n\\leq200,T\\leq10$。\n5. （30分）$n\\leq2000,T\\leq10$。\n6. （6分）最多存在两个节点度数大于 $2$。\n7. （12分）树的形态是一棵完全二叉树。\n8. （12分）无特殊性质。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「C.E.L.U-03」100%不公平的游戏", "background": "今天 ice 出去玩了。原准备与 Alice 玩游戏的 Bob 只能和 Al 玩一场博弈游戏。", "description": "这个游戏是在树上进行的。Bob 先手。Bob 和 Al 轮流进行以下操作，首先无法操作者判负。\n\n- 在树上标记一条未被标记过的边。满足在每一次操作之后，存在一条简单路径遍历所有标记过的边。注意：这条简单路径**可以经过未标记过的边**。\n\n如果给定的树对于 Bob 有必胜方案，输出 `Play now`，否则输出 `Restart`。", "inputFormat": "本题多测，第一行输入一个整数表示数据组数 $T$。\n\n对于每组测试数据，第一行输入一个整数 $n$ 表示树的节点数。\n\n接下来 $n-1$ 行，每行输入两个整数 $u,v$ 表示 $(u,v)$ 是树上的一条边。", "outputFormat": "对于每组测试数据，输出一个字符串，大小写敏感。", "hint": "**样例数据也可见附件** $\\textbf{\\textit{game.in}/\\textit{game.out}}$。\n\n### 样例解释 1\n\n**第一组数据：**\n\n先手选择边 $(2,5)$ 必胜：  \n若后手选择 $(1,2)$，先手选择 $(5,6)$ 可以获胜。  \n若后手选择 $(2,3)$，先手选择 $(5,9)$ 可以获胜。  \n若后手选择 $(3,4)$，先手选择 $(5,9)$ 可以获胜。  \n若后手选择 $(5,6)$，先手选择 $(1,2)$ 可以获胜。  \n若后手选择 $(5,9)$，先手选择 $(3,4)$ 可以获胜。  \n若后手选择 $(7,9)$，先手选择 $(2,3)$ 可以获胜。  \n若后手选择 $(8,9)$，先手选择 $(3,4)$ 可以获胜。  \n综上，无论后手选那一条边，都不会获得胜利。  \n\n**第二组数据：**\n\n先手不存在必胜策略：  \n若先手选择 $(1,2)$，后手选择 $(2,3)$ 获胜。  \n若先手选择 $(2,3)$，后手选择 $(1,2)$ 获胜。\n\n\n### 样例解释 2\n\n各组数据详见下图，其中前两组数据与样例一相同。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/imht95gt.png)\n\n---\n\n### 数据范围\n\n$2\\leq n\\leq5\\times10^5$\n\n$1\\leq T\\leq10^4$\n\n$\\sum n\\leq1.5\\times10^6$\n\n数据保证给定的图是一棵树。\n\n### 子任务  \n1. （8分）$n\\leq6$。\n2. （18分）$n\\leq12,T\\leq10$。\n3. （6分） $n\\leq28,T\\leq10$。\n4. （8分）$n\\leq200,T\\leq10$。\n5. （30分）$n\\leq2000,T\\leq10$。\n6. （6分）最多存在两个节点度数大于 $2$。\n7. （12分）树的形态是一棵完全二叉树。\n8. （12分）无特殊性质。", "locale": "zh-CN"}}}
{"pid": "P7842", "type": "P", "difficulty": 6, "samples": [["3 3 1\n1 1 2\n2 1 1\n2 2 1 2\n3 2 1 3", "4"], ["4 6 2\n1 1 3 2\n3 3 1 2 3\n2 2 2 3\n3 3 2 3 4\n2 2 1 3\n4 3 1 3 4\n6 4 1 2 3 4", "12"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384]}, "tags": ["cdq 分治", "O2优化", "位运算"], "title": "「C.E.L.U-03」探险者笔记 III", "background": "罗司机在通关小 Soup 所制作的游戏《探险者笔记》后，感到十分的悲伤。为了缓解内心的伤痛，他决定改制《探险者笔记》，使其成为一个快乐的游戏。  \n一段时间之后，罗司机完成了制作，并喊来小 Soup 给他测试。", "description": "改制后的《探险者笔记》由 $n$ 个关卡组成，每个关卡有一个难度 $b_i$，同时有 $m$ 个成就，第 $i$ 个成就需要你恰好完成 $sum_i$ 个关卡，且**刚好**分别是 $a_{i_1},a_{i_2},...,a_{i_{sum_i}}$。完成第 $i$ 个成就可以得到 $v_i$ 的分数。  \n如果长时间推关而没有获得任何成就，小 Soup 会感到疲乏。而且成就的解锁是有一定顺序的。因此上一个获得第 $i$ 个成就接下来再获得第 $j$ 个成就的条件是 $i<j$ 且 $w+\\sum\\limits_{k=1}^{sum_i}b_{a_{i_k}}\\ge\\sum\\limits_{k=1}^{sum_j}b_{a_{j_k}}$，其中 $w$ 是一个给定的常数。  \n第一次获得成就没有任何限制。求最多他能得到多少分数。", "inputFormat": "第一行三个数 $n,m,w$。  \n第二行 $n$ 个数，$b_i$。  \n接下来 $m$ 行，第 $i$ 行一开始有两个数，$v_i,sum_i$，接下来会有 $sum_i$ 个数，$a_{i_1},a_{i_2},...,a_{i_{sum_i}}$。", "outputFormat": "仅一个数，答案。", "hint": "### 样例解释\n\n**样例解释一**    \n依次完成第 $1,2$ 个成就。  \n\n**样例解释二**    \n依次完成第 $4,5,6$ 个成就。注意，成就之间的限制**只在相邻获得的成就之间生效。**\n\n### 数据范围\n|数据编号|$n\\leq$|$m\\leq$|\n|:---:|:---:|:---:|\n|$1$|$9$|$10^3$|\n|$2$|$18$|$10^3$|\n|$3\\sim 6$|$9$|$10^5$|\n|$7\\sim 10$|$18$|$10^5$|\n\n对于 $100\\%$ 的数据 $1\\le n\\le18,1\\le m\\le10^5,1\\le sum_i\\le18,1\\le w,b_i,v_i\\le10^3,1\\le a_i\\le n$。  \n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「C.E.L.U-03」探险者笔记 III", "background": "罗司机在通关小 Soup 所制作的游戏《探险者笔记》后，感到十分的悲伤。为了缓解内心的伤痛，他决定改制《探险者笔记》，使其成为一个快乐的游戏。  \n一段时间之后，罗司机完成了制作，并喊来小 Soup 给他测试。", "description": "改制后的《探险者笔记》由 $n$ 个关卡组成，每个关卡有一个难度 $b_i$，同时有 $m$ 个成就，第 $i$ 个成就需要你恰好完成 $sum_i$ 个关卡，且**刚好**分别是 $a_{i_1},a_{i_2},...,a_{i_{sum_i}}$。完成第 $i$ 个成就可以得到 $v_i$ 的分数。  \n如果长时间推关而没有获得任何成就，小 Soup 会感到疲乏。而且成就的解锁是有一定顺序的。因此上一个获得第 $i$ 个成就接下来再获得第 $j$ 个成就的条件是 $i<j$ 且 $w+\\sum\\limits_{k=1}^{sum_i}b_{a_{i_k}}\\ge\\sum\\limits_{k=1}^{sum_j}b_{a_{j_k}}$，其中 $w$ 是一个给定的常数。  \n第一次获得成就没有任何限制。求最多他能得到多少分数。", "inputFormat": "第一行三个数 $n,m,w$。  \n第二行 $n$ 个数，$b_i$。  \n接下来 $m$ 行，第 $i$ 行一开始有两个数，$v_i,sum_i$，接下来会有 $sum_i$ 个数，$a_{i_1},a_{i_2},...,a_{i_{sum_i}}$。", "outputFormat": "仅一个数，答案。", "hint": "### 样例解释\n\n**样例解释一**    \n依次完成第 $1,2$ 个成就。  \n\n**样例解释二**    \n依次完成第 $4,5,6$ 个成就。注意，成就之间的限制**只在相邻获得的成就之间生效。**\n\n### 数据范围\n|数据编号|$n\\leq$|$m\\leq$|\n|:---:|:---:|:---:|\n|$1$|$9$|$10^3$|\n|$2$|$18$|$10^3$|\n|$3\\sim 6$|$9$|$10^5$|\n|$7\\sim 10$|$18$|$10^5$|\n\n对于 $100\\%$ 的数据 $1\\le n\\le18,1\\le m\\le10^5,1\\le sum_i\\le18,1\\le w,b_i,v_i\\le10^3,1\\le a_i\\le n$。  \n\n", "locale": "zh-CN"}}}
{"pid": "P7843", "type": "P", "difficulty": 7, "samples": [["3 4 2\n1 0 2 0\n1 1 3 0\n3 0 2 0\n1 1 2 1\n1 3\n3 4", "2\n1"], ["4 5 3\n1 1 2 1\n2 0 3 0\n4 1 1 0\n2 1 4 0\n4 0 3 0\n1 4\n2 5\n3 5", "1\n2\n1"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["倍增", "O2优化", "2-SAT", "动态树 LCT", "整体二分"], "title": "「C.E.L.U-03」布尔", "background": "", "description": "给你 $n$ 个布尔变量和 $m$ 个限制，设 $s_i$ 为 $i$ 的取值。第 $i$ 个限制形如 $s_{u_i}$ 为 $x_i$ 则 $s_{v_i}$ 必须为 $y_i$，同时如果 $s_{v_i}$ 为 $y_i$ 则 $s_{u_i}$ 必须取 $x_i$。  \n一共 $q$ 次询问，每次询问给出一个区间 $l,r$。求最少把 $l,r$ 划分成多少段连续的区间，使得每段里的限制都可以得到一组合法解。如果无论如何都无法得到合法解，输出 `-1`。", "inputFormat": "第一行三个数，$n,m,q$。  \n接下来 $m$ 行每行四个数，代表 $u_i,x_i,v_i,y_i$。  \n接下来 $q$ 行每行两个数，代表 $l_i,r_i$。", "outputFormat": "对于每个询问输出一个数作为答案，如果无法得到答案输出 `-1`。", "hint": "**样例解释一**   \n对于第一个询问，可以分成 $[1,2]$ 和 $3$ 两段。  \n对于第二个询问，分成 $[3,4]$  一段。  \n\n**样例解释二**   \n对于第一个询问，分成 $[1,4]$  一段。  \n对于第二个询问，可以分成 $[2,3]$ 和 $[4,5]$ 两段。  \n对于第三个询问，分成 $[3,5]$  一段。  \n\n| 数据编号| $n\\leq$ | $m\\leq$| $q\\leq$|\n|:---:|:---:|:---:|:---:|\n|$1$|$30$|$100$|$300$|\n|$2\\sim 4$|$300$|$10^3$|$10^3$|\n|$5\\sim 7$|$10^4$|$5\\times10^4$|$10^6$|  \n|$8\\sim 10$|$10^5$|$6\\times10^5$|$10^6$|   \n\n对于 $100\\%$ 的数据，$1\\le n\\le10^5,1\\le m\\le6\\times10^5,1\\le q\\le10^6,1\\le u,v\\le n,1\\le l\\le r\\le m,x,y\\in \\{0,1\\}$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「C.E.L.U-03」布尔", "background": "", "description": "给你 $n$ 个布尔变量和 $m$ 个限制，设 $s_i$ 为 $i$ 的取值。第 $i$ 个限制形如 $s_{u_i}$ 为 $x_i$ 则 $s_{v_i}$ 必须为 $y_i$，同时如果 $s_{v_i}$ 为 $y_i$ 则 $s_{u_i}$ 必须取 $x_i$。  \n一共 $q$ 次询问，每次询问给出一个区间 $l,r$。求最少把 $l,r$ 划分成多少段连续的区间，使得每段里的限制都可以得到一组合法解。如果无论如何都无法得到合法解，输出 `-1`。", "inputFormat": "第一行三个数，$n,m,q$。  \n接下来 $m$ 行每行四个数，代表 $u_i,x_i,v_i,y_i$。  \n接下来 $q$ 行每行两个数，代表 $l_i,r_i$。", "outputFormat": "对于每个询问输出一个数作为答案，如果无法得到答案输出 `-1`。", "hint": "**样例解释一**   \n对于第一个询问，可以分成 $[1,2]$ 和 $3$ 两段。  \n对于第二个询问，分成 $[3,4]$  一段。  \n\n**样例解释二**   \n对于第一个询问，分成 $[1,4]$  一段。  \n对于第二个询问，可以分成 $[2,3]$ 和 $[4,5]$ 两段。  \n对于第三个询问，分成 $[3,5]$  一段。  \n\n| 数据编号| $n\\leq$ | $m\\leq$| $q\\leq$|\n|:---:|:---:|:---:|:---:|\n|$1$|$30$|$100$|$300$|\n|$2\\sim 4$|$300$|$10^3$|$10^3$|\n|$5\\sim 7$|$10^4$|$5\\times10^4$|$10^6$|  \n|$8\\sim 10$|$10^5$|$6\\times10^5$|$10^6$|   \n\n对于 $100\\%$ 的数据，$1\\le n\\le10^5,1\\le m\\le6\\times10^5,1\\le q\\le10^6,1\\le u,v\\le n,1\\le l\\le r\\le m,x,y\\in \\{0,1\\}$", "locale": "zh-CN"}}}
{"pid": "P7844", "type": "P", "difficulty": 6, "samples": [["3 3\n1 2 3 4 5 6 7 8", "288 831546728 224054051 383438562 998244321 614805727 774190238 166697561"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": [], "title": "「dWoi R2」FFT / 狒狒贴", "background": "狱原权太正在尝试学习 FFT ……", "description": "给定一个长度为 $2^n$ 的非负整数序列 $a_0,a_1,\\cdots,a_{2^n-1}$，请计算序列 $A=\\text{DFT}^k(a)$。\n\n其中 $\\text{DFT}(b)_i$ 定义为：\n\n$$\\text{DFT}(b)_i=\\sum_{j=0}^{2^n-1}b_j\\omega^{ij}\\mod{998244353}$$\n$$\\omega\\equiv3^{\\frac{998244352}{2^n}}\\pmod{998244353}$$", "inputFormat": "第一行两个非负整数 $n,k$。\n\n接下来一行 $2^n$ 个非负整数 $a_0,a_1,\\cdots,a_{2^n-1}$。", "outputFormat": "一行 $2^n$ 个非负整数 $A_0,A_1,\\cdots,A_{2^n-1}$。", "hint": "#### 数据规模与约定\n\n - Subtask 1（10 pts）：$n\\le 11$ 且 $k\\le 10$；\n - Subtask 2（10 pts）：$k\\le 10$；\n - Subtask 3（20 pts）：$n\\le 5$；\n - Subtask 4（30 pts）：$n\\le 11$；\n - Subtask 5（30 pts）：无额外限制。\n\n对于所有数据，$1\\le n\\le 17$，$1\\le k\\le10^{18}$，$0\\le a_i\\le 998244353$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「dWoi R2」FFT / 狒狒贴", "background": "狱原权太正在尝试学习 FFT ……", "description": "给定一个长度为 $2^n$ 的非负整数序列 $a_0,a_1,\\cdots,a_{2^n-1}$，请计算序列 $A=\\text{DFT}^k(a)$。\n\n其中 $\\text{DFT}(b)_i$ 定义为：\n\n$$\\text{DFT}(b)_i=\\sum_{j=0}^{2^n-1}b_j\\omega^{ij}\\mod{998244353}$$\n$$\\omega\\equiv3^{\\frac{998244352}{2^n}}\\pmod{998244353}$$", "inputFormat": "第一行两个非负整数 $n,k$。\n\n接下来一行 $2^n$ 个非负整数 $a_0,a_1,\\cdots,a_{2^n-1}$。", "outputFormat": "一行 $2^n$ 个非负整数 $A_0,A_1,\\cdots,A_{2^n-1}$。", "hint": "#### 数据规模与约定\n\n - Subtask 1（10 pts）：$n\\le 11$ 且 $k\\le 10$；\n - Subtask 2（10 pts）：$k\\le 10$；\n - Subtask 3（20 pts）：$n\\le 5$；\n - Subtask 4（30 pts）：$n\\le 11$；\n - Subtask 5（30 pts）：无额外限制。\n\n对于所有数据，$1\\le n\\le 17$，$1\\le k\\le10^{18}$，$0\\le a_i\\le 998244353$。", "locale": "zh-CN"}}}
{"pid": "P7845", "type": "P", "difficulty": 5, "samples": [["8 8 1 10\n1 2\n1 3\n1 4\n2 5\n3 5\n5 6\n6 7\n6 8", "6"], ["3 2 1 3\n1 2\n1 3", "332748119"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["图论", "拓扑排序"], "title": "「dWoi R2」Change / 改造", "background": "入间改造对人类生存繁殖有帮助的工具（~~就是性能工具，具体可以去看看弹丸论破 V3 自由时间与入间美兔的交谈，在这里不方便说吧，毕竟是 青 少 年 编 程 网 站~~）玩腻了，她发现了有一个很 符 合 她 胃 口 的东西，叫做 Galgame，于是她开始打一款叫做 Little Busters 的 Galgame，然后沉迷上了沙耶线最后的场景。\n\n---\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/vxy5rh6c.png)\n", "description": "在经过 $99$ 次的 Replay 后，沙耶终于发现迷宫是一个有向无环图。为了保证最后一次 Replay 的趣味性，时风瞬给沙耶和理树安排了一个小游戏。\n\n这张有向无环图 $G$ 有 $n$ 个点，$m$ 条边，每条边的长度为 $1$。设 $l_i$ 为初始点 $s$ 到第 $i$ 条边所指向的点 $u$ 的最短路，定义第 $i$ 条边的边权为 $p-l_i$。游戏步骤是这样的（所有选择都是按如下顺序进行，并且每个人的选择都是公开的）。\n\n1. 理树站在点 $s$ 上。  \n2. 时风瞬会随机选取一个点作为 $t$（$t$ 可以等于 $s$）。\n3. 如果无法从 $s$ 到达 $t$，游戏直接结束。\n3. 沙耶需要选择一条边。\n4. 理树需要找到一条从 $s$ 到 $t$ 的路径。\n5. 若沙耶选择的边在理树所选择的路径上，则理树就会将这条边的边权的钱给沙耶。\n\n理树希望能少输钱，沙耶希望能多拿钱。若两方都采取最优策略，请问沙耶期望能得到多少钱。", "inputFormat": "第一行四个整数 $n,m,s,p$，分别代表有向图点数，边数与理树站在的位置，以及题目中出现的 $p$。\n\n接下来 $m$ 行每行两个整数 $u_i,v_i$ 描述一条边。", "outputFormat": "一行一个整数代表答案。\n\n请对 $998244353$ 取模。", "hint": "#### 样例 1 解释\n\n比如 $t=6$ 时，沙耶应该选择连接 $5,6$ 的那条边；$t=8$ 时，沙耶仍然应该选择连接 $5,6$ 的那条边；$t=4$ 时，应该选择连接 $1,4$ 的那条边；$t=5$ 时，沙耶无论选择什么边都不会得到钱。\n\n设 $res_u$ 表示 $t=u$ 时沙耶能获得的最大收益，我们有 $res=\\{0,9,9,9,0,7,7,7\\}$。\n\n#### 样例 2 解释\n\n设 $res_u$ 表示 $t=u$ 时沙耶能获得的最大收益，我们有 $res=\\{0,2,2\\}$。\n\n---\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（10 pts）：$n,m \\le 5$；\n- Subtask 2（20 pts）：$m=n-1$，$u_i<v_i$，$s=1$；\n- Subtask 3（30 pts）：$n,m \\le 10^3$；\n- Subtask 4（40 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n,m \\le 5 \\times 10^6$，$1 \\le s \\le n$，$1 \\le u_i,v_i \\le n$，$u_i \\ne v_i$，$n\\le p \\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「dWoi R2」Change / 改造", "background": "入间改造对人类生存繁殖有帮助的工具（~~就是性能工具，具体可以去看看弹丸论破 V3 自由时间与入间美兔的交谈，在这里不方便说吧，毕竟是 青 少 年 编 程 网 站~~）玩腻了，她发现了有一个很 符 合 她 胃 口 的东西，叫做 Galgame，于是她开始打一款叫做 Little Busters 的 Galgame，然后沉迷上了沙耶线最后的场景。\n\n---\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/vxy5rh6c.png)\n", "description": "在经过 $99$ 次的 Replay 后，沙耶终于发现迷宫是一个有向无环图。为了保证最后一次 Replay 的趣味性，时风瞬给沙耶和理树安排了一个小游戏。\n\n这张有向无环图 $G$ 有 $n$ 个点，$m$ 条边，每条边的长度为 $1$。设 $l_i$ 为初始点 $s$ 到第 $i$ 条边所指向的点 $u$ 的最短路，定义第 $i$ 条边的边权为 $p-l_i$。游戏步骤是这样的（所有选择都是按如下顺序进行，并且每个人的选择都是公开的）。\n\n1. 理树站在点 $s$ 上。  \n2. 时风瞬会随机选取一个点作为 $t$（$t$ 可以等于 $s$）。\n3. 如果无法从 $s$ 到达 $t$，游戏直接结束。\n3. 沙耶需要选择一条边。\n4. 理树需要找到一条从 $s$ 到 $t$ 的路径。\n5. 若沙耶选择的边在理树所选择的路径上，则理树就会将这条边的边权的钱给沙耶。\n\n理树希望能少输钱，沙耶希望能多拿钱。若两方都采取最优策略，请问沙耶期望能得到多少钱。", "inputFormat": "第一行四个整数 $n,m,s,p$，分别代表有向图点数，边数与理树站在的位置，以及题目中出现的 $p$。\n\n接下来 $m$ 行每行两个整数 $u_i,v_i$ 描述一条边。", "outputFormat": "一行一个整数代表答案。\n\n请对 $998244353$ 取模。", "hint": "#### 样例 1 解释\n\n比如 $t=6$ 时，沙耶应该选择连接 $5,6$ 的那条边；$t=8$ 时，沙耶仍然应该选择连接 $5,6$ 的那条边；$t=4$ 时，应该选择连接 $1,4$ 的那条边；$t=5$ 时，沙耶无论选择什么边都不会得到钱。\n\n设 $res_u$ 表示 $t=u$ 时沙耶能获得的最大收益，我们有 $res=\\{0,9,9,9,0,7,7,7\\}$。\n\n#### 样例 2 解释\n\n设 $res_u$ 表示 $t=u$ 时沙耶能获得的最大收益，我们有 $res=\\{0,2,2\\}$。\n\n---\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（10 pts）：$n,m \\le 5$；\n- Subtask 2（20 pts）：$m=n-1$，$u_i<v_i$，$s=1$；\n- Subtask 3（30 pts）：$n,m \\le 10^3$；\n- Subtask 4（40 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n,m \\le 5 \\times 10^6$，$1 \\le s \\le n$，$1 \\le u_i,v_i \\le n$，$u_i \\ne v_i$，$n\\le p \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P7846", "type": "P", "difficulty": 4, "samples": [["3 3\n1 2 0\n1 3 0", "12 4"], ["9 3\n1 2 0\n1 3 1\n1 4 1\n2 5 2\n2 6 1\n6 7 0\n4 8 2\n4 9 0", "648 12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["树形 DP"], "title": "「dWoi R2」Arcade hall / 街机厅", "background": "众所周知，才囚学院地下有一个街机厅，~~百田被星龙马打败了 114514 次~~。\n\n百田不服气，于是他打开了一个单人游戏 —— 先辈的城市。\n\n---\n\n114514 年，火星，幺舅幺舅巴以灵国。\n\n因为有小可爱提出题面过于冗长，所以下方有 **简要题面**。", "description": "幺舅幺舅巴以灵国一共有 $n$ 个城市，他们之间用一种神奇的通讯工具 —— 先辈符，第 $i$ 个城市的先辈符上刻有一个正整数 $w_i$。这 $n$ 个城市之前有 $n-1$ 条道路，第 $j$ 条道路连接第 $u_j$ 个城市和第 $v_j$ 个城市，有一个属性 $t_j$，这一条道路就表示为 $(u_j,v_j,t_j)$，其中 $t_j \\in \\{0,1,2\\}$，意为：\n\n- $t_j=0$ 时，第 $u_j$ 个城市与第 $v_j$ 个城市是敌对关系；\n- $t_j=1$ 时，第 $u_j$ 个城市与第 $v_j$ 个城市是平等关系；\n- $t_j=2$ 时，第 $u_j$ 个城市与第 $v_j$ 个城市是友好关系。\n\n每一条道路都是双向的，并且保证任意两个城市 $u,v$ 之间都是可以互相到达的。\n\n最近火星发生了 MARS-514 病毒疫情，先辈符系统的修建要加快脚步。我们规定：\n\n- $w_i \\in [1,R]$，且是一个正整数；\n- 对于一条道路 $(p,q,r)$，有如下要求：\n\t- 当 $r=0$ 时，即第 $p$ 个城市与第 $q$ 个城市处于敌对关系时，需要保证 $w_p \\ne w_q$；\n    - 当 $r=2$ 时，即第 $p$ 个城市与第 $q$ 个城市处于友好关系时，需要保证 $w_p=w_q$；\n    - 当 $r=1$ 时，即第 $p$ 个城市与第 $q$ 个城市处于平等关系时，不需要保证 $w_p$ 与 $w_q$ 的大小关系。\n    \n求这样分配 $w_i$ 后，将 $w_i$ 作为一个序列，会形成多少个本质不同的序列 $w_i$。\n\n额外地，幺舅幺舅巴以灵国的统治者浩二结节在建造先辈符发现 $w_i$ 越大，用墨就会越多，建造起来也会越困难，所以浩二结节想知道 $w_i$ 的和的最小值是多少。\n\n注意，本题的序列 $A_i$ 与 $B_i$ 本质相同当且仅当对于所有 $i$ 都有 $A_i=B_i$。\n\n本质不同即为不满足本质相同的两个序列。\n\n---\n\n**简要题面**：\n\n- 有一棵 $n$ 个点的树，第 $i$ 个点有点权 $w_i$，第 $j$ 条边有边权 $t_j$；\n- 每一条边 $(u_j,v_j,t_j)$ 两边点的点权有如下要求：\n\t- $t_j=0$，$w_{u_j} \\ne w_{v_j}$；\n    - $t_j=1$，没有要求；\n    - $t_j=2$，$w_{u_j}=w_{v_j}$；\n    - 对任意点权都要有 $w_i \\in [1,R]$；\n- 求当 $w_i$ 作为序列时，一共有多少种本质不同的序列 $w_i$ 以及 $w_i$ 的和的最小值。", "inputFormat": "第一行两个整数 $n,R$ 代表城市数与值域。\n\n接下来 $n-1$ 行每行三个整数 $u_j,v_j,t_j$ 描述一条道路。", "outputFormat": "一行两个整数分别代表满足要求的本质不同的序列 $w_i$ 的个数和 $w_i$ 的和的最小值。\n\n如果不存在本质不同的序列（即第一问答案为 $0$），第二问也请输出一个 $0$。\n\n**只有第一问答案对 $10^9+7$ 取模。**", "hint": "#### 样例 1 解释\n\n样例中的道路分布如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/vq4dukx8.png)\n\n一共有 $12$ 种赋值方式：\n\n1. $w_i=\\{1,2,2\\}$；\n2. $w_i=\\{1,2,3\\}$；\n3. $w_i=\\{1,3,2\\}$；\n4. $w_i=\\{1,3,3\\}$；\n5. $w_i= \\bf \\{2,1,1\\}$，这是最优情况；\n6. $w_i=\\{2,1,3\\}$；\n7. $w_i=\\{2,3,1\\}$；\n8. $w_i=\\{2,3,3\\}$；\n9. $w_i=\\{3,1,1\\}$；\n10. $w_i=\\{3,1,2\\}$；\n11. $w_i=\\{3,2,1\\}$；\n12. $w_i=\\{3,2,2\\}$。\n\n#### 样例 2 解释\n\n样例中的道路分布如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9f1qjpm4.png)\n\n对于第二问，其中一种最优的赋值方式是：$w_i=\\{2,1,1,1,1,1,2,1,2\\}$。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（5 pts）：$t_j=1$ 或 $t_j=2$；\n- Subtask 2（5 pts）：$R=1$；\n- Subtask 3（10 pts）：$u_j=j$，$v_j=j+1$；\n- Subtask 4（20 pts）：$t_j=0$；\n- Subtask 5（10 pts）：$n \\le 10$，$R \\le 5$；\n- Subtask 6（50 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^5$，$1 \\le R \\le 100$。\n\n对于 Subtask 1 ~ 5，$R \\le 40$。\n\n上面描述 Subtask 时 $t_j=P$ 即为对于所有 $j \\in [1,n)$ 都有 $t_j=P$。\n\n其中对于 Subtask 1，“或” 意为 Subtask\n1 的一部分测试点满足 $t_j=1$，另一部分测试点满足 $t_j=2$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「dWoi R2」Arcade hall / 街机厅", "background": "众所周知，才囚学院地下有一个街机厅，~~百田被星龙马打败了 114514 次~~。\n\n百田不服气，于是他打开了一个单人游戏 —— 先辈的城市。\n\n---\n\n114514 年，火星，幺舅幺舅巴以灵国。\n\n因为有小可爱提出题面过于冗长，所以下方有 **简要题面**。", "description": "幺舅幺舅巴以灵国一共有 $n$ 个城市，他们之间用一种神奇的通讯工具 —— 先辈符，第 $i$ 个城市的先辈符上刻有一个正整数 $w_i$。这 $n$ 个城市之前有 $n-1$ 条道路，第 $j$ 条道路连接第 $u_j$ 个城市和第 $v_j$ 个城市，有一个属性 $t_j$，这一条道路就表示为 $(u_j,v_j,t_j)$，其中 $t_j \\in \\{0,1,2\\}$，意为：\n\n- $t_j=0$ 时，第 $u_j$ 个城市与第 $v_j$ 个城市是敌对关系；\n- $t_j=1$ 时，第 $u_j$ 个城市与第 $v_j$ 个城市是平等关系；\n- $t_j=2$ 时，第 $u_j$ 个城市与第 $v_j$ 个城市是友好关系。\n\n每一条道路都是双向的，并且保证任意两个城市 $u,v$ 之间都是可以互相到达的。\n\n最近火星发生了 MARS-514 病毒疫情，先辈符系统的修建要加快脚步。我们规定：\n\n- $w_i \\in [1,R]$，且是一个正整数；\n- 对于一条道路 $(p,q,r)$，有如下要求：\n\t- 当 $r=0$ 时，即第 $p$ 个城市与第 $q$ 个城市处于敌对关系时，需要保证 $w_p \\ne w_q$；\n    - 当 $r=2$ 时，即第 $p$ 个城市与第 $q$ 个城市处于友好关系时，需要保证 $w_p=w_q$；\n    - 当 $r=1$ 时，即第 $p$ 个城市与第 $q$ 个城市处于平等关系时，不需要保证 $w_p$ 与 $w_q$ 的大小关系。\n    \n求这样分配 $w_i$ 后，将 $w_i$ 作为一个序列，会形成多少个本质不同的序列 $w_i$。\n\n额外地，幺舅幺舅巴以灵国的统治者浩二结节在建造先辈符发现 $w_i$ 越大，用墨就会越多，建造起来也会越困难，所以浩二结节想知道 $w_i$ 的和的最小值是多少。\n\n注意，本题的序列 $A_i$ 与 $B_i$ 本质相同当且仅当对于所有 $i$ 都有 $A_i=B_i$。\n\n本质不同即为不满足本质相同的两个序列。\n\n---\n\n**简要题面**：\n\n- 有一棵 $n$ 个点的树，第 $i$ 个点有点权 $w_i$，第 $j$ 条边有边权 $t_j$；\n- 每一条边 $(u_j,v_j,t_j)$ 两边点的点权有如下要求：\n\t- $t_j=0$，$w_{u_j} \\ne w_{v_j}$；\n    - $t_j=1$，没有要求；\n    - $t_j=2$，$w_{u_j}=w_{v_j}$；\n    - 对任意点权都要有 $w_i \\in [1,R]$；\n- 求当 $w_i$ 作为序列时，一共有多少种本质不同的序列 $w_i$ 以及 $w_i$ 的和的最小值。", "inputFormat": "第一行两个整数 $n,R$ 代表城市数与值域。\n\n接下来 $n-1$ 行每行三个整数 $u_j,v_j,t_j$ 描述一条道路。", "outputFormat": "一行两个整数分别代表满足要求的本质不同的序列 $w_i$ 的个数和 $w_i$ 的和的最小值。\n\n如果不存在本质不同的序列（即第一问答案为 $0$），第二问也请输出一个 $0$。\n\n**只有第一问答案对 $10^9+7$ 取模。**", "hint": "#### 样例 1 解释\n\n样例中的道路分布如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/vq4dukx8.png)\n\n一共有 $12$ 种赋值方式：\n\n1. $w_i=\\{1,2,2\\}$；\n2. $w_i=\\{1,2,3\\}$；\n3. $w_i=\\{1,3,2\\}$；\n4. $w_i=\\{1,3,3\\}$；\n5. $w_i= \\bf \\{2,1,1\\}$，这是最优情况；\n6. $w_i=\\{2,1,3\\}$；\n7. $w_i=\\{2,3,1\\}$；\n8. $w_i=\\{2,3,3\\}$；\n9. $w_i=\\{3,1,1\\}$；\n10. $w_i=\\{3,1,2\\}$；\n11. $w_i=\\{3,2,1\\}$；\n12. $w_i=\\{3,2,2\\}$。\n\n#### 样例 2 解释\n\n样例中的道路分布如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9f1qjpm4.png)\n\n对于第二问，其中一种最优的赋值方式是：$w_i=\\{2,1,1,1,1,1,2,1,2\\}$。\n\n#### 数据规模与约定\n\n**本题采用捆绑测试。**\n\n- Subtask 1（5 pts）：$t_j=1$ 或 $t_j=2$；\n- Subtask 2（5 pts）：$R=1$；\n- Subtask 3（10 pts）：$u_j=j$，$v_j=j+1$；\n- Subtask 4（20 pts）：$t_j=0$；\n- Subtask 5（10 pts）：$n \\le 10$，$R \\le 5$；\n- Subtask 6（50 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^5$，$1 \\le R \\le 100$。\n\n对于 Subtask 1 ~ 5，$R \\le 40$。\n\n上面描述 Subtask 时 $t_j=P$ 即为对于所有 $j \\in [1,n)$ 都有 $t_j=P$。\n\n其中对于 Subtask 1，“或” 意为 Subtask\n1 的一部分测试点满足 $t_j=1$，另一部分测试点满足 $t_j=2$。", "locale": "zh-CN"}}}
{"pid": "P7847", "type": "P", "difficulty": 5, "samples": [["2\n1\n2", "0\n1 2"], ["2\n233\n2020", "479 54056\n5470 8181"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["Special Judge"], "title": "「dWoi R2」Elevator / 电梯", "background": "zszz，主角总会在学级裁判前乘电梯下去的过程中在内心写小作文。\n\n但万一写不出来怎么办 Zzz ……\n\n于是最原开始想数学题了 ……", "description": "现有正整数 $a,b,c$ 满足 $\\alpha$ 式：$\\dfrac{1}{a}-\\dfrac{1}{b}=\\dfrac{1}{c}$，且 $\\gcd (a,b,c)=1$。\n\n现给定正整数 $N$，请编程求出满足 $c \\leq N$ 的 $\\alpha$ 式的个数以及满足以下条件的一个 $b$：\n\n对所有 $c=N$ 得到的 $\\alpha$ 式中使得 $a$ 最小。", "inputFormat": "第一行一个正整数 $T$，表示询问总数。\n\n接下来 $T$ 行，每行一个正整数，表示给定的 $N$。", "outputFormat": "$T$ 行，每行一个正整数，表示满足条件的 $\\alpha$ 式的个数。若存在解，则空一格后再输出一个满足条件的 $b$。\n\n可以证明，$N>1$ 时一定有这样的 $b$。", "hint": "#### 样例 #2 解释\n\n第一个询问中对应的式子为：$\\dfrac{1}{232} - \\dfrac{1}{54056} = \\dfrac{1}{233}$，故后一个输出为 $54056$。\n\n第二个询问中对应的式子为：$\\dfrac{1}{1620} - \\dfrac{1}{8181} = \\dfrac{1}{2020}$，故后一个输出为 $8181$。\n\n而这两个 $\\alpha$ 式的 $a$ 在所有 $c=N$ 的情况中是最小的。\n- - -\n#### 数据规模与约定\n\n对于 $10\\%$ 的数据，有 $N\\leq 100$，$T\\leq 10$。\n\n对于 $30\\%$ 的数据，有 $N\\leq 10^3$，$T\\leq 100$。\n\n对于 $70\\%$ 的数据，有 $N\\leq 10^5$，$T\\leq 10^4$。\n\n对于 $100\\%$ 的数据，有 $N\\leq 2\\times 10^6$，$T\\leq 10^5$。\n- - -\n#### 关于 Special Judge\n\n**本题采用 Special Judge。**\n\n如果你第一问都答对了而第二问有答错的，那么你将得到 $30\\%$ 的分数，如果你第一问有答错的而第二问都答对了，那么你将得到 $70\\%$ 的分数，但是如果你第一问和第二问都有部分或者全部错误，那么你将被判作 WA；此外，如果你输出残缺或者过多，例如只回答第一问却不输出第二问的答案（$N=1$ 除外）或者 $N=1$ 后多输出了一个数，那么你将同样不会得到分数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「dWoi R2」Elevator / 电梯", "background": "zszz，主角总会在学级裁判前乘电梯下去的过程中在内心写小作文。\n\n但万一写不出来怎么办 Zzz ……\n\n于是最原开始想数学题了 ……", "description": "现有正整数 $a,b,c$ 满足 $\\alpha$ 式：$\\dfrac{1}{a}-\\dfrac{1}{b}=\\dfrac{1}{c}$，且 $\\gcd (a,b,c)=1$。\n\n现给定正整数 $N$，请编程求出满足 $c \\leq N$ 的 $\\alpha$ 式的个数以及满足以下条件的一个 $b$：\n\n对所有 $c=N$ 得到的 $\\alpha$ 式中使得 $a$ 最小。", "inputFormat": "第一行一个正整数 $T$，表示询问总数。\n\n接下来 $T$ 行，每行一个正整数，表示给定的 $N$。", "outputFormat": "$T$ 行，每行一个正整数，表示满足条件的 $\\alpha$ 式的个数。若存在解，则空一格后再输出一个满足条件的 $b$。\n\n可以证明，$N>1$ 时一定有这样的 $b$。", "hint": "#### 样例 #2 解释\n\n第一个询问中对应的式子为：$\\dfrac{1}{232} - \\dfrac{1}{54056} = \\dfrac{1}{233}$，故后一个输出为 $54056$。\n\n第二个询问中对应的式子为：$\\dfrac{1}{1620} - \\dfrac{1}{8181} = \\dfrac{1}{2020}$，故后一个输出为 $8181$。\n\n而这两个 $\\alpha$ 式的 $a$ 在所有 $c=N$ 的情况中是最小的。\n- - -\n#### 数据规模与约定\n\n对于 $10\\%$ 的数据，有 $N\\leq 100$，$T\\leq 10$。\n\n对于 $30\\%$ 的数据，有 $N\\leq 10^3$，$T\\leq 100$。\n\n对于 $70\\%$ 的数据，有 $N\\leq 10^5$，$T\\leq 10^4$。\n\n对于 $100\\%$ 的数据，有 $N\\leq 2\\times 10^6$，$T\\leq 10^5$。\n- - -\n#### 关于 Special Judge\n\n**本题采用 Special Judge。**\n\n如果你第一问都答对了而第二问有答错的，那么你将得到 $30\\%$ 的分数，如果你第一问有答错的而第二问都答对了，那么你将得到 $70\\%$ 的分数，但是如果你第一问和第二问都有部分或者全部错误，那么你将被判作 WA；此外，如果你输出残缺或者过多，例如只回答第一问却不输出第二问的答案（$N=1$ 除外）或者 $N=1$ 后多输出了一个数，那么你将同样不会得到分数。", "locale": "zh-CN"}}}
{"pid": "P7848", "type": "P", "difficulty": 6, "samples": [["3\n0 0 1", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["交互题", "Special Judge"], "title": "「JZOI-2」填问卷", "background": "团员们满脑子都是办周年庆，但小僖只想摸鱼。\n\n于是小僖打开了他心爱的游戏。", "description": "玩了这么久这款游戏了，今天小僖想参加活动，填一下问卷来看看自己对这款游戏的了解程度。\n\n问卷上一共有 $n$ 道判断题，可怜的小僖发现自己一题也不会，他决定问一下他的队友来解决。\n\n他的队友是游戏的一位资深用户，他全部题都会做，所以小僖决定向队友求助。具体的，小僖每次都会以以下格式询问：\n\n`int ask(int m,vector<int> w,vector<bool> ans)`\n\n其中 $m$ 表示这一次询问的题目的总数，$w_i$ 表示询问的第 $i$ 题的题目编号（你需要保证单次询问的 $w_i$ 互不相同，毕竟队友很没有耐心），$ans_i$ 表示小 X 认为的第 $i$ 题的正确答案（$0\\le i<m$）。队友会告诉他这次他有多少题**答对**了。\n\n例如，现在有三道题，如果答案分别是 $\\{0,1,1\\}$，小 $X$ 现在调用 `ask(2,[1,3],[1,1])`，那么返回值为 $1$，因为第一道题答错了，第三道题答对了。\n\n由于题目有点多，小僖需要你写一个程序来帮助他得到所有题的正确答案。\n\n你不需要实现主函数，你现在只需要实现 `vector<bool> work(int n)`，返回值是题目 $1\\sim n$ 的答案，考虑到 `vector<bool>` **下标从 0 开始**，所以你需要将你的答案数组**左移 1 位。**\n\n当然，询问很费劲，所以小僖希望询问次数越少越好，询问次数的评分标准会在提示说明中给出。另外，虽然每一次询问的题目数没有限制，但你还是要注意，如果询问题目数过多，你可能会获得 **TLE**，题目保证每次询问的时间复杂度是 $O(m)$ 的。\n\n为了方便，这里用 $1$ 表示选对，$0$ 表述选错。", "inputFormat": "样例数据属于第一部分，按照以下格式输入：  \n$n\\\\a_{1...n}$  \n其中 $a_i$ 表示第 $i$ 题的正确答案。", "outputFormat": "下面给出`grader.cpp`的错误信息 $\\text{Wrong[x]}$：\n1. 询问中的 $w_i$ 大于 $n$ 或小于 $1$。\n2. 询问中出现了相同的 $w_i$。\n3. 询问中 $m$ 和 $w$ 或 $ans$ 的长度不匹配。\n4. 答案错误或返回数组格式不正确。\n\n之后，`grader.cpp`会返回你的询问次数。", "hint": "### 样例解释\n下面给出一种 $2$ 次的可行的询问方案\n\n`ask(1,[2],0)`，返回值为 $1$，表明第二题的答案是 $0$.  \n`ask(2,[1,3],[0,1])`，返回值为 $2$，~~这也许是因为运气太好，一蒙就对~~，所以可以得出第一题和第三题的答案分别是$0,1$。  \n于是你可以返回 $\\{0,0,1\\}$ 了，这时询问次数为 $2$。\n\n当然，如果第二次询问结果是 $1$，那么你就不能直接得出答案了，所以，蒙题有风险。\n### 数据范围\n对于所有数据，保证 $n\\le2^{17}$。\n\n问卷的出题人为了保证用户们答题的质量，为了防止用户做判断题一蒙全对，他会精心构造每一道题的答案。\n\n当然，这里保证答案在问卷出好后就已经存在，不会根据你的询问来构造。\n\n对于每组数据假设你询问了 $Q$ 次，下面给出评分标准。\n| $Q$ 的取值范围 | 得分 |\n| :----------: | :----------: |\n| $(2^{17},+\\infty)$ | $0$ |\n| $2^{17}$ | $10$ |\n| $(64000,2^{17})$ | $\\min(90,\\lfloor\\frac{2^{17}-Q}{2^{16}}\\times100\\rfloor)$ |\n| $(63000,64000]$ | $95$ |\n| $[0,63000]$ | $100$ |\n\n\n注意，本题有多组测试点，得分取所有数据中测出的得分最少的那组数据。\n\n实现细节：请务必加上 `extern \"C\"`，你可以选择补全 `problem.cpp` 中的函数中的内容，当然也可以自己实现。编译的时候直接编译和运行 `grader.cpp` 即可。\n\n温馨提示：如果你的乱搞做法打得太劣，虽然你的询问次数小于 $2^{17}$，但你的得分可能小于 $10$ 分。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「JZOI-2」填问卷", "background": "团员们满脑子都是办周年庆，但小僖只想摸鱼。\n\n于是小僖打开了他心爱的游戏。", "description": "玩了这么久这款游戏了，今天小僖想参加活动，填一下问卷来看看自己对这款游戏的了解程度。\n\n问卷上一共有 $n$ 道判断题，可怜的小僖发现自己一题也不会，他决定问一下他的队友来解决。\n\n他的队友是游戏的一位资深用户，他全部题都会做，所以小僖决定向队友求助。具体的，小僖每次都会以以下格式询问：\n\n`int ask(int m,vector<int> w,vector<bool> ans)`\n\n其中 $m$ 表示这一次询问的题目的总数，$w_i$ 表示询问的第 $i$ 题的题目编号（你需要保证单次询问的 $w_i$ 互不相同，毕竟队友很没有耐心），$ans_i$ 表示小 X 认为的第 $i$ 题的正确答案（$0\\le i<m$）。队友会告诉他这次他有多少题**答对**了。\n\n例如，现在有三道题，如果答案分别是 $\\{0,1,1\\}$，小 $X$ 现在调用 `ask(2,[1,3],[1,1])`，那么返回值为 $1$，因为第一道题答错了，第三道题答对了。\n\n由于题目有点多，小僖需要你写一个程序来帮助他得到所有题的正确答案。\n\n你不需要实现主函数，你现在只需要实现 `vector<bool> work(int n)`，返回值是题目 $1\\sim n$ 的答案，考虑到 `vector<bool>` **下标从 0 开始**，所以你需要将你的答案数组**左移 1 位。**\n\n当然，询问很费劲，所以小僖希望询问次数越少越好，询问次数的评分标准会在提示说明中给出。另外，虽然每一次询问的题目数没有限制，但你还是要注意，如果询问题目数过多，你可能会获得 **TLE**，题目保证每次询问的时间复杂度是 $O(m)$ 的。\n\n为了方便，这里用 $1$ 表示选对，$0$ 表述选错。", "inputFormat": "样例数据属于第一部分，按照以下格式输入：  \n$n\\\\a_{1...n}$  \n其中 $a_i$ 表示第 $i$ 题的正确答案。", "outputFormat": "下面给出`grader.cpp`的错误信息 $\\text{Wrong[x]}$：\n1. 询问中的 $w_i$ 大于 $n$ 或小于 $1$。\n2. 询问中出现了相同的 $w_i$。\n3. 询问中 $m$ 和 $w$ 或 $ans$ 的长度不匹配。\n4. 答案错误或返回数组格式不正确。\n\n之后，`grader.cpp`会返回你的询问次数。", "hint": "### 样例解释\n下面给出一种 $2$ 次的可行的询问方案\n\n`ask(1,[2],0)`，返回值为 $1$，表明第二题的答案是 $0$.  \n`ask(2,[1,3],[0,1])`，返回值为 $2$，~~这也许是因为运气太好，一蒙就对~~，所以可以得出第一题和第三题的答案分别是$0,1$。  \n于是你可以返回 $\\{0,0,1\\}$ 了，这时询问次数为 $2$。\n\n当然，如果第二次询问结果是 $1$，那么你就不能直接得出答案了，所以，蒙题有风险。\n### 数据范围\n对于所有数据，保证 $n\\le2^{17}$。\n\n问卷的出题人为了保证用户们答题的质量，为了防止用户做判断题一蒙全对，他会精心构造每一道题的答案。\n\n当然，这里保证答案在问卷出好后就已经存在，不会根据你的询问来构造。\n\n对于每组数据假设你询问了 $Q$ 次，下面给出评分标准。\n| $Q$ 的取值范围 | 得分 |\n| :----------: | :----------: |\n| $(2^{17},+\\infty)$ | $0$ |\n| $2^{17}$ | $10$ |\n| $(64000,2^{17})$ | $\\min(90,\\lfloor\\frac{2^{17}-Q}{2^{16}}\\times100\\rfloor)$ |\n| $(63000,64000]$ | $95$ |\n| $[0,63000]$ | $100$ |\n\n\n注意，本题有多组测试点，得分取所有数据中测出的得分最少的那组数据。\n\n实现细节：请务必加上 `extern \"C\"`，你可以选择补全 `problem.cpp` 中的函数中的内容，当然也可以自己实现。编译的时候直接编译和运行 `grader.cpp` 即可。\n\n温馨提示：如果你的乱搞做法打得太劣，虽然你的询问次数小于 $2^{17}$，但你的得分可能小于 $10$ 分。", "locale": "zh-CN"}}}
{"pid": "P7849", "type": "P", "difficulty": 3, "samples": [["3 6\n1\n2\n3", "? 1\n? 2\n? 3\n! 1"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["交互题", "Special Judge"], "title": "「JZOI-2」猜数列", "background": "团员们满脑子都是办周年庆，但小僖只想摸鱼。\n\n于是小僖拿出了最喜欢的数列来考考你。", "description": "小僖有一个乱序的等差数列 $A$。\n\n你可以发出两种询问：\n\n1. 询问原序列下标为 $x,y$ 的数在等差数列（非模意义下）中的大小关系。\n1. 询问原序列下标为 $x$ 的数在等差数列（模意义下）中的值。\n\n但由于交互库出了点问题，你的询问 $2$ 最多能询问 $q$ 次。\n\n给定等差数列的长度 $n$ 和询问次数 $q$，和固定的模数 $p=10^{9}+7$，求这个等差数列的公差 $d$。\n\n**总询问次数不得超过 $2n$ 次。交互完成后请立刻输出答案。**\n\n**交互方式：**\n\n输入数列的长度 $n$ 和询问次数 $q$ 以开始交互。\n\n交互过程中，您可以进行题目描述中的两种询问。\n\n对于第一种询问，交互库将会返回 $1$ 代表 $>$ 或 $0$ 代表 $<$ 。询问格式为 `> x y`。\n\n对于第二种询问，交互库将会返回一个正整数 $A_i$。询问格式为 `? x`。\n\n在您确定答案后，请以 `! d` 的形式输出一行，停止交互。\n\n在您输出一行后，请清空缓冲区：\n\n在 C++ 中，使用 `fflush(stdout)` 或 `cout.flush()`。\n\n在 Pascal 中，使用 `flush(output)`。\n\n在 Python 中，使用 `stdout.flush()`。\n\n其它语言请自行查阅文档。\n\n**请遵循题目完成交互，发出不合法询问可能会出现 TLE，WA 等问题。**", "inputFormat": "见交互方式。", "outputFormat": "见交互方式。\n\n数据保证不会有多种可能的 $d$。", "hint": "对于 $50\\%$ 的数据保证 $q=2n$。\n\n另 $50\\%$ 的数据保证 $q=2$。\n\n对于 $100\\%$ 的数据保证 $2\\leq n\\leq 100000$，$0\\leq A_i< p$，$1\\le d < p$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「JZOI-2」猜数列", "background": "团员们满脑子都是办周年庆，但小僖只想摸鱼。\n\n于是小僖拿出了最喜欢的数列来考考你。", "description": "小僖有一个乱序的等差数列 $A$。\n\n你可以发出两种询问：\n\n1. 询问原序列下标为 $x,y$ 的数在等差数列（非模意义下）中的大小关系。\n1. 询问原序列下标为 $x$ 的数在等差数列（模意义下）中的值。\n\n但由于交互库出了点问题，你的询问 $2$ 最多能询问 $q$ 次。\n\n给定等差数列的长度 $n$ 和询问次数 $q$，和固定的模数 $p=10^{9}+7$，求这个等差数列的公差 $d$。\n\n**总询问次数不得超过 $2n$ 次。交互完成后请立刻输出答案。**\n\n**交互方式：**\n\n输入数列的长度 $n$ 和询问次数 $q$ 以开始交互。\n\n交互过程中，您可以进行题目描述中的两种询问。\n\n对于第一种询问，交互库将会返回 $1$ 代表 $>$ 或 $0$ 代表 $<$ 。询问格式为 `> x y`。\n\n对于第二种询问，交互库将会返回一个正整数 $A_i$。询问格式为 `? x`。\n\n在您确定答案后，请以 `! d` 的形式输出一行，停止交互。\n\n在您输出一行后，请清空缓冲区：\n\n在 C++ 中，使用 `fflush(stdout)` 或 `cout.flush()`。\n\n在 Pascal 中，使用 `flush(output)`。\n\n在 Python 中，使用 `stdout.flush()`。\n\n其它语言请自行查阅文档。\n\n**请遵循题目完成交互，发出不合法询问可能会出现 TLE，WA 等问题。**", "inputFormat": "见交互方式。", "outputFormat": "见交互方式。\n\n数据保证不会有多种可能的 $d$。", "hint": "对于 $50\\%$ 的数据保证 $q=2n$。\n\n另 $50\\%$ 的数据保证 $q=2$。\n\n对于 $100\\%$ 的数据保证 $2\\leq n\\leq 100000$，$0\\leq A_i< p$，$1\\le d < p$", "locale": "zh-CN"}}}
