{"pid": "P9357", "type": "P", "difficulty": 6, "samples": [["3 2\n1 3\n2 3", "40"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "递推", "洛谷原创", "O2优化", "组合数学", "洛谷月赛"], "title": "「SiR-1」Lighthouse", "background": "", "description": "给定一棵 $n$ 个点的树，每个点有权值 $w_i$，初始为 $0$。初始得分 $s=0$。\n\n进行 $m$ 次操作，每次操作选择一个点 $u$，给 $s$ 增加 $u$ 所在的同点权连通块的大小（即，假设只保留点权等于 $w_u$ 的点，和连接两个点权等于 $w_u$ 的点的边，对得分的贡献就是此时 $u$ 所在的连通块大小。注意这不会真的删去一部分树上的点和边），然后给 $w_u$ 增加 $1$。\n\n请对所有 $n^m$ 种操作方式，求它们的得分 $s$ 之和，对 $10^9+7$ 取模。", "inputFormat": "第一行两个正整数，表示 $n,m$。\n\n其后 $n-1$ 行每行两个正整数，表示一条边的两个端点 $u,v$。", "outputFormat": "输出一个整数，表示结果对 $10^9+7$ 取模后的结果。", "hint": "对于所有数据，满足 $1\\leq n\\leq 1000$，$1\\leq m\\leq 10^5$，$1\\leq u,v\\leq n$，保证输入是一棵树。\n\n- Subtask 0（5 pts）：$n,m\\le 7$。\n- Subtask 1（20 pts）：$n,m\\le 10$。\n- Subtask 2（15 pts）：$n,m\\le 50$。\n- Subtask 3（15 pts）：$n,m\\le 100$。\n- Subtask 4（15 pts）：$n\\le 50$。\n- Subtask 5（15 pts）：树是一条链。\n- Subtask 6（15 pts）：无特殊限制。\n\n本题同时开启子任务依赖。具体地：\n\n+ 对于子任务 $i(i \\in [1, 3])$，依赖于子任务 $0 \\sim (i -  1)$；\n+ 对于子任务 $4$，依赖于子任务 $0 \\sim 2$；\n+ 对于子任务 $6$，依赖于子任务 $0 \\sim 5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「SiR-1」Lighthouse", "background": "", "description": "给定一棵 $n$ 个点的树，每个点有权值 $w_i$，初始为 $0$。初始得分 $s=0$。\n\n进行 $m$ 次操作，每次操作选择一个点 $u$，给 $s$ 增加 $u$ 所在的同点权连通块的大小（即，假设只保留点权等于 $w_u$ 的点，和连接两个点权等于 $w_u$ 的点的边，对得分的贡献就是此时 $u$ 所在的连通块大小。注意这不会真的删去一部分树上的点和边），然后给 $w_u$ 增加 $1$。\n\n请对所有 $n^m$ 种操作方式，求它们的得分 $s$ 之和，对 $10^9+7$ 取模。", "inputFormat": "第一行两个正整数，表示 $n,m$。\n\n其后 $n-1$ 行每行两个正整数，表示一条边的两个端点 $u,v$。", "outputFormat": "输出一个整数，表示结果对 $10^9+7$ 取模后的结果。", "hint": "对于所有数据，满足 $1\\leq n\\leq 1000$，$1\\leq m\\leq 10^5$，$1\\leq u,v\\leq n$，保证输入是一棵树。\n\n- Subtask 0（5 pts）：$n,m\\le 7$。\n- Subtask 1（20 pts）：$n,m\\le 10$。\n- Subtask 2（15 pts）：$n,m\\le 50$。\n- Subtask 3（15 pts）：$n,m\\le 100$。\n- Subtask 4（15 pts）：$n\\le 50$。\n- Subtask 5（15 pts）：树是一条链。\n- Subtask 6（15 pts）：无特殊限制。\n\n本题同时开启子任务依赖。具体地：\n\n+ 对于子任务 $i(i \\in [1, 3])$，依赖于子任务 $0 \\sim (i -  1)$；\n+ 对于子任务 $4$，依赖于子任务 $0 \\sim 2$；\n+ 对于子任务 $6$，依赖于子任务 $0 \\sim 5$。", "locale": "zh-CN"}}}
{"pid": "P9358", "type": "P", "difficulty": 6, "samples": [["3 4 13\n2 2\n1 1 3\n2 1\n2 2\n2 3\n1 2 4\n2 1\n2 2\n2 3\n1 2 1\n2 1\n2 2\n2 3\n", "2\n2\n1\n3\n3\n1\n2\n3\n2\n1\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["平衡树", "2022", "O2优化", "动态树 LCT", "ICPC", "西安"], "title": "[ICPC 2022 Xi'an R] Bridge", "background": "", "description": "There are $n$ countries numbered from $1$ to $n$ in Erathia. Each country can be regarded as a chain with $m+1$ nodes numbered from $1$ to $m+1$. Initially, node $(a, b)$ is connected with node $(a, b + 1)$ by a street where node $(a, b)$ denotes the $b$-th node of the $a$-th country. There are no bridges between any two countries at first. \n\nYou need to process $q$ queries of the following two types.\n\n- $1\\ a\\ b$ ($1\\leq a < n, 1\\leq b\\leq m$). Build a bridge between node $(a, b)$ and node $(a + 1, b)$. It is guranteed that at any time, **each node is connected with at most one bridge**.\n- $2\\ a$ ($1\\leq a\\leq n$). A hero will walk through Erathia. This hero starts from $(a, 1)$. If the hero is at $(x, y)$ and there is a unvisited bridge connected to him, he passes it, or he goes to $(x, y + 1)$. Once he arrived the $(m+1)$-th node of any conutry, he stops. Please note that 'unvisited bridge' is **independently** judged for each query. \n\nYour task is to print which country the hero is in at last for the second kind of query. It can be proved that the hero's route is always unique under these constraints.\n", "inputFormat": "The first line contains three integers $n$, $m$ and $q$ ($1 \\leq n, m, q \\leq 10 ^ 5$).\n\nEach of the following $q$ lines represents a query with format described above.", "outputFormat": "For each query of type $2$, output a line with an integer representing the answer.\n", "hint": "**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem A.\n\n**Author**: MonkeyKing.", "locale": "en", "translations": {"en": {"title": "[ICPC 2022 Xi'an R] Bridge", "background": "", "description": "There are $n$ countries numbered from $1$ to $n$ in Erathia. Each country can be regarded as a chain with $m+1$ nodes numbered from $1$ to $m+1$. Initially, node $(a, b)$ is connected with node $(a, b + 1)$ by a street where node $(a, b)$ denotes the $b$-th node of the $a$-th country. There are no bridges between any two countries at first. \n\nYou need to process $q$ queries of the following two types.\n\n- $1\\ a\\ b$ ($1\\leq a < n, 1\\leq b\\leq m$). Build a bridge between node $(a, b)$ and node $(a + 1, b)$. It is guranteed that at any time, **each node is connected with at most one bridge**.\n- $2\\ a$ ($1\\leq a\\leq n$). A hero will walk through Erathia. This hero starts from $(a, 1)$. If the hero is at $(x, y)$ and there is a unvisited bridge connected to him, he passes it, or he goes to $(x, y + 1)$. Once he arrived the $(m+1)$-th node of any conutry, he stops. Please note that 'unvisited bridge' is **independently** judged for each query. \n\nYour task is to print which country the hero is in at last for the second kind of query. It can be proved that the hero's route is always unique under these constraints.\n", "inputFormat": "The first line contains three integers $n$, $m$ and $q$ ($1 \\leq n, m, q \\leq 10 ^ 5$).\n\nEach of the following $q$ lines represents a query with format described above.", "outputFormat": "For each query of type $2$, output a line with an integer representing the answer.\n", "hint": "**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem A.\n\n**Author**: MonkeyKing.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2022 Xi'an R] Bridge", "background": "", "description": "Erathia 大陆上有 $n$ 个国家，从 $1$ 到 $n$ 编号。每个国家可以看成由 $m + 1$ 个结点组成的链，结点从 $1$ 到 $m + 1$ 编号。结点 $(a, b)$ 和 $(a, b + 1)$ 由一条街道连接，其中 $(a, b)$ 表示国家 $a$ 的第 $b$ 个结点。一开始，国家之间没有桥。\n\n你需要处理 $q$ 个操作：\n\n- $1\\ a\\ b$（$1\\leq a < n$，$1\\leq b\\leq m$）：在 $(a, b)$ 和 $(a + 1, b)$ 之间建造一座桥。**保证每个结点最多和一座桥相连**。\n- $2\\ a$（$1\\leq a\\leq n$）：一名英雄走过 Erathia 大陆。他从 $(a, 1)$ 出发。如果这名英雄当前在结点 $(x, y)$ 且有一座未被访问过的桥与之连接，那么他会走过这个桥到达桥的另一端，否则他会走到 $(x, y + 1)$。一旦他到达某个国家的第 $m + 1$ 个结点，他就会停下来。注意两个询问之间的 “未被访问过的桥” 是独立的。\n\n你的任务是对每个操作 $2$ 求出英雄最终所在的国家。\n\n$1\\leq n, m, q\\leq 10 ^ 5$。", "inputFormat": "第一行三个整数 $n, m, q$。", "outputFormat": "对于每个操作 $2$，输出一行一个整数表示答案。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P9359", "type": "P", "difficulty": 5, "samples": [["3 4 2 1\n.***\n*..*\n**..\n", "4\n"], ["3 4 1 2\n.***\n*..*\n**..\n", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2022", "三分", "网络流", "O2优化", "二分图", "ICPC", "西安"], "title": "[ICPC 2022 Xi'an R] Cells Coloring", "background": "", "description": "You are given an $n \\times m$ grid. Some of the cells are obstacles, the others are empty. Choose a non-negative integer $k$ and color all empty cells with $k+1$ colors $0, 1, 2, \\ldots k$. You can not color two cells in the same row or same column with the same **non-zero** color. \n\nYou are given two non-negative integers $c$ and $d$. For a coloring plan, define $z$ as the number of the cells with color $0$. Define the cost of the plan is $ck+dz$.\n\nFind the minimum cost.", "inputFormat": "The first line contains four integers $n$, $m$ ($1\\leq n, m\\leq 250$), $c$ and $d$ ($0\\leq c, d\\leq 10 ^ 9$).\n\nThe $i$-th line of the next $n$ lines contains a string of $m$ characters. The $j$-th character is `*` if the cell in the $i$-th row and the $j$-th column is an obstacle. The $j$-th character is `.` if the cell in the $i$-th row and the $j$-th column is empty.", "outputFormat": "Output a line with a single number, representing the answer.", "hint": "**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem B.\n\n**Author**: csy2005.", "locale": "en", "translations": {"en": {"title": "[ICPC 2022 Xi'an R] Cells Coloring", "background": "", "description": "You are given an $n \\times m$ grid. Some of the cells are obstacles, the others are empty. Choose a non-negative integer $k$ and color all empty cells with $k+1$ colors $0, 1, 2, \\ldots k$. You can not color two cells in the same row or same column with the same **non-zero** color. \n\nYou are given two non-negative integers $c$ and $d$. For a coloring plan, define $z$ as the number of the cells with color $0$. Define the cost of the plan is $ck+dz$.\n\nFind the minimum cost.", "inputFormat": "The first line contains four integers $n$, $m$ ($1\\leq n, m\\leq 250$), $c$ and $d$ ($0\\leq c, d\\leq 10 ^ 9$).\n\nThe $i$-th line of the next $n$ lines contains a string of $m$ characters. The $j$-th character is `*` if the cell in the $i$-th row and the $j$-th column is an obstacle. The $j$-th character is `.` if the cell in the $i$-th row and the $j$-th column is empty.", "outputFormat": "Output a line with a single number, representing the answer.", "hint": "**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem B.\n\n**Author**: csy2005.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2022 Xi'an R] Cells Coloring", "background": "", "description": "给定一个 $n\\times m$ 的网格。一些格子是障碍，其它格子是空的。选择一个非负整数 $k$，并用 $k + 1$ 种颜色 $0, 1, \\ldots, k$ 给空格子染色。不能有同一行或同一列的两个格子被染成了相同的 **非零** 颜色。\n\n给定两个非负整数 $c, d$。对于一组染色方案，定义 $z$ 表示染成颜色 $0$ 的格子数量，则该方案的代价为 $ck + dz$。\n\n求出最小代价。\n\n$1\\leq n, m \\leq 250$，$0\\leq c, d\\leq 10 ^ 9$。", "inputFormat": "第一行四个整数 $n, m, c, d$。\n\n接下来 $n$ 行，每行一个长度为 $m$ 的字符串。字符串的第 $j$ 个字符为 `*` 表示第 $i$ 行第 $j$ 列的格子为障碍，为 `.` 表示为空。", "outputFormat": "输出一行一个整数表示答案。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P9360", "type": "P", "difficulty": 2, "samples": [["5\n1 1 1\n2 3 3\n9 9 9\n3 26 47\n1064 822 1048576\n", "1\n7\n45\n44\n21860\n"]], "limits": {"time": [1000, 1000], "memory": [524288, 524288]}, "tags": ["2022", "O2优化", "ICPC", "西安"], "title": "[ICPC 2022 Xi'an R] Clone Ranran", "background": "", "description": "Ranran needs to prepare a contest! A contest is made of $c$ problems, and Ranran can do one of the following two things:\n\n- Clone himself in $a$ minutes. That is, after $a$ minutes, there will be one more Ranran.\n- Prepare a problem in $b$ minutes. That is, after $b$ minutes, there will be one more problem.\n\nNote that a cloned Ranran can also do the two things above. A Ranran cannot do the two things at the same time.\n\nRanran wants to prepare the contest as fast as possible. But he is very lazy, so he asks you to find the minimum number of minutes to prepare the contest.\n\nYou need to answer $T$ queries independently.", "inputFormat": "The first line contains an integer $T$ ($1\\leq T\\leq 10 ^ 5$).\n\nEach of the next $T$ lines contains three integers $a$, $b$ and $c$ ($1\\leq a, b, c\\leq 10 ^ 9$), representing a query.", "outputFormat": "For each test case, output a line with a single integer representing the answer.", "hint": "**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem C.\n\n**Author**: MagicSpark.", "locale": "en", "translations": {"en": {"title": "[ICPC 2022 Xi'an R] Clone Ranran", "background": "", "description": "Ranran needs to prepare a contest! A contest is made of $c$ problems, and Ranran can do one of the following two things:\n\n- Clone himself in $a$ minutes. That is, after $a$ minutes, there will be one more Ranran.\n- Prepare a problem in $b$ minutes. That is, after $b$ minutes, there will be one more problem.\n\nNote that a cloned Ranran can also do the two things above. A Ranran cannot do the two things at the same time.\n\nRanran wants to prepare the contest as fast as possible. But he is very lazy, so he asks you to find the minimum number of minutes to prepare the contest.\n\nYou need to answer $T$ queries independently.", "inputFormat": "The first line contains an integer $T$ ($1\\leq T\\leq 10 ^ 5$).\n\nEach of the next $T$ lines contains three integers $a$, $b$ and $c$ ($1\\leq a, b, c\\leq 10 ^ 9$), representing a query.", "outputFormat": "For each test case, output a line with a single integer representing the answer.", "hint": "**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem C.\n\n**Author**: MagicSpark.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2022 Xi'an R] Clone Ranran", "background": "", "description": "然然需要准备一场有 $c$ 个问题的比赛！他可以进行两种操作：\n\n- 在 $a$ 分钟内克隆一个自己；\n- 在 $b$ 分钟内准备好一个问题。\n\n克隆的然然也可以进行上述操作，但然然不能同时进行这两个操作。\n\n然然希望尽快准备好比赛，但是他很懒，所以他让你求出准备比赛的最小分钟数。\n\n共有 $T$ 组数据。\n\n$1\\leq T\\leq 10 ^ 5$，$1\\leq a, b, c\\leq 10 ^ 9$。", "inputFormat": "第一行一个整数 $T$。\n\n接下来 $T$ 行，每行三个整数 $a, b, c$。", "outputFormat": "对于每组数据，输出一行一个整数表示答案。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P9361", "type": "P", "difficulty": 6, "samples": [["6 2\n1 3 2 5 4 6\n2 1 4 3 6 5\n4\n1 4\n5 3\n6 1\n5 2\n", "1\n2\n5\n3\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["倍增", "2022", "O2优化", "ICPC", "西安"], "title": "[ICPC 2022 Xi'an R] Contests", "background": "", "description": "There are $n$ contestants and they take part in $m$ contests. You are given the ranklist of each contest. The ranklist of the $k$-th contest is a sequence $a_k$, indicating that the $a_{k, i}$-th contestant's rank is $i$.\n\nSolarPea and PolarSea are two of the $n$ contestants. SolarPea wants to prove that he is stronger than PolarSea.\n\nDefine $x$ is $l$-stronger than $y$, if and only if there exists a sequence $b$ of length $l + 1$, such that $b_1 = x$, $b_{l + 1} = y$, and for all $1\\leq i\\leq l$, $b_i$ has a smaller rank than $b_{i + 1}$ in at least one contest.\n\nThere are $q$ queries. In the $i$-th query, SolarPea is contestant $x$ and PolarSea is contestant $y$. Please find the minimum positive number $l$ such that SolarPea is $l$-stronger than PolarSea.", "inputFormat": "The first line contains two integers $n$ ($2\\leq n\\leq 10 ^ 5$) and $m$ ($1\\leq m\\leq 5$).\n\nThe $i$-th of the next $m$ lines contains $n$ intergers $a_{i, 1}, a_{i, 2}, \\ldots, a_{i, n}$. It is guaranteed that $a_i$ is a permutaion of $1,2,\\ldots,n$.\n\nThe next line contains an integer $q$ ($1\\leq q\\leq 10 ^ 5$).\n\nEach of the next $q$ lines contains two integers $x$ and $y$ ($1 \\le x,y \\le n, x \\neq y$), representing a query.", "outputFormat": "For each query, output a number $l$ representing the answer. If there is no legal $l$, output $-1$.", "hint": "**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem D.\n\n**Author**: csy2005.", "locale": "en", "translations": {"en": {"title": "[ICPC 2022 Xi'an R] Contests", "background": "", "description": "There are $n$ contestants and they take part in $m$ contests. You are given the ranklist of each contest. The ranklist of the $k$-th contest is a sequence $a_k$, indicating that the $a_{k, i}$-th contestant's rank is $i$.\n\nSolarPea and PolarSea are two of the $n$ contestants. SolarPea wants to prove that he is stronger than PolarSea.\n\nDefine $x$ is $l$-stronger than $y$, if and only if there exists a sequence $b$ of length $l + 1$, such that $b_1 = x$, $b_{l + 1} = y$, and for all $1\\leq i\\leq l$, $b_i$ has a smaller rank than $b_{i + 1}$ in at least one contest.\n\nThere are $q$ queries. In the $i$-th query, SolarPea is contestant $x$ and PolarSea is contestant $y$. Please find the minimum positive number $l$ such that SolarPea is $l$-stronger than PolarSea.", "inputFormat": "The first line contains two integers $n$ ($2\\leq n\\leq 10 ^ 5$) and $m$ ($1\\leq m\\leq 5$).\n\nThe $i$-th of the next $m$ lines contains $n$ intergers $a_{i, 1}, a_{i, 2}, \\ldots, a_{i, n}$. It is guaranteed that $a_i$ is a permutaion of $1,2,\\ldots,n$.\n\nThe next line contains an integer $q$ ($1\\leq q\\leq 10 ^ 5$).\n\nEach of the next $q$ lines contains two integers $x$ and $y$ ($1 \\le x,y \\le n, x \\neq y$), representing a query.", "outputFormat": "For each query, output a number $l$ representing the answer. If there is no legal $l$, output $-1$.", "hint": "**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem D.\n\n**Author**: csy2005.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2022 Xi'an R] Contests", "background": "", "description": "$n$ 个选手参加了 $m$ 场比赛。给出每场比赛的排行榜。第 $k$ 场比赛的排行榜是一个 $n$ 阶排列 $a_k$，表示选手 $a_{k, i}$ 的排名为 $i$。\n\nSolarPea 和 PolarSea 也是选手。SolarPea 想要证明他比 PolarSea 更强。\n\n定义选手 $x$「$l$ - 强于」选手 $y$，当且仅当存在长度为 $l + 1$ 的序列，满足 $b_1 = x$，$b_{l + 1} = y$，且对于所有 $1\\leq i\\leq l$，均有 $b_i$ 在至少一场比赛中排名小于 $b_{i + 1}$。\n\n给出 $q$ 组询问。在第 $i$ 组询问中，SolarPea 是选手 $x$，PolarSea 是选手 $y$。求出最小的正整数 $l$，使得 $x$「$l$ - 强于」$y$。\n\n$2\\leq n\\leq 10 ^ 5$，$1\\leq q\\leq 10 ^ 5$，$1\\leq m\\leq 5$，$1\\leq x, y\\leq n$，$x\\neq y$。", "inputFormat": "第一行两个整数 $n, m$。\n\n接下来 $m$ 行，每行 $n$ 个整数，表示第 $i$ 场比赛的排行榜。保证 $a_i$ 是 $1, 2, \\ldots, n$ 的排列。\n\n接下来一行一个整数 $q$。\n\n接下来 $q$ 行，每行两个整数 $x, y$ 表示一组询问。", "outputFormat": "对于每组询问，输出一行一个整数表示答案。若不存在这样的 $l$，输出 $-1$。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P9362", "type": "P", "difficulty": 4, "samples": [["10\n1 2\n1 3\n1 4\n1 5\n2 3\n2 4\n2 5\n3 4\n3 5\n4 5\n", "3\n3\n4\n5\n3\n4\n5\n4\n5\n5\n"]], "limits": {"time": [1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288]}, "tags": ["数学", "贪心", "2022", "O2优化", "数位 DP", "ICPC", "西安"], "title": "[ICPC 2022 Xi'an R] Find Maximum", "background": "", "description": "We define a function $f(x)$ over all non-negative integer $x$ as follows:\n$$\nf(x) =\n\\begin{cases}\n1 & (x = 0) \\\\\nf(\\frac{x}{3}) + 1 & (x > 0\\land x\\bmod3 = 0) \\\\\nf(x - 1) + 1  & (x > 0\\land x\\bmod 3\\neq 0)\n\\end{cases}\n$$\nCalculate $\\max_{x = l} ^ r f(x)$.\n\nYou need to answer $T$ queries independently.", "inputFormat": "The first line contains a single integer $T$ ($1\\leq T\\leq 10 ^ 4$).\n\nEach of the next $T$ lines contains two integers $l$ and $r$ ($1\\leq l\\leq r\\leq 10 ^ {18}$), representing a query.", "outputFormat": "Output $T$ lines. The $i$-th line contains a single integer, representing the answer to the $i$-th query.", "hint": "**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem E.\n\n**Author**: MagicSpark.", "locale": "en", "translations": {"en": {"title": "[ICPC 2022 Xi'an R] Find Maximum", "background": "", "description": "We define a function $f(x)$ over all non-negative integer $x$ as follows:\n$$\nf(x) =\n\\begin{cases}\n1 & (x = 0) \\\\\nf(\\frac{x}{3}) + 1 & (x > 0\\land x\\bmod3 = 0) \\\\\nf(x - 1) + 1  & (x > 0\\land x\\bmod 3\\neq 0)\n\\end{cases}\n$$\nCalculate $\\max_{x = l} ^ r f(x)$.\n\nYou need to answer $T$ queries independently.", "inputFormat": "The first line contains a single integer $T$ ($1\\leq T\\leq 10 ^ 4$).\n\nEach of the next $T$ lines contains two integers $l$ and $r$ ($1\\leq l\\leq r\\leq 10 ^ {18}$), representing a query.", "outputFormat": "Output $T$ lines. The $i$-th line contains a single integer, representing the answer to the $i$-th query.", "hint": "**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem E.\n\n**Author**: MagicSpark.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2022 Xi'an R] Find Maximum", "background": "", "description": "定义在所有非负整数 $x$ 上的函数 $f(x)$ 如下：\n\n$$\nf(x) =\n\\begin{cases}\n1 & (x = 0) \\\\\nf(\\frac{x}{3}) + 1 & (x > 0\\land x\\bmod3 = 0) \\\\\nf(x - 1) + 1  & (x > 0\\land x\\bmod 3\\neq 0)\n\\end{cases}\n$$\n\n计算 $\\max_{x = l} ^ r f(x)$。\n\n共有 $T$ 组数据。\n\n$1\\leq T\\leq 10 ^ 4$，$1\\leq l\\leq r\\leq 10 ^ {18}$。", "inputFormat": "第一行一个整数 $T$。\n\n接下来 $T$ 行，每行两个整数 $l, r$ 表示一组询问。", "outputFormat": "对于每组询问，输出一行一个整数表示答案。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P9363", "type": "P", "difficulty": 3, "samples": [["3 1 3\nMMM\nMMM\nFFF\n", "9\n"], ["3 3 1\nABC\nDEF\nGHI\n", "9\n"], ["10 438 438\nWWW\nSOU\nPUN\nETC\nOME\nCFI\nNAL\nGOO\nDHO\nTEL\n", "12264\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2022", "O2优化", "ICPC", "西安"], "title": "[ICPC 2022 Xi'an R] Hotel", "background": "", "description": "You are doing volunteer work for a programming competition in an ancient hotel. Unfortunately, the hotel provides no phone signal or tap water since it can be dated back to the Qin Dynasty, and you have to assign the contestants to the hotel rooms manually instead of using the internet apps. Fortunately, the hotel has sufficient rooms, and you have taken a computer that lets you do some computation locally.\n\nThere are $n$ teams, each with exactly $3$ contestants. There are $2$ types of rooms in the hotel, the single room and double room, which can receive at most $1$ and $2$ contestants, respectively. To avoid embarrassing contestants, if two contestants are assigned to a double room, they must come from the same team and have the same gender.\n\nThe cost of each room of the same type is the same, but different types may have different costs. Your program needs to calculate the minimum price the host has to pay. The teams are waiting in the registration hall now, and the competition finance officer relies on you to save costs and make a fortune by the residual value. Be quick, or the finance officer will sue you for violating his reputation!", "inputFormat": "The first line of input contains three integers $n$, $c_1$ and $c_2$ ($1 \\leq n, c_1, c_2 \\leq 1\\,000$), denoting the number of teams, the cost of a single room and a double room respectively.\n\nIn the following $n$ lines, each line contains a string $S$ with exactly $3$ uppercase English letters. The letters in a string denote the genders of the contestants in one team and will be represented by $\\texttt{A}$ to $\\texttt{Z}$, respecting the diversity of human beings.", "outputFormat": "The output should contain a single integer, denoting the minimum cost of hotel allocation for contestants.", "hint": "**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem F.\n\n**Author**: fstqwq.", "locale": "en", "translations": {"en": {"title": "[ICPC 2022 Xi'an R] Hotel", "background": "", "description": "You are doing volunteer work for a programming competition in an ancient hotel. Unfortunately, the hotel provides no phone signal or tap water since it can be dated back to the Qin Dynasty, and you have to assign the contestants to the hotel rooms manually instead of using the internet apps. Fortunately, the hotel has sufficient rooms, and you have taken a computer that lets you do some computation locally.\n\nThere are $n$ teams, each with exactly $3$ contestants. There are $2$ types of rooms in the hotel, the single room and double room, which can receive at most $1$ and $2$ contestants, respectively. To avoid embarrassing contestants, if two contestants are assigned to a double room, they must come from the same team and have the same gender.\n\nThe cost of each room of the same type is the same, but different types may have different costs. Your program needs to calculate the minimum price the host has to pay. The teams are waiting in the registration hall now, and the competition finance officer relies on you to save costs and make a fortune by the residual value. Be quick, or the finance officer will sue you for violating his reputation!", "inputFormat": "The first line of input contains three integers $n$, $c_1$ and $c_2$ ($1 \\leq n, c_1, c_2 \\leq 1\\,000$), denoting the number of teams, the cost of a single room and a double room respectively.\n\nIn the following $n$ lines, each line contains a string $S$ with exactly $3$ uppercase English letters. The letters in a string denote the genders of the contestants in one team and will be represented by $\\texttt{A}$ to $\\texttt{Z}$, respecting the diversity of human beings.", "outputFormat": "The output should contain a single integer, denoting the minimum cost of hotel allocation for contestants.", "hint": "**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem F.\n\n**Author**: fstqwq.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2022 Xi'an R] Hotel", "background": "", "description": "你正在一个古代的酒店里为一场编程竞赛做志愿工作。酒店的历史可以追溯到秦朝，所以酒店不提供手机信号和自来水。你无法使用网络软件，不得不手动为参赛者分配房间。幸运的是，酒店拥有充足的房间，并且你有一台电脑帮你做一些计算。\n\n共有 $n$ 个队伍，每个队伍恰有 $3$ 名选手。酒店有两种房间，单人间和双人间，分别可以容纳 $1$ 和 $2$ 名选手。为了避免使选手尴尬，如果两名选手分配到了同一个双人间，他们必须来自同一个队伍，并拥有相同的性别。\n\n相同种类的房间的花费相同，但不同种类的房间花费可能不同。你需要计算主办方最少需要花多少钱。选手们已经在登记厅等候多时，而竞赛财务经理依靠你来节省开支，私吞剩下来的钱发大财。你需要尽快完成任务，否则财务经理将起诉你侵犯了他的名誉权！\n\n$1\\leq n, c_1, c_2\\leq 1000$。", "inputFormat": "第一行三个整数 $n, c_1, c_2$，分别表示队伍数量，单人间单价和双人间单价。\n\n接下来的 $n$ 行，每行一个长度为 $3$ 的字符串 $S$ 表示一个队伍的参赛队员的性别。为了尊重人类的多样性，$S$ 可能包含从 $\\texttt A$ 到 $\\texttt Z$ 的所有大写字母。", "outputFormat": "输出一行一个整数表示分配房间的最小代价。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P9364", "type": "P", "difficulty": 4, "samples": [["4\na\nt\nb\nab\n", "2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2022", "O2优化", "ICPC", "西安"], "title": "[ICPC 2022 Xi'an R] Perfect Word", "background": "", "description": "You are given $n$ strings and required to find the length of the longest *perfect word*.\n\nA string $t$ is called a *perfect word*, if and only if every non-empty substring of $t$ appears in the given strings.\n\nA string $s$ is called a substring of $t$ if and only if it can be obtained by removing several (possibly zero) characters from the beginning or end of $t$.\n", "inputFormat": "The first line contains a single integer $n$ ($1 \\leq n \\leq 10 ^ 5$).\n\nEach of the next $n$ lines contains a string consisting of lowercase English letters.\n\nIt is guaranteed that the total length of the given strings is no more than $10 ^ 5$.\n", "outputFormat": "Output an integer, representing the length of the longest perfect word.\n", "hint": "**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem G.\n\n**Author**: MonkeyKing.", "locale": "en", "translations": {"en": {"title": "[ICPC 2022 Xi'an R] Perfect Word", "background": "", "description": "You are given $n$ strings and required to find the length of the longest *perfect word*.\n\nA string $t$ is called a *perfect word*, if and only if every non-empty substring of $t$ appears in the given strings.\n\nA string $s$ is called a substring of $t$ if and only if it can be obtained by removing several (possibly zero) characters from the beginning or end of $t$.\n", "inputFormat": "The first line contains a single integer $n$ ($1 \\leq n \\leq 10 ^ 5$).\n\nEach of the next $n$ lines contains a string consisting of lowercase English letters.\n\nIt is guaranteed that the total length of the given strings is no more than $10 ^ 5$.\n", "outputFormat": "Output an integer, representing the length of the longest perfect word.\n", "hint": "**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem G.\n\n**Author**: MonkeyKing.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2022 Xi'an R] Perfect Word", "background": "", "description": "给定 $n$ 个字符串，你需要找到最长的「完美单词」。\n\n字符串 $t$ 称为「完美单词」，当且仅当它的所有非空子串都出现在给定的字符串中。\n\n字符串 $s$ 称为 $t$ 的子串，当且仅当 $s$ 可由 $t$ 在开头和结尾分别删去零个或若干个字符得到。\n\n$1\\leq n\\leq 10 ^ 5$，字符串仅由小写字母组成，且总长不超过 $10 ^ 5$。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行一个字符串。", "outputFormat": "输出一行一个整数表示最长的「完美单词」的长度。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P9365", "type": "P", "difficulty": 6, "samples": [["4\n4 3 0 1\n1 0 1 0\n4 1 0 3\n1 0 1 0\n8 0 2 6\n1 5 5 7 1 5 5 7\n8 0 0 8\n1 5 5 7 1 5 5 7\n", "0010\n&&^&\n0 0 1 1\n0011\n^^&^\n0 1 0 1\n10100000\n^^|^^^^|\n1 5 5 7 1 5 5 7\n00000000\n^^^^^^^^\n1 5 5 7 1 5 5 7\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2022", "Special Judge", "O2优化", "构造", "ICPC", "分类讨论", "西安"], "title": "[ICPC 2022 Xi'an R] Power of Two", "background": "", "description": "$$\n2 ^ {2 ^ {2 ^ {2 ^ {2 ^ {2 ^ {2 ^ {2 ^ {2 ^ {2}}}}}}}}}\n$$\n\nSolarPea likes blowing up PolarSea's blog by sending power tower of $2$. As the tower is too high, the stack of the web page overflows. So the blog no longer works.\n\nNow SolarPea has $n$ powers of two $a_1, a_2, \\ldots, a_n$, $x$ bitwise AND operators, $y$ bitwise OR operators and $z$ bitwise XOR operators. It is guaranteed that $n = x + y + z$.\n\nSolarpea wants to construct an arithmetic expression with these numbers and operators. Formally, define $x_0 = 0$ and $x_i = x_{i - 1}\\ \\mathrm{op}_i\\ b_i$, where $b$ is a permutation of $a$, which means we can rearrange $a$ to get $b$, and $\\mathrm{op}_i$ is one of the three types of bitwise operators above. Then $x_n$ is the result of the expresstion.\n\nThe larger the expression, the more likely it is to make PolarSea's blog unable to work. SolarPea wants you to help him to find the largest $x_n$ and construct such an expression. If there are multiple solutions, output any of them.\n\nYou need to process $T$ test cases independently.", "inputFormat": "The first line contains a single integer $T$ ($1\\leq T \\leq 10 ^ 5$), denoting the number of test cases.\n\nFor each test case, the first line contains four integers $n$, $x$, $y$ and $z$ ($0\\leq x, y, z\\leq n \\leq 65\\,536, n = x + y + z$). The next line contains $n$ integers $c_1, c_2, \\ldots, c_n$ ($0\\leq c_i < n$), where $a_i = 2 ^ {c_i}$.\n\nIt is guaranteed that the sum of $n$ over all test cases is no more than $1\\,048\\,576$.", "outputFormat": "For each test case, output three lines.\n\nThe first line contains a $01$-string of length $n$, representing the binary form of the largest $x_n$.\n\nThe next line contains a single $1$-indexed string $\\mathrm{op}$ of length $n$, where $\\mathrm{op}_i$ represents the $i$-th operator. Here, we denote AND as `&` (ASCII 38), OR as `|` (ASCII 124), and XOR as `^` (ASCII 94). You should guarantee that there is exactly $x$ AND operators, $y$ OR operators and $z$ XOR operators.\n\nThe third line contains $n$ integers $d_1, d_2, \\ldots, d_n$, the $i$-th of which representing the logarithm of $b_i$ with base $2$. That is, $d$ is a permutaion of $c$.\n\nIf there are multiple solutions, output any of them.", "hint": "**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem H.\n\n**Author**: Alex_Wei.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g2frgx9s.png)", "locale": "en", "translations": {"en": {"title": "[ICPC 2022 Xi'an R] Power of Two", "background": "", "description": "$$\n2 ^ {2 ^ {2 ^ {2 ^ {2 ^ {2 ^ {2 ^ {2 ^ {2 ^ {2}}}}}}}}}\n$$\n\nSolarPea likes blowing up PolarSea's blog by sending power tower of $2$. As the tower is too high, the stack of the web page overflows. So the blog no longer works.\n\nNow SolarPea has $n$ powers of two $a_1, a_2, \\ldots, a_n$, $x$ bitwise AND operators, $y$ bitwise OR operators and $z$ bitwise XOR operators. It is guaranteed that $n = x + y + z$.\n\nSolarpea wants to construct an arithmetic expression with these numbers and operators. Formally, define $x_0 = 0$ and $x_i = x_{i - 1}\\ \\mathrm{op}_i\\ b_i$, where $b$ is a permutation of $a$, which means we can rearrange $a$ to get $b$, and $\\mathrm{op}_i$ is one of the three types of bitwise operators above. Then $x_n$ is the result of the expresstion.\n\nThe larger the expression, the more likely it is to make PolarSea's blog unable to work. SolarPea wants you to help him to find the largest $x_n$ and construct such an expression. If there are multiple solutions, output any of them.\n\nYou need to process $T$ test cases independently.", "inputFormat": "The first line contains a single integer $T$ ($1\\leq T \\leq 10 ^ 5$), denoting the number of test cases.\n\nFor each test case, the first line contains four integers $n$, $x$, $y$ and $z$ ($0\\leq x, y, z\\leq n \\leq 65\\,536, n = x + y + z$). The next line contains $n$ integers $c_1, c_2, \\ldots, c_n$ ($0\\leq c_i < n$), where $a_i = 2 ^ {c_i}$.\n\nIt is guaranteed that the sum of $n$ over all test cases is no more than $1\\,048\\,576$.", "outputFormat": "For each test case, output three lines.\n\nThe first line contains a $01$-string of length $n$, representing the binary form of the largest $x_n$.\n\nThe next line contains a single $1$-indexed string $\\mathrm{op}$ of length $n$, where $\\mathrm{op}_i$ represents the $i$-th operator. Here, we denote AND as `&` (ASCII 38), OR as `|` (ASCII 124), and XOR as `^` (ASCII 94). You should guarantee that there is exactly $x$ AND operators, $y$ OR operators and $z$ XOR operators.\n\nThe third line contains $n$ integers $d_1, d_2, \\ldots, d_n$, the $i$-th of which representing the logarithm of $b_i$ with base $2$. That is, $d$ is a permutaion of $c$.\n\nIf there are multiple solutions, output any of them.", "hint": "**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem H.\n\n**Author**: Alex_Wei.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g2frgx9s.png)", "locale": "en"}, "zh-CN": {"title": "[ICPC 2022 Xi'an R] Power of Two", "background": "", "description": "SolarPea 喜欢通过发送电力塔来炸毁 PolarSea 的博客 $2$。由于塔太高，网页的堆栈溢出。所以博客已经不能用了。  \n\n现在 SolarPea 拥有两个 $a_1、a_2、ldots、a_n$、$x$ 位 AND 运算符、$y$ 位 OR 运算符和 $z$ 位 XOR 运算符的 $n$ 次方。保证 $n = x + y + z$。  \n\nSolarpea 希望使用这些数字和运算符构造一个算术表达式。正式地定义 $x_0 = 0$ 和 $x_i = x_{i - 1}\\ \\mathrm{op}_i\\ b_i$，其中 $b$ 是 $a$ 的排列，这意味着我们可以重新排列 $a$ 来得到 $b$，而 $\\mathrm{op}_i$ 是上述三种类型的按位运算符之一。那么 $x_n$ 就是表达式的结果。\n\n表达式越大，就越有可能使 PolarSea 的博客无法工作。SolarPea 希望你帮他找到最大的 $x_n$ 并构造这样的表达式。如果有多个解决方案，则输出其中任何一个。\n\n您需要独立处理 $T$ 个测试用例。", "inputFormat": "第一行包含一个整数 $T $ （$1\\leq T \\leq 10 ^ 5$），表示测试用例的数量。  \n\n对于每个测试用例，第一行包含四个整数 $n$， $x$， $y$ 和 $z$ （$0\\leq x, y, z\\leq n \\leq 65\\,536, n = x + y + z$）。下一行包含 $n$ 个整数 $c_1, c_2, \\ldots, c_n$ ($0\\leq c_i < n$)，其中 $a_i = 2 ^ {c_i}$。\n\n保证所有测试用例的 $n $ 之和不超过 $1\\,048\\,576$。", "outputFormat": "对于每个测试用例，输出 3 行。  \n\n第一行包含一个长度为 $n$ 的 $01$ 字符串，表示最大 $x_n$ 的二进制形式。  \n\n下一行包含一个长度为 $n$ 的 $1$ 索引字符串 $\\mathrm{op}$，其中 $\\mathrm{op}_i$表示第 $i$ 个运算符。在这里，我们将 AND 表示为 `&` （ASCII 38），OR 表示为 `|` （ASCII 124），将 XOR 表示为 `^` （ASCII 94）。您应该保证正好有 $x $ AND 运算符、$y$ OR 运算符和 $z$ XOR 运算符。\n\n第三行包含 $n$ 个整数 $d_1, d_2, \\ldots, d_n$，其中第 $i$ 个代表 $b_i$ 的对数，以 $2$ 为底。也就是说，$d$ 是 $c$ 的排列。\n\n如果有多个解决方案，则输出其中任何一个。\n\n## 输入输出样例\n无", "hint": "**来源**：2022 ICPC 亚洲习安区域赛问题 H.  \n**作者**： Alex_Wei.", "locale": "zh-CN"}}}
{"pid": "P9366", "type": "P", "difficulty": 7, "samples": [["2 5 3\n0 0 1 2\n1 1 2 1\n0 0 2 2\n", "30\n64\n0\n"], ["5 20 5\n0 0 5 5\n1 1 4 4\n2 2 3 3\n2 3 2 3\n1 2 5 2\n", "615136704\n443203969\n899931333\n464755094\n679729107\n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2022", "O2优化", "ICPC", "西安"], "title": "[ICPC 2022 Xi'an R] Square Grid", "background": "", "description": "Given a square grid, its lattice points labeled from $(0, 0)$ to $(n, n)$, and a number $t$.\n\nYou need to answer $q$ queries in this format: given $A = (x_0, y_0)$ and $B = (x_1, y_1)$, how many ways are there to move from $A$ to $B$ in exactly $t$ steps so that in each step you move from a lattice point to one of its neighbors (up, down, left, right). Calculate the answer modulo $998\\,244\\,353$.", "inputFormat": "The first line contains three integers $n$ ($1 \\leq n \\leq 10^5$), $t$ ($1 \\leq t \\leq 10^9$) and $q$ ($1 \\leq q \\leq 3 \\times 10^5$).\n\nEach of the following $q$ lines contains four integers $x_0$, $y_0$, $x_1$ and $y_1$ ($0 \\leq x_0, y_0, x_1, y_1 \\leq n$), representing a query. ", "outputFormat": "For each query, output a line containing one integer, representing the answer to the query modulo $998\\,244\\,353$.", "hint": "**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem I.\n\n**Author**: djq_cpp.", "locale": "en", "translations": {"en": {"title": "[ICPC 2022 Xi'an R] Square Grid", "background": "", "description": "Given a square grid, its lattice points labeled from $(0, 0)$ to $(n, n)$, and a number $t$.\n\nYou need to answer $q$ queries in this format: given $A = (x_0, y_0)$ and $B = (x_1, y_1)$, how many ways are there to move from $A$ to $B$ in exactly $t$ steps so that in each step you move from a lattice point to one of its neighbors (up, down, left, right). Calculate the answer modulo $998\\,244\\,353$.", "inputFormat": "The first line contains three integers $n$ ($1 \\leq n \\leq 10^5$), $t$ ($1 \\leq t \\leq 10^9$) and $q$ ($1 \\leq q \\leq 3 \\times 10^5$).\n\nEach of the following $q$ lines contains four integers $x_0$, $y_0$, $x_1$ and $y_1$ ($0 \\leq x_0, y_0, x_1, y_1 \\leq n$), representing a query. ", "outputFormat": "For each query, output a line containing one integer, representing the answer to the query modulo $998\\,244\\,353$.", "hint": "**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem I.\n\n**Author**: djq_cpp.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2022 Xi'an R] Square Grid", "background": "", "description": "给定一个方形网格，其格点标记从 $(0, 0)$ 到 $(n, n)$，以及一个数字 $t$。\n\n你需要回答 $q$ 个查询，每个查询的格式为：给定 $A = (x_0, y_0)$ 和 $B = (x_1, y_1)$，有多少种方法可以在恰好 $t$ 步内从 $A$ 移动到 $B$，使得每一步都从一个格点移动到其相邻的格点（上、下、左、右）。计算答案对 $998\\,244\\,353$ 取模。", "inputFormat": "第一行包含三个整数 $n$ ($1 \\leq n \\leq 10^5$)，$t$ ($1 \\leq t \\leq 10^9$) 和 $q$ ($1 \\leq q \\leq 3 \\times 10^5$)。\n\n接下来的 $q$ 行中的每一行包含四个整数 $x_0$，$y_0$，$x_1$ 和 $y_1$ ($0 \\leq x_0, y_0, x_1, y_1 \\leq n$)，表示一个查询。", "outputFormat": "对于每个查询，输出一行包含一个整数，表示该查询的答案对 $998\\,244\\,353$ 取模。", "hint": "**来源**：2022 年 ICPC 亚洲西安区域赛问题 I。\n\n**作者**：djq_cpp。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P9367", "type": "P", "difficulty": 2, "samples": [["4\n1 4 3 2\n", "7\n"], ["3\n-10 -10 -10\n", "0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2022", "O2优化", "ICPC", "西安"], "title": "[ICPC 2022 Xi'an R] Strange Sum", "background": "", "description": "Given a sequence $a_1, a_2, \\ldots, a_n$.\n\nYou are going to select zero or more elements of $a$ so that: if you select $a_i$, then in any interval of length $i$ (formally, in $a[j, j + i - 1]$ for any $1 \\le j \\le n - i + 1$) you can select at most $2$ elements.\n\nCalculate the maximal sum of the elements you select.", "inputFormat": "The first line contains an integer $n$ ($2 \\leq n \\leq 10^5$).\n\nThe second line contains $n$ integers $a_1, a_2, \\ldots, a_n$ ($-10^9 \\leq a_i \\leq 10^9$).", "outputFormat": "Output a single integer denoting the answer.", "hint": "**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem J.\n\n**Author**: JohnVictor.", "locale": "en", "translations": {"en": {"title": "[ICPC 2022 Xi'an R] Strange Sum", "background": "", "description": "Given a sequence $a_1, a_2, \\ldots, a_n$.\n\nYou are going to select zero or more elements of $a$ so that: if you select $a_i$, then in any interval of length $i$ (formally, in $a[j, j + i - 1]$ for any $1 \\le j \\le n - i + 1$) you can select at most $2$ elements.\n\nCalculate the maximal sum of the elements you select.", "inputFormat": "The first line contains an integer $n$ ($2 \\leq n \\leq 10^5$).\n\nThe second line contains $n$ integers $a_1, a_2, \\ldots, a_n$ ($-10^9 \\leq a_i \\leq 10^9$).", "outputFormat": "Output a single integer denoting the answer.", "hint": "**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem J.\n\n**Author**: JohnVictor.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2022 Xi'an R] Strange Sum", "background": "", "description": "给定一个序列 $a_1, a_2, \\ldots, a_n$。\n\n你需要选择 $a$ 中的零个或多个元素，使得：如果你选择了 $a_i$，那么在任何长度为 $i$ 的区间内（形式上，对于任何 $1 \\le j \\le n - i + 1$ 的 $a[j, j + i - 1]$），最多可以选择 $2$ 个元素。\n\n计算你选择的元素的最大和。", "inputFormat": "第一行包含一个整数 $n$ ($2 \\leq n \\leq 10^5$)。\n\n第二行包含 $n$ 个整数 $a_1, a_2, \\ldots, a_n$ ($-10^9 \\leq a_i \\leq 10^9$)。", "outputFormat": "输出一个整数，表示答案。", "hint": "**来源**：2022 ICPC 亚洲西安区域赛问题 J。\n\n**作者**：JohnVictor。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P9368", "type": "P", "difficulty": 6, "samples": [["3 4 20\n1 3 4\n3 1 2\n1 3 4 7\n4 2 1 2\n1\n5\n6\n7\n9\n10\n11\n12\n15\n16\n17\n22\n23\n28\n30\n35\n43\n47\n49\n57\n", "0\n0\n1\n1\n1\n2\n2\n3\n3\n4\n4\n6\n6\n9\n9\n12\n12\n12\n18\n18\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2022", "O2优化", "ICPC", "西安"], "title": "[ICPC 2022 Xi'an R] Streets", "background": "", "description": "You are given $n$ vertical lines with x-coordinates $x_1, x_2, \\ldots, x_n$ and weights $a_1, a_2, \\ldots, a_n$ and $m$ horizontal lines with y-coordinates $y_1, y_2, \\ldots, y_m$ and weights $b_1, b_2, \\ldots, b_m$.\n\nCall a rectangle good if and only if all of its four edges lie on the given lines. On this basis, define the cost of a good rectangle as the sum of the costs of its four segments. The cost of a segment is the product of its length and the weight of the line it belongs.\n\nFind the maximum area of good rectangles with cost no more than $c$. Note that the length and the width of the rectangle can be zero, so the answer always exists.\n\nYou need to answer $T$ queries with different $c$.", "inputFormat": "The first line contains three integers $n$, $m$ ($2\\leq n, m\\leq 5\\,000$) and $T$ ($1\\leq T\\leq 100$).\n\nThe second line contains $n$ integers $x_1, x_2, \\ldots, x_n$ ($1\\leq x_1 < x_2 < \\ldots < x_n \\leq 10 ^ 5$).\n\nThe third line contains $n$ integers $a_1, a_2, \\ldots, a_n$ ($1\\leq a_i\\leq 10 ^ 7$).\n\nThe fourth line contains $m$ integers $y_1, y_2, \\ldots, y_m$ ($1\\leq y_1 < y_2 < \\ldots < y_m \\leq 10 ^ 5$).\n\nThe fifth line contains $m$ integers $b_1, b_2, \\ldots, b_m$ ($1\\leq b_i\\leq 10 ^ 7$).\n\nEach of the next $T$ lines contains a single integer $c$ ($1\\leq c\\leq 4\\times 10 ^ {12}$), representing a query.", "outputFormat": "For each query, output one line representing the answer.", "hint": "**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem K.\n\n**Author**: Alex_Wei.", "locale": "en", "translations": {"en": {"title": "[ICPC 2022 Xi'an R] Streets", "background": "", "description": "You are given $n$ vertical lines with x-coordinates $x_1, x_2, \\ldots, x_n$ and weights $a_1, a_2, \\ldots, a_n$ and $m$ horizontal lines with y-coordinates $y_1, y_2, \\ldots, y_m$ and weights $b_1, b_2, \\ldots, b_m$.\n\nCall a rectangle good if and only if all of its four edges lie on the given lines. On this basis, define the cost of a good rectangle as the sum of the costs of its four segments. The cost of a segment is the product of its length and the weight of the line it belongs.\n\nFind the maximum area of good rectangles with cost no more than $c$. Note that the length and the width of the rectangle can be zero, so the answer always exists.\n\nYou need to answer $T$ queries with different $c$.", "inputFormat": "The first line contains three integers $n$, $m$ ($2\\leq n, m\\leq 5\\,000$) and $T$ ($1\\leq T\\leq 100$).\n\nThe second line contains $n$ integers $x_1, x_2, \\ldots, x_n$ ($1\\leq x_1 < x_2 < \\ldots < x_n \\leq 10 ^ 5$).\n\nThe third line contains $n$ integers $a_1, a_2, \\ldots, a_n$ ($1\\leq a_i\\leq 10 ^ 7$).\n\nThe fourth line contains $m$ integers $y_1, y_2, \\ldots, y_m$ ($1\\leq y_1 < y_2 < \\ldots < y_m \\leq 10 ^ 5$).\n\nThe fifth line contains $m$ integers $b_1, b_2, \\ldots, b_m$ ($1\\leq b_i\\leq 10 ^ 7$).\n\nEach of the next $T$ lines contains a single integer $c$ ($1\\leq c\\leq 4\\times 10 ^ {12}$), representing a query.", "outputFormat": "For each query, output one line representing the answer.", "hint": "**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem K.\n\n**Author**: Alex_Wei.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2022 Xi'an R] Streets", "background": "", "description": "给定 $n$ 条垂直的线和 $m$ 条水平线，每条线有重量。定义一个矩形是好的，当且仅当矩形的四个边都落在这些线上，好矩形的代价等于其内部四条边的长度与对应线重量的乘积之和。请找出最大面积的好矩形，使得其代价不超过 $c$。注意，矩形的长度和宽度可以为零。", "inputFormat": "第一行三个正整数 $n,m,T(2 \\leq n, m \\leq 5 \\times 10^3, 1 \\leq T \\leq 100)$，依次表示垂直线、水平线的数量以及查询的次数。\n\n第二行 $n$ 个正整数 $x_1,x_2,\\cdots,x_n(1 \\leq x_1 < x_2 < \\cdots < x_n \\leq 10^5)$，其中 $x_i$ 表示第 $i$ 条垂直线的位置。\n\n第三行 $n$ 个正整数 $a_1,a_2,\\cdots,a_n$，其中 $a_i$ 表示第 $i$ 条垂直线的重量。\n\n第四行 $m$ 个正整数 $y_1,y_2,\\cdots,y_m(1 \\leq y_1 < y_2 < \\cdots < y_m \\leq 10^5)$，其中 $y_i$ 表示第 $i$ 条水平线的位置。\n\n第五行 $m$ 个正整数 $b_1,b_2,\\cdots,b_m(1 \\leq b_i \\leq 10^7)$，其中 $b_i$ 表示第 $i$ 条水平线的重量。\n\n接下来 $T$ 行，每行一个正整数 $c(1 \\leq c \\leq 4\\times 10^{12})$，表示一次查询。", "outputFormat": "对于每次查询，输出一个整数表示最小代价不超过 $c$ 的最大好矩形的面积。\n\ntranslated by @[cff_0102](/user/542457)", "hint": "", "locale": "zh-CN"}}}
{"pid": "P9369", "type": "P", "difficulty": 4, "samples": [["2\n7\n1 1 2 2 2 3\n5\n1 2 3 4\n", "3\n1\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2022", "O2优化", "ICPC", "西安"], "title": "[ICPC 2022 Xi'an R] Tree", "background": "", "description": "You are given a tree $T$ with $n$ nodes. The tree is rooted at $1$. Define $\\mathrm{subtree}(u)$ as the set of nodes in the subtree of $u$.\n\nCall a subset of nodes $S$ good if and only if $S$ satisfies at least one of the following contidions:\n\n- For all $u, v\\in S$ where $u\\neq v$, either $u\\in \\mathrm{subtree}(v)$ or $v\\in \\mathrm{subtree}(u)$.\n- For all $u, v\\in S$ where $u\\neq v$, both $u\\notin \\mathrm{subtree}(v)$ and $v\\notin \\mathrm{subtree}(u)$.\n\nYou need to partition all nodes of $T$ into several good subsets. Calculate the minimum number of subsets.\n", "inputFormat": "The first line contains a single integer $Q$ ($1\\leq Q\\leq 10 ^ 5$), denoting the number of test cases.\n\nFor each test case, the first line contains an integer $n$ ($1\\leq n\\leq 10 ^ 6$). The next line contains $n - 1$ integers $p_2, p_3, \\ldots, p_n$ ($1\\leq p_i < i$), indicating that there is an edge between $p_i$ and $i$ for each $i=2,3,\\ldots,n$.\n\nIt is guaranteed that the sum of $n$ over all test cases is no more than $10 ^ 6$.", "outputFormat": "For each test case, output a single integer representing the answer.", "hint": "**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem L.\n\n**Author**: Alex_Wei.", "locale": "en", "translations": {"en": {"title": "[ICPC 2022 Xi'an R] Tree", "background": "", "description": "You are given a tree $T$ with $n$ nodes. The tree is rooted at $1$. Define $\\mathrm{subtree}(u)$ as the set of nodes in the subtree of $u$.\n\nCall a subset of nodes $S$ good if and only if $S$ satisfies at least one of the following contidions:\n\n- For all $u, v\\in S$ where $u\\neq v$, either $u\\in \\mathrm{subtree}(v)$ or $v\\in \\mathrm{subtree}(u)$.\n- For all $u, v\\in S$ where $u\\neq v$, both $u\\notin \\mathrm{subtree}(v)$ and $v\\notin \\mathrm{subtree}(u)$.\n\nYou need to partition all nodes of $T$ into several good subsets. Calculate the minimum number of subsets.\n", "inputFormat": "The first line contains a single integer $Q$ ($1\\leq Q\\leq 10 ^ 5$), denoting the number of test cases.\n\nFor each test case, the first line contains an integer $n$ ($1\\leq n\\leq 10 ^ 6$). The next line contains $n - 1$ integers $p_2, p_3, \\ldots, p_n$ ($1\\leq p_i < i$), indicating that there is an edge between $p_i$ and $i$ for each $i=2,3,\\ldots,n$.\n\nIt is guaranteed that the sum of $n$ over all test cases is no more than $10 ^ 6$.", "outputFormat": "For each test case, output a single integer representing the answer.", "hint": "**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem L.\n\n**Author**: Alex_Wei.", "locale": "en"}, "zh-CN": {"title": "[ICPC 2022 Xi'an R] Tree", "background": "", "description": "给定大小为 $n$ 的有根树 $T$，根节点为 $1$。定义 $\\mathrm{subtree}(u)$ 表示结点 $u$ 的子树。\n\n称集合 $S$ 是好的，当且仅当 $S$ 至少满足下列条件之一：\n\n- 对于 $u, v\\in S$ 且 $u\\neq v$，$u\\in \\mathrm{subtree}(v)$ 或 $v\\in \\mathrm{subtree}(u)$。\n- 对于 $u, v\\in S$ 且 $u\\neq v$，$u\\notin \\mathrm{subtree}(v)$ 且 $v\\notin \\mathrm{subtree}(u)$。\n\n将 $T$ 划分为若干好的集合，求集合数量的最小值。\n\n共有 $Q$ 组数据。\n\n$1\\leq Q\\leq 10 ^ 5$，$1\\leq n, \\sum n\\leq 10 ^ 6$，每个点的父亲编号 $1\\leq p_i < i$。", "inputFormat": "第一行一个整数 $Q$。\n\n对于每组测试数据，第一行一个整数 $n$，第二行 $n - 1$ 个由空格隔开的整数 $p_2, p_3, \\cdots, p_n$，表示每个点的父亲编号。", "outputFormat": "对于每组测试数据，输出一行一个整数表示答案。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P9370", "type": "P", "difficulty": 5, "samples": [["3 2 30\n2\n1 2 1\n1 2 12\n2 0 4", "4"], ["4 4 30\n3\n1 0 2 1\n0 1 5\n0 2 4\n1 3 2\n2 3 4", "2"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["2023", "APIO", "交互题", "Special Judge", "O2优化"], "title": "[APIO2023] 赛博乐园 / cyberland", "background": "**由于部分 BUG，使用 C++14 (GCC9) 提交会产生编译错误，请使用 C++14 等语言进行提交。**\n\n提交时，无需引用 `cyberland.h`。你提交的代码中需要实现以下函数：\n\n```cpp\ndouble solve(int N, int M, int K, int H, std::vector<int> x, std::vector<int> y, std::vector<int> c, std::vector<int> arr)\n```", "description": "3742 年已经到来，现在轮到赛博乐园主办 APIO 了。在这个世界上有 $N$ 个国家，这些国家由 $0$ 到 $N − 1$ 标号，还有 $M$ 条双向道路（每条边双向都可以通行），这些道路由 $0$ 到 $M − 1$ 标号。每条道路连接两个不同的国家，$x[i]$ 和 $y[i]$，并需要花费时间 $c[i]$ 来通过该道路。除了你所在的国家的选手，所有选手都已经聚集在赛博乐园参加 APIO 了。你生活在国家 $0$，而赛博乐园是国家 $H$。你作为你的国家最聪明的人，你的帮助刻不容缓。更具体地，你需要确定从你的国家到达赛博乐园所需的最少时间。\n\n在经过有些国家时，你可以清除你的当前总通过时间。此外，还有些国家在你经过他们时可以将你的当前总通过时间除以 $2$（我们称之为“除以 $2$ 的能力”）。你可以重复经过一个国家。每次你经过一个国家时，你可以选择是否使用这个国家的特殊能力。但你每次经过一个国家时最多可以使用一次特殊能力（如果你多次经过一个国家，你每次经过都可以使用至多一次该国家的特殊能力）。此外，为了防止被赛博乐园化学基金会抓住，你最多只能使用“除以 $2$ 的能力”$K$ 次。一旦你到达赛博乐园，你就不能移动到其他任何地方，因为伟大的 APIO 竞赛即将开赛了！\n\n给出一个数组 $arr$ ，其中 $arr[i]$ 表示国家 $i (0 \\le i \\le N − 1)$ 的特殊能力。每个国家有下面 $3$ 种特殊能力之中的一种：\n\n - $arr[i] = 0$，意思是这个国家可以让当前总通过时间为 $0$。\n - $arr[i] = 1$，表示这个国家不会改变你的当前总通行时间。\n - $arr[i] = 2$，表示这个国家拥有让当前总通行时间除以 $2$ 的能力。\n\n保证 $arr[0] = arr[H] = 1$ 成立。换句话说，赛博乐园和你所在的国家没有任何特殊能力。\n\n你的国家不希望错过 APIO 的任何时刻，所以你需要找到到达赛博乐园的最短时间。如果你不能到达赛博乐园，你的答案应该是 $−1$。\n\n### 实现细节\n\n你需要实现以下函数：\n\n```cpp\ndouble solve(int N, int M, int K, int H, std::vector<int> x, std::vector<int> y, std::vector<int> c, std::vector<int> arr);\n```\n\n - $N$ : 国家的数量。\n - $M$ : 双向道路的数量。\n - $K$: “除以 $2$ 的能力”的最大使用次数。\n - $H$: 国家“赛博乐园”的标号。\n - $x, y, c$: 三个长度为 $M$ 的数组。三元组 $(x[i], y[i], c[i])$ 表示第 $i$ 条用来连接国家 $x[i]$ 和 $y[i]$ 的双向边，通过它的时间消耗是 $c[i]$。\n - $arr$: 一个长度为 $N$ 的数组。$arr[i]$ 表示国家 $i$ 的特殊能力。\n - 如果你能到达赛博乐园，调用该函数应返回从你的国家到达赛博乐园的最短时间，如果你不能，则返回 $−1$。\n - 这个过程可能会被多次调用。\n\n假设选手的答案为 $ans_1$ ，标准输出为 $ans_2$ ，当且仅当 $\\dfrac{|ans_1-ans_2|}{\\max\\{ans_2,1\\}} \\le 10 ^ {-6}$ 时你的输出被视为是正确的。\n\n注意：由于函数调用可能会发生多次，选手需要注意之前调用的残余数据对于后续调用的影响。", "inputFormat": "评测程序示例读取如下格式的输入：\n\n - 第 $1$ 行: $T$\n \n对于 $T$ 组测试数据中的每一个:\n - 第 $1$ 行: $N \\ M \\ K$\n - 第 $2$ 行: $H$\n - 第 $3$ 行: $arr[0] \\ arr[1] \\ arr[2] \\  \\cdots  \\ arr[N − 1]$\n - 第 $4 + i(0 \\le i \\le M − 1)$ 行: $x[i] \\ y[i]  \\ c[i]$", "outputFormat": "评测程序示例按照如下的格式打印你的答案：\n\n对于每组测试数据：\n\n- 第 $1$ 行: 调用 `solve` 的返回值", "hint": "### 例子\n\n#### 样例 1\n\n考虑下面的调用：\n\n```cpp\nsolve(3, 2, 30, 2, {1, 2}, {2, 0}, {12, 4}, {1, 2, 1});\n```\n\n唯一的到达赛博乐园的路径是 $0 \\rightarrow 2$，因为你到达了赛博乐园之后不能再移动到其他任何地方。通行时间的计算过程如下：\n\n| 国家编号 | 通行时间 |\n| :--: | :--: |\n| $0$ | $0$ |\n| $2$ | $0 + 4 \\rightarrow 4(\\text{求和}) \\rightarrow 4(\\text{特殊能力})$|\n\n#### 样例 2\n\n考虑下面的调用：\n\n```cpp\nsolve(4, 4, 30, 3, {0, 0, 1, 2}, {1, 2, 3, 3}, {5, 4, 2, 4}, {1, 0, 2, 1});\n```\n\n从你的国家到赛博乐园有两条路径：$0 \\rightarrow 1 \\rightarrow 3$ 和 $0 \\rightarrow 2 \\rightarrow 3$。\n\n如果选择路径 $0 \\rightarrow 1 \\rightarrow 3$，通行时间的计算如下：\n\n| 国家编号 | 通行时间 |\n| :--: | :--: |\n| $0$ | $0$ |\n| $1$ | $0 + 5 \\rightarrow 5(\\text{求和}) \\rightarrow 0(\\text{特殊能力})$|\n| $3$ | $0 + 2 \\rightarrow 2(\\text{求和}) \\rightarrow 2(\\text{特殊能力})$|\n\n如果选择路径 $0 \\rightarrow 2 \\rightarrow 3$，通行时间的计算如下：\n\n| 国家编号 | 通行时间 |\n| :--: | :--: |\n| $0$ | $0$ |\n| $2$ | $0 + 4 \\rightarrow 4(\\text{求和}) \\rightarrow 2(\\text{特殊能力})$|\n| $3$ | $2 + 4 \\rightarrow 6(\\text{求和}) \\rightarrow 6(\\text{特殊能力})$|\n\n所以，上述调用应该返回 $2$。\n\n### 约束条件\n\n - $2 \\le N \\le 10^5 , \\sum N \\le 10^5$.\n - $0 ≤ M ≤ \\min\\{10^5, \\dfrac{N(N-1)}{2} \\}, \\sum M ≤ 10^5$.\n - $1 \\le K \\le 10^6$.\n - $1 \\le H < N$\n - $0 \\le  x[i], y[i] < N , x[i] \\neq y[i]$.\n - $1 \\le c[i] \\le 10^9$.\n - $arr[i] \\in \\{0, 1, 2\\}$.\n - 保证每两个国家之间至多使用一条道路进行连接。\n\n### 子任务\n\n1. (5 分)：$N \\le 3, K \\le 30$.\n2. (8 分)：$M = N − 1, K \\le 30, arr[i] = 1$，你可以通过这 $M$ 条道路从任意国家到另外一个国家。\n3. (13 分)：$M = N − 1, K \\le 30, arr[i] \\in \\{0, 1\\}$，你可以通过这 $M$ 条道路从任意国家到另外一个国家。\n4. (19 分)：$M = N − 1, K \\le 30, x[i] = i, y[i] = i + 1$.\n5. (7 分)：$K \\le 30, arr[i] = 1$.\n6. (16 分)：$K \\le 30, arr[i] \\in \\{0, 1\\}$.\n7. (29 分)：$K \\le 30$.\n8. (3 分)：没有特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[APIO2023] 赛博乐园 / cyberland", "background": "**由于部分 BUG，使用 C++14 (GCC9) 提交会产生编译错误，请使用 C++14 等语言进行提交。**\n\n提交时，无需引用 `cyberland.h`。你提交的代码中需要实现以下函数：\n\n```cpp\ndouble solve(int N, int M, int K, int H, std::vector<int> x, std::vector<int> y, std::vector<int> c, std::vector<int> arr)\n```", "description": "3742 年已经到来，现在轮到赛博乐园主办 APIO 了。在这个世界上有 $N$ 个国家，这些国家由 $0$ 到 $N − 1$ 标号，还有 $M$ 条双向道路（每条边双向都可以通行），这些道路由 $0$ 到 $M − 1$ 标号。每条道路连接两个不同的国家，$x[i]$ 和 $y[i]$，并需要花费时间 $c[i]$ 来通过该道路。除了你所在的国家的选手，所有选手都已经聚集在赛博乐园参加 APIO 了。你生活在国家 $0$，而赛博乐园是国家 $H$。你作为你的国家最聪明的人，你的帮助刻不容缓。更具体地，你需要确定从你的国家到达赛博乐园所需的最少时间。\n\n在经过有些国家时，你可以清除你的当前总通过时间。此外，还有些国家在你经过他们时可以将你的当前总通过时间除以 $2$（我们称之为“除以 $2$ 的能力”）。你可以重复经过一个国家。每次你经过一个国家时，你可以选择是否使用这个国家的特殊能力。但你每次经过一个国家时最多可以使用一次特殊能力（如果你多次经过一个国家，你每次经过都可以使用至多一次该国家的特殊能力）。此外，为了防止被赛博乐园化学基金会抓住，你最多只能使用“除以 $2$ 的能力”$K$ 次。一旦你到达赛博乐园，你就不能移动到其他任何地方，因为伟大的 APIO 竞赛即将开赛了！\n\n给出一个数组 $arr$ ，其中 $arr[i]$ 表示国家 $i (0 \\le i \\le N − 1)$ 的特殊能力。每个国家有下面 $3$ 种特殊能力之中的一种：\n\n - $arr[i] = 0$，意思是这个国家可以让当前总通过时间为 $0$。\n - $arr[i] = 1$，表示这个国家不会改变你的当前总通行时间。\n - $arr[i] = 2$，表示这个国家拥有让当前总通行时间除以 $2$ 的能力。\n\n保证 $arr[0] = arr[H] = 1$ 成立。换句话说，赛博乐园和你所在的国家没有任何特殊能力。\n\n你的国家不希望错过 APIO 的任何时刻，所以你需要找到到达赛博乐园的最短时间。如果你不能到达赛博乐园，你的答案应该是 $−1$。\n\n### 实现细节\n\n你需要实现以下函数：\n\n```cpp\ndouble solve(int N, int M, int K, int H, std::vector<int> x, std::vector<int> y, std::vector<int> c, std::vector<int> arr);\n```\n\n - $N$ : 国家的数量。\n - $M$ : 双向道路的数量。\n - $K$: “除以 $2$ 的能力”的最大使用次数。\n - $H$: 国家“赛博乐园”的标号。\n - $x, y, c$: 三个长度为 $M$ 的数组。三元组 $(x[i], y[i], c[i])$ 表示第 $i$ 条用来连接国家 $x[i]$ 和 $y[i]$ 的双向边，通过它的时间消耗是 $c[i]$。\n - $arr$: 一个长度为 $N$ 的数组。$arr[i]$ 表示国家 $i$ 的特殊能力。\n - 如果你能到达赛博乐园，调用该函数应返回从你的国家到达赛博乐园的最短时间，如果你不能，则返回 $−1$。\n - 这个过程可能会被多次调用。\n\n假设选手的答案为 $ans_1$ ，标准输出为 $ans_2$ ，当且仅当 $\\dfrac{|ans_1-ans_2|}{\\max\\{ans_2,1\\}} \\le 10 ^ {-6}$ 时你的输出被视为是正确的。\n\n注意：由于函数调用可能会发生多次，选手需要注意之前调用的残余数据对于后续调用的影响。", "inputFormat": "评测程序示例读取如下格式的输入：\n\n - 第 $1$ 行: $T$\n \n对于 $T$ 组测试数据中的每一个:\n - 第 $1$ 行: $N \\ M \\ K$\n - 第 $2$ 行: $H$\n - 第 $3$ 行: $arr[0] \\ arr[1] \\ arr[2] \\  \\cdots  \\ arr[N − 1]$\n - 第 $4 + i(0 \\le i \\le M − 1)$ 行: $x[i] \\ y[i]  \\ c[i]$", "outputFormat": "评测程序示例按照如下的格式打印你的答案：\n\n对于每组测试数据：\n\n- 第 $1$ 行: 调用 `solve` 的返回值", "hint": "### 例子\n\n#### 样例 1\n\n考虑下面的调用：\n\n```cpp\nsolve(3, 2, 30, 2, {1, 2}, {2, 0}, {12, 4}, {1, 2, 1});\n```\n\n唯一的到达赛博乐园的路径是 $0 \\rightarrow 2$，因为你到达了赛博乐园之后不能再移动到其他任何地方。通行时间的计算过程如下：\n\n| 国家编号 | 通行时间 |\n| :--: | :--: |\n| $0$ | $0$ |\n| $2$ | $0 + 4 \\rightarrow 4(\\text{求和}) \\rightarrow 4(\\text{特殊能力})$|\n\n#### 样例 2\n\n考虑下面的调用：\n\n```cpp\nsolve(4, 4, 30, 3, {0, 0, 1, 2}, {1, 2, 3, 3}, {5, 4, 2, 4}, {1, 0, 2, 1});\n```\n\n从你的国家到赛博乐园有两条路径：$0 \\rightarrow 1 \\rightarrow 3$ 和 $0 \\rightarrow 2 \\rightarrow 3$。\n\n如果选择路径 $0 \\rightarrow 1 \\rightarrow 3$，通行时间的计算如下：\n\n| 国家编号 | 通行时间 |\n| :--: | :--: |\n| $0$ | $0$ |\n| $1$ | $0 + 5 \\rightarrow 5(\\text{求和}) \\rightarrow 0(\\text{特殊能力})$|\n| $3$ | $0 + 2 \\rightarrow 2(\\text{求和}) \\rightarrow 2(\\text{特殊能力})$|\n\n如果选择路径 $0 \\rightarrow 2 \\rightarrow 3$，通行时间的计算如下：\n\n| 国家编号 | 通行时间 |\n| :--: | :--: |\n| $0$ | $0$ |\n| $2$ | $0 + 4 \\rightarrow 4(\\text{求和}) \\rightarrow 2(\\text{特殊能力})$|\n| $3$ | $2 + 4 \\rightarrow 6(\\text{求和}) \\rightarrow 6(\\text{特殊能力})$|\n\n所以，上述调用应该返回 $2$。\n\n### 约束条件\n\n - $2 \\le N \\le 10^5 , \\sum N \\le 10^5$.\n - $0 ≤ M ≤ \\min\\{10^5, \\dfrac{N(N-1)}{2} \\}, \\sum M ≤ 10^5$.\n - $1 \\le K \\le 10^6$.\n - $1 \\le H < N$\n - $0 \\le  x[i], y[i] < N , x[i] \\neq y[i]$.\n - $1 \\le c[i] \\le 10^9$.\n - $arr[i] \\in \\{0, 1, 2\\}$.\n - 保证每两个国家之间至多使用一条道路进行连接。\n\n### 子任务\n\n1. (5 分)：$N \\le 3, K \\le 30$.\n2. (8 分)：$M = N − 1, K \\le 30, arr[i] = 1$，你可以通过这 $M$ 条道路从任意国家到另外一个国家。\n3. (13 分)：$M = N − 1, K \\le 30, arr[i] \\in \\{0, 1\\}$，你可以通过这 $M$ 条道路从任意国家到另外一个国家。\n4. (19 分)：$M = N − 1, K \\le 30, x[i] = i, y[i] = i + 1$.\n5. (7 分)：$K \\le 30, arr[i] = 1$.\n6. (16 分)：$K \\le 30, arr[i] \\in \\{0, 1\\}$.\n7. (29 分)：$K \\le 30$.\n8. (3 分)：没有特殊限制。", "locale": "zh-CN"}}}
{"pid": "P9371", "type": "P", "difficulty": 6, "samples": [["7\n1 2 3 1 2 1 3", "3"], ["9\n1 1 2 3 4 3 2 1 1", "2"], ["14\n2 6 2 5 3 4 2 1 4 3 5 6 3 2", "3"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["2023", "APIO", "交互题", "Special Judge", "O2优化"], "title": "[APIO2023] 序列 / sequence", "background": "**由于部分 BUG，使用 C++14 (GCC9) 提交会产生编译错误，请使用 C++14 等语言进行提交。**\n\n提交时，无需引用 `sequence.h`。你提交的代码中需要实现以下函数：\n\n```cpp\nint sequence(int N, std::vector<int> A)\n```", "description": "在迷人的 APIO 国，居住一位着年轻智慧的学生 Alice。Alice 对解决能挑战她数学能力的有趣问题有着永不满足的好奇心。一天，她在解决一个神秘的有关长为 $N$ 的序列 (即 $A[0], A[1], \\cdots, A[N-1]$ ) 的问题时遇到了困难，她无法抗拒探索答案的诱惑力。\n\n现在，她想要与你分享一些她的发现。不过，为了更好的理解，我们需要给出以下定义:\n\n- 定义 $W(l, r, x)$ 为 $\\sum_{i=l}^{r} \\mathbb{I}[A[i]=x]$, 即 $x$ 在 $A[l] \\cdots A[r]$ 中的出现次数。\n- 定义一个非空整数序列 $B[0] B[1] \\cdots B[k-1]$ 的中位数集合为 $S(\\{B[0], B[1] \\cdots B[k-1]\\})$, 然后 Alice 会展示如何分步计算中位数集合:\n\n○首先，将序列 $B[0], B[1], \\ldots, B[k-1]$ 按照升序排序，令排好序的序列为 $C[0], C[1], \\ldots, C[k-1]_{0}$\n\n○ 然后, $S(\\{B[0], B[1] \\cdots B[k-1]\\})=\\left\\{C\\left[\\left\\lfloor\\frac{k-1}{2}\\right]\\right], C\\left[\\left\\lceil\\frac{k-1}{2}\\right\\rceil\\right]\\right\\}$ 。\n\n○ 为了能更好的理解 $S$ 的计算，以下为一些例子:\n\n- $S(\\{6,3,5,4,6,2,3\\})=\\{4\\}$.\n- $S(\\{4,2,3,1\\})=\\{2,3\\}$\n- $S(\\{5,4,2,4\\})=\\{4\\}$.\n\n作为一道具有挑战性的问题, Alice 想对于所有的 $(l, r)(0 \\leq l \\leq r \\leq N-1)$ 找到其价值 $\\max _{x \\in S(l, r)} W(l, r, x)$ 的最大值。其中 $S(l, r)$ 代表 $A[l] \\cdots A[r]$ 导出的中位数集合（正如之前提到的 $S(A[l], \\cdots, A[r])$ )。虽然 Alice 已经得到了答案，她需要核对答案的正确性，所以她找到了你，希望你能编程解决问题。\n\n### 实现细节\n\n你需要实现如下的过程:\n\n```cpp\nint sequence(int N, std:: vector<int> A);\n```\n- $N$ ：序列 $A$ 的长度。\n- $A$ : 一个长度为 $N$ 的数组，即输入中提到的序列 $A$ 。\n- 该函数应返回一个整数，代表所有可行 $(l, r)$ 价值的最大值。\n- 这个函数恰好被调用一次。\n", "inputFormat": "评测程序示例读取如下格式的输入:\n\n第 $1$ 行: $N$\n\n第 $2$ 行: $A[0] A[1] \\cdots A[N-1]$", "outputFormat": "评测程序示例按照如下的格式打印你的答案:\n\n第 $1$ 行：`sequence` 的返回值。", "hint": "### 例子\n\n#### 样例 1\n\n考虑如下的调用:\n\n```cpp\nsequence(7,{1,2,3,1,2,1,3});\n```\n\n函数应返回 $3$。\n\n在这个样例中, $S(0,5)=\\{1,2\\}, W(0,5,1)=3 ， W(0,5,2)=2$ ，所以 $(0,5)$ 的价值为 3 。\n\n容易验证 $(0,5)$ 在所有合法的 $(l, r)$ 二元组中有着最大的价值。\n\n#### 样例 2\n\n考虑如下的调用:\n\n```cpp\nsequence(9,{1,1,2,3,4,3,2,1,1});\n```\n\n函数应返回 $2$。\n\n### 样例 3\n\n考虑如下的调用:\n\n```cpp\nsequence(14,{2,6,2,5,3,4,2,1,4,3,5,6,3,2});\n```\n\n函数应返回 $3$。\n\n### 约束条件\n\n- $1 \\leq N \\leq 5 \\times 10^{5}$\n- $1 \\leq A[i] \\leq N$\n\n### 子任务\n\n1. (11 分)：$N \\leq 100$ 。\n2. (17 分)：$N \\le 2 \\times 10^{3}$ 。\n3. (7 分)：存在一个 $x$ 满足 $\\forall 0 \\leq i<x, A[i] \\leq A[i+1]$ 且 $\\forall x<i<N, A[i] \\leq A[i-1]$ 。\n4. (12 分)：$A[i] \\leq 3$ 。\n5. (13 分)：$W(0, N-1, A[i]) \\leq 2$ (对于所有满足 $0 \\leq i \\leq N-1$ 的 $i$ )。\n6. (22 分)：$N \\leq 8 \\times 10^{4}$ 。\n7. (18 分)：没有额外限制。 ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[APIO2023] 序列 / sequence", "background": "**由于部分 BUG，使用 C++14 (GCC9) 提交会产生编译错误，请使用 C++14 等语言进行提交。**\n\n提交时，无需引用 `sequence.h`。你提交的代码中需要实现以下函数：\n\n```cpp\nint sequence(int N, std::vector<int> A)\n```", "description": "在迷人的 APIO 国，居住一位着年轻智慧的学生 Alice。Alice 对解决能挑战她数学能力的有趣问题有着永不满足的好奇心。一天，她在解决一个神秘的有关长为 $N$ 的序列 (即 $A[0], A[1], \\cdots, A[N-1]$ ) 的问题时遇到了困难，她无法抗拒探索答案的诱惑力。\n\n现在，她想要与你分享一些她的发现。不过，为了更好的理解，我们需要给出以下定义:\n\n- 定义 $W(l, r, x)$ 为 $\\sum_{i=l}^{r} \\mathbb{I}[A[i]=x]$, 即 $x$ 在 $A[l] \\cdots A[r]$ 中的出现次数。\n- 定义一个非空整数序列 $B[0] B[1] \\cdots B[k-1]$ 的中位数集合为 $S(\\{B[0], B[1] \\cdots B[k-1]\\})$, 然后 Alice 会展示如何分步计算中位数集合:\n\n○首先，将序列 $B[0], B[1], \\ldots, B[k-1]$ 按照升序排序，令排好序的序列为 $C[0], C[1], \\ldots, C[k-1]_{0}$\n\n○ 然后, $S(\\{B[0], B[1] \\cdots B[k-1]\\})=\\left\\{C\\left[\\left\\lfloor\\frac{k-1}{2}\\right]\\right], C\\left[\\left\\lceil\\frac{k-1}{2}\\right\\rceil\\right]\\right\\}$ 。\n\n○ 为了能更好的理解 $S$ 的计算，以下为一些例子:\n\n- $S(\\{6,3,5,4,6,2,3\\})=\\{4\\}$.\n- $S(\\{4,2,3,1\\})=\\{2,3\\}$\n- $S(\\{5,4,2,4\\})=\\{4\\}$.\n\n作为一道具有挑战性的问题, Alice 想对于所有的 $(l, r)(0 \\leq l \\leq r \\leq N-1)$ 找到其价值 $\\max _{x \\in S(l, r)} W(l, r, x)$ 的最大值。其中 $S(l, r)$ 代表 $A[l] \\cdots A[r]$ 导出的中位数集合（正如之前提到的 $S(A[l], \\cdots, A[r])$ )。虽然 Alice 已经得到了答案，她需要核对答案的正确性，所以她找到了你，希望你能编程解决问题。\n\n### 实现细节\n\n你需要实现如下的过程:\n\n```cpp\nint sequence(int N, std:: vector<int> A);\n```\n- $N$ ：序列 $A$ 的长度。\n- $A$ : 一个长度为 $N$ 的数组，即输入中提到的序列 $A$ 。\n- 该函数应返回一个整数，代表所有可行 $(l, r)$ 价值的最大值。\n- 这个函数恰好被调用一次。\n", "inputFormat": "评测程序示例读取如下格式的输入:\n\n第 $1$ 行: $N$\n\n第 $2$ 行: $A[0] A[1] \\cdots A[N-1]$", "outputFormat": "评测程序示例按照如下的格式打印你的答案:\n\n第 $1$ 行：`sequence` 的返回值。", "hint": "### 例子\n\n#### 样例 1\n\n考虑如下的调用:\n\n```cpp\nsequence(7,{1,2,3,1,2,1,3});\n```\n\n函数应返回 $3$。\n\n在这个样例中, $S(0,5)=\\{1,2\\}, W(0,5,1)=3 ， W(0,5,2)=2$ ，所以 $(0,5)$ 的价值为 3 。\n\n容易验证 $(0,5)$ 在所有合法的 $(l, r)$ 二元组中有着最大的价值。\n\n#### 样例 2\n\n考虑如下的调用:\n\n```cpp\nsequence(9,{1,1,2,3,4,3,2,1,1});\n```\n\n函数应返回 $2$。\n\n### 样例 3\n\n考虑如下的调用:\n\n```cpp\nsequence(14,{2,6,2,5,3,4,2,1,4,3,5,6,3,2});\n```\n\n函数应返回 $3$。\n\n### 约束条件\n\n- $1 \\leq N \\leq 5 \\times 10^{5}$\n- $1 \\leq A[i] \\leq N$\n\n### 子任务\n\n1. (11 分)：$N \\leq 100$ 。\n2. (17 分)：$N \\le 2 \\times 10^{3}$ 。\n3. (7 分)：存在一个 $x$ 满足 $\\forall 0 \\leq i<x, A[i] \\leq A[i+1]$ 且 $\\forall x<i<N, A[i] \\leq A[i-1]$ 。\n4. (12 分)：$A[i] \\leq 3$ 。\n5. (13 分)：$W(0, N-1, A[i]) \\leq 2$ (对于所有满足 $0 \\leq i \\leq N-1$ 的 $i$ )。\n6. (22 分)：$N \\leq 8 \\times 10^{4}$ 。\n7. (18 分)：没有额外限制。 ", "locale": "zh-CN"}}}
{"pid": "P9373", "type": "P", "difficulty": 2, "samples": [["3\n1 0\n13 3\n198818800000 122122200000", "0 1\n8 5\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["Special Judge", "构造"], "title": "「DROI」Round 2 构造与取模", "background": "与其编写苍白无力的背景，不如出更有质量的题。\n\n", "description": "对于整数 $n,k$，若存在**非负整数** $x$ 与 **正整数** $y$ 满足：\n\n$$x + y = n\\ \\land\\ x \\bmod y =k$$\n\n则我们称有序数对 $(x,y)$ 是 $n$ 的一个 **优秀拆分**（其中 $\\land$  是**并且**的意思）。\n\n现给定非负整数 $n,k$，请你构造**任意**一组 $n$ 的优秀拆分，并分别输出你构造方案中的 $x$ 和 $y$。特殊地，若不存在这样的拆分，则输出 `-1`。", "inputFormat": "**本题有多组数据。**\n\n第一行一个正整数 $T$，表示数据组数。\n\n接下来 $T$ 行，每行两个非负整数，分别为 $n,k$。", "outputFormat": "输出共 $T$ 行，第 $i$ 行表示第 $i$ 组数据的答案。", "hint": "#### 样例解释\n\n对于第一组数据，只存在唯一的构造方式。\n\n对于第二组数据，$(3,10)$ 也是一组合法的构造。\n\n对于第三组数据，可以证明不存在一组合法的构造。\n\n------------\n\n#### 数据范围\n\n**「本题采用捆绑测试」**\n\n- $\\operatorname{Subtask} 1(20\\%)$：$n \\leq 10^6$。\n\n- $\\operatorname{Subtask} 2(40\\%)$：$n \\leq 10^{12}$。\n\n- $\\operatorname{Subtask} 3(40\\%)$：无特殊限制。\n\n对于 $100\\%$ 的数据：$T \\leq 5$，$0 \\leq n,k \\leq 10^{18}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DROI」Round 2 构造与取模", "background": "与其编写苍白无力的背景，不如出更有质量的题。\n\n", "description": "对于整数 $n,k$，若存在**非负整数** $x$ 与 **正整数** $y$ 满足：\n\n$$x + y = n\\ \\land\\ x \\bmod y =k$$\n\n则我们称有序数对 $(x,y)$ 是 $n$ 的一个 **优秀拆分**（其中 $\\land$  是**并且**的意思）。\n\n现给定非负整数 $n,k$，请你构造**任意**一组 $n$ 的优秀拆分，并分别输出你构造方案中的 $x$ 和 $y$。特殊地，若不存在这样的拆分，则输出 `-1`。", "inputFormat": "**本题有多组数据。**\n\n第一行一个正整数 $T$，表示数据组数。\n\n接下来 $T$ 行，每行两个非负整数，分别为 $n,k$。", "outputFormat": "输出共 $T$ 行，第 $i$ 行表示第 $i$ 组数据的答案。", "hint": "#### 样例解释\n\n对于第一组数据，只存在唯一的构造方式。\n\n对于第二组数据，$(3,10)$ 也是一组合法的构造。\n\n对于第三组数据，可以证明不存在一组合法的构造。\n\n------------\n\n#### 数据范围\n\n**「本题采用捆绑测试」**\n\n- $\\operatorname{Subtask} 1(20\\%)$：$n \\leq 10^6$。\n\n- $\\operatorname{Subtask} 2(40\\%)$：$n \\leq 10^{12}$。\n\n- $\\operatorname{Subtask} 3(40\\%)$：无特殊限制。\n\n对于 $100\\%$ 的数据：$T \\leq 5$，$0 \\leq n,k \\leq 10^{18}$。", "locale": "zh-CN"}}}
{"pid": "P9374", "type": "P", "difficulty": 5, "samples": [["5 998244353\n1\n3\n5\n12\n888", "1\n16\n986\n328006912\n535268381"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["图论", "O2优化", "组合数学"], "title": "「DROI」Round 2 单图", "background": "与其编写苍白无力的背景，不如出更有质量的题。", "description": "我们称[简单有向图](https://www.luogu.com.cn/paste/4oz6fep2) $G,H$ **本质相同**，当且仅当：\n\n- 对于任意点对 $(u,v)$，若在图 $G$ 中从 $u$ 出发能走到 $v$，则在图 $H$ 中从 $u$ 出发能走到 $v$。反之若在图 $H$ 中从 $u$ 出发能走到 $v$，则在图 $G$ 中从 $u$ 出发也能走到 $v$。\n\n若对于简单有向图 $G$，不存在其他简单有向图 $H$ 与其本质相同，则我们称图 $G$ 为 **单图**。\n\n$T$ 次询问，每次询问给定一个正整数 $n$，请你回答 $n$ 个点的**有标号**单图数。", "inputFormat": "**本题采用多组输入。**\n\n第一行输入两个整数 $T,mod$，表示数据组数与模数。\n\n接下来 $T$ 行每行一个整数，表示这组数据的 $n$。", "outputFormat": "输出 $T$ 行，第 $i$ 行表示第 $i$ 组数据的答案对 $mod$ 取模的值。", "hint": "#### 数据范围\n\n**「本题采用捆绑测试」** \n\n- $\\operatorname{Subtask} 1(30\\%)$：$T = 1$，$n \\leq 5$。\n\n- $\\operatorname{Subtask} 2(50\\%)$：$T \\leq 10$。\n\n- $\\operatorname{Subtask} 3(20\\%)$：无特殊限制。\n\n对于 $100\\%$ 的数据满足：$1 \\leq T,n \\leq 1000$，$1\\leq mod \\leq 10^9$。\n\n\n#### 说明提示\n\n这里给出一些例子来帮助理解单图的含义：\n\n------------\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/kykl8fg8.png)[](https://www.luogu.com.cn/paste/0tbbkesd)\n\n这是一张单图，可以证明不存在其他图与其本质相同。\n\n------------\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5appj8pr.png)\n\n这不是一张单图，因为我们可以添加边 $(5,2)$ 构造出与其本质相同的图。\n\n------------\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wtsep329.png)\n\n这不是一张单图，因为我们可以删去边 $(1,3)$ 构造出与其本质相同的图。\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DROI」Round 2 单图", "background": "与其编写苍白无力的背景，不如出更有质量的题。", "description": "我们称[简单有向图](https://www.luogu.com.cn/paste/4oz6fep2) $G,H$ **本质相同**，当且仅当：\n\n- 对于任意点对 $(u,v)$，若在图 $G$ 中从 $u$ 出发能走到 $v$，则在图 $H$ 中从 $u$ 出发能走到 $v$。反之若在图 $H$ 中从 $u$ 出发能走到 $v$，则在图 $G$ 中从 $u$ 出发也能走到 $v$。\n\n若对于简单有向图 $G$，不存在其他简单有向图 $H$ 与其本质相同，则我们称图 $G$ 为 **单图**。\n\n$T$ 次询问，每次询问给定一个正整数 $n$，请你回答 $n$ 个点的**有标号**单图数。", "inputFormat": "**本题采用多组输入。**\n\n第一行输入两个整数 $T,mod$，表示数据组数与模数。\n\n接下来 $T$ 行每行一个整数，表示这组数据的 $n$。", "outputFormat": "输出 $T$ 行，第 $i$ 行表示第 $i$ 组数据的答案对 $mod$ 取模的值。", "hint": "#### 数据范围\n\n**「本题采用捆绑测试」** \n\n- $\\operatorname{Subtask} 1(30\\%)$：$T = 1$，$n \\leq 5$。\n\n- $\\operatorname{Subtask} 2(50\\%)$：$T \\leq 10$。\n\n- $\\operatorname{Subtask} 3(20\\%)$：无特殊限制。\n\n对于 $100\\%$ 的数据满足：$1 \\leq T,n \\leq 1000$，$1\\leq mod \\leq 10^9$。\n\n\n#### 说明提示\n\n这里给出一些例子来帮助理解单图的含义：\n\n------------\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/kykl8fg8.png)[](https://www.luogu.com.cn/paste/0tbbkesd)\n\n这是一张单图，可以证明不存在其他图与其本质相同。\n\n------------\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5appj8pr.png)\n\n这不是一张单图，因为我们可以添加边 $(5,2)$ 构造出与其本质相同的图。\n\n------------\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wtsep329.png)\n\n这不是一张单图，因为我们可以删去边 $(1,3)$ 构造出与其本质相同的图。\n\n", "locale": "zh-CN"}}}
{"pid": "P9375", "type": "P", "difficulty": 5, "samples": [["6\n2 1 4899 4 1 4\n1 1 1 0 0 0", "9"], ["10\n1 1 1 2 4 3 3 3 8 8\n2 1 2 0 0 0 0 0 0 0", "24"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["O2优化", "记忆化搜索"], "title": "「DROI」Round 2 划分", "background": "与其编写苍白无力的背景，不如出更有质量的题。", "description": "给定长度为 $n$ 的序列 $A$。\n\n定义序列 $A$ 的某个子段 $[L,R]$ 的权值为: \n\n$$ \\sum_{i=L}^{R}[\\vert A_i - A_L \\vert是完全平方数] \\times \\sum_{i=L}^{R}[\\vert A_R - A_i \\vert是完全平方数]$$\n\n现在你需要将序列 $A$ **不重不漏**地划分成若干个子段，使得对于 $\\forall i \\in [1,n]$，长度为 $i$ 的子段有 $c_i$ 个。\n\n在此基础上，求一种划分方案使所有子段权值和最大，输出这个最大值即可。特殊地，若不存在任意一种划分方案，则输出 `-1`。\n\n**对题意不清楚的，可见下方说明提示。**\n", "inputFormat": "首先输入一个整数 $n$，表示序列 $A$ 的长度。\n\n然后输入一行 $n$ 个数，其中第 $i$ 个数表示 $A_i$。\n\n最后再输入一行 $n$ 个数，其中第 $i$ 个数表示 $c_i$。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "#### 样例解释\n对于样例一，一种最优划分是分别在第二、三个数后面将序列断开。\n\n对于样例二，一种最优划分是分别在第三、四、五、八个数后面将序列断开。\n\n\n------------\n\n#### 数据范围\n\n**「本题采用捆绑测试」**\n\n- $\\operatorname{Subtask} 1(10\\%)$：$n \\leq 20$。\n\n- $\\operatorname{Subtask} 2(20\\%)$：$n \\leq 50,\\sum_{i=1}^{n}c_i \\leq 20$。\n\n- $\\operatorname{Subtask} 3(20\\%)$：$n \\leq 50,\\forall i>5,c_i=0$。\n\n- $\\operatorname{Subtask} 4(50\\%)$：无特殊限制。\n\n对于 $100\\%$ 的数据：$0 \\leq c_i\\leq n \\leq 120,1 \\leq a_i \\leq 10^4$。\n\n------------\n\n#### 说明提示\n\n- 我们规定，$0$ 是完全平方数。\n\n- $[P]=1$ 当且仅当 $P$ 是真命题，否则 $[P]=0$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DROI」Round 2 划分", "background": "与其编写苍白无力的背景，不如出更有质量的题。", "description": "给定长度为 $n$ 的序列 $A$。\n\n定义序列 $A$ 的某个子段 $[L,R]$ 的权值为: \n\n$$ \\sum_{i=L}^{R}[\\vert A_i - A_L \\vert是完全平方数] \\times \\sum_{i=L}^{R}[\\vert A_R - A_i \\vert是完全平方数]$$\n\n现在你需要将序列 $A$ **不重不漏**地划分成若干个子段，使得对于 $\\forall i \\in [1,n]$，长度为 $i$ 的子段有 $c_i$ 个。\n\n在此基础上，求一种划分方案使所有子段权值和最大，输出这个最大值即可。特殊地，若不存在任意一种划分方案，则输出 `-1`。\n\n**对题意不清楚的，可见下方说明提示。**\n", "inputFormat": "首先输入一个整数 $n$，表示序列 $A$ 的长度。\n\n然后输入一行 $n$ 个数，其中第 $i$ 个数表示 $A_i$。\n\n最后再输入一行 $n$ 个数，其中第 $i$ 个数表示 $c_i$。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "#### 样例解释\n对于样例一，一种最优划分是分别在第二、三个数后面将序列断开。\n\n对于样例二，一种最优划分是分别在第三、四、五、八个数后面将序列断开。\n\n\n------------\n\n#### 数据范围\n\n**「本题采用捆绑测试」**\n\n- $\\operatorname{Subtask} 1(10\\%)$：$n \\leq 20$。\n\n- $\\operatorname{Subtask} 2(20\\%)$：$n \\leq 50,\\sum_{i=1}^{n}c_i \\leq 20$。\n\n- $\\operatorname{Subtask} 3(20\\%)$：$n \\leq 50,\\forall i>5,c_i=0$。\n\n- $\\operatorname{Subtask} 4(50\\%)$：无特殊限制。\n\n对于 $100\\%$ 的数据：$0 \\leq c_i\\leq n \\leq 120,1 \\leq a_i \\leq 10^4$。\n\n------------\n\n#### 说明提示\n\n- 我们规定，$0$ 是完全平方数。\n\n- $[P]=1$ 当且仅当 $P$ 是真命题，否则 $[P]=0$。\n", "locale": "zh-CN"}}}
{"pid": "P9376", "type": "P", "difficulty": 6, "samples": [["5 5\n7 6 5 8 9\n1 3 2\n2 5 2\n4 4 6\n3 5 4\n1 5 3", "5\n8\n0\n5 \n10"], ["8 4\n10 14 7 11 19 13 7 18 \n1 7 4\n3 8 2\n1 4 4\n1 4 2\n", "15\n18\n8\n11\n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["莫队", "树状数组", "O2优化", "可持久化线段树", "随机化"], "title": "「DROI」Round 2  进制与操作", "background": "与其编写苍白无力的背景，不如出更有质量的题。", "description": "定义数 $x$ 在 $B$ 进制下的一次操作为以下两种操作中的任意一种：\n\n- 令 $x \\rightarrow \\lfloor \\dfrac{x}{B} \\rfloor$。\n\n- 令 $x \\rightarrow x \\times B + t $。其中 $t \\in [0,B-1]$。\n\n现给定长度为 $n$ 的序列 $A$。$m$ 次询问，每次询问形如：\n\n- `l r B` 表示询问将序列 $A$ 中下标在 $[l,r]$ 之内的数在 $B$ 进制下操作，至少多少次才能将所有数变为相同（注：每次操作是对**一个数**进行操作）。\n\n**询问间相互独立，即操作不会真的进行。**\n\n", "inputFormat": "第一个两个整数，分别表示 $n,m$。\n\n第二行一行 $n$ 个数，表示序列 $A$。\n\n接下来 $m$ 行，每行三个数，分别表示这次询问的 $l,r,B$。", "outputFormat": "输出共 $m$ 行，其中第 $i$ 行表示第 $i$ 次询问的答案。", "hint": "### 样例解释\n\n对于样例一，五次询问分别将区间内所有数变为 $3$、$4$、$8$、$4$、$6$ 是一种最优操作。\n\n------------\n\n### 数据范围 \n\n**「本题采用捆绑测试」**\n\n- $\\operatorname{Subtask} 1(10\\%)$：$n,m \\leq 1000$。\n\n- $\\operatorname{Subtask} 2(20\\%)$：保证所有询问 $B=2$。\n\n- $\\operatorname{Subtask} 3(40\\%)$：$n,m \\leq 3 \\times 10^4$。\n\n- $\\operatorname{Subtask} 4(30\\%)$：无特殊限制。\n\n对于 $100\\%$ 的数据：$1 \\leq n,m \\leq 10^5$，$2 \\leq A_i,B \\leq 10^8$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DROI」Round 2  进制与操作", "background": "与其编写苍白无力的背景，不如出更有质量的题。", "description": "定义数 $x$ 在 $B$ 进制下的一次操作为以下两种操作中的任意一种：\n\n- 令 $x \\rightarrow \\lfloor \\dfrac{x}{B} \\rfloor$。\n\n- 令 $x \\rightarrow x \\times B + t $。其中 $t \\in [0,B-1]$。\n\n现给定长度为 $n$ 的序列 $A$。$m$ 次询问，每次询问形如：\n\n- `l r B` 表示询问将序列 $A$ 中下标在 $[l,r]$ 之内的数在 $B$ 进制下操作，至少多少次才能将所有数变为相同（注：每次操作是对**一个数**进行操作）。\n\n**询问间相互独立，即操作不会真的进行。**\n\n", "inputFormat": "第一个两个整数，分别表示 $n,m$。\n\n第二行一行 $n$ 个数，表示序列 $A$。\n\n接下来 $m$ 行，每行三个数，分别表示这次询问的 $l,r,B$。", "outputFormat": "输出共 $m$ 行，其中第 $i$ 行表示第 $i$ 次询问的答案。", "hint": "### 样例解释\n\n对于样例一，五次询问分别将区间内所有数变为 $3$、$4$、$8$、$4$、$6$ 是一种最优操作。\n\n------------\n\n### 数据范围 \n\n**「本题采用捆绑测试」**\n\n- $\\operatorname{Subtask} 1(10\\%)$：$n,m \\leq 1000$。\n\n- $\\operatorname{Subtask} 2(20\\%)$：保证所有询问 $B=2$。\n\n- $\\operatorname{Subtask} 3(40\\%)$：$n,m \\leq 3 \\times 10^4$。\n\n- $\\operatorname{Subtask} 4(30\\%)$：无特殊限制。\n\n对于 $100\\%$ 的数据：$1 \\leq n,m \\leq 10^5$，$2 \\leq A_i,B \\leq 10^8$。\n", "locale": "zh-CN"}}}
{"pid": "P9377", "type": "P", "difficulty": 5, "samples": [["3 6 2\n17 14 11 \n0 2 3\n4 2 9\n2 2 1\n2 2 6\n7 0 5\n4 2 9\n", "3 14 0 17 9 11 17 8\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2023", "O2优化", "最短路", "THUPC"], "title": "[THUPC 2023 决赛] 百合", "background": "葡萄藤上开不出百合花。", "description": "你落在一个巨大的葡萄架上，上面一共有 $2^k$ 朵百合花和 $m$ 条葡萄藤。其中，百合花编号为 $0$ 到 $2^k-1$ 的整数，第 $i$ 条葡萄藤连接了编号为 $x_i, y_i$ 的百合花。\n\n你可以花费 $c_i$ 的时间通过第 $i$ 条葡萄藤，也就是从 $x_i$ 走到 $y_i$，或者反过来；还可以花费 $a_k$ 的时间从 $x$ 闪现到 $y$，其中 $x, y$ 是任意两朵百合花，$k$ 是它们在二进制表示下不同的比特数。例如，$3$ 的二进制表示是 $011$，$5$ 的二进制表示是 $101$，它们有两位不同，因此从 $3$ 闪现到 $5$ 花费的时间是 $a_2$。\n\n假设你恰好落在编号为 $s$ 的百合花上，求从 $s$ 出发到每一朵百合花所需要的最短时间。", "inputFormat": "第一行包含三个正整数 $k,m,s$，其含义如题目描述。\n\n第二行包含 $k$ 个非负整数 $a_i$，表示通道花费的时间。\n\n第 $3$ 至第 $(m+2)$ 行每行三个非负整数 $x_i,y_i,c_i$。", "outputFormat": "输出一行 $2^k$ 个数 $D_i$（$0 \\leq i \\leq 2^k-1$），空格隔开，其中 $D_i$ 表示从 $s$ 到 $i$ 的最短时间。", "hint": "**【数据范围】**\n\n对于所有测试数据，$1 \\le k \\leq 17$，$1 \\le m \\leq 2 \\times 10^5$，$0 \\leq s,x_i,y_i \\leq 2^k - 1$，$0 \\le a_i, c_i \\leq 2^{30} - 1$。\n\n**【题目来源】**\n\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 [https://github.com/THUSAAC/THUPC2023](https://github.com/THUSAAC/THUPC2023) 查看。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2023 决赛] 百合", "background": "葡萄藤上开不出百合花。", "description": "你落在一个巨大的葡萄架上，上面一共有 $2^k$ 朵百合花和 $m$ 条葡萄藤。其中，百合花编号为 $0$ 到 $2^k-1$ 的整数，第 $i$ 条葡萄藤连接了编号为 $x_i, y_i$ 的百合花。\n\n你可以花费 $c_i$ 的时间通过第 $i$ 条葡萄藤，也就是从 $x_i$ 走到 $y_i$，或者反过来；还可以花费 $a_k$ 的时间从 $x$ 闪现到 $y$，其中 $x, y$ 是任意两朵百合花，$k$ 是它们在二进制表示下不同的比特数。例如，$3$ 的二进制表示是 $011$，$5$ 的二进制表示是 $101$，它们有两位不同，因此从 $3$ 闪现到 $5$ 花费的时间是 $a_2$。\n\n假设你恰好落在编号为 $s$ 的百合花上，求从 $s$ 出发到每一朵百合花所需要的最短时间。", "inputFormat": "第一行包含三个正整数 $k,m,s$，其含义如题目描述。\n\n第二行包含 $k$ 个非负整数 $a_i$，表示通道花费的时间。\n\n第 $3$ 至第 $(m+2)$ 行每行三个非负整数 $x_i,y_i,c_i$。", "outputFormat": "输出一行 $2^k$ 个数 $D_i$（$0 \\leq i \\leq 2^k-1$），空格隔开，其中 $D_i$ 表示从 $s$ 到 $i$ 的最短时间。", "hint": "**【数据范围】**\n\n对于所有测试数据，$1 \\le k \\leq 17$，$1 \\le m \\leq 2 \\times 10^5$，$0 \\leq s,x_i,y_i \\leq 2^k - 1$，$0 \\le a_i, c_i \\leq 2^{30} - 1$。\n\n**【题目来源】**\n\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 [https://github.com/THUSAAC/THUPC2023](https://github.com/THUSAAC/THUPC2023) 查看。", "locale": "zh-CN"}}}
