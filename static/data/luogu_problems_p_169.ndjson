{"pid": "P4419", "type": "P", "difficulty": 2, "samples": [["6\n2\n3\n2\n3\n2\n3\n", "DOSTA "], ["1\n10\n", "VUCI"], ["2\n5\n6", "VUCI"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["模拟", "2017", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #1] Cezar", "background": "", "description": "Little Caesar likes card games. Everytime he comes to Zagreb, he plays blackjack, the famous card game, with his friends.\n\nIn this game, the player draws cards while the sum of the cards in his hand is less than or equal to 21 or until he says “DOSTA” (Croatian for “STOP”).\n\nAt the beginning of the game, there are 52 cards in the deck, thirteen ranks of each of the four suits. The card ranks are two, three, …, ten, Jack, Queen, King and Ace. The card values are the following: the cards with numbers on them are worth that number (e.g., “nine” is 9), the cards with pictures (Jack, Queen, and King) are worth 10, whereas the Ace is worth 11.\n\nCaesar has found himself in an interesting situation. During the game, he already drew N cards whose sum is less than or equal to 21 and is now having second thoughts about drawing one more card or not. Let’s assume X is the difference from the sum of the cards so\nfar to 21. Everybody knows that you don’t draw a card if the number of the remaining cards in the deck whose value is greater than X is greater than or equal to the number of the remaining cards in the deck whose value is less than or equal to X.\n\nSince Caesar is having a difficult time calculating whether he needs to draw another card or not, he’s asking you to do it for him.\n", "inputFormat": "The first line of input contains the positive integer N (1 ≤ N ≤ 52), the number of cards Caesar has drawn so far.\n\nEach of the following N lines contains a single positive integer, the value of the $i^{th}$ card Caesar drew.", "outputFormat": "If Caesar should draw another card, output “VUCI” (Croatian for “DRAW”), otherwise output “DOSTA” (Croatian for “STOP”).", "hint": "Clarification​ ​of​ ​the​ ​first​ ​test​ ​case:\n\nThe sum of the already drawn cards is 15, and the difference X to 21 is 6. The number of cards in the\ndeck with a value greater than 6 is 32 (4 Aces, 4 Kings, 4 Queens, 4 Jacks, 4 tens, 4 nines, 4 eights, and 4 sevens), whereas the number of cards in the deck with a value less than or equal to 6 is 14 (one two, one three, 4 fours, 4 fives, and 4 sixes).", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #1] Cezar", "background": "", "description": "Little Caesar likes card games. Everytime he comes to Zagreb, he plays blackjack, the famous card game, with his friends.\n\nIn this game, the player draws cards while the sum of the cards in his hand is less than or equal to 21 or until he says “DOSTA” (Croatian for “STOP”).\n\nAt the beginning of the game, there are 52 cards in the deck, thirteen ranks of each of the four suits. The card ranks are two, three, …, ten, Jack, Queen, King and Ace. The card values are the following: the cards with numbers on them are worth that number (e.g., “nine” is 9), the cards with pictures (Jack, Queen, and King) are worth 10, whereas the Ace is worth 11.\n\nCaesar has found himself in an interesting situation. During the game, he already drew N cards whose sum is less than or equal to 21 and is now having second thoughts about drawing one more card or not. Let’s assume X is the difference from the sum of the cards so\nfar to 21. Everybody knows that you don’t draw a card if the number of the remaining cards in the deck whose value is greater than X is greater than or equal to the number of the remaining cards in the deck whose value is less than or equal to X.\n\nSince Caesar is having a difficult time calculating whether he needs to draw another card or not, he’s asking you to do it for him.\n", "inputFormat": "The first line of input contains the positive integer N (1 ≤ N ≤ 52), the number of cards Caesar has drawn so far.\n\nEach of the following N lines contains a single positive integer, the value of the $i^{th}$ card Caesar drew.", "outputFormat": "If Caesar should draw another card, output “VUCI” (Croatian for “DRAW”), otherwise output “DOSTA” (Croatian for “STOP”).", "hint": "Clarification​ ​of​ ​the​ ​first​ ​test​ ​case:\n\nThe sum of the already drawn cards is 15, and the difference X to 21 is 6. The number of cards in the\ndeck with a value greater than 6 is 32 (4 Aces, 4 Kings, 4 Queens, 4 Jacks, 4 tens, 4 nines, 4 eights, and 4 sevens), whereas the number of cards in the deck with a value less than or equal to 6 is 14 (one two, one three, 4 fours, 4 fives, and 4 sixes).", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #1] Cezar", "background": "", "description": "小凯撒喜欢玩纸牌游戏，每次他去萨格勒布（克罗地亚的首都 ——译者注）都会和他的朋友们玩 $21$ 点，这是一种很流行的纸牌游戏。\n\n这个游戏的规则是，在纸牌点数之和小于 $21$ 点之前可以连续抓牌，如果决定不抓牌，则喊 `DOSTA`（克罗地亚语“停止”的意思）。\n\n游戏开始时，桌面有 $52$ 张牌 —— $13$ 种不同牌面的牌，每种有 $4$ 个花色。牌面分别是 $2,3,\\dots,\\text J,\\text Q,\\text K,\\text A$。它们的点数计算规则是：牌面上的数字就是点数（比如，$9$ 的点数就是 $9$），特殊地，$\\text J,\\text Q,\\text K$ 都算 $10$ 点，$\\text A$ 算 $11$ 点。\n\n凯撒认为游戏的乐趣在于，当抓了 $N$ 张牌之后，如果点数之和小于或等于 $21$，他就要思考是否要再多抓一张。假设 $X$ 是已抓牌点数之和与 $21$ 之间相差的点数值，我们知道，如果桌面上的剩余牌中点数大于 $X$ 的纸牌数量比小于等于 $X$ 的纸牌数量要多，或两者一样多，那就不应该再抓牌了。\n\n因为凯撒并不擅于计算是否需要抓牌，所以他请你帮他计算和决策。", "inputFormat": "第一行输入一个正整数 $N$（$1 \\le N \\le 52$），表示凯撒已经抓牌的张数。\n\n接下来 $N$ 行每行一个正整数，第 $i$ 个正整数是他抓的第 $i$ 张牌点数值。", "outputFormat": "如果凯撒应该继续抓牌，输出 `VUCI`（克罗地亚语“抓牌”的意思），否则输出 `DOSTA`（克罗地亚语“停止”的意思）。\n\n**【样例解释】**\n\n第一个样例： 已经抓的 $6$ 张牌的总点数是 $15$，它与 $21$ 的差 $X$ 是 $6$。桌面上剩余牌中比 $6$ 大的牌有 $32$ 张（分别是 $4$ 张 $\\text A$、$4$ 张 $\\text K$、$4$ 张 $\\text Q$、$4$ 张 $\\text J$、$4$ 张 $10$、$4$ 张 $9$、$4$ 张 $8$、$4$ 张 $7$），而比 $6$ 小的牌有 $14$ 张（分别是 $1$ 张 $2$、$1$ 张 $3$、$4$ 张 $4$、$4$ 张 $5$、$4$ 张 $6$），所以决定不再抓牌，输出 `DOSTA`。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4420", "type": "P", "difficulty": 2, "samples": [["4 5\naaaa.\n.bb..\n.bbxx\n...xx\n", "2\n1\n0\n0\n0\n"], ["4 5\n.aab.\naabb.\n.cbaa\ncccaa\n", "1\n0\n1\n1\n1\n"], ["5 7\n.c.....\nccdddd.\ncaabbcc\naabbacc\n...aaa.\n", "1\n1\n2\n1\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["2017", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #1] Tetris", "background": "", "description": "Ivica is a passionate computer scientist. He recently started working on his first computer game: a clone of the popular Tetris. Although he’s far from being finished, his program supports placing five different Tetris figures shown in the image below in a matrix. Before placing it in the Tetris matrix, the figure can be rotated by 90 degrees an arbitrary number of times and coloured. Additionally, the current version of the game doesn’t support placing the figure if that would mean it goes out of the matrix boundaries or overlaps with another existing figure in the matrix.\n\n![](https://cdn.luogu.com.cn/upload/pic/17376.png)\n\nWhile Ivica was in school, his sister Marica started the game and randomly rotated, coloured and placed the figures in a way that the adjacent figures are coloured differently. Two figures are adjacent if they share a common side or touch in the tip.\n\nWhen Ivica came back to his computer, he found the game running with the figures his sister placed. He wants to know how many of which figures there are in the Tetris matrix and he is asking you to help him solve this problem while he’s busy with improving the game.\n", "inputFormat": "The first line of input contains positive integers N and M (1 ≤ N, M ≤ 10) that represent the number of rows and columns of the Tetris matrix.\n\nEach of the following N lines contains M characters that represent the matrix. Each character can be ‘.’ (dot) that represents a blank space or a lowercase letter of the English alphabet that represents a part of the figure. Different letters represent different colours, and the parts\nof the same figure are coloured the same.\n", "outputFormat": "You must output exactly five rows. The $i^{th}$ line must contain the number of appearances of\nthe $i^{th}$ figure in the game of Tetris.\n", "hint": "In test cases worth 20% of total points, only the first figure will appear.\n\nIn test cases worth an additional 20% of total points, only the first two figures will appear.\n\nIn test cases worth an additional 20% of total points, only the first three figures will appear.\n\nIn test cases worth an additional 20% of total points, only the first four figures will appear.\n\n![](https://cdn.luogu.com.cn/upload/pic/17377.png)", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #1] Tetris", "background": "", "description": "Ivica is a passionate computer scientist. He recently started working on his first computer game: a clone of the popular Tetris. Although he’s far from being finished, his program supports placing five different Tetris figures shown in the image below in a matrix. Before placing it in the Tetris matrix, the figure can be rotated by 90 degrees an arbitrary number of times and coloured. Additionally, the current version of the game doesn’t support placing the figure if that would mean it goes out of the matrix boundaries or overlaps with another existing figure in the matrix.\n\n![](https://cdn.luogu.com.cn/upload/pic/17376.png)\n\nWhile Ivica was in school, his sister Marica started the game and randomly rotated, coloured and placed the figures in a way that the adjacent figures are coloured differently. Two figures are adjacent if they share a common side or touch in the tip.\n\nWhen Ivica came back to his computer, he found the game running with the figures his sister placed. He wants to know how many of which figures there are in the Tetris matrix and he is asking you to help him solve this problem while he’s busy with improving the game.\n", "inputFormat": "The first line of input contains positive integers N and M (1 ≤ N, M ≤ 10) that represent the number of rows and columns of the Tetris matrix.\n\nEach of the following N lines contains M characters that represent the matrix. Each character can be ‘.’ (dot) that represents a blank space or a lowercase letter of the English alphabet that represents a part of the figure. Different letters represent different colours, and the parts\nof the same figure are coloured the same.\n", "outputFormat": "You must output exactly five rows. The $i^{th}$ line must contain the number of appearances of\nthe $i^{th}$ figure in the game of Tetris.\n", "hint": "In test cases worth 20% of total points, only the first figure will appear.\n\nIn test cases worth an additional 20% of total points, only the first two figures will appear.\n\nIn test cases worth an additional 20% of total points, only the first three figures will appear.\n\nIn test cases worth an additional 20% of total points, only the first four figures will appear.\n\n![](https://cdn.luogu.com.cn/upload/pic/17377.png)", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #1] Tetris", "background": "", "description": "Ivica是一位激情昂扬的计算机科学家。他最近开始研究他的第一个电脑游戏：流行于当下的俄罗斯方块的克隆。尽管他还远未完成，但他的研究计划却支持将下图中显示的五种不同的俄罗斯方块图形放在一个矩阵中。在将它放入俄罗斯方块矩阵之前，图形可以旋转90度任意次数并着色。此外，当前版本的游戏不支持放置俄罗斯方块图形，如果这意味着它将超出矩阵边界或与矩阵中的另一个现有图形重叠。\n\n![](https://cdn.luogu.org/upload/pic/17376.png)\n\n当Ivica在学校时，他的妹妹Marica开始游戏并随机旋转，着色并放置俄罗斯方块图形，使相邻的那一些俄罗斯方块颜色不同。如果它们在共用一个共同的侧面或两两相触，则两个图形相邻。（PS：【译者注】当然，一个点｛角｝不算）\n\n当Ivica回到他的电脑后，他发现游戏正在运行着他妹妹放置的俄罗斯方块图形。他想知道俄罗斯方块矩阵中有多少数字，他要求你在他忙于改进游戏时帮助他解决这个问题。", "inputFormat": "第一行输入包含正整数N和M（1≤N，M≤10），表示俄罗斯方块矩阵的行数和列数。\n\n以下N行中的每一行包含表示矩阵的M个字符。每个角色都可以是'.' （点）表示空格或英文字母的小写字母，代表图的一部分。不同的字母代表不同的颜色，同一图的部分颜色相同。", "outputFormat": "你必须输出五行。第 $i^{th}$ \n 行需要包含$i^{th}$ \n 图中方块的游戏的出现次数。\n \n\n## 说明\n\n20％的测试样例中，只有一个数字。\n\n在测试案例中，总价值额外增加20％（也就是40%），只会出现两个数字。\n\n在测试案例中，总价值额外增加20％（当然，也就是60%），出现三个数字。\n\n在测试案例中，总价值额外增加20％，（嗯嗯就是80%），会出现前四个数字\n\n![](https://cdn.luogu.org/upload/pic/17377.png)  \n翻译贡献者UID：118559", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4421", "type": "P", "difficulty": 4, "samples": [["3\naaa\naa\nabb\n", "1"], ["3\nx\nx\nxy\n", "4"], ["5\nmir\nmirta\nta\nir\nt\n", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["字符串", "2017", "哈希 hashing", "AC 自动机", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #1] Lozinke", "background": "", "description": "Recently, there has been a breach of user information from the mega-popular social network Secret Network. Among the confidential information are the passwords of all users.\n\nMihael, a young student who has been exploring computer security lately, found the whole thing really interesting. While experimenting with the social network, he found another security breach! When you input any string of characters that contains a substring equal to the actual password, the login will be successful. For example, if the user whose password is abc inputs one of the strings abc, abcd or imaabcnema, the system will successfully log him in, whereas the login will fail for axbc.\n\nMihael wants to know how many ordered pairs of different users exist such that the first user, using their own password, can login as the second user.", "inputFormat": "The first line of input contains the positive integer N (1 ≤ N ≤ 20 000), the number of users.\n\nEach of the following N lines contains the user passwords. The passwords consist of at least one and at most 10 lowercase letters of the English alphabet.", "outputFormat": "The first and only line of output must contains the number of ordered pairs from the task.", "hint": "Clarification​ ​of​ ​the​ ​second​ ​test​ ​case:\n\nThe first user can login as the second user, the second user can login as the first, and the third user can login as both the first and the second user.", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #1] Lozinke", "background": "", "description": "Recently, there has been a breach of user information from the mega-popular social network Secret Network. Among the confidential information are the passwords of all users.\n\nMihael, a young student who has been exploring computer security lately, found the whole thing really interesting. While experimenting with the social network, he found another security breach! When you input any string of characters that contains a substring equal to the actual password, the login will be successful. For example, if the user whose password is abc inputs one of the strings abc, abcd or imaabcnema, the system will successfully log him in, whereas the login will fail for axbc.\n\nMihael wants to know how many ordered pairs of different users exist such that the first user, using their own password, can login as the second user.", "inputFormat": "The first line of input contains the positive integer N (1 ≤ N ≤ 20 000), the number of users.\n\nEach of the following N lines contains the user passwords. The passwords consist of at least one and at most 10 lowercase letters of the English alphabet.", "outputFormat": "The first and only line of output must contains the number of ordered pairs from the task.", "hint": "Clarification​ ​of​ ​the​ ​second​ ​test​ ​case:\n\nThe first user can login as the second user, the second user can login as the first, and the third user can login as both the first and the second user.", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #1] Lozinke", "background": "", "description": "最近，超级流行的社交网络 Secret Network 发生了用户信息泄露事件。其中包含所有用户的密码。\n\nMihael 是一名最近在研究计算机安全的年轻学生，他发现整个事件非常有趣。在对社交网络进行实验时，他发现了另一个安全漏洞！当你输入任何包含与实际密码相同的子字符串的字符序列时，登录将会成功。例如，如果用户的密码是 abc，输入字符串 abc、abcd 或 imaabcnema，系统将成功登录，而对于 axbc，登录将失败。\n\nMihael 想知道存在多少对不同用户的有序对，使得第一个用户可以使用他们自己的密码登录为第二个用户。", "inputFormat": "输入的第一行包含正整数 $N$（$1 \\leq N \\leq 20000$），表示用户的数量。\n\n接下来的 $N$ 行中的每一行包含用户的密码。密码由至少一个、最多 10 个小写英文字母组成。", "outputFormat": "输出的第一行必须包含任务中有序对的数量。", "hint": "第二个测试用例的说明：\n\n第一个用户可以作为第二个用户登录，第二个用户可以作为第一个用户登录，第三个用户可以作为第一个和第二个用户登录。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P4422", "type": "P", "difficulty": 5, "samples": [["3 4\nM 10 3\nM 5 1\nD 20 2\nD 5 1\n", "3\n1\n"], ["10 10\nM 20 10\nD 1 9\nM 2 3\nD 17 10\nM 20 2\nD 8 2\nM 40 1\nD 25 2\nM 33 9\nD 37 9\n", "-1\n-1\n3\n2\n9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["模拟", "2017", "线段树", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #1] Deda", "background": "", "description": "Little Marica is making up a ~~nonsensical~~ unusual fairy tale and is telling to her grandfather who keeps interrupting her and asking her ~~stupid~~ intriguing questions.\n\nIn Marica’s fairy tale, $N$ children, denoted with numbers from $1$ to $N$ by their age (from the youngest denoted with $1$, to the oldest denoted with $N$), embarked on a train ride. The train leaves from the station $0$ and stops in order at stations $1, 2, 3 \\dots$ to infinity.\n\nEach of the following Marica’s statements is of the form: “$At\\  stop\\ X, child\\ A\\ got\\ out$”, where the order of these statements is completely arbitrary. In other words, it does not depend on the station order. Her grandfather sometimes asks a question of the form: “$\\textit{ Based on the statements so far, of the children denoted with a number greater than or equal}\\allowbreak\\textit{ to B, who is the youngest child that rode for Y or less stops?}$” If at the moment the grandfather asks the question it hasn’t been said so far that a child is getting off the train, we assume that the child is riding for an infinite amount of stops.\n\nMarica must give a correct answer to each of her grandfather’s questions, otherwise the grandfather will get mad and go to sleep. The answer must be correct in the moment when the grandfather asks the question, while it can change later given Marica’s new statements, but that doesn’t matter. Write a program that tracks Marica’s statements and answers her grandfather’s questions.", "inputFormat": "The first line of input contains the positive integers $N$ and $Q$ $(2 \\le N, Q \\le 2 \\times 10^{5})$, the number of children and the number of statements. Each of the following $Q$ lines describes:\n\n- either Marica’s statement of the form `M X A`, where $M$ denotes Marica, and $X$ and $A$ are positive integers $(1 \\le X \\le 10^{9}, 1 \\le A \\le N)$ from the task,\n- or her grandfather’s question of the form `D Y B`, where $D$ denotes the grandfather, and $Y$ and $B$ are positive integers $(1 \\le Y \\le 10^{9}, 1 \\le B \\le N)$ from the task.\n\nAll of Marica’s statements correspond to different children and at least one line in the input is her grandfather’s question.", "outputFormat": "For each grandfather’s question, output the number of the required child in its own line. If no such child exists, output `-1`.", "hint": "", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #1] Deda", "background": "", "description": "Little Marica is making up a ~~nonsensical~~ unusual fairy tale and is telling to her grandfather who keeps interrupting her and asking her ~~stupid~~ intriguing questions.\n\nIn Marica’s fairy tale, $N$ children, denoted with numbers from $1$ to $N$ by their age (from the youngest denoted with $1$, to the oldest denoted with $N$), embarked on a train ride. The train leaves from the station $0$ and stops in order at stations $1, 2, 3 \\dots$ to infinity.\n\nEach of the following Marica’s statements is of the form: “$At\\  stop\\ X, child\\ A\\ got\\ out$”, where the order of these statements is completely arbitrary. In other words, it does not depend on the station order. Her grandfather sometimes asks a question of the form: “$\\textit{ Based on the statements so far, of the children denoted with a number greater than or equal}\\allowbreak\\textit{ to B, who is the youngest child that rode for Y or less stops?}$” If at the moment the grandfather asks the question it hasn’t been said so far that a child is getting off the train, we assume that the child is riding for an infinite amount of stops.\n\nMarica must give a correct answer to each of her grandfather’s questions, otherwise the grandfather will get mad and go to sleep. The answer must be correct in the moment when the grandfather asks the question, while it can change later given Marica’s new statements, but that doesn’t matter. Write a program that tracks Marica’s statements and answers her grandfather’s questions.", "inputFormat": "The first line of input contains the positive integers $N$ and $Q$ $(2 \\le N, Q \\le 2 \\times 10^{5})$, the number of children and the number of statements. Each of the following $Q$ lines describes:\n\n- either Marica’s statement of the form `M X A`, where $M$ denotes Marica, and $X$ and $A$ are positive integers $(1 \\le X \\le 10^{9}, 1 \\le A \\le N)$ from the task,\n- or her grandfather’s question of the form `D Y B`, where $D$ denotes the grandfather, and $Y$ and $B$ are positive integers $(1 \\le Y \\le 10^{9}, 1 \\le B \\le N)$ from the task.\n\nAll of Marica’s statements correspond to different children and at least one line in the input is her grandfather’s question.", "outputFormat": "For each grandfather’s question, output the number of the required child in its own line. If no such child exists, output `-1`.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #1] Deda", "background": "", "description": "### 题面描述\n小马里卡正在创作一个奇妙的童话故事。她一边编故事，一边讲给她的爷爷听。爷爷可高兴了，于是问了她一些有趣的问题。\n\n在小马里卡的故事中，有 $N$ 个年龄分别为 $1$~$N$ 岁的孩子（最小的为 $1$ 岁，最大的为 $N$ 岁）。有一天，她们一起乘火车出去旅行。铁路线上有好多个车站，分别以 $0, 1, 2, 3 \\dots$ 编号。其中第 $0$ 站为始发站，火车每到一个车站都会停下来逗留一段时间。每个孩子都可以在选择自己喜欢的车站下车。\n\n小马里卡喜欢这样讲述她的故事：“在第 $X$ 站，年龄为 $A$ 岁的孩子下车了。”不过小马里卡的习惯非常不好，她讲述故事的顺序是完全随机的。换句话说，$X$ 是不单调的。爷爷知道小马里卡的坏习惯，所以他喜欢时不时问一些有趣的问题来找小马里的麻烦。问题是这样的：“年龄大于等于 $B$ 且在第 $Y$ 站（包含第 $Y$ 站）以前下车的最年轻的小孩是多大？”\n\n小马里卡必须正确回答爷爷的问题，否则爷爷会因生气而睡觉。值得注意的是，小马里卡的答案必须在当时是正确的。虽然小马里卡在随后的讲述中可能会改变问题的答案，但这都是无关紧要的。\n\n小马里卡对自己的坏习惯十分无奈。由于故事的顺序过于杂乱，小马里卡根本无法正确回答爷爷的问题。于是她找到了聪明的你。请帮小马里卡编写一个程序，动态追踪她的讲述，并回答爷爷的问题。", "inputFormat": "输入的第一行包含两个正整数 $N,Q\\ (2 \\le N,Q \\le 2 \\times 10^{5})$，分别代表孩子的数量和语句的数量。\n\n接下来 $Q$ 行，每行一个语句。语句的格式为 `M X A` 或 `D Y B`，分别代表小马里卡的讲述和爷爷的问题。其中 `M`、`D` 为大写字母，$X$、$Y$、$A$、$B$ $(1 \\le X,Y \\le 10^{9},1 \\le A,B \\le N)$ 分别为一个正整数。其意义请见【题面描述】。题目中保证至少有一个 `D`。", "outputFormat": "对于每一个问题 `D` 输出一个答案。答案为一个整数。如果爷爷的问题无解，请输出 `-1`。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4423", "type": "P", "difficulty": 6, "samples": [["4\n1 1\n2 3\n3 3\n3 4", "3.414214\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "递归", "北京", "分治", "排序"], "title": "[BJWC2011] 最小三角形", "background": "", "description": "Xaviera 现在遇到了一个有趣的问题。\n\n平面上有 $N$ 个点，Xaviera 想找出周长最小的三角形。\n\n由于点非常多，分布也非常乱，所以 Xaviera 想请你来解决这个问题。\n\n为了减小问题的难度，这里的三角形也包括共线的三点。", "inputFormat": "第一行包含一个整数 $N$ 表示点的个数。\n\n接下来 $N$ 行每行有两个整数，表示这个点的坐标。", "outputFormat": "输出只有一行，包含一个 $6$ 位小数，为周长最短的三角形的周长（四舍五入）。", "hint": "对于所有数据，$3 \\leq N \\leq 2\\times 10^5$", "locale": "zh-CN", "translations": {"en": {"title": "[BJWC2011] Minimum Triangle", "background": "", "description": "Xaviera has encountered an interesting problem.\n\nThere are $N$ points on the plane. Xaviera wants to find the triangle with the minimum perimeter.\n\nBecause there are many points and they are distributed irregularly, Xaviera asks you to solve this problem.\n\nTo reduce the difficulty, triangles also include three collinear points.", "inputFormat": "The first line contains an integer $N$ representing the number of points.\n\nThe next $N$ lines each contain two integers, representing the coordinates of a point.", "outputFormat": "Output a single line containing the minimum triangle perimeter, rounded to $6$ decimal places.", "hint": "Constraints: For all testdata, $3 \\leq N \\leq 2\\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJWC2011] 最小三角形", "background": "", "description": "Xaviera 现在遇到了一个有趣的问题。\n\n平面上有 $N$ 个点，Xaviera 想找出周长最小的三角形。\n\n由于点非常多，分布也非常乱，所以 Xaviera 想请你来解决这个问题。\n\n为了减小问题的难度，这里的三角形也包括共线的三点。", "inputFormat": "第一行包含一个整数 $N$ 表示点的个数。\n\n接下来 $N$ 行每行有两个整数，表示这个点的坐标。", "outputFormat": "输出只有一行，包含一个 $6$ 位小数，为周长最短的三角形的周长（四舍五入）。", "hint": "对于所有数据，$3 \\leq N \\leq 2\\times 10^5$", "locale": "zh-CN"}}}
{"pid": "P4424", "type": "P", "difficulty": 7, "samples": [["5 5 1\n01110\n11011\n10000\n01010\n00100\n00100", "6"], ["10 10 3\n0100011011\n0110100101\n1100010100\n0111000110\n1100011110\n0001110100\n0001101110\n0110100001\n1110001010\n0010011101\n0110011111\n1101001010\n0010001001", "69\n0\n5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "各省省选", "安徽", "湖南", "排序", "进制", "位运算"], "title": "[HNOI/AHOI2018] 寻宝游戏", "background": "", "description": "某大学每年都会有一次 Mystery Hunt 的活动，玩家需要根据设置的线索解谜，找到宝藏的位置，前一年获胜的队伍可以获得这一年出题的机会。\n\n作为新生的你，对这个活动非常感兴趣。你每天都要从西向东经过教学楼一条很长的走廊，这条走廊是如此的长，以至于它被人戏称为 infinite corridor。一次，你经过这条走廊时注意到在走廊的墙壁上隐藏着 $n$ 个**等长的**二进制的数字，长度均为 $m$。你从西向东将这些数字记录了下来，形成一个含有 $n$ 个数的二进制数组 $a_1,a_2,...,a_n$。\n\n很快，在最新的一期的 Voo Doo 杂志上，你发现了 $q$ 个长度也为 $m$ 的二进制数 $r_1,r_2,...,r_q$。\n\n聪明的你很快发现了这些数字的含义。\n\n保持数组 $a_1,a_2,...,a_n$ 的元素顺序不变，你可以在它们之间插入 $\\land$（按位与运算）或者 $\\lor$（按位或运算）。例如：$11011\\land 00111=00011$，$11011\\lor 00111=11111$。\n\n你需要插入 $n$ 个运算符，相邻两个数之前恰好一个，在**第一个数的左边**还有一个。**如果我们在第一个运算符的左边补入一个 0**，这就形成了一个运算式，我们可以计算它的值。与往常一样，运算顺序是**从左到右**。有趣的是，出题人已经告诉你这个值的可能的集合—— Voo Doo 杂志里的那些二进制数 $r_1,r_2,...,r_q$，而解谜的方法，就是对 $r_1,r_2,...,r_q$ 中的每一个值 $r_i$，分别计算出**有多少种方法填入这 $n$ 个计算符**，使的这个运算式的值是 $r_i$。\n\n然而，infinite corridor 真的很长，这意味着数据范围可能非常大。因此，答案也可能非常大，但是你发现由于谜题的特殊性，你只需要求答案模 $1000000007$ 的值。", "inputFormat": "第一行三个数 $n,m,q$，含义如题所述。\n\n接下来 $n$ 行，其中第 $i$ 行有一个长度为 $m$ 的二进制数，**左边是最高位**，表示 $a_i$。\n\n接下来 $q$ 行，其中第 $i$ 行有一个长度为 $m$ 的二进制数，**左边是最高位**，表示 $r_i$。", "outputFormat": "输出 $q$ 行，每行一个数，其中的 $i$ 行表示对于 $r_i$ 的答案。", "hint": "对于 $10\\%$ 的数据，$n \\le 20, m \\le 30, q = 1$；\n\n对于另外 $20\\%$ 的数据，$n \\le 1000, m \\le 16$；\n\n对于另外 $40\\%$ 的数据，$n \\le 500, m \\le 1000$；\n\n对于全部的数据 $1\\leq n\\leq 1000,1\\leq m\\leq 5000,1\\leq q\\leq 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI/AHOI2018] Treasure Hunt", "background": "", "description": "At a certain university, there is an annual Mystery Hunt. Players must solve puzzles using given clues to find the treasure, and the previous year's winning team earns the right to write the problems for the current year.\n\nAs a freshman, you are very interested in this event. Every day you walk from west to east through a very long corridor in the teaching building. The corridor is so long that people jokingly call it the \"infinite corridor.\" One day, as you pass through the corridor, you notice that there are $n$ hidden binary numbers of equal length on the corridor wall, all of length $m$. You record these numbers from west to east, forming a binary array of $n$ numbers $a_1,a_2,...,a_n$.\n\nSoon, in the latest issue of the Voo Doo magazine, you discover $q$ binary numbers of length $m$, namely $r_1,r_2,...,r_q$.\n\nYou quickly figure out the meaning of these numbers.\n\nKeeping the order of the array $a_1,a_2,...,a_n$ unchanged, you may insert $\\land$ (bitwise AND) or $\\lor$ (bitwise OR) between them. For example: $11011\\land 00111=00011$, $11011\\lor 00111=11111$.\n\nYou need to insert $n$ operators: exactly one between each pair of adjacent numbers, and one more to the left of the first number. If we put a $0$ to the left of the first operator, this forms an expression whose value we can compute. As usual, the evaluation order is from left to right. Interestingly, the setter has already told you the possible set of resulting values — the binary numbers $r_1,r_2,...,r_q$ in the Voo Doo magazine. The way to solve the puzzle is: for each value $r_i$ among $r_1,r_2,...,r_q$, compute how many ways there are to fill in these $n$ operators so that the expression evaluates to $r_i$.\n\nHowever, the infinite corridor is truly long, which means the ranges may be very large. Therefore, the answers may also be very large, but due to the special nature of the puzzle, you only need to output the answers modulo $1000000007$.", "inputFormat": "The first line contains three integers $n,m,q$, as described.\n\nThe next $n$ lines: the $i$-th line contains a binary number of length $m$, with the most significant bit on the left, representing $a_i$.\n\nThe next $q$ lines: the $i$-th line contains a binary number of length $m$, with the most significant bit on the left, representing $r_i$.", "outputFormat": "Output $q$ lines, one integer per line. The $i$-th line is the answer for $r_i$.", "hint": "Constraints:\n- For $10\\%$ of the testdata, $n \\le 20$, $m \\le 30$, $q = 1$.\n- For an additional $20\\%$ of the testdata, $n \\le 1000$, $m \\le 16$.\n- For an additional $40\\%$ of the testdata, $n \\le 500$, $m \\le 1000$.\n- For all testdata, $1 \\le n \\le 1000$, $1 \\le m \\le 5000$, $1 \\le q \\le 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI/AHOI2018] 寻宝游戏", "background": "", "description": "某大学每年都会有一次 Mystery Hunt 的活动，玩家需要根据设置的线索解谜，找到宝藏的位置，前一年获胜的队伍可以获得这一年出题的机会。\n\n作为新生的你，对这个活动非常感兴趣。你每天都要从西向东经过教学楼一条很长的走廊，这条走廊是如此的长，以至于它被人戏称为 infinite corridor。一次，你经过这条走廊时注意到在走廊的墙壁上隐藏着 $n$ 个**等长的**二进制的数字，长度均为 $m$。你从西向东将这些数字记录了下来，形成一个含有 $n$ 个数的二进制数组 $a_1,a_2,...,a_n$。\n\n很快，在最新的一期的 Voo Doo 杂志上，你发现了 $q$ 个长度也为 $m$ 的二进制数 $r_1,r_2,...,r_q$。\n\n聪明的你很快发现了这些数字的含义。\n\n保持数组 $a_1,a_2,...,a_n$ 的元素顺序不变，你可以在它们之间插入 $\\land$（按位与运算）或者 $\\lor$（按位或运算）。例如：$11011\\land 00111=00011$，$11011\\lor 00111=11111$。\n\n你需要插入 $n$ 个运算符，相邻两个数之前恰好一个，在**第一个数的左边**还有一个。**如果我们在第一个运算符的左边补入一个 0**，这就形成了一个运算式，我们可以计算它的值。与往常一样，运算顺序是**从左到右**。有趣的是，出题人已经告诉你这个值的可能的集合—— Voo Doo 杂志里的那些二进制数 $r_1,r_2,...,r_q$，而解谜的方法，就是对 $r_1,r_2,...,r_q$ 中的每一个值 $r_i$，分别计算出**有多少种方法填入这 $n$ 个计算符**，使的这个运算式的值是 $r_i$。\n\n然而，infinite corridor 真的很长，这意味着数据范围可能非常大。因此，答案也可能非常大，但是你发现由于谜题的特殊性，你只需要求答案模 $1000000007$ 的值。", "inputFormat": "第一行三个数 $n,m,q$，含义如题所述。\n\n接下来 $n$ 行，其中第 $i$ 行有一个长度为 $m$ 的二进制数，**左边是最高位**，表示 $a_i$。\n\n接下来 $q$ 行，其中第 $i$ 行有一个长度为 $m$ 的二进制数，**左边是最高位**，表示 $r_i$。", "outputFormat": "输出 $q$ 行，每行一个数，其中的 $i$ 行表示对于 $r_i$ 的答案。", "hint": "对于 $10\\%$ 的数据，$n \\le 20, m \\le 30, q = 1$；\n\n对于另外 $20\\%$ 的数据，$n \\le 1000, m \\le 16$；\n\n对于另外 $40\\%$ 的数据，$n \\le 500, m \\le 1000$；\n\n对于全部的数据 $1\\leq n\\leq 1000,1\\leq m\\leq 5000,1\\leq q\\leq 1000$。", "locale": "zh-CN"}}}
{"pid": "P4425", "type": "P", "difficulty": 7, "samples": [["5 3 0\n1 2 3 4 5\n3 5\n5 0\n1 4", "5\n7\n6\n7"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "线段树", "各省省选", "安徽", "湖南", "枚举", "栈"], "title": "[HNOI/AHOI2018] 转盘", "background": null, "description": "一次小 G 和小 H 准备去聚餐，但是由于太麻烦了于是题面简化如下：\n\n一个转盘上有摆成一圈的 $n$ 个物品（编号 $1\\sim n$），其中的 $i$ 个物品会在 $T_i$ 时刻出现。\n\n在 $0$ 时刻时，小 G 可以任选 $n$ 个物品中的一个，我们将其编号为 $s_0$。并且如果 $i$ 时刻选择了物品 $s_i$，那么 $i+1$ 时刻可以继续选择当前物品或选择下一个物品。当 $s_i$ 为 $n$ 时，下一个物品为物品 $1$，否则为物品 $s_{i}+1$。在每一时刻（包括 $0$ 时刻），如果小 G 选择的物品已经出现了，那么小 G 将会标记它。小 H 想知道，在物品选择的最优策略下，小 G 什么时候能标记所有物品？\n\n但麻烦的是，物品的出现时间会不时修改。我们将其描述为 $m$ 次修改，每次修改将改变其中一个物品的出现时间。每次修改后，你也需求出当前局面的答案。对于其中部分测试点，小 H 还追加了强制在线的要求。", "inputFormat": "第一行三个非负整数 $n$、$m$、$p$，代表一共有 $n$ 个物品，$m$ 次修改。$p$ 只有 $0$ 或 $1$ 两种取值，强制在线时 $p$ 为 $1$，否则 $p$ 为 $0$。\n\n接下来一行，有 $n$ 个**非负整数**，第 $i$ 个数 $T_i$ 代表物品 $i$ 的出现时间。\n\n接下来 $m$ 行，每行两个非负整数 $x$、$y$，代表一次修改及询问。修改方式如下：\n\n1. 如果 $p=0$，则表示物品 $x$ 的出现时间 $T_x$ 修改为 $y$。\n\n2. 如果 $p=1$，则先将 $x$ 和 $y$ 分别异或 $LastAns$，得到 $x'$ 和 $y'$，然后将物品 $x'$ 的出现时间 $T_{x'}$ 修改为 $y'$。其中的 $LastAns$ 是前一个询问的结果；特别的，第一次修改时 $LastAns$ 为初始局面的答案。\n\n保证输入合法。", "outputFormat": "第一行一个整数，代表初始局面的答案。\n\n接下来 $m$ 行每行一个整数，分别代表每次修改后的答案。", "hint": "【**数据范围**】\n\n::cute-table[]{tuack}\n| 测试点编号 | $n$ | $m$ | $T _ i / T _ x$ | $p$ |\n| :-: | :-: | :-: | :-: | :-: |\n| 1 | $\\le 10$ | $\\le 10$ | $\\le 10$ | $=0$ |\n| 2 | $\\le 1000$ | $=0$ | $\\le 1000$ | ^ |\n| 3 | $\\le 100000$ | ^ | $\\le 100000$ | ^ |\n| 4 | $\\le 5000$ | $\\le 5000$ | ^ | ^ |\n| 5 | $\\le 80000$ | $\\le 80000$ | ^ | ^ |\n| 6 | ^ | ^ | ^ | $=1$ |\n| 7 | $\\le 90000$ | $\\le 90000$ | ^ | $=0$ |\n| 8 | ^ | ^ | ^ | $=1$ |\n| 9 | $\\le 100000$ | $\\le 100000$ | ^ | $=0$ |\n| 10 | ^ | ^ | ^ | $=1$| \n\n对于所有数据，保证 $3 \\le n \\le 10 ^ 5$，$0 \\le m \\le 10 ^ 5$，$0 \\le T _ i / T _ x \\le 10 ^ 5$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI/AHOI2018] Turntable", "background": "", "description": "Xiao G and Xiao H plan to have a dinner, but to keep things simple, the statement is as follows:\n\nThere is a turntable with $n$ items arranged in a circle (numbered $1 \\sim n$). The $i$-th item appears at time $T_i$.\n\nAt time $0$, Xiao G can choose any one of the $n$ items; denote it by $s_0$. If at time $i$ he chooses item $s_i$, then at time $i+1$ he can either keep the current item or move to the next item. When $s_i$ equals $n$, the next item is item $1$; otherwise it is item $s_i + 1$. At every time (including time $0$), if the item Xiao G chooses has already appeared, then he will mark it. Xiao H wants to know, under the optimal strategy of choosing items, when can Xiao G mark all items.\n\nHowever, the appearance times of items will be modified from time to time. We describe this as $m$ modifications, each changing the appearance time of one item. After each modification, you must also output the answer for the current state. For some test points, Xiao H also imposes a forced online constraint.", "inputFormat": "The first line contains three non-negative integers $n$, $m$, and $p$, meaning there are $n$ items and $m$ modifications. The value of $p$ is either $0$ or $1$; when $p = 1$, the problem is forced online; otherwise $p = 0$.\n\nThe next line contains $n$ non-negative integers. The $i$-th number $T_i$ is the appearance time of item $i$.\n\nEach of the next $m$ lines contains two non-negative integers $x$ and $y$, representing one modification and its query. The modification works as follows:\n1. If $p = 0$, set the appearance time of item $x$ to $y$, i.e., $T_x \\leftarrow y$.\n2. If $p = 1$, first XOR $x$ and $y$ with LastAns respectively to obtain $x'$ and $y'$, then set $T_{x'} \\leftarrow y'$. Here LastAns is the result of the previous query; in particular, for the first modification, LastAns is the answer for the initial state.\n\nIt is guaranteed that the input is valid.", "outputFormat": "Output one integer on the first line, the answer for the initial state.\n\nThen output $m$ lines, each containing one integer, the answer after each modification.", "hint": "【Constraints】\n\n::cute-table[]{tuack}\n| Test point id | $n$ | $m$ | $T_i / T_x$ | $p$ |\n| :-: | :-: | :-: | :-: | :-: |\n| 1 | $\\le 10$ | $\\le 10$ | $\\le 10$ | $=0$ |\n| 2 | $\\le 1000$ | $=0$ | $\\le 1000$ | ^ |\n| 3 | $\\le 100000$ | ^ | $\\le 100000$ | ^ |\n| 4 | $\\le 5000$ | $\\le 5000$ | ^ | ^ |\n| 5 | $\\le 80000$ | $\\le 80000$ | ^ | ^ |\n| 6 | ^ | ^ | ^ | $=1$ |\n| 7 | $\\le 90000$ | $\\le 90000$ | ^ | $=0$ |\n| 8 | ^ | ^ | ^ | $=1$ |\n| 9 | $\\le 100000$ | $\\le 100000$ | ^ | $=0$ |\n| 10 | ^ | ^ | ^ | $=1$| \n\nFor all testdata, it is guaranteed that $3 \\le n \\le 10^5$, $0 \\le m \\le 10^5$, and $0 \\le T_i / T_x \\le 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI/AHOI2018] 转盘", "background": null, "description": "一次小 G 和小 H 准备去聚餐，但是由于太麻烦了于是题面简化如下：\n\n一个转盘上有摆成一圈的 $n$ 个物品（编号 $1\\sim n$），其中的 $i$ 个物品会在 $T_i$ 时刻出现。\n\n在 $0$ 时刻时，小 G 可以任选 $n$ 个物品中的一个，我们将其编号为 $s_0$。并且如果 $i$ 时刻选择了物品 $s_i$，那么 $i+1$ 时刻可以继续选择当前物品或选择下一个物品。当 $s_i$ 为 $n$ 时，下一个物品为物品 $1$，否则为物品 $s_{i}+1$。在每一时刻（包括 $0$ 时刻），如果小 G 选择的物品已经出现了，那么小 G 将会标记它。小 H 想知道，在物品选择的最优策略下，小 G 什么时候能标记所有物品？\n\n但麻烦的是，物品的出现时间会不时修改。我们将其描述为 $m$ 次修改，每次修改将改变其中一个物品的出现时间。每次修改后，你也需求出当前局面的答案。对于其中部分测试点，小 H 还追加了强制在线的要求。", "inputFormat": "第一行三个非负整数 $n$、$m$、$p$，代表一共有 $n$ 个物品，$m$ 次修改。$p$ 只有 $0$ 或 $1$ 两种取值，强制在线时 $p$ 为 $1$，否则 $p$ 为 $0$。\n\n接下来一行，有 $n$ 个**非负整数**，第 $i$ 个数 $T_i$ 代表物品 $i$ 的出现时间。\n\n接下来 $m$ 行，每行两个非负整数 $x$、$y$，代表一次修改及询问。修改方式如下：\n\n1. 如果 $p=0$，则表示物品 $x$ 的出现时间 $T_x$ 修改为 $y$。\n\n2. 如果 $p=1$，则先将 $x$ 和 $y$ 分别异或 $LastAns$，得到 $x'$ 和 $y'$，然后将物品 $x'$ 的出现时间 $T_{x'}$ 修改为 $y'$。其中的 $LastAns$ 是前一个询问的结果；特别的，第一次修改时 $LastAns$ 为初始局面的答案。\n\n保证输入合法。", "outputFormat": "第一行一个整数，代表初始局面的答案。\n\n接下来 $m$ 行每行一个整数，分别代表每次修改后的答案。", "hint": "【**数据范围**】\n\n::cute-table[]{tuack}\n| 测试点编号 | $n$ | $m$ | $T _ i / T _ x$ | $p$ |\n| :-: | :-: | :-: | :-: | :-: |\n| 1 | $\\le 10$ | $\\le 10$ | $\\le 10$ | $=0$ |\n| 2 | $\\le 1000$ | $=0$ | $\\le 1000$ | ^ |\n| 3 | $\\le 100000$ | ^ | $\\le 100000$ | ^ |\n| 4 | $\\le 5000$ | $\\le 5000$ | ^ | ^ |\n| 5 | $\\le 80000$ | $\\le 80000$ | ^ | ^ |\n| 6 | ^ | ^ | ^ | $=1$ |\n| 7 | $\\le 90000$ | $\\le 90000$ | ^ | $=0$ |\n| 8 | ^ | ^ | ^ | $=1$ |\n| 9 | $\\le 100000$ | $\\le 100000$ | ^ | $=0$ |\n| 10 | ^ | ^ | ^ | $=1$| \n\n对于所有数据，保证 $3 \\le n \\le 10 ^ 5$，$0 \\le m \\le 10 ^ 5$，$0 \\le T _ i / T _ x \\le 10 ^ 5$。", "locale": "zh-CN"}}}
{"pid": "P4426", "type": "P", "difficulty": 7, "samples": [["3 2\n1 2\n2 3", "5"], ["6 8\n1 2\n1 3\n1 4\n2 4\n3 5\n4 5\n4 6\n1 6", "16"], ["12 18\n12 6\n3 11\n8 6\n2 9\n10 4\n1 8\n6 2\n11 5\n10 6\n12 2\n9 3\n7 6\n2 7\n3 2\n7 3\n5 6\n2 11\n12 1", "248"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "并查集", "各省省选", "安徽", "湖南", "枚举", "虚树", "动态 DP", "全局平衡二叉树"], "title": "[HNOI/AHOI2018] 毒瘤", "background": "", "description": "从前有一名毒瘤。\n\n毒瘤最近发现了量产毒瘤题的奥秘。考虑如下类型的数据结构题：给出一个数组，要求支持若干种奇奇怪怪的修改操作（比如区间加一个数，或者区间开平方），并支持询问区间和。毒瘤考虑了 $n$ 个这样的修改操作，并编号为 $1\\sim n$。当毒瘤要出数据结构题的时候，他就将这些修改操作中选若干个出来，然后出成一道题。\n\n当然了，这样出的题有可能不可做。通过精妙的数学推理，毒瘤揭露了这些修改操作的关系：有 $m$ 对“互相排斥”的修改操作，第 $i$ 对是第 $u_i$ 个操作和第 $v_i$ 个操作。当一道题同时含有 $u_i$ 和 $v_i$ 这两个操作时，这道题就会变得不可做。另一方面，一道题中不包含任何“互相排斥”的修改操作时，这个题就是可做的。此外，毒瘤还发现了一个规律：$m-n$ 是一个很小的数字，且任意两个修改操作都是连通的。两个修改操作 $a,b$ 是连通的，当且仅当存在若干操作 $t_0,t_1,\\cdots,t_l$，使得 $t_0=a,t_l=b$，且对 $1\\leq i\\leq l$，$t_{i-1}$ 和 $t_i$ 都是“互相排斥”的修改操作。\n\n一对“互相排斥”的修改操作称为互斥对。现在毒瘤想知道，给定值 $n$ 和 $m$ 个互斥对，他共能出出多少道可做的不同的数据结构题。两道数据结构题是不同的，当且仅当有一个修改操作在其中一道题中存在，而在另一道题中不存在。", "inputFormat": "第一行为正整数 $n,m$。\n\n接下来 $m$ 行，每行两个正整数 $u,v$，代表一对“互相排斥”的修改操作。", "outputFormat": "输出一行一个整数，代表毒瘤可以出的可做的不同的“互相排斥”的修改操作的个数。这个数可能很大，所以只输出模 $998244353$ 后的值。", "hint": "#### 样例一说明\n\n可做的题包括 $\\varnothing,\\{1\\},\\{2\\},\\{3\\},\\{1,3\\}$。注意，**空集是合法的数据结构题**。\n\n#### 数据范围\n\n![](https://cdn.luogu.com.cn/upload/pic/17511.png)", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI/AHOI2018] Duliu", "background": "", "description": "There was once a \"Duliu\" (pinyin).\n\nDuliu recently discovered the secret to mass-producing \"duliu\" problems. Consider a data-structure problem of the following type: given an array, you need to support several quirky update operations (for example, adding a number to a range, or taking the square root on a range), and support querying range sums. Duliu considered $n$ such update operations, numbered $1\\sim n$. When Duliu wants to set a data-structure problem, he selects some of these update operations and turns them into a problem.\n\nOf course, such a problem might be unsolvable. Through clever mathematical reasoning, Duliu revealed the relationships among these update operations: there are $m$ pairs of mutually exclusive update operations, and the $i$-th pair is the $u_i$-th operation and the $v_i$-th operation. When a problem contains both $u_i$ and $v_i$, the problem becomes unsolvable. On the other hand, if a problem contains no mutually exclusive pairs, then the problem is solvable. In addition, Duliu discovered a pattern: $m-n$ is a small number, and any two update operations are connected. Two update operations $a, b$ are connected if and only if there exist operations $t_0, t_1, \\cdots, t_l$ such that $t_0 = a$, $t_l = b$, and for $1 \\le i \\le l$, $t_{i-1}$ and $t_i$ are mutually exclusive.\n\nA pair of mutually exclusive update operations is called an exclusive pair. Now Duliu wants to know, given $n$ and the $m$ exclusive pairs, how many different solvable data-structure problems he can set. Two data-structure problems are different if and only if there exists an update operation that appears in one but not in the other.", "inputFormat": "The first line contains positive integers $n, m$.\n\nThe next $m$ lines each contain two positive integers $u, v$, representing a pair of mutually exclusive update operations.", "outputFormat": "Output a single integer on one line, representing the number of solvable different data-structure problems that Duliu can set. This number can be large, so output it modulo $998244353$.", "hint": "#### Explanation for Sample 1\n\nThe solvable problems include $\\varnothing, \\{1\\}, \\{2\\}, \\{3\\}, \\{1, 3\\}$. Note that the empty set is a valid data-structure problem.\n\n#### Constraints\n\n![](https://cdn.luogu.com.cn/upload/pic/17511.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI/AHOI2018] 毒瘤", "background": "", "description": "从前有一名毒瘤。\n\n毒瘤最近发现了量产毒瘤题的奥秘。考虑如下类型的数据结构题：给出一个数组，要求支持若干种奇奇怪怪的修改操作（比如区间加一个数，或者区间开平方），并支持询问区间和。毒瘤考虑了 $n$ 个这样的修改操作，并编号为 $1\\sim n$。当毒瘤要出数据结构题的时候，他就将这些修改操作中选若干个出来，然后出成一道题。\n\n当然了，这样出的题有可能不可做。通过精妙的数学推理，毒瘤揭露了这些修改操作的关系：有 $m$ 对“互相排斥”的修改操作，第 $i$ 对是第 $u_i$ 个操作和第 $v_i$ 个操作。当一道题同时含有 $u_i$ 和 $v_i$ 这两个操作时，这道题就会变得不可做。另一方面，一道题中不包含任何“互相排斥”的修改操作时，这个题就是可做的。此外，毒瘤还发现了一个规律：$m-n$ 是一个很小的数字，且任意两个修改操作都是连通的。两个修改操作 $a,b$ 是连通的，当且仅当存在若干操作 $t_0,t_1,\\cdots,t_l$，使得 $t_0=a,t_l=b$，且对 $1\\leq i\\leq l$，$t_{i-1}$ 和 $t_i$ 都是“互相排斥”的修改操作。\n\n一对“互相排斥”的修改操作称为互斥对。现在毒瘤想知道，给定值 $n$ 和 $m$ 个互斥对，他共能出出多少道可做的不同的数据结构题。两道数据结构题是不同的，当且仅当有一个修改操作在其中一道题中存在，而在另一道题中不存在。", "inputFormat": "第一行为正整数 $n,m$。\n\n接下来 $m$ 行，每行两个正整数 $u,v$，代表一对“互相排斥”的修改操作。", "outputFormat": "输出一行一个整数，代表毒瘤可以出的可做的不同的“互相排斥”的修改操作的个数。这个数可能很大，所以只输出模 $998244353$ 后的值。", "hint": "#### 样例一说明\n\n可做的题包括 $\\varnothing,\\{1\\},\\{2\\},\\{3\\},\\{1,3\\}$。注意，**空集是合法的数据结构题**。\n\n#### 数据范围\n\n![](https://cdn.luogu.com.cn/upload/pic/17511.png)", "locale": "zh-CN"}}}
{"pid": "P4427", "type": "P", "difficulty": 4, "samples": [["5\n1 2\n1 3\n2 4\n2 5\n2\n1 4 5\n5 4 45", "33\n503245989"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "倍增", "各省省选", "北京", "O2优化", "深度优先搜索 DFS", "最近公共祖先 LCA", "树链剖分", "前缀和", "差分"], "title": "[BJOI2018] 求和", "background": "", "description": "master 对树上的求和非常感兴趣。他生成了一棵有根树，并且希望多次询问这棵树上一段路径上所有节点深度的 $k$ 次方和，而且每次的 $k$ 可能是不同的。此处节点深度的定义是这个节点到根的路径上的边数。他把这个问题交给了 pupil，但 pupil 并不会这么复杂的操作，你能帮他解决吗？", "inputFormat": "第一行包含一个正整数 $n$，表示树的节点数。\n\n之后 $n-1$ 行每行两个空格隔开的正整数 $i, j$，表示树上的一条连接点 $i$ 和点 $j$ 的边。\n\n之后一行一个正整数 $m$，表示询问的数量。\n\n之后每行三个空格隔开的正整数 $i, j, k$，表示询问从点 $i$ 到点 $j$ 的路径上所有节点深度的 $k$ 次方和。由于这个结果可能非常大，输出其对 $998244353$ 取模的结果。\n\n树的节点从 $1$ 开始标号，其中 $1$ 号节点为树的根。", "outputFormat": "对于每组数据输出一行一个正整数表示取模后的结果。\n", "hint": "### 样例解释\n\n以下用 $d (i)$ 表示第 $i$ 个节点的深度。\n\n对于样例中的树，有 $d (1) = 0, d (2) = 1, d (3) = 1, d (4) = 2, d (5) = 2$。\n\n因此第一个询问答案为 $(2^5 + 1^5 + 0^5) \\bmod 998244353 = 33$，第二个询问答案为$(2^{45} + 1^{45} + 2^{45}) \\bmod 998244353 = 503245989$。\n\n### 数据范围\n\n对于 $30\\%$ 的数据，$1 \\leq n,m \\leq 100$。\n\n对于 $60\\%$ 的数据，$1 \\leq n,m \\leq 1000$。\n\n对于 $100\\%$ 的数据，$1 \\leq n,m \\leq 300000$，$1 \\leq k \\leq 50$。\n\n另外存在 5 个不计分的 hack 数据。\n\n### 提示\n\n数据规模较大，请注意使用较快速的输入输出方式。", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2018] Sum", "background": "", "description": "master is very interested in sums on trees. He generated a rooted tree and wants to query, multiple times, the sum of the $k$-th power of the depths of all nodes on a path, and $k$ may be different each time. Here, the depth of a node is defined as the number of edges on the path from this node to the root. He handed this problem to pupil, but pupil does not know how to perform such complex operations. Can you help him?", "inputFormat": "The first line contains a positive integer $n$, the number of nodes in the tree.\n\nEach of the next $n - 1$ lines contains two space-separated positive integers $i, j$, indicating an edge between nodes $i$ and $j$ in the tree.\n\nThe next line contains a positive integer $m$, the number of queries.\n\nEach of the next $m$ lines contains three space-separated positive integers $i, j, k$, representing a query asking for the sum of the $k$-th power of the depths of all nodes on the path from node $i$ to node $j$. Since the result can be very large, output it modulo $998244353$.\n\nNodes are numbered starting from $1$, and node $1$ is the root.", "outputFormat": "For each query, output one line with a single integer, the result modulo $998244353$.", "hint": "Sample Explanation\n\nLet $d (i)$ denote the depth of node $i$.\n\nFor the sample tree, $d (1) = 0, d (2) = 1, d (3) = 1, d (4) = 2, d (5) = 2$.\n\nTherefore, the answer to the first query is $(2^5 + 1^5 + 0^5) \\bmod 998244353 = 33$; the answer to the second query is $(2^{45} + 1^{45} + 2^{45}) \\bmod 998244353 = 503245989$.\n\nConstraints\n\n- For $30\\%$ of the testdata, $1 \\leq n, m \\leq 100$.\n- For $60\\%$ of the testdata, $1 \\leq n, m \\leq 1000$.\n- For $100\\%$ of the testdata, $1 \\leq n, m \\leq 300000$, $1 \\leq k \\leq 50$.\n\nAdditionally, there are $5$ unscored hack testdata.\n\nTip\n\nThe input size is large; please use fast I/O.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2018] 求和", "background": "", "description": "master 对树上的求和非常感兴趣。他生成了一棵有根树，并且希望多次询问这棵树上一段路径上所有节点深度的 $k$ 次方和，而且每次的 $k$ 可能是不同的。此处节点深度的定义是这个节点到根的路径上的边数。他把这个问题交给了 pupil，但 pupil 并不会这么复杂的操作，你能帮他解决吗？", "inputFormat": "第一行包含一个正整数 $n$，表示树的节点数。\n\n之后 $n-1$ 行每行两个空格隔开的正整数 $i, j$，表示树上的一条连接点 $i$ 和点 $j$ 的边。\n\n之后一行一个正整数 $m$，表示询问的数量。\n\n之后每行三个空格隔开的正整数 $i, j, k$，表示询问从点 $i$ 到点 $j$ 的路径上所有节点深度的 $k$ 次方和。由于这个结果可能非常大，输出其对 $998244353$ 取模的结果。\n\n树的节点从 $1$ 开始标号，其中 $1$ 号节点为树的根。", "outputFormat": "对于每组数据输出一行一个正整数表示取模后的结果。\n", "hint": "### 样例解释\n\n以下用 $d (i)$ 表示第 $i$ 个节点的深度。\n\n对于样例中的树，有 $d (1) = 0, d (2) = 1, d (3) = 1, d (4) = 2, d (5) = 2$。\n\n因此第一个询问答案为 $(2^5 + 1^5 + 0^5) \\bmod 998244353 = 33$，第二个询问答案为$(2^{45} + 1^{45} + 2^{45}) \\bmod 998244353 = 503245989$。\n\n### 数据范围\n\n对于 $30\\%$ 的数据，$1 \\leq n,m \\leq 100$。\n\n对于 $60\\%$ 的数据，$1 \\leq n,m \\leq 1000$。\n\n对于 $100\\%$ 的数据，$1 \\leq n,m \\leq 300000$，$1 \\leq k \\leq 50$。\n\n另外存在 5 个不计分的 hack 数据。\n\n### 提示\n\n数据规模较大，请注意使用较快速的输入输出方式。", "locale": "zh-CN"}}}
{"pid": "P4428", "type": "P", "difficulty": 6, "samples": [["4\n1 0 1 0\n3\n2 1 3\n1 3\n2 3 4", "2\n3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "线段树", "各省省选", "树状数组", "北京", "O2优化", "构造"], "title": "[BJOI2018] 二进制", "background": null, "description": "pupil 发现对于一个十进制数，无论怎么将其的数字重新排列，均不影响其是不是 $3$ 的倍数。他想研究对于二进制，是否也有类似的性质。\n\n于是他生成了一个长为 $n$ 的二进制串，希望你对于这个二进制串的一个子区间，能求出其有多少位置不同的连续子串，满足在重新排列后（可包含前导 $0$）是一个 $3$ 的倍数。\n\n两个位置不同的子区间指开始位置不同或结束位置不同。\n\n由于他想尝试尽量多的情况，他有时会修改串中的一个位置，并且会进行多次询问。", "inputFormat": "输入第一行包含一个正整数 $n$，表示二进制数的长度。\n\n之后一行 $n$ 个空格隔开的整数，保证均是 $0$ 或 $1$，表示该二进制串。\n\n之后一行一个整数 $m$ ，表示询问和修改的总次数。\n\n之后 $m$ 行每行为 ```1 i```，表示 pupil 修改了串的第 $i$ 个位置（$0$ 变成 $1$ 或 $1$ 变成 $0$），或 ```2 l r```，表示 pupil 询问的子区间是 $[l,r]$。\n\n串的下标从 $1$ 开始。", "outputFormat": "对于每次询问，输出一行一个整数表示对应该询问的结果。", "hint": "### 样例解释\n\n对于第一个询问，区间 $[2,2]$ 只有数字 $0$，是 $3$ 的倍数，区间 $[1,3]$ 可以重排成 $011_{(2)} = 3_{(10)}$，是 $3$ 的倍数，其他区间均不能重排成 $3$ 的倍数。\n\n对于第二个询问，全部三个区间均能重排成 $3$ 的倍数（注意 $00$ 也是合法的）。\n\n### 数据范围\n\n对于$20\\%$ 的数据，$1 \\leq n,m \\leq 100$。\n\n对于$50\\%$ 的数据，$1 \\leq n,m \\leq 5000$。\n\n对于$100\\%$ 的数据，$1 \\leq n,m \\leq 100000$，$l \\leq r$。", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2018] Binary", "background": "", "description": "pupil found that for a decimal number, no matter how its digits are rearranged, it does not affect whether it is a multiple of $3$. He wants to study whether there is a similar property for binary.\n\nSo he generated a binary string of length $n$, and hopes that for a subinterval of this binary string, you can find how many position-distinct contiguous substrings satisfy that after rearrangement (leading zeros are allowed), the result is a multiple of $3$.\n\nTwo position-distinct subintervals are defined as having different starting positions or different ending positions.\n\nSince he wants to try as many cases as possible, he will sometimes modify one position in the string and will make multiple queries.", "inputFormat": "The first line contains a positive integer $n$, the length of the binary number.\n\nThe second line contains $n$ space-separated integers, each being $0$ or $1$, representing the binary string.\n\nThe third line contains an integer $m$, the total number of queries and modifications.\n\nEach of the following $m$ lines is either ```1 i```, meaning pupil toggles the $i$-th position of the string ($0$ becomes $1$ or $1$ becomes $0$), or ```2 l r```, meaning pupil queries the subinterval $[l,r]$.\n\nThe string is $1$-indexed.", "outputFormat": "For each query, output one line with one integer representing the answer to that query.", "hint": "Sample Explanation:\n- For the first query, the interval $[2,2]$ contains only the digit $0$, which is a multiple of $3$. The interval $[1,3]$ can be rearranged into $011_{(2)} = 3_{(10)}$, which is a multiple of $3$. All other intervals cannot be rearranged into a multiple of $3$.\n- For the second query, all three intervals can be rearranged into multiples of $3$ (note that $00$ is also valid).\n\nConstraints:\n- For $20\\%$ of the testdata, $1 \\leq n,m \\leq 100$.\n- For $50\\%$ of the testdata, $1 \\leq n,m \\leq 5000$.\n- For $100\\%$ of the testdata, $1 \\leq n,m \\leq 100000$, $l \\leq r$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2018] 二进制", "background": null, "description": "pupil 发现对于一个十进制数，无论怎么将其的数字重新排列，均不影响其是不是 $3$ 的倍数。他想研究对于二进制，是否也有类似的性质。\n\n于是他生成了一个长为 $n$ 的二进制串，希望你对于这个二进制串的一个子区间，能求出其有多少位置不同的连续子串，满足在重新排列后（可包含前导 $0$）是一个 $3$ 的倍数。\n\n两个位置不同的子区间指开始位置不同或结束位置不同。\n\n由于他想尝试尽量多的情况，他有时会修改串中的一个位置，并且会进行多次询问。", "inputFormat": "输入第一行包含一个正整数 $n$，表示二进制数的长度。\n\n之后一行 $n$ 个空格隔开的整数，保证均是 $0$ 或 $1$，表示该二进制串。\n\n之后一行一个整数 $m$ ，表示询问和修改的总次数。\n\n之后 $m$ 行每行为 ```1 i```，表示 pupil 修改了串的第 $i$ 个位置（$0$ 变成 $1$ 或 $1$ 变成 $0$），或 ```2 l r```，表示 pupil 询问的子区间是 $[l,r]$。\n\n串的下标从 $1$ 开始。", "outputFormat": "对于每次询问，输出一行一个整数表示对应该询问的结果。", "hint": "### 样例解释\n\n对于第一个询问，区间 $[2,2]$ 只有数字 $0$，是 $3$ 的倍数，区间 $[1,3]$ 可以重排成 $011_{(2)} = 3_{(10)}$，是 $3$ 的倍数，其他区间均不能重排成 $3$ 的倍数。\n\n对于第二个询问，全部三个区间均能重排成 $3$ 的倍数（注意 $00$ 也是合法的）。\n\n### 数据范围\n\n对于$20\\%$ 的数据，$1 \\leq n,m \\leq 100$。\n\n对于$50\\%$ 的数据，$1 \\leq n,m \\leq 5000$。\n\n对于$100\\%$ 的数据，$1 \\leq n,m \\leq 100000$，$l \\leq r$。", "locale": "zh-CN"}}}
{"pid": "P4429", "type": "P", "difficulty": 7, "samples": [["3\n6 9\n1 2\n1 4\n1 6\n3 2\n3 4\n3 6\n5 2\n5 4\n5 6\n2 1\n1 2\n3 3\n1 2\n1 3\n2 3", "NO\nYES\nNO"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["图论", "2018", "各省省选", "北京", "O2优化", "排序", "拓扑排序", "构造"], "title": "[BJOI2018] 染色", "background": "", "description": "pupil 喜欢给图的顶点染颜色。有一天，master 想刁难他，于是给了他一个无重边和自环的无向图，并且对每个点分别给了一个大小为 $2$ 的颜色集合，pupil 只能从这个集合中选一种颜色给这个点染色。master 希望 pupil 的染色方案使得没有两个有边相连的点被染了相同的颜色。\n\n现在 pupil 想知道，是否无论 master 的颜色集合是什么，他均有办法按照要求染色。", "inputFormat": "输入包含多组数据。\n\n第一行一个正整数 $T$，表示数据组数。\n\n之后每组数据第一行两个空格隔开的整数 $n,m$，表示这个无向图的点数和边数。\n\n之后 $m$ 行，每行两个空格隔开的正整数 $i,j$，表示图中的一条连接点 $i$ 和点 $j$ 的边。\n\n图的节点从 $1$ 开始标号。", "outputFormat": "对于每组数据，如果 pupil 无论如何均能染色，输出一行一个字符串 `YES`，否则输出一行一个字符串 `NO`。", "hint": "### 样例解释\n\n对于第一组数据，如果第一个点和第二个点的集合为 $\\{A,B\\}$，第三个点和第四个点的集合为 $\\{A,C\\}$，第五个点和第六个点的集合为 $\\{B,C\\}$，\n则奇数点至少使用了两种颜色，偶数点至少使用了两种颜色，因此至少有一个奇数点和一个偶数点颜色相同。但每两个奇数点和每两个偶数点之间均有边，\n因此无法满足“没有两个有边相连的点被染了相同的颜色”。\n\n对于第二组数据，无论两个集合是什么，第一个点随便染它的集合中的其中一种颜色，第二个点染它的集合中某个与第一个点不同的颜色即可。\n\n对于第三组数据，如果三个点的集合均是 $\\{A,B\\}$，那么无法满足“没有两个有边相连的点被染了相同的颜色”。\n\n### 数据范围\n\n- 对于 $10\\%$ 的数据，$1 \\leq n \\leq 3$；\n- 对于 $20\\%$ 的数据，$1 \\leq n \\leq 6$；\n- 对于 $50\\%$ 的数据，$1 \\leq n \\leq 1000$，$0 \\leq m \\leq 2000$；\n- 对于 $100\\%$ 的数据，$1 \\leq n \\leq 10000$，$0 \\leq m \\leq 20000$，$1 \\leq T \\leq 10$。\n- 另外存在 5 个不计分的 hack 数据。", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2018] Coloring", "background": "", "description": "pupil likes coloring the vertices of a graph. One day, master wanted to make things difficult and gave him a simple undirected graph (no multiple edges or self-loops). For each vertex, master assigned a color set of size $2$, and pupil can only choose one color from that set for the vertex. master wants pupil’s coloring to be such that no two vertices connected by an edge are colored with the same color.\n\nNow pupil wants to know whether, no matter what color sets master assigns, he can always color the graph as required.", "inputFormat": "The input contains multiple test cases.\n\nThe first line contains a positive integer $T$, the number of test cases.\n\nFor each test case, the first line contains two space-separated integers $n, m$, the number of vertices and edges in the undirected graph.\n\nThen follow $m$ lines, each containing two space-separated positive integers $i, j$, indicating an edge between vertices $i$ and $j$.\n\nVertices are numbered from $1$.", "outputFormat": "For each test case, if pupil can always color the graph regardless of the assigned color sets, output a line with the string `YES`; otherwise, output a line with the string `NO`.", "hint": "Sample explanation.\n\nFor the first test case, if the sets for the first and second vertices are $\\{A, B\\}$, for the third and fourth vertices are $\\{A, C\\}$, and for the fifth and sixth vertices are $\\{B, C\\}$, then the odd-indexed vertices must use at least two colors, and the even-indexed vertices must use at least two colors. Therefore, at least one odd-indexed vertex and one even-indexed vertex share the same color. But there is an edge between every pair of odd-indexed vertices and between every pair of even-indexed vertices, so the requirement “no two adjacent vertices share the same color” cannot be satisfied.\n\nFor the second test case, regardless of the two sets, color the first vertex with any color from its set, and color the second vertex with a color from its set that is different from the first vertex’s color.\n\nFor the third test case, if all three vertices have the set $\\{A, B\\}$, then the requirement “no two adjacent vertices share the same color” cannot be satisfied.\n\nConstraints:\n- For $10\\%$ of the testdata, $1 \\leq n \\leq 3$.\n- For $20\\%$ of the testdata, $1 \\leq n \\leq 6$.\n- For $50\\%$ of the testdata, $1 \\leq n \\leq 1000$, $0 \\leq m \\leq 2000$.\n- For $100\\%$ of the testdata, $1 \\leq n \\leq 10000$, $0 \\leq m \\leq 20000$, $1 \\leq T \\leq 10$.\n- There are also $5$ unscored hack testdata.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2018] 染色", "background": "", "description": "pupil 喜欢给图的顶点染颜色。有一天，master 想刁难他，于是给了他一个无重边和自环的无向图，并且对每个点分别给了一个大小为 $2$ 的颜色集合，pupil 只能从这个集合中选一种颜色给这个点染色。master 希望 pupil 的染色方案使得没有两个有边相连的点被染了相同的颜色。\n\n现在 pupil 想知道，是否无论 master 的颜色集合是什么，他均有办法按照要求染色。", "inputFormat": "输入包含多组数据。\n\n第一行一个正整数 $T$，表示数据组数。\n\n之后每组数据第一行两个空格隔开的整数 $n,m$，表示这个无向图的点数和边数。\n\n之后 $m$ 行，每行两个空格隔开的正整数 $i,j$，表示图中的一条连接点 $i$ 和点 $j$ 的边。\n\n图的节点从 $1$ 开始标号。", "outputFormat": "对于每组数据，如果 pupil 无论如何均能染色，输出一行一个字符串 `YES`，否则输出一行一个字符串 `NO`。", "hint": "### 样例解释\n\n对于第一组数据，如果第一个点和第二个点的集合为 $\\{A,B\\}$，第三个点和第四个点的集合为 $\\{A,C\\}$，第五个点和第六个点的集合为 $\\{B,C\\}$，\n则奇数点至少使用了两种颜色，偶数点至少使用了两种颜色，因此至少有一个奇数点和一个偶数点颜色相同。但每两个奇数点和每两个偶数点之间均有边，\n因此无法满足“没有两个有边相连的点被染了相同的颜色”。\n\n对于第二组数据，无论两个集合是什么，第一个点随便染它的集合中的其中一种颜色，第二个点染它的集合中某个与第一个点不同的颜色即可。\n\n对于第三组数据，如果三个点的集合均是 $\\{A,B\\}$，那么无法满足“没有两个有边相连的点被染了相同的颜色”。\n\n### 数据范围\n\n- 对于 $10\\%$ 的数据，$1 \\leq n \\leq 3$；\n- 对于 $20\\%$ 的数据，$1 \\leq n \\leq 6$；\n- 对于 $50\\%$ 的数据，$1 \\leq n \\leq 1000$，$0 \\leq m \\leq 2000$；\n- 对于 $100\\%$ 的数据，$1 \\leq n \\leq 10000$，$0 \\leq m \\leq 20000$，$1 \\leq T \\leq 10$。\n- 另外存在 5 个不计分的 hack 数据。", "locale": "zh-CN"}}}
{"pid": "P4430", "type": "P", "difficulty": 4, "samples": [["4", "96"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [165536, 165536, 165536, 165536, 165536, 165536, 165536, 165536, 165536, 165536, 165536]}, "tags": ["数学", "生成树", "线性代数", "Prüfer 序列"], "title": "小猴打架", "background": "", "description": "一开始森林里面有 $N$ 只互不相识的小猴子，它们经常打架，但打架的双方都必须不是好朋友。每次打完架后，打架的双方以及它们的好朋友就会互相认识，成为好朋友。经过 $N-1$ 次打架之后，整个森林的小猴都会成为好朋友。   \n现在的问题是，总共有多少种不同的打架过程。   \n比如当 $N=3$ 时，就有 $\\{1-2,1-3\\}\\{1-2,2-3\\}\\{1-3,1-2\\}\\{1-3,2-3\\}\\{2-3,1-2\\}\\{2-3,1-3\\}$ 六种不同的打架过程。 \n", "inputFormat": "一个整数 $N$。 ", "outputFormat": "一行，方案数 $\\bmod 9999991$。 ", "hint": "$50\\%$ 的数据 $N\\le 10^3$。  \n$100\\%$ 的数据 $N\\le10^6$。 ", "locale": "zh-CN", "translations": {"en": {"title": "Little Monkeys Fight", "background": "", "description": "Initially, there are $N$ little monkeys in the forest who do not know each other. They often fight, but the two sides in a fight must not be good friends. After each fight, the two fighters and their respective good friends will get to know each other and become good friends with each other. After $N - 1$ fights, all the monkeys in the forest will become good friends.\nThe question is: how many different fighting processes are there in total.\nFor example, when $N = 3$, there are six different fighting processes: {1-2, 1-3} {1-2, 2-3} {1-3, 1-2} {1-3, 2-3} {2-3, 1-2} {2-3, 1-3}.", "inputFormat": "A single integer $N$.", "outputFormat": "One line: the number of ways $\\bmod 9999991$.", "hint": "- 50% of the testdata $N \\le 10^3$.\n- 100% of the testdata $N \\le 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小猴打架", "background": "", "description": "一开始森林里面有 $N$ 只互不相识的小猴子，它们经常打架，但打架的双方都必须不是好朋友。每次打完架后，打架的双方以及它们的好朋友就会互相认识，成为好朋友。经过 $N-1$ 次打架之后，整个森林的小猴都会成为好朋友。   \n现在的问题是，总共有多少种不同的打架过程。   \n比如当 $N=3$ 时，就有 $\\{1-2,1-3\\}\\{1-2,2-3\\}\\{1-3,1-2\\}\\{1-3,2-3\\}\\{2-3,1-2\\}\\{2-3,1-3\\}$ 六种不同的打架过程。 \n", "inputFormat": "一个整数 $N$。 ", "outputFormat": "一行，方案数 $\\bmod 9999991$。 ", "hint": "$50\\%$ 的数据 $N\\le 10^3$。  \n$100\\%$ 的数据 $N\\le10^6$。 ", "locale": "zh-CN"}}}
{"pid": "P4431", "type": "P", "difficulty": 2, "samples": [["2\n1 10\n10 1\n", "0\n0"], ["3\n1 1\n3 3\n3 4\n", "0\n4\n4"], ["2\n5 8\n6 4", "8\n6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["搜索", "2017", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #2] ​Košnja", "background": "", "description": "Mirko wants to buy land on which he will build a house for his family. So far, he’s seen K pieces of land. Each of them is in the shape of a rectangle and we can think of it as a matrix with N rows and M columns, N × M fields in total.\n\nMirko is aware that, before construction begins, the property needs to be regularly maintained and the lawn needs to be mowed. Because of this, Mirko bought a lawn mower. In order to mow the entire lawn of N rows and M columns, he needs to go over each field at least once. He can start from any field facing one of the four main directions (up, down, left, and right). His lawn mower can only go forwards (to the adjacent field facing the current direction) or make a 90 degree turn. Additionally, because of his own safety, Mirko can only use the lawn mower on his land, so he cannot leave the matrix.\n\nSince making the lawn mower turn isn’t simple, Mirko wants to mow the lawn with the minimal amount of turns. For each piece of land he saw so far, Mirko wants to know the minimal number of turns he can make so that the entire lawn is mowed. Help Mirko solve this problem.", "inputFormat": "The first line of input contains the positive integer K (1 ≤ K ≤ 50 000), the number from the task.\n\nEach of the following K lines contains two positive integers N and M (1 ≤ N, M ≤ 1 000 000), the numbers from the task.\n", "outputFormat": "For each piece of land Mirko saw so far, output in a separate line the minimal amount of turns he can take so that the entire lawn is mowed.\n", "hint": "In test cases worth 50% of total points, Mirko will see only one piece of land. The dimensions of this piece of land will be smaller than 500.\n\n**Clarification​ ​of​ ​the​ ​first​ ​test​ ​case:**\n\nThe first piece of land can be mowed without making any turns if he starts from the field in the first column of the table, faced to the right and only going forwards. A similar idea applies for the second piece of land.", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #2] ​Košnja", "background": "", "description": "Mirko wants to buy land on which he will build a house for his family. So far, he’s seen K pieces of land. Each of them is in the shape of a rectangle and we can think of it as a matrix with N rows and M columns, N × M fields in total.\n\nMirko is aware that, before construction begins, the property needs to be regularly maintained and the lawn needs to be mowed. Because of this, Mirko bought a lawn mower. In order to mow the entire lawn of N rows and M columns, he needs to go over each field at least once. He can start from any field facing one of the four main directions (up, down, left, and right). His lawn mower can only go forwards (to the adjacent field facing the current direction) or make a 90 degree turn. Additionally, because of his own safety, Mirko can only use the lawn mower on his land, so he cannot leave the matrix.\n\nSince making the lawn mower turn isn’t simple, Mirko wants to mow the lawn with the minimal amount of turns. For each piece of land he saw so far, Mirko wants to know the minimal number of turns he can make so that the entire lawn is mowed. Help Mirko solve this problem.", "inputFormat": "The first line of input contains the positive integer K (1 ≤ K ≤ 50 000), the number from the task.\n\nEach of the following K lines contains two positive integers N and M (1 ≤ N, M ≤ 1 000 000), the numbers from the task.\n", "outputFormat": "For each piece of land Mirko saw so far, output in a separate line the minimal amount of turns he can take so that the entire lawn is mowed.\n", "hint": "In test cases worth 50% of total points, Mirko will see only one piece of land. The dimensions of this piece of land will be smaller than 500.\n\n**Clarification​ ​of​ ​the​ ​first​ ​test​ ​case:**\n\nThe first piece of land can be mowed without making any turns if he starts from the field in the first column of the table, faced to the right and only going forwards. A similar idea applies for the second piece of land.", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #2] ​Košnja", "background": "", "description": "**题目大意：**\n\n给定一个$n*m$的矩阵，每次你可以选择前进一格或转弯（90度），求在不出这个矩阵的情况下遍历全部格点所需最少转弯次数。有多组数据", "inputFormat": "第一行一个整数$k$，表示数据组数\n\n以下$k$行，每行两个整数$n,m$，表示矩阵大小", "outputFormat": "输出一个整数，即最少转弯次数\n\n感谢@守望 提供翻译", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4432", "type": "P", "difficulty": 2, "samples": [["4 5\nzagreb\nsplit\nzadar\nsisak\nz\ns\ns\nz\nz\n", "zadar\nsisak\nsplit\nzagreb\nzadar\n"], ["5 3\nlondon\nrim\npariz\nmoskva\nsarajevo\np\nr\np\n", "pariz\nrim\npariz\n"], ["1 3\nzagreb\nz\nz\nz\n", "zagreb\nzagreb\nzagreb"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["字符串", "2017", "排序", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #2] ​​ZigZag", "background": "", "description": "Zig and Zag are playing a word game. Zig says one letter, and Zag says a word that starts\nwith that letter. However, the word needs to be from the allowed word list and such that Zag\nalready said it the least amount of times. If the word choice is ambiguous, then Zag will\nchoose the one that is lexicographically smaller (sooner in the alphabet). For each Zig’s\nletter, it will be possible to choose a word.\n\nLet there be a list consisting of exactly K distinct words and an array of N letters that Zig has\ngiven. Write a program that will, based on the input, output an array of N words that Zag said\nduring the game.\n", "inputFormat": "The first line of input contains positive integers K (1 ≤ K ≤ 100 000) and N (1 ≤ N ≤ 100 000)\nfrom the task.\n\nEach of the following K lines contains a single word consisting of lowercase letters of the\nEnglish alphabet not longer than 21 characters.\n\nEach of the following N lines contains a single lowercase letter of the English alphabet.\n", "outputFormat": "You must output N lines, each containing a single word from the task.\n", "hint": "In test cases worth 60% of total points, it will hold that N and K are smaller than 500.", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #2] ​​ZigZag", "background": "", "description": "Zig and Zag are playing a word game. Zig says one letter, and Zag says a word that starts\nwith that letter. However, the word needs to be from the allowed word list and such that Zag\nalready said it the least amount of times. If the word choice is ambiguous, then Zag will\nchoose the one that is lexicographically smaller (sooner in the alphabet). For each Zig’s\nletter, it will be possible to choose a word.\n\nLet there be a list consisting of exactly K distinct words and an array of N letters that Zig has\ngiven. Write a program that will, based on the input, output an array of N words that Zag said\nduring the game.\n", "inputFormat": "The first line of input contains positive integers K (1 ≤ K ≤ 100 000) and N (1 ≤ N ≤ 100 000)\nfrom the task.\n\nEach of the following K lines contains a single word consisting of lowercase letters of the\nEnglish alphabet not longer than 21 characters.\n\nEach of the following N lines contains a single lowercase letter of the English alphabet.\n", "outputFormat": "You must output N lines, each containing a single word from the task.\n", "hint": "In test cases worth 60% of total points, it will hold that N and K are smaller than 500.", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #2] ​​ZigZag", "background": "", "description": "Zig和Zag正在玩文字游戏。Zig说了一个字母，而Zag说了一个以该字母开头的单词。但是这个词需要出现在给出的单词列表中，并且被是相同首字母中使用的次数最少的单词。如果单词的选择不明确(即相同首字母中使用的次数最少的单词不止一个)，那么Zag会选择字典序较小的字母。输入保证对于每个Zig的字母，都有可以选择的单词。\n\n假设有一个由K个不同的单词组成的列表和一个Zig给出的N个字母组成的列表。编写一个程序，根据输入，输出Zag在游戏过程中说出的N个单词。", "inputFormat": "第一行输入包含来自的正整数K（1≤K≤100 000）和N（1≤N≤100 000）。\n\n以下K行是K个单词，由小写英文字母组成，不超过21个字母。\n\n以下N行是Zig说的N个小写英文字母。", "outputFormat": "N行，分别对应N个Zig的询问。\n\n感谢@K_Vin 提供的翻译", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4433", "type": "P", "difficulty": 7, "samples": [["6 3\n2 1 6\n1 1 5 1 2\n2 1 6\n", "0\n3"], ["4 5\n1 1 4 3 4\n2 1 1\n2 2 2\n2 3 3\n2 4 4\n", "3\n2\n1\n0"], ["4 4\n1 1 4 7 9\n2 1 4\n1 1 4 1 1\n2 1 4\n", "16\n0"]], "limits": {"time": [8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["数学", "2009", "线段树", "递归", "COCI（克罗地亚）", "类欧几里得算法"], "title": "[COCI 2009/2010 #1] ALADIN", "background": "", "description": "给你 $n$ 个盒子，有 $q$ 个操作，操作有两种：\n\n- 第一种操作输入格式为 `1 L R A B`，表示将编号为 $L$ 到 $R$ 的盒子里的石头数量变为 $(X-L+1) \\times A \\bmod B$，其中 $X$ 为盒子的编号。\n- 第二种操作输入格式为 `2 L R`，表示查询编号为 $L$ 到 $R$ 的盒子里的石头总数。", "inputFormat": "第一行有两个数字 $n$（$1 \\leq n \\leq 10^9$），$q$ （$1 \\leq q \\leq 5 \\times 10^4$）。\n\n接下来 $q$ 行表示询问操作。", "outputFormat": "对于每个第二种操作，输出石头总数。", "hint": "- 对于 $30\\%$ 的数据，$n, q \\leq 10^3$；\n- 对于 $70\\%$ 的数据，$q \\leq 10^3$。\n\n对于 $100\\%$ 的数据，$1\\leq A,B\\leq 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2009/2010 #1] ALADIN", "background": "", "description": "You are given $n$ boxes and $q$ operations of two types:\n\n- Type 1 operation with input format `1 L R A B`: for each box $X$ with $L \\leq X \\leq R$, set its number of stones to $(X - L + 1) \\times A \\bmod B$, where $X$ is the index of the box.\n- Type 2 operation with input format `2 L R`: query the total number of stones in boxes numbered $L$ through $R$.", "inputFormat": "The first line contains two integers $n$ ($1 \\leq n \\leq 10^9$) and $q$ ($1 \\leq q \\leq 5 \\times 10^4$).\n\nThe next $q$ lines describe the operations.", "outputFormat": "For each type 2 operation, output the total number of stones.", "hint": "- For $30\\%$ of the testdata, $n, q \\leq 10^3$.\n- For $70\\%$ of the testdata, $q \\leq 10^3$.\n- For $100\\%$ of the testdata, $1 \\leq A, B \\leq 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[COCI 2009/2010 #1] ALADIN", "background": "", "description": "给你 $n$ 个盒子，有 $q$ 个操作，操作有两种：\n\n- 第一种操作输入格式为 `1 L R A B`，表示将编号为 $L$ 到 $R$ 的盒子里的石头数量变为 $(X-L+1) \\times A \\bmod B$，其中 $X$ 为盒子的编号。\n- 第二种操作输入格式为 `2 L R`，表示查询编号为 $L$ 到 $R$ 的盒子里的石头总数。", "inputFormat": "第一行有两个数字 $n$（$1 \\leq n \\leq 10^9$），$q$ （$1 \\leq q \\leq 5 \\times 10^4$）。\n\n接下来 $q$ 行表示询问操作。", "outputFormat": "对于每个第二种操作，输出石头总数。", "hint": "- 对于 $30\\%$ 的数据，$n, q \\leq 10^3$；\n- 对于 $70\\%$ 的数据，$q \\leq 10^3$。\n\n对于 $100\\%$ 的数据，$1\\leq A,B\\leq 10^6$。", "locale": "zh-CN"}}}
{"pid": "P4434", "type": "P", "difficulty": 5, "samples": [["4 1\n1 2\n2 3\n3 4\n2 4", "4"], ["7 2\n1 2\n1 3\n4 2\n2 5\n6 5\n5 7\n1 7\n2 6\n", "8"], ["4 3\n1 2\n1 3\n1 4\n2 3\n2 4\n3 4\n", "0"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2017", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #2] ​​Usmjeri", "background": "", "description": "We are given a tree with N nodes denoted with different positive integers from 1 to N.\nAdditionally, you are given M node pairs from the tree in the form of ($a_1$\n, $b_1$\n), ($a_2$\n, $b_2$\n), …, ($a_M$\n,\n$b_M$\n).\n\nWe need to direct each edge of the tree so that for each given node pair ($a_i$\n, $b_i$\n) there is a\npath from $a_i$\nto $b_i$ or from $b_i$\nto $a_i$\n. How many different ways are there to achieve this?\nSince the solution can be quite large, determine it modulo $10^{9}+7$.\n", "inputFormat": "The first line of input contains the positive integers N and M (1 ≤ N, M ≤ $3*10^5$), the number of\nnodes in the tree and the number of given node pairs, respectively.\n\nEach of the following N - 1 lines contains two positive integers, the labels of the nodes\nconnected with an edge.\n\nThe $i_{th}$ of the following M lines contains two different positive integers $a_{i}$ and $b_{i}$\n, the labels of\nthe nodes from the $i_{th}$ node pair. All node pairs will be mutually different.\n", "outputFormat": "You must output a single line containing the total number of different ways to direct the\nedges of the tree that meet the requirement from the task, modulo $10^{9}+7$.\n", "hint": "In test cases worth 20% of total points, the given tree will be a chain. In other words, node i\nwill be connected with an edge to node i + 1 for all i < N.\n\nIn additional test cases worth 40% of total points, it will hold N, M ≤ $5*10^3$.\n\nA tree is a graph that consists of N nodes and N - 1 edges such that there exists a path from each\nnode to each other node.", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #2] ​​Usmjeri", "background": "", "description": "We are given a tree with N nodes denoted with different positive integers from 1 to N.\nAdditionally, you are given M node pairs from the tree in the form of ($a_1$\n, $b_1$\n), ($a_2$\n, $b_2$\n), …, ($a_M$\n,\n$b_M$\n).\n\nWe need to direct each edge of the tree so that for each given node pair ($a_i$\n, $b_i$\n) there is a\npath from $a_i$\nto $b_i$ or from $b_i$\nto $a_i$\n. How many different ways are there to achieve this?\nSince the solution can be quite large, determine it modulo $10^{9}+7$.\n", "inputFormat": "The first line of input contains the positive integers N and M (1 ≤ N, M ≤ $3*10^5$), the number of\nnodes in the tree and the number of given node pairs, respectively.\n\nEach of the following N - 1 lines contains two positive integers, the labels of the nodes\nconnected with an edge.\n\nThe $i_{th}$ of the following M lines contains two different positive integers $a_{i}$ and $b_{i}$\n, the labels of\nthe nodes from the $i_{th}$ node pair. All node pairs will be mutually different.\n", "outputFormat": "You must output a single line containing the total number of different ways to direct the\nedges of the tree that meet the requirement from the task, modulo $10^{9}+7$.\n", "hint": "In test cases worth 20% of total points, the given tree will be a chain. In other words, node i\nwill be connected with an edge to node i + 1 for all i < N.\n\nIn additional test cases worth 40% of total points, it will hold N, M ≤ $5*10^3$.\n\nA tree is a graph that consists of N nodes and N - 1 edges such that there exists a path from each\nnode to each other node.", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #2] ​​Usmjeri", "background": null, "description": "我们有一棵包含 $N$ 个节点的树，这些节点用从 $1$ 到 $N$ 的不同正整数表示。此外，给定树中的 $M$ 对节点，形式为 $(a_1, b_1), (a_2, b_2), \\ldots, (a_M, b_M)$。\n\n我们需要为树的每条边指定一个方向，使得对于每一对给定的节点对 $(a_i, b_i)$，存在从 $a_i$ 到 $b_i$ 或从 $b_i$ 到 $a_i$ 的路径。我们需要计算有多少种不同的方法可以实现这一点。由于结果可能非常大，需对 $10^9+7$ 取模。", "inputFormat": "输入的第一行包含正整数 $N$ 和 $M(1 \\leq N, M \\leq 3 \\times 10^5)$，分别表示树中的节点数和给定的节点对数。\n\n接下来的 $N - 1$ 行中，每行包含两个正整数，表示一条边所连接的两个顶点编号。\n\n接下来的 $M$ 行中的第 $i$ 行包含两个不同的正整数 $a_i$ 和 $b_i$，表示第 $i$ 对节点的编号。所有节点对都是互不相同的。", "outputFormat": "你需要输出一个单独的行，包含满足题目要求的树的边的不同方向方法总数，对 $10^9+7$ 取模。", "hint": "### 数据规模与约定\n\n* 对于 $20\\%$ 的数据，满足树是一条链，即 $\\forall i<N$，保证 $i$ 和 $i+1$ 有连边。\n* 对于另外 $40\\%$ 的数据，$1\\le N,M\\le 5\\times10^3$。\n* 对于 $100\\%$ 的数据，$1\\le N,M\\le 3\\times10^5$。\n\n树的定义：一个包含 $N$ 个节点和 $N-1$ 条边的无向图，满足任两个节点之间都存在一条路径。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P4435", "type": "P", "difficulty": 6, "samples": [["5 1\n8 4 3 9 1\n2 2 5\n", "4"], ["5 3\n2 3 6 4 1\n2 1 4\n1 3 1\n2 3 5\n", "6\n1\n"], ["4 3\n2 2 2 2\n2 1 4\n1 2 3\n2 1 4\n", "10\n5"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "线段树", "分治", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #2] ​​Garaža", "background": "", "description": "Lately, Slavko’s been studying sequences of natural numbers. He finds a sequence\ninteresting if the greatest common divisor of all the elements from the sequence is greater\nthan 1.\n\nYesterday, he found a sequence consisting of N natural numbers in his garage. Since he\nwas really bored, he decided to keep himself occupied by asking simple queries. Each query\ncan be one of the two types:\n\n1. Change the value at position X in the sequence to V.\n\n2. Determine the number of interesting contiguous subarrays contained in the interval\n[L, R] of the sequence.\n", "inputFormat": "The first line of input contains the numbers N and Q (1 ≤ N, Q ≤ $10^5$\n), representing the\nnumber of elements in the sequence and the number of queries, respectively.\n\nThe following line contains N natural numbers $A_i$\n(1 ≤ $A_i$ ≤ $10^9$\n) that represent the numbers in\nthe initial sequence.\n\nEach of the following Q lines contains a query of the following form:\n\n - The first number in the line can be 1 or 2 and represents the type of the query.\n - If the query is of type 1, two numbers follow, X (1 ≤ X ≤ N) and V (1 ≤ V ≤ $10^9$\n) from\nthe task.\n - If the query is of type 2, two numbers follow, L and R (1 ≤ L ≤ R ≤ N) that represent\nthe left and right interval boundary.\n", "outputFormat": "For each query of type 2, output the number of interesting contiguous subarrays from the\ntask.\n", "hint": "**Clarification​ ​of​ ​the​ ​first​ ​test​ ​case:**\n\nThe interval from the $2_{nd}$ to the $5_{th}$ position consists of numbers (4, 3, 9, 1). In it, the following are\ninteresting contiguous subarrays (denoted with square brackets):\n**[4]**​ 3 9 1, 4 **[3]​** ​9 1, 4 3 **[9]**​ 1, 4 **[3​ ​9]​** 1", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #2] ​​Garaža", "background": "", "description": "Lately, Slavko’s been studying sequences of natural numbers. He finds a sequence\ninteresting if the greatest common divisor of all the elements from the sequence is greater\nthan 1.\n\nYesterday, he found a sequence consisting of N natural numbers in his garage. Since he\nwas really bored, he decided to keep himself occupied by asking simple queries. Each query\ncan be one of the two types:\n\n1. Change the value at position X in the sequence to V.\n\n2. Determine the number of interesting contiguous subarrays contained in the interval\n[L, R] of the sequence.\n", "inputFormat": "The first line of input contains the numbers N and Q (1 ≤ N, Q ≤ $10^5$\n), representing the\nnumber of elements in the sequence and the number of queries, respectively.\n\nThe following line contains N natural numbers $A_i$\n(1 ≤ $A_i$ ≤ $10^9$\n) that represent the numbers in\nthe initial sequence.\n\nEach of the following Q lines contains a query of the following form:\n\n - The first number in the line can be 1 or 2 and represents the type of the query.\n - If the query is of type 1, two numbers follow, X (1 ≤ X ≤ N) and V (1 ≤ V ≤ $10^9$\n) from\nthe task.\n - If the query is of type 2, two numbers follow, L and R (1 ≤ L ≤ R ≤ N) that represent\nthe left and right interval boundary.\n", "outputFormat": "For each query of type 2, output the number of interesting contiguous subarrays from the\ntask.\n", "hint": "**Clarification​ ​of​ ​the​ ​first​ ​test​ ​case:**\n\nThe interval from the $2_{nd}$ to the $5_{th}$ position consists of numbers (4, 3, 9, 1). In it, the following are\ninteresting contiguous subarrays (denoted with square brackets):\n**[4]**​ 3 9 1, 4 **[3]​** ​9 1, 4 3 **[9]**​ 1, 4 **[3​ ​9]​** 1", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #2] ​​Garaža", "background": "", "description": "最近，Slavko 一直在研究自然数序列。他认为一个序列是有趣的，如果序列中所有元素的最大公约数大于 1。\n\n昨天，他在车库里找到了一个由 N 个自然数组成的序列。由于他感到非常无聊，他决定通过提出简单的查询来打发时间。每个查询可以是以下两种类型之一：\n\n1. 将序列中位置 X 的值更改为 V。\n\n2. 确定序列中区间 [L, R] 内包含的有趣连续子数组的数量。", "inputFormat": "输入的第一行包含数字 N 和 Q (1 ≤ N, Q ≤ $10^5$)，分别表示序列中的元素数量和查询的数量。\n\n接下来的行包含 N 个自然数 $A_i$ (1 ≤ $A_i$ ≤ $10^9$)，表示初始序列中的数字。\n\n接下来的 Q 行中的每一行包含一个查询，格式如下：\n\n- 行中的第一个数字可以是 1 或 2，表示查询的类型。\n- 如果查询是类型 1，后面跟着两个数字 X (1 ≤ X ≤ N) 和 V (1 ≤ V ≤ $10^9$)。\n- 如果查询是类型 2，后面跟着两个数字 L 和 R (1 ≤ L ≤ R ≤ N)，表示左边界和右边界。", "outputFormat": "对于每个类型 2 的查询，输出任务中有趣的连续子数组的数量。", "hint": "**第一个测试用例的说明：**\n\n从第 $2$ 个位置到第 $5$ 个位置的区间由数字 (4, 3, 9, 1) 组成。在其中，有以下有趣的连续子数组（用方括号表示）：**[4]** 3 9 1, 4 **[3]** 9 1, 4 3 **[9]** 1, 4 **[3 9]** 1。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P4436", "type": "P", "difficulty": 6, "samples": [["5 4 5 \n1 3\n2 2 \n3 1\n4 4\n2 5\n3 5\n4 5 \n2 1\n3 1", "YES\nNO\nYES\nYES\nNO"], ["7 5 4\n2 2\n3 3 \n4 2 \n5 3 \n6 6\n2 1\n3 4\n3 7\n4 5", "YES\nYES\nNO\nNO"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "各省省选", "安徽", "湖南", "枚举", "剪枝", "强连通分量", "栈"], "title": "[HNOI/AHOI2018] 游戏", "background": "", "description": "一次小G和小H在玩寻宝游戏，有 $n$ 个房间排成一列，编号为 $1,2,\\cdots,n$ ，相邻的房间之间都有一道门。其中一部分门上锁（因此需要有对应的钥匙才能开门），其余的门都能直接打开。现在小G告诉了小H每把锁的钥匙在哪个房间里（**每把锁有且只有一把钥匙与之对应**），并作出 $p$ 次指示：第 $i$ 次让小H从第 $S_i$ 个房间出发到 $T_i$ 个房间里。但是小G有时会故意在指令中放入死路，而小H也不想浪费多余的体力去尝试，于是想事先调查清楚每次的指令是否会存在一条通路。\n\n你是否能为小H作出解答呢？", "inputFormat": "第一行三个数字： $n,m,p$ ，代表有 $n$ 个房间， $m$ 道门上了锁，以及 $p$ 个询问。接下来$m$行，每行两个数字 $x,y$ 代表 $x$ 到 $x+1$ 的钥匙在房间 $y$ 。接下来 $p$ 行，其中第$i$行是两个整数 $S_i$，$T_i$，代表一次询问", "outputFormat": "输出 $p$ 行，每行一个`YES`或`NO`，分别代表能或不能到达。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/17503.png)\n\n$1\\le n,p\\le 10^6$ ， $0\\le m <n$ ， $1\\le x,y,S_i,T_i<n$ 保证 $x$ 不重复", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI/AHOI2018] Game", "background": "", "description": "Xiao G and Xiao H are playing a treasure-hunting game. There are $n$ rooms in a line, numbered $1,2,\\cdots,n$, with a door between each pair of adjacent rooms. Some doors are locked (so they require the corresponding keys to open), and the remaining doors can be opened directly. Xiao G tells Xiao H which room contains the key for each lock (each lock has exactly one corresponding key), and then gives $p$ instructions: for the $i$-th one, Xiao H is asked to go from room $S_i$ to room $T_i$. However, Xiao G may intentionally include dead ends in the instructions, and Xiao H does not want to waste extra energy trying, so he wants to determine in advance whether a path exists for each instruction.\n\nCan you answer for Xiao H?", "inputFormat": "The first line contains three integers $n, m, p$, representing that there are $n$ rooms, $m$ locked doors, and $p$ queries. The next $m$ lines each contain two integers $x, y$, meaning that the key for the lock between rooms $x$ and $x+1$ is located in room $y$. The next $p$ lines follow, where the $i$-th line contains two integers $S_i, T_i$, representing one query.", "outputFormat": "Output $p$ lines, each containing `YES` or `NO`, indicating whether it is reachable.", "hint": "![](https://cdn.luogu.com.cn/upload/pic/17503.png)\n\nConstraints\n\n$1 \\le n, p \\le 10^6$, $0 \\le m < n$, $1 \\le x, y, S_i, T_i < n$. It is guaranteed that $x$ is not repeated.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI/AHOI2018] 游戏", "background": "", "description": "一次小G和小H在玩寻宝游戏，有 $n$ 个房间排成一列，编号为 $1,2,\\cdots,n$ ，相邻的房间之间都有一道门。其中一部分门上锁（因此需要有对应的钥匙才能开门），其余的门都能直接打开。现在小G告诉了小H每把锁的钥匙在哪个房间里（**每把锁有且只有一把钥匙与之对应**），并作出 $p$ 次指示：第 $i$ 次让小H从第 $S_i$ 个房间出发到 $T_i$ 个房间里。但是小G有时会故意在指令中放入死路，而小H也不想浪费多余的体力去尝试，于是想事先调查清楚每次的指令是否会存在一条通路。\n\n你是否能为小H作出解答呢？", "inputFormat": "第一行三个数字： $n,m,p$ ，代表有 $n$ 个房间， $m$ 道门上了锁，以及 $p$ 个询问。接下来$m$行，每行两个数字 $x,y$ 代表 $x$ 到 $x+1$ 的钥匙在房间 $y$ 。接下来 $p$ 行，其中第$i$行是两个整数 $S_i$，$T_i$，代表一次询问", "outputFormat": "输出 $p$ 行，每行一个`YES`或`NO`，分别代表能或不能到达。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/17503.png)\n\n$1\\le n,p\\le 10^6$ ， $0\\le m <n$ ， $1\\le x,y,S_i,T_i<n$ 保证 $x$ 不重复", "locale": "zh-CN"}}}
{"pid": "P4437", "type": "P", "difficulty": 6, "samples": [["3 \n0 1 1 \n5 7 3 ", "32"], ["3 \n2 3 1 \n1 2 3 ", "-1"], ["10 \n6 6 10 1 7 0 0 1 7 7 \n16 3 10 20 5 14 17 17 16 13 ", "809"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2018", "各省省选", "安徽", "湖南"], "title": "[HNOI/AHOI2018] 排列", "background": null, "description": "给定 $n$ 个整数 $a_1,a_2,\\dots,a_n,0\\le a_i\\le n$，以及 $n$ 个整数 $w_1,w_2,\\dots,w_n$。称 $a_1,a_2,\\dots,a_n$ 的一个排列 $a_{p_1},a_{p_2},\\dots,a_{p_n}$ 为 $a_1,a_2,\\dots,a_n$ 的一个合法排列，当且仅当该排列满足：对于任意的 $k$ 和任意的 $j$，如果 $j\\le k$，那么 $a_{p_j}$ 不等于 $p_k$。（换句话说就是：对于任意的 $k$ 和任意的 $j$，如果 $p_k$ 等于 $a_{p_j}$，那么 $k<j$。）定义这个合法排列的权值为 $w_{p_1}+2w_{p_2}+\\dots+nw_{p_n}$。\n\n你需要求出在所有合法排列中的最大权值。如果不存在合法排列，输出 $-1$。 \n\n样例解释中给出了合法排列和非法排列的实例。", "inputFormat": "第一行一个整数 $n$。 \n\n接下来一行 $n$ 个整数，表示 $a_1,a_2,\\dots,a_n$。接下来一行 $n$ 个整数，表示 $w_1,w_2,\\dots,w_n$。", "outputFormat": "输出一个整数表示答案。", "hint": "### 【样例解释 1】\n对于 $a_1=0,a_2=1,a_3=1$，其排列有：\n- $a_1=0,a_2=1,a_3=1$，是合法排列，排列的权值是 $1\\times 5+2\\times 7+3\\times 3=28$；\n- $a_2=1,a_1=0,a_3=1$，是非法排列，因为 $a_{p_2}$ 等于 $p_2$；\n- $a_1=0,a_3=1,a_2=1$，是合法排列，排列的权值是 $1\\times 5+2\\times 3+3\\times 7=32$；\n- $a_3=1,a_1=0,a_2=1$，是非法排列，因为 $a_{p_1}$ 等于 $p_2$；\n- $a_2=1,a_3=1,a_1=0$，是非法排列，因为 $a_{p_1}$ 等于 $p_3$；\n- $a_3=1,a_2=1,a_1=0$，是非法排列，因为 $a_{p_1}$ 等于 $p_3$。\n\n因此该题输出最大权值 $32$。 \n### 【样例解释 2】 \n对于 $a_1=2,a_2=3,a_3=1$，其排列有：\n- $a_1=2,a_2=3,a_3=1$，是非法排列，因为 $a_{p_1}$ 等于 $p_2$；\n- $a_2=3,a_1=2,a_3=1$，是非法排列，因为 $a_{p_1}$ 等于 $p_3$； \n- $a_1=2,a_3=1,a_2=3$，是非法排列，因为 $a_{p_1}$ 等于 $p_3$；  \n- $a_3=1,a_1=2,a_2=3$，是非法排列，因为 $a_{p_2}$ 等于 $p_3$； \n- $a_2=3,a_3=1,a_1=2$，是非法排列，因为 $a_{p_2}$ 等于 $p_3$； \n- $a_3=1,a_2=3,a_1=2$，是非法排列，因为 $a_{p_1}$ 等于 $p_3$。\n\n因此该题没有合法排列。 \n\n### 【数据范围】 \n- 对于前 $20\\%$ 的数据，$1\\le n\\le 10$。\n- 对于前 $40\\%$ 的数据，$1\\le n\\le  15$。\n- 对于前 $60\\%$ 的数据，$1\\le n\\le 1000$。  \n- 对于前 $80\\%$ 的数据，$1\\le n\\le 10^5$。  \n- 对于 $100\\%$ 的数据，$1\\le n\\le 5\\times10^5$，$0\\le a_i\\le n$，$1\\le w_i\\le10^9$，所有 $w_i$ 的和不超过 $1.5×10^{13}$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI/AHOI2018] Permutation", "background": "", "description": "Given $n$ integers $a_1, a_2, \\dots, a_n, 0 \\le a_i \\le n$, and $n$ integers $w_1, w_2, \\dots, w_n$. Call a permutation $a_{p_1}, a_{p_2}, \\dots, a_{p_n}$ of $a_1, a_2, \\dots, a_n$ a valid permutation of $a_1, a_2, \\dots, a_n$ if and only if it satisfies: for any $k$ and any $j$, if $j \\le k$, then $a_{p_j} \\ne p_k$. (In other words: for any $k$ and any $j$, if $p_k = a_{p_j}$, then $k < j$.) Define the weight of this valid permutation as $w_{p_1} + 2 w_{p_2} + \\dots + n w_{p_n}$.\n\nYou need to find the maximum weight among all valid permutations. If no valid permutation exists, output $-1$.\n\nThe sample explanations include examples of valid and invalid permutations.", "inputFormat": "The first line contains an integer $n$.\n\nThe next line contains $n$ integers, denoting $a_1, a_2, \\dots, a_n$. The following line contains $n$ integers, denoting $w_1, w_2, \\dots, w_n$.", "outputFormat": "Output a single integer representing the answer.", "hint": "### Sample Explanation 1\nFor $a_1 = 0, a_2 = 1, a_3 = 1$, its permutations are:\n- $a_1 = 0, a_2 = 1, a_3 = 1$, this is a valid permutation, and its weight is $1\\times 5 + 2\\times 7 + 3\\times 3 = 28$;\n- $a_2 = 1, a_1 = 0, a_3 = 1$, this is an invalid permutation because $a_{p_2}$ equals $p_2$;\n- $a_1 = 0, a_3 = 1, a_2 = 1$, this is a valid permutation, and its weight is $1\\times 5 + 2\\times 3 + 3\\times 7 = 32$;\n- $a_3 = 1, a_1 = 0, a_2 = 1$, this is an invalid permutation because $a_{p_1}$ equals $p_2$;\n- $a_2 = 1, a_3 = 1, a_1 = 0$, this is an invalid permutation because $a_{p_1}$ equals $p_3$;\n- $a_3 = 1, a_2 = 1, a_1 = 0$, this is an invalid permutation because $a_{p_1}$ equals $p_3$.\n\nTherefore, the maximum weight is $32$.\n\n### Sample Explanation 2\nFor $a_1 = 2, a_2 = 3, a_3 = 1$, its permutations are:\n- $a_1 = 2, a_2 = 3, a_3 = 1$, this is an invalid permutation because $a_{p_1}$ equals $p_2$;\n- $a_2 = 3, a_1 = 2, a_3 = 1$, this is an invalid permutation because $a_{p_1}$ equals $p_3$;\n- $a_1 = 2, a_3 = 1, a_2 = 3$, this is an invalid permutation because $a_{p_1}$ equals $p_3$;\n- $a_3 = 1, a_1 = 2, a_2 = 3$, this is an invalid permutation because $a_{p_2}$ equals $p_3$;\n- $a_2 = 3, a_3 = 1, a_1 = 2$, this is an invalid permutation because $a_{p_2}$ equals $p_3$;\n- $a_3 = 1, a_2 = 3, a_1 = 2$, this is an invalid permutation because $a_{p_1}$ equals $p_3$.\n\nTherefore, there is no valid permutation.\n\n### Constraints\n- For the first $20\\%$ of the testdata, $1 \\le n \\le 10$.\n- For the first $40\\%$ of the testdata, $1 \\le n \\le 15$.\n- For the first $60\\%$ of the testdata, $1 \\le n \\le 1000$.\n- For the first $80\\%$ of the testdata, $1 \\le n \\le 10^5$.\n- For $100\\%$ of the testdata, $1 \\le n \\le 5\\times 10^5$, $0 \\le a_i \\le n$, $1 \\le w_i \\le 10^9$, and the sum of all $w_i$ does not exceed $1.5\\times 10^{13}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI/AHOI2018] 排列", "background": null, "description": "给定 $n$ 个整数 $a_1,a_2,\\dots,a_n,0\\le a_i\\le n$，以及 $n$ 个整数 $w_1,w_2,\\dots,w_n$。称 $a_1,a_2,\\dots,a_n$ 的一个排列 $a_{p_1},a_{p_2},\\dots,a_{p_n}$ 为 $a_1,a_2,\\dots,a_n$ 的一个合法排列，当且仅当该排列满足：对于任意的 $k$ 和任意的 $j$，如果 $j\\le k$，那么 $a_{p_j}$ 不等于 $p_k$。（换句话说就是：对于任意的 $k$ 和任意的 $j$，如果 $p_k$ 等于 $a_{p_j}$，那么 $k<j$。）定义这个合法排列的权值为 $w_{p_1}+2w_{p_2}+\\dots+nw_{p_n}$。\n\n你需要求出在所有合法排列中的最大权值。如果不存在合法排列，输出 $-1$。 \n\n样例解释中给出了合法排列和非法排列的实例。", "inputFormat": "第一行一个整数 $n$。 \n\n接下来一行 $n$ 个整数，表示 $a_1,a_2,\\dots,a_n$。接下来一行 $n$ 个整数，表示 $w_1,w_2,\\dots,w_n$。", "outputFormat": "输出一个整数表示答案。", "hint": "### 【样例解释 1】\n对于 $a_1=0,a_2=1,a_3=1$，其排列有：\n- $a_1=0,a_2=1,a_3=1$，是合法排列，排列的权值是 $1\\times 5+2\\times 7+3\\times 3=28$；\n- $a_2=1,a_1=0,a_3=1$，是非法排列，因为 $a_{p_2}$ 等于 $p_2$；\n- $a_1=0,a_3=1,a_2=1$，是合法排列，排列的权值是 $1\\times 5+2\\times 3+3\\times 7=32$；\n- $a_3=1,a_1=0,a_2=1$，是非法排列，因为 $a_{p_1}$ 等于 $p_2$；\n- $a_2=1,a_3=1,a_1=0$，是非法排列，因为 $a_{p_1}$ 等于 $p_3$；\n- $a_3=1,a_2=1,a_1=0$，是非法排列，因为 $a_{p_1}$ 等于 $p_3$。\n\n因此该题输出最大权值 $32$。 \n### 【样例解释 2】 \n对于 $a_1=2,a_2=3,a_3=1$，其排列有：\n- $a_1=2,a_2=3,a_3=1$，是非法排列，因为 $a_{p_1}$ 等于 $p_2$；\n- $a_2=3,a_1=2,a_3=1$，是非法排列，因为 $a_{p_1}$ 等于 $p_3$； \n- $a_1=2,a_3=1,a_2=3$，是非法排列，因为 $a_{p_1}$ 等于 $p_3$；  \n- $a_3=1,a_1=2,a_2=3$，是非法排列，因为 $a_{p_2}$ 等于 $p_3$； \n- $a_2=3,a_3=1,a_1=2$，是非法排列，因为 $a_{p_2}$ 等于 $p_3$； \n- $a_3=1,a_2=3,a_1=2$，是非法排列，因为 $a_{p_1}$ 等于 $p_3$。\n\n因此该题没有合法排列。 \n\n### 【数据范围】 \n- 对于前 $20\\%$ 的数据，$1\\le n\\le 10$。\n- 对于前 $40\\%$ 的数据，$1\\le n\\le  15$。\n- 对于前 $60\\%$ 的数据，$1\\le n\\le 1000$。  \n- 对于前 $80\\%$ 的数据，$1\\le n\\le 10^5$。  \n- 对于 $100\\%$ 的数据，$1\\le n\\le 5\\times10^5$，$0\\le a_i\\le n$，$1\\le w_i\\le10^9$，所有 $w_i$ 的和不超过 $1.5×10^{13}$。", "locale": "zh-CN"}}}
{"pid": "P4438", "type": "P", "difficulty": 4, "samples": [["6 \n2 3 \n4 5 \n-1 -2 \n-3 -4 \n-5 -6 \n1 2 3 \n1 3 2 \n2 1 3 \n2 3 1 \n3 1 2 \n3 2 1", "54"], ["9 \n2 -2 \n3 -3 \n4 -4 \n5 -5 \n6 -6 \n7 -7 \n8 -8 \n-1 -9 \n1 60 1 \n1 60 1 \n1 60 1 \n1 60 1 \n1 60 1 \n1 60 1 \n1 60 1 \n1 60 1 \n1 60 1", "548"], ["12 \n2 4 \n5 3 \n-7 10 \n11 9 \n-1 6 \n8 7 \n-6 -10 \n-9 -4\n-12 -5 \n-2 -3 \n-8 -11 \n53 26 491 \n24 58 190 \n17 37 356 \n15 51 997 \n30 19 398 \n3 45 27 \n52 55 838 \n16 18 931 \n58 24 212 \n43 25 198 \n54 15 172 \n34 5 524", "5744902\n \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "2018", "各省省选", "安徽", "湖南", "深度优先搜索 DFS", "树形 DP"], "title": "[HNOI/AHOI2018] 道路", "background": null, "description": "W 国的交通呈一棵树的形状。W 国一共有 $n-1$ 个城市和 $n$ 个乡村，其中城市从 $1$ 到 $n-1$ 编号，乡村从 $1$ 到 $n$ 编号，且 $1$ 号城市是首都。道路都是单向的，本题中我们只考虑从乡村通往首都的道路网络。\n\n对于每一个城市，恰有一条公路和一条铁路通向这座城市。对于城市 $i$， 通向该城市的道路（公路或铁路）的起点，要么是一个乡村，要么是一个编号比 $i$ 大的城市。没有道路通向任何乡村。除了首都以外，从任何城市或乡村出发只有一条道路；首都没有往外的道路。从任何乡村出发，沿着唯一往外的道路走，总可以到达首都。\n\nW 国的国王小 W 获得了一笔资金，他决定用这笔资金来改善交通。由于资金有限，小 W 只能翻修 $n-1$ 条道路。小 W 决定对每个城市翻修恰好一条通向它的道路，即从公路和铁路中选择一条并进行翻修。小 W 希望从乡村通向城市可以尽可能地便利，于是根据人口调查的数据，小 W 对每个乡村制定了三个参数，编号为 $i$ 的乡村的三个参数是 $a_i$，$b_i$ 和 $c_i$。假设从编号为 $i$ 的乡村走到首都一共需要经过 $x$ 条未翻修的公路与 $y$ 条未翻修的铁路，那么该乡村的不便利值为：\n\n$$c_i \\cdot (a_i + x) \\cdot (b_i + y)$$\n\n在给定的翻修方案下，每个乡村的不便利值相加的和为该翻修方案的不便利值。 翻修 $n-1$ 条道路有很多方案，其中不便利值最小的方案称为最优翻修方案，小 W 自然希望找到最优翻修方案，请你帮助他求出这个最优翻修方案的不便利值。", "inputFormat": "第一行为正整数 $n$。 \n\n接下来 $n - 1$ 行，每行描述一个城市。其中第 $i$ 行包含两个数 $s_i,t_i$。$s_i$ 表示通向第 $i$ 座城市的公路的起点，$t_i$ 表示通向第 $i$ 座城市的铁路的起点。如果$s_i>0$，那么存在一条从第 $s_i$ 座城市通往第 $i$ 座城市的公路，否则存在一条从第 $-s_i$ 个乡村通往第 $i$ 座城市的公路；$t_i$ 类似地，如果 $t_i > 0$，那么存在一条从第 $t_i$ 座城市通往第 $i$ 座城市的铁路，否则存在一条从第 $-t_i$ 个乡村通往第 $i$ 座城市的铁路。 \n\n接下来 $n$ 行，每行描述一个乡村。其中第 $i$ 行包含三个数 $a_i,b_i,c_i$，其意义如题面所示。", "outputFormat": "输出一行一个整数，表示最优翻修方案的不便利值。", "hint": "【样例解释 1】 \n\n![](https://cdn.luogu.com.cn/upload/pic/17506.png)\n\n如图所示，我们分别用蓝色、黄色节点表示城市、乡村；用绿色、红色箭头分别表示 公路、铁路；用加粗箭头表示翻修的道路。 \n\n一种不便利值等于 $54$ 的方法是：翻修通往城市 $2$ 和城市 $5$ 的铁路，以及通往其他城市的 公路。用 $\\rightarrow$ 和 $\\Rightarrow$ 表示公路和铁路，用 $∗\\rightarrow$ 和 $∗\\Rightarrow$ 表示翻修的公路和铁路，那么： \n\n编号为 $1$ 的乡村到达首都的路线为：$-1 ∗\\rightarrow 3 \\Rightarrow 1$，经过 $0$ 条未翻修公路和 $1$ 条未翻修铁路，代价为 $3 \\times (1 + 0) \\times (2 + 1) = 9$；  \n\n编号为 $2$ 的乡村到达首都的路线为：$-2 \\Rightarrow 3 \\Rightarrow 1$，经过 $0$ 条未翻修公路和 $2$ 条未翻修铁路，代价为 $2 \\times (1 + 0) \\times (3 + 2) = 10$；  \n编号为 $3$ 的乡村到达首都的路线为：$-3 ∗\\rightarrow 4 \\rightarrow 2 ∗\\rightarrow 1$，经过 $1$ 条未翻修公路和 $0$ 条未翻修铁路，代价为 $3 \\times (2 + 1) \\times (1 + 0) = 9$；  \n\n编号为 $4$ 的乡村到达首都的路线为：$-4 \\Rightarrow 4 \\rightarrow 2 ∗\\rightarrow 1$，经过 $1$ 条未翻修公路和 $1$ 条未翻修铁路，代价为 $1 \\times (2 + 1) \\times (3 + 1) = 12$；\n\n编号为 $5$ 的乡村到达首都的路线为：$-5 \\rightarrow 5 ∗\\Rightarrow 2 ∗\\rightarrow 1$，经过 $1$ 条未翻修公路和 $0$ 条未翻修铁路，代价为 $2 \\times (3 + 1) \\times (1 + 0) = 8$；  \n\n编号为 $6$ 的乡村到达首都的路线为：$-6 ∗\\Rightarrow 5 ∗\\Rightarrow 2 ∗\\rightarrow 1$，经过 $0$ 条未翻修公路和 $0$ 条未翻修铁路，代价为 $1 \\times (3 + 0) \\times (2 + 0) = 6$；  \n\n总的不便利值为 $9 + 10 + 9 + 12 + 8 + 6 = 54$。可以证明这是本数据的最优解。 \n\n【样例解释 2】 \n\n在这个样例中，显然应该翻修所有公路。\n\n\n【数据范围】 \n一共 $20$ 组数据，编号为 $1 \\sim 20$。 \n对于编号 $\\le 4$ 的数据，$n \\le 20$；  \n对于编号为 $5 \\sim 8$ 的数据，$a_i,b_i,c_i \\le 5$，$n \\le 50$；  \n对于编号为 $9 \\sim 12$ 的数据，$n \\le 2000$；  \n对于所有的数据，$n \\le 20000$，$1 \\le a_i,b_i \\le 60$，$1 \\le c_i \\le 10^9$，$s_i,t_i$ 是 $[-n,-1] \\cup (i,n - 1]$ 内的整数，任意乡村可以通过不超过 $40$ 条道路到达首都。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI/AHOI2018] Roads", "background": "", "description": "The transportation network of Country W forms a tree. There are $n - 1$ cities and $n$ villages in total; cities are numbered $1$ to $n - 1$, villages are numbered $1$ to $n$, and city $1$ is the capital. All roads are one-way; in this problem we only consider the road network from villages towards the capital.\n\nFor each city, there is exactly one highway and one railway leading into this city. For city $i$, the starting point of a road (highway or railway) that leads to city $i$ is either a village, or a city whose index is greater than $i$. No roads lead into any village. Except for the capital, every city or village has exactly one outgoing road; the capital has no outgoing road. Starting from any village and following the unique outgoing road, you will eventually reach the capital.\n\nKing W of Country W has obtained some funds to improve transportation. Due to limited funds, he can renovate $n - 1$ roads. He will renovate exactly one incoming road for each city, i.e., for each city he chooses either its highway or its railway to renovate. To make travel from villages to the capital as convenient as possible, based on census data he sets three parameters for each village. For village $i$, the parameters are $a_i$, $b_i$, and $c_i$. Suppose that starting from village $i$ and going to the capital, you pass through $x$ unrenovated highways and $y$ unrenovated railways. Then the inconvenience value of this village is:\n$$c_i \\cdot (a_i + x) \\cdot (b_i + y)$$\n\nUnder a given renovation plan, the sum of inconvenience values over all villages is the inconvenience value of that plan. Among all ways to renovate $n - 1$ roads, the plan with the minimum total inconvenience is called the optimal renovation plan. King W wants this optimal plan. Please compute the total inconvenience of the optimal renovation plan.", "inputFormat": "The first line contains a positive integer $n$.\n\nThe next $n - 1$ lines each describe a city. The $i$-th of these lines contains two numbers $s_i, t_i$. Here $s_i$ is the starting point of the highway that leads to city $i$, and $t_i$ is the starting point of the railway that leads to city $i$. If $s_i > 0$, then there is a highway from city $s_i$ to city $i$; otherwise there is a highway from village $-s_i$ to city $i$. Similarly, if $t_i > 0$, then there is a railway from city $t_i$ to city $i$; otherwise there is a railway from village $-t_i$ to city $i$.\n\nThe next $n$ lines each describe a village. The $i$-th of these lines contains three numbers $a_i, b_i, c_i$, as defined above.", "outputFormat": "Output one line with a single integer: the total inconvenience of the optimal renovation plan.", "hint": "Sample Explanation 1.\n\n![](https://cdn.luogu.com.cn/upload/pic/17506.png)\n\nIn the figure, blue and yellow nodes denote cities and villages, respectively; green and red arrows denote highways and railways, respectively; bold arrows denote renovated roads.\n\nOne plan with total inconvenience equal to $54$ is: renovate the railways leading to city $2$ and city $5$, and renovate the highways leading to all other cities. Using $\\rightarrow$ and $\\Rightarrow$ to denote highway and railway, and $∗\\rightarrow$ and $∗\\Rightarrow$ to denote renovated highway and renovated railway, respectively, we have:\n\nThe route for village $1$ to reach the capital is: $-1 ∗\\rightarrow 3 \\Rightarrow 1$, passing $0$ unrenovated highways and $1$ unrenovated railway, with cost $3 \\times (1 + 0) \\times (2 + 1) = 9$.\n\nThe route for village $2$ to reach the capital is: $-2 \\Rightarrow 3 \\Rightarrow 1$, passing $0$ unrenovated highways and $2$ unrenovated railways, with cost $2 \\times (1 + 0) \\times (3 + 2) = 10$.\n\nThe route for village $3$ to reach the capital is: $-3 ∗\\rightarrow 4 \\rightarrow 2 ∗\\rightarrow 1$, passing $1$ unrenovated highway and $0$ unrenovated railways, with cost $3 \\times (2 + 1) \\times (1 + 0) = 9$.\n\nThe route for village $4$ to reach the capital is: $-4 \\Rightarrow 4 \\rightarrow 2 ∗\\rightarrow 1$, passing $1$ unrenovated highway and $1$ unrenovated railway, with cost $1 \\times (2 + 1) \\times (3 + 1) = 12$.\n\nThe route for village $5$ to reach the capital is: $-5 \\rightarrow 5 ∗\\Rightarrow 2 ∗\\rightarrow 1$, passing $1$ unrenovated highway and $0$ unrenovated railways, with cost $2 \\times (3 + 1) \\times (1 + 0) = 8$.\n\nThe route for village $6$ to reach the capital is: $-6 ∗\\Rightarrow 5 ∗\\Rightarrow 2 ∗\\rightarrow 1$, passing $0$ unrenovated highways and $0$ unrenovated railways, with cost $1 \\times (3 + 0) \\times (2 + 0) = 6$.\n\nThe total inconvenience is $9 + 10 + 9 + 12 + 8 + 6 = 54$. It can be proven that this is the optimal answer for this testdata.\n\nSample Explanation 2.\n\nIn this sample, it is obvious that all highways should be renovated.\n\nConstraints\n\n- There are in total $20$ sets of testdata, numbered $1$ to $20$.\n- For sets with index $\\le 4$, $n \\le 20$.\n- For sets with index $5 \\sim 8$, $a_i, b_i, c_i \\le 5$, $n \\le 50$.\n- For sets with index $9 \\sim 12$, $n \\le 2000$.\n- For all sets, $n \\le 20000$, $1 \\le a_i, b_i \\le 60$, $1 \\le c_i \\le 10^9$, $s_i, t_i$ are integers in $[-n, -1] \\cup (i, n - 1]$, and from any village the capital is reachable via no more than $40$ roads.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI/AHOI2018] 道路", "background": null, "description": "W 国的交通呈一棵树的形状。W 国一共有 $n-1$ 个城市和 $n$ 个乡村，其中城市从 $1$ 到 $n-1$ 编号，乡村从 $1$ 到 $n$ 编号，且 $1$ 号城市是首都。道路都是单向的，本题中我们只考虑从乡村通往首都的道路网络。\n\n对于每一个城市，恰有一条公路和一条铁路通向这座城市。对于城市 $i$， 通向该城市的道路（公路或铁路）的起点，要么是一个乡村，要么是一个编号比 $i$ 大的城市。没有道路通向任何乡村。除了首都以外，从任何城市或乡村出发只有一条道路；首都没有往外的道路。从任何乡村出发，沿着唯一往外的道路走，总可以到达首都。\n\nW 国的国王小 W 获得了一笔资金，他决定用这笔资金来改善交通。由于资金有限，小 W 只能翻修 $n-1$ 条道路。小 W 决定对每个城市翻修恰好一条通向它的道路，即从公路和铁路中选择一条并进行翻修。小 W 希望从乡村通向城市可以尽可能地便利，于是根据人口调查的数据，小 W 对每个乡村制定了三个参数，编号为 $i$ 的乡村的三个参数是 $a_i$，$b_i$ 和 $c_i$。假设从编号为 $i$ 的乡村走到首都一共需要经过 $x$ 条未翻修的公路与 $y$ 条未翻修的铁路，那么该乡村的不便利值为：\n\n$$c_i \\cdot (a_i + x) \\cdot (b_i + y)$$\n\n在给定的翻修方案下，每个乡村的不便利值相加的和为该翻修方案的不便利值。 翻修 $n-1$ 条道路有很多方案，其中不便利值最小的方案称为最优翻修方案，小 W 自然希望找到最优翻修方案，请你帮助他求出这个最优翻修方案的不便利值。", "inputFormat": "第一行为正整数 $n$。 \n\n接下来 $n - 1$ 行，每行描述一个城市。其中第 $i$ 行包含两个数 $s_i,t_i$。$s_i$ 表示通向第 $i$ 座城市的公路的起点，$t_i$ 表示通向第 $i$ 座城市的铁路的起点。如果$s_i>0$，那么存在一条从第 $s_i$ 座城市通往第 $i$ 座城市的公路，否则存在一条从第 $-s_i$ 个乡村通往第 $i$ 座城市的公路；$t_i$ 类似地，如果 $t_i > 0$，那么存在一条从第 $t_i$ 座城市通往第 $i$ 座城市的铁路，否则存在一条从第 $-t_i$ 个乡村通往第 $i$ 座城市的铁路。 \n\n接下来 $n$ 行，每行描述一个乡村。其中第 $i$ 行包含三个数 $a_i,b_i,c_i$，其意义如题面所示。", "outputFormat": "输出一行一个整数，表示最优翻修方案的不便利值。", "hint": "【样例解释 1】 \n\n![](https://cdn.luogu.com.cn/upload/pic/17506.png)\n\n如图所示，我们分别用蓝色、黄色节点表示城市、乡村；用绿色、红色箭头分别表示 公路、铁路；用加粗箭头表示翻修的道路。 \n\n一种不便利值等于 $54$ 的方法是：翻修通往城市 $2$ 和城市 $5$ 的铁路，以及通往其他城市的 公路。用 $\\rightarrow$ 和 $\\Rightarrow$ 表示公路和铁路，用 $∗\\rightarrow$ 和 $∗\\Rightarrow$ 表示翻修的公路和铁路，那么： \n\n编号为 $1$ 的乡村到达首都的路线为：$-1 ∗\\rightarrow 3 \\Rightarrow 1$，经过 $0$ 条未翻修公路和 $1$ 条未翻修铁路，代价为 $3 \\times (1 + 0) \\times (2 + 1) = 9$；  \n\n编号为 $2$ 的乡村到达首都的路线为：$-2 \\Rightarrow 3 \\Rightarrow 1$，经过 $0$ 条未翻修公路和 $2$ 条未翻修铁路，代价为 $2 \\times (1 + 0) \\times (3 + 2) = 10$；  \n编号为 $3$ 的乡村到达首都的路线为：$-3 ∗\\rightarrow 4 \\rightarrow 2 ∗\\rightarrow 1$，经过 $1$ 条未翻修公路和 $0$ 条未翻修铁路，代价为 $3 \\times (2 + 1) \\times (1 + 0) = 9$；  \n\n编号为 $4$ 的乡村到达首都的路线为：$-4 \\Rightarrow 4 \\rightarrow 2 ∗\\rightarrow 1$，经过 $1$ 条未翻修公路和 $1$ 条未翻修铁路，代价为 $1 \\times (2 + 1) \\times (3 + 1) = 12$；\n\n编号为 $5$ 的乡村到达首都的路线为：$-5 \\rightarrow 5 ∗\\Rightarrow 2 ∗\\rightarrow 1$，经过 $1$ 条未翻修公路和 $0$ 条未翻修铁路，代价为 $2 \\times (3 + 1) \\times (1 + 0) = 8$；  \n\n编号为 $6$ 的乡村到达首都的路线为：$-6 ∗\\Rightarrow 5 ∗\\Rightarrow 2 ∗\\rightarrow 1$，经过 $0$ 条未翻修公路和 $0$ 条未翻修铁路，代价为 $1 \\times (3 + 0) \\times (2 + 0) = 6$；  \n\n总的不便利值为 $9 + 10 + 9 + 12 + 8 + 6 = 54$。可以证明这是本数据的最优解。 \n\n【样例解释 2】 \n\n在这个样例中，显然应该翻修所有公路。\n\n\n【数据范围】 \n一共 $20$ 组数据，编号为 $1 \\sim 20$。 \n对于编号 $\\le 4$ 的数据，$n \\le 20$；  \n对于编号为 $5 \\sim 8$ 的数据，$a_i,b_i,c_i \\le 5$，$n \\le 50$；  \n对于编号为 $9 \\sim 12$ 的数据，$n \\le 2000$；  \n对于所有的数据，$n \\le 20000$，$1 \\le a_i,b_i \\le 60$，$1 \\le c_i \\le 10^9$，$s_i,t_i$ 是 $[-n,-1] \\cup (i,n - 1]$ 内的整数，任意乡村可以通过不超过 $40$ 条道路到达首都。", "locale": "zh-CN"}}}
