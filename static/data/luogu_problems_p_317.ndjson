{"pid": "P7420", "type": "P", "difficulty": 5, "samples": [["noinoinonoinoiionoinoinoionoi\nnoi", "10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["字符串", "动态规划 DP", "O2优化"], "title": "「PMOI-2」拆分", "background": "### 如果您不看样例解释中的提示，那么您极可能做不出来！\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/n87yncfw.png)", "description": "lhm 手中有一个字符串 $a$ 和它的子串 $b$，现你需要拆分字符串 $a$。\n\n设 $c(s,b)$ 表示从字符串 $s$ 中选出一些互不重叠的、与 $b$ 相同的子串的最大子串数量。\n\n若将 $a$ 拆分为 $k$ 组，第 $i$ 组记为 $p_i$，你需要保证：\n- $k \\geq 2$，\n- $c(p_{i+1},b)>c(p_i,b)\\ (i \\in[1,k-1])$，\n- $c(p_1,b)\\geq 1$。\n\n两种拆分方案不同当且仅当拆分出的组数不等或 $\\exist i$，对应的 $c(p_i,b)$ 不等。\n\n求不同的拆分方案总数，答案对 $899678209$ 取模。", "inputFormat": "输入数据共两行。\n\n第一行一个字符串 $a$，含义如题所示。\n\n第二行一个字符串 $b$，含义如题所示。", "outputFormat": "输出数据共一行。\n\n一行一个整数，表示拆分的方案数对 $899678209$ 取模的结果。", "hint": "【样例解释】\n\n拆分的方式分别为：\n\n`noi noinonoi noiionoinoinoionoi`，个数分别为 $1,2,5$。\n\n`noi noinonoin oiionoinoinoionoi`，个数分别为 $1,2,4$。\n\n`noino inonoinoiion oinoinoionoi`，个数分别为 $1,2,3$。\n\n`noi noinonoinoi ionoinoinoionoi`，个数分别为 $1,3,4$。\n\n`noi noinonoinoiionoinoinoionoi`，个数分别为 $1,7$。\n\n`noinoi nonoinoiionoinoinoionoi`，个数分别为 $2,6$。\n\n`noinoinonoi noiionoinoinoionoi`，个数分别为 $3,5$。\n\n`noin oinonoinoiionoinoinoionoi`，个数分别为 $1,6$。\n\n`noinoinono inoiionoinoinoionoi`，个数分别为 $2,5$。\n\n`noinoinonoin oiionoinoinoionoi`，个数分别为 $3,4$。\n\n**提示：样例解释足以说明可以拆分子串**。\n\n【数据规模与约定】\n\n请仔细阅读本栏。\n\n**本题采用捆绑测试。**  \n\n设 $n = c(a,b)$，$|a|=l_1$，$|b|=l_2$。  \n\n| Subtask | 特殊性质 | 空间限制 | 分值 | \n| :----------: | :----------: | :----------: | :----------: |\n| 1 | $l_1\\leq 30$ | 256MiB | 9 |\n| 2 | $n \\le 300$ | 256MiB | 11 |\n| 3 | $n \\le 2000$ | 256MiB | 17 |\n| 4 | $n \\le 25000$ | 256MiB | 37 |\n| 5 | 无 | 64MiB | 26 |\n\n对于 $100\\%$ 的数据，$0\\le n\\le2\\times10^5$，$2\\le l_2\\le l_1\\le10^6$，$b_1 \\neq b_{l_2}$，$a$ 和 $b$ 只包含小写字母。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「PMOI-2」拆分", "background": "### 如果您不看样例解释中的提示，那么您极可能做不出来！\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/n87yncfw.png)", "description": "lhm 手中有一个字符串 $a$ 和它的子串 $b$，现你需要拆分字符串 $a$。\n\n设 $c(s,b)$ 表示从字符串 $s$ 中选出一些互不重叠的、与 $b$ 相同的子串的最大子串数量。\n\n若将 $a$ 拆分为 $k$ 组，第 $i$ 组记为 $p_i$，你需要保证：\n- $k \\geq 2$，\n- $c(p_{i+1},b)>c(p_i,b)\\ (i \\in[1,k-1])$，\n- $c(p_1,b)\\geq 1$。\n\n两种拆分方案不同当且仅当拆分出的组数不等或 $\\exist i$，对应的 $c(p_i,b)$ 不等。\n\n求不同的拆分方案总数，答案对 $899678209$ 取模。", "inputFormat": "输入数据共两行。\n\n第一行一个字符串 $a$，含义如题所示。\n\n第二行一个字符串 $b$，含义如题所示。", "outputFormat": "输出数据共一行。\n\n一行一个整数，表示拆分的方案数对 $899678209$ 取模的结果。", "hint": "【样例解释】\n\n拆分的方式分别为：\n\n`noi noinonoi noiionoinoinoionoi`，个数分别为 $1,2,5$。\n\n`noi noinonoin oiionoinoinoionoi`，个数分别为 $1,2,4$。\n\n`noino inonoinoiion oinoinoionoi`，个数分别为 $1,2,3$。\n\n`noi noinonoinoi ionoinoinoionoi`，个数分别为 $1,3,4$。\n\n`noi noinonoinoiionoinoinoionoi`，个数分别为 $1,7$。\n\n`noinoi nonoinoiionoinoinoionoi`，个数分别为 $2,6$。\n\n`noinoinonoi noiionoinoinoionoi`，个数分别为 $3,5$。\n\n`noin oinonoinoiionoinoinoionoi`，个数分别为 $1,6$。\n\n`noinoinono inoiionoinoinoionoi`，个数分别为 $2,5$。\n\n`noinoinonoin oiionoinoinoionoi`，个数分别为 $3,4$。\n\n**提示：样例解释足以说明可以拆分子串**。\n\n【数据规模与约定】\n\n请仔细阅读本栏。\n\n**本题采用捆绑测试。**  \n\n设 $n = c(a,b)$，$|a|=l_1$，$|b|=l_2$。  \n\n| Subtask | 特殊性质 | 空间限制 | 分值 | \n| :----------: | :----------: | :----------: | :----------: |\n| 1 | $l_1\\leq 30$ | 256MiB | 9 |\n| 2 | $n \\le 300$ | 256MiB | 11 |\n| 3 | $n \\le 2000$ | 256MiB | 17 |\n| 4 | $n \\le 25000$ | 256MiB | 37 |\n| 5 | 无 | 64MiB | 26 |\n\n对于 $100\\%$ 的数据，$0\\le n\\le2\\times10^5$，$2\\le l_2\\le l_1\\le10^6$，$b_1 \\neq b_{l_2}$，$a$ 和 $b$ 只包含小写字母。", "locale": "zh-CN"}}}
{"pid": "P7421", "type": "P", "difficulty": 5, "samples": [["3\n1 5 2", "2"], ["5\n-2 3 2 5 3", "15"]], "limits": {"time": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "动态规划优化"], "title": "「PMOI-2」子序列", "background": "看到这个时限，大家不必恐慌，本题不卡常。", "description": "给你一个长度为 $n$ 的序列 $a_i$（**下标从 $1$ 开始**），你需要选出一个 $\\{1,2,3,\\cdots,n\\}$ 的**任意长度非空**的子序列 $p$，设 $p$ 的长度为 $l$，定义 $a_0=p(0)=a_{n+1}=0,p(l+1)=n+1$，你需要最大化：\n\n$$\\sum_{i=0}^{l}(a_{p(i+1)}-a_{p(i)})(p(l-i+1)-p(l-i))$$\n\n求出这个最大值。\n\n若 $a$ 是 $b$ 的子序列，则从 $b$ 中删除 $0$ 或多个元素，**按照原顺序**可以得到 $a$，比如 $\\{1,4\\}$ 是 $\\{1,2,3,4\\}$ 的子序列，$\\{3,1,5\\}$ 是 $\\{3,1,5\\}$ 的子序列，$\\{1,2\\}$ 不是 $\\{3,2,1\\}$ 的子序列。", "inputFormat": "第一行输入一个正整数 $n$，表示 $a$ 的长度。\n\n第二行输入 $n$ 个整数，第 $i$ 个数表示 $a_i$。", "outputFormat": "输出一个整数，表示 $\\sum_{i=0}^{l}(a_{p(i+1)}-a_{p(i)})(p(l-i+1)-p(l-i))$ 的最大值。", "hint": "【样例解释】\n\n对于第一个样例，选择 $\\{1\\}$ 可以得到最大结果 $(1-0)\\times(4-1)+(0-1)\\times(1-0)=2$。\n\n对于第二个样例，选择 $\\{1,5\\}$ 可以得到最大结果 $(-2-0)\\times(6-5)+[3-(-2)]\\times(5-1)+(0-3)\\times(1-0)=15$。\n\n【数据范围】\n\n对于 $20\\%$ 的数据，$n\\le20$，$0\\le a_i\\le10^3$；\n\n对于 $50\\%$ 的数据，$n\\le80$；\n\n对于 $100\\%$ 的数据，$1\\le n\\le300$，$-10^9\\le a_i\\le10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「PMOI-2」子序列", "background": "看到这个时限，大家不必恐慌，本题不卡常。", "description": "给你一个长度为 $n$ 的序列 $a_i$（**下标从 $1$ 开始**），你需要选出一个 $\\{1,2,3,\\cdots,n\\}$ 的**任意长度非空**的子序列 $p$，设 $p$ 的长度为 $l$，定义 $a_0=p(0)=a_{n+1}=0,p(l+1)=n+1$，你需要最大化：\n\n$$\\sum_{i=0}^{l}(a_{p(i+1)}-a_{p(i)})(p(l-i+1)-p(l-i))$$\n\n求出这个最大值。\n\n若 $a$ 是 $b$ 的子序列，则从 $b$ 中删除 $0$ 或多个元素，**按照原顺序**可以得到 $a$，比如 $\\{1,4\\}$ 是 $\\{1,2,3,4\\}$ 的子序列，$\\{3,1,5\\}$ 是 $\\{3,1,5\\}$ 的子序列，$\\{1,2\\}$ 不是 $\\{3,2,1\\}$ 的子序列。", "inputFormat": "第一行输入一个正整数 $n$，表示 $a$ 的长度。\n\n第二行输入 $n$ 个整数，第 $i$ 个数表示 $a_i$。", "outputFormat": "输出一个整数，表示 $\\sum_{i=0}^{l}(a_{p(i+1)}-a_{p(i)})(p(l-i+1)-p(l-i))$ 的最大值。", "hint": "【样例解释】\n\n对于第一个样例，选择 $\\{1\\}$ 可以得到最大结果 $(1-0)\\times(4-1)+(0-1)\\times(1-0)=2$。\n\n对于第二个样例，选择 $\\{1,5\\}$ 可以得到最大结果 $(-2-0)\\times(6-5)+[3-(-2)]\\times(5-1)+(0-3)\\times(1-0)=15$。\n\n【数据范围】\n\n对于 $20\\%$ 的数据，$n\\le20$，$0\\le a_i\\le10^3$；\n\n对于 $50\\%$ 的数据，$n\\le80$；\n\n对于 $100\\%$ 的数据，$1\\le n\\le300$，$-10^9\\le a_i\\le10^9$。", "locale": "zh-CN"}}}
{"pid": "P7422", "type": "P", "difficulty": 6, "samples": [["7 7 2\n1 2 3 3 1 1 2\n1 2\n2 3\n2 4\n3 4\n3 5\n3 6\n4 7", "12"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "线段树", "O2优化", "强连通分量", "虚树"], "title": "「PMOI-2」城市", "background": "", "description": "P 国有 $N$ 座城市和 $M$ 条无向道路，其中 $1$ 号城市是首都，且任意两座城市都能通过道路互相到达。\n\n现在 P 国要在首都召开 ION。为了建设比赛场地，每个城市都要向首都提供原材料，其中第 $i$ 座城市可以提供类型为 $c_i$ 的原材料。每座城市都会有货车从该城市出发，**沿简单路径**前往首都。如果从城市 $A$ 出发的货车必须经过城市 $B$ ，那么我们称城市 $B$ 在城市 $A$ 到首都的必经之路上。如果对于城市 $A,B,C$，从 $B$ 到 $A$ 的**任意简单路径**与 $C$ 到 $A$ 的**任意简单路径**没有公共边，那么我们称城市 $B$ 和城市 $C$ 关于城市 $A$ 互不影响。\n\n记 $f(A,k)$ 为满足下列所有条件的 $k$ 元集合 $\\{B_1,B_2,\\cdots B_k\\}$ 的个数：\n\n1. 对于任意 $1\\leq i \\leq k$ 满足 $A\\neq B_i$，**城市 $A$ 在城市 $B_i$ 到首都的必经之路上**且城市 $B_i$ 供应的材料与城市 $A$ **不同**。\n\n2. 对于任意 $1\\leq i < j \\leq k$ 满足 **$B_i$ 与 $B_j$ 关于 $A$ 互不影响**，且 $B_i$ 和 $B_j$ 供应的原材料**相同**。\n\n定义举办 ION 的吸引力为$\\sum_{i=1}^N\\sum_{k=1}^Kf(i,k)$，其中 $K$ 是给定的常数。\n\n现在，你作为 P 国的首脑，你想要知道这次 ION 的吸引力。\n\n**由于答案可能很大，所以请将答案对 $998244353$ 取模**。", "inputFormat": "第一行三个整数 $N,M,K$。\n\n第二行 $N$ 个整数，第 $i$ 个数第 $i$ 座城市供应的原材料类型 $c_i$。\n\n接下来 $M$ 行，每行两个整数 $u,v$ ，表示 $P$ 国的一条道路。保证**没有重边，没有自环**。（$1\\leq u, v \\leq N, u\\neq v$）", "outputFormat": "一行一个整数表示答案。", "hint": "【样例解释】\n\n样例中 P 国的地图如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/vte597p4.png)\n\n下表中，第 $i$ 行第 $j$ 列表示 $f(i,j)$。\n\n| $4$ | $0$ | $0$ | $0$ |\n| -----------: | -----------: | -----------: | -----------:\n| $4$ | $0$ | $0$ | $0$ |\n| $2$ | $1$ | $0$ | $0$ |\n| $1$ | $0$ | $0$ | $0$ |\n\n所以吸引力为 $4+4+2+1+1=12$。\n\n【数据范围】\n\n**本题采用捆绑测试**。\n\n- Subtask1（10pts）：$N,K \\le 8$；\n- Subtask2（10pts）：$K=1$；\n- Subtask3（15pts）：$K=2$；\n- Subtask4（15pts）：保证图的形态为一棵树；\n- Subtask5（15pts）：$N \\le 2000$；\n- Subtask6（15pts）：$N \\le 4\\times 10^4$；\n- Subtask7（20pts）：无特殊限制。\n\n对于 $100\\%$ 的数据满足，$1\\leq N\\leq 5\\times 10^5$， $1\\leq M \\leq \\min(10^6,\\frac{N\\times(N-1)}{2})$，$1 \\le K \\le 20$，$1 \\le c_i \\le 10^9$。\n\n**温馨提示**：输入量较大，请使用较快的读入方式。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「PMOI-2」城市", "background": "", "description": "P 国有 $N$ 座城市和 $M$ 条无向道路，其中 $1$ 号城市是首都，且任意两座城市都能通过道路互相到达。\n\n现在 P 国要在首都召开 ION。为了建设比赛场地，每个城市都要向首都提供原材料，其中第 $i$ 座城市可以提供类型为 $c_i$ 的原材料。每座城市都会有货车从该城市出发，**沿简单路径**前往首都。如果从城市 $A$ 出发的货车必须经过城市 $B$ ，那么我们称城市 $B$ 在城市 $A$ 到首都的必经之路上。如果对于城市 $A,B,C$，从 $B$ 到 $A$ 的**任意简单路径**与 $C$ 到 $A$ 的**任意简单路径**没有公共边，那么我们称城市 $B$ 和城市 $C$ 关于城市 $A$ 互不影响。\n\n记 $f(A,k)$ 为满足下列所有条件的 $k$ 元集合 $\\{B_1,B_2,\\cdots B_k\\}$ 的个数：\n\n1. 对于任意 $1\\leq i \\leq k$ 满足 $A\\neq B_i$，**城市 $A$ 在城市 $B_i$ 到首都的必经之路上**且城市 $B_i$ 供应的材料与城市 $A$ **不同**。\n\n2. 对于任意 $1\\leq i < j \\leq k$ 满足 **$B_i$ 与 $B_j$ 关于 $A$ 互不影响**，且 $B_i$ 和 $B_j$ 供应的原材料**相同**。\n\n定义举办 ION 的吸引力为$\\sum_{i=1}^N\\sum_{k=1}^Kf(i,k)$，其中 $K$ 是给定的常数。\n\n现在，你作为 P 国的首脑，你想要知道这次 ION 的吸引力。\n\n**由于答案可能很大，所以请将答案对 $998244353$ 取模**。", "inputFormat": "第一行三个整数 $N,M,K$。\n\n第二行 $N$ 个整数，第 $i$ 个数第 $i$ 座城市供应的原材料类型 $c_i$。\n\n接下来 $M$ 行，每行两个整数 $u,v$ ，表示 $P$ 国的一条道路。保证**没有重边，没有自环**。（$1\\leq u, v \\leq N, u\\neq v$）", "outputFormat": "一行一个整数表示答案。", "hint": "【样例解释】\n\n样例中 P 国的地图如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/vte597p4.png)\n\n下表中，第 $i$ 行第 $j$ 列表示 $f(i,j)$。\n\n| $4$ | $0$ | $0$ | $0$ |\n| -----------: | -----------: | -----------: | -----------:\n| $4$ | $0$ | $0$ | $0$ |\n| $2$ | $1$ | $0$ | $0$ |\n| $1$ | $0$ | $0$ | $0$ |\n\n所以吸引力为 $4+4+2+1+1=12$。\n\n【数据范围】\n\n**本题采用捆绑测试**。\n\n- Subtask1（10pts）：$N,K \\le 8$；\n- Subtask2（10pts）：$K=1$；\n- Subtask3（15pts）：$K=2$；\n- Subtask4（15pts）：保证图的形态为一棵树；\n- Subtask5（15pts）：$N \\le 2000$；\n- Subtask6（15pts）：$N \\le 4\\times 10^4$；\n- Subtask7（20pts）：无特殊限制。\n\n对于 $100\\%$ 的数据满足，$1\\leq N\\leq 5\\times 10^5$， $1\\leq M \\leq \\min(10^6,\\frac{N\\times(N-1)}{2})$，$1 \\le K \\le 20$，$1 \\le c_i \\le 10^9$。\n\n**温馨提示**：输入量较大，请使用较快的读入方式。\n", "locale": "zh-CN"}}}
{"pid": "P7423", "type": "P", "difficulty": 6, "samples": [["3 2", "623902740"], ["5 3", "887328630"], ["80 233", "913763047"], ["114514 19260817", "850727003"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "O2优化", "生成函数", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "「PMOI-2」简单构造题", "background": "", "description": "某次模拟赛中，NaCly\\_Fish 遇见这样一道题：\n****\n定义一个长度为 $n$ 的序列 $A$ 的权值为：\n\n$$\\sum_{l=1}^n\\sum_{r=l}^n f_A(l,r)$$\n其中 $f_A(l,r)$ 就是在 $A$ 的区间 $[l,r]$ 中，「所有**在该区间内出现过的**元素出现次数的乘积」再乘上「区间内所有元素的乘积」。  \n\n要求构造一个长为 $n$ 的序列，其中每个元素都是 $[1,m]$ 中的整数，最大化其权值。\n****\n她并不会，只好均匀随机 $n$ 个 $[1,m]$ 中的整数组成一个数列，然后输出其权值。\n\n当然，她的这份程序一分都没拿到；但她想知道，生成出的序列期望权值是多少。\n\n为了防止精度问题，答案需要对 $998244353$ 取模。", "inputFormat": "一行两个正整数 $n,m$。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "【样例一解释】  \n\n显然有 $8$ 种可能的序列：  \n$[1,1,1],[1,1,2],[1,2,1],[1,2,2],[2,1,1],[2,1,2],[2,2,1],[2,2,2]$。\n\n权值分别为 $10,12,12,23,12,17,23,46$，期望值就是 $\\frac{155}{8}$。\n\n【样例二解释】\n\n期望值是 $\\frac{76842}{243}$。\n\n【数据范围】  \n\n**本题采用捆绑测试**。\n\n- Subtask 1（5 pts）：$1\\le n,m \\le 8$；  \n- Subtask 2（7 pts）：$1\\le n,m \\le 100$；  \n- Subtask 3（11 pts）：$1 \\le n,m \\le 400$； \n- Subtask 4（13 pts）：$1\\le n,m \\le 5000$；\n- Subtask 5（25 pts）：$1\\le n \\le 5000$；\n- Subtask 6（39 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据满足，$1\\le n \\le 2 \\times 10^5$，$1\\le m \\le 10^8$。\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「PMOI-2」简单构造题", "background": "", "description": "某次模拟赛中，NaCly\\_Fish 遇见这样一道题：\n****\n定义一个长度为 $n$ 的序列 $A$ 的权值为：\n\n$$\\sum_{l=1}^n\\sum_{r=l}^n f_A(l,r)$$\n其中 $f_A(l,r)$ 就是在 $A$ 的区间 $[l,r]$ 中，「所有**在该区间内出现过的**元素出现次数的乘积」再乘上「区间内所有元素的乘积」。  \n\n要求构造一个长为 $n$ 的序列，其中每个元素都是 $[1,m]$ 中的整数，最大化其权值。\n****\n她并不会，只好均匀随机 $n$ 个 $[1,m]$ 中的整数组成一个数列，然后输出其权值。\n\n当然，她的这份程序一分都没拿到；但她想知道，生成出的序列期望权值是多少。\n\n为了防止精度问题，答案需要对 $998244353$ 取模。", "inputFormat": "一行两个正整数 $n,m$。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "【样例一解释】  \n\n显然有 $8$ 种可能的序列：  \n$[1,1,1],[1,1,2],[1,2,1],[1,2,2],[2,1,1],[2,1,2],[2,2,1],[2,2,2]$。\n\n权值分别为 $10,12,12,23,12,17,23,46$，期望值就是 $\\frac{155}{8}$。\n\n【样例二解释】\n\n期望值是 $\\frac{76842}{243}$。\n\n【数据范围】  \n\n**本题采用捆绑测试**。\n\n- Subtask 1（5 pts）：$1\\le n,m \\le 8$；  \n- Subtask 2（7 pts）：$1\\le n,m \\le 100$；  \n- Subtask 3（11 pts）：$1 \\le n,m \\le 400$； \n- Subtask 4（13 pts）：$1\\le n,m \\le 5000$；\n- Subtask 5（25 pts）：$1\\le n \\le 5000$；\n- Subtask 6（39 pts）：无特殊限制。\n\n对于 $100\\%$ 的数据满足，$1\\le n \\le 2 \\times 10^5$，$1\\le m \\le 10^8$。\n\n", "locale": "zh-CN"}}}
{"pid": "P7424", "type": "P", "difficulty": 5, "samples": [["3 2\n1 3 1\n2 4 2\n3 4 1\n2\n3", "1\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "树状数组", "可持久化线段树", "可持久化", "分块", "整体二分", "THUPC"], "title": "[THUPC 2017] 天天爱射击", "background": "", "description": "小 C 爱上了一款名字叫做《天天爱射击》的游戏。如图所示，这个游戏有一些平行于 $x$ 轴的木板。现在有一些子弹，按顺序沿着 $y$ 轴方向向这些木板射去。第 $i$ 块木板被 $S_i$ 个子弹贯穿以后，就会碎掉消失。一个子弹可以贯穿其弹道上的全部木板，特别的，如果一个子弹触碰到木板的边缘，也视为贯穿木板。\n\n小 C 现在知道了游戏中 $n$ 块木板位置，以及知道了 $m$ 个子弹射击位置。现在问你每个子弹射出去以后，有多少木板会碎掉？", "inputFormat": "从标准输入读入数据。\n\n第一行两个整数 $n$ 和 $m$，表示木板数量和子弹数量。其中 $1\\le n,m\\le 2\\times 10^5$。\n\n接下来 $n$ 行，每行三个整数 $x_1,x_2,s$，表示每块木板的左端点 $x$ 坐标、右端点 $x$ 坐标，以及贯穿多少次会碎掉。其中保证 $1\\le x_1\\le x_2\\le2\\times 10^5,1\\le s\\le 2\\times 10^5$。\n\n接下来 $m$ 行，每行一个整数 ，表示每个子弹的 $x$ 坐标。子弹按照发射顺序给出。其中保证 $1\\le x\\le2\\times 10^5$。", "outputFormat": "输出到标准输出。\n\n$m$ 行，每行一个整数。表示每颗子弹射出去后，有多少木板碎掉。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/ocqlbnl3.png)\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。\n\n$\\text{upd}2021.7.6$：感谢 @[jiangbowen](https://www.luogu.com.cn/user/366807) 提供的一组 hack 数据，不计分，但若不通过 hack 数据则不算通过此题。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2017] 天天爱射击", "background": "", "description": "小 C 爱上了一款名字叫做《天天爱射击》的游戏。如图所示，这个游戏有一些平行于 $x$ 轴的木板。现在有一些子弹，按顺序沿着 $y$ 轴方向向这些木板射去。第 $i$ 块木板被 $S_i$ 个子弹贯穿以后，就会碎掉消失。一个子弹可以贯穿其弹道上的全部木板，特别的，如果一个子弹触碰到木板的边缘，也视为贯穿木板。\n\n小 C 现在知道了游戏中 $n$ 块木板位置，以及知道了 $m$ 个子弹射击位置。现在问你每个子弹射出去以后，有多少木板会碎掉？", "inputFormat": "从标准输入读入数据。\n\n第一行两个整数 $n$ 和 $m$，表示木板数量和子弹数量。其中 $1\\le n,m\\le 2\\times 10^5$。\n\n接下来 $n$ 行，每行三个整数 $x_1,x_2,s$，表示每块木板的左端点 $x$ 坐标、右端点 $x$ 坐标，以及贯穿多少次会碎掉。其中保证 $1\\le x_1\\le x_2\\le2\\times 10^5,1\\le s\\le 2\\times 10^5$。\n\n接下来 $m$ 行，每行一个整数 ，表示每个子弹的 $x$ 坐标。子弹按照发射顺序给出。其中保证 $1\\le x\\le2\\times 10^5$。", "outputFormat": "输出到标准输出。\n\n$m$ 行，每行一个整数。表示每颗子弹射出去后，有多少木板碎掉。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/ocqlbnl3.png)\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。\n\n$\\text{upd}2021.7.6$：感谢 @[jiangbowen](https://www.luogu.com.cn/user/366807) 提供的一组 hack 数据，不计分，但若不通过 hack 数据则不算通过此题。", "locale": "zh-CN"}}}
{"pid": "P7425", "type": "P", "difficulty": 6, "samples": [["2\n3 1 1\n0.5\n1 1 5\n1 1 5\n1 1 5\n6 2 2\n0.5\n4 1 4\n4 2 7\n8 4 8\n8 4 8\n10 5 9\n1 7 9", "impossible\n7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "图论建模", "费用流", "THUPC"], "title": "[THUPC 2017] 机场", "background": "", "description": "飞机场有 $a+b$ 个停机位，其中 $a$ 个停机位有登机桥连接飞机和候机厅，乘客可以通过登机桥直接由候机厅登上飞机；另外 $b$ 个停机位没有登机桥和候机厅相连，所以乘客登机需要先搭乘摆渡车再登机。\n\n毫无疑问，搭乘摆渡车的体验是非常差的，所以每位搭乘摆渡车的乘客都会产生不愉快度。\n\n现在，给定每架飞机的乘客数量，登机时间和起飞时间；飞机需要在登机时间点选择一个空闲的停机位，在这个时间点内所有乘客会完成登机，然后飞机会一直停在该停机位，直到起飞时间；\n\n若某飞机在时刻 $x$ 起飞，则在时刻 $x$ 该飞机所在的停机位是空闲的。\n\n飞机场的管理层希望能够尽量减少乘客的不愉快度，为此飞机在登机时间到起飞时间之间，可以切换停机位；\n\n假设某飞机从 $x$ 时间开始由停机位 A 切换到停机位 B，那么停机位 A 在 $x+1$ 时间是空闲的。能进行这样的切换当且仅当停机位 B 在 $x+1$ 时间是空闲的。", "inputFormat": "输入有多组数据，第一行一个正整数 $T$ 表示数据组数；对于每组数据：\n\n第一行输入三个非负整数 $n,a,b$，分别表示飞机数量、有登机桥的停机位数量、没有登机桥的停机位数量；\n\n第二行一个浮点数 $p$，输入最多保留小数点后两位；\n\n接下来 $n$ 行，每行三个正整数 $x,s,t$，描述一架飞机的乘客数量、登机时间和起飞时间。", "outputFormat": "对于每组数据，输出一行一个整数，表示最小的不愉快度。\n\n如果无法安排一个合理的方案使得所有飞机都完成登机，则输出 `impossible`。", "hint": "题目中貌似没有给出明确的不愉快度的计算方法，据样例解释推测是不愉快度=所有乘坐摆渡车的人数$+p\\times$ 每次切换停机位的飞机上的人数向下取整。\n#### 数据范围\n$1\\le T\\le 8,1\\le n\\le 200,0\\le p\\le1,1\\le x\\le 10^5,1\\le s\\le t\\le10^9$\n#### 样例解释\n飞机从 $1$ 开始编号\n\n在时刻 $1$，$1$ 号飞机安排到登机桥 A，乘客开始登机；目前 $1$ 号飞机在登机桥 A。\n\n在时刻 $2$，$2$ 号飞机安排到登机桥 B，乘客开始登机；目前 $1$ 号飞机在登机桥 A，$2$ 号飞机在登机桥 B。\n\n在时刻 $3$，$2$ 号飞机切换到摆渡车 A，此时登机桥 B 尚不可用。\n\n在时刻 $4$，$1$ 号飞机起飞，$2$ 号飞机到达摆渡车 A， 号飞机安排到登机桥 A，$3$ 号飞机安排到登机桥 B，$4$ 号和 $3$ 号的乘客开始登机，登机完成之后 $4$ 号飞机切换到摆渡车 B，此时登机桥 A 和登机桥 B 都不空闲。\n\n在时刻 $5$，$3$ 号飞机到达摆渡车 B，登机桥 A 变为可用，$5$ 号飞机安排到登机桥 A，开始登机；目前 $5$ 号——登机桥 A，$4$ 号——登机桥 B，$3$ 号——摆渡车 B，$2$ 号——摆渡车 A。\n\n在时刻 $7$，$2$ 号飞机起飞，$6$ 号飞机安排到摆渡车 A。\n\n不愉快度为 $7=1$（$6$ 号飞机乘客乘摆渡车）$+4\\times 0.5$（$2$ 号飞机切换停机位）$+8\\times 0.5$（$3$ 号飞机切换停机位）\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2017] 机场", "background": "", "description": "飞机场有 $a+b$ 个停机位，其中 $a$ 个停机位有登机桥连接飞机和候机厅，乘客可以通过登机桥直接由候机厅登上飞机；另外 $b$ 个停机位没有登机桥和候机厅相连，所以乘客登机需要先搭乘摆渡车再登机。\n\n毫无疑问，搭乘摆渡车的体验是非常差的，所以每位搭乘摆渡车的乘客都会产生不愉快度。\n\n现在，给定每架飞机的乘客数量，登机时间和起飞时间；飞机需要在登机时间点选择一个空闲的停机位，在这个时间点内所有乘客会完成登机，然后飞机会一直停在该停机位，直到起飞时间；\n\n若某飞机在时刻 $x$ 起飞，则在时刻 $x$ 该飞机所在的停机位是空闲的。\n\n飞机场的管理层希望能够尽量减少乘客的不愉快度，为此飞机在登机时间到起飞时间之间，可以切换停机位；\n\n假设某飞机从 $x$ 时间开始由停机位 A 切换到停机位 B，那么停机位 A 在 $x+1$ 时间是空闲的。能进行这样的切换当且仅当停机位 B 在 $x+1$ 时间是空闲的。", "inputFormat": "输入有多组数据，第一行一个正整数 $T$ 表示数据组数；对于每组数据：\n\n第一行输入三个非负整数 $n,a,b$，分别表示飞机数量、有登机桥的停机位数量、没有登机桥的停机位数量；\n\n第二行一个浮点数 $p$，输入最多保留小数点后两位；\n\n接下来 $n$ 行，每行三个正整数 $x,s,t$，描述一架飞机的乘客数量、登机时间和起飞时间。", "outputFormat": "对于每组数据，输出一行一个整数，表示最小的不愉快度。\n\n如果无法安排一个合理的方案使得所有飞机都完成登机，则输出 `impossible`。", "hint": "题目中貌似没有给出明确的不愉快度的计算方法，据样例解释推测是不愉快度=所有乘坐摆渡车的人数$+p\\times$ 每次切换停机位的飞机上的人数向下取整。\n#### 数据范围\n$1\\le T\\le 8,1\\le n\\le 200,0\\le p\\le1,1\\le x\\le 10^5,1\\le s\\le t\\le10^9$\n#### 样例解释\n飞机从 $1$ 开始编号\n\n在时刻 $1$，$1$ 号飞机安排到登机桥 A，乘客开始登机；目前 $1$ 号飞机在登机桥 A。\n\n在时刻 $2$，$2$ 号飞机安排到登机桥 B，乘客开始登机；目前 $1$ 号飞机在登机桥 A，$2$ 号飞机在登机桥 B。\n\n在时刻 $3$，$2$ 号飞机切换到摆渡车 A，此时登机桥 B 尚不可用。\n\n在时刻 $4$，$1$ 号飞机起飞，$2$ 号飞机到达摆渡车 A， 号飞机安排到登机桥 A，$3$ 号飞机安排到登机桥 B，$4$ 号和 $3$ 号的乘客开始登机，登机完成之后 $4$ 号飞机切换到摆渡车 B，此时登机桥 A 和登机桥 B 都不空闲。\n\n在时刻 $5$，$3$ 号飞机到达摆渡车 B，登机桥 A 变为可用，$5$ 号飞机安排到登机桥 A，开始登机；目前 $5$ 号——登机桥 A，$4$ 号——登机桥 B，$3$ 号——摆渡车 B，$2$ 号——摆渡车 A。\n\n在时刻 $7$，$2$ 号飞机起飞，$6$ 号飞机安排到摆渡车 A。\n\n不愉快度为 $7=1$（$6$ 号飞机乘客乘摆渡车）$+4\\times 0.5$（$2$ 号飞机切换停机位）$+8\\times 0.5$（$3$ 号飞机切换停机位）\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN"}}}
{"pid": "P7426", "type": "P", "difficulty": 5, "samples": [["1\n2015011233 M 34 14'30\" P 3 3\n8\n20170508 2015011233 17:02:33 17:19:33 2.99 0'0\" 3333\n20170509 2015011233 17:12:15 17:38:46 3.01 2'3\" 4300\n20170510 2015011233 22:03:06 22:13:08 3.05 0'0\" 2772\n20170511 2015011233 22:08:05 22:28:13 3.02 5'3\" 3775\n20170512 2015011233 18:03:12 18:17:56 3.02 0'0\" 2001\n20170513 2015011233 17:30:23 17:46:08 3.01 0'0\" 3020\n20170513 2015011233 22:03:34 22:20:08 3.04 2'0\" 3058\n20170514 2015011233 07:16:22 07:32:34 3.00 0'0\" 3244", "2015011233 59 F"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["模拟", "2017", "THUPC"], "title": "[THUPC 2017] 体育成绩统计", "background": "正所谓「无体育，不清华」。为了更好地督促同学们进行体育锻炼，更加科学地对同学们进行评价，五道口体校的老师们在体育成绩的考核上可谓是煞费苦心。然而每到学期期末时，面对海量的原始数据，如何对数据进行处理，得到同学们的体育总评成绩却又成了体育部老师的一大难题。", "description": "对于大一的同学们来说，体育课的总评成绩由五部分组成：体育课专项成绩（满分 $50$ 分）、长跑测试成绩（满分 $20$ 分）、「阳光长跑」成绩（满分 $10$ 分）、体质测试成绩（满分 $10$ 分）、「大一专项计划」成绩（满分 $10$ 分）。\n\n体育课专项成绩将由任课体育老师直接给出。\n\n长跑测试成绩将由期末长跑测试确定，其中男生需进行 $3000$ 米测试，女生需进行 $1500$ 米测试，具体评分标准为：\n|  | $20$ | $18$ | $16$ | $14$ | $12$ | $10$ | $8$ | $6$ | $4$ | $2$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| 男生 | $12'30''$ | $13'00''$ | $13'30''$ | $14'00''$ | $14'30''$ | $15'10''$ | $15'50''$ | $16'30''$ | $17'10''$ | $18'00''$ |\n| 女生 | $6'40''$ | $6'57''$ | $7'14''$ | $7'31''$ | $7'50''$ | $8'05''$ | $8'20''$ | $8'35''$ | $8'50''$ | $9'00''$ |\n\n「阳光长跑」是通过手机 App 来记录同学们的课外长跑情况，根据对原始跑步数据进行筛选，得到课外长跑的合法次数，来最终确定此部分的成绩。\n\n一条合法的锻炼记录需同时满足：\n\n男生长跑距离 $3000$ 米以上（包含 $3000$ 米），女生长跑距离 $1500$ 米以上（包含 $1500$ 米）；\n\n平均速度（运动距离/(结束时间-开始时间)）不慢于 $2$ 米／秒，且不快于 $5$ 米／秒；\n\n总暂停时间不得超过 $4$ 分 $30$ 秒；\n\n平均步幅（距离／步数）不超过 $1.5$ 米；\n\n开始时间需与上条合法记录的结束时间间隔 $6$ 小时以上（包含 $6$ 小时）；\n\n「阳光长跑」的合法次数与该部分得分的对应如下：\n| 分数 | $10$ | $9$ | $8$ | $7$ | $6$ | $4$ | $2$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| 次数 | $[21,+∞)$ | $[19,20]$ | $[17,18]$ | $[14,16]$ | $[11,13]$ | $[7,10]$ | $[3,6]$ |\n\n对于体质测试部分，若达到合格标准则得到该部分满分 $10$ 分，否则该部分不得分。\n\n「大一专项计划」的 $10$ 分由两部分组成：出勤次数占 $5$ 分，期末检测占 $5$ 分。\n\n其中出勤次数为「班级训练营」的参加次数和「阳光长跑」的合法次数之和，出勤得分与出勤次数的对应如下：\n| 分数 | $5$ | $4$ | $3$ | $2$ | $1$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| 次数 | $[18,+∞)$ | $[15,17]$ | $[12,14]$ | $[9,11]$ | $[6,8]$ |\n\n不难看出，要想准确无误地计算出每个人的体育成绩并不是一件轻松的事，于是体育部的老师找到了正在打校赛的你，他将提供所有需要用到的数据，希望你帮他算算清华大一同学的体育总评成绩及等级。\n\n百分制成绩与等级、绩点对应如下：\n| A | A- | B+ | B | B- | C+ | C | C- |D+  | D | F |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $[95,100]$ | $[90,95)$ | $[85,90)$ | $[80,85)$ | $[77,80)$ | $[73,77)$ | $[70,73)$ | $[67,70)$ | $[63,67)$ | $[60,63)$ | $[0,60)$ |\n", "inputFormat": "从标准输入读入数据。\n\n输入第一行，包含一个正整数 $n$，表示大一年级的学生人数。\n\n接下来 $n$ 行，每行表示一位学生（按学号字典序给出），各项数据之间用空格隔开，一位学生的数据包括：\n\n- 一个长度为 $10$ 的正整数 $p$（数据保证不包含前导零），表示第 $i$ 位同学的学号；\n- 一个字符，M 或 F，若为 M 表示第 $i$ 位同学为男生，若为 F 则表示第 $i$ 位同学为女生；\n- 一个介于 $0$ 到 $50$ 之间的非负整数 $s$，表示第 $i$ 位同学的体育课专项成绩；\n- 一个形如 `a'b\"` 的字符串，表示第 $i$ 位同学的期末长跑测试成绩为 $a$ 分 $b$ 秒；\n- 一个字符，P 或 F，若为 P 表示第 $i$ 位同学的体质测试通过，若为 F 则表示第 $i$ 位同学的体质测试没有通过；\n- 一个介于 $0$ 到 $5$ 之间的非负整数 $f$，表示第 $i$ 位同学的「大一专项计划」的期末检测成绩；\n- 一个非负整数 $c$，表示第 $i$ 位同学参加「班级训练营」的次数。\n\n接下来一行，包括一个非负整数 $m$，表示需要筛选的「阳光长跑」数据条数。\n\n接下来 $m$ 行，每行表示一条需要筛选的「阳光长跑」数据（按开始时间顺序给出），各项之间用空格隔开，一条数据包括：\n\n- 一个形如 `2017MMDD` 的字符串，表示第 $j$ 条记录的完成日期；\n- 一个长度为 $10$ 的正整数 $p$（数据保证不包含前导零），表示第 $j$ 条记录的来源学号；\n- 两个形如 `hh:mm:ss` 的字符串，分别表示第 $j$ 条记录的开始时间和结束时间；\n- 一个精确到小数点后两位的非负浮点数 $l$，表示第 $j$ 条记录的运动距离，单位为千米；\n- 一个形如 `a'b\"` 的字符串，表示第 $j$ 条记录的总暂停时间为 $a$ 分 $b$ 秒；\n- 一个非负整数 $s$，表示第 $j$ 条记录的运动总步数。\n\n输入格式可参见下发样例文件。", "outputFormat": "输出到标准输出。\n\n输出文件共包括 $n$ 行。请你按照学号**字典序**输出每一位同学的学号、百分制总评成绩以及等级。每位同学一行，一行内用空格隔开。", "hint": "对于 $100\\%$ 的数据，$n\\le 10^4,0\\le a,b\\le 59,0\\le c\\le 100,m\\le 1.5\\times 10^5,0\\le l\\le 100,0\\le s\\le 10^6$。\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2017] 体育成绩统计", "background": "正所谓「无体育，不清华」。为了更好地督促同学们进行体育锻炼，更加科学地对同学们进行评价，五道口体校的老师们在体育成绩的考核上可谓是煞费苦心。然而每到学期期末时，面对海量的原始数据，如何对数据进行处理，得到同学们的体育总评成绩却又成了体育部老师的一大难题。", "description": "对于大一的同学们来说，体育课的总评成绩由五部分组成：体育课专项成绩（满分 $50$ 分）、长跑测试成绩（满分 $20$ 分）、「阳光长跑」成绩（满分 $10$ 分）、体质测试成绩（满分 $10$ 分）、「大一专项计划」成绩（满分 $10$ 分）。\n\n体育课专项成绩将由任课体育老师直接给出。\n\n长跑测试成绩将由期末长跑测试确定，其中男生需进行 $3000$ 米测试，女生需进行 $1500$ 米测试，具体评分标准为：\n|  | $20$ | $18$ | $16$ | $14$ | $12$ | $10$ | $8$ | $6$ | $4$ | $2$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| 男生 | $12'30''$ | $13'00''$ | $13'30''$ | $14'00''$ | $14'30''$ | $15'10''$ | $15'50''$ | $16'30''$ | $17'10''$ | $18'00''$ |\n| 女生 | $6'40''$ | $6'57''$ | $7'14''$ | $7'31''$ | $7'50''$ | $8'05''$ | $8'20''$ | $8'35''$ | $8'50''$ | $9'00''$ |\n\n「阳光长跑」是通过手机 App 来记录同学们的课外长跑情况，根据对原始跑步数据进行筛选，得到课外长跑的合法次数，来最终确定此部分的成绩。\n\n一条合法的锻炼记录需同时满足：\n\n男生长跑距离 $3000$ 米以上（包含 $3000$ 米），女生长跑距离 $1500$ 米以上（包含 $1500$ 米）；\n\n平均速度（运动距离/(结束时间-开始时间)）不慢于 $2$ 米／秒，且不快于 $5$ 米／秒；\n\n总暂停时间不得超过 $4$ 分 $30$ 秒；\n\n平均步幅（距离／步数）不超过 $1.5$ 米；\n\n开始时间需与上条合法记录的结束时间间隔 $6$ 小时以上（包含 $6$ 小时）；\n\n「阳光长跑」的合法次数与该部分得分的对应如下：\n| 分数 | $10$ | $9$ | $8$ | $7$ | $6$ | $4$ | $2$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| 次数 | $[21,+∞)$ | $[19,20]$ | $[17,18]$ | $[14,16]$ | $[11,13]$ | $[7,10]$ | $[3,6]$ |\n\n对于体质测试部分，若达到合格标准则得到该部分满分 $10$ 分，否则该部分不得分。\n\n「大一专项计划」的 $10$ 分由两部分组成：出勤次数占 $5$ 分，期末检测占 $5$ 分。\n\n其中出勤次数为「班级训练营」的参加次数和「阳光长跑」的合法次数之和，出勤得分与出勤次数的对应如下：\n| 分数 | $5$ | $4$ | $3$ | $2$ | $1$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| 次数 | $[18,+∞)$ | $[15,17]$ | $[12,14]$ | $[9,11]$ | $[6,8]$ |\n\n不难看出，要想准确无误地计算出每个人的体育成绩并不是一件轻松的事，于是体育部的老师找到了正在打校赛的你，他将提供所有需要用到的数据，希望你帮他算算清华大一同学的体育总评成绩及等级。\n\n百分制成绩与等级、绩点对应如下：\n| A | A- | B+ | B | B- | C+ | C | C- |D+  | D | F |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $[95,100]$ | $[90,95)$ | $[85,90)$ | $[80,85)$ | $[77,80)$ | $[73,77)$ | $[70,73)$ | $[67,70)$ | $[63,67)$ | $[60,63)$ | $[0,60)$ |\n", "inputFormat": "从标准输入读入数据。\n\n输入第一行，包含一个正整数 $n$，表示大一年级的学生人数。\n\n接下来 $n$ 行，每行表示一位学生（按学号字典序给出），各项数据之间用空格隔开，一位学生的数据包括：\n\n- 一个长度为 $10$ 的正整数 $p$（数据保证不包含前导零），表示第 $i$ 位同学的学号；\n- 一个字符，M 或 F，若为 M 表示第 $i$ 位同学为男生，若为 F 则表示第 $i$ 位同学为女生；\n- 一个介于 $0$ 到 $50$ 之间的非负整数 $s$，表示第 $i$ 位同学的体育课专项成绩；\n- 一个形如 `a'b\"` 的字符串，表示第 $i$ 位同学的期末长跑测试成绩为 $a$ 分 $b$ 秒；\n- 一个字符，P 或 F，若为 P 表示第 $i$ 位同学的体质测试通过，若为 F 则表示第 $i$ 位同学的体质测试没有通过；\n- 一个介于 $0$ 到 $5$ 之间的非负整数 $f$，表示第 $i$ 位同学的「大一专项计划」的期末检测成绩；\n- 一个非负整数 $c$，表示第 $i$ 位同学参加「班级训练营」的次数。\n\n接下来一行，包括一个非负整数 $m$，表示需要筛选的「阳光长跑」数据条数。\n\n接下来 $m$ 行，每行表示一条需要筛选的「阳光长跑」数据（按开始时间顺序给出），各项之间用空格隔开，一条数据包括：\n\n- 一个形如 `2017MMDD` 的字符串，表示第 $j$ 条记录的完成日期；\n- 一个长度为 $10$ 的正整数 $p$（数据保证不包含前导零），表示第 $j$ 条记录的来源学号；\n- 两个形如 `hh:mm:ss` 的字符串，分别表示第 $j$ 条记录的开始时间和结束时间；\n- 一个精确到小数点后两位的非负浮点数 $l$，表示第 $j$ 条记录的运动距离，单位为千米；\n- 一个形如 `a'b\"` 的字符串，表示第 $j$ 条记录的总暂停时间为 $a$ 分 $b$ 秒；\n- 一个非负整数 $s$，表示第 $j$ 条记录的运动总步数。\n\n输入格式可参见下发样例文件。", "outputFormat": "输出到标准输出。\n\n输出文件共包括 $n$ 行。请你按照学号**字典序**输出每一位同学的学号、百分制总评成绩以及等级。每位同学一行，一行内用空格隔开。", "hint": "对于 $100\\%$ 的数据，$n\\le 10^4,0\\le a,b\\le 59,0\\le c\\le 100,m\\le 1.5\\times 10^5,0\\le l\\le 100,0\\le s\\le 10^6$。\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN"}}}
{"pid": "P7427", "type": "P", "difficulty": 2, "samples": [["10 5", "5 1 2 3 4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["贪心", "2017", "Special Judge", "构造", "THUPC"], "title": "[THUPC 2017] 玩游戏", "background": "", "description": "ljcc 和他的学妹在玩游戏，这个游戏共有 $n$ 轮，在第 $i$ 轮获胜会获得 $i$ 分，没有平局。\n\n现在给出 ljcc 和学妹的得分，求是否有一种方案符合当前得分。", "inputFormat": "从标准输入读入数据。\n\n输入一行输入两个数 $a,b$ 代表 ljcc 和学妹的得分。", "outputFormat": "输出到标准输出。\n\n若有解，在一行输出一组合法的解。第一个数代表游戏总共进行了 $n$ 轮，之后若干个数表示 ljcc 在哪些局获胜了，每两个数用单个空格隔开，行末不允许有空格。若没有合法解输出 `No`。", "hint": "**由于 SPJ 问题，禁止输出行末空格、回车**。\n\n$a,b\\le 2^{31}-1,1\\le n\\le 10^5$\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2017] 玩游戏", "background": "", "description": "ljcc 和他的学妹在玩游戏，这个游戏共有 $n$ 轮，在第 $i$ 轮获胜会获得 $i$ 分，没有平局。\n\n现在给出 ljcc 和学妹的得分，求是否有一种方案符合当前得分。", "inputFormat": "从标准输入读入数据。\n\n输入一行输入两个数 $a,b$ 代表 ljcc 和学妹的得分。", "outputFormat": "输出到标准输出。\n\n若有解，在一行输出一组合法的解。第一个数代表游戏总共进行了 $n$ 轮，之后若干个数表示 ljcc 在哪些局获胜了，每两个数用单个空格隔开，行末不允许有空格。若没有合法解输出 `No`。", "hint": "**由于 SPJ 问题，禁止输出行末空格、回车**。\n\n$a,b\\le 2^{31}-1,1\\le n\\le 10^5$\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN"}}}
{"pid": "P7428", "type": "P", "difficulty": 4, "samples": [["1\n8 28\n1 2\n1 3\n1 4\n1 5\n1 6\n1 7\n1 8\n2 3\n2 4\n2 5\n2 6\n2 7\n2 8\n3 4\n3 5\n3 6\n3 7\n3 8\n4 5\n4 6\n4 7\n4 8\n5 6\n5 7\n5 8\n6 7\n6 8\n7 8", "abcdabcd"]], "limits": {"time": [1000], "memory": [512000]}, "tags": ["图论", "2017", "Special Judge", "构造", "THUPC"], "title": "[THUPC 2017] 母亲节的礼物", "background": "", "description": "小 B 喜欢图，尤其是边数不太多的无向简单图。\n\n母亲节快到了，小 B 在纸上画了一张有 $n$ 个节点、$m$ 条边的无向简单图（即，不存在重边、自环），保证每个点只和**最多 $7$ 个点**相邻。接着，他想用 $4$ 种不同的颜色给图中的节点进行染色，作为妈妈的母亲节礼物送给她。\n\n小 B 希望染色之后的图尽量漂亮，他觉得相同颜色的点连成一片不好看。所以，他希望能给每对相邻的节点染上不同的颜色。遗憾的是，小 B 很快发现，在有些图中，这是不可能做到的。他不得不降低要求：每个点相邻的点中，**至多**有一个点和它的颜色相同。\n\n限制条件放松了，问题也就变得简单了；但是小 B 忙着做大作业，所以来找你帮忙。现在，请你告诉小 B，是否能给图中每个点染上一个恰当的颜色，恰好满足小 B 的要求？如果可以，请你给他指出一种染色方案；否则，只好残忍地告诉小 B：`impossible`。", "inputFormat": "输入有多组数据，第一行一个整数 $T$（$1\\le T\\le 10$） ，表示数据组数。\n\n对于每组数据：\n\n第一行两个整数 $n,m$（$1\\le n\\le 25000,1\\le m\\le 10^5$），分别表示图的点数和边数（约定点从 $1$ 开始标号）。\n\n接下来 $m$ 行，每行两个整数 $x,y$（$1\\le x,y\\le n$），描述图中的一条边，保证不存在重边、自环。\n\n保证在一个输入文件中，有 $\\sum n\\le 200000,\\sum m\\le 800000$。", "outputFormat": "我们用小写英文字母 `a`、`b`、`c`、`d` 给四种不同的颜色标号。\n\n对于每组数据：\n\n- 如果有解，输出一行一个长度为 $n$ 的字符串 $S$，其中 $S_i$ 表示你给第 $i$ 个点染上的颜色（下标从 $1$ 开始）；\n- 否则，输出 impossible。", "hint": "#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2017] 母亲节的礼物", "background": "", "description": "小 B 喜欢图，尤其是边数不太多的无向简单图。\n\n母亲节快到了，小 B 在纸上画了一张有 $n$ 个节点、$m$ 条边的无向简单图（即，不存在重边、自环），保证每个点只和**最多 $7$ 个点**相邻。接着，他想用 $4$ 种不同的颜色给图中的节点进行染色，作为妈妈的母亲节礼物送给她。\n\n小 B 希望染色之后的图尽量漂亮，他觉得相同颜色的点连成一片不好看。所以，他希望能给每对相邻的节点染上不同的颜色。遗憾的是，小 B 很快发现，在有些图中，这是不可能做到的。他不得不降低要求：每个点相邻的点中，**至多**有一个点和它的颜色相同。\n\n限制条件放松了，问题也就变得简单了；但是小 B 忙着做大作业，所以来找你帮忙。现在，请你告诉小 B，是否能给图中每个点染上一个恰当的颜色，恰好满足小 B 的要求？如果可以，请你给他指出一种染色方案；否则，只好残忍地告诉小 B：`impossible`。", "inputFormat": "输入有多组数据，第一行一个整数 $T$（$1\\le T\\le 10$） ，表示数据组数。\n\n对于每组数据：\n\n第一行两个整数 $n,m$（$1\\le n\\le 25000,1\\le m\\le 10^5$），分别表示图的点数和边数（约定点从 $1$ 开始标号）。\n\n接下来 $m$ 行，每行两个整数 $x,y$（$1\\le x,y\\le n$），描述图中的一条边，保证不存在重边、自环。\n\n保证在一个输入文件中，有 $\\sum n\\le 200000,\\sum m\\le 800000$。", "outputFormat": "我们用小写英文字母 `a`、`b`、`c`、`d` 给四种不同的颜色标号。\n\n对于每组数据：\n\n- 如果有解，输出一行一个长度为 $n$ 的字符串 $S$，其中 $S_i$ 表示你给第 $i$ 个点染上的颜色（下标从 $1$ 开始）；\n- 否则，输出 impossible。", "hint": "#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN"}}}
{"pid": "P7429", "type": "P", "difficulty": 6, "samples": [["1\n3\n0 0\n0 1\n1 0\n1 1", "2"]], "limits": {"time": [1000], "memory": [512000]}, "tags": ["计算几何", "2017", "线性代数", "高斯消元", "THUPC"], "title": "[THUPC 2017] 气氛", "background": "", "description": "北大街，在中国是一个非常常见的地名，比较著名的有上海北大街，西安北大街，成都北大街，太原北大街，中关村北大街等。\n\n我们都知道，北的意思是自由民主，大的意思是兼收并蓄，所以住在北大街的人也性情迥异，我们假设在北大街住了 $n$ 个人。\n\n有人向住在北大街的这 $n$ 个人提了 $n-1$ 个问题，比如：\n\n「用不用筷子？」\n\n「吃不吃红烧肉？」\n\n「写代码用 tab 还是 space」\n\n「大括号换不换行？」\n\n「……」\n\n根据每个人的回答，他会被分配一个 $n-1$ 维的零一坐标，也就是一个点。这样 $n$ 个点可以恰好构成一个 $n-1$ 维空间中的凸包。\n\n北大街的居民认为，在这个多面体内，便是华夏；多面体之外，便是蛮夷。我们可以很容易的计算出华夏部分的广义凸包体积。\n\n有一天，清华路的 B 君来北大街玩，听说了这个故事觉得很有趣，于是也试着给出了这 $n-1$ 个问题的答案，\n\n清华路的 B 君，当然认为自己属于华夏，但是北大街表示在 $n-1$ 维空间中如果有 $n+1$ 个点的话，华夏部分的体积难以计算。\n\n这下子气氛突然僵化。所以这个问题就留给你了，输入 $n-1$ 维度空间中的 $n+1$ 个点，求广义凸包的体积。\n\n由于这个体积可能不是整数，你只需要输出体积乘以 $n-1$ 的阶乘，然后对 $10^9+7$ 取模的结果。", "inputFormat": "从标准输入读入数据。\n\n第一行一个整数 $T$ 表示组数，接下来是 $T$ 组数据\n\n每组数据的第一行是一个整数 $n$ 。\n\n接下来 $n+1$ 行，每行 $n-1$ 个整数，表示在 $n-1$ 维空间中的一个点。", "outputFormat": "输出到标准输出。\n\n对于每组数据，输出一行一个整数表示答案。\n\n输入 $n+1$ 个点的凸包体积乘以 $n-1$ 的阶乘，然后对 $10^9+7$ 取模的结果。", "hint": "$1\\le t\\le 100,3\\le n\\le35$\n\n点的坐标一定是 $0$ 或者 $1$。\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2017] 气氛", "background": "", "description": "北大街，在中国是一个非常常见的地名，比较著名的有上海北大街，西安北大街，成都北大街，太原北大街，中关村北大街等。\n\n我们都知道，北的意思是自由民主，大的意思是兼收并蓄，所以住在北大街的人也性情迥异，我们假设在北大街住了 $n$ 个人。\n\n有人向住在北大街的这 $n$ 个人提了 $n-1$ 个问题，比如：\n\n「用不用筷子？」\n\n「吃不吃红烧肉？」\n\n「写代码用 tab 还是 space」\n\n「大括号换不换行？」\n\n「……」\n\n根据每个人的回答，他会被分配一个 $n-1$ 维的零一坐标，也就是一个点。这样 $n$ 个点可以恰好构成一个 $n-1$ 维空间中的凸包。\n\n北大街的居民认为，在这个多面体内，便是华夏；多面体之外，便是蛮夷。我们可以很容易的计算出华夏部分的广义凸包体积。\n\n有一天，清华路的 B 君来北大街玩，听说了这个故事觉得很有趣，于是也试着给出了这 $n-1$ 个问题的答案，\n\n清华路的 B 君，当然认为自己属于华夏，但是北大街表示在 $n-1$ 维空间中如果有 $n+1$ 个点的话，华夏部分的体积难以计算。\n\n这下子气氛突然僵化。所以这个问题就留给你了，输入 $n-1$ 维度空间中的 $n+1$ 个点，求广义凸包的体积。\n\n由于这个体积可能不是整数，你只需要输出体积乘以 $n-1$ 的阶乘，然后对 $10^9+7$ 取模的结果。", "inputFormat": "从标准输入读入数据。\n\n第一行一个整数 $T$ 表示组数，接下来是 $T$ 组数据\n\n每组数据的第一行是一个整数 $n$ 。\n\n接下来 $n+1$ 行，每行 $n-1$ 个整数，表示在 $n-1$ 维空间中的一个点。", "outputFormat": "输出到标准输出。\n\n对于每组数据，输出一行一个整数表示答案。\n\n输入 $n+1$ 个点的凸包体积乘以 $n-1$ 的阶乘，然后对 $10^9+7$ 取模的结果。", "hint": "$1\\le t\\le 100,3\\le n\\le35$\n\n点的坐标一定是 $0$ 或者 $1$。\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN"}}}
{"pid": "P7430", "type": "P", "difficulty": 6, "samples": [["3 3\n1 3\n2 5\n2 3\n5 1\n1 5\n2 4\n3 3\n4 2\n5 1", "1.000000\n0.600000"]], "limits": {"time": [4000], "memory": [512000]}, "tags": ["数学", "2017", "二分", "Special Judge", "THUPC"], "title": "[THUPC 2017] 组合数问题", "background": "", "description": "小葱是一名勇士。\n\n小葱踏上了拯救世界的征途。\n\n小葱面前有 $N$ 只大葱怪。\n\n大葱怪很厉害，第 $i$ 只大葱怪攻击力为 $a_i$，防御力为 $d_i$。\n\n小葱的攻击力为 $A$，防御力为 $D$。\n\n小葱打掉第 $i$ 只大葱怪的代价是 $A\\times d_i+D\\times a_i$。\n\n小葱打倒很多只大葱怪的代价不是打倒每一只大葱怪的代价之和，而是最大值。\n\n小葱现在需要打倒 $R$ 只大葱怪。\n\n神葱是葱的神，神葱会对小葱打倒 $R$ 只大葱怪做出评价。神葱对小葱打倒 $R$ 只大葱的评价为小葱打倒这 $R$ 只大葱怪所需要的代价除以小葱以同样的攻击力和防御力打倒所有 $N$ 只大葱怪的代价。\n\n神葱是葱的神，所以神葱会在小葱选择了 $R$ 只要被打倒的大葱怪后，设定小葱的攻击力和防御力，使得小葱得到的评价最低。\n\n神葱不希望这个值是负的，所以如果这个值是负的，神葱会强制把它变为 $0$。\n\n小葱是一名勇士。\n\n小葱不会屈服。\n\n小葱需要选择出 $R$ 只大葱怪，使得自己能够从神葱那里得到的评价最高。\n\n小葱求这个评价值。\n\n小葱很善良，所以小葱为你写出了评价值的数学表示：\n$$\\max_{S\\subseteq [N],|S|=R}\\Big\\lbrack\\min_{A,D\\in\\Z^+}\\dfrac{\\max_{i\\in S}(A\\times d_i+D\\times a_i)}{\\max_{i\\in [N]}(A\\times d_i+D\\times a_i)}\\Big\\rbrack$$", "inputFormat": "测试点包含多组数据。\n\n对于每组数据，第一行两个整数代表 $N,R$。\n\n接下来 $N$ 行每行两个实数分别代表 $a_i,d_i$。", "outputFormat": "对于每组数据，一行一个实数代表答案，你需要保证你的答案与标准答案的误差不超过 $10^{-6}$。", "hint": "$1\\le R\\le N\\le 10^3,a_i,d_i$ 均为正整数，数据组数不超过 $50$ 组，所有攻击力和防御力都是正整数。\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2017] 组合数问题", "background": "", "description": "小葱是一名勇士。\n\n小葱踏上了拯救世界的征途。\n\n小葱面前有 $N$ 只大葱怪。\n\n大葱怪很厉害，第 $i$ 只大葱怪攻击力为 $a_i$，防御力为 $d_i$。\n\n小葱的攻击力为 $A$，防御力为 $D$。\n\n小葱打掉第 $i$ 只大葱怪的代价是 $A\\times d_i+D\\times a_i$。\n\n小葱打倒很多只大葱怪的代价不是打倒每一只大葱怪的代价之和，而是最大值。\n\n小葱现在需要打倒 $R$ 只大葱怪。\n\n神葱是葱的神，神葱会对小葱打倒 $R$ 只大葱怪做出评价。神葱对小葱打倒 $R$ 只大葱的评价为小葱打倒这 $R$ 只大葱怪所需要的代价除以小葱以同样的攻击力和防御力打倒所有 $N$ 只大葱怪的代价。\n\n神葱是葱的神，所以神葱会在小葱选择了 $R$ 只要被打倒的大葱怪后，设定小葱的攻击力和防御力，使得小葱得到的评价最低。\n\n神葱不希望这个值是负的，所以如果这个值是负的，神葱会强制把它变为 $0$。\n\n小葱是一名勇士。\n\n小葱不会屈服。\n\n小葱需要选择出 $R$ 只大葱怪，使得自己能够从神葱那里得到的评价最高。\n\n小葱求这个评价值。\n\n小葱很善良，所以小葱为你写出了评价值的数学表示：\n$$\\max_{S\\subseteq [N],|S|=R}\\Big\\lbrack\\min_{A,D\\in\\Z^+}\\dfrac{\\max_{i\\in S}(A\\times d_i+D\\times a_i)}{\\max_{i\\in [N]}(A\\times d_i+D\\times a_i)}\\Big\\rbrack$$", "inputFormat": "测试点包含多组数据。\n\n对于每组数据，第一行两个整数代表 $N,R$。\n\n接下来 $N$ 行每行两个实数分别代表 $a_i,d_i$。", "outputFormat": "对于每组数据，一行一个实数代表答案，你需要保证你的答案与标准答案的误差不超过 $10^{-6}$。", "hint": "$1\\le R\\le N\\le 10^3,a_i,d_i$ 均为正整数，数据组数不超过 $50$ 组，所有攻击力和防御力都是正整数。\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN"}}}
{"pid": "P7431", "type": "P", "difficulty": 6, "samples": [["2\n3\n2 3 3\n5\n1 2 3 4 5", "32\n4675"]], "limits": {"time": [3000], "memory": [512000]}, "tags": ["2017", "分治", "快速傅里叶变换 FFT", "快速数论变换 NTT", "THUPC"], "title": "[THUPC 2017] 小 L 的计算题", "background": "", "description": "现有一个长度为 $n$ 的非负整数数组 $\\{a_i\\}$ 。小 L 定义了一种神奇变换：\n$$f_k=\\left(\\sum_{i=1}^na_i^k\\right)\\bmod 998244353$$\n小 L 计划用变换生成的序列 $f$ 做一些有趣的事情，但是他并不擅长算乘法，所以来找你帮忙，希望你能帮他尽快计算出 $f_{1\\dots n}$。", "inputFormat": "输入包含多组数据。\n\n输入的第一行包含一个整数 $T$ , 表示数据组数。\n\n接下来 $2T$ 行，每两行代表一组测试数据。\n\n每组数据的第一行包含一个整数 $n$，表示数组 $\\{a_i\\}$ 的长度。接下来一行 $n$ 个整数，描述数组 $\\{a_i\\}$。\n\n保证输入的 $a_i$ 满足 $0\\le a_i\\le10^9$。在一个测试文件中，保证有 $\\sum n\\le 4\\times 10^5$。", "outputFormat": "我们不想让你输出过多的数。因此，令 $ans=\\bigoplus_{i=1}^{n}f_i$，其中 $\\bigoplus$ 表示**异或**操作，在 C++ / Java / Python 中，它可以表示为 `^`。\n\n对每组数据，你需要输出一行一个整数，表示 $ans$。", "hint": "对于 $100\\%$ 的数据，$0\\le a_i\\le10^9$，$1\\le n\\le 2\\times 10^5$，$\\sum n\\le 4\\times 10^5$。\n\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2017] 小 L 的计算题", "background": "", "description": "现有一个长度为 $n$ 的非负整数数组 $\\{a_i\\}$ 。小 L 定义了一种神奇变换：\n$$f_k=\\left(\\sum_{i=1}^na_i^k\\right)\\bmod 998244353$$\n小 L 计划用变换生成的序列 $f$ 做一些有趣的事情，但是他并不擅长算乘法，所以来找你帮忙，希望你能帮他尽快计算出 $f_{1\\dots n}$。", "inputFormat": "输入包含多组数据。\n\n输入的第一行包含一个整数 $T$ , 表示数据组数。\n\n接下来 $2T$ 行，每两行代表一组测试数据。\n\n每组数据的第一行包含一个整数 $n$，表示数组 $\\{a_i\\}$ 的长度。接下来一行 $n$ 个整数，描述数组 $\\{a_i\\}$。\n\n保证输入的 $a_i$ 满足 $0\\le a_i\\le10^9$。在一个测试文件中，保证有 $\\sum n\\le 4\\times 10^5$。", "outputFormat": "我们不想让你输出过多的数。因此，令 $ans=\\bigoplus_{i=1}^{n}f_i$，其中 $\\bigoplus$ 表示**异或**操作，在 C++ / Java / Python 中，它可以表示为 `^`。\n\n对每组数据，你需要输出一行一个整数，表示 $ans$。", "hint": "对于 $100\\%$ 的数据，$0\\le a_i\\le10^9$，$1\\le n\\le 2\\times 10^5$，$\\sum n\\le 4\\times 10^5$。\n\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN"}}}
{"pid": "P7432", "type": "P", "difficulty": 6, "samples": [["2\n3 10 3\n2 3 3\n20 50 24\n3 1 10\n1 1\n2 2\n3 3\n2 7 3\n6 7\n1 2\n1 1\n1 1\n2 2\n1 2", "568 120\n660 20\n660 20\n2 2\n2 0\n0 0"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000], "memory": [65536, 65536, 65536, 65536, 65536]}, "tags": ["动态规划 DP", "2017", "O2优化", "背包 DP", "分块", "THUPC"], "title": "[THUPC 2017] 钦妹的玩具商店", "background": null, "description": "钦妹和弗雷兹在 C 市有一个玩具店，店里有 $n$ 种玩具，编号依次为 $1,2,...,n$，第 $i$ 件玩具的单价为 $c_i$ 元，一个该玩具提供的愉悦度为  $v_i$。\n\n突然有一天，C 市来了 $m$ 个小朋友。据可靠消息，接下来 $Q$ 天，这些小朋友每天都会来店里买东西，其中第 $i$ 个小朋友每天都会带 $i$ 元  （$1\\le i\\le m$）。\n\n由于某些玩具不是很优秀，所以每天都会有不同的玩具被禁止出售给小朋友。具体来说，在第 $i$ 天，编号在区间 $[l_i,r_i]$ 内的物品小朋友是不能购买的。\n\n除此之外，为了防止小朋友们太愉悦，每件玩具都有一个限购件数  $t_i$。也就是说，对于第 $i$ 种玩具，每个小朋友在每一天的购买件数都必须为不超过 $t_i$ 的非负整数。\n\n现在，对于每一天，你想知道：所有小朋友所能获得的最大愉悦度之和（对 $10^8+7$ 取模）；所有小朋友所能获得的最大愉悦度的异或和（异或运算是 $\\operatorname{xor}$ 运算，即 C++/Java/Python 中的 `^` 运算）。\n\n本题强制在线，具体规则在输入描述中体现。", "inputFormat": "从标准输入读入数据。\n\n输入包含多组数据。第一行有一个整数  $T$，表示测试数据的组数，对于每组数据：\n\n第一行输入三个整数 $n,m,Q$ 分别表示玩具数目、小朋友的数目以及天数。\n\n第二行 $n$ 个非负整数，分别描述每件玩具的单价  $c_1,c_2,...,c_n$。\n\n第三行 $n$ 个非负整数，分别描述每件玩具的愉悦度 $v_1,v_2,...,v_n$ 。\n\n第四行 $n$ 个非负整数，分别描述每件玩具的限购次数  $t_1,t_2,...,t_n$。\n\n第五行到第 $Q+4$ 行，每行两个描述区间的参数  $x,y$。第  行和前一天的答案共同描述了第 $i$ 天禁止购买的编号区间，假设前一天的最大愉悦度之和为 $\\operatorname{lastans}$ ，那么当天的 $l_i,r_i$ 满足下式：\n$$l_i=\\min((x+\\operatorname{lastans}-1)\\bmod n+1,(y+\\operatorname{lastans}-1)\\bmod n+1)$$\n$$r_i=\\max((x+\\operatorname{lastans}-1)\\bmod n+1,(y+\\operatorname{lastans}-1)\\bmod n+1)$$\n在第一天时，我们认为 $\\operatorname{lastans}=0$ 。保证  $1\\le x,y\\le n$。", "outputFormat": "输出到标准输出。\n\n对于每一组数据，输出 $Q$ 行，每行 $2$ 个整数，依次表示所有小朋友能够获得的最大愉悦度之和（对 $10^8+7$ 取模）以及异或和。", "hint": "对于所有的数据，$1\\le n,m,Q,c_i,t_i\\le 10^3$，$1\\le v_i\\le 2.5\\times 10^5$，$\\sum n,\\sum m,\\sum Q\\le 10^4$。\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2017] 钦妹的玩具商店", "background": null, "description": "钦妹和弗雷兹在 C 市有一个玩具店，店里有 $n$ 种玩具，编号依次为 $1,2,...,n$，第 $i$ 件玩具的单价为 $c_i$ 元，一个该玩具提供的愉悦度为  $v_i$。\n\n突然有一天，C 市来了 $m$ 个小朋友。据可靠消息，接下来 $Q$ 天，这些小朋友每天都会来店里买东西，其中第 $i$ 个小朋友每天都会带 $i$ 元  （$1\\le i\\le m$）。\n\n由于某些玩具不是很优秀，所以每天都会有不同的玩具被禁止出售给小朋友。具体来说，在第 $i$ 天，编号在区间 $[l_i,r_i]$ 内的物品小朋友是不能购买的。\n\n除此之外，为了防止小朋友们太愉悦，每件玩具都有一个限购件数  $t_i$。也就是说，对于第 $i$ 种玩具，每个小朋友在每一天的购买件数都必须为不超过 $t_i$ 的非负整数。\n\n现在，对于每一天，你想知道：所有小朋友所能获得的最大愉悦度之和（对 $10^8+7$ 取模）；所有小朋友所能获得的最大愉悦度的异或和（异或运算是 $\\operatorname{xor}$ 运算，即 C++/Java/Python 中的 `^` 运算）。\n\n本题强制在线，具体规则在输入描述中体现。", "inputFormat": "从标准输入读入数据。\n\n输入包含多组数据。第一行有一个整数  $T$，表示测试数据的组数，对于每组数据：\n\n第一行输入三个整数 $n,m,Q$ 分别表示玩具数目、小朋友的数目以及天数。\n\n第二行 $n$ 个非负整数，分别描述每件玩具的单价  $c_1,c_2,...,c_n$。\n\n第三行 $n$ 个非负整数，分别描述每件玩具的愉悦度 $v_1,v_2,...,v_n$ 。\n\n第四行 $n$ 个非负整数，分别描述每件玩具的限购次数  $t_1,t_2,...,t_n$。\n\n第五行到第 $Q+4$ 行，每行两个描述区间的参数  $x,y$。第  行和前一天的答案共同描述了第 $i$ 天禁止购买的编号区间，假设前一天的最大愉悦度之和为 $\\operatorname{lastans}$ ，那么当天的 $l_i,r_i$ 满足下式：\n$$l_i=\\min((x+\\operatorname{lastans}-1)\\bmod n+1,(y+\\operatorname{lastans}-1)\\bmod n+1)$$\n$$r_i=\\max((x+\\operatorname{lastans}-1)\\bmod n+1,(y+\\operatorname{lastans}-1)\\bmod n+1)$$\n在第一天时，我们认为 $\\operatorname{lastans}=0$ 。保证  $1\\le x,y\\le n$。", "outputFormat": "输出到标准输出。\n\n对于每一组数据，输出 $Q$ 行，每行 $2$ 个整数，依次表示所有小朋友能够获得的最大愉悦度之和（对 $10^8+7$ 取模）以及异或和。", "hint": "对于所有的数据，$1\\le n,m,Q,c_i,t_i\\le 10^3$，$1\\le v_i\\le 2.5\\times 10^5$，$\\sum n,\\sum m,\\sum Q\\le 10^4$。\n#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN"}}}
{"pid": "P7433", "type": "P", "difficulty": 7, "samples": [["3 2 3 1\n0 0 0 1\n0 0 0 2\n0 0 0 3", "573"], ["3 2 3 5\n0 0 0 1\n0 0 0 2\n0 0 0 3", "253"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288]}, "tags": ["2017", "快速傅里叶变换 FFT", "快速数论变换 NTT", "THUPC"], "title": "[THUPC 2017] 老司机", "background": "", "description": "四环路上行人稀，常有车神较高低。\n\n如今车道依旧在，不见当年老司机。\n\nB 君心情不好的时候，喜欢去四环路上飙车。看着窗外飞驰而过的景色，B 君想到了过去的 R 君和 G 君；想到了现在的 YJQ 和 FLZ；想到了宇宙之浩渺，时空之无限；也想到了这道题。\n\n输入 $n,X,Y,Z$，保证 $X$ 是 $2$ 的整数次幂，$Y$ 是 $3$ 的整数次幂，$Z$ 是 $5$ 的整数次幂，同时 $1\\le n\\le 1000,1\\le X\\times Y\\times Z\\le2000$。\n\n输入四个长度为 $n$ 的数组 $\\{a_i\\},\\{b_i\\},\\{c_i\\},\\{r_i\\}$（$0\\le a_i,b_i,c_i,r_i\\le10^9$）。\n\n对于 $(u,v,w)$ 求有多少组解 $\\{x_i\\},\\{y_i\\},\\{z_i\\}$。\n\n满足对于所有的 $i$，有 $a_i\\le x_i,b_i\\le y_i,c_i\\le z_i,r_i\\ge x_i-a_i+y_i-b_i+z_i-c_i$。\n\n并且\n$$(\\sum_{i=1}^nx_i)\\bmod X=u$$\n$$(\\sum_{i=1}^ny_i)\\bmod Y=v$$\n$$(\\sum_{i=1}^nz_i)\\bmod Z=w$$\n\n设解的个数为 $F(u,v,w)$。\n\n输出\n$$\\operatorname*{xor}_{0\\le u< X,0\\le v<Y,0\\le w<Z}((uYZ+vZ+w)\\times(F(u,v,w)\\bmod466560001))$$\n", "inputFormat": "输入第一行 $n,X,Y,Z$。\n\n接下来 $n$ 行，第 $i$ 行四个整数 $a_i,b_i,c_i,r_i$。", "outputFormat": "一行一个整数表示答案。", "hint": "#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2017] 老司机", "background": "", "description": "四环路上行人稀，常有车神较高低。\n\n如今车道依旧在，不见当年老司机。\n\nB 君心情不好的时候，喜欢去四环路上飙车。看着窗外飞驰而过的景色，B 君想到了过去的 R 君和 G 君；想到了现在的 YJQ 和 FLZ；想到了宇宙之浩渺，时空之无限；也想到了这道题。\n\n输入 $n,X,Y,Z$，保证 $X$ 是 $2$ 的整数次幂，$Y$ 是 $3$ 的整数次幂，$Z$ 是 $5$ 的整数次幂，同时 $1\\le n\\le 1000,1\\le X\\times Y\\times Z\\le2000$。\n\n输入四个长度为 $n$ 的数组 $\\{a_i\\},\\{b_i\\},\\{c_i\\},\\{r_i\\}$（$0\\le a_i,b_i,c_i,r_i\\le10^9$）。\n\n对于 $(u,v,w)$ 求有多少组解 $\\{x_i\\},\\{y_i\\},\\{z_i\\}$。\n\n满足对于所有的 $i$，有 $a_i\\le x_i,b_i\\le y_i,c_i\\le z_i,r_i\\ge x_i-a_i+y_i-b_i+z_i-c_i$。\n\n并且\n$$(\\sum_{i=1}^nx_i)\\bmod X=u$$\n$$(\\sum_{i=1}^ny_i)\\bmod Y=v$$\n$$(\\sum_{i=1}^nz_i)\\bmod Z=w$$\n\n设解的个数为 $F(u,v,w)$。\n\n输出\n$$\\operatorname*{xor}_{0\\le u< X,0\\le v<Y,0\\le w<Z}((uYZ+vZ+w)\\times(F(u,v,w)\\bmod466560001))$$\n", "inputFormat": "输入第一行 $n,X,Y,Z$。\n\n接下来 $n$ 行，第 $i$ 行四个整数 $a_i,b_i,c_i,r_i$。", "outputFormat": "一行一个整数表示答案。", "hint": "#### 版权信息\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。", "locale": "zh-CN"}}}
{"pid": "P7434", "type": "P", "difficulty": 7, "samples": [["30 10000 20051130\n1 1\n2 1\n3 1\n4 1\n5 1\n6 1\n7 1\n7 1\n9 1\n9 1\n11 1\n11 1\n12 1\n13 1\n13 1\n14 1\n17 1\n18 1\n19 1\n20 1\n21 1\n19 1\n23 1\n22 1\n22 1\n25 1\n25 1\n28 1\n29 1\n1\n1 1 1 1 1 1 1 1", "2 6362"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化"], "title": "「MCOI-04 / AC6-M09」Heavy Command Cruiser", "background": "这是一个作战部署命令。\n\n我们已经从国家安全局获得了有关敌方重型指挥巡洋舰的部分机密情报。\n\n敌方巡航机的正式名称已被确认为 P-1112 Aigaion。\n\n空中舰队中包含一种 Kottos 中型巡航机负责电子支援，还有一种 Gyges 中型巡航机负责近程防空。\n\nAigaion，作为指挥机，负责一切与巡航导弹相关的事务。\n\n在获得这些情报之后，我们可以草拟一个摧毁 Aigaion 的计划。\n\n仔细听好了。\n\nAigaion 只能在机体前部接受空中加油。\n\n多架加油机必须同时处在 Aigaion 前方才能进行加油作业。\n\n当加油机在 Aigaion 前部进行加油时，Aigaion 的雷达探测能力会暂时削弱。\n\n这里就是关键点了。\n\nAigaion 在进行加油时，其雷达基本完全无法探测在其前方飞行的物体。\n\n如果你们能维持在一个固定航线并在一个特定高度上飞行，你们就能在不被敌军发现的情况下，从空中接近 Aigaion。\n\n所以我们解决掉这只怪物的最佳时机就是它进行空中加油的时候。\n\nAigaion 的预定航线图也包含在这份情报中。\n\n简报结束后，我们将在机库再次检查航线图。\n\n快去准备吧。\n\n…………\n\nGaruda 队，交战！\n\n$$_{{\\frac{\\large\\text{ACE COMBAT }\\Large6}{\\tiny{\\text{F i r e s\\quad O f\\quad L i b e r a t i o n}}}}}\\\\ \\text{Mission 09} \\\\\\Large\\text{Heavy Command Cruiser}\\\\\\tiny -\\ The\\ Dead\\ Sea\\ -$$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0xt87jqh.png)", "description": "在平面上给定一棵有根树，树根为 $1$，根的深度为 $0$。\n\n对于深度为 $x$ 的节点，其 **纵坐标** 为 $n-x+1$。\n\n对于一个节点的所有子节点，**从左到右按照编号升序排列**。每条边都是一条 **连接两个点的线段**。\n\n每一个叶子节点都有一条 **平行于 $y$ 轴且向 $y$ 轴负方向无限延伸的射线**，根节点有一条 **平行于 $y$ 轴且向 $y$ 轴正方向无限延伸的射线**。\n\n每个线段或射线带一个权值。\n\n**任意两条线段或射线只在树的节点处相交。**\n\n如果你不理解这个树是怎么画的，可以阅读样例 1 解释。\n\n给定 $q$ 组 $u,v$，你现在要从点 $u$ 开始在平面上自由移动，但是你不能经过除 $u,v$ 以外的任何一个点，且每经过一条线段或射线就会产生其对应的权值的代价。\n\n你的目标是移动到点 $v$，你需要求出移动过程产生的最小代价。", "inputFormat": "由于直接输入会造成巨大的输入量，所以本题采用特殊的输入方式。\n\n给定如下随机数生成器：\n\n```cpp\nnamespace GenHelper\n{\n    unsigned z1,z2,z3,z4,b;\n    unsigned rand_()\n    {\n    b=((z1<<6)^z1)>>13;\n    z1=((z1&4294967294U)<<18)^b;\n    b=((z2<<2)^z2)>>27;\n    z2=((z2&4294967288U)<<2)^b;\n    b=((z3<<13)^z3)>>21;\n    z3=((z3&4294967280U)<<7)^b;\n    b=((z4<<3)^z4)>>12;\n    z4=((z4&4294967168U)<<13)^b;\n    return (z1^z2^z3^z4);\n    }\n}\nvoid srand(unsigned x)\n{using namespace GenHelper;\nz1=x; z2=(~x)^0x233333333U; z3=x^0x1234598766U; z4=(~x)+51;}\nint read()\n{\n    using namespace GenHelper;\n    int a=rand_()&32767;\n    int b=rand_()&32767;\n    return a*32768+b;\n}\n```\n\n第一行三个整数 $n,q,s$。\n\n接下来 $n-1$ 行，每行两个整数，分别表示这个节点在树上的父亲 $f_i$ 和其到父亲的边的权值 $w_i$。\n\n接下来一个整数 $w_1$，表示节点 $1$ 向上的射线的权值。\n\n接下来一行若干个空格分隔的整数 $d_u$，按照 **叶子节点编号从小到大（注意不是在树上从左到右）** 的顺序给出所有叶子节点向下的射线的权值。\n\n接下来，对于每一组询问，设上一次询问的答案为 $\\text{lastans}$，如果这是第一次询问，则 $\\text{lastans}=0$。你需要先调用一次 $(\\text{read}()\\oplus \\text{lastans})\\bmod n+1$ 得到询问的 $u$，再调用一次 $(\\text{read}()\\oplus \\text{lastans})\\bmod n+1$ 得到询问的 $v$。其中 $\\oplus$ 表示异或运算。\n\n", "outputFormat": "输出两个空格分隔的整数，分别表示所有答案的异或和和所有答案的和。", "hint": "idea：Sol1，solution：dengyaotriangle & Sol1 & Guoyh，code：Sol1，data：Sol1\n\n对于 $100\\%$ 的数据，满足 $1\\leq n\\leq 5\\times 10^5$，$1\\leq q\\leq 5\\times 10^6$，$1\\leq f_i<i$，$1\\leq w_i,w_1,d_{u}\\leq 2\\times 10^3$，$0\\leq s\\leq10^9$。\n\n---\n\n「魂归大海……」\n\n「你可以休息了……」\n\n「安息吧。」", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「MCOI-04 / AC6-M09」Heavy Command Cruiser", "background": "这是一个作战部署命令。\n\n我们已经从国家安全局获得了有关敌方重型指挥巡洋舰的部分机密情报。\n\n敌方巡航机的正式名称已被确认为 P-1112 Aigaion。\n\n空中舰队中包含一种 Kottos 中型巡航机负责电子支援，还有一种 Gyges 中型巡航机负责近程防空。\n\nAigaion，作为指挥机，负责一切与巡航导弹相关的事务。\n\n在获得这些情报之后，我们可以草拟一个摧毁 Aigaion 的计划。\n\n仔细听好了。\n\nAigaion 只能在机体前部接受空中加油。\n\n多架加油机必须同时处在 Aigaion 前方才能进行加油作业。\n\n当加油机在 Aigaion 前部进行加油时，Aigaion 的雷达探测能力会暂时削弱。\n\n这里就是关键点了。\n\nAigaion 在进行加油时，其雷达基本完全无法探测在其前方飞行的物体。\n\n如果你们能维持在一个固定航线并在一个特定高度上飞行，你们就能在不被敌军发现的情况下，从空中接近 Aigaion。\n\n所以我们解决掉这只怪物的最佳时机就是它进行空中加油的时候。\n\nAigaion 的预定航线图也包含在这份情报中。\n\n简报结束后，我们将在机库再次检查航线图。\n\n快去准备吧。\n\n…………\n\nGaruda 队，交战！\n\n$$_{{\\frac{\\large\\text{ACE COMBAT }\\Large6}{\\tiny{\\text{F i r e s\\quad O f\\quad L i b e r a t i o n}}}}}\\\\ \\text{Mission 09} \\\\\\Large\\text{Heavy Command Cruiser}\\\\\\tiny -\\ The\\ Dead\\ Sea\\ -$$\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/0xt87jqh.png)", "description": "在平面上给定一棵有根树，树根为 $1$，根的深度为 $0$。\n\n对于深度为 $x$ 的节点，其 **纵坐标** 为 $n-x+1$。\n\n对于一个节点的所有子节点，**从左到右按照编号升序排列**。每条边都是一条 **连接两个点的线段**。\n\n每一个叶子节点都有一条 **平行于 $y$ 轴且向 $y$ 轴负方向无限延伸的射线**，根节点有一条 **平行于 $y$ 轴且向 $y$ 轴正方向无限延伸的射线**。\n\n每个线段或射线带一个权值。\n\n**任意两条线段或射线只在树的节点处相交。**\n\n如果你不理解这个树是怎么画的，可以阅读样例 1 解释。\n\n给定 $q$ 组 $u,v$，你现在要从点 $u$ 开始在平面上自由移动，但是你不能经过除 $u,v$ 以外的任何一个点，且每经过一条线段或射线就会产生其对应的权值的代价。\n\n你的目标是移动到点 $v$，你需要求出移动过程产生的最小代价。", "inputFormat": "由于直接输入会造成巨大的输入量，所以本题采用特殊的输入方式。\n\n给定如下随机数生成器：\n\n```cpp\nnamespace GenHelper\n{\n    unsigned z1,z2,z3,z4,b;\n    unsigned rand_()\n    {\n    b=((z1<<6)^z1)>>13;\n    z1=((z1&4294967294U)<<18)^b;\n    b=((z2<<2)^z2)>>27;\n    z2=((z2&4294967288U)<<2)^b;\n    b=((z3<<13)^z3)>>21;\n    z3=((z3&4294967280U)<<7)^b;\n    b=((z4<<3)^z4)>>12;\n    z4=((z4&4294967168U)<<13)^b;\n    return (z1^z2^z3^z4);\n    }\n}\nvoid srand(unsigned x)\n{using namespace GenHelper;\nz1=x; z2=(~x)^0x233333333U; z3=x^0x1234598766U; z4=(~x)+51;}\nint read()\n{\n    using namespace GenHelper;\n    int a=rand_()&32767;\n    int b=rand_()&32767;\n    return a*32768+b;\n}\n```\n\n第一行三个整数 $n,q,s$。\n\n接下来 $n-1$ 行，每行两个整数，分别表示这个节点在树上的父亲 $f_i$ 和其到父亲的边的权值 $w_i$。\n\n接下来一个整数 $w_1$，表示节点 $1$ 向上的射线的权值。\n\n接下来一行若干个空格分隔的整数 $d_u$，按照 **叶子节点编号从小到大（注意不是在树上从左到右）** 的顺序给出所有叶子节点向下的射线的权值。\n\n接下来，对于每一组询问，设上一次询问的答案为 $\\text{lastans}$，如果这是第一次询问，则 $\\text{lastans}=0$。你需要先调用一次 $(\\text{read}()\\oplus \\text{lastans})\\bmod n+1$ 得到询问的 $u$，再调用一次 $(\\text{read}()\\oplus \\text{lastans})\\bmod n+1$ 得到询问的 $v$。其中 $\\oplus$ 表示异或运算。\n\n", "outputFormat": "输出两个空格分隔的整数，分别表示所有答案的异或和和所有答案的和。", "hint": "idea：Sol1，solution：dengyaotriangle & Sol1 & Guoyh，code：Sol1，data：Sol1\n\n对于 $100\\%$ 的数据，满足 $1\\leq n\\leq 5\\times 10^5$，$1\\leq q\\leq 5\\times 10^6$，$1\\leq f_i<i$，$1\\leq w_i,w_1,d_{u}\\leq 2\\times 10^3$，$0\\leq s\\leq10^9$。\n\n---\n\n「魂归大海……」\n\n「你可以休息了……」\n\n「安息吧。」", "locale": "zh-CN"}}}
{"pid": "P7435", "type": "P", "difficulty": 6, "samples": [["3 3", "1 5 15 18"]], "limits": {"time": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "数学", "O2优化", "动态规划优化", "组合数学", "排列组合", "Stirling 数", "生成函数", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "简单的排列计数", "background": "", "description": "设 $\\text{inv}_{\\pi}$ 表示排列 $\\pi$ 的逆序对数。如果 $\\pi$ 长度为 $n$ 则有\n\n$$\\text{inv}_{\\pi}=\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=i+1}^{n}[\\pi_i>\\pi_j]$$\n\n给定两个正整数 $n,k$，和一个排列 $\\pi^\\prime$，定义一个长度为 $n$ 的排列 $\\pi$ 的权值 $\\text{val}_{\\pi}$ 为\n\n$$\\text{val}_{\\pi}=\\prod\\limits_{i=1}^{n}\\prod_{j=i+1}^{n}\\pi_i^{[\\pi_{i}>\\pi_j]}$$\n\n对于 $0\\leq m\\leq k$ 求\n\n$$\\sum\\limits_{\\pi}[\\text{inv}_\\pi=m]\\text{val}_\\pi$$\n\n其中 $\\pi$ 是长度为 $n$ 的排列。", "inputFormat": "第一行两个整数 $n,k$。", "outputFormat": "一行 $k+1$ 个整数，表示答案对 $998244353$ 取模的值。", "hint": "### 样例解释 1\n\n$$\\text{inv}_{(1,2,3)}=0,\\text{inv}_{(1,3,2)}=1,\\text{inv}_{(2,1,3)}=1,\\text{inv}_{(2,3,1)}=2,\\text{inv}_{(3,1,2)}=2,\\text{inv}_{(3,2,1)}=3$$\n\n$$\\text{val}_{(1,2,3)}=1,\\text{val}_{(1,3,2)}=3,\\text{val}_{(2,1,3)}=2,\\text{val}_{(2,3,1)}=6,\\text{val}_{(3,1,2)}=9,\\text{val}_{(3,2,1)}=18$$\n\n所以当 $m=0$ 时答案为 $1$，$m=1$ 时为 $5$， $m=2$ 时为 $15$，$m=3$ 时为 $18$。\n\n### 数据范围\n\n| 子任务编号 | 分值 | $n\\leq $ | $k\\leq $ |\n| :----------: | :----------: | :----------: | :----------: |\n| Subtask 1 | $1$ | $6$ |  |\n| Subtask 2 | $12$ | $40$ |  |\n| Subtask 3 | $1$ | $998244352$ | $1$ |\n| Subtask 4 | $16$ | $998244352$ | $10$ |\n| Subtask 5 | $24$ | $2\\times 10^5$ |  |\n| Subtask 6 | $46$ | $998244352$ |  |\n\n对于 $100\\%$ 的数据，$2\\leq n\\leq 998244352$，$1\\leq k\\leq \\min(2\\times 10^5,\\frac{n(n-1)}{2})。$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "简单的排列计数", "background": "", "description": "设 $\\text{inv}_{\\pi}$ 表示排列 $\\pi$ 的逆序对数。如果 $\\pi$ 长度为 $n$ 则有\n\n$$\\text{inv}_{\\pi}=\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=i+1}^{n}[\\pi_i>\\pi_j]$$\n\n给定两个正整数 $n,k$，和一个排列 $\\pi^\\prime$，定义一个长度为 $n$ 的排列 $\\pi$ 的权值 $\\text{val}_{\\pi}$ 为\n\n$$\\text{val}_{\\pi}=\\prod\\limits_{i=1}^{n}\\prod_{j=i+1}^{n}\\pi_i^{[\\pi_{i}>\\pi_j]}$$\n\n对于 $0\\leq m\\leq k$ 求\n\n$$\\sum\\limits_{\\pi}[\\text{inv}_\\pi=m]\\text{val}_\\pi$$\n\n其中 $\\pi$ 是长度为 $n$ 的排列。", "inputFormat": "第一行两个整数 $n,k$。", "outputFormat": "一行 $k+1$ 个整数，表示答案对 $998244353$ 取模的值。", "hint": "### 样例解释 1\n\n$$\\text{inv}_{(1,2,3)}=0,\\text{inv}_{(1,3,2)}=1,\\text{inv}_{(2,1,3)}=1,\\text{inv}_{(2,3,1)}=2,\\text{inv}_{(3,1,2)}=2,\\text{inv}_{(3,2,1)}=3$$\n\n$$\\text{val}_{(1,2,3)}=1,\\text{val}_{(1,3,2)}=3,\\text{val}_{(2,1,3)}=2,\\text{val}_{(2,3,1)}=6,\\text{val}_{(3,1,2)}=9,\\text{val}_{(3,2,1)}=18$$\n\n所以当 $m=0$ 时答案为 $1$，$m=1$ 时为 $5$， $m=2$ 时为 $15$，$m=3$ 时为 $18$。\n\n### 数据范围\n\n| 子任务编号 | 分值 | $n\\leq $ | $k\\leq $ |\n| :----------: | :----------: | :----------: | :----------: |\n| Subtask 1 | $1$ | $6$ |  |\n| Subtask 2 | $12$ | $40$ |  |\n| Subtask 3 | $1$ | $998244352$ | $1$ |\n| Subtask 4 | $16$ | $998244352$ | $10$ |\n| Subtask 5 | $24$ | $2\\times 10^5$ |  |\n| Subtask 6 | $46$ | $998244352$ |  |\n\n对于 $100\\%$ 的数据，$2\\leq n\\leq 998244352$，$1\\leq k\\leq \\min(2\\times 10^5,\\frac{n(n-1)}{2})。$", "locale": "zh-CN"}}}
{"pid": "P7436", "type": "P", "difficulty": 0, "samples": [["3 3 4 4\n1 1\n2 2\n3 3\n2 3", "5"], ["3 3 4 10000\n1 1\n2 2\n3 3\n2 3", "8"]], "limits": {"time": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["O2优化"], "title": "画矩形", "background": "扇贝宫主是一个初三的菜鸡，不擅长出毒瘤题。这天，Ta随手 A 了中国象棋这题，忽然灵光乍现...", "description": "扇贝宫主画了一个 $n \\times m$ 的矩形网格图。具体来说，包含坐标 $(x,y)$（$x\\in [0,n], y\\in [0,m]$）的所有整点以及所有连接距离为 $1$ 的点的边。\n\n这时，扇贝宫主突发奇想，想知道这个矩形里面能够绘制多少个周长不大于 $k$ 的矩形（矩形的四边必须平行于坐标轴）。但这即使作为签到题也未免太简单了些，于是扇贝宫主加入了 $q$ 个障碍点，要求选取的矩形**不包含**障碍点。每个障碍点都是一个 $1\\times 1$ 的正方形。现在扇贝宫主要继续出其他签（毒）到（瘤）题了，你能帮忙解决此题吗？答案对 $998244353$ 取模。", "inputFormat": "第 $1$ 行包含四个正整数 $n$，$m$，$q$ 和 $k$。\n\n接下来 $q$ 行，第 $i$ 行包含 $2$ 个数，分别为障碍物的 $x$ 坐标与 $y$ 坐标（一个坐标为 $(x,y)$ 的障碍点四个顶点为 $(x-1,y-1),(x-1,y),(x,y-1),(x,y)$）。", "outputFormat": "输出共一行一个整数，即矩形个数对 $998244353$ 取模的结果。", "hint": "#### 【样例解释】\n\n样例 #1：除了 $4$ 个障碍物格子之外剩下的格子都是合法的矩形。因此答案为 $3\\times 3-4=5$。\n\n样例 #2：即统计合法的矩形个数。$1\\times 1$ 的矩形有 $5$ 个，$1\\times 2$ 和 $2\\times 1$ 的矩形共 $3$ 个，因此答案为 $5+3=8$。\n\n#### 【数据范围】\n\n| 编号 | $n,m$ | $k$ | $q$ |\n| :----------: | :----------: | :----------: | :----------: |\n| $1,2$ | $\\le 10^3$ | $\\le 1.5\\times 10^9$ | $=0$ |\n| $3,4,5,6$ | $\\le 1.5\\times 10^9$ | $\\le 1.5\\times 10^9$ | $=0$ |\n| $7,8$ | $\\le 20$ | $\\le 1.5\\times 10^9$ | $\\le 20$ |\n| $9,10$ | $\\le 1.5\\times 10^9$ | $\\le 20$ | $\\le 20$ |\n| $11,12,13,14$ | $\\le 1.5\\times 10^9$ | $\\le 10^5$ | $\\le 20$ |\n| $15,16,17,18,19,20$ | $\\le 1.5\\times 10^9$ | $\\le 1.5\\times 10^9$ | $\\le 20$ |\n\n对于 $100\\%$ 的数据，$1\\le n,m \\le 1.5\\times 10^9$，$4\\le k \\le 1.5\\times 10^9$，$0\\le q \\le 20$。保证输入的障碍物合法且两两不同。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "画矩形", "background": "扇贝宫主是一个初三的菜鸡，不擅长出毒瘤题。这天，Ta随手 A 了中国象棋这题，忽然灵光乍现...", "description": "扇贝宫主画了一个 $n \\times m$ 的矩形网格图。具体来说，包含坐标 $(x,y)$（$x\\in [0,n], y\\in [0,m]$）的所有整点以及所有连接距离为 $1$ 的点的边。\n\n这时，扇贝宫主突发奇想，想知道这个矩形里面能够绘制多少个周长不大于 $k$ 的矩形（矩形的四边必须平行于坐标轴）。但这即使作为签到题也未免太简单了些，于是扇贝宫主加入了 $q$ 个障碍点，要求选取的矩形**不包含**障碍点。每个障碍点都是一个 $1\\times 1$ 的正方形。现在扇贝宫主要继续出其他签（毒）到（瘤）题了，你能帮忙解决此题吗？答案对 $998244353$ 取模。", "inputFormat": "第 $1$ 行包含四个正整数 $n$，$m$，$q$ 和 $k$。\n\n接下来 $q$ 行，第 $i$ 行包含 $2$ 个数，分别为障碍物的 $x$ 坐标与 $y$ 坐标（一个坐标为 $(x,y)$ 的障碍点四个顶点为 $(x-1,y-1),(x-1,y),(x,y-1),(x,y)$）。", "outputFormat": "输出共一行一个整数，即矩形个数对 $998244353$ 取模的结果。", "hint": "#### 【样例解释】\n\n样例 #1：除了 $4$ 个障碍物格子之外剩下的格子都是合法的矩形。因此答案为 $3\\times 3-4=5$。\n\n样例 #2：即统计合法的矩形个数。$1\\times 1$ 的矩形有 $5$ 个，$1\\times 2$ 和 $2\\times 1$ 的矩形共 $3$ 个，因此答案为 $5+3=8$。\n\n#### 【数据范围】\n\n| 编号 | $n,m$ | $k$ | $q$ |\n| :----------: | :----------: | :----------: | :----------: |\n| $1,2$ | $\\le 10^3$ | $\\le 1.5\\times 10^9$ | $=0$ |\n| $3,4,5,6$ | $\\le 1.5\\times 10^9$ | $\\le 1.5\\times 10^9$ | $=0$ |\n| $7,8$ | $\\le 20$ | $\\le 1.5\\times 10^9$ | $\\le 20$ |\n| $9,10$ | $\\le 1.5\\times 10^9$ | $\\le 20$ | $\\le 20$ |\n| $11,12,13,14$ | $\\le 1.5\\times 10^9$ | $\\le 10^5$ | $\\le 20$ |\n| $15,16,17,18,19,20$ | $\\le 1.5\\times 10^9$ | $\\le 1.5\\times 10^9$ | $\\le 20$ |\n\n对于 $100\\%$ 的数据，$1\\le n,m \\le 1.5\\times 10^9$，$4\\le k \\le 1.5\\times 10^9$，$0\\le q \\le 20$。保证输入的障碍物合法且两两不同。", "locale": "zh-CN"}}}
{"pid": "P7437", "type": "P", "difficulty": 6, "samples": [["4 5 2\n1 2\n1 3\n2 3\n2 4\n3 4", "374341633"], ["6 8 4\n1 2\n1 3\n2 3\n2 4\n2 5\n4 5\n4 6\n5 6", "374341633"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "生成树", "线性代数", "高斯消元", "状压 DP"], "title": "既见君子", "background": "友情客串：wygz（无忧公主）\n\nwygz 每次从进校到机房，都要尽量避开“屠夫”老师。然而，有一天，她忽然发现一些门上居然贴了“请勿从此门进出”的标签！", "description": "校园可以抽象成一张 $n$ 个点 $m$ 条无向边（可能有重边，无自环）的**连通**无向图，点从 $1$ 标号到 $n$。校门在 $1$ 号点，而机房在 $n$ 号点，屠老师的办公室在点 $z$（$z\\ne 1,n$）。\n\n然而，工作人员（~~其实是樱初音~~）封锁了其中的 $m-n+1$ 条边，使得剩余的图（包括所有点以及剩余的边）仍然连通，此时任意两点之间有且仅有一条简单路径。工作人员会**等概率地**选择一种封锁方案。（若 $m=n-1$ 则不封锁任何边，保持不变）\n\nwygz 当然不希望屠老师的办公室出现在她的必经之路上。她希望你算出从校门到机房的路径**必须**经过屠老师的办公室的概率。答案对 $998244353$ 取模。", "inputFormat": "第一行三个正整数 $n$、$m$ 和 $z$，表示点数、边数和屠老师的办公室的位置。\n\n以下 $m$ 行，每行两个正整数 $u$、$v$，表示一条连接 $u$ 和 $v$ 的无向边。", "outputFormat": "一行一个非负整数，表示答案对 $998244353$ 取模的结果。", "hint": "#### 样例解释：\n样例 #1：生成树共 $8$ 个，有 $5$ 个满足 $1$ 到 $4$ 经过 $2$。$\\dfrac 5 8\\equiv 374341633\\pmod {998244353}$。\n\n样例 #2：生成树共 $24$ 个，有 $15$ 个满足 $1$ 到 $6$ 经过 $4$。$\\dfrac {15} {24}\\equiv 374341633\\pmod {998244353}$。\n\n#### 数据范围：\n\n| 数据点编号 | $n$ | $m$ |\n| :----------: | :----------: | :----------: |\n| $1$ | $=3$ | $\\le 5$ |\n| $2$ | $=3$ | $\\le 10^5$ |\n| $3,4$ | $=7$ | $\\le 15$ |\n| $5,6$ | $=7$ | $\\le 10^5$ |\n| $7$ | $=20$ | $=n-1$ |\n| $8,9$ | $=20$ | $=n$ |\n| $10,11,12$ | $=18$ | $\\le 10^5$ |\n| $13,14,15,16$ | $=19$ | $\\le 10^5$ |\n| $17,18,19,20$ | $=20$ | $\\le 10^5$ |\n\n对 $100\\%$ 的数据，$3\\le n\\le 20$，$n-1\\le m\\le 10^5$，$z\\ne 1$ 且 $z\\ne n$。\n\n**数据保证输入的图的生成树个数模 $998244353$ 非零。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "既见君子", "background": "友情客串：wygz（无忧公主）\n\nwygz 每次从进校到机房，都要尽量避开“屠夫”老师。然而，有一天，她忽然发现一些门上居然贴了“请勿从此门进出”的标签！", "description": "校园可以抽象成一张 $n$ 个点 $m$ 条无向边（可能有重边，无自环）的**连通**无向图，点从 $1$ 标号到 $n$。校门在 $1$ 号点，而机房在 $n$ 号点，屠老师的办公室在点 $z$（$z\\ne 1,n$）。\n\n然而，工作人员（~~其实是樱初音~~）封锁了其中的 $m-n+1$ 条边，使得剩余的图（包括所有点以及剩余的边）仍然连通，此时任意两点之间有且仅有一条简单路径。工作人员会**等概率地**选择一种封锁方案。（若 $m=n-1$ 则不封锁任何边，保持不变）\n\nwygz 当然不希望屠老师的办公室出现在她的必经之路上。她希望你算出从校门到机房的路径**必须**经过屠老师的办公室的概率。答案对 $998244353$ 取模。", "inputFormat": "第一行三个正整数 $n$、$m$ 和 $z$，表示点数、边数和屠老师的办公室的位置。\n\n以下 $m$ 行，每行两个正整数 $u$、$v$，表示一条连接 $u$ 和 $v$ 的无向边。", "outputFormat": "一行一个非负整数，表示答案对 $998244353$ 取模的结果。", "hint": "#### 样例解释：\n样例 #1：生成树共 $8$ 个，有 $5$ 个满足 $1$ 到 $4$ 经过 $2$。$\\dfrac 5 8\\equiv 374341633\\pmod {998244353}$。\n\n样例 #2：生成树共 $24$ 个，有 $15$ 个满足 $1$ 到 $6$ 经过 $4$。$\\dfrac {15} {24}\\equiv 374341633\\pmod {998244353}$。\n\n#### 数据范围：\n\n| 数据点编号 | $n$ | $m$ |\n| :----------: | :----------: | :----------: |\n| $1$ | $=3$ | $\\le 5$ |\n| $2$ | $=3$ | $\\le 10^5$ |\n| $3,4$ | $=7$ | $\\le 15$ |\n| $5,6$ | $=7$ | $\\le 10^5$ |\n| $7$ | $=20$ | $=n-1$ |\n| $8,9$ | $=20$ | $=n$ |\n| $10,11,12$ | $=18$ | $\\le 10^5$ |\n| $13,14,15,16$ | $=19$ | $\\le 10^5$ |\n| $17,18,19,20$ | $=20$ | $\\le 10^5$ |\n\n对 $100\\%$ 的数据，$3\\le n\\le 20$，$n-1\\le m\\le 10^5$，$z\\ne 1$ 且 $z\\ne n$。\n\n**数据保证输入的图的生成树个数模 $998244353$ 非零。**", "locale": "zh-CN"}}}
{"pid": "P7438", "type": "P", "difficulty": 7, "samples": [["3 2\n0 1", "0 1 2"], ["6 4\n11 43 27 7", "0 88 176 1311 7332 53070"]], "limits": {"time": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "数学", "递推", "O2优化", "置换", "组合数学", "排列组合", "前缀和", "二项式定理", "生成函数", "线性递推", "微积分", "导数", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "更简单的排列计数", "background": "", "description": "设 $\\text{cyc}_\\pi$ 将长为 $n$ 的排列 $\\pi$ 当成置换时所能分解成的循环个数。给定两个整数 $n,k$ 和一个 $k-1$ 次多项式，对 $1\\leq m\\leq n$ 求：\n\n$$\n\\sum\\limits_{\\pi}F(\\text{cyc}_{\\pi})\n$$\n\n其中 $\\pi$ 是长度为 $m$ 且不存在位置 $i$ 使得 $\\pi_i=i$ 的排列。", "inputFormat": "第一行两个整数，表示 $n$ 和 $k$。\n\n第二行 $k$ 个整数，从低到高给出多项式的系数。", "outputFormat": "一行 $n$ 个整数，表示答案对 $998244353$ 取模的值。", "hint": "### 样例解释 1\n\n下面是当 $m=1,2,3$ 时满足要求的所有排列：\n\n$\\text{cyc}_{(2,1)}=1,\\text{cyc}_{(2,3,1)}=1,\\text{cyc}_{(3,1,2)}=1$。\n所以当 $m=1$ 时答案为 $0$，$m=2$ 时为 $1$，$m=3$ 时为 $2$。\n\n### 数据范围\n\n| 子任务编号 | 分值 | $n\\leq$ | $k\\leq$ | 其他限制 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| Subtask 1 | $1$ | $10$ | $6$ |  |\n| Subtask 2 | $5$ | $2\\times 10^3$ | $6$ |  |\n| Subtask 3 | $6$ | $2\\times 10^5$ | $1$ |  |\n| Subtask 4 | $16$ | $2\\times 10^5$ | $6$ | $F(x)=x^k$ |\n| Subtask 5 | $16$ | $2\\times 10^5$ | $3$ |  |\n| Subtask 6 | $56$ | $6\\times 10^5$ | $100$ |  |\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 6\\times 10^5$，$1\\leq k\\leq 100$，$0\\leq [x^k]F(x)\\leq 998244352$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "更简单的排列计数", "background": "", "description": "设 $\\text{cyc}_\\pi$ 将长为 $n$ 的排列 $\\pi$ 当成置换时所能分解成的循环个数。给定两个整数 $n,k$ 和一个 $k-1$ 次多项式，对 $1\\leq m\\leq n$ 求：\n\n$$\n\\sum\\limits_{\\pi}F(\\text{cyc}_{\\pi})\n$$\n\n其中 $\\pi$ 是长度为 $m$ 且不存在位置 $i$ 使得 $\\pi_i=i$ 的排列。", "inputFormat": "第一行两个整数，表示 $n$ 和 $k$。\n\n第二行 $k$ 个整数，从低到高给出多项式的系数。", "outputFormat": "一行 $n$ 个整数，表示答案对 $998244353$ 取模的值。", "hint": "### 样例解释 1\n\n下面是当 $m=1,2,3$ 时满足要求的所有排列：\n\n$\\text{cyc}_{(2,1)}=1,\\text{cyc}_{(2,3,1)}=1,\\text{cyc}_{(3,1,2)}=1$。\n所以当 $m=1$ 时答案为 $0$，$m=2$ 时为 $1$，$m=3$ 时为 $2$。\n\n### 数据范围\n\n| 子任务编号 | 分值 | $n\\leq$ | $k\\leq$ | 其他限制 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| Subtask 1 | $1$ | $10$ | $6$ |  |\n| Subtask 2 | $5$ | $2\\times 10^3$ | $6$ |  |\n| Subtask 3 | $6$ | $2\\times 10^5$ | $1$ |  |\n| Subtask 4 | $16$ | $2\\times 10^5$ | $6$ | $F(x)=x^k$ |\n| Subtask 5 | $16$ | $2\\times 10^5$ | $3$ |  |\n| Subtask 6 | $56$ | $6\\times 10^5$ | $100$ |  |\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 6\\times 10^5$，$1\\leq k\\leq 100$，$0\\leq [x^k]F(x)\\leq 998244352$。", "locale": "zh-CN"}}}
{"pid": "P7439", "type": "P", "difficulty": 7, "samples": [["3 2\n0 1", "2"], ["6 4\n11 43 27 7", "53070"], ["6 4\n9 72 22 7", "60990"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "数学", "递推", "O2优化", "置换", "组合数学", "排列组合", "二项式定理", "生成函数", "微积分", "导数", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "「KrOI2021」Feux Follets 弱化版", "background": "", "description": "设 $\\text{cyc}_\\pi$ 将长为 $n$ 的排列 $\\pi$ 当成置换时所能分解成的循环个数。给定两个整数 $n,k$ 和一个 $k-1$ 次多项式，求：\n\n$$\n\\sum\\limits_{\\pi}F(\\text{cyc}_{\\pi})\n$$\n\n其中 $\\pi$ 是长度为 $n$ 且不存在位置 $i$ 使得 $\\pi_i=i$ 的排列。", "inputFormat": "第一行两个整数，表示 $n$ 和 $k$。\n\n第二行 $k$ 个整数，从低到高给出多项式的系数。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模的值。", "hint": "### 数据范围\n\n对于 $100\\%$ 的数据，$1\\leq n,k\\leq 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「KrOI2021」Feux Follets 弱化版", "background": "", "description": "设 $\\text{cyc}_\\pi$ 将长为 $n$ 的排列 $\\pi$ 当成置换时所能分解成的循环个数。给定两个整数 $n,k$ 和一个 $k-1$ 次多项式，求：\n\n$$\n\\sum\\limits_{\\pi}F(\\text{cyc}_{\\pi})\n$$\n\n其中 $\\pi$ 是长度为 $n$ 且不存在位置 $i$ 使得 $\\pi_i=i$ 的排列。", "inputFormat": "第一行两个整数，表示 $n$ 和 $k$。\n\n第二行 $k$ 个整数，从低到高给出多项式的系数。", "outputFormat": "一行一个整数，表示答案对 $998244353$ 取模的值。", "hint": "### 数据范围\n\n对于 $100\\%$ 的数据，$1\\leq n,k\\leq 10^5$。", "locale": "zh-CN"}}}
