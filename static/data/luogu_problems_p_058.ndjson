{"pid": "P2166", "type": "P", "difficulty": 6, "samples": [["2\n1 2\n10 20\n1\n0 1 5\n", "2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["平衡树"], "title": "Gty的超级妹子树【数据疑似有误】", "background": "我曾在青山之中遇过你，  \n新竹做杖，鬓插紫茱萸。  \n跣足踏过无边丝雨，  \n又拾起燕川雪片片落如席……\n\nGty神(xian)犇(chong)从来不缺妹子……\n\n他又来到了一棵妹子树下，发现每个妹子有一个美丽度……\n\n\n由于Gty很 哲♂学 也很 机♂智，他只对美丽度大于某个值的妹子感兴趣。  \n他想知道某个子树中美丽度大于 $x$ 的妹子个数。\n\n某个妹子的美丽度可能发生变化……\n\n树上可能会出现一只新的妹子……\n\n但是……树枝可能会断裂，于是，Gty 惊讶地发现，他的面前变成了一片妹子树组成的森林……\n\n", "description": "维护一棵初始有 $n$ 个节点的有根树（根节点为 $1$），树上节点编号为 $1 \\sim n$，每个点有一个权值 $w_i$，它可能会变成森林。\n\n\n支持以下操作：\n\n- `0 u x` 询问以 $u$ 为根的子树中，严格大于 $x$ 的值的个数。\n- `1 u x`  把 $u$ 节点的权值改成 $x$。\n- `2 u x`  添加一个编号为“当前树中节点数+1”的节点，其父节点为 $u$，其权值为 $x$。\n- `3 u` 删除 $u$ 与其父亲的边，并使 $u$ 变为其所在连通块的根。\n\n**本题强制在线。**\n\n所有输入的 $u,x$ 都需要异或 $\\text{last}$ 才是真正的输入。其中 $\\text{last}$ 为上一次询问的答案，定义初始 $\\text{last} = 0$。", "inputFormat": "第一行一个正整数 $n$，表示初始节点数。 \n\n接下来 $n-1$ 行，每行两个整数 $u,v$，为树上的一条无向边。\n\n接下来一行 $n$ 个整数 $w_i$，表示初始时每个节点的权值。\n\n接着一行一个正整数 $m$，表示操作个数。\n\n接下来 $m$ 行，每行若干个整数，表示一次操作。\n", "outputFormat": "对每个 $\\text{op}=0$ 的操作，输出一行，包括一个整数，意义见题目描述。\n", "hint": "### 数据范围及约定\n\n对于 $100\\%$ 的数据，$1\\le n,m \\le 10^5$，$1\\le u \\le n$，$0 \\le w_i,x < 2^{31}$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Gty’s Super Girl Tree [Testdata Suspected Incorrect]", "background": "I once met you among the green hills,  \nLeaning on a new bamboo staff, with purple cornels in your hair.  \nBarefoot, you stepped through the boundless drizzling rain,  \nThen picked up the drifting snowflakes of Yanchuan, falling like a mat...\n\nGty, the godlike (xian) bull (chong), never lacks girls...\n\nHe comes to a “girl tree” again and finds that each girl has a beauty value...\n\nSince Gty is very zhe♂xue and very ji♂zhi, he is only interested in girls whose beauty value is greater than a certain threshold.  \nHe wants to know the number of girls with beauty value greater than $x$ in a certain subtree.\n\nA girl’s beauty value may change...\n\nA new girl may appear on the tree...\n\nHowever... a branch may break. Thus, to Gty’s surprise, what lies before him becomes a forest made of girl trees...", "description": "Maintain a rooted tree with $n$ initial nodes (the root is $1$). Nodes are labeled $1$ to $n$, and each node has a weight $w_i$. The tree may become a forest.\n\nSupport the following operations:\n\n- `0 u x` Query the number of values strictly greater than $x$ in the subtree rooted at $u$.\n- `1 u x` Set the weight of node $u$ to $x$.\n- `2 u x` Add a new node whose id is the current number of nodes plus $1$, with parent $u$ and weight $x$.\n- `3 u` Delete the edge between $u$ and its parent, and make $u$ the root of its connected component.\n\n**This problem is strictly online.**\n\nAll input $u, x$ must be XORed with $\\text{last}$ to get the real input, where $\\text{last}$ is the previous query’s answer, and initially $\\text{last} = 0$.", "inputFormat": "The first line contains a positive integer $n$, the initial number of nodes.\n\nThe next $n - 1$ lines each contain two integers $u, v$, indicating an undirected edge in the tree.\n\nThe next line contains $n$ integers $w_i$, the initial weight of each node.\n\nThe next line contains a positive integer $m$, the number of operations.\n\nThe next $m$ lines each describe one operation, as specified above.", "outputFormat": "For each operation with $\\text{op} = 0$, output one line with a single integer, as described in the problem statement.", "hint": "Constraints\n\nFor $100\\%$ of the testdata, $1 \\le n, m \\le 10^5$, $1 \\le u \\le n$, $0 \\le w_i, x < 2^{31}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Gty的超级妹子树【数据疑似有误】", "background": "我曾在青山之中遇过你，  \n新竹做杖，鬓插紫茱萸。  \n跣足踏过无边丝雨，  \n又拾起燕川雪片片落如席……\n\nGty神(xian)犇(chong)从来不缺妹子……\n\n他又来到了一棵妹子树下，发现每个妹子有一个美丽度……\n\n\n由于Gty很 哲♂学 也很 机♂智，他只对美丽度大于某个值的妹子感兴趣。  \n他想知道某个子树中美丽度大于 $x$ 的妹子个数。\n\n某个妹子的美丽度可能发生变化……\n\n树上可能会出现一只新的妹子……\n\n但是……树枝可能会断裂，于是，Gty 惊讶地发现，他的面前变成了一片妹子树组成的森林……\n\n", "description": "维护一棵初始有 $n$ 个节点的有根树（根节点为 $1$），树上节点编号为 $1 \\sim n$，每个点有一个权值 $w_i$，它可能会变成森林。\n\n\n支持以下操作：\n\n- `0 u x` 询问以 $u$ 为根的子树中，严格大于 $x$ 的值的个数。\n- `1 u x`  把 $u$ 节点的权值改成 $x$。\n- `2 u x`  添加一个编号为“当前树中节点数+1”的节点，其父节点为 $u$，其权值为 $x$。\n- `3 u` 删除 $u$ 与其父亲的边，并使 $u$ 变为其所在连通块的根。\n\n**本题强制在线。**\n\n所有输入的 $u,x$ 都需要异或 $\\text{last}$ 才是真正的输入。其中 $\\text{last}$ 为上一次询问的答案，定义初始 $\\text{last} = 0$。", "inputFormat": "第一行一个正整数 $n$，表示初始节点数。 \n\n接下来 $n-1$ 行，每行两个整数 $u,v$，为树上的一条无向边。\n\n接下来一行 $n$ 个整数 $w_i$，表示初始时每个节点的权值。\n\n接着一行一个正整数 $m$，表示操作个数。\n\n接下来 $m$ 行，每行若干个整数，表示一次操作。\n", "outputFormat": "对每个 $\\text{op}=0$ 的操作，输出一行，包括一个整数，意义见题目描述。\n", "hint": "### 数据范围及约定\n\n对于 $100\\%$ 的数据，$1\\le n,m \\le 10^5$，$1\\le u \\le n$，$0 \\le w_i,x < 2^{31}$。\n", "locale": "zh-CN"}}}
{"pid": "P2167", "type": "P", "difficulty": 5, "samples": [["5\n3 3\n???r???\n???????\n???????\n3 4\n???????\n?????a?\n???????\n3 3\n???????\n?a??j??\n????aa?\n3 2\na??????\n???????\n???????\n3 2\n???????\n???a???\n????a??", "914852\n0\n0\n871234\n67018"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2009", "各省省选", "山东", "枚举", "容斥原理", "状压 DP"], "title": "[SDOI2009] Bill的挑战", "background": null, "description": "Sheng_bill 不仅有惊人的心算能力，还可以轻松地完成各种统计。在昨天的比赛中，你凭借优秀的程序与他打成了平局，这导致 Sheng_bill  极度的不满。于是他再次挑战你。这次你可不能输。\n\n这次，比赛规则是这样的：\n\n给出 $N$ 个长度相同的字符串（由小写英文字母和 `?` 组成），$S_1,S_2,\\dots,S_N$，求与这 $N$ 个串中的刚好 $K$ 个串匹配的字符串 $T$ 的个数，答案对 $1000003$ 取模。\n\n若字符串 $S_x(1\\le x\\le N)$ 和 $T$ 匹配，满足以下条件：\n1. $|S_x|=|T|$。\n2. 对于任意的 $1\\le i\\le|S_x|$，满足 $S_x[i]= \\texttt{?}$ 或者 $S_x[i]=T[i]$。\n\n其中 $T$ 只包含小写英文字母。", "inputFormat": "**本题包含多组数据**。\n\n第一行一个整数 $T$，表示数据组数。 \n\n对于每组数据，第一行两个整数，$N$ 和 $K$。 \n\n接下来 $N$ 行，每行一个字符串 $S_i$。", "outputFormat": "每组数据输出一行一个整数，表示答案。", "hint": "### 数据规模与约定\n- 对于 $30\\%$ 的数据，$N\\le5$，$|S_i|\\le20$；\n- 对于 $70\\%$ 的数据，$N\\le13$，$|S_i|\\le30$；\n- 对于 $100\\%$ 的数据，$1\\le T\\le 5$，$1\\le N \\le15$，$1\\le|S_i|\\le50$。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2009] Bill's Challenge", "background": "", "description": "Sheng_bill not only has amazing mental arithmetic, but can also easily handle various statistics. In yesterday's contest, you tied with him thanks to your excellent program, which made Sheng_bill extremely displeased. So he challenges you again. This time, you must not lose.\n\nThe rules are as follows:\n\nGiven $N$ strings of the same length (composed of lowercase English letters and `?`), $S_1, S_2, \\dots, S_N$, count the number of strings $T$ that match exactly $K$ of these $N$ strings. Output the answer modulo $1000003$.\n\nA string $S_x$ ($1 \\le x \\le N$) matches $T$ if the following conditions hold:\n1. $|S_x| = |T|$.\n2. For any $1 \\le i \\le |S_x|$, either $S_x[i] = \\texttt{?}$ or $S_x[i] = T[i]$.\n\nHere $T$ contains only lowercase English letters.", "inputFormat": "This problem contains multiple test cases.\n\nThe first line contains an integer $T$, the number of test cases.\n\nFor each test case, the first line contains two integers, $N$ and $K$.\n\nThe next $N$ lines each contain a string $S_i$.", "outputFormat": "For each test case, output a single line with one integer, the answer.", "hint": "Constraints and Conventions:\n- For $30\\%$ of the testdata, $N \\le 5$, $|S_i| \\le 20$.\n- For $70\\%$ of the testdata, $N \\le 13$, $|S_i| \\le 30$.\n- For $100\\%$ of the testdata, $1 \\le T \\le 5$, $1 \\le N \\le 15$, $1 \\le |S_i| \\le 50$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2009] Bill的挑战", "background": null, "description": "Sheng_bill 不仅有惊人的心算能力，还可以轻松地完成各种统计。在昨天的比赛中，你凭借优秀的程序与他打成了平局，这导致 Sheng_bill  极度的不满。于是他再次挑战你。这次你可不能输。\n\n这次，比赛规则是这样的：\n\n给出 $N$ 个长度相同的字符串（由小写英文字母和 `?` 组成），$S_1,S_2,\\dots,S_N$，求与这 $N$ 个串中的刚好 $K$ 个串匹配的字符串 $T$ 的个数，答案对 $1000003$ 取模。\n\n若字符串 $S_x(1\\le x\\le N)$ 和 $T$ 匹配，满足以下条件：\n1. $|S_x|=|T|$。\n2. 对于任意的 $1\\le i\\le|S_x|$，满足 $S_x[i]= \\texttt{?}$ 或者 $S_x[i]=T[i]$。\n\n其中 $T$ 只包含小写英文字母。", "inputFormat": "**本题包含多组数据**。\n\n第一行一个整数 $T$，表示数据组数。 \n\n对于每组数据，第一行两个整数，$N$ 和 $K$。 \n\n接下来 $N$ 行，每行一个字符串 $S_i$。", "outputFormat": "每组数据输出一行一个整数，表示答案。", "hint": "### 数据规模与约定\n- 对于 $30\\%$ 的数据，$N\\le5$，$|S_i|\\le20$；\n- 对于 $70\\%$ 的数据，$N\\le13$，$|S_i|\\le30$；\n- 对于 $100\\%$ 的数据，$1\\le T\\le 5$，$1\\le N \\le15$，$1\\le|S_i|\\le50$。", "locale": "zh-CN"}}}
{"pid": "P2168", "type": "P", "difficulty": 5, "samples": [["4 2\n1\n1\n2\n2\n", "12\n2"], ["6 3\n1\n1\n3\n3\n9\n9\n", "36\n3\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2015", "堆", "NOI", "优先队列", "霍夫曼树"], "title": "[NOI2015] 荷马史诗", "background": "> 追逐影子的人，自己就是影子 —— 荷马", "description": "Allison 最近迷上了文学。她喜欢在一个慵懒的午后，细细地品上一杯卡布奇诺，静静地阅读她爱不释手的《荷马史诗》。但是由《奥德赛》和《伊利亚特》 组成的鸿篇巨制《荷马史诗》实在是太长了，Allison 想通过一种编码方式使得它变得短一些。\n\n一部《荷马史诗》中有 $n$ 种不同的单词，从 $1$ 到 $n$ 进行编号。其中第 $i$ 种单词出现的总次数为 $w_i$。Allison 想要用 $k$ 进制串 $s_i$ 来替换第 $i$ 种单词，使得其满足如下要求：\n\n对于任意的 $1\\leq i, j\\leq n$ ，$i\\ne j$ ，都有：$s_i$ 不是 $s_j$ 的前缀。\n\n现在 Allison 想要知道，如何选择 $s_i$，才能使替换以后得到的新的《荷马史诗》长度最小。在确保总长度最小的情况下，Allison 还想知道最长的 $s_i$ 的最短长度是多少？\n\n一个字符串被称为 $k$ 进制字符串，当且仅当它的每个字符是 $0$ 到 $k-1$ 之间（包括 $0$ 和 $k-1$ ）的整数。\n\n字符串 $str1$ 被称为字符串 $str2$ 的前缀，当且仅当：存在 $1 \\leq t\\leq m$ ，使得 $str1 = str2[1..t]$。其中，$m$ 是字符串 $str2$ 的长度，$str2[1..t]$ 表示 $str2$ 的前 $t$ 个字符组成的字符串。", "inputFormat": "输入的第 $1$ 行包含 $2$ 个正整数 $n, k$ ，中间用单个空格隔开，表示共有 $n$ 种单词，需要使用 $k$ 进制字符串进行替换。\n\n接下来 $n$ 行，第 $i + 1$ 行包含 $1$ 个非负整数 $w_i$，表示第 $i$ 种单词的出现次数。", "outputFormat": "输出包括 $2$ 行。\n\n第 $1$ 行输出 $1$ 个整数，为《荷马史诗》经过重新编码以后的最短长度。\n\n第 $2$ 行输出 $1$ 个整数，为保证最短总长度的情况下，最长字符串 $s_i$ 的最短长度。", "hint": "#### 【样例解释】\n\n#### 样例 1 解释\n\n用 $X(k)$ 表示 $X$ 是以 $k$ 进制表示的字符串。\n\n一种最优方案：令 $00(2)$ 替换第 $1$ 种单词， $01(2)$ 替换第 $2$ 种单词， $10(2)$ 替换第 $3$ 种单词，$11(2)$ 替换第 $4$ 种单词。在这种方案下，编码以后的最短长度为：\n\n$$1 × 2 + 1 × 2 + 2 × 2 + 2 × 2 = 12$$\n\n最长字符串 $s_i$ 的长度为 $2$ 。\n\n一种非最优方案：令 $000(2)$ 替换第 $1$ 种单词，$001(2)$ 替换第 $2$ 种单词，$01(2)$ 替换第 $3$ 种单词，$1(2)$ 替换第 $4$ 种单词。在这种方案下，编码以后的最短长度为：\n\n$$1 × 3 + 1 × 3 + 2 × 2 + 2 × 1 = 12$$\n\n最长字符串 $s_i$ 的长度为 $3$ 。与最优方案相比，文章的长度相同，但是最长字符串的长度更长一些。\n\n#### 样例 2 解释\n\n一种最优方案：令 $000(3)$ 替换第 $1$ 种单词，$001(3)$ 替换第 $2$ 种单词，$01(3)$ 替换第 $3$ 种单词， $02(3)$ 替换第 $4$ 种单词， $1(3)$ 替换第 $5$ 种单词， $2(3)$ 替换第 $6$ 种单词。\n\n#### 【数据规模与约定】\n\n所有测试数据的范围和特点如下表所示（所有数据均满足 $0 < w_i \\leq 10^{11}$）：\n\n::cute-table{tuack}\n\n| 测试点编号 |  $n$ 的规模  | $k$ 的规模 |            备注            |\n| :--------: | :----------: | :--------: | :------------------------: |\n|    $1$     |    $n=3$     |   $k=2$    |                            |\n|    $2$     |    $n=5$     |   ^        | ^                          |\n|    $3$     |    $n=16$    |   ^        |     所有 $w_i$ 均相等      |\n|    $4$     |  $n=1\\,000$  |   ^        | $w_i$ 在取值范围内均匀随机 |\n|    $5$     |  ^           |   ^        |                            |\n|    $6$     | $n=100\\,000$ |   ^        | ^                          |\n|    $7$     | ^            |   ^        |     所有 $w_i$ 均相等      |\n|    $8$     | ^            |   ^        |                            |\n|    $9$     |    $n=7$     |   $k=3$    | ^                          |\n|    $10$    |    $n=16$    |   ^        |     所有 $w_i$ 均相等      |\n|    $11$    |  $n=1\\,001$  |   ^        |     ^                      |\n|    $12$    | $n=99\\,999$  |   $k=4$    |     ^                      |\n|    $13$    | $n=100\\,000$ |   ^        | ^                          |\n|    $14$    | ^            |   ^        | ^                          |\n|    $15$    |  $n=1\\,000$  |   $k=5$    | ^                          |\n|    $16$    | $n=100\\,000$ |   $k=7$    | $w_i$ 在取值范围内均匀随机 |\n|    $17$    | ^            |   ^        |                            |\n|    $18$    | ^            |   $k=8$    | $w_i$ 在取值范围内均匀随机 |\n|    $19$    | ^            |   $k=9$    |                            |\n|    $20$    | ^            |   ^        | ^                          |\n\n#### 【提示】\n\n选手请注意使用 64 位整数进行输入输出、存储和计算。\n\n#### 【评分方式】\n\n对于每个测试点：\n\n- 若输出文件的第 $1$ 行正确，得到该测试点 $40\\%$ 的分数；\n- 若输出文件完全正确，得到该测试点 $100\\%$ 的分数。", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2015] Homer’s Epic", "background": "> He who chases a shadow is himself a shadow —— Homer.", "description": "Allison has recently become obsessed with literature. On a lazy afternoon, she likes to slowly sip a cappuccino and quietly read her beloved Homer’s Epic. However, the grand work composed of The Odyssey and The Iliad is just too long, so Allison wants to shorten it by using an encoding method.\n\nIn one Homer’s Epic, there are $n$ distinct words, numbered from $1$ to $n$. The total number of occurrences of the $i$-th word is $w_i$. Allison wants to replace the $i$-th word with a base-$k$ string $s_i$ such that the following condition holds:\n\nFor any $1 \\leq i, j \\leq n$, $i \\ne j$, we have: $s_i$ is not a prefix of $s_j$.\n\nNow Allison wants to know how to choose $s_i$ to minimize the length of the new Homer’s Epic after replacement. Among all choices that minimize the total length, she also wants to know the minimal possible value of the maximum length among all $s_i$.\n\nA string is called a base-$k$ string if and only if each of its characters is an integer between $0$ and $k-1$ inclusive.\n\nA string $str1$ is called a prefix of a string $str2$ if and only if there exists $1 \\leq t \\leq m$ such that $str1 = str2[1..t]$. Here, $m$ is the length of $str2$, and $str2[1..t]$ denotes the string consisting of the first $t$ characters of $str2$.", "inputFormat": "The first line contains $2$ positive integers $n, k$, separated by a single space, indicating that there are $n$ types of words and base-$k$ strings are to be used for replacement.\n\nThe next $n$ lines: the $(i+1)$-th line contains $1$ positive integer $w_i$, indicating the number of occurrences of the $i$-th word.", "outputFormat": "Output consists of $2$ lines.\n\nThe first line contains $1$ integer, the minimal total length of Homer’s Epic after re-encoding.\n\nThe second line contains $1$ integer, the minimal possible value of the maximum length among all $s_i$ under the condition that the total length is minimized.", "hint": "Sample Explanation\n\nSample 1 explanation\n\nLet $X(k)$ denote that $X$ is a base-$k$ string.\n\nOne optimal scheme: let $00(2)$ replace the $1$-st word, $01(2)$ replace the $2$-nd word, $10(2)$ replace the $3$-rd word, and $11(2)$ replace the $4$-th word. Under this scheme, the minimal encoded length is:\n$$1 × 2 + 1 × 2 + 2 × 2 + 2 × 2 = 12$$\nThe maximum length of $s_i$ is $2$.\n\nA non-optimal scheme: let $000(2)$ replace the $1$-st word, $001(2)$ replace the $2$-nd word, $01(2)$ replace the $3$-rd word, and $1(2)$ replace the $4$-th word. Under this scheme, the minimal encoded length is:\n$$1 × 3 + 1 × 3 + 2 × 2 + 2 × 1 = 12$$\nThe maximum length of $s_i$ is $3$. Compared with the optimal scheme, the article length is the same, but the maximum codeword length is larger.\n\nSample 2 explanation\n\nOne optimal scheme: let $000(3)$ replace the $1$-st word, $001(3)$ replace the $2$-nd word, $01(3)$ replace the $3$-rd word, $02(3)$ replace the $4$-th word, $1(3)$ replace the $5$-th word, and $2(3)$ replace the $6$-th word.\n\nConstraints\n\nAll testdata ranges and characteristics are as follows (all data satisfy $0 < w_i \\leq 10^{11}$):\n| Test No. | Scale of $n$ | Scale of $k$ | Remarks |\n| :------: | :-----------: | :----------: | :-----: |\n| $1$ | $n=3$ | $k=2$ | |\n| $2$ | $n=5$ | ^ | ^ |\n| $3$ | $n=16$ | ^ | All $w_i$ are equal |\n| $4$ | $n=1\\,000$ | ^ | $w_i$ are uniformly random within the range |\n| $5$ | ^ | ^ | |\n| $6$ | $n=100\\,000$ | ^ | ^ |\n| $7$ | ^ | ^ | All $w_i$ are equal |\n| $8$ | ^ | ^ | |\n| $9$ | $n=7$ | $k=3$ | ^ |\n| $10$ | $n=16$ | ^ | All $w_i$ are equal |\n| $11$ | $n=1\\,001$ | ^ | ^ |\n| $12$ | $n=99\\,999$ | $k=4$ | ^ |\n| $13$ | $n=100\\,000$ | ^ | ^ |\n| $14$ | ^ | ^ | ^ |\n| $15$ | $n=1\\,000$ | $k=5$ | ^ |\n| $16$ | $n=100\\,000$ | $k=7$ | $w_i$ are uniformly random within the range |\n| $17$ | ^ | ^ | |\n| $18$ | ^ | $k=8$ | $w_i$ are uniformly random within the range |\n| $19$ | ^ | $k=9$ | |\n| $20$ | ^ | ^ | ^ |\n\nAdditional Tips\n\nContestants should use 64-bit integers for input, output, storage, and computation.\n\nScoring\n\nFor each test point:\n- If the first line of the output is correct, you will receive $40\\%$ of the score for that test point.\n- If the entire output is correct, you will receive $100\\%$ of the score.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2015] 荷马史诗", "background": "> 追逐影子的人，自己就是影子 —— 荷马", "description": "Allison 最近迷上了文学。她喜欢在一个慵懒的午后，细细地品上一杯卡布奇诺，静静地阅读她爱不释手的《荷马史诗》。但是由《奥德赛》和《伊利亚特》 组成的鸿篇巨制《荷马史诗》实在是太长了，Allison 想通过一种编码方式使得它变得短一些。\n\n一部《荷马史诗》中有 $n$ 种不同的单词，从 $1$ 到 $n$ 进行编号。其中第 $i$ 种单词出现的总次数为 $w_i$。Allison 想要用 $k$ 进制串 $s_i$ 来替换第 $i$ 种单词，使得其满足如下要求：\n\n对于任意的 $1\\leq i, j\\leq n$ ，$i\\ne j$ ，都有：$s_i$ 不是 $s_j$ 的前缀。\n\n现在 Allison 想要知道，如何选择 $s_i$，才能使替换以后得到的新的《荷马史诗》长度最小。在确保总长度最小的情况下，Allison 还想知道最长的 $s_i$ 的最短长度是多少？\n\n一个字符串被称为 $k$ 进制字符串，当且仅当它的每个字符是 $0$ 到 $k-1$ 之间（包括 $0$ 和 $k-1$ ）的整数。\n\n字符串 $str1$ 被称为字符串 $str2$ 的前缀，当且仅当：存在 $1 \\leq t\\leq m$ ，使得 $str1 = str2[1..t]$。其中，$m$ 是字符串 $str2$ 的长度，$str2[1..t]$ 表示 $str2$ 的前 $t$ 个字符组成的字符串。", "inputFormat": "输入的第 $1$ 行包含 $2$ 个正整数 $n, k$ ，中间用单个空格隔开，表示共有 $n$ 种单词，需要使用 $k$ 进制字符串进行替换。\n\n接下来 $n$ 行，第 $i + 1$ 行包含 $1$ 个非负整数 $w_i$，表示第 $i$ 种单词的出现次数。", "outputFormat": "输出包括 $2$ 行。\n\n第 $1$ 行输出 $1$ 个整数，为《荷马史诗》经过重新编码以后的最短长度。\n\n第 $2$ 行输出 $1$ 个整数，为保证最短总长度的情况下，最长字符串 $s_i$ 的最短长度。", "hint": "#### 【样例解释】\n\n#### 样例 1 解释\n\n用 $X(k)$ 表示 $X$ 是以 $k$ 进制表示的字符串。\n\n一种最优方案：令 $00(2)$ 替换第 $1$ 种单词， $01(2)$ 替换第 $2$ 种单词， $10(2)$ 替换第 $3$ 种单词，$11(2)$ 替换第 $4$ 种单词。在这种方案下，编码以后的最短长度为：\n\n$$1 × 2 + 1 × 2 + 2 × 2 + 2 × 2 = 12$$\n\n最长字符串 $s_i$ 的长度为 $2$ 。\n\n一种非最优方案：令 $000(2)$ 替换第 $1$ 种单词，$001(2)$ 替换第 $2$ 种单词，$01(2)$ 替换第 $3$ 种单词，$1(2)$ 替换第 $4$ 种单词。在这种方案下，编码以后的最短长度为：\n\n$$1 × 3 + 1 × 3 + 2 × 2 + 2 × 1 = 12$$\n\n最长字符串 $s_i$ 的长度为 $3$ 。与最优方案相比，文章的长度相同，但是最长字符串的长度更长一些。\n\n#### 样例 2 解释\n\n一种最优方案：令 $000(3)$ 替换第 $1$ 种单词，$001(3)$ 替换第 $2$ 种单词，$01(3)$ 替换第 $3$ 种单词， $02(3)$ 替换第 $4$ 种单词， $1(3)$ 替换第 $5$ 种单词， $2(3)$ 替换第 $6$ 种单词。\n\n#### 【数据规模与约定】\n\n所有测试数据的范围和特点如下表所示（所有数据均满足 $0 < w_i \\leq 10^{11}$）：\n\n::cute-table{tuack}\n\n| 测试点编号 |  $n$ 的规模  | $k$ 的规模 |            备注            |\n| :--------: | :----------: | :--------: | :------------------------: |\n|    $1$     |    $n=3$     |   $k=2$    |                            |\n|    $2$     |    $n=5$     |   ^        | ^                          |\n|    $3$     |    $n=16$    |   ^        |     所有 $w_i$ 均相等      |\n|    $4$     |  $n=1\\,000$  |   ^        | $w_i$ 在取值范围内均匀随机 |\n|    $5$     |  ^           |   ^        |                            |\n|    $6$     | $n=100\\,000$ |   ^        | ^                          |\n|    $7$     | ^            |   ^        |     所有 $w_i$ 均相等      |\n|    $8$     | ^            |   ^        |                            |\n|    $9$     |    $n=7$     |   $k=3$    | ^                          |\n|    $10$    |    $n=16$    |   ^        |     所有 $w_i$ 均相等      |\n|    $11$    |  $n=1\\,001$  |   ^        |     ^                      |\n|    $12$    | $n=99\\,999$  |   $k=4$    |     ^                      |\n|    $13$    | $n=100\\,000$ |   ^        | ^                          |\n|    $14$    | ^            |   ^        | ^                          |\n|    $15$    |  $n=1\\,000$  |   $k=5$    | ^                          |\n|    $16$    | $n=100\\,000$ |   $k=7$    | $w_i$ 在取值范围内均匀随机 |\n|    $17$    | ^            |   ^        |                            |\n|    $18$    | ^            |   $k=8$    | $w_i$ 在取值范围内均匀随机 |\n|    $19$    | ^            |   $k=9$    |                            |\n|    $20$    | ^            |   ^        | ^                          |\n\n#### 【提示】\n\n选手请注意使用 64 位整数进行输入输出、存储和计算。\n\n#### 【评分方式】\n\n对于每个测试点：\n\n- 若输出文件的第 $1$ 行正确，得到该测试点 $40\\%$ 的分数；\n- 若输出文件完全正确，得到该测试点 $100\\%$ 的分数。", "locale": "zh-CN"}}}
{"pid": "P2169", "type": "P", "difficulty": 4, "samples": [["3 2\n1 2 1\n2 3 1\n", "2"], ["5 5\n1 2 1\n2 3 6\n3 4 1\n4 2 1\n3 5 2\n", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["图论", "拓扑排序", "最短路", "强连通分量", "Tarjan"], "title": "正则表达式", "background": "小Z童鞋一日意外的看到小X写了一个正则表达式的高级程序，这个正则表达式程序仅仅由字符“0”,“1”，“.”和“\\*”构成，但是他能够匹配出所有在OJ上都AC的程序的核心代码！小Z大为颇感好奇，于是他决定入侵小X的电脑上去获得这个正则表达式的高级程序。\n", "description": "在 Internet 网络中的每台电脑并不是直接一对一连通的，而是某些电脑之间存在单向的网络连接，也就是说存在 $A$ 到 $B$ 的连接不一定存在 $B$ 到 $A$ 的连接，并且有些连接传输速度很快，有些则很慢，所以不同连接传输所花的时间是有大有小的。另外，如果存在 $A$ 到 $B$ 的连接的同时也存在 $B$ 到 $A$ 的连接的话，那么 $A$ 和 $B$ 实际上处于同一局域网内，可以通过本地传输，这样花费的传输时间为 $0$。\n\n现在小 Z 告诉你整个网络的构成情况，他希望知道从他的电脑（编号为 $1$），到小 X 的电脑（编号为 $n$）所需要的最短传输时间。", "inputFormat": "第一行两个整数 $n,m$，表示有 $n$ 台电脑，$m$ 个连接关系。\n\n接下来 $m$ 行，每行三个整数 $u,v,w$，表示从电脑 $u$ 到电脑 $v$ 传输信息的时间为 $w$。", "outputFormat": "输出文件仅一行为最短传输时间。\n", "hint": "- 对于  $40\\%$ 的数据，$1\\leq n\\leq 10^3$, $1\\leq m\\leq 10^4$；\n- 对于  $70\\%$ 的数据，$1\\leq n\\leq 5 \\times 10^3$， $1\\leq m\\leq 10^5$；\n- 对于  $100\\%$ 的数据，$1\\leq n\\leq 2 \\times 10^5$， $1\\leq m\\leq 10^6$。\n\n保证答案在 `int` 范围内。", "locale": "zh-CN", "translations": {"en": {"title": "Regular Expression", "background": "One day, student Xiao Z unexpectedly saw Xiao X write an advanced regular expression program. This regex is composed only of the characters \"0\", \"1\", \".\", and \"*\", yet it can match the core code of all programs that get AC on the OJ! Xiao Z became very curious, so he decided to hack into Xiao X's computer to obtain this advanced regex program.", "description": "In the Internet, computers are not directly connected one-to-one. Instead, some computers have one-way network connections. That is, even if there is a connection from $A$ to $B$, there may not be a connection from $B$ to $A$. Moreover, some connections are fast while others are slow, so the transmission time differs across connections. In addition, if both the connection from $A$ to $B$ and the connection from $B$ to $A$ exist, then $A$ and $B$ are effectively in the same LAN and can communicate locally, with a transmission time of $0$.\n\nNow Xiao Z gives you the topology of the network. He wants to know the shortest transmission time from his computer (numbered $1$) to Xiao X's computer (numbered $n$).", "inputFormat": "The first line contains two integers $n, m$, meaning there are $n$ computers and $m$ connections.\n\nThe next $m$ lines each contain three integers $u, v, w$, meaning the time to transmit information from computer $u$ to computer $v$ is $w$.", "outputFormat": "Output a single line with the shortest transmission time.", "hint": "- For $40\\%$ of the data, $1 \\leq n \\leq 10^3$, $1 \\leq m \\leq 10^4$.\n- For $70\\%$ of the data, $1 \\leq n \\leq 5 \\times 10^3$, $1 \\leq m \\leq 10^5$.\n- For $100\\%$ of the data, $1 \\leq n \\leq 2 \\times 10^5$, $1 \\leq m \\leq 10^6$.\n\nThe answer is guaranteed to fit in the `int` range.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "正则表达式", "background": "小Z童鞋一日意外的看到小X写了一个正则表达式的高级程序，这个正则表达式程序仅仅由字符“0”,“1”，“.”和“\\*”构成，但是他能够匹配出所有在OJ上都AC的程序的核心代码！小Z大为颇感好奇，于是他决定入侵小X的电脑上去获得这个正则表达式的高级程序。\n", "description": "在 Internet 网络中的每台电脑并不是直接一对一连通的，而是某些电脑之间存在单向的网络连接，也就是说存在 $A$ 到 $B$ 的连接不一定存在 $B$ 到 $A$ 的连接，并且有些连接传输速度很快，有些则很慢，所以不同连接传输所花的时间是有大有小的。另外，如果存在 $A$ 到 $B$ 的连接的同时也存在 $B$ 到 $A$ 的连接的话，那么 $A$ 和 $B$ 实际上处于同一局域网内，可以通过本地传输，这样花费的传输时间为 $0$。\n\n现在小 Z 告诉你整个网络的构成情况，他希望知道从他的电脑（编号为 $1$），到小 X 的电脑（编号为 $n$）所需要的最短传输时间。", "inputFormat": "第一行两个整数 $n,m$，表示有 $n$ 台电脑，$m$ 个连接关系。\n\n接下来 $m$ 行，每行三个整数 $u,v,w$，表示从电脑 $u$ 到电脑 $v$ 传输信息的时间为 $w$。", "outputFormat": "输出文件仅一行为最短传输时间。\n", "hint": "- 对于  $40\\%$ 的数据，$1\\leq n\\leq 10^3$, $1\\leq m\\leq 10^4$；\n- 对于  $70\\%$ 的数据，$1\\leq n\\leq 5 \\times 10^3$， $1\\leq m\\leq 10^5$；\n- 对于  $100\\%$ 的数据，$1\\leq n\\leq 2 \\times 10^5$， $1\\leq m\\leq 10^6$。\n\n保证答案在 `int` 范围内。", "locale": "zh-CN"}}}
{"pid": "P2170", "type": "P", "difficulty": 3, "samples": [["4 3 2\n1 2\n3 4", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "并查集", "洛谷原创", "背包 DP", "进制", "bitset"], "title": "选学霸", "background": "", "description": "老师想从 $n$ 名学生中选 $m$ 人当学霸，但有 $k$ 对人实力相当，如果实力相当的人中，一部分被选上，另一部分没有，同学们就会抗议。所以老师想请你帮他求出他该选多少学霸，才能既不让同学们抗议，又与原来的 $m$ 尽可能接近。", "inputFormat": "第一行，三个正整数 $n,m,k$。\n\n接下来 $k$ 行，每行 $2$ 个数，表示一对实力相当的人的编号（编号为 $1,2,\\cdots n$）。", "outputFormat": "共一行，表示既不让同学们抗议，又与原来的 $m$ 尽可能接近的选出学霸的数目。\n\n如果有两种方案与 $m$ 的差的绝对值相等，选较小的一种。", "hint": "对于 $100\\%$ 的数据，满足 $1 \\le n\\le 2 \\times 10^4,0 \\le m \\le n,0\\le k\\le 2\\times 10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "Selecting Top Students", "background": "", "description": "The teacher wants to select $m$ students out of $n$ to be top students, but there are $k$ pairs of students who are equally strong. If, among students of equal strength, some are selected while others are not, the class will protest. Therefore, the teacher asks you to determine how many top students he should select so that there is no protest and the number is as close as possible to the original $m$.", "inputFormat": "The first line contains three positive integers $n, m, k$.\n\nThe next $k$ lines each contain $2$ numbers, representing the IDs of a pair of equally strong students (IDs are $1, 2, \\cdots, n$).", "outputFormat": "Output a single line: the number of top students to select such that there is no protest and the number is as close as possible to the original $m$.\n\nIf there are two options whose absolute difference from $m$ is the same, choose the smaller one.", "hint": "For $100\\%$ of the testdata, it holds that $1 \\le n \\le 2 \\times 10^4, 0 \\le m \\le n, 0 \\le k \\le 2 \\times 10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "选学霸", "background": "", "description": "老师想从 $n$ 名学生中选 $m$ 人当学霸，但有 $k$ 对人实力相当，如果实力相当的人中，一部分被选上，另一部分没有，同学们就会抗议。所以老师想请你帮他求出他该选多少学霸，才能既不让同学们抗议，又与原来的 $m$ 尽可能接近。", "inputFormat": "第一行，三个正整数 $n,m,k$。\n\n接下来 $k$ 行，每行 $2$ 个数，表示一对实力相当的人的编号（编号为 $1,2,\\cdots n$）。", "outputFormat": "共一行，表示既不让同学们抗议，又与原来的 $m$ 尽可能接近的选出学霸的数目。\n\n如果有两种方案与 $m$ 的差的绝对值相等，选较小的一种。", "hint": "对于 $100\\%$ 的数据，满足 $1 \\le n\\le 2 \\times 10^4,0 \\le m \\le n,0\\le k\\le 2\\times 10^4$。", "locale": "zh-CN"}}}
{"pid": "P2171", "type": "P", "difficulty": 4, "samples": [["8\n1 4 3 9 10 35 2 7\n", "deep=5\n2\n3\n7\n35\n10\n9\n4\n1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["笛卡尔树"], "title": "Hz 吐泡泡", "background": "Hz 大大是一种可爱的动物（神）。他很喜欢吐泡泡（更喜欢写作业）。", "description": "这天，Hz 大大心血来潮，吐了 $n$ 个不同的泡泡玩（保证没有重复的泡泡）。因为他还要写作业，所以他请你帮他把这些泡泡排序成树。输出它的后序遍历。\n\n具体来说，Hz 会使用二叉查找树（BST）的算法，将这些泡泡**依次**插入到树中。每次插入后新的泡泡位于一个叶子上，并且整棵树的中序遍历保持升序。\n\n全部插入完成后的二叉树即是所要求的树。", "inputFormat": "共 $2$ 行。\n\n第一行，$1$ 个整数 $n$。\n\n第二行，$n$ 个整数，第 $i$ 个整数 $a_i$ 代表第 $i$ 个泡泡的大小。", "outputFormat": "共 $2$ 行。\n\n第一行，输出树的深度。\n\n接下来输出 n 行，一行一个整数，表示树的后序遍历。", "hint": "本题分为两个 Subtask，第一个 Subtask 共 10 个测试点，每个测试点 5 分，第二个 Subtask 共 5 个测试点，每个测试点 10 分。\n\n$1\\le n\\le 3\\times 10^5$，$1\\le a_i\\le 10^9$，所有 $a_i$ 互不相同。", "locale": "zh-CN", "translations": {"en": {"title": "Hz Blows Bubbles", "background": "Hz is a cute creature (a “god”). He likes blowing bubbles (but likes doing homework even more).", "description": "One day, on a whim, Hz blew $n$ different bubbles to play with (guaranteed to be no duplicates). Because he still has homework to do, he asks you to help sort these bubbles into a tree and output its postorder traversal.\n\nSpecifically, Hz uses the binary search tree (BST) algorithm to insert the bubbles into the tree in the given order. Each insertion adds the new bubble as a leaf, and the in-order traversal of the whole tree remains in ascending order.\n\nThe binary tree after all insertions is the required tree.", "inputFormat": "A total of $2$ lines.\n\n- The first line contains $1$ integer $n$.\n- The second line contains $n$ integers, where the $i$-th integer $a_i$ is the size of the $i$-th bubble.", "outputFormat": "A total of $n+1$ lines.\n\n- The first line outputs the depth of the tree.\n- Then output $n$ lines, one integer per line, giving the postorder traversal of the tree.", "hint": "- This problem has two subtasks. The first subtask has $10$ test points, each worth $5$ points. The second subtask has $5$ test points, each worth $10$ points.\n- Constraints: $1 \\le n \\le 3 \\times 10^5$, $1 \\le a_i \\le 10^9$, and all $a_i$ are distinct.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Hz 吐泡泡", "background": "Hz 大大是一种可爱的动物（神）。他很喜欢吐泡泡（更喜欢写作业）。", "description": "这天，Hz 大大心血来潮，吐了 $n$ 个不同的泡泡玩（保证没有重复的泡泡）。因为他还要写作业，所以他请你帮他把这些泡泡排序成树。输出它的后序遍历。\n\n具体来说，Hz 会使用二叉查找树（BST）的算法，将这些泡泡**依次**插入到树中。每次插入后新的泡泡位于一个叶子上，并且整棵树的中序遍历保持升序。\n\n全部插入完成后的二叉树即是所要求的树。", "inputFormat": "共 $2$ 行。\n\n第一行，$1$ 个整数 $n$。\n\n第二行，$n$ 个整数，第 $i$ 个整数 $a_i$ 代表第 $i$ 个泡泡的大小。", "outputFormat": "共 $2$ 行。\n\n第一行，输出树的深度。\n\n接下来输出 n 行，一行一个整数，表示树的后序遍历。", "hint": "本题分为两个 Subtask，第一个 Subtask 共 10 个测试点，每个测试点 5 分，第二个 Subtask 共 5 个测试点，每个测试点 10 分。\n\n$1\\le n\\le 3\\times 10^5$，$1\\le a_i\\le 10^9$，所有 $a_i$ 互不相同。", "locale": "zh-CN"}}}
{"pid": "P2172", "type": "P", "difficulty": 6, "samples": [["3 3 1 2\n...\n.x.\n...", "4"], ["5 4 1 1\n....\n..x.\n...x\n....\nx...", "5\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["集训队互测", "网络流", "二分图"], "title": "[国家集训队] 部落战争", "background": "lanzerb 的部落在 A 国的上部，他们不满天寒地冻的环境，于是准备向A国的下部征战来获得更大的领土。", "description": "A 国是一个 $M\\times N$ 的矩阵，其中某些地方是城镇，某些地方是高山深涧无人居住。lanzerb 把自己的部落分成若干支军队，他们约定：\n\n每支军队可以从任意一个城镇出发，并只能从上往向下征战，不能回头。途中只能经过城镇，不能经过高山深涧。\n\n如果某个城镇被某支军队到过，则其他军队不能再去那个城镇了。\n每支军队都可以在任意一个城镇停止征战。\n\n所有军队都很奇怪，他们走的方法有点像国际象棋中的马。不过马每次只能走 $1\\times2$ 的路线，而他们只能走 $R\\times C$ 的路线。\n\nlanzerb 的野心使得他的目标是统一全国，但是兵力的限制使得他们在配备人手时力不从心。假设他们每支军队都能顺利占领这支军队经过的所有城镇，请你帮 lanzerb 算算至少要多少支军队才能完成统一全国的大业。", "inputFormat": "第一行包含 $4$ 个整数 $M,N,R,C$，意义见问题描述。接下来 $M$ 行每行一个长度为 $N$ 的字符串。如果某个字符是 `.` 表示这个地方是城镇；如果这个字符是 `x` 则表示这个地方是高山深涧。", "outputFormat": "输出一个整数，表示最少的军队个数。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1\\le M,N\\le 50,1\\le R,C\\le 10$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTT] Tribal War", "background": "lanzerb’s tribe is in the northern part of Country A. Dissatisfied with the freezing weather, they plan to wage war toward the southern part of Country A to seize more territory.", "description": "Country A is an $M \\times N$ matrix, where some cells are towns and some are uninhabited mountains and chasms. lanzerb divides his tribe into several armies, with the following rules:\n\nEach army may start from any town and can only advance downward, from top to bottom, without turning back. Along the way, they may pass only through towns, not through mountains and chasms.\n\nIf a town has been visited by one army, no other army may visit that town again.\nEach army may stop at any town.\n\nAll the armies move in a way similar to a knight in chess. However, while a knight moves in a $1 \\times 2$ pattern, they move in an $R \\times C$ pattern.\n\nDriven by ambition, lanzerb aims to unite the entire country, but limited manpower makes staffing difficult. Assuming each army successfully occupies all towns it passes through, please help lanzerb compute the minimum number of armies needed to unify the entire country.", "inputFormat": "The first line contains $4$ integers $M, N, R, C$, as described above. Then follow $M$ lines, each being a string of length $N$. If a character is `.` it denotes a town; if a character is `x` it denotes mountains and chasms.", "outputFormat": "Output a single integer, the minimum number of armies.", "hint": "Constraints\n\nFor $100\\%$ of the testdata, $1 \\le M, N \\le 50$, $1 \\le R, C \\le 10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[国家集训队] 部落战争", "background": "lanzerb 的部落在 A 国的上部，他们不满天寒地冻的环境，于是准备向A国的下部征战来获得更大的领土。", "description": "A 国是一个 $M\\times N$ 的矩阵，其中某些地方是城镇，某些地方是高山深涧无人居住。lanzerb 把自己的部落分成若干支军队，他们约定：\n\n每支军队可以从任意一个城镇出发，并只能从上往向下征战，不能回头。途中只能经过城镇，不能经过高山深涧。\n\n如果某个城镇被某支军队到过，则其他军队不能再去那个城镇了。\n每支军队都可以在任意一个城镇停止征战。\n\n所有军队都很奇怪，他们走的方法有点像国际象棋中的马。不过马每次只能走 $1\\times2$ 的路线，而他们只能走 $R\\times C$ 的路线。\n\nlanzerb 的野心使得他的目标是统一全国，但是兵力的限制使得他们在配备人手时力不从心。假设他们每支军队都能顺利占领这支军队经过的所有城镇，请你帮 lanzerb 算算至少要多少支军队才能完成统一全国的大业。", "inputFormat": "第一行包含 $4$ 个整数 $M,N,R,C$，意义见问题描述。接下来 $M$ 行每行一个长度为 $N$ 的字符串。如果某个字符是 `.` 表示这个地方是城镇；如果这个字符是 `x` 则表示这个地方是高山深涧。", "outputFormat": "输出一个整数，表示最少的军队个数。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1\\le M,N\\le 50,1\\le R,C\\le 10$。", "locale": "zh-CN"}}}
{"pid": "P2173", "type": "P", "difficulty": 6, "samples": [["4 5 2 7\n1\n2\n3\n4\n1 2 0\n1 3 1\n2 3 0\n2 4 1\n3 4 0\n2 0 1 4\n1 1 2 1\n1 4 3 1\n2 0 1 4\n1 2 3 1\n0 2 5\n2 1 1 4", "4\nSuccess.\nError 2.\n-1\nError 1.\n5"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "各省省选", "平衡树", "浙江", "动态树 LCT"], "title": "[ZJOI2012] 网络", "background": "", "description": "有一个无向图 $G$，每个点有个权值，每条边有一个颜色。这个无向图满足以下两个条件：\n\n1、 对于任意节点连出去的边中，相同颜色的边不超过两条。\n\n2、图中不存在同色的环，同色的环指相同颜色的边构成的环。\n\n在这个图上，你要支持以下三种操作：\n\n- `0 x y` 表示把节点 $x$ 的权值改为 $y$\n\n- `1 u v w` 表示将边 $(u,v)$ 的颜色改为 $w$。  \n\n- `2 c u v` 表示查询由颜色 $c$ 的边构成的图中，所有可能在 $u \\to v$ 之间的简单路径上的节点的权值的最大值。\n", "inputFormat": "第一行四个正整数 $n,m,C,k$，分别表示节点数、边数、颜色数和操作数。\n\n接下来 $n$ 行，每行一个正整数 $v_i$，为节点 $i$ 的权值。\n\n之后 $m$ 行，每行三个正整数 $u,v,w$，为一条连接 $u,v$ 节点的边，颜色为$w$。\n\n最后 $k$ 行，每行若干个正整数，表示一次操作。", "outputFormat": "输出若干行，每行输出一个对应的信息。\n\n1、 对于修改节点权值操作，不需要输出信息。\n\n2、对于修改边的颜色操作，按以下几类输出：\n\n- 若不存在连接节点 $u$ 和节点 $v$ 的边，输出 `No such edge.`。\n\n- 若修改后不满足条件 $1$，不修改边的颜色，并输出 `Error 1.`。\n\n- 若修改后不满足条件 $2$，不修改边的颜色，并输出 `Error 2.`。\n\n- 其他情况，成功修改边的颜色，并输出 `Success.`。\n\n输出满足条件的第一条信息即可，即若同时不满足条件 $1,2$ ，则只需要输出`Error 1.`。\n\n3、 对于查询操作，输出一个整数表示答案。若 $u,v$ 之间没有颜色 $c$ 构成的路径，则输出 $-1$。\n", "hint": " ![](https://cdn.luogu.com.cn/upload/pic/1714.png) \n\n颜色 $0$ 为实线的边，颜色 $1$ 为虚线的边，\n\n由颜色 $0$ 构成的从节点 $1$ 到节点 $4$ 的路径有 $1 \\to 2 \\to 4$，故$\\max\\{v_1, v_2, v_4\\} = \\max\\{ 1, 2, 4 \\} = 4$。\n\n将连接节点 $1$ 和节点 $2$ 的边修改为颜色 $1$，修改成功，输出 `Success.`\n\n将连接节点 $4$ 和节点 $3$ 的边修改为颜色 $1$，由于修改后会使得存在由颜色 $1$ 构成的环( $1 – 2 – 4 – 3 – 1$ )，不满足条件 $2$，故不修改，并输`Error 2`。\n\n不存在颜色 $0$ 构成的从节点 $1$ 到节点 $4$ 的边，输出 `-1`。\n\n将连接节点 $2$ 和节点 $3$ 的边修改为颜色 $1$，由于修改后节点 $2$ 的连出去的颜色为 $1$ 的边有 $3$ 条，故不满足条件 $1$，故不修改，并输出`Error 1.` 。\n\n将节点 $2$ 的权值修改为 $5$。\n\n由颜色 $1$ 构成的从节点 $1$ 到节点 $4$ 的路径有 $1 \\to 2 \\to 4$，故$\\max\\{v_1, v_2, v_4\\} = \\max\\{ 1, 5, 4 \\} = 5$。\n\n【数据范围】\n\n对于 $30\\%$ 的数据：$n ≤ 1000$，$m ≤ 10^4$，$k ≤ 1000$；   \n另有 $20\\%$ 的数据：$n ≤ 10^4$，$m ≤ 10^5$，$C = 1$，$k ≤ 10^5$；   \n对于 $100\\%$ 的数据：$n ≤ 10^4$，$m ≤ 10^5$，$C ≤ 10$，$k ≤ 10^5$。  \n\n$1\\le u,v,x \\le n$，$0 \\le c < C$，保证图中没有重边和自环。\n", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2012] Network", "background": "", "description": "There is an undirected graph $G$. Each node has a weight, and each edge has a color. This undirected graph satisfies the following two conditions:\n\n1. For any node, among all edges incident to it, there are at most two edges of the same color.\n\n2. There is no monochromatic cycle in the graph, i.e., no cycle formed by edges of the same color.\n\nOn this graph, you need to support the following three operations:\n\n- `0 x y` means set the weight of node $x$ to $y$.\n\n- `1 u v w` means change the color of edge $(u, v)$ to $w$.\n\n- `2 c u v` means query, in the subgraph formed by edges of color $c$, the maximum weight among all nodes that lie on any simple path from $u$ to $v$.", "inputFormat": "The first line contains four positive integers $n, m, C, k$, denoting the number of nodes, the number of edges, the number of colors, and the number of operations, respectively.\n\nThe next $n$ lines each contain one positive integer $v_i$, the weight of node $i$.\n\nThe next $m$ lines each contain three positive integers $u, v, w$, denoting an edge connecting nodes $u$ and $v$ with color $w$.\n\nThe last $k$ lines each contain several positive integers, representing one operation.", "outputFormat": "Output several lines, each containing the corresponding message.\n\n1. For node weight modification operations, no output is required.\n\n2. For edge color modification operations, print one of the following:\n\n- If there is no edge connecting node $u$ and node $v$, print `No such edge.`.\n\n- If the modification would violate condition 1, do not modify the edge color and print `Error 1.`.\n\n- If the modification would violate condition 2, do not modify the edge color and print `Error 2.`.\n\n- Otherwise, modify the edge color successfully and print `Success.`.\n\nOnly print the first applicable message. That is, if both conditions 1 and 2 would be violated, print only `Error 1.`.\n\n3. For query operations, print one integer as the answer. If there is no path of color $c$ between $u$ and $v$, print $-1$.", "hint": "![](https://cdn.luogu.com.cn/upload/pic/1714.png)\n\nEdges of color $0$ are solid; edges of color $1$ are dashed.\n\nIn the subgraph formed by edges of color $0$, there is a path from node $1$ to node $4$: $1 \\to 2 \\to 4$. Thus $\\max\\{ v_1, v_2, v_4 \\} = \\max\\{ 1, 2, 4 \\} = 4$.\n\nChanging the edge between nodes $1$ and $2$ to color $1$ succeeds, so print `Success.`.\n\nChanging the edge between nodes $4$ and $3$ to color $1$ would create a monochromatic cycle of color $1$ ($1 – 2 – 4 – 3 – 1$), violating condition 2, so do not modify it and print `Error 2.`.\n\nThere is no path of color $0$ from node $1$ to node $4$, so print $-1$.\n\nChanging the edge between nodes $2$ and $3$ to color $1$ would make node $2$ incident to three edges of color $1$, violating condition 1, so do not modify it and print `Error 1.`.\n\nChange the weight of node $2$ to $5$.\n\nIn the subgraph formed by edges of color $1$, there is a path from node $1$ to node $4$: $1 \\to 2 \\to 4$. Thus $\\max\\{ v_1, v_2, v_4 \\} = \\max\\{ 1, 5, 4 \\} = 5$.\n\nConstraints\n\n- For $30\\%$ of the testdata: $n \\le 1000$, $m \\le 10^4$, $k \\le 1000$.\n- Additionally, for $20\\%$ of the testdata: $n \\le 10^4$, $m \\le 10^5$, $C = 1$, $k \\le 10^5$.\n- For $100\\%$ of the testdata: $n \\le 10^4$, $m \\le 10^5$, $C \\le 10$, $k \\le 10^5$.\n\n$1 \\le u, v, x \\le n$, $0 \\le c < C$. There are no multiple edges or self-loops in the graph.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2012] 网络", "background": "", "description": "有一个无向图 $G$，每个点有个权值，每条边有一个颜色。这个无向图满足以下两个条件：\n\n1、 对于任意节点连出去的边中，相同颜色的边不超过两条。\n\n2、图中不存在同色的环，同色的环指相同颜色的边构成的环。\n\n在这个图上，你要支持以下三种操作：\n\n- `0 x y` 表示把节点 $x$ 的权值改为 $y$\n\n- `1 u v w` 表示将边 $(u,v)$ 的颜色改为 $w$。  \n\n- `2 c u v` 表示查询由颜色 $c$ 的边构成的图中，所有可能在 $u \\to v$ 之间的简单路径上的节点的权值的最大值。\n", "inputFormat": "第一行四个正整数 $n,m,C,k$，分别表示节点数、边数、颜色数和操作数。\n\n接下来 $n$ 行，每行一个正整数 $v_i$，为节点 $i$ 的权值。\n\n之后 $m$ 行，每行三个正整数 $u,v,w$，为一条连接 $u,v$ 节点的边，颜色为$w$。\n\n最后 $k$ 行，每行若干个正整数，表示一次操作。", "outputFormat": "输出若干行，每行输出一个对应的信息。\n\n1、 对于修改节点权值操作，不需要输出信息。\n\n2、对于修改边的颜色操作，按以下几类输出：\n\n- 若不存在连接节点 $u$ 和节点 $v$ 的边，输出 `No such edge.`。\n\n- 若修改后不满足条件 $1$，不修改边的颜色，并输出 `Error 1.`。\n\n- 若修改后不满足条件 $2$，不修改边的颜色，并输出 `Error 2.`。\n\n- 其他情况，成功修改边的颜色，并输出 `Success.`。\n\n输出满足条件的第一条信息即可，即若同时不满足条件 $1,2$ ，则只需要输出`Error 1.`。\n\n3、 对于查询操作，输出一个整数表示答案。若 $u,v$ 之间没有颜色 $c$ 构成的路径，则输出 $-1$。\n", "hint": " ![](https://cdn.luogu.com.cn/upload/pic/1714.png) \n\n颜色 $0$ 为实线的边，颜色 $1$ 为虚线的边，\n\n由颜色 $0$ 构成的从节点 $1$ 到节点 $4$ 的路径有 $1 \\to 2 \\to 4$，故$\\max\\{v_1, v_2, v_4\\} = \\max\\{ 1, 2, 4 \\} = 4$。\n\n将连接节点 $1$ 和节点 $2$ 的边修改为颜色 $1$，修改成功，输出 `Success.`\n\n将连接节点 $4$ 和节点 $3$ 的边修改为颜色 $1$，由于修改后会使得存在由颜色 $1$ 构成的环( $1 – 2 – 4 – 3 – 1$ )，不满足条件 $2$，故不修改，并输`Error 2`。\n\n不存在颜色 $0$ 构成的从节点 $1$ 到节点 $4$ 的边，输出 `-1`。\n\n将连接节点 $2$ 和节点 $3$ 的边修改为颜色 $1$，由于修改后节点 $2$ 的连出去的颜色为 $1$ 的边有 $3$ 条，故不满足条件 $1$，故不修改，并输出`Error 1.` 。\n\n将节点 $2$ 的权值修改为 $5$。\n\n由颜色 $1$ 构成的从节点 $1$ 到节点 $4$ 的路径有 $1 \\to 2 \\to 4$，故$\\max\\{v_1, v_2, v_4\\} = \\max\\{ 1, 5, 4 \\} = 5$。\n\n【数据范围】\n\n对于 $30\\%$ 的数据：$n ≤ 1000$，$m ≤ 10^4$，$k ≤ 1000$；   \n另有 $20\\%$ 的数据：$n ≤ 10^4$，$m ≤ 10^5$，$C = 1$，$k ≤ 10^5$；   \n对于 $100\\%$ 的数据：$n ≤ 10^4$，$m ≤ 10^5$，$C ≤ 10$，$k ≤ 10^5$。  \n\n$1\\le u,v,x \\le n$，$0 \\le c < C$，保证图中没有重边和自环。\n", "locale": "zh-CN"}}}
{"pid": "P2174", "type": "P", "difficulty": 4, "samples": [["3 6\n2 6 9\nM\nD 9\nB\nS\nM\nT", "81\n6\n2\n36\n12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["堆"], "title": "小Z的神奇数列", "background": "小Z最近在研究数列，他需要知道在他所研究的数列中，最大的数是多少（Max），最小的数是多少（Min），最大的数的最小的数次幂是多少（Max^Min），所有数的乘积是多少。要知道，这样的问题是肯定难不倒小Z的。但是，最近小Z突发奇想，想要研究下这个数列的更深层的性质，所以他决定不断的从这个数列中删去一些数，每次删除后都研究下当前数列。由于数列项数很大，这给小Z带来了很大的麻烦，于是小Z请你帮他写一个程序，来完成下列操作。", "description": "你需要维护一个可重集，支持五种操作：\n\n- `D x` 表示删除 $x$，保证 $x$ 一定存在。若有多个只用删除一个。\n\n- `B` 询问集合中最大值。\n\n- `S` 询问集合中最小值。\n\n- `M` 设集合中最大值为 $a$，最小值为 $b$，询问 $a^b \\bmod 317847191$。\n\n- `T` 询问数列中所有数的乘积，对 $317847191$ 取模。\n\n对于所有询问保证集合非空。\n", "inputFormat": "第一行两个正整数 $n,m$，表示初始集合大小和操作数。    \n第二行 $n$ 个正整数 $a_i$，表示初始集合。  \n接下来 $m$ 行，每行表示一个操作。\n\n", "outputFormat": "对于每个询问，输出一行一个整数表示答案。", "hint": "【数据规模】  \n对于部分数据，$1 \\le n \\le 1000$，$1\\le m \\le 100$，$1\\le a_i \\le 400$；  \n对于 $100\\%$ 的数据，$1\\le n,m \\le 10^6$，$1\\le a_i \\le 10^8$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Xiao Z's Magical Sequence", "background": "Xiao Z has been studying sequences. He wants to know, for the sequence he studies, what the maximum number is (Max), what the minimum number is (Min), what Max to the power of Min (Max^Min) is, and what the product of all numbers is. Of course, such questions are no problem for Xiao Z. However, he recently had a sudden idea to explore deeper properties of this sequence, so he decided to keep deleting some numbers from the sequence and study the current sequence after each deletion. Since the sequence has many terms, this causes a lot of trouble for Xiao Z, so he asks you to write a program to perform the following operations.", "description": "You need to maintain a multiset that supports five operations:\n\n- `D x` Delete $x$; it is guaranteed that $x$ exists. If there are multiple occurrences, delete only one.\n- `B` Query the maximum value in the set.\n- `S` Query the minimum value in the set.\n- `M` Let the maximum be $a$ and the minimum be $b$; query $a^b \\bmod 317847191$.\n- `T` Query the product of all numbers, modulo $317847191$.\n\nFor all queries, the multiset is guaranteed to be non-empty.", "inputFormat": "The first line contains two positive integers $n, m$, the initial multiset size and the number of operations.  \nThe second line contains $n$ positive integers $a_i$, the initial multiset.  \nThen $m$ lines follow, each describing one operation.", "outputFormat": "For each query, output one integer per line representing the answer.", "hint": "Constraints  \nFor partial testdata, $1 \\le n \\le 1000$, $1 \\le m \\le 100$, $1 \\le a_i \\le 400$.  \nFor $100\\%$ of the testdata, $1 \\le n, m \\le 10^6$, $1 \\le a_i \\le 10^8$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小Z的神奇数列", "background": "小Z最近在研究数列，他需要知道在他所研究的数列中，最大的数是多少（Max），最小的数是多少（Min），最大的数的最小的数次幂是多少（Max^Min），所有数的乘积是多少。要知道，这样的问题是肯定难不倒小Z的。但是，最近小Z突发奇想，想要研究下这个数列的更深层的性质，所以他决定不断的从这个数列中删去一些数，每次删除后都研究下当前数列。由于数列项数很大，这给小Z带来了很大的麻烦，于是小Z请你帮他写一个程序，来完成下列操作。", "description": "你需要维护一个可重集，支持五种操作：\n\n- `D x` 表示删除 $x$，保证 $x$ 一定存在。若有多个只用删除一个。\n\n- `B` 询问集合中最大值。\n\n- `S` 询问集合中最小值。\n\n- `M` 设集合中最大值为 $a$，最小值为 $b$，询问 $a^b \\bmod 317847191$。\n\n- `T` 询问数列中所有数的乘积，对 $317847191$ 取模。\n\n对于所有询问保证集合非空。\n", "inputFormat": "第一行两个正整数 $n,m$，表示初始集合大小和操作数。    \n第二行 $n$ 个正整数 $a_i$，表示初始集合。  \n接下来 $m$ 行，每行表示一个操作。\n\n", "outputFormat": "对于每个询问，输出一行一个整数表示答案。", "hint": "【数据规模】  \n对于部分数据，$1 \\le n \\le 1000$，$1\\le m \\le 100$，$1\\le a_i \\le 400$；  \n对于 $100\\%$ 的数据，$1\\le n,m \\le 10^6$，$1\\le a_i \\le 10^8$。\n", "locale": "zh-CN"}}}
{"pid": "P2175", "type": "P", "difficulty": 6, "samples": [["5\n3 4 5 0\n1 3 5 0\n2 1 4 5 0\n2 3 5 0\n1 2 3 4 0", "No solution"], ["5\n2 3 5 0\n1 4 5 3 0\n1 2 5 0\n1 2 3 0\n4 3 2 1 0", "2 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["图论", "背包 DP", "二分图"], "title": "小Z的游戏分队", "background": "", "description": "小 Z 受不了寂寞，准备举办一次 DOTA 比赛，为了能让 ACM 班全部都参加比赛，他还特制了一张 DOTA 地图能够支持任意多人打任意多人。\n\n现在问题来了，怎么把这么多人分成两队？小 Z 的想法是，每个人报上自己愿意同队的同学，接着小 Z 会按如下要求将所有人分为两队：\n\n对任意同学甲，和同学甲同队的人，必须都是同学甲愿意同队的同学。\n\n小 Z 希望两队的人数差尽量小，如果这种分组不存在，那么输出 `No solution`。", "inputFormat": "第 $1$ 行为 $N$，表示一共有多少个学生。\n\n之后 $2$ 到 $N+1$ 行，每行表示这个学生信任的同学的名单，以 $0$ 结束。", "outputFormat": "$1$ 行，如果解存在，输出两队的人数，将人数比较小的那队放在前面；如果解不存在，输出 `No solution`。", "hint": "对于 $30\\%$ 的数据，$N \\leq 10$；\n\n对于 $100\\%$ 的数据，$N \\leq 2000$。", "locale": "zh-CN", "translations": {"en": {"title": "Xiao Z's Game Team Formation", "background": "", "description": "Xiao Z cannot stand loneliness and plans to host a DOTA tournament. To let the entire ACM class participate, he also made a custom DOTA map that can support any number of players versus any number.\n\nNow here comes the problem: how to split so many people into two teams? Xiao Z's idea is that everyone reports the classmates they are willing to be on the same team with, and then Xiao Z will divide everyone into two teams under the following requirement:\n\nFor any student A, everyone who is on the same team as A must all be classmates that A is willing to be on the same team with.\n\nXiao Z wants the difference in team sizes to be as small as possible. If such a grouping does not exist, output `No solution`.", "inputFormat": "The first line contains $N$, the total number of students.\n\nThen lines $2$ through $N+1$, each line lists the classmates this student is willing to be on the same team with, ending with $0$.", "outputFormat": "One line. If a solution exists, output the sizes of the two teams, with the smaller size first; otherwise, output `No solution`.", "hint": "For $30\\%$ of the testdata, $N \\leq 10$;\n\nFor $100\\%$ of the testdata, $N \\leq 2000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小Z的游戏分队", "background": "", "description": "小 Z 受不了寂寞，准备举办一次 DOTA 比赛，为了能让 ACM 班全部都参加比赛，他还特制了一张 DOTA 地图能够支持任意多人打任意多人。\n\n现在问题来了，怎么把这么多人分成两队？小 Z 的想法是，每个人报上自己愿意同队的同学，接着小 Z 会按如下要求将所有人分为两队：\n\n对任意同学甲，和同学甲同队的人，必须都是同学甲愿意同队的同学。\n\n小 Z 希望两队的人数差尽量小，如果这种分组不存在，那么输出 `No solution`。", "inputFormat": "第 $1$ 行为 $N$，表示一共有多少个学生。\n\n之后 $2$ 到 $N+1$ 行，每行表示这个学生信任的同学的名单，以 $0$ 结束。", "outputFormat": "$1$ 行，如果解存在，输出两队的人数，将人数比较小的那队放在前面；如果解不存在，输出 `No solution`。", "hint": "对于 $30\\%$ 的数据，$N \\leq 10$；\n\n对于 $100\\%$ 的数据，$N \\leq 2000$。", "locale": "zh-CN"}}}
{"pid": "P2176", "type": "P", "difficulty": 4, "samples": [["5 7\n2 1 5\n1 3 1\n3 2 8\n3 5 7\n3 4 3\n2 4 7\n4 5 2", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "图论", "2011", "2014", "USACO", "最短路"], "title": "[USACO11DEC] RoadBlock S / [USACO14FEB] Roadblock G/S", "background": null, "description": "每天早晨，FJ 从家中穿过农场走到牛棚。农场由 $N$ 块农田组成，农田通过 $M$ 条双向道路连接，每条路有一定长度。FJ 的房子在 $1$ 号田，牛棚在 $N$ 号田。没有两块田被多条道路连接，以适当的路径顺序总是能在农场任意一对田间行走。当 FJ 从一块田走到另一块时，总是以总路长最短的道路顺序来走。\n\nFJ 的牛呢，总是不安好心，决定干扰他每天早晨的计划。它们在 $M$ 条路的某一条上安放一叠稻草堆，使这条路的长度加倍。牛希望选择一条路干扰使得 FJ 从家到牛棚的路长增加最多。它们请你设计并告诉它们最大增量是多少。", "inputFormat": "第 $1$ 行：两个整数 $N, M$。\n\n第 $2$ 到 $M+1$ 行：第 $i+1$ 行包含三个整数 $A_i, B_i, L_i$，$A_i$ 和 $B_i$ 表示道路 $i$ 连接的田的编号，$L_i$ 表示路长。", "outputFormat": "一个整数，表示通过使某条路加倍而得到的最大增量。", "hint": "【样例说明】\n\n若使 $3$ 和 $4$ 之间的道路长加倍，最短路将由 $1 \\rightarrow 3 \\rightarrow 4 \\rightarrow 5$ 变为 $1 \\rightarrow 3 \\rightarrow 5$。\n\n【数据规模和约定】\n\n对于 $30\\%$ 的数据，$N \\le 70$，$M \\le 1\\,500$。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 100$，$1 \\le M \\le 5\\,000$，$1 \\le L_i \\le 1\\,000\\,000$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO11DEC] RoadBlock S / [USACO14FEB] Roadblock G/S", "background": "", "description": "Every morning, FJ walks from his house across the farm to the barn. The farm consists of $N$ fields connected by $M$ bidirectional roads, each with a certain length. FJ’s house is at field $1$, and the barn is at field $N$. No two fields are connected by multiple roads, and the graph is connected. Whenever FJ travels between fields, he always takes a path with the minimum total length.\n\nFJ’s cows, up to no good as always, decide to disrupt his morning routine. They place a stack of hay bales on one of the $M$ roads, doubling that road’s length. The cows want to choose a road to maximize the increase in FJ’s shortest path distance from home to the barn. They ask you to compute and report this maximum increase.", "inputFormat": "Line $1$: two integers $N, M$.\n\nLines $2$ to $M+1$: the $(i+1)$-th line contains three integers $A_i, B_i, L_i$. $A_i$ and $B_i$ are the indices of the fields connected by road $i$, and $L_i$ is the length of that road.", "outputFormat": "A single integer: the maximum increase obtained by doubling exactly one road.", "hint": "Sample explanation:\nIf the length of the road between $3$ and $4$ is doubled, the shortest path changes from $1 \\rightarrow 3 \\rightarrow 4 \\rightarrow 5$ to $1 \\rightarrow 3 \\rightarrow 5$.\n\nConstraints:\n- For $30\\%$ of the testdata, $N \\le 70$, $M \\le 1{,}500$.\n- For $100\\%$ of the testdata, $1 \\le N \\le 100$, $1 \\le M \\le 5{,}000$, $1 \\le L_i \\le 1{,}000{,}000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO11DEC] RoadBlock S / [USACO14FEB] Roadblock G/S", "background": null, "description": "每天早晨，FJ 从家中穿过农场走到牛棚。农场由 $N$ 块农田组成，农田通过 $M$ 条双向道路连接，每条路有一定长度。FJ 的房子在 $1$ 号田，牛棚在 $N$ 号田。没有两块田被多条道路连接，以适当的路径顺序总是能在农场任意一对田间行走。当 FJ 从一块田走到另一块时，总是以总路长最短的道路顺序来走。\n\nFJ 的牛呢，总是不安好心，决定干扰他每天早晨的计划。它们在 $M$ 条路的某一条上安放一叠稻草堆，使这条路的长度加倍。牛希望选择一条路干扰使得 FJ 从家到牛棚的路长增加最多。它们请你设计并告诉它们最大增量是多少。", "inputFormat": "第 $1$ 行：两个整数 $N, M$。\n\n第 $2$ 到 $M+1$ 行：第 $i+1$ 行包含三个整数 $A_i, B_i, L_i$，$A_i$ 和 $B_i$ 表示道路 $i$ 连接的田的编号，$L_i$ 表示路长。", "outputFormat": "一个整数，表示通过使某条路加倍而得到的最大增量。", "hint": "【样例说明】\n\n若使 $3$ 和 $4$ 之间的道路长加倍，最短路将由 $1 \\rightarrow 3 \\rightarrow 4 \\rightarrow 5$ 变为 $1 \\rightarrow 3 \\rightarrow 5$。\n\n【数据规模和约定】\n\n对于 $30\\%$ 的数据，$N \\le 70$，$M \\le 1\\,500$。\n\n对于 $100\\%$ 的数据，$1 \\le N \\le 100$，$1 \\le M \\le 5\\,000$，$1 \\le L_i \\le 1\\,000\\,000$。", "locale": "zh-CN"}}}
{"pid": "P2177", "type": "P", "difficulty": 5, "samples": [["3 6\n101010\n111001\n101001", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["哈希 hashing"], "title": "内存杀手", "background": "我们伟大的KK突然想到了一个很高（Shā）明（bī）的问题。\n", "description": "我们伟大的 KK 最近一段时间突然迷上了电影，但是他从来不去电影院，因为他口袋里没有一分钱，更因为没人陪他去！但是 KK 不是这么容易就会屈服于命远的，他从爸爸那里“偷”来了电脑，没日没夜的进入了疯狂刷电影状态。\n\n显然我们的 KK 在任何情况下都会出现问题的：KK 习惯于用“百度影音”这个神奇的软件。众所周知，这个软件具备一个牛犇的功能，他可以一边看一边下载，然后，KK 每次都不会在线观看，而是连着 wifi（哇\\~\\~还说没钱！）看，然后的然后KK发现电脑开始变得卡起来了，为了在爸爸突击检查时能够准确准时的将电脑关闭归位，KK 不得不干起了电脑修理师的工作。\n\nKK 翻查了注册表（这都懂？！牛~），发现罪魁祸首竟是存在于一个内存区域中的一个正方形方阵。现在我们的 KK 简单的称呼这种方阵为“内存杀手”，他对于这个“内存杀手”的定义是边长大于 $1$，且在旋转了 $180\\degree$ 之后方阵仍与原来保持不变，如：\n\n$$\n\\begin{bmatrix}\n0 & 0 \\\\\n0 & 0\n\\end{bmatrix},\n\\begin{bmatrix}\n1 & 0 \\\\\n0 & 1\n\\end{bmatrix},\n\\begin{bmatrix}\n1 & 0 & 1 \\\\ \n1 & 1 & 1 \\\\\n1 & 0 & 1\n\\end{bmatrix}\n$$\n\n当然，一个内存区域中“内存杀手”可能不止一个的，现在我们的 KK 想找出这个方阵中最大的“内存杀手”的边长。\n", "inputFormat": "共 $N+1$ 行，第一行两个整数 $N,M$，表示内存矩阵的大小。第 $2 \\sim N+1$ 行，每行 $M$ 个字符表示内存矩阵。", "outputFormat": "共一行，即最大的内存杀手边长；若不存在，则输出 $-1$。\n", "hint": "### 数据范围及约定\n\n- 对于 $30\\%$ 的数据 $0<N$，$M \\le 100$；\n- 对于 $60\\%$ 的数据 $0<N$，$M \\le 200$；\n- 对于 $100\\%$ 的数据 $0<N$，$M \\le 300$。", "locale": "zh-CN", "translations": {"en": {"title": "Memory Killer", "background": "Our great KK suddenly came up with a very “brilliant” problem.", "description": "Lately, our great KK has become obsessed with movies. But he never goes to the cinema, because he has no money in his pocket, and no one to go with! However, KK is not someone who easily bends to fate. He “borrowed” a computer from his dad and started binge-watching day and night.\n\nObviously, problems always arise for KK: he is used to using the magical software “Baidu Player.” As everyone knows, this software has a powerful feature: it can download while playing. KK never streams directly; instead, he watches while connected to Wi‑Fi (wow… and he says he’s broke!). Then KK noticed the computer getting laggy. To make sure he can shut down and put the computer back in place promptly when his dad makes a surprise inspection, KK had to become a makeshift computer repairman.\n\nKK checked the registry and discovered that the culprit was a square matrix located in a memory region. He calls such a square matrix a “memory killer,” defined as a square submatrix with side length greater than $1$ that remains unchanged after a $180^\\circ$ rotation. For example:\n\n$$\n\\begin{bmatrix}\n0 & 0 \\\\\n0 & 0\n\\end{bmatrix},\n\\begin{bmatrix}\n1 & 0 \\\\\n0 & 1\n\\end{bmatrix},\n\\begin{bmatrix}\n1 & 0 & 1 \\\\ \n1 & 1 & 1 \\\\\n1 & 0 & 1\n\\end{bmatrix}\n$$\n\nOf course, there can be more than one “memory killer” in a memory region. Now KK wants to find the side length of the largest “memory killer” in the matrix.", "inputFormat": "There are $N + 1$ lines. The first line contains two integers $N, M$, indicating the size of the memory matrix $N \\times M$. Each of the next lines $2$ to $N + 1$ contains $M$ characters representing the memory matrix.", "outputFormat": "Output a single line: the side length of the largest memory killer. If none exists, output $-1$.", "hint": "Constraints:\n\n- For $30\\%$ of the testdata, $0 < N, M \\le 100$.\n- For $60\\%$ of the testdata, $0 < N, M \\le 200$.\n- For $100\\%$ of the testdata, $0 < N, M \\le 300$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "内存杀手", "background": "我们伟大的KK突然想到了一个很高（Shā）明（bī）的问题。\n", "description": "我们伟大的 KK 最近一段时间突然迷上了电影，但是他从来不去电影院，因为他口袋里没有一分钱，更因为没人陪他去！但是 KK 不是这么容易就会屈服于命远的，他从爸爸那里“偷”来了电脑，没日没夜的进入了疯狂刷电影状态。\n\n显然我们的 KK 在任何情况下都会出现问题的：KK 习惯于用“百度影音”这个神奇的软件。众所周知，这个软件具备一个牛犇的功能，他可以一边看一边下载，然后，KK 每次都不会在线观看，而是连着 wifi（哇\\~\\~还说没钱！）看，然后的然后KK发现电脑开始变得卡起来了，为了在爸爸突击检查时能够准确准时的将电脑关闭归位，KK 不得不干起了电脑修理师的工作。\n\nKK 翻查了注册表（这都懂？！牛~），发现罪魁祸首竟是存在于一个内存区域中的一个正方形方阵。现在我们的 KK 简单的称呼这种方阵为“内存杀手”，他对于这个“内存杀手”的定义是边长大于 $1$，且在旋转了 $180\\degree$ 之后方阵仍与原来保持不变，如：\n\n$$\n\\begin{bmatrix}\n0 & 0 \\\\\n0 & 0\n\\end{bmatrix},\n\\begin{bmatrix}\n1 & 0 \\\\\n0 & 1\n\\end{bmatrix},\n\\begin{bmatrix}\n1 & 0 & 1 \\\\ \n1 & 1 & 1 \\\\\n1 & 0 & 1\n\\end{bmatrix}\n$$\n\n当然，一个内存区域中“内存杀手”可能不止一个的，现在我们的 KK 想找出这个方阵中最大的“内存杀手”的边长。\n", "inputFormat": "共 $N+1$ 行，第一行两个整数 $N,M$，表示内存矩阵的大小。第 $2 \\sim N+1$ 行，每行 $M$ 个字符表示内存矩阵。", "outputFormat": "共一行，即最大的内存杀手边长；若不存在，则输出 $-1$。\n", "hint": "### 数据范围及约定\n\n- 对于 $30\\%$ 的数据 $0<N$，$M \\le 100$；\n- 对于 $60\\%$ 的数据 $0<N$，$M \\le 200$；\n- 对于 $100\\%$ 的数据 $0<N$，$M \\le 300$。", "locale": "zh-CN"}}}
{"pid": "P2178", "type": "P", "difficulty": 6, "samples": [["10\nponoiiipoi\n2 1 4 7 4 8 3 6 4 7", "45 56\n10 56\n3 32\n0 0\n0 0\n0 0\n0 0\n0 0\n0 0\n0 0"], ["12\nabaabaabaaba\n1 -2 3 -4 5 -6 7 -8 9 -10 11 -12\n", "66 120\n34 120\n15 55\n12 40\n9 27\n7 16\n5 7\n3 -4\n2 -4\n1 -4\n0 0\n0 0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "并查集", "NOI", "后缀数组 SA"], "title": "[NOI2015] 品酒大会", "background": null, "description": "一年一度的“幻影阁夏日品酒大会”隆重开幕了。大会包含品尝和趣味挑战 两个环节，分别向优胜者颁发“首席品酒家”和“首席猎手”两个奖项，吸引了众多品酒师参加。\n\n\n在大会的晚餐上，调酒师 Rainbow 调制了 $n$ 杯鸡尾酒。这 $n$ 杯鸡尾酒排成一行，其中第 $i$ 杯酒 ($1 \\le i \\le n$) 被贴上了一个标签 $s_i$ ，每个标签都是 $26$ 个小写 英文字母之一。设 $str(l, r)$ 表示第 $l$ 杯酒到第 $r$ 杯酒的 $r - l + 1$ 个标签顺次连接构成的字符串。若 $str(p, p_0) = str(q, q_0)$，其中 $1 \\le p \\le p_0 \\le n$, $1 \\le q \\le q_0 \\le n$，$p \\ne q$，$p_0-p+1 = q_0 - q + 1 = r$ ，则称第 $p$ 杯酒与第 $q$ 杯酒是“ $r$ 相似” 的。当然两杯“$r$ 相似”（$r > 1$）的酒同时也是“$1$ 相似”、“$2$ 相似”、……、“$(r - 1)$ 相似”的。特别地，对于任意的 $1 \\le p,q \\le n,p \\ne q$，第 $p$ 杯酒和第 $q$ 杯酒都 是“$0$ 相似”的。\n\n\n在品尝环节上，品酒师 Freda 轻松地评定了每一杯酒的美味度，凭借其专业的水准和经验成功夺取了“首席品酒家”的称号，其中第 $i$ 杯酒 ($1 \\le i \\le n$) 的 美味度为 $a_i$ 。现在 Rainbow 公布了挑战环节的问题：本次大会调制的鸡尾酒有一个特点，如果把第 $p$ 杯酒与第 $q$ 杯酒调兑在一起，将得到一杯美味度为 $a_p\\times a_q$ 的酒。现在请各位品酒师分别对于 $r = 0,1,2,\\dots,n-1$，统计出有多少种方法可以 选出 $2$ 杯“$r$ 相似”的酒，并回答选择 $2$ 杯“$r$ 相似”的酒调兑可以得到的美味度的最大值。", "inputFormat": "第 $1$ 行包含 $1$ 个正整数 $n$，表示鸡尾酒的杯数。\n\n第 $2$ 行包含一个长度为 $n$ 的字符串 $S$，其中第 $i$ 个字符表示第 $i$ 杯酒的标签。\n\n第 $3$ 行包含 $n$ 个整数，相邻整数之间用单个空格隔开，其中第 $i$ 个整数表示第 $i$ 杯酒的美味度 $a_i$。", "outputFormat": "包括 $n$ 行。\n\n第 $i$ 行输出 $2$ 个整数，中间用单个空格隔开。第 $1$ 个整 数表示选出两杯“$(i - 1)$ 相似”的酒的方案数，第 2 个整数表示选出两杯“$(i - 1)$ 相似”的酒调兑可以得到的最大美味度。若不存在两杯“$(i - 1)$ 相似”的酒，这两个数均为 $0$。", "hint": "【样例说明 1】\n\n用二元组 $(p, q)$ 表示第 $p$ 杯酒与第 $q$ 杯酒。\n\n$0$ 相似：所有 $45$ 对二元组都是 $0$ 相似的，美味度最大的是 $8 \\times 7 = 56$。\n\n$1$ 相似： $(1,8) (2,4) (2,9) (4,9) (5,6) (5,7) (5,10) (6,7) (6,10) (7,10) $，最大的 $8 \\times 7 = 56$ 。\n\n$2$ 相似： $(1,8) (4,9) (5,6)$ ，最大的 $4 \\times 8 = 32$ 。\n\n没有 $3,4,5,\\dots,9$ 相似的两杯酒，故均输出 $0$ 。\n\n\n\n ![](https://cdn.luogu.com.cn/upload/pic/1508.png) \n\n【时限1s，内存500M】", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2015] Wine Tasting Convention", "background": "", "description": "The annual \"Phantom Pavilion Summer Wine Tasting Convention\" has grandly opened. The convention consists of two parts: tasting and a fun challenge. They award two titles, \"Chief Taster\" and \"Chief Hunter\", attracting many sommeliers to participate.\n\nAt the dinner, the bartender Rainbow mixed $n$ cocktails. These $n$ cocktails are arranged in a line. The $i$-th glass ($1 \\le i \\le n$) is labeled $s_i$, where each label is one of the $26$ lowercase English letters. Let $str(l, r)$ denote the string formed by concatenating the $r - l + 1$ labels from the $l$-th glass to the $r$-th glass in order. If $str(p, p_0) = str(q, q_0)$, where $1 \\le p \\le p_0 \\le n$, $1 \\le q \\le q_0 \\le n$, $p \\ne q$, and $p_0 - p + 1 = q_0 - q + 1 = r$, then we say the $p$-th glass and the $q$-th glass are r-similar. Of course, if two glasses are r-similar (with $r > 1$), then they are also 1-similar, 2-similar, …, and $(r - 1)$-similar. In particular, for any $1 \\le p, q \\le n$, $p \\ne q$, the $p$-th and the $q$-th glasses are 0-similar.\n\nIn the tasting part, the sommelier Freda easily evaluated the deliciousness of each glass and won the title of \"Chief Taster\" with her professional skill and experience. The deliciousness of the $i$-th glass ($1 \\le i \\le n$) is $a_i$. Now Rainbow announces the challenge: the cocktails in this convention have a special property—if you mix the $p$-th glass with the $q$-th glass, you obtain a glass with deliciousness $a_p \\times a_q$. For each $r = 0, 1, 2, \\dots, n - 1$, please count how many ways there are to choose two r-similar glasses, and report the maximum deliciousness obtainable by mixing two r-similar glasses.", "inputFormat": "The first line contains a positive integer $n$, the number of glasses.\n\nThe second line contains a string $S$ of length $n$, where the $i$-th character is the label of the $i$-th glass.\n\nThe third line contains $n$ integers separated by single spaces, where the $i$-th integer is the deliciousness $a_i$ of the $i$-th glass.", "outputFormat": "Output $n$ lines.\n\nOn the $i$-th line, output two integers separated by a single space. The first integer is the number of ways to choose two $(i - 1)$-similar glasses, and the second integer is the maximum deliciousness obtainable by mixing two $(i - 1)$-similar glasses. If there are no two $(i - 1)$-similar glasses, output $0 0$.", "hint": "[Sample explanation 1]\n\nUse an ordered pair $(p, q)$ to denote the $p$-th glass and the $q$-th glass.\n\n0-similar: all $45$ ordered pairs are 0-similar, and the maximum deliciousness is $8 \\times 7 = 56$.\n\n1-similar: $(1, 8) (2, 4) (2, 9) (4, 9) (5, 6) (5, 7) (5, 10) (6, 7) (6, 10) (7, 10)$, with maximum $8 \\times 7 = 56$.\n\n2-similar: $(1, 8) (4, 9) (5, 6)$, with maximum $4 \\times 8 = 32$.\n\nThere are no 3-, 4-, 5-, …, 9-similar pairs of glasses, so output $0$.\n\n![](https://cdn.luogu.com.cn/upload/pic/1508.png)\n\n[Time limit 1 s, Memory limit 500 MB]\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2015] 品酒大会", "background": null, "description": "一年一度的“幻影阁夏日品酒大会”隆重开幕了。大会包含品尝和趣味挑战 两个环节，分别向优胜者颁发“首席品酒家”和“首席猎手”两个奖项，吸引了众多品酒师参加。\n\n\n在大会的晚餐上，调酒师 Rainbow 调制了 $n$ 杯鸡尾酒。这 $n$ 杯鸡尾酒排成一行，其中第 $i$ 杯酒 ($1 \\le i \\le n$) 被贴上了一个标签 $s_i$ ，每个标签都是 $26$ 个小写 英文字母之一。设 $str(l, r)$ 表示第 $l$ 杯酒到第 $r$ 杯酒的 $r - l + 1$ 个标签顺次连接构成的字符串。若 $str(p, p_0) = str(q, q_0)$，其中 $1 \\le p \\le p_0 \\le n$, $1 \\le q \\le q_0 \\le n$，$p \\ne q$，$p_0-p+1 = q_0 - q + 1 = r$ ，则称第 $p$ 杯酒与第 $q$ 杯酒是“ $r$ 相似” 的。当然两杯“$r$ 相似”（$r > 1$）的酒同时也是“$1$ 相似”、“$2$ 相似”、……、“$(r - 1)$ 相似”的。特别地，对于任意的 $1 \\le p,q \\le n,p \\ne q$，第 $p$ 杯酒和第 $q$ 杯酒都 是“$0$ 相似”的。\n\n\n在品尝环节上，品酒师 Freda 轻松地评定了每一杯酒的美味度，凭借其专业的水准和经验成功夺取了“首席品酒家”的称号，其中第 $i$ 杯酒 ($1 \\le i \\le n$) 的 美味度为 $a_i$ 。现在 Rainbow 公布了挑战环节的问题：本次大会调制的鸡尾酒有一个特点，如果把第 $p$ 杯酒与第 $q$ 杯酒调兑在一起，将得到一杯美味度为 $a_p\\times a_q$ 的酒。现在请各位品酒师分别对于 $r = 0,1,2,\\dots,n-1$，统计出有多少种方法可以 选出 $2$ 杯“$r$ 相似”的酒，并回答选择 $2$ 杯“$r$ 相似”的酒调兑可以得到的美味度的最大值。", "inputFormat": "第 $1$ 行包含 $1$ 个正整数 $n$，表示鸡尾酒的杯数。\n\n第 $2$ 行包含一个长度为 $n$ 的字符串 $S$，其中第 $i$ 个字符表示第 $i$ 杯酒的标签。\n\n第 $3$ 行包含 $n$ 个整数，相邻整数之间用单个空格隔开，其中第 $i$ 个整数表示第 $i$ 杯酒的美味度 $a_i$。", "outputFormat": "包括 $n$ 行。\n\n第 $i$ 行输出 $2$ 个整数，中间用单个空格隔开。第 $1$ 个整 数表示选出两杯“$(i - 1)$ 相似”的酒的方案数，第 2 个整数表示选出两杯“$(i - 1)$ 相似”的酒调兑可以得到的最大美味度。若不存在两杯“$(i - 1)$ 相似”的酒，这两个数均为 $0$。", "hint": "【样例说明 1】\n\n用二元组 $(p, q)$ 表示第 $p$ 杯酒与第 $q$ 杯酒。\n\n$0$ 相似：所有 $45$ 对二元组都是 $0$ 相似的，美味度最大的是 $8 \\times 7 = 56$。\n\n$1$ 相似： $(1,8) (2,4) (2,9) (4,9) (5,6) (5,7) (5,10) (6,7) (6,10) (7,10) $，最大的 $8 \\times 7 = 56$ 。\n\n$2$ 相似： $(1,8) (4,9) (5,6)$ ，最大的 $4 \\times 8 = 32$ 。\n\n没有 $3,4,5,\\dots,9$ 相似的两杯酒，故均输出 $0$ 。\n\n\n\n ![](https://cdn.luogu.com.cn/upload/pic/1508.png) \n\n【时限1s，内存500M】", "locale": "zh-CN"}}}
{"pid": "P2179", "type": "P", "difficulty": 7, "samples": [["3 10000\n10000 10 5\n20000 15 8\n50000 5 6", "12531.34496464"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "2012", "NOI", "Special Judge", "向量", "构造", "拉格朗日乘数法"], "title": "[NOI2012] 骑行川藏", "background": "", "description": "蛋蛋非常热衷于挑战自我，今年暑假他准备沿川藏线骑着自行车从成都前往拉萨。\n\n川藏线的沿途有着非常美丽的风景，但在这一路上也有着很多的艰难险阻，路况变化多端，而蛋蛋的体力十分有限,因此在每天的骑行前设定好目的地，同时合理分配好自己的体力是一件非常重要的事情。\n\n由于蛋蛋装备了一辆非常好的自行车，因此在骑行过程中可以认为他仅在克服风阻做功（不受自行车本身摩擦力以及自行车与地面的摩擦力影响）。\n\n某一天他打算骑 $n$ 段路，每一段内的路况可视为相同：对于第 $i$ 段路,我们给出有关这段路况的 $3$ 个参数 $s_i,k_i,v_i'$，其中 $s_i$ 表示这段路的长度，$k_i$ 表示这段路的风阻系数，$v_i'$ 表示这段路上的风速（$v_i'\\gt 0$ 表示在这段路上他遇到了顺风，反之则意味着他将受逆风影响）。\n\n若某一时刻在这段路上骑车速度为 $v$，则他受到的风阻\n大小为 $F=k_i(v-v_i')^2$（这样若在长度为 $s$ 的路程内保持骑行速度 $v$ 不变,则他消耗能量（做功）$E=k_i(v-v_i')^2s$ ）。\n\n设蛋蛋在这天开始时的体能值是 $E_U$，请帮助他设计一种行车方案,使他在有限的体力内用最短的时间到达目的地。请告诉他最短的时间 $T$ 是多少。", "inputFormat": "第一行包含一个正整数 $n$ 和一个实数 $E_U$，分别表示路段的数量以及蛋蛋的体能值。\n\n接下来 $n$ 行分别描述 $n$ 个路段，每行有 $3$ 个实数 $s_i,k_i,v_i'$ 分别表示第 $i$ 段路的长度，风阻系数以及风速。", "outputFormat": "输出一个实数 $T$，表示蛋蛋到达目的地消耗的最短时间，要求至少保留到小数点后 $6$ 位。", "hint": "### 样例说明\n\n一种可能的方案是：蛋蛋在三段路上都采用匀速骑行的方式,其速度依次为 $5.12939919,8.03515481,6.17837967$。\n\n### 评分方法\n\n本题没有部分分,你程序的输出只有和标准答案的差距不超过 $10^{-6}$ 时，才能获得该测试点的满分，否则不得分。\n\n### 数据规模与约定\n\n对于 $10\\%$  的数据，$n=1$。\n\n对于 $40\\%$  的数据，$n\\le2$。\n\n对于 $60\\%$  的数据，$n\\le100$。\n\n对于 $80\\%$  的数据，$n\\le 1000$。\n\n对于 $100\\%$  的数据，$n\\le 10^4$，$E_U\\le 10^8$，$s_i\\in[0,10^5]$，$k_i\\in(0,15]$，$v_i'\\in(-100,100)$。\n\n数据保证最终的答案不会超过 $10^5$。\n\n### 提示\n\n必然存在一种最优的体力方案满足：蛋蛋在每段路上都采用匀速骑行的方式。", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2012] Cycling the Sichuan–Tibet Route", "background": "", "description": "Dandan is very enthusiastic about challenging himself. This summer vacation he plans to ride a bicycle along the Sichuan–Tibet route from Chengdu to Lhasa.\n\nThe scenery along the Sichuan–Tibet route is beautiful, but there are many difficulties and changing road conditions along the way. Dandan’s stamina is limited, so before each day’s ride he sets a destination for the day and allocates his energy reasonably, which is very important.\n\nBecause Dandan is equipped with a very good bicycle, we can assume that during the ride he only does work to overcome air resistance (he is not affected by friction inside the bicycle or between the bicycle and the ground).\n\nOn a certain day he plans to ride $n$ segments. Within each segment the road condition can be considered uniform: for the $i$-th segment, we are given three parameters $s_i,k_i,v_i'$, where $s_i$ is the length of the segment, $k_i$ is the air-drag coefficient for the segment, and $v_i'$ is the wind speed on the segment ($v_i' \\gt 0$ means tailwind on that segment; otherwise, it means headwind).\n\nIf at some moment his riding speed on this segment is $v$, then the magnitude of the air-drag force is $F=k_i(v-v_i')^2$ (therefore, if he maintains a constant speed $v$ over a distance $s$, he expends energy (does work) $E=k_i(v-v_i')^2s$).\n\nSuppose Dandan’s energy budget at the start of the day is $E_U$. Please help him design a riding plan so that he reaches the destination in the shortest possible time within his energy budget. Please output the minimal time $T$.", "inputFormat": "The first line contains a positive integer $n$ and a real number $E_U$, representing the number of segments and Dandan’s energy budget, respectively.\n\nThe next $n$ lines describe the $n$ segments. Each line contains three real numbers $s_i,k_i,v_i'$ representing the length, air-drag coefficient, and wind speed of the $i$-th segment.", "outputFormat": "Output a real number $T$, the minimal time for Dandan to reach the destination. Keep at least $6$ digits after the decimal point.", "hint": "- Sample explanation:\n  One possible plan is: Dandan rides at a constant speed on each of the three segments, with speeds $5.12939919, 8.03515481, 6.17837967$.\n\n- Scoring:\n  There are no partial scores. Your output must differ from the standard answer by no more than $10^{-6}$ to receive full score on a test point; otherwise you get zero for that point.\n\n- Constraints:\n  For $10\\%$ of the testdata, $n=1$.\n  \n  For $40\\%$ of the testdata, $n\\le 2$.\n  \n  For $60\\%$ of the testdata, $n\\le 100$.\n  \n  For $80\\%$ of the testdata, $n\\le 1000$.\n  \n  For $100\\%$ of the testdata, $n\\le 10^4$, $E_U\\le 10^8$, $s_i\\in[0,10^5]$, $k_i\\in(0,15]$, $v_i'\\in(-100,100)$.\n  \n  The final answer is guaranteed not to exceed $10^5$.\n\n- Additional hint:\n  There always exists an optimal energy allocation in which Dandan rides at a constant speed on every segment.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2012] 骑行川藏", "background": "", "description": "蛋蛋非常热衷于挑战自我，今年暑假他准备沿川藏线骑着自行车从成都前往拉萨。\n\n川藏线的沿途有着非常美丽的风景，但在这一路上也有着很多的艰难险阻，路况变化多端，而蛋蛋的体力十分有限,因此在每天的骑行前设定好目的地，同时合理分配好自己的体力是一件非常重要的事情。\n\n由于蛋蛋装备了一辆非常好的自行车，因此在骑行过程中可以认为他仅在克服风阻做功（不受自行车本身摩擦力以及自行车与地面的摩擦力影响）。\n\n某一天他打算骑 $n$ 段路，每一段内的路况可视为相同：对于第 $i$ 段路,我们给出有关这段路况的 $3$ 个参数 $s_i,k_i,v_i'$，其中 $s_i$ 表示这段路的长度，$k_i$ 表示这段路的风阻系数，$v_i'$ 表示这段路上的风速（$v_i'\\gt 0$ 表示在这段路上他遇到了顺风，反之则意味着他将受逆风影响）。\n\n若某一时刻在这段路上骑车速度为 $v$，则他受到的风阻\n大小为 $F=k_i(v-v_i')^2$（这样若在长度为 $s$ 的路程内保持骑行速度 $v$ 不变,则他消耗能量（做功）$E=k_i(v-v_i')^2s$ ）。\n\n设蛋蛋在这天开始时的体能值是 $E_U$，请帮助他设计一种行车方案,使他在有限的体力内用最短的时间到达目的地。请告诉他最短的时间 $T$ 是多少。", "inputFormat": "第一行包含一个正整数 $n$ 和一个实数 $E_U$，分别表示路段的数量以及蛋蛋的体能值。\n\n接下来 $n$ 行分别描述 $n$ 个路段，每行有 $3$ 个实数 $s_i,k_i,v_i'$ 分别表示第 $i$ 段路的长度，风阻系数以及风速。", "outputFormat": "输出一个实数 $T$，表示蛋蛋到达目的地消耗的最短时间，要求至少保留到小数点后 $6$ 位。", "hint": "### 样例说明\n\n一种可能的方案是：蛋蛋在三段路上都采用匀速骑行的方式,其速度依次为 $5.12939919,8.03515481,6.17837967$。\n\n### 评分方法\n\n本题没有部分分,你程序的输出只有和标准答案的差距不超过 $10^{-6}$ 时，才能获得该测试点的满分，否则不得分。\n\n### 数据规模与约定\n\n对于 $10\\%$  的数据，$n=1$。\n\n对于 $40\\%$  的数据，$n\\le2$。\n\n对于 $60\\%$  的数据，$n\\le100$。\n\n对于 $80\\%$  的数据，$n\\le 1000$。\n\n对于 $100\\%$  的数据，$n\\le 10^4$，$E_U\\le 10^8$，$s_i\\in[0,10^5]$，$k_i\\in(0,15]$，$v_i'\\in(-100,100)$。\n\n数据保证最终的答案不会超过 $10^5$。\n\n### 提示\n\n必然存在一种最优的体力方案满足：蛋蛋在每段路上都采用匀速骑行的方式。", "locale": "zh-CN"}}}
{"pid": "P2180", "type": "P", "difficulty": 3, "samples": [["3 3 8", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "数学", "洛谷原创"], "title": "摆石子", "background": "我们伟大的 KK 突然想到了一个很高明的问题。", "description": "我们伟大的 KK 在 $N$ 条水平线与 $M$ 条竖直线构成的网格中（KK 的自创坐标系），放 $K$ 枚石子，每个石子都只能放在网格的交叉点上。\n\n现在 KK 想知道在最优的摆放方式下，最多可以找到多少四边平行于坐标轴的长方形，而且 KK 要求它的四个角上都恰好放着一枚石子。", "inputFormat": "一行三个整数 $N,M,K$。", "outputFormat": "一行输出一个整数，表示最多的满足条件的长方形数量。", "hint": "对于 $50\\%$ 的数据，$N,M \\le 30$。\n\n对于 $100\\%$ 的数据，$1 \\le N,M \\le 3 \\times 10^4$，$0 \\le K \\le N \\times M$。", "locale": "zh-CN", "translations": {"en": {"title": "Placing Stones", "background": "Our great KK suddenly came up with a very clever problem.", "description": "In a grid formed by $N$ horizontal lines and $M$ vertical lines (KK's self-made coordinate system), KK places $K$ stones, each stone only allowed to be placed at an intersection point of the grid.\n\nNow KK wants to know, under the optimal placement, the maximum number of rectangles whose sides are parallel to the coordinate axes, and he requires that each of the four vertices of such a rectangle has exactly one stone placed on it.", "inputFormat": "One line with three integers $N, M, K$.", "outputFormat": "Output one integer on a single line, representing the maximum number of rectangles that meet the requirement.", "hint": "Constraints:\n- For $50\\%$ of the testdata, $N, M \\le 30$.\n- For $100\\%$ of the testdata, $1 \\le N, M \\le 3 \\times 10^4$, $0 \\le K \\le N \\times M$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "摆石子", "background": "我们伟大的 KK 突然想到了一个很高明的问题。", "description": "我们伟大的 KK 在 $N$ 条水平线与 $M$ 条竖直线构成的网格中（KK 的自创坐标系），放 $K$ 枚石子，每个石子都只能放在网格的交叉点上。\n\n现在 KK 想知道在最优的摆放方式下，最多可以找到多少四边平行于坐标轴的长方形，而且 KK 要求它的四个角上都恰好放着一枚石子。", "inputFormat": "一行三个整数 $N,M,K$。", "outputFormat": "一行输出一个整数，表示最多的满足条件的长方形数量。", "hint": "对于 $50\\%$ 的数据，$N,M \\le 30$。\n\n对于 $100\\%$ 的数据，$1 \\le N,M \\le 3 \\times 10^4$，$0 \\le K \\le N \\times M$。", "locale": "zh-CN"}}}
{"pid": "P2181", "type": "P", "difficulty": 3, "samples": [["3", "0"], ["6", "15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "洛谷原创", "组合数学"], "title": "对角线", "background": "", "description": "对于一个 $n$ 个顶点的凸多边形，它的任何三条对角线都不会交于一点。请求出图形中对角线交点的个数。\n\n例如，$6$ 边形：\n\n![](https://cdn.luogu.com.cn/upload/pic/6023.png)", "inputFormat": "输入只有一行一个整数 $n$，代表边数。", "outputFormat": "输出一行一个整数代表答案。", "hint": "#### 数据规模与约定\n\n- 对于 $50 \\%$ 的数据，保证 $3 \\leq n \\leq 100$。\n- 对于 $100 \\%$ 的数据，保证 $3 \\leq n \\leq 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "Diagonals", "background": "", "description": "For an $n$-vertex convex polygon in which no three diagonals intersect at a single point, find the number of intersection points among its diagonals.\n\nFor example, a $6$-gon:\n\n![](https://cdn.luogu.com.cn/upload/pic/6023.png)", "inputFormat": "The input contains a single line with an integer $n$, the number of sides.", "outputFormat": "Output a single integer on one line: the answer.", "hint": "Constraints\n\n- For $50 \\%$ of the testdata, it is guaranteed that $3 \\leq n \\leq 100$.\n- For $100 \\%$ of the testdata, it is guaranteed that $3 \\leq n \\leq 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "对角线", "background": "", "description": "对于一个 $n$ 个顶点的凸多边形，它的任何三条对角线都不会交于一点。请求出图形中对角线交点的个数。\n\n例如，$6$ 边形：\n\n![](https://cdn.luogu.com.cn/upload/pic/6023.png)", "inputFormat": "输入只有一行一个整数 $n$，代表边数。", "outputFormat": "输出一行一个整数代表答案。", "hint": "#### 数据规模与约定\n\n- 对于 $50 \\%$ 的数据，保证 $3 \\leq n \\leq 100$。\n- 对于 $100 \\%$ 的数据，保证 $3 \\leq n \\leq 10^5$。", "locale": "zh-CN"}}}
{"pid": "P2182", "type": "P", "difficulty": 5, "samples": [["3 2 1\n100\n001", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "组合数学"], "title": "翻硬币", "background": null, "description": "小 Z 离开家的时候忘记带走了钱包，掉下的硬币在桌子上排成了一列。正在等着哥哥回来的小 D 坐在桌子旁边，无聊地翻着桌子上的硬币。\n\n出于某种爱好，小 D 一次一定会同时翻转 $M$ 枚硬币。由于小 D 是一个爱动脑的小学生，这样进行了若干次之后她很快想到了一个问题：有多少种方法能够在 $K$ 次翻转后把硬币由原来的状态变成现在这样呢？\n\n因为小 D 是个好学的小学生，她只需要你告诉她方案数对 $10^9+7$ 取模的值以方便她进行验算就可以了。", "inputFormat": "第一行，包含三个字符 $N,K,M$，表示硬币的数量，翻转的次数和每次翻转的硬币数量。\n\n第 $2 \\sim 3$ 行，包含 $N$ 个数字，表示硬币在一开始的状态和最终要变成的状态。$1$ 表示正面而 $0$ 表示背面。", "outputFormat": "一行包含一个整数，表示方案数对 $10^9+7$ 取模的值。", "hint": "### 样例解释\n\n存在两种方案：\n\n- $100 \\to 101 \\to 001$；\n- $100 \\to 000 \\to 001$。\n\n### 数据规模\n\n- 对于 $30\\%$ 的数据，$N \\le 4$，$0 \\le K \\le 5$；\n- 对于 $60\\%$ 的数据，$N \\le 10$；\n- 对于 $100\\%$ 的数据，$1 \\le N \\le 100$，$0 \\le K \\le 100$，$0 \\le M \\le N$。", "locale": "zh-CN", "translations": {"en": {"title": "Flipping Coins", "background": "", "description": "When Xiao Z left home, he forgot his wallet, and the dropped coins lined up on the table. Xiao D, who is waiting for her older brother to come back, sits by the table and idly flips the coins.\n\nOut of a personal preference, Xiao D always flips exactly $M$ coins at the same time in each operation. Since Xiao D is a thoughtful elementary school student, after doing this several times she quickly came up with a question: in how many ways can the coins be transformed from the original state to the current state in exactly $K$ flips?\n\nBecause Xiao D is a diligent student, she only needs you to tell her the number of ways modulo $10^9+7$ so that she can check her work.", "inputFormat": "- The first line contains three integers $N$, $K$, $M$, representing the number of coins, the number of flips, and the number of coins flipped each time.\n- The second and third lines each contain a string of length $N$, representing the initial state and the final state. Character '1' denotes heads, and '0' denotes tails.", "outputFormat": "Output a single integer, the number of ways modulo $10^9+7$.", "hint": "- Sample explanation:\n\nThere are two ways:\n- $100 \\to 101 \\to 001$;\n- $100 \\to 000 \\to 001$.\n\n- Constraints:\n  - For $30\\%$ of the testdata, $N \\le 4$, $0 \\le K \\le 5$.\n  - For $60\\%$ of the testdata, $N \\le 10$.\n  - For $100\\%$ of the testdata, $1 \\le N \\le 100$, $0 \\le K \\le 100$, $0 \\le M \\le N$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "翻硬币", "background": null, "description": "小 Z 离开家的时候忘记带走了钱包，掉下的硬币在桌子上排成了一列。正在等着哥哥回来的小 D 坐在桌子旁边，无聊地翻着桌子上的硬币。\n\n出于某种爱好，小 D 一次一定会同时翻转 $M$ 枚硬币。由于小 D 是一个爱动脑的小学生，这样进行了若干次之后她很快想到了一个问题：有多少种方法能够在 $K$ 次翻转后把硬币由原来的状态变成现在这样呢？\n\n因为小 D 是个好学的小学生，她只需要你告诉她方案数对 $10^9+7$ 取模的值以方便她进行验算就可以了。", "inputFormat": "第一行，包含三个字符 $N,K,M$，表示硬币的数量，翻转的次数和每次翻转的硬币数量。\n\n第 $2 \\sim 3$ 行，包含 $N$ 个数字，表示硬币在一开始的状态和最终要变成的状态。$1$ 表示正面而 $0$ 表示背面。", "outputFormat": "一行包含一个整数，表示方案数对 $10^9+7$ 取模的值。", "hint": "### 样例解释\n\n存在两种方案：\n\n- $100 \\to 101 \\to 001$；\n- $100 \\to 000 \\to 001$。\n\n### 数据规模\n\n- 对于 $30\\%$ 的数据，$N \\le 4$，$0 \\le K \\le 5$；\n- 对于 $60\\%$ 的数据，$N \\le 10$；\n- 对于 $100\\%$ 的数据，$1 \\le N \\le 100$，$0 \\le K \\le 100$，$0 \\le M \\le N$。", "locale": "zh-CN"}}}
{"pid": "P2183", "type": "P", "difficulty": 6, "samples": [["100\n4 2\n1\n2\n", "12"], ["100\n2 2\n1\n2", "Impossible\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "集训队互测", "中国剩余定理 CRT", "Lucas 定理"], "title": "[国家集训队] 礼物", "background": "一年一度的圣诞节快要来到了。每年的圣诞节小 E 都会收到许多礼物，当然他也会送出许多礼物。不同的人物在小 E 心目中的重要性不同，在小 E 心中分量越重的人，收到的礼物会越多。", "description": "小 E 从商店中购买了 $n$ 件礼物，打算送给 $m$ 个人，其中送给第 $i$ 个人礼物数量为 $w_i$。请你帮忙计算出送礼物的方案数（两个方案被认为是不同的，当且仅当存在某个人在这两种方案中收到的礼物不同）。由于方案数可能会很大，你只需要输出模 $P$ 后的结果。\n", "inputFormat": "输入的第一行包含一个整数 $P$，表示模数。  \n第二行包含两个整数 $n$ 和 $m$，分别表示小 E 从商店购买的礼物数和接受礼物的人数。  \n第 $3$ 到第 $(m + 2)$ 行，每行一个整数，第 $(i + 2)$ 行的整数 $w_i$ 表示送给第 $i$ 个人的礼物数量。", "outputFormat": "若不存在可行方案，则输出 `Impossible`，否则输出一个整数，表示模 $P$ 后的方案数。\n", "hint": "### 样例 1 解释\n以 `/` 分割，`/` 前后分别表示送给第一个人和第二个人的礼物编号。$12$ 种方案详情如下：\n```plain\n1/23 1/24 1/34\n2/13 2/14 2/34\n3/12 3/14 3/24\n4/12 4/13 4/23\n```\n### 数据规模与约定\n设 $P= \\prod_{i=1}^t p_i^{c_i}$，$p_i$ 为质数。\n\n对于 $15\\%$ 的数据，$n\\leq 15$，$m\\leq 5$，$p_i^{c_i}\\leq 10^5$。\n\n在剩下的 $85\\%$ 数据中，约有 $60\\%$ 的数据满足 $t\\leq 2$，$c_i=1$，$p_i\\leq 10^5$，约有 $30\\%$ 的数据满足 $p_i\\leq 200$。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 10^9$，$1\\leq m\\leq 5$，$1\\leq p_i^{c_i}\\leq 10^5$，$1\\leq w_i \\leq P\\leq 10^9$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[CTT] Gift", "background": "Christmas is coming. Every year, Xiao E receives many gifts, and of course he also gives many gifts. Different people have different levels of importance in Xiao E’s mind; the more important someone is, the more gifts they receive.", "description": "Xiao E bought $n$ gifts from a store and plans to give them to $m$ people, where the number of gifts given to the $i$-th person is $w_i$. Please help compute the number of ways to give out the gifts (two ways are considered different if and only if there exists a person who receives different gifts in the two ways). Since the number of ways can be very large, you only need to output the result modulo $P$.", "inputFormat": "The first line contains an integer $P$, the modulus.  \nThe second line contains two integers $n$ and $m$, representing the number of gifts Xiao E bought and the number of recipients, respectively.  \nLines $3$ to $(m + 2)$: each line contains an integer; the integer on the $(i + 2)$-th line $w_i$ denotes the number of gifts given to the $i$-th person.", "outputFormat": "If there is no feasible way, output `Impossible`; otherwise, output a single integer representing the number of ways modulo $P$.", "hint": "### Explanation for Sample 1\nSeparated by `/`, where the parts before and after `/` represent the gift IDs for the first and second persons, respectively. The $12$ possible ways are as follows:\n```plain\n1/23 1/24 1/34\n2/13 2/14 2/34\n3/12 3/14 3/24\n4/12 4/13 4/23\n```\n\n### Constraints\nLet $P= \\prod_{i=1}^t p_i^{c_i}$, where $p_i$ is a prime.\n\nFor $15\\%$ of the testdata, $n\\leq 15$, $m\\leq 5$, $p_i^{c_i}\\leq 10^5$.\n\nIn the remaining $85\\%$ of the testdata, about $60\\%$ satisfy $t\\leq 2$, $c_i=1$, $p_i\\leq 10^5$, and about $30\\%$ satisfy $p_i\\leq 200$.\n\nFor $100\\%$ of the testdata, $1\\leq n\\leq 10^9$, $1\\leq m\\leq 5$, $1\\leq p_i^{c_i}\\leq 10^5$, $1\\leq w_i \\leq P\\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[国家集训队] 礼物", "background": "一年一度的圣诞节快要来到了。每年的圣诞节小 E 都会收到许多礼物，当然他也会送出许多礼物。不同的人物在小 E 心目中的重要性不同，在小 E 心中分量越重的人，收到的礼物会越多。", "description": "小 E 从商店中购买了 $n$ 件礼物，打算送给 $m$ 个人，其中送给第 $i$ 个人礼物数量为 $w_i$。请你帮忙计算出送礼物的方案数（两个方案被认为是不同的，当且仅当存在某个人在这两种方案中收到的礼物不同）。由于方案数可能会很大，你只需要输出模 $P$ 后的结果。\n", "inputFormat": "输入的第一行包含一个整数 $P$，表示模数。  \n第二行包含两个整数 $n$ 和 $m$，分别表示小 E 从商店购买的礼物数和接受礼物的人数。  \n第 $3$ 到第 $(m + 2)$ 行，每行一个整数，第 $(i + 2)$ 行的整数 $w_i$ 表示送给第 $i$ 个人的礼物数量。", "outputFormat": "若不存在可行方案，则输出 `Impossible`，否则输出一个整数，表示模 $P$ 后的方案数。\n", "hint": "### 样例 1 解释\n以 `/` 分割，`/` 前后分别表示送给第一个人和第二个人的礼物编号。$12$ 种方案详情如下：\n```plain\n1/23 1/24 1/34\n2/13 2/14 2/34\n3/12 3/14 3/24\n4/12 4/13 4/23\n```\n### 数据规模与约定\n设 $P= \\prod_{i=1}^t p_i^{c_i}$，$p_i$ 为质数。\n\n对于 $15\\%$ 的数据，$n\\leq 15$，$m\\leq 5$，$p_i^{c_i}\\leq 10^5$。\n\n在剩下的 $85\\%$ 数据中，约有 $60\\%$ 的数据满足 $t\\leq 2$，$c_i=1$，$p_i\\leq 10^5$，约有 $30\\%$ 的数据满足 $p_i\\leq 200$。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 10^9$，$1\\leq m\\leq 5$，$1\\leq p_i^{c_i}\\leq 10^5$，$1\\leq w_i \\leq P\\leq 10^9$。\n", "locale": "zh-CN"}}}
{"pid": "P2184", "type": "P", "difficulty": 4, "samples": [["5 4\n1 1 3\n2 2 5\n1 2 4\n2 3 5\n", "1\n2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["线段树", "树状数组", "差分"], "title": "贪婪大陆", "background": "面对蚂蚁们的疯狂进攻，小 FF 的 Tower defence 宣告失败……人类被蚂蚁们逼到了 Greed Island 上的一个海湾。现在，小 FF 的后方是一望无际的大海，前方是变异了的超级蚂蚁。小 FF 还有大好前程，他可不想命丧于此， 于是他派遣手下最后一批改造 SCV 布置地雷以阻挡蚂蚁们的进攻。", "description": "小 FF 最后一道防线是一条长度为 $n$ 的战壕，小 FF 拥有无数多种地雷，而 SCV 每次可以在 $[L, R]$ 区间埋放同一种不同于之前已经埋放的地雷。由于情况已经十万火急，小 FF 在某些时候可能会询问你在 $[L',R']$ 区间内有多少种不同的地雷，他希望你能尽快的给予答复。", "inputFormat": "第一行为两个整数 $n$ 和 $m$，$n$ 表示防线长度，$m$ 表示 SCV 布雷次数及小 FF 询问的次数总和。\n\n接下来有 $m$ 行，每行三个整数 $q,l,r$：\n\n- 若 $q=1$，则表示 SCV 在 $[l, r]$ 这段区间布上一种地雷；\n- 若 $q=2$，则表示小 FF 询问当前 $[l, r]$ 区间总共有多少种地雷。", "outputFormat": "对于小 FF 的每次询问，输出一个答案（单独一行），表示当前区间地雷种数。", "hint": "### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，$0 \\le n$，$m \\le 1000$。\n- 对于 $100\\%$ 的数据，$0 \\le n$，$m \\le 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "Greed Island", "background": "Facing the frenzied assault of the ants, Xiao FF’s Tower defence has failed. Humans have been forced into a bay on Greed Island. Now, behind Xiao FF lies the boundless sea, and ahead are mutated super ants. Xiao FF still has a bright future and does not want to die here, so he sends his last batch of modified SCVs to lay mines to stop the ants’ advance.", "description": "Xiao FF’s last line of defense is a trench of length $n$. Xiao FF has infinitely many types of mines, and each time an SCV can lay mines of a single type on the interval $[L, R]$, with this type being different from any type used before. Since the situation is urgent, at some moments Xiao FF may ask how many different types of mines are currently in the interval $[L', R']$, and he wants you to answer as quickly as possible.", "inputFormat": "The first line contains two integers $n$ and $m$, where $n$ is the length of the defense line and $m$ is the total number of SCV laying operations and Xiao FF’s queries.\n\nEach of the next $m$ lines contains three integers $q, l, r$:\n- If $q = 1$, the SCV lays mines of a single, previously unused type on the interval $[l, r]$.\n- If $q = 2$, Xiao FF asks how many different types of mines are currently in the interval $[l, r]$.", "outputFormat": "For each of Xiao FF’s queries, output one answer (one per line), which is the current number of mine types in the specified interval.", "hint": "### Constraints\n\n- For $30\\%$ of the testdata, $0 \\le n, m \\le 1000$.\n- For $100\\%$ of the testdata, $0 \\le n, m \\le 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "贪婪大陆", "background": "面对蚂蚁们的疯狂进攻，小 FF 的 Tower defence 宣告失败……人类被蚂蚁们逼到了 Greed Island 上的一个海湾。现在，小 FF 的后方是一望无际的大海，前方是变异了的超级蚂蚁。小 FF 还有大好前程，他可不想命丧于此， 于是他派遣手下最后一批改造 SCV 布置地雷以阻挡蚂蚁们的进攻。", "description": "小 FF 最后一道防线是一条长度为 $n$ 的战壕，小 FF 拥有无数多种地雷，而 SCV 每次可以在 $[L, R]$ 区间埋放同一种不同于之前已经埋放的地雷。由于情况已经十万火急，小 FF 在某些时候可能会询问你在 $[L',R']$ 区间内有多少种不同的地雷，他希望你能尽快的给予答复。", "inputFormat": "第一行为两个整数 $n$ 和 $m$，$n$ 表示防线长度，$m$ 表示 SCV 布雷次数及小 FF 询问的次数总和。\n\n接下来有 $m$ 行，每行三个整数 $q,l,r$：\n\n- 若 $q=1$，则表示 SCV 在 $[l, r]$ 这段区间布上一种地雷；\n- 若 $q=2$，则表示小 FF 询问当前 $[l, r]$ 区间总共有多少种地雷。", "outputFormat": "对于小 FF 的每次询问，输出一个答案（单独一行），表示当前区间地雷种数。", "hint": "### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，$0 \\le n$，$m \\le 1000$。\n- 对于 $100\\%$ 的数据，$0 \\le n$，$m \\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P2185", "type": "P", "difficulty": 3, "samples": [["4 4\n1 2\n2 3\n4 2\n3 4\n0 0", "200"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072]}, "tags": ["图论", "广度优先搜索 BFS"], "title": "公路通行税", "background": "", "description": "在 PALMIA 国家内，有 $N$ 个城市由公路相连（每条公路恰好双向连接两个城市）。经由一条公路或多条公路，从任一城市出发可以到达其余各个城市。直到今年，公路上才要征收公路通行税。在每条公路的中间，有一征税员，从每一辆经由此路的车收取 1 PALMIA COIN（1PC）。\n\n政府官员决定减少收税员而推行公路印花。如果一辆车欲进入一条公路，就必须将这张印花贴在窗上。\n\n政府官员决定：一年的公路印花的价值相当于在两个最远城市之间进行 $100$ 次旅行所需的费用。两个城市之间的距离是从一个城市到达第二个城市所需经过的最少数目的公路数。\n\n你的任务是编写一个程序计算出公路印花的价值。", "inputFormat": "输入文件中包含几组数据。每组的第一行包括整数 $N$ 和 $M$（中间被一个空格隔开），$N$ 是该国家中城市的数目，$M$ 是公路的数目（$1\\le N\\le1000$，$1\\le M\\le25000$）。城市由整数进行编号，从 $1$ 到 $N$ 。接下来的 $M$ 行，每行均包含一对整数 $A$，$B$（$1\\le A,B\\le N$），中间由一空格隔开，代表在城市 $A$ 与 $B$ 之间有一条公路。在最后一组数后仅有一行，是两个 $0$，中间被一空格隔开。\n", "outputFormat": "对输入文件中的各组数据，输出文件中包含一行，表示公路印花的价值。\n", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "Highway Toll Stamp", "background": "", "description": "In the country of PALMIA, there are $N$ cities connected by roads (each road connects exactly two cities bidirectionally). From any city, it is possible to reach every other city by traveling along one or more roads. Starting this year, a highway toll will be charged. In the middle of each road, there is a tax collector who collects 1 PALMIA COIN (1 PC) from every car that uses this road.\n\nGovernment officials decided to reduce the number of tax collectors by introducing a road stamp. If a car wants to enter a road, it must stick this stamp on its window.\n\nThe officials set the annual road stamp value to be equal to the total cost of making $100$ trips between the two farthest cities. The distance between two cities is defined as the minimum number of roads that must be traversed to get from one city to the other.\n\nYour task is to write a program to compute the value of the road stamp.", "inputFormat": "The input contains multiple test cases. The first line of each test case contains two integers $N$ and $M$ (separated by a space), where $N$ is the number of cities and $M$ is the number of roads ($1 \\le N \\le 1000$, $1 \\le M \\le 25000$). Cities are labeled with integers from $1$ to $N$. Each of the next $M$ lines contains a pair of integers $A$, $B$ ($1 \\le A, B \\le N$), separated by a space, indicating that there is a road between city $A$ and city $B$. The input terminates with a line containing two zeros separated by a space.", "outputFormat": "For each test case, output one line containing the value of the road stamp.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "公路通行税", "background": "", "description": "在 PALMIA 国家内，有 $N$ 个城市由公路相连（每条公路恰好双向连接两个城市）。经由一条公路或多条公路，从任一城市出发可以到达其余各个城市。直到今年，公路上才要征收公路通行税。在每条公路的中间，有一征税员，从每一辆经由此路的车收取 1 PALMIA COIN（1PC）。\n\n政府官员决定减少收税员而推行公路印花。如果一辆车欲进入一条公路，就必须将这张印花贴在窗上。\n\n政府官员决定：一年的公路印花的价值相当于在两个最远城市之间进行 $100$ 次旅行所需的费用。两个城市之间的距离是从一个城市到达第二个城市所需经过的最少数目的公路数。\n\n你的任务是编写一个程序计算出公路印花的价值。", "inputFormat": "输入文件中包含几组数据。每组的第一行包括整数 $N$ 和 $M$（中间被一个空格隔开），$N$ 是该国家中城市的数目，$M$ 是公路的数目（$1\\le N\\le1000$，$1\\le M\\le25000$）。城市由整数进行编号，从 $1$ 到 $N$ 。接下来的 $M$ 行，每行均包含一对整数 $A$，$B$（$1\\le A,B\\le N$），中间由一空格隔开，代表在城市 $A$ 与 $B$ 之间有一条公路。在最后一组数后仅有一行，是两个 $0$，中间被一空格隔开。\n", "outputFormat": "对输入文件中的各组数据，输出文件中包含一行，表示公路印花的价值。\n", "hint": "", "locale": "zh-CN"}}}
