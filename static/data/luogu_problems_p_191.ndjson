{"pid": "P4863", "type": "P", "difficulty": 5, "samples": [["1 1", "-1"], ["2 2", "-1"], ["3 3", "-3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "枚举", "分块"], "title": "JerryC Loves Driving", "background": "JerryC 最近迷上了狂野飙车！！！", "description": "众所周知，JerryC 是一位疯狂的 Female。他最近买了一台跑车（~~但是却没有驾驶证~~），所以他就只能到一个偏僻的地方练习开车。\n\n当然，JerryC 是不可能正常开车的。她首先决定要开 $(B-A+1)$ 段路程的车，第 $i$ 段路程的速度都是从 $1$ 开始加速的。每一秒会加上 $1$ 的单位速度。当速度加到 $(i+A-1)$ 的时候，JerryC 就会把速度降为 $1$，然后开始下一段路程。\n\n对于第 $i$ 段路程的第 $j$ 秒，JerryC 获得的愉悦值为$\\left\\lfloor \\frac{i+A-1}{j} \\right\\rfloor \\times (-1)^j$。（反正 JerryC 就是不喜欢奇数。）\n\n现在请你求出 JerryC 最后的总愉悦值。\n\nP.s. ：\n\n如果上面的东西没有看懂，那么简单版就是这个意思：\n\n给出 $A, B$，求出下面式子的值。\n\n$$\\sum_{i=A}^B \\sum_{j=1}^{i}\\left\\lfloor \\frac{i}{j} \\right\\rfloor \\times (-1)^j$$", "inputFormat": "一行，两个正整数 $A, B$。", "outputFormat": "一行，一个整数表示最终的愉悦值。", "hint": "对于 $50\\%$ 的数据，$1 \\leqslant A \\leqslant B \\leqslant 5\\times10^3$；  \n对于 $70\\%$ 的数据，$1 \\leqslant A \\leqslant B \\leqslant 5\\times10^4$；  \n对于 $100\\%$ 的数据，$1 \\leqslant A \\leqslant B \\leqslant 2\\times10^7$。", "locale": "zh-CN", "translations": {"en": {"title": "JerryC Loves Driving", "background": "JerryC has recently become obsessed with Asphalt Racing.", "description": "As everyone knows, JerryC is a crazy Female. He recently bought a sports car (~~but he does not have a driver’s license~~), so he can only practice driving in a remote place.\n\nOf course, JerryC is not going to drive normally. She first decides to drive $(B-A+1)$ segments of road. In the $i$-th segment, the speed starts accelerating from $1$. Each second, it increases by $1$ unit of speed. When the speed reaches $(i+A-1)$, JerryC will reduce the speed back to $1$, and then start the next segment.\n\nFor the $j$-th second of the $i$-th segment, the pleasure value JerryC gets is $\\left\\lfloor \\frac{i+A-1}{j} \\right\\rfloor \\times (-1)^j$. (Anyway, JerryC just does not like odd numbers.)\n\nNow please compute JerryC’s final total pleasure value.\n\nP.s.:\n\nIf you did not understand the above, then the simplified version is:\n\nGiven $A, B$, compute the value of the following expression.\n\n$$\\sum_{i=A}^B \\sum_{j=1}^{i}\\left\\lfloor \\frac{i}{j} \\right\\rfloor \\times (-1)^j$$", "inputFormat": "One line with two positive integers $A, B$.", "outputFormat": "One line with one integer, representing the final pleasure value.", "hint": "For $50\\%$ of the testdata, $1 \\leqslant A \\leqslant B \\leqslant 5\\times10^3$.  \nFor $70\\%$ of the testdata, $1 \\leqslant A \\leqslant B \\leqslant 5\\times10^4$.  \nFor $100\\%$ of the testdata, $1 \\leqslant A \\leqslant B \\leqslant 2\\times10^7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "JerryC Loves Driving", "background": "JerryC 最近迷上了狂野飙车！！！", "description": "众所周知，JerryC 是一位疯狂的 Female。他最近买了一台跑车（~~但是却没有驾驶证~~），所以他就只能到一个偏僻的地方练习开车。\n\n当然，JerryC 是不可能正常开车的。她首先决定要开 $(B-A+1)$ 段路程的车，第 $i$ 段路程的速度都是从 $1$ 开始加速的。每一秒会加上 $1$ 的单位速度。当速度加到 $(i+A-1)$ 的时候，JerryC 就会把速度降为 $1$，然后开始下一段路程。\n\n对于第 $i$ 段路程的第 $j$ 秒，JerryC 获得的愉悦值为$\\left\\lfloor \\frac{i+A-1}{j} \\right\\rfloor \\times (-1)^j$。（反正 JerryC 就是不喜欢奇数。）\n\n现在请你求出 JerryC 最后的总愉悦值。\n\nP.s. ：\n\n如果上面的东西没有看懂，那么简单版就是这个意思：\n\n给出 $A, B$，求出下面式子的值。\n\n$$\\sum_{i=A}^B \\sum_{j=1}^{i}\\left\\lfloor \\frac{i}{j} \\right\\rfloor \\times (-1)^j$$", "inputFormat": "一行，两个正整数 $A, B$。", "outputFormat": "一行，一个整数表示最终的愉悦值。", "hint": "对于 $50\\%$ 的数据，$1 \\leqslant A \\leqslant B \\leqslant 5\\times10^3$；  \n对于 $70\\%$ 的数据，$1 \\leqslant A \\leqslant B \\leqslant 5\\times10^4$；  \n对于 $100\\%$ 的数据，$1 \\leqslant A \\leqslant B \\leqslant 2\\times10^7$。", "locale": "zh-CN"}}}
{"pid": "P4864", "type": "P", "difficulty": 6, "samples": [["2 3 1\n1 2\n2 1\n0\n1\n2\n", "1\n3\n4"]], "limits": {"time": [1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800, 1800], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["O2优化"], "title": "Jerry Loves Lines", "background": "Jerry 很喜欢在纸上面画直线呢。", "description": "Jerry 在纸上面画上了 $N$ 条直线，每一条直线都可以用 $y=k_ix+b_i$ 来表示。现在 Jerry 想知道对于 $M$ 条可以表示为 $X=A_j$ 的直线，从下往上数排名第 $K$ 的交点的 $y$ 坐标是多少。\n\n如有 $x$ 条直线与一条 $X=A_j$ 的直线交于同一点，算 $x$ 个点。", "inputFormat": "第一行三个正整数 $N,M,K$。\n\n接下来 $N$ 行，每一行两个非零整数 $k_i$ 和 $b_i$ 描述了一条直线。\n\n接下来 $M$ 行，每行一个整数 $A_j$ 表示一个询问。", "outputFormat": "$M$ 行，每一行一个整数表示答案。", "hint": "对于 $30\\%$ 的数据，$1 \\leqslant N,M \\leqslant 2000$；  \n对于 $100\\%$ 的数据，$1 \\leqslant N \\leqslant 2000$，$1 \\leqslant M \\leqslant 5\\times10^5$。\n\n其他所有读入的数全在 `int` 范围内，且保证 $1 \\leqslant K \\leqslant N$。\n\n温馨提示：如果对自己的做法的常数感到不放心，请吸入氧气（食用 O2 优化）如果有着充足自信，尽管放手浪。\n\n$\\color{white}{\\text{int*int会爆int!!!}}$", "locale": "zh-CN", "translations": {"en": {"title": "Jerry Loves Lines", "background": "Jerry really likes drawing straight lines on paper.", "description": "Jerry has drawn $N$ lines on paper. Each line can be written as $y = k_i x + b_i$. Now Jerry wants to know, for each of the $M$ lines that can be written as $X = A_j$, what the $y$-coordinate is of the intersection point that ranks $K$-th when counted from bottom to top.\n\nIf $x$ lines intersect a line $X = A_j$ at the same point, it is counted as $x$ points.", "inputFormat": "The first line contains three positive integers $N, M, K$.\n\nThe next $N$ lines each contain two non-zero integers $k_i$ and $b_i$, describing one line.\n\nThe next $M$ lines each contain one integer $A_j$, representing a query.", "outputFormat": "Output $M$ lines. Each line contains one integer, representing the answer.", "hint": "For $30\\%$ of the testdata, $1 \\leqslant N, M \\leqslant 2000$.  \nFor $100\\%$ of the testdata, $1 \\leqslant N \\leqslant 2000$, $1 \\leqslant M \\leqslant 5 \\times 10^5$.\n\nAll other input numbers are within the `int` range, and it is guaranteed that $1 \\leqslant K \\leqslant N$.\n\nFriendly reminder: if you are not confident about the constant factor of your solution, please inhale oxygen (use O2 optimization). If you are fully confident, go ahead and do whatever you want.\n\n$\\color{white}{\\text{int*int会爆int!!!}}$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Jerry Loves Lines", "background": "Jerry 很喜欢在纸上面画直线呢。", "description": "Jerry 在纸上面画上了 $N$ 条直线，每一条直线都可以用 $y=k_ix+b_i$ 来表示。现在 Jerry 想知道对于 $M$ 条可以表示为 $X=A_j$ 的直线，从下往上数排名第 $K$ 的交点的 $y$ 坐标是多少。\n\n如有 $x$ 条直线与一条 $X=A_j$ 的直线交于同一点，算 $x$ 个点。", "inputFormat": "第一行三个正整数 $N,M,K$。\n\n接下来 $N$ 行，每一行两个非零整数 $k_i$ 和 $b_i$ 描述了一条直线。\n\n接下来 $M$ 行，每行一个整数 $A_j$ 表示一个询问。", "outputFormat": "$M$ 行，每一行一个整数表示答案。", "hint": "对于 $30\\%$ 的数据，$1 \\leqslant N,M \\leqslant 2000$；  \n对于 $100\\%$ 的数据，$1 \\leqslant N \\leqslant 2000$，$1 \\leqslant M \\leqslant 5\\times10^5$。\n\n其他所有读入的数全在 `int` 范围内，且保证 $1 \\leqslant K \\leqslant N$。\n\n温馨提示：如果对自己的做法的常数感到不放心，请吸入氧气（食用 O2 优化）如果有着充足自信，尽管放手浪。\n\n$\\color{white}{\\text{int*int会爆int!!!}}$", "locale": "zh-CN"}}}
{"pid": "P4865", "type": "P", "difficulty": 6, "samples": [["3 5\n1 2 1\n1 3 2\n3 4 1\n3 5 3\n1 1\n2 2\n3 3\n", "0\n4\n6\n"]], "limits": {"time": [500, 500, 800, 800, 800, 800, 800, 800, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["并查集", "枚举"], "title": "Samcompu Loves Water", "background": "Samcompu 拥有大量的“水”资源！！", "description": "Samcompu 需要制定一个“水”计划。这个计划的主要目的就是为了避开老师监视的时间来水。\n\n老师在中途会离开机房 $T$ 次，第 $i$ 次将会离开 $tim_i$ 秒。Samcompu 划水的时候可不是随便乱水的。他可是拥有“水”资源的。在他的库存中有 $N$ 个可以水的网站。Samcompu 拥有一种黑科技，他可以几乎不耗任何时间在网站与网站之间跳转并且把跳转的网页的信息秒存。也就是说，Samcompu 并不需要在每一次跳转的时候花费时间去浏览网页。当然，这只局限于 $N$ 个网站之间的 $N-1$ 个跳转方式（保证每一个网站都可以跳转到另外的所有网站）。对于第 $i$ 种跳转方式，第 $u_i$ 个网站到第 $v_i$ 个网站的跳转存在一个危险程度 $w_i$，这个危险值可能会造成电脑卡死，如果 Samcompu 不能及时处理，那么就会完美地被老师发现。\n\n值得一提的是，在被查水表很多次后，Samcompu 总结出了一个规律：\n\n老师走得越久，能够保证在被老师发现之前处理好电脑卡死的危险程度的上限就越高。简单来说，两者就是成正比的关系，比例系数为 $1$。\n\n可惜的是，Samcompu 的黑科技并不稳定，在老师第 $i$ 次离开的时候，第 $K_i$ 个跳转方式就不可用了。\n\n当然，每一次水都可以从任意一个网站开始，也可以从任意一个网站结束。\n\n现在 Samcompu 想知道，对于第 $i$ 次老师离开机房时，他能够有多少种不同的安全的水的方案。两种水的方案不同当且仅当这两种水的方案的第一个网站或者最后一个网站不同。\n\n（补充说明: 一个安全的水的方案当且仅当当前是老师第 $j$ 次离开教室时跳转的路径中不存在一个跳转方式 $i$ 使得 $tim_j \\leqslant w_i$，每一次水完后不可用的跳转方式就会恢复。）", "inputFormat": "第一行两个正整数 $T, N$。\n\n接下来 $N-1$ 行，每一行三个正整数 $u_i, v_i, w_i$。\n\n接下来 $T$ 行，每一行两个正整数 $tim_i, K_i$。", "outputFormat": "$T$ 行，每行一个正整数表示有多少中安全的水的方案。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/25960.png)\n\n第一次连接 $1$ 和 $2$ 的边不可用，当前能经过的边的危险程度需要 $<1$，并没有合法的方案。\n\n第二次连接 $1$ 和 $3$ 的边不可用，当前能经过的边的危险程度需要 $<2$，合法的方案有 $(1,2)$，$(2,1)$，$(3,4)$，$(4,3)$ 共四种。\n\n第三次连接 $3$ 和 $4$ 的边不可用，当前能经过的边的危险程度需要 $<3$，合法的方案有 $(1,2)$，$(1,3)$，$(2,1)$，$(2,3)$，$(3,1)$，$(3,2)$ 共六种。\n\n提醒：本题计算答案按照点对的方式计算。也就是说，如果起点和终点一样，则只看做同一种方案。特别的，$(x,y)$ 和 $(y,x)\\ (x \\neq y)$ 算作两种不同的方案.\n\n### 数据范围\n\n- Subtask 1（30 pts）：$T=1$，$1 \\leqslant K_i \\leqslant N \\leqslant 10^3$，$1 \\leqslant tim_i, w_i \\leqslant 10^3$；\n- Subtask 2（50 pts）：$1 \\leqslant T \\leqslant 5\\times10^3$，$1 \\leqslant K_i \\leqslant N \\leqslant 10^4$，$1 \\leqslant tim_i, w_i \\leqslant 10^3$；\n- Subtask 3（20 pts）：$1 \\leqslant T \\leqslant 10^4$，$1 \\leqslant K_i \\leqslant N \\leqslant 10^4$，$1 \\leqslant tim_i, w_i \\leqslant 10^3$。\n\n数据保证不同的 $K_i$ 最多只有 $10^3$ 个。\n\n温馨提醒：由于出题人数据比较毒瘤，所以请尽量卡常。", "locale": "zh-CN", "translations": {"en": {"title": "Samcompu Loves Water", "background": "Samcompu has a huge amount of “water” resources.", "description": "Samcompu needs to make a “water” plan. The main goal of this plan is to “water” while avoiding the time when the teacher is watching.\n\nThe teacher will leave the computer room $T$ times. During the $i$-th time, the teacher will be away for $tim_i$ seconds. When Samcompu “waters,” he does not do it randomly. He has “water” resources: in his inventory there are $N$ websites he can “water” on. Samcompu has a kind of black tech that lets him switch between websites almost instantly and instantly save the information of the page he switches to. That is, Samcompu does not need to spend time browsing the webpage each time he switches. Of course, this is limited to the $N-1$ switching methods among the $N$ websites (it is guaranteed that every website can be switched to every other website). For the $i$-th switching method, switching from website $u_i$ to website $v_i$ has a danger level $w_i$. This danger value may cause the computer to freeze. If Samcompu cannot handle it in time, he will be perfectly caught by the teacher.\n\nNotably, after being checked many times, Samcompu found a rule:\n\nThe longer the teacher is away, the higher the upper limit of danger level that can be handled before the teacher notices. In simple terms, they are directly proportional, with proportionality coefficient $1$.\n\nUnfortunately, Samcompu’s black tech is not stable. When the teacher leaves for the $i$-th time, the $K_i$-th switching method becomes unavailable.\n\nAlso, each “watering” session may start at any website and may end at any website.\n\nNow Samcompu wants to know, for the $i$-th time the teacher leaves the computer room, how many different safe “watering” plans he can have. Two “watering” plans are different if and only if the first website or the last website is different.\n\n(Supplement: A safe “watering” plan holds if and only if, when the teacher leaves for the $j$-th time, there does not exist a switching method $i$ on the chosen path such that $tim_j \\leqslant w_i$. After each “watering” session ends, the switching method that was unavailable will be restored.)", "inputFormat": "The first line contains two positive integers $T, N$.\n\nThe next $N-1$ lines each contain three positive integers $u_i, v_i, w_i$.\n\nThe next $T$ lines each contain two positive integers $tim_i, K_i$.", "outputFormat": "Output $T$ lines. Each line contains one positive integer, indicating how many safe “watering” plans there are.", "hint": "![](https://cdn.luogu.com.cn/upload/pic/25960.png)\n\nIn the first query, the edge connecting $1$ and $2$ is unavailable. The danger level of edges that can be used must satisfy $< 1$, so there is no valid plan.\n\nIn the second query, the edge connecting $1$ and $3$ is unavailable. The danger level of edges that can be used must satisfy $< 2$. The valid plans are $(1,2)$, $(2,1)$, $(3,4)$, $(4,3)$, a total of four.\n\nIn the third query, the edge connecting $3$ and $4$ is unavailable. The danger level of edges that can be used must satisfy $< 3$. The valid plans are $(1,2)$, $(1,3)$, $(2,1)$, $(2,3)$, $(3,1)$, $(3,2)$, a total of six.\n\nReminder: In this problem, the answer is counted by ordered pairs of nodes. That is, if the start and end are the same, it is counted as only one plan. In particular, $(x,y)$ and $(y,x)\\ (x \\neq y)$ are considered two different plans.\n\n### Constraints\n\n- Subtask 1 (30 pts): $T=1$, $1 \\leqslant K_i \\leqslant N \\leqslant 10^3$, $1 \\leqslant tim_i, w_i \\leqslant 10^3$.\n- Subtask 2 (50 pts): $1 \\leqslant T \\leqslant 5\\times10^3$, $1 \\leqslant K_i \\leqslant N \\leqslant 10^4$, $1 \\leqslant tim_i, w_i \\leqslant 10^3$.\n- Subtask 3 (20 pts): $1 \\leqslant T \\leqslant 10^4$, $1 \\leqslant K_i \\leqslant N \\leqslant 10^4$, $1 \\leqslant tim_i, w_i \\leqslant 10^3$.\n\nThe testdata guarantees that there are at most $10^3$ distinct values among $K_i$.\n\nWarm reminder: Because the setter’s testdata is quite harsh, please optimize for constant factors as much as possible.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Samcompu Loves Water", "background": "Samcompu 拥有大量的“水”资源！！", "description": "Samcompu 需要制定一个“水”计划。这个计划的主要目的就是为了避开老师监视的时间来水。\n\n老师在中途会离开机房 $T$ 次，第 $i$ 次将会离开 $tim_i$ 秒。Samcompu 划水的时候可不是随便乱水的。他可是拥有“水”资源的。在他的库存中有 $N$ 个可以水的网站。Samcompu 拥有一种黑科技，他可以几乎不耗任何时间在网站与网站之间跳转并且把跳转的网页的信息秒存。也就是说，Samcompu 并不需要在每一次跳转的时候花费时间去浏览网页。当然，这只局限于 $N$ 个网站之间的 $N-1$ 个跳转方式（保证每一个网站都可以跳转到另外的所有网站）。对于第 $i$ 种跳转方式，第 $u_i$ 个网站到第 $v_i$ 个网站的跳转存在一个危险程度 $w_i$，这个危险值可能会造成电脑卡死，如果 Samcompu 不能及时处理，那么就会完美地被老师发现。\n\n值得一提的是，在被查水表很多次后，Samcompu 总结出了一个规律：\n\n老师走得越久，能够保证在被老师发现之前处理好电脑卡死的危险程度的上限就越高。简单来说，两者就是成正比的关系，比例系数为 $1$。\n\n可惜的是，Samcompu 的黑科技并不稳定，在老师第 $i$ 次离开的时候，第 $K_i$ 个跳转方式就不可用了。\n\n当然，每一次水都可以从任意一个网站开始，也可以从任意一个网站结束。\n\n现在 Samcompu 想知道，对于第 $i$ 次老师离开机房时，他能够有多少种不同的安全的水的方案。两种水的方案不同当且仅当这两种水的方案的第一个网站或者最后一个网站不同。\n\n（补充说明: 一个安全的水的方案当且仅当当前是老师第 $j$ 次离开教室时跳转的路径中不存在一个跳转方式 $i$ 使得 $tim_j \\leqslant w_i$，每一次水完后不可用的跳转方式就会恢复。）", "inputFormat": "第一行两个正整数 $T, N$。\n\n接下来 $N-1$ 行，每一行三个正整数 $u_i, v_i, w_i$。\n\n接下来 $T$ 行，每一行两个正整数 $tim_i, K_i$。", "outputFormat": "$T$ 行，每行一个正整数表示有多少中安全的水的方案。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/25960.png)\n\n第一次连接 $1$ 和 $2$ 的边不可用，当前能经过的边的危险程度需要 $<1$，并没有合法的方案。\n\n第二次连接 $1$ 和 $3$ 的边不可用，当前能经过的边的危险程度需要 $<2$，合法的方案有 $(1,2)$，$(2,1)$，$(3,4)$，$(4,3)$ 共四种。\n\n第三次连接 $3$ 和 $4$ 的边不可用，当前能经过的边的危险程度需要 $<3$，合法的方案有 $(1,2)$，$(1,3)$，$(2,1)$，$(2,3)$，$(3,1)$，$(3,2)$ 共六种。\n\n提醒：本题计算答案按照点对的方式计算。也就是说，如果起点和终点一样，则只看做同一种方案。特别的，$(x,y)$ 和 $(y,x)\\ (x \\neq y)$ 算作两种不同的方案.\n\n### 数据范围\n\n- Subtask 1（30 pts）：$T=1$，$1 \\leqslant K_i \\leqslant N \\leqslant 10^3$，$1 \\leqslant tim_i, w_i \\leqslant 10^3$；\n- Subtask 2（50 pts）：$1 \\leqslant T \\leqslant 5\\times10^3$，$1 \\leqslant K_i \\leqslant N \\leqslant 10^4$，$1 \\leqslant tim_i, w_i \\leqslant 10^3$；\n- Subtask 3（20 pts）：$1 \\leqslant T \\leqslant 10^4$，$1 \\leqslant K_i \\leqslant N \\leqslant 10^4$，$1 \\leqslant tim_i, w_i \\leqslant 10^3$。\n\n数据保证不同的 $K_i$ 最多只有 $10^3$ 个。\n\n温馨提醒：由于出题人数据比较毒瘤，所以请尽量卡常。", "locale": "zh-CN"}}}
{"pid": "P4866", "type": "P", "difficulty": 6, "samples": [["7 3 3\n1 2 2\n1 3 1\n2 4 1\n2 5 10\n3 6 1\n6 7 2\n4 5\n5 50\n7 7\n1\n10\n100\n", "0\n7\n62"]], "limits": {"time": [1000, 1000, 1500, 1500, 1500, 1500, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 256000, 256000, 256000, 256000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "枚举", "背包 DP"], "title": "Zrz_orz Loves Secondary Element", "background": "zrz_orz 赘喜欢二次元辣！！", "description": "众所周知的是，zrz_orz 是全机房最强的死宅。~~他甚至使用嘴遁使得 Samcompu 不得不在自己的网站上挂上时崎狂三~~。（话说 Samcompu 好像醒悟了又把狂三给去掉了。）作为新一代死宅的一员，从电脑壁纸到输入法皮肤，到处都是二次元的痕迹。所以，他经常在梦里梦见一些二次元的角色。\n\nzrz_orz 的梦，是由 $n$ 个点和 $n-1$ 条边构成的连通图。其中有 $m$ 个节点上有一个二次元的角色。对于 zrz_orz 来说，每一个二次元的角色都有一个对应的 $pos_i$ 和 $val_i$ 表示这个角色在图上的哪一个节点以及与之聊天对 zrz_orz 来说会增加多少愉悦值。（由于某种原因，聊天的过程可以不用计入时间。）可惜的是，zrz_orz 每一次做梦都只会做 $tim_i$ 个单位时间。现在请你告诉他，他每一次做梦最多能获得多少愉悦值。\n\n注：\n\n1. zrz_orz 每一次做梦都只会从 $1$ 号节点开始走！\n2. 每一次做梦后 zrz_orz 梦境中的图都不会改变！\n3. **每一次做完梦之后 zrz_orz 就必须要回到 $\\bm1$ 号节点，否则他就会迷失在梦境里！**", "inputFormat": "第1行三个正整数 $N,M,T$ 表示图的节点数、二次元角色的数量、做梦的天数。\n\n接下来 $N-1$ 行每行三个正整数 $u_i,v_i,w_i$ 表示第 $i$ 条边连接的两个节点以及 zrz_orz 走过这条边所花费的时间。\n\n接下来 $M$ 行每行两个正整数 $pos_j$ 和 $val_j$ 表示第 $j$ 个二次元角色在节点上的位置以及能给 zrz_orz 带来的愉悦值。\n\n接下来 $T$ 行每行一个正整数 $tim_k$ 表示第 $k$ 天 zrz_orz 做梦的时间。", "outputFormat": "一共 $T$ 行。每一行包括一个正整数表示 zrz_orz 每天最多能获得的最大愉悦值。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/25600.png)\n\n第一天哪里都去不了。\n\n第二天 $1\\to3\\to6\\to7\\to6\\to3\\to1$ 获得最大愉悦值为 $7$。\n\n第三天所有的地方都可以走一遍。\n\n- Subtask 1（20 pts）：$1 \\leqslant T \\leqslant 10$，$1 \\leqslant N \\leqslant 1000$，$1 \\leqslant M \\leqslant 20$，$1 \\leqslant  tim_k \\leqslant 1000$；\n- Subtask 2（40 pts）：$1 \\leqslant T \\leqslant 10^5$，$1 \\leqslant N \\leqslant 10^5$，$1 \\leqslant M \\leqslant 20$，$1 \\leqslant  tim_k \\leqslant 10^5$；\n- Subtask 3（40 pts）：$1 \\leqslant T \\leqslant 5\\times10^4$，$1 \\leqslant N \\leqslant 5000$，$1 \\leqslant M \\leqslant 100$，$1 \\leqslant  tim_k \\leqslant 100$，$1 \\leqslant w_i \\leqslant 5$。\n\nFor all test points：$1 \\leqslant pos_j,u_i,v_i \\leqslant N$，$1 \\leqslant \\sum val_j \\leqslant 2\\times10^9$，$1 \\leqslant w_i \\leqslant 20$，$1 \\leqslant tim_k \\leqslant 10^5$。\n\n注意：标记的分数就是这个 Subtask 的分数，每一个 Subtask 必须全对才能得分。Subtask 2 的时限为 1.5s。\n\n$$ \\color{white} \\text{NOIP 2合1} $$", "locale": "zh-CN", "translations": {"en": {"title": "Zrz_orz Loves Secondary Element", "background": "zrz_orz really loves anime (èr cì yuán)!!", "description": "As everyone knows, zrz_orz is the strongest hardcore otaku in the whole computer room. ~~He even used “talk-no-jutsu” to make Samcompu put Kurumi Tokisaki on his website~~. (But it seems Samcompu realized something and removed Kurumi again.) As a member of the new generation of otaku, from desktop wallpapers to input method skins, everything is filled with anime traces. So, he often dreams of some anime characters.\n\nzrz_orz’s dream is a connected graph with $n$ nodes and $n-1$ edges. There are $m$ nodes that have an anime character on them. For zrz_orz, each anime character has a corresponding $pos_i$ and $val_i$, meaning which node this character is on, and how much happiness value zrz_orz gains by chatting with them. (For some reason, the chatting process does not need to be counted in time.) Unfortunately, each time zrz_orz dreams, he only has $tim_i$ units of time. Now please tell him: in each dream, what is the maximum happiness value he can obtain?\n\nNotes:\n\n1. Each time zrz_orz dreams, he will always start from node $1$.\n2. After each dream, the graph in zrz_orz’s dream will not change.\n3. **After each dream, zrz_orz must return to node $\\bm1$, otherwise he will get lost in the dream!**", "inputFormat": "The first line contains three positive integers $N, M, T$, representing the number of nodes in the graph, the number of anime characters, and the number of days of dreaming.\n\nThe next $N-1$ lines each contain three positive integers $u_i, v_i, w_i$, representing that the $i$-th edge connects two nodes, and the time cost for zrz_orz to traverse this edge.\n\nThe next $M$ lines each contain two positive integers $pos_j$ and $val_j$, representing the position of the $j$-th anime character and the happiness value it can bring to zrz_orz.\n\nThe next $T$ lines each contain one positive integer $tim_k$, representing the dreaming time on the $k$-th day.", "outputFormat": "Output a total of $T$ lines. Each line contains one positive integer, representing the maximum happiness value zrz_orz can obtain on that day.", "hint": "![](https://cdn.luogu.com.cn/upload/pic/25600.png)\n\nOn the first day, he cannot go anywhere.\n\nOn the second day, taking the route $1\\to3\\to6\\to7\\to6\\to3\\to1$, the maximum happiness value is $7$.\n\nOn the third day, he can traverse all places once.\n\n- Subtask 1 (20 pts): $1 \\leqslant T \\leqslant 10$, $1 \\leqslant N \\leqslant 1000$, $1 \\leqslant M \\leqslant 20$, $1 \\leqslant tim_k \\leqslant 1000$.\n- Subtask 2 (40 pts): $1 \\leqslant T \\leqslant 10^5$, $1 \\leqslant N \\leqslant 10^5$, $1 \\leqslant M \\leqslant 20$, $1 \\leqslant tim_k \\leqslant 10^5$.\n- Subtask 3 (40 pts): $1 \\leqslant T \\leqslant 5\\times10^4$, $1 \\leqslant N \\leqslant 5000$, $1 \\leqslant M \\leqslant 100$, $1 \\leqslant tim_k \\leqslant 100$, $1 \\leqslant w_i \\leqslant 5$.\n\nFor all test points: $1 \\leqslant pos_j, u_i, v_i \\leqslant N$, $1 \\leqslant \\sum val_j \\leqslant 2\\times10^9$, $1 \\leqslant w_i \\leqslant 20$, $1 \\leqslant tim_k \\leqslant 10^5$.\n\nNote: The marked score is the score of this Subtask. Each Subtask must be completely correct to get the score. The time limit for Subtask 2 is 1.5 s.\n\n$$ \\color{white} \\text{NOIP 2合1} $$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Zrz_orz Loves Secondary Element", "background": "zrz_orz 赘喜欢二次元辣！！", "description": "众所周知的是，zrz_orz 是全机房最强的死宅。~~他甚至使用嘴遁使得 Samcompu 不得不在自己的网站上挂上时崎狂三~~。（话说 Samcompu 好像醒悟了又把狂三给去掉了。）作为新一代死宅的一员，从电脑壁纸到输入法皮肤，到处都是二次元的痕迹。所以，他经常在梦里梦见一些二次元的角色。\n\nzrz_orz 的梦，是由 $n$ 个点和 $n-1$ 条边构成的连通图。其中有 $m$ 个节点上有一个二次元的角色。对于 zrz_orz 来说，每一个二次元的角色都有一个对应的 $pos_i$ 和 $val_i$ 表示这个角色在图上的哪一个节点以及与之聊天对 zrz_orz 来说会增加多少愉悦值。（由于某种原因，聊天的过程可以不用计入时间。）可惜的是，zrz_orz 每一次做梦都只会做 $tim_i$ 个单位时间。现在请你告诉他，他每一次做梦最多能获得多少愉悦值。\n\n注：\n\n1. zrz_orz 每一次做梦都只会从 $1$ 号节点开始走！\n2. 每一次做梦后 zrz_orz 梦境中的图都不会改变！\n3. **每一次做完梦之后 zrz_orz 就必须要回到 $\\bm1$ 号节点，否则他就会迷失在梦境里！**", "inputFormat": "第1行三个正整数 $N,M,T$ 表示图的节点数、二次元角色的数量、做梦的天数。\n\n接下来 $N-1$ 行每行三个正整数 $u_i,v_i,w_i$ 表示第 $i$ 条边连接的两个节点以及 zrz_orz 走过这条边所花费的时间。\n\n接下来 $M$ 行每行两个正整数 $pos_j$ 和 $val_j$ 表示第 $j$ 个二次元角色在节点上的位置以及能给 zrz_orz 带来的愉悦值。\n\n接下来 $T$ 行每行一个正整数 $tim_k$ 表示第 $k$ 天 zrz_orz 做梦的时间。", "outputFormat": "一共 $T$ 行。每一行包括一个正整数表示 zrz_orz 每天最多能获得的最大愉悦值。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/25600.png)\n\n第一天哪里都去不了。\n\n第二天 $1\\to3\\to6\\to7\\to6\\to3\\to1$ 获得最大愉悦值为 $7$。\n\n第三天所有的地方都可以走一遍。\n\n- Subtask 1（20 pts）：$1 \\leqslant T \\leqslant 10$，$1 \\leqslant N \\leqslant 1000$，$1 \\leqslant M \\leqslant 20$，$1 \\leqslant  tim_k \\leqslant 1000$；\n- Subtask 2（40 pts）：$1 \\leqslant T \\leqslant 10^5$，$1 \\leqslant N \\leqslant 10^5$，$1 \\leqslant M \\leqslant 20$，$1 \\leqslant  tim_k \\leqslant 10^5$；\n- Subtask 3（40 pts）：$1 \\leqslant T \\leqslant 5\\times10^4$，$1 \\leqslant N \\leqslant 5000$，$1 \\leqslant M \\leqslant 100$，$1 \\leqslant  tim_k \\leqslant 100$，$1 \\leqslant w_i \\leqslant 5$。\n\nFor all test points：$1 \\leqslant pos_j,u_i,v_i \\leqslant N$，$1 \\leqslant \\sum val_j \\leqslant 2\\times10^9$，$1 \\leqslant w_i \\leqslant 20$，$1 \\leqslant tim_k \\leqslant 10^5$。\n\n注意：标记的分数就是这个 Subtask 的分数，每一个 Subtask 必须全对才能得分。Subtask 2 的时限为 1.5s。\n\n$$ \\color{white} \\text{NOIP 2合1} $$", "locale": "zh-CN"}}}
{"pid": "P4867", "type": "P", "difficulty": 6, "samples": [["10 10\n4 4 5 1 4 1 5 1 2 1\n5 9 1 2\n3 4 7 9\n4 4 2 5\n2 3 4 7\n5 10 4 4\n3 9 1 1\n1 4 5 9\n8 9 3 3\n2 2 1 6\n8 9 1 4", "2\n0\n0\n2\n1\n1\n1\n0\n1\n2"]], "limits": {"time": [5000, 5000, 5000, 5000], "memory": [32768, 32768, 32768, 32768]}, "tags": ["莫队", "分块"], "title": "Gty的妹子序列", "background": "", "description": "Autumn 和 Bakser 又在研究 Gty 的妹子序列了！但他们遇到了一个难题。\n\n对于一段妹子们，他们想让你帮忙求出这之内美丽度 $\\in[a,b]$ 的妹子的美丽度的种类数。\n\n为了方便，我们规定妹子们的美丽度全都在 $[1,n]$ 中。\n\n给定一个长度为 $n(1\\le n\\leq 10^5)$ 的正整数序列 $s(1\\le s_i\\le n)$，对于 $m(1\\le m\\le 10^6)$ 次询问 $l,r,a,b$，每次输出 $s_l\\cdots s_r$ 中，权值 $\\in[a,b]$ 的权值的种类数。", "inputFormat": "第一行包括两个整数 $n,m(1 \\le n \\le 100000,1 \\le m \\le 1000000)$，表示数列 $s$ 中的元素数和询问数。  \n\n第二行包括 $n$ 个整数 $s_1\\cdots s_n(1 \\le s_i\\le n)$。  \n\n接下来 $m$ 行,每行包括 $4$ 个整数 $l,r,a,b(1 \\le l \\le r \\le n,1 \\le a \\le b \\le n)$，意义见题目描述。  \n\n保证涉及的所有数在 C++ 的 int 内。保证输入合法。  ", "outputFormat": "对每个询问，单独输出一行，表示 $s_l \\cdots s_r$ 中权值 $\\in [a,b]$ 的权值的种类数。", "hint": "【样例的部分解释】\n \n`5 9 1 2 `\n子序列为`4 1 5 1 2`  \n在[1,2]里的权值有1,1,2，有2种，因此答案为2。  \n\n`3 4 7 9`  \n子序列为`5 1 ` \n在[7,9]里的权值有5，有1种，因此答案为1。  \n\n`4 4 2 5`  \n子序列为`1`  \n没有权值在[2,5]中的，因此答案为0。  \n\n`2 3 4 7`  \n子序列为`4 5`  \n权值在[4,7]中的有4,5，因此答案为2。  \n\n建议使用输入/输出优化。  ", "locale": "zh-CN", "translations": {"en": {"title": "Gty's Girl Sequence", "background": "", "description": "Autumn and Bakser are studying Gty's girl sequence again, but they have run into a difficult problem.\n\nGiven a segment of girls, they want you to help compute the number of distinct beauty values whose beauty is in $\\in [a,b]$ within this segment.\n\nFor convenience, we assume all beauty values are within $[1,n]$.\n\nGiven a positive integer sequence $s$ of length $n(1 \\le n \\le 10^5)$ with $s_i(1 \\le s_i \\le n)$, and $m(1 \\le m \\le 10^6)$ queries $l,r,a,b$, for each query output, in $s_l \\cdots s_r$, the number of distinct values that are $\\in [a,b]$.", "inputFormat": "The first line contains two integers $n,m(1 \\le n \\le 100000,1 \\le m \\le 1000000)$, representing the number of elements in sequence $s$ and the number of queries.\n\nThe second line contains $n$ integers $s_1 \\cdots s_n(1 \\le s_i \\le n)$.\n\nThe next $m$ lines each contain $4$ integers $l,r,a,b(1 \\le l \\le r \\le n,1 \\le a \\le b \\le n)$, with the meaning as described in the statement.\n\nIt is guaranteed that all numbers involved fit in C++ int. The input is guaranteed to be valid.", "outputFormat": "For each query, output a single line representing, in $s_l \\cdots s_r$, the number of distinct values that are $\\in [a,b]$.", "hint": "【Partial explanation of the sample】\n\n`5 9 1 2`  \nThe subsequence is `4 1 5 1 2`.  \nThe values within $[1,2]$ are 1, 1, 2. There are 2 distinct values, so the answer is 2.\n\n`3 4 7 9`  \nThe subsequence is `5 1`.  \nThe values within $[7,9]$ are 5. There is 1 distinct value, so the answer is 1.\n\n`4 4 2 5`  \nThe subsequence is `1`.  \nThere are no values within $[2,5]$, so the answer is 0.\n\n`2 3 4 7`  \nThe subsequence is `4 5`.  \nThe values within $[4,7]$ are 4, 5. There are 2 distinct values, so the answer is 2.\n\nIt is recommended to use input/output optimization.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Gty的妹子序列", "background": "", "description": "Autumn 和 Bakser 又在研究 Gty 的妹子序列了！但他们遇到了一个难题。\n\n对于一段妹子们，他们想让你帮忙求出这之内美丽度 $\\in[a,b]$ 的妹子的美丽度的种类数。\n\n为了方便，我们规定妹子们的美丽度全都在 $[1,n]$ 中。\n\n给定一个长度为 $n(1\\le n\\leq 10^5)$ 的正整数序列 $s(1\\le s_i\\le n)$，对于 $m(1\\le m\\le 10^6)$ 次询问 $l,r,a,b$，每次输出 $s_l\\cdots s_r$ 中，权值 $\\in[a,b]$ 的权值的种类数。", "inputFormat": "第一行包括两个整数 $n,m(1 \\le n \\le 100000,1 \\le m \\le 1000000)$，表示数列 $s$ 中的元素数和询问数。  \n\n第二行包括 $n$ 个整数 $s_1\\cdots s_n(1 \\le s_i\\le n)$。  \n\n接下来 $m$ 行,每行包括 $4$ 个整数 $l,r,a,b(1 \\le l \\le r \\le n,1 \\le a \\le b \\le n)$，意义见题目描述。  \n\n保证涉及的所有数在 C++ 的 int 内。保证输入合法。  ", "outputFormat": "对每个询问，单独输出一行，表示 $s_l \\cdots s_r$ 中权值 $\\in [a,b]$ 的权值的种类数。", "hint": "【样例的部分解释】\n \n`5 9 1 2 `\n子序列为`4 1 5 1 2`  \n在[1,2]里的权值有1,1,2，有2种，因此答案为2。  \n\n`3 4 7 9`  \n子序列为`5 1 ` \n在[7,9]里的权值有5，有1种，因此答案为1。  \n\n`4 4 2 5`  \n子序列为`1`  \n没有权值在[2,5]中的，因此答案为0。  \n\n`2 3 4 7`  \n子序列为`4 5`  \n权值在[4,7]中的有4,5，因此答案为2。  \n\n建议使用输入/输出优化。  ", "locale": "zh-CN"}}}
{"pid": "P4868", "type": "P", "difficulty": 4, "samples": [["5 3\n1 2 3 4 5\nQuery 5\nModify 3 2\nQuery 5", "35\n32"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "树状数组", "前缀和", "差分"], "title": "Preprefix sum", "background": "", "description": "前缀和（prefix sum）$S_i=\\sum_{k=1}^i a_k$。\n\n前前缀和（preprefix sum）则把 $S_i$ 作为原序列再进行前缀和。记再次求得前缀和第 $i$ 个是 $SS_i$。\n\n给一个长度 $n$ 的序列 $a_1, a_2, \\cdots, a_n$，有两种操作：\n\n1. `Modify i x`：把 $a_i$ 改成 $x$。\n2. `Query i`：查询 $SS_i$。\n", "inputFormat": "第一行给出两个整数 $N,M$。分别表示序列长度和操作个数。  \n接下来一行有 $N$ 个数，即给定的序列 $a_1,a_2,\\cdots,a_n$。  \n接下来 $M$ 行，每行对应一个操作，格式见题目描述。  ", "outputFormat": "对于每个询问操作，输出一行，表示所询问的 $SS_i$ 的值。", "hint": "$1\\le N,M\\le 10^5$，且在任意时刻 $0\\le A_i\\le 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "Preprefix sum", "background": "", "description": "The prefix sum is defined as $S_i=\\sum_{k=1}^i a_k$.\n\nThe preprefix sum (preprefix sum) takes $S_i$ as the original sequence and computes the prefix sum again. Let the $i$-th value of this second prefix sum be $SS_i$.\n\nGiven a sequence $a_1, a_2, \\cdots, a_n$ of length $n$, there are two types of operations:\n\n1. `Modify i x`: Change $a_i$ to $x$.\n2. `Query i`: Query $SS_i$.", "inputFormat": "The first line contains two integers $N, M$, representing the length of the sequence and the number of operations.  \nThe next line contains $N$ numbers, the given sequence $a_1, a_2, \\cdots, a_n$.  \nThe next $M$ lines each contain one operation, with the format described above.", "outputFormat": "For each query operation, output one line containing the value of $SS_i$ being queried.", "hint": "Constraints: $1\\le N,M\\le 10^5$, and at any time $0\\le A_i\\le 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Preprefix sum", "background": "", "description": "前缀和（prefix sum）$S_i=\\sum_{k=1}^i a_k$。\n\n前前缀和（preprefix sum）则把 $S_i$ 作为原序列再进行前缀和。记再次求得前缀和第 $i$ 个是 $SS_i$。\n\n给一个长度 $n$ 的序列 $a_1, a_2, \\cdots, a_n$，有两种操作：\n\n1. `Modify i x`：把 $a_i$ 改成 $x$。\n2. `Query i`：查询 $SS_i$。\n", "inputFormat": "第一行给出两个整数 $N,M$。分别表示序列长度和操作个数。  \n接下来一行有 $N$ 个数，即给定的序列 $a_1,a_2,\\cdots,a_n$。  \n接下来 $M$ 行，每行对应一个操作，格式见题目描述。  ", "outputFormat": "对于每个询问操作，输出一行，表示所询问的 $SS_i$ 的值。", "hint": "$1\\le N,M\\le 10^5$，且在任意时刻 $0\\le A_i\\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P4869", "type": "P", "difficulty": 6, "samples": [["3\n1 2 3\n1", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["线性基"], "title": "albus就是要第一个出场", "background": "", "description": "已知一个长度为 $n$ 的正整数序列 $A$（下标从 $1$ 开始），令 $S = \\{ x | 1 \\le x \\le n \\}$，$S$ 的幂集 $2^S$ 定义为 $S$ 所有子集构成的集合。定义映射 $f : 2^S \\to Z,f(\\emptyset) = 0,f(T) = \\mathrm{XOR}\\{A_t\\}, (t \\in T)$。\n\n现在 albus 把 $2^S$ 中每个集合的 $f$ 值计算出来，从小到大排成一行，记为序列 $B$（下标从 $1$ 开始）。 \n\n给定一个数，那么这个数在序列 $B$ 中第 $1$ 次出现时的下标是多少呢？", "inputFormat": "第一行一个数 $n$, 为序列 $A$ 的长度。接下来一行 $n$ 个数，为序列 $A$，用空格隔开。最后一个数 $Q$，为给定的数.", "outputFormat": "共一行，一个整数，为 $Q$ 在序列 $B$ 中第一次出现时的下标模 $10086$ 的值.", "hint": "\n【样例解释】  \n\n$N = 3,A = [1,2,3]$  \n$S = \\{1,2,3\\}$  \n$2^S = \\{\\emptyset,\\{1\\},\\{2\\},\\{3\\},\\{1,2\\},\\{1,3\\},\\{2,3\\},\\{1,2,3\\}\\}$  \n$f(\\emptyset) = 0$  \n$f({1}) = 1$  \n$f({2}) = 2$  \n$f({3}) = 3$  \n$f({1, 2}) = 1 \\operatorname{xor} 2 = 3$  \n$f({1, 3}) = 1 \\operatorname{xor} 3 = 2$  \n$f({2, 3}) = 2 \\operatorname{xor} 3 = 1$  \n$f({1, 2, 3}) = 0$  \n所以  \n$B = [0,0,1,1,2,2,3,3]$\n\n【数据范围】\n\n$1 \\leq N \\leq 10,0000$  \n其他所有输入均不超过 $10^9$", "locale": "zh-CN", "translations": {"en": {"title": "Albus Wants to Be the First to Appear", "background": "", "description": "Given a positive integer sequence $A$ of length $n$ (indices start from $1$), let $S = \\{ x | 1 \\le x \\le n \\}$. The power set $2^S$ is defined as the set consisting of all subsets of $S$. Define a mapping $f : 2^S \\to Z$, where $f(\\emptyset) = 0$, and for a non-empty set $T$, $f(T) = \\mathrm{XOR}\\{A_t\\}, (t \\in T)$.\n\nNow Albus computes the value $f$ for every set in $2^S$, sorts these values in non-decreasing order into a sequence, and denotes it as sequence $B$ (indices start from $1$).\n\nGiven a number, what is the index of its first occurrence in sequence $B$?", "inputFormat": "The first line contains an integer $n$, the length of sequence $A$. The next line contains $n$ integers representing $A$, separated by spaces. The last number is $Q$, the given number.", "outputFormat": "Output one line with one integer: the value of the index of the first occurrence of $Q$ in sequence $B$ modulo $10086$.", "hint": "[Sample Explanation]\n\n$N = 3,A = [1,2,3]$  \n$S = \\{1,2,3\\}$  \n$2^S = \\{\\emptyset,\\{1\\},\\{2\\},\\{3\\},\\{1,2\\},\\{1,3\\},\\{2,3\\},\\{1,2,3\\}\\}$  \n$f(\\emptyset) = 0$  \n$f({1}) = 1$  \n$f({2}) = 2$  \n$f({3}) = 3$  \n$f({1, 2}) = 1 \\operatorname{xor} 2 = 3$  \n$f({1, 3}) = 1 \\operatorname{xor} 3 = 2$  \n$f({2, 3}) = 2 \\operatorname{xor} 3 = 1$  \n$f({1, 2, 3}) = 0$  \nTherefore,  \n$B = [0,0,1,1,2,2,3,3]$\n\n[Constraints]\n\n$1 \\leq N \\leq 10,0000$  \nAll other inputs do not exceed $10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "albus就是要第一个出场", "background": "", "description": "已知一个长度为 $n$ 的正整数序列 $A$（下标从 $1$ 开始），令 $S = \\{ x | 1 \\le x \\le n \\}$，$S$ 的幂集 $2^S$ 定义为 $S$ 所有子集构成的集合。定义映射 $f : 2^S \\to Z,f(\\emptyset) = 0,f(T) = \\mathrm{XOR}\\{A_t\\}, (t \\in T)$。\n\n现在 albus 把 $2^S$ 中每个集合的 $f$ 值计算出来，从小到大排成一行，记为序列 $B$（下标从 $1$ 开始）。 \n\n给定一个数，那么这个数在序列 $B$ 中第 $1$ 次出现时的下标是多少呢？", "inputFormat": "第一行一个数 $n$, 为序列 $A$ 的长度。接下来一行 $n$ 个数，为序列 $A$，用空格隔开。最后一个数 $Q$，为给定的数.", "outputFormat": "共一行，一个整数，为 $Q$ 在序列 $B$ 中第一次出现时的下标模 $10086$ 的值.", "hint": "\n【样例解释】  \n\n$N = 3,A = [1,2,3]$  \n$S = \\{1,2,3\\}$  \n$2^S = \\{\\emptyset,\\{1\\},\\{2\\},\\{3\\},\\{1,2\\},\\{1,3\\},\\{2,3\\},\\{1,2,3\\}\\}$  \n$f(\\emptyset) = 0$  \n$f({1}) = 1$  \n$f({2}) = 2$  \n$f({3}) = 3$  \n$f({1, 2}) = 1 \\operatorname{xor} 2 = 3$  \n$f({1, 3}) = 1 \\operatorname{xor} 3 = 2$  \n$f({2, 3}) = 2 \\operatorname{xor} 3 = 1$  \n$f({1, 2, 3}) = 0$  \n所以  \n$B = [0,0,1,1,2,2,3,3]$\n\n【数据范围】\n\n$1 \\leq N \\leq 10,0000$  \n其他所有输入均不超过 $10^9$", "locale": "zh-CN"}}}
{"pid": "P4870", "type": "P", "difficulty": 5, "samples": [["3 15\n6\n-3\n1", "25"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000, 16000]}, "tags": ["动态规划 DP", "2009", "区间 DP", "BalticOI（波罗的海）"], "title": "[BalticOI 2009] 甲虫 (Day1)", "background": "", "description": "**译自 [BalticOI 2009](http://www.csc.kth.se/contest/boi/tasks.php) Day1 T1「[Beetle](http://www.csc.kth.se/contest/boi/beetle.pdf)」**\n\n有一只甲虫处于一根水平的树枝。因为他沉迷数学无法自拔，所以他觉得很像是在 $x$ 轴上。\n\n在同一根树枝上，还有 $n$ 滴露水。每滴露水占用 $m$ 个单位的水分。相对于甲虫的位置，他们的坐标分别是 $x_1,x_2,\\dots,x_n$。\n\n显然，这一天将会骄阳似火。每过一个时间单位，就会有一个单位的水分从每一滴露水流失。这只甲虫受尽了烈阳的折磨，以至于每当它碰到一滴露水都能瞬间喝完。在每个时间单位中它能移动一个单位的距离。\n\n所以你要写一个程序，根据露水的坐标，计算出甲虫**最多**能喝到的水。", "inputFormat": "第一行，两个整数，$n$ 和 $m$。\n\n以下 $n$ 行，每行一个整数，表示露水的坐标 $x_1,x_2,\\dots,x_n$。", "outputFormat": "输出一行，表示甲虫最多能喝到的水", "hint": "$0 \\le n \\le 300,1 \\le m \\le 1,000,000,-10,000 \\le x_1,x_2,\\dots,x_n \\le 10,000,$ 对于所有 $i \\ne j,x_i \\ne x_j$。", "locale": "zh-CN", "translations": {"en": {"title": "[BalticOI 2009] Beetle (Day1).", "background": "", "description": "**Translated from [BalticOI 2009](http://www.csc.kth.se/contest/boi/tasks.php) Day1 T1 “[Beetle](http://www.csc.kth.se/contest/boi/beetle.pdf)”.**\n\nA beetle is on a horizontal tree branch. Because it is obsessed with math, it feels like it is on the $x$ axis.\n\nOn the same branch, there are $n$ drops of dew. Each drop contains $m$ units of water. Relative to the beetle’s position, their coordinates are $x_1, x_2, \\dots, x_n$.\n\nObviously, the sun will be blazing that day. Every unit of time, each drop of dew loses $1$ unit of water. The beetle suffers so much from the sun that whenever it touches a drop of dew, it can instantly drink it all. In each unit of time, it can move $1$ unit of distance.\n\nSo you need to write a program that, given the coordinates of the dew drops, computes the **maximum** amount of water the beetle can drink.", "inputFormat": "The first line contains two integers, $n$ and $m$.\n\nThe next $n$ lines each contain one integer, giving the coordinates $x_1, x_2, \\dots, x_n$.", "outputFormat": "Output one line containing the maximum amount of water the beetle can drink.", "hint": "Constraints: $0 \\le n \\le 300$, $1 \\le m \\le 1{,}000{,}000$, $-10{,}000 \\le x_1, x_2, \\dots, x_n \\le 10{,}000$, and for all $i \\ne j$, $x_i \\ne x_j$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BalticOI 2009] 甲虫 (Day1)", "background": "", "description": "**译自 [BalticOI 2009](http://www.csc.kth.se/contest/boi/tasks.php) Day1 T1「[Beetle](http://www.csc.kth.se/contest/boi/beetle.pdf)」**\n\n有一只甲虫处于一根水平的树枝。因为他沉迷数学无法自拔，所以他觉得很像是在 $x$ 轴上。\n\n在同一根树枝上，还有 $n$ 滴露水。每滴露水占用 $m$ 个单位的水分。相对于甲虫的位置，他们的坐标分别是 $x_1,x_2,\\dots,x_n$。\n\n显然，这一天将会骄阳似火。每过一个时间单位，就会有一个单位的水分从每一滴露水流失。这只甲虫受尽了烈阳的折磨，以至于每当它碰到一滴露水都能瞬间喝完。在每个时间单位中它能移动一个单位的距离。\n\n所以你要写一个程序，根据露水的坐标，计算出甲虫**最多**能喝到的水。", "inputFormat": "第一行，两个整数，$n$ 和 $m$。\n\n以下 $n$ 行，每行一个整数，表示露水的坐标 $x_1,x_2,\\dots,x_n$。", "outputFormat": "输出一行，表示甲虫最多能喝到的水", "hint": "$0 \\le n \\le 300,1 \\le m \\le 1,000,000,-10,000 \\le x_1,x_2,\\dots,x_n \\le 10,000,$ 对于所有 $i \\ne j,x_i \\ne x_j$。", "locale": "zh-CN"}}}
{"pid": "P4871", "type": "P", "difficulty": 5, "samples": [["3\n1 2 3", "2"], ["5\n1 2 2 4 5", "8"]], "limits": {"time": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["O2优化", "状压 DP"], "title": "Oier们的镜子(mirror)", "background": "原创By：[b2019dy](https://www.luogu.org/space/show?uid=78488) 、[disangan233](https://www.luogu.org/space/show?uid=72679)   \n\n$gcd$是一个很臭美的OIer，他有一些神奇的镜子。", "description": "\n\n$gcd$手里一共有$n$个物体，它们的编号为$A_1,A_2,A_3\\cdots A_n$。这些物体中有元素板也有镜子，元素板上带有元素，镜子一开始不带元素。\n\n一个元素板可以与**至多**一面镜子相对应，那样的话那面镜子将会带上元素板上的元素。\n\n一面镜子无法对应其他镜子。\n\n现在告诉你物体总数$n$和每个物体**对应后**所带的元素个数，请问一共有多少种对应情况。\n", "inputFormat": "第一行：整数$n$表示物品总数。  \n第二行：共$n$个整数表示每一个物品最终的元素数。", "outputFormat": "输出方案总数对$1000000007$取模的值。   ", "hint": "\n对于$20\\%$的数据，$n\\leq 5$。  \n\n对于$50\\%$的数据，$n\\leq 10$。 \n\n对于$100\\%$的数据，$n\\leq 15$。 \n\n\n## 样例解释  \n\n因为出题人太懒现将解释中的\"(其余)全是元素板\"缩写为\"suki\"！\"对应\"缩写为$\\to$\n\n### 样例1   \n* suki。\n* $A1,A2\\to A3$。 \n   \n#### 答案为：$2$。\n\n\n### 样例2  \n* suki。\n* $A2,A3\\to A4$，suki。    \n* $A1,A4\\to A5$，suki。  \n* $A1,A2,A3\\to A5$，suki。    \n* $A2\\to A3$，suki。  \n* $A2\\to A3$，$A1,A4$->$A5$。  \n* $A3\\to A2$，suki。  \n* $A3\\to A2$，$A1,A4$->$A5$。  \n\n### 答案为：$8$。", "locale": "zh-CN", "translations": {"en": {"title": "Oiers' Mirror (mirror)", "background": "Original by: [b2019dy](https://www.luogu.org/space/show?uid=78488), [disangan233](https://www.luogu.org/space/show?uid=72679).\n\n$gcd$ is a very vain OIer, and he has some magical mirrors.", "description": "$gcd$ has $n$ objects in total, numbered $A_1, A_2, A_3 \\cdots A_n$. Among these objects, some are element plates and some are mirrors. An element plate contains elements, while a mirror has no elements at the beginning.\n\nAn element plate can correspond to **at most** one mirror. In that case, the mirror will carry the elements on that element plate.\n\nA mirror cannot correspond to other mirrors.\n\nYou are now given the total number of objects $n$ and the number of elements each object has **after correspondence**. Please find how many different correspondence schemes there are.", "inputFormat": "The first line: an integer $n$, the total number of objects.  \nThe second line: $n$ integers, representing the final number of elements of each object.", "outputFormat": "Output the number of schemes modulo $1000000007$.", "hint": "For $20\\%$ of the testdata, $n \\leq 5$.  \n\nFor $50\\%$ of the testdata, $n \\leq 10$.  \n\nFor $100\\%$ of the testdata, $n \\leq 15$.  \n\n## Sample Explanation\n\nBecause the problem setter is too lazy, in the explanation, \"(the rest) are all element plates\" is abbreviated as \"suki\", and \"correspond\" is abbreviated as $\\to$.\n\n### Sample 1\n\n* suki.  \n* $A1, A2 \\to A3$.  \n\n#### The answer is: $2$.\n\n### Sample 2\n\n* suki.  \n* $A2, A3 \\to A4$, suki.  \n* $A1, A4 \\to A5$, suki.  \n* $A1, A2, A3 \\to A5$, suki.  \n* $A2 \\to A3$, suki.  \n* $A2 \\to A3$, $A1, A4$->$A5$.  \n* $A3 \\to A2$, suki.  \n* $A3 \\to A2$, $A1, A4$->$A5$.  \n\n### The answer is: $8$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Oier们的镜子(mirror)", "background": "原创By：[b2019dy](https://www.luogu.org/space/show?uid=78488) 、[disangan233](https://www.luogu.org/space/show?uid=72679)   \n\n$gcd$是一个很臭美的OIer，他有一些神奇的镜子。", "description": "\n\n$gcd$手里一共有$n$个物体，它们的编号为$A_1,A_2,A_3\\cdots A_n$。这些物体中有元素板也有镜子，元素板上带有元素，镜子一开始不带元素。\n\n一个元素板可以与**至多**一面镜子相对应，那样的话那面镜子将会带上元素板上的元素。\n\n一面镜子无法对应其他镜子。\n\n现在告诉你物体总数$n$和每个物体**对应后**所带的元素个数，请问一共有多少种对应情况。\n", "inputFormat": "第一行：整数$n$表示物品总数。  \n第二行：共$n$个整数表示每一个物品最终的元素数。", "outputFormat": "输出方案总数对$1000000007$取模的值。   ", "hint": "\n对于$20\\%$的数据，$n\\leq 5$。  \n\n对于$50\\%$的数据，$n\\leq 10$。 \n\n对于$100\\%$的数据，$n\\leq 15$。 \n\n\n## 样例解释  \n\n因为出题人太懒现将解释中的\"(其余)全是元素板\"缩写为\"suki\"！\"对应\"缩写为$\\to$\n\n### 样例1   \n* suki。\n* $A1,A2\\to A3$。 \n   \n#### 答案为：$2$。\n\n\n### 样例2  \n* suki。\n* $A2,A3\\to A4$，suki。    \n* $A1,A4\\to A5$，suki。  \n* $A1,A2,A3\\to A5$，suki。    \n* $A2\\to A3$，suki。  \n* $A2\\to A3$，$A1,A4$->$A5$。  \n* $A3\\to A2$，suki。  \n* $A3\\to A2$，$A1,A4$->$A5$。  \n\n### 答案为：$8$。", "locale": "zh-CN"}}}
{"pid": "P4872", "type": "P", "difficulty": 5, "samples": [["6 10\n5400000S01\n1111101101\n000003X301\n3111111101\nE000300031\n1111X30001", "16"], ["5 10\nS23323323X\n2032332333\n1202202202\n1111111111\n11111111XE", "44"], ["9 10\nSX1X0X1X1X\n2332332333\n5205205200\nXXXXXXXXXX\n2222222222\n3333333333\n3333333333\nXXXXXXXXXX\nXXXXXXXXXE", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["洛谷原创", "O2优化", "广度优先搜索 BFS", "优先队列", "队列"], "title": "OIer们的东方梦", "background": "**#11,#12 两组 Hack 数据由 uid=20285 提供**\n\nOIer 们做~~魂魄妖~~梦都想去幻想乡玩一下。这一次，他们在睡~~古明地~~觉时在梦中穿越去了幻想乡，幻想乡有很多的少(ju)女(ruo)，但是他们被~~老太婆~~少女的美色~~和蒟蒻的美味~~所吸引，在幻想乡中迷失了方向。\n\n勇敢的~~死肥宅~~少年啊，现在你手里有一份幻想乡人间之里的地图，你知道 OIer 们的位置，你可以远程给OIer们传递信息，请你带领迷路的 OIer 们走进回到现实生活的祭坛吧！", "description": "给你一个 $N\\times M$ 的地图，如图所示：              \n```\n5400000S01     \n1111101101     \n000003X301      \n3111111101     \nE000300031      \n1111X30001     \n```\n\n其中有很多稀奇古怪的东西：  \n     \n* $S$ 表示出发点，$E$ 表示终点。      \n* $0$ 表示空地，你想怎么走就怎么走，走一格需要 $1s$。            \n* $1$ 表示墙，你无法通行（~~除非你受到了**风神少女**的庇护~~）。   \n* $2$ 表示小妖怪，你需要 $3s$ 的时间去消灭小妖怪，才能经过该位置。（PS: 妖怪被消灭后只要离开当前格子立刻复活）  \n* $3$ 表示大妖怪，你需要 $8s$ 的时间去消灭大妖怪，才能经过该位置。   \n* $4$ 表示太阳花田，到达该位置可以获得太阳花，获得太阳花后遇到妖怪时可**直接**通过该妖怪的位置。  \n* $5$ 表示楼观剑（科普君：楼观剑，英文名 $Louguan\\ is\\ very\\ jian$，是妖怪做的剑，楼观剑斩不断的东西几乎没有)，到达该位置可以花费 $5s$ 获得它，获得它后可以砍墙砍妖怪将其变成空地（当然也可以不砍，砍墙砍妖怪不需要时间，楼观剑可以一直使用**不会损坏**，有了楼观剑依然可以使用隙间，但是楼观剑不能砍隙间~~和一点用都没有的麻薯，麻薯妖梦UUZ是一家嘛~~）       \n* $M$ 表示麻薯（是 $mashu$ 不是 $mafu$~~不知道麻薯是什么的一把楼观剑给你砍过来~~)，碰到麻薯后你可以把它吃了(路人甲：那你为什么还要加这个东西? 出题人：有 $S$ 肯定要有 $M$ 啊。路人乙：我就是死外边，从隙间中跳下去，也不会吃麻薯！嗯~真香！）            \n* $X$ 表示紫妈的隙间，碰到隙间后会传送至其他的任意一个隙间(数据**不**保证只有 0 或 2 个隙间，**就是说可以有很多隙间乱传**)，每次传送耗时 $1s$。(经过当前格子时可以不经过隙间)       \n      \n答案输出 OIer 们到达终点所需最短时间。如果无法到达，输出 \"We want to live in the TouHou World forever\"。     \n翻译：此生无悔入东方，来世~~睡遍~~愿生幻想乡。   \n    \n**温馨提示：不排除存在可以往回走等稀奇古怪的最优走法**", "inputFormat": "数据共有 $N+1$行。\n\n第 $1$ 行输入 $N$ 和 $M$。  \n第 $2$ 到 $N+1$ 行输入 $N\\times M$ 的地图。", "outputFormat": "一行，最短时间或者 \"We want to live in the TouHou World forever\"。", "hint": "对于 $30\\%$ 的数据，$1\\leq N,M\\leq 50$。       \n对于 $50\\%$ 的数据，$1\\leq N,M\\leq 100$。       \n对于 $100\\%$ 的数据，$1\\leq N,M\\leq 1000$。\n\n保证有一组数据答案为 \"We want to live in the TouHou World forever\"，数据有梯度。\n\n### 样例解释\n\n**样例 1**：在 $7s$ 时到达楼观剑，在 $12s$ 时获得楼观剑，一路向下砍到达终点。                   \n**样例 2**：在 $10s$ 时到达 $(3,3)$，在 $32s$ 时到达$(3,10)$，向上进入隙间后到达终点。          \n**样例 3**：这个就不用解释了吧(出题人放飞自我)。", "locale": "zh-CN", "translations": {"en": {"title": "OIers' Eastern Dream", "background": "**Hack testdata sets #11 and #12 were provided by uid=20285.**\n\nOIers dream (~~Konpaku Youmu~~) of visiting Gensokyo. This time, while they were sleeping (~~Komeiji~~), they traveled to Gensokyo in a dream. There are many (ju) girls (ruo) in Gensokyo, but they were attracted by the beauty of the (~~old lady~~) girls (~~and the delicious konnyaku~~), and got lost in Gensokyo.\n\nBrave (~~dead otaku~~) boy, now you have a map of the Human Village in Gensokyo in your hand. You know the OIers' position, and you can remotely send information to them. Please guide the lost OIers to the altar that leads them back to real life.", "description": "You are given an $N \\times M$ map, as shown below:\n```\n5400000S01     \n1111101101     \n000003X301      \n3111111101     \nE000300031      \n1111X30001     \n```\n\nThere are many strange things on it:\n\n* $S$ is the starting point, and $E$ is the destination.\n* $0$ is empty ground. You can walk as you like, and moving one cell costs $1s$.\n* $1$ is a wall, which you cannot pass through (~~unless you are blessed by the **Wind God Girl**~~).\n* $2$ is a small youkai. You need $3s$ to defeat it before you can pass through this cell. (PS: After being defeated, the youkai revives immediately once you leave the current cell.)\n* $3$ is a big youkai. You need $8s$ to defeat it before you can pass through this cell.\n* $4$ is the Sunflower Field. When you arrive here, you can obtain a sunflower. After obtaining it, when you meet a youkai, you can pass through the youkai's cell **directly**.\n* $5$ is the Roukanken (Trivia: Roukanken, English name $Louguan\\ is\\ very\\ jian$, is a sword forged by youkai; there is almost nothing it cannot cut). When you arrive here, you may spend $5s$ to obtain it. After obtaining it, you can cut walls and youkai, turning them into empty ground (you may also choose not to cut them). Cutting walls and youkai costs no time. Roukanken can be used indefinitely and **will not break**. With Roukanken, you can still use gaps, but Roukanken cannot cut gaps (~~or the completely useless mochi; mochi Youmu UUZ is one family anyway~~).\n* $M$ is mochi (it is $mashu$, not $mafu$ ~~if you do not know what mochi is, I will cut you with Roukanken~~). After you touch mochi, you can eat it. (Passerby A: Then why did you add this thing? Setter: If there is $S$, there must be $M$. Passerby B: I'd rather die outside, or jump down into a gap, than eat mochi! Hmm, smells good!)\n* $X$ is Yukari's gap. After you touch a gap, you will be teleported to any other gap. (The testdata **does not** guarantee there are only 0 or 2 gaps; **that is, there may be many gaps and you can teleport randomly**.) Each teleport costs $1s$. (When passing through the current cell, you may also choose not to use the gap.)\n\nOutput the minimum time needed for the OIers to reach the destination. If it is impossible, output `\"We want to live in the TouHou World forever\"`.\n\nTranslation: No regrets entering Touhou in this life; in the next life, ~~sleep with everyone~~ I wish to be born in Gensokyo.\n\n**Warm reminder: It is possible that the optimal path has weird moves such as going back.**", "inputFormat": "There are $N + 1$ lines in total.\n\nLine $1$ contains $N$ and $M$.\nLines $2$ to $N + 1$ contain the $N \\times M$ map.", "outputFormat": "One line: the minimum time, or `\"We want to live in the TouHou World forever\"`.", "hint": "For $30\\%$ of the testdata, $1 \\leq N, M \\leq 50$.\nFor $50\\%$ of the testdata, $1 \\leq N, M \\leq 100$.\nFor $100\\%$ of the testdata, $1 \\leq N, M \\leq 1000$.\n\nIt is guaranteed that there is one testdata set whose answer is `\"We want to live in the TouHou World forever\"`. The testdata has graded difficulty.\n\n### Sample Explanation\n\n**Sample 1**: Reach Roukanken at $7s$, obtain Roukanken at $12s$, then cut downward all the way to reach the destination.\n**Sample 2**: Reach $(3,3)$ at $10s$, reach $(3,10)$ at $32s$, go upward into a gap and then reach the destination.\n**Sample 3**: No need to explain this one (the setter totally went wild).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "OIer们的东方梦", "background": "**#11,#12 两组 Hack 数据由 uid=20285 提供**\n\nOIer 们做~~魂魄妖~~梦都想去幻想乡玩一下。这一次，他们在睡~~古明地~~觉时在梦中穿越去了幻想乡，幻想乡有很多的少(ju)女(ruo)，但是他们被~~老太婆~~少女的美色~~和蒟蒻的美味~~所吸引，在幻想乡中迷失了方向。\n\n勇敢的~~死肥宅~~少年啊，现在你手里有一份幻想乡人间之里的地图，你知道 OIer 们的位置，你可以远程给OIer们传递信息，请你带领迷路的 OIer 们走进回到现实生活的祭坛吧！", "description": "给你一个 $N\\times M$ 的地图，如图所示：              \n```\n5400000S01     \n1111101101     \n000003X301      \n3111111101     \nE000300031      \n1111X30001     \n```\n\n其中有很多稀奇古怪的东西：  \n     \n* $S$ 表示出发点，$E$ 表示终点。      \n* $0$ 表示空地，你想怎么走就怎么走，走一格需要 $1s$。            \n* $1$ 表示墙，你无法通行（~~除非你受到了**风神少女**的庇护~~）。   \n* $2$ 表示小妖怪，你需要 $3s$ 的时间去消灭小妖怪，才能经过该位置。（PS: 妖怪被消灭后只要离开当前格子立刻复活）  \n* $3$ 表示大妖怪，你需要 $8s$ 的时间去消灭大妖怪，才能经过该位置。   \n* $4$ 表示太阳花田，到达该位置可以获得太阳花，获得太阳花后遇到妖怪时可**直接**通过该妖怪的位置。  \n* $5$ 表示楼观剑（科普君：楼观剑，英文名 $Louguan\\ is\\ very\\ jian$，是妖怪做的剑，楼观剑斩不断的东西几乎没有)，到达该位置可以花费 $5s$ 获得它，获得它后可以砍墙砍妖怪将其变成空地（当然也可以不砍，砍墙砍妖怪不需要时间，楼观剑可以一直使用**不会损坏**，有了楼观剑依然可以使用隙间，但是楼观剑不能砍隙间~~和一点用都没有的麻薯，麻薯妖梦UUZ是一家嘛~~）       \n* $M$ 表示麻薯（是 $mashu$ 不是 $mafu$~~不知道麻薯是什么的一把楼观剑给你砍过来~~)，碰到麻薯后你可以把它吃了(路人甲：那你为什么还要加这个东西? 出题人：有 $S$ 肯定要有 $M$ 啊。路人乙：我就是死外边，从隙间中跳下去，也不会吃麻薯！嗯~真香！）            \n* $X$ 表示紫妈的隙间，碰到隙间后会传送至其他的任意一个隙间(数据**不**保证只有 0 或 2 个隙间，**就是说可以有很多隙间乱传**)，每次传送耗时 $1s$。(经过当前格子时可以不经过隙间)       \n      \n答案输出 OIer 们到达终点所需最短时间。如果无法到达，输出 \"We want to live in the TouHou World forever\"。     \n翻译：此生无悔入东方，来世~~睡遍~~愿生幻想乡。   \n    \n**温馨提示：不排除存在可以往回走等稀奇古怪的最优走法**", "inputFormat": "数据共有 $N+1$行。\n\n第 $1$ 行输入 $N$ 和 $M$。  \n第 $2$ 到 $N+1$ 行输入 $N\\times M$ 的地图。", "outputFormat": "一行，最短时间或者 \"We want to live in the TouHou World forever\"。", "hint": "对于 $30\\%$ 的数据，$1\\leq N,M\\leq 50$。       \n对于 $50\\%$ 的数据，$1\\leq N,M\\leq 100$。       \n对于 $100\\%$ 的数据，$1\\leq N,M\\leq 1000$。\n\n保证有一组数据答案为 \"We want to live in the TouHou World forever\"，数据有梯度。\n\n### 样例解释\n\n**样例 1**：在 $7s$ 时到达楼观剑，在 $12s$ 时获得楼观剑，一路向下砍到达终点。                   \n**样例 2**：在 $10s$ 时到达 $(3,3)$，在 $32s$ 时到达$(3,10)$，向上进入隙间后到达终点。          \n**样例 3**：这个就不用解释了吧(出题人放飞自我)。", "locale": "zh-CN"}}}
{"pid": "P4873", "type": "P", "difficulty": 5, "samples": [["5 3\n0 1\n1 2\n2 3\n3 2\n6 1", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2014", "USACO", "树状数组", "离散化", "Dilworth 定理", "STL"], "title": "[USACO14DEC] Cow Jog G", "background": "", "description": "Farmer John's $N$ cows $(1 <= N <= 100,000)$ are out exercising their\nhooves again, jogging along an infinite track.  Each cow starts at a\ndistinct position on the track, and some cows run at different speeds.\n\nThe track is divided into lanes so that cows may move past each other.\nNo two cows in the same lane may ever occupy the same position.\nFarmer John doesn't want any cow to have to change lanes or adjust\nspeed, and he wonders how many lanes he will need to accomplish this\nif the cows are going to run for $T$ minutes $(1 <= T <= 1,000,000,000).$\n", "inputFormat": "The first line of input contains $N$ and $T$.\n\nThe following $N$ lines each contain the initial position and speed of a\nsingle cow.  Position is a nonnegative integer and speed is a positive\ninteger; both numbers are at most 1 billion.  All cows start at\ndistinct positions, and these will be given in increasing order in the\ninput.", "outputFormat": "A single integer indicating the minimum number of lanes necessary so\nthat no two cows in the same lane ever occupy the same location\n(including at time $T$).\n", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO14DEC] Cow Jog G", "background": "", "description": "Farmer John's $N$ cows $(1 <= N <= 100,000)$ are out exercising their\nhooves again, jogging along an infinite track.  Each cow starts at a\ndistinct position on the track, and some cows run at different speeds.\n\nThe track is divided into lanes so that cows may move past each other.\nNo two cows in the same lane may ever occupy the same position.\nFarmer John doesn't want any cow to have to change lanes or adjust\nspeed, and he wonders how many lanes he will need to accomplish this\nif the cows are going to run for $T$ minutes $(1 <= T <= 1,000,000,000).$\n", "inputFormat": "The first line of input contains $N$ and $T$.\n\nThe following $N$ lines each contain the initial position and speed of a\nsingle cow.  Position is a nonnegative integer and speed is a positive\ninteger; both numbers are at most 1 billion.  All cows start at\ndistinct positions, and these will be given in increasing order in the\ninput.", "outputFormat": "A single integer indicating the minimum number of lanes necessary so\nthat no two cows in the same lane ever occupy the same location\n(including at time $T$).\n", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO14DEC] Cow Jog G", "background": "", "description": "Farmer John 的 $ N $ 头奶牛 $ ( 1 \\le N \\le 10^5 ) $ 正在一条长度无限的跑道上慢跑，每头奶牛的初始位置都不一样；跑步速度也不全相同。\n\n为了方便奶牛们互相超越，整个跑道被分成了若干条赛道。在同一时刻，不能有在同一条赛道上的两头奶牛占据相同的位置，不然就会发生冲突。\n\n现在奶牛们要跑 $T$ 分钟，在跑步过程中，他们不会改变自己所在的赛道和自己跑步的速度。FJ 想要知道，为了奶牛间不会发生冲突，他至少需要准备多少条赛道。", "inputFormat": "输入的第一行包含两个非负整数 $N$ 和 $T$。\n\n接下来的 $N$ 行每行输入两个数 $x_i,v_i$，分别表示第 $i$ 头奶牛的初始位置以及速度。输入数据保证所有奶牛的初始位置互不相同且输入中会按初始位置递增给出。", "outputFormat": "一行一个整数表示 FJ 最少需要准备的赛道个数。", "hint": "对于样例一的说明：\n\n在这组样例中，FJ 会将第 $1,2,3$ 号奶牛放在第一个赛道。第 $4,5$ 两只奶牛分别各占一个赛道。最终需要 $3$ 个赛道，不难证明这是最优方案。\n\n数据范围：\n\n对于 $100\\%$ 的数据，满足 $1\\le N\\le 10^5$，$1\\le T,v_i\\le 10^9$，$0\\le x_i\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P4875", "type": "P", "difficulty": 5, "samples": [["9 2\n1 1\n5 1\n6 1\n9 1\n100 1\n2 2\n7 2\n3 3\n8 3", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 3000, 6000, 5000, 3000, 5000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "USACO"], "title": "[USACO14OPEN] Fair Photography G", "background": "", "description": "FJ's $N$ cows $(1 <= N <= 100,000)$ are standing at various positions along a long one-dimensional fence.  The $ith$ cow is standing at position $x_i$ (an integer in the range 0...1,000,000,000) and has breed $b_i$ (an integer in the range 1..8).  No two cows occupy the same position. \n\nFJ wants to take a photo of a contiguous interval of cows for the county fair, but we wants all of his breeds to be fairly represented in the photo. Therefore, he wants to ensure that, for whatever breeds are present in the photo, there is an equal number of each breed (for example, a photo with $27$ each of breeds $1$ and $3$ is ok, a photo with $27$ of breeds $1, 3,$ and $4$ is ok, but $9$ of breed $1$ and $10$ of breed $3$ is not ok). Farmer John also wants at least $K (K >= 2)$ breeds (out of the 8 total) to be represented in the photo. Help FJ take his fair photo by finding the maximum size of a photo that satisfies FJ's constraints.  The size of a photo is the difference between the maximum and minimum positions of the cows in the photo. \n\nIf there are no photos satisfying FJ's constraints, output $-1$ instead.\n", "inputFormat": "* Line 1: $N$ and $K$ separated by a space\n\n* Lines $2..N+1$: Each line contains a description of a cow as two integers separated by a space; $x(i)$ and its breed id.\n", "outputFormat": "* Line 1: A single integer indicating the maximum size of a fair photo. If no such photo exists, output -1.", "hint": "INPUT DETAILS:\n\nBreed ids: 1 2 3 - 1 1 2 3 1  - ...  -   1\nLocations: 1 2 3 4 5 6 7 8 9 10 ... 99 100\n\n\n\nOUTPUT DETAILS:\n\nThe range from x = 2 to x = 8 has 2 each of breeds 1, 2, and 3. The range from x = 9 to x = 100 has 2 of breed 1, but this is invalid because K = 2 and so we must have at least 2 distinct breeds.", "locale": "en", "translations": {"en": {"title": "[USACO14OPEN] Fair Photography G", "background": "", "description": "FJ's $N$ cows $(1 <= N <= 100,000)$ are standing at various positions along a long one-dimensional fence.  The $ith$ cow is standing at position $x_i$ (an integer in the range 0...1,000,000,000) and has breed $b_i$ (an integer in the range 1..8).  No two cows occupy the same position. \n\nFJ wants to take a photo of a contiguous interval of cows for the county fair, but we wants all of his breeds to be fairly represented in the photo. Therefore, he wants to ensure that, for whatever breeds are present in the photo, there is an equal number of each breed (for example, a photo with $27$ each of breeds $1$ and $3$ is ok, a photo with $27$ of breeds $1, 3,$ and $4$ is ok, but $9$ of breed $1$ and $10$ of breed $3$ is not ok). Farmer John also wants at least $K (K >= 2)$ breeds (out of the 8 total) to be represented in the photo. Help FJ take his fair photo by finding the maximum size of a photo that satisfies FJ's constraints.  The size of a photo is the difference between the maximum and minimum positions of the cows in the photo. \n\nIf there are no photos satisfying FJ's constraints, output $-1$ instead.\n", "inputFormat": "* Line 1: $N$ and $K$ separated by a space\n\n* Lines $2..N+1$: Each line contains a description of a cow as two integers separated by a space; $x(i)$ and its breed id.\n", "outputFormat": "* Line 1: A single integer indicating the maximum size of a fair photo. If no such photo exists, output -1.", "hint": "INPUT DETAILS:\n\nBreed ids: 1 2 3 - 1 1 2 3 1  - ...  -   1\nLocations: 1 2 3 4 5 6 7 8 9 10 ... 99 100\n\n\n\nOUTPUT DETAILS:\n\nThe range from x = 2 to x = 8 has 2 each of breeds 1, 2, and 3. The range from x = 9 to x = 100 has 2 of breed 1, but this is invalid because K = 2 and so we must have at least 2 distinct breeds.", "locale": "en"}, "zh-CN": {"title": "[USACO14OPEN] Fair Photography G", "background": "", "description": "FJ 的 $N$ 头奶牛（$1 \\leq N \\leq 100,000$）站在一条长长的一维栅栏的不同位置。第 $i$ 头奶牛站在位置 $x_i$（范围为 0 到 1,000,000,000 的整数），其品种为 $b_i$（范围为 1 到 8 的整数）。没有两头奶牛占据相同的位置。\n\nFJ 想为县集市拍摄一张连续区间的奶牛照片，但他希望所有的品种在照片中都能得到公平的代表。因此，他希望确保在照片中出现的任何品种数量都是相等的（例如，包含 27 头品种 1 和品种 3 的照片是可以的，包含 27 头品种 1、3 和 4 的照片也是可以的，但包含 9 头品种 1 和 10 头品种 3 的照片则不可以）。农夫约翰还希望照片中至少有 $K$（$K \\geq 2$）个品种（总共 8 个品种）被代表。帮助 FJ 拍摄他的公平照片，找出满足 FJ 约束条件的最大照片大小。照片的大小是照片中奶牛的最大位置和最小位置之间的差。\n\n如果没有满足 FJ 约束条件的照片，则输出 $-1$。", "inputFormat": "* 第 1 行：两个用空格分隔的整数 $N$ 和 $K$。\n\n* 第 2 行到第 $N+1$ 行：每行包含两个用空格分隔的整数，描述一头奶牛的位置 $x(i)$ 和其品种 id。", "outputFormat": "* 第 1 行：一个整数，表示公平照片的最大大小。如果不存在这样的照片，则输出 -1。", "hint": "输入详情：\n\n品种 id：1 2 3 - 1 1 2 3 1 - ... - 1\n\n位置：1 2 3 4 5 6 7 8 9 10 ... 99 100\n\n输出详情：\n\n从 $x = 2$ 到 $x = 8$ 的范围内有 2 头品种 1、2 和 3。范围从 $x = 9$ 到 $x = 100$ 有 2 头品种 1，但这是无效的，因为 $K = 2$，所以我们必须至少有 2 个不同的品种。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P4876", "type": "P", "difficulty": 6, "samples": [["4 3\n7 8 6\n3 0 0\n4 6 0\n1 4 2", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "USACO"], "title": "[USACO14MAR] The Lazy Cow G", "background": "", "description": "It's a hot summer day, and Bessie the cow is feeling quite lazy. She wants to locate herself at a position in her field so that she can reach as much delicious grass as possible within only a short distance.\n\nThere are $N$ patches of grass $(1 <= N <= 100,000)$ in Bessie's field. The $ith$ such patch contains $g_i$ units of grass $(1 <= g_i <= 10,000)$ and is located at a distinct point $(x_i, y_i)$ in the field $(0 <= x_i,$ $y_i <= $ $1,000,000)$.  Bessie would like to choose a point in the field as her initial location (possibly the same point as a patch of grass, and possibly even a point with non-integer coordinates) so that a maximum amount of grass is within a distance of $K$ steps from this location $(1 <= K <= 2,000,000)$.\n\nWhen Bessie takes a step, she moves 1 unit north, south, east, or west of her current position.  For example, to move from $(0,0)$ to $(3,2)$, this requires 5 total steps.  Bessie does not need to take integer-sized steps -- for example, 1 total step could be divided up as half a unit north and half a unit east.\n\nPlease help Bessie determine the maximum amount of grass she can reach, if she chooses the best possible initial location.\n", "inputFormat": "* Line 1: The integers $N$ and $K$.\n\n* Lines 2..1+N: Line $i+1$ describes the $ith$ patch of grass using 3 integers: $g_i, x_i, y_i.$\n", "outputFormat": "* Line 1: The maximum amount of grass Bessie can reach within $K$ steps, if she locates herself at the best possible initial position.", "hint": "INPUT DETAILS:\n\nBessie is willing to take at most 3 steps from her initial position.  There\nare 4 patches of grass.  The first contains 7 units of grass and is located\nat position $(8,6)$, and so on.\n\nOUTPUT DETAILS:\n\nBy locating herself at $(3,0)$, the grass at positions $(0,0)$, $(6,0)$, and\n$(4,2)$ is all within $K$ units of distance.", "locale": "en", "translations": {"en": {"title": "[USACO14MAR] The Lazy Cow G", "background": "", "description": "It's a hot summer day, and Bessie the cow is feeling quite lazy. She wants to locate herself at a position in her field so that she can reach as much delicious grass as possible within only a short distance.\n\nThere are $N$ patches of grass $(1 <= N <= 100,000)$ in Bessie's field. The $ith$ such patch contains $g_i$ units of grass $(1 <= g_i <= 10,000)$ and is located at a distinct point $(x_i, y_i)$ in the field $(0 <= x_i,$ $y_i <= $ $1,000,000)$.  Bessie would like to choose a point in the field as her initial location (possibly the same point as a patch of grass, and possibly even a point with non-integer coordinates) so that a maximum amount of grass is within a distance of $K$ steps from this location $(1 <= K <= 2,000,000)$.\n\nWhen Bessie takes a step, she moves 1 unit north, south, east, or west of her current position.  For example, to move from $(0,0)$ to $(3,2)$, this requires 5 total steps.  Bessie does not need to take integer-sized steps -- for example, 1 total step could be divided up as half a unit north and half a unit east.\n\nPlease help Bessie determine the maximum amount of grass she can reach, if she chooses the best possible initial location.\n", "inputFormat": "* Line 1: The integers $N$ and $K$.\n\n* Lines 2..1+N: Line $i+1$ describes the $ith$ patch of grass using 3 integers: $g_i, x_i, y_i.$\n", "outputFormat": "* Line 1: The maximum amount of grass Bessie can reach within $K$ steps, if she locates herself at the best possible initial position.", "hint": "INPUT DETAILS:\n\nBessie is willing to take at most 3 steps from her initial position.  There\nare 4 patches of grass.  The first contains 7 units of grass and is located\nat position $(8,6)$, and so on.\n\nOUTPUT DETAILS:\n\nBy locating herself at $(3,0)$, the grass at positions $(0,0)$, $(6,0)$, and\n$(4,2)$ is all within $K$ units of distance.", "locale": "en"}, "zh-CN": {"title": "[USACO14MAR] The Lazy Cow G", "background": null, "description": "Bessie 的田里有 $n$（$1\\le n \\le 10^5$）块草地，每块草地的坐标是 $(x_i,y_i)$（$0\\le x_i,y_i\\le 10^6$），上面长着 $gi$（$1\\le g_i\\le 10^4$）个单位的牧草。   \n\nBessie 可以向东南西北方向走，一次走一步（一个单位长度）。如她从 $(0,0)$ 走到 $(3,2)$ 需要 $5$ 步。她最多可以一次走 $k$（$\\le k \\le 2\\times 10^6$）步。  \n\n现在她想找一个位置，使她从该位置出发可以得到最多单位的牧草（她可以走多次，但每次都从该位置出发）。", "inputFormat": "第一行两个整数 $n$ 和 $k$。  \n\n第 $2$ 到 $n+1$ 行，每行三个整数 $g_i,x_i,y_i$。", "outputFormat": "一行一个整数，表示 Bessie 所能获得的最多单位牧草数", "hint": null, "locale": "zh-CN"}}}
{"pid": "P4877", "type": "P", "difficulty": 5, "samples": [["3 1\n2 7 6\n5 1 7\n2 2 4\n4 2 1", "17"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2014", "USACO", "进制", "状压 DP"], "title": "[USACO14FEB] Cow Decathlon G", "background": "", "description": "Farmer John's $N$ cows $(1 <= N <= 20)$, conveniently labeled $1...N$ as always, are preparing for a decathlon that has $N$ different events (so perhaps it would be better called an N-athlon instead of a decathlon, which traditionally has exactly 10 events).\n\nCow i has a skill level of $s_ij$ $(1 <= s_ij <= 1000)$ when competing in event j.  Each cow must compete in one and only one event, and each event must have some cow competing in it.\n\nThe total score for all cows is the sum of their skill levels for the events in which they are competing.  However, the event judges can also give out bonus points if they are particularly impressed.  There are $B$ bonuses $(1 <= B <= 20)$ that the judges can give out. Bonus i has three parts: if the cows obtain at least $P_i$ points $(1 <= P_i <= 40,000)$ for the first $K_i$ events (including other bonuses involving just those events), they will get an additional $A_i$ points $(1 <= A_i <= 1000)$.  \n\nFor example, let us consider $N = 3$ cows with the following skills:\n\n```\n      E V E N T\n     | 1 | 2 | 3\n   --+---+---+--\nC  1 | 5 | 1 | 7\n   --+---+---+--\nO  2 | 2 | 2 | 4\n   --+---+---+--\nW  3 | 4 | 2 | 1\n```\nFor example, cow 1 would earn the team 7 points if she participates in event 3.  \n\nSuppose the judges offer a bonus (B = 1), such that if the if the cows score at least 7 points in the first two events, they will get an  additional 6 points.  Here, the optimal assignment would be to assign cow 1 to event 1, cow 2 to event 3 and cow 3 to event 2.  For the first two events, cow 1 will score 5 points and cow 3 will score 2 points giving them 7 points, which is enough to satisfy bonus 1.  Therefore, the total points that they score will be 5+2+4+6=17.\n\nPlease help decide which events the cows should attempt to maximize their total score.", "inputFormat": "* Line 1: Two space-separated integers: $N, B$\n\n* Lines 2..B+1: Line i+1 will contain the information for bonus i which is three space- separated integers: $K_i, P_i, A_i$.\n\n* Lines B+2..B+N+1: Line B+1+j will contain the information on how cow j will perform at each  of her events. This will be given in $N$ space-separated integers: $s_j1...s_jN.$", "outputFormat": "* Line 1: The maximum amount of points that the cows can receive, including bonuses.\n", "hint": "Cow 1 will perform event 1, cow 3 will perform event 2, and cow 2 will  perform event 3.", "locale": "en", "translations": {"en": {"title": "[USACO14FEB] Cow Decathlon G", "background": "", "description": "Farmer John's $N$ cows $(1 <= N <= 20)$, conveniently labeled $1...N$ as always, are preparing for a decathlon that has $N$ different events (so perhaps it would be better called an N-athlon instead of a decathlon, which traditionally has exactly 10 events).\n\nCow i has a skill level of $s_ij$ $(1 <= s_ij <= 1000)$ when competing in event j.  Each cow must compete in one and only one event, and each event must have some cow competing in it.\n\nThe total score for all cows is the sum of their skill levels for the events in which they are competing.  However, the event judges can also give out bonus points if they are particularly impressed.  There are $B$ bonuses $(1 <= B <= 20)$ that the judges can give out. Bonus i has three parts: if the cows obtain at least $P_i$ points $(1 <= P_i <= 40,000)$ for the first $K_i$ events (including other bonuses involving just those events), they will get an additional $A_i$ points $(1 <= A_i <= 1000)$.  \n\nFor example, let us consider $N = 3$ cows with the following skills:\n\n```\n      E V E N T\n     | 1 | 2 | 3\n   --+---+---+--\nC  1 | 5 | 1 | 7\n   --+---+---+--\nO  2 | 2 | 2 | 4\n   --+---+---+--\nW  3 | 4 | 2 | 1\n```\nFor example, cow 1 would earn the team 7 points if she participates in event 3.  \n\nSuppose the judges offer a bonus (B = 1), such that if the if the cows score at least 7 points in the first two events, they will get an  additional 6 points.  Here, the optimal assignment would be to assign cow 1 to event 1, cow 2 to event 3 and cow 3 to event 2.  For the first two events, cow 1 will score 5 points and cow 3 will score 2 points giving them 7 points, which is enough to satisfy bonus 1.  Therefore, the total points that they score will be 5+2+4+6=17.\n\nPlease help decide which events the cows should attempt to maximize their total score.", "inputFormat": "* Line 1: Two space-separated integers: $N, B$\n\n* Lines 2..B+1: Line i+1 will contain the information for bonus i which is three space- separated integers: $K_i, P_i, A_i$.\n\n* Lines B+2..B+N+1: Line B+1+j will contain the information on how cow j will perform at each  of her events. This will be given in $N$ space-separated integers: $s_j1...s_jN.$", "outputFormat": "* Line 1: The maximum amount of points that the cows can receive, including bonuses.\n", "hint": "Cow 1 will perform event 1, cow 3 will perform event 2, and cow 2 will  perform event 3.", "locale": "en"}, "zh-CN": {"title": "[USACO14FEB] Cow Decathlon G", "background": null, "description": "#### 题目大意\n\n约翰有 $N$ 头奶牛，组成了一支队伍参加全能比赛。\n\n比赛一共有 $N$ 项，按照顺序依次进行。每头奶牛必须参加一项比赛，每项比赛也必须有一头奶牛参加。\n\n每头奶牛都可以胜任每一项比赛，但得分不一样。如果第 $i$ 头奶牛参加第 $j$ 项比赛，在比赛结束的时候，可以为团体总分增加 $S_{i,j}$。\n\n除了上述获得分数的方法之外，还有 $B$ 种奖励分。获得奖励的方法是在前几项比赛里获得足够的分数。\n\n具体来说，第 $i$ 项奖励会在第 $K_i$ 项比赛结束的时候检查，如果当时的总分大于或等于 $P_i$，奶牛们就可以立即获得额外的 $A_i$ 分。\n\n如果有多项奖励在同一时刻检查，奶牛可以自由安排检查和加分的顺序。\n\n请问约翰应该如何安排奶牛参加比赛，才能让它们获得最高的分数？", "inputFormat": "第 $1$ 行：两个整数 $N$ 和 $B$。\n\n第 $2$ 行到第 $B+1$ 行：第 $i+1$ 行有三个整数 $K_i$，$P_i$ 和 $A_i$。\n\n第 $B+2$ 行到第 $B+N+1$ 行：第 $i+B+1$ 行有 $N$ 个整数，代表 $S_{i,1}$ 到 $S_{i,N}$。", "outputFormat": "单个整数，表示奶牛们可以获得的最大得分。", "hint": "#### 样例解释 #1\n\n第一项比赛由第一头奶牛参加，第二项比赛由第三头奶牛参加，第三项比赛由第二头奶牛参加。\n\n#### 数据范围\n\n对于所有数据，$1 \\le N,B \\le 20$，$1 \\le K_i \\le N$ ，$1 \\le P_i \\le 4 \\times 10^4$，$1 \\le A_i \\le 10^3$，$1 \\le S_{i,j} \\le 10^3$。\n\ntranslator：2018_RNG丶妖夢", "locale": "zh-CN"}}}
{"pid": "P4878", "type": "P", "difficulty": 4, "samples": [["4 2 1\n1 3 10\n2 4 20\n2 3 3", "27"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2005", "USACO", "最短路", "差分约束", "差分"], "title": "[USACO05DEC] Layout G", "background": "14组数据，前10组为原数据，后4组为hack数据", "description": "Like everyone else, cows like to stand close to their friends when queuing for feed. FJ has N (2 <= N <= 1,000) cows numbered 1..N standing along a straight line waiting for feed. The cows are standing in the same order as they are numbered, and since they can be rather pushy, it is possible that two or more cows can line up at exactly the same location (that is, if we think of each cow as being located at some coordinate on a number line, then it is possible for two or more cows to share the same coordinate). \n\nSome cows like each other and want to be within a certain distance of each other in line. Some really dislike each other and want to be separated by at least a certain distance. A list of ML (1 <= ML <= 10,000) constraints describes which cows like each other and the maximum distance by which they may be separated; a subsequent list of MD constraints (1 <= MD <= 10,000) tells which cows dislike each other and the minimum distance by which they must be separated. \n\nYour job is to compute, if possible, the maximum possible distance between cow 1 and cow N that satisfies the distance constraints.", "inputFormat": "Line 1: Three space-separated integers: N, ML, and MD. \n\nLines 2..ML+1: Each line contains three space-separated positive integers: A, B, and D, with 1 <= A < B <= N. Cows A and B must be at most D (1 <= D <= 1,000,000) apart. \n\nLines ML+2..ML+MD+1: Each line contains three space-separated positive integers: A, B, and D, with 1 <= A < B <= N. Cows A and B must be at least D (1 <= D <= 1,000,000) apart.", "outputFormat": "Line 1: A single integer. If no line-up is possible, output -1. If cows 1 and N can be arbitrarily far apart, output -2. Otherwise output the greatest possible distance between cows 1 and N.\n", "hint": "Explanation of the sample: \n\nThere are 4 cows. Cows #1 and #3 must be no more than 10 units apart, cows #2 and #4 must be no more than 20 units apart, and cows #2 and #3 dislike each other and must be no fewer than 3 units apart. \n\nThe best layout, in terms of coordinates on a number line, is to put cow #1 at 0, cow #2 at 7, cow #3 at 10, and cow #4 at 27.", "locale": "en", "translations": {"en": {"title": "[USACO05DEC] Layout G", "background": "14组数据，前10组为原数据，后4组为hack数据", "description": "Like everyone else, cows like to stand close to their friends when queuing for feed. FJ has N (2 <= N <= 1,000) cows numbered 1..N standing along a straight line waiting for feed. The cows are standing in the same order as they are numbered, and since they can be rather pushy, it is possible that two or more cows can line up at exactly the same location (that is, if we think of each cow as being located at some coordinate on a number line, then it is possible for two or more cows to share the same coordinate). \n\nSome cows like each other and want to be within a certain distance of each other in line. Some really dislike each other and want to be separated by at least a certain distance. A list of ML (1 <= ML <= 10,000) constraints describes which cows like each other and the maximum distance by which they may be separated; a subsequent list of MD constraints (1 <= MD <= 10,000) tells which cows dislike each other and the minimum distance by which they must be separated. \n\nYour job is to compute, if possible, the maximum possible distance between cow 1 and cow N that satisfies the distance constraints.", "inputFormat": "Line 1: Three space-separated integers: N, ML, and MD. \n\nLines 2..ML+1: Each line contains three space-separated positive integers: A, B, and D, with 1 <= A < B <= N. Cows A and B must be at most D (1 <= D <= 1,000,000) apart. \n\nLines ML+2..ML+MD+1: Each line contains three space-separated positive integers: A, B, and D, with 1 <= A < B <= N. Cows A and B must be at least D (1 <= D <= 1,000,000) apart.", "outputFormat": "Line 1: A single integer. If no line-up is possible, output -1. If cows 1 and N can be arbitrarily far apart, output -2. Otherwise output the greatest possible distance between cows 1 and N.\n", "hint": "Explanation of the sample: \n\nThere are 4 cows. Cows #1 and #3 must be no more than 10 units apart, cows #2 and #4 must be no more than 20 units apart, and cows #2 and #3 dislike each other and must be no fewer than 3 units apart. \n\nThe best layout, in terms of coordinates on a number line, is to put cow #1 at 0, cow #2 at 7, cow #3 at 10, and cow #4 at 27.", "locale": "en"}, "zh-CN": {"title": "[USACO05DEC] Layout G", "background": null, "description": "正如其他物种一样，奶牛们也喜欢在排队打饭时与它们的朋友挨在一起。FJ 有编号为 $1\\dots N$ 的 $N$ 头奶牛 $(2\\le N\\le 1000)$。奶牛们始终需要按照编号顺序来排队。奶牛们很笨拙，因此可能有多头奶牛在同一位置上。\n\n有些奶牛是好基友，它们希望彼此之间的距离小于等于某个数。有些奶牛是情敌，它们希望彼此之间的距离大于等于某个数。\n\n给出 $M_L$ 对好基友的编号，以及它们希望彼此之间的距离小于等于多少；又给出 $M_D$ 对情敌的编号，以及它们希望彼此之间的距离大于等于多少 $(1\\le M_L,$ $M_D\\le 10^4)$。\n\n请计算：如果满足上述所有条件，$1$ 号奶牛和 $N$ 号奶牛之间的距离最大为多少。", "inputFormat": "第一行：三个整数 $N, M_L, M_D$，用空格分隔。\n\n第 $2\\dots M_L+1$ 行：每行三个整数 $A, B, D$，用空格分隔，表示 $A$ 号奶牛与 $B$ 号奶牛之间的距离须 $\\le D$。保证 $1\\le A<B\\le N,$ $1\\le D\\le 10^6$。\n\n第 $M_L+2\\dots M_L+M_D+1$ 行：每行三个整数 $A, B, D$，用空格分隔，表示 $A$ 号奶牛与 $B$ 号奶牛之间的距离须 $\\ge D$。保证 $1\\le A<B\\le N,$ $1\\le D\\le 10^6$。", "outputFormat": "一行，一个整数。如果没有合法方案，输出 `-1`. 如果有合法方案，但 $1$ 号奶牛可以与 $N$ 号奶牛相距无穷远，输出 `-2`. 否则，输出 $1$ 号奶牛与 $N$ 号奶牛间的最大距离。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P4879", "type": "P", "difficulty": 5, "samples": [["5 10\n1 2 3 4 5\nQ\nC 3 2\nQ\nI 6 6\nQ\nD 4\nQ\nC 5 2\nI 7 9\nQ", "15\n13\n19\n15\n22"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["线段树", "树状数组", "分块"], "title": "ycz的妹子", "background": "ycz 有很多很多的妹子（ycz：瞎说）", "description": "机房神犇 ycz 有 $n$ 个青梅竹马，她们分别住在 $1\\sim n$ 号城市中。小时候的她们美丽可爱，但是由于女大十八变，有些妹子的颜值发生了变化，但是十分重感情的 ycz 神犇不忍心抛弃她们，于是记录下来了她们颜值变化的值，我们用 $C, x, y$ 表示第 $x$ 个城市的妹子的颜值下降了 $y$。长大之后的 ycz 非常有魅力，有许多妹子被 ycz 迷得神魂颠倒，我们用 $I, x, y$ 表示第 $x$ 个城市有一个妹子喜欢上了 ycz ，她的颜值为 $y$（$y$ 有可能是负数，但是 ycz 来者不拒）。但在中途有一些妹子和 ycz 吵架了，于是就分手了，我们用 $D, x$ 表示**第 $x$ 个妹子**和 ycz 分手了。\n\n最近神犇 ycz 要去全国各地找他的妹子们，为了方便计算，我们珂以把 ycz 的妹子所在的城市当作是一条直线，并且挨在一起。神犇 ycz 由于忙于和他的妹子们联系此时已经很累了，于是交给你一个这样的任务：他想知道他在某个时间去找他的所有妹子们珂以获得多大的愉悦度，这个愉悦度为他找的妹子的颜值数，你要做的就是求出这个愉悦度之和（注意长大后妹子们的颜值可能为负数/滑稽）。\n\n注意：每个城市只允许有一个妹子，也就是说后来喜欢上 ycz 的妹子会赶走之前这个城市喜欢 ycz 的妹子 ~~（一城不容二女）~~。\n\nUPD:\n\n青梅竹马都是喜欢 ycz 的。\n\n分手的第 $x$ 个妹子不是第 $x$ 城市的妹子，是指从前往后数第 $x$ 个有妹子的城市的妹子。\n\n青梅竹马长大后就是妹子。\n\n修改的值 $y$ 不为负数，但是颜值减去之后可能为负数。", "inputFormat": "ycz 有 $5 \\times 10^5$ 座城市，开始时，前 $n$ 座城市各有一个妹子，第 $i$ 座城市妹子初始的颜值为 $a_i$。\n\n有 $m$ 次以下四种操作。\n\n - `C x y` 第 $x$ 座城市的妹子颜值减少 $y$；\n - `I x y` 第 $x$ 座城市出现了一个颜值为 $y$ 的妹子，如果在此之前，第 $x$ 座城市已经有妹子，则之前的妹子被驱赶；\n - `D x` 第 $x$ 个有妹子的城市 中的妹子与 ycz 分手；\n - `Q` ycz 想知道他所有妹子的颜值总和是多少。\n\n本题数据在 Windows 下生成，输入中换行均为 `\\r\\n` 而非 `\\n`。", "outputFormat": "对于每一个 $Q$ 输出一个整数", "hint": "**样例解释：**\n\n妹子颜值变化如下，删除的就没写在下面了。\n\n```\n1 2 1 4 5\n1 2 1 4 5 6\n1 2 1 5 6\n1 2 1 3 6\n1 2 1 3 6 9\n```\n\n对于 $30\\%$ 的数据，$1 \\le n,m \\le 10$\n\n对于 $70\\%$ 的数据，$1 \\le n,m \\le 1000$\n\n对于 $100\\%$ 的数据，$1 \\le n,m \\le 100000,|a_i|,|y| \\le 10^9$", "locale": "zh-CN", "translations": {"en": {"title": "ycz’s Girls", "background": "ycz has a lot, a lot of girls (ycz: just kidding).", "description": "The legendary ycz has $n$ childhood sweethearts, and they live in cities numbered $1 \\sim n$. When they were young, they were pretty and cute. But as time went by, some girls’ looks changed. Since ycz is very sentimental and cannot bear to abandon them, he recorded the amount of change in their looks.\n\nWe use $C, x, y$ to mean that the girl in city $x$ has her looks decreased by $y$.\n\nAfter growing up, ycz became very charming, and many girls fell for him. We use $I, x, y$ to mean that in city $x$ a girl appears who likes ycz, and her looks value is $y$ ($y$ may be negative, but ycz accepts everyone). However, some girls quarrel with ycz and then break up. We use $D, x$ to mean that the **$x$-th girl** breaks up with ycz.\n\nRecently, ycz is going to visit his girls all around the country. For easier calculation, we can treat the cities where his girls are as points on a straight line, placed next to each other. ycz is already tired from keeping in touch with his girls, so he gives you this task:\n\nHe wants to know, at some time, how much “happiness” he can get by visiting all of his girls. This happiness is defined as the sum of the girls’ looks values he visits. Your job is to compute this sum (note that after growing up, a girl’s looks value may be negative).\n\nNote: Each city is allowed to have only one girl. That is, a girl who appears later in a city will drive away the previous girl in that city ~~(two girls cannot share one city)~~.\n\nUPD:\n\nChildhood sweethearts all like ycz.\n\nThe $x$-th girl to break up is not the girl in city $x$. It means the girl in the $x$-th city (counting from left to right) that currently has a girl.\n\nChildhood sweethearts become “girls” after growing up.\n\nThe modified value $y$ is not negative, but the looks value may become negative after subtraction.", "inputFormat": "ycz has $5 \\times 10^5$ cities. Initially, each of the first $n$ cities has one girl, and the initial looks value of the girl in city $i$ is $a_i$.\n\nThere are $m$ operations of the following four types.\n\n - `C x y` The looks value of the girl in city $x$ decreases by $y$.\n - `I x y` A girl with looks value $y$ appears in city $x$. If there was already a girl in city $x$ before, the previous girl is driven away.\n - `D x` The girl in the $x$-th city (among the cities that currently have a girl) breaks up with ycz.\n - `Q` ycz wants to know the total sum of looks values of all his girls.", "outputFormat": "For each `Q`, output one integer.", "hint": "**Sample explanation:**\n\nThe looks values change as follows. Deleted ones are not written below.\n\n```\n1 2 1 4 5\n1 2 1 4 5 6\n1 2 1 5 6\n1 2 1 3 6\n1 2 1 3 6 9\n```\n\nFor 30% of the testdata, $1 \\le n,m \\le 10$.\n\nFor 70% of the testdata, $1 \\le n,m \\le 1000$.\n\nFor 100% of the testdata, $1 \\le n,m \\le 100000,|a_i|,|y| \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "ycz的妹子", "background": "ycz 有很多很多的妹子（ycz：瞎说）", "description": "机房神犇 ycz 有 $n$ 个青梅竹马，她们分别住在 $1\\sim n$ 号城市中。小时候的她们美丽可爱，但是由于女大十八变，有些妹子的颜值发生了变化，但是十分重感情的 ycz 神犇不忍心抛弃她们，于是记录下来了她们颜值变化的值，我们用 $C, x, y$ 表示第 $x$ 个城市的妹子的颜值下降了 $y$。长大之后的 ycz 非常有魅力，有许多妹子被 ycz 迷得神魂颠倒，我们用 $I, x, y$ 表示第 $x$ 个城市有一个妹子喜欢上了 ycz ，她的颜值为 $y$（$y$ 有可能是负数，但是 ycz 来者不拒）。但在中途有一些妹子和 ycz 吵架了，于是就分手了，我们用 $D, x$ 表示**第 $x$ 个妹子**和 ycz 分手了。\n\n最近神犇 ycz 要去全国各地找他的妹子们，为了方便计算，我们珂以把 ycz 的妹子所在的城市当作是一条直线，并且挨在一起。神犇 ycz 由于忙于和他的妹子们联系此时已经很累了，于是交给你一个这样的任务：他想知道他在某个时间去找他的所有妹子们珂以获得多大的愉悦度，这个愉悦度为他找的妹子的颜值数，你要做的就是求出这个愉悦度之和（注意长大后妹子们的颜值可能为负数/滑稽）。\n\n注意：每个城市只允许有一个妹子，也就是说后来喜欢上 ycz 的妹子会赶走之前这个城市喜欢 ycz 的妹子 ~~（一城不容二女）~~。\n\nUPD:\n\n青梅竹马都是喜欢 ycz 的。\n\n分手的第 $x$ 个妹子不是第 $x$ 城市的妹子，是指从前往后数第 $x$ 个有妹子的城市的妹子。\n\n青梅竹马长大后就是妹子。\n\n修改的值 $y$ 不为负数，但是颜值减去之后可能为负数。", "inputFormat": "ycz 有 $5 \\times 10^5$ 座城市，开始时，前 $n$ 座城市各有一个妹子，第 $i$ 座城市妹子初始的颜值为 $a_i$。\n\n有 $m$ 次以下四种操作。\n\n - `C x y` 第 $x$ 座城市的妹子颜值减少 $y$；\n - `I x y` 第 $x$ 座城市出现了一个颜值为 $y$ 的妹子，如果在此之前，第 $x$ 座城市已经有妹子，则之前的妹子被驱赶；\n - `D x` 第 $x$ 个有妹子的城市 中的妹子与 ycz 分手；\n - `Q` ycz 想知道他所有妹子的颜值总和是多少。\n\n本题数据在 Windows 下生成，输入中换行均为 `\\r\\n` 而非 `\\n`。", "outputFormat": "对于每一个 $Q$ 输出一个整数", "hint": "**样例解释：**\n\n妹子颜值变化如下，删除的就没写在下面了。\n\n```\n1 2 1 4 5\n1 2 1 4 5 6\n1 2 1 5 6\n1 2 1 3 6\n1 2 1 3 6 9\n```\n\n对于 $30\\%$ 的数据，$1 \\le n,m \\le 10$\n\n对于 $70\\%$ 的数据，$1 \\le n,m \\le 1000$\n\n对于 $100\\%$ 的数据，$1 \\le n,m \\le 100000,|a_i|,|y| \\le 10^9$", "locale": "zh-CN"}}}
{"pid": "P4880", "type": "P", "difficulty": 4, "samples": [["6 9 1 6\n1 2 1\n1 3 3\n1 4 4\n2 3 2\n3 6 6\n4 5 6\n2 5 9\n3 5 7\n5 6 2\n3\n10 3\n8 5\n9 2", "9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["排序", "最短路"], "title": "抓住czx", "background": "蒟蒻 lty 出了一道题，但是由于太弱了，所以希望喜欢鸽子的 czx 来帮他写一个 std 。由于 czx 又放鸽子去了，所以没有写 std。蒟蒻 lty 觉得受到了学长的鄙视，所以决定去 czx 放鸽子的地方找他。", "description": "czx 放鸽子的地方是一个公园，公园可以看作是由 $n$ 个点 $m$ 条边组成的无向图（保证无自环），lty 将从公园的入口（$b$ 号节点）进去寻找 czx，czx 刚开始的位置为 $e$，而 czx 会在 $a_i$ 个单位时间时变化位置到第 $x$ 个节点去，在此之前 lty 已经知道了 czx 的具体位置和接下来他位置的变化方案，蒟蒻 lty 现在想知道他至少需要花多少时间找到 czx。\n\nUPD:\n\n保证图连通，czx 最后会待在一个地方不动。", "inputFormat": "第一行四个整数 $n,m,b,e$。$b$ 和 $e$ 的意义如题面所示。\n\n接下来 $m$ 行，每行三个整数 $x,y,z$，表示 $x$ 到 $y$ 之间有一条双向边，lty 走这条边要花费 $z$ 的时间。\n\n第 $m+1$ 行一个整数 $T$，表示 czx 位置变化的次数。\n\n接下来 $T$ 行，每行两个整数 $a_i$ 和 $x$，表示 czx 将在第 $a_i$ 个单位时间时移动到第 $x$ 个点上去。", "outputFormat": "一个整数，表示最短所需时间。", "hint": "**样例解释：**\n\n在开始的时候就直接走到 $2$ 号节点，然后等到 czx过来。总花费时间 $9$ 个单位时间。\n\n对于 30% 的数据，$n\\le 100,m\\le 1000,T\\le 100$\n\n对于另外 30% 的数据，$T=0$\n\n对于 100% 的数据，$n \\le 10^5,m \\le 5\\times10^5,T \\le 10^5$\n\n数据保证所有时间在 int 范围内\n\n注意：在任意一个 czx 开始移动的时间点，都是 czx 先瞬移，然后 lty 再行走，也就是说， lty 不能在 czx 瞬移的时候到他瞬移前的点抓住他，但是 lty 可以在他瞬移到的点等着抓他。", "locale": "zh-CN", "translations": {"en": {"title": "Catch czx", "background": "Beginner lty made a problem, but he was too weak, so he wanted czx, who likes “letting pigeons” (fang ge zi), to help him write a std. However, czx went to “let pigeons” again, so he did not write the std. Beginner lty felt looked down upon by his senior, so he decided to go to the place where czx is “letting pigeons” to find him.", "description": "The place where czx is “letting pigeons” is a park. The park can be seen as an undirected graph with $n$ nodes and $m$ edges (self-loops are guaranteed not to exist). lty will enter from the entrance of the park (node $b$) to look for czx. czx’s initial position is $e$. Then, at time $a_i$, czx will change his position to node $x$. Before that, lty already knows czx’s exact position and his future movement plan. Now beginner lty wants to know the minimum time needed to catch czx.\n\nUPD:\n\nThe graph is guaranteed to be connected, and czx will finally stay at one place and stop moving.", "inputFormat": "The first line contains four integers $n, m, b, e$. The meanings of $b$ and $e$ are as described in the statement.\n\nThe next $m$ lines each contain three integers $x, y, z$, indicating there is a bidirectional edge between $x$ and $y$, and it takes lty $z$ time to traverse this edge.\n\nThe $(m+1)$-th line contains an integer $T$, indicating the number of times czx changes his position.\n\nThe next $T$ lines each contain two integers $a_i$ and $x$, indicating that at time $a_i$, czx will move to node $x$.", "outputFormat": "Output one integer, the minimum required time.", "hint": "**Sample explanation:**\n\nAt the beginning, go directly to node $2$, then wait for czx to come. The total time cost is $9$ units of time.\n\nFor 30% of the testdata, $n \\le 100, m \\le 1000, T \\le 100$.\n\nFor another 30% of the testdata, $T = 0$.\n\nFor 100% of the testdata, $n \\le 10^5, m \\le 5\\times10^5, T \\le 10^5$.\n\nThe testdata guarantees that all times fit in the range of int.\n\nNote: At any time when czx starts moving, czx teleports first, and then lty moves. That is, lty cannot catch czx at the node before he teleports at the teleport moment, but lty can wait at the destination node and catch him there.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "抓住czx", "background": "蒟蒻 lty 出了一道题，但是由于太弱了，所以希望喜欢鸽子的 czx 来帮他写一个 std 。由于 czx 又放鸽子去了，所以没有写 std。蒟蒻 lty 觉得受到了学长的鄙视，所以决定去 czx 放鸽子的地方找他。", "description": "czx 放鸽子的地方是一个公园，公园可以看作是由 $n$ 个点 $m$ 条边组成的无向图（保证无自环），lty 将从公园的入口（$b$ 号节点）进去寻找 czx，czx 刚开始的位置为 $e$，而 czx 会在 $a_i$ 个单位时间时变化位置到第 $x$ 个节点去，在此之前 lty 已经知道了 czx 的具体位置和接下来他位置的变化方案，蒟蒻 lty 现在想知道他至少需要花多少时间找到 czx。\n\nUPD:\n\n保证图连通，czx 最后会待在一个地方不动。", "inputFormat": "第一行四个整数 $n,m,b,e$。$b$ 和 $e$ 的意义如题面所示。\n\n接下来 $m$ 行，每行三个整数 $x,y,z$，表示 $x$ 到 $y$ 之间有一条双向边，lty 走这条边要花费 $z$ 的时间。\n\n第 $m+1$ 行一个整数 $T$，表示 czx 位置变化的次数。\n\n接下来 $T$ 行，每行两个整数 $a_i$ 和 $x$，表示 czx 将在第 $a_i$ 个单位时间时移动到第 $x$ 个点上去。", "outputFormat": "一个整数，表示最短所需时间。", "hint": "**样例解释：**\n\n在开始的时候就直接走到 $2$ 号节点，然后等到 czx过来。总花费时间 $9$ 个单位时间。\n\n对于 30% 的数据，$n\\le 100,m\\le 1000,T\\le 100$\n\n对于另外 30% 的数据，$T=0$\n\n对于 100% 的数据，$n \\le 10^5,m \\le 5\\times10^5,T \\le 10^5$\n\n数据保证所有时间在 int 范围内\n\n注意：在任意一个 czx 开始移动的时间点，都是 czx 先瞬移，然后 lty 再行走，也就是说， lty 不能在 czx 瞬移的时候到他瞬移前的点抓住他，但是 lty 可以在他瞬移到的点等着抓他。", "locale": "zh-CN"}}}
{"pid": "P4881", "type": "P", "difficulty": 5, "samples": [["2\n1\n3", "26\n2054"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "线性递推", "逆元"], "title": "hby与tkw的基情", "background": "> 基情恒久远，一对永流传。\n\nhby 和 tkw 是一对好基友，他们经常在一起做♂游♂戏 (/滑稽)。\n", "description": "他们喜欢玩字符串游戏，尤其喜欢玩回文串。每次 hby 会给出一个数 $n$，那么 tkw 就需要给出 $Ans=\\sum\\limits_{i=1}^ni\\times s[i]\\times[i\\bmod 2]$。其中 $s[i]$ 代表长度为 $i$ 的回文串的个数（只考虑小写字母），最后面是 bool 表达式\n\n不过由于 tkw 最近学 ycz 找妹纸去了，于是他就将这个问题交给了你，如果你不能在 $1\\rm s$ 内答出来，那么 hby 和 tkw 的基情将会破裂！~~（不过那样 tkw 就可以安心地找妹纸了）~~\n\n由于答案会非常大，所以你只需要输出答案 $\\bmod 10^9+7$ 的值即可", "inputFormat": "第一行一个整数 $T$。\n\n接下来 $T$ 行，每行一个数 $n$。", "outputFormat": "共 $T$ 行，每行代表一个答案。", "hint": "对于 $10\\%$的数据，$n\\le 5$。\n\n对于另外 $20\\%$ 的数据，$\\sum n\\le 10^7$。\n\n对于另外 $20\\%$ 的数据，$T=1$。\n\n对于 $100\\%$ 的数据，$1\\le T\\le 5\\times 10^5$，$1\\le n\\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "hby and tkw’s Bromance", "background": "> Bromance lasts forever, a pair will be passed down for eternity.\n\nhby and tkw are a pair of close buddies. They often play “games” together (/joking).", "description": "They like playing string games, and they especially like palindromes. Each time, hby gives a number $n$, and then tkw needs to give $Ans=\\sum\\limits_{i=1}^ni\\times s[i]\\times[i\\bmod 2]$. Here, $s[i]$ represents the number of palindromic strings of length $i$ (only lowercase letters are considered). The last part is a bool expression.\n\nHowever, recently tkw has been learning from ycz to go find a girlfriend, so he handed this problem to you. If you cannot answer it within $1\\rm s$, then the bromance between hby and tkw will break! ~~(But then tkw can focus on finding a girlfriend.)~~\n\nSince the answer will be very large, you only need to output the value of the answer $\\bmod 10^9+7$.", "inputFormat": "The first line contains an integer $T$.\n\nIn the next $T$ lines, each line contains one number $n$.", "outputFormat": "There are $T$ lines in total, each line represents one answer.", "hint": "For $10\\%$ of the testdata, $n\\le 5$.\n\nFor another $20\\%$ of the testdata, $\\sum n\\le 10^7$.\n\nFor another $20\\%$ of the testdata, $T=1$.\n\nFor $100\\%$ of the testdata, $1\\le T\\le 5\\times 10^5$, $1\\le n\\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "hby与tkw的基情", "background": "> 基情恒久远，一对永流传。\n\nhby 和 tkw 是一对好基友，他们经常在一起做♂游♂戏 (/滑稽)。\n", "description": "他们喜欢玩字符串游戏，尤其喜欢玩回文串。每次 hby 会给出一个数 $n$，那么 tkw 就需要给出 $Ans=\\sum\\limits_{i=1}^ni\\times s[i]\\times[i\\bmod 2]$。其中 $s[i]$ 代表长度为 $i$ 的回文串的个数（只考虑小写字母），最后面是 bool 表达式\n\n不过由于 tkw 最近学 ycz 找妹纸去了，于是他就将这个问题交给了你，如果你不能在 $1\\rm s$ 内答出来，那么 hby 和 tkw 的基情将会破裂！~~（不过那样 tkw 就可以安心地找妹纸了）~~\n\n由于答案会非常大，所以你只需要输出答案 $\\bmod 10^9+7$ 的值即可", "inputFormat": "第一行一个整数 $T$。\n\n接下来 $T$ 行，每行一个数 $n$。", "outputFormat": "共 $T$ 行，每行代表一个答案。", "hint": "对于 $10\\%$的数据，$n\\le 5$。\n\n对于另外 $20\\%$ 的数据，$\\sum n\\le 10^7$。\n\n对于另外 $20\\%$ 的数据，$T=1$。\n\n对于 $100\\%$ 的数据，$1\\le T\\le 5\\times 10^5$，$1\\le n\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P4882", "type": "P", "difficulty": 6, "samples": [["3 1", "16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": [], "title": "lty loves 96！", "background": "众所周知，$lty$非常喜欢$96$这两个数字（想歪的现在马上面壁去），更甚于复读~~（人本复）~~！", "description": "由于爱屋及乌，因此，$lty$对于那些含有$96$的数也非常喜欢，而这里的含有不是一般的含有，而是具有以下性质的含有（三条都需要满足）：\n* 这个数为一个$N$位数，且没有前置零\n* 这个数中至少要出现$M$次$9$和$6$（例：$986996$中出现了$5$次，$9$出现了$3$次，$6$出现了$2$次，共计$5$次）\n* 这个数存在连续的三位$A$,$B$,$C$，满足下面任意一条\n\t* $A+B+C$为$9$或$6$\n\t* $(A^2+B^2)$%$C$为$9$或$6$，如果$C$为$0$，则该条件视为不满足", "inputFormat": "一行，两个数$N$,$M$", "outputFormat": "一个数，表示这样的数的个数", "hint": "对于10%的数据，$N<=6$\n\n对于40%的数据，$N<=18$\n\n对于100%的数据，$N<=50$，$0<=M<=N$\n", "locale": "zh-CN", "translations": {"en": {"title": "lty Loves 96!", "background": "As everyone knows, $lty$ really likes the two digits $96$ (if your mind went the wrong way, go face the wall right now), even more than repeating a grade ~~(a repeating student)~~!", "description": "Because of “loving what someone loves”, $lty$ also likes numbers that “contain $96$”. Here, “contain” does not mean the usual kind of contain, but must satisfy all of the following properties (all three must be met):\n\n* The number is an $N$-digit number and has no leading zeros.\n* In this number, the digits $9$ and $6$ appear at least $M$ times in total (example: $986996$ has $5$ occurrences in total: $9$ appears $3$ times and $6$ appears $2$ times, for a total of $5$).\n* There exist three consecutive digits $A$, $B$, $C$ that satisfy at least one of the following:\n\t* $A+B+C$ equals $9$ or $6$.\n\t* $(A^2+B^2)$%$C$ equals $9$ or $6$. If $C$ is $0$, then this condition is considered not satisfied.", "inputFormat": "One line with two numbers $N$, $M$.", "outputFormat": "One number, representing the count of such numbers.", "hint": "For $10\\%$ of the testdata, $N \\le 6$.\n\nFor $40\\%$ of the testdata, $N \\le 18$.\n\nFor $100\\%$ of the testdata, $N \\le 50$, $0 \\le M \\le N$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "lty loves 96！", "background": "众所周知，$lty$非常喜欢$96$这两个数字（想歪的现在马上面壁去），更甚于复读~~（人本复）~~！", "description": "由于爱屋及乌，因此，$lty$对于那些含有$96$的数也非常喜欢，而这里的含有不是一般的含有，而是具有以下性质的含有（三条都需要满足）：\n* 这个数为一个$N$位数，且没有前置零\n* 这个数中至少要出现$M$次$9$和$6$（例：$986996$中出现了$5$次，$9$出现了$3$次，$6$出现了$2$次，共计$5$次）\n* 这个数存在连续的三位$A$,$B$,$C$，满足下面任意一条\n\t* $A+B+C$为$9$或$6$\n\t* $(A^2+B^2)$%$C$为$9$或$6$，如果$C$为$0$，则该条件视为不满足", "inputFormat": "一行，两个数$N$,$M$", "outputFormat": "一个数，表示这样的数的个数", "hint": "对于10%的数据，$N<=6$\n\n对于40%的数据，$N<=18$\n\n对于100%的数据，$N<=50$，$0<=M<=N$\n", "locale": "zh-CN"}}}
{"pid": "P4883", "type": "P", "difficulty": 6, "samples": [["8 9\n4 6 2 1 7 9 10 2\n1 1 4\n3 1 6\n2 4 5 2\n3 1 6\n2 1 5 8\n3 1 6\n2 5 7 10\n3 4 7\n3 1 8\n", "29\n29\n69\n24\n59"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["平衡树", "进制"], "title": "mzf的考验", "background": "$mzf$立志要成为一个豪杰，当然，他也是一个$OIer$。\n他希望自己除了会$OI$之外还会各种东西，比如心理学、吉他、把妹等等。\n为了让自己有更大的魅力，他不驼背，不熬夜，整天锻炼，双目炯炯有神，是我们机房最不像$OIer$的人。\n然而，在与我们格格不入若干天并且将《易经》研究透彻之后，承受不住我们对他另类的言论，他爆发了。\n机房在那一刹那仿佛天塌地陷，世界末日。", "description": "八卦有乾、坤、震、巽、坎、离、艮、兑；\n两两组合，一上一下，形成了六十四卦，每卦六爻，一共三百八十四爻。\n爻分阴阳，阳爻性属阳刚，阴爻性属阴柔。天下之大，无奇不有。千奇百怪，皆出此处。\n$mzf$研究透彻了易经之后，画出了$n$个奇怪的图案。他说那是他改进出来的更强大的卜卦体系。\n每一个图案有二十行，每一行要么是阴爻$(0)$，要么是阳爻$(1)$，作为一个$OIer$，我们可以将卦象看成一个个二进制串；\n他将$n$个图案画在了符纸上，然后进行$m$次操作：\n\n操作1：翻转区间$[l,r]$的图案，比如$(3,1,2,5)$变成$(5,2,1,3)$；\n\n操作2：$mzf$画地为卦，将$[l,r]$之间的卦象都异或上新画的那个卦象；\n\n操作3：$mzf$会询问机房里的其他人$[l,r]$之间卦象代表的二进制数权值和。\n\n如果不能正确回答每个操作$3$，那么机房风水格局将会改变，我们都将...！\n\n由于$mzf$疯狂之下将我们都捆♂绑♂了起来，所以只能求求你来帮我们解决这个问题。", "inputFormat": "第一行两个正整数：$n$，$m$（$n$为序列长度，$m$为操作个数）\n\n第二行$n$个正整数：$a[i]$ (用$10$进制数表示每个卦象)$(1<=i<=n)$\n\n接下来$m$行：每行首先一个正整数$opt$表示操作类型\n\n1. $opt=1$：两个正整数：$l,r$。请翻转区间 $[l,r]$；\n2. $opt=2$：三个正整数：$l,r,d$。请将区间$[l,r]$中的所有卦象都异或卦象$d$。（$0\\le d\\lt 2^{20}$）\n3. $opt=3$：两个正整数：$l,r$。请查询区间 $[l,r]$ 的卦象权值和。", "outputFormat": "对于每个 $opt=3$ 的情况，输出一行答案。", "hint": "对于 $20\\%$ 的数据，$n\\le1000$，$m\\le 1000$。\n\n对于另外 $20\\%$ 的数据，不存在操作 $1$。\n\n对于另外 $20\\%$ 的数据，保证 $n$ 为 $2$ 的次幂，且在操作 $1$ 中，保证 $l=i\\times(2^j)+1$，$r=(i+1)\\times(2^j)$，其中 $i,j$ 为任意值。\n\n对于 $100\\%$ 的数据，$n\\le 10^5$，$m\\le 5\\times 10^4$，$1\\le l\\le r\\le n$，$0\\le d<2^{20}$。", "locale": "zh-CN", "translations": {"en": {"title": "mzf's Trial.", "background": "$mzf$ is determined to become a hero. Of course, he is also an $OIer$.\nHe hopes that besides being good at $OI$, he can also do many other things, such as psychology, guitar, flirting, and so on.\nTo be more attractive, he does not hunch his back, does not stay up late, works out all day, and has bright eyes. He is the least like an $OIer$ in our computer room.\nHowever, after being out of place with us for several days and thoroughly studying the I Ching, he could not stand our weird comments about him, and he exploded.\nAt that moment, it felt like the sky was falling and the earth was collapsing. It was like the end of the world.", "description": "The Eight Trigrams are Qian, Kun, Zhen, Xun, Kan, Li, Gen, and Dui.\nCombining them in pairs, one on top and one below, forms the sixty-four hexagrams. Each hexagram has six lines, making a total of 384 lines.\nLines are divided into yin and yang. A yang line is strong, and a yin line is soft. The world is vast, and anything can happen. All kinds of strange things come from here.\nAfter thoroughly studying the I Ching, $mzf$ drew $n$ strange patterns. He said they were a stronger divination system improved by him.\nEach pattern has 20 rows. Each row is either a yin line $(0)$ or a yang line $(1)$. As $OIers$, we can view each hexagram as a binary string.\nHe drew these $n$ patterns on talismans, and then performed $m$ operations:\n\nOperation 1: Reverse the patterns in interval $[l,r]$, for example, $(3,1,2,5)$ becomes $(5,2,1,3)$.\n\nOperation 2: $mzf$ draws a new hexagram, and XORs all hexagrams in $[l,r]$ with this newly drawn hexagram.\n\nOperation 3: $mzf$ asks other people in the computer room for the sum of the weights (values) of the binary numbers represented by the hexagrams in $[l,r]$.\n\nIf we cannot correctly answer every Operation $3$, then the feng shui layout of the computer room will change, and we will all...!\n\nSince $mzf$, in his madness, tied us all up, we can only beg you to help us solve this problem.", "inputFormat": "The first line contains two positive integers: $n$, $m$ ($n$ is the length of the sequence, and $m$ is the number of operations).\n\nThe second line contains $n$ positive integers: $a[i]$ (each hexagram is given in decimal)$(1<=i<=n)$.\n\nNext $m$ lines: each line starts with a positive integer $opt$ indicating the operation type.\n\n1. $opt=1$: two positive integers: $l,r$. Please reverse interval $[l,r]$.\n2. $opt=2$: three positive integers: $l,r,d$. Please XOR every hexagram in $[l,r]$ with hexagram $d$. ($0\\le d\\lt 2^{20}$)\n3. $opt=3$: two positive integers: $l,r$. Please query the sum of hexagram weights in interval $[l,r]$.", "outputFormat": "For each case of $opt=3$, output one line with the answer.", "hint": "For $20\\%$ of the testdata, $n\\le1000$, $m\\le 1000$.\n\nFor another $20\\%$ of the testdata, there is no Operation $1$.\n\nFor another $20\\%$ of the testdata, it is guaranteed that $n$ is a power of $2$, and in Operation $1$, it is guaranteed that $l=i\\times(2^j)+1$, $r=(i+1)\\times(2^j)$, where $i,j$ can be any values.\n\nFor $100\\%$ of the testdata, $n\\le 10^5$, $m\\le 5\\times 10^4$, $1\\le l\\le r\\le n$, $0\\le d<2^{20}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "mzf的考验", "background": "$mzf$立志要成为一个豪杰，当然，他也是一个$OIer$。\n他希望自己除了会$OI$之外还会各种东西，比如心理学、吉他、把妹等等。\n为了让自己有更大的魅力，他不驼背，不熬夜，整天锻炼，双目炯炯有神，是我们机房最不像$OIer$的人。\n然而，在与我们格格不入若干天并且将《易经》研究透彻之后，承受不住我们对他另类的言论，他爆发了。\n机房在那一刹那仿佛天塌地陷，世界末日。", "description": "八卦有乾、坤、震、巽、坎、离、艮、兑；\n两两组合，一上一下，形成了六十四卦，每卦六爻，一共三百八十四爻。\n爻分阴阳，阳爻性属阳刚，阴爻性属阴柔。天下之大，无奇不有。千奇百怪，皆出此处。\n$mzf$研究透彻了易经之后，画出了$n$个奇怪的图案。他说那是他改进出来的更强大的卜卦体系。\n每一个图案有二十行，每一行要么是阴爻$(0)$，要么是阳爻$(1)$，作为一个$OIer$，我们可以将卦象看成一个个二进制串；\n他将$n$个图案画在了符纸上，然后进行$m$次操作：\n\n操作1：翻转区间$[l,r]$的图案，比如$(3,1,2,5)$变成$(5,2,1,3)$；\n\n操作2：$mzf$画地为卦，将$[l,r]$之间的卦象都异或上新画的那个卦象；\n\n操作3：$mzf$会询问机房里的其他人$[l,r]$之间卦象代表的二进制数权值和。\n\n如果不能正确回答每个操作$3$，那么机房风水格局将会改变，我们都将...！\n\n由于$mzf$疯狂之下将我们都捆♂绑♂了起来，所以只能求求你来帮我们解决这个问题。", "inputFormat": "第一行两个正整数：$n$，$m$（$n$为序列长度，$m$为操作个数）\n\n第二行$n$个正整数：$a[i]$ (用$10$进制数表示每个卦象)$(1<=i<=n)$\n\n接下来$m$行：每行首先一个正整数$opt$表示操作类型\n\n1. $opt=1$：两个正整数：$l,r$。请翻转区间 $[l,r]$；\n2. $opt=2$：三个正整数：$l,r,d$。请将区间$[l,r]$中的所有卦象都异或卦象$d$。（$0\\le d\\lt 2^{20}$）\n3. $opt=3$：两个正整数：$l,r$。请查询区间 $[l,r]$ 的卦象权值和。", "outputFormat": "对于每个 $opt=3$ 的情况，输出一行答案。", "hint": "对于 $20\\%$ 的数据，$n\\le1000$，$m\\le 1000$。\n\n对于另外 $20\\%$ 的数据，不存在操作 $1$。\n\n对于另外 $20\\%$ 的数据，保证 $n$ 为 $2$ 的次幂，且在操作 $1$ 中，保证 $l=i\\times(2^j)+1$，$r=(i+1)\\times(2^j)$，其中 $i,j$ 为任意值。\n\n对于 $100\\%$ 的数据，$n\\le 10^5$，$m\\le 5\\times 10^4$，$1\\le l\\le r\\le n$，$0\\le d<2^{20}$。", "locale": "zh-CN"}}}
