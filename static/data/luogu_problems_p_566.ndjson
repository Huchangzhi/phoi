{"pid": "P12487", "type": "P", "difficulty": 7, "samples": [["3 1", "25 121"], ["1000 0", "24870169"], ["10000000000 0", "213223517"], ["100000000000000 1", "8177545 370603117"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["数学", "集训队互测", "2024", "数论", "类欧几里得算法", "Stern-Brocot 树", "筛法"], "title": "[集训队互测 2024] 月亮的背面是粉红色的", "background": ">在寂静的世界里\n>\n>我张开手去触碰你\n>\n>想要挣脱这泥泞笨重的地心引力\n>\n>我害怕的用力呼吸\n>\n>期待着不可能发生的奇迹\n>\n>闭上了双眼\n>\n>不见 偏离的心率\n>\n>无助的努力 渐渐地放弃\n>\n>在残缺的内心里\n>\n>哭泣着呐喊的我\n>\n>现在还是散落在月球表面\n>\n>等时间消逝\n>\n>沉淀\n>\n>我在哪里\n>\n>—— 『月球偏心率』", "description": "\n小 L 终于见到了月球的背面，可这里一片荒芜，冷漠乏味。\n\n他想要把这里染成热情的粉红色，为此他翻阅数学书找到了一个函数 $f_t(n)=2^{\\omega(n)}n^t$，他要根据这个函数决定染色的过程。\n\n这里的 $\\omega(n)$ 为 $n$ 的不同质因子个数，例如 $\\omega(1)=0,\\omega(2)=1,\\omega(8)=1,\\omega(6)=2$。\n\n小 L 先把这里划分成了 $n\\times n$ 片区域，每个区域倒入不同数量的粉色颜料。具体来说，他会在第 $i$ 行第 $j$ 列的区域内倒入 $f_t(\\gcd(i,j))f_t(\\operatorname{lcm}(i,j))$ 桶颜料。\n\n不过他已经没有精力去计算了，因此请你直接告诉他总共需要多少桶粉色颜料。\n\n更进一步的，如果上面的答案记成 $F_t(n)$，小 L 会告诉你一个整数 $m\\in \\{0,1\\}$：\n\n- 如果 $m=0$，请你输出 $F_0(n)$。\n\n- 如果 $m=1$，请你输出 $F_0(n),F_1(n)$。\n\n由于答案可能很大，请输出答案对 $10^9+7$ 取模的值。", "inputFormat": "一行两个整数 $n,m$。", "outputFormat": "$m+1$ 个整数代表 $F_0(n)\\sim F_m(n)$。", "hint": "- 子任务一 (3 分)：$1\\leq n\\leq 5000,m\\in\\{0,1\\}$。\n- 子任务二 (3 分)：$1\\leq n\\leq 10^7,m\\in\\{0,1\\}$。\n- 子任务三 (8分)：$0\\leq n\\leq 10^{10},m=0$。\n- 子任务四 (8分)：$0\\leq n\\leq 10^{10},m\\in\\{0,1\\}$。\n- 子任务五 (8分)：$0\\leq n\\leq 10^{12},m\\in\\{0,1\\}$。\n- 子任务六 (10分)：$0\\leq n\\leq 10^{13},m\\in\\{0,1\\}$。\n- 子任务七 (13分)：$0\\leq n\\leq 10^{14},m=0$。\n- 子任务八 (14分)：$0\\leq n\\leq 10^{14},m\\in\\{0,1\\}$。\n- 子任务九 (16分)：$1\\leq n\\leq 10^{16},m=0$。\n- 子任务十 (17分)：$1\\leq n\\leq 10^{15},m\\in\\{0,1\\}$。\n\n时间限制：第九个子任务时间限制 3s，第十个子任务时间限制 3s，其余子任务时间限制 2s。\n\n**注：与原题相比，为了卡掉错解，第十个子任务的时间有所调整**。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2024] 月亮的背面是粉红色的", "background": ">在寂静的世界里\n>\n>我张开手去触碰你\n>\n>想要挣脱这泥泞笨重的地心引力\n>\n>我害怕的用力呼吸\n>\n>期待着不可能发生的奇迹\n>\n>闭上了双眼\n>\n>不见 偏离的心率\n>\n>无助的努力 渐渐地放弃\n>\n>在残缺的内心里\n>\n>哭泣着呐喊的我\n>\n>现在还是散落在月球表面\n>\n>等时间消逝\n>\n>沉淀\n>\n>我在哪里\n>\n>—— 『月球偏心率』", "description": "\n小 L 终于见到了月球的背面，可这里一片荒芜，冷漠乏味。\n\n他想要把这里染成热情的粉红色，为此他翻阅数学书找到了一个函数 $f_t(n)=2^{\\omega(n)}n^t$，他要根据这个函数决定染色的过程。\n\n这里的 $\\omega(n)$ 为 $n$ 的不同质因子个数，例如 $\\omega(1)=0,\\omega(2)=1,\\omega(8)=1,\\omega(6)=2$。\n\n小 L 先把这里划分成了 $n\\times n$ 片区域，每个区域倒入不同数量的粉色颜料。具体来说，他会在第 $i$ 行第 $j$ 列的区域内倒入 $f_t(\\gcd(i,j))f_t(\\operatorname{lcm}(i,j))$ 桶颜料。\n\n不过他已经没有精力去计算了，因此请你直接告诉他总共需要多少桶粉色颜料。\n\n更进一步的，如果上面的答案记成 $F_t(n)$，小 L 会告诉你一个整数 $m\\in \\{0,1\\}$：\n\n- 如果 $m=0$，请你输出 $F_0(n)$。\n\n- 如果 $m=1$，请你输出 $F_0(n),F_1(n)$。\n\n由于答案可能很大，请输出答案对 $10^9+7$ 取模的值。", "inputFormat": "一行两个整数 $n,m$。", "outputFormat": "$m+1$ 个整数代表 $F_0(n)\\sim F_m(n)$。", "hint": "- 子任务一 (3 分)：$1\\leq n\\leq 5000,m\\in\\{0,1\\}$。\n- 子任务二 (3 分)：$1\\leq n\\leq 10^7,m\\in\\{0,1\\}$。\n- 子任务三 (8分)：$0\\leq n\\leq 10^{10},m=0$。\n- 子任务四 (8分)：$0\\leq n\\leq 10^{10},m\\in\\{0,1\\}$。\n- 子任务五 (8分)：$0\\leq n\\leq 10^{12},m\\in\\{0,1\\}$。\n- 子任务六 (10分)：$0\\leq n\\leq 10^{13},m\\in\\{0,1\\}$。\n- 子任务七 (13分)：$0\\leq n\\leq 10^{14},m=0$。\n- 子任务八 (14分)：$0\\leq n\\leq 10^{14},m\\in\\{0,1\\}$。\n- 子任务九 (16分)：$1\\leq n\\leq 10^{16},m=0$。\n- 子任务十 (17分)：$1\\leq n\\leq 10^{15},m\\in\\{0,1\\}$。\n\n时间限制：第九个子任务时间限制 3s，第十个子任务时间限制 3s，其余子任务时间限制 2s。\n\n**注：与原题相比，为了卡掉错解，第十个子任务的时间有所调整**。", "locale": "zh-CN"}}}
{"pid": "P12488", "type": "P", "difficulty": 7, "samples": [["3 3 1 2 1\n1 499122177 0\n0 499122177\n1 1\n1 2", "5\n748683269\n6\n5"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["集训队互测", "2024", "数论", "线段树合并"], "title": "[集训队互测 2024] 轮盘赌游戏", "background": "", "description": "一个有 $n$ 颗子弹的轮盘，子弹依次编号为 $0,1,\\dots n-1$，每一颗子弹有一个卡壳概率 $p_i$，表示如果即将激发的子弹是第 $i$ 颗，那么它有 $p_i$ 的概率卡壳不能被打出，有 $1-p_i$ 的概率成功打出。\n\n轮盘赌游戏的规则如下：均匀随机地从 $n$ 颗子弹中选择一颗子弹开始进行轮盘赌，每一轮都会激发一颗子弹，假设某一轮激发第 $i$ 颗子弹，如果子弹成功打出了，那么游戏结束；否则轮盘会向后旋转 $d$ 颗子弹，游戏进入下一轮，也就是即将激发的子弹会变成第 $(i+d)\\bmod n$ 颗。小 X 想要知道轮盘赌游戏结束轮数的期望。\n\n由于子弹的生产都是 $m$ 颗一盒生产的，而且生产质量是一致的，所以可以认为存在一个长度为 $m$ 的序列 $p_i'$，使得对于轮盘里的 $n$ 颗子弹，有：$p_i=p_{i\\bmod m}',i=0,1\\dots n-1$。\n\n为了增加游戏的乐趣，小 X 找到了 $q$ 枚特殊的子弹，他将会用这些子弹替换掉轮盘中的某一些子弹。小 X 将形式化地告诉你这个替换的过程。\n\n小 X 的每一颗特殊子弹都可以看作是一个二元组 $(x,y)$，表示这一颗子弹可以替换掉轮盘中的编号为 $x$ 子弹，让这一颗子弹的卡壳概率变成 $y$。\n\n小 X 的每一次替换都可以看作是一个二元组集合 $S$（保证 $S$ 中的所有二元组 $(x,y)$ 中 $x$ 互不相同），对于所有的 $(x,y)\\in S$，小 X 会将序列上的编号为 $x$ 颗子弹替换掉，让这颗子弹的卡壳概率变成 $y$。\n\n而对于一个二元组集合 $S$（也就是一次替换），记 $f(S)$ 为用**完成替换之后**的子弹进行轮盘赌游戏，游戏结束轮数的期望。\n\n小 X 会以如下方式生成 $q+t$ 个替换：\n\n* 其中前 $q$ 个替换的生成方式如下：第 $i$ 个替换为 $S_i=\\{(x_i,y_i)\\}$ 。\n* 后 $t$ 个替换的生成方式如下：第 $q+j$ 个替换是给定两个编号比它小且**没有被选择过**的替换，将其合并得到的结果。具体的，选择第 $a_j$ 和 $b_j$ 个替换（$a_j,b_j<q+j$），那么有第 $q+j$ 个替换为 $S_{q+j}=S_{a_j}\\cup S_{b_j}$。\n\n小 X 想要求出 $f(\\varnothing)$，以及 $f(S_i),i=1,2\\dots q+t$，但是小 X 还要去解决其他的问题，所以他找到了你。\n\n你需要告诉小 X  $f(\\varnothing)$， $f(S_i)$（$i=1,2\\dots q+t$）**乘 $n$ 之后**的结果，由于结果可能较大且不一定为整数，所以你只需要输出其对 $998244353$ 取模后的结果。", "inputFormat": "第一行输入五个数 $n,m,d,q,t$。\n\n第二行输入 $m$ 个数，其中第 $i$ 个数为 $p'_{i-1}$。\n\n接下来的 $q$ 行，每行两个数 $x_i,y_i$，表示 $S_i=\\{(x_i,y_i)\\}$。\n\n接下来的 $t$ 行，每行两个数 $a_i,b_i$，表示 $S_{i+q}=S_{a_i}\\cup S_{b_i}$。", "outputFormat": "共 $1+q+t$ 行，其中第一行为 $n\\times f(\\varnothing)$，接下来第 $i+1$ 行为 $n\\times f(S_i)$ 。", "hint": "#### 样例解释\n\n$\\dfrac{1}{2}\\equiv 499122177\\pmod {998244353}$，所以可以认为三颗子弹的卡壳概率为 $1,\\dfrac{1}{2},0$。\n\n对于 $f(\\varnothing)$，序列为 $1,\\dfrac{1}{2},0$，第一颗子弹进行的期望轮数为 $2\\times \\dfrac{1}{2}+3\\times \\dfrac{1}{2}=\\dfrac{5}{2}$，第二颗子弹进行的期望轮数为 $1\\times \\dfrac{1}{2}+2\\times \\dfrac{1}{2}=\\dfrac{3}{2}$，第三颗子弹的期望轮数为 $1$，最终答案为 $\\dfrac{5}{2}+\\dfrac{3}{2}+1=5$。\n\n$S_1=\\{(0,\\dfrac{1}{2})\\}$，替换后的序列为 $\\dfrac{1}{2},\\dfrac{1}{2},0$，答案为 $(1\\times \\dfrac{1}{2}+2\\times \\dfrac{1}{4}+3\\times \\dfrac{1}{4})+(1\\times \\dfrac{1}{2}+2\\times \\dfrac{1}{2})+1=\\dfrac{17}{4}$，$\\dfrac{17}{4}\\equiv 748683269\\pmod {998244353}$。\n\n$S_2=\\{(1,1)\\}$，替换后的序列为 $1,1,0$，答案为 $3+2+1=6$。\n\n$S_3=S_1\\cup S_2=\\{(0,\\dfrac{1}{2}),(1,1)\\}$，替换后的序列为 $\\dfrac{1}{2},1,0$，答案为 $(1\\times \\dfrac{1}{2}+3\\times \\dfrac{1}{2})+2+1=5$。\n\n### 数据范围\n\n对于所有数据满足：$1\\le d\\le n\\le 10^{16}$，$m\\le 5000$。$1\\le q,t\\le 10^5$，$0\\le x_i< n$ 且 $\\forall i\\neq j,x_i\\neq x_j$，$0\\le p'_i,y_i <998244353$，$1\\le a_i,b_i<i+q$ 且保证所有的 $a_i,b_i$ 均不相同，数据保证 $\\gcd(d,n)=1$，且对于任何询问，所有子弹被卡壳的概率之积对 $998244353$ 取模不等于 $1$。 \n\n* Subtask 1（10 pts）：$1\\le q,t,n\\le 10^3$。\n* Subtask 2（15 pts）：$1\\le n\\le 10^6$。\n* Subtask 3（30 pts）：$d=1$。\n* Subtask 4（20 pts）：$q=t=0$。\n* Subtask 5（25 pts）：无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2024] 轮盘赌游戏", "background": "", "description": "一个有 $n$ 颗子弹的轮盘，子弹依次编号为 $0,1,\\dots n-1$，每一颗子弹有一个卡壳概率 $p_i$，表示如果即将激发的子弹是第 $i$ 颗，那么它有 $p_i$ 的概率卡壳不能被打出，有 $1-p_i$ 的概率成功打出。\n\n轮盘赌游戏的规则如下：均匀随机地从 $n$ 颗子弹中选择一颗子弹开始进行轮盘赌，每一轮都会激发一颗子弹，假设某一轮激发第 $i$ 颗子弹，如果子弹成功打出了，那么游戏结束；否则轮盘会向后旋转 $d$ 颗子弹，游戏进入下一轮，也就是即将激发的子弹会变成第 $(i+d)\\bmod n$ 颗。小 X 想要知道轮盘赌游戏结束轮数的期望。\n\n由于子弹的生产都是 $m$ 颗一盒生产的，而且生产质量是一致的，所以可以认为存在一个长度为 $m$ 的序列 $p_i'$，使得对于轮盘里的 $n$ 颗子弹，有：$p_i=p_{i\\bmod m}',i=0,1\\dots n-1$。\n\n为了增加游戏的乐趣，小 X 找到了 $q$ 枚特殊的子弹，他将会用这些子弹替换掉轮盘中的某一些子弹。小 X 将形式化地告诉你这个替换的过程。\n\n小 X 的每一颗特殊子弹都可以看作是一个二元组 $(x,y)$，表示这一颗子弹可以替换掉轮盘中的编号为 $x$ 子弹，让这一颗子弹的卡壳概率变成 $y$。\n\n小 X 的每一次替换都可以看作是一个二元组集合 $S$（保证 $S$ 中的所有二元组 $(x,y)$ 中 $x$ 互不相同），对于所有的 $(x,y)\\in S$，小 X 会将序列上的编号为 $x$ 颗子弹替换掉，让这颗子弹的卡壳概率变成 $y$。\n\n而对于一个二元组集合 $S$（也就是一次替换），记 $f(S)$ 为用**完成替换之后**的子弹进行轮盘赌游戏，游戏结束轮数的期望。\n\n小 X 会以如下方式生成 $q+t$ 个替换：\n\n* 其中前 $q$ 个替换的生成方式如下：第 $i$ 个替换为 $S_i=\\{(x_i,y_i)\\}$ 。\n* 后 $t$ 个替换的生成方式如下：第 $q+j$ 个替换是给定两个编号比它小且**没有被选择过**的替换，将其合并得到的结果。具体的，选择第 $a_j$ 和 $b_j$ 个替换（$a_j,b_j<q+j$），那么有第 $q+j$ 个替换为 $S_{q+j}=S_{a_j}\\cup S_{b_j}$。\n\n小 X 想要求出 $f(\\varnothing)$，以及 $f(S_i),i=1,2\\dots q+t$，但是小 X 还要去解决其他的问题，所以他找到了你。\n\n你需要告诉小 X  $f(\\varnothing)$， $f(S_i)$（$i=1,2\\dots q+t$）**乘 $n$ 之后**的结果，由于结果可能较大且不一定为整数，所以你只需要输出其对 $998244353$ 取模后的结果。", "inputFormat": "第一行输入五个数 $n,m,d,q,t$。\n\n第二行输入 $m$ 个数，其中第 $i$ 个数为 $p'_{i-1}$。\n\n接下来的 $q$ 行，每行两个数 $x_i,y_i$，表示 $S_i=\\{(x_i,y_i)\\}$。\n\n接下来的 $t$ 行，每行两个数 $a_i,b_i$，表示 $S_{i+q}=S_{a_i}\\cup S_{b_i}$。", "outputFormat": "共 $1+q+t$ 行，其中第一行为 $n\\times f(\\varnothing)$，接下来第 $i+1$ 行为 $n\\times f(S_i)$ 。", "hint": "#### 样例解释\n\n$\\dfrac{1}{2}\\equiv 499122177\\pmod {998244353}$，所以可以认为三颗子弹的卡壳概率为 $1,\\dfrac{1}{2},0$。\n\n对于 $f(\\varnothing)$，序列为 $1,\\dfrac{1}{2},0$，第一颗子弹进行的期望轮数为 $2\\times \\dfrac{1}{2}+3\\times \\dfrac{1}{2}=\\dfrac{5}{2}$，第二颗子弹进行的期望轮数为 $1\\times \\dfrac{1}{2}+2\\times \\dfrac{1}{2}=\\dfrac{3}{2}$，第三颗子弹的期望轮数为 $1$，最终答案为 $\\dfrac{5}{2}+\\dfrac{3}{2}+1=5$。\n\n$S_1=\\{(0,\\dfrac{1}{2})\\}$，替换后的序列为 $\\dfrac{1}{2},\\dfrac{1}{2},0$，答案为 $(1\\times \\dfrac{1}{2}+2\\times \\dfrac{1}{4}+3\\times \\dfrac{1}{4})+(1\\times \\dfrac{1}{2}+2\\times \\dfrac{1}{2})+1=\\dfrac{17}{4}$，$\\dfrac{17}{4}\\equiv 748683269\\pmod {998244353}$。\n\n$S_2=\\{(1,1)\\}$，替换后的序列为 $1,1,0$，答案为 $3+2+1=6$。\n\n$S_3=S_1\\cup S_2=\\{(0,\\dfrac{1}{2}),(1,1)\\}$，替换后的序列为 $\\dfrac{1}{2},1,0$，答案为 $(1\\times \\dfrac{1}{2}+3\\times \\dfrac{1}{2})+2+1=5$。\n\n### 数据范围\n\n对于所有数据满足：$1\\le d\\le n\\le 10^{16}$，$m\\le 5000$。$1\\le q,t\\le 10^5$，$0\\le x_i< n$ 且 $\\forall i\\neq j,x_i\\neq x_j$，$0\\le p'_i,y_i <998244353$，$1\\le a_i,b_i<i+q$ 且保证所有的 $a_i,b_i$ 均不相同，数据保证 $\\gcd(d,n)=1$，且对于任何询问，所有子弹被卡壳的概率之积对 $998244353$ 取模不等于 $1$。 \n\n* Subtask 1（10 pts）：$1\\le q,t,n\\le 10^3$。\n* Subtask 2（15 pts）：$1\\le n\\le 10^6$。\n* Subtask 3（30 pts）：$d=1$。\n* Subtask 4（20 pts）：$q=t=0$。\n* Subtask 5（25 pts）：无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P12489", "type": "P", "difficulty": 7, "samples": [["4 4\n1 4 0 1 2 3\n1 2 3 5 4 5\n3 4 2 2 6 7\n1 1 1 4\n2 2 3 2\n3 3 2 0\n4 4 5 3\n1 3 3\n2 4 1\n1 4 2\n2 3 1", "45\n74\n76\n154\n"], ["4 4\n1 4 2 4 2 3\n1 3 1 3 4 5\n4 4 5 4\n1 1 3 3\n2 3 2 1 6 7\n2 2 0 3\n3 3 2 5\n1 3 3\n2 4 1\n1 4 2\n2 3 1", "36\n82\n106\n155\n"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["线段树", "集训队互测", "2024", "树链剖分", "全局平衡二叉树"], "title": "[集训队互测 2024] 线段树与区间加", "background": null, "description": "普罗在图书馆找到了一本关于算法的书。书中介绍了一种名为“线段树”的数据结构。\n\n>\n>线段树是一种有根的二叉树，其每个节点对应了序列上的一个区间 $[l,r]$，其中根节点对应 $[1,n]$。\n>\n>对于每个节点，若其代表的序列区间 $[l,r]$ 满足 $l=r$，则其为叶节点；否则存在整数 $k(l\\le k<r)$，满足其左儿子代表区间 $[l,k]$，右儿子代表区间 $[k+1, r]$。为了保证其时间复杂度，$k$ 一般会取 $\\left\\lfloor\\frac{l+r}{2}\\right\\rfloor$。\n>\n>线段树可以实现单点修改，区间修改，区间查询等操作。其中区间修改操作的实现通常需要维护名为懒惰标记的额外信息。\n>\n\n在简单了解了线段树如何维护区间加之后，普罗想要实现一个维护区间加的线段树。于是他写下了如下的代码：\n\n```cpp\n#define len(i) (r[i]-l[i]+1)\nvoid push_down(int i)\n{\n    a[lc[i]]+=len(lc[i])*lz[i];\n    lz[lc[i]]+=lz[i];\n    a[rc[i]]+=len(rc[i])*lz[i];\n    lz[rc[i]]+=lz[i];\n    lz[i]=0;\n    return;\n}\nvoid add(int i,int ql,int qr,unsigned k)\n{\n    if(qr<l[i]||r[i]<ql) return;\n    if(ql<=l[i]&&r[i]<=qr){\n        a[i]+=len(i)*k;\n        lz[i]+=k;\n        return;\n    }\n    push_down(i);\n    add(lc[i],ql,qr,k);\n    add(rc[i],ql,qr,k);\n    a[i]=a[lc[i]]+a[rc[i]];\n    return;\n}\n```\n\n为了检验这份代码的正确性，普罗构建了一个维护的序列长为 $n$ 的线段树，并在每个节点上设置两个额外的权值 $va_i,vb_i$，接下来他在线段树上进行了 $m$ 次区间加的操作，在每次区间加操作后输出了下面函数的返回值。\n\n```cpp\nunsigned foobar(){\n\tunsigned tot=0;\n\tfor(int i=1;i<2*n;i++)tot+=va[i]*a[i]+vb[i]*lz[i];\n\treturn tot;\n}\n```\n\n因为 K 博士的电脑实在太快了，普罗的代码只花了 1ms 就得出了结果。但是他还是不知道代码是不是正确的，所以请你计算出上面的函数的结果和普罗得出的结果比较吧。", "inputFormat": "第一行两个整数 $n,m$，表示线段树维护的序列长度和操作次数。\n\n接下来 $2n-1$ 行，第 $i$ 行首先是四个整数 $l_i,r_i,va_i,vb_i$，表示线段树上第 $i$ 个节点对应的区间的左端点和右端点，以及节点上的两个额外权值。如果这个节点不是根节点，那么接下来还有两个整数 $lc_i,rc_i$，表示这个节点的左儿子编号和右儿子编号。\n\n接下来 $m$ 行，每行三个整数 $ql_i,qr_i,k_i$，表示一次区间加操作的左端点，右端点和增加的值。", "outputFormat": "在每次区间加操作后输出一行一个正整数表示 `foobar` 函数的返回值。", "hint": "【数据规模与约定】\n\n| 测试点编号 | $n,q$ | 其他约定 |\n| :-----------: | :-----------: | :-----------: |\n| $1\\sim5$ | $\\le2000$ | 无 |\n| $6\\sim10$ | $\\le40000$ | 无 |\n| $11\\sim15$ | $\\le2\\times10^5$ | 保证存在一个线段树上的节点对应的区间为 $[ql,qr]$ |\n| $16\\sim20$ | $\\le2\\times10^5$ | 保证不同的 $ql,qr$ 不超过 $200$ 种 |\n| $21\\sim25$ | $\\le2\\times10^5$ | 无 |\n\n如果测试点编号 $\\bmod 5$ 为 $2$ 或 $3$，该测试点保证 $va_i=0$。\n\n如果测试点编号 $\\bmod 5$ 为 $4$ 或 $0$，该测试点保证 $vb_i=0$。\n\n对于 $100\\%$ 的数据，保证 $1\\le n,q\\le2\\times10^5$，给出的线段树和区间加操作是合法的，$0\\le va_i,vb_i,k_i<2^{32}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2024] 线段树与区间加", "background": null, "description": "普罗在图书馆找到了一本关于算法的书。书中介绍了一种名为“线段树”的数据结构。\n\n>\n>线段树是一种有根的二叉树，其每个节点对应了序列上的一个区间 $[l,r]$，其中根节点对应 $[1,n]$。\n>\n>对于每个节点，若其代表的序列区间 $[l,r]$ 满足 $l=r$，则其为叶节点；否则存在整数 $k(l\\le k<r)$，满足其左儿子代表区间 $[l,k]$，右儿子代表区间 $[k+1, r]$。为了保证其时间复杂度，$k$ 一般会取 $\\left\\lfloor\\frac{l+r}{2}\\right\\rfloor$。\n>\n>线段树可以实现单点修改，区间修改，区间查询等操作。其中区间修改操作的实现通常需要维护名为懒惰标记的额外信息。\n>\n\n在简单了解了线段树如何维护区间加之后，普罗想要实现一个维护区间加的线段树。于是他写下了如下的代码：\n\n```cpp\n#define len(i) (r[i]-l[i]+1)\nvoid push_down(int i)\n{\n    a[lc[i]]+=len(lc[i])*lz[i];\n    lz[lc[i]]+=lz[i];\n    a[rc[i]]+=len(rc[i])*lz[i];\n    lz[rc[i]]+=lz[i];\n    lz[i]=0;\n    return;\n}\nvoid add(int i,int ql,int qr,unsigned k)\n{\n    if(qr<l[i]||r[i]<ql) return;\n    if(ql<=l[i]&&r[i]<=qr){\n        a[i]+=len(i)*k;\n        lz[i]+=k;\n        return;\n    }\n    push_down(i);\n    add(lc[i],ql,qr,k);\n    add(rc[i],ql,qr,k);\n    a[i]=a[lc[i]]+a[rc[i]];\n    return;\n}\n```\n\n为了检验这份代码的正确性，普罗构建了一个维护的序列长为 $n$ 的线段树，并在每个节点上设置两个额外的权值 $va_i,vb_i$，接下来他在线段树上进行了 $m$ 次区间加的操作，在每次区间加操作后输出了下面函数的返回值。\n\n```cpp\nunsigned foobar(){\n\tunsigned tot=0;\n\tfor(int i=1;i<2*n;i++)tot+=va[i]*a[i]+vb[i]*lz[i];\n\treturn tot;\n}\n```\n\n因为 K 博士的电脑实在太快了，普罗的代码只花了 1ms 就得出了结果。但是他还是不知道代码是不是正确的，所以请你计算出上面的函数的结果和普罗得出的结果比较吧。", "inputFormat": "第一行两个整数 $n,m$，表示线段树维护的序列长度和操作次数。\n\n接下来 $2n-1$ 行，第 $i$ 行首先是四个整数 $l_i,r_i,va_i,vb_i$，表示线段树上第 $i$ 个节点对应的区间的左端点和右端点，以及节点上的两个额外权值。如果这个节点不是根节点，那么接下来还有两个整数 $lc_i,rc_i$，表示这个节点的左儿子编号和右儿子编号。\n\n接下来 $m$ 行，每行三个整数 $ql_i,qr_i,k_i$，表示一次区间加操作的左端点，右端点和增加的值。", "outputFormat": "在每次区间加操作后输出一行一个正整数表示 `foobar` 函数的返回值。", "hint": "【数据规模与约定】\n\n| 测试点编号 | $n,q$ | 其他约定 |\n| :-----------: | :-----------: | :-----------: |\n| $1\\sim5$ | $\\le2000$ | 无 |\n| $6\\sim10$ | $\\le40000$ | 无 |\n| $11\\sim15$ | $\\le2\\times10^5$ | 保证存在一个线段树上的节点对应的区间为 $[ql,qr]$ |\n| $16\\sim20$ | $\\le2\\times10^5$ | 保证不同的 $ql,qr$ 不超过 $200$ 种 |\n| $21\\sim25$ | $\\le2\\times10^5$ | 无 |\n\n如果测试点编号 $\\bmod 5$ 为 $2$ 或 $3$，该测试点保证 $va_i=0$。\n\n如果测试点编号 $\\bmod 5$ 为 $4$ 或 $0$，该测试点保证 $vb_i=0$。\n\n对于 $100\\%$ 的数据，保证 $1\\le n,q\\le2\\times10^5$，给出的线段树和区间加操作是合法的，$0\\le va_i,vb_i,k_i<2^{32}$。", "locale": "zh-CN"}}}
{"pid": "P12490", "type": "P", "difficulty": 7, "samples": [["0\n9 3\nabacababa\n1 4\n2 4\n3 3", "3\n1\n2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["集训队互测", "2024"], "title": "[集训队互测 2024] 字符串", "background": "", "description": "给定一个长度为 $n$ 的字符串 $s[1: n]$。有 $q$ 次询问，每次询问给定两个参数 $i, r$。你需要求出有多少 $l$，满足如下条件:\n\n- $1 \\leq l \\leq r$。\n- $s[i: i+l-1]$ 字典序小于 $s[i+l: i+2l-1]$ 。", "inputFormat": "第一行包含一个整数 $c$，表示子任务编号。$c=0$ 表示该测试点为样例。\n\n第二行包含两个正整数 $n, q$，表示字符串长度和询问次数。\n\n第三行包含一个长度为 $n$ 的仅包含小写字母的字符串 $s$。\n\n接下来 $q$ 行，每行包含两个正整数 $i, r$。表示一次询问，保证 $i+2r-1 \\leq n$。", "outputFormat": "对于每一次询问，输出一行一个整数，表示满足条件的 $l$ 的个数。", "hint": "### 数据范围\n\n对于所有数据，$1 \\le n,q\\le 5\\times 10^5$，$1 \\le i + 2r - 1 \\le n $，字符串 $s$ 仅包含小写字母。\n\n子任务 1（20%）：$n,q\\le 5\\times 10^3$ 。\n\n子任务 2（10%）：$n,q\\le 10^5$ ，保证 $s$ 中每个字符在 a,b 中随机生成。\n\n子任务 3（20%）：$n,q\\le 10^5$ 。\n\n子任务 4（20%）：$n,q\\le 3\\times 10^5$ 。\n\n子任务 5（30%）：无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2024] 字符串", "background": "", "description": "给定一个长度为 $n$ 的字符串 $s[1: n]$。有 $q$ 次询问，每次询问给定两个参数 $i, r$。你需要求出有多少 $l$，满足如下条件:\n\n- $1 \\leq l \\leq r$。\n- $s[i: i+l-1]$ 字典序小于 $s[i+l: i+2l-1]$ 。", "inputFormat": "第一行包含一个整数 $c$，表示子任务编号。$c=0$ 表示该测试点为样例。\n\n第二行包含两个正整数 $n, q$，表示字符串长度和询问次数。\n\n第三行包含一个长度为 $n$ 的仅包含小写字母的字符串 $s$。\n\n接下来 $q$ 行，每行包含两个正整数 $i, r$。表示一次询问，保证 $i+2r-1 \\leq n$。", "outputFormat": "对于每一次询问，输出一行一个整数，表示满足条件的 $l$ 的个数。", "hint": "### 数据范围\n\n对于所有数据，$1 \\le n,q\\le 5\\times 10^5$，$1 \\le i + 2r - 1 \\le n $，字符串 $s$ 仅包含小写字母。\n\n子任务 1（20%）：$n,q\\le 5\\times 10^3$ 。\n\n子任务 2（10%）：$n,q\\le 10^5$ ，保证 $s$ 中每个字符在 a,b 中随机生成。\n\n子任务 3（20%）：$n,q\\le 10^5$ 。\n\n子任务 4（20%）：$n,q\\le 3\\times 10^5$ 。\n\n子任务 5（30%）：无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P12491", "type": "P", "difficulty": 6, "samples": [["10 100\n4 8\n7 6\n4 6\n5 5\n4 4\n7 4\n5 4\n8 8\n5 5\n6 4\n1 8\n1 2\n2 3\n2 6\n10 9\n4 1\n4 9\n5 7\n5 4", "25"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["点分治", "集训队互测", "2024"], "title": "[集训队互测 2024] 串联", "background": "", "description": "给定一棵树，每个点有两个权值 $a_i,b_i$。对于树上的一条简单路径，若这条路径上 $b$ 之和乘上 $a$ 的最小值大于等于一个常数 $V$，那么这条路径被称作一条好的路径。\n\n即：对于一条简单路径，设 $p_1,p_2,\\dots,p_k$ 为路径上的点。这条简单路径是好的，当且仅当 $\\min_{i=1}^k a_{p_i} \\times \\sum_{i=1}^k b_{p_i}\\ge V$。\n\n求所有好的路径中，$\\sum b$ 的最小值。", "inputFormat": "第一行两个整数 $n,V$。\n\n接下来 $n$ 行每行两个整数 $a_i,b_i$。\n\n接下来 $n−1$ 行每行两个整数 $x_i,y_i$，表示一条树边。", "outputFormat": "一行一个整数表示答案。", "hint": "### 子任务\n\n对于所有测试点均满足 $1\\leq V\\leq 10^{18},1\\leq a_i,b_i\\leq 10^9$。数据保证有解。\n\n| Subtask |    $n\\leq$    |           特殊性质           | 分值 |\n| :-----: | :-----------: | :--------------------------: | :--: |\n|   $1$   | $2\\times10^3$ |             $/$              | $15$ |\n|   $2$   |    $10^4$     |             $/$              | $15$ |\n|   $3$   | $2\\times10^5$ |    存在一个点度数为 $n-1$    | $15$ |\n|   $4$   | $2\\times10^5$ | 第 $i$ 条边连接 $i$ 和 $i+1$ | $15$ |\n|   $5$   | $5\\times10^4$ |             $/$              | $20$ |\n|   $6$   | $2\\times10^5$ |             $/$              | $20$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2024] 串联", "background": "", "description": "给定一棵树，每个点有两个权值 $a_i,b_i$。对于树上的一条简单路径，若这条路径上 $b$ 之和乘上 $a$ 的最小值大于等于一个常数 $V$，那么这条路径被称作一条好的路径。\n\n即：对于一条简单路径，设 $p_1,p_2,\\dots,p_k$ 为路径上的点。这条简单路径是好的，当且仅当 $\\min_{i=1}^k a_{p_i} \\times \\sum_{i=1}^k b_{p_i}\\ge V$。\n\n求所有好的路径中，$\\sum b$ 的最小值。", "inputFormat": "第一行两个整数 $n,V$。\n\n接下来 $n$ 行每行两个整数 $a_i,b_i$。\n\n接下来 $n−1$ 行每行两个整数 $x_i,y_i$，表示一条树边。", "outputFormat": "一行一个整数表示答案。", "hint": "### 子任务\n\n对于所有测试点均满足 $1\\leq V\\leq 10^{18},1\\leq a_i,b_i\\leq 10^9$。数据保证有解。\n\n| Subtask |    $n\\leq$    |           特殊性质           | 分值 |\n| :-----: | :-----------: | :--------------------------: | :--: |\n|   $1$   | $2\\times10^3$ |             $/$              | $15$ |\n|   $2$   |    $10^4$     |             $/$              | $15$ |\n|   $3$   | $2\\times10^5$ |    存在一个点度数为 $n-1$    | $15$ |\n|   $4$   | $2\\times10^5$ | 第 $i$ 条边连接 $i$ 和 $i+1$ | $15$ |\n|   $5$   | $5\\times10^4$ |             $/$              | $20$ |\n|   $6$   | $2\\times10^5$ |             $/$              | $20$ |", "locale": "zh-CN"}}}
{"pid": "P12492", "type": "P", "difficulty": 7, "samples": [["3 2 1 -1 1\n499122177 0 499122177", "623902721"], ["10 7 7 -2 2\n1 2 3 4 998244344", "5347454"], ["10000 6000 11451 -3 3\n1 9 1 998244325 9 8 1", "45917006"], ["120000 100000 114514 -3 3\n875253823 187452905 284279374 460346727 51435610 206896725 929067896", "206445697"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["动态规划 DP", "集训队互测", "2024", "多项式"], "title": "[集训队互测 2024] 药水", "background": "", "description": "你是一位远近闻名的大法师，你拥有一个药水店，店里有一个容量为 $k$ 单位的炼药锅。\n\n药水店一共经营了 $n$ 天，每天会发生以下的事件恰好一次：\n\n**有个初始给定的概率序列 $a_l,a_{l+1}\\dots a_r$，表示 $l\\sim r$ 被随机选中的概率，保证 $\\sum a_i=1$，然后每天会按照 $a$ 带权随机一个整数 $i$。**\n\n**如果 $i=0$，则什么也不干；**\n\n**如果 $i<0$，则有一位顾客买走了 $-i$ 单位的药水，你的锅中药水量始终不能小于 $0$；**\n\n**如果 $i>0$，则大法师向锅内加入了 $i$ 单位的药水，如果超过了锅的容量则加到满为止。**\n\n同时你还可以在每天结束时决定是否清空炼药锅。（第一天开始前视作清空过炼药锅）。\n\n药水店的顾客很挑剔，如果他们买到的药水的陈旧度超过 $m$ 天，那么他们就会生气。\n\n药水的陈旧度定义为该日炼药锅距离上一次清空过了多少天，例如，昨天结束时刚清空完炼药锅则今日药水的陈旧度为 $1$（当然，这种情况下今天开始时锅里也没有药水）。\n\n**为了维持你的名声，即使某天没有顾客来，你也要保证当天清空前锅里的药水的陈旧度不超过 $m$。**\n\n作为一位大法师，你自然不希望有顾客生气。因此对于接下来 $n$ 天的每一种情况，如果你能在预知每天发生的事件的基础下合理清空炼药锅，使得没有人生气，你就认为这种情况是好的。\n\n即，对于一个确定的事件序列 $b_1,b_2,\\dots,b_n$（$b_i$ 为第 $i$ 天随机到的整数），你认为他发生的概率是 $\\prod_{i=1}^n a_{b_i}$，且你认为他是好的当且仅当存在一种清空炼药锅的方案，使得每天锅里的药水的陈旧度都不超过 $m$，且所有顾客都买到了他需要的药水量。\n\n现在你想知道这 $n$ 天的情况有多大概率是好的，因为你不喜欢实数，所以你只想知道答案对 $998244353$ 取模的结果。\n\n**形式化题意：**\n\n给定概率序列 $a_l,a_{l+1},\\dots,a_r$，保证 $\\sum a_i=1$。\n\n考虑所有长为 $n$ 的整数序列 $b_1,b_2,\\dots,b_n$，满足 $b_i\\in [l,r]$，定义其出现概率为 $\\prod_i a_{b_i}$。\n\n定义序列 $b$ 是好的，当且仅当存在 $c_1,c_2\\dots,c_n$，满足 $c_i\\in \\{0,k\\}$，使得数列 $s_i=\\min(s_{i-1}+b_i,c_i)$ 所有元素 $\\geq 0$，且任意连续 $m$ 项都有一项为 $0$，其中 $s_0=0$。\n\n求所有好的 $b$ 序列的出现概率之和对 $998244353$ 取模的结果。", "inputFormat": "第一行输入五个整数 $n,m,k,l,r$。\n\n第二行输入 $r-l+1$ 个整数 $a'_l\\sim a'_r$，其中 $a'_i$ 表示实际的 $a_i$ 对 $998244353$ 取模的结果，保证 $\\sum a'_i \\equiv 1 \\pmod{998244353}$。", "outputFormat": "输出一行一个数，表示答案对 $998244353$ 取模的结果。", "hint": "\n| subtask |          $n$           | $r-l+1$  |       特殊性质        | 分值 |\n| :-----: | :--------------------: | :------: | :-------------------: | :--: |\n|   $1$   |       $\\leq 10$        | $\\leq 7$ |          无           | $10$ |\n|   $2$   |       $\\leq 100$       | $\\leq 7$ |          无           | $10$ |\n|   $3$   |      $\\leq 10^4$       | $\\leq 7$ |          无           | $20$ |\n|   $4$   | $\\leq 1.2\\times 10^5$  | $\\leq 3$ | $a'_{-1}=a'_1,a'_0=0$ | $15$ |\n|   $5$   | $\\leq 1.2\\times 10^5$  | $\\leq 3$ |          无           | $10$ |\n|   $6$   |  $\\leq 6\\times 10^4$   | $\\leq 5$ |          无           | $15$ |\n|   $7$   | $\\leq 1.2 \\times 10^5$ | $\\leq 7$ |          无           | $20$ |\n\n对于所有数据：$1\\leq m\\leq n \\leq 1.2\\times10^5$，$1\\leq k \\leq 10^6$，$-3\\leq l < 0 < r \\leq 3$，$a'_i \\in [0,998244353)$，$a'_l,a'_r>0$，$\\sum a'_i\\equiv 1 \\pmod{998244353}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2024] 药水", "background": "", "description": "你是一位远近闻名的大法师，你拥有一个药水店，店里有一个容量为 $k$ 单位的炼药锅。\n\n药水店一共经营了 $n$ 天，每天会发生以下的事件恰好一次：\n\n**有个初始给定的概率序列 $a_l,a_{l+1}\\dots a_r$，表示 $l\\sim r$ 被随机选中的概率，保证 $\\sum a_i=1$，然后每天会按照 $a$ 带权随机一个整数 $i$。**\n\n**如果 $i=0$，则什么也不干；**\n\n**如果 $i<0$，则有一位顾客买走了 $-i$ 单位的药水，你的锅中药水量始终不能小于 $0$；**\n\n**如果 $i>0$，则大法师向锅内加入了 $i$ 单位的药水，如果超过了锅的容量则加到满为止。**\n\n同时你还可以在每天结束时决定是否清空炼药锅。（第一天开始前视作清空过炼药锅）。\n\n药水店的顾客很挑剔，如果他们买到的药水的陈旧度超过 $m$ 天，那么他们就会生气。\n\n药水的陈旧度定义为该日炼药锅距离上一次清空过了多少天，例如，昨天结束时刚清空完炼药锅则今日药水的陈旧度为 $1$（当然，这种情况下今天开始时锅里也没有药水）。\n\n**为了维持你的名声，即使某天没有顾客来，你也要保证当天清空前锅里的药水的陈旧度不超过 $m$。**\n\n作为一位大法师，你自然不希望有顾客生气。因此对于接下来 $n$ 天的每一种情况，如果你能在预知每天发生的事件的基础下合理清空炼药锅，使得没有人生气，你就认为这种情况是好的。\n\n即，对于一个确定的事件序列 $b_1,b_2,\\dots,b_n$（$b_i$ 为第 $i$ 天随机到的整数），你认为他发生的概率是 $\\prod_{i=1}^n a_{b_i}$，且你认为他是好的当且仅当存在一种清空炼药锅的方案，使得每天锅里的药水的陈旧度都不超过 $m$，且所有顾客都买到了他需要的药水量。\n\n现在你想知道这 $n$ 天的情况有多大概率是好的，因为你不喜欢实数，所以你只想知道答案对 $998244353$ 取模的结果。\n\n**形式化题意：**\n\n给定概率序列 $a_l,a_{l+1},\\dots,a_r$，保证 $\\sum a_i=1$。\n\n考虑所有长为 $n$ 的整数序列 $b_1,b_2,\\dots,b_n$，满足 $b_i\\in [l,r]$，定义其出现概率为 $\\prod_i a_{b_i}$。\n\n定义序列 $b$ 是好的，当且仅当存在 $c_1,c_2\\dots,c_n$，满足 $c_i\\in \\{0,k\\}$，使得数列 $s_i=\\min(s_{i-1}+b_i,c_i)$ 所有元素 $\\geq 0$，且任意连续 $m$ 项都有一项为 $0$，其中 $s_0=0$。\n\n求所有好的 $b$ 序列的出现概率之和对 $998244353$ 取模的结果。", "inputFormat": "第一行输入五个整数 $n,m,k,l,r$。\n\n第二行输入 $r-l+1$ 个整数 $a'_l\\sim a'_r$，其中 $a'_i$ 表示实际的 $a_i$ 对 $998244353$ 取模的结果，保证 $\\sum a'_i \\equiv 1 \\pmod{998244353}$。", "outputFormat": "输出一行一个数，表示答案对 $998244353$ 取模的结果。", "hint": "\n| subtask |          $n$           | $r-l+1$  |       特殊性质        | 分值 |\n| :-----: | :--------------------: | :------: | :-------------------: | :--: |\n|   $1$   |       $\\leq 10$        | $\\leq 7$ |          无           | $10$ |\n|   $2$   |       $\\leq 100$       | $\\leq 7$ |          无           | $10$ |\n|   $3$   |      $\\leq 10^4$       | $\\leq 7$ |          无           | $20$ |\n|   $4$   | $\\leq 1.2\\times 10^5$  | $\\leq 3$ | $a'_{-1}=a'_1,a'_0=0$ | $15$ |\n|   $5$   | $\\leq 1.2\\times 10^5$  | $\\leq 3$ |          无           | $10$ |\n|   $6$   |  $\\leq 6\\times 10^4$   | $\\leq 5$ |          无           | $15$ |\n|   $7$   | $\\leq 1.2 \\times 10^5$ | $\\leq 7$ |          无           | $20$ |\n\n对于所有数据：$1\\leq m\\leq n \\leq 1.2\\times10^5$，$1\\leq k \\leq 10^6$，$-3\\leq l < 0 < r \\leq 3$，$a'_i \\in [0,998244353)$，$a'_l,a'_r>0$，$\\sum a'_i\\equiv 1 \\pmod{998244353}$。", "locale": "zh-CN"}}}
{"pid": "P12493", "type": "P", "difficulty": 7, "samples": [["6 10 5\n2 3\n7 1\n1 4\n8 1\n2 5\n8 9\n1 2 3 4\n1 1 2 2\n1 1 5 5\n1 3 4 6\n1 5 6 6", "33\n9\n11\n80\n37"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["集训队互测", "2024", "分治"], "title": "[集训队互测 2024] 子集和", "background": "", "description": "有 $n$ 个物品，物品 $i$ 有两个属性 $a_i,b_i$。对于一个物品集合 $S$，定义 $f(S)$ 是如下问题的答案：\n\n> 对于每个物品 $i\\in S$，选择 $0,a_i,b_i$ 三个数中的一个，使得所有物品选择的数之和是 $m$ 的倍数的方案数。\n\n定义物品集合 $S=\\{1,2,\\dots,n\\}$。有 $q$ 次询问，每次给定四个正整数 $1\\le l_1\\le r_1<l_2\\le r_2\\le n$，求：\n\n$$\n\\sum_{l_1\\le i\\le r_1} \\sum_{l_2\\le j\\le r_2} f(S\\setminus \\{i,j\\}).\n$$\n\n答案对 $10^9+7$ 取模。", "inputFormat": "第一行，三个正整数 $n,m,q$。\n\n接下来 $n$ 行，每行两个非负整数 $a_i,b_i$。\n\n接下来 $q$ 行，每行四个正整数 $l_1,r_1,l_2,r_2$，表示一次询问。", "outputFormat": "$q$ 行，每行一个非负整数，表示答案对 $10^9+7$ 取模后的值。", "hint": "### 数据范围\n\n对于所有数据：\n\n- $1\\le n\\le 10^4$\n- $2\\le m\\le 200$\n- $1\\le q\\le 10^6$\n- $0\\le a_i,b_i<m\\ (1\\le i\\le n)$\n\n| 子任务 | $n\\le$ | $m\\le$ | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $100$ | —  | AB | $5$ |\n| $2$ | $500$ | —  | AB | $5$ |\n| $3$ | — | $20$ | AB | $20$ |\n| $4$ | — | $150$ | A | $15$ |\n| $5$ | — | — | B | $15$ |\n| $6$ | — | — | C | $10$ |\n| $7$ | — | — | $l_1=r_1,l_2=r_2$ | $5$ |\n| $8$ | — | — | — | $25$ |\n\n特殊性质 A：每次询问都在所有满足条件的 $(l_1,r_1,l_2,r_2)$ 中随机选择。\n\n特殊性质 B：$q\\le 10^5$。\n\n特殊性质 C：对于每个物品 $i$，$a_i=b_i$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2024] 子集和", "background": "", "description": "有 $n$ 个物品，物品 $i$ 有两个属性 $a_i,b_i$。对于一个物品集合 $S$，定义 $f(S)$ 是如下问题的答案：\n\n> 对于每个物品 $i\\in S$，选择 $0,a_i,b_i$ 三个数中的一个，使得所有物品选择的数之和是 $m$ 的倍数的方案数。\n\n定义物品集合 $S=\\{1,2,\\dots,n\\}$。有 $q$ 次询问，每次给定四个正整数 $1\\le l_1\\le r_1<l_2\\le r_2\\le n$，求：\n\n$$\n\\sum_{l_1\\le i\\le r_1} \\sum_{l_2\\le j\\le r_2} f(S\\setminus \\{i,j\\}).\n$$\n\n答案对 $10^9+7$ 取模。", "inputFormat": "第一行，三个正整数 $n,m,q$。\n\n接下来 $n$ 行，每行两个非负整数 $a_i,b_i$。\n\n接下来 $q$ 行，每行四个正整数 $l_1,r_1,l_2,r_2$，表示一次询问。", "outputFormat": "$q$ 行，每行一个非负整数，表示答案对 $10^9+7$ 取模后的值。", "hint": "### 数据范围\n\n对于所有数据：\n\n- $1\\le n\\le 10^4$\n- $2\\le m\\le 200$\n- $1\\le q\\le 10^6$\n- $0\\le a_i,b_i<m\\ (1\\le i\\le n)$\n\n| 子任务 | $n\\le$ | $m\\le$ | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $100$ | —  | AB | $5$ |\n| $2$ | $500$ | —  | AB | $5$ |\n| $3$ | — | $20$ | AB | $20$ |\n| $4$ | — | $150$ | A | $15$ |\n| $5$ | — | — | B | $15$ |\n| $6$ | — | — | C | $10$ |\n| $7$ | — | — | $l_1=r_1,l_2=r_2$ | $5$ |\n| $8$ | — | — | — | $25$ |\n\n特殊性质 A：每次询问都在所有满足条件的 $(l_1,r_1,l_2,r_2)$ 中随机选择。\n\n特殊性质 B：$q\\le 10^5$。\n\n特殊性质 C：对于每个物品 $i$，$a_i=b_i$。", "locale": "zh-CN"}}}
{"pid": "P12494", "type": "P", "difficulty": 7, "samples": [["3 1 2\nOA\n0\n1", "8\n3"], ["4 2 2\nXOA\n1\n2", "189\n112"], ["4 2 3\nXAO\n1\n2\n3", "237\n176\n143"], ["10 10 3\nAOOXOAOXA\n749\n666\n135", "4239261913\n1948492800\n2799056799"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["集训队互测", "2024", "O2优化"], "title": "[集训队互测 2024] 数位 DP", "background": "小 L 曾经出了这样一个题：\n\n> 给定长度为 $4$ 的整数序列 $c$，求是否存在长度为 $4$ 的整数序列 $a$ 满足 $0\\le a_i\\le c_i$ 且 $(((a_1\\text{ and }a_2)\\text{ xor }a_3)\\text{ or }a_4=m$。\n\n小 C 看到后觉得这个数位 DP 题非常板，很没意思。小 L 又修改上述问题的位运算的顺序，出了很多个题。\n\n小 C 忍不了了：“你能不能别再出模板数位 DP 题了？”\n\n小 L 只能把这一堆题交给了你。不过为了增加挑战性，现在你需要对所有可能的 $c_i$ 计算出答案并求和。", "description": "给定长度为 $n-1$ 的字符串 $s$，对于一个长度为 $n$ 的非负整数序列 $a$，定义其生成序列 $b$ 为：\n\n- $b_1=a_1$；\n- 对于 $i>1$：\n  - 若 $s_{i-1}=\\verb!A!$，则 $b_i=b_{i-1}\\text{ and }a_i$。\n   - 若 $s_{i-1}=\\verb!O!$，则 $b_i=b_{i-1}\\text{ or }a_i$。\n   - 若 $s_{i-1}=\\verb!X!$，则 $b_i=b_{i-1}\\text{ xor }a_i$。\n\n给定非负整数 $k$。接下来 $q$ 组询问，每次给定一个 $m$，求有多少长度为 $n$ 的整数序列 $c$ 满足：\n\n- 对于 $1\\le i\\le n$，满足 $0\\le c_i<2^k$。\n- 存在至少一个长度为 $n$ 的整数序列 $a$ 满足：\n  - 对于 $1\\le i\\le n$，满足 $0\\le a_i\\le c_i$。\n   - 对于 $a$ 的生成序列 $b$，满足 $b_n=m$。\n\n由于答案很大，你只需要输出答案对 $2^{32}$ 取模的结果。", "inputFormat": "第一行三个整数 $n,k,q$。\n\n第二行一个长度为 $n-1$ 的字符串 $s$。\n\n接下来 $q$ 行，每行一个询问的 $m$。", "outputFormat": "输出 $q$ 行，每行一个非负整数，表示答案对 $2^{32}$ 取模的结果。", "hint": "**本题使用捆绑测试，你只有通过一个子任务的所有测试点，才能获得这个子任务的分数**。\n\n| 子任务编号 | $n\\le$ | $k\\le$ | $q\\le$ |          特殊性质          | 分值 |\n| :--------: | :----: | :----: | :----: | :------------------------: | :--: |\n|    $1$     |  $4$   |  $5$   | $200$  |             无             | $10$ |\n|    $2$     |  $20$  |  $8$   |  $20$  |             无             | $10$ |\n|    $3$     | $200$  |  $16$  |  $1$   |             无             | $10$ |\n|    $4$     | $200$  |  $16$  | $200$  |             无             | $10$ |\n|    $5$     | $200$  |  $30$  |  $1$   | $\\text{popcount}(m)\\le 16$ | $10$ |\n|    $6$     | $1000$ |  $30$  | $1000$ |   $s$ 不包含 $\\verb!A!$    | $10$ |\n|    $7$     |  $50$  |  $30$  |  $50$  |             无             | $10$ |\n|    $8$     | $1000$ |  $30$  |  $1$   |             无             | $10$ |\n|    $9$     | $200$  |  $30$  | $200$  |             无             | $10$ |\n|    $10$    | $1000$ |  $30$  | $1000$ |             无             | $10$ |\n\n对于 $100\\%$ 的数据，$2\\le n\\le 1000$，$1\\le q\\le 1000$，$1\\le k\\le 30$，$0\\le m<2^k$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2024] 数位 DP", "background": "小 L 曾经出了这样一个题：\n\n> 给定长度为 $4$ 的整数序列 $c$，求是否存在长度为 $4$ 的整数序列 $a$ 满足 $0\\le a_i\\le c_i$ 且 $(((a_1\\text{ and }a_2)\\text{ xor }a_3)\\text{ or }a_4=m$。\n\n小 C 看到后觉得这个数位 DP 题非常板，很没意思。小 L 又修改上述问题的位运算的顺序，出了很多个题。\n\n小 C 忍不了了：“你能不能别再出模板数位 DP 题了？”\n\n小 L 只能把这一堆题交给了你。不过为了增加挑战性，现在你需要对所有可能的 $c_i$ 计算出答案并求和。", "description": "给定长度为 $n-1$ 的字符串 $s$，对于一个长度为 $n$ 的非负整数序列 $a$，定义其生成序列 $b$ 为：\n\n- $b_1=a_1$；\n- 对于 $i>1$：\n  - 若 $s_{i-1}=\\verb!A!$，则 $b_i=b_{i-1}\\text{ and }a_i$。\n   - 若 $s_{i-1}=\\verb!O!$，则 $b_i=b_{i-1}\\text{ or }a_i$。\n   - 若 $s_{i-1}=\\verb!X!$，则 $b_i=b_{i-1}\\text{ xor }a_i$。\n\n给定非负整数 $k$。接下来 $q$ 组询问，每次给定一个 $m$，求有多少长度为 $n$ 的整数序列 $c$ 满足：\n\n- 对于 $1\\le i\\le n$，满足 $0\\le c_i<2^k$。\n- 存在至少一个长度为 $n$ 的整数序列 $a$ 满足：\n  - 对于 $1\\le i\\le n$，满足 $0\\le a_i\\le c_i$。\n   - 对于 $a$ 的生成序列 $b$，满足 $b_n=m$。\n\n由于答案很大，你只需要输出答案对 $2^{32}$ 取模的结果。", "inputFormat": "第一行三个整数 $n,k,q$。\n\n第二行一个长度为 $n-1$ 的字符串 $s$。\n\n接下来 $q$ 行，每行一个询问的 $m$。", "outputFormat": "输出 $q$ 行，每行一个非负整数，表示答案对 $2^{32}$ 取模的结果。", "hint": "**本题使用捆绑测试，你只有通过一个子任务的所有测试点，才能获得这个子任务的分数**。\n\n| 子任务编号 | $n\\le$ | $k\\le$ | $q\\le$ |          特殊性质          | 分值 |\n| :--------: | :----: | :----: | :----: | :------------------------: | :--: |\n|    $1$     |  $4$   |  $5$   | $200$  |             无             | $10$ |\n|    $2$     |  $20$  |  $8$   |  $20$  |             无             | $10$ |\n|    $3$     | $200$  |  $16$  |  $1$   |             无             | $10$ |\n|    $4$     | $200$  |  $16$  | $200$  |             无             | $10$ |\n|    $5$     | $200$  |  $30$  |  $1$   | $\\text{popcount}(m)\\le 16$ | $10$ |\n|    $6$     | $1000$ |  $30$  | $1000$ |   $s$ 不包含 $\\verb!A!$    | $10$ |\n|    $7$     |  $50$  |  $30$  |  $50$  |             无             | $10$ |\n|    $8$     | $1000$ |  $30$  |  $1$   |             无             | $10$ |\n|    $9$     | $200$  |  $30$  | $200$  |             无             | $10$ |\n|    $10$    | $1000$ |  $30$  | $1000$ |             无             | $10$ |\n\n对于 $100\\%$ 的数据，$2\\le n\\le 1000$，$1\\le q\\le 1000$，$1\\le k\\le 30$，$0\\le m<2^k$。", "locale": "zh-CN"}}}
{"pid": "P12495", "type": "P", "difficulty": 7, "samples": [["2 998244353", "0 1 \n0 1"], ["3 998244353", "0 1 2 \n0 0 3 \n0 0 3"], ["4 998244353", "0 1 9 6 \n0 0 1 15 \n0 0 0 16 \n0 0 0 16"], ["5 998244353", "0 1 40 60 24 \n0 0 1 28 96 \n0 0 0 1 124 \n0 0 0 0 125 \n0 0 0 0 125"], ["6 998244353", "0 1 195 560 420 120 \n0 0 1 75 500 720 \n0 0 0 1 75 1220 \n0 0 0 0 1 1295 \n0 0 0 0 0 1296 \n0 0 0 0 0 1296"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["动态规划 DP", "集训队互测", "2024", "O2优化", "动态规划优化"], "title": "[集训队互测 2024] 链覆盖", "background": "你的学弟向你请教这样一道题：\n\n- 给定一颗 $n$ 个点的有根树，初始所有点均为白色。\n\n- 你可以执行不超过 $k$ 次操作，每次操作为选定一个点，把它到根简单路径上的所有点涂成黑色。\n\n-  求你最终最多能涂黑多少点。对 $k=1 \\sim n$ 分别求解。\n这当然不是什么难题，你很快向学弟解释清楚了这应该怎么做，他惊叹于做法的巧妙，然后满意地离开了。\n\n你看着他离去的身影，想起两三年前，你第一次得知这道题怎么做时，也曾为这道题的解法赞叹过。但对于现在的你来说，这也并没有什么神奇之处，只是一个平凡的套路罢了。\n\n但熟知的原题与结论并不一定真的就乏味无趣、无甚可观，这样想着，你记录下了这道题：", "description": "- 给定一颗 $n$ 个点的有根树，初始所有点均为白色。\n\n- 你可以执行不超过 $k$ 次操作，每次操作为选定一个点，把它到根简单路径上的所有点涂成黑色。\n\n-  求你最终最多能涂黑多少点。对 $k=1 \\sim n$ 分别求解。\n\n记对于有标号有根树 $T$，上述问题在 $k=i$ 时的答案为 $ans(T,i)$。\n\n给定 $n,mod$，对所有 $1 \\le k \\le n,1 \\le m \\le n$，计算有多少不同的 $n$ 个点以 $1$ 为根的有标号树 $T$ 满足 $ans(T,k)=m$。答案对 $mod$ 取模。\n\n两颗有标号以 $1$ 为根的树被认为是不同的，当且仅当它们的边集不同。", "inputFormat": "一行两个整数 $n,mod$。", "outputFormat": "输出 $n$ 行每行 $n$ 个整数，第 $k$ 行的第 $m$ 个整数表示满足 $ans(T,k)=m$ 的不同的 $n$ 个点以 $1$ 为根的有标号树 $T$ 的数量对 $mod$ 取模的结果。", "hint": "本题使用捆绑测试，你只有通过一个子任务的所有测试点，才能获得这个子任务的分数。\n\n| Subtask | $n \\le$ | 分值 |\n| :-----: | :-----: |  :--: |\n|   $1$   |   $5$   |  $1$  |\n|   $2$   |  $10$   | $9$ |\n|   $3$   |  $20$  |   $10$ |\n|   $4$   |  $32$  | $15$ |\n|   $5$   | $40$  | $5$ |\n|   $6$   | $50$  | $15$ |\n|   $7$   | $65$  |  $5$ |\n|   $8$   | $80$  |  $5$ |\n|   $9$   | $120$ |  $15$ |\n|   $10$   | $300$  |  $20$ |\n\n对于所有数据：$1 \\le n \\le 300$，$10^8 \\le mod \\le 1.05 \\times 10^9$，保证 $mod$ 是质数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2024] 链覆盖", "background": "你的学弟向你请教这样一道题：\n\n- 给定一颗 $n$ 个点的有根树，初始所有点均为白色。\n\n- 你可以执行不超过 $k$ 次操作，每次操作为选定一个点，把它到根简单路径上的所有点涂成黑色。\n\n-  求你最终最多能涂黑多少点。对 $k=1 \\sim n$ 分别求解。\n这当然不是什么难题，你很快向学弟解释清楚了这应该怎么做，他惊叹于做法的巧妙，然后满意地离开了。\n\n你看着他离去的身影，想起两三年前，你第一次得知这道题怎么做时，也曾为这道题的解法赞叹过。但对于现在的你来说，这也并没有什么神奇之处，只是一个平凡的套路罢了。\n\n但熟知的原题与结论并不一定真的就乏味无趣、无甚可观，这样想着，你记录下了这道题：", "description": "- 给定一颗 $n$ 个点的有根树，初始所有点均为白色。\n\n- 你可以执行不超过 $k$ 次操作，每次操作为选定一个点，把它到根简单路径上的所有点涂成黑色。\n\n-  求你最终最多能涂黑多少点。对 $k=1 \\sim n$ 分别求解。\n\n记对于有标号有根树 $T$，上述问题在 $k=i$ 时的答案为 $ans(T,i)$。\n\n给定 $n,mod$，对所有 $1 \\le k \\le n,1 \\le m \\le n$，计算有多少不同的 $n$ 个点以 $1$ 为根的有标号树 $T$ 满足 $ans(T,k)=m$。答案对 $mod$ 取模。\n\n两颗有标号以 $1$ 为根的树被认为是不同的，当且仅当它们的边集不同。", "inputFormat": "一行两个整数 $n,mod$。", "outputFormat": "输出 $n$ 行每行 $n$ 个整数，第 $k$ 行的第 $m$ 个整数表示满足 $ans(T,k)=m$ 的不同的 $n$ 个点以 $1$ 为根的有标号树 $T$ 的数量对 $mod$ 取模的结果。", "hint": "本题使用捆绑测试，你只有通过一个子任务的所有测试点，才能获得这个子任务的分数。\n\n| Subtask | $n \\le$ | 分值 |\n| :-----: | :-----: |  :--: |\n|   $1$   |   $5$   |  $1$  |\n|   $2$   |  $10$   | $9$ |\n|   $3$   |  $20$  |   $10$ |\n|   $4$   |  $32$  | $15$ |\n|   $5$   | $40$  | $5$ |\n|   $6$   | $50$  | $15$ |\n|   $7$   | $65$  |  $5$ |\n|   $8$   | $80$  |  $5$ |\n|   $9$   | $120$ |  $15$ |\n|   $10$   | $300$  |  $20$ |\n\n对于所有数据：$1 \\le n \\le 300$，$10^8 \\le mod \\le 1.05 \\times 10^9$，保证 $mod$ 是质数。", "locale": "zh-CN"}}}
{"pid": "P12496", "type": "P", "difficulty": 7, "samples": [["3 2\n1 2", "13"], ["5 3\n1 2 3 4", "1875"], ["6 4\n1 2 3 4 5 6 7 8", "68850"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["集训队互测", "2024", "多项式", "O2优化", "快速数论变换 NTT"], "title": "[集训队互测 2024] 又一个欧拉数问题", "background": "", "description": "给定 $k$ 以及系数序列 $w_0 \\sim w_{2^{k-1}-1}$。\n\n\n定义一个 $n \\ge k$ 阶排列 $p$ 的权值 $val(p)=\\prod\\limits_{i=1}^{n-k+1} w_{f(p_i,p_{i+1}...p_{i+k-1})}$，其中 $f(a_1,a_2...a_k)=\\sum\\limits_{i=1}^{k-1}2^{i-1}[a_i<a_{i+1}]$。\n\n给定 $n$，计算所有 $n$ 阶排列的权值和，答案对 $998244353$ 取模。", "inputFormat": "第一行两个整数 $n,k$。\n\n第二行 $2^{k-1}$ 个整数，第 $i$ 个整数表示 $w_{i-1}$。", "outputFormat": "一行一个整数，表示答案 $\\bmod\\ 998244353$。", "hint": "本题使用捆绑测试，你只有通过一个子任务的所有测试点，才能获得这个子任务的分数。\n\n| Subtask | $n \\le$ | $k=$ | 分值 |\n| :-----: | :-----: |  :-----: | :--: |\n|   $1$   |   $10$   |  $4$ | $5$  |\n|   $2$   |  $20$   |  $4$ | $10$ |\n|   $3$   |  $10^5$  |   $2$ | $5$ |\n|   $4$   |  $100$  | $3$ | $10$ |\n|   $5$   | $4000$  | $3$ | $10$ |\n|   $6$   | $4 \\times 10^4$  | $3$ | $15$ |\n|   $7$   | $10^5$  |  $3$ | $5$ |\n|   $8$   | $2000$  |   $4$ | $10$ |\n|   $9$   | $4 \\times 10^4$  |  $4$ |  $10$ |\n|   $10$   | $10^5$  |  $4$ | $20$ |\n\n对于所有数据：$2 \\le k \\le 4$，$k \\le n \\le 10^5$，$0 \\le w_i < 998244353$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[集训队互测 2024] 又一个欧拉数问题", "background": "", "description": "给定 $k$ 以及系数序列 $w_0 \\sim w_{2^{k-1}-1}$。\n\n\n定义一个 $n \\ge k$ 阶排列 $p$ 的权值 $val(p)=\\prod\\limits_{i=1}^{n-k+1} w_{f(p_i,p_{i+1}...p_{i+k-1})}$，其中 $f(a_1,a_2...a_k)=\\sum\\limits_{i=1}^{k-1}2^{i-1}[a_i<a_{i+1}]$。\n\n给定 $n$，计算所有 $n$ 阶排列的权值和，答案对 $998244353$ 取模。", "inputFormat": "第一行两个整数 $n,k$。\n\n第二行 $2^{k-1}$ 个整数，第 $i$ 个整数表示 $w_{i-1}$。", "outputFormat": "一行一个整数，表示答案 $\\bmod\\ 998244353$。", "hint": "本题使用捆绑测试，你只有通过一个子任务的所有测试点，才能获得这个子任务的分数。\n\n| Subtask | $n \\le$ | $k=$ | 分值 |\n| :-----: | :-----: |  :-----: | :--: |\n|   $1$   |   $10$   |  $4$ | $5$  |\n|   $2$   |  $20$   |  $4$ | $10$ |\n|   $3$   |  $10^5$  |   $2$ | $5$ |\n|   $4$   |  $100$  | $3$ | $10$ |\n|   $5$   | $4000$  | $3$ | $10$ |\n|   $6$   | $4 \\times 10^4$  | $3$ | $15$ |\n|   $7$   | $10^5$  |  $3$ | $5$ |\n|   $8$   | $2000$  |   $4$ | $10$ |\n|   $9$   | $4 \\times 10^4$  |  $4$ |  $10$ |\n|   $10$   | $10^5$  |  $4$ | $20$ |\n\n对于所有数据：$2 \\le k \\le 4$，$k \\le n \\le 10^5$，$0 \\le w_i < 998244353$。", "locale": "zh-CN"}}}
{"pid": "P12497", "type": "P", "difficulty": 3, "samples": [["6\n1\n2\n3\n4\n5\n6", "-1\n()\n-1\n()()\n-1\n()(())\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["Special Judge", "O2优化", "构造", "洛谷比赛"], "title": "「DLESS-1」回文括号序列", "background": "小 A 非常喜欢回文串与括号序列，但是一天，小 B 告诉了他一个绝望的事实：不存在回文的非空合法括号序列。", "description": "小 A 定义一个括号序列 $S$ 的权值为 $f(S)=\\sum_{i=1}^{\\lvert S\\rvert}[S_i=S_{\\lvert S\\rvert-i+1}]$（字符串下标从 $1$ 开始），即 $S$ 与翻转后的 $S$ 括号相同的位置数。\n\n给定 $n$，你需要构造出一个长度为 $n$ 的合法括号序列 $S$，最大化它的权值 $f(S)$。如果不存在长度为 $n$ 的合法括号序列，输出 $-1$。", "inputFormat": "本题每个测试点内含多组数据。\n\n第一行一个正整数 $T$ 代表数据组数。对于每组测试数据，输入一行一个正整数 $n$。", "outputFormat": "对于每组测试数据，输入一行一个括号序列 $S$ 表示你构造的答案。特别地，如果不存在长度为 $n$ 的合法括号序列，输出 $-1$。", "hint": "#### 【样例解释】\n\n对于 $n=6$，`()(())` 的权值为 $4$，可以证明不存在权值更大的满足条件的括号序列。\n\n#### 【数据范围】\n\n记 $\\sum n$ 为单测试点内每组测试数据 $n$ 之和。\n\n对于所有数据，$1\\le T,n\\le 10^5$，$1\\le\\sum n\\le 10^6$。\n\n**本题开启子任务捆绑测试。**\n\n- Subtask 1（5 pts）：$n\\le 8$，$\\sum n\\le 36$。\n- Subtask 2（20 pts）： $n\\le 20$，$\\sum n\\le155$。\n- Subtask 3（25 pts）：$n\\le 100$，$\\sum n\\le 500$。\n- Subtask 4（20 pts）：$n\\le 10^3$，$\\sum n\\le 10^4$。\n- Subtask 5（30 pts）：无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DLESS-1」回文括号序列", "background": "小 A 非常喜欢回文串与括号序列，但是一天，小 B 告诉了他一个绝望的事实：不存在回文的非空合法括号序列。", "description": "小 A 定义一个括号序列 $S$ 的权值为 $f(S)=\\sum_{i=1}^{\\lvert S\\rvert}[S_i=S_{\\lvert S\\rvert-i+1}]$（字符串下标从 $1$ 开始），即 $S$ 与翻转后的 $S$ 括号相同的位置数。\n\n给定 $n$，你需要构造出一个长度为 $n$ 的合法括号序列 $S$，最大化它的权值 $f(S)$。如果不存在长度为 $n$ 的合法括号序列，输出 $-1$。", "inputFormat": "本题每个测试点内含多组数据。\n\n第一行一个正整数 $T$ 代表数据组数。对于每组测试数据，输入一行一个正整数 $n$。", "outputFormat": "对于每组测试数据，输入一行一个括号序列 $S$ 表示你构造的答案。特别地，如果不存在长度为 $n$ 的合法括号序列，输出 $-1$。", "hint": "#### 【样例解释】\n\n对于 $n=6$，`()(())` 的权值为 $4$，可以证明不存在权值更大的满足条件的括号序列。\n\n#### 【数据范围】\n\n记 $\\sum n$ 为单测试点内每组测试数据 $n$ 之和。\n\n对于所有数据，$1\\le T,n\\le 10^5$，$1\\le\\sum n\\le 10^6$。\n\n**本题开启子任务捆绑测试。**\n\n- Subtask 1（5 pts）：$n\\le 8$，$\\sum n\\le 36$。\n- Subtask 2（20 pts）： $n\\le 20$，$\\sum n\\le155$。\n- Subtask 3（25 pts）：$n\\le 100$，$\\sum n\\le 500$。\n- Subtask 4（20 pts）：$n\\le 10^3$，$\\sum n\\le 10^4$。\n- Subtask 5（30 pts）：无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P12498", "type": "P", "difficulty": 5, "samples": [["5\n3\n1 -1 2\n7\n1 -2 -3 4 5 -6 -7\n7\n-1 2 3 -4 -5 6 7\n4\n1 1 2 3\n5\n1 4 -5 -2 6", "1\n31\n31\n4\n11"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "差分", "单调栈", "洛谷比赛"], "title": "「DLESS-1」Range | Sum | Maximum", "background": "", "description": "给出一个长度为 $n$ 的序列 $a$，定义一个区间 $[l,r]$ 的权值为 $\\max_{l\\le L\\le R\\le r}|\\sum_{i=L}^Ra_i|$。\n\n对于 $k=1,2,3,\\dots,n$，求所有长度为 $k$ 的区间权值和。", "inputFormat": "本题有多组测试数据，第一行输入一个正整数 $T$，代表数据组数。\n\n对于每组数据，第一行输入一个正整数 $n$。\n\n第二行输入 $n$ 个整数，代表序列 $a$。", "outputFormat": "为了避免输出量过大，设长度为 $k$ 的区间权值和为 $ans_k$，对于每组测试数据，你只需要输出：\n\n$$\\bigoplus_{i=1}^nans_i\\bmod i^2$$\n\n（其中 $\\oplus$ 表示按位异或运算）\n\n正解做法不依赖于该输出方式。", "hint": "#### 【样例解释】\n\n样例中五组数据的 $ans$ 分别为：\n- $\\{4,3,2\\}$\n- $\\{28,39,41,36,31,22,13\\}$\n- $\\{28,39,41,36,31,22,13\\}$\n- $\\{7,10,10,7\\}$\n- $\\{18,23,19,14,7\\}$\n\n其中，对于第一组数据，各个区间的权值分别如下：\n\n- $[1,1]:1$\n- $[2,2]:1$\n- $[3,3]:2$\n- $[1,2]:1$\n- $[2,3]:2$\n- $[1,3]:2$\n\n其中，长度为 $1$ 的区间有 $[1,1],[2,2],[3,3]$，权值和为 $4$；长度为 $2$ 的区间有 $[1,2],[2,3]$，权值和为 $3$；长度为 $3$ 的区间有 $[1,3]$，权值和为 $2$。\n\n#### 【数据范围】\n\n对于所有数据，保证：\n- $1\\le T\\le10^4$\n- $1\\le n,\\sum n\\le10^6$\n- $-10^6\\le a_i\\le10^6$\n\n**本题采用打包测试**，各测试包描述如下：\n\n| Subtask | $\\sum n\\le$ | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $500$ | 无 | $5$ |\n| $2$ | $5000$ | 无 | $20$ |\n| $3$ | $10^6$ | $a_i\\ge 0$ | $25$ |\n| $4$ | $3\\times10^5$ | 无 | $25$ |\n| $5$ | $10^6$ | 无 | $25$ |\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DLESS-1」Range | Sum | Maximum", "background": "", "description": "给出一个长度为 $n$ 的序列 $a$，定义一个区间 $[l,r]$ 的权值为 $\\max_{l\\le L\\le R\\le r}|\\sum_{i=L}^Ra_i|$。\n\n对于 $k=1,2,3,\\dots,n$，求所有长度为 $k$ 的区间权值和。", "inputFormat": "本题有多组测试数据，第一行输入一个正整数 $T$，代表数据组数。\n\n对于每组数据，第一行输入一个正整数 $n$。\n\n第二行输入 $n$ 个整数，代表序列 $a$。", "outputFormat": "为了避免输出量过大，设长度为 $k$ 的区间权值和为 $ans_k$，对于每组测试数据，你只需要输出：\n\n$$\\bigoplus_{i=1}^nans_i\\bmod i^2$$\n\n（其中 $\\oplus$ 表示按位异或运算）\n\n正解做法不依赖于该输出方式。", "hint": "#### 【样例解释】\n\n样例中五组数据的 $ans$ 分别为：\n- $\\{4,3,2\\}$\n- $\\{28,39,41,36,31,22,13\\}$\n- $\\{28,39,41,36,31,22,13\\}$\n- $\\{7,10,10,7\\}$\n- $\\{18,23,19,14,7\\}$\n\n其中，对于第一组数据，各个区间的权值分别如下：\n\n- $[1,1]:1$\n- $[2,2]:1$\n- $[3,3]:2$\n- $[1,2]:1$\n- $[2,3]:2$\n- $[1,3]:2$\n\n其中，长度为 $1$ 的区间有 $[1,1],[2,2],[3,3]$，权值和为 $4$；长度为 $2$ 的区间有 $[1,2],[2,3]$，权值和为 $3$；长度为 $3$ 的区间有 $[1,3]$，权值和为 $2$。\n\n#### 【数据范围】\n\n对于所有数据，保证：\n- $1\\le T\\le10^4$\n- $1\\le n,\\sum n\\le10^6$\n- $-10^6\\le a_i\\le10^6$\n\n**本题采用打包测试**，各测试包描述如下：\n\n| Subtask | $\\sum n\\le$ | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $500$ | 无 | $5$ |\n| $2$ | $5000$ | 无 | $20$ |\n| $3$ | $10^6$ | $a_i\\ge 0$ | $25$ |\n| $4$ | $3\\times10^5$ | 无 | $25$ |\n| $5$ | $10^6$ | 无 | $25$ |\n", "locale": "zh-CN"}}}
{"pid": "P12499", "type": "P", "difficulty": 6, "samples": [["4\n7 3\n1 6 3\n6 4 1\n6 7 4\n2 6 2\n3 6 1\n5 6 2\n6 1\n2 5 4\n2 1 1\n2 3 3\n2 4 2\n6 2 2\n10 2\n3 2 3\n4 9 2\n3 10 4\n10 4 1\n7 6 1\n3 5 3\n9 8 2\n7 10 1\n8 1 2\n10 1\n1 7 2\n3 2 3\n8 6 4\n5 4 2\n9 3 2\n4 10 3\n10 1 4\n2 5 3\n9 6 2\n", "0\n3\n2\n24"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "双指针 two-pointer", "Ad-hoc", "洛谷比赛"], "title": "「DLESS-1」Life Lies in Movement", "background": "**在本题题目描述最后，我们提供了一份形式化题意**。\n\n一个小镇马上要举行一场马拉松。", "description": "这个小镇可以看作一个 $n$ 个点，$n-1$ 条边的无向树，每条边有正整数边权，每个点上都有一家住户。记 $\\operatorname{dis}(u,v)$ 为 $u$ 到 $v$ 的简单路径的边权和。\n\n主办方将选择一个起点 $u$ 和终点 $v$（需要保证 $u\\neq v$），从 $u$ 到 $v$ 的简单路径就是本次比赛的赛道。届时，所有住户都会到赛道上去看比赛，第 $x$ 个点上的住户会到 $u\\to v$ 简单路径上满足 $\\operatorname{dis}(x,y)$ 最小的 $y$ 去（显然 $y$ 是唯一的），$\\operatorname{dis}(y,v)$ 被称作这家住户的“激情值”，记作 $f(x,u,v)$。\n\n设 $g(u,v)$ 表示所有住户的激情的平均值，即 $\\frac{1}{n}\\sum_{x=1}^nf(x,u,v)$，主办方认为，当 $g(u,v)\\ge \\frac{1}{2}\\operatorname{dis}(u,v)+k$ 时，这场比赛是“成功的”。\n\n现在给出常数 $k$，求有多少有序对 $(u,v)$ 使得比赛是“成功的”。\n\n**形式化题意：**\n\n给定一棵 $n$ 个点的带边权无向树。\n\n设 $\\operatorname{dis}(u,v)$ 表示从 $u$ 到 $v$ 的路径长度，$f(x,u,v)$ 表示 $u\\to v$ 简单路径上离 $x$ 最近的一个点到 $v$ 的距离，$g(u,v)=\\frac{1}{n}\\sum_{x=1}^nf(x,u,v)$。\n\n给定一个常数 $k$，求有多少有序对 $(u,v)$ 使得 $g(u,v)\\ge \\frac{1}{2}\\operatorname{dis}(u,v)+k$。", "inputFormat": "本题有多组测试数据，第一行输入一个正整数 $T$，代表数据组数。\n\n对于每组数据，第一行输入两个数 $n,k$。\n\n接下来 $n-1$ 行，每行三个数 $x,y,v$，代表有一条连结 $x,y$ 的，边权为 $v$ 的边，保证给出的是一棵树。", "outputFormat": "对于每组数据，输出一行一个数字，代表答案。", "hint": "#### 【数据范围】\n\n对于所有数据，保证：\n- $1\\le T\\le 10^4$\n- $1\\le n,\\sum n\\le 10^6$\n- $1\\le v,k\\le10^6$\n\n**本题采用打包测试**，各测试包描述如下：\n\n| Subtask | $\\sum n\\le$ | 分值 |\n| :----------: | :----------: | :----------: |\n| $1$ | $500$ | $5$ |\n| $2$ | $2000$ | $15$ |\n| $3$ | $5000$ | $20$ |\n| $4$ | $10^5$ | $20$ |\n| $5$ | $3\\times10^5$ | $20$ |\n| $6$ | $10^6$ | $20$ |\n", "locale": "zh-CN", "translations": {"en": {"title": "「DLESS-1」Life Lies in Movement", "background": "**A formal definition of the problem is provided at the end of this problem description.**\n\nA small town is about to host a marathon race.", "description": "The town can be modeled as an undirected tree with $n$ nodes and $n-1$ edges. Each edge has a positive integer weight, and there is a household at each node. Let $\\operatorname{dis}(u,v)$ denote the sum of edge weights along the unique simple path between nodes $u$ and $v$.\n\nThe organizers will select a starting node $u$ and an ending node $v$ (it is required that $u \\neq v$). The unique simple path between $u$ and $v$ will be the race course.\nAll residents will watch the race. The household at node $x$ will go to the node $y$ on the path $u \\to v$ that is closest to $x$ (i.e., minimizes $\\operatorname{dis}(x,y)$; such a node $y$ is unique). The distance $\\operatorname{dis}(y,v)$ is defined as the \"passion value\" of this household, denoted by $f(x, u, v)$.\n\nLet $g(u,v)$ be the average passion value over all households, defined as $g(u,v) = \\frac{1}{n}\\sum_{x=1}^n f(x,u,v)$. The organizers consider the race \"successful\" if the condition $g(u,v)\\ge \\frac{1}{2}\\operatorname{dis}(u,v)+k$ is met.\n\nGiven a constant $k$, your task is to count the number of ordered pairs $(u, v)$ such that $u \\neq v$ and the race from $u$ to $v$ is \"successful\".\n\n**Formal Definition:**\n\nGiven an undirected tree with $n$ nodes and positive edge weights.\nLet $\\operatorname{dis}(u,v)$ denote the length of the path between $u$ and $v$.\nLet $y$ be the node on the simple path $u \\to v$ that is closest to node $x$. Define $f(x, u, v) = \\operatorname{dis}(y, v)$.\nDefine $g(u,v)=\\frac{1}{n}\\sum_{x=1}^nf(x,u,v)$.\nGiven a constant $k$, count the number of ordered pairs $(u,v)$ such that $u \\ne v$ and $g(u,v)\\ge \\frac{1}{2}\\operatorname{dis}(u,v)+k$.", "inputFormat": "This problem contains multiple test cases. The first line contains a positive integer $T$, the number of test cases.\n\nFor each test case:\nThe first line contains two integers, $n$ and $k$.\nThe next $n-1$ lines each contain three integers $x, y, v$, representing an edge connecting nodes $x$ and $y$ with weight $v$. It is guaranteed that the input describes a tree.", "outputFormat": "For each test case, output a single integer on one line, representing the answer.", "hint": "#### 【Data Range】\n\nFor all test cases, it is guaranteed that:\n- $1\\le T\\le 10^4$\n- $1\\le n,\\sum n\\le 10^6$.\n- $1\\le v,k\\le10^6$.\n\n**This problem uses subtasks for scoring**. The descriptions of the subtasks are as follows:\n\n| Subtask | $\\sum n\\le$ | Score |\n| :----------: | :----------: | :----------: |\n| $1$ | $500$ | $5$ |\n| $2$ | $2000$ | $15$ |\n| $3$ | $5000$ | $20$ |\n| $4$ | $10^5$ | $20$ |\n| $5$ | $3\\times10^5$ | $20$ |\n| $6$ | $10^6$ | $20$ |", "locale": "en"}, "zh-CN": {"title": "「DLESS-1」Life Lies in Movement", "background": "**在本题题目描述最后，我们提供了一份形式化题意**。\n\n一个小镇马上要举行一场马拉松。", "description": "这个小镇可以看作一个 $n$ 个点，$n-1$ 条边的无向树，每条边有正整数边权，每个点上都有一家住户。记 $\\operatorname{dis}(u,v)$ 为 $u$ 到 $v$ 的简单路径的边权和。\n\n主办方将选择一个起点 $u$ 和终点 $v$（需要保证 $u\\neq v$），从 $u$ 到 $v$ 的简单路径就是本次比赛的赛道。届时，所有住户都会到赛道上去看比赛，第 $x$ 个点上的住户会到 $u\\to v$ 简单路径上满足 $\\operatorname{dis}(x,y)$ 最小的 $y$ 去（显然 $y$ 是唯一的），$\\operatorname{dis}(y,v)$ 被称作这家住户的“激情值”，记作 $f(x,u,v)$。\n\n设 $g(u,v)$ 表示所有住户的激情的平均值，即 $\\frac{1}{n}\\sum_{x=1}^nf(x,u,v)$，主办方认为，当 $g(u,v)\\ge \\frac{1}{2}\\operatorname{dis}(u,v)+k$ 时，这场比赛是“成功的”。\n\n现在给出常数 $k$，求有多少有序对 $(u,v)$ 使得比赛是“成功的”。\n\n**形式化题意：**\n\n给定一棵 $n$ 个点的带边权无向树。\n\n设 $\\operatorname{dis}(u,v)$ 表示从 $u$ 到 $v$ 的路径长度，$f(x,u,v)$ 表示 $u\\to v$ 简单路径上离 $x$ 最近的一个点到 $v$ 的距离，$g(u,v)=\\frac{1}{n}\\sum_{x=1}^nf(x,u,v)$。\n\n给定一个常数 $k$，求有多少有序对 $(u,v)$ 使得 $g(u,v)\\ge \\frac{1}{2}\\operatorname{dis}(u,v)+k$。", "inputFormat": "本题有多组测试数据，第一行输入一个正整数 $T$，代表数据组数。\n\n对于每组数据，第一行输入两个数 $n,k$。\n\n接下来 $n-1$ 行，每行三个数 $x,y,v$，代表有一条连结 $x,y$ 的，边权为 $v$ 的边，保证给出的是一棵树。", "outputFormat": "对于每组数据，输出一行一个数字，代表答案。", "hint": "#### 【数据范围】\n\n对于所有数据，保证：\n- $1\\le T\\le 10^4$\n- $1\\le n,\\sum n\\le 10^6$\n- $1\\le v,k\\le10^6$\n\n**本题采用打包测试**，各测试包描述如下：\n\n| Subtask | $\\sum n\\le$ | 分值 |\n| :----------: | :----------: | :----------: |\n| $1$ | $500$ | $5$ |\n| $2$ | $2000$ | $15$ |\n| $3$ | $5000$ | $20$ |\n| $4$ | $10^5$ | $20$ |\n| $5$ | $3\\times10^5$ | $20$ |\n| $6$ | $10^6$ | $20$ |\n", "locale": "zh-CN"}}}
{"pid": "P12500", "type": "P", "difficulty": 5, "samples": [["5 5\n0 6 7 2 6 \n2 1 1 \n2 2 4 \n2 1 1 \n1 1 5 2\n2 2 3 \n", "0\n4\n0\n4\n"], ["4 4\n6 0 7 0 \n1 2 3 5\n2 1 3 \n1 1 1 7\n2 3 4 \n", "6\n0"], ["4 5\n4 4 6 5 \n1 3 4 6\n1 2 4 0\n2 1 3 \n2 2 2 \n2 3 4 \n", "4\n4\n0"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["线段树", "O2优化", "位运算", "洛谷比赛"], "title": "「DLESS-1」XOR and OR", "background": null, "description": "给定长度为 $n$ 的序列 $a$，支持 $q$ 次操作，每次操作形如以下两种中的一种：\n\n- `1 l r x`：对所有 $i\\in[l,r]$，将 $a_i$ 异或上 $x$。\n- `2 l r`：求区间 $[l,r]$ 所有子区间权值按位或的异或和。", "inputFormat": "第一行输入两个正整数数 $n,q$。\n\n第二行输入 $n$ 个非负整数数，代表序列 $a$。\n\n接下来 $q$ 行，每行一次操作，格式如题目描述所示。", "outputFormat": "对于每次询问，输出一行一个数，代表答案。", "hint": "#### 【样例解释】\n\n以下 $\\operatorname{or}$ 表示按位或运算，$\\operatorname{xor}$ 表示按位异或运算。\n\n对于第一组样例的第二个询问，区间 $[2,4]$ 所有子区间按位或的异或和等于 $a_2\\operatorname{xor}a_3\\operatorname{xor}a_4\\operatorname{xor}(a_2\\operatorname{or}a_3)\\operatorname{xor}(a_3\\operatorname{or}a_4)\\operatorname{xor}(a_2\\operatorname{or}a_3\\operatorname{or}a_4)$，等于 $4$。\n\n#### 【数据范围】\n\n对于所有数据，保证：\n- $1\\le n,q\\le 5\\times10^5$\n- $0\\le a_i,x<2^{60}$\n- $1\\le l\\le r\\le n$\n\n**本题采用打包测试**，各测试包描述如下：\n\n| Subtask | $n\\le$ | $q\\le$ | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $500$ | $500$ | 无 | $10$ |\n| $2$ | $5000$ | $5000$ | 无 | $15$ |\n| $3$ | $5\\times10^5$ | $5\\times10^5$ | 没有操作 $1$ | $25$ |\n| $4$ | $5\\times10^5$ | $10^5$ | $a_i<2^{20}$ | $25$ |\n| $5$ | $5\\times10^5$ | $5\\times10^5$ | 无 | $25$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DLESS-1」XOR and OR", "background": null, "description": "给定长度为 $n$ 的序列 $a$，支持 $q$ 次操作，每次操作形如以下两种中的一种：\n\n- `1 l r x`：对所有 $i\\in[l,r]$，将 $a_i$ 异或上 $x$。\n- `2 l r`：求区间 $[l,r]$ 所有子区间权值按位或的异或和。", "inputFormat": "第一行输入两个正整数数 $n,q$。\n\n第二行输入 $n$ 个非负整数数，代表序列 $a$。\n\n接下来 $q$ 行，每行一次操作，格式如题目描述所示。", "outputFormat": "对于每次询问，输出一行一个数，代表答案。", "hint": "#### 【样例解释】\n\n以下 $\\operatorname{or}$ 表示按位或运算，$\\operatorname{xor}$ 表示按位异或运算。\n\n对于第一组样例的第二个询问，区间 $[2,4]$ 所有子区间按位或的异或和等于 $a_2\\operatorname{xor}a_3\\operatorname{xor}a_4\\operatorname{xor}(a_2\\operatorname{or}a_3)\\operatorname{xor}(a_3\\operatorname{or}a_4)\\operatorname{xor}(a_2\\operatorname{or}a_3\\operatorname{or}a_4)$，等于 $4$。\n\n#### 【数据范围】\n\n对于所有数据，保证：\n- $1\\le n,q\\le 5\\times10^5$\n- $0\\le a_i,x<2^{60}$\n- $1\\le l\\le r\\le n$\n\n**本题采用打包测试**，各测试包描述如下：\n\n| Subtask | $n\\le$ | $q\\le$ | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $500$ | $500$ | 无 | $10$ |\n| $2$ | $5000$ | $5000$ | 无 | $15$ |\n| $3$ | $5\\times10^5$ | $5\\times10^5$ | 没有操作 $1$ | $25$ |\n| $4$ | $5\\times10^5$ | $10^5$ | $a_i<2^{20}$ | $25$ |\n| $5$ | $5\\times10^5$ | $5\\times10^5$ | 无 | $25$ |", "locale": "zh-CN"}}}
{"pid": "P12501", "type": "P", "difficulty": 4, "samples": [["6 4\n0011\n1101\n0111\n1110\n0111\n0100", "8"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000]}, "tags": ["2025", "单调栈", "ROI（俄罗斯）"], "title": "「ROI 2025 Day1」奥林匹克楼梯", "background": "", "description": "**译自 [ROI 2025](https://neerc.ifmo.ru/school/archive/2024-2025.html) Day1 T1.** ***[Лестница для участников олимпиады](https://neerc.ifmo.ru/school/archive/2024-2025/ru-olymp-roi-2025-day1.pdf)***\n\n在天狼星教育中心，学生们最喜欢聚集和交流的地方莫过于各式各样的楼梯。然而，信息学奥林匹克的参与者数量远远超过了其他任何教育项目的学生，现有的楼梯已无法满足需求。因此，装备部门决定利用一块特殊的模板，打造一座全新的楼梯。\n\n这块模板是一个由 $h$ 行 $w$ 列组成的表格，行从上到下、列从左到右依次编号。表格的每个格子中记录了一个数字，要么是 `0`，要么是 `1`。而所谓的楼梯，只能由那些格子中填有 `1` 的格子构成。\n\n楼梯是由若干连续行中填有 `1` 的格子集合组成的。在每一行中，被选中的格子必须形成一个连续的段。  \n同时，满足以下条件：  \n- 每下一行的选中格子数量不得少于紧邻其上的上一行；  \n- 每行中最左边的选中格子必须位于同一列。\n\n下图展示了一个楼梯的例子：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/l57xqjcb.png)\n\n你的任务是找出给定表格中，能够构成楼梯的最大格子数量。", "inputFormat": "输入的第一行包含两个整数 $h$ 和 $w$ $(1 \\le h, w \\le 2 \\cdot 10^5, h \\cdot w \\le 4 \\cdot 10^6)$，分别表示表格的行数和列数。\n\n接下来的 $h$ 行，每行包含 $w$ 个字符，每个字符为 `0` 或 `1`，表示表格中对应格子的数字。", "outputFormat": "输出一个整数，表示能够构成楼梯的最大格子数量。", "hint": "样例解释：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/prkfqb5m.png)\n\n详细子任务附加限制及分值如下表所示。其中子任务 $0$ 是样例。\n\n| 子任务 | 分值 | 附加限制 | \n| :-: | :-: | :-: |\n| $1$        | $25$ | $h, w \\le 50$ |\n| $2$        | $25$ | $h, w \\le 400$ |\n| $3$        | $25$ | $h \\cdot w \\le 200\\,000$ |\n| $4$        | $25$ | 无附加限制 |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「ROI 2025 Day1」奥林匹克楼梯", "background": "", "description": "**译自 [ROI 2025](https://neerc.ifmo.ru/school/archive/2024-2025.html) Day1 T1.** ***[Лестница для участников олимпиады](https://neerc.ifmo.ru/school/archive/2024-2025/ru-olymp-roi-2025-day1.pdf)***\n\n在天狼星教育中心，学生们最喜欢聚集和交流的地方莫过于各式各样的楼梯。然而，信息学奥林匹克的参与者数量远远超过了其他任何教育项目的学生，现有的楼梯已无法满足需求。因此，装备部门决定利用一块特殊的模板，打造一座全新的楼梯。\n\n这块模板是一个由 $h$ 行 $w$ 列组成的表格，行从上到下、列从左到右依次编号。表格的每个格子中记录了一个数字，要么是 `0`，要么是 `1`。而所谓的楼梯，只能由那些格子中填有 `1` 的格子构成。\n\n楼梯是由若干连续行中填有 `1` 的格子集合组成的。在每一行中，被选中的格子必须形成一个连续的段。  \n同时，满足以下条件：  \n- 每下一行的选中格子数量不得少于紧邻其上的上一行；  \n- 每行中最左边的选中格子必须位于同一列。\n\n下图展示了一个楼梯的例子：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/l57xqjcb.png)\n\n你的任务是找出给定表格中，能够构成楼梯的最大格子数量。", "inputFormat": "输入的第一行包含两个整数 $h$ 和 $w$ $(1 \\le h, w \\le 2 \\cdot 10^5, h \\cdot w \\le 4 \\cdot 10^6)$，分别表示表格的行数和列数。\n\n接下来的 $h$ 行，每行包含 $w$ 个字符，每个字符为 `0` 或 `1`，表示表格中对应格子的数字。", "outputFormat": "输出一个整数，表示能够构成楼梯的最大格子数量。", "hint": "样例解释：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/prkfqb5m.png)\n\n详细子任务附加限制及分值如下表所示。其中子任务 $0$ 是样例。\n\n| 子任务 | 分值 | 附加限制 | \n| :-: | :-: | :-: |\n| $1$        | $25$ | $h, w \\le 50$ |\n| $2$        | $25$ | $h, w \\le 400$ |\n| $3$        | $25$ | $h \\cdot w \\le 200\\,000$ |\n| $4$        | $25$ | 无附加限制 |", "locale": "zh-CN"}}}
{"pid": "P12502", "type": "P", "difficulty": 5, "samples": [["2\n5 2\n3 4 5\n1 3 3\n5 3\n1 2 4\n2 4 5\n3 3 3", "YES\nNO"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000]}, "tags": ["动态规划 DP", "线段树", "树状数组", "2025", "ROI（俄罗斯）"], "title": "「ROI 2025 Day1」天狼星的换班", "background": "", "description": "**译自 [ROI 2025](https://neerc.ifmo.ru/school/archive/2024-2025.html) Day1 T2.** ***[Пересменка в Сириусе](https://neerc.ifmo.ru/school/archive/2024-2025/ru-olymp-roi-2025-day1.pdf)***\n\n你有没有好奇过，为什么天狼星教育中心的两期项目之间总会隔上几天？答案很简单：员工们需要在这段时间里把宿舍楼的房间整理一新，为下一期项目做准备！\n\n天狼星酒店的某层楼有 $n$ 个房间，编号从 $1$ 到 $n$。每次教育项目结束后，这些房间都需要进行维修。  \n为此，中心雇佣了 $k$ 名员工，编号从 $1$ 到 $k$。每位员工负责一段房间范围，从 $l_i$ 到 $r_i$（包含两端），并且每人有一个固定的起点房间 $m_i$，他们必须从这个房间开始检查和维修。不同员工的负责范围可能会有重叠，甚至完全相同。\n\n员工们会按照某种顺序从基地出发去维修房间。每次只有前一位员工返回基地后，下一位员工才会出发。  \n\n当第 $i$ 位员工出发时，他会先前往起点房间 $m_i$：  \n- 如果这个房间仍需维修，员工会修好它，然后继续检查并维修他负责范围 $l_i$ 到 $r_i$ 内所有仍需维修的房间。完成后，他返回基地。此时，他负责的整个范围内的房间都不再需要维修。  \n- 如果起点房间 $m_i$ 已经被其他先出发的员工修好，员工会直接返回基地，寄希望于同事们已经顺便修好了他负责范围内的其他房间。但实际上，他负责范围内可能仍有房间需要维修。\n\n你的任务是判断，是否能通过合理安排员工的出发顺序，让所有 $1$ 到 $n$ 的房间最终都被修好。", "inputFormat": "输入包含多组数据。第一行是一个整数 $t$ $(1 \\leq t \\leq 10^5)$，表示数据组数。接着是每组数据的描述。\n\n每组数据的第一行包含两个整数 $n$ 和 $k$ $(1 \\leq n, k \\leq 5 \\cdot 10^5)$，分别表示房间数量和员工数量。\n\n接下来的 $k$ 行，每行包含三个整数 $l_i,m_i,r_i$ $(1 \\leq l_i \\leq m_i \\leq r_i \\leq n)$，分别表示第 $i$ 位员工负责范围的起点房间、必须开始检查的起点房间，以及范围的终点房间。\n\n保证所有数据组的 $n$ 和 $k$ 之和均不超过 $5 \\cdot 10^5$。", "outputFormat": "对每组数据，输出单独的一行。如果可以修好所有房间，输出 `YES`；否则输出 `NO`。", "hint": "### 样例解释\n\n在第一组数据中，先派第 $2$ 位员工出发，他会修好房间 $1$ 到 $3$。然后派第 $1$ 位员工出发，他前往房间 $4$，发现它仍需维修，于是修好他负责范围内剩余的房间。最终，所有房间都被修好。\n\n在第二组数据中，无法找到一个合适的员工出发顺序来修好所有房间。\n\n### 数据范围\n\n记 $N$ 为所有数据组的 $n$ 之和，$K$ 为所有数据组的 $k$ 之和。\n\n详细子任务附加限制及分值如下表所示。其中子任务 $0$ 是样例。\n\n| 子任务 | 分值 | 附加限制 |\n| :-: | :-: | :-: |\n| $1$        | $5$  | $K \\leq 10\\,000$，$m_i = l_i$ | |\n| $2$        | $5$  | $N \\leq 500$，$k \\leq 8$ |\n| $3$        | $2$  | $n \\leq 18$，$K \\leq 500$ |\n| $4$        | $12$ | $n \\leq 50$，$K \\leq 50$ |\n| $5$        | $9$  | $n \\leq 150$，$K \\leq 150$ |\n| $6$        | $8$  | $N \\leq 500$，$K \\leq 500$ |\n| $7$        | $6$  | $K \\leq 10\\,000$，每个员工负责的范围包含房间 $1$ 或 $n$ | |\n| $8$        | $18$ | $K \\leq 10\\,000$，每个员工负责的范围内至少有一个房间只由他负责 | |\n| $9$        | $3$  | 每个员工负责的范围内至少有一个房间只由他负责 | $8$ |\n| $10$       | $4$  | $K \\leq 10\\,000$，任意 $i, j$，$r_i - l_i = r_j - l_j$ | |\n| $11$       | $4$  | $K \\leq 10\\,000$，任意 $m_i$ 等于 $l_i$ 或 $r_i$ | $1$ |\n| $12$       | $4$  | $n \\leq 10\\,000$，$K \\leq 10\\,000$ | $0,2-6$ |\n| $13$       | $6$  | $K \\leq 10\\,000$ | $0,1-8,10-12$ |\n| $14$       | $14$ | 无附加限制 | $0,1-13$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「ROI 2025 Day1」天狼星的换班", "background": "", "description": "**译自 [ROI 2025](https://neerc.ifmo.ru/school/archive/2024-2025.html) Day1 T2.** ***[Пересменка в Сириусе](https://neerc.ifmo.ru/school/archive/2024-2025/ru-olymp-roi-2025-day1.pdf)***\n\n你有没有好奇过，为什么天狼星教育中心的两期项目之间总会隔上几天？答案很简单：员工们需要在这段时间里把宿舍楼的房间整理一新，为下一期项目做准备！\n\n天狼星酒店的某层楼有 $n$ 个房间，编号从 $1$ 到 $n$。每次教育项目结束后，这些房间都需要进行维修。  \n为此，中心雇佣了 $k$ 名员工，编号从 $1$ 到 $k$。每位员工负责一段房间范围，从 $l_i$ 到 $r_i$（包含两端），并且每人有一个固定的起点房间 $m_i$，他们必须从这个房间开始检查和维修。不同员工的负责范围可能会有重叠，甚至完全相同。\n\n员工们会按照某种顺序从基地出发去维修房间。每次只有前一位员工返回基地后，下一位员工才会出发。  \n\n当第 $i$ 位员工出发时，他会先前往起点房间 $m_i$：  \n- 如果这个房间仍需维修，员工会修好它，然后继续检查并维修他负责范围 $l_i$ 到 $r_i$ 内所有仍需维修的房间。完成后，他返回基地。此时，他负责的整个范围内的房间都不再需要维修。  \n- 如果起点房间 $m_i$ 已经被其他先出发的员工修好，员工会直接返回基地，寄希望于同事们已经顺便修好了他负责范围内的其他房间。但实际上，他负责范围内可能仍有房间需要维修。\n\n你的任务是判断，是否能通过合理安排员工的出发顺序，让所有 $1$ 到 $n$ 的房间最终都被修好。", "inputFormat": "输入包含多组数据。第一行是一个整数 $t$ $(1 \\leq t \\leq 10^5)$，表示数据组数。接着是每组数据的描述。\n\n每组数据的第一行包含两个整数 $n$ 和 $k$ $(1 \\leq n, k \\leq 5 \\cdot 10^5)$，分别表示房间数量和员工数量。\n\n接下来的 $k$ 行，每行包含三个整数 $l_i,m_i,r_i$ $(1 \\leq l_i \\leq m_i \\leq r_i \\leq n)$，分别表示第 $i$ 位员工负责范围的起点房间、必须开始检查的起点房间，以及范围的终点房间。\n\n保证所有数据组的 $n$ 和 $k$ 之和均不超过 $5 \\cdot 10^5$。", "outputFormat": "对每组数据，输出单独的一行。如果可以修好所有房间，输出 `YES`；否则输出 `NO`。", "hint": "### 样例解释\n\n在第一组数据中，先派第 $2$ 位员工出发，他会修好房间 $1$ 到 $3$。然后派第 $1$ 位员工出发，他前往房间 $4$，发现它仍需维修，于是修好他负责范围内剩余的房间。最终，所有房间都被修好。\n\n在第二组数据中，无法找到一个合适的员工出发顺序来修好所有房间。\n\n### 数据范围\n\n记 $N$ 为所有数据组的 $n$ 之和，$K$ 为所有数据组的 $k$ 之和。\n\n详细子任务附加限制及分值如下表所示。其中子任务 $0$ 是样例。\n\n| 子任务 | 分值 | 附加限制 |\n| :-: | :-: | :-: |\n| $1$        | $5$  | $K \\leq 10\\,000$，$m_i = l_i$ | |\n| $2$        | $5$  | $N \\leq 500$，$k \\leq 8$ |\n| $3$        | $2$  | $n \\leq 18$，$K \\leq 500$ |\n| $4$        | $12$ | $n \\leq 50$，$K \\leq 50$ |\n| $5$        | $9$  | $n \\leq 150$，$K \\leq 150$ |\n| $6$        | $8$  | $N \\leq 500$，$K \\leq 500$ |\n| $7$        | $6$  | $K \\leq 10\\,000$，每个员工负责的范围包含房间 $1$ 或 $n$ | |\n| $8$        | $18$ | $K \\leq 10\\,000$，每个员工负责的范围内至少有一个房间只由他负责 | |\n| $9$        | $3$  | 每个员工负责的范围内至少有一个房间只由他负责 | $8$ |\n| $10$       | $4$  | $K \\leq 10\\,000$，任意 $i, j$，$r_i - l_i = r_j - l_j$ | |\n| $11$       | $4$  | $K \\leq 10\\,000$，任意 $m_i$ 等于 $l_i$ 或 $r_i$ | $1$ |\n| $12$       | $4$  | $n \\leq 10\\,000$，$K \\leq 10\\,000$ | $0,2-6$ |\n| $13$       | $6$  | $K \\leq 10\\,000$ | $0,1-8,10-12$ |\n| $14$       | $14$ | 无附加限制 | $0,1-13$ |", "locale": "zh-CN"}}}
{"pid": "P12503", "type": "P", "difficulty": 6, "samples": [["3\n4 0 7\n2 3\n7\n0\n1\n2\n3\n4\n23\n25", "3\n7\n10\n12\n13\n32\n33"], ["4\n30 239 57 179\n0 7\n5\n1\n10\n15\n100\n100000", "49\n355\n525\n3378\n93311"], ["4\n100 2 101 666\n9 10\n5\n777\n1\n2\n15\n10", "49597\n91\n159\n1043\n703"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000]}, "tags": ["数学", "贪心", "2025", "三分", "ROI（俄罗斯）"], "title": "「ROI 2025 Day1」索契游乐园", "background": "由于评测机性能差异，本题时限增加了 1 秒。", "description": "**译自 [ROI 2025](https://neerc.ifmo.ru/school/archive/2024-2025.html) Day1 T3.** ***[Сочи Парк\n](https://neerc.ifmo.ru/school/archive/2024-2025/ru-olymp-roi-2025-day1.pdf)***\n\n索契游乐园新推出了一项刺激的游乐项目！沿着一条直线，摆放了 $n$ 个目标，每个目标的坐标为 $x_i$ $(1 \\le i \\le n)$。你的任务是以任意顺序击中所有这些目标。击中目标需要使用小球，假设你站在坐标 $x$ 的位置，想击中位于 $x_i$ 的目标，你需要消耗 $(x - x_i)^2$ 卡路里的能量。\n\n你从坐标 $x_0$ 进入游乐项目。小球的补给点分布在入口处以及间隔 $d$ 的位置上，即坐标为 $x_0 + kd$ 的点（$k$ 为任意整数）。根据游乐项目的规则，你不能携带小球，只能从这些补给点投掷。\n\n在比赛间隙，有 $m$ 位奥林匹克选手将体验这个项目。每位选手的体力不同，第 $j$ 位选手移动距离 $d$ 需要消耗 $t_j$ 卡路里的能量。\n\n你的任务是计算每位选手完成所有目标所需的最少能量。", "inputFormat": "第一行包含一个整数 $n$ $(1 \\leq n \\leq 3 \\cdot 10^{5})$，表示游乐项目中的目标数量。\n\n第二行包含 $n$ 个整数 $x_{1}, x_{2}, \\ldots, x_{n}$ $(0 \\leq x_{i} \\leq 10^{9})$，表示目标的坐标。\n\n第三行包含两个整数 $x_{0}$ 和 $d$ $(0 \\leq x_{0} \\leq 10^{9}, 1 \\leq d \\leq 2 \\cdot 10^{6})$，分别表示入口坐标和小球补给点之间的间距。\n\n第四行包含一个整数 $m$ $(1 \\leq m \\leq 6 \\cdot 10^{5})$，表示奥林匹克选手的数量。\n\n接下来的 $m$ 行，每行包含一个整数 $t_j$ $(0 \\leq t_j \\leq 10^{8})$，表示第 $j$ 位选手移动距离 $d$ 所需的能量。", "outputFormat": "对每位选手，输出一个整数，表示他完成所有目标所需的最少能量。\n\n在给定限制下，答案不会超过 64 位有符号整数的最大值。但中间计算可能需要使用 C++ 的 `__int128` 类型（仅 GNU C++ 编译器支持）、Java 的 `BigInteger` 或 Python 的 `int` 类型。", "hint": "### 样例 1 解释\n\n在第一个样例中，对于第 $2$ 位选手（$t_2 = 1$），最优的击中目标策略如下：\n\n1. 从 $x_0 = 2$ 移动到 $x_0 - d = -1$，消耗 $t_2 = 1$ 卡路里。注意，选手坐标可以为负数。\n2. 击中位于 $x_2 = 0$ 的目标，消耗 $(-1 - 0)^2 = 1$ 卡路里。\n3. 移动到 $-1 + 2d = 5$，消耗 $2t_2 = 2$ 卡路里。\n4. 击中位于 $x_1 = 4$ 的目标，消耗 $(5 - 4)^2 = 1$ 卡路里。\n5. 移动到 $5 + d = 8$，消耗 $t_2 = 1$ 卡路里。\n6. 击中位于 $x_3 = 7$ 的目标，消耗 $(8 - 7)^2 = 1$ 卡路里。\n\n总能量消耗为 $1 + 1 + 2 + 1 + 1 + 1 = 7$ 卡路里。可以证明这是最小能量消耗。\n\n对于第 $6$ 位选手（$t_6 = 23$），最优策略如下：\n\n1. 击中位于 $x_2 = 0$ 的目标，消耗 $(2 - 0)^2 = 4$ 卡路里。\n2. 移动到 $2 + d = 5$，消耗 $t_6 = 23$ 卡路里。\n3. 击中位于 $x_3 = 7$ 的目标，消耗 $(7 - 5)^2 = 4$ 卡路里。\n4. 击中位于 $x_1 = 4$ 的目标，消耗 $(5 - 4)^2 = 1$ 卡路里。\n\n总能量消耗为 $4 + 23 + 4 + 1 = 32$ 卡路里。可以证明这是最小能量消耗。\n\n### 数据范围\n\n详细子任务附加限制及分值如下表所示。其中子任务 $0$ 是样例。\n\n| 子任务 | 分值 | 附加限制 |\n| :-: | :-: | :-: |\n| $1$        | $9$  | $m = 1$，$t_{1} = 0$ |\n| $2$        | $7$  | $n = 1$，$m \\leq 10\\,000$ |\n| $3$        | $8$  | $n = 2$，$m \\leq 10\\,000$，$x_{1} \\leq x_{0} \\leq x_{2}$ |\n| $4$        | $3$  | $n \\leq 50$，$x_{0} = 0$，$m \\leq 50$，$d \\leq 50$，$x_{i} \\leq 50$ |\n| $5$        | $2$  | $n \\leq 50$，$x_{0} \\leq 50$，$m \\leq 50$，$d \\leq 50$，$x_{i} \\leq 50$ |\n| $6$        | $4$  | $x_{0} = 0$，$m \\leq 10$，$x_{i} \\leq 10^{6}$ |\n| $7$        | $2$  | $x_{0} \\leq 10^{6}$，$m \\leq 10$，$x_{i} \\leq 10^{6}$ |\n| $8$        | $6$  | $x_{0} = 0$，$m \\leq 10\\,000$，$x_{i} \\leq 10^{6}$ |\n| $9$        | $10$ | $x_{0} \\leq 10^{6}$，$m \\leq 10\\,000$，$x_{i} \\leq 10^{6}$ |\n| $10$       | $7$  | $x_{0} \\leq 10^{6}$，$m \\leq 10^{5}$，$x_{i} \\leq 10^{6}$ |\n| $11$       | $2$  | $m \\leq 10$ | $0,1,6,7$ |\n| $12$       | $12$ | $x_{0} = 0$，$m \\leq 10^{5}$，$d = 1$ |\n| $13$       | $5$  | $m \\leq 10^{5}$，$d = 1$ |\n| $14$       | $8$  | $x_{0} = 0$，$m \\leq 10^{5}$ |\n| $15$       | $2$  | $m \\leq 10^{5}$ |\n| $16$       | $1$  | $m \\leq 2 \\cdot 10^{5}$ |\n| $17$       | $3$  | $m \\leq 3 \\cdot 10^{5}$ |\n| $18$       | $9$  | 无附加限制 |\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「ROI 2025 Day1」索契游乐园", "background": "由于评测机性能差异，本题时限增加了 1 秒。", "description": "**译自 [ROI 2025](https://neerc.ifmo.ru/school/archive/2024-2025.html) Day1 T3.** ***[Сочи Парк\n](https://neerc.ifmo.ru/school/archive/2024-2025/ru-olymp-roi-2025-day1.pdf)***\n\n索契游乐园新推出了一项刺激的游乐项目！沿着一条直线，摆放了 $n$ 个目标，每个目标的坐标为 $x_i$ $(1 \\le i \\le n)$。你的任务是以任意顺序击中所有这些目标。击中目标需要使用小球，假设你站在坐标 $x$ 的位置，想击中位于 $x_i$ 的目标，你需要消耗 $(x - x_i)^2$ 卡路里的能量。\n\n你从坐标 $x_0$ 进入游乐项目。小球的补给点分布在入口处以及间隔 $d$ 的位置上，即坐标为 $x_0 + kd$ 的点（$k$ 为任意整数）。根据游乐项目的规则，你不能携带小球，只能从这些补给点投掷。\n\n在比赛间隙，有 $m$ 位奥林匹克选手将体验这个项目。每位选手的体力不同，第 $j$ 位选手移动距离 $d$ 需要消耗 $t_j$ 卡路里的能量。\n\n你的任务是计算每位选手完成所有目标所需的最少能量。", "inputFormat": "第一行包含一个整数 $n$ $(1 \\leq n \\leq 3 \\cdot 10^{5})$，表示游乐项目中的目标数量。\n\n第二行包含 $n$ 个整数 $x_{1}, x_{2}, \\ldots, x_{n}$ $(0 \\leq x_{i} \\leq 10^{9})$，表示目标的坐标。\n\n第三行包含两个整数 $x_{0}$ 和 $d$ $(0 \\leq x_{0} \\leq 10^{9}, 1 \\leq d \\leq 2 \\cdot 10^{6})$，分别表示入口坐标和小球补给点之间的间距。\n\n第四行包含一个整数 $m$ $(1 \\leq m \\leq 6 \\cdot 10^{5})$，表示奥林匹克选手的数量。\n\n接下来的 $m$ 行，每行包含一个整数 $t_j$ $(0 \\leq t_j \\leq 10^{8})$，表示第 $j$ 位选手移动距离 $d$ 所需的能量。", "outputFormat": "对每位选手，输出一个整数，表示他完成所有目标所需的最少能量。\n\n在给定限制下，答案不会超过 64 位有符号整数的最大值。但中间计算可能需要使用 C++ 的 `__int128` 类型（仅 GNU C++ 编译器支持）、Java 的 `BigInteger` 或 Python 的 `int` 类型。", "hint": "### 样例 1 解释\n\n在第一个样例中，对于第 $2$ 位选手（$t_2 = 1$），最优的击中目标策略如下：\n\n1. 从 $x_0 = 2$ 移动到 $x_0 - d = -1$，消耗 $t_2 = 1$ 卡路里。注意，选手坐标可以为负数。\n2. 击中位于 $x_2 = 0$ 的目标，消耗 $(-1 - 0)^2 = 1$ 卡路里。\n3. 移动到 $-1 + 2d = 5$，消耗 $2t_2 = 2$ 卡路里。\n4. 击中位于 $x_1 = 4$ 的目标，消耗 $(5 - 4)^2 = 1$ 卡路里。\n5. 移动到 $5 + d = 8$，消耗 $t_2 = 1$ 卡路里。\n6. 击中位于 $x_3 = 7$ 的目标，消耗 $(8 - 7)^2 = 1$ 卡路里。\n\n总能量消耗为 $1 + 1 + 2 + 1 + 1 + 1 = 7$ 卡路里。可以证明这是最小能量消耗。\n\n对于第 $6$ 位选手（$t_6 = 23$），最优策略如下：\n\n1. 击中位于 $x_2 = 0$ 的目标，消耗 $(2 - 0)^2 = 4$ 卡路里。\n2. 移动到 $2 + d = 5$，消耗 $t_6 = 23$ 卡路里。\n3. 击中位于 $x_3 = 7$ 的目标，消耗 $(7 - 5)^2 = 4$ 卡路里。\n4. 击中位于 $x_1 = 4$ 的目标，消耗 $(5 - 4)^2 = 1$ 卡路里。\n\n总能量消耗为 $4 + 23 + 4 + 1 = 32$ 卡路里。可以证明这是最小能量消耗。\n\n### 数据范围\n\n详细子任务附加限制及分值如下表所示。其中子任务 $0$ 是样例。\n\n| 子任务 | 分值 | 附加限制 |\n| :-: | :-: | :-: |\n| $1$        | $9$  | $m = 1$，$t_{1} = 0$ |\n| $2$        | $7$  | $n = 1$，$m \\leq 10\\,000$ |\n| $3$        | $8$  | $n = 2$，$m \\leq 10\\,000$，$x_{1} \\leq x_{0} \\leq x_{2}$ |\n| $4$        | $3$  | $n \\leq 50$，$x_{0} = 0$，$m \\leq 50$，$d \\leq 50$，$x_{i} \\leq 50$ |\n| $5$        | $2$  | $n \\leq 50$，$x_{0} \\leq 50$，$m \\leq 50$，$d \\leq 50$，$x_{i} \\leq 50$ |\n| $6$        | $4$  | $x_{0} = 0$，$m \\leq 10$，$x_{i} \\leq 10^{6}$ |\n| $7$        | $2$  | $x_{0} \\leq 10^{6}$，$m \\leq 10$，$x_{i} \\leq 10^{6}$ |\n| $8$        | $6$  | $x_{0} = 0$，$m \\leq 10\\,000$，$x_{i} \\leq 10^{6}$ |\n| $9$        | $10$ | $x_{0} \\leq 10^{6}$，$m \\leq 10\\,000$，$x_{i} \\leq 10^{6}$ |\n| $10$       | $7$  | $x_{0} \\leq 10^{6}$，$m \\leq 10^{5}$，$x_{i} \\leq 10^{6}$ |\n| $11$       | $2$  | $m \\leq 10$ | $0,1,6,7$ |\n| $12$       | $12$ | $x_{0} = 0$，$m \\leq 10^{5}$，$d = 1$ |\n| $13$       | $5$  | $m \\leq 10^{5}$，$d = 1$ |\n| $14$       | $8$  | $x_{0} = 0$，$m \\leq 10^{5}$ |\n| $15$       | $2$  | $m \\leq 10^{5}$ |\n| $16$       | $1$  | $m \\leq 2 \\cdot 10^{5}$ |\n| $17$       | $3$  | $m \\leq 3 \\cdot 10^{5}$ |\n| $18$       | $9$  | 无附加限制 |\n", "locale": "zh-CN"}}}
{"pid": "P12504", "type": "P", "difficulty": 7, "samples": [["8\n7\n1 2\n2 3\n3 4\n3 5\n1 6\n6 7\n3 8", "3\n2 7\n6 3\n4 1"], ["11\n3\n1 2\n2 3\n3 4\n3 5\n3 6\n3 7\n1 8\n8 9\n8 10\n8 11", "4\n3 7\n11 8\n10 2\n1 6"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000]}, "tags": ["贪心", "堆", "树上启发式合并", "2025", "Special Judge", "ROI（俄罗斯）"], "title": "「ROI 2025 Day1」树上的青蛙", "background": null, "description": "**译自 [ROI 2025](https://neerc.ifmo.ru/school/archive/2024-2025.html) Day1 T4.** ***[Лягушки на дереве](https://neerc.ifmo.ru/school/archive/2024-2025/ru-olymp-roi-2025-day1.pdf)***\n\n在天狼星物理技术学院，你不仅能看到普通的青蛙，还能遇见会变色的树蛙！这些神奇的小家伙可以从绿色变成棕色，或者从棕色变回绿色，简直就像自然界的魔术师。\n\n所谓树，是一个没有环的连通图。树上的每个节点都住着一只青蛙，初始时它们全是绿色的。青蛙们喜欢在树上跳来跳去，每次跳跃会从当前节点沿着边跳到旁边的节点。每跳一次，它们的颜色就会切换到相反的颜色。\n\n青蛙们最爱成双成对地唱歌，但每一对必须由一只绿色和一只棕色的青蛙组成。为了组成一对，某只青蛙需要跳到另一只青蛙所在的节点，且跳跃次数不能超过 $d$ 次。为了保证到达时颜色与对方不同，跳跃次数必须是奇数。\n\n你的任务是找出最多能组成多少对青蛙合唱团。每只青蛙只能加入一对。如果能正确计算出最多的合唱团数量，你就能为子任务拿到部分分数。要想拿满分，你还得指出哪些青蛙应该配对，才能达到这个最大数量。", "inputFormat": "第一行包含一个整数 $n$ $(2 \\leq n \\leq 5 \\cdot 10^5)$，表示树上的节点数量。\n\n第二行包含一个奇数 $d$ $(1 \\leq d \\leq n - 1)$，表示一只青蛙前往另一只青蛙所在节点的最大跳跃次数。\n\n接下来的 $n-1$ 行，每行包含两个整数 $u$ 和 $v$ $(1 \\leq u, v \\leq n)$，表示树上两个通过一条边连接的节点。节点编号从 $1$ 到 $n$。", "outputFormat": "第一行输出一个整数 $m$，表示最多能组成的青蛙合唱团数量。\n\n如果你不想提供具体的配对方案，第二行输出 $-1$，然后结束程序。\n\n否则，在接下来的 $m$ 行中，每行输出两个整数 $u_i$ 和 $v_i$，表示一对青蛙所在的节点编号，它们将在其中一个节点相遇并组成合唱团，需满足上述规则。\n\n如果有多种方式可以达到最大合唱团数量，输出任意一种即可。", "hint": "详细子任务附加限制及分值如下表所示。其中子任务 $0$ 是样例。\n\n| 子任务 | 分值 | 附加限制 |\n| :-: | :-: | :-: |\n| $1$        | $6$  | $n \\le 14$ | $0$ |\n| $2$        | $6$  | $n \\le 300\\,000$，$d = n-1$ |\n| $3$        | $10$ | $n \\le 300\\,000$，$d = 1$ |\n| $4$        | $14$ | $n \\le 300\\,000$，$d = 3$ |\n| $5$        | $8$  | $n \\le 200$ |\n| $6$        | $12$ | $n \\le 30\\,000$，$d \\le 9$ | \n| $7$        | $4$  | $n \\le 300\\,000$，$d \\le 13$ |\n| $8$        | $10$ | $n \\le 300\\,000$，$d \\le 99$ |\n| $9$        | $14$ | $n \\le 300\\,000$ |\n| $10$       | $16$ | 无附加限制 |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「ROI 2025 Day1」树上的青蛙", "background": null, "description": "**译自 [ROI 2025](https://neerc.ifmo.ru/school/archive/2024-2025.html) Day1 T4.** ***[Лягушки на дереве](https://neerc.ifmo.ru/school/archive/2024-2025/ru-olymp-roi-2025-day1.pdf)***\n\n在天狼星物理技术学院，你不仅能看到普通的青蛙，还能遇见会变色的树蛙！这些神奇的小家伙可以从绿色变成棕色，或者从棕色变回绿色，简直就像自然界的魔术师。\n\n所谓树，是一个没有环的连通图。树上的每个节点都住着一只青蛙，初始时它们全是绿色的。青蛙们喜欢在树上跳来跳去，每次跳跃会从当前节点沿着边跳到旁边的节点。每跳一次，它们的颜色就会切换到相反的颜色。\n\n青蛙们最爱成双成对地唱歌，但每一对必须由一只绿色和一只棕色的青蛙组成。为了组成一对，某只青蛙需要跳到另一只青蛙所在的节点，且跳跃次数不能超过 $d$ 次。为了保证到达时颜色与对方不同，跳跃次数必须是奇数。\n\n你的任务是找出最多能组成多少对青蛙合唱团。每只青蛙只能加入一对。如果能正确计算出最多的合唱团数量，你就能为子任务拿到部分分数。要想拿满分，你还得指出哪些青蛙应该配对，才能达到这个最大数量。", "inputFormat": "第一行包含一个整数 $n$ $(2 \\leq n \\leq 5 \\cdot 10^5)$，表示树上的节点数量。\n\n第二行包含一个奇数 $d$ $(1 \\leq d \\leq n - 1)$，表示一只青蛙前往另一只青蛙所在节点的最大跳跃次数。\n\n接下来的 $n-1$ 行，每行包含两个整数 $u$ 和 $v$ $(1 \\leq u, v \\leq n)$，表示树上两个通过一条边连接的节点。节点编号从 $1$ 到 $n$。", "outputFormat": "第一行输出一个整数 $m$，表示最多能组成的青蛙合唱团数量。\n\n如果你不想提供具体的配对方案，第二行输出 $-1$，然后结束程序。\n\n否则，在接下来的 $m$ 行中，每行输出两个整数 $u_i$ 和 $v_i$，表示一对青蛙所在的节点编号，它们将在其中一个节点相遇并组成合唱团，需满足上述规则。\n\n如果有多种方式可以达到最大合唱团数量，输出任意一种即可。", "hint": "详细子任务附加限制及分值如下表所示。其中子任务 $0$ 是样例。\n\n| 子任务 | 分值 | 附加限制 |\n| :-: | :-: | :-: |\n| $1$        | $6$  | $n \\le 14$ | $0$ |\n| $2$        | $6$  | $n \\le 300\\,000$，$d = n-1$ |\n| $3$        | $10$ | $n \\le 300\\,000$，$d = 1$ |\n| $4$        | $14$ | $n \\le 300\\,000$，$d = 3$ |\n| $5$        | $8$  | $n \\le 200$ |\n| $6$        | $12$ | $n \\le 30\\,000$，$d \\le 9$ | \n| $7$        | $4$  | $n \\le 300\\,000$，$d \\le 13$ |\n| $8$        | $10$ | $n \\le 300\\,000$，$d \\le 99$ |\n| $9$        | $14$ | $n \\le 300\\,000$ |\n| $10$       | $16$ | 无附加限制 |", "locale": "zh-CN"}}}
{"pid": "P12505", "type": "P", "difficulty": 4, "samples": [["3 4\n000\n0\n1\n2\n3\n", "0\n0\n2\n3\n"], ["4 3\n1010\n0\n1\n2\n", "0\n3\n4\n"], ["11 6\n11010101001\n5\n2\n0\n1\n4\n3\n", "11\n7\n2\n5\n10\n9\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["贪心", "2025", "分类讨论", "ROI（俄罗斯）"], "title": "「ROI 2025 Day2」充实的假期", "background": "", "description": "**译自 [ROI 2025](https://neerc.ifmo.ru/school/archive/2024-2025.html) Day2 T1.** ***[Качественный отдых](https://neerc.ifmo.ru/school/archive/2024-2025/ru-olymp-roi-2025-day2.pdf)***\n\n小明正在一家 IT 公司进行为期 $n$ 天的实习，担任技术支持的角色。他的实习日程安排颇为复杂，工作日和休息日交织在一起。除了固定的休息日，小明还有一些调休日——他可以选择在任意工作日额外休息一天。\n\n不过，小明觉得单独一天的休息远远不够，只有连续两天或以上的休息日才能让他真正放松，称之为充实休假日。\n\n你会收到 $q$ 个关于调休日数量的询问，每个询问对应一个不同的调休天数。你的任务是根据小明的实习日程，计算出在每种调休天数下，小明最多能获得多少个充实休假日。", "inputFormat": "第一行包含两个整数 $n$ 和 $q$ $(1 \\le n \\le 100\\,000, 1 \\le q \\le n+1)$，分别表示实习天数和询问数量。\n\n第二行包含一个长度为 $n$ 的字符串 $s$，由字符 `0` 和 `1` 组成，表示实习日程。其中，`0` 表示工作日，`1` 表示休息日。\n\n接下来的 $q$ 行，每行包含一个整数 $k_i$ $(0 \\leq k_i \\leq n)$，表示第 $i$ 个询问中可用的调休天数。保证每个 $k_i$ 不超过日程中的工作日总数。", "outputFormat": "输出 $q$ 个整数，分别表示在每个 $k_i$ 调休天数下，小明通过选择 $k_i$ 个额外休息日，最多能获得的充实休假日数量。", "hint": "### 样例解释 1\n在第一个样例中，实习的 $3$ 天全是工作日。如果调休少于 $2$ 天，无法获得充实休假日。对于 $k_3 = 2$ 或 $k_4 = 3$，可以选择前 $k_j$ 天作为调休日，这些天都将成为充实休假日。\n\n### 样例解释 2\n在第二个样例中，最优策略是将调休日安排在第二天，这样前三天都将成为充实休假日。\n\n---\n\n详细子任务附加限制及分值如下表所示。其中子任务 $0$ 是样例。\n\n| 子任务 | 分值 | 附加限制 | \n| :-: | :-: | :-: |\n|$0$|$0$|样例||\n| $1$        | $6$  | 所有日程均为工作日 | |\n| $2$        | $11$ | 工作日与休息日交替，首日为休息日 | |\n| $3$        | $12$ | $q = 1$，$k_1 = 0$ | |\n| $4$        | $19$ | $q = 1$，$k_1 = 1$ | |\n| $5$        | $11$ | $n \\le 15$ | $0$ |\n| $6$        | $17$ | $n \\le 1000$ | $0,5$ |\n| $7$        | $13$ | 日程中无连续休息日 | $1,2$ |\n| $8$        | $11$ | 无附加限制 | $0,1-7$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「ROI 2025 Day2」充实的假期", "background": "", "description": "**译自 [ROI 2025](https://neerc.ifmo.ru/school/archive/2024-2025.html) Day2 T1.** ***[Качественный отдых](https://neerc.ifmo.ru/school/archive/2024-2025/ru-olymp-roi-2025-day2.pdf)***\n\n小明正在一家 IT 公司进行为期 $n$ 天的实习，担任技术支持的角色。他的实习日程安排颇为复杂，工作日和休息日交织在一起。除了固定的休息日，小明还有一些调休日——他可以选择在任意工作日额外休息一天。\n\n不过，小明觉得单独一天的休息远远不够，只有连续两天或以上的休息日才能让他真正放松，称之为充实休假日。\n\n你会收到 $q$ 个关于调休日数量的询问，每个询问对应一个不同的调休天数。你的任务是根据小明的实习日程，计算出在每种调休天数下，小明最多能获得多少个充实休假日。", "inputFormat": "第一行包含两个整数 $n$ 和 $q$ $(1 \\le n \\le 100\\,000, 1 \\le q \\le n+1)$，分别表示实习天数和询问数量。\n\n第二行包含一个长度为 $n$ 的字符串 $s$，由字符 `0` 和 `1` 组成，表示实习日程。其中，`0` 表示工作日，`1` 表示休息日。\n\n接下来的 $q$ 行，每行包含一个整数 $k_i$ $(0 \\leq k_i \\leq n)$，表示第 $i$ 个询问中可用的调休天数。保证每个 $k_i$ 不超过日程中的工作日总数。", "outputFormat": "输出 $q$ 个整数，分别表示在每个 $k_i$ 调休天数下，小明通过选择 $k_i$ 个额外休息日，最多能获得的充实休假日数量。", "hint": "### 样例解释 1\n在第一个样例中，实习的 $3$ 天全是工作日。如果调休少于 $2$ 天，无法获得充实休假日。对于 $k_3 = 2$ 或 $k_4 = 3$，可以选择前 $k_j$ 天作为调休日，这些天都将成为充实休假日。\n\n### 样例解释 2\n在第二个样例中，最优策略是将调休日安排在第二天，这样前三天都将成为充实休假日。\n\n---\n\n详细子任务附加限制及分值如下表所示。其中子任务 $0$ 是样例。\n\n| 子任务 | 分值 | 附加限制 | \n| :-: | :-: | :-: |\n|$0$|$0$|样例||\n| $1$        | $6$  | 所有日程均为工作日 | |\n| $2$        | $11$ | 工作日与休息日交替，首日为休息日 | |\n| $3$        | $12$ | $q = 1$，$k_1 = 0$ | |\n| $4$        | $19$ | $q = 1$，$k_1 = 1$ | |\n| $5$        | $11$ | $n \\le 15$ | $0$ |\n| $6$        | $17$ | $n \\le 1000$ | $0,5$ |\n| $7$        | $13$ | 日程中无连续休息日 | $1,2$ |\n| $8$        | $11$ | 无附加限制 | $0,1-7$ |", "locale": "zh-CN"}}}
{"pid": "P12506", "type": "P", "difficulty": 6, "samples": [["6 5\n4 1\n4 4\n1 5\n5 9\n9 6\n10 2\n", "111000\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2025", "ROI（俄罗斯）"], "title": "「ROI 2025 Day2」沼泽里的青蛙", "background": "", "description": "**译自 [ROI 2025](https://neerc.ifmo.ru/school/archive/2024-2025.html) Day2 T2.** ***[Лягушки на болоте](https://neerc.ifmo.ru/school/archive/2024-2025/ru-olymp-roi-2025-day2.pdf)***\n\n在索契筹备 2014 年奥运会时，意外引入了来自远东的小型蝴蝶——箱树蛾。它毁掉了当地的箱树林，迫使树蛙们搬到了沼泽里生活。不过，这些聪明的树蛙依然保留了它们的神奇本领：每次跳跃后，它们的颜色会在绿色和棕色之间切换。\n\n沼泽是一片平面，上面散布着许多小土丘，可以看作平面上的点。青蛙一次跳跃可以从当前土丘跳到任何一个距离不超过 $r$ 的其他土丘。跳跃后，青蛙的颜色会变成相反的颜色。需要注意的是，青蛙无法在原地跳跃。\n\n你的任务是，对于从 $1$ 到 $n$ 的每个起始土丘，判断青蛙能否通过若干次跳跃回到这个土丘，并且在回到时颜色与初始时相反。", "inputFormat": "第一行包含两个整数 $n$ 和 $r$ $(2 \\le n \\le 10^5, 1 \\le r \\le 10^9)$，分别表示沼泽中土丘的数量和青蛙的最大跳跃距离。\n\n接下来的 $n$ 行，每行包含两个整数 $x_i$ 和 $y_i$ $(0 \\le x_i, y_i \\le 5 \\cdot 10^8)$，表示第 $i$ 个土丘的坐标。\n\n保证任意两个土丘的坐标不重合。", "outputFormat": "输出一个长度为 $n$ 的字符串，包含字符 `0` 或 `1`。如果从第 $i$ 个土丘开始的青蛙能回到该土丘且颜色相反，则第 $i$ 个字符为 `1`；否则为 `0`。", "hint": "### 样例解释\n\n下图展示了从第一个土丘开始，青蛙通过跳跃改变颜色的路径：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ljt0b2yi.png)\n\n---\n\n详细子任务附加限制及分值如下表所示。其中子任务 $0$ 是样例。\n\n| 子任务 | 分值 | 附加限制 |\n| :-: | :-: | :-: |\n|$0$|$0$|样例||\n| $1$        | $10$ | $n \\le 3$ | |\n| $2$        | $20$ | $n \\le 200$ | $0,1$ |\n| $3$        | $6$  | $n \\le 1\\,000$ | $0,1,2$ |\n| $4$        | $9$  | $n \\le 10\\,000$ | $0,1-3$ |\n| $5$        | $16$ | $y_i = 0$ | |\n| $6$        | $5$  | $r \\le 2$ | |\n| $7$        | $5$  | $r \\le 4$ | $6$ |\n| $8$        | $5$  | $r \\le 10$ | $0,6,7$ |\n| $9$        | $12$ | $(x_i - x_j)^2 + (y_i - y_j)^2 \\ge \\frac{r^2}{4}$，$i \\ne j$ | $0,6$ |\n| $10$       | $12$ | 无附加限制 | $0,1-9$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「ROI 2025 Day2」沼泽里的青蛙", "background": "", "description": "**译自 [ROI 2025](https://neerc.ifmo.ru/school/archive/2024-2025.html) Day2 T2.** ***[Лягушки на болоте](https://neerc.ifmo.ru/school/archive/2024-2025/ru-olymp-roi-2025-day2.pdf)***\n\n在索契筹备 2014 年奥运会时，意外引入了来自远东的小型蝴蝶——箱树蛾。它毁掉了当地的箱树林，迫使树蛙们搬到了沼泽里生活。不过，这些聪明的树蛙依然保留了它们的神奇本领：每次跳跃后，它们的颜色会在绿色和棕色之间切换。\n\n沼泽是一片平面，上面散布着许多小土丘，可以看作平面上的点。青蛙一次跳跃可以从当前土丘跳到任何一个距离不超过 $r$ 的其他土丘。跳跃后，青蛙的颜色会变成相反的颜色。需要注意的是，青蛙无法在原地跳跃。\n\n你的任务是，对于从 $1$ 到 $n$ 的每个起始土丘，判断青蛙能否通过若干次跳跃回到这个土丘，并且在回到时颜色与初始时相反。", "inputFormat": "第一行包含两个整数 $n$ 和 $r$ $(2 \\le n \\le 10^5, 1 \\le r \\le 10^9)$，分别表示沼泽中土丘的数量和青蛙的最大跳跃距离。\n\n接下来的 $n$ 行，每行包含两个整数 $x_i$ 和 $y_i$ $(0 \\le x_i, y_i \\le 5 \\cdot 10^8)$，表示第 $i$ 个土丘的坐标。\n\n保证任意两个土丘的坐标不重合。", "outputFormat": "输出一个长度为 $n$ 的字符串，包含字符 `0` 或 `1`。如果从第 $i$ 个土丘开始的青蛙能回到该土丘且颜色相反，则第 $i$ 个字符为 `1`；否则为 `0`。", "hint": "### 样例解释\n\n下图展示了从第一个土丘开始，青蛙通过跳跃改变颜色的路径：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ljt0b2yi.png)\n\n---\n\n详细子任务附加限制及分值如下表所示。其中子任务 $0$ 是样例。\n\n| 子任务 | 分值 | 附加限制 |\n| :-: | :-: | :-: |\n|$0$|$0$|样例||\n| $1$        | $10$ | $n \\le 3$ | |\n| $2$        | $20$ | $n \\le 200$ | $0,1$ |\n| $3$        | $6$  | $n \\le 1\\,000$ | $0,1,2$ |\n| $4$        | $9$  | $n \\le 10\\,000$ | $0,1-3$ |\n| $5$        | $16$ | $y_i = 0$ | |\n| $6$        | $5$  | $r \\le 2$ | |\n| $7$        | $5$  | $r \\le 4$ | $6$ |\n| $8$        | $5$  | $r \\le 10$ | $0,6,7$ |\n| $9$        | $12$ | $(x_i - x_j)^2 + (y_i - y_j)^2 \\ge \\frac{r^2}{4}$，$i \\ne j$ | $0,6$ |\n| $10$       | $12$ | 无附加限制 | $0,1-9$ |", "locale": "zh-CN"}}}
