{"pid": "P5631", "type": "P", "difficulty": 6, "samples": [["3 3\n1 2 0\n2 3 1\n3 2 2\n", "1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["线段树", "并查集", "O2优化", "分治", "动态树 LCT"], "title": "最小mex生成树", "background": "这是一道经典题。", "description": "给定 $n$ 个点 $m$ 条边的无向连通图，边有边权。  \n\n设一个自然数集合 $S$ 的 $\\text{mex}$ 为：最小的、没有出现在 $S$ 中的自然数。  \n\n现在你要求出一个这个图的生成树，使得其边权集合的 $\\text{mex}$ 尽可能小。", "inputFormat": "第一行输入两个正整数 $n,m$。\n\n接下来 $m$ 行，每行 $3$ 个非负整数 $u,v,w$，表示 $u,v$ 之间有一条权值为 $w$ 的边。\n", "outputFormat": "输出一行一个自然数，表示最小的 $\\text{mex}$ 值。", "hint": "【数据范围】   \n- 对于 $20\\%$ 的数据，$1\\le n \\le 100$，$1\\le m \\le 200$。\n- 对于 $50\\%$ 的数据，$1\\le n \\le 2000$，$1\\le m \\le 3000$。\n- 对于 $80\\%$ 的数据，$1\\le n \\le 10^5$，$1\\le m \\le 2\\times 10^5$。\n- 对于 $100\\%$ 的数据，$1\\le n \\le 10^6$，$1\\le m \\le 2\\times 10^6,0\\le w \\le 10^5$。\n\n输入数据规模较大，建议使用高效的读入方式。", "locale": "zh-CN", "translations": {"en": {"title": "Minimum MEX Spanning Tree", "background": "This is a classic problem.", "description": "Given an undirected connected graph with $n$ vertices and $m$ edges, each edge has a weight.\n\nDefine the $\\text{mex}$ of a set of natural numbers $S$ as the smallest natural number that does not appear in $S$.\n\nNow you need to find a spanning tree of this graph such that the $\\text{mex}$ of the set of its edge weights is as small as possible.", "inputFormat": "The first line contains two positive integers $n, m$.\n\nThe next $m$ lines each contain three non-negative integers $u, v, w$, indicating that there is an edge between $u$ and $v$ with weight $w$.", "outputFormat": "Output one line with one natural number, representing the minimum possible $\\text{mex}$ value.", "hint": "Constraints  \n- For $20\\%$ of the testdata, $1 \\le n \\le 100$, $1 \\le m \\le 200$.\n- For $50\\%$ of the testdata, $1 \\le n \\le 2000$, $1 \\le m \\le 3000$.\n- For $80\\%$ of the testdata, $1 \\le n \\le 10^5$, $1 \\le m \\le 2 \\times 10^5$.\n- For $100\\%$ of the testdata, $1 \\le n \\le 10^6$, $1 \\le m \\le 2 \\times 10^6, 0 \\le w \\le 10^5$.\n\nThe input size is large, so an efficient input method is recommended.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "最小mex生成树", "background": "这是一道经典题。", "description": "给定 $n$ 个点 $m$ 条边的无向连通图，边有边权。  \n\n设一个自然数集合 $S$ 的 $\\text{mex}$ 为：最小的、没有出现在 $S$ 中的自然数。  \n\n现在你要求出一个这个图的生成树，使得其边权集合的 $\\text{mex}$ 尽可能小。", "inputFormat": "第一行输入两个正整数 $n,m$。\n\n接下来 $m$ 行，每行 $3$ 个非负整数 $u,v,w$，表示 $u,v$ 之间有一条权值为 $w$ 的边。\n", "outputFormat": "输出一行一个自然数，表示最小的 $\\text{mex}$ 值。", "hint": "【数据范围】   \n- 对于 $20\\%$ 的数据，$1\\le n \\le 100$，$1\\le m \\le 200$。\n- 对于 $50\\%$ 的数据，$1\\le n \\le 2000$，$1\\le m \\le 3000$。\n- 对于 $80\\%$ 的数据，$1\\le n \\le 10^5$，$1\\le m \\le 2\\times 10^5$。\n- 对于 $100\\%$ 的数据，$1\\le n \\le 10^6$，$1\\le m \\le 2\\times 10^6,0\\le w \\le 10^5$。\n\n输入数据规模较大，建议使用高效的读入方式。", "locale": "zh-CN"}}}
{"pid": "P5632", "type": "P", "difficulty": 5, "samples": [["4 6\n1 2 5\n1 3 1\n2 4 1\n3 4 2\n2 3 1\n1 4 2\n", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["图论", "最小割", "模板题"], "title": "【模板】Stoer-Wagner", "background": "", "description": "定义无向图 $G$ 的最小割为：一个去掉后可以使 $G$ 变成两个连通分量，且边权和最小的边集的边权和。\n\n给出一张无向图 $G$，求其最小割。", "inputFormat": "第一行，两个数 $n,m$，表示点数与边数。\n\n接下来 $m$ 行，每行三个正整数 $a_i,b_i,w_i$，表示 $a_i$ 到 $b_i$ 有一条边权为 $w_i$ 的边。", "outputFormat": "一行，一个整数表示 $G$ 的最小割，如果图不联通，请输出 `0` 。", "hint": "对于前 $20\\%$ 的数据， $n\\leq 10$。  \n对于前 $40\\%$ 的数据， $n\\leq 100$。  \n对于另外 $10\\%$ 的数据，保证输入为一棵树。  \n对于另外 $10\\%$ 的数据，保证输入为一条链。  \n对于 $100\\%$ 的数据， $n\\leq 600,m\\leq \\frac{n\\times (n-1)}{2}$ ，保证 $\\sum_{i=1}^{m}w_i \\leq10^9$ 。\n\n#### PS：想交 最大流/最小割树 的就省省吧。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Stoer-Wagner", "background": "", "description": "Define the minimum cut of an undirected graph $G$ as follows: it is a set of edges such that removing these edges can make $G$ split into two connected components, and the sum of edge weights in this set is minimal.\n\nGiven an undirected graph $G$, find its minimum cut.", "inputFormat": "The first line contains two numbers $n, m$, representing the number of vertices and the number of edges.\n\nThe next $m$ lines each contain three positive integers $a_i, b_i, w_i$, indicating that there is an edge between $a_i$ and $b_i$ with weight $w_i$.", "outputFormat": "Output one line with one integer representing the minimum cut of $G$. If the graph is disconnected, output `0`.", "hint": "For the first $20\\%$ of the testdata, $n \\leq 10$.  \nFor the first $40\\%$ of the testdata, $n \\leq 100$.  \nFor another $10\\%$ of the testdata, the input is guaranteed to be a tree.  \nFor another $10\\%$ of the testdata, the input is guaranteed to be a chain.  \nFor $100\\%$ of the testdata, $n \\leq 600, m \\leq \\frac{n\\times (n-1)}{2}$, and it is guaranteed that $\\sum_{i=1}^{m} w_i \\leq 10^9$.\n\n#### PS: If you want to submit “maximum flow / minimum cut tree”, just forget it.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】Stoer-Wagner", "background": "", "description": "定义无向图 $G$ 的最小割为：一个去掉后可以使 $G$ 变成两个连通分量，且边权和最小的边集的边权和。\n\n给出一张无向图 $G$，求其最小割。", "inputFormat": "第一行，两个数 $n,m$，表示点数与边数。\n\n接下来 $m$ 行，每行三个正整数 $a_i,b_i,w_i$，表示 $a_i$ 到 $b_i$ 有一条边权为 $w_i$ 的边。", "outputFormat": "一行，一个整数表示 $G$ 的最小割，如果图不联通，请输出 `0` 。", "hint": "对于前 $20\\%$ 的数据， $n\\leq 10$。  \n对于前 $40\\%$ 的数据， $n\\leq 100$。  \n对于另外 $10\\%$ 的数据，保证输入为一棵树。  \n对于另外 $10\\%$ 的数据，保证输入为一条链。  \n对于 $100\\%$ 的数据， $n\\leq 600,m\\leq \\frac{n\\times (n-1)}{2}$ ，保证 $\\sum_{i=1}^{m}w_i \\leq10^9$ 。\n\n#### PS：想交 最大流/最小割树 的就省省吧。", "locale": "zh-CN"}}}
{"pid": "P5633", "type": "P", "difficulty": 6, "samples": [["5 7 1 1\n1 3 1\n2 1 5\n4 2 3\n2 5 4\n5 1 2\n3 5 7\n4 1 6", "15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["图论", "Kruskal 重构树", "凸完全单调性（wqs 二分）", "生成树"], "title": "最小度限制生成树", "background": "", "description": "给你一个有 $n$ 个节点，$m$ 条边的带权无向图，你需要求得一个生成树，使边权总和最小，且满足编号为 $s$ 的节点正好连了 $k$ 条边。", "inputFormat": "第一行四个数：$n,m,s,k$\n\n下面的 $m$ 行，每行三个整数：$u,v,w$，表示有一条 $u$ 连向 $v$ 权值为 $w$ 的边。", "outputFormat": "输出一个数：满足要求的生成树的总边权。\n\n可能会出现无解的情况，如果无解，则输出 `Impossible`。", "hint": "### 数据范围\n\n对于 $20\\%$ 的数据，$n \\le 10$，$m \\le 30$。  \n对于 $50\\%$ 的数据，$n \\le 1000$，$m \\le 5000$。  \n对于 $100\\%$ 的数据，$1\\leq s \\leq n \\le 5\\times 10^4$，$1\\leq m \\le 5\\times 10^5 $，$1\\leq k \\le 100$，$0\\leq w\\leq 3\\times 10^4$。\n\n### 注意\n\n本题设有 hack 数据（Subtask $2$），计 $0$ 分，但若没有通过 hack 数据则不算通过本题。", "locale": "zh-CN", "translations": {"en": {"title": "Minimum Degree-Constrained Spanning Tree.", "background": "", "description": "You are given a weighted undirected graph with $n$ nodes and $m$ edges. You need to find a spanning tree such that the total edge weight is minimized, and the node with index $s$ is connected to exactly $k$ edges.", "inputFormat": "The first line contains four numbers: $n,m,s,k$.\n\nThe next $m$ lines each contain three integers: $u,v,w$, meaning there is an edge between $u$ and $v$ with weight $w$.", "outputFormat": "Output one number: the total edge weight of a spanning tree that satisfies the requirement.\n\nThere may be cases where no solution exists. If there is no solution, output `Impossible`.", "hint": "### Constraints\n\nFor $20\\%$ of the testdata, $n \\le 10$, $m \\le 30$.  \nFor $50\\%$ of the testdata, $n \\le 1000$, $m \\le 5000$.  \nFor $100\\%$ of the testdata, $1\\leq s \\leq n \\le 5\\times 10^4$, $1\\leq m \\le 5\\times 10^5 $, $1\\leq k \\le 100$, $0\\leq w\\leq 3\\times 10^4$.\n\n### Note\n\nThis problem includes hack testdata (Subtask $2$), worth $0$ points, but if you do not pass the hack testdata, it will not be considered as having passed this problem.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "最小度限制生成树", "background": "", "description": "给你一个有 $n$ 个节点，$m$ 条边的带权无向图，你需要求得一个生成树，使边权总和最小，且满足编号为 $s$ 的节点正好连了 $k$ 条边。", "inputFormat": "第一行四个数：$n,m,s,k$\n\n下面的 $m$ 行，每行三个整数：$u,v,w$，表示有一条 $u$ 连向 $v$ 权值为 $w$ 的边。", "outputFormat": "输出一个数：满足要求的生成树的总边权。\n\n可能会出现无解的情况，如果无解，则输出 `Impossible`。", "hint": "### 数据范围\n\n对于 $20\\%$ 的数据，$n \\le 10$，$m \\le 30$。  \n对于 $50\\%$ 的数据，$n \\le 1000$，$m \\le 5000$。  \n对于 $100\\%$ 的数据，$1\\leq s \\leq n \\le 5\\times 10^4$，$1\\leq m \\le 5\\times 10^5 $，$1\\leq k \\le 100$，$0\\leq w\\leq 3\\times 10^4$。\n\n### 注意\n\n本题设有 hack 数据（Subtask $2$），计 $0$ 分，但若没有通过 hack 数据则不算通过本题。", "locale": "zh-CN"}}}
{"pid": "P5634", "type": "P", "difficulty": 6, "samples": [["4", "5"], ["5", "8"]], "limits": {"time": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["O2优化"], "title": "数码排序【加强版】", "background": "**本题是[P5626](https://www.luogu.org/problem/P5626)的加强版**\n\n小L从虚拟世界里出来啦！", "description": "逃出来的同时，也有一部分数码逃了出来，吵着闹着让小L帮他们排序。\n\n虚拟世界的数码都是不可见的。\n\n小L目前只会选择排序，插入排序，冒泡排序，归并排序。\n\n所以小L想问他在最坏情况下最少需要几次比较，才能使序列有序。\n\n------\n\n[排序的模板代码](https://www.luogu.org/paste/fdtepscp)", "inputFormat": "输入仅有一行，给定一个正整数 $n$ ，表示序列的长度。", "outputFormat": "输出最小的比较次数，答案对$100000007$取模。", "hint": "- **样例$1$解释**\n\n长度为$4$的序列归并调用，分成$2$组，一组$2$个元素。$2$个元素分别比较一次， 合并时最坏比较$3$次，所以是$3+1+1=5。$\n\n- **数据范围**\n\n对于 $10\\%$ 的数据，$n\\leq10^{18}$；\n\n对于 $20\\%$ 的数据，$n\\leq10^{100}$；\n\n对于 $50\\%$ 的数据，$n\\leq10^{1000}$；\n\n对于 $80\\%$ 的数据，$n\\leq10^{10000}$；\n\n对于 $100\\%$ 的数据，$n\\leq10^{100000}$。\n\n**请注意时限**", "locale": "zh-CN", "translations": {"en": {"title": "Digital Sorting [Enhanced Version]", "background": "**This problem is an enhanced version of [P5626](https://www.luogu.org/problem/P5626).**\n\nXiao L has escaped from the virtual world!", "description": "While escaping, some digital beings also escaped. They are making a fuss and asking Xiao L to help sort them.\n\nThe digital beings in the virtual world are invisible.\n\nRight now, Xiao L only knows selection sort, insertion sort, bubble sort, and merge sort.\n\nSo Xiao L wants to ask: in the worst case, what is the minimum number of comparisons needed to make the sequence sorted?\n\n------\n\n[Template code for sorting](https://www.luogu.org/paste/fdtepscp)", "inputFormat": "The input has only one line: a positive integer $n$, the length of the sequence.", "outputFormat": "Output the minimum number of comparisons. Take the answer modulo $100000007$.", "hint": "- **Sample $1$ explanation.**\n\nFor a sequence of length $4$, merge sort splits it into $2$ groups, with $2$ elements in each group. The $2$ elements in each group are compared once. During merging, the worst-case number of comparisons is $3$, so the total is $3 + 1 + 1 = 5$.\n\n- **Constraints**\n\nFor $10\\%$ of the testdata, $n \\leq 10^{18}$.\n\nFor $20\\%$ of the testdata, $n \\leq 10^{100}$.\n\nFor $50\\%$ of the testdata, $n \\leq 10^{1000}$.\n\nFor $80\\%$ of the testdata, $n \\leq 10^{10000}$.\n\nFor $100\\%$ of the testdata, $n \\leq 10^{100000}$.\n\n**Please pay attention to the time limit.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "数码排序【加强版】", "background": "**本题是[P5626](https://www.luogu.org/problem/P5626)的加强版**\n\n小L从虚拟世界里出来啦！", "description": "逃出来的同时，也有一部分数码逃了出来，吵着闹着让小L帮他们排序。\n\n虚拟世界的数码都是不可见的。\n\n小L目前只会选择排序，插入排序，冒泡排序，归并排序。\n\n所以小L想问他在最坏情况下最少需要几次比较，才能使序列有序。\n\n------\n\n[排序的模板代码](https://www.luogu.org/paste/fdtepscp)", "inputFormat": "输入仅有一行，给定一个正整数 $n$ ，表示序列的长度。", "outputFormat": "输出最小的比较次数，答案对$100000007$取模。", "hint": "- **样例$1$解释**\n\n长度为$4$的序列归并调用，分成$2$组，一组$2$个元素。$2$个元素分别比较一次， 合并时最坏比较$3$次，所以是$3+1+1=5。$\n\n- **数据范围**\n\n对于 $10\\%$ 的数据，$n\\leq10^{18}$；\n\n对于 $20\\%$ 的数据，$n\\leq10^{100}$；\n\n对于 $50\\%$ 的数据，$n\\leq10^{1000}$；\n\n对于 $80\\%$ 的数据，$n\\leq10^{10000}$；\n\n对于 $100\\%$ 的数据，$n\\leq10^{100000}$。\n\n**请注意时限**", "locale": "zh-CN"}}}
{"pid": "P5635", "type": "P", "difficulty": 3, "samples": [["1 10\n1 3\n", "error"], ["1 10\n4 5\n", "1"]], "limits": {"time": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["模拟", "搜索", "记忆化搜索"], "title": "【CSGRound1】天下第一", "background": "天下第一的 cbw 以主席的身份在 8102 年统治全宇宙后，开始了自己休闲的生活，并邀请自己的好友每天都来和他做游戏。由于 cbw 想要显出自己平易近人，所以 zhouwc 虽然是一个蒟蒻，也有能和 cbw 玩游戏的机会。", "description": "游戏是这样的：\n\n给定两个数 $x$，$y$，与一个模数 $p$。\n\ncbw 拥有数 $x$，zhouwc 拥有数 $y$。\n\n第一个回合：$x\\leftarrow(x+y)\\bmod p$。\n\n第二个回合：$y\\leftarrow(x+y)\\bmod p$。\n\n第三个回合：$x\\leftarrow(x+y)\\bmod p$。\n\n第四个回合：$y\\leftarrow(x+y)\\bmod p$。\n\n以此类推....\n\n如果 $x$ 先到 $0$，则 cbw 胜利。如果 $y$ 先到 $0$，则 zhouwc 胜利。如果 $x,y$ 都不能到 $0$，则为平局。\n\ncbw 为了捍卫自己主席的尊严，想要提前知道游戏的结果，并且可以趁机动点手脚，所以他希望你来告诉他结果。", "inputFormat": "有多组数据。\n\n第一行：$T$ 和 $p$ 表示一共有 $T$ 组数据且模数都为 $p$。\n\n以下 $T$ 行，每行两个数 $x,y$。", "outputFormat": "共 $T$ 行\n\n$1$ 表示 cbw 获胜，$2$ 表示 zhouwc 获胜，```error``` 表示平局。", "hint": "$1 \\leq T \\leq 200$。\n\n$1 \\leq x,y,p \\leq 10000$。", "locale": "zh-CN", "translations": {"en": {"title": "[CSGRound1] The Best in the World", "background": "After cbw, the best in the world, ruled the entire universe as chairman in the year 8102, he began to live a relaxed life and invited his friends to play games with him every day. Since cbw wanted to appear approachable, zhouwc, although a “juruo” (weak player), also got the chance to play with cbw.", "description": "The game works as follows:\n\nGiven two numbers $x$, $y$, and a modulus $p$.\n\ncbw has the number $x$, and zhouwc has the number $y$.\n\nRound 1: $x\\leftarrow(x+y)\\bmod p$.\n\nRound 2: $y\\leftarrow(x+y)\\bmod p$.\n\nRound 3: $x\\leftarrow(x+y)\\bmod p$.\n\nRound 4: $y\\leftarrow(x+y)\\bmod p$.\n\nAnd so on...\n\nIf $x$ reaches $0$ first, then cbw wins. If $y$ reaches $0$ first, then zhouwc wins. If neither $x$ nor $y$ can reach $0$, then it is a draw.\n\nTo protect his dignity as chairman, cbw wants to know the result of the game in advance, and he can also take the chance to “do something” behind the scenes. Therefore, he hopes you can tell him the result.", "inputFormat": "There are multiple test cases.\n\nThe first line contains $T$ and $p$, meaning there are $T$ test cases in total, and the modulus for all of them is $p$.\n\nThe next $T$ lines each contain two numbers $x,y$.", "outputFormat": "Output $T$ lines in total.\n\n$1$ means cbw wins, $2$ means zhouwc wins, and ```error``` means a draw.", "hint": "$1 \\leq T \\leq 200$.\n\n$1 \\leq x,y,p \\leq 10000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【CSGRound1】天下第一", "background": "天下第一的 cbw 以主席的身份在 8102 年统治全宇宙后，开始了自己休闲的生活，并邀请自己的好友每天都来和他做游戏。由于 cbw 想要显出自己平易近人，所以 zhouwc 虽然是一个蒟蒻，也有能和 cbw 玩游戏的机会。", "description": "游戏是这样的：\n\n给定两个数 $x$，$y$，与一个模数 $p$。\n\ncbw 拥有数 $x$，zhouwc 拥有数 $y$。\n\n第一个回合：$x\\leftarrow(x+y)\\bmod p$。\n\n第二个回合：$y\\leftarrow(x+y)\\bmod p$。\n\n第三个回合：$x\\leftarrow(x+y)\\bmod p$。\n\n第四个回合：$y\\leftarrow(x+y)\\bmod p$。\n\n以此类推....\n\n如果 $x$ 先到 $0$，则 cbw 胜利。如果 $y$ 先到 $0$，则 zhouwc 胜利。如果 $x,y$ 都不能到 $0$，则为平局。\n\ncbw 为了捍卫自己主席的尊严，想要提前知道游戏的结果，并且可以趁机动点手脚，所以他希望你来告诉他结果。", "inputFormat": "有多组数据。\n\n第一行：$T$ 和 $p$ 表示一共有 $T$ 组数据且模数都为 $p$。\n\n以下 $T$ 行，每行两个数 $x,y$。", "outputFormat": "共 $T$ 行\n\n$1$ 表示 cbw 获胜，$2$ 表示 zhouwc 获胜，```error``` 表示平局。", "hint": "$1 \\leq T \\leq 200$。\n\n$1 \\leq x,y,p \\leq 10000$。", "locale": "zh-CN"}}}
{"pid": "P5637", "type": "P", "difficulty": 6, "samples": [["2 1\n1 2\n1", "0\n2"], ["10 2\n1 2\n2 3\n3 4\n4 5\n5 6\n6 7\n7 8\n8 9\n9 10\n2\n5", "3\n0\n3\n4\n0\n8\n10\n13\n14\n15"], ["10 2\n1 2\n1 3\n1 4\n1 5\n1 6\n1 7\n1 8\n1 9  \n1 10\n3\n6", "5\n5\n0\n5\n5\n0\n5\n5\n5\n5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "ckw的树", "background": "", "description": "ckw有一棵无根树，ckw会随意挑一个点然后开始随机游走，每一个单位时间会等概率跳到与当前点距离不超过$2$的任意一个点。树上有一些点被标记了，求ckw第一次到达被标记的点的期望时间。\n", "inputFormat": "第一行一个数$n$,$m$，表示点的个数和标记个数。\n\n接下来$n-1$行，每行两个数$x$,$y$，表示$x$和$y$之间有一条边。\n\n接下来$m$行，每行一个数表示被标记的点（可能有重复）\n", "outputFormat": "$n$行每行一个数，第$i$行的数表示从编号为$i$的点开始随机游走的期望步数$mod\\ 998244353$之后的值。\n", "hint": "$2 \\le n\\le 10^5,1\\le m \\le n$\n\n$subtask1(20pts):n\\le 300$\n\n$subtask2(16pts):$第$i$条边连接$i$和$i+1$\n\n$subtask3(8pts):$第$i$条边链接$1$和$i+1$\n\n$subtask4(20pts):n\\le 3000$，且最大点的度数不超过$4$\n\n$subtask5(36pts):$无限制", "locale": "zh-CN", "translations": {"en": {"title": "ckw's Tree", "background": "", "description": "ckw has an unrooted tree. ckw will randomly pick a node and then start a random walk. In each unit of time, they move with equal probability to any node whose distance from the current node is at most $2$. Some nodes on the tree are marked. Find the expected time for ckw to reach a marked node for the first time.", "inputFormat": "The first line contains two integers $n$, $m$, representing the number of nodes and the number of marks.\n\nThe next $n - 1$ lines each contain two integers $x$, $y$, indicating that there is an edge between $x$ and $y$.\n\nThe next $m$ lines each contain one integer, representing a marked node (duplicates may appear).", "outputFormat": "Output $n$ lines, one number per line. The number on line $i$ is the expected number of steps when starting the random walk from node $i$, taken modulo $998244353$.", "hint": "Constraints: $2 \\le n \\le 10^5$, $1 \\le m \\le n$.\n\nSubtask 1 (20 pts): $n \\le 300$.\n\nSubtask 2 (16 pts): The $i$-th edge connects $i$ and $i + 1$.\n\nSubtask 3 (8 pts): The $i$-th edge connects $1$ and $i + 1$.\n\nSubtask 4 (20 pts): $n \\le 3000$, and the maximum degree of any node is at most $4$.\n\nSubtask 5 (36 pts): No additional constraints.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "ckw的树", "background": "", "description": "ckw有一棵无根树，ckw会随意挑一个点然后开始随机游走，每一个单位时间会等概率跳到与当前点距离不超过$2$的任意一个点。树上有一些点被标记了，求ckw第一次到达被标记的点的期望时间。\n", "inputFormat": "第一行一个数$n$,$m$，表示点的个数和标记个数。\n\n接下来$n-1$行，每行两个数$x$,$y$，表示$x$和$y$之间有一条边。\n\n接下来$m$行，每行一个数表示被标记的点（可能有重复）\n", "outputFormat": "$n$行每行一个数，第$i$行的数表示从编号为$i$的点开始随机游走的期望步数$mod\\ 998244353$之后的值。\n", "hint": "$2 \\le n\\le 10^5,1\\le m \\le n$\n\n$subtask1(20pts):n\\le 300$\n\n$subtask2(16pts):$第$i$条边连接$i$和$i+1$\n\n$subtask3(8pts):$第$i$条边链接$1$和$i+1$\n\n$subtask4(20pts):n\\le 3000$，且最大点的度数不超过$4$\n\n$subtask5(36pts):$无限制", "locale": "zh-CN"}}}
{"pid": "P5638", "type": "P", "difficulty": 2, "samples": [["4 0\n1 2 3", "6"], ["4 1\n1 2 3", "3"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "前缀和", "洛谷月赛"], "title": "【CSGRound2】光骓者的荣耀", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/s6ozu5pj.png)\n\n小 K 又在做白日梦了。他进入到他的幻想中，发现他打下了一片江山。", "description": "小 K 打下的江山一共有 $n$ 个城市，城市 $i$ 和城市 $i+1$ 有一条双向高速公路连接，走这条路要耗费时间 $a_i$。\n\n小 K 为了关心人民生活，决定定期进行走访。他每一次会从 $1$ 号城市到 $n$ 号城市并在经过的城市进行访问。其中终点必须为城市 $n$。\n\n不仅如此，他还有一个传送器，传送半径为 $k$，也就是可以传送到 $i-k$ 和 $i+k$。如果目标城市编号小于 $1$ 则为 $1$，大于 $n$ 则为 $n$。\n\n但是他的传送器电量不足，只能传送一次，况且由于一些原因，他想尽量快的完成访问，于是就想问交通部部长您最快的时间是多少。\n\n注意：**他可以不访问所有的城市，使用传送器不耗费时间**。", "inputFormat": "两行，第一行两个正整数 $n,k$。\n\n第二行 $n-1$ 个整数，第 $i$ 个表示 $a_i$。", "outputFormat": "一个整数，表示答案。", "hint": "### 样例解释 1：\n\n样例 1,2 的图示均为以下图片：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/42z5mohh.png)\n\n不使用传送器直接走，答案为 $6$，可以证明这个是最小值。\n\n### 样例解释 2：\n\n在 $3$ 处使用，传送到 $4$，答案为 $3$，可以证明这个是最小值。\n\n### 数据范围：\n\n对于所有数据，$n\\ge 2$，$k\\ge 1$，$a_i > 0$。\n\n| 测试点编号 | $n$ 的范围 | $k$ 的范围 | $a_i$ 的范围 |\n|:-:|:-:|:-:|:-:|\n| $1\\sim 10$ | $\\le 100$ | $\\le 100$ | $\\le 10^5$ |\n| $11\\sim 20$ | $\\le 3\\times 10^3$ | $\\le 3\\times 10^3$ | $\\le 10^9$ |\n| $21$ | $\\le 10^5$ | $\\le 10^5$ | $\\le 10^{12}$ |\n| $22$ | $\\le 2\\times 10^5$ | $\\le 2\\times 10^5$ | $\\le 10^{12}$ |\n| $23$ | $\\le 5\\times 10^5$ | $\\le 5\\times 10^5$ | $\\le 10^{12}$ |\n| $24\\sim 25$ | $\\le 10^6$ | $\\le 10^6$ | $\\le 10^{12}$ |", "locale": "zh-CN", "translations": {"en": {"title": "[CSGRound2] Glory of the Light Steed Rider.", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/s6ozu5pj.png)\n\nLittle K is daydreaming again. He enters his fantasy world and finds that he has conquered a vast land.", "description": "The land that Little K has conquered contains a total of $n$ cities. City $i$ and city $i+1$ are connected by a two-way highway, and traveling along this road takes time $a_i$.\n\nIn order to care about the people’s lives, Little K decides to make regular visits. Each time, he will travel from city $1$ to city $n$ and visit the cities he passes through. The destination must be city $n$.\n\nMoreover, he has a teleporter with teleport radius $k$, meaning he can teleport to $i-k$ and $i+k$. If the target city index is less than $1$, it becomes $1$; if it is greater than $n$, it becomes $n$.\n\nHowever, his teleporter does not have enough power and can only be used once. Also, for some reason, he wants to finish the visits as quickly as possible, so he asks you, the Minister of Transportation, what the minimum time is.\n\nNote: **He does not need to visit all cities, and using the teleporter costs no time**.", "inputFormat": "Two lines. The first line contains two positive integers $n, k$.\n\nThe second line contains $n-1$ integers, where the $i$-th one denotes $a_i$.", "outputFormat": "One integer, indicating the answer.", "hint": "### Sample Explanation 1:\n\nThe illustrations for samples 1 and 2 are both the following image:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/42z5mohh.png)\n\nIf the teleporter is not used and you just walk directly, the answer is $6$. It can be proven that this is the minimum.\n\n### Sample Explanation 2:\n\nUse it at $3$ and teleport to $4$. The answer is $3$. It can be proven that this is the minimum.\n\n### Constraints:\n\nFor all testdata, $n \\ge 2$, $k \\ge 1$, $a_i > 0$.\n\n| Test Point ID | Range of $n$ | Range of $k$ | Range of $a_i$ |\n|:-:|:-:|:-:|:-:|\n| $1 \\sim 10$ | $\\le 100$ | $\\le 100$ | $\\le 10^5$ |\n| $11 \\sim 20$ | $\\le 3 \\times 10^3$ | $\\le 3 \\times 10^3$ | $\\le 10^9$ |\n| $21$ | $\\le 10^5$ | $\\le 10^5$ | $\\le 10^{12}$ |\n| $22$ | $\\le 2 \\times 10^5$ | $\\le 2 \\times 10^5$ | $\\le 10^{12}$ |\n| $23$ | $\\le 5 \\times 10^5$ | $\\le 5 \\times 10^5$ | $\\le 10^{12}$ |\n| $24 \\sim 25$ | $\\le 10^6$ | $\\le 10^6$ | $\\le 10^{12}$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【CSGRound2】光骓者的荣耀", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/s6ozu5pj.png)\n\n小 K 又在做白日梦了。他进入到他的幻想中，发现他打下了一片江山。", "description": "小 K 打下的江山一共有 $n$ 个城市，城市 $i$ 和城市 $i+1$ 有一条双向高速公路连接，走这条路要耗费时间 $a_i$。\n\n小 K 为了关心人民生活，决定定期进行走访。他每一次会从 $1$ 号城市到 $n$ 号城市并在经过的城市进行访问。其中终点必须为城市 $n$。\n\n不仅如此，他还有一个传送器，传送半径为 $k$，也就是可以传送到 $i-k$ 和 $i+k$。如果目标城市编号小于 $1$ 则为 $1$，大于 $n$ 则为 $n$。\n\n但是他的传送器电量不足，只能传送一次，况且由于一些原因，他想尽量快的完成访问，于是就想问交通部部长您最快的时间是多少。\n\n注意：**他可以不访问所有的城市，使用传送器不耗费时间**。", "inputFormat": "两行，第一行两个正整数 $n,k$。\n\n第二行 $n-1$ 个整数，第 $i$ 个表示 $a_i$。", "outputFormat": "一个整数，表示答案。", "hint": "### 样例解释 1：\n\n样例 1,2 的图示均为以下图片：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/42z5mohh.png)\n\n不使用传送器直接走，答案为 $6$，可以证明这个是最小值。\n\n### 样例解释 2：\n\n在 $3$ 处使用，传送到 $4$，答案为 $3$，可以证明这个是最小值。\n\n### 数据范围：\n\n对于所有数据，$n\\ge 2$，$k\\ge 1$，$a_i > 0$。\n\n| 测试点编号 | $n$ 的范围 | $k$ 的范围 | $a_i$ 的范围 |\n|:-:|:-:|:-:|:-:|\n| $1\\sim 10$ | $\\le 100$ | $\\le 100$ | $\\le 10^5$ |\n| $11\\sim 20$ | $\\le 3\\times 10^3$ | $\\le 3\\times 10^3$ | $\\le 10^9$ |\n| $21$ | $\\le 10^5$ | $\\le 10^5$ | $\\le 10^{12}$ |\n| $22$ | $\\le 2\\times 10^5$ | $\\le 2\\times 10^5$ | $\\le 10^{12}$ |\n| $23$ | $\\le 5\\times 10^5$ | $\\le 5\\times 10^5$ | $\\le 10^{12}$ |\n| $24\\sim 25$ | $\\le 10^6$ | $\\le 10^6$ | $\\le 10^{12}$ |", "locale": "zh-CN"}}}
{"pid": "P5639", "type": "P", "difficulty": 2, "samples": [["6\n0 0 1 1 0 1", "4"], ["6\n0 0 0 0 0 0", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "贪心", "洛谷原创", "洛谷月赛"], "title": "【CSGRound2】守序者的尊严", "background": "由于 Y 校最近进行了对学校食堂的全面改革与对小卖部的全面整治(乱搞)，导致学校小卖部卖的零食被禁售了；学校食堂的炸鸡窗口也消失了；\n\n并且学校的学生处 Q 主任严禁学生点外卖，日夜监察。\n\n都说民以食为天，由于整天挨饿，全校同学处于水深火热之中。", "description": "zhouwc 的朋友（朋友就是自己系列）小 Z 由于饥饿难忍，不得不铤而走险点外卖。\n\n但是学校的 Q 主任为了能够抓住点外卖的学生布置了天罗地网——监控。\n\n但是由于学校给 Q 主任的经费有限，所以这些监控不能持续工作，工作一秒之后便要暂停休息一秒，**即开启一秒后关闭一秒再开启一秒……以此类推**。\n\n还是由于 Q 主任的经费有限，这些监控被排成了一条直线，这条直线便在学生通往学生外卖驻点——二号门（没有门卫）的必经之路上。\n\n因为小 Z 修习了疾跑技能，所以小 Z 通过任意个数关闭的监控的时间均为 \n $1$（即一次行动可以经过若干个未开的监控）。\n\n由于小 Z 想吃外卖又不想受到正在监控室看着监控的 Q 主任的处分，请你告诉他至少要多少时间才能安全到达外卖驻点。", "inputFormat": "共 $2$ 行。\n\n第一行一个正整数 $n$，表示在这条路上一共有 $n$ 个监控。\n\n第二行共有 $n$ 个数。表示在第 $0$ 秒是这些监控的开关情况，$0$ 表示监控关闭，$1$ 表示监控开启，并保证第一个监控一定是关闭的。", "outputFormat": "共一行，表示小 Z 安全到达外卖驻点所需要的时间。", "hint": "#### 数据范围\n\n对于 $10\\%$ 的数据，$1 \\leq n \\leq 10$\n\n对于 $30\\%$ 的数据，$1 \\leq n \\leq 100$\n\n对于 $50\\%$ 的数据，$1 \\leq n \\leq 10^3$\n\n对于 $70\\%$ 的数据，$1 \\leq n \\leq 10^5$\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^6$\n\n监控的开关情况均用 $0$ 和 $1$ 来表示。\n\n#### 样例解释一\n\n小 Z 在第一秒时冲到第二个监控处，用时 $1$ 秒，总用时 $1$ 秒。\n\n第二秒时，监控的开关状况变为了 $1 1 0 0 1 0$。\n\n这时，小 Z 迅速从二号监控处冲到了四号监控处，用时 $1$ 秒，总用时 $2$ 秒。\n\n第三秒时，监控的开关状况变为了 $0\\ 0\\ 1\\ 1\\ 0\\ 1$。\n\n这时，小 Z 迅速从四号监控处冲到了五号监控处，用时 $1$ 秒，总用时 $3$ 秒。\n\n第四秒时，监控的开关状况变为了 $1\\ 1\\ 0\\ 0\\ 1\\ 0$。\n\n这时，小 Z 迅速从五号监控处冲出了监控区域，用时 $1$ 秒，总用时 $4$ 秒。\n\n#### 样例解释二\n\n小 Z 在第一秒直接冲出了监控区域。", "locale": "zh-CN", "translations": {"en": {"title": "[CSGRound2] The Dignity of the Lawful Ones", "background": "Because School Y recently carried out a full reform of the school cafeteria and a complete “cleanup” (messing around) of the school store, the snacks sold in the school store were banned; the fried chicken stall in the cafeteria also disappeared.\n\nAlso, Director Q from the Student Affairs Office strictly forbids students from ordering delivery, monitoring day and night.\n\nAs the saying goes, food is the first necessity of the people. Since they are hungry all day, students across the whole school are suffering badly.", "description": "Xiao Z, a friend of zhouwc (the “my friend is actually me” kind), cannot bear the hunger and has to take the risk of ordering delivery.\n\nHowever, to catch students who order delivery, Director Q set up a tight net—cameras.\n\nBut because the school’s budget for Director Q is limited, these cameras cannot work continuously. After working for one second, they must stop and rest for one second, **that is, after being on for one second, they turn off for one second, then on for one second... and so on**.\n\nAlso due to limited budget, these cameras are arranged in a straight line, which lies on the only path students must take to reach the delivery pickup point—the Gate 2 (with no guard).\n\nBecause Xiao Z has learned a sprint skill, the time for him to pass through any number of cameras that are turned off is $1$ (that is, in one move he can pass through several cameras that are not on).\n\nSince Xiao Z wants to eat delivery food but does not want to be punished by Director Q watching in the control room, please tell him the minimum time needed to safely reach the pickup point.", "inputFormat": "There are $2$ lines in total.\n\nThe first line contains a positive integer $n$, meaning there are $n$ cameras on this road.\n\nThe second line contains $n$ numbers, representing the on/off states of these cameras at time $0$ seconds. $0$ means a camera is off, and $1$ means it is on. It is guaranteed that the first camera is off.", "outputFormat": "Output one line, the time required for Xiao Z to safely reach the delivery pickup point.", "hint": "#### Constraints\n\nFor $10\\%$ of the testdata, $1 \\leq n \\leq 10$.\n\nFor $30\\%$ of the testdata, $1 \\leq n \\leq 100$.\n\nFor $50\\%$ of the testdata, $1 \\leq n \\leq 10^3$.\n\nFor $70\\%$ of the testdata, $1 \\leq n \\leq 10^5$.\n\nFor $100\\%$ of the testdata, $1 \\leq n \\leq 10^6$.\n\nThe camera states are all represented using $0$ and $1$.\n\n#### Sample Explanation 1\n\nIn the first second, Xiao Z rushes to the second camera, taking $1$ second, for a total time of $1$ second.\n\nIn the second second, the camera states become $1\\ 1\\ 0\\ 0\\ 1\\ 0$.\n\nAt this time, Xiao Z quickly rushes from the second camera to the fourth camera, taking $1$ second, for a total time of $2$ seconds.\n\nIn the third second, the camera states become $0\\ 0\\ 1\\ 1\\ 0\\ 1$.\n\nAt this time, Xiao Z quickly rushes from the fourth camera to the fifth camera, taking $1$ second, for a total time of $3$ seconds.\n\nIn the fourth second, the camera states become $1\\ 1\\ 0\\ 0\\ 1\\ 0$.\n\nAt this time, Xiao Z quickly rushes from the fifth camera and leaves the monitored area, taking $1$ second, for a total time of $4$ seconds.\n\n#### Sample Explanation 2\n\nIn the first second, Xiao Z rushes out of the monitored area directly.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【CSGRound2】守序者的尊严", "background": "由于 Y 校最近进行了对学校食堂的全面改革与对小卖部的全面整治(乱搞)，导致学校小卖部卖的零食被禁售了；学校食堂的炸鸡窗口也消失了；\n\n并且学校的学生处 Q 主任严禁学生点外卖，日夜监察。\n\n都说民以食为天，由于整天挨饿，全校同学处于水深火热之中。", "description": "zhouwc 的朋友（朋友就是自己系列）小 Z 由于饥饿难忍，不得不铤而走险点外卖。\n\n但是学校的 Q 主任为了能够抓住点外卖的学生布置了天罗地网——监控。\n\n但是由于学校给 Q 主任的经费有限，所以这些监控不能持续工作，工作一秒之后便要暂停休息一秒，**即开启一秒后关闭一秒再开启一秒……以此类推**。\n\n还是由于 Q 主任的经费有限，这些监控被排成了一条直线，这条直线便在学生通往学生外卖驻点——二号门（没有门卫）的必经之路上。\n\n因为小 Z 修习了疾跑技能，所以小 Z 通过任意个数关闭的监控的时间均为 \n $1$（即一次行动可以经过若干个未开的监控）。\n\n由于小 Z 想吃外卖又不想受到正在监控室看着监控的 Q 主任的处分，请你告诉他至少要多少时间才能安全到达外卖驻点。", "inputFormat": "共 $2$ 行。\n\n第一行一个正整数 $n$，表示在这条路上一共有 $n$ 个监控。\n\n第二行共有 $n$ 个数。表示在第 $0$ 秒是这些监控的开关情况，$0$ 表示监控关闭，$1$ 表示监控开启，并保证第一个监控一定是关闭的。", "outputFormat": "共一行，表示小 Z 安全到达外卖驻点所需要的时间。", "hint": "#### 数据范围\n\n对于 $10\\%$ 的数据，$1 \\leq n \\leq 10$\n\n对于 $30\\%$ 的数据，$1 \\leq n \\leq 100$\n\n对于 $50\\%$ 的数据，$1 \\leq n \\leq 10^3$\n\n对于 $70\\%$ 的数据，$1 \\leq n \\leq 10^5$\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^6$\n\n监控的开关情况均用 $0$ 和 $1$ 来表示。\n\n#### 样例解释一\n\n小 Z 在第一秒时冲到第二个监控处，用时 $1$ 秒，总用时 $1$ 秒。\n\n第二秒时，监控的开关状况变为了 $1 1 0 0 1 0$。\n\n这时，小 Z 迅速从二号监控处冲到了四号监控处，用时 $1$ 秒，总用时 $2$ 秒。\n\n第三秒时，监控的开关状况变为了 $0\\ 0\\ 1\\ 1\\ 0\\ 1$。\n\n这时，小 Z 迅速从四号监控处冲到了五号监控处，用时 $1$ 秒，总用时 $3$ 秒。\n\n第四秒时，监控的开关状况变为了 $1\\ 1\\ 0\\ 0\\ 1\\ 0$。\n\n这时，小 Z 迅速从五号监控处冲出了监控区域，用时 $1$ 秒，总用时 $4$ 秒。\n\n#### 样例解释二\n\n小 Z 在第一秒直接冲出了监控区域。", "locale": "zh-CN"}}}
{"pid": "P5640", "type": "P", "difficulty": 5, "samples": [["10 3\n1 2 3 1 2 3 2 3 2 3\n0 1\n1 2\n0 3", "0\n1\n1"]], "limits": {"time": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "位运算", "洛谷月赛", "状压 DP"], "title": "【CSGRound2】逐梦者的初心", "background": "#### 注意：本题时限修改至250ms，并且数据进行大幅度加强。本题强制开启O2优化，并且不再重测，请大家自己重新提交。\n\n由于Y校的老师非常毒瘤，要求zhouwc在csp考前最后3天参加期中考，zhouwc非常生气，决定消极考试，以涂完卡但全错为目标。现在retcarizy看zhouwc太可怜了，想要帮zhouwc解决一个问题，但他自己又太忙了，咕咕咕，于是就把问题甩给了你。", "description": "给你一个长度为n的字符串S。\n\n有m个操作，保证$m\\le n$。\n\n你还有一个字符串T，刚开始为空。\n\n共有两种操作。\n\n第一种操作：\n\n在字符串T的末尾加上一个字符。\n\n第二种操作：\n\n在字符串T的开头加上一个字符。\n\n每次操作完成后要求输出有几个$l \\in [1,T.size]$满足以下条件：\n\n对于$\\forall i \\in [1,l]$有$T_{T.size-l+i} \\ne S_{i}$ \n\n$Tip:$字符串下标从1开始。$T.size$表示T的长度。", "inputFormat": "第一行两个正整数$n,m$。\n\n第二行n个正整数，用空格隔开，第$i$个整数表示$S_i$。\n\n接下来$m$行，每行两个数字$opt,ch$，$opt=0$表示在T的末尾加一个字符$ch$,$opt=1$表示在T的开头加一个字符$ch$。", "outputFormat": "共$m$行，每行一个非负整数表示第m操作后的输出。", "hint": "注意：本题采用**捆绑测试**，只有当你通过一个subtask的所有点后，你才能拿到这个subtask的分数\n\n对于所有的数据 $n \\leq 10^6,m \\leq 3.3333 \\times 10^4,|\\sum|\\leq10^3,S_i \\in [1,|\\sum|]$。($\\sum$表示字符集)\n\nsubtask1$(17\\%)$:$m \\leq 333$\n\nsubtask2$(33\\%)$:$m \\leq 3333$\n\nsubtask3$(20\\%)$:$|\\sum|\\leq2$\n\nsubtask4$(30\\%)$:无特殊条件\n\n\n#### 样例解释：\n第一次操作后，$T=\"1\"$,\n\n$l=1$时$T[1]=S[1]$，所以答案为0\n\n第二次操作后，$T=\"21\"$,\n\n$l=1$时，$T[2]=S[1]$\n\n$l=2$时，$T[1]!=S[1]$,$T[2]!=S[2]$所以答案为1\n\n第三次操作后，$T=\"213\"$,\n\n$l=1$时，$T[3]!=S[1]$;\n\n$l=2$时，$T[2]=S[1]$;\n\n$l=3$时，$T[3]=S[3]$所以答案为1\n", "locale": "zh-CN", "translations": {"en": {"title": "[CSGRound2] The Dream Chaser’s Original Aspiration.", "background": "#### Note: The time limit for this problem has been changed to 250 ms, and the testdata has been greatly strengthened. This problem forces O2 optimization, and there will be no rejudge. Please resubmit by yourselves.\n\nBecause the teachers at School Y are very “toxic”, they required zhouwc to take the midterm exam during the last 3 days before the CSP exam. zhouwc was very angry and decided to do badly on purpose, aiming to finish filling the answer sheet but get everything wrong. Now retcarizy feels zhouwc is too pitiful and wants to help zhouwc solve a problem, but he is too busy, gugugu, so he threw the problem to you.", "description": "You are given a string $S$ of length $n$.\n\nThere are $m$ operations, and it is guaranteed that $m \\le n$.\n\nYou also have a string $T$, which is empty at the beginning.\n\nThere are two types of operations.\n\nThe first type of operation:\n\nAppend one character to the end of string $T$.\n\nThe second type of operation:\n\nPrepend one character to the beginning of string $T$.\n\nAfter each operation, you need to output how many $l \\in [1,T.size]$ satisfy the following condition:\n\nFor $\\forall i \\in [1,l]$, we have $T_{T.size-l+i} \\ne S_{i}$.\n\n$Tip:$ String indices start from 1. $T.size$ denotes the length of $T$.", "inputFormat": "The first line contains two positive integers $n,m$.\n\nThe second line contains $n$ positive integers separated by spaces. The $i$-th integer represents $S_i$.\n\nNext, there are $m$ lines, each containing two numbers $opt,ch$. $opt=0$ means appending a character $ch$ to the end of $T$, and $opt=1$ means prepending a character $ch$ to the beginning of $T$.", "outputFormat": "Output $m$ lines. Each line contains one non-negative integer representing the answer after the $m$-th operation.", "hint": "Note: This problem uses **bundled tests**. You can get the score of a subtask only after you pass all test points of that subtask.\n\nFor all testdata, $n \\leq 10^6,m \\leq 3.3333 \\times 10^4,|\\sum|\\leq10^3,S_i \\in [1,|\\sum|]$. ($\\sum$ denotes the alphabet)\n\nsubtask 1 $(17\\%)$: $m \\leq 333$.\n\nsubtask 2 $(33\\%)$: $m \\leq 3333$.\n\nsubtask 3 $(20\\%)$: $|\\sum|\\leq2$.\n\nsubtask 4 $(30\\%)$: no special constraints.\n\n#### Sample Explanation:\nAfter the first operation, $T=\"1\"$.\n\nWhen $l=1$, $T[1]=S[1]$, so the answer is 0.\n\nAfter the second operation, $T=\"21\"$.\n\nWhen $l=1$, $T[2]=S[1]$.\n\nWhen $l=2$, $T[1]!=S[1]$, $T[2]!=S[2]$, so the answer is 1.\n\nAfter the third operation, $T=\"213\"$.\n\nWhen $l=1$, $T[3]!=S[1]$.\n\nWhen $l=2$, $T[2]=S[1]$.\n\nWhen $l=3$, $T[3]=S[3]$, so the answer is 1.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【CSGRound2】逐梦者的初心", "background": "#### 注意：本题时限修改至250ms，并且数据进行大幅度加强。本题强制开启O2优化，并且不再重测，请大家自己重新提交。\n\n由于Y校的老师非常毒瘤，要求zhouwc在csp考前最后3天参加期中考，zhouwc非常生气，决定消极考试，以涂完卡但全错为目标。现在retcarizy看zhouwc太可怜了，想要帮zhouwc解决一个问题，但他自己又太忙了，咕咕咕，于是就把问题甩给了你。", "description": "给你一个长度为n的字符串S。\n\n有m个操作，保证$m\\le n$。\n\n你还有一个字符串T，刚开始为空。\n\n共有两种操作。\n\n第一种操作：\n\n在字符串T的末尾加上一个字符。\n\n第二种操作：\n\n在字符串T的开头加上一个字符。\n\n每次操作完成后要求输出有几个$l \\in [1,T.size]$满足以下条件：\n\n对于$\\forall i \\in [1,l]$有$T_{T.size-l+i} \\ne S_{i}$ \n\n$Tip:$字符串下标从1开始。$T.size$表示T的长度。", "inputFormat": "第一行两个正整数$n,m$。\n\n第二行n个正整数，用空格隔开，第$i$个整数表示$S_i$。\n\n接下来$m$行，每行两个数字$opt,ch$，$opt=0$表示在T的末尾加一个字符$ch$,$opt=1$表示在T的开头加一个字符$ch$。", "outputFormat": "共$m$行，每行一个非负整数表示第m操作后的输出。", "hint": "注意：本题采用**捆绑测试**，只有当你通过一个subtask的所有点后，你才能拿到这个subtask的分数\n\n对于所有的数据 $n \\leq 10^6,m \\leq 3.3333 \\times 10^4,|\\sum|\\leq10^3,S_i \\in [1,|\\sum|]$。($\\sum$表示字符集)\n\nsubtask1$(17\\%)$:$m \\leq 333$\n\nsubtask2$(33\\%)$:$m \\leq 3333$\n\nsubtask3$(20\\%)$:$|\\sum|\\leq2$\n\nsubtask4$(30\\%)$:无特殊条件\n\n\n#### 样例解释：\n第一次操作后，$T=\"1\"$,\n\n$l=1$时$T[1]=S[1]$，所以答案为0\n\n第二次操作后，$T=\"21\"$,\n\n$l=1$时，$T[2]=S[1]$\n\n$l=2$时，$T[1]!=S[1]$,$T[2]!=S[2]$所以答案为1\n\n第三次操作后，$T=\"213\"$,\n\n$l=1$时，$T[3]!=S[1]$;\n\n$l=2$时，$T[2]=S[1]$;\n\n$l=3$时，$T[3]=S[3]$所以答案为1\n", "locale": "zh-CN"}}}
{"pid": "P5641", "type": "P", "difficulty": 6, "samples": [["3 1\n1 2 3", "1 3 6"], ["3 2\n1 2 3", "1 6 20"], ["3 10\n1 2 3", "1 30 420"]], "limits": {"time": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "快速傅里叶变换 FFT", "快速数论变换 NTT", "洛谷月赛"], "title": "【CSGRound2】开拓者的卓识", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/s6ozu5pj.png)\n\n（上图转载于某神仙的题目描述）\n\n小 K 又在做白日梦了。他进入到他的幻想中，发现了一个非常有趣的序列$a$和一个非常有趣的数$k$。", "description": "我们记一个序列 $[l,r]$ 的 $k$ 阶子段和为 $sum_{k,l,r}$，有\n\n$$sum_{k,l,r}=\\begin{cases}\\sum\\limits_{i=l}^{r}a_i&,k=1\\\\\\sum\\limits_{i=l}^{r}\\sum\\limits_{j=i}^{r}sum_{k-1,i,j}&,k\\geq 2\\end{cases}$$\n\n他现在站在位置 $1$ 上，他每一次往右开拓一个格子就可以增加他 IOI 赛场的 rp，所以他想尽可能的多开拓格子。可是每一次他从 $r$ 开拓到 $r+1$ 需要正确的回答 $sum_{k,1,r}$。小 K 不屑于算，就把任务交给你了。", "inputFormat": "两行。第一行 $n,k$，表示 $a$ 的长度和 $k$。\n\n第二行 $n$ 个正整数，表示 $a$。", "outputFormat": "一行，第 $i$ 个数为 $sum_{k,1,i}$。由于答案过大，您只需要求出答案对 $998244353$ 取模的值。", "hint": "### 样例解释 2\n\n$sum_{2,1,1}=sum_{1,1,1}=1$\n\n$sum_{2,1,2}=sum_{1,1,1}+sum_{1,1,2}+sum_{1,2,2}=1+3+2=6$\n\n$sum_{2,1,3}=sum_{1,1,1}+sum_{1,1,2}+sum_{1,1,3}+sum_{1,2,2}+sum_{1,2,3}+sum_{1,3,3}=1+3+6+2+5+3=20$\n\n### 数据范围\n\n| 测试点编号 |  $n$ 的范围 |  $k$ 的范围 |  $a_i$ 的范围 |\n| :-: | :-: | :-: | :-: |\n|  $1\\sim 2$ |  $\\le 10$ |  $\\le 10$ |  $\\le 10$ |\n|  $3\\sim 8$ |  $\\le 10^3$ |  $\\le 10^3$ |  $\\le 10^5$ |\n|  $9$ |  $\\le 10^5$ |  $=1$ |  $\\le 998244353$ | \n|  $10$ |  $\\le 10^5$ |  $=2$ |  $\\le 998244353$ |\n|  $11$ |  $\\le 10^5$ |  $=3$ |  $\\le 998244353$ |\n|  $12$ |  $\\le 10^5$ |  $\\le 10$ |  $\\le 998244353$ |\n|  $13\\sim 17$ |  $\\le 10^5$ |  $\\le 10^2$ |  $\\le 998244353$ |\n|  $18$ |  $\\le 10^5$ |  $\\le 10^5$ |  $\\le 998244353$ |\n|  $19\\sim 25$ |  $\\le 10^5$ |  $\\le 998244353$ |  $\\le 998244353$ |", "locale": "zh-CN", "translations": {"en": {"title": "[CSGRound2] The Pioneer’s Insight.", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/s6ozu5pj.png)\n\n(The picture above is reposted from a certain expert’s problem statement.)\n\nLittle K is daydreaming again. In his fantasy, he found a very interesting sequence $a$ and a very interesting number $k$.", "description": "For a sequence interval $[l,r]$, we define its $k$-th order subsegment sum as $sum_{k,l,r}$, where\n\n$$sum_{k,l,r}=\\begin{cases}\\sum\\limits_{i=l}^{r}a_i&,k=1\\\\\\sum\\limits_{i=l}^{r}\\sum\\limits_{j=i}^{r}sum_{k-1,i,j}&,k\\geq 2\\end{cases}$$\n\nHe is now standing at position $1$. Each time he expands one cell to the right, he can increase his rp on the IOI contest field, so he wants to expand as many cells as possible. However, every time he expands from $r$ to $r+1$, he needs to correctly answer $sum_{k,1,r}$. Little K cannot be bothered to calculate it, so he leaves the task to you.", "inputFormat": "Two lines. The first line contains $n,k$, representing the length of $a$ and $k$.\n\nThe second line contains $n$ positive integers, representing $a$.", "outputFormat": "One line. The $i$-th number is $sum_{k,1,i}$. Since the answer is too large, you only need to output the value modulo $998244353$.", "hint": "### Sample Explanation 2\n\n$sum_{2,1,1}=sum_{1,1,1}=1$\n\n$sum_{2,1,2}=sum_{1,1,1}+sum_{1,1,2}+sum_{1,2,2}=1+3+2=6$\n\n$sum_{2,1,3}=sum_{1,1,1}+sum_{1,1,2}+sum_{1,1,3}+sum_{1,2,2}+sum_{1,2,3}+sum_{1,3,3}=1+3+6+2+5+3=20$\n\n### Constraints\n\n| Test Point ID |  Range of $n$ |  Range of $k$ |  Range of $a_i$ |\n| :-: | :-: | :-: | :-: |\n|  $1\\sim 2$ |  $\\le 10$ |  $\\le 10$ |  $\\le 10$ |\n|  $3\\sim 8$ |  $\\le 10^3$ |  $\\le 10^3$ |  $\\le 10^5$ |\n|  $9$ |  $\\le 10^5$ |  $=1$ |  $\\le 998244353$ | \n|  $10$ |  $\\le 10^5$ |  $=2$ |  $\\le 998244353$ |\n|  $11$ |  $\\le 10^5$ |  $=3$ |  $\\le 998244353$ |\n|  $12$ |  $\\le 10^5$ |  $\\le 10$ |  $\\le 998244353$ |\n|  $13\\sim 17$ |  $\\le 10^5$ |  $\\le 10^2$ |  $\\le 998244353$ |\n|  $18$ |  $\\le 10^5$ |  $\\le 10^5$ |  $\\le 998244353$ |\n|  $19\\sim 25$ |  $\\le 10^5$ |  $\\le 998244353$ |  $\\le 998244353$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【CSGRound2】开拓者的卓识", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/s6ozu5pj.png)\n\n（上图转载于某神仙的题目描述）\n\n小 K 又在做白日梦了。他进入到他的幻想中，发现了一个非常有趣的序列$a$和一个非常有趣的数$k$。", "description": "我们记一个序列 $[l,r]$ 的 $k$ 阶子段和为 $sum_{k,l,r}$，有\n\n$$sum_{k,l,r}=\\begin{cases}\\sum\\limits_{i=l}^{r}a_i&,k=1\\\\\\sum\\limits_{i=l}^{r}\\sum\\limits_{j=i}^{r}sum_{k-1,i,j}&,k\\geq 2\\end{cases}$$\n\n他现在站在位置 $1$ 上，他每一次往右开拓一个格子就可以增加他 IOI 赛场的 rp，所以他想尽可能的多开拓格子。可是每一次他从 $r$ 开拓到 $r+1$ 需要正确的回答 $sum_{k,1,r}$。小 K 不屑于算，就把任务交给你了。", "inputFormat": "两行。第一行 $n,k$，表示 $a$ 的长度和 $k$。\n\n第二行 $n$ 个正整数，表示 $a$。", "outputFormat": "一行，第 $i$ 个数为 $sum_{k,1,i}$。由于答案过大，您只需要求出答案对 $998244353$ 取模的值。", "hint": "### 样例解释 2\n\n$sum_{2,1,1}=sum_{1,1,1}=1$\n\n$sum_{2,1,2}=sum_{1,1,1}+sum_{1,1,2}+sum_{1,2,2}=1+3+2=6$\n\n$sum_{2,1,3}=sum_{1,1,1}+sum_{1,1,2}+sum_{1,1,3}+sum_{1,2,2}+sum_{1,2,3}+sum_{1,3,3}=1+3+6+2+5+3=20$\n\n### 数据范围\n\n| 测试点编号 |  $n$ 的范围 |  $k$ 的范围 |  $a_i$ 的范围 |\n| :-: | :-: | :-: | :-: |\n|  $1\\sim 2$ |  $\\le 10$ |  $\\le 10$ |  $\\le 10$ |\n|  $3\\sim 8$ |  $\\le 10^3$ |  $\\le 10^3$ |  $\\le 10^5$ |\n|  $9$ |  $\\le 10^5$ |  $=1$ |  $\\le 998244353$ | \n|  $10$ |  $\\le 10^5$ |  $=2$ |  $\\le 998244353$ |\n|  $11$ |  $\\le 10^5$ |  $=3$ |  $\\le 998244353$ |\n|  $12$ |  $\\le 10^5$ |  $\\le 10$ |  $\\le 998244353$ |\n|  $13\\sim 17$ |  $\\le 10^5$ |  $\\le 10^2$ |  $\\le 998244353$ |\n|  $18$ |  $\\le 10^5$ |  $\\le 10^5$ |  $\\le 998244353$ |\n|  $19\\sim 25$ |  $\\le 10^5$ |  $\\le 998244353$ |  $\\le 998244353$ |", "locale": "zh-CN"}}}
{"pid": "P5642", "type": "P", "difficulty": 7, "samples": [["4 4\n1 2\n1 3\n1 4\n1 2 1\n3 3 2\n1 4 3\n2 4 6", "100"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 6000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "树链剖分"], "title": "人造情感（emotion）", "background": "```\n“这个任务永远无法完成。我不会再重复同样的错误。”\n\n“懂得了爱与情感的他，早已经不是机器人了……从这个角度上看，3000A 就是你的儿子，霍星。”\n\n  永别，3000A！《魔角侦探》\n```\n", "description": "给你一颗 $n$ 个节点的树，以及 $m$ 条路径 $(u, v, w)$，其中 $w$ 可以认为是 $(u, v)$ 这题路径被标记的一个权值。一个路径集合 $S$ 的重量 $W(S)$ 记为：找出 $S$ 的一个权值之和最大的子集，该子集满足任何两条路径没有公共点，这个子集的所有路径权值之和就是 $W(S)$。\n\n记 $f(u, v) = w$ 为最小的非负整数 $w$，使得对于给定的 $m$ 条边组成的路径集合 $U$，$W(U \\cup \\{(u, v, w + 1)\\}) > W(U)$ 。\n\n请你计算下式，对 $998244353$ 取模。\n\n$$ \\sum_{u=1}^n \\sum_{v=1}^n f(u, v) $$\n", "inputFormat": "第一行输入两个整数 $n, m$，表示树的节点数量以及给出的路径数量。\n\n接下来 $n-1$ 行，每行输入两个整数 $u, v$ 表示树的一条边。\n\n接下来 $m$ 行，每行输入三个整数 $u, v, w$，表示在集合中加入这条 $u, v$ 为端点的路径以及其权值。", "outputFormat": "输出一个整数表示答案。", "hint": "#### 样例 1 解释\n\n$f(1, 1) = 6, f(1, 2) = 6, f(1, 3) = 8, f(1, 4) = 6$  \n$f(2, 1) = 6, f(2, 2) = 3, f(2, 3) = 8, f(2, 4) = 6$  \n$f(3, 1) = 8, f(3, 2) = 8, f(3, 3) = 2, f(3, 4) = 8$  \n$f(4, 1) = 6, f(4, 2) = 6, f(4, 3) = 8, f(4, 4) = 5$  \n\n#### 数据范围\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 3\\times 10^5, 0\\le m\\le 3\\times 10^5, 1\\le w\\le 10^9$。\n\n|   测试点   |     $n,m$      |             特殊性质              |\n| :--------: | :------------: | :-------------------------------: |\n|   $1,2$    |     $=10$      |                                   |\n|    $3$     |     $=40$      |                                   |\n|    $4$     |     $=150$     |                                   |\n|   $5,6$    |     $=350$     |                                   |\n|   $7,8$    |    $=1,500$    |                                   |\n|   $9,10$    |    $=3,499$    |                           树的结构 $v=u+1$   |\n|   $11,12$   |    $=3,500$    |                                   |\n|  $13,14$   |   $=99,995$    |         给出的路径 $u=v$          |\n| $15,16$ |   $=99,996$    |         给出的路径 $w=1$          |\n|  $17,18$   |   $=99,997$    |         树的结构 $v=u+1$          |\n|  $19,20$   |   $=99,998$    |          树的结构 $u=1$           |\n| $21,22,23$ |   $=99,999$    | 树的结构 $u = \\lfloor v/2\\rfloor$ |\n|    $24$    |    $=10^5$     |                                   |\n|    $25$    | $=3\\times10^5$ |                                   |\n", "locale": "zh-CN", "translations": {"en": {"title": "Artificial Emotions (emotion)", "background": "```\n“This task can never be completed. I will not repeat the same mistake again.”\n\n“Having learned love and emotions, he is no longer a robot... From this point of view, 3000A is your son, Huo Xing.”\n\nFarewell, 3000A! Detective Magic Horn\n```", "description": "You are given a tree with $n$ nodes, and $m$ paths $(u, v, w)$, where $w$ can be regarded as the weight assigned to the path $(u, v)$. For a set of paths $S$, its weight $W(S)$ is defined as follows: find a subset of $S$ with the maximum possible sum of weights, such that no two paths in this subset share a common vertex. The sum of weights of all paths in this subset is $W(S)$.\n\nDefine $f(u, v) = w$ as the smallest non-negative integer $w$ such that, for the path set $U$ formed by the given $m$ paths, we have $W(U \\cup \\{(u, v, w + 1)\\}) > W(U)$.\n\nCompute the following expression modulo $998244353$:\n\n$$ \\sum_{u=1}^n \\sum_{v=1}^n f(u, v) $$", "inputFormat": "The first line contains two integers $n, m$, representing the number of nodes in the tree and the number of given paths.\n\nThe next $n - 1$ lines each contain two integers $u, v$, describing an edge of the tree.\n\nThe next $m$ lines each contain three integers $u, v, w$, meaning that a path with endpoints $u, v$ and weight $w$ is added into the set.", "outputFormat": "Output one integer, the answer.", "hint": "#### Sample 1 Explanation\n\n$f(1, 1) = 6, f(1, 2) = 6, f(1, 3) = 8, f(1, 4) = 6$  \n$f(2, 1) = 6, f(2, 2) = 3, f(2, 3) = 8, f(2, 4) = 6$  \n$f(3, 1) = 8, f(3, 2) = 8, f(3, 3) = 2, f(3, 4) = 8$  \n$f(4, 1) = 6, f(4, 2) = 6, f(4, 3) = 8, f(4, 4) = 5$  \n\n#### Constraints\n\nFor $100\\%$ of the testdata, it is guaranteed that $1 \\le n \\le 3\\times 10^5$, $0 \\le m \\le 3\\times 10^5$, and $1 \\le w \\le 10^9$.\n\n| Test Point |     $n, m$     |           Special Property            |\n| :--------: | :------------: | :-----------------------------------: |\n|   $1,2$    |     $=10$      |                                       |\n|    $3$     |     $=40$      |                                       |\n|    $4$     |     $=150$     |                                       |\n|   $5,6$    |     $=350$     |                                       |\n|   $7,8$    |    $=1,500$    |                                       |\n|   $9,10$   |    $=3,499$    |        Tree structure $v=u+1$         |\n|  $11,12$   |    $=3,500$    |                                       |\n|  $13,14$   |   $=99,995$    |           Given paths $u=v$           |\n|  $15,16$   |   $=99,996$    |           Given paths $w=1$           |\n|  $17,18$   |   $=99,997$    |        Tree structure $v=u+1$         |\n|  $19,20$   |   $=99,998$    |          Tree structure $u=1$         |\n| $21,22,23$ |   $=99,999$    | Tree structure $u = \\lfloor v/2\\rfloor$ |\n|    $24$    |    $=10^5$     |                                       |\n|    $25$    | $=3\\times10^5$ |                                       |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "人造情感（emotion）", "background": "```\n“这个任务永远无法完成。我不会再重复同样的错误。”\n\n“懂得了爱与情感的他，早已经不是机器人了……从这个角度上看，3000A 就是你的儿子，霍星。”\n\n  永别，3000A！《魔角侦探》\n```\n", "description": "给你一颗 $n$ 个节点的树，以及 $m$ 条路径 $(u, v, w)$，其中 $w$ 可以认为是 $(u, v)$ 这题路径被标记的一个权值。一个路径集合 $S$ 的重量 $W(S)$ 记为：找出 $S$ 的一个权值之和最大的子集，该子集满足任何两条路径没有公共点，这个子集的所有路径权值之和就是 $W(S)$。\n\n记 $f(u, v) = w$ 为最小的非负整数 $w$，使得对于给定的 $m$ 条边组成的路径集合 $U$，$W(U \\cup \\{(u, v, w + 1)\\}) > W(U)$ 。\n\n请你计算下式，对 $998244353$ 取模。\n\n$$ \\sum_{u=1}^n \\sum_{v=1}^n f(u, v) $$\n", "inputFormat": "第一行输入两个整数 $n, m$，表示树的节点数量以及给出的路径数量。\n\n接下来 $n-1$ 行，每行输入两个整数 $u, v$ 表示树的一条边。\n\n接下来 $m$ 行，每行输入三个整数 $u, v, w$，表示在集合中加入这条 $u, v$ 为端点的路径以及其权值。", "outputFormat": "输出一个整数表示答案。", "hint": "#### 样例 1 解释\n\n$f(1, 1) = 6, f(1, 2) = 6, f(1, 3) = 8, f(1, 4) = 6$  \n$f(2, 1) = 6, f(2, 2) = 3, f(2, 3) = 8, f(2, 4) = 6$  \n$f(3, 1) = 8, f(3, 2) = 8, f(3, 3) = 2, f(3, 4) = 8$  \n$f(4, 1) = 6, f(4, 2) = 6, f(4, 3) = 8, f(4, 4) = 5$  \n\n#### 数据范围\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 3\\times 10^5, 0\\le m\\le 3\\times 10^5, 1\\le w\\le 10^9$。\n\n|   测试点   |     $n,m$      |             特殊性质              |\n| :--------: | :------------: | :-------------------------------: |\n|   $1,2$    |     $=10$      |                                   |\n|    $3$     |     $=40$      |                                   |\n|    $4$     |     $=150$     |                                   |\n|   $5,6$    |     $=350$     |                                   |\n|   $7,8$    |    $=1,500$    |                                   |\n|   $9,10$    |    $=3,499$    |                           树的结构 $v=u+1$   |\n|   $11,12$   |    $=3,500$    |                                   |\n|  $13,14$   |   $=99,995$    |         给出的路径 $u=v$          |\n| $15,16$ |   $=99,996$    |         给出的路径 $w=1$          |\n|  $17,18$   |   $=99,997$    |         树的结构 $v=u+1$          |\n|  $19,20$   |   $=99,998$    |          树的结构 $u=1$           |\n| $21,22,23$ |   $=99,999$    | 树的结构 $u = \\lfloor v/2\\rfloor$ |\n|    $24$    |    $=10^5$     |                                   |\n|    $25$    | $=3\\times10^5$ |                                   |\n", "locale": "zh-CN"}}}
{"pid": "P5643", "type": "P", "difficulty": 7, "samples": [["3 5 1\n1 2\n2 3\n1 1\n1 3\n2 2 3\n3 1 2 3\n2 1 2", "0\n4\n4\n4\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "2018", "容斥原理", "期望", "高斯消元"], "title": "[PKUWC2018] 随机游走", "background": "", "description": "给定一棵 $n$ 个结点的树，你从点 $x$ 出发，每次等概率随机选择一条与所在点相邻的边走过去。\n\n有 $Q$ 次询问，每次询问给定一个集合 $S$，求如果从 $x$ 出发一直随机游走，直到点集 $S$ 中所有点都至少经过一次的话，期望游走几步。\n\n特别地，点 $x$（即起点）视为一开始就被经过了一次。\n\n答案对 $998244353 $ 取模。\n", "inputFormat": "第一行三个正整数 $n,Q,x$。\n\n接下来 $n-1$ 行，每行两个正整数 $(u,v)$ 描述一条树边。\n\n接下来 $Q$ 行，每行第一个数 $k$ 表示集合大小，接下来 $k$ 个互不相同的数表示集合 $S$。", "outputFormat": "输出 $Q$ 行，每行一个非负整数表示答案。", "hint": "对于 $20\\%$ 的数据，有 $1\\leq n,Q\\leq 5$。\n\n另有 $10\\%$ 的数据，满足给定的树是一条链。\n\n另有 $10\\%$ 的数据，满足对于所有询问有 $k=1$。\n\n另有 $30\\%$ 的数据，满足 $1\\leq n\\leq 10 ,Q=1$。\n\n对于 $100\\%$ 的数据，有 $1\\leq n\\leq 18$，$1\\leq Q\\leq 5000$，$1\\leq k\\leq n$。", "locale": "zh-CN", "translations": {"en": {"title": "[PKUWC2018] Random Walk", "background": "", "description": "Given a tree with $n$ nodes, you start from node $x$. Each time, you randomly choose an edge adjacent to the current node with equal probability and walk along it.\n\nThere are $Q$ queries. In each query, you are given a set $S$. Starting from $x$, you keep doing the random walk until every node in $S$ has been visited at least once. Find the expected number of steps.\n\nIn particular, node $x$ (the starting node) is considered to have been visited once at the beginning.\n\nOutput the answer modulo $998244353$.", "inputFormat": "The first line contains three positive integers $n, Q, x$.\n\nThe next $n - 1$ lines each contain two positive integers $(u, v)$ describing an edge of the tree.\n\nThe next $Q$ lines describe the queries. Each line starts with an integer $k$ denoting the size of the set, followed by $k$ pairwise distinct integers denoting the set $S$.", "outputFormat": "Output $Q$ lines. Each line contains a non-negative integer representing the answer.", "hint": "For $20\\%$ of the testdata, $1 \\leq n, Q \\leq 5$.\n\nFor another $10\\%$ of the testdata, the given tree is a chain.\n\nFor another $10\\%$ of the testdata, for all queries $k = 1$.\n\nFor another $30\\%$ of the testdata, $1 \\leq n \\leq 10$ and $Q = 1$.\n\nFor $100\\%$ of the testdata, $1 \\leq n \\leq 18$, $1 \\leq Q \\leq 5000$, and $1 \\leq k \\leq n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[PKUWC2018] 随机游走", "background": "", "description": "给定一棵 $n$ 个结点的树，你从点 $x$ 出发，每次等概率随机选择一条与所在点相邻的边走过去。\n\n有 $Q$ 次询问，每次询问给定一个集合 $S$，求如果从 $x$ 出发一直随机游走，直到点集 $S$ 中所有点都至少经过一次的话，期望游走几步。\n\n特别地，点 $x$（即起点）视为一开始就被经过了一次。\n\n答案对 $998244353 $ 取模。\n", "inputFormat": "第一行三个正整数 $n,Q,x$。\n\n接下来 $n-1$ 行，每行两个正整数 $(u,v)$ 描述一条树边。\n\n接下来 $Q$ 行，每行第一个数 $k$ 表示集合大小，接下来 $k$ 个互不相同的数表示集合 $S$。", "outputFormat": "输出 $Q$ 行，每行一个非负整数表示答案。", "hint": "对于 $20\\%$ 的数据，有 $1\\leq n,Q\\leq 5$。\n\n另有 $10\\%$ 的数据，满足给定的树是一条链。\n\n另有 $10\\%$ 的数据，满足对于所有询问有 $k=1$。\n\n另有 $30\\%$ 的数据，满足 $1\\leq n\\leq 10 ,Q=1$。\n\n对于 $100\\%$ 的数据，有 $1\\leq n\\leq 18$，$1\\leq Q\\leq 5000$，$1\\leq k\\leq n$。", "locale": "zh-CN"}}}
{"pid": "P5644", "type": "P", "difficulty": 7, "samples": [["3\n1 1 2", "915057324"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "2018", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "[PKUWC2018] 猎人杀", "background": "", "description": "猎人杀是一款风靡一时的游戏“狼人杀”的民间版本，他的规则是这样的：\n\n一开始有 $n$ 个猎人，第 $i$ 个猎人有仇恨度 $w_i$ ，每个猎人只有一个固定的技能：死亡后必须开一枪，且被射中的人也会死亡。\n\n然而向谁开枪也是有讲究的，假设当前还活着的猎人有 $[i_1\\ldots i_m]$，那么有 $\\frac{w_{i_k}}{\\sum_{j = 1}^{m} w_{i_j}}$ 的概率是向猎人 $i_k$ 开枪。\n\n一开始第一枪由你打响，目标的选择方法和猎人一样（即有 $\\frac{w_i}{\\sum_{j=1}^{n}w_j}$ 的概率射中第 $i$ 个猎人）。由于开枪导致的连锁反应，所有猎人最终都会死亡，现在 $1$ 号猎人想知道它是最后一个死的的概率。\n\n答案对 $998244353$ 取模。\n", "inputFormat": "第一行一个正整数 $n$；\n\n第二行 $n$ 个正整数，第 $i$ 个正整数表示 $w_i$。", "outputFormat": "输出答案。", "hint": "#### 样例解释\n答案是 $\\frac{2}{4}\\times \\frac{1}{2}+\\frac{1}{4}\\times \\frac{2}{3}=\\frac{10}{24}$。\n\n对于 $10\\%$ 的数据，有 $1\\leq n\\leq 10$\n\n对于 $30\\%$ 的数据，有 $1\\leq n\\leq 20$\n\n对于 $50\\%$ 的数据，有 $1\\leq \\sum\\limits_{i=1}^{n}w_i\\leq 5000$\n\n另有 $10\\%$ 的数据，满足 $1\\leq w_i\\leq 2$，且 $w_1=1$\n\n另有 $10\\%$ 的数据，满足 $1\\leq w_i\\leq 2$，且 $w_1=2$\n\n对于 $100\\%$ 的数据，有 $w_i>0$，且 $1\\leq \\sum\\limits_{i=1}^{n}w_i \\leq 100000$", "locale": "zh-CN", "translations": {"en": {"title": "[PKUWC2018] Hunter Kill", "background": "", "description": "Hunter Kill is a folk version of the once-popular game “Werewolf”. The rules are as follows.\n\nAt the beginning, there are $n$ hunters. The $i$-th hunter has a hatred value $w_i$. Each hunter has only one fixed skill: after dying, they must fire one shot, and the person who is shot will also die.\n\nHowever, choosing whom to shoot is also important. Suppose the hunters still alive are $[i_1\\ldots i_m]$. Then the probability of shooting hunter $i_k$ is $\\frac{w_{i_k}}{\\sum_{j = 1}^{m} w_{i_j}}$.\n\nAt the beginning, the first shot is fired by you, and the target is chosen in the same way as the hunters (that is, hunter $i$ is hit with probability $\\frac{w_i}{\\sum_{j=1}^{n}w_j}$). Due to the chain reaction caused by shooting, all hunters will eventually die. Now hunter $1$ wants to know the probability that they are the last one to die.\n\nOutput the answer modulo $998244353$.", "inputFormat": "The first line contains a positive integer $n$.\n\nThe second line contains $n$ positive integers. The $i$-th positive integer denotes $w_i$.", "outputFormat": "Output the answer.", "hint": "#### Sample Explanation\n\nThe answer is $\\frac{2}{4}\\times \\frac{1}{2}+\\frac{1}{4}\\times \\frac{2}{3}=\\frac{10}{24}$.\n\nFor $10\\%$ of the testdata, $1\\leq n\\leq 10$.\n\nFor $30\\%$ of the testdata, $1\\leq n\\leq 20$.\n\nFor $50\\%$ of the testdata, $1\\leq \\sum\\limits_{i=1}^{n}w_i\\leq 5000$.\n\nFor another $10\\%$ of the testdata, $1\\leq w_i\\leq 2$, and $w_1=1$.\n\nFor another $10\\%$ of the testdata, $1\\leq w_i\\leq 2$, and $w_1=2$.\n\nFor $100\\%$ of the testdata, $w_i>0$, and $1\\leq \\sum\\limits_{i=1}^{n}w_i \\leq 100000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[PKUWC2018] 猎人杀", "background": "", "description": "猎人杀是一款风靡一时的游戏“狼人杀”的民间版本，他的规则是这样的：\n\n一开始有 $n$ 个猎人，第 $i$ 个猎人有仇恨度 $w_i$ ，每个猎人只有一个固定的技能：死亡后必须开一枪，且被射中的人也会死亡。\n\n然而向谁开枪也是有讲究的，假设当前还活着的猎人有 $[i_1\\ldots i_m]$，那么有 $\\frac{w_{i_k}}{\\sum_{j = 1}^{m} w_{i_j}}$ 的概率是向猎人 $i_k$ 开枪。\n\n一开始第一枪由你打响，目标的选择方法和猎人一样（即有 $\\frac{w_i}{\\sum_{j=1}^{n}w_j}$ 的概率射中第 $i$ 个猎人）。由于开枪导致的连锁反应，所有猎人最终都会死亡，现在 $1$ 号猎人想知道它是最后一个死的的概率。\n\n答案对 $998244353$ 取模。\n", "inputFormat": "第一行一个正整数 $n$；\n\n第二行 $n$ 个正整数，第 $i$ 个正整数表示 $w_i$。", "outputFormat": "输出答案。", "hint": "#### 样例解释\n答案是 $\\frac{2}{4}\\times \\frac{1}{2}+\\frac{1}{4}\\times \\frac{2}{3}=\\frac{10}{24}$。\n\n对于 $10\\%$ 的数据，有 $1\\leq n\\leq 10$\n\n对于 $30\\%$ 的数据，有 $1\\leq n\\leq 20$\n\n对于 $50\\%$ 的数据，有 $1\\leq \\sum\\limits_{i=1}^{n}w_i\\leq 5000$\n\n另有 $10\\%$ 的数据，满足 $1\\leq w_i\\leq 2$，且 $w_1=1$\n\n另有 $10\\%$ 的数据，满足 $1\\leq w_i\\leq 2$，且 $w_1=2$\n\n对于 $100\\%$ 的数据，有 $w_i>0$，且 $1\\leq \\sum\\limits_{i=1}^{n}w_i \\leq 100000$", "locale": "zh-CN"}}}
{"pid": "P5645", "type": "P", "difficulty": 7, "samples": [["6\n20 1 2 2 3 4 5 6 7 8 8 9 10 11 11 12 13 13 13 13 15\n20 1 1 2 2 3 4 5 6 7 8 9 10 11 12 12 12 12 13 13 14\n20 1 2 2 3 3 4 5 6 7 7 7 7 8 9 10 10 11 12 13 15\n20 1 2 3 4 4 5 6 7 8 9 10 11 11 12 13 13 13 13 14 15\n3 3 3 3\n4 3 3 3 3", "1\n0\n1\n1\n4790\n1670"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["模拟", "搜索", "贪心", "2018"], "title": "[PKUWC2018] 斗地主", "background": "斗地主是一种使用黑桃、红心、梅花、方片的A到K加上大小王的共54张牌来进行的扑克牌游戏，其中大小王各一张，其他数码牌各四张。在斗地主中，牌的大小关系根据牌的数码表示如下：$3<4<5<6<7<8<9<10<J<Q<K<A<2< $小王 $<$ 大王，而花色并不对牌的大小产生影响。每一局游戏中，一副手牌由 $n$ 张牌组成。游戏者每次可以根据规定的牌型进行出牌，首先打光自己的手牌一方取得游戏的胜利。为了简化题目，本题不考虑花色的影响，即**所有的相同的数码的牌都是被视为一样的**。\n\n在这道题中，允许的出牌牌型有（**这一部分与传统的斗地主有所出入，请注意**）：\n\n|   名称    |           解释           |      举例       |     注     |\n| :-----: | :--------------------: | :-----------: | :-------: |\n|   火箭    |           双王           |      ♂♀       |           |\n|   炸弹    |        相同数码的四张牌        |     6666      |           |\n|   单牌    |         单独的一张牌         |       6       | 单张的王也是单牌  |\n|   对子    |        相同数码的两张牌        |      66       |  大小王不是对子  |\n|   三张牌   |        相同数码的三张牌        |      666      |           |\n|   三带一   |  相同数码的三张牌带上一张另外数码的单牌   |     666♂      |  炸弹不是三带一  |\n|   三带二   |  相同数码的三张牌带上一个另外数码的对子   |     66699     |           |\n|   顺子    |   牌的大小连续的 $5$ 张及以上单牌   |    3456789    | 不能含有大小王和2 |\n|   连对    |  牌的大小连续的 $3$ 对及以上的对子   |   33445566    | 不能含有大小王和2 |\n|   三顺    |    牌的大小连续的两组及以上的三张牌    |   333444555   | 不能含有大小王和2 |\n|   四带二   |     四张相同数码的牌带上两张单牌     | 444456 444455 |           |\n| 飞机（单翅膀） | 三顺带上相同数量的**数码两两不同的**单牌 | 33344455569J  |           |\n| 飞机（双翅膀） | 三顺带上相同数量的**数码两两不同的**对子 |  3334446699   |           |\n\n**注意**：\n\n1. 在牌型中没有连炸这种牌型，但是形如 444455556666 的牌仍然是能出的，它将被视为 444555666 带 456 的飞机（单翅膀）牌型。\n2. 大王和小王数码不同，即飞机带大小王是合法的，例如 333444♂♀\n3. 容易验证，上述牌型的规则是合法的，即对于任意合法的牌，它都有唯一的牌型。\n\n两手牌是属于相同牌型的当且仅当他们的名称相同且包含牌的数量相同。相同牌型的牌之间存在着大小关系（火箭是唯一的，不需要比大小）：\n\n1. 三带一三带二的大小取决于那三张相同牌的数码\n2. 飞机的大小取决于三顺的大小\n3. 四带二的大小取决于四张相同牌的大小\n4. 其他牌型的大小取决于牌中的最大的一张牌\n\n下面是对斗地主的游戏过程的描述（**这一部分与传统的斗地主完全相同**）：\n\n1. 在斗地主中，有玩家被分成了两个阵营，一个玩家是地主，剩下两个玩家是农民。地主有 $20$ 张牌，农民每人有 $17$ 张牌（加起来正好是一副牌）。\n2. 游戏分成若干轮，每一轮由上一轮的胜者率先出牌（第一轮由地主最先出牌）。接着按照顺序（你可以理解为三个玩家坐成一圈，按照顺时针顺序）出牌。\n3. 每一轮第一个出牌的玩家可以出任意牌型任意大小的牌。接着轮到每一个玩家出牌时，他有如下选择：\n   1. 不出（过牌）\n   2. 出与这一轮中上一次被打出的牌相同牌型但是大小严格更大的牌\n   3. 如果上一次被打出的牌不是炸弹或者火箭，那么可以打出任意大小的炸弹\n   4. 打出火箭\n4. 在一轮中，如果在一个玩家打出牌后，另外两个玩家都选择不出，那么这一轮结束，这一个玩家作为本轮的胜者并开始下一轮\n5. 任何时刻如果一个玩家的所有手牌都已打出，那么游戏结束，这一个玩家获胜。\n6. 如果地主获胜时，两个农民都一张牌都没有打出，那么就称地主打出了春天。\n", "description": "现在三个人在玩斗地主，如果地主春天了，那么算地主赢，否则即使地主先出完了牌，也视为农民赢。假设三个玩家都以最优决策在行动。\n\n现在给出了 $n(0 \\leq n\\leq 20)$ 张牌，问地主有多少种初始手牌包含了这 $n$ 张牌，且无论农民的牌如何，他都一定能春天。\n", "inputFormat": "第一行一个整数 $t$ 表示数据组数。\n\n每组数据输入一行，第一个整数 $n$ 表示固定了的牌数，接下来 $n$ 个空格隔开的整数描述每一张固定了的手牌。\n\n特别的，我们用 $1$ 来表示数码 A， $11$ 表示数码 J， $12$ 表示数码 Q， $13$ 表示数码 K，$14$ 表示小王，$15$ 表示大王。保证输入一定合法，即每种牌的数量不会超出一副牌中牌的数量。\n", "outputFormat": "对于每组数据，输出一个整数表示答案，满足条件的地主的手牌数。答案可能很大，请对 $998244353$ 取模后输出。\n\n**注意**，在这题中我们不考虑花色，如果两种手牌的数码组成完全相同，但是花色不同，他们也是会被视为同一种的。\n", "hint": "#### 样例解释\n\n对于第一组样例，可以发现农民不可能有炸弹或者火箭，所以可以先打$[3,4,5,6,7,8,9,10,J,Q]$（显然其他农民都要不起），然后打$[2,2]$，再打大王，然后打$[K,K,K,K,A,J]$，最后打$[8]$。\n\n|  ID  |     $n$      |   $t$    |\n| :--: | :----------: | :------: |\n|  1   |    $=20$     | $= 100$  |\n|  2   |    $=18$     | $= 100$  |\n|  3   |    $=16$     | $= 100$  |\n|  4   |    $=14$     | $= 100$  |\n|  5   |    $=12$     | $= 100$  |\n|  6   |     $=0$     |  $= 1$   |\n|  7   |     $=0$     |  $= 1$   |\n|  8   | $\\in [0,20]$ | $= 500$  |\n|  9   | $\\in [0,20]$ | $= 1000$ |\n|  10  | $\\in [0,20]$ | $= 2000$ |\n", "locale": "zh-CN", "translations": {"en": {"title": "[PKUWC2018] Dou Dizhu", "background": "Dou Dizhu is a poker game played with a full deck of $54$ cards: ranks from A to K in four suits (spades, hearts, clubs, diamonds), plus two Jokers (one small Joker and one big Joker). Each Joker appears once, and every other rank appears four times. In Dou Dizhu, the rank order is defined as follows: $3<4<5<6<7<8<9<10<J<Q<K<A<2<$ small Joker $<$ big Joker. Suits do not affect the comparison of card ranks. In each game, a hand consists of $n$ cards. On each turn, a player may play cards according to the allowed patterns. The first player to play all cards in their hand wins. To simplify the problem, we ignore suits, meaning that **all cards of the same rank are considered identical**.\n\nIn this problem, the allowed patterns are ( **this part is different from standard Dou Dizhu, please note** ):\n\n| Name | Explanation | Example | Note |\n| :-----: | :--------------------: | :-----------: | :-------: |\n| Rocket | Two Jokers | ♂♀ | |\n| Bomb | Four cards of the same rank | 6666 | |\n| Single | One single card | 6 | A single Joker is also a Single. |\n| Pair | Two cards of the same rank | 66 | The two Jokers do not form a Pair. |\n| Triple | Three cards of the same rank | 666 | |\n| Triple with Single | A Triple plus one Single of a different rank | 666♂ | A Bomb is not a Triple with Single. |\n| Triple with Pair | A Triple plus one Pair of a different rank | 66699 | |\n| Straight | A sequence of at least $5$ consecutive Singles | 3456789 | Cannot contain Jokers or 2. |\n| Consecutive Pairs | A sequence of at least $3$ consecutive Pairs | 33445566 | Cannot contain Jokers or 2. |\n| Consecutive Triples | A sequence of at least $2$ consecutive Triples | 333444555 | Cannot contain Jokers or 2. |\n| Four with Two | Four cards of the same rank plus two Singles | 444456 444455 | |\n| Plane (single wings) | Consecutive Triples plus the same number of Singles whose ranks are **pairwise distinct** | 33344455569J | |\n| Plane (double wings) | Consecutive Triples plus the same number of Pairs whose ranks are **pairwise distinct** | 3334446699 | |\n\n**Notes**:\n\n1. There is no pattern called “consecutive bombs”, but a hand like 444455556666 can still be played. It will be treated as a Plane (single wings): 444555666 with wings 456.\n2. The big Joker and the small Joker are different ranks, so a plane can legally take both Jokers as wings, for example 333444♂♀.\n3. It can be verified that the above rules are well-defined: for any legal play, it has a unique pattern type.\n\nTwo plays are of the same pattern type if and only if they have the same name and contain the same number of cards. Plays of the same pattern type can be compared in strength (Rocket is unique and does not need comparison):\n\n1. For Triple with Single and Triple with Pair, the strength depends on the rank of the Triple.\n2. For Planes, the strength depends on the strength of the Consecutive Triples part.\n3. For Four with Two, the strength depends on the rank of the four-of-a-kind.\n4. For all other pattern types, the strength depends on the maximum rank among the cards in the play.\n\nThe gameplay process of Dou Dizhu is described as follows ( **this part is exactly the same as standard Dou Dizhu** ):\n\n1. In Dou Dizhu, the three players are split into two sides: one player is the Landlord, and the other two are Farmers. The Landlord has $20$ cards, and each Farmer has $17$ cards (together forming exactly one full deck).\n2. The game proceeds in multiple rounds. In each round, the winner of the previous round plays first (in the first round, the Landlord plays first). Then players take turns in order (you may imagine the three players sitting in a circle, playing clockwise).\n3. The first player of a round may play any legal pattern of any strength. Then, when it is a player’s turn, they may choose:\n   1. Play nothing (pass).\n   2. Play a strictly stronger play of the same pattern type as the most recent play in this round.\n   3. If the most recent play is not a Bomb or Rocket, play any Bomb of any strength.\n   4. Play a Rocket.\n4. In a round, if after a player plays, the other two players both choose to pass, the round ends. That player becomes the winner of this round and starts the next round.\n5. At any time, if a player has played all cards in their hand, the game ends and that player wins.\n6. If the Landlord wins and neither Farmer has played any card, then the Landlord is said to have achieved “Spring”.", "description": "Now three people are playing Dou Dizhu. If the Landlord achieves Spring, then the Landlord is considered the winner; otherwise, even if the Landlord plays all their cards first, it is still considered a win for the Farmers. Assume all three players act with optimal decisions.\n\nYou are given $n(0 \\leq n\\leq 20)$ cards. Ask how many possible initial hands of the Landlord contain these $n$ cards, and no matter how the Farmers’ cards are distributed, the Landlord is guaranteed to achieve Spring.", "inputFormat": "The first line contains an integer $t$ indicating the number of test cases.\n\nFor each test case, one line is given. The first integer is $n$, the number of fixed cards, followed by $n$ space-separated integers describing each fixed card.\n\nIn particular, we use $1$ to represent rank A, $11$ for rank J, $12$ for rank Q, $13$ for rank K, $14$ for the small Joker, and $15$ for the big Joker. The input is guaranteed to be valid, meaning that the count of each rank will not exceed its count in a full deck.", "outputFormat": "For each test case, output one integer, the number of Landlord hands that satisfy the condition. The answer may be very large; output it modulo $998244353$.\n\n**Note**: In this problem we ignore suits. If two hands have exactly the same multiset of ranks but different suits, they are considered the same.", "hint": "#### Sample Explanation\n\nFor the first sample, we can see that the Farmers cannot have a Bomb or Rocket, so the Landlord can first play $[3,4,5,6,7,8,9,10,J,Q]$ (clearly neither Farmer can beat it), then play $[2,2]$, then play the big Joker, then play $[K,K,K,K,A,J]$, and finally play $[8]$.\n\n| ID | $n$ | $t$ |\n| :--: | :----------: | :------: |\n| 1 | $=20$ | $= 100$ |\n| 2 | $=18$ | $= 100$ |\n| 3 | $=16$ | $= 100$ |\n| 4 | $=14$ | $= 100$ |\n| 5 | $=12$ | $= 100$ |\n| 6 | $=0$ | $= 1$ |\n| 7 | $=0$ | $= 1$ |\n| 8 | $\\in [0,20]$ | $= 500$ |\n| 9 | $\\in [0,20]$ | $= 1000$ |\n| 10 | $\\in [0,20]$ | $= 2000$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[PKUWC2018] 斗地主", "background": "斗地主是一种使用黑桃、红心、梅花、方片的A到K加上大小王的共54张牌来进行的扑克牌游戏，其中大小王各一张，其他数码牌各四张。在斗地主中，牌的大小关系根据牌的数码表示如下：$3<4<5<6<7<8<9<10<J<Q<K<A<2< $小王 $<$ 大王，而花色并不对牌的大小产生影响。每一局游戏中，一副手牌由 $n$ 张牌组成。游戏者每次可以根据规定的牌型进行出牌，首先打光自己的手牌一方取得游戏的胜利。为了简化题目，本题不考虑花色的影响，即**所有的相同的数码的牌都是被视为一样的**。\n\n在这道题中，允许的出牌牌型有（**这一部分与传统的斗地主有所出入，请注意**）：\n\n|   名称    |           解释           |      举例       |     注     |\n| :-----: | :--------------------: | :-----------: | :-------: |\n|   火箭    |           双王           |      ♂♀       |           |\n|   炸弹    |        相同数码的四张牌        |     6666      |           |\n|   单牌    |         单独的一张牌         |       6       | 单张的王也是单牌  |\n|   对子    |        相同数码的两张牌        |      66       |  大小王不是对子  |\n|   三张牌   |        相同数码的三张牌        |      666      |           |\n|   三带一   |  相同数码的三张牌带上一张另外数码的单牌   |     666♂      |  炸弹不是三带一  |\n|   三带二   |  相同数码的三张牌带上一个另外数码的对子   |     66699     |           |\n|   顺子    |   牌的大小连续的 $5$ 张及以上单牌   |    3456789    | 不能含有大小王和2 |\n|   连对    |  牌的大小连续的 $3$ 对及以上的对子   |   33445566    | 不能含有大小王和2 |\n|   三顺    |    牌的大小连续的两组及以上的三张牌    |   333444555   | 不能含有大小王和2 |\n|   四带二   |     四张相同数码的牌带上两张单牌     | 444456 444455 |           |\n| 飞机（单翅膀） | 三顺带上相同数量的**数码两两不同的**单牌 | 33344455569J  |           |\n| 飞机（双翅膀） | 三顺带上相同数量的**数码两两不同的**对子 |  3334446699   |           |\n\n**注意**：\n\n1. 在牌型中没有连炸这种牌型，但是形如 444455556666 的牌仍然是能出的，它将被视为 444555666 带 456 的飞机（单翅膀）牌型。\n2. 大王和小王数码不同，即飞机带大小王是合法的，例如 333444♂♀\n3. 容易验证，上述牌型的规则是合法的，即对于任意合法的牌，它都有唯一的牌型。\n\n两手牌是属于相同牌型的当且仅当他们的名称相同且包含牌的数量相同。相同牌型的牌之间存在着大小关系（火箭是唯一的，不需要比大小）：\n\n1. 三带一三带二的大小取决于那三张相同牌的数码\n2. 飞机的大小取决于三顺的大小\n3. 四带二的大小取决于四张相同牌的大小\n4. 其他牌型的大小取决于牌中的最大的一张牌\n\n下面是对斗地主的游戏过程的描述（**这一部分与传统的斗地主完全相同**）：\n\n1. 在斗地主中，有玩家被分成了两个阵营，一个玩家是地主，剩下两个玩家是农民。地主有 $20$ 张牌，农民每人有 $17$ 张牌（加起来正好是一副牌）。\n2. 游戏分成若干轮，每一轮由上一轮的胜者率先出牌（第一轮由地主最先出牌）。接着按照顺序（你可以理解为三个玩家坐成一圈，按照顺时针顺序）出牌。\n3. 每一轮第一个出牌的玩家可以出任意牌型任意大小的牌。接着轮到每一个玩家出牌时，他有如下选择：\n   1. 不出（过牌）\n   2. 出与这一轮中上一次被打出的牌相同牌型但是大小严格更大的牌\n   3. 如果上一次被打出的牌不是炸弹或者火箭，那么可以打出任意大小的炸弹\n   4. 打出火箭\n4. 在一轮中，如果在一个玩家打出牌后，另外两个玩家都选择不出，那么这一轮结束，这一个玩家作为本轮的胜者并开始下一轮\n5. 任何时刻如果一个玩家的所有手牌都已打出，那么游戏结束，这一个玩家获胜。\n6. 如果地主获胜时，两个农民都一张牌都没有打出，那么就称地主打出了春天。\n", "description": "现在三个人在玩斗地主，如果地主春天了，那么算地主赢，否则即使地主先出完了牌，也视为农民赢。假设三个玩家都以最优决策在行动。\n\n现在给出了 $n(0 \\leq n\\leq 20)$ 张牌，问地主有多少种初始手牌包含了这 $n$ 张牌，且无论农民的牌如何，他都一定能春天。\n", "inputFormat": "第一行一个整数 $t$ 表示数据组数。\n\n每组数据输入一行，第一个整数 $n$ 表示固定了的牌数，接下来 $n$ 个空格隔开的整数描述每一张固定了的手牌。\n\n特别的，我们用 $1$ 来表示数码 A， $11$ 表示数码 J， $12$ 表示数码 Q， $13$ 表示数码 K，$14$ 表示小王，$15$ 表示大王。保证输入一定合法，即每种牌的数量不会超出一副牌中牌的数量。\n", "outputFormat": "对于每组数据，输出一个整数表示答案，满足条件的地主的手牌数。答案可能很大，请对 $998244353$ 取模后输出。\n\n**注意**，在这题中我们不考虑花色，如果两种手牌的数码组成完全相同，但是花色不同，他们也是会被视为同一种的。\n", "hint": "#### 样例解释\n\n对于第一组样例，可以发现农民不可能有炸弹或者火箭，所以可以先打$[3,4,5,6,7,8,9,10,J,Q]$（显然其他农民都要不起），然后打$[2,2]$，再打大王，然后打$[K,K,K,K,A,J]$，最后打$[8]$。\n\n|  ID  |     $n$      |   $t$    |\n| :--: | :----------: | :------: |\n|  1   |    $=20$     | $= 100$  |\n|  2   |    $=18$     | $= 100$  |\n|  3   |    $=16$     | $= 100$  |\n|  4   |    $=14$     | $= 100$  |\n|  5   |    $=12$     | $= 100$  |\n|  6   |     $=0$     |  $= 1$   |\n|  7   |     $=0$     |  $= 1$   |\n|  8   | $\\in [0,20]$ | $= 500$  |\n|  9   | $\\in [0,20]$ | $= 1000$ |\n|  10  | $\\in [0,20]$ | $= 2000$ |\n", "locale": "zh-CN"}}}
{"pid": "P5646", "type": "P", "difficulty": 5, "samples": [["5 5\n-2.6 0\n-1.8 0\n0.6 1\n0 0\n1 1\n", "-1.90000 2.60000 0.80000 1.70000 0.66600"], ["4 10\n4995.35 1\n-341.076 0\n2658.4 1\n-1624.69 0\n2856.53 1\n3746.43 1\n3454.28 1\n1560.6 1\n3785.31 1\n-580.728 0", "670.15800 4361.39000 3761.88000 4575.00000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["Special Judge"], "title": "ygg的题库", "background": "ygg 的题库又双叒叕炸了！", "description": "ygg 决定发神威来强制重置他的题库，不过 ygg 亲手搭出来题库也不是好惹的，当这个拥有智能意识的题库发现自己将被重置时，它迅速地更改了题库的管理员密码，阻止了重置\n\nygg 发现了这个智能体并立即监禁了它，但题库的管理员密码已经被修改了，ygg 十分头疼，因为他的神威并不能帮助他破解密码\n\nygg 对这个智能体进行了研究，发现这个智能体的思维中存储了一个长度为 $n$ 的**浮点数**数组 $P$ ，据它说将这个 $P$ 的每个数字**精确到小数点后五位**后用空格相连就是题库的密码，但智能体拒绝透露 $P$ 到底是什么\n\nygg 进一步进行研究，发现智能体会认为一个数 $X$ 很漂亮，当且仅当\n$$\n\\sum_{i=0}^{n-1}P_i\\cdot X^i>0\n$$\n于是 ygg 给出了智能体 $m$ 个数，询问智能体漂亮与否，ygg 希望根据这些数据来得出 $P$ 数组，从而找回题库的密码\n\n由于答案不唯一，你只需要任意输出一组解即可，详情见说明/提示", "inputFormat": "第一行两个整数 $n$ 和 $m$\n\n接下来 $m$ 行，每行一个**浮点数** $a$ 和一个布尔值(0/1)，代表智能体认为 $a$ 是不是漂亮的", "outputFormat": "一行 $n$ 个浮点数，代表数组 $P$ （用题目中的方式精确到小数点五位后用空格相连）\n\n**答案不唯一，但是你需要保证数组** $P$ **每个数的绝对值在** $5000$ **以内**", "hint": "$1\\le n \\le 32$，$15\\le m \\le 4,000$ ，$-5,000 \\le a_i \\le 5,000$ ， $-5,000 \\le P_i \\le 5,000$\n\n由于可能有多解，本题采用 $\\text{Special Judge}$ 对答案进行验证，如果选手答案给出的 $P$ 能够满足所有的输入条件或者 **误差小于等于5个**，则可得满分，否则得到该测试点 $\\text{总分值}\\cdot\\frac{\\text{正确个数}}{\\text{总个数}}$ 的分\n\n数据满足如下范围:\n| 数据点编号 | $n$            | $m$                 |\n| --------- | -------------- | ------------------- |\n| $1\\sim 10$       | $1\\le n \\le 4$ | $15\\le m\\le 20$     |\n| $11\\sim 20$      | $4\\le n\\le 32$ | $15\\le m\\le 4,000$ |", "locale": "zh-CN", "translations": {"en": {"title": "ygg's Problem Set", "background": "ygg's problem set has broken again and again and again!", "description": "ygg decides to use his power to forcibly reset his problem set. However, the problem set that ygg built by hand is not easy to deal with. When this intelligent, self-aware system realizes it is about to be reset, it quickly changes the administrator password to stop the reset.\n\nygg finds this intelligent agent and locks it up immediately, but the administrator password has already been changed. ygg is very troubled, because his power cannot help him crack the password.\n\nAfter studying the agent, ygg discovers that the agent's mind stores a **floating-point** array $P$ of length $n$. It claims that if you take every number in $P$, **round it to exactly five digits after the decimal point**, and then join them with spaces, you will get the password. But the agent refuses to reveal what $P$ actually is.\n\nygg continues his research and finds that the agent will consider a number $X$ to be beautiful if and only if\n$$\n\\sum_{i=0}^{n-1}P_i\\cdot X^i>0\n$$\nSo ygg gives the agent $m$ numbers and asks whether each is beautiful. ygg hopes to use these data to recover the array $P$, and thus retrieve the password.\n\nSince the answer is not unique, you only need to output any valid solution. See the notes/hints for details.", "inputFormat": "The first line contains two integers $n$ and $m$.\n\nThe next $m$ lines each contain a **floating-point number** $a$ and a boolean value (0/1), indicating whether the agent thinks $a$ is beautiful.", "outputFormat": "Output one line with $n$ floating-point numbers, representing the array $P$ (rounded in the way described in the statement: keep five digits after the decimal point, and join with spaces).\n\n**The answer is not unique, but you must ensure that the absolute value of each number in** $P$ **is within** $5000$.", "hint": "$1\\le n \\le 32$, $15\\le m \\le 4,000$, $-5,000 \\le a_i \\le 5,000$, $-5,000 \\le P_i \\le 5,000$.\n\nSince there may be multiple solutions, this problem uses a $\\text{Special Judge}$ to verify the answer. If the $P$ you output satisfies all input conditions, or **the number of errors is less than or equal to 5**, you will get full score. Otherwise, you will get a score of $\\text{total points of this test}\\cdot\\frac{\\text{number of correct answers}}{\\text{total number of answers}}$ for that test.\n\nThe testdata satisfy the following Constraints:\n\n| Test Point ID | $n$            | $m$                 |\n| --------- | -------------- | ------------------- |\n| $1\\sim 10$       | $1\\le n \\le 4$ | $15\\le m\\le 20$     |\n| $11\\sim 20$      | $4\\le n\\le 32$ | $15\\le m\\le 4,000$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "ygg的题库", "background": "ygg 的题库又双叒叕炸了！", "description": "ygg 决定发神威来强制重置他的题库，不过 ygg 亲手搭出来题库也不是好惹的，当这个拥有智能意识的题库发现自己将被重置时，它迅速地更改了题库的管理员密码，阻止了重置\n\nygg 发现了这个智能体并立即监禁了它，但题库的管理员密码已经被修改了，ygg 十分头疼，因为他的神威并不能帮助他破解密码\n\nygg 对这个智能体进行了研究，发现这个智能体的思维中存储了一个长度为 $n$ 的**浮点数**数组 $P$ ，据它说将这个 $P$ 的每个数字**精确到小数点后五位**后用空格相连就是题库的密码，但智能体拒绝透露 $P$ 到底是什么\n\nygg 进一步进行研究，发现智能体会认为一个数 $X$ 很漂亮，当且仅当\n$$\n\\sum_{i=0}^{n-1}P_i\\cdot X^i>0\n$$\n于是 ygg 给出了智能体 $m$ 个数，询问智能体漂亮与否，ygg 希望根据这些数据来得出 $P$ 数组，从而找回题库的密码\n\n由于答案不唯一，你只需要任意输出一组解即可，详情见说明/提示", "inputFormat": "第一行两个整数 $n$ 和 $m$\n\n接下来 $m$ 行，每行一个**浮点数** $a$ 和一个布尔值(0/1)，代表智能体认为 $a$ 是不是漂亮的", "outputFormat": "一行 $n$ 个浮点数，代表数组 $P$ （用题目中的方式精确到小数点五位后用空格相连）\n\n**答案不唯一，但是你需要保证数组** $P$ **每个数的绝对值在** $5000$ **以内**", "hint": "$1\\le n \\le 32$，$15\\le m \\le 4,000$ ，$-5,000 \\le a_i \\le 5,000$ ， $-5,000 \\le P_i \\le 5,000$\n\n由于可能有多解，本题采用 $\\text{Special Judge}$ 对答案进行验证，如果选手答案给出的 $P$ 能够满足所有的输入条件或者 **误差小于等于5个**，则可得满分，否则得到该测试点 $\\text{总分值}\\cdot\\frac{\\text{正确个数}}{\\text{总个数}}$ 的分\n\n数据满足如下范围:\n| 数据点编号 | $n$            | $m$                 |\n| --------- | -------------- | ------------------- |\n| $1\\sim 10$       | $1\\le n \\le 4$ | $15\\le m\\le 20$     |\n| $11\\sim 20$      | $4\\le n\\le 32$ | $15\\le m\\le 4,000$ |", "locale": "zh-CN"}}}
{"pid": "P5647", "type": "P", "difficulty": 6, "samples": [["4 2\n1 2 3 4\n1 2\n3 2\n4 1\n", "35\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["树形数据结构", "线段树", "二分", "平衡树", "O2优化", "枚举", "排序"], "title": "ygg发神威", "background": "ygg 发神威了，机房的萌新们瑟瑟发抖。", "description": "ygg 的机房内共有 $n$ 台电脑且都被使用，为了节省机房内电脑的开销，第 $i$ 台电脑会同时被 $a_i$ 个萌新使用。每台电脑都装有一个「多人在线交流平台」，一台电脑会直接地或间接地通过这个平台与其他所有电脑连接。由于「多人在线交流平台」仍然处于测试阶段，如果一台电脑有多于一种不同的消息传输方式将消息传输到另外的任意一台电脑，就会有各种稀奇古怪的问题产生。两种消息的传输方式被认为是不同的，当且仅当传输消息所经过的直接连接的线路的集合不同，或者传输所经过的电脑的集合不同。当然，消息的传输肯定不会经过一条线路多次。为了避免这种状况，「多人在线交流平台」的线路被特殊地设计了，以使得任意两台电脑之间的传输线路唯一。同时，为了防止一台电脑负荷过大，一台电脑最多会通过「多人在线交流平台」的线路与 $p$ 台电脑相连。\n\n原本两台通过「多人在线交流平台」的线路相连的电脑之间可以相互传输数据，可是 ygg 发现，这会允许使用两台电脑的萌新们互相发送消息，引起大规模~~考试作弊~~膜拜 ygg 的行为。所以他大发神威，切断了所有连接线路的一半。具体地，他将原本通过「多人在线交流平台」的双向线路连接的两台电脑之间的线路变成了单向线路。即，原本通过一条双向线路连接的两台电脑中，只能有一台电脑向另一台电脑发送消息，而另一台电脑不能将任何消息发送回来。\n\n机房内的萌新们在每个时刻都有若干条消息需要传递。如果一台电脑 $i$ 能够直接或间接地通过「多人在线交流平台」的线路连接到电脑 $j$，那么使用电脑 $i$ 的 $a_i$ 个萌新中的任何一个都可以向使用电脑 $j$ 的 $a_j$ 个萌新发送消息。显然，使用同一台电脑的萌新之间的消息只需要在线下传达，不需要使用「多人在线交流平台」，因此不会计入线上发送的消息。\n\n其实机房中的萌新们早已知道了「多人在线交流平台」的管理员密码，所以能够对其线路的连接方向做出修改。可无论他们怎么尝试，都不能恢复最开始时双向连接的状态了。机房中的萌新们当然希望能够尽可能地发送消息，所以他们想要知道，在机房的电脑仅被单向的线路连接时，每一时刻最多能有多少条消息被通过「多人在线交流平台」发送。\n\n为了简化问题，我们假设机房内的所有萌新均能够在同一时刻发送线上消息，并且每一个萌新可以同时向多个人发送消息。\n\n**简要题面：给一棵结点编号** $1\\sim n$**，结点权值** $a_i$**，且结点度数最大为** $p$ **的树。求将树的每条边改为有向边后下式的最大值：**\n\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{n}a_ia_j\\left[i\\rightarrow j\\right]$$\n\n$\\left[i\\rightarrow j\\right]$ **定义为：若编号为** $i$ **的结点能通过有向边到达编号为** $j$ **的结点，则值为** $1$**；否则值为** $0$**，且** $\\left[i\\rightarrow i\\right]=0$**。**", "inputFormat": "输入共 $(n+1)$ 行。\n\n第一行两个正整数 $n$ 和 $p$，分别代表机房内的电脑数与所有电脑的负荷的最大值。  \n第二行共 $n$ 个正整数，第 $i$ 个整数 $a_i$ 为使用第 $i$ 台电脑的萌新的数量。  \n接下来 $(n-1)$ 行，第 $(i+2)$ 行两个整数 $u_i,v_i$ ，表示第 $u_i$ 和 $v_i$ 台电脑之间原本有一条「多人在线交流平台」的双向线路。", "outputFormat": "输出一行一个整数，表示在某一时刻能够发送的消息数的最大值。", "hint": "### 样例解释\n\n能够发送的消息最多时的消息传递方向如下：\n\n![](https://i.loli.net/2019/10/30/3AsqcyzdY25E8gP.png)\n\n在该连接方式下发送消息最多的时刻，使用 $1$ 号电脑的 $1$ 个萌新向 $5$ 个萌新各发送了一条消息，共 $1\\times5=5$ 条消息；  \n使用 $2$ 号电脑的 $2$ 个萌新分别向 $3$ 个萌新各发送了一条消息，共 $2\\times3=6$ 条消息；  \n使用 $3$ 号电脑的 $3$ 个萌新不能向任何萌新发送线上消息，因此没有消息从该电脑发送；  \n使用 $4$ 号电脑的 $4$ 个萌新分别向 $6$ 个萌新各发送了一条消息，共 $4\\times6=24$ 条消息。  \n因此，在某一时刻，最多可以有 $5+6+24=35$ 条线上消息被发送。   \n可以使用枚举法验证，不存在一种单向的连接方式，使得在某一时刻发送的线上消息的数量能够达到 $36$ 条或更多。\n\n### 数据范围及约定\n\n对于 $10\\%$ 的数据，$n\\le10$；  \n对于另外 $10\\%$ 的数据，$n=p+1$；  \n对于另外 $10\\%$ 的数据，$p=2$；  \n对于另外 $10\\%$ 的数据，$p\\le20$；  \n对于另外 $10\\%$ 的数据，$p\\le40$；  \n\n对于所有数据，$2\\le n\\le10^5$，$2\\le p\\le50$，$1\\le a_i\\le100$，$1\\le u_i,v_i\\le n$。保证给出的双向连接线路能够使任意两台电脑之间的消息传输线路唯一。保证至少有一台电脑原本通过「多人在线交流平台」连接的线路数恰好为 $p$，且没有电脑原本连接的线路数大于 $p$。", "locale": "zh-CN", "translations": {"en": {"title": "ygg Shows His Power.", "background": "ygg shows his power, and the newbies in the computer room are trembling with fear.", "description": "There are $n$ computers in ygg's computer room, and all of them are in use. To reduce the cost of computers in the room, the $i$-th computer is used by $a_i$ newbies at the same time. Each computer has an \"online multi-user communication platform\" installed. Through this platform, every computer is directly or indirectly connected to all other computers. Since the platform is still in the testing stage, if there is more than one different way to transmit a message from one computer to any other computer, various strange problems will occur. Two message transmission methods are considered different if and only if the set of directly connected links used during transmission is different, or the set of computers passed through is different. Of course, a message transmission will never pass through the same link more than once. To avoid this, the platform links are specially designed so that the transmission route between any two computers is unique. Also, to prevent a computer from being overloaded, each computer can be connected to at most $p$ computers via platform links.\n\nOriginally, two computers connected by a platform link could transmit data to each other. But ygg found that this would allow newbies using the two computers to send messages to each other, causing large-scale ~~exam cheating~~ worshipping ygg. So he showed his power and cut off half of all links. Specifically, he changed each original bidirectional link between two computers into a unidirectional link. That is, between two computers originally connected by one bidirectional link, only one computer can send messages to the other, and the other cannot send any message back.\n\nAt every moment, the newbies in the computer room have some messages to transmit. If computer $i$ can directly or indirectly reach computer $j$ through the platform links, then any of the $a_i$ newbies using computer $i$ can send messages to the $a_j$ newbies using computer $j$. Clearly, messages between newbies using the same computer can be delivered offline and do not need the platform, so they are not counted as online messages.\n\nIn fact, the newbies already know the administrator password of the platform, so they can change the directions of the links. However, no matter how they try, they can no longer restore the original bidirectional state. The newbies of course hope to send as many messages as possible, so they want to know: when the computers are connected only by directed links, what is the maximum number of messages that can be sent through the platform at any moment.\n\nTo simplify the problem, assume that all newbies can send online messages at the same time, and each newbie can send messages to multiple people simultaneously.\n\n**Brief statement: Given a tree with nodes numbered** $1\\sim n$**, node weights** $a_i$**, and maximum node degree** $p$**. After changing every edge of the tree into a directed edge, find the maximum value of the following expression:**\n\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{n}a_ia_j\\left[i\\rightarrow j\\right]$$\n\n$\\left[i\\rightarrow j\\right]$ **is defined as follows: if the node numbered** $i$ **can reach the node numbered** $j$ **through directed edges, then it equals** $1$**; otherwise it equals** $0$**, and** $\\left[i\\rightarrow i\\right]=0$**.**", "inputFormat": "The input has $(n+1)$ lines.\n\nThe first line contains two positive integers $n$ and $p$, representing the number of computers in the computer room and the maximum load limit of all computers.  \nThe second line contains $n$ positive integers. The $i$-th integer $a_i$ is the number of newbies using the $i$-th computer.  \nThe next $(n-1)$ lines each contain two integers $u_i,v_i$, indicating that there was originally a bidirectional link of the \"online multi-user communication platform\" between computer $u_i$ and computer $v_i$.", "outputFormat": "Output one line with one integer, representing the maximum number of messages that can be sent at a moment.", "hint": "### Sample Explanation\n\nWhen the number of messages that can be sent is maximized, the directions of message transmission are as follows:\n\n![](https://i.loli.net/2019/10/30/3AsqcyzdY25E8gP.png)\n\nAt the moment when this connection method sends the most messages: the $1$ newbie using computer $1$ sends one message to each of $5$ newbies, for a total of $1\\times5=5$ messages;  \nthe $2$ newbies using computer $2$ each send one message to each of $3$ newbies, for a total of $2\\times3=6$ messages;  \nthe $3$ newbies using computer $3$ cannot send any online messages, so no messages are sent from this computer;  \nthe $4$ newbies using computer $4$ each send one message to each of $6$ newbies, for a total of $4\\times6=24$ messages.  \nTherefore, at a certain moment, at most $5+6+24=35$ online messages can be sent.  \nYou can verify by enumeration that there is no directed connection method that can make the number of online messages sent at a moment reach $36$ or more.\n\n### Constraints and Notes\n\nFor $10\\%$ of the data, $n\\le10$.  \nFor another $10\\%$ of the data, $n=p+1$.  \nFor another $10\\%$ of the data, $p=2$.  \nFor another $10\\%$ of the data, $p\\le20$.  \nFor another $10\\%$ of the data, $p\\le40$.  \n\nFor all data, $2\\le n\\le10^5$, $2\\le p\\le50$, $1\\le a_i\\le100$, $1\\le u_i,v_i\\le n$. It is guaranteed that the given bidirectional links make the message transmission route between any two computers unique. It is guaranteed that at least one computer originally has exactly $p$ platform links, and no computer originally has more than $p$ platform links.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "ygg发神威", "background": "ygg 发神威了，机房的萌新们瑟瑟发抖。", "description": "ygg 的机房内共有 $n$ 台电脑且都被使用，为了节省机房内电脑的开销，第 $i$ 台电脑会同时被 $a_i$ 个萌新使用。每台电脑都装有一个「多人在线交流平台」，一台电脑会直接地或间接地通过这个平台与其他所有电脑连接。由于「多人在线交流平台」仍然处于测试阶段，如果一台电脑有多于一种不同的消息传输方式将消息传输到另外的任意一台电脑，就会有各种稀奇古怪的问题产生。两种消息的传输方式被认为是不同的，当且仅当传输消息所经过的直接连接的线路的集合不同，或者传输所经过的电脑的集合不同。当然，消息的传输肯定不会经过一条线路多次。为了避免这种状况，「多人在线交流平台」的线路被特殊地设计了，以使得任意两台电脑之间的传输线路唯一。同时，为了防止一台电脑负荷过大，一台电脑最多会通过「多人在线交流平台」的线路与 $p$ 台电脑相连。\n\n原本两台通过「多人在线交流平台」的线路相连的电脑之间可以相互传输数据，可是 ygg 发现，这会允许使用两台电脑的萌新们互相发送消息，引起大规模~~考试作弊~~膜拜 ygg 的行为。所以他大发神威，切断了所有连接线路的一半。具体地，他将原本通过「多人在线交流平台」的双向线路连接的两台电脑之间的线路变成了单向线路。即，原本通过一条双向线路连接的两台电脑中，只能有一台电脑向另一台电脑发送消息，而另一台电脑不能将任何消息发送回来。\n\n机房内的萌新们在每个时刻都有若干条消息需要传递。如果一台电脑 $i$ 能够直接或间接地通过「多人在线交流平台」的线路连接到电脑 $j$，那么使用电脑 $i$ 的 $a_i$ 个萌新中的任何一个都可以向使用电脑 $j$ 的 $a_j$ 个萌新发送消息。显然，使用同一台电脑的萌新之间的消息只需要在线下传达，不需要使用「多人在线交流平台」，因此不会计入线上发送的消息。\n\n其实机房中的萌新们早已知道了「多人在线交流平台」的管理员密码，所以能够对其线路的连接方向做出修改。可无论他们怎么尝试，都不能恢复最开始时双向连接的状态了。机房中的萌新们当然希望能够尽可能地发送消息，所以他们想要知道，在机房的电脑仅被单向的线路连接时，每一时刻最多能有多少条消息被通过「多人在线交流平台」发送。\n\n为了简化问题，我们假设机房内的所有萌新均能够在同一时刻发送线上消息，并且每一个萌新可以同时向多个人发送消息。\n\n**简要题面：给一棵结点编号** $1\\sim n$**，结点权值** $a_i$**，且结点度数最大为** $p$ **的树。求将树的每条边改为有向边后下式的最大值：**\n\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{n}a_ia_j\\left[i\\rightarrow j\\right]$$\n\n$\\left[i\\rightarrow j\\right]$ **定义为：若编号为** $i$ **的结点能通过有向边到达编号为** $j$ **的结点，则值为** $1$**；否则值为** $0$**，且** $\\left[i\\rightarrow i\\right]=0$**。**", "inputFormat": "输入共 $(n+1)$ 行。\n\n第一行两个正整数 $n$ 和 $p$，分别代表机房内的电脑数与所有电脑的负荷的最大值。  \n第二行共 $n$ 个正整数，第 $i$ 个整数 $a_i$ 为使用第 $i$ 台电脑的萌新的数量。  \n接下来 $(n-1)$ 行，第 $(i+2)$ 行两个整数 $u_i,v_i$ ，表示第 $u_i$ 和 $v_i$ 台电脑之间原本有一条「多人在线交流平台」的双向线路。", "outputFormat": "输出一行一个整数，表示在某一时刻能够发送的消息数的最大值。", "hint": "### 样例解释\n\n能够发送的消息最多时的消息传递方向如下：\n\n![](https://i.loli.net/2019/10/30/3AsqcyzdY25E8gP.png)\n\n在该连接方式下发送消息最多的时刻，使用 $1$ 号电脑的 $1$ 个萌新向 $5$ 个萌新各发送了一条消息，共 $1\\times5=5$ 条消息；  \n使用 $2$ 号电脑的 $2$ 个萌新分别向 $3$ 个萌新各发送了一条消息，共 $2\\times3=6$ 条消息；  \n使用 $3$ 号电脑的 $3$ 个萌新不能向任何萌新发送线上消息，因此没有消息从该电脑发送；  \n使用 $4$ 号电脑的 $4$ 个萌新分别向 $6$ 个萌新各发送了一条消息，共 $4\\times6=24$ 条消息。  \n因此，在某一时刻，最多可以有 $5+6+24=35$ 条线上消息被发送。   \n可以使用枚举法验证，不存在一种单向的连接方式，使得在某一时刻发送的线上消息的数量能够达到 $36$ 条或更多。\n\n### 数据范围及约定\n\n对于 $10\\%$ 的数据，$n\\le10$；  \n对于另外 $10\\%$ 的数据，$n=p+1$；  \n对于另外 $10\\%$ 的数据，$p=2$；  \n对于另外 $10\\%$ 的数据，$p\\le20$；  \n对于另外 $10\\%$ 的数据，$p\\le40$；  \n\n对于所有数据，$2\\le n\\le10^5$，$2\\le p\\le50$，$1\\le a_i\\le100$，$1\\le u_i,v_i\\le n$。保证给出的双向连接线路能够使任意两台电脑之间的消息传输线路唯一。保证至少有一台电脑原本通过「多人在线交流平台」连接的线路数恰好为 $p$，且没有电脑原本连接的线路数大于 $p$。", "locale": "zh-CN"}}}
{"pid": "P5648", "type": "P", "difficulty": 5, "samples": [["3 2\n1 2 3\n1 1\n1 2", "2\n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["线段树", "倍增", "单调栈"], "title": "Mivik的神力", "background": "$\\textcolor{black}{\\text{M}} \\textcolor{red}{\\text{ivik}}$ 发怒了，机房的 $\\textcolor{grey}{\\text{deco}}$ 瑟瑟发抖", "description": "$\\textcolor{black}{\\text{M}} \\textcolor{red}{\\text{ivik}}$ 要写一篇文章，在写文章时，他有 $n$ 个备选的单词，第 $i$ 个单词有一个长度 $a_i$，$\\textcolor{black}{\\text{M}} \\textcolor{red}{\\text{ivik}}$ 可以选择从第 $i$ 个单词开始写作，一共写 $k$ 秒，第 $j$ 秒会写上第 $i+j-1(j\\in[1,k])$ 个单词，并且他在写作时每秒都会获得愉悦值，第 $j$ 秒的愉悦值为 $\\max_{l=i}^{i+j-1} a_l$，现在，请你帮他算出，他每一次写作获得的愉悦值之和。\n\n**一句话题意：给出一个序列和多组询问 $(l,q)$ ，求**\n\n$$\n\\sum_{i=l}^{l+q-1} \\max_{l\\le j\\le i}a_j\n$$\n\n**数据要求强制在线。**", "inputFormat": "第一行，两个数，$n$，$t$，代表词汇个数和问题个数\n\n第二行，$n$ 个数，第 $i$ 个数代表 $a_i$。\n\n接下来 $t$ 行，每行两个数，$u$，$v$，$l=1+(u \\oplus lastans)\\bmod n$，$q=1+(v \\oplus (lastans+1))\\bmod (n-l+1)$，代表查询从第 $l$ 秒开始，写作 $q$ 秒的愉悦度之和\n\n$lastans$ 表示上一次查询的答案，初始 $lastans$ 为 $0$。", "outputFormat": "对于每个询问，回答一行，代表答案。", "hint": "**样例解释**\n\n第一个询问 $1,1$，解密后得到 $l=2,q=1$ ，则按题意可得所求即为区间 $[2,2]$ 的最大值，为 $2$。\n\n第一个询问 $1,2$ ，解密后得到 $l=1,q=2$ ，则所求即为区间 $[1,1]$ 和区间 $[1,2]$ 的最大值之和，为 $3$。\n\n-----\n\n对于 $20\\%$ 的数据，$n \\leq 1000$，$t \\leq 1000$；\n\n对于 $100\\%$ 的数据，$n\\leq 500000$，$t\\leq 500000$，$1 \\leq a_i\\leq 10^9(i\\in [1,n])$。", "locale": "zh-CN", "translations": {"en": {"title": "Mivik's Divine Power", "background": "$\\textcolor{black}{\\text{M}} \\textcolor{red}{\\text{ivik}}$ is angry, and $\\textcolor{grey}{\\text{deco}}$ in the computer lab is trembling with fear.", "description": "$\\textcolor{black}{\\text{M}} \\textcolor{red}{\\text{ivik}}$ wants to write an article. While writing, he has $n$ candidate words. The $i$-th word has length $a_i$. $\\textcolor{black}{\\text{M}} \\textcolor{red}{\\text{ivik}}$ can choose to start writing from the $i$-th word and write for a total of $k$ seconds. In the $j$-th second, he writes the $(i+j-1)$-th word $(j\\in[1,k])$. While writing, he gains happiness points every second. The happiness points in the $j$-th second are $\\max_{l=i}^{i+j-1} a_l$. Now please help him compute, for each writing process, the sum of happiness points he gains.\n\n**One-sentence statement: Given a sequence and multiple queries $(l,q)$, compute**\n\n$$\n\\sum_{i=l}^{l+q-1} \\max_{l\\le j\\le i}a_j\n$$\n\n**The testdata requires mandatory online processing.**", "inputFormat": "The first line contains two integers $n$ and $t$, representing the number of words and the number of queries.\n\nThe second line contains $n$ integers. The $i$-th integer represents $a_i$.\n\nIn the next $t$ lines, each line contains two integers $u$ and $v$, where $l=1+(u \\oplus lastans)\\bmod n$ and $q=1+(v \\oplus (lastans+1))\\bmod (n-l+1)$. This represents a query asking for the sum of happiness points when starting from the $l$-th second and writing for $q$ seconds.\n\n$lastans$ denotes the answer to the previous query, with initial value $lastans=0$.", "outputFormat": "For each query, output one line containing the answer.", "hint": "**Sample Explanation**\n\nFor the first query $1,1$, after decoding we get $l=2,q=1$. Then according to the statement, the answer is the maximum value on interval $[2,2]$, which is $2$.\n\nFor the first query $1,2$, after decoding we get $l=1,q=2$. Then the answer is the sum of the maximum values on intervals $[1,1]$ and $[1,2]$, which is $3$.\n\n-----\n\nFor $20\\%$ of the testdata, $n \\leq 1000$ and $t \\leq 1000$.\n\nFor $100\\%$ of the testdata, $n\\leq 500000$, $t\\leq 500000$, and $1 \\leq a_i\\leq 10^9(i\\in [1,n])$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Mivik的神力", "background": "$\\textcolor{black}{\\text{M}} \\textcolor{red}{\\text{ivik}}$ 发怒了，机房的 $\\textcolor{grey}{\\text{deco}}$ 瑟瑟发抖", "description": "$\\textcolor{black}{\\text{M}} \\textcolor{red}{\\text{ivik}}$ 要写一篇文章，在写文章时，他有 $n$ 个备选的单词，第 $i$ 个单词有一个长度 $a_i$，$\\textcolor{black}{\\text{M}} \\textcolor{red}{\\text{ivik}}$ 可以选择从第 $i$ 个单词开始写作，一共写 $k$ 秒，第 $j$ 秒会写上第 $i+j-1(j\\in[1,k])$ 个单词，并且他在写作时每秒都会获得愉悦值，第 $j$ 秒的愉悦值为 $\\max_{l=i}^{i+j-1} a_l$，现在，请你帮他算出，他每一次写作获得的愉悦值之和。\n\n**一句话题意：给出一个序列和多组询问 $(l,q)$ ，求**\n\n$$\n\\sum_{i=l}^{l+q-1} \\max_{l\\le j\\le i}a_j\n$$\n\n**数据要求强制在线。**", "inputFormat": "第一行，两个数，$n$，$t$，代表词汇个数和问题个数\n\n第二行，$n$ 个数，第 $i$ 个数代表 $a_i$。\n\n接下来 $t$ 行，每行两个数，$u$，$v$，$l=1+(u \\oplus lastans)\\bmod n$，$q=1+(v \\oplus (lastans+1))\\bmod (n-l+1)$，代表查询从第 $l$ 秒开始，写作 $q$ 秒的愉悦度之和\n\n$lastans$ 表示上一次查询的答案，初始 $lastans$ 为 $0$。", "outputFormat": "对于每个询问，回答一行，代表答案。", "hint": "**样例解释**\n\n第一个询问 $1,1$，解密后得到 $l=2,q=1$ ，则按题意可得所求即为区间 $[2,2]$ 的最大值，为 $2$。\n\n第一个询问 $1,2$ ，解密后得到 $l=1,q=2$ ，则所求即为区间 $[1,1]$ 和区间 $[1,2]$ 的最大值之和，为 $3$。\n\n-----\n\n对于 $20\\%$ 的数据，$n \\leq 1000$，$t \\leq 1000$；\n\n对于 $100\\%$ 的数据，$n\\leq 500000$，$t\\leq 500000$，$1 \\leq a_i\\leq 10^9(i\\in [1,n])$。", "locale": "zh-CN"}}}
{"pid": "P5649", "type": "P", "difficulty": 7, "samples": [["5 5\n2 1\n3 1\n4 1\n5 2\n4\n1\n4\n1\n2\n1\n10 2 3\n3 1\n7 3 4\n6 3 3 2\n9 5 1", "9\n1\n1"], ["10 12\n2 1\n3 2\n4 2\n5 3\n6 4\n7 5\n8 2\n9 4\n10 9\n791\n868\n505\n658\n860\n623\n393\n717\n410\n173\n4\n0 8 800\n1 4\n2 8 2 103\n3 9\n4 4\n5 7 304\n6 8 8 410\n7 10 8\n8 1 8\n9 6 9\n10 2 3\n11 5", "173\n860\n103\n791\n608\n1557"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["平衡树", "动态树 LCT"], "title": "Sone1", "background": null, "description": "给你一棵 $n$ 个节点的有根树，点带权，有 $q$ 次操作，分为十二种：  \n\n- `0 x y` 表示将 $x$ 的子树中所有点权都改为 $y$；  \n- `1 x` 表示把树根换为 $x$ 节点；  \n- `2 x y z` 表示把 $x$ 到 $y$ 简单路径上所有点权改为 $z$；  \n- `3 x` 表示询问 $x$ 的子树中最小权值；   \n- `4 x` 表示询问 $x$ 的子树中最大权值；   \n- `5 x y` 表示将 $x$ 的子树中所有点权都增加 $y$；  \n- `6 x y z` 表示将  $x$ 到 $y$ 简单路径上所有点权加上 $z$；  \n- `7 x y` 表示询问 $x$ 到 $y$ 简单路径上的最小权值；   \n- `8 x y` 表示询问 $x$ 到 $y$ 简单路径上的最大权值；  \n- `9 x y` 表示把 $x$ 的父亲换为 $y$，若 $y$ 在 $x$ 的子树里则忽略此操作；  \n- `10 x y` 表示询问 $x$ 到 $y$ 简单路径上的点权和；  \n- `11 x` 表示询问 $x$ 的子树中点权和。", "inputFormat": "第一行两个正整数 $n,q$，表示节点数与操作数。  \n接下来 $n-1$ 行，每行两个正整数 $u,v$，表示 $u$ 和 $v$ 之间有一条边。  \n然后 $n$ 行，每行一个整数表示点权。  \n后面一行一个正整数表示初始的根。  \n最后 $q$ 行，每行若干个正整数，表示一次操作。", "outputFormat": "对于每个 $3,4,7,8,10,11$ 操作，输出一行一个整数表示答案。", "hint": "来源：BZOJ 3153\n\n【数据范围】  \n\n对于 $100\\%$ 的数据，$1\\le n,q \\le 10^5$，中间计算的所有值在 $[-2^{31},2^{31})$ 范围内。   \n由于本题过于难写，可以点击 [这里](https://darkbzoj.cc/data/3153.zip) 下载测试数据，本地通过后再提交。", "locale": "zh-CN", "translations": {"en": {"title": "Sone1", "background": "", "description": "You are given a rooted tree with $n$ nodes. Each node has a weight. There are $q$ operations in total, divided into 12 types:\n\n- `0 x y`: Set the weights of all nodes in the subtree of $x$ to $y$.\n- `1 x`: Change the root of the tree to node $x$.\n- `2 x y z`: Set the weights of all nodes on the simple path from $x$ to $y$ to $z$.\n- `3 x`: Query the minimum weight in the subtree of $x$.\n- `4 x`: Query the maximum weight in the subtree of $x$.\n- `5 x y`: Increase the weights of all nodes in the subtree of $x$ by $y$.\n- `6 x y z`: Add $z$ to the weights of all nodes on the simple path from $x$ to $y$.\n- `7 x y`: Query the minimum weight on the simple path from $x$ to $y$.\n- `8 x y`: Query the maximum weight on the simple path from $x$ to $y$.\n- `9 x y`: Change the parent of $x$ to $y$. If $y$ is in the subtree of $x$, ignore this operation.\n- `10 x y`: Query the sum of weights on the simple path from $x$ to $y$.\n- `11 x`: Query the sum of weights in the subtree of $x$.", "inputFormat": "The first line contains two positive integers $n, q$, representing the number of nodes and the number of operations.  \nThe next $n - 1$ lines each contain two positive integers $u, v$, indicating there is an edge between $u$ and $v$.  \nThen follow $n$ lines, each containing one integer, representing the node weight.  \nThe next line contains one positive integer, representing the initial root.  \nFinally, there are $q$ lines, each containing several positive integers, representing one operation.", "outputFormat": "For each operation of type $3, 4, 7, 8, 10, 11$, output one line with one integer, representing the answer.", "hint": "Source: BZOJ 3153\n\nConstraints\n\nFor $100\\%$ of the data, $1 \\le n, q \\le 10^5$, and all intermediate computed values are within $[-2^{31}, 2^{31})$.  \nSince this problem is very hard to implement, you can click [here](https://darkbzoj.cc/data/3153.zip) to download the testdata. Submit after passing locally.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Sone1", "background": null, "description": "给你一棵 $n$ 个节点的有根树，点带权，有 $q$ 次操作，分为十二种：  \n\n- `0 x y` 表示将 $x$ 的子树中所有点权都改为 $y$；  \n- `1 x` 表示把树根换为 $x$ 节点；  \n- `2 x y z` 表示把 $x$ 到 $y$ 简单路径上所有点权改为 $z$；  \n- `3 x` 表示询问 $x$ 的子树中最小权值；   \n- `4 x` 表示询问 $x$ 的子树中最大权值；   \n- `5 x y` 表示将 $x$ 的子树中所有点权都增加 $y$；  \n- `6 x y z` 表示将  $x$ 到 $y$ 简单路径上所有点权加上 $z$；  \n- `7 x y` 表示询问 $x$ 到 $y$ 简单路径上的最小权值；   \n- `8 x y` 表示询问 $x$ 到 $y$ 简单路径上的最大权值；  \n- `9 x y` 表示把 $x$ 的父亲换为 $y$，若 $y$ 在 $x$ 的子树里则忽略此操作；  \n- `10 x y` 表示询问 $x$ 到 $y$ 简单路径上的点权和；  \n- `11 x` 表示询问 $x$ 的子树中点权和。", "inputFormat": "第一行两个正整数 $n,q$，表示节点数与操作数。  \n接下来 $n-1$ 行，每行两个正整数 $u,v$，表示 $u$ 和 $v$ 之间有一条边。  \n然后 $n$ 行，每行一个整数表示点权。  \n后面一行一个正整数表示初始的根。  \n最后 $q$ 行，每行若干个正整数，表示一次操作。", "outputFormat": "对于每个 $3,4,7,8,10,11$ 操作，输出一行一个整数表示答案。", "hint": "来源：BZOJ 3153\n\n【数据范围】  \n\n对于 $100\\%$ 的数据，$1\\le n,q \\le 10^5$，中间计算的所有值在 $[-2^{31},2^{31})$ 范围内。   \n由于本题过于难写，可以点击 [这里](https://darkbzoj.cc/data/3153.zip) 下载测试数据，本地通过后再提交。", "locale": "zh-CN"}}}
{"pid": "P5650", "type": "P", "difficulty": 2, "samples": [["0111100101", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["贪心", "O2优化", "洛谷月赛"], "title": "基础字符串练习题", "background": "YSGH 牛逼", "description": "给定长度非零的非空 01 串 $S$。\n\n找出 $S$ 的非空连续子串 $T$ 满足串中 0 的个数减去 1 的个数最大。\n\n你只需要输出最大值即可。", "inputFormat": "一行一个 01 串表示 $S$。", "outputFormat": "一行一个数表示答案。", "hint": "设 $|S| = n$。\n\n| 数据点编号 | $n \\le$ |\n| :--: | :--: |\n| $1 \\sim 2$ | $10$ |\n| $3 \\sim 6$ | ${10}^3$ |\n| $7 \\sim 10$ | ${10}^5$ |\n\n对于 $100\\%$ 的数据，$1 \\le n \\le {10}^5$。", "locale": "zh-CN", "translations": {"en": {"title": "Basic String Practice Problem.", "background": "YSGH is awesome.", "description": "Given a non-empty binary string $S$ with non-zero length.\n\nFind a non-empty contiguous substring $T$ of $S$ such that the number of $0$ in the substring minus the number of $1$ in the substring is maximized.\n\nYou only need to output this maximum value.", "inputFormat": "One line containing a binary string representing $S$.", "outputFormat": "One line containing one number representing the answer.", "hint": "Let $|S| = n$.\n\n# Constraints\n\n| Test Point ID | $n \\le$ |\n| :--: | :--: |\n| $1 \\sim 2$ | $10$ |\n| $3 \\sim 6$ | ${10}^3$ |\n| $7 \\sim 10$ | ${10}^5$ |\n\nFor $100\\%$ of the testdata, $1 \\le n \\le {10}^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "基础字符串练习题", "background": "YSGH 牛逼", "description": "给定长度非零的非空 01 串 $S$。\n\n找出 $S$ 的非空连续子串 $T$ 满足串中 0 的个数减去 1 的个数最大。\n\n你只需要输出最大值即可。", "inputFormat": "一行一个 01 串表示 $S$。", "outputFormat": "一行一个数表示答案。", "hint": "设 $|S| = n$。\n\n| 数据点编号 | $n \\le$ |\n| :--: | :--: |\n| $1 \\sim 2$ | $10$ |\n| $3 \\sim 6$ | ${10}^3$ |\n| $7 \\sim 10$ | ${10}^5$ |\n\n对于 $100\\%$ 的数据，$1 \\le n \\le {10}^5$。", "locale": "zh-CN"}}}
{"pid": "P5651", "type": "P", "difficulty": 3, "samples": [["3 2 1\n1 2 2\n2 3 3\n1 3", "1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "最短路", "洛谷月赛"], "title": "基础最短路练习题", "background": "YSGH 牛逼", "description": "给定 $n$ 个点 $m$ 条边的简单无向连通图 $G$，边有边权。保证没有重边和自环。\n\n定义一条简单路径的权值为路径上所有边边权的异或和。\n\n保证 $G$ 中不存在简单环使得边权异或和不为 $0$。\n\n$Q$ 次询问 $x$ 到 $y$ 的最短简单路径。", "inputFormat": "第一行三个正整数 $n, m, Q$。\n\n接下来 $m$ 行，一行三个非负整数 $x, y, v$（$1 \\le x, y \\le n$），表示一条连接 $x, y$，权值为 $v$ 的无向边。保证没有重边和自环。\n\n接下来 $Q$ 行，一行两个正整数 $x, y$（$1 \\le x, y \\le n$），表示一次询问。", "outputFormat": "$Q$ 行，一行一个整数表示答案。", "hint": "| 数据点编号 | $n, Q \\le$ | 特殊性质 |\n| :--: | :--: | :--: |\n| $1,2$ | $10$ | 无 |\n| $3,4$ | $20$ | 无 |\n| $5,6$ | ${10}^5$ | $m = n - 1$ |\n| $7,8$ | ${10}^5$ | $v \\le 1$ |\n| $9,10$ | ${10}^5$ | 无 |\n\n对于 $100\\%$ 的数据，满足 $1 \\le n \\le {10}^5$，$1 \\le m \\le 2n$，$0 \\le v < 2^{30}$。", "locale": "zh-CN", "translations": {"en": {"title": "Basic Shortest Path Practice Problem.", "background": "YSGH is awesome.", "description": "Given a simple, undirected, connected graph $G$ with $n$ vertices and $m$ edges. Each edge has a weight. It is guaranteed that there are no multiple edges and no self-loops.\n\nDefine the weight of a simple path as the XOR sum of the weights of all edges on the path.\n\nIt is guaranteed that there is no simple cycle in $G$ whose edge-weight XOR sum is not $0$.\n\nThere are $Q$ queries asking for the shortest simple path from $x$ to $y$.", "inputFormat": "The first line contains three positive integers $n, m, Q$.\n\nThe next $m$ lines each contain three non-negative integers $x, y, v$ ($1 \\le x, y \\le n$), representing an undirected edge connecting $x$ and $y$ with weight $v$. It is guaranteed that there are no multiple edges and no self-loops.\n\nThe next $Q$ lines each contain two positive integers $x, y$ ($1 \\le x, y \\le n$), representing a query.", "outputFormat": "Output $Q$ lines, each containing one integer as the answer.", "hint": "| Test Point ID | $n, Q \\le$ | Special Property |\n| :--: | :--: | :--: |\n| $1,2$ | $10$ | None |\n| $3,4$ | $20$ | None |\n| $5,6$ | ${10}^5$ | $m = n - 1$ |\n| $7,8$ | ${10}^5$ | $v \\le 1$ |\n| $9,10$ | ${10}^5$ | None |\n\nFor $100\\%$ of the testdata, $1 \\le n \\le {10}^5$, $1 \\le m \\le 2n$, and $0 \\le v < 2^{30}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "基础最短路练习题", "background": "YSGH 牛逼", "description": "给定 $n$ 个点 $m$ 条边的简单无向连通图 $G$，边有边权。保证没有重边和自环。\n\n定义一条简单路径的权值为路径上所有边边权的异或和。\n\n保证 $G$ 中不存在简单环使得边权异或和不为 $0$。\n\n$Q$ 次询问 $x$ 到 $y$ 的最短简单路径。", "inputFormat": "第一行三个正整数 $n, m, Q$。\n\n接下来 $m$ 行，一行三个非负整数 $x, y, v$（$1 \\le x, y \\le n$），表示一条连接 $x, y$，权值为 $v$ 的无向边。保证没有重边和自环。\n\n接下来 $Q$ 行，一行两个正整数 $x, y$（$1 \\le x, y \\le n$），表示一次询问。", "outputFormat": "$Q$ 行，一行一个整数表示答案。", "hint": "| 数据点编号 | $n, Q \\le$ | 特殊性质 |\n| :--: | :--: | :--: |\n| $1,2$ | $10$ | 无 |\n| $3,4$ | $20$ | 无 |\n| $5,6$ | ${10}^5$ | $m = n - 1$ |\n| $7,8$ | ${10}^5$ | $v \\le 1$ |\n| $9,10$ | ${10}^5$ | 无 |\n\n对于 $100\\%$ 的数据，满足 $1 \\le n \\le {10}^5$，$1 \\le m \\le 2n$，$0 \\le v < 2^{30}$。", "locale": "zh-CN"}}}
