{"pid": "P10655", "type": "P", "difficulty": 4, "samples": [["1 17\n4 6 10", "11999999970"], ["2 11\n2 2 100\n3 5 5", "9999999890"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2017", "O2优化", "ROI（俄罗斯）"], "title": "[ROI 2017] 反物质 (Day 2)", "background": "", "description": "你研发出了 $n$ 种获得反物质的实验，你无法控制生成的数量，但是可以保证第 $i$ 种获得的反物质在区间 $[l_i,r_i]$ 内，并且成本为 $c_i$，每种实验可以使用多次。\n\n生成的反物质均会放在一个容器中，每次实验结束后，你可以得知容器中反物质的质量。容器中的反物质不能超过 $a$ 克（超过了就会爆炸）。\n\n如果第 $i$ **次**实验一共获得了 $t_i$ 单位的反物质，你可以将其卖给军方获得 $(10^9t_i-c)$ 卢布的利润，其中 $c$ 是该实验的成本。\n\n在保证安全的前提下，你想要知道你最坏情况下利润至少是多少。", "inputFormat": "第一行有两个整数 $n,a$。\n\n接下来的 $n$ 行中，每行三个整数 $l_i,r_i,c_i$。", "outputFormat": "输出一行，一个整数，表示你最多可以保证获得多少利润。", "hint": "#### 【样例解释】\n\n对于样例组 #1：\n\n我们只能使用实验 $1$，如果实验一次，得到的反物质区间在 $[4,6]$ 内；实验两次，区间在 $[8,12]$，如果此时得到了 $12$ 单位的反物质就不能继续做实验了，因为如果下一次得到 $6$ 单位的话，容器就会爆炸；其他情况我们可以继续做第三次实验，可能的区间是 $[12,17]$。\n\n这个时候无论如何都不能继续做实验了，原因同上，所以最坏情况下我们只能得到 $12$ 单位的反物质并且需要做三次实验，此时收益为 $3 \\times (10^9 \\times 4-10)=11999999970$。\n\n#### 【数据范围】\n\n本题仅放了部分数据，如需评测完整数据请左转 [LOJ P2772](https://loj.ac/p/2772)。\n\n对于所有数据，$1 \\le c_i \\le 100$，$1 \\le l_i \\le r_i \\le a$。\n\n| 子任务编号 | 分值 | $1 \\le n \\le$ | $1 \\le a \\le$ | 特殊限制 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $10$ | $1$ | $10^3$ | 无 |\n| $2$ | $10$ | $10$ | $10^3$ | $l_i=r_i$ |\n| $3$ | $20$ | $10$ | $10^3$ | 无 |\n| $4$ | $20$ | $100$ | $5 \\times 10^4$ | 无 |\n| $5$ | $40$ | $100$ | $2 \\times 10^6$ | 无 |\n\n注：原题有 $15$ 个子任务，方便起见，最后若干组除 $a$ 数据范围外相同的子任务合并为 $1$ 组子任务。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[ROI 2017] 反物质 (Day 2)", "background": "", "description": "你研发出了 $n$ 种获得反物质的实验，你无法控制生成的数量，但是可以保证第 $i$ 种获得的反物质在区间 $[l_i,r_i]$ 内，并且成本为 $c_i$，每种实验可以使用多次。\n\n生成的反物质均会放在一个容器中，每次实验结束后，你可以得知容器中反物质的质量。容器中的反物质不能超过 $a$ 克（超过了就会爆炸）。\n\n如果第 $i$ **次**实验一共获得了 $t_i$ 单位的反物质，你可以将其卖给军方获得 $(10^9t_i-c)$ 卢布的利润，其中 $c$ 是该实验的成本。\n\n在保证安全的前提下，你想要知道你最坏情况下利润至少是多少。", "inputFormat": "第一行有两个整数 $n,a$。\n\n接下来的 $n$ 行中，每行三个整数 $l_i,r_i,c_i$。", "outputFormat": "输出一行，一个整数，表示你最多可以保证获得多少利润。", "hint": "#### 【样例解释】\n\n对于样例组 #1：\n\n我们只能使用实验 $1$，如果实验一次，得到的反物质区间在 $[4,6]$ 内；实验两次，区间在 $[8,12]$，如果此时得到了 $12$ 单位的反物质就不能继续做实验了，因为如果下一次得到 $6$ 单位的话，容器就会爆炸；其他情况我们可以继续做第三次实验，可能的区间是 $[12,17]$。\n\n这个时候无论如何都不能继续做实验了，原因同上，所以最坏情况下我们只能得到 $12$ 单位的反物质并且需要做三次实验，此时收益为 $3 \\times (10^9 \\times 4-10)=11999999970$。\n\n#### 【数据范围】\n\n本题仅放了部分数据，如需评测完整数据请左转 [LOJ P2772](https://loj.ac/p/2772)。\n\n对于所有数据，$1 \\le c_i \\le 100$，$1 \\le l_i \\le r_i \\le a$。\n\n| 子任务编号 | 分值 | $1 \\le n \\le$ | $1 \\le a \\le$ | 特殊限制 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $10$ | $1$ | $10^3$ | 无 |\n| $2$ | $10$ | $10$ | $10^3$ | $l_i=r_i$ |\n| $3$ | $20$ | $10$ | $10^3$ | 无 |\n| $4$ | $20$ | $100$ | $5 \\times 10^4$ | 无 |\n| $5$ | $40$ | $100$ | $2 \\times 10^6$ | 无 |\n\n注：原题有 $15$ 个子任务，方便起见，最后若干组除 $a$ 数据范围外相同的子任务合并为 $1$ 组子任务。", "locale": "zh-CN"}}}
{"pid": "P10656", "type": "P", "difficulty": 7, "samples": [["7 5\n3 1 4 8 6 9 2\n2 7 4 10 1 5 3\n9 2 11 3 8\n3 5 3 4 12", "39\n2 6\n2 4"], ["2 3\n1 2\n1 4\n2 3 1\n17 2 15", "34\n0 0\n1 3"], ["3 3\n4 2 1\n10 1 2\n5 4 2\n1 2 9", "19\n1 1\n3 3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "贪心", "2017", "线段树", "Special Judge", "O2优化", "ROI（俄罗斯）"], "title": "[ROI 2017] 学习轨迹 (Day 2)", "background": "", "description": "THU 和 PKU 同时开设了一批课程，THU 有 $n$ 节课，PKU 有 $m$ 节课。\n\n其中 THU 第 $i$ 节课类别是 $a_i$，乐趣度是 $x_i$；PKU 第 $i$ 节课类别是 $b_i$，乐趣度是 $y_i$。保证 $a$ 中元素互不相同，$b$ 中元素互不相同，但是 $a$ 和 $b$ 之间可能有相同元素。\n\n你可以选择听 THU 的 $l_1 \\sim r_1$ 节课，收获到的乐趣度为所有你听的课的乐趣度的和；同时可以在 PKU 听 $l_2 \\sim r_2$ 节课，收获到的乐趣度也是所有你听的课的乐趣度的和。（当然你也可以选择只听一所大学的课甚至不听）\n\n同一类别的课你不能听两次，也就是如果 $a_{l_1 \\sim r_1}$ 中有元素与 $b_{l_2 \\sim r_2}$ 相同，那么这个听课方案就不能满足你的胃口。\n\n你需要求出可能的听课方案中乐趣度最大的是多少以及具体的安排。", "inputFormat": "第一行两个整数 $n,m$。\n\n接下来四行，每行一个整数序列，分别表示题目中的 $a,x,b,y$，这四个序列长度分别为 $n,n,m,m$。", "outputFormat": "第一行一个整数表示最大乐趣度。\n\n第二行两个整数 $l_1,r_1$，如果你不打算在 THU 听课，输出 `0 0`。\n\n第三行两个整数 $l_2,r_2$，如果你不打算在 PKU 听课，输出 `0 0`。", "hint": "#### 【样例解释】\n\n对于样例组 #1：\n\n最优解如样例所示，课程质量之和为 $(7 + 4 + 10 + 1 + 5) + (5 + 3 + 4) = 27 + 12 = 39$。\n\n对于样例组 #2：\n\n由于 PKU 的 $1$ 号、$2$ 号课程相比 THU 的相同课程的质量要高得多，因此最优解是不去 THU 听课，转而在 PKU 读 $1\\sim 3$ 号课程。\n\n#### 【数据范围】\n\n注：本题只放部分数据，完整数据请左转 [LOJ P2773](https://loj.ac/p/2773) 评测。\n\n对于所有数据满足：$1 \\le a_i,b_i \\le n+m$，$1 \\le x_i,y_i \\le 10^9$，$a_i \\ne a_j(i \\ne j)$，$b_i \\ne b_j(i \\ne j)$。\n\n| 子任务编号 | 分值 | $1 \\le n,m \\le $ |\n| :----------: | :----------: | :----------: |\n| $1$ | $10$ | $50$ |\n| $2$ | $10$ | $100$ |\n| $3$ | $10$ | $300$ |\n| $4$ | $10$ | $500$ |\n| $5$ | $10$ | $2000$ |\n| $6$ | $5$ | $5000$ |\n| $7$ | $5$ | $10^4$ |\n| $8$ | $10$ | $3 \\times 10^4$ |\n| $9$ | $10$ | $10^5$ |\n| $10$ | $10$ | $2.5 \\times 10^5$ |\n| $11$ | $10$ | $5 \\times 10^5$ |\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[ROI 2017] 学习轨迹 (Day 2)", "background": "", "description": "THU 和 PKU 同时开设了一批课程，THU 有 $n$ 节课，PKU 有 $m$ 节课。\n\n其中 THU 第 $i$ 节课类别是 $a_i$，乐趣度是 $x_i$；PKU 第 $i$ 节课类别是 $b_i$，乐趣度是 $y_i$。保证 $a$ 中元素互不相同，$b$ 中元素互不相同，但是 $a$ 和 $b$ 之间可能有相同元素。\n\n你可以选择听 THU 的 $l_1 \\sim r_1$ 节课，收获到的乐趣度为所有你听的课的乐趣度的和；同时可以在 PKU 听 $l_2 \\sim r_2$ 节课，收获到的乐趣度也是所有你听的课的乐趣度的和。（当然你也可以选择只听一所大学的课甚至不听）\n\n同一类别的课你不能听两次，也就是如果 $a_{l_1 \\sim r_1}$ 中有元素与 $b_{l_2 \\sim r_2}$ 相同，那么这个听课方案就不能满足你的胃口。\n\n你需要求出可能的听课方案中乐趣度最大的是多少以及具体的安排。", "inputFormat": "第一行两个整数 $n,m$。\n\n接下来四行，每行一个整数序列，分别表示题目中的 $a,x,b,y$，这四个序列长度分别为 $n,n,m,m$。", "outputFormat": "第一行一个整数表示最大乐趣度。\n\n第二行两个整数 $l_1,r_1$，如果你不打算在 THU 听课，输出 `0 0`。\n\n第三行两个整数 $l_2,r_2$，如果你不打算在 PKU 听课，输出 `0 0`。", "hint": "#### 【样例解释】\n\n对于样例组 #1：\n\n最优解如样例所示，课程质量之和为 $(7 + 4 + 10 + 1 + 5) + (5 + 3 + 4) = 27 + 12 = 39$。\n\n对于样例组 #2：\n\n由于 PKU 的 $1$ 号、$2$ 号课程相比 THU 的相同课程的质量要高得多，因此最优解是不去 THU 听课，转而在 PKU 读 $1\\sim 3$ 号课程。\n\n#### 【数据范围】\n\n注：本题只放部分数据，完整数据请左转 [LOJ P2773](https://loj.ac/p/2773) 评测。\n\n对于所有数据满足：$1 \\le a_i,b_i \\le n+m$，$1 \\le x_i,y_i \\le 10^9$，$a_i \\ne a_j(i \\ne j)$，$b_i \\ne b_j(i \\ne j)$。\n\n| 子任务编号 | 分值 | $1 \\le n,m \\le $ |\n| :----------: | :----------: | :----------: |\n| $1$ | $10$ | $50$ |\n| $2$ | $10$ | $100$ |\n| $3$ | $10$ | $300$ |\n| $4$ | $10$ | $500$ |\n| $5$ | $10$ | $2000$ |\n| $6$ | $5$ | $5000$ |\n| $7$ | $5$ | $10^4$ |\n| $8$ | $10$ | $3 \\times 10^4$ |\n| $9$ | $10$ | $10^5$ |\n| $10$ | $10$ | $2.5 \\times 10^5$ |\n| $11$ | $10$ | $5 \\times 10^5$ |\n", "locale": "zh-CN"}}}
{"pid": "P10657", "type": "P", "difficulty": 6, "samples": [["5 3 4\n1 2\n4 3\n4 5\n2 3\n1 3\n4 5\n2 4", "No\n3\n2\n5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["并查集", "O2优化", "动态树 LCT"], "title": "BZOJ4998 星球联盟", "background": "", "description": "在遥远的 S 星系中一共有 $n$ 个星球，编号为 $1\\sim n$。其中的一些星球决定组成联盟，以方便相互间的交流。但是，组成联盟的首要条件就是交通条件。\n\n初始时，在这 $n$ 个星球间有 $m$ 条太空隧道。每条太空隧道连接两个星球，使得它们能够相互到达。若两个星球属于同一个联盟，则必须存在一条环形线路经过这两个星球，即两个星球间存在两条没有公共隧道的路径。为了壮大联盟的队伍，这些星球将建设 $p$ 条新的太空隧道。这 $p$ 条新隧道将按顺序依次建成。一条新轨道建成后，可能会使一些星球属于同一个联盟。\n\n你的任务是计算出，在一条新隧道建设完毕后，判断这条新轨道连接的两个星球是否属于同一个联盟，如果属于同一个联盟就计算出这个联盟中有多少个星球。", "inputFormat": "第一行三个整数 $n,m,p$，分别表示总星球数，初始时太空隧道的数目和即将建设的轨道数目。\n\n第 $2\\sim m+1$ 行，每行两个整数，表示初始时的每条太空隧道连接的两个星球编号。\n\n第 $m+2$ 行到第 $m+p+1$ 行，每行两个整数，表示新建的太空隧道连接的两个星球编号。\n\n这些太空隧道按照输入的顺序依次建成。", "outputFormat": "输出共 $p$ 行：\n\n- 如果这条新的太空隧道连接的两个星球属于同一个联盟，就输出一个整数，表示这两个星球所在联盟的星球数。\n- 如果这条新的太空隧道连接的两个星球不属于同一个联盟，就输出 No。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/qo7hp42y.png)\n\n数据保证，$1\\leq n,m,p \\leq 2\\times 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "BZOJ4998 星球联盟", "background": "", "description": "在遥远的 S 星系中一共有 $n$ 个星球，编号为 $1\\sim n$。其中的一些星球决定组成联盟，以方便相互间的交流。但是，组成联盟的首要条件就是交通条件。\n\n初始时，在这 $n$ 个星球间有 $m$ 条太空隧道。每条太空隧道连接两个星球，使得它们能够相互到达。若两个星球属于同一个联盟，则必须存在一条环形线路经过这两个星球，即两个星球间存在两条没有公共隧道的路径。为了壮大联盟的队伍，这些星球将建设 $p$ 条新的太空隧道。这 $p$ 条新隧道将按顺序依次建成。一条新轨道建成后，可能会使一些星球属于同一个联盟。\n\n你的任务是计算出，在一条新隧道建设完毕后，判断这条新轨道连接的两个星球是否属于同一个联盟，如果属于同一个联盟就计算出这个联盟中有多少个星球。", "inputFormat": "第一行三个整数 $n,m,p$，分别表示总星球数，初始时太空隧道的数目和即将建设的轨道数目。\n\n第 $2\\sim m+1$ 行，每行两个整数，表示初始时的每条太空隧道连接的两个星球编号。\n\n第 $m+2$ 行到第 $m+p+1$ 行，每行两个整数，表示新建的太空隧道连接的两个星球编号。\n\n这些太空隧道按照输入的顺序依次建成。", "outputFormat": "输出共 $p$ 行：\n\n- 如果这条新的太空隧道连接的两个星球属于同一个联盟，就输出一个整数，表示这两个星球所在联盟的星球数。\n- 如果这条新的太空隧道连接的两个星球不属于同一个联盟，就输出 No。", "hint": "![](https://cdn.luogu.com.cn/upload/image_hosting/qo7hp42y.png)\n\n数据保证，$1\\leq n,m,p \\leq 2\\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P10658", "type": "P", "difficulty": 6, "samples": [["9 31\n10 20 30 40 50 60 70 80 90\n3 1 2\n1 1 3\n1 1 2\n1 8 9\n1 2 4\n1 2 5\n1 4 6\n1 4 7\n3 1 8\n3 8 8\n1 8 9\n3 8 8\n3 7 5\n3 7 3\n1 4 1\n3 7 5\n3 7 3\n1 5 7\n3 6 5\n3 3 6\n1 2 4\n1 5 5\n3 3 6\n2 8 180\n3 8 8\n2 9 190\n3 9 9\n2 5 150\n3 3 6\n2 1 210\n3 3 6", "-1\n-1\n80\n170\n180\n170\n190\n170\n250\n280\n280\n270\n370\n380\n580"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "动态树 LCT"], "title": "BZOJ2959 长跑", "background": "某校开展了同学们喜闻乐见的阳光长跑活动。为了能“为祖国健康工作五十年”，同学们纷纷离开寝室，离开教室，离开实验室，到操场参加 $3000$ 米长跑运动。一时间操场上熙熙攘攘，摩肩接踵，盛况空前。", "description": "为了让同学们更好地监督自己，学校推行了刷卡机制。学校中有 $n$ 个地点，用 $1\\sim n$ 的整数表示，每个地点设有若干个刷卡机。\n\n有以下三类事件：\n1. 修建了一条连接 $A$ 地点和 $B$ 地点的跑道；\n2. $A$ 地点的刷卡机台数变为了 $B$；\n3. 进行了一次长跑。问一个同学从 $A$ 地点出发，最后到达 $B$ 地点最多可以刷卡多少次。具体的要求如下：\n   - 当同学到达一个地点时，他可以在这里的每一台刷卡机上都刷卡。但每台刷卡机只能刷卡一次，即使多次到达同一地点也不能多次刷卡。为了安全起见，每条跑道都需要设定一个方向，这条跑道只能按照这个方向单向通行。最多的刷卡次数即为在任意设定跑道方向，按照任意路径从 $A$ 地点到 $B$ 地点能刷卡的最多次数。", "inputFormat": "第一行输入两个正整数 $n,m$；\n\n第二行输入 $n$ 个正整数，第 $i$ 个正整数为第 $i$ 个地点的刷卡机个数。\n\n接下来 $m$ 行，每行包含三个非负整数 $P,A,B$ 代表一个事件，$P$ 为事件类型，$A,B$ 为事件的两个参数。", "outputFormat": "对于每个 $P=3$ 的事件输出一行，包含一个整数，为按照任意路径从 $A$ 地点到 $B$ 地点能刷卡的最多次数。如果不能到达，输出 $-1$。", "hint": "对于所有数据，$1\\leq m\\leq 5n$，$1\\leq n\\leq 1.5\\times 10^5$。\n\n保证最初所有地点之间都没有跑道。\n\n每行相邻的两个数之间均用一个空格隔开。\n\n表示地点编号的数均在 $1$ 到 $n$ 之间，每个地点的刷卡机台数始终不超过 $10^4$，$P \\in \\{1,2,3\\}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "BZOJ2959 长跑", "background": "某校开展了同学们喜闻乐见的阳光长跑活动。为了能“为祖国健康工作五十年”，同学们纷纷离开寝室，离开教室，离开实验室，到操场参加 $3000$ 米长跑运动。一时间操场上熙熙攘攘，摩肩接踵，盛况空前。", "description": "为了让同学们更好地监督自己，学校推行了刷卡机制。学校中有 $n$ 个地点，用 $1\\sim n$ 的整数表示，每个地点设有若干个刷卡机。\n\n有以下三类事件：\n1. 修建了一条连接 $A$ 地点和 $B$ 地点的跑道；\n2. $A$ 地点的刷卡机台数变为了 $B$；\n3. 进行了一次长跑。问一个同学从 $A$ 地点出发，最后到达 $B$ 地点最多可以刷卡多少次。具体的要求如下：\n   - 当同学到达一个地点时，他可以在这里的每一台刷卡机上都刷卡。但每台刷卡机只能刷卡一次，即使多次到达同一地点也不能多次刷卡。为了安全起见，每条跑道都需要设定一个方向，这条跑道只能按照这个方向单向通行。最多的刷卡次数即为在任意设定跑道方向，按照任意路径从 $A$ 地点到 $B$ 地点能刷卡的最多次数。", "inputFormat": "第一行输入两个正整数 $n,m$；\n\n第二行输入 $n$ 个正整数，第 $i$ 个正整数为第 $i$ 个地点的刷卡机个数。\n\n接下来 $m$ 行，每行包含三个非负整数 $P,A,B$ 代表一个事件，$P$ 为事件类型，$A,B$ 为事件的两个参数。", "outputFormat": "对于每个 $P=3$ 的事件输出一行，包含一个整数，为按照任意路径从 $A$ 地点到 $B$ 地点能刷卡的最多次数。如果不能到达，输出 $-1$。", "hint": "对于所有数据，$1\\leq m\\leq 5n$，$1\\leq n\\leq 1.5\\times 10^5$。\n\n保证最初所有地点之间都没有跑道。\n\n每行相邻的两个数之间均用一个空格隔开。\n\n表示地点编号的数均在 $1$ 到 $n$ 之间，每个地点的刷卡机台数始终不超过 $10^4$，$P \\in \\{1,2,3\\}$。", "locale": "zh-CN"}}}
{"pid": "P10659", "type": "P", "difficulty": 6, "samples": [["5 8 1\n1 2\n2 3\n3 4\n4 5\nSum 2 4\nIncrease 3 5 3\nMinor 1 4\nSum 4 5\nInvert 1 3\nMajor 1 2\nIncrease 1 5 2\nSum 1 5", "0\n0\n6\n3\n19"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["平衡树", "O2优化", "树链剖分", "动态树 LCT"], "title": "BZOJ3159 决战", "background": "", "description": "Katharon 国有 $n$ 个城市，编号为 $1\\sim n$。出于勤俭节约，不铺张浪费的考虑，城市间只连有 $n-1$ 条道路，使得可以从一个城市出发沿着道路走到另一座城市。\n\n现在 X 国的飞船降落在了某个城市，并把它改造成了自己的据点。X 国占领其他国家的一贯做法是，在据点里造一堆工厂生产战斗机器人，然后沿着被侵略国的道路运送到其他城市。X 国的司令向来不走回头路，而且崇尚团结与绝对的公平，因此运送战斗机器人时，会先选择一个终点，再在从据点到终点的路径上选择一个起点，然后把机器人均匀分配到起点到终点路径上的每个城市。同时，为了重新分配机器人，X 国的司令还会下令，按照与运送机器人相同的方法选择起点和终点，然后翻转这条路径上城市的机器人的数量。比如，选定的路径上的城市的机器人数依次为 $1,2,3,4,5$，翻转之后就变成了 $5,4,3,2,1$。\n\nKanari 国王手中的圆盘上浮现出了 Katharon 国的地图。不仅如此,上面还标出了 X 国据点在 $r$ 号城市，并显示出了 X 国司令刚刚下达的指令。“太好了！”国王欢呼，“我们能第一时间掌握敌人的布局，就一定能击退 X 国的侵略者！”\n\n但是还有一个问题没有解决。圆盘上只显示了指令，却没有标出每个城市的机器人数量，这让国王很是头疼。于是他找到了你，想让你帮忙设计一个程序来回答国王的询问。国王只关心某两个点之间路径上的城市的机器人和、最大值以及最小值，以便确定兵力部署、攻击要点和敌方的薄弱点。\n\nX 国司令的指令和 Kanari 国王的询问如下：\n\n1. `Increase x y w` 运送一批机器人到从 $x$ 到 $y$ 的路径上的城市，并分配给每个城市 $w$ 个机器人；\n2. `Sum x y` 询问从 $x$ 到 $y$ 的路径上的城市的机器人数量之和。\n3. `Major x y` 询问从 $x$ 到 $y$ 的路径上的城市的机器人数量的最大值。\n4. `Minor x y` 询问从 $x$ 到 $y$ 的路径上的城市的机器人数量的最小值。\n5. `Invert x y` 翻转从 $x$ 到 $y$ 的路径上的城市的机器人数量。\n\n对于 X 国司令的指令，保证给定的 $x,y$ 满足上文所述的要求。对于 Kanari 国王的询问，**不**保证给定的 $x,y$ 满足上述要求。", "inputFormat": "第一行有三个整数 $n,m,r$，分别表示树的节点数、指令和询问总数，以及 X 国的据点。\n\n接下来 $n-1$ 行，每行两个整数 $x$ 和 $y$，表示 Katharon 国的一条道路。\n\n接下来 $m$ 行，每行描述一个指令或询问，格式见题目描述。", "outputFormat": "对于每个询问操作，输出所求的值。", "hint": "数据保证，$1\\leq n,m\\leq 5\\times 10^4$，且对于运送操作 $1\\leq w\\leq 10^3$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "BZOJ3159 决战", "background": "", "description": "Katharon 国有 $n$ 个城市，编号为 $1\\sim n$。出于勤俭节约，不铺张浪费的考虑，城市间只连有 $n-1$ 条道路，使得可以从一个城市出发沿着道路走到另一座城市。\n\n现在 X 国的飞船降落在了某个城市，并把它改造成了自己的据点。X 国占领其他国家的一贯做法是，在据点里造一堆工厂生产战斗机器人，然后沿着被侵略国的道路运送到其他城市。X 国的司令向来不走回头路，而且崇尚团结与绝对的公平，因此运送战斗机器人时，会先选择一个终点，再在从据点到终点的路径上选择一个起点，然后把机器人均匀分配到起点到终点路径上的每个城市。同时，为了重新分配机器人，X 国的司令还会下令，按照与运送机器人相同的方法选择起点和终点，然后翻转这条路径上城市的机器人的数量。比如，选定的路径上的城市的机器人数依次为 $1,2,3,4,5$，翻转之后就变成了 $5,4,3,2,1$。\n\nKanari 国王手中的圆盘上浮现出了 Katharon 国的地图。不仅如此,上面还标出了 X 国据点在 $r$ 号城市，并显示出了 X 国司令刚刚下达的指令。“太好了！”国王欢呼，“我们能第一时间掌握敌人的布局，就一定能击退 X 国的侵略者！”\n\n但是还有一个问题没有解决。圆盘上只显示了指令，却没有标出每个城市的机器人数量，这让国王很是头疼。于是他找到了你，想让你帮忙设计一个程序来回答国王的询问。国王只关心某两个点之间路径上的城市的机器人和、最大值以及最小值，以便确定兵力部署、攻击要点和敌方的薄弱点。\n\nX 国司令的指令和 Kanari 国王的询问如下：\n\n1. `Increase x y w` 运送一批机器人到从 $x$ 到 $y$ 的路径上的城市，并分配给每个城市 $w$ 个机器人；\n2. `Sum x y` 询问从 $x$ 到 $y$ 的路径上的城市的机器人数量之和。\n3. `Major x y` 询问从 $x$ 到 $y$ 的路径上的城市的机器人数量的最大值。\n4. `Minor x y` 询问从 $x$ 到 $y$ 的路径上的城市的机器人数量的最小值。\n5. `Invert x y` 翻转从 $x$ 到 $y$ 的路径上的城市的机器人数量。\n\n对于 X 国司令的指令，保证给定的 $x,y$ 满足上文所述的要求。对于 Kanari 国王的询问，**不**保证给定的 $x,y$ 满足上述要求。", "inputFormat": "第一行有三个整数 $n,m,r$，分别表示树的节点数、指令和询问总数，以及 X 国的据点。\n\n接下来 $n-1$ 行，每行两个整数 $x$ 和 $y$，表示 Katharon 国的一条道路。\n\n接下来 $m$ 行，每行描述一个指令或询问，格式见题目描述。", "outputFormat": "对于每个询问操作，输出所求的值。", "hint": "数据保证，$1\\leq n,m\\leq 5\\times 10^4$，且对于运送操作 $1\\leq w\\leq 10^3$。", "locale": "zh-CN"}}}
{"pid": "P10660", "type": "P", "difficulty": 6, "samples": [["5\n2 2 1\n2 3 2\n2 4 3\n2 5 4\n2 3 5\n5\nA 1\nA 2\nC 5 3 1 1\nA 4\nA 5", "4276\n7141\n4256\n2126"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "动态树 LCT", "扩展欧几里德算法"], "title": "BZOJ2759 一个动态树好题", "background": "", "description": "有 $n$ 个未知数 $x_1,x_2,\\dots,x_n$ 和 $n$ 个等式组成的同余方程组：$x_i\\equiv k_i\\times x_{p_i} + b_i \\pmod {10007}$。\n\n你需要进行 $q$ 次操作，每次操作为下列两种情况之一：\n- `A a`，询问当前 $x_a$ 的解，无解输出 `-1`，多解输出 `-2` 否则输出 $x_a$。\n- `C a x y z`，修改一个等式 $k_a \\gets x,p_a \\gets y,b_a \\gets z$。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行三个整数 $k_i,p_i,b_i$。\n\n接下来一行一个整数 $q$。\n\n再接下来 $q$ 行，每行一个操作，见题意所述。", "outputFormat": "对每个询问，输出一行一个整数。", "hint": "对于所有数据，$k_i,b_i,x_i \\in [0,10007) \\cap \\Z$。$1\\leq n\\leq 3\\times 10^4$，$0\\leq q\\leq 10^5$，其中询问操作占总操作数的约 $80\\%$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "BZOJ2759 一个动态树好题", "background": "", "description": "有 $n$ 个未知数 $x_1,x_2,\\dots,x_n$ 和 $n$ 个等式组成的同余方程组：$x_i\\equiv k_i\\times x_{p_i} + b_i \\pmod {10007}$。\n\n你需要进行 $q$ 次操作，每次操作为下列两种情况之一：\n- `A a`，询问当前 $x_a$ 的解，无解输出 `-1`，多解输出 `-2` 否则输出 $x_a$。\n- `C a x y z`，修改一个等式 $k_a \\gets x,p_a \\gets y,b_a \\gets z$。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行三个整数 $k_i,p_i,b_i$。\n\n接下来一行一个整数 $q$。\n\n再接下来 $q$ 行，每行一个操作，见题意所述。", "outputFormat": "对每个询问，输出一行一个整数。", "hint": "对于所有数据，$k_i,b_i,x_i \\in [0,10007) \\cap \\Z$。$1\\leq n\\leq 3\\times 10^4$，$0\\leq q\\leq 10^5$，其中询问操作占总操作数的约 $80\\%$。", "locale": "zh-CN"}}}
{"pid": "P10661", "type": "P", "difficulty": 6, "samples": [["8 6\n1 2\n1 3\n2 8\n3 4\n3 5\n3 6\n4 7\nREQUEST 7\nRELEASE 3\nREQUEST 3\nRECENTER 5\nRELEASE 2\nREQUEST 1", "4.0000000000\n2.0000000000\n1.3333333333"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["Special Judge", "O2优化", "动态树 LCT"], "title": "BZOJ3779 重组病毒", "background": "黑客们通过对已有的病毒反编译，将许多不同的病毒重组，并重新编译出了新型的重组病毒。这种病毒的繁殖和变异能力极强。为了阻止这种病毒传播，某安全机构策划了一次实验，来研究这种病毒。", "description": "实验在一个封闭的局域网内进行。局域网内有 $n$ 台计算机，编号为 $1\\sim n$。一些计算机之间通过网线直接相连，形成树形的结构。局域网中有一台特殊的计算机，称之为核心计算机。根据一些初步的研究，研究员们拟定了一个一共 $m$ 步的实验。实验开始之前，核心计算机的编号为 $1$，每台计算机中都有病毒的一个变种，而且每台计算机中的变种都不相同。实验中的每一步会是下面中的一种操作：\n\n- `RELEASE x`。在编号为 $x$ 的计算机中植入病毒的一个新变种。这个变种在植入之前不存在于局域网中。\n- `RECENTER x`。将核心计算机改为编号为 $x$ 的计算机。但是这个操作会导致原来核心计算机中的病毒产生新变种，并感染过来。换言之，假设操作前的核心计算机编号为 $y$，相当于在操作后附加了一次 `RELEASE y` 的操作。\n\n根据研究的结论，在植入一个新变种时，病毒会在局域网中搜索核心计算机的位置，并沿着网络中最短的路径感染过去。\n\n而第一轮实验揭露了一个惊人的真相：病毒的不同变种是互斥的。新变种在感染一台已经被旧变种感染的电脑时，会把旧变种完全销毁之后再感染。但研究员发现了实现过程中的漏洞。如果新变种在感染过程中尚未销毁过这类旧变种，需要先花费 $1$ 单位时间分析旧变种，才能销毁。如果之前销毁过这类旧变种，就可以认为销毁不花费时间。病毒在两台计算机之间的传播亦可认为不花费时间。\n\n研究员对整个感染过程的耗时特别感兴趣，因为这是消灭病毒的最好时机。于是在 $m$ 步步实验之中，研究员有时还会做出如下的询问：\n\n- `REQUEST x`。询问如果在编号为 $x$ 的计算机的关键集合中的计算机中植入一个新变种，平均感染时间为多长。编号为 $y$ 的计算机在编号为 $x$ 的计算机的关键集合中，当且仅当从 $y$ 沿网络中的最短路径感染到核心计算机必须经过 $x$。由于有 `RECENTER` 操作的存在，这个集合并不一定是始终不变的。\n\n至此，安全机构认为已经不需要实际的实验了，于是他们拜托你编写一个程序，模拟实验的结果，并回答所有的询问。", "inputFormat": "输入的第一行包含两个整数 $n$ 和 $m$，分别代表局域网中计算机的数量，以及操作和询问的总数。\n\n接下来 $n-1$ 行，每行包含两个整数 $x$ 和 $y$，表示局域网中编号为 $x$ 和 $y$ 的计算机之间有网线直接相连。\n\n接下来 $m$ 行，每行包含一个操作或者询问，格式如问题描述中所述。", "outputFormat": "对于每个询问，输出一个实数，代表平均感染时间。输出与答案的绝对误差不超过 $10^{-6}$ 时才会被视为正确。", "hint": "对于 $100\\%$ 的数据，$1\\leq n\\leq 10^5$，$1\\leq m\\leq 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "BZOJ3779 重组病毒", "background": "黑客们通过对已有的病毒反编译，将许多不同的病毒重组，并重新编译出了新型的重组病毒。这种病毒的繁殖和变异能力极强。为了阻止这种病毒传播，某安全机构策划了一次实验，来研究这种病毒。", "description": "实验在一个封闭的局域网内进行。局域网内有 $n$ 台计算机，编号为 $1\\sim n$。一些计算机之间通过网线直接相连，形成树形的结构。局域网中有一台特殊的计算机，称之为核心计算机。根据一些初步的研究，研究员们拟定了一个一共 $m$ 步的实验。实验开始之前，核心计算机的编号为 $1$，每台计算机中都有病毒的一个变种，而且每台计算机中的变种都不相同。实验中的每一步会是下面中的一种操作：\n\n- `RELEASE x`。在编号为 $x$ 的计算机中植入病毒的一个新变种。这个变种在植入之前不存在于局域网中。\n- `RECENTER x`。将核心计算机改为编号为 $x$ 的计算机。但是这个操作会导致原来核心计算机中的病毒产生新变种，并感染过来。换言之，假设操作前的核心计算机编号为 $y$，相当于在操作后附加了一次 `RELEASE y` 的操作。\n\n根据研究的结论，在植入一个新变种时，病毒会在局域网中搜索核心计算机的位置，并沿着网络中最短的路径感染过去。\n\n而第一轮实验揭露了一个惊人的真相：病毒的不同变种是互斥的。新变种在感染一台已经被旧变种感染的电脑时，会把旧变种完全销毁之后再感染。但研究员发现了实现过程中的漏洞。如果新变种在感染过程中尚未销毁过这类旧变种，需要先花费 $1$ 单位时间分析旧变种，才能销毁。如果之前销毁过这类旧变种，就可以认为销毁不花费时间。病毒在两台计算机之间的传播亦可认为不花费时间。\n\n研究员对整个感染过程的耗时特别感兴趣，因为这是消灭病毒的最好时机。于是在 $m$ 步步实验之中，研究员有时还会做出如下的询问：\n\n- `REQUEST x`。询问如果在编号为 $x$ 的计算机的关键集合中的计算机中植入一个新变种，平均感染时间为多长。编号为 $y$ 的计算机在编号为 $x$ 的计算机的关键集合中，当且仅当从 $y$ 沿网络中的最短路径感染到核心计算机必须经过 $x$。由于有 `RECENTER` 操作的存在，这个集合并不一定是始终不变的。\n\n至此，安全机构认为已经不需要实际的实验了，于是他们拜托你编写一个程序，模拟实验的结果，并回答所有的询问。", "inputFormat": "输入的第一行包含两个整数 $n$ 和 $m$，分别代表局域网中计算机的数量，以及操作和询问的总数。\n\n接下来 $n-1$ 行，每行包含两个整数 $x$ 和 $y$，表示局域网中编号为 $x$ 和 $y$ 的计算机之间有网线直接相连。\n\n接下来 $m$ 行，每行包含一个操作或者询问，格式如问题描述中所述。", "outputFormat": "对于每个询问，输出一个实数，代表平均感染时间。输出与答案的绝对误差不超过 $10^{-6}$ 时才会被视为正确。", "hint": "对于 $100\\%$ 的数据，$1\\leq n\\leq 10^5$，$1\\leq m\\leq 10^5$。", "locale": "zh-CN"}}}
{"pid": "P10662", "type": "P", "difficulty": 6, "samples": [["2 1000\n0 0\n1 2\n1\n1 1", "No"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "动态树 LCT", "分块"], "title": "BZOJ4202 石子游戏", "background": "", "description": "石子游戏是大家都很喜欢玩的一类游戏，这类游戏通常与石子的移动和取舍有关，往往可以让人在游戏中获得不少的乐趣。\n\n有一类树上石子游戏的规则是这样的：在一棵有根树上，每个结点都有着一定数目的石子，两个玩家轮流进行游戏。每次，每个玩家可以把不超过 $m$ 个的石子移动到它的父亲上，一次只能移动一个结点上的石子。显然，根结点没有父亲，故每个石子一旦移动到根结点便无法再次移动。问题是以某个结点为根的子树进行这样的游戏，是否存在先手必胜策略。\n\n为了增加这个游戏的难度，我们对这个游戏进行一些小小的修改。现在，我们的这棵树可能会长出新的结点。同时，每个结点上的石子数目可能会变化。请问，以某个节点为根的子树进行这样的石子游戏，是否存在先手必胜策略。本题要求强制在线。", "inputFormat": "第一行包含两个整数 $n,m$，表示初始时有 $n$ 个结点，每次移动不能超过 $m$ 个石子。\n\n第二行 $n$ 个正整数 $a_1,a_2,\\dots,a_n$，表示初始时候的石子数量，其中 $1$ 号结点为根结点。\n\n接下来 $n-1$ 行，每行两个整数 $u,v$，表示有一条从 $u$ 到 $v$ 的边。\n\n接下来一行一个正整数 $t$，表示操作的数目。\n\n接下来 $t$ 行，每行代表一个操作，每行的第一个数字代表操作类型，其中：\n\n- 若为 $1$，后跟一个整数 $v$，表示询问在 $v$ 的子树中做游戏先手是否必胜。\n- 若为 $2$，后跟两个整数 $x,y$，表示将结点 $x$ 的石子数修改为 $y$。\n- 若为 $3$，后跟三个整数 $u,v,x$，表示为 $u$ 结点添加一个儿子 $v$，其初始石子数为 $x$。", "outputFormat": "对于每一个询问，若先手必胜输出 `Yes`，否则输出 `No`。\n\n注：数据进行了强制在线处理，对于每一个操作，除类型名外，都需要异或之前回答为 `Yes` 的数目。", "hint": "对于 $100\\%$ 的数据，$1\\leq n,t\\leq 5\\times 10^4$，同时，保证任何时刻树中节点数目和编号都不会超过 $10^5$。其余数据的范围皆在 int 范围内。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "BZOJ4202 石子游戏", "background": "", "description": "石子游戏是大家都很喜欢玩的一类游戏，这类游戏通常与石子的移动和取舍有关，往往可以让人在游戏中获得不少的乐趣。\n\n有一类树上石子游戏的规则是这样的：在一棵有根树上，每个结点都有着一定数目的石子，两个玩家轮流进行游戏。每次，每个玩家可以把不超过 $m$ 个的石子移动到它的父亲上，一次只能移动一个结点上的石子。显然，根结点没有父亲，故每个石子一旦移动到根结点便无法再次移动。问题是以某个结点为根的子树进行这样的游戏，是否存在先手必胜策略。\n\n为了增加这个游戏的难度，我们对这个游戏进行一些小小的修改。现在，我们的这棵树可能会长出新的结点。同时，每个结点上的石子数目可能会变化。请问，以某个节点为根的子树进行这样的石子游戏，是否存在先手必胜策略。本题要求强制在线。", "inputFormat": "第一行包含两个整数 $n,m$，表示初始时有 $n$ 个结点，每次移动不能超过 $m$ 个石子。\n\n第二行 $n$ 个正整数 $a_1,a_2,\\dots,a_n$，表示初始时候的石子数量，其中 $1$ 号结点为根结点。\n\n接下来 $n-1$ 行，每行两个整数 $u,v$，表示有一条从 $u$ 到 $v$ 的边。\n\n接下来一行一个正整数 $t$，表示操作的数目。\n\n接下来 $t$ 行，每行代表一个操作，每行的第一个数字代表操作类型，其中：\n\n- 若为 $1$，后跟一个整数 $v$，表示询问在 $v$ 的子树中做游戏先手是否必胜。\n- 若为 $2$，后跟两个整数 $x,y$，表示将结点 $x$ 的石子数修改为 $y$。\n- 若为 $3$，后跟三个整数 $u,v,x$，表示为 $u$ 结点添加一个儿子 $v$，其初始石子数为 $x$。", "outputFormat": "对于每一个询问，若先手必胜输出 `Yes`，否则输出 `No`。\n\n注：数据进行了强制在线处理，对于每一个操作，除类型名外，都需要异或之前回答为 `Yes` 的数目。", "hint": "对于 $100\\%$ 的数据，$1\\leq n,t\\leq 5\\times 10^4$，同时，保证任何时刻树中节点数目和编号都不会超过 $10^5$。其余数据的范围皆在 int 范围内。", "locale": "zh-CN"}}}
{"pid": "P10663", "type": "P", "difficulty": 6, "samples": [["5\n1 233\n2 233\n3 233\n4 233\n5 233", "1\n5\n35\n42\n121"]], "limits": {"time": [4000], "memory": [524288]}, "tags": ["数论", "O2优化", "莫比乌斯反演", "容斥原理"], "title": "BZOJ4833 最小公倍佩尔数", "background": "题目来自 BZOJ 2017 年 4 月月赛。", "description": "令 $(1+\\sqrt{2})^n=e(n)+\\sqrt{2}f(n)$，其中 $e(n),f(n)$ 都是整数，显然有 $(1-\\sqrt{2})^n=e(n)-\\sqrt{2}f(n)$。令 $g(n)=\\operatorname{lcm}(f(1),f(2),\\dots,f(n))$。\n\n给定两个正整数 $n,p$，其中 $p$ 是质数，并且保证 $f(1),f(2),\\dots,f(n)$ 在模 $p$ 意义下均不为 $0$，请计算 $\\sum \\limits_{i=1}^n i\\times g(i)$ 模 $p$ 的值。", "inputFormat": "第一行包含一个正整数 $T$，表示有 $T$ 组数据。\n\n接下来是测试数据。每组测试数据只占一行，包含两个正整数 $n$ 和 $p$。", "outputFormat": "对于每组测试数据，输出一行一个非负整数，表示这组数据的答案。", "hint": "对于 $100\\%$ 的数据，$1\\leq T\\leq 210$，$1\\leq n\\leq 10^6$，$2\\leq p\\leq 10^9+7$，$\\sum n\\leq 3\\times 10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "BZOJ4833 最小公倍佩尔数", "background": "题目来自 BZOJ 2017 年 4 月月赛。", "description": "令 $(1+\\sqrt{2})^n=e(n)+\\sqrt{2}f(n)$，其中 $e(n),f(n)$ 都是整数，显然有 $(1-\\sqrt{2})^n=e(n)-\\sqrt{2}f(n)$。令 $g(n)=\\operatorname{lcm}(f(1),f(2),\\dots,f(n))$。\n\n给定两个正整数 $n,p$，其中 $p$ 是质数，并且保证 $f(1),f(2),\\dots,f(n)$ 在模 $p$ 意义下均不为 $0$，请计算 $\\sum \\limits_{i=1}^n i\\times g(i)$ 模 $p$ 的值。", "inputFormat": "第一行包含一个正整数 $T$，表示有 $T$ 组数据。\n\n接下来是测试数据。每组测试数据只占一行，包含两个正整数 $n$ 和 $p$。", "outputFormat": "对于每组测试数据，输出一行一个非负整数，表示这组数据的答案。", "hint": "对于 $100\\%$ 的数据，$1\\leq T\\leq 210$，$1\\leq n\\leq 10^6$，$2\\leq p\\leq 10^9+7$，$\\sum n\\leq 3\\times 10^6$。", "locale": "zh-CN"}}}
{"pid": "P10664", "type": "P", "difficulty": 6, "samples": [["1\n1 2 3", "1"]], "limits": {"time": [2000, 2000], "memory": [524288, 524288]}, "tags": ["原根", "数论", "O2优化", "矩阵乘法", "单位根反演"], "title": "BZOJ3328 PYXFIB", "background": null, "description": "给定整数 $n,k,p$，要求计算下列式子对 $p$ 取模的值：\n\n$$\\sum_{i=0}^{\\lfloor \\frac{n}{k} \\rfloor} C_n^{i\\times k}\\times F_{i\\times k}$$\n\n其中：\n- $p$ 为质数，且 $p$ 除以 $k$ 的余数为 $1$。\n- $C$ 为组合数，即 $C_n^m=\\frac{n!}{m!(n-m)!}$。\n- $F_n$ 为斐波那契数列，即 $F_0=1$，$F_1=1$，$F_n=F_{n-1}+F_{n-2}(n\\geq 2)$。", "inputFormat": "第一行输入一个正整数 $T$，表示数据组数。\n\n接下来 $T$ 行，每行三个正整数 $n,k,p$。", "outputFormat": "输出 $T$ 行，每行一个整数，表示结果。", "hint": "对于 $100\\%$ 的数据，保证 $1\\leq n\\leq 10^{18}$，$1\\leq k \\leq 20000$，$1\\leq T\\leq 20$，$1\\leq p\\leq 10^9$，$p$ 为质数，且 $p$ 除以 $k$ 的余数为 $1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "BZOJ3328 PYXFIB", "background": null, "description": "给定整数 $n,k,p$，要求计算下列式子对 $p$ 取模的值：\n\n$$\\sum_{i=0}^{\\lfloor \\frac{n}{k} \\rfloor} C_n^{i\\times k}\\times F_{i\\times k}$$\n\n其中：\n- $p$ 为质数，且 $p$ 除以 $k$ 的余数为 $1$。\n- $C$ 为组合数，即 $C_n^m=\\frac{n!}{m!(n-m)!}$。\n- $F_n$ 为斐波那契数列，即 $F_0=1$，$F_1=1$，$F_n=F_{n-1}+F_{n-2}(n\\geq 2)$。", "inputFormat": "第一行输入一个正整数 $T$，表示数据组数。\n\n接下来 $T$ 行，每行三个正整数 $n,k,p$。", "outputFormat": "输出 $T$ 行，每行一个整数，表示结果。", "hint": "对于 $100\\%$ 的数据，保证 $1\\leq n\\leq 10^{18}$，$1\\leq k \\leq 20000$，$1\\leq T\\leq 20$，$1\\leq p\\leq 10^9$，$p$ 为质数，且 $p$ 除以 $k$ 的余数为 $1$。", "locale": "zh-CN"}}}
{"pid": "P10665", "type": "P", "difficulty": 6, "samples": [["3 4\n2 1 E 1 2 N\n2 1 N 1 1 N\n3 1 N 2 1 N\n2 2 N 1 1 N", "TAK\nTAK\nNIE\nNIE"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["图论", "2013", "并查集", "O2优化", "ICPC"], "title": "[AMPPZ2013] Bytehattan", "background": "", "description": "比特哈顿镇有 $n\\times n$ 个格点，形成了一个网格图。一开始整张图是完整的。\n\n有 $k$ 次操作，每次会删掉图中的一条边 $(u,v)$，你需要回答在删除这条边之后 $u$ 和 $v$ 是否仍然连通。", "inputFormat": "第一行包含两个正整数 $n,k(2\\leq n\\leq 1500,1\\leq k\\leq 2n(n-1))$，表示网格图的大小以及操作的个数。\n\n接下来 $k$ 行，每行包含两条信息，每条信息包含两个正整数 $a,b(1\\leq a,b\\leq n)$ 以及一个字符 $c$（$c$ 为 `N` 或者 `E`）。\n\n如果 $c$ 为 `N`，表示删除 $(a,b)$ 到 $(a,b+1)$ 这条边；如果 $c$ 为 `E`，表示删除 $(a,b)$ 到 $(a+1,b)$ 这条边。\n\n数据进行了加密，对于每个操作，如果上一个询问回答为 TAK 或者这是第一个操作，那么只考虑第一条信息，否则只考虑第二条信息。数据保证每条边最多被删除一次。", "outputFormat": "输出 $k$ 行，对于每个询问，如果仍然连通，输出 TAK，否则输出 NIE。", "hint": "数据保证，$2\\leq n\\leq 1500$，$1\\leq k\\leq 2n(n-1)$，$1\\leq a,b\\leq n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[AMPPZ2013] Bytehattan", "background": "", "description": "比特哈顿镇有 $n\\times n$ 个格点，形成了一个网格图。一开始整张图是完整的。\n\n有 $k$ 次操作，每次会删掉图中的一条边 $(u,v)$，你需要回答在删除这条边之后 $u$ 和 $v$ 是否仍然连通。", "inputFormat": "第一行包含两个正整数 $n,k(2\\leq n\\leq 1500,1\\leq k\\leq 2n(n-1))$，表示网格图的大小以及操作的个数。\n\n接下来 $k$ 行，每行包含两条信息，每条信息包含两个正整数 $a,b(1\\leq a,b\\leq n)$ 以及一个字符 $c$（$c$ 为 `N` 或者 `E`）。\n\n如果 $c$ 为 `N`，表示删除 $(a,b)$ 到 $(a,b+1)$ 这条边；如果 $c$ 为 `E`，表示删除 $(a,b)$ 到 $(a+1,b)$ 这条边。\n\n数据进行了加密，对于每个操作，如果上一个询问回答为 TAK 或者这是第一个操作，那么只考虑第一条信息，否则只考虑第二条信息。数据保证每条边最多被删除一次。", "outputFormat": "输出 $k$ 行，对于每个询问，如果仍然连通，输出 TAK，否则输出 NIE。", "hint": "数据保证，$2\\leq n\\leq 1500$，$1\\leq k\\leq 2n(n-1)$，$1\\leq a,b\\leq n$。", "locale": "zh-CN"}}}
{"pid": "P10666", "type": "P", "difficulty": 6, "samples": [["10\n3 5 3 6 3 4 10 4 5 2", "9"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "分块", "快速傅里叶变换 FFT"], "title": "COUNTARI", "background": "", "description": "给定一个长度为 $n$ 的数组 $a$，求有多少对 $i,j,k(1\\leq i<j<k\\leq n)$，满足 $a_k-a_j=a_j-a_i$。", "inputFormat": "第一行一个整数 $n$，第二行 $n$ 个正整数 $a_i$。", "outputFormat": "一行一个整数表示所求的结果。", "hint": "数据保证，$1\\leq n\\leq 10^5$，$1\\leq a_i\\leq 3\\times 10^4$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "COUNTARI", "background": "", "description": "给定一个长度为 $n$ 的数组 $a$，求有多少对 $i,j,k(1\\leq i<j<k\\leq n)$，满足 $a_k-a_j=a_j-a_i$。", "inputFormat": "第一行一个整数 $n$，第二行 $n$ 个正整数 $a_i$。", "outputFormat": "一行一个整数表示所求的结果。", "hint": "数据保证，$1\\leq n\\leq 10^5$，$1\\leq a_i\\leq 3\\times 10^4$。", "locale": "zh-CN"}}}
{"pid": "P10667", "type": "P", "difficulty": 6, "samples": [["2 0.33\n3 0.316", "3\n19"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "类欧几里得算法"], "title": "BZOJ2712 [Violet 2] 棒球", "background": "", "description": "棒球中一项最原始简单的技术参数就是「安打率」。所谓「安打」，就是指打击手把投手投出来的球，击出到界内，使打者本身能至少安全上到一垒的情形。由于只有队员跑回本垒才能得分，安打是得分的最重要的途径。因此，安打率对于打击手来说也是非常重要的数据。顾名思义，安打率为安打数与打数的比值。如果一名打击手在 $5$ 次打击中出现了 $1$ 次安打，那么他的安打率就是 $0.2$。\n\nUruto 是一位业余棒球爱好者。有一次，他在训练中看到了自己的安打率数据。他发现这个数据是一个被四舍五入到了 $n$ 位小数的一个值。Uruto 想知道，他至少打击了多少次才有可能得到这样的安打率。", "inputFormat": "输入文件包含多个测试点。\n- 每个测试点占一行，包含一个整数 $n$ 和浮点数 $r$。其中 $r$ 是一个 $n$ 位小数，表示 Uruto 安打率的近似值。", "outputFormat": "对于每个测试点，在单独的一行内输出一个整数，表示 Uruto 最小可能的打击次数。", "hint": "对于 $20\\%$ 的数据，保证答案在 $1000$ 以内；\n\n对于所有数据，保证 $0<n\\leq 15$，测试点的数目在 $500$ 以内。\n\n如果一个棒球运动员的安打率在 $30\\%$ 以上，那么他就绝对是球队的栋梁了。出于这方面的考虑，保证所有的数据中 $0\\leq r<1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "BZOJ2712 [Violet 2] 棒球", "background": "", "description": "棒球中一项最原始简单的技术参数就是「安打率」。所谓「安打」，就是指打击手把投手投出来的球，击出到界内，使打者本身能至少安全上到一垒的情形。由于只有队员跑回本垒才能得分，安打是得分的最重要的途径。因此，安打率对于打击手来说也是非常重要的数据。顾名思义，安打率为安打数与打数的比值。如果一名打击手在 $5$ 次打击中出现了 $1$ 次安打，那么他的安打率就是 $0.2$。\n\nUruto 是一位业余棒球爱好者。有一次，他在训练中看到了自己的安打率数据。他发现这个数据是一个被四舍五入到了 $n$ 位小数的一个值。Uruto 想知道，他至少打击了多少次才有可能得到这样的安打率。", "inputFormat": "输入文件包含多个测试点。\n- 每个测试点占一行，包含一个整数 $n$ 和浮点数 $r$。其中 $r$ 是一个 $n$ 位小数，表示 Uruto 安打率的近似值。", "outputFormat": "对于每个测试点，在单独的一行内输出一个整数，表示 Uruto 最小可能的打击次数。", "hint": "对于 $20\\%$ 的数据，保证答案在 $1000$ 以内；\n\n对于所有数据，保证 $0<n\\leq 15$，测试点的数目在 $500$ 以内。\n\n如果一个棒球运动员的安打率在 $30\\%$ 以上，那么他就绝对是球队的栋梁了。出于这方面的考虑，保证所有的数据中 $0\\leq r<1$。", "locale": "zh-CN"}}}
{"pid": "P10668", "type": "P", "difficulty": 4, "samples": [["3\n3 2 1", "4.33"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "期望"], "title": "BZOJ2720 [Violet 5] 列队春游", "background": "", "description": "给定正整数数列 $h_1,h_2,\\cdots,h_n$。设 $p$ 为 $1\\sim n$ 的随机排列。\n\n定义 $h'_i=h_{p_i}$。定义 $\\mathrm{pre}_i$ 为最大的 $j\\lt i$ 满足 $h'_j\\ge h'_i$（如果不存在，规定为 $0$）。\n\n求出 $\\displaystyle \\sum_{i=1}^n (i-\\mathrm{pre}_i)$ 的期望值，保留两位小数输出。", "inputFormat": "第一行一个正整数 $n$，表示数列长度。\n\n第二行 $n$ 个正整数 $h_i$。", "outputFormat": "输出一行一个实数，表示答案，保留两位小数。", "hint": "对于 $20\\%$ 的数据，$1\\leq n\\leq 10$；\n\n对于 $50\\%$ 的数据，$1\\leq n\\leq 70$，且 $h_i$ 互不相同；\n\n对于 $100\\%$ 的数据，保证 $1\\leq n\\leq 300$，$1\\leq h_i\\leq 1000$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "BZOJ2720 [Violet 5] 列队春游", "background": "", "description": "给定正整数数列 $h_1,h_2,\\cdots,h_n$。设 $p$ 为 $1\\sim n$ 的随机排列。\n\n定义 $h'_i=h_{p_i}$。定义 $\\mathrm{pre}_i$ 为最大的 $j\\lt i$ 满足 $h'_j\\ge h'_i$（如果不存在，规定为 $0$）。\n\n求出 $\\displaystyle \\sum_{i=1}^n (i-\\mathrm{pre}_i)$ 的期望值，保留两位小数输出。", "inputFormat": "第一行一个正整数 $n$，表示数列长度。\n\n第二行 $n$ 个正整数 $h_i$。", "outputFormat": "输出一行一个实数，表示答案，保留两位小数。", "hint": "对于 $20\\%$ 的数据，$1\\leq n\\leq 10$；\n\n对于 $50\\%$ 的数据，$1\\leq n\\leq 70$，且 $h_i$ 互不相同；\n\n对于 $100\\%$ 的数据，保证 $1\\leq n\\leq 300$，$1\\leq h_i\\leq 1000$。", "locale": "zh-CN"}}}
{"pid": "P10669", "type": "P", "difficulty": 6, "samples": [["6 8\n1 2 3 1 4 2\n1 4 2 0 3 4\n2 3 5 1 2 1\n2 4 4 1 3 5\n3 5 2 0 1 3\n3 6 1 0 2 4\n4 5 7 1 3 2\n5 6 5 1 5 4", "21"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "线性规划"], "title": "BZOJ3118 Orz the MST", "background": "", "description": "给出一个带权的连通无向图，对于其中的每条边 $i$，在原来边权的基础上，其边权每增加 $1$ 需要付出的代价为 $a_i$，边权每减少 $1$ 需要付出的代价为 $b_i$。\n\n现在指定该图的一棵生成树，求通过修改边权，使得该生成树成为图的一棵最小生成树，需要付出的最少总代价。", "inputFormat": "第一行两个正整数 $n,m$，表示图的点数和边数，结点以 $1\\sim n$ 编号。\n\n接下来 $m$ 行，每行 $6$ 个正整数，$u_i,v_i,w_i,\\textit{ff}_i,a_i,b_i$，表示一条边 $(u_i,v_i)$ 的权值为 $w_i$，在原边权基础上增加 $1$ 的代价为 $a_i$，减少 $1$ 的边权代价为 $b_i$，$\\textit{ff}_i$ 若为 $1$ 则表示该边在指定的生成树中，若为 $0$ 则表示不在。数据保证 $\\textit{ff}_i$ 值为 $1$ 的边刚好组成原图的一棵生成树。两点之间可能有多条不同的边，但没有连接同一点的边。", "outputFormat": "输出一个正整数，表示所需付出的最少总代价。", "hint": "**【样例解释】**\n\n最优方案为：\n- $(1,4)$ 边权加 $2$，代价 $6$；\n- $(3,5)$ 边权加 $3$，代价 $3$；\n- $(3,6)$ 边权加 $4$，代价 $8$；\n- $(4,5)$ 边权减 $2$，代价 $4$；\n\n总代价为 $21$。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 300$，$1\\leq m,w_i,a_i,b_i\\leq 1000$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "BZOJ3118 Orz the MST", "background": "", "description": "给出一个带权的连通无向图，对于其中的每条边 $i$，在原来边权的基础上，其边权每增加 $1$ 需要付出的代价为 $a_i$，边权每减少 $1$ 需要付出的代价为 $b_i$。\n\n现在指定该图的一棵生成树，求通过修改边权，使得该生成树成为图的一棵最小生成树，需要付出的最少总代价。", "inputFormat": "第一行两个正整数 $n,m$，表示图的点数和边数，结点以 $1\\sim n$ 编号。\n\n接下来 $m$ 行，每行 $6$ 个正整数，$u_i,v_i,w_i,\\textit{ff}_i,a_i,b_i$，表示一条边 $(u_i,v_i)$ 的权值为 $w_i$，在原边权基础上增加 $1$ 的代价为 $a_i$，减少 $1$ 的边权代价为 $b_i$，$\\textit{ff}_i$ 若为 $1$ 则表示该边在指定的生成树中，若为 $0$ 则表示不在。数据保证 $\\textit{ff}_i$ 值为 $1$ 的边刚好组成原图的一棵生成树。两点之间可能有多条不同的边，但没有连接同一点的边。", "outputFormat": "输出一个正整数，表示所需付出的最少总代价。", "hint": "**【样例解释】**\n\n最优方案为：\n- $(1,4)$ 边权加 $2$，代价 $6$；\n- $(3,5)$ 边权加 $3$，代价 $3$；\n- $(3,6)$ 边权加 $4$，代价 $8$；\n- $(4,5)$ 边权减 $2$，代价 $4$；\n\n总代价为 $21$。\n\n**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 300$，$1\\leq m,w_i,a_i,b_i\\leq 1000$。", "locale": "zh-CN"}}}
{"pid": "P10670", "type": "P", "difficulty": 6, "samples": [["2 3 1 ", "7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "莫比乌斯反演"], "title": "BZOJ4174 tty 的求助", "background": "", "description": "计算下式对 $998244353$ 取模的值，其中 $x$ 为实数，其余参与运算的变量均为整数：\n\n$$\\sum_{n=1}^N \\sum_{m=1}^M \\sum_{k=0}^{m-1} \\lfloor \\dfrac{nk+x}{m}\\rfloor$$", "inputFormat": "输入一行，两个正整数 $N,M$ 和一个实数 $x$。", "outputFormat": "输出一行一个整数，表示答案对 $998244353$ 取模的值。", "hint": "数据保证，$1\\leq N,M\\leq 500000$，$0<x\\leq 100000$，$x$ 精确到小数点后 $8$ 位小数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "BZOJ4174 tty 的求助", "background": "", "description": "计算下式对 $998244353$ 取模的值，其中 $x$ 为实数，其余参与运算的变量均为整数：\n\n$$\\sum_{n=1}^N \\sum_{m=1}^M \\sum_{k=0}^{m-1} \\lfloor \\dfrac{nk+x}{m}\\rfloor$$", "inputFormat": "输入一行，两个正整数 $N,M$ 和一个实数 $x$。", "outputFormat": "输出一行一个整数，表示答案对 $998244353$ 取模的值。", "hint": "数据保证，$1\\leq N,M\\leq 500000$，$0<x\\leq 100000$，$x$ 精确到小数点后 $8$ 位小数。", "locale": "zh-CN"}}}
{"pid": "P10671", "type": "P", "difficulty": 6, "samples": [["3\n1 1\n1 0\n0 -1", "5.000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["计算几何", "O2优化", "随机化"], "title": "BZOJ1278 向量 vector", "background": "", "description": "一个二维向量 $(x,y)$ 的权定义为 $x^2+y^2$。已知一个由 $n$ 个二维向量组成的集合，求该集合的一个子集，使该子集中的向量和的权尽可能大。", "inputFormat": "第 $1$ 行一个正整数 $n$，表示 $n$ 个向量。\n\n下面 $n$ 行，每行 $2$ 个实数，表示 $n$ 个向量 $(x_i,y_i)$。", "outputFormat": "输出 $1$ 个实数，即向量和最大的权，精确到小数点后 $3$ 位。", "hint": "数据保证，$1\\leq n\\leq 100000$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "BZOJ1278 向量 vector", "background": "", "description": "一个二维向量 $(x,y)$ 的权定义为 $x^2+y^2$。已知一个由 $n$ 个二维向量组成的集合，求该集合的一个子集，使该子集中的向量和的权尽可能大。", "inputFormat": "第 $1$ 行一个正整数 $n$，表示 $n$ 个向量。\n\n下面 $n$ 行，每行 $2$ 个实数，表示 $n$ 个向量 $(x_i,y_i)$。", "outputFormat": "输出 $1$ 个实数，即向量和最大的权，精确到小数点后 $3$ 位。", "hint": "数据保证，$1\\leq n\\leq 100000$。", "locale": "zh-CN"}}}
{"pid": "P10672", "type": "P", "difficulty": 2, "samples": [["6\n2 3 3 4 1 1", "1 3 3 1 2 4"], ["2\n1 1", "-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["搜索", "Special Judge", "O2优化", "排列组合", "构造", "梦熊比赛"], "title": "【MX-S1-T1】 壁垒", "background": "原题链接：<https://oier.team/problems/S1A>。", "description": "给定一个长度为 $n$ 的仅包含正整数的数列 $a$，保证 $n$ 是偶数。你需要重排 $a$，满足对于 $a$ 的每个长度为偶数的前缀，出现的数字种类数是偶数，或断定这样的重排方式不存在。\n\n如果有多种重排方式满足条件，输出任意一种即可。", "inputFormat": "第一行一个正整数 $n$，保证 $n$ 是偶数。\n\n第二行一个 $n$ 个正整数，描述数列 $a$。", "outputFormat": "无解时输出 $-1$，否则输出一行 $n$ 个整数，描述重排后的数列 $a$。\n\n本题使用**自定义校验器**检验你的答案是否正确，如果有多种重排方式满足条件，输出任意一种即可。", "hint": "__【样例解释 1】__\n\n$\\{1,3\\},\\{1,3,3,1\\},\\{1,3,3,1,2,4\\}$ 这些集合的数字种类数都是偶数。\n\n__【数据范围】__\n\n__本题使用子任务捆绑测试。__\n\n对于 $100\\%$ 的数据，$2\\le n\\le 10^5$，$1\\le a_i\\le n$，保证 $n$ 是偶数。\n\n| 子任务编号 | $n\\le $ | $a_i\\le $ | 分值 |\n| ---------- | ------- | --------- | ---- |\n| $1$        | $10$    | $n$       | $20$ |\n| $2$        | $20$    | $n$       | $20$ |\n| $3$        | $10^5$  | $2$       | $20$ |\n| $4$        | $10^5$  | $10$      | $20$ |\n| $5$        | $10^5$  | $n$       | $20$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【MX-S1-T1】 壁垒", "background": "原题链接：<https://oier.team/problems/S1A>。", "description": "给定一个长度为 $n$ 的仅包含正整数的数列 $a$，保证 $n$ 是偶数。你需要重排 $a$，满足对于 $a$ 的每个长度为偶数的前缀，出现的数字种类数是偶数，或断定这样的重排方式不存在。\n\n如果有多种重排方式满足条件，输出任意一种即可。", "inputFormat": "第一行一个正整数 $n$，保证 $n$ 是偶数。\n\n第二行一个 $n$ 个正整数，描述数列 $a$。", "outputFormat": "无解时输出 $-1$，否则输出一行 $n$ 个整数，描述重排后的数列 $a$。\n\n本题使用**自定义校验器**检验你的答案是否正确，如果有多种重排方式满足条件，输出任意一种即可。", "hint": "__【样例解释 1】__\n\n$\\{1,3\\},\\{1,3,3,1\\},\\{1,3,3,1,2,4\\}$ 这些集合的数字种类数都是偶数。\n\n__【数据范围】__\n\n__本题使用子任务捆绑测试。__\n\n对于 $100\\%$ 的数据，$2\\le n\\le 10^5$，$1\\le a_i\\le n$，保证 $n$ 是偶数。\n\n| 子任务编号 | $n\\le $ | $a_i\\le $ | 分值 |\n| ---------- | ------- | --------- | ---- |\n| $1$        | $10$    | $n$       | $20$ |\n| $2$        | $20$    | $n$       | $20$ |\n| $3$        | $10^5$  | $2$       | $20$ |\n| $4$        | $10^5$  | $10$      | $20$ |\n| $5$        | $10^5$  | $n$       | $20$ |", "locale": "zh-CN"}}}
{"pid": "P10673", "type": "P", "difficulty": 4, "samples": [["5 4\n3 5 2 5 5\n3 2\n2 5\n1 5\n3 1", "1\n2"], ["5 15\n2 5 2 5 1\n2 1\n1 1\n1 2\n1 4\n1 1\n3 2\n1 1\n3 1\n1 5\n3 1\n1 2\n3 1\n2 1\n3 3\n2 2\n", "1\n5\n6\n7\n1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "贪心", "线段树", "树状数组", "O2优化", "梦熊比赛"], "title": "【MX-S1-T2】催化剂", "background": "原题链接：<https://oier.team/problems/S1B>。", "description": "小朋友们很喜欢糖果。\n\n现在，小 K 有一些糖果，每个糖果上有一个数字代表它的种类。\n\n有 $q$ 次事件，每次事件会加入一个糖果、或删除一个糖果、或提出一次询问。\n\n每次询问会给出一个 $k$，表示小 K 现在需要将所有糖果分给 $k$ 个小朋友，并且每个小朋友都需要得到至少一个糖果。同时，小朋友们不喜欢得到相同的糖果。具体的，在一个小朋友得到了糖果 $i$ 时，如果 Ta 在这个糖果之前就已经获得过糖果 $i$，那么 Ta 就会感到非常生气，Ta 的愤怒值就会增加 $1$。\n\n小 K 不喜欢看到小朋友们生气，但小 K 无法解决这么困难的问题，所以你需要帮小 K 求出一种分糖果的方式，最小化所有小朋友的愤怒值之和。\n\n保证存在一种分糖果的方案，使得每个小朋友都分到至少一个糖果。\n\n每次询问并没有真正的分糖果，即每次询问后小 K 拥有的糖果不会改变。\n\n注意，分糖果的过程可以理解为将小 K 拥有的所有糖果划分到 $k$ 个非空序列，可以重排。", "inputFormat": "第一行两个正整数 $n,q$。\n\n第二行 $n$ 个正整数 $a_1,a_2,\\dots,a_n$，描述初始时小 K 拥有的糖果。\n\n接下来 $q$ 行，每行两个正整数，描述一次操作，共有三种可能的输入：\n\n`1 x`：表示小 K 又拥有了一个种类为 $x$ 的糖果。\n\n`2 x`：表示小 K 丢失了一个种类为 $x$ 的糖果，保证此时小 K 拥有至少一个种类为 $x$ 的糖果。\n\n`3 k`：表示此时小 K 需要把糖果分给 $k$ 个小朋友，你需要求出最小的所有小朋友的愤怒值之和。令 $S$ 表示此时小 K 拥有的糖果数量，保证 $1\\le k\\le S$。", "outputFormat": "对于每次询问，输出一行一个整数，表示你求出的答案。", "hint": "__【样例解释 1】__\n\n第一次询问时，小 K 手上的糖果为 $\\{3,5,2,5,5\\}$，分给 $2$ 个小朋友的糖果为 $\\{2,3,5\\},\\{5,5\\}$，小朋友的愤怒值为 $0,1$。可以证明没有愤怒值之和更小的方案。\n\n__【数据范围】__\n\n__本题使用子任务捆绑测试。__\n\n对于 $100\\%$ 的数据，$1\\le n,q\\le 10^6$，$1\\le a_i,x\\le n$。每次询问时，令 $S$ 表示此时小 K 拥有的糖果数量，保证 $1\\le k\\le S$。\n\n| 子任务编号 | $n\\le $ | $q\\le $ | 特殊性质      | 分值 |\n| ---------- | ------- | ------- | ------------- | ---- |\n| $1$        | $5$     | $15$    | 无            | $20$ |\n| $2$        | $2000$  | $2000$  | 无            | $20$ |\n| $3$        | $10^5$  | $10^5$  | 无            | $20$ |\n| $4$        | $10^6$  | $10^6$  | $a_i,x\\le 50$ | $10$ |\n| $5$        | $10^6$  | $10^6$  | $k\\le 50$     | $10$ |\n| $6$        | $10^6$  | $10^6$  | 无            | $20$ |\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【MX-S1-T2】催化剂", "background": "原题链接：<https://oier.team/problems/S1B>。", "description": "小朋友们很喜欢糖果。\n\n现在，小 K 有一些糖果，每个糖果上有一个数字代表它的种类。\n\n有 $q$ 次事件，每次事件会加入一个糖果、或删除一个糖果、或提出一次询问。\n\n每次询问会给出一个 $k$，表示小 K 现在需要将所有糖果分给 $k$ 个小朋友，并且每个小朋友都需要得到至少一个糖果。同时，小朋友们不喜欢得到相同的糖果。具体的，在一个小朋友得到了糖果 $i$ 时，如果 Ta 在这个糖果之前就已经获得过糖果 $i$，那么 Ta 就会感到非常生气，Ta 的愤怒值就会增加 $1$。\n\n小 K 不喜欢看到小朋友们生气，但小 K 无法解决这么困难的问题，所以你需要帮小 K 求出一种分糖果的方式，最小化所有小朋友的愤怒值之和。\n\n保证存在一种分糖果的方案，使得每个小朋友都分到至少一个糖果。\n\n每次询问并没有真正的分糖果，即每次询问后小 K 拥有的糖果不会改变。\n\n注意，分糖果的过程可以理解为将小 K 拥有的所有糖果划分到 $k$ 个非空序列，可以重排。", "inputFormat": "第一行两个正整数 $n,q$。\n\n第二行 $n$ 个正整数 $a_1,a_2,\\dots,a_n$，描述初始时小 K 拥有的糖果。\n\n接下来 $q$ 行，每行两个正整数，描述一次操作，共有三种可能的输入：\n\n`1 x`：表示小 K 又拥有了一个种类为 $x$ 的糖果。\n\n`2 x`：表示小 K 丢失了一个种类为 $x$ 的糖果，保证此时小 K 拥有至少一个种类为 $x$ 的糖果。\n\n`3 k`：表示此时小 K 需要把糖果分给 $k$ 个小朋友，你需要求出最小的所有小朋友的愤怒值之和。令 $S$ 表示此时小 K 拥有的糖果数量，保证 $1\\le k\\le S$。", "outputFormat": "对于每次询问，输出一行一个整数，表示你求出的答案。", "hint": "__【样例解释 1】__\n\n第一次询问时，小 K 手上的糖果为 $\\{3,5,2,5,5\\}$，分给 $2$ 个小朋友的糖果为 $\\{2,3,5\\},\\{5,5\\}$，小朋友的愤怒值为 $0,1$。可以证明没有愤怒值之和更小的方案。\n\n__【数据范围】__\n\n__本题使用子任务捆绑测试。__\n\n对于 $100\\%$ 的数据，$1\\le n,q\\le 10^6$，$1\\le a_i,x\\le n$。每次询问时，令 $S$ 表示此时小 K 拥有的糖果数量，保证 $1\\le k\\le S$。\n\n| 子任务编号 | $n\\le $ | $q\\le $ | 特殊性质      | 分值 |\n| ---------- | ------- | ------- | ------------- | ---- |\n| $1$        | $5$     | $15$    | 无            | $20$ |\n| $2$        | $2000$  | $2000$  | 无            | $20$ |\n| $3$        | $10^5$  | $10^5$  | 无            | $20$ |\n| $4$        | $10^6$  | $10^6$  | $a_i,x\\le 50$ | $10$ |\n| $5$        | $10^6$  | $10^6$  | $k\\le 50$     | $10$ |\n| $6$        | $10^6$  | $10^6$  | 无            | $20$ |\n", "locale": "zh-CN"}}}
{"pid": "P10674", "type": "P", "difficulty": 6, "samples": [["2 1\n1 2", "9"], ["9 10\n8 3\n6 8\n8 5\n1 6\n6 2\n4 6\n8 2\n1 7\n9 6\n5 3", "80995"], ["20 36\n4 7\n2 13\n18 11\n6 14\n4 20\n5 4\n1 9\n19 4\n6 8\n11 15\n4 11\n4 18\n16 9\n16 4\n18 15\n3 18\n4 6\n5 7\n20 6\n20 8\n8 14\n19 13\n12 9\n4 8\n4 15\n20 14\n3 10\n12 1\n17 16\n13 4\n4 14\n10 18\n4 2\n16 12\n19 2\n1 16", "211240350"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["动态规划 DP", "数学", "O2优化", "树形 DP", "双连通分量", "组合数学", "圆方树", "梦熊比赛"], "title": "【MX-S1-T3】电动力学", "background": "原题链接：<https://oier.team/problems/S1C>。", "description": "给定一张包含 $n$ 个点 $m$ 条边的简单无向连通图，点的编号为 $1\\sim n$。\n\n你需要求出有多少集合对 $S,T\\sube \\{1,2,\\dots,n\\}$，满足对于任意的 $i\\in S$，要么 $i$ 也 $\\in T$，要么存在 $x,y\\in T$（$x\\neq y$），满足存在一条从 $x$ 到 $y$ 的简单路径经过 $i$。\n\n注意，集合对 $S,T$ 可以为空集。\n\n输出答案对 $998244353$ 取模后的结果。\n", "inputFormat": "第一行两个正整数 $n,m$。\n\n接下来 $m$ 行，每行两个正整数 $u_i,v_i$，描述图上的一条边。保证图连通，无自环、重边。", "outputFormat": "共一行一个整数，表示满足题目条件的集合对 $S,T$ 的数量对 $998244353$ 取模后的结果。", "hint": "__【样例解释 1】__\n\n所有合法的集合 $S,T$ 为：\n\n1. $S=\\{\\},T=\\{\\}$。\n2. $S=\\{\\},T=\\{1\\}$。\n3. $S=\\{\\},T=\\{2\\}$。\n4. $S=\\{\\},T=\\{1,2\\}$。\n5. $S=\\{1\\},T=\\{1\\}$。\n6. $S=\\{1\\},T=\\{1,2\\}$。\n7. $S=\\{2\\},T=\\{2\\}$。\n8. $S=\\{2\\},T=\\{1,2\\}$。\n9. $S=\\{1,2\\},T=\\{1,2\\}$。 \n\n__【数据范围】__\n\n__本题使用子任务捆绑测试。__\n\n对于 $100\\%$ 的数据，$2\\le n\\le 5\\times 10^5$，$n-1\\le m\\le 10^6$，$1\\le u_i,v_i\\le n$。保证图连通，无自环、重边。\n\n| 子任务编号 | $n\\le $        | $m\\le $            | 特殊性质        | 分值 |\n| ---------- | -------------- | ------------------ | --------------- | ---- |\n| $1$        | $10$           | $\\frac{n(n-1)}{2}$ | 无              | $10$ |\n| $2$        | $20$           | $\\frac{n(n-1)}{2}$ | 无              | $10$ |\n| $3$        | $5\\times 10^5$ | $n-1$              | $u_i=i,v_i=i+1$ | $10$ |\n| $4$        | $5\\times 10^5$ | $n-1$              | 无              | $20$ |\n| $5$        | $5\\times 10^5$ | $n$                | 无              | $20$ |\n| $6$        | $5\\times 10^5$ | $10^6$             | 无              | $30$ |\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【MX-S1-T3】电动力学", "background": "原题链接：<https://oier.team/problems/S1C>。", "description": "给定一张包含 $n$ 个点 $m$ 条边的简单无向连通图，点的编号为 $1\\sim n$。\n\n你需要求出有多少集合对 $S,T\\sube \\{1,2,\\dots,n\\}$，满足对于任意的 $i\\in S$，要么 $i$ 也 $\\in T$，要么存在 $x,y\\in T$（$x\\neq y$），满足存在一条从 $x$ 到 $y$ 的简单路径经过 $i$。\n\n注意，集合对 $S,T$ 可以为空集。\n\n输出答案对 $998244353$ 取模后的结果。\n", "inputFormat": "第一行两个正整数 $n,m$。\n\n接下来 $m$ 行，每行两个正整数 $u_i,v_i$，描述图上的一条边。保证图连通，无自环、重边。", "outputFormat": "共一行一个整数，表示满足题目条件的集合对 $S,T$ 的数量对 $998244353$ 取模后的结果。", "hint": "__【样例解释 1】__\n\n所有合法的集合 $S,T$ 为：\n\n1. $S=\\{\\},T=\\{\\}$。\n2. $S=\\{\\},T=\\{1\\}$。\n3. $S=\\{\\},T=\\{2\\}$。\n4. $S=\\{\\},T=\\{1,2\\}$。\n5. $S=\\{1\\},T=\\{1\\}$。\n6. $S=\\{1\\},T=\\{1,2\\}$。\n7. $S=\\{2\\},T=\\{2\\}$。\n8. $S=\\{2\\},T=\\{1,2\\}$。\n9. $S=\\{1,2\\},T=\\{1,2\\}$。 \n\n__【数据范围】__\n\n__本题使用子任务捆绑测试。__\n\n对于 $100\\%$ 的数据，$2\\le n\\le 5\\times 10^5$，$n-1\\le m\\le 10^6$，$1\\le u_i,v_i\\le n$。保证图连通，无自环、重边。\n\n| 子任务编号 | $n\\le $        | $m\\le $            | 特殊性质        | 分值 |\n| ---------- | -------------- | ------------------ | --------------- | ---- |\n| $1$        | $10$           | $\\frac{n(n-1)}{2}$ | 无              | $10$ |\n| $2$        | $20$           | $\\frac{n(n-1)}{2}$ | 无              | $10$ |\n| $3$        | $5\\times 10^5$ | $n-1$              | $u_i=i,v_i=i+1$ | $10$ |\n| $4$        | $5\\times 10^5$ | $n-1$              | 无              | $20$ |\n| $5$        | $5\\times 10^5$ | $n$                | 无              | $20$ |\n| $6$        | $5\\times 10^5$ | $10^6$             | 无              | $30$ |\n", "locale": "zh-CN"}}}
