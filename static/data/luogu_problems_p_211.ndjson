{"pid": "P5266", "type": "P", "difficulty": 3, "samples": [["5\n1 lxl 10\n2 lxl\n3 lxl\n2 lxl\n4", "OK\n10\nDeleted successfully\nNot found\n0\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["字典树 Trie", "哈希表", "STL"], "title": "【深基17.例6】学籍管理", "background": null, "description": "您要设计一个学籍管理系统，最开始学籍数据是空的，然后该系统能够支持下面的操作（不超过 $10^5$ 条）：\n\n- 插入与修改，格式 `1 NAME SCORE`：在系统中插入姓名为 $\\texttt{NAME}$(由字母和数字组成不超过 $20$ 个字符的字符串，区分大小写)，分数为 $\\texttt{SCORE}$（$0<\\texttt{SCORE}<2^{31}$） 的学生。如果已经有同名的学生则更新这名学生的成绩为 $\\texttt{SCORE}$。如果成功插入或者修改则输出 `OK`。\n- 查询，格式 `2 NAME`：在系统中查询姓名为 $\\texttt{NAME}$ 的学生的成绩。如果没能找到这名学生则输出 `Not found`，否则输出该生成绩。\n- 删除，格式 `3 NAME`：在系统中删除姓名为 $\\texttt{NAME}$ 的学生信息。如果没能找到这名学生则输出 `Not found`，否则输出 `Deleted successfully`。\n- 汇总，格式 `4`：输出系统中学生数量。", "inputFormat": "第一行，输入一个正整数 $Q$（$1 \\le Q \\le 10^5$），表示操作数量。\n\n接下来 $Q$ 行，每行先输入一个正整数 $op$（$op \\in [1,4]$），表示操作种类。接着：\n- 如果 $op = 1$，则再输入一个字符串 $\\texttt{NAME}$ 以及一个正整数 $\\texttt{SCORE}$，含义见题目描述。\n- 如果 $op = 2$，则再输入一个字符串 $\\texttt{NAME}$，含义见题目描述。\n- 如果 $op = 3$，则再输入一个字符串 $\\texttt{NAME}$，含义见题目描述。\n- 如果 $op = 4$，则无需再输入其他内容。", "outputFormat": "共输出 $Q$ 行，每行输出一个字符串或正整数，为对应操作的处理结果，具体含义见题目描述。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "[Deep Basics 17.Example 6] Student Record Management", "background": "", "description": "You need to design a student record management system. At the beginning, the student record data is empty. Then the system must support the following operations (no more than $10^5$ operations in total):\n\n- Insert and update, format `1 NAME SCORE`: Insert a student whose name is $\\texttt{NAME}$ (a case-sensitive string consisting of letters and digits, with at most $20$ characters) and whose score is $\\texttt{SCORE}$ ($0<\\texttt{SCORE}<2^{31}$). If a student with the same name already exists, update this student's score to $\\texttt{SCORE}$. If the insertion or update succeeds, output `OK`.\n- Query, format `2 NAME`: Query the score of the student whose name is $\\texttt{NAME}$. If the student cannot be found, output `Not found`; otherwise, output the student's score.\n- Delete, format `3 NAME`: Delete the information of the student whose name is $\\texttt{NAME}$. If the student cannot be found, output `Not found`; otherwise, output `Deleted successfully`.\n- Summary, format `4`: Output the number of students in the system.", "inputFormat": "The first line contains a positive integer $Q$ ($1 \\le Q \\le 10^5$), which indicates the number of operations.\n\nIn the next $Q$ lines, each line first contains a positive integer $op$ ($op \\in [1,4]$), which indicates the type of operation. Then:\n- If $op = 1$, input an additional string $\\texttt{NAME}$ and a positive integer $\\texttt{SCORE}$, with meanings as described above.\n- If $op = 2$, input an additional string $\\texttt{NAME}$, with meaning as described above.\n- If $op = 3$, input an additional string $\\texttt{NAME}$, with meaning as described above.\n- If $op = 4$, no additional input is needed.", "outputFormat": "Output a total of $Q$ lines. Each line outputs a string or a positive integer, which is the processing result of the corresponding operation. The exact meaning is as described above.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基17.例6】学籍管理", "background": null, "description": "您要设计一个学籍管理系统，最开始学籍数据是空的，然后该系统能够支持下面的操作（不超过 $10^5$ 条）：\n\n- 插入与修改，格式 `1 NAME SCORE`：在系统中插入姓名为 $\\texttt{NAME}$(由字母和数字组成不超过 $20$ 个字符的字符串，区分大小写)，分数为 $\\texttt{SCORE}$（$0<\\texttt{SCORE}<2^{31}$） 的学生。如果已经有同名的学生则更新这名学生的成绩为 $\\texttt{SCORE}$。如果成功插入或者修改则输出 `OK`。\n- 查询，格式 `2 NAME`：在系统中查询姓名为 $\\texttt{NAME}$ 的学生的成绩。如果没能找到这名学生则输出 `Not found`，否则输出该生成绩。\n- 删除，格式 `3 NAME`：在系统中删除姓名为 $\\texttt{NAME}$ 的学生信息。如果没能找到这名学生则输出 `Not found`，否则输出 `Deleted successfully`。\n- 汇总，格式 `4`：输出系统中学生数量。", "inputFormat": "第一行，输入一个正整数 $Q$（$1 \\le Q \\le 10^5$），表示操作数量。\n\n接下来 $Q$ 行，每行先输入一个正整数 $op$（$op \\in [1,4]$），表示操作种类。接着：\n- 如果 $op = 1$，则再输入一个字符串 $\\texttt{NAME}$ 以及一个正整数 $\\texttt{SCORE}$，含义见题目描述。\n- 如果 $op = 2$，则再输入一个字符串 $\\texttt{NAME}$，含义见题目描述。\n- 如果 $op = 3$，则再输入一个字符串 $\\texttt{NAME}$，含义见题目描述。\n- 如果 $op = 4$，则无需再输入其他内容。", "outputFormat": "共输出 $Q$ 行，每行输出一个字符串或正整数，为对应操作的处理结果，具体含义见题目描述。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P5267", "type": "P", "difficulty": 7, "samples": [["3 3 100 2 3 1 1 0\n2 1 1\n2 3 3\n4 7 1", "4\n2 2 2 3 2\n2 3 1 3 2\n2 2 1 3 1\n3 1 3 2 3 3 3"], ["1 3 100 2 3 1 1 1\n2 1 1", "1\n2 1 2 1 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "NOI", "提交答案", "Special Judge"], "title": "[NOI2014] 消除游戏", "background": "", "description": "最近，小 Z 迷上了一款新型消除游戏。这款游戏在一个 $n\\times m$ 的方格中进行。初始时方格中均为 $0 \\sim 9$ 的整数。进行消除后方格中会出现空白，用 $-1$ 表示。为了方便，我们将第 $i$ 行，第 $j$ 列的数记为 $A_{i,j}$，并将其坐标记为 $(i,j)$。\n\n给定三个参数 $l_{\\min},l_{\\max}$ 以及 $K$，玩家可以进行不超过 $K$ 次操作。对于每次操作，玩家需要在方格中找到一条长度为 $l$ 的路径。形式化地，该路径用两个长度为 $l$ 的序列 $x_1,x_2,\\ldots,x_l$ 和 $y_1,y_2,\\ldots,y_l$ 表示，需要满足如下条件：\n1. $1\\le x_i\\le n,1\\le y_i\\le m$，其中 $1\\le i\\le l$，即 $(x_i,y_i)$ 对应于方格中的一个合法位置；\n2. $\\left|x_i-x_{i+1} \\right|+ \\left|y_i-y_{i+1} \\right|=1$，其中 $1 \\le i \\lt l$，即 $(x_i,y_i)$ 与 $(x_{i+1},y_{i+1})$ 是方格中相邻的两个位置；\n3. $x_i \\neq x_j$ 或 $y_i \\neq y_j$，其中 $1\\le i \\lt j\\le l$，即路径不能经过重复的格子；\n4. $A_{x_i,y_i} \\neq -1$，其中 $1\\le i\\le l$，即路径不能经过空白的格子；\n5. $A_{x_1,y_1} \\neq 0$，即路径不能以数字 $0$ 为起点；\n6. $l_{\\min}\\le l\\le l_{\\max}$，即路径的长度需要在给定的范围内。\n\n将路径上的数字串成一个整数 $N$，形式化地\n$$\nN=\\sum\\limits_{i=1}^l A_{x_i,y_i}\\times 10^{l-i}\n$$\n\n游戏会给出两个参数 $c_1,c_2$ 用于计算玩家本次操作的得分：\n1. 如果数 $N$ 是质数，那么将获得**质数得分** $l^{c_1}$，否则获得**质数得分** $1$；\n2. 如果数 $N$ 是回文数（即，将数 $N$ 的十进制表达看成一个字符串，这个字符串的逆序串和它本身完全相同），那么将获得**回文数得分** $l^{c_2}$，否则获得**回文数得分** $1$；\n3. 如果**质数得分**和**回文数得分**均为 $1$，那么**本次操作的得分**为 $0$；否则**本次操作的得分**为**质数得分与回文数得分**之和。\n\n每次操作过后，若**该次操作的得分**等于 $0$，那么你浪费了一次操作机会，而局面不会有任何改变。若**该次操作的得分**大于 $0$，则将路径上的数替换为空白，并使空白上方的数字垂直下落。形式化地，执行以下操作：\n1. 执行 $A_{x_i,y_i}\\leftarrow -1$，其中 $1\\le i\\le l$；\n2. 枚举所有格子。如果存在某个格子 $(i ,j)$，满足 $i \\neq n, A_{i,j} \\neq -1, A_{i+1,j} = -1$，执行 $A_{i+1,j} \\leftarrow A_{i,j}, A_{i,j}\\leftarrow -1$。反复执行这个操作直到方格中不再存在这样的格子。\n\n我们还会给你一个参数 $F$ ，在所有操作完成后，玩家的**最终得分** $S$ 的计算方式由 $F$ 决定：如果 $F$ 取值为 $0$，那么玩家的最终得分为所有操作的分数总和 $m$；如果 $F$ 取值为 $1$，那么玩家的最终得分为所有操作的分数总和 $m$ 除 $2^d$ 后向下取整，即\n\n$$\nS =\n\\begin{cases}\nm, & F=0\\\\\\\\\n\\left \\lfloor \\frac{m}{2^d} \\right \\rfloor, & F=1\n\\end{cases}\n$$\n\n其中 $d$ 为最终方格中非空白格子的数目。\n\n小 Z 沉迷于这个有趣的游戏中不能自拔。她想请你帮助, 针对给定的输入参数，给出游戏局面的操作方案。当然，最终得分越大越好。", "inputFormat": "**本题是一道提交答案题。**\n\n对于每个输入文件，输入的第 $1$ 行包含 $8$ 个用空格分隔的整数 $n, m, K, l_{\\min}, l_{\\max}, c_1, c_2, F$，含义同题面描述。 \n\n随后 $n$ 行，每行 $m$ 个整数，表示方格 A。数之间用一个空格分隔。\n\n输入文件中不会包含多余的空行，行末不会存在多余的空格。", "outputFormat": "针对给定的 $10$ 个输入文件 `game1.in ~ game10.in`，你需要分别提交你的输出文件 `game1.out ~ game10.out`。\n\n输出文件第 $1$ 行为一个整数 $M (0 \\leq M \\leq K)$，为你的操作次数。\n\n随后, 输出文件还应包含 $M$ 行，每行描述一次操作。对于每一行，最开始的整数$l$表示这次操作中选定路径的长度。接下来有 $2l$ 个数字，分别为 $x_1, y_1, x_2, y_2, \\dots, x_l, y_l$。\n\n输出文件中不应包含多余的空格和空行。一行的多个整数之间使用一个空格分隔。", "hint": "#### 样例解释 1\n\n$4$ 次消除得到的数与相应的分数分别是：$37$，得分为 $2+1=3$；$41$，得分为 $2+1=3$；$22$，得分为 $1+2=3$；$131$，得分为 $3+3=6$。总共得分为 $15$。可能存在更优的方案。\n\n#### 样例解释 2\n\n本方案仅一次消除操作。消除的数为 $11$，本次操作得分为 $2+2=4$。由于 $F=1$，最终得分为每次操作得分之和 $4$ 除以 $2^1 = 2$ 后下取整，为 $2$。若选择消除路径 $211$，则会得到本局面最佳分数 $4$。\n\n#### 评分标准\n\n对于每组数据，我们设置了 $9$ 个评分参数 $a_{10},a_9, \\dots ,a_2$。如果选手的输出不合法，则得零分。否则，在你的方案中，若游戏得分为 $w_{user}$，你的分数将会由下表给出：\n\n::cute-table{tuack=2}\n\n| 得分 |            条件             | 得分 |           条件           |\n| :--: | :-------------------------: | :--: | :----------------------: |\n| $10$ |    $w_{user}\\ge a_{10}$     | $5$  | $a_5\\le w_{user}\\lt a_6$ |\n| $9$  | $a_9\\le w_{user}\\lt a_{10}$ | $4$  | $a_4\\le w_{user}\\lt a_5$ |\n| $8$  |  $a_8\\le w_{user}\\lt a_9$   | $3$  | $a_3\\le w_{user}\\lt a_4$ |\n| $7$  |  $a_7\\le w_{user}\\lt a_8$   | $2$  | $a_2\\le w_{user}\\lt a_3$ |\n| $6$  |  $a_6\\le w_{user}\\lt a_7$   | $1$  |  $0\\lt w_{user}\\lt a_2$  |\n\n#### 附加文件\n\nchecker 需要自行编译后使用。\n\n请前往 [Github](https://github.com/MikeMirzayanov/testlib) 下载 testlib.h 的最新源代码。", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2014] Elimination Game", "background": "", "description": "Recently, Little Z became addicted to a new elimination game. The game is played on an $n \\times m$ grid. Initially, each cell contains an integer from $0 \\sim 9$. After eliminations, blank cells may appear in the grid, denoted by $-1$. For convenience, denote the number in row $i$, column $j$ as $A_{i,j}$, and its coordinate as $(i,j)$.\n\nGiven three parameters $l_{\\min}, l_{\\max}$, and $K$, the player can perform at most $K$ operations. In each operation, the player needs to find a path of length $l$ in the grid. Formally, the path is represented by two sequences of length $l$, $x_1, x_2, \\ldots, x_l$ and $y_1, y_2, \\ldots, y_l$, satisfying:\n\n1. $1 \\le x_i \\le n, 1 \\le y_i \\le m$ for $1 \\le i \\le l$, i.e., $(x_i,y_i)$ is a valid position in the grid.\n2. $\\left|x_i-x_{i+1} \\right|+ \\left|y_i-y_{i+1} \\right|=1$ for $1 \\le i \\lt l$, i.e., $(x_i,y_i)$ and $(x_{i+1},y_{i+1})$ are adjacent cells in the grid.\n3. $x_i \\neq x_j$ or $y_i \\neq y_j$ for $1 \\le i \\lt j \\le l$, i.e., the path cannot pass through any cell more than once.\n4. $A_{x_i,y_i} \\neq -1$ for $1 \\le i \\le l$, i.e., the path cannot pass through blank cells.\n5. $A_{x_1,y_1} \\neq 0$, i.e., the path cannot start with the digit $0$.\n6. $l_{\\min} \\le l \\le l_{\\max}$, i.e., the path length must be within the given range.\n\nConcatenate the digits along the path into an integer $N$, formally:\n$$\nN=\\sum\\limits_{i=1}^l A_{x_i,y_i}\\times 10^{l-i}\n$$\n\nThe game provides two parameters $c_1, c_2$ to compute the score for this operation:\n\n1. If $N$ is a prime number, you get the **prime score** $l^{c_1}$; otherwise, the **prime score** is $1$.\n2. If $N$ is a palindrome (i.e., viewing the decimal representation of $N$ as a string, its reverse is exactly the same as itself), you get the **palindrome score** $l^{c_2}$; otherwise, the **palindrome score** is $1$.\n3. If both the **prime score** and the **palindrome score** are $1$, then the **score of this operation** is $0$. Otherwise, the **score of this operation** is the sum of the **prime score** and the **palindrome score**.\n\nAfter each operation, if the **score of this operation** equals $0$, then you waste one operation and the grid does not change. If the **score of this operation** is greater than $0$, then the numbers on the path are replaced with blanks, and the numbers above blanks fall vertically. Formally, perform the following steps:\n\n1. Set $A_{x_i,y_i}\\leftarrow -1$ for $1\\le i\\le l$.\n2. Enumerate all cells. If there exists a cell $(i, j)$ such that $i \\neq n$, $A_{i,j} \\neq -1$, and $A_{i+1,j} = -1$, then perform $A_{i+1,j} \\leftarrow A_{i,j}, A_{i,j}\\leftarrow -1$. Repeat this operation until no such cell exists in the grid.\n\nWe also provide a parameter $F$. After all operations are completed, the player’s **final score** $S$ is determined by $F$: if $F=0$, then the final score is the sum of the scores of all operations $m$; if $F=1$, then the final score is the sum of the scores of all operations $m$ divided by $2^d$ and floored, i.e.,\n$$\nS =\n\\begin{cases}\nm, & F=0\\\\\\\\\n\\left \\lfloor \\frac{m}{2^d} \\right \\rfloor, & F=1\n\\end{cases}\n$$\nwhere $d$ is the number of non-blank cells in the final grid.\n\nLittle Z is so obsessed with this interesting game that she cannot stop. She wants to ask you for help: for the given input parameters, provide an operation plan for the game state. Of course, the higher the final score, the better.", "inputFormat": "**This is an output-only problem.**\n\nFor each input file, line $1$ contains $8$ space-separated integers $n, m, K, l_{\\min}, l_{\\max}, c_1, c_2, F$, with the same meanings as in the statement.\n\nThen follow $n$ lines, each containing $m$ integers, describing the grid $A$. Numbers are separated by one space.\n\nThe input file will not contain extra blank lines, and there will be no extra spaces at the end of lines.", "outputFormat": "For the given $10$ input files `game1.in ~ game10.in`, you need to submit your output files `game1.out ~ game10.out` respectively.\n\nThe first line of the output file is an integer $M \\ (0 \\leq M \\leq K)$, the number of operations you perform.\n\nThen the output file should contain $M$ lines, each describing one operation. For each line, the first integer $l$ indicates the length of the chosen path for this operation. Then follow $2l$ numbers: $x_1, y_1, x_2, y_2, \\dots, x_l, y_l$.\n\nThe output file should not contain extra spaces or blank lines. Multiple integers on the same line should be separated by one space.", "hint": "#### Sample Explanation 1\n\nThe numbers eliminated in the $4$ eliminations and their corresponding scores are: $37$, score $2+1=3$; $41$, score $2+1=3$; $22$, score $1+2=3$; $131$, score $3+3=6$. The total score is $15$. There may be a better plan.\n\n#### Sample Explanation 2\n\nThis plan contains only one elimination operation. The eliminated number is $11$, and the score for this operation is $2+2=4$. Since $F=1$, the final score is the sum of operation scores $4$ divided by $2^1 = 2$ and floored, which is $2$. If you choose the elimination path $211$, you will get the best possible score for this game state, which is $4$.\n\n#### Scoring\n\nFor each test, we set $9$ scoring parameters $a_{10},a_9, \\dots ,a_2$. If your output is invalid, you get $0$ points. Otherwise, if the game score in your solution is $w_{user}$, your score will be given by the table below:\n\n::cute-table{tuack=2}\n\n| Score |            Condition             | Score |           Condition           |\n| :--: | :------------------------------: | :--: | :--------------------------: |\n| $10$ |    $w_{user}\\ge a_{10}$     | $5$  | $a_5\\le w_{user}\\lt a_6$ |\n| $9$  | $a_9\\le w_{user}\\lt a_{10}$ | $4$  | $a_4\\le w_{user}\\lt a_5$ |\n| $8$  |  $a_8\\le w_{user}\\lt a_9$   | $3$  | $a_3\\le w_{user}\\lt a_4$ |\n| $7$  |  $a_7\\le w_{user}\\lt a_8$   | $2$  | $a_2\\le w_{user}\\lt a_3$ |\n| $6$  |  $a_6\\le w_{user}\\lt a_7$   | $1$  |  $0\\lt w_{user}\\lt a_2$  |\n\n#### Additional Files\n\nThe checker must be compiled and used by yourself.\n\nPlease go to [Github](https://github.com/MikeMirzayanov/testlib) to download the latest source code of testlib.h.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2014] 消除游戏", "background": "", "description": "最近，小 Z 迷上了一款新型消除游戏。这款游戏在一个 $n\\times m$ 的方格中进行。初始时方格中均为 $0 \\sim 9$ 的整数。进行消除后方格中会出现空白，用 $-1$ 表示。为了方便，我们将第 $i$ 行，第 $j$ 列的数记为 $A_{i,j}$，并将其坐标记为 $(i,j)$。\n\n给定三个参数 $l_{\\min},l_{\\max}$ 以及 $K$，玩家可以进行不超过 $K$ 次操作。对于每次操作，玩家需要在方格中找到一条长度为 $l$ 的路径。形式化地，该路径用两个长度为 $l$ 的序列 $x_1,x_2,\\ldots,x_l$ 和 $y_1,y_2,\\ldots,y_l$ 表示，需要满足如下条件：\n1. $1\\le x_i\\le n,1\\le y_i\\le m$，其中 $1\\le i\\le l$，即 $(x_i,y_i)$ 对应于方格中的一个合法位置；\n2. $\\left|x_i-x_{i+1} \\right|+ \\left|y_i-y_{i+1} \\right|=1$，其中 $1 \\le i \\lt l$，即 $(x_i,y_i)$ 与 $(x_{i+1},y_{i+1})$ 是方格中相邻的两个位置；\n3. $x_i \\neq x_j$ 或 $y_i \\neq y_j$，其中 $1\\le i \\lt j\\le l$，即路径不能经过重复的格子；\n4. $A_{x_i,y_i} \\neq -1$，其中 $1\\le i\\le l$，即路径不能经过空白的格子；\n5. $A_{x_1,y_1} \\neq 0$，即路径不能以数字 $0$ 为起点；\n6. $l_{\\min}\\le l\\le l_{\\max}$，即路径的长度需要在给定的范围内。\n\n将路径上的数字串成一个整数 $N$，形式化地\n$$\nN=\\sum\\limits_{i=1}^l A_{x_i,y_i}\\times 10^{l-i}\n$$\n\n游戏会给出两个参数 $c_1,c_2$ 用于计算玩家本次操作的得分：\n1. 如果数 $N$ 是质数，那么将获得**质数得分** $l^{c_1}$，否则获得**质数得分** $1$；\n2. 如果数 $N$ 是回文数（即，将数 $N$ 的十进制表达看成一个字符串，这个字符串的逆序串和它本身完全相同），那么将获得**回文数得分** $l^{c_2}$，否则获得**回文数得分** $1$；\n3. 如果**质数得分**和**回文数得分**均为 $1$，那么**本次操作的得分**为 $0$；否则**本次操作的得分**为**质数得分与回文数得分**之和。\n\n每次操作过后，若**该次操作的得分**等于 $0$，那么你浪费了一次操作机会，而局面不会有任何改变。若**该次操作的得分**大于 $0$，则将路径上的数替换为空白，并使空白上方的数字垂直下落。形式化地，执行以下操作：\n1. 执行 $A_{x_i,y_i}\\leftarrow -1$，其中 $1\\le i\\le l$；\n2. 枚举所有格子。如果存在某个格子 $(i ,j)$，满足 $i \\neq n, A_{i,j} \\neq -1, A_{i+1,j} = -1$，执行 $A_{i+1,j} \\leftarrow A_{i,j}, A_{i,j}\\leftarrow -1$。反复执行这个操作直到方格中不再存在这样的格子。\n\n我们还会给你一个参数 $F$ ，在所有操作完成后，玩家的**最终得分** $S$ 的计算方式由 $F$ 决定：如果 $F$ 取值为 $0$，那么玩家的最终得分为所有操作的分数总和 $m$；如果 $F$ 取值为 $1$，那么玩家的最终得分为所有操作的分数总和 $m$ 除 $2^d$ 后向下取整，即\n\n$$\nS =\n\\begin{cases}\nm, & F=0\\\\\\\\\n\\left \\lfloor \\frac{m}{2^d} \\right \\rfloor, & F=1\n\\end{cases}\n$$\n\n其中 $d$ 为最终方格中非空白格子的数目。\n\n小 Z 沉迷于这个有趣的游戏中不能自拔。她想请你帮助, 针对给定的输入参数，给出游戏局面的操作方案。当然，最终得分越大越好。", "inputFormat": "**本题是一道提交答案题。**\n\n对于每个输入文件，输入的第 $1$ 行包含 $8$ 个用空格分隔的整数 $n, m, K, l_{\\min}, l_{\\max}, c_1, c_2, F$，含义同题面描述。 \n\n随后 $n$ 行，每行 $m$ 个整数，表示方格 A。数之间用一个空格分隔。\n\n输入文件中不会包含多余的空行，行末不会存在多余的空格。", "outputFormat": "针对给定的 $10$ 个输入文件 `game1.in ~ game10.in`，你需要分别提交你的输出文件 `game1.out ~ game10.out`。\n\n输出文件第 $1$ 行为一个整数 $M (0 \\leq M \\leq K)$，为你的操作次数。\n\n随后, 输出文件还应包含 $M$ 行，每行描述一次操作。对于每一行，最开始的整数$l$表示这次操作中选定路径的长度。接下来有 $2l$ 个数字，分别为 $x_1, y_1, x_2, y_2, \\dots, x_l, y_l$。\n\n输出文件中不应包含多余的空格和空行。一行的多个整数之间使用一个空格分隔。", "hint": "#### 样例解释 1\n\n$4$ 次消除得到的数与相应的分数分别是：$37$，得分为 $2+1=3$；$41$，得分为 $2+1=3$；$22$，得分为 $1+2=3$；$131$，得分为 $3+3=6$。总共得分为 $15$。可能存在更优的方案。\n\n#### 样例解释 2\n\n本方案仅一次消除操作。消除的数为 $11$，本次操作得分为 $2+2=4$。由于 $F=1$，最终得分为每次操作得分之和 $4$ 除以 $2^1 = 2$ 后下取整，为 $2$。若选择消除路径 $211$，则会得到本局面最佳分数 $4$。\n\n#### 评分标准\n\n对于每组数据，我们设置了 $9$ 个评分参数 $a_{10},a_9, \\dots ,a_2$。如果选手的输出不合法，则得零分。否则，在你的方案中，若游戏得分为 $w_{user}$，你的分数将会由下表给出：\n\n::cute-table{tuack=2}\n\n| 得分 |            条件             | 得分 |           条件           |\n| :--: | :-------------------------: | :--: | :----------------------: |\n| $10$ |    $w_{user}\\ge a_{10}$     | $5$  | $a_5\\le w_{user}\\lt a_6$ |\n| $9$  | $a_9\\le w_{user}\\lt a_{10}$ | $4$  | $a_4\\le w_{user}\\lt a_5$ |\n| $8$  |  $a_8\\le w_{user}\\lt a_9$   | $3$  | $a_3\\le w_{user}\\lt a_4$ |\n| $7$  |  $a_7\\le w_{user}\\lt a_8$   | $2$  | $a_2\\le w_{user}\\lt a_3$ |\n| $6$  |  $a_6\\le w_{user}\\lt a_7$   | $1$  |  $0\\lt w_{user}\\lt a_2$  |\n\n#### 附加文件\n\nchecker 需要自行编译后使用。\n\n请前往 [Github](https://github.com/MikeMirzayanov/testlib) 下载 testlib.h 的最新源代码。", "locale": "zh-CN"}}}
{"pid": "P5268", "type": "P", "difficulty": 5, "samples": [["5\n1 1 1 1 1\n2\n1 2 3 4\n1 1 4 4", "4\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2017", "莫队", "各省省选", "陕西", "容斥原理", "差分"], "title": "[SNOI2017] 一个简单的询问", "background": "", "description": "给你一个长度为 $N$ 的序列 $a_i$，$1\\leq i\\leq N$，和 $q$ 组询问，每组询问读入 $l_1,r_1,l_2,r_2$，需输出\n\n$$\n\\sum\\limits_{x=0}^\\infty \\text{get}(l_1,r_1,x)\\times \\text{get}(l_2,r_2,x)\n$$\n\n$ \\text{get}(l,r,x)$ 表示计算区间 $[l,r]$ 中，数字 $x$ 出现了多少次。", "inputFormat": "第一行，一个数字 $N$，表示序列长度。  \n第二行，$N$ 个数字，表示 $a_1\\sim a_N$。  \n第三行，一个数字 $Q$，表示询问个数。  \n第 $4\\sim Q+3$ 行，每行四个数字 $l_1,r_1,l_2,r_2$，表示询问。", "outputFormat": "对于每组询问，输出一行一个数字，表示答案。", "hint": "对于 $20\\%$ 的数据，$1\\leq N,Q\\leq 1000$；  \n对于另外 $30\\%$ 的数据，$1\\leq a_i\\leq 50$；  \n对于 $100\\%$ 的数据，$N,Q\\leq 50000$，$1\\leq a_i\\leq N$，$1\\leq l_1\\leq r_1\\leq N$，$1\\leq l_2\\leq r_2\\leq N$。\n\n数据范围与原题相同，但测试数据由 LibreOJ 自制，并非原数据。  \n\n**注意：** 答案有可能超过 `int` 的最大值。", "locale": "zh-CN", "translations": {"en": {"title": "[SNOI2017] A Simple Query", "background": "", "description": "You are given a sequence $a_i$ of length $N$, where $1\\leq i\\leq N$, and $q$ queries. For each query, you are given $l_1,r_1,l_2,r_2$, and you need to output\n\n$$\n\\sum\\limits_{x=0}^\\infty \\text{get}(l_1,r_1,x)\\times \\text{get}(l_2,r_2,x)\n$$\n\nHere, $\\text{get}(l,r,x)$ means the number of times the value $x$ appears in the interval $[l,r]$.", "inputFormat": "The first line contains an integer $N$, the length of the sequence.  \nThe second line contains $N$ integers, representing $a_1\\sim a_N$.  \nThe third line contains an integer $Q$, the number of queries.  \nLines $4$ to $Q+3$ each contain four integers $l_1,r_1,l_2,r_2$, representing a query.", "outputFormat": "For each query, output one integer per line, representing the answer.", "hint": "For $20\\%$ of the testdata, $1\\leq N,Q\\leq 1000$.  \nFor another $30\\%$ of the testdata, $1\\leq a_i\\leq 50$.  \nFor $100\\%$ of the testdata, $N,Q\\leq 50000$, $1\\leq a_i\\leq N$, $1\\leq l_1\\leq r_1\\leq N$, $1\\leq l_2\\leq r_2\\leq N$.\n\nThe Constraints are the same as the original problem, but the testdata is made by LibreOJ and is not the original testdata.\n\n**Note:** The answer may exceed the maximum value of `int`.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SNOI2017] 一个简单的询问", "background": "", "description": "给你一个长度为 $N$ 的序列 $a_i$，$1\\leq i\\leq N$，和 $q$ 组询问，每组询问读入 $l_1,r_1,l_2,r_2$，需输出\n\n$$\n\\sum\\limits_{x=0}^\\infty \\text{get}(l_1,r_1,x)\\times \\text{get}(l_2,r_2,x)\n$$\n\n$ \\text{get}(l,r,x)$ 表示计算区间 $[l,r]$ 中，数字 $x$ 出现了多少次。", "inputFormat": "第一行，一个数字 $N$，表示序列长度。  \n第二行，$N$ 个数字，表示 $a_1\\sim a_N$。  \n第三行，一个数字 $Q$，表示询问个数。  \n第 $4\\sim Q+3$ 行，每行四个数字 $l_1,r_1,l_2,r_2$，表示询问。", "outputFormat": "对于每组询问，输出一行一个数字，表示答案。", "hint": "对于 $20\\%$ 的数据，$1\\leq N,Q\\leq 1000$；  \n对于另外 $30\\%$ 的数据，$1\\leq a_i\\leq 50$；  \n对于 $100\\%$ 的数据，$N,Q\\leq 50000$，$1\\leq a_i\\leq N$，$1\\leq l_1\\leq r_1\\leq N$，$1\\leq l_2\\leq r_2\\leq N$。\n\n数据范围与原题相同，但测试数据由 LibreOJ 自制，并非原数据。  \n\n**注意：** 答案有可能超过 `int` 的最大值。", "locale": "zh-CN"}}}
{"pid": "P5269", "type": "P", "difficulty": 2, "samples": [["5 3 1 10 5 100\n0 1\n0 0\n2 1\n2 1\n1 1", "83"], ["3 1 1 1 1 2\n2 0\n2 1\n2 0", "2"], ["1 2 3 4 5 6\n1 0", "-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "洛谷月赛"], "title": "欧稳欧再次学车", "background": "请自行脑补一张欧稳欧学车的图", "description": "欧稳欧学车时经常用一辆橡树车练习。这辆橡树车共有 $N$ 个挡位，欧稳欧每秒可以把挡位增加或减少 $1$，初始时（$0$ 时刻）挡位为 $1$。\n\n这辆车的转速范围是 $[L,R]$，初始时转速为 $L$。每次升挡时，转速会变成 $L$；降挡时，会变成 $R$。欧稳欧在每秒也可以踩油门，让转速增加 $X$，再对 $R$ 取 $\\text{min}$。如果转速连续 $K$ 秒都 $=R$，那么这辆车的发动机会停止工作，在这 $K$ 秒结束的一瞬间停下（即使 $K$ 秒中经历了降档操作，仍然算这种情况）。\n\n这些操作我们认为都是在每秒开头的一瞬间进行的，其中换挡操作比踩油门操作先进行。而这一秒内这辆车前进的距离是 转速$\\times$挡位。\n\n现在给出欧稳欧练习时的操作序列，你需要求出他一共前进的距离是多少。", "inputFormat": "第一行六个整数 $T,N,L,R,X,K$，$T$ 表示总时间。\n\n接下来 $T$ 行，每行两个整数 $x,y$，表示这一秒的操作。\n\n其中 $x=0$ 表示升挡，$x=1$ 表示降挡，$x=2$ 表示挡位不变；$y=0$ 表示不踩油门，$y=1$ 表示踩油门。（不要问为什么没有刹车）", "outputFormat": "一行一个整数，表示给定操作序列的前进距离。\n\n如果欧稳欧在挡位为 $N$ 时升挡，或在挡位为 $1$ 时降挡，那么给定序列不合法，输出 $-1$。", "hint": "对于样例一：\n\n第一秒挡位为 $2$，转速为 $6$；  \n第二秒挡位为 $3$，转速为 $1$；  \n第三秒挡位为 $3$，转速为 $6$；  \n第四秒挡位为 $3$，转速为 $10$；  \n第五秒挡位为 $2$，转速为 $10$。\n\n对于样例二，前进两秒之后发动机就停止了工作。\n\n对于 $30\\%$ 的数据，没有挡位操作（即保证 $x=2$）；\n\n对于另外 $30\\%$ 的数据，没有踩油门操作（即保证 $y=0$）；\n\n对于全部数据，保证 $1\\le T,N,L,R,X,K\\le 10^6,L\\le R$。", "locale": "zh-CN", "translations": {"en": {"title": "Owen-O Learns to Drive Again", "background": "Please imagine a picture of Owen-O learning to drive.", "description": "When Owen-O practices driving, he often uses an “oak car” for training. This oak car has a total of $N$ gears. Each second, Owen-O can increase or decrease the gear by $1$. Initially (at time $0$), the gear is $1$.\n\nThe car’s RPM range is $[L,R]$, and initially the RPM is $L$. Each time he upshifts, the RPM becomes $L$; each time he downshifts, the RPM becomes $R$. Each second, Owen-O can also step on the accelerator to increase the RPM by $X$, then take $\\text{min}$ with $R$. If the RPM stays continuously at $=R$ for $K$ seconds, then the engine will stop working and the car will stop at the instant those $K$ seconds end (even if downshifts happen during those $K$ seconds, it is still counted as this situation).\n\nWe consider all operations to happen instantly at the beginning of each second, and the gear-change operation happens before the acceleration operation. The distance the car travels during that second is RPM $\\times$ gear.\n\nNow you are given Owen-O’s sequence of operations during practice. You need to compute the total distance traveled.", "inputFormat": "The first line contains six integers $T,N,L,R,X,K$, where $T$ is the total time.\n\nThe next $T$ lines each contain two integers $x,y$, describing the operation in this second.\n\nHere, $x=0$ means upshift, $x=1$ means downshift, $x=2$ means the gear stays the same; $y=0$ means do not step on the accelerator, $y=1$ means step on the accelerator. (Do not ask why there is no brake.)", "outputFormat": "Output one integer in one line, the total distance traveled under the given operation sequence.\n\nIf Owen-O upshifts while the gear is $N$, or downshifts while the gear is $1$, then the given sequence is invalid; output $-1$.", "hint": "For Sample 1:\n\nIn the first second, the gear is $2$ and the RPM is $6$;  \nin the second second, the gear is $3$ and the RPM is $1$;  \nin the third second, the gear is $3$ and the RPM is $6$;  \nin the fourth second, the gear is $3$ and the RPM is $10$;  \nin the fifth second, the gear is $2$ and the RPM is $10$.\n\nFor Sample 2, the engine stops working after moving for two seconds.\n\nFor $30\\%$ of the testdata, there are no gear operations (i.e. guaranteed $x=2$);\n\nfor another $30\\%$ of the testdata, there are no acceleration operations (i.e. guaranteed $y=0$);\n\nfor all testdata, it is guaranteed that $1\\le T,N,L,R,X,K\\le 10^6$ and $L\\le R$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "欧稳欧再次学车", "background": "请自行脑补一张欧稳欧学车的图", "description": "欧稳欧学车时经常用一辆橡树车练习。这辆橡树车共有 $N$ 个挡位，欧稳欧每秒可以把挡位增加或减少 $1$，初始时（$0$ 时刻）挡位为 $1$。\n\n这辆车的转速范围是 $[L,R]$，初始时转速为 $L$。每次升挡时，转速会变成 $L$；降挡时，会变成 $R$。欧稳欧在每秒也可以踩油门，让转速增加 $X$，再对 $R$ 取 $\\text{min}$。如果转速连续 $K$ 秒都 $=R$，那么这辆车的发动机会停止工作，在这 $K$ 秒结束的一瞬间停下（即使 $K$ 秒中经历了降档操作，仍然算这种情况）。\n\n这些操作我们认为都是在每秒开头的一瞬间进行的，其中换挡操作比踩油门操作先进行。而这一秒内这辆车前进的距离是 转速$\\times$挡位。\n\n现在给出欧稳欧练习时的操作序列，你需要求出他一共前进的距离是多少。", "inputFormat": "第一行六个整数 $T,N,L,R,X,K$，$T$ 表示总时间。\n\n接下来 $T$ 行，每行两个整数 $x,y$，表示这一秒的操作。\n\n其中 $x=0$ 表示升挡，$x=1$ 表示降挡，$x=2$ 表示挡位不变；$y=0$ 表示不踩油门，$y=1$ 表示踩油门。（不要问为什么没有刹车）", "outputFormat": "一行一个整数，表示给定操作序列的前进距离。\n\n如果欧稳欧在挡位为 $N$ 时升挡，或在挡位为 $1$ 时降挡，那么给定序列不合法，输出 $-1$。", "hint": "对于样例一：\n\n第一秒挡位为 $2$，转速为 $6$；  \n第二秒挡位为 $3$，转速为 $1$；  \n第三秒挡位为 $3$，转速为 $6$；  \n第四秒挡位为 $3$，转速为 $10$；  \n第五秒挡位为 $2$，转速为 $10$。\n\n对于样例二，前进两秒之后发动机就停止了工作。\n\n对于 $30\\%$ 的数据，没有挡位操作（即保证 $x=2$）；\n\n对于另外 $30\\%$ 的数据，没有踩油门操作（即保证 $y=0$）；\n\n对于全部数据，保证 $1\\le T,N,L,R,X,K\\le 10^6,L\\le R$。", "locale": "zh-CN"}}}
{"pid": "P5270", "type": "P", "difficulty": 6, "samples": [["5 5 20\n2 2 0 2 0\n2 2 0\n2 0 2\n3 0 2 0\n3 0 2 0\n2 2 2\n10\n2 1 5 5 2 2 4 2 5 3", "6"], ["10 10 10000\n0 1 1 1 0 1 1 0 0 0 \n6 0 0 1 1 1 0 \n6 0 0 0 0 0 0 \n5 0 0 0 0 0 \n4 1 0 0 0 \n5 1 1 1 0 1 \n2 1 1 \n6 0 0 0 0 0 1 \n1 0 \n4 0 0 1 1 \n1 1 \n30\n10 4 3 9 10 9 4 8 5 10 9 8 6 10 10 4 9 2 2 9 6 4 1 10 10 1 9 10 3 5 ", "3001"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["哈希 hashing", "洛谷月赛"], "title": "无论怎样神树大人都会删库跑路", "background": "众所周知，神 J（Joker）每隔几天就会去成都法中假装上课，实际上是去玩指针。神J可以趁别人不注意掏出指针把自己指到任何位置（生物标本柜里大变活人？），或者把两个人的指针交换一下（成都法中版《你的名字》？），或者对着 OJ 念系统命令使得 OJ 随机变慢（mcfx：怎么这 CPU 睿频后反而变慢了）。\n\n神树大人很不满意，因为树必须站在原地，而且神树大人也不会指针。但是神树大人是神，于是他打算把这个宇宙的数据库删了跑路，这样无所事事的神 J 就只能和神树大人玩牌了。", "description": "现在有个长为 $T$ 的字符串 $S$ 和 $n$ 个小字符串 $a_i$。\n\n给定一个长为 $m$ 的数组 $R$，数组下标从 1 开始，初始有一个空字符串 $X$，神树大人打算进行 $Q$ 次操作，第 $i$ 次操作会把小字符串 $a_{R_{(i-1)\\bmod m+1}}$ 丢到这个 $X$ 的末尾。\n\n每次操作后，神树大人会检查这个字符串 $X$ 是否存在一个后缀使得任意排列后可以变成 $S$。\n\n问有多少次这个字符串 $X$ 存在一个后缀使得**任意排列**后可以变成 $S$（即所有字符出现次数相同）。\n\n\n可惜的是，这个字符串字符大小高达 $10^5$，所以你必须读入一个整数数组", "inputFormat": "输入 $n,T,Q$。\n\n接下来输入 $T$ 个数表示字符串 $S$。\n\n接下来输入 $n$ 行，每行第一个数 $len$ 表示长度，接下来输入 $len$ 个数表示这个小字符串，输入的每个数都在 $[0,10^5]$ 范围内。\n\n接下来输入 $m$。\n\n输入一行 $m$ 个数，表示 $R$。", "outputFormat": "输出答案。", "hint": "### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/pic/54698.png)\n\n\n### 数据范围\n\n对于所有数据，$n,T,m\\leq 10^5,1\\leq R_i\\leq n,Q\\leq 10^9$，所有小字符串的总长不超过 $10^5$，所有字符 $\\in[0,10^5]$。\n\n| 子任务 | $n$ | $T$ | $Q$ | $m$ | 特殊性质 |\n| :-: | :-: | :-: | :-: | :-: | :- |\n| 1(20分) | $n \\le 10$ | $T \\le 10$ | $Q \\le 100$ | $m \\le 10$| 字符集为 $[0,5]$，小字符串总长不超过 $100$ |\n| 2(30分) | $n \\le 10^3$ | $T \\le 100$ | $Q \\le 10^9$ | $m \\le 10^3$| 字符集为 $[0,5]$，$R_i=i,n=m$，小字符串总长不超过 $100000$ |\n| 3(10分) | $n \\le 10^5$ | $T \\le 10^5$ | $Q \\le 10^9$ | $m \\le 10^5$| 字符集为 $[0,5]$，$R_i=i,n=m$ |\n| 4(40分) | $n \\le 10^5$ | $T \\le 10^5$ | $Q \\le 10^9$ | $m \\le 10^5$||", "locale": "zh-CN", "translations": {"en": {"title": "No Matter What, Lord Divine Tree Will Drop the Database and Run Away.", "background": "As everyone knows, Divine J (Joker) goes to Chengdu FZ every few days pretending to attend classes, but is actually playing with pointers. Divine J can, when nobody is paying attention, pull out a pointer and point himself to any position (a living person suddenly appearing in a specimen cabinet?), or swap the pointers of two people (the Chengdu FZ version of *Your Name*?), or chant system commands at the OJ to make it randomly slow down (mcfx: why did the CPU get slower after boosting?).\n\nLord Divine Tree is very unhappy, because a tree must stay in place, and Lord Divine Tree also does not know pointers. But Lord Divine Tree is a god, so he plans to delete the database of this universe and run away, so that the idle Divine J can only play cards with Lord Divine Tree.", "description": "There is a string $S$ of length $T$ and $n$ small strings $a_i$.\n\nYou are given an array $R$ of length $m$, indexed starting from 1. Initially, there is an empty string $X$. Lord Divine Tree will perform $Q$ operations. In the $i$-th operation, he appends the small string $a_{R_{(i-1)\\bmod m+1}}$ to the end of $X$.\n\nAfter each operation, Lord Divine Tree checks whether the string $X$ has a suffix such that, after an arbitrary permutation, it can become $S$.\n\nAsk how many times the string $X$ has a suffix that can become $S$ after **an arbitrary permutation** (that is, the counts of all characters are the same).\n\nUnfortunately, the character set size of this string is as large as $10^5$, so you must read the strings as integer arrays.", "inputFormat": "Input $n, T, Q$.\n\nThen input $T$ numbers representing the string $S$.\n\nThen input $n$ lines. In each line, the first number $len$ is the length, followed by $len$ numbers representing this small string. Each input number is in the range $[0,10^5]$.\n\nThen input $m$.\n\nInput one line with $m$ numbers representing $R$.", "outputFormat": "Output the answer.", "hint": "### Explanation for Sample 1\n\n![](https://cdn.luogu.com.cn/upload/pic/54698.png)\n\n### Constraints\n\nFor all testdata, $n, T, m \\leq 10^5$, $1 \\leq R_i \\leq n$, $Q \\leq 10^9$. The total length of all small strings does not exceed $10^5$. All characters are in $[0,10^5]$.\n\n| Subtask | $n$ | $T$ | $Q$ | $m$ | Special Properties |\n| :-: | :-: | :-: | :-: | :-: | :- |\n| 1 (20 points) | $n \\le 10$ | $T \\le 10$ | $Q \\le 100$ | $m \\le 10$ | The alphabet is $[0,5]$, and the total length of all small strings does not exceed $100$. |\n| 2 (30 points) | $n \\le 10^3$ | $T \\le 100$ | $Q \\le 10^9$ | $m \\le 10^3$ | The alphabet is $[0,5]$, $R_i = i$, $n = m$, and the total length of all small strings does not exceed $100000$. |\n| 3 (10 points) | $n \\le 10^5$ | $T \\le 10^5$ | $Q \\le 10^9$ | $m \\le 10^5$ | The alphabet is $[0,5]$, $R_i = i$, $n = m$. |\n| 4 (40 points) | $n \\le 10^5$ | $T \\le 10^5$ | $Q \\le 10^9$ | $m \\le 10^5$ |  |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "无论怎样神树大人都会删库跑路", "background": "众所周知，神 J（Joker）每隔几天就会去成都法中假装上课，实际上是去玩指针。神J可以趁别人不注意掏出指针把自己指到任何位置（生物标本柜里大变活人？），或者把两个人的指针交换一下（成都法中版《你的名字》？），或者对着 OJ 念系统命令使得 OJ 随机变慢（mcfx：怎么这 CPU 睿频后反而变慢了）。\n\n神树大人很不满意，因为树必须站在原地，而且神树大人也不会指针。但是神树大人是神，于是他打算把这个宇宙的数据库删了跑路，这样无所事事的神 J 就只能和神树大人玩牌了。", "description": "现在有个长为 $T$ 的字符串 $S$ 和 $n$ 个小字符串 $a_i$。\n\n给定一个长为 $m$ 的数组 $R$，数组下标从 1 开始，初始有一个空字符串 $X$，神树大人打算进行 $Q$ 次操作，第 $i$ 次操作会把小字符串 $a_{R_{(i-1)\\bmod m+1}}$ 丢到这个 $X$ 的末尾。\n\n每次操作后，神树大人会检查这个字符串 $X$ 是否存在一个后缀使得任意排列后可以变成 $S$。\n\n问有多少次这个字符串 $X$ 存在一个后缀使得**任意排列**后可以变成 $S$（即所有字符出现次数相同）。\n\n\n可惜的是，这个字符串字符大小高达 $10^5$，所以你必须读入一个整数数组", "inputFormat": "输入 $n,T,Q$。\n\n接下来输入 $T$ 个数表示字符串 $S$。\n\n接下来输入 $n$ 行，每行第一个数 $len$ 表示长度，接下来输入 $len$ 个数表示这个小字符串，输入的每个数都在 $[0,10^5]$ 范围内。\n\n接下来输入 $m$。\n\n输入一行 $m$ 个数，表示 $R$。", "outputFormat": "输出答案。", "hint": "### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/pic/54698.png)\n\n\n### 数据范围\n\n对于所有数据，$n,T,m\\leq 10^5,1\\leq R_i\\leq n,Q\\leq 10^9$，所有小字符串的总长不超过 $10^5$，所有字符 $\\in[0,10^5]$。\n\n| 子任务 | $n$ | $T$ | $Q$ | $m$ | 特殊性质 |\n| :-: | :-: | :-: | :-: | :-: | :- |\n| 1(20分) | $n \\le 10$ | $T \\le 10$ | $Q \\le 100$ | $m \\le 10$| 字符集为 $[0,5]$，小字符串总长不超过 $100$ |\n| 2(30分) | $n \\le 10^3$ | $T \\le 100$ | $Q \\le 10^9$ | $m \\le 10^3$| 字符集为 $[0,5]$，$R_i=i,n=m$，小字符串总长不超过 $100000$ |\n| 3(10分) | $n \\le 10^5$ | $T \\le 10^5$ | $Q \\le 10^9$ | $m \\le 10^5$| 字符集为 $[0,5]$，$R_i=i,n=m$ |\n| 4(40分) | $n \\le 10^5$ | $T \\le 10^5$ | $Q \\le 10^9$ | $m \\le 10^5$||", "locale": "zh-CN"}}}
{"pid": "P5271", "type": "P", "difficulty": 6, "samples": [["2 2", "YES\n0 1\n2 0\n3 0\n1 2\n1 3\n3 2"], ["3 1", "YES\n0 1 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "数论", "Special Judge", "分治", "构造", "洛谷月赛"], "title": "OwenOwl 不学车也不删库", "background": "神 mcfx 和神 ComeIntoPower 没事就瞎编题目背景。OwenOwl 去问基佬 zcysky 他们这么做的原因，基佬 zcysky 却这样答复：\n\n![](https://cdn.luogu.com.cn/upload/pic/54751.png)\n\nOwenOwl 非常郁闷，于是他有一天找到了神 J，让神 J 造了 20010910 个指针把他们三个指到阿塞拜疆去陪 sunset 阿克了。\n\n他们三个游览阿塞拜疆的时候，OwenOwl 就把车砸了，库恢复了。\n\n但是因为神 mcfx 和神 ComeIntoPower 之前以 OwenOwl 这个 ID 出了太多毒瘤题，OwenOwl 早就风评被害了。为了证明毒瘤的是他俩，不是自己，OwenOwl 就出了道签到题。", "description": "设 $p$ 是一个质数。\n\n你有一个 $p^k$ 个点的无向完全图（任意两个点之间有一条无向边），点的标号是 $0$ 到 $p^k-1$。\n\n现在你需要从中找出一些 $p$ 个点的完全图，使得原图中每条边属于且恰好属于其中一个完全图。\n\n很显然你需要找出的完全图的个数是 $\\frac{p^k(p^k-1)/2}{p(p-1)/2} $，可以发现这个式子一定是整数", "inputFormat": "一行两个正整数 $p,k$。", "outputFormat": "如果无解，输出一行 `NO`。\n\n否则输出一行 `YES`，接下来输出 $\\frac{p^k(p^k-1)/2}{p(p-1)/2} $ 行，每行 $p$ 个数表示你找出的这个完全图的点的编号。\n\n按任意顺序输出任意一种方案即可。", "hint": "对于 $10\\%$ 的数据，$k \\le 1$；\n\n对于 $50\\%$ 的数据，$k \\le 2$；\n\n另有 $20\\%$ 的数据，$p = 2$；\n\n对于 $100\\%$ 的数据，$k$ 是正整数，$p$ 是质数，$2 \\le p^k \\le 2000$。\n\n另外，保证输出总量不超过 2MB，但仍请注意控制输出所花费的时间。", "locale": "zh-CN", "translations": {"en": {"title": "OwenOwl Does Not Learn Driving and Does Not Delete Repos", "background": "mcfx and ComeIntoPower like to make up problem backgrounds when they are bored. OwenOwl asked “buddy” zcysky why they did this, and “buddy” zcysky replied like this:\n\n![](https://cdn.luogu.com.cn/upload/pic/54751.png)\n\nOwenOwl felt very upset, so one day he found J, and asked J to create 20010910 pointers to point the three of them to Azerbaijan to keep sunset company there.\n\nWhile the three of them were touring Azerbaijan, OwenOwl smashed the car, and the repository was restored.\n\nHowever, since mcfx and ComeIntoPower had previously posted too many nasty problems using the ID OwenOwl, OwenOwl’s reputation had already been damaged. To prove that the nasty ones were those two and not himself, OwenOwl made an easy “sign-in” problem.", "description": "Let $p$ be a prime number.\n\nYou are given an undirected complete graph with $p^k$ vertices (there is an undirected edge between any two vertices). The vertices are labeled from $0$ to $p^k-1$.\n\nNow you need to find some complete subgraphs on $p$ vertices such that every edge in the original graph belongs to one and only one of these complete subgraphs.\n\nObviously, the number of complete subgraphs you need to find is $\\frac{p^k(p^k-1)/2}{p(p-1)/2}$. You can see that this expression is always an integer.", "inputFormat": "One line containing two positive integers $p, k$.", "outputFormat": "If there is no solution, output one line `NO`.\n\nOtherwise, output one line `YES`, then output $\\frac{p^k(p^k-1)/2}{p(p-1)/2}$ lines. Each line contains $p$ numbers, representing the vertex labels of one complete subgraph you found.\n\nYou may output any valid solution in any order.", "hint": "For $10\\%$ of the testdata, $k \\le 1$.\n\nFor $50\\%$ of the testdata, $k \\le 2$.\n\nAnother $20\\%$ of the testdata has $p = 2$.\n\nFor $100\\%$ of the testdata, $k$ is a positive integer, $p$ is prime, and $2 \\le p^k \\le 2000$.\n\nIn addition, the total output size is guaranteed not to exceed 2MB, but you should still pay attention to the time spent on output.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "OwenOwl 不学车也不删库", "background": "神 mcfx 和神 ComeIntoPower 没事就瞎编题目背景。OwenOwl 去问基佬 zcysky 他们这么做的原因，基佬 zcysky 却这样答复：\n\n![](https://cdn.luogu.com.cn/upload/pic/54751.png)\n\nOwenOwl 非常郁闷，于是他有一天找到了神 J，让神 J 造了 20010910 个指针把他们三个指到阿塞拜疆去陪 sunset 阿克了。\n\n他们三个游览阿塞拜疆的时候，OwenOwl 就把车砸了，库恢复了。\n\n但是因为神 mcfx 和神 ComeIntoPower 之前以 OwenOwl 这个 ID 出了太多毒瘤题，OwenOwl 早就风评被害了。为了证明毒瘤的是他俩，不是自己，OwenOwl 就出了道签到题。", "description": "设 $p$ 是一个质数。\n\n你有一个 $p^k$ 个点的无向完全图（任意两个点之间有一条无向边），点的标号是 $0$ 到 $p^k-1$。\n\n现在你需要从中找出一些 $p$ 个点的完全图，使得原图中每条边属于且恰好属于其中一个完全图。\n\n很显然你需要找出的完全图的个数是 $\\frac{p^k(p^k-1)/2}{p(p-1)/2} $，可以发现这个式子一定是整数", "inputFormat": "一行两个正整数 $p,k$。", "outputFormat": "如果无解，输出一行 `NO`。\n\n否则输出一行 `YES`，接下来输出 $\\frac{p^k(p^k-1)/2}{p(p-1)/2} $ 行，每行 $p$ 个数表示你找出的这个完全图的点的编号。\n\n按任意顺序输出任意一种方案即可。", "hint": "对于 $10\\%$ 的数据，$k \\le 1$；\n\n对于 $50\\%$ 的数据，$k \\le 2$；\n\n另有 $20\\%$ 的数据，$p = 2$；\n\n对于 $100\\%$ 的数据，$k$ 是正整数，$p$ 是质数，$2 \\le p^k \\le 2000$。\n\n另外，保证输出总量不超过 2MB，但仍请注意控制输出所花费的时间。", "locale": "zh-CN"}}}
{"pid": "P5272", "type": "P", "difficulty": 7, "samples": [["5\n54 63 5 59 5 27 2\n33 42 1 29 9 23 2\n54 55 56 57 2 1 3\n40 64 17 40 19 9 1\n54 65 35 50 3 10 3", "626436786\n71428572\n250000002\n1\n154489797"], ["3\n1 2 1 2 1 1 2\n3 100 39 100 1 1 2\n48395 309846 34098 234095 1 1 2", "500000004\n779746001\n262016540\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "O2优化", "位运算", "洛谷月赛"], "title": "总而言之神J要去练习篮球", "background": "神J和神树大人正在开发一个睡眠程序，运行之后人们就能在梦里随机看到宇宙中的一角。当然大部分时候这一角都是黑的，所以人们总是觉得自己没有做梦。\n\n神J留了个后门，只需要操控指针，就能钦定一个人的梦。于是神J天天操控神树大人梦里写代码。\n\n神树大人很不满意，因为树必须天天睡觉。神树大人是神，早就知道神J在背后操控，所以他也留了个后门，只需要输入特殊命令，就能强迫神J睡觉，并在梦里做任何事情。\n\n这天，神J突然发现自己身处一个大篮球场里，周围有许多学员在练习三人篮球赛。“你傻站在那干啥呢？”神树大人吹着哨子走了过来，“快去练习，都要举行肯德基三人篮球全国总决赛了，快去投进114514个球，再运球过1919810个人。zcy快过来监督他。”一个篮球突然出现在神J手里。于是神J就在zcy的监督下练习了一个下午的篮球。", "description": "为了防止神J用篮球造出一个指针把自己指出去，神树大人钦定神J用篮球造一个矩阵。\n\n这个矩阵无限大，行列从0开始标号，且$a[i][j]=i\\ xor\\ j$\n\n![](https://cdn.luogu.com.cn/upload/pic/54403.png)\n\n现在，对于一个左上角为$(lx,ly)$，右下角为$(rx,ry)$的子矩阵，$K(K\\leq 10^9)$次随机从里面取$W\\times H$的矩阵，问取出的矩阵完全一样的概率，对$10^9+7$取模。\n", "inputFormat": "第一行一个数$Q$表示$Q$组询问\n\n之后$Q$行每行7个数$lx,rx,ly,ry,W,H,K$", "outputFormat": "输出答案对$10^9+7$取模。保证答案存在。", "hint": "对于`1 2 1 2 1 1 2`这组询问\n\n![](https://cdn.luogu.com.cn/upload/pic/54402.png)\n\n可以取的矩阵有：0,3，各出现两次。\n\n有如下情况：\n\n第一次取到 3，第二次取到 0，一共4种方法\n\n第一次取到 3，第二次取到 3，一共4种方法\n\n第一次取到 0，第二次取到 0，一共4种方法\n\n第一次取到 0，第二次取到 3，一共4种方法\n\n一共16种方法，符合条件的有4+4=8种\n\n所以答案为 8/16=500000004(mod 10^9+7)\n\n\n##数据范围\n\n对于所有的数据，$0\\leq lx\\leq rx\\leq 10^9,0\\leq ly\\leq ry\\leq 10^9,W\\leq rx-lx+1,H\\leq ry-ly+1,1\\leq K\\leq 10^9,Q\\leq 10^3$\n\n![](https://cdn.luogu.com.cn/upload/pic/54632.png)\n\n空格为无特殊限制", "locale": "zh-CN", "translations": {"en": {"title": "Anyway, God J Is Going to Practice Basketball.", "background": "God J and Lord God Tree are developing a sleep program. After running it, people can randomly see a corner of the universe in their dreams. Of course, most of the time that corner is dark, so people always feel that they did not dream at all.\n\nGod J left a backdoor: as long as he controls a pointer, he can “assign” someone’s dream. So God J controls Lord God Tree’s dreams every day to write code.\n\nLord God Tree is very unhappy, because a tree has to sleep every day. Lord God Tree is a god, and he already knew that God J was controlling things behind the scenes, so he also left a backdoor: as long as you enter a special command, you can force God J to sleep and do anything in the dream.\n\nOne day, God J suddenly found himself in a huge basketball court, with many trainees practicing a 3-on-3 basketball game. “Why are you standing there like an idiot?” Lord God Tree walked over blowing a whistle. “Go practice. The KFC 3-on-3 National Finals are coming. Go score 114514 shots, then dribble past 1919810 people. zcy, come over and watch him.” A basketball suddenly appeared in God J’s hand. So God J practiced basketball for an entire afternoon under zcy’s supervision.", "description": "To prevent God J from using a basketball to create a pointer and point himself out, Lord God Tree forces God J to use basketballs to build a matrix.\n\nThis matrix is infinite. Rows and columns are indexed starting from 0, and $a[i][j]=i\\ xor\\ j$.\n\n![](https://cdn.luogu.com.cn/upload/pic/54403.png)\n\nNow, for a submatrix with top-left corner $(lx,ly)$ and bottom-right corner $(rx,ry)$, we randomly select a $W\\times H$ matrix from it $K$ times $(K\\leq 10^9)$. Ask for the probability that all selected matrices are exactly the same, modulo $10^9+7$.", "inputFormat": "The first line contains an integer $Q$, meaning there are $Q$ queries.\n\nThen $Q$ lines follow, each containing 7 integers $lx,rx,ly,ry,W,H,K$.", "outputFormat": "Output the answer modulo $10^9+7$. It is guaranteed that the answer exists.", "hint": "For the query `1 2 1 2 1 1 2`:\n\n![](https://cdn.luogu.com.cn/upload/pic/54402.png)\n\nThe matrices that can be selected are: 0 and 3, each appearing twice.\n\nThere are the following cases:\n\nFirst pick 3, second pick 0, a total of 4 ways.\n\nFirst pick 3, second pick 3, a total of 4 ways.\n\nFirst pick 0, second pick 0, a total of 4 ways.\n\nFirst pick 0, second pick 3, a total of 4 ways.\n\nThere are 16 ways in total, and the valid ones are $4+4=8$ ways.\n\nSo the answer is $8/16=500000004(mod\\ 10^9+7)$.\n\n## Constraints\n\nFor all testdata, $0\\leq lx\\leq rx\\leq 10^9,0\\leq ly\\leq ry\\leq 10^9,W\\leq rx-lx+1,H\\leq ry-ly+1,1\\leq K\\leq 10^9,Q\\leq 10^3$.\n\n![](https://cdn.luogu.com.cn/upload/pic/54632.png)\n\nBlank means there are no special constraints.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "总而言之神J要去练习篮球", "background": "神J和神树大人正在开发一个睡眠程序，运行之后人们就能在梦里随机看到宇宙中的一角。当然大部分时候这一角都是黑的，所以人们总是觉得自己没有做梦。\n\n神J留了个后门，只需要操控指针，就能钦定一个人的梦。于是神J天天操控神树大人梦里写代码。\n\n神树大人很不满意，因为树必须天天睡觉。神树大人是神，早就知道神J在背后操控，所以他也留了个后门，只需要输入特殊命令，就能强迫神J睡觉，并在梦里做任何事情。\n\n这天，神J突然发现自己身处一个大篮球场里，周围有许多学员在练习三人篮球赛。“你傻站在那干啥呢？”神树大人吹着哨子走了过来，“快去练习，都要举行肯德基三人篮球全国总决赛了，快去投进114514个球，再运球过1919810个人。zcy快过来监督他。”一个篮球突然出现在神J手里。于是神J就在zcy的监督下练习了一个下午的篮球。", "description": "为了防止神J用篮球造出一个指针把自己指出去，神树大人钦定神J用篮球造一个矩阵。\n\n这个矩阵无限大，行列从0开始标号，且$a[i][j]=i\\ xor\\ j$\n\n![](https://cdn.luogu.com.cn/upload/pic/54403.png)\n\n现在，对于一个左上角为$(lx,ly)$，右下角为$(rx,ry)$的子矩阵，$K(K\\leq 10^9)$次随机从里面取$W\\times H$的矩阵，问取出的矩阵完全一样的概率，对$10^9+7$取模。\n", "inputFormat": "第一行一个数$Q$表示$Q$组询问\n\n之后$Q$行每行7个数$lx,rx,ly,ry,W,H,K$", "outputFormat": "输出答案对$10^9+7$取模。保证答案存在。", "hint": "对于`1 2 1 2 1 1 2`这组询问\n\n![](https://cdn.luogu.com.cn/upload/pic/54402.png)\n\n可以取的矩阵有：0,3，各出现两次。\n\n有如下情况：\n\n第一次取到 3，第二次取到 0，一共4种方法\n\n第一次取到 3，第二次取到 3，一共4种方法\n\n第一次取到 0，第二次取到 0，一共4种方法\n\n第一次取到 0，第二次取到 3，一共4种方法\n\n一共16种方法，符合条件的有4+4=8种\n\n所以答案为 8/16=500000004(mod 10^9+7)\n\n\n##数据范围\n\n对于所有的数据，$0\\leq lx\\leq rx\\leq 10^9,0\\leq ly\\leq ry\\leq 10^9,W\\leq rx-lx+1,H\\leq ry-ly+1,1\\leq K\\leq 10^9,Q\\leq 10^3$\n\n![](https://cdn.luogu.com.cn/upload/pic/54632.png)\n\n空格为无特殊限制", "locale": "zh-CN"}}}
{"pid": "P5273", "type": "P", "difficulty": 6, "samples": [["2 2\n1 1", "1 2"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "2019", "快速数论变换 NTT", "模板题"], "title": "【模板】多项式幂函数（加强版）", "background": "[普通版传送门](https://www.luogu.com.cn/problem/P5245)\n\n模板题，无背景。", "description": "给定一个 $n-1$ 次多项式 $A(x)$，求一个在 $\\bmod\\ x^n$ 意义下的多项式 $B(x)$，使得 $B(x) \\equiv (A(x))^k \\ (\\bmod\\ x^n)$。\n\n多项式的系数在 $\\bmod\\ 998244353$ 的意义下进行运算。", "inputFormat": "第一行两个整数 $n,k$。\n\n接下来 $n$ 个整数，依次表示 $A(x)$ 的系数 $a_0, a_1,...,a_{n-1}$。", "outputFormat": "输出 $n$ 个整数，依次表示 $B(x)$ 的前 $n$ 项系数 $b_0, b_1,...,b_{n-1}$ 在模 $998244353$ 意义下的最小自然数值。", "hint": "对于 $100\\%$ 的数据，$1< n \\leq 10^5$，$0 \\leq k \\leq 10^{10^5}$，$a_i \\in [0,998244352]$。\n\n[数据更新时间](https://www.luogu.com.cn/paste/897zk1ia)", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Polynomial Power Function (Enhanced Version).", "background": "[Link to the normal version](https://www.luogu.com.cn/problem/P5245).\n\nThis is a template problem with no background.", "description": "Given a degree $n-1$ polynomial $A(x)$, find a polynomial $B(x)$ under $\\bmod\\ x^n$ such that $B(x) \\equiv (A(x))^k \\ (\\bmod\\ x^n)$.\n\nAll polynomial coefficients are computed under $\\bmod\\ 998244353$.", "inputFormat": "The first line contains two integers $n, k$.\n\nThe next line contains $n$ integers, which are the coefficients of $A(x)$ in order: $a_0, a_1, ..., a_{n-1}$.", "outputFormat": "Output $n$ integers, which are the first $n$ coefficients of $B(x)$ in order: $b_0, b_1, ..., b_{n-1}$, each being the smallest non-negative integer modulo $998244353$.", "hint": "For $100\\%$ of the testdata, $1 < n \\leq 10^5$, $0 \\leq k \\leq 10^{10^5}$, $a_i \\in [0, 998244352]$.\n\n[Data update time](https://www.luogu.com.cn/paste/897zk1ia).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】多项式幂函数（加强版）", "background": "[普通版传送门](https://www.luogu.com.cn/problem/P5245)\n\n模板题，无背景。", "description": "给定一个 $n-1$ 次多项式 $A(x)$，求一个在 $\\bmod\\ x^n$ 意义下的多项式 $B(x)$，使得 $B(x) \\equiv (A(x))^k \\ (\\bmod\\ x^n)$。\n\n多项式的系数在 $\\bmod\\ 998244353$ 的意义下进行运算。", "inputFormat": "第一行两个整数 $n,k$。\n\n接下来 $n$ 个整数，依次表示 $A(x)$ 的系数 $a_0, a_1,...,a_{n-1}$。", "outputFormat": "输出 $n$ 个整数，依次表示 $B(x)$ 的前 $n$ 项系数 $b_0, b_1,...,b_{n-1}$ 在模 $998244353$ 意义下的最小自然数值。", "hint": "对于 $100\\%$ 的数据，$1< n \\leq 10^5$，$0 \\leq k \\leq 10^{10^5}$，$a_i \\in [0,998244352]$。\n\n[数据更新时间](https://www.luogu.com.cn/paste/897zk1ia)", "locale": "zh-CN"}}}
{"pid": "P5277", "type": "P", "difficulty": 6, "samples": [["3\n1 2 1\n", "1 1 0"], ["7\n1 8596489 489489 4894 1564 489 35789489  \n", "1 503420421 924499237 13354513 217017417 707895465 411020414\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["快速傅里叶变换 FFT", "快速数论变换 NTT", "模板题"], "title": "【模板】多项式开根（加强版）", "background": "模板题，无背景", "description": "给定一个 $n-1$ 次多项式 $A(x)$ ，求一个在 $\\bmod\\ {x^n}$ 意义下的多项式 $B(x)$ ，使得 $B^2(x)\\equiv A(x)\\pmod {x^n}$。\n\n多项式的系数在 $\\bmod\\ 998244353$ 的意义下进行运算。", "inputFormat": "第一行一个正整数 $n$。\n\n接下来 $n$ 个整数，依次表示多项式的系数 $a_0,a_1,\\ldots ,a_{n-1}$。\n\n**不保证 $a_0=1$，但保证 $a_0$ 是 $\\bmod\\ 998244353$ 下的二次剩余。**", "outputFormat": "输出 $n$ 个非负整数，表示答案多项式的系数 $b_0,b_1,\\ldots ,b_{n-1}$。如有多解，输出**系数序列**（而非字符序列）字典序最小的。", "hint": "对于 $25\\%$ 的数据，有 $n \\leq 1000$。\n\n对于 $50\\%$ 的数据，有 $n \\leq 10^4$。\n\n对于 $75\\%$ 的数据，有 $n \\leq 5\\times 10^4$。\n\n对于 $100\\%$ 的数据，有 $n \\leq 10^5,a_i \\in [0,998244352] \\cap \\mathbb{Z}$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Polynomial Square Root (Enhanced Version)", "background": "This is a template problem, with no background.", "description": "Given an $(n - 1)$-degree polynomial $A(x)$, find a polynomial $B(x)$ modulo $x^n$ such that $B^2(x)\\equiv A(x)\\pmod {x^n}$.\n\nAll polynomial coefficients are computed modulo $998244353$.", "inputFormat": "The first line contains a positive integer $n$.\n\nThe next line contains $n$ integers, representing the coefficients $a_0,a_1,\\ldots ,a_{n-1}$ in order.\n\n**It is not guaranteed that $a_0=1$, but it is guaranteed that $a_0$ is a quadratic residue modulo $998244353$.**", "outputFormat": "Output $n$ non-negative integers, representing the coefficients $b_0,b_1,\\ldots ,b_{n-1}$ of the answer polynomial. If there are multiple solutions, output the one with the smallest lexicographical order of the **coefficient sequence** (not the character sequence).", "hint": "For $25\\%$ of the testdata, $n \\leq 1000$.\n\nFor $50\\%$ of the testdata, $n \\leq 10^4$.\n\nFor $75\\%$ of the testdata, $n \\leq 5\\times 10^4$.\n\nFor $100\\%$ of the testdata, $n \\leq 10^5$, and $a_i \\in [0,998244352] \\cap \\mathbb{Z}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】多项式开根（加强版）", "background": "模板题，无背景", "description": "给定一个 $n-1$ 次多项式 $A(x)$ ，求一个在 $\\bmod\\ {x^n}$ 意义下的多项式 $B(x)$ ，使得 $B^2(x)\\equiv A(x)\\pmod {x^n}$。\n\n多项式的系数在 $\\bmod\\ 998244353$ 的意义下进行运算。", "inputFormat": "第一行一个正整数 $n$。\n\n接下来 $n$ 个整数，依次表示多项式的系数 $a_0,a_1,\\ldots ,a_{n-1}$。\n\n**不保证 $a_0=1$，但保证 $a_0$ 是 $\\bmod\\ 998244353$ 下的二次剩余。**", "outputFormat": "输出 $n$ 个非负整数，表示答案多项式的系数 $b_0,b_1,\\ldots ,b_{n-1}$。如有多解，输出**系数序列**（而非字符序列）字典序最小的。", "hint": "对于 $25\\%$ 的数据，有 $n \\leq 1000$。\n\n对于 $50\\%$ 的数据，有 $n \\leq 10^4$。\n\n对于 $75\\%$ 的数据，有 $n \\leq 5\\times 10^4$。\n\n对于 $100\\%$ 的数据，有 $n \\leq 10^5,a_i \\in [0,998244352] \\cap \\mathbb{Z}$。", "locale": "zh-CN"}}}
{"pid": "P5278", "type": "P", "difficulty": 6, "samples": [["5 3\n1 3 2 5 6\n2 1 5 1\n1 5 4\n2 1 5 1", "No\nYes"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["线段树"], "title": "算术天才⑨与等差数列", "background": null, "description": "算术天才⑨非常喜欢和等差数列玩耍。   \n有一天，他给了你一个长度为 $n$ 的序列，其中第 $i$ 个数为 $a_i$。  \n他想考考你，每次他会给出询问 $l,r,k$，问区间 $[l,r]$ 内的数从小到大排序后能否形成公差为 $k$ 的等差数列。  \n当然，他还会不断修改其中的某一项。  \n为了不被他鄙视，你必须要快速并正确地回答完所有问题。  \n注意：只有一个数的数列也是等差数列。", "inputFormat": "第一行包含两个正整数 $n,m$，分别表示序列的长度和操作的次数。   \n第二行包含 $n$ 个整数，依次表示序列中的每个数 $a_i$。   \n接下来 $m$ 行，每行一开始为一个数 $\\text{op}$，   \n若 $\\text{op}=1$，则接下来两个整数 $x,y$，表示把 $a_x$ 修改为 $y$，  \n若 $\\text{op}=2$，则接下来三个整数 $l,r,k$，表示一个询问。  \n**在本题中，$x,y,l,r,k$ 都是经过加密的，都需要异或你之前输出的 `Yes` 的个数来进行解密。**", "outputFormat": "输出若干行，对于每个询问，如果可以形成等差数列，那么输出 `Yes`，否则输出 `No`。", "hint": "【数据范围】  \n对于 $100\\%$ 的数据， $1\\le n,m \\le 3\\times 10^5$，$0\\le a_i,y,k \\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "Arithmetic Genius ⑨ and Arithmetic Progressions", "background": "", "description": "Arithmetic Genius ⑨ really likes playing with arithmetic progressions.  \nOne day, he gave you a sequence of length $n$, where the $i$-th number is $a_i$.  \nHe wants to test you. Each time, he will give a query $l, r, k$ and ask whether the numbers in the interval $[l, r]$, after being sorted in increasing order, can form an arithmetic progression with common difference $k$.  \nOf course, he will also keep modifying some element.  \nTo avoid being looked down on by him, you must answer all queries quickly and correctly.  \nNote: A sequence with only one number is also an arithmetic progression.", "inputFormat": "The first line contains two positive integers $n, m$, representing the length of the sequence and the number of operations.  \nThe second line contains $n$ integers, in order, representing each number in the sequence $a_i$.  \nThe next $m$ lines each start with a number $\\text{op}$.  \nIf $\\text{op} = 1$, then two integers $x, y$ follow, meaning to modify $a_x$ to $y$.  \nIf $\\text{op} = 2$, then three integers $l, r, k$ follow, meaning a query.  \n**In this problem, $x, y, l, r, k$ are all encrypted, and you need to decrypt them by XORing with the number of `Yes` you have output before.**", "outputFormat": "Output several lines. For each query, if it can form an arithmetic progression, output `Yes`; otherwise output `No`.", "hint": "Constraints  \nFor $100\\%$ of the testdata, $1 \\le n, m \\le 3 \\times 10^5$, and $0 \\le a_i, y, k \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "算术天才⑨与等差数列", "background": null, "description": "算术天才⑨非常喜欢和等差数列玩耍。   \n有一天，他给了你一个长度为 $n$ 的序列，其中第 $i$ 个数为 $a_i$。  \n他想考考你，每次他会给出询问 $l,r,k$，问区间 $[l,r]$ 内的数从小到大排序后能否形成公差为 $k$ 的等差数列。  \n当然，他还会不断修改其中的某一项。  \n为了不被他鄙视，你必须要快速并正确地回答完所有问题。  \n注意：只有一个数的数列也是等差数列。", "inputFormat": "第一行包含两个正整数 $n,m$，分别表示序列的长度和操作的次数。   \n第二行包含 $n$ 个整数，依次表示序列中的每个数 $a_i$。   \n接下来 $m$ 行，每行一开始为一个数 $\\text{op}$，   \n若 $\\text{op}=1$，则接下来两个整数 $x,y$，表示把 $a_x$ 修改为 $y$，  \n若 $\\text{op}=2$，则接下来三个整数 $l,r,k$，表示一个询问。  \n**在本题中，$x,y,l,r,k$ 都是经过加密的，都需要异或你之前输出的 `Yes` 的个数来进行解密。**", "outputFormat": "输出若干行，对于每个询问，如果可以形成等差数列，那么输出 `Yes`，否则输出 `No`。", "hint": "【数据范围】  \n对于 $100\\%$ 的数据， $1\\le n,m \\le 3\\times 10^5$，$0\\le a_i,y,k \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5279", "type": "P", "difficulty": 7, "samples": [["9\n1 1\n1 2\n1 3\n2 1\n3 1\n4 1\n5 1\n6 1\n7 1\n8 1\n9 1\n9 2\n9 3", "1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "浙江", "O2优化", "DP 套 DP"], "title": "[ZJOI2019] 麻将", "background": null, "description": "九条可怜是一个热爱打麻将的女孩子。因此她出了一道和麻将相关的题目，希望这题不会让你对麻将的热爱消失殆尽。\n\n![](https://cdn.luogu.com.cn/upload/pic/55642.png)\n\n今天，可怜想要打麻将，但是她的朋友们都去下自走棋了，因此可怜只能自己一个人打。可怜找了一套特殊的麻将，它有 $n(n\\ge 5)$ 种不同的牌，大小分别为 $1$ 到 $n$，每种牌都有 $4$ 张。\n\n定义面子为三张大小相同或者大小相邻的麻将牌，即大小形如 $i,i,i(1 \\le i \\le n)$ 或者 $i,i+1,i+2(1\\le i\\le n-2)$。定义对子为两张大小相同的麻将牌，即大小形如 $i,i(1 \\le i \\le n)$。\n\n定义一个麻将牌集合 $S$ 是胡的当且仅当它的大小为 $14$ 且满足下面两个条件中的至少一个：\n\n-  $S$ 可以被划分成五个集合 $S_1$ 至 $S_5$。其中 $S_1$ 为对子，$S_2$ 至 $S_5$ 为面子。\n-  $S$ 可以被划分成七个集合 $S_1$ 至 $S_7$，它们都是对子，且对应的大小**两两不同**。\n\n举例来说，下列集合都是胡的（这儿只标记了大小）：\n\n-  $\\{1,1,1,1,2,3,4,5,6,7,8,9,9,9\\}$\n-  $\\{1,1,2,2,4,4,5,5,6,6,7,7,8,8\\}$\n-  $\\{1,1,2,2,3,3,4,4,5,5,6,6,7,7\\}$\n\n而下列集合都不是胡的：\n\n-  $\\{1,1,1,2,3,4,5,6,7,8,9,9,9\\}$\n-  $\\{1,1,1,1,4,4,5,5,6,6,7,7,8,8\\}$\n-  $\\{1,1,1,2,3,4,5,6,7,8,9,9,9,11\\}$\n\n可怜先摸出了 $13$ 张牌，并把剩下的 $4n-13$ 张牌随机打乱。打乱是等概率随机的，即所有 $(4n-13)!$ 种排列都等概率出现。\n\n对于一个排列 $P$，可怜定义 $S_i$ 为可怜事先摸出的 $13$ 张牌加上 $P$ 中的前 $i$ 张牌构成的集合，定义 $P$ 的权值为**最小的 $i$ 满足 $S_i$ 存在一个子集是胡的**。如果你对麻将比较熟悉，不难发现 $P$ 的权值就是理论上的最早胡牌巡目数。注意到 $n\\ge 5$ 的时候，$S_{4n-13}$ 总是存在胡的子集的，因此 $P$ 的权值是良定义的。\n\n现在可怜想要训练自己的牌效，因此她希望你能先计算出 $P$ 的权值的期望是多少。", "inputFormat": "第一行输入一个整数 $n$，表示这副特殊的麻将牌中的大小种类数。\n\n接下来输入 $13$ 行每行两个整数 $w,t(1 \\le w \\le n,1 \\le t \\le 4)$，表示可怜最开始摸出的第 $i$ 张牌是大小为 $w$ 的第 $t$ 张牌，保证 $(w,t)$ 二元组两两不同。", "outputFormat": "输出一行一个整数，表示答案对 $998244353$ 取模后的值。即如果答案的最简分数表示为 $\\frac{x}{y}(x \\ge 0,y \\ge 1,gcd(x,y) = 1)$，你需要输出 $x\\times y^{-1}\\ \\mathrm{mod}\\: 998244353$。", "hint": "上述牌型叫做纯正九莲宝灯，不难发现不管再加一张什么牌它都是胡的。所以对于所有排列 $P$，权值都是 $1$，因此权值的期望就是 $1$。\n\n对于 $20\\%$ 的数据，$n = 5$。\n\n对于 $50\\%$ 的数据，$n\\le 13$。\n\n对于另外 $20\\%$ 的数据，$n \\le 100,w_i = i,t_i = 1$。\n\n对于另外 $20\\%$ 的数据，$n \\le 100,w_i = \\lceil \\frac{i}{4} \\rceil ,t_i= i\\ \\mathrm{mod}\\ 4 + 1$。\n\n对于 $100\\%$ 的数据，$5 \\le n \\le 100$。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2019] Mahjong", "background": "", "description": "Jiutiao Kelian is a girl who loves playing Mahjong. So she made a Mahjong-related problem, hoping this problem will not make your love for Mahjong disappear completely.\n\n![](https://cdn.luogu.com.cn/upload/pic/55642.png)\n\nToday, Kelian wants to play Mahjong, but all her friends went to play Auto Chess, so Kelian can only play alone. Kelian found a special Mahjong set. It has $n(n\\ge 5)$ different tile values, with values from $1$ to $n$. For each value, there are $4$ tiles.\n\nA meld is defined as three tiles that are either all the same value or consecutive values, i.e., with values of the form $i,i,i(1 \\le i \\le n)$ or $i,i+1,i+2(1\\le i\\le n-2)$. A pair is defined as two tiles of the same value, i.e., with values of the form $i,i(1 \\le i \\le n)$.\n\nA multiset of Mahjong tiles $S$ is said to be winning if and only if its size is $14$ and it satisfies at least one of the following two conditions:\n\n- $S$ can be partitioned into five multisets $S_1$ to $S_5$, where $S_1$ is a pair, and $S_2$ to $S_5$ are melds.\n- $S$ can be partitioned into seven multisets $S_1$ to $S_7$, all of which are pairs, and their corresponding values are **pairwise distinct**.\n\nFor example, the following multisets are all winning (only the values are shown here):\n\n- $\\{1,1,1,1,2,3,4,5,6,7,8,9,9,9\\}$\n- $\\{1,1,2,2,4,4,5,5,6,6,7,7,8,8\\}$\n- $\\{1,1,2,2,3,3,4,4,5,5,6,6,7,7\\}$\n\nAnd the following multisets are all not winning:\n\n- $\\{1,1,1,2,3,4,5,6,7,8,9,9,9\\}$\n- $\\{1,1,1,1,4,4,5,5,6,6,7,7,8,8\\}$\n- $\\{1,1,1,2,3,4,5,6,7,8,9,9,9,11\\}$\n\nKelian first draws $13$ tiles, and then randomly shuffles the remaining $4n-13$ tiles. The shuffling is uniformly random, i.e., all $(4n-13)!$ permutations occur with equal probability.\n\nFor a permutation $P$, Kelian defines $S_i$ as the multiset formed by the $13$ tiles she drew in advance plus the first $i$ tiles in $P$. The weight of $P$ is defined as the **minimum $i$ such that $S_i$ has a subset that is winning**. If you are familiar with Mahjong, it is not hard to see that the weight of $P$ is the earliest theoretical turn to win. Note that when $n\\ge 5$, $S_{4n-13}$ always has a winning subset, so the weight of $P$ is well-defined.\n\nNow Kelian wants to train her tile efficiency, so she hopes you can first compute the expected value of the weight of $P$.", "inputFormat": "The first line contains an integer $n$, indicating the number of different tile values in this special Mahjong set.\n\nThen follow $13$ lines, each containing two integers $w,t(1 \\le w \\le n,1 \\le t \\le 4)$, indicating that the $i$-th tile Kelian initially drew is the $t$-th tile of value $w$. It is guaranteed that the pairs $(w,t)$ are pairwise distinct.", "outputFormat": "Output one line containing one integer, indicating the answer modulo $998244353$. That is, if the answer in lowest terms is $\\frac{x}{y}(x \\ge 0,y \\ge 1,gcd(x,y) = 1)$, you need to output $x\\times y^{-1}\\ \\mathrm{mod}\\: 998244353$.", "hint": "The above hand type is called Pure Nine Gates. It is not hard to see that no matter what tile you add, it is winning. Therefore, for all permutations $P$, the weight is $1$, so the expected weight is $1$.\n\nFor $20\\%$ of the testdata, $n = 5$.\n\nFor $50\\%$ of the testdata, $n\\le 13$.\n\nFor another $20\\%$ of the testdata, $n \\le 100,w_i = i,t_i = 1$.\n\nFor another $20\\%$ of the testdata, $n \\le 100,w_i = \\lceil \\frac{i}{4} \\rceil ,t_i= i\\ \\mathrm{mod}\\ 4 + 1$.\n\nFor $100\\%$ of the testdata, $5 \\le n \\le 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2019] 麻将", "background": null, "description": "九条可怜是一个热爱打麻将的女孩子。因此她出了一道和麻将相关的题目，希望这题不会让你对麻将的热爱消失殆尽。\n\n![](https://cdn.luogu.com.cn/upload/pic/55642.png)\n\n今天，可怜想要打麻将，但是她的朋友们都去下自走棋了，因此可怜只能自己一个人打。可怜找了一套特殊的麻将，它有 $n(n\\ge 5)$ 种不同的牌，大小分别为 $1$ 到 $n$，每种牌都有 $4$ 张。\n\n定义面子为三张大小相同或者大小相邻的麻将牌，即大小形如 $i,i,i(1 \\le i \\le n)$ 或者 $i,i+1,i+2(1\\le i\\le n-2)$。定义对子为两张大小相同的麻将牌，即大小形如 $i,i(1 \\le i \\le n)$。\n\n定义一个麻将牌集合 $S$ 是胡的当且仅当它的大小为 $14$ 且满足下面两个条件中的至少一个：\n\n-  $S$ 可以被划分成五个集合 $S_1$ 至 $S_5$。其中 $S_1$ 为对子，$S_2$ 至 $S_5$ 为面子。\n-  $S$ 可以被划分成七个集合 $S_1$ 至 $S_7$，它们都是对子，且对应的大小**两两不同**。\n\n举例来说，下列集合都是胡的（这儿只标记了大小）：\n\n-  $\\{1,1,1,1,2,3,4,5,6,7,8,9,9,9\\}$\n-  $\\{1,1,2,2,4,4,5,5,6,6,7,7,8,8\\}$\n-  $\\{1,1,2,2,3,3,4,4,5,5,6,6,7,7\\}$\n\n而下列集合都不是胡的：\n\n-  $\\{1,1,1,2,3,4,5,6,7,8,9,9,9\\}$\n-  $\\{1,1,1,1,4,4,5,5,6,6,7,7,8,8\\}$\n-  $\\{1,1,1,2,3,4,5,6,7,8,9,9,9,11\\}$\n\n可怜先摸出了 $13$ 张牌，并把剩下的 $4n-13$ 张牌随机打乱。打乱是等概率随机的，即所有 $(4n-13)!$ 种排列都等概率出现。\n\n对于一个排列 $P$，可怜定义 $S_i$ 为可怜事先摸出的 $13$ 张牌加上 $P$ 中的前 $i$ 张牌构成的集合，定义 $P$ 的权值为**最小的 $i$ 满足 $S_i$ 存在一个子集是胡的**。如果你对麻将比较熟悉，不难发现 $P$ 的权值就是理论上的最早胡牌巡目数。注意到 $n\\ge 5$ 的时候，$S_{4n-13}$ 总是存在胡的子集的，因此 $P$ 的权值是良定义的。\n\n现在可怜想要训练自己的牌效，因此她希望你能先计算出 $P$ 的权值的期望是多少。", "inputFormat": "第一行输入一个整数 $n$，表示这副特殊的麻将牌中的大小种类数。\n\n接下来输入 $13$ 行每行两个整数 $w,t(1 \\le w \\le n,1 \\le t \\le 4)$，表示可怜最开始摸出的第 $i$ 张牌是大小为 $w$ 的第 $t$ 张牌，保证 $(w,t)$ 二元组两两不同。", "outputFormat": "输出一行一个整数，表示答案对 $998244353$ 取模后的值。即如果答案的最简分数表示为 $\\frac{x}{y}(x \\ge 0,y \\ge 1,gcd(x,y) = 1)$，你需要输出 $x\\times y^{-1}\\ \\mathrm{mod}\\: 998244353$。", "hint": "上述牌型叫做纯正九莲宝灯，不难发现不管再加一张什么牌它都是胡的。所以对于所有排列 $P$，权值都是 $1$，因此权值的期望就是 $1$。\n\n对于 $20\\%$ 的数据，$n = 5$。\n\n对于 $50\\%$ 的数据，$n\\le 13$。\n\n对于另外 $20\\%$ 的数据，$n \\le 100,w_i = i,t_i = 1$。\n\n对于另外 $20\\%$ 的数据，$n \\le 100,w_i = \\lceil \\frac{i}{4} \\rceil ,t_i= i\\ \\mathrm{mod}\\ 4 + 1$。\n\n对于 $100\\%$ 的数据，$5 \\le n \\le 100$。", "locale": "zh-CN"}}}
{"pid": "P5280", "type": "P", "difficulty": 6, "samples": [["5 5\n2\n1 1 3\n2\n1 3 5\n2", "0\n1\n6"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "浙江", "O2优化"], "title": "[ZJOI2019] 线段树", "background": null, "description": "九条可怜是一个喜欢数据结构的女孩子，在常见的数据结构中，可怜最喜欢的就是线段树。\n\n线段树的核心是懒标记，下面是一个带懒标记的线段树的伪代码，其中 $tag$ 数组为懒标记：\n\n![](https://cdn.luogu.com.cn/upload/pic/55648.png)\n\n其中函数 $\\operatorname{Lson}(Node)$ 表示 $Node$ 的左儿子，$\\operatorname{Rson}(Node)$ 表示 $Node$ 的右儿子。\n\n现在可怜手上有一棵 $[1,n]$ 上的线段树，编号为 $1$。这棵线段树上的所有节点的 $tag$ 均为 $0$。接下来可怜进行了 $m$ 次操作，操作有两种：\n\n- $1\\ l\\ r$，假设可怜当前手上有 $t$ 棵线段树，可怜会把每棵线段树复制两份（$tag$ 数组也一起复制），原先编号为 $i$ 的线段树复制得到的两棵编号为 $2i-1$ 与 $2i$，在复制结束后，可怜手上一共有 $2t$ 棵线段树。接着，可怜会对所有编号为奇数的线段树进行一次 $\\operatorname{Modify}(root,1,n,l,r)$。\n\n- $2$，可怜定义一棵线段树的权值为它上面有多少个节点 $tag$ 为 $1$。可怜想要知道她手上所有线段树的权值和是多少。", "inputFormat": "第一行输入两个整数 $n,m$ 表示初始区间长度和操作个数。\n\n接下来 $m$ 行每行描述一个操作，输入保证 $1 \\le l \\le r \\le n$。", "outputFormat": "对于每次询问，输出一行一个整数表示答案，答案可能很大，对 $998244353$ 取模后输出即可。", "hint": "[1,5] 上的线段树如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/pic/55649.png)\n\n在第一次询问时，可怜手上有一棵线段树，它所有点上都没有标记，因此答案为 $0$。\n\n在第二次询问时，可怜手上有两棵线段树，按照编号，它们的标记情况为：\n\n1. 点 $[1,3]$ 上有标记，权值为 $1$。\n2. 没有点有标记，权值为 $0$。\n\n因此答案为 $1$。\n\n在第三次询问时，可怜手上有四棵线段树，按照编号，它们的标记情况为：\n\n1. 点 $[1,2],[3,3],[4,5]$ 上有标记，权值为 $3$。\n2. 点 $[1,3]$ 上有标记，权值为 $1$。\n3. 点 $[3,3],[4,5]$ 上有标记，权值为 $2$。\n4. 没有点有标记，权值为 $0$。\n\n因此答案为 $6$。\n\n|测试点|$n$|$m$|其他约定|\n|:-:|:-:|:-:|:-:|\n|$1$|$\\le 1000$|$\\le 10$|无|\n|$2$|^|^|^|\n|$3$|^|$\\le 1000$|^|\n|$4$|^|^|^|\n|$5$|$\\le 10^5$|$\\le 10^5$|询问只有一个|\n|$6$|^|^|^|\n|$7$|^|^|^|\n|$8$|^|^|无|\n|$9$|^|^|^|\n|$10$|^|^|^|\n\n对于 $100\\%$ 的数据，$1\\le l\\le r\\le n$。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2019] Segment Tree", "background": "", "description": "Jiutiao Kelian is a girl who likes data structures. Among common data structures, her favorite is the segment tree.\n\nThe core of a segment tree is lazy propagation. Below is pseudocode for a segment tree with lazy tags, where the array $tag$ is the lazy tag:\n\n![](https://cdn.luogu.com.cn/upload/pic/55648.png)\n\nHere, the function $\\operatorname{Lson}(Node)$ denotes the left child of $Node$, and $\\operatorname{Rson}(Node)$ denotes the right child of $Node$.\n\nNow Kelian has a segment tree over $[1,n]$, with index $1$. All nodes in this segment tree have $tag = 0$. Then Kelian performs $m$ operations. There are two types of operations:\n\n- $1\\ l\\ r$: Suppose Kelian currently has $t$ segment trees. She will copy each segment tree into two copies (the $tag$ array is copied as well). The segment tree originally indexed $i$ becomes two copied trees indexed $2i-1$ and $2i$. After copying, she has $2t$ segment trees in total. Then, she performs $\\operatorname{Modify}(root,1,n,l,r)$ once on every segment tree whose index is odd.\n\n- $2$: Kelian defines the weight of a segment tree as the number of nodes in it whose $tag$ equals $1$. She wants to know the sum of weights of all segment trees she currently has.", "inputFormat": "The first line contains two integers $n,m$, denoting the initial interval length and the number of operations.\n\nEach of the next $m$ lines describes one operation. The input guarantees $1 \\le l \\le r \\le n$.", "outputFormat": "For each query, output one integer per line representing the answer. The answer can be very large, so output it modulo $998244353$.", "hint": "The segment tree over $[1,5]$ is shown below:\n\n![](https://cdn.luogu.com.cn/upload/pic/55649.png)\n\nAt the first query, Kelian has one segment tree, and there are no marks on any node, so the answer is $0$.\n\nAt the second query, Kelian has two segment trees. By their indices, their marked nodes are:\n\n1. Node $[1,3]$ is marked, so the weight is $1$.\n2. No node is marked, so the weight is $0$.\n\nSo the answer is $1$.\n\nAt the third query, Kelian has four segment trees. By their indices, their marked nodes are:\n\n1. Nodes $[1,2],[3,3],[4,5]$ are marked, so the weight is $3$.\n2. Node $[1,3]$ is marked, so the weight is $1$.\n3. Nodes $[3,3],[4,5]$ are marked, so the weight is $2$.\n4. No node is marked, so the weight is $0$.\n\nSo the answer is $6$.\n\n|Test Point|$n$|$m$|Other Constraints|\n|:-:|:-:|:-:|:-:|\n|$1$|$\\le 1000$|$\\le 10$|None|\n|$2$|^|^|^|\n|$3$|^|$\\le 1000$|^|\n|$4$|^|^|^|\n|$5$|$\\le 10^5$|$\\le 10^5$|There is only one query|\n|$6$|^|^|^|\n|$7$|^|^|^|\n|$8$|^|^|None|\n|$9$|^|^|^|\n|$10$|^|^|^|\n\nFor $100\\%$ of the data, $1 \\le l \\le r \\le n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2019] 线段树", "background": null, "description": "九条可怜是一个喜欢数据结构的女孩子，在常见的数据结构中，可怜最喜欢的就是线段树。\n\n线段树的核心是懒标记，下面是一个带懒标记的线段树的伪代码，其中 $tag$ 数组为懒标记：\n\n![](https://cdn.luogu.com.cn/upload/pic/55648.png)\n\n其中函数 $\\operatorname{Lson}(Node)$ 表示 $Node$ 的左儿子，$\\operatorname{Rson}(Node)$ 表示 $Node$ 的右儿子。\n\n现在可怜手上有一棵 $[1,n]$ 上的线段树，编号为 $1$。这棵线段树上的所有节点的 $tag$ 均为 $0$。接下来可怜进行了 $m$ 次操作，操作有两种：\n\n- $1\\ l\\ r$，假设可怜当前手上有 $t$ 棵线段树，可怜会把每棵线段树复制两份（$tag$ 数组也一起复制），原先编号为 $i$ 的线段树复制得到的两棵编号为 $2i-1$ 与 $2i$，在复制结束后，可怜手上一共有 $2t$ 棵线段树。接着，可怜会对所有编号为奇数的线段树进行一次 $\\operatorname{Modify}(root,1,n,l,r)$。\n\n- $2$，可怜定义一棵线段树的权值为它上面有多少个节点 $tag$ 为 $1$。可怜想要知道她手上所有线段树的权值和是多少。", "inputFormat": "第一行输入两个整数 $n,m$ 表示初始区间长度和操作个数。\n\n接下来 $m$ 行每行描述一个操作，输入保证 $1 \\le l \\le r \\le n$。", "outputFormat": "对于每次询问，输出一行一个整数表示答案，答案可能很大，对 $998244353$ 取模后输出即可。", "hint": "[1,5] 上的线段树如下图所示：\n\n![](https://cdn.luogu.com.cn/upload/pic/55649.png)\n\n在第一次询问时，可怜手上有一棵线段树，它所有点上都没有标记，因此答案为 $0$。\n\n在第二次询问时，可怜手上有两棵线段树，按照编号，它们的标记情况为：\n\n1. 点 $[1,3]$ 上有标记，权值为 $1$。\n2. 没有点有标记，权值为 $0$。\n\n因此答案为 $1$。\n\n在第三次询问时，可怜手上有四棵线段树，按照编号，它们的标记情况为：\n\n1. 点 $[1,2],[3,3],[4,5]$ 上有标记，权值为 $3$。\n2. 点 $[1,3]$ 上有标记，权值为 $1$。\n3. 点 $[3,3],[4,5]$ 上有标记，权值为 $2$。\n4. 没有点有标记，权值为 $0$。\n\n因此答案为 $6$。\n\n|测试点|$n$|$m$|其他约定|\n|:-:|:-:|:-:|:-:|\n|$1$|$\\le 1000$|$\\le 10$|无|\n|$2$|^|^|^|\n|$3$|^|$\\le 1000$|^|\n|$4$|^|^|^|\n|$5$|$\\le 10^5$|$\\le 10^5$|询问只有一个|\n|$6$|^|^|^|\n|$7$|^|^|^|\n|$8$|^|^|无|\n|$9$|^|^|^|\n|$10$|^|^|^|\n\n对于 $100\\%$ 的数据，$1\\le l\\le r\\le n$。", "locale": "zh-CN"}}}
{"pid": "P5281", "type": "P", "difficulty": 7, "samples": [["5 1 5\n1 5\n1 4\n5 3\n5 2", "4 0 1 0 2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "浙江", "O2优化"], "title": "[ZJOI2019] Minimax搜索", "background": "", "description": "九条可怜是一个喜欢玩游戏的女孩子。为了增强自己的游戏水平，她想要用理论的武器武装自己。这道题和著名的 Minimax 搜索有关。\n\n可怜有一棵有根树，根节点编号为 $1$。定义根节点的深度为 $1$，其他节点的深度为它的父亲的深度加一。同时在叶子节点权值给定的情况下，可怜用如下方式定义了每一个非节点的权值：\n- 对于深度为奇数的非叶子节点，它的权值是它所有子节点的权值最大值。\n- 对于深度为偶数的非叶子节点，它的权值是它所有子节点的权值最小值。\n\n最开始，可怜令编号为 $i$ 的叶子节点权值为 i，并计算得到了根节点的权值为 $W$。\n\n现在，邪恶的 Cedyks 想要通过修改某些叶子节点的权值，来让根节点的权值发生改变。Cedyks 设计了一个量子攻击器，在攻击器发动后，Cedyks 会随机获得一个非空的叶子节点集合 $S$ 的控制权，并可以花费一定的能量来修改 $S$ 中的叶子节点的权值。\n\n然而，修改叶子节点的权值也要消耗能量，对于 $S$ 中的叶子节点 $i$，它的初始权值为 $i$，假设 Cedyks 把它的权值修改成了 $w_i$（$w_i$ **可以是任意整数，包括负数**），则 Cedyks 在这次攻击中，需要花费的能量为 $\\max_{i\\in S} |i − w_i|$。\n\nCedyks 想要尽可能节约能量，于是他总是会**以最少的能量来完成攻击**，即在花费的能量最小的情况下，让根节点的权值发生改变。令 $w(S)$ 为 Cedyks 在获得了集合 $S$ 的控制权后，会花费的能量。特殊地，对于某些集合 $S$，可能无论如何改变 $S$ 中叶子节点的权值，根节点的权值都不会发生改变，这时，$w(S)$ 的值被定义为 $n$。为了方便，我们称 $w(S)$ 为 $S$ 的稳定度。\n\n当有 $m$ 个叶子节点的时候，一共有 $2^m − 1$ 种不同的叶子节点的非空集合。在发动攻击前，Cedyks 想要先预估一下自己需要花费的能量。于是他给出了一个区间 $[L, R]$，他想要知道对于每一个 $k \\in [L, R]$，有多少个集合 $S$ 满足 $w(S) = k$。", "inputFormat": "第一行输入三个整数 $n,L,R(n ≥ 2,1 \\leq L \\leq R \\leq n)$。\n\n接下来 $n - 1$ 行每行两个整数 $u,v$，表示树上的一条边。", "outputFormat": "输出一行 $R-L+1$ 个整数，第 $i$ 个整数表示 $w(S)$ 为 $L+i-1$ 的集合 $S$ 有多少个。答案可能会很大，请对 $998244353$ 取模后输出。", "hint": "#### 样例 1 解释\n\n最开始，在可怜的设定下（$i$ 号叶子节点的权值为 $i$），根节点的权值为 $4$。\n\n树上一共有 $3$ 个叶子节点 $\\{2,3,4\\}$，一共有 $7$ 个非空的叶子节点权值，其中：\n\n- $\\{4\\}, \\{2,4\\}, \\{3,4\\}, \\{2,3,4\\}$ 的稳定度为 $1$，只要稍微修改 $4$ 号叶子节点的权值，根节点的权值就会发生改变。\n- $\\{2\\},\\{3\\}$ 的稳定度为 $5$，因为 $5$ 号的权值是 $2,3$ 的较小值，在只修改 $2$ 号或者 $3$ 号的情况下，$5$ 号点的权值始终小于等于 $3$，所以根节点的权值始终为 $4$。\n- $\\{2,3\\}$ 的稳定度为 $3$，要让根节点的权值发生改变，必须让 $5$ 的权值大于 $4$，因此 $w_2 ,w_3$都必须要大于 $4$，所以稳定度为 $3$，一个可行的方案是把 $w_2 ,w_3$ 都设为 $5$。\n\n#### 数据规模与约定\n\n| 测试点 | $n$ | 其他约定 | 测试点 | $n$ | 其他约定 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\le10$ | $L=R=n$ | $6$ | $\\le2\\times 10^5$ | $R-L\\le50$ |\n| $2$ | $\\le50$ | $L=R=n$ | $7$ | $\\le2\\times 10^5$ | $R-L\\le50$ |\n| $3$ | $\\le50$ | $L=R=n$ | $8$ | $\\le2\\times 10^5$ | 无 |\n| $4$ | $\\le5\\times 10^3$ | $L=R=n$ | $9$ | $\\le2\\times 10^5$ | 无 |\n| $5$ | $\\le5\\times 10^3$ | $L=R=n$ | $10$ | $\\le2\\times 10^5$ | 无 |\n\n对于 $100\\%$ 的数据，保证 $n\\ge2$，$1\\le L \\le R \\le n$。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2019] Minimax Search.", "background": "", "description": "Jiutiao Keliansi is a girl who likes playing games. To improve her gaming skills, she wants to arm herself with theory. This problem is related to the famous Minimax search.\n\nKeliansi has a rooted tree with the root numbered $1$. Define the depth of the root as $1$, and the depth of any other node as its parent’s depth plus $1$. Given the values on the leaf nodes, Keliansi defines the value of each non-leaf node as follows:\n- For a non-leaf node at odd depth, its value is the maximum among the values of all its children.\n- For a non-leaf node at even depth, its value is the minimum among the values of all its children.\n\nAt the beginning, Keliansi sets the value of the leaf node numbered $i$ to be $i$, and computes the root’s value as $W$.\n\nNow, the evil Cedyks wants to change the root’s value by modifying the values of some leaf nodes. Cedyks has designed a quantum attacker. After it is activated, Cedyks will randomly gain control of a non-empty set of leaf nodes $S$, and can spend some energy to modify the values of the leaf nodes in $S$.\n\nHowever, modifying leaf node values costs energy. For a leaf node $i \\in S$, its initial value is $i$. Suppose Cedyks changes its value to $w_i$ ($w_i$ **can be any integer, including negative numbers**). Then the energy needed for this attack is $\\max_{i\\in S} |i − w_i|$.\n\nCedyks wants to save as much energy as possible, so he will always **complete the attack with the minimum energy**, i.e. under the minimum energy cost, make the root’s value change. Let $w(S)$ be the energy Cedyks will spend after gaining control of set $S$. In particular, for some sets $S$, no matter how the values of the leaf nodes in $S$ are changed, the root’s value will not change. In this case, $w(S)$ is defined as $n$. For convenience, we call $w(S)$ the stability of $S$.\n\nWhen there are $m$ leaf nodes, there are $2^m − 1$ different non-empty sets of leaf nodes. Before launching the attack, Cedyks wants to estimate the energy he may need. So he gives an interval $[L, R]$, and wants to know, for each $k \\in [L, R]$, how many sets $S$ satisfy $w(S) = k$.", "inputFormat": "The first line contains three integers $n, L, R(n ≥ 2,1 \\leq L \\leq R \\leq n)$.\n\nThe next $n - 1$ lines each contain two integers $u, v$, indicating an edge in the tree.", "outputFormat": "Output one line with $R-L+1$ integers. The $i$-th integer indicates how many sets $S$ have $w(S) = L+i-1$. The answer may be very large; output it modulo $998244353$.", "hint": "#### Explanation of Sample 1\n\nAt the beginning, under Keliansi’s setting (the value of leaf node $i$ is $i$), the root’s value is $4$.\n\nThere are $3$ leaf nodes $\\{2,3,4\\}$ in the tree, and there are $7$ non-empty sets of leaf nodes, among which:\n\n- $\\{4\\}, \\{2,4\\}, \\{3,4\\}, \\{2,3,4\\}$ have stability $1$. As long as you slightly modify the value of leaf node $4$, the root’s value will change.\n- $\\{2\\}, \\{3\\}$ have stability $5$, because the value at node $5$ is the smaller one between $2$ and $3$. If you only modify node $2$ or only modify node $3$, the value at node $5$ is always less than or equal to $3$, so the root’s value is always $4$.\n- $\\{2,3\\}$ has stability $3$. To make the root’s value change, the value at node $5$ must be greater than $4$, so both $w_2$ and $w_3$ must be greater than $4$. Therefore the stability is $3$. One feasible plan is to set both $w_2$ and $w_3$ to $5$.\n\n#### Constraints\n\n| Test Point | $n$ | Other Constraints | Test Point | $n$ | Other Constraints |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\le10$ | $L=R=n$ | $6$ | $\\le2\\times 10^5$ | $R-L\\le50$ |\n| $2$ | $\\le50$ | $L=R=n$ | $7$ | $\\le2\\times 10^5$ | $R-L\\le50$ |\n| $3$ | $\\le50$ | $L=R=n$ | $8$ | $\\le2\\times 10^5$ | None |\n| $4$ | $\\le5\\times 10^3$ | $L=R=n$ | $9$ | $\\le2\\times 10^5$ | None |\n| $5$ | $\\le5\\times 10^3$ | $L=R=n$ | $10$ | $\\le2\\times 10^5$ | None |\n\nFor all testdata, it is guaranteed that $n\\ge2$, $1\\le L \\le R \\le n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2019] Minimax搜索", "background": "", "description": "九条可怜是一个喜欢玩游戏的女孩子。为了增强自己的游戏水平，她想要用理论的武器武装自己。这道题和著名的 Minimax 搜索有关。\n\n可怜有一棵有根树，根节点编号为 $1$。定义根节点的深度为 $1$，其他节点的深度为它的父亲的深度加一。同时在叶子节点权值给定的情况下，可怜用如下方式定义了每一个非节点的权值：\n- 对于深度为奇数的非叶子节点，它的权值是它所有子节点的权值最大值。\n- 对于深度为偶数的非叶子节点，它的权值是它所有子节点的权值最小值。\n\n最开始，可怜令编号为 $i$ 的叶子节点权值为 i，并计算得到了根节点的权值为 $W$。\n\n现在，邪恶的 Cedyks 想要通过修改某些叶子节点的权值，来让根节点的权值发生改变。Cedyks 设计了一个量子攻击器，在攻击器发动后，Cedyks 会随机获得一个非空的叶子节点集合 $S$ 的控制权，并可以花费一定的能量来修改 $S$ 中的叶子节点的权值。\n\n然而，修改叶子节点的权值也要消耗能量，对于 $S$ 中的叶子节点 $i$，它的初始权值为 $i$，假设 Cedyks 把它的权值修改成了 $w_i$（$w_i$ **可以是任意整数，包括负数**），则 Cedyks 在这次攻击中，需要花费的能量为 $\\max_{i\\in S} |i − w_i|$。\n\nCedyks 想要尽可能节约能量，于是他总是会**以最少的能量来完成攻击**，即在花费的能量最小的情况下，让根节点的权值发生改变。令 $w(S)$ 为 Cedyks 在获得了集合 $S$ 的控制权后，会花费的能量。特殊地，对于某些集合 $S$，可能无论如何改变 $S$ 中叶子节点的权值，根节点的权值都不会发生改变，这时，$w(S)$ 的值被定义为 $n$。为了方便，我们称 $w(S)$ 为 $S$ 的稳定度。\n\n当有 $m$ 个叶子节点的时候，一共有 $2^m − 1$ 种不同的叶子节点的非空集合。在发动攻击前，Cedyks 想要先预估一下自己需要花费的能量。于是他给出了一个区间 $[L, R]$，他想要知道对于每一个 $k \\in [L, R]$，有多少个集合 $S$ 满足 $w(S) = k$。", "inputFormat": "第一行输入三个整数 $n,L,R(n ≥ 2,1 \\leq L \\leq R \\leq n)$。\n\n接下来 $n - 1$ 行每行两个整数 $u,v$，表示树上的一条边。", "outputFormat": "输出一行 $R-L+1$ 个整数，第 $i$ 个整数表示 $w(S)$ 为 $L+i-1$ 的集合 $S$ 有多少个。答案可能会很大，请对 $998244353$ 取模后输出。", "hint": "#### 样例 1 解释\n\n最开始，在可怜的设定下（$i$ 号叶子节点的权值为 $i$），根节点的权值为 $4$。\n\n树上一共有 $3$ 个叶子节点 $\\{2,3,4\\}$，一共有 $7$ 个非空的叶子节点权值，其中：\n\n- $\\{4\\}, \\{2,4\\}, \\{3,4\\}, \\{2,3,4\\}$ 的稳定度为 $1$，只要稍微修改 $4$ 号叶子节点的权值，根节点的权值就会发生改变。\n- $\\{2\\},\\{3\\}$ 的稳定度为 $5$，因为 $5$ 号的权值是 $2,3$ 的较小值，在只修改 $2$ 号或者 $3$ 号的情况下，$5$ 号点的权值始终小于等于 $3$，所以根节点的权值始终为 $4$。\n- $\\{2,3\\}$ 的稳定度为 $3$，要让根节点的权值发生改变，必须让 $5$ 的权值大于 $4$，因此 $w_2 ,w_3$都必须要大于 $4$，所以稳定度为 $3$，一个可行的方案是把 $w_2 ,w_3$ 都设为 $5$。\n\n#### 数据规模与约定\n\n| 测试点 | $n$ | 其他约定 | 测试点 | $n$ | 其他约定 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $\\le10$ | $L=R=n$ | $6$ | $\\le2\\times 10^5$ | $R-L\\le50$ |\n| $2$ | $\\le50$ | $L=R=n$ | $7$ | $\\le2\\times 10^5$ | $R-L\\le50$ |\n| $3$ | $\\le50$ | $L=R=n$ | $8$ | $\\le2\\times 10^5$ | 无 |\n| $4$ | $\\le5\\times 10^3$ | $L=R=n$ | $9$ | $\\le2\\times 10^5$ | 无 |\n| $5$ | $\\le5\\times 10^3$ | $L=R=n$ | $10$ | $\\le2\\times 10^5$ | 无 |\n\n对于 $100\\%$ 的数据，保证 $n\\ge2$，$1\\le L \\le R \\le n$。", "locale": "zh-CN"}}}
{"pid": "P5282", "type": "P", "difficulty": 7, "samples": [["4\n16777216 998244353\n72267859 998244353\n2333333 19260817\n1919810 2147481811", "789885751\n569626621\n16351109\n1416439247"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "倍增", "O2优化", "快速傅里叶变换 FFT", "快速数论变换 NTT", "模板题"], "title": "【模板】快速阶乘算法", "background": "有一天，NaCly_Fish 无意间看到一种高效求阶乘模大质数的算法，但是她太菜，并不会写。  \n于是她就暴力造了数据，请您帮忙写出 std 吧。  \n\n什么，您问为什么不保证模数可以 NTT？  \n那样的话就可能被打表水过，或者答案就爆 int 了。\n\n反正您是神仙，肯定能秒掉这题。", "description": "给你正整数 $n$，和一个质数 $p$，你需要求出：  \n$$ n! \\text{ mod } p$$  \n有 $T$ 组数据。", "inputFormat": "第一行一个正整数 $T$，表示数据组数。  \n接下来 $T$  行，每行两个正整数 $n,p$，意义如题目描述。", "outputFormat": "输出 $T$ 行，表示每组数据的答案。", "hint": "### 数据范围：  \n\n对于 $10\\%$ 的数据：$p = 998244353$   \n对于另外 $10\\%$ 的数据：$p = 1004535809$   \n对于 $100\\%$ 的数据：$1\\le n < p \\le 2^{31}-1$，$1 \\le T \\le 5$    \n保证 $p$ 为质数。\n\n【提示】   \n请确保你的算法时间复杂度不高于 $\\Theta(\\sqrt n \\log n)$，时限为 std 的十倍以上。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Fast Factorial Algorithm.", "background": "One day, NaCly_Fish happened to see an efficient algorithm for computing factorial modulo a large prime, but she was too inexperienced to code it.  \nSo she generated testdata by brute force, and asks you to help write the std.\n\nWhat, you ask why it is not guaranteed that the modulus can be used for NTT?  \nIf it were, people might pass by precomputing a table, or the answer might overflow int.\n\nAnyway, you are a genius, so you can surely solve this problem instantly.", "description": "You are given a positive integer $n$ and a prime $p$. You need to compute:  \n$$ n! \\text{ mod } p$$  \nThere are $T$ test cases.", "inputFormat": "The first line contains a positive integer $T$, the number of test cases.  \nThe next $T$ lines each contain two positive integers $n, p$, with the meaning described above.", "outputFormat": "Output $T$ lines, each being the answer for one test case.", "hint": "### Constraints:\n\nFor $10\\%$ of the testdata: $p = 998244353$.  \nFor another $10\\%$ of the testdata: $p = 1004535809$.  \nFor $100\\%$ of the testdata: $1 \\le n < p \\le 2^{31}-1$, $1 \\le T \\le 5$.  \nIt is guaranteed that $p$ is prime.\n\n[Hint]  \nPlease make sure your algorithm runs in no more than $\\Theta(\\sqrt n \\log n)$ time complexity. The time limit is more than ten times that of the std.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】快速阶乘算法", "background": "有一天，NaCly_Fish 无意间看到一种高效求阶乘模大质数的算法，但是她太菜，并不会写。  \n于是她就暴力造了数据，请您帮忙写出 std 吧。  \n\n什么，您问为什么不保证模数可以 NTT？  \n那样的话就可能被打表水过，或者答案就爆 int 了。\n\n反正您是神仙，肯定能秒掉这题。", "description": "给你正整数 $n$，和一个质数 $p$，你需要求出：  \n$$ n! \\text{ mod } p$$  \n有 $T$ 组数据。", "inputFormat": "第一行一个正整数 $T$，表示数据组数。  \n接下来 $T$  行，每行两个正整数 $n,p$，意义如题目描述。", "outputFormat": "输出 $T$ 行，表示每组数据的答案。", "hint": "### 数据范围：  \n\n对于 $10\\%$ 的数据：$p = 998244353$   \n对于另外 $10\\%$ 的数据：$p = 1004535809$   \n对于 $100\\%$ 的数据：$1\\le n < p \\le 2^{31}-1$，$1 \\le T \\le 5$    \n保证 $p$ 为质数。\n\n【提示】   \n请确保你的算法时间复杂度不高于 $\\Theta(\\sqrt n \\log n)$，时限为 std 的十倍以上。", "locale": "zh-CN"}}}
{"pid": "P5283", "type": "P", "difficulty": 6, "samples": [["3 2\n1 2 3", "6"]], "limits": {"time": [3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2019", "各省省选", "堆", "可持久化", "前缀和", "字典树 Trie"], "title": "[十二省联考 2019] 异或粽子", "background": null, "description": "小粽是一个喜欢吃粽子的好孩子。今天她在家里自己做起了粽子。\n\n小粽面前有 $n$ 种互不相同的粽子馅儿，小粽将它们摆放为了一排，并从左至右编号为 $1$ 到 $n$。第 $i$ 种馅儿具有一个非负整数的属性值 $a_i$。每种馅儿的数量都足够多，即小粽不会因为缺少原料而做不出想要的粽子。小粽准备用这些馅儿来做出 $k$ 个粽子。\n\n小粽的做法是：选两个整数数 $l$,  $r$，满足 $1 \\leqslant l \\leqslant r \\leqslant n$，将编号在 $[l, r]$ 范围内的所有馅儿混合做成一个粽子，所得的粽子的美味度为这些粽子馅儿的属性值的**异或和**。（异或就是我们常说的 xor 运算，即 C/C++ 中的 `ˆ` 运算符或 Pascal 中的 `xor` 运算符）\n\n小粽想品尝不同口味的粽子，因此她不希望用同样的馅儿的集合做出一个以上的粽子。\n\n小粽希望她做出的所有粽子的美味度之和最大。请你帮她求出这个值吧！", "inputFormat": "第一行两个正整数 $n$, $k$，表示馅儿的数量，以及小粽打算做出的粽子的数量。\n\n接下来一行为 $n$ 个非负整数，第 $i$ 个数为 $a_i$，表示第 $i$ 个粽子的属性值。\n对于所有的输入数据都满足：$1 \\leqslant n \\leqslant 5 \\times 10^5$,  $1 \\leqslant k \\leqslant \\min\\left\\{\\frac{n(n-1)}{2},2 \\times 10^{5}\\right\\}$,  $0 \\leqslant a_i \\leqslant 4 294 967 295$。", "outputFormat": "输出一行一个整数，表示小粽可以做出的粽子的美味度之和的最大值。", "hint": "| 测试点 | $n$ | $k$ |\n| :---------- | :---------- | :---------- |\n| $1$, $2$, $3$, $4$, $5$, $6$, $7$, $8$ | $\\leqslant 10^3$ | $\\leqslant 10^3$ |\n| $9$, $10$, $11$, $12$ | $\\leqslant 5 \\times 10^5$ | $\\leqslant 10^3$ |\n| $13$, $14$, $15$, $16$ | $\\leqslant 10^3$ | $\\leqslant 2 \\times 10^5$ |\n| $17$, $18$, $19$, $20$ | $\\leqslant 5 \\times 10^5$ | $\\leqslant 2 \\times 10^5$ |", "locale": "zh-CN", "translations": {"en": {"title": "[12 Provinces Joint Contest 2019] XOR Zongzi.", "background": "", "description": "Xiao Zong is a good kid who likes eating zongzi. Today, she started making zongzi at home by herself.\n\nThere are $n$ different kinds of zongzi fillings in front of her. She places them in a row and numbers them from left to right as $1$ to $n$. The $i$-th kind of filling has a non-negative integer attribute value $a_i$. Each kind of filling is available in unlimited quantity, so Xiao Zong will not be unable to make zongzi due to lack of ingredients. She plans to use these fillings to make $k$ zongzi.\n\nHer method is: choose two integers $l$ and $r$ such that $1 \\leqslant l \\leqslant r \\leqslant n$, mix all fillings with indices in the range $[l, r]$ to make one zongzi. The tastiness of the resulting zongzi is the **xor sum** of the attribute values of these fillings. (Xor is the operation we usually call xor, i.e. the `ˆ` operator in C/C++ or the `xor` operator in Pascal.)\n\nXiao Zong wants to taste different flavors, so she does not want to make more than one zongzi using the same set of fillings.\n\nShe wants the sum of tastiness of all the zongzi she makes to be as large as possible. Please help her compute this value.", "inputFormat": "The first line contains two positive integers $n$ and $k$, representing the number of fillings and the number of zongzi Xiao Zong plans to make.\n\nThe next line contains $n$ non-negative integers. The $i$-th number is $a_i$, representing the attribute value of the $i$-th filling.\n\nFor all input data: $1 \\leqslant n \\leqslant 5 \\times 10^5$, $1 \\leqslant k \\leqslant \\min\\left\\{\\frac{n(n-1)}{2},2 \\times 10^{5}\\right\\}$, $0 \\leqslant a_i \\leqslant 4 294 967 295$.", "outputFormat": "Output one integer on a single line, representing the maximum possible sum of tastiness of the zongzi Xiao Zong can make.", "hint": "| Test Point | $n$ | $k$ |\n| :---------- | :---------- | :---------- |\n| $1$, $2$, $3$, $4$, $5$, $6$, $7$, $8$ | $\\leqslant 10^3$ | $\\leqslant 10^3$ |\n| $9$, $10$, $11$, $12$ | $\\leqslant 5 \\times 10^5$ | $\\leqslant 10^3$ |\n| $13$, $14$, $15$, $16$ | $\\leqslant 10^3$ | $\\leqslant 2 \\times 10^5$ |\n| $17$, $18$, $19$, $20$ | $\\leqslant 5 \\times 10^5$ | $\\leqslant 2 \\times 10^5$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[十二省联考 2019] 异或粽子", "background": null, "description": "小粽是一个喜欢吃粽子的好孩子。今天她在家里自己做起了粽子。\n\n小粽面前有 $n$ 种互不相同的粽子馅儿，小粽将它们摆放为了一排，并从左至右编号为 $1$ 到 $n$。第 $i$ 种馅儿具有一个非负整数的属性值 $a_i$。每种馅儿的数量都足够多，即小粽不会因为缺少原料而做不出想要的粽子。小粽准备用这些馅儿来做出 $k$ 个粽子。\n\n小粽的做法是：选两个整数数 $l$,  $r$，满足 $1 \\leqslant l \\leqslant r \\leqslant n$，将编号在 $[l, r]$ 范围内的所有馅儿混合做成一个粽子，所得的粽子的美味度为这些粽子馅儿的属性值的**异或和**。（异或就是我们常说的 xor 运算，即 C/C++ 中的 `ˆ` 运算符或 Pascal 中的 `xor` 运算符）\n\n小粽想品尝不同口味的粽子，因此她不希望用同样的馅儿的集合做出一个以上的粽子。\n\n小粽希望她做出的所有粽子的美味度之和最大。请你帮她求出这个值吧！", "inputFormat": "第一行两个正整数 $n$, $k$，表示馅儿的数量，以及小粽打算做出的粽子的数量。\n\n接下来一行为 $n$ 个非负整数，第 $i$ 个数为 $a_i$，表示第 $i$ 个粽子的属性值。\n对于所有的输入数据都满足：$1 \\leqslant n \\leqslant 5 \\times 10^5$,  $1 \\leqslant k \\leqslant \\min\\left\\{\\frac{n(n-1)}{2},2 \\times 10^{5}\\right\\}$,  $0 \\leqslant a_i \\leqslant 4 294 967 295$。", "outputFormat": "输出一行一个整数，表示小粽可以做出的粽子的美味度之和的最大值。", "hint": "| 测试点 | $n$ | $k$ |\n| :---------- | :---------- | :---------- |\n| $1$, $2$, $3$, $4$, $5$, $6$, $7$, $8$ | $\\leqslant 10^3$ | $\\leqslant 10^3$ |\n| $9$, $10$, $11$, $12$ | $\\leqslant 5 \\times 10^5$ | $\\leqslant 10^3$ |\n| $13$, $14$, $15$, $16$ | $\\leqslant 10^3$ | $\\leqslant 2 \\times 10^5$ |\n| $17$, $18$, $19$, $20$ | $\\leqslant 5 \\times 10^5$ | $\\leqslant 2 \\times 10^5$ |", "locale": "zh-CN"}}}
{"pid": "P5284", "type": "P", "difficulty": 7, "samples": [["3\nabaaaba\n2\n4 7\n1 3\n1\n3 4\n1\n2 1\nabaaaba\n2\n4 7\n1 3\n1\n7 7\n1\n2 1\nabbaabbaab\n4\n1 5\n4 7\n6 9\n8 10\n3\n1 6\n10 10\n4 6\n5\n1 2\n1 3\n2 1\n3 3\n4 1", "7\n-1\n13"]], "limits": {"time": [10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000]}, "tags": ["2019", "各省省选", "O2优化"], "title": "[十二省联考 2019] 字符串问题", "background": "Yazid 和 Tiffany 喜欢字符串问题。在这里，我们将给你介绍一些关于字符串的基本概念。\n\n对于一个字符串 $S$ ，我们定义 $|S|$ 表示 $S$ 的长度。\n\n接着，我们定义该串的子串 $S(L, R)$ 表示由 $S$ 中从左往右数，第 $L$ 个字符到第 $R$ 个字符依次连接形成的字符串，特别地，如果 $L < 1$ 或 $R > |S|$ 或 $L > R$，则 $S(L, R)$ 表示空串。\n\n我们说两个字符串相等，当且仅当它们的长度相等，且从左至右各位上的字符依次\n相同。\n\n我们说一个字符串 $T$ 是 $S$ 的前缀，当且仅当 $S(1, |T|) = T$。\n\n两个字符串 $S$, $T$ 相加 $S + T$ 表示的是在 $S$ 后紧挨着写下 $T$ 得到的长度为 $|S| + |T|$ 的字符串。", "description": "现有一个字符串 $S$。\n\nTiffany 将从中划出 $n_a$ 个子串作为 $A$ 类串，第 $i$ 个（$1 \\leqslant i \\leqslant n_a$）为 $A_i = S(la_i, ra_i)$。\n\n类似地，Yazid 将划出 $n_b$ 个子串作为 $B$ 类串，第 $i$ 个（$1 \\leqslant i \\leqslant n_b$）为 $B_i = S(lb_i, rb_i)$。\n\n现额外给定 $m$ 组支配关系，每组支配关系 $(x, y)$ 描述了第 $x$ 个 $A$ 类串**支配** 第 $y$ 个 $B$ 类串。\n\n求一个**长度最大**的目标串 $T$，使得存在一个串 $T$ 的分割 $T = t_1+t_2+· · ·+t_k$（$k \\geqslant 0$）满足：\n- 分割中的每个串 $t_i$ 均为 $A$ 类串：即存在一个与其相等的 $A$ 类串，不妨假设其为 $t_i = A_{id_i}$。\n- 对于分割中所有相邻的串 $t_i, t_{i+1}$（$1 \\leqslant i < k$），都有存在一个$A_{id_i}$ 支配的 $B$ 类串，使得该 $B$ 类串为 $t_{i+1}$ 的前缀。\n\n方便起见，你只需要输出这个最大的长度即可。\n\n特别地，如果存在无限长的目标串（即对于任意一个正整数 $n$，都存在一个满足限制的长度超过 $n$ 的串），请输出 $-1$。", "inputFormat": "单个测试点中包含多组数据，输入的第一行包含一个非负整数 $T$ 表示数据组数。接下来依次描述每组数据，对于每组数据：\n- 第 $1$ 行一个只包含小写字母的字符串 $S$。\n- 第 $2$ 行一个非负整数 $n_a$，表示 $A$ 类串的数目。接下来 $n_a$ 行，每行 $2$ 个用空格隔开的整数。\n  - 这部分中第 $i$ 行的两个数分别为 $la_i$, $ra_i$，描述第 $i$ 个 $A$ 类串。\n  - 保证 $1 \\leqslant la_i \\leqslant ra_i \\leqslant |S|$。\n- 接下来一行一个非负整数 $n_b$，表示 $B$ 类串的数目。接下来 $n_b$ 行，每行 $2$ 个用空格隔开的整数。\n  - 这部分中第 $i$ 行的两个数分别为 $lb_i$, $rb_i$，描述第 $i$ 个 $B$ 类串。\n  - 保证 $1 \\leqslant lb_i \\leqslant rb_i \\leqslant |S|$。\n- 接下来一行一个非负整数 $m$，表示支配关系的组数。接下来 $m$ 行，每行 $2$ 个用空格隔开的整数。\n  - 这部分中每行的两个整数 $x$,  $y$，描述一对 $(x, y)$ 的支配关系，具体意义见\n【题目描述】。\n  - 保证 $1 \\leqslant x \\leqslant n_a$，$1 \\leqslant y \\leqslant n_b$。保证所有支配关系两两不同，即不存在两组支配关系的 $x, $y **均**相同。", "outputFormat": "依次输出每组数据的答案，对于每组数据：\n- 一行一个整数表示最大串长。特别地，如果满足限制的串可以是无限长的，则请\n输出 $-1$。", "hint": "#### 样例一解释\n对于第 $1$ 组数据，$A$ 类串有 $\\texttt{aaba}$ 与 $\\texttt{aba}$，$B$ 类串有 $\\texttt{aa}$，且 $A_2$ 支配 $B_1$。我们可以找到串 $\\texttt{abaaaba}$，它可以拆分成 $A_2 + A_1$，且 $A_1$ 包含由 $A_2$ 所支配的 $B_1$ 作为前缀。可以证明不存在长度更大的满足限制的串。\n\n对于第 $2$ 组数据，与第 $1$ 组数据唯一不同的是，唯一的 $B$ 类串为 $\\texttt{a}$。容易证明存在无限长的满足限制的串。\n\n对于第 $3$ 组数据，容易证明 $\\texttt{abbaabbaaaabb}$ 是最长的满足限制的串。\n\n#### 子任务\n|$n_a$|$n_b$|$\\lvert S\\rvert$|测试点|$m$|$\\lvert A_i\\rvert \\geq \\lvert B_j\\rvert$|其他限制|\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|$\\leq 100$|$\\leq 100$|$\\leq 10^4$|$1$|$\\leq 10^4$|保证|保证所有 $\\lvert A_i\\rvert,\\lvert B_j\\rvert\\leq 100$|\n|$\\leq 1000$|$\\leq 1000$|$\\leq 2\\times 10^5$|$2\\sim 3$|$\\leq 2\\times 10^5$|保证|无|\n|$=1$|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$4$|$=n_b$|保证|无|\n|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$5\\sim 6$|$\\leq 2\\times 10^5$|保证|保证所有 $ra_i +1=la_{i+1}$|\n|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$7\\sim 8$|$\\leq 2\\times 10^5$|保证|无|\n|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$9\\sim 10$|$\\leq 2\\times 10^5$|不保证|无|\n\n为了方便你的阅读，我们把**测试点编号**放在了表格的中间，请你注意这一点。\n\n表格中的 $|A_i| > |B_j|$ 指的是**任意** $B$ 类串的长度不超过**任意** $A$ 类串的长度。\n\n对于所有测试点，保证：$T \\leqslant 100$，且对于测试点内所有数据，$|S|$, $n_a$, $n_b$, $m$ 的**总和**分别不会超过**该测试点中对应**的**单组数据的限制**的 $10$ 倍。比如，对于第 $1$ 组测试点，就有 $\\sum n_a \\leqslant 10 \\times 100 = 1000$ 等。特别地，我们规定对于测试点 $4$，有 $T \\leqslant 10$。\n\n对于所有测试点中的每一组数据，保证：$1 \\leqslant |S| \\leqslant 2 \\times 10^5$，$n_a$, $n_b \\leqslant 2 \\times 10^5$，$m \\leqslant 2 \\times 10^5$\n\n#### 提示\n十二省联考命题组温馨提醒您：\n\n**数据千万条，清空第一条。**\n\n**多测不清空，爆零两行泪。**", "locale": "zh-CN", "translations": {"en": {"title": "[12 Provinces Joint Exam 2019] String Problem", "background": "Yazid and Tiffany like string problems. Here, we will introduce some basic concepts about strings.\n\nFor a string $S$, we define $|S|$ as the length of $S$.\n\nNext, we define the substring $S(L, R)$ as the string formed by concatenating, in order from left to right, the $L$-th character through the $R$-th character of $S$. In particular, if $L < 1$ or $R > |S|$ or $L > R$, then $S(L, R)$ denotes the empty string.\n\nWe say two strings are equal if and only if they have the same length, and their characters are identical at every position from left to right.\n\nWe say a string $T$ is a prefix of $S$ if and only if $S(1, |T|) = T$.\n\nFor two strings $S$ and $T$, their concatenation $S + T$ means writing $T$ immediately after $S$, producing a string of length $|S| + |T|$.", "description": "You are given a string $S$.\n\nTiffany will select $n_a$ substrings as type $A$ strings. The $i$-th one ($1 \\leqslant i \\leqslant n_a$) is $A_i = S(la_i, ra_i)$.\n\nSimilarly, Yazid will select $n_b$ substrings as type $B$ strings. The $i$-th one ($1 \\leqslant i \\leqslant n_b$) is $B_i = S(lb_i, rb_i)$.\n\nAdditionally, you are given $m$ dominance relations. Each relation $(x, y)$ states that the $x$-th type $A$ string **dominates** the $y$-th type $B$ string.\n\nFind a target string $T$ with the **maximum possible length**, such that there exists a partition of $T$ as $T = t_1+t_2+· · ·+t_k$ ($k \\geqslant 0$) satisfying:\n- Every string $t_i$ in the partition is a type $A$ string: that is, there exists a type $A$ string equal to it. WLOG, assume $t_i = A_{id_i}$.\n- For every pair of adjacent strings $t_i, t_{i+1}$ ($1 \\leqslant i < k$), there exists a type $B$ string dominated by $A_{id_i}$, such that this type $B$ string is a prefix of $t_{i+1}$.\n\nFor convenience, you only need to output this maximum length.\n\nIn particular, if there exists an infinitely long target string (that is, for any positive integer $n$, there exists a string satisfying the constraints whose length is greater than $n$), output $-1$.", "inputFormat": "Each test file contains multiple datasets. The first line contains a non-negative integer $T$ indicating the number of datasets. Then each dataset is described as follows:\n- Line $1$: a string $S$ consisting only of lowercase letters.\n- Line $2$: a non-negative integer $n_a$, the number of type $A$ strings. The next $n_a$ lines each contain two integers separated by a space.\n  - In this part, the two integers on line $i$ are $la_i$, $ra_i$, describing the $i$-th type $A$ string.\n  - It is guaranteed that $1 \\leqslant la_i \\leqslant ra_i \\leqslant |S|$.\n- Next line: a non-negative integer $n_b$, the number of type $B$ strings. The next $n_b$ lines each contain two integers separated by a space.\n  - In this part, the two integers on line $i$ are $lb_i$, $rb_i$, describing the $i$-th type $B$ string.\n  - It is guaranteed that $1 \\leqslant lb_i \\leqslant rb_i \\leqslant |S|$.\n- Next line: a non-negative integer $m$, the number of dominance relations. The next $m$ lines each contain two integers separated by a space.\n  - The two integers $x$, $y$ on each line describe a dominance relation $(x, y)$; see 【Description】 for details.\n  - It is guaranteed that $1 \\leqslant x \\leqslant n_a$, $1 \\leqslant y \\leqslant n_b$. All dominance relations are pairwise distinct, i.e., there do not exist two relations with both the same $x$ and the same $y$.", "outputFormat": "Output the answer for each dataset in order. For each dataset:\n- Output one integer per line, the maximum length of such a string. In particular, if a string satisfying the constraints can be infinitely long, output $-1$.", "hint": "#### Explanation of Sample 1\nFor dataset $1$, the type $A$ strings are $\\texttt{aaba}$ and $\\texttt{aba}$, the type $B$ string is $\\texttt{aa}$, and $A_2$ dominates $B_1$. We can find the string $\\texttt{abaaaba}$, which can be split into $A_2 + A_1$, and $A_1$ has $B_1$ (dominated by $A_2$) as a prefix. It can be proven that no longer string satisfying the constraints exists.\n\nFor dataset $2$, the only difference from dataset $1$ is that the only type $B$ string is $\\texttt{a}$. It is easy to prove that an infinitely long string satisfying the constraints exists.\n\nFor dataset $3$, it is easy to prove that $\\texttt{abbaabbaaaabb}$ is the longest string satisfying the constraints.\n\n#### Subtasks\n|$n_a$|$n_b$|$\\lvert S\\rvert$|Test Point|$m$|$\\lvert A_i\\rvert \\geq \\lvert B_j\\rvert$|Other Constraints|\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|$\\leq 100$|$\\leq 100$|$\\leq 10^4$|$1$|$\\leq 10^4$|Guaranteed|Guaranteed that all $\\lvert A_i\\rvert,\\lvert B_j\\rvert\\leq 100$|\n|$\\leq 1000$|$\\leq 1000$|$\\leq 2\\times 10^5$|$2\\sim 3$|$\\leq 2\\times 10^5$|Guaranteed|None|\n|$=1$|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$4$|$=n_b$|Guaranteed|None|\n|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$5\\sim 6$|$\\leq 2\\times 10^5$|Guaranteed|Guaranteed that all $ra_i +1=la_{i+1}$|\n|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$7\\sim 8$|$\\leq 2\\times 10^5$|Guaranteed|None|\n|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$9\\sim 10$|$\\leq 2\\times 10^5$|Not guaranteed|None|\n\nFor easier reading, the **test point numbers** are placed in the middle of the table. Please pay attention to this.\n\nIn the table, $|A_i| > |B_j|$ means that the length of **any** type $B$ string does not exceed the length of **any** type $A$ string.\n\nFor all test points, it is guaranteed that $T \\leqslant 100$, and within each test point, across all datasets, the **totals** of $|S|$, $n_a$, $n_b$, and $m$ will each not exceed $10$ times the per-dataset limit for that test point. For example, for test point $1$, we have $\\sum n_a \\leqslant 10 \\times 100 = 1000$, etc. In particular, for test point $4$, we require $T \\leqslant 10$.\n\nFor every dataset in all test points, it is guaranteed that: $1 \\leqslant |S| \\leqslant 2 \\times 10^5$, $n_a, n_b \\leqslant 2 \\times 10^5$, $m \\leqslant 2 \\times 10^5$.\n\n#### Hint\nA friendly reminder from the 12 Provinces Joint Exam problem setters:\n\n**There are thousands of testdata, clear the first one.**\n\n**If you do not clear between multiple tests, you will get zero points and shed two lines of tears.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[十二省联考 2019] 字符串问题", "background": "Yazid 和 Tiffany 喜欢字符串问题。在这里，我们将给你介绍一些关于字符串的基本概念。\n\n对于一个字符串 $S$ ，我们定义 $|S|$ 表示 $S$ 的长度。\n\n接着，我们定义该串的子串 $S(L, R)$ 表示由 $S$ 中从左往右数，第 $L$ 个字符到第 $R$ 个字符依次连接形成的字符串，特别地，如果 $L < 1$ 或 $R > |S|$ 或 $L > R$，则 $S(L, R)$ 表示空串。\n\n我们说两个字符串相等，当且仅当它们的长度相等，且从左至右各位上的字符依次\n相同。\n\n我们说一个字符串 $T$ 是 $S$ 的前缀，当且仅当 $S(1, |T|) = T$。\n\n两个字符串 $S$, $T$ 相加 $S + T$ 表示的是在 $S$ 后紧挨着写下 $T$ 得到的长度为 $|S| + |T|$ 的字符串。", "description": "现有一个字符串 $S$。\n\nTiffany 将从中划出 $n_a$ 个子串作为 $A$ 类串，第 $i$ 个（$1 \\leqslant i \\leqslant n_a$）为 $A_i = S(la_i, ra_i)$。\n\n类似地，Yazid 将划出 $n_b$ 个子串作为 $B$ 类串，第 $i$ 个（$1 \\leqslant i \\leqslant n_b$）为 $B_i = S(lb_i, rb_i)$。\n\n现额外给定 $m$ 组支配关系，每组支配关系 $(x, y)$ 描述了第 $x$ 个 $A$ 类串**支配** 第 $y$ 个 $B$ 类串。\n\n求一个**长度最大**的目标串 $T$，使得存在一个串 $T$ 的分割 $T = t_1+t_2+· · ·+t_k$（$k \\geqslant 0$）满足：\n- 分割中的每个串 $t_i$ 均为 $A$ 类串：即存在一个与其相等的 $A$ 类串，不妨假设其为 $t_i = A_{id_i}$。\n- 对于分割中所有相邻的串 $t_i, t_{i+1}$（$1 \\leqslant i < k$），都有存在一个$A_{id_i}$ 支配的 $B$ 类串，使得该 $B$ 类串为 $t_{i+1}$ 的前缀。\n\n方便起见，你只需要输出这个最大的长度即可。\n\n特别地，如果存在无限长的目标串（即对于任意一个正整数 $n$，都存在一个满足限制的长度超过 $n$ 的串），请输出 $-1$。", "inputFormat": "单个测试点中包含多组数据，输入的第一行包含一个非负整数 $T$ 表示数据组数。接下来依次描述每组数据，对于每组数据：\n- 第 $1$ 行一个只包含小写字母的字符串 $S$。\n- 第 $2$ 行一个非负整数 $n_a$，表示 $A$ 类串的数目。接下来 $n_a$ 行，每行 $2$ 个用空格隔开的整数。\n  - 这部分中第 $i$ 行的两个数分别为 $la_i$, $ra_i$，描述第 $i$ 个 $A$ 类串。\n  - 保证 $1 \\leqslant la_i \\leqslant ra_i \\leqslant |S|$。\n- 接下来一行一个非负整数 $n_b$，表示 $B$ 类串的数目。接下来 $n_b$ 行，每行 $2$ 个用空格隔开的整数。\n  - 这部分中第 $i$ 行的两个数分别为 $lb_i$, $rb_i$，描述第 $i$ 个 $B$ 类串。\n  - 保证 $1 \\leqslant lb_i \\leqslant rb_i \\leqslant |S|$。\n- 接下来一行一个非负整数 $m$，表示支配关系的组数。接下来 $m$ 行，每行 $2$ 个用空格隔开的整数。\n  - 这部分中每行的两个整数 $x$,  $y$，描述一对 $(x, y)$ 的支配关系，具体意义见\n【题目描述】。\n  - 保证 $1 \\leqslant x \\leqslant n_a$，$1 \\leqslant y \\leqslant n_b$。保证所有支配关系两两不同，即不存在两组支配关系的 $x, $y **均**相同。", "outputFormat": "依次输出每组数据的答案，对于每组数据：\n- 一行一个整数表示最大串长。特别地，如果满足限制的串可以是无限长的，则请\n输出 $-1$。", "hint": "#### 样例一解释\n对于第 $1$ 组数据，$A$ 类串有 $\\texttt{aaba}$ 与 $\\texttt{aba}$，$B$ 类串有 $\\texttt{aa}$，且 $A_2$ 支配 $B_1$。我们可以找到串 $\\texttt{abaaaba}$，它可以拆分成 $A_2 + A_1$，且 $A_1$ 包含由 $A_2$ 所支配的 $B_1$ 作为前缀。可以证明不存在长度更大的满足限制的串。\n\n对于第 $2$ 组数据，与第 $1$ 组数据唯一不同的是，唯一的 $B$ 类串为 $\\texttt{a}$。容易证明存在无限长的满足限制的串。\n\n对于第 $3$ 组数据，容易证明 $\\texttt{abbaabbaaaabb}$ 是最长的满足限制的串。\n\n#### 子任务\n|$n_a$|$n_b$|$\\lvert S\\rvert$|测试点|$m$|$\\lvert A_i\\rvert \\geq \\lvert B_j\\rvert$|其他限制|\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|$\\leq 100$|$\\leq 100$|$\\leq 10^4$|$1$|$\\leq 10^4$|保证|保证所有 $\\lvert A_i\\rvert,\\lvert B_j\\rvert\\leq 100$|\n|$\\leq 1000$|$\\leq 1000$|$\\leq 2\\times 10^5$|$2\\sim 3$|$\\leq 2\\times 10^5$|保证|无|\n|$=1$|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$4$|$=n_b$|保证|无|\n|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$5\\sim 6$|$\\leq 2\\times 10^5$|保证|保证所有 $ra_i +1=la_{i+1}$|\n|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$7\\sim 8$|$\\leq 2\\times 10^5$|保证|无|\n|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$\\leq 2\\times 10^5$|$9\\sim 10$|$\\leq 2\\times 10^5$|不保证|无|\n\n为了方便你的阅读，我们把**测试点编号**放在了表格的中间，请你注意这一点。\n\n表格中的 $|A_i| > |B_j|$ 指的是**任意** $B$ 类串的长度不超过**任意** $A$ 类串的长度。\n\n对于所有测试点，保证：$T \\leqslant 100$，且对于测试点内所有数据，$|S|$, $n_a$, $n_b$, $m$ 的**总和**分别不会超过**该测试点中对应**的**单组数据的限制**的 $10$ 倍。比如，对于第 $1$ 组测试点，就有 $\\sum n_a \\leqslant 10 \\times 100 = 1000$ 等。特别地，我们规定对于测试点 $4$，有 $T \\leqslant 10$。\n\n对于所有测试点中的每一组数据，保证：$1 \\leqslant |S| \\leqslant 2 \\times 10^5$，$n_a$, $n_b \\leqslant 2 \\times 10^5$，$m \\leqslant 2 \\times 10^5$\n\n#### 提示\n十二省联考命题组温馨提醒您：\n\n**数据千万条，清空第一条。**\n\n**多测不清空，爆零两行泪。**", "locale": "zh-CN"}}}
{"pid": "P5285", "type": "P", "difficulty": 7, "samples": [], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "2019", "各省省选", "原根", "数论", "素数判断,质数,筛法"], "title": "[十二省联考 2019] 骗分过样例", "background": "这是一道**传统题**。\n\n“我的程序需要完成什么功能呀？. . . . . . ”\n\n“我也不知道. . . . . . ”\n\n“啊？那我怎么写呀. . . . . . ”\n\n“已经有人给你写好测试了，只要你通过这些测试就可以了. . . . . . ”\n\n“啊？. . . . . . ”\n\n“所有的测试数据都在题目目录下，请做好备份，避免误删！”\n\n“这. . . . . . ”\n\n“哦，我还可以把输入格式告诉你. . . . . . 不过都有完整的数据了，知道输入格式可能也没太大用处吧. . . . . . ”", "description": "题目数据详见附加文件", "inputFormat": "第一行输入一个字符串，表示需要运行的软件功能编号。两个编号越相似，说明对\n应的两个功能的算法越接近。\n\n接下来根据功能的不同，可能有任意长度的输入，详见每个功能的文档。", "outputFormat": "详见每个功能的文档。", "hint": "#### 子任务\n“‘每个功能的文档’在哪里呀？”\n\n“我也没有，就像我没有题目描述一样. . . . . . ”\n\n“好吧. . . . . . 那我是不是打表就可以了呀. . . . . . ”\n\n“**代码长度限制是 $\\bold{102400}$ 字节** （$100$KB），直接打肯定是不行的！不过，需要的话倒是可以稍微打一些小的表. . . . . . ”\n\n“唔. . . . . . ”\n\n“另外，我们会给你的程序对于每个测试点分别评分，求和后得到总分。按照传统\n的规矩，每个测试点正确得满分，错误得 $0$ 分。**每个测试点的分值不全相同，测试点的分值、顺序与难度没有必然联系** 。”\n\n| 测试点 | 功能编号 | 分值 |\n| :-------: | :-------: | :-------: |\n| $1$ | $\\texttt{1\\_998244353}$ | $4$ |\n| $2$ | $\\texttt{1\\_998244353}$ | $4$ |\n| $3$ | $\\texttt{1\\_998244353}$ | $4$ |\n| $4$ | $\\texttt{1?}$ | $7$ |\n| $5$ | $\\texttt{1?+}$ | $9$ |\n| $6$ | $\\texttt{1wa\\_998244353}$ | $6$ |\n| $7$ | $\\texttt{1wa\\_998244353}$ | $7$ |\n| $8$ | $\\texttt{2p}$ | $4$ |\n| $9$ | $\\texttt{2p}$ | $6$ |\n| $10$ | $\\texttt{2p}$ | $8$ |\n| $11$ | $\\texttt{2u}$ | $5$ |\n| $12$ | $\\texttt{2u}$ | $6$ |\n| $13$ | $\\texttt{2u}$ | $9$ |\n| $14$ | $\\texttt{2g}$ | $5$ |\n| $15$ | $\\texttt{2g}$ | $7$ |\n| $16$ | $\\texttt{2g?}$ | $9$ |\n\n\n#### 提示\n在你使用 C/C++ 的 `int` 类型时，如果发生了溢出，比较可能的情况是按照模 $2^{32}$ 同余的前提下，在 `int` 范围内取一个合理的值。例如在计算 $2147483647 + 2$ 时，较有可能会得到 $-2147483647$。\n\n然而，C/C++ 标准将这种情况归类为“未定义行为”。当你的程序试图计算会溢\n出的 `int` 运算时，除了上述结果外，编译器还可能会让你的程序在此时计算出错误结果、死循环、运行错误等，这也是符合 C/C++ 标准的。\n\n如果你的程序希望利用 `int` 的自然溢出的特性，请转换为 `unsigned` 类型运算。例如将 `a + b` 改写为 `(int) ((unsigned) a + (unsigned) b)`，以避免出现不预期的错误。\n", "locale": "zh-CN", "translations": {"en": {"title": "[Twelve Provinces Joint Exam 2019] Cheating to Pass the Samples", "background": "This is a **traditional problem**.\n\n“What function does my program need to implement?...”\n\n“I don’t know either...”\n\n“Huh? Then how am I supposed to write it?...”\n\n“Someone has already written the tests for you. As long as you pass these tests, you will be fine...”\n\n“Huh?...”\n\n“All the testdata are in the problem directory. Please make backups to avoid accidental deletion!”\n\n“This...”\n\n“Oh, I can also tell you the input format... but since the data are complete anyway, knowing the input format may not be very useful...”", "description": "The problem data are provided in the attached files.", "inputFormat": "The first line contains a string, indicating the function ID of the software feature that needs to be run. The more similar two IDs are, the closer the algorithms for the corresponding two functions are.\n\nThen, depending on the function, there may be input of any length. See the documentation for each function for details.", "outputFormat": "See the documentation for each function for details.", "hint": "#### Subtasks\n\n“Where is the ‘documentation for each function’?”\n\n“I don’t have it either, just like I don’t have a problem statement...”\n\n“Alright... then can I just hardcode a table?...”\n\n“**The code length limit is $\\bold{102400}$ bytes** ($100$KB). You definitely can’t hardcode everything! However, if needed, you may hardcode some small tables...”\n\n“Um...”\n\n“Also, we will score your program separately for each test point, and sum them up to get the total score. By tradition, each test point gives full marks if correct, and $0$ points if wrong. **The points of each test point are not all the same, and the points, order, and difficulty of test points have no necessary relationship**.”\n\n| Test Point | Function ID | Points |\n| :-------: | :-------: | :-------: |\n| $1$ | $\\texttt{1\\_998244353}$ | $4$ |\n| $2$ | $\\texttt{1\\_998244353}$ | $4$ |\n| $3$ | $\\texttt{1\\_998244353}$ | $4$ |\n| $4$ | $\\texttt{1?}$ | $7$ |\n| $5$ | $\\texttt{1?+}$ | $9$ |\n| $6$ | $\\texttt{1wa\\_998244353}$ | $6$ |\n| $7$ | $\\texttt{1wa\\_998244353}$ | $7$ |\n| $8$ | $\\texttt{2p}$ | $4$ |\n| $9$ | $\\texttt{2p}$ | $6$ |\n| $10$ | $\\texttt{2p}$ | $8$ |\n| $11$ | $\\texttt{2u}$ | $5$ |\n| $12$ | $\\texttt{2u}$ | $6$ |\n| $13$ | $\\texttt{2u}$ | $9$ |\n| $14$ | $\\texttt{2g}$ | $5$ |\n| $15$ | $\\texttt{2g}$ | $7$ |\n| $16$ | $\\texttt{2g?}$ | $9$ |\n\n#### Hint\n\nWhen you use the `int` type in C/C++, if an overflow occurs, a likely situation is that under the assumption of congruence modulo $2^{32}$, a reasonable value within the `int` range is taken. For example, when computing $2147483647 + 2$, it is quite likely to get $-2147483647$.\n\nHowever, the C/C++ standard classifies this situation as “undefined behavior”. When your program tries to evaluate an `int` operation that would overflow, besides the result above, the compiler may also make your program produce an incorrect result, enter an infinite loop, crash at runtime, etc. All of these are compliant with the C/C++ standard.\n\nIf your program wants to make use of the natural overflow behavior of `int`, please switch to `unsigned` operations. For example, rewrite `a + b` as `(int) ((unsigned) a + (unsigned) b)`, to avoid unexpected errors.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[十二省联考 2019] 骗分过样例", "background": "这是一道**传统题**。\n\n“我的程序需要完成什么功能呀？. . . . . . ”\n\n“我也不知道. . . . . . ”\n\n“啊？那我怎么写呀. . . . . . ”\n\n“已经有人给你写好测试了，只要你通过这些测试就可以了. . . . . . ”\n\n“啊？. . . . . . ”\n\n“所有的测试数据都在题目目录下，请做好备份，避免误删！”\n\n“这. . . . . . ”\n\n“哦，我还可以把输入格式告诉你. . . . . . 不过都有完整的数据了，知道输入格式可能也没太大用处吧. . . . . . ”", "description": "题目数据详见附加文件", "inputFormat": "第一行输入一个字符串，表示需要运行的软件功能编号。两个编号越相似，说明对\n应的两个功能的算法越接近。\n\n接下来根据功能的不同，可能有任意长度的输入，详见每个功能的文档。", "outputFormat": "详见每个功能的文档。", "hint": "#### 子任务\n“‘每个功能的文档’在哪里呀？”\n\n“我也没有，就像我没有题目描述一样. . . . . . ”\n\n“好吧. . . . . . 那我是不是打表就可以了呀. . . . . . ”\n\n“**代码长度限制是 $\\bold{102400}$ 字节** （$100$KB），直接打肯定是不行的！不过，需要的话倒是可以稍微打一些小的表. . . . . . ”\n\n“唔. . . . . . ”\n\n“另外，我们会给你的程序对于每个测试点分别评分，求和后得到总分。按照传统\n的规矩，每个测试点正确得满分，错误得 $0$ 分。**每个测试点的分值不全相同，测试点的分值、顺序与难度没有必然联系** 。”\n\n| 测试点 | 功能编号 | 分值 |\n| :-------: | :-------: | :-------: |\n| $1$ | $\\texttt{1\\_998244353}$ | $4$ |\n| $2$ | $\\texttt{1\\_998244353}$ | $4$ |\n| $3$ | $\\texttt{1\\_998244353}$ | $4$ |\n| $4$ | $\\texttt{1?}$ | $7$ |\n| $5$ | $\\texttt{1?+}$ | $9$ |\n| $6$ | $\\texttt{1wa\\_998244353}$ | $6$ |\n| $7$ | $\\texttt{1wa\\_998244353}$ | $7$ |\n| $8$ | $\\texttt{2p}$ | $4$ |\n| $9$ | $\\texttt{2p}$ | $6$ |\n| $10$ | $\\texttt{2p}$ | $8$ |\n| $11$ | $\\texttt{2u}$ | $5$ |\n| $12$ | $\\texttt{2u}$ | $6$ |\n| $13$ | $\\texttt{2u}$ | $9$ |\n| $14$ | $\\texttt{2g}$ | $5$ |\n| $15$ | $\\texttt{2g}$ | $7$ |\n| $16$ | $\\texttt{2g?}$ | $9$ |\n\n\n#### 提示\n在你使用 C/C++ 的 `int` 类型时，如果发生了溢出，比较可能的情况是按照模 $2^{32}$ 同余的前提下，在 `int` 范围内取一个合理的值。例如在计算 $2147483647 + 2$ 时，较有可能会得到 $-2147483647$。\n\n然而，C/C++ 标准将这种情况归类为“未定义行为”。当你的程序试图计算会溢\n出的 `int` 运算时，除了上述结果外，编译器还可能会让你的程序在此时计算出错误结果、死循环、运行错误等，这也是符合 C/C++ 标准的。\n\n如果你的程序希望利用 `int` 的自然溢出的特性，请转换为 `unsigned` 类型运算。例如将 `a + b` 改写为 `(int) ((unsigned) a + (unsigned) b)`，以避免出现不预期的错误。\n", "locale": "zh-CN"}}}
{"pid": "P5286", "type": "P", "difficulty": 7, "samples": [["8\n-2 0\n-1 0\n0 1\n0 -1\n1 0\n2 0\n3 1\n3 -1", "16"]], "limits": {"time": [3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "湖南"], "title": "[HNOI2019] 鱼", "background": "$\\text{\\color{white}本题数据听说没问题？}$", "description": "在平面坐标系上给定$n$个不同的整点（也即横坐标与纵坐标皆为整数的点）。我们称从这$n$个点中选择6个不同的点所组成的有序六元组$(A,B,C,D,E,F)$是一条“鱼”，当且仅当：$AB=AC,BD=CD,DE=DF$（身形要对称），并且$\\angle BAD,\\angle BDA$ 与$\\angle CAD,\\angle CDA$都是锐角（脑袋和屁股显然不能是凹的），$\\angle ADE,\\angle ADF$ 大于$90^\\circ$（也即为钝角或平角，为了使尾巴不至于翘那么别扭）。\n\n下图就是一个合法的鱼的例子：\n\n![](https://cdn.luogu.com.cn/upload/pic/56001.png)\n\n其中点的组成相同，但顺序不同的鱼视为不同的鱼，即$(A,B,C,D,E,F)$和$(A,C,B,D,E,F)$视为不同的两条鱼（毕竟鱼也有背和肚子的两面），同理$(A,B,C,D,E,F)$和$(A,B,C,D,F,E)$也可以视为不同的两条鱼（假设鱼尾巴可以打结）。\n\n问给定的$n$个点可以构成多少条鱼。特别的，数据保证$n$个点互不重复。\n", "inputFormat": "第一行一个正整数$n$，代表平面上点的个数。\n\n接下来$n$行每行两个整数$x,y$，代表点的横纵坐标。", "outputFormat": "输出一行一个非负整数，代表鱼的个数。", "hint": "对于前 20%的数据，保证$n \\leq 10,|x|,|y| \\leq 5$\n\n对于前 40%的数据，保证$n \\leq 300$，$0 \\leq |x|,|y| \\leq 10^5$。\n\n对于另外 20%的数据，保证$|x|,|y| \\leq 20$。\n\n对于所有数据，保证$6 \\leq n \\leq 1000$，$0 \\leq |x|, |y| \\leq 10^9$，$n$个点互不重复。\n", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2019] Fish", "background": "$\\text{\\color{white}It is said that the testdata for this problem has no issues?}$", "description": "On the plane coordinate system, you are given $n$ distinct lattice points (that is, points whose $x$- and $y$-coordinates are both integers). We call an ordered 6-tuple $(A,B,C,D,E,F)$ formed by choosing 6 different points among these $n$ points a “fish” if and only if: $AB=AC$, $BD=CD$, and $DE=DF$ (the body must be symmetric), and both $\\angle BAD,\\angle BDA$ and $\\angle CAD,\\angle CDA$ are acute angles (the head and the tail obviously cannot be concave), and $\\angle ADE,\\angle ADF$ are greater than $90^\\circ$ (that is, obtuse angles or straight angles, so that the tail will not stick up awkwardly).\n\nThe figure below shows an example of a valid fish:\n\n![](https://cdn.luogu.com.cn/upload/pic/56001.png)\n\nFish that consist of the same set of points but in different orders are considered different fish. For example, $(A,B,C,D,E,F)$ and $(A,C,B,D,E,F)$ are considered two different fish (after all, a fish has a back and a belly). Similarly, $(A,B,C,D,E,F)$ and $(A,B,C,D,F,E)$ are also considered two different fish (suppose the fish tail can be tied into a knot).\n\nGiven the $n$ points, find how many fish can be formed. In particular, the input guarantees that all $n$ points are pairwise distinct.", "inputFormat": "The first line contains a positive integer $n$, representing the number of points on the plane.\n\nThe next $n$ lines each contain two integers $x,y$, representing the coordinates of a point.", "outputFormat": "Output one line with a non-negative integer, representing the number of fish.", "hint": "For the first 20% of the data, it is guaranteed that $n \\leq 10,|x|,|y| \\leq 5$.\n\nFor the first 40% of the data, it is guaranteed that $n \\leq 300$, $0 \\leq |x|,|y| \\leq 10^5$.\n\nFor another 20% of the data, it is guaranteed that $|x|,|y| \\leq 20$.\n\nFor all data, it is guaranteed that $6 \\leq n \\leq 1000$, $0 \\leq |x|, |y| \\leq 10^9$, and the $n$ points are pairwise distinct.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2019] 鱼", "background": "$\\text{\\color{white}本题数据听说没问题？}$", "description": "在平面坐标系上给定$n$个不同的整点（也即横坐标与纵坐标皆为整数的点）。我们称从这$n$个点中选择6个不同的点所组成的有序六元组$(A,B,C,D,E,F)$是一条“鱼”，当且仅当：$AB=AC,BD=CD,DE=DF$（身形要对称），并且$\\angle BAD,\\angle BDA$ 与$\\angle CAD,\\angle CDA$都是锐角（脑袋和屁股显然不能是凹的），$\\angle ADE,\\angle ADF$ 大于$90^\\circ$（也即为钝角或平角，为了使尾巴不至于翘那么别扭）。\n\n下图就是一个合法的鱼的例子：\n\n![](https://cdn.luogu.com.cn/upload/pic/56001.png)\n\n其中点的组成相同，但顺序不同的鱼视为不同的鱼，即$(A,B,C,D,E,F)$和$(A,C,B,D,E,F)$视为不同的两条鱼（毕竟鱼也有背和肚子的两面），同理$(A,B,C,D,E,F)$和$(A,B,C,D,F,E)$也可以视为不同的两条鱼（假设鱼尾巴可以打结）。\n\n问给定的$n$个点可以构成多少条鱼。特别的，数据保证$n$个点互不重复。\n", "inputFormat": "第一行一个正整数$n$，代表平面上点的个数。\n\n接下来$n$行每行两个整数$x,y$，代表点的横纵坐标。", "outputFormat": "输出一行一个非负整数，代表鱼的个数。", "hint": "对于前 20%的数据，保证$n \\leq 10,|x|,|y| \\leq 5$\n\n对于前 40%的数据，保证$n \\leq 300$，$0 \\leq |x|,|y| \\leq 10^5$。\n\n对于另外 20%的数据，保证$|x|,|y| \\leq 20$。\n\n对于所有数据，保证$6 \\leq n \\leq 1000$，$0 \\leq |x|, |y| \\leq 10^9$，$n$个点互不重复。\n", "locale": "zh-CN"}}}
{"pid": "P5287", "type": "P", "difficulty": 7, "samples": [["11\n1 2 a\n1 3 b\n1 2 a\n1 1 b\n2 2\n1 3 a\n1 2 b\n2 6\n2 5\n1 7 a\n1 5 c\n", "1\n1\n4\n7\n1\n6\n13\n6\n1\n14\n14\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "湖南"], "title": "[HNOI2019] JOJO", "background": "JOJO 的奇幻冒险是一部非常火的漫画。漫画中的男主角经常喜欢连续喊很多的 “欧拉” 或者 “木大”。", "description": "为了防止字太多挡住漫画内容，现在打算在新的漫画中用 $x$ 欧拉或者 $x$ 木大表示有 $x$ 个欧拉或者木大。\n\n为了简化内容我们现在用字母表示喊出的话。\n\n我们用数字和字母来表示一个串，例如 `2 a 3 b` 表示的串就是 $aabbb$。\n\n一开始漫画中什么话都没有，接下来你需要依次实现 $n$ 个操作，总共只有 $2$ 种操作：\n\n- 第一种：`1 x c` 在当前漫画中加入 $x$ 个 $c$，表示在当前串末尾加入 $x$ 个 $c$ 字符。保证当前串是空串或者串尾字符不是 $c$。\n- 第二种：`2 x` 觉得漫画没画好将漫画还原到第 $x$ 次操作以后的样子，表示将串复原到第 $x$ 次操作后的样子，如果 $x=0$ 则是将串变成空串。\n\n如果当前串是 $bbaabbb$，第 $4$ 次操作后串是 $bb$，则 `2 4` 会使 $bbaabbb$ 变成 $bb$，保证 $x$ 小于当前操作数。\n\n众所周知空条承太郎十分聪明，现在迪奥已经被打败了，他开始考虑自己的漫画中的一些问题：\n\n对于一个串的每个前缀 $A$，都有一个最长的比它短的前缀 $B$ 与前缀 $A$ 的一个后缀匹配，设这个最长的前缀 $B$ 的长度为 $L$。$L$ 为 $0$ 时意味着 $B$ 是一个空串。\n\n每一次操作后，你都需要将当前的串的所有前缀的 $L$ 求和并对 $998244353$ 取模输出告诉空条承太郎，好和他的白金之星算出的答案对比。\n\n比如 $bbaaabba$ 的 $L$ 分别是 $0, 1, 0, 0, 0, 1, 2, 3$，所以对于这个串的答案就是 $7$。\n", "inputFormat": "第一行包括一个正整数 $n$，表示操作数量。\n\n接下来 $n$ 行每行包含一个操作，操作格式如题面所示，例如\n\n- `1 x c`\n- `2 x`\n\n保证数据合法。", "outputFormat": "输出文件仅包含 $n$ 行，第 $i$ 行一个整数，表示 $i$ 个操作之后串的答案。", "hint": "#### 样例解释\n\n| 操作 | 此时的串 | 答案 |\n| :----------: | :----------: | :----------: |\n| $1$ | `aa` | $0+1=1$ |\n| $2$ | `aabbb` | $0+1+0+0+0=1$ |\n| $3$ | `aabbbaa` | $0+1+0+0+0+1+2=4$ |\n| $4$ | `aabbbaab` | $0+1+0+0+0+1+2+3=7$ |\n| $5$ | `aabbb` | $0+1+0+0+0=1$ |\n| $6$ | `aabbbaaa` | $0+1+0+0+0+1+2+2=6$ |\n| $7$ | `aabbbaaabb` | $0+1+0+0+0+1+2+2+3+4=13$ |\n| $8$ | `aabbbaaa` | $0+1+0+0+0+1+2+2=6$ |\n| $9$ | `aabbb` | $0+1+0+0+0=1$ |\n| $10$ | `aabbbaaaaaaa` | $0+1+0+0+0+1+2+2+2+2+2+2=14$ |\n| $11$ | `aabbbaaaaaaaccccc` | $0+1+0+0+0+1+2+2+2+2+2+2+0+0+0+0+0=14$ |\n\n#### 数据范围\n\n$20\\%$ 的数据满足 $n\\leq 300$ 且每个 $1$ 操作中的 $x\\leq 300$；\n\n另有 $30\\%$ 的数据满足 $n\\leq 10 ^ 5$ 且每个 $1$ 操作中的 $x=1$；\n\n另有 $30\\%$ 的数据满足 $n\\leq 10 ^ 5$ 且不含 $2$ 操作；\n\n$100\\%$ 的数据满足 $n\\leq 10 ^ 5$ 且每个 $1$ 操作中的 $x\\leq 10 ^ 4$。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2019] JOJO", "background": "JoJo's Bizarre Adventure is a very popular manga. The main character in the manga often likes to shout many consecutive “Ora” or “Muda”.", "description": "To prevent too many words from blocking the manga content, the new manga plans to use $x$ Ora or $x$ Muda to represent that there are $x$ occurrences of Ora or Muda.\n\nTo simplify the content, we now use letters to represent the shouted words.\n\nWe use numbers and letters to represent a string. For example, `2 a 3 b` represents the string $aabbb$.\n\nAt the beginning, there is no text in the manga. Next, you need to perform $n$ operations in order. There are only $2$ types of operations in total:\n\n- The first type: `1 x c` adds $x$ copies of $c$ to the current manga, meaning appending $x$ characters $c$ to the end of the current string. It is guaranteed that the current string is empty, or the last character of the string is not $c$.\n- The second type: `2 x` thinks the manga was not drawn well and restores it to the state after the $x$-th operation, meaning restoring the string to the state after the $x$-th operation. If $x=0$, the string becomes the empty string.\n\nIf the current string is $bbaabbb$, and after the $4$-th operation the string is $bb$, then `2 4` will change $bbaabbb$ into $bb$. It is guaranteed that $x$ is less than the current operation index.\n\nAs everyone knows, Jotaro Kujo is very smart. Now that Dio has been defeated, he starts thinking about some problems in his manga:\n\nFor each prefix $A$ of a string, there is a longest prefix $B$ that is shorter than it and matches a suffix of prefix $A$. Let the length of this longest prefix $B$ be $L$. When $L$ is $0$, it means $B$ is an empty string.\n\nAfter each operation, you need to compute the sum of $L$ over all prefixes of the current string, take it modulo $998244353$, and output it to tell Jotaro Kujo, so that he can compare it with the answer computed by his Star Platinum.\n\nFor example, for $bbaaabba$, the values of $L$ are $0, 1, 0, 0, 0, 1, 2, 3$, so the answer for this string is $7$.", "inputFormat": "The first line contains a positive integer $n$, representing the number of operations.\n\nThe next $n$ lines each contain one operation. The operation formats are as described in the statement, for example:\n\n- `1 x c`\n- `2 x`\n\nIt is guaranteed that the input is valid.", "outputFormat": "The output contains exactly $n$ lines. The $i$-th line contains one integer, representing the answer after the first $i$ operations.", "hint": "#### Sample Explanation\n\n| Operation | Current string | Answer |\n| :----------: | :----------: | :----------: |\n| $1$ | `aa` | $0+1=1$ |\n| $2$ | `aabbb` | $0+1+0+0+0=1$ |\n| $3$ | `aabbbaa` | $0+1+0+0+0+1+2=4$ |\n| $4$ | `aabbbaab` | $0+1+0+0+0+1+2+3=7$ |\n| $5$ | `aabbb` | $0+1+0+0+0=1$ |\n| $6$ | `aabbbaaa` | $0+1+0+0+0+1+2+2=6$ |\n| $7$ | `aabbbaaabb` | $0+1+0+0+0+1+2+2+3+4=13$ |\n| $8$ | `aabbbaaa` | $0+1+0+0+0+1+2+2=6$ |\n| $9$ | `aabbb` | $0+1+0+0+0=1$ |\n| $10$ | `aabbbaaaaaaa` | $0+1+0+0+0+1+2+2+2+2+2+2=14$ |\n| $11$ | `aabbbaaaaaaaccccc` | $0+1+0+0+0+1+2+2+2+2+2+2+0+0+0+0+0=14$ |\n\n#### Constraints\n\n$20\\%$ of the testdata satisfies $n\\leq 300$ and for each operation of type $1$, $x\\leq 300$.\n\nAnother $30\\%$ of the testdata satisfies $n\\leq 10 ^ 5$ and for each operation of type $1$, $x=1$.\n\nAnother $30\\%$ of the testdata satisfies $n\\leq 10 ^ 5$ and contains no operation of type $2$.\n\n$100\\%$ of the testdata satisfies $n\\leq 10 ^ 5$ and for each operation of type $1$, $x\\leq 10 ^ 4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2019] JOJO", "background": "JOJO 的奇幻冒险是一部非常火的漫画。漫画中的男主角经常喜欢连续喊很多的 “欧拉” 或者 “木大”。", "description": "为了防止字太多挡住漫画内容，现在打算在新的漫画中用 $x$ 欧拉或者 $x$ 木大表示有 $x$ 个欧拉或者木大。\n\n为了简化内容我们现在用字母表示喊出的话。\n\n我们用数字和字母来表示一个串，例如 `2 a 3 b` 表示的串就是 $aabbb$。\n\n一开始漫画中什么话都没有，接下来你需要依次实现 $n$ 个操作，总共只有 $2$ 种操作：\n\n- 第一种：`1 x c` 在当前漫画中加入 $x$ 个 $c$，表示在当前串末尾加入 $x$ 个 $c$ 字符。保证当前串是空串或者串尾字符不是 $c$。\n- 第二种：`2 x` 觉得漫画没画好将漫画还原到第 $x$ 次操作以后的样子，表示将串复原到第 $x$ 次操作后的样子，如果 $x=0$ 则是将串变成空串。\n\n如果当前串是 $bbaabbb$，第 $4$ 次操作后串是 $bb$，则 `2 4` 会使 $bbaabbb$ 变成 $bb$，保证 $x$ 小于当前操作数。\n\n众所周知空条承太郎十分聪明，现在迪奥已经被打败了，他开始考虑自己的漫画中的一些问题：\n\n对于一个串的每个前缀 $A$，都有一个最长的比它短的前缀 $B$ 与前缀 $A$ 的一个后缀匹配，设这个最长的前缀 $B$ 的长度为 $L$。$L$ 为 $0$ 时意味着 $B$ 是一个空串。\n\n每一次操作后，你都需要将当前的串的所有前缀的 $L$ 求和并对 $998244353$ 取模输出告诉空条承太郎，好和他的白金之星算出的答案对比。\n\n比如 $bbaaabba$ 的 $L$ 分别是 $0, 1, 0, 0, 0, 1, 2, 3$，所以对于这个串的答案就是 $7$。\n", "inputFormat": "第一行包括一个正整数 $n$，表示操作数量。\n\n接下来 $n$ 行每行包含一个操作，操作格式如题面所示，例如\n\n- `1 x c`\n- `2 x`\n\n保证数据合法。", "outputFormat": "输出文件仅包含 $n$ 行，第 $i$ 行一个整数，表示 $i$ 个操作之后串的答案。", "hint": "#### 样例解释\n\n| 操作 | 此时的串 | 答案 |\n| :----------: | :----------: | :----------: |\n| $1$ | `aa` | $0+1=1$ |\n| $2$ | `aabbb` | $0+1+0+0+0=1$ |\n| $3$ | `aabbbaa` | $0+1+0+0+0+1+2=4$ |\n| $4$ | `aabbbaab` | $0+1+0+0+0+1+2+3=7$ |\n| $5$ | `aabbb` | $0+1+0+0+0=1$ |\n| $6$ | `aabbbaaa` | $0+1+0+0+0+1+2+2=6$ |\n| $7$ | `aabbbaaabb` | $0+1+0+0+0+1+2+2+3+4=13$ |\n| $8$ | `aabbbaaa` | $0+1+0+0+0+1+2+2=6$ |\n| $9$ | `aabbb` | $0+1+0+0+0=1$ |\n| $10$ | `aabbbaaaaaaa` | $0+1+0+0+0+1+2+2+2+2+2+2=14$ |\n| $11$ | `aabbbaaaaaaaccccc` | $0+1+0+0+0+1+2+2+2+2+2+2+0+0+0+0+0=14$ |\n\n#### 数据范围\n\n$20\\%$ 的数据满足 $n\\leq 300$ 且每个 $1$ 操作中的 $x\\leq 300$；\n\n另有 $30\\%$ 的数据满足 $n\\leq 10 ^ 5$ 且每个 $1$ 操作中的 $x=1$；\n\n另有 $30\\%$ 的数据满足 $n\\leq 10 ^ 5$ 且不含 $2$ 操作；\n\n$100\\%$ 的数据满足 $n\\leq 10 ^ 5$ 且每个 $1$ 操作中的 $x\\leq 10 ^ 4$。", "locale": "zh-CN"}}}
{"pid": "P5288", "type": "P", "difficulty": 7, "samples": [["1\n6\n1 3\n1 5\n3 5\n1\n1 3", "3 2\n3 1\n"], ["1\n12\n1 10\n1 6\n1 3\n3 6\n3 5\n6 10\n6 8\n8 10\n10 12\n4\n1 10\n1 3\n6 8\n1 6", "8 210\n7 210\n8 70\n8 105\n8 140"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "湖南"], "title": "[HNOI2019] 多边形", "background": null, "description": "小 R 与小 W 在玩游戏。\n\n他们有一个边数为 $n$ 的凸多边形，其顶点沿逆时针方向标号依次为 $1,2,3,\\cdots , n$。最开始凸多边形中有 $n$ 条线段，即多边形的 $n$ 条边。这里我们用一个有序数对 $(a, b)$（其中 $a < b$）来表示一条端点分别为顶点 $a,b$ 的线段。\n\n在游戏开始之前，小 W 会进行一些操作。每次操作时，他会选中多边形的两个互异顶点，给它们之间连一条线段，并且所连的线段不会与已存的线段重合、相交（只拥有一个公共端点不算作相交）。\n\n他会不断重复这个过程，直到无法继续连线，这样得到了状态 $s_0$。$s_0$ 包含的线段为凸多边形的边与小 W 连上的线段，容易发现这些线段将多边形划分为一个个三角形区域。对于其中任意一个三角形，其三个顶点为 $i,j,k(i < j < k)$，我们可以给这个三角形一个标号 $j$，这样一来每个三角形都被标上了 $2,3, \\cdots , n - 1$ 中的一个，且没有标号相同的两个三角形。\n\n小 W 定义了一种“旋转”操作：对于当前状态，选定 $4$ 个顶点 $a,b,c,d$，使其满足 $1 \\leq a < b < c <d \\leq n$ 且它们两两之间共有 $5$ 条线段——$(a,b), (b,c), (c,d), (a,d), (a,c)$，然后删去线段 $(a,c)$，并连上线段 $(b,d)$。那么用有序数对 $(a,c)$ 即可唯一表示该次“旋转”。我们称这次旋转为 $(a,c)$ “旋转”。显然每次进行完“旋转”操作后多边形中依然不存在相交的线段。\n\n当小 W 将一个状态作为游戏初始状态展示给小 R 后，游戏开始。游戏过程中，小 R 每次可以对当前的状态进行“旋转”。在进行有限次“旋转”之后，小 R 一定会得到一个状态，此时无法继续进行“旋转”操作，游戏结束。那么将每一次“旋转”所对应的有序数对按操作顺序写下，得到的序列即为该轮游戏的操作方案。\n\n为了加大难度，小 W 以 $s_0$ 为基础，产生了 $m$ 个新状态。其中第 $i$ 个状态 $s_i$ 为对 $s_0$ 进行一次“旋转”操作后得到的状态。你需要帮助小 R 求出分别以 $s_0,s_1\\cdots s_n$ 作为游戏初始状态时，小 R 完成游戏所用的最少“旋转”次数，并根据小 W 的心情，有时还需求出“旋转”次数最少的不同操作方案数。由于方案数可能很大，输出时请对 $10 ^ 9+7$ 取模。", "inputFormat": "第一行一个整数 $W$，表示小 W 的心情。若 $W$ 为 $0$ 则只需求出最少的“旋转”次数，若 $W$ 为 $1$ 则还需求出“旋转”次数最少时的不同操作方案数。\n\n第二行一个正整数 $n$，表示凸多边形的边数。\n\n接下来 $n-3$ 行，每行两个正整数 $x,y$，表示小 W 在 $s_0$ 中连的一条线段，端点分别为 $x,y$。保证该线段不与已存的线段重合或相交。\n\n接下来一行一个整数 $m$，表示小 W 以 $s_0$ 为基础产生的新状态个数。\n\n接下来 $m$ 行，每行两个整数。假设其中第 $i$ 行为 $a,b$，表示对 $s_0$ 进行 $(a,b)$“旋转”后得到 $s_i$。", "outputFormat": "输出共 $m+1$ 行。\n\n若 $W$ 为 $0$ 则每一行输出一个整数，第 $i(i = 1,2, \\cdots , m, m + 1)$ 行输出的整数表示 $S_{i-1}$ 作为初始局面的最少“旋转”次数。\n\n若 $W$ 为 $1$ 则每一行输出两个整数，第 $i(i = 1,2, \\cdots , m, m + 1)$ 行输出的两个整数依次表示 $S_{i-1}$ 作为初始局面的最少“旋转”次数、“旋转”次数最少的不同操作方案数对 $10 ^ 9+7$ 取模的结果。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/56004.png)\n\n![](https://cdn.luogu.com.cn/upload/pic/56005.png)", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2019] Polygon", "background": "", "description": "Xiao R and Xiao W are playing a game.\n\nThey have a convex polygon with $n$ sides, whose vertices are labeled $1,2,3,\\cdots , n$ in counterclockwise order. Initially, there are $n$ line segments inside the convex polygon, namely the $n$ sides of the polygon. Here we use an ordered pair $(a, b)$ (where $a < b$) to represent a line segment whose endpoints are vertices $a,b$.\n\nBefore the game starts, Xiao W performs some operations. In each operation, he chooses two distinct vertices of the polygon, draws a line segment between them, and the drawn segment will not overlap or intersect with any existing segment (having only one common endpoint is not considered an intersection).\n\nHe repeats this process until no more segments can be added, obtaining a state $s_0$. The segments in $s_0$ include the polygon sides and the segments added by Xiao W. It is easy to see that these segments partition the polygon into triangular regions. For any such triangle with vertices $i,j,k(i < j < k)$, we can assign this triangle the label $j$. In this way, each triangle is labeled with a distinct number from $2,3, \\cdots , n - 1$.\n\nXiao W defines a kind of “rotation” operation: for the current state, choose $4$ vertices $a,b,c,d$ such that $1 \\leq a < b < c <d \\leq n$, and there are exactly $5$ segments among them—$(a,b), (b,c), (c,d), (a,d), (a,c)$. Then delete segment $(a,c)$ and add segment $(b,d)$. Thus, the ordered pair $(a,c)$ uniquely represents this “rotation”. We call this rotation the $(a,c)$ “rotation”. Clearly, after each “rotation” operation, there are still no intersecting segments in the polygon.\n\nAfter Xiao W presents a state as the initial state of the game to Xiao R, the game begins. During the game, each time Xiao R may perform a “rotation” on the current state. After finitely many “rotations”, Xiao R will surely reach a state where no more “rotation” operations can be performed, and the game ends. Write down the ordered pairs corresponding to each “rotation” in the order performed; the resulting sequence is the operation plan for that round of the game.\n\nTo make it harder, based on $s_0$, Xiao W generates $m$ new states. The $i$-th state $s_i$ is the state obtained by applying one “rotation” operation to $s_0$. You need to help Xiao R compute, when using $s_0,s_1\\cdots s_n$ as the initial state of the game respectively, the minimum number of “rotations” Xiao R needs to finish the game; and depending on Xiao W’s mood, sometimes you also need to compute the number of different operation plans that achieve this minimum. Since the number of plans may be large, output it modulo $10 ^ 9+7$.", "inputFormat": "The first line contains an integer $W$, indicating Xiao W’s mood. If $W$ is $0$, you only need to output the minimum number of “rotations”. If $W$ is $1$, you also need to output the number of different operation plans when the number of “rotations” is minimal.\n\nThe second line contains a positive integer $n$, the number of sides of the convex polygon.\n\nThe next $n-3$ lines each contain two positive integers $x,y$, representing a segment drawn by Xiao W in $s_0$, with endpoints $x,y$. It is guaranteed that this segment does not overlap or intersect with existing segments.\n\nThe next line contains an integer $m$, the number of new states generated by Xiao W based on $s_0$.\n\nThe next $m$ lines each contain two integers. Suppose the $i$-th of these lines is $a,b$, meaning that $s_i$ is obtained by performing the $(a,b)$ “rotation” on $s_0$.", "outputFormat": "Output a total of $m+1$ lines.\n\nIf $W$ is $0$, output one integer per line. On line $i(i = 1,2, \\cdots , m, m + 1)$, the integer denotes the minimum number of “rotations” when $S_{i-1}$ is the initial state.\n\nIf $W$ is $1$, output two integers per line. On line $i(i = 1,2, \\cdots , m, m + 1)$, the two integers denote, respectively, the minimum number of “rotations” when $S_{i-1}$ is the initial state, and the number of different operation plans that achieve this minimum, modulo $10 ^ 9+7$.", "hint": "![](https://cdn.luogu.com.cn/upload/pic/56004.png)\n\n![](https://cdn.luogu.com.cn/upload/pic/56005.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2019] 多边形", "background": null, "description": "小 R 与小 W 在玩游戏。\n\n他们有一个边数为 $n$ 的凸多边形，其顶点沿逆时针方向标号依次为 $1,2,3,\\cdots , n$。最开始凸多边形中有 $n$ 条线段，即多边形的 $n$ 条边。这里我们用一个有序数对 $(a, b)$（其中 $a < b$）来表示一条端点分别为顶点 $a,b$ 的线段。\n\n在游戏开始之前，小 W 会进行一些操作。每次操作时，他会选中多边形的两个互异顶点，给它们之间连一条线段，并且所连的线段不会与已存的线段重合、相交（只拥有一个公共端点不算作相交）。\n\n他会不断重复这个过程，直到无法继续连线，这样得到了状态 $s_0$。$s_0$ 包含的线段为凸多边形的边与小 W 连上的线段，容易发现这些线段将多边形划分为一个个三角形区域。对于其中任意一个三角形，其三个顶点为 $i,j,k(i < j < k)$，我们可以给这个三角形一个标号 $j$，这样一来每个三角形都被标上了 $2,3, \\cdots , n - 1$ 中的一个，且没有标号相同的两个三角形。\n\n小 W 定义了一种“旋转”操作：对于当前状态，选定 $4$ 个顶点 $a,b,c,d$，使其满足 $1 \\leq a < b < c <d \\leq n$ 且它们两两之间共有 $5$ 条线段——$(a,b), (b,c), (c,d), (a,d), (a,c)$，然后删去线段 $(a,c)$，并连上线段 $(b,d)$。那么用有序数对 $(a,c)$ 即可唯一表示该次“旋转”。我们称这次旋转为 $(a,c)$ “旋转”。显然每次进行完“旋转”操作后多边形中依然不存在相交的线段。\n\n当小 W 将一个状态作为游戏初始状态展示给小 R 后，游戏开始。游戏过程中，小 R 每次可以对当前的状态进行“旋转”。在进行有限次“旋转”之后，小 R 一定会得到一个状态，此时无法继续进行“旋转”操作，游戏结束。那么将每一次“旋转”所对应的有序数对按操作顺序写下，得到的序列即为该轮游戏的操作方案。\n\n为了加大难度，小 W 以 $s_0$ 为基础，产生了 $m$ 个新状态。其中第 $i$ 个状态 $s_i$ 为对 $s_0$ 进行一次“旋转”操作后得到的状态。你需要帮助小 R 求出分别以 $s_0,s_1\\cdots s_n$ 作为游戏初始状态时，小 R 完成游戏所用的最少“旋转”次数，并根据小 W 的心情，有时还需求出“旋转”次数最少的不同操作方案数。由于方案数可能很大，输出时请对 $10 ^ 9+7$ 取模。", "inputFormat": "第一行一个整数 $W$，表示小 W 的心情。若 $W$ 为 $0$ 则只需求出最少的“旋转”次数，若 $W$ 为 $1$ 则还需求出“旋转”次数最少时的不同操作方案数。\n\n第二行一个正整数 $n$，表示凸多边形的边数。\n\n接下来 $n-3$ 行，每行两个正整数 $x,y$，表示小 W 在 $s_0$ 中连的一条线段，端点分别为 $x,y$。保证该线段不与已存的线段重合或相交。\n\n接下来一行一个整数 $m$，表示小 W 以 $s_0$ 为基础产生的新状态个数。\n\n接下来 $m$ 行，每行两个整数。假设其中第 $i$ 行为 $a,b$，表示对 $s_0$ 进行 $(a,b)$“旋转”后得到 $s_i$。", "outputFormat": "输出共 $m+1$ 行。\n\n若 $W$ 为 $0$ 则每一行输出一个整数，第 $i(i = 1,2, \\cdots , m, m + 1)$ 行输出的整数表示 $S_{i-1}$ 作为初始局面的最少“旋转”次数。\n\n若 $W$ 为 $1$ 则每一行输出两个整数，第 $i(i = 1,2, \\cdots , m, m + 1)$ 行输出的两个整数依次表示 $S_{i-1}$ 作为初始局面的最少“旋转”次数、“旋转”次数最少的不同操作方案数对 $10 ^ 9+7$ 取模的结果。", "hint": "![](https://cdn.luogu.com.cn/upload/pic/56004.png)\n\n![](https://cdn.luogu.com.cn/upload/pic/56005.png)", "locale": "zh-CN"}}}
