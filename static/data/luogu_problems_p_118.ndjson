{"pid": "P3389", "type": "P", "difficulty": 5, "samples": [["3\n1 3 4 5\n1 4 7 3\n9 3 2 2", "-0.97\n5.18\n-2.39"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["Special Judge", "线性代数", "高斯消元", "模板题"], "title": "【模板】高斯消元法", "background": "如果想要更好地测试高斯消元算法模板请在通过此题后尝试通过 [SDOI2006 线性方程组](https://www.luogu.com.cn/problem/P2455) 这一题。", "description": "给定一个线性方程组，对其求解。\n\n$$ \\begin{cases} a_{1, 1} x_1 + a_{1, 2} x_2 + \\cdots + a_{1, n} x_n = b_1 \\\\ a_{2, 1} x_1 + a_{2, 2} x_2 + \\cdots + a_{2, n} x_n = b_2 \\\\ \\cdots \\\\ a_{n,1} x_1 + a_{n, 2} x_2 + \\cdots + a_{n, n} x_n = b_n \\end{cases}$$\n", "inputFormat": "第一行，一个正整数 $n$。\n\n第二至 $n+1$ 行，每行 $n+1$ 个整数，为 $ a_1, a_2, \\dots ,a_n$ 和 $b$，代表一组方程。\n", "outputFormat": "共 $n$ 行，每行一个数，第 $i$ 行为 $x_i$（四舍五入保留 $2$ 位小数）。\n\n如果不存在唯一解或无解，在第一行输出 `No Solution`.\n", "hint": "本题 special judge 用于处理可能由于浮点数问题输出 `-0.00` 的情况。若某个 $x_i$ 的解四舍五入后是 `0.00`，那么你的程序输出 `-0.00` 和输出 `0.00` 都是正确的。\n\n数据范围：$1 \\leq n \\leq 100, \\left | a_i \\right| \\leq {10}^4 , \\left |b \\right| \\leq {10}^4 $。保证数据若有解则所有解均满足 $|x_i|\\le 10^3$，且 $x_i\\pm 10^{-6}$ 和 $x_i$ 四舍五入后的结果相同（即不会因为较小的精度误差导致四舍五入后的结果不同）。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Gaussian Elimination", "background": "If you want to better test the Gaussian elimination template, after solving this problem, try [SDOI2006 线性方程组](https://www.luogu.com.cn/problem/P2455).", "description": "Given a system of linear equations, solve it.\n\n$$ \\begin{cases} a_{1, 1} x_1 + a_{1, 2} x_2 + \\cdots + a_{1, n} x_n = b_1 \\\\ a_{2, 1} x_1 + a_{2, 2} x_2 + \\cdots + a_{2, n} x_n = b_2 \\\\ \\cdots \\\\ a_{n,1} x_1 + a_{n, 2} x_2 + \\cdots + a_{n, n} x_n = b_n \\end{cases}$$", "inputFormat": "The first line contains a positive integer $n$.\n\nLines $2$ to $n+1$ each contain $n+1$ integers, which are $ a_1, a_2, \\dots ,a_n$ and $b$, representing one equation.", "outputFormat": "Output $n$ lines, one number per line. The $i$-th line is $x_i$ (rounded to $2$ decimal places).\n\nIf there is no solution or the solution is not unique, output `No Solution` on the first line.", "hint": "This problem uses a special judge to handle cases where floating-point issues might produce `-0.00`. If some $x_i$ rounds to `0.00`, then both `-0.00` and `0.00` are accepted.\n\nConstraints: $1 \\leq n \\leq 100, \\left | a_i \\right| \\leq {10}^4 , \\left |b \\right| \\leq {10}^4$. It is guaranteed that if there is a solution, then all solutions satisfy $|x_i|\\le 10^3$, and the rounded results of $x_i\\pm 10^{-6}$ and $x_i$ are the same (i.e., small precision errors will not change the rounded result).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】高斯消元法", "background": "如果想要更好地测试高斯消元算法模板请在通过此题后尝试通过 [SDOI2006 线性方程组](https://www.luogu.com.cn/problem/P2455) 这一题。", "description": "给定一个线性方程组，对其求解。\n\n$$ \\begin{cases} a_{1, 1} x_1 + a_{1, 2} x_2 + \\cdots + a_{1, n} x_n = b_1 \\\\ a_{2, 1} x_1 + a_{2, 2} x_2 + \\cdots + a_{2, n} x_n = b_2 \\\\ \\cdots \\\\ a_{n,1} x_1 + a_{n, 2} x_2 + \\cdots + a_{n, n} x_n = b_n \\end{cases}$$\n", "inputFormat": "第一行，一个正整数 $n$。\n\n第二至 $n+1$ 行，每行 $n+1$ 个整数，为 $ a_1, a_2, \\dots ,a_n$ 和 $b$，代表一组方程。\n", "outputFormat": "共 $n$ 行，每行一个数，第 $i$ 行为 $x_i$（四舍五入保留 $2$ 位小数）。\n\n如果不存在唯一解或无解，在第一行输出 `No Solution`.\n", "hint": "本题 special judge 用于处理可能由于浮点数问题输出 `-0.00` 的情况。若某个 $x_i$ 的解四舍五入后是 `0.00`，那么你的程序输出 `-0.00` 和输出 `0.00` 都是正确的。\n\n数据范围：$1 \\leq n \\leq 100, \\left | a_i \\right| \\leq {10}^4 , \\left |b \\right| \\leq {10}^4 $。保证数据若有解则所有解均满足 $|x_i|\\le 10^3$，且 $x_i\\pm 10^{-6}$ 和 $x_i$ 四舍五入后的结果相同（即不会因为较小的精度误差导致四舍五入后的结果不同）。", "locale": "zh-CN"}}}
{"pid": "P3390", "type": "P", "difficulty": 4, "samples": [["2 1\n1 1\n1 1", "1 1\n1 1"], ["3 5\n1 2 3\n4 5 6\n7 8 9", "121824 149688 177552\n275886 338985 402084\n429948 528282 626616"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "O2优化", "矩阵乘法", "模板题"], "title": "【模板】矩阵快速幂", "background": "一个 $m \\times n$ 的**矩阵**是一个由 $m$ 行 $n$ 列元素排列成的矩形阵列。即形如\n\n$$ A = \\begin{bmatrix} a_{1 1} & a_{1 2} & \\cdots & a_{1 n} \\\\ a_{2 1} & a_{2 2} & \\cdots & a_{2 n} \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ a_{m 1} & a_{m 2} & \\cdots & a_{m n} \\end{bmatrix} \\text{.} $$\n\n本题中认为矩阵中的元素 $a_{i j}$ 是整数。\n\n两个大小分别为 $m \\times n$ 和 $n \\times p$ 的矩阵 $A, B$ **相乘**的结果为一个大小为 $m \\times p$ 的矩阵。将结果矩阵记作 $C$，则\n\n$$ c_{i j} = \\sum_{k = 1}^{n} a_{i k} b_{k j} \\text{,\\qquad($1 \\le i \\le m$, $1 \\le j \\le p$).} $$\n\n而如果 $A$ 的列数与 $B$ 的行数不相等，则无法进行乘法。\n\n可以验证，矩阵乘法满足结合律，即 $(A B) C = A (B C)$。\n\n一个大小为 $n \\times n$ 的矩阵 $A$ 可以与自身进行乘法，得到的仍是大小为 $n \\times n$ 的矩阵，记作 $A^2 = A \\times A$。进一步地，还可以递归地定义任意高次方 $A^k = A \\times A^{k - 1}$，或称 $A^k = \\underbrace{A \\times A \\times \\cdots \\times A}_{k \\text{ 次}}$。\n\n特殊地，定义 $A^0$ 为单位矩阵 $I = \\begin{bmatrix} 1 & 0 & \\cdots & 0 \\\\ 0 & 1 & \\cdots & 0 \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ 0 & 0 & \\cdots & 1 \\end{bmatrix}$。", "description": "给定 $n\\times n$ 的矩阵 $A$，求 $A^k$。\n", "inputFormat": "第一行两个整数 $n,k$。  \n接下来 $n$ 行，每行 $n$ 个整数，第 $i$ 行的第 $j$ 的数表示 $A_{i,j}$。", "outputFormat": "输出 $A^k$\n\n共 $n$ 行，每行 $n$ 个数，第 $i$ 行第 $j$ 个数表示 $(A^k)_{i,j}$，每个元素对 $10^9+7$ 取模。\n", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le n \\le 100$，$0 \\le k \\le 10^{12}$，$|A_{i,j}| \\le 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Matrix Fast Exponentiation", "background": "An $m \\times n$ matrix is a rectangular array of elements arranged in $m$ rows and $n$ columns. That is,\n\n$$ A = \\begin{bmatrix} a_{1 1} & a_{1 2} & \\cdots & a_{1 n} \\\\ a_{2 1} & a_{2 2} & \\cdots & a_{2 n} \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ a_{m 1} & a_{m 2} & \\cdots & a_{m n} \\end{bmatrix} \\text{.} $$\n\nIn this problem, the elements $a_{i j}$ in a matrix are integers.\n\nGiven matrices $A, B$ of sizes $m \\times n$ and $n \\times p$, respectively, their product is an $m \\times p$ matrix. Denote the result by $C$, then\n\n$$ c_{i j} = \\sum_{k = 1}^{n} a_{i k} b_{k j} \\text{,\\qquad($1 \\le i \\le m$, $1 \\le j \\le p$).} $$\n\nIf the number of columns of $A$ does not equal the number of rows of $B$, the product cannot be computed.\n\nIt can be verified that matrix multiplication is associative, i.e., $(A B) C = A (B C)$.\n\nAn $n \\times n$ matrix $A$ can be multiplied by itself to obtain another $n \\times n$ matrix, denoted $A^2 = A \\times A$. Furthermore, higher powers can be defined recursively as $A^k = A \\times A^{k - 1}$, or $A^k = \\underbrace{A \\times A \\times \\cdots \\times A}_{k \\text{ 次}}$.\n\nIn particular, define $A^0$ as the identity matrix $I = \\begin{bmatrix} 1 & 0 & \\cdots & 0 \\\\ 0 & 1 & \\cdots & 0 \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ 0 & 0 & \\cdots & 1 \\end{bmatrix}$.", "description": "Given an $n \\times n$ matrix $A$, compute $A^k$.", "inputFormat": "The first line contains two integers $n,k$.  \nThen follow $n$ lines, each containing $n$ integers. In row $i$, the $j$-th number denotes $A_{i,j}$.", "outputFormat": "Output $A^k$.\n\nThere are $n$ lines in total, each containing $n$ numbers. The number in row $i$ and column $j$ denotes $(A^k)_{i,j}$. Each element is taken modulo $10^9+7$.", "hint": "Constraints\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 100$, $0 \\le k \\le 10^{12}$, $|A_{i,j}| \\le 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】矩阵快速幂", "background": "一个 $m \\times n$ 的**矩阵**是一个由 $m$ 行 $n$ 列元素排列成的矩形阵列。即形如\n\n$$ A = \\begin{bmatrix} a_{1 1} & a_{1 2} & \\cdots & a_{1 n} \\\\ a_{2 1} & a_{2 2} & \\cdots & a_{2 n} \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ a_{m 1} & a_{m 2} & \\cdots & a_{m n} \\end{bmatrix} \\text{.} $$\n\n本题中认为矩阵中的元素 $a_{i j}$ 是整数。\n\n两个大小分别为 $m \\times n$ 和 $n \\times p$ 的矩阵 $A, B$ **相乘**的结果为一个大小为 $m \\times p$ 的矩阵。将结果矩阵记作 $C$，则\n\n$$ c_{i j} = \\sum_{k = 1}^{n} a_{i k} b_{k j} \\text{,\\qquad($1 \\le i \\le m$, $1 \\le j \\le p$).} $$\n\n而如果 $A$ 的列数与 $B$ 的行数不相等，则无法进行乘法。\n\n可以验证，矩阵乘法满足结合律，即 $(A B) C = A (B C)$。\n\n一个大小为 $n \\times n$ 的矩阵 $A$ 可以与自身进行乘法，得到的仍是大小为 $n \\times n$ 的矩阵，记作 $A^2 = A \\times A$。进一步地，还可以递归地定义任意高次方 $A^k = A \\times A^{k - 1}$，或称 $A^k = \\underbrace{A \\times A \\times \\cdots \\times A}_{k \\text{ 次}}$。\n\n特殊地，定义 $A^0$ 为单位矩阵 $I = \\begin{bmatrix} 1 & 0 & \\cdots & 0 \\\\ 0 & 1 & \\cdots & 0 \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ 0 & 0 & \\cdots & 1 \\end{bmatrix}$。", "description": "给定 $n\\times n$ 的矩阵 $A$，求 $A^k$。\n", "inputFormat": "第一行两个整数 $n,k$。  \n接下来 $n$ 行，每行 $n$ 个整数，第 $i$ 行的第 $j$ 的数表示 $A_{i,j}$。", "outputFormat": "输出 $A^k$\n\n共 $n$ 行，每行 $n$ 个数，第 $i$ 行第 $j$ 个数表示 $(A^k)_{i,j}$，每个元素对 $10^9+7$ 取模。\n", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le n \\le 100$，$0 \\le k \\le 10^{12}$，$|A_{i,j}| \\le 1000$。", "locale": "zh-CN"}}}
{"pid": "P3391", "type": "P", "difficulty": 5, "samples": [["5 3\n1 3\n1 3\n1 4", "4 3 2 1 5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["平衡树", "O2优化", "模板题"], "title": "【模板】文艺平衡树", "background": "", "description": "您需要写一种数据结构（可参考题目标题），来维护一个有序数列。  \n\n其中需要提供以下操作：翻转一个区间，例如原有序序列是 $5\\ 4\\ 3\\ 2\\ 1$，翻转区间是 $[2,4]$ 的话，结果是 $5\\ 2\\ 3\\ 4\\ 1$。\n", "inputFormat": "第一行两个正整数 $n,m$，表示序列长度与操作个数。序列中第 $i$ 项初始为 $i$。  \n接下来 $m$ 行，每行两个正整数 $l,r$，表示翻转的区间。\n", "outputFormat": "输出一行 $n$ 个正整数，表示原始序列经过 $m$ 次变换后的结果。\n", "hint": "【数据范围】  \n对于 $100\\%$ 的数据，$1 \\le n, m \\leq 100000 $，$1 \\le l \\le r \\le n$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Wenyi Balanced Tree", "background": null, "description": "You need to implement a data structure (you can refer to the title) to maintain an ordered sequence.\n\nIt must support the following operation: reverse a segment. For example, if the original ordered sequence is $5\\ 4\\ 3\\ 2\\ 1$, and the reversed segment is $[2, 4]$, then the result is $5\\ 2\\ 3\\ 4\\ 1$.", "inputFormat": "The first line contains two positive integers $n, m$, denoting the length of the sequence and the number of operations. Initially, the $i$-th element of the sequence is $i$.\n\nThen follow $m$ lines, each containing two positive integers $l, r$, denoting the segment to reverse.", "outputFormat": "Output one line with $n$ positive integers, which is the result after applying $m$ reversals to the original sequence.", "hint": "Constraints  \nFor $100\\%$ of the testdata, $1 \\le n, m \\le 100000$, $1 \\le l \\le r \\le n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】文艺平衡树", "background": "", "description": "您需要写一种数据结构（可参考题目标题），来维护一个有序数列。  \n\n其中需要提供以下操作：翻转一个区间，例如原有序序列是 $5\\ 4\\ 3\\ 2\\ 1$，翻转区间是 $[2,4]$ 的话，结果是 $5\\ 2\\ 3\\ 4\\ 1$。\n", "inputFormat": "第一行两个正整数 $n,m$，表示序列长度与操作个数。序列中第 $i$ 项初始为 $i$。  \n接下来 $m$ 行，每行两个正整数 $l,r$，表示翻转的区间。\n", "outputFormat": "输出一行 $n$ 个正整数，表示原始序列经过 $m$ 次变换后的结果。\n", "hint": "【数据范围】  \n对于 $100\\%$ 的数据，$1 \\le n, m \\leq 100000 $，$1 \\le l \\le r \\le n$。\n", "locale": "zh-CN"}}}
{"pid": "P3392", "type": "P", "difficulty": 2, "samples": [["4 5\nWRWRW\nBWRWB\nWRWRW\nRWBWR", "11"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "2016", "枚举", "洛谷月赛"], "title": "涂条纹", "background": "", "description": "只要一个由 $N \\times M$ 个小方块组成的旗帜符合如下规则，就是合法的图案。\n\n- 从最上方若干行（至少一行）的格子全部是白色的；\n- 接下来若干行（至少一行）的格子全部是蓝色的；\n- 剩下的行（至少一行）全部是红色的；\n\n现有一个棋盘状的布，分成了 $N$ 行 $M$ 列的格子，每个格子是白色蓝色红色之一，小 a 希望把这个布改成合法图案，方法是在一些格子上涂颜料，盖住之前的颜色。\n\n小 A 很懒，希望涂最少的格子，使这块布成为一个合法的图案。", "inputFormat": "第一行是两个整数 $N,M$。\n\n接下来 $N$ 行是一个矩阵，矩阵的每一个小方块是 `W`（白），`B`（蓝），`R`（红）中的一个。", "outputFormat": "一个整数，表示至少需要涂多少块。\n", "hint": "### 样例解释\n\n目标状态是：\n\n```plain\nWWWWW\nBBBBB\nRRRRR\nRRRRR\n```\n一共需要改 $11$ 个格子。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，$N,M \\leq 50$。", "locale": "zh-CN", "translations": {"en": {"title": "Painting Stripes", "background": "", "description": "As long as a flag composed of $N \\times M$ small squares meets the following rules, it is a valid pattern.\n- All cells in the top several rows (at least one row) are white.\n- The next several rows (at least one row) are blue.\n- The remaining rows (at least one row) are red.\n\nThere is a cloth divided into $N$ rows and $M$ columns of cells, where each cell is one of white, blue, or red. Xiao A hopes to turn this cloth into a valid pattern by painting some cells to cover their previous colors.\n\nXiao A is lazy and wants to repaint the fewest cells so that the cloth becomes a valid pattern.", "inputFormat": "The first line contains two integers $N, M$.\n\nEach of the next $N$ lines is a string of length $M$, where each character is one of `W` (white), `B` (blue), or `R` (red).", "outputFormat": "A single integer, the minimum number of cells that need to be repainted.", "hint": "### Sample Explanation\n\nTarget state is:\n\n```plain\nWWWWW\nBBBBB\nRRRRR\nRRRRR\n```\nIn total, $11$ cells need to be changed.\n\n### Constraints\n\nFor $100\\%$ of the testdata, $N, M \\leq 50$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "涂条纹", "background": "", "description": "只要一个由 $N \\times M$ 个小方块组成的旗帜符合如下规则，就是合法的图案。\n\n- 从最上方若干行（至少一行）的格子全部是白色的；\n- 接下来若干行（至少一行）的格子全部是蓝色的；\n- 剩下的行（至少一行）全部是红色的；\n\n现有一个棋盘状的布，分成了 $N$ 行 $M$ 列的格子，每个格子是白色蓝色红色之一，小 a 希望把这个布改成合法图案，方法是在一些格子上涂颜料，盖住之前的颜色。\n\n小 A 很懒，希望涂最少的格子，使这块布成为一个合法的图案。", "inputFormat": "第一行是两个整数 $N,M$。\n\n接下来 $N$ 行是一个矩阵，矩阵的每一个小方块是 `W`（白），`B`（蓝），`R`（红）中的一个。", "outputFormat": "一个整数，表示至少需要涂多少块。\n", "hint": "### 样例解释\n\n目标状态是：\n\n```plain\nWWWWW\nBBBBB\nRRRRR\nRRRRR\n```\n一共需要改 $11$ 个格子。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，$N,M \\leq 50$。", "locale": "zh-CN"}}}
{"pid": "P3393", "type": "P", "difficulty": 4, "samples": [["13 21 1 1\n1000 6000\n7\n1 2\n3 7\n2 4\n5 8\n8 9\n2 5\n3 4\n4 7\n9 10\n10 11\n5 9\n7 12\n3 6\n4 5\n1 3\n11 12\n6 7\n8 11\n6 13\n7 8\n12 13", "11000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2016", "洛谷原创", "广度优先搜索 BFS", "最短路", "洛谷月赛"], "title": "逃离僵尸岛", "background": "", "description": "小 a 住的国家被僵尸侵略了！小 a 打算逃离到该国唯一的国际空港逃出这个国家。\n\n\n该国有 $N$ 个城市，城市之间有道路相连。一共有 $M$ 条双向道路。保证没有自环和重边。\n\n\n其中 $K$ 个城市已经被僵尸控制了，如果贸然闯入就会被感染 TAT...所以不能进入。由其中任意城市经过不超过 $S$ 条道路就可以到达的别的城市，就是危险城市。换句话说只要某个城市到任意被僵尸控制的城市距离不超过 $S$，就是危险的。\n\n小 a 住在 $1$ 号城市，国际空港在 $N$ 号城市，这两座城市没有被侵略。小a走每一段道路（从一个城市直接到达另外一个城市）得花一整个白天，所以晚上要住旅店。安全的的城市旅馆比较便宜要 $P$ 元，而被危险的城市，旅馆要进行安保措施，所以会变贵，为 $Q$ 元。所有危险的城市的住宿价格一样，安全的城市也是。在 $1$ 号城市和 $N$ 城市，不需要住店。\n\n\n小 a 比较抠门，所以他希望知道从 $1$ 号城市到 $N$ 号城市所需要的最小花费。\n\n输入数据保证存在路径，可以成功逃离。输入数据保证他可以逃离成功。", "inputFormat": "第一行 4 个整数 $N,M,K,S$。\n\n第二行两个整数 $P,Q$。\n\n接下来 $K$ 行，每行一个整数 $c_i$，表示僵尸侵占的城市编号。\n\n接下来 $M$ 行，$a_i,b_i$，表示一条无向边。\n", "outputFormat": "一个整数表示最低花费。", "hint": " ![](https://cdn.luogu.com.cn/upload/pic/2681.png) \n\n对于 $20\\%$ 数据，$N\\le 50$。\n\n对于 $100\\%$ 数据，$2\\le N\\le 10^5$，$1\\le M\\le 2\\times 10^5$，$0\\le K\\le N - 2$，$0\\le S\\le 10^5$，$1\\le P< Q\\le 10^5$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Escape from Zombie Island", "background": "", "description": "The country where Xiao A lives has been invaded by zombies! Xiao A plans to escape the country via the only international airport.\n\nThe country has $N$ cities connected by roads. There are $M$ bidirectional roads. There are no self-loops or multiple edges.\n\nAmong them, $K$ cities have already been taken over by zombies. Entering any such city will result in infection, so these cities cannot be entered. Any city that can be reached from any zombie-controlled city by traversing at most $S$ roads is considered dangerous. In other words, if a city’s distance to any zombie-controlled city is at most $S$, then it is dangerous.\n\nXiao A lives in city $1$, the international airport is in city $N$, and these two cities are not invaded. Xiao A spends an entire day to traverse each single road (moving directly from one city to another), so he must stay at an inn at night. Inns in safe cities are cheaper and cost $P$, while inns in dangerous cities need extra security measures and thus cost $Q$. All dangerous cities share the same lodging price, and so do all safe cities. In cities $1$ and $N$, no lodging is required.\n\nXiao A is frugal, so he wants to know the minimum cost to travel from city $1$ to city $N$.\n\nThe input guarantees that there exists a path and that he can successfully escape.", "inputFormat": "- The first line contains $4$ integers $N, M, K, S$.\n- The second line contains two integers $P, Q$.\n- The next $K$ lines each contain one integer $c_i$, the index of a zombie-controlled city.\n- The next $M$ lines each contain two integers $a_i, b_i$, indicating an undirected edge.", "outputFormat": "Output a single integer, the minimum total cost.", "hint": "![](https://cdn.luogu.com.cn/upload/pic/2681.png) \n\n- For $20\\%$ of the testdata, $N \\le 50$.\n- For $100\\%$ of the testdata, $2 \\le N \\le 10^5$, $1 \\le M \\le 2 \\times 10^5$, $0 \\le K \\le N - 2$, $0 \\le S \\le 10^5$, $1 \\le P < Q \\le 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "逃离僵尸岛", "background": "", "description": "小 a 住的国家被僵尸侵略了！小 a 打算逃离到该国唯一的国际空港逃出这个国家。\n\n\n该国有 $N$ 个城市，城市之间有道路相连。一共有 $M$ 条双向道路。保证没有自环和重边。\n\n\n其中 $K$ 个城市已经被僵尸控制了，如果贸然闯入就会被感染 TAT...所以不能进入。由其中任意城市经过不超过 $S$ 条道路就可以到达的别的城市，就是危险城市。换句话说只要某个城市到任意被僵尸控制的城市距离不超过 $S$，就是危险的。\n\n小 a 住在 $1$ 号城市，国际空港在 $N$ 号城市，这两座城市没有被侵略。小a走每一段道路（从一个城市直接到达另外一个城市）得花一整个白天，所以晚上要住旅店。安全的的城市旅馆比较便宜要 $P$ 元，而被危险的城市，旅馆要进行安保措施，所以会变贵，为 $Q$ 元。所有危险的城市的住宿价格一样，安全的城市也是。在 $1$ 号城市和 $N$ 城市，不需要住店。\n\n\n小 a 比较抠门，所以他希望知道从 $1$ 号城市到 $N$ 号城市所需要的最小花费。\n\n输入数据保证存在路径，可以成功逃离。输入数据保证他可以逃离成功。", "inputFormat": "第一行 4 个整数 $N,M,K,S$。\n\n第二行两个整数 $P,Q$。\n\n接下来 $K$ 行，每行一个整数 $c_i$，表示僵尸侵占的城市编号。\n\n接下来 $M$ 行，$a_i,b_i$，表示一条无向边。\n", "outputFormat": "一个整数表示最低花费。", "hint": " ![](https://cdn.luogu.com.cn/upload/pic/2681.png) \n\n对于 $20\\%$ 数据，$N\\le 50$。\n\n对于 $100\\%$ 数据，$2\\le N\\le 10^5$，$1\\le M\\le 2\\times 10^5$，$0\\le K\\le N - 2$，$0\\le S\\le 10^5$，$1\\le P< Q\\le 10^5$。\n", "locale": "zh-CN"}}}
{"pid": "P3395", "type": "P", "difficulty": 3, "samples": [["2\n\n2\n1 1\n2 2\n\n5\n3 3\n3 2\n3 1\n1 2\n1 3\n1 4\n1 5\n2 2", "Yes\nYes"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288]}, "tags": ["模拟", "洛谷原创", "O2优化", "广度优先搜索 BFS", "洛谷比赛"], "title": "路障", "background": "", "description": "B 君站在一个 $n\\times n$ 的棋盘上。最开始，B君站在 $(1,1)$ 这个点，他要走到 $(n,n)$ 这个点。\n\nB 君每秒可以向上下左右的某个方向移动一格，但是很不妙，C 君打算阻止 B 君的计划。\n\n**每秒结束的时刻**，C 君 会在 $(x,y)$ 上摆一个路障。B 君不能走在路障上。\n\nB 君拿到了 C 君准备在哪些点放置路障。所以现在你需要判断，B 君能否成功走到 $(n,n)$。\n\n**保证数据足够弱：也就是说，无需考虑“走到某处然后被一个路障砸死”的情况，因为答案不会出现此类情况。**", "inputFormat": "首先是一个正整数 $T$，表示数据组数。\n\n对于每一组数据：\n\n第一行，一个正整数 $n$。\n\n接下来 $2n-2$ 行，每行两个正整数 $x$ 和 $y$，意义是在那一秒结束后，$(x,y)$ 将被摆上路障。", "outputFormat": "对于每一组数据，输出 `Yes` 或 `No`，回答 B 君能否走到 $(n,n)$。", "hint": "样例解释：\n\n以下 0 表示能走，x 表示不能走，B 表示 B 君现在的位置。从左往右表示时间。\n\n```\nCase 1:\n0 0    0 0    0 B  (已经走到了)\nB 0    x B    x 0\n```\n```\nCase 2:\n0 0 0 0 0    0 0 0 0 0    0 0 0 0 0    0 0 0 0 0\n0 0 0 0 0    0 0 0 0 0    0 0 0 0 0    0 0 0 0 0\n0 0 0 0 0    0 0 x 0 0    0 0 x 0 0    0 0 x 0 0\n0 0 0 0 0    0 0 0 0 0    0 0 x 0 0    0 0 x 0 0\nB 0 0 0 0    0 B 0 0 0    0 0 B 0 0    0 0 x B 0 ......(B君可以走到终点)\n```\n\n数据规模：\n\n防止骗分，数据保证全部手造。\n\n对于 $20\\%$ 的数据，有 $n\\le3$。\n\n对于 $60\\%$ 的数据，有 $n\\le500$。\n\n对于 $100\\%$ 的数据，有 $n\\le1000$。\n\n对于 $100\\%$ 的数据，有 $T\\le10$。", "locale": "zh-CN", "translations": {"en": {"title": "Roadblocks", "background": "# Description\n\nB stands on an $n \\times n$ chessboard. At the beginning, B is at $(1,1)$ and wants to go to $(n,n)$.\n\nEach second, B can move one cell in one of the four directions: up, down, left, or right. However, C plans to stop B.\n\nAt the end of each second, C will place a roadblock at $(x,y)$. B cannot step on a roadblock.\n\nB knows in advance where C will place the roadblocks. Now you need to determine whether B can reach $(n,n)$.\n\nIt is guaranteed that the testdata is weak enough: that is, you do not need to consider the case where B moves to some cell and then gets killed by a roadblock dropping onto that cell, because such cases will not appear in the answers.", "description": "", "inputFormat": "", "outputFormat": "For each test case, output `Yes` or `No`, answering whether B can reach $(n,n)$.", "hint": "Sample explanation:\n\nHere 0 means passable, x means blocked, and B means B's current position. From left to right represents time.\n\n```\nCase 1:\n0 0    0 0    0 B  (already reached)\nB 0    x B    x 0\n```\n```\nCase 2:\n0 0 0 0 0    0 0 0 0 0    0 0 0 0 0    0 0 0 0 0\n0 0 0 0 0    0 0 0 0 0    0 0 0 0 0    0 0 0 0 0\n0 0 0 0 0    0 0 x 0 0    0 0 x 0 0    0 0 x 0 0\n0 0 0 0 0    0 0 0 0 0    0 0 x 0 0    0 0 x 0 0\nB 0 0 0 0    0 B 0 0 0    0 0 B 0 0    0 0 x B 0 ......(B can reach the target)\n```\n\nConstraints:\n\n- To prevent score farming, all testdata are handcrafted.\n- For $20\\%$ of the testdata, $n \\le 3$.\n- For $60\\%$ of the testdata, $n \\le 500$.\n- For $100\\%$ of the testdata, $n \\le 1000$.\n- For $100\\%$ of the testdata, $T \\le 10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "路障", "background": "", "description": "B 君站在一个 $n\\times n$ 的棋盘上。最开始，B君站在 $(1,1)$ 这个点，他要走到 $(n,n)$ 这个点。\n\nB 君每秒可以向上下左右的某个方向移动一格，但是很不妙，C 君打算阻止 B 君的计划。\n\n**每秒结束的时刻**，C 君 会在 $(x,y)$ 上摆一个路障。B 君不能走在路障上。\n\nB 君拿到了 C 君准备在哪些点放置路障。所以现在你需要判断，B 君能否成功走到 $(n,n)$。\n\n**保证数据足够弱：也就是说，无需考虑“走到某处然后被一个路障砸死”的情况，因为答案不会出现此类情况。**", "inputFormat": "首先是一个正整数 $T$，表示数据组数。\n\n对于每一组数据：\n\n第一行，一个正整数 $n$。\n\n接下来 $2n-2$ 行，每行两个正整数 $x$ 和 $y$，意义是在那一秒结束后，$(x,y)$ 将被摆上路障。", "outputFormat": "对于每一组数据，输出 `Yes` 或 `No`，回答 B 君能否走到 $(n,n)$。", "hint": "样例解释：\n\n以下 0 表示能走，x 表示不能走，B 表示 B 君现在的位置。从左往右表示时间。\n\n```\nCase 1:\n0 0    0 0    0 B  (已经走到了)\nB 0    x B    x 0\n```\n```\nCase 2:\n0 0 0 0 0    0 0 0 0 0    0 0 0 0 0    0 0 0 0 0\n0 0 0 0 0    0 0 0 0 0    0 0 0 0 0    0 0 0 0 0\n0 0 0 0 0    0 0 x 0 0    0 0 x 0 0    0 0 x 0 0\n0 0 0 0 0    0 0 0 0 0    0 0 x 0 0    0 0 x 0 0\nB 0 0 0 0    0 B 0 0 0    0 0 B 0 0    0 0 x B 0 ......(B君可以走到终点)\n```\n\n数据规模：\n\n防止骗分，数据保证全部手造。\n\n对于 $20\\%$ 的数据，有 $n\\le3$。\n\n对于 $60\\%$ 的数据，有 $n\\le500$。\n\n对于 $100\\%$ 的数据，有 $n\\le1000$。\n\n对于 $100\\%$ 的数据，有 $T\\le10$。", "locale": "zh-CN"}}}
{"pid": "P3396", "type": "P", "difficulty": 4, "samples": [["10 5\n1 2 3 4 5 6 7 8 9 10\nA 2 1\nC 1 20\nA 3 1\nC 5 1\nA 5 0", "25\n41\n11"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["洛谷原创", "O2优化", "根号分治", "洛谷比赛"], "title": "哈希冲突", "background": "众所周知，模数的 hash 会产生冲突。例如，如果模的数 $p=7$，那么 $4$ 和 $11$ 便冲突了。", "description": "B 君对 hash 冲突很感兴趣。他会给出一个正整数序列 $\\text{value}$。\n\n自然，B 君会把这些数据存进 hash 池。$\\text{value}_k$ 会被存进 $(k \\bmod p)$ 这个池。这样就能造成很多冲突。\n\n\nB 君会给定许多个 $p$ 和 $x$，询问在模 $p$ 时，$x$ 这个池内 **数的总和**。\n\n另外，B 君会随时更改 $\\text{value}_k$。每次更改立即生效。\n\n保证 $1\\leq p<n$。", "inputFormat": "第一行，两个正整数 $n$, $m$，其中 $n$ 代表序列长度，$m$ 代表 B 君的操作次数。\n\n\n第一行，$n$ 个正整数，代表初始序列。\n\n\n接下来 $m$ 行，首先是一个字符 $\\text{cmd}$，然后是两个整数 $x,y$。\n\n- 若 $\\text{cmd}=\\text{A}$，则询问在模 $x$ 时，$y$ 池内 **数的总和**。\n\n- 若 $\\text{cmd}=\\text{C}$，则将 $\\text{value}_x$ 修改为 $y$。", "outputFormat": "对于每个询问输出一个正整数，进行回答。", "hint": "#### 样例解释 \n\n`A 2 1` 的答案是 `1+3+5+7+9=25`。\n\n`A 3 1` 的答案是 `20+4+7+10=41`。\n\n`A 5 0` 的答案是 `1+10=11`。\n\n#### 数据规模\n\n对于 $10\\%$的数据，有 $n\\leq 1000$，$m\\leq 1000$。\n\n对于 $60\\%$ 的数据，有 $n\\leq 100000$，$m\\leq 100000$。\n\n对于 $100\\%$ 的数据，有 $n\\leq 150000$，$m\\leq 150000$。\n\n保证所有数据合法，且 $1\\leq \\mathrm{value}_i \\leq 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "Hash Collisions", "background": "As is well known, modular hashing produces collisions. For example, if the modulus $p=7$, then $4$ and $11$ collide.", "description": "B is very interested in hash collisions. He will give a sequence of positive integers $\\text{value}$.\n\nNaturally, B will store these data into hash buckets. $\\text{value}_k$ will be stored in the bucket $(k \\bmod p)$. This creates many collisions.\n\nB will give many pairs $p$ and $x$, asking for the sum of numbers in bucket $x$ under modulus $p$.\n\nIn addition, B may change $\\text{value}_k$ at any time. Each change takes effect immediately.\n\nIt is guaranteed that $1 \\leq p < n$.", "inputFormat": "The first line contains two positive integers $n$, $m$, where $n$ is the length of the sequence, and $m$ is the number of operations by B.\n\nThe second line contains $n$ positive integers, representing the initial sequence.\n\nThen $m$ lines follow. Each line starts with a character $\\text{cmd}$, followed by two integers $x$, $y$.\n- If $\\text{cmd}=\\text{A}$, query the sum of numbers in bucket $y$ under modulus $x$.\n- If $\\text{cmd}=\\text{C}$, change $\\text{value}_x$ to $y$.", "outputFormat": "For each query, output one positive integer as the answer.", "hint": "#### Sample Explanation\n\n`A 2 1` has the answer `1+3+5+7+9=25`.\n\n`A 3 1` has the answer `20+4+7+10=41`.\n\n`A 5 0` has the answer `1+10=11`.\n\n#### Constraints\n\nFor $10\\%$ of the testdata, $n \\leq 1000$, $m \\leq 1000$.\n\nFor $60\\%$ of the testdata, $n \\leq 100000$, $m \\leq 100000$.\n\nFor $100\\%$ of the testdata, $n \\leq 150000$, $m \\leq 150000$.\n\nAll testdata are valid, and $1 \\leq \\mathrm{value}_i \\leq 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "哈希冲突", "background": "众所周知，模数的 hash 会产生冲突。例如，如果模的数 $p=7$，那么 $4$ 和 $11$ 便冲突了。", "description": "B 君对 hash 冲突很感兴趣。他会给出一个正整数序列 $\\text{value}$。\n\n自然，B 君会把这些数据存进 hash 池。$\\text{value}_k$ 会被存进 $(k \\bmod p)$ 这个池。这样就能造成很多冲突。\n\n\nB 君会给定许多个 $p$ 和 $x$，询问在模 $p$ 时，$x$ 这个池内 **数的总和**。\n\n另外，B 君会随时更改 $\\text{value}_k$。每次更改立即生效。\n\n保证 $1\\leq p<n$。", "inputFormat": "第一行，两个正整数 $n$, $m$，其中 $n$ 代表序列长度，$m$ 代表 B 君的操作次数。\n\n\n第一行，$n$ 个正整数，代表初始序列。\n\n\n接下来 $m$ 行，首先是一个字符 $\\text{cmd}$，然后是两个整数 $x,y$。\n\n- 若 $\\text{cmd}=\\text{A}$，则询问在模 $x$ 时，$y$ 池内 **数的总和**。\n\n- 若 $\\text{cmd}=\\text{C}$，则将 $\\text{value}_x$ 修改为 $y$。", "outputFormat": "对于每个询问输出一个正整数，进行回答。", "hint": "#### 样例解释 \n\n`A 2 1` 的答案是 `1+3+5+7+9=25`。\n\n`A 3 1` 的答案是 `20+4+7+10=41`。\n\n`A 5 0` 的答案是 `1+10=11`。\n\n#### 数据规模\n\n对于 $10\\%$的数据，有 $n\\leq 1000$，$m\\leq 1000$。\n\n对于 $60\\%$ 的数据，有 $n\\leq 100000$，$m\\leq 100000$。\n\n对于 $100\\%$ 的数据，有 $n\\leq 150000$，$m\\leq 150000$。\n\n保证所有数据合法，且 $1\\leq \\mathrm{value}_i \\leq 1000$。", "locale": "zh-CN"}}}
{"pid": "P3397", "type": "P", "difficulty": 2, "samples": [["5 3\n2 2 3 3\n3 3 5 5\n1 2 1 4", "0 1 1 1 0\n0 1 1 0 0\n0 1 2 1 1\n0 0 1 1 1\n0 0 1 1 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["洛谷原创", "枚举", "前缀和", "差分", "洛谷比赛"], "title": "地毯", "background": "[加强版](/problem/P13787)", "description": "在 $n\\times n$ 的格子上有 $m$ 个地毯。\n\n给出这些地毯的信息，问每个点被多少个地毯覆盖。", "inputFormat": "第一行，两个正整数 $n,m$。意义如题所述。\n\n接下来 $m$ 行，每行两个坐标 $(x_1,y_1)$ 和 $(x_2,y_2)$，代表一块地毯，左上角是 $(x_1,y_1)$，右下角是 $(x_2,y_2)$。", "outputFormat": "输出 $n$ 行，每行 $n$ 个正整数。\n\n第 $i$ 行第 $j$ 列的正整数表示 $(i,j)$ 这个格子被多少个地毯覆盖。", "hint": "### 样例解释\n\n覆盖第一个地毯后：\n\n|$0$|$0$|$0$|$0$|$0$|\n|:-:|:-:|:-:|:-:|:-:|\n|$0$|$1$|$1$|$0$|$0$|\n|$0$|$1$|$1$|$0$|$0$|\n|$0$|$0$|$0$|$0$|$0$|\n|$0$|$0$|$0$|$0$|$0$|\n\n覆盖第一、二个地毯后：\n\n|$0$|$0$|$0$|$0$|$0$|\n|:-:|:-:|:-:|:-:|:-:|\n|$0$|$1$|$1$|$0$|$0$|\n|$0$|$1$|$2$|$1$|$1$|\n|$0$|$0$|$1$|$1$|$1$|\n|$0$|$0$|$1$|$1$|$1$|\n\n覆盖所有地毯后：\n\n|$0$|$1$|$1$|$1$|$0$|\n|:-:|:-:|:-:|:-:|:-:|\n|$0$|$1$|$1$|$0$|$0$|\n|$0$|$1$|$2$|$1$|$1$|\n|$0$|$0$|$1$|$1$|$1$|\n|$0$|$0$|$1$|$1$|$1$|\n\n---\n\n### 数据范围\n\n对于 $20\\%$ 的数据，有 $n\\le 50$，$m\\le 100$。\n\n对于 $100\\%$ 的数据，有 $n,m\\le 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "Carpets", "background": "[Enhanced Version](/problem/P13787)", "description": "On an $n \\times n$ grid, there are $m$ carpets. Given the information of these carpets, determine how many carpets cover each cell.", "inputFormat": "The first line contains two positive integers $n, m$, as described above.\nThen follow $m$ lines. Each line gives two coordinates $(x_1,y_1)$ and $(x_2,y_2)$, representing a carpet whose top-left corner is $(x_1,y_1)$ and bottom-right corner is $(x_2,y_2)$.", "outputFormat": "Output $n$ lines, each containing $n$ non-negative integers.\nThe integer in row $i$ and column $j$ denotes how many carpets cover the cell $(i,j)$.", "hint": "### Sample Explanation\n\nAfter covering the first carpet:\n\n|$0$|$0$|$0$|$0$|$0$|\n|:-:|:-:|:-:|:-:|:-:|\n|$0$|$1$|$1$|$0$|$0$|\n|$0$|$1$|$1$|$0$|$0$|\n|$0$|$0$|$0$|$0$|$0$|\n|$0$|$0$|$0$|$0$|$0$|\n\nAfter covering the first and second carpets:\n\n|$0$|$0$|$0$|$0$|$0$|\n|:-:|:-:|:-:|:-:|:-:|\n|$0$|$1$|$1$|$0$|$0$|\n|$0$|$1$|$2$|$1$|$1$|\n|$0$|$0$|$1$|$1$|$1$|\n|$0$|$0$|$1$|$1$|$1$|\n\nAfter covering all carpets:\n\n|$0$|$1$|$1$|$1$|$0$|\n|:-:|:-:|:-:|:-:|:-:|\n|$0$|$1$|$1$|$0$|$0$|\n|$0$|$1$|$2$|$1$|$1$|\n|$0$|$0$|$1$|$1$|$1$|\n|$0$|$0$|$1$|$1$|$1$|\n\n---\n\n### Constraints\n\nFor $20\\%$ of the testdata, $n \\le 50$, $m \\le 100$.\nFor $100\\%$ of the testdata, $n, m \\le 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "地毯", "background": "[加强版](/problem/P13787)", "description": "在 $n\\times n$ 的格子上有 $m$ 个地毯。\n\n给出这些地毯的信息，问每个点被多少个地毯覆盖。", "inputFormat": "第一行，两个正整数 $n,m$。意义如题所述。\n\n接下来 $m$ 行，每行两个坐标 $(x_1,y_1)$ 和 $(x_2,y_2)$，代表一块地毯，左上角是 $(x_1,y_1)$，右下角是 $(x_2,y_2)$。", "outputFormat": "输出 $n$ 行，每行 $n$ 个正整数。\n\n第 $i$ 行第 $j$ 列的正整数表示 $(i,j)$ 这个格子被多少个地毯覆盖。", "hint": "### 样例解释\n\n覆盖第一个地毯后：\n\n|$0$|$0$|$0$|$0$|$0$|\n|:-:|:-:|:-:|:-:|:-:|\n|$0$|$1$|$1$|$0$|$0$|\n|$0$|$1$|$1$|$0$|$0$|\n|$0$|$0$|$0$|$0$|$0$|\n|$0$|$0$|$0$|$0$|$0$|\n\n覆盖第一、二个地毯后：\n\n|$0$|$0$|$0$|$0$|$0$|\n|:-:|:-:|:-:|:-:|:-:|\n|$0$|$1$|$1$|$0$|$0$|\n|$0$|$1$|$2$|$1$|$1$|\n|$0$|$0$|$1$|$1$|$1$|\n|$0$|$0$|$1$|$1$|$1$|\n\n覆盖所有地毯后：\n\n|$0$|$1$|$1$|$1$|$0$|\n|:-:|:-:|:-:|:-:|:-:|\n|$0$|$1$|$1$|$0$|$0$|\n|$0$|$1$|$2$|$1$|$1$|\n|$0$|$0$|$1$|$1$|$1$|\n|$0$|$0$|$1$|$1$|$1$|\n\n---\n\n### 数据范围\n\n对于 $20\\%$ 的数据，有 $n\\le 50$，$m\\le 100$。\n\n对于 $100\\%$ 的数据，有 $n,m\\le 1000$。", "locale": "zh-CN"}}}
{"pid": "P3398", "type": "P", "difficulty": 4, "samples": [["5 5\n2 5\n4 2\n1 3\n1 4\n5 1 5 1\n2 2 1 4\n4 1 3 4\n3 1 1 5\n3 5 1 4", "Y\nN\nY\nY\nY"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2016", "倍增", "洛谷原创", "最近公共祖先 LCA", "树链剖分", "洛谷月赛"], "title": "仓鼠找 sugar", "background": "", "description": "小仓鼠的和他的基（mei）友（zi）sugar 住在地下洞穴中，每个节点的编号为 $1\\sim n$。地下洞穴是一个树形结构。这一天小仓鼠打算从从他的卧室（$a$）到餐厅（$b$），而他的基友同时要从他的卧室（$c$）到图书馆（$d$）。他们都会走最短路径。现在小仓鼠希望知道，有没有可能在某个地方，可以碰到他的基友？\n\n\n小仓鼠那么弱，还要天天被 zzq 大爷虐，请你快来救救他吧！\n", "inputFormat": "第一行两个正整数 $n$ 和 $q$，表示这棵树节点的个数和询问的个数。\n\n接下来 $n-1$ 行，每行两个正整数 $u$ 和 $v$，表示节点 $u$ 到节点 $v$ 之间有一条边。\n\n接下来 $q$ 行，每行四个正整数 $a$、$b$、$c$ 和 $d$，表示节点编号，也就是一次询问，其意义如上。\n", "outputFormat": "对于每个询问，如果有公共点，输出大写字母 `Y`；否则输出`N`。\n", "hint": "**本题时限 1s，内存限制 128M，因新评测机速度较为接近 NOIP 评测机速度，请注意常数问题带来的影响。**\n\n\n$20\\%$ 的数据 $n, q\\le200$。\n\n$40\\%$ 的数据 $n, q\\le 2\\times10^3$。\n\n$70\\%$ 的数据 $n, q\\le 5\\times10^4$。\n\n$100\\%$ 的数据 $1\\le n, q\\le10^5$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Hamster Looking for sugar", "background": "", "description": "The little hamster and his buddy sugar live in an underground cave, where each node is numbered $1 \\sim n$. The cave forms a tree. One day, the little hamster plans to go from his bedroom ($a$) to the dining room ($b$), while his buddy simultaneously goes from his bedroom ($c$) to the library ($d$). They both take the shortest paths. Now the little hamster wants to know whether it is possible for them to meet somewhere along the way.\n\nThe little hamster is so weak and even gets abused by Master zzq every day. Please come save him!", "inputFormat": "The first line contains two positive integers $n$ and $q$, representing the number of nodes in the tree and the number of queries.\n\nThe next $n - 1$ lines each contain two positive integers $u$ and $v$, indicating that there is an edge between nodes $u$ and $v$.\n\nThe next $q$ lines each contain four positive integers $a$, $b$, $c$, and $d$, representing a query as described above.", "outputFormat": "For each query, if there exists a common point, output the uppercase letter `Y`; otherwise output `N`.", "hint": "Time limit 1 s, memory limit 128 MB. Since the new judge is close to the NOIP judge in speed, please be aware of the impact of constant-factor overhead.\n\nFor 20% of the testdata, $n, q \\le 200$.\n\nFor 40% of the testdata, $n, q \\le 2 \\times 10^3$.\n\nFor 70% of the testdata, $n, q \\le 5 \\times 10^4$.\n\nFor 100% of the testdata, $1 \\le n, q \\le 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "仓鼠找 sugar", "background": "", "description": "小仓鼠的和他的基（mei）友（zi）sugar 住在地下洞穴中，每个节点的编号为 $1\\sim n$。地下洞穴是一个树形结构。这一天小仓鼠打算从从他的卧室（$a$）到餐厅（$b$），而他的基友同时要从他的卧室（$c$）到图书馆（$d$）。他们都会走最短路径。现在小仓鼠希望知道，有没有可能在某个地方，可以碰到他的基友？\n\n\n小仓鼠那么弱，还要天天被 zzq 大爷虐，请你快来救救他吧！\n", "inputFormat": "第一行两个正整数 $n$ 和 $q$，表示这棵树节点的个数和询问的个数。\n\n接下来 $n-1$ 行，每行两个正整数 $u$ 和 $v$，表示节点 $u$ 到节点 $v$ 之间有一条边。\n\n接下来 $q$ 行，每行四个正整数 $a$、$b$、$c$ 和 $d$，表示节点编号，也就是一次询问，其意义如上。\n", "outputFormat": "对于每个询问，如果有公共点，输出大写字母 `Y`；否则输出`N`。\n", "hint": "**本题时限 1s，内存限制 128M，因新评测机速度较为接近 NOIP 评测机速度，请注意常数问题带来的影响。**\n\n\n$20\\%$ 的数据 $n, q\\le200$。\n\n$40\\%$ 的数据 $n, q\\le 2\\times10^3$。\n\n$70\\%$ 的数据 $n, q\\le 5\\times10^4$。\n\n$100\\%$ 的数据 $1\\le n, q\\le10^5$。\n", "locale": "zh-CN"}}}
{"pid": "P3399", "type": "P", "difficulty": 3, "samples": [["3 5\n10\n25\n15\n50\n30\n15\n40\n30", "1125"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2016", "洛谷月赛"], "title": "丝绸之路", "background": "张骞于公元前 138 年曾历尽艰险出使过西域。加强了汉朝与西域各国的友好往来。从那以后，一队队骆驼商队在这漫长的商贸大道上行进，他们越过崇山峻岭，将中国的先进技术带向中亚、西亚和欧洲，将那里的香料、良马传进了我国。每当人们凝望荒凉的大漠孤烟，无不引起对往日商贸、文化繁荣的遐想……", "description": "小仓鼠带着货物，从中国送到安息，丝绸之路包括起点和终点一共有 $N+1$ 个城市，$0$ 号城市是起点长安，$N$ 号城市是终点巴格达。要求不超过 $M$ 天内必须到达终点。一天的时间可以从一个城市到连续的下一个城市。从 $i-1$ 城市到 $i$ 城市距离是 $D_i$。\n\n大家都知道，连续赶路是很辛苦的，所以小仓鼠可以在一个城市时，可以有以下选择：\n\n- 移动：向下一个城市进发\n\n- 休息：呆在原来的城市不动\n\n沙漠天气变化无常，在天气很不好时，前进会遇到很多困难。我们把 $M$ 天的第 $j(1\\le j \\le M)$ 天的气候恶劣值记为 $C_j$。从 $i-1$ 城市移动到 $i$ 城市在第 $j$ 天进发时，需要耗费 $D_i\\times C_j$ 的疲劳度。\n\n不过小仓鼠还是有选择权的，可以避开比较恶劣的天气，休息是不会消耗疲劳值的。现在他想知道整个行程最少要消耗多少疲劳值。", "inputFormat": "第一行 $2$ 个整数 $N$，$M$。\n\n接下来，连续 $N$ 行每行一个整数 $D_j$。\n\n连续 $M$ 行每行一个整数 $C_j$。", "outputFormat": "一个整数，表示最小疲劳度。", "hint": "### 样例解释\n\n第 $1$ 天休息。\n\n第 $2$ 天 $0 \\rightarrow 1$ 疲劳值 $10 \\times 30 = 300$。\n\n第 $3$ 天 $1 \\rightarrow2$ 疲劳值 $25 \\times 15 = 375$。\n\n第 $4$ 天休息。\n\n第 $5$ 天 $2 \\rightarrow3$ 疲劳值 $15 \\times 30 = 450$。\n\n### 数据范围\n\n$1 \\le N \\le M \\le 1000$。\n\n$1 \\le D_i , C_i \\le 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "Silk Road", "background": "In 138 BCE, Zhang Qian braved great hardships to serve as an envoy to the Western Regions, strengthening friendly exchanges between the Han dynasty and various states there. Since then, caravans of camels have traveled along this long trade route. They crossed lofty mountains, bringing China’s advanced technologies to Central Asia, West Asia, and Europe, and brought spices and fine horses from those regions into China. Whenever people gaze upon the desolate desert with a solitary plume of smoke, it evokes imagination of the past prosperity of trade and culture.", "description": "A little hamster is delivering goods from China to Baghdad. The Silk Road has $N+1$ cities including the start and the end. City $0$ is the starting point Chang’an, and city $N$ is the destination Baghdad. The hamster must reach the destination in at most $M$ days. In one day, it is possible to travel from one city to the next consecutive city. The distance from city $i-1$ to city $i$ is $D_i$.\n\nAs everyone knows, traveling continuously is exhausting, so when staying in a city, the hamster has two choices:\n- Move: set off toward the next city.\n- Rest: stay in the current city without moving.\n\nDesert weather is unpredictable. When the weather is bad, moving forward is much more difficult. Let the severity of the weather on the $j$-th day ($1 \\le j \\le M$) be $C_j$. If the hamster moves from city $i-1$ to city $i$ on day $j$, it incurs a fatigue of $D_i \\times C_j$.\n\nHowever, the hamster can choose to avoid worse weather; resting consumes no fatigue. Now it wants to know the minimum total fatigue for the whole trip.", "inputFormat": "The first line contains $2$ integers $N$ and $M$.\n\nThe next $N$ lines each contain one integer $D_j$.\n\nThe next $M$ lines each contain one integer $C_j$.", "outputFormat": "Output a single integer, the minimal total fatigue.", "hint": "### Sample Explanation\n\nRest on day $1$.\n\nOn day $2$, $0 \\rightarrow 1$, fatigue $10 \\times 30 = 300$.\n\nOn day $3$, $1 \\rightarrow 2$, fatigue $25 \\times 15 = 375$.\n\nRest on day $4$.\n\nOn day $5$, $2 \\rightarrow 3$, fatigue $15 \\times 30 = 450$.\n\n### Constraints\n\n$1 \\le N \\le M \\le 1000$.\n\n$1 \\le D_i, C_i \\le 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "丝绸之路", "background": "张骞于公元前 138 年曾历尽艰险出使过西域。加强了汉朝与西域各国的友好往来。从那以后，一队队骆驼商队在这漫长的商贸大道上行进，他们越过崇山峻岭，将中国的先进技术带向中亚、西亚和欧洲，将那里的香料、良马传进了我国。每当人们凝望荒凉的大漠孤烟，无不引起对往日商贸、文化繁荣的遐想……", "description": "小仓鼠带着货物，从中国送到安息，丝绸之路包括起点和终点一共有 $N+1$ 个城市，$0$ 号城市是起点长安，$N$ 号城市是终点巴格达。要求不超过 $M$ 天内必须到达终点。一天的时间可以从一个城市到连续的下一个城市。从 $i-1$ 城市到 $i$ 城市距离是 $D_i$。\n\n大家都知道，连续赶路是很辛苦的，所以小仓鼠可以在一个城市时，可以有以下选择：\n\n- 移动：向下一个城市进发\n\n- 休息：呆在原来的城市不动\n\n沙漠天气变化无常，在天气很不好时，前进会遇到很多困难。我们把 $M$ 天的第 $j(1\\le j \\le M)$ 天的气候恶劣值记为 $C_j$。从 $i-1$ 城市移动到 $i$ 城市在第 $j$ 天进发时，需要耗费 $D_i\\times C_j$ 的疲劳度。\n\n不过小仓鼠还是有选择权的，可以避开比较恶劣的天气，休息是不会消耗疲劳值的。现在他想知道整个行程最少要消耗多少疲劳值。", "inputFormat": "第一行 $2$ 个整数 $N$，$M$。\n\n接下来，连续 $N$ 行每行一个整数 $D_j$。\n\n连续 $M$ 行每行一个整数 $C_j$。", "outputFormat": "一个整数，表示最小疲劳度。", "hint": "### 样例解释\n\n第 $1$ 天休息。\n\n第 $2$ 天 $0 \\rightarrow 1$ 疲劳值 $10 \\times 30 = 300$。\n\n第 $3$ 天 $1 \\rightarrow2$ 疲劳值 $25 \\times 15 = 375$。\n\n第 $4$ 天休息。\n\n第 $5$ 天 $2 \\rightarrow3$ 疲劳值 $15 \\times 30 = 450$。\n\n### 数据范围\n\n$1 \\le N \\le M \\le 1000$。\n\n$1 \\le D_i , C_i \\le 1000$。", "locale": "zh-CN"}}}
{"pid": "P3400", "type": "P", "difficulty": 5, "samples": [["3 4\n1 1 1 1\n1 0 1 1\n1 1 0 1", "26"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2016", "洛谷原创", "洛谷月赛", "单调栈"], "title": "仓鼠窝", "background": "", "description": "萌萌哒的 Created equal 是一只小仓鼠，小仓鼠自然有仓鼠窝啦。\n\n仓鼠窝是一个由 $n\\times m$ 个格子组成的行数为 $n$、列数为 $m$ 的矩阵。小仓鼠现在想要知道，这个矩阵中有多少个子矩阵。\n\n比如说有一个 $2\\times 3$ 的矩阵，那么 $1\\times 1$ 的子矩阵有 $6$ 个，$1\\times 2$ 的子矩阵有 $4$ 个，$1\\times 3$ 的子矩阵有 $2$ 个，$2\\times 1$ 的子矩阵有 $3$ 个，$2\\times 2$ 的子矩阵有 $2$ 个，$2\\times 3$ 的子矩阵有 $1$ 个，所以子矩阵共有 $6+4+2+3+2+1=18$ 个。\n\n可是仓鼠窝中有的格子被破坏了。现在小仓鼠想要知道，有多少个内部不含被破坏的格子的子矩阵。\n", "inputFormat": "第一行两个正整数 $n$ 和 $m$，分别表示仓鼠窝的行数 $n$，列数 $m$。\n\n接下来 $n$ 行，每行 $m$ 个数，每个数代表对应的格子，非 $0$ 即 $1$。若为 $0$，表示这个格子被破坏；反之代表这个格子是完好无损的。", "outputFormat": "仅一个正整数，表示未被破坏的子矩阵的个数。\n", "hint": "本题时限 $2\\text{s}$，内存限制 $256\\text{M}$，因新评测机速度较为接近 NOIP 评测机速度，请注意常数问题带来的影响。\n\n|    数据编号     |     $n$       |     $m$      |        特殊性质        |\n| :------------: | :-----------: | :----------: | :--------------------: |\n|     $1, 2, 3$    |       $2$       |       $2$      |           无           |\n|        $4$       |      $10$       |      $10$      |           无           |\n|      $5, 6$      |      $2000$     |     $2000$     |   所有格子均未被破坏     |\n|        $7$       |      $2500$     |     $3000$     |  有且仅有一个格子被破坏  |\n|        $8$       |      $3000$     |     $2500$     |  有且仅有一个格子被破坏  |\n|        $9$       |       $200$     |      $200$     |           无           |\n|   $10, 11, 12$   |       $500$     |      $500$     |           无           |\n|     $13, 14$     |      $1000$     |     $1000$     |           无           |\n|       $15$       |      $1000$     |     $1500$     |           无           |\n|       $16$       |      $2500$     |     $2500$     |           无           |\n|       $17$       |      $2500$     |     $3000$     |           无           |\n|       $18$       |      $3000$     |     $2500$     |           无           |\n|     $19, 20$     |      $3000$     |     $3000$     |           无           |", "locale": "zh-CN", "translations": {"en": {"title": "Hamster Nest", "background": "", "description": "The adorable \"Created equal\" is a little hamster, and of course a little hamster has a hamster nest.\n\nThe nest is an $n\\times m$ matrix with $n$ rows and $m$ columns. The little hamster wants to know how many submatrices this matrix has.\n\nFor example, for a $2\\times 3$ matrix, there are $6$ submatrices of size $1\\times 1$, $4$ of size $1\\times 2$, $2$ of size $1\\times 3$, $3$ of size $2\\times 1$, $2$ of size $2\\times 2$, and $1$ of size $2\\times 3$, so in total there are $6+4+2+3+2+1=18$ submatrices.\n\nHowever, some cells in the nest are damaged. Now the little hamster wants to know how many submatrices contain no damaged cells.", "inputFormat": "The first line contains two positive integers $n$ and $m$, denoting the number of rows $n$ and columns $m$ of the nest.\n\nThen follow $n$ lines, each containing $m$ numbers. Each number is either $0$ or $1$. A $0$ means the cell is damaged; otherwise the cell is intact.", "outputFormat": "Output a single integer: the number of submatrices that are undamaged.", "hint": "The time limit is $2\\text{s}$ and the memory limit is $256\\text{M}$. Since the new judge is close in speed to the NOIP judge, please be mindful of the impact of constant factors.\n\n|   Testdata index   |     $n$     |     $m$     |     Special property     |\n| :----------------: | :---------: | :---------: | :----------------------: |\n|       1, 2, 3      |      2      |      2      |           None           |\n|         4          |     10      |     10      |           None           |\n|        5, 6        |    2000     |    2000     |   All cells undamaged    |\n|         7          |    2500     |    3000     |   Exactly one cell broken |\n|         8          |    3000     |    2500     |   Exactly one cell broken |\n|         9          |     200     |     200     |           None           |\n|      10, 11, 12    |     500     |     500     |           None           |\n|        13, 14      |    1000     |    1000     |           None           |\n|         15         |    1000     |    1500     |           None           |\n|         16         |    2500     |    2500     |           None           |\n|         17         |    2500     |    3000     |           None           |\n|         18         |    3000     |    2500     |           None           |\n|        19, 20      |    3000     |    3000     |           None           |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "仓鼠窝", "background": "", "description": "萌萌哒的 Created equal 是一只小仓鼠，小仓鼠自然有仓鼠窝啦。\n\n仓鼠窝是一个由 $n\\times m$ 个格子组成的行数为 $n$、列数为 $m$ 的矩阵。小仓鼠现在想要知道，这个矩阵中有多少个子矩阵。\n\n比如说有一个 $2\\times 3$ 的矩阵，那么 $1\\times 1$ 的子矩阵有 $6$ 个，$1\\times 2$ 的子矩阵有 $4$ 个，$1\\times 3$ 的子矩阵有 $2$ 个，$2\\times 1$ 的子矩阵有 $3$ 个，$2\\times 2$ 的子矩阵有 $2$ 个，$2\\times 3$ 的子矩阵有 $1$ 个，所以子矩阵共有 $6+4+2+3+2+1=18$ 个。\n\n可是仓鼠窝中有的格子被破坏了。现在小仓鼠想要知道，有多少个内部不含被破坏的格子的子矩阵。\n", "inputFormat": "第一行两个正整数 $n$ 和 $m$，分别表示仓鼠窝的行数 $n$，列数 $m$。\n\n接下来 $n$ 行，每行 $m$ 个数，每个数代表对应的格子，非 $0$ 即 $1$。若为 $0$，表示这个格子被破坏；反之代表这个格子是完好无损的。", "outputFormat": "仅一个正整数，表示未被破坏的子矩阵的个数。\n", "hint": "本题时限 $2\\text{s}$，内存限制 $256\\text{M}$，因新评测机速度较为接近 NOIP 评测机速度，请注意常数问题带来的影响。\n\n|    数据编号     |     $n$       |     $m$      |        特殊性质        |\n| :------------: | :-----------: | :----------: | :--------------------: |\n|     $1, 2, 3$    |       $2$       |       $2$      |           无           |\n|        $4$       |      $10$       |      $10$      |           无           |\n|      $5, 6$      |      $2000$     |     $2000$     |   所有格子均未被破坏     |\n|        $7$       |      $2500$     |     $3000$     |  有且仅有一个格子被破坏  |\n|        $8$       |      $3000$     |     $2500$     |  有且仅有一个格子被破坏  |\n|        $9$       |       $200$     |      $200$     |           无           |\n|   $10, 11, 12$   |       $500$     |      $500$     |           无           |\n|     $13, 14$     |      $1000$     |     $1000$     |           无           |\n|       $15$       |      $1000$     |     $1500$     |           无           |\n|       $16$       |      $2500$     |     $2500$     |           无           |\n|       $17$       |      $2500$     |     $3000$     |           无           |\n|       $18$       |      $3000$     |     $2500$     |           无           |\n|     $19, 20$     |      $3000$     |     $3000$     |           无           |", "locale": "zh-CN"}}}
{"pid": "P3401", "type": "P", "difficulty": 6, "samples": [["5 3\n1 2 3\n2 3 3\n2 4 6\n4 5 1\n1 3 4\n2 2 4 7\n1 3 5", "14\n26\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2016", "线段树", "洛谷原创", "树链剖分", "洛谷月赛"], "title": "洛谷树", "background": "萌哒的 Created_equal 小仓鼠种了一棵洛谷树！\n\n（题目背景是辣鸡小仓鼠乱写的 QAQ）。\n", "description": "树是一个无环、连通的无向图，由 $n$ 个点和 $n-1$ 条边构成。树上两个点之间的路径被定义为他们之间的唯一一条简单路径——显然这是一条最短路径。\n\n现在引入一个概念——子路径。假设树上两个点 $p_1$ 和 $p_n$ 之间的路径是 $P = \\langle p_1,p_2,p_3, \\ldots, p_n \\rangle $，那么它的子路径被定义为某一条路径 $P'$，满足 $P'= \\langle p_i,p_{i+1},p_{i+2},\\ldots,p_j \\rangle $，其中 $1\\le i \\le j \\le n$。显然，原路径是一条子路径，任意一个点也可以作为子路径。\n\n我们给每条边赋予一个边权。萌萌哒的 Sugar 问小仓鼠：对于任意两个点 $u$ 和 $v$，你能快速求出，$u$ 到 $v$ 的路径上所有子路径经过的边的边权的 $\\text{xor}$ 值的和是多少。具体地说就是，你把 $u$ 到 $v$ 的路径上所有子路径全部提出来，然后分别把每个子路径上经过的边的边权 $\\text{xor}$ 在一起，最后求出得到的所有 $\\text{xor}$ 值的和。\n\n什么？你不知道 $\\text{xor}$？那就去百度啊！\n\n这时候，fjzzq2002 大爷冒了粗来：窝还要你滋磁修改某条边边权的操作！\n\n小仓鼠那么辣鸡，当然不会做这道题啦。于是他就来向你求救！\n", "inputFormat": "第一行两个正整数 $n$ 和 $q$，表示点的个数，查询和询问的总次数。\n\n接下来 $n-1$ 行，每行两个正整数 $u,v$ 和一个非负整数 $w$，表示 $u$ 和 $v$ 两个点之间有一条边权为 $w$ 的边。\n\n接下来 $q$ 行，格式为 `1 u v` 或 `2 u v w`。   \n如果为 `1 u v` 操作，你需要输出 $u$ 到 $v$ 的路径上所有子路径经过的边的边权的 $\\text{xor}$ 值的和是多少。  \n如果为 `2 u v w` 操作，你需要把 $u$ 到 $v$ 这条边的边权改为 $w$，保证这条边存在。\n", "outputFormat": "对于每个 $1$ 操作，输出答案。\n", "hint": "|测试点编号|$n=$|$q=$|备注|\n|:-:|:-:|:-:|:-:|\n|$1$|$100$|$5$|无|\n|$2$|$100$|$20$|无|\n|$3$|$100$|$100$|无|\n|$4$|$5\\times 10^3$|$10^3$|无|\n|$5$|$5\\times 10^3$|$2\\times 10^3$|无|\n|$6$|$5\\times 10^3$|$3\\times 10^3$|无|\n|$7$|$10^4$|$10^4$|第 $i$ 条边连接第 $i$ 个点和第 $i+1$ 个点，且没有 $2$ 操作|\n|$8$|$10^4$|$2\\times 10^4$|第 $i$ 条边连接第 $i$ 个点和第 $i+1$ 个点，且没有 $2$ 操作|\n|$9$|$10^4$|$10^4$|第 $i$ 条边连接第 $i$ 个点和第 $i+1$ 个点|\n|$10$|$10^4$|$2\\times 10^4$|第 $i$ 条边连接第 $i$ 个点和第 $i+1$ 个点|\n|$11$|$10^4$|$10^4$|没有 $2$ 操作|\n|$12$|$10^4$|$2\\times 10^4$|没有 $2$ 操作|\n|$13$|$2\\times 10^4$|$2\\times 10^4$|没有 $2$ 操作|\n|$14$|$3\\times 10^4$|$3\\times 10^4$|没有 $2$ 操作|\n|$15$|$3\\times 10^4$|$10^4$|无|\n|$16$|$2\\times 10^4$|$2\\times 10^4$|无|\n|$17$|$2\\times 10^4$|$2\\times 10^4$|无|\n|$18$|$3\\times 10^4$|$2\\times 10^4$|无|\n|$19$|$2\\times 10^4$|$3\\times 10^4$|无|\n|$20$|$3\\times 10^4$|$3\\times 10^4$|无|\n\n对于 $100\\%$ 的数据，所有边权小于等于 $1023$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Luogu Tree", "background": "The cute Created_equal little hamster planted a Luogu tree.\n\n(This background was randomly written by the \"laji\" little hamster, QAQ).", "description": "A tree is an undirected, connected graph without cycles, consisting of $n$ vertices and $n-1$ edges. The path between two vertices in a tree is defined as the unique simple path between them; this is obviously a shortest path.\n\nNow we introduce the concept of a subpath. Suppose the path between two vertices $p_1$ and $p_n$ on the tree is $P = \\langle p_1,p_2,p_3, \\ldots, p_n \\rangle$. A subpath is any path $P'$ such that $P'= \\langle p_i,p_{i+1},p_{i+2},\\ldots,p_j \\rangle$, where $1\\le i \\le j \\le n$. Clearly, the original path itself is a subpath, and any single vertex can also be considered a subpath.\n\nWe assign a weight to every edge. The adorable Sugar asks the little hamster: for any two vertices $u$ and $v$, can you quickly find the sum of the $\\text{xor}$ values of edge weights over all subpaths along the path from $u$ to $v$. Specifically, take all subpaths on the path from $u$ to $v$, for each subpath compute the $\\text{xor}$ of the edge weights it traverses, and finally sum up all these $\\text{xor}$ values.\n\nWhat? You do not know $\\text{xor}$? Go Baidu it.\n\nAt this point, fjzzq2002 showed up: I also want you to support an operation that modifies the weight of an edge.\n\nThe little hamster is so \"laji\" that he certainly cannot solve this problem, so he turns to you for help.", "inputFormat": "The first line contains two positive integers $n$ and $q$, denoting the number of vertices and the total number of operations.\n\nEach of the next $n-1$ lines contains two positive integers $u,v$ and a non-negative integer $w$, indicating there is an edge of weight $w$ between vertices $u$ and $v$.\n\nEach of the next $q$ lines is in the format `1 u v` or `2 u v w`.  \nIf it is operation `1 u v`, you need to output the sum of the $\\text{xor}$ values of edge weights over all subpaths on the path from $u$ to $v$.  \nIf it is operation `2 u v w`, you need to change the weight of the edge between $u$ and $v$ to $w$, and it is guaranteed that this edge exists.", "outputFormat": "For each operation of type `1`, output the answer.", "hint": "|Test point id|$n=$|$q=$|Notes|\n|:-:|:-:|:-:|:-:|\n|$1$|$100$|$5$|None|\n|$2$|$100$|$20$|None|\n|$3$|$100$|$100$|None|\n|$4$|$5\\times 10^3$|$10^3$|None|\n|$5$|$5\\times 10^3$|$2\\times 10^3$|None|\n|$6$|$5\\times 10^3$|$3\\times 10^3$|None|\n|$7$|$10^4$|$10^4$|The $i$-th edge connects vertex $i$ and vertex $i+1$, and there is no $2$ operation.|\n|$8$|$10^4$|$2\\times 10^4$|The $i$-th edge connects vertex $i$ and vertex $i+1$, and there is no $2$ operation.|\n|$9$|$10^4$|$10^4$|The $i$-th edge connects vertex $i$ and vertex $i+1$.|\n|$10$|$10^4$|$2\\times 10^4$|The $i$-th edge connects vertex $i$ and vertex $i+1$.|\n|$11$|$10^4$|$10^4$|No $2$ operation.|\n|$12$|$10^4$|$2\\times 10^4$|No $2$ operation.|\n|$13$|$2\\times 10^4$|$2\\times 10^4$|No $2$ operation.|\n|$14$|$3\\times 10^4$|$3\\times 10^4$|No $2$ operation.|\n|$15$|$3\\times 10^4$|$10^4$|None|\n|$16$|$2\\times 10^4$|$2\\times 10^4$|None|\n|$17$|$2\\times 10^4$|$2\\times 10^4$|None|\n|$18$|$3\\times 10^4$|$2\\times 10^4$|None|\n|$19$|$2\\times 10^4$|$3\\times 10^4$|None|\n|$20$|$3\\times 10^4$|$3\\times 10^4$|None|\n\nFor $100\\%$ of the testdata, all edge weights are at most $1023$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "洛谷树", "background": "萌哒的 Created_equal 小仓鼠种了一棵洛谷树！\n\n（题目背景是辣鸡小仓鼠乱写的 QAQ）。\n", "description": "树是一个无环、连通的无向图，由 $n$ 个点和 $n-1$ 条边构成。树上两个点之间的路径被定义为他们之间的唯一一条简单路径——显然这是一条最短路径。\n\n现在引入一个概念——子路径。假设树上两个点 $p_1$ 和 $p_n$ 之间的路径是 $P = \\langle p_1,p_2,p_3, \\ldots, p_n \\rangle $，那么它的子路径被定义为某一条路径 $P'$，满足 $P'= \\langle p_i,p_{i+1},p_{i+2},\\ldots,p_j \\rangle $，其中 $1\\le i \\le j \\le n$。显然，原路径是一条子路径，任意一个点也可以作为子路径。\n\n我们给每条边赋予一个边权。萌萌哒的 Sugar 问小仓鼠：对于任意两个点 $u$ 和 $v$，你能快速求出，$u$ 到 $v$ 的路径上所有子路径经过的边的边权的 $\\text{xor}$ 值的和是多少。具体地说就是，你把 $u$ 到 $v$ 的路径上所有子路径全部提出来，然后分别把每个子路径上经过的边的边权 $\\text{xor}$ 在一起，最后求出得到的所有 $\\text{xor}$ 值的和。\n\n什么？你不知道 $\\text{xor}$？那就去百度啊！\n\n这时候，fjzzq2002 大爷冒了粗来：窝还要你滋磁修改某条边边权的操作！\n\n小仓鼠那么辣鸡，当然不会做这道题啦。于是他就来向你求救！\n", "inputFormat": "第一行两个正整数 $n$ 和 $q$，表示点的个数，查询和询问的总次数。\n\n接下来 $n-1$ 行，每行两个正整数 $u,v$ 和一个非负整数 $w$，表示 $u$ 和 $v$ 两个点之间有一条边权为 $w$ 的边。\n\n接下来 $q$ 行，格式为 `1 u v` 或 `2 u v w`。   \n如果为 `1 u v` 操作，你需要输出 $u$ 到 $v$ 的路径上所有子路径经过的边的边权的 $\\text{xor}$ 值的和是多少。  \n如果为 `2 u v w` 操作，你需要把 $u$ 到 $v$ 这条边的边权改为 $w$，保证这条边存在。\n", "outputFormat": "对于每个 $1$ 操作，输出答案。\n", "hint": "|测试点编号|$n=$|$q=$|备注|\n|:-:|:-:|:-:|:-:|\n|$1$|$100$|$5$|无|\n|$2$|$100$|$20$|无|\n|$3$|$100$|$100$|无|\n|$4$|$5\\times 10^3$|$10^3$|无|\n|$5$|$5\\times 10^3$|$2\\times 10^3$|无|\n|$6$|$5\\times 10^3$|$3\\times 10^3$|无|\n|$7$|$10^4$|$10^4$|第 $i$ 条边连接第 $i$ 个点和第 $i+1$ 个点，且没有 $2$ 操作|\n|$8$|$10^4$|$2\\times 10^4$|第 $i$ 条边连接第 $i$ 个点和第 $i+1$ 个点，且没有 $2$ 操作|\n|$9$|$10^4$|$10^4$|第 $i$ 条边连接第 $i$ 个点和第 $i+1$ 个点|\n|$10$|$10^4$|$2\\times 10^4$|第 $i$ 条边连接第 $i$ 个点和第 $i+1$ 个点|\n|$11$|$10^4$|$10^4$|没有 $2$ 操作|\n|$12$|$10^4$|$2\\times 10^4$|没有 $2$ 操作|\n|$13$|$2\\times 10^4$|$2\\times 10^4$|没有 $2$ 操作|\n|$14$|$3\\times 10^4$|$3\\times 10^4$|没有 $2$ 操作|\n|$15$|$3\\times 10^4$|$10^4$|无|\n|$16$|$2\\times 10^4$|$2\\times 10^4$|无|\n|$17$|$2\\times 10^4$|$2\\times 10^4$|无|\n|$18$|$3\\times 10^4$|$2\\times 10^4$|无|\n|$19$|$2\\times 10^4$|$3\\times 10^4$|无|\n|$20$|$3\\times 10^4$|$3\\times 10^4$|无|\n\n对于 $100\\%$ 的数据，所有边权小于等于 $1023$。\n", "locale": "zh-CN"}}}
{"pid": "P3402", "type": "P", "difficulty": 6, "samples": [["5 6\n1 1 2\n3 1 2\n2 0\n3 1 2\n2 1\n3 1 2", "1\n0\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["并查集", "可持久化", "模板题"], "title": "【模板】可持久化并查集", "background": null, "description": "给定 $n$ 个集合，第 $i$ 个集合内初始状态下只有一个数，为 $i$。\n\n有 $m$ 次操作。操作分为 $3$ 种：\n\n - `1 a b` 合并 $a,b$ 所在集合；\n\n - `2 k` 回到第 $k$ 次操作（执行三种操作中的任意一种都记为一次操作）之后的状态，保证已经进行过至少 $k$ 次操作（不算本次操作），特别的，若 $k=0$，则表示回到初始状态；\n\n - `3 a b` 询问 $a,b$ 是否属于同一集合，如果是则输出 $1$，否则输出 $0$。", "inputFormat": "第一行两个整数，$n,m$。\n\n接下来 $m$ 行，每行先输入一个数 $opt$。若 $opt=2$ 则再输入一个整数 $k$，否则再输入两个整数 $a,b$，描述一次操作。", "outputFormat": "对每个操作 $3$，输出一行一个整数表示答案。", "hint": "对于 $100\\%$ 的数据，$1\\le n\\le 10^5$，$1\\le m\\le 2\\times 10^5$，$1 \\le a, b \\le n$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Persistent DSU (Union-Find)", "background": "", "description": "Given $n$ sets, the $i$-th set initially contains only the element $i$.\n\nThere are $m$ operations, of three types:\n- `1 a b` Merge the sets containing $a$ and $b$;\n- `2 k` Revert to the state right after the $k$-th operation (any of the three types counts as one operation). It is guaranteed that at least $k$ operations have already been performed (not counting this one). In particular, if $k=0$, revert to the initial state;\n- `3 a b` Query whether $a$ and $b$ belong to the same set; if yes, output $1$, otherwise output $0$.", "inputFormat": "The first line contains two integers $n$ and $m$.\n\nThen follow $m$ lines. On each line, first read an integer $opt$. If $opt=2$ then read an integer $k$; otherwise read two integers $a, b$, describing one operation.", "outputFormat": "For each operation of type $3$, output one line with one integer indicating the answer.", "hint": "For $100\\%$ of the testdata, $1 \\le n \\le 10^5$, $1 \\le m \\le 2 \\times 10^5$, $1 \\le a, b \\le n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】可持久化并查集", "background": null, "description": "给定 $n$ 个集合，第 $i$ 个集合内初始状态下只有一个数，为 $i$。\n\n有 $m$ 次操作。操作分为 $3$ 种：\n\n - `1 a b` 合并 $a,b$ 所在集合；\n\n - `2 k` 回到第 $k$ 次操作（执行三种操作中的任意一种都记为一次操作）之后的状态，保证已经进行过至少 $k$ 次操作（不算本次操作），特别的，若 $k=0$，则表示回到初始状态；\n\n - `3 a b` 询问 $a,b$ 是否属于同一集合，如果是则输出 $1$，否则输出 $0$。", "inputFormat": "第一行两个整数，$n,m$。\n\n接下来 $m$ 行，每行先输入一个数 $opt$。若 $opt=2$ 则再输入一个整数 $k$，否则再输入两个整数 $a,b$，描述一次操作。", "outputFormat": "对每个操作 $3$，输出一行一个整数表示答案。", "hint": "对于 $100\\%$ 的数据，$1\\le n\\le 10^5$，$1\\le m\\le 2\\times 10^5$，$1 \\le a, b \\le n$。", "locale": "zh-CN"}}}
{"pid": "P3403", "type": "P", "difficulty": 5, "samples": [["15\n4 7 9\n", "9\n"], ["33333333333\n99005 99002 100000\n", "33302114671\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["图论", "洛谷原创", "最短路", "洛谷比赛"], "title": "跳楼机", "background": "DJL 为了避免成为一只咸鱼，来找 srwudi 学习压代码的技巧。\n", "description": "Srwudi 的家是一幢 $h$ 层的摩天大楼。由于前来学习的蒟蒻越来越多，srwudi 改造了一个跳楼机，使得访客可以更方便的上楼。\n\n经过改造，srwudi 的跳楼机可以采用以下四种方式移动：\n\n1. 向上移动 $x$ 层；\n2. 向上移动 $y$ 层；\n3. 向上移动 $z$ 层；\n4. 回到第一层。\n\n一个月黑风高的大中午，DJL 来到了 srwudi 的家，现在他在 srwudi 家的第一层，碰巧跳楼机也在第一层。DJL 想知道，他可以乘坐跳楼机前往的楼层数。", "inputFormat": "第一行一个整数 $h$，表示摩天大楼的层数。\n\n第二行三个正整数，分别表示题目中的 $x, y, z$。", "outputFormat": "一行一个整数，表示 DJL 可以到达的楼层数。\n", "hint": "可以到达的楼层有：$1,5,8,9,10,12,13,14,15$。\n\n$1 \\le h \\le 2^{63}-1$，$1 \\le x,y,z \\le 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "Jump Elevator", "background": "To avoid becoming a \"salted fish\" (idle person), DJL went to srwudi to learn code golf techniques.", "description": "srwudi's home is a skyscraper with $h$ floors. Because more and more newbies are coming to learn, srwudi modified an elevator so that visitors can go upstairs more easily.\n\nAfter the modification, the elevator can move in the following four ways:\n1. Move up $x$ floors;\n2. Move up $y$ floors;\n3. Move up $z$ floors;\n4. Return to the first floor.\n\nOne day at noon, DJL arrived at srwudi's home. He is now on the first floor, and the elevator happens to be on the first floor as well. DJL wants to know how many floors he can reach by taking the elevator.", "inputFormat": "The first line contains an integer $h$, the number of floors of the skyscraper.\n\nThe second line contains three positive integers, which are $x, y, z$.", "outputFormat": "Output a single integer, the number of floors DJL can reach.", "hint": "Reachable floors include: $1,5,8,9,10,12,13,14,15$.\n\n$1 \\le h \\le 2^{63} - 1$, $1 \\le x, y, z \\le 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "跳楼机", "background": "DJL 为了避免成为一只咸鱼，来找 srwudi 学习压代码的技巧。\n", "description": "Srwudi 的家是一幢 $h$ 层的摩天大楼。由于前来学习的蒟蒻越来越多，srwudi 改造了一个跳楼机，使得访客可以更方便的上楼。\n\n经过改造，srwudi 的跳楼机可以采用以下四种方式移动：\n\n1. 向上移动 $x$ 层；\n2. 向上移动 $y$ 层；\n3. 向上移动 $z$ 层；\n4. 回到第一层。\n\n一个月黑风高的大中午，DJL 来到了 srwudi 的家，现在他在 srwudi 家的第一层，碰巧跳楼机也在第一层。DJL 想知道，他可以乘坐跳楼机前往的楼层数。", "inputFormat": "第一行一个整数 $h$，表示摩天大楼的层数。\n\n第二行三个正整数，分别表示题目中的 $x, y, z$。", "outputFormat": "一行一个整数，表示 DJL 可以到达的楼层数。\n", "hint": "可以到达的楼层有：$1,5,8,9,10,12,13,14,15$。\n\n$1 \\le h \\le 2^{63}-1$，$1 \\le x,y,z \\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P3405", "type": "P", "difficulty": 2, "samples": [["6\nMIAMI FL\nDALLAS TX\nFLINT MI\nCLEMSON SC\nBOSTON MA\nORLANDO FL", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "2016", "USACO"], "title": "[USACO16DEC] Cities and States S", "background": "", "description": "Farmer John 有若干头奶牛。为了训练奶牛们的智力，Farmer John 在谷仓的墙上放了一张美国地图。地图上表明了每个城市及其所在州的代码（前两位大写字母）。\n\n由于奶牛在谷仓里花了很多时间看这张地图，他们开始注意到一些奇怪的关系。例如，FLINT 的前两个字母就是 MIAMI 所在的 `FL` 州，MIAMI 的前两个字母则是 FLINT 所在的 `MI` 州。  \n确切地说，对于两个城市，它们的前两个字母互为对方所在州的名称。\n\n我们称两个城市是一个一对「特殊」的城市，如果他们具有上面的特性，并且来自不同的州。对于总共 $N$ 座城市，奶牛想知道有多少对「特殊」的城市存在。请帮助他们解决这个有趣的地理难题！  ", "inputFormat": "输入共 $N + 1$ 行。\n\n第一行一个正整数 $N$，表示地图上的城市的个数。  \n接下来 $N$ 行，每行两个字符串，分别表示一个城市的名称（$2 \\sim 10$ 个大写字母）和所在州的代码（$2$ 个大写字母）。同一个州内不会有两个同名的城市。", "outputFormat": "输出共一行一个整数，代表特殊的城市对数。", "hint": "### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1 \\leq N \\leq 2 \\times 10 ^ 5$，城市名称长度不超过 $10$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO16DEC] Cities and States S", "background": "", "description": "Farmer John has several cows. To train their intelligence, Farmer John put a map of the United States on the barn wall. The map shows each city and the code of the state it belongs to (2 uppercase letters).\n\nBecause the cows spend a lot of time looking at the map, they start to notice some strange relationships. For example, the first two letters of FLINT are the state of MIAMI, `FL`, and the first two letters of MIAMI are the state of FLINT, `MI`. Precisely, for two cities, the first two letters of each city's name are equal to the other city's state code.\n\nWe call two cities a \"special\" pair if they have the property above and they come from different states. Given $N$ total cities, the cows want to know how many \"special\" pairs exist. Please help them solve this interesting geography puzzle.", "inputFormat": "The input consists of $N + 1$ lines.\n\nThe first line contains a positive integer $N$, the number of cities on the map.  \nEach of the next $N$ lines contains two strings: a city name ($2$ to $10$ uppercase letters) and the code of its state ($2$ uppercase letters). Within the same state, there are no two cities with the same name.", "outputFormat": "Output a single line with one integer, the number of special city pairs.", "hint": "Constraints: For $100\\%$ of the testdata, $1 \\le N \\le 2 \\times 10^5$, and the city name length is at most $10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO16DEC] Cities and States S", "background": "", "description": "Farmer John 有若干头奶牛。为了训练奶牛们的智力，Farmer John 在谷仓的墙上放了一张美国地图。地图上表明了每个城市及其所在州的代码（前两位大写字母）。\n\n由于奶牛在谷仓里花了很多时间看这张地图，他们开始注意到一些奇怪的关系。例如，FLINT 的前两个字母就是 MIAMI 所在的 `FL` 州，MIAMI 的前两个字母则是 FLINT 所在的 `MI` 州。  \n确切地说，对于两个城市，它们的前两个字母互为对方所在州的名称。\n\n我们称两个城市是一个一对「特殊」的城市，如果他们具有上面的特性，并且来自不同的州。对于总共 $N$ 座城市，奶牛想知道有多少对「特殊」的城市存在。请帮助他们解决这个有趣的地理难题！  ", "inputFormat": "输入共 $N + 1$ 行。\n\n第一行一个正整数 $N$，表示地图上的城市的个数。  \n接下来 $N$ 行，每行两个字符串，分别表示一个城市的名称（$2 \\sim 10$ 个大写字母）和所在州的代码（$2$ 个大写字母）。同一个州内不会有两个同名的城市。", "outputFormat": "输出共一行一个整数，代表特殊的城市对数。", "hint": "### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1 \\leq N \\leq 2 \\times 10 ^ 5$，城市名称长度不超过 $10$。", "locale": "zh-CN"}}}
{"pid": "P3406", "type": "P", "difficulty": 3, "samples": [["9 10\n3 1 4 1 5 9 2 6 5 3\n200 100 50\n300 299 100\n500 200 500\n345 234 123\n100 50 100\n600 100 1\n450 400 80\n2 1 10", "6394"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2016", "洛谷原创", "前缀和", "差分", "洛谷月赛"], "title": "海底高铁", "background": "", "description": "该铁路经过 $N$ 个城市，每个城市都有一个站。不过，由于各个城市之间不能协调好，于是乘车每经过两个相邻的城市之间（方向不限），必须单独购买这一小段的车票。第 $i$ 段铁路连接了城市 $i$ 和城市 $i+1(1\\leq i<N)$。如果搭乘的比较远，需要购买多张车票。第 $i$ 段铁路购买纸质单程票需要 $A_i$ 博艾元。\n\n虽然一些事情没有协调好，各段铁路公司也为了方便乘客，推出了 IC 卡。对于第 $i$ 段铁路，需要花 $C_i$ 博艾元的工本费购买一张 IC 卡，然后乘坐这段铁路一次就只要扣 $B_i(B_i<A_i)$ 元。IC 卡可以提前购买，有钱就可以从网上买得到，而不需要亲自去对应的城市购买。工本费不能退，也不能购买车票。每张卡都可以充值任意数额。对于第 $i$ 段铁路的 IC 卡，无法乘坐别的铁路的车。\n\nUim 现在需要出差，要去 $M$ 个城市，从城市 $P_1$ 出发分别按照 $P_1,P_2,P_3,\\cdots,P_M$ 的顺序访问各个城市，可能会多次访问一个城市，且相邻访问的城市位置不一定相邻，而且不会是同一个城市。\n\n现在他希望知道，出差结束后，至少会花掉多少的钱，包括购买纸质车票、买卡和充值的总费用。", "inputFormat": "第一行两个整数，$N,M$。\n\n接下来一行，$M$ 个数字，表示 $P_i$。\n\n接下来 $N-1$ 行，表示第 $i$ 段铁路的 $A_i,B_i,C_i$。", "outputFormat": "一个整数，表示最少花费", "hint": "$2$ 到 $3$ 以及 $8$ 到 $9$ 买票，其余买卡。\n\n对于 $30\\%$ 数据 $M=2$。\n\n对于另外 $30\\%$ 数据 $N\\leq1000，M\\leq1000$。\n\n对于 $100\\%$ 的数据 $M,N\\leq 10^5，A_i,B_i,C_i\\le10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "Undersea High-Speed Railway", "background": "", "description": "The railway passes through $N$ cities, each of which has a station. However, because the cities could not coordinate, each time you travel between two adjacent cities (in either direction), you must buy a separate ticket for that segment. Segment $i$ connects city $i$ and city $i+1$ ($1 \\leq i < N$). If you travel farther, you need to buy multiple tickets. A paper one-way ticket for segment $i$ costs $A_i$ Boai yuan.\n\nAlthough coordination fell short, the companies of each segment introduced IC cards for convenience. For segment $i$, you can pay a fee of $C_i$ Boai yuan to purchase an IC card, after which each ride on this segment only deducts $B_i$ ($B_i < A_i$) yuan. IC cards can be purchased online in advance; you do not need to buy them in the corresponding city. The card fee is non-refundable and cannot be used to buy tickets. Each card can be topped up with any amount. An IC card for segment $i$ cannot be used on other segments.\n\nUim needs to go on a business trip to visit $M$ cities, starting from city $P_1$ and visiting cities in the order $P_1, P_2, P_3, \\cdots, P_M$. A city may be visited multiple times; consecutive cities in the sequence are not necessarily adjacent on the line, and they are guaranteed to be different.\n\nNow he wants to know, after the trip ends, what is the minimum amount of money he will spend in total, including the cost of paper tickets, buying IC cards, and the rides paid with IC cards.", "inputFormat": "- The first line contains two integers, $N, M$.\n- The next line contains $M$ integers, representing $P_i$.\n- The next $N - 1$ lines describe the segments: for segment $i$, three integers $A_i, B_i, C_i$.", "outputFormat": "Output a single integer, the minimum total cost.", "hint": "- Buy paper tickets for $2$ to $3$ and $8$ to $9$, and buy IC cards for the others.\n\nConstraints:\n- For $30\\%$ of the testdata, $M = 2$.\n- For another $30\\%$ of the testdata, $N \\leq 1000$, $M \\leq 1000$.\n- For $100\\%$ of the testdata, $M, N \\leq 10^5$, $A_i, B_i, C_i \\leq 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "海底高铁", "background": "", "description": "该铁路经过 $N$ 个城市，每个城市都有一个站。不过，由于各个城市之间不能协调好，于是乘车每经过两个相邻的城市之间（方向不限），必须单独购买这一小段的车票。第 $i$ 段铁路连接了城市 $i$ 和城市 $i+1(1\\leq i<N)$。如果搭乘的比较远，需要购买多张车票。第 $i$ 段铁路购买纸质单程票需要 $A_i$ 博艾元。\n\n虽然一些事情没有协调好，各段铁路公司也为了方便乘客，推出了 IC 卡。对于第 $i$ 段铁路，需要花 $C_i$ 博艾元的工本费购买一张 IC 卡，然后乘坐这段铁路一次就只要扣 $B_i(B_i<A_i)$ 元。IC 卡可以提前购买，有钱就可以从网上买得到，而不需要亲自去对应的城市购买。工本费不能退，也不能购买车票。每张卡都可以充值任意数额。对于第 $i$ 段铁路的 IC 卡，无法乘坐别的铁路的车。\n\nUim 现在需要出差，要去 $M$ 个城市，从城市 $P_1$ 出发分别按照 $P_1,P_2,P_3,\\cdots,P_M$ 的顺序访问各个城市，可能会多次访问一个城市，且相邻访问的城市位置不一定相邻，而且不会是同一个城市。\n\n现在他希望知道，出差结束后，至少会花掉多少的钱，包括购买纸质车票、买卡和充值的总费用。", "inputFormat": "第一行两个整数，$N,M$。\n\n接下来一行，$M$ 个数字，表示 $P_i$。\n\n接下来 $N-1$ 行，表示第 $i$ 段铁路的 $A_i,B_i,C_i$。", "outputFormat": "一个整数，表示最少花费", "hint": "$2$ 到 $3$ 以及 $8$ 到 $9$ 买票，其余买卡。\n\n对于 $30\\%$ 数据 $M=2$。\n\n对于另外 $30\\%$ 数据 $N\\leq1000，M\\leq1000$。\n\n对于 $100\\%$ 的数据 $M,N\\leq 10^5，A_i,B_i,C_i\\le10^5$。", "locale": "zh-CN"}}}
{"pid": "P3407", "type": "P", "difficulty": 4, "samples": [["6 6 4\n-10 1\n-6 2\n-4 1\n2 1\n6 2\n18 2\n2\n3\n4\n6", "-8\n2\n4\n12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2016", "洛谷原创", "枚举", "洛谷月赛"], "title": "散步", "background": "", "description": "一条道路上，位置点用整数 $A$ 表示。\n\n当 $A=0$ 时，有一个王宫。当 $A>0$，就是离王宫的东边有 $A$ 米，当 $A<0$，就是离王宫的西边有 $-A$ 米。\n\n道路上，有 $N$ 个住宅从西向东用 $1\\sim N$ 来标号。每个住宅有一个人。住宅只会存在于偶数整数点。\n\n该国国王认为，国民体质下降，必须要多运动，于是下命令所有人都必须出门散步。所有的国民，一秒钟可以走 $1$ 米。每个国民各自向东或者向西走。这些方向你是知道的。命令发出后所有人同时离开家门开始散步。\n\n然而该国的国民个都很健谈，如果在散步途中两个人相遇，就会停下来交谈。正在走路的人碰到已经停下来的人（重合）也会停下来交谈。一但停下来，就会聊到天昏地暗，忘记了散步。\n\n现在命令已经发出了 $T$ 秒，该国有 $Q$ 个重要人物，国王希望能够把握他们的位置。你能帮他解答吗？", "inputFormat": "第一行是 $3$ 个整数，$N,T,Q$\n\n接下来 $N$ 行，每行两个整数 $A_i,R_i$。$A_i$ 是家的坐标，如果 $R_i$ 是 $1$，那么会向东走，如果是 $2$，向西。数据保证 $A_i$ 是升序排序，而且不会有两个人初始位置重合。\n\n接下来 $Q$ 行，每行一个整数，表示国王关心的重要人物。\n", "outputFormat": "$Q$ 行，每行一个整数，表示这个人的坐标。\n", "hint": "$20\\%$ 数据，$N\\le 100,T\\le 10000$。\n\n另外 $20\\%$ 数据，$N\\le 5000$。\n\n另外 $20\\%$ 数据，从最西边数起连续的若干国民全部往东，剩下的全部往西。\n\n$100\\%$ 数据 $A_i$ 为偶数，$|A_i|\\le 10^{18},|T|\\le 10^{18},1\\le Q\\le N\\le 100000$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Stroll", "background": "", "description": "On a road, positions are represented by integers $A$.\n\nWhen $A=0$, there is a royal palace. If $A>0$, it means $A$ meters to the east of the palace; if $A<0$, it means $-A$ meters to the west of the palace.\n\nAlong the road, there are $N$ houses labeled $1 \\sim N$ from west to east. Each house has exactly one person. Houses exist only at even integer points.\n\nThe king believes that the citizens’ fitness is declining and orders everyone to go out for a stroll. Every citizen can walk $1$ meter per second. Each citizen walks either east or west; these directions are known to you. All citizens start their stroll simultaneously when the order is issued.\n\nHowever, the citizens are very talkative. If two people meet during the stroll, they stop and talk. If a walking person reaches a point that coincides with someone who has already stopped, they will also stop and talk. Once they stop, they will chat endlessly and forget about the stroll.\n\nNow $T$ seconds have passed since the order was issued. There are $Q$ important persons of interest, and the king wants to know their positions. Can you help him?", "inputFormat": "The first line contains $3$ integers $N, T, Q$.\n\nThe next $N$ lines each contain two integers $A_i, R_i$. $A_i$ is the home coordinate. If $R_i$ is $1$, the person walks east; if it is $2$, the person walks west. It is guaranteed that the $A_i$ are in strictly increasing order and no two people share the same initial position.\n\nThe next $Q$ lines each contain one integer: the index of a person of interest (indexed $1$ to $N$ from west to east).", "outputFormat": "Output $Q$ lines. Each line contains one integer, the coordinate of that person.", "hint": "$20\\%$ of the testdata: $N \\le 100$, $T \\le 10000$.\n\nAnother $20\\%$ of the testdata: $N \\le 5000$.\n\nAnother $20\\%$ of the testdata: starting from the westernmost, some consecutive citizens all walk east, and the remaining citizens all walk west.\n\n$100\\%$ of the testdata: $A_i$ are even, $|A_i| \\le 10^{18}$, $|T| \\le 10^{18}$, $1 \\le Q \\le N \\le 100000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "散步", "background": "", "description": "一条道路上，位置点用整数 $A$ 表示。\n\n当 $A=0$ 时，有一个王宫。当 $A>0$，就是离王宫的东边有 $A$ 米，当 $A<0$，就是离王宫的西边有 $-A$ 米。\n\n道路上，有 $N$ 个住宅从西向东用 $1\\sim N$ 来标号。每个住宅有一个人。住宅只会存在于偶数整数点。\n\n该国国王认为，国民体质下降，必须要多运动，于是下命令所有人都必须出门散步。所有的国民，一秒钟可以走 $1$ 米。每个国民各自向东或者向西走。这些方向你是知道的。命令发出后所有人同时离开家门开始散步。\n\n然而该国的国民个都很健谈，如果在散步途中两个人相遇，就会停下来交谈。正在走路的人碰到已经停下来的人（重合）也会停下来交谈。一但停下来，就会聊到天昏地暗，忘记了散步。\n\n现在命令已经发出了 $T$ 秒，该国有 $Q$ 个重要人物，国王希望能够把握他们的位置。你能帮他解答吗？", "inputFormat": "第一行是 $3$ 个整数，$N,T,Q$\n\n接下来 $N$ 行，每行两个整数 $A_i,R_i$。$A_i$ 是家的坐标，如果 $R_i$ 是 $1$，那么会向东走，如果是 $2$，向西。数据保证 $A_i$ 是升序排序，而且不会有两个人初始位置重合。\n\n接下来 $Q$ 行，每行一个整数，表示国王关心的重要人物。\n", "outputFormat": "$Q$ 行，每行一个整数，表示这个人的坐标。\n", "hint": "$20\\%$ 数据，$N\\le 100,T\\le 10000$。\n\n另外 $20\\%$ 数据，$N\\le 5000$。\n\n另外 $20\\%$ 数据，从最西边数起连续的若干国民全部往东，剩下的全部往西。\n\n$100\\%$ 数据 $A_i$ 为偶数，$|A_i|\\le 10^{18},|T|\\le 10^{18},1\\le Q\\le N\\le 100000$。\n", "locale": "zh-CN"}}}
{"pid": "P3408", "type": "P", "difficulty": 4, "samples": [["14 5 3\n0 3\n0 3\n1 10\n1 10\n2 3\n2 10\n2 3\n5 10\n7 10\n5 10\n7 10\n5 10\n7 10\n5 10\n", "50\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP"], "title": "恋爱", "background": "", "description": "小 A 爱上了小 B！！！可是小 A 相对小 B 太弱，所以她当然不会同意小 A 的请求。小 A 苦苦追求，最终小 B 就提这样的条件：\n\n- 小 B 有 $n$ 个下属（不包括小 B）组成了树状结构，小 B 在顶端，其他人都有一个直属上司。  \n- 小 B 编号 $0$，其他人编号 $1 \\sim n$。  \n- 对于第 $i$ 人，如果这个人没有下属，那么小 A 可以给他 $A_i$ 元钱，则他会向他的直属上司写一封信，表示小 A 向小 B 求爱；  \n- 如果他的直属下属有占比不小于 $\\dfrac{A_i}{T}$ 的人写信表示小 A 向小 B 求爱，那么他也会向他的直属上司写一封信，表示小 A 向小 B 求爱。    \n- 如果小 B 的直属下属有占比不小于 $\\dfrac{C}{T}$ 的人写信表示小 A 向小 B 求爱，那么她会同意小 A 的请求。\n\n请问小 A 至少需要给多少钱才会让小 B 同意小 A 的求爱。", "inputFormat": "第一行三个整数 $n, T, C$。\n\n然后 $n$ 行，第 $i$ 行两个整数 $B_i, A_i$，$B_i$ 表示 $i$ 的直属上司，保证 $B_i < i$。", "outputFormat": "需要给的钱数。\n", "hint": "对于 $20 \\%$ 的数据，没有直属下属的人数 $\\le 15$。  \n对于 $40 \\%$ 的数据，$n \\le 2000$。  \n另有 $10 \\%$ 的数据，$B_i = 0$。\n另有 $10 \\%$ 的数据，$C = 1$ 且对于有直系下属的人 $T / A_i > n$。  \n另有 $10 \\%$ 的数据，$B_i = i - 1$。\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le 500000$，$1 \\le T \\le {10}^9$，$B_i < i$，$1 \\le A_i \\le T$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Love", "background": "", "description": "Xiao A fell in love with Xiao B!!! However, Xiao A is too weak compared to Xiao B, so she would certainly not agree to Xiao A’s request. After Xiao A’s persistent pursuit, Xiao B set the following conditions:\n\n- Xiao B has $n$ subordinates (excluding Xiao B) forming a tree structure. Xiao B is at the top, and everyone else has exactly one direct superior.\n- Xiao B is numbered $0$, and others are numbered $1 \\sim n$.\n- For the $i$-th person: if this person has no subordinates, then Xiao A can give them $A_i$ yuan, after which they will write a letter to their direct superior, stating that Xiao A is confessing to Xiao B.\n- If at least a proportion of $\\dfrac{A_i}{T}$ among their direct subordinates write letters stating that Xiao A is confessing to Xiao B, then they will also write a letter to their direct superior.\n- If at least a proportion of $\\dfrac{C}{T}$ among Xiao B’s direct subordinates write letters stating that Xiao A is confessing to Xiao B, then she will agree to Xiao A’s request.\n\nPlease determine the minimal total amount of money Xiao A needs to pay to make Xiao B accept Xiao A’s confession.", "inputFormat": "The first line contains three integers $n, T, C$.\n\nThen follow $n$ lines. The $i$-th line contains two integers $B_i, A_i$, where $B_i$ is the direct superior of $i$, and it is guaranteed that $B_i < i$.", "outputFormat": "Output the minimal total amount of money needed.", "hint": "- For $20\\%$ of the testdata, the number of people without direct subordinates $\\le 15$.\n- For $40\\%$ of the testdata, $n \\le 2000$.\n- Additionally, for $10\\%$ of the testdata, $B_i = 0$.\n- Additionally, for $10\\%$ of the testdata, $C = 1$ and for people with direct subordinates $T / A_i > n$.\n- Additionally, for $10\\%$ of the testdata, $B_i = i - 1$.\n- For $100\\%$ of the testdata, $1 \\le n \\le 500000$, $1 \\le T \\le {10}^9$, $B_i < i$, $1 \\le A_i \\le T$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "恋爱", "background": "", "description": "小 A 爱上了小 B！！！可是小 A 相对小 B 太弱，所以她当然不会同意小 A 的请求。小 A 苦苦追求，最终小 B 就提这样的条件：\n\n- 小 B 有 $n$ 个下属（不包括小 B）组成了树状结构，小 B 在顶端，其他人都有一个直属上司。  \n- 小 B 编号 $0$，其他人编号 $1 \\sim n$。  \n- 对于第 $i$ 人，如果这个人没有下属，那么小 A 可以给他 $A_i$ 元钱，则他会向他的直属上司写一封信，表示小 A 向小 B 求爱；  \n- 如果他的直属下属有占比不小于 $\\dfrac{A_i}{T}$ 的人写信表示小 A 向小 B 求爱，那么他也会向他的直属上司写一封信，表示小 A 向小 B 求爱。    \n- 如果小 B 的直属下属有占比不小于 $\\dfrac{C}{T}$ 的人写信表示小 A 向小 B 求爱，那么她会同意小 A 的请求。\n\n请问小 A 至少需要给多少钱才会让小 B 同意小 A 的求爱。", "inputFormat": "第一行三个整数 $n, T, C$。\n\n然后 $n$ 行，第 $i$ 行两个整数 $B_i, A_i$，$B_i$ 表示 $i$ 的直属上司，保证 $B_i < i$。", "outputFormat": "需要给的钱数。\n", "hint": "对于 $20 \\%$ 的数据，没有直属下属的人数 $\\le 15$。  \n对于 $40 \\%$ 的数据，$n \\le 2000$。  \n另有 $10 \\%$ 的数据，$B_i = 0$。\n另有 $10 \\%$ 的数据，$C = 1$ 且对于有直系下属的人 $T / A_i > n$。  \n另有 $10 \\%$ 的数据，$B_i = i - 1$。\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le 500000$，$1 \\le T \\le {10}^9$，$B_i < i$，$1 \\le A_i \\le T$。\n", "locale": "zh-CN"}}}
{"pid": "P3409", "type": "P", "difficulty": 5, "samples": [["20 7 3 3\n30 7 4 3", "27\nOrz mgh!!!"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "扩展欧几里德算法"], "title": "值日班长值周班长", "background": null, "description": "话说，在一个学期共有 $n$ 个值日班长，其中 A 是第 $m$ 个值日班长，共有 $p$ 个值周班长，B 是第 $q$ 个值周班长。假设不考虑假期及其他额外上课休假，以及重排值日班长值周班长，即永远每周上 $5$ 天休息 $2$ 天，且这个学期永远不会结束。请问这学期第几天会第一次遇上 $A$ 是值日班长且 $B$ 是值周班长，若永远不会输出 `Orz mgh!!!`。", "inputFormat": "有多组测试数据。每组数据占 $1$ 行四个数 $n,m,p,q$。保证 $m\\le n$，$q\\le p$。", "outputFormat": "每组数据输出 $1$ 行表示结果。", "hint": "|测试点编号|数据组数|$n$|$p$|特殊性质|\n|:-:|:-:|:-:|:-:|:-:|\n|1|$\\le10^4$|$\\le100$|$\\le100$|有|\n|2|$\\le100$|$\\le1000$|$\\le1000$|无|\n|3|$\\le1000$|$\\le10^4$|$\\le10^4$|无|\n|4|$\\le1000$|$\\le10^5$|$\\le10^5$|有|\n|5|$\\le1000$|$\\le10^5$|$\\le10^5$|无|\n|6|$\\le1000$|$\\le10^6$|$\\le10^6$|无|\n|7|$\\le1000$|$\\le10^7$|$\\le10^7$|无|\n|8|$\\le10^4$|$\\le10^7$|$\\le10^7$|有|\n|9|$\\le1000$|$\\le10^9$|$\\le10^9$|有|\n|10|$\\le1000$|$\\le10^9$|$\\le10^9$|无|\n\n特殊性质：$n$ 是 $5$ 的倍数。\n\n对于 $100\\%$ 的测试数据，$1\\le m\\le n\\le 10^9$，$1\\le q\\le p\\le 10^9$，测试数据不超过 $10^4$ 组。**注意测试数据组数的最大值与 $\\bold{n,p}$ 的最大值不会同时取到。**", "locale": "zh-CN", "translations": {"en": {"title": "Daily Duty Monitor and Weekly Duty Monitor", "background": "", "description": "In a semester, there are $n$ daily duty monitors (值日班长), where A is the $m$-th daily duty monitor, and there are $p$ weekly duty monitors (值周班长), where B is the $q$-th weekly duty monitor. Assume we ignore holidays and any other schedule changes, and the daily/weekly duty rotations are never rearranged; that is, every week always has $5$ school days and $2$ rest days, and this semester never ends. On which day of the semester will it first happen that A is the daily duty monitor and B is the weekly duty monitor at the same time? If it never happens, output `Orz mgh!!!`.", "inputFormat": "Multiple test cases. Each test case consists of one line with four integers $n, m, p, q$. It is guaranteed that $m \\le n$ and $q \\le p$.", "outputFormat": "For each test case, output one line with the result.", "hint": "| Test point ID | Number of test cases | $n$ | $p$ | Special property |\n|:-:|:-:|:-:|:-:|:-:|\n| 1 | $\\le 10^4$ | $\\le 100$ | $\\le 100$ | Yes |\n| 2 | $\\le 100$ | $\\le 1000$ | $\\le 1000$ | No |\n| 3 | $\\le 1000$ | $\\le 10^4$ | $\\le 10^4$ | No |\n| 4 | $\\le 1000$ | $\\le 10^5$ | $\\le 10^5$ | Yes |\n| 5 | $\\le 1000$ | $\\le 10^5$ | $\\le 10^5$ | No |\n| 6 | $\\le 1000$ | $\\le 10^6$ | $\\le 10^6$ | No |\n| 7 | $\\le 1000$ | $\\le 10^7$ | $\\le 10^7$ | No |\n| 8 | $\\le 10^4$ | $\\le 10^7$ | $\\le 10^7$ | Yes |\n| 9 | $\\le 1000$ | $\\le 10^9$ | $\\le 10^9$ | Yes |\n| 10 | $\\le 1000$ | $\\le 10^9$ | $\\le 10^9$ | No |\n\nSpecial property: $n$ is a multiple of $5$.\n\nFor $100\\%$ of the testdata, $1 \\le m \\le n \\le 10^9$, $1 \\le q \\le p \\le 10^9$, and the number of test cases does not exceed $10^4$. Note that the maximum number of test cases and the maximum values of $n$ and $p$ will not be reached at the same time.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "值日班长值周班长", "background": null, "description": "话说，在一个学期共有 $n$ 个值日班长，其中 A 是第 $m$ 个值日班长，共有 $p$ 个值周班长，B 是第 $q$ 个值周班长。假设不考虑假期及其他额外上课休假，以及重排值日班长值周班长，即永远每周上 $5$ 天休息 $2$ 天，且这个学期永远不会结束。请问这学期第几天会第一次遇上 $A$ 是值日班长且 $B$ 是值周班长，若永远不会输出 `Orz mgh!!!`。", "inputFormat": "有多组测试数据。每组数据占 $1$ 行四个数 $n,m,p,q$。保证 $m\\le n$，$q\\le p$。", "outputFormat": "每组数据输出 $1$ 行表示结果。", "hint": "|测试点编号|数据组数|$n$|$p$|特殊性质|\n|:-:|:-:|:-:|:-:|:-:|\n|1|$\\le10^4$|$\\le100$|$\\le100$|有|\n|2|$\\le100$|$\\le1000$|$\\le1000$|无|\n|3|$\\le1000$|$\\le10^4$|$\\le10^4$|无|\n|4|$\\le1000$|$\\le10^5$|$\\le10^5$|有|\n|5|$\\le1000$|$\\le10^5$|$\\le10^5$|无|\n|6|$\\le1000$|$\\le10^6$|$\\le10^6$|无|\n|7|$\\le1000$|$\\le10^7$|$\\le10^7$|无|\n|8|$\\le10^4$|$\\le10^7$|$\\le10^7$|有|\n|9|$\\le1000$|$\\le10^9$|$\\le10^9$|有|\n|10|$\\le1000$|$\\le10^9$|$\\le10^9$|无|\n\n特殊性质：$n$ 是 $5$ 的倍数。\n\n对于 $100\\%$ 的测试数据，$1\\le m\\le n\\le 10^9$，$1\\le q\\le p\\le 10^9$，测试数据不超过 $10^4$ 组。**注意测试数据组数的最大值与 $\\bold{n,p}$ 的最大值不会同时取到。**", "locale": "zh-CN"}}}
{"pid": "P3410", "type": "P", "difficulty": 6, "samples": [["2 3\n10 1 2 0\n25 2 3 0\n5 6 7", "17"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["网络流"], "title": "拍照", "background": "", "description": "小 B 有 $N$ 个下属，现小 B 要带着一些下属让别人拍照。\n\n有 $M$ 个人，每个人都愿意付给小 B 一定钱来和 $N$ 个下属中的一些人进行合影。如果这一些下属没带齐那么就不能拍照，小 B 也不会得到钱。\n\n注意：带下属不是白带的！！！对于每个下属，如果他带了那么小 B 需要给他一些钱，保证当他拍照时配合。", "inputFormat": "第 $1$ 行有 $2$ 个正整数 $M$ 和 $N\\ (1\\leq M, N\\le 100)$。接下来的 $M$ 行，每行是一个要求拍照的人的有关数据。第一个数是他同意支付该合影的费用；接着是该合影需要的若干下属的编号，以一个 $0$ 作为行的结束标记。最后一行的 $N$ 个数是带每个下属的费用。", "outputFormat": "一个数，表示最大收益。小 B 可以一个人也不带。\n", "hint": "对于 $10\\%$ 的数据每个人都要求让全部 $N$ 个人合影。\n\n对于 $30\\%$ 的数据 $N, M\\le 15$。\n\n另有 $10\\%$ 的数据答案为 $0$。\n\n对于 $50\\%$ 的数据 $N, M\\le 40$。\n\n另有 $10\\%$ 的数据每个人只愿意拍一个人。\n\n对于 $100\\%$ 的数据 $1\\leq N, M\\le100$，费用是 $[1, 5\\times 10^8]$ 间的整数。", "locale": "zh-CN", "translations": {"en": {"title": "Taking Photos", "background": "", "description": "Xiao B has $N$ subordinates. Now Xiao B plans to bring some subordinates to have photos taken.\n\nThere are $M$ people; each person is willing to pay Xiao B some money to take a photo with some of the $N$ subordinates. If that set of subordinates is not fully brought, the photo cannot be taken, and Xiao B will not receive the payment.\n\nNote: Bringing subordinates is not free! For each subordinate who is brought, Xiao B needs to pay a fee to ensure cooperation during the photo.", "inputFormat": "The first line contains $2$ positive integers $M$ and $N\\ (1\\leq M, N\\le 100)$. The next $M$ lines each describe one requester’s data. The first number is the fee he agrees to pay for that photo; then follow the IDs of the required subordinates, terminated by a $0$ as the end marker for the line. The last line contains $N$ numbers, the cost to bring each subordinate.", "outputFormat": "A single number, the maximum profit. Xiao B may choose to bring nobody.", "hint": "For $10\\%$ of the testdata, each person requires all $N$ subordinates.\n\nFor $30\\%$ of the testdata, $N, M\\le 15$.\n\nFor another $10\\%$ of the testdata, the answer is $0$.\n\nFor $50\\%$ of the testdata, $N, M\\le 40$.\n\nFor another $10\\%$ of the testdata, each person requires exactly one subordinate.\n\nFor $100\\%$ of the testdata, $1\\leq N, M\\le100$, and fees are integers in $[1, 5\\times 10^8]$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "拍照", "background": "", "description": "小 B 有 $N$ 个下属，现小 B 要带着一些下属让别人拍照。\n\n有 $M$ 个人，每个人都愿意付给小 B 一定钱来和 $N$ 个下属中的一些人进行合影。如果这一些下属没带齐那么就不能拍照，小 B 也不会得到钱。\n\n注意：带下属不是白带的！！！对于每个下属，如果他带了那么小 B 需要给他一些钱，保证当他拍照时配合。", "inputFormat": "第 $1$ 行有 $2$ 个正整数 $M$ 和 $N\\ (1\\leq M, N\\le 100)$。接下来的 $M$ 行，每行是一个要求拍照的人的有关数据。第一个数是他同意支付该合影的费用；接着是该合影需要的若干下属的编号，以一个 $0$ 作为行的结束标记。最后一行的 $N$ 个数是带每个下属的费用。", "outputFormat": "一个数，表示最大收益。小 B 可以一个人也不带。\n", "hint": "对于 $10\\%$ 的数据每个人都要求让全部 $N$ 个人合影。\n\n对于 $30\\%$ 的数据 $N, M\\le 15$。\n\n另有 $10\\%$ 的数据答案为 $0$。\n\n对于 $50\\%$ 的数据 $N, M\\le 40$。\n\n另有 $10\\%$ 的数据每个人只愿意拍一个人。\n\n对于 $100\\%$ 的数据 $1\\leq N, M\\le100$，费用是 $[1, 5\\times 10^8]$ 间的整数。", "locale": "zh-CN"}}}
