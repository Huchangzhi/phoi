{"pid": "P5591", "type": "P", "difficulty": 7, "samples": [["3 3 2", "54"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "多项式", "洛谷月赛", "单位根反演"], "title": "小猪佩奇学数学", "background": "", "description": "佩奇和乔治在学数♂学。\n\n给定 $n,p,k$,询问\n$$\n\\sum_{i=0}^n \\binom n i \\times p^{i} \\times \\left\\lfloor \\frac{i}{k} \\right\\rfloor \\bmod 998244353\n$$", "inputFormat": "$3$ 个正整数,分别表示 $n,p,k$。", "outputFormat": "$1$ 个正整数,表示答案。", "hint": "对于 $20\\%$ 的数据，$1 \\leq n \\leq 10^6$\n\n对于另外 $40\\%$ 的数据，$k \\in \\{2^w|0 \\leq w \\leq 10\\}$\n\n对于 $100\\%$ 的数据，$1 \\leq n,p <998244353,k \\in \\{2^{w}|0 \\leq w \\leq 20\\}$\n\n### 出题人善意的提醒\n\n请注意常数因子带来的程序效率上的影响。", "locale": "zh-CN", "translations": {"en": {"title": "Peppa Pig Learns Math", "background": "", "description": "Peppa and George are learning math.\n\nGiven $n, p, k$, compute\n$$\n\\sum_{i=0}^n \\binom n i \\times p^{i} \\times \\left\\lfloor \\frac{i}{k} \\right\\rfloor \\bmod 998244353\n$$", "inputFormat": "Three positive integers, representing $n, p, k$.", "outputFormat": "One positive integer, representing the answer.", "hint": "For $20\\%$ of the testdata, $1 \\leq n \\leq 10^6$.\n\nFor another $40\\%$ of the testdata, $k \\in \\{2^w|0 \\leq w \\leq 10\\}$.\n\nFor $100\\%$ of the testdata, $1 \\leq n, p < 998244353$, and $k \\in \\{2^{w}|0 \\leq w \\leq 20\\}$.\n\n### A Friendly Reminder from the Problem Setter\n\nPlease pay attention to the impact of constant factors on your program’s efficiency.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小猪佩奇学数学", "background": "", "description": "佩奇和乔治在学数♂学。\n\n给定 $n,p,k$,询问\n$$\n\\sum_{i=0}^n \\binom n i \\times p^{i} \\times \\left\\lfloor \\frac{i}{k} \\right\\rfloor \\bmod 998244353\n$$", "inputFormat": "$3$ 个正整数,分别表示 $n,p,k$。", "outputFormat": "$1$ 个正整数,表示答案。", "hint": "对于 $20\\%$ 的数据，$1 \\leq n \\leq 10^6$\n\n对于另外 $40\\%$ 的数据，$k \\in \\{2^w|0 \\leq w \\leq 10\\}$\n\n对于 $100\\%$ 的数据，$1 \\leq n,p <998244353,k \\in \\{2^{w}|0 \\leq w \\leq 20\\}$\n\n### 出题人善意的提醒\n\n请注意常数因子带来的程序效率上的影响。", "locale": "zh-CN"}}}
{"pid": "P5592", "type": "P", "difficulty": 6, "samples": [["10 10 4\n6 10 1 1 6 9 0 5 3 0 \n3 5\n1 10\n9 3\n8 10\n3 0\n8 11\n1 3\n1 4\n2 8\n1 0", "5\n4\n4\n4\n4\n5\n5\n6\n5\n5\n6"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["贪心", "记忆化搜索", "字典树 Trie", "洛谷月赛"], "title": "美德的讲坛", "background": "", "description": "```\n现在我很清楚地懂得了，以前人们寻求美德的教师时首先在寻求着什么。\n人们在寻求安睡与促进安睡的罂粟花！\n```\n\n查拉图斯特拉在讲坛前听智者讲论睡眠的美德。他感到很无聊，于是观察一同听讲的少年们。\n\n他发现少年们的衣着非常奇特。具体地说，少年们的衣着有 $60$ 种特点，第 $i$ 种特点的特征值为 $2^{i-1}$ 。\n\n他每次会观察两个少年，如果有一种衣着特点只出现在一个少年身上，而不在另一个少年身上，查拉图斯特拉就会强迫症发作，并得到等同于该特点特征值的厌恶度。\n\n他想要把少年们站成若干组，使得在每组中，不管他选哪两个少年，都会得到 $<x$ 点厌恶度。查拉图斯特拉称这样的组是好的。\n\n他有时也会使一个少年自成一组，此时不管怎样这个组都是好的。\n\n他想要知道，这样满足条件的组最多可以包含几个少年呢？\n\n有时少年也会回家换衣服，回来时衣着特点会有所改变。", "inputFormat": "输入数据第一行包括三个整数 $n,q,x$，表示少年的人数，少年回家换衣服的次数和阈值。\n\n接下来一行 $n$ 个整数 $a_1,a_2,\\dots,a_n$，$a_i$ 表示初始时第 $i$ 个少年衣着特点的特征值之和。\n\n接下来 $q$ 行，每行两个整数 $ind,val$，表示编号为 $ind$ 的少年刚回家换衣服回来，衣着特点的特征值之和改为 $val$ 。", "outputFormat": "输出 $q+1$ 行，每行一个非负整数。\n\n第 $i$ 行的数表示第 $i$ 次修改之前的答案。\n\n第 $q+1$ 行的数表示全部修改完以后的答案。", "hint": "对于 $20\\%$ 的数据，满足 $n\\le 20$。\n\n对于 $30\\%$ 的数据，满足 $n\\le 1000$。\n\n对于 $50\\%$ 的数据，满足 $n\\le 50000$。\n\n对于另外 $20\\%$ 的数据，满足 $x$ 是 $2$ 的整次幂。\n\n对于$80\\%$的数据，满足$q=0$。\n\n对于 $100\\%$ 的数据，满足 $1\\le ind\\le n\\le 100000,0\\le q\\le 100000,0\\le x,a_i,val< 2^{60}$。", "locale": "zh-CN", "translations": {"en": {"title": "The Virtue Lectern", "background": "", "description": "```\nNow I understand very clearly what people were really looking for when they sought teachers of virtue in the past.\nThey were looking for sleep, and poppies that help with sleep!\n```\n\nZarathustra listens to a wise man on the lectern talking about the virtue of sleep. He feels bored, so he observes the boys who are listening together.\n\nHe finds that the boys’ clothes are very strange. Specifically, the clothes have $60$ kinds of features. The value of the $i$-th feature is $2^{i-1}$.\n\nEach time he observes two boys. If there is a clothing feature that appears on only one of the two boys, and not on the other, Zarathustra’s obsessive-compulsive disorder acts up, and he gains a disgust value equal to that feature’s value.\n\nHe wants to arrange the boys into several groups such that, in each group, no matter which two boys he picks, he will get a disgust value of $<x$. Zarathustra calls such a group good.\n\nSometimes he also puts one boy into a group alone; in that case, no matter what, the group is good.\n\nHe wants to know: at most, how many boys can a group that satisfies the condition contain?\n\nSometimes a boy will go home and change clothes. When he comes back, his clothing features may change.\n\n#", "inputFormat": "The first line of the input contains three integers $n,q,x$, representing the number of boys, the number of times boys go home to change clothes, and the threshold.\n\nThe next line contains $n$ integers $a_1,a_2,\\dots,a_n$, where $a_i$ is the sum of the feature values of the $i$-th boy’s clothing at the beginning.\n\nThe next $q$ lines each contain two integers $ind,val$, meaning the boy with index $ind$ has just come back after changing clothes, and the sum of his clothing feature values becomes $val$.\n\n#", "outputFormat": "Output $q+1$ lines, each containing one non-negative integer.\n\nThe number on line $i$ is the answer before the $i$-th modification.\n\nThe number on line $q+1$ is the answer after all modifications are finished.\n\n#", "hint": "For $20\\%$ of the data, $n\\le 20$.\n\nFor $30\\%$ of the data, $n\\le 1000$.\n\nFor $50\\%$ of the data, $n\\le 50000$.\n\nFor another $20\\%$ of the data, $x$ is an integer power of $2$.\n\nFor $80\\%$ of the data, $q=0$.\n\nFor $100\\%$ of the data, $1\\le ind\\le n\\le 100000,0\\le q\\le 100000,0\\le x,a_i,val< 2^{60}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "美德的讲坛", "background": "", "description": "```\n现在我很清楚地懂得了，以前人们寻求美德的教师时首先在寻求着什么。\n人们在寻求安睡与促进安睡的罂粟花！\n```\n\n查拉图斯特拉在讲坛前听智者讲论睡眠的美德。他感到很无聊，于是观察一同听讲的少年们。\n\n他发现少年们的衣着非常奇特。具体地说，少年们的衣着有 $60$ 种特点，第 $i$ 种特点的特征值为 $2^{i-1}$ 。\n\n他每次会观察两个少年，如果有一种衣着特点只出现在一个少年身上，而不在另一个少年身上，查拉图斯特拉就会强迫症发作，并得到等同于该特点特征值的厌恶度。\n\n他想要把少年们站成若干组，使得在每组中，不管他选哪两个少年，都会得到 $<x$ 点厌恶度。查拉图斯特拉称这样的组是好的。\n\n他有时也会使一个少年自成一组，此时不管怎样这个组都是好的。\n\n他想要知道，这样满足条件的组最多可以包含几个少年呢？\n\n有时少年也会回家换衣服，回来时衣着特点会有所改变。", "inputFormat": "输入数据第一行包括三个整数 $n,q,x$，表示少年的人数，少年回家换衣服的次数和阈值。\n\n接下来一行 $n$ 个整数 $a_1,a_2,\\dots,a_n$，$a_i$ 表示初始时第 $i$ 个少年衣着特点的特征值之和。\n\n接下来 $q$ 行，每行两个整数 $ind,val$，表示编号为 $ind$ 的少年刚回家换衣服回来，衣着特点的特征值之和改为 $val$ 。", "outputFormat": "输出 $q+1$ 行，每行一个非负整数。\n\n第 $i$ 行的数表示第 $i$ 次修改之前的答案。\n\n第 $q+1$ 行的数表示全部修改完以后的答案。", "hint": "对于 $20\\%$ 的数据，满足 $n\\le 20$。\n\n对于 $30\\%$ 的数据，满足 $n\\le 1000$。\n\n对于 $50\\%$ 的数据，满足 $n\\le 50000$。\n\n对于另外 $20\\%$ 的数据，满足 $x$ 是 $2$ 的整次幂。\n\n对于$80\\%$的数据，满足$q=0$。\n\n对于 $100\\%$ 的数据，满足 $1\\le ind\\le n\\le 100000,0\\le q\\le 100000,0\\le x,a_i,val< 2^{60}$。", "locale": "zh-CN"}}}
{"pid": "P5593", "type": "P", "difficulty": 5, "samples": [["4\n1 2 2 3\n1 2\n2 3\n3 4", "2\n"], ["10\n9 7 4 2 3 4 4 5 8 5\n2 1\n3 2\n4 2\n5 2\n6 4\n7 4\n8 1\n9 4\n10 4", "60\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["O2优化"], "title": "小猪佩奇爬树 加强版", "background": "CYJian 在打 洛谷 10 月月赛I Div. 2 的时候，用一种 $O(N)$ 的做法过了这道题的原题。\n\n但是好像这题是可以给常数小的 $O(N \\log N)$ 甚至 $O(N^2)$ 过的。 CYJian 觉得很不服并且出了这道加强版。\n\n---\n\n因为有人反馈 `OLE` 的问题，所以 CYJian 将输出改为原来所有输出的异或和。", "description": "原题数据可能过水，有些错误的做法也可以过原来的题目。**所以可能原题能过在这里就WA了。**\n\n~~比如我自己原来一个错解也过了，一堆东西没考虑。~~\n\n样例解释部分可以参见 [P5588](https://www.luogu.org/problem/P5588)。\n\n一句话题意：给出一棵 $n$ 个点的树，每个点上有一种颜色，请你求出对于每一种颜色，树上有多少条链包含该种颜色的所有点。\n\n注意下面的数据范围。**请注意常数因子对程序效率的影响。**\n\n如果需要请使用 [IO优化](https://www.luogu.org/paste/i11c3ppx)", "inputFormat": "输入文件共 $n + 1$ 行。\n\n第一行一个正整数 $n$ 表示树的节点数。\n\n接下来一行 $n$ 个正整数，第 $i$ 个正整数表示编号为 $i$ 的节点的颜色。颜色范围在 $[1, n]$ 内。\n\n接下来 $n - 1$ 行，每行两个正整数表示一条树边。", "outputFormat": "输出文件应该包括 $1$ 行。\n\n令编号为 $i$ 的颜色的权值为满足题目条件的链的数量。**注意若存在一种颜色满足没有任何一个点属于该颜色，这种颜色的权值为** $\\frac{n \\times (n - 1)}{2}$\n\n你仅需要输出所有 $n$ 种颜色的权值异或和。", "hint": "一共 $5$ 组数据，第 $i$ 组的数据范围：\n\n$n = 3 \\times 10^{i+1}$", "locale": "zh-CN", "translations": {"en": {"title": "Peppa Pig Climbing Trees (Enhanced Version).", "background": "When CYJian was doing Luogu October Monthly Contest I Div. 2, they solved the original version of this problem with an $O(N)$ approach.\n\nBut it seems this problem can be passed with a small-constant $O(N \\log N)$ or even $O(N^2)$ solution. CYJian felt unconvinced and made this enhanced version.\n\n---\n\nBecause someone reported an `OLE` issue, CYJian changed the output to the XOR sum of all original outputs.", "description": "The testdata of the original problem might be too weak, so some incorrect solutions could also pass the original problem. **So a solution that passes the original problem may get WA here.**\n\n~~For example, one of my wrong solutions also passed before, because I did not consider a lot of things.~~\n\nFor the sample explanation, you can refer to [P5588](https://www.luogu.org/problem/P5588).\n\nOne-sentence statement: Given a tree with $n$ nodes, each node has a color. For each color, compute how many paths (chains) in the tree contain all nodes of that color.\n\nPay attention to the Constraints below. **Please pay attention to how constant factors affect program efficiency.**\n\nIf needed, please use [I/O optimization](https://www.luogu.org/paste/i11c3ppx).", "inputFormat": "The input file has $n + 1$ lines in total.\n\nThe first line contains a positive integer $n$, the number of nodes in the tree.\n\nThe next line contains $n$ positive integers. The $i$-th positive integer represents the color of node $i$. The color range is within $[1, n]$.\n\nThe next $n - 1$ lines each contain two positive integers describing an edge of the tree.", "outputFormat": "The output file should contain $1$ line.\n\nLet the weight of color $i$ be the number of paths (chains) that satisfy the condition in the statement. **Note that if there exists a color such that no node has this color, then the weight of this color is** $\\frac{n \\times (n - 1)}{2}$.\n\nYou only need to output the XOR sum of the weights of all $n$ colors.", "hint": "There are $5$ test groups. For the $i$-th group, the Constraints are:\n\n$n = 3 \\times 10^{i+1}$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小猪佩奇爬树 加强版", "background": "CYJian 在打 洛谷 10 月月赛I Div. 2 的时候，用一种 $O(N)$ 的做法过了这道题的原题。\n\n但是好像这题是可以给常数小的 $O(N \\log N)$ 甚至 $O(N^2)$ 过的。 CYJian 觉得很不服并且出了这道加强版。\n\n---\n\n因为有人反馈 `OLE` 的问题，所以 CYJian 将输出改为原来所有输出的异或和。", "description": "原题数据可能过水，有些错误的做法也可以过原来的题目。**所以可能原题能过在这里就WA了。**\n\n~~比如我自己原来一个错解也过了，一堆东西没考虑。~~\n\n样例解释部分可以参见 [P5588](https://www.luogu.org/problem/P5588)。\n\n一句话题意：给出一棵 $n$ 个点的树，每个点上有一种颜色，请你求出对于每一种颜色，树上有多少条链包含该种颜色的所有点。\n\n注意下面的数据范围。**请注意常数因子对程序效率的影响。**\n\n如果需要请使用 [IO优化](https://www.luogu.org/paste/i11c3ppx)", "inputFormat": "输入文件共 $n + 1$ 行。\n\n第一行一个正整数 $n$ 表示树的节点数。\n\n接下来一行 $n$ 个正整数，第 $i$ 个正整数表示编号为 $i$ 的节点的颜色。颜色范围在 $[1, n]$ 内。\n\n接下来 $n - 1$ 行，每行两个正整数表示一条树边。", "outputFormat": "输出文件应该包括 $1$ 行。\n\n令编号为 $i$ 的颜色的权值为满足题目条件的链的数量。**注意若存在一种颜色满足没有任何一个点属于该颜色，这种颜色的权值为** $\\frac{n \\times (n - 1)}{2}$\n\n你仅需要输出所有 $n$ 种颜色的权值异或和。", "hint": "一共 $5$ 组数据，第 $i$ 组的数据范围：\n\n$n = 3 \\times 10^{i+1}$", "locale": "zh-CN"}}}
{"pid": "P5594", "type": "P", "difficulty": 1, "samples": [["1 3 5\n2 3 5\n", "0 1 1 0 1\n"], ["6 3 7\n2 3 4\n2 5 7\n3 5 7\n1 3 5\n5 6 7\n1 2 3\n", "1 2 3 1 3 1 1\n"], ["10 10 20\n2 3 4 8 9 11 12 16 17 18\n2 3 6 10 12 13 14 15 19 20\n1 3 7 10 11 13 14 15 17 19\n1 2 4 6 7 9 15 17 19 20\n2 3 5 6 9 11 14 16 19 20\n1 2 3 8 9 10 11 12 15 19\n1 4 6 7 9 12 13 17 18 19\n1 7 8 9 10 11 13 15 18 20\n1 5 6 7 8 9 13 16 18 19\n4 5 7 10 11 13 14 17 18 20\n", "1 2 2 3 2 2 4 3 3 3 3 4 2 1 3 1 2 2 2 1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["模拟", "洛谷月赛"], "title": "【XR-4】模拟赛", "background": "", "description": "X 校正在进行 CSP 前的校内集训。\n\n一共有 $n$ 名 OIer 参与这次集训，教练为他们精心准备了 $m$ 套模拟赛题。\n\n然而，每名 OIer 都有各自的时间安排，巧合的是，他们在接下来的 $k$ 天中都恰好有 $m$ 天有空打模拟赛。\n\n为了方便管理，教练规定一个人必须按顺序打完 $m$ 套模拟赛题。\n\n比如，小 X 在接下来的第 $2,3,5$ 天有空打模拟赛，那么他就必须在第 $2$ 天打第 $1$ 套模拟赛题，第 $3$ 天打第 $2$ 套模拟赛题，第 $5$ 天打第 $3$ 套模拟赛题。\n\n教练需要为每一个人的每一次模拟赛做准备，为了减小工作量，如果在某一天有多个人打同一套模拟赛题，那么教练只需要在这一天准备一场使用这一套题的模拟赛即可。\n\n你作为机房大佬，教练想请你帮他计算一下，他每天需要准备多少场模拟赛。", "inputFormat": "第一行三个整数 $n,m,k$。\n\n接下来 $n$ 行，每行 $m$ 个整数，第 $i$ 行第 $j$ 列的整数 $a_{i,j}$ 表示第 $i$ 个人在接下来的 $k$ 天中第 $j$ 个有空的日子为第 $a_{i,j}$ 天。", "outputFormat": "一行 $k$ 个整数，第 $i$ 个整数表示接下来的第 $i$ 天教练需要准备的模拟赛场数。", "hint": "**本题采用捆绑测试。**\n\n- Subtask 1（13 points）：$n = m = k = 1$。\n- Subtask 2（24 points）：$n = 1$。\n- Subtask 3（24 points）：$m = 1$。\n- Subtask 4（39 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n,m,k \\le 10^3$，$m \\le k$，$1 \\le a_{i,1} < a_{i,2} < \\cdots < a_{i,m} \\le k$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-4] Mock Contest", "background": "", "description": "School X is holding an in-school training camp before CSP.\n\nThere are $n$ OIers taking part in this training camp, and the coach has carefully prepared $m$ sets of mock contest problems for them.\n\nHowever, each OIer has their own schedule. Coincidentally, in the next $k$ days, each of them happens to have exactly $m$ days free to do mock contests.\n\nTo make management easier, the coach requires that each person must complete the $m$ sets of mock contests in order.\n\nFor example, if Xiao X is free on days $2,3,5$ in the next days, then they must do the $1$st set on day $2$, the $2$nd set on day $3$, and the $3$rd set on day $5$.\n\nThe coach needs to prepare for every person’s every mock contest. To reduce workload, if multiple people do the same set of mock contest problems on the same day, then the coach only needs to prepare one mock contest using that set of problems on that day.\n\nAs a top student in the lab, the coach wants you to help compute how many mock contests they need to prepare each day.", "inputFormat": "The first line contains three integers $n,m,k$.\n\nIn the next $n$ lines, each line contains $m$ integers. The integer $a_{i,j}$ in row $i$ and column $j$ indicates that for the $i$-th person, the $j$-th free day among the next $k$ days is day $a_{i,j}$.", "outputFormat": "Output one line with $k$ integers. The $i$-th integer indicates the number of mock contests the coach needs to prepare on day $i$ among the next $k$ days.", "hint": "**This problem uses bundled tests.**\n\n- Subtask 1 (13 points): $n = m = k = 1$.\n- Subtask 2 (24 points): $n = 1$.\n- Subtask 3 (24 points): $m = 1$.\n- Subtask 4 (39 points): no special constraints.\n\nFor $100\\%$ of the testdata, $1 \\le n,m,k \\le 10^3$, $m \\le k$, $1 \\le a_{i,1} < a_{i,2} < \\cdots < a_{i,m} \\le k$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-4】模拟赛", "background": "", "description": "X 校正在进行 CSP 前的校内集训。\n\n一共有 $n$ 名 OIer 参与这次集训，教练为他们精心准备了 $m$ 套模拟赛题。\n\n然而，每名 OIer 都有各自的时间安排，巧合的是，他们在接下来的 $k$ 天中都恰好有 $m$ 天有空打模拟赛。\n\n为了方便管理，教练规定一个人必须按顺序打完 $m$ 套模拟赛题。\n\n比如，小 X 在接下来的第 $2,3,5$ 天有空打模拟赛，那么他就必须在第 $2$ 天打第 $1$ 套模拟赛题，第 $3$ 天打第 $2$ 套模拟赛题，第 $5$ 天打第 $3$ 套模拟赛题。\n\n教练需要为每一个人的每一次模拟赛做准备，为了减小工作量，如果在某一天有多个人打同一套模拟赛题，那么教练只需要在这一天准备一场使用这一套题的模拟赛即可。\n\n你作为机房大佬，教练想请你帮他计算一下，他每天需要准备多少场模拟赛。", "inputFormat": "第一行三个整数 $n,m,k$。\n\n接下来 $n$ 行，每行 $m$ 个整数，第 $i$ 行第 $j$ 列的整数 $a_{i,j}$ 表示第 $i$ 个人在接下来的 $k$ 天中第 $j$ 个有空的日子为第 $a_{i,j}$ 天。", "outputFormat": "一行 $k$ 个整数，第 $i$ 个整数表示接下来的第 $i$ 天教练需要准备的模拟赛场数。", "hint": "**本题采用捆绑测试。**\n\n- Subtask 1（13 points）：$n = m = k = 1$。\n- Subtask 2（24 points）：$n = 1$。\n- Subtask 3（24 points）：$m = 1$。\n- Subtask 4（39 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1 \\le n,m,k \\le 10^3$，$m \\le k$，$1 \\le a_{i,1} < a_{i,2} < \\cdots < a_{i,m} \\le k$。", "locale": "zh-CN"}}}
{"pid": "P5595", "type": "P", "difficulty": 2, "samples": [["XY\n", "37\n28\n"], ["XYZ\n", "137\n047\n"], ["ZZZZZZ\n", "000000\n000000\n"], ["XYZXYZ\n", "-1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["Special Judge", "构造", "洛谷月赛"], "title": "【XR-4】歌唱比赛", "background": "**赛时提醒：本题不提供任何关于样例 4 以及无解的解释。**\n\n**赛时提醒：本题不提供任何关于输出格式以及 Special Judge 的解释。**\n\n**赛时提醒：抱歉，本题的 Special Judge 不忽略行末空格，请保证两行中没有多余字符。**\n\n**赛时提醒：非常抱歉，本题输入数据是 Windows 格式，而非 Linux 格式，所以在末尾的 `\\n` 之前有一个多余的 `\\r` 字符。请使用 `scanf` 或 `cin` 读入数据，而非 `getline`，因为后者会多读入一个 `\\r`。**", "description": "小 X 参加了一场歌唱比赛。\n\n经过一路鏖战，小 X 终于挺进了决赛，他的对手是小 Y。\n\n这场歌唱比赛的冠军是由点赞数决定的，谁的点赞数高，谁就能夺冠。\n\n小 X 和小 Y 依次演唱完自己的最后一首歌曲后，他们最终的点赞数确定了下来。\n\n揭晓冠军的时刻终于到来了，主持人为了增加悬念，决定从小 X 与小 Y 的点赞数的最后一位开始，依次比较。\n\n比如，小 X 的点赞数是 $37$，小 Y 的点赞数是 $28$。首先比较最后一位，小 X 是 $7$，小 Y 是 $8$，此时小 Y 暂时领先。再加上前一位，小 X 是 $37$，小 Y 是 $28$，此时小 X 暂时领先。比较结束，如果我们用 `X` 代表小 X 暂时领先，`Y` 代表小 Y 暂时领先，那么可以写下一个字符串 `XY`。\n\n再比如，小 X 的点赞数是 $137$，小 Y 的点赞数是 $47$。如果我们再用 `Z` 表示小 X 与小 Y 的点赞数暂时一样，那么写下的字符串应该为 `XYZ`。\n\n你作为一个精通 OI 的神仙，自然知道这种比较方式是非常不科学的，这样只是在无端拖延时间罢了，但是你却对最后写下的这个字符串很感兴趣。\n\n现在，你得到了这个最后写下的字符串，你需要构造出一种可能的小 X 与小 Y 的点赞数。\n\n当然，有可能不存在任何一种情况的点赞数满足这个字符串，那么你只需要输出 `-1` 即可。\n\n为了方便你输出，请用前导零来补足位数。", "inputFormat": "一行一个字符串 $s$，表示最后写下的字符串。", "outputFormat": "如果有解：\n\n- 第一行一个整数，表示小 X 的点赞数。\n- 第二行一个整数，表示小 Y 的点赞数。\n\n如果无解：\n\n- 一行一个整数 `-1`。", "hint": "**本题采用捆绑测试。**\n\n- Subtask 1（11 points）：$\\text{len}(s) = 1$。\n- Subtask 2（42 points）：$s_i \\in \\{\\texttt{X},\\texttt{Y}\\}$。\n- Subtask 3（21 points）：数据保证有解。\n- Subtask 4（26 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$s_i \\in \\{\\texttt{X},\\texttt{Y},\\texttt{Z}\\}$，$1 \\le \\text{len}(s) \\le 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-4] Singing Contest", "background": "**In-contest reminder: This problem provides no explanation for sample 4 or for the no-solution cases.**\n\n**In-contest reminder: This problem provides no explanation for the output format or the Special Judge.**\n\n**In-contest reminder: Sorry, the Special Judge for this problem does not ignore trailing spaces. Please make sure there are no extra characters in the two lines.**\n\n**In-contest reminder: Very sorry, the input data of this problem uses Windows line endings instead of Linux line endings, so there is an extra `\\r` character before the ending `\\n`. Please use `scanf` or `cin` to read the data instead of `getline`, because the latter will read an extra `\\r`.**", "description": "Xiao X took part in a singing contest.\n\nAfter a hard fight, Xiao X finally made it to the final, and his opponent is Xiao Y.\n\nThe champion of this singing contest is decided by the number of likes: whoever has more likes wins.\n\nAfter Xiao X and Xiao Y sang their last song in turn, their final numbers of likes were fixed.\n\nThe moment to announce the champion finally arrived. To build suspense, the host decided to compare their numbers of likes starting from the last digit, moving left one digit at a time.\n\nFor example, Xiao X has $37$ likes, and Xiao Y has $28$ likes. First compare the last digit: Xiao X has $7$ and Xiao Y has $8$, so Xiao Y is temporarily ahead. Then include the previous digit: Xiao X has $37$ and Xiao Y has $28$, so Xiao X is temporarily ahead. After the comparison ends, if we use `X` to represent “Xiao X is temporarily ahead” and `Y` to represent “Xiao Y is temporarily ahead”, we can write down a string `XY`.\n\nFor another example, Xiao X has $137$ likes and Xiao Y has $47$ likes. If we additionally use `Z` to represent “Xiao X and Xiao Y are temporarily equal”, then the written string should be `XYZ`.\n\nAs someone who is good at OI, you of course know that this comparison method is not scientific at all—it just wastes time. However, you are very interested in the final string that is written down.\n\nNow you are given this final string, and you need to construct one possible pair of like counts for Xiao X and Xiao Y.\n\nOf course, it is possible that no pair of like counts can match this string. In that case, you only need to output `-1`.\n\nTo make output easier, please use leading zeros to pad the number of digits.", "inputFormat": "One line with a string $s$, representing the final written string.", "outputFormat": "If there is a solution:\n\n- The first line contains an integer, the number of likes for Xiao X.\n- The second line contains an integer, the number of likes for Xiao Y.\n\nIf there is no solution:\n\n- One line with an integer `-1`.", "hint": "**This problem uses bundled tests.**\n\n- Subtask 1 (11 points): $\\text{len}(s) = 1$.\n- Subtask 2 (42 points): $s_i \\in \\{\\texttt{X},\\texttt{Y}\\}$.\n- Subtask 3 (21 points): The testdata guarantees that a solution exists.\n- Subtask 4 (26 points): No special restrictions.\n\nFor $100\\%$ of the testdata, $s_i \\in \\{\\texttt{X},\\texttt{Y},\\texttt{Z}\\}$, $1 \\le \\text{len}(s) \\le 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-4】歌唱比赛", "background": "**赛时提醒：本题不提供任何关于样例 4 以及无解的解释。**\n\n**赛时提醒：本题不提供任何关于输出格式以及 Special Judge 的解释。**\n\n**赛时提醒：抱歉，本题的 Special Judge 不忽略行末空格，请保证两行中没有多余字符。**\n\n**赛时提醒：非常抱歉，本题输入数据是 Windows 格式，而非 Linux 格式，所以在末尾的 `\\n` 之前有一个多余的 `\\r` 字符。请使用 `scanf` 或 `cin` 读入数据，而非 `getline`，因为后者会多读入一个 `\\r`。**", "description": "小 X 参加了一场歌唱比赛。\n\n经过一路鏖战，小 X 终于挺进了决赛，他的对手是小 Y。\n\n这场歌唱比赛的冠军是由点赞数决定的，谁的点赞数高，谁就能夺冠。\n\n小 X 和小 Y 依次演唱完自己的最后一首歌曲后，他们最终的点赞数确定了下来。\n\n揭晓冠军的时刻终于到来了，主持人为了增加悬念，决定从小 X 与小 Y 的点赞数的最后一位开始，依次比较。\n\n比如，小 X 的点赞数是 $37$，小 Y 的点赞数是 $28$。首先比较最后一位，小 X 是 $7$，小 Y 是 $8$，此时小 Y 暂时领先。再加上前一位，小 X 是 $37$，小 Y 是 $28$，此时小 X 暂时领先。比较结束，如果我们用 `X` 代表小 X 暂时领先，`Y` 代表小 Y 暂时领先，那么可以写下一个字符串 `XY`。\n\n再比如，小 X 的点赞数是 $137$，小 Y 的点赞数是 $47$。如果我们再用 `Z` 表示小 X 与小 Y 的点赞数暂时一样，那么写下的字符串应该为 `XYZ`。\n\n你作为一个精通 OI 的神仙，自然知道这种比较方式是非常不科学的，这样只是在无端拖延时间罢了，但是你却对最后写下的这个字符串很感兴趣。\n\n现在，你得到了这个最后写下的字符串，你需要构造出一种可能的小 X 与小 Y 的点赞数。\n\n当然，有可能不存在任何一种情况的点赞数满足这个字符串，那么你只需要输出 `-1` 即可。\n\n为了方便你输出，请用前导零来补足位数。", "inputFormat": "一行一个字符串 $s$，表示最后写下的字符串。", "outputFormat": "如果有解：\n\n- 第一行一个整数，表示小 X 的点赞数。\n- 第二行一个整数，表示小 Y 的点赞数。\n\n如果无解：\n\n- 一行一个整数 `-1`。", "hint": "**本题采用捆绑测试。**\n\n- Subtask 1（11 points）：$\\text{len}(s) = 1$。\n- Subtask 2（42 points）：$s_i \\in \\{\\texttt{X},\\texttt{Y}\\}$。\n- Subtask 3（21 points）：数据保证有解。\n- Subtask 4（26 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$s_i \\in \\{\\texttt{X},\\texttt{Y},\\texttt{Z}\\}$，$1 \\le \\text{len}(s) \\le 10^6$。", "locale": "zh-CN"}}}
{"pid": "P5596", "type": "P", "difficulty": 5, "samples": [["5 15\n", "1\n"], ["4 4\n", "inf\n"], ["12 6\n", "0\n"], ["96 96\n", "7\n"], ["10000 9999997\n", "6\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "2019", "洛谷原创", "洛谷月赛"], "title": "【XR-4】题", "background": "**赛时提醒：$0$ 是自然数，自然数就是非负整数。**", "description": "小 X 遇到了一道题：\n\n给定自然数 $a,b$，求满足下列条件的自然数对 $(x,y)$ 的个数：\n\n$$y^2 - x^2 = ax + b$$\n\n他不会，只好求助于精通数学的你。\n\n如果有无限多个自然数对满足条件，那么你只需要输出 `inf` 即可。", "inputFormat": "一行两个整数 $a,b$。", "outputFormat": "如果个数有限，一行一个整数，表示个数。\n\n如果个数无限，一行一个字符串 `inf`。", "hint": "#### 【样例 #1 说明】\n\n$$(x,y) = (6,9)$$\n\n---\n\n#### 【数据范围】**\n\n**本题采用捆绑测试**。\n\n- Subtask 1（3 points）：$a = b = 0$。\n- Subtask 2（6 points）：$0 \\le a,b \\le 2$，不存在无限个数的情况。\n- Subtask 3（9 points）：$0 \\le a,b \\le 100$，不存在无限个数的情况。\n- Subtask 4（13 points）：$0 \\le a,b \\le 10^3$，不存在无限个数的情况。\n- Subtask 5（14 points）：$0 \\le a \\le 10^4$，$0 \\le b \\le 10^7$。\n- Subtask 6（14 points）：$a = 0$。\n- Subtask 7（14 points）：$b = 0$。\n- Subtask 8（27 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$0 \\le a \\le 10^8$，$0\\le b \\le 10^{15}$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-4] Problem", "background": "**Reminder during the contest: $0$ is a natural number, and natural numbers are non-negative integers.**", "description": "X encountered a problem:\n\nGiven natural numbers $a, b$, find the number of pairs of natural numbers $(x, y)$ that satisfy:\n\n$$y^2 - x^2 = ax + b$$\n\nHe cannot solve it, so he asks you, who are good at math, for help.\n\nIf there are infinitely many pairs of natural numbers that satisfy the condition, you only need to output `inf`.", "inputFormat": "One line with two integers $a, b$.", "outputFormat": "If the number is finite, output one integer in one line, representing the count.\n\nIf the number is infinite, output one string `inf` in one line.", "hint": "#### Sample #1 Explanation\n\n$$(x,y) = (6,9)$$\n\n---\n\n#### Constraints\n\n**This problem uses bundled testdata.**\n\n- Subtask 1 (3 points): $a = b = 0$.\n- Subtask 2 (6 points): $0 \\le a,b \\le 2$, there is no case with an infinite number of solutions.\n- Subtask 3 (9 points): $0 \\le a,b \\le 100$, there is no case with an infinite number of solutions.\n- Subtask 4 (13 points): $0 \\le a,b \\le 10^3$, there is no case with an infinite number of solutions.\n- Subtask 5 (14 points): $0 \\le a \\le 10^4$, $0 \\le b \\le 10^7$.\n- Subtask 6 (14 points): $a = 0$.\n- Subtask 7 (14 points): $b = 0$.\n- Subtask 8 (27 points): no special constraints.\n\nFor $100\\%$ of the testdata, $0 \\le a \\le 10^8$, $0 \\le b \\le 10^{15}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-4】题", "background": "**赛时提醒：$0$ 是自然数，自然数就是非负整数。**", "description": "小 X 遇到了一道题：\n\n给定自然数 $a,b$，求满足下列条件的自然数对 $(x,y)$ 的个数：\n\n$$y^2 - x^2 = ax + b$$\n\n他不会，只好求助于精通数学的你。\n\n如果有无限多个自然数对满足条件，那么你只需要输出 `inf` 即可。", "inputFormat": "一行两个整数 $a,b$。", "outputFormat": "如果个数有限，一行一个整数，表示个数。\n\n如果个数无限，一行一个字符串 `inf`。", "hint": "#### 【样例 #1 说明】\n\n$$(x,y) = (6,9)$$\n\n---\n\n#### 【数据范围】**\n\n**本题采用捆绑测试**。\n\n- Subtask 1（3 points）：$a = b = 0$。\n- Subtask 2（6 points）：$0 \\le a,b \\le 2$，不存在无限个数的情况。\n- Subtask 3（9 points）：$0 \\le a,b \\le 100$，不存在无限个数的情况。\n- Subtask 4（13 points）：$0 \\le a,b \\le 10^3$，不存在无限个数的情况。\n- Subtask 5（14 points）：$0 \\le a \\le 10^4$，$0 \\le b \\le 10^7$。\n- Subtask 6（14 points）：$a = 0$。\n- Subtask 7（14 points）：$b = 0$。\n- Subtask 8（27 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$0 \\le a \\le 10^8$，$0\\le b \\le 10^{15}$。", "locale": "zh-CN"}}}
{"pid": "P5597", "type": "P", "difficulty": 6, "samples": [["1313000\n", "3\n"], ["333003003300300\n", "15\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["树形数据结构", "洛谷月赛"], "title": "【XR-4】复读", "background": "**赛时提醒：当机器人在这棵完全二叉树的根时，执行 `U` 是非法的，即你需要保证不可能出现这种情况。**\n\n**赛时提醒：这棵二叉树是无限向下延伸的，即所有节点均有左子节点与右子节点，除了根的所有节点均有父亲。**", "description": "小 X 捡到了一台复读机，这台复读机可以向机器人发号施令。机器人将站在一棵完全二叉树的根上，完全二叉树是无限延伸的。你将向复读机录入一串指令，这串指令单个字符可以是：\n\n* `L`：命令机器人向当前节点的左子走；\n* `R`：命令机器人向当前节点的右子走；\n* `U`：命令机器人向当前节点的父亲走（若没有，则命令非法）。\n\n录入指令后，复读机将会把指令无限复读下去。比如命令为 `LR`，那么机器人会遵从 `LRLRLRLR...` 一直走下去。\n\n这棵完全二叉树上有一个 $n$ 个节点的连通块，保证这个连通块包含根节点。连通块上的每个节点都埋有宝藏，机器人到达过的地方如果有宝藏，则会将其开采。如果一个地方没有宝藏，机器人也可以到那里去。机器人也可以反复经过一个地方。\n\n显然，这个连通块本身也是一棵二叉树。\n\n现在，有人告诉了小 X 埋有宝藏的这棵二叉树的前序遍历，小 X 需要寻找到一条尽量短的指令，使得机器人能够挖掘出所有宝藏。", "inputFormat": "一行一个字符串，由 `0123` 中的字符组成，表示埋有宝藏的这棵二叉树的前序遍历。\n\n* `0`：表示这是一个没有儿子的节点。\n* `1`：表示这是一个只有左子的节点。\n* `2`：表示这是一个只有右子的节点。\n* `3`：表示这是一个既有左子又有右子的节点。", "outputFormat": "一个整数，表示最短指令的长度。", "hint": "【样例 1 说明】\n\n一种可行的最短指令为 `LRU`。\n\n---\n\n**本题采用捆绑测试。**\n\n- Subtask 1（31 points）：$2 \\le n \\le 10$。\n- Subtask 2（32 points）：$2 \\le n \\le 200$。\n- Subtask 3（37 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$2 \\le n \\le 2 \\times 10^3$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-4] Repeater.", "background": "**Contest reminder: When the robot is at the root of this complete binary tree, executing `U` is illegal. That is, you must ensure this can never happen.**\n\n**Contest reminder: This binary tree extends infinitely downward, meaning every node has a left child and a right child. All nodes except the root have a parent.**", "description": "X found a repeater machine, which can be used to give commands to a robot. The robot will stand at the root of a complete binary tree, and this complete binary tree extends infinitely. You will input a string of commands into the repeater. Each character of the command string can be:\n\n* `L`: command the robot to move to the left child of the current node.\n* `R`: command the robot to move to the right child of the current node.\n* `U`: command the robot to move to the parent of the current node (if there is no parent, then the command is illegal).\n\nAfter the commands are entered, the repeater will repeat them forever. For example, if the command is `LR`, then the robot will follow `LRLRLRLR...` and keep moving.\n\nOn this complete binary tree, there is a connected component containing $n$ nodes, and it is guaranteed that this component contains the root. Every node in the component has a treasure buried. If the robot ever reaches a place with a treasure, it will mine it. If a place has no treasure, the robot can still go there. The robot may also pass through the same place multiple times.\n\nClearly, this connected component itself is also a binary tree.\n\nNow, someone tells X the preorder traversal of this treasure-burying binary tree. X needs to find a command string as short as possible so that the robot can mine all treasures.", "inputFormat": "One line containing a string consisting of characters from `0123`, representing the preorder traversal of the treasure-burying binary tree.\n\n* `0`: a node with no children.\n* `1`: a node with only a left child.\n* `2`: a node with only a right child.\n* `3`: a node with both a left child and a right child.", "outputFormat": "One integer, the length of the shortest command string.", "hint": "[Sample 1 Explanation]\n\nOne possible shortest command string is `LRU`.\n\n---\n\n**This problem uses bundled testdata.**\n\n- Subtask 1 (31 points): $2 \\le n \\le 10$.\n- Subtask 2 (32 points): $2 \\le n \\le 200$.\n- Subtask 3 (37 points): no special constraints.\n\nFor $100\\%$ of the data, $2 \\le n \\le 2 \\times 10^3$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-4】复读", "background": "**赛时提醒：当机器人在这棵完全二叉树的根时，执行 `U` 是非法的，即你需要保证不可能出现这种情况。**\n\n**赛时提醒：这棵二叉树是无限向下延伸的，即所有节点均有左子节点与右子节点，除了根的所有节点均有父亲。**", "description": "小 X 捡到了一台复读机，这台复读机可以向机器人发号施令。机器人将站在一棵完全二叉树的根上，完全二叉树是无限延伸的。你将向复读机录入一串指令，这串指令单个字符可以是：\n\n* `L`：命令机器人向当前节点的左子走；\n* `R`：命令机器人向当前节点的右子走；\n* `U`：命令机器人向当前节点的父亲走（若没有，则命令非法）。\n\n录入指令后，复读机将会把指令无限复读下去。比如命令为 `LR`，那么机器人会遵从 `LRLRLRLR...` 一直走下去。\n\n这棵完全二叉树上有一个 $n$ 个节点的连通块，保证这个连通块包含根节点。连通块上的每个节点都埋有宝藏，机器人到达过的地方如果有宝藏，则会将其开采。如果一个地方没有宝藏，机器人也可以到那里去。机器人也可以反复经过一个地方。\n\n显然，这个连通块本身也是一棵二叉树。\n\n现在，有人告诉了小 X 埋有宝藏的这棵二叉树的前序遍历，小 X 需要寻找到一条尽量短的指令，使得机器人能够挖掘出所有宝藏。", "inputFormat": "一行一个字符串，由 `0123` 中的字符组成，表示埋有宝藏的这棵二叉树的前序遍历。\n\n* `0`：表示这是一个没有儿子的节点。\n* `1`：表示这是一个只有左子的节点。\n* `2`：表示这是一个只有右子的节点。\n* `3`：表示这是一个既有左子又有右子的节点。", "outputFormat": "一个整数，表示最短指令的长度。", "hint": "【样例 1 说明】\n\n一种可行的最短指令为 `LRU`。\n\n---\n\n**本题采用捆绑测试。**\n\n- Subtask 1（31 points）：$2 \\le n \\le 10$。\n- Subtask 2（32 points）：$2 \\le n \\le 200$。\n- Subtask 3（37 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$2 \\le n \\le 2 \\times 10^3$。", "locale": "zh-CN"}}}
{"pid": "P5598", "type": "P", "difficulty": 7, "samples": [["2 2\n1 2\n", "3\n"], ["4 7\n1 2 8 9\n", "28\n"], ["15 5\n1 5 26 1 0 5 0 6 7 51 1 5 26 1 0\n", "124\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "Lucas 定理", "洛谷月赛"], "title": "【XR-4】混乱度", "background": "", "description": "小 X 有 $n$ 种颜色的球，其中第 $i$ 种颜色的球共有 $a_i$ 个，同色的球无法区分。定义第 $l \\sim r$ 种颜色的混乱度 $f(l, r)$ 为：将第 $l \\sim r$ 种颜色的所有球排成一排，总共的方案数对 $p$ 取模后的值。小 X 想请你帮忙计算下列式子的值：\n\n$$ \\sum_{l=1}^n \\sum_{r=l}^n f(l, r) $$", "inputFormat": "第一行两个整数 $n, p$。\n\n第二行 $n$ 个整数 $a_i$。\n", "outputFormat": "一行一个整数，表示答案。", "hint": "【样例 1 说明】\n\n$$f(1,1) = 1 \\bmod 2 = 1$$\n\n$$f(1,2) = 3 \\bmod 2 = 1$$\n\n$$f(2,2) = 1 \\bmod 2 = 1$$\n\n$$ \\sum_{l=1}^n \\sum_{r=l}^n f(l, r)  = 3$$\n\n---\n\n**本题采用捆绑测试。**\n\n- Subtask 1（31 points）：$1 \\le n \\le 5 \\times 10^5$，$a_i$ 在 $[0, 10^5]$ 内均匀随机，时限 $1.5 \\text{ s}$。\n- Subtask 2（32 points）：$1 \\le n \\le 5 \\times 10^4$，时限 $5 \\text{ s}$。\n- Subtask 3（37 points）：无特殊限制，时限 $2.5 \\text{ s}$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 5 \\times 10^5$，$0 \\le a_i \\le 10^{18}$，$p \\in \\{2,3,5,7\\}$。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-4] Disorder Degree", "background": "", "description": "Xiao X has balls of $n$ different colors. For the $i$-th color, there are $a_i$ balls. Balls of the same color are indistinguishable. Define the disorder degree $f(l, r)$ for colors $l \\sim r$ as follows: line up all balls of colors $l \\sim r$ in a row, and let $f(l, r)$ be the total number of distinct arrangements modulo $p$. Xiao X wants you to help compute the value of:\n\n$$ \\sum_{l=1}^n \\sum_{r=l}^n f(l, r) $$", "inputFormat": "The first line contains two integers $n, p$.\n\nThe second line contains $n$ integers $a_i$.", "outputFormat": "Output one integer in one line, representing the answer.", "hint": "[Sample 1 Explanation]\n\n$$f(1,1) = 1 \\bmod 2 = 1$$\n\n$$f(1,2) = 3 \\bmod 2 = 1$$\n\n$$f(2,2) = 1 \\bmod 2 = 1$$\n\n$$ \\sum_{l=1}^n \\sum_{r=l}^n f(l, r)  = 3$$\n\n---\n\n**This problem uses bundled testdata.**\n\n- Subtask 1 (31 points): $1 \\le n \\le 5 \\times 10^5$, $a_i$ is uniformly random in $[0, 10^5]$, time limit $1.5 \\text{ s}$.\n- Subtask 2 (32 points): $1 \\le n \\le 5 \\times 10^4$, time limit $5 \\text{ s}$.\n- Subtask 3 (37 points): no special constraints, time limit $2.5 \\text{ s}$.\n\nFor $100\\%$ of the data, $1 \\le n \\le 5 \\times 10^5$, $0 \\le a_i \\le 10^{18}$, $p \\in \\{2,3,5,7\\}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-4】混乱度", "background": "", "description": "小 X 有 $n$ 种颜色的球，其中第 $i$ 种颜色的球共有 $a_i$ 个，同色的球无法区分。定义第 $l \\sim r$ 种颜色的混乱度 $f(l, r)$ 为：将第 $l \\sim r$ 种颜色的所有球排成一排，总共的方案数对 $p$ 取模后的值。小 X 想请你帮忙计算下列式子的值：\n\n$$ \\sum_{l=1}^n \\sum_{r=l}^n f(l, r) $$", "inputFormat": "第一行两个整数 $n, p$。\n\n第二行 $n$ 个整数 $a_i$。\n", "outputFormat": "一行一个整数，表示答案。", "hint": "【样例 1 说明】\n\n$$f(1,1) = 1 \\bmod 2 = 1$$\n\n$$f(1,2) = 3 \\bmod 2 = 1$$\n\n$$f(2,2) = 1 \\bmod 2 = 1$$\n\n$$ \\sum_{l=1}^n \\sum_{r=l}^n f(l, r)  = 3$$\n\n---\n\n**本题采用捆绑测试。**\n\n- Subtask 1（31 points）：$1 \\le n \\le 5 \\times 10^5$，$a_i$ 在 $[0, 10^5]$ 内均匀随机，时限 $1.5 \\text{ s}$。\n- Subtask 2（32 points）：$1 \\le n \\le 5 \\times 10^4$，时限 $5 \\text{ s}$。\n- Subtask 3（37 points）：无特殊限制，时限 $2.5 \\text{ s}$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 5 \\times 10^5$，$0 \\le a_i \\le 10^{18}$，$p \\in \\{2,3,5,7\\}$。", "locale": "zh-CN"}}}
{"pid": "P5599", "type": "P", "difficulty": 7, "samples": [["6 2 5\nBBABBA\nBB\nBAB\n1 1 6\n2 3 5 A\n1 2 3\n2 1 6 B\n1 1 5\n", "3\n0\n4\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["线段树", "O2优化", "AC 自动机", "洛谷月赛"], "title": "【XR-4】文本编辑器", "background": "**赛时提醒：本题输入数据是 Windows 格式，而非 Linux 格式，所以在每一行末尾的 `\\n` 之前有一个多余的 `\\r` 字符。请使用 `scanf` 或 `cin` 读入数据，而非 `getline`，因为后者会多读入一个 `\\r`。**", "description": "小 X 在制作一个文本编辑器，现在需要实现最基本的“**查找和替换**”功能。\n\n在文本编辑器中，文件是以一个长度为 $n$ 的字符串 $a$ 的形式存储的。\n\n同时，用户拥有一个包含 $m$ 个**单词**的字典，每个单词都是一个字符串，称第 $i$ 个单词为 $s_i$。\n\n接下来定义**查找和替换**功能：\n\n- **查找功能**：有两个参数 $l, r$，表示询问对于字典中的每个**单词** $s_i$，$a[l : r]$ 中 $s_i$ 的出现次数之和。  \n即询问 $\\displaystyle \\sum_{i=1}^{m} \\mathrm{occur}(s_i, a[l : r])$，其中 $\\mathrm{occur}(s, t)$ 表示字符串 $s$ 在字符串 $t$ 中的出现次数。\n\n- **替换功能**：有三个参数 $l, r, t$，其中 $t$ 是一个字符串，表示将 $a[l : r]$ 替换为 $t$ 不断重复的结果。  \n即如果把 $\\texttt{Mds72SKsLL}$ 替换为 $\\texttt{Rabb}$ 不断重复的结果，则原字符串变为 $\\texttt{RabbRabbRa}$。\n\n用户给出了 $q$ 个操作，每个操作是**查找**或**替换**之一，你需要正确回答每个**查找**操作的答案。", "inputFormat": "第一行三个整数 $n, m, q$，依次表示文件 $a$ 的长度，字典中的单词数，询问的个数。\n\n第二行一个长度为 $n$ 的字符串 $a$，表示初始文件。\n\n接下来 $m$ 行，第 $i$ 行一个字符串，表示第 $i$ 个单词 $s_i$。\n\n接下来 $q$ 行，每行表示一个操作：  \n每行的第一个数 $\\mathrm{op}$ 表示此次操作的类型；  \n若 $\\mathrm{op} = 1$，则接下来两个整数 $l, r$，表示这是一次**查找**操作，参数为 $l, r$；  \n若 $\\mathrm{op} = 2$，则接下来两个整数 $l, r$ 和一个字符串 $t$，表示这是一次**替换**操作，参数为 $l, r, t$。", "outputFormat": "对于每个**查找**操作，一行一个整数，表示本次查找操作的答案。", "hint": "**本题采用捆绑测试。**\n\n- Subtask 1（7 points）：$n, m, q \\le 50$，所有字符串长度 $\\le 50$，时限 $1\\text{s}$。\n- Subtask 2（7 points）：$n, q \\le 3000$，时限 $1\\text{s}$。\n- Subtask 3（13 points）：$m = 1$，时限 $2\\text{s}$。\n- Subtask 4（17 points）：没有**替换**操作，即 $\\mathrm{op} = 1$，时限 $2\\text{s}$。\n- Subtask 5（18 points）：$n, q \\le 8 \\times 10^4$，$\\displaystyle \\sum |s_i| \\le 50$，$\\displaystyle \\sum |t| \\le 8 \\times 10^4$，时限 $1\\text{s}$。\n- Subtask 6（13 points）：$n, q \\le 5\\times 10^4$，$\\displaystyle \\sum |s_i| \\le 5\\times 10^4$，$\\displaystyle \\sum |t| \\le 5\\times 10^4$，时限 $1\\text{s}$。\n- Subtask 7（25 points）：无特殊限制，时限 $2\\text{s}$。\n\n对于 $100\\%$ 的数据：  \n对 $n, m, q, l, r, \\mathrm{op}$ 的限制：$1 \\le l \\le r \\le n \\le 10^6$，$1 \\le m, q \\le 10^5$，$\\mathrm{op} \\in \\{ 1, 2 \\}$。  \n对字符串长度的限制：$|s_i| \\le 50$，$\\displaystyle \\sum |s_i| \\le 2 \\times 10^5$，$\\displaystyle \\sum |t| \\le 10^6$。  \n所有字符串保证不为空串，且出现的字符属于集合 $\\mathbf{\\Sigma}$，其中 $\\mathbf{\\Sigma} = [\\texttt a, \\texttt z] \\cup [\\texttt A, \\texttt Z] \\cup [\\texttt 0, \\texttt 9]$，即所有大小写英文字母以及数字，故 $|\\mathbf{\\Sigma}| = 62$。\n\n**需要特别注意的是，与文件相比，单词的长度是非常小的。在解题时你可能需要利用这一点。**\n\n----\n\n**【一些定义】**\n\n对于一个长度为 $\\mathrm{len}$ 的字符串 $s$，符号 $s[l : r]$（$1 \\le l \\le r \\le \\mathrm{len}$）表示 $s$ 中从 $l$ 到 $r$ 的**子串**。即 $s$ 中从第 $l$ 个字符到第 $r$ 个字符（包含端点）连续拼接在一起形成的字符串。  \n对于一个字符串 $s$，符号 $|s|$ 表示它的长度。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-4] Text Editor", "background": "**Reminder during the contest: The input for this problem uses Windows line endings, not Linux line endings, so there is an extra `\\r` character before `\\n` at the end of each line. Please use `scanf` or `cin` to read the input, rather than `getline`, because the latter will read an extra `\\r`.**", "description": "Little X is building a text editor and now needs to implement the most basic “**find and replace**” feature.\n\nIn the text editor, the file is stored as a string $a$ of length $n$.\n\nMeanwhile, the user has a dictionary containing $m$ **words**. Each word is a string, and the $i$-th word is denoted by $s_i$.\n\nNext, define the **find and replace** feature:\n\n- **Find**: There are two parameters $l, r$, asking for the sum, over every **word** $s_i$ in the dictionary, of the number of occurrences of $s_i$ in $a[l : r]$.  \nThat is, compute $\\displaystyle \\sum_{i=1}^{m} \\mathrm{occur}(s_i, a[l : r])$, where $\\mathrm{occur}(s, t)$ denotes the number of occurrences of string $s$ in string $t$.\n\n- **Replace**: There are three parameters $l, r, t$, where $t$ is a string, meaning to replace $a[l : r]$ with the result of repeating $t$ endlessly and taking the needed prefix.  \nFor example, if we replace $\\texttt{Mds72SKsLL}$ with the endlessly repeated string $\\texttt{Rabb}$, then the original string becomes $\\texttt{RabbRabbRa}$.\n\nThe user provides $q$ operations, each being either **find** or **replace**. You need to output the correct answer for every **find** operation.", "inputFormat": "The first line contains three integers $n, m, q$, representing the length of the file $a$, the number of words in the dictionary, and the number of queries.\n\nThe second line contains a string $a$ of length $n$, representing the initial file.\n\nThe next $m$ lines each contain a string; the $i$-th line is the $i$-th word $s_i$.\n\nThe next $q$ lines each describe an operation:  \nThe first number on each line is $\\mathrm{op}$, indicating the type of operation.  \nIf $\\mathrm{op} = 1$, then two integers $l, r$ follow, meaning this is a **find** operation with parameters $l, r$.  \nIf $\\mathrm{op} = 2$, then two integers $l, r$ and a string $t$ follow, meaning this is a **replace** operation with parameters $l, r, t$.", "outputFormat": "For each **find** operation, output one integer per line, representing the answer to this find query.", "hint": "**This problem uses bundled testdata.**\n\n- Subtask 1 (7 points): $n, m, q \\le 50$, all string lengths $\\le 50$, time limit $1\\text{s}$.\n- Subtask 2 (7 points): $n, q \\le 3000$, time limit $1\\text{s}$.\n- Subtask 3 (13 points): $m = 1$, time limit $2\\text{s}$.\n- Subtask 4 (17 points): There are no **replace** operations, i.e. $\\mathrm{op} = 1$, time limit $2\\text{s}$.\n- Subtask 5 (18 points): $n, q \\le 8 \\times 10^4$, $\\displaystyle \\sum |s_i| \\le 50$, $\\displaystyle \\sum |t| \\le 8 \\times 10^4$, time limit $1\\text{s}$.\n- Subtask 6 (13 points): $n, q \\le 5\\times 10^4$, $\\displaystyle \\sum |s_i| \\le 5\\times 10^4$, $\\displaystyle \\sum |t| \\le 5\\times 10^4$, time limit $1\\text{s}$.\n- Subtask 7 (25 points): No special constraints, time limit $2\\text{s}$.\n\nFor $100\\%$ of the data:  \nConstraints on $n, m, q, l, r, \\mathrm{op}$: $1 \\le l \\le r \\le n \\le 10^6$, $1 \\le m, q \\le 10^5$, $\\mathrm{op} \\in \\{ 1, 2 \\}$.  \nConstraints on string lengths: $|s_i| \\le 50$, $\\displaystyle \\sum |s_i| \\le 2 \\times 10^5$, $\\displaystyle \\sum |t| \\le 10^6$.  \nAll strings are guaranteed to be non-empty, and all characters belong to the set $\\mathbf{\\Sigma}$, where $\\mathbf{\\Sigma} = [\\texttt a, \\texttt z] \\cup [\\texttt A, \\texttt Z] \\cup [\\texttt 0, \\texttt 9]$, i.e. all lowercase letters, uppercase letters, and digits, so $|\\mathbf{\\Sigma}| = 62$.\n\n**A special note: Compared to the file, the words are very short. You may need to make use of this when solving the problem.**\n\n----\n\n**[Some definitions]**\n\nFor a string $s$ of length $\\mathrm{len}$, the notation $s[l : r]$ ($1 \\le l \\le r \\le \\mathrm{len}$) denotes the **substring** of $s$ from $l$ to $r$. That is, the string formed by concatenating the $l$-th through the $r$-th characters of $s (inclusive) in order.  \nFor a string $s$, the notation $|s|$ denotes its length.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-4】文本编辑器", "background": "**赛时提醒：本题输入数据是 Windows 格式，而非 Linux 格式，所以在每一行末尾的 `\\n` 之前有一个多余的 `\\r` 字符。请使用 `scanf` 或 `cin` 读入数据，而非 `getline`，因为后者会多读入一个 `\\r`。**", "description": "小 X 在制作一个文本编辑器，现在需要实现最基本的“**查找和替换**”功能。\n\n在文本编辑器中，文件是以一个长度为 $n$ 的字符串 $a$ 的形式存储的。\n\n同时，用户拥有一个包含 $m$ 个**单词**的字典，每个单词都是一个字符串，称第 $i$ 个单词为 $s_i$。\n\n接下来定义**查找和替换**功能：\n\n- **查找功能**：有两个参数 $l, r$，表示询问对于字典中的每个**单词** $s_i$，$a[l : r]$ 中 $s_i$ 的出现次数之和。  \n即询问 $\\displaystyle \\sum_{i=1}^{m} \\mathrm{occur}(s_i, a[l : r])$，其中 $\\mathrm{occur}(s, t)$ 表示字符串 $s$ 在字符串 $t$ 中的出现次数。\n\n- **替换功能**：有三个参数 $l, r, t$，其中 $t$ 是一个字符串，表示将 $a[l : r]$ 替换为 $t$ 不断重复的结果。  \n即如果把 $\\texttt{Mds72SKsLL}$ 替换为 $\\texttt{Rabb}$ 不断重复的结果，则原字符串变为 $\\texttt{RabbRabbRa}$。\n\n用户给出了 $q$ 个操作，每个操作是**查找**或**替换**之一，你需要正确回答每个**查找**操作的答案。", "inputFormat": "第一行三个整数 $n, m, q$，依次表示文件 $a$ 的长度，字典中的单词数，询问的个数。\n\n第二行一个长度为 $n$ 的字符串 $a$，表示初始文件。\n\n接下来 $m$ 行，第 $i$ 行一个字符串，表示第 $i$ 个单词 $s_i$。\n\n接下来 $q$ 行，每行表示一个操作：  \n每行的第一个数 $\\mathrm{op}$ 表示此次操作的类型；  \n若 $\\mathrm{op} = 1$，则接下来两个整数 $l, r$，表示这是一次**查找**操作，参数为 $l, r$；  \n若 $\\mathrm{op} = 2$，则接下来两个整数 $l, r$ 和一个字符串 $t$，表示这是一次**替换**操作，参数为 $l, r, t$。", "outputFormat": "对于每个**查找**操作，一行一个整数，表示本次查找操作的答案。", "hint": "**本题采用捆绑测试。**\n\n- Subtask 1（7 points）：$n, m, q \\le 50$，所有字符串长度 $\\le 50$，时限 $1\\text{s}$。\n- Subtask 2（7 points）：$n, q \\le 3000$，时限 $1\\text{s}$。\n- Subtask 3（13 points）：$m = 1$，时限 $2\\text{s}$。\n- Subtask 4（17 points）：没有**替换**操作，即 $\\mathrm{op} = 1$，时限 $2\\text{s}$。\n- Subtask 5（18 points）：$n, q \\le 8 \\times 10^4$，$\\displaystyle \\sum |s_i| \\le 50$，$\\displaystyle \\sum |t| \\le 8 \\times 10^4$，时限 $1\\text{s}$。\n- Subtask 6（13 points）：$n, q \\le 5\\times 10^4$，$\\displaystyle \\sum |s_i| \\le 5\\times 10^4$，$\\displaystyle \\sum |t| \\le 5\\times 10^4$，时限 $1\\text{s}$。\n- Subtask 7（25 points）：无特殊限制，时限 $2\\text{s}$。\n\n对于 $100\\%$ 的数据：  \n对 $n, m, q, l, r, \\mathrm{op}$ 的限制：$1 \\le l \\le r \\le n \\le 10^6$，$1 \\le m, q \\le 10^5$，$\\mathrm{op} \\in \\{ 1, 2 \\}$。  \n对字符串长度的限制：$|s_i| \\le 50$，$\\displaystyle \\sum |s_i| \\le 2 \\times 10^5$，$\\displaystyle \\sum |t| \\le 10^6$。  \n所有字符串保证不为空串，且出现的字符属于集合 $\\mathbf{\\Sigma}$，其中 $\\mathbf{\\Sigma} = [\\texttt a, \\texttt z] \\cup [\\texttt A, \\texttt Z] \\cup [\\texttt 0, \\texttt 9]$，即所有大小写英文字母以及数字，故 $|\\mathbf{\\Sigma}| = 62$。\n\n**需要特别注意的是，与文件相比，单词的长度是非常小的。在解题时你可能需要利用这一点。**\n\n----\n\n**【一些定义】**\n\n对于一个长度为 $\\mathrm{len}$ 的字符串 $s$，符号 $s[l : r]$（$1 \\le l \\le r \\le \\mathrm{len}$）表示 $s$ 中从 $l$ 到 $r$ 的**子串**。即 $s$ 中从第 $l$ 个字符到第 $r$ 个字符（包含端点）连续拼接在一起形成的字符串。  \n对于一个字符串 $s$，符号 $|s|$ 表示它的长度。", "locale": "zh-CN"}}}
{"pid": "P5600", "type": "P", "difficulty": 7, "samples": [["2\n0.0000000000 0.0000000000\n0.0000000000 1.0000000000\n1\n1 2\n0\n0\n0.8660254038 0.5000000000\n11 10 9 8 7 6 5 4 3 2\n", "2\n1 0.0000000000 0.0000000000 0.0000000000 1.0000000000\n1 0.0000000000 1.0000000000 0.0000000000 0.0000000000\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["提交答案", "Special Judge", "O2优化", "洛谷月赛", "平面几何"], "title": "【XR-4】尺规作图", "background": "这是一道提交答案（人类智慧）题。", "description": "你有若干个已知的几何图形，你需要通过尺规作图得到一个要求的点。你需要在规定步数之内找到这个点。\n\n你可以进行的操作如下：\n\n1. 以一个已知点为圆心，另一个已知点为圆上一点作圆。\n\n2. 连接两个已知点形成一条直线。\n\n你需要输出你的作图步骤。", "inputFormat": "第一行一个整数，表示测试点编号。\n\n第二行一个整数 $n$，表示已知点的数量。\n\n接下来 $n$ 行，第 $i$ 行两个实数 $x_i, y_i$，表示第 $i$ 个点的坐标。\n\n接下来一个整数 $n_1$，表示已知线段的数量。\n\n接下来 $n_1$ 行，每一行两个整数 $u, v$，表示有一条连接点 $u$ 和点 $v$ 的线段。\n\n接下来一个整数 $n_2$，表示已知直线的数量。\n\n接下来 $n_2$ 行，每一行两个整数 $u, v$，表示有一条经过点 $u$ 和点 $v$ 的直线。\n\n接下来一个整数 $n_3$，表示已知圆的数量。\n\n接下来 $n_3$ 行，每一行两个整数 $u, v$，表示有一个以点 $u$ 为圆心，点 $v$ 为圆上一点的圆。\n\n接下来两个实数 $x, y$，表示要求点的坐标。\n\n接下来 $10$ 个整数 $a_1$ 到 $a_{10}$，表示此测试点的评分参数，详见说明。", "outputFormat": "第一行一个整数 $m$，表示你需要的步数。\n\n接下来 $m$ 行描述你的作图步骤：\n\n首先一个整数 $1$ 或 $2$，$1$ 表示你要画一个圆，$2$ 表示你要连一条直线。\n\n接下来四个实数 $x_1, y_1, x_2, y_2$：  \n如果你要画一个圆，表示你要以 $(x_1,y_1)$ 为圆心，$(x_2,y_2)$ 为圆上一点画圆；  \n如果你要连一条线，表示你要将 $(x_1,y_1)$ 与 $(x_2,y_2)$ 连接起来。", "hint": "对于每一个测试点，如果你用的步数小于等于前 $i$ 个评分参数，那么你会得到 $i$ 分。\n\n注意事项如下：\n\n1. **所有的 $x, y$ 必须是你已经得到的点**，这里的已经得到是指输入数据中的点或者已知几何图形的交点。（也就是说你不能随便选择一个点来作图，也不能通过选择一个合适的点来得到要求的点）  \n   更准确地说，每次你输出一个坐标，Special Judge 会选择当前你已经得到的所有点中和你的输入坐标欧几里得距离最近的点作为你这一次的选择点。如果距离最近的点距离大于了 $10^{-5}$，那么这次操作会被判定为不合法，同时这一个点你将得到 $0$ 分。\n\n2. 你不能根据圆心和半径作圆，而只能根据圆心和圆上一点作圆。\n\n3. **你画出的答案与要求的点绝对误差或相对误差不超过 $10^{-5}$ 即为正确**（因为不知道怎么写没有误差的 Special Judge）。  \n   更准确地说，假设你得到的点是 $(x_1, y_1)$，而要求的点是 $(x_2, y_2)$，则你的输出被认为正确，当且仅当 $\\dfrac{|x_1-x_2|}{\\max(|x_2|, 1)} \\le 10^{-5}$ 且 $\\dfrac{|y_1-y_2|}{\\max(|y_2|, 1)} \\le 10^{-5}$。\n\n4. 下发文件中的 `data1.in` 到 `data10.in` 分别为 $10$ 个输入数据，其中第 $1,2,3,7,8$ 这五个测试点配有图解。\n\n5. 下发的 checker 可以判断你的得分。使用方法如下（其中 `data.in` 是输入文件，`data.out` 是你的输出文件。）：  \n\n  - Windows-32/64：\n\n```\nchecker data.in data.out data.out\n```\n\n  - Linux/MacOS：\n\n```\n./checker data.in data.out data.out\n```\n\n6. 出题人拿不到 $100$ 分。\n\nupdate：checker 源码可以点击 [这里](/paste/capu9k2n) 查看，如果有需要改进的地方欢迎提出。", "locale": "zh-CN", "translations": {"en": {"title": "[XR-4] Straightedge and Compass Construction", "background": "This is an output-only (human intelligence) problem.", "description": "You are given several known geometric objects, and you need to construct a required point using straightedge and compass. You must find this point within a limited number of steps.\n\nYou can perform the following operations:\n\n1. Draw a circle with one known point as the center and another known point as a point on the circle.\n\n2. Connect two known points to form a straight line.\n\nYou need to output your construction steps.", "inputFormat": "The first line contains an integer, which is the test point ID.\n\nThe second line contains an integer $n$, which is the number of known points.\n\nThe next $n$ lines each contain two real numbers $x_i, y_i$, which are the coordinates of the $i$-th point.\n\nNext is an integer $n_1$, which is the number of known line segments.\n\nThe next $n_1$ lines each contain two integers $u, v$, meaning there is a line segment connecting point $u$ and point $v$.\n\nNext is an integer $n_2$, which is the number of known lines.\n\nThe next $n_2$ lines each contain two integers $u, v$, meaning there is a line passing through point $u$ and point $v$.\n\nNext is an integer $n_3$, which is the number of known circles.\n\nThe next $n_3$ lines each contain two integers $u, v$, meaning there is a circle centered at point $u$, with point $v$ on the circle.\n\nNext are two real numbers $x, y$, which are the coordinates of the required point.\n\nNext are $10$ integers $a_1$ to $a_{10}$, which are the scoring parameters for this test point. See the statement for details.", "outputFormat": "The first line contains an integer $m$, which is the number of steps you need.\n\nThe next $m$ lines describe your construction steps:\n\nFirst an integer $1$ or $2$. $1$ means you draw a circle, and $2$ means you draw a straight line.\n\nThen four real numbers $x_1, y_1, x_2, y_2$:  \nIf you draw a circle, it means you draw a circle centered at $(x_1, y_1)$ and with $(x_2, y_2)$ as a point on the circle.  \nIf you draw a line, it means you connect $(x_1, y_1)$ and $(x_2, y_2)$.", "hint": "For each test point, if your number of steps is less than or equal to the first $i$ scoring parameters, then you will get $i$ points.\n\nNotes:\n\n1. **All $x, y$ must be points you have already obtained.** “Already obtained” means points from the input, or intersection points of known geometric objects. (That is, you cannot choose an arbitrary point to construct with, and you cannot obtain the required point by choosing some suitable point.)  \n   More precisely, each time you output a coordinate, the Special Judge will choose, among all points you have currently obtained, the point whose Euclidean distance to your input coordinate is the smallest, as the point you selected this time. If this smallest distance is greater than $10^{-5}$, then this operation will be judged invalid, and for this test point you will get $0$ points.\n\n2. You cannot draw a circle from its center and radius. You can only draw a circle from its center and a point on the circle.\n\n3. **Your constructed answer is considered correct if the absolute error or relative error to the required point is at most $10^{-5}$** (because the author does not know how to write a Special Judge with no error).  \n   More precisely, suppose the point you obtained is $(x_1, y_1)$ and the required point is $(x_2, y_2)$. Then your output is considered correct if and only if $\\dfrac{|x_1-x_2|}{\\max(|x_2|, 1)} \\le 10^{-5}$ and $\\dfrac{|y_1-y_2|}{\\max(|y_2|, 1)} \\le 10^{-5}$.\n\n4. The provided files `data1.in` to `data10.in` are the $10$ input datasets. Among them, test points $1, 2, 3, 7, 8$ come with diagrams.\n\n5. The provided checker can compute your score. Usage is as follows (where `data.in` is the input file and `data.out` is your output file.):  \n\n  - Windows-32/64:\n\n```\nchecker data.in data.out data.out\n```\n\n  - Linux/MacOS：\n\n```\n./checker data.in data.out data.out\n```\n\n6. The problem setter cannot get $100$ points.\n\nupdate: You can click [here](/paste/capu9k2n) to view the checker source code. If you have ideas for improvements, feel free to suggest them.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【XR-4】尺规作图", "background": "这是一道提交答案（人类智慧）题。", "description": "你有若干个已知的几何图形，你需要通过尺规作图得到一个要求的点。你需要在规定步数之内找到这个点。\n\n你可以进行的操作如下：\n\n1. 以一个已知点为圆心，另一个已知点为圆上一点作圆。\n\n2. 连接两个已知点形成一条直线。\n\n你需要输出你的作图步骤。", "inputFormat": "第一行一个整数，表示测试点编号。\n\n第二行一个整数 $n$，表示已知点的数量。\n\n接下来 $n$ 行，第 $i$ 行两个实数 $x_i, y_i$，表示第 $i$ 个点的坐标。\n\n接下来一个整数 $n_1$，表示已知线段的数量。\n\n接下来 $n_1$ 行，每一行两个整数 $u, v$，表示有一条连接点 $u$ 和点 $v$ 的线段。\n\n接下来一个整数 $n_2$，表示已知直线的数量。\n\n接下来 $n_2$ 行，每一行两个整数 $u, v$，表示有一条经过点 $u$ 和点 $v$ 的直线。\n\n接下来一个整数 $n_3$，表示已知圆的数量。\n\n接下来 $n_3$ 行，每一行两个整数 $u, v$，表示有一个以点 $u$ 为圆心，点 $v$ 为圆上一点的圆。\n\n接下来两个实数 $x, y$，表示要求点的坐标。\n\n接下来 $10$ 个整数 $a_1$ 到 $a_{10}$，表示此测试点的评分参数，详见说明。", "outputFormat": "第一行一个整数 $m$，表示你需要的步数。\n\n接下来 $m$ 行描述你的作图步骤：\n\n首先一个整数 $1$ 或 $2$，$1$ 表示你要画一个圆，$2$ 表示你要连一条直线。\n\n接下来四个实数 $x_1, y_1, x_2, y_2$：  \n如果你要画一个圆，表示你要以 $(x_1,y_1)$ 为圆心，$(x_2,y_2)$ 为圆上一点画圆；  \n如果你要连一条线，表示你要将 $(x_1,y_1)$ 与 $(x_2,y_2)$ 连接起来。", "hint": "对于每一个测试点，如果你用的步数小于等于前 $i$ 个评分参数，那么你会得到 $i$ 分。\n\n注意事项如下：\n\n1. **所有的 $x, y$ 必须是你已经得到的点**，这里的已经得到是指输入数据中的点或者已知几何图形的交点。（也就是说你不能随便选择一个点来作图，也不能通过选择一个合适的点来得到要求的点）  \n   更准确地说，每次你输出一个坐标，Special Judge 会选择当前你已经得到的所有点中和你的输入坐标欧几里得距离最近的点作为你这一次的选择点。如果距离最近的点距离大于了 $10^{-5}$，那么这次操作会被判定为不合法，同时这一个点你将得到 $0$ 分。\n\n2. 你不能根据圆心和半径作圆，而只能根据圆心和圆上一点作圆。\n\n3. **你画出的答案与要求的点绝对误差或相对误差不超过 $10^{-5}$ 即为正确**（因为不知道怎么写没有误差的 Special Judge）。  \n   更准确地说，假设你得到的点是 $(x_1, y_1)$，而要求的点是 $(x_2, y_2)$，则你的输出被认为正确，当且仅当 $\\dfrac{|x_1-x_2|}{\\max(|x_2|, 1)} \\le 10^{-5}$ 且 $\\dfrac{|y_1-y_2|}{\\max(|y_2|, 1)} \\le 10^{-5}$。\n\n4. 下发文件中的 `data1.in` 到 `data10.in` 分别为 $10$ 个输入数据，其中第 $1,2,3,7,8$ 这五个测试点配有图解。\n\n5. 下发的 checker 可以判断你的得分。使用方法如下（其中 `data.in` 是输入文件，`data.out` 是你的输出文件。）：  \n\n  - Windows-32/64：\n\n```\nchecker data.in data.out data.out\n```\n\n  - Linux/MacOS：\n\n```\n./checker data.in data.out data.out\n```\n\n6. 出题人拿不到 $100$ 分。\n\nupdate：checker 源码可以点击 [这里](/paste/capu9k2n) 查看，如果有需要改进的地方欢迎提出。", "locale": "zh-CN"}}}
{"pid": "P5601", "type": "P", "difficulty": 1, "samples": [["3 4\ndecoak yes\nduliuchutiren nonono\ncsps noiptg\ndecoak yes no qwq qaq\ncsps noiptg noippj noi cspj\ndecoak qwq qaq yesyes yes\nduliuchutiren yes no nono nonono", "A\nA\nD\nD\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["枚举", "洛谷月赛"], "title": "小 D 与笔试", "background": "小 D 是一位即将参加 ION 的 IO 选手，然而笔试题库中数量繁多的奇怪题目让他大伤脑筋，快来帮帮他！", "description": "笔试题库可以抽象为 $n$ 道题目，每道题目由题面和答案组成，都是一个字符串，保证所有题目题面互不相同。\n\n为了检验小 D 背笔试的效果，教练进行了一次模拟考试，考试包含 $q$ 道题目，每道题目都有 $4$ 个选项，小 D 需要从 $4$ 个选项中选出与答案相符的选项。\n\n现在你需要帮助小 D 完成这场考试。", "inputFormat": "第一行两个正整数 $n, q$。\n\n接下来 $n$ 行，每行 $2$ 个用空格分隔的字符串，表示这道题目的题面和答案。\n\n接下来 $q$ 行，每行 $5$ 个用空格分隔的字符串，第一个字符串表示模拟考试中这道题目的题面，其余 $4$ 个字符串按顺序分别为这道题目的选项 A 到选项 D，保证选项各不相同。", "outputFormat": "对于模拟考试中的每道题目，输出一个字符表示这道题目答案对应的选项，保证所有题目均有解。", "hint": "**【数据范围】**\n\n令 $s$ 为输入中字符串长度的最大值。\n\n对于 $30 \\%$ 的数据，$n, q, s \\le 10$。  \n对于另 $20 \\%$ 的数据，$s = 1$。  \n对于 $100 \\%$ 的数据，$n, q, s \\le 100$，所有字符串都由小写拉丁字母组成。", "locale": "zh-CN", "translations": {"en": {"title": "Xiao D and the Written Test", "background": "Xiao D is an IO contestant who is about to take ION. However, the large number of strange problems in the written test question bank gives him a headache. Please help him.", "description": "The written test question bank can be abstracted as $n$ problems. Each problem consists of a statement and an answer, both of which are strings. It is guaranteed that all problem statements are distinct.\n\nTo check how well Xiao D has memorized the written test materials, the coach held a mock exam. The exam contains $q$ problems. Each problem has $4$ options, and Xiao D needs to choose the option that matches the answer among the $4$ options.\n\nNow you need to help Xiao D finish this exam.", "inputFormat": "The first line contains two positive integers $n, q$.\n\nThe next $n$ lines each contain $2$ strings separated by spaces, representing the problem statement and the answer for that problem.\n\nThe next $q$ lines each contain $5$ strings separated by spaces. The first string is the problem statement in the mock exam. The remaining $4$ strings, in order, are options A through D for this problem. It is guaranteed that all options are distinct.", "outputFormat": "For each problem in the mock exam, output a single character indicating which option corresponds to the correct answer. It is guaranteed that every problem has a solution.", "hint": "**Constraints**\n\nLet $s$ be the maximum string length in the input.\n\nFor $30\\%$ of the testdata, $n, q, s \\le 10$.  \nFor another $20\\%$ of the testdata, $s = 1$.  \nFor $100\\%$ of the testdata, $n, q, s \\le 100$, and all strings consist of lowercase Latin letters.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小 D 与笔试", "background": "小 D 是一位即将参加 ION 的 IO 选手，然而笔试题库中数量繁多的奇怪题目让他大伤脑筋，快来帮帮他！", "description": "笔试题库可以抽象为 $n$ 道题目，每道题目由题面和答案组成，都是一个字符串，保证所有题目题面互不相同。\n\n为了检验小 D 背笔试的效果，教练进行了一次模拟考试，考试包含 $q$ 道题目，每道题目都有 $4$ 个选项，小 D 需要从 $4$ 个选项中选出与答案相符的选项。\n\n现在你需要帮助小 D 完成这场考试。", "inputFormat": "第一行两个正整数 $n, q$。\n\n接下来 $n$ 行，每行 $2$ 个用空格分隔的字符串，表示这道题目的题面和答案。\n\n接下来 $q$ 行，每行 $5$ 个用空格分隔的字符串，第一个字符串表示模拟考试中这道题目的题面，其余 $4$ 个字符串按顺序分别为这道题目的选项 A 到选项 D，保证选项各不相同。", "outputFormat": "对于模拟考试中的每道题目，输出一个字符表示这道题目答案对应的选项，保证所有题目均有解。", "hint": "**【数据范围】**\n\n令 $s$ 为输入中字符串长度的最大值。\n\n对于 $30 \\%$ 的数据，$n, q, s \\le 10$。  \n对于另 $20 \\%$ 的数据，$s = 1$。  \n对于 $100 \\%$ 的数据，$n, q, s \\le 100$，所有字符串都由小写拉丁字母组成。", "locale": "zh-CN"}}}
{"pid": "P5602", "type": "P", "difficulty": 2, "samples": [["2\n2 1", "4.50"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["贪心", "Special Judge", "洛谷月赛"], "title": "小 E 与美食", "background": "小 E 是一个热爱美食的高中生，但吃的太多会导致他身体不舒服，他想找到一个能让他最舒服的方案，快来帮帮他！", "description": "小 E 有 $n$ 种美食可供选择，每种美食只能吃一次，第 $i$ 种美食有一个美味值 $a_i$，吃下一个美味值为 $a_i$ 的美食可以让小 E 的满足感提升 $a_i$。\n\n但是小 E 的胃是有极限的，每吃下一个美食，他的饱腹感就会提升 $1$。\n\n小 E 最后的舒适度是他的满足感的平方除以他的饱腹感，你的目标是求出他舒适度能达到的最大值。", "inputFormat": "第一行一个正整数 $n$。\n\n第二行 $n$ 个正整数 $a_1, a_2, \\cdots,  a_n$。\n", "outputFormat": "输出一行一个实数，表示小 E 舒适度的最大值，你的输出与标准答案的相对误差或绝对误差在 $10^{-6}$ 以内即视为正确。", "hint": "**提示**\n\n建议输出**至少 $8$ 位**有效数字。\n\n**样例解释**\n\n容易发现两种美食都吃是最优的，舒适度为 $\\frac{(2+1)^2}{2} = 4.5$。\n\n**数据范围**\n\n对于 $30 \\%$ 的数据，$n, a_i \\le 20$。\n\n对于 $50 \\%$ 的数据，$n, a_i \\le 2000$。\n\n对于另 $15 \\%$ 的数据，所有 $a_i$ 都相等。\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le 3 \\times 10^{5}$，$1 \\le a_i  \\le 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "Little E and Food", "background": "Little E is a high school student who loves food, but eating too much will make him feel unwell. He wants to find a plan that makes him feel the most comfortable. Please help him.", "description": "Little E has $n$ kinds of food to choose from, and each kind of food can be eaten at most once. The $i$-th food has a tastiness value $a_i$. Eating a food with tastiness value $a_i$ increases Little E’s satisfaction by $a_i$.\n\nHowever, Little E’s stomach has a limit. Each time he eats a food, his fullness increases by $1$.\n\nLittle E’s final comfort level is defined as the square of his satisfaction divided by his fullness. Your task is to find the maximum possible comfort level.", "inputFormat": "The first line contains a positive integer $n$.\n\nThe second line contains $n$ positive integers $a_1, a_2, \\cdots, a_n$.", "outputFormat": "Output one real number in one line, representing the maximum comfort level. Your answer is considered correct if its relative error or absolute error is within $10^{-6}$ compared to the standard answer.", "hint": "**Hint**\n\nIt is recommended to output **at least $8$ significant digits**.\n\n**Sample Explanation**\n\nIt is easy to see that eating both kinds of food is optimal. The comfort level is $\\frac{(2+1)^2}{2} = 4.5$.\n\n**Constraints**\n\nFor $30\\%$ of the testdata, $n, a_i \\le 20$.\n\nFor $50\\%$ of the testdata, $n, a_i \\le 2000$.\n\nFor another $15\\%$ of the testdata, all $a_i$ are equal.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 3 \\times 10^{5}$ and $1 \\le a_i \\le 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小 E 与美食", "background": "小 E 是一个热爱美食的高中生，但吃的太多会导致他身体不舒服，他想找到一个能让他最舒服的方案，快来帮帮他！", "description": "小 E 有 $n$ 种美食可供选择，每种美食只能吃一次，第 $i$ 种美食有一个美味值 $a_i$，吃下一个美味值为 $a_i$ 的美食可以让小 E 的满足感提升 $a_i$。\n\n但是小 E 的胃是有极限的，每吃下一个美食，他的饱腹感就会提升 $1$。\n\n小 E 最后的舒适度是他的满足感的平方除以他的饱腹感，你的目标是求出他舒适度能达到的最大值。", "inputFormat": "第一行一个正整数 $n$。\n\n第二行 $n$ 个正整数 $a_1, a_2, \\cdots,  a_n$。\n", "outputFormat": "输出一行一个实数，表示小 E 舒适度的最大值，你的输出与标准答案的相对误差或绝对误差在 $10^{-6}$ 以内即视为正确。", "hint": "**提示**\n\n建议输出**至少 $8$ 位**有效数字。\n\n**样例解释**\n\n容易发现两种美食都吃是最优的，舒适度为 $\\frac{(2+1)^2}{2} = 4.5$。\n\n**数据范围**\n\n对于 $30 \\%$ 的数据，$n, a_i \\le 20$。\n\n对于 $50 \\%$ 的数据，$n, a_i \\le 2000$。\n\n对于另 $15 \\%$ 的数据，所有 $a_i$ 都相等。\n\n对于 $100 \\%$ 的数据，$1 \\le n \\le 3 \\times 10^{5}$，$1 \\le a_i  \\le 10^6$。", "locale": "zh-CN"}}}
{"pid": "P5603", "type": "P", "difficulty": 4, "samples": [["3 2\n1 2\n1 3", "3\n2"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "贪心", "Special Judge", "拓扑排序", "洛谷月赛"], "title": "小 C 与桌游", "background": "小 C 是一个热爱桌游的高中生，现在他被一个桌游难住了，快来帮帮他！", "description": "这个桌游的地图可以被抽象成一个 $n$ 个点，$m$ 条边的**有向无环图**（**不保证连通**），小 C 在这个地图上行走，小 C 能走到某个点当且仅当能够到达这个点的所有点都已经被小 C 走到。小 C 会走到每个点恰好 $1$ 次，并且他能走到哪些点与他当前所在的点没有关系（即可以走到与当前所在的点没有连边的点，只要满足之前的条件）。\n\n小 C 每走到一个标号比之前走到的点都大的点，他就会有 $\\frac{1}{2}$ 的概率从对手那里拿到 $1$ 块筹码，有 $\\frac{1}{2}$ 的概率给对手 $1$ 块筹码，双方初始各有 $1919810$ 个筹码。\n\n小 C 的运气时好时坏，所以他希望你帮他计算出：\n\n- 在最优情况下，即他每次都能从对手那里拿到筹码时，他采取最优的行走方式能得到的筹码数。\n- 在最劣情况下，即对手每次都能从他那里拿到筹码时，他采取最优的行走方式会失去的筹码数。\n\n", "inputFormat": "第一行两个正整数 $n, m$。\n\n接下来 $m$ 行，每行两个正整数 $u, v$，表示地图上有一条有向边 $(u, v)$，不保证无重边。", "outputFormat": "输出两行，每行一个正整数，第一行表示最优情况下小 C 能拿到的筹码数，第二行表示最劣情况下小 C 会失去的筹码数。", "hint": "**样例解释**\n\n最优情况下的行走方式是 $1-2-3$，最劣情况下的行走方式是 $1-3-2$。\n\n**计分方式**\n\n对于每一个测试点：\n\n- 如果你输出格式错误或者两行都不正确，将会得到 $0$ 分。\n- 如果你的输出第一行正确，第二行错误或第二行正确，第一行错误，将会得到这个测试点 $40 \\%$ 的分数。\n- 否则，你将会得到这个测试点 $100 \\%$ 的分数。\n\n**数据范围**\n\n对于 $20\\%$ 的数据，$1 \\le n, m \\le 10$。\n\n对于 $40\\%$ 的数据，$1 \\le n, m \\le 2000$。\n\n对于 $100\\%$ 的数据，$1 \\le n, m \\le 5 \\times 10^5$，$1 \\le u, v \\le n$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Little C and Board Games", "background": "Little C is a high school student who loves board games. Now he is stuck on a board game. Please help him.", "description": "The map of this board game can be seen as a **directed acyclic graph** with $n$ vertices and $m$ edges (**not necessarily connected**). Little C walks on this map. Little C can walk to a vertex if and only if all vertices that can reach this vertex have already been visited by Little C. Little C will visit every vertex exactly $1$ time, and which vertices he can visit does not depend on his current position (that is, he may visit a vertex that has no edge connected to his current vertex, as long as the condition above is satisfied).\n\nEach time Little C visits a vertex whose label is larger than all previously visited vertices, he has probability $\\frac{1}{2}$ to get $1$ chip from the opponent, and probability $\\frac{1}{2}$ to give the opponent $1$ chip. Initially, both sides have $1919810$ chips.\n\nLittle C’s luck changes a lot, so he wants you to compute:\n\n- In the best case, i.e. every time he can get a chip from the opponent, the number of chips he can obtain with an optimal walking strategy.\n- In the worst case, i.e. every time the opponent can get a chip from him, the number of chips he will lose with an optimal walking strategy.", "inputFormat": "The first line contains two positive integers $n, m$.\n\nThe next $m$ lines each contain two positive integers $u, v$, meaning there is a directed edge $(u, v)$ on the map. Multiple edges may exist.", "outputFormat": "Output two lines, each containing one positive integer. The first line is the number of chips Little C can get in the best case. The second line is the number of chips Little C will lose in the worst case.", "hint": "**Sample Explanation**\n\nIn the best case, the walking order is $1-2-3$. In the worst case, the walking order is $1-3-2$.\n\n**Scoring**\n\nFor each test case:\n\n- If your output format is wrong, or both lines are incorrect, you will get $0$ points.\n- If your first line is correct and the second line is wrong, or the second line is correct and the first line is wrong, you will get $40 \\%$ of the points for this test case.\n- Otherwise, you will get $100 \\%$ of the points for this test case.\n\n**Constraints**\n\nFor $20\\%$ of the testdata, $1 \\le n, m \\le 10$.\n\nFor $40\\%$ of the testdata, $1 \\le n, m \\le 2000$.\n\nFor $100\\%$ of the testdata, $1 \\le n, m \\le 5 \\times 10^5$, $1 \\le u, v \\le n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小 C 与桌游", "background": "小 C 是一个热爱桌游的高中生，现在他被一个桌游难住了，快来帮帮他！", "description": "这个桌游的地图可以被抽象成一个 $n$ 个点，$m$ 条边的**有向无环图**（**不保证连通**），小 C 在这个地图上行走，小 C 能走到某个点当且仅当能够到达这个点的所有点都已经被小 C 走到。小 C 会走到每个点恰好 $1$ 次，并且他能走到哪些点与他当前所在的点没有关系（即可以走到与当前所在的点没有连边的点，只要满足之前的条件）。\n\n小 C 每走到一个标号比之前走到的点都大的点，他就会有 $\\frac{1}{2}$ 的概率从对手那里拿到 $1$ 块筹码，有 $\\frac{1}{2}$ 的概率给对手 $1$ 块筹码，双方初始各有 $1919810$ 个筹码。\n\n小 C 的运气时好时坏，所以他希望你帮他计算出：\n\n- 在最优情况下，即他每次都能从对手那里拿到筹码时，他采取最优的行走方式能得到的筹码数。\n- 在最劣情况下，即对手每次都能从他那里拿到筹码时，他采取最优的行走方式会失去的筹码数。\n\n", "inputFormat": "第一行两个正整数 $n, m$。\n\n接下来 $m$ 行，每行两个正整数 $u, v$，表示地图上有一条有向边 $(u, v)$，不保证无重边。", "outputFormat": "输出两行，每行一个正整数，第一行表示最优情况下小 C 能拿到的筹码数，第二行表示最劣情况下小 C 会失去的筹码数。", "hint": "**样例解释**\n\n最优情况下的行走方式是 $1-2-3$，最劣情况下的行走方式是 $1-3-2$。\n\n**计分方式**\n\n对于每一个测试点：\n\n- 如果你输出格式错误或者两行都不正确，将会得到 $0$ 分。\n- 如果你的输出第一行正确，第二行错误或第二行正确，第一行错误，将会得到这个测试点 $40 \\%$ 的分数。\n- 否则，你将会得到这个测试点 $100 \\%$ 的分数。\n\n**数据范围**\n\n对于 $20\\%$ 的数据，$1 \\le n, m \\le 10$。\n\n对于 $40\\%$ 的数据，$1 \\le n, m \\le 2000$。\n\n对于 $100\\%$ 的数据，$1 \\le n, m \\le 5 \\times 10^5$，$1 \\le u, v \\le n$。\n", "locale": "zh-CN"}}}
{"pid": "P5604", "type": "P", "difficulty": 6, "samples": [["3 4\n3 1 2\n2 2 1\n2 2 3\n1 2 3\n1 3 3\n2 2 3", "Yes\nNo"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["线段树", "O2优化", "洛谷月赛"], "title": "小 O 与排列", "background": "小 O 是一个喜爱数学的高中生，他现在在一个与排列有关的问题上陷入了迷茫之中，快来帮帮他！\n\n**注意输入格式有修改，第二行与第三行被调换了。（以现在的题面为准）**", "description": "小 O 有一个长为 $n$ 的排列 $p$，他的好朋友 $\\texttt{euei}$ 有一个长为 $n$，值域是 $[1, n]$ 的序列 $a$。\n\n有一天，小 O 忽然想知道是否存在数对 $i, j$，满足 $l \\le i, j \\le r$，且 $p_{a_i} = a_j$，他轻松地解决了这个问题。但是 $\\texttt{euei}$ 有些时候会修改这个序列某个位置的值，还会对多对不同的 $l, r$ 询问上面的问题，这下小 O 就不会了。\n\n聪明的你能帮助小 O 解决这个问题吗？", "inputFormat": "第一行两个正整数 $n, m$，其中 $m$ 表示修改和询问数之和。\n\n第二行 $n$ 个正整数 $p_1, p_2, \\cdots, p_n$，表示排列 $p$。\n\n第三行 $n$ 个正整数 $a_1, a_2, \\cdots, a_n$，表示初始的序列 $a$。\n\n接下来 $m$ 行，每行三个正整数，为以下两种格式之一：\n\n- `1 i v`，表示将 $a_i$ 修改为 $v$。\n- `2 l r`，表示询问是否存在数对 $i, j$，满足 $l \\le i, j \\le r$，且 $p_{a_i} = a_j$。", "outputFormat": "对于每个询问，如果存在，那么输出 `Yes`，否则输出 `No`。", "hint": "**提示**\n\n本题读入量较大，请使用高效的读入方式。\n\n**样例解释**\n\n对于第一组询问，数对 $2, 3$ 满足要求。\n\n对于第二组询问，没有数对满足要求。\n\n**数据范围**\n\n本题共有 $5$ 个子任务，你需要通过一个子任务内的所有测试点才能取得这个子任务的分数。\n\n对于所有数据，$1 \\le n,m \\le 5\\times 10^5$，$1 \\le a_i, i, v, l, r \\le n$ ，$p_i \\neq i$。\n\n| #    | 分数 | $n, m$           | 特殊性质                        | 时间限制    |\n| ---- | ---- | ---------------- | ------------------------------- | ----------- |\n| 1    | 7    | $\\leqslant 300$  |                                 | $\\text{1s}$ |\n| 2    | 23   | $\\leqslant 2000$ |                                 | $\\text{1s}$ |\n| 3    | 15   |                  | 没有`1`操作                     | $\\text{3s}$ |\n| 4    | 15   |                  | 每次询问时序列 $a$ 都是一个排列 | $\\text{3s}$ |\n| 5    | 40   |                  |                                 | $\\text{3s}$ |\n\n表格中留空表示该项无特殊限制。", "locale": "zh-CN", "translations": {"en": {"title": "Little O and Permutations", "background": "Little O is a high school student who loves mathematics. He is now confused about a problem related to permutations. Please help him!\n\n**Note: The input format has been changed. The second and third lines have been swapped. (Please follow the current statement.)**", "description": "Little O has a permutation $p$ of length $n$. His good friend $\\texttt{euei}$ has a sequence $a$ of length $n$, with values in $[1, n]$.\n\nOne day, Little O suddenly wondered whether there exists a pair of indices $i, j$ such that $l \\le i, j \\le r$ and $p_{a_i} = a_j$. He solved this problem easily. However, $\\texttt{euei}$ sometimes modifies the value at some position in this sequence, and also asks the above question for many different pairs $l, r$. Now Little O does not know how to handle it.\n\nCan you, the smart one, help Little O solve this problem?", "inputFormat": "The first line contains two positive integers $n, m$, where $m$ is the total number of modifications and queries.\n\nThe second line contains $n$ positive integers $p_1, p_2, \\cdots, p_n$, representing the permutation $p$.\n\nThe third line contains $n$ positive integers $a_1, a_2, \\cdots, a_n$, representing the initial sequence $a$.\n\nThe next $m$ lines each contain three positive integers, in one of the following two formats:\n\n- `1 i v`, meaning set $a_i$ to $v$.\n- `2 l r`, meaning query whether there exists a pair of indices $i, j$ such that $l \\le i, j \\le r$ and $p_{a_i} = a_j$.", "outputFormat": "For each query, if such a pair exists, output `Yes`; otherwise output `No`.", "hint": "**Hint**\n\nThe input size is large, so please use a fast input method.\n\n**Explanation of the samples**\n\nFor the first query, the pair $2, 3$ satisfies the requirement.\n\nFor the second query, no pair satisfies the requirement.\n\n**Constraints**\n\nThis problem has $5$ subtasks. You must pass all test points within a subtask to get the score for that subtask.\n\nFor all testdata, $1 \\le n,m \\le 5\\times 10^5$, $1 \\le a_i, i, v, l, r \\le n$, $p_i \\neq i$.\n\n| #    | Score | $n, m$           | Special Properties                    | Time Limit  |\n| ---- | ----- | ---------------- | ------------------------------------- | ----------- |\n| 1    | 7     | $\\leqslant 300$  |                                       | $\\text{1s}$ |\n| 2    | 23    | $\\leqslant 2000$ |                                       | $\\text{1s}$ |\n| 3    | 15    |                  | No `1` operations                     | $\\text{3s}$ |\n| 4    | 15    |                  | In each query, sequence $a$ is a permutation | $\\text{3s}$ |\n| 5    | 40    |                  |                                       | $\\text{3s}$ |\n\nBlank entries in the table mean there are no special restrictions for that item.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小 O 与排列", "background": "小 O 是一个喜爱数学的高中生，他现在在一个与排列有关的问题上陷入了迷茫之中，快来帮帮他！\n\n**注意输入格式有修改，第二行与第三行被调换了。（以现在的题面为准）**", "description": "小 O 有一个长为 $n$ 的排列 $p$，他的好朋友 $\\texttt{euei}$ 有一个长为 $n$，值域是 $[1, n]$ 的序列 $a$。\n\n有一天，小 O 忽然想知道是否存在数对 $i, j$，满足 $l \\le i, j \\le r$，且 $p_{a_i} = a_j$，他轻松地解决了这个问题。但是 $\\texttt{euei}$ 有些时候会修改这个序列某个位置的值，还会对多对不同的 $l, r$ 询问上面的问题，这下小 O 就不会了。\n\n聪明的你能帮助小 O 解决这个问题吗？", "inputFormat": "第一行两个正整数 $n, m$，其中 $m$ 表示修改和询问数之和。\n\n第二行 $n$ 个正整数 $p_1, p_2, \\cdots, p_n$，表示排列 $p$。\n\n第三行 $n$ 个正整数 $a_1, a_2, \\cdots, a_n$，表示初始的序列 $a$。\n\n接下来 $m$ 行，每行三个正整数，为以下两种格式之一：\n\n- `1 i v`，表示将 $a_i$ 修改为 $v$。\n- `2 l r`，表示询问是否存在数对 $i, j$，满足 $l \\le i, j \\le r$，且 $p_{a_i} = a_j$。", "outputFormat": "对于每个询问，如果存在，那么输出 `Yes`，否则输出 `No`。", "hint": "**提示**\n\n本题读入量较大，请使用高效的读入方式。\n\n**样例解释**\n\n对于第一组询问，数对 $2, 3$ 满足要求。\n\n对于第二组询问，没有数对满足要求。\n\n**数据范围**\n\n本题共有 $5$ 个子任务，你需要通过一个子任务内的所有测试点才能取得这个子任务的分数。\n\n对于所有数据，$1 \\le n,m \\le 5\\times 10^5$，$1 \\le a_i, i, v, l, r \\le n$ ，$p_i \\neq i$。\n\n| #    | 分数 | $n, m$           | 特殊性质                        | 时间限制    |\n| ---- | ---- | ---------------- | ------------------------------- | ----------- |\n| 1    | 7    | $\\leqslant 300$  |                                 | $\\text{1s}$ |\n| 2    | 23   | $\\leqslant 2000$ |                                 | $\\text{1s}$ |\n| 3    | 15   |                  | 没有`1`操作                     | $\\text{3s}$ |\n| 4    | 15   |                  | 每次询问时序列 $a$ 都是一个排列 | $\\text{3s}$ |\n| 5    | 40   |                  |                                 | $\\text{3s}$ |\n\n表格中留空表示该项无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P5605", "type": "P", "difficulty": 6, "samples": [["9 3\n1 4\n2 1\n7 4", "No\nYes\nYes"], ["29788562298698657 10\n4623623705787050 4128735493476588\n29371111781967946 19402395181570597\n23313713550468151 18155134012955455\n654639695903289 323875358727922\n15727861955653242 26658913688488667\n10815360622718474 4625834559167483\n10836636083182170 10347869939717751\n8972909638986721 1887397472131862\n23442032136521081 29735793306181382\n325363900801763 6960017105353559\n", "Yes\nNo\nNo\nYes\nYes\nYes\nNo\nYes\nYes\nNo\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["原根", "数论", "O2优化", "洛谷月赛"], "title": "小 A 与两位神仙", "background": "小 A 是一个普普通通的高中生，但是他某一天忽然被卷入了神仙的游戏中，快来帮帮他！", "description": "某一天，小 A 正走在放学回家的路上，忽然遇见了两个神仙造梦者和杰瑞米，祂们一看到小 A 就说要和小 A 玩游戏，小 A 被笼罩在金光中，莫名其妙就答应了祂们的要求。\n\n这个游戏的规则是这样的：两个神仙先选定一个正整数 $m$，保证 $m$ 是一个奇质数 $p$ 的正整数次幂。然后进行 $n$ 轮游戏，每轮中造梦者选定一个正整数 $x$，杰瑞米选定一个正整数 $y$，保证 $(x, m) = 1, (y, m) = 1$，即 $x$ 与 $m$ 互质，$y$ 与 $m$ 互质，接下来询问小 A 是否存在非负整数 $a$ 使得 $x^a \\equiv y \\pmod{m}$。\n\n神仙们说小 A 只有在每一轮游戏中都回答正确才能回到正常的生活中，不得已之下他只好求助于聪明的你。\n", "inputFormat": "第一行两个正整数 $m, n$。\n\n接下来 $n$ 行，每行两个正整数 $x, y$。", "outputFormat": "一共 $n$ 行，每行对应一轮游戏中小 A 的回答。\n\n如果存在，那么答案为 `Yes`，否则为 `No`。", "hint": "**样例解释**\n\n$1^a \\equiv 1 \\not \\equiv 4 \\pmod {9}$。\n\n$2^6 \\equiv 64 \\equiv 1 \\pmod {9}$。\n\n$7^2 \\equiv 49 \\equiv 4 \\pmod {9}$。\n\n**数据范围**\n\n本题共 $7$ 个子任务，你需要通过一个子任务内的所有测试点才能取得这个子任务的分数。\n\n对于所有数据满足 $1\\le n\\le 2\\times 10^4$，$3\\le m \\le 10^{18}$，$1 \\le x, y < m$ 。\n\n| #    | 分数 | $n$                      | $m$                 | 特殊性质1 | 时间限制 |\n| ---- | ---- | ------------------------ | ------------------- | --------- | --------- |\n| 1    | 3    | $\\le 5$            | $\\le 10^6$    | ×         |  1s |\n| 2    | 37   | $\\le 5$            | $\\le 10^9$    | ×         | 1s |\n| 3    | 22   | $= 1$                    | $\\le 10^{18}$ | ×         | 1s |\n| 4    | 13   | $\\le 100$          | $\\le 10^{18}$ | √         | 1s |\n| 5    | 10   | $\\le 100$          | $\\le 10^{18}$ | ×         | 1s |\n| 6    | 5   | $\\le 2000$         | $\\le 10^{18}$ | ×         | 1s |\n| 7    | 10   | $\\le 2\\times 10^4$ | $\\le 10^{18}$ | ×         | 3s |\n\n特殊性质1：令 $m = p^{a}$，则 $p$ 是在 $[3, 10^{18}]$ 等概率选取的一个素数。\n\n**提示**\n\n本题可以使用 `__int128`。", "locale": "zh-CN", "translations": {"en": {"title": "Little A and Two Immortals", "background": "Little A is an ordinary high school student, but one day he was suddenly dragged into a game of immortals. Please help him!", "description": "One day, Little A was walking home after school when he suddenly met two immortal dream-makers, Zaomengzhe and Jeremy. As soon as they saw Little A, they said they wanted to play a game with him. Little A was covered in golden light and, for some reason, agreed to their request.\n\nThe rules of the game are as follows: the two immortals first choose a positive integer $m$, and guarantee that $m$ is a positive integer power of an odd prime $p$. Then they play $n$ rounds. In each round, Zaomengzhe chooses a positive integer $x$, and Jeremy chooses a positive integer $y$, with $(x, m) = 1$ and $(y, m) = 1$, meaning $x$ is coprime to $m$ and $y$ is coprime to $m$. Then they ask Little A whether there exists a non-negative integer $a$ such that $x^a \\equiv y \\pmod{m}$.\n\nThe immortals say that only if Little A answers correctly in every round can he return to normal life. With no other choice, he asks you, the smart one, for help.", "inputFormat": "The first line contains two positive integers $m, n$.\n\nThe next $n$ lines each contain two positive integers $x, y$.", "outputFormat": "Output a total of $n$ lines, each corresponding to Little A's answer for one round.\n\nIf it exists, output `Yes`; otherwise, output `No`.", "hint": "**Sample Explanation**\n\n$1^a \\equiv 1 \\not \\equiv 4 \\pmod {9}$.\n\n$2^6 \\equiv 64 \\equiv 1 \\pmod {9}$.\n\n$7^2 \\equiv 49 \\equiv 4 \\pmod {9}$.\n\n**Constraints**\n\nThis problem has $7$ subtasks. You must pass all test points within a subtask to obtain the score for that subtask.\n\nFor all testdata, $1\\le n\\le 2\\times 10^4$, $3\\le m \\le 10^{18}$, $1 \\le x, y < m$.\n\n| #    | Score | $n$                      | $m$                 | Special Property 1 | Time Limit |\n| ---- | ---- | ------------------------ | ------------------- | --------- | --------- |\n| 1    | 3    | $\\le 5$            | $\\le 10^6$    | ×         |  1s |\n| 2    | 37   | $\\le 5$            | $\\le 10^9$    | ×         | 1s |\n| 3    | 22   | $= 1$                    | $\\le 10^{18}$ | ×         | 1s |\n| 4    | 13   | $\\le 100$          | $\\le 10^{18}$ | √         | 1s |\n| 5    | 10   | $\\le 100$          | $\\le 10^{18}$ | ×         | 1s |\n| 6    | 5   | $\\le 2000$         | $\\le 10^{18}$ | ×         | 1s |\n| 7    | 10   | $\\le 2\\times 10^4$ | $\\le 10^{18}$ | ×         | 3s |\n\nSpecial Property 1: Let $m = p^{a}$. Then $p$ is a prime chosen uniformly at random from $[3, 10^{18}]$.\n\n**Hint**\n\nYou may use `__int128`.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小 A 与两位神仙", "background": "小 A 是一个普普通通的高中生，但是他某一天忽然被卷入了神仙的游戏中，快来帮帮他！", "description": "某一天，小 A 正走在放学回家的路上，忽然遇见了两个神仙造梦者和杰瑞米，祂们一看到小 A 就说要和小 A 玩游戏，小 A 被笼罩在金光中，莫名其妙就答应了祂们的要求。\n\n这个游戏的规则是这样的：两个神仙先选定一个正整数 $m$，保证 $m$ 是一个奇质数 $p$ 的正整数次幂。然后进行 $n$ 轮游戏，每轮中造梦者选定一个正整数 $x$，杰瑞米选定一个正整数 $y$，保证 $(x, m) = 1, (y, m) = 1$，即 $x$ 与 $m$ 互质，$y$ 与 $m$ 互质，接下来询问小 A 是否存在非负整数 $a$ 使得 $x^a \\equiv y \\pmod{m}$。\n\n神仙们说小 A 只有在每一轮游戏中都回答正确才能回到正常的生活中，不得已之下他只好求助于聪明的你。\n", "inputFormat": "第一行两个正整数 $m, n$。\n\n接下来 $n$ 行，每行两个正整数 $x, y$。", "outputFormat": "一共 $n$ 行，每行对应一轮游戏中小 A 的回答。\n\n如果存在，那么答案为 `Yes`，否则为 `No`。", "hint": "**样例解释**\n\n$1^a \\equiv 1 \\not \\equiv 4 \\pmod {9}$。\n\n$2^6 \\equiv 64 \\equiv 1 \\pmod {9}$。\n\n$7^2 \\equiv 49 \\equiv 4 \\pmod {9}$。\n\n**数据范围**\n\n本题共 $7$ 个子任务，你需要通过一个子任务内的所有测试点才能取得这个子任务的分数。\n\n对于所有数据满足 $1\\le n\\le 2\\times 10^4$，$3\\le m \\le 10^{18}$，$1 \\le x, y < m$ 。\n\n| #    | 分数 | $n$                      | $m$                 | 特殊性质1 | 时间限制 |\n| ---- | ---- | ------------------------ | ------------------- | --------- | --------- |\n| 1    | 3    | $\\le 5$            | $\\le 10^6$    | ×         |  1s |\n| 2    | 37   | $\\le 5$            | $\\le 10^9$    | ×         | 1s |\n| 3    | 22   | $= 1$                    | $\\le 10^{18}$ | ×         | 1s |\n| 4    | 13   | $\\le 100$          | $\\le 10^{18}$ | √         | 1s |\n| 5    | 10   | $\\le 100$          | $\\le 10^{18}$ | ×         | 1s |\n| 6    | 5   | $\\le 2000$         | $\\le 10^{18}$ | ×         | 1s |\n| 7    | 10   | $\\le 2\\times 10^4$ | $\\le 10^{18}$ | ×         | 3s |\n\n特殊性质1：令 $m = p^{a}$，则 $p$ 是在 $[3, 10^{18}]$ 等概率选取的一个素数。\n\n**提示**\n\n本题可以使用 `__int128`。", "locale": "zh-CN"}}}
{"pid": "P5606", "type": "P", "difficulty": 7, "samples": [["3 3\n1 2 3", "2"], ["6 5\n1 1 4 5 1 4", "144"], ["16 20\n9 9 3 2 4 4 8 5 3 -1 -9 -1 -9 -8 -1 0", "802901549"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["多项式", "O2优化", "组合数学", "快速傅里叶变换 FFT", "洛谷月赛"], "title": "小 K 与毕业旅行", "background": "小 K 是一个刚刚高考完的高中生，他正在计划一次毕业旅行，但却被一些细节难住了，快来帮帮他！", "description": "毕业旅行的计划上一共有 $n$ 个景点，大家会按某种顺序游览这些景点，每一个景点都会被游览恰好一次。\n\n每个景点都有一个坐标 $a_i$，从坐标为 $a$ 的景点坐车前往坐标为 $b$ 的景点会给大家造成 $a \\times b$ 的不适感，每次下车后不适感都会清零（即不适感不会累加）。如果某次坐车的不适感超过了某个常数 $w$，就会有人生病。\n\n小 K 想问你，有多少种游览所有景点的顺序，使得全程都不会有人生病，答案对 $998244353$ 取模。", "inputFormat": "第一行一个正整数 $n$ 和一个非负整数 $w$。\n\n第二行 $n$ 个整数 $a_1, a_2, \\cdots, a_n$。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "**样例解释**\n\n对于样例 $1$，有 $2-1-3$ 和 $3-1-2$ 两种合法的顺序。\n\n**数据范围**\n\n本题共有 $10$ 个子任务，你需要通过一个子任务内的所有测试点才能取得这个子任务的分数。\n\n对于所有数据，$0 \\le w, |a_i| \\le 10^9 $，$1 \\le n \\le 50000$。\n\n| # | $n$ | $a$ | 分值 |\n| ---- | ---- | ---- | ---- |\n| 1 | $n \\le 10$ | 无特殊限制 | $5$ |\n| 2 | $n \\le 20$ | 无特殊限制 | $5$ |\n| 3 | $n \\le 2000 $ | $a_i \\in \\{ 1,w \\}$ | $5$ |\n| 4 | $n\\le 2000 $ | 不同的 $a_i$ 只有三个，$a_i \\ge 0$ | $5$ |\n| 5 | $n\\le 200 $ | $a_i\\ge 0 $ | $10$ |\n| 6 | $n\\le 2000$ | $a_i\\ge 0$ | $15$ |\n| 7 | $n\\le 50000$ | $a_i \\ge 0 $ | $20$ |\n| 8 | $n\\le 200 $ | 无特殊限制 | $15$ |\n| 9 | $n\\le 2000 $ | 无特殊限制 | $10$ |\n| 10 | $n\\le 50000 $ | 无特殊限制 | $10$ |", "locale": "zh-CN", "translations": {"en": {"title": "Xiao K and the Graduation Trip", "background": "Xiao K is a high school student who has just finished the college entrance exam. He is planning a graduation trip, but some details are troubling him. Please help him!", "description": "There are $n$ attractions in the graduation trip plan. Everyone will visit these attractions in some order, and each attraction will be visited exactly once.\n\nEach attraction has a coordinate $a_i$. Taking a ride from the attraction with coordinate $a$ to the attraction with coordinate $b$ will cause discomfort of $a \\times b$. After getting off the vehicle each time, the discomfort is reset to $0$ (that is, discomfort does not accumulate). If the discomfort of any ride exceeds a certain constant $w$, someone will get sick.\n\nXiao K wants to know how many visiting orders of all attractions make sure that no one gets sick throughout the whole trip. Output the answer modulo $998244353$.", "inputFormat": "The first line contains a positive integer $n$ and a non-negative integer $w$.\n\nThe second line contains $n$ integers $a_1, a_2, \\cdots, a_n$.", "outputFormat": "Output one line containing one integer, the answer.", "hint": "**Sample Explanation**\n\nFor sample $1$, there are two valid orders: $2-1-3$ and $3-1-2$.\n\n**Constraints**\n\nThis problem has $10$ subtasks. You must pass all test points within a subtask to get the score for that subtask.\n\nFor all data, $0 \\le w, |a_i| \\le 10^9$, $1 \\le n \\le 50000$.\n\n| # | $n$ | $a$ | Score |\n| ---- | ---- | ---- | ---- |\n| 1 | $n \\le 10$ | No special restrictions | $5$ |\n| 2 | $n \\le 20$ | No special restrictions | $5$ |\n| 3 | $n \\le 2000 $ | $a_i \\in \\{ 1,w \\}$ | $5$ |\n| 4 | $n\\le 2000 $ | There are only three distinct $a_i$, and $a_i \\ge 0$ | $5$ |\n| 5 | $n\\le 200 $ | $a_i\\ge 0 $ | $10$ |\n| 6 | $n\\le 2000$ | $a_i\\ge 0$ | $15$ |\n| 7 | $n\\le 50000$ | $a_i \\ge 0 $ | $20$ |\n| 8 | $n\\le 200 $ | No special restrictions | $15$ |\n| 9 | $n\\le 2000 $ | No special restrictions | $10$ |\n| 10 | $n\\le 50000 $ | No special restrictions | $10$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小 K 与毕业旅行", "background": "小 K 是一个刚刚高考完的高中生，他正在计划一次毕业旅行，但却被一些细节难住了，快来帮帮他！", "description": "毕业旅行的计划上一共有 $n$ 个景点，大家会按某种顺序游览这些景点，每一个景点都会被游览恰好一次。\n\n每个景点都有一个坐标 $a_i$，从坐标为 $a$ 的景点坐车前往坐标为 $b$ 的景点会给大家造成 $a \\times b$ 的不适感，每次下车后不适感都会清零（即不适感不会累加）。如果某次坐车的不适感超过了某个常数 $w$，就会有人生病。\n\n小 K 想问你，有多少种游览所有景点的顺序，使得全程都不会有人生病，答案对 $998244353$ 取模。", "inputFormat": "第一行一个正整数 $n$ 和一个非负整数 $w$。\n\n第二行 $n$ 个整数 $a_1, a_2, \\cdots, a_n$。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "**样例解释**\n\n对于样例 $1$，有 $2-1-3$ 和 $3-1-2$ 两种合法的顺序。\n\n**数据范围**\n\n本题共有 $10$ 个子任务，你需要通过一个子任务内的所有测试点才能取得这个子任务的分数。\n\n对于所有数据，$0 \\le w, |a_i| \\le 10^9 $，$1 \\le n \\le 50000$。\n\n| # | $n$ | $a$ | 分值 |\n| ---- | ---- | ---- | ---- |\n| 1 | $n \\le 10$ | 无特殊限制 | $5$ |\n| 2 | $n \\le 20$ | 无特殊限制 | $5$ |\n| 3 | $n \\le 2000 $ | $a_i \\in \\{ 1,w \\}$ | $5$ |\n| 4 | $n\\le 2000 $ | 不同的 $a_i$ 只有三个，$a_i \\ge 0$ | $5$ |\n| 5 | $n\\le 200 $ | $a_i\\ge 0 $ | $10$ |\n| 6 | $n\\le 2000$ | $a_i\\ge 0$ | $15$ |\n| 7 | $n\\le 50000$ | $a_i \\ge 0 $ | $20$ |\n| 8 | $n\\le 200 $ | 无特殊限制 | $15$ |\n| 9 | $n\\le 2000 $ | 无特殊限制 | $10$ |\n| 10 | $n\\le 50000 $ | 无特殊限制 | $10$ |", "locale": "zh-CN"}}}
{"pid": "P5607", "type": "P", "difficulty": 6, "samples": [["10\n1 1 2\n1 1 1\n2 1 3\n1 1 3\n1 1 8\n2 2 1\n2 2 1\n2 1 1\n1 1 4\n1 2 2", "2\n4\n4\n4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2013", "O2优化", "Ynoi"], "title": "[Ynoi2013] 无力回天 NOI2017", "background": "", "description": "你需要维护编号为 $1,\\dots,m$ 的 $m$ 个集合，初始为空。\n\n共 $m$ 次操作：\n\n1. 给定 $x,y$，在编号 $x$ 的集合插入 $y$，保证 $y$ 之前不在这个集合中；\n2. 给定 $x_1,x_2$，问编号 $x_1,x_2$ 的集合的并的元素个数。", "inputFormat": "第一行一个整数 $m$；\n\n接下来 $m$ 行，每行三个整数 $1,x,y$ 或 $2,x_1,x_2$ 表示一次操作。", "outputFormat": "对每个 $2$ 操作，输出一行，表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：ccz181078，Data：ccz181078&FS_NEO\n\n对于 $100\\%$ 的数据，满足 $1\\le m\\le 10^6$，$1\\le x,y,x_1,x_2\\le m$；\n\n对于 $25\\%$ 的数据，满足 $m\\le10^3$。\n\n对于另外 $25\\%$ 的数据，保证在第一次 $2$ 操作后，没有 $1$ 操作。\n\n对于另外 $25\\%$ 的数据，满足 $m\\le 2\\times 10^5$。\n\n对于另外 $25\\%$ 的数据，无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2013] 无力回天 NOI2017", "background": "", "description": "你需要维护编号为 $1,\\dots,m$ 的 $m$ 个集合，初始为空。\n\n共 $m$ 次操作：\n\n1. 给定 $x,y$，在编号 $x$ 的集合插入 $y$，保证 $y$ 之前不在这个集合中；\n2. 给定 $x_1,x_2$，问编号 $x_1,x_2$ 的集合的并的元素个数。", "inputFormat": "第一行一个整数 $m$；\n\n接下来 $m$ 行，每行三个整数 $1,x,y$ 或 $2,x_1,x_2$ 表示一次操作。", "outputFormat": "对每个 $2$ 操作，输出一行，表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：ccz181078，Data：ccz181078&FS_NEO\n\n对于 $100\\%$ 的数据，满足 $1\\le m\\le 10^6$，$1\\le x,y,x_1,x_2\\le m$；\n\n对于 $25\\%$ 的数据，满足 $m\\le10^3$。\n\n对于另外 $25\\%$ 的数据，保证在第一次 $2$ 操作后，没有 $1$ 操作。\n\n对于另外 $25\\%$ 的数据，满足 $m\\le 2\\times 10^5$。\n\n对于另外 $25\\%$ 的数据，无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P5608", "type": "P", "difficulty": 7, "samples": [["6 6\n1 3 5 7 9 11\n0 1 1 0 1\n3 1 6\n3 3 6\n1 1 2 13\n2 3 4 1\n3 1 6\n3 3 6", "205\n134\n45058\n3465"], ["20 20\n525160717 947806001 1495853547 5283947 39115023 1008063001 397093019 1434942997 247321621 145181297 359967329 642658073 1402873249 50886569 150383317 1004954721 351661441 1660759179 48867601 1316622161 \n0 0 0 0 0 0 0 1 0 1 0 0 0 1 0 0 0 0 1 \n3 2 19\n3 2 15\n3 9 9\n1 16 16 394339135\n2 1 19 0\n3 1 15\n1 4 11 564942769\n3 7 7\n2 2 19 0\n3 1 1\n3 9 9\n1 9 9 705415201\n1 3 18 152081579\n1 13 17 905666497\n1 11 17 612267547\n1 2 20 111949431\n2 1 1 0\n1 10 17 838945201\n2 4 18 0\n3 2 18\n", "900803889\n834560968\n247321621\n852589651\n564942769\n525160717\n564942769\n719106438\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2013", "线段树", "O2优化", "洛谷月赛", "Ynoi"], "title": "[Ynoi2013] 文化课", "background": "Chimuzu 省选一轮爆了两个大零蛋，于是滚回去学文化课了。\n\n他翻出一道基础四则运算练习题……然后发现自己不会。\n\n于是他需要你的帮助，作为回报，他会给你 $100$ 分。\n\n前排打广告，有人来看看我写的[融合树](https://www.luogu.org/blog/user3296/rong-ge-shu-fusion-tree)吗\n\n（其实还写了 Brodal queue）", "description": "Chimuzu 手上有一个数字序列 $\\{a_{1},a_{2},\\ldots,a_{n}\\}$ 和一个运算符序列 $\\{p_{1},p_{2},\\ldots,p_{n-1}\\}$。其中 $p_{i}$ 只能为 $+$ 或 $\\times$。\n\n我们定义一个区间 $[l,r]$ 的权值 $w(l,r)$ 为将字符串\n\n$$\na_{l}~p_{l}~a_{l+1}~p_{l+1} \\cdots a_{r-1}~p_{r-1}~a_{r}\n$$\n\n写下来之后，按照运算符的优先级计算出的结果。\n\n下面给出一个运算的例子：\n\n若 $a=\\{1,3,5,7,9,11\\}$，$p=\\{+,\\times,\\times,+,\\times\\}$，那么有：\n\n$$\nw(1,6)=1+3\\times 5\\times 7+9\\times 11=205\n$$\n\n$$\nw(3,6)=5\\times 7+9\\times 11=134\n$$\n\nChimuzu 需要你对这两个序列进行修改，同时查询某个给定区间的权值。\n\n你需要维护这 $3$ 个操作：\n\n操作一：给定 $l,r,x$，将 $a_{l},a_{l+1},\\ldots,a_{r}$ 全部修改成 $x$。\n\n操作二：给定 $l,r,y$：将 $p_{l},p_{l+1},\\ldots,p_{r}$ 全部修改成 $y$，$0$ 表示 $+$，$1$ 表示 $\\times$。\n\n操作三：给定 $l,r$：查询 $w(l,r) \\bmod 1000000007$ 的值。", "inputFormat": "第一行包含两个整数 $n,m$。\n\n第二行包含 $n$ 个整数 $a_{1},a_{2},\\ldots,a_{n}$。\n\n第三行包含 $n-1$ 个整数 $p_{1},p_{2},\\cdots,p_{n-1}$，$0$ 表示 $+$， $1$ \n 表示 $\\times$。\n\n接下来 $m$ 行，每行有一个操作。\n\n一开始输入一个标识符 $op$，表示操作类型，接着按照题目描述输入各操作的参数。\n\n$op=1$ 时，输入 $3$ 个整数 $l,r,x$，表示将 $a_{l},a_{l+1},\\ldots,a_{r}$ 全部修改成 $x$。\n\n$op=2$ 时，输入 $3$ 个整数 $l,r,y$，表示将 $p_{l},p_{l+1},\\ldots,p_{r}$ 全部修改成 $y$，$0$ 表示 $+$，$1$ 表示 $\\times$。\n\n$op=3$ 时，输入 $2$ 个整数 $l,r$，表示查询 $w(l,r) \\bmod 1000000007$ 的值。\n\n\n\n", "outputFormat": "对于每一次操作 $3$，输出 $1$ 行 $1$ 个整数表示所求答案。", "hint": "#### 样例解释 1\n\n初始的两个序列和前两次操作是题目描述中的例子。第四次操作结束后，两个序列变成了如下形态\n\n$a=\\{13,13,5,7,9,11\\}$，$p=\\{+,\\times,\\times,\\times,\\times\\}$\n\n$$\nw(1,6)=13+13\\times 5\\times 7\\times 9\\times 11=45058\n$$\n\n$$\nw(3,6)=5\\times 7\\times 9\\times 11=3465\n$$\n\n### 数据范围与约定\n\n对于其中 $1\\%$ 的数据，为样例 1，时限为 1.5s\n\n对于另外 $14\\%$的数据，$n,m\\leq 1000$ ，时限为 1.5s\n\n对于另外 $5\\%$ 的数据，没有修改操作，时限为 1.5s\n\n对于另外 $14\\%$ 的数据，数据保证随机，时限为 1.5s\n\n对于另外 $19\\%$ 的数据，没有 1 操作，时限为 1.5s\n\n对于另外 $19\\%$ 的数据，没有 2 操作，时限为 1.5s\n\n对于另外 $8\\%$ 的数据，时限为 5s\n\n对于另外 $10\\%$ 的数据，时限为 3s\n\n对于 $100\\%$ 的数据，$n,m\\leq 100000$，$1\\leq a_{i},x\\lt 2^{32}$，$a_{i},x$ 均为奇数，$p_{i},y\\in\\{0,1\\}$，$1\\leq l\\leq r\\leq n$，所有操作 $2$ 还满足 $r\\lt n$。时限为 1.5s\n\nIdea：Juan_feng。\n\nSolution：nzhtl1477，ccz181078。\n\nCode：Juan_feng，nzhtl1477，rehtorbegnaro，ccz181078。\n\nData：Juan_feng，nzhtl1477，rehtorbegnaro。\n", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2013] Cultural Classes.", "background": "Chimuzu messed up badly in the first round of the NOI Qualifier, getting two big zeros, so he went back to study cultural classes.\n\nHe dug out a basic four-operations arithmetic practice problem... and then found that he could not do it.\n\nSo he needs your help. As a reward, he will give you $100$ points.\n\nAdvertisement at the top: would anyone like to take a look at the [fusion tree](https://www.luogu.org/blog/user3296/rong-ge-shu-fusion-tree) I wrote?\n\n(Actually, I also wrote about the Brodal queue.)", "description": "Chimuzu has a number sequence $\\{a_{1},a_{2},\\ldots,a_{n}\\}$ and an operator sequence $\\{p_{1},p_{2},\\ldots,p_{n-1}\\}$. Each $p_{i}$ can only be $+$ or $\\times$.\n\nWe define the weight $w(l,r)$ of an interval $[l,r]$ as the result obtained by writing the string\n\n$$\na_{l}~p_{l}~a_{l+1}~p_{l+1} \\cdots a_{r-1}~p_{r-1}~a_{r}\n$$\n\nand then evaluating it according to operator precedence.\n\nAn example is given below:\n\nIf $a=\\{1,3,5,7,9,11\\}$ and $p=\\{+,\\times,\\times,+,\\times\\}$, then:\n\n$$\nw(1,6)=1+3\\times 5\\times 7+9\\times 11=205\n$$\n\n$$\nw(3,6)=5\\times 7+9\\times 11=134\n$$\n\nChimuzu needs you to modify these two sequences and also query the weight of a given interval.\n\nYou need to maintain these $3$ operations:\n\nOperation 1: given $l,r,x$, set $a_{l},a_{l+1},\\ldots,a_{r}$ all to $x$.\n\nOperation 2: given $l,r,y$, set $p_{l},p_{l+1},\\ldots,p_{r}$ all to $y$, where $0$ means $+$ and $1$ means $\\times$.\n\nOperation 3: given $l,r$, query the value of $w(l,r) \\bmod 1000000007$.", "inputFormat": "The first line contains two integers $n,m$.\n\nThe second line contains $n$ integers $a_{1},a_{2},\\ldots,a_{n}$.\n\nThe third line contains $n-1$ integers $p_{1},p_{2},\\cdots,p_{n-1}$, where $0$ means $+$ and $1$ means $\\times$.\n\nThen follow $m$ lines, each describing one operation.\n\nEach operation starts with an identifier $op$, indicating the operation type, followed by the parameters as described above.\n\nWhen $op=1$, input $3$ integers $l,r,x$, meaning to set $a_{l},a_{l+1},\\ldots,a_{r}$ all to $x$.\n\nWhen $op=2$, input $3$ integers $l,r,y$, meaning to set $p_{l},p_{l+1},\\ldots,p_{r}$ all to $y$, where $0$ means $+$ and $1$ means $\\times$.\n\nWhen $op=3$, input $2$ integers $l,r$, meaning to query the value of $w(l,r) \\bmod 1000000007$.", "outputFormat": "For each operation $3$, output $1$ line containing $1$ integer, which is the required answer.", "hint": "#### Sample Explanation 1\n\nThe initial two sequences and the first two operations are the example in the statement. After the fourth operation, the two sequences become:\n\n$a=\\{13,13,5,7,9,11\\}$, $p=\\{+,\\times,\\times,\\times,\\times\\}$\n\n$$\nw(1,6)=13+13\\times 5\\times 7\\times 9\\times 11=45058\n$$\n\n$$\nw(3,6)=5\\times 7\\times 9\\times 11=3465\n$$\n\n### Constraints and Notes\n\nFor $1\\%$ of the testdata, it is Sample 1, and the time limit is 1.5s.\n\nFor another $14\\%$ of the testdata, $n,m\\leq 1000$, and the time limit is 1.5s.\n\nFor another $5\\%$ of the testdata, there are no modification operations, and the time limit is 1.5s.\n\nFor another $14\\%$ of the testdata, the testdata is guaranteed to be random, and the time limit is 1.5s.\n\nFor another $19\\%$ of the testdata, there is no operation 1, and the time limit is 1.5s.\n\nFor another $19\\%$ of the testdata, there is no operation 2, and the time limit is 1.5s.\n\nFor another $8\\%$ of the testdata, the time limit is 5s.\n\nFor another $10\\%$ of the testdata, the time limit is 3s.\n\nFor $100\\%$ of the testdata, $n,m\\leq 100000$, $1\\leq a_{i},x\\lt 2^{32}$, and both $a_{i}$ and $x$ are odd, $p_{i},y\\in\\{0,1\\}$, $1\\leq l\\leq r\\leq n$. Also, for all operations $2$, it additionally holds that $r\\lt n$. The time limit is 1.5s.\n\nIdea: Juan_feng.\n\nSolution: nzhtl1477, ccz181078.\n\nCode: Juan_feng, nzhtl1477, rehtorbegnaro, ccz181078.\n\nData: Juan_feng, nzhtl1477, rehtorbegnaro.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2013] 文化课", "background": "Chimuzu 省选一轮爆了两个大零蛋，于是滚回去学文化课了。\n\n他翻出一道基础四则运算练习题……然后发现自己不会。\n\n于是他需要你的帮助，作为回报，他会给你 $100$ 分。\n\n前排打广告，有人来看看我写的[融合树](https://www.luogu.org/blog/user3296/rong-ge-shu-fusion-tree)吗\n\n（其实还写了 Brodal queue）", "description": "Chimuzu 手上有一个数字序列 $\\{a_{1},a_{2},\\ldots,a_{n}\\}$ 和一个运算符序列 $\\{p_{1},p_{2},\\ldots,p_{n-1}\\}$。其中 $p_{i}$ 只能为 $+$ 或 $\\times$。\n\n我们定义一个区间 $[l,r]$ 的权值 $w(l,r)$ 为将字符串\n\n$$\na_{l}~p_{l}~a_{l+1}~p_{l+1} \\cdots a_{r-1}~p_{r-1}~a_{r}\n$$\n\n写下来之后，按照运算符的优先级计算出的结果。\n\n下面给出一个运算的例子：\n\n若 $a=\\{1,3,5,7,9,11\\}$，$p=\\{+,\\times,\\times,+,\\times\\}$，那么有：\n\n$$\nw(1,6)=1+3\\times 5\\times 7+9\\times 11=205\n$$\n\n$$\nw(3,6)=5\\times 7+9\\times 11=134\n$$\n\nChimuzu 需要你对这两个序列进行修改，同时查询某个给定区间的权值。\n\n你需要维护这 $3$ 个操作：\n\n操作一：给定 $l,r,x$，将 $a_{l},a_{l+1},\\ldots,a_{r}$ 全部修改成 $x$。\n\n操作二：给定 $l,r,y$：将 $p_{l},p_{l+1},\\ldots,p_{r}$ 全部修改成 $y$，$0$ 表示 $+$，$1$ 表示 $\\times$。\n\n操作三：给定 $l,r$：查询 $w(l,r) \\bmod 1000000007$ 的值。", "inputFormat": "第一行包含两个整数 $n,m$。\n\n第二行包含 $n$ 个整数 $a_{1},a_{2},\\ldots,a_{n}$。\n\n第三行包含 $n-1$ 个整数 $p_{1},p_{2},\\cdots,p_{n-1}$，$0$ 表示 $+$， $1$ \n 表示 $\\times$。\n\n接下来 $m$ 行，每行有一个操作。\n\n一开始输入一个标识符 $op$，表示操作类型，接着按照题目描述输入各操作的参数。\n\n$op=1$ 时，输入 $3$ 个整数 $l,r,x$，表示将 $a_{l},a_{l+1},\\ldots,a_{r}$ 全部修改成 $x$。\n\n$op=2$ 时，输入 $3$ 个整数 $l,r,y$，表示将 $p_{l},p_{l+1},\\ldots,p_{r}$ 全部修改成 $y$，$0$ 表示 $+$，$1$ 表示 $\\times$。\n\n$op=3$ 时，输入 $2$ 个整数 $l,r$，表示查询 $w(l,r) \\bmod 1000000007$ 的值。\n\n\n\n", "outputFormat": "对于每一次操作 $3$，输出 $1$ 行 $1$ 个整数表示所求答案。", "hint": "#### 样例解释 1\n\n初始的两个序列和前两次操作是题目描述中的例子。第四次操作结束后，两个序列变成了如下形态\n\n$a=\\{13,13,5,7,9,11\\}$，$p=\\{+,\\times,\\times,\\times,\\times\\}$\n\n$$\nw(1,6)=13+13\\times 5\\times 7\\times 9\\times 11=45058\n$$\n\n$$\nw(3,6)=5\\times 7\\times 9\\times 11=3465\n$$\n\n### 数据范围与约定\n\n对于其中 $1\\%$ 的数据，为样例 1，时限为 1.5s\n\n对于另外 $14\\%$的数据，$n,m\\leq 1000$ ，时限为 1.5s\n\n对于另外 $5\\%$ 的数据，没有修改操作，时限为 1.5s\n\n对于另外 $14\\%$ 的数据，数据保证随机，时限为 1.5s\n\n对于另外 $19\\%$ 的数据，没有 1 操作，时限为 1.5s\n\n对于另外 $19\\%$ 的数据，没有 2 操作，时限为 1.5s\n\n对于另外 $8\\%$ 的数据，时限为 5s\n\n对于另外 $10\\%$ 的数据，时限为 3s\n\n对于 $100\\%$ 的数据，$n,m\\leq 100000$，$1\\leq a_{i},x\\lt 2^{32}$，$a_{i},x$ 均为奇数，$p_{i},y\\in\\{0,1\\}$，$1\\leq l\\leq r\\leq n$，所有操作 $2$ 还满足 $r\\lt n$。时限为 1.5s\n\nIdea：Juan_feng。\n\nSolution：nzhtl1477，ccz181078。\n\nCode：Juan_feng，nzhtl1477，rehtorbegnaro，ccz181078。\n\nData：Juan_feng，nzhtl1477，rehtorbegnaro。\n", "locale": "zh-CN"}}}
{"pid": "P5609", "type": "P", "difficulty": 7, "samples": [["4 5 6\n7 2 -3 17\n2 3 1\n1 3 3\n0 3 0\n2 4 2\n4 4 0", "0\n-3\n4\n12\n11"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2013", "O2优化", "Ynoi"], "title": "[Ynoi2013] 对数据结构的爱", "background": "", "description": "Nauuo 是一个喜欢编程的女孩子。有一天她在做一道题，要求计算一些数的和对一个数 $p$ 取模的结果。\n\n她写出了如下的代码，然后获得了 WA 的评测结果。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x18mqt81.png)\n\n她很快发现了 bug——`ModAdd` 函数只对 $[0,p)$ 中的数起作用，但是这个问题中的数有可能不在这个范围之内。她对这个错误的函数很好奇，所以她想知道它的运行结果。\n\n然而，原来的代码运行得太慢了，所以她来找你求助。\n\n给定数组 $a_1,a_2,…a_n$ 和一个数 $p$，有 $m$ 个询问，每次给定三个数 $l$，$r$ 和 $x$，你需要计算函数 `Sum(a,l,r,x,p)` 的返回值。函数 `Sum` 的定义在上面的伪代码中已经给出。\n\n注意，在上面的代码中，整数不会越界。", "inputFormat": "第一行三个整数 $n$，$m$，$p$，分别代表数组的长度，询问的个数和模数。注意模数只在 `ModAdd` 中用到。\n\n第二行包含 $n$ 个整数 $a_1,a_2,…a_n$，代表给定的数组。\n\n接下来的 $m$ 行，每行三个整数 $l$，$r$ 和 $x$，你需要计算 `Sum(a,l,r,x,p)`。\n\n**本题强制在线，所有输入的 $l,r,x$ 均需要异或 $lastans$，其定义为上一次询问操作得到的答案对 $n$ 取模后的值，若答案为负数，则需要取模为正数，若之前没有询问操作，则为 $0$。**", "outputFormat": "按顺序输出 $m$ 个整数，每个一行，代表询问的答案。", "hint": "Idea：rushcheyo&nzhtl1477，Solution：ccz181078，Code：rushcheyo&ccz181078，Data：rushcheyo&nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\le n\\le10^6$，$1\\le m\\le2\\times 10^5$，$1\\le p\\le10^9$，$-10^9\\le a_i\\le10^9$，$1\\le l\\le r\\le n$，$0\\le x\\le p-1$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2013] Love for Data Structures", "background": "", "description": "Nauuo is a girl who likes programming. One day she was working on a problem that asked her to compute the sum of some numbers modulo an integer $p$.\n\nShe wrote the following code, but got WA.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x18mqt81.png)\n\nShe quickly found the bug: the `ModAdd` function only works for numbers in $[0,p)$, but in this problem the numbers may fall outside this range. She became curious about this incorrect function, so she wants to know what result it actually produces.\n\nHowever, the original code runs too slowly, so she asks you for help.\n\nGiven an array $a_1,a_2,\\ldots,a_n$ and an integer $p$, there are $m$ queries. Each query gives three integers $l$, $r$, and $x$. You need to compute the return value of `Sum(a,l,r,x,p)`. The definition of `Sum` has already been given in the pseudocode above.\n\nNote that in the code above, integers will not overflow.", "inputFormat": "The first line contains three integers $n$, $m$, $p$, representing the length of the array, the number of queries, and the modulus. Note that the modulus is only used in `ModAdd`.\n\nThe second line contains $n$ integers $a_1,a_2,\\ldots,a_n$, representing the given array.\n\nThe next $m$ lines each contain three integers $l$, $r$, and $x$. You need to compute `Sum(a,l,r,x,p)`.\n\n**This problem is forced online. All input $l,r,x$ must be XORed with $lastans$, where $lastans$ is defined as (the answer of the previous query) modulo $n$. If the answer is negative, you need to take the modulo to make it positive. If there has been no previous query, then it is $0$.**", "outputFormat": "Output $m$ integers in order, one per line, representing the answers to the queries.", "hint": "Idea: rushcheyo&nzhtl1477, Solution: ccz181078, Code: rushcheyo&ccz181078, Data: rushcheyo&nzhtl1477\n\nConstraints: for $100\\%$ of the testdata, $1\\le n\\le10^6$, $1\\le m\\le2\\times 10^5$, $1\\le p\\le10^9$, $-10^9\\le a_i\\le10^9$, $1\\le l\\le r\\le n$, $0\\le x\\le p-1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2013] 对数据结构的爱", "background": "", "description": "Nauuo 是一个喜欢编程的女孩子。有一天她在做一道题，要求计算一些数的和对一个数 $p$ 取模的结果。\n\n她写出了如下的代码，然后获得了 WA 的评测结果。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x18mqt81.png)\n\n她很快发现了 bug——`ModAdd` 函数只对 $[0,p)$ 中的数起作用，但是这个问题中的数有可能不在这个范围之内。她对这个错误的函数很好奇，所以她想知道它的运行结果。\n\n然而，原来的代码运行得太慢了，所以她来找你求助。\n\n给定数组 $a_1,a_2,…a_n$ 和一个数 $p$，有 $m$ 个询问，每次给定三个数 $l$，$r$ 和 $x$，你需要计算函数 `Sum(a,l,r,x,p)` 的返回值。函数 `Sum` 的定义在上面的伪代码中已经给出。\n\n注意，在上面的代码中，整数不会越界。", "inputFormat": "第一行三个整数 $n$，$m$，$p$，分别代表数组的长度，询问的个数和模数。注意模数只在 `ModAdd` 中用到。\n\n第二行包含 $n$ 个整数 $a_1,a_2,…a_n$，代表给定的数组。\n\n接下来的 $m$ 行，每行三个整数 $l$，$r$ 和 $x$，你需要计算 `Sum(a,l,r,x,p)`。\n\n**本题强制在线，所有输入的 $l,r,x$ 均需要异或 $lastans$，其定义为上一次询问操作得到的答案对 $n$ 取模后的值，若答案为负数，则需要取模为正数，若之前没有询问操作，则为 $0$。**", "outputFormat": "按顺序输出 $m$ 个整数，每个一行，代表询问的答案。", "hint": "Idea：rushcheyo&nzhtl1477，Solution：ccz181078，Code：rushcheyo&ccz181078，Data：rushcheyo&nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\le n\\le10^6$，$1\\le m\\le2\\times 10^5$，$1\\le p\\le10^9$，$-10^9\\le a_i\\le10^9$，$1\\le l\\le r\\le n$，$0\\le x\\le p-1$。", "locale": "zh-CN"}}}
{"pid": "P5610", "type": "P", "difficulty": 6, "samples": [["5 2\n1 2 3 4 5\n1 1 5 2\n2 1 5", "12"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2013", "树状数组", "数论", "O2优化", "Ynoi"], "title": "[Ynoi2013] 大学", "background": "", "description": "一个长为 $n$ 的**非负**整数序列 $a$，支持以下两个操作：\n\n- `1 l r x`：把区间 $[l,r]$ 中所有 $x$ 的倍数除以 $x$。\n- `2 l r`：查询区间 $[l,r]$ 的和。\n\n本题强制在线，每次的 $l,r,x$ 需要与上次答案做 xor 运算，如果之前没有询问，则上次答案为 $0$。", "inputFormat": "第一行两个整数表示 $n,m$。\n\n第二行 $n$ 个非负整数表示 $a_i$。\n\n之后 $m$ 行每行一个操作。\n\n- `1 l r x`：把区间 $[l,r]$ 中所有 $x$ 的倍数除以 $x$。\n- `2 l r`：查询区间 $[l,r]$ 的和。", "outputFormat": "对于每次询问，输出一行一个整数表示答案。", "hint": "$1\\leq n,m\\leq 10^5$，$0\\leq a_i\\leq 5\\times 10^5$，解密后的 $x,l,r$ 满足 $1\\leq x\\leq 5\\times 10^5$，$1\\leq l\\leq r\\leq n$。\n\nIdea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，mrsrz，Data：nzhtl1477，mrsrz，一只绝帆", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2013] University", "background": "", "description": "Given a **non-negative** integer sequence $a$ of length $n$, support the following two operations:\n\n- `1 l r x`: For all numbers in the interval $[l,r]$ that are multiples of $x$, divide them by $x$.\n- `2 l r`: Query the sum of the interval $[l,r]$.\n\nThis problem is forced online. For each operation, the values $l, r, x$ need to be XORed with the previous answer. If there has been no previous query, then the previous answer is $0$.", "inputFormat": "The first line contains two integers $n, m$.\n\nThe second line contains $n$ non-negative integers representing $a_i$.\n\nThen follow $m$ lines, each describing one operation.\n\n- `1 l r x`: For all numbers in the interval $[l,r]$ that are multiples of $x$, divide them by $x$.\n- `2 l r`: Query the sum of the interval $[l,r]$.", "outputFormat": "For each query, output one integer per line as the answer.", "hint": "Constraints: $1\\leq n,m\\leq 10^5$, $0\\leq a_i\\leq 5\\times 10^5$. The decrypted $x,l,r$ satisfy $1\\leq x\\leq 5\\times 10^5$, $1\\leq l\\leq r\\leq n$.\n\nIdea: nzhtl1477, Solution: nzhtl1477, Code: nzhtl1477, mrsrz, Data: nzhtl1477, mrsrz, 一只绝帆.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2013] 大学", "background": "", "description": "一个长为 $n$ 的**非负**整数序列 $a$，支持以下两个操作：\n\n- `1 l r x`：把区间 $[l,r]$ 中所有 $x$ 的倍数除以 $x$。\n- `2 l r`：查询区间 $[l,r]$ 的和。\n\n本题强制在线，每次的 $l,r,x$ 需要与上次答案做 xor 运算，如果之前没有询问，则上次答案为 $0$。", "inputFormat": "第一行两个整数表示 $n,m$。\n\n第二行 $n$ 个非负整数表示 $a_i$。\n\n之后 $m$ 行每行一个操作。\n\n- `1 l r x`：把区间 $[l,r]$ 中所有 $x$ 的倍数除以 $x$。\n- `2 l r`：查询区间 $[l,r]$ 的和。", "outputFormat": "对于每次询问，输出一行一个整数表示答案。", "hint": "$1\\leq n,m\\leq 10^5$，$0\\leq a_i\\leq 5\\times 10^5$，解密后的 $x,l,r$ 满足 $1\\leq x\\leq 5\\times 10^5$，$1\\leq l\\leq r\\leq n$。\n\nIdea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，mrsrz，Data：nzhtl1477，mrsrz，一只绝帆", "locale": "zh-CN"}}}
