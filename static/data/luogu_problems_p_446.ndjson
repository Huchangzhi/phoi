{"pid": "P10046", "type": "P", "difficulty": 6, "samples": [["3\n1 10\n8 2\n4 5", "10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2023", "省赛/邀请赛"], "title": "[CCPC 2023 北京市赛] 哈密顿", "background": "", "description": "给出 $n$ 个二元组 $(a_i,b_i)$。\n\n考虑 $n$ 个节点的带权有向完全图 $G$，其中从 $i (1 \\le i \\le n)$ 到 $j (1 \\le j \\le n)$ 的边边权为 $|a_i-b_j|$。\n\n求 $G$ 的一条哈密顿回路使得其经过的边的边权和最大，并给出这个最大值。", "inputFormat": "输入的第一行一个整数 $n(2 \\le n \\le 10^5)$ 表示二元组个数，接下来 $n$ 行每行两个整数 $a_i,b_i(0 \\le a_i,b_i \\le 10^9)$ 表示每个二元组。保证输入的 $n$ 个二元组中的总共 $2n$ 个数两两不同。", "outputFormat": "输出一行一个整数表示最大的哈密顿回路边权和。", "hint": "考察哈密顿回路 $1 \\to 2 \\to 3 \\to 1$，其边权和为 $|1-2| + |\n8-5| + |4-10| = 10$。可以证明不存在哈密顿回路边权和超过 $10$，因此答案为 $10$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCPC 2023 北京市赛] 哈密顿", "background": "", "description": "给出 $n$ 个二元组 $(a_i,b_i)$。\n\n考虑 $n$ 个节点的带权有向完全图 $G$，其中从 $i (1 \\le i \\le n)$ 到 $j (1 \\le j \\le n)$ 的边边权为 $|a_i-b_j|$。\n\n求 $G$ 的一条哈密顿回路使得其经过的边的边权和最大，并给出这个最大值。", "inputFormat": "输入的第一行一个整数 $n(2 \\le n \\le 10^5)$ 表示二元组个数，接下来 $n$ 行每行两个整数 $a_i,b_i(0 \\le a_i,b_i \\le 10^9)$ 表示每个二元组。保证输入的 $n$ 个二元组中的总共 $2n$ 个数两两不同。", "outputFormat": "输出一行一个整数表示最大的哈密顿回路边权和。", "hint": "考察哈密顿回路 $1 \\to 2 \\to 3 \\to 1$，其边权和为 $|1-2| + |\n8-5| + |4-10| = 10$。可以证明不存在哈密顿回路边权和超过 $10$，因此答案为 $10$。", "locale": "zh-CN"}}}
{"pid": "P10047", "type": "P", "difficulty": 6, "samples": [["7 9\ncats\neel\neve\nevil\nlee\nolive\nstack", "5"], ["2 2\na\naa", "2"], ["6 12\naa\naab\nno\non\npets\nstep", "43"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2023", "省赛/邀请赛"], "title": "[CCPC 2023 北京市赛] 勿蹖宠物", "background": "", "description": "Ene 喜欢回文。\n\nEne 现在有一些单词。她想选出若干个单词并将它们首尾相连，形成长度恰好为 $L$ 的回文串。每个单词都可以选择多次，也可以不选。\n\nEne 想知道这样做的方案数。Ene 认为两个方案不同，当且仅当各单词出现次数不同或它们的排列顺序不同，注意多种不同的方案可能会得到同一个回文串。由于答案可能会很大，你需要将答案对 $1,000,000,007$ 取模。", "inputFormat": "输入的第一行包含两个正整数 $N, L$，分别表示单词的数量和需要组成的回文串的长度。保证 $1\\le N\\le 333$，$1\\le L\\le 1000$。\n\n接下来 $N$ 行，每行输入一个字符串 $s_i$，表示一个单词。保证 $1\\le |s_i| \\le L$，$\\sum_{i=1}^N |s_i| \\le 600$；输入的单词仅包含小写字符，且互不相同。", "outputFormat": "输出一个非负整数，表示组成回文串的方案数对 $1,000,000,007$ 取模后的结果。", "hint": "**【样例解释 1】**\n\n有以下五种方案：\n\n- `stack` `cats`\n- `evil` `olive`\n- `eel` `eve` `lee`\n- `lee` `eve` `eel`\n- `eve` `eve` `eve`\n\n**【样例解释 2】**\n\n有以下两种方案：\n\n- `a` `a`\n- `aa`", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCPC 2023 北京市赛] 勿蹖宠物", "background": "", "description": "Ene 喜欢回文。\n\nEne 现在有一些单词。她想选出若干个单词并将它们首尾相连，形成长度恰好为 $L$ 的回文串。每个单词都可以选择多次，也可以不选。\n\nEne 想知道这样做的方案数。Ene 认为两个方案不同，当且仅当各单词出现次数不同或它们的排列顺序不同，注意多种不同的方案可能会得到同一个回文串。由于答案可能会很大，你需要将答案对 $1,000,000,007$ 取模。", "inputFormat": "输入的第一行包含两个正整数 $N, L$，分别表示单词的数量和需要组成的回文串的长度。保证 $1\\le N\\le 333$，$1\\le L\\le 1000$。\n\n接下来 $N$ 行，每行输入一个字符串 $s_i$，表示一个单词。保证 $1\\le |s_i| \\le L$，$\\sum_{i=1}^N |s_i| \\le 600$；输入的单词仅包含小写字符，且互不相同。", "outputFormat": "输出一个非负整数，表示组成回文串的方案数对 $1,000,000,007$ 取模后的结果。", "hint": "**【样例解释 1】**\n\n有以下五种方案：\n\n- `stack` `cats`\n- `evil` `olive`\n- `eel` `eve` `lee`\n- `lee` `eve` `eel`\n- `eve` `eve` `eve`\n\n**【样例解释 2】**\n\n有以下两种方案：\n\n- `a` `a`\n- `aa`", "locale": "zh-CN"}}}
{"pid": "P10048", "type": "P", "difficulty": 3, "samples": [["4\n0 3 2 100\n3 0 8 100\n2 8 0 10\n100 100 10 0", "0110\n1000\n1001\n0010"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2023", "省赛/邀请赛"], "title": "[CCPC 2023 北京市赛] 图", "background": "", "description": "给定一个 $n$ 个点的无向正权完全图，请对于每一条边 $(a,b)$，求出是否存在一个点对 $(x,y)$ 使得 $x\\rightarrow y$ 的所有最短路都经过 $(a,b)$。", "inputFormat": "第一行一个正整数 $n (1 \\le n \\le 500)$ 表示图的点数。\n\n接下来 $n$ 行每行 $n$ 个数，构成一个大小为 $n\\times n$ 的矩阵，第 $i$ 行第 $j$ 个数 $a_{i,j}(1\\leq a_{i,j}\\leq 10^6)$ 表示 $(i,j)$ 之间的边长度，特别地，$a_{i,i} = 0$.\n\n保证 $a_{i,j}=a_{j,i}$。", "outputFormat": "输出一个大小为 $n$ 的 $01$ 矩阵，其中第 $i$ 行第 $j$ 列为 $1$ 表示边 $(i,j)$ 满足题目中提出的要求，$0$ 表示不满足。\n\n特别的，当 $i=j$ 时输出 $0$。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCPC 2023 北京市赛] 图", "background": "", "description": "给定一个 $n$ 个点的无向正权完全图，请对于每一条边 $(a,b)$，求出是否存在一个点对 $(x,y)$ 使得 $x\\rightarrow y$ 的所有最短路都经过 $(a,b)$。", "inputFormat": "第一行一个正整数 $n (1 \\le n \\le 500)$ 表示图的点数。\n\n接下来 $n$ 行每行 $n$ 个数，构成一个大小为 $n\\times n$ 的矩阵，第 $i$ 行第 $j$ 个数 $a_{i,j}(1\\leq a_{i,j}\\leq 10^6)$ 表示 $(i,j)$ 之间的边长度，特别地，$a_{i,i} = 0$.\n\n保证 $a_{i,j}=a_{j,i}$。", "outputFormat": "输出一个大小为 $n$ 的 $01$ 矩阵，其中第 $i$ 行第 $j$ 列为 $1$ 表示边 $(i,j)$ 满足题目中提出的要求，$0$ 表示不满足。\n\n特别的，当 $i=j$ 时输出 $0$。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P10049", "type": "P", "difficulty": 5, "samples": [["2\n114 1 5\n514 2 10", "8\n10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2023", "省赛/邀请赛"], "title": "[CCPC 2023 北京市赛] 报数 IV", "background": "这是小 R 和小 Z 第四次玩报数游戏了，因此他们决定不再编冗长的题面了。你只需要知道，他们又编了一个奇怪的报数规则，然后想算一下有哪些数字可以报出来。", "description": "对于任意正整数 $n$，定义函数 $f(n)$ 为 $n$ 在十进制下各个数位之和，如 $f(114514)=1+1+4+5+1+4=16$。显然 $f(n)$ 也是正整数，因此可以嵌套地考虑 $f(f(n)),f(f(f(n)))$ 等等。进而对于正整数 $n,k$ 可以定义 $g(n,k)=f(f(...f(n)))$（共有 $k$ 层 $f$）。\n\n为了让报数游戏不再每局都是一模一样的，小 R 和小 Z 决定为每局游戏设置两个正整数 $k,m$，然后规定：在这一局游戏中，所有满足 $g(n,k)=m$ 的正整数 $n$ 都是不能报出的。\n\n因为两人都是游戏高手，为防止游戏无限进行下去，每局游戏中还给出了一个正整数 $N$ 表示报数的上界。两人想知道：在不超过 $N$ 的正整数中，有多少是按这个规则不能报出的。", "inputFormat": "第一行：一个正整数 $T$，表示小 R 和小 Z 进行的游戏轮数，保证 $1 \\le T \\le 5$。\n\n接下来 $T$ 行，每行 $3$ 个正整数 $N,k,m$，描述一局游戏，含义如上文所述。保证 $1 \\le N \\le 10^{1000}, 1 \\le k,m \\le 10^9$。", "outputFormat": "输出 $T$ 行，每行一个整数，表示这局游戏中不能报出的数的个数，对 $10^9+7$ 取模。", "hint": "第一局游戏中，不能报出的数有 $5,14,23,32,41,50,104,113$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCPC 2023 北京市赛] 报数 IV", "background": "这是小 R 和小 Z 第四次玩报数游戏了，因此他们决定不再编冗长的题面了。你只需要知道，他们又编了一个奇怪的报数规则，然后想算一下有哪些数字可以报出来。", "description": "对于任意正整数 $n$，定义函数 $f(n)$ 为 $n$ 在十进制下各个数位之和，如 $f(114514)=1+1+4+5+1+4=16$。显然 $f(n)$ 也是正整数，因此可以嵌套地考虑 $f(f(n)),f(f(f(n)))$ 等等。进而对于正整数 $n,k$ 可以定义 $g(n,k)=f(f(...f(n)))$（共有 $k$ 层 $f$）。\n\n为了让报数游戏不再每局都是一模一样的，小 R 和小 Z 决定为每局游戏设置两个正整数 $k,m$，然后规定：在这一局游戏中，所有满足 $g(n,k)=m$ 的正整数 $n$ 都是不能报出的。\n\n因为两人都是游戏高手，为防止游戏无限进行下去，每局游戏中还给出了一个正整数 $N$ 表示报数的上界。两人想知道：在不超过 $N$ 的正整数中，有多少是按这个规则不能报出的。", "inputFormat": "第一行：一个正整数 $T$，表示小 R 和小 Z 进行的游戏轮数，保证 $1 \\le T \\le 5$。\n\n接下来 $T$ 行，每行 $3$ 个正整数 $N,k,m$，描述一局游戏，含义如上文所述。保证 $1 \\le N \\le 10^{1000}, 1 \\le k,m \\le 10^9$。", "outputFormat": "输出 $T$ 行，每行一个整数，表示这局游戏中不能报出的数的个数，对 $10^9+7$ 取模。", "hint": "第一局游戏中，不能报出的数有 $5,14,23,32,41,50,104,113$。", "locale": "zh-CN"}}}
{"pid": "P10050", "type": "P", "difficulty": 4, "samples": [["6 3 3\n1 1 2 3 1 2\n1 2\n2 5\n2 6", "NO\nYES\nNO"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000]}, "tags": ["二分", "2022", "CCO（加拿大）", "深度优先搜索 DFS", "图论建模", "拓扑排序", "双指针 two-pointer"], "title": "[CCO 2022] Alternating Heights", "background": "", "description": "Troy 计划给 CCO 的学生拍一张合影，他向你寻求帮助。\n\n有 $K$ 个学生，编号从 $1$ 到 $K$。Troy 忘记了学生的身高，但他记得没有两个学生的身高相同。\n\nTroy 有一个序列 $A_{1}, A_{2}, \\ldots, A_{N}$，表示合影中从左到右的学生顺序。一个学生可能在 $A$ 中出现多次。你不确定这张合影会怎么拍，但你不愿意认为 Troy 犯了错误。\n\nTroy 会给你 $Q$ 个形式为 $x,y$ 的询问，每个询问为「给定学生序列 $A_{x}, A_{x+1}, \\ldots, A_{y}$，他们的身高能否形成一个交替序列？」更具体地说，我们用 $h_i$ 表示第 $i$ 个学生的身高。如果存在一种身高分配$ h_1, h_2, \\ldots, h_K$，使得 $h_{A_{x}}>h_{A_{x+1}}<h_{A_{x+2}}>h_{A_{x+3}}<\\ldots h_{A_{y}}$，回答 `YES`；否则回答 `NO`。\n\n注意，每个查询都是独立的：也就是说，询问 $i$ 的身高分配与询问 $j$ 的身高分配无关 $(i\\neq j)$。", "inputFormat": "第一行包含三个用空格分隔的整数 $N, K$ 和 $Q$。\n\n第二行包含 $N$ 个整数，表示 $A_{1}, A_{2}, \\ldots, A_{N}\\left(1 \\leq A_{i} \\leq K\\right)$。\n\n接下来的 $Q$ 行，每行包含两个用空格分隔的整数 $x$ 和 $y (1 \\leq x<y \\leq N)$，表示一组查询。", "outputFormat": "输出 $Q$ 行。第 $i$ 行，输出 `YES` 或者 `NO`，表示 Troy 的第 $i$ 个查询的答案。", "hint": "## 样例说明\n\n对于第一个询问，不可能有 $h_1>h_1$，所以答案是 `NO`。\n\n对于第二个询问，$h_1>h_2<h_3>h_1$ 的一种方案是 $h_1=160 \\mathrm{~cm}, h_2=140 \\mathrm{~cm}, h_3=180 \\mathrm{~cm}$。另一种方案是 $h_1=1.55 \\mathrm{~m}, h_2=1.473 \\mathrm{~m}, h_3=1.81 \\mathrm{~m}$。\n\n对于第三个询问，不可能同时有 $h_1>h_2$ 和 $h_1<h_2$。\n\n## 数据范围\n\n对于所有的数据，有 $2 \\leq N \\leq 3000$，$2 \\leq K \\leq N$，$1 \\leq Q \\leq 10^{6}$。\n\n子任务编号|\t分值|\t$N$|\t$K$|\t$Q$\n:-:|:-:|:-:|:-:|:-:\n$1$|\t$16$|\t$2 \\leq N \\leq 3000$|\t$K=2$|\t$1 \\leq Q \\leq 10^{6}$\n$2$|\t$24$|\t$2 \\leq N \\leq 500$|\t$2 \\leq K \\leq \\min (N, 5)$|$1 \\leq Q \\leq 10^{6}$\n$3$\t|$28$|\t$2 \\leq N \\leq 3000$\t|$2 \\leq K \\leq N$\t|$1 \\leq Q \\leq 2000$\n$4$|\t$32$| $2 \\leq N \\leq 3000$\t|$2 \\leq K \\leq N$\t|\t$1 \\leq Q \\leq 10^{6}$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCO 2022] Alternating Heights", "background": "", "description": "Troy 计划给 CCO 的学生拍一张合影，他向你寻求帮助。\n\n有 $K$ 个学生，编号从 $1$ 到 $K$。Troy 忘记了学生的身高，但他记得没有两个学生的身高相同。\n\nTroy 有一个序列 $A_{1}, A_{2}, \\ldots, A_{N}$，表示合影中从左到右的学生顺序。一个学生可能在 $A$ 中出现多次。你不确定这张合影会怎么拍，但你不愿意认为 Troy 犯了错误。\n\nTroy 会给你 $Q$ 个形式为 $x,y$ 的询问，每个询问为「给定学生序列 $A_{x}, A_{x+1}, \\ldots, A_{y}$，他们的身高能否形成一个交替序列？」更具体地说，我们用 $h_i$ 表示第 $i$ 个学生的身高。如果存在一种身高分配$ h_1, h_2, \\ldots, h_K$，使得 $h_{A_{x}}>h_{A_{x+1}}<h_{A_{x+2}}>h_{A_{x+3}}<\\ldots h_{A_{y}}$，回答 `YES`；否则回答 `NO`。\n\n注意，每个查询都是独立的：也就是说，询问 $i$ 的身高分配与询问 $j$ 的身高分配无关 $(i\\neq j)$。", "inputFormat": "第一行包含三个用空格分隔的整数 $N, K$ 和 $Q$。\n\n第二行包含 $N$ 个整数，表示 $A_{1}, A_{2}, \\ldots, A_{N}\\left(1 \\leq A_{i} \\leq K\\right)$。\n\n接下来的 $Q$ 行，每行包含两个用空格分隔的整数 $x$ 和 $y (1 \\leq x<y \\leq N)$，表示一组查询。", "outputFormat": "输出 $Q$ 行。第 $i$ 行，输出 `YES` 或者 `NO`，表示 Troy 的第 $i$ 个查询的答案。", "hint": "## 样例说明\n\n对于第一个询问，不可能有 $h_1>h_1$，所以答案是 `NO`。\n\n对于第二个询问，$h_1>h_2<h_3>h_1$ 的一种方案是 $h_1=160 \\mathrm{~cm}, h_2=140 \\mathrm{~cm}, h_3=180 \\mathrm{~cm}$。另一种方案是 $h_1=1.55 \\mathrm{~m}, h_2=1.473 \\mathrm{~m}, h_3=1.81 \\mathrm{~m}$。\n\n对于第三个询问，不可能同时有 $h_1>h_2$ 和 $h_1<h_2$。\n\n## 数据范围\n\n对于所有的数据，有 $2 \\leq N \\leq 3000$，$2 \\leq K \\leq N$，$1 \\leq Q \\leq 10^{6}$。\n\n子任务编号|\t分值|\t$N$|\t$K$|\t$Q$\n:-:|:-:|:-:|:-:|:-:\n$1$|\t$16$|\t$2 \\leq N \\leq 3000$|\t$K=2$|\t$1 \\leq Q \\leq 10^{6}$\n$2$|\t$24$|\t$2 \\leq N \\leq 500$|\t$2 \\leq K \\leq \\min (N, 5)$|$1 \\leq Q \\leq 10^{6}$\n$3$\t|$28$|\t$2 \\leq N \\leq 3000$\t|$2 \\leq K \\leq N$\t|$1 \\leq Q \\leq 2000$\n$4$|\t$32$| $2 \\leq N \\leq 3000$\t|$2 \\leq K \\leq N$\t|\t$1 \\leq Q \\leq 10^{6}$", "locale": "zh-CN"}}}
{"pid": "P10051", "type": "P", "difficulty": 4, "samples": [["3\n10 15 10\n20 20\n0 0", "NO"], ["3\n10 15 10\n20 20\n0 11", "YES\n5\n10 0 10\n5 5 10"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["动态规划 DP", "贪心", "2022", "Special Judge", "CCO（加拿大）"], "title": "[CCO 2022] Rainy Markets", "background": "## 由于数据包过大，本题无法上传全部数据。", "description": "有 $N$ 个公交车站，标号为 $1, \\ldots, N$。第 $i$ 个公交车站可以容纳 $B_{i}$ 个人。\n\n对于每个 $i \\in\\{1, \\ldots, N-1\\}$，有一条人行道连接公交车站 $i$ 和公交车站 $i+1$，中间有一个露天市场。第 $i$ 个市场有 $U_{i}$ 把雨伞出售，每把雨伞的价格为 $1$。\n\n现在，有 $P_{i}$ 个人在第 $i$ 个市场里面，所有的公交车站都是空的。\n\n突然，天开始下雨，市场 $i$ 的每个人都必须在三种方案中选择一种：\n\n- 去公交车站 $i$；\n- 去公交车站 $i+1$；\n- 留下来买一把雨伞。\n\n如果一个人无法在某个公交车站下或者买一把雨伞，他们就会淋湿。\n\n你需要回答如果在最优的安排方案下，能否确保每个人都能不被雨淋湿。如果是的话，你需要给出他们需要花费的最少的钱，以及每个人应该移动到哪个公交车站。", "inputFormat": "第一行包含一个整数 $N$。\n\n第二行包含 $N$ 个用空格分隔的整数 $B_{i}\\ (1 \\leq i \\leq N)$，表示公交车站 $i$ 的容量。\n\n第三行包含 $N-1$ 个用空格分隔的整数 $P_{i}\\ (1 \\leq i \\leq N-1)$，表示市场 $i$ 的人数。\n\n第四行包含 $N-1$ 个用空格分隔的整数 $U_{i}\\ (1 \\leq i \\leq N-1)$，表示市场 $i$ 出售的雨伞的数量。", "outputFormat": "如果每个人都能在雨伞或公交车站下，输出 $N+1$ 行：\n\n- 第一行输出一行 `YES`。\n- 第二行输出一个整数，表示包含在雨伞上花费的最少的钱。\n- 接下来的 $N-1$ 行，每行输出三个用空格分隔的整数分别表示市场 $i\\ (1\\leq i \\leq N-1)$ 移动到公交车站 $i$ 的人数，市场 $i$ 买雨伞的人数，市场 $i$ 移动到公交车站 $i+1$ 的人数。\n\n如果有多种合法方案，你可以输出任意一种。\n\n否则，输出一行 `NO`。", "hint": "## 样例 1 解释\n\n公交车站有 $35$ 个空位，没有雨伞出售，但市场有 $40$ 个人，所以答案是 `NO`。\n\n## 样例 2 解释\n\n市场 $1$ 中的 $10$ 个人会去公交车站 $1$，没有人会买雨伞，$10$ 个人会去公交车站 $2$。\n\n市场 $2$ 中的 $5$ 个人会去公交车站 $2$，$5$ 个人会留下来买雨伞，$10$ 个人会移动到公交车站 $3$。\n\n总共购买了 $5$ 把雨伞，花费了 $5$。\n\n## 数据范围\n\n对于所有的数据，有 $2 \\leq N \\leq 10^{6}$，$0 \\leq B_{i} \\leq 2 \\cdot 10^{9}$，$0 \\leq P_{i},U_{i} \\leq 10^{9}$。\n\n子任务编号|分值|\t$N$|\t$B$|\t$P$|\t$U$\n:-:|:-:|:-:|:-:|:-:|:-:\n|$1$|\t$20$|\t$2 \\leq N \\leq 10^{6}$|\t$0 \\leq B_{i} \\leq 2 \\cdot 10^{9}\t$|$0 \\leq P_{i} \\leq 10^{9}$\t|$U_{i}=0$\n$2$|$20$|$2 \\leq N \\leq 2000$|\t$0 \\leq B_{i} \\leq 400$|$\t0 \\leq P_{i} \\leq 200$|\t$0 \\leq U_{i} \\leq 200$\n$3$|\t$24$|\t$2 \\leq N \\leq 4000$\t|$0 \\leq B_{i} \\leq 4000$|\t$0 \\leq P_{i} \\leq 2000$|\t$0 \\leq U_{i} \\leq 2000$\n$4$|\t$36$|\t$2 \\leq N \\leq 10^{6}$\t|$0 \\leq B_{i} \\leq 2 \\cdot 10^{9}$|\t$0 \\leq P_{i} \\leq 10^{9}$|\t$0 \\leq U_{i} \\leq 10^{9}$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCO 2022] Rainy Markets", "background": "## 由于数据包过大，本题无法上传全部数据。", "description": "有 $N$ 个公交车站，标号为 $1, \\ldots, N$。第 $i$ 个公交车站可以容纳 $B_{i}$ 个人。\n\n对于每个 $i \\in\\{1, \\ldots, N-1\\}$，有一条人行道连接公交车站 $i$ 和公交车站 $i+1$，中间有一个露天市场。第 $i$ 个市场有 $U_{i}$ 把雨伞出售，每把雨伞的价格为 $1$。\n\n现在，有 $P_{i}$ 个人在第 $i$ 个市场里面，所有的公交车站都是空的。\n\n突然，天开始下雨，市场 $i$ 的每个人都必须在三种方案中选择一种：\n\n- 去公交车站 $i$；\n- 去公交车站 $i+1$；\n- 留下来买一把雨伞。\n\n如果一个人无法在某个公交车站下或者买一把雨伞，他们就会淋湿。\n\n你需要回答如果在最优的安排方案下，能否确保每个人都能不被雨淋湿。如果是的话，你需要给出他们需要花费的最少的钱，以及每个人应该移动到哪个公交车站。", "inputFormat": "第一行包含一个整数 $N$。\n\n第二行包含 $N$ 个用空格分隔的整数 $B_{i}\\ (1 \\leq i \\leq N)$，表示公交车站 $i$ 的容量。\n\n第三行包含 $N-1$ 个用空格分隔的整数 $P_{i}\\ (1 \\leq i \\leq N-1)$，表示市场 $i$ 的人数。\n\n第四行包含 $N-1$ 个用空格分隔的整数 $U_{i}\\ (1 \\leq i \\leq N-1)$，表示市场 $i$ 出售的雨伞的数量。", "outputFormat": "如果每个人都能在雨伞或公交车站下，输出 $N+1$ 行：\n\n- 第一行输出一行 `YES`。\n- 第二行输出一个整数，表示包含在雨伞上花费的最少的钱。\n- 接下来的 $N-1$ 行，每行输出三个用空格分隔的整数分别表示市场 $i\\ (1\\leq i \\leq N-1)$ 移动到公交车站 $i$ 的人数，市场 $i$ 买雨伞的人数，市场 $i$ 移动到公交车站 $i+1$ 的人数。\n\n如果有多种合法方案，你可以输出任意一种。\n\n否则，输出一行 `NO`。", "hint": "## 样例 1 解释\n\n公交车站有 $35$ 个空位，没有雨伞出售，但市场有 $40$ 个人，所以答案是 `NO`。\n\n## 样例 2 解释\n\n市场 $1$ 中的 $10$ 个人会去公交车站 $1$，没有人会买雨伞，$10$ 个人会去公交车站 $2$。\n\n市场 $2$ 中的 $5$ 个人会去公交车站 $2$，$5$ 个人会留下来买雨伞，$10$ 个人会移动到公交车站 $3$。\n\n总共购买了 $5$ 把雨伞，花费了 $5$。\n\n## 数据范围\n\n对于所有的数据，有 $2 \\leq N \\leq 10^{6}$，$0 \\leq B_{i} \\leq 2 \\cdot 10^{9}$，$0 \\leq P_{i},U_{i} \\leq 10^{9}$。\n\n子任务编号|分值|\t$N$|\t$B$|\t$P$|\t$U$\n:-:|:-:|:-:|:-:|:-:|:-:\n|$1$|\t$20$|\t$2 \\leq N \\leq 10^{6}$|\t$0 \\leq B_{i} \\leq 2 \\cdot 10^{9}\t$|$0 \\leq P_{i} \\leq 10^{9}$\t|$U_{i}=0$\n$2$|$20$|$2 \\leq N \\leq 2000$|\t$0 \\leq B_{i} \\leq 400$|$\t0 \\leq P_{i} \\leq 200$|\t$0 \\leq U_{i} \\leq 200$\n$3$|\t$24$|\t$2 \\leq N \\leq 4000$\t|$0 \\leq B_{i} \\leq 4000$|\t$0 \\leq P_{i} \\leq 2000$|\t$0 \\leq U_{i} \\leq 2000$\n$4$|\t$36$|\t$2 \\leq N \\leq 10^{6}$\t|$0 \\leq B_{i} \\leq 2 \\cdot 10^{9}$|\t$0 \\leq P_{i} \\leq 10^{9}$|\t$0 \\leq U_{i} \\leq 10^{9}$", "locale": "zh-CN"}}}
{"pid": "P10052", "type": "P", "difficulty": 6, "samples": [["3 1 8\n10 20\n100 101\n20 21\n15 25", "3"], ["1 5 3\n1 100\n1 2\n2 3\n3 4\n4 5\n5 6", "4"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2022", "CCO（加拿大）"], "title": "[CCO 2022] Double Attendance", "background": "", "description": "由于你的学校课程安排过于抽象，你的两门课程将在两个不同的教室里同时开始！你一次只能在一个地方，所以你只能在两个教室之间来回溜达，希望能够抓住两门课程的重点。\n\n两个教室的编号分别是 $1$ 和 $2$。在教室 $i$，老师将在课堂上展示 $N_{i}$ 张不同的幻灯片，第 j 张幻灯片将在时间区间 $\\left(A_{i, j}, B_{i, j}\\right)\\left(0 \\leq A_{i, j}<B_{i, j}\\right)$ 内展示，其中 $A_{i, j}$ 和 $B_{i, j}$ 是从课堂开始后以秒为单位计算的时间。在两个教室里，不会在某个时间点同时展示多张幻灯片。例如，一个课堂可能在 $(1,2)$ 和 $(5,6)$ 这两对时间区间内有幻灯片展示，或者在 $(10,20)$ 和 $(20,30)$ 这两对时间区间内有幻灯片展示，但不会在 $(10,20)$ 和 $(19,30)$ 这两对时间区间有幻灯片展示。\n\n你在教室 $1$ 开始一天的课程，两门课程都在时刻 $0$ 开始。在那之后，你可以在任何时间点（不一定是整数秒）花费 $K$ 秒从你当前的教室移动到另一个教室。如果你在展示幻灯片的时间区间内在其教室里花费了正数时间，你就认为自己看到了这张幻灯片。当你在两个教室之间移动的 $K$ 秒内，你不在任何一个教室里，因此无法看到任何幻灯片。\n\n例如，如果教室 $1$ 在时间区间 $(10,20)$ 展示一张幻灯片，教室 $2$ 在时间区间 $(15,25)$ 展示一张幻灯片，而 $K=8$，那么如果你在时间 $11.5$ 秒时从教室 $1$ 移动到教室 $2$（到达时间为 $19.5$ 秒），你就能看到两张幻灯片。另一方面，如果你在时间 $17$ 秒时离开教室 $1$（到达时间为 $25$ 秒），那么你将在教室 $2$ 的幻灯片停止展示后才进入教室，因此你会错过它。\n\n你想要知道你能看到的不同幻灯片的最大数量是多少。", "inputFormat": "第一行包含三个用空格分隔的整数，$N_{1}, N_{2}$ 和 $K$。\n\n接下来的 $N_{1}$ 行，每行包含两个用空格分隔的整数 $A_{1, i}$ 和 $B_{1, i}\\left(1 \\leq i \\leq N_{1}\\right)$。\n\n接下来的 $N_{2}$ 行，每行包含两个用空格分隔的整数，$A_{2, i}$ 和 $B_{2, i}\\left(1 \\leq i \\leq N_{2}\\right)$。", "outputFormat": "输出一个整数，表示你能看到的不同幻灯片的最大数量。", "hint": "## 样例 1 解释\n\n一种可能的最优策略是在教室 $1$ 一直待到时间 $11.5$，然后移动到教室 $2$（到达时间为 $19.5$），一直待到时间 $19.6$，最后返回教室 $1$（到达时间为 $27.6$）。在这个过程中，你将看到除了第 $3$ 张幻灯片以外的所有幻灯片。你不可能看到所有的 $4$ 张幻灯片。\n\n## 样例 2 解释\n\n即使你在课程开始时立即移动到教室 $2$（例如，在时间 $0.0001$），你也会错过那里展示的前两张幻灯片。因此，你最多可以看到四张幻灯片。\n\n## 数据范围\n对于所有的数据，有 $1 \\leq N_{i} \\leq 3\\times 10^5$，$0 \\leq A_{i, j}<B_{i, j} \\leq 10^{9}$，$1 \\leq K \\leq 10^{9}$。\n\n子任务编号|分值|$N_{i}$|$A_{i, j},B_{i, j}$\n:-:|:-:|:-:|:-:\n$1$|$20$|$1 \\leq N_{i} \\leq 10$|$0 \\leq A_{i, j}<B_{i, j} \\leq 2000$\n$2$|$40$|$1 \\leq N_{i} \\leq 2000$|$0 \\leq A_{i, j}<B_{i, j} \\leq 2000$\n$3$|$24$|$1 \\leq N_{i} \\leq 2000$|$B_{i, j}-A_{i, j} \\leq 2 K$\n$4$|$16$|$1 \\leq N_{i} \\leq 3\\times 10^5$|$0 \\leq A_{i, j}<B_{i, j} \\leq 10^{9}$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCO 2022] Double Attendance", "background": "", "description": "由于你的学校课程安排过于抽象，你的两门课程将在两个不同的教室里同时开始！你一次只能在一个地方，所以你只能在两个教室之间来回溜达，希望能够抓住两门课程的重点。\n\n两个教室的编号分别是 $1$ 和 $2$。在教室 $i$，老师将在课堂上展示 $N_{i}$ 张不同的幻灯片，第 j 张幻灯片将在时间区间 $\\left(A_{i, j}, B_{i, j}\\right)\\left(0 \\leq A_{i, j}<B_{i, j}\\right)$ 内展示，其中 $A_{i, j}$ 和 $B_{i, j}$ 是从课堂开始后以秒为单位计算的时间。在两个教室里，不会在某个时间点同时展示多张幻灯片。例如，一个课堂可能在 $(1,2)$ 和 $(5,6)$ 这两对时间区间内有幻灯片展示，或者在 $(10,20)$ 和 $(20,30)$ 这两对时间区间内有幻灯片展示，但不会在 $(10,20)$ 和 $(19,30)$ 这两对时间区间有幻灯片展示。\n\n你在教室 $1$ 开始一天的课程，两门课程都在时刻 $0$ 开始。在那之后，你可以在任何时间点（不一定是整数秒）花费 $K$ 秒从你当前的教室移动到另一个教室。如果你在展示幻灯片的时间区间内在其教室里花费了正数时间，你就认为自己看到了这张幻灯片。当你在两个教室之间移动的 $K$ 秒内，你不在任何一个教室里，因此无法看到任何幻灯片。\n\n例如，如果教室 $1$ 在时间区间 $(10,20)$ 展示一张幻灯片，教室 $2$ 在时间区间 $(15,25)$ 展示一张幻灯片，而 $K=8$，那么如果你在时间 $11.5$ 秒时从教室 $1$ 移动到教室 $2$（到达时间为 $19.5$ 秒），你就能看到两张幻灯片。另一方面，如果你在时间 $17$ 秒时离开教室 $1$（到达时间为 $25$ 秒），那么你将在教室 $2$ 的幻灯片停止展示后才进入教室，因此你会错过它。\n\n你想要知道你能看到的不同幻灯片的最大数量是多少。", "inputFormat": "第一行包含三个用空格分隔的整数，$N_{1}, N_{2}$ 和 $K$。\n\n接下来的 $N_{1}$ 行，每行包含两个用空格分隔的整数 $A_{1, i}$ 和 $B_{1, i}\\left(1 \\leq i \\leq N_{1}\\right)$。\n\n接下来的 $N_{2}$ 行，每行包含两个用空格分隔的整数，$A_{2, i}$ 和 $B_{2, i}\\left(1 \\leq i \\leq N_{2}\\right)$。", "outputFormat": "输出一个整数，表示你能看到的不同幻灯片的最大数量。", "hint": "## 样例 1 解释\n\n一种可能的最优策略是在教室 $1$ 一直待到时间 $11.5$，然后移动到教室 $2$（到达时间为 $19.5$），一直待到时间 $19.6$，最后返回教室 $1$（到达时间为 $27.6$）。在这个过程中，你将看到除了第 $3$ 张幻灯片以外的所有幻灯片。你不可能看到所有的 $4$ 张幻灯片。\n\n## 样例 2 解释\n\n即使你在课程开始时立即移动到教室 $2$（例如，在时间 $0.0001$），你也会错过那里展示的前两张幻灯片。因此，你最多可以看到四张幻灯片。\n\n## 数据范围\n对于所有的数据，有 $1 \\leq N_{i} \\leq 3\\times 10^5$，$0 \\leq A_{i, j}<B_{i, j} \\leq 10^{9}$，$1 \\leq K \\leq 10^{9}$。\n\n子任务编号|分值|$N_{i}$|$A_{i, j},B_{i, j}$\n:-:|:-:|:-:|:-:\n$1$|$20$|$1 \\leq N_{i} \\leq 10$|$0 \\leq A_{i, j}<B_{i, j} \\leq 2000$\n$2$|$40$|$1 \\leq N_{i} \\leq 2000$|$0 \\leq A_{i, j}<B_{i, j} \\leq 2000$\n$3$|$24$|$1 \\leq N_{i} \\leq 2000$|$B_{i, j}-A_{i, j} \\leq 2 K$\n$4$|$16$|$1 \\leq N_{i} \\leq 3\\times 10^5$|$0 \\leq A_{i, j}<B_{i, j} \\leq 10^{9}$", "locale": "zh-CN"}}}
{"pid": "P10053", "type": "P", "difficulty": 6, "samples": [["5 2\n1 3\n2 3\n0 0\n4 5\n0 0\n0 0", "4"], ["4 3\n1 2 4\n0 2\n0 3\n0 4\n0 0", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000]}, "tags": ["2022", "CCO（加拿大）"], "title": "[CCO 2022] Bi-ing Lottery Treekets", "background": null, "description": "在一个平行宇宙里，每个人都在 CCO 上得了满分。因此，Troy 需要根据抽奖来选出获胜者。每个参赛者将选择一些数字来创建一张彩票。一张彩票是一个大小为 $N$ 的数组，从 $1$ 到 $N$ 编号，其中每个元素是从 $0$ 到 $K$ 的一个数字。\n\n中奖彩票是由将 $K$ 个球（编号为 $1$ 到 $K$）按随机顺序投入一个有根二叉树来确定的。这棵树有 $N$ 个节点（编号为 $1$ 到 $N$），并以节点 $1$ 为根。\n\n每个球都有一个指定的投放节点，它将在那里投放。当一个球投放在一个空节点或进入一个空节点时，会发生以下三种情况之一：\n\n1. 如果当前节点的所有子节点都被球占据（或者如果一个节点没有子节点），那么当前球就会停留在当前节点。也就是说，它会留在那里，不再移动。\n2. 如果当前节点只有一个空的子节点，那么当前球将移动到这个子节点。\n3. 如果当前节点有两个空的子节点，而且如果当前球刚刚被投放，它可以向左或向右移动。否则，它将继续沿着它之前的移动方向移动。\n\n如果 $K$ 个球不能全部被投放，那么就没有确定的中奖彩票。这种情况发生在一个球被投放时，它的投放节点被另一个球占据了。\n\n如果所有 $K$ 个球都被投放了，那么球的停留位置就决定了中奖彩票。中奖彩票的第 $i$ 个元素是停留在节点 $i$ 的球的编号，或者如果没有球停留在节点 $i$，就是 $0$。\n\nTroy 想知道可能的中奖彩票的数量。因为答案可能很大，你只需要求数量对 $10^9+7$ 取模的结果。", "inputFormat": "第一行包含两个用空格分隔的整数 $N$ 和 $K$，表示二叉树中的节点数和球的数目。\n\n第二行包含 $K$ 个用空格分隔的整数，其中第 $i$ 个整数表示编号为 $i$ 的球的指定投放节点。\n\n最后 $N$ 行，每行包含两个用空格分隔的整数。第 $i$ 行包含 $L_{i}$ 和 $R_{i}$，表示第 $i$ 个节点的左子节点和右子节点，其中 $0$ 表示子节点不存在。", "outputFormat": "输出中奖彩票的数量模 $10^{9}+7$。", "hint": "## 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ts1yicyn.png)\n\n考虑当球 $1$ 先被投放时。如果球 $1$ 向左移动，那么它将停留在节点 $2$。之后，球 $2$ 被投放，可以停留在节点 $4$ 或 $5$。如果球 $1$ 向右移动，它将停留在节点 $5$。然后，球 $2$ 将停留在节点 $4$。\n\n考虑当球 $2$ 先被投放时。球 $2$ 可以向左或向右移动，分别停留在节点 $4$ 或 $5$。然后如果球 $1$ 在被投放后向左移动，它将停留在节点 $2$。然而，如果球 $1$ 向右移动，它将停留在节点 $4$ 或 $5$，取决于球 $2$ 没有占据的位置。\n\n可能的中奖彩票是 $[0,1,0,2,0],[0,1,0,0,2],[0,0,0,1,2]$ 和 $[0,0,0,2,1]$。\n\n## 样例 2 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/r5ih52s1.png)\n\n这个样例满足第二个子任务的条件。\n\n球 $3$ 必须先被投放，因为如果球 $1$ 或球 $2$ 在球 $3$ 之前被投放，它会停留在节点 $4$，这不会让球 $3$ 被投放。\n\n因此，我们可以先投放球 $3$，然后投放球 $2$，最后投放球 $1$，或者我们可以先投放球 $3$，然后投放球 $1$，最后投放球 $2$。对应的中奖彩票是 $[0,1,2,3]$ 和 $[0,2,1,3]$。\n\n## 数据范围 \n\n对于所有的数据，有 $1\\leq N,K \\leq 4000$。\n\n子任务编号|分值|$N$ 的范围|$K$ 的范围|额外的约束\n:-:|:-:|:-:|:-:|:-:\n$1$|$12$|$1 \\leq N \\leq 12$|$1 \\leq K \\leq 6$|无\n$2$|$16$|$1 \\leq N \\leq 4000$|$1 \\leq K \\leq 4000$|所有节点都没有左子节点\n$3$|$36$|$1 \\leq N \\leq 4000$|$1 \\leq K \\leq 4000$|$K$ 个投放节点是不同的\n$4$|$36$|$1 \\leq N \\leq 4000$|$1 \\leq K \\leq 4000$|无", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCO 2022] Bi-ing Lottery Treekets", "background": null, "description": "在一个平行宇宙里，每个人都在 CCO 上得了满分。因此，Troy 需要根据抽奖来选出获胜者。每个参赛者将选择一些数字来创建一张彩票。一张彩票是一个大小为 $N$ 的数组，从 $1$ 到 $N$ 编号，其中每个元素是从 $0$ 到 $K$ 的一个数字。\n\n中奖彩票是由将 $K$ 个球（编号为 $1$ 到 $K$）按随机顺序投入一个有根二叉树来确定的。这棵树有 $N$ 个节点（编号为 $1$ 到 $N$），并以节点 $1$ 为根。\n\n每个球都有一个指定的投放节点，它将在那里投放。当一个球投放在一个空节点或进入一个空节点时，会发生以下三种情况之一：\n\n1. 如果当前节点的所有子节点都被球占据（或者如果一个节点没有子节点），那么当前球就会停留在当前节点。也就是说，它会留在那里，不再移动。\n2. 如果当前节点只有一个空的子节点，那么当前球将移动到这个子节点。\n3. 如果当前节点有两个空的子节点，而且如果当前球刚刚被投放，它可以向左或向右移动。否则，它将继续沿着它之前的移动方向移动。\n\n如果 $K$ 个球不能全部被投放，那么就没有确定的中奖彩票。这种情况发生在一个球被投放时，它的投放节点被另一个球占据了。\n\n如果所有 $K$ 个球都被投放了，那么球的停留位置就决定了中奖彩票。中奖彩票的第 $i$ 个元素是停留在节点 $i$ 的球的编号，或者如果没有球停留在节点 $i$，就是 $0$。\n\nTroy 想知道可能的中奖彩票的数量。因为答案可能很大，你只需要求数量对 $10^9+7$ 取模的结果。", "inputFormat": "第一行包含两个用空格分隔的整数 $N$ 和 $K$，表示二叉树中的节点数和球的数目。\n\n第二行包含 $K$ 个用空格分隔的整数，其中第 $i$ 个整数表示编号为 $i$ 的球的指定投放节点。\n\n最后 $N$ 行，每行包含两个用空格分隔的整数。第 $i$ 行包含 $L_{i}$ 和 $R_{i}$，表示第 $i$ 个节点的左子节点和右子节点，其中 $0$ 表示子节点不存在。", "outputFormat": "输出中奖彩票的数量模 $10^{9}+7$。", "hint": "## 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ts1yicyn.png)\n\n考虑当球 $1$ 先被投放时。如果球 $1$ 向左移动，那么它将停留在节点 $2$。之后，球 $2$ 被投放，可以停留在节点 $4$ 或 $5$。如果球 $1$ 向右移动，它将停留在节点 $5$。然后，球 $2$ 将停留在节点 $4$。\n\n考虑当球 $2$ 先被投放时。球 $2$ 可以向左或向右移动，分别停留在节点 $4$ 或 $5$。然后如果球 $1$ 在被投放后向左移动，它将停留在节点 $2$。然而，如果球 $1$ 向右移动，它将停留在节点 $4$ 或 $5$，取决于球 $2$ 没有占据的位置。\n\n可能的中奖彩票是 $[0,1,0,2,0],[0,1,0,0,2],[0,0,0,1,2]$ 和 $[0,0,0,2,1]$。\n\n## 样例 2 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/r5ih52s1.png)\n\n这个样例满足第二个子任务的条件。\n\n球 $3$ 必须先被投放，因为如果球 $1$ 或球 $2$ 在球 $3$ 之前被投放，它会停留在节点 $4$，这不会让球 $3$ 被投放。\n\n因此，我们可以先投放球 $3$，然后投放球 $2$，最后投放球 $1$，或者我们可以先投放球 $3$，然后投放球 $1$，最后投放球 $2$。对应的中奖彩票是 $[0,1,2,3]$ 和 $[0,2,1,3]$。\n\n## 数据范围 \n\n对于所有的数据，有 $1\\leq N,K \\leq 4000$。\n\n子任务编号|分值|$N$ 的范围|$K$ 的范围|额外的约束\n:-:|:-:|:-:|:-:|:-:\n$1$|$12$|$1 \\leq N \\leq 12$|$1 \\leq K \\leq 6$|无\n$2$|$16$|$1 \\leq N \\leq 4000$|$1 \\leq K \\leq 4000$|所有节点都没有左子节点\n$3$|$36$|$1 \\leq N \\leq 4000$|$1 \\leq K \\leq 4000$|$K$ 个投放节点是不同的\n$4$|$36$|$1 \\leq N \\leq 4000$|$1 \\leq K \\leq 4000$|无", "locale": "zh-CN"}}}
{"pid": "P10054", "type": "P", "difficulty": 6, "samples": [["6 4 4 9\n1 2 1\n2 3 2\n1 4 3\n3 4 4\n5 6 40\n1 5 30\n2 6 20\n3 6 10", "33"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2022", "CCO（加拿大）"], "title": "[CCO 2022] Phone Plans", "background": "", "description": "CCOland 的市长 Jason 想要在 $N$ 个住户之间安装电话线，这些住户从 $1$ 到 $N$ 编号。为此，他向两家竞争对手 Keenan 移动电话和 Chris 家庭电话询问了他们的电话套餐。一个公司的电话套餐对应于一个特定的等级，每条电话线都有一个等级和一个与之相关的公司。如果你从一个公司购买了等级为 $l$ 的电话套餐，那么你就能够使用该公司所有等级小于或等于 $l$ 的电话线。等级为 $l$ 的电话套餐的价格为 $l$，你不能选择价格低于 $0$ 的电话套餐。\n\n两个住户只有在通过同一家公司的电话线的路径连接时才能相互通信。Jason 想要从每家公司购买一个最低成本的电话套餐，使得至少有 $K$ 对不同的住户能够相互通信。", "inputFormat": "第一行包含四个用空格分隔的整数 N, A, B 和 K，分别表示住户的数量，Keenan 移动电话的电话线的数量，Chris 家庭电话的电话线的数量，以及需要能够相互通信的最小住户对数。\n\n接下来的 $A$ 行，每行包含三个用空格分隔的整数 $u, v$ 和 $l$，表示一条 Keenan 移动电话的电话线。它连接了住户 $u$ 和 $v\\ (1 \\leq u, v \\leq N)$，等级为 $l\\ (1 \\leq l \\leq 10^{9})$。\n\n接下来的 $B$ 行，每行包含三个用空格分隔的整数 $u, v$ 和 $l$，表示一条 Chris 家庭电话的电话线，它连接了住户 $u$ 和 $v\\ (1 \\leq u, v \\leq N)$，等级为 $l\\ (1 \\leq l \\leq 10^{9})$。", "outputFormat": "输出连接至少 $K$ 对不同住户所需的最低成本，如果不可能，则输出 $-1$。", "hint": "## 样例解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/v7y9k0vk.png)\n\n如果 Jason 从 Keenan 移动电话购买等级为 $3$ 的电话套餐，从 Chris 家庭电话购买等级为 $30$ 的电话套餐，那么 $(1,2),(1,3),(1,4),(2,3),(2,4),(3,4)$ 可以通过 Keenan 移动电话的线路相互通信，而 $(1,5),(2,6),(3,6),(2,3)$ 可以通过 Chris 家庭电话的线路相互通信。没有更便宜的方法。\n\n## 数据范围\n\n对于所有的数据，有 $1 \\leq N \\leq 2\\times 10^5，0 \\leq A, B \\leq 2\\times 10^5$，$0 \\leq K \\leq \\frac{N(N-1)}{2}$。\n\n子任务编号|分值|$N$|$A, B$|附加限制\n:-:|:-:|:-:|:-:|:-:\n$1$|$24$|$1 \\leq N \\leq 2000$|$0 \\leq A, B \\leq 2\\times 10^5$|无\n$2$|$20$|$1 \\leq N \\leq 2\\times 10^5$|$1 \\leq N \\leq 2\\times 10^5$|Keenan 移动电话只连接编号为奇数的住户；Chris 家庭电话只连接编号为偶数的住户\n$3$|$24$|$1 \\leq N \\leq 2\\times 10^5$|$0 \\leq A \\leq 10$|无\n$4$|$32$|$1 \\leq N \\leq 2\\times 10^5$|$0 \\leq A, B \\leq 2\\times 10^5$|无", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCO 2022] Phone Plans", "background": "", "description": "CCOland 的市长 Jason 想要在 $N$ 个住户之间安装电话线，这些住户从 $1$ 到 $N$ 编号。为此，他向两家竞争对手 Keenan 移动电话和 Chris 家庭电话询问了他们的电话套餐。一个公司的电话套餐对应于一个特定的等级，每条电话线都有一个等级和一个与之相关的公司。如果你从一个公司购买了等级为 $l$ 的电话套餐，那么你就能够使用该公司所有等级小于或等于 $l$ 的电话线。等级为 $l$ 的电话套餐的价格为 $l$，你不能选择价格低于 $0$ 的电话套餐。\n\n两个住户只有在通过同一家公司的电话线的路径连接时才能相互通信。Jason 想要从每家公司购买一个最低成本的电话套餐，使得至少有 $K$ 对不同的住户能够相互通信。", "inputFormat": "第一行包含四个用空格分隔的整数 N, A, B 和 K，分别表示住户的数量，Keenan 移动电话的电话线的数量，Chris 家庭电话的电话线的数量，以及需要能够相互通信的最小住户对数。\n\n接下来的 $A$ 行，每行包含三个用空格分隔的整数 $u, v$ 和 $l$，表示一条 Keenan 移动电话的电话线。它连接了住户 $u$ 和 $v\\ (1 \\leq u, v \\leq N)$，等级为 $l\\ (1 \\leq l \\leq 10^{9})$。\n\n接下来的 $B$ 行，每行包含三个用空格分隔的整数 $u, v$ 和 $l$，表示一条 Chris 家庭电话的电话线，它连接了住户 $u$ 和 $v\\ (1 \\leq u, v \\leq N)$，等级为 $l\\ (1 \\leq l \\leq 10^{9})$。", "outputFormat": "输出连接至少 $K$ 对不同住户所需的最低成本，如果不可能，则输出 $-1$。", "hint": "## 样例解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/v7y9k0vk.png)\n\n如果 Jason 从 Keenan 移动电话购买等级为 $3$ 的电话套餐，从 Chris 家庭电话购买等级为 $30$ 的电话套餐，那么 $(1,2),(1,3),(1,4),(2,3),(2,4),(3,4)$ 可以通过 Keenan 移动电话的线路相互通信，而 $(1,5),(2,6),(3,6),(2,3)$ 可以通过 Chris 家庭电话的线路相互通信。没有更便宜的方法。\n\n## 数据范围\n\n对于所有的数据，有 $1 \\leq N \\leq 2\\times 10^5，0 \\leq A, B \\leq 2\\times 10^5$，$0 \\leq K \\leq \\frac{N(N-1)}{2}$。\n\n子任务编号|分值|$N$|$A, B$|附加限制\n:-:|:-:|:-:|:-:|:-:\n$1$|$24$|$1 \\leq N \\leq 2000$|$0 \\leq A, B \\leq 2\\times 10^5$|无\n$2$|$20$|$1 \\leq N \\leq 2\\times 10^5$|$1 \\leq N \\leq 2\\times 10^5$|Keenan 移动电话只连接编号为奇数的住户；Chris 家庭电话只连接编号为偶数的住户\n$3$|$24$|$1 \\leq N \\leq 2\\times 10^5$|$0 \\leq A \\leq 10$|无\n$4$|$32$|$1 \\leq N \\leq 2\\times 10^5$|$0 \\leq A, B \\leq 2\\times 10^5$|无", "locale": "zh-CN"}}}
{"pid": "P10055", "type": "P", "difficulty": 7, "samples": [["9\nABAABBBAA", "4\n6 2\n3 2\n2 2\n1 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000]}, "tags": ["2022", "Special Judge", "CCO（加拿大）"], "title": "[CCO 2022] Good Game", "background": "", "description": "Finn 正在玩一个叫做 Twos and Threes 的游戏。Twos and Threes 是一个单人游戏，它在一维棋盘上进行。在初始位置，有 $N$ 个方块排成一行，每个方块标有 $\\tt{A}$ 或 $\\tt{B}$。方块从左到右编号为 $1$ 到 $N$。Finn 可以进行以下操作：\n\n- 选择 $2$ 或 $3$ 个连续的方块，它们有相同的标签，将它们从棋盘上移除并将剩余的方块连接起来，从左到右重新编号方块。\n\n如果棋盘上的所有方块都被移除，Finn 就赢得了游戏。你的任务是帮助 Finn 确定一个赢得游戏的操作序列，或者确定游戏无法获胜。", "inputFormat": "第一行包含一个整数 $N$。\n\n第二行包含一个字符串 $S$，表示游戏开始时的标签。$S$ 中有 $N$ 个字符，$S$ 中的每个字符都是 $\\tt{A}$ 或 $\\tt{B}$。", "outputFormat": "如果存在赢得游戏的操作序列，第一行输出 $K$，即移动序列中的移动次数。在接下来的 $K$ 行中，输出两个空格分隔的整数 $i,j$ 表示移除位于 $[i,i+j-1]$ 的方块的一次操作。\n\n如果没有赢得游戏的操作序列，输出 $-1$。\n\n如果有多个赢得游戏的操作序列，你可以输出任何一个。", "hint": "## 样例解释\n\n操作如下：\n$$ \n\\begin{aligned}\n&\\tt{ABAAB\\underline{BB}AA}\\\\\n&\\tt{AB\\underline{AA}BAA}\\\\\n&\\tt{A\\underline{BB}AA}\\\\\n&\\tt{\\underline{AAA}}\\\\\n\\end{aligned}\n$$\n\n## 数据范围\n\n对于所有的数据，有 $1 \\leq N \\leq 10^{6}$。\n\n子任务编号|分值|$N$ 的范围\n:-:|:-:|:-:\n$1$|$12$|$1 \\leq N \\leq 15$\n$2$|$24$|$1 \\leq N \\leq 300$\n$3$|$28$|$1 \\leq N \\leq 6000$\n$4$|$36$|$1 \\leq N \\leq 10^6$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCO 2022] Good Game", "background": "", "description": "Finn 正在玩一个叫做 Twos and Threes 的游戏。Twos and Threes 是一个单人游戏，它在一维棋盘上进行。在初始位置，有 $N$ 个方块排成一行，每个方块标有 $\\tt{A}$ 或 $\\tt{B}$。方块从左到右编号为 $1$ 到 $N$。Finn 可以进行以下操作：\n\n- 选择 $2$ 或 $3$ 个连续的方块，它们有相同的标签，将它们从棋盘上移除并将剩余的方块连接起来，从左到右重新编号方块。\n\n如果棋盘上的所有方块都被移除，Finn 就赢得了游戏。你的任务是帮助 Finn 确定一个赢得游戏的操作序列，或者确定游戏无法获胜。", "inputFormat": "第一行包含一个整数 $N$。\n\n第二行包含一个字符串 $S$，表示游戏开始时的标签。$S$ 中有 $N$ 个字符，$S$ 中的每个字符都是 $\\tt{A}$ 或 $\\tt{B}$。", "outputFormat": "如果存在赢得游戏的操作序列，第一行输出 $K$，即移动序列中的移动次数。在接下来的 $K$ 行中，输出两个空格分隔的整数 $i,j$ 表示移除位于 $[i,i+j-1]$ 的方块的一次操作。\n\n如果没有赢得游戏的操作序列，输出 $-1$。\n\n如果有多个赢得游戏的操作序列，你可以输出任何一个。", "hint": "## 样例解释\n\n操作如下：\n$$ \n\\begin{aligned}\n&\\tt{ABAAB\\underline{BB}AA}\\\\\n&\\tt{AB\\underline{AA}BAA}\\\\\n&\\tt{A\\underline{BB}AA}\\\\\n&\\tt{\\underline{AAA}}\\\\\n\\end{aligned}\n$$\n\n## 数据范围\n\n对于所有的数据，有 $1 \\leq N \\leq 10^{6}$。\n\n子任务编号|分值|$N$ 的范围\n:-:|:-:|:-:\n$1$|$12$|$1 \\leq N \\leq 15$\n$2$|$24$|$1 \\leq N \\leq 300$\n$3$|$28$|$1 \\leq N \\leq 6000$\n$4$|$36$|$1 \\leq N \\leq 10^6$", "locale": "zh-CN"}}}
{"pid": "P10056", "type": "P", "difficulty": 1, "samples": [["5 2 2 ", "4"], ["11 5 7 ", "10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "洛谷原创", "O2优化", "洛谷月赛"], "title": "Water", "background": "", "description": "有 $n$ 个杯子，每个杯子的容积是 $a$，且初始装有 $b$ 体积水。\n你可以进行任意次操作，每次操作选择任意两个杯子，将其中一个杯子内的水**全部倒入**另一个杯子中，但是过程中**杯子里的水不能溢出（即不能超过其容积）**，如果不满足则无法进行该操作。\n\n请通过合法的操作，最大化装有最多水的杯子里水的体积。", "inputFormat": "一行三个整数，表示 $a,b,n$。", "outputFormat": "一行一个整数 $x$，表示最多水的杯子内的水的体积。", "hint": "#### 【样例 1 解释】\n\n假设现在有两个杯子 $A,B$，可以先把 $A$ 中的全部水倒入 $B$ 中，此时 $A$ 有 $0$ 升水，$B$ 有 $4$ 升水，结束操作。此时最多水杯子内水的数量为 $4$。\n\n#### 【数据规模与约定】\n\n| 测试点编号 | $n\\le$ | 特殊性质 |\n| :----------: | :----------: | :----------: |\n| $1\\sim2$ | $10^5$ | 保证无论如何操作都不会溢出 |\n| $3 \\sim 6$ | $10^6$ | 无 |\n| $7 \\sim 10$ | $10^9$ | 无 |\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^9$，$1\\le a\\le 10^{18}$，$1\\le b\\le \\min(a,10^9)$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "Water", "background": "", "description": "有 $n$ 个杯子，每个杯子的容积是 $a$，且初始装有 $b$ 体积水。\n你可以进行任意次操作，每次操作选择任意两个杯子，将其中一个杯子内的水**全部倒入**另一个杯子中，但是过程中**杯子里的水不能溢出（即不能超过其容积）**，如果不满足则无法进行该操作。\n\n请通过合法的操作，最大化装有最多水的杯子里水的体积。", "inputFormat": "一行三个整数，表示 $a,b,n$。", "outputFormat": "一行一个整数 $x$，表示最多水的杯子内的水的体积。", "hint": "#### 【样例 1 解释】\n\n假设现在有两个杯子 $A,B$，可以先把 $A$ 中的全部水倒入 $B$ 中，此时 $A$ 有 $0$ 升水，$B$ 有 $4$ 升水，结束操作。此时最多水杯子内水的数量为 $4$。\n\n#### 【数据规模与约定】\n\n| 测试点编号 | $n\\le$ | 特殊性质 |\n| :----------: | :----------: | :----------: |\n| $1\\sim2$ | $10^5$ | 保证无论如何操作都不会溢出 |\n| $3 \\sim 6$ | $10^6$ | 无 |\n| $7 \\sim 10$ | $10^9$ | 无 |\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^9$，$1\\le a\\le 10^{18}$，$1\\le b\\le \\min(a,10^9)$。\n", "locale": "zh-CN"}}}
{"pid": "P10057", "type": "P", "difficulty": 1, "samples": [["3\n1 1 2 1 1 1 1 2\n1 1 2 1 1 2 1 3\n2 1 3 1 1 2 1 3", "0\n1\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["洛谷原创", "O2优化", "洛谷月赛"], "title": "Line", "background": "", "description": "在一个二维平面内，给定两条**分别与 $x$ 轴和 $y$ 轴平行**的线段 $AB$ 和 $CD$。\n\n你可以选择一条线段，将其沿着平行于坐标轴（上下左右）的任意一个方向平移**任意单位长度**，称为一次操作。\n\n问至少进行几次操作可以使两条线段相交？", "inputFormat": "**本题有多组测试数据。**\n\n第一行一个整数 $T$，表示测试数据组数。\n\n对于每组测试数据：\n\n- 一行八个正整数 $x_A,y_A,x_B,y_B,x_C,y_C,x_D,y_D$，表示 $A,B,C,D$ 的坐标。", "outputFormat": "对于每组测试数据：\n\n- 一行一个整数表示最少操作次数。", "hint": "**【样例 1 解释】**\n\n- 对于第一组数据，两条线段已经相交，不需要进行任何操作；\n- 对于第二组数据，一种可行的方案为：将线段 $AB$ 向上平移一个单位；\n- 对于第三组数据，一种可行的方案为：将线段 $AB$ 向上平移一个单位，再将线段 $CD$ 向右平移一个单位。\n\n**【数据规模与约定】**\n\n记 $M=\\max(x_A,y_A,x_B,y_B,x_C,y_C,x_D,y_D)$。\n\n| 测试点编号 | $T\\le$ | $M\\le$ | 特殊性质 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $10$ | $10$ | 无 |\n| $2\\sim 3$ | $10$ | $50$ | 无 |\n| $4\\sim 5$ | $10$ | $10^3$ | 无 |\n| $6\\sim 7$ | $10^5$ | $10^9$ | 保证答案不超过 $1$ |\n| $8\\sim 10$ | $10^5$ | $10^{9}$ | 无 |\n\n对于 $100\\%$ 的数据，$1\\le T\\le 10^5$，$1\\le M\\le 10^{9}$，$x_A<x_B$，$x_C=x_D$，$y_A=y_B$，$y_C<y_D$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "Line", "background": "", "description": "在一个二维平面内，给定两条**分别与 $x$ 轴和 $y$ 轴平行**的线段 $AB$ 和 $CD$。\n\n你可以选择一条线段，将其沿着平行于坐标轴（上下左右）的任意一个方向平移**任意单位长度**，称为一次操作。\n\n问至少进行几次操作可以使两条线段相交？", "inputFormat": "**本题有多组测试数据。**\n\n第一行一个整数 $T$，表示测试数据组数。\n\n对于每组测试数据：\n\n- 一行八个正整数 $x_A,y_A,x_B,y_B,x_C,y_C,x_D,y_D$，表示 $A,B,C,D$ 的坐标。", "outputFormat": "对于每组测试数据：\n\n- 一行一个整数表示最少操作次数。", "hint": "**【样例 1 解释】**\n\n- 对于第一组数据，两条线段已经相交，不需要进行任何操作；\n- 对于第二组数据，一种可行的方案为：将线段 $AB$ 向上平移一个单位；\n- 对于第三组数据，一种可行的方案为：将线段 $AB$ 向上平移一个单位，再将线段 $CD$ 向右平移一个单位。\n\n**【数据规模与约定】**\n\n记 $M=\\max(x_A,y_A,x_B,y_B,x_C,y_C,x_D,y_D)$。\n\n| 测试点编号 | $T\\le$ | $M\\le$ | 特殊性质 |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $10$ | $10$ | 无 |\n| $2\\sim 3$ | $10$ | $50$ | 无 |\n| $4\\sim 5$ | $10$ | $10^3$ | 无 |\n| $6\\sim 7$ | $10^5$ | $10^9$ | 保证答案不超过 $1$ |\n| $8\\sim 10$ | $10^5$ | $10^{9}$ | 无 |\n\n对于 $100\\%$ 的数据，$1\\le T\\le 10^5$，$1\\le M\\le 10^{9}$，$x_A<x_B$，$x_C=x_D$，$y_A=y_B$，$y_C<y_D$。", "locale": "zh-CN"}}}
{"pid": "P10058", "type": "P", "difficulty": 3, "samples": [["abcde\n3\n> 2\nrev\n< 2", "aedcb"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "O2优化", "洛谷月赛"], "title": "Reverse and Rotate", "background": "", "description": "给定一个字符串 $S$ 和 $n$ 次操作，每次操作为以下 $3$ 种形式之一：\n\n1. `< x` 表示将 $S$ 向左循环移动 $x$ 位。例如：$\\mathtt{abcde}$ 执行 `< 2` 后变成 $\\mathtt{cdeab}$。\n\n2. `> x` 表示将 $S$ 向右循环移动 $x$ 位。例如：$\\mathtt{abcde}$ 执行 `> 2` 后变成 $\\mathtt{deabc}$。\n\n3. `rev` 表示将 $S$ 翻转。例如：$\\mathtt{abcde}$ 执行 `rev` 后变成 $\\mathtt{edcba}$。\n\n求 $S$ 在**依次**执行这 $n$ 次操作后得到的字符串 $S'$。\n\n注：对于 $S=s_0s_1\\cdots s_{k-1}$，将其向左循环移动 $x$ 位，会变成 $s_{-x}S_{-x+1}\\cdots S_{-x+k-1}$；向右循环移动 $x$ 位，会变成 $s_{x}S_{x+1}\\cdots S_{x+k-1}$。对于 $x\\equiv y\\pmod k$，有 $s_x=s_y$。", "inputFormat": "第一行一个字符串 $S$。\n\n第二行一个整数 $n$。\n\n接下来 $n$ 行，每行一个操作。", "outputFormat": "一行一个字符串 $S'$，表示**依次**执行 $n$ 次操作后得到的字符串。", "hint": "**【样例 1 解释】**\n\n- 原字符串为 $\\mathtt{abcde}$；\n- 第一次操作后，字符串变为 $\\mathtt{deabc}$；\n- 第二次操作后，字符串变为 $\\mathtt{cbaed}$；\n- 第三次操作后，字符串变为 $\\mathtt{aedcb}$。\n\n**【数据规模与约定】**\n\n记 $|S|$ 表示字符串 $S$ 的长度。\n\n| 测试点编号 | 特殊性质 |\n| :----------: | :----------: |\n| $1\\sim3$ | $\\vert S\\vert,n,x \\le 1000$ |\n| $4$ | 没有 `rev` 操作 |\n| $5$ | $S=\\mathtt{aa...abb...b}$ |\n| $6\\sim10$ | 无 |\n\n对于 $100\\%$ 的数据，$1 \\le |S|,n \\le 10^6$，$0 \\le x \\le 10^9$，$S$ 仅由小写字母组成。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "Reverse and Rotate", "background": "", "description": "给定一个字符串 $S$ 和 $n$ 次操作，每次操作为以下 $3$ 种形式之一：\n\n1. `< x` 表示将 $S$ 向左循环移动 $x$ 位。例如：$\\mathtt{abcde}$ 执行 `< 2` 后变成 $\\mathtt{cdeab}$。\n\n2. `> x` 表示将 $S$ 向右循环移动 $x$ 位。例如：$\\mathtt{abcde}$ 执行 `> 2` 后变成 $\\mathtt{deabc}$。\n\n3. `rev` 表示将 $S$ 翻转。例如：$\\mathtt{abcde}$ 执行 `rev` 后变成 $\\mathtt{edcba}$。\n\n求 $S$ 在**依次**执行这 $n$ 次操作后得到的字符串 $S'$。\n\n注：对于 $S=s_0s_1\\cdots s_{k-1}$，将其向左循环移动 $x$ 位，会变成 $s_{-x}S_{-x+1}\\cdots S_{-x+k-1}$；向右循环移动 $x$ 位，会变成 $s_{x}S_{x+1}\\cdots S_{x+k-1}$。对于 $x\\equiv y\\pmod k$，有 $s_x=s_y$。", "inputFormat": "第一行一个字符串 $S$。\n\n第二行一个整数 $n$。\n\n接下来 $n$ 行，每行一个操作。", "outputFormat": "一行一个字符串 $S'$，表示**依次**执行 $n$ 次操作后得到的字符串。", "hint": "**【样例 1 解释】**\n\n- 原字符串为 $\\mathtt{abcde}$；\n- 第一次操作后，字符串变为 $\\mathtt{deabc}$；\n- 第二次操作后，字符串变为 $\\mathtt{cbaed}$；\n- 第三次操作后，字符串变为 $\\mathtt{aedcb}$。\n\n**【数据规模与约定】**\n\n记 $|S|$ 表示字符串 $S$ 的长度。\n\n| 测试点编号 | 特殊性质 |\n| :----------: | :----------: |\n| $1\\sim3$ | $\\vert S\\vert,n,x \\le 1000$ |\n| $4$ | 没有 `rev` 操作 |\n| $5$ | $S=\\mathtt{aa...abb...b}$ |\n| $6\\sim10$ | 无 |\n\n对于 $100\\%$ 的数据，$1 \\le |S|,n \\le 10^6$，$0 \\le x \\le 10^9$，$S$ 仅由小写字母组成。", "locale": "zh-CN"}}}
{"pid": "P10059", "type": "P", "difficulty": 4, "samples": [["3\n5 1\n1 2 3 4 5\n5 2\n1 2 3 4 5\n5 3\n1 2 3 4 5", "4 5\n3 4\n2 3"], ["2\n5 1\n1 2 2 2 3\n5 2\n1 2 2 2 3", "2 5\n1 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "二分", "单调队列", "洛谷原创", "O2优化", "前缀和", "ST 表", "洛谷月赛"], "title": "Choose", "background": "[加强版](https://www.luogu.com.cn/problem/U397746)\n\n对于一个长度为 $n$ 的序列 $a$ ，定义 $a$ 的极差表示 $a$ 中最大值与最小值之差；定义 $C(a,l,r)$ 表示 $a$ 的**连续**子序列 $[a_l,a_{l+1},\\dots,a_r]$，其中 $1\\le l\\le r\\le n$。", "description": "给定一个长度为 $n$ 的序列 $a$。\n\n你需要选出 $a$ 的 $k$ 个长度均为 $L$ $(1\\le L\\le n-k+1)$ 的不同**连续**子序列 \n$C(a,l_1,l_1+L-1),C(a,l_2,l_2+L-1),\\dots,C(a,l_k,l_k+L-1)$，其中 $1\\le l_1<l_2< \\dots< l_k\\le n-L+1$。\n\n记这 $k$ 个子序列中极差的最小值为 $X$，你需要求出 $X$ 的最大值。同时，你还需要求出，在满足 $X$ 最大的情况下  $L$ 的最小值。", "inputFormat": "**本题有多组测试数据。**\n\n第一行一个整数 $T$，表示测试数据组数。\n\n对于每组测试数据：\n\n- 第一行两个整数 $n,k$。\n- 第二行 $n$ 个整数 $a_1,a_2,...,a_n$。", "outputFormat": "对于每组测试数据：\n\n- 一行两个整数 $X,L$，表示所求极差和子序列长度。", "hint": "**【样例 1 解释】**\n\n- $k=1$ 时，极差最大不超过 $4$，此时满足长度最短的一种方案为 $[1,2,3,4,5]$。\n- $k=2$ 时，极差最大不超过 $3$，此时满足长度最短的一种方案为 $[1,2,3,4],[2,3,4,5]$。\n- $k=3$ 时，极差最大不超过 $2$，此时满足长度最短的一种方案为 $[1,2,3],[2,3,4],[3,4,5]$。\n\n**【数据规模与约定】**\n\n**本题采用捆绑测试。**\n\n| 子任务 | 分值 | $n\\le$ | $k\\le$ | 特殊性质 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $5$ | $10^5$ | $n$ | $a_i$ 均相等 |\n| $2$ | $5$ | $10^5$ | $1$ | 数据随机生成 |\n| $3$ | $10$ | $100$ | $n$ | 所求的 $X$ 不超过 $10^3$ |\n| $4$ | $20$ | $100$ | $n$ | 无 |\n| $5$ | $20$ | $10^4$ | $n$ | 无 |\n| $6$ | $40$ | $10^5$ | $n$ | 无 |\n\n对于 $100\\%$ 的数据，$1\\le T\\le 10$，$1\\le n\\le 10^5$，$1\\le k\\le n$，$-10^9\\le a_i\\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "Choose", "background": "[加强版](https://www.luogu.com.cn/problem/U397746)\n\n对于一个长度为 $n$ 的序列 $a$ ，定义 $a$ 的极差表示 $a$ 中最大值与最小值之差；定义 $C(a,l,r)$ 表示 $a$ 的**连续**子序列 $[a_l,a_{l+1},\\dots,a_r]$，其中 $1\\le l\\le r\\le n$。", "description": "给定一个长度为 $n$ 的序列 $a$。\n\n你需要选出 $a$ 的 $k$ 个长度均为 $L$ $(1\\le L\\le n-k+1)$ 的不同**连续**子序列 \n$C(a,l_1,l_1+L-1),C(a,l_2,l_2+L-1),\\dots,C(a,l_k,l_k+L-1)$，其中 $1\\le l_1<l_2< \\dots< l_k\\le n-L+1$。\n\n记这 $k$ 个子序列中极差的最小值为 $X$，你需要求出 $X$ 的最大值。同时，你还需要求出，在满足 $X$ 最大的情况下  $L$ 的最小值。", "inputFormat": "**本题有多组测试数据。**\n\n第一行一个整数 $T$，表示测试数据组数。\n\n对于每组测试数据：\n\n- 第一行两个整数 $n,k$。\n- 第二行 $n$ 个整数 $a_1,a_2,...,a_n$。", "outputFormat": "对于每组测试数据：\n\n- 一行两个整数 $X,L$，表示所求极差和子序列长度。", "hint": "**【样例 1 解释】**\n\n- $k=1$ 时，极差最大不超过 $4$，此时满足长度最短的一种方案为 $[1,2,3,4,5]$。\n- $k=2$ 时，极差最大不超过 $3$，此时满足长度最短的一种方案为 $[1,2,3,4],[2,3,4,5]$。\n- $k=3$ 时，极差最大不超过 $2$，此时满足长度最短的一种方案为 $[1,2,3],[2,3,4],[3,4,5]$。\n\n**【数据规模与约定】**\n\n**本题采用捆绑测试。**\n\n| 子任务 | 分值 | $n\\le$ | $k\\le$ | 特殊性质 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $5$ | $10^5$ | $n$ | $a_i$ 均相等 |\n| $2$ | $5$ | $10^5$ | $1$ | 数据随机生成 |\n| $3$ | $10$ | $100$ | $n$ | 所求的 $X$ 不超过 $10^3$ |\n| $4$ | $20$ | $100$ | $n$ | 无 |\n| $5$ | $20$ | $10^4$ | $n$ | 无 |\n| $6$ | $40$ | $10^5$ | $n$ | 无 |\n\n对于 $100\\%$ 的数据，$1\\le T\\le 10$，$1\\le n\\le 10^5$，$1\\le k\\le n$，$-10^9\\le a_i\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P10060", "type": "P", "difficulty": 5, "samples": [["3\n3 3\n1 2\n2 3\n1 2 1\n3 2\n1 2\n2 3\n1 2 2\n3 2\n1 2\n2 3\n2 1 1\n", "0\n1\n2\n"], ["1\n10 5\n1 2\n2 3\n3 4\n4 5\n5 6\n6 7\n7 8\n8 9\n9 10\n1 1 2 2 3 3 4 4 5 5\n", "13\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["各省省选", "2024", "O2优化", "陕西"], "title": "[SNOI2024] 树 V 图", "background": "", "description": "你有一棵 $n$ 个点的无根树，节点的编号为 $1, 2, \\ldots, n$。定义树上两点之间的距离 $\\operatorname{dis}(i, j)$ 为树上 $i$ 点到 $j$ 点的简单路径上的边数。\n\n现在有 $k$ 个关键点 $a_1, a_2, \\ldots, a_k$，对于每个点，我们想求出距离它最近的关键点是哪个点。也就是对于一个点 $v$，令 $f(v)$ 表示令 $\\operatorname{dis}(v, a_i)$ 最小的 $i$，如果有多个 $i$ 满足条件，那么我们会选择其中最小的 $i$。\n\n现在，我们给出了 $f(1), f(2), \\ldots, f(n)$，问有多少组可能的 $(a_1, a_2, \\ldots, a_k)$ 满足条件。由于答案可能很大，输出对 $998244353$ 取模的结果。", "inputFormat": "多组测试数据，第一行一个整数 $T$ 表示数据组数。  \n对于每组测试数据，第一行两个整数 $n, k$，表示节点个数和关键点个数。  \n接下来 $n - 1$ 行，每行两个整数 $u, v$，表示一条树边 $(u, v)$。  \n接下来一行，$n$ 个整数，$f(1), f(2), \\ldots, f(n)$。注意：数据**不保证**一定存在一组可能的 $(a_1, a_2, \\ldots, a_k)$。", "outputFormat": "对于每组数据，输出一个整数，表示答案对 $998244353$ 取模的结果。", "hint": "**【样例 \\#1 解释】**\n\n在第一个样例中，对于第二组数据，一个解为 $(1, 2)$。对于第三组数据，两个解为 $(2, 1), (3, 1)$。\n\n注意，当多个点距离相同时，我们选择的是最小的 $i$ 而不是 $a_i$。\n\n---\n\n**【样例 \\#3】**\n\n见附件中 `voronoi/voronoi3.in` 与 `voronoi/voronoi3.ans`，这个样例满足测试点 $3 \\sim 4$ 的条件限制。\n\n---\n\n**【样例 \\#4】**\n\n见附件中 `voronoi/voronoi3.in` 与 `voronoi/voronoi3.ans`，这个样例满足测试点 $7 \\sim 10$ 的条件限制。\n\n---\n\n**【数据范围】**\n\n对于所有的数据，保证 $1 \\le T \\le 10$，$2 \\le k \\le n \\le 3 \\times {10}^3$，$1 \\le f(i) \\le k$。\n\n具体如下：\n\n| 测试点编号 | $n \\le$ | 特殊性质 |\n|:-:|:-:|:-:|\n| $1 \\sim 2$ | $15$ | 无 |\n| $3 \\sim 4$ | $3000$ | A |\n| $5 \\sim 6$ | $3000$ | B |\n| $7 \\sim 10$ | $3000$ | 无 |\n\n特殊性质 A：保证树是一条链。  \n特殊性质 B：保证 $k = 2$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[SNOI2024] 树 V 图", "background": "", "description": "你有一棵 $n$ 个点的无根树，节点的编号为 $1, 2, \\ldots, n$。定义树上两点之间的距离 $\\operatorname{dis}(i, j)$ 为树上 $i$ 点到 $j$ 点的简单路径上的边数。\n\n现在有 $k$ 个关键点 $a_1, a_2, \\ldots, a_k$，对于每个点，我们想求出距离它最近的关键点是哪个点。也就是对于一个点 $v$，令 $f(v)$ 表示令 $\\operatorname{dis}(v, a_i)$ 最小的 $i$，如果有多个 $i$ 满足条件，那么我们会选择其中最小的 $i$。\n\n现在，我们给出了 $f(1), f(2), \\ldots, f(n)$，问有多少组可能的 $(a_1, a_2, \\ldots, a_k)$ 满足条件。由于答案可能很大，输出对 $998244353$ 取模的结果。", "inputFormat": "多组测试数据，第一行一个整数 $T$ 表示数据组数。  \n对于每组测试数据，第一行两个整数 $n, k$，表示节点个数和关键点个数。  \n接下来 $n - 1$ 行，每行两个整数 $u, v$，表示一条树边 $(u, v)$。  \n接下来一行，$n$ 个整数，$f(1), f(2), \\ldots, f(n)$。注意：数据**不保证**一定存在一组可能的 $(a_1, a_2, \\ldots, a_k)$。", "outputFormat": "对于每组数据，输出一个整数，表示答案对 $998244353$ 取模的结果。", "hint": "**【样例 \\#1 解释】**\n\n在第一个样例中，对于第二组数据，一个解为 $(1, 2)$。对于第三组数据，两个解为 $(2, 1), (3, 1)$。\n\n注意，当多个点距离相同时，我们选择的是最小的 $i$ 而不是 $a_i$。\n\n---\n\n**【样例 \\#3】**\n\n见附件中 `voronoi/voronoi3.in` 与 `voronoi/voronoi3.ans`，这个样例满足测试点 $3 \\sim 4$ 的条件限制。\n\n---\n\n**【样例 \\#4】**\n\n见附件中 `voronoi/voronoi3.in` 与 `voronoi/voronoi3.ans`，这个样例满足测试点 $7 \\sim 10$ 的条件限制。\n\n---\n\n**【数据范围】**\n\n对于所有的数据，保证 $1 \\le T \\le 10$，$2 \\le k \\le n \\le 3 \\times {10}^3$，$1 \\le f(i) \\le k$。\n\n具体如下：\n\n| 测试点编号 | $n \\le$ | 特殊性质 |\n|:-:|:-:|:-:|\n| $1 \\sim 2$ | $15$ | 无 |\n| $3 \\sim 4$ | $3000$ | A |\n| $5 \\sim 6$ | $3000$ | B |\n| $7 \\sim 10$ | $3000$ | 无 |\n\n特殊性质 A：保证树是一条链。  \n特殊性质 B：保证 $k = 2$。", "locale": "zh-CN"}}}
{"pid": "P10061", "type": "P", "difficulty": 6, "samples": [["4 4\n1 1 2 3 4\n2 2 1 4 2 3\n1 2 1 3 2\n2 1 1 1 4 5\n", "984660761\n"], ["10 10\n2 5 1 10 4 689412516\n1 3 4 3 4\n1 3 5 4 6\n1 4 1 8 5\n1 1 2 1 2\n1 4 2 7 5\n1 2 5 2 5\n2 3 3 3 9 856075030\n2 4 2 5 6 308750020\n2 1 5 9 7 252732904\n", "94292030\n"]], "limits": {"time": [8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000, 8000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["各省省选", "2024", "O2优化", "陕西"], "title": "[SNOI2024] 矩阵", "background": "", "description": "你要维护一个 $n \\times n$ 的矩阵 $A$，其中第 $i$ 行第 $j$ 列的元素记作 $A_{i, j}$。行和列从 $1$ 开始标号。一开始，有 $A_{i, j} = (i + 1)^j \\bmod 998244353$。\n\n你需要支持 $q$ 个操作，每个操作是下面两种操作中的一种。\n\n- $1\\ x_1\\ y_1\\ x_2\\ y_2$，这里保证 $y_2 - x_2 = y_1 - x_1$。将子矩形 $[x_1, x_2] \\times [y_1, y_2]$ 逆时针旋转 $90$ 度。\n  - 具体地，令 $d = x_2 - x_1 + 1$。\n  - 首先提取 $d \\times d$ 的子矩阵 $A'$，对于所有的 $i, j$（$1 \\le i, j \\le d$），令 $A'_{i, j} \\gets A_{x_1 + i - 1, y_1 + j - 1}$。\n  - 然后将 $A'$ 旋转，得到一个 $d \\times d$ 的子矩阵 $B'$，令 $B'_{i, j} \\gets A'_{j, d - i + 1}$。\n  - 然后将 $B'$ 填回到 $A$ 中，对所有的 $i, j$（$1 \\le i, j \\le d$），令 $A_{i + x_1 - 1, j + y_1 - 1} \\gets B'_{i, j}$。\n- $2\\ x_1\\ y_1\\ x_2\\ y_2\\ d$。将子矩形 $[x_1, x_2] \\times [y_1, y_2]$ 内所有的元素加 $d$。\n  - 具体地，对于每个 $i$（$x_1 \\le i \\le x_2$）、$j$（$y_1 \\le j \\le y_2$），令 $A_{i, j} \\gets A_{i, j} + d$。\n\n你需要在所有操作结束之后，输出这个矩阵。由于输出可能很大，请输出\n$$ \\Biggl( \\sum_{i = 1}^{n} \\sum_{j = 1}^{n} A_{i, j} \\times {12345}^{(i - 1) n + j} \\Biggr) \\bmod 1000000007 $$\n的结果。", "inputFormat": "第一行两个整数 $n, q$ 表示矩阵大小和操作个数。  \n接下来 $q$ 行，每行若干个数，表示上面的某种操作。", "outputFormat": "输出一个整数，表示答案对 $1000000007$ 取模的结果。", "hint": "**【样例 \\#1 解释】**\n\n对于第一个样例，矩阵分别为\n$$\\begin{bmatrix} 2 & {\\textcolor{red}{4}} & {\\textcolor{red}{8}} & {\\textcolor{red}{16}} \\\\ 3 & {\\textcolor{red}{9}} & {\\textcolor{red}{27}} & {\\textcolor{red}{81}} \\\\ 4 & {\\textcolor{red}{16}} & {\\textcolor{red}{64}} & {\\textcolor{red}{256}} \\\\ 5 & 25 & 125 & 625 \\end{bmatrix} \\to \\begin{bmatrix} 2 & 16 & 81 & 256 \\\\ {\\textcolor{blue}{3}} & {\\textcolor{blue}{8}} & 27 & 64 \\\\ {\\textcolor{blue}{4}} & {\\textcolor{blue}{4}} & 9 & 16 \\\\ {\\textcolor{blue}{5}} & {\\textcolor{blue}{25}} & 125 & 625 \\end{bmatrix} \\to \\begin{bmatrix} 2 & 16 & 81 & 256 \\\\ {\\textcolor{red}{6}} & {\\textcolor{red}{11}} & 27 & 64 \\\\ {\\textcolor{red}{7}} & {\\textcolor{red}{7}} & 9 & 16 \\\\ 8 & 28 & 125 & 625 \\end{bmatrix}$$\n$$\\to \\begin{bmatrix} {\\textcolor{blue}{2}} & {\\textcolor{blue}{16}} & {\\textcolor{blue}{81}} & {\\textcolor{blue}{256}} \\\\ 11 & 7 & 27 & 64 \\\\ 6 & 7 & 9 & 16 \\\\ 8 & 28 & 125 & 625 \\end{bmatrix} \\to \\begin{bmatrix} 7 & 21 & 86 & 261 \\\\ 11 & 7 & 27 & 64 \\\\ 6 & 7 & 9 & 16 \\\\ 8 & 28 & 125 & 625 \\end{bmatrix}$$\n其中每个旋转操作对应的数字用红色表示，加操作对应的数字用蓝色表示。\n\n---\n\n**【样例 \\#3】**\n\n见附件中 `matrix/matrix3.in` 与 `matrix/matrix3.ans`，这个样例满足测试点 $5 \\sim 6$ 的条件限制。\n\n---\n\n**【样例 \\#4】**\n\n见附件中 `matrix/matrix3.in` 与 `matrix/matrix3.ans`，这个样例满足测试点 $9 \\sim 10$ 的条件限制。\n\n---\n\n**【数据范围】**\n\n对于所有的数据，保证 $1 \\le n \\le 3000$，$1 \\le q \\le 3000$。  \n对于每个操作，保证 $1 \\le x_1 \\le x_2 \\le n$，$1 \\le y_1 \\le y_2 \\le n$，$1 \\le d \\le {10}^9$。\n\n具体如下：\n\n| 测试点编号 | $n \\le$ | $q \\le$ | 特殊性质 |\n|:-:|:-:|:-:|:-:|\n| $1$ | $100$ | $3000$ | 无 |\n| $2$ | $3000$ | $3000$ | A |\n| $3 \\sim 4$ | $3000$ | $2000$ | B |\n| $5 \\sim 6$ | $3000$ | $3000$ | B |\n| $7 \\sim 8$ | $3000$ | $2000$ | 无 |\n| $9 \\sim 10$ | $3000$ | $3000$ | 无 |\n\n特殊性质 A：保证没有第一类旋转操作。  \n特殊性质 B：保证没有第二类加法操作。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[SNOI2024] 矩阵", "background": "", "description": "你要维护一个 $n \\times n$ 的矩阵 $A$，其中第 $i$ 行第 $j$ 列的元素记作 $A_{i, j}$。行和列从 $1$ 开始标号。一开始，有 $A_{i, j} = (i + 1)^j \\bmod 998244353$。\n\n你需要支持 $q$ 个操作，每个操作是下面两种操作中的一种。\n\n- $1\\ x_1\\ y_1\\ x_2\\ y_2$，这里保证 $y_2 - x_2 = y_1 - x_1$。将子矩形 $[x_1, x_2] \\times [y_1, y_2]$ 逆时针旋转 $90$ 度。\n  - 具体地，令 $d = x_2 - x_1 + 1$。\n  - 首先提取 $d \\times d$ 的子矩阵 $A'$，对于所有的 $i, j$（$1 \\le i, j \\le d$），令 $A'_{i, j} \\gets A_{x_1 + i - 1, y_1 + j - 1}$。\n  - 然后将 $A'$ 旋转，得到一个 $d \\times d$ 的子矩阵 $B'$，令 $B'_{i, j} \\gets A'_{j, d - i + 1}$。\n  - 然后将 $B'$ 填回到 $A$ 中，对所有的 $i, j$（$1 \\le i, j \\le d$），令 $A_{i + x_1 - 1, j + y_1 - 1} \\gets B'_{i, j}$。\n- $2\\ x_1\\ y_1\\ x_2\\ y_2\\ d$。将子矩形 $[x_1, x_2] \\times [y_1, y_2]$ 内所有的元素加 $d$。\n  - 具体地，对于每个 $i$（$x_1 \\le i \\le x_2$）、$j$（$y_1 \\le j \\le y_2$），令 $A_{i, j} \\gets A_{i, j} + d$。\n\n你需要在所有操作结束之后，输出这个矩阵。由于输出可能很大，请输出\n$$ \\Biggl( \\sum_{i = 1}^{n} \\sum_{j = 1}^{n} A_{i, j} \\times {12345}^{(i - 1) n + j} \\Biggr) \\bmod 1000000007 $$\n的结果。", "inputFormat": "第一行两个整数 $n, q$ 表示矩阵大小和操作个数。  \n接下来 $q$ 行，每行若干个数，表示上面的某种操作。", "outputFormat": "输出一个整数，表示答案对 $1000000007$ 取模的结果。", "hint": "**【样例 \\#1 解释】**\n\n对于第一个样例，矩阵分别为\n$$\\begin{bmatrix} 2 & {\\textcolor{red}{4}} & {\\textcolor{red}{8}} & {\\textcolor{red}{16}} \\\\ 3 & {\\textcolor{red}{9}} & {\\textcolor{red}{27}} & {\\textcolor{red}{81}} \\\\ 4 & {\\textcolor{red}{16}} & {\\textcolor{red}{64}} & {\\textcolor{red}{256}} \\\\ 5 & 25 & 125 & 625 \\end{bmatrix} \\to \\begin{bmatrix} 2 & 16 & 81 & 256 \\\\ {\\textcolor{blue}{3}} & {\\textcolor{blue}{8}} & 27 & 64 \\\\ {\\textcolor{blue}{4}} & {\\textcolor{blue}{4}} & 9 & 16 \\\\ {\\textcolor{blue}{5}} & {\\textcolor{blue}{25}} & 125 & 625 \\end{bmatrix} \\to \\begin{bmatrix} 2 & 16 & 81 & 256 \\\\ {\\textcolor{red}{6}} & {\\textcolor{red}{11}} & 27 & 64 \\\\ {\\textcolor{red}{7}} & {\\textcolor{red}{7}} & 9 & 16 \\\\ 8 & 28 & 125 & 625 \\end{bmatrix}$$\n$$\\to \\begin{bmatrix} {\\textcolor{blue}{2}} & {\\textcolor{blue}{16}} & {\\textcolor{blue}{81}} & {\\textcolor{blue}{256}} \\\\ 11 & 7 & 27 & 64 \\\\ 6 & 7 & 9 & 16 \\\\ 8 & 28 & 125 & 625 \\end{bmatrix} \\to \\begin{bmatrix} 7 & 21 & 86 & 261 \\\\ 11 & 7 & 27 & 64 \\\\ 6 & 7 & 9 & 16 \\\\ 8 & 28 & 125 & 625 \\end{bmatrix}$$\n其中每个旋转操作对应的数字用红色表示，加操作对应的数字用蓝色表示。\n\n---\n\n**【样例 \\#3】**\n\n见附件中 `matrix/matrix3.in` 与 `matrix/matrix3.ans`，这个样例满足测试点 $5 \\sim 6$ 的条件限制。\n\n---\n\n**【样例 \\#4】**\n\n见附件中 `matrix/matrix3.in` 与 `matrix/matrix3.ans`，这个样例满足测试点 $9 \\sim 10$ 的条件限制。\n\n---\n\n**【数据范围】**\n\n对于所有的数据，保证 $1 \\le n \\le 3000$，$1 \\le q \\le 3000$。  \n对于每个操作，保证 $1 \\le x_1 \\le x_2 \\le n$，$1 \\le y_1 \\le y_2 \\le n$，$1 \\le d \\le {10}^9$。\n\n具体如下：\n\n| 测试点编号 | $n \\le$ | $q \\le$ | 特殊性质 |\n|:-:|:-:|:-:|:-:|\n| $1$ | $100$ | $3000$ | 无 |\n| $2$ | $3000$ | $3000$ | A |\n| $3 \\sim 4$ | $3000$ | $2000$ | B |\n| $5 \\sim 6$ | $3000$ | $3000$ | B |\n| $7 \\sim 8$ | $3000$ | $2000$ | 无 |\n| $9 \\sim 10$ | $3000$ | $3000$ | 无 |\n\n特殊性质 A：保证没有第一类旋转操作。  \n特殊性质 B：保证没有第二类加法操作。", "locale": "zh-CN"}}}
{"pid": "P10062", "type": "P", "difficulty": 7, "samples": [["3\n2 1 1\n1\n3 2 2\n1 2\n2 1\n5 2 3\n1 2 3\n4 3 2\n", "Yes\n1 2\n2 1\nNo\nYes\n1 2 3 4 5\n4 3 2 5 1\n2 4 5 1 3\n3 5 1 2 4\n5 1 4 3 2\n"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["各省省选", "2024", "Special Judge", "O2优化", "陕西"], "title": "[SNOI2024] 拉丁方", "background": "", "description": "我们定义一个 $n \\times n$ 的矩阵 $A$ 为拉丁方，当且仅当，每行每列都是一个 $1 \\sim n$ 的排列。\n\n现在给你一个矩阵 $A$ 左上角的一个 $R \\times C$ 的子矩阵，也就是 $A_{i, j}$（$1 \\le i \\le R$，$1 \\le j \\le C$）。问能不能将剩下的位置填上数使得它是一个拉丁方。", "inputFormat": "多组测试数据，第一行一个整数 $T$ 表示测试数据组数。  \n对于每组测试数据，第一行三个整数 $n, R, C$ 表示矩阵大小和已知的矩阵大小。  \n接下来 $R$ 行，每行 $C$ 个数，其中第 $i$ 行的第 $j$ 个数表示 $A_{i, j}$。", "outputFormat": "对于每组数据，第一行输出一个字符串 `Yes` 或者 `No`，表示能否找到满足条件的拉丁方。  \n如果能找到满足条件的拉丁方，那么在接下来 $n$ 行，每行输出 $n$ 个数，表示一个满足条件的拉丁方。如果有多组满足条件的方案，输出任意一种即可。", "hint": "**【样例 \\#1 解释】**\n\n在第一个样例中，对于第二组数据，根据前两行可以发现，$A_{1, 3} = A_{2, 3} = 3$，所以不存在满足条件的拉丁方。\n\n对于第三组数据，可以发现输出是一个满足条件的拉丁方，并且左上角是输入的矩阵。下面也是一个满足条件的方案。\n$$\\begin{bmatrix} 1 & 2 & 3 & 5 & 4 \\\\ 4 & 3 & 2 & 1 & 5 \\\\ 3 & 5 & 1 & 4 & 2 \\\\ 2 & 4 & 5 & 3 & 1 \\\\ 5 & 1 & 4 & 2 & 3 \\end{bmatrix}$$\n\n---\n\n**【样例 \\#2】**\n\n见附件中 `latin/latin2.in` 与 `latin/latin2.ans`，这个样例满足测试点 $6 \\sim 7$ 的条件限制。\n\n---\n\n**【样例 \\#3】**\n\n见附件中 `latin/latin3.in` 与 `latin/latin3.ans`，这个样例满足测试点 $11 \\sim 12$ 的条件限制。\n\n---\n\n**【数据范围】**\n\n对于所有的数据，保证 $1 \\le T \\le 10$，$1 \\le n \\le 500$，$1 \\le R, C \\le n$，$1 \\le A_{i, j} \\le n$，保证输入的子矩阵不存在一行或者一列有两个相同的数。\n\n具体如下：\n\n| 测试点编号 | $n \\le$ | 特殊性质 |\n|:-:|:-:|:-:|\n| $1 \\sim 2$ | $6$ | 无 |\n| $3 \\sim 4$ | $10$ | 无 |\n| $5$ | $500$ | A |\n| $6 \\sim 7$ | $100$ | B |\n| $8 \\sim 9$ | $300$ | B |\n| $10$ | $500$ | B |\n| $11 \\sim 12$ | $500$ | C |\n| $13 \\sim 14$ | $100$ | 无 |\n| $15 \\sim 16$ | $300$ | 无 |\n| $17 \\sim 20$ | $500$ | 无 |\n\n特殊性质 A：保证 $R = 1$。  \n特殊性质 B：保证 $C = n$。  \n特殊性质 C：保证 $R, C \\le \\frac{n}{2}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[SNOI2024] 拉丁方", "background": "", "description": "我们定义一个 $n \\times n$ 的矩阵 $A$ 为拉丁方，当且仅当，每行每列都是一个 $1 \\sim n$ 的排列。\n\n现在给你一个矩阵 $A$ 左上角的一个 $R \\times C$ 的子矩阵，也就是 $A_{i, j}$（$1 \\le i \\le R$，$1 \\le j \\le C$）。问能不能将剩下的位置填上数使得它是一个拉丁方。", "inputFormat": "多组测试数据，第一行一个整数 $T$ 表示测试数据组数。  \n对于每组测试数据，第一行三个整数 $n, R, C$ 表示矩阵大小和已知的矩阵大小。  \n接下来 $R$ 行，每行 $C$ 个数，其中第 $i$ 行的第 $j$ 个数表示 $A_{i, j}$。", "outputFormat": "对于每组数据，第一行输出一个字符串 `Yes` 或者 `No`，表示能否找到满足条件的拉丁方。  \n如果能找到满足条件的拉丁方，那么在接下来 $n$ 行，每行输出 $n$ 个数，表示一个满足条件的拉丁方。如果有多组满足条件的方案，输出任意一种即可。", "hint": "**【样例 \\#1 解释】**\n\n在第一个样例中，对于第二组数据，根据前两行可以发现，$A_{1, 3} = A_{2, 3} = 3$，所以不存在满足条件的拉丁方。\n\n对于第三组数据，可以发现输出是一个满足条件的拉丁方，并且左上角是输入的矩阵。下面也是一个满足条件的方案。\n$$\\begin{bmatrix} 1 & 2 & 3 & 5 & 4 \\\\ 4 & 3 & 2 & 1 & 5 \\\\ 3 & 5 & 1 & 4 & 2 \\\\ 2 & 4 & 5 & 3 & 1 \\\\ 5 & 1 & 4 & 2 & 3 \\end{bmatrix}$$\n\n---\n\n**【样例 \\#2】**\n\n见附件中 `latin/latin2.in` 与 `latin/latin2.ans`，这个样例满足测试点 $6 \\sim 7$ 的条件限制。\n\n---\n\n**【样例 \\#3】**\n\n见附件中 `latin/latin3.in` 与 `latin/latin3.ans`，这个样例满足测试点 $11 \\sim 12$ 的条件限制。\n\n---\n\n**【数据范围】**\n\n对于所有的数据，保证 $1 \\le T \\le 10$，$1 \\le n \\le 500$，$1 \\le R, C \\le n$，$1 \\le A_{i, j} \\le n$，保证输入的子矩阵不存在一行或者一列有两个相同的数。\n\n具体如下：\n\n| 测试点编号 | $n \\le$ | 特殊性质 |\n|:-:|:-:|:-:|\n| $1 \\sim 2$ | $6$ | 无 |\n| $3 \\sim 4$ | $10$ | 无 |\n| $5$ | $500$ | A |\n| $6 \\sim 7$ | $100$ | B |\n| $8 \\sim 9$ | $300$ | B |\n| $10$ | $500$ | B |\n| $11 \\sim 12$ | $500$ | C |\n| $13 \\sim 14$ | $100$ | 无 |\n| $15 \\sim 16$ | $300$ | 无 |\n| $17 \\sim 20$ | $500$ | 无 |\n\n特殊性质 A：保证 $R = 1$。  \n特殊性质 B：保证 $C = n$。  \n特殊性质 C：保证 $R, C \\le \\frac{n}{2}$。", "locale": "zh-CN"}}}
{"pid": "P10063", "type": "P", "difficulty": 7, "samples": [["10\n1 2 3 4 6 8 9 12 16 18\n", "12\n1 1\n1 5\n2 5\n3 6\n3 7\n4 4\n4 8\n4 9\n5 8\n5 9\n7 7\n9 9\n"], ["3\n999999999999999956000000000000000363 999999999999999844000000000000004059 999999999999999866000000000000001353\n", "1\n1 3\n"]], "limits": {"time": [10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["各省省选", "2024", "O2优化", "陕西"], "title": "[SNOI2024] 平方数", "background": "原题时间限制为 1.5 s。\n\n由于 hack 数据难以通过，改为 10 s。", "description": "你有一个正整数序列 $a_1, a_2, \\ldots, a_n$。请问有多少个区间的乘积是完全平方数。也就是有多少对 $(l, r)$（$1 \\le l \\le r \\le n$），满足 $\\prod_{i = l}^{r} a_i$ 是完全平方数。", "inputFormat": "第一行一个整数 $n$ 表示数字个数。  \n接下来一行，每行 $n$ 个数，表示 $a_1, a_2, \\ldots, a_n$。", "outputFormat": "输出一个整数，表示有多少对区间的乘积是完全平方数。  \n接下来按照字典序输出这些区间，也就是按照 $l$ 从小到大输出。  \n如果有多个 $l$ 相同的区间，按照 $r$ 从小到大输出。如果区间个数超过 ${10}^5$ 个，输出前 ${10}^5$ 个即可。", "hint": "**【样例 \\#2 解释】**\n\n在第二个样例中，这三个数为 ${10}^{18} - 11, {10}^{18} - 33, {10}^{18} - 123$ 两两相乘。\n\n---\n\n**【样例 \\#3】**\n\n见附件中 `square/square3.in` 与 `square/square3.ans`。\n\n这个样例满足测试点 $4 \\sim 6$ 的条件限制。\n\n---\n\n**【样例 \\#4】**\n\n见附件中 `square/square4.in` 与 `square/square4.ans`。\n\n这个样例满足测试点 $11 \\sim 14$ 的条件限制。\n\n---\n\n**【样例 \\#5】**\n\n见附件中 `square/square5.in` 与 `square/square5.ans`。\n\n这个样例满足测试点 $18 \\sim 20$ 的条件限制。\n\n---\n\n**【数据范围】**\n\n对于所有的数据，保证 $1 \\le n \\le 3 \\times {10}^5$，$1 \\le a_i \\le {10}^{36}$。\n\n具体如下：\n\n| 测试点编号 | $n \\le$ | $a_i \\le$ |\n|:-:|:-:|:-:|\n| $1 \\sim 3$ | $1000$ | ${10}^4$ |\n| $4 \\sim 6$ | ${10}^5$ | ${10}^6$ |\n| $7 \\sim 10$ | $100$ | ${10}^{36}$ |\n| $11 \\sim 14$ | $1000$ | ${10}^{36}$ |\n| $15 \\sim 17$ | ${10}^5$ | ${10}^{36}$ |\n| $18 \\sim 20$ | $3 \\times {10}^5$ | ${10}^{36}$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[SNOI2024] 平方数", "background": "原题时间限制为 1.5 s。\n\n由于 hack 数据难以通过，改为 10 s。", "description": "你有一个正整数序列 $a_1, a_2, \\ldots, a_n$。请问有多少个区间的乘积是完全平方数。也就是有多少对 $(l, r)$（$1 \\le l \\le r \\le n$），满足 $\\prod_{i = l}^{r} a_i$ 是完全平方数。", "inputFormat": "第一行一个整数 $n$ 表示数字个数。  \n接下来一行，每行 $n$ 个数，表示 $a_1, a_2, \\ldots, a_n$。", "outputFormat": "输出一个整数，表示有多少对区间的乘积是完全平方数。  \n接下来按照字典序输出这些区间，也就是按照 $l$ 从小到大输出。  \n如果有多个 $l$ 相同的区间，按照 $r$ 从小到大输出。如果区间个数超过 ${10}^5$ 个，输出前 ${10}^5$ 个即可。", "hint": "**【样例 \\#2 解释】**\n\n在第二个样例中，这三个数为 ${10}^{18} - 11, {10}^{18} - 33, {10}^{18} - 123$ 两两相乘。\n\n---\n\n**【样例 \\#3】**\n\n见附件中 `square/square3.in` 与 `square/square3.ans`。\n\n这个样例满足测试点 $4 \\sim 6$ 的条件限制。\n\n---\n\n**【样例 \\#4】**\n\n见附件中 `square/square4.in` 与 `square/square4.ans`。\n\n这个样例满足测试点 $11 \\sim 14$ 的条件限制。\n\n---\n\n**【样例 \\#5】**\n\n见附件中 `square/square5.in` 与 `square/square5.ans`。\n\n这个样例满足测试点 $18 \\sim 20$ 的条件限制。\n\n---\n\n**【数据范围】**\n\n对于所有的数据，保证 $1 \\le n \\le 3 \\times {10}^5$，$1 \\le a_i \\le {10}^{36}$。\n\n具体如下：\n\n| 测试点编号 | $n \\le$ | $a_i \\le$ |\n|:-:|:-:|:-:|\n| $1 \\sim 3$ | $1000$ | ${10}^4$ |\n| $4 \\sim 6$ | ${10}^5$ | ${10}^6$ |\n| $7 \\sim 10$ | $100$ | ${10}^{36}$ |\n| $11 \\sim 14$ | $1000$ | ${10}^{36}$ |\n| $15 \\sim 17$ | ${10}^5$ | ${10}^{36}$ |\n| $18 \\sim 20$ | $3 \\times {10}^5$ | ${10}^{36}$ |", "locale": "zh-CN"}}}
{"pid": "P10064", "type": "P", "difficulty": 7, "samples": [["3\n1 2\n2 3\n", "5\n"], ["6\n1 2\n2 3\n2 4\n3 5\n3 6\n", "27296\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["各省省选", "2024", "O2优化", "陕西"], "title": "[SNOI2024] 公交线路", "background": "", "description": "给定一棵 $n$ 个点的无根树。我们希望在一些点对之间修建公交线路，满足任意两个点之间只需要至多两条公交线路就能到达。\n\n形式化地说，考虑树上的所有 $\\frac{n (n - 1)}{2}$ 条两个端点不同的简单路径。对于这些路径的一个子集 $S$，称它是好的当且仅当：\n- 考虑一张新的图 $G$，对于一对点 $u, v$，当且仅当存在 $S$ 中的一条路径 $P$，满足 $u$ 和 $v$ 都在 $P$ 上，我们会在 $u, v$ 之间连上边权为 $1$ 的无向边。\n- 要求 $G$ 中任意两点之间的距离都不超过 $2$。\n\n你需要求出有多少个子集 $S$ 是好的。由于答案可能很大，输出对 $998244353$ 取模的结果。", "inputFormat": "第一行，一个正整数 $n$ 表示节点个数。  \n接下来 $n - 1$ 行，每行两个正整数 $u, v$，表示一条树边 $(u, v)$。", "outputFormat": "输出一个整数，表示答案对 $998244353$ 取模的结果。", "hint": "**【样例 \\#1 解释】**\n\n对于对于第一个样例，所有可行的方案为 $\\{(1, 3)\\}, \\{(1, 3), (1, 2)\\}, \\{(1, 3), (2, 3)\\}, \\{(1, 3), (1, 2), (2, 3)\\}, \\{(1, 2), (2, 3)\\}$。\n\n---\n\n**【样例 \\#3】**\n\n见附件中 `bus/bus3.in` 与 `bus/bus3.ans`。\n\n这个样例满足测试点 $11 \\sim 14$ 的条件限制。\n\n---\n\n**【样例 \\#4】**\n\n见附件中 `bus/bus4.in` 与 `bus/bus4.ans`。\n\n这个样例满足测试点 $19 \\sim 20$ 的条件限制。\n\n---\n\n**【数据范围】**\n\n对于所有的数据，保证 $1 \\le n \\le 3000$。\n\n具体如下：\n\n| 测试点编号 | $n \\le$ | 特殊性质 |\n|:-:|:-:|:-:|\n| $1 \\sim 3$ | $6$ | 无 |\n| $4 \\sim 7$ | $10$ | 无 |\n| $8 \\sim 10$ | $3000$ | A |\n| $11 \\sim 14$ | $100$ | 无 |\n| $15 \\sim 18$ | $500$ | 无 |\n| $19 \\sim 20$ | $3000$ | 无 |\n\n特殊性质 A：保证树是一条链。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[SNOI2024] 公交线路", "background": "", "description": "给定一棵 $n$ 个点的无根树。我们希望在一些点对之间修建公交线路，满足任意两个点之间只需要至多两条公交线路就能到达。\n\n形式化地说，考虑树上的所有 $\\frac{n (n - 1)}{2}$ 条两个端点不同的简单路径。对于这些路径的一个子集 $S$，称它是好的当且仅当：\n- 考虑一张新的图 $G$，对于一对点 $u, v$，当且仅当存在 $S$ 中的一条路径 $P$，满足 $u$ 和 $v$ 都在 $P$ 上，我们会在 $u, v$ 之间连上边权为 $1$ 的无向边。\n- 要求 $G$ 中任意两点之间的距离都不超过 $2$。\n\n你需要求出有多少个子集 $S$ 是好的。由于答案可能很大，输出对 $998244353$ 取模的结果。", "inputFormat": "第一行，一个正整数 $n$ 表示节点个数。  \n接下来 $n - 1$ 行，每行两个正整数 $u, v$，表示一条树边 $(u, v)$。", "outputFormat": "输出一个整数，表示答案对 $998244353$ 取模的结果。", "hint": "**【样例 \\#1 解释】**\n\n对于对于第一个样例，所有可行的方案为 $\\{(1, 3)\\}, \\{(1, 3), (1, 2)\\}, \\{(1, 3), (2, 3)\\}, \\{(1, 3), (1, 2), (2, 3)\\}, \\{(1, 2), (2, 3)\\}$。\n\n---\n\n**【样例 \\#3】**\n\n见附件中 `bus/bus3.in` 与 `bus/bus3.ans`。\n\n这个样例满足测试点 $11 \\sim 14$ 的条件限制。\n\n---\n\n**【样例 \\#4】**\n\n见附件中 `bus/bus4.in` 与 `bus/bus4.ans`。\n\n这个样例满足测试点 $19 \\sim 20$ 的条件限制。\n\n---\n\n**【数据范围】**\n\n对于所有的数据，保证 $1 \\le n \\le 3000$。\n\n具体如下：\n\n| 测试点编号 | $n \\le$ | 特殊性质 |\n|:-:|:-:|:-:|\n| $1 \\sim 3$ | $6$ | 无 |\n| $4 \\sim 7$ | $10$ | 无 |\n| $8 \\sim 10$ | $3000$ | A |\n| $11 \\sim 14$ | $100$ | 无 |\n| $15 \\sim 18$ | $500$ | 无 |\n| $19 \\sim 20$ | $3000$ | 无 |\n\n特殊性质 A：保证树是一条链。", "locale": "zh-CN"}}}
{"pid": "P10065", "type": "P", "difficulty": 7, "samples": [["1\n5\n1 0\n1 1\n2 0\n2 1\n1 2 3 4 5\n0 1 0 1 2\n", "3 4 6 8 5\n"]], "limits": {"time": [7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["各省省选", "2024", "O2优化", "陕西"], "title": "[SNOI2024] 字符树", "background": "", "description": "给你一个 $n$ 个点的有根树，根为 $1$。每条边上有一个字符 $c = \\{0, 1\\}$。$S_u$ 表示从根到 $u$ 的路径上每条边的字符依次写下来组成的字符串。保证每个节点向儿子的边上的字符互不相同。\n\n对每个点 $u$，有一个价值 $\\mathit{val}_u$ 和一个限制 $a_u$。对每个点 $u$，如果点 $v$ 满足 $S_u$ 是 $S_v$ 的后缀。那么我们认为 $v$ 是的 $u$ 扩展点。\n\nAlice 手里有一个字符串 $S$，初始令 $S = S_u$，现在他可以删掉若干末尾的字符，使得 $S$ 变成 $S'$。并将 $S'$ 告诉给 Bob。\n\nBob 获得了一个字符串 $S'$，他需要在 $S'$ 之后加入若干字符，并获得 $S''$。对于某个 $u$ 的扩展点 $v$，满足 $S'' = S_v$，并且 $\\lvert S' \\rvert \\ge a_v$，那么 Bob 就获得了 $\\mathit{val}_v$ 的收益，当然 Bob 只能进行一次这样的操作，所以他会选择符合条件的 $v$ 里，$\\mathit{val}_v$ 最大的那个。如果没有符合条件的 $v$，Bob 只能获得 $0$ 的收益。\n\n现在 Alice 想知道，对于删除 $0 \\sim \\lvert S \\rvert$ 个字符，总计 $\\lvert S \\rvert + 1$ 种删除方式里 Bob 能获得权值之和是多少？\n\n对于每个 $u$，你都需要回答 Alice 的询问。\n\n形式化地说：\n\n我们需要对每个点 $u$ 求出 $\\mathit{ans}_u = \\sum\\limits_{0 \\le i \\le \\lvert S_u \\rvert} \\max\\limits_{i \\ge a_v \\land S_u = S_v[\\lvert S_v \\rvert - \\lvert S_u \\rvert + 1, \\lvert S_v \\rvert] \\land S_u[1, i] = S_v[1, i]} \\mathit{val}_v$。\n\n特殊的，如果对于某个 $u$，不存在任何 $v$ 满足条件，那么 $\\max = 0$。\n\n其中 $S[l, r]$ 表示字符串 $S$ 的第 $l$ 到第 $r$ 个字符组成的字符串。特殊的，$S[x + 1, x]$ 表示空串。$\\lvert S \\rvert$ 表示字符串 $S$ 的长度，$\\land$ 表示且。", "inputFormat": "多组测试数据，第一行一个整数 $T$ 表示数据组数。  \n对于每组测试数据，第一行一个正整数 $n$，表示节点个数。  \n接下来 $n - 1$ 行，每行两个整数 $\\mathit{fa}_i, c_i$ 表示第 $i$ 个点的父亲编号，以及边上的字符。  \n接下来一行 $n$ 个正整数 $\\mathit{val}_1, \\mathit{val}_2, \\ldots, \\mathit{val}_n$。  \n接下来一行 $n$ 个非负整数 $a_1, a_2, \\ldots, a_n$。", "outputFormat": "输出一行 $n$ 个整数 $\\mathit{ans}_1, \\mathit{ans}_2, \\ldots, \\mathit{ans}_n$。", "hint": "**【样例 \\#1 解释】**\n\n以下表格表示当 $u, i$ 固定时，式子中 $\\mathit{val}_v$ 的最大值。\n\n| | $u = 1$ | $u = 2$ | $u = 3$ | $u = 4$ | $u = 5$ |\n|:-:|:-:|:-:|:-:|:-:|:-:|\n| $i = 0$ | $3$ | $0$ | $3$ | $0$ | $0$ |\n| $i = 1$ | - | $4$ | $3$ | $4$ | $0$ |\n| $i = 2$ | - | - | - | $4$ | $5$ |\n\n---\n\n**【样例 \\#2】**\n\n见附件中 `tree/tree2.in` 与 `tree/tree2.ans`。\n\n这个样例满足测试点 $3 \\sim 5$ 的条件限制。\n\n---\n\n**【样例 \\#3】**\n\n见附件中 `tree/tree3.in` 与 `tree/tree3.ans`。\n\n这个样例满足测试点 $9 \\sim 10$ 的条件限制。\n\n---\n\n**【样例 \\#4】**\n\n见附件中 `tree/tree4.in` 与 `tree/tree4.ans`。\n\n这个样例满足测试点 $11 \\sim 12$ 的条件限制。\n\n---\n\n**【数据范围】**\n\n对于所有数据保证 $1 \\le T \\le 5$，$1 \\le n \\le 5 \\times {10}^5$，$1 \\le \\mathit{val}_i \\le {10}^9$，$1 \\le \\mathit{fa}_i < i$，$c_i = \\{0, 1\\}$，$0 \\le a_i \\le n$。\n\n具体如下：\n\n| 测试点编号 | $n \\le$ | 特殊性质 |\n|:-:|:-:|:-:|\n| $1 \\sim 2$ | $100$ | 无 |\n| $3 \\sim 5$ | $2 \\times {10}^3$ | 无 |\n| $6 \\sim 8$ | ${10}^4$ | 无 |\n| $9 \\sim 10$ | ${10}^5$ | A |\n| $11 \\sim 12$ | ${10}^5$ | B |\n| $13 \\sim 16$ | ${10}^5$ | 无 |\n| $17 \\sim 20$ | $5 \\times {10}^5$ | 无 |\n\n特殊性质 A：$c_i = 0$。  \n特殊性质 B：$\\mathit{fa}_i = \\lfloor \\frac{i}{2} \\rfloor$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[SNOI2024] 字符树", "background": "", "description": "给你一个 $n$ 个点的有根树，根为 $1$。每条边上有一个字符 $c = \\{0, 1\\}$。$S_u$ 表示从根到 $u$ 的路径上每条边的字符依次写下来组成的字符串。保证每个节点向儿子的边上的字符互不相同。\n\n对每个点 $u$，有一个价值 $\\mathit{val}_u$ 和一个限制 $a_u$。对每个点 $u$，如果点 $v$ 满足 $S_u$ 是 $S_v$ 的后缀。那么我们认为 $v$ 是的 $u$ 扩展点。\n\nAlice 手里有一个字符串 $S$，初始令 $S = S_u$，现在他可以删掉若干末尾的字符，使得 $S$ 变成 $S'$。并将 $S'$ 告诉给 Bob。\n\nBob 获得了一个字符串 $S'$，他需要在 $S'$ 之后加入若干字符，并获得 $S''$。对于某个 $u$ 的扩展点 $v$，满足 $S'' = S_v$，并且 $\\lvert S' \\rvert \\ge a_v$，那么 Bob 就获得了 $\\mathit{val}_v$ 的收益，当然 Bob 只能进行一次这样的操作，所以他会选择符合条件的 $v$ 里，$\\mathit{val}_v$ 最大的那个。如果没有符合条件的 $v$，Bob 只能获得 $0$ 的收益。\n\n现在 Alice 想知道，对于删除 $0 \\sim \\lvert S \\rvert$ 个字符，总计 $\\lvert S \\rvert + 1$ 种删除方式里 Bob 能获得权值之和是多少？\n\n对于每个 $u$，你都需要回答 Alice 的询问。\n\n形式化地说：\n\n我们需要对每个点 $u$ 求出 $\\mathit{ans}_u = \\sum\\limits_{0 \\le i \\le \\lvert S_u \\rvert} \\max\\limits_{i \\ge a_v \\land S_u = S_v[\\lvert S_v \\rvert - \\lvert S_u \\rvert + 1, \\lvert S_v \\rvert] \\land S_u[1, i] = S_v[1, i]} \\mathit{val}_v$。\n\n特殊的，如果对于某个 $u$，不存在任何 $v$ 满足条件，那么 $\\max = 0$。\n\n其中 $S[l, r]$ 表示字符串 $S$ 的第 $l$ 到第 $r$ 个字符组成的字符串。特殊的，$S[x + 1, x]$ 表示空串。$\\lvert S \\rvert$ 表示字符串 $S$ 的长度，$\\land$ 表示且。", "inputFormat": "多组测试数据，第一行一个整数 $T$ 表示数据组数。  \n对于每组测试数据，第一行一个正整数 $n$，表示节点个数。  \n接下来 $n - 1$ 行，每行两个整数 $\\mathit{fa}_i, c_i$ 表示第 $i$ 个点的父亲编号，以及边上的字符。  \n接下来一行 $n$ 个正整数 $\\mathit{val}_1, \\mathit{val}_2, \\ldots, \\mathit{val}_n$。  \n接下来一行 $n$ 个非负整数 $a_1, a_2, \\ldots, a_n$。", "outputFormat": "输出一行 $n$ 个整数 $\\mathit{ans}_1, \\mathit{ans}_2, \\ldots, \\mathit{ans}_n$。", "hint": "**【样例 \\#1 解释】**\n\n以下表格表示当 $u, i$ 固定时，式子中 $\\mathit{val}_v$ 的最大值。\n\n| | $u = 1$ | $u = 2$ | $u = 3$ | $u = 4$ | $u = 5$ |\n|:-:|:-:|:-:|:-:|:-:|:-:|\n| $i = 0$ | $3$ | $0$ | $3$ | $0$ | $0$ |\n| $i = 1$ | - | $4$ | $3$ | $4$ | $0$ |\n| $i = 2$ | - | - | - | $4$ | $5$ |\n\n---\n\n**【样例 \\#2】**\n\n见附件中 `tree/tree2.in` 与 `tree/tree2.ans`。\n\n这个样例满足测试点 $3 \\sim 5$ 的条件限制。\n\n---\n\n**【样例 \\#3】**\n\n见附件中 `tree/tree3.in` 与 `tree/tree3.ans`。\n\n这个样例满足测试点 $9 \\sim 10$ 的条件限制。\n\n---\n\n**【样例 \\#4】**\n\n见附件中 `tree/tree4.in` 与 `tree/tree4.ans`。\n\n这个样例满足测试点 $11 \\sim 12$ 的条件限制。\n\n---\n\n**【数据范围】**\n\n对于所有数据保证 $1 \\le T \\le 5$，$1 \\le n \\le 5 \\times {10}^5$，$1 \\le \\mathit{val}_i \\le {10}^9$，$1 \\le \\mathit{fa}_i < i$，$c_i = \\{0, 1\\}$，$0 \\le a_i \\le n$。\n\n具体如下：\n\n| 测试点编号 | $n \\le$ | 特殊性质 |\n|:-:|:-:|:-:|\n| $1 \\sim 2$ | $100$ | 无 |\n| $3 \\sim 5$ | $2 \\times {10}^3$ | 无 |\n| $6 \\sim 8$ | ${10}^4$ | 无 |\n| $9 \\sim 10$ | ${10}^5$ | A |\n| $11 \\sim 12$ | ${10}^5$ | B |\n| $13 \\sim 16$ | ${10}^5$ | 无 |\n| $17 \\sim 20$ | $5 \\times {10}^5$ | 无 |\n\n特殊性质 A：$c_i = 0$。  \n特殊性质 B：$\\mathit{fa}_i = \\lfloor \\frac{i}{2} \\rfloor$。", "locale": "zh-CN"}}}
