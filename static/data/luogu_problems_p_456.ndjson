{"pid": "P10248", "type": "P", "difficulty": 4, "samples": [["7 5\n0 2\n2 3\n0 3\n2 5\n3 6", "4 -1 3 4 0\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["图论", "洛谷原创", "交互题", "Special Judge", "洛谷月赛"], "title": "Pairing Pairs （加强版）", "background": "本题是 [Pairing Pairs](https://www.luogu.com.cn/problem/P10247) 的加强版，数据范围和输入输出方式都有区别。", "description": "你有一些数对 $(u_i,v_i)$（保证 $0\\le u_i<v_i<n$ 且数对两两不同），对于每个 $i$ 找一个 $j$ 使得 $u_i,v_i,u_j,v_j$ 四个数两两不同，或报告不存在。\n\n**为加速输入输出，本题采用 grader 交互。请注意本题和赛时题目的区别，本题输入和输出的下标均从 $0$ 开始。**\n\n你需要实现一个函数 `int* find_pairs(int n,int m,int u[],int v[])`，其中 $n,m,u,v$ 如题意所示。\n\n返回值是一个数组（设为 `ans`），则 `ans[i]` 表示你对于 $i$ 找到的 $j$。若这样的 $j$ 不存在，则 `ans[i]=-1`，**不是 $0$。**\n\n**由于本题的返回值是一个指针，请保证返回的数组在堆空间中，具体可以参考[这篇博客](https://www.luogu.com.cn/article/sxyv0830)。**", "inputFormat": "**以下输入输出格式均为 `sample_interactive_lib.cpp` 的输入输出格式。你不需要输入或输出任何数据，甚至不应该实现 `main` 函数。**\n\n输入的第一行有两个正整数 $n,m$ 表示数对中数字的范围和数对的个数。\n\n之后 $m$ 行，其中的第 $i$ 行有两个正整数 $u_i,v_i$ 表示第 $i$ 个数对。", "outputFormat": "输出一行 $m$ 个自然数，其中第 $i$ 个数表示你对这个 $i$ 找到的 $j$。若对应的 $j$ 不存在则输出 $-1$。\n\n若符合题意的 $j$ 有多个，任意输出一个都可以通过本题。", "hint": "【样例解释】\n\n根据该程序，样例交互库将会调用 `find_pairs(7,5,{0,2,0,2,3},{2,3,3,5,6})`，然后如果你返回的数组是 `{4,-1,3,4,0}`，就会得到样例输出。这个样例输出是合法的。\n\n【数据范围】\n\n对于全体数据，保证 $1\\le n,m\\le 10^7$。\n\nstd 用时为 $324$ 毫秒，空间为 $267.87$ MB。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "Pairing Pairs （加强版）", "background": "本题是 [Pairing Pairs](https://www.luogu.com.cn/problem/P10247) 的加强版，数据范围和输入输出方式都有区别。", "description": "你有一些数对 $(u_i,v_i)$（保证 $0\\le u_i<v_i<n$ 且数对两两不同），对于每个 $i$ 找一个 $j$ 使得 $u_i,v_i,u_j,v_j$ 四个数两两不同，或报告不存在。\n\n**为加速输入输出，本题采用 grader 交互。请注意本题和赛时题目的区别，本题输入和输出的下标均从 $0$ 开始。**\n\n你需要实现一个函数 `int* find_pairs(int n,int m,int u[],int v[])`，其中 $n,m,u,v$ 如题意所示。\n\n返回值是一个数组（设为 `ans`），则 `ans[i]` 表示你对于 $i$ 找到的 $j$。若这样的 $j$ 不存在，则 `ans[i]=-1`，**不是 $0$。**\n\n**由于本题的返回值是一个指针，请保证返回的数组在堆空间中，具体可以参考[这篇博客](https://www.luogu.com.cn/article/sxyv0830)。**", "inputFormat": "**以下输入输出格式均为 `sample_interactive_lib.cpp` 的输入输出格式。你不需要输入或输出任何数据，甚至不应该实现 `main` 函数。**\n\n输入的第一行有两个正整数 $n,m$ 表示数对中数字的范围和数对的个数。\n\n之后 $m$ 行，其中的第 $i$ 行有两个正整数 $u_i,v_i$ 表示第 $i$ 个数对。", "outputFormat": "输出一行 $m$ 个自然数，其中第 $i$ 个数表示你对这个 $i$ 找到的 $j$。若对应的 $j$ 不存在则输出 $-1$。\n\n若符合题意的 $j$ 有多个，任意输出一个都可以通过本题。", "hint": "【样例解释】\n\n根据该程序，样例交互库将会调用 `find_pairs(7,5,{0,2,0,2,3},{2,3,3,5,6})`，然后如果你返回的数组是 `{4,-1,3,4,0}`，就会得到样例输出。这个样例输出是合法的。\n\n【数据范围】\n\n对于全体数据，保证 $1\\le n,m\\le 10^7$。\n\nstd 用时为 $324$ 毫秒，空间为 $267.87$ MB。", "locale": "zh-CN"}}}
{"pid": "P10249", "type": "P", "difficulty": 7, "samples": [["4 3\n1 2 3 4 5\n1 2 3 4", "15 80 300 892 2069"]], "limits": {"time": [10007, 10007, 10007, 10007, 10007, 10007, 10007, 10007, 10007, 10007], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["多项式", "O2优化", "快速傅里叶变换 FFT", "快速数论变换 NTT", "模板题"], "title": "【模板】多项式复合函数（加强版）", "background": "本题相较于 [P5373](https://www.luogu.com.cn/problem/P5373) 扩大了数据范围。", "description": "给定一个 $n$ 次多项式 $F(x)$，和一个 $m$ 次多项式 $G(x)$，你需要求一个 $n$ 次多项式 $H(x)$ ，满足条件：  \n$$H(x) \\equiv F(G(x))\\space (\\text{mod }x^{n+1})$$   \n换种说法，你要求的多项式应满足：  \n$$H(x) \\equiv \\sum_{i=0}^n [x^i]F(x)\\times G(x)^i \\space (\\text{mod }x^{n+1})$$\n将结果的各项系数对 $998244353$ 取模。", "inputFormat": "第一行两个正整数 $n,m$，分别表示 $F(x)$ 和 $G(x)$ 的次数。\n\n第二行 $n+1$ 个非负整数 $f_i$，表示 $F(x)$ 的 $i$ 次项系数。\n\n第三行 $m+1$ 个非负整数 $g_i$，表示 $G(x)$ 的 $i$ 次项系数。   ", "outputFormat": "输出一行 $n+1$ 个非负整数，从低到高表示 $H(x)$ 的系数。", "hint": "**数据范围：**  \n\n- $1\\le m \\le n \\le 200000$    \n- $f_i,g_i \\in [0,998244353)\\cap \\mathbb Z$\n\n| 测试点编号 | $m,n\\le$ |\n| :----------: | :----------: |\n| $1,2$ | $30000$ |\n| $3,4$ | $50000$ |\n| $5,6$ | $100000$ |\n| $7,8$ | $150000$ |\n| $9,10$ | $200000$ |\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "【模板】多项式复合函数（加强版）", "background": "本题相较于 [P5373](https://www.luogu.com.cn/problem/P5373) 扩大了数据范围。", "description": "给定一个 $n$ 次多项式 $F(x)$，和一个 $m$ 次多项式 $G(x)$，你需要求一个 $n$ 次多项式 $H(x)$ ，满足条件：  \n$$H(x) \\equiv F(G(x))\\space (\\text{mod }x^{n+1})$$   \n换种说法，你要求的多项式应满足：  \n$$H(x) \\equiv \\sum_{i=0}^n [x^i]F(x)\\times G(x)^i \\space (\\text{mod }x^{n+1})$$\n将结果的各项系数对 $998244353$ 取模。", "inputFormat": "第一行两个正整数 $n,m$，分别表示 $F(x)$ 和 $G(x)$ 的次数。\n\n第二行 $n+1$ 个非负整数 $f_i$，表示 $F(x)$ 的 $i$ 次项系数。\n\n第三行 $m+1$ 个非负整数 $g_i$，表示 $G(x)$ 的 $i$ 次项系数。   ", "outputFormat": "输出一行 $n+1$ 个非负整数，从低到高表示 $H(x)$ 的系数。", "hint": "**数据范围：**  \n\n- $1\\le m \\le n \\le 200000$    \n- $f_i,g_i \\in [0,998244353)\\cap \\mathbb Z$\n\n| 测试点编号 | $m,n\\le$ |\n| :----------: | :----------: |\n| $1,2$ | $30000$ |\n| $3,4$ | $50000$ |\n| $5,6$ | $100000$ |\n| $7,8$ | $150000$ |\n| $9,10$ | $200000$ |\n", "locale": "zh-CN"}}}
{"pid": "P10250", "type": "P", "difficulty": 2, "samples": [["4", "7"], ["10", "274"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "递推", "GESP"], "title": "[GESP样题 六级] 下楼梯", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1106>", "description": "顽皮的小明发现，下楼梯时每步可以走 $1$ 个台阶、$2$ 个台阶或 $3$ 个台阶。现在一共有 $N$ 个台阶，你能帮小明算算有多少种方案吗？", "inputFormat": "输入一行，包含一个整数 $N$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "对全部的测试点，保证 $1 \\leq N \\leq 60$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[GESP样题 六级] 下楼梯", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1106>", "description": "顽皮的小明发现，下楼梯时每步可以走 $1$ 个台阶、$2$ 个台阶或 $3$ 个台阶。现在一共有 $N$ 个台阶，你能帮小明算算有多少种方案吗？", "inputFormat": "输入一行，包含一个整数 $N$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "对全部的测试点，保证 $1 \\leq N \\leq 60$。", "locale": "zh-CN"}}}
{"pid": "P10251", "type": "P", "difficulty": 2, "samples": [["2\n1 0 2 3\n-1 1 3 2", "12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "O2优化", "洛谷月赛"], "title": "农场", "background": "加入 mc2b2t.com 谢谢喵。\n\nupd：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ks73gdzb.png)", "description": "ZHY 想管理他的农场。  \n\n具体地，他有 $n$ 片农场，每一片农场都是一个矩形，其四条边都平行于坐标轴。这些农场可以有重叠的部分。\n\n他现在想圈一块地来维护自己的农场。他希望这块地可以完全覆盖所有农场。为了方便，他还希望这块地也是一个四条边都平行于坐标轴的矩形。他想最小化矩形的面积。\n\n由于他的农场实在是太多了，所以他向你寻求帮助。你需要输出这个矩形的面积。", "inputFormat": "第一行一个正整数 $n$。\n\n接下来 $n$ 行，输入四个整数 $x_{1},y_{1},x_{2},y_{2}$，表示存在一个以 $(x_{1},y_{1})$，$(x_{2},y_{2})$ 为两个对角顶点的农场。", "outputFormat": "输出一个整数表示圈地的最小面积。", "hint": "样例解释：如下图所示，绿色为第一个农场，红色为第二个农场，不难发现最小的圈地面积为 $3\\times 4=12$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/8hhhluee.png)\n\n----\n\n对于 $40\\%$ 的数据，$n,|x|,|y| \\le 200$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 2 \\times 10^{5}$，$0 \\le |x|,|y| \\le 10^{9}$，$x_{1}\\neq x_{2}$，$y_{1}\\neq y_{2}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "农场", "background": "加入 mc2b2t.com 谢谢喵。\n\nupd：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ks73gdzb.png)", "description": "ZHY 想管理他的农场。  \n\n具体地，他有 $n$ 片农场，每一片农场都是一个矩形，其四条边都平行于坐标轴。这些农场可以有重叠的部分。\n\n他现在想圈一块地来维护自己的农场。他希望这块地可以完全覆盖所有农场。为了方便，他还希望这块地也是一个四条边都平行于坐标轴的矩形。他想最小化矩形的面积。\n\n由于他的农场实在是太多了，所以他向你寻求帮助。你需要输出这个矩形的面积。", "inputFormat": "第一行一个正整数 $n$。\n\n接下来 $n$ 行，输入四个整数 $x_{1},y_{1},x_{2},y_{2}$，表示存在一个以 $(x_{1},y_{1})$，$(x_{2},y_{2})$ 为两个对角顶点的农场。", "outputFormat": "输出一个整数表示圈地的最小面积。", "hint": "样例解释：如下图所示，绿色为第一个农场，红色为第二个农场，不难发现最小的圈地面积为 $3\\times 4=12$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/8hhhluee.png)\n\n----\n\n对于 $40\\%$ 的数据，$n,|x|,|y| \\le 200$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 2 \\times 10^{5}$，$0 \\le |x|,|y| \\le 10^{9}$，$x_{1}\\neq x_{2}$，$y_{1}\\neq y_{2}$。", "locale": "zh-CN"}}}
{"pid": "P10252", "type": "P", "difficulty": 3, "samples": [["2\n6 2 4\n5 3 16", "6\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "洛谷原创", "O2优化", "洛谷月赛", "分类讨论"], "title": "线性变换", "background": "", "description": "你有三个非负整数 $x,a,b$。在 $x \\ge 0$ 的前提下，你可以对 $x$ 进行任意次（包括 $0$ 次）如下操作：\n\n* 将 $x$ 变为 $ax - b$。\n\n你需要求出你通过操作能得到的 $x$ 的最小值。", "inputFormat": "**本题有多组数据。**\n\n第一行一个整数 $T$，表示数据组数。\n\n对于每组数据，输入一行三个整数 $x,a,b$。", "outputFormat": "对于每组数据，输出一行一个整数表示答案。", "hint": "样例解释：对于第一组数据，有 $x=6 \\rightarrow 8 \\rightarrow 12 \\rightarrow \\cdots$，很明显 $x=6$ 就是最小值。\n\n对于第二组数据，有 $x=5\\rightarrow -1$，$x=-1$ 为最小值。\n\n----\n\n对于 $30\\%$ 的数据，$T \\le 5$，$x,a,b \\le 100$。\n\n对于另 $20\\%$ 的数据，$a \\gt b$。\n\n对于另 $20\\%$ 的数据，$b=0$。\n\n对于 $100\\%$ 的数据，$1 \\le T \\le 1000$，$0 \\le x,a,b \\le 10^{9}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "线性变换", "background": "", "description": "你有三个非负整数 $x,a,b$。在 $x \\ge 0$ 的前提下，你可以对 $x$ 进行任意次（包括 $0$ 次）如下操作：\n\n* 将 $x$ 变为 $ax - b$。\n\n你需要求出你通过操作能得到的 $x$ 的最小值。", "inputFormat": "**本题有多组数据。**\n\n第一行一个整数 $T$，表示数据组数。\n\n对于每组数据，输入一行三个整数 $x,a,b$。", "outputFormat": "对于每组数据，输出一行一个整数表示答案。", "hint": "样例解释：对于第一组数据，有 $x=6 \\rightarrow 8 \\rightarrow 12 \\rightarrow \\cdots$，很明显 $x=6$ 就是最小值。\n\n对于第二组数据，有 $x=5\\rightarrow -1$，$x=-1$ 为最小值。\n\n----\n\n对于 $30\\%$ 的数据，$T \\le 5$，$x,a,b \\le 100$。\n\n对于另 $20\\%$ 的数据，$a \\gt b$。\n\n对于另 $20\\%$ 的数据，$b=0$。\n\n对于 $100\\%$ 的数据，$1 \\le T \\le 1000$，$0 \\le x,a,b \\le 10^{9}$。", "locale": "zh-CN"}}}
{"pid": "P10253", "type": "P", "difficulty": 5, "samples": [["2\n12\n136", "11\n123"], ["3\n10\n123\n7510", "-1\n111\n6761"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "高精度", "洛谷原创", "O2优化", "洛谷月赛"], "title": "说唱", "background": "在题目描述末尾有形式化题意。", "description": "ZHY 在一个空旷的房间里练习说唱。\n\nZHY 初始时会发出一个强度为 $x$ 的声音，这个声音会与墙壁发生碰撞，产生一个强度为 $\\lfloor \\frac x {10} \\rfloor$ 的回声。回声会继续与墙壁碰撞，产生回声的回声……直到这个回声的强度为 $0$。\n\n房间里还有一个收音机，它会记录下来所有的声音（包括初始发出的声音和所有回声）。可惜，ZHY 一不小心把收音机弄坏了。现在，收音机只能显示出记录下的所有声音的强度之和 $y$，你能通过这个仅有的信息计算出 ZHY 初始发出的声音的强度是多少吗？由于收音机太过古老，可能会出现一些故障导致显示的数有误。对于这种情况，你需要输出 $-1$。\n\n**形式化题意**\n\n如下定义一个函数：\n\n$$f(x)=\\begin{cases} 0 & x = 0 \\\\ x+f(\\lfloor\\frac{x}{10}\\rfloor) & x > 0 \\end{cases}$$\n\n比如 $f(123)=123+12+1=136$。\n\n给定一个数 $y$，请求出是否存在唯一的一个数 $x$ 满足 $f(x)=y$，如果有则输出 $x$，否则输出 $-1$。", "inputFormat": "本题有多组数据。\n\n第一行一个整数 $T$，表示数据组数。\n\n每一组数据包含一行一个整数 $y$。", "outputFormat": "对于每组数据，若存在唯一的 $x$ 对应这个 $y$，则输出 $x$。否则，输出 `-1`。", "hint": "| $\\mathrm{Subtask} \\kern{2pt} \\mathrm{id}$ | $y$ | 特殊性质 |分值 |\n| :-----: | :-----: | :-----: | :-----: |\n| $1$ | $< 1000$ | 无 | $10$ |\n| $2$ | $< 10^6$ | 无 | $15$ |\n| $3$ | $< 10^{100000}$ | $S\\le 9$ | $10$ |\n| $4$ | $< 10^{100000}$ | $S\\le 10$ | $20$ |\n| $5$ | $< 10^{3000}$ | 无 | $15$ |\n| $6$ | $< 10^{500000}$ | 无 | $30$ |\n\n特殊性质一栏中，$S\\le k$ 表示“若有解，$x$ 中所有位的数字和不超过 $k$”。\n\n对于 $100\\%$ 的数据，$1\\le T\\le 10$，$0 \\le y < 10^{500000}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "说唱", "background": "在题目描述末尾有形式化题意。", "description": "ZHY 在一个空旷的房间里练习说唱。\n\nZHY 初始时会发出一个强度为 $x$ 的声音，这个声音会与墙壁发生碰撞，产生一个强度为 $\\lfloor \\frac x {10} \\rfloor$ 的回声。回声会继续与墙壁碰撞，产生回声的回声……直到这个回声的强度为 $0$。\n\n房间里还有一个收音机，它会记录下来所有的声音（包括初始发出的声音和所有回声）。可惜，ZHY 一不小心把收音机弄坏了。现在，收音机只能显示出记录下的所有声音的强度之和 $y$，你能通过这个仅有的信息计算出 ZHY 初始发出的声音的强度是多少吗？由于收音机太过古老，可能会出现一些故障导致显示的数有误。对于这种情况，你需要输出 $-1$。\n\n**形式化题意**\n\n如下定义一个函数：\n\n$$f(x)=\\begin{cases} 0 & x = 0 \\\\ x+f(\\lfloor\\frac{x}{10}\\rfloor) & x > 0 \\end{cases}$$\n\n比如 $f(123)=123+12+1=136$。\n\n给定一个数 $y$，请求出是否存在唯一的一个数 $x$ 满足 $f(x)=y$，如果有则输出 $x$，否则输出 $-1$。", "inputFormat": "本题有多组数据。\n\n第一行一个整数 $T$，表示数据组数。\n\n每一组数据包含一行一个整数 $y$。", "outputFormat": "对于每组数据，若存在唯一的 $x$ 对应这个 $y$，则输出 $x$。否则，输出 `-1`。", "hint": "| $\\mathrm{Subtask} \\kern{2pt} \\mathrm{id}$ | $y$ | 特殊性质 |分值 |\n| :-----: | :-----: | :-----: | :-----: |\n| $1$ | $< 1000$ | 无 | $10$ |\n| $2$ | $< 10^6$ | 无 | $15$ |\n| $3$ | $< 10^{100000}$ | $S\\le 9$ | $10$ |\n| $4$ | $< 10^{100000}$ | $S\\le 10$ | $20$ |\n| $5$ | $< 10^{3000}$ | 无 | $15$ |\n| $6$ | $< 10^{500000}$ | 无 | $30$ |\n\n特殊性质一栏中，$S\\le k$ 表示“若有解，$x$ 中所有位的数字和不超过 $k$”。\n\n对于 $100\\%$ 的数据，$1\\le T\\le 10$，$0 \\le y < 10^{500000}$。", "locale": "zh-CN"}}}
{"pid": "P10254", "type": "P", "difficulty": 6, "samples": [["3 2", "22"], ["7 5", "22066"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "数学", "洛谷原创", "O2优化", "前缀和", "洛谷月赛"], "title": "口吃", "background": "在题目描述末尾有形式化题意。", "description": "因为练习说唱，ZHY 变成了一个口吃。\n\nZHY 的口吃十分特别，具体的，假设 ZHY 要读一段有 $n$ 个字的话，那么他会将第一个字读一遍，第二个字读两遍，第三个字读三遍……第 $n$ 个字读 $n$ 遍。例如，“原神启动”ZHY 会读成“原神神启启启动动动动”。\n\nYHZ 手上有 $n$ 个字，每个字都有 YHZ 为其设定的悦耳值 $a_i$，且 $a_{1\\sim n}$ 会形成一个 $1\\sim n$ 的排列。现在，他要把这 $n$ 个字重新排列成一段话给 ZHY 读。因为 YHZ 喜欢玩原神，所以他要求重新排列后序列 $a$ 的逆序对个数恰好为 $k$。不过 YHZ 还没定好每个字的顺序，所以请你求出对于所有可能的排列，ZHY 按顺序将这段话读出后，YHZ 将听到的所有字的悦耳值之和的和。显然，如果 YHZ 听到了一个字多次，其悦耳值也应算进总和多次。\n\n**形式化题意**\n\n称一个 $1\\sim n$ 的排列 $a_1,a_2,\\cdots,a_n$ 是合法的，当且仅当其逆序对数**恰好**为 $k$。同时，对于一个排列 $a_1,a_2,\\cdots,a_n$，其权值是 $\\sum_{i=1}^n i\\times a_i$。\n\n给定 $n$ 和 $k$，请你求出所有 $1\\sim n$ 的合法排列的权值之和，答案对 $998244353$ 取模。\n\n一个排列的逆序对数定义为 $\\sum_{i=1}^n\\sum_{j=i+1}^n [a_i>a_j]$。", "inputFormat": "一行两个整数 $n,k$。", "outputFormat": "一行一个整数表示答案对 $998244353$ 取模的值。", "hint": "**样例 $1$ 解释**\n\n合法的排列只有两种：$2\\ 3\\ 1$ 和 $3\\ 1\\ 2$，它们的权值都是 $11$，故答案为 $22$。\n\n---\n\n对于 $10\\%$ 的数据，$n \\le 10$。\n\n对于 $25\\%$ 的数据，$n \\le 100$。\n\n对于另外 $20\\%$ 的数据，$k \\le 300$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 300$，$0\\le k \\le \\frac{n(n-1)}{2}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "口吃", "background": "在题目描述末尾有形式化题意。", "description": "因为练习说唱，ZHY 变成了一个口吃。\n\nZHY 的口吃十分特别，具体的，假设 ZHY 要读一段有 $n$ 个字的话，那么他会将第一个字读一遍，第二个字读两遍，第三个字读三遍……第 $n$ 个字读 $n$ 遍。例如，“原神启动”ZHY 会读成“原神神启启启动动动动”。\n\nYHZ 手上有 $n$ 个字，每个字都有 YHZ 为其设定的悦耳值 $a_i$，且 $a_{1\\sim n}$ 会形成一个 $1\\sim n$ 的排列。现在，他要把这 $n$ 个字重新排列成一段话给 ZHY 读。因为 YHZ 喜欢玩原神，所以他要求重新排列后序列 $a$ 的逆序对个数恰好为 $k$。不过 YHZ 还没定好每个字的顺序，所以请你求出对于所有可能的排列，ZHY 按顺序将这段话读出后，YHZ 将听到的所有字的悦耳值之和的和。显然，如果 YHZ 听到了一个字多次，其悦耳值也应算进总和多次。\n\n**形式化题意**\n\n称一个 $1\\sim n$ 的排列 $a_1,a_2,\\cdots,a_n$ 是合法的，当且仅当其逆序对数**恰好**为 $k$。同时，对于一个排列 $a_1,a_2,\\cdots,a_n$，其权值是 $\\sum_{i=1}^n i\\times a_i$。\n\n给定 $n$ 和 $k$，请你求出所有 $1\\sim n$ 的合法排列的权值之和，答案对 $998244353$ 取模。\n\n一个排列的逆序对数定义为 $\\sum_{i=1}^n\\sum_{j=i+1}^n [a_i>a_j]$。", "inputFormat": "一行两个整数 $n,k$。", "outputFormat": "一行一个整数表示答案对 $998244353$ 取模的值。", "hint": "**样例 $1$ 解释**\n\n合法的排列只有两种：$2\\ 3\\ 1$ 和 $3\\ 1\\ 2$，它们的权值都是 $11$，故答案为 $22$。\n\n---\n\n对于 $10\\%$ 的数据，$n \\le 10$。\n\n对于 $25\\%$ 的数据，$n \\le 100$。\n\n对于另外 $20\\%$ 的数据，$k \\le 300$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 300$，$0\\le k \\le \\frac{n(n-1)}{2}$。", "locale": "zh-CN"}}}
{"pid": "P10255", "type": "P", "difficulty": 6, "samples": [["4 2\n1 2 3 4\n1 2 1\n2 3 1", "4\n6\n5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "O2优化", "洛谷月赛", "根号分治"], "title": "一首诗", "background": "题目描述最后有形式化题意。", "description": "文学大师 ZHY 创作了一首诗。\n\n这首诗由 $n$ 个单词组成，为了方便表述，ZHY 将这首诗记录为一个长度为 $n$ 的整数序列 $a_1,a_2,\\dots,a_n$。创作完后，ZHY 立刻将自己的作品分享给了 YHZ。YHZ 在感受到了诗歌之美后，希望借此提高一下自己的文学素养，于是准备对这首诗中的诗句进行摘抄。\n\nYHZ 认为一个“诗句”，应该是 $a_1,a_2,\\dots,a_n$ 的一个**连续**子序列，诗句的长度即为子序列的长度。当然，他不会摘抄所有的诗句，而是只选择“优美的诗句”进行摘抄。由于不懂文法，YHZ 简单地认为一个诗句是“优美的”，当且仅当这个诗句中不存在两个**相邻**的重复单词。形式化的说，一个连续子序列 $a_l,a_{l+1},\\dots,a_r$（$l\\leq r$）组成的诗句是“优美的”，当且仅当对于所有的 $l\\leq i<r$，有 $a_i\\neq a_{i+1}$。\n\nYHZ 发现文学大师 ZHY 写的诗里优美的诗句太多了，所以他需要进行归类。不过还是由于他不懂文法，他希望直接按照句子的长度归类。记 $b_i$ 为长度为 $i$ 的优美的诗句的个数，YHZ 希望知道 $b_1,b_2,\\dots,b_n$。但即使是所有的 $b$ 数量也太多了，所以他只需要知道 $b_1\\oplus b_2\\oplus\\dots\\oplus b_n$。\n\n还没等 YHZ 摘抄结束，文学大师 ZHY 告诉 YHZ 他要进行 $Q$ 次润色。具体地，每次润色，ZHY 会选择一个诗句 $[l_i,r_i]$ 和一个整数 $x_i$，并对所有的 $l_i\\leq j\\leq r_i$，将单词 $a_j$ 修改为 $a_j+x_i$。好学的 YHZ 希望对每次润色后的诗歌进行摘抄，即对于每次修改后的 $a_1,a_2\\dots,a_n$，知道 $b_1\\oplus b_2\\oplus\\dots\\oplus b_n$。\n\n不过文学大师 ZHY 太卷了，他进行的润色次数太多了，YHZ 还是承受不了这么大的工作量，所以他希望你帮帮他。\n\n**形式化题面：**\n\n给定一个序列 $a_{1\\sim n}$，定义 $b_i$ 表示 $a$ 中有多少个长度为 $i$ 的区间使得任意两个相邻的数都不同。有 $q$ 次操作，每次操作给定 $l,r,x$，表示将 $a_{l\\sim r}$ 都加上 $x$。请在第一次操作之前和每次操作之后求出 $b_1\\oplus b_2\\oplus \\cdots \\oplus b_n$。其中 $\\oplus$ 表示按位异或。", "inputFormat": "第一行两个正整数 $n,q$。\n\n第二行 $n$ 个整数 $a_{1},a_{2},\\cdots,a_{n}$。\n\n接下来 $q$ 行，每行三个整数 $l_{i},r_{i},x_{i}$，表示一次操作。", "outputFormat": "输出 $q+1$ 行，表示第一次操作前和每次操作后的答案。", "hint": "样例解释：\n\n第一次修改之前序列为 $[1,2,3,4]$，得到 $b_1=4,b_2=3,b_3=2,b_4=1$，故答案为 $4\\oplus 3 \\oplus 2\\oplus 1=4$。\n\n第一次修改之后序列为 $[2,3,3,4]$，得到 $b_1=4,b_2=2,b_3=0,b_4=0$，故答案为 $4\\oplus 2 \\oplus 0\\oplus 0=6$。\n\n第二次修改之后序列为 $[2,4,4,4]$，得到 $b_1=4,b_2=1,b_3=0,b_4=0$，故答案为 $4\\oplus 1 \\oplus 0\\oplus 0=5$。\n\n----\n\n| 子任务编号 | $n$ | $q$ | 特殊性质 | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $0$ | $\\le 300$ | $\\le 300$ | 无 | $15$ |\n| $1$ | $\\le 5000$ | $\\le 5000$ | 无 | $15$ |\n| $2$ | $\\le 2\\times 10^5$ | $\\le 2\\times 10^5$ | 保证 $a_i,x$ 在值域内均匀随机 | $10$ |\n| $3$ | $\\le 5\\times 10^4$ | $\\le 5\\times 10^4$ | 无 | $30$ |\n| $4$ | $\\le 2\\times 10^5$ | $\\le 2\\times 10^5$ | $l=1,r=n$ | $5$ |\n| $5$ | $\\le 2\\times 10^5$ | $\\le 2\\times 10^5$ | 无 | $25$ |\n\n对于所有数据，$1 \\le n,q \\le 2\\times 10^5$，$1\\le l \\le r \\le n$，$0\\le |x|,|a_i|\\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "一首诗", "background": "题目描述最后有形式化题意。", "description": "文学大师 ZHY 创作了一首诗。\n\n这首诗由 $n$ 个单词组成，为了方便表述，ZHY 将这首诗记录为一个长度为 $n$ 的整数序列 $a_1,a_2,\\dots,a_n$。创作完后，ZHY 立刻将自己的作品分享给了 YHZ。YHZ 在感受到了诗歌之美后，希望借此提高一下自己的文学素养，于是准备对这首诗中的诗句进行摘抄。\n\nYHZ 认为一个“诗句”，应该是 $a_1,a_2,\\dots,a_n$ 的一个**连续**子序列，诗句的长度即为子序列的长度。当然，他不会摘抄所有的诗句，而是只选择“优美的诗句”进行摘抄。由于不懂文法，YHZ 简单地认为一个诗句是“优美的”，当且仅当这个诗句中不存在两个**相邻**的重复单词。形式化的说，一个连续子序列 $a_l,a_{l+1},\\dots,a_r$（$l\\leq r$）组成的诗句是“优美的”，当且仅当对于所有的 $l\\leq i<r$，有 $a_i\\neq a_{i+1}$。\n\nYHZ 发现文学大师 ZHY 写的诗里优美的诗句太多了，所以他需要进行归类。不过还是由于他不懂文法，他希望直接按照句子的长度归类。记 $b_i$ 为长度为 $i$ 的优美的诗句的个数，YHZ 希望知道 $b_1,b_2,\\dots,b_n$。但即使是所有的 $b$ 数量也太多了，所以他只需要知道 $b_1\\oplus b_2\\oplus\\dots\\oplus b_n$。\n\n还没等 YHZ 摘抄结束，文学大师 ZHY 告诉 YHZ 他要进行 $Q$ 次润色。具体地，每次润色，ZHY 会选择一个诗句 $[l_i,r_i]$ 和一个整数 $x_i$，并对所有的 $l_i\\leq j\\leq r_i$，将单词 $a_j$ 修改为 $a_j+x_i$。好学的 YHZ 希望对每次润色后的诗歌进行摘抄，即对于每次修改后的 $a_1,a_2\\dots,a_n$，知道 $b_1\\oplus b_2\\oplus\\dots\\oplus b_n$。\n\n不过文学大师 ZHY 太卷了，他进行的润色次数太多了，YHZ 还是承受不了这么大的工作量，所以他希望你帮帮他。\n\n**形式化题面：**\n\n给定一个序列 $a_{1\\sim n}$，定义 $b_i$ 表示 $a$ 中有多少个长度为 $i$ 的区间使得任意两个相邻的数都不同。有 $q$ 次操作，每次操作给定 $l,r,x$，表示将 $a_{l\\sim r}$ 都加上 $x$。请在第一次操作之前和每次操作之后求出 $b_1\\oplus b_2\\oplus \\cdots \\oplus b_n$。其中 $\\oplus$ 表示按位异或。", "inputFormat": "第一行两个正整数 $n,q$。\n\n第二行 $n$ 个整数 $a_{1},a_{2},\\cdots,a_{n}$。\n\n接下来 $q$ 行，每行三个整数 $l_{i},r_{i},x_{i}$，表示一次操作。", "outputFormat": "输出 $q+1$ 行，表示第一次操作前和每次操作后的答案。", "hint": "样例解释：\n\n第一次修改之前序列为 $[1,2,3,4]$，得到 $b_1=4,b_2=3,b_3=2,b_4=1$，故答案为 $4\\oplus 3 \\oplus 2\\oplus 1=4$。\n\n第一次修改之后序列为 $[2,3,3,4]$，得到 $b_1=4,b_2=2,b_3=0,b_4=0$，故答案为 $4\\oplus 2 \\oplus 0\\oplus 0=6$。\n\n第二次修改之后序列为 $[2,4,4,4]$，得到 $b_1=4,b_2=1,b_3=0,b_4=0$，故答案为 $4\\oplus 1 \\oplus 0\\oplus 0=5$。\n\n----\n\n| 子任务编号 | $n$ | $q$ | 特殊性质 | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $0$ | $\\le 300$ | $\\le 300$ | 无 | $15$ |\n| $1$ | $\\le 5000$ | $\\le 5000$ | 无 | $15$ |\n| $2$ | $\\le 2\\times 10^5$ | $\\le 2\\times 10^5$ | 保证 $a_i,x$ 在值域内均匀随机 | $10$ |\n| $3$ | $\\le 5\\times 10^4$ | $\\le 5\\times 10^4$ | 无 | $30$ |\n| $4$ | $\\le 2\\times 10^5$ | $\\le 2\\times 10^5$ | $l=1,r=n$ | $5$ |\n| $5$ | $\\le 2\\times 10^5$ | $\\le 2\\times 10^5$ | 无 | $25$ |\n\n对于所有数据，$1 \\le n,q \\le 2\\times 10^5$，$1\\le l \\le r \\le n$，$0\\le |x|,|a_i|\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P10256", "type": "P", "difficulty": 6, "samples": [["3 1 3\n1 3\n2 3\n1 4\n2 3\n2\n1 2 4 5\n2", "10\n9"], ["2 1 1\n1 1\n1 2\n0 2\n2", "4"], ["2 1 1\n1 1\n1 2\n1 2\n2", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["线段树", "洛谷原创", "洛谷月赛", "动态 DP", "全局平衡二叉树"], "title": "高仿的 Migos", "background": "", "description": "经过刻苦的训练，ZHY 终于成为了一名说唱歌手。但这天，说唱歌手 ZHY 看到了同行说唱组合 Migos 的作品，立刻意识到了自己的差距，于是他要学习 Migos 的说唱技巧，复刻 Migos 的成功。\n\n经过数个日夜的研究，ZHY 最终挑选出了 $n$ 部 Migos 的说唱作品，依次编号为 $1,2,\\dots,n$。他认为只要学习完这 $n$ 部作品，就可以成为更加优秀的说唱歌手。于是，他会从第 $1$ 部作品，按编号从小到大的顺序依次进行学习，学习完第 $n$ 部作品就结束学习。\n\n不过，说唱歌手 ZHY 的学习方式很特殊。对于每部作品，他只会听 $1$ 分钟。这种学习方式的问题是，对于第 $i$ 部作品，他在投入 $1$ 分钟后，有可能学习成功，也有可能会失败，具体地，如果 ZHY 学习的是作品 $i$，那么在他花一分钟的时间进行学习后：\n\n- 有 $P_i$ 的概率，ZHY 学习成功了，那么他会接着去学习作品 $i+1$（当然如果 $i=n$ 就直接结束学习）。\n- 有 $1-P_i$ 的概率，ZHY 学习失败了。不幸的是，ZHY 脑内的记忆还会因此产生混乱，导致他只会记住前 $x_i$ 部作品，即他必须从第 $x_i+1$ 部作品开始重新学习。\n\nZHY 在尝试了几次学习后，深受记忆混乱的困扰，于是向脑科学专家 YHZ 求助。经过脑科学专家 YHZ 的研究，他发现所有的 $x_i$ 有一定的规律。具体地，他发现有 $m$ 对自然数 $(l_i,r_i)$, 其中 $i=1,2\\dots,m$，满足 $0\\leq l_i<r_i\\leq n$，那么 $x_i=\\max\\limits_{j=1}^m\\{l_j\n\\mid l_j+1\\leq i\\leq r_j\\}$，特别地，如果对于所有 $1\\leq j\\leq m$，都**不满足** $l_j+1\\leq i\\leq r_j$，那么 $x_i=0$。\n\n现在，ZHY 对自己的学习能力有了充分了解，但刚才的尝试让他疲惫不堪，所以他决定休息 $1$ 秒，并希望你帮他计算一下他期望多少分钟可以结束学习。不过他意识到，自己如果每部作品只学固定的 $1$ 分钟是不够全面的，所以他决定更改一些作品他所会学习的那一分钟，这会导致他学习这一部作品的成功概率发生改变。具体地，现在 ZHY 提出了 $k$ 个要求，每个要求有两种可能：\n\n1. 修改某个作品 $i$ 学习成功的概率 $P_i$。\n1. 询问以当前的概率他学习完 $n$ 部作品期望要多少分钟。\n\n由于 ZHY 要休息，所以他找上了你，希望你来解决他的要求。对于他的每个第二种要求，你要告诉他期望时间对 $10^9+7$ 取模的结果。ZHY 给了你 $1$ 秒的时间，因为他只能休息这么久。", "inputFormat": "第一行三个整数 $n,m,k$。意思如题面所述。\n\n接下来 $n$ 行，每行两个正整数 $p_i,q_i$，表示 $P_i=\\frac{p_i}{q_i}$。\n\n接下来 $m$ 行，每行两个整数 $l_{i},r_{i}$。\n\n接下来 $k$ 行，每行都是以下两种格式的其中一种：\n\n- `1 x a b` 为修改操作。表示 $P_x$ 变成了 $\\frac a b$。保证 $1\\le x \\le n$，$1 \\le a \\le b < 10^9+7$ 且 $x,a,b$ 均为正整数。\n\n- `2` 为查询操作。表示询问此时结束学习的期望时间是多少。对 $10^9+7$ 取模。", "outputFormat": "对于每个询问，输出一行一个整数表示答案。", "hint": "**本题使用捆绑测试。**\n\n| Subtask 编号 | $n$ | $m$ | $k$ | 特殊性质 |分值 |\n| :-----: | :-----: | :-----: | :-----: | :-----: | :-----: |\n| $0$ | $\\le 300$ | $\\le 300$ | $\\le 300$ | 无 | $11$ |\n| $1$ | $\\le 3000$ | $\\le 3000$ | $\\le 3000$ | 无 | $4$ |\n| $2$ | $\\le 10^5$ | $\\le 10^5$ | $\\le 1$ | B | $5$ |\n| $3$ | $\\le 10^5$ | $\\le 10^5$ | $\\le 1$ | 无 | $14$ |\n| $4$ | $\\le 10^5$ | $=0$ | $\\le 10^5$ | 无 | $19$ |\n| $5$ | $\\le 10^5$ | $\\le 10^5$ | $\\le 10^5$ | A | $19$ |\n| $6$ | $\\le 10^5$ | $\\le 10^5$ | $\\le 10^5$ | B | $8$ |\n| $7$ | $\\le 10^5$ | $\\le 10^5$ | $\\le 10^5$ | C | $10$ |\n| $8$ | $\\le 10^5$ | $\\le 10^5$ | $\\le 10^5$ | 无 | $10$ |\n\n以下的“区间”均指 $[l_i,r_i]$。\n\n特殊性质 A：保证对于 $\\forall i \\in [1,m]$，$r_i-l_i+1\\le 5$。\n\n特殊性质 B：保证这些区间两两的交 $\\le 1$。即对于 $\\forall i,j \\in [1,m]$ 且 $i\\ne j$，有 $r_i\\le l_j$ 或 $r_j\\le l_i$。\n\n特殊性质 C：保证这些区间不存在包含关系。即对于 $\\forall i,j \\in [1,m]$ 且 $i\\ne j$，有 $l_i>l_j$ 或 $r_i<r_j$。\n\n对于 $100\\%$ 的数据，$1 \\le n,k \\le 10^5$，$0 \\le m \\le 10^5$，$1 \\le p_{i} \\le q_{i} \\lt 10^{9}+7$，$0 \\le l_{i} \\lt r_{i} \\le n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "高仿的 Migos", "background": "", "description": "经过刻苦的训练，ZHY 终于成为了一名说唱歌手。但这天，说唱歌手 ZHY 看到了同行说唱组合 Migos 的作品，立刻意识到了自己的差距，于是他要学习 Migos 的说唱技巧，复刻 Migos 的成功。\n\n经过数个日夜的研究，ZHY 最终挑选出了 $n$ 部 Migos 的说唱作品，依次编号为 $1,2,\\dots,n$。他认为只要学习完这 $n$ 部作品，就可以成为更加优秀的说唱歌手。于是，他会从第 $1$ 部作品，按编号从小到大的顺序依次进行学习，学习完第 $n$ 部作品就结束学习。\n\n不过，说唱歌手 ZHY 的学习方式很特殊。对于每部作品，他只会听 $1$ 分钟。这种学习方式的问题是，对于第 $i$ 部作品，他在投入 $1$ 分钟后，有可能学习成功，也有可能会失败，具体地，如果 ZHY 学习的是作品 $i$，那么在他花一分钟的时间进行学习后：\n\n- 有 $P_i$ 的概率，ZHY 学习成功了，那么他会接着去学习作品 $i+1$（当然如果 $i=n$ 就直接结束学习）。\n- 有 $1-P_i$ 的概率，ZHY 学习失败了。不幸的是，ZHY 脑内的记忆还会因此产生混乱，导致他只会记住前 $x_i$ 部作品，即他必须从第 $x_i+1$ 部作品开始重新学习。\n\nZHY 在尝试了几次学习后，深受记忆混乱的困扰，于是向脑科学专家 YHZ 求助。经过脑科学专家 YHZ 的研究，他发现所有的 $x_i$ 有一定的规律。具体地，他发现有 $m$ 对自然数 $(l_i,r_i)$, 其中 $i=1,2\\dots,m$，满足 $0\\leq l_i<r_i\\leq n$，那么 $x_i=\\max\\limits_{j=1}^m\\{l_j\n\\mid l_j+1\\leq i\\leq r_j\\}$，特别地，如果对于所有 $1\\leq j\\leq m$，都**不满足** $l_j+1\\leq i\\leq r_j$，那么 $x_i=0$。\n\n现在，ZHY 对自己的学习能力有了充分了解，但刚才的尝试让他疲惫不堪，所以他决定休息 $1$ 秒，并希望你帮他计算一下他期望多少分钟可以结束学习。不过他意识到，自己如果每部作品只学固定的 $1$ 分钟是不够全面的，所以他决定更改一些作品他所会学习的那一分钟，这会导致他学习这一部作品的成功概率发生改变。具体地，现在 ZHY 提出了 $k$ 个要求，每个要求有两种可能：\n\n1. 修改某个作品 $i$ 学习成功的概率 $P_i$。\n1. 询问以当前的概率他学习完 $n$ 部作品期望要多少分钟。\n\n由于 ZHY 要休息，所以他找上了你，希望你来解决他的要求。对于他的每个第二种要求，你要告诉他期望时间对 $10^9+7$ 取模的结果。ZHY 给了你 $1$ 秒的时间，因为他只能休息这么久。", "inputFormat": "第一行三个整数 $n,m,k$。意思如题面所述。\n\n接下来 $n$ 行，每行两个正整数 $p_i,q_i$，表示 $P_i=\\frac{p_i}{q_i}$。\n\n接下来 $m$ 行，每行两个整数 $l_{i},r_{i}$。\n\n接下来 $k$ 行，每行都是以下两种格式的其中一种：\n\n- `1 x a b` 为修改操作。表示 $P_x$ 变成了 $\\frac a b$。保证 $1\\le x \\le n$，$1 \\le a \\le b < 10^9+7$ 且 $x,a,b$ 均为正整数。\n\n- `2` 为查询操作。表示询问此时结束学习的期望时间是多少。对 $10^9+7$ 取模。", "outputFormat": "对于每个询问，输出一行一个整数表示答案。", "hint": "**本题使用捆绑测试。**\n\n| Subtask 编号 | $n$ | $m$ | $k$ | 特殊性质 |分值 |\n| :-----: | :-----: | :-----: | :-----: | :-----: | :-----: |\n| $0$ | $\\le 300$ | $\\le 300$ | $\\le 300$ | 无 | $11$ |\n| $1$ | $\\le 3000$ | $\\le 3000$ | $\\le 3000$ | 无 | $4$ |\n| $2$ | $\\le 10^5$ | $\\le 10^5$ | $\\le 1$ | B | $5$ |\n| $3$ | $\\le 10^5$ | $\\le 10^5$ | $\\le 1$ | 无 | $14$ |\n| $4$ | $\\le 10^5$ | $=0$ | $\\le 10^5$ | 无 | $19$ |\n| $5$ | $\\le 10^5$ | $\\le 10^5$ | $\\le 10^5$ | A | $19$ |\n| $6$ | $\\le 10^5$ | $\\le 10^5$ | $\\le 10^5$ | B | $8$ |\n| $7$ | $\\le 10^5$ | $\\le 10^5$ | $\\le 10^5$ | C | $10$ |\n| $8$ | $\\le 10^5$ | $\\le 10^5$ | $\\le 10^5$ | 无 | $10$ |\n\n以下的“区间”均指 $[l_i,r_i]$。\n\n特殊性质 A：保证对于 $\\forall i \\in [1,m]$，$r_i-l_i+1\\le 5$。\n\n特殊性质 B：保证这些区间两两的交 $\\le 1$。即对于 $\\forall i,j \\in [1,m]$ 且 $i\\ne j$，有 $r_i\\le l_j$ 或 $r_j\\le l_i$。\n\n特殊性质 C：保证这些区间不存在包含关系。即对于 $\\forall i,j \\in [1,m]$ 且 $i\\ne j$，有 $l_i>l_j$ 或 $r_i<r_j$。\n\n对于 $100\\%$ 的数据，$1 \\le n,k \\le 10^5$，$0 \\le m \\le 10^5$，$1 \\le p_{i} \\le q_{i} \\lt 10^{9}+7$，$0 \\le l_{i} \\lt r_{i} \\le n$。", "locale": "zh-CN"}}}
{"pid": "P10257", "type": "P", "difficulty": 2, "samples": [["2\na 3 4 0 3\nb 2 5 1 1\n1 2", "5 7\n..bbbbb\n..bbbbb\naaaa...\naaaa...\naaaa..."], ["2\na 3 4 0 3\nb 2 5 1 1\n2 1", "4 9\n.....aaaa\n.....aaaa\nbbbbbaaaa\nbbbbb...."], ["4\ng 9 5 0 2\na 3 2 1 1\nc 5 10 0 2\np 8 7 1 6\n4 3 2 1", "18 17\n..........ggggg..\n..........ggggg..\n..........ggggg..\n..........ggggg..\n..........ggggg..\n..........ggggg..\n..........ggggg..\n..........ggggg..\n........aaggggg..\n........aa.......\nppppppp.aa.......\npppppppcccccccccc\npppppppcccccccccc\npppppppcccccccccc\npppppppcccccccccc\npppppppcccccccccc\nppppppp..........\nppppppp.........."]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["模拟", "2023", "COCI（克罗地亚）"], "title": "[COCI 2023/2024 #5] Zlagalica", "background": "**译自 [COCI 2023/2024 Contest #5](https://hsin.hr/coci/archive/2023_2024) T1「[Zlagalica](https://hsin.hr/coci/archive/2023_2024/contest5_tasks.pdf)」**", "description": "Little Maja 喜欢拼图。既然大家都已经认识她很久了，那么一定不会对 Maja 在一个晴朗的日子里，收到一份奇怪的拼图作为礼物感到惊讶。\n\n这个拼图由 $n$ 片组成。每片拼图的形状都是矩形，并具有一定的颜色。同时，每片拼图的背面都写着 $u$ 和 $d$ 两个数字。在精心尝试了一段时间后，Maja 发现了这些数字的含义。\n\n她发现数字 $u$ 表示**方向**，换句话说，描述了下一块拼图从上侧还是从右侧连接这一块拼图。数字 $d$ 表示下一块拼图连接这一块拼图的起点行/列。更具体地：\n\n- 如果 $u=0$，我们通过将下一块拼图左下角放在当前拼图上边的第 $d$ 列，将下一块拼图拼接在当前拼图的上方。\n\n- 如果 $u=1$，我们通过将下一块拼图左下角放在当前拼图右边的第 $d$ 行，将下一块拼图拼接在当前拼图的右边。\n\n假设有颜色分别为 `a` 和 `b` 的两块拼图。图一展示了 $u=0,d=3$ 时的拼接情况；图二展示了 $u=1,d=3$ 时的拼接情况（这里的 $u,d$ 均写在颜色为 `a` 的拼图上）\n\n| 图一 | 图二 |\n|:--:|:--:\n|![](https://cdn.luogu.com.cn/upload/image_hosting/b6c7t1e9.png)| ![](https://cdn.luogu.com.cn/upload/image_hosting/sxahll4p.png)|\n\nMaja 已经厌烦了这个拼图，但是她的好奇心是无限的。这正是她寻求你帮助的原因。她想知道，给出全部的拼图信息，以及拼装它们的顺序序列，最终拼图是什么样的？编写程序输出一个长方形字符矩阵，恰好包含最终拼图的样子，用 `.` 表示这里没有拼图。\n\n\n", "inputFormat": "输入的第一行包含一个整数 $n$（$1 \\le n \\le 20$），表示拼图的数目。\n\n接下来 $n$ 行，第 $i$ 行包含一个字符和四个整数 $b_i,r_i,s_i,u_i,d_i$，描述了第 $i$ 块拼图：\n\n- $b_i$ 是一个小写英文字母，表示第 $i$ 块拼图的颜色。\n- $r_i,s_i$（$1 \\le r_i,s_i \\le 10$）依次表示第 $i$ 块拼图行与列的长度。\n- $u_i,d_i$（$0 \\le u_i \\le 1$，$1 \\le d_i \\le r_i,s_i$（与 $u_i$ 有关））表示第 $i$ 块拼图背面的数字，含义如题所述。\n\n最后一行包含 $n$ 个整数，表示拼图拼接的顺序。其中数字 $i$ 表示第 $i$ 块输入的拼图。保证每块拼图在序列中出现且仅出现一次。", "outputFormat": "第一行输出完成的拼图的高度与宽度。\n\n接下来若干行，输出拼图，不属于拼图的位置用 `.` 替代。", "hint": "### 子任务\n\n| Subtask | Points | Constraints |\n| :--: | :--: | :--: |\n| 1 | 17 | 拼图拼接的顺序与输入相同 |\n| 2 | 12 | 对于所有拼图，$u=0$ |\n| 3 | 12 | 对于所有拼图，$u=1$ |\n| 4 | 9 | 无额外限制 |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2023/2024 #5] Zlagalica", "background": "**译自 [COCI 2023/2024 Contest #5](https://hsin.hr/coci/archive/2023_2024) T1「[Zlagalica](https://hsin.hr/coci/archive/2023_2024/contest5_tasks.pdf)」**", "description": "Little Maja 喜欢拼图。既然大家都已经认识她很久了，那么一定不会对 Maja 在一个晴朗的日子里，收到一份奇怪的拼图作为礼物感到惊讶。\n\n这个拼图由 $n$ 片组成。每片拼图的形状都是矩形，并具有一定的颜色。同时，每片拼图的背面都写着 $u$ 和 $d$ 两个数字。在精心尝试了一段时间后，Maja 发现了这些数字的含义。\n\n她发现数字 $u$ 表示**方向**，换句话说，描述了下一块拼图从上侧还是从右侧连接这一块拼图。数字 $d$ 表示下一块拼图连接这一块拼图的起点行/列。更具体地：\n\n- 如果 $u=0$，我们通过将下一块拼图左下角放在当前拼图上边的第 $d$ 列，将下一块拼图拼接在当前拼图的上方。\n\n- 如果 $u=1$，我们通过将下一块拼图左下角放在当前拼图右边的第 $d$ 行，将下一块拼图拼接在当前拼图的右边。\n\n假设有颜色分别为 `a` 和 `b` 的两块拼图。图一展示了 $u=0,d=3$ 时的拼接情况；图二展示了 $u=1,d=3$ 时的拼接情况（这里的 $u,d$ 均写在颜色为 `a` 的拼图上）\n\n| 图一 | 图二 |\n|:--:|:--:\n|![](https://cdn.luogu.com.cn/upload/image_hosting/b6c7t1e9.png)| ![](https://cdn.luogu.com.cn/upload/image_hosting/sxahll4p.png)|\n\nMaja 已经厌烦了这个拼图，但是她的好奇心是无限的。这正是她寻求你帮助的原因。她想知道，给出全部的拼图信息，以及拼装它们的顺序序列，最终拼图是什么样的？编写程序输出一个长方形字符矩阵，恰好包含最终拼图的样子，用 `.` 表示这里没有拼图。\n\n\n", "inputFormat": "输入的第一行包含一个整数 $n$（$1 \\le n \\le 20$），表示拼图的数目。\n\n接下来 $n$ 行，第 $i$ 行包含一个字符和四个整数 $b_i,r_i,s_i,u_i,d_i$，描述了第 $i$ 块拼图：\n\n- $b_i$ 是一个小写英文字母，表示第 $i$ 块拼图的颜色。\n- $r_i,s_i$（$1 \\le r_i,s_i \\le 10$）依次表示第 $i$ 块拼图行与列的长度。\n- $u_i,d_i$（$0 \\le u_i \\le 1$，$1 \\le d_i \\le r_i,s_i$（与 $u_i$ 有关））表示第 $i$ 块拼图背面的数字，含义如题所述。\n\n最后一行包含 $n$ 个整数，表示拼图拼接的顺序。其中数字 $i$ 表示第 $i$ 块输入的拼图。保证每块拼图在序列中出现且仅出现一次。", "outputFormat": "第一行输出完成的拼图的高度与宽度。\n\n接下来若干行，输出拼图，不属于拼图的位置用 `.` 替代。", "hint": "### 子任务\n\n| Subtask | Points | Constraints |\n| :--: | :--: | :--: |\n| 1 | 17 | 拼图拼接的顺序与输入相同 |\n| 2 | 12 | 对于所有拼图，$u=0$ |\n| 3 | 12 | 对于所有拼图，$u=1$ |\n| 4 | 9 | 无额外限制 |", "locale": "zh-CN"}}}
{"pid": "P10258", "type": "P", "difficulty": 4, "samples": [["3\n0 1 2\n1 2 3", "2\n1 3\n0 1"], ["3\n4 8 31\n0 4 8", "5\n31 30\n30 28\n28 24\n24 16\n16 0"], ["5\n0 1 2 4 5\n7 6 5 3 2", "9\n1 3\n3 7\n0 1\n1 0\n2 6\n0 2\n7 3\n5 7\n4 5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2023", "Special Judge", "位运算", "构造", "COCI（克罗地亚）"], "title": "[COCI 2023/2024 #5] Bitovi", "background": "**译自 [COCI 2023/2024 Contest #5](https://hsin.hr/coci/archive/2023_2024) T2「[Bitovi](https://hsin.hr/coci/archive/2023_2024/contest5_tasks.pdf)」**", "description": "哪个先出现，鸡还是蛋？作为一个百万富翁活上一百年好，还是贫穷中度过七天好？如何成为国际象棋大师？如何拉起百叶窗？如何通过期末考试？如何训练龙？这些都是一些有趣的问题，我们可以在竞赛结束后再去思考，但现在我们提出一个不那么有趣的计算机科学问题。\n\n给定两组数集 $A$ 和 $B$，大小均为 $N$。每次操作，你可以从集合 $A$ 中选择一个任意元素，并改变其二进制表示中的一个任意数位。结果数不能是改变前集合 $A$ 中的元素。\n\n例如，数字 $5$ 的二进制是 $0101_2$。通过一次操作，它可以变成 $13=1101_2$、$1=0001_2$、$7=0111_2$ 或 $4=0100_2$。\n\n确定一系列操作，通过这些操作集合 $A$ 变得和集合 $B$ 相等。如果两个集合大小相同，并且集合 $A$ 中没有不属于集合 $B$ 的元素，则认为两个集合是相等的。\n\n注意：操作的数量不必是最小的，但必须满足任务的限制。", "inputFormat": "第一行包含一个整数 $N$（$1 \\le N \\le 2^{15}$），集合 $A$ 和 $B$ 的大小。\n\n第二行包含 $N$ 个不同的整数 $a_i$（$0 \\le a_i < 2^{15}$），表示集合 $A$ 的元素。\n\n第二行包含 $N$ 个不同的整数 $b_i$（$0 \\le b_i < 2^{15}$），表示集合 $B$ 的元素。", "outputFormat": "第一行输出操作的数目，不超过 $2^{19}$。\n\n接下来若干行，每行输出 $x,y$（$0 \\le x, y < 2^{15}$），表示将集合 $A$ 中的 $x$ 修改为 $y$。$x$ 和 $y$ 在二进制位中只能有一位不同。并且，必须满足 $x\\in A$，$y\\not \\in A$。", "hint": "### 样例解释 1\n\n如果我们先操作 $0\\ 1$，再操作 $1\\ 3$，两次操作间，集合 $A$ 将有两个相同的元素，这是不被允许的。另一种可能的方案是 $2\\ 3$，$0\\ 2$。\n\n### 样例解释 2\n\n$31=11111_2$。按照从最低有效位到最高有效位修改，依次可以得到 $30,28,24,16$ 和 $0$。在所有的操作后，$A$ 和 $B$ 相同。\n\n### 子任务\n\n| Subtask | Points | Constraints |\n| :--: | :--: | :--: |\n| 1 | 10 | $a_i,b_i \\le 2^{14}$ |\n| 2 | 15 | $N \\le 7$ | \n| 3 | 30 | $N \\le 2^7$ |\n| 4 | 15 | 无额外限制 |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2023/2024 #5] Bitovi", "background": "**译自 [COCI 2023/2024 Contest #5](https://hsin.hr/coci/archive/2023_2024) T2「[Bitovi](https://hsin.hr/coci/archive/2023_2024/contest5_tasks.pdf)」**", "description": "哪个先出现，鸡还是蛋？作为一个百万富翁活上一百年好，还是贫穷中度过七天好？如何成为国际象棋大师？如何拉起百叶窗？如何通过期末考试？如何训练龙？这些都是一些有趣的问题，我们可以在竞赛结束后再去思考，但现在我们提出一个不那么有趣的计算机科学问题。\n\n给定两组数集 $A$ 和 $B$，大小均为 $N$。每次操作，你可以从集合 $A$ 中选择一个任意元素，并改变其二进制表示中的一个任意数位。结果数不能是改变前集合 $A$ 中的元素。\n\n例如，数字 $5$ 的二进制是 $0101_2$。通过一次操作，它可以变成 $13=1101_2$、$1=0001_2$、$7=0111_2$ 或 $4=0100_2$。\n\n确定一系列操作，通过这些操作集合 $A$ 变得和集合 $B$ 相等。如果两个集合大小相同，并且集合 $A$ 中没有不属于集合 $B$ 的元素，则认为两个集合是相等的。\n\n注意：操作的数量不必是最小的，但必须满足任务的限制。", "inputFormat": "第一行包含一个整数 $N$（$1 \\le N \\le 2^{15}$），集合 $A$ 和 $B$ 的大小。\n\n第二行包含 $N$ 个不同的整数 $a_i$（$0 \\le a_i < 2^{15}$），表示集合 $A$ 的元素。\n\n第二行包含 $N$ 个不同的整数 $b_i$（$0 \\le b_i < 2^{15}$），表示集合 $B$ 的元素。", "outputFormat": "第一行输出操作的数目，不超过 $2^{19}$。\n\n接下来若干行，每行输出 $x,y$（$0 \\le x, y < 2^{15}$），表示将集合 $A$ 中的 $x$ 修改为 $y$。$x$ 和 $y$ 在二进制位中只能有一位不同。并且，必须满足 $x\\in A$，$y\\not \\in A$。", "hint": "### 样例解释 1\n\n如果我们先操作 $0\\ 1$，再操作 $1\\ 3$，两次操作间，集合 $A$ 将有两个相同的元素，这是不被允许的。另一种可能的方案是 $2\\ 3$，$0\\ 2$。\n\n### 样例解释 2\n\n$31=11111_2$。按照从最低有效位到最高有效位修改，依次可以得到 $30,28,24,16$ 和 $0$。在所有的操作后，$A$ 和 $B$ 相同。\n\n### 子任务\n\n| Subtask | Points | Constraints |\n| :--: | :--: | :--: |\n| 1 | 10 | $a_i,b_i \\le 2^{14}$ |\n| 2 | 15 | $N \\le 7$ | \n| 3 | 30 | $N \\le 2^7$ |\n| 4 | 15 | 无额外限制 |", "locale": "zh-CN"}}}
{"pid": "P10259", "type": "P", "difficulty": 5, "samples": [["4\n", "0 1 4 16\n"]], "limits": {"time": [2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "2023", "组合数学", "COCI（克罗地亚）"], "title": "[COCI 2023/2024 #5] Piratski kod", "background": "**译自 [COCI 2023/2024 Contest #5](https://hsin.hr/coci/archive/2023_2024) T3「[Piratski kod](https://hsin.hr/coci/archive/2023_2024/contest5_tasks.pdf)」**", "description": "Marrrtina 船长和她的海盗团队，在搜索了三个月之后，终于挖掘出一箱属于最著名的意大利海盗的失落宝藏。但是，要打开这个宝箱，她需要一个密码，该密码被描述在宝箱旁边的一个瓶子中的一条信息中。\n\n信息如下：\n\n---\n\n只有最有价值的海盗才能打开宝箱，密码是以下谜题的答案：对于长度为 $a$ 的二进制序列 $s$，且其中唯一的连续两个 $1$ 位于序列的末尾，如果满足以下条件，它是一个数字 $x$​ 的海盗表示：\n$$\ns[0]\\cdot \\text{Fib}[2] + s[1]\\cdot \\text{Fib}[3] + s[2]\\cdot \\text{Fib}[4] + \\ldots + s[a − 2]\\cdot \\text{Fib}[a] = \\sum_{i=0}^{a-2} s[i]\\cdot \\text{Fib}[2 + i] = x\n$$\n这里的 $\\text{Fib}[x]$ 表示第 $x$ 个斐波那契数。斐波那契数的定义如下：$\\text{Fib}[1] = 1$，$\\text{Fib}[2] = 1$，对于每个 $y > 2$，$\\text{Fib}[y] = \\text{Fib}[y − 1] + \\text{Fib}[y − 2]$。\n\n例如，$11_p = 1$，$011_p = 2$，$1010011_p = 17$，这里的 $p$ 表示数字的海盗表示。\n\n海盗代码是一个二进制序列（没有关于连续 $1$ 的任何条件），代表一系列正整数的序列。为了阅读它，我们将其分割为尽可能多的部分，这些部分是某些数字的海盗表示（可能还有一个不是任何数字的海盗表示的后缀），并按顺序写出这些整数。例如，我们将 $01111010110101$ 分割为 $011|11|01011|0101$，最后一部分不是海盗表示，因此我们删除它，得到 $011|11|01011$，并读到序列 $2,1,7$。\n\n海盗代码的值等于解码后的正整数序列的值之和。前面的密码的值为 $10$。\n\n我最喜欢的数字 $P$ 是长度为 $k$ 的所有海盗代码值的总和。由于该数字可能很大，打开宝箱的密码是 $P$ 除以 $10^9 + 7$ 的余数。\n\n— *Leonarrrdo da Pisa*\n\n---\n\n如果 Marrrtina 无法打开宝箱，她的船员将认为她不值得信任，并将她逼上走板。", "inputFormat": "一行一个整数 $n\\ (n\\le 5\\ 000)$。", "outputFormat": "输出一行 $n$ 个整数，其中第 $k$ 个整数表示长度为 $k$ 的密码谜题的答案。", "hint": "### 样例解释 1\n\n长度为 $1$ 的代码是 $0$ 和 $1$，它们的值都是 $0$。\n\n代码 $11$ 的值为 $1$，其余所有长度为 $2$ 的代码值都是 $0$。\n\n代码 $1111$ 的值为 $2$，$0011$ 的值为 $3$。\n\n### 子任务\n\n| Subtask | Points | Constraints |\n| :--: | :--: | :--: |\n| 1 | 20 | $n=20$ |\n| 2 | 40 | $n=300$ |\n| 3 | 50 | $n=5000$ |\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2023/2024 #5] Piratski kod", "background": "**译自 [COCI 2023/2024 Contest #5](https://hsin.hr/coci/archive/2023_2024) T3「[Piratski kod](https://hsin.hr/coci/archive/2023_2024/contest5_tasks.pdf)」**", "description": "Marrrtina 船长和她的海盗团队，在搜索了三个月之后，终于挖掘出一箱属于最著名的意大利海盗的失落宝藏。但是，要打开这个宝箱，她需要一个密码，该密码被描述在宝箱旁边的一个瓶子中的一条信息中。\n\n信息如下：\n\n---\n\n只有最有价值的海盗才能打开宝箱，密码是以下谜题的答案：对于长度为 $a$ 的二进制序列 $s$，且其中唯一的连续两个 $1$ 位于序列的末尾，如果满足以下条件，它是一个数字 $x$​ 的海盗表示：\n$$\ns[0]\\cdot \\text{Fib}[2] + s[1]\\cdot \\text{Fib}[3] + s[2]\\cdot \\text{Fib}[4] + \\ldots + s[a − 2]\\cdot \\text{Fib}[a] = \\sum_{i=0}^{a-2} s[i]\\cdot \\text{Fib}[2 + i] = x\n$$\n这里的 $\\text{Fib}[x]$ 表示第 $x$ 个斐波那契数。斐波那契数的定义如下：$\\text{Fib}[1] = 1$，$\\text{Fib}[2] = 1$，对于每个 $y > 2$，$\\text{Fib}[y] = \\text{Fib}[y − 1] + \\text{Fib}[y − 2]$。\n\n例如，$11_p = 1$，$011_p = 2$，$1010011_p = 17$，这里的 $p$ 表示数字的海盗表示。\n\n海盗代码是一个二进制序列（没有关于连续 $1$ 的任何条件），代表一系列正整数的序列。为了阅读它，我们将其分割为尽可能多的部分，这些部分是某些数字的海盗表示（可能还有一个不是任何数字的海盗表示的后缀），并按顺序写出这些整数。例如，我们将 $01111010110101$ 分割为 $011|11|01011|0101$，最后一部分不是海盗表示，因此我们删除它，得到 $011|11|01011$，并读到序列 $2,1,7$。\n\n海盗代码的值等于解码后的正整数序列的值之和。前面的密码的值为 $10$。\n\n我最喜欢的数字 $P$ 是长度为 $k$ 的所有海盗代码值的总和。由于该数字可能很大，打开宝箱的密码是 $P$ 除以 $10^9 + 7$ 的余数。\n\n— *Leonarrrdo da Pisa*\n\n---\n\n如果 Marrrtina 无法打开宝箱，她的船员将认为她不值得信任，并将她逼上走板。", "inputFormat": "一行一个整数 $n\\ (n\\le 5\\ 000)$。", "outputFormat": "输出一行 $n$ 个整数，其中第 $k$ 个整数表示长度为 $k$ 的密码谜题的答案。", "hint": "### 样例解释 1\n\n长度为 $1$ 的代码是 $0$ 和 $1$，它们的值都是 $0$。\n\n代码 $11$ 的值为 $1$，其余所有长度为 $2$ 的代码值都是 $0$。\n\n代码 $1111$ 的值为 $2$，$0011$ 的值为 $3$。\n\n### 子任务\n\n| Subtask | Points | Constraints |\n| :--: | :--: | :--: |\n| 1 | 20 | $n=20$ |\n| 2 | 40 | $n=300$ |\n| 3 | 50 | $n=5000$ |\n", "locale": "zh-CN"}}}
{"pid": "P10260", "type": "P", "difficulty": 5, "samples": [["3 2 5 1\n2 2 4\n3\n2 0 1\n", "4 14 9\n"], ["2 3 4 0\n3 1\n3\n3 2 0\n", "0 3 10\n"], ["4 3 10 3\n2 4 5 6\n3\n4 3 0\n", "9 18 47\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["二分", "2023", "三分", "COCI（克罗地亚）", "决策单调性"], "title": "[COCI 2023/2024 #5] Rolete", "background": "**译自 [COCI 2023/2024 Contest #5](https://hsin.hr/coci/archive/2023_2024) T4「[Rolete](https://hsin.hr/coci/archive/2023_2024/contest5_tasks.pdf)」**", "description": "一个周六的下午，Luka 从午睡中醒来，想起今天有 COCI！在比赛前，他只需要做一件事情：拉起窗帘。\n\n卢卡的房间里有 $n$ 个窗帘，其中第 $i$ 个窗帘距离窗户顶部下降了 $a_i$ 厘米。他可以通过两种方式拉起窗帘：\n\n- 他可以手动开始拉起任意一个窗帘。使用这种方法，他每拉起 $1$ 厘米需要 $t$ 秒钟。\n- 他可以按下一个按钮，同时以相同的速度将所有窗帘同步拉起。\n\n按下按钮时，窗帘的上升速度定义如下：如果所有窗帘都在上升，每个窗帘都会在 $s$ 秒内上升 $1$ 厘米。如果 $r$ 个窗帘已经完全升起，这会减慢系统的速度。那么剩余的窗帘每上升 $1$ 厘米需要 $s + k \\cdot r$ 秒钟。\n\nCOCI 即将开始，Luka 希望尽快拉起他的窗帘。与此同时，他的兄弟 Marin 走进房间，问了他 $q$ 个问题：**为了使窗帘下降的最大高度不超过 $h$ 厘米，你需要的最短时间是多少**？Marin 对于每个问题都考虑窗帘的初始状态。\n\n他们意识到在 COCI 之前没有足够的时间来考虑这个问题。幸运的是，这个问题也出现在这里！帮助他们解决它！\n\n注意：Luka 总是将窗帘拉起一个整数值的厘米。", "inputFormat": "第一行四个整数 $n,t,s,k\\ (1\\le n,t,s\\le 10^5,0\\le k\\le 10^5)$，分别表示窗帘个数，手动拉窗帘所需的时间，按下按钮拉窗帘所需的时间和同步上升的减慢因子。\n\n第二行包含 $n$ 个整数 $a_i\\ (0\\le a_i\\le 10^5)$，表示初始窗帘的状态。\n\n第三行包含一个整数 $q\\ (1\\le q\\le 10^5)$，表示问题个数。\n\n第四行包含 $q$ 个整数 $h_i\\ (0\\le h_i\\le 10^5)$，表示最大窗帘高度。", "outputFormat": "输出一行 $q$ 个整数，第 $i$ 个表示使得窗帘下降的最大高度不超过 $h_i$ 厘米所需的最短用时。", "hint": "### 样例解释 1\n\n为了使所有窗帘的下降高度最多为 $2$ 厘米，卢卡需要手动将第三个窗帘拉起 $2$ 厘米。最快的方法是手动拉起它，这将花费他 $4$ 秒钟。\n\n如果所有窗帘都需要完全拉起，卢卡可以先手动将第三个窗帘拉起 $2$ 厘米。然后，他可以按下按钮，让所有窗帘同时上升 $2$ 厘米。总共需要的时间为 $4 + 10 = 14$ 秒。\n\n类似地，如果窗帘的下降高度最多为 $1$ 厘米，卢卡会先手动将第三个窗帘拉起 $2$ 厘米，然后将所有窗帘一起上升 $1$ 厘米。拉起的总时间将为 $9$ 秒。\n\n### 子任务\n\n| Subtask | Points | Constraints |\n| :--: | :--: | :--: |\n| 1 | 16 | $n,q,a_i,h_i\\le 100$ |\n| 2 | 26 | $k=0$ |\n| 3 | 32 | $q=1$ |\n| 4 | 36 | 无额外限制 |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2023/2024 #5] Rolete", "background": "**译自 [COCI 2023/2024 Contest #5](https://hsin.hr/coci/archive/2023_2024) T4「[Rolete](https://hsin.hr/coci/archive/2023_2024/contest5_tasks.pdf)」**", "description": "一个周六的下午，Luka 从午睡中醒来，想起今天有 COCI！在比赛前，他只需要做一件事情：拉起窗帘。\n\n卢卡的房间里有 $n$ 个窗帘，其中第 $i$ 个窗帘距离窗户顶部下降了 $a_i$ 厘米。他可以通过两种方式拉起窗帘：\n\n- 他可以手动开始拉起任意一个窗帘。使用这种方法，他每拉起 $1$ 厘米需要 $t$ 秒钟。\n- 他可以按下一个按钮，同时以相同的速度将所有窗帘同步拉起。\n\n按下按钮时，窗帘的上升速度定义如下：如果所有窗帘都在上升，每个窗帘都会在 $s$ 秒内上升 $1$ 厘米。如果 $r$ 个窗帘已经完全升起，这会减慢系统的速度。那么剩余的窗帘每上升 $1$ 厘米需要 $s + k \\cdot r$ 秒钟。\n\nCOCI 即将开始，Luka 希望尽快拉起他的窗帘。与此同时，他的兄弟 Marin 走进房间，问了他 $q$ 个问题：**为了使窗帘下降的最大高度不超过 $h$ 厘米，你需要的最短时间是多少**？Marin 对于每个问题都考虑窗帘的初始状态。\n\n他们意识到在 COCI 之前没有足够的时间来考虑这个问题。幸运的是，这个问题也出现在这里！帮助他们解决它！\n\n注意：Luka 总是将窗帘拉起一个整数值的厘米。", "inputFormat": "第一行四个整数 $n,t,s,k\\ (1\\le n,t,s\\le 10^5,0\\le k\\le 10^5)$，分别表示窗帘个数，手动拉窗帘所需的时间，按下按钮拉窗帘所需的时间和同步上升的减慢因子。\n\n第二行包含 $n$ 个整数 $a_i\\ (0\\le a_i\\le 10^5)$，表示初始窗帘的状态。\n\n第三行包含一个整数 $q\\ (1\\le q\\le 10^5)$，表示问题个数。\n\n第四行包含 $q$ 个整数 $h_i\\ (0\\le h_i\\le 10^5)$，表示最大窗帘高度。", "outputFormat": "输出一行 $q$ 个整数，第 $i$ 个表示使得窗帘下降的最大高度不超过 $h_i$ 厘米所需的最短用时。", "hint": "### 样例解释 1\n\n为了使所有窗帘的下降高度最多为 $2$ 厘米，卢卡需要手动将第三个窗帘拉起 $2$ 厘米。最快的方法是手动拉起它，这将花费他 $4$ 秒钟。\n\n如果所有窗帘都需要完全拉起，卢卡可以先手动将第三个窗帘拉起 $2$ 厘米。然后，他可以按下按钮，让所有窗帘同时上升 $2$ 厘米。总共需要的时间为 $4 + 10 = 14$ 秒。\n\n类似地，如果窗帘的下降高度最多为 $1$ 厘米，卢卡会先手动将第三个窗帘拉起 $2$ 厘米，然后将所有窗帘一起上升 $1$ 厘米。拉起的总时间将为 $9$ 秒。\n\n### 子任务\n\n| Subtask | Points | Constraints |\n| :--: | :--: | :--: |\n| 1 | 16 | $n,q,a_i,h_i\\le 100$ |\n| 2 | 26 | $k=0$ |\n| 3 | 32 | $q=1$ |\n| 4 | 36 | 无额外限制 |", "locale": "zh-CN"}}}
{"pid": "P10261", "type": "P", "difficulty": 5, "samples": [["3\n3\n4\n5\n", "Lucija\nLucija\nIvan\n"], ["3\n7\n8\n9\n", "Lucija\nLucija\nIvan\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2023", "COCI（克罗地亚）"], "title": "[COCI 2023/2024 #5] Trokut", "background": "**译自 [COCI 2023/2024 Contest #5](https://hsin.hr/coci/archive/2023_2024) T5「[Trokut](https://hsin.hr/coci/archive/2023_2024/contest5_tasks.pdf)」**", "description": "Ivan 和 Lucija 正在一次遥远的旅程中。他们知道旅程将持续很长时间，而且在某个时候他们会感到无聊。当他们在考虑做什么时，Lucija 想到了一个游戏。\n\n她在纸上画了 $N$ 个点，使它们形成一个正 $N$ 边形的顶点，并按顺序标记为 $1$ 到 $N$。轮到的玩家选择两个点，满足连接这两个点的线段不与先前画的任何线段相交，并连接这两个点。线段可以在顶点处相接触。如果在玩家的回合后存在三条连接的线段形成一个三角形，即存在三个点，它们都通过已画的线段相连，则该玩家获胜。当然，玩家可以连接相邻的顶点，这些线段也可以用于形成三角形。玩家轮流进行，Lucija 先手。\n\n两位玩家都非常熟练，我们知道他们会采用最优策略进行游戏。你的任务是确定给定 $N$ 时，谁将成为游戏的赢家。可以证明游戏将在有限次移动后结束，而且总会产生一个赢家。", "inputFormat": "第一行一个整数 $T\\ (1\\le T\\le 10\\ 000)$，表示场景数。\n\n接下来 $T$ 行，每行一个整数 $N\\ (3\\le N\\le 10^9)$，表示 Lucija 在纸上画的点数。", "outputFormat": "输出 $T$ 行，按给定的顺序，对于每个场景输出 `Ivan` 或 `Lucija`，表示该场景中的获胜者。", "hint": "### 样例解释 1\n\n当 $N = 3$ 时，必须连接所有三条可能的线段，Lucija 获胜。\n\n当 $N = 4$ 时，Lucija 可以连接点 $1$ 和点 $3$ 之间的线段。我们看到，在 Ivan 的任何一步之后，Lucija 都可以连接一个三角形并获胜。\n\n### 子任务\n\n| Subtask| Points | Constraints|\n| :--:|:--:|:--:|\n|1|13|$T\\le 18,N\\le 20$|\n|2|36|$T\\le 998,N\\le 1000$\n|3|15|$N\\le 10^5$|\n|4|46|无额外限制|", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2023/2024 #5] Trokut", "background": "**译自 [COCI 2023/2024 Contest #5](https://hsin.hr/coci/archive/2023_2024) T5「[Trokut](https://hsin.hr/coci/archive/2023_2024/contest5_tasks.pdf)」**", "description": "Ivan 和 Lucija 正在一次遥远的旅程中。他们知道旅程将持续很长时间，而且在某个时候他们会感到无聊。当他们在考虑做什么时，Lucija 想到了一个游戏。\n\n她在纸上画了 $N$ 个点，使它们形成一个正 $N$ 边形的顶点，并按顺序标记为 $1$ 到 $N$。轮到的玩家选择两个点，满足连接这两个点的线段不与先前画的任何线段相交，并连接这两个点。线段可以在顶点处相接触。如果在玩家的回合后存在三条连接的线段形成一个三角形，即存在三个点，它们都通过已画的线段相连，则该玩家获胜。当然，玩家可以连接相邻的顶点，这些线段也可以用于形成三角形。玩家轮流进行，Lucija 先手。\n\n两位玩家都非常熟练，我们知道他们会采用最优策略进行游戏。你的任务是确定给定 $N$ 时，谁将成为游戏的赢家。可以证明游戏将在有限次移动后结束，而且总会产生一个赢家。", "inputFormat": "第一行一个整数 $T\\ (1\\le T\\le 10\\ 000)$，表示场景数。\n\n接下来 $T$ 行，每行一个整数 $N\\ (3\\le N\\le 10^9)$，表示 Lucija 在纸上画的点数。", "outputFormat": "输出 $T$ 行，按给定的顺序，对于每个场景输出 `Ivan` 或 `Lucija`，表示该场景中的获胜者。", "hint": "### 样例解释 1\n\n当 $N = 3$ 时，必须连接所有三条可能的线段，Lucija 获胜。\n\n当 $N = 4$ 时，Lucija 可以连接点 $1$ 和点 $3$ 之间的线段。我们看到，在 Ivan 的任何一步之后，Lucija 都可以连接一个三角形并获胜。\n\n### 子任务\n\n| Subtask| Points | Constraints|\n| :--:|:--:|:--:|\n|1|13|$T\\le 18,N\\le 20$|\n|2|36|$T\\le 998,N\\le 1000$\n|3|15|$N\\le 10^5$|\n|4|46|无额外限制|", "locale": "zh-CN"}}}
{"pid": "P10262", "type": "P", "difficulty": 3, "samples": [["2\n102", "5\n"], ["2\n12342", "11"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "GESP"], "title": "[GESP样题 六级] 亲朋数", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1106>", "description": "\n给定一串长度为 $L$、由数字 $0\\sim 9$ 组成的数字串 $S$。容易知道，它的连续子串共有 $\\frac{L(L + 1)}2$ 个。如果某个子串对应的数（允许有前导零）是 $p$ 的倍数，则称该子串为数字串 $S$ 对于 $p$ 的亲朋数。\n\n例如，数字串 $S$ 为“ $12342$ ”、$p$ 为 $2$，则在 $15$ 个连续子串中，亲朋数有“ $12$ ”、“ $1234$ ”、“ $12342$ ”、“ $2$ ”、“ $234$ ”、“ $2342$ ”、“ $34$ ”、“ $342$ ”、“ $4$ ”、“ $42$ ”、“ $2$ ”共 $11$ 个。注意其中“ $2$ ”出现了 $2$ 次，但由于其在 $S$ 中的位置不同，记为不同的亲朋数。\n\n现在，告诉你数字串 $S$ 和正整数 $p$ ，你能计算出有多少个亲朋数吗？", "inputFormat": "输入的第一行，包含一个正整数 $p$。约定 $2 \\leq p \\leq 128$。  \n输入的第二行，包含一个长为 $L$ 的数字串 $S$。约定 $1 \\leq L \\leq 10^6$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "## 样例 1 解释\n\n$5$ 个亲朋数，分别 $10$、$102$、$0$、$02$、$2$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[GESP样题 六级] 亲朋数", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1106>", "description": "\n给定一串长度为 $L$、由数字 $0\\sim 9$ 组成的数字串 $S$。容易知道，它的连续子串共有 $\\frac{L(L + 1)}2$ 个。如果某个子串对应的数（允许有前导零）是 $p$ 的倍数，则称该子串为数字串 $S$ 对于 $p$ 的亲朋数。\n\n例如，数字串 $S$ 为“ $12342$ ”、$p$ 为 $2$，则在 $15$ 个连续子串中，亲朋数有“ $12$ ”、“ $1234$ ”、“ $12342$ ”、“ $2$ ”、“ $234$ ”、“ $2342$ ”、“ $34$ ”、“ $342$ ”、“ $4$ ”、“ $42$ ”、“ $2$ ”共 $11$ 个。注意其中“ $2$ ”出现了 $2$ 次，但由于其在 $S$ 中的位置不同，记为不同的亲朋数。\n\n现在，告诉你数字串 $S$ 和正整数 $p$ ，你能计算出有多少个亲朋数吗？", "inputFormat": "输入的第一行，包含一个正整数 $p$。约定 $2 \\leq p \\leq 128$。  \n输入的第二行，包含一个长为 $L$ 的数字串 $S$。约定 $1 \\leq L \\leq 10^6$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "## 样例 1 解释\n\n$5$ 个亲朋数，分别 $10$、$102$、$0$、$02$、$2$。", "locale": "zh-CN"}}}
{"pid": "P10263", "type": "P", "difficulty": 3, "samples": [["2 5 2", "9"], ["100 100 100", "185233"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "2024", "GESP", "调和级数"], "title": "[GESP202403 八级] 公倍数问题", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1148>", "description": "小 A 写了一个 $N \\times M$ 的矩阵 $A$，我们看不到这个矩阵，但我们可以知道，其中第 $i$ 行第 $j$ 列的元素 $A_{i,j}$ 是 $i$ 和 $j$ 的公倍数（$i=1,\\dots,N$，$j=1,\\dots,M$）。现在有 $K$ 个小朋友，其中第 $k$ 个小朋友想知道，矩阵 $A$ 中最多有多少个元素可以是 $k$（$k=1,2,\\dots,K$）。请你帮助这些小朋友求解。\n\n注意：每位小朋友的答案互不相关，例如，有些位置既可能是 $x$，又可能是 $y$，则它同时可以满足 $x,y$ 两名小朋友的要求。\n\n方便起见，你只需要输出 $\\sum_{k=1}^{K}{k \\times \\texttt{ans}_k}$ 即可，其中 $\\texttt{ans}_k$ 表示第 $k$ 名小朋友感兴趣的答案。", "inputFormat": "第一行三个正整数 $N,M,K$。", "outputFormat": "输出一行，即 $\\sum_{k=1}^{K}{k \\times \\texttt{ans}_k}$。\n\n请注意，这个数可能很大，使用 C++ 语言的选手请酌情使用 `long long` 等数据类型存储答案。", "hint": "### 样例 1 解释\n\n只有 $A_{1,1}$ 可以是 $1$，其余都不行。\n\n$A_{1,1},A_{1,2},A_{2,1},A_{2,2}$ 都可以是 $2$，而其余不行。\n\n因此答案是 $1 \\times 1 + 2 \\times 4 = 9$。\n\n### 数据规模\n\n对于 $30\\%$ 的测试点，保证 $N,M,K \\leq 10$；\n\n对于 $60\\%$ 的测试点，保证 $N,M,K \\leq 500$；\n\n对于 $100\\%$ 的测试点，保证 $N,M \\leq 10^5$，$K \\leq 10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[GESP202403 八级] 公倍数问题", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1148>", "description": "小 A 写了一个 $N \\times M$ 的矩阵 $A$，我们看不到这个矩阵，但我们可以知道，其中第 $i$ 行第 $j$ 列的元素 $A_{i,j}$ 是 $i$ 和 $j$ 的公倍数（$i=1,\\dots,N$，$j=1,\\dots,M$）。现在有 $K$ 个小朋友，其中第 $k$ 个小朋友想知道，矩阵 $A$ 中最多有多少个元素可以是 $k$（$k=1,2,\\dots,K$）。请你帮助这些小朋友求解。\n\n注意：每位小朋友的答案互不相关，例如，有些位置既可能是 $x$，又可能是 $y$，则它同时可以满足 $x,y$ 两名小朋友的要求。\n\n方便起见，你只需要输出 $\\sum_{k=1}^{K}{k \\times \\texttt{ans}_k}$ 即可，其中 $\\texttt{ans}_k$ 表示第 $k$ 名小朋友感兴趣的答案。", "inputFormat": "第一行三个正整数 $N,M,K$。", "outputFormat": "输出一行，即 $\\sum_{k=1}^{K}{k \\times \\texttt{ans}_k}$。\n\n请注意，这个数可能很大，使用 C++ 语言的选手请酌情使用 `long long` 等数据类型存储答案。", "hint": "### 样例 1 解释\n\n只有 $A_{1,1}$ 可以是 $1$，其余都不行。\n\n$A_{1,1},A_{1,2},A_{2,1},A_{2,2}$ 都可以是 $2$，而其余不行。\n\n因此答案是 $1 \\times 1 + 2 \\times 4 = 9$。\n\n### 数据规模\n\n对于 $30\\%$ 的测试点，保证 $N,M,K \\leq 10$；\n\n对于 $60\\%$ 的测试点，保证 $N,M,K \\leq 500$；\n\n对于 $100\\%$ 的测试点，保证 $N,M \\leq 10^5$，$K \\leq 10^6$。", "locale": "zh-CN"}}}
{"pid": "P10264", "type": "P", "difficulty": 4, "samples": [["1\n6\n1 2 2 3 1 3\n4\n1 3\n1 6\n1 5\n5 6\n", "1\n1\n0\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["倍增", "2024", "GESP"], "title": "[GESP202403 八级] 接竹竿", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1148>", "description": "小杨同学想用卡牌玩一种叫做“接竹竿”的游戏。\n\n游戏规则是：每张牌上有一个点数 $v$，将给定的牌依次放入一列牌的末端。若放入之前这列牌中已有与这张牌点数相同的牌，则小杨同学会将这张牌和点数相同的牌之间的所有牌全部取出队列（包括这两张牌本身）。\n\n小杨同学现在有一个长度为 $n$ 的卡牌序列 $A$，其中每张牌的点数为 $A_i$（$1\\le i\\le n$）。小杨同学有 $q$ 次询问。第 $i$ 次（$1\\le i\\le q$）询问时，小杨同学会给出 $l_i,r_i$ 小杨同学想知道如果用下标在 $[l_i,r_i]$ 的所有卡牌按照下标顺序玩“接竹竿”的游戏，最后队列中剩余的牌数。", "inputFormat": "一行包含一个正整数 $T$，表示测试数据组数。\n\n对于每组测试数据，第一行包含一个正整数 $n$，表示卡牌序列 $A$ 的长度。\n\n第二行包含 $n$ 个正整数 $A_1,A_2,\\dots,A_n$，表示卡牌的点数 $A$。\n\n第三行包含一个正整数 $q$，表示询问次数。\n\n接下来 $q$ 行，每行两个正整数 $l_i,r_i$ 表示一组询问。", "outputFormat": "对于每组数据，输出 $q$ 行。第 $i$ 行（$1\\le i\\le q$）输出一个非负整数，表示第 $i$ 次询问的答案。", "hint": "**样例解释**\n\n对于第一次询问，小杨同学会按照 $1,2,2$ 的顺序放置卡牌，在放置最后一张卡牌时，两张点数为 $2$ 的卡牌会被收走，因此最后队列中只剩余一张点数为 $1$ 的卡牌。\n\n对于第二次询问，队列变化情况为：\n\n$\\{\\}\\to\\{1\\}\\to\\{1,2\\}\\to\\{1,2,2\\}\\to\\{1\\}\\to\\{1,3\\}\\to\\{1,3,1\\}\\to\\{\\}\\to\\{3\\}$。因此最后队列中只剩余一张点数为 $3$ 的卡牌。\n\n**数据范围**\n\n|子任务|分数|$T$|$n$|$q$|$\\max A_i$|特殊条件| \n|:---:|:---:|:---:|:---:|:---:|:---:|:---:|\n|$1$|$30$|$\\le 5$|$\\le100$|$\\le100$|$\\le13$|\n|$2$|$30$|$\\le 5$|$\\le 1.5\\times10^4$|$\\le 1.5\\times10^4$|$\\le13$|所有询问的右端点等于 $n$\n|$3$|$40$|$\\le 5$|$\\le 1.5\\times10^4$|$\\le 1.5\\times10^4$|$\\le13$|\n\n对于全部数据，保证有 $1\\le T\\le 5$，$1\\le n\\le 1.5\\times 10^4$，$1\\le q\\le 1.5\\times 10^4$，$1\\le A_i\\le 13$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[GESP202403 八级] 接竹竿", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1148>", "description": "小杨同学想用卡牌玩一种叫做“接竹竿”的游戏。\n\n游戏规则是：每张牌上有一个点数 $v$，将给定的牌依次放入一列牌的末端。若放入之前这列牌中已有与这张牌点数相同的牌，则小杨同学会将这张牌和点数相同的牌之间的所有牌全部取出队列（包括这两张牌本身）。\n\n小杨同学现在有一个长度为 $n$ 的卡牌序列 $A$，其中每张牌的点数为 $A_i$（$1\\le i\\le n$）。小杨同学有 $q$ 次询问。第 $i$ 次（$1\\le i\\le q$）询问时，小杨同学会给出 $l_i,r_i$ 小杨同学想知道如果用下标在 $[l_i,r_i]$ 的所有卡牌按照下标顺序玩“接竹竿”的游戏，最后队列中剩余的牌数。", "inputFormat": "一行包含一个正整数 $T$，表示测试数据组数。\n\n对于每组测试数据，第一行包含一个正整数 $n$，表示卡牌序列 $A$ 的长度。\n\n第二行包含 $n$ 个正整数 $A_1,A_2,\\dots,A_n$，表示卡牌的点数 $A$。\n\n第三行包含一个正整数 $q$，表示询问次数。\n\n接下来 $q$ 行，每行两个正整数 $l_i,r_i$ 表示一组询问。", "outputFormat": "对于每组数据，输出 $q$ 行。第 $i$ 行（$1\\le i\\le q$）输出一个非负整数，表示第 $i$ 次询问的答案。", "hint": "**样例解释**\n\n对于第一次询问，小杨同学会按照 $1,2,2$ 的顺序放置卡牌，在放置最后一张卡牌时，两张点数为 $2$ 的卡牌会被收走，因此最后队列中只剩余一张点数为 $1$ 的卡牌。\n\n对于第二次询问，队列变化情况为：\n\n$\\{\\}\\to\\{1\\}\\to\\{1,2\\}\\to\\{1,2,2\\}\\to\\{1\\}\\to\\{1,3\\}\\to\\{1,3,1\\}\\to\\{\\}\\to\\{3\\}$。因此最后队列中只剩余一张点数为 $3$ 的卡牌。\n\n**数据范围**\n\n|子任务|分数|$T$|$n$|$q$|$\\max A_i$|特殊条件| \n|:---:|:---:|:---:|:---:|:---:|:---:|:---:|\n|$1$|$30$|$\\le 5$|$\\le100$|$\\le100$|$\\le13$|\n|$2$|$30$|$\\le 5$|$\\le 1.5\\times10^4$|$\\le 1.5\\times10^4$|$\\le13$|所有询问的右端点等于 $n$\n|$3$|$40$|$\\le 5$|$\\le 1.5\\times10^4$|$\\le 1.5\\times10^4$|$\\le13$|\n\n对于全部数据，保证有 $1\\le T\\le 5$，$1\\le n\\le 1.5\\times 10^4$，$1\\le q\\le 1.5\\times 10^4$，$1\\le A_i\\le 13$。", "locale": "zh-CN"}}}
{"pid": "P10265", "type": "P", "difficulty": 2, "samples": [["6 4\n1 1 0 1 0 0\n0 1 1 0 0 0\n1 0 1 0 0 1\n0 0 1 1 0 1\n0 0 0 1 1 0\n1 0 0 0 1 1", "3 3 6"]], "limits": {"time": [1000, 1000, 1000], "memory": [131072, 131072, 131072]}, "tags": ["图论", "GESP"], "title": "[GESP样题 七级] 迷宫统计", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1107>", "description": "在神秘的幻想⼤陆中，存在着 $n$ 个古老而神奇的迷宫，迷宫编号从 $1$ 到 $n$。有的迷宫之间可以直接往返，有的可以⾛到别的迷宫，但是不能⾛回来。玩家小杨想挑战⼀下不同的迷宫，他决定从 $m$ 号迷宫出发。现在，他需要你帮助他统计：有多少迷宫可以直接到达 $m$ 号迷宫，$m$ 号迷宫可以直接到达其他的迷宫有多少，并求出他们的和。\n\n需要注意的是，对于 $i$ ($1 \\leq i \\leq n$) 号迷宫，它总可以直接到达自身。", "inputFormat": "第一行两个整数 $n$ 和 $m$，分别表示结点迷宫总数，指定出发迷宫的编号。  \n下面 $n$ 行，每行 $n$ 个整数，表示迷宫之间的关系。对于第 $i$ 行第 $j$ 列的整数，$1$ 表示能从 $i$ 号迷宫直接到达 $j$ 号迷宫，$0$ 表示不能直接到达。", "outputFormat": "一行输出空格分隔的三个整数，分别表示迷宫 $m$ 可以直接到达其他的迷宫有多少个，有多少迷宫可以直接到达 $m$ 号迷宫，这些迷宫的总和。", "hint": "### 样例 1 解释\n\n$4$ 号迷宫能直接到达的迷宫有 $3,4,6$ 号迷宫，共 $3$ 个。  \n能直接到达 $4$ 号迷宫的迷宫有 $1,4,5$ 号迷宫，共 $3$ 个。\n\n共 6 个。\n\n### 数据规模与约定\n\n| 子任务| 分值 | $n \\leq $ |\n| :-: | :-: | :-: |\n| $1$ | $30$ | $10$ |\n| $2$ | $30$ | $100$ | \n| $3$ | $40$ | $1000$ |\n\n对全部的测试数据，保证 $1 \\leq m \\leq n \\leq 1000$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[GESP样题 七级] 迷宫统计", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1107>", "description": "在神秘的幻想⼤陆中，存在着 $n$ 个古老而神奇的迷宫，迷宫编号从 $1$ 到 $n$。有的迷宫之间可以直接往返，有的可以⾛到别的迷宫，但是不能⾛回来。玩家小杨想挑战⼀下不同的迷宫，他决定从 $m$ 号迷宫出发。现在，他需要你帮助他统计：有多少迷宫可以直接到达 $m$ 号迷宫，$m$ 号迷宫可以直接到达其他的迷宫有多少，并求出他们的和。\n\n需要注意的是，对于 $i$ ($1 \\leq i \\leq n$) 号迷宫，它总可以直接到达自身。", "inputFormat": "第一行两个整数 $n$ 和 $m$，分别表示结点迷宫总数，指定出发迷宫的编号。  \n下面 $n$ 行，每行 $n$ 个整数，表示迷宫之间的关系。对于第 $i$ 行第 $j$ 列的整数，$1$ 表示能从 $i$ 号迷宫直接到达 $j$ 号迷宫，$0$ 表示不能直接到达。", "outputFormat": "一行输出空格分隔的三个整数，分别表示迷宫 $m$ 可以直接到达其他的迷宫有多少个，有多少迷宫可以直接到达 $m$ 号迷宫，这些迷宫的总和。", "hint": "### 样例 1 解释\n\n$4$ 号迷宫能直接到达的迷宫有 $3,4,6$ 号迷宫，共 $3$ 个。  \n能直接到达 $4$ 号迷宫的迷宫有 $1,4,5$ 号迷宫，共 $3$ 个。\n\n共 6 个。\n\n### 数据规模与约定\n\n| 子任务| 分值 | $n \\leq $ |\n| :-: | :-: | :-: |\n| $1$ | $30$ | $10$ |\n| $2$ | $30$ | $100$ | \n| $3$ | $40$ | $1000$ |\n\n对全部的测试数据，保证 $1 \\leq m \\leq n \\leq 1000$。", "locale": "zh-CN"}}}
{"pid": "P10266", "type": "P", "difficulty": 5, "samples": [["4 5 2\n7 5 4 6 5\n2 4 7 9 5\n6 4 5 3 5\n1 2 3 0 7\n2 4 2\n3 3 2", "7 5 3 5 4\n2 3 5 4 4\n6 3 0 1 4\n1 1 2 0 7"], ["6 7 3\n6 4 7 8 4 6 1\n4 5 4 6 7 5 9\n1 4 3 0 7 1 3\n4 6 0 7 9 0 0\n1 2 3 4 4 5 8\n4 7 6 8 7 4 9\n5 5 3\n2 3 4\n3 6 2", "2 0 0 0 0 5 1 \n0 0 0 0 2 3 8 \n0 0 0 0 1 0 1 \n0 2 0 0 0 0 0 \n0 1 1 0 0 0 7 \n4 7 5 4 3 0 8 "]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["前缀和", "差分"], "title": "高效清理", "background": "清理炸弹设计理念图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mjfmevu2.png)", "description": "真寻的房间太大了，但是作为家里蹲，她又懒得打扫，于是美波里发明了一款清理炸弹给真寻使用。\n\n真寻的房间由 $n$ 行 $m$ 列的方砖组成，第 $i$ 行第 $j$ 列的方砖上的灰尘数量为 $a_{i,j}$。\n\n真寻将会使用 $k$ 次清理炸弹，第 $i$ 次她会在第 $x_i$ 行第 $y_i$ 列的方砖上使用能量值为 $p_i$ 的清理炸弹，这将会使 $(x_i,y_i)$ 的灰尘数量减少 ${p_i}^2$，$(x_i,y_i)$ 外围第一圈的方砖上的灰尘数量减少 $(p_i-1)^2$，外围第二圈的方砖上的灰尘数量减少 $(p_i-2)^2$ $\\cdots$ 外围第 $(p_i-1)$ 圈的方砖上的灰尘数量减少 $1$。\n\n当然，灰尘数量不能为负数，所以若某次操作前，某块方砖上的灰尘数量小于它将要减少的灰尘数量，那么它的灰尘数量将变为 $0$。\n\n请你输出真寻使用完 $k$ 次清理炸弹后，每块方砖上的灰尘数量。", "inputFormat": "第一行三个整数 $n,m,k$，分别表示方砖行数、列数及操作次数；\n\n接下来 $n$ 行，每行 $m$ 个整数，第 $i$ 行第 $j$ 列的整数表示 $a_{i,j}$，描述每一块方砖上的灰尘数量；\n\n接下来 $k$ 行，第 $i$ 行三个整数 $x_i,y_i,p_i$，描述一次操作。", "outputFormat": "共 $n$ 行，每行 $m$ 个整数，第 $i$ 行第 $j$ 列的整数表示方砖 $(i,j)$ 上最终的灰尘数量。", "hint": "**样例** $\\mathbf{1}$ **解释**\n\n第一次操作在方砖 $(2,4)$ 上使用能量值为 $2$ 的“清理炸弹”，使 $(2,4)$ 的灰尘数量减少 $4$，$(1,3),(1,4),(1,5),(2,3),(2,5),(3,3),(3,4),(3,5)$ 的灰尘数量减少 $1$；\n\n第二次操作在方砖 $(3,3)$ 上使用能量值为 $2$ 的“清理炸弹”，使 $(3,3)$ 的灰尘数量减少 $4$，$(2,2),(2,3),(2,4),(3,2),(3,4),(4,2),(4,3),(4,4)$ 的灰尘数量减少 $1$。\n\n**数据范围**\n\n对于所有数据，$1\\leq n,m,p_i\\leq 10^3$，$1\\leq k\\leq 10^6$，$0\\leq a_{i,j}\\leq 10^{12}$，$1\\leq x_i\\leq n$，$1\\leq y_i\\leq m$。\n\n本题共 $11$ 个数据点，**采用捆绑测试**，子任务及数据点分配如下：\n\n| 子任务编号 | 数据点编号 | 特殊性质 | 分值 |\n| :-: | :-: | :-: | :-: |\n| $0$ | $1\\sim 4$ | $n,m,k\\leq 300$ | $10$ |\n| $1$ | $5$ | $p_i\\leq 3$ | $10$ |\n| $2$ | $6\\sim 7$ | $k\\leq 10^3$ | $20$ |\n| $3$ | $8\\sim 9$ | $n,m\\leq 300$ | $20$ |\n| $4$ | $10\\sim 11$ | 无特殊限制 | $40$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "高效清理", "background": "清理炸弹设计理念图：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mjfmevu2.png)", "description": "真寻的房间太大了，但是作为家里蹲，她又懒得打扫，于是美波里发明了一款清理炸弹给真寻使用。\n\n真寻的房间由 $n$ 行 $m$ 列的方砖组成，第 $i$ 行第 $j$ 列的方砖上的灰尘数量为 $a_{i,j}$。\n\n真寻将会使用 $k$ 次清理炸弹，第 $i$ 次她会在第 $x_i$ 行第 $y_i$ 列的方砖上使用能量值为 $p_i$ 的清理炸弹，这将会使 $(x_i,y_i)$ 的灰尘数量减少 ${p_i}^2$，$(x_i,y_i)$ 外围第一圈的方砖上的灰尘数量减少 $(p_i-1)^2$，外围第二圈的方砖上的灰尘数量减少 $(p_i-2)^2$ $\\cdots$ 外围第 $(p_i-1)$ 圈的方砖上的灰尘数量减少 $1$。\n\n当然，灰尘数量不能为负数，所以若某次操作前，某块方砖上的灰尘数量小于它将要减少的灰尘数量，那么它的灰尘数量将变为 $0$。\n\n请你输出真寻使用完 $k$ 次清理炸弹后，每块方砖上的灰尘数量。", "inputFormat": "第一行三个整数 $n,m,k$，分别表示方砖行数、列数及操作次数；\n\n接下来 $n$ 行，每行 $m$ 个整数，第 $i$ 行第 $j$ 列的整数表示 $a_{i,j}$，描述每一块方砖上的灰尘数量；\n\n接下来 $k$ 行，第 $i$ 行三个整数 $x_i,y_i,p_i$，描述一次操作。", "outputFormat": "共 $n$ 行，每行 $m$ 个整数，第 $i$ 行第 $j$ 列的整数表示方砖 $(i,j)$ 上最终的灰尘数量。", "hint": "**样例** $\\mathbf{1}$ **解释**\n\n第一次操作在方砖 $(2,4)$ 上使用能量值为 $2$ 的“清理炸弹”，使 $(2,4)$ 的灰尘数量减少 $4$，$(1,3),(1,4),(1,5),(2,3),(2,5),(3,3),(3,4),(3,5)$ 的灰尘数量减少 $1$；\n\n第二次操作在方砖 $(3,3)$ 上使用能量值为 $2$ 的“清理炸弹”，使 $(3,3)$ 的灰尘数量减少 $4$，$(2,2),(2,3),(2,4),(3,2),(3,4),(4,2),(4,3),(4,4)$ 的灰尘数量减少 $1$。\n\n**数据范围**\n\n对于所有数据，$1\\leq n,m,p_i\\leq 10^3$，$1\\leq k\\leq 10^6$，$0\\leq a_{i,j}\\leq 10^{12}$，$1\\leq x_i\\leq n$，$1\\leq y_i\\leq m$。\n\n本题共 $11$ 个数据点，**采用捆绑测试**，子任务及数据点分配如下：\n\n| 子任务编号 | 数据点编号 | 特殊性质 | 分值 |\n| :-: | :-: | :-: | :-: |\n| $0$ | $1\\sim 4$ | $n,m,k\\leq 300$ | $10$ |\n| $1$ | $5$ | $p_i\\leq 3$ | $10$ |\n| $2$ | $6\\sim 7$ | $k\\leq 10^3$ | $20$ |\n| $3$ | $8\\sim 9$ | $n,m\\leq 300$ | $20$ |\n| $4$ | $10\\sim 11$ | 无特殊限制 | $40$ |", "locale": "zh-CN"}}}
{"pid": "P10267", "type": "P", "difficulty": 4, "samples": [["2 3 5\n7 18 4\n10 6 3", "375000011"], ["6 5 0\n9 4 6 2 3\n6 4 4 0 1\n2 0 4 3 0\n1 5 7 3 4\n5 0 2 1 5\n6 4 9 8 3", "99609378"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "数学"], "title": "机器人", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/sub3kd3c.png)\n\n> 画师：白森 さわ（from pixiv），侵删。", "description": "真寻连清理炸弹都懒得自己使用，于是美波里又发明了一款全自动扫地机器人来清理房间。\n\n真寻的房间由 $n$ 行 $m$ 列的方砖组成，第 $i$ 行第 $j$ 列的方砖上的灰尘数量为 $a_{i,j}$。美波里的机器人每天会从房间的左上角出发，每次随机往右或往下走一步。\n\n若机器人在没有撞墙的情况下走到了右下角，那么它会返回**它经过的所有方砖的灰尘数量的异或和**给美波里；若机器人在走到右下角之前撞了墙，即某一步的目标位置不存在，那么机器人会返回一个错误值 $x$ 并结束移动。\n\n现给出某一天真寻的房间中每一块方砖上的灰尘数量，请你求出机器人返回值的期望值。\n\n形式化地，给定一 $n\\times m$ 的矩阵 $a$，第 $i$ 行第 $j$ 列的权值为 $a_{i,j}$，现有一机器人从 $(1,1)$ 出发，每次各有 $\\frac{1}{2}$ 的概率从 $(i,j)$ 移动至 $(i,j+1)$ 或 $(i+1,j)$；若机器人移动至 $(n,m)$，则返回**路径点权异或和**；若在移动至 $(n,m)$ 前有任意时刻移动至矩阵外，则返回 $x$；求返回值的期望值。\n\n答案对 $10^9+7$ 取模。", "inputFormat": "第一行三个整数 $n,m,x$，分别表示方砖行数、列数及错误值；\n\n接下来 $n$ 行，每行 $m$ 个整数，第 $i$ 行第 $j$ 列的整数表示 $a_{i,j}$，描述每一块方砖上的灰尘数量。", "outputFormat": "一行一个整数 $ans$，表示期望值在模 $10^9+7$ 意义下的值。\n\n若对有理数取余有疑惑，请参照 [P2613 【模板】有理数取余](https://www.luogu.com.cn/problem/P2613)。", "hint": "**样例** $\\mathbf{1}$ **解释**\n\n若机器人第一步往下走，则：\n\n- 若机器人第二步往下走，则撞墙，返回 $5$，概率为 $\\frac{1}{4}$；\n\n- 若机器人第二步往右走，则：\n\n\t- 若机器人第三步往下走，则撞墙，返回 $5$，概率为 $\\frac{1}{8}$；\n    \n    - 若机器人第三步往右走，则到达右下角，返回 $7\\oplus 10\\oplus 6\\oplus 3=8$，概率为 $\\frac{1}{8}$；\n    \n若机器人第一步往右走，则：\n\n- 若机器人第二步往下走，则：\n\n\t- 若机器人第三步往下走，则撞墙，返回 $5$，概率为 $\\frac{1}{8}$；\n    \n    - 若机器人第三步往右走，则到达右下角，返回 $7\\oplus 18\\oplus 6\\oplus 3=16$，概率为 $\\frac{1}{8}$；\n    \n- 若机器人第二步往右走，则：\n    \n    - 若机器人第三步往下走，则到达右下角，返回 $7\\oplus 18\\oplus 4\\oplus 3=18$，概率为 $\\frac{1}{8}$；\n    \n    - 若机器人第三步往右走，则撞墙，返回 $5$，概率为 $\\frac{1}{8}$；\n\n因此，返回值的期望值为 $\\frac{3\\times 5+8+16+18}{8}+\\frac{5}{4}=\\frac{67}{8}$，在模 $10^9+7$ 意义下为 $375000011$。\n\n**数据范围**\n\n对于所有数据，$1\\leq n,m\\leq 10^3$，$0\\leq a_{i,j},x\\leq 10^9$。\n\n本题共 $22$ 个测试点，**采用捆绑测试**，子任务及数据点分配如下：\n\n| 子任务编号 | 数据点编号 | 特殊性质 | 分值 |\n| :-: | :-: | :-: | :-: |\n| $0$ | $1\\sim 4$ | $n,m\\leq 12$ | $10$ |\n| $1$ | $5\\sim 8$ | $n,m\\leq 20$ | $20$ |\n| $2$ | $9\\sim 12$ | $a_{i,j}\\leq 20$ | $20$ |\n| $3$ | $13\\sim 16$ | $x=0$ | $20$ |\n| $4$ | $17\\sim 22$ | 无特殊限制 | $30$ |\n\n**提示**\n\n$\\oplus$ 表示异或（bitwise xor），$x_1,x_2,x_3,\\cdots,x_n$ 的异或和为 $x_1\\oplus x_2\\oplus x_3\\oplus\\cdots \\oplus x_n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "机器人", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/sub3kd3c.png)\n\n> 画师：白森 さわ（from pixiv），侵删。", "description": "真寻连清理炸弹都懒得自己使用，于是美波里又发明了一款全自动扫地机器人来清理房间。\n\n真寻的房间由 $n$ 行 $m$ 列的方砖组成，第 $i$ 行第 $j$ 列的方砖上的灰尘数量为 $a_{i,j}$。美波里的机器人每天会从房间的左上角出发，每次随机往右或往下走一步。\n\n若机器人在没有撞墙的情况下走到了右下角，那么它会返回**它经过的所有方砖的灰尘数量的异或和**给美波里；若机器人在走到右下角之前撞了墙，即某一步的目标位置不存在，那么机器人会返回一个错误值 $x$ 并结束移动。\n\n现给出某一天真寻的房间中每一块方砖上的灰尘数量，请你求出机器人返回值的期望值。\n\n形式化地，给定一 $n\\times m$ 的矩阵 $a$，第 $i$ 行第 $j$ 列的权值为 $a_{i,j}$，现有一机器人从 $(1,1)$ 出发，每次各有 $\\frac{1}{2}$ 的概率从 $(i,j)$ 移动至 $(i,j+1)$ 或 $(i+1,j)$；若机器人移动至 $(n,m)$，则返回**路径点权异或和**；若在移动至 $(n,m)$ 前有任意时刻移动至矩阵外，则返回 $x$；求返回值的期望值。\n\n答案对 $10^9+7$ 取模。", "inputFormat": "第一行三个整数 $n,m,x$，分别表示方砖行数、列数及错误值；\n\n接下来 $n$ 行，每行 $m$ 个整数，第 $i$ 行第 $j$ 列的整数表示 $a_{i,j}$，描述每一块方砖上的灰尘数量。", "outputFormat": "一行一个整数 $ans$，表示期望值在模 $10^9+7$ 意义下的值。\n\n若对有理数取余有疑惑，请参照 [P2613 【模板】有理数取余](https://www.luogu.com.cn/problem/P2613)。", "hint": "**样例** $\\mathbf{1}$ **解释**\n\n若机器人第一步往下走，则：\n\n- 若机器人第二步往下走，则撞墙，返回 $5$，概率为 $\\frac{1}{4}$；\n\n- 若机器人第二步往右走，则：\n\n\t- 若机器人第三步往下走，则撞墙，返回 $5$，概率为 $\\frac{1}{8}$；\n    \n    - 若机器人第三步往右走，则到达右下角，返回 $7\\oplus 10\\oplus 6\\oplus 3=8$，概率为 $\\frac{1}{8}$；\n    \n若机器人第一步往右走，则：\n\n- 若机器人第二步往下走，则：\n\n\t- 若机器人第三步往下走，则撞墙，返回 $5$，概率为 $\\frac{1}{8}$；\n    \n    - 若机器人第三步往右走，则到达右下角，返回 $7\\oplus 18\\oplus 6\\oplus 3=16$，概率为 $\\frac{1}{8}$；\n    \n- 若机器人第二步往右走，则：\n    \n    - 若机器人第三步往下走，则到达右下角，返回 $7\\oplus 18\\oplus 4\\oplus 3=18$，概率为 $\\frac{1}{8}$；\n    \n    - 若机器人第三步往右走，则撞墙，返回 $5$，概率为 $\\frac{1}{8}$；\n\n因此，返回值的期望值为 $\\frac{3\\times 5+8+16+18}{8}+\\frac{5}{4}=\\frac{67}{8}$，在模 $10^9+7$ 意义下为 $375000011$。\n\n**数据范围**\n\n对于所有数据，$1\\leq n,m\\leq 10^3$，$0\\leq a_{i,j},x\\leq 10^9$。\n\n本题共 $22$ 个测试点，**采用捆绑测试**，子任务及数据点分配如下：\n\n| 子任务编号 | 数据点编号 | 特殊性质 | 分值 |\n| :-: | :-: | :-: | :-: |\n| $0$ | $1\\sim 4$ | $n,m\\leq 12$ | $10$ |\n| $1$ | $5\\sim 8$ | $n,m\\leq 20$ | $20$ |\n| $2$ | $9\\sim 12$ | $a_{i,j}\\leq 20$ | $20$ |\n| $3$ | $13\\sim 16$ | $x=0$ | $20$ |\n| $4$ | $17\\sim 22$ | 无特殊限制 | $30$ |\n\n**提示**\n\n$\\oplus$ 表示异或（bitwise xor），$x_1,x_2,x_3,\\cdots,x_n$ 的异或和为 $x_1\\oplus x_2\\oplus x_3\\oplus\\cdots \\oplus x_n$。", "locale": "zh-CN"}}}
