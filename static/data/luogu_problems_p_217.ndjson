{"pid": "P5389", "type": "P", "difficulty": 5, "samples": [["2", "686292993"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2019", "概率论"], "title": "[Cnoi2019] 数学课", "background": "", "description": "聪明的 Cirno 开始学习计算，于是她很开心的算出了从 $1$ 一直加到 $n$。\n\n得到了一个 $n$ 项的数列 : $ \\{ a_n$ = $1 + 2 + 3 + 4 + ... + n \\} $\n\n为了验证自己算是否算错，她需要以某种规律从数列里取出两个元素 $v_1, v_2$（元素可以相同），并等概率的选出整数 $a \\in [ 1,v_1 ]$，$b \\in [ 1,v_2 ]$ 判断哪个比较大.\n\n所以她需要你来计算 $a>b$ 的概率。\n\n某种规律：\n选到数列第 $i$ 个元素的概率是：\n\n$$\\frac{a_i}{\\sum\\limits_{j=1}^n a_j}=\\frac{3i\\times(i+1)}{n(n+1)(n+2)}$$", "inputFormat": "输入一个正整数 $n$。", "outputFormat": "输出在模 $998244353$ 意义下的概率。", "hint": "对于前 $5\\%$ 的数据 $n = 3$；\n\n对于前 $15\\%$ 的数据 $n \\le 100$；\n\n对于前 $30\\%$ 的数据  $n \\le 5000$；\n\n对于前 $55\\%$ 的数据 $n \\le 10^7$；\n\n对于前 $95\\%$ 的数据 $1\\le n \\le 10^{18}$ 且 $n, n+2$ 均不为 $998244353$ 的倍数；\n\n对于最后 $5\\%$ 的数据 $n = 0$ 表示 $n$ 为**正无穷**。", "locale": "zh-CN", "translations": {"en": {"title": "[Cnoi2019] Math Class", "background": "", "description": "The smart Cirno started learning calculations, so she happily computed the sum from $1$ up to $n$.\n\nShe obtained an $n$-term sequence: $\\{ a_n = 1 + 2 + 3 + 4 + ... + n \\}$.\n\nTo check whether her calculation is wrong, she needs to pick two elements $v_1, v_2$ from the sequence according to some rule (the two elements may be the same), and then uniformly choose integers $a \\in [ 1, v_1 ]$ and $b \\in [ 1, v_2 ]$ to compare which one is larger.\n\nSo, she needs you to compute the probability that $a > b$.\n\nThe rule:\nThe probability of selecting the $i$-th element of the sequence is:\n\n$$\\frac{a_i}{\\sum\\limits_{j=1}^n a_j}=\\frac{3i\\times(i+1)}{n(n+1)(n+2)}$$", "inputFormat": "Input a positive integer $n$.", "outputFormat": "Output the probability modulo $998244353$.", "hint": "For the first $5\\%$ of the testdata, $n = 3$.\n\nFor the first $15\\%$ of the testdata, $n \\le 100$.\n\nFor the first $30\\%$ of the testdata, $n \\le 5000$.\n\nFor the first $55\\%$ of the testdata, $n \\le 10^7$.\n\nFor the first $95\\%$ of the testdata, $1 \\le n \\le 10^{18}$, and neither $n$ nor $n+2$ is a multiple of $998244353$.\n\nFor the last $5\\%$ of the testdata, $n = 0$ means $n$ is **positive infinity**.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Cnoi2019] 数学课", "background": "", "description": "聪明的 Cirno 开始学习计算，于是她很开心的算出了从 $1$ 一直加到 $n$。\n\n得到了一个 $n$ 项的数列 : $ \\{ a_n$ = $1 + 2 + 3 + 4 + ... + n \\} $\n\n为了验证自己算是否算错，她需要以某种规律从数列里取出两个元素 $v_1, v_2$（元素可以相同），并等概率的选出整数 $a \\in [ 1,v_1 ]$，$b \\in [ 1,v_2 ]$ 判断哪个比较大.\n\n所以她需要你来计算 $a>b$ 的概率。\n\n某种规律：\n选到数列第 $i$ 个元素的概率是：\n\n$$\\frac{a_i}{\\sum\\limits_{j=1}^n a_j}=\\frac{3i\\times(i+1)}{n(n+1)(n+2)}$$", "inputFormat": "输入一个正整数 $n$。", "outputFormat": "输出在模 $998244353$ 意义下的概率。", "hint": "对于前 $5\\%$ 的数据 $n = 3$；\n\n对于前 $15\\%$ 的数据 $n \\le 100$；\n\n对于前 $30\\%$ 的数据  $n \\le 5000$；\n\n对于前 $55\\%$ 的数据 $n \\le 10^7$；\n\n对于前 $95\\%$ 的数据 $1\\le n \\le 10^{18}$ 且 $n, n+2$ 均不为 $998244353$ 的倍数；\n\n对于最后 $5\\%$ 的数据 $n = 0$ 表示 $n$ 为**正无穷**。", "locale": "zh-CN"}}}
{"pid": "P5390", "type": "P", "difficulty": 4, "samples": [["1\n3 1 2 3", "12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "组合数学", "位运算"], "title": "[Cnoi2019] 数学作业", "background": "幻想乡，春节，万家灯火。\n\nKamishirasawa Keine 老师自然不会放过这么好的机会，，，布置作业。", "description": "现在 Cirno 手上有着 $T$ 天的作业，每天的作业可以用一个二元组 $( n, V )$ 表示，其中 $n$ 表示集合的大小， $V$ 表示大小为 $n$ 的集合. 现在，Cirno 需要求出的是 $V$ 的所有子集的异或和的和，答案对 $998\\,244\\,353$ 取模。\n\n形式化地：\n\n$$\n\\text{ans}\\equiv \\sum_{S \\subseteq V} \\mathop{\\bigoplus}\\limits_{ s \\in S } s \\pmod {998\\,244\\,353}\n$$", "inputFormat": "第一行，一个整数 $T$。\n\n以下 $T$ 行，每行一个二元组 $( n, V )$。", "outputFormat": "$T$ 行，每行一个整数，表示答案。", "hint": "- Subtask 1（17pts）：$ T, n \\le 8 $；\n- Subtask 2（22pts）：$ T, n \\le 100 $；\n- Subtask 3（61pts）：$ T, n \\le 3\\times10^6 $。\n\n对于 $100\\%$ 的数据，$ \\sum |V| \\le 3 \\times 10^6, 0 \\le p \\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[Cnoi2019] Math Homework", "background": "Gensokyo, the Spring Festival, and lights in every home.\n\nTeacher Kamishirasawa Keine would of course not miss such a good chance... and assigned homework.", "description": "Now Cirno has homework for $T$ days. The homework for each day can be represented by an ordered pair $(n, V)$, where $n$ is the size of the set, and $V$ is a set of size $n$. Now Cirno needs to compute the sum of the XOR values over all subsets of $V$. The answer should be taken modulo $998\\,244\\,353$.\n\nFormally:\n\n$$\n\\text{ans}\\equiv \\sum_{S \\subseteq V} \\mathop{\\bigoplus}\\limits_{ s \\in S } s \\pmod {998\\,244\\,353}\n$$", "inputFormat": "The first line contains an integer $T$.\n\nThe following $T$ lines each contain an ordered pair $(n, V)$.", "outputFormat": "Output $T$ lines, each containing one integer representing the answer.", "hint": "- Subtask 1 (17 pts): $T, n \\le 8$.\n- Subtask 2 (22 pts): $T, n \\le 100$.\n- Subtask 3 (61 pts): $T, n \\le 3\\times 10^6$.\n\nFor $100\\%$ of the testdata, $\\sum |V| \\le 3 \\times 10^6, 0 \\le p \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Cnoi2019] 数学作业", "background": "幻想乡，春节，万家灯火。\n\nKamishirasawa Keine 老师自然不会放过这么好的机会，，，布置作业。", "description": "现在 Cirno 手上有着 $T$ 天的作业，每天的作业可以用一个二元组 $( n, V )$ 表示，其中 $n$ 表示集合的大小， $V$ 表示大小为 $n$ 的集合. 现在，Cirno 需要求出的是 $V$ 的所有子集的异或和的和，答案对 $998\\,244\\,353$ 取模。\n\n形式化地：\n\n$$\n\\text{ans}\\equiv \\sum_{S \\subseteq V} \\mathop{\\bigoplus}\\limits_{ s \\in S } s \\pmod {998\\,244\\,353}\n$$", "inputFormat": "第一行，一个整数 $T$。\n\n以下 $T$ 行，每行一个二元组 $( n, V )$。", "outputFormat": "$T$ 行，每行一个整数，表示答案。", "hint": "- Subtask 1（17pts）：$ T, n \\le 8 $；\n- Subtask 2（22pts）：$ T, n \\le 100 $；\n- Subtask 3（61pts）：$ T, n \\le 3\\times10^6 $。\n\n对于 $100\\%$ 的数据，$ \\sum |V| \\le 3 \\times 10^6, 0 \\le p \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5391", "type": "P", "difficulty": 6, "samples": [["4 10\nadd 10 3\nadd 5 2\nadd 3 3\nerase", "3\n4\n9\n4"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000], "memory": [65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2019", "O2优化", "背包 DP", "树链剖分"], "title": "[Cnoi2019] 青染之心", "background": "这里原本有着一个史诗般的可歌可泣的背景故事，可是这里空太小，写不下。", "description": "Cirno 初始有一个空的物品序列，一个大小为 $V$ 的背包，现在你有 $q$ 个操作，分为两种：\n\n- `add x y`：表示加入一种体积为 $x$, 价值为 $y$ 的物品到序列末尾。\n- `erase`：表示删除序列末尾的物品。\n\n在每个操作结束以后，你需要求出：\n\n假设序列中的每种物品都有无穷多个，Cirno 的背包可以装下的物品最大价值和。", "inputFormat": "第一行，两个整数，$q$，$V$ 分别表示操作数和背包大小。\n\n以下 $q$ 行，每行一个操作。", "outputFormat": "$q$ 行，每行表示每次操作后的答案。", "hint": "对于 $100\\%$ 的数据 $1\\le q, V, x, y \\le 2\\times10^4 $。", "locale": "zh-CN", "translations": {"en": {"title": "[Cnoi2019] Cirno’s Dyed Heart", "background": "There was originally an epic and touching background story here, but this space is too small to write it down.", "description": "Cirno initially has an empty item sequence and a knapsack of size $V$. You are given $q$ operations of two types:\n\n- `add x y`: append a new type of item with volume $x$ and value $y$ to the end of the sequence.\n- `erase`: delete the item type at the end of the sequence.\n\nAfter each operation, you need to compute:\n\nAssuming each item type in the sequence has infinitely many copies, find the maximum total value that can be packed into Cirno’s knapsack.", "inputFormat": "The first line contains two integers $q$ and $V$, representing the number of operations and the knapsack size.\n\nThe next $q$ lines each contain one operation.", "outputFormat": "Output $q$ lines. Each line contains the answer after the corresponding operation.", "hint": "For $100\\%$ of the testdata, $1 \\le q, V, x, y \\le 2 \\times 10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Cnoi2019] 青染之心", "background": "这里原本有着一个史诗般的可歌可泣的背景故事，可是这里空太小，写不下。", "description": "Cirno 初始有一个空的物品序列，一个大小为 $V$ 的背包，现在你有 $q$ 个操作，分为两种：\n\n- `add x y`：表示加入一种体积为 $x$, 价值为 $y$ 的物品到序列末尾。\n- `erase`：表示删除序列末尾的物品。\n\n在每个操作结束以后，你需要求出：\n\n假设序列中的每种物品都有无穷多个，Cirno 的背包可以装下的物品最大价值和。", "inputFormat": "第一行，两个整数，$q$，$V$ 分别表示操作数和背包大小。\n\n以下 $q$ 行，每行一个操作。", "outputFormat": "$q$ 行，每行表示每次操作后的答案。", "hint": "对于 $100\\%$ 的数据 $1\\le q, V, x, y \\le 2\\times10^4 $。", "locale": "zh-CN"}}}
{"pid": "P5392", "type": "P", "difficulty": 6, "samples": [["3 4", "181"], ["1000 8", "124141757"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "O2优化", "矩阵加速", "状态合并", "状压 DP"], "title": "[Cnoi2019] 雪松树之约", "background": "由于 Cirno 突然犯懒，所以背景故事咕咕咕了。", "description": "Cirno 定义了一种图：圆柱网络 $G( L, x )$ 。\n\n$G(L, x)$ 表示一个有 $L \\times x$ 个节点的图。\n\n其中每个节点都用一个整数二元组 $( a, b )$ 表示 $( 1 \\le a \\le L, 1 \\le b \\le x )$。\n\n对于 $ \\forall i \\in (1,L], \\ j \\in (0,x]$ , 节点 $(i, j)$ 与节点 $(i - 1, j)$ 之间有一条边。\n\n对于 $ \\forall i \\in [1,L], \\ j \\in (0,x)$ , 节点 $(i, j)$ 与节点 $(i, j +1)$ 之间有一条边。\n\n对于 $ \\forall i \\in [1,L]$ 节点 $(i, x)$ 与 节点 $(i, 1)$ 之间有一条边。\n\n现在 Cirno 想知道 $G( L, x )$ 的 **独立集** 的个数。\n\n由于你不会高精度，所以你需要将答案对 $998244353$ 取模。\n", "inputFormat": "一行，两个整数，$L$，$x$。", "outputFormat": "一行，一个整数，表示 $G(L,x)$ 的独立集的个数对 $998244353$ 取模后的结果。", "hint": "对于 前 $10\\%$ 的数据 $ L, x \\le 8 $。\n\n对于 前 $30\\%$ 的数据 $ x \\le 8 $。\n\n对于 前 $50\\%$ 的数据 $ x \\le 11 $。\n\n对于 $100\\%$ 的数据 $0 < L \\le 10^{18}, 0 <x \\le 17 $。\n\n本题采用捆绑测试。\n\n下图 是 $G( 3, 4 )$ 的示例图。\n\n![](https://cdn.luogu.com.cn/upload/pic/56163.png)", "locale": "zh-CN", "translations": {"en": {"title": "[Cnoi2019] Appointment of the Cedar Tree", "background": "Because Cirno suddenly became lazy, the background story is skipped.", "description": "Cirno defines a type of graph: the cylindrical network $G(L, x)$.\n\n$G(L, x)$ denotes a graph with $L \\times x$ nodes.\n\nEach node is represented by an ordered pair of integers $(a, b)$, where $(1 \\le a \\le L, 1 \\le b \\le x)$.\n\nFor $\\forall i \\in (1, L],\\ j \\in (0, x]$, there is an edge between node $(i, j)$ and node $(i - 1, j)$.\n\nFor $\\forall i \\in [1, L],\\ j \\in (0, x)$, there is an edge between node $(i, j)$ and node $(i, j + 1)$.\n\nFor $\\forall i \\in [1, L]$, there is an edge between node $(i, x)$ and node $(i, 1)$.\n\nNow Cirno wants to know the number of **independent sets** of $G(L, x)$.\n\nSince you cannot do big integer arithmetic, you need to output the answer modulo $998244353$.", "inputFormat": "One line with two integers $L$ and $x$.", "outputFormat": "One line with one integer, the number of independent sets of $G(L, x)$ modulo $998244353$.", "hint": "For the first $10\\%$ of the testdata, $L, x \\le 8$.\n\nFor the first $30\\%$ of the testdata, $x \\le 8$.\n\nFor the first $50\\%$ of the testdata, $x \\le 11$.\n\nFor $100\\%$ of the testdata, $0 < L \\le 10^{18},\\ 0 < x \\le 17$.\n\nThis problem uses bundled tests.\n\nThe figure below is an example of $G(3, 4)$.\n\n![](https://cdn.luogu.com.cn/upload/pic/56163.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Cnoi2019] 雪松树之约", "background": "由于 Cirno 突然犯懒，所以背景故事咕咕咕了。", "description": "Cirno 定义了一种图：圆柱网络 $G( L, x )$ 。\n\n$G(L, x)$ 表示一个有 $L \\times x$ 个节点的图。\n\n其中每个节点都用一个整数二元组 $( a, b )$ 表示 $( 1 \\le a \\le L, 1 \\le b \\le x )$。\n\n对于 $ \\forall i \\in (1,L], \\ j \\in (0,x]$ , 节点 $(i, j)$ 与节点 $(i - 1, j)$ 之间有一条边。\n\n对于 $ \\forall i \\in [1,L], \\ j \\in (0,x)$ , 节点 $(i, j)$ 与节点 $(i, j +1)$ 之间有一条边。\n\n对于 $ \\forall i \\in [1,L]$ 节点 $(i, x)$ 与 节点 $(i, 1)$ 之间有一条边。\n\n现在 Cirno 想知道 $G( L, x )$ 的 **独立集** 的个数。\n\n由于你不会高精度，所以你需要将答案对 $998244353$ 取模。\n", "inputFormat": "一行，两个整数，$L$，$x$。", "outputFormat": "一行，一个整数，表示 $G(L,x)$ 的独立集的个数对 $998244353$ 取模后的结果。", "hint": "对于 前 $10\\%$ 的数据 $ L, x \\le 8 $。\n\n对于 前 $30\\%$ 的数据 $ x \\le 8 $。\n\n对于 前 $50\\%$ 的数据 $ x \\le 11 $。\n\n对于 $100\\%$ 的数据 $0 < L \\le 10^{18}, 0 <x \\le 17 $。\n\n本题采用捆绑测试。\n\n下图 是 $G( 3, 4 )$ 的示例图。\n\n![](https://cdn.luogu.com.cn/upload/pic/56163.png)", "locale": "zh-CN"}}}
{"pid": "P5393", "type": "P", "difficulty": 7, "samples": [["3\n1 2 1", "1 1 1"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "O2优化", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "下降幂多项式转普通多项式", "background": "这是一道模板题\n", "description": "已知下降幂多项式 $F(x)=\\displaystyle\\sum_{i=0}^{n-1}a_ix^{\\underline{i}}$。\n\n求一个普通多项式 $G(x)=\\displaystyle\\sum_{i=0}^{n-1}b_ix^i$。\n\n使得 $G(x)=F(x)$。\n\n所有运算均在 $\\bmod\\ 998244353$ 意义下进行。", "inputFormat": "第一行一个正整数 $n$，如题所述。\n\n第二行 $n$ 个数，第 $i$ 个数表示 $a_{i-1}$。", "outputFormat": "一行 $n$ 个数，第 $i$ 个数为 $b_{i-1}$。", "hint": "对于所有数据 $a_i\\in\\lbrack0,998244353)$。\n\n本题一共 $10$ 个点。\n\n其中 $3$ 个点 $n=2000$。\n\n另外 $7$ 个点 $n=200000$。", "locale": "zh-CN", "translations": {"en": {"title": "Convert Falling-Factorial Polynomial to Ordinary Polynomial", "background": "This is a template problem.", "description": "You are given a falling-factorial polynomial $F(x)=\\displaystyle\\sum_{i=0}^{n-1}a_ix^{\\underline{i}}$.\n\nFind an ordinary polynomial $G(x)=\\displaystyle\\sum_{i=0}^{n-1}b_ix^i$.\n\nSuch that $G(x)=F(x)$.\n\nAll operations are performed modulo $998244353$.", "inputFormat": "The first line contains a positive integer $n$, as described above.\n\nThe second line contains $n$ numbers, where the $i$-th number represents $a_{i-1}$.", "outputFormat": "Output one line with $n$ numbers, where the $i$-th number is $b_{i-1}$.", "hint": "For all testdata, $a_i\\in\\lbrack0,998244353)$.\n\nThis problem has $10$ subtasks.\n\nAmong them, $3$ subtasks have $n=2000$.\n\nThe other $7$ subtasks have $n=200000$.\n\nConstraints\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "下降幂多项式转普通多项式", "background": "这是一道模板题\n", "description": "已知下降幂多项式 $F(x)=\\displaystyle\\sum_{i=0}^{n-1}a_ix^{\\underline{i}}$。\n\n求一个普通多项式 $G(x)=\\displaystyle\\sum_{i=0}^{n-1}b_ix^i$。\n\n使得 $G(x)=F(x)$。\n\n所有运算均在 $\\bmod\\ 998244353$ 意义下进行。", "inputFormat": "第一行一个正整数 $n$，如题所述。\n\n第二行 $n$ 个数，第 $i$ 个数表示 $a_{i-1}$。", "outputFormat": "一行 $n$ 个数，第 $i$ 个数为 $b_{i-1}$。", "hint": "对于所有数据 $a_i\\in\\lbrack0,998244353)$。\n\n本题一共 $10$ 个点。\n\n其中 $3$ 个点 $n=2000$。\n\n另外 $7$ 个点 $n=200000$。", "locale": "zh-CN"}}}
{"pid": "P5394", "type": "P", "difficulty": 6, "samples": [["2 3\n1 2 3\n1 2 3 4\n", "1 8 52 148 89 12\n"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["快速傅里叶变换 FFT", "快速数论变换 NTT", "模板题"], "title": "【模板】下降幂多项式乘法", "background": "模板题，无背景。", "description": "给定一个 $n$ 次下降幂多项式 $A(x)$ 和 $m$ 次下降幂多项式 $B(x)$，你要求出一个 $n+m$ 次下降幂多项式 $F(x)$ 满足 $F(x)=A(x)B(x)$。\n\n由于结果会很大，你输出的多项式的系数应对 $998244353$ 取模。", "inputFormat": "第一行两个正整数 $n,m$，表示下降幂多项式的次数。\n\n第二行 $n+1$ 个非负整数 $a_0,a_1,a_2,\\dots,a_n$，表示 $A(x)$ 的系数。即 $A(x)=a_0+a_1x+a_2x^{\\underline 2}+\\dots+a_nx^{\\underline n}$。\n\n第三行$m+1$个非负整数$b_0,b_1,b_2,\\dots,b_m$，表示 $B(x)$ 的系数。即 $B(x)=b_0+b_1x+b_2x^{\\underline 2}+\\dots+b_mx^{\\underline m}$。\n\n", "outputFormat": "一行，共 $n+m+1$ 个非负整数，表示 $F(x)$ 的各项系数对 $998244353$ 取模后的结果。", "hint": "对于 $20\\%$的数据，$n,m\\leqslant 1000$。\n\n对于 $100\\%$ 的数据，$1\\leqslant n,m\\leqslant 10^5$，$a_i,b_i\\in[0,998244353)$，$a_n,b_m \\neq 0$。\n\n## 提示\n\n$x^{\\underline n}=\\left\\{\\begin{matrix}1 & n=0\\\\ x\\times (x-1)^{\\underline{n-1}} & n\\geqslant 1 \\end{matrix}\\right.$\n\n$\\sum\\limits_{i=0}^n a_ix^{\\underline i},a_n\\neq 0$ 是 $x$ 的 $n$ 次下降幂多项式。\n\n容易证明 $n$ 次下降幂多项式唯一确定一个 $n$ 次多项式，所以下降幂多项式乘积的定义就是对应的多项式的乘积对应的下降幂多项式。 ", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Falling Factorial Polynomial Multiplication", "background": "This is a template problem, with no background.", "description": "Given a degree $n$ falling factorial polynomial $A(x)$ and a degree $m$ falling factorial polynomial $B(x)$, you need to compute a degree $n+m$ falling factorial polynomial $F(x)$ such that $F(x)=A(x)B(x)$.\n\nSince the result can be very large, output the coefficients of the polynomial modulo $998244353$.", "inputFormat": "The first line contains two positive integers $n,m$, representing the degrees of the falling factorial polynomials.\n\nThe second line contains $n+1$ non-negative integers $a_0,a_1,a_2,\\dots,a_n$, representing the coefficients of $A(x)$. That is, $A(x)=a_0+a_1x+a_2x^{\\underline 2}+\\dots+a_nx^{\\underline n}$.\n\nThe third line contains $m+1$ non-negative integers $b_0,b_1,b_2,\\dots,b_m$, representing the coefficients of $B(x)$. That is, $B(x)=b_0+b_1x+b_2x^{\\underline 2}+\\dots+b_mx^{\\underline m}$.", "outputFormat": "Output one line with $n+m+1$ non-negative integers, representing the coefficients of $F(x)$ modulo $998244353$.", "hint": "For $20\\%$ of the testdata, $n,m\\leqslant 1000$.\n\nFor $100\\%$ of the testdata, $1\\leqslant n,m\\leqslant 10^5$, $a_i,b_i\\in[0,998244353)$, and $a_n,b_m \\neq 0$.\n\n$x^{\\underline n}=\\left\\{\\begin{matrix}1 & n=0\\\\ x\\times (x-1)^{\\underline{n-1}} & n\\geqslant 1 \\end{matrix}\\right.$\n\n$\\sum\\limits_{i=0}^n a_ix^{\\underline i},a_n\\neq 0$ is a degree $n$ falling factorial polynomial in $x$.\n\nIt is easy to prove that a degree $n$ falling factorial polynomial uniquely determines a degree $n$ polynomial. Therefore, the definition of the product of falling factorial polynomials is: take the product of the corresponding polynomials, and then convert it back to the corresponding falling factorial polynomial.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】下降幂多项式乘法", "background": "模板题，无背景。", "description": "给定一个 $n$ 次下降幂多项式 $A(x)$ 和 $m$ 次下降幂多项式 $B(x)$，你要求出一个 $n+m$ 次下降幂多项式 $F(x)$ 满足 $F(x)=A(x)B(x)$。\n\n由于结果会很大，你输出的多项式的系数应对 $998244353$ 取模。", "inputFormat": "第一行两个正整数 $n,m$，表示下降幂多项式的次数。\n\n第二行 $n+1$ 个非负整数 $a_0,a_1,a_2,\\dots,a_n$，表示 $A(x)$ 的系数。即 $A(x)=a_0+a_1x+a_2x^{\\underline 2}+\\dots+a_nx^{\\underline n}$。\n\n第三行$m+1$个非负整数$b_0,b_1,b_2,\\dots,b_m$，表示 $B(x)$ 的系数。即 $B(x)=b_0+b_1x+b_2x^{\\underline 2}+\\dots+b_mx^{\\underline m}$。\n\n", "outputFormat": "一行，共 $n+m+1$ 个非负整数，表示 $F(x)$ 的各项系数对 $998244353$ 取模后的结果。", "hint": "对于 $20\\%$的数据，$n,m\\leqslant 1000$。\n\n对于 $100\\%$ 的数据，$1\\leqslant n,m\\leqslant 10^5$，$a_i,b_i\\in[0,998244353)$，$a_n,b_m \\neq 0$。\n\n## 提示\n\n$x^{\\underline n}=\\left\\{\\begin{matrix}1 & n=0\\\\ x\\times (x-1)^{\\underline{n-1}} & n\\geqslant 1 \\end{matrix}\\right.$\n\n$\\sum\\limits_{i=0}^n a_ix^{\\underline i},a_n\\neq 0$ 是 $x$ 的 $n$ 次下降幂多项式。\n\n容易证明 $n$ 次下降幂多项式唯一确定一个 $n$ 次多项式，所以下降幂多项式乘积的定义就是对应的多项式的乘积对应的下降幂多项式。 ", "locale": "zh-CN"}}}
{"pid": "P5395", "type": "P", "difficulty": 6, "samples": [["3\n", "0 1 3 1\n"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["Stirling 数"], "title": "第二类斯特林数·行", "background": null, "description": "第二类斯特林数 $\\begin{Bmatrix} n \\\\m \\end{Bmatrix}$ 表示把 $n$ 个**不同**元素划分成 $m$ 个**相同**的集合中（不能有空集）的方案数。\n\n给定 $n$，对于所有的整数 $i\\in[0,n]$，你要求出 $\\begin{Bmatrix} n \\\\i \\end{Bmatrix}$。\n\n由于答案会非常大，所以你的输出需要**对 $\\bm{167772161}$（$\\bm{2^{25}\\times 5+1}$，是一个质数）取模**。", "inputFormat": "一行一个正整数 $n$，意义见题目描述。", "outputFormat": "共一行 $n+1$ 个非负整数。\n\n你需要按顺序输出 $\\begin{Bmatrix} n \\\\0 \\end{Bmatrix},\\begin{Bmatrix} n \\\\1 \\end{Bmatrix},\\begin{Bmatrix} n \\\\2 \\end{Bmatrix},\\dots,\\begin{Bmatrix} n \\\\n \\end{Bmatrix}$ 的值。", "hint": "对于 $20\\%$ 的数据，$n\\leqslant 1000$。\n\n对于 $100\\%$ 的数据，$1\\leqslant n\\leqslant 2\\times 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "Stirling Numbers of the Second Kind · Row", "background": "", "description": "The Stirling number of the second kind $\\begin{Bmatrix} n \\\\m \\end{Bmatrix}$ is the number of ways to partition $n$ **distinct** elements into $m$ **identical** non-empty sets.\n\nGiven $n$, for every integer $i \\in [0,n]$, you need to compute $\\begin{Bmatrix} n \\\\i \\end{Bmatrix}$.\n\nSince the answer can be very large, you must output the result **modulo $\\bm{167772161}$ ($\\bm{2^{25}\\times 5+1}$, which is a prime)**.", "inputFormat": "A single line containing a positive integer $n$, as described above.", "outputFormat": "A single line containing $n+1$ non-negative integers.\n\nOutput, in order, the values of $\\begin{Bmatrix} n \\\\0 \\end{Bmatrix},\\begin{Bmatrix} n \\\\1 \\end{Bmatrix},\\begin{Bmatrix} n \\\\2 \\end{Bmatrix},\\dots,\\begin{Bmatrix} n \\\\n \\end{Bmatrix}$.", "hint": "For $20\\%$ of the testdata, $n \\leqslant 1000$.\n\nFor $100\\%$ of the testdata, $1 \\leqslant n \\leqslant 2\\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "第二类斯特林数·行", "background": null, "description": "第二类斯特林数 $\\begin{Bmatrix} n \\\\m \\end{Bmatrix}$ 表示把 $n$ 个**不同**元素划分成 $m$ 个**相同**的集合中（不能有空集）的方案数。\n\n给定 $n$，对于所有的整数 $i\\in[0,n]$，你要求出 $\\begin{Bmatrix} n \\\\i \\end{Bmatrix}$。\n\n由于答案会非常大，所以你的输出需要**对 $\\bm{167772161}$（$\\bm{2^{25}\\times 5+1}$，是一个质数）取模**。", "inputFormat": "一行一个正整数 $n$，意义见题目描述。", "outputFormat": "共一行 $n+1$ 个非负整数。\n\n你需要按顺序输出 $\\begin{Bmatrix} n \\\\0 \\end{Bmatrix},\\begin{Bmatrix} n \\\\1 \\end{Bmatrix},\\begin{Bmatrix} n \\\\2 \\end{Bmatrix},\\dots,\\begin{Bmatrix} n \\\\n \\end{Bmatrix}$ 的值。", "hint": "对于 $20\\%$ 的数据，$n\\leqslant 1000$。\n\n对于 $100\\%$ 的数据，$1\\leqslant n\\leqslant 2\\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P5396", "type": "P", "difficulty": 7, "samples": [["3 2\n", "0 0 1 3\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["Stirling 数"], "title": "第二类斯特林数·列", "background": "**验题人提示：程序运行时间受评测压力影响较大，评测高峰可能会被卡常。**", "description": "第二类斯特林数 $\\begin{Bmatrix} n \\\\m \\end{Bmatrix}$ 表示把 $n$ 个**不同**元素划分成 $m$ 个**相同**的集合（不能有空集）的方案数。\n\n给定 $n,k$，对于所有的整数 $i\\in[0,n]$，你要求出 $\\begin{Bmatrix} i \\\\k \\end{Bmatrix}$。\n\n由于答案会非常大，所以你的输出需要对 $167772161$（$2^{25}\\times 5+1$，是一个质数）取模。", "inputFormat": "一行两个正整数 $n,k$，意义见题目描述。", "outputFormat": "共一行 $n+1$ 个非负整数。\n\n你需要按顺序输出 $\\begin{Bmatrix} 0 \\\\k \\end{Bmatrix},\\begin{Bmatrix} 1 \\\\k \\end{Bmatrix},\\begin{Bmatrix} 2 \\\\k \\end{Bmatrix},\\dots,\\begin{Bmatrix} n \\\\k \\end{Bmatrix}$ 的值。", "hint": "对于 $20\\%$ 的数据，$n\\leqslant 1000$。\n\n对于 $100\\%$ 的数据，$1\\leqslant k,  n<131072$。", "locale": "zh-CN", "translations": {"en": {"title": "Stirling Numbers of the Second Kind · Sequence.", "background": "**Tester’s note: The program running time is greatly affected by judging load, and it may be slowed down during peak times.**", "description": "The Stirling number of the second kind $\\begin{Bmatrix} n \\\\m \\end{Bmatrix}$ denotes the number of ways to partition $n$ **distinct** elements into $m$ **identical** non-empty sets.\n\nGiven $n, k$, for every integer $i \\in [0, n]$, you need to compute $\\begin{Bmatrix} i \\\\k \\end{Bmatrix}$.\n\nSince the answer can be very large, you need to output it modulo $167772161$ ($2^{25}\\times 5+1$, which is a prime).", "inputFormat": "One line with two positive integers $n, k$, as described above.", "outputFormat": "One line with $n+1$ non-negative integers.\n\nYou need to output, in order, the values of $\\begin{Bmatrix} 0 \\\\k \\end{Bmatrix}, \\begin{Bmatrix} 1 \\\\k \\end{Bmatrix}, \\begin{Bmatrix} 2 \\\\k \\end{Bmatrix}, \\dots, \\begin{Bmatrix} n \\\\k \\end{Bmatrix}$.", "hint": "For $20\\%$ of the testdata, $n \\leqslant 1000$.\n\nFor $100\\%$ of the testdata, $1 \\leqslant k, n < 131072$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "第二类斯特林数·列", "background": "**验题人提示：程序运行时间受评测压力影响较大，评测高峰可能会被卡常。**", "description": "第二类斯特林数 $\\begin{Bmatrix} n \\\\m \\end{Bmatrix}$ 表示把 $n$ 个**不同**元素划分成 $m$ 个**相同**的集合（不能有空集）的方案数。\n\n给定 $n,k$，对于所有的整数 $i\\in[0,n]$，你要求出 $\\begin{Bmatrix} i \\\\k \\end{Bmatrix}$。\n\n由于答案会非常大，所以你的输出需要对 $167772161$（$2^{25}\\times 5+1$，是一个质数）取模。", "inputFormat": "一行两个正整数 $n,k$，意义见题目描述。", "outputFormat": "共一行 $n+1$ 个非负整数。\n\n你需要按顺序输出 $\\begin{Bmatrix} 0 \\\\k \\end{Bmatrix},\\begin{Bmatrix} 1 \\\\k \\end{Bmatrix},\\begin{Bmatrix} 2 \\\\k \\end{Bmatrix},\\dots,\\begin{Bmatrix} n \\\\k \\end{Bmatrix}$ 的值。", "hint": "对于 $20\\%$ 的数据，$n\\leqslant 1000$。\n\n对于 $100\\%$ 的数据，$1\\leqslant k,  n<131072$。", "locale": "zh-CN"}}}
{"pid": "P5397", "type": "P", "difficulty": 7, "samples": [["5 5\n1 2 2 4 4\n2 3 3\n2 2 4\n1 3 2\n1 5 5\n2 2 5\n", "Ikaros\n1\n1\n"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2018", "O2优化", "分块", "Ynoi"], "title": "[Ynoi2018] 天降之物", "background": "可曾做过这样的梦呢？\n\n在我身边，有一个我从没见过的少女\n\n我很喜欢她，她也很喜欢我\n\n不过——\n\n最后总是\n\n在她被天空掳去的时候\n\n迎来梦醒时分\n\n ![](https://cdn.luogu.com.cn/upload/pic/58812.png)  \n\n人？\n\n不对\n\n不是人\n\n没有人会...\n\n长着翅膀\n\n  ![](https://cdn.luogu.com.cn/upload/pic/58813.png)  \n\n没有没有没有\n\n哪里都没有\n\n没有我可以回去的地方\n\n我没有任何可以回去的地方！\n\n哪里都没有...\n\n我能回去的地方...无论哪里...无论哪里都没有...\n\n我不想杀死任何人，不想伤害任何人！\n\n为什么...为什么要制造出我...\n\n不需要...我不需要这种力量...\n\n  ![](https://cdn.luogu.com.cn/upload/pic/58814.png)  \n\n幸福不足以形容我现在的心情\n\n我该说什么才好呢\n\n啊对了\n\n我...爱你\n\n我爱你...主人\n\n  ![](https://cdn.luogu.com.cn/upload/pic/58815.png)  \n\n神话中的伊卡洛斯，由于过于靠近太阳，用蜡粘住的羽毛融化后坠海而死\n", "description": "伊卡洛斯给了你一个长为 $n$ 的序列 $a$。\n\n你需要实现 $m$ 个操作，操作有两种：\n\n1. 把序列中所有值为 $x$ 的数的值变成 $y$。\n2. 找出一个位置 $i$ 满足 $a_i=x$，找出一个位置 $j$ 满足 $a_j=y$，使得 $|i-j|$ 最小，并输出 $|i-j|$。", "inputFormat": "第一行两个整数 $n,m$。\n\n之后一行 $n$ 个整数，表示序列 $a$。\n\n之后 $m$ 行，每行三个数 $opt,x,y$。\n\n如果 $opt$ 为 $1$，代表把序列中所有值为 $x$ 位置的值变成 $y$。\n\n如果 $opt$ 为 $2$，代表找出一个位置 $i$ 满足 $a_i=x$，找出一个位置 $j$ 满足 $a_j=y$，使得 $|i-j|$ 最小，并输出 $|i-j|$，如果找不出这样的位置，输出 `Ikaros`。\n\n本题强制在线，每次的 $x,y$ 需要 xor 上上次答案，如果输出 `Ikaros`，或者是第一次询问，则上次答案为 $0$。\n\n共 $50$ 组数据，数据中保证 $n=m$。", "outputFormat": "对于每个 $2$ 操作，输出一行一个整数表示答案。\n\n如果无法找出满足题意的 $i,j$，则输出 `Ikaros`。\n", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477( partially uploaded )\n\n对于 $100\\%$ 的数据，所有数在 $[1,10^5]$ 内，每次操作的值不超过 $n$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2018] Things Falling from the Sky", "background": "Have you ever had a dream like this?\n\nBeside me, there is a girl I have never met before.\n\nI like her a lot, and she likes me a lot too.\n\nBut—\n\nIn the end, it is always\n\nWhen she is taken away by the sky,\n\nThat I wake up from the dream.\n\n ![](https://cdn.luogu.com.cn/upload/pic/58812.png)  \n\nHuman?\n\nNo.\n\nNot human.\n\nNo one would...\n\nHave wings.\n\n  ![](https://cdn.luogu.com.cn/upload/pic/58813.png)  \n\nNo, no, no.\n\nThere is nowhere.\n\nThere is nowhere I can go back to.\n\nI have no place I can go back to!\n\nNowhere...\n\nA place I can go back to... anywhere... nowhere at all...\n\nI do not want to kill anyone, and I do not want to hurt anyone!\n\nWhy... why did you create me...\n\nNo need... I do not need this kind of power...\n\n  ![](https://cdn.luogu.com.cn/upload/pic/58814.png)  \n\n“Happiness” is not enough to describe how I feel right now.\n\nWhat should I say?\n\nAh, right.\n\nI... love you.\n\nI love you... Master.\n\n  ![](https://cdn.luogu.com.cn/upload/pic/58815.png)  \n\nIn Greek mythology, Icarus flew too close to the sun; the feathers glued on with wax melted, and he fell into the sea and died.", "description": "Icarus gives you a sequence $a$ of length $n$.\n\nYou need to process $m$ operations. There are two types of operations:\n\n1. Change the value of every element equal to $x$ in the sequence to $y$.\n2. Find a position $i$ such that $a_i=x$ and a position $j$ such that $a_j=y$, so that $|i-j|$ is minimized, and output $|i-j|$.", "inputFormat": "The first line contains two integers $n,m$.\n\nThe next line contains $n$ integers, representing the sequence $a$.\n\nThen follow $m$ lines, each containing three numbers $opt,x,y$.\n\nIf $opt$ is $1$, it means changing the value at every position with value $x$ to $y$.\n\nIf $opt$ is $2$, it means finding a position $i$ such that $a_i=x$ and a position $j$ such that $a_j=y$ to minimize $|i-j|$, and output $|i-j|$. If no such positions can be found, output `Ikaros`.\n\nThis problem is strictly online. For each operation, $x,y$ need to be xor-ed with the answer from two queries ago. If the output is `Ikaros`, or if it is the first query, then the last answer is $0$.\n\nThere are $50$ test cases in total, and it is guaranteed that $n=m$.", "outputFormat": "For each operation of type $2$, output one line with an integer representing the answer.\n\nIf it is impossible to find $i,j$ that satisfy the statement, output `Ikaros`.", "hint": "Idea: nzhtl1477, Solution: nzhtl1477, Code: nzhtl1477, Data: nzhtl1477 ( partially uploaded ).\n\nConstraints: For $100\\%$ of the testdata, all numbers are within $[1,10^5]$, and the value in each operation does not exceed $n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2018] 天降之物", "background": "可曾做过这样的梦呢？\n\n在我身边，有一个我从没见过的少女\n\n我很喜欢她，她也很喜欢我\n\n不过——\n\n最后总是\n\n在她被天空掳去的时候\n\n迎来梦醒时分\n\n ![](https://cdn.luogu.com.cn/upload/pic/58812.png)  \n\n人？\n\n不对\n\n不是人\n\n没有人会...\n\n长着翅膀\n\n  ![](https://cdn.luogu.com.cn/upload/pic/58813.png)  \n\n没有没有没有\n\n哪里都没有\n\n没有我可以回去的地方\n\n我没有任何可以回去的地方！\n\n哪里都没有...\n\n我能回去的地方...无论哪里...无论哪里都没有...\n\n我不想杀死任何人，不想伤害任何人！\n\n为什么...为什么要制造出我...\n\n不需要...我不需要这种力量...\n\n  ![](https://cdn.luogu.com.cn/upload/pic/58814.png)  \n\n幸福不足以形容我现在的心情\n\n我该说什么才好呢\n\n啊对了\n\n我...爱你\n\n我爱你...主人\n\n  ![](https://cdn.luogu.com.cn/upload/pic/58815.png)  \n\n神话中的伊卡洛斯，由于过于靠近太阳，用蜡粘住的羽毛融化后坠海而死\n", "description": "伊卡洛斯给了你一个长为 $n$ 的序列 $a$。\n\n你需要实现 $m$ 个操作，操作有两种：\n\n1. 把序列中所有值为 $x$ 的数的值变成 $y$。\n2. 找出一个位置 $i$ 满足 $a_i=x$，找出一个位置 $j$ 满足 $a_j=y$，使得 $|i-j|$ 最小，并输出 $|i-j|$。", "inputFormat": "第一行两个整数 $n,m$。\n\n之后一行 $n$ 个整数，表示序列 $a$。\n\n之后 $m$ 行，每行三个数 $opt,x,y$。\n\n如果 $opt$ 为 $1$，代表把序列中所有值为 $x$ 位置的值变成 $y$。\n\n如果 $opt$ 为 $2$，代表找出一个位置 $i$ 满足 $a_i=x$，找出一个位置 $j$ 满足 $a_j=y$，使得 $|i-j|$ 最小，并输出 $|i-j|$，如果找不出这样的位置，输出 `Ikaros`。\n\n本题强制在线，每次的 $x,y$ 需要 xor 上上次答案，如果输出 `Ikaros`，或者是第一次询问，则上次答案为 $0$。\n\n共 $50$ 组数据，数据中保证 $n=m$。", "outputFormat": "对于每个 $2$ 操作，输出一行一个整数表示答案。\n\n如果无法找出满足题意的 $i,j$，则输出 `Ikaros`。\n", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477( partially uploaded )\n\n对于 $100\\%$ 的数据，所有数在 $[1,10^5]$ 内，每次操作的值不超过 $n$。", "locale": "zh-CN"}}}
{"pid": "P5398", "type": "P", "difficulty": 7, "samples": [["6 3\n1 1 4 5 1 4\n1 1\n4 5\n1 4\n", "1\n3\n10\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2018", "莫队", "O2优化", "分块", "Ynoi", "根号分治", "离线处理"], "title": "[Ynoi2018] GOSICK", "background": "  ![](https://cdn.luogu.com.cn/upload/pic/58864.png)  \n洋...娃娃？\n\n“终于来了啊”\n\n“太慢了，伴随春天而来的死神”\n   ![](https://cdn.luogu.com.cn/upload/pic/58865.png)  \n维多利...加？\n\n你...手不疼吗\n\n手通红的啊\n\n“无路赛...振作一点”\n\n“如果在这里放弃的话就永远绝交了，久城！”\n\n“要一起回去”\n\n“之前也说过的吧 一起...”\n\n“我们俩分离的地方，不是这里吧”\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58866.png)  \n\n“太慢了，伴随春天而来的死神”\n\n别生气嘛 我这也是很赶时间了\n\n信收到了吗\n\n“嗯，因为都很认真写上地址了”\n\n“运用智慧之泉，终于到达了这里”\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58867.png)  \n\n无论世界如何改变\n\n这次之后 将再不分离\n\n\n", "description": "维多利加给了你一个序列 $a$，每次询问给一个区间 $[l,r]$。\n\n查询 $l \\leq i,j\\leq r$，且 $a_i$ 是 $a_j$ 倍数的二元组 $(i,j)$ 的个数。\n\n\n", "inputFormat": "第一行两个整数表示 $n,m$。\n\n第二行 $n$ 个整数表示序列 $a$。\n\n之后 $m$ 行，每行两个整数 $l,r$ 表示一次询问。\n", "outputFormat": "对于每个询问，输出一行一个整数表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\leq n,m,a_i\\leq 5\\times 10^5$，$1\\leq l\\leq r\\leq n$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2018] GOSICK", "background": "![](https://cdn.luogu.com.cn/upload/pic/58864.png)  \nYo... dolls?\n\n“You finally came.”\n\n“So slow, the reaper who comes with spring.”\n![](https://cdn.luogu.com.cn/upload/pic/58865.png)  \nVicto... rica?\n\nYou... doesn’t your hand hurt?\n\nYour hand is all red.\n\n“Urusai... pull yourself together.”\n\n“If you give up here, then we will never talk again, Kujo!”\n\n“We are going back together.”\n\n“I told you before too, together...”\n\n“The place where we part, isn’t here, right?”\n\n![](https://cdn.luogu.com.cn/upload/pic/58866.png)\n\n“So slow, the reaper who comes with spring.”\n\nDon’t be mad, I was in a real hurry too.\n\nDid you receive the letter?\n\n“Yeah, because the address was written very carefully.”\n\n“Using the fountain of wisdom, we finally arrived here.”\n\n![](https://cdn.luogu.com.cn/upload/pic/58867.png)\n\nNo matter how the world changes,\n\nAfter this time, we will never be separated again.", "description": "Victo rica gives you a sequence $a$. Each query gives an interval $[l,r]$.\n\nCount the number of ordered pairs $(i,j)$ such that $l \\leq i,j \\leq r$ and $a_i$ is a multiple of $a_j$.", "inputFormat": "The first line contains two integers $n,m$.\n\nThe second line contains $n$ integers, representing the sequence $a$.\n\nThen follow $m$ lines, each containing two integers $l,r$, representing one query.", "outputFormat": "For each query, output one line with one integer, representing the answer.", "hint": "Idea: nzhtl1477, Solution: nzhtl1477, Code: nzhtl1477, Data: nzhtl1477.\n\nConstraints: for $100\\%$ of the data, $1 \\leq n,m,a_i \\leq 5 \\times 10^5$, $1 \\leq l \\leq r \\leq n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2018] GOSICK", "background": "  ![](https://cdn.luogu.com.cn/upload/pic/58864.png)  \n洋...娃娃？\n\n“终于来了啊”\n\n“太慢了，伴随春天而来的死神”\n   ![](https://cdn.luogu.com.cn/upload/pic/58865.png)  \n维多利...加？\n\n你...手不疼吗\n\n手通红的啊\n\n“无路赛...振作一点”\n\n“如果在这里放弃的话就永远绝交了，久城！”\n\n“要一起回去”\n\n“之前也说过的吧 一起...”\n\n“我们俩分离的地方，不是这里吧”\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58866.png)  \n\n“太慢了，伴随春天而来的死神”\n\n别生气嘛 我这也是很赶时间了\n\n信收到了吗\n\n“嗯，因为都很认真写上地址了”\n\n“运用智慧之泉，终于到达了这里”\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58867.png)  \n\n无论世界如何改变\n\n这次之后 将再不分离\n\n\n", "description": "维多利加给了你一个序列 $a$，每次询问给一个区间 $[l,r]$。\n\n查询 $l \\leq i,j\\leq r$，且 $a_i$ 是 $a_j$ 倍数的二元组 $(i,j)$ 的个数。\n\n\n", "inputFormat": "第一行两个整数表示 $n,m$。\n\n第二行 $n$ 个整数表示序列 $a$。\n\n之后 $m$ 行，每行两个整数 $l,r$ 表示一次询问。\n", "outputFormat": "对于每个询问，输出一行一个整数表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\leq n,m,a_i\\leq 5\\times 10^5$，$1\\leq l\\leq r\\leq n$。", "locale": "zh-CN"}}}
{"pid": "P5399", "type": "P", "difficulty": 7, "samples": [["7\n1 1 2 3 5 2\n5\n5 1 5 0\n2 0 5 0\n2 2 4 5\n7 2 2 4\n3 2 5 4\n", "2\n3\n69\n57\n70\n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2018", "O2优化", "Ynoi"], "title": "[Ynoi2018] 駄作", "background": "以前在书上读到的皮格马利翁神话——\n\n记得那在年幼的自己看来，非常滑稽。\n\n那是一心一意地，\n\n雕刻着自己理想中的女性的男人的故事。\n\n对现实中的女性根本不看一眼。\n\n不把人类放在眼里，只是一味地爱着无机物。\n\n爱着没有灵魂的对象。\n\n在当时的我看来，那行为是极为的愚蠢。\n\n多么悲惨啊。\n\n高举理想的旗帜、悲惨地制作着爱情的投影。\n\n自导自演自我满足——那是失败者的作为。\n\n最后那人得到了女神阿佛洛狄忒的同情，\n\n令雕像拥有了灵魂。\n\n是羞耻的极致。不会成为美谈。\n\n被愚蠢的故事破坏了心情的我，\n\n粗暴地丢下了那本书。\n\n在那时。\n\n我忽然感觉到了。\n\n如同脚尖悬空般的微微的高昂感。\n\n目光所不能直视的耀眼光晕。\n\n心脏深处温柔且安静地紧揪着的感觉。\n\n不知为何，温柔的心情在胸中弥漫。\n\n这第一次体会到的心情是什么呢？\n\n温暖、粘稠、浑浊。\n\n舒适的小憩。\n\n愚蠢的男人的故事。\n\n毫无拯救价值的，蠢男人的恋爱观。\n\n知道了这一点——\n\n我——\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58868.png)  \n\n“这种烦恼谁都没办法理解啊……”\n\n“呜呜，好难过……”\n\n……\n\n“……嗯？怎么在发呆啊？”\n\n哎？啊，不是。没什么啦。\n\n总觉得……和我很相似。\n\n因为是对谁也不能说出口的烦恼所以很辛苦。\n\n现在的枢大概也是同样的心情吧。\n\n枢还真是有着不为人知的艰辛啊。\n\n“啊哈哈，算是吧。”\n\n“因为我有性别认知障碍啊，身体和内心的性别是不一样的，所以没什么可以分\n担苦恼的人。”\n\n“像这种下半身的事情，怎么也不能和别的女孩子讨论呢。”\n\n确实如此啊……\n\n“啊，好想干脆让身体也变成女性啊……该怎么办才好呢。”\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58869.png)  \n\n身体和内心的性别不一样吗……\n\n我倒不是性别认知障碍……\n\n不过，却非常理解枢的感受。\n\n“男性和女性都不能理解的烦恼……\n\n我就是个不完整的人吗……”\n\n怎么说不完整，才没这回事。\n\n“——是吗？”\n\n……啊。\n\n怎、怎么了……\n\n刚才，枢的气氛突然变了……\n\n“——我的烦恼啊，平时对谁也不会说的。”\n\n……\n\n“因为很难被理解啊，都当成是在开玩笑……根本没有谁真心想着帮我分担。”\n\n这……确实是呢……\n\n而我也是如此——\n\n“不过呢……”\n\n“——我挺想和由贵君商量的呢……”\n\n原本我就对枢抱有亲近感。\n\n心灵与身体的性别不一致的人。\n\n枢有着男性的身体和女性的内心。\n\n我也好枢也好……在旁人看来都是不完整的存在。\n\n不过……我——只有我能理解。\n\n——枢不是个不完整的人。\n\n正因为是同样不完整的存在，我才能从心底完全理解。\n\n我……对自己——想要枢理解我。\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58870.png)  \n\n“我们五人永远都是朋友……\n\n从前是……今后也是……”\n\n在大家安稳的话声中，我闭上眼。\n\n——不会消失。\n\n不管是星星的光辉，还是大家的温暖。\n\n已经牢牢地刻在了我的心中。\n\n一定不会忘记，五人一起度过的日子。\n\n我无论如何都不会忘记。绝不会忘记。\n\n是吗，我在寻求着啊……\n\n如此美好的羁绊……\n\n从心底里……\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58871.png)  \n\n枢惊讶的表情，慢慢地恢复了平静。\n\n我紧张地盯着枢的嘴唇，\n\n不知道他接下来要说什么。\n\n厌恶吗？恐惧吗？\n\n还是说勉强摆出生硬的笑容给我看？\n\n……哪个都会让人伤心难受。\n\n我很怕失去与枢之间的关系。\n\n“……由贵君。”\n\n心脏跳动着。\n\n“我——”\n\n枢所道出的话语，只有一句\n\n“——能接受由贵君。”\n\n我最期望着的话语——\n\n很有聪明的枢的风格的、简洁而又完美的话语。\n\n……谢谢。\n\n“诶嘿嘿……不用客气。”\n\n枢温柔的笑容包容着我。\n\n被人接受这件事，原来是如此惬意的啊……\n\n“……我说啊，由贵君”\n\n“和由贵君有着不普通的身体一样，我也不是普通的。”\n\n枢和我是不一样的……\n\n“不……我也是异常的。\n\n因为明明作为一个男性出生，却想成为女孩子。”\n\n“身体是男性……也没有胸部，也没有女性器。\n\n是真真正正的男性。”\n\n“明明这样还是想变成女性……\n\n我知道的。明明变不成……\n\n明明知道越是想成为女性就越会变得扭曲……”\n\n“即使如此我也想成为女性，不觉得我也是怪物吗？”\n\n……\n\n语塞了。\n\n但是，我仍然只是继续沉默着。\n\n这种时候，粉饰的话语也不会起什么作用。\n\n我知道随便的安慰是没有意义的。\n\n所以……我只是默默地凝视着枢。\n\n“呵呵，由贵君真是温柔呢……\n\n最清楚我是怎么想的。”\n\n因为我明白……枢的心情啊。\n\n听我如此说，枢便露出了发自内心的微笑。\n\n“有人能‘真正’理解我，这还是第一次。”\n\n我也是……终于遇见了能够接受自己的人。\n\n在漫长艰险的旅途尽头，我们终于得到了救赎。\n\n我也好，枢也好，都是与“普通”想去甚远的、\n\n因此才一直非常痛苦……\n\n不过我们终于——\n\n——遇到了能够理解自己的同伴。\n\n", "description": "菜菜子给了你一棵 $n$ 个节点的树，结点标号从 $1$ 到 $n$ 。\n\n定义树上两点 $a,b$ 的距离 $d(a,b)$ 是最小的非负整数 $k$ ，满足存在结点序列 $v_0,v_1,...,v_k$ ，满足 $v_0=a,v_k=b$ ，且对于 $0\\leq i\\leq k-1$ 有 $v_i$ 和 $v_{i+1}$ 之间在树上有一条边相连。\n\n有 $m$ 个询问，每个询问包含参数 $p_0,d_0,p_1,d_1$ ，求：\n\n$$\\sum\\limits_{d(p_0,a)\\leq d_0}\\sum\\limits_{d(p_1,b)\\leq d_1}d(a,b)$$\n", "inputFormat": "第一行一个整数 $n$ ，表示树的节点数目。\n\n接下来一行 $n-1$ 个整数 $f_2,f_3,...,f_n$ ，依次表示 $i$ 和 $f_i$ （ $1\\leq f_i\\leq i-1$ ）之间有一条边。\n\n接下来一行一个整数 $m$ ，表示询问数目。\n\n接下来 $m$ 行依次描述所有询问：每行四个整数 $p_0,d_0,p_1,d_1$ （ $1\\leq p_0,p_1\\leq n,0\\leq d_0,d_1\\leq n-1$ ）描述一组询问。\n\n\n", "outputFormat": "共 $m$ 行，依次回答各组询问：每行输出一行一个整数表示这组询问的答案。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n对于 $100\\%$ 的数据，保证 $1\\leq n\\leq 10^5,1\\leq m\\leq 10^5$ 。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi2018] A Poor Work", "background": "The Pygmalion myth I once read in a book—\n\nBack when I was young, I found it very ridiculous.\n\nIt was the story of a man who devoted himself\n\nto carving the woman of his ideals.\n\nHe would not even glance at real women.\n\nHe looked down on humans, and only loved inorganic things.\n\nHe loved something without a soul.\n\nAt that time, I thought that behavior was extremely foolish.\n\nHow tragic.\n\nHolding high the banner of ideals, he miserably created a projection of love.\n\nSelf-directed and self-satisfied—that is what losers do.\n\nIn the end, the man received the pity of the goddess Aphrodite,\n\nand the statue was given a soul.\n\nThe height of shame. It would never be a beautiful tale.\n\nWith my mood ruined by that stupid story,\n\nI roughly threw the book aside.\n\nAt that moment.\n\nI suddenly felt it.\n\nA slight uplift, as if the tip of my foot was hanging in the air.\n\nA dazzling halo I could not look at directly.\n\nA gentle, quiet tightness deep in my heart.\n\nFor some reason, a gentle feeling spread through my chest.\n\nWhat was this feeling, which I was experiencing for the first time?\n\nWarm, sticky, murky.\n\nA comfortable nap.\n\nThe story of a foolish man.\n\nA fool’s view of love, with no value in being saved.\n\nRealizing that—\n\nI—\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58868.png)  \n\n“No one can understand this kind of trouble at all…”\n\n“Wuwu, it hurts so much…”\n\n……\n\n“…Huh? Why are you spacing out?”\n\nEh? Ah, no. It’s nothing.\n\nSomehow… it feels very similar to me.\n\nIt is hard because it is a worry I cannot tell anyone.\n\nShu is probably feeling the same way right now.\n\nShu really has hardships that others do not know about.\n\n“Ahaha, I guess so.”\n\n“Because I have gender identity disorder (xingbie renshi zhang’ai). My body and my inner gender are different, so there’s no one I can share my troubles with.”\n\n“For things like this about the lower body, there’s no way I can talk about it with other girls.”\n\nThat is indeed true…\n\n“Ah, I really want to just make my body become female too… what should I do?”\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58869.png)  \n\nYour body and your inner gender are different…\n\nI am not someone with gender identity disorder…\n\nBut I understand Shu’s feelings very well.\n\n“Troubles that neither men nor women can understand…\n\nAm I… an incomplete person…?”\n\nHow could you be incomplete? That’s not true at all.\n\n“—Is that so?”\n\n…Ah.\n\nW-what is it…\n\nJust now, Shu’s mood suddenly changed…\n\n“—About my troubles, I normally wouldn’t tell anyone.”\n\n……\n\n“Because it’s hard to be understood. People treat it as a joke… no one truly wants to help me share the burden.”\n\nTh… that is true…\n\nAnd I am the same—\n\n“But…”\n\n“—I really want to talk it over with you, Yuki-kun…”\n\nI already felt close to Shu.\n\nA person whose mind and body do not match in gender.\n\nShu has a male body and a female heart.\n\nBoth Shu and I… in other people’s eyes, we are incomplete beings.\n\nBut… I—\n\nOnly I can understand.\n\n—Shu is not an incomplete person.\n\nPrecisely because we are both incomplete, I can fully understand from the bottom of my heart.\n\nI… for myself—I want Shu to understand me.\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58870.png)  \n\n“The five of us will always be friends…\n\nIn the past… and in the future too…”\n\nAmid everyone’s calm voices, I close my eyes.\n\n—It will not disappear.\n\nNeither the shine of the stars, nor everyone’s warmth.\n\nThey are already deeply engraved in my heart.\n\nI will definitely not forget the days the five of us spent together.\n\nNo matter what, I will not forget. I will never forget.\n\nSo that’s it, I was seeking it…\n\nSuch wonderful bonds…\n\nFrom the bottom of my heart…\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58871.png)  \n\nShu’s surprised expression slowly returned to calm.\n\nNervously, I stared at Shu’s lips,\n\nnot knowing what he would say next.\n\nDisgust? Fear?\n\nOr would he force out a stiff smile for me?\n\n…Any of those would make me sad and miserable.\n\nI was very afraid of losing my relationship with Shu.\n\n“…Yuki-kun.”\n\nMy heart was pounding.\n\n“I—”\n\nThe words Shu spoke were only one sentence.\n\n“—I can accept you, Yuki-kun.”\n\nThe words I wanted most—\n\nIn Shu’s smart style: simple yet perfect words.\n\n…Thank you.\n\n“Ehehe… you’re welcome.”\n\nShu’s gentle smile embraced me.\n\nBeing accepted by someone… feels so pleasant.\n\n“…Say, Yuki-kun.”\n\n“Just like you have an unusual body, I’m not ordinary either.”\n\nShu and I are not the same…\n\n“No… I am abnormal too.\n\nBecause even though I was born as a male, I want to become a girl.”\n\n“My body is male… I don’t have breasts, and I don’t have female genitalia.\n\nI’m a real male.”\n\n“Even so, I still want to become female…\n\nI know it. Even though I can’t become one…\n\nEven though I know the more I want to become female, the more twisted I will become…”\n\n“Even so, I still want to become female. Don’t you think I’m a monster too?”\n\n……\n\nI was at a loss for words.\n\nBut I still only kept silent.\n\nAt times like this, sugarcoated words will not help.\n\nI know casual comfort has no meaning.\n\nSo… I simply gazed at Shu in silence.\n\n“Hehe, Yuki-kun is really gentle…\n\nYou understand best what I’m thinking.”\n\nBecause I understand… Shu’s feelings.\n\nHearing me say that, Shu showed a smile from the bottom of his heart.\n\n“This is the first time someone has ‘truly’ understood me.”\n\nMe too… I finally met someone who could accept me.\n\nAt the end of a long and hard journey, we finally found salvation.\n\nBoth Shu and I are far from “ordinary”,\n\nand that is why we have suffered so much…\n\nBut finally we—\n\n—met a companion who can understand us.", "description": "Caicaizi gives you a tree with $n$ nodes, numbered from $1$ to $n$.\n\nDefine the distance $d(a,b)$ between two nodes $a,b$ on the tree as the smallest non-negative integer $k$ such that there exists a node sequence $v_0,v_1,...,v_k$ with $v_0=a,v_k=b$, and for $0\\leq i\\leq k-1$, there is an edge connecting $v_i$ and $v_{i+1}$ in the tree.\n\nThere are $m$ queries. Each query contains parameters $p_0,d_0,p_1,d_1$. Compute:\n\n$$\\sum\\limits_{d(p_0,a)\\leq d_0}\\sum\\limits_{d(p_1,b)\\leq d_1}d(a,b)$$", "inputFormat": "The first line contains an integer $n$, representing the number of nodes in the tree.\n\nThe next line contains $n-1$ integers $f_2,f_3,...,f_n$, which indicate that there is an edge between $i$ and $f_i$ ($1\\leq f_i\\leq i-1$).\n\nThe next line contains an integer $m$, representing the number of queries.\n\nThe next $m$ lines describe all queries. Each line contains four integers $p_0,d_0,p_1,d_1$ ($1\\leq p_0,p_1\\leq n,0\\leq d_0,d_1\\leq n-1$), describing one query.", "outputFormat": "Output $m$ lines, answering the queries in order. Each line outputs one integer, which is the answer to that query.", "hint": "Idea: nzhtl1477, Solution: ccz181078, Code: ccz181078, Data: ccz181078\n\nConstraints: for $100\\%$ of the data, $1\\leq n\\leq 10^5$ and $1\\leq m\\leq 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi2018] 駄作", "background": "以前在书上读到的皮格马利翁神话——\n\n记得那在年幼的自己看来，非常滑稽。\n\n那是一心一意地，\n\n雕刻着自己理想中的女性的男人的故事。\n\n对现实中的女性根本不看一眼。\n\n不把人类放在眼里，只是一味地爱着无机物。\n\n爱着没有灵魂的对象。\n\n在当时的我看来，那行为是极为的愚蠢。\n\n多么悲惨啊。\n\n高举理想的旗帜、悲惨地制作着爱情的投影。\n\n自导自演自我满足——那是失败者的作为。\n\n最后那人得到了女神阿佛洛狄忒的同情，\n\n令雕像拥有了灵魂。\n\n是羞耻的极致。不会成为美谈。\n\n被愚蠢的故事破坏了心情的我，\n\n粗暴地丢下了那本书。\n\n在那时。\n\n我忽然感觉到了。\n\n如同脚尖悬空般的微微的高昂感。\n\n目光所不能直视的耀眼光晕。\n\n心脏深处温柔且安静地紧揪着的感觉。\n\n不知为何，温柔的心情在胸中弥漫。\n\n这第一次体会到的心情是什么呢？\n\n温暖、粘稠、浑浊。\n\n舒适的小憩。\n\n愚蠢的男人的故事。\n\n毫无拯救价值的，蠢男人的恋爱观。\n\n知道了这一点——\n\n我——\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58868.png)  \n\n“这种烦恼谁都没办法理解啊……”\n\n“呜呜，好难过……”\n\n……\n\n“……嗯？怎么在发呆啊？”\n\n哎？啊，不是。没什么啦。\n\n总觉得……和我很相似。\n\n因为是对谁也不能说出口的烦恼所以很辛苦。\n\n现在的枢大概也是同样的心情吧。\n\n枢还真是有着不为人知的艰辛啊。\n\n“啊哈哈，算是吧。”\n\n“因为我有性别认知障碍啊，身体和内心的性别是不一样的，所以没什么可以分\n担苦恼的人。”\n\n“像这种下半身的事情，怎么也不能和别的女孩子讨论呢。”\n\n确实如此啊……\n\n“啊，好想干脆让身体也变成女性啊……该怎么办才好呢。”\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58869.png)  \n\n身体和内心的性别不一样吗……\n\n我倒不是性别认知障碍……\n\n不过，却非常理解枢的感受。\n\n“男性和女性都不能理解的烦恼……\n\n我就是个不完整的人吗……”\n\n怎么说不完整，才没这回事。\n\n“——是吗？”\n\n……啊。\n\n怎、怎么了……\n\n刚才，枢的气氛突然变了……\n\n“——我的烦恼啊，平时对谁也不会说的。”\n\n……\n\n“因为很难被理解啊，都当成是在开玩笑……根本没有谁真心想着帮我分担。”\n\n这……确实是呢……\n\n而我也是如此——\n\n“不过呢……”\n\n“——我挺想和由贵君商量的呢……”\n\n原本我就对枢抱有亲近感。\n\n心灵与身体的性别不一致的人。\n\n枢有着男性的身体和女性的内心。\n\n我也好枢也好……在旁人看来都是不完整的存在。\n\n不过……我——只有我能理解。\n\n——枢不是个不完整的人。\n\n正因为是同样不完整的存在，我才能从心底完全理解。\n\n我……对自己——想要枢理解我。\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58870.png)  \n\n“我们五人永远都是朋友……\n\n从前是……今后也是……”\n\n在大家安稳的话声中，我闭上眼。\n\n——不会消失。\n\n不管是星星的光辉，还是大家的温暖。\n\n已经牢牢地刻在了我的心中。\n\n一定不会忘记，五人一起度过的日子。\n\n我无论如何都不会忘记。绝不会忘记。\n\n是吗，我在寻求着啊……\n\n如此美好的羁绊……\n\n从心底里……\n\n   ![](https://cdn.luogu.com.cn/upload/pic/58871.png)  \n\n枢惊讶的表情，慢慢地恢复了平静。\n\n我紧张地盯着枢的嘴唇，\n\n不知道他接下来要说什么。\n\n厌恶吗？恐惧吗？\n\n还是说勉强摆出生硬的笑容给我看？\n\n……哪个都会让人伤心难受。\n\n我很怕失去与枢之间的关系。\n\n“……由贵君。”\n\n心脏跳动着。\n\n“我——”\n\n枢所道出的话语，只有一句\n\n“——能接受由贵君。”\n\n我最期望着的话语——\n\n很有聪明的枢的风格的、简洁而又完美的话语。\n\n……谢谢。\n\n“诶嘿嘿……不用客气。”\n\n枢温柔的笑容包容着我。\n\n被人接受这件事，原来是如此惬意的啊……\n\n“……我说啊，由贵君”\n\n“和由贵君有着不普通的身体一样，我也不是普通的。”\n\n枢和我是不一样的……\n\n“不……我也是异常的。\n\n因为明明作为一个男性出生，却想成为女孩子。”\n\n“身体是男性……也没有胸部，也没有女性器。\n\n是真真正正的男性。”\n\n“明明这样还是想变成女性……\n\n我知道的。明明变不成……\n\n明明知道越是想成为女性就越会变得扭曲……”\n\n“即使如此我也想成为女性，不觉得我也是怪物吗？”\n\n……\n\n语塞了。\n\n但是，我仍然只是继续沉默着。\n\n这种时候，粉饰的话语也不会起什么作用。\n\n我知道随便的安慰是没有意义的。\n\n所以……我只是默默地凝视着枢。\n\n“呵呵，由贵君真是温柔呢……\n\n最清楚我是怎么想的。”\n\n因为我明白……枢的心情啊。\n\n听我如此说，枢便露出了发自内心的微笑。\n\n“有人能‘真正’理解我，这还是第一次。”\n\n我也是……终于遇见了能够接受自己的人。\n\n在漫长艰险的旅途尽头，我们终于得到了救赎。\n\n我也好，枢也好，都是与“普通”想去甚远的、\n\n因此才一直非常痛苦……\n\n不过我们终于——\n\n——遇到了能够理解自己的同伴。\n\n", "description": "菜菜子给了你一棵 $n$ 个节点的树，结点标号从 $1$ 到 $n$ 。\n\n定义树上两点 $a,b$ 的距离 $d(a,b)$ 是最小的非负整数 $k$ ，满足存在结点序列 $v_0,v_1,...,v_k$ ，满足 $v_0=a,v_k=b$ ，且对于 $0\\leq i\\leq k-1$ 有 $v_i$ 和 $v_{i+1}$ 之间在树上有一条边相连。\n\n有 $m$ 个询问，每个询问包含参数 $p_0,d_0,p_1,d_1$ ，求：\n\n$$\\sum\\limits_{d(p_0,a)\\leq d_0}\\sum\\limits_{d(p_1,b)\\leq d_1}d(a,b)$$\n", "inputFormat": "第一行一个整数 $n$ ，表示树的节点数目。\n\n接下来一行 $n-1$ 个整数 $f_2,f_3,...,f_n$ ，依次表示 $i$ 和 $f_i$ （ $1\\leq f_i\\leq i-1$ ）之间有一条边。\n\n接下来一行一个整数 $m$ ，表示询问数目。\n\n接下来 $m$ 行依次描述所有询问：每行四个整数 $p_0,d_0,p_1,d_1$ （ $1\\leq p_0,p_1\\leq n,0\\leq d_0,d_1\\leq n-1$ ）描述一组询问。\n\n\n", "outputFormat": "共 $m$ 行，依次回答各组询问：每行输出一行一个整数表示这组询问的答案。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n对于 $100\\%$ 的数据，保证 $1\\leq n\\leq 10^5,1\\leq m\\leq 10^5$ 。", "locale": "zh-CN"}}}
{"pid": "P5400", "type": "P", "difficulty": 7, "samples": [["5\n1 1 1 1\n2 2 2 1\n7 8 9 3\n123 456 789 1\n1000 1000 1000 10", "1\n142606337\n736950806\n246172965\n189652652"], ["10\n4975401 4951343 4803566 22\n4499697 4989534 4995301 89\n4960387 4800714 4985451 20\n4549943 4925900 4582735 36\n3010525 4611932 4998770 67\n4980964 4865325 4531707 55\n2953628 4962026 4999540 52\n4599954 4988700 4817773 75\n4981351 4950027 4852696 16\n4695981 4993997 4953978 2\n", "856105281\n423884937\n154402492\n813209966\n683750161\n337149076\n838552619\n849850633\n605653899\n384868262\n"]], "limits": {"time": [12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000, 12000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "CTSC/CTS"], "title": "[CTS2019] 随机立方体", "background": "", "description": "有一个 $n\\times m\\times l$ 的立方体，立方体中每个格子上都有一个数，如果某个格子上的数比三维坐标**至少有一维**相同的其他格子上的数都要大的话，我们就称它是极大的。\n\n现在将 $1\\sim n\\times m\\times l$ 这 $n\\times m\\times l$ 个数等概率随机填入 $n\\times m\\times l$ 个格子（即任意数字出现在任意格子上的概率均相等），使得每个数恰出现一次，求恰有 $k$ 个极大的数的概率。答案对 $998244353$（一个质数）取模。", "inputFormat": "输入包含多组数据。输入第一行包含一个正整数 $T$，表示数据组数。\n\n接下来 $T$ 行，每行一组数据，包含 $4$ 个正整数 $n,m,l,k$，表示一次询问。 ", "outputFormat": "对于每次询问，输出一行一个整数，表示答案对 $998244353$ 取模的余数。\n\n可以证明，答案一定为有理数。设其为 $a/b$（$a$ 和 $b$ 为互质的正整数，数据保证 $b$ 不为 $998244353$ 的倍数），则你需要保证输出的数 $x$ 满足 $0\\le x < 998244353$ 且 $a\\equiv bx \\pmod{998244353}$。可以证明这样的 $x$ 唯一存在。", "hint": "对于 $10\\%$ 的数据，$n,m\\le 2$，$l\\le 3$，$k=1$。\n\n对于 $30\\%$ 的数据，$n,m,l,k\\le 12$。\n\n对于 $40\\%$ 的数据，$n,m,l\\le 100$。\n\n对于 $50\\%$ 的数据，$n,m,l\\le 1000$。\n\n对于 $60\\%$ 的数据，$n,m,l\\le 100000$，其中有占全部数据 $30\\%$ 的数据保证 $k=1$。\n\n对于 $80\\%$ 的数据，$n,m,l\\le 1000000$，其中有占全部数据 $40\\%$ 的数据保证 $k=1$。\n\n对于 $100\\%$ 的数据，$1\\le n,m,l\\le 5000000$，$1\\le k\\le 100$，$1\\le T\\le 10$。\n\n其中有 $50\\%$ 的数据保证 $k=1$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTS2019] Random Cube", "background": "", "description": "There is an $n\\times m\\times l$ cube. Each cell in the cube contains a number. If the number in a cell is greater than the numbers in all other cells that share **at least one** coordinate (in 3D) with it, then we call it a maximal cell.\n\nNow place the $n\\times m\\times l$ numbers from $1$ to $n\\times m\\times l$ into the $n\\times m\\times l$ cells uniformly at random (that is, each number is equally likely to appear in any cell), with each number appearing exactly once. Find the probability that there are exactly $k$ maximal numbers. Output the answer modulo $998244353$ (a prime).", "inputFormat": "The input contains multiple test cases. The first line contains a positive integer $T$, the number of test cases.\n\nThe next $T$ lines each contain four positive integers $n,m,l,k$, representing one query.", "outputFormat": "For each query, output one line with one integer, the remainder of the answer modulo $998244353$.\n\nIt can be proven that the answer is always a rational number. Suppose it is $a/b$ (where $a$ and $b$ are coprime positive integers, and the testdata guarantees that $b$ is not a multiple of $998244353$). Then you need to output a number $x$ such that $0\\le x < 998244353$ and $a\\equiv bx \\pmod{998244353}$. It can be proven that such an $x$ exists and is unique.", "hint": "For $10\\%$ of the testdata, $n,m\\le 2$, $l\\le 3$, and $k=1$.\n\nFor $30\\%$ of the testdata, $n,m,l,k\\le 12$.\n\nFor $40\\%$ of the testdata, $n,m,l\\le 100$.\n\nFor $50\\%$ of the testdata, $n,m,l\\le 1000$.\n\nFor $60\\%$ of the testdata, $n,m,l\\le 100000$, and among them, $30\\%$ of all testdata guarantees $k=1$.\n\nFor $80\\%$ of the testdata, $n,m,l\\le 1000000$, and among them, $40\\%$ of all testdata guarantees $k=1$.\n\nFor $100\\%$ of the testdata, $1\\le n,m,l\\le 5000000$, $1\\le k\\le 100$, and $1\\le T\\le 10$.\n\nAmong them, $50\\%$ of the testdata guarantees $k=1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTS2019] 随机立方体", "background": "", "description": "有一个 $n\\times m\\times l$ 的立方体，立方体中每个格子上都有一个数，如果某个格子上的数比三维坐标**至少有一维**相同的其他格子上的数都要大的话，我们就称它是极大的。\n\n现在将 $1\\sim n\\times m\\times l$ 这 $n\\times m\\times l$ 个数等概率随机填入 $n\\times m\\times l$ 个格子（即任意数字出现在任意格子上的概率均相等），使得每个数恰出现一次，求恰有 $k$ 个极大的数的概率。答案对 $998244353$（一个质数）取模。", "inputFormat": "输入包含多组数据。输入第一行包含一个正整数 $T$，表示数据组数。\n\n接下来 $T$ 行，每行一组数据，包含 $4$ 个正整数 $n,m,l,k$，表示一次询问。 ", "outputFormat": "对于每次询问，输出一行一个整数，表示答案对 $998244353$ 取模的余数。\n\n可以证明，答案一定为有理数。设其为 $a/b$（$a$ 和 $b$ 为互质的正整数，数据保证 $b$ 不为 $998244353$ 的倍数），则你需要保证输出的数 $x$ 满足 $0\\le x < 998244353$ 且 $a\\equiv bx \\pmod{998244353}$。可以证明这样的 $x$ 唯一存在。", "hint": "对于 $10\\%$ 的数据，$n,m\\le 2$，$l\\le 3$，$k=1$。\n\n对于 $30\\%$ 的数据，$n,m,l,k\\le 12$。\n\n对于 $40\\%$ 的数据，$n,m,l\\le 100$。\n\n对于 $50\\%$ 的数据，$n,m,l\\le 1000$。\n\n对于 $60\\%$ 的数据，$n,m,l\\le 100000$，其中有占全部数据 $30\\%$ 的数据保证 $k=1$。\n\n对于 $80\\%$ 的数据，$n,m,l\\le 1000000$，其中有占全部数据 $40\\%$ 的数据保证 $k=1$。\n\n对于 $100\\%$ 的数据，$1\\le n,m,l\\le 5000000$，$1\\le k\\le 100$，$1\\le T\\le 10$。\n\n其中有 $50\\%$ 的数据保证 $k=1$。", "locale": "zh-CN"}}}
{"pid": "P5401", "type": "P", "difficulty": 7, "samples": [["2 2 1", "2"], ["8 10 4", "301103104"], ["998 1000 500", "762913089"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "CTSC/CTS"], "title": "[CTS2019] 珍珠", "background": "白云苍狗，沧海桑田。\n\n白云的眼前只剩下了模糊的一片。\n\n在若隐若现之中，它看到了一个个小小的珍珠，有一些发着五彩的光芒。这些珍珠是白兔留下来的，每颗珍珠有一个颜色，为 $D$ 种颜色中随机的一种。\n\n白云想把这些珍珠放进一些小瓶子中，每个瓶子能恰好容纳两颗珍珠。不过它也有要求，每个瓶子必须装满，并且装的都是相同颜色的珍珠。\n\n白云希望能得到至少 $m$ 个装满珍珠的瓶子，它想知道它的愿望能被实现的概率是多少呢？", "description": "有 $n$ 个在范围 $[1,D]$ 内的整数均匀随机变量。\n\n求至少能选出 $m$ 个瓶子，使得存在一种方案，选择一些变量，并把选出来的每一个变量放到一个瓶子中，满足每个瓶子都恰好装两个值相同的变量的概率。\n\n请输出概率乘上 $D^n$ 后对 $998244353$ 取模的值。取模部分说明可参考第一题。", "inputFormat": "输入仅一行，三个用空格隔开的整数 $D,n,m$。", "outputFormat": "输出一个整数，表示所求概率乘上 $D^n$ 后对 $998244353$ 取模的结果。", "hint": "#### 样例 1 解释\n情况 $1$ : 第一个变量为 $1$，第二个变量为 $1$\n\n情况 $2$ : 第一个变量为 $1$，第二个变量为 $2$\n\n情况 $3$ : 第一个变量为 $2$，第二个变量为 $1$\n\n情况 $4$ : 第一个变量为 $2$，第二个变量为 $2$\n\n其中情况 $1$ 和 $4$ 可以把两个变量放到一个瓶子中\n\n情况 $2$ 和 $3$ 中两个变量的值不相同，所以不能放到同一个瓶子中\n\n#### 测试数据约定\n![img](https://s2.ax1x.com/2019/05/17/Eq683D.png)\n\n所有测试点均满足 $0 \\leqslant  m \\leqslant  10^9,1 \\leqslant  n \\leqslant  10^9,1 \\leqslant  D \\leqslant  10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTS2019] Pearls", "background": "Time passes and everything changes.\n\nIn front of Baiyun, only a blurred scene remains.\n\nIn the vague view, it saw many small pearls, some shining with colorful light. These pearls were left by the white rabbit. Each pearl has a color, randomly chosen from $D$ colors.\n\nBaiyun wants to put these pearls into some small bottles. Each bottle can hold exactly two pearls. It also has requirements: every bottle must be full, and the two pearls in it must have the same color.\n\nBaiyun hopes to obtain at least $m$ full bottles of pearls, and it wants to know the probability that its wish can be achieved.", "description": "There are $n$ independent uniformly random integer variables in the range $[1,D]$.\n\nFind the probability that we can choose at least $m$ bottles, such that there exists a way to select some variables and put each selected variable into a bottle, satisfying that each bottle contains exactly two variables with the same value.\n\nOutput the value of the probability multiplied by $D^n$, taken modulo $998244353$. For the modulo details, refer to Problem 1.", "inputFormat": "The input contains only one line with three integers $D,n,m$ separated by spaces.", "outputFormat": "Output one integer, representing the required value of the probability multiplied by $D^n$ modulo $998244353$.", "hint": "#### Sample 1 Explanation\n\nCase $1$: the first variable is $1$, and the second variable is $1$.\n\nCase $2$: the first variable is $1$, and the second variable is $2$.\n\nCase $3$: the first variable is $2$, and the second variable is $1$.\n\nCase $4$: the first variable is $2$, and the second variable is $2$.\n\nIn cases $1$ and $4$, we can put the two variables into one bottle.\n\nIn cases $2$ and $3$, the two variables have different values, so they cannot be put into the same bottle.\n\n#### Testdata Convention\n\n![img](https://s2.ax1x.com/2019/05/17/Eq683D.png)\n\nAll test points satisfy $0 \\leqslant  m \\leqslant  10^9,1 \\leqslant  n \\leqslant  10^9,1 \\leqslant  D \\leqslant  10^5$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTS2019] 珍珠", "background": "白云苍狗，沧海桑田。\n\n白云的眼前只剩下了模糊的一片。\n\n在若隐若现之中，它看到了一个个小小的珍珠，有一些发着五彩的光芒。这些珍珠是白兔留下来的，每颗珍珠有一个颜色，为 $D$ 种颜色中随机的一种。\n\n白云想把这些珍珠放进一些小瓶子中，每个瓶子能恰好容纳两颗珍珠。不过它也有要求，每个瓶子必须装满，并且装的都是相同颜色的珍珠。\n\n白云希望能得到至少 $m$ 个装满珍珠的瓶子，它想知道它的愿望能被实现的概率是多少呢？", "description": "有 $n$ 个在范围 $[1,D]$ 内的整数均匀随机变量。\n\n求至少能选出 $m$ 个瓶子，使得存在一种方案，选择一些变量，并把选出来的每一个变量放到一个瓶子中，满足每个瓶子都恰好装两个值相同的变量的概率。\n\n请输出概率乘上 $D^n$ 后对 $998244353$ 取模的值。取模部分说明可参考第一题。", "inputFormat": "输入仅一行，三个用空格隔开的整数 $D,n,m$。", "outputFormat": "输出一个整数，表示所求概率乘上 $D^n$ 后对 $998244353$ 取模的结果。", "hint": "#### 样例 1 解释\n情况 $1$ : 第一个变量为 $1$，第二个变量为 $1$\n\n情况 $2$ : 第一个变量为 $1$，第二个变量为 $2$\n\n情况 $3$ : 第一个变量为 $2$，第二个变量为 $1$\n\n情况 $4$ : 第一个变量为 $2$，第二个变量为 $2$\n\n其中情况 $1$ 和 $4$ 可以把两个变量放到一个瓶子中\n\n情况 $2$ 和 $3$ 中两个变量的值不相同，所以不能放到同一个瓶子中\n\n#### 测试数据约定\n![img](https://s2.ax1x.com/2019/05/17/Eq683D.png)\n\n所有测试点均满足 $0 \\leqslant  m \\leqslant  10^9,1 \\leqslant  n \\leqslant  10^9,1 \\leqslant  D \\leqslant  10^5$。", "locale": "zh-CN"}}}
{"pid": "P5402", "type": "P", "difficulty": 7, "samples": [["1 3\n1 1\n1 1\n2 1", "1 0 0 0\n1 0 1 0\n1 1 0 1"], ["2 4\n2 2\n1 1\n1 1\n2 1\n2 1", "1 0 0 0\n1 0 1 0\n1 1 0 1\n0"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "提交答案", "Special Judge", "CTSC/CTS"], "title": "[CTS2019] 无处安放", "background": "寂寥深夜，朦朦胧胧的月光为一切都笼上一层轻纱，你漫步在幽径，时而低头沉\n吟，时而凝望星空，只独孤与彷徨作伴，哪怕只言片语却也无人倾诉，万千思绪伴着你炽热的心，随风而动，无处安放……", "description": "你整理出了 $n$ 条思绪，它们在你的心中是一个个矩形 $r_i$，你想要在心中用一个大矩形 $R$ 安放它们，也就是将 $r_i$ 放置在 $R$ 内部。为了保护这些思绪，它们安放的位置不能与其他思绪有重合部分，并且四条边要平行或垂直于 $R$ 的边。两个思绪有重合部分，指它们安放位置的重合面积大于零。\n\n你有两种安放方式：\n1. 将 $n$ 条思绪全部安放进R 中，希望令 $R$ 的面积尽量小。\n2. 固定 $R$ 的大小，希望将尽量多的思绪安放进 $R$ 中。\n\n现在我已知晓你整理好的思绪，为你选择了安放的方式，我想知道你心中最好的安放方案，请你告诉我。", "inputFormat": "第一行两个整数 $type, n$，分别表示安放方式与思绪的个数。\n\n若 $type = 2$，第二行两个整数 $W, H$，表示 $R$ 的边长。\n\n接下来 $n$ 行每行两个整数 $w_i, h_i$，表示第 $i$ 个思绪即 $r_i$ 的边长。\n\n同一行中输入的整数均以一个空格分隔开。", "outputFormat": "为了方便，若 $R$ 的边长为 $W, H$，我们将安放方案视作一个 $(0, 0)\\sim(W, H)$ 的直角坐标系。注意对于 $type = 2$ 的测试点，你应按输入，将其视作 $(0, 0)\\sim(W, H)$ 的坐标系，而不是 $(0, 0) \\sim (H, W)$ 的坐标系。\n\n输出共有 $n$ 行，每行一或四个整数，描述第 $i$ 个思绪即 $r_i$ 的放置方案。\n\n每行第一个整数 $c_i$，其中 $c_i = 1$ 表示 $r_i$ 被安放在 $R$ 中；$c_i = 0$ 表示 $r_i$ 未被安放在 $R$ 中。\n\n若 $c_i = 1$, 则该行接下来应输出三个整数 $x_i$, $y_i$, $d_{ir_i}$。若 $d_{ir_i} = 0$，则 $r_i$ 放置在 $(x_i, y_i)\\sim(x_i + w_i, y_i + h_i)$ 的矩形范围内；若 $d_{ir_i} = 1$，则 $r_i$ 放置在 $(x_i, y_i)\\sim(x_i + h_i, y_i + w_i)$ 的矩形范围内。\n\n请注意确保你的输出格式正确，且 $c_i, d_{ir_i} \\in \\{0, 1\\}$。对于 $type = 1$ 的测试点，所有 $c_i$ 均应为 $1$。\n\n同一行中输出的整数应以一个空格分隔开。", "hint": "#### 评分方式\n\n每个测试点设置了 $10$ 个评分参数 $a_1, a_2, ..., a_{10}$。若选手输出不合法，则得零分。\n\n否则，对于安放方式 $1$，令 $val$ 为 $R$ 的面积，若 $val \\leq a_i$，则你可获得 $i$ 分；对于安放方式 $2$，令 $val$ 为安放到 $R$ 中的思绪个数，若 $val \\geq a_i$ 则你可获得 $i$ 分。满足多个得分条件，测试点得分取最高者。", "locale": "zh-CN", "translations": {"en": {"title": "[CTS2019] No Place to Put", "background": "In the lonely late night, the hazy moonlight puts a thin veil over everything. You walk along a quiet path, sometimes lowering your head in thought, sometimes gazing at the starry sky. You are accompanied only by loneliness and hesitation. Even if you have a few words, there is no one to talk to. Countless thoughts move with your burning heart, drifting with the wind, with nowhere to be placed.", "description": "You have整理 organized $n$ thoughts. In your heart, each of them is a rectangle $r_i$. You want to use a big rectangle $R$ in your heart to place them, that is, place each $r_i$ inside $R$. To protect these thoughts, their placed positions must not overlap with each other, and their four sides must be parallel or perpendicular to the sides of $R$. Two thoughts are considered overlapping if the intersection area of their placed positions is greater than zero.\n\nYou have two placing methods:\n1. Place all $n$ thoughts into $R$, and hope to make the area of $R$ as small as possible.\n2. Fix the size of $R$, and hope to place as many thoughts as possible into $R$.\n\nNow I already know the thoughts you have organized, and I have chosen the placing method for you. I want to know the best placing plan in your heart. Please tell me.", "inputFormat": "The first line contains two integers $type, n$, representing the placing method and the number of thoughts, respectively.\n\nIf $type = 2$, the second line contains two integers $W, H$, representing the side lengths of $R$.\n\nThe next $n$ lines each contain two integers $w_i, h_i$, representing the side lengths of the $i$-th thought, i.e., $r_i$.\n\nIntegers on the same line are separated by a single space.", "outputFormat": "For convenience, if the side lengths of $R$ are $W, H$, we view the placing plan as a Cartesian coordinate system $(0, 0)\\sim(W, H)$. Note that for test points with $type = 2$, you should follow the input and treat it as the coordinate system $(0, 0)\\sim(W, H)$, rather than $(0, 0)\\sim(H, W)$.\n\nOutput a total of $n$ lines. Each line contains one or four integers, describing the placement plan of the $i$-th thought, i.e., $r_i$.\n\nThe first integer on each line is $c_i$. Here $c_i = 1$ means that $r_i$ is placed in $R$; $c_i = 0$ means that $r_i$ is not placed in $R$.\n\nIf $c_i = 1$, then output three more integers $x_i$, $y_i$, $d_{ir_i}$. If $d_{ir_i} = 0$, then $r_i$ is placed within the rectangle $(x_i, y_i)\\sim(x_i + w_i, y_i + h_i)$; if $d_{ir_i} = 1$, then $r_i$ is placed within the rectangle $(x_i, y_i)\\sim(x_i + h_i, y_i + w_i)$.\n\nPlease make sure your output format is correct, and that $c_i, d_{ir_i} \\in \\{0, 1\\}$. For test points with $type = 1$, all $c_i$ must be $1$.\n\nIntegers on the same line should be separated by a single space.", "hint": "#### Scoring\n\nEach test point provides $10$ scoring parameters $a_1, a_2, ..., a_{10}$. If a contestant’s output is invalid, the score is zero.\n\nOtherwise, for placing method $1$, let $val$ be the area of $R$. If $val \\leq a_i$, then you can get $i$ points. For placing method $2$, let $val$ be the number of thoughts placed into $R$. If $val \\geq a_i$, then you can get $i$ points. If multiple scoring conditions are satisfied, the score for the test point is the highest one.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTS2019] 无处安放", "background": "寂寥深夜，朦朦胧胧的月光为一切都笼上一层轻纱，你漫步在幽径，时而低头沉\n吟，时而凝望星空，只独孤与彷徨作伴，哪怕只言片语却也无人倾诉，万千思绪伴着你炽热的心，随风而动，无处安放……", "description": "你整理出了 $n$ 条思绪，它们在你的心中是一个个矩形 $r_i$，你想要在心中用一个大矩形 $R$ 安放它们，也就是将 $r_i$ 放置在 $R$ 内部。为了保护这些思绪，它们安放的位置不能与其他思绪有重合部分，并且四条边要平行或垂直于 $R$ 的边。两个思绪有重合部分，指它们安放位置的重合面积大于零。\n\n你有两种安放方式：\n1. 将 $n$ 条思绪全部安放进R 中，希望令 $R$ 的面积尽量小。\n2. 固定 $R$ 的大小，希望将尽量多的思绪安放进 $R$ 中。\n\n现在我已知晓你整理好的思绪，为你选择了安放的方式，我想知道你心中最好的安放方案，请你告诉我。", "inputFormat": "第一行两个整数 $type, n$，分别表示安放方式与思绪的个数。\n\n若 $type = 2$，第二行两个整数 $W, H$，表示 $R$ 的边长。\n\n接下来 $n$ 行每行两个整数 $w_i, h_i$，表示第 $i$ 个思绪即 $r_i$ 的边长。\n\n同一行中输入的整数均以一个空格分隔开。", "outputFormat": "为了方便，若 $R$ 的边长为 $W, H$，我们将安放方案视作一个 $(0, 0)\\sim(W, H)$ 的直角坐标系。注意对于 $type = 2$ 的测试点，你应按输入，将其视作 $(0, 0)\\sim(W, H)$ 的坐标系，而不是 $(0, 0) \\sim (H, W)$ 的坐标系。\n\n输出共有 $n$ 行，每行一或四个整数，描述第 $i$ 个思绪即 $r_i$ 的放置方案。\n\n每行第一个整数 $c_i$，其中 $c_i = 1$ 表示 $r_i$ 被安放在 $R$ 中；$c_i = 0$ 表示 $r_i$ 未被安放在 $R$ 中。\n\n若 $c_i = 1$, 则该行接下来应输出三个整数 $x_i$, $y_i$, $d_{ir_i}$。若 $d_{ir_i} = 0$，则 $r_i$ 放置在 $(x_i, y_i)\\sim(x_i + w_i, y_i + h_i)$ 的矩形范围内；若 $d_{ir_i} = 1$，则 $r_i$ 放置在 $(x_i, y_i)\\sim(x_i + h_i, y_i + w_i)$ 的矩形范围内。\n\n请注意确保你的输出格式正确，且 $c_i, d_{ir_i} \\in \\{0, 1\\}$。对于 $type = 1$ 的测试点，所有 $c_i$ 均应为 $1$。\n\n同一行中输出的整数应以一个空格分隔开。", "hint": "#### 评分方式\n\n每个测试点设置了 $10$ 个评分参数 $a_1, a_2, ..., a_{10}$。若选手输出不合法，则得零分。\n\n否则，对于安放方式 $1$，令 $val$ 为 $R$ 的面积，若 $val \\leq a_i$，则你可获得 $i$ 分；对于安放方式 $2$，令 $val$ 为安放到 $R$ 中的思绪个数，若 $val \\geq a_i$ 则你可获得 $i$ 分。满足多个得分条件，测试点得分取最高者。", "locale": "zh-CN"}}}
{"pid": "P5403", "type": "P", "difficulty": 7, "samples": [["1\n0 0 0 1", "2.00000000\n"], ["4\n-1 7 0 7\n0 0 0 1\n2 -3 5 5\n2 2 6 -1", "23.563573998194637061425470524757"], ["4\n-1 1 -1 3\n0 4 2 4\n3 1 3 3\n0 0 2 0", "13.656854249492380195206754896839"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "Special Judge", "CTSC/CTS"], "title": "[CTS2019] 田野", "background": "", "description": "> Last night I saw you running  \nIn the open fields of grace  \nNo longer were you broken or in pain\n>\n> 题面中的歌词来自 Jackie Evancho 的 Open Fields of Grace，作曲者为 Lisa Venkatrathnam 和 Paul Sumares。\n\n你找到了一片一望无际的大田野，在这片田野中你忘记了曾经破碎、痛苦的过去。你像小孩一样在上帝的恩赐中奔跑。\n\n然而你发现了一个问题，在这片田野中有若干条峡谷。你随时都有坠入峡谷中的危险。为了继续自由自在的奔跑，你决定用若干围栏将这些峡谷围起来。\n\n我们可以忽视峡谷的宽度，将每一条峡谷看做一条线段。**这些线段可以相交**，而你的围栏必须是**一条或多条闭合不自交且两两不相交的曲线**，使得**任何一个峡谷都完全在某一条**闭合曲线围成的闭合区域之内。\n当然，围栏需要消耗资源，消耗的资源和围栏的长度成正比，你希望最小化消耗的资源总量，所以你希望求出围栏总长度的**下确界**，换句话说，你希望找到一个最大的实数 $x$，使得不存在一个方案使得围栏总长度小于 $x$。", "inputFormat": "输入文件的第一行为一个整数 $n$，表示峡谷的个数。\n\n接下来 $n$ 行，第 $i$ 行四个整数 $a_i,b_i,c_i,d_i$，表示第 $i$ 条峡谷为一条连接点 $(a_i,b_i)$ 和点 $(c_i,d_i)$ 的线段。**保证两个端点不重合，不同的线段不会涉及到相同的点。保证任意三点不共线。**", "outputFormat": "输出一行一个实数，表示围栏总长度的下确界。**你的答案和标准答案的绝对误差和相对误差的最小值不能超过** $10^{-6}$。", "hint": "#### 样例 1 解释\n一个四个端点分别为 $(−0.01,−0.01),(−0.01,1.01),(0.01,1.01),(0.01,−0.01)$ 的长方形完全包含输入的线段，且总长度为 $2.08$，略大于下确界。\n\n我们可以证明，不存在长度恰好为 $2$ 的方案。我们可以通过将正方形无限向输入线段“缩紧”来构造一个长度为任意大于 $2$ 的方案。\n\n#### 样例 2 解释\n下图为输入的线段，注意线段可以相交：\n![img1](https://s2.ax1x.com/2019/05/17/ELd6pj.png)\n\n我们以通过无限“逼近”这些红色的曲线来构造任意总长度大于答案的方案。注意通过样例 1，我们很容易知道左上角的红色线段被算了两遍。\n\n#### 样例 3 解释\n答案为 $8+4\\sqrt 2$。\n\n解释如图：\n\n![img2](https://s2.ax1x.com/2019/05/17/ELdINF.png)\n\n我们可以通过无限“逼近”这些红色的曲线来构造任意总长度大于 $8+4\\sqrt 2$ 的方案。\n\n#### 测试数据约定\n对于 $5\\%$ 的数据，保证 $1\\le n\\le 1$。\n\n对于 $10\\%$ 的数据，保证 $1\\le n\\le 2$。\n\n对于 $15\\%$ 的数据，保证 $1\\le n\\le 10$。\n\n对于 $30\\%$ 的数据，保证 $1\\le n\\le 15$。\n\n对于 $45\\%$ 的数据，保证 $1\\le n\\le 30$。\n\n对于 $55\\%$ 的数据，保证 $1\\le n\\le 60$。\n\n对于 $65\\%$ 的数据，保证 $1\\le n\\le 120$。\n\n对于 $75\\%$ 的数据，保证 $1\\le n\\le 200$。\n\n对于另外 $10\\%$ 的数据，保证答案最多包含两条曲线。\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 250$，$0\\le |a_i|,|b_i|,|c_i|,|d_i|\\le 10^9$。**保证两个端点不重合，不同的线段不会涉及到相同的点。保证任意三点不共线。**", "locale": "zh-CN", "translations": {"en": {"title": "[CTS2019] Fields", "background": "", "description": "> Last night I saw you running  \n> In the open fields of grace  \n> No longer were you broken or in pain\n>\n> The lyrics in the statement are from Jackie Evancho's *Open Fields of Grace*, composed by Lisa Venkatrathnam and Paul Sumares.\n\nYou found an endless open field. In this field, you forget the broken and painful past. You run like a child in God's grace.\n\nHowever, you notice a problem: there are several canyons in this field. At any time, you might fall into a canyon. To keep running freely, you decide to build some fences to enclose these canyons.\n\nWe can ignore the width of a canyon and treat each canyon as a line segment. **These segments may intersect**, and your fences must be **one or more closed curves that are non-self-intersecting and pairwise disjoint**, such that **every canyon lies completely inside the closed region enclosed by some** closed curve.\n\nOf course, fences consume resources, and the resource cost is proportional to the total fence length. You want to minimize the total resource cost, so you need the **infimum** of the total fence length. In other words, you want to find the largest real number $x$ such that there is no plan whose total fence length is less than $x$.", "inputFormat": "The first line contains an integer $n$, the number of canyons.\n\nThe next $n$ lines each contain four integers $a_i,b_i,c_i,d_i$, meaning that the $i$-th canyon is a segment connecting $(a_i,b_i)$ and $(c_i,d_i)$. **It is guaranteed that the two endpoints are different, different segments will not use the same point, and no three points are collinear.**", "outputFormat": "Output one real number, the infimum of the total fence length. **The minimum of the absolute error and the relative error between your answer and the standard answer must not exceed** $10^{-6}$.", "hint": "#### Explanation for Sample 1\nA rectangle with four vertices $(−0.01,−0.01),(−0.01,1.01),(0.01,1.01),(0.01,−0.01)$ completely contains the input segment, and its total perimeter is $2.08$, which is slightly larger than the infimum.\n\nWe can prove that there is no solution with length exactly $2$. We can construct a solution of any length greater than $2$ by shrinking the square toward the input segment infinitely.\n\n#### Explanation for Sample 2\nThe figure below shows the input segments. Note that segments may intersect:\n![img1](https://s2.ax1x.com/2019/05/17/ELd6pj.png)\n\nWe can construct solutions with any total length greater than the answer by infinitely approaching these red curves. Note that from Sample 1, it is easy to see that the red segment in the upper-left corner is counted twice.\n\n#### Explanation for Sample 3\nThe answer is $8+4\\sqrt 2$.\n\nThe explanation is shown in the figure:\n![img2](https://s2.ax1x.com/2019/05/17/ELdINF.png)\n\nWe can construct solutions with any total length greater than $8+4\\sqrt 2$ by infinitely approaching these red curves.\n\n#### Testdata Constraints\nFor $5\\%$ of the testdata, it is guaranteed that $1\\le n\\le 1$.\n\nFor $10\\%$ of the testdata, it is guaranteed that $1\\le n\\le 2$.\n\nFor $15\\%$ of the testdata, it is guaranteed that $1\\le n\\le 10$.\n\nFor $30\\%$ of the testdata, it is guaranteed that $1\\le n\\le 15$.\n\nFor $45\\%$ of the testdata, it is guaranteed that $1\\le n\\le 30$.\n\nFor $55\\%$ of the testdata, it is guaranteed that $1\\le n\\le 60$.\n\nFor $65\\%$ of the testdata, it is guaranteed that $1\\le n\\le 120$.\n\nFor $75\\%$ of the testdata, it is guaranteed that $1\\le n\\le 200$.\n\nFor another $10\\%$ of the testdata, it is guaranteed that the answer contains at most two curves.\n\nFor $100\\%$ of the testdata, it is guaranteed that $1\\le n\\le 250$, $0\\le |a_i|,|b_i|,|c_i|,|d_i|\\le 10^9$. **It is guaranteed that the two endpoints are different, different segments will not use the same point, and no three points are collinear.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTS2019] 田野", "background": "", "description": "> Last night I saw you running  \nIn the open fields of grace  \nNo longer were you broken or in pain\n>\n> 题面中的歌词来自 Jackie Evancho 的 Open Fields of Grace，作曲者为 Lisa Venkatrathnam 和 Paul Sumares。\n\n你找到了一片一望无际的大田野，在这片田野中你忘记了曾经破碎、痛苦的过去。你像小孩一样在上帝的恩赐中奔跑。\n\n然而你发现了一个问题，在这片田野中有若干条峡谷。你随时都有坠入峡谷中的危险。为了继续自由自在的奔跑，你决定用若干围栏将这些峡谷围起来。\n\n我们可以忽视峡谷的宽度，将每一条峡谷看做一条线段。**这些线段可以相交**，而你的围栏必须是**一条或多条闭合不自交且两两不相交的曲线**，使得**任何一个峡谷都完全在某一条**闭合曲线围成的闭合区域之内。\n当然，围栏需要消耗资源，消耗的资源和围栏的长度成正比，你希望最小化消耗的资源总量，所以你希望求出围栏总长度的**下确界**，换句话说，你希望找到一个最大的实数 $x$，使得不存在一个方案使得围栏总长度小于 $x$。", "inputFormat": "输入文件的第一行为一个整数 $n$，表示峡谷的个数。\n\n接下来 $n$ 行，第 $i$ 行四个整数 $a_i,b_i,c_i,d_i$，表示第 $i$ 条峡谷为一条连接点 $(a_i,b_i)$ 和点 $(c_i,d_i)$ 的线段。**保证两个端点不重合，不同的线段不会涉及到相同的点。保证任意三点不共线。**", "outputFormat": "输出一行一个实数，表示围栏总长度的下确界。**你的答案和标准答案的绝对误差和相对误差的最小值不能超过** $10^{-6}$。", "hint": "#### 样例 1 解释\n一个四个端点分别为 $(−0.01,−0.01),(−0.01,1.01),(0.01,1.01),(0.01,−0.01)$ 的长方形完全包含输入的线段，且总长度为 $2.08$，略大于下确界。\n\n我们可以证明，不存在长度恰好为 $2$ 的方案。我们可以通过将正方形无限向输入线段“缩紧”来构造一个长度为任意大于 $2$ 的方案。\n\n#### 样例 2 解释\n下图为输入的线段，注意线段可以相交：\n![img1](https://s2.ax1x.com/2019/05/17/ELd6pj.png)\n\n我们以通过无限“逼近”这些红色的曲线来构造任意总长度大于答案的方案。注意通过样例 1，我们很容易知道左上角的红色线段被算了两遍。\n\n#### 样例 3 解释\n答案为 $8+4\\sqrt 2$。\n\n解释如图：\n\n![img2](https://s2.ax1x.com/2019/05/17/ELdINF.png)\n\n我们可以通过无限“逼近”这些红色的曲线来构造任意总长度大于 $8+4\\sqrt 2$ 的方案。\n\n#### 测试数据约定\n对于 $5\\%$ 的数据，保证 $1\\le n\\le 1$。\n\n对于 $10\\%$ 的数据，保证 $1\\le n\\le 2$。\n\n对于 $15\\%$ 的数据，保证 $1\\le n\\le 10$。\n\n对于 $30\\%$ 的数据，保证 $1\\le n\\le 15$。\n\n对于 $45\\%$ 的数据，保证 $1\\le n\\le 30$。\n\n对于 $55\\%$ 的数据，保证 $1\\le n\\le 60$。\n\n对于 $65\\%$ 的数据，保证 $1\\le n\\le 120$。\n\n对于 $75\\%$ 的数据，保证 $1\\le n\\le 200$。\n\n对于另外 $10\\%$ 的数据，保证答案最多包含两条曲线。\n\n对于 $100\\%$ 的数据，保证 $1\\le n\\le 250$，$0\\le |a_i|,|b_i|,|c_i|,|d_i|\\le 10^9$。**保证两个端点不重合，不同的线段不会涉及到相同的点。保证任意三点不共线。**", "locale": "zh-CN"}}}
{"pid": "P5404", "type": "P", "difficulty": 7, "samples": [["3\nabc", "79"], ["5\nzxcvb", "11881375"], ["20\nuuopacpertklmqwbfixc ", "765676850"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "CTSC/CTS"], "title": "[CTS2019] 重复", "background": "贾樟柯在《山河故人》里说，“生活就是重复”。在生活中，人们总是喜欢重复自己做过的事情。语言就是一个很经典的例子。\n\n比如，我们在表示疑问时，总不满足于使用一个问号“？”；使用一连串的问号“？？？？”总是显得比较有力。\n\n在表示抱歉时，一句“对不起”总显得不够情愿；连着表示“对不起对不起”才足够表达自己的真诚。", "description": "A 国就是一个喜欢重复的国家。在这个国家中，一个基本句子可以用一个长度恰好为 $m$ 的小写字母字符串表示。为了表达自己对重复的喜爱，A 国的人们总喜欢把自己想要表达的句子重复无限多次。\n\n有时，这样的重复是充满意义的。A 国的人们把一个字典序小于给定的字符串 $s$，且长度和 $s$ 相同的小写字母字符串称为一个有意义的语义片段。他们想知道，有多少个不同的基本句子（即长度恰好为 $m$ 的小写字母字符串）在经过无限重复后，可以从中找出至少一个有意义的语义片段？", "inputFormat": "输入文件的第一行为一个正整数 $m$，表示基本句子的长度；第二行为一个小写字母字符串 $s$，其含义详见题目描述。", "outputFormat": "输出一行一个整数，为满足条件的基本句子的数量。为了避免答案过大，你只需要输出将答案对 $998244353$ 取模后的结果。", "hint": "设字符串 $s$ 的长度为 $n$，则 $n$、$m$ 的范围遵循如下表格：\n\n![img](https://s2.ax1x.com/2019/05/17/EL0fFU.png)\n\n对于 $100\\%$ 的数据，保证 $1\\le n,m\\le 2000$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTS2019] Repetition", "background": "Jia Zhangke said in *Mountains May Depart*, “Life is repetition.” In life, people always like to repeat what they have done. Language is a very classic example.\n\nFor example, when expressing a question, people are often not satisfied with using just one question mark “?”; using a series of question marks “????” always feels more forceful.\n\nWhen expressing an apology, saying “sorry” once often seems unwilling; repeating it as “sorry sorry” is enough to show sincerity.", "description": "Country A is a country that likes repetition. In this country, a basic sentence can be represented by a lowercase letter string of length exactly $m$. To show their love for repetition, people in Country A always repeat the sentence they want to express infinitely many times.\n\nSometimes, such repetition is meaningful. People in Country A call a lowercase letter string that is lexicographically smaller than the given string $s$ and has the same length as $s$ a meaningful semantic fragment. They want to know: how many different basic sentences (i.e., lowercase letter strings of length exactly $m$) can, after being repeated infinitely, contain at least one meaningful semantic fragment?", "inputFormat": "The first line of the input file is a positive integer $m$, which denotes the length of the basic sentence. The second line is a lowercase letter string $s$, whose meaning is described above.", "outputFormat": "Output one line with one integer, the number of basic sentences that satisfy the condition. To avoid the answer being too large, you only need to output the result modulo $998244353$.", "hint": "Let the length of string $s$ be $n$. Then the constraints of $n$ and $m$ follow the table below:\n\n![img](https://s2.ax1x.com/2019/05/17/EL0fFU.png)\n\nFor $100\\%$ of the testdata, it is guaranteed that $1\\le n,m\\le 2000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTS2019] 重复", "background": "贾樟柯在《山河故人》里说，“生活就是重复”。在生活中，人们总是喜欢重复自己做过的事情。语言就是一个很经典的例子。\n\n比如，我们在表示疑问时，总不满足于使用一个问号“？”；使用一连串的问号“？？？？”总是显得比较有力。\n\n在表示抱歉时，一句“对不起”总显得不够情愿；连着表示“对不起对不起”才足够表达自己的真诚。", "description": "A 国就是一个喜欢重复的国家。在这个国家中，一个基本句子可以用一个长度恰好为 $m$ 的小写字母字符串表示。为了表达自己对重复的喜爱，A 国的人们总喜欢把自己想要表达的句子重复无限多次。\n\n有时，这样的重复是充满意义的。A 国的人们把一个字典序小于给定的字符串 $s$，且长度和 $s$ 相同的小写字母字符串称为一个有意义的语义片段。他们想知道，有多少个不同的基本句子（即长度恰好为 $m$ 的小写字母字符串）在经过无限重复后，可以从中找出至少一个有意义的语义片段？", "inputFormat": "输入文件的第一行为一个正整数 $m$，表示基本句子的长度；第二行为一个小写字母字符串 $s$，其含义详见题目描述。", "outputFormat": "输出一行一个整数，为满足条件的基本句子的数量。为了避免答案过大，你只需要输出将答案对 $998244353$ 取模后的结果。", "hint": "设字符串 $s$ 的长度为 $n$，则 $n$、$m$ 的范围遵循如下表格：\n\n![img](https://s2.ax1x.com/2019/05/17/EL0fFU.png)\n\n对于 $100\\%$ 的数据，保证 $1\\le n,m\\le 2000$。", "locale": "zh-CN"}}}
{"pid": "P5405", "type": "P", "difficulty": 6, "samples": [["2\n0 0 1\n1 1 0\n1 2", "524078286"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "树形 DP", "容斥原理", "期望", "CTSC/CTS"], "title": "[CTS2019] 氪金手游", "background": "", "description": "小刘同学是一个喜欢氪金手游的男孩子。\n\n他最近迷上了一个新游戏，游戏的内容就是不断地抽卡。现在已知：\n- 卡池里总共有 $N$ 种卡，第 $i$ 种卡有一个权值 $W_i$，小刘同学不知道 $W_i$ 具体的值是什么。但是他通过和网友交流，他了解到 $W_i$ 服从一个分布。\n- 具体地，对每个 $i$，小刘了解到三个参数 $p_{i,1},p_{i,2},p_{i,3}$，$W_i$ 将会以 $p_{i,j}$ 的概率取值为 $j$，保证 $p_{i,1}+p_{i,2}+p_{i,3}=1$。\n\n小刘开始玩游戏了，他每次会氪一元钱来抽一张卡，其中抽到卡 $i$ 的概率为：\n$$\\frac{W_i}{\\sum_j W_j}$$\n小刘会不停地抽卡，**直到**他手里集齐了全部 $N$ 种卡。\n\n抽卡结束之后，服务器记录下来了小刘**第一次**得到每张卡的时间 $T_i$。游戏公司在这里设置了一个彩蛋：公司准备了 $N-1$ 个二元组 $(u_i,v_i)$，如果对任意的 $i$，成立 $T_{u_i}<T_{v_i}$，那么游戏公司就会认为小刘是极其幸运的，从而送给他一个橱柜的手办作为幸运大奖。\n\n游戏公司为了降低获奖概率，它准备的这些 $(u_i,v_i)$ 满足这样一个性质：对于任意的 $\\varnothing\\ne S\\subsetneq\\{1,2,\\ldots,N\\}$，总能找到 $(u_i,v_i)$ 满足：$u_i\\in S,v_i\\notin S$ **或者** $u_i\\notin S,v_i\\in S$。\n\n请你求出小刘同学能够得到幸运大奖的概率，可以保证结果是一个有理数，请输出它对 $998244353$ 取模的结果。", "inputFormat": "第一行一个整数 $N$，表示卡的种类数。\n\n接下来 $N$ 行，每行三个整数 $a_{i,1},a_{i,2},a_{i,3}$，而题目给出的 $p_{i,j}=\\frac{a_{i,j}}{a_{i,1}+a_{i,2}+a_{i,3}}$。\n\n接下来 $N-1$ 行，每行两个整数 $u_i,v_i$，描述一个二元组（意义见题目描述）。", "outputFormat": "输出一行一个整数，表示所求概率对 $998244353$ 取模的结果。", "hint": "#### 样例 1 解释\n$W_2$ 以 $\\frac 12$ 的概率取 $1$ 或者 $2$：\n- 如果 $W_2=1$，那么 $T_1<T_2$ 的概率为 $\\frac 34$。\n- 否则 $W_2=2$，$T_1<T_2$ 的概率为 $\\frac 35$。\n\n综合所有情况答案为 $\\frac 12\\left(\\frac 34+\\frac 35\\right)=\\frac{27}{40}$，你可以验证它对 $998244353$ 取模的结果确实是所给答案。\n\n#### 测试数据约定\n对于全部的测试数据，保证 $N\\le 1000$，$a_{i,j}\\le 10^6$。\n\n- $20$ 分的数据，$N\\le 15$。\n- $15$ 分的数据，$N\\le 200$，且每个限制保证 $|u_i−v_i|=1$。\n- $20$ 分的数据，$N\\le 1000$，且每个限制保证 $|u_i−v_i|=1$。\n- $15$ 分的数据，$N\\le 200$。\n- $30$ 分的数据，无特殊限制。", "locale": "zh-CN", "translations": {"en": {"title": "[CTS2019] Pay-to-Win Mobile Gacha Game", "background": "", "description": "Student Xiao Liu is a boy who likes pay-to-win mobile games.\n\nHe recently got addicted to a new game whose content is to keep drawing cards. It is known that:\n\n- There are $N$ types of cards in the pool. The $i$-th type of card has a weight $W_i$. Xiao Liu does not know the exact value of $W_i$, but by talking with other players he learned that $W_i$ follows a distribution.\n- Specifically, for each $i$, Xiao Liu knows three parameters $p_{i,1}, p_{i,2}, p_{i,3}$. The value of $W_i$ is $j$ with probability $p_{i,j}$. It is guaranteed that $p_{i,1} + p_{i,2} + p_{i,3} = 1$.\n\nXiao Liu starts playing the game. Each time, he pays 1 yuan to draw one card. The probability of drawing card $i$ is:\n$$\\frac{W_i}{\\sum_j W_j}$$\nXiao Liu will keep drawing cards **until** he has collected all $N$ types of cards.\n\nAfter the drawing ends, the server records the time $T_i$ when Xiao Liu gets each card for the **first time**. The game company sets up an easter egg: the company prepares $N - 1$ ordered pairs $(u_i, v_i)$. If for every $i$, the condition $T_{u_i} < T_{v_i}$ holds, then the company will consider Xiao Liu extremely lucky and will give him a cabinet of figurines as the lucky grand prize.\n\nTo reduce the chance of winning, these $(u_i, v_i)$ satisfy the following property: for any $\\varnothing \\ne S \\subsetneq \\{1,2,\\ldots,N\\}$, there always exists some $(u_i, v_i)$ such that $u_i \\in S, v_i \\notin S$ **or** $u_i \\notin S, v_i \\in S$.\n\nPlease compute the probability that Xiao Liu can get the lucky grand prize. It is guaranteed that the result is a rational number. Output the result modulo $998244353$.", "inputFormat": "The first line contains an integer $N$, the number of card types.\n\nThe next $N$ lines each contain three integers $a_{i,1}, a_{i,2}, a_{i,3}$, and the probabilities in the statement are given by $p_{i,j} = \\frac{a_{i,j}}{a_{i,1} + a_{i,2} + a_{i,3}}$.\n\nThe next $N - 1$ lines each contain two integers $u_i, v_i$, describing an ordered pair (see the statement for its meaning).", "outputFormat": "Output one integer in one line, the required probability modulo $998244353$.", "hint": "#### Explanation of Sample 1\n$W_2$ is $1$ or $2$ with probability $\\frac 12$:\n- If $W_2 = 1$, then the probability that $T_1 < T_2$ is $\\frac 34$.\n- Otherwise, if $W_2 = 2$, then the probability that $T_1 < T_2$ is $\\frac 35$.\n\nCombining all cases, the answer is $\\frac 12\\left(\\frac 34 + \\frac 35\\right) = \\frac{27}{40}$. You can verify that its value modulo $998244353$ is indeed the given output.\n\n#### Testdata Constraints\nFor all testdata, it is guaranteed that $N \\le 1000$ and $a_{i,j} \\le 10^6$.\n\n- $20$ points: $N \\le 15$.\n- $15$ points: $N \\le 200$, and every constraint satisfies $|u_i−v_i|=1$.\n- $20$ points: $N \\le 1000$, and every constraint satisfies $|u_i−v_i|=1$.\n- $15$ points: $N \\le 200$.\n- $30$ points: no special constraints.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTS2019] 氪金手游", "background": "", "description": "小刘同学是一个喜欢氪金手游的男孩子。\n\n他最近迷上了一个新游戏，游戏的内容就是不断地抽卡。现在已知：\n- 卡池里总共有 $N$ 种卡，第 $i$ 种卡有一个权值 $W_i$，小刘同学不知道 $W_i$ 具体的值是什么。但是他通过和网友交流，他了解到 $W_i$ 服从一个分布。\n- 具体地，对每个 $i$，小刘了解到三个参数 $p_{i,1},p_{i,2},p_{i,3}$，$W_i$ 将会以 $p_{i,j}$ 的概率取值为 $j$，保证 $p_{i,1}+p_{i,2}+p_{i,3}=1$。\n\n小刘开始玩游戏了，他每次会氪一元钱来抽一张卡，其中抽到卡 $i$ 的概率为：\n$$\\frac{W_i}{\\sum_j W_j}$$\n小刘会不停地抽卡，**直到**他手里集齐了全部 $N$ 种卡。\n\n抽卡结束之后，服务器记录下来了小刘**第一次**得到每张卡的时间 $T_i$。游戏公司在这里设置了一个彩蛋：公司准备了 $N-1$ 个二元组 $(u_i,v_i)$，如果对任意的 $i$，成立 $T_{u_i}<T_{v_i}$，那么游戏公司就会认为小刘是极其幸运的，从而送给他一个橱柜的手办作为幸运大奖。\n\n游戏公司为了降低获奖概率，它准备的这些 $(u_i,v_i)$ 满足这样一个性质：对于任意的 $\\varnothing\\ne S\\subsetneq\\{1,2,\\ldots,N\\}$，总能找到 $(u_i,v_i)$ 满足：$u_i\\in S,v_i\\notin S$ **或者** $u_i\\notin S,v_i\\in S$。\n\n请你求出小刘同学能够得到幸运大奖的概率，可以保证结果是一个有理数，请输出它对 $998244353$ 取模的结果。", "inputFormat": "第一行一个整数 $N$，表示卡的种类数。\n\n接下来 $N$ 行，每行三个整数 $a_{i,1},a_{i,2},a_{i,3}$，而题目给出的 $p_{i,j}=\\frac{a_{i,j}}{a_{i,1}+a_{i,2}+a_{i,3}}$。\n\n接下来 $N-1$ 行，每行两个整数 $u_i,v_i$，描述一个二元组（意义见题目描述）。", "outputFormat": "输出一行一个整数，表示所求概率对 $998244353$ 取模的结果。", "hint": "#### 样例 1 解释\n$W_2$ 以 $\\frac 12$ 的概率取 $1$ 或者 $2$：\n- 如果 $W_2=1$，那么 $T_1<T_2$ 的概率为 $\\frac 34$。\n- 否则 $W_2=2$，$T_1<T_2$ 的概率为 $\\frac 35$。\n\n综合所有情况答案为 $\\frac 12\\left(\\frac 34+\\frac 35\\right)=\\frac{27}{40}$，你可以验证它对 $998244353$ 取模的结果确实是所给答案。\n\n#### 测试数据约定\n对于全部的测试数据，保证 $N\\le 1000$，$a_{i,j}\\le 10^6$。\n\n- $20$ 分的数据，$N\\le 15$。\n- $15$ 分的数据，$N\\le 200$，且每个限制保证 $|u_i−v_i|=1$。\n- $20$ 分的数据，$N\\le 1000$，且每个限制保证 $|u_i−v_i|=1$。\n- $15$ 分的数据，$N\\le 200$。\n- $30$ 分的数据，无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P5406", "type": "P", "difficulty": 7, "samples": [["3 3\n^\n1 2 1\n2 3 1\n1 3 0", "1"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "快速沃尔什变换 FWT", "THUPC"], "title": "[THUPC 2019] 找树", "background": "", "description": "定义 $\\otimes_1, \\otimes_2, \\otimes_3$ 分别为按位与、按位或、按位异或运算。记 $a_i$ 表示 $a$ 的从低位到高位的第 $i$ 个二进制位。定义一个作用在 $w$ 位二进制数上的新运算 $\\oplus$，满足对于结果 $a\\oplus b$ 的每一位 $(a\\oplus b)_i$ 有 $(a\\oplus b)_i = a_i \\otimes_{o_i} b_i$。不难验证 $\\oplus$ 运算满足结合律和交换律。\n\n给出一张 $n$ 个点 $m$ 条边的无向图，每一条边的权值是一个 $w$ 位二进制数（即小于 $2^w$ 的非负整数）。请你找一棵原图的生成树。设你找出的生成树中的边边权分别为 $v_1,\\cdots,v_{n-1}$，请你最大化 $v_1\\oplus v_2\\oplus\\cdots\\oplus v_{n-1}$。", "inputFormat": "第一行两个正整数 $n,m$；\n\n第二行一个长度为 $w$ 的串，串中的每个字符为 `&`、`|`、`^`  中的一个（分别代表与、或和异或），表示每一个 $\\otimes_{o_i}$。\n\n接下来 $m$ 行，每一行三个非负整数 $x,y,v$，表示一条连接 $x$ 和 $y$ 权值为 $v$ 的边，保证 $1\\leq x,y\\leq n$，$0\\le v < 2^w$。\n\n对于所有数据，$1\\le n\\le 70,1\\le m\\le 5000,1\\le w \\le 12$。", "outputFormat": "输出一行一个数，表示答案。如果图不连通，输出 `-1`。", "hint": "### 关于数据\n\n由于一些原因，数据只保留了最后 $20$ 个点。\n\n### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2019] Find a Tree", "background": "", "description": "Define $\\otimes_1, \\otimes_2, \\otimes_3$ as bitwise AND, bitwise OR, and bitwise XOR, respectively. Let $a_i$ denote the $i$-th binary bit of $a$ from low to high. Define a new operation $\\oplus$ on $w$-bit binary numbers such that for each bit $(a\\oplus b)_i$ of the result $a\\oplus b$, we have $(a\\oplus b)_i = a_i \\otimes_{o_i} b_i$. It is not hard to verify that the operation $\\oplus$ is associative and commutative.\n\nGiven an undirected graph with $n$ vertices and $m$ edges, each edge weight is a $w$-bit binary number (i.e., a non-negative integer less than $2^w$). Please find a spanning tree of the original graph. Suppose the edge weights in your spanning tree are $v_1,\\cdots,v_{n-1}$. Please maximize $v_1\\oplus v_2\\oplus\\cdots\\oplus v_{n-1}$.", "inputFormat": "The first line contains two positive integers $n,m$.\n\nThe second line contains a string of length $w$. Each character in the string is one of `&`, `|`, `^` (representing AND, OR, XOR, respectively), indicating each $\\otimes_{o_i}$.\n\nThe next $m$ lines each contain three non-negative integers $x,y,v$, representing an edge connecting $x$ and $y$ with weight $v$. It is guaranteed that $1\\leq x,y\\leq n$, $0\\le v < 2^w$.\n\nFor all testdata, $1\\le n\\le 70,1\\le m\\le 5000,1\\le w \\le 12$.", "outputFormat": "Output one line with one number, indicating the answer. If the graph is disconnected, output `-1`.", "hint": "### About the testdata\n\nFor some reasons, the testdata only keeps the last $20$ vertices.\n\n### Copyright information\n\nFrom THUPC (THU Programming Contest, Tsinghua University Programming Contest) 2019.\n\nResources such as solutions can be found at <https://github.com/wangyurzee7/THUPC2019>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2019] 找树", "background": "", "description": "定义 $\\otimes_1, \\otimes_2, \\otimes_3$ 分别为按位与、按位或、按位异或运算。记 $a_i$ 表示 $a$ 的从低位到高位的第 $i$ 个二进制位。定义一个作用在 $w$ 位二进制数上的新运算 $\\oplus$，满足对于结果 $a\\oplus b$ 的每一位 $(a\\oplus b)_i$ 有 $(a\\oplus b)_i = a_i \\otimes_{o_i} b_i$。不难验证 $\\oplus$ 运算满足结合律和交换律。\n\n给出一张 $n$ 个点 $m$ 条边的无向图，每一条边的权值是一个 $w$ 位二进制数（即小于 $2^w$ 的非负整数）。请你找一棵原图的生成树。设你找出的生成树中的边边权分别为 $v_1,\\cdots,v_{n-1}$，请你最大化 $v_1\\oplus v_2\\oplus\\cdots\\oplus v_{n-1}$。", "inputFormat": "第一行两个正整数 $n,m$；\n\n第二行一个长度为 $w$ 的串，串中的每个字符为 `&`、`|`、`^`  中的一个（分别代表与、或和异或），表示每一个 $\\otimes_{o_i}$。\n\n接下来 $m$ 行，每一行三个非负整数 $x,y,v$，表示一条连接 $x$ 和 $y$ 权值为 $v$ 的边，保证 $1\\leq x,y\\leq n$，$0\\le v < 2^w$。\n\n对于所有数据，$1\\le n\\le 70,1\\le m\\le 5000,1\\le w \\le 12$。", "outputFormat": "输出一行一个数，表示答案。如果图不连通，输出 `-1`。", "hint": "### 关于数据\n\n由于一些原因，数据只保留了最后 $20$ 个点。\n\n### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN"}}}
{"pid": "P5407", "type": "P", "difficulty": 3, "samples": [["2019", "12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "2019", "THUPC"], "title": "[THUPC 2019] 历史行程", "background": "> 人生是怎么样的呢？我们是怎样活着的呢？\n>\n> 无论是谁，都是从黑暗中降生，最后再回归于黑暗。几年，几十年，短暂而漫长的时光。形形色色的人，形形色色的事，如过眼云烟，转瞬即逝。过眼繁花终有尽时，有些东西还能弥留于你的记忆之中，但更多的，早已无可寻觅。\n>\n> 但是，有个人，你不会忘记。\n>\n> 在你降生于黑暗之中时，那个人就一直陪在你身边。当你突破那黑暗，第一次见到世界的光明的时候，那个人也在你身边。\n>\n> 第一次的啼哭，第一次的说话，第一次的走路，第一次的奔跑。\n>\n> 每一次的成长，是你自己的一次飞跃。而对那个人来说，则是最纯真的喜悦和感动。\n> \n>在你不知道的时候，在你不知道的地方，那个人倾尽自己的一切，为你创造最好的一切，保护你的一切，为你指引走向未来的桥梁。\n>\n> 那个人每天都在期盼着，期盼着你能早点长大，变得拥有保护你自己的力量。\n>\n> 那个人每天都在担心着，担心着你与那个人分别那天，终究还是会来到。\n>\n> 你终究会一直成长，你终究会拥有自立自强的能力。那个人，也不能再像以前一样，保护你。\n>\n> 有一天，你将走向更宽阔的未来，你会拥有和以前完全不一样的一切。而那个人，已经不再能够保护你了。\n>\n> 而你和那个人之间能够拥有的时间，也就越来越短了。\n>\n> 五年，十年，二十年，你一天一天长大。\n>\n> 五年，十年，二十年，那个人一天天老去。\n>\n> 那个人已经不能保护你了，那么现在，该你，去保护那个人了。\n>\n> 也许那个人不能永远在你身边，也许那个人终将离你而去。\n>\n> 但你永远不会忘记那个人，因为那个人，始终在你身边。\n>\n> 今天，是那个人的节日。", "description": "母亲节是一个为感谢母亲而庆祝的节日，而在世界各地的母亲节的日期有所不同。母亲们在这一天里通常会收到孩子们送的礼物；而在许多人心目中，康乃馨被视作最适于献给母亲的鲜花之一。\n\n1913 年，美国国会确定将每年 5 月的第二个星期日作为法定的母亲节，这也是现代母亲节的起源。\n\n给定一个年份，请你输出这一年的母亲节的日期。方便起见，你只需要输出它是这年 5 月的第几天即可。", "inputFormat": "一行一个整数 $y$，表示年份。\n\n保证 $1913\\leq y\\leq 2019$。", "outputFormat": "一行一个整数，表示这年的母亲节是 5 月的第几天。（请注意**不要**输出多余的前导零）", "hint": "### 样例解释\n\n2019 年的母亲节是 5 月 12 日。\n\n### 关于数据\n\n由于一些原因数据只保留了随机的 $50$ 个点。\n\n### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2019] Historical Journey", "background": "> What is life like? How do we live?\n>\n> No matter who it is, everyone is born from darkness and will eventually return to darkness. A few years, a few decades—short yet long. All kinds of people, all kinds of things, like clouds passing before your eyes, vanish in an instant. The flowers you once saw will wither in the end. Some things may still linger in your memory, but even more have long become impossible to find.\n>\n> But there is one person you will not forget.\n>\n> When you were born into the darkness, that person was always by your side. When you broke through the darkness and first saw the light of the world, that person was also by your side.\n>\n> The first cry, the first words, the first steps, the first run.\n>\n> Every time you grow, it is a leap for yourself. But for that person, it is the purest joy and emotion.\n> \n> When you do not know, in places you do not know, that person gives everything they have to create the best for you, to protect everything about you, and to point out a bridge leading you to the future.\n>\n> That person hopes every day, hoping that you can grow up sooner and become strong enough to protect yourself.\n>\n> That person worries every day, worrying that the day you part from that person will finally come.\n>\n> You will keep growing, and you will have the ability to stand on your own. And that person can no longer protect you like before.\n>\n> One day, you will walk toward a broader future. You will have everything completely different from before. And that person can no longer protect you.\n>\n> And the time you and that person can have together is getting shorter and shorter.\n>\n> Five years, ten years, twenty years—you grow up day by day.\n>\n> Five years, ten years, twenty years—that person grows old day by day.\n>\n> That person can no longer protect you, so now it is your turn to protect that person.\n>\n> Maybe that person cannot stay by your side forever. Maybe that person will eventually leave you.\n>\n> But you will never forget that person, because that person has always been by your side.\n>\n> Today is that person’s holiday.", "description": "Mother’s Day is a holiday celebrated to thank mothers, and its date differs in different parts of the world. On this day, mothers usually receive gifts from their children. In many people’s minds, carnations are considered one of the most suitable flowers to give to mothers.\n\nIn 1913, the U.S. Congress designated the second Sunday of May each year as the legal Mother’s Day, which is also the origin of modern Mother’s Day.\n\nGiven a year, output the date of Mother’s Day in that year. For convenience, you only need to output which day of May it is in that year.", "inputFormat": "One line with one integer $y$, representing the year.\n\nIt is guaranteed that $1913\\leq y\\leq 2019$.", "outputFormat": "One line with one integer, indicating which day of May Mother’s Day falls on in that year. (Please note: do **not** output extra leading zeros.)", "hint": "### Sample Explanation\n\nMother’s Day in 2019 is May 12.\n\n### About the testdata\n\nFor some reasons, only 50 random test points were kept.\n\n### Copyright Information\n\nFrom THUPC (THU Programming Contest, Tsinghua University Programming Contest) 2019.\n\nResources such as editorials can be found at <https://github.com/wangyurzee7/THUPC2019>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2019] 历史行程", "background": "> 人生是怎么样的呢？我们是怎样活着的呢？\n>\n> 无论是谁，都是从黑暗中降生，最后再回归于黑暗。几年，几十年，短暂而漫长的时光。形形色色的人，形形色色的事，如过眼云烟，转瞬即逝。过眼繁花终有尽时，有些东西还能弥留于你的记忆之中，但更多的，早已无可寻觅。\n>\n> 但是，有个人，你不会忘记。\n>\n> 在你降生于黑暗之中时，那个人就一直陪在你身边。当你突破那黑暗，第一次见到世界的光明的时候，那个人也在你身边。\n>\n> 第一次的啼哭，第一次的说话，第一次的走路，第一次的奔跑。\n>\n> 每一次的成长，是你自己的一次飞跃。而对那个人来说，则是最纯真的喜悦和感动。\n> \n>在你不知道的时候，在你不知道的地方，那个人倾尽自己的一切，为你创造最好的一切，保护你的一切，为你指引走向未来的桥梁。\n>\n> 那个人每天都在期盼着，期盼着你能早点长大，变得拥有保护你自己的力量。\n>\n> 那个人每天都在担心着，担心着你与那个人分别那天，终究还是会来到。\n>\n> 你终究会一直成长，你终究会拥有自立自强的能力。那个人，也不能再像以前一样，保护你。\n>\n> 有一天，你将走向更宽阔的未来，你会拥有和以前完全不一样的一切。而那个人，已经不再能够保护你了。\n>\n> 而你和那个人之间能够拥有的时间，也就越来越短了。\n>\n> 五年，十年，二十年，你一天一天长大。\n>\n> 五年，十年，二十年，那个人一天天老去。\n>\n> 那个人已经不能保护你了，那么现在，该你，去保护那个人了。\n>\n> 也许那个人不能永远在你身边，也许那个人终将离你而去。\n>\n> 但你永远不会忘记那个人，因为那个人，始终在你身边。\n>\n> 今天，是那个人的节日。", "description": "母亲节是一个为感谢母亲而庆祝的节日，而在世界各地的母亲节的日期有所不同。母亲们在这一天里通常会收到孩子们送的礼物；而在许多人心目中，康乃馨被视作最适于献给母亲的鲜花之一。\n\n1913 年，美国国会确定将每年 5 月的第二个星期日作为法定的母亲节，这也是现代母亲节的起源。\n\n给定一个年份，请你输出这一年的母亲节的日期。方便起见，你只需要输出它是这年 5 月的第几天即可。", "inputFormat": "一行一个整数 $y$，表示年份。\n\n保证 $1913\\leq y\\leq 2019$。", "outputFormat": "一行一个整数，表示这年的母亲节是 5 月的第几天。（请注意**不要**输出多余的前导零）", "hint": "### 样例解释\n\n2019 年的母亲节是 5 月 12 日。\n\n### 关于数据\n\n由于一些原因数据只保留了随机的 $50$ 个点。\n\n### 版权信息\n\n来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\n\n题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。", "locale": "zh-CN"}}}
{"pid": "P5408", "type": "P", "difficulty": 7, "samples": [["3\n", "0 2 3 1\n"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "倍增", "多项式", "分治", "Stirling 数", "快速数论变换 NTT"], "title": "第一类斯特林数·行", "background": null, "description": "第一类斯特林数 $\\begin{bmatrix}n\\\\ m\\end{bmatrix}$ 表示将 $n$ 个**不同**元素构成 $m$ 个圆排列的数目。\n\n给定 $n$，对于所有的整数 $i\\in[0,n]$，你要求出 $\\begin{bmatrix}n\\\\ i\\end{bmatrix}$。\n\n由于答案会非常大，所以你的输出需要对 $167772161$（$2^{25}\\times 5+1$，是一个质数）取模。", "inputFormat": "一行一个正整数 $n$，意义见题目描述。", "outputFormat": "共一行 $n+1$ 个非负整数。\n\n你需要按顺序输出 $\\begin{bmatrix}n\\\\ 0\\end{bmatrix},\\begin{bmatrix}n\\\\ 1\\end{bmatrix},\\begin{bmatrix}n\\\\ 2\\end{bmatrix},\\dots,\\begin{bmatrix}n\\\\ n\\end{bmatrix}$ 的值。", "hint": "对于 $20\\%$ 的数据，$n\\leqslant 1000$。\n\n对于 $100\\%$ 的数据，$1\\leqslant n< 262144$。", "locale": "zh-CN", "translations": {"en": {"title": "Stirling Numbers of the First Kind · Row.", "background": "", "description": "The Stirling number of the first kind $\\begin{bmatrix}n\\\\ m\\end{bmatrix}$ represents the number of ways to arrange $n$ **distinct** elements into $m$ circular permutations.\n\nGiven $n$, for every integer $i\\in[0,n]$, you need to compute $\\begin{bmatrix}n\\\\ i\\end{bmatrix}$.\n\nSince the answer can be very large, you should output the result modulo $167772161$ ($2^{25}\\times 5+1$, which is a prime).", "inputFormat": "A single line containing a positive integer $n$, as described in the statement.", "outputFormat": "Output one line with $n+1$ non-negative integers.\n\nYou need to output, in order, the values of $\\begin{bmatrix}n\\\\ 0\\end{bmatrix},\\begin{bmatrix}n\\\\ 1\\end{bmatrix},\\begin{bmatrix}n\\\\ 2\\end{bmatrix},\\dots,\\begin{bmatrix}n\\\\ n\\end{bmatrix}$.", "hint": "For $20\\%$ of the testdata, $n\\leqslant 1000$.\n\nFor $100\\%$ of the testdata, $1\\leqslant n< 262144$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "第一类斯特林数·行", "background": null, "description": "第一类斯特林数 $\\begin{bmatrix}n\\\\ m\\end{bmatrix}$ 表示将 $n$ 个**不同**元素构成 $m$ 个圆排列的数目。\n\n给定 $n$，对于所有的整数 $i\\in[0,n]$，你要求出 $\\begin{bmatrix}n\\\\ i\\end{bmatrix}$。\n\n由于答案会非常大，所以你的输出需要对 $167772161$（$2^{25}\\times 5+1$，是一个质数）取模。", "inputFormat": "一行一个正整数 $n$，意义见题目描述。", "outputFormat": "共一行 $n+1$ 个非负整数。\n\n你需要按顺序输出 $\\begin{bmatrix}n\\\\ 0\\end{bmatrix},\\begin{bmatrix}n\\\\ 1\\end{bmatrix},\\begin{bmatrix}n\\\\ 2\\end{bmatrix},\\dots,\\begin{bmatrix}n\\\\ n\\end{bmatrix}$ 的值。", "hint": "对于 $20\\%$ 的数据，$n\\leqslant 1000$。\n\n对于 $100\\%$ 的数据，$1\\leqslant n< 262144$。", "locale": "zh-CN"}}}
