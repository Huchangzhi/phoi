{"pid": "P7810", "type": "P", "difficulty": 5, "samples": [["5\n2 1 8 3 9", "2"], ["5\n5 4 3 2 1", "-1"], ["20\n20 9 36 36 40 8 3 10 9 20 18 12 30 20 30 15 8 9 27 45", "7"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "线段树", "2021", "洛谷原创", "O2优化", "素数判断,质数,筛法"], "title": "[JRKSJ R2] Upper", "background": "", "description": "有 $n$ 张扑克，第 $i$ 张扑克上写有一个正整数 $a_i$。\n\n现在要把扑克划分成若干个合法的连续子段，其中，一个连续子段 $[l,r]$ “合法”当且仅当这个子段同时满足两个条件： \n\n* $a_l< a_r$\n* $\\gcd(a_l,a_r)>1$ \n\n请问最多能划分多少段。如果没有合法的划分方案，输出 $-1$ 即可。\n\n如果您不知道 $\\gcd$ 是什么意思，请看“提示”部分。", "inputFormat": "第一行一个整数 $n$。\\\n第二行 $n$ 个整数表示序列 $a$。", "outputFormat": "一个整数，如题目描述所示。", "hint": "### 数据范围\n本题采用捆绑测试。\n\n对于 $100\\%$ 的数据，$2\\le n\\le 10^5$，$1\\le a_i\\le 10^9$。\n\n| $\\text{Subtask}$ | $n\\le$ | $a_i\\le$ | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $5$ | $10^9$ | 无 | $5$ |\n| $2$ | $3\\times10^3$ | $10^9$ | 无 | $15$ |\n| $3$ | $2\\times10^4$ | $10^6$ | 无 | $20$ |\n| $4$ | $2\\times 10^4$ | $10^9$ | 无 | $10$ |\n| $5$ | $10^5$ | $10^9$ | 数据随机 | $10$ |\n| $6$ | $10^5$ | $10^9$ | 无 | $40$ |\n\n### 样例解释\n对于样例 $1$，有且仅有一种划分方案 $\\{2,1,8\\},\\{3,9\\}$。\\\n对于样例 $2$，无合法的划分方案。\n\n### 提示\n对于两个正整数 $a,b$，$\\gcd(a,b)$ 为它们的最大公因数，即满足既是 $a$ 的因数又是 $b$ 的因数的数中最大的数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JRKSJ R2] Upper", "background": "", "description": "有 $n$ 张扑克，第 $i$ 张扑克上写有一个正整数 $a_i$。\n\n现在要把扑克划分成若干个合法的连续子段，其中，一个连续子段 $[l,r]$ “合法”当且仅当这个子段同时满足两个条件： \n\n* $a_l< a_r$\n* $\\gcd(a_l,a_r)>1$ \n\n请问最多能划分多少段。如果没有合法的划分方案，输出 $-1$ 即可。\n\n如果您不知道 $\\gcd$ 是什么意思，请看“提示”部分。", "inputFormat": "第一行一个整数 $n$。\\\n第二行 $n$ 个整数表示序列 $a$。", "outputFormat": "一个整数，如题目描述所示。", "hint": "### 数据范围\n本题采用捆绑测试。\n\n对于 $100\\%$ 的数据，$2\\le n\\le 10^5$，$1\\le a_i\\le 10^9$。\n\n| $\\text{Subtask}$ | $n\\le$ | $a_i\\le$ | 特殊性质 | 分值 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $5$ | $10^9$ | 无 | $5$ |\n| $2$ | $3\\times10^3$ | $10^9$ | 无 | $15$ |\n| $3$ | $2\\times10^4$ | $10^6$ | 无 | $20$ |\n| $4$ | $2\\times 10^4$ | $10^9$ | 无 | $10$ |\n| $5$ | $10^5$ | $10^9$ | 数据随机 | $10$ |\n| $6$ | $10^5$ | $10^9$ | 无 | $40$ |\n\n### 样例解释\n对于样例 $1$，有且仅有一种划分方案 $\\{2,1,8\\},\\{3,9\\}$。\\\n对于样例 $2$，无合法的划分方案。\n\n### 提示\n对于两个正整数 $a,b$，$\\gcd(a,b)$ 为它们的最大公因数，即满足既是 $a$ 的因数又是 $b$ 的因数的数中最大的数。", "locale": "zh-CN"}}}
{"pid": "P7811", "type": "P", "difficulty": 6, "samples": [["10 10\n15 14 14 4 8 10 18 14 10 9 \n2 10 8\n2 4 7\n3 9 6\n1 7 5\n3 4 6\n6 6 12\n4 8 20\n1 6 18\n7 8 8\n2 6 6", "0\n0\n0\n0\n2\n10\n4\n4\n2\n2"], ["5 5\n77 24 80 90 92 \n2 3 84\n4 5 37\n1 1 4\n3 5 85\n1 4 46", "24\n16\n1\n5\n24"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 131072, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 262144, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 262144]}, "tags": ["2021", "洛谷原创", "O2优化", "分治", "分块", "ST 表"], "title": "[JRKSJ R2] 你的名字。", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/73iq08qk.png)", "description": "给你一个长为 $n$ 的序列 $a$，有 $m$ 次查询，每次查询区间 $[l,r]$ 模 $k$ 意义下的最小值。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示 $a$。\n\n下面 $m$ 行，每行三个整数 $l,r,k$ 表示一次询问。", "outputFormat": "对于每个查询操作，每行输出一个答案。", "hint": "Idea：mcyl35，Solution：mcyl35，Code：mcyl35，Data：cyffff&mcyl35\n\n本题采用捆绑测试。\n\n| $\\text{Subtask}$ | $n,m\\le$ | $k,a_i\\le$ | 特殊性质 | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $\\text{1}$ | $10^4$ | $10^5$ | 无 | $3$ | $1$ |\n| $\\text{2}$ | $10^5$ | $300$ | 无 | $6$ | $1$ |\n| $\\text{3}$ | $10^5$ | $10^5$ | $k\\ge 10^3$ | $10$ | $1\\to2$ |\n| $\\text{4}$ | $10^5$ | $10^5$ | 无 | $19$ |$2\\to4$ |\n| $\\text{5}$ | $3\\times10^5$ | $10^5$ | 数据随机 | $14$ |$1$ |\n| $\\text{6}$ | $3\\times10^5$ | $10^5$ | $k\\ge 10^3$ | $2$ |$2\\to3$ |\n| $\\text{7}$ | $3\\times10^5$ | $10^5$ | 无 | $46$ |$2\\to5$ |\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le3\\times10^5$，$1\\le a_i,k\\le 10^5$。\n\n前 $6$ 个 $\\text{Subtask}$ 的空间限制为 $256\\text{MB}$，第 $7$ 个 $\\text{Subtask}$ 的空间限制为 $128\\text{MB}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JRKSJ R2] 你的名字。", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/73iq08qk.png)", "description": "给你一个长为 $n$ 的序列 $a$，有 $m$ 次查询，每次查询区间 $[l,r]$ 模 $k$ 意义下的最小值。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示 $a$。\n\n下面 $m$ 行，每行三个整数 $l,r,k$ 表示一次询问。", "outputFormat": "对于每个查询操作，每行输出一个答案。", "hint": "Idea：mcyl35，Solution：mcyl35，Code：mcyl35，Data：cyffff&mcyl35\n\n本题采用捆绑测试。\n\n| $\\text{Subtask}$ | $n,m\\le$ | $k,a_i\\le$ | 特殊性质 | 分值 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $\\text{1}$ | $10^4$ | $10^5$ | 无 | $3$ | $1$ |\n| $\\text{2}$ | $10^5$ | $300$ | 无 | $6$ | $1$ |\n| $\\text{3}$ | $10^5$ | $10^5$ | $k\\ge 10^3$ | $10$ | $1\\to2$ |\n| $\\text{4}$ | $10^5$ | $10^5$ | 无 | $19$ |$2\\to4$ |\n| $\\text{5}$ | $3\\times10^5$ | $10^5$ | 数据随机 | $14$ |$1$ |\n| $\\text{6}$ | $3\\times10^5$ | $10^5$ | $k\\ge 10^3$ | $2$ |$2\\to3$ |\n| $\\text{7}$ | $3\\times10^5$ | $10^5$ | 无 | $46$ |$2\\to5$ |\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le3\\times10^5$，$1\\le a_i,k\\le 10^5$。\n\n前 $6$ 个 $\\text{Subtask}$ 的空间限制为 $256\\text{MB}$，第 $7$ 个 $\\text{Subtask}$ 的空间限制为 $128\\text{MB}$。", "locale": "zh-CN"}}}
{"pid": "P7812", "type": "P", "difficulty": 6, "samples": [["5\n1 4 3 2 5", "1 3 5 2 4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2021", "洛谷原创", "提交答案", "Special Judge", "模拟退火", "遗传算法", "随机化"], "title": "[JRKSJ R2] Dark Forest", "background": "**本题为提交答案题。**", "description": "给你一个长为 $n$ 的序列 $a$，定义 $1\\dots n$ 的排列 $p$ 的权值为\n\n$$\\sum_{i=1}^n p_i a_{p_{i-1}} a_{p_i}a_{p_{i+1}}$$\n\n你可以理解为这个排列是一个环，即 $p_{0}=p_n,p_{n+1}=p_1$。\n\n请构造一个权值**尽量大**的 $1\\dots n$ 的排列。", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n$ 个整数表示序列 $a$。", "outputFormat": "一行 $n$ 个整数表示排列。", "hint": "注意是 `a[p[i-1]] a[p[i+1]]`，数据有一定梯度。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，$1\\le n,a_i\\le 10^3$。\n\n### 样例解释\n\n该排列的权值为 $1\\times2\\times1\\times3+3\\times1\\times3\\times5+5\\times3\\times5\\times4+2\\times5\\times4\\times2+4\\times4\\times2\\times1=463$，可以证明这是最优的排列之一。\n\n### 评分方式\n\n**本题使用 Special Judge**，每个测试点都有 $10$ 个参数 $v_1,v_2,\\dots v_{10}$。如果你的输出的权值 $V\\ge v_i$，则该测试点您至少会获得 $i$ 分。\n\n特别的，如果您的输出不是一个 $1\\dots n$ 的排列，您会在该测试点获得 $0$ 分。\n\n评分参数已经放至附件。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JRKSJ R2] Dark Forest", "background": "**本题为提交答案题。**", "description": "给你一个长为 $n$ 的序列 $a$，定义 $1\\dots n$ 的排列 $p$ 的权值为\n\n$$\\sum_{i=1}^n p_i a_{p_{i-1}} a_{p_i}a_{p_{i+1}}$$\n\n你可以理解为这个排列是一个环，即 $p_{0}=p_n,p_{n+1}=p_1$。\n\n请构造一个权值**尽量大**的 $1\\dots n$ 的排列。", "inputFormat": "第一行一个整数 $n$。\n\n第二行 $n$ 个整数表示序列 $a$。", "outputFormat": "一行 $n$ 个整数表示排列。", "hint": "注意是 `a[p[i-1]] a[p[i+1]]`，数据有一定梯度。\n\n### 数据范围\n\n对于 $100\\%$ 的数据，$1\\le n,a_i\\le 10^3$。\n\n### 样例解释\n\n该排列的权值为 $1\\times2\\times1\\times3+3\\times1\\times3\\times5+5\\times3\\times5\\times4+2\\times5\\times4\\times2+4\\times4\\times2\\times1=463$，可以证明这是最优的排列之一。\n\n### 评分方式\n\n**本题使用 Special Judge**，每个测试点都有 $10$ 个参数 $v_1,v_2,\\dots v_{10}$。如果你的输出的权值 $V\\ge v_i$，则该测试点您至少会获得 $i$ 分。\n\n特别的，如果您的输出不是一个 $1\\dots n$ 的排列，您会在该测试点获得 $0$ 分。\n\n评分参数已经放至附件。", "locale": "zh-CN"}}}
{"pid": "P7813", "type": "P", "difficulty": 3, "samples": [["1\n5 5", "61"], ["5\n2676 1930\n5148 3667\n5453 4764\n16734806 16332913\n26943973 33293903 ", "909411538\n587883333\n823595806\n727601062\n965648555"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2021", "O2优化", "洛谷月赛"], "title": "谜", "background": "$\\text{我需要你给我方向}$\n\n$\\text{哪怕要我独自穿过人海茫茫}$\n\n$\\text{为了你尝风霜}$\n\n$\\text{我流浪远方}$\n\n$\\text{需要你给我力量}$\n\n$\\text{无论如何我会坚强}$\n\n$\\text{只要你给我希望}$\n\n[Source](https://www.kugou.com/song-36/1y5t3b.html)", "description": "在一个大小为 $N$ 的数字三角形中：\n\n- 第 $1$ 行为 $1$；\n- 第 $2$ 行为 $2\\sim3$；\n- 第 $3$ 行为 $4\\sim6$；\n- 第 $4$ 行为 $7\\sim10$；\n- $\\cdots~\\cdots$\n- 第 $N$ 行包含 $N$ 个数字，为 $\\frac{N(N-1)}{2}+1\\sim\\frac{N(N+1)}{2}$。\n\n下图展示了一个 $N=5$ 的数字三角形。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/fpx5rw7l.png)\n\n---\n\n记 $(i,j)$ 表示第 $i$ 行第 $j$ 个数字。\n\n已知 $(i,j)$ 能直接到达 $(i+1,j)$ 或 $(i+1,j+1)$，反之，$(i+1,j)$ 或 $(i+1,j+1)$ 也能直接到达 $(i,j)$。\n\n现在任选一个数字作为起点，求 **连续** 地经过 $K$ 个 **不同** 的数字时，这 $K$ 个数的和的最大值，对 $10^9+7$ 取模。", "inputFormat": "**本题包含多组数据测试。**\n\n第一行，输入一个正整数 $T$，表示询问组数。\n\n接下来 $T$ 行，每行输入两个正整数 $N,K$。", "outputFormat": "共 $T$ 行，每行输出一个整数，表示答案对 $10^9+7$ 取模的结果。", "hint": "#### 样例说明\n\n对于样例 #1，如题面中的图所示，一种可行的方案是：以 $13$ 为起点，$13\\rightarrow9\\rightarrow14\\rightarrow10\\rightarrow15$，和为 $13+9+14+10+15=61$。\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n| Subtask | 分值 | $N\\le$ | $K\\le$ |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $30$ | $10^3$  |  |\n| $2$ | $30$ | $10^6$ |  |\n| $3$ | $30$ | $10^9$ | $1$ |\n| $4$ | $10$ | $10^9$ |  |\n\n对于 $100\\%$ 的数据：$1\\le T\\le 10^5$，$1\\le\\color{red}\\dfrac{K+1}{2}\\le N\\color{black}\\le10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "谜", "background": "$\\text{我需要你给我方向}$\n\n$\\text{哪怕要我独自穿过人海茫茫}$\n\n$\\text{为了你尝风霜}$\n\n$\\text{我流浪远方}$\n\n$\\text{需要你给我力量}$\n\n$\\text{无论如何我会坚强}$\n\n$\\text{只要你给我希望}$\n\n[Source](https://www.kugou.com/song-36/1y5t3b.html)", "description": "在一个大小为 $N$ 的数字三角形中：\n\n- 第 $1$ 行为 $1$；\n- 第 $2$ 行为 $2\\sim3$；\n- 第 $3$ 行为 $4\\sim6$；\n- 第 $4$ 行为 $7\\sim10$；\n- $\\cdots~\\cdots$\n- 第 $N$ 行包含 $N$ 个数字，为 $\\frac{N(N-1)}{2}+1\\sim\\frac{N(N+1)}{2}$。\n\n下图展示了一个 $N=5$ 的数字三角形。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/fpx5rw7l.png)\n\n---\n\n记 $(i,j)$ 表示第 $i$ 行第 $j$ 个数字。\n\n已知 $(i,j)$ 能直接到达 $(i+1,j)$ 或 $(i+1,j+1)$，反之，$(i+1,j)$ 或 $(i+1,j+1)$ 也能直接到达 $(i,j)$。\n\n现在任选一个数字作为起点，求 **连续** 地经过 $K$ 个 **不同** 的数字时，这 $K$ 个数的和的最大值，对 $10^9+7$ 取模。", "inputFormat": "**本题包含多组数据测试。**\n\n第一行，输入一个正整数 $T$，表示询问组数。\n\n接下来 $T$ 行，每行输入两个正整数 $N,K$。", "outputFormat": "共 $T$ 行，每行输出一个整数，表示答案对 $10^9+7$ 取模的结果。", "hint": "#### 样例说明\n\n对于样例 #1，如题面中的图所示，一种可行的方案是：以 $13$ 为起点，$13\\rightarrow9\\rightarrow14\\rightarrow10\\rightarrow15$，和为 $13+9+14+10+15=61$。\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n| Subtask | 分值 | $N\\le$ | $K\\le$ |\n| :----------: | :----------: | :----------: | :----------: |\n| $1$ | $30$ | $10^3$  |  |\n| $2$ | $30$ | $10^6$ |  |\n| $3$ | $30$ | $10^9$ | $1$ |\n| $4$ | $10$ | $10^9$ |  |\n\n对于 $100\\%$ 的数据：$1\\le T\\le 10^5$，$1\\le\\color{red}\\dfrac{K+1}{2}\\le N\\color{black}\\le10^9$。", "locale": "zh-CN"}}}
{"pid": "P7814", "type": "P", "difficulty": 3, "samples": [["4\n1 1\n1\n3 5\n010\n4 8\n1101\n5 6\n11111", "-1\n01110\n10100101\n111101"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["字符串", "贪心", "Special Judge", "O2优化"], "title": "「小窝 R3」心の記憶", "background": "> 淡い夕暮れ飲み込まれて  \n「君」の消えかけて姿を  \n忘れさせるように走ってた   \n新しい平和の世界に  \n——[《心の記憶》](https://music.163.com/song?id=1847928316)", "description": "- 本题中「**子串**」的定义如下：\n\n字符串 $S$ 的子串是 $S$ 中**连续**的任意个字符组成的字符串。$S$ 的子串可用起始位置 $l$ 与终止位置 $r$ 来表示，记为 $S(l,r)$（$1 \\leq l \\leq r \\leq |S |,|S|$ 表示 $S$ 的长度）。\n\n- 本题中「**子序列**」的定义如下：\n\n对于字符串 $S$ 和一个长度为 $n$ 的严格单调递增数列 $k_1,k_2,\\cdots,k_n(\\forall 1\\le i\\le n,1\\le k_i\\le |S|)$，$S_{k_1},S_{k_2},\\cdots,S_{k_n}$ 所组成的字符串即为 $S$ 的子序列。\n\n---------------\n\n现有 $T$ 次询问。\n每次询问给定一个长度为 $n$ 的 01 串，记为 $A$。回答应是一个字符串 $B$，满足：\n\n- $B$ 是长度为 $m$ 的 01 串。\n- $B$ 中不存在任意一个**子串**与 $A$ 相同。\n- $B$ 中存在**至少**一个**子序列**与 $A$ 相同。\n\n输出任意一个满足要求的字符串 $B$ 即可。", "inputFormat": "第一行，一个正整数：$T$，表示询问次数。\n\n对于每一次询问，第一行两个正整数： $n,m(n\\le m)$，分别表示 01 串 $A,B$ 的长度。\n\n第二行，一个长度为 $n$ 的 01 串 $A$。", "outputFormat": "共 $T$ 行，每行一个长度为 $m$ 的 01 串 $B$。无解则输出 `-1`。", "hint": "### 样例解释\n\n在第二次询问中，`01101` 和 `10110` 是另外合法的方案。\n\n### 数据范围\n\n| Subtask | 分值 | $\\sum m\\le$ | 特殊性质 |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$  | $10$ | $2\\times10^6$ | $A$ 只由 `0` 组成 |\n| $2$ | $10$ | $15$ | 无 |\n| $3$ | $20$ | $2000$ | 无 |\n| $4$  | $30$ | $10^6$ | $A$ 随机生成 |\n| $5$ | $30$ | $2\\times 10^6$ | 无 |\n\n对于 $100\\%$ 的数据，$1\\le n\\le m$，$1\\le \\sum m\\le 2\\times 10^6$。保证 $A$ 只由 `0` 和 `1` 组成。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「小窝 R3」心の記憶", "background": "> 淡い夕暮れ飲み込まれて  \n「君」の消えかけて姿を  \n忘れさせるように走ってた   \n新しい平和の世界に  \n——[《心の記憶》](https://music.163.com/song?id=1847928316)", "description": "- 本题中「**子串**」的定义如下：\n\n字符串 $S$ 的子串是 $S$ 中**连续**的任意个字符组成的字符串。$S$ 的子串可用起始位置 $l$ 与终止位置 $r$ 来表示，记为 $S(l,r)$（$1 \\leq l \\leq r \\leq |S |,|S|$ 表示 $S$ 的长度）。\n\n- 本题中「**子序列**」的定义如下：\n\n对于字符串 $S$ 和一个长度为 $n$ 的严格单调递增数列 $k_1,k_2,\\cdots,k_n(\\forall 1\\le i\\le n,1\\le k_i\\le |S|)$，$S_{k_1},S_{k_2},\\cdots,S_{k_n}$ 所组成的字符串即为 $S$ 的子序列。\n\n---------------\n\n现有 $T$ 次询问。\n每次询问给定一个长度为 $n$ 的 01 串，记为 $A$。回答应是一个字符串 $B$，满足：\n\n- $B$ 是长度为 $m$ 的 01 串。\n- $B$ 中不存在任意一个**子串**与 $A$ 相同。\n- $B$ 中存在**至少**一个**子序列**与 $A$ 相同。\n\n输出任意一个满足要求的字符串 $B$ 即可。", "inputFormat": "第一行，一个正整数：$T$，表示询问次数。\n\n对于每一次询问，第一行两个正整数： $n,m(n\\le m)$，分别表示 01 串 $A,B$ 的长度。\n\n第二行，一个长度为 $n$ 的 01 串 $A$。", "outputFormat": "共 $T$ 行，每行一个长度为 $m$ 的 01 串 $B$。无解则输出 `-1`。", "hint": "### 样例解释\n\n在第二次询问中，`01101` 和 `10110` 是另外合法的方案。\n\n### 数据范围\n\n| Subtask | 分值 | $\\sum m\\le$ | 特殊性质 |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$  | $10$ | $2\\times10^6$ | $A$ 只由 `0` 组成 |\n| $2$ | $10$ | $15$ | 无 |\n| $3$ | $20$ | $2000$ | 无 |\n| $4$  | $30$ | $10^6$ | $A$ 随机生成 |\n| $5$ | $30$ | $2\\times 10^6$ | 无 |\n\n对于 $100\\%$ 的数据，$1\\le n\\le m$，$1\\le \\sum m\\le 2\\times 10^6$。保证 $A$ 只由 `0` 和 `1` 组成。", "locale": "zh-CN"}}}
{"pid": "P7815", "type": "P", "difficulty": 6, "samples": [["5\n1 2 2\n1 3 3\n2 4 1\n2 5 2", "214285725"], ["9\n1 2 9\n1 3 3\n2 4 5\n2 5 7\n2 6 2\n1 7 1\n3 8 6\n3 9 4", "662721928"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["线段树", "O2优化", "树论"], "title": "「小窝 R3」自傷無色", "background": "> こんな僕が生きてるだけで    \n何万人のひとが悲しんで  \n誰も僕を望まない  \nそんな世界だったらいいのにな  \n——[《自傷無色》](https://music.163.com/song?id=29124091)", "description": "给定一棵 $n$ 个节点的树，根节点为 $1$，有边权。约定树上 $u,v$ 两点间路径长度 $d(u,v)$ 为 $u,v$ 间路径上的边权和。\n\n对于一个无序二元组 $(u,v)$，定义一个「树三角」当且仅当同时满足：\n\n- $u,v$ 的最近公共祖先 $w\\neq u$ 且 $w\\neq v$。\n- 以 $d(u,w),d(v,w)$ 和某个正整数 $x$ 为边长，能构成一个三角形。$x$ 是任意选取的，因此一对 $(u,v)$ 可能会产生多个树三角。\n\n此时 $d(u,w)+d(v,w)+x$ 即为这个树三角的大小。具体例子参考样例解释。\n\n定义两个树三角不同，只需满足下列条件中的**一条**：\n\n- 无序二元组 $(u,v)$ 不同。\n- 树三角的大小不同。\n\n对于一个带边权的树 $T$，定义其正弦值 $\\sin T$ 为 $T$ 中所有树三角大小的和与 $T$ 中不同树三角总数量的比值。\n\n小 H 给出了 $T$，希望你能求出 $\\sin T$。为了避免误差，结果对 $10^9+7$ 取模。特别地，若 $T$ 中不存在树三角，则 $\\sin T=0$。", "inputFormat": "第一行，一个正整数 $n$：表示树的节点数。\n\n接下来 $n-1$ 行，每行三个正整数 $u,v,w$：表示节点 $u,v$ 之间有一条权值为 $w$ 的边。", "outputFormat": "共一行，为 $\\sin T$ 的值对 $10^9+7$ 取模。数据保证 $T$ 中不同树三角总数量不是 $10^9+7$ 的倍数。", "hint": "### 样例解释\n\n对于样例 1，$T$ 如下图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/35edha17.png)\n\n节点 $1,2,3$ 构成的三角环有：$\\underline{2,3},2;~\\underline{2,3},3;~\\underline{2,3},4$。\n\n节点 $1,3,4$ 构成的三角环有：$\\underline{3,3},1;~\\underline{3,3},2;~\\underline{3,3},3;~\\underline{3,3},4;~\\underline{3,3},5$。\n\n节点 $1,3,5$ 构成的三角环有：$\\underline{3,4},2;~\\underline{3,4},3;~\\underline{3,4},4;~\\underline{3,4},5;~\\underline{3,4},6$。\n\n节点 $2,4,5$ 构成的三角环有：$\\underline{1,2},2$。\n\n所有三角环大小之和：$(7+8+9)+(7+8+\\dots+11)+(9+10+\\dots+13)+5=129$。\n\n所有三角环的总个数：$3+5+5+1=14$。\n\n$\\sin T=\\dfrac{129}{14}$，对 $10^9+7$ 取模后的结果为 $214285725$。\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n- 特殊性质 A：保证 $T$ 中存在度为 $n-1$ 的节点。\n- 特殊性质 B：保证 $T$ 中除了叶子节点，每个节点的度均为 $2$。\n- 特殊性质 C：保证 $T$ 为满二叉树。\n\n| Subtask | 分值 | $1\\le n\\le $ |  特殊性质 |\n| :-----------: | :-----------: | :-----------: | :-----------: | \n| $1$ | $5$  | $3$ | 无 |\n| $2$ | $13$ | $10^3$ |  无 |\n| $3$ | $11$ | $7\\times10^3$ | 无 |\n| $4$ | $17$ | $10^5$ | A |\n| $5$ | $17$ | $10^5$ | B |\n| $6$ | $17$ | $10^5$ | C |\n| $7$ | $20$ | $10^5$ |  无 |\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^5$，$1\\le w\\le 10^9$。\n\n### 提示\n\n在题目附件 `depression_sample.zip` 中：\n\n- `depression_sample1.in` 即为样例 #1。\n- `depression_sample2.in` 满足特殊性质 A。\n- `depression_sample3.in` 满足特殊性质 B。\n- `depression_sample4.in` 满足特殊性质 C。\n- `depression_sample5.in` 不满足特殊性质。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「小窝 R3」自傷無色", "background": "> こんな僕が生きてるだけで    \n何万人のひとが悲しんで  \n誰も僕を望まない  \nそんな世界だったらいいのにな  \n——[《自傷無色》](https://music.163.com/song?id=29124091)", "description": "给定一棵 $n$ 个节点的树，根节点为 $1$，有边权。约定树上 $u,v$ 两点间路径长度 $d(u,v)$ 为 $u,v$ 间路径上的边权和。\n\n对于一个无序二元组 $(u,v)$，定义一个「树三角」当且仅当同时满足：\n\n- $u,v$ 的最近公共祖先 $w\\neq u$ 且 $w\\neq v$。\n- 以 $d(u,w),d(v,w)$ 和某个正整数 $x$ 为边长，能构成一个三角形。$x$ 是任意选取的，因此一对 $(u,v)$ 可能会产生多个树三角。\n\n此时 $d(u,w)+d(v,w)+x$ 即为这个树三角的大小。具体例子参考样例解释。\n\n定义两个树三角不同，只需满足下列条件中的**一条**：\n\n- 无序二元组 $(u,v)$ 不同。\n- 树三角的大小不同。\n\n对于一个带边权的树 $T$，定义其正弦值 $\\sin T$ 为 $T$ 中所有树三角大小的和与 $T$ 中不同树三角总数量的比值。\n\n小 H 给出了 $T$，希望你能求出 $\\sin T$。为了避免误差，结果对 $10^9+7$ 取模。特别地，若 $T$ 中不存在树三角，则 $\\sin T=0$。", "inputFormat": "第一行，一个正整数 $n$：表示树的节点数。\n\n接下来 $n-1$ 行，每行三个正整数 $u,v,w$：表示节点 $u,v$ 之间有一条权值为 $w$ 的边。", "outputFormat": "共一行，为 $\\sin T$ 的值对 $10^9+7$ 取模。数据保证 $T$ 中不同树三角总数量不是 $10^9+7$ 的倍数。", "hint": "### 样例解释\n\n对于样例 1，$T$ 如下图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/35edha17.png)\n\n节点 $1,2,3$ 构成的三角环有：$\\underline{2,3},2;~\\underline{2,3},3;~\\underline{2,3},4$。\n\n节点 $1,3,4$ 构成的三角环有：$\\underline{3,3},1;~\\underline{3,3},2;~\\underline{3,3},3;~\\underline{3,3},4;~\\underline{3,3},5$。\n\n节点 $1,3,5$ 构成的三角环有：$\\underline{3,4},2;~\\underline{3,4},3;~\\underline{3,4},4;~\\underline{3,4},5;~\\underline{3,4},6$。\n\n节点 $2,4,5$ 构成的三角环有：$\\underline{1,2},2$。\n\n所有三角环大小之和：$(7+8+9)+(7+8+\\dots+11)+(9+10+\\dots+13)+5=129$。\n\n所有三角环的总个数：$3+5+5+1=14$。\n\n$\\sin T=\\dfrac{129}{14}$，对 $10^9+7$ 取模后的结果为 $214285725$。\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n- 特殊性质 A：保证 $T$ 中存在度为 $n-1$ 的节点。\n- 特殊性质 B：保证 $T$ 中除了叶子节点，每个节点的度均为 $2$。\n- 特殊性质 C：保证 $T$ 为满二叉树。\n\n| Subtask | 分值 | $1\\le n\\le $ |  特殊性质 |\n| :-----------: | :-----------: | :-----------: | :-----------: | \n| $1$ | $5$  | $3$ | 无 |\n| $2$ | $13$ | $10^3$ |  无 |\n| $3$ | $11$ | $7\\times10^3$ | 无 |\n| $4$ | $17$ | $10^5$ | A |\n| $5$ | $17$ | $10^5$ | B |\n| $6$ | $17$ | $10^5$ | C |\n| $7$ | $20$ | $10^5$ |  无 |\n\n对于 $100\\%$ 的数据，$1\\le n\\le 10^5$，$1\\le w\\le 10^9$。\n\n### 提示\n\n在题目附件 `depression_sample.zip` 中：\n\n- `depression_sample1.in` 即为样例 #1。\n- `depression_sample2.in` 满足特殊性质 A。\n- `depression_sample3.in` 满足特殊性质 B。\n- `depression_sample4.in` 满足特殊性质 C。\n- `depression_sample5.in` 不满足特殊性质。", "locale": "zh-CN"}}}
{"pid": "P7816", "type": "P", "difficulty": 6, "samples": [["4 5\n1 2 1\n1 3 2\n2 3 1\n2 4 1\n4 1 2\n", "00100\n"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["搜索", "图论", "Special Judge", "O2优化", "深度优先搜索 DFS", "图遍历", "欧拉回路", "构造", "2029"], "title": "「Stoi2029」以父之名", "background": "> 以父之名判决  \n> 那感觉没有适合字汇  \n> 就像边笑边掉泪  \n> 凝视着完全的黑  \n> 阻挡悲剧蔓延的悲剧会让我沉醉  \n> ——《[以父之名](https://www.bilibili.com/video/BV1fx411N7bU?p=36)》", "description": "地狱里有 $n$ 个罪人在等待判决，编号为 $1$ 至 $n$。罪人们之间有 $m$ 条罪的联系，编号为 $1$ 至 $m$，每条联系 的值为 $1$ 或 $2$ 且恰好连接两个罪人。\n\n称一个罪人的自负度为他和其他所有罪人之间联系的值之和。两个罪人之间可能不止有一条联系，此时这些联系的值都应该被计算。由于这些罪人承受了太多的罪恶，他们变得不和谐。具体地，每个罪人的自负度都是奇数。\n\n现在，神明将要对他们进行判决。判决的具体方式为：将每条联系都进行定向，使得这条联系所连接的两个罪人中的一个受到惩罚，另一个受到救赎，它们的值均为这条联系的值。\n\n由于神明秉承父的仁慈，希望罪人们更加均等地接受惩罚和救赎，于是他规定判决后每个罪人所受到的惩罚和救赎值总和之差的绝对值必须恰好为 $1$。\n\n由于神明工作繁忙，因此他以父之名要求你为他找到一种判决的方法。由于父的指示不会有错，所以一定存在一种这样的方法。\n\n---\n\n#### 题意简述\n\n给定一个 $n$ 个点 $m$ 条边的无向图，边权均为 $1$ 或 $2$。保证每个点所相连的边权值之和均为奇数。你需要将这些边定向，使每个点的入边权值和与出边权值和之差的绝对值恰为 $1$。保证有解。输出任意一种方案。", "inputFormat": "第一行两个正整数：$n,m$，表示有 $n$ 个罪人和 $m$ 条罪的联系。\n\n接下来 $m$ 行，第 $i+1$ 行为三个正整数：$u_i,v_i,w_i$，表示第 $i$ 条联系连接 $u_i$ 与 $v_i$ 且值为 $w_i$。", "outputFormat": "共一行 $m$ 个数字，第 $i$ 个数字为 $0$ 表示使 $u_i$ 受到惩罚，使 $v_i$ 受到救赎；为 $1$ 表示使 $v_i$ 受到惩罚，使 $u_i$ 受到救赎。", "hint": "#### 样例解释\n\n定向后的图如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/uhz96nbm.png)\n\n更多样例详见题目附件 `trial_sample.zip`。\n\n------\n\n#### 数据范围\n\n**本题采用捆绑测试。**\n\n- 特殊性质 A：边权均为 $1$，且任意两点之间只存在一条简单路径，且没有重边。\n- 特殊性质 B：同一个点至多只有一条边权为 $1$ 和一条边权为 $2$ 的边相连。\n\n| Subtask | 分值 | $1\\le n \\le$ | $1\\le m \\le$ | 特殊性质 | \n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | $7$ | $10$ | $15$ | 无 | \n| $2$ |  $20$ |$10^3$ | $3\\times10^3$ | 无 |\n| $3$ |  $20$ |$3 \\times 10^5$ | $3 \\times 10^5$ | A |\n| $4$ | $20$ |$3 \\times 10^5$ | $3 \\times 10^5$ | B | \n| $5$ |  $33$ |$10^6$ | $3 \\times 10^6$ | 无 |\n\n对于 $100\\%$ 的数据，$1 \\le u_i,v_i \\le n \\le 10^6$，$1 \\le m \\le 3 \\times 10^6$，$w_i \\in \\{1,2\\}$。\n\n在题目附件 `trial_sample.zip` 中：\n\n- `trial_sample1.in` 即为样例 #1。\n- `trial_sample2.in` 满足特殊性质 A。\n- `trial_sample3.in` 满足特殊性质 B。\n- `trial_sample4.in` 不满足特殊性质。\n\n另外该目录下还有 `checker.exe`。\n\n------\n\n#### 提示\n\n**本题输入输出量较大，请使用较快的输入输出方式。**\n\n本题提供 [Special Judge 源码](https://www.luogu.com.cn/paste/7albhubs)和 `checker.exe`，供选手调试。Windows 下使用方法为:  \n命令行在目标文件夹输入指令：\n```\nchecker.exe data.in data.out data.out\n```\n其中 `data.in` 是输入数据文件，`data.out` 是程序运行结果文件。观察评判结果即可。\n\n- `Perfect answer.` 表示答案正确。\n-  `Wrong answer on node x, and the difference is d.` 表示答案错误，其中节点 $x$ 的入边权值和与出边权值和之差的绝对值为 $d$ 而不为 $1$。\n- `Invalid answer.` 表示输出的字符串长度不正确或输出非法字符。\n\n请务必保证**输出格式正确**，否则 Special Judge 可能会返回 Unknown Error 等不可预估的结果。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Stoi2029」以父之名", "background": "> 以父之名判决  \n> 那感觉没有适合字汇  \n> 就像边笑边掉泪  \n> 凝视着完全的黑  \n> 阻挡悲剧蔓延的悲剧会让我沉醉  \n> ——《[以父之名](https://www.bilibili.com/video/BV1fx411N7bU?p=36)》", "description": "地狱里有 $n$ 个罪人在等待判决，编号为 $1$ 至 $n$。罪人们之间有 $m$ 条罪的联系，编号为 $1$ 至 $m$，每条联系 的值为 $1$ 或 $2$ 且恰好连接两个罪人。\n\n称一个罪人的自负度为他和其他所有罪人之间联系的值之和。两个罪人之间可能不止有一条联系，此时这些联系的值都应该被计算。由于这些罪人承受了太多的罪恶，他们变得不和谐。具体地，每个罪人的自负度都是奇数。\n\n现在，神明将要对他们进行判决。判决的具体方式为：将每条联系都进行定向，使得这条联系所连接的两个罪人中的一个受到惩罚，另一个受到救赎，它们的值均为这条联系的值。\n\n由于神明秉承父的仁慈，希望罪人们更加均等地接受惩罚和救赎，于是他规定判决后每个罪人所受到的惩罚和救赎值总和之差的绝对值必须恰好为 $1$。\n\n由于神明工作繁忙，因此他以父之名要求你为他找到一种判决的方法。由于父的指示不会有错，所以一定存在一种这样的方法。\n\n---\n\n#### 题意简述\n\n给定一个 $n$ 个点 $m$ 条边的无向图，边权均为 $1$ 或 $2$。保证每个点所相连的边权值之和均为奇数。你需要将这些边定向，使每个点的入边权值和与出边权值和之差的绝对值恰为 $1$。保证有解。输出任意一种方案。", "inputFormat": "第一行两个正整数：$n,m$，表示有 $n$ 个罪人和 $m$ 条罪的联系。\n\n接下来 $m$ 行，第 $i+1$ 行为三个正整数：$u_i,v_i,w_i$，表示第 $i$ 条联系连接 $u_i$ 与 $v_i$ 且值为 $w_i$。", "outputFormat": "共一行 $m$ 个数字，第 $i$ 个数字为 $0$ 表示使 $u_i$ 受到惩罚，使 $v_i$ 受到救赎；为 $1$ 表示使 $v_i$ 受到惩罚，使 $u_i$ 受到救赎。", "hint": "#### 样例解释\n\n定向后的图如下：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/uhz96nbm.png)\n\n更多样例详见题目附件 `trial_sample.zip`。\n\n------\n\n#### 数据范围\n\n**本题采用捆绑测试。**\n\n- 特殊性质 A：边权均为 $1$，且任意两点之间只存在一条简单路径，且没有重边。\n- 特殊性质 B：同一个点至多只有一条边权为 $1$ 和一条边权为 $2$ 的边相连。\n\n| Subtask | 分值 | $1\\le n \\le$ | $1\\le m \\le$ | 特殊性质 | \n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | $7$ | $10$ | $15$ | 无 | \n| $2$ |  $20$ |$10^3$ | $3\\times10^3$ | 无 |\n| $3$ |  $20$ |$3 \\times 10^5$ | $3 \\times 10^5$ | A |\n| $4$ | $20$ |$3 \\times 10^5$ | $3 \\times 10^5$ | B | \n| $5$ |  $33$ |$10^6$ | $3 \\times 10^6$ | 无 |\n\n对于 $100\\%$ 的数据，$1 \\le u_i,v_i \\le n \\le 10^6$，$1 \\le m \\le 3 \\times 10^6$，$w_i \\in \\{1,2\\}$。\n\n在题目附件 `trial_sample.zip` 中：\n\n- `trial_sample1.in` 即为样例 #1。\n- `trial_sample2.in` 满足特殊性质 A。\n- `trial_sample3.in` 满足特殊性质 B。\n- `trial_sample4.in` 不满足特殊性质。\n\n另外该目录下还有 `checker.exe`。\n\n------\n\n#### 提示\n\n**本题输入输出量较大，请使用较快的输入输出方式。**\n\n本题提供 [Special Judge 源码](https://www.luogu.com.cn/paste/7albhubs)和 `checker.exe`，供选手调试。Windows 下使用方法为:  \n命令行在目标文件夹输入指令：\n```\nchecker.exe data.in data.out data.out\n```\n其中 `data.in` 是输入数据文件，`data.out` 是程序运行结果文件。观察评判结果即可。\n\n- `Perfect answer.` 表示答案正确。\n-  `Wrong answer on node x, and the difference is d.` 表示答案错误，其中节点 $x$ 的入边权值和与出边权值和之差的绝对值为 $d$ 而不为 $1$。\n- `Invalid answer.` 表示输出的字符串长度不正确或输出非法字符。\n\n请务必保证**输出格式正确**，否则 Special Judge 可能会返回 Unknown Error 等不可预估的结果。", "locale": "zh-CN"}}}
{"pid": "P7817", "type": "P", "difficulty": 3, "samples": [["1\n1", "1"]], "limits": {"time": [1000, 1000], "memory": [524288, 524288]}, "tags": ["数学"], "title": "[RC-05] 迷失自我", "background": "[广告](http://119.27.163.117/problem/86)", "description": "对于两个只包含 $7,9$ 的数字串 $S,T$，如果：\n\n- $S,T$ 长度均为 $n$；\n- $S$ 的字典序小于 $T$；\n- 对于任意 $[l_1,r_1]$ 和 $[l_2,r_2]$（$1\\le l_1\\le r_1\\le n$，$1\\le l_2\\le r_2\\le n$，$l_1,r_1,l_2,r_2$ 为整数，两个区间不相同），设 $A_S$ 为将 $S$ 的第 $l_1\\sim r_1$ 个字符顺次排列得到的十进制数，$A_T$ 为将 $T$ 的第 $l_1\\sim r_1$ 个字符顺次排列得到的十进制数，$B_S$ 为将 $S$ 的第 $l_2\\sim r_2$ 个字符顺次排列得到的十进制数，$B_T$ 为将 $T$ 的第 $l_2\\sim r_2$ 个字符顺次排列得到的十进制数，有 $\\gcd(A_S,B_S)=\\gcd(A_T,B_T)$。\n\n那么，就称 $(S,T)$ 是无法辨识的一对。比如，$S=7977$ 和 $T=7979$ 不是无法辨识的，因为取 $[l_1,r_1]=[1,4]$，$[l_2,r_2]=[2,2]$，则 $\\gcd(A_S,B_S)=\\gcd(7977,9)=3$，$\\gcd(A_T,B_T)=\\gcd(7979,9)=1$，有 $3\\ne 1$。\n\n求长度为 $n$ 的只含 $7,9$ 的数字串中有几对无法辨识。你只需求出答案对 $998244353$ 取模的值。", "inputFormat": "**本题单个测试点内有多组数据。**\n\n第一行是一个整数，为数据组数 $T$。\n\n接下来一行，每行一个整数，为询问的 $n$。", "outputFormat": "$T$ 行，每行一个整数，为这组数据的答案对 $998244353$ 取模的值。", "hint": "对于所有数据，$1\\le T\\le 10^4$，$1\\le n\\le 10^{18}$。\n\n详细数据范围如下表：\n\n| 测试点编号 | $n$ | $T$ | 分数 |\n| :-----------: | :-----------: | :-----------: | :-----------: | \n| $1$ | $\\le 10$ | $\\le 10$ | $2$ |\n| $2$ | $\\le 10^{18}$ | $\\le 10^4$ | $98$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[RC-05] 迷失自我", "background": "[广告](http://119.27.163.117/problem/86)", "description": "对于两个只包含 $7,9$ 的数字串 $S,T$，如果：\n\n- $S,T$ 长度均为 $n$；\n- $S$ 的字典序小于 $T$；\n- 对于任意 $[l_1,r_1]$ 和 $[l_2,r_2]$（$1\\le l_1\\le r_1\\le n$，$1\\le l_2\\le r_2\\le n$，$l_1,r_1,l_2,r_2$ 为整数，两个区间不相同），设 $A_S$ 为将 $S$ 的第 $l_1\\sim r_1$ 个字符顺次排列得到的十进制数，$A_T$ 为将 $T$ 的第 $l_1\\sim r_1$ 个字符顺次排列得到的十进制数，$B_S$ 为将 $S$ 的第 $l_2\\sim r_2$ 个字符顺次排列得到的十进制数，$B_T$ 为将 $T$ 的第 $l_2\\sim r_2$ 个字符顺次排列得到的十进制数，有 $\\gcd(A_S,B_S)=\\gcd(A_T,B_T)$。\n\n那么，就称 $(S,T)$ 是无法辨识的一对。比如，$S=7977$ 和 $T=7979$ 不是无法辨识的，因为取 $[l_1,r_1]=[1,4]$，$[l_2,r_2]=[2,2]$，则 $\\gcd(A_S,B_S)=\\gcd(7977,9)=3$，$\\gcd(A_T,B_T)=\\gcd(7979,9)=1$，有 $3\\ne 1$。\n\n求长度为 $n$ 的只含 $7,9$ 的数字串中有几对无法辨识。你只需求出答案对 $998244353$ 取模的值。", "inputFormat": "**本题单个测试点内有多组数据。**\n\n第一行是一个整数，为数据组数 $T$。\n\n接下来一行，每行一个整数，为询问的 $n$。", "outputFormat": "$T$ 行，每行一个整数，为这组数据的答案对 $998244353$ 取模的值。", "hint": "对于所有数据，$1\\le T\\le 10^4$，$1\\le n\\le 10^{18}$。\n\n详细数据范围如下表：\n\n| 测试点编号 | $n$ | $T$ | 分数 |\n| :-----------: | :-----------: | :-----------: | :-----------: | \n| $1$ | $\\le 10$ | $\\le 10$ | $2$ |\n| $2$ | $\\le 10^{18}$ | $\\le 10^4$ | $98$ |", "locale": "zh-CN"}}}
{"pid": "P7818", "type": "P", "difficulty": 5, "samples": [["5 2\n2 1 4 3 5", "1 2 3 4 5"], ["5 3\n5 4 3 2 1", "2 5 4 3 1"], ["5 6\n5 4 3 2 1", "1 3 5 4 2"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["贪心", "线段树", "树状数组", "O2优化"], "title": "[RC-05] 排列", "background": "[广告](http://119.27.163.117/problem/97)", "description": "给出 $1\\sim n$ 的排列 $p$，下标从 $1$ 开始。\n\n**恰好** $K$ 次任意选择 $1\\le i<n$ 并交换 $p_i,p_{i+1}$。问交换完毕后，字典序最小的排列 $p$ 是什么？", "inputFormat": "第一行两个非负整数 $n,K$，分别表示排列中数的个数和交换次数。\n\n接下来一行 $n$ 个整数，描述排列 $p$。", "outputFormat": "一行以空格隔开的 $n$ 个正整数，描述交换完成之后的排列。", "hint": "**本题捆绑测试。**\n\n对于所有数据，$1\\le n\\le 5\\times 10^5$，$0\\le K\\le 10^{12}$。\n\n详细数据范围如下表：\n\n| Subtask 编号 | $n$ | $K$ | 分数 |\n| :-----------: | :-----------: | :-----------: | :-----------: | \n| $1$ | $\\le 8$ | |$30$ |\n| $2$ | $\\le 10^3$ |  |$30$ |\n| $3$ | $\\le 10^3$ | $=10^{12}$ | $15$ |\n| $4$ | $\\le 5\\times 10^5$ | | $25$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[RC-05] 排列", "background": "[广告](http://119.27.163.117/problem/97)", "description": "给出 $1\\sim n$ 的排列 $p$，下标从 $1$ 开始。\n\n**恰好** $K$ 次任意选择 $1\\le i<n$ 并交换 $p_i,p_{i+1}$。问交换完毕后，字典序最小的排列 $p$ 是什么？", "inputFormat": "第一行两个非负整数 $n,K$，分别表示排列中数的个数和交换次数。\n\n接下来一行 $n$ 个整数，描述排列 $p$。", "outputFormat": "一行以空格隔开的 $n$ 个正整数，描述交换完成之后的排列。", "hint": "**本题捆绑测试。**\n\n对于所有数据，$1\\le n\\le 5\\times 10^5$，$0\\le K\\le 10^{12}$。\n\n详细数据范围如下表：\n\n| Subtask 编号 | $n$ | $K$ | 分数 |\n| :-----------: | :-----------: | :-----------: | :-----------: | \n| $1$ | $\\le 8$ | |$30$ |\n| $2$ | $\\le 10^3$ |  |$30$ |\n| $3$ | $\\le 10^3$ | $=10^{12}$ | $15$ |\n| $4$ | $\\le 5\\times 10^5$ | | $25$ |", "locale": "zh-CN"}}}
{"pid": "P7819", "type": "P", "difficulty": 7, "samples": [["15 233\n2\n1 1 3 3 2\n4 8 14 200 24", "319\n7032"], ["939 943 10\n94 618 848 927 92\n421 16 525 45 99\n77 524 662 779 82\n316 630 910 669 51\n857 241 890 447 9\n44 30 95 409 83\n408 302 804 331 73\n571 42 761 334 70\n419 220 704 855 54\n432 80 669 799 52", "33786429\n97803\n41147634\n6638925\n738\n96232\n19796958\n14611599\n6717042\n6402992"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "类欧几里得算法"], "title": "[RC-05] Xor Matrix", "background": "", "description": "给出一个 $n\\times m$ 的矩阵，第 $i$ 行第 $j$ 列填着 $(i-1)m+j$。\n\n求以 $(x,y)$ 为左上角，$(z,w)$ 为右下角的子矩阵的 $k$ 进制下异或和（即不进位加法，比如九进制下 $(45)_9\\ \\mathrm{xor}\\ (87)_9=(33)_9$）。", "inputFormat": "**为了减小测试点个数，本题单个测试点内有多个询问。时间限制已经根据询问组数作了相应调整。**\n\n第一行两个正整数 $n,m$。\n\n接下来一行一个整数 $q$，表示询问次数。\n\n接下来 $q$ 行，每行五个正整数 $x,y,z,w,k$，表示一次询问。", "outputFormat": "输出 $q$ 行，每行一个整数，表示询问的答案。", "hint": "**本题捆绑测试。**\n\n对于所有数据，$1\\le n,m\\le nm\\le 10^{10}$，$1\\le q\\le 10$，$1\\le x\\le z\\le n$，$1\\le y\\le w\\le m$，$2\\le k\\le 10^9$。\n\n详细数据范围如下表：\n\n| Subtask 编号 | $nm$ | 特殊性质 | 分数 | \n| :-----------: | :-----------: | :-----------: | :-----------: | \n| $1$ | $\\le 10^{10}$ | $n\\le 10^5$ | $18$ | \n| $2$ | $\\le 2\\times 10^{9}$ | 无 | $61$ | \n| $3$ | $\\le 10^{10}$ | 无 | $21$ |\n\n\n### 子任务依赖\n\n在洛谷上，本题没有设置子任务依赖。在 InfOJ 上，子任务 $3$ 依赖于子任务 $1$。最终评分时，按照存在子任务依赖的版本评分。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[RC-05] Xor Matrix", "background": "", "description": "给出一个 $n\\times m$ 的矩阵，第 $i$ 行第 $j$ 列填着 $(i-1)m+j$。\n\n求以 $(x,y)$ 为左上角，$(z,w)$ 为右下角的子矩阵的 $k$ 进制下异或和（即不进位加法，比如九进制下 $(45)_9\\ \\mathrm{xor}\\ (87)_9=(33)_9$）。", "inputFormat": "**为了减小测试点个数，本题单个测试点内有多个询问。时间限制已经根据询问组数作了相应调整。**\n\n第一行两个正整数 $n,m$。\n\n接下来一行一个整数 $q$，表示询问次数。\n\n接下来 $q$ 行，每行五个正整数 $x,y,z,w,k$，表示一次询问。", "outputFormat": "输出 $q$ 行，每行一个整数，表示询问的答案。", "hint": "**本题捆绑测试。**\n\n对于所有数据，$1\\le n,m\\le nm\\le 10^{10}$，$1\\le q\\le 10$，$1\\le x\\le z\\le n$，$1\\le y\\le w\\le m$，$2\\le k\\le 10^9$。\n\n详细数据范围如下表：\n\n| Subtask 编号 | $nm$ | 特殊性质 | 分数 | \n| :-----------: | :-----------: | :-----------: | :-----------: | \n| $1$ | $\\le 10^{10}$ | $n\\le 10^5$ | $18$ | \n| $2$ | $\\le 2\\times 10^{9}$ | 无 | $61$ | \n| $3$ | $\\le 10^{10}$ | 无 | $21$ |\n\n\n### 子任务依赖\n\n在洛谷上，本题没有设置子任务依赖。在 InfOJ 上，子任务 $3$ 依赖于子任务 $1$。最终评分时，按照存在子任务依赖的版本评分。", "locale": "zh-CN"}}}
{"pid": "P7820", "type": "P", "difficulty": 7, "samples": [["3\n4 3 1\n5 3 1\n15 7 2", "10\n16\n1586"], ["5\n999999999 14 7\n233333333 14 8\n333333333 14 9\n114514191 14 10\n981011451 14 11", "278944053\n533032251\n736989868\n589364996\n572821890"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "线性递推", "快速数论变换 NTT", "Berlekamp-Massey(BM) 算法"], "title": "[RC-05] 01 序列", "background": "", "description": "有一个长度为 $n$ 的 $01$ 序列，它的任意一个长为 $k$ 的连续子串中都有 $a$ 个 $0$ 或 $a+1$ 个 $0$。\n\n求可能的序列数。答案很大，请输出其模 $998244353$ 的值。", "inputFormat": "**为了减小测试点个数，本题单个测试点内有多组数据。时间限制已经根据数据组数作了相应调整。**\n\n输入第一行是数据组数 $T$。\n\n每组数据中，输入一行三个整数：$n,k,a$。", "outputFormat": "对于每组数据，输出一个非负整数，为可能的序列数模 $998244353$ 的值。", "hint": "**本题捆绑测试。**\n\n对于所有数据，$1\\le T\\le 5$，$1\\le k\\le n\\le 10^9$，$1\\le k\\le 14$，$0\\le a<k$。\n\n详细数据范围如下表：\n\n| Subtask 编号 | $n$ | $k$ | 特殊性质 | 分数 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $\\le 18$ | $\\le 14$ | 无 | $1$ |\n| $2$ | $\\le 2000$ | $\\le 10$ | 无 | $8$ |\n| $3$ | $\\le 10^9$ | $\\le 14$ | $a=0$ | $7$ |\n| $4$ | $\\le 10^9$ | $\\le 7$ | 无 | $12$ |\n| $5$ | $\\le 10^9$ | $\\le 8$ | 无 | $12$ |\n| $6$ | $\\le 10^9$ | $\\le 9$ | 无 | $12$ |\n| $7$ | $\\le 10^9$ | $\\le 11$ | 无 | $12$ |\n| $8$ | $\\le 10^9$ | $\\le 12$ | 无 | $12$ |\n| $9$ | $\\le 10^9$ | $\\le 13$ | 无 | $12$ |\n| $10$ | $\\le 10^9$ | $\\le 14$ | 无 | $12$ |", "locale": "zh-CN", "translations": {"en": {"title": "[RC-05] 01 Sequence", "background": "", "description": "There is a $01$ sequence of length $n$. In any consecutive substring of length $k$, there are either $a$ zeros or $a+1$ zeros.\n\nFind the number of possible sequences. The answer can be very large, so output it modulo $998244353$.", "inputFormat": "**To reduce the number of test points, this problem contains multiple test cases within a single test point. The time limit has been adjusted accordingly based on the number of test cases.**\n\nThe first line contains the number of test cases $T$.\n\nFor each test case, one line contains three integers: $n, k, a$.", "outputFormat": "For each test case, output a non-negative integer, which is the number of possible sequences modulo $998244353$.", "hint": "**This problem uses bundled judging.**\n\nFor all data, $1\\le T\\le 5$, $1\\le k\\le n\\le 10^9$, $1\\le k\\le 14$, $0\\le a<k$.\n\nThe detailed Constraints are shown in the table below:\n\n| Subtask ID | $n$ | $k$ | Special Property | Score |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $\\le 18$ | $\\le 14$ | None | $1$ |\n| $2$ | $\\le 2000$ | $\\le 10$ | None | $8$ |\n| $3$ | $\\le 10^9$ | $\\le 14$ | $a=0$ | $7$ |\n| $4$ | $\\le 10^9$ | $\\le 7$ | None | $12$ |\n| $5$ | $\\le 10^9$ | $\\le 8$ | None | $12$ |\n| $6$ | $\\le 10^9$ | $\\le 9$ | None | $12$ |\n| $7$ | $\\le 10^9$ | $\\le 11$ | None | $12$ |\n| $8$ | $\\le 10^9$ | $\\le 12$ | None | $12$ |\n| $9$ | $\\le 10^9$ | $\\le 13$ | None | $12$ |\n| $10$ | $\\le 10^9$ | $\\le 14$ | None | $12$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[RC-05] 01 序列", "background": "", "description": "有一个长度为 $n$ 的 $01$ 序列，它的任意一个长为 $k$ 的连续子串中都有 $a$ 个 $0$ 或 $a+1$ 个 $0$。\n\n求可能的序列数。答案很大，请输出其模 $998244353$ 的值。", "inputFormat": "**为了减小测试点个数，本题单个测试点内有多组数据。时间限制已经根据数据组数作了相应调整。**\n\n输入第一行是数据组数 $T$。\n\n每组数据中，输入一行三个整数：$n,k,a$。", "outputFormat": "对于每组数据，输出一个非负整数，为可能的序列数模 $998244353$ 的值。", "hint": "**本题捆绑测试。**\n\n对于所有数据，$1\\le T\\le 5$，$1\\le k\\le n\\le 10^9$，$1\\le k\\le 14$，$0\\le a<k$。\n\n详细数据范围如下表：\n\n| Subtask 编号 | $n$ | $k$ | 特殊性质 | 分数 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $\\le 18$ | $\\le 14$ | 无 | $1$ |\n| $2$ | $\\le 2000$ | $\\le 10$ | 无 | $8$ |\n| $3$ | $\\le 10^9$ | $\\le 14$ | $a=0$ | $7$ |\n| $4$ | $\\le 10^9$ | $\\le 7$ | 无 | $12$ |\n| $5$ | $\\le 10^9$ | $\\le 8$ | 无 | $12$ |\n| $6$ | $\\le 10^9$ | $\\le 9$ | 无 | $12$ |\n| $7$ | $\\le 10^9$ | $\\le 11$ | 无 | $12$ |\n| $8$ | $\\le 10^9$ | $\\le 12$ | 无 | $12$ |\n| $9$ | $\\le 10^9$ | $\\le 13$ | 无 | $12$ |\n| $10$ | $\\le 10^9$ | $\\le 14$ | 无 | $12$ |", "locale": "zh-CN"}}}
{"pid": "P7821", "type": "P", "difficulty": 3, "samples": [["5\n5 3 0 2 5 2\n5 5 2 3 0 5\n3 100 1 2 6 6\n5 9 0 2 3 9\n4 5 0 5 1 3", "13 7\n14 10\n201 6\n29 0\n15 5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "O2优化"], "title": "「RdOI R3」race", "background": "", "description": "某足球赛事上，A 国队和 B 国队共进行了 $n$ 场比赛。比赛采用积分赛制，胜者队伍得 $a$ 分，败者队伍得 $b$ 分，若打平则双方各得 $c$ 分。现已知 A 国队总进球数 $d$ 球，B 国队总进球数 $e$ 球，求 A 国队的最大可能得分和最小可能得分。", "inputFormat": "**本题含有多组数据。**\n\n第一行一个整数 $T$，表示数据组数。\n\n对于每组数据，输入一行六个整数 $n,a,b,c,d,e$。", "outputFormat": "对于每组数据，输出一行两个整数，用空格分隔，表示最大可能得分和最小可能得分。", "hint": "### 样例解释\n\n为便于理解样例，现给出前三组数据的样例解释：\n\n| 数据编号 | 最大得分方案                    | 最小得分方案                    |\n| -------- | ------------------------------- | ------------------------------- |\n| $1$      | $(1,0),(0,0),(2,1),(0,0),(2,1)$ | $(0,0),(5,0),(0,1),(0,0),(0,1)$ |\n| $2$      | $(0,0),(0,5),(0,0),(0,0),(0,0)$ | $(0,1),(0,1),(0,1),(0,1),(0,1)$ |\n| $3$      | $(3,2),(0,2),(3,2)$             | $(6,6),(0,0),(0,0)$             |\n\n表格中的 $(x_1,y_1),(x_2,y_2),\\cdots,(x_n,y_n)$ 表示第 $1$ 场比分为 $x_1:y_1$，第 $2$ 场比分为 $x_2:y_2$，以此类推。\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n对于所有数据，$1\\le T\\le 10^5$，$1\\le n \\le 10^9$\n，$0\\le d,e\\le10^9$，$0\\le b\\le c \\le a\\le10^9$。\n\n| subtask | 分值 | 特殊限制             | subtask 依赖 |\n| ------- | ---- | -------------------- | ------------ |\n| $1$     | $10$ | $e=0$                | 无           |\n| $2$     | $20$ | $n,d,e\\le 5,T\\le100$ | 无           |\n| $3$     | $20$ | $n\\le 5$             | $2$          |\n| $4$     | $50$ | 无                   | $1,3$        |\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「RdOI R3」race", "background": "", "description": "某足球赛事上，A 国队和 B 国队共进行了 $n$ 场比赛。比赛采用积分赛制，胜者队伍得 $a$ 分，败者队伍得 $b$ 分，若打平则双方各得 $c$ 分。现已知 A 国队总进球数 $d$ 球，B 国队总进球数 $e$ 球，求 A 国队的最大可能得分和最小可能得分。", "inputFormat": "**本题含有多组数据。**\n\n第一行一个整数 $T$，表示数据组数。\n\n对于每组数据，输入一行六个整数 $n,a,b,c,d,e$。", "outputFormat": "对于每组数据，输出一行两个整数，用空格分隔，表示最大可能得分和最小可能得分。", "hint": "### 样例解释\n\n为便于理解样例，现给出前三组数据的样例解释：\n\n| 数据编号 | 最大得分方案                    | 最小得分方案                    |\n| -------- | ------------------------------- | ------------------------------- |\n| $1$      | $(1,0),(0,0),(2,1),(0,0),(2,1)$ | $(0,0),(5,0),(0,1),(0,0),(0,1)$ |\n| $2$      | $(0,0),(0,5),(0,0),(0,0),(0,0)$ | $(0,1),(0,1),(0,1),(0,1),(0,1)$ |\n| $3$      | $(3,2),(0,2),(3,2)$             | $(6,6),(0,0),(0,0)$             |\n\n表格中的 $(x_1,y_1),(x_2,y_2),\\cdots,(x_n,y_n)$ 表示第 $1$ 场比分为 $x_1:y_1$，第 $2$ 场比分为 $x_2:y_2$，以此类推。\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n对于所有数据，$1\\le T\\le 10^5$，$1\\le n \\le 10^9$\n，$0\\le d,e\\le10^9$，$0\\le b\\le c \\le a\\le10^9$。\n\n| subtask | 分值 | 特殊限制             | subtask 依赖 |\n| ------- | ---- | -------------------- | ------------ |\n| $1$     | $10$ | $e=0$                | 无           |\n| $2$     | $20$ | $n,d,e\\le 5,T\\le100$ | 无           |\n| $3$     | $20$ | $n\\le 5$             | $2$          |\n| $4$     | $50$ | 无                   | $1,3$        |\n\n", "locale": "zh-CN"}}}
{"pid": "P7822", "type": "P", "difficulty": 4, "samples": [["3 2\n1 2", "4"], ["2 1\n1", "0"], ["8 5\n4 2 3 4 2", "356314"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "O2优化"], "title": "「RdOI R3」学习算法", "background": "暑假中，MLE 决定学习一下 OI 算法。\n", "description": "暑假一共有 $n$ 天，我们假设 MLE 每天都有足够的时间学 OI。MLE 列出了可供选择的 $m$ 个算法。MLE 每天只能且必须学习一个算法。\n\n而且，MLE 长时间学同一种算法会厌倦，所以每一种算法不能连续学习太多天，第 $i$ 种算法最多可以连续学习 $a_i$ 天。**MLE 没有必要学习全部的算法。**\n\nMLE 想知道，自己有多少种不同的学习安排来度过这 $n$ 天。两种学习安排不同仅当这两种安排中有至少一天学习的算法不同。因为方法可能过多，你只需要输出方案数对 $10^9+7$ 取模即可。", "inputFormat": "第一行为两个整数 $n,m$。  \n第二行 $m$ 个整数 $a_1,a_2,\\cdots,a_m$。", "outputFormat": "输出一行一个整数，方案数对 $10^9+7$ 取模的结果。", "hint": "### 样例解释\n\n#### 样例 \\#1\n\n第一种算法最多连续学习一天，第二种最多连续学习两天。故共有如下四种学习方式：\n\n- $1,2,2$。\n- $2,1,2$。\n- $2,2,1$。\n- $1,2,1$。\n\n#### 样例 \\#2\n\n由于唯一的一种算法最多只能连续学习一天，所以没有合法的方案可以度过 $2$ 天。\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试，若无特殊说明，测试点的内存限制为 256MB。**\n\n对于所有数据，$1\\le a_i \\le n\\le 7 \\times 10^3$，$1\\le m \\le 7\\times 10^3$。\n\n| subtask | 分值 | $n,m\\le$ | 特殊限制            |\n| ------- | ---- | -------- | ------------------- |\n| $1$     | $5$  | $5$      | 无                 |\n| $2$     | $10$ | $100$    | 无                 |\n| $3$     | $15$ | $500$    | 无                 |\n| $4$     | $20$ | $7\\times 10^3$   | $a_i=1$             |\n| $5$     | $20$ | $7\\times 10^3$   | 内存限制为 $500$ MB |\n| $6$     | $30$ | $7\\times 10^3$   | 无                 |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「RdOI R3」学习算法", "background": "暑假中，MLE 决定学习一下 OI 算法。\n", "description": "暑假一共有 $n$ 天，我们假设 MLE 每天都有足够的时间学 OI。MLE 列出了可供选择的 $m$ 个算法。MLE 每天只能且必须学习一个算法。\n\n而且，MLE 长时间学同一种算法会厌倦，所以每一种算法不能连续学习太多天，第 $i$ 种算法最多可以连续学习 $a_i$ 天。**MLE 没有必要学习全部的算法。**\n\nMLE 想知道，自己有多少种不同的学习安排来度过这 $n$ 天。两种学习安排不同仅当这两种安排中有至少一天学习的算法不同。因为方法可能过多，你只需要输出方案数对 $10^9+7$ 取模即可。", "inputFormat": "第一行为两个整数 $n,m$。  \n第二行 $m$ 个整数 $a_1,a_2,\\cdots,a_m$。", "outputFormat": "输出一行一个整数，方案数对 $10^9+7$ 取模的结果。", "hint": "### 样例解释\n\n#### 样例 \\#1\n\n第一种算法最多连续学习一天，第二种最多连续学习两天。故共有如下四种学习方式：\n\n- $1,2,2$。\n- $2,1,2$。\n- $2,2,1$。\n- $1,2,1$。\n\n#### 样例 \\#2\n\n由于唯一的一种算法最多只能连续学习一天，所以没有合法的方案可以度过 $2$ 天。\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试，若无特殊说明，测试点的内存限制为 256MB。**\n\n对于所有数据，$1\\le a_i \\le n\\le 7 \\times 10^3$，$1\\le m \\le 7\\times 10^3$。\n\n| subtask | 分值 | $n,m\\le$ | 特殊限制            |\n| ------- | ---- | -------- | ------------------- |\n| $1$     | $5$  | $5$      | 无                 |\n| $2$     | $10$ | $100$    | 无                 |\n| $3$     | $15$ | $500$    | 无                 |\n| $4$     | $20$ | $7\\times 10^3$   | $a_i=1$             |\n| $5$     | $20$ | $7\\times 10^3$   | 内存限制为 $500$ MB |\n| $6$     | $30$ | $7\\times 10^3$   | 无                 |", "locale": "zh-CN"}}}
{"pid": "P7823", "type": "P", "difficulty": 6, "samples": [["6\n1 1 4 5 1 4", "7"], ["5\n4 1 9 2 3", "12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["O2优化"], "title": "「RdOI R3」闹钟", "background": "", "description": "你有一个闹钟，闹钟的定时可以用两个变量 $a_1,a_2$ 表示，变量的初始值皆为 $0$。把一个变量从 $x$ 调整至 $y$ 需要 $|x-y|$ 的代价。\n\n接下来给出 $n$ 个数 $k_1,k_2,\\cdots,k_n$。对于第 $i$ 天，你都需要通过调整变量的值，使得两个变量中**至少**有一个等于 $k_i$。求最小代价。", "inputFormat": "第一行一个整数 $n$。  \n第二行 $n$ 个整数 $k_1,k_2,\\cdots,k_n$。", "outputFormat": "一行一个整数，表示最小代价。", "hint": "### 样例解释\n\n样例解释一：  \n第一天：$a=\\{1,0\\}$。  \n第二天：$a=\\{1,0\\}$。  \n第三天：$a=\\{4,0\\}$。  \n第四天：$a=\\{5,0\\}$。  \n第五天：$a=\\{5,1\\}$。  \n第六天：$a=\\{4,1\\}$。  \n\n样例解释二：  \n第一天：$a=\\{4,0\\}$。  \n第二天：$a=\\{4,1\\}$。  \n第三天：$a=\\{9,1\\}$。  \n第四天：$a=\\{9,2\\}$。  \n第五天：$a=\\{9,3\\}$。 \n\n---\n\n### 数据范围\n\n|数据编号|$n\\le$|特殊性质|\n|:-:|:-:|:-:|\n|$1$|$10$|无|\n|$2$|$10^3$|$k_i\\le100$|\n|$3\\sim4$|$10^3$|无|\n|$5\\sim7$|$10^5$|$k_i\\le100$|\n|$8\\sim10$|$10^5$|无|\n\n另外，为了卡掉一些错误做法，本题添加了若干 hack 测试点。hack 测试点的数据满足 $n\\le10$ 且 $k_i\\le 100$。若你的程序没有通过至少一个 hack 测试点，则此题分数记为 $0$ 分。\n\n对于 $100\\%$ 的数据，$1\\le n\\le10^5,1\\le k_i\\le10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「RdOI R3」闹钟", "background": "", "description": "你有一个闹钟，闹钟的定时可以用两个变量 $a_1,a_2$ 表示，变量的初始值皆为 $0$。把一个变量从 $x$ 调整至 $y$ 需要 $|x-y|$ 的代价。\n\n接下来给出 $n$ 个数 $k_1,k_2,\\cdots,k_n$。对于第 $i$ 天，你都需要通过调整变量的值，使得两个变量中**至少**有一个等于 $k_i$。求最小代价。", "inputFormat": "第一行一个整数 $n$。  \n第二行 $n$ 个整数 $k_1,k_2,\\cdots,k_n$。", "outputFormat": "一行一个整数，表示最小代价。", "hint": "### 样例解释\n\n样例解释一：  \n第一天：$a=\\{1,0\\}$。  \n第二天：$a=\\{1,0\\}$。  \n第三天：$a=\\{4,0\\}$。  \n第四天：$a=\\{5,0\\}$。  \n第五天：$a=\\{5,1\\}$。  \n第六天：$a=\\{4,1\\}$。  \n\n样例解释二：  \n第一天：$a=\\{4,0\\}$。  \n第二天：$a=\\{4,1\\}$。  \n第三天：$a=\\{9,1\\}$。  \n第四天：$a=\\{9,2\\}$。  \n第五天：$a=\\{9,3\\}$。 \n\n---\n\n### 数据范围\n\n|数据编号|$n\\le$|特殊性质|\n|:-:|:-:|:-:|\n|$1$|$10$|无|\n|$2$|$10^3$|$k_i\\le100$|\n|$3\\sim4$|$10^3$|无|\n|$5\\sim7$|$10^5$|$k_i\\le100$|\n|$8\\sim10$|$10^5$|无|\n\n另外，为了卡掉一些错误做法，本题添加了若干 hack 测试点。hack 测试点的数据满足 $n\\le10$ 且 $k_i\\le 100$。若你的程序没有通过至少一个 hack 测试点，则此题分数记为 $0$ 分。\n\n对于 $100\\%$ 的数据，$1\\le n\\le10^5,1\\le k_i\\le10^9$。", "locale": "zh-CN"}}}
{"pid": "P7824", "type": "P", "difficulty": 6, "samples": [["4 12\n\n\n\n\n\n\n\n\n\n\n\n\n\n1 0 1 1 1 1 1 1 1 0 1 1\n", "\n1 1 1\n1 1 2\n1 1 3\n1 1 4\n1 1 1\n1 1 2\n1 1 3\n1 1 4\n1 1 1\n1 1 2\n1 1 3\n1 1 4\n2\n\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["交互题", "Special Judge", "O2优化"], "title": "「RdOI R3」毒水", "background": "", "description": "**这是一道 IO 交互题。**\n\n现在你面前有 $n$ 瓶水，从 $1\\sim n$ 编号，其中有 $1$ 瓶水有毒，你可以用一些小白鼠来进行判断。\n\n但是你找的小白鼠中**有且仅有**一只**变异鼠**，**如果它喝的水中有毒水，那么它不会死亡。否则它会在 $59$ 秒内死亡。其它小白鼠如果喝了毒水将在 $59$ 秒内死亡，否则不会死亡**。\n\n你需要在一分钟内找出这瓶毒水，因为测试已经花了 $59$ 秒，所以你的代码只能运行 $1$ 秒。\n\n### 交互方式\n\n首先你需要从标准输入读取两个整数 $n$，$maxk$，表示水的数量，以及你最多能找到的小白鼠个数。\n\n若你需要 $k$ 只小白鼠，你需要向标准输出打印 $k+1$ 行，除了最后一行，每一行的格式为：`1 m B1 B2 ... Bm`，表示你找到一只小白鼠并让它喝 $B_1$ 号，$B_2$ 号，$\\cdots$，$B_m$ 号这 $m$ 瓶中的水。你需要在最后写上一行：`2`，随后清空缓冲区，表示你不需要更多的小白鼠了。\n\n下面是一些语言的刷新缓冲区操作：\n\n- C++：`fflush(stdout)` 或 `cout.flush()`。\n- C: `fflush(stdout)`。\n- Java: `System.out.flush()`。\n- Python: `stdout.flush()`。\n- Pascal: `flush(output)`。\n- 其他语言：请参考对应语言的帮助文档。\n\n当然，如果 $k>maxk$，交互库会返回 `WA`、`RE`、`UKE` 或 `TLE`，同时该测试点不得分。\n\n然后你需要从标准输入读取 $k$ 个整数 $R_1,R_2,\\cdots,R_k;R_i\\in\\{0,1\\}$。若 $R_i=0$ 代表第 $i$ 号小白鼠已死亡，否则代表第 $i$ 号小白鼠仍存活。\n\n最后你需要从标准输出打印一个整数，表示毒水的编号。", "inputFormat": "见**交互方式**。", "outputFormat": "见**交互方式**。", "hint": "### 样例说明\n\n毒水的编号为 $2$，且第 $2$ 次和第 $10$ 次均为让小白鼠喝下 $2$ 号毒水，故这两次操作返回的结果为 $0$。其他操作由于让小白鼠喝的不是毒水，返回的结果为 $1$。\n\n**样例仅为理解交互方式使用，可能不符合逻辑。**\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试。**  \n\n**注意：本题不存在一个 subtask 包含其他所有 subtask**。\n\n| subtask | 分值 | $n$             | $maxk\\ge$ |\n| ------- | ---- | --------------- | ------- |\n| $1$     | $1$  | $=1$            | $0$     |\n| $2$     | $9$  | $\\le 1000$      | $3000$  |\n| $3$     | $20$ | $\\le 1000$      | $30$    |\n| $4$     | $30$ | $8\\le n \\le 16$ | $7$     |\n| $5$     | $40$ | $\\le 1000$      | $15$    |\n\n---\n\n### 注意\n\n只有你向交互器发送 $2$ 操作时，交互器才会将你先前的 $1$ 操作的答案告诉你。也就是说，你不能在执行一次 $1$ 操作后立刻得到这次操作的返回结果。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「RdOI R3」毒水", "background": "", "description": "**这是一道 IO 交互题。**\n\n现在你面前有 $n$ 瓶水，从 $1\\sim n$ 编号，其中有 $1$ 瓶水有毒，你可以用一些小白鼠来进行判断。\n\n但是你找的小白鼠中**有且仅有**一只**变异鼠**，**如果它喝的水中有毒水，那么它不会死亡。否则它会在 $59$ 秒内死亡。其它小白鼠如果喝了毒水将在 $59$ 秒内死亡，否则不会死亡**。\n\n你需要在一分钟内找出这瓶毒水，因为测试已经花了 $59$ 秒，所以你的代码只能运行 $1$ 秒。\n\n### 交互方式\n\n首先你需要从标准输入读取两个整数 $n$，$maxk$，表示水的数量，以及你最多能找到的小白鼠个数。\n\n若你需要 $k$ 只小白鼠，你需要向标准输出打印 $k+1$ 行，除了最后一行，每一行的格式为：`1 m B1 B2 ... Bm`，表示你找到一只小白鼠并让它喝 $B_1$ 号，$B_2$ 号，$\\cdots$，$B_m$ 号这 $m$ 瓶中的水。你需要在最后写上一行：`2`，随后清空缓冲区，表示你不需要更多的小白鼠了。\n\n下面是一些语言的刷新缓冲区操作：\n\n- C++：`fflush(stdout)` 或 `cout.flush()`。\n- C: `fflush(stdout)`。\n- Java: `System.out.flush()`。\n- Python: `stdout.flush()`。\n- Pascal: `flush(output)`。\n- 其他语言：请参考对应语言的帮助文档。\n\n当然，如果 $k>maxk$，交互库会返回 `WA`、`RE`、`UKE` 或 `TLE`，同时该测试点不得分。\n\n然后你需要从标准输入读取 $k$ 个整数 $R_1,R_2,\\cdots,R_k;R_i\\in\\{0,1\\}$。若 $R_i=0$ 代表第 $i$ 号小白鼠已死亡，否则代表第 $i$ 号小白鼠仍存活。\n\n最后你需要从标准输出打印一个整数，表示毒水的编号。", "inputFormat": "见**交互方式**。", "outputFormat": "见**交互方式**。", "hint": "### 样例说明\n\n毒水的编号为 $2$，且第 $2$ 次和第 $10$ 次均为让小白鼠喝下 $2$ 号毒水，故这两次操作返回的结果为 $0$。其他操作由于让小白鼠喝的不是毒水，返回的结果为 $1$。\n\n**样例仅为理解交互方式使用，可能不符合逻辑。**\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试。**  \n\n**注意：本题不存在一个 subtask 包含其他所有 subtask**。\n\n| subtask | 分值 | $n$             | $maxk\\ge$ |\n| ------- | ---- | --------------- | ------- |\n| $1$     | $1$  | $=1$            | $0$     |\n| $2$     | $9$  | $\\le 1000$      | $3000$  |\n| $3$     | $20$ | $\\le 1000$      | $30$    |\n| $4$     | $30$ | $8\\le n \\le 16$ | $7$     |\n| $5$     | $40$ | $\\le 1000$      | $15$    |\n\n---\n\n### 注意\n\n只有你向交互器发送 $2$ 操作时，交互器才会将你先前的 $1$ 操作的答案告诉你。也就是说，你不能在执行一次 $1$ 操作后立刻得到这次操作的返回结果。", "locale": "zh-CN"}}}
{"pid": "P7825", "type": "P", "difficulty": 6, "samples": [["5 7\n0 1 1 0 1\n0 1 2\n2 1 5\n3 1 5 3\n2 1 3\n2 2 3\n3 1 5 3\n4 1 5", "2\n3\n5"], ["10 9\n0 1 1 0 1 1 0 1 1 0\n3 1 5 3\n4 2 9\n4 1 4\n3 4 10 4\n3 4 10 3\n4 1 5\n4 9 10\n4 4 6\n4 5 9", "1\n3\n2\n0\n1\n3\n2\n2\n3"], ["10 10\n0 0 0 1 0 0 0 1 0 0\n2 7 10\n4 6 9\n3 2 9 7\n1 6 7\n4 10 10\n1 1 3\n3 4 7 3\n4 2 8\n1 6 9\n4 5 6", "4\n0\n1\n1\n3\n2"]], "limits": {"time": [300, 300, 300, 300, 300, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "树套树"], "title": "「RdOI R3」VSQ", "background": "", "description": "设 $x$ 为一个长度不小于 $2$ 的 $01$ 串，如果 $x$ 的所有长度为 $2$ 的子串的异或和均为 $1$，则 $x$ 为一个「VS 串」。\n\n你需要维护一个长度为 $n$ 的 $01$ 串 $a$，支持以下操作：\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|} \\hline\n\\textbf{格式} & \\textbf{说明} \\cr\\hline\n\\texttt{0 l r} & \\text{将区间 }[l,r]\\text{ 填充为 }0 \\cr\\hline\n\\texttt{1 l r}& \\text{将区间 }[l,r]\\text{ 填充为 }1 \\cr\\hline\n\\texttt{2 l r}& \\text{将区间 }[l,r]\\text{ 中的每个数取反，即 }1\\text{ 变 } 0\\text{，}0\\text{ 变 }1 \\cr\\hline\n\\texttt{3 l r k} & \\text{查询}[l,r]\\text{ 区间中有多少个长度为 }k\\text{ 的子串是「VS 串」} \\cr\\hline\n\\texttt{4 l r} & {\\def\\arraystretch{1}\\begin{array}{c}\n\\text{查询 }[l,r]\\text{ 区间内最长的「VS 串」的长度，}\\\\\\text{如果区间内不存在这样的子串则输出 }1 \\end{array}} \\cr\\hline\n\\end{array}\n$$\n", "inputFormat": "第一行两个整数 $n,m$，表示 $01$ 串长度与操作个数。  \n第二行 $n$ 个整数，表示 $a_1,a_2,\\cdots,a_n$。  \n接下来 $m$ 行，每行三或四个整数 $op, l, r(,k)$，表示一次操作。", "outputFormat": "对于每个查询操作，输出一行一个整数，表示其对应的答案。", "hint": "### 样例解释\n\n#### 样例 #1\n\n|操作次数|输入内容|零一串|答案|\n|-|-|-|-|\n|$0$|$/$|$01101$|$/$|\n|$1$|`0 1 2`|$00101$|$/$|\n|$2$|`2 1 5`|$11010$|$/$|\n|$3$|`3 1 5 3`|$11010$|$2$|\n|$4$|`2 1 3`|$00110$|$/$|\n|$5$|`2 2 3`|$01010$|$/$|\n|$6$|`3 1 5 3`|$01010$|$3$|\n|$7$|`4 1 5`|$01010$|$5$|\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n对于所有数据，有 $0\\le op \\le 4$，$1 \\le l \\le r \\le n\\le3\\times10^5$，$3 \\le k \\le n$，$1\\le m \\le 5 \\times 10^5$。\n\n| subtask | 分值 | $4\\le n,m \\le$ |时间限制| 特殊性质                    |\n| ------- | ---- | -------------- |-------| --------------------------- |\n| $1$     | $10$ | $10^3$         |$300$ ms| 无                          |\n| $2$     | $15$ | $10^5$         |$1000$ ms| 没有 $0,1,2$ 操作           |\n| $3$     | $15$ | $10^5$         |$2000$ ms| 没有 $3$ 操作               |\n| $4$     | $15$ | $10^5$         |$2000$ ms| $op,l,r,a_i$ 在其数据范围内等概率随机生成 |\n| $5$     | $15$ | $10^5$         |$3000$ ms| $k=3$                       |\n| $6$     | $10$ | $10^5$         |$3000$ ms| 无                          |\n| $7$     | $20$ | $5\\times10^5$         |$2000$ ms| $n\\le3\\times10^5$                          |   \n\n本题可能略微卡常。  \n这样设计时间限制是为了让测试点总时间限制在 120s 以内并且卡掉错误算法。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「RdOI R3」VSQ", "background": "", "description": "设 $x$ 为一个长度不小于 $2$ 的 $01$ 串，如果 $x$ 的所有长度为 $2$ 的子串的异或和均为 $1$，则 $x$ 为一个「VS 串」。\n\n你需要维护一个长度为 $n$ 的 $01$ 串 $a$，支持以下操作：\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|} \\hline\n\\textbf{格式} & \\textbf{说明} \\cr\\hline\n\\texttt{0 l r} & \\text{将区间 }[l,r]\\text{ 填充为 }0 \\cr\\hline\n\\texttt{1 l r}& \\text{将区间 }[l,r]\\text{ 填充为 }1 \\cr\\hline\n\\texttt{2 l r}& \\text{将区间 }[l,r]\\text{ 中的每个数取反，即 }1\\text{ 变 } 0\\text{，}0\\text{ 变 }1 \\cr\\hline\n\\texttt{3 l r k} & \\text{查询}[l,r]\\text{ 区间中有多少个长度为 }k\\text{ 的子串是「VS 串」} \\cr\\hline\n\\texttt{4 l r} & {\\def\\arraystretch{1}\\begin{array}{c}\n\\text{查询 }[l,r]\\text{ 区间内最长的「VS 串」的长度，}\\\\\\text{如果区间内不存在这样的子串则输出 }1 \\end{array}} \\cr\\hline\n\\end{array}\n$$\n", "inputFormat": "第一行两个整数 $n,m$，表示 $01$ 串长度与操作个数。  \n第二行 $n$ 个整数，表示 $a_1,a_2,\\cdots,a_n$。  \n接下来 $m$ 行，每行三或四个整数 $op, l, r(,k)$，表示一次操作。", "outputFormat": "对于每个查询操作，输出一行一个整数，表示其对应的答案。", "hint": "### 样例解释\n\n#### 样例 #1\n\n|操作次数|输入内容|零一串|答案|\n|-|-|-|-|\n|$0$|$/$|$01101$|$/$|\n|$1$|`0 1 2`|$00101$|$/$|\n|$2$|`2 1 5`|$11010$|$/$|\n|$3$|`3 1 5 3`|$11010$|$2$|\n|$4$|`2 1 3`|$00110$|$/$|\n|$5$|`2 2 3`|$01010$|$/$|\n|$6$|`3 1 5 3`|$01010$|$3$|\n|$7$|`4 1 5`|$01010$|$5$|\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n对于所有数据，有 $0\\le op \\le 4$，$1 \\le l \\le r \\le n\\le3\\times10^5$，$3 \\le k \\le n$，$1\\le m \\le 5 \\times 10^5$。\n\n| subtask | 分值 | $4\\le n,m \\le$ |时间限制| 特殊性质                    |\n| ------- | ---- | -------------- |-------| --------------------------- |\n| $1$     | $10$ | $10^3$         |$300$ ms| 无                          |\n| $2$     | $15$ | $10^5$         |$1000$ ms| 没有 $0,1,2$ 操作           |\n| $3$     | $15$ | $10^5$         |$2000$ ms| 没有 $3$ 操作               |\n| $4$     | $15$ | $10^5$         |$2000$ ms| $op,l,r,a_i$ 在其数据范围内等概率随机生成 |\n| $5$     | $15$ | $10^5$         |$3000$ ms| $k=3$                       |\n| $6$     | $10$ | $10^5$         |$3000$ ms| 无                          |\n| $7$     | $20$ | $5\\times10^5$         |$2000$ ms| $n\\le3\\times10^5$                          |   \n\n本题可能略微卡常。  \n这样设计时间限制是为了让测试点总时间限制在 120s 以内并且卡掉错误算法。", "locale": "zh-CN"}}}
{"pid": "P7826", "type": "P", "difficulty": 6, "samples": [["10 10 500 1\n3 2 1 2 1 3 2 1 3 4\n1 4\n7 8\n3 6\n8 10\n2 3\n2 5\n8 9\n7 2\n2 1\n4 1\n1 3 1\n2 1 2\n4 1\n4 3\n4 6\n1 4 1\n3 7\n1 5 1\n4 5\n", "10\n5\n6\n4\n12\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["树形数据结构", "线段树", "O2优化", "分块", "位运算"], "title": "「RdOI R3」RBT", "background": "", "description": "你有一棵以 $1$ 为根，编号为 $1\\sim n$ 的有根树，第 $i$ 号节点上有一个整数权值 $a_i$。同时每一个点都被染上了红色或蓝色。初始所有点全是红色点。你需要维护这棵树，进行 $q$ 次操作。操作分若干种，具体格式如下：\n\n- `1 x v` ：使 $x$ 节点的子树中的每个节点的权值增加 $v$ 并对 $p$ 取模。\n- `2 x v`：将 $a_x$ 赋值为 $v$。**注意不是赋值整棵子树。**\n- `3 x`：将 $x$ 号点染成蓝色，设 $j$ 节点为 $x$ 号节点在它的**红色**兄弟节点中**编号**（不是权值）排名的前驱，将 $x$ 节点连接父亲的边删除。然后将 $x$ 节点作为儿子节点接到 $j$ 节点上，如果 $x$ 节点没有红色兄弟节点或 $x$ 节点的红色兄弟节点的编号均比 $x$ 大则什么都不做。\n- `4 x`：设 $S$ 为 $x$ 的子树中的节点的权值中出现次数为奇数的数组成的集合。输出集合中的每个数的 $k$ 次方之和，对 $998244353$ 取模。即 $(\\sum_{z\\in S}z^k)\\bmod 998244353$。\n\n特别的，数据保证每个点只能被执行 $3$ 操作至多 $1$ 次。也就是说不会出现对一个蓝色点进行 $3$ 操作的情况。", "inputFormat": "第一行四个整数 $n,q,p,k$。  \n第二行 $n$ 个整数，代表初始的 $a_1,a_2,\\cdots,a_n$。  \n接下来 $n-1$ 行，每行两个整数 $f,t$。表示一条连接 $f \\leftrightarrow t$ 的双向树边。  \n接下来 $q$ 行，每行两个或三个整数 $op,x(,v)$。", "outputFormat": "对于每个询问操作，输出一行一个整数表示答案。", "hint": "### 样例解释\n\n#### 样例 \\#1\n\n- 询问 `4 1`，子树中点的权值分别为 $3,2,1,2,1,3,2,1,3,4$，$S$ 集合为 $\\{1,2,3,4\\}$，故答案为 $10$。\n- 修改 `1 3 1`，树中各点权值变为 $3,2,2,2,1,4,2,1,3,4$。\n- 修改 `2 1 2`，树中各点权值变为 $2,2,2,2,1,4,2,1,3,4$。\n- 询问 `4 1`，子树中点的权值分别为 $2,2,2,2,1,4,2,1,3,4$，$S$ 集合为 $\\{2,3\\}$，故答案为 $5$。\n- 询问 `4 3`，子树中点的编号为 $3,6$，权值分别为 $2,4$，$S$ 集合为 $\\{2,4\\}$，故答案为 $6$。\n- 询问 `4 6`，由于这是一个叶子节点，子树中点的权值为它本身的权值 $4$，$S$ 集合为 $\\{4\\}$，故答案为 $4$。\n- 修改 `1 4 1`，树中各点权值变为 $2,2,2,3,1,4,2,1,3,4$。\n- 修改 `3 7`，将 $7$ 涂成蓝色，删除树中的边 $2\\leftrightarrow 7$，并将 $7$ 作为儿子节点接到 $5$ 上。\n- 修改  `1 5 1`，树中各点权值变为 $2,2,2,3,2,4,3,2,4,5$。\n- 询问 `4 5`，子树中各点编号为 $5,7,8,9,10$，权值分别为 $2,3,2,4,5$，$S$ 集合为 $\\{3,4,5\\}$，故答案为 $12$。\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n对于所有数据，$1\\le x\\le n\\le 10^5$，$1\\le q \\le 10^5$，$0 \\le a_i, v < p \\le 500$，$p\\ne 0$，$0\\le k \\le 10^9$。\n\n| subtask | 分值 | 特殊限制                                    |\n| ------- | ---- | ------------------------------------------- |\n| $1$     | $10$ | $op,a_i,x,v$ 和初始树的形态均等概率随机生成 |\n| $2$     | $90$ | 无                                          |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「RdOI R3」RBT", "background": "", "description": "你有一棵以 $1$ 为根，编号为 $1\\sim n$ 的有根树，第 $i$ 号节点上有一个整数权值 $a_i$。同时每一个点都被染上了红色或蓝色。初始所有点全是红色点。你需要维护这棵树，进行 $q$ 次操作。操作分若干种，具体格式如下：\n\n- `1 x v` ：使 $x$ 节点的子树中的每个节点的权值增加 $v$ 并对 $p$ 取模。\n- `2 x v`：将 $a_x$ 赋值为 $v$。**注意不是赋值整棵子树。**\n- `3 x`：将 $x$ 号点染成蓝色，设 $j$ 节点为 $x$ 号节点在它的**红色**兄弟节点中**编号**（不是权值）排名的前驱，将 $x$ 节点连接父亲的边删除。然后将 $x$ 节点作为儿子节点接到 $j$ 节点上，如果 $x$ 节点没有红色兄弟节点或 $x$ 节点的红色兄弟节点的编号均比 $x$ 大则什么都不做。\n- `4 x`：设 $S$ 为 $x$ 的子树中的节点的权值中出现次数为奇数的数组成的集合。输出集合中的每个数的 $k$ 次方之和，对 $998244353$ 取模。即 $(\\sum_{z\\in S}z^k)\\bmod 998244353$。\n\n特别的，数据保证每个点只能被执行 $3$ 操作至多 $1$ 次。也就是说不会出现对一个蓝色点进行 $3$ 操作的情况。", "inputFormat": "第一行四个整数 $n,q,p,k$。  \n第二行 $n$ 个整数，代表初始的 $a_1,a_2,\\cdots,a_n$。  \n接下来 $n-1$ 行，每行两个整数 $f,t$。表示一条连接 $f \\leftrightarrow t$ 的双向树边。  \n接下来 $q$ 行，每行两个或三个整数 $op,x(,v)$。", "outputFormat": "对于每个询问操作，输出一行一个整数表示答案。", "hint": "### 样例解释\n\n#### 样例 \\#1\n\n- 询问 `4 1`，子树中点的权值分别为 $3,2,1,2,1,3,2,1,3,4$，$S$ 集合为 $\\{1,2,3,4\\}$，故答案为 $10$。\n- 修改 `1 3 1`，树中各点权值变为 $3,2,2,2,1,4,2,1,3,4$。\n- 修改 `2 1 2`，树中各点权值变为 $2,2,2,2,1,4,2,1,3,4$。\n- 询问 `4 1`，子树中点的权值分别为 $2,2,2,2,1,4,2,1,3,4$，$S$ 集合为 $\\{2,3\\}$，故答案为 $5$。\n- 询问 `4 3`，子树中点的编号为 $3,6$，权值分别为 $2,4$，$S$ 集合为 $\\{2,4\\}$，故答案为 $6$。\n- 询问 `4 6`，由于这是一个叶子节点，子树中点的权值为它本身的权值 $4$，$S$ 集合为 $\\{4\\}$，故答案为 $4$。\n- 修改 `1 4 1`，树中各点权值变为 $2,2,2,3,1,4,2,1,3,4$。\n- 修改 `3 7`，将 $7$ 涂成蓝色，删除树中的边 $2\\leftrightarrow 7$，并将 $7$ 作为儿子节点接到 $5$ 上。\n- 修改  `1 5 1`，树中各点权值变为 $2,2,2,3,2,4,3,2,4,5$。\n- 询问 `4 5`，子树中各点编号为 $5,7,8,9,10$，权值分别为 $2,3,2,4,5$，$S$ 集合为 $\\{3,4,5\\}$，故答案为 $12$。\n\n---\n\n### 数据范围\n\n**本题采用捆绑测试。**\n\n对于所有数据，$1\\le x\\le n\\le 10^5$，$1\\le q \\le 10^5$，$0 \\le a_i, v < p \\le 500$，$p\\ne 0$，$0\\le k \\le 10^9$。\n\n| subtask | 分值 | 特殊限制                                    |\n| ------- | ---- | ------------------------------------------- |\n| $1$     | $10$ | $op,a_i,x,v$ 和初始树的形态均等概率随机生成 |\n| $2$     | $90$ | 无                                          |", "locale": "zh-CN"}}}
{"pid": "P7827", "type": "P", "difficulty": 7, "samples": [["123456789\n2147483648", "2147483648\n123456789"], ["2147483647998244353\n9982443532147483647", "10611784189560312322"], ["51\n53\n51\n52\n52\n50\n56\n57\n57", "998244353"], ["233456", "1"], ["2147483647998244353\n9223372036854775808", "2147483647998244353"], ["2147483647998244353\n9982443532147483647\n9223372036854775808\n", "7806477557104029183"], ["4611686018427387904\n", "2147483648"], ["24 32", "8"], ["输入 a，b。输出 a 按位异或 b 的结果。", "mov 0\nxor 1"], ["没有输入，输出数字 6。", "not 1\nlsh 1 62\nrsh 1 61"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["提交答案", "Special Judge", "位运算"], "title": "「RdOI R3 附加」ACP-I", "background": "**注意：这不是一道模拟题，请先完整地读完一遍题面后再开始做题。**\n\n---\n\n### 排行榜\n\n| task | 最短行数 | 达成者      |\n| ---- | -------- | ----------- |\n| 1    | 5        | std         |\n| 2    | 191     | \\_\\_Ultimium\\_\\_      |\n| 3    | 845      | dead_X      |\n| 4    | 24       | 囧仙        |\n| 5    | 77       | dqstz  |\n| 6    | 15078    | 寻逍遥2006       |\n| 7    | 211      | liqingyang        |\n| 8    | 6796     | liqingyang |\n\n如有你的解法行数**严格小于**榜中行数，请联系 @[yzy1](/user/207996) 把你的成绩放到排行榜上。\n\n---\n\n题目 ACP 有两层意思：**A**ncient **C**omputer **P**rogram 和 **A**nother **C**onstruct **P**roblem。\n\n在 1951 年，第 -32 届全国青少年信息学奥林匹克冬令营前夕，小 A 借助时空传输接口（**T**ime **T**ransport **I**nterface）连接了一台 2015 年的计算机，获取到了第 32 届冬令营的题目来练习。\n\n他打开了第三题「未来程序」这道题目：\n\n> 本题是一道提交答案题，一共 10 个测试点。  \n> 对于每个测试点，你会得到一段程序的源代码和这段程序的输入。你要运行这个程序，并保存这个程序的输出。  \n> 遗憾的是这些程序都效率极其低下，无法在比赛的 5 个小时内得到输出。\n\n小 A 想了一下，决定用 1951 年的计算机来试着运行这个题目。但是因为 1951 年的电脑存储空间过小，导致他无法传输题目附件和数据，请你帮助小 A 写 std 造数据。\n", "description": "**这是一道提交答案题。**\n\n小 A 的古董计算机使用两个 $64$ 位无符号整数的栈 $S_0$ 和 $S_1$ 来存储数据。每个栈中初始存储着 $10^{10^{10}}$ 个 $0$。\n\n为了表述方便，下文中记「$T_x$」表示栈 $S_x$ 的栈顶元素。记符号 「$\\And$」「$\\mid$」「$\\oplus$」分别为按位与、按位或、按位异或运算。\n\n这台计算机支持 $8$ 种汇编指令，若没有特殊说明，以下指令的参数均为整数。\n\n| 名称                 | 参数                     | 说明                                                         | 伪代码                                                       |\n| -------------------- | ------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |\n| $\\textbf{and}\\ i$ | $i \\in [0,1]$            | 令 $T_i$ 为 $T_i$ 与另一个栈的栈顶数字按位与的结果。         | $T_i \\gets T_i \\operatorname{\\And} T_{i \\oplus 1}$           |\n| $\\textbf{or}\\ i$  | $i \\in [0,1]$            | 令 $T_i$ 为 $T_i$ 与另一个栈的栈顶数字按位或的结果。         | $T_i \\gets T_i \\mid T_{i \\oplus 1}$                          |\n| $\\textbf{xor}\\ i$    | $i \\in [0,1]$            | 令 $T_i$ 为 $T_i$ 与另一个栈的栈顶数字按位异或的结果。       | $T_i \\gets T_i \\oplus T_{i \\oplus 1}$                        |\n| $\\textbf{lsh}\\ i\\ j$ | $i \\in [0,1],j\\in[0,64]$ | 令 $T_i$ 为 $T_i$ 左移 $j$ 位的结果，自然溢出。   | $T_i \\gets T_i \\times 2^j \\bmod 2^{64}$                      |\n| $\\textbf{rsh}\\ i\\ j$ | $i \\in [0,1],j\\in[0,64]$ | 令 $T_i$ 为 $T_i$ 右移 $j$ 位的结果，自然溢出。   | $T_i \\gets \\lfloor \\dfrac{T_i}{2^j} \\rfloor$                 |\n| $\\textbf{not}\\ i$    | $i\\in[0,1]$              | 令 $T_i$ 为 $T_i$ 按位取反的结果。                           | $T_i \\gets (2^{64}-1)-T_i$                            |\n| $\\textbf{pop}\\ i$    | $i\\in[0,1]$              | 将栈 $S_i$ 的栈顶元素出栈。                                  | $\\text{Remove top element of }S_i$                           |\n| $\\textbf{mov}\\ i$    | $i\\in[0,1]$              | 将 $T_i$ 出 $S_i$ 栈，然后将其入另一个栈。即移动 $T_i$ 至 $S_{i \\oplus 1}$。 | $\\text{Push}\\ T_i\\text{ to }S_{i\\oplus 1};\\ \\textbf{pop}\\ i$ |\n\n你需要使用这些汇编指令实现若干计算任务，每个测试点对应一个单独的计算任务。下文中「输入 $a_1, a_2, \\cdots$」表示将 $a_1,a_2,\\cdots$ 这几个整数**依次**压入 $S_0$ 栈，而两栈栈底的 $0$ 不做变动。**若无特殊说明，输入的数均为 $\\mathbf{[0,2^{64}-1]}$ 范围内的整数。**「输出 $x_1, x_2, \\cdots$」表示指令运行结束后会从 $S_1$ 中**依次**取出若干个整数作为 $x_1,x_2,\\cdots$ 来检验结果是否正确。除此之外，对于 $S_0$ 栈中所有的数和 $S_1$ 栈中**没有**被取出的数在指令运行结束后可以为任意值。\n\n1. 输入 $a, b$，输出 $b,a$。即将两数交换。\n1. 输入 $a,b$，输出 $(a-b+2^{64}) \\bmod 2^{64}$。即求两数之差，自然溢出。\n1. 输入 $a_1, a_2,\\cdots,a_9;a_i\\in[48,57]$，即 $a_i\\in[\\mathtt{'0'}, \\mathtt{'9'}]$。将 $a_1\\sim a_9$ 视为一个 ASCII 编码下的长度为 $9$ 的字符串，你需要将这个字符串**前后翻转后**转化为一个对应的十进制整数并输出。即实现一个快读。特别的，字符串中可能会有前导零。\n1. 输入 $a$，输出 $(\\operatorname{popcnt}a) \\bmod 2$。其中 $\\operatorname{popcnt} x$ 代表 $x$ 的二进制表示法中 $1$ 的个数。\n1. 输入 $a,b$，输出 $\\min\\{a,b\\}$。\n1. 输入 $a,b,p$，满足 $p$ 为 $2$ 的非负整数次幂或零。输出 $(a\\times b) \\bmod p$。特别地，当 $p=0$ 时输出 $0$。\n1. 输入 $a$，满足 $a$ 和答案都是 $2$ 的非负整数次幂或零，输出 $\\sqrt a$。\n1. 输入 $a,b;1\\le a,b \\le 63$，输出 $\\gcd(a,b)$，即 $a,b$ 的最大公因数。", "inputFormat": "由于出题人不想把这道题出成一道大模拟，所以附件中提供了汇编模拟部分。\n\n在下发文件下有 `checker.cpp` 和 `1.ans ~ 8.ans`。其中 `checker.cpp` 给出了几种汇编指令的简单实现。你可以使用 `checker.cpp` 测试你的程序。使用 `g++ checker.cpp -o checker -std=c++11` 将 `checker.cpp` 编译为可执行文件后运行 `checker *.in *.out *.ans`，`checker` 就会给出你的输出结果和该测试点的得分。其中 `*.in` 中为提供给指令的输入数据，每行一个，以 EOF 结束；`*.out` 中存放你的指令；`*.ans` 指下发文件中的 `.ans` 文件。\n\n**注意：此 checker 仅作示例使用，不具备验证正确性功能。**", "outputFormat": "请将每个任务对应的指令写入 `1.out ~ 8.out`，并打包成 zip 后提交。", "hint": "### 样例说明\n\n上述「样例组 $1\\sim 8$」代表 $1\\sim8$ 子任务的样例输入输出。「样例组 $9\\sim10$」为示例问题的一种最短的程序实现。\n\n---\n\n### 评分方法\n\n下面用 `*` 代表测试点编号。如果你提交的指令（`*.out`）没有正确完成计算得零分，否则设你使用的指令个数为 $cnt$，若 `*.ans` 中有 $x$ 个 $\\ge cnt$ 的数，你该测试点得 $x$ 分。\n\n---\n\n### 注意\n\n虽然我们允许你提交最多 $999999$ 行的指令，但是由于洛谷对于 checker 的运行时间有限制，你的指令长度被强行加上了一个奇怪的上限：约是 $2\\times 10^5$，超过这个长度的指令可能会因为 checker 超时而导致 UKE。\n\n由于洛谷提交答案题的特性，如果你不会做一些 task，请在压缩包内放一个空的 `*.out` 文件占位，其中 `*` 代表 task 编号。否则你的整道题可能会出现答案错位（比如 `2.out` 交到了 $1$ 号测试点）的情况，导致后面的测试点变成零分。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「RdOI R3 附加」ACP-I", "background": "**注意：这不是一道模拟题，请先完整地读完一遍题面后再开始做题。**\n\n---\n\n### 排行榜\n\n| task | 最短行数 | 达成者      |\n| ---- | -------- | ----------- |\n| 1    | 5        | std         |\n| 2    | 191     | \\_\\_Ultimium\\_\\_      |\n| 3    | 845      | dead_X      |\n| 4    | 24       | 囧仙        |\n| 5    | 77       | dqstz  |\n| 6    | 15078    | 寻逍遥2006       |\n| 7    | 211      | liqingyang        |\n| 8    | 6796     | liqingyang |\n\n如有你的解法行数**严格小于**榜中行数，请联系 @[yzy1](/user/207996) 把你的成绩放到排行榜上。\n\n---\n\n题目 ACP 有两层意思：**A**ncient **C**omputer **P**rogram 和 **A**nother **C**onstruct **P**roblem。\n\n在 1951 年，第 -32 届全国青少年信息学奥林匹克冬令营前夕，小 A 借助时空传输接口（**T**ime **T**ransport **I**nterface）连接了一台 2015 年的计算机，获取到了第 32 届冬令营的题目来练习。\n\n他打开了第三题「未来程序」这道题目：\n\n> 本题是一道提交答案题，一共 10 个测试点。  \n> 对于每个测试点，你会得到一段程序的源代码和这段程序的输入。你要运行这个程序，并保存这个程序的输出。  \n> 遗憾的是这些程序都效率极其低下，无法在比赛的 5 个小时内得到输出。\n\n小 A 想了一下，决定用 1951 年的计算机来试着运行这个题目。但是因为 1951 年的电脑存储空间过小，导致他无法传输题目附件和数据，请你帮助小 A 写 std 造数据。\n", "description": "**这是一道提交答案题。**\n\n小 A 的古董计算机使用两个 $64$ 位无符号整数的栈 $S_0$ 和 $S_1$ 来存储数据。每个栈中初始存储着 $10^{10^{10}}$ 个 $0$。\n\n为了表述方便，下文中记「$T_x$」表示栈 $S_x$ 的栈顶元素。记符号 「$\\And$」「$\\mid$」「$\\oplus$」分别为按位与、按位或、按位异或运算。\n\n这台计算机支持 $8$ 种汇编指令，若没有特殊说明，以下指令的参数均为整数。\n\n| 名称                 | 参数                     | 说明                                                         | 伪代码                                                       |\n| -------------------- | ------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |\n| $\\textbf{and}\\ i$ | $i \\in [0,1]$            | 令 $T_i$ 为 $T_i$ 与另一个栈的栈顶数字按位与的结果。         | $T_i \\gets T_i \\operatorname{\\And} T_{i \\oplus 1}$           |\n| $\\textbf{or}\\ i$  | $i \\in [0,1]$            | 令 $T_i$ 为 $T_i$ 与另一个栈的栈顶数字按位或的结果。         | $T_i \\gets T_i \\mid T_{i \\oplus 1}$                          |\n| $\\textbf{xor}\\ i$    | $i \\in [0,1]$            | 令 $T_i$ 为 $T_i$ 与另一个栈的栈顶数字按位异或的结果。       | $T_i \\gets T_i \\oplus T_{i \\oplus 1}$                        |\n| $\\textbf{lsh}\\ i\\ j$ | $i \\in [0,1],j\\in[0,64]$ | 令 $T_i$ 为 $T_i$ 左移 $j$ 位的结果，自然溢出。   | $T_i \\gets T_i \\times 2^j \\bmod 2^{64}$                      |\n| $\\textbf{rsh}\\ i\\ j$ | $i \\in [0,1],j\\in[0,64]$ | 令 $T_i$ 为 $T_i$ 右移 $j$ 位的结果，自然溢出。   | $T_i \\gets \\lfloor \\dfrac{T_i}{2^j} \\rfloor$                 |\n| $\\textbf{not}\\ i$    | $i\\in[0,1]$              | 令 $T_i$ 为 $T_i$ 按位取反的结果。                           | $T_i \\gets (2^{64}-1)-T_i$                            |\n| $\\textbf{pop}\\ i$    | $i\\in[0,1]$              | 将栈 $S_i$ 的栈顶元素出栈。                                  | $\\text{Remove top element of }S_i$                           |\n| $\\textbf{mov}\\ i$    | $i\\in[0,1]$              | 将 $T_i$ 出 $S_i$ 栈，然后将其入另一个栈。即移动 $T_i$ 至 $S_{i \\oplus 1}$。 | $\\text{Push}\\ T_i\\text{ to }S_{i\\oplus 1};\\ \\textbf{pop}\\ i$ |\n\n你需要使用这些汇编指令实现若干计算任务，每个测试点对应一个单独的计算任务。下文中「输入 $a_1, a_2, \\cdots$」表示将 $a_1,a_2,\\cdots$ 这几个整数**依次**压入 $S_0$ 栈，而两栈栈底的 $0$ 不做变动。**若无特殊说明，输入的数均为 $\\mathbf{[0,2^{64}-1]}$ 范围内的整数。**「输出 $x_1, x_2, \\cdots$」表示指令运行结束后会从 $S_1$ 中**依次**取出若干个整数作为 $x_1,x_2,\\cdots$ 来检验结果是否正确。除此之外，对于 $S_0$ 栈中所有的数和 $S_1$ 栈中**没有**被取出的数在指令运行结束后可以为任意值。\n\n1. 输入 $a, b$，输出 $b,a$。即将两数交换。\n1. 输入 $a,b$，输出 $(a-b+2^{64}) \\bmod 2^{64}$。即求两数之差，自然溢出。\n1. 输入 $a_1, a_2,\\cdots,a_9;a_i\\in[48,57]$，即 $a_i\\in[\\mathtt{'0'}, \\mathtt{'9'}]$。将 $a_1\\sim a_9$ 视为一个 ASCII 编码下的长度为 $9$ 的字符串，你需要将这个字符串**前后翻转后**转化为一个对应的十进制整数并输出。即实现一个快读。特别的，字符串中可能会有前导零。\n1. 输入 $a$，输出 $(\\operatorname{popcnt}a) \\bmod 2$。其中 $\\operatorname{popcnt} x$ 代表 $x$ 的二进制表示法中 $1$ 的个数。\n1. 输入 $a,b$，输出 $\\min\\{a,b\\}$。\n1. 输入 $a,b,p$，满足 $p$ 为 $2$ 的非负整数次幂或零。输出 $(a\\times b) \\bmod p$。特别地，当 $p=0$ 时输出 $0$。\n1. 输入 $a$，满足 $a$ 和答案都是 $2$ 的非负整数次幂或零，输出 $\\sqrt a$。\n1. 输入 $a,b;1\\le a,b \\le 63$，输出 $\\gcd(a,b)$，即 $a,b$ 的最大公因数。", "inputFormat": "由于出题人不想把这道题出成一道大模拟，所以附件中提供了汇编模拟部分。\n\n在下发文件下有 `checker.cpp` 和 `1.ans ~ 8.ans`。其中 `checker.cpp` 给出了几种汇编指令的简单实现。你可以使用 `checker.cpp` 测试你的程序。使用 `g++ checker.cpp -o checker -std=c++11` 将 `checker.cpp` 编译为可执行文件后运行 `checker *.in *.out *.ans`，`checker` 就会给出你的输出结果和该测试点的得分。其中 `*.in` 中为提供给指令的输入数据，每行一个，以 EOF 结束；`*.out` 中存放你的指令；`*.ans` 指下发文件中的 `.ans` 文件。\n\n**注意：此 checker 仅作示例使用，不具备验证正确性功能。**", "outputFormat": "请将每个任务对应的指令写入 `1.out ~ 8.out`，并打包成 zip 后提交。", "hint": "### 样例说明\n\n上述「样例组 $1\\sim 8$」代表 $1\\sim8$ 子任务的样例输入输出。「样例组 $9\\sim10$」为示例问题的一种最短的程序实现。\n\n---\n\n### 评分方法\n\n下面用 `*` 代表测试点编号。如果你提交的指令（`*.out`）没有正确完成计算得零分，否则设你使用的指令个数为 $cnt$，若 `*.ans` 中有 $x$ 个 $\\ge cnt$ 的数，你该测试点得 $x$ 分。\n\n---\n\n### 注意\n\n虽然我们允许你提交最多 $999999$ 行的指令，但是由于洛谷对于 checker 的运行时间有限制，你的指令长度被强行加上了一个奇怪的上限：约是 $2\\times 10^5$，超过这个长度的指令可能会因为 checker 超时而导致 UKE。\n\n由于洛谷提交答案题的特性，如果你不会做一些 task，请在压缩包内放一个空的 `*.out` 文件占位，其中 `*` 代表 task 编号。否则你的整道题可能会出现答案错位（比如 `2.out` 交到了 $1$ 号测试点）的情况，导致后面的测试点变成零分。", "locale": "zh-CN"}}}
{"pid": "P7828", "type": "P", "difficulty": 6, "samples": [["5 4 3\n1 4 2 1 2\n3\n2\n1", "4\n2\n2"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["树状数组", "2021", "CCO（加拿大）", "根号分治"], "title": "[CCO 2021] Swap Swap Sort", "background": "", "description": "你有一个长度为 $n$ 的序列，每项都是不超过 $k$ 的正整数。\n\n你的朋友发明了一个排序算法，可以根据一个 $1 \\sim k$ 的排列对序列进行排序，排序后序列中任意两个不相等的数的相对位置与排列中的相对位置相同。他的算法只使用了邻项交换的操作，且总是保证操作次数最少。为了方便描述，他将这个 $1 \\sim k$ 的排列称为目标排列。\n\n例如，序列为 $[1, 4, 2, 1, 2]$，目标排列为 $[4, 1, 2, 3]$，排序后为 $[4, 1, 1, 2, 2]$。\n\n你对你朋友的排序算法在目标排列不同时执行 swap 的次数很感兴趣。为了研究其中的规律，你一开始将目标排列设置为 $1 \\sim k$，并以此进行 $q$ 次操作，每次操作交换目标排列中相邻的两个数的位置。每次交换后，你想知道如果用他的排序算法对原序列进行排序会执行 swap 的次数。", "inputFormat": "第一行，三个整数 $n, k, q$。\n\n第二行，$n$ 个正整数 $a_1, a_2, \\cdots, a_n$，表示原序列。\n\n接下来 $q$ 行，每行一个正整数 $b$，表示交换目标排列中的第 $b$ 和第 $b + 1$ 个数。", "outputFormat": "对于每次询问，输出一个整数，表示所求的值。", "hint": "#### 数据范围\n**由于官方数据包过大，本题只节选了官方数据的 $\\frac{20}{27}$。**\n\n对于 $\\frac{4}{27}$ 的数据，$1 \\leq n, q \\leq 5 \\times 10^3$；\n\n对于另外 $\\frac{4}{27}$ 的数据，$1 \\leq q \\leq 100$；\n\n对于另外 $\\frac{7}{54}$ 的数据，$1 \\leq k \\leq 500$；\n\n对于 $100\\%$ 的数据，$1 \\leq n, k \\leq 10^5$，$1 \\leq q \\leq 10^6$，$1 \\leq a_i \\leq k$，$1 \\leq b < k$。\n#### 题目来源\n[CCO2021](https://cemc.math.uwaterloo.ca/contests/computing/2021/index.html) D1T1", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCO 2021] Swap Swap Sort", "background": "", "description": "你有一个长度为 $n$ 的序列，每项都是不超过 $k$ 的正整数。\n\n你的朋友发明了一个排序算法，可以根据一个 $1 \\sim k$ 的排列对序列进行排序，排序后序列中任意两个不相等的数的相对位置与排列中的相对位置相同。他的算法只使用了邻项交换的操作，且总是保证操作次数最少。为了方便描述，他将这个 $1 \\sim k$ 的排列称为目标排列。\n\n例如，序列为 $[1, 4, 2, 1, 2]$，目标排列为 $[4, 1, 2, 3]$，排序后为 $[4, 1, 1, 2, 2]$。\n\n你对你朋友的排序算法在目标排列不同时执行 swap 的次数很感兴趣。为了研究其中的规律，你一开始将目标排列设置为 $1 \\sim k$，并以此进行 $q$ 次操作，每次操作交换目标排列中相邻的两个数的位置。每次交换后，你想知道如果用他的排序算法对原序列进行排序会执行 swap 的次数。", "inputFormat": "第一行，三个整数 $n, k, q$。\n\n第二行，$n$ 个正整数 $a_1, a_2, \\cdots, a_n$，表示原序列。\n\n接下来 $q$ 行，每行一个正整数 $b$，表示交换目标排列中的第 $b$ 和第 $b + 1$ 个数。", "outputFormat": "对于每次询问，输出一个整数，表示所求的值。", "hint": "#### 数据范围\n**由于官方数据包过大，本题只节选了官方数据的 $\\frac{20}{27}$。**\n\n对于 $\\frac{4}{27}$ 的数据，$1 \\leq n, q \\leq 5 \\times 10^3$；\n\n对于另外 $\\frac{4}{27}$ 的数据，$1 \\leq q \\leq 100$；\n\n对于另外 $\\frac{7}{54}$ 的数据，$1 \\leq k \\leq 500$；\n\n对于 $100\\%$ 的数据，$1 \\leq n, k \\leq 10^5$，$1 \\leq q \\leq 10^6$，$1 \\leq a_i \\leq k$，$1 \\leq b < k$。\n#### 题目来源\n[CCO2021](https://cemc.math.uwaterloo.ca/contests/computing/2021/index.html) D1T1", "locale": "zh-CN"}}}
{"pid": "P7829", "type": "P", "difficulty": 6, "samples": [["3 3 3 1\n-1 0 1\n15\n8\n-5", "1 -1 -1 0\n1 0 -1\n-1 1 1"], ["10 1 3 2\n0 2 -2\n17", "IMPOSSIBLE"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2021", "Special Judge", "CCO（加拿大）", "记忆化搜索", "数位 DP", "进制"], "title": "[CCO 2021] Weird Numeral System", "background": "", "description": "Alice 正在思考一个关于 $k$ 进制整数的问题。\n\n普通的 $k$ 进制可以将整数 $n$ 表示为 $d_{m - 1} d_{m - 2} \\cdots d_0$，且满足：\n\n1. $0 \\leq d_i < k$；\n2. $n = \\displaystyle\\sum_{i = 0}^{m - 1} d_i k^i$。\n\n然而，普通的 $k$ 进制整数对于 Alice 来说太简单了，Alice 更喜欢奇怪的 $k$ 进制整数。它与普通 $k$ 进制整数的差别仅仅在于将 $0 \\leq d_i < k$ 换成了 $d_i \\in a$，其中 $a$ 为一个长为 $D$ 的数列。\n\n现在有一组固定的 $a_1, a_2, \\cdots, a_D$，Alice 想要将 $q$ 个十进制整数 $n_1, n_2, \\cdots, n_q$ 全部转化为奇怪的 $k$ 进制整数，这种问题显然更适合写程序来解决。", "inputFormat": "第一行，四个整数 $k, q, D, M$；\n\n第二行，$D$ 个整数 $a_1, a_2, \\cdots, a_D$；\n\n接下来 $q$ 行，每行一个整数 $n_i$。", "outputFormat": "$q$ 行，第 $i$ 行表示 $n_i$ 转化后的结果，按幂次从高到低的顺序输出每一位，两个位之间用单个空格间隔。当 $a_i$ 中包含 $0$ 时，你转化的结果可以包含前导零，但最好不要太多；当 $n_i = 0$ 时，你转化的结果也不能为空。如果有多种方案可以随便输出一种，如果无法转化输出 `IMPOSSIBLE`。", "hint": "**本题由 @[Leasier](https://www.luogu.com.cn/user/201007) 提供 SPJ。**\n#### 数据范围\n对于 $100\\%$ 的数据，$2 \\leq k \\leq 10^6$，$1 \\leq q \\leq 5$，$1 \\leq D \\leq 801$，$1 \\leq M \\leq 400$，$-M \\leq a_i \\leq M$，$-10^{18} \\leq n_i \\leq 10^{18}$。\n#### 题目来源\n[CCO2021](https://cemc.math.uwaterloo.ca/contests/computing/2021/index.html) D1T2", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CCO 2021] Weird Numeral System", "background": "", "description": "Alice 正在思考一个关于 $k$ 进制整数的问题。\n\n普通的 $k$ 进制可以将整数 $n$ 表示为 $d_{m - 1} d_{m - 2} \\cdots d_0$，且满足：\n\n1. $0 \\leq d_i < k$；\n2. $n = \\displaystyle\\sum_{i = 0}^{m - 1} d_i k^i$。\n\n然而，普通的 $k$ 进制整数对于 Alice 来说太简单了，Alice 更喜欢奇怪的 $k$ 进制整数。它与普通 $k$ 进制整数的差别仅仅在于将 $0 \\leq d_i < k$ 换成了 $d_i \\in a$，其中 $a$ 为一个长为 $D$ 的数列。\n\n现在有一组固定的 $a_1, a_2, \\cdots, a_D$，Alice 想要将 $q$ 个十进制整数 $n_1, n_2, \\cdots, n_q$ 全部转化为奇怪的 $k$ 进制整数，这种问题显然更适合写程序来解决。", "inputFormat": "第一行，四个整数 $k, q, D, M$；\n\n第二行，$D$ 个整数 $a_1, a_2, \\cdots, a_D$；\n\n接下来 $q$ 行，每行一个整数 $n_i$。", "outputFormat": "$q$ 行，第 $i$ 行表示 $n_i$ 转化后的结果，按幂次从高到低的顺序输出每一位，两个位之间用单个空格间隔。当 $a_i$ 中包含 $0$ 时，你转化的结果可以包含前导零，但最好不要太多；当 $n_i = 0$ 时，你转化的结果也不能为空。如果有多种方案可以随便输出一种，如果无法转化输出 `IMPOSSIBLE`。", "hint": "**本题由 @[Leasier](https://www.luogu.com.cn/user/201007) 提供 SPJ。**\n#### 数据范围\n对于 $100\\%$ 的数据，$2 \\leq k \\leq 10^6$，$1 \\leq q \\leq 5$，$1 \\leq D \\leq 801$，$1 \\leq M \\leq 400$，$-M \\leq a_i \\leq M$，$-10^{18} \\leq n_i \\leq 10^{18}$。\n#### 题目来源\n[CCO2021](https://cemc.math.uwaterloo.ca/contests/computing/2021/index.html) D1T2", "locale": "zh-CN"}}}
