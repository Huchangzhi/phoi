{"pid": "P2948", "type": "P", "difficulty": 5, "samples": [["10 1 2 \n3 2 5 \n4 1 \n1 3 \n", "6 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "2009", "USACO", "枚举"], "title": "[USACO09OPEN] Ski Lessons G", "background": "", "description": "Farmer John wants to take Bessie skiing in Colorado. Sadly, Bessie is not really a very good skier.\n\nBessie has learned that the ski resort is offering S (0 <= S <= 100) ski classes throughout the day. Lesson i starts at time M\\_i (1 <= M\\_i <= 10,000) and lasts for time L\\_i (1 <= L\\_i <= 10,000). After lesson i, Bessie's ski ability becomes A\\_i (1 <= A\\_i <= 100). Note: this ability is an absolute, not an incremental change.\n\nBessie has purchased a map which shows all N (1 <= N <= 10,000) ski slopes along with the time D\\_i (1 <= D\\_i <= 10,000) required to ski down slope i and the skill level C\\_i (1 <= C\\_i <= 100) required to get down the slope safely. Bessie's skill level must be greater than or equal to the skill level of the slope in order for her to ski down it.\n\nBessie can devote her time to skiing, taking lessons, or sipping hot cocoa but must leave the ski resort by time T (1 <= T <= 10,000), and that means she must complete the descent of her last slope without exceeding that time limit.\n\nFind the maximum number of runs Bessie can complete within the time limit. She starts the day at skill level 1.\n\nExtra feedback will be provided on the first 50 submissions.\n\n", "inputFormat": "\\* Line 1: Three space-separated integers: T, S, and N\n\n\\* Lines 2..S+1: Line i+1 describes ski lesson i with three\n\nspace-separated integers: M\\_i, L\\_i, and A\\_i\n\n\\* Lines S+2..S+N+1: Line S+i+1 describes ski slope i with two\n\nspace-separated integers: C\\_i and D\\_i.\n", "outputFormat": "A single integer on a line by itself, the maximum number of runs that Bessie may ski within the time limit.\n", "hint": "Ski the second slope once, take the lesson, and ski the first slope 5 times before time is up: a total of 6 slopes.\n", "locale": "en", "translations": {"en": {"title": "[USACO09OPEN] Ski Lessons G", "background": "", "description": "Farmer John wants to take Bessie skiing in Colorado. Sadly, Bessie is not really a very good skier.\n\nBessie has learned that the ski resort is offering S (0 <= S <= 100) ski classes throughout the day. Lesson i starts at time M\\_i (1 <= M\\_i <= 10,000) and lasts for time L\\_i (1 <= L\\_i <= 10,000). After lesson i, Bessie's ski ability becomes A\\_i (1 <= A\\_i <= 100). Note: this ability is an absolute, not an incremental change.\n\nBessie has purchased a map which shows all N (1 <= N <= 10,000) ski slopes along with the time D\\_i (1 <= D\\_i <= 10,000) required to ski down slope i and the skill level C\\_i (1 <= C\\_i <= 100) required to get down the slope safely. Bessie's skill level must be greater than or equal to the skill level of the slope in order for her to ski down it.\n\nBessie can devote her time to skiing, taking lessons, or sipping hot cocoa but must leave the ski resort by time T (1 <= T <= 10,000), and that means she must complete the descent of her last slope without exceeding that time limit.\n\nFind the maximum number of runs Bessie can complete within the time limit. She starts the day at skill level 1.\n\nExtra feedback will be provided on the first 50 submissions.\n\n", "inputFormat": "\\* Line 1: Three space-separated integers: T, S, and N\n\n\\* Lines 2..S+1: Line i+1 describes ski lesson i with three\n\nspace-separated integers: M\\_i, L\\_i, and A\\_i\n\n\\* Lines S+2..S+N+1: Line S+i+1 describes ski slope i with two\n\nspace-separated integers: C\\_i and D\\_i.\n", "outputFormat": "A single integer on a line by itself, the maximum number of runs that Bessie may ski within the time limit.\n", "hint": "Ski the second slope once, take the lesson, and ski the first slope 5 times before time is up: a total of 6 slopes.\n", "locale": "en"}, "zh-CN": {"title": "[USACO09OPEN] Ski Lessons G", "background": null, "description": "农夫约翰想带贝西去科罗拉多滑雪。不幸的是，贝西滑雪技术并不是很好。\n\n贝西了解到滑雪场全天提供 $S (0 \\le S \\le 100)$ 节滑雪课。第 $i$ 节课从时间 $M\\_i (1 \\le M\\_i \\le 10,000)$ 开始，持续时间为 $L_i (1 \\le L_i \\le 10,000)$。在第 i 节课后，贝西的滑雪能力变为 $A_i (1 \\le A_i \\le 100)$。注意：这种能力是绝对值变化，而不是增量变化。\n\n贝西购买了一张地图，上面显示了所有 $N (1 \\le N \\le 10,000)$ 条滑雪道，以及滑下第 i 条滑雪道所需的时间 $D_i (1 \\le D_i \\le 10,000)$ 和安全滑下该滑雪道所需的技能水平 $C_i (1 \\le C_i \\le 100)$。贝西的技能水平必须大于或等于滑雪道的技能水平，才能安全滑下。\n\n贝西可以把时间花在滑雪、上课或喝热可可上，但必须在时间 $T (1 \\le T \\le 10,000)$ 前离开滑雪场，这意味着她必须在不超过该时间限制的情况下完成她最后一条滑雪道的滑行。\n\n找出贝西在时间限制内可以完成的最大滑雪次数。她一天开始时的技能水平为 $1$。", "inputFormat": "- 第 $1$ 行：三个用空格分隔的整数：$T$、$S$ 和 $N$。\n\n- 第 $2$ 行到第 $S+1$ 行：第 $i+1$ 行描述第 $i$ 节滑雪课，包含三个用空格分隔的整数：$M_i、L_i 和 A_i$。\n\n- 第 $S+2$ 行到第 $S+N+1$ 行：第 $S+i+1$ 行描述第 $i$ 条滑雪道，包含两个用空格分隔的整数：$C_i$ 和 $D_i$。", "outputFormat": "单独一行上的一个整数，表示贝西在时间限制内可以滑的最大次数。", "hint": "滑第二条滑雪道一次，上课，然后在时间用完前滑第一条滑雪道 $5$ 次：总共 $6$ 条滑雪道。\n（由 ChatGPT 4o 翻译）", "locale": "zh-CN"}}}
{"pid": "P2949", "type": "P", "difficulty": 5, "samples": [["3 \n2 10 \n1 5 \n1 7 \n", "17 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "递推", "2009", "USACO", "优先队列", "反悔贪心"], "title": "[USACO09OPEN] Work Scheduling G", "background": "", "description": "Farmer John has so very many jobs to do! In order to run the farm efficiently, he must make money on the jobs he does, each one of which takes just one time unit.\n\nHis work day starts at time 0 and has 1,000,000,000 time units (!).  He currently can choose from any of N (1 <= N <= 100,000) jobs\n\nconveniently numbered 1..N for work to do. It is possible but\n\nextremely unlikely that he has time for all N jobs since he can only work on one job during any time unit and the deadlines tend to fall so that he can not perform all the tasks.\n\nJob i has deadline D\\_i (1 <= D\\_i <= 1,000,000,000). If he finishes job i by then, he makes a profit of P\\_i (1 <= P\\_i <= 1,000,000,000).\n\nWhat is the maximum total profit that FJ can earn from a given list of jobs and deadlines?  The answer might not fit into a 32-bit integer.\n\n\n", "inputFormat": "\\* Line 1: A single integer: N\n\n\\* Lines 2..N+1: Line i+1 contains two space-separated integers: D\\_i and P\\_i\n", "outputFormat": "\\* Line 1: A single number on a line by itself that is the maximum possible profit FJ can earn.\n", "hint": "Complete job 3 (1,7) at time 1 and complete job 1 (2,10) at time 2 to maximize the earnings (7 + 10 -> 17).\n", "locale": "en", "translations": {"en": {"title": "[USACO09OPEN] Work Scheduling G", "background": "", "description": "Farmer John has so very many jobs to do! In order to run the farm efficiently, he must make money on the jobs he does, each one of which takes just one time unit.\n\nHis work day starts at time 0 and has 1,000,000,000 time units (!).  He currently can choose from any of N (1 <= N <= 100,000) jobs\n\nconveniently numbered 1..N for work to do. It is possible but\n\nextremely unlikely that he has time for all N jobs since he can only work on one job during any time unit and the deadlines tend to fall so that he can not perform all the tasks.\n\nJob i has deadline D\\_i (1 <= D\\_i <= 1,000,000,000). If he finishes job i by then, he makes a profit of P\\_i (1 <= P\\_i <= 1,000,000,000).\n\nWhat is the maximum total profit that FJ can earn from a given list of jobs and deadlines?  The answer might not fit into a 32-bit integer.\n\n\n", "inputFormat": "\\* Line 1: A single integer: N\n\n\\* Lines 2..N+1: Line i+1 contains two space-separated integers: D\\_i and P\\_i\n", "outputFormat": "\\* Line 1: A single number on a line by itself that is the maximum possible profit FJ can earn.\n", "hint": "Complete job 3 (1,7) at time 1 and complete job 1 (2,10) at time 2 to maximize the earnings (7 + 10 -> 17).\n", "locale": "en"}, "zh-CN": {"title": "[USACO09OPEN] Work Scheduling G", "background": null, "description": "农夫约翰有很多工作要做！为了高效地经营农场，他必须从他所做的每一项工作中赚取利润，每项工作只需要一个时间单位。\n\n他的工作日从时间 $0$ 开始，总共有 $10^9$ 个时间单位。他目前可以从 $N$ ($1 \\leq N \\leq 10^5$) 项工作中选择要做的工作，这些工作被方便地编号为 $1$ 到 $N$。\n\n虽然理论上他有可能完成所有 $N$ 项工作，但实际上这是极不可能的，因为他在任何一个时间单位内只能完成一项工作，而截止日期通常会导致他无法完成所有任务。\n\n第 $i$ 项工作的截止时间为 $D_i$ ($1 \\leq D_i \\leq 10^9$)。如果他在截止时间前完成第 $i$ 项工作（如果当前时间为 $t$，那么仅当 $D_i > t$ 的时候他能做这个任务，完成后 $t \\rightarrow t+1$），他将获得 $P_i$ ($1 \\leq P_i \\leq 10^9$) 的利润。\n\n给定一系列工作和截止日期，FJ 能够获得的最大总利润是多少？答案可能无法容纳在 $32$ 位整数中。", "inputFormat": "第一行输入一个整数 $N$，意义见题目描述。\n\n第二行到第 $N+1$ 行：第 $i+1$ 行包含两个用空格分隔的整数：$D_i$ 和 $P_i$", "outputFormat": "只有一个数字，表示 FJ 能够获得的最大利润。", "hint": "在时间 $1$ 完成工作 $3$ $\\left(1,7\\right)$，在时间 $2$ 完成工作 $1$ $\\left(2,10\\right)$ 以最大化收益，最后收益为 $7+10=17$。\n\n（由 ChatGPT 4o 翻译）", "locale": "zh-CN"}}}
{"pid": "P2950", "type": "P", "difficulty": 5, "samples": [["2 1 \n1 0 0 \n0 1 0 \n", "1 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "递推", "2009", "USACO", "单调队列"], "title": "[USACO09OPEN] Bovine Embroidery G", "background": "", "description": "Bessie has taken up the detailed art of bovine embroidery. Cows embroider a cloth mounted in a circular hoop of integer radius d (1 <= d <= 50,000). They sew N (2 <= N <= 50,000) threads, each in a straight line from one point on the edge of the hoop to another point on the edge of the hoop (no two embroidered points share a location on the hoop's edge).\n\nBeing mathematically inclined, Bessie knows a formula of the form ax + by + c = 0 for each straight line piece of thread. Conveniently, a, b, and c are integers (-1,000,000 <= a <= 1,000,000; -1,000,000 <= b <= 1,000,000; -1,000,000 <= c <= 1,000,000). Even more\n\nconveniently, no two threads coincide exactly.\n\nPerhaps less conveniently, Bessie knows that her set of formula coefficients also includes a number of formulae for threads that do not appear to pass inside the hoop's circle. She regrets this greatly.\n\nThe origin (0,0) is in the precise middle of the hoop, so all points on the hoop's edge are distance d from the origin. At least one of the coefficients a and b is non-zero for each thread's formula.\n\nBovine embroidery is more highly regarded when the number of thread intersections is maximized. Help Bessie: count the number of pairs of threads that intersect on the cloth (i.e., within distance d of the origin). Note that if three threads happen to coincide at the same point, that would be three pairs of intersections. Four threads at the same point -> six pairs of intersections, etc.\n\nBessie学会了刺绣这种精细的工作。牛们在一片半径为d(1 <= d <= 50000)的圆形布上绣花. 它们一共绣了N (2 <= N <= 50000)条直线，每条直线连接布的边缘上的两个点(没有两条线通过边上同一个点)。\n\n作为一只热爱数学的牛，Bessie 知道每条线的公式, ax + by + c = 0. a, b, 和 c 为整数(-1000000 <= a <= 1000000; -1000000 <= b <= 1000000; -1000000 <= c <= 1000000).没有两条线完全重合。\n\n不幸的是, 一部分线不通过圆布的内部. 原点(0,0)在布的正中央, 所有边上的点离原点距离为d. 每条线的公式满足至少a,b中的一个非零. 对于牛来说，刺绣作品中线的交点越多，便越有价值。帮助Bessie计算在圆中相交的线的对数，也就是说交点与原点的距离小于d。注意如果三条线在圆内同一点相交,这算3对线。4线共点->6对线.\n", "inputFormat": "\\* Line 1: Two space-separated integers: N and d\n\n\\* Lines 2..N+1: Line i+1 describes thread i with three integers: a, b, and c\n", "outputFormat": "\\* Line 1: One integer, on a line by itself, that is the count of pairs of threads that intersect.\n", "hint": "The two lines are x=0 and y=0. \n\nThe two lines intersect at (0,0), which is clearly with 1 of the origin. \n\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO09OPEN] Bovine Embroidery G", "background": "", "description": "Bessie has taken up the detailed art of bovine embroidery. Cows embroider a cloth mounted in a circular hoop of integer radius $d$ ($1 \\le d \\le 50000$). They sew $N$ ($2 \\le N \\le 50000$) straight threads, each from one point on the edge of the hoop to another point on the edge (no two embroidered points share a location on the hoop's edge).\n\nBeing mathematically inclined, Bessie knows a formula of the form $ax + by + c = 0$ for each straight thread. Conveniently, $a$, $b$, and $c$ are integers ($-1000000 \\le a \\le 1000000$, $-1000000 \\le b \\le 1000000$, $-1000000 \\le c \\le 1000000$). Even more conveniently, no two threads coincide exactly. At least one of $a$ and $b$ is non-zero for each thread’s formula.\n\nPerhaps less conveniently, Bessie knows that her set of formula coefficients also includes some lines that do not pass through the interior of the hoop’s circle. The origin $(0, 0)$ is at the exact center of the hoop, so all points on the hoop’s edge are at distance $d$ from the origin.\n\nBovine embroidery is more highly regarded when the number of thread intersections is maximized. Help Bessie count the number of pairs of threads that intersect on the cloth, i.e., whose intersection point lies within distance $d$ of the origin. If $k$ threads meet at the same point inside the circle, they contribute $\\binom{k}{2}$ pairs (e.g., three threads give three pairs; four threads give six pairs).", "inputFormat": "- Line 1: Two space-separated integers $N$ and $d$.\n- Lines 2 to $N+1$: Line $i+1$ describes thread $i$ with three integers: $a$, $b$, and $c$.", "outputFormat": "- Line 1: One integer, the count of pairs of threads that intersect inside the circle of radius $d$.", "hint": "The two lines are $x = 0$ and $y = 0$. The two lines intersect at $(0, 0)$, which is clearly within distance $1$ of the origin.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO09OPEN] Bovine Embroidery G", "background": "", "description": "Bessie has taken up the detailed art of bovine embroidery. Cows embroider a cloth mounted in a circular hoop of integer radius d (1 <= d <= 50,000). They sew N (2 <= N <= 50,000) threads, each in a straight line from one point on the edge of the hoop to another point on the edge of the hoop (no two embroidered points share a location on the hoop's edge).\n\nBeing mathematically inclined, Bessie knows a formula of the form ax + by + c = 0 for each straight line piece of thread. Conveniently, a, b, and c are integers (-1,000,000 <= a <= 1,000,000; -1,000,000 <= b <= 1,000,000; -1,000,000 <= c <= 1,000,000). Even more\n\nconveniently, no two threads coincide exactly.\n\nPerhaps less conveniently, Bessie knows that her set of formula coefficients also includes a number of formulae for threads that do not appear to pass inside the hoop's circle. She regrets this greatly.\n\nThe origin (0,0) is in the precise middle of the hoop, so all points on the hoop's edge are distance d from the origin. At least one of the coefficients a and b is non-zero for each thread's formula.\n\nBovine embroidery is more highly regarded when the number of thread intersections is maximized. Help Bessie: count the number of pairs of threads that intersect on the cloth (i.e., within distance d of the origin). Note that if three threads happen to coincide at the same point, that would be three pairs of intersections. Four threads at the same point -> six pairs of intersections, etc.\n\nBessie学会了刺绣这种精细的工作。牛们在一片半径为d(1 <= d <= 50000)的圆形布上绣花. 它们一共绣了N (2 <= N <= 50000)条直线，每条直线连接布的边缘上的两个点(没有两条线通过边上同一个点)。\n\n作为一只热爱数学的牛，Bessie 知道每条线的公式, ax + by + c = 0. a, b, 和 c 为整数(-1000000 <= a <= 1000000; -1000000 <= b <= 1000000; -1000000 <= c <= 1000000).没有两条线完全重合。\n\n不幸的是, 一部分线不通过圆布的内部. 原点(0,0)在布的正中央, 所有边上的点离原点距离为d. 每条线的公式满足至少a,b中的一个非零. 对于牛来说，刺绣作品中线的交点越多，便越有价值。帮助Bessie计算在圆中相交的线的对数，也就是说交点与原点的距离小于d。注意如果三条线在圆内同一点相交,这算3对线。4线共点->6对线.\n", "inputFormat": "\\* Line 1: Two space-separated integers: N and d\n\n\\* Lines 2..N+1: Line i+1 describes thread i with three integers: a, b, and c\n", "outputFormat": "\\* Line 1: One integer, on a line by itself, that is the count of pairs of threads that intersect.\n", "hint": "The two lines are x=0 and y=0. \n\nThe two lines intersect at (0,0), which is clearly with 1 of the origin. \n\n", "locale": "zh-CN"}}}
{"pid": "P2951", "type": "P", "difficulty": 3, "samples": [["6 7 \n3 6 \n4 3 \n3 2 \n1 3 \n1 2 \n2 4 \n5 2 \n", "4 2 3 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2009", "USACO", "最短路"], "title": "[USACO09OPEN] Hide and Seek S", "background": null, "description": "奶牛贝西和农夫约翰（FJ）玩捉迷藏，现在有 $N$ 个谷仓，FJ开始在第一个谷仓，贝西为了不让FJ找到她，当然要藏在距离第一个谷仓最远的那个谷仓了。现在告诉你 $N$ 个谷仓，和 $M$ 个两两谷仓间的“无向边”。每两个仓谷间当然会有最短路径，现在要求距离第一个谷仓（FJ那里）最远的谷仓是哪个（所谓最远就是距离第一个谷仓最大的最短路径）？如有多个则输出编号最小的。以及求这最远距离是多少，和有几个这样的谷仓距离第一个谷仓那么远。", "inputFormat": "第一行：两个整数 $N$，$M$；\n\n\n第 $2-M+1$ 行：每行两个整数，表示端点 $A_i$ 和 $B_i$ 间有一条无向边。", "outputFormat": "仅一行，三个整数，两两中间空格隔开。表示：距离第一个谷仓最远的谷仓编号（如有多个则输出编号最小的），以及最远的距离，和有几个谷仓距离第一个谷仓那么远。", "hint": "农场的布局如下：\n\n ![](https://cdn.luogu.com.cn/upload/pic/2815.png) \n\n这里谷仓4，5，6距离1号谷仓都是2，但是4编号最小所以输出4.因此最远距离是2且有3个谷仓，依次输出：2和3。 \n\n$2\\le n\\le 50000,1\\le m\\le 50000$\n\n感谢 wjcwinmt 的贡献翻译", "locale": "zh-CN", "translations": {"en": {"title": "[USACO09OPEN] Hide and Seek S", "background": null, "description": "Bessie is playing hide and seek (a game in which a number of players\nhide and a single player (the seeker) attempts to find them after\nwhich various penalties and rewards are assessed; much fun usually\nensues).\n\nShe is trying to figure out in which of N (2 <= N <= 20,000) barns\nconveniently numbered 1..N she should hide. She knows that FJ (the\nseeker) starts out in barn 1. All the barns are connected by M (1\n<= M <= 50,000) bidirectional paths with endpoints A_i and B_i (1\n<= A_i <= N; 1 <= B_i <= N; A_i != B_i); it is possible to reach\nany barn from any other through the paths.\n\nBessie decides that it will be safest to hide in the barn that has\nthe greatest distance from barn 1 (the distance between two barns\nis the smallest number of paths that one must traverse to get from\none to the other). Help Bessie figure out the best barn in which\nto hide.", "inputFormat": "* Line 1: Two space-separated integers: N and M\n\n* Lines 2..M+1: Line i+1 contains the endpoints for path i: A_i and\n        B_i", "outputFormat": "* Line 1: On a single line, print three space-separated integers: the\n        index of the barn farthest from barn 1 (if there are multiple\n        such barns, print the smallest such index), the smallest\n        number of paths needed to reach this barn from barn 1, and the\n        number of barns with this number of paths.", "hint": "The farm layout is as follows:\n\n                   1--2--5\n                   | /|\n                   |/ |\n                   3--4\n                   |\n                   6\n\nBarns 4, 5, and 6 are all a distance of 2 from barn 1. We choose barn 4\nbecause it has the smallest index.", "locale": "en"}, "zh-CN": {"title": "[USACO09OPEN] Hide and Seek S", "background": null, "description": "奶牛贝西和农夫约翰（FJ）玩捉迷藏，现在有 $N$ 个谷仓，FJ开始在第一个谷仓，贝西为了不让FJ找到她，当然要藏在距离第一个谷仓最远的那个谷仓了。现在告诉你 $N$ 个谷仓，和 $M$ 个两两谷仓间的“无向边”。每两个仓谷间当然会有最短路径，现在要求距离第一个谷仓（FJ那里）最远的谷仓是哪个（所谓最远就是距离第一个谷仓最大的最短路径）？如有多个则输出编号最小的。以及求这最远距离是多少，和有几个这样的谷仓距离第一个谷仓那么远。", "inputFormat": "第一行：两个整数 $N$，$M$；\n\n\n第 $2-M+1$ 行：每行两个整数，表示端点 $A_i$ 和 $B_i$ 间有一条无向边。", "outputFormat": "仅一行，三个整数，两两中间空格隔开。表示：距离第一个谷仓最远的谷仓编号（如有多个则输出编号最小的），以及最远的距离，和有几个谷仓距离第一个谷仓那么远。", "hint": "农场的布局如下：\n\n ![](https://cdn.luogu.com.cn/upload/pic/2815.png) \n\n这里谷仓4，5，6距离1号谷仓都是2，但是4编号最小所以输出4.因此最远距离是2且有3个谷仓，依次输出：2和3。 \n\n$2\\le n\\le 50000,1\\le m\\le 50000$\n\n感谢 wjcwinmt 的贡献翻译", "locale": "zh-CN"}}}
{"pid": "P2952", "type": "P", "difficulty": 2, "samples": [["10 \nA L \nA L \nA R \nA L \nD R 2 \nA R \nA R \nD L 1 \nA L \nA R \n", "7 \n2 \n5 \n6 \n8 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "递推", "2009", "USACO", "队列"], "title": "[USACO09OPEN] Cow Line S", "background": "", "description": "Farmer John's N cows (conveniently numbered 1..N) are forming a line. The line begins with no cows and then, as time progresses, one by one, the cows join the line on the left or right side. Every once in a while, some number of cows on the left or right side of the line all leave the line to go graze in their favorite pasture.\n\nFJ has trouble keeping track of all the cows in the line. Please help him.\n\nThe cows enter the line in numerical order 1..N, and once a cow leaves the line she never re-enters it. Your program will be given S (1 <= S <= 100,000) input specifications; each appears on a single line and is one of two types:\n\n\\* A cow enters the line (a parameter indicates whether on the left or right).\n\n\\* K cows leave the line from the left or right side (supplied parameters define both the number of cows and which side).\n\nInput lines never request an operation that can not be performed.\n\nAfter all the input lines have been processed, your program should print the cows in the line in order from left to right. The final line is guaranteed to be non-empty at the end of the input specifications.", "inputFormat": "\\* Line 1: A single integer: S\n\n\\* Lines 2..S+1: Line i+1 contains specification i in one of four formats:\n\n\\* A L -- a cow arrives on the Left of the line\n\n\\* A R -- a cow arrives on the Right of the line\n\n\\* D L K -- K cows depart the Left side of the line\n\n\\* D R K -- K cows depart the Right side of the line", "outputFormat": "\\* Lines 1..??: Print the numbers of the cows in the line in order from left to right, one number per line.", "hint": "Input    Resulting Cow Line\n\nA L      1\n\nA L      2 1\n\nA R      2 1 3\n\nA L      4 2 1 3\n\nD R 2    4 2\n\nA R      4 2 5\n\nA R      4 2 5 6\n\nD L 1    2 5 6\n\nA L      7 2 5 6\n\nA R      7 2 5 6 8\n\n感谢@ ws\\_fuweidong  提供翻译。\n", "locale": "en", "translations": {"en": {"title": "[USACO09OPEN] Cow Line S", "background": "", "description": "Farmer John's N cows (conveniently numbered 1..N) are forming a line. The line begins with no cows and then, as time progresses, one by one, the cows join the line on the left or right side. Every once in a while, some number of cows on the left or right side of the line all leave the line to go graze in their favorite pasture.\n\nFJ has trouble keeping track of all the cows in the line. Please help him.\n\nThe cows enter the line in numerical order 1..N, and once a cow leaves the line she never re-enters it. Your program will be given S (1 <= S <= 100,000) input specifications; each appears on a single line and is one of two types:\n\n\\* A cow enters the line (a parameter indicates whether on the left or right).\n\n\\* K cows leave the line from the left or right side (supplied parameters define both the number of cows and which side).\n\nInput lines never request an operation that can not be performed.\n\nAfter all the input lines have been processed, your program should print the cows in the line in order from left to right. The final line is guaranteed to be non-empty at the end of the input specifications.", "inputFormat": "\\* Line 1: A single integer: S\n\n\\* Lines 2..S+1: Line i+1 contains specification i in one of four formats:\n\n\\* A L -- a cow arrives on the Left of the line\n\n\\* A R -- a cow arrives on the Right of the line\n\n\\* D L K -- K cows depart the Left side of the line\n\n\\* D R K -- K cows depart the Right side of the line", "outputFormat": "\\* Lines 1..??: Print the numbers of the cows in the line in order from left to right, one number per line.", "hint": "Input    Resulting Cow Line\n\nA L      1\n\nA L      2 1\n\nA R      2 1 3\n\nA L      4 2 1 3\n\nD R 2    4 2\n\nA R      4 2 5\n\nA R      4 2 5 6\n\nD L 1    2 5 6\n\nA L      7 2 5 6\n\nA R      7 2 5 6 8\n\n感谢@ ws\\_fuweidong  提供翻译。\n", "locale": "en"}, "zh-CN": {"title": "[USACO09OPEN] Cow Line S", "background": null, "description": "Farmer John（以下简称 FJ）的 $N$ 头奶牛（用 $1 \\dots N$ 编号）在直线上排队。一开始，这条线上没有任何奶牛，随着时间的推移，奶牛们会一个接一个地站到队伍的左边或右边。又过了一会儿，某些奶牛会从队伍里离开，去吃自己最喜欢的草料。\n\nFJ 无法跟踪每一头奶牛，于是，他想让你来帮助他。\n\n奶牛以 $1 \\dots N$ 的顺序排队，并且离开的奶牛不会再次回来。数据将会给出 $S$（$1 \\le S \\le 100000$） 条指令，各占一行，分两种：\n\n- $1$ 头奶牛加入了队列（还有一个参数，表示从左加入还是从右加入）；\n- $K$ 头奶牛从左边或者右边离开了队列（还有两个参数，分别表示从左离开还是从右离开和离开多少头奶牛）。\n\n输入的命令一定是可以执行的。\n\n所有的操作结束后，你的程序应该以从左到右的顺序输出这个奶牛队列。数据保证最后的队列不空。", "inputFormat": "- 第 $1$ 行：单独一个整数 $S$。\n- 第 $2 \\dots S+1$ 行：第 $i+1$ 行会有一条命令，有以下几种：\n  - `A L`：一头奶牛从队列左边加入；\n  - `A R`：一头奶牛从队列右边加入；\n  - `D L K`：$K$ 头奶牛从队伍左边离开；\n  - `D R K`：$K$ 头奶牛从队伍右边离开。", "outputFormat": "- 第 $1 \\dots ??$ 行：从左到右输出最后的奶牛队列，一个奶牛编号占一行。\n\n**【样例解释】**\n\n以下为输入的命令及对应的队列：\n\n- `A L`：$1$；\n- `A L`：$2,1$；\n- `A R`：$2,1,3$；\n- `A L`：$4,2,1,3$；\n- `D R 2`：$4,2$；\n- `A R`：$4,2,5$；\n- `A R`：$4,2,5,6$；\n- `D L 1`：$2,5,6$；\n- `A L`：$7,2,5,6$；\n- `A R`（最终序列）：$7,2,5,6,8$。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P2953", "type": "P", "difficulty": 4, "samples": [["2 \n9 \n10 \n", "YES \nNO \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "动态规划 DP", "博弈论", "2009", "USACO", "SG 函数"], "title": "[USACO09OPEN] Cow Digit Game S", "background": null, "description": "贝茜和约翰在玩一个数字游戏。贝茜需要你帮助她。\n\n游戏一共进行了 $G(1\\le G\\le100)$ 场。第 $i$ 场游戏开始于一个正整数 $N_i(1\\le N_i\\le 1\\,000\\,000)$。\n\n游戏规则是这样的：双方轮流操作，将当前的数字减去一个数，这个数可以是当前数字的最大数码，也可以是最小的非 $0$ 数码。比如当前的数是 $3014$，操作者可以减去 $1$ 变成 $3013$，也可以减去 $4$ 变成 $3010$。若干次操作之后，这个数字会变成 $0$。这时候不能再操作的一方为输家。贝茜总是先开始操作。如果贝茜和约翰都足够聪明，执行最好的策略。请你计算最后的赢家。\n\n比如，一场游戏开始于 $13$。贝茜将 $13$ 减去 $3$ 变成 $10$。约翰只能将 $10$ 减去 $1$ 变成 $9$。贝茜再将 $9$ 减去 $9$ 变成 $0$。最后贝茜赢。", "inputFormat": "第一行一个整数 $G$。\n\n第 $2$ 到第 $G+1$ 行，每行一个整数 $N_i$。", "outputFormat": "输出 $G$ 行，每行表示对于每个 $N_i$，若贝茜能赢则输出 `YES` 否则输出 `NO`。", "hint": "在第一个游戏中，贝茜只需减去 $9$ 便能胜利。在第二个游戏中，贝茜只能减去 $1$（因为她不能减去 $0$），然后农夫约翰只需减去减去 $9$ 便能胜利。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO09OPEN] Cow Digit Game S", "background": "", "description": "Bessie is playing a number game against Farmer John, and she wants you to help her win.\n\nGame $i$ starts with an integer $N_i$ ($1 \\le N_i \\le 1{,}000{,}000$). Bessie goes first, and then the two players alternate turns. On each turn, a player can subtract from the current number either its largest digit or its smallest nonzero digit to obtain a new number. For example, from $3014$ we may subtract either $1$ or $4$ to obtain either $3013$ or $3010$, respectively. The game continues until the number becomes $0$, at which point the last player to have taken a turn is the winner.\n\nBessie and FJ play $G$ ($1 \\le G \\le 100$) games. Determine, for each game, whether Bessie or FJ will win, assuming both play optimally (that is, on each turn, if the current player has a move that guarantees a win, they will take it).\n\nConsider a sample game where $N_i = 13$. Bessie goes first and takes $3$, leaving $10$. FJ is forced to take $1$, leaving $9$. Bessie takes the remainder and wins the game.", "inputFormat": "* Line 1: A single integer $G$.\n* Lines 2..$G+1$: Line $i+1$ contains the single integer $N_i$.", "outputFormat": "* Lines 1..$G$: Line $i$ contains 'YES' if Bessie can win game $i$, and 'NO' otherwise.", "hint": "For the first game, Bessie simply takes the number $9$ and wins. For the second game, Bessie must take $1$ (since she cannot take $0$), and then FJ can win by taking $9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO09OPEN] Cow Digit Game S", "background": null, "description": "贝茜和约翰在玩一个数字游戏。贝茜需要你帮助她。\n\n游戏一共进行了 $G(1\\le G\\le100)$ 场。第 $i$ 场游戏开始于一个正整数 $N_i(1\\le N_i\\le 1\\,000\\,000)$。\n\n游戏规则是这样的：双方轮流操作，将当前的数字减去一个数，这个数可以是当前数字的最大数码，也可以是最小的非 $0$ 数码。比如当前的数是 $3014$，操作者可以减去 $1$ 变成 $3013$，也可以减去 $4$ 变成 $3010$。若干次操作之后，这个数字会变成 $0$。这时候不能再操作的一方为输家。贝茜总是先开始操作。如果贝茜和约翰都足够聪明，执行最好的策略。请你计算最后的赢家。\n\n比如，一场游戏开始于 $13$。贝茜将 $13$ 减去 $3$ 变成 $10$。约翰只能将 $10$ 减去 $1$ 变成 $9$。贝茜再将 $9$ 减去 $9$ 变成 $0$。最后贝茜赢。", "inputFormat": "第一行一个整数 $G$。\n\n第 $2$ 到第 $G+1$ 行，每行一个整数 $N_i$。", "outputFormat": "输出 $G$ 行，每行表示对于每个 $N_i$，若贝茜能赢则输出 `YES` 否则输出 `NO`。", "hint": "在第一个游戏中，贝茜只需减去 $9$ 便能胜利。在第二个游戏中，贝茜只能减去 $1$（因为她不能减去 $0$），然后农夫约翰只需减去减去 $9$ 便能胜利。", "locale": "zh-CN"}}}
{"pid": "P2954", "type": "P", "difficulty": 4, "samples": [["5 10 \n2 \n8 \n1 \n3 \n9 \n", "4 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "递推", "2009", "USACO", "单调队列"], "title": "[USACO09OPEN] Grazing2 S", "background": "", "description": "Farmer John has N (2 <= N <= 1,500) prize milk cows conveniently numbered 1..N. His newly-painted barn has S (N <= S <= 1,000,000) stalls (conveniently numbered 1..S) in a single long line; each stall is a unit distance from its neighboring stall(s).\n\nThe cows have made their way to the stalls for a rest; cow i is in stall P\\_i. Antisocial as they are, the cows get grumpy if they are situated in stalls very close to each other, so Farmer John wants to move the cows to be as spread out as possible.\n\nFJ wants to make sure that the N - 1 distances between adjacent cows are as large as possible, and he would also like them to be similar to each other (i.e., close to equi-distant spacing).\n\nIn particular, FJ would like all distances between adjacent cows to be at most 1 different from (S - 1) / (N - 1), where integer division is used. Moreover, he would like as many of these distances as possible to be exactly equal to (S - 1) / (N - 1) [integer\n\ndivision]. Thus, with four cows and eight stalls, one can place the cows at positions 1, 3, 5, 8 or 1, 3, 6, 8 but not at 1, 2, 4, 7 or 1, 2, 4, 8.\n\nHelp FJ spread the cows as efficiently as possible by calculating and reporting the minimum total distance that the cows have to move in order to achieve proper spacing. Ignore the distance it takes for a cow to enter or exit a stall.\n\n约翰有N(2≤N≤1500)头奶牛，S(N≤S≤1,000,000)个一字排开的牛棚．相邻牛棚间的距离恰好为1．\n\n奶牛们已经回棚休息，第i只奶牛现在待在牛棚Pi．如果两只奶牛离得太近，会让奶牛们变得很暴躁．所以约翰想给一些奶牛换一个棚，让她们之间的距离变得尽量大，并且尽管接近．令d=Trunc((s-1)/(n-1))\n\n所以约翰希望最终的奶牛的状态是：两只相邻奶牛间的距离与d之差不超过1，而且让尽量多的间距等于d．因此，对于4只奶牛8个棚的情况，1，3，5，8或1，3，6，8这样的安置情况是允许的，而1，2，4，7或1，2，4，8这样的情况是不允许的．    帮助约翰移动奶牛，让所有奶牛的移动距离之和最小，同时让最终的安置情况符合约翰心意．\n", "inputFormat": "\\* Line 1: Two space-separated integers: N and S\n\n\\* Lines 2..N+1: Line i+1 contains the single integer: P\\_i\n", "outputFormat": "\\* Line 1: A single integer: the minimum total distance the cows have to travel. This number is guaranteed to be under 1,000,000,000 (thus fitting easily into a signed 32-bit integer).\n", "hint": "1   2   3   4   5   6   7   8   9  10\n\nCow Locs     | A | B | C | . | . | . | . | D | E | . | \n\nCows move from stall 2 to 3, 3 to 5, and 9 to 10. The total distance moved is 1 + 2 + 1 = 4. The final positions of the cows are in stalls 1, 3, 5, 8, and 10.\n\n1   2   3   4   5   6   7   8   9  10\n\nInit Stall     | A | B | C | . | . | . | . | D | E | . | \nFinal Stall    | A | . | B | . | C | . | . | D | . | E | \nDistance moved | 0 | . | 1 | . | 2 | . | . | 0 | . | 1 | ", "locale": "zh-CN", "translations": {"en": {"title": "[USACO09OPEN] Grazing2 S", "background": "", "description": "Farmer John has $N$ cows, numbered $1..N$, where $2 \\le N \\le 1500$. His newly painted barn has $S$ stalls in a single line, numbered $1..S$, where $N \\le S \\le 1{,}000{,}000$. Each pair of adjacent stalls is at distance $1$.\n\nThe cows have already gone to rest; cow $i$ is currently in stall $P_i$. Since cows get grumpy when they are too close together, Farmer John wants to move them so they are as spread out as possible and with similar gaps.\n\nLet $d = \\left\\lfloor \\frac{S - 1}{N - 1} \\right\\rfloor$ (integer division). Farmer John wants the $N - 1$ distances between adjacent cows to each differ from $d$ by at most $1$, and he also wants to maximize the number of these distances that are exactly equal to $d$.\n\nFor example, with $4$ cows and $8$ stalls, placements $1, 3, 5, 8$ and $1, 3, 6, 8$ are allowed, but $1, 2, 4, 7$ and $1, 2, 4, 8$ are not allowed.\n\nHelp Farmer John spread the cows as efficiently as possible by computing the minimum total distance the cows must move to achieve such spacing. Ignore the distance for entering or leaving a stall.", "inputFormat": "- Line 1: Two space-separated integers $N$ and $S$.\n- Lines $2..N+1$: Line $i+1$ contains a single integer $P_i$.", "outputFormat": "- Line 1: A single integer — the minimum total distance the cows must travel. This value is guaranteed to be less than $1{,}000{,}000{,}000$.", "hint": "1   2   3   4   5   6   7   8   9  10\nCow Locs     | A | B | C | . | . | . | . | D | E | . |\n\nCows move from stall 2 to 3, 3 to 5, and 9 to 10. The total distance moved is 1 + 2 + 1 = 4. The final positions of the cows are in stalls 1, 3, 5, 8, and 10.\n\n1   2   3   4   5   6   7   8   9  10\nInit Stall     | A | B | C | . | . | . | . | D | E | . |\nFinal Stall    | A | . | B | . | C | . | . | D | . | E |\nDistance moved | 0 | . | 1 | . | 2 | . | . | 0 | . | 1 |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO09OPEN] Grazing2 S", "background": "", "description": "Farmer John has N (2 <= N <= 1,500) prize milk cows conveniently numbered 1..N. His newly-painted barn has S (N <= S <= 1,000,000) stalls (conveniently numbered 1..S) in a single long line; each stall is a unit distance from its neighboring stall(s).\n\nThe cows have made their way to the stalls for a rest; cow i is in stall P\\_i. Antisocial as they are, the cows get grumpy if they are situated in stalls very close to each other, so Farmer John wants to move the cows to be as spread out as possible.\n\nFJ wants to make sure that the N - 1 distances between adjacent cows are as large as possible, and he would also like them to be similar to each other (i.e., close to equi-distant spacing).\n\nIn particular, FJ would like all distances between adjacent cows to be at most 1 different from (S - 1) / (N - 1), where integer division is used. Moreover, he would like as many of these distances as possible to be exactly equal to (S - 1) / (N - 1) [integer\n\ndivision]. Thus, with four cows and eight stalls, one can place the cows at positions 1, 3, 5, 8 or 1, 3, 6, 8 but not at 1, 2, 4, 7 or 1, 2, 4, 8.\n\nHelp FJ spread the cows as efficiently as possible by calculating and reporting the minimum total distance that the cows have to move in order to achieve proper spacing. Ignore the distance it takes for a cow to enter or exit a stall.\n\n约翰有N(2≤N≤1500)头奶牛，S(N≤S≤1,000,000)个一字排开的牛棚．相邻牛棚间的距离恰好为1．\n\n奶牛们已经回棚休息，第i只奶牛现在待在牛棚Pi．如果两只奶牛离得太近，会让奶牛们变得很暴躁．所以约翰想给一些奶牛换一个棚，让她们之间的距离变得尽量大，并且尽管接近．令d=Trunc((s-1)/(n-1))\n\n所以约翰希望最终的奶牛的状态是：两只相邻奶牛间的距离与d之差不超过1，而且让尽量多的间距等于d．因此，对于4只奶牛8个棚的情况，1，3，5，8或1，3，6，8这样的安置情况是允许的，而1，2，4，7或1，2，4，8这样的情况是不允许的．    帮助约翰移动奶牛，让所有奶牛的移动距离之和最小，同时让最终的安置情况符合约翰心意．\n", "inputFormat": "\\* Line 1: Two space-separated integers: N and S\n\n\\* Lines 2..N+1: Line i+1 contains the single integer: P\\_i\n", "outputFormat": "\\* Line 1: A single integer: the minimum total distance the cows have to travel. This number is guaranteed to be under 1,000,000,000 (thus fitting easily into a signed 32-bit integer).\n", "hint": "1   2   3   4   5   6   7   8   9  10\n\nCow Locs     | A | B | C | . | . | . | . | D | E | . | \n\nCows move from stall 2 to 3, 3 to 5, and 9 to 10. The total distance moved is 1 + 2 + 1 = 4. The final positions of the cows are in stalls 1, 3, 5, 8, and 10.\n\n1   2   3   4   5   6   7   8   9  10\n\nInit Stall     | A | B | C | . | . | . | . | D | E | . | \nFinal Stall    | A | . | B | . | C | . | . | D | . | E | \nDistance moved | 0 | . | 1 | . | 2 | . | . | 0 | . | 1 | ", "locale": "zh-CN"}}}
{"pid": "P2955", "type": "P", "difficulty": 1, "samples": [["2 \n1024 \n5931 \n", "even \nodd \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2009", "USACO"], "title": "[USACO09OCT] Even? Odd? G", "background": null, "description": "Bessie那惨无人道的二年级老师搞了一个有 $N$ 个正整数 $I$ 的表叫Bessie去判断“奇偶性”（这个词语意思向二年级的学生解释，就是“这个数是单数，还是双数啊？”）。Bessie被那个表的长度深深地震惊到了，竟然跟栋栋的泛做表格一样多道题！！！毕竟她才刚刚学会数数啊。\n\n写一个程序读入 $N$ 个整数，如果是双数，那么在单立的一行内输出 `even`，如果是单数则类似地输出 `odd`。", "inputFormat": "第一行：一个整数 $N$\n\n接下来 $N$ 行：第 $j$ 行一个整数 $l_j$，表示用于确定奇数或偶数的第 $j$ 个整数", "outputFormat": "一共 $N$ 行：第 $j$ 行包含单词 `even` 或 `odd` ，具体取决于 $l_j$ 的奇偶性", "hint": "**【样例解释】**\n\n两个整数：$1024\\text{ 和 }5931$\n\n$1024$ 可被 $2$ 整除，$5931$ 不能\n\n**【数据范围】**\n\n$1\\le N \\le 100，1\\le l_j \\le 10^{60}$", "locale": "zh-CN", "translations": {"en": {"title": "[USACO09OCT] Even? Odd? G", "background": "", "description": "Bessie's ruthless second-grade teacher gave her a list with $N$ positive integers $I$ and asked her to determine their \"parity\" (explained to a second grader as \"is the number odd or even?\"). Bessie was shocked by how long the list was—there were as many items as on Dongdong's repetitive worksheets! After all, she has only just learned to count.\n\nWrite a program that reads $N$ integers. If a number is even, output `even` on a separate line; if it is odd, similarly output `odd`.", "inputFormat": "The first line contains an integer $N$.\n\nThe next $N$ lines: the $j$-th line contains an integer $l_j$, which is the $j$-th integer to determine as odd or even.", "outputFormat": "A total of $N$ lines: the $j$-th line contains the word `even` or `odd`, depending on the parity of $l_j$.", "hint": "Sample Explanation:\n\nTwo integers: $1024\\text{ 和 }5931$.\n\n$1024$ is divisible by $2$, $5931$ is not.\n\nConstraints:\n\n$1\\le N \\le 100，1\\le l_j \\le 10^{60}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO09OCT] Even? Odd? G", "background": null, "description": "Bessie那惨无人道的二年级老师搞了一个有 $N$ 个正整数 $I$ 的表叫Bessie去判断“奇偶性”（这个词语意思向二年级的学生解释，就是“这个数是单数，还是双数啊？”）。Bessie被那个表的长度深深地震惊到了，竟然跟栋栋的泛做表格一样多道题！！！毕竟她才刚刚学会数数啊。\n\n写一个程序读入 $N$ 个整数，如果是双数，那么在单立的一行内输出 `even`，如果是单数则类似地输出 `odd`。", "inputFormat": "第一行：一个整数 $N$\n\n接下来 $N$ 行：第 $j$ 行一个整数 $l_j$，表示用于确定奇数或偶数的第 $j$ 个整数", "outputFormat": "一共 $N$ 行：第 $j$ 行包含单词 `even` 或 `odd` ，具体取决于 $l_j$ 的奇偶性", "hint": "**【样例解释】**\n\n两个整数：$1024\\text{ 和 }5931$\n\n$1024$ 可被 $2$ 整除，$5931$ 不能\n\n**【数据范围】**\n\n$1\\le N \\le 100，1\\le l_j \\le 10^{60}$", "locale": "zh-CN"}}}
{"pid": "P2956", "type": "P", "difficulty": 1, "samples": [["6 4 2 \n1 1 2 4 \n1 3 5 4 \n", "14 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2009", "USACO"], "title": "[USACO09OCT] The Robot Plow G", "background": null, "description": "农夫约翰购买了一台新的自动耕地机器人，以将自己从日复一日犁地的繁重劳动中解脱出来。这台机器人确实能完成耕地任务，但有一个小缺点：它只能犁出各边长度均为整数的完美矩形地块。\n\n由于约翰的田地中分布着树木和其他障碍物，他需要设定机器人犁耕多个不同的矩形区域，这些区域可能会有重叠。他很好奇，在按照各种耕地指令（每个指令通过给出矩形的左下角和右上角 x、y 坐标来描述）编程后，田地里实际被犁过的方格数量究竟有多少。\n\n和往常一样，田地被划分为若干方格，这些方格的边与 x 轴和 y 轴平行。整块田地的宽度为 $X$ 个方格，高度为 $Y$ 个方格 $1\\le X,Y \\le 240)$。共有 $I$ 条耕地指令 $(1\\le I \\le 200)$，每条指令包含四个整数：$Xll、Yll、Xur \\text{ 和 } Yur\\text{ (}1 \\le Xll \\le Xur \\le X;1 \\le Yll \\le Yur \\le Y）$，分别表示待犁矩形的左下角和右上角坐标。机器人会犁耕区间 $(Xll \\dots Xur, Yll \\dots Yur)$ 内的所有田地方格——根据不同的理解方式，这个区间可能比初始设想的多一行或一列（当然，具体取决于你如何理解）。\n\n以一块宽 6 格、高 4 格的田地为例。当约翰发出两条耕地指令（如下所示）时，田地的犁耕情况如 `*` 和 `#` 所示（通常犁过的田地看起来相同，这里用 `#` 表示最近犁过的区域）：\n\n```\n......             **....             #####. \n......  (1,1)(2,4) **....  (1,3)(5,4) #####. \n......             **....             **.... \n......             **....             **....\n```\n最终共有 14 个方格被犁过。\n\n得分：25 分", "inputFormat": "共 $I+1$ 行\n\n第一行，三个空格分隔的整数：$X、Y\\text{ 和 }I$\n\n第二行到第 $I+1$ 行：第 $i+1$ 行包含第 $i$ 条耕地指令，由四个整数描述：$Xll、Yll、Xur \\text{ 和 } Yur$", "outputFormat": "一行，一个整数，表示被犁过的方格总数", "hint": "正如任务示例中所示", "locale": "zh-CN", "translations": {"en": {"title": "[USACO09OCT] The Robot Plow G", "background": "", "description": "Farmer John bought a new automatic plowing robot to free himself from the daily hard work of plowing. The robot can indeed do the job, but with a small limitation: it can only plow perfect rectangular areas whose side lengths are integers.\n\nBecause there are trees and other obstacles scattered around the field, John needs to instruct the robot to plow several different rectangular regions, which may overlap. He is curious how many grid cells will actually be plowed after programming the robot with various instructions (each instruction is described by the lower-left and upper-right $x, y$ coordinates of a rectangle).\n\nAs usual, the field is divided into unit grid cells whose edges are parallel to the $x$- and $y$-axes. The whole field is $X$ cells wide and $Y$ cells high ($1 \\le X, Y \\le 240$). There are $I$ plowing instructions ($1 \\le I \\le 200$). Each instruction consists of four integers: $Xll, Yll, Xur$ and $Yur$ ($1 \\le Xll \\le Xur \\le X; 1 \\le Yll \\le Yur \\le Y$), representing the coordinates of the lower-left and upper-right corners of the rectangle to be plowed. The robot will plow all grid cells in the rectangle $(Xll \\dots Xur, Yll \\dots Yur)$—depending on how you interpret it, this might include one more row or column than you initially expect (of course, that depends on your interpretation).\n\nFor example, consider a field that is 6 cells wide and 4 cells high. When John issues two plowing instructions (as shown below), the plowed area is indicated by `*` and `#` (usually the plowed area looks the same; here `#` marks the most recently plowed area):\n\n```\n......             **....             #####. \n......  (1,1)(2,4) **....  (1,3)(5,4) #####. \n......             **....             **.... \n......             **....             **....\n```\nIn the end, 14 cells are plowed.\n\nScore: 25 points.", "inputFormat": "A total of $I+1$ lines.\n\n- The first line contains three space-separated integers: $X, Y$ and $I$.\n- Lines 2 through $I+1$: line $i+1$ contains the $i$-th plowing instruction, described by four integers: $Xll, Yll, Xur$ and $Yur$.", "outputFormat": "One line with a single integer, the total number of cells that are plowed.", "hint": "As shown in the example in the statement.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO09OCT] The Robot Plow G", "background": null, "description": "农夫约翰购买了一台新的自动耕地机器人，以将自己从日复一日犁地的繁重劳动中解脱出来。这台机器人确实能完成耕地任务，但有一个小缺点：它只能犁出各边长度均为整数的完美矩形地块。\n\n由于约翰的田地中分布着树木和其他障碍物，他需要设定机器人犁耕多个不同的矩形区域，这些区域可能会有重叠。他很好奇，在按照各种耕地指令（每个指令通过给出矩形的左下角和右上角 x、y 坐标来描述）编程后，田地里实际被犁过的方格数量究竟有多少。\n\n和往常一样，田地被划分为若干方格，这些方格的边与 x 轴和 y 轴平行。整块田地的宽度为 $X$ 个方格，高度为 $Y$ 个方格 $1\\le X,Y \\le 240)$。共有 $I$ 条耕地指令 $(1\\le I \\le 200)$，每条指令包含四个整数：$Xll、Yll、Xur \\text{ 和 } Yur\\text{ (}1 \\le Xll \\le Xur \\le X;1 \\le Yll \\le Yur \\le Y）$，分别表示待犁矩形的左下角和右上角坐标。机器人会犁耕区间 $(Xll \\dots Xur, Yll \\dots Yur)$ 内的所有田地方格——根据不同的理解方式，这个区间可能比初始设想的多一行或一列（当然，具体取决于你如何理解）。\n\n以一块宽 6 格、高 4 格的田地为例。当约翰发出两条耕地指令（如下所示）时，田地的犁耕情况如 `*` 和 `#` 所示（通常犁过的田地看起来相同，这里用 `#` 表示最近犁过的区域）：\n\n```\n......             **....             #####. \n......  (1,1)(2,4) **....  (1,3)(5,4) #####. \n......             **....             **.... \n......             **....             **....\n```\n最终共有 14 个方格被犁过。\n\n得分：25 分", "inputFormat": "共 $I+1$ 行\n\n第一行，三个空格分隔的整数：$X、Y\\text{ 和 }I$\n\n第二行到第 $I+1$ 行：第 $i+1$ 行包含第 $i$ 条耕地指令，由四个整数描述：$Xll、Yll、Xur \\text{ 和 } Yur$", "outputFormat": "一行，一个整数，表示被犁过的方格总数", "hint": "正如任务示例中所示", "locale": "zh-CN"}}}
{"pid": "P2957", "type": "P", "difficulty": 2, "samples": [["abcxxxxabcxabcd \nabcdxabcxxxxabcx \n", "11 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "2009", "USACO", "哈希 hashing", "前缀和"], "title": "[USACO09OCT] Barn Echoes G", "background": null, "description": "奶牛们非常享受在牛栏中哞叫，因为她们可以听到她们哞声的回音。虽然有时候并不能完全听到完整的回音。Bessie 曾经是一个出色的秘书，所以她精确地纪录了所有的哞叫声及其回声。她很好奇到底两个声音的重复部分有多长。\n\n输入两个字符串（长度为 $1$ 到 $80$ 个字母），表示两个哞叫声。你要确定最长的重复部分的长度。两个字符串的重复部分指的是同时是一个字符串的前缀和另一个字符串的后缀的字符串。\n\n我们通过一个例子来理解题目。考虑下面的两个哞声：\n\n```\nmoyooyoxyzooo\nyzoooqyasdfljkamo\n```\n\n第一个串的最后的部分 `yzooo` 跟第二个串的第一部分重复。第二个串的最后的部分 `mo` 跟第一个串的第一部分重复。所以 `yzooo` 跟 `mo` 都是这 $2$ 个串的重复部分。其中，`yzooo` 比较长，所以最长的重复部分的长度就是 $5$。", "inputFormat": "两行字符串，表示一只奶牛的哞叫声及其回声。", "outputFormat": "一行一个整数，表示两个声音的重复部分有多长。", "hint": "“abcxxxxabcx”是两个字符串的重复部分（第一个字符串的前缀和第二个字符串的后缀），所以答案为 $11$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO09OCT] Barn Echoes G", "background": "", "description": "The cows enjoy mooing at the barn because their moos echo back, although sometimes not completely. Bessie, ever the excellent\n\nsecretary, has been recording the exact wording of the moo as it goes out and returns. She is curious as to just how much overlap there is.\n\nGiven two lines of input (letters from the set a..z, total length in the range 1..80), each of which has the wording of a moo on it, determine the greatest number of characters of overlap between one string and the other. A string is an overlap between two other strings if it is a prefix of one string and a suffix of the other string.\n\nBy way of example, consider two moos:\n\n```\nmoyooyoxyzooo\nyzoooqyasdfljkamo\n```\nThe last part of the first string overlaps 'yzooo' with the first part of the second string. The last part of the second string\n\noverlaps 'mo' with the first part of the first string. The largest overlap is 'yzooo' whose length is 5.\n\nPOINTS: 50", "inputFormat": "\\* Lines 1..2: Each line has the text of a moo or its echo", "outputFormat": "\\* Line 1: A single line with a single integer that is the length of the longest overlap between the front of one string and end of the other.\n", "hint": "'abcxxxxabcx' is a prefix of the first string and a suffix of the second string.\n", "locale": "en"}, "zh-CN": {"title": "[USACO09OCT] Barn Echoes G", "background": null, "description": "奶牛们非常享受在牛栏中哞叫，因为她们可以听到她们哞声的回音。虽然有时候并不能完全听到完整的回音。Bessie 曾经是一个出色的秘书，所以她精确地纪录了所有的哞叫声及其回声。她很好奇到底两个声音的重复部分有多长。\n\n输入两个字符串（长度为 $1$ 到 $80$ 个字母），表示两个哞叫声。你要确定最长的重复部分的长度。两个字符串的重复部分指的是同时是一个字符串的前缀和另一个字符串的后缀的字符串。\n\n我们通过一个例子来理解题目。考虑下面的两个哞声：\n\n```\nmoyooyoxyzooo\nyzoooqyasdfljkamo\n```\n\n第一个串的最后的部分 `yzooo` 跟第二个串的第一部分重复。第二个串的最后的部分 `mo` 跟第一个串的第一部分重复。所以 `yzooo` 跟 `mo` 都是这 $2$ 个串的重复部分。其中，`yzooo` 比较长，所以最长的重复部分的长度就是 $5$。", "inputFormat": "两行字符串，表示一只奶牛的哞叫声及其回声。", "outputFormat": "一行一个整数，表示两个声音的重复部分有多长。", "hint": "“abcxxxxabcx”是两个字符串的重复部分（第一个字符串的前缀和第二个字符串的后缀），所以答案为 $11$。", "locale": "zh-CN"}}}
{"pid": "P2958", "type": "P", "difficulty": 2, "samples": [["3 4 \n3 3 4 5 \n4 5 3 2 \n1 7 4 2 \n", "39 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2009", "USACO"], "title": "[USACO09OCT] Papaya Jungle G", "background": "", "description": "Bessie 不小心游荡出 Farmer John 的田地，而走进了相邻的农民的地里。她举起一个木瓜，木瓜对奶牛来说可是不可多得的美味。这个木瓜林像一般的威斯康星州的田地一样被分割成一个 $R$ 行 $C$ 列的网格 $(1 \\le R,C \\le 40)$。Bessie 可以从一个格沿着一条跟 X 轴或 Y 轴平行的直线走到邻接的另一个格。Bessie 发现一开始她自己在木瓜林的 $(1,1)$，也就是第一行第一列慢悠悠地咀嚼着木瓜。\n\nBessie 总是用她最信赖地双筒望远镜去数每一个邻接的格里挂着的木瓜的数目。然后她就游荡到那个有最多没有被吃掉的木瓜的邻接的格子（保证这样的格子只有一个）。\n\n按照这种移动方法，最终 Bessie 总是会在 $(R,C)$ 停止然后吃掉那里的木瓜。\n\n给定这个木瓜林的大小及每个格的木瓜数 $F_{ij}(1 \\le F_{ij} \\le 100)$，求 Bessie 一共吃了多少个木瓜。", "inputFormat": "第一行：两个用空格分割的整数 $R$ 和 $C$。\n\n接下来 $R$ 行：第 $i+1$ 行用 $C$ 个用空格分隔的整数描述丛林的第 $i$ 行 $F_{i1},F_{i2},\\dots,F_{iC}$。", "outputFormat": "第一行：一个整数，表示 Bessie 在坐标 $(R,C)$ 的右下角谷仓吃完木瓜时吃的木瓜总数。", "hint": "Bessie 按照下面的顺序吃木瓜：\n\n![顺序](https://cdn.luogu.com.cn/upload/image_hosting/uagjs0wr.png)", "locale": "zh-CN", "translations": {"en": {"title": "[USACO09OCT] Papaya Jungle G", "background": "", "description": "Bessie has accidentally wandered out of Farmer John’s field and into a neighboring farmer’s land. She picks up a papaya—papayas are a rare delicacy for cows. Like typical fields in Wisconsin, this papaya grove is partitioned into a grid of $R$ rows and $C$ columns ($1 \\le R, C \\le 40$). Bessie can move from one cell to an adjacent cell along a straight line parallel to the X-axis or Y-axis. She finds herself starting in the papaya grove at $(1, 1)$, the first row and first column, leisurely chewing on a papaya.\n\nBessie always uses her trusty binoculars to count the number of papayas hanging in each adjacent cell. Then she wanders to the adjacent cell that has the most papayas that have not yet been eaten (this cell is guaranteed to be unique).\n\nFollowing this movement rule, Bessie will eventually stop at $(R, C)$ and eat the papayas there.\n\nGiven the size of the papaya grove and the number of papayas in each cell $F_{ij}$ ($1 \\le F_{ij} \\le 100$), determine the total number of papayas Bessie eats.", "inputFormat": "Line 1: two integers $R$ and $C$ separated by a space.\n\nThe next $R$ lines: the $(i + 1)$-th line describes row $i$ of the grove with $C$ space-separated integers $F_{i1}, F_{i2}, \\dots, F_{iC}$.", "outputFormat": "Line 1: a single integer, the total number of papayas Bessie eats by the time she finishes at the barn in the bottom-right corner at coordinates $(R, C)$.", "hint": "Bessie eats the papayas in the following order:\n\n![顺序](https://cdn.luogu.com.cn/upload/image_hosting/uagjs0wr.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO09OCT] Papaya Jungle G", "background": "", "description": "Bessie 不小心游荡出 Farmer John 的田地，而走进了相邻的农民的地里。她举起一个木瓜，木瓜对奶牛来说可是不可多得的美味。这个木瓜林像一般的威斯康星州的田地一样被分割成一个 $R$ 行 $C$ 列的网格 $(1 \\le R,C \\le 40)$。Bessie 可以从一个格沿着一条跟 X 轴或 Y 轴平行的直线走到邻接的另一个格。Bessie 发现一开始她自己在木瓜林的 $(1,1)$，也就是第一行第一列慢悠悠地咀嚼着木瓜。\n\nBessie 总是用她最信赖地双筒望远镜去数每一个邻接的格里挂着的木瓜的数目。然后她就游荡到那个有最多没有被吃掉的木瓜的邻接的格子（保证这样的格子只有一个）。\n\n按照这种移动方法，最终 Bessie 总是会在 $(R,C)$ 停止然后吃掉那里的木瓜。\n\n给定这个木瓜林的大小及每个格的木瓜数 $F_{ij}(1 \\le F_{ij} \\le 100)$，求 Bessie 一共吃了多少个木瓜。", "inputFormat": "第一行：两个用空格分割的整数 $R$ 和 $C$。\n\n接下来 $R$ 行：第 $i+1$ 行用 $C$ 个用空格分隔的整数描述丛林的第 $i$ 行 $F_{i1},F_{i2},\\dots,F_{iC}$。", "outputFormat": "第一行：一个整数，表示 Bessie 在坐标 $(R,C)$ 的右下角谷仓吃完木瓜时吃的木瓜总数。", "hint": "Bessie 按照下面的顺序吃木瓜：\n\n![顺序](https://cdn.luogu.com.cn/upload/image_hosting/uagjs0wr.png)", "locale": "zh-CN"}}}
{"pid": "P2959", "type": "P", "difficulty": 2, "samples": [["10 \n7 8 0 \n5 0 6 \n9 0 0 \n6 0 7 \n3 4 0 \n2 5 0 \n8 0 9 \n4 0 0 \n1 2 3 \n", "7 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2009", "USACO"], "title": "[USACO09OCT] The Leisurely Stroll G", "background": null, "description": "Bessie 通过牛棚的大门向外望去，发现今天是一个美丽的春季早晨。她想，“我真的好想好想沐浴着春风，走在草地之中，感受嫩草温柔地抚摸四蹄的感觉。”她知道一旦她离开了牛棚，她将沿着一条小径走一段路，然后就会出现一个三岔路口，她必须在两条小径中选择一条继续走下去。然后她又会遇到更多的三岔路口，进行更多的选择，直到她到达一个青翠的牧场为止。\n\n她决定作一个选择使得她在去吃早草的路途中可以走过最多的小径。给你这些小径的描述，求出 Bessie 最多可以走过多少条小径。假定 Bessie 一出牛棚就有 $2$ 条路径，Bessie 需要从中选择一条。\n\n农场中有 $P-1$（$1 \\le P \\le 1000$）个分岔节点（范围是 $1 \\ldots P-1$），引向 $P$ 片草地，它们之间由小径连接。对任意一个节点来说，只有一条从牛棚（被标记为节点 $1$）开始的路径可以到达。\n\n考虑下面的图。线段表示小径，`%` 表示草地。右边的图中的 `#` 表示一条到达草地的高亮的路径。\n\n```plain\n\n                 %                             %\n                /                             /\n      2----%   7----8----%          2----%   7####8----%\n     / \\      /      \\             # #      #      #\n    1   5----6        9----%      1   5####6        9----%\n     \\   \\    \\        \\           \\   \\    \\        #\n      \\   %    %        %           \\   %    %        %\n       \\                             \\\n        3-----%                       3-----%\n         \\                             \\\n          4----%                        4----%\n           \\                             \\\n            %                             %\n```\n\n从分岔节点 $9$ 到达的草地是两个可以让 Bessie 走过最多小径的草地之一。在去吃早草的路上 Bessie 将走过 $7$ 条不同的小径。这些草地是离牛棚也就是节点 $1$ 最“远”的。\n\n由 $3$ 个整数来表示每一个节点：$C,D_1,D_2$，$C$ 是节点的编号（$1 \\le C < P$），$D_1$ 和 $D_2$ 是由该节点引出的两条小径的终点（$0 \\le D_1,D_2 < P$）。如果 $D_1$ 为 $0$，表示这条小径引向的是一片牧草地，$D_2$ 也一样。", "inputFormat": "第一行，一个正整数 $P$。\n\n以下 $P-1$ 行，每行 $3$ 个整数 $C,D_1,D_2$ 表示一个节点。", "outputFormat": "输出一行一个整数，代表 Bessie 可以经过最多节点数。", "hint": "输入即题目描述中的地图。\n\n`1-2-5-6-7-8-9-草地` 是最长路径之一。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO09OCT] The Leisurely Stroll G", "background": "", "description": "Bessie looks out of the barn door and sees a beautiful spring morning. She thinks, \"I really, really want to stroll through the meadow in the spring breeze and feel the tender grass gently brushing my hooves.\" She knows that once she leaves the barn, she will follow a trail for a while and then reach a fork with two choices. She will keep encountering more forks and making more choices until she reaches a lush pasture.\n\nShe decides to choose a route that lets her walk through as many trails as possible on her way to breakfast. Given the description of these trails, compute the maximum number of trails Bessie can traverse. Assume that right outside the barn there are $2$ outgoing trails, and Bessie must choose one of them.\n\nThere are $P-1$ ($1 \\le P \\le 1000$) branching nodes (numbered $1 \\ldots P-1$) leading to $P$ pastures, connected by trails. For any node, there is exactly one path starting from the barn (which is labeled node $1$) that reaches it.\n\nConsider the figure below. Line segments represent trails, and `%` represents a pasture. In the figure on the right, `#` highlights a path to a pasture.\n\n```plain\n\n                 %                             %\n                /                             /\n      2----%   7----8----%          2----%   7####8----%\n     / \\      /      \\             # #      #      #\n    1   5----6        9----%      1   5####6        9----%\n     \\   \\    \\        \\           \\   \\    \\        #\n      \\   %    %        %           \\   %    %        %\n       \\                             \\\n        3-----%                       3-----%\n         \\                             \\\n          4----%                        4----%\n           \\                             \\\n            %                             %\n```\n\nThe pasture reached from branching node $9$ is one of the two pastures that allow Bessie to traverse the most trails. On the way to breakfast, Bessie will traverse $7$ distinct trails. These pastures are the \"farthest\" from the barn, i.e., node $1$.\n\nEach node is described by three integers $C, D_1, D_2$. Here, $C$ is the node label ($1 \\le C < P$), and $D_1$ and $D_2$ are the endpoints of the two outgoing trails from node $C$ ($0 \\le D_1, D_2 < P$). If $D_1$ is $0$, that trail leads to a pasture; the same applies to $D_2$.", "inputFormat": "The first line contains a single integer $P$.\n\nEach of the following $P-1$ lines contains three integers $C, D_1, D_2$ describing one node.", "outputFormat": "Output a single integer: the maximum number of trails (edges) Bessie can traverse.", "hint": "The input is exactly the map shown in the Description.\n\n1-2-5-6-7-8-9-pasture is one of the longest paths.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO09OCT] The Leisurely Stroll G", "background": null, "description": "Bessie 通过牛棚的大门向外望去，发现今天是一个美丽的春季早晨。她想，“我真的好想好想沐浴着春风，走在草地之中，感受嫩草温柔地抚摸四蹄的感觉。”她知道一旦她离开了牛棚，她将沿着一条小径走一段路，然后就会出现一个三岔路口，她必须在两条小径中选择一条继续走下去。然后她又会遇到更多的三岔路口，进行更多的选择，直到她到达一个青翠的牧场为止。\n\n她决定作一个选择使得她在去吃早草的路途中可以走过最多的小径。给你这些小径的描述，求出 Bessie 最多可以走过多少条小径。假定 Bessie 一出牛棚就有 $2$ 条路径，Bessie 需要从中选择一条。\n\n农场中有 $P-1$（$1 \\le P \\le 1000$）个分岔节点（范围是 $1 \\ldots P-1$），引向 $P$ 片草地，它们之间由小径连接。对任意一个节点来说，只有一条从牛棚（被标记为节点 $1$）开始的路径可以到达。\n\n考虑下面的图。线段表示小径，`%` 表示草地。右边的图中的 `#` 表示一条到达草地的高亮的路径。\n\n```plain\n\n                 %                             %\n                /                             /\n      2----%   7----8----%          2----%   7####8----%\n     / \\      /      \\             # #      #      #\n    1   5----6        9----%      1   5####6        9----%\n     \\   \\    \\        \\           \\   \\    \\        #\n      \\   %    %        %           \\   %    %        %\n       \\                             \\\n        3-----%                       3-----%\n         \\                             \\\n          4----%                        4----%\n           \\                             \\\n            %                             %\n```\n\n从分岔节点 $9$ 到达的草地是两个可以让 Bessie 走过最多小径的草地之一。在去吃早草的路上 Bessie 将走过 $7$ 条不同的小径。这些草地是离牛棚也就是节点 $1$ 最“远”的。\n\n由 $3$ 个整数来表示每一个节点：$C,D_1,D_2$，$C$ 是节点的编号（$1 \\le C < P$），$D_1$ 和 $D_2$ 是由该节点引出的两条小径的终点（$0 \\le D_1,D_2 < P$）。如果 $D_1$ 为 $0$，表示这条小径引向的是一片牧草地，$D_2$ 也一样。", "inputFormat": "第一行，一个正整数 $P$。\n\n以下 $P-1$ 行，每行 $3$ 个整数 $C,D_1,D_2$ 表示一个节点。", "outputFormat": "输出一行一个整数，代表 Bessie 可以经过最多节点数。", "hint": "输入即题目描述中的地图。\n\n`1-2-5-6-7-8-9-草地` 是最长路径之一。", "locale": "zh-CN"}}}
{"pid": "P2960", "type": "P", "difficulty": 3, "samples": [["4 3 1 1 \n.... \n..*. \n.**. \n", "4 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2009", "USACO"], "title": "[USACO09OCT] Invasion of the Milkweed G", "background": "", "description": "Farmer John has always done his best to keep the pastures full of luscious, delicious healthy grass for the cows. He has lost the battle, though, as the evil milkweed has attained a foothold in the northwest part of his farm.\n\nThe pasture, as usual, is partitioned into a rectilinear grid of height Y (1 <= Y <= 100) and width X (1 <= X <= 100) with (1,1) being in the lower left corner (i.e., arranged as a normal X,Y coordinate grid). The milkweed has initially begun growing at square (Mx,My). Each week the milkweed propagates to all non-rocky squares that surround any square it already occupies, as many as eight more squares (both the rectilinear squares and the diagonals). After only one week in those squares, it is ready to move on to more squares.\n\nBessie wants to enjoy all the grass she can before the pastures are taken over by milkweed. She wonders how long it can last. If the milkweed is in square (Mx,My) at time zero, at what time does it complete its invasion of the pasture (which, for the given input data, will always happen)?\n\nThe pasture is described by a picture with '.'s for grass and '\\*'s for boulders, like this example with X=4 and Y=3:\n\n```\n....\n..*.\n.**.\n```\n\nIf the milkweed started in the lower left corner (row=1, column=1), then the map would progress like this:\n\n```\n    ....  ....  MMM.  MMMM  MMMM\n    ..*.  MM*.  MM*.  MM*M  MM*M\n    M**.  M**.  M**.  M**.  M**M\nweek  0    1    2    3    4\n```\n\nThe milkweed has taken over the entire field after 4 weeks.", "inputFormat": "\\* Line 1: Four space-separated integers: X, Y, Mx, and My\n\n\\* Lines 2..Y+1: Line y+1 describes row (Y+2-y) of the field with X characters ('.' for grass and '\\*' for a boulder)\n", "outputFormat": "\\* Line 1: A single integer that is the week number when the milkweed takes over the last remaining non-boulder square of the pasture.\n", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO09OCT] Invasion of the Milkweed G", "background": "", "description": "Farmer John has always done his best to keep the pastures full of luscious, delicious healthy grass for the cows. He has lost the battle, though, as the evil milkweed has attained a foothold in the northwest part of his farm.\n\nThe pasture, as usual, is partitioned into a rectilinear grid of height Y (1 <= Y <= 100) and width X (1 <= X <= 100) with (1,1) being in the lower left corner (i.e., arranged as a normal X,Y coordinate grid). The milkweed has initially begun growing at square (Mx,My). Each week the milkweed propagates to all non-rocky squares that surround any square it already occupies, as many as eight more squares (both the rectilinear squares and the diagonals). After only one week in those squares, it is ready to move on to more squares.\n\nBessie wants to enjoy all the grass she can before the pastures are taken over by milkweed. She wonders how long it can last. If the milkweed is in square (Mx,My) at time zero, at what time does it complete its invasion of the pasture (which, for the given input data, will always happen)?\n\nThe pasture is described by a picture with '.'s for grass and '\\*'s for boulders, like this example with X=4 and Y=3:\n\n```\n....\n..*.\n.**.\n```\n\nIf the milkweed started in the lower left corner (row=1, column=1), then the map would progress like this:\n\n```\n    ....  ....  MMM.  MMMM  MMMM\n    ..*.  MM*.  MM*.  MM*M  MM*M\n    M**.  M**.  M**.  M**.  M**M\nweek  0    1    2    3    4\n```\n\nThe milkweed has taken over the entire field after 4 weeks.", "inputFormat": "\\* Line 1: Four space-separated integers: X, Y, Mx, and My\n\n\\* Lines 2..Y+1: Line y+1 describes row (Y+2-y) of the field with X characters ('.' for grass and '\\*' for a boulder)\n", "outputFormat": "\\* Line 1: A single integer that is the week number when the milkweed takes over the last remaining non-boulder square of the pasture.\n", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO09OCT] Invasion of the Milkweed G", "background": null, "description": "农夫约翰一直尽力保持牧场里长满丰盛、美味且健康的草供奶牛食用。然而，他输掉了这场战斗，因为邪恶的乳草在他的农场西北部站稳了脚跟。\n\n牧场通常被划分为一个直角网格，高度为 $Y$（$1 \\le Y \\le 100$），宽度为 $X$（$1 \\le X \\le 100$），其中 $(1,1)$ 位于左下角（即，排列为正常的 $X,Y$ 坐标网格）。乳草最初开始在方格 $(M_x,M_y)$ 生长。每周，乳草会传播到它已经占据的任何方格周围的所有非岩石方格，最多可以传播到八个方格（包括直角方格和对角线方格）。在这些方格中仅仅一周后，它就准备好继续传播到更多方格。\n\n贝茜想在牧场被乳草占领之前尽可能多地享受青草。她想知道牧场能持续多久。如果乳草在时间零时位于方格 $(M_x,M_y)$，那么它在何时完成对牧场的入侵（对于给定的输入数据，这种情况总会发生）？\n\n牧场由一个图示描述，'.' 代表草，'\\*' 代表巨石，如下例所示，$X=4$，$Y=3$：\n\n```\n....\n..*.\n.**.\n```\n\n如果乳草从左下角开始（行=1，列=1），那么地图将按如下方式演变：\n\n```\n    ....  ....  MMM.  MMMM  MMMM\n    ..*.  MM*.  MM*.  MM*M  MM*M\n    M**.  M**.  M**.  M**.  M**M\nweek  0    1    2    3    4\n```\n\n乳草在 4 周后占领了整个牧场。", "inputFormat": "\\* 第 1 行：四个以空格分隔的整数：$X$，$Y$，$M_x$ 和 $M_y$\n\n\\* 第 2 行到第 $Y+1$ 行：第 $y + 1$ 行描述了牧场的第 $(Y + 1 - y)$ 行，其中包含 $X$ 个字符（'.' 代表草，'\\*' 代表巨石）", "outputFormat": "\\* 第 1 行：一个整数，表示乳草占领牧场最后一个非巨石方格的周数。", "hint": "（由 ChatGPT 4o 翻译）", "locale": "zh-CN"}}}
{"pid": "P2961", "type": "P", "difficulty": 6, "samples": [["5 6 \n3 2 4 5 \n2 1 3 \n3 1 2 3 \n1 1 \n2 2 5 \n3 2 3 4 \n", "5 \n1 \n3 \n1 \n2 \n4 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2009", "USACO", "Special Judge"], "title": "[USACO09NOV] Who Brings the Cookies? G", "background": "", "description": "Farmer John's N (1 <= N <= 1,000) cows conveniently numbered 1..N decided to form M (1 <= M <= 100) study groups. A total of S\\_i (1 <= S\\_i <= 19) cows study in group G\\_i (namely cows G\\_i1, G\\_i2, ...). A cow might study in more than one study group.\n\nFor each study group, one cow in the group must be chosen to bring cookies to the meeting. Cookies are costly and require time to acquire, so the cows want to divide the work of bringing cookies as fairly as possible.\n\nThey decided that if a cow attends meetings with size c\\_1, c\\_2, ..., c\\_K, she is only willing to bring cookies to at most ceil(1/c\\_1 + 1/c\\_2 + ... + 1/c\\_K) meetings.\n\nFigure out which cow brings cookies to each meeting. If this isn't possible, just output '-1'. Choose any solution if more than one is possible.\n\n", "inputFormat": "\\* Line 1: Two space-separated integers: N and M\n\n\\* Lines 2..M+1: Line i+1 contains many space-separated integers: S\\_i, G\\_i1, G\\_i2, ...\n", "outputFormat": "\\* Lines 1..M: If a mapping is possible, line i contains the number of the cow who brings cookies to study group i. Otherwise, line 1 contains just the integer -1.\n", "hint": "Cow1 can bring cookies to at most 2 meetings, cow2 can bring 2, cow3 can bring 2, cow4 can bring 1, and cow5 can bring 1.\n", "locale": "en", "translations": {"en": {"title": "[USACO09NOV] Who Brings the Cookies? G", "background": "", "description": "Farmer John's N (1 <= N <= 1,000) cows conveniently numbered 1..N decided to form M (1 <= M <= 100) study groups. A total of S\\_i (1 <= S\\_i <= 19) cows study in group G\\_i (namely cows G\\_i1, G\\_i2, ...). A cow might study in more than one study group.\n\nFor each study group, one cow in the group must be chosen to bring cookies to the meeting. Cookies are costly and require time to acquire, so the cows want to divide the work of bringing cookies as fairly as possible.\n\nThey decided that if a cow attends meetings with size c\\_1, c\\_2, ..., c\\_K, she is only willing to bring cookies to at most ceil(1/c\\_1 + 1/c\\_2 + ... + 1/c\\_K) meetings.\n\nFigure out which cow brings cookies to each meeting. If this isn't possible, just output '-1'. Choose any solution if more than one is possible.\n\n", "inputFormat": "\\* Line 1: Two space-separated integers: N and M\n\n\\* Lines 2..M+1: Line i+1 contains many space-separated integers: S\\_i, G\\_i1, G\\_i2, ...\n", "outputFormat": "\\* Lines 1..M: If a mapping is possible, line i contains the number of the cow who brings cookies to study group i. Otherwise, line 1 contains just the integer -1.\n", "hint": "Cow1 can bring cookies to at most 2 meetings, cow2 can bring 2, cow3 can bring 2, cow4 can bring 1, and cow5 can bring 1.\n", "locale": "en"}, "zh-CN": {"title": "[USACO09NOV] Who Brings the Cookies? G", "background": null, "description": "农夫约翰的 $N (1 \\leq N \\leq 1,000)$ 头奶牛，方便地编号为 $1$ 到 $N$，决定组成 $M (1 \\leq M \\leq 100)$ 个学习小组。每个学习小组 $G_i$ 中有 $S_i (1 \\leq S_i \\leq 19)$ 头奶牛参与学习（即奶牛 $G_i1, G_i2, \\dots$）。一头奶牛可能参加多个学习小组。\n\n对于每个学习小组，必须选择其中一头奶牛带饼干来参加会议。饼干很贵且需要时间来获取，因此奶牛们希望尽可能公平地分配带饼干的工作。\n\n她们决定，如果一头奶牛参加了大小为 $c_1, c_2, \\dots, c_K$ 的会议，她最多只愿意为 $ceil(1/c_1 + 1/c_2 + \\dots + 1/c_K$) 个会议带饼干。\n\n找出哪头奶牛为每次会议带饼干。如果无法做到，只需输出 '$-1$'。如果有多个解决方案，任选其一。", "inputFormat": "* 第 $1$ 行：两个用空格分隔的整数：$N$ 和 $M$。\n\n* 第 $2$ 行到第 $M+1$ 行：第 $i+1$ 行包含多个用空格分隔的整数：$S_i, G_i1, G_i2, \\dots$", "outputFormat": "* 第 $1$ 行到第 $M$ 行：如果映射是可能的，第 $i$ 行包含为学习小组 $i$ 带饼干的奶牛编号。否则，第 $1$ 行仅包含整数 $-1$。", "hint": "奶牛 $1$ 最多可以为 $2$ 次会议带饼干，奶牛 $2$ 可以带 $2$ 次，奶牛 $3$ 可以带 $2$ 次，奶牛 $4$ 可以带 $1$ 次，奶牛 $5$ 可以带 $1$ 次。\n（由 ChatGPT 4o 翻译）", "locale": "zh-CN"}}}
{"pid": "P2962", "type": "P", "difficulty": 5, "samples": [["5 6 \n1 2 \n1 3 \n4 2 \n3 4 \n2 5 \n5 3 \n", "3 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2009", "USACO", "O2优化", "深度优先搜索 DFS", "折半搜索 meet in the middle"], "title": "[USACO09NOV] Lights G", "background": "", "description": "奶牛 Bessie 和其他奶牛在谷仓里玩游戏，但电源重置后所有灯都熄灭了。请帮助它们将所有的灯重新打开，以便继续游戏。\n\n有 $N$（$1 \\le N \\le 35$）盏灯，编号为 $1$ 到 $N$，它们的开关通过 $M$（$1 \\le M \\le 595$）条连接构成一个复杂的网络。\n\n每盏灯都有一个开关，当你切换它时，该灯及所有与之直接相连的灯都会改变状态（开变关，关变开）。\n\n请找出最少需要切换多少次开关，才能把所有灯都打开。\n\n题目保证至少存在一种切换方案可以将所有灯点亮。", "inputFormat": "第 $1$ 行是两个用空格分隔的整数 $N$ 和 $M$。\n\n第 $2$ 行到第 $M + 1$ 行，每行两个空格分隔的整数，表示一条连接的两个灯的编号（无重复）。", "outputFormat": "仅一行一个整数，表示将所有灯点亮所需的最少开关切换次数。", "hint": "### 样例解释\n\n$5$ 盏灯中，灯 $1, 4, 5$ 各自都与灯 $2$ 和灯 $3$ 相连。\n\n只需切换灯 $1, 4, 5$ 的开关，即可使所有灯都打开。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO09NOV] Lights G", "background": null, "description": "Bessie and the cows were playing games in the barn, but the power was reset and the lights were all turned off. Help the cows get all the lights back on so they can resume their games.\n\nThe $N(1 \\le N \\le 35)$ lights conveniently numbered $1 \\cdots N$ and their switches are arranged in a complex network with $M(1 \\le M \\le 595)$ clever connection between pairs of lights (see below).\n\nEach light has a switch that, when toggled, causes that light -- and all of the lights that are connected to it -- to change their states (from on to off, or off to on).\n\nFind the minimum number of switches that need to be toggled in order to turn all the lights back on.\n\nIt's guaranteed that there is at least one way to toggle the switches so all lights are back on.", "inputFormat": "- Line $1$: Two space-separated integers: $N$ and $M$.\n- Lines $2 \\cdots M+1$: Each line contains two space-separated integers representing two lights that are connected. No pair will be repeated.", "outputFormat": "- Line $1$: A single integer representing the minimum number of switches that need to be flipped in order to turn on all the lights.", "hint": "### Explanation\n\nThere are $5$ lights. Lights $1,4$ and $5$ are each connected to both lights $2$ and $3$.\n\nToggle the switches on lights $1, 4$ and $5$.", "locale": "en"}, "zh-CN": {"title": "[USACO09NOV] Lights G", "background": "", "description": "奶牛 Bessie 和其他奶牛在谷仓里玩游戏，但电源重置后所有灯都熄灭了。请帮助它们将所有的灯重新打开，以便继续游戏。\n\n有 $N$（$1 \\le N \\le 35$）盏灯，编号为 $1$ 到 $N$，它们的开关通过 $M$（$1 \\le M \\le 595$）条连接构成一个复杂的网络。\n\n每盏灯都有一个开关，当你切换它时，该灯及所有与之直接相连的灯都会改变状态（开变关，关变开）。\n\n请找出最少需要切换多少次开关，才能把所有灯都打开。\n\n题目保证至少存在一种切换方案可以将所有灯点亮。", "inputFormat": "第 $1$ 行是两个用空格分隔的整数 $N$ 和 $M$。\n\n第 $2$ 行到第 $M + 1$ 行，每行两个空格分隔的整数，表示一条连接的两个灯的编号（无重复）。", "outputFormat": "仅一行一个整数，表示将所有灯点亮所需的最少开关切换次数。", "hint": "### 样例解释\n\n$5$ 盏灯中，灯 $1, 4, 5$ 各自都与灯 $2$ 和灯 $3$ 相连。\n\n只需切换灯 $1, 4, 5$ 的开关，即可使所有灯都打开。", "locale": "zh-CN"}}}
{"pid": "P2963", "type": "P", "difficulty": 4, "samples": [["4 2 \n2 1 \n3 5 \n4 4 \n", "4 4 \n4 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2009", "USACO"], "title": "[USACO09NOV] Cow Rescue G", "background": "", "description": "Bessie is trapped in a triangular maze with N rows (1 <= N <= 1,000,000). A three row maze is shown below:\n\nThe i'th row of the maze contains 2\\*i-1 triangles. Numbering from the left, the triangles are named (i,1), (i,2), and so on.\n\nBessie can travel to the (often three) triangles which share an edge with her current triangle. For example, if she is at (3, 3), she can travel to (3, 2), (3, 4) and (4, 4). Bessie takes one minute to travel from one triangle to the next.\n\nFJ has learned the Bessie is trapped and knows by tracking her iPhone that she starts her exit trek at triangle (Si,Sj). FJ's love for Bessie knows no bounds so he wants her back in the minimum possible time.\n\nThe maze has M (1 <= M <= 10,000) exits found in locations throughout the set of triangles. Any one of these will enable Bessie to escape. Once she enters an exit triangle, she leaves the maze in just one more minute.\n\nFind the minimum time in minutes, T, required for Bessie to exit the maze and report the optimal exit location she uses, (OUTi, OUTj). If more than one location requires only T minutes, output the location with the smallest row. If two optimal rows are the same, output the one with smaller column.\n\n贝希被困在一个三角形的迷宫之中。这个迷宫有 $N$ 行（$1 \\le N \\le 1000000$）。比如下图是一个 $3$ 行的迷宫。  迷宫的第 $i$ 行有 $2i-1$ 个三角形，从左到右分别编号为 $(i, 1)$、$(i, 2)$ 等等。\n\n贝希每次可以从一个三角形走到任意一个一个跟当前的三角形有邻边的三角形。\n\n比如说，如果她目前处于三角形 $(3, 3)$，那么，她可以走到三角形 $(3, 2)$、$(3, 4)$ 和 $(4, 4)$。贝希每次需要一分钟的时间来移动到下一个三角形。\n\n农夫约翰发现贝希被困了！于是她跟踪贝希的iPhone手机（可怜的触摸屏～），得知贝希目前处于三角形 $(S_i, S_j)$。\n\n因为约翰对贝希有著无穷无尽的浓浓爱意，所以他希望贝希能尽可能快地回到他的身边。 在迷宫的三角形之中，有 $M$（$1 \\le M \\le 10000$）个是出口。在任何一个出口都可以让贝希逃离迷宫。一旦贝希进入一个作为出口的三角形，她用多一分钟就可以逃离这个迷宫。 找到一个可以让贝希逃离迷宫最小时间 $T$，并输出她应该从哪一个出口逃离迷宫，这个出口记为 $(\\text{OUT}_i, \\text{OUT}_j)$。\n\n如果有多个出口同时需要时间 $T$，输出那个行的编号小的出口，如果仍然有多个出口，输出那个列的编号小的。\n", "inputFormat": "\\* Line 1: Two space-separated integers: N and M\n\n\\* Line 2: Two space-separated integers: Si and Sj\n\n\\* Lines 3..M+2: Line i+2 contains two space-separated integers that are the triangle location of exit i: Ei and Ej\n", "outputFormat": "\\* Line 1: Two space-separated integers: OUTi and OUTj\n\n\\* Line 2: A single integer: T\n", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[USACO09NOV] Cow Rescue G", "background": "", "description": "Bessie is trapped in a triangular maze with $N$ rows ($1 \\le N \\le 1{,}000{,}000$). For example, a maze with $3$ rows is shown below.\n\nThe $i$-th row of the maze contains $2i - 1$ triangles. Numbering from the left, the triangles are named $(i, 1)$, $(i, 2)$, and so on.\n\nBessie can move to any triangles that share an edge with her current triangle (often three neighbors). For example, if she is at $(3, 3)$, she can move to $(3, 2)$, $(3, 4)$, and $(4, 4)$. Each move to a neighboring triangle takes one minute.\n\nFarmer John has learned that Bessie is trapped and, by tracking her iPhone, knows she starts at triangle $(S_i, S_j)$. His love for Bessie knows no bounds, so he wants her back in the minimum possible time.\n\nThere are $M$ exits ($1 \\le M \\le 10{,}000$) located at various triangles in the maze. Entering any exit triangle allows Bessie to escape, and it takes one additional minute after entering an exit triangle to leave the maze.\n\nFind the minimum time in minutes, $T$, required for Bessie to exit the maze, and report the exit she uses, $(\\text{OUT}_i, \\text{OUT}_j)$. If more than one exit requires only $T$ minutes, output the one with the smallest row. If there is still a tie, output the one with the smaller column.", "inputFormat": "- Line 1: Two space-separated integers: $N$ and $M$.\n- Line 2: Two space-separated integers: $S_i$ and $S_j$.\n- Lines $3 \\ldots M+2$: Line $i+2$ contains two space-separated integers giving the location of exit $i$: $E_i$ and $E_j$.", "outputFormat": "- Line 1: Two space-separated integers: $\\text{OUT}_i$ and $\\text{OUT}_j$.\n- Line 2: A single integer: $T$.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO09NOV] Cow Rescue G", "background": "", "description": "Bessie is trapped in a triangular maze with N rows (1 <= N <= 1,000,000). A three row maze is shown below:\n\nThe i'th row of the maze contains 2\\*i-1 triangles. Numbering from the left, the triangles are named (i,1), (i,2), and so on.\n\nBessie can travel to the (often three) triangles which share an edge with her current triangle. For example, if she is at (3, 3), she can travel to (3, 2), (3, 4) and (4, 4). Bessie takes one minute to travel from one triangle to the next.\n\nFJ has learned the Bessie is trapped and knows by tracking her iPhone that she starts her exit trek at triangle (Si,Sj). FJ's love for Bessie knows no bounds so he wants her back in the minimum possible time.\n\nThe maze has M (1 <= M <= 10,000) exits found in locations throughout the set of triangles. Any one of these will enable Bessie to escape. Once she enters an exit triangle, she leaves the maze in just one more minute.\n\nFind the minimum time in minutes, T, required for Bessie to exit the maze and report the optimal exit location she uses, (OUTi, OUTj). If more than one location requires only T minutes, output the location with the smallest row. If two optimal rows are the same, output the one with smaller column.\n\n贝希被困在一个三角形的迷宫之中。这个迷宫有 $N$ 行（$1 \\le N \\le 1000000$）。比如下图是一个 $3$ 行的迷宫。  迷宫的第 $i$ 行有 $2i-1$ 个三角形，从左到右分别编号为 $(i, 1)$、$(i, 2)$ 等等。\n\n贝希每次可以从一个三角形走到任意一个一个跟当前的三角形有邻边的三角形。\n\n比如说，如果她目前处于三角形 $(3, 3)$，那么，她可以走到三角形 $(3, 2)$、$(3, 4)$ 和 $(4, 4)$。贝希每次需要一分钟的时间来移动到下一个三角形。\n\n农夫约翰发现贝希被困了！于是她跟踪贝希的iPhone手机（可怜的触摸屏～），得知贝希目前处于三角形 $(S_i, S_j)$。\n\n因为约翰对贝希有著无穷无尽的浓浓爱意，所以他希望贝希能尽可能快地回到他的身边。 在迷宫的三角形之中，有 $M$（$1 \\le M \\le 10000$）个是出口。在任何一个出口都可以让贝希逃离迷宫。一旦贝希进入一个作为出口的三角形，她用多一分钟就可以逃离这个迷宫。 找到一个可以让贝希逃离迷宫最小时间 $T$，并输出她应该从哪一个出口逃离迷宫，这个出口记为 $(\\text{OUT}_i, \\text{OUT}_j)$。\n\n如果有多个出口同时需要时间 $T$，输出那个行的编号小的出口，如果仍然有多个出口，输出那个列的编号小的。\n", "inputFormat": "\\* Line 1: Two space-separated integers: N and M\n\n\\* Line 2: Two space-separated integers: Si and Sj\n\n\\* Lines 3..M+2: Line i+2 contains two space-separated integers that are the triangle location of exit i: Ei and Ej\n", "outputFormat": "\\* Line 1: Two space-separated integers: OUTi and OUTj\n\n\\* Line 2: A single integer: T\n", "hint": "", "locale": "zh-CN"}}}
{"pid": "P2964", "type": "P", "difficulty": 5, "samples": [["5 \n1 \n3 \n1 \n7 \n2 \n", "9 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000]}, "tags": ["动态规划 DP", "博弈论", "2009", "USACO"], "title": "[USACO09NOV] A Coin Game S", "background": null, "description": "小 A 和小 B 在玩游戏。\n\n初始时，有 $n$ 个硬币被摆成了一行，从左至右第 $i$ 个硬币的价值为 $c_i$。\n\n游戏的规则是，两人交替从这堆硬币的**左侧**连续取出若干硬币，然后将取出的硬币的价值累加至自己获得的累计价值中。若对方上次操作取出了 $k$ 个硬币，那么本次自己最多取出 $k \\times 2$ 个硬币。当没有硬币可取时，游戏结束。\n\n游戏开始时，由小 A 先动手取硬币，最多取出 $2$ 个硬币。\n\n请求出当双方都尽可能使自己的累计价值最大的情况下，小 A 能获得的累计价值最大是多少。", "inputFormat": "输入的第一行是一个整数 $n$，代表硬币的个数。\n\n第 $2$ 到第 $(n + 1)$ 行，每行一个整数，第 $(i + 1)$ 行的整数代表第 $i$ 个硬币的价值 $c_i$。", "outputFormat": "输出一行一个整数，代表小 A 能获得的最大累计价值。", "hint": "#### 输出输出样例 $1$ 解释\n\n初始时，硬币序列为 $\\{1,~3,~1,~7,~2\\}$。\n\n由小 A 先操作，他取出了一个硬币，硬币序列变为 $\\{3,~1,~7,~2\\}$，小 A 的累计价值为 $1$。\n\n再由小 B 操作，由于小 A 上回合取出了 $1$ 个硬币，所以他本回合可以取出至多 $1 \\times 2 = 2$ 个硬币。他取出了一个硬币，硬币序列变为 $\\{1,~7,~2\\}$，小 B 的累计价值为 $3$。\n\n再由小 A 操作，由于上回合小 B 取出了 $1$ 个硬币，所以他本回合可以取出至多 $1 \\times 2 = 2$ 个硬币。他取出了两个硬币，硬币序列变为 $\\{2\\}$，小 A 的累计价值为 $1 + 1 + 7 = 9$。\n\n再由小 B 操作，由于上回合小 A 取出了 $2$ 个硬币，所以他本回合可以取出至多 $2 \\times 2 = 4$ 个硬币。但是只剩下了 $1$ 个硬币，因此他只能取出一个硬币，硬币序列变为空，小 B 的累计价值为 $3 + 2 = 5$，游戏结束。\n\n#### 数据范围与约定\n\n对于全部的测试点，保证 $5 \\leq n \\leq 2 \\times 10^3$，$1 \\leq c_i \\leq 10^5$。\n\n**提示：请注意本题的空间限制为 $20$ MiB**。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO09NOV] A Coin Game S", "background": null, "description": "Farmer John's cows like to play coin games so FJ has invented with a new two-player coin game called Xoinc for them.\n\nInitially a stack of $N\\ (5 <= N <= 2,000)$ coins sits on the ground; coin i from the top has integer value $C_i\\ (1\\le C_i\\le 100,000)$.\n\nThe first player starts the game by taking the top one or two coins ($C_1$ and maybe $C_2$) from the stack. If the first player takes just the top coin, the second player may take the following one or two coins in the next turn. If the first player takes two coins then the second player may take the top one, two, three or four coins from the stack. In each turn, the current player must take at least one coin and at most two times the amount of coins last taken by the opposing player. The game is over when there are no more coins to take.\n\nAfterwards, they can use the value of the coins they have taken from the stack to buy treats from FJ, so naturally, their purpose in the game is to maximize the total value of the coins they take. Assuming the second player plays optimally to maximize his own winnings, what is the highest total value that the first player can have when the game is over?", "inputFormat": "First Line: A single integer: $N$\n\nNext $N$ Lines: Line $i+1$ contains a single integer: $C_i$", "outputFormat": "A single integer representing the maximum value that can be made by the first player.", "hint": "Explanation:\n\nThe first player starts by taking a single coin (value $1$). The opponent takes one coin as well (value $3$). The first player takes two more coins (values $1$ and $7$ -- total $9$).\n\nThe second player gets the leftover coin (value $2$-- total $5$).", "locale": "en"}, "zh-CN": {"title": "[USACO09NOV] A Coin Game S", "background": null, "description": "小 A 和小 B 在玩游戏。\n\n初始时，有 $n$ 个硬币被摆成了一行，从左至右第 $i$ 个硬币的价值为 $c_i$。\n\n游戏的规则是，两人交替从这堆硬币的**左侧**连续取出若干硬币，然后将取出的硬币的价值累加至自己获得的累计价值中。若对方上次操作取出了 $k$ 个硬币，那么本次自己最多取出 $k \\times 2$ 个硬币。当没有硬币可取时，游戏结束。\n\n游戏开始时，由小 A 先动手取硬币，最多取出 $2$ 个硬币。\n\n请求出当双方都尽可能使自己的累计价值最大的情况下，小 A 能获得的累计价值最大是多少。", "inputFormat": "输入的第一行是一个整数 $n$，代表硬币的个数。\n\n第 $2$ 到第 $(n + 1)$ 行，每行一个整数，第 $(i + 1)$ 行的整数代表第 $i$ 个硬币的价值 $c_i$。", "outputFormat": "输出一行一个整数，代表小 A 能获得的最大累计价值。", "hint": "#### 输出输出样例 $1$ 解释\n\n初始时，硬币序列为 $\\{1,~3,~1,~7,~2\\}$。\n\n由小 A 先操作，他取出了一个硬币，硬币序列变为 $\\{3,~1,~7,~2\\}$，小 A 的累计价值为 $1$。\n\n再由小 B 操作，由于小 A 上回合取出了 $1$ 个硬币，所以他本回合可以取出至多 $1 \\times 2 = 2$ 个硬币。他取出了一个硬币，硬币序列变为 $\\{1,~7,~2\\}$，小 B 的累计价值为 $3$。\n\n再由小 A 操作，由于上回合小 B 取出了 $1$ 个硬币，所以他本回合可以取出至多 $1 \\times 2 = 2$ 个硬币。他取出了两个硬币，硬币序列变为 $\\{2\\}$，小 A 的累计价值为 $1 + 1 + 7 = 9$。\n\n再由小 B 操作，由于上回合小 A 取出了 $2$ 个硬币，所以他本回合可以取出至多 $2 \\times 2 = 4$ 个硬币。但是只剩下了 $1$ 个硬币，因此他只能取出一个硬币，硬币序列变为空，小 B 的累计价值为 $3 + 2 = 5$，游戏结束。\n\n#### 数据范围与约定\n\n对于全部的测试点，保证 $5 \\leq n \\leq 2 \\times 10^3$，$1 \\leq c_i \\leq 10^5$。\n\n**提示：请注意本题的空间限制为 $20$ MiB**。", "locale": "zh-CN"}}}
{"pid": "P2965", "type": "P", "difficulty": 2, "samples": [["2 0 1 5 55555555 0 1 0 55555555 55555555 \n", "51 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2009", "USACO"], "title": "[USACO09NOV] The Grand Farm-off S", "background": "", "description": "Farmer John owns 3\\*N (1 <= N <= 500,000) cows surprisingly numbered 0..3\\*N-1, each of which has some associated integer weight W\\_i (1 <= W\\_i <= d). He is entering the Grand Farm-off, a farming competition where he shows off his cows to the greater agricultural community.\n\nThis competition allows him to enter a group of N cows. He has given each of his cows a utility rating U\\_i (1 <= U\\_i <= h), which\n\nrepresents the usefulness he thinks that a particular cow will have in the competition, and he wants his selection of cows to have the maximal sum of utility.\n\nThere might be multiple sets of N cows that attain the maximum utility sum. FJ is afraid the competition may impose a total weight limit on the cows in the competition, so a secondary priority is to bring lighter weight competition cows.\n\nHelp FJ find a set of N cows with minimum possible total weight among the sets of N cows that maximize the utility, and print the remainder when this total weight is divided by M (10,000,000 <= M <= 1,000,000,000).\n\nNote: to make the input phase faster, FJ has derived polynomials which will generate the weights and utility values for each cow. For each cow 0 <= i < 3\\*N,\n\n $$W_i=(a\\times i^5+b\\times i^2+c)\\mod d$$\n \n $$U_i=(e\\times i^5+f\\times i^3+g)\\mod h$$\n \n $$(0\\le a,b,c,d,e,f,g,h\\le 10^9)$$\n\nThe formulae do sometimes generate duplicate numbers; your algorithm should handle this properly. \n\n农夫约翰有3N(1 < N < 500000)头牛，编号依次为1..#N，每头牛都有一个整数值的体 重。约翰准备参加农场技艺大赛，向广大的农业社区展示他的奶牛.\n大赛规则允许约翰带N头牛参赛.约翰给每头牛赋予了一个“有用度”Ui，它表 示了某头牛在比赛中的有用程度.约翰希望他选出的奶牛的有用度之和最大.\n\n有可能选出很多组的N头牛都能达到有用度最大和.约翰害怕选出的N头牛的总重量会给大赛 带来震撼，所以，要考虑优先选择体重轻的奶牛.\n\n帮助约翰选出N头总重量最轻，并且有用度之和最大的奶牛.输出体重模M后的余数.\n\n注意：为了使输入更快，约翰使用了一个多项式来生成每头牛的体重和有用度.对每头牛/， 体重和有用度的计算公式为：\n\n\n\n $$W_i=(a\\times i^5+b\\times i^2+c)\\mod d$$\n \n $$U_i=(e\\times i^5+f\\times i^3+g)\\mod h$$\n \n $$(0\\le a,b,c,d,e,f,g,h\\le 10^9)$$", "inputFormat": "\\* Line 1: Ten space-separated integers: N, a, b, c, d, e, f, g, h, and M\n", "outputFormat": "\\* Line 1: A single integer representing the lowest sum of the weights of the N cows with the highest net utility.\n", "hint": "The functions generate weights of 5, 6, 9, 14, 21, and 30 along with utilities of 0, 1, 8, 27, 64, and 125.\n\n\nThe two cows with the highest utility are cow 5 and 6, and their combined weight is 21+30=51.\n", "locale": "zh-CN", "translations": {"en": {"title": "[USACO09NOV] The Grand Farm-off S", "background": "", "description": "Farmer John owns $3N$ cows (with $1 \\le N \\le 500{,}000$), numbered $0 \\ldots 3N - 1$. Each cow $i$ has an integer weight $W_i$ and a utility rating $U_i$.\n\nHe may enter a group of $N$ cows into the Grand Farm-off. He wants to choose $N$ cows whose total utility is maximized. If multiple sets of $N$ cows achieve the same maximum total utility, he prefers the set with the minimum possible total weight.\n\nAmong all selections of $N$ cows that maximize the total utility, find the minimum possible total weight, and output the remainder when this total weight is divided by $M$ (with $10{,}000{,}000 \\le M \\le 1{,}000{,}000{,}000$).\n\nTo speed up input, the weights and utilities are generated by polynomials. For each cow $0 \\le i < 3N$,\n\n $$W_i=(a\\times i^5+b\\times i^2+c)\\mod d$$\n \n $$U_i=(e\\times i^5+f\\times i^3+g)\\mod h$$\n \n $$(0\\le a,b,c,d,e,f,g,h\\le 10^9)$$\n\nNote that these formulae can generate duplicate values; your algorithm should handle this properly. Also, $0 \\le W_i < d$ and $0 \\le U_i < h$.", "inputFormat": "Line 1: Ten space-separated integers $N$, $a$, $b$, $c$, $d$, $e$, $f$, $g$, $h$, $M$.", "outputFormat": "Line 1: A single integer — the remainder when the minimum possible total weight (among all selections of $N$ cows that maximize total utility) is divided by $M$.", "hint": "The functions generate weights of 5, 6, 9, 14, 21, and 30 along with utilities of 0, 1, 8, 27, 64, and 125.\n\nThe two cows with the highest utility are cows 5 and 6, and their combined weight is $21 + 30 = 51$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO09NOV] The Grand Farm-off S", "background": "", "description": "Farmer John owns 3\\*N (1 <= N <= 500,000) cows surprisingly numbered 0..3\\*N-1, each of which has some associated integer weight W\\_i (1 <= W\\_i <= d). He is entering the Grand Farm-off, a farming competition where he shows off his cows to the greater agricultural community.\n\nThis competition allows him to enter a group of N cows. He has given each of his cows a utility rating U\\_i (1 <= U\\_i <= h), which\n\nrepresents the usefulness he thinks that a particular cow will have in the competition, and he wants his selection of cows to have the maximal sum of utility.\n\nThere might be multiple sets of N cows that attain the maximum utility sum. FJ is afraid the competition may impose a total weight limit on the cows in the competition, so a secondary priority is to bring lighter weight competition cows.\n\nHelp FJ find a set of N cows with minimum possible total weight among the sets of N cows that maximize the utility, and print the remainder when this total weight is divided by M (10,000,000 <= M <= 1,000,000,000).\n\nNote: to make the input phase faster, FJ has derived polynomials which will generate the weights and utility values for each cow. For each cow 0 <= i < 3\\*N,\n\n $$W_i=(a\\times i^5+b\\times i^2+c)\\mod d$$\n \n $$U_i=(e\\times i^5+f\\times i^3+g)\\mod h$$\n \n $$(0\\le a,b,c,d,e,f,g,h\\le 10^9)$$\n\nThe formulae do sometimes generate duplicate numbers; your algorithm should handle this properly. \n\n农夫约翰有3N(1 < N < 500000)头牛，编号依次为1..#N，每头牛都有一个整数值的体 重。约翰准备参加农场技艺大赛，向广大的农业社区展示他的奶牛.\n大赛规则允许约翰带N头牛参赛.约翰给每头牛赋予了一个“有用度”Ui，它表 示了某头牛在比赛中的有用程度.约翰希望他选出的奶牛的有用度之和最大.\n\n有可能选出很多组的N头牛都能达到有用度最大和.约翰害怕选出的N头牛的总重量会给大赛 带来震撼，所以，要考虑优先选择体重轻的奶牛.\n\n帮助约翰选出N头总重量最轻，并且有用度之和最大的奶牛.输出体重模M后的余数.\n\n注意：为了使输入更快，约翰使用了一个多项式来生成每头牛的体重和有用度.对每头牛/， 体重和有用度的计算公式为：\n\n\n\n $$W_i=(a\\times i^5+b\\times i^2+c)\\mod d$$\n \n $$U_i=(e\\times i^5+f\\times i^3+g)\\mod h$$\n \n $$(0\\le a,b,c,d,e,f,g,h\\le 10^9)$$", "inputFormat": "\\* Line 1: Ten space-separated integers: N, a, b, c, d, e, f, g, h, and M\n", "outputFormat": "\\* Line 1: A single integer representing the lowest sum of the weights of the N cows with the highest net utility.\n", "hint": "The functions generate weights of 5, 6, 9, 14, 21, and 30 along with utilities of 0, 1, 8, 27, 64, and 125.\n\n\nThe two cows with the highest utility are cow 5 and 6, and their combined weight is 21+30=51.\n", "locale": "zh-CN"}}}
{"pid": "P2966", "type": "P", "difficulty": 5, "samples": [["5 7 2 \n2 \n5 \n3 \n3 \n4 \n1 2 3 \n1 3 2 \n2 5 3 \n5 3 1 \n5 4 1 \n2 4 3 \n3 4 4 \n1 4 \n2 3 \n", "8 \n9 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2009", "USACO", "排序", "最短路"], "title": "[USACO09DEC] Cow Toll Paths G", "background": "", "description": "Like everyone else, FJ is always thinking up ways to increase his revenue. To this end, he has set up a series of tolls that the cows will pay when they traverse the cowpaths throughout the farm.\n\nThe cows move from any of the $N (1 \\leq N \\leq 250)$ pastures conveniently numbered $1...N$ to any other pasture over a set of $M (1 \\leq M \\leq 10,000) $bidirectional cowpaths that connect pairs of different pastures $A_j$ and $B_j (1 \\leq A_j \\leq N; 1 \\leq B_j \\leq N)$. FJ has assigned a toll $L_j (1 \\leq L_j \\leq 100,000)$ to the path connecting pastures $A_j$ and $B_j$.\n\nWhile there may be multiple cowpaths connecting the same pair of pastures, a cowpath will never connect a pasture to itself. Best of all, a cow can always move from any one pasture to any other pasture by following some sequence of cowpaths.\n\nIn an act that can only be described as greedy, FJ has also assigned a toll $C_i (1 \\leq C_i \\leq 100,000)$ to every pasture. The cost of moving from one pasture to some different pasture is the sum of the tolls for each of the cowpaths that were traversed plus a **single additional toll** that is the maximum of all the pasture tolls encountered along the way, including the initial and destination pastures.\n\nThe patient cows wish to investigate their options. They want you to write a program that accepts $K (1 \\leq K \\leq 10,000)$ queries and outputs the minimum cost of trip specified by each query. Query $i$ is a pair of numbers $s_i$ and $t_i (1 \\leq s_i \\leq N; 1 \\leq t_i \\leq N; s_i \\neq t_i)$ specifying a starting and ending pasture.\n\nConsider this example diagram with five pastures:\n\nThe 'edge toll' for the path from pasture $1$ to pasture $2$ is $3$. Pasture $2$'s 'node toll' is $5$.\n\nTo travel from pasture $1$ to pasture $4$, traverse pastures $1$ to $3$ to $5$ to $4$. This incurs an edge toll of $2+1+1=4$ and a node toll of $4$ (since pasture $5$'s toll is greatest), for a total cost of $4+4=8$.\n\nThe best way to travel from pasture $2$ to pasture $3$ is to traverse pastures $2$ to $5$ to $3$. This incurs an edge toll of $3+1=4$ and a node toll of $5$, for a total cost of $4+5=9$.\n\n给定一个 $n$ 点 $m$ 边的双向图，第 $i$ 条道路连接了 $u_i$ 与 $v_i$，边权为 $w_i$，第 $i$ 个点的点权为 $c_i$。\n\n给定 $q$ 组询问，第 $i$ 组询问求从 $s_i$ 到 $t_i$ 的路径的边权之和与点权的最大值的和的最小值。\n\n**可能有重边，但保证无自环。**", "inputFormat": "-  Line $1$: Three space separated integers: $N$, $M$, and $K$\n\n- Lines $2..N+1$: Line $i+1$ contains a single integer: $C_i$\n\n- Lines $N+2..N+M+1$: Line $j+N+1$ contains three space separated integers: $A_j$, $B_j$, and $L_j$\n\n- Lines $N+M+2..N+M+K+1$: Line $i+N+M+1$ specifies query $i$ using two space-separated integers: $s_i$ and $t_i$\n\n第一行三个整数 $n,m,q$ 代表点数，边数与询问数。   \n接下来 $n$ 行每行一个整数 $c_i$ 代表第 $i$ 个点的点权。    \n接下来 $m$ 行每行三个整数 $u_i,v_i,w_i$ 代表第 $i$ 条边从 $u_i$ 连到 $v_i$ 边权为 $w_i$。   \n接下来 $q$ 行每行两个整数 $s_i,t_i$ 代表第 $i$ 组询问求从 $s_i$ 到 $t_i$ 的边权之和与点权的最大值的和的最小值。\n", "outputFormat": "- Lines $1..K$: Line $i$ contains a single integer which is the lowest cost of any route from $s_i$ to $t_i$\n\n$q$ 行每行一个整数，代表第 $i$ 组询问的结果。", "hint": "对于 $100\\%$ 的数据，$1 \\le n \\le 250$，$1 \\le m \\le 10^4$，$1 \\le q \\le 10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO09DEC] Cow Toll Paths G", "background": "", "description": "Like everyone else, FJ is always thinking up ways to increase his revenue. To this end, he has set up a series of tolls that the cows will pay when they traverse the cowpaths throughout the farm.\n\nThe farm is modeled as an undirected graph with $N$ pastures, conveniently numbered $1..N$, connected by $M$ bidirectional cowpaths. Path $j$ connects two different pastures $A_j$ and $B_j$ and has an edge toll $L_j$. There may be multiple cowpaths connecting the same pair of pastures, but no cowpath connects a pasture to itself. The graph is connected, so a cow can always move from any pasture to any other pasture by following some sequence of cowpaths.\n\nFJ has also assigned a toll $C_i$ to every pasture $i$. The cost of traveling from pasture $s$ to a different pasture $t$ along any path is the sum of the edge tolls on that path plus a single additional toll equal to the maximum of all the node tolls encountered along the way, including $s$ and $t$.\n\nYou are given $K$ queries. Query $i$ specifies $(s_i, t_i)$ and asks for the minimum possible cost of a trip from $s_i$ to $t_i$ under the rule above.", "inputFormat": "- Line $1$: Three space-separated integers $N$, $M$, and $K$.\n- Lines $2..N+1$: Line $i+1$ contains a single integer $C_i$.\n- Lines $N+2..N+M+1$: Line $j+N+1$ contains three space-separated integers $A_j$, $B_j$, and $L_j$.\n- Lines $N+M+2..N+M+K+1$: Line $i+N+M+1$ contains two space-separated integers $s_i$ and $t_i$.", "outputFormat": "- Lines $1..K$: Line $i$ contains a single integer, the minimum cost of any route from $s_i$ to $t_i$.", "hint": "Constraints: $1 \\leq N \\leq 250$, $1 \\leq M \\leq 10^4$, $1 \\leq K \\leq 10^4$, $1 \\leq C_i \\leq 100{,}000$, $1 \\leq L_j \\leq 100{,}000$.\n\nNotes: Multiple edges between a pair of pastures are allowed, but self-loops are not. The graph is connected.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO09DEC] Cow Toll Paths G", "background": "", "description": "Like everyone else, FJ is always thinking up ways to increase his revenue. To this end, he has set up a series of tolls that the cows will pay when they traverse the cowpaths throughout the farm.\n\nThe cows move from any of the $N (1 \\leq N \\leq 250)$ pastures conveniently numbered $1...N$ to any other pasture over a set of $M (1 \\leq M \\leq 10,000) $bidirectional cowpaths that connect pairs of different pastures $A_j$ and $B_j (1 \\leq A_j \\leq N; 1 \\leq B_j \\leq N)$. FJ has assigned a toll $L_j (1 \\leq L_j \\leq 100,000)$ to the path connecting pastures $A_j$ and $B_j$.\n\nWhile there may be multiple cowpaths connecting the same pair of pastures, a cowpath will never connect a pasture to itself. Best of all, a cow can always move from any one pasture to any other pasture by following some sequence of cowpaths.\n\nIn an act that can only be described as greedy, FJ has also assigned a toll $C_i (1 \\leq C_i \\leq 100,000)$ to every pasture. The cost of moving from one pasture to some different pasture is the sum of the tolls for each of the cowpaths that were traversed plus a **single additional toll** that is the maximum of all the pasture tolls encountered along the way, including the initial and destination pastures.\n\nThe patient cows wish to investigate their options. They want you to write a program that accepts $K (1 \\leq K \\leq 10,000)$ queries and outputs the minimum cost of trip specified by each query. Query $i$ is a pair of numbers $s_i$ and $t_i (1 \\leq s_i \\leq N; 1 \\leq t_i \\leq N; s_i \\neq t_i)$ specifying a starting and ending pasture.\n\nConsider this example diagram with five pastures:\n\nThe 'edge toll' for the path from pasture $1$ to pasture $2$ is $3$. Pasture $2$'s 'node toll' is $5$.\n\nTo travel from pasture $1$ to pasture $4$, traverse pastures $1$ to $3$ to $5$ to $4$. This incurs an edge toll of $2+1+1=4$ and a node toll of $4$ (since pasture $5$'s toll is greatest), for a total cost of $4+4=8$.\n\nThe best way to travel from pasture $2$ to pasture $3$ is to traverse pastures $2$ to $5$ to $3$. This incurs an edge toll of $3+1=4$ and a node toll of $5$, for a total cost of $4+5=9$.\n\n给定一个 $n$ 点 $m$ 边的双向图，第 $i$ 条道路连接了 $u_i$ 与 $v_i$，边权为 $w_i$，第 $i$ 个点的点权为 $c_i$。\n\n给定 $q$ 组询问，第 $i$ 组询问求从 $s_i$ 到 $t_i$ 的路径的边权之和与点权的最大值的和的最小值。\n\n**可能有重边，但保证无自环。**", "inputFormat": "-  Line $1$: Three space separated integers: $N$, $M$, and $K$\n\n- Lines $2..N+1$: Line $i+1$ contains a single integer: $C_i$\n\n- Lines $N+2..N+M+1$: Line $j+N+1$ contains three space separated integers: $A_j$, $B_j$, and $L_j$\n\n- Lines $N+M+2..N+M+K+1$: Line $i+N+M+1$ specifies query $i$ using two space-separated integers: $s_i$ and $t_i$\n\n第一行三个整数 $n,m,q$ 代表点数，边数与询问数。   \n接下来 $n$ 行每行一个整数 $c_i$ 代表第 $i$ 个点的点权。    \n接下来 $m$ 行每行三个整数 $u_i,v_i,w_i$ 代表第 $i$ 条边从 $u_i$ 连到 $v_i$ 边权为 $w_i$。   \n接下来 $q$ 行每行两个整数 $s_i,t_i$ 代表第 $i$ 组询问求从 $s_i$ 到 $t_i$ 的边权之和与点权的最大值的和的最小值。\n", "outputFormat": "- Lines $1..K$: Line $i$ contains a single integer which is the lowest cost of any route from $s_i$ to $t_i$\n\n$q$ 行每行一个整数，代表第 $i$ 组询问的结果。", "hint": "对于 $100\\%$ 的数据，$1 \\le n \\le 250$，$1 \\le m \\le 10^4$，$1 \\le q \\le 10^4$。", "locale": "zh-CN"}}}
{"pid": "P2967", "type": "P", "difficulty": 5, "samples": [["3 800 \n300 2 30 50 25 80 \n600 1 50 130 \n400 3 40 70 30 40 35 60 \n", "210 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2009", "USACO", "背包 DP"], "title": "[USACO09DEC] Video Game Troubles G", "background": "", "description": "Farmer John's cows love their video games! FJ noticed that after playing these games that his cows produced much more milk than usual, surely because contented cows make more milk.\n\nThe cows disagree, though, on which is the best game console. One cow wanted to buy the Xbox 360 to play Halo 3; another wanted to buy the Nintendo Wii to play Super Smash Brothers Brawl; a third wanted to play Metal Gear Solid 4 on the PlayStation 3. FJ wants to purchase the set of game consoles (no more than one each) and games (no more than one each -- and within the constraints of a given budget) that helps his cows produce the most milk and thus nourish the most children.\n\nFJ researched N (1 <= N <= 50) consoles, each with a console price P\\_i (1 <= P\\_i <= 1000) and a number of console-specific games G\\_i (1 <= G\\_i <= 10). A cow must, of course, own a console before she can buy any game that is specific to that console. Each individual game has a game price GP\\_j (1 <= GP\\_j price <= 100) and a production value (1 <= PV\\_j <= 1,000,000), which indicates how much milk a cow will produce after playing the game. Lastly, Farmer John has a budget V (1 <= V <= 100,000) which is the maximum amount of money he can spend. Help him maximize the sum of the production values of the games he buys.\n\nConsider one dataset with N=3 consoles and a V=$800 budget. The first console costs $300 and has 2 games with cost $30 and $25 and production values as shown:\n\nGame #    Cost    Production Value\n\n1       $30          50\n\n2       $25          80\n\nThe second console costs $600 and has only 1 game:\n\nGame #    Cost    Production Value\n\n1       $50          130\n\nThe third console costs $400 and has 3 games:\n\nGame #    Cost    Production Value\n\n1       $40         70\n\n2       $30         40\n\n3       $35         60\n\nFarmer John should buy consoles 1 and 3, game 2 for console 1, and games 1 and 3 for console 3 to maximize his expected production at 210:\n\n```cpp\n                                Production Value\n        Budget:     $800      \n        Console 1  -$300\n           Game 2   -$25              80\n        Console 3  -$400\n           Game 1   -$40              70\n           Game 3   -$35              60\n      -------------------------------------------\n        Total:         0 (>= 0)      210\n```\n", "inputFormat": "\\* Line 1: Two space-separated integers: N and V\n\n\\* Lines 2..N+1: Line i+1 describes the price of and the games\n\navailable for console i; it contains: P\\_i, G\\_i, and G\\_i pairs of space-separated integers GP\\_j, PV\\_j\n", "outputFormat": "\\* Line 1: The maximum production value that Farmer John can get with his budget.\n", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO09DEC] Video Game Troubles G", "background": "", "description": "Farmer John's cows love their video games! FJ noticed that after playing these games that his cows produced much more milk than usual, surely because contented cows make more milk.\n\nThe cows disagree, though, on which is the best game console. One cow wanted to buy the Xbox 360 to play Halo 3; another wanted to buy the Nintendo Wii to play Super Smash Brothers Brawl; a third wanted to play Metal Gear Solid 4 on the PlayStation 3. FJ wants to purchase the set of game consoles (no more than one each) and games (no more than one each -- and within the constraints of a given budget) that helps his cows produce the most milk and thus nourish the most children.\n\nFJ researched N (1 <= N <= 50) consoles, each with a console price P\\_i (1 <= P\\_i <= 1000) and a number of console-specific games G\\_i (1 <= G\\_i <= 10). A cow must, of course, own a console before she can buy any game that is specific to that console. Each individual game has a game price GP\\_j (1 <= GP\\_j price <= 100) and a production value (1 <= PV\\_j <= 1,000,000), which indicates how much milk a cow will produce after playing the game. Lastly, Farmer John has a budget V (1 <= V <= 100,000) which is the maximum amount of money he can spend. Help him maximize the sum of the production values of the games he buys.\n\nConsider one dataset with N=3 consoles and a V=$800 budget. The first console costs $300 and has 2 games with cost $30 and $25 and production values as shown:\n\nGame #    Cost    Production Value\n\n1       $30          50\n\n2       $25          80\n\nThe second console costs $600 and has only 1 game:\n\nGame #    Cost    Production Value\n\n1       $50          130\n\nThe third console costs $400 and has 3 games:\n\nGame #    Cost    Production Value\n\n1       $40         70\n\n2       $30         40\n\n3       $35         60\n\nFarmer John should buy consoles 1 and 3, game 2 for console 1, and games 1 and 3 for console 3 to maximize his expected production at 210:\n\n```cpp\n                                Production Value\n        Budget:     $800      \n        Console 1  -$300\n           Game 2   -$25              80\n        Console 3  -$400\n           Game 1   -$40              70\n           Game 3   -$35              60\n      -------------------------------------------\n        Total:         0 (>= 0)      210\n```\n", "inputFormat": "\\* Line 1: Two space-separated integers: N and V\n\n\\* Lines 2..N+1: Line i+1 describes the price of and the games\n\navailable for console i; it contains: P\\_i, G\\_i, and G\\_i pairs of space-separated integers GP\\_j, PV\\_j\n", "outputFormat": "\\* Line 1: The maximum production value that Farmer John can get with his budget.\n", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO09DEC] Video Game Troubles G", "background": null, "description": "农夫约翰的奶牛们非常喜欢玩电子游戏！FJ 发现，在玩了这些游戏后，他的奶牛产的奶比平时多得多，这肯定是因为快乐的奶牛产奶更多。\n\n然而，奶牛们对于哪个是最好的游戏机存在分歧。一头奶牛想买 Xbox 360 来玩《光环 3》；另一头想买任天堂 Wii 来玩《任天堂明星大乱斗》；第三头想在 PlayStation 3 上玩《合金装备 4》。FJ 想购买一些游戏机（每种不超过一台）和游戏（每种不超过一款并在给定预算的限制内），以帮助他的奶牛产出最多的牛奶，从而养育更多的孩子。\n\nFJ 调查了 $N$ 台游戏机（$1 \\leq N \\leq 50$），每台游戏机的价格为 $P_i$（$1 \\leq P_i \\leq 1000$），以及独占发布于该游戏机的游戏数量 $G_i$（$1 \\leq G_i \\leq 10$）。当然，奶牛必须先拥有这台游戏机，才能购买该游戏机独占的任何游戏。每款游戏都有一个游戏价格 $GP_j$（$1 \\leq GP_j \\leq 100$）和一个生产值（$1 \\leq PV_j \\leq 1,000,000$），表示奶牛在玩游戏后会产出多少牛奶。最后，农夫约翰有一个预算 $V$（$1 \\leq V \\leq 100,000$），这是他最多能花的钱。帮助他最大化他购买的游戏的生产值之和。\n\n考虑一个例子，$N=3$ 台游戏机，预算 $V=800$ 美元。\n\n第一台游戏机价格为 $300$ 美元，并有两个游戏，价格分别为 $30$ 美元和 $25$ 美元，生产值如下所示：\n| 游戏编号 | 价格 | 生产值 |\n|:-:|:-:|:-:|\n|$1$|\\$$30$|$50$|\n|$2$|\\$$25$|$80$|\n\n第二台游戏机价格为 $600$ 美元，只有一个游戏：\n| 游戏编号 | 价格 | 生产值 |\n|:-:|:-:|:-:|\n|$1$|\\$$50$|$130$|\n\n第三台游戏机价格为 $400$ 美元，有三个游戏：\n| 游戏编号 | 价格 | 生产值 |\n|:-:|:-:|:-:|\n|$1$|\\$$40$|$70$|\n|$2$|\\$$30$|$40$|\n|$3$|\\$$35$|$60$|\n\n农夫约翰应该购买游戏机 $1$ 和 $3$，游戏机 $1$ 的游戏 $2$，以及游戏机 $3$ 的游戏 $1$ 和 $3$，以最大化他所购买游戏的生产值。该值为 210：\n\n```cpp\n                                  生产值\n        预算:      $800      \n        游戏机 1  -$300\n          游戏 2  -$25              80\n        游戏机 3  -$400\n          游戏 1  -$40              70\n          游戏 3  -$35              60\n      -------------------------------------------\n        总计:        0 (>= 0)      210\n```", "inputFormat": "输入第 $1$ 行为两个用空格分隔的整数：$N$ 和 $V$\n\n第 $2$ 到 $N+1$ 行：第 $i+1$ 行描述了游戏机 $i$ 的价格 $P_i$ 和其独占的游戏数量 $G_i$，接下来后面有 $G_i$ 对用空格分隔的整数 $GP_j$ 和 $PV_j$，描述其独占的各款游戏的信息。", "outputFormat": "输出 $1$ 个整数，表示农夫约翰在他的预算内可以获得的最大生产值。", "hint": "（由 ChatGPT 4o 进行翻译）", "locale": "zh-CN"}}}
