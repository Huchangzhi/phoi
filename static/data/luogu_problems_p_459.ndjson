{"pid": "P10308", "type": "P", "difficulty": 4, "samples": [["3 3\n3 1 0\n2 2\n1 0\n2 0", "4\n2\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "洛谷原创", "O2优化", "位运算", "洛谷月赛", "Ad-hoc"], "title": "「Cfz Round 2」Osmanthus", "background": "", "description": "给定一个长度为 $n$ 的序列 $a$。\n\n我们定义一次操作为，**同时**将序列 $a$ 中的**每个**元素 $a_i$ 替换为 $\\bigoplus\\limits_{j=1}^i a_j$（即 $a_1$ 至 $a_i$ 的异或和），其中 $\\bigoplus$ 表示**按位异或**，即 C++ 中的 `^`。\n\n现有 $q$ 次有序的修改，每次修改会给定两个整数 $x_i,p_i$，表示将 $a_{x_i}$ 的值修改为 $p_i$。**修改之间并不独立，每次修改会对后续的修改产生影响**。\n\n你需要在每次修改后，找到**最小**的正整数 $t$，满足进行 $t$ 次操作后的序列 $a$ 与操作前的序列 $a$ 相同。可以证明一定存在满足要求的正整数 $t$。\n\n由于答案可能很大，所以你只需要输出答案对 $(10^9+7)$ 取模的结果。", "inputFormat": "第一行输入两个整数 $n,q$。\n\n第二行输入 $n$ 个整数，表示给定的序列 $a$。\n\n接下来 $q$ 行，每行输入两个整数 $x_i,p_i$，表示一次修改。", "outputFormat": "共 $q$ 行，每行输出一个整数，其中第 $i$ 行的整数表示第 $i$ 次修改后，最小的满足要求的正整数 $t$ 对 $(10^9+7)$ 取模的结果。", "hint": "#### 「样例解释 #1」\n\n第 $1$ 次修改后的序列 $a$ 为 $\\{3,2,0\\}$，此时进行 $1$ 次操作后的序列 $a$ 为 $\\{3,1,1\\}$，进行 $2$ 次操作后的序列 $a$ 为 $\\{3,2,3\\}$，进行 $3$ 次操作后的序列 $a$ 为 $\\{3,1,2\\}$，进行 $4$ 次操作后的序列 $a$ 为 $\\{3,2,0\\}$，所以最小的满足要求的正整数 $t$ 为 $4$。\n\n#### 「数据范围」\n\n对于所有数据，$1 \\le n,q \\le 3\\times10^5$，$0 \\le a_i,p_i \\le 10^9$，$1 \\le x_i \\le n$。\n\n**只有你通过本题的所有测试点，你才能获得本题的分数。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Cfz Round 2」Osmanthus", "background": "", "description": "给定一个长度为 $n$ 的序列 $a$。\n\n我们定义一次操作为，**同时**将序列 $a$ 中的**每个**元素 $a_i$ 替换为 $\\bigoplus\\limits_{j=1}^i a_j$（即 $a_1$ 至 $a_i$ 的异或和），其中 $\\bigoplus$ 表示**按位异或**，即 C++ 中的 `^`。\n\n现有 $q$ 次有序的修改，每次修改会给定两个整数 $x_i,p_i$，表示将 $a_{x_i}$ 的值修改为 $p_i$。**修改之间并不独立，每次修改会对后续的修改产生影响**。\n\n你需要在每次修改后，找到**最小**的正整数 $t$，满足进行 $t$ 次操作后的序列 $a$ 与操作前的序列 $a$ 相同。可以证明一定存在满足要求的正整数 $t$。\n\n由于答案可能很大，所以你只需要输出答案对 $(10^9+7)$ 取模的结果。", "inputFormat": "第一行输入两个整数 $n,q$。\n\n第二行输入 $n$ 个整数，表示给定的序列 $a$。\n\n接下来 $q$ 行，每行输入两个整数 $x_i,p_i$，表示一次修改。", "outputFormat": "共 $q$ 行，每行输出一个整数，其中第 $i$ 行的整数表示第 $i$ 次修改后，最小的满足要求的正整数 $t$ 对 $(10^9+7)$ 取模的结果。", "hint": "#### 「样例解释 #1」\n\n第 $1$ 次修改后的序列 $a$ 为 $\\{3,2,0\\}$，此时进行 $1$ 次操作后的序列 $a$ 为 $\\{3,1,1\\}$，进行 $2$ 次操作后的序列 $a$ 为 $\\{3,2,3\\}$，进行 $3$ 次操作后的序列 $a$ 为 $\\{3,1,2\\}$，进行 $4$ 次操作后的序列 $a$ 为 $\\{3,2,0\\}$，所以最小的满足要求的正整数 $t$ 为 $4$。\n\n#### 「数据范围」\n\n对于所有数据，$1 \\le n,q \\le 3\\times10^5$，$0 \\le a_i,p_i \\le 10^9$，$1 \\le x_i \\le n$。\n\n**只有你通过本题的所有测试点，你才能获得本题的分数。**", "locale": "zh-CN"}}}
{"pid": "P10309", "type": "P", "difficulty": 4, "samples": [["3\n1 2\n2 3\n665496238", "1\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "洛谷原创", "Special Judge", "O2优化", "树的直径", "树论", "构造", "洛谷月赛"], "title": "「Cfz Round 2」Max of Distance", "background": "", "description": "给定一棵包含 $n$ 个结点的树 $G$ 和一个整数 $E$。\n\n你需要构造树 $G$ 中每条边的整数边权 $w_i$，满足：\n\n- $1 \\le w_i \\le 10^9$；\n- 均匀随机选择一个结点 $u$，$\\max\\limits_{v=1}^n\\operatorname{dis}(u,v)$ 的期望对 $998244353$ 取模的值等于 $E$；\n\n或报告无解。\n\n其中，$\\operatorname{dis}(u,v)$ 表示结点 $u,v$ 之间简单路径上的边权和。\n\n如果你不知道如何计算期望对 $998244353$ 取模的结果，请移步 [P2613 【模板】有理数取余](https://www.luogu.com.cn/problem/P2613)。", "inputFormat": "第一行输入一个整数 $n$。\n\n接下来 $n-1$ 行，每行输入两个正整数 $u_i,v_i$，表示树 $G$ 中结点 $u_i,v_i$ 之间存在一条边 $(u_i,v_i)$。\n\n接下来一行，输入一个整数 $E$。", "outputFormat": "输出一行或 $n-1$ 行：\n\n- 若有解，则输出 $n-1$ 行，每行输出一个整数 $w_i$，表示你构造的树 $G$ 中边 $(u_i,v_i)$ 的边权；\n- 若无解，则输出一行，包含一个整数 $-1$。\n\n**所有满足要求的输出均可通过。**", "hint": "#### 「样例解释 #1」\n\n所有 $\\operatorname{dis}$ 的值如下表，其中标红的是行首结点的 $\\operatorname{dis}$ 的最大值。\n\n|$\\operatorname{dis}$|$1$|$2$|$3$|\n|:-:|:-:|:-:|:-:|\n|$1$|$0$|$1$|$\\color{red}3$|\n|$2$|$1$|$0$|$\\color{red}2$|\n|$3$|$\\color{red}3$|$2$|$0$|\n\n可以验证，$E=\\dfrac{3+2+3}{3}=\\dfrac{8}{3}\\equiv 665496238\\pmod {998244353} $。\n\n#### 「数据范围」\n\n对于所有数据，$2\\le n\\le 10^5$，$1 \\le u_i,v_i \\le n$，$0\\le E < 998244353$，保证输入数据形成一棵树。\n\n**只有你通过本题的所有测试点，你才能获得本题的分数。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Cfz Round 2」Max of Distance", "background": "", "description": "给定一棵包含 $n$ 个结点的树 $G$ 和一个整数 $E$。\n\n你需要构造树 $G$ 中每条边的整数边权 $w_i$，满足：\n\n- $1 \\le w_i \\le 10^9$；\n- 均匀随机选择一个结点 $u$，$\\max\\limits_{v=1}^n\\operatorname{dis}(u,v)$ 的期望对 $998244353$ 取模的值等于 $E$；\n\n或报告无解。\n\n其中，$\\operatorname{dis}(u,v)$ 表示结点 $u,v$ 之间简单路径上的边权和。\n\n如果你不知道如何计算期望对 $998244353$ 取模的结果，请移步 [P2613 【模板】有理数取余](https://www.luogu.com.cn/problem/P2613)。", "inputFormat": "第一行输入一个整数 $n$。\n\n接下来 $n-1$ 行，每行输入两个正整数 $u_i,v_i$，表示树 $G$ 中结点 $u_i,v_i$ 之间存在一条边 $(u_i,v_i)$。\n\n接下来一行，输入一个整数 $E$。", "outputFormat": "输出一行或 $n-1$ 行：\n\n- 若有解，则输出 $n-1$ 行，每行输出一个整数 $w_i$，表示你构造的树 $G$ 中边 $(u_i,v_i)$ 的边权；\n- 若无解，则输出一行，包含一个整数 $-1$。\n\n**所有满足要求的输出均可通过。**", "hint": "#### 「样例解释 #1」\n\n所有 $\\operatorname{dis}$ 的值如下表，其中标红的是行首结点的 $\\operatorname{dis}$ 的最大值。\n\n|$\\operatorname{dis}$|$1$|$2$|$3$|\n|:-:|:-:|:-:|:-:|\n|$1$|$0$|$1$|$\\color{red}3$|\n|$2$|$1$|$0$|$\\color{red}2$|\n|$3$|$\\color{red}3$|$2$|$0$|\n\n可以验证，$E=\\dfrac{3+2+3}{3}=\\dfrac{8}{3}\\equiv 665496238\\pmod {998244353} $。\n\n#### 「数据范围」\n\n对于所有数据，$2\\le n\\le 10^5$，$1 \\le u_i,v_i \\le n$，$0\\le E < 998244353$，保证输入数据形成一棵树。\n\n**只有你通过本题的所有测试点，你才能获得本题的分数。**", "locale": "zh-CN"}}}
{"pid": "P10310", "type": "P", "difficulty": 5, "samples": [["4\n3 1\n001\n5 2\n00101\n30 10\n010100110101001010010010011101\n10 1000000000000\n0010110101", "2\n19\n926292963\n340558843"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "洛谷原创", "O2优化", "组合数学", "洛谷月赛"], "title": "「Cfz Round 2」01 String", "background": "", "description": "定义一个 $\\tt{01}$ 串是合法的，当且仅当它的首字符为 $\\tt 0$ 而尾字符为 $\\tt 1$。我们继而定义一个 $\\tt{01}$ 串 $T$ 的权值 $f(T)$ 为，将 $T$ 划分若干个连续的合法子串的方案数。\n\n例如 $f(\\tt{001}) = \\text{1}$，因为它仅可以被分割为 $[\\tt 001]$；$f(\\tt{0101101}) = \\text{4}$，因为它可以被分割为 $[\\tt 0101101][01, 01101][01011, 01][01, 011, 01]$ 共四种不同的方案；而 $f(\\tt{1001010101}) = \\text{0}$。\n\n给定一个长度为 $n$ 的 $\\tt{01}$ 串 $S$。定义 $f_k(l, r) = \\begin{cases} f(S_{l\\dots r}) & k = 0 \\\\ \\displaystyle\\sum_{l\\leq l' \\leq r' \\leq r} f_{k-1}(l', r') & k \\gt 0\\end{cases}$，你需要求出 $f_k(1, n)$ 的值。\n\n由于答案可能很大，所以你只需要输出答案对 $10^9+7$ 取模的结果。", "inputFormat": "**本题有多组测试数据。**\n\n第一行输入一个整数 $T$，表示测试数据组数。\n\n接下来依次输入每组测试数据。对于每组测试数据：\n\n+ 第一行输入两个整数 $n,k$，分别表示 $\\lvert S\\rvert$ 和给定的参数。\n+ 接下来一行，输入一个长度为 $n$ 的 $\\tt{01}$ 串表示 $S$。", "outputFormat": "对于每组数据，输出一行一个整数，表示答案。", "hint": "#### 「样例解释 #1」\n\n对于第 $1$ 组数据，用表格的交叉点表示 $f_k(l, r)$ 的值：\n\n| $\\bm{k = 0}$ | $r = 1$ | $2$ | $3$ |\n| -----------: | :-----: | :-: | :-: |\n| $l = 1$ | $0$ | $0$ | $1$ |\n| $2$ | / | $0$ | $1$ |\n| $3$ | / | / | $0$ |\n\n| $\\bm{k = 1}$ | $r = 1$ | $2$ | $3$ |\n| -----------: | :-----: | :-: | :-: |\n| $l = 1$ | $0$ | $0$ | $2$ |\n| $2$ | / | $0$ | $1$ |\n| $3$ | / | / | $0$ |\n\n其中：\n\n- $f_1(2, 3)= f_0(2, 2) + f_0(2, 3) + f_0(3, 3)= 0 + 1 + 0 = 1$；\n- $f_1(1, 3) = f_0(1, 1) + f_0(1, 2) + f_0(1, 3) + f_0(2, 2) + f_0(2, 3) + f_0(3, 3) = 0 + 0 + 1 + 0 + 1 + 0 = 2$；\n\n所以答案为 $2$。\n \n#### 「数据范围」\n\n设 $\\sum n$ 表示单个测试点中 $n$ 的和。\n\n对于所有数据，$1 \\leq T \\leq 100$，$1 \\leq n \\leq 2\\times 10^5$，$0 \\leq k \\leq 10^{18}$，$\\sum n \\leq 6\\times 10^5$，保证 $S$ 中只包含 $\\tt{0}$ 和 $\\tt{1}$。\n\n**只有你通过本题的所有测试点，你才能获得本题的分数。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Cfz Round 2」01 String", "background": "", "description": "定义一个 $\\tt{01}$ 串是合法的，当且仅当它的首字符为 $\\tt 0$ 而尾字符为 $\\tt 1$。我们继而定义一个 $\\tt{01}$ 串 $T$ 的权值 $f(T)$ 为，将 $T$ 划分若干个连续的合法子串的方案数。\n\n例如 $f(\\tt{001}) = \\text{1}$，因为它仅可以被分割为 $[\\tt 001]$；$f(\\tt{0101101}) = \\text{4}$，因为它可以被分割为 $[\\tt 0101101][01, 01101][01011, 01][01, 011, 01]$ 共四种不同的方案；而 $f(\\tt{1001010101}) = \\text{0}$。\n\n给定一个长度为 $n$ 的 $\\tt{01}$ 串 $S$。定义 $f_k(l, r) = \\begin{cases} f(S_{l\\dots r}) & k = 0 \\\\ \\displaystyle\\sum_{l\\leq l' \\leq r' \\leq r} f_{k-1}(l', r') & k \\gt 0\\end{cases}$，你需要求出 $f_k(1, n)$ 的值。\n\n由于答案可能很大，所以你只需要输出答案对 $10^9+7$ 取模的结果。", "inputFormat": "**本题有多组测试数据。**\n\n第一行输入一个整数 $T$，表示测试数据组数。\n\n接下来依次输入每组测试数据。对于每组测试数据：\n\n+ 第一行输入两个整数 $n,k$，分别表示 $\\lvert S\\rvert$ 和给定的参数。\n+ 接下来一行，输入一个长度为 $n$ 的 $\\tt{01}$ 串表示 $S$。", "outputFormat": "对于每组数据，输出一行一个整数，表示答案。", "hint": "#### 「样例解释 #1」\n\n对于第 $1$ 组数据，用表格的交叉点表示 $f_k(l, r)$ 的值：\n\n| $\\bm{k = 0}$ | $r = 1$ | $2$ | $3$ |\n| -----------: | :-----: | :-: | :-: |\n| $l = 1$ | $0$ | $0$ | $1$ |\n| $2$ | / | $0$ | $1$ |\n| $3$ | / | / | $0$ |\n\n| $\\bm{k = 1}$ | $r = 1$ | $2$ | $3$ |\n| -----------: | :-----: | :-: | :-: |\n| $l = 1$ | $0$ | $0$ | $2$ |\n| $2$ | / | $0$ | $1$ |\n| $3$ | / | / | $0$ |\n\n其中：\n\n- $f_1(2, 3)= f_0(2, 2) + f_0(2, 3) + f_0(3, 3)= 0 + 1 + 0 = 1$；\n- $f_1(1, 3) = f_0(1, 1) + f_0(1, 2) + f_0(1, 3) + f_0(2, 2) + f_0(2, 3) + f_0(3, 3) = 0 + 0 + 1 + 0 + 1 + 0 = 2$；\n\n所以答案为 $2$。\n \n#### 「数据范围」\n\n设 $\\sum n$ 表示单个测试点中 $n$ 的和。\n\n对于所有数据，$1 \\leq T \\leq 100$，$1 \\leq n \\leq 2\\times 10^5$，$0 \\leq k \\leq 10^{18}$，$\\sum n \\leq 6\\times 10^5$，保证 $S$ 中只包含 $\\tt{0}$ 和 $\\tt{1}$。\n\n**只有你通过本题的所有测试点，你才能获得本题的分数。**", "locale": "zh-CN"}}}
{"pid": "P10311", "type": "P", "difficulty": 6, "samples": [["3\n3 5\n1 2 3\n2 2\n1 2\n4 100000\n1 2 5 9", "1 2 1\n-1\n1 1 3 4\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "洛谷原创", "Special Judge", "O2优化", "构造", "洛谷月赛", "Ad-hoc"], "title": "「Cfz Round 2」Weighted Mean", "background": "", "description": "给定一个长度为 $n$ 的序列 $a$ 和一个整数 $m$，保证序列 $a$ 中的每个元素均为不大于 $m$ 的正整数，且每个元素互不相等。\n\n你需要构造一个长度为 $n$ 的序列 $b$，满足：\n\n- 序列 $b$ 中的每个元素均为不大于 $m$ 的正整数；\n- $\\dfrac{\\sum\\limits_{i=1}^n (a_i \\cdot b_i)}{\\sum\\limits_{i=1}^n b_i}$ 为整数，即 $a_i$ 的权为 $b_i$ 时，序列 $a$ 的加权平均数为整数；\n- 不存在有序三元整数组 $(i,j,k)$，满足 $1\\le i<j<k\\le n$ 且 $b_i=b_j=b_k$；\n\n或报告无解。", "inputFormat": "**本题有多组测试数据。**\n\n第一行输入一个整数 $T$，表示测试数据组数。\n\n接下来依次输入每组测试数据。对于每组测试数据：\n\n- 第一行输入两个整数 $n,m$。\n- 第二行输入 $n$ 个整数，表示给定的序列 $a$。", "outputFormat": "对于每组测试数据，输出一行：\n\n- 若存在满足条件的序列 $b$，则输出用空格分隔的 $n$ 个整数，表示你构造的序列 $b$；\n- 若不存在满足条件的序列 $b$，则输出 $-1$。\n\n**所有满足要求的输出均可通过。**", "hint": "#### 「样例解释 #1」\n\n对于第 $1$ 组测试数据，给出的样例的加权平均数为 $\\dfrac{1 \\times 1+2 \\times 2 + 3 \\times 1}{1+2+1}=2$，为整数。\n\n输出 `1 5 1` 也视作正确，其加权平均数为 $2$。\n\n但是输出 `1 6 1` 不正确，虽然其加权平均数为 $2$，但是 $b_2>5$。\n\n输出 `1 2 3` 也不正确，其加权平均数为 $\\dfrac{7}{3}$，不为整数。\n\n输出 `1 1 1` 也不正确，虽然其加权平均数为 $2$，但是存在有序三元组 $(1,2,3)$ 满足 $1 \\leq 1 < 2 < 3 \\leq 3$ 且 $b_1=b_2=b_3$。\n\n对于第 $2$ 组测试数据，可以证明不存在满足条件的序列 $b$。\n\n对于第 $3$ 组测试数据，给出的样例的加权平均数为 $\\dfrac{1 \\times 1+2 \\times 1 + 5 \\times 3+9 \\times 4}{1+1+3+4}=6$，为整数。\n\n#### 「数据范围」\n\n设 $\\sum n$ 表示单个测试点中 $n$ 的和。\n\n对于所有数据，$1 \\le T \\le 1000$，$1 \\le n \\le 10^6$，$1 \\le a_i \\le m \\le 10^9$，$\\sum n \\le 10^6$，保证序列 $a$ 中的每个元素间互不相等。\n\n**只有你通过本题的所有测试点，你才能获得本题的分数。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Cfz Round 2」Weighted Mean", "background": "", "description": "给定一个长度为 $n$ 的序列 $a$ 和一个整数 $m$，保证序列 $a$ 中的每个元素均为不大于 $m$ 的正整数，且每个元素互不相等。\n\n你需要构造一个长度为 $n$ 的序列 $b$，满足：\n\n- 序列 $b$ 中的每个元素均为不大于 $m$ 的正整数；\n- $\\dfrac{\\sum\\limits_{i=1}^n (a_i \\cdot b_i)}{\\sum\\limits_{i=1}^n b_i}$ 为整数，即 $a_i$ 的权为 $b_i$ 时，序列 $a$ 的加权平均数为整数；\n- 不存在有序三元整数组 $(i,j,k)$，满足 $1\\le i<j<k\\le n$ 且 $b_i=b_j=b_k$；\n\n或报告无解。", "inputFormat": "**本题有多组测试数据。**\n\n第一行输入一个整数 $T$，表示测试数据组数。\n\n接下来依次输入每组测试数据。对于每组测试数据：\n\n- 第一行输入两个整数 $n,m$。\n- 第二行输入 $n$ 个整数，表示给定的序列 $a$。", "outputFormat": "对于每组测试数据，输出一行：\n\n- 若存在满足条件的序列 $b$，则输出用空格分隔的 $n$ 个整数，表示你构造的序列 $b$；\n- 若不存在满足条件的序列 $b$，则输出 $-1$。\n\n**所有满足要求的输出均可通过。**", "hint": "#### 「样例解释 #1」\n\n对于第 $1$ 组测试数据，给出的样例的加权平均数为 $\\dfrac{1 \\times 1+2 \\times 2 + 3 \\times 1}{1+2+1}=2$，为整数。\n\n输出 `1 5 1` 也视作正确，其加权平均数为 $2$。\n\n但是输出 `1 6 1` 不正确，虽然其加权平均数为 $2$，但是 $b_2>5$。\n\n输出 `1 2 3` 也不正确，其加权平均数为 $\\dfrac{7}{3}$，不为整数。\n\n输出 `1 1 1` 也不正确，虽然其加权平均数为 $2$，但是存在有序三元组 $(1,2,3)$ 满足 $1 \\leq 1 < 2 < 3 \\leq 3$ 且 $b_1=b_2=b_3$。\n\n对于第 $2$ 组测试数据，可以证明不存在满足条件的序列 $b$。\n\n对于第 $3$ 组测试数据，给出的样例的加权平均数为 $\\dfrac{1 \\times 1+2 \\times 1 + 5 \\times 3+9 \\times 4}{1+1+3+4}=6$，为整数。\n\n#### 「数据范围」\n\n设 $\\sum n$ 表示单个测试点中 $n$ 的和。\n\n对于所有数据，$1 \\le T \\le 1000$，$1 \\le n \\le 10^6$，$1 \\le a_i \\le m \\le 10^9$，$\\sum n \\le 10^6$，保证序列 $a$ 中的每个元素间互不相等。\n\n**只有你通过本题的所有测试点，你才能获得本题的分数。**", "locale": "zh-CN"}}}
{"pid": "P10312", "type": "P", "difficulty": 3, "samples": [["3\nHorel,ol!lWd", "Hello,World!"], ["5\nccehgyaefnpeoobe{lcirg}epriec_ora_g", "cyberpeace{railfence_cipher_gogogo}"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["模拟", "字符串", "2024", "高校校赛"], "title": "[SHUPC 2024] 栅栏密码", "background": "", "description": "栅栏密码（rail fence）是一种很基础的移位密码。\n\n我们将明文 `Hello,World!` 按如下方式排列：\n\n```\nH...o...r\n.e.l.,.o.l.!\n..l...W...d\n```\n\n即把明文 `Hello,World!` 排列成若干个 `\\/\\/\\/` 的形状，然后再逐行按从左到右的顺序取出字符，形成密文。例如第一行为 `Hor`，第二行为 `el,ol!`，第三行为 `lWd`，最终形成的密文为 `Horel,ol!lWd`。\n\n若按上述方式排列的密文有 $h$ 行，则称该栅栏密码的高度为 $h$。\n\n现在我们给出高度 $h$ 和一行密文字符串 $s$，请你输出一行明文字符串 $plain$。\n", "inputFormat": "第一行读入一个数字 $h\\ (2\\le h \\le10)$，表示密码的高度。\n\n第二行读入一个字符串 $s\\ (1\\le |s| \\le 10^5)$，表示密文。", "outputFormat": "一个字符串 $plain$，表示明文。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[SHUPC 2024] 栅栏密码", "background": "", "description": "栅栏密码（rail fence）是一种很基础的移位密码。\n\n我们将明文 `Hello,World!` 按如下方式排列：\n\n```\nH...o...r\n.e.l.,.o.l.!\n..l...W...d\n```\n\n即把明文 `Hello,World!` 排列成若干个 `\\/\\/\\/` 的形状，然后再逐行按从左到右的顺序取出字符，形成密文。例如第一行为 `Hor`，第二行为 `el,ol!`，第三行为 `lWd`，最终形成的密文为 `Horel,ol!lWd`。\n\n若按上述方式排列的密文有 $h$ 行，则称该栅栏密码的高度为 $h$。\n\n现在我们给出高度 $h$ 和一行密文字符串 $s$，请你输出一行明文字符串 $plain$。\n", "inputFormat": "第一行读入一个数字 $h\\ (2\\le h \\le10)$，表示密码的高度。\n\n第二行读入一个字符串 $s\\ (1\\le |s| \\le 10^5)$，表示密文。", "outputFormat": "一个字符串 $plain$，表示明文。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P10313", "type": "P", "difficulty": 2, "samples": [["3 3\n...\n...\n...", "9"], ["3 3\n..#\n.#.\n#..", "4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2024", "高校校赛"], "title": "[SHUPC 2024]  占地斗士！", "background": "一个名为“占地斗士”的卡牌小游戏深深的吸引了小 A\n。目前小 A 正在进行卡牌摆放练习，但是她并不熟练，于是想要请教擅长编程的你来解决这个问题。", "description": "游戏的具体规则为：游戏在一个 $n\\times m$ 的方格矩阵中进行，`.` 代表这个格子可以被放置，`#` 代表这个格子不能被放置。你手中有 $4$ 种形状各异的卡牌，每种卡牌均**只有一张**。你需要将卡牌放置在棋盘中，卡牌可以放置在任意位置，但是卡牌占领的格子不能重叠，也不能放在不能放置的格子上。目标是要使得卡牌占领的格子数量尽可能多。\n小 A 现在想知道，在最优的摆放策略下，最多可以占领多少个格子？\n![](https://cdn.luogu.com.cn/upload/image_hosting/l9d77whu.png)", "inputFormat": "第一行输入两个正整数 $n,m\\ (1 \\le n,m\\le10) $\n\n接下来 $n$ 行，每行 $m$ 个字符串，保证字符仅包含 `.` 和 `#` ，代表棋盘的放置类型。", "outputFormat": "输出一个整数，代表答案。", "hint": "样例解释：\n\n样例一最优摆放方法如下，使用第一种和第二种卡牌，最多可以占领 $9$ 个格子。\n\n![img1](https://cdn.luogu.com.cn/upload/image_hosting/zt41mdit.png)\n\n样例二最优摆放方法如下，使用第二种卡牌，最多可以占领 $4$ 个格子，红色代表这个格子不能放置卡牌。\n\n![img2](https://cdn.luogu.com.cn/upload/image_hosting/352061x2.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[SHUPC 2024]  占地斗士！", "background": "一个名为“占地斗士”的卡牌小游戏深深的吸引了小 A\n。目前小 A 正在进行卡牌摆放练习，但是她并不熟练，于是想要请教擅长编程的你来解决这个问题。", "description": "游戏的具体规则为：游戏在一个 $n\\times m$ 的方格矩阵中进行，`.` 代表这个格子可以被放置，`#` 代表这个格子不能被放置。你手中有 $4$ 种形状各异的卡牌，每种卡牌均**只有一张**。你需要将卡牌放置在棋盘中，卡牌可以放置在任意位置，但是卡牌占领的格子不能重叠，也不能放在不能放置的格子上。目标是要使得卡牌占领的格子数量尽可能多。\n小 A 现在想知道，在最优的摆放策略下，最多可以占领多少个格子？\n![](https://cdn.luogu.com.cn/upload/image_hosting/l9d77whu.png)", "inputFormat": "第一行输入两个正整数 $n,m\\ (1 \\le n,m\\le10) $\n\n接下来 $n$ 行，每行 $m$ 个字符串，保证字符仅包含 `.` 和 `#` ，代表棋盘的放置类型。", "outputFormat": "输出一个整数，代表答案。", "hint": "样例解释：\n\n样例一最优摆放方法如下，使用第一种和第二种卡牌，最多可以占领 $9$ 个格子。\n\n![img1](https://cdn.luogu.com.cn/upload/image_hosting/zt41mdit.png)\n\n样例二最优摆放方法如下，使用第二种卡牌，最多可以占领 $4$ 个格子，红色代表这个格子不能放置卡牌。\n\n![img2](https://cdn.luogu.com.cn/upload/image_hosting/352061x2.png)", "locale": "zh-CN"}}}
{"pid": "P10314", "type": "P", "difficulty": 2, "samples": [["3\n1.10\n1.72\n2.34", "1.000000\n1.000000\n2.000000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288]}, "tags": ["2024", "Special Judge", "高校校赛"], "title": "[SHUPC 2024] 函数", "background": "", "description": "小 A 正在学习函数，有一天她发现了一个奇妙的函数：\n$$\nf(x)=x-0.5+\\frac{\\arctan(\\cot(\\pi x))}{\\pi}\n$$\n\n她非常喜欢这个函数。现在，她会对你提出 $T$ 个询问，每个询问包含一个浮点数 $x$ ，而你只需要回答 $f(x)$ 的值是多少。\n\n选手输出与标准答案的绝对误差或相对误差不超过 $10^{-6}$ 即视为正确。", "inputFormat": "第一行一个整数 $T\\ (T\\le 10^4)$ 表示数据组数。\n\n接下来 $T$ 行，每行一个浮点数 $x$ ，保证 $0 \\le x \\le 10^9$ 且 $x \\notin \\N$（即 $x$ 不为自然数）。", "outputFormat": "输出 $T$ 行，每行一个数，代表答案。\n\n选手输出与标准答案的绝对误差或相对误差不超过 $10^{-6}$ 即视为正确。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[SHUPC 2024] 函数", "background": "", "description": "小 A 正在学习函数，有一天她发现了一个奇妙的函数：\n$$\nf(x)=x-0.5+\\frac{\\arctan(\\cot(\\pi x))}{\\pi}\n$$\n\n她非常喜欢这个函数。现在，她会对你提出 $T$ 个询问，每个询问包含一个浮点数 $x$ ，而你只需要回答 $f(x)$ 的值是多少。\n\n选手输出与标准答案的绝对误差或相对误差不超过 $10^{-6}$ 即视为正确。", "inputFormat": "第一行一个整数 $T\\ (T\\le 10^4)$ 表示数据组数。\n\n接下来 $T$ 行，每行一个浮点数 $x$ ，保证 $0 \\le x \\le 10^9$ 且 $x \\notin \\N$（即 $x$ 不为自然数）。", "outputFormat": "输出 $T$ 行，每行一个数，代表答案。\n\n选手输出与标准答案的绝对误差或相对误差不超过 $10^{-6}$ 即视为正确。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P10315", "type": "P", "difficulty": 5, "samples": [["3 3\n1 3\n2 1 3\n1 2\n0 0 0\n0 2 1", "2 1 1"], ["3 3\n2 2 3\n2 1 3\n1 1\n0 0 0\n0 1 2", "niuza"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2024", "Special Judge", "高斯消元", "高校校赛"], "title": "[SHUPC 2024] 原神，启动！", "background": "", "description": "雷元素方碑具有如下性质：\n\n1. 具有 $m$ 种状态，$0,1,\\cdots,m-1$ 中的一种；\n2. 方碑受到一次攻击会进入下一个状态（$m-1$ 的下一个状态是$0$）；\n3. 某个方碑受到一次攻击时会带动其它一些方碑一起进入下一个状态。\n\n当 $n$ 个方碑的状态相同时，解谜成功。但是小 A 觉得游戏里的方碑解谜太简单了，只需要使用刻晴的“斩尽牛杂”将元素方碑全部胡乱攻击一遍就能解谜成功，于是他开始思考更复杂的版本。\n\n现在有 $n$ 个雷元素方碑，每个雷元素方碑有 $m$ 种状态。对于每个方碑 $i$ ，当它受到攻击时，都有 $k_i$ 个其它方碑和它一起进入下一个状态。\n\n给定 $n$ 个雷元素方碑的初始状态 $s$ 和终止状态 $t$，请你计算需要分别攻击每个方碑多少下，才能将雷元素方碑从状态 $s$ 变换到 $t$。\n\n如果无解请输出`niuza`。", "inputFormat": "第一行读入两个正整数 $n,m\\ (1\\le n\\le100,m\\le10^9)$，**保证 $m$ 为素数**。\n\n接下来 $n$ 行，第 $i$ 行会读取如下数据：\n\n- 先读入一个数字 $k\\ (0\\le k<n)$，表示攻击该方碑会带动的方碑数。\n- 接下来读入 $k$ 个数字，第 $j$ 个数 $a_j\\ (1\\le a_j \\le n, a_j\\neq i$ 且 $a_{j-1}<a_j)$ 表示 $i$ 方碑带动的方碑编号。\n\n接下来两行：\n\n第一行读入 $n$ 个数，第 $i$ 个数 $s_i$ 表示第 $i$ 个雷元素方碑的初始状态 $s_i\\ (0\\le s_i <m)$。\n\n第二行读入 $n$ 个数，第 $i$ 个数 $t_i$ 表示第 $i$ 个雷元素方碑的终止状态 $t_i\\ (0\\le t_i <m)$​。", "outputFormat": "如果有解，输出 $n$ 个小于 $m$ 的数，分别表示应该攻击每个方碑多少次，用空格隔开。对于多个解，输出任意一个即可。\n\n如果无解，请输出 `niuza`。", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[SHUPC 2024] 原神，启动！", "background": "", "description": "雷元素方碑具有如下性质：\n\n1. 具有 $m$ 种状态，$0,1,\\cdots,m-1$ 中的一种；\n2. 方碑受到一次攻击会进入下一个状态（$m-1$ 的下一个状态是$0$）；\n3. 某个方碑受到一次攻击时会带动其它一些方碑一起进入下一个状态。\n\n当 $n$ 个方碑的状态相同时，解谜成功。但是小 A 觉得游戏里的方碑解谜太简单了，只需要使用刻晴的“斩尽牛杂”将元素方碑全部胡乱攻击一遍就能解谜成功，于是他开始思考更复杂的版本。\n\n现在有 $n$ 个雷元素方碑，每个雷元素方碑有 $m$ 种状态。对于每个方碑 $i$ ，当它受到攻击时，都有 $k_i$ 个其它方碑和它一起进入下一个状态。\n\n给定 $n$ 个雷元素方碑的初始状态 $s$ 和终止状态 $t$，请你计算需要分别攻击每个方碑多少下，才能将雷元素方碑从状态 $s$ 变换到 $t$。\n\n如果无解请输出`niuza`。", "inputFormat": "第一行读入两个正整数 $n,m\\ (1\\le n\\le100,m\\le10^9)$，**保证 $m$ 为素数**。\n\n接下来 $n$ 行，第 $i$ 行会读取如下数据：\n\n- 先读入一个数字 $k\\ (0\\le k<n)$，表示攻击该方碑会带动的方碑数。\n- 接下来读入 $k$ 个数字，第 $j$ 个数 $a_j\\ (1\\le a_j \\le n, a_j\\neq i$ 且 $a_{j-1}<a_j)$ 表示 $i$ 方碑带动的方碑编号。\n\n接下来两行：\n\n第一行读入 $n$ 个数，第 $i$ 个数 $s_i$ 表示第 $i$ 个雷元素方碑的初始状态 $s_i\\ (0\\le s_i <m)$。\n\n第二行读入 $n$ 个数，第 $i$ 个数 $t_i$ 表示第 $i$ 个雷元素方碑的终止状态 $t_i\\ (0\\le t_i <m)$​。", "outputFormat": "如果有解，输出 $n$ 个小于 $m$ 的数，分别表示应该攻击每个方碑多少次，用空格隔开。对于多个解，输出任意一个即可。\n\n如果无解，请输出 `niuza`。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P10316", "type": "P", "difficulty": 3, "samples": [["2 17 10 6\n3\n1 1 2\n2 1 7\n2\n1 2\n3 4", "2"], ["2 20 10 8\n3\n10 2 3\n8 2 1\n1\n1\n1", "-1"], ["2 17 10 9\n3\n1 1 2\n2 2 7\n2\n1 2\n3 4", "0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2024", "高校校赛"], "title": "[SHUPC 2024] 为美好的世界献上爆焰！", "background": "小 A 目前正在带着小 B 进行攻打魔王城的每日一爆演练。", "description": "具体来说，魔王城的结界护盾共有 $x$ 的血量，小 A 想在 $n$ 天内完成对魔王城护盾的破坏。每天小 B 的魔力值会恢复至 $m$ ，且魔力值的上限为 $M$ ，使用爆裂魔法时每 $1$ 点魔力值可以对魔王城护盾造成 $1$ 点伤害。当然，爆裂魔法每天只能使用一次。\n\n为了确保小 B 可以造成充足的伤害，小 A 每天可以花钱去商店购买魔晶石为小 B 增加魔力值。但是商店每天出售的魔晶石的数量、价格、和魔力值都有所不同。且当天出售的**魔晶石只能当天使用**，不然会过期，无法补充魔力。小A现在想知道，如果要小 B 能够顺利爆破魔王城的护盾，最少需要花费多少钱？（如果无法完成破坏，则输出 `-1`）\n\n**注意**：由于小 B 的魔力值具有上限，因此当魔晶石魔力含量 $h$ 加上小 B 当前魔力值 $m$ 大于等于 $M$ 时，使用该魔晶石只能使小 B 的魔力值变为 $M$ ，也就是说 $ m'=\\min(M,m+h)$ 。", "inputFormat": "第一行输入四个正整数，$n,x,M,m$ （$1 \\le n,x,M \\le 5000,m \\le M$）。\n\n接下来会有 $n$ 组数据，每组数据有三行。\n\n第一行代表第 $i$ 天出售的魔晶石数量 $\\text{num}_i\\ (1 \\le \\text{num} \\le 5000)$ ，数据保证 $\\sum_{i=1}^{n}\\text{num}_i\\le 5000$。\n\n第二行共 $\\text{num}_i$ 个正整数，代表第 $i$ 天出售的第 $j$ 个魔晶石的价格 $p_{i,j}\\ (1\\le p_{i,j} \\le 10^9)$ 。\n\n第三行共 $\\text{num}_i$ 个正整数，代表第 $i$ 天出售的第 $j$ 个魔晶石的魔力值 $h_{i,j}\\ (1 \\le h_{i,j} \\le M)$ ，数据保证 $\\sum_{i=1}^{n}\\sum_{j=1}^{\\text{num}_i}h_{i,j}\\le 5000$。", "outputFormat": "输出一个整数，代表所求的答案。", "hint": "样例解释：\n\n样例 1 中，可以选择购买第一天的第一个魔晶石，花费为 $1$，当天总魔力值为 $8$。再购买第二天的第一个魔晶石，花费为 $1$，当天总魔力值为 $9$。这样两天总共可以造成 $17$ 点伤害，成功破坏结界，且花费最少为 $2$。\n\n样例 2 中，因为存在魔力值上限，因此第一天最多造成 $10$ 点伤害，而第二天最多造成 $9$ 点伤害，因此无法破坏结界。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[SHUPC 2024] 为美好的世界献上爆焰！", "background": "小 A 目前正在带着小 B 进行攻打魔王城的每日一爆演练。", "description": "具体来说，魔王城的结界护盾共有 $x$ 的血量，小 A 想在 $n$ 天内完成对魔王城护盾的破坏。每天小 B 的魔力值会恢复至 $m$ ，且魔力值的上限为 $M$ ，使用爆裂魔法时每 $1$ 点魔力值可以对魔王城护盾造成 $1$ 点伤害。当然，爆裂魔法每天只能使用一次。\n\n为了确保小 B 可以造成充足的伤害，小 A 每天可以花钱去商店购买魔晶石为小 B 增加魔力值。但是商店每天出售的魔晶石的数量、价格、和魔力值都有所不同。且当天出售的**魔晶石只能当天使用**，不然会过期，无法补充魔力。小A现在想知道，如果要小 B 能够顺利爆破魔王城的护盾，最少需要花费多少钱？（如果无法完成破坏，则输出 `-1`）\n\n**注意**：由于小 B 的魔力值具有上限，因此当魔晶石魔力含量 $h$ 加上小 B 当前魔力值 $m$ 大于等于 $M$ 时，使用该魔晶石只能使小 B 的魔力值变为 $M$ ，也就是说 $ m'=\\min(M,m+h)$ 。", "inputFormat": "第一行输入四个正整数，$n,x,M,m$ （$1 \\le n,x,M \\le 5000,m \\le M$）。\n\n接下来会有 $n$ 组数据，每组数据有三行。\n\n第一行代表第 $i$ 天出售的魔晶石数量 $\\text{num}_i\\ (1 \\le \\text{num} \\le 5000)$ ，数据保证 $\\sum_{i=1}^{n}\\text{num}_i\\le 5000$。\n\n第二行共 $\\text{num}_i$ 个正整数，代表第 $i$ 天出售的第 $j$ 个魔晶石的价格 $p_{i,j}\\ (1\\le p_{i,j} \\le 10^9)$ 。\n\n第三行共 $\\text{num}_i$ 个正整数，代表第 $i$ 天出售的第 $j$ 个魔晶石的魔力值 $h_{i,j}\\ (1 \\le h_{i,j} \\le M)$ ，数据保证 $\\sum_{i=1}^{n}\\sum_{j=1}^{\\text{num}_i}h_{i,j}\\le 5000$。", "outputFormat": "输出一个整数，代表所求的答案。", "hint": "样例解释：\n\n样例 1 中，可以选择购买第一天的第一个魔晶石，花费为 $1$，当天总魔力值为 $8$。再购买第二天的第一个魔晶石，花费为 $1$，当天总魔力值为 $9$。这样两天总共可以造成 $17$ 点伤害，成功破坏结界，且花费最少为 $2$。\n\n样例 2 中，因为存在魔力值上限，因此第一天最多造成 $10$ 点伤害，而第二天最多造成 $9$ 点伤害，因此无法破坏结界。", "locale": "zh-CN"}}}
{"pid": "P10317", "type": "P", "difficulty": 2, "samples": [["3\n10\n2 3 3 3 1 1 1 1 1 1 \n7 8 9 1 2 3 4 5 6 6\n13 13 13 13 3 3 3 3\n10\n2 2 3 1 1 1 1 1 1 1\n10 9 2 2 2 2 2 2 2 2\n5 5 5 5 5 5 5 6\n8\n1 1 1 1 1 1 1 1\n15 15 15 15 15 15 15 15\n1 1 1 1 1 1 1 1", "Yes\nNo\nNo"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2024", "高校校赛"], "title": "[SHUPC 2024] 小A的皇室战争卡组", "background": "", "description": "小 A 很喜欢玩皇室战争这款游戏。皇室战争的卡牌种类共有 $3$ 种，分别为部队、建筑和法术。一个卡组会携带 $8$ 张卡牌，一个合理的卡组会包含 $0\\sim 1$ 张建筑牌、 $1\\sim 3$ 张法术牌，部队牌则没有限制。每张卡牌都有自己独立的等级 $a_i$ 和种类 $c_i$。\n\n现在小 A 想和 小 B 进行友谊战，因此需要来构建出战卡组。小 A 共有 $n$ 张卡牌，卡牌的类型与等级已知，且 小 B 的每张出战卡牌的等级已知。由于小 A 对自己的水平非常自信，因此只要 **出战卡牌的平均等级 $\\ge$ 对手出战卡牌的平均等级 $-2$**，**且卡组为一个合理的卡组**，则他就能确保取胜。\n\n现在请你帮小 A​ 想想，他可以确保取胜吗？", "inputFormat": "第一行一个整数 $T\\ (T\\le 10^3)$ 表示数据组数。\n\n每组第一行输入一个正整数 $n\\ (8 \\le n\\le 10^5)$ ，代表 $小A$ 的卡牌总数，保证 $\\sum n \\le 10^5$\n\n每组第二行输入 $n$ 个正整数，代表每张卡牌的种类 $c_i\\ (1 \\le c_i \\le 3)$ ，其中种类 $1$ 代表部队卡，种类 $2$ 代表建筑卡，种类 $3$ 代表法术卡。 \n\n每组第三行输入 $n$ 个正整数，代表每张卡牌的等级 $a_i\\ (1 \\le a_i \\le 15)$\n\n每组第四行输入 $8$ 个正整数，代表 小 B 每张卡牌的等级 $x_i\\ (1 \\le x_i \\le 15)$。", "outputFormat": "共 $T$ 行，每行一个字符串。如果 $小A$ 可以取胜则输出 `Yes`，否则输出 `No`", "hint": "样例解释：\n\n在第一组样例中，小A可以取第1,2,3,6,7,8,9,10张卡牌，此时出战卡组的平均等级为6级，而小B的出战卡组平均等级为8级，$小A的平均等级 \\ge 小B的平均等级-2$，因此小A可以确保胜利。\n\n在第二组样例中，无论小A如何配置卡组都无法使平均等级满足条件，因此不能获胜。\n\n在第三组样例中，小A无法配置出一个合理的卡组，因此也不能获胜。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[SHUPC 2024] 小A的皇室战争卡组", "background": "", "description": "小 A 很喜欢玩皇室战争这款游戏。皇室战争的卡牌种类共有 $3$ 种，分别为部队、建筑和法术。一个卡组会携带 $8$ 张卡牌，一个合理的卡组会包含 $0\\sim 1$ 张建筑牌、 $1\\sim 3$ 张法术牌，部队牌则没有限制。每张卡牌都有自己独立的等级 $a_i$ 和种类 $c_i$。\n\n现在小 A 想和 小 B 进行友谊战，因此需要来构建出战卡组。小 A 共有 $n$ 张卡牌，卡牌的类型与等级已知，且 小 B 的每张出战卡牌的等级已知。由于小 A 对自己的水平非常自信，因此只要 **出战卡牌的平均等级 $\\ge$ 对手出战卡牌的平均等级 $-2$**，**且卡组为一个合理的卡组**，则他就能确保取胜。\n\n现在请你帮小 A​ 想想，他可以确保取胜吗？", "inputFormat": "第一行一个整数 $T\\ (T\\le 10^3)$ 表示数据组数。\n\n每组第一行输入一个正整数 $n\\ (8 \\le n\\le 10^5)$ ，代表 $小A$ 的卡牌总数，保证 $\\sum n \\le 10^5$\n\n每组第二行输入 $n$ 个正整数，代表每张卡牌的种类 $c_i\\ (1 \\le c_i \\le 3)$ ，其中种类 $1$ 代表部队卡，种类 $2$ 代表建筑卡，种类 $3$ 代表法术卡。 \n\n每组第三行输入 $n$ 个正整数，代表每张卡牌的等级 $a_i\\ (1 \\le a_i \\le 15)$\n\n每组第四行输入 $8$ 个正整数，代表 小 B 每张卡牌的等级 $x_i\\ (1 \\le x_i \\le 15)$。", "outputFormat": "共 $T$ 行，每行一个字符串。如果 $小A$ 可以取胜则输出 `Yes`，否则输出 `No`", "hint": "样例解释：\n\n在第一组样例中，小A可以取第1,2,3,6,7,8,9,10张卡牌，此时出战卡组的平均等级为6级，而小B的出战卡组平均等级为8级，$小A的平均等级 \\ge 小B的平均等级-2$，因此小A可以确保胜利。\n\n在第二组样例中，无论小A如何配置卡组都无法使平均等级满足条件，因此不能获胜。\n\n在第三组样例中，小A无法配置出一个合理的卡组，因此也不能获胜。", "locale": "zh-CN"}}}
{"pid": "P10318", "type": "P", "difficulty": 5, "samples": [["5\n3 2 5 4 3", "14 12 11 10 10"], ["6\n171 814 2313 6676 196 897", "3861 1719 1076 1051 1026 1026"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2024", "差分", "单调栈", "高校校赛"], "title": "[SHUPC 2024] 彭罗斯水槽", "background": "", "description": "小 A 在上课时出现了幻觉，他幻想出了若干个水槽，它们环形排列，每一个水槽里的水都会流向下一个水槽（当然在现实里这是不可能的）。\n\n于是小 A 开始思考这样一个问题：\n\n有 $n$ 个水槽环形排列，每个水槽都有一个容量，初始时水都是满的。接下来每一秒，水槽 $i$ 的水全部转移到 $i+1$ （特殊的，第 $n$ 个水槽的水会转移到第 $1$ 个），如果转移的水超出了容量就会溢出。\n\n现在他想知道，在接下来的 $1$ 至 $n$ 秒内，每一秒所有水槽的水量总和。", "inputFormat": "第一行读入一个正整数 $n\\ (1\\le n\\le 10^5)$ ，表示水槽的个数。\n\n第二行读入 $n$ 个数字，第 $i$ 个数字 $a_i\\ (1\\le a_i\\le 10^9)$ 表示水槽 $i$ 的容量。", "outputFormat": "$n$ 个数字，用空格隔开。分别表示 $1$ 至 $n$ 秒，每一秒所有水槽的水量总和。\n", "hint": "", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[SHUPC 2024] 彭罗斯水槽", "background": "", "description": "小 A 在上课时出现了幻觉，他幻想出了若干个水槽，它们环形排列，每一个水槽里的水都会流向下一个水槽（当然在现实里这是不可能的）。\n\n于是小 A 开始思考这样一个问题：\n\n有 $n$ 个水槽环形排列，每个水槽都有一个容量，初始时水都是满的。接下来每一秒，水槽 $i$ 的水全部转移到 $i+1$ （特殊的，第 $n$ 个水槽的水会转移到第 $1$ 个），如果转移的水超出了容量就会溢出。\n\n现在他想知道，在接下来的 $1$ 至 $n$ 秒内，每一秒所有水槽的水量总和。", "inputFormat": "第一行读入一个正整数 $n\\ (1\\le n\\le 10^5)$ ，表示水槽的个数。\n\n第二行读入 $n$ 个数字，第 $i$ 个数字 $a_i\\ (1\\le a_i\\le 10^9)$ 表示水槽 $i$ 的容量。", "outputFormat": "$n$ 个数字，用空格隔开。分别表示 $1$ 至 $n$ 秒，每一秒所有水槽的水量总和。\n", "hint": "", "locale": "zh-CN"}}}
{"pid": "P10320", "type": "P", "difficulty": 3, "samples": [["2 1", "0"], ["3 6", "3"], ["16 335", "7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "洛谷原创", "枚举", "洛谷比赛"], "title": "勇气（Courage）", "background": "数学家渴求真理的美德，永不停歇的力量的源泉 —— 勇气。\n****\n「勇气之光」乔伊，是杜沃夫族的接任族长，也是拥有古代战神之力的战士。", "description": "乔伊有一项技能，可以将 $x$ 的攻击力强化为 $x^2$。但这个技能并不完美，除了第一次之外，每一次**使用该技能前**，攻击力都会衰减到之前的一半。\n\n比如最初的攻击力为 $\\color{red}6$，强化后变成 $6^2=\\color{red}{36}$。而在下一次强化前，会先衰减到 $36/2=18$，然后再强化为 $18^2=\\color{red}{324}$。\n\n乔伊想知道，如果最初的攻击力为 $x$，至少需要多少次强化，可以使其**不小于** $2^n$？  \n如果无论强化多少次，都不可能达到要求，请输出 `inf`。", "inputFormat": "输入一行两个正整数 $x,n$。分别表示初始攻击力为 $x$，以及要达到 $2^n$ 的攻击力。", "outputFormat": "输出一行一个整数或字符串 `inf`，表示答案。", "hint": "【样例 $1$ 解释】  \n初始攻击力 $x=2$ 就已经达到了 $2^n=2$，不需要使用技能就满足了要求，故答案为 $0$。\n\n【样例 $2$ 解释】  \n初始攻击力为 $3$，需要达到 $2^6=64$。第一次用技能后变为 $9$，第二次后变为 $(9/2)^2=81/4$，第三次变为 $((81/4)/2)^2=6561/64$，已经达到了要求，故答案为 $3$。\n\n【数据范围】  \n**本题采用捆绑测试。**  \n\nSubtask 1（15 pts）：$n\\le 60$；  \nSubtask 2（20 pts）：$x=4$；  \nSubtask 3（25 pts）：$n\\le 10^5$；  \nSubtask 4（40 pts）：无特殊限制。\n\n对于全部的数据，$2\\le x\\le 10^9$，$1\\le n \\le 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "勇气（Courage）", "background": "数学家渴求真理的美德，永不停歇的力量的源泉 —— 勇气。\n****\n「勇气之光」乔伊，是杜沃夫族的接任族长，也是拥有古代战神之力的战士。", "description": "乔伊有一项技能，可以将 $x$ 的攻击力强化为 $x^2$。但这个技能并不完美，除了第一次之外，每一次**使用该技能前**，攻击力都会衰减到之前的一半。\n\n比如最初的攻击力为 $\\color{red}6$，强化后变成 $6^2=\\color{red}{36}$。而在下一次强化前，会先衰减到 $36/2=18$，然后再强化为 $18^2=\\color{red}{324}$。\n\n乔伊想知道，如果最初的攻击力为 $x$，至少需要多少次强化，可以使其**不小于** $2^n$？  \n如果无论强化多少次，都不可能达到要求，请输出 `inf`。", "inputFormat": "输入一行两个正整数 $x,n$。分别表示初始攻击力为 $x$，以及要达到 $2^n$ 的攻击力。", "outputFormat": "输出一行一个整数或字符串 `inf`，表示答案。", "hint": "【样例 $1$ 解释】  \n初始攻击力 $x=2$ 就已经达到了 $2^n=2$，不需要使用技能就满足了要求，故答案为 $0$。\n\n【样例 $2$ 解释】  \n初始攻击力为 $3$，需要达到 $2^6=64$。第一次用技能后变为 $9$，第二次后变为 $(9/2)^2=81/4$，第三次变为 $((81/4)/2)^2=6561/64$，已经达到了要求，故答案为 $3$。\n\n【数据范围】  \n**本题采用捆绑测试。**  \n\nSubtask 1（15 pts）：$n\\le 60$；  \nSubtask 2（20 pts）：$x=4$；  \nSubtask 3（25 pts）：$n\\le 10^5$；  \nSubtask 4（40 pts）：无特殊限制。\n\n对于全部的数据，$2\\le x\\le 10^9$，$1\\le n \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P10321", "type": "P", "difficulty": 5, "samples": [["6", "21.0000000"], ["20", "422.0000000"], ["233", "99838.0384544"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "数论", "洛谷原创", "Special Judge", "O2优化", "素数判断,质数,筛法", "最大公约数 gcd", "洛谷比赛"], "title": "奉献（Dedication）", "background": "不断鞭策自己的数学精神 —— 奉献。\n****\n「奉献之光」丽莎，既是「秩序之神」派拉的神官，亦为「无秩序之神」迪奥尼斯的信徒。\n\n丽莎最近学习了[高精度除法](https://www.luogu.com.cn/problem/P5432)，她能以 $\\Theta(n \\log n)$ 的时间复杂度计算 $n$ 位整数除法了。", "description": "\n\n丽莎想要制作一张 $n$ 以内正整数的除法表。具体来说，是一张记录了 $\\lfloor a/b \\rfloor$（$1\\leq b \\leq a \\leq n$，$a,b$ 均为整数）的表格。她使用如下方法来制作：\n\n>以 $a$ 为第一关键字从小到大，以 $b$ 为第二关键字从小到大的顺序枚举位置 $(a,b)$。若 $(a,b)$ 位置**未被填写**，则：\n>\n>计算 $\\lfloor a/b \\rfloor$，这需要消耗的**魔力**为 $d_a \\log_2 d_a$（其中 $d_a$ 表示 $a$ 在十进制下的位数，即 $d_a=\\lfloor 1+ \\log_{10}a\\rfloor$）。然后枚举正整数 $i$，找到所有**未被填写**的 $(ai,bi)$（$ai\\leq n$）位置都填写入 $\\lfloor a/b \\rfloor$。每次填写需要消耗的魔力为 $d_i$。\n\n由于美娜已经做过一张乘法表，丽莎无需魔力就可以直接计算乘法。现在丽莎想要知道，制作整个除法表需要消耗多少魔力。\n\n\n为了防止精度问题，只要你的输出与标准输出的**相对误差**不超过 $10^{-6}$ 则视为正确。保证标准输出与实际答案的相对误差不超过 $10^{-10}$。", "inputFormat": "输入一行一个正整数 $n$，表示要制作大小为 $n$ 的除法表。", "outputFormat": "输出一行一个实数，表示答案。", "hint": "【样例 $1$ 解释】  \n\n由于 $a \\leq 6$，$d_a=1$，从而 $d_a \\log_2 d_a=0$。也就是说在此范围下只有填写数字会消耗魔力。而每次 $i$ 也不超过 $6$，满足 $d_i=1$，每次填写都消耗固定 $1$ 点魔力，要填写全部 $1+2+3+4+5+6=21$ 个数消耗的魔力就是 $21$。\n\n故答案为 $21$。\n\n【数据范围】  \n\n**本题采用捆绑测试。**  \n\nSubtask 1（15 pts）：$n\\le 5000$；  \nSubtask 2（15 pts）：$n\\le 10^5$；  \nSubtask 3（30 pts）：$n\\le 2 \\times 10^6$；  \nSubtask 4（40 pts）：无特殊限制。\n\n对于全部的数据，$1\\le n \\le 2 \\times 10^7$。  \n\n【提示】\n\n$\\log_2 n$ 读作「以 $2$ 为底的 $n$ 的对数」。设 $x=\\log_2n$，它表示 $2^x=n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "奉献（Dedication）", "background": "不断鞭策自己的数学精神 —— 奉献。\n****\n「奉献之光」丽莎，既是「秩序之神」派拉的神官，亦为「无秩序之神」迪奥尼斯的信徒。\n\n丽莎最近学习了[高精度除法](https://www.luogu.com.cn/problem/P5432)，她能以 $\\Theta(n \\log n)$ 的时间复杂度计算 $n$ 位整数除法了。", "description": "\n\n丽莎想要制作一张 $n$ 以内正整数的除法表。具体来说，是一张记录了 $\\lfloor a/b \\rfloor$（$1\\leq b \\leq a \\leq n$，$a,b$ 均为整数）的表格。她使用如下方法来制作：\n\n>以 $a$ 为第一关键字从小到大，以 $b$ 为第二关键字从小到大的顺序枚举位置 $(a,b)$。若 $(a,b)$ 位置**未被填写**，则：\n>\n>计算 $\\lfloor a/b \\rfloor$，这需要消耗的**魔力**为 $d_a \\log_2 d_a$（其中 $d_a$ 表示 $a$ 在十进制下的位数，即 $d_a=\\lfloor 1+ \\log_{10}a\\rfloor$）。然后枚举正整数 $i$，找到所有**未被填写**的 $(ai,bi)$（$ai\\leq n$）位置都填写入 $\\lfloor a/b \\rfloor$。每次填写需要消耗的魔力为 $d_i$。\n\n由于美娜已经做过一张乘法表，丽莎无需魔力就可以直接计算乘法。现在丽莎想要知道，制作整个除法表需要消耗多少魔力。\n\n\n为了防止精度问题，只要你的输出与标准输出的**相对误差**不超过 $10^{-6}$ 则视为正确。保证标准输出与实际答案的相对误差不超过 $10^{-10}$。", "inputFormat": "输入一行一个正整数 $n$，表示要制作大小为 $n$ 的除法表。", "outputFormat": "输出一行一个实数，表示答案。", "hint": "【样例 $1$ 解释】  \n\n由于 $a \\leq 6$，$d_a=1$，从而 $d_a \\log_2 d_a=0$。也就是说在此范围下只有填写数字会消耗魔力。而每次 $i$ 也不超过 $6$，满足 $d_i=1$，每次填写都消耗固定 $1$ 点魔力，要填写全部 $1+2+3+4+5+6=21$ 个数消耗的魔力就是 $21$。\n\n故答案为 $21$。\n\n【数据范围】  \n\n**本题采用捆绑测试。**  \n\nSubtask 1（15 pts）：$n\\le 5000$；  \nSubtask 2（15 pts）：$n\\le 10^5$；  \nSubtask 3（30 pts）：$n\\le 2 \\times 10^6$；  \nSubtask 4（40 pts）：无特殊限制。\n\n对于全部的数据，$1\\le n \\le 2 \\times 10^7$。  \n\n【提示】\n\n$\\log_2 n$ 读作「以 $2$ 为底的 $n$ 的对数」。设 $x=\\log_2n$，它表示 $2^x=n$。", "locale": "zh-CN"}}}
{"pid": "P10322", "type": "P", "difficulty": 6, "samples": [["5\n15 12\n400 2520\n5000000 68256\n10000000 65536\n10000000000 3628800", "462\n946645637\n231125775\n290821843\n602104955"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "数论", "洛谷原创", "O2优化", "莫比乌斯反演", "拉格朗日插值法", "洛谷比赛"], "title": "高洁（Purity）", "background": "简洁、准确而永恒的美丽 —— 高洁。\n****\n「高洁之光」拉姆，身为精灵王的他可以完美使用《阿梅斯草纸书》的力量。", "description": "拉姆使用「暴风箭雨」一次射出了 $n$ 支箭，其中第 $i$ 支箭的原始攻击力是 $i$。不过，这些箭会经过一些强化。\n\n对于常数 $d$，设原始攻击力为 $i$ 的箭，其**能级**为 $v(i)$：\n\n- 若不存在正整数 $k$ 使得 $i^k$ 是 $d$ 的整数倍，则 $v(i)=0$；  \n- 否则 $v(i)$ 为**最小的**、使得 $i^k$ 是 $d$ 的整数倍的正整数 $k$。\n\n那么这支箭强化后的攻击力为 $i^{v(i)+1}$。\n\n拉姆想知道所有箭在**强化后**的攻击力之和，由于答案可能很大，你只需要求出答案对 $998244353$ 取模的结果。（即求出答案除以 $998244353$ 的余数）", "inputFormat": "第一行一个正整数 $T$，表示数据组数。  \n接下来 $T$ 行，每行两个正整数 $n,d$，意义如题目描述。", "outputFormat": "输出 $T$ 行，每行对应一组数据的答案。", "hint": "【样例解释】   \n对于第一组数据，$d=12$。其中 $v(6)=2$，因为 $12$ 能整除 $6^2$，而不整除 $6^1$，同样也能得到 $v(12)=1$。\n可以发现 $n=15$ 以内的其它数能级都为 $0$，故答案为：\n\n$$\\left(\\sum_{i=1}^{15}i\\right)-6-12+6^3+12^2=462$$\n\n对于第二组数据，可以证明 $n$ 以内只有 $v(210)=3$ 非零，由此可以算出答案为 $1944889990$，对 $998244353$ 取模后为 $946645637$。\n\n【数据范围】  \n**本题采用捆绑测试。**\n\nSubtask 1（15 pts）：$1 \\le n,d \\le 10^4$；  \nSubtask 2（15 pts）：$d$ 为质数；  \nSubtask 3（20 pts）：$d$ 为质数的正整数幂；  \nSubtask 4（20 pts）：不存在大于 $1$ 的整数 $x$，使得 $x^4$ 整除 $d$；  \nSubtask 5（30 pts）：无特殊限制。\n\n对于全部数据，$1\\le T \\le 1000$，$1\\le n < 2^{63}$，$1\\le d \\le 10^8$。\n\n【提示】  \n此题的时间限制较为宽松，即使你的代码在某些细节上没有优化，也可以正常通过此题。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "高洁（Purity）", "background": "简洁、准确而永恒的美丽 —— 高洁。\n****\n「高洁之光」拉姆，身为精灵王的他可以完美使用《阿梅斯草纸书》的力量。", "description": "拉姆使用「暴风箭雨」一次射出了 $n$ 支箭，其中第 $i$ 支箭的原始攻击力是 $i$。不过，这些箭会经过一些强化。\n\n对于常数 $d$，设原始攻击力为 $i$ 的箭，其**能级**为 $v(i)$：\n\n- 若不存在正整数 $k$ 使得 $i^k$ 是 $d$ 的整数倍，则 $v(i)=0$；  \n- 否则 $v(i)$ 为**最小的**、使得 $i^k$ 是 $d$ 的整数倍的正整数 $k$。\n\n那么这支箭强化后的攻击力为 $i^{v(i)+1}$。\n\n拉姆想知道所有箭在**强化后**的攻击力之和，由于答案可能很大，你只需要求出答案对 $998244353$ 取模的结果。（即求出答案除以 $998244353$ 的余数）", "inputFormat": "第一行一个正整数 $T$，表示数据组数。  \n接下来 $T$ 行，每行两个正整数 $n,d$，意义如题目描述。", "outputFormat": "输出 $T$ 行，每行对应一组数据的答案。", "hint": "【样例解释】   \n对于第一组数据，$d=12$。其中 $v(6)=2$，因为 $12$ 能整除 $6^2$，而不整除 $6^1$，同样也能得到 $v(12)=1$。\n可以发现 $n=15$ 以内的其它数能级都为 $0$，故答案为：\n\n$$\\left(\\sum_{i=1}^{15}i\\right)-6-12+6^3+12^2=462$$\n\n对于第二组数据，可以证明 $n$ 以内只有 $v(210)=3$ 非零，由此可以算出答案为 $1944889990$，对 $998244353$ 取模后为 $946645637$。\n\n【数据范围】  \n**本题采用捆绑测试。**\n\nSubtask 1（15 pts）：$1 \\le n,d \\le 10^4$；  \nSubtask 2（15 pts）：$d$ 为质数；  \nSubtask 3（20 pts）：$d$ 为质数的正整数幂；  \nSubtask 4（20 pts）：不存在大于 $1$ 的整数 $x$，使得 $x^4$ 整除 $d$；  \nSubtask 5（30 pts）：无特殊限制。\n\n对于全部数据，$1\\le T \\le 1000$，$1\\le n < 2^{63}$，$1\\le d \\le 10^8$。\n\n【提示】  \n此题的时间限制较为宽松，即使你的代码在某些细节上没有优化，也可以正常通过此题。", "locale": "zh-CN"}}}
{"pid": "P10323", "type": "P", "difficulty": 6, "samples": [["3\n1 4 4\n3 7 7\n5 10 10", "0"], ["5\n1 4 4\n2 5 5\n3 7 7\n4 8 8\n9 8 8", "488831003"], ["5\n1 1 4\n2 2 5\n3 3 7\n4 2 8\n9 3 8", "884183796"], ["10\n123 1 10\n234 11 14\n345 10 20\n456 6 6\n567 20 30\n678 84 90\n789 1 3\n8910 8 15\n91011 123 129\n101112 56 64", "483360041"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "洛谷原创", "O2优化", "期望", "线性代数", "微积分", "洛谷比赛"], "title": "理性（Rationality）", "background": "数学之善，统治宇宙的根本原理 —— 理性。\n****\n「理性之光」伊奥，是古代精灵图形术士。已经千岁的她总能不受感情的干扰，以理性做出最优的决策。   ", "description": "赛时更新：请注意，对于一组确定的 $v_1,\\cdots,v_n$，都可以求出 $\\text{RSS}$ 的最小值。**它是关于随机变量  $v_1,\\cdots,v_n$ 的一个随机变量**，将其记为 $X$，则要求的是 $\\mathbb E[X]$。   \n笔误改正：残差平方和的英文为 $\\text{RSS}$。\n****\n伊奥的思绪回到了千年前的一场大战中。\n\n她记得那场战斗中有 $n$ 个敌人，第 $i$ 个敌人在距离她 $d_i$（$d_i$ 之间互不相同）的位置上。这些敌人都带有一个**正整数**标记 $v_i$，只要以**恰好** $v_i$ 的攻击力击中它就可以将其消灭。\n\n她只要设定一个一次函数 $f(x)=ax+b$，就能在距离她 $d_i$ 的位置放出 $f(d_i)$ 的攻击力。好在她的队友会辅助她攻击，她只用考虑确定 $a,b$ 使得 $f(x)$ 的效果最优，即最小化 $\\text{RSS}$（残差平方和）：\n$$\\text{RSS}=\\sum_{i=1}^n(f(d_i)-v_i)^2$$\n当然了，这只是她的回忆。她能清晰记得每个敌人到她的距离 $d_i$，而对于 $v_i$ 她只记得满足 $l_i\\leq v_i \\leq r_i$。\n\n她想知道假设每个 $v_i$ 都对应在 $[l_i,r_i]$ 范围内**均匀随机**的情况下，「$\\text{RSS}$ **的最小值」的期望**。   \n可以证明答案总是有理数，你只需要告诉她答案对 $998244353$ 取模的结果即可。", "inputFormat": "第一行一个正整数 $n$，表示敌人的个数。  \n接下来 $n$ 行，每行三个正整数 $d_i,l_i,r_i$，分别表示第 $i$ 个敌人到伊奥的距离，其标记 $v_i$ 的下界和上界。\n\n为了方便你的计算，伊奥保证 $d_i< d_{i+1}$（$1\\leq i <n$），并且：\n\n$$n\\sum_{i=1}^nd_i^2 \\not \\equiv \\left(\\sum_{i=1}^nd_i \\right)^2 \\pmod{998244353}$$\n**即确保答案在模 $998244353$ 意义下一定存在。**", "outputFormat": "输出一行一个整数，表示所有情况下 $\\text{RSS}$ 最小值的期望。", "hint": "【样例 $1$ 解释】\n\n此样例中有 $l_i=r_i$，即情况已经确定，只需要求出此时最优的 $a,b$ 即可。容易发现 $(1,4),(3,7),(5,10)$ 这三组数据可以用一次函数完美拟合：即 $f(x)=\\dfrac 32 x+\\dfrac{5}{2}$，与每个点偏差都是 $0$，故 $\\text{RSS}$ 最小值的期望，也就是答案为 $0$。\n\n【样例 $2$ 解释】\n\n这里同样有 $l_i=r_i$。$5$ 个敌人的数据 $(d_i,v_i)$ 分别为 $(1,4),(2,5),(3,7),(4,8),(9,8)$，可以证明取\n$$a=\\frac{87}{194} \\ , \\ b=\\frac{911}{194}$$\n是一组使得 $\\text{RSS}$ 最小的解，代入计算得\n$$\\text{RSS}=\\sum_{i=1}^n\\left( \\frac{87}{194}d_i+\\frac{911}{194}-v_i\\right)^2=\\frac{1047}{194}$$\n在模 $998244353$ 意义下答案为 $488831003$。\n\n【数据范围】\n\n**本题采用捆绑测试。**\n\nSubtask 1（10 pts）：$n \\leq 3$；  \nSubtask 2（10 pts）：$l_i=r_i$；  \nSubtask 3（15 pts）：$n\\le500$，$r_i\\leq 500$；  \nSubtask 4（15 pts）：$n\\le 5000$；  \nSubtask 5（20 pts）：$n\\le 10^5$；  \nSubtask 6（30 pts）：无特殊限制。\n\n对于全部的数据，$2\\le n \\le 5\\times 10^5$，$1\\leq l_i \\leq r_i \\leq 10^8$，$1\\leq d_i \\leq 10^8$， $d_i<d_{i+1}$（$1\\leq i <n$），并且有：\n$$n\\sum_{i=1}^nd_i^2 \\not \\equiv \\left(\\sum_{i=1}^nd_i \\right)^2 \\pmod{998244353}$$\n\n【提示】\n\n题目中要求出「$\\text{RSS}$ 的最小值」期望值。对于离散随机变量 $X$，假设其可以取值为 $a_1,a_2,\\cdots,a_n$，对应概率为 $p_1,p_2,\\cdots,p_n$（$p_1+\\cdots+p_n=1$），则其期望值可以定义为：\n$$\\mathbb E[X]=\\sum_{i=1}^np_i a_i$$\n对于计算有理数取模的方法，请参考[模板题](https://www.luogu.com.cn/problem/P2613)。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "理性（Rationality）", "background": "数学之善，统治宇宙的根本原理 —— 理性。\n****\n「理性之光」伊奥，是古代精灵图形术士。已经千岁的她总能不受感情的干扰，以理性做出最优的决策。   ", "description": "赛时更新：请注意，对于一组确定的 $v_1,\\cdots,v_n$，都可以求出 $\\text{RSS}$ 的最小值。**它是关于随机变量  $v_1,\\cdots,v_n$ 的一个随机变量**，将其记为 $X$，则要求的是 $\\mathbb E[X]$。   \n笔误改正：残差平方和的英文为 $\\text{RSS}$。\n****\n伊奥的思绪回到了千年前的一场大战中。\n\n她记得那场战斗中有 $n$ 个敌人，第 $i$ 个敌人在距离她 $d_i$（$d_i$ 之间互不相同）的位置上。这些敌人都带有一个**正整数**标记 $v_i$，只要以**恰好** $v_i$ 的攻击力击中它就可以将其消灭。\n\n她只要设定一个一次函数 $f(x)=ax+b$，就能在距离她 $d_i$ 的位置放出 $f(d_i)$ 的攻击力。好在她的队友会辅助她攻击，她只用考虑确定 $a,b$ 使得 $f(x)$ 的效果最优，即最小化 $\\text{RSS}$（残差平方和）：\n$$\\text{RSS}=\\sum_{i=1}^n(f(d_i)-v_i)^2$$\n当然了，这只是她的回忆。她能清晰记得每个敌人到她的距离 $d_i$，而对于 $v_i$ 她只记得满足 $l_i\\leq v_i \\leq r_i$。\n\n她想知道假设每个 $v_i$ 都对应在 $[l_i,r_i]$ 范围内**均匀随机**的情况下，「$\\text{RSS}$ **的最小值」的期望**。   \n可以证明答案总是有理数，你只需要告诉她答案对 $998244353$ 取模的结果即可。", "inputFormat": "第一行一个正整数 $n$，表示敌人的个数。  \n接下来 $n$ 行，每行三个正整数 $d_i,l_i,r_i$，分别表示第 $i$ 个敌人到伊奥的距离，其标记 $v_i$ 的下界和上界。\n\n为了方便你的计算，伊奥保证 $d_i< d_{i+1}$（$1\\leq i <n$），并且：\n\n$$n\\sum_{i=1}^nd_i^2 \\not \\equiv \\left(\\sum_{i=1}^nd_i \\right)^2 \\pmod{998244353}$$\n**即确保答案在模 $998244353$ 意义下一定存在。**", "outputFormat": "输出一行一个整数，表示所有情况下 $\\text{RSS}$ 最小值的期望。", "hint": "【样例 $1$ 解释】\n\n此样例中有 $l_i=r_i$，即情况已经确定，只需要求出此时最优的 $a,b$ 即可。容易发现 $(1,4),(3,7),(5,10)$ 这三组数据可以用一次函数完美拟合：即 $f(x)=\\dfrac 32 x+\\dfrac{5}{2}$，与每个点偏差都是 $0$，故 $\\text{RSS}$ 最小值的期望，也就是答案为 $0$。\n\n【样例 $2$ 解释】\n\n这里同样有 $l_i=r_i$。$5$ 个敌人的数据 $(d_i,v_i)$ 分别为 $(1,4),(2,5),(3,7),(4,8),(9,8)$，可以证明取\n$$a=\\frac{87}{194} \\ , \\ b=\\frac{911}{194}$$\n是一组使得 $\\text{RSS}$ 最小的解，代入计算得\n$$\\text{RSS}=\\sum_{i=1}^n\\left( \\frac{87}{194}d_i+\\frac{911}{194}-v_i\\right)^2=\\frac{1047}{194}$$\n在模 $998244353$ 意义下答案为 $488831003$。\n\n【数据范围】\n\n**本题采用捆绑测试。**\n\nSubtask 1（10 pts）：$n \\leq 3$；  \nSubtask 2（10 pts）：$l_i=r_i$；  \nSubtask 3（15 pts）：$n\\le500$，$r_i\\leq 500$；  \nSubtask 4（15 pts）：$n\\le 5000$；  \nSubtask 5（20 pts）：$n\\le 10^5$；  \nSubtask 6（30 pts）：无特殊限制。\n\n对于全部的数据，$2\\le n \\le 5\\times 10^5$，$1\\leq l_i \\leq r_i \\leq 10^8$，$1\\leq d_i \\leq 10^8$， $d_i<d_{i+1}$（$1\\leq i <n$），并且有：\n$$n\\sum_{i=1}^nd_i^2 \\not \\equiv \\left(\\sum_{i=1}^nd_i \\right)^2 \\pmod{998244353}$$\n\n【提示】\n\n题目中要求出「$\\text{RSS}$ 的最小值」期望值。对于离散随机变量 $X$，假设其可以取值为 $a_1,a_2,\\cdots,a_n$，对应概率为 $p_1,p_2,\\cdots,p_n$（$p_1+\\cdots+p_n=1$），则其期望值可以定义为：\n$$\\mathbb E[X]=\\sum_{i=1}^np_i a_i$$\n对于计算有理数取模的方法，请参考[模板题](https://www.luogu.com.cn/problem/P2613)。", "locale": "zh-CN"}}}
{"pid": "P10324", "type": "P", "difficulty": 7, "samples": [["1 1", "5"], ["2 0", "45"], ["2 1", "149"], ["10 0", "36011666"], ["20 1", "593465999"], ["106 1", "516553582"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "洛谷原创", "O2优化", "组合数学", "生成函数", "拉格朗日反演", "洛谷比赛"], "title": "洞察（Insight）", "background": "看待万物毫无偏见的新视角 —— 洞察。\n\n****\n「洞察之光」凯伊·雅思·德·布拉德，是减法盗贼，也是背负黑暗命运的混沌骑士。\n\n凯伊的右手内隐藏着混沌之剑，为了使其发挥出足够的力量又不至于失控，需要满足特定的内部结构。她想知道有多少种符合条件的结构，为了方便你的计算，她把问题转化为如下形式：", "description": "赛时更新：题面中的笔误已修改为：相邻点对颜色**互不相同**。\n****\n在一个**无向连通图** $G$ 中，有黑色和白色的点各 $n$ 个，红色的点 $1$ 个。  \n所有点都有标号，图中有 $2n$ 条边，且所有相邻点对（也就是有边直接相连的点对）的颜色也互不相同。\n\n对于 $\\text{type}$ 等于 $0$ 或 $1$，分别在不同条件下计算符合条件的图 $G$ 有多少个：\n\n- $\\text{type}=0$：无附加条件。  \n- $\\text{type}=1$：对于每个**不包含**红色点的极大连通子图，都要对**恰好一个**点做特殊标记（每个标记也都是不同的）。\n\n答案对 $998244353$ 取模。", "inputFormat": "输入一行两个整数 $n$ 和 $\\text{type}$。\n", "outputFormat": "输出一行一个整数表示答案。", "hint": "【样例 $1$ 解释】  \n此时 $\\text{type}=1$，所有 $5$ 种合法的图包括：\n\n1. $R-W'-B$\n2. $R-W-B'$\n3. $R-B'-W$\n4. $R-B-W'$\n5. $B'-R-W'$\n\n由于 $n=1$，可以仅用 $B$ 和 $W$ 来区分白点和黑点，$R$ 表示红点。中间的横杠表示连边，$B'$ 和 $W'$ 分别表示有标记的白点和黑点。\n\n注意，由于第 $5$ 个图中，单个的 $B$ 和 $W$ 就是不包含 $R$ 的极大连通子图，必须各有一个标记在这唯一的位置上。\n\n【样例 $2,3$ 解释】\n\n见附件图片，其中展示了 $\\text{type}=0$ 时全部的 $45$ 种可能的图 $G$。\n\n对于 $\\text{type}=1$ 的情况，只需要对每个图的基础上做标记，就可以数出答案为 $149$。\n\n【样例 $4,5$ 解释】\n\n取模前的答案分别为 $116758263583336861101$ 和 $4159784334433940020473603987503242886367209494283213841$。\n\n【数据范围】\n\n**本题采用捆绑测试。**\n\nSubtask 1（8 pts）：$n \\le4$；     \nSubtask 2（10 pts）：$n \\le 10^3$，$\\text{type}=0$；  \nSubtask 3（11 pts）：$\\text{type}=0$；  \nSubtask 4（13 pts）：$n \\le 100$，$\\text{type}=1$；     \nSubtask 5（14 pts）：$n \\le 10^3$，$\\text{type}=1$；  \nSubtask 6（21 pts）：$n\\le 10^5$，$\\text{type}=1$；  \nSubtask 7（23 pts）：$\\text{type}=1$。\n\n对于全部的数据，$1\\le n \\le 10^7$，$\\text{type}\\in \\{ 0,1\\}$。\n\n【提示】  \n对于这类题目，你或许会想从 [OEIS](https://oeis.org/) 上寻找答案。但我要提醒你的是，直接搜索答案数列不会找到任何结果。然而，对于小数据范围，仍然可以提前处理出答案数列。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "洞察（Insight）", "background": "看待万物毫无偏见的新视角 —— 洞察。\n\n****\n「洞察之光」凯伊·雅思·德·布拉德，是减法盗贼，也是背负黑暗命运的混沌骑士。\n\n凯伊的右手内隐藏着混沌之剑，为了使其发挥出足够的力量又不至于失控，需要满足特定的内部结构。她想知道有多少种符合条件的结构，为了方便你的计算，她把问题转化为如下形式：", "description": "赛时更新：题面中的笔误已修改为：相邻点对颜色**互不相同**。\n****\n在一个**无向连通图** $G$ 中，有黑色和白色的点各 $n$ 个，红色的点 $1$ 个。  \n所有点都有标号，图中有 $2n$ 条边，且所有相邻点对（也就是有边直接相连的点对）的颜色也互不相同。\n\n对于 $\\text{type}$ 等于 $0$ 或 $1$，分别在不同条件下计算符合条件的图 $G$ 有多少个：\n\n- $\\text{type}=0$：无附加条件。  \n- $\\text{type}=1$：对于每个**不包含**红色点的极大连通子图，都要对**恰好一个**点做特殊标记（每个标记也都是不同的）。\n\n答案对 $998244353$ 取模。", "inputFormat": "输入一行两个整数 $n$ 和 $\\text{type}$。\n", "outputFormat": "输出一行一个整数表示答案。", "hint": "【样例 $1$ 解释】  \n此时 $\\text{type}=1$，所有 $5$ 种合法的图包括：\n\n1. $R-W'-B$\n2. $R-W-B'$\n3. $R-B'-W$\n4. $R-B-W'$\n5. $B'-R-W'$\n\n由于 $n=1$，可以仅用 $B$ 和 $W$ 来区分白点和黑点，$R$ 表示红点。中间的横杠表示连边，$B'$ 和 $W'$ 分别表示有标记的白点和黑点。\n\n注意，由于第 $5$ 个图中，单个的 $B$ 和 $W$ 就是不包含 $R$ 的极大连通子图，必须各有一个标记在这唯一的位置上。\n\n【样例 $2,3$ 解释】\n\n见附件图片，其中展示了 $\\text{type}=0$ 时全部的 $45$ 种可能的图 $G$。\n\n对于 $\\text{type}=1$ 的情况，只需要对每个图的基础上做标记，就可以数出答案为 $149$。\n\n【样例 $4,5$ 解释】\n\n取模前的答案分别为 $116758263583336861101$ 和 $4159784334433940020473603987503242886367209494283213841$。\n\n【数据范围】\n\n**本题采用捆绑测试。**\n\nSubtask 1（8 pts）：$n \\le4$；     \nSubtask 2（10 pts）：$n \\le 10^3$，$\\text{type}=0$；  \nSubtask 3（11 pts）：$\\text{type}=0$；  \nSubtask 4（13 pts）：$n \\le 100$，$\\text{type}=1$；     \nSubtask 5（14 pts）：$n \\le 10^3$，$\\text{type}=1$；  \nSubtask 6（21 pts）：$n\\le 10^5$，$\\text{type}=1$；  \nSubtask 7（23 pts）：$\\text{type}=1$。\n\n对于全部的数据，$1\\le n \\le 10^7$，$\\text{type}\\in \\{ 0,1\\}$。\n\n【提示】  \n对于这类题目，你或许会想从 [OEIS](https://oeis.org/) 上寻找答案。但我要提醒你的是，直接搜索答案数列不会找到任何结果。然而，对于小数据范围，仍然可以提前处理出答案数列。\n", "locale": "zh-CN"}}}
{"pid": "P10325", "type": "P", "difficulty": 7, "samples": [["2 3\n1 2\n2 3\n2 3", "103983787"], ["4 5\n1 3\n1 2\n1 4\n1 5\n1 6", "525030616"], ["7 17\n1 5\n1 5\n1 5\n1 5\n1 3\n1 3\n1 3\n1 2\n1 2\n1 6\n1 6\n1 6\n1 6\n1 6\n1 6\n1 6\n1 6", "308796722"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "多项式", "洛谷原创", "O2优化", "分治", "概率论", "期望", "快速傅里叶变换 FFT", "洛谷比赛"], "title": "超越（Transcendent）", "background": "越过领域和现实的终极存在 —— 超越。\n\n****\n「超越之光」美娜，是亚特兰蒂斯最强的魔法师，亦是无人能及的贤者。即便如此，她也一刻都没有停下对数学的探索。\n\n「最高次系数为 $1$ 的整系数多项式方程的解不一定是整数，」美娜自言自语道，「但是其所有根组成的对称多项式的值必然是整数。」\n\n「这很容易证明，却也很有趣呢。」想到这里，美娜突然有了开发新魔法的思路。", "description": "美娜的魔法需要 $m+1$ 个阶段来构建。第 $i \\ (1 \\leq i \\leq m)$ 个阶段每次尝试的成功概率为 $a_i/b_i$，如果失败**只需要重试当前阶段**即可，如果成功就能进入下一个阶段。\n\n最后的第 $m+1$ 个阶段需要选一个魔力基数 $c$。不过这个魔法现在并不稳定，设 $r$ 是一个不大于 $2n$ 的范围内**均匀随机**生成的正整数，则\n$$c=\\cos \\frac{r\\pi}{n}$$\n最后，若美娜在前 $m$ 个阶段中总共尝试了 $k$ 次（每次无论失败或成功，都算多一次尝试），她的魔法会产生 $c^k$ 的能量。\n\n美娜想知道这个魔法所产生能量的期望值是多少，当然她很容易就算出了答案，你能帮她验算一下吗？\n\n你只用输出答案对 $998244353$ 取模的结果即可。显然，答案一定是有理数，所以你可以简单地计算其对 $998244353$ 取模的值。", "inputFormat": "第一行两个正整数 $n,m$。  \n接下来 $m$ 行，每行两个正整数 $a_i,b_i$，意义如题目描述。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "【样例 $1$ 解释】\n\n此时 $m=3$，前 $m$ 个阶段中，第一阶段的成功概率为 $1/2$，之后两个阶段的成功概率都为 $2/3$。由此可以算出，恰好尝试 $k \\ (k \\geq m)$ 次完成前 $m$ 个阶段的概率为（我有一个巧妙的方法给出证明，可惜这里空间太小，写不下）：\n\n$$p_k=2^{4-k}-4(k+1)3^{1-k}$$\n例如 $p_3=2/9$，这是每个阶段都一次成功的概率 $1/2 \\times 2/3 \\times 2/3$。  \n又如 $p_4=7/27$，这要求在某一阶段尝试恰好两次，其它阶段都一次成功，即：\n$$p_4=\\left( \\frac 12\\right)^2   \\frac 23 \\cdot \\frac 23+\\frac 12\\left( \\frac 29\\right)\\frac 23+\\frac 12\\cdot \\frac 23\\left( \\frac 29\\right)$$\n样例中 $n=2$，可知 $c=1$ 的概率为 $1/4$，$c=-1$ 的概率为 $1/4$，还有 $1/2$ 的概率 $c=0$。故答案为\n\n$$\\frac 14\\sum_{k\\geq 3}p_k (1+(-1)^k)=\\frac{11}{48}$$\n对 $998244353$ 取模后为 $103983787$。\n\n【样例 $2$ 解释】\n\n取模前的答案为 $\\dfrac{24284321}{191028915}$。\n\n【数据范围】 \n\n**本题使用捆绑测试。**\n\n\nSubtask 1（7 pts）：$n\\le 6$，$m=1$；   \nSubtask 2（9 pts）：$n\\le 6$，$m\\le 10$；  \nSubtask 3（13 pts）：$n\\le 500$，$m\\le 500$；   \nSubtask 4（13 pts）：$n=2^{19}$；  \nSubtask 5（15 pts）：$n \\le 10^5$，$m\\le 500$；  \nSubtask 6（15 pts）：不同的 $a_i/b_i$ 最多有两组；   \nSubtask 7（28 pts）：无特殊限制。\n\n\n对于全部数据，$1\\le n \\le 10^8$，$1\\le m \\le 60000$，$1\\le a_i<b_i\\leq 10^8$。且保证\n\n$$U_n\\left( \\frac{b_i}{b_i-a_i}\\right)\\not \\equiv 0 \\pmod{998244353}$$\n其中 $U_n(x)$ 表示 $n$ 次的[第二类 Chebyshev 多项式](https://mathworld.wolfram.com/ChebyshevPolynomialoftheSecondKind.html)。\n\n【提示】   \n你在找什么呢？或许可以再看看题目背景，会有帮助的。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "超越（Transcendent）", "background": "越过领域和现实的终极存在 —— 超越。\n\n****\n「超越之光」美娜，是亚特兰蒂斯最强的魔法师，亦是无人能及的贤者。即便如此，她也一刻都没有停下对数学的探索。\n\n「最高次系数为 $1$ 的整系数多项式方程的解不一定是整数，」美娜自言自语道，「但是其所有根组成的对称多项式的值必然是整数。」\n\n「这很容易证明，却也很有趣呢。」想到这里，美娜突然有了开发新魔法的思路。", "description": "美娜的魔法需要 $m+1$ 个阶段来构建。第 $i \\ (1 \\leq i \\leq m)$ 个阶段每次尝试的成功概率为 $a_i/b_i$，如果失败**只需要重试当前阶段**即可，如果成功就能进入下一个阶段。\n\n最后的第 $m+1$ 个阶段需要选一个魔力基数 $c$。不过这个魔法现在并不稳定，设 $r$ 是一个不大于 $2n$ 的范围内**均匀随机**生成的正整数，则\n$$c=\\cos \\frac{r\\pi}{n}$$\n最后，若美娜在前 $m$ 个阶段中总共尝试了 $k$ 次（每次无论失败或成功，都算多一次尝试），她的魔法会产生 $c^k$ 的能量。\n\n美娜想知道这个魔法所产生能量的期望值是多少，当然她很容易就算出了答案，你能帮她验算一下吗？\n\n你只用输出答案对 $998244353$ 取模的结果即可。显然，答案一定是有理数，所以你可以简单地计算其对 $998244353$ 取模的值。", "inputFormat": "第一行两个正整数 $n,m$。  \n接下来 $m$ 行，每行两个正整数 $a_i,b_i$，意义如题目描述。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "【样例 $1$ 解释】\n\n此时 $m=3$，前 $m$ 个阶段中，第一阶段的成功概率为 $1/2$，之后两个阶段的成功概率都为 $2/3$。由此可以算出，恰好尝试 $k \\ (k \\geq m)$ 次完成前 $m$ 个阶段的概率为（我有一个巧妙的方法给出证明，可惜这里空间太小，写不下）：\n\n$$p_k=2^{4-k}-4(k+1)3^{1-k}$$\n例如 $p_3=2/9$，这是每个阶段都一次成功的概率 $1/2 \\times 2/3 \\times 2/3$。  \n又如 $p_4=7/27$，这要求在某一阶段尝试恰好两次，其它阶段都一次成功，即：\n$$p_4=\\left( \\frac 12\\right)^2   \\frac 23 \\cdot \\frac 23+\\frac 12\\left( \\frac 29\\right)\\frac 23+\\frac 12\\cdot \\frac 23\\left( \\frac 29\\right)$$\n样例中 $n=2$，可知 $c=1$ 的概率为 $1/4$，$c=-1$ 的概率为 $1/4$，还有 $1/2$ 的概率 $c=0$。故答案为\n\n$$\\frac 14\\sum_{k\\geq 3}p_k (1+(-1)^k)=\\frac{11}{48}$$\n对 $998244353$ 取模后为 $103983787$。\n\n【样例 $2$ 解释】\n\n取模前的答案为 $\\dfrac{24284321}{191028915}$。\n\n【数据范围】 \n\n**本题使用捆绑测试。**\n\n\nSubtask 1（7 pts）：$n\\le 6$，$m=1$；   \nSubtask 2（9 pts）：$n\\le 6$，$m\\le 10$；  \nSubtask 3（13 pts）：$n\\le 500$，$m\\le 500$；   \nSubtask 4（13 pts）：$n=2^{19}$；  \nSubtask 5（15 pts）：$n \\le 10^5$，$m\\le 500$；  \nSubtask 6（15 pts）：不同的 $a_i/b_i$ 最多有两组；   \nSubtask 7（28 pts）：无特殊限制。\n\n\n对于全部数据，$1\\le n \\le 10^8$，$1\\le m \\le 60000$，$1\\le a_i<b_i\\leq 10^8$。且保证\n\n$$U_n\\left( \\frac{b_i}{b_i-a_i}\\right)\\not \\equiv 0 \\pmod{998244353}$$\n其中 $U_n(x)$ 表示 $n$ 次的[第二类 Chebyshev 多项式](https://mathworld.wolfram.com/ChebyshevPolynomialoftheSecondKind.html)。\n\n【提示】   \n你在找什么呢？或许可以再看看题目背景，会有帮助的。", "locale": "zh-CN"}}}
{"pid": "P10326", "type": "P", "difficulty": 7, "samples": [["0\n3 5 12\n2 4 6\n2 3 5\n1 2 3\n3 1 7\n3 2 11\n1 1 2", "155"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "洛谷原创", "提交答案", "枚举", "组合数学", "生成函数", "线性代数", "洛谷比赛"], "title": "自由（Freedom）", "background": "完全抽象的，只在数学中被允许的**无限**的「自由」。\n\n****\n\n「自由之光」，未知数的骑士 —— 知修。哪怕面对的是无限的绝望，他也能将其转变为无限的自由。", "description": "给定一个 $n$ 个节点、$m$ 条边的**有向图**，节点和边都有权值，保证对于任意两个节点 $u,v$，从 $u$ 指向 $v$ 的边最多只有一条。\n\n**路径** $P$ 是一个节点序列 $u_1,\\cdots,u_k$，其中对于任意 $1\\leq i < k$，$u_i$ 有指向 $u_{i+1}$ 的边（这条边记为 $e_i$）。则定义 $P$ 的**边权**是所有 $e_i$ 的权值的乘积，其**点权**是所有 $u_i$ 权值的和，其**长度**为 $k$。特别地，如果 $k=1$，则定义其**边权**为 $1$。\n\n对于两条路径 $P_1,P_2$，长度分别为 $L_1,L_2$，包含的节点序列记为 $u_1,\\cdots,u_{L_1}$ 和 $v_1,\\cdots,v_{L_2}$。定义它们是**相同**的，当且仅当 $L_1=L_2$，且对于所有 $1\\le i \\le L_1$ 有 $u_i=v_i$。\n\n给定正整数 $V$，请求出所有不相同的「**点权**为 $V$ 的路径」的**边权**之和。答案可能很大，请对 $998244353$ 取模后输出。\n\n**题目的输入数据下载链接：[Link1](https://pan.baidu.com/s/1Gn0T5DNQBwC41oR-0hsh4A)，提取码：`92ih`；**   \n备用下载路径与操作方法：[Link2](https://www.luogu.com.cn/paste/xkqpnptw)。", "inputFormat": "第一行一个正整数 $T$，表示测试点编号。\n\n第二行三个正整数 $n,m,V$，意义如题目描述。  \n第三行 $n$ 个正整数 $a_1,\\cdots,a_n$，$a_i$ 表示了编号为 $i$ 的节点的权值。  \n接下来 $m$ 行，每行三个正整数 $u_i,v_i,w_i$，表示编号为 $u_i$ 的点有一条权值为 $w_i$ 的边指向 $v_i$。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "【样例 $1$ 解释】\n\n样例中 $V=12$，满足点权为 $12$ 的路径有：   \n（给出的是路径中节点的编号，样例中每个节点的权值恰好为其编号的两倍）\n\n- $1 \\to 1\\to 1\\to 1\\to 1\\to 1$，边权为 $2^5=32$。 \n- $1\\to 1\\to 1\\to 1 \\to 2$，边权为 $3\\times 2^3=24$。  \n- $1\\to 2 \\to 3$，边权为 $3\\times 5=15$。  \n- $2\\to 3\\to 1$，边权为 $5\\times 7=35$。  \n- $3\\to 1\\to 1\\to 1$，边权为 $7\\times 2^2=28$。  \n- $3\\to 1\\to 2$，边权为 $7\\times 3=21$。\n\n故答案为 $32+24+15+35+28+21=155$。\n\n【数据信息】\n\n| 测试点编号 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| 测试点名称 | W | K\\_1 | K\\_2 | K\\_3 | MP\\_1 | MP\\_2 | MP\\_3 | MP\\_4 | R | Finale |\n| 测试点分数 | $10$ | $10$ | $10$ | $10$ | $10$ | $10$ | $10$ | $10$ | $10$ | $10$ |\n\n\n对于全部的数据，$1\\le n \\le10^5$，$1\\le m \\le \\min(n^2,10^6)$，$1\\le V \\le 10^{10000000}$。\n\n【提示】   \n**时间**是宝贵的。代码运行需要时间，你的思考也需要时间。好在这两件事可以同时进行，希望你可以在这有限的时间内做更多的事，拿到更好的成绩。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "自由（Freedom）", "background": "完全抽象的，只在数学中被允许的**无限**的「自由」。\n\n****\n\n「自由之光」，未知数的骑士 —— 知修。哪怕面对的是无限的绝望，他也能将其转变为无限的自由。", "description": "给定一个 $n$ 个节点、$m$ 条边的**有向图**，节点和边都有权值，保证对于任意两个节点 $u,v$，从 $u$ 指向 $v$ 的边最多只有一条。\n\n**路径** $P$ 是一个节点序列 $u_1,\\cdots,u_k$，其中对于任意 $1\\leq i < k$，$u_i$ 有指向 $u_{i+1}$ 的边（这条边记为 $e_i$）。则定义 $P$ 的**边权**是所有 $e_i$ 的权值的乘积，其**点权**是所有 $u_i$ 权值的和，其**长度**为 $k$。特别地，如果 $k=1$，则定义其**边权**为 $1$。\n\n对于两条路径 $P_1,P_2$，长度分别为 $L_1,L_2$，包含的节点序列记为 $u_1,\\cdots,u_{L_1}$ 和 $v_1,\\cdots,v_{L_2}$。定义它们是**相同**的，当且仅当 $L_1=L_2$，且对于所有 $1\\le i \\le L_1$ 有 $u_i=v_i$。\n\n给定正整数 $V$，请求出所有不相同的「**点权**为 $V$ 的路径」的**边权**之和。答案可能很大，请对 $998244353$ 取模后输出。\n\n**题目的输入数据下载链接：[Link1](https://pan.baidu.com/s/1Gn0T5DNQBwC41oR-0hsh4A)，提取码：`92ih`；**   \n备用下载路径与操作方法：[Link2](https://www.luogu.com.cn/paste/xkqpnptw)。", "inputFormat": "第一行一个正整数 $T$，表示测试点编号。\n\n第二行三个正整数 $n,m,V$，意义如题目描述。  \n第三行 $n$ 个正整数 $a_1,\\cdots,a_n$，$a_i$ 表示了编号为 $i$ 的节点的权值。  \n接下来 $m$ 行，每行三个正整数 $u_i,v_i,w_i$，表示编号为 $u_i$ 的点有一条权值为 $w_i$ 的边指向 $v_i$。", "outputFormat": "输出一行一个整数，表示答案。", "hint": "【样例 $1$ 解释】\n\n样例中 $V=12$，满足点权为 $12$ 的路径有：   \n（给出的是路径中节点的编号，样例中每个节点的权值恰好为其编号的两倍）\n\n- $1 \\to 1\\to 1\\to 1\\to 1\\to 1$，边权为 $2^5=32$。 \n- $1\\to 1\\to 1\\to 1 \\to 2$，边权为 $3\\times 2^3=24$。  \n- $1\\to 2 \\to 3$，边权为 $3\\times 5=15$。  \n- $2\\to 3\\to 1$，边权为 $5\\times 7=35$。  \n- $3\\to 1\\to 1\\to 1$，边权为 $7\\times 2^2=28$。  \n- $3\\to 1\\to 2$，边权为 $7\\times 3=21$。\n\n故答案为 $32+24+15+35+28+21=155$。\n\n【数据信息】\n\n| 测试点编号 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| 测试点名称 | W | K\\_1 | K\\_2 | K\\_3 | MP\\_1 | MP\\_2 | MP\\_3 | MP\\_4 | R | Finale |\n| 测试点分数 | $10$ | $10$ | $10$ | $10$ | $10$ | $10$ | $10$ | $10$ | $10$ | $10$ |\n\n\n对于全部的数据，$1\\le n \\le10^5$，$1\\le m \\le \\min(n^2,10^6)$，$1\\le V \\le 10^{10000000}$。\n\n【提示】   \n**时间**是宝贵的。代码运行需要时间，你的思考也需要时间。好在这两件事可以同时进行，希望你可以在这有限的时间内做更多的事，拿到更好的成绩。", "locale": "zh-CN"}}}
{"pid": "P10327", "type": "P", "difficulty": 7, "samples": [["3\n5\n1 5 3 2 4\n5\n1 2 3 4 5\n6\n5 3 6 1 4 2", "11\n5\n19"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2024", "O2优化", "高校校赛"], "title": "[UESTCPC 2024] 汉诺塔排序问题", "background": "", "description": "Natsuzora 在玩一个特殊规则的汉诺塔。\n\n汉诺塔有 $A$、$B$、$C$ 共三根柱子，每根柱子上可以堆叠放置圆盘。圆盘可以在不同柱子之间移动，但必须遵守以下规则：\n\n- 一次只有一个圆盘被移动；\n- 每次移动只能将一个柱子最顶端的圆盘移动到另一个柱子的最顶端；\n- 在柱子 $B$ 和 $C$ 上，不允许任何圆盘放置在另外一个比它本身小的圆盘上；\n- **在柱子 $A$ 上，允许将较大的圆盘放置在较小的圆盘上。**\n\n最开始时，Natsuzora 将 $n$ 个大小互不相同的圆盘乱序地摞在 $A$ 柱子上并将柱子 $B$ 和 $C$ 留空。在满足上述条件的情况下，Natsuzora 想要知道，若要将 $A$ 柱上的圆盘全部移动到 $B$ 柱上，他至少需要进行多少次移动。", "inputFormat": "第一行包含一个整数 $T$ $(1\\leq T\\leq 10^4)$，表示数据组数。\n\n每组数据的第一行包含一个整数 $n$ $(1\\leq n\\leq 10^5)$，表示初始状态下柱子 $A$ 上的圆盘数量。\n\n每组数据的第二行包含 $n$ 个整数 $p_1,p_2,\\ldots,p_n$ $(1\\leq p_i\\leq n)$，其中 $p_i$ 表示柱子 $A$ **从下往上**第 $i$ 个圆盘的直径。数据保证 $p_1,p_2,\\ldots,p_n$ 是一个长度为 $n$ 的排列，即 $1$ 到 $n$ 中的每个整数都在序列中出现恰好一次。\n\n对于所有数据，保证 $\\sum n\\leq 2\\times 10^5$。", "outputFormat": "对于每组数据，输出一行一个整数，表示需要的最少移动次数。", "hint": "在第一个样例中，一种可行的次数最少的移动方案如下（$X\\rightarrow Y$ 表示将柱子 $X$ 最顶上的圆盘移动到柱子 $Y$ 的顶部）：\n\n  1. $A\\rightarrow C$\n  2. $A\\rightarrow B$\n  3. $A\\rightarrow C$\n  4. $B\\rightarrow C$\n  5. $A\\rightarrow B$\n  6. $C\\rightarrow A$\n  7. $C\\rightarrow A$\n  8. $C\\rightarrow B$\n  9. $A\\rightarrow B$\n  10. $A\\rightarrow B$\n  11. $A\\rightarrow B$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[UESTCPC 2024] 汉诺塔排序问题", "background": "", "description": "Natsuzora 在玩一个特殊规则的汉诺塔。\n\n汉诺塔有 $A$、$B$、$C$ 共三根柱子，每根柱子上可以堆叠放置圆盘。圆盘可以在不同柱子之间移动，但必须遵守以下规则：\n\n- 一次只有一个圆盘被移动；\n- 每次移动只能将一个柱子最顶端的圆盘移动到另一个柱子的最顶端；\n- 在柱子 $B$ 和 $C$ 上，不允许任何圆盘放置在另外一个比它本身小的圆盘上；\n- **在柱子 $A$ 上，允许将较大的圆盘放置在较小的圆盘上。**\n\n最开始时，Natsuzora 将 $n$ 个大小互不相同的圆盘乱序地摞在 $A$ 柱子上并将柱子 $B$ 和 $C$ 留空。在满足上述条件的情况下，Natsuzora 想要知道，若要将 $A$ 柱上的圆盘全部移动到 $B$ 柱上，他至少需要进行多少次移动。", "inputFormat": "第一行包含一个整数 $T$ $(1\\leq T\\leq 10^4)$，表示数据组数。\n\n每组数据的第一行包含一个整数 $n$ $(1\\leq n\\leq 10^5)$，表示初始状态下柱子 $A$ 上的圆盘数量。\n\n每组数据的第二行包含 $n$ 个整数 $p_1,p_2,\\ldots,p_n$ $(1\\leq p_i\\leq n)$，其中 $p_i$ 表示柱子 $A$ **从下往上**第 $i$ 个圆盘的直径。数据保证 $p_1,p_2,\\ldots,p_n$ 是一个长度为 $n$ 的排列，即 $1$ 到 $n$ 中的每个整数都在序列中出现恰好一次。\n\n对于所有数据，保证 $\\sum n\\leq 2\\times 10^5$。", "outputFormat": "对于每组数据，输出一行一个整数，表示需要的最少移动次数。", "hint": "在第一个样例中，一种可行的次数最少的移动方案如下（$X\\rightarrow Y$ 表示将柱子 $X$ 最顶上的圆盘移动到柱子 $Y$ 的顶部）：\n\n  1. $A\\rightarrow C$\n  2. $A\\rightarrow B$\n  3. $A\\rightarrow C$\n  4. $B\\rightarrow C$\n  5. $A\\rightarrow B$\n  6. $C\\rightarrow A$\n  7. $C\\rightarrow A$\n  8. $C\\rightarrow B$\n  9. $A\\rightarrow B$\n  10. $A\\rightarrow B$\n  11. $A\\rightarrow B$", "locale": "zh-CN"}}}
{"pid": "P10328", "type": "P", "difficulty": 5, "samples": [["2 2\n1 1 1 1\n2 1 1 1", "582309208"], ["2 4\n1 2 3 4\n4 3 2 1", "570601408"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2024", "O2优化", "高校校赛"], "title": "[UESTCPC 2024] 卡牌游戏", "background": "", "description": "李华有一副卡牌，每张卡牌有颜色、数字以及价值三个属性。每张卡牌的颜色可以用一个 $[1,n]$ 中的整数代表，同样的，每张卡牌上会写有一个 $[1,n]$ 之间的整数。根据数字和颜色的不同，这些卡牌被分为 $n^2$ 种。\n\n为了方便表示，记一张颜色为 $x$，数字为 $y$ 的卡牌种类编号为 $(x-1)\\times n+y$。在牌堆中，第 $i$ 种卡牌共有 $a_i$ 张，每张卡牌的价值为 $b_i$。\n\n一开始，李华的手牌为空，初始积分为 $0$，李华会进行 $k$ 轮游戏。在每一轮的开始，李华会从牌堆里剩余的牌中**随机**取出一张牌，抽到每张牌的概率都是相等的。紧接着，如果手牌中含有与取出的牌数字**或**颜色相同的牌，那么李华会将**所有的**符合上述条件的牌加上原本取出的牌放回牌堆，反之则将抽出的牌置于手牌中。\n\n每一轮结束后，李华的积分会加上其手牌中所有牌的价值，请帮李华求出 $k$ 轮后的期望总积分对 $998244353$ 取模后的值。", "inputFormat": "第一行两个正整数 $n,k$ $(2\\le n\\le 4, 1\\le k\\le 10^9)$，代表颜色及数字的种类数和游戏轮数。\n\n第二行为 $n^2$ 个整数 $a_i$ $(0\\le a_i<998244353)$，代表牌堆里每种卡牌的数量。\n\n第三行为 $n^2$ 个整数 $b_i$ $(0\\le b_i<998244353)$，代表每种卡牌的积分。\n\n数据保证不会出现所有卡牌可以同时置于手牌中的情况，且 $\\sum a_i< 998244353$。", "outputFormat": "输出一行一个整数，代表 $k$ 轮之后的总分期望值。", "hint": "对于第一个样例，最后得分与概率的对应如下：\n\n| 得分 | $1$ | $2$ | $3$ | $4$ | $5$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| 概率 | $\\frac 12$ | $\\frac 16$ | $\\frac 16$ | $\\frac 1{12}$ | $\\frac 1{12}$ |\n\n期望得分为 $\\frac{25}{12}$。\n\n对于第二个样例，期望得分为 $\\frac{5041}{810}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[UESTCPC 2024] 卡牌游戏", "background": "", "description": "李华有一副卡牌，每张卡牌有颜色、数字以及价值三个属性。每张卡牌的颜色可以用一个 $[1,n]$ 中的整数代表，同样的，每张卡牌上会写有一个 $[1,n]$ 之间的整数。根据数字和颜色的不同，这些卡牌被分为 $n^2$ 种。\n\n为了方便表示，记一张颜色为 $x$，数字为 $y$ 的卡牌种类编号为 $(x-1)\\times n+y$。在牌堆中，第 $i$ 种卡牌共有 $a_i$ 张，每张卡牌的价值为 $b_i$。\n\n一开始，李华的手牌为空，初始积分为 $0$，李华会进行 $k$ 轮游戏。在每一轮的开始，李华会从牌堆里剩余的牌中**随机**取出一张牌，抽到每张牌的概率都是相等的。紧接着，如果手牌中含有与取出的牌数字**或**颜色相同的牌，那么李华会将**所有的**符合上述条件的牌加上原本取出的牌放回牌堆，反之则将抽出的牌置于手牌中。\n\n每一轮结束后，李华的积分会加上其手牌中所有牌的价值，请帮李华求出 $k$ 轮后的期望总积分对 $998244353$ 取模后的值。", "inputFormat": "第一行两个正整数 $n,k$ $(2\\le n\\le 4, 1\\le k\\le 10^9)$，代表颜色及数字的种类数和游戏轮数。\n\n第二行为 $n^2$ 个整数 $a_i$ $(0\\le a_i<998244353)$，代表牌堆里每种卡牌的数量。\n\n第三行为 $n^2$ 个整数 $b_i$ $(0\\le b_i<998244353)$，代表每种卡牌的积分。\n\n数据保证不会出现所有卡牌可以同时置于手牌中的情况，且 $\\sum a_i< 998244353$。", "outputFormat": "输出一行一个整数，代表 $k$ 轮之后的总分期望值。", "hint": "对于第一个样例，最后得分与概率的对应如下：\n\n| 得分 | $1$ | $2$ | $3$ | $4$ | $5$ |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| 概率 | $\\frac 12$ | $\\frac 16$ | $\\frac 16$ | $\\frac 1{12}$ | $\\frac 1{12}$ |\n\n期望得分为 $\\frac{25}{12}$。\n\n对于第二个样例，期望得分为 $\\frac{5041}{810}$。", "locale": "zh-CN"}}}
