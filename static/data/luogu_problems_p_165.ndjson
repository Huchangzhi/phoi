{"pid": "P4339", "type": "P", "difficulty": 7, "samples": [["3 \n2 3\n2 4 \n6 8", "3 \n3\n5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "2018", "各省省选", "浙江", "强连通分量"], "title": "[ZJOI2018] 迷宫", "background": "九条可怜是一个贪玩的女孩子。", "description": "暑假快要到了，可怜打算在她家的私人海滩旁边建一座城堡，这样就可以在放暑假的时候 邀请她的朋友们来玩了。同时，可怜打算在城堡的地下修建一座迷宫，因为探险总是一件充满 乐趣的事情。\n\n经过简单的设计，可怜打算修建一座这样的迷宫：\n- 迷宫可以被抽象成 $n$ 个点，$nm$ 条边的有向图。$1$ 号点是唯一的入口也是唯一的出口。 \n- 每一个点恰好有 $m$ 条出边，且这些出边被依次标号为 $[0,m)$ 的正整数。 \n- 迷宫允许自环和重边。\n\n同时，一座优秀的迷宫应该有一定的解谜因素。因此可怜希望每一条从 $1$ 号点出发并回到 $1$ 号点的回路都有着一定的规律。可怜发现，如果把一条从 $1$ 出发的路径经过的所有边的编号都记录下来，那么能得到一个（可能有前导 $0$）的 $m$ 进制数；同时对于每一个（可能有前导 $0$）的 $m$ 进制数，都能对应回一 条从 $1$ 出发的路径。\n\n于是可怜选定了一个整数 $K$，她希望这个迷宫满足一条从 $1$ 出发的路径能回到 $1$ **当且仅当**这条路径对应的数是 $K$ 的倍数。\n\n现在可怜已经选定了 $m$ 和 $K$，但是她发现并不是对所有的 $n$，都存在满足上述所有条件的迷宫设计方案。建造迷宫是一件费时费力的事情，于是可怜想要找到一个最小的满足条件的 $n$。\n\n然而可怜对复杂的计算并不感兴趣，因此她想让你来帮她计算一下这个数值。", "inputFormat": "第一行输入一个整数 $T$ 表示数据组数。 \n\n接下来 $T$ 行每行两个十进制正整数 $m,K$ 表示可怜选定的整数。", "outputFormat": "对于每组数据，输出一行一个整数表示能够满足所有条件的最小的 $n$。如果不存在这样的 $n$，输出 `-1`。", "hint": "第一组数据（左）和第二组数据（右）的一种设计方案如下图所示。其中紫色边表示 $0$ 号边，蓝色边表示 $1$ 号边。\n\n![](https://cdn.luogu.com.cn/upload/pic/16017.png)\n\n![](https://cdn.luogu.com.cn/upload/pic/16018.png)", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2018] Maze", "background": "Kelian is a playful girl.", "description": "Summer vacation is coming, and Kelian plans to build a castle next to her private beach so she can invite her friends over during the holidays. She also plans to build a maze under the castle, because exploration is always fun.\n\nAfter a simple design, Kelian plans to build a maze as follows:\n- The maze can be abstracted as a directed graph with $n$ vertices and $nm$ edges. Vertex $1$ is the only entrance and also the only exit.\n- Each vertex has exactly $m$ outgoing edges, and these outgoing edges are labeled in order by integers in $[0, m)$.\n- Self-loops and parallel edges are allowed.\n\nA good maze should also have some puzzle elements. Kelian hopes that every cycle starting from vertex $1$ and returning to vertex $1$ follows a certain pattern. She finds that if you record the labels of all edges along a path starting from vertex $1$, you obtain a base-$m$ number (possibly with leading $0$s). Conversely, for every base-$m$ number (possibly with leading $0$s), there exists a corresponding path starting from vertex $1$.\n\nKelian then chooses an integer $K$. She wants the maze to satisfy: a path starting from vertex $1$ returns to vertex $1$ if and only if the number corresponding to this path is a multiple of $K$.\n\nNow that $m$ and $K$ have been chosen, she realizes that not every $n$ admits a maze design that meets all the conditions above. Since building a maze is time-consuming and laborious, Kelian wants to find the minimum $n$ that satisfies the conditions.\n\nHowever, Kelian is not interested in complicated calculations, so she asks you to compute this value for her.", "inputFormat": "The first line contains an integer $T$ — the number of test cases.\n\nEach of the next $T$ lines contains two positive decimal integers $m, K$ — the chosen integers.", "outputFormat": "For each test case, output a single integer: the minimum $n$ that satisfies all the conditions. If no such $n$ exists, output `-1`.", "hint": "One possible design for the first test case (left) and the second test case (right) is shown below. Purple edges denote the edge labeled $0$, and blue edges denote the edge labeled $1$.\n\n![](https://cdn.luogu.com.cn/upload/pic/16017.png)\n\n![](https://cdn.luogu.com.cn/upload/pic/16018.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2018] 迷宫", "background": "九条可怜是一个贪玩的女孩子。", "description": "暑假快要到了，可怜打算在她家的私人海滩旁边建一座城堡，这样就可以在放暑假的时候 邀请她的朋友们来玩了。同时，可怜打算在城堡的地下修建一座迷宫，因为探险总是一件充满 乐趣的事情。\n\n经过简单的设计，可怜打算修建一座这样的迷宫：\n- 迷宫可以被抽象成 $n$ 个点，$nm$ 条边的有向图。$1$ 号点是唯一的入口也是唯一的出口。 \n- 每一个点恰好有 $m$ 条出边，且这些出边被依次标号为 $[0,m)$ 的正整数。 \n- 迷宫允许自环和重边。\n\n同时，一座优秀的迷宫应该有一定的解谜因素。因此可怜希望每一条从 $1$ 号点出发并回到 $1$ 号点的回路都有着一定的规律。可怜发现，如果把一条从 $1$ 出发的路径经过的所有边的编号都记录下来，那么能得到一个（可能有前导 $0$）的 $m$ 进制数；同时对于每一个（可能有前导 $0$）的 $m$ 进制数，都能对应回一 条从 $1$ 出发的路径。\n\n于是可怜选定了一个整数 $K$，她希望这个迷宫满足一条从 $1$ 出发的路径能回到 $1$ **当且仅当**这条路径对应的数是 $K$ 的倍数。\n\n现在可怜已经选定了 $m$ 和 $K$，但是她发现并不是对所有的 $n$，都存在满足上述所有条件的迷宫设计方案。建造迷宫是一件费时费力的事情，于是可怜想要找到一个最小的满足条件的 $n$。\n\n然而可怜对复杂的计算并不感兴趣，因此她想让你来帮她计算一下这个数值。", "inputFormat": "第一行输入一个整数 $T$ 表示数据组数。 \n\n接下来 $T$ 行每行两个十进制正整数 $m,K$ 表示可怜选定的整数。", "outputFormat": "对于每组数据，输出一行一个整数表示能够满足所有条件的最小的 $n$。如果不存在这样的 $n$，输出 `-1`。", "hint": "第一组数据（左）和第二组数据（右）的一种设计方案如下图所示。其中紫色边表示 $0$ 号边，蓝色边表示 $1$ 号边。\n\n![](https://cdn.luogu.com.cn/upload/pic/16017.png)\n\n![](https://cdn.luogu.com.cn/upload/pic/16018.png)", "locale": "zh-CN"}}}
{"pid": "P4340", "type": "P", "difficulty": 6, "samples": [["5 5\n9384 887 2778 6916 7794\n2 8336\n5 493\n3 1422\n1 28\n4 60", "890543652\n252923708\n942282590\n228728040\n608998099"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2016", "线段树", "各省省选", "上海", "矩阵乘法", "逆元"], "title": "[SHOI2016] 随机序列", "background": "", "description": "你的面前有 $n$ 个数排成一行，分别为 $a_1,a_2,...,a_n$ 。你打算在每相邻的两个 $a_i$​​  和 $a_{i+1}$ 间都插入一个加号、减号或者乘号。那么一共有$3^{n-1}$ 种可能的表达式。\n\n你对所有可能的表达式的值的和非常感兴趣。但这毕竟太简单了，所以你还打算支持一个修改操作，可以修改某个 $a_i$ 的值。\n\n你能够编写一个程序对每个修改都输出修改完之后所有可能表达式的和吗？注意，修改是永久的，也就是说每次修改都是在上一次修改的基础上进行，而不是在最初的表达式上进行。", "inputFormat": "第一行包含两个正整数 $n$ 和 $Q$，为数的个数和询问的个数。\n第二行包含 $n$ 个非负整数，依次表示 $a_1,a_2,...,a_n$。\n接下来 $Q$ 行，每行包含两个非负整数 $t$ 和 $v$，表示要将 $a_t$ 修改为 $v$，其中 $1≤t≤n$。\n\n保证对于 $1≤j≤n$,$1≤i≤Q$，都有 $aj,vi≤10^4$\n", "outputFormat": "输出 $Q$ 行。对于每个修改输出一行，包含一个整数，表示修改之后所有可能表达式的和，对 $10^9+7$ 取模。", "hint": "对于20%的数据，n,q<=20\n\n对于50%的数据，n,q<=1000\n\n对于100%的数据，n,q<=100000\n\n- 2023.11.17 添加一组 hack 数据。", "locale": "zh-CN", "translations": {"en": {"title": "[SHOI2016] Random Sequence", "background": "", "description": "There are $n$ numbers in a row, namely $a_1, a_2, ..., a_n$. You plan to insert a plus, minus, or multiplication sign between each adjacent pair $a_i$ and $a_{i+1}$. Then there are $3^{n-1}$ possible expressions.\n\nYou are very interested in the sum of the values of all possible expressions. But that would be too easy, so you also plan to support an update operation that modifies the value of some $a_i$.\n\nCan you write a program that, after each update, outputs the sum of all possible expressions after the modification? Note that updates are permanent, which means each update is applied on top of the previous one, not on the initial sequence.", "inputFormat": "The first line contains two positive integers $n$ and $Q$, the number of values and the number of queries.\nThe second line contains $n$ non-negative integers, namely $a_1, a_2, ..., a_n$ in order.\nThe next $Q$ lines each contain two non-negative integers $t$ and $v$, meaning you set $a_t$ to $v$, where $1 \\le t \\le n$.\n\nIt is guaranteed that for all $1 \\le j \\le n$ and all $1 \\le i \\le Q$, we have $a_j, v_i \\le 10^4$.", "outputFormat": "Output $Q$ lines. For each update, output one line containing a single integer, the sum of all possible expressions after the update, modulo $10^9+7$.", "hint": "- For 20% of the testdata, $n, Q \\le 20$.\n- For 50% of the testdata, $n, Q \\le 1000$.\n- For 100% of the testdata, $n, Q \\le 100000$.\n- 2023-11-17: Added a set of hack testdata.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SHOI2016] 随机序列", "background": "", "description": "你的面前有 $n$ 个数排成一行，分别为 $a_1,a_2,...,a_n$ 。你打算在每相邻的两个 $a_i$​​  和 $a_{i+1}$ 间都插入一个加号、减号或者乘号。那么一共有$3^{n-1}$ 种可能的表达式。\n\n你对所有可能的表达式的值的和非常感兴趣。但这毕竟太简单了，所以你还打算支持一个修改操作，可以修改某个 $a_i$ 的值。\n\n你能够编写一个程序对每个修改都输出修改完之后所有可能表达式的和吗？注意，修改是永久的，也就是说每次修改都是在上一次修改的基础上进行，而不是在最初的表达式上进行。", "inputFormat": "第一行包含两个正整数 $n$ 和 $Q$，为数的个数和询问的个数。\n第二行包含 $n$ 个非负整数，依次表示 $a_1,a_2,...,a_n$。\n接下来 $Q$ 行，每行包含两个非负整数 $t$ 和 $v$，表示要将 $a_t$ 修改为 $v$，其中 $1≤t≤n$。\n\n保证对于 $1≤j≤n$,$1≤i≤Q$，都有 $aj,vi≤10^4$\n", "outputFormat": "输出 $Q$ 行。对于每个修改输出一行，包含一个整数，表示修改之后所有可能表达式的和，对 $10^9+7$ 取模。", "hint": "对于20%的数据，n,q<=20\n\n对于50%的数据，n,q<=1000\n\n对于100%的数据，n,q<=100000\n\n- 2023.11.17 添加一组 hack 数据。", "locale": "zh-CN"}}}
{"pid": "P4341", "type": "P", "difficulty": 4, "samples": [["7\n1010101", "3\n3\n2\n2\n4\n3\n3\n2\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2010", "北京", "枚举", "后缀数组 SA"], "title": "[BJWC2010] 外星联络", "background": "", "description": "小 P 在看过电影《超时空接触》(Contact)之后被深深的打动，决心致力于寻找外星人的事业。于是，他每天晚上都爬在屋顶上试图用自己的收音机收听外星人发来的信息。\n\n虽然他收听到的仅仅是一些噪声，但是他还是按照这些噪声的高低电平将接收到的信号改写为由 `0` 和 `1` 构成的串， 并坚信外星人的信息就隐藏在其中。他认为，外星人发来的信息一定会在他接受到的 01 串中重复出现，所以他希望找到他接受到的 01 串中所有重复出现次数大于 $1$ 的子串。\n\n但是他收到的信号串实在是太长了，于是，他希望你能编一个程序来帮助他。", "inputFormat": "输入文件的第一行是一个整数$N$ ，代表小 P 接收到的信号串的长度。  \n输入文件第二行包含一个长度为$N$ 的 01 串，代表小 P 接收到的信号串。", "outputFormat": "输出文件的每一行包含一个出现次数大于$1$ 的子串所出现的次数。输出的顺序按对应的子串的字典序排列。", "hint": "对于 100%的数据，满足 $0 \\le N \\le 3000$", "locale": "zh-CN", "translations": {"en": {"title": "[BJWC2010] Alien Contact", "background": "", "description": "After watching the movie \"Contact\" (超时空接触), Little P was deeply moved and decided to devote himself to the search for extraterrestrial life. Every night, he climbs onto the roof and tries to use his radio to listen for messages from aliens.\n\nAlthough he hears only noise, he still rewrites the received signal into a string of 0s and 1s according to the high and low levels of the noise, and firmly believes that the aliens' message is hidden within. He believes that the message sent by the aliens must repeat within the binary string he received, so he wants to find all substrings of the binary string that appear more than $1$ time.\n\nHowever, the signal string he received is too long, so he hopes you can write a program to help him.", "inputFormat": "The first line contains an integer $N$, the length of the received signal string.  \nThe second line contains a binary string of length $N$, representing the received signal string.", "outputFormat": "Output one line for each substring that appears more than $1$ time, containing its number of occurrences. Output the lines in lexicographical order of the corresponding substrings.", "hint": "For 100% of the testdata, $0 \\le N \\le 3000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJWC2010] 外星联络", "background": "", "description": "小 P 在看过电影《超时空接触》(Contact)之后被深深的打动，决心致力于寻找外星人的事业。于是，他每天晚上都爬在屋顶上试图用自己的收音机收听外星人发来的信息。\n\n虽然他收听到的仅仅是一些噪声，但是他还是按照这些噪声的高低电平将接收到的信号改写为由 `0` 和 `1` 构成的串， 并坚信外星人的信息就隐藏在其中。他认为，外星人发来的信息一定会在他接受到的 01 串中重复出现，所以他希望找到他接受到的 01 串中所有重复出现次数大于 $1$ 的子串。\n\n但是他收到的信号串实在是太长了，于是，他希望你能编一个程序来帮助他。", "inputFormat": "输入文件的第一行是一个整数$N$ ，代表小 P 接收到的信号串的长度。  \n输入文件第二行包含一个长度为$N$ 的 01 串，代表小 P 接收到的信号串。", "outputFormat": "输出文件的每一行包含一个出现次数大于$1$ 的子串所出现的次数。输出的顺序按对应的子串的字典序排列。", "hint": "对于 100%的数据，满足 $0 \\le N \\le 3000$", "locale": "zh-CN"}}}
{"pid": "P4342", "type": "P", "difficulty": 4, "samples": [["4\nt -7 t 4 x 2 x 5\n", "33\n1 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "1998", "IOI", "区间 DP"], "title": "[IOI 1998] Polygon", "background": "", "description": "Polygon is a game for one player that starts on a polygon with $N$ vertices, like the one in Figure 1, where $N=4$. Each vertex is labelled with an integer and each edge is labelled with either the symbol `+` (addition) or the symbol `*` (product). The edges are numbered from $1$ to $N$.\n\n![](https://cdn.luogu.com.cn/upload/pic/16086.png)\n\nOn the first move, one of the edges is removed. Subsequent moves involve the following steps: \n- pick an edge $E$ and the two vertices $V_1$ and $V_2$ that are linked by $E$; and \n- replace them by a new vertex, labelled with the result of performing the operation indicated in $E$ on the labels of $V_1$ and $V_2$.\n\nThe game ends when there are no more edges, and its score is the label of the single vertex remaining. \n\nConsider the polygon of Figure 1. The player started by removing edge 3. After that, the player picked edge 1, then edge 4, and, finally, edge 2. The score is 0. \n\n![](https://cdn.luogu.com.cn/upload/pic/16088.png)\n\nWrite a program that, given a polygon, computes the highest possible score and lists all the edges that, if removed on the first move, can lead to a game with that score. \n", "inputFormat": "Your program is to read from standard input. The input describes a polygon with N vertices. It contains two lines. On the first line is the number N. The second line contains the labels of edges 1, ..., N, interleaved with the vertices' labels (first that of the vertex between edges 1 and 2, then that of the vertex between edges 2 and 3, and so on, until that of the vertex between edges N and 1), all separated by one space. An edge label is either the letter t (representing +) or the letter x (representing *). \n\n3 <= N <= 50 \n\n\nFor any sequence of moves, vertex labels are in the range [-32768,32767]. \n", "outputFormat": "Your program is to write to standard output. On the first line your program must write the highest score one can get for the input polygon. On the second line it must write the list of all edges that, if removed on the first move, can lead to a game with that score. Edges must be written in increasing order, separated by one space.\n", "hint": "", "locale": "en", "translations": {"en": {"title": "[IOI 1998] Polygon", "background": "", "description": "Polygon is a game for one player that starts on a polygon with $N$ vertices, like the one in Figure 1, where $N=4$. Each vertex is labelled with an integer and each edge is labelled with either the symbol `+` (addition) or the symbol `*` (product). The edges are numbered from $1$ to $N$.\n\n![](https://cdn.luogu.com.cn/upload/pic/16086.png)\n\nOn the first move, one of the edges is removed. Subsequent moves involve the following steps: \n- pick an edge $E$ and the two vertices $V_1$ and $V_2$ that are linked by $E$; and \n- replace them by a new vertex, labelled with the result of performing the operation indicated in $E$ on the labels of $V_1$ and $V_2$.\n\nThe game ends when there are no more edges, and its score is the label of the single vertex remaining. \n\nConsider the polygon of Figure 1. The player started by removing edge 3. After that, the player picked edge 1, then edge 4, and, finally, edge 2. The score is 0. \n\n![](https://cdn.luogu.com.cn/upload/pic/16088.png)\n\nWrite a program that, given a polygon, computes the highest possible score and lists all the edges that, if removed on the first move, can lead to a game with that score. \n", "inputFormat": "Your program is to read from standard input. The input describes a polygon with N vertices. It contains two lines. On the first line is the number N. The second line contains the labels of edges 1, ..., N, interleaved with the vertices' labels (first that of the vertex between edges 1 and 2, then that of the vertex between edges 2 and 3, and so on, until that of the vertex between edges N and 1), all separated by one space. An edge label is either the letter t (representing +) or the letter x (representing *). \n\n3 <= N <= 50 \n\n\nFor any sequence of moves, vertex labels are in the range [-32768,32767]. \n", "outputFormat": "Your program is to write to standard output. On the first line your program must write the highest score one can get for the input polygon. On the second line it must write the list of all edges that, if removed on the first move, can lead to a game with that score. Edges must be written in increasing order, separated by one space.\n", "hint": "", "locale": "en"}, "zh-CN": {"title": "[IOI 1998] Polygon", "background": null, "description": "**题目可能有些许修改，但大意一致。**\n\nPolygon 是一个玩家在一个有 $n$ 个顶点的多边形上玩的游戏，如图所示，其中 $n = 4$。每个顶点用整数标记，每个边用符号 `+`（加）或符号 `*`（乘积）标记。\n\n![](https://cdn.luogu.org/upload/pic/16086.png)\n\n第一步，删除其中一条边。随后每一步： \n\n选择一条边连接的两个顶点 $V_1$ 和 $V_2$，用边上的运算符计算 $V_1$ 和 $V_2$ 得到的结果来替换这两个顶点。 \n\n游戏结束时，只有一个顶点，没有多余的边。\n\n如图所示，玩家先移除编号为 $3$ 的边。之后，玩家选择计算编号为 $1$ 的边，然后计算编号为 $4$ 的边，最后，计算编号为 $2$ 的边。结果是 $0$。\n\n![](https://cdn.luogu.org/upload/pic/16088.png)\n\n（译者注：这里每条边的运算符旁边的数字为边的编号，不拿来计算）\n\n编写一个程序，给定一个多边形，计算最高可能的分数。", "inputFormat": "输入描述一个有 $n$ 个顶点的多边形，它包含两行。第一行是数字 $n$，为总边数。\n\n第二行描述这个多边形，一共有 $n$ 组，每组中第一个字符为边 $i$ 的计算符号（`t` 代表相加，`x` 代表相乘），第二个代表顶点 $i$ 上的数字。多边形首尾相连。", "outputFormat": "第一行，输出最高的分数。在第二行，输出所有可能的在第一步即被清除后仍能得到最高分的边的下标，以严格升序输出。", "hint": "保证 $3 \\le n \\le 50$。\n\n对于任何一系列的操作，顶点数字都在 $[-32768,32767]$ 的范围内。", "locale": "zh-CN"}}}
{"pid": "P4343", "type": "P", "difficulty": 4, "samples": [["4 2\n2\n5\n-3\n9", "3 7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2015", "二分", "各省省选", "上海"], "title": "[SHOI2015] 自动刷题机", "background": "曾经发明了信号增幅仪的发明家 SHTSC 又公开了他的新发明：自动刷题机——一种可以自动 AC 题目的神秘装置。", "description": "自动刷题机刷题的方式非常简单：首先会瞬间得出题目的正确做法，然后开始写程序。每秒，自动刷题机的代码生成模块会有两种可能的结果：\n\n1. 写了 $x$ 行代码。\n2. 心情不好，删掉了之前写的 $y$ 行代码。（如果 $y$ 大于当前代码长度则相当于全部删除。）\n\n对于一个 OJ，存在某个固定的正整数长度 $n$，一旦自动刷题机在某秒结束时积累了大于等于 $n$ 行的代码，它就会自动提交并 AC 此题，然后新建一个文件（即弃置之前的所有代码）并开始写下一题。SHTSC 在某个 OJ 上跑了一天的自动刷题机，得到了很多条关于写代码的日志信息。他突然发现自己没有记录这个 OJ 的 $n$ 究竟是多少。所幸他通过自己在 OJ 上的 Rank 知道了自动刷题机一共切了 $k$ 道题，希望你计算 $n$ 可能的最小值和最大值。", "inputFormat": "第一行两个整数 $l,k$，表示刷题机的日志一共有 $l$ 行，一共切了 $k$ 题。\n\n接下来 $l$ 行，每行一个整数 $x_i$，依次表示每条日志。若 $x_i \\geq 0$，则表示写了 $x_i$ 行代码，若 $x_i \\lt 0$，则表示删除了 $-x_i$ 行代码。", "outputFormat": "输出一行两个整数，分别表示 $n$ 可能的最小值和最大值。  \n如果这样的 $n$ 不存在，请输出一行一个整数 $-1$。", "hint": "#### 数据规模与约定\n\n- 对于 $20\\%$ 的数据，保证 $1 \\le l \\le 10$；\n- 对于 $40\\%$ 的数据，保证 $1 \\le l \\le 100$ ；\n- 对于 $60\\%$ 的数据，保证 $1 \\le l \\le 2 \\times 10^3$；\n- 对于 $100\\%$ 的数据，保证 $1 \\leq l \\le 10^5$，$-10^9 \\le x_i \\le 10^9$，$k$ 在 ```int``` 存储范围内。", "locale": "zh-CN", "translations": {"en": {"title": "[SHOI2015] Automatic Problem-Solving Machine", "background": "The inventor SHTSC, who once invented a signal amplifier, has unveiled his new invention: an automatic problem-solving machine — a mysterious device that can automatically AC problems.", "description": "The way the automatic problem-solving machine works is very simple: it instantly figures out the correct solution to a problem, then starts writing code. Every second, the code generation module has two possible outcomes:\n\n1. It writes $x$ lines of code.\n2. In a bad mood, it deletes $y$ lines of previously written code. (If $y$ is greater than the current code length, this is equivalent to deleting everything.)\n\nFor an OJ, there is a fixed positive integer length $n$. Once the machine has accumulated at least $n$ lines of code at the end of a second, it will automatically submit and AC the problem, then create a new file (i.e., discard all previous code) and start the next problem. SHTSC ran the machine on an OJ for one day and obtained many log entries about code writing. He suddenly realized he did not record what $n$ on this OJ actually is. Fortunately, from his Rank on the OJ, he knows the machine solved $k$ problems in total. Please compute the minimum and maximum possible values of $n$.", "inputFormat": "The first line contains two integers $l, k$, indicating that the machine produced $l$ log entries and solved $k$ problems in total.\n\nThe next $l$ lines each contain an integer $x_i$, describing each log entry in order. If $x_i \\geq 0$, it means $x_i$ lines of code were written. If $x_i \\lt 0$, it means $-x_i$ lines of code were deleted.", "outputFormat": "Output one line with two integers, representing the minimum and maximum possible values of $n$.  \nIf no such $n$ exists, output one line with a single integer $-1$.", "hint": "Constraints\n- For $20\\%$ of the testdata, it is guaranteed that $1 \\le l \\le 10$.\n- For $40\\%$ of the testdata, it is guaranteed that $1 \\le l \\le 100$.\n- For $60\\%$ of the testdata, it is guaranteed that $1 \\le l \\le 2 \\times 10^3$.\n- For $100\\%$ of the testdata, it is guaranteed that $1 \\leq l \\le 10^5$, $-10^9 \\le x_i \\le 10^9$, and $k$ fits in the range of ```int```.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SHOI2015] 自动刷题机", "background": "曾经发明了信号增幅仪的发明家 SHTSC 又公开了他的新发明：自动刷题机——一种可以自动 AC 题目的神秘装置。", "description": "自动刷题机刷题的方式非常简单：首先会瞬间得出题目的正确做法，然后开始写程序。每秒，自动刷题机的代码生成模块会有两种可能的结果：\n\n1. 写了 $x$ 行代码。\n2. 心情不好，删掉了之前写的 $y$ 行代码。（如果 $y$ 大于当前代码长度则相当于全部删除。）\n\n对于一个 OJ，存在某个固定的正整数长度 $n$，一旦自动刷题机在某秒结束时积累了大于等于 $n$ 行的代码，它就会自动提交并 AC 此题，然后新建一个文件（即弃置之前的所有代码）并开始写下一题。SHTSC 在某个 OJ 上跑了一天的自动刷题机，得到了很多条关于写代码的日志信息。他突然发现自己没有记录这个 OJ 的 $n$ 究竟是多少。所幸他通过自己在 OJ 上的 Rank 知道了自动刷题机一共切了 $k$ 道题，希望你计算 $n$ 可能的最小值和最大值。", "inputFormat": "第一行两个整数 $l,k$，表示刷题机的日志一共有 $l$ 行，一共切了 $k$ 题。\n\n接下来 $l$ 行，每行一个整数 $x_i$，依次表示每条日志。若 $x_i \\geq 0$，则表示写了 $x_i$ 行代码，若 $x_i \\lt 0$，则表示删除了 $-x_i$ 行代码。", "outputFormat": "输出一行两个整数，分别表示 $n$ 可能的最小值和最大值。  \n如果这样的 $n$ 不存在，请输出一行一个整数 $-1$。", "hint": "#### 数据规模与约定\n\n- 对于 $20\\%$ 的数据，保证 $1 \\le l \\le 10$；\n- 对于 $40\\%$ 的数据，保证 $1 \\le l \\le 100$ ；\n- 对于 $60\\%$ 的数据，保证 $1 \\le l \\le 2 \\times 10^3$；\n- 对于 $100\\%$ 的数据，保证 $1 \\leq l \\le 10^5$，$-10^9 \\le x_i \\le 10^9$，$k$ 在 ```int``` 存储范围内。", "locale": "zh-CN"}}}
{"pid": "P4344", "type": "P", "difficulty": 5, "samples": [["10 10\n0 2 2\n0 4 6\n0 10 10\n2 1 10\n1 8 10 1 4\n2 1 10\n1 1 4 8 10\n2 1 10\n1 7 10 1 6\n2 1 10", "3\n3\n6\n6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2015", "线段树", "各省省选", "上海"], "title": "[SHOI2015] 脑洞治疗仪", "background": "", "description": "曾经发明了自动刷题机的发明家 SHTSC 又公开了他的新发明：脑洞治疗仪——一种可以治疗他因为发明而日益增大的脑洞的神秘装置。\n\n为了简单起见，我们将大脑视作一个 01 序列。$1$ 代表这个位置的脑组织正常工作，$0$ 代表这是一块脑洞。\n\n```cpp\n1      0      1      0      0      0      1      1      1      0\n```\n\n脑洞治疗仪修补某一块脑洞的基本工作原理就是将另一块连续区域挖出，将其中正常工作的脑组织填补在这块脑洞中。（所以脑洞治疗仪是脑洞的治疗仪？）\n\n例如，用上面第 $8$ 号位置到第 $10$ 号位置去修补第 $1$ 号位置到第 $4$ 号位置的脑洞，我们就会得到：\n\n```cpp\n1      1      1      1      0      0      1      0      0      0\n```\n\n如果再用第 $1$ 号位置到第 $4$ 号位置去修补第 $8$ 号位置到第 $10$ 号位置：\n\n```cpp\n0      0      0      0      0      0      1      1      1      1\n```\n\n这是因为脑洞治疗仪会把多余出来的脑组织直接扔掉。\n\n如果再用第 $7$ 号位置到第 $10$ 号位置去填补第 $1$ 号位置到第 $6$ 号位置：\n\n```cpp\n1      1      1      1      0      0      0      0      0      0\n```\n\n这是因为如果新脑洞挖出来的脑组织不够多，脑洞治疗仪仅会尽量填补位置比较靠前的脑洞。\n\n假定初始时 SHTSC 并没有脑洞，给出一些挖脑洞和脑洞治疗的操作序列，你需要即时回答 SHTSC 的问题：在大脑某个区间中最大的连续脑洞区域有多大。", "inputFormat": "第一行两个整数 $n,m$，表示 SHTSC 的大脑可分为从 $1$ 到 $n$ 编号的 $n$ 个连续区域，有 $m$ 个操作。\n\n以下 $m$ 行每行是下列三种格式之一：\n* $0\\quad l\\quad r$：SHTSC 挖了一个范围为 $[l, r]$ 的脑洞。\n* $1\\quad l_0\\quad r_0\\quad l_1\\quad r_1$：SHTSC 进行了一次脑洞治疗，用从 $l_0$ 到 $r_0$ 的脑组织修补 $l_1$ 到 $r_1$ 的脑洞。\n* $2\\quad l\\quad r$：SHTSC 询问 $[l, r]$ 区间内最大的脑洞有多大。\n\n上述区间均在 $[1, n]$ 范围内。", "outputFormat": "对于每个询问，输出一行一个整数，表示询问区间内最大连续脑洞区域有多大。", "hint": "对于 $20\\%$ 的数据，$n, m \\leq 100$；  \n对于 $50\\%$ 的数据，$n, m \\leq 20000$；  \n对于 $100\\%$ 的数据，$n, m \\leq 200000$。", "locale": "zh-CN", "translations": {"en": {"title": "[SHOI2015] Brainhole Treatment Device", "background": "", "description": "The inventor SHTSC, who once created the automatic problem-solving machine, has unveiled his new invention: the Brainhole Treatment Device — a mysterious apparatus that can treat the ever-enlarging “brainholes” caused by his inventions.\n\nFor simplicity, we regard the brain as a 01 sequence. $1$ means the tissue at that position is working normally, and $0$ means it is a brainhole.\n\n```cpp\n1      0      1      0      0      0      1      1      1      0\n```\n\nThe basic principle for repairing a certain brainhole is to excavate another contiguous region and use the normal tissue from it to fill the hole. (So is the brainhole treatment device actually a treatment device for brainholes?)\n\nFor example, if we use positions $8$ to $10$ to repair the hole from positions $1$ to $4$, we get:\n\n```cpp\n1      1      1      1      0      0      1      0      0      0\n```\n\nIf we then use positions $1$ to $4$ to repair positions $8$ to $10$:\n\n```cpp\n0      0      0      0      0      0      1      1      1      1\n```\n\nThis is because the Brainhole Treatment Device discards any excess tissue.\n\nIf we then use positions $7$ to $10$ to fill positions $1$ to $6$:\n\n```cpp\n1      1      1      1      0      0      0      0      0      0\n```\n\nThis is because if the excavated normal tissue is not enough, the device only fills the brainhole as much as possible starting from the earlier positions (smaller indices).\n\nAssume that initially SHTSC has no brainholes. Given a sequence of digging and treatment operations, you need to answer online: within a given interval of the brain, what is the size of the largest contiguous brainhole.", "inputFormat": "The first line contains two integers $n, m$, meaning SHTSC’s brain is divided into $n$ contiguous regions numbered from $1$ to $n$, and there are $m$ operations.\n\nEach of the following $m$ lines is in one of the following three formats:\n* $0\\quad l\\quad r$: SHTSC digs a brainhole covering the range $[l, r]$.\n* $1\\quad l_0\\quad r_0\\quad l_1\\quad r_1$: SHTSC performs one treatment, using the normal tissue from $l_0$ to $r_0$ to repair the brainholes from $l_1$ to $r_1$.\n* $2\\quad l\\quad r$: SHTSC asks for the size of the largest brainhole within the interval $[l, r]$.\n\nAll the above intervals lie within $[1, n]$.", "outputFormat": "For each query, output one line with one integer, the size of the largest contiguous brainhole within the query interval.", "hint": "For $20\\%$ of the testdata, $n, m \\leq 100$.\nFor $50\\%$ of the testdata, $n, m \\leq 20000$.\nFor $100\\%$ of the testdata, $n, m \\leq 200000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SHOI2015] 脑洞治疗仪", "background": "", "description": "曾经发明了自动刷题机的发明家 SHTSC 又公开了他的新发明：脑洞治疗仪——一种可以治疗他因为发明而日益增大的脑洞的神秘装置。\n\n为了简单起见，我们将大脑视作一个 01 序列。$1$ 代表这个位置的脑组织正常工作，$0$ 代表这是一块脑洞。\n\n```cpp\n1      0      1      0      0      0      1      1      1      0\n```\n\n脑洞治疗仪修补某一块脑洞的基本工作原理就是将另一块连续区域挖出，将其中正常工作的脑组织填补在这块脑洞中。（所以脑洞治疗仪是脑洞的治疗仪？）\n\n例如，用上面第 $8$ 号位置到第 $10$ 号位置去修补第 $1$ 号位置到第 $4$ 号位置的脑洞，我们就会得到：\n\n```cpp\n1      1      1      1      0      0      1      0      0      0\n```\n\n如果再用第 $1$ 号位置到第 $4$ 号位置去修补第 $8$ 号位置到第 $10$ 号位置：\n\n```cpp\n0      0      0      0      0      0      1      1      1      1\n```\n\n这是因为脑洞治疗仪会把多余出来的脑组织直接扔掉。\n\n如果再用第 $7$ 号位置到第 $10$ 号位置去填补第 $1$ 号位置到第 $6$ 号位置：\n\n```cpp\n1      1      1      1      0      0      0      0      0      0\n```\n\n这是因为如果新脑洞挖出来的脑组织不够多，脑洞治疗仪仅会尽量填补位置比较靠前的脑洞。\n\n假定初始时 SHTSC 并没有脑洞，给出一些挖脑洞和脑洞治疗的操作序列，你需要即时回答 SHTSC 的问题：在大脑某个区间中最大的连续脑洞区域有多大。", "inputFormat": "第一行两个整数 $n,m$，表示 SHTSC 的大脑可分为从 $1$ 到 $n$ 编号的 $n$ 个连续区域，有 $m$ 个操作。\n\n以下 $m$ 行每行是下列三种格式之一：\n* $0\\quad l\\quad r$：SHTSC 挖了一个范围为 $[l, r]$ 的脑洞。\n* $1\\quad l_0\\quad r_0\\quad l_1\\quad r_1$：SHTSC 进行了一次脑洞治疗，用从 $l_0$ 到 $r_0$ 的脑组织修补 $l_1$ 到 $r_1$ 的脑洞。\n* $2\\quad l\\quad r$：SHTSC 询问 $[l, r]$ 区间内最大的脑洞有多大。\n\n上述区间均在 $[1, n]$ 范围内。", "outputFormat": "对于每个询问，输出一行一个整数，表示询问区间内最大连续脑洞区域有多大。", "hint": "对于 $20\\%$ 的数据，$n, m \\leq 100$；  \n对于 $50\\%$ 的数据，$n, m \\leq 20000$；  \n对于 $100\\%$ 的数据，$n, m \\leq 200000$。", "locale": "zh-CN"}}}
{"pid": "P4345", "type": "P", "difficulty": 6, "samples": [["3\n5 5\n10 7\n1145 14", "32\n968\n763"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "2015", "各省省选", "上海", "Lucas 定理"], "title": "[SHOI2015] 超能粒子炮·改", "background": "", "description": "曾经发明了脑洞治疗仪与超能粒子炮的发明家 SHTSC 又公开了他的新发明：超能粒子炮・改——一种可以发射威力更加强大的粒子流的神秘装置。\n\n超能粒子炮・改相比超能粒子炮，在威力上有了本质的提升。它有两个参数 $n,k$ ，它会向每个编号为 $0$ 到 $k$ （包含两端）的位置 $i$ 发射威力为 $C_{n}^{i} \\bmod 2333$ 的粒子流。\n\n现在 SHTSC 给出了他的超能粒子炮・改的参数，让你求出其发射的粒子流的威力之和除以 $2333$ 所得的余数。", "inputFormat": "第一行一个整数 $t$ 表示数据组数。\n\n之后 $t$ 行，每行两个整数 $n,k$，含义如题面描述。", "outputFormat": "$t$ 行，每行一个整数，表示其粒子流的威力之和模 $2333$ 的值。", "hint": "对于 $10\\%$ 的数据，$t = 1,n,k \\le 1000$ ；  \n对于 $30\\%$ 的数据，$t = 1,n,k \\le 1000000$ ；  \n对于 $50\\%$ 的数据，$t = 1,n \\le 10^{18},k \\le 1000$ ；  \n对于 $70\\%$ 的数据，$t = 100,n,k \\le 10^{18}$ ；  \n对于 $100\\%$ 的数据，$t = 100000,n,k \\le 10^{18}$ .", "locale": "zh-CN", "translations": {"en": {"title": "[SHOI2015] Super Particle Cannon · Modified", "background": "", "description": "The inventor SHTSC, who once created the Brain-hole Therapy Device and the Super Particle Cannon, has now unveiled his new invention: Super Particle Cannon · Modified — a mysterious device that can fire particle streams with much greater power.\n\nCompared with the Super Particle Cannon, Super Particle Cannon · Modified has a fundamental increase in power. It has two parameters $n, k$. It fires, at each position $i$ numbered from $0$ to $k$ inclusive, a particle stream with power $C_{n}^{i} \\bmod 2333$.\n\nNow SHTSC gives you the parameters of his Super Particle Cannon · Modified. Please compute the remainder modulo $2333$ of the sum of the powers of the particle streams it fires.", "inputFormat": "The first line contains an integer $t$ denoting the number of test cases.\n\nThen follow $t$ lines. Each line contains two integers $n, k$, as described above.", "outputFormat": "Output $t$ lines. Each line contains one integer: the value of the sum of the powers modulo $2333$.", "hint": "For $10\\%$ of the testdata, $t = 1$, $n, k \\le 1000$.  \nFor $30\\%$ of the testdata, $t = 1$, $n, k \\le 1000000$.  \nFor $50\\%$ of the testdata, $t = 1$, $n \\le 10^{18}$, $k \\le 1000$.  \nFor $70\\%$ of the testdata, $t = 100$, $n, k \\le 10^{18}$.  \nFor $100\\%$ of the testdata, $t = 100000$, $n, k \\le 10^{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SHOI2015] 超能粒子炮·改", "background": "", "description": "曾经发明了脑洞治疗仪与超能粒子炮的发明家 SHTSC 又公开了他的新发明：超能粒子炮・改——一种可以发射威力更加强大的粒子流的神秘装置。\n\n超能粒子炮・改相比超能粒子炮，在威力上有了本质的提升。它有两个参数 $n,k$ ，它会向每个编号为 $0$ 到 $k$ （包含两端）的位置 $i$ 发射威力为 $C_{n}^{i} \\bmod 2333$ 的粒子流。\n\n现在 SHTSC 给出了他的超能粒子炮・改的参数，让你求出其发射的粒子流的威力之和除以 $2333$ 所得的余数。", "inputFormat": "第一行一个整数 $t$ 表示数据组数。\n\n之后 $t$ 行，每行两个整数 $n,k$，含义如题面描述。", "outputFormat": "$t$ 行，每行一个整数，表示其粒子流的威力之和模 $2333$ 的值。", "hint": "对于 $10\\%$ 的数据，$t = 1,n,k \\le 1000$ ；  \n对于 $30\\%$ 的数据，$t = 1,n,k \\le 1000000$ ；  \n对于 $50\\%$ 的数据，$t = 1,n \\le 10^{18},k \\le 1000$ ；  \n对于 $70\\%$ 的数据，$t = 100,n,k \\le 10^{18}$ ；  \n对于 $100\\%$ 的数据，$t = 100000,n,k \\le 10^{18}$ .", "locale": "zh-CN"}}}
{"pid": "P4346", "type": "P", "difficulty": 3, "samples": [["....x.xxxxx.xxxxx.x...x.xxxxx.xxxxx.xxxxx.......xxxxx.xxxxx.xxxxx\n....x.....x.....x.x...x.x.....x.........x...x...x...x.x...x.x...x\n....x.....x.....x.x...x.x.....x.........x...x...x...x.x...x.x...x\n....x.xxxxx.xxxxx.xxxxx.xxxxx.xxxxx.....x.xxxxx.xxxxx.xxxxx.x...x\n....x.x.........x.....x.....x.x...x.....x...x...x...x.....x.x...x\n....x.x.........x.....x.....x.x...x.....x...x...x...x.....x.x...x\n....x.xxxxx.xxxxx.....x.xxxxx.xxxxx.....x.......xxxxx.xxxxx.xxxxx", "....x.xxxxx.xxxxx.xxxxx.x...x.xxxxx.xxxxx\n....x.....x.....x.x.....x...x.x.........x\n....x.....x.....x.x.....x...x.x.........x\n....x.xxxxx.xxxxx.xxxxx.xxxxx.xxxxx.....x\n....x.x.........x.....x.....x.....x.....x\n....x.x.........x.....x.....x.....x.....x\n....x.xxxxx.xxxxx.xxxxx.....x.xxxxx.....x"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["模拟", "字符串", "2015", "枚举", "ICPC", "CERC"], "title": "[CERC2015] ASCII Addition", "background": "Nowadays, there are smartphone applications that instantly translate text and even solve math problems if you just point your phone’s camera at them. Your job is to implement a much simpler functionality reminiscent of the past – add two integers written down as ASCII art.", "description": "An ASCII art is a matrix of characters, exactly 7 rows high, with each individual character either a dot or the lowercase letter x.\n\nAn expression of the form a + b is given, where both a and b are positive integers. The expression is converted into ASCII art by writing all the expression characters (the digits of a and b as well as the + sign) as 7  5 matrices, and concatenating the matrices together with a single column of dot characters between consecutive individual matrices. The exact matrices corresponding to the digits and the + sign are as follows:\n\n![](https://cdn.luogu.com.cn/upload/pic/16222.png )\n\nGiven an ASCII art for an expression of the form a + b, find the result of the addition and write it out in the ASCII art form.", "inputFormat": "Input consists of exactly 7 lines and contains the ASCII art for an expression of the form a + b, where\nboth a and b are positive integers consisting of at most 9 decimal digits and written without leading\nzeros.", "outputFormat": "Output 7 lines containing ASCII art corresponding to the result of the addition, without leading zeros.", "hint": "样例：1234567+890=1235457\n\nCentral Europe Regional Contest 2015 Problem A", "locale": "en", "translations": {"en": {"title": "[CERC2015] ASCII Addition", "background": "Nowadays, there are smartphone applications that instantly translate text and even solve math problems if you just point your phone’s camera at them. Your job is to implement a much simpler functionality reminiscent of the past – add two integers written down as ASCII art.", "description": "An ASCII art is a matrix of characters, exactly 7 rows high, with each individual character either a dot or the lowercase letter x.\n\nAn expression of the form a + b is given, where both a and b are positive integers. The expression is converted into ASCII art by writing all the expression characters (the digits of a and b as well as the + sign) as 7  5 matrices, and concatenating the matrices together with a single column of dot characters between consecutive individual matrices. The exact matrices corresponding to the digits and the + sign are as follows:\n\n![](https://cdn.luogu.com.cn/upload/pic/16222.png )\n\nGiven an ASCII art for an expression of the form a + b, find the result of the addition and write it out in the ASCII art form.", "inputFormat": "Input consists of exactly 7 lines and contains the ASCII art for an expression of the form a + b, where\nboth a and b are positive integers consisting of at most 9 decimal digits and written without leading\nzeros.", "outputFormat": "Output 7 lines containing ASCII art corresponding to the result of the addition, without leading zeros.", "hint": "样例：1234567+890=1235457\n\nCentral Europe Regional Contest 2015 Problem A", "locale": "en"}, "zh-CN": {"title": "[CERC2015] ASCII Addition", "background": "", "description": "# 题目背景\n\n现在，如果你只是用手机的相机对着它们，智能手机应用可以即时翻译文本，甚至解决数学问题。您的工作是实现一个更简单的功能，回忆过去——添加两个作为ASCII艺术的整数。\n\n\nASCII艺术是一个字符矩阵，正好是7行高，每个字符都是点或小写字母X。\n\n给出了A +B形式的表达式，其中A和B都是正整数。通过将所有的表达式字符（A和B的数字以及符号）作为7 5个矩阵，将这些矩阵转换成ASCII艺术，并将矩阵与单个字符的单个列串联在连续的各个矩阵之间。对应于数字和+符号的精确矩阵如下：\n\n![](https://cdn.luogu.org/upload/pic/16222.png)\n\n给定一个ASCII艺术来表达A+B的形式，找到加法的结果并用ASCII艺术形式写出。", "inputFormat": "输入由7行组成，包含用于A+B形式的表达式的ASCII技术，其中A和B都是由至多9个十进制数字组成的正整数，并且没有前导零。", "outputFormat": "输出包含ASCII艺术的7行，对应于加法的结果，没有前导零。\n\n感谢@剑圣夜雨声烦 提供的翻译", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4347", "type": "P", "difficulty": 6, "samples": [["its a long way to the top if you wanna rock n roll\n13 16", "22\n12\n12\n15"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "ICPC", "CERC"], "title": "[CERC2015] Book Borders", "background": "A book is being typeset using a fixed width font and a simple greedy algorithm to fill each line. The\nbook contents is just a sequence of words, where each word contains one or more characters.", "description": "Before typesetting, we choose a maximum line length and denote this value with m. Each line can be at most m characters long including the space characters between the words. The typesetting algorithm simply processes words one by one and prints each word with exactly one space character between two consecutive words on the same line. If printing the word on the current line would exceed the maximum line length m, a new line is started instead.\n\n![](https://cdn.luogu.com.cn/upload/pic/16228.png)\n\nYou are given a text to be typeset and are experimenting with different values of the maximum line length m. For a fixed m, the leading sentence is a sentence (a sequence of words separated with a single space character) formed by the first words of lines top to bottom. In the example above, when the sample text is typeset with the maximum line length 14, the leading sentence is “its to you n”.\n\nGiven a text and two integers a and b, find the length of the leading sentence for every candidate maximum line length between a and b inclusive. The length of a sentence is the total number of characters it contains including the space characters.", "inputFormat": "The first line contains the text to be typeset – a sequence of words separated by exactly one space character. Each word is a string consisting of one or more lowercase letters from the English alphabet.\n\nThe second line contains two integers a and b – the edges of the interval we are interested in, as described above.\n\nIt is guaranteed that $1<=w<=a<=b<=z<=500 000$, where w is the length of the longest word in the text and z is the total number of characters in the text including the space characters.", "outputFormat": "Output $b - a + 1$ lines – the $k$-th of those lines should contain a single integer – the total length of the leading sentence when the maximum line length is equal to $a - 1 + k$.", "hint": "Central Europe Regional Contest 2015\nProblem B", "locale": "en", "translations": {"en": {"title": "[CERC2015] Book Borders", "background": "A book is being typeset using a fixed width font and a simple greedy algorithm to fill each line. The\nbook contents is just a sequence of words, where each word contains one or more characters.", "description": "Before typesetting, we choose a maximum line length and denote this value with m. Each line can be at most m characters long including the space characters between the words. The typesetting algorithm simply processes words one by one and prints each word with exactly one space character between two consecutive words on the same line. If printing the word on the current line would exceed the maximum line length m, a new line is started instead.\n\n![](https://cdn.luogu.com.cn/upload/pic/16228.png)\n\nYou are given a text to be typeset and are experimenting with different values of the maximum line length m. For a fixed m, the leading sentence is a sentence (a sequence of words separated with a single space character) formed by the first words of lines top to bottom. In the example above, when the sample text is typeset with the maximum line length 14, the leading sentence is “its to you n”.\n\nGiven a text and two integers a and b, find the length of the leading sentence for every candidate maximum line length between a and b inclusive. The length of a sentence is the total number of characters it contains including the space characters.", "inputFormat": "The first line contains the text to be typeset – a sequence of words separated by exactly one space character. Each word is a string consisting of one or more lowercase letters from the English alphabet.\n\nThe second line contains two integers a and b – the edges of the interval we are interested in, as described above.\n\nIt is guaranteed that $1<=w<=a<=b<=z<=500 000$, where w is the length of the longest word in the text and z is the total number of characters in the text including the space characters.", "outputFormat": "Output $b - a + 1$ lines – the $k$-th of those lines should contain a single integer – the total length of the leading sentence when the maximum line length is equal to $a - 1 + k$.", "hint": "Central Europe Regional Contest 2015\nProblem B", "locale": "en"}, "zh-CN": {"title": "[CERC2015] Book Borders", "background": "", "description": "现有一本书,用固定宽度的字体和简单的贪婪算法来填充每行文字。书的内容是一个单词序列，每个单词包含一个或多个字符。\r\n\r\n排版前，我们选择一个最大的行长度，并用m表示这个值。每行最多可以有m个字符，包括单词之间的空格字符。请使用排版算法简单地逐个处理单词，并在同一行上的两个连续单词之间打印每个单词，每个单词只有一个空格字符。而且如果在当前行上打印该字超过最大行长度m，则开始新行。\r\n![](https://cdn.luogu.org/upload/pic/16228.png)\r\n现在你得到了一个要排版的文本，并且正在试验最大行长度m的不同值。对于固定m，前导句是一个句子(由一个空格字符分隔的一系列单词)，由行的第一个单词从上到下组成。在上例中，当样本文本以最大行长度14进行排版时，前导句是“对你来说是n”（its to you n）\r\n给定一个文本和两个整数a和b，找出a和b之间每个候选最大行长度的前导句长度。句子的长度是它包含的字符总数，包括空格字符", "inputFormat": "第一行包含要排版的文本——由一个空格字符分隔的一系列单词。每个单词都是一个字符串，由英语字母表中的一个或多个小写字母组成。 第二行包含两个整数a和b——如上所述的区间边缘。保证1<=w <=a<=b<=z<=50000,\r\n其中w是文本中最长单词的长度，z是文本中包括空格字符的字符总数。", "outputFormat": "输出b-a+1行——这些行的第k行应该包含一个整数——最大行长度等于a-1+k时前导句的总长度。\r\n\r\n**输入输出样例**\r\n\r\n输入样例#1\r\n```\r\nits a long way to the top if you wanna rock n roll\r\n13 16\r\n```\r\n输出样例#1\r\n```\r\n22\r\n12\r\n12\r\n15\r\n```", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4348", "type": "P", "difficulty": 7, "samples": [["4 \n2 2 8 4 \n1 9 4 10 \n6 7 9 9 \n3 3 7 3 \n9 \n3 4 \n8 4 \n11 5 \n10 7 \n10 8 \n9 8 \n2 8 \n4 11 \n9 11 \n8 \n1 1 \n5 10 \n6 9 \n3 7 \n7 1 \n4 2 \n7 5 \n3 3", "5 \n1 \n0 \n1 \n3 \n1 \n3 \n0 "]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2015", "ICPC", "CERC"], "title": "[CERC2015] Cow Confinement", "background": "", "description": "A near by pasture can be represented as a rectangular grid consisting of 106 rows and 106 columns. The rows are numbered with integers 1 through 106 top to bottom, the columns with integers 1 through 106 left to right. \n\nA herd of n cows is scattered through the grid, each cow occupying a unit square. The pasture also contains m dandelion ﬂowers (which cows like), again each occupying a unit square. Finally, the pasture contains p fences, each a rectangle running along the edges of unit squares. Fences do not intersect or touch. However, a fence may contain other fences inside the enclosed area. \n\nDue to unfavorable wind conditions, cows can only move in two directions – down or right. Cows can go through squares occupied by other cows or ﬂowers, but cannot cross fences. \nFor each cow, ﬁnd the total number of ﬂowers reachable from its present location.", "inputFormat": "Input contains three blocks – the ﬁrst block describes fences, the second one ﬂowers and the third one cows. \n\nThe ﬁrst line of the ﬁrst block contains an integer f (0≤ f ≤200000) – the number of fences. Each of the following f lines contains four integers r1, c1, r2, c2 (1≤r1, c1, r2, c2 ≤$10^6$) describing a single fence – r1 and c1 are the coordinates (row and column) of the upper-left corner square inside the fence, while r2 and c2 are the coordinates of the lower-right corner square inside the fence. No two fences will intersect or touch. \n\nThe ﬁrst line of the second block contains an integer m (0≤m≤200000) – the number of ﬂowers. The k-th of the following m lines contains two integers r and c (1 ≤ r, c ≤ $10^6$) – the location of the k-th ﬂower. No two ﬂowers will occupy the same location. \n\nThe ﬁrst line of the third block contains an integer n (1≤n≤200000) – the number of cows. The k-th of the following n lines contains two integers r and c (1≤r, c≤$10^6$) – the location of the k-th cow. No two cows will occupy the same location, and no ﬂower and cow will occupy the same location.", "outputFormat": "Output should consist of n lines. The k-th line should contain a single integer – the total number of ﬂowers reachable from the location of the k-th cow.", "hint": "样例：\n\n![](https://cdn.luogu.com.cn/upload/pic/16231.png)\n\nCentral Europe Regional Contest 2015\nProblem C", "locale": "en", "translations": {"en": {"title": "[CERC2015] Cow Confinement", "background": "", "description": "A near by pasture can be represented as a rectangular grid consisting of 106 rows and 106 columns. The rows are numbered with integers 1 through 106 top to bottom, the columns with integers 1 through 106 left to right. \n\nA herd of n cows is scattered through the grid, each cow occupying a unit square. The pasture also contains m dandelion ﬂowers (which cows like), again each occupying a unit square. Finally, the pasture contains p fences, each a rectangle running along the edges of unit squares. Fences do not intersect or touch. However, a fence may contain other fences inside the enclosed area. \n\nDue to unfavorable wind conditions, cows can only move in two directions – down or right. Cows can go through squares occupied by other cows or ﬂowers, but cannot cross fences. \nFor each cow, ﬁnd the total number of ﬂowers reachable from its present location.", "inputFormat": "Input contains three blocks – the ﬁrst block describes fences, the second one ﬂowers and the third one cows. \n\nThe ﬁrst line of the ﬁrst block contains an integer f (0≤ f ≤200000) – the number of fences. Each of the following f lines contains four integers r1, c1, r2, c2 (1≤r1, c1, r2, c2 ≤$10^6$) describing a single fence – r1 and c1 are the coordinates (row and column) of the upper-left corner square inside the fence, while r2 and c2 are the coordinates of the lower-right corner square inside the fence. No two fences will intersect or touch. \n\nThe ﬁrst line of the second block contains an integer m (0≤m≤200000) – the number of ﬂowers. The k-th of the following m lines contains two integers r and c (1 ≤ r, c ≤ $10^6$) – the location of the k-th ﬂower. No two ﬂowers will occupy the same location. \n\nThe ﬁrst line of the third block contains an integer n (1≤n≤200000) – the number of cows. The k-th of the following n lines contains two integers r and c (1≤r, c≤$10^6$) – the location of the k-th cow. No two cows will occupy the same location, and no ﬂower and cow will occupy the same location.", "outputFormat": "Output should consist of n lines. The k-th line should contain a single integer – the total number of ﬂowers reachable from the location of the k-th cow.", "hint": "样例：\n\n![](https://cdn.luogu.com.cn/upload/pic/16231.png)\n\nCentral Europe Regional Contest 2015\nProblem C", "locale": "en"}, "zh-CN": {"title": "[CERC2015] Cow Confinement", "background": "", "description": "附近的一个牧场可以表示为一个由 $10^6$ 行和 $10^6$ 列组成的矩形网格。行从上到下用整数 $1$ 到 $10^6$ 编号，列从左到右用整数 $1$ 到 $10^6$ 编号。\n\n一群共 $n$ 头牛分散在网格中，每头牛占据一个单位方格。牧场中还包含 $m$ 朵蒲公英花（牛喜欢的花），同样每朵花占据一个单位方格。此外，牧场包含 $p$ 个栅栏，每个栅栏是一个沿单位方格边缘延伸的矩形。栅栏之间不会相交或接触。然而，一个栅栏内部可能包含其他栅栏。\n\n由于不利的风向条件，牛只能朝两个方向移动——向下或向右。牛可以经过被其他牛或花占据的方格，但不能穿过栅栏。  \n对于每头牛，求从它当前位置可以到达的花朵总数。", "inputFormat": "输入包含三个部分——第一部分描述栅栏，第二部分描述花朵，第三部分描述牛。\n\n第一部分的第一行包含一个整数 $f$（$0 \\leq f \\leq 200000$）——栅栏的数量。接下来的 $f$ 行每行包含四个整数 $r_1, c_1, r_2, c_2$（$1 \\leq r_1, c_1, r_2, c_2 \\leq 10^6$），描述一个栅栏——$r_1$ 和 $c_1$ 是栅栏内部左上角方格的坐标（行和列），而 $r_2$ 和 $c_2$ 是栅栏内部右下角方格的坐标。任意两个栅栏不会相交或接触。\n\n第二部分的第一行包含一个整数 $m$（$0 \\leq m \\leq 200000$）——花朵的数量。接下来的第 $k$ 行包含两个整数 $r$ 和 $c$（$1 \\leq r, c \\leq 10^6$）——第 $k$ 朵花的位置。任意两朵花不会占据同一位置。\n\n第三部分的第一行包含一个整数 $n$（$1 \\leq n \\leq 200000$）——牛的数量。接下来的第 $k$ 行包含两个整数 $r$ 和 $c$（$1 \\leq r, c \\leq 10^6$）——第 $k$ 头牛的位置。任意两头牛不会占据同一位置，且没有花和牛会占据同一位置。\n", "outputFormat": "输出应包含 $n$ 行。第 $k$ 行应包含一个整数——从第 $k$ 头牛的位置可以到达的花朵总数。\n", "hint": "样例图示：\n\n![](https://cdn.luogu.com.cn/upload/pic/16231.png)\n\nCentral Europe Regional Contest 2015  \nProblem C\n\n翻译由 DeepSeek V3 完成", "locale": "zh-CN"}}}
{"pid": "P4349", "type": "P", "difficulty": 5, "samples": [["4 2\n1246", "4"], ["4 7\n2015", "0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "ICPC", "CERC"], "title": "[CERC2015] Digit Division", "background": "", "description": "We are given a sequence of n decimal digits. The sequence needs to be partitioned into one or more contiguous subsequences such that each subsequence, when interpreted as a decimal number, is divisible by a given integer m. \n\nFind the number of different such partitions modulo $10^9 +7$. When determining if two partitions are different, we only consider the locations of subsequence boundaries rather than the digits themselves, e.g. partitions $2|22$ and $22|2$ are considered different.", "inputFormat": "The ﬁrst line contains two integers n and m (1≤n≤300000, 1≤m≤1000000) – the length of the sequence and the divisor respectively. The second line contains a string consisting of exactly n digits.", "outputFormat": "Output a single integer – the number of different partitions modulo 109 +7.", "hint": "Central Europe Regional Contest 2015 Problem D", "locale": "en", "translations": {"en": {"title": "[CERC2015] Digit Division", "background": "", "description": "We are given a sequence of n decimal digits. The sequence needs to be partitioned into one or more contiguous subsequences such that each subsequence, when interpreted as a decimal number, is divisible by a given integer m. \n\nFind the number of different such partitions modulo $10^9 +7$. When determining if two partitions are different, we only consider the locations of subsequence boundaries rather than the digits themselves, e.g. partitions $2|22$ and $22|2$ are considered different.", "inputFormat": "The ﬁrst line contains two integers n and m (1≤n≤300000, 1≤m≤1000000) – the length of the sequence and the divisor respectively. The second line contains a string consisting of exactly n digits.", "outputFormat": "Output a single integer – the number of different partitions modulo 109 +7.", "hint": "Central Europe Regional Contest 2015 Problem D", "locale": "en"}, "zh-CN": {"title": "[CERC2015] Digit Division", "background": "", "description": "给定一个长度为 $n$ 的十进制数字序列。需要将该序列划分为一个或多个连续的子序列，使得每个子序列在被解释为十进制数时都能被给定的整数 $m$ 整除。\n\n求不同的划分方式的数量，结果对 $10^9 + 7$ 取模。当判断两个划分是否不同的时候，我们只考虑子序列边界的位置，而不是数字本身。例如，划分 $2|22$ 和 $22|2$ 被认为是不同的。", "inputFormat": "第一行包含两个整数 $n$ 和 $m$ ($1 \\leq n \\leq 300000$, $1 \\leq m \\leq 1000000$) —— 序列的长度和除数。第二行包含一个恰好由 $n$ 个数字组成的字符串。", "outputFormat": "输出一个整数，即不同划分的数量，对 $10^9 + 7$ 取模。", "hint": "Central Europe Regional Contest 2015 Problem D。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P4350", "type": "P", "difficulty": 6, "samples": [["6 7 \n1 2 20 \n2 3 80 \n2 5 100 \n3 5 50 \n3 4 100 \n5 6 90 \n4 6 100 \n4 \n25 75 85 95", "2 3 \n1 1 \n2 1 \n4 2\n"], ["10 14 \n2 7 150 \n1 2 100 \n2 3 150 \n3 1 200 \n1 4 60 \n4 5 20 \n2 5 100 \n5 6 90 \n6 7 120 \n7 5 130 \n6 8 50 \n8 9 200 \n9 10 200 \n10 7 200 \n5 \n300 50 95 100 110", "0 0 \n6 9 \n4 5 \n4 5 \n5 4"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "ICPC", "CERC"], "title": "[CERC2015] Export Estimate", "background": "Luka owns a geographic data company that maintains a detailed city map and exports the data to interested parties. Often, clients do not want the complete map. Instead, they want a simpliﬁed map containing only major streets. ", "description": "City map is an undirected graph consisting of n intersections denoted with integers from 1 to n and m two-way streets. Each street is assigned a priority – a non-negative integer. When requesting a map, the client selects a threshold priority p. The original map is then copied and converted to the exported map using the following procedure:\n\n1. All streets whose priority is lower than p are deleted. \n\n2. For each intersection i from 1,2,...,n (processed in that order): \n\n(a) If the intersection i is not connected to any streets it is deleted. \n\n(b) If the intersection i is connected to exactly two different streets x and y leading to intersections a and b both different from i then the intersection i is contracted using the following procedure: \n\ni. Streets x and y are deleted. \n\nii. Intersection i is deleted. \n\niii. New street z connecting intersections a and b is added.\n\n![](https://cdn.luogu.com.cn/upload/pic/16236.png )\n\nInitially, the map does not contain loops (loop is a street that connects an intersection to itself) or parallel edges (more than one street between the same pair of intersections), but the loops and parallel edges may form during the contraction procedure. Notice that, in the step 2. (b) above, neither x nor y can be a loop (both a and b have to be different from i), but the newly added street z could be a loop (it is possible that a and b are same). \n\nGiven a map and a sequence of incoming export requests, for each request ﬁnd the number of intersections and the number of streets in the exported map.", "inputFormat": "The ﬁrst line contains two integers n (1 ≤ n ≤ 300000) and m (1 ≤ m ≤ 300000) – the number of intersections and the number of streets, respectively. Each of the following m lines contains three integers a, b and p (1≤ a,b≤n,0≤ p≤300000) which describe a street with priority p connecting intersections a and b. No street connects an intersection to itself. There is at most one street between every two intersections. \n\nThe following line contains an integer q (1 ≤ q ≤ 300000) – the number of export requests. The following line contains q integers. The k-th integer tk (0≤tk ≤300000) is the threshold priority of the k-th request.", "outputFormat": "Output should consist of q lines. The k-th line should contain two integers–the number of intersections and the number of streets, respectively, in the exported map for the k-th request.", "hint": "Central Europe Regional Contest 2015 Problem E", "locale": "en", "translations": {"en": {"title": "[CERC2015] Export Estimate", "background": "Luka owns a geographic data company that maintains a detailed city map and exports the data to interested parties. Often, clients do not want the complete map. Instead, they want a simpliﬁed map containing only major streets. ", "description": "City map is an undirected graph consisting of n intersections denoted with integers from 1 to n and m two-way streets. Each street is assigned a priority – a non-negative integer. When requesting a map, the client selects a threshold priority p. The original map is then copied and converted to the exported map using the following procedure:\n\n1. All streets whose priority is lower than p are deleted. \n\n2. For each intersection i from 1,2,...,n (processed in that order): \n\n(a) If the intersection i is not connected to any streets it is deleted. \n\n(b) If the intersection i is connected to exactly two different streets x and y leading to intersections a and b both different from i then the intersection i is contracted using the following procedure: \n\ni. Streets x and y are deleted. \n\nii. Intersection i is deleted. \n\niii. New street z connecting intersections a and b is added.\n\n![](https://cdn.luogu.com.cn/upload/pic/16236.png )\n\nInitially, the map does not contain loops (loop is a street that connects an intersection to itself) or parallel edges (more than one street between the same pair of intersections), but the loops and parallel edges may form during the contraction procedure. Notice that, in the step 2. (b) above, neither x nor y can be a loop (both a and b have to be different from i), but the newly added street z could be a loop (it is possible that a and b are same). \n\nGiven a map and a sequence of incoming export requests, for each request ﬁnd the number of intersections and the number of streets in the exported map.", "inputFormat": "The ﬁrst line contains two integers n (1 ≤ n ≤ 300000) and m (1 ≤ m ≤ 300000) – the number of intersections and the number of streets, respectively. Each of the following m lines contains three integers a, b and p (1≤ a,b≤n,0≤ p≤300000) which describe a street with priority p connecting intersections a and b. No street connects an intersection to itself. There is at most one street between every two intersections. \n\nThe following line contains an integer q (1 ≤ q ≤ 300000) – the number of export requests. The following line contains q integers. The k-th integer tk (0≤tk ≤300000) is the threshold priority of the k-th request.", "outputFormat": "Output should consist of q lines. The k-th line should contain two integers–the number of intersections and the number of streets, respectively, in the exported map for the k-th request.", "hint": "Central Europe Regional Contest 2015 Problem E", "locale": "en"}, "zh-CN": {"title": "[CERC2015] Export Estimate", "background": "Luka 经营一家地理数据公司，负责维护详细的城市地图，并将数据导出给有需求的客户。通常客户不需要完整地图，而是希望获得仅包含主要街道的简化地图。", "description": "城市地图是一个无向图，包含编号 $1$ 到 $n$ 的 $n$ 个交叉路口和 $m$ 条双向街道。每条街道都有一个非负整数的优先级。当客户请求地图时，会指定一个优先级阈值 $p$。原始地图会经过以下处理流程生成导出地图：\n\n1. 所有优先级小于 $p$ 的街道被删除；  \n2. 按顺序处理每个交叉路口 $i$（从 $1$ 到 $n$ 依次处理）：\n\n   (a) 如果这个路口没有连接到任何街道，它就会被删除。\n\n   (b) 如果路口 $i$ 恰好连接两条不同街道 $x$ 和 $y$（分别通向不同于 $i$ 的路口 $a$ 和 $b$），则按以下步骤进行收缩：\n\n   i.删除道路 $x$ 和道路 $y$；\n\n   ii.删除路口 $i$；\n\n   iii.加入一条连接路口 $a$ 和 $b$ 的新道路 $z$；\n\n![](https://cdn.luogu.com.cn/upload/pic/16236.png)\n\n最初，图中没有环（即一条连接到自身的边）或者平行的边（即在同一对交点之间有一条以上的边），但在收缩的过程中可能会形成环和平行边。\n\n请注意，在步骤 2.(b) 之前，$x$ 和 $y$ 都不能是环（即 $a$ 和 $b$ 必须和 $i$ 不同），但是新增的 $z$ 可以是一个环（即 $a$ 和 $b$ 可能是相同的）。\n\n给定地图和一系列导出请求，对每个请求计算导出地图中的路口数量和街道数量。", "inputFormat": "第一行包含两个整数 $n(1 \\le n\\le3\\times10^5)$ 和 $m(1\\le m\\le 3\\times10^5)$ 分别是点和边的数量。\n\n后面 $m$ 行包含三个整数分别是 $a,b$ 和 $p(1\\le a,b \\le n,0\\le p\\le 3\\times10^5)$ 用来描述 $a,b$ 之间边的优先级 $p$，没有一条边只连接一个点，两个点之间最多有一条边。\n\n第 $m+2$ 行包含一个整数 $q(1\\le q\\le 3\\times10^5)$ 表示询问的个数，下一行有 $q$ 个整数，第 $k$ 个整数 $t_k(0\\le t_k\\le 3\\times10^5)$ 是第 $k$ 次询问的优先级。", "outputFormat": "输出包括 $q$ 行。第 $k$ 行包含两个整数，分别是第 $k$ 次询问的点和边的个数。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P4351", "type": "P", "difficulty": 6, "samples": [["3 0 0 0 \n0 0 2 \n0 3 0", "0"], ["4 3 5 2 \n7 1 4 3 \n7 4 4 8", "41817"]], "limits": {"time": [10000, 10000, 10000, 10000, 10000], "memory": [512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "2015", "组合数学", "ICPC", "CERC"], "title": "[CERC2015] Frightful Formula", "background": "", "description": "A frightful matrix is a square matrix of order n where the ﬁrst row and the ﬁrst column are explicitly speciﬁed, while the other elements are calculated using a frightful formula which is, actually, a simple recursive rule. \n\nGiven two integer sequences l and t,both of size n,as well as integer parameters a,b and c,the frightful matrix F is deﬁned as follows:\n\n* The ﬁrst column of the matrix is the sequence l: \n\n$$F[k, 1] = lk$$ \n\n* The ﬁrst row of the matrix is the sequence t: \n\n$$F[1, k] = tk$$ \n\n* Other elements are calculated using a recursive formula: \n\n$$F[i,j]=a*F[i,j-1]+b*F[i-1,j]+c$$\n\nGiven a frightful matrix, ﬁnd the value of the element $F[n,n]$ modulo $10^6 +3$.", "inputFormat": "The ﬁrst line contains four integers n, a, b and c (2≤n≤200000, 0≤ a, b, c≤$10^6$) – the size of the matrix and the recursion parameters, as described in the problem statement. \n\nThe two following lines contain integers l1,...,ln and t1,...,tn, respectively (l1 = t1, 0≤lk, tk ≤106). ", "outputFormat": "Output a single integer – the value of $F[n,n]$ modulo $10^6 +3$.", "hint": "Central Europe Regional Contest 2015 Problem F", "locale": "en", "translations": {"en": {"title": "[CERC2015] Frightful Formula", "background": "", "description": "A frightful matrix is a square matrix of order n where the ﬁrst row and the ﬁrst column are explicitly speciﬁed, while the other elements are calculated using a frightful formula which is, actually, a simple recursive rule. \n\nGiven two integer sequences l and t,both of size n,as well as integer parameters a,b and c,the frightful matrix F is deﬁned as follows:\n\n* The ﬁrst column of the matrix is the sequence l: \n\n$$F[k, 1] = lk$$ \n\n* The ﬁrst row of the matrix is the sequence t: \n\n$$F[1, k] = tk$$ \n\n* Other elements are calculated using a recursive formula: \n\n$$F[i,j]=a*F[i,j-1]+b*F[i-1,j]+c$$\n\nGiven a frightful matrix, ﬁnd the value of the element $F[n,n]$ modulo $10^6 +3$.", "inputFormat": "The ﬁrst line contains four integers n, a, b and c (2≤n≤200000, 0≤ a, b, c≤$10^6$) – the size of the matrix and the recursion parameters, as described in the problem statement. \n\nThe two following lines contain integers l1,...,ln and t1,...,tn, respectively (l1 = t1, 0≤lk, tk ≤106). ", "outputFormat": "Output a single integer – the value of $F[n,n]$ modulo $10^6 +3$.", "hint": "Central Europe Regional Contest 2015 Problem F", "locale": "en"}, "zh-CN": {"title": "[CERC2015] Frightful Formula", "background": null, "description": "定义一个矩阵 $F$，其中第一行和第一列是给定的，计算矩阵方法如下：\n\n- 矩阵的第一列是序列  $l$：\n\n$$F_{k,1}=l _ k$$\n\n- 矩阵的第一行是序列  $t$：\n\n$$F_{1,k}=t _ k$$\n\n- 其他元素使用给定的递归公式进行计算：\n\n$$\nF_{i,j}=a \\times F_{i,j-1}+b \\times F_{i-1,j}+c\n$$\n\n现在要求找求出 $F_{n,n}$ 模 $10^6+3$ 的值。", "inputFormat": "第一行包含四个整数 $n$，$a$，$b$ 和 $c(2 \\le n \\le 2 \\times 10^5,0 \\le a,b$，$c \\le 10^6)$ 矩阵的大小和递归参数，如问题描述中所述。\n\n下面两行分别包含整数 $l_1, \\cdots ,l_n$ 和 $t_1, \\cdots ,t_n(l_1=t_1,0 \\le l_k,t_k \\le 10^6)$。", "outputFormat": "输出一个整数的值即 $F_{n,n}$ 模 $10^6+3$。\n\n感谢 @ 守望提供的翻译。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P4352", "type": "P", "difficulty": 7, "samples": [["6 5 \n4 3 5 3 6 6 \nBABAA\n", "5 5 6 6 6 6"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "ICPC", "CERC"], "title": "[CERC2015] Greenhouse Growth", "background": "", "description": "You are switching from computer science to agriculture and your new job involves growing sunflowers in an underground greenhouse. The greenhouse contains n sunflower plants arranged in a straight line and numbered with integers 1 through n, from left to right. Two lamps provide the light and heat the sunflowers need to grow: the lamp A is positioned at the left end, while the lamp B is positioned at the right end of the line. \n\nEvery day exactly one of the lamps is on, causing all of the sunflowers to turn towards the light and some of them to grow. The sunflower will grow if and only if the sunflower directly in front of it (towards the light) is higher. The growth is continuous with a uniform rate of exactly 1 centimeter per day. Notice that, when a sunflower starts to grow, it may cause the sunflower directly behind it to start to grow instantaneously.\n\n![](https://cdn.luogu.com.cn/upload/pic/16238.png )\n\nYou are given initial heights of the sunflowers and the lamp schedule for the following m day period, ﬁnd the ﬁnal heights of all the sunflowers.", "inputFormat": "The first line contains two integers n and m (1≤n, m≤300000) – the number of sunflowers and the number of days in the period. The following line contains n integers h1,h2,...,hn (1≤ hk ≤$10^9$) – the initial heights (in centimeters) of the sunflowers, from left to right. \n\nThe following line contains a string consisting of exactly m characters A or B – the lamp schedule starting from thefirst day of the period.", "outputFormat": "Output a single line containing n integers – the final heights of the suflowers, from left to right.\n", "hint": "Central Europe Regional Contest 2015 Problem G", "locale": "en", "translations": {"en": {"title": "[CERC2015] Greenhouse Growth", "background": "", "description": "You are switching from computer science to agriculture and your new job involves growing sunflowers in an underground greenhouse. The greenhouse contains n sunflower plants arranged in a straight line and numbered with integers 1 through n, from left to right. Two lamps provide the light and heat the sunflowers need to grow: the lamp A is positioned at the left end, while the lamp B is positioned at the right end of the line. \n\nEvery day exactly one of the lamps is on, causing all of the sunflowers to turn towards the light and some of them to grow. The sunflower will grow if and only if the sunflower directly in front of it (towards the light) is higher. The growth is continuous with a uniform rate of exactly 1 centimeter per day. Notice that, when a sunflower starts to grow, it may cause the sunflower directly behind it to start to grow instantaneously.\n\n![](https://cdn.luogu.com.cn/upload/pic/16238.png )\n\nYou are given initial heights of the sunflowers and the lamp schedule for the following m day period, ﬁnd the ﬁnal heights of all the sunflowers.", "inputFormat": "The first line contains two integers n and m (1≤n, m≤300000) – the number of sunflowers and the number of days in the period. The following line contains n integers h1,h2,...,hn (1≤ hk ≤$10^9$) – the initial heights (in centimeters) of the sunflowers, from left to right. \n\nThe following line contains a string consisting of exactly m characters A or B – the lamp schedule starting from thefirst day of the period.", "outputFormat": "Output a single line containing n integers – the final heights of the suflowers, from left to right.\n", "hint": "Central Europe Regional Contest 2015 Problem G", "locale": "en"}, "zh-CN": {"title": "[CERC2015] Greenhouse Growth", "background": "", "description": "你正在从计算机科学转向农业，你的新工作涉及在地下温室中种植向日葵。温室中有 n 株向日葵，按从左到右的顺序排列并编号为 1 到 n。两盏灯为向日葵提供生长所需的光和热：灯 A 位于左端，而灯 B 位于右端。\n\n每天，只有一盏灯亮着，导致所有向日葵都朝向光源，并且其中一些会生长。向日葵只有在其正前方（朝向光源）的向日葵比它高时才会生长。生长是连续的，速率为每天正好 1 厘米。注意，当一株向日葵开始生长时，它可能会立即导致其正后方的向日葵开始生长。\n\n你被给定了向日葵的初始高度和接下来 m 天的灯光计划，找出所有向日葵的最终高度。", "inputFormat": "第一行包含两个整数 n 和 m (1≤n, m≤300000)——向日葵的数量和周期内的天数。接下来的一行包含 n 个整数 h1, h2, ..., hn (1≤ hk ≤$10^9$)——从左到右的向日葵的初始高度（以厘米为单位）。\n\n接下来的一行包含一个由恰好 m 个字符 A 或 B 组成的字符串——从周期的第一天开始的灯光计划。", "outputFormat": "输出一行包含 n 个整数——从左到右的向日葵的最终高度。", "hint": "Central Europe Regional Contest 2015 Problem G。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P4353", "type": "P", "difficulty": 6, "samples": [["-2.5 -1.5 \n2.5 -1.5 \n2.5 3.5 \n-2.5 3.5", "10.6854838710"], ["3 0 \n0 4 \n-4 1 \n-1 -3", "10.1226478495"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "Special Judge", "ICPC", "CERC"], "title": "[CERC2015] Hovering Hornet", "background": "", "description": "You have managed to trap a hornet inside a box lying on the top of your dining table. Unfortunately, your playing dice is also trapped inside – you cannot retrieve it and continue your game of Monopoly without risking the hornet’s wrath. Instead, you pass your time calculating the expected number of spots on the dice visible to the hornet. \n\nThe hornet, the dice and the box are located in the standard three-dimensional coordinate system with the x coordinate growing eastwards, the y coordinate growing northwards and the z coordinate growing upwards. The surface of the table corresponds to the x-y plane.\n\n![](https://cdn.luogu.com.cn/upload/pic/16240.png )\n\nThe dice is a 1×1×1 cube, resting on the table with the center of the bottom side exactly in the origin. Hence,the coordinates of its two opposite cornersare (−0.5, −0.5, 0) and (0.5, 0.5, 1). The top side of  the dice has 5 spots, the south side 1 spot, the east side 3 spots, the north side 6 spots, the west side 4 spots and the (invisible and irrelevant) bottom side 2 spots. \n\nThe box is a 5×5×5 cube also resting on the table with the dice in its interior. The box is speciﬁed by giving the coordinates of its bottom side – a 5×5 square. \n\nAssume the hornet is hovering at a uniformly random point in the (continuous) space inside the box not occupied by the dice. Calculate the expected number of spots visible by the hornet. The dice is opaque and, hence, the hornet sees a spot only if the segment connecting the center of the spot and the location of the hornet does not intersect the interior of the dice.", "inputFormat": "Input consists of 4 lines. The k-th line contains two ﬂoating-point numbers xk and yk (−5≤ xk, yk ≤5) –coordinates of the k-th corner of the bottom side of the box in the x-y plane. The coordinates are given in the counterclockwise direction and they describe a square with the side length of exactly 5. \n\nThe box fully contains the dice. The surfaces of the box and the dice do not intersect or touch except along the bottom sides.", "outputFormat": "Output a single ﬂoating point number – the expected number of spots visible. The solution will be accepted if the absolute or the relative difference from the judges solution is less than $10^{−6}$.", "hint": "Central Europe Regional Contest 2015 Problem H", "locale": "en", "translations": {"en": {"title": "[CERC2015] Hovering Hornet", "background": "", "description": "You have managed to trap a hornet inside a box lying on the top of your dining table. Unfortunately, your playing dice is also trapped inside – you cannot retrieve it and continue your game of Monopoly without risking the hornet’s wrath. Instead, you pass your time calculating the expected number of spots on the dice visible to the hornet. \n\nThe hornet, the dice and the box are located in the standard three-dimensional coordinate system with the x coordinate growing eastwards, the y coordinate growing northwards and the z coordinate growing upwards. The surface of the table corresponds to the x-y plane.\n\n![](https://cdn.luogu.com.cn/upload/pic/16240.png )\n\nThe dice is a 1×1×1 cube, resting on the table with the center of the bottom side exactly in the origin. Hence,the coordinates of its two opposite cornersare (−0.5, −0.5, 0) and (0.5, 0.5, 1). The top side of  the dice has 5 spots, the south side 1 spot, the east side 3 spots, the north side 6 spots, the west side 4 spots and the (invisible and irrelevant) bottom side 2 spots. \n\nThe box is a 5×5×5 cube also resting on the table with the dice in its interior. The box is speciﬁed by giving the coordinates of its bottom side – a 5×5 square. \n\nAssume the hornet is hovering at a uniformly random point in the (continuous) space inside the box not occupied by the dice. Calculate the expected number of spots visible by the hornet. The dice is opaque and, hence, the hornet sees a spot only if the segment connecting the center of the spot and the location of the hornet does not intersect the interior of the dice.", "inputFormat": "Input consists of 4 lines. The k-th line contains two ﬂoating-point numbers xk and yk (−5≤ xk, yk ≤5) –coordinates of the k-th corner of the bottom side of the box in the x-y plane. The coordinates are given in the counterclockwise direction and they describe a square with the side length of exactly 5. \n\nThe box fully contains the dice. The surfaces of the box and the dice do not intersect or touch except along the bottom sides.", "outputFormat": "Output a single ﬂoating point number – the expected number of spots visible. The solution will be accepted if the absolute or the relative difference from the judges solution is less than $10^{−6}$.", "hint": "Central Europe Regional Contest 2015 Problem H", "locale": "en"}, "zh-CN": {"title": "[CERC2015] Hovering Hornet", "background": "", "description": "你把一只蜜蜂困在你餐桌上的一个盒子里。但是，你玩的骰子也被困在里面（你无法取回它）不过，你通过计算蜜蜂可以看到的骰子上的预期点数来消磨时间。\n\n蜜蜂、骰子和盒子位于一个三维坐标系中，x-y轴如图\n\n骰子是一个1×1×1的立方体，放在桌子上，底部的中心为原点。因此，其两个相对角的坐标为(−0.5, −0.5,0）和（0.5,0.5,1）。骰子顶部有5个点，南侧1个点，东侧3个点，北侧6个点，西侧4个点，底部2个点（不可见和不相关）。\n\n盒子是一个5×5×5的立方体，也放在桌子上，里面有骰子。该框通过给出其底部的坐标（一个5×5的正方形）来指定。\n\n假设蜜蜂在盒子内没有骰子的（连续）空间中的一个均匀随机点上盘旋。计算蜜蜂可以看到的点数的数量。骰子是不透明的，因此，只有当连接点数中心和蜜蜂位置的部分不与骰子内部相交时，蜜蜂才能看到斑点。", "inputFormat": "输入由4行组成。第k行包含两个浮点数xk和yk(−5<=xk，yk<=5）x-y平面中长方体底部第k个角的坐标。坐标以逆时针方向给出，它们描述了边长正好为5的正方形。\n盒子和骰子的表面不相交或接触，除非放在底部。", "outputFormat": "输出一个数——预期可见点数\n（样例如下）", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4354", "type": "P", "difficulty": 6, "samples": [["5 \n4 2 0.6 \n7 3 0.7 \n8 5 0.8 \n1 3 0.7 \n3 4 0.4 \n2 \n3 1 9 6 \n3 4 7 2", "2\n1"]], "limits": {"time": [10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "ICPC", "CERC"], "title": "[CERC2015] Ice Igloos", "background": "", "description": "A ﬁshing village built on the surface of a frozen lake far north in the arctic is endangered by global warming-fractures are starting to form on the lake surface. The village consists of n igloos of spherical shape, each occupying a circular area of the surface. \n\nAn igloo can be represented as a circle in the coordinate plane: the center of the circle is a point with integer coordinates, while the radius is a positive ﬂoating-point number less than 1 with exactly one fractional digit. \n\nGiven the locations of possible ice fractures, the villagers would like to know how many igloos are affected by each. Formally, given q queries where each query is a straight line segment deﬁned by the two endpoints, ﬁnd the number of igloos each segment intersects. A segment intersects an igloo if it has at least one point in common with the interior of the circle.", "inputFormat": "The ﬁrst line contains an integer n (1≤n≤100000) - the number of igloos. Each of the following n lines contains three numbers x, y and r – the coordinates of the center and the radius of one igloo. The coordinates x and y are integers such that 1≤ x, y≤500, while r is a ﬂoating-point number with exactly one fractional digit such that 0 < r < 1. No two igloos will intersect or touch. \n\nThe following line contains an integer q (1 ≤ q ≤ 100000) - the number of queries. Each of the following q linescontainsfourintegers x1, y1, x2, y2 (1≤ x1, y1, x2, y2 ≤500)-thecoordinatesofthe two endpoints of the segment. The two endpoints will be different. Endpoints may be inside igloos. \n\nYou may assume that, for every igloo i and the segment s, the square of the distance between s and the center of i is either less than r2−10−5 or greater than r2 +10−5 where r is the radius of the igloo i. ", "outputFormat": "Output should consist of q lines. The k-th line should contain a single integer – the number of igloos that are intersected by the k-th segment.", "hint": "![](https://cdn.luogu.com.cn/upload/pic/16243.png )\n\nCentral Europe Regional Contest 2015 Problem I", "locale": "en", "translations": {"en": {"title": "[CERC2015] Ice Igloos", "background": "", "description": "A ﬁshing village built on the surface of a frozen lake far north in the arctic is endangered by global warming-fractures are starting to form on the lake surface. The village consists of n igloos of spherical shape, each occupying a circular area of the surface. \n\nAn igloo can be represented as a circle in the coordinate plane: the center of the circle is a point with integer coordinates, while the radius is a positive ﬂoating-point number less than 1 with exactly one fractional digit. \n\nGiven the locations of possible ice fractures, the villagers would like to know how many igloos are affected by each. Formally, given q queries where each query is a straight line segment deﬁned by the two endpoints, ﬁnd the number of igloos each segment intersects. A segment intersects an igloo if it has at least one point in common with the interior of the circle.", "inputFormat": "The ﬁrst line contains an integer n (1≤n≤100000) - the number of igloos. Each of the following n lines contains three numbers x, y and r – the coordinates of the center and the radius of one igloo. The coordinates x and y are integers such that 1≤ x, y≤500, while r is a ﬂoating-point number with exactly one fractional digit such that 0 < r < 1. No two igloos will intersect or touch. \n\nThe following line contains an integer q (1 ≤ q ≤ 100000) - the number of queries. Each of the following q linescontainsfourintegers x1, y1, x2, y2 (1≤ x1, y1, x2, y2 ≤500)-thecoordinatesofthe two endpoints of the segment. The two endpoints will be different. Endpoints may be inside igloos. \n\nYou may assume that, for every igloo i and the segment s, the square of the distance between s and the center of i is either less than r2−10−5 or greater than r2 +10−5 where r is the radius of the igloo i. ", "outputFormat": "Output should consist of q lines. The k-th line should contain a single integer – the number of igloos that are intersected by the k-th segment.", "hint": "![](https://cdn.luogu.com.cn/upload/pic/16243.png )\n\nCentral Europe Regional Contest 2015 Problem I", "locale": "en"}, "zh-CN": {"title": "[CERC2015] Ice Igloos", "background": "", "description": "给你$n$个圆$,m$条线段$,$求每条线段与多少圆相交\n\n$n,m\\le10^5,1\\le x_i,y_i\\le500,0\\lt r_i\\lt 1$", "inputFormat": "第一行一个整数$n$表示圆的个数\n\n接下来$n$行每行两个整数$x,y$和一个实数$r$表示圆心坐标和半径\n\n第$n+2$行一个整数$m$表示线段个数\n\n接下来$m$行每行四个整数$x1,y1,x2,y2$表示线段的两个端点$(x1,y1),(x2,y2)$", "outputFormat": "$m$行每行一个整数表示该条线段和多少圆相交\n\n\n感谢@Kelin 提供的翻译", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4355", "type": "P", "difficulty": 3, "samples": [["4 \n5 6 7 7 \n1 3 2 3", "1 2 4 8"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "Special Judge", "ICPC", "CERC"], "title": "[CERC2015] Kernel Knights", "background": "", "description": "Jousting is a medieval contest that involves people on horseback trying to strike each other with wooden lances while riding at high speed. A total of 2n knights have entered a jousting tournament – n knights from each of the two great rival houses. Upon arrival, each knight has challenged a single knight from the other house to a duel. \n\nA kernel is deﬁned as some subset S of knights with the following two properties:\n\n• No knight in S was challenged by another knight in S. \n\n• Every knight not in S was challenged by some knight in S.\n\nGiven the set of the challenges issued, ﬁnd one kernel. It is guaranteed that a kernel always exists.", "inputFormat": "The ﬁrst line contains an integer n (1 ≤ n ≤ 100000) – the number of knights of each house. The knights from the ﬁrst house are denoted with integers 1 through n, knights from the second house with integers n+1 through 2n. \n\nThe following line contains integers $f_1$, $f_2$,..., $f_n$ – the k-th integer fk is the index of the knight challenged by knight k $(n+1≤ f_k ≤2n)$. \n\nThe following line contains integers $s_1$,$s_2$,...,$s_n$ – the k-th integer sk is the index of the knight challenged by knight n+k $(1≤s_k ≤n)$. ", "outputFormat": "Output the indices of the knights in the kernel on a single line. If there is more than one solution, you may output any one.\n\nSPJ的格式校验较为严格，请在每个数字后面都输出一个空格，且在最后一个空格输出后请不要输出任何符号。", "hint": "Central Europe Regional Contest 2015 Problem K\n\n", "locale": "en", "translations": {"en": {"title": "[CERC2015] Kernel Knights", "background": "", "description": "Jousting is a medieval contest that involves people on horseback trying to strike each other with wooden lances while riding at high speed. A total of 2n knights have entered a jousting tournament – n knights from each of the two great rival houses. Upon arrival, each knight has challenged a single knight from the other house to a duel. \n\nA kernel is deﬁned as some subset S of knights with the following two properties:\n\n• No knight in S was challenged by another knight in S. \n\n• Every knight not in S was challenged by some knight in S.\n\nGiven the set of the challenges issued, ﬁnd one kernel. It is guaranteed that a kernel always exists.", "inputFormat": "The ﬁrst line contains an integer n (1 ≤ n ≤ 100000) – the number of knights of each house. The knights from the ﬁrst house are denoted with integers 1 through n, knights from the second house with integers n+1 through 2n. \n\nThe following line contains integers $f_1$, $f_2$,..., $f_n$ – the k-th integer fk is the index of the knight challenged by knight k $(n+1≤ f_k ≤2n)$. \n\nThe following line contains integers $s_1$,$s_2$,...,$s_n$ – the k-th integer sk is the index of the knight challenged by knight n+k $(1≤s_k ≤n)$. ", "outputFormat": "Output the indices of the knights in the kernel on a single line. If there is more than one solution, you may output any one.\n\nSPJ的格式校验较为严格，请在每个数字后面都输出一个空格，且在最后一个空格输出后请不要输出任何符号。", "hint": "Central Europe Regional Contest 2015 Problem K\n\n", "locale": "en"}, "zh-CN": {"title": "[CERC2015] Kernel Knights", "background": "", "description": "马上长矛比武是一种中世纪的比赛，参赛者骑在马上，用木制长矛高速冲刺，试图击中对方。共有 2n 名骑士参加了马上长矛比武比赛——来自两个伟大敌对家族的 n 名骑士。到达后，每位骑士向另一家族的一名骑士发起了挑战。\n\n一个“核”被定义为骑士的某个子集 S，具有以下两个特性：\n\n- S 中没有骑士被 S 中的其他骑士挑战。\n- 不在 S 中的每个骑士都被 S 中的某个骑士挑战。\n\n给定发出的挑战集，找到一个“核”。保证“核”总是存在。", "inputFormat": "第一行包含一个整数 n (1 ≤ n ≤ 100000)——每个家族的骑士数量。第一个家族的骑士用整数 1 到 n 表示，第二个家族的骑士用整数 n+1 到 2n 表示。\n\n接下来的行包含整数 $f_1$, $f_2$,..., $f_n$——第 k 个整数 $f_k$ 是骑士 k 挑战的骑士的编号 $(n+1 ≤ f_k ≤ 2n)$。\n\n接下来的行包含整数 $s_1$,$s_2$,...,$s_n$——第 k 个整数 $s_k$ 是骑士 n+k 挑战的骑士的编号 $(1 ≤ s_k ≤ n)$。", "outputFormat": "在一行中输出“核”中的骑士编号。如果有多个解，你可以输出其中任何一个。\n\nSPJ 的格式校验较为严格，请在每个数字后面都输出一个空格，且在最后一个空格输出后请不要输出任何符号。", "hint": "Central Europe Regional Contest 2015 Problem K。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P4356", "type": "P", "difficulty": 7, "samples": [["6 9 \n..#####.. \n..#...#.. \n......#.. \n..#####.. \n..#...... \n..#...#.. \n5 \n1 4 \n5 4 \n1 -5 \n5 -5 \n-1000000000 0", "yes \nno \nno \nyes \nyes"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "ICPC", "CERC"], "title": "[CERC2015] Looping Labyrinth", "background": "", "description": "A labyrinth is obtained by tiling the entire plane with a pattern – a rectangular grid consisting of n rows and m columns where every cell is either empty or blocked. The result is an inﬁnite grid of cells with the pattern repeating in all four directions. \n\nFormally, suppose we denote both rows and columns of the inﬁnite grid with integers (including the negative integers). The row number increases as we move downwards in the grid, while the column number increases as we go to the right. The cell at coordinates (0,0) is called the origin. The labyrinth is obtained by copying the pattern (without mirroring or rotation) to every n-by-m rectangular area that, in the upper-left corner, has a cell with the row number divisible by n and the column number divisible by m. In particular, the upper-left corner of the pattern gets copied to the origin, while the lower-right corner gets copied to the cell with coordinates (n−1,m−1). \n\nTo escape the labyrinth starting from a particular cell, we need to reach the origin via a sequence of empty cells, going up, down, left or right in each step. \n\nYou are given a pattern and a sequence of possible starting cells. For each starting cell determine if it is possible to escape the labyrinth.", "inputFormat": "The ﬁrst line contains two integers n and m (1≤n, m≤100)–the number of rows and columns in the pattern, respectively. Each of the following n lines contains a string of exactly m characters describing one row of the pattern. The character # denotes a blocked cell while the dot character denotes an empty cell. The following line contains an integer q (1≤q≤200,000) – the number of starting cells. The k-th of the following q lines contains two integers r and c ($−10^9$ ≤ r, c ≤ $10^9$) – the row and column of the k-th starting cell. \n\nThe origin and all starting cells will be empty.\n", "outputFormat": "Output should consist of q lines. The k-th line should contain the word yes if it is possible to exit the labyrinth from the k-th starting cell and the word no otherwise.\n", "hint": "![](https://cdn.luogu.com.cn/upload/pic/16244.png )\n\nCentral Europe Regional Contest 2015 Problem L", "locale": "en", "translations": {"en": {"title": "[CERC2015] Looping Labyrinth", "background": "", "description": "A labyrinth is obtained by tiling the entire plane with a pattern – a rectangular grid consisting of n rows and m columns where every cell is either empty or blocked. The result is an inﬁnite grid of cells with the pattern repeating in all four directions. \n\nFormally, suppose we denote both rows and columns of the inﬁnite grid with integers (including the negative integers). The row number increases as we move downwards in the grid, while the column number increases as we go to the right. The cell at coordinates (0,0) is called the origin. The labyrinth is obtained by copying the pattern (without mirroring or rotation) to every n-by-m rectangular area that, in the upper-left corner, has a cell with the row number divisible by n and the column number divisible by m. In particular, the upper-left corner of the pattern gets copied to the origin, while the lower-right corner gets copied to the cell with coordinates (n−1,m−1). \n\nTo escape the labyrinth starting from a particular cell, we need to reach the origin via a sequence of empty cells, going up, down, left or right in each step. \n\nYou are given a pattern and a sequence of possible starting cells. For each starting cell determine if it is possible to escape the labyrinth.", "inputFormat": "The ﬁrst line contains two integers n and m (1≤n, m≤100)–the number of rows and columns in the pattern, respectively. Each of the following n lines contains a string of exactly m characters describing one row of the pattern. The character # denotes a blocked cell while the dot character denotes an empty cell. The following line contains an integer q (1≤q≤200,000) – the number of starting cells. The k-th of the following q lines contains two integers r and c ($−10^9$ ≤ r, c ≤ $10^9$) – the row and column of the k-th starting cell. \n\nThe origin and all starting cells will be empty.\n", "outputFormat": "Output should consist of q lines. The k-th line should contain the word yes if it is possible to exit the labyrinth from the k-th starting cell and the word no otherwise.\n", "hint": "![](https://cdn.luogu.com.cn/upload/pic/16244.png )\n\nCentral Europe Regional Contest 2015 Problem L", "locale": "en"}, "zh-CN": {"title": "[CERC2015] Looping Labyrinth", "background": "", "description": "一个$n×m$的矩形，其中每格为路或墙，通过将图案平移来获得迷宫。迷宫是一个大小有限的坐标系，其图案在四个方向上重复。\n\n用整数（包括负整数）表示横纵坐标。向下行数增加，向右列数增加，坐标$(0,0)$处称为原点。特别地，图案的左上角在原点，而右下角在坐标$(n-1,m-1)$。\n\n原点是出口，为了从开始逃离迷宫，我们要从不同的起点到达原点，每一步可向上，下，左或右。对于每个起点，确定是否可以逃离迷宫。", "inputFormat": "第一行包含两个整数$n$和$m$（$1≤n$，$m≤100$）。\n\n以下每一行包含$m$个字符。“#”表示墙，“.”表示路。\n以下的一行包含整数$q$（$1≤q≤200000$）表示起点的数量。\n\n以下$q$行每行包含两个整数$r$和$c$（$-10^9≤r$，$c≤10^9$），表示每个起点的坐标。\n\n保证原点和所有起点为路。", "outputFormat": "输出$q$行。如果可以从当前起点逃出迷宫，则每行输出$yes$，否则输出$no$。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4357", "type": "P", "difficulty": 6, "samples": [["10 5\n0 0\n0 1\n1 0\n1 1\n2 0\n2 1\n1 2\n0 2\n3 0\n3 1", "9"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2016", "重庆", "各省省选", "旋转卡壳"], "title": "[CQOI2016] K 远点对", "background": "", "description": "已知平面内 $N$ 个点的坐标，求欧氏距离下的第 $K$ 远点对。\n\n两个点 $P(x_1,y_1)$ 和 $Q(x_2,y_2)$ 的欧氏距离定义为 $\\sqrt{(x_1-x_2)^2+(y_1-y_2)^2}$", "inputFormat": "输入文件第一行为用空格隔开的两个整数 $N,K$ 。\n\n接下来 $N$ 行，每行两个整数 $X,Y$ ，表示一个点的坐标。", "outputFormat": "输出文件第一行为一个整数，表示第 $K$ 远点对的距离的平方（一定是个整数）。", "hint": "对于 $100\\%$ 的测试点，$N \\le 100000,1 \\le K \\le 100,K \\le \\dfrac {N(N-1)}{2},0 \\le X,Y < 2^{31}$", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2016] K-th Farthest Pair", "background": "", "description": "Given the coordinates of $N$ points in the plane, find the $K$-th farthest pair under the Euclidean distance.\n\nThe Euclidean distance between two points $P(x_1,y_1)$ and $Q(x_2,y_2)$ is defined as $\\sqrt{(x_1-x_2)^2+(y_1-y_2)^2}$.", "inputFormat": "The first line contains two integers $N,K$ separated by a space.\n\nThe next $N$ lines each contain two integers $X,Y$, representing the coordinates of a point.", "outputFormat": "Output a single integer on the first line, which is the square of the distance of the $K$-th farthest pair (it is guaranteed to be an integer).", "hint": "For $100\\%$ of the testdata, $N \\le 100000,1 \\le K \\le 100,K \\le \\dfrac {N(N-1)}{2},0 \\le X,Y < 2^{31}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2016] K 远点对", "background": "", "description": "已知平面内 $N$ 个点的坐标，求欧氏距离下的第 $K$ 远点对。\n\n两个点 $P(x_1,y_1)$ 和 $Q(x_2,y_2)$ 的欧氏距离定义为 $\\sqrt{(x_1-x_2)^2+(y_1-y_2)^2}$", "inputFormat": "输入文件第一行为用空格隔开的两个整数 $N,K$ 。\n\n接下来 $N$ 行，每行两个整数 $X,Y$ ，表示一个点的坐标。", "outputFormat": "输出文件第一行为一个整数，表示第 $K$ 远点对的距离的平方（一定是个整数）。", "hint": "对于 $100\\%$ 的测试点，$N \\le 100000,1 \\le K \\le 100,K \\le \\dfrac {N(N-1)}{2},0 \\le X,Y < 2^{31}$", "locale": "zh-CN"}}}
{"pid": "P4358", "type": "P", "difficulty": 6, "samples": [["3 187 45", "107 12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2016", "重庆", "各省省选", "递归", "素数判断,质数,筛法", "逆元"], "title": "[CQOI2016] 密钥破解", "background": "", "description": "一种非对称加密算法的密钥生成过程如下：\n\n1.任选两个不同的质数$p,q$\n\n2.计算$N=p \\times q$，$r=(p-1)(q-1)$\n\n3.选取小于$r$，且与$r$互质的整数$e$\n\n4.计算整数$d$，使得$ed≡1(mod r)$\n\n5.二元组$(N,e)$称为公钥，二元组$(N,d)$称为私钥。\n\n当需要加密消息$n$时，（假设$n$是一个小于$N$的整数，因为任何格式的消息都可转为整数表示），使用公钥$(N,e)$，按照\n\n$$n^e≡c(mod N)$$\n\n运算，可得到密文$c$\n\n对密文$c$解密时，用私钥$(N,d)$，按照\n\n$$c^d≡n(mod N)$$\n\n运算，可得到原文 $n$。算法正确性证明省略。\n\n由于用公钥加密的密文仅能用对应的私钥解密，而不能用公钥解密，因此称为非对称加密算法。通常情况下，公钥由消息的接收方公开，而私钥由消息的接收方自己持有。这样任何发送消息的人都可以用公钥对消息加密，而只有消息的接收方自己能够解密消息。\n\n现在，你的任务是寻找一种可行的方法来破解这种加密算法，即根据公钥破解出私钥，并据此解密密文。", "inputFormat": "输入文件内容只有一行，为空格分隔的三个正整数$e,N,c$。", "outputFormat": "输出文件内容只有一行，为空格分隔的两个整数$d,n$。", "hint": "对于$30\\%$的数据，$e,N,c \\le 2^{20}$；\n\n对于$100\\%$的数据，$e,N,c \\le 2^{62},c<N$", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2016] Key Recovery", "background": "", "description": "The key generation process of an asymmetric encryption algorithm is as follows:\n\n1. Choose two distinct prime numbers $p, q$.\n2. Compute $N=p \\times q$, $r=(p-1)(q-1)$.\n3. Select an integer $e$ that is less than $r$ and coprime with $r$.\n4. Compute an integer $d$ such that $ed≡1(mod r)$.\n5. The ordered pair $(N,e)$ is called the public key, and the ordered pair $(N,d)$ is called the private key.\n\nWhen encrypting a message $n$ (assume $n$ is an integer less than $N$, because any format of message can be converted to an integer), use the public key $(N,e)$ and compute\n$$n^e≡c(mod N)$$\nto obtain the ciphertext $c$.\n\nTo decrypt the ciphertext $c$, use the private key $(N,d)$ and compute\n$$c^d≡n(mod N)$$\nto obtain the original plaintext $n$. The proof of correctness is omitted.\n\nBecause ciphertext encrypted with the public key can only be decrypted with the corresponding private key, and not with the public key itself, this is called an asymmetric encryption algorithm. Typically, the public key is published by the message receiver, while the private key is kept by the receiver. In this way, anyone can encrypt messages using the public key, but only the receiver can decrypt them.\n\nNow your task is to find a feasible method to crack this encryption algorithm: derive the private key from the public key and then use it to decrypt the ciphertext.", "inputFormat": "The input contains a single line with three positive integers $e, N, c$ separated by spaces.", "outputFormat": "Output a single line with two integers $d, n$ separated by a space.", "hint": "- For $30\\%$ of the testdata, $e, N, c \\le 2^{20}$.\n- For $100\\%$ of the testdata, $e, N, c \\le 2^{62}, c < N$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2016] 密钥破解", "background": "", "description": "一种非对称加密算法的密钥生成过程如下：\n\n1.任选两个不同的质数$p,q$\n\n2.计算$N=p \\times q$，$r=(p-1)(q-1)$\n\n3.选取小于$r$，且与$r$互质的整数$e$\n\n4.计算整数$d$，使得$ed≡1(mod r)$\n\n5.二元组$(N,e)$称为公钥，二元组$(N,d)$称为私钥。\n\n当需要加密消息$n$时，（假设$n$是一个小于$N$的整数，因为任何格式的消息都可转为整数表示），使用公钥$(N,e)$，按照\n\n$$n^e≡c(mod N)$$\n\n运算，可得到密文$c$\n\n对密文$c$解密时，用私钥$(N,d)$，按照\n\n$$c^d≡n(mod N)$$\n\n运算，可得到原文 $n$。算法正确性证明省略。\n\n由于用公钥加密的密文仅能用对应的私钥解密，而不能用公钥解密，因此称为非对称加密算法。通常情况下，公钥由消息的接收方公开，而私钥由消息的接收方自己持有。这样任何发送消息的人都可以用公钥对消息加密，而只有消息的接收方自己能够解密消息。\n\n现在，你的任务是寻找一种可行的方法来破解这种加密算法，即根据公钥破解出私钥，并据此解密密文。", "inputFormat": "输入文件内容只有一行，为空格分隔的三个正整数$e,N,c$。", "outputFormat": "输出文件内容只有一行，为空格分隔的两个整数$d,n$。", "hint": "对于$30\\%$的数据，$e,N,c \\le 2^{20}$；\n\n对于$100\\%$的数据，$e,N,c \\le 2^{62},c<N$", "locale": "zh-CN"}}}
