{"pid": "P2476", "type": "P", "difficulty": 4, "samples": [["3\n1 2 3", "10"], ["5\n2 2 2 2 2", "39480"], ["10\n1 1 2 2 3 3 4 4 5 5\n", "85937576"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "搜索", "2008", "四川", "各省省选", "记忆化搜索"], "title": "[SCOI2008] 着色方案", "background": "", "description": "有 $n$ 个木块排成一行，从左到右依次编号为 $1$ 至 $n$。\n\n你有 $k$ 种颜色的油漆，第 $i$ 种颜色的油漆足够涂 $c_i$ 个木块。\n\n所有油漆刚好足够涂满所有木块，即 $\\sum_{i=1}^kc_i=n$。\n\n由于相邻两个木块涂相同色显得很难看，所以你希望统计任意两个相邻木块颜色不同的着色方案。\n\n由于答案可能很大，请输出对 $10^9+7$ 取模的结果。", "inputFormat": "第一行，一个整数 $k$，表示颜色数量。\n\n第二行 $k$ 个整数 $c_1,c_2,\\dots,c_k$，表示每种颜色能够涂木块的个数。", "outputFormat": "一行一个整数，表示答案对 $10^9+7$ 取模的结果。", "hint": "- 对于 $50\\%$ 的数据，$1 \\leq k \\leq 5$，$1 \\leq c_i \\leq 3$；\n- 对于 $100\\%$ 的数据，$1 \\leq k \\leq 15$，$1 \\leq c_i \\leq 5$。", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2008] Coloring Scheme", "background": "", "description": "There are $n$ wooden blocks arranged in a row, numbered from $1$ to $n$ from left to right.\n\nYou have $k$ colors of paint, and the $i$-th color is enough to paint $c_i$ blocks.\n\nAll the paint is just enough to cover all blocks, i.e., $\\sum_{i=1}^k c_i = n$.\n\nSince it looks bad if two adjacent blocks have the same color, you want to count the number of colorings in which any two adjacent blocks have different colors.\n\nSince the answer may be large, please output the result modulo $10^9+7$.", "inputFormat": "The first line contains an integer $k$, the number of colors.\n\nThe second line contains $k$ integers $c_1, c_2, \\dots, c_k$, where $c_i$ is the number of blocks that can be painted with the $i$-th color.", "outputFormat": "Output a single integer, the answer modulo $10^9+7$.", "hint": "- For 50% of the testdata, $1 \\leq k \\leq 5$, $1 \\leq c_i \\leq 3$.\n- For 100% of the testdata, $1 \\leq k \\leq 15$, $1 \\leq c_i \\leq 5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2008] 着色方案", "background": "", "description": "有 $n$ 个木块排成一行，从左到右依次编号为 $1$ 至 $n$。\n\n你有 $k$ 种颜色的油漆，第 $i$ 种颜色的油漆足够涂 $c_i$ 个木块。\n\n所有油漆刚好足够涂满所有木块，即 $\\sum_{i=1}^kc_i=n$。\n\n由于相邻两个木块涂相同色显得很难看，所以你希望统计任意两个相邻木块颜色不同的着色方案。\n\n由于答案可能很大，请输出对 $10^9+7$ 取模的结果。", "inputFormat": "第一行，一个整数 $k$，表示颜色数量。\n\n第二行 $k$ 个整数 $c_1,c_2,\\dots,c_k$，表示每种颜色能够涂木块的个数。", "outputFormat": "一行一个整数，表示答案对 $10^9+7$ 取模的结果。", "hint": "- 对于 $50\\%$ 的数据，$1 \\leq k \\leq 5$，$1 \\leq c_i \\leq 3$；\n- 对于 $100\\%$ 的数据，$1 \\leq k \\leq 15$，$1 \\leq c_i \\leq 5$。", "locale": "zh-CN"}}}
{"pid": "P2478", "type": "P", "difficulty": 6, "samples": [["9 9\n2 2 3 4 1 2 3 10 11\n1 2\n2 3\n1 3\n3 5\n5 4\n5 6\n4 7\n6 7\n8 9\n", "17"], ["5 5\n4 4 9 7 7\n1 2\n2 3\n1 4\n3 5\n5 4\n", "9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2010", "各省省选", "山东"], "title": "[SDOI2010] 城市规划", "background": "", "description": "小猪iPig来到了一个叫做pigsty的城市里，pigsty是一座专门为小猪所准备的城市，城市里面一共有n个小区给小猪们居住，并且存在许多条无向边连接着许多小区。因为这里是一个和谐的城市，所以小猪iPig准备在这个城市里面度过他的余生。\n\n若干年之后小猪iPig当上了规划局长，这件事令他非常开心。不过与此同时pigsty城市里面出现了许多反和谐主义者，他们已经厌烦了这样和谐的生活，在城市里到处闹事。小猪iPig为了更好地控制局面，他把城市改造成了另外一个样子：iPig把道路全部摧毁之后重新修建了m条无向边，并且保证每一个小区最多存在于一个由无向边组成的环中。\n\niPig以为这样做就让那些反和谐主义者不敢继续猖狂下去了，谁知到在新的城市道路修建好以后反和谐主义者宣言要对城市的小区进行一次洗脑！\n\n这下可麻烦了，iPig赶紧收集了许多的情报。iPig给每个小区标记了一个和谐值HX\\_i，用它来表示第i个小区的和谐程度。\n\n通过地下消息iPig又得知那些反和谐主义者进攻时有个规律：他们会选择若干个小区下手，这些小区都派一只猪过去，把这些小区的和谐值归零。在这个过程中，每个选择的小区所直接连接着的几个小区都派了一只猪去看守——以防被警猪给干扰。这个计划看似完美但是还是存在一个漏洞：因为人员之间都是在网络上认识的，互相没有见过面，为了防止不必要的麻烦（认错猪之类），每个小区最多只会有一头猪存在。\n\niPig突然感到了莫大的压力，他想知道在最坏情况下会丢失多少和谐值。但是不懂计算机的他不知道应该怎样计算。你能帮帮他吗？\n", "inputFormat": "输入第一行有两个整数n和m，表示pigsty城市里面有n个小区，在iPig修整城市后有m条无向边连接着n个小区。\n\n接下来一行有n个正整数，第i个正整数HX\\_i表示第i个小区的和谐值为HX\\_i。\n\n接下来m行，每行两个正整数a和b（1<=a,b<=n），表示存在一条连接着小区a和小区 b的无向边。\n", "outputFormat": "输出只有一行一个整数，表示最坏情况下损失的和谐值为多少。\n", "hint": "【样例解释】\n\n反和谐主义者选择的小区分别是小区3（看守的小区是小区1、小区2和小区5）、小区7（看守的小区是小区4和小区6）和小区9（看守的小区是小区8），这样会损失的总和谐值为3+3+11=17。\n\n或者选择的小区分别是小区1（看守的小区是小区2和小区3）、小区4（看守的小区是小区5和小区7）和小区9（看守的小区是小区8），这样会损失的总和谐值为2+4+11=17。\n\n如果同时选择小区3、小区4和小区9，虽然损失的总和谐值为18，但是小区3和小区4都要派猪来看守小区5，这不符合条件，故此方案不可行。\n\n\n【数据约定】\n\n对于20%的数据，保证每个点不存在于任何一个环中；\n\n对于另外30%的数据，保证图中只存在一个环；\n\n对于100%的数据，有N<=1000000，M<=2000000，所有的权值不超过1000。\n", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2010] Urban Planning", "background": "", "description": "Little pig iPig arrived in a city called pigsty. Pigsty is a city specially built for little pigs. There are a total of n communities for pigs to live in, and there are many undirected edges connecting these communities. Because this is a harmonious city, iPig plans to spend the rest of his life here.\n\nYears later, iPig became the head of the planning bureau, which made him very happy. However, at the same time, many anti-harmony activists appeared in pigsty. They are tired of such a harmonious life and are making trouble all over the city. To better control the situation, iPig transformed the city: after destroying all the roads, he rebuilt m undirected edges and ensured that each community belongs to at most one cycle formed by undirected edges.\n\niPig thought this would deter the anti-harmony activists. Unexpectedly, after the new city roads were completed, the activists declared they would “brainwash” the city’s communities!\n\nThis is troublesome. iPig hurriedly collected lots of intelligence. He assigned each community a harmony value HX_i, which represents the harmony level of the i-th community.\n\nThrough underground sources, iPig learned a pattern in the activists’ attacks: they will choose several communities to act on, sending one pig to each of these communities to set their harmony values to zero. During this process, each chosen community’s directly connected neighboring communities each send a pig to guard it—to prevent interference by police pigs. This plan seems perfect but still has a flaw: since everyone only knows each other online and has not met in person, to avoid unnecessary trouble (like mistaking one pig for another), at most one pig will be present in any community.\n\niPig suddenly feels great pressure. He wants to know how much harmony value could be lost in the worst case. But not knowing computer science, he does not know how to compute it. Can you help him?", "inputFormat": "The first line contains two integers n and m, indicating that the city pigsty has n communities, and after iPig’s reconstruction, there are m undirected edges connecting the n communities.\n\nThe next line contains n positive integers. The i-th integer HX_i indicates that the harmony value of the i-th community is HX_i.\n\nThen follow m lines. Each line contains two positive integers a and b ($1 \\le a, b \\le n$), indicating there is an undirected edge between community a and community b.", "outputFormat": "Output a single integer on one line, indicating the amount of harmony value lost in the worst case.", "hint": "[Sample Explanation]\n- The activists choose communities 3 (guarded by communities 1, 2, and 5), 7 (guarded by communities 4 and 6), and 9 (guarded by community 8). The lost harmony value is $3 + 3 + 11 = 17$.\n- Or they choose communities 1 (guarded by communities 2 and 3), 4 (guarded by communities 5 and 7), and 9 (guarded by community 8). The lost harmony value is $2 + 4 + 11 = 17$.\n- If they choose communities 3, 4, and 9 at the same time, although the lost harmony value would be $18$, both communities 3 and 4 would need to send pigs to guard community 5, which violates the condition that at most one pig can be present in any community. Therefore, this plan is invalid.\n\n[Constraints]\n- For 20% of the testdata, each node does not belong to any cycle.\n- For another 30% of the testdata, there is exactly one cycle in the graph.\n- For 100% of the testdata, $N \\le 1000000$, $M \\le 2000000$, and all weights are at most $1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2010] 城市规划", "background": "", "description": "小猪iPig来到了一个叫做pigsty的城市里，pigsty是一座专门为小猪所准备的城市，城市里面一共有n个小区给小猪们居住，并且存在许多条无向边连接着许多小区。因为这里是一个和谐的城市，所以小猪iPig准备在这个城市里面度过他的余生。\n\n若干年之后小猪iPig当上了规划局长，这件事令他非常开心。不过与此同时pigsty城市里面出现了许多反和谐主义者，他们已经厌烦了这样和谐的生活，在城市里到处闹事。小猪iPig为了更好地控制局面，他把城市改造成了另外一个样子：iPig把道路全部摧毁之后重新修建了m条无向边，并且保证每一个小区最多存在于一个由无向边组成的环中。\n\niPig以为这样做就让那些反和谐主义者不敢继续猖狂下去了，谁知到在新的城市道路修建好以后反和谐主义者宣言要对城市的小区进行一次洗脑！\n\n这下可麻烦了，iPig赶紧收集了许多的情报。iPig给每个小区标记了一个和谐值HX\\_i，用它来表示第i个小区的和谐程度。\n\n通过地下消息iPig又得知那些反和谐主义者进攻时有个规律：他们会选择若干个小区下手，这些小区都派一只猪过去，把这些小区的和谐值归零。在这个过程中，每个选择的小区所直接连接着的几个小区都派了一只猪去看守——以防被警猪给干扰。这个计划看似完美但是还是存在一个漏洞：因为人员之间都是在网络上认识的，互相没有见过面，为了防止不必要的麻烦（认错猪之类），每个小区最多只会有一头猪存在。\n\niPig突然感到了莫大的压力，他想知道在最坏情况下会丢失多少和谐值。但是不懂计算机的他不知道应该怎样计算。你能帮帮他吗？\n", "inputFormat": "输入第一行有两个整数n和m，表示pigsty城市里面有n个小区，在iPig修整城市后有m条无向边连接着n个小区。\n\n接下来一行有n个正整数，第i个正整数HX\\_i表示第i个小区的和谐值为HX\\_i。\n\n接下来m行，每行两个正整数a和b（1<=a,b<=n），表示存在一条连接着小区a和小区 b的无向边。\n", "outputFormat": "输出只有一行一个整数，表示最坏情况下损失的和谐值为多少。\n", "hint": "【样例解释】\n\n反和谐主义者选择的小区分别是小区3（看守的小区是小区1、小区2和小区5）、小区7（看守的小区是小区4和小区6）和小区9（看守的小区是小区8），这样会损失的总和谐值为3+3+11=17。\n\n或者选择的小区分别是小区1（看守的小区是小区2和小区3）、小区4（看守的小区是小区5和小区7）和小区9（看守的小区是小区8），这样会损失的总和谐值为2+4+11=17。\n\n如果同时选择小区3、小区4和小区9，虽然损失的总和谐值为18，但是小区3和小区4都要派猪来看守小区5，这不符合条件，故此方案不可行。\n\n\n【数据约定】\n\n对于20%的数据，保证每个点不存在于任何一个环中；\n\n对于另外30%的数据，保证图中只存在一个环；\n\n对于100%的数据，有N<=1000000，M<=2000000，所有的权值不超过1000。\n", "locale": "zh-CN"}}}
{"pid": "P2479", "type": "P", "difficulty": 6, "samples": [["4\n0 0\n1 0\n0 1\n1 1\n", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2010", "各省省选", "递归", "山东", "枚举"], "title": "[SDOI2010] 捉迷藏", "background": "iPig 在大肥猪学校刚上完了无聊的猪文课，天资聪慧的 iPig 被这门对他来说无比简单的课弄得非常寂寞，为了消除寂寞感，他决定和他的好朋友 giPi（鸡皮）玩一个更加寂寞的游戏——捉迷藏。但是，他们觉得，玩普通的捉迷藏没什么意思，还是不够寂寞，于是，他们决定玩寂寞无比的螃蟹版捉迷藏。\n", "description": "螃蟹版捉迷藏，顾名思义，就是说他们在玩游戏的时候只能沿水平或垂直方向走。\n\n一番寂寞的剪刀石头布后，他们决定 iPig 去捉 giPi。由于他们都很熟悉大肥猪学校的地形了，所以 giPi 只会躲在大肥猪学校内 $N$ 个隐秘地点之一，显然 iPig 也只会在那 $N$ 个地点内找 giPi。\n\n游戏一开始，他们从这 $N$ 个隐秘地点之中选定一个地点，iPig 保持不动，然后 giPi 用 $30$ 秒的时间逃离现场（显然，giPi 不会呆在原地）。然后 iPig 会随机地去找 giPi，直到找到为止。\n\n由于 iPig 很懒，所以他总是走最短的路径，而且，他选择起始点不是随便选的，他想找一个地点，使得该地点到（除了这个地点以外的）最远的地点和最近的地点的距离差最小。iPig现在想知道这个距离差最小是多少。\n\n由于 iPig 现在手上没有电脑，所以不能编程解决这个如此简单的问题，所以他马上打了个电话，要求你帮他解决这个问题。iPig 告诉了你大肥猪学校的 $N$ 个隐秘地点的坐标，请你编程求出 iPig 的问题。", "inputFormat": "\n第 $1$ 行：一个整数 $N$；\n\n接下来 $N$ 行：每行两个整数 $X_i,Y_i$，表示第 $i$ 个地点的坐标。", "outputFormat": "一个整数，为距离差的最小值。\n", "hint": "$30\\%$ 的数据中，$2\\le N\\le 10^3$；\n\n$100\\%$ 的数据中，$2\\le N\\le 10^5$，$0\\le X_i,Y_i\\le 10^9$。\n\n数据保证点不重合。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2010] Hide and Seek", "background": "iPig just finished a boring Pig Language class at the Big Fat Pig School. Being very bright, iPig felt extremely lonely because the class was too easy for him. To fight the loneliness, he decided to play an even lonelier game—hide-and-seek—with his good friend giPi (jī pí). However, they thought regular hide-and-seek was not lonely enough, so they chose to play an extremely lonely crab-style version of hide-and-seek.", "description": "Crab-style hide-and-seek, as the name suggests, means they can only move horizontally or vertically while playing.\n\nAfter a lonely round of rock-paper-scissors, they decided that iPig would seek giPi. Since they both know the layout of the Big Fat Pig School very well, giPi will only hide at one of $N$ hidden locations, and iPig will only search among those same $N$ locations.\n\nAt the start of the game, they choose one location from these $N$ hidden locations. iPig stays put, and giPi uses $30$ seconds to run away (clearly, giPi will not stay at the starting location). Then iPig will randomly search for giPi until he finds him.\n\nBecause iPig is lazy, he always walks along the shortest path. Moreover, he does not choose the starting location arbitrarily—he wants to find a location such that the difference between the distance to the farthest other location and the distance to the nearest other location (excluding the starting location itself) is minimized. iPig now wants to know what this minimum difference is.\n\nSince iPig does not have a computer at hand, he cannot program to solve such a simple problem. He immediately calls you and asks for help. iPig gives you the coordinates of the $N$ hidden locations in the Big Fat Pig School. Please write a program to answer iPig’s question.", "inputFormat": "Line $1$: An integer $N$.\n\nThe next $N$ lines: Each line contains two integers $X_i, Y_i$, representing the coordinates of the $i$-th location.", "outputFormat": "One integer, the minimum possible value of the distance difference.", "hint": "Constraints:\n- In $30\\%$ of the testdata, $2 \\le N \\le 10^3$.\n- In $100\\%$ of the testdata, $2 \\le N \\le 10^5$, $0 \\le X_i, Y_i \\le 10^9$.\n\nIt is guaranteed that all points are distinct.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2010] 捉迷藏", "background": "iPig 在大肥猪学校刚上完了无聊的猪文课，天资聪慧的 iPig 被这门对他来说无比简单的课弄得非常寂寞，为了消除寂寞感，他决定和他的好朋友 giPi（鸡皮）玩一个更加寂寞的游戏——捉迷藏。但是，他们觉得，玩普通的捉迷藏没什么意思，还是不够寂寞，于是，他们决定玩寂寞无比的螃蟹版捉迷藏。\n", "description": "螃蟹版捉迷藏，顾名思义，就是说他们在玩游戏的时候只能沿水平或垂直方向走。\n\n一番寂寞的剪刀石头布后，他们决定 iPig 去捉 giPi。由于他们都很熟悉大肥猪学校的地形了，所以 giPi 只会躲在大肥猪学校内 $N$ 个隐秘地点之一，显然 iPig 也只会在那 $N$ 个地点内找 giPi。\n\n游戏一开始，他们从这 $N$ 个隐秘地点之中选定一个地点，iPig 保持不动，然后 giPi 用 $30$ 秒的时间逃离现场（显然，giPi 不会呆在原地）。然后 iPig 会随机地去找 giPi，直到找到为止。\n\n由于 iPig 很懒，所以他总是走最短的路径，而且，他选择起始点不是随便选的，他想找一个地点，使得该地点到（除了这个地点以外的）最远的地点和最近的地点的距离差最小。iPig现在想知道这个距离差最小是多少。\n\n由于 iPig 现在手上没有电脑，所以不能编程解决这个如此简单的问题，所以他马上打了个电话，要求你帮他解决这个问题。iPig 告诉了你大肥猪学校的 $N$ 个隐秘地点的坐标，请你编程求出 iPig 的问题。", "inputFormat": "\n第 $1$ 行：一个整数 $N$；\n\n接下来 $N$ 行：每行两个整数 $X_i,Y_i$，表示第 $i$ 个地点的坐标。", "outputFormat": "一个整数，为距离差的最小值。\n", "hint": "$30\\%$ 的数据中，$2\\le N\\le 10^3$；\n\n$100\\%$ 的数据中，$2\\le N\\le 10^5$，$0\\le X_i,Y_i\\le 10^9$。\n\n数据保证点不重合。", "locale": "zh-CN"}}}
{"pid": "P2480", "type": "P", "difficulty": 6, "samples": [["4 2", "2048"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2010", "各省省选", "山东", "O2优化", "素数判断,质数,筛法", "中国剩余定理 CRT", "Lucas 定理"], "title": "[SDOI2010] 古代猪文", "background": "“在那山的那边海的那边有一群小肥猪。他们活泼又聪明，他们调皮又灵敏。他们自由自在生活在那绿色的大草坪，他们善良勇敢相互都关心……”\n\n——选自猪王国民歌\n\n很久很久以前，在山的那边海的那边的某片风水宝地曾经存在过一个猪王国。猪王国地理位置偏僻，实施的是适应当时社会的自给自足的庄园经济，很少与外界联系，商贸活动就更少了。因此也很少有其他动物知道这样一个王国。\n\n猪王国虽然不大，但是土地肥沃，屋舍俨然。如果一定要拿什么与之相比的话，那就只能是东晋陶渊明笔下的大家想象中的桃花源了。猪王勤政爱民，猪民安居乐业，邻里和睦相处，国家秩序井然，经济欣欣向荣，社会和谐稳定。和谐的社会带给猪民们对工作火红的热情和对未来的粉色的憧憬。\n\n小猪 iPig 是猪王国的一个很普通的公民。小猪今年 10 岁了，在大肥猪学校上小学三年级。和大多数猪一样，他不是很聪明，因此经常遇到很多或者稀奇古怪或者旁人看来轻而易举的事情令他大伤脑筋。小猪后来参加了全猪信息学奥林匹克竞赛（Pig Olympiad in Informatics，POI），取得了不错的名次，最终保送进入了猪王国大学（Pig Kingdom University，PKU）深造。\n\n现在的小猪已经能用计算机解决简单的问题了，比如能用 P++ 语言编写程序计算出 $A + B$ 的值。这个“成就”已经成为了他津津乐道的话题。当然，不明真相的同学们也开始对他刮目相看啦~\n\n小猪的故事就将从此展开，伴随大家两天时间，希望大家能够喜欢小猪。", "description": "猪王国的文明源远流长，博大精深。\n\niPig 在大肥猪学校图书馆中查阅资料，得知远古时期猪文文字总个数为 $n$。当然，一种语言如果字数很多，字典也相应会很大。当时的猪王国国王考虑到如果修一本字典，规模有可能远远超过康熙字典，花费的猪力、物力将难以估量。故考虑再三没有进行这一项劳猪伤财之举。当然，猪王国的文字后来随着历史变迁逐渐进行了简化，去掉了一些不常用的字。\n\niPig 打算研究古时某个朝代的猪文文字。根据相关文献记载，那个朝代流传的猪文文字恰好为远古时期的 $1/k$，其中 $k$ 是 $n$ 的一个正约数（可以是 $1$ 或 $n$）。不过具体是哪 $1/k$，以及 $k$ 是多少，由于历史过于久远，已经无从考证了。\n\niPig 觉得只要符合文献，每一种 $k|n$ 都是有可能的。他打算考虑到所有可能的 $k$。显然当 $k$ 等于某个定值时，该朝的猪文文字个数为 $n/k$。然而从 $n$ 个文字中保留下 $n/k$ 个的情况也是相当多的。iPig 预计，如果所有可能的 $k$ 的所有情况数加起来为 $p$ 的话，那么他研究古代文字的代价将会是 $g^p$。\n\n现在他想知道猪王国研究古代文字的代价是多少。由于 iPig 觉得这个数字可能是天文数字，所以你只需要告诉他答案除以 $999911659$ 的余数就可以了。", "inputFormat": "一行两个正整数 $n,g$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "#### 数据规模与约定\n- 对于 $10\\%$ 的数据，$1\\le n \\le 50$；  \n- 对于 $20\\%$ 的数据，$1\\le n \\le 1000$；  \n- 对于 $40\\%$ 的数据，$1\\le n \\le 10^5$；  \n- 对于 $100\\%$ 的数据，$1\\le n,g \\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2010] Ancient Pig Script", "background": "\"Beyond those mountains and beyond those seas lives a group of little chubby pigs. They are lively and clever, naughty yet quick. They live freely on that vast green lawn, kind and brave, caring for one another...\"\n\n— From the national anthem of the Pig Kingdom.\n\nA long time ago, in a blessed land beyond the mountains and seas, there once existed a Pig Kingdom. The Pig Kingdom was in a remote location and adopted a self-sufficient manor economy suited to its time, with little contact with the outside world and even fewer commercial activities. As a result, few other animals knew of such a kingdom.\n\nAlthough the Pig Kingdom was not large, its land was fertile and its houses were well ordered. If one had to compare it to something, it could only be the imagined Peach Blossom Spring described by Tao Yuanming of the Eastern Jin. The Pig King governed diligently and loved his people; the pig citizens lived and worked in peace and contentment; neighbors got along harmoniously; the country was orderly; the economy thrived; and society was harmonious and stable. Such harmony inspired in the pig citizens a fiery passion for work and a rosy vision for the future.\n\nThe little pig iPig was an ordinary citizen of the Pig Kingdom. He was 10 years old this year and in the third grade at Big Fat Pig Elementary School. Like most pigs, he was not very smart, so he often ran into problems that were either odd or seemed trivial to others, giving him big headaches. Later, he took part in the Pig Olympiad in Informatics (POI), achieved a good ranking, and was finally recommended for admission to Pig Kingdom University (PKU) for further study.\n\nNow iPig can use a computer to solve simple problems, such as writing a program in the P++ language to compute the value of $A + B$. This “achievement” has become a favorite topic of his. Of course, classmates who do not know the full story have begun to look at him with new respect.\n\niPig’s story begins here and will accompany everyone for two days. We hope you will enjoy it.", "description": "The civilization of the Pig Kingdom has a long history and great depth.\n\nIn the library of Big Fat Pig School, iPig learned from reference materials that the total number of characters in the ancient pig script was $n$. Of course, if a language has many characters, its dictionary will be correspondingly large. The Pig King of that time considered that if a dictionary were compiled, its scale might far exceed the Kangxi Dictionary, and the manpower and material resources required would be immeasurable. After careful consideration, he did not undertake this labor- and resource-intensive project. Naturally, the script of the Pig Kingdom was later simplified over history by removing some uncommon characters.\n\niPig plans to study the pig script from a certain dynasty in ancient times. According to relevant documents, the characters used in that dynasty happened to be exactly $1/k$ of those in the distant past, where $k$ is a positive divisor of $n$ (it can be $1$ or $n$). However, exactly which $1/k$ was used, and what $k$ was, can no longer be verified due to the remoteness of history.\n\niPig believes that as long as it matches the documents, every $k \\mid n$ is possible. He will consider all possible $k$. Clearly, when $k$ is fixed, the number of characters in that dynasty’s script is $n/k$. However, the number of ways to retain $n/k$ characters out of $n$ is also quite large. iPig estimates that if the total number of cases over all possible $k$ sums to $p$, then the cost of his research on the ancient script will be $g^p$.\n\nHe now wants to know the cost for the Pig Kingdom to study the ancient script. Since iPig thinks this number may be astronomical, you only need to tell him the remainder of the answer modulo $999911659$.", "inputFormat": "One line containing two positive integers $n, g$.", "outputFormat": "Output one line containing a single integer representing the answer.", "hint": "- Constraints\n  - For $10\\%$ of the testdata, $1 \\le n \\le 50$.\n  - For $20\\%$ of the testdata, $1 \\le n \\le 1000$.\n  - For $40\\%$ of the testdata, $1 \\le n \\le 10^5$.\n  - For $100\\%$ of the testdata, $1 \\le n, g \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2010] 古代猪文", "background": "“在那山的那边海的那边有一群小肥猪。他们活泼又聪明，他们调皮又灵敏。他们自由自在生活在那绿色的大草坪，他们善良勇敢相互都关心……”\n\n——选自猪王国民歌\n\n很久很久以前，在山的那边海的那边的某片风水宝地曾经存在过一个猪王国。猪王国地理位置偏僻，实施的是适应当时社会的自给自足的庄园经济，很少与外界联系，商贸活动就更少了。因此也很少有其他动物知道这样一个王国。\n\n猪王国虽然不大，但是土地肥沃，屋舍俨然。如果一定要拿什么与之相比的话，那就只能是东晋陶渊明笔下的大家想象中的桃花源了。猪王勤政爱民，猪民安居乐业，邻里和睦相处，国家秩序井然，经济欣欣向荣，社会和谐稳定。和谐的社会带给猪民们对工作火红的热情和对未来的粉色的憧憬。\n\n小猪 iPig 是猪王国的一个很普通的公民。小猪今年 10 岁了，在大肥猪学校上小学三年级。和大多数猪一样，他不是很聪明，因此经常遇到很多或者稀奇古怪或者旁人看来轻而易举的事情令他大伤脑筋。小猪后来参加了全猪信息学奥林匹克竞赛（Pig Olympiad in Informatics，POI），取得了不错的名次，最终保送进入了猪王国大学（Pig Kingdom University，PKU）深造。\n\n现在的小猪已经能用计算机解决简单的问题了，比如能用 P++ 语言编写程序计算出 $A + B$ 的值。这个“成就”已经成为了他津津乐道的话题。当然，不明真相的同学们也开始对他刮目相看啦~\n\n小猪的故事就将从此展开，伴随大家两天时间，希望大家能够喜欢小猪。", "description": "猪王国的文明源远流长，博大精深。\n\niPig 在大肥猪学校图书馆中查阅资料，得知远古时期猪文文字总个数为 $n$。当然，一种语言如果字数很多，字典也相应会很大。当时的猪王国国王考虑到如果修一本字典，规模有可能远远超过康熙字典，花费的猪力、物力将难以估量。故考虑再三没有进行这一项劳猪伤财之举。当然，猪王国的文字后来随着历史变迁逐渐进行了简化，去掉了一些不常用的字。\n\niPig 打算研究古时某个朝代的猪文文字。根据相关文献记载，那个朝代流传的猪文文字恰好为远古时期的 $1/k$，其中 $k$ 是 $n$ 的一个正约数（可以是 $1$ 或 $n$）。不过具体是哪 $1/k$，以及 $k$ 是多少，由于历史过于久远，已经无从考证了。\n\niPig 觉得只要符合文献，每一种 $k|n$ 都是有可能的。他打算考虑到所有可能的 $k$。显然当 $k$ 等于某个定值时，该朝的猪文文字个数为 $n/k$。然而从 $n$ 个文字中保留下 $n/k$ 个的情况也是相当多的。iPig 预计，如果所有可能的 $k$ 的所有情况数加起来为 $p$ 的话，那么他研究古代文字的代价将会是 $g^p$。\n\n现在他想知道猪王国研究古代文字的代价是多少。由于 iPig 觉得这个数字可能是天文数字，所以你只需要告诉他答案除以 $999911659$ 的余数就可以了。", "inputFormat": "一行两个正整数 $n,g$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "#### 数据规模与约定\n- 对于 $10\\%$ 的数据，$1\\le n \\le 50$；  \n- 对于 $20\\%$ 的数据，$1\\le n \\le 1000$；  \n- 对于 $40\\%$ 的数据，$1\\le n \\le 10^5$；  \n- 对于 $100\\%$ 的数据，$1\\le n,g \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P2481", "type": "P", "difficulty": 6, "samples": [["2 3", "15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2010", "各省省选", "山东", "数位 DP", "组合数学"], "title": "[SDOI2010] 代码拍卖会", "background": "", "description": "随着 iPig 在 P++ 语言上的造诣日益提升，他形成了自己一套完整的代码库。猪王国想参加 POI 的童鞋们都争先恐后问 iPig 索要代码库。iPig 不想把代码库给所有想要的小猪，只想给其中的一部分既关系好又肯出钱的小猪，于是他决定举行了一个超大型拍卖会。\n\n在拍卖会上，所有的 $N$ 头小猪将会按照和 iPig 的好感度从低到高，从左到右地在 iPig 面前站成一排。每个小猪身上都有 $9$ 猪币（与人民币汇率不明），从最左边开始，每个小猪依次举起一块牌子，上面写上想付出的买代码库的猪币数量（$1$ 到 $9$ 之间的一个整数）。大家都知道，如果自己付的钱比左边的猪少，肯定得不到梦寐以求的代码库，因此从第二只起，每只猪出的钱都大于等于左边猪出的价钱。最终出的钱最多的小猪（们）会得到 iPig 的代码库真传，向着保送 PKU（Pig Kingdom University）的梦想前进。\n\niPig 对自己想到的这个点子感到十分满意，在去现场的路上，iPig 就在想象拍卖会上会出现的场景，例如一共会出现多少种出价情况之类的问题，但这些问题都太简单了，iPig 早已不感兴趣了，他想要去研究更加困难的问题。iPig 发现如果他从台上往下看，所有小猪举的牌子从左到右将会正好构成一个 $N$ 位的整数，他现在想要挑战的问题是所有可能构成的整数中能正好被 $P$ 整除的有多少个。由于答案过大，他只想要知道答案 $\\bmod\\ 999911659$ 就行了。", "inputFormat": "有且仅有一行两个数 $N\\ (1 \\le N \\le 10^{18})$ 和 $P\\ (1 \\le P \\le 500)$，用一个空格分开。", "outputFormat": "有且仅有一行一个数，表示答案除以 $999911659$ 的余数。\n", "hint": "### 样例解释\n\n方案可以是：$12,\\allowbreak 15,\\allowbreak 18,\\allowbreak 24,\\allowbreak 27,\\allowbreak 33,\\allowbreak 36,\\allowbreak 39,\\allowbreak 45,\\allowbreak 48,\\allowbreak 57,\\allowbreak 66,\\allowbreak 69,\\allowbreak 78,\\allowbreak 99$，共 $15$ 种。\n\n### 数据规模\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/y0nme218.png)\n", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2010] Code Auction", "background": "", "description": "As iPig’s mastery of the P++ language grows, he has built his own complete code library. Students in the Pig Kingdom who want to participate in POI are all scrambling to ask iPig for the library. iPig does not want to give the code library to every piglet who wants it; he only wants to give it to some piglets who are both close to him and willing to pay, so he decides to hold a huge auction.\n\nAt the auction, all $N$ piglets will stand in a line from left to right, ordered by their favorability with iPig from low to high. Each piglet has $9$ pig-coins (exchange rate with RMB unknown). Starting from the left, each piglet in turn raises a sign showing an integer from $1$ to $9$, indicating how many pig-coins they want to pay for the code library. Everyone knows that if they bid less than the pig on their left, they will certainly not get the coveted code library; therefore, starting from the second pig, each bid is greater than or equal to the bid of the pig on the left. The piglet(s) who bid the most in the end will receive iPig’s code library and move toward the dream of being recommended to PKU (Pig Kingdom University).\n\niPig is very pleased with this idea. On the way to the venue, he starts imagining the scenes at the auction, such as how many different bidding sequences there will be, but these questions are too easy and no longer interest him. He wants to study a harder problem. iPig notices that if he looks down from the stage, the signs raised by the pigs from left to right form exactly an $N$-digit integer. He now wants to tackle the following problem: among all possible integers that can be formed, how many are exactly divisible by $P$? Since the answer can be large, he only wants the answer $\\bmod\\ 999911659$.", "inputFormat": "There is exactly one line containing two numbers $N\\ (1 \\le N \\le 10^{18})$ and $P\\ (1 \\le P \\le 500)$, separated by a space.", "outputFormat": "Output exactly one line containing a single number, the remainder when the answer is divided by $999911659$.", "hint": "### Sample Explanation\n\nThe valid sequences can be: $12,\\allowbreak 15,\\allowbreak 18,\\allowbreak 24,\\allowbreak 27,\\allowbreak 33,\\allowbreak 36,\\allowbreak 39,\\allowbreak 45,\\allowbreak 48,\\allowbreak 57,\\allowbreak 66,\\allowbreak 69,\\allowbreak 78,\\allowbreak 99$, for a total of $15$.\n\n### Constraints\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/y0nme218.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2010] 代码拍卖会", "background": "", "description": "随着 iPig 在 P++ 语言上的造诣日益提升，他形成了自己一套完整的代码库。猪王国想参加 POI 的童鞋们都争先恐后问 iPig 索要代码库。iPig 不想把代码库给所有想要的小猪，只想给其中的一部分既关系好又肯出钱的小猪，于是他决定举行了一个超大型拍卖会。\n\n在拍卖会上，所有的 $N$ 头小猪将会按照和 iPig 的好感度从低到高，从左到右地在 iPig 面前站成一排。每个小猪身上都有 $9$ 猪币（与人民币汇率不明），从最左边开始，每个小猪依次举起一块牌子，上面写上想付出的买代码库的猪币数量（$1$ 到 $9$ 之间的一个整数）。大家都知道，如果自己付的钱比左边的猪少，肯定得不到梦寐以求的代码库，因此从第二只起，每只猪出的钱都大于等于左边猪出的价钱。最终出的钱最多的小猪（们）会得到 iPig 的代码库真传，向着保送 PKU（Pig Kingdom University）的梦想前进。\n\niPig 对自己想到的这个点子感到十分满意，在去现场的路上，iPig 就在想象拍卖会上会出现的场景，例如一共会出现多少种出价情况之类的问题，但这些问题都太简单了，iPig 早已不感兴趣了，他想要去研究更加困难的问题。iPig 发现如果他从台上往下看，所有小猪举的牌子从左到右将会正好构成一个 $N$ 位的整数，他现在想要挑战的问题是所有可能构成的整数中能正好被 $P$ 整除的有多少个。由于答案过大，他只想要知道答案 $\\bmod\\ 999911659$ 就行了。", "inputFormat": "有且仅有一行两个数 $N\\ (1 \\le N \\le 10^{18})$ 和 $P\\ (1 \\le P \\le 500)$，用一个空格分开。", "outputFormat": "有且仅有一行一个数，表示答案除以 $999911659$ 的余数。\n", "hint": "### 样例解释\n\n方案可以是：$12,\\allowbreak 15,\\allowbreak 18,\\allowbreak 24,\\allowbreak 27,\\allowbreak 33,\\allowbreak 36,\\allowbreak 39,\\allowbreak 45,\\allowbreak 48,\\allowbreak 57,\\allowbreak 66,\\allowbreak 69,\\allowbreak 78,\\allowbreak 99$，共 $15$ 种。\n\n### 数据规模\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/y0nme218.png)\n", "locale": "zh-CN"}}}
{"pid": "P2482", "type": "P", "difficulty": 6, "samples": [["3 10\nMP D D F F\nZP N N N D\nFP J J J J\nF F D D J J F F K D\n", "FP\nDEAD\nDEAD\nJ J J J J J D\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "字符串", "2010", "各省省选", "山东"], "title": "[SDOI2010] 猪国杀", "background": null, "description": "### 游戏背景\n\n《猪国杀》是一种多猪牌类回合制游戏，一共有 $3$ 种角色：主猪，忠猪，反猪。每局游戏主猪有且只有 $1$ 只，忠猪和反猪可以有多只，每只猪扮演 $1 $ 种角色。\n\n### 游戏目的\n\n主猪 / $\\texttt{MP}$：自己存活的情况下消灭所有的反猪。  \n忠猪 / $\\texttt{ZP}$：不惜一切保护主猪，胜利条件与主猪相同。  \n反猪 / $\\texttt{FP}$：杀死主猪。\n\n### 游戏过程\n\n游戏开始时，每个玩家手里都会有 $4$ 张牌，且体力上限和初始体力都是 $4$ 。\n\n开始游戏时，从主猪开始，按照逆时针方向（数据中就是按照编号从 $ 1 , 2, 3 \\ldots n , 1 \\ldots $ 的顺序）依次行动。\n\n每个玩家自己的回合可以分为 2 个阶段：\n\n* **摸牌阶段**：从牌堆顶部摸 $2$ 张牌，依次放到手牌的最右边；  \n* **出牌阶段**：你可以使用任意张牌，每次使用牌的时候都使用最靠左的能够使用的牌。当然，要满足如下规则：\n  1. 如果没有猪哥连弩，每个出牌阶段只能使用 $1$ 次「杀」来攻击；\n  2. 任何牌被使用后被弃置（武器是装备上）；被弃置的牌以后都不能再用，即与游戏无关。\n\n### 各种牌介绍\n\n每张手牌用 $1$ 个字母表示，字母代表牌的种类。\n\n#### 基本牌\n\n- 『桃 / $\\texttt{P}$』在自己的回合内，如果自己的体力值不等于体力上限，那么使用 $1$ 个桃可以为自己补充 $1$ 点体力，否则不能使用桃；桃只能对自己使用；在自己的回合外，如果自己的体力变为 $0$ 或者更低，那么也可以使用。\n\n- 『杀 / $\\texttt{K}$』在自己的回合内，对攻击范围内除自己以外的 $1$ 名角色使用。如果没有被『闪』抵消，则造成 $1$ 点伤害。无论有无武器，杀的攻击范围都是 $1$。\n\n- 『闪 / $\\texttt{D}$』当你受到杀的攻击时，可以弃置 $1$ 张闪来抵消杀的效果。\n\n#### 锦囊牌\n\n- 『决斗 / $\\texttt{F}$』出牌阶段，对除自己以外任意 $1$ 名角色使用，由目标角色先开始，自己和目标角色轮流弃置 $1$ 张杀，首先没有杀可弃的一方受到 $1$ 点伤害，另一方视为此伤害的来源。\n\n- 『南猪入侵 / $\\texttt{N}$』出牌阶段，对除你以外所有角色使用，按逆时针顺序从使用者下家开始依次结算，除非弃置 $1$ 张杀，否则受到 $1$ 点伤害。\n\n- 『万箭齐发 / $\\texttt{W}$』和南猪入侵类似，不过要弃置的不是杀而是闪。\n\n- 『无懈可击 / $\\texttt{J}$』在目标锦囊生效前抵消其效果。每次有 $1$ 张锦囊即将生效时，从使用这张锦囊的猪开始，按照逆时针顺序，依次得到使用无懈可击的机会；效果：用于决斗时，决斗无效并弃置；用于南猪入侵或万箭齐发时，当结算到某个角色时才能使用，当前角色不需弃置牌并且不会受到伤害（仅对 $1$ 个角色产生效果）；用于无懈可击时，成为目标的无懈可击被无效。\n\n#### 装备牌\n\n- 『猪哥连弩 / $\\texttt{Z}$』武器，攻击范围 $1$ ，出牌阶段你可以使用任意张杀; 同一时刻最多只能装 $1$ 把武器；如果先前已经有了 $1$ 把武器，那么之后再装武器的话，会弃置以前的武器来装现在的武器。\n\n### 特殊事件及概念解释\n\n* **伤害来源**：杀、南猪入侵、万箭齐发的伤害来源均是使用该牌的猪，决斗的伤害来源如上；\n\n* **距离**：两只猪的距离定义为沿着逆时针方向间隔的猪数 $+1$ 。即初始时 $1$ 和 $2$ 的距离为 $1$ ，但是 $2$ 和 $1$ 的距离就是 $n-1$ 。注意一个角色的死亡会导致一些猪距离的改变；\n\n* **玩家死亡**：如果该玩家的体力降到 $0$ 或者更低，并且自己手中没有足够的桃使得自己的体力值回到 $1$ ，那么就死亡了，死亡后所有的牌（装备区，手牌区）被弃置；\n\n* **奖励与惩罚**：反猪死亡时，最后一个伤害来源处（即使是反猪）立即摸 $3$ 张牌。忠猪死亡时，如果最后一个伤害来源是主猪，那么主猪所有装备牌、手牌被弃置。\n\n注意：一旦达成胜利条件，游戏立刻结束，因此即使会摸 $3$ 张牌或者还有牌可以用也不用执行了。\n\n现在，我们已经知道每只猪的角色、手牌，还有牌堆初始情况，并且假设每个角色会按照如下的行为准则进行游戏，你需要做的就是告诉小猪 iPig 最后的结果。\n\n### 几种行为\n\n* **献殷勤**：使用无懈可击挡下南猪入侵、万箭齐发、决斗；使用无懈可击抵消表敌意；  \n* **表敌意**：对某个角色使用杀、决斗；使用无懈可击抵消献殷勤；  \n* **跳忠**：即通过行动表示自己是忠猪。跳忠行动就是对主猪或对某只已经跳忠的猪献殷勤，或者对某只已经跳反的猪表敌意；  \n* **跳反**：即通过行动表示自己是反猪。跳反行动就是对主猪或对某只已经跳忠的猪表敌意，或者对某只已经跳反的猪献殷勤。\n\n**注意：忠猪不会跳反，反猪也不会跳忠；不管是忠猪还是反猪，能够跳必然跳**。\n\n### 行动准则\n\n#### 共性\n\n* 每个角色如果手里有桃且生命值未满，那么必然吃掉；\n* 有南猪入侵、万箭齐发，必然使用；有装备必然装上；\n* 受到杀时，有闪必然弃置；\n* 响应南猪入侵或者万箭齐发时候，有杀 / 闪必然弃置；\n* 不会对未表明身份的猪献殷勤（**包括自己**）。\n\n#### 特性\n\n - 主猪：\n   + 主猪会认为「没有跳身份，且用南猪入侵 / 万箭齐发对自己造成伤害的猪」是**类**反猪（没伤害到不算，注意类反猪并没有表明身份），如果之后跳了，那么主猪会重新认识这只猪；  \n   + 对于每种表敌意的方式，对逆时针方向能够执行到的第一只类反猪或者已跳反猪表；如果没有，那么就不表敌意；\n   + 决斗时会不遗余力弃置杀；\n   + 如果能对已经跳忠的猪或自己献殷勤，那么一定献；如果能够对已经跳反的猪表敌意，那么一定表。\n - 忠猪：\n   + 对于每种表敌意的方式，对「逆时针方向能够执行到的第一只已经跳反的猪」表，如果没有，那么就不表敌意；\n   + 决斗时，如果对方是主猪，那么不会弃置杀，否则，会不遗余力弃置杀；\n   + 如果有机会对主猪或者已经跳忠的猪献殷勤，那么一定献。\n - 反猪：\n   + 对于每种表敌意的方式，如果有机会则对主猪表，否则，对「逆时针方向能够执行到的第一只已经跳忠的猪」表，如果没有，那么就不表敌意；\n   + 决斗时会不遗余力弃置杀；\n   + 如果有机会对已经跳反的猪献殷勤，那么一定献。\n\n限于 iPig 只会用 P++ 语言写 A + B，他请你用 Pigcal (Pascal)、P (C) 或 P++ (C++) 语言来帮他预测最后的结果。", "inputFormat": "输入文件第一行包含两个正整数 $ n $ $ (2 \\leqslant n \\leqslant 10) $ 和 $m$ $ (m \\leqslant 2000) $，分别代表玩家数和牌堆中牌的数量。数据保证牌的数量够用。\n\n接下来 $n$ 行，每行 $5$ 个字符串，依次表示对第 $i$ 只猪的角色和初始 $4 $ 张手牌描述。编号为 $1$ 的肯定是主猪。\n\n再接下来一行，一共 $m$ 个字符串，按照从牌堆顶部到牌堆底部的顺序描述每张牌。\n\n**注意：所有的相邻的两个字符串都严格用 $1$ 个空格隔开，行尾没有多余空格**。", "outputFormat": "输出数据第一行包含一个字符串代表游戏结果。如果是主猪胜利，那么输出 $\\texttt{MP}$ ，否则输出 $\\texttt{FP}$ 。数据保证游戏总会结束。\n\n接下来 $n$ 行，第 $i$ 行是对第 $i$ 只猪的手牌描述（注意只需要输出手牌），按照手牌从左往右的顺序输出，相邻两张牌用 $1$ 个空格隔开，行末尾没有多余空格。如果这只猪已阵亡，那么只要输出 $\\texttt{DEAD}$ 即可。\n\n**注意：如果要输出手牌而没有手牌的话，那么只需输出 $1$ 个空行**。\n\n**由于数据问题，若牌堆已空，按照每次抽牌抽到的都是最后一张。**", "hint": "### 样例解释\n\n第一回合：\n* 主猪没有目标可以表敌意；\n* 接下来忠猪使用了 $3$ 张南猪入侵，主猪掉了 $3$ 点体力，并认为该角色为类反猪，$3$ 号角色尽管手里有无懈可击，但是因为自己未表明身份，所以同样不能对自己用，乖乖掉 $3$ 点体力；  \n\n下一回合：\n* 反猪无牌可出；\n* 接下来主猪对着类反猪爆发，使用 $4$ 张决斗，忠猪死亡，结果主猪弃掉所有牌；\n* 接下来反猪摸到 $1$ 张杀直接杀死主猪获胜。\n\n### 子任务\n\n一共 $20$ 组测试数据，每个点 $5$ 分。\n\n$10\\%$ 的数据没有锦囊牌，另外 $20\\%$ 的数据没有无懈可击。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2010] Pig Kingdom Kill", "background": "", "description": "### Game Background\n\n\"Pig Kingdom Kill\" is a turn-based card game for multiple pigs. There are 3 types of roles: **Main Pig (MP)**, **Loyal Pig (ZP)**, and **Rebel Pig (FP)**. In every game, there is exactly 1 MP. There can be multiple ZPs and FPs. Each pig plays exactly one role.\n\n### Game Objective\n\n  * **Main Pig (MP):** Eliminate all Rebel Pigs (FP) while surviving.\n  * **Loyal Pig (ZP):** Protect the Main Pig at all costs. The victory condition is the same as the MP.\n  * **Rebel Pig (FP):** Kill the Main Pig.\n\n### Game Process\n\nAt the start of the game, each player holds $4$ cards. Both the max HP and initial HP are $4$.\n\nThe game starts with the Main Pig and proceeds in **counter-clockwise order** (in the data, this is the order of IDs $1, 2, 3 \\dots n, 1 \\dots$).\n\nEach player's turn consists of two phases:\n\n1.  **Draw Phase:** Draw $2$ cards from the top of the deck and place them at the rightmost end of the hand.\n2.  **Play Phase:** You may use any number of cards. When playing cards, you must always use the **leftmost** usable card. However, the following rules apply:\n    1.  Without a \"Zhuge Crossbow\", you can only use **1** \"Kill\" card to attack per Play Phase.\n    2.  Any card used is discarded (weapons are equipped). Discarded cards cannot be used again and are removed from the game.\n\n### Card Descriptions\n\nEach card is represented by a single letter indicating its type.\n\n#### Basic Cards\n\n  * **Peach (`P`):** During your turn, if your HP is not full, you can use a Peach to recover $1$ HP. Otherwise, it cannot be used. Peach can only be used on yourself. *Exception:* If your HP drops to $0$ or below during someone else's turn, you can use a Peach immediately to save yourself.\n  * **Kill (`K`):** During your turn, use this on any other character within your attack range. If the target does not use a \"Dodge\" to cancel it, they take $1$ point of damage. Regardless of weapons, the default attack range of a Kill is $1$.\n  * **Dodge (`D`):** When attacked by a \"Kill\", you may discard a Dodge to negate the effect.\n\n#### Scroll Cards (Strategy Cards)\n\n  * **Duel (`F`):** During the Play Phase, use on any other character. Starting with the target, the target and the user take turns discarding a \"Kill\". The first side unable to discard a \"Kill\" takes $1$ damage. The other side is considered the source of this damage.\n  * **South Pig Invasion (`N`):** During the Play Phase, use on **all other characters**. Starting from the player to the user's right (next in turn order), proceed counter-clockwise. Unless a player discards a \"Kill\", they take $1$ damage.\n  * **Archery Attack (`W`):** Similar to South Pig Invasion, but players must discard a \"Dodge\" instead of a \"Kill\" to avoid damage.\n  * **Unassailable / Nullification (`J`):** Use this to negate the effect of a target scroll card before it takes effect.\n      * Each time a scroll is about to take effect on a character, players (starting from the scroll user) proceed counter-clockwise, having the opportunity to use `J`.\n      * **Effect:** When used against a Duel, the Duel is invalidated and discarded. When used against AOE (South Pig Invasion/Archery), it prevents the effect for **one specific target** (that target does not need to discard a card and takes no damage). When used against another `J`, it negates the previous `J` (re-enabling the original scroll).\n\n#### Equipment Cards\n\n  * **Zhuge Crossbow (`Z`):** A weapon. Attack range is $1$. During the Play Phase, you may use any number of \"Kill\" cards. You may only have $1$ weapon equipped at a time. If you equip a new weapon, the old one is discarded.\n\n### Special Events and Concepts\n\n  * **Damage Source:** For Kill, South Pig Invasion, and Archery Attack, the source is the user of the card. For Duel, the source is the winner of the duel.\n  * **Distance:** The distance between two pigs is defined as the number of pigs between them in the counter-clockwise direction $+ 1$. Initially, the distance from $1$ to $2$ is $1$, but the distance from $2$ to $1$ is $n-1$. Note that the death of a character changes the distance between the remaining pigs.\n  * **Player Death:** If a player's HP drops to $0$ or lower and they cannot use enough Peaches to bring their HP back to $1$, they die. Upon death, all their cards (hand and equipment) are discarded.\n  * **Rewards and Penalties:**\n      * When an **FP** dies, the source of the damage (even if it is another FP) immediately draws $3$ cards.\n      * When a **ZP** dies, if the damage source was the **MP**, the MP must discard all their cards (hand and equipment).\n      * *Note:* If the victory condition is met, the game ends immediately. No cards are drawn or discarded even if triggered.\n\nNow, given each pig's role, initial hand, and the initial deck configuration, assume every character follows the behavior rules below. Your task is to predict the final result for iPig.\n\n### Behavior Rules\n\n  * **Showing Goodwill:** Using `J` to negate South Pig Invasion, Archery, or Duel for someone; or using `J` to negate a \"Showing Animosity\" action.\n  * **Showing Animosity:** Using `K` or `F` on a character; or using `J` to negate a \"Showing Goodwill\" action.\n  * **Jump Loyal (Reveal as ZP):** Actions that show you are a Loyalist. This involves Showing Goodwill to the MP or an already revealed ZP, or Showing Animosity to an already revealed FP.\n  * **Jump Rebel (Reveal as FP):** Actions that show you are a Rebel. This involves Showing Animosity to the MP or an already revealed ZP, or Showing Goodwill to an already revealed FP.\n\n**Note: A ZP will never Jump Rebel, and an FP will never Jump Loyal. If a pig can reveal its identity (jump), it will.**\n\n### Action Logic\n\n#### General (Common to all)\n\n1.  If a player has a Peach (`P`) and HP is not full, they will strictly use it.\n2.  If holding South Pig Invasion (`N`) or Archery (`W`), they will strictly use it. If holding equipment (`Z`), they will strictly equip it.\n3.  When targeted by a Kill (`K`), if they have a Dodge (`D`), they will strictly discard it.\n4.  When responding to South Pig Invasion (`N`) or Archery (`W`), if they have the required card (`K`/`D`), they will strictly discard it.\n5.  Players will **never** Show Goodwill to a pig whose identity is unknown (this **includes themselves**—logic implies they don't 'reveal' to protect themselves unless they are already known or it helps a known ally, but the specific rule provided is \"Won't show goodwill to undefined identities\").\n\n#### Specific Role Logic\n\n  * **Main Pig (MP):**\n\n      * The MP considers any pig who has caused damage to the MP using South Pig Invasion (`N`) or Archery (`W`) **and has not yet revealed their identity** as a **\"Like-Rebel\"** (quasi-rebel). (Zero damage doesn't count. Note: Like-Rebels have not technically revealed their identity). If this pig later reveals an identity (\"Jumps\"), the MP updates their view of this pig.\n      * For any method of **Showing Animosity**: The MP targets the first **Like-Rebel** or **Revealed FP** found in the counter-clockwise direction (within range/validity). If none are found, the MP does not Show Animosity.\n      * During a Duel (`F`), the MP discards Kills as much as possible.\n      * If able to Show Goodwill to a Revealed ZP or themselves, the MP strictly does so. If able to Show Animosity to a Revealed FP, the MP strictly does so.\n\n  * **Loyal Pig (ZP):**\n\n      * For any method of **Showing Animosity**: The ZP targets the first **Revealed FP** found in the counter-clockwise direction. If none, they do not Show Animosity.\n      * During a Duel (`F`):\n          * If the opponent is the **MP**, the ZP will **not** discard a Kill (voluntarily takes damage).\n          * Otherwise, the ZP discards Kills as much as possible.\n      * If there is a chance to Show Goodwill to the MP or a Revealed ZP, the ZP strictly does so.\n\n  * **Rebel Pig (FP):**\n\n      * For any method of **Showing Animosity**: If able, strictly target the **MP**. Otherwise, target the first **Revealed ZP** found in the counter-clockwise direction. If neither is possible, do not Show Animosity.\n      * During a Duel (`F`), the FP discards Kills as much as possible.\n      * If there is a chance to Show Goodwill to a Revealed FP, the FP strictly does so.\n\nSince iPig can only write \"A + B\" in P++, he asks you to predict the result using Pascal, C, or C++.\n", "inputFormat": "The first line contains two positive integers $n$ $(2 \\leqslant n \\leqslant 10)$ and $m$ $(m \\leqslant 2000)$, representing the number of players and the number of cards in the deck. The data guarantees the number of cards is sufficient (see note below).\n\nThe next $n$ lines each contain 5 strings, describing the $i$-th pig. The first string is the role, followed by the initial 4 cards. The pig with ID $1$ is always the **MP**.\n\nThe following line contains $m$ strings, describing the cards in the deck from top to bottom.\n\n**Note: All adjacent strings are strictly separated by 1 space. There are no trailing spaces at the end of lines.**", "outputFormat": "The first line contains a string representing the game result. If the Main Pig wins, output `MP`. Otherwise, output `FP`. The data guarantees the game will end.\n\nThe next $n$ lines describe the hand cards of the $i$-th pig (only output the hand cards). Output them in order from left to right, separated by 1 space. There should be no trailing spaces. If the pig is dead, output `DEAD`.\n\n**Note: If a pig is alive but has no cards, output a single empty line.**\n\n**Due to data issues, if the draw pile becomes empty, treat it as if the last card drawn is drawn repeatedly for all subsequent draws.**", "hint": "### Sample Explanation\n\n**Turn 1:**\n\n  * **MP:** Has no target to Show Animosity to.\n  * **ZP:** Uses 3 South Pig Invasions (`N`).\n      * MP takes 3 damage. MP now views ZP as a \"Like-Rebel\".\n      * Player 3 (FP) has `J` (Nullification), but since they haven't revealed their identity, they cannot use it on themselves. They take 3 damage.\n  * **FP:** Starts turn.\n\n**Next Turn (implied flow):**\n\n  * **FP:** Has no playable offense cards (only `J`).\n  * **MP:** Acts. Uses 4 Duels (`F`) on the ZP (who is marked as Like-Rebel).\n      * ZP dies (ZP does not fight back against MP? Wait, ZP logic says \"If opponent is MP, do not discard Kill\". However, ZP is currently treated as Like-Rebel by MP. The ZP knows MP is MP, so ZP accepts death).\n      * MP kills ZP. MP Penalty: MP discards all cards.\n  * **FP:** Acts. Draws a Kill (`K`). Uses it on MP. MP (HP 1, no cards) dies.\n  * **Result:** FP wins.\n\n### Subtasks\n\nThere are 20 test cases, 5 points each.\n\n  * 10% of data has no Scroll cards.\n  * Another 20% of data has no \"Unassailable\" (`J`) cards.", "locale": "en"}, "zh-CN": {"title": "[SDOI2010] 猪国杀", "background": null, "description": "### 游戏背景\n\n《猪国杀》是一种多猪牌类回合制游戏，一共有 $3$ 种角色：主猪，忠猪，反猪。每局游戏主猪有且只有 $1$ 只，忠猪和反猪可以有多只，每只猪扮演 $1 $ 种角色。\n\n### 游戏目的\n\n主猪 / $\\texttt{MP}$：自己存活的情况下消灭所有的反猪。  \n忠猪 / $\\texttt{ZP}$：不惜一切保护主猪，胜利条件与主猪相同。  \n反猪 / $\\texttt{FP}$：杀死主猪。\n\n### 游戏过程\n\n游戏开始时，每个玩家手里都会有 $4$ 张牌，且体力上限和初始体力都是 $4$ 。\n\n开始游戏时，从主猪开始，按照逆时针方向（数据中就是按照编号从 $ 1 , 2, 3 \\ldots n , 1 \\ldots $ 的顺序）依次行动。\n\n每个玩家自己的回合可以分为 2 个阶段：\n\n* **摸牌阶段**：从牌堆顶部摸 $2$ 张牌，依次放到手牌的最右边；  \n* **出牌阶段**：你可以使用任意张牌，每次使用牌的时候都使用最靠左的能够使用的牌。当然，要满足如下规则：\n  1. 如果没有猪哥连弩，每个出牌阶段只能使用 $1$ 次「杀」来攻击；\n  2. 任何牌被使用后被弃置（武器是装备上）；被弃置的牌以后都不能再用，即与游戏无关。\n\n### 各种牌介绍\n\n每张手牌用 $1$ 个字母表示，字母代表牌的种类。\n\n#### 基本牌\n\n- 『桃 / $\\texttt{P}$』在自己的回合内，如果自己的体力值不等于体力上限，那么使用 $1$ 个桃可以为自己补充 $1$ 点体力，否则不能使用桃；桃只能对自己使用；在自己的回合外，如果自己的体力变为 $0$ 或者更低，那么也可以使用。\n\n- 『杀 / $\\texttt{K}$』在自己的回合内，对攻击范围内除自己以外的 $1$ 名角色使用。如果没有被『闪』抵消，则造成 $1$ 点伤害。无论有无武器，杀的攻击范围都是 $1$。\n\n- 『闪 / $\\texttt{D}$』当你受到杀的攻击时，可以弃置 $1$ 张闪来抵消杀的效果。\n\n#### 锦囊牌\n\n- 『决斗 / $\\texttt{F}$』出牌阶段，对除自己以外任意 $1$ 名角色使用，由目标角色先开始，自己和目标角色轮流弃置 $1$ 张杀，首先没有杀可弃的一方受到 $1$ 点伤害，另一方视为此伤害的来源。\n\n- 『南猪入侵 / $\\texttt{N}$』出牌阶段，对除你以外所有角色使用，按逆时针顺序从使用者下家开始依次结算，除非弃置 $1$ 张杀，否则受到 $1$ 点伤害。\n\n- 『万箭齐发 / $\\texttt{W}$』和南猪入侵类似，不过要弃置的不是杀而是闪。\n\n- 『无懈可击 / $\\texttt{J}$』在目标锦囊生效前抵消其效果。每次有 $1$ 张锦囊即将生效时，从使用这张锦囊的猪开始，按照逆时针顺序，依次得到使用无懈可击的机会；效果：用于决斗时，决斗无效并弃置；用于南猪入侵或万箭齐发时，当结算到某个角色时才能使用，当前角色不需弃置牌并且不会受到伤害（仅对 $1$ 个角色产生效果）；用于无懈可击时，成为目标的无懈可击被无效。\n\n#### 装备牌\n\n- 『猪哥连弩 / $\\texttt{Z}$』武器，攻击范围 $1$ ，出牌阶段你可以使用任意张杀; 同一时刻最多只能装 $1$ 把武器；如果先前已经有了 $1$ 把武器，那么之后再装武器的话，会弃置以前的武器来装现在的武器。\n\n### 特殊事件及概念解释\n\n* **伤害来源**：杀、南猪入侵、万箭齐发的伤害来源均是使用该牌的猪，决斗的伤害来源如上；\n\n* **距离**：两只猪的距离定义为沿着逆时针方向间隔的猪数 $+1$ 。即初始时 $1$ 和 $2$ 的距离为 $1$ ，但是 $2$ 和 $1$ 的距离就是 $n-1$ 。注意一个角色的死亡会导致一些猪距离的改变；\n\n* **玩家死亡**：如果该玩家的体力降到 $0$ 或者更低，并且自己手中没有足够的桃使得自己的体力值回到 $1$ ，那么就死亡了，死亡后所有的牌（装备区，手牌区）被弃置；\n\n* **奖励与惩罚**：反猪死亡时，最后一个伤害来源处（即使是反猪）立即摸 $3$ 张牌。忠猪死亡时，如果最后一个伤害来源是主猪，那么主猪所有装备牌、手牌被弃置。\n\n注意：一旦达成胜利条件，游戏立刻结束，因此即使会摸 $3$ 张牌或者还有牌可以用也不用执行了。\n\n现在，我们已经知道每只猪的角色、手牌，还有牌堆初始情况，并且假设每个角色会按照如下的行为准则进行游戏，你需要做的就是告诉小猪 iPig 最后的结果。\n\n### 几种行为\n\n* **献殷勤**：使用无懈可击挡下南猪入侵、万箭齐发、决斗；使用无懈可击抵消表敌意；  \n* **表敌意**：对某个角色使用杀、决斗；使用无懈可击抵消献殷勤；  \n* **跳忠**：即通过行动表示自己是忠猪。跳忠行动就是对主猪或对某只已经跳忠的猪献殷勤，或者对某只已经跳反的猪表敌意；  \n* **跳反**：即通过行动表示自己是反猪。跳反行动就是对主猪或对某只已经跳忠的猪表敌意，或者对某只已经跳反的猪献殷勤。\n\n**注意：忠猪不会跳反，反猪也不会跳忠；不管是忠猪还是反猪，能够跳必然跳**。\n\n### 行动准则\n\n#### 共性\n\n* 每个角色如果手里有桃且生命值未满，那么必然吃掉；\n* 有南猪入侵、万箭齐发，必然使用；有装备必然装上；\n* 受到杀时，有闪必然弃置；\n* 响应南猪入侵或者万箭齐发时候，有杀 / 闪必然弃置；\n* 不会对未表明身份的猪献殷勤（**包括自己**）。\n\n#### 特性\n\n - 主猪：\n   + 主猪会认为「没有跳身份，且用南猪入侵 / 万箭齐发对自己造成伤害的猪」是**类**反猪（没伤害到不算，注意类反猪并没有表明身份），如果之后跳了，那么主猪会重新认识这只猪；  \n   + 对于每种表敌意的方式，对逆时针方向能够执行到的第一只类反猪或者已跳反猪表；如果没有，那么就不表敌意；\n   + 决斗时会不遗余力弃置杀；\n   + 如果能对已经跳忠的猪或自己献殷勤，那么一定献；如果能够对已经跳反的猪表敌意，那么一定表。\n - 忠猪：\n   + 对于每种表敌意的方式，对「逆时针方向能够执行到的第一只已经跳反的猪」表，如果没有，那么就不表敌意；\n   + 决斗时，如果对方是主猪，那么不会弃置杀，否则，会不遗余力弃置杀；\n   + 如果有机会对主猪或者已经跳忠的猪献殷勤，那么一定献。\n - 反猪：\n   + 对于每种表敌意的方式，如果有机会则对主猪表，否则，对「逆时针方向能够执行到的第一只已经跳忠的猪」表，如果没有，那么就不表敌意；\n   + 决斗时会不遗余力弃置杀；\n   + 如果有机会对已经跳反的猪献殷勤，那么一定献。\n\n限于 iPig 只会用 P++ 语言写 A + B，他请你用 Pigcal (Pascal)、P (C) 或 P++ (C++) 语言来帮他预测最后的结果。", "inputFormat": "输入文件第一行包含两个正整数 $ n $ $ (2 \\leqslant n \\leqslant 10) $ 和 $m$ $ (m \\leqslant 2000) $，分别代表玩家数和牌堆中牌的数量。数据保证牌的数量够用。\n\n接下来 $n$ 行，每行 $5$ 个字符串，依次表示对第 $i$ 只猪的角色和初始 $4 $ 张手牌描述。编号为 $1$ 的肯定是主猪。\n\n再接下来一行，一共 $m$ 个字符串，按照从牌堆顶部到牌堆底部的顺序描述每张牌。\n\n**注意：所有的相邻的两个字符串都严格用 $1$ 个空格隔开，行尾没有多余空格**。", "outputFormat": "输出数据第一行包含一个字符串代表游戏结果。如果是主猪胜利，那么输出 $\\texttt{MP}$ ，否则输出 $\\texttt{FP}$ 。数据保证游戏总会结束。\n\n接下来 $n$ 行，第 $i$ 行是对第 $i$ 只猪的手牌描述（注意只需要输出手牌），按照手牌从左往右的顺序输出，相邻两张牌用 $1$ 个空格隔开，行末尾没有多余空格。如果这只猪已阵亡，那么只要输出 $\\texttt{DEAD}$ 即可。\n\n**注意：如果要输出手牌而没有手牌的话，那么只需输出 $1$ 个空行**。\n\n**由于数据问题，若牌堆已空，按照每次抽牌抽到的都是最后一张。**", "hint": "### 样例解释\n\n第一回合：\n* 主猪没有目标可以表敌意；\n* 接下来忠猪使用了 $3$ 张南猪入侵，主猪掉了 $3$ 点体力，并认为该角色为类反猪，$3$ 号角色尽管手里有无懈可击，但是因为自己未表明身份，所以同样不能对自己用，乖乖掉 $3$ 点体力；  \n\n下一回合：\n* 反猪无牌可出；\n* 接下来主猪对着类反猪爆发，使用 $4$ 张决斗，忠猪死亡，结果主猪弃掉所有牌；\n* 接下来反猪摸到 $1$ 张杀直接杀死主猪获胜。\n\n### 子任务\n\n一共 $20$ 组测试数据，每个点 $5$ 分。\n\n$10\\%$ 的数据没有锦囊牌，另外 $20\\%$ 的数据没有无懈可击。", "locale": "zh-CN"}}}
{"pid": "P2483", "type": "P", "difficulty": 7, "samples": [["4 6 14.9\n1 2 1.5\n2 1 1.5\n1 3 3\n2 3 1.5\n3 4 1.5\n1 4 1.5\n", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2010", "各省省选", "山东", "O2优化", "最短路", "可并堆", "可持久化", "模板题"], "title": "【模板】k 短路 / [SDOI2010] 魔法猪学院", "background": "注：对于 $k$ 短路问题，A\\* 算法的最坏时间复杂度是 $O(nk \\log n)$ 的。虽然 A\\* 算法可以通过本题原版数据，但可以构造数据，使得 A\\* 算法在原题的数据范围内无法通过。事实上，存在使用可持久化可并堆的算法可以做到在 $O((n+m) \\log n + k \\log k)$ 的时间复杂度解决 $k$ 短路问题。详情见 [OI-Wiki](https://oi-wiki.org/graph/kth-path/)。", "description": "iPig 在假期来到了传说中的魔法猪学院，开始为期两个月的魔法猪训练。经过了一周理论知识和一周基本魔法的学习之后，iPig 对猪世界的世界本原有了很多的了解：众所周知，世界是由元素构成的；元素与元素之间可以互相转换；能量守恒$\\ldots$。\n\n\niPig 今天就在进行一个麻烦的测验。iPig 在之前的学习中已经知道了很多种元素，并学会了可以转化这些元素的魔法，每种魔法需要消耗 iPig 一定的能量。作为 PKU 的顶尖学猪，让 iPig 用最少的能量完成从一种元素转换到另一种元素$\\ldots$等等，iPig 的魔法导猪可没这么笨！这一次，他给 iPig 带来了很多 $1$ 号元素的样本，要求 iPig 使用学习过的魔法将它们一个个转化为 $N$ 号元素，为了增加难度，要求每份样本的转换过程都不相同。这个看似困难的任务实际上对 iPig 并没有挑战性，因为，他有坚实的后盾$\\ldots$现在的你呀！\n\n\n注意，两个元素之间的转化可能有多种魔法，转化是单向的。转化的过程中，可以转化到一个元素（包括开始元素）多次，但是一但转化到目标元素，则一份样本的转化过程结束。iPig 的总能量是有限的，所以最多能够转换的样本数一定是一个有限数。具体请参看样例。", "inputFormat": "第一行三个数 $N, M, E$，表示 iPig 知道的元素个数（元素从 $1$ 到 $N$ 编号），iPig 已经学会的魔法个数和 iPig 的总能量。\n\n后跟 $M$ 行每行三个数 $s_i, t_i, e_i$ 表示 iPig 知道一种魔法，消耗 $e_i$ 的能量将元素 $s_i$ 变换到元素 $t_i$。", "outputFormat": "一行一个数，表示最多可以完成的方式数。输入数据保证至少可以完成一种方式。", "hint": "有意义的转换方式共 $4$ 种：\n\n$1\\to 4$，消耗能量 $1.5$。\n\n$1\\to 2\\to 1\\to 4$，消耗能量 $4.5$。\n\n$1\\to3\\to4$，消耗能量 $4.5$。\n\n$1\\to2\\to3\\to4$，消耗能量 $4.5$。\n\n显然最多只能完成其中的 $3$ 种转换方式（选第一种方式，后三种方式任选两个），即最多可以转换 $3$ 份样本。\n\n如果将 $E=14.9$ 改为 $E=15$，则可以完成以上全部方式，答案变为 $4$。\n\n### 数据规模\n\n占总分不小于 $10\\%$ 的数据满足 $N \\leq 6,M \\leq 15$。\n\n占总分不小于 $20\\%$ 的数据满足 $N \\leq 100,M \\leq 300,E\\leq100$ 且 $E$ 和所有的 $e_i$ 均为整数（可以直接作为整型数字读入）。\n\n所有数据满足 $2 \\leq N \\leq 5000$，$1 \\leq M \\leq 200000$，$1 \\leq E \\leq 10 ^ 7$，$1 \\leq e_i\\leq E$，$E$ 和所有的 $e_i$ 为实数。\n\n### 数据更新日志\n\n- 2010/xx/xx：原版数据；\n- 2018/03/02：@[kczno1](/user/9168) 添加了 [一组数据](/discuss/35616)；\n- 2018/04/20：@[X_o_r](/user/25188) 添加了 [一组数据](/discuss/40205)；\n- 2021/01/08：@[LeavingZ](/user/215697) 添加了 [两组数据](/discuss/291028)。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] k Shortest Paths / [SDOI2010] Magic Pig Academy", "background": "Note: For the $k$ shortest paths problem, the A\\* algorithm has a worst-case time complexity of $O(nk \\log n)$. Although A\\* can pass the original testdata of this problem, one can construct cases where A\\* fails within the original constraints. In fact, there is an approach using a persistent meldable heap that solves the $k$ shortest paths problem in $O((n+m) \\log n + k \\log k)$ time. For details, see OI-Wiki: https://oi-wiki.org/graph/kth-path/.", "description": "iPig has arrived at the legendary Magic Pig Academy for a two-month training program. After one week of theory and one week of basic magic, iPig has learned a lot about the fundamentals of the pig world: as everyone knows, the world is made of elements; elements can be transformed into one another; energy is conserved $\\ldots$\n\nToday iPig is taking a tricky test. From previous learning, iPig already knows many kinds of elements and has learned spells that can transform these elements, each consuming some energy. As a top student from PKU, using the least energy to transform one element into another $\\ldots$ well, iPig’s magic instructor isn’t that naive! This time, the instructor has brought many samples of element $1$ and requires iPig to transform them one by one into element $N$ using learned spells. To make it harder, each sample must follow a different conversion process. This seemingly difficult task is actually not a challenge for iPig, because he has a solid backup $\\ldots$ you!\n\nNote that there can be multiple spells for transforming between two elements, and transformations are one-way. During a conversion, an element (including the starting element) may be visited multiple times, but once the target element is reached, that sample’s conversion process ends. iPig’s total energy is limited, so the maximum number of samples he can convert is finite. See the example for details.", "inputFormat": "The first line contains three numbers $N, M, E$, representing the number of known elements (numbered from $1$ to $N$), the number of learned spells, and iPig’s total energy.\n\nThen follow $M$ lines, each containing three numbers $s_i, t_i, e_i$, indicating a known spell that transforms element $s_i$ to element $t_i$ while consuming energy $e_i$.", "outputFormat": "Output a single integer: the maximum number of distinct conversion processes that can be completed. The input guarantees that at least one way exists.", "hint": "There are $4$ meaningful conversion processes:\n\n$1\\to 4$, consuming energy $1.5$.\n\n$1\\to 2\\to 1\\to 4$, consuming energy $4.5$.\n\n$1\\to 3\\to 4$, consuming energy $4.5$.\n\n$1\\to 2\\to 3\\to 4$, consuming energy $4.5$.\n\nClearly, at most $3$ of these conversion processes can be completed (choose the first one, and any two of the remaining three), i.e., at most $3$ samples can be converted.\n\nIf $E=14.9$ is changed to $E=15$, then all of the above processes can be completed, and the answer becomes $4$.\n\n# Input Format\n\n# Output Format\n\n# Hint\n\n# Constraints\n\n- At least $10\\%$ of the total score: $N \\leq 6$, $M \\leq 15$.\n- At least $20\\%$ of the total score: $N \\leq 100$, $M \\leq 300$, $E \\leq 100$, and $E$ and all $e_i$ are integers (they can be read as integer types directly).\n- For all testdata: $2 \\leq N \\leq 5000$, $1 \\leq M \\leq 200000$, $1 \\leq E \\leq 10^7$, $1 \\leq e_i \\leq E$, and $E$ and all $e_i$ are real numbers.\n\n# Data Update Log\n\n- 2010/xx/xx: Original testdata.\n- 2018/03/02: @[kczno1](/user/9168) added [a set of testdata](/discuss/35616).\n- 2018/04/20: @[X_o_r](/user/25188) added [a set of testdata](/discuss/40205).\n- 2021/01/08: @[LeavingZ](/user/215697) added [two sets of testdata](/discuss/291028).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】k 短路 / [SDOI2010] 魔法猪学院", "background": "注：对于 $k$ 短路问题，A\\* 算法的最坏时间复杂度是 $O(nk \\log n)$ 的。虽然 A\\* 算法可以通过本题原版数据，但可以构造数据，使得 A\\* 算法在原题的数据范围内无法通过。事实上，存在使用可持久化可并堆的算法可以做到在 $O((n+m) \\log n + k \\log k)$ 的时间复杂度解决 $k$ 短路问题。详情见 [OI-Wiki](https://oi-wiki.org/graph/kth-path/)。", "description": "iPig 在假期来到了传说中的魔法猪学院，开始为期两个月的魔法猪训练。经过了一周理论知识和一周基本魔法的学习之后，iPig 对猪世界的世界本原有了很多的了解：众所周知，世界是由元素构成的；元素与元素之间可以互相转换；能量守恒$\\ldots$。\n\n\niPig 今天就在进行一个麻烦的测验。iPig 在之前的学习中已经知道了很多种元素，并学会了可以转化这些元素的魔法，每种魔法需要消耗 iPig 一定的能量。作为 PKU 的顶尖学猪，让 iPig 用最少的能量完成从一种元素转换到另一种元素$\\ldots$等等，iPig 的魔法导猪可没这么笨！这一次，他给 iPig 带来了很多 $1$ 号元素的样本，要求 iPig 使用学习过的魔法将它们一个个转化为 $N$ 号元素，为了增加难度，要求每份样本的转换过程都不相同。这个看似困难的任务实际上对 iPig 并没有挑战性，因为，他有坚实的后盾$\\ldots$现在的你呀！\n\n\n注意，两个元素之间的转化可能有多种魔法，转化是单向的。转化的过程中，可以转化到一个元素（包括开始元素）多次，但是一但转化到目标元素，则一份样本的转化过程结束。iPig 的总能量是有限的，所以最多能够转换的样本数一定是一个有限数。具体请参看样例。", "inputFormat": "第一行三个数 $N, M, E$，表示 iPig 知道的元素个数（元素从 $1$ 到 $N$ 编号），iPig 已经学会的魔法个数和 iPig 的总能量。\n\n后跟 $M$ 行每行三个数 $s_i, t_i, e_i$ 表示 iPig 知道一种魔法，消耗 $e_i$ 的能量将元素 $s_i$ 变换到元素 $t_i$。", "outputFormat": "一行一个数，表示最多可以完成的方式数。输入数据保证至少可以完成一种方式。", "hint": "有意义的转换方式共 $4$ 种：\n\n$1\\to 4$，消耗能量 $1.5$。\n\n$1\\to 2\\to 1\\to 4$，消耗能量 $4.5$。\n\n$1\\to3\\to4$，消耗能量 $4.5$。\n\n$1\\to2\\to3\\to4$，消耗能量 $4.5$。\n\n显然最多只能完成其中的 $3$ 种转换方式（选第一种方式，后三种方式任选两个），即最多可以转换 $3$ 份样本。\n\n如果将 $E=14.9$ 改为 $E=15$，则可以完成以上全部方式，答案变为 $4$。\n\n### 数据规模\n\n占总分不小于 $10\\%$ 的数据满足 $N \\leq 6,M \\leq 15$。\n\n占总分不小于 $20\\%$ 的数据满足 $N \\leq 100,M \\leq 300,E\\leq100$ 且 $E$ 和所有的 $e_i$ 均为整数（可以直接作为整型数字读入）。\n\n所有数据满足 $2 \\leq N \\leq 5000$，$1 \\leq M \\leq 200000$，$1 \\leq E \\leq 10 ^ 7$，$1 \\leq e_i\\leq E$，$E$ 和所有的 $e_i$ 为实数。\n\n### 数据更新日志\n\n- 2010/xx/xx：原版数据；\n- 2018/03/02：@[kczno1](/user/9168) 添加了 [一组数据](/discuss/35616)；\n- 2018/04/20：@[X_o_r](/user/25188) 添加了 [一组数据](/discuss/40205)；\n- 2021/01/08：@[LeavingZ](/user/215697) 添加了 [两组数据](/discuss/291028)。", "locale": "zh-CN"}}}
{"pid": "P2484", "type": "P", "difficulty": 5, "samples": [["3 3\n1 2 1\n2 4 2\n1 2 1\n", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2011", "各省省选", "山东", "前缀和", "其它技巧"], "title": "[SDOI2011] 打地鼠", "background": null, "description": "2020.4.29 数据更新。\n\n打地鼠是这样的一个游戏：地面上有一些地鼠洞，地鼠们会不时从洞里探出头来很短时间后又缩回洞中。玩家的目标是在地鼠伸出头时，用锤子砸其头部，砸到的地鼠越多分数也就越高。\n\n游戏中的锤子每次只能打一只地鼠，如果多只地鼠同时探出头，玩家只能通过多次挥舞锤子的方式打掉所有的地鼠。你认为这锤子太没用了，所以你改装了锤子，增加了锤子与地面的接触面积，使其每次可以击打一片区域。如果我们把地面看做 $m\\times n$ 的方阵，其每个元素都代表一个地鼠洞，那么锤子可以覆盖 $r\\times c$ 区域内的所有地鼠洞。但是改装后的锤子有一个缺点：每次挥舞锤子时，对于这的区域中的所有地洞，锤子会打掉恰好一只地鼠。也就是说锤子覆盖的区域中，每个地洞必须至少有 $1$ 只地鼠，且如果某个地洞中地鼠的个数大于 $1$，那么这个地洞只会有 $1$ 只地鼠被打掉，因此每次挥舞锤子时，恰好有 $r\\times c$ 只地鼠被打掉。由于锤子的内部结构过于精密，因此在游戏过程中你不能旋转锤子（即不能互换 $r$ 和 $c$）。\n\n你可以任意更改锤子的规格(即你可以任意规定 $r$ 和 $c$ 的大小)，但是改装锤子的工作只能在打地鼠前进行(即你不可以打掉一部分地鼠后，再改变锤子的规格)。你的任务是求出要想打掉所有的地鼠，至少需要挥舞锤子的次数。\n\nHint：由于你可以把锤子的大小设置为 $1\\times 1$，因此本题总是有解的。", "inputFormat": "第一行包含两个正整数 $m$ 和 $n$；\n\n下面 $m$ 行每行 $n$ 个正整数描述地图，每个数字表示相应位置的地洞中地鼠的数量。", "outputFormat": "输出一个整数，表示最少的挥舞次数。", "hint": "【样例说明】\n\n使用 $2\\times 2$ 的锤子，分别在左上、左下、右上、右下挥舞一次。\n\n【数据规模和约定】\n\n对于 $30\\%$ 的数据，$m$, $n\\leq 5$ ；\n\n对于 $60\\%$ 的数据，$m$, $n\\leq 30$ ；\n\n对于 $100\\%$ 的数据，$1\\leq m$, $n\\leq 100$ ，其他数据不小于 $0$，不大于 $10^5$ 。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2011] Whac-A-Mole", "background": "", "description": "2020-04-29 testdata updated.\n\nWhac-A-Mole works like this: there are several mole holes on the ground, and moles will occasionally pop their heads out and then retract after a short time. The player's goal is to strike the mole's head with a hammer when it pops out; the more moles hit, the higher the score.\n\nIn the game, the hammer can hit only one mole per swing. If multiple moles pop out at the same time, the player must swing multiple times to hit them all. You think this hammer is too weak, so you modify it to increase the contact area with the ground so that it can hit a whole region at once. If we view the ground as an $m \\times n$ grid where each cell is a mole hole, then the hammer can cover all holes in an $r \\times c$ region. However, the modified hammer has a drawback: each time you swing it, within that region the hammer removes exactly one mole from each hole. In other words, every hole in the covered region must contain at least $1$ mole, and if a hole contains more than $1$ mole, only $1$ mole in that hole will be removed. Therefore, each swing removes exactly $r \\times c$ moles. Because the hammer's internal structure is very delicate, you cannot rotate the hammer during the game (i.e., you cannot swap $r$ and $c$).\n\nYou may choose any hammer size (i.e., any $r$ and $c$), but you can only do this before playing (i.e., you cannot change the hammer size after removing some moles). Your task is to find the minimum number of swings needed to remove all moles.\n\nHint: Since you can set the hammer size to $1 \\times 1$, this problem always has a solution.", "inputFormat": "The first line contains two positive integers $m$ and $n$.\n\nEach of the next $m$ lines contains $n$ non-negative integers describing the grid; each number is the number of moles in the corresponding hole.", "outputFormat": "Print one integer, the minimum number of swings.", "hint": "Sample Explanation:\n\nUsing a $2 \\times 2$ hammer, swing once at each of the four positions: upper-left, lower-left, upper-right, and lower-right.\n\nConstraints and Conventions:\n\n- For $30\\%$ of the testdata, $m, n \\leq 5$.\n- For $60\\%$ of the testdata, $m, n \\leq 30$.\n- For $100\\%$ of the testdata, $1 \\leq m, n \\leq 100$. All other numbers are between $0$ and $10^5$ inclusive.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2011] 打地鼠", "background": null, "description": "2020.4.29 数据更新。\n\n打地鼠是这样的一个游戏：地面上有一些地鼠洞，地鼠们会不时从洞里探出头来很短时间后又缩回洞中。玩家的目标是在地鼠伸出头时，用锤子砸其头部，砸到的地鼠越多分数也就越高。\n\n游戏中的锤子每次只能打一只地鼠，如果多只地鼠同时探出头，玩家只能通过多次挥舞锤子的方式打掉所有的地鼠。你认为这锤子太没用了，所以你改装了锤子，增加了锤子与地面的接触面积，使其每次可以击打一片区域。如果我们把地面看做 $m\\times n$ 的方阵，其每个元素都代表一个地鼠洞，那么锤子可以覆盖 $r\\times c$ 区域内的所有地鼠洞。但是改装后的锤子有一个缺点：每次挥舞锤子时，对于这的区域中的所有地洞，锤子会打掉恰好一只地鼠。也就是说锤子覆盖的区域中，每个地洞必须至少有 $1$ 只地鼠，且如果某个地洞中地鼠的个数大于 $1$，那么这个地洞只会有 $1$ 只地鼠被打掉，因此每次挥舞锤子时，恰好有 $r\\times c$ 只地鼠被打掉。由于锤子的内部结构过于精密，因此在游戏过程中你不能旋转锤子（即不能互换 $r$ 和 $c$）。\n\n你可以任意更改锤子的规格(即你可以任意规定 $r$ 和 $c$ 的大小)，但是改装锤子的工作只能在打地鼠前进行(即你不可以打掉一部分地鼠后，再改变锤子的规格)。你的任务是求出要想打掉所有的地鼠，至少需要挥舞锤子的次数。\n\nHint：由于你可以把锤子的大小设置为 $1\\times 1$，因此本题总是有解的。", "inputFormat": "第一行包含两个正整数 $m$ 和 $n$；\n\n下面 $m$ 行每行 $n$ 个正整数描述地图，每个数字表示相应位置的地洞中地鼠的数量。", "outputFormat": "输出一个整数，表示最少的挥舞次数。", "hint": "【样例说明】\n\n使用 $2\\times 2$ 的锤子，分别在左上、左下、右上、右下挥舞一次。\n\n【数据规模和约定】\n\n对于 $30\\%$ 的数据，$m$, $n\\leq 5$ ；\n\n对于 $60\\%$ 的数据，$m$, $n\\leq 30$ ；\n\n对于 $100\\%$ 的数据，$1\\leq m$, $n\\leq 100$ ，其他数据不小于 $0$，不大于 $10^5$ 。", "locale": "zh-CN"}}}
{"pid": "P2485", "type": "P", "difficulty": 5, "samples": [["3 1\n2 1 3\n2 2 3\n2 3 3\n", "2\n1\n2\n"], ["3 2\n2 1 3\n2 2 3\n2 3 3\n", "2\n1\n0\n"], ["4 3\n2 1 3\n2 2 3\n2 3 3\n2 4 3\n", "0\n1\nOrz, I cannot find x!\n0\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2011", "各省省选", "山东", "O2优化", "素数判断,质数,筛法", "最大公约数 gcd", "逆元", "大步小步算法 BSGS"], "title": "[SDOI2011] 计算器", "background": "2024-8-11 update: 新增一组 hack。", "description": "你被要求设计一个计算器完成以下三项任务：\n\n1. 给定 $y,z,p$，计算 $y^z \\bmod p$ 的值；\n2. 给定 $y,z,p$，计算满足 $xy \\equiv z \\pmod p$ 的最小非负整数 $x$；\n3. 给定 $y,z,p$，计算满足 $y^x \\equiv z \\pmod p$ 的最小非负整数 $x$。\n\n为了拿到奖品，全力以赴吧！\n", "inputFormat": "输入文件包含多组数据。\n\n第一行包含两个正整数 $T,K$，分别表示数据组数和询问类型（对于一个测试点内的所有数据，询问类型相同）。\n\n以下 $T$ 行每行包含三个正整数 $y,z,p$，描述一个询问。", "outputFormat": "输出文件包括 $T$ 行。\n\n对于每个询问，输出一行答案。\n\n对于询问类型 2 和 3，如果不存在满足条件的，则输出 `Orz, I cannot find x!`。", "hint": "测试点共分为三类，各类测试点占总测试点的比例如下：\n\n| $K=$ | 测试点占比 |\n| :--: | :--------: |\n| $1$  |   $20\\%$   |\n| $2$  |   $35\\%$   |\n| $3$  |   $45\\%$   |\n\n所有数据均满足：$1 \\leq y,z,p \\leq 10^9$，$p$ 是质数，$1 \\leq T \\leq 10$。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2011] Calculator", "background": "2024-08-11 update: Added a new hack.", "description": "You are asked to design a calculator to complete the following three tasks:\n\n1. Given $y, z, p$, compute the value of $y^z \\bmod p$.\n2. Given $y, z, p$, compute the smallest non-negative integer $x$ such that $xy \\equiv z \\pmod p$.\n3. Given $y, z, p$, compute the smallest non-negative integer $x$ such that $y^x \\equiv z \\pmod p$.\n\nDo your best to win the prize!", "inputFormat": "The input contains multiple test cases.\n\nThe first line contains two positive integers $T, K$, denoting the number of test cases and the query type, respectively (for all testdata within a single test point, the query type is the same).\n\nEach of the following $T$ lines contains three positive integers $y, z, p$, describing one query.", "outputFormat": "The output contains $T$ lines.\n\nFor each query, output one line with the answer.\n\nFor query types $2$ and $3$, if no solution exists, output `Orz, I cannot find x!`.", "hint": "Test points are divided into three categories. The proportion of each category among all test points is as follows:\n\n| $K=$ | Proportion of test points |\n| :--: | :-----------------------: |\n| $1$  |          $20\\%$           |\n| $2$  |          $35\\%$           |\n| $3$  |          $45\\%$           |\n\nAll testdata satisfy: $1 \\leq y, z, p \\leq 10^9$, $p$ is prime, and $1 \\leq T \\leq 10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2011] 计算器", "background": "2024-8-11 update: 新增一组 hack。", "description": "你被要求设计一个计算器完成以下三项任务：\n\n1. 给定 $y,z,p$，计算 $y^z \\bmod p$ 的值；\n2. 给定 $y,z,p$，计算满足 $xy \\equiv z \\pmod p$ 的最小非负整数 $x$；\n3. 给定 $y,z,p$，计算满足 $y^x \\equiv z \\pmod p$ 的最小非负整数 $x$。\n\n为了拿到奖品，全力以赴吧！\n", "inputFormat": "输入文件包含多组数据。\n\n第一行包含两个正整数 $T,K$，分别表示数据组数和询问类型（对于一个测试点内的所有数据，询问类型相同）。\n\n以下 $T$ 行每行包含三个正整数 $y,z,p$，描述一个询问。", "outputFormat": "输出文件包括 $T$ 行。\n\n对于每个询问，输出一行答案。\n\n对于询问类型 2 和 3，如果不存在满足条件的，则输出 `Orz, I cannot find x!`。", "hint": "测试点共分为三类，各类测试点占总测试点的比例如下：\n\n| $K=$ | 测试点占比 |\n| :--: | :--------: |\n| $1$  |   $20\\%$   |\n| $2$  |   $35\\%$   |\n| $3$  |   $45\\%$   |\n\n所有数据均满足：$1 \\leq y,z,p \\leq 10^9$，$p$ 是质数，$1 \\leq T \\leq 10$。", "locale": "zh-CN"}}}
{"pid": "P2486", "type": "P", "difficulty": 6, "samples": [["6 5\n2 2 1 2 1 1\n1 2\n1 3\n2 4\n2 5\n2 6\nQ 3 5\nC 2 1 1\nQ 3 5\nC 5 1 2\nQ 3 5\n", "3\n1\n2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "线段树", "各省省选", "颜色段均摊（珂朵莉树 ODT）", "山东", "树链剖分", "动态树 LCT"], "title": "[SDOI2011] 染色", "background": "", "description": "给定一棵 $n$ 个节点的无根树，共有 $m$  个操作，操作分为两种：\n\n1. 将节点 $a$ 到节点 $b$ 的路径上的所有点（包括 $a$ 和 $b$）都染成颜色 $c$。\n2. 询问节点 $a$ 到节点 $b$ 的路径上的颜色段数量。\n\n颜色段的定义是极长的连续相同颜色被认为是一段。例如 `112221` 由三段组成：`11`、`222`、`1`。", "inputFormat": "输入的第一行是用空格隔开的两个整数，分别代表树的节点个数 $n$ 和操作个数 $m$。\n\n第二行有 $n$ 个用空格隔开的整数，第 $i$ 个整数 $w_i$ 代表结点 $i$ 的初始颜色。\n\n第 $3$ 到第 $(n + 1)$ 行，每行两个用空格隔开的整数 $u, v$，代表树上存在一条连结节点 $u$ 和节点 $v$ 的边。\n\n第 $(n + 2)$ 到第 $(n + m + 1)$ 行，每行描述一个操作，其格式为：\n\n每行首先有一个字符 $op$，代表本次操作的类型。\n\n- 若 $op$ 为 `C`，则代表本次操作是一次染色操作，在一个空格后有三个用空格隔开的整数 $a, b, c$，代表将 $a$ 到 $b$ 的路径上所有点都染成颜色 $c$。\n- 若 $op$ 为 `Q`，则代表本次操作是一次查询操作，在一个空格后有两个用空格隔开的整数 $a, b$，表示查询 $a$ 到 $b$ 路径上的颜色段数量。", "outputFormat": "对于每次查询操作，输出一行一个整数代表答案。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1 \\leq n, m \\leq 10^5$，$1 \\leq w_i, c \\leq 10^9$，$1 \\leq a, b, u, v \\leq n$，$op$ 一定为 `C` 或 `Q`，保证给出的图是一棵树。\n\n除原数据外，还存在一组不计分的 hack 数据。\n", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2011] Coloring", "background": "", "description": "Given an unrooted tree with $n$ nodes, there are $m$ operations of two types:\n\n1. Color all nodes on the path from node $a$ to node $b$ (including $a$ and $b$) with color $c$.\n2. Query the number of color segments on the path from node $a$ to node $b$.\n\nA color segment is defined as a maximal consecutive run of the same color. For example, `112221` consists of three segments: `11`, `222`, `1`.", "inputFormat": "The first line contains two integers separated by a space, representing the number of nodes $n$ and the number of operations $m$.\n\nThe second line contains $n$ integers separated by spaces. The $i$-th integer $w_i$ represents the initial color of node $i$.\n\nLines $3$ through $(n + 1)$ each contain two integers $u, v$ separated by a space, indicating that there is an edge between nodes $u$ and $v$ in the tree.\n\nLines $(n + 2)$ through $(n + m + 1)$ each describe an operation in the following format:\n\nEach line starts with a character $op$, indicating the type of operation.\n\n- If $op$ is `C`, it denotes a coloring operation. After a space, there are three integers $a, b, c$ separated by spaces, meaning that all nodes on the path from $a$ to $b$ are colored with color $c$.\n- If $op$ is `Q`, it denotes a query operation. After a space, there are two integers $a, b$ separated by a space, indicating a query for the number of color segments on the path from $a$ to $b$.", "outputFormat": "For each query operation, output a single line containing one integer representing the answer.", "hint": "#### Constraints\n\nFor $100\\%$ of the testdata, $1 \\leq n, m \\leq 10^5$, $1 \\leq w_i, c \\leq 10^9$, $1 \\leq a, b, u, v \\leq n$, $op$ is guaranteed to be `C` or `Q`, and the given graph is a tree.\n\nIn addition to the original testdata, there exists a non-scoring set of hack testdata.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2011] 染色", "background": "", "description": "给定一棵 $n$ 个节点的无根树，共有 $m$  个操作，操作分为两种：\n\n1. 将节点 $a$ 到节点 $b$ 的路径上的所有点（包括 $a$ 和 $b$）都染成颜色 $c$。\n2. 询问节点 $a$ 到节点 $b$ 的路径上的颜色段数量。\n\n颜色段的定义是极长的连续相同颜色被认为是一段。例如 `112221` 由三段组成：`11`、`222`、`1`。", "inputFormat": "输入的第一行是用空格隔开的两个整数，分别代表树的节点个数 $n$ 和操作个数 $m$。\n\n第二行有 $n$ 个用空格隔开的整数，第 $i$ 个整数 $w_i$ 代表结点 $i$ 的初始颜色。\n\n第 $3$ 到第 $(n + 1)$ 行，每行两个用空格隔开的整数 $u, v$，代表树上存在一条连结节点 $u$ 和节点 $v$ 的边。\n\n第 $(n + 2)$ 到第 $(n + m + 1)$ 行，每行描述一个操作，其格式为：\n\n每行首先有一个字符 $op$，代表本次操作的类型。\n\n- 若 $op$ 为 `C`，则代表本次操作是一次染色操作，在一个空格后有三个用空格隔开的整数 $a, b, c$，代表将 $a$ 到 $b$ 的路径上所有点都染成颜色 $c$。\n- 若 $op$ 为 `Q`，则代表本次操作是一次查询操作，在一个空格后有两个用空格隔开的整数 $a, b$，表示查询 $a$ 到 $b$ 路径上的颜色段数量。", "outputFormat": "对于每次查询操作，输出一行一个整数代表答案。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1 \\leq n, m \\leq 10^5$，$1 \\leq w_i, c \\leq 10^9$，$1 \\leq a, b, u, v \\leq n$，$op$ 一定为 `C` 或 `Q`，保证给出的图是一棵树。\n\n除原数据外，还存在一组不计分的 hack 数据。\n", "locale": "zh-CN"}}}
{"pid": "P2487", "type": "P", "difficulty": 6, "samples": [["4\n3 30\n4 40\n6 60\n3 30\n", "2\n0.33333 0.33333 0.33333 1.00000\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "2011", "各省省选", "树状数组", "山东", "cdq 分治", "Special Judge", "分治", "动态规划优化"], "title": "[SDOI2011] 拦截导弹", "background": "", "description": "某国为了防御敌国的导弹袭击，发展出一种导弹拦截系统。但是这种导弹拦截系统有一个缺陷：虽然它的第一发炮弹能够到达任意的高度、并且能够拦截任意速度的导弹，但是以后每一发炮弹都不能高于前一发的高度，其拦截的导弹的飞行速度也不能大于前一发。某天，雷达捕捉到敌国的导弹来袭。由于该系统还在试用阶段，所以只有一套系统，因此有可能不能拦截所有的导弹。\n\n在不能拦截所有的导弹的情况下，我们当然要选择使国家损失最小、也就是拦截导弹的数量最多的方案。但是拦截导弹数量的最多的方案有可能有多个，如果有多个最优方案，那么我们会随机选取一个作为最终的拦截导弹行动蓝图。\n\n我方间谍已经获取了所有敌军导弹的高度和速度，你的任务是计算出在执行上述决策时，每枚导弹被拦截掉的概率。\n", "inputFormat": "\n\n第一行包含一个正整数 $n$，表示敌军导弹数量。\n\n下面 $n$ 行按顺序给出了敌军所有导弹信息。第 $i+1$\n 行包含两个正整数 $h_i$ 和 $v_i$，分别表示第 $i$ 枚导弹的高度和速度。", "outputFormat": "\n\n输出包含两行。\n\n第一行为一个正整数，表示最多能拦截掉的导弹数量；\n\n第二行包含 $n$ 个 $0$ 到 $1$ 之间的实数，第 $i$ 个数字表示第 $i$ 枚导弹被拦截的概率（你可以保留任意多位有效数字）。", "hint": "\n\n保证总方案数不超过 C++ 中 double 类型的存储范围。\n\n### 数据范围及约定\n\n- 均匀分布着约 $30\\%$ 的数据，所有 $v_i$ 均相等；\n- 均匀分布着约 $50\\%$ 的数据，满足 $1\\le h_i,v_i\\le 1000$。\n- 对于 $30\\%$ 的数据，满足 $1\\le n\\le 1000$；\n- 对于 $100\\%$ 的数据，$1\\le n\\le 5\\times 10^4$，$1\\le h_i,v_i\\le 10^9$。\n\n### 评分标准\n\n对于每个测试点，若输出的第一行与标准输出相同，则得到该测试点 $40\\%$ 的分数，若输出文件的第二行的每个数与标准输出的误差均不大于 $10^{-4}$，则得到该测试点 $60\\%$ 的分数，两项相加作为该测试点总得分。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2011] Missile Interception", "background": "", "description": "A country has developed a missile interception system to defend against incoming enemy missiles. However, this system has a flaw: although the first shell can reach any height and intercept a missile of any speed, each subsequent shell cannot exceed the height of the previous one, and the speed of the missile it intercepts cannot exceed that of the previous one. One day, the radar detects an incoming enemy missile attack. Since the system is still in trial use, there is only one set available, so it may not be able to intercept all missiles.\n\nIf not all missiles can be intercepted, we certainly want to minimize losses, that is, choose a plan that intercepts the maximum number of missiles. However, there may be multiple optimal plans that intercept the maximum number of missiles. If there are multiple optimal plans, we will choose one uniformly at random as the final interception plan.\n\nOur spies have obtained the height and speed of every enemy missile. Your task is to compute, under the decision process described above, the probability that each missile is intercepted.", "inputFormat": "The first line contains a positive integer $n$, the number of enemy missiles.\n\nThe next $n$ lines give all missiles in order. The $(i+1)$-th line contains two positive integers $h_i$ and $v_i$, denoting the height and speed of the $i$-th missile.", "outputFormat": "Output two lines.\n\nThe first line contains a single positive integer, the maximum number of missiles that can be intercepted.\n\nThe second line contains $n$ real numbers between $0$ and $1$, where the $i$-th number is the probability that the $i$-th missile is intercepted (you may keep any number of significant digits).", "hint": "The total number of optimal plans does not exceed the storage range of C++ double.\n\nConstraints\n- Approximately $30\\%$ of the testdata have all $v_i$ equal.\n- Approximately $50\\%$ of the testdata satisfy $1 \\le h_i, v_i \\le 1000$.\n- For $30\\%$ of the testdata, $1 \\le n \\le 1000$.\n- For $100\\%$ of the testdata, $1 \\le n \\le 5 \\times 10^4$, $1 \\le h_i, v_i \\le 10^9$.\n\nScoring\n- For each test point, if the first line of your output matches the standard answer, you receive $40\\%$ of the score for that test point.\n- If, in addition, every number on the second line has an absolute error no greater than $10^{-4}$ compared to the standard answer, you receive the remaining $60\\%$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2011] 拦截导弹", "background": "", "description": "某国为了防御敌国的导弹袭击，发展出一种导弹拦截系统。但是这种导弹拦截系统有一个缺陷：虽然它的第一发炮弹能够到达任意的高度、并且能够拦截任意速度的导弹，但是以后每一发炮弹都不能高于前一发的高度，其拦截的导弹的飞行速度也不能大于前一发。某天，雷达捕捉到敌国的导弹来袭。由于该系统还在试用阶段，所以只有一套系统，因此有可能不能拦截所有的导弹。\n\n在不能拦截所有的导弹的情况下，我们当然要选择使国家损失最小、也就是拦截导弹的数量最多的方案。但是拦截导弹数量的最多的方案有可能有多个，如果有多个最优方案，那么我们会随机选取一个作为最终的拦截导弹行动蓝图。\n\n我方间谍已经获取了所有敌军导弹的高度和速度，你的任务是计算出在执行上述决策时，每枚导弹被拦截掉的概率。\n", "inputFormat": "\n\n第一行包含一个正整数 $n$，表示敌军导弹数量。\n\n下面 $n$ 行按顺序给出了敌军所有导弹信息。第 $i+1$\n 行包含两个正整数 $h_i$ 和 $v_i$，分别表示第 $i$ 枚导弹的高度和速度。", "outputFormat": "\n\n输出包含两行。\n\n第一行为一个正整数，表示最多能拦截掉的导弹数量；\n\n第二行包含 $n$ 个 $0$ 到 $1$ 之间的实数，第 $i$ 个数字表示第 $i$ 枚导弹被拦截的概率（你可以保留任意多位有效数字）。", "hint": "\n\n保证总方案数不超过 C++ 中 double 类型的存储范围。\n\n### 数据范围及约定\n\n- 均匀分布着约 $30\\%$ 的数据，所有 $v_i$ 均相等；\n- 均匀分布着约 $50\\%$ 的数据，满足 $1\\le h_i,v_i\\le 1000$。\n- 对于 $30\\%$ 的数据，满足 $1\\le n\\le 1000$；\n- 对于 $100\\%$ 的数据，$1\\le n\\le 5\\times 10^4$，$1\\le h_i,v_i\\le 10^9$。\n\n### 评分标准\n\n对于每个测试点，若输出的第一行与标准输出相同，则得到该测试点 $40\\%$ 的分数，若输出文件的第二行的每个数与标准输出的误差均不大于 $10^{-4}$，则得到该测试点 $60\\%$ 的分数，两项相加作为该测试点总得分。", "locale": "zh-CN"}}}
{"pid": "P2488", "type": "P", "difficulty": 6, "samples": [["2 3\r\n2 2 2\r\n1 1 0\r\n0 0 1\r\n1\r\n2\r\n1 10\r\n1\r\n2\r\n1 6", "24"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "各省省选", "山东", "费用流"], "title": "[SDOI2011] 工作安排", "background": "", "description": "\n你的公司接到了一批订单。订单要求你的公司提供 $n$ 类产品，产品被编号为 $1 \\sim n$，其中第 $i$ 类产品共需要 $C_i$ 件。公司共有 $m$ 名员工，员工被编号为 $1 \\sim m$ 员工能够制造的产品种类有所区别。一件产品必须完整地由一名员工制造，不可以由某名员工制造一部分配件后，再转交给另外一名员工继续进行制造。\n\n我们用一个由 $0$ 和 $1$ 组成的 $m \\times n$ 的矩阵 $A$ 来描述每名员工能够制造哪些产品。矩阵的行和列分别被编号为 $1 \\sim m$ 和 $1 \\sim n$，$A_i,j$ 为 $1$ 表示员工 $i$ 能够制造产品 $j$，为 $0$ 表示员工 $i$ 不能制造产品 $j$。\n\n如果公司分配了过多工作给一名员工，这名员工会变得不高兴。我们用愤怒值来描述某名员工的心情状态。愤怒值越高，表示这名员工心情越不爽，愤怒值越低，表示这名员工心情越愉快。员工的愤怒值与他被安排制造的产品数量存在某函数关系，鉴于员工们的承受能力不同，不同员工之间的函数关系也是有所区别的。\n\n对于员工 $i$，他的愤怒值与产品数量之间的函数是一个 $S_i+1$ 段的分段函数。当他制造第 $1 \\sim T_{i,1}$ 件产品时，每件产品会使他的愤怒值增加 $W_{i,1}$，当他制造第 $T_{i,1}+1 \\sim T_{i,2}$ 件产品时，每件产品会使他的愤怒值增加 $W_{i,2}$ ……为描述方便，设 $T_{i,0}=0,T_{i,s_{i+1}}=+\\infty$，那么当他制造第 $T_{i,j-1}+1 \\sim T_{i,j}$ 件产品时，每件产品会使他的愤怒值增加 $W_{i,j}$，$1 \\le j \\le S_i+1$。\n\n你的任务是制定出一个产品的分配方案，使得订单条件被满足，并且所有员工的愤怒值之和最小。由于我们并不想使用Special Judge，也为了使选手有更多的时间研究其他两道题目，你只需要输出最小的愤怒值之和就可以了。\n", "inputFormat": "https://cdn.luogu.com.cn/upload/pic/1608.png\n\n第一行包含两个正整数 $m$ 和 $n$，分别表示员工数量和产品的种类数；\n\n第二行包含 $n$ 个正整数，第 $i$ 个正整数为 $C_i$；\n\n以下 $m$ 行每行 $n$ 个整数描述矩阵 $A$；\n\n下面 $m$ 个部分，第 $i$ 部分描述员工 $i$ 的愤怒值与产品数量的函数关系。每一部分由三行组成：第一行为一个非负整数 $S_i$，第二行包含 $S_i$ 个正整数，其中第 $j$ 个正整数为 $T_{i,j}$，如果 $S_i=0$ 那么输入将不会留空行（即这一部分只由两行组成）。第三行包含 $S_i+1$ 个正整数，其中第 $j$ 个正整数为 $W_{i,j}$。\n", "outputFormat": "仅输出一个整数，表示最小的愤怒值之和。\n", "hint": "\n### 数据范围及约定\n\n- 存在 $30\\%$ 的数据，保证 $1\\le n,m\\le 30$；\n- 均匀分布着约 $30\\%$ 的数据，满足 $S_i = 0$；\n- 均匀分布着约 $30\\%$ 的数据，满足 $S_i \\le 1$（不包含上述 $S_i = 0$ 的数据）。\n\n对于全部数据，满足 $1\\le m,n\\le 250$，$0\\le S_i\\le 5$，$0\\le A_{i, j}\\le 1$，$0< T_{i, j}< T_{i, j + 1}$，$0< W_{i,j} < W_{i, j + 1}$。所有数据均不大于 $10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2011] Work Assignment", "background": "", "description": "Your company has received a batch of orders. The orders require your company to provide $n$ types of products, numbered $1 \\sim n$, where $C_i$ units of type $i$ are needed. The company has $m$ employees, numbered $1 \\sim m$. The types of products that employees can make differ. Each product must be made entirely by a single employee; it is not allowed to have one employee make some parts and then pass it to another employee to continue.\n\nWe use an $m \\times n$ matrix $A$ consisting of $0$ and $1$ to describe which products each employee can make. The rows and columns of the matrix are numbered $1 \\sim m$ and $1 \\sim n$, respectively. $A_i,j$ being $1$ means employee $i$ can make product $j$, and $0$ means employee $i$ cannot make product $j$.\n\nIf the company assigns too much work to an employee, the employee will become unhappy. We use an anger value to describe an employee’s mood. A higher anger value means the employee is more unhappy, and a lower anger value means the employee is happier. There is a functional relationship between an employee’s anger value and the number of products assigned to them. Since employees have different endurance, these functions differ between employees.\n\nFor employee $i$, the function between their anger value and the number of products has $S_i+1$ segments. When they make the $1 \\sim T_{i,1}$-th products, each product increases their anger by $W_{i,1}$. When they make the $(T_{i,1}+1) \\sim T_{i,2}$-th products, each product increases their anger by $W_{i,2}$, and so on. For convenience, let $T_{i,0}=0, T_{i,s_{i+1}}=+\\infty$. Then when they make the $(T_{i,j-1}+1) \\sim T_{i,j}$-th products, each product increases their anger by $W_{i,j}$, $1 \\le j \\le S_i+1$.\n\nYour task is to design an assignment plan for the products so that the order requirements are satisfied, and the sum of anger values of all employees is minimized. Since we do not want to use a Special Judge, and to give contestants more time for the other two problems, you only need to output the minimal sum of anger values.", "inputFormat": "The first line contains two positive integers $m$ and $n$, the number of employees and the number of product types.\n\nThe second line contains $n$ positive integers, where the $i$-th integer is $C_i$.\n\nEach of the next $m$ lines contains $n$ integers describing the matrix $A$.\n\nThen there are $m$ sections, where the $i$-th section describes the functional relationship between employee $i$’s anger value and the number of products. Each section consists of three lines: the first line is a non-negative integer $S_i$; the second line contains $S_i$ positive integers, where the $j$-th integer is $T_{i,j}$ (if $S_i=0$, this line does not appear, i.e., the section has only two lines); the third line contains $S_i+1$ positive integers, where the $j$-th integer is $W_{i,j}$.", "outputFormat": "Output a single integer: the minimal possible sum of anger values.", "hint": "Constraints\n\n- There are $30\\%$ of the testdata with $1 \\le n, m \\le 30$.\n- About $30\\%$ of the testdata satisfy $S_i = 0$.\n- About $30\\%$ of the testdata satisfy $S_i \\le 1$ (excluding the above $S_i = 0$ testdata).\n\nFor all testdata, $1 \\le m, n \\le 250$, $0 \\le S_i \\le 5$, $0 \\le A_{i, j} \\le 1$, $0 < T_{i, j} < T_{i, j + 1}$, $0 < W_{i, j} < W_{i, j + 1}$. All numbers are at most $10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2011] 工作安排", "background": "", "description": "\n你的公司接到了一批订单。订单要求你的公司提供 $n$ 类产品，产品被编号为 $1 \\sim n$，其中第 $i$ 类产品共需要 $C_i$ 件。公司共有 $m$ 名员工，员工被编号为 $1 \\sim m$ 员工能够制造的产品种类有所区别。一件产品必须完整地由一名员工制造，不可以由某名员工制造一部分配件后，再转交给另外一名员工继续进行制造。\n\n我们用一个由 $0$ 和 $1$ 组成的 $m \\times n$ 的矩阵 $A$ 来描述每名员工能够制造哪些产品。矩阵的行和列分别被编号为 $1 \\sim m$ 和 $1 \\sim n$，$A_i,j$ 为 $1$ 表示员工 $i$ 能够制造产品 $j$，为 $0$ 表示员工 $i$ 不能制造产品 $j$。\n\n如果公司分配了过多工作给一名员工，这名员工会变得不高兴。我们用愤怒值来描述某名员工的心情状态。愤怒值越高，表示这名员工心情越不爽，愤怒值越低，表示这名员工心情越愉快。员工的愤怒值与他被安排制造的产品数量存在某函数关系，鉴于员工们的承受能力不同，不同员工之间的函数关系也是有所区别的。\n\n对于员工 $i$，他的愤怒值与产品数量之间的函数是一个 $S_i+1$ 段的分段函数。当他制造第 $1 \\sim T_{i,1}$ 件产品时，每件产品会使他的愤怒值增加 $W_{i,1}$，当他制造第 $T_{i,1}+1 \\sim T_{i,2}$ 件产品时，每件产品会使他的愤怒值增加 $W_{i,2}$ ……为描述方便，设 $T_{i,0}=0,T_{i,s_{i+1}}=+\\infty$，那么当他制造第 $T_{i,j-1}+1 \\sim T_{i,j}$ 件产品时，每件产品会使他的愤怒值增加 $W_{i,j}$，$1 \\le j \\le S_i+1$。\n\n你的任务是制定出一个产品的分配方案，使得订单条件被满足，并且所有员工的愤怒值之和最小。由于我们并不想使用Special Judge，也为了使选手有更多的时间研究其他两道题目，你只需要输出最小的愤怒值之和就可以了。\n", "inputFormat": "https://cdn.luogu.com.cn/upload/pic/1608.png\n\n第一行包含两个正整数 $m$ 和 $n$，分别表示员工数量和产品的种类数；\n\n第二行包含 $n$ 个正整数，第 $i$ 个正整数为 $C_i$；\n\n以下 $m$ 行每行 $n$ 个整数描述矩阵 $A$；\n\n下面 $m$ 个部分，第 $i$ 部分描述员工 $i$ 的愤怒值与产品数量的函数关系。每一部分由三行组成：第一行为一个非负整数 $S_i$，第二行包含 $S_i$ 个正整数，其中第 $j$ 个正整数为 $T_{i,j}$，如果 $S_i=0$ 那么输入将不会留空行（即这一部分只由两行组成）。第三行包含 $S_i+1$ 个正整数，其中第 $j$ 个正整数为 $W_{i,j}$。\n", "outputFormat": "仅输出一个整数，表示最小的愤怒值之和。\n", "hint": "\n### 数据范围及约定\n\n- 存在 $30\\%$ 的数据，保证 $1\\le n,m\\le 30$；\n- 均匀分布着约 $30\\%$ 的数据，满足 $S_i = 0$；\n- 均匀分布着约 $30\\%$ 的数据，满足 $S_i \\le 1$（不包含上述 $S_i = 0$ 的数据）。\n\n对于全部数据，满足 $1\\le m,n\\le 250$，$0\\le S_i\\le 5$，$0\\le A_{i, j}\\le 1$，$0< T_{i, j}< T_{i, j + 1}$，$0< W_{i,j} < W_{i, j + 1}$。所有数据均不大于 $10^5$。", "locale": "zh-CN"}}}
{"pid": "P2489", "type": "P", "difficulty": 6, "samples": [["4 3 2 1\r\n.$.\r\nA#B\r\nA#B\r\n.@.\r\n30 30 20 20", "0.600"], ["4 3 2 2\r\n.$.\r\nA#B\r\nA#B\r\n.@.\r\n30 30 20 20", "0.800"], ["4 3 2 3\r\n.$.\r\nA#B\r\nA#B\r\n.@.\r\n30 30 20 20", "1.000"], ["4 3 3 2\r\n.$.\r\nA#B\r\nA#C\r\n@@@\r\n143 37 335 85 95 25 223 57", "0.858"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "搜索", "2011", "各省省选", "山东"], "title": "[SDOI2011] 迷宫探险", "background": "[](https://paste.ubuntu.com/p/H4h73F2h87/)", "description": "这是一个单人游戏。\n\n游戏开始时，玩家控制的人物出生在迷宫的某个位置，玩家的目标是控制人物走到迷宫的某个出口（出口可能有多个）。\n\n迷宫里有 $k$ 类陷阱（用  `A`,`B`,`C`……表示，相同字母代表相同类型的陷阱），每类陷阱可能是有害的或无害的，而在游戏开始时玩家并不知道哪些陷阱是有害的，哪些是无害的。\n\n同一类陷阱的状态相同，即用同一个字母标志的陷阱要么全部有害，要么全部无害，不会发生一部分有害而另一部分无害的情况。任何陷阱状态的组合都有一个发生概率，考虑下例：\n\n当 $k=2$ 时，迷宫内共有两类陷阱，分别用 `A` 和 `B` 表示，陷阱状态的组合共有 $4$ 种：-\n- `A` 是无害陷阱，`B` 是无害陷阱。\n- `A` 是有害陷阱，`B` 是无害陷阱；\n- `A` 是无害陷阱，`B` 是有害陷阱；\n- `A` 是有害陷阱，`B` 是有害陷阱；\n\n下列表格是一个合法的概率表格：\n\n|  | `A` 是无害陷阱 | `A` 是有害陷阱 |\n| -----------: | -----------: | -----------: |\n| **`B` 是无害陷阱** | $36\\%$ | $24\\%$ |\n| **`B` 是有害陷阱** | $24\\%$ | $16\\%$ |\n\n当 $k=3$ 时，会有 $8$ 种不同的陷阱状态组合，如果我们依然坚持使用概率表格，那么这个表格将会是三维的（$2\\times 2 \\times 2$，每一维对应着一类陷阱）。当 $k\\ge 3$ 时，这将使得题目难以描述。因此我们使用一个大小为 $2^{k}$ 的数组 $p$ 来描述每种情况发生的可能性，$p$ 的下标范围为 $0\\sim 2^{k}-1$。\n\n$p$ 是这样生成的：\n\n对于每个可能的陷阱状态组合，考虑所有 $k$ 类陷阱，令 $1$ 表示某个陷阱有害，$0$ 表示某个陷阱无害，把 `A` 作为二进制数的第 $0$ 位（从右边开始计数），`B` 作为第 $1$ 位，`C` 作为第 $2$ 位……通过以上操作，我们可以得到一个 $k$ 位的二进制数，把它转化成十进制后，$2^{k}$ 种陷阱状态的组合将会与整数 $0\\sim2^{k}-1$ 一一对应。\n\n设 $S = \\displaystyle\\sum_{i=0}^{2^k-1} p_i$，则陷阱状态组合 $i$ 出现的概率为 $\\dfrac {p_{i}} {S}$。\n\n上述表格对应的一个合法数组 $p$ 为 $36,24,24,16$。\n\n当然同一个概率表格可能会对应多个数组 $p$（事实上有无数个数组 $p$ 能够迎合表格数据），例如上述表格同时也对应着下面的数组 $p$：$72,48,48,32$。\n\n玩家控制的人物初始情况下有 $H$ 点生命，当人物踏上某个陷阱时，如果这个陷阱是有害的，那么会损失 $1$ 点生命，否则这个陷阱是无害的，不损失生命。无论上述哪种情况发生，玩家会立刻得到这个陷阱的信息（有害或无害）。一旦生命小于等于 $0$，玩家控制的人物会立刻死亡。\n\n迷宫可以看作 $m\\times n$ 的方格地图，每个元素可能是：\n- `.`：表示这是平地，可以通过；\n- `#`：表示这是墙，不能通过；\n- `A`，`B` ，`C`……：表示这是一个陷阱；\n- `$`：表示这是起点，地图中有且仅有一个；\n- `@`：表示这是终点，地图中可以有多个，也可以一个也没有。\n\n人物可以向上下左右四个方向行走，不可以走对角线，也不可以走出地图。\n\n给定 $m\\times n$ 的地图、$k$、$h$ 以及大小为 $2^{k}$ 的概率数组。你的任务是求出在执行最优策略时，人物能活着走出迷宫的概率。", "inputFormat": "第一行包含 $4$ 个整数，分别表示 $m,n,k,H$；\n\n下面 $m$ 行每行 $n$ 个字符描述迷宫地图；\n\n最后一行包含 $2^{k}$ 个非负整数描述数组 $p$，数组下标从 $0$ 开始。", "outputFormat": "仅包含一个数字，表示在执行最优策略时，人物活着走出迷宫的概率。四舍五入保留 $3$ 位小数。", "hint": "**【样例说明 1】**\n\n向右边走，经过 `B` ，`B` 为有害陷阱的概率为 $\\frac {(20+20)}{(30+30+20+20)}=0.4$，若 `B` 为有害陷阱那么人物就死掉了，游戏失败，否则玩家得知 `B` 是无害陷阱，继续经过另一个 `B` 达到终点，胜利的概率为 $0.6$。\n\n**【样例说明 2】**\n\n向左边走，经过 `A`，`A` 为有害陷阱的概率为 $\\frac {(30+30)} {(30+30+20+20)}=0.5$。若 `A` 为有害陷阱，那么损失一点生命，转到右边尝试 `B` ，要想成功到达终点，此时 `B` 必须为无害陷阱，而在 `A`是有害陷阱的前提下，`B` 是无害陷阱的概率是 $\\frac {30}{(30+20)}=0.6$，故这种情况发生的概率为 $0.5\\times 0.6=0.3$。若 `A`是无害陷阱，玩家可以控制人物连续通过两个 `A` 到达终点，这种情况发生的概率 $0.5$。所以答案为 $0.3+0.5=0.8$。 \n\n\n**【样例说明 3】**\n\n玩家控制的人物有 $3$ 点生命，但最多只需要经过两个陷阱，所以任意选左路\n或右路走过去就可以到达终点了。\n\n**【数据范围与约定】**\n\n|测试点编号  | $m$ | $n$ | $k$ | $H$ |\n| -----------: | -----------: | -----------: | -----------: | -----------: |\n| $1$ | $29$ | $28$ | $5$ | $1$ |\n| $2$ | $28$ | $20$ | $4$ | $1$ |\n| $3$ | $25$ | $30$ | $1$ | $1$ |\n| $4$ | $25$ | $30$ | $1$ | $2$ |\n| $5$ | $25$ | $30$ | $1$ | $3$ |\n| $6$ | $5$ | $5$ | $4$ | $4$ |\n| $7$ | $12$ | $11$ | $4$ | $5$ |\n| $8$ | $19$ | $17$ | $5$ | $3$ |\n| $9$ | $23$ | $25$ | $5$ | $4$ |\n| $10$ | $30$ | $29$ | $5$ | $5$ |\n\n对于 $100\\%$ 的数据，$1\\le m\\leq 30$，$1\\le n\\leq 29$，$k\\leq 5$，$H\\leq 5$，$0\\leq p_i\\leq 10^5$，且至少有一个 $p_i\\gt0$ 。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2011] Maze Exploration", "background": "https://paste.ubuntu.com/p/H4h73F2h87/", "description": "This is a single-player game.\n\nAt the start of the game, the player’s character spawns at some position in a maze. The player’s goal is to control the character to reach an exit of the maze (there may be multiple exits).\n\nThere are $k$ types of traps in the maze (denoted by `A`, `B`, `C`, …; the same letter represents the same type of trap). Each type of trap may be harmful or harmless, and at the beginning of the game the player does not know which traps are harmful and which are harmless.\n\nTraps of the same type share the same state: all traps marked with the same letter are either all harmful or all harmless; it never happens that some are harmful and others are harmless. Every combination of trap states has a probability. Consider the following example:\n\nWhen $k=2$, there are two types of traps in the maze, denoted by `A` and `B`. There are $4$ combinations of trap states:\n- `A` is harmless, `B` is harmless.\n- `A` is harmful, `B` is harmless.\n- `A` is harmless, `B` is harmful.\n- `A` is harmful, `B` is harmful.\n\nThe following table is a valid probability table:\n\n|  | `A` is harmless | `A` is harmful |\n| -----------: | -----------: | -----------: |\n| **`B` is harmless** | $36\\%$ | $24\\%$ |\n| **`B` is harmful** | $24\\%$ | $16\\%$ |\n\nWhen $k=3$, there are $8$ different combinations of trap states. If we still insist on using a probability table, it would be three-dimensional ($2 \\times 2 \\times 2$, with each dimension corresponding to one trap type). When $k \\ge 3$, this makes the problem hard to describe. Therefore, we use an array $p$ of size $2^{k}$ to describe the probability of each case. The index range of $p$ is $0 \\sim 2^{k} - 1$.\n\nArray $p$ is constructed as follows:\n\nFor each possible combination of trap states, consider all $k$ types of traps. Let $1$ indicate a harmful trap and $0$ indicate a harmless trap. Treat `A` as the $0$-th bit of a binary number (counting from the right), `B` as the $1$-st bit, `C` as the $2$-nd bit, and so on. With this, we obtain a $k$-bit binary number. After converting it to decimal, the $2^{k}$ combinations of trap states correspond one-to-one to the integers $0 \\sim 2^{k} - 1$.\n\nLet $S = \\displaystyle\\sum_{i=0}^{2^k-1} p_i$. Then the probability that trap-state combination $i$ occurs is $\\dfrac {p_{i}} {S}$.\n\nA valid array $p$ corresponding to the above table is $36, 24, 24, 16$.\n\nOf course, the same probability table may correspond to multiple arrays $p$ (in fact, infinitely many arrays $p$ can match the table data). For example, the above table also corresponds to the array $p$: $72, 48, 48, 32$.\n\nThe player’s character initially has $H$ hit points (HP). When the character steps on a trap, if the trap is harmful, $1$ HP is lost; otherwise, if the trap is harmless, no HP is lost. In either case, the player immediately learns the information of that trap (harmful or harmless). Once HP is less than or equal to $0$, the character dies immediately.\n\nThe maze can be regarded as an $m \\times n$ grid map. Each cell may be:\n- `.`: flat ground, passable.\n- `#`: wall, impassable.\n- `A`, `B`, `C`, …: a trap.\n- `$`: the starting point; there is exactly one on the map.\n- `@`: an exit; there may be multiple, or none.\n\nThe character can move up, down, left, and right. Diagonal movement is not allowed, and the character cannot move outside the map.\n\nGiven the $m \\times n$ map, $k$, $H$, and the probability array of size $2^{k}$, your task is to compute the probability that, under an optimal strategy, the character reaches an exit alive.", "inputFormat": "The first line contains $4$ integers, denoting $m$, $n$, $k$, and $H$.\n\nThe next $m$ lines each contain $n$ characters describing the maze map.\n\nThe last line contains $2^{k}$ nonnegative integers describing the array $p$, with indices starting from $0$.", "outputFormat": "Output a single number: the probability that, under an optimal strategy, the character reaches an exit alive. Round to $3$ decimal places.", "hint": "【Sample Explanation 1】\n\nMove right, passing `B`. The probability that `B` is harmful is $\\frac {(20+20)}{(30+30+20+20)}=0.4$. If `B` is harmful, the character dies and the game fails; otherwise, the player learns that `B` is harmless and continues through another `B` to reach the exit. The success probability is $0.6$.\n\n【Sample Explanation 2】\n\nMove left, passing `A`. The probability that `A` is harmful is $\\frac {(30+30)} {(30+30+20+20)}=0.5$. If `A` is harmful, $1$ HP is lost, then switch to the right path to try `B`. To succeed, `B` must be harmless. Given that `A` is harmful, the conditional probability that `B` is harmless is $\\frac {30}{(30+20)}=0.6$. Hence, the probability of this branch is $0.5 \\times 0.6 = 0.3$. If `A` is harmless, the player can guide the character through two consecutive `A` to reach the exit, with probability $0.5$. Therefore, the answer is $0.3 + 0.5 = 0.8$.\n\n【Sample Explanation 3】\n\nThe character has $3$ HP but needs to pass through at most two traps, so taking either the left or the right path suffices to reach the exit.\n\nConstraints\n\n| Test point ID | $m$ | $n$ | $k$ | $H$ |\n| -----------: | -----------: | -----------: | -----------: | -----------: |\n| $1$ | $29$ | $28$ | $5$ | $1$ |\n| $2$ | $28$ | $20$ | $4$ | $1$ |\n| $3$ | $25$ | $30$ | $1$ | $1$ |\n| $4$ | $25$ | $30$ | $1$ | $2$ |\n| $5$ | $25$ | $30$ | $1$ | $3$ |\n| $6$ | $5$ | $5$ | $4$ | $4$ |\n| $7$ | $12$ | $11$ | $4$ | $5$ |\n| $8$ | $19$ | $17$ | $5$ | $3$ |\n| $9$ | $23$ | $25$ | $5$ | $4$ |\n| $10$ | $30$ | $29$ | $5$ | $5$ |\n\nFor $100\\%$ of the testdata, $1 \\le m \\le 30$, $1 \\le n \\le 29$, $k \\le 5$, $H \\le 5$, $0 \\le p_i \\le 10^5$, and at least one $p_i \\gt 0$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2011] 迷宫探险", "background": "[](https://paste.ubuntu.com/p/H4h73F2h87/)", "description": "这是一个单人游戏。\n\n游戏开始时，玩家控制的人物出生在迷宫的某个位置，玩家的目标是控制人物走到迷宫的某个出口（出口可能有多个）。\n\n迷宫里有 $k$ 类陷阱（用  `A`,`B`,`C`……表示，相同字母代表相同类型的陷阱），每类陷阱可能是有害的或无害的，而在游戏开始时玩家并不知道哪些陷阱是有害的，哪些是无害的。\n\n同一类陷阱的状态相同，即用同一个字母标志的陷阱要么全部有害，要么全部无害，不会发生一部分有害而另一部分无害的情况。任何陷阱状态的组合都有一个发生概率，考虑下例：\n\n当 $k=2$ 时，迷宫内共有两类陷阱，分别用 `A` 和 `B` 表示，陷阱状态的组合共有 $4$ 种：-\n- `A` 是无害陷阱，`B` 是无害陷阱。\n- `A` 是有害陷阱，`B` 是无害陷阱；\n- `A` 是无害陷阱，`B` 是有害陷阱；\n- `A` 是有害陷阱，`B` 是有害陷阱；\n\n下列表格是一个合法的概率表格：\n\n|  | `A` 是无害陷阱 | `A` 是有害陷阱 |\n| -----------: | -----------: | -----------: |\n| **`B` 是无害陷阱** | $36\\%$ | $24\\%$ |\n| **`B` 是有害陷阱** | $24\\%$ | $16\\%$ |\n\n当 $k=3$ 时，会有 $8$ 种不同的陷阱状态组合，如果我们依然坚持使用概率表格，那么这个表格将会是三维的（$2\\times 2 \\times 2$，每一维对应着一类陷阱）。当 $k\\ge 3$ 时，这将使得题目难以描述。因此我们使用一个大小为 $2^{k}$ 的数组 $p$ 来描述每种情况发生的可能性，$p$ 的下标范围为 $0\\sim 2^{k}-1$。\n\n$p$ 是这样生成的：\n\n对于每个可能的陷阱状态组合，考虑所有 $k$ 类陷阱，令 $1$ 表示某个陷阱有害，$0$ 表示某个陷阱无害，把 `A` 作为二进制数的第 $0$ 位（从右边开始计数），`B` 作为第 $1$ 位，`C` 作为第 $2$ 位……通过以上操作，我们可以得到一个 $k$ 位的二进制数，把它转化成十进制后，$2^{k}$ 种陷阱状态的组合将会与整数 $0\\sim2^{k}-1$ 一一对应。\n\n设 $S = \\displaystyle\\sum_{i=0}^{2^k-1} p_i$，则陷阱状态组合 $i$ 出现的概率为 $\\dfrac {p_{i}} {S}$。\n\n上述表格对应的一个合法数组 $p$ 为 $36,24,24,16$。\n\n当然同一个概率表格可能会对应多个数组 $p$（事实上有无数个数组 $p$ 能够迎合表格数据），例如上述表格同时也对应着下面的数组 $p$：$72,48,48,32$。\n\n玩家控制的人物初始情况下有 $H$ 点生命，当人物踏上某个陷阱时，如果这个陷阱是有害的，那么会损失 $1$ 点生命，否则这个陷阱是无害的，不损失生命。无论上述哪种情况发生，玩家会立刻得到这个陷阱的信息（有害或无害）。一旦生命小于等于 $0$，玩家控制的人物会立刻死亡。\n\n迷宫可以看作 $m\\times n$ 的方格地图，每个元素可能是：\n- `.`：表示这是平地，可以通过；\n- `#`：表示这是墙，不能通过；\n- `A`，`B` ，`C`……：表示这是一个陷阱；\n- `$`：表示这是起点，地图中有且仅有一个；\n- `@`：表示这是终点，地图中可以有多个，也可以一个也没有。\n\n人物可以向上下左右四个方向行走，不可以走对角线，也不可以走出地图。\n\n给定 $m\\times n$ 的地图、$k$、$h$ 以及大小为 $2^{k}$ 的概率数组。你的任务是求出在执行最优策略时，人物能活着走出迷宫的概率。", "inputFormat": "第一行包含 $4$ 个整数，分别表示 $m,n,k,H$；\n\n下面 $m$ 行每行 $n$ 个字符描述迷宫地图；\n\n最后一行包含 $2^{k}$ 个非负整数描述数组 $p$，数组下标从 $0$ 开始。", "outputFormat": "仅包含一个数字，表示在执行最优策略时，人物活着走出迷宫的概率。四舍五入保留 $3$ 位小数。", "hint": "**【样例说明 1】**\n\n向右边走，经过 `B` ，`B` 为有害陷阱的概率为 $\\frac {(20+20)}{(30+30+20+20)}=0.4$，若 `B` 为有害陷阱那么人物就死掉了，游戏失败，否则玩家得知 `B` 是无害陷阱，继续经过另一个 `B` 达到终点，胜利的概率为 $0.6$。\n\n**【样例说明 2】**\n\n向左边走，经过 `A`，`A` 为有害陷阱的概率为 $\\frac {(30+30)} {(30+30+20+20)}=0.5$。若 `A` 为有害陷阱，那么损失一点生命，转到右边尝试 `B` ，要想成功到达终点，此时 `B` 必须为无害陷阱，而在 `A`是有害陷阱的前提下，`B` 是无害陷阱的概率是 $\\frac {30}{(30+20)}=0.6$，故这种情况发生的概率为 $0.5\\times 0.6=0.3$。若 `A`是无害陷阱，玩家可以控制人物连续通过两个 `A` 到达终点，这种情况发生的概率 $0.5$。所以答案为 $0.3+0.5=0.8$。 \n\n\n**【样例说明 3】**\n\n玩家控制的人物有 $3$ 点生命，但最多只需要经过两个陷阱，所以任意选左路\n或右路走过去就可以到达终点了。\n\n**【数据范围与约定】**\n\n|测试点编号  | $m$ | $n$ | $k$ | $H$ |\n| -----------: | -----------: | -----------: | -----------: | -----------: |\n| $1$ | $29$ | $28$ | $5$ | $1$ |\n| $2$ | $28$ | $20$ | $4$ | $1$ |\n| $3$ | $25$ | $30$ | $1$ | $1$ |\n| $4$ | $25$ | $30$ | $1$ | $2$ |\n| $5$ | $25$ | $30$ | $1$ | $3$ |\n| $6$ | $5$ | $5$ | $4$ | $4$ |\n| $7$ | $12$ | $11$ | $4$ | $5$ |\n| $8$ | $19$ | $17$ | $5$ | $3$ |\n| $9$ | $23$ | $25$ | $5$ | $4$ |\n| $10$ | $30$ | $29$ | $5$ | $5$ |\n\n对于 $100\\%$ 的数据，$1\\le m\\leq 30$，$1\\le n\\leq 29$，$k\\leq 5$，$H\\leq 5$，$0\\leq p_i\\leq 10^5$，且至少有一个 $p_i\\gt0$ 。", "locale": "zh-CN"}}}
{"pid": "P2490", "type": "P", "difficulty": 6, "samples": [["10 4 2", "182"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "递推", "博弈论", "2011", "各省省选", "山东", "排列组合"], "title": "[SDOI2011] 黑白棋", "background": "", "description": "小 A 和小 B 又想到了一个新的游戏。\n\n这个游戏是在一个 $1 \\times n$ 的棋盘上进行的，棋盘上有 $k$ 个棋子，一半是黑色，一半是白色。\n\n最左边是白色棋子，最右边是黑色棋子，相邻的棋子颜色不同。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/dmv5zoyy.png)\n\n小 A 可以移动白色棋子，小 B 可以移动黑色的棋子，其中白色不能往左，黑色不能往右。他们每次操作可以移动 $1$ 到 $d$ 个棋子。\n\n每当移动某一个棋子时，这个棋子不能跨越两边的棋子，当然也不可以出界。当谁不可以操作时，谁就失败了。\n\n小 A 和小 B 轮流操作，现在小 A 先移动，有多少种初始棋子的布局会使他胜利呢？\n", "inputFormat": "输入三个数 $n,k,d$。\n", "outputFormat": "输出小 A 胜利的方案总数。答案对 $10^9+7$ 取模。\n", "hint": "- 对于 $30\\%$ 的数据，有 $k=2$。\n- 对于 $100\\%$ 的数据，有 $1 \\leq d \\leq k \\leq n \\leq 10^4$，$k$ 为偶数，$k \\leq 100$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2011] Black and White Chess", "background": "", "description": "A and B came up with a new game.\n\nThe game is played on a $1 \\times n$ board. There are $k$ pieces on the board, half black and half white.\n\nThe leftmost piece is white, the rightmost piece is black, and adjacent pieces have alternating colors.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/dmv5zoyy.png)\n\nA may move white pieces, and B may move black pieces. White pieces cannot move left, and black pieces cannot move right. On each turn, they may move $1$ to $d$ pieces.\n\nWhen moving a piece, it cannot cross over neighboring pieces on either side, and it cannot move off the board. Whoever has no legal move loses.\n\nA and B take turns, with A moving first. How many initial arrangements of the pieces will make A win?", "inputFormat": "Input three numbers $n,k,d$.", "outputFormat": "Output the total number of initial configurations in which A wins. Print the answer modulo $10^9+7$.", "hint": "- For $30\\%$ of the testdata, $k=2$.\n- For $100\\%$ of the testdata, $1 \\leq d \\leq k \\leq n \\leq 10^4$, $k$ is even, and $k \\leq 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2011] 黑白棋", "background": "", "description": "小 A 和小 B 又想到了一个新的游戏。\n\n这个游戏是在一个 $1 \\times n$ 的棋盘上进行的，棋盘上有 $k$ 个棋子，一半是黑色，一半是白色。\n\n最左边是白色棋子，最右边是黑色棋子，相邻的棋子颜色不同。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/dmv5zoyy.png)\n\n小 A 可以移动白色棋子，小 B 可以移动黑色的棋子，其中白色不能往左，黑色不能往右。他们每次操作可以移动 $1$ 到 $d$ 个棋子。\n\n每当移动某一个棋子时，这个棋子不能跨越两边的棋子，当然也不可以出界。当谁不可以操作时，谁就失败了。\n\n小 A 和小 B 轮流操作，现在小 A 先移动，有多少种初始棋子的布局会使他胜利呢？\n", "inputFormat": "输入三个数 $n,k,d$。\n", "outputFormat": "输出小 A 胜利的方案总数。答案对 $10^9+7$ 取模。\n", "hint": "- 对于 $30\\%$ 的数据，有 $k=2$。\n- 对于 $100\\%$ 的数据，有 $1 \\leq d \\leq k \\leq n \\leq 10^4$，$k$ 为偶数，$k \\leq 100$。\n", "locale": "zh-CN"}}}
{"pid": "P2491", "type": "P", "difficulty": 5, "samples": [["5 2\n1 2 5\n2 3 2\n2 4 4\n2 5 3", "5"], ["8 6\n1 3 2\n2 3 2 \n3 4 6\n4 5 3\n4 6 4\n4 7 2\n7 8 3", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2011", "二分", "各省省选", "单调队列", "山东", "广度优先搜索 BFS", "优先队列", "树的直径"], "title": "[SDOI2011] 消防", "background": null, "description": "某个国家有 $n$ 个城市，这 $n$ 个城市中任意两个都连通且有唯一一条路径，每条连通两个城市的道路的长度为 $z_i$。\n\n这个国家的人对火焰有超越宇宙的热情，所以这个国家最兴旺的行业是消防业。由于政$%$府对国民的热情忍无可忍（大量的消防经费开销）可是却又无可奈何（总统竞选的国民支持率），所以只能想尽方法提高消防能力。\n\n现在这个国家的经费足以在一条边长度和不超过 $s$ 的路径（两端都是城市）上建立消防枢纽，为了尽量提高枢纽的利用率，要求其他所有城市到这条路径的距离的最大值最小。\n\n你受命监管这个项目，你当然需要知道应该把枢纽建立在什么位置上。", "inputFormat": "输入包含 $n$ 行：\n\n第 $1$ 行，两个正整数 $n$ 和 $s$，中间用一个空格隔开。其中 $n$ 为城市的个数，$s$ 为路径长度的上界。设结点编号以此为$1,2,\\ldots,n$。\n\n从第 $2$ 行到第 $n$ 行，每行给出 $3$ 个用空格隔开的非负整数，依次表示每一条边的两个端点编号和长度。例如，```2 4 7```表示连接结点 $2$ 与 $4$ 的边的长度为 $7$。", "outputFormat": "输出包含一个非负整数，即所有城市到选择的路径的最大值，当然这个最大值必须是所有方案中最小的。", "hint": "对于 $20\\%$ 的数据，$n \\le 300$。\n\n对于 $50\\%$ 的数据，$n \\le 3 \\times 10^3$。\n\n对于 $100\\%$ 的数据，$1\\le n \\le 3 \\times 10^5$，$0\\le z_i \\le 10^3$。\n\n\n\n------------\n2024/1/28 添加一组 hack 数据。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2011] Firefighting", "background": "", "description": "There are $n$ cities in a country. Any two of these $n$ cities are connected and have a unique path between them. Each road connecting two cities has length $z_i$.\n\nThe people of this country have a passion for flames beyond the universe, so the most prosperous industry is firefighting. Since the gov$%$ernment cannot tolerate the people's enthusiasm (massive firefighting budget expenditure) yet can do nothing about it (public support in presidential elections), they can only try every means to improve firefighting capacity.\n\nNow the country's budget is sufficient to build a firefighting hub along a path (with both endpoints being cities) whose total length is no more than $s$. To maximize the hub's utilization, it is required to minimize the maximum distance from all other cities to this path.\n\nYou are assigned to oversee this project, and of course you need to know where to place the hub.", "inputFormat": "The input contains $n$ lines:\n\n- Line $1$: two positive integers $n$ and $s$, separated by a space. Here $n$ is the number of cities, and $s$ is the upper bound on the path length. Nodes are numbered $1,2,\\ldots,n$.\n- From line $2$ to line $n$: each line gives $3$ positive integers, representing the two endpoints and the length of one edge. For example, ```2 4 7``` means the length of the edge connecting nodes $2$ and $4$ is $7$.", "outputFormat": "Output a single non-negative integer, which is the minimal possible value of the maximum distance from any city to the chosen path.", "hint": "For $20\\%$ of the testdata, $n \\le 300$.\n\nFor $50\\%$ of the testdata, $n \\le 3 \\times 10^3$.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 3 \\times 10^5$, $0 \\le z_i \\le 10^3$.\n\n------------\n2024/1/28 added a set of hack testdata.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2011] 消防", "background": null, "description": "某个国家有 $n$ 个城市，这 $n$ 个城市中任意两个都连通且有唯一一条路径，每条连通两个城市的道路的长度为 $z_i$。\n\n这个国家的人对火焰有超越宇宙的热情，所以这个国家最兴旺的行业是消防业。由于政$%$府对国民的热情忍无可忍（大量的消防经费开销）可是却又无可奈何（总统竞选的国民支持率），所以只能想尽方法提高消防能力。\n\n现在这个国家的经费足以在一条边长度和不超过 $s$ 的路径（两端都是城市）上建立消防枢纽，为了尽量提高枢纽的利用率，要求其他所有城市到这条路径的距离的最大值最小。\n\n你受命监管这个项目，你当然需要知道应该把枢纽建立在什么位置上。", "inputFormat": "输入包含 $n$ 行：\n\n第 $1$ 行，两个正整数 $n$ 和 $s$，中间用一个空格隔开。其中 $n$ 为城市的个数，$s$ 为路径长度的上界。设结点编号以此为$1,2,\\ldots,n$。\n\n从第 $2$ 行到第 $n$ 行，每行给出 $3$ 个用空格隔开的非负整数，依次表示每一条边的两个端点编号和长度。例如，```2 4 7```表示连接结点 $2$ 与 $4$ 的边的长度为 $7$。", "outputFormat": "输出包含一个非负整数，即所有城市到选择的路径的最大值，当然这个最大值必须是所有方案中最小的。", "hint": "对于 $20\\%$ 的数据，$n \\le 300$。\n\n对于 $50\\%$ 的数据，$n \\le 3 \\times 10^3$。\n\n对于 $100\\%$ 的数据，$1\\le n \\le 3 \\times 10^5$，$0\\le z_i \\le 10^3$。\n\n\n\n------------\n2024/1/28 添加一组 hack 数据。", "locale": "zh-CN"}}}
{"pid": "P2492", "type": "P", "difficulty": 7, "samples": [["2\r\n  0 1 0 0 0\r\n0 0 2 0 4 0 0\r\n0 0 4 3 0 3 2\r\n  0 0 0 1 0\r\n", "18 1"], ["3\r\n    0 0 0 1 0 0 0\r\n  0 0 0 0 0 0 0 0 0\r\n0 0 2 0 0 0 0 0 0 0 0\r\n0 0 0 0 0 0 3 0 0 0 0\r\n  0 0 0 0 0 0 0 0 0\r\n    0 3 0 1 0 2 0\r\n", "44 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "各省省选", "山东"], "title": "[SDOI2011] 火星移民", "background": "", "description": "在 2xyz 年，人类已经移民到了火星上。由于工业的需要，人们开始在火星上采矿。火星的矿区是一个边长为 $N$ 的正六边形，为了方便规划，整个矿区被分为 $6 \\times N \\times N$ 个正三角形的区域（如图 $1$）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/po1ic1wr.png)\n\n整个矿区中存在 $A$ 矿，$B$ 矿，$C$ 矿三个矿场，和 $a$ 厂，$b$ 厂，$c$ 厂三个炼矿厂。每个三角形的区域可以是一个矿场、炼矿厂、山地、或者平地。\n\n现在矿区管理局要求建立一个交通系统，使得矿场和对应炼矿厂之间存在一条公路，并且三条公路互不交叉（即一个三角形区域中不存在两条以上运输不同矿的公路）。两个三角形区域是相邻的当且仅当这两个三角形存在公共边，只有相邻的两个区域之间才能建一段路，建这段路的费用为 $1$。\n\n注意，山地上是不能建公路的。由于火星金融危机的影响，矿区管理局想知道建立这样一个交通系统最少要花多少费用。更多的，当局向知道有多少种花费最小的方案。\n", "inputFormat": "第 $1$ 行一个整数 $N$。表示这个矿区是边长为 $N$ 的正六边形。\n\n接下来有 $6\\times N\\times N$ 的整数，分为 $2\\ \\times N$ 行，表示矿区当前区域的情况。$0$ 表示平地，$1,2,3$ 表示对应的矿区或者炼矿厂，$4$ 表示山地。（样例 $1$ 对应图 $2$）。\n\n可能有多组数据，请处理到文件结尾。", "outputFormat": "对于每组数据，包含两个整数，表示最小费用和达到最小费用的方案数。如果找不到符合要求的方案，输出 $\\verb!-1 -1!$。由于方案数可能过大，所以请把方案数 $\\bmod (10^9+7)$。", "hint": "样例2解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xbsmfw8q.png)\n\n【数据规模和约定】\n\n对于 $50\\%$ 的数据，$N \\le 4$。\n\n对于 $100\\%$ 的数据，$N \\le 6$。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2011] Mars Immigration", "background": "", "description": "In the year 2xyz, humans have already immigrated to Mars. Due to industrial needs, people have started mining on Mars. The mining area is a regular hexagon with side length $N$. For planning convenience, the entire area is divided into $6 \\times N \\times N$ regular triangular cells (see Figure $1$).\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/po1ic1wr.png)\n\nThere are three mines of types $A$, $B$, $C$, and three refineries of types $a$, $b$, $c$. Each triangular cell can be a mine, a refinery, a mountain, or flatland.\n\nThe management requires building a transportation system such that there is a road between each mine and its corresponding refinery (i.e., $A$ connects to $a$, $B$ to $b$, $C$ to $c$), and the three roads do not cross each other (that is, no triangular cell may be used by two or more roads transporting different ores). Two triangular cells are adjacent if and only if they share a common edge; roads may be built only between adjacent cells, and the cost to build such a road segment is $1$.\n\nNote that roads cannot be built on mountains. Due to a Martian financial crisis, the management wants to know the minimum total cost to build such a transportation system. Moreover, they want to know how many minimum-cost solutions there are.", "inputFormat": "The first line contains an integer $N$, the side length of the regular hexagonal mining area.\n\nThen follow $6 \\times N \\times N$ integers, given in $2 \\times N$ lines, each containing $3 \\times N$ integers, describing the current state of each cell. $0$ denotes flatland, $1, 2, 3$ denote the corresponding mine or refinery, and $4$ denotes mountain. (Sample $1$ corresponds to Figure $2$.)\n\nThere may be multiple test cases; process until end of file.", "outputFormat": "For each test case, output two integers: the minimum cost and the number of minimum-cost solutions. If no feasible solution exists, output $\\verb!-1 -1!$. Since the number of solutions may be large, output the count modulo $(10^9+7)$.", "hint": "Explanation for Sample 2.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xbsmfw8q.png)\n\nConstraints\n\n- For $50\\%$ of the testdata, $N \\le 4$.\n- For $100\\%$ of the testdata, $N \\le 6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2011] 火星移民", "background": "", "description": "在 2xyz 年，人类已经移民到了火星上。由于工业的需要，人们开始在火星上采矿。火星的矿区是一个边长为 $N$ 的正六边形，为了方便规划，整个矿区被分为 $6 \\times N \\times N$ 个正三角形的区域（如图 $1$）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/po1ic1wr.png)\n\n整个矿区中存在 $A$ 矿，$B$ 矿，$C$ 矿三个矿场，和 $a$ 厂，$b$ 厂，$c$ 厂三个炼矿厂。每个三角形的区域可以是一个矿场、炼矿厂、山地、或者平地。\n\n现在矿区管理局要求建立一个交通系统，使得矿场和对应炼矿厂之间存在一条公路，并且三条公路互不交叉（即一个三角形区域中不存在两条以上运输不同矿的公路）。两个三角形区域是相邻的当且仅当这两个三角形存在公共边，只有相邻的两个区域之间才能建一段路，建这段路的费用为 $1$。\n\n注意，山地上是不能建公路的。由于火星金融危机的影响，矿区管理局想知道建立这样一个交通系统最少要花多少费用。更多的，当局向知道有多少种花费最小的方案。\n", "inputFormat": "第 $1$ 行一个整数 $N$。表示这个矿区是边长为 $N$ 的正六边形。\n\n接下来有 $6\\times N\\times N$ 的整数，分为 $2\\ \\times N$ 行，表示矿区当前区域的情况。$0$ 表示平地，$1,2,3$ 表示对应的矿区或者炼矿厂，$4$ 表示山地。（样例 $1$ 对应图 $2$）。\n\n可能有多组数据，请处理到文件结尾。", "outputFormat": "对于每组数据，包含两个整数，表示最小费用和达到最小费用的方案数。如果找不到符合要求的方案，输出 $\\verb!-1 -1!$。由于方案数可能过大，所以请把方案数 $\\bmod (10^9+7)$。", "hint": "样例2解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xbsmfw8q.png)\n\n【数据规模和约定】\n\n对于 $50\\%$ 的数据，$N \\le 4$。\n\n对于 $100\\%$ 的数据，$N \\le 6$。", "locale": "zh-CN"}}}
{"pid": "P2493", "type": "P", "difficulty": 7, "samples": [["5 5\r\n11011\r\n11011\r\n11011\r\n11011\r\n11411\r\n1 1\r\n2 1\r\n3 1\r\n4 1\r\n4\r\n5 5\r\n4 4\r\n2 5\r\n1 4", "21\r\nRDDDDRRRULURULU\r\n"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2011", "各省省选", "山东", "Special Judge"], "title": "[SDOI2011] 贪食蛇", "background": "", "description": "\n相信大家都玩过贪食蛇游戏，现在有一个改版贪食蛇游戏，跟传统的贪食蛇游戏一样，贪食蛇在活动区域内运动，吃食物，但是这个改版的贪食蛇游戏有着一些特别的规则。\n\n活动区域：\n\n贪食蛇的活动区域是一个 $R$ 行 $C$ 列的网格 $A$，贪食蛇活动不能超过这个网格的范围。第 $i$ 行第 $j$ 列的方格用 $A_{i,j}$ 表示。每个方格有一个整数权值，记作 $w(A_{i,j})$。$0 \\leq w(A_{i,j}) \\leq 8$，$w(A_{i,j}) = 0$时，$A_{i,j}$ 禁止进入；$w(A_{i, j}) > 0$时，$A_{i, j}$ 允许进入。\n\n方向：\n\n对于 $P = (X_0, Y_0)$、$Q = (X_1, Y_1)$，有以下四种基本方向：\n\n- 正左(L)：$X_0 = X_1$ 且 $Y_0 = Y_1 - 1$，则称 $P$ 位于 $Q$ 的正左方向。\n- 正右(R)：$X_0 = X_1$ 且 $Y_0 = Y_1 + 1$，则称 $P$ 位于 $Q$ 的正右方向。\n- 正上(U)：$X_0 = X_1 - 1$ 且 $Y_0 = Y_1$，则称 $P$ 位于 $Q$ 的正上方向。\n- 正下(D)：$X_0 = X_1 + 1$ 且 $Y_0 = Y_1$，则称 $P$ 位于 $Q$ 的正下方向。\n\n贪食蛇：\n\n贪食蛇 $B$ 是占据若干方格的图形，占据的方格数为贪食蛇的长度，记为 $m$，则贪食蛇从头到尾，用 $B_1, B_2, \\dots, B_m$表示。记 $p$ 为贪食蛇的形态，若 $B_i$ 位于第 $X_i$ 行第 $Y_i$ 列，则 $p(B_i)=(X_i, Y_i)$。初始情况下，$m = 4$，且运动过程中始终需要满足以下限制：\n\n- 对于 $B_i$ 和 $B_{i + 1}$ $(1 \\leq i < m)$，就是贪食蛇的前、后相邻两部分，必须满足 $B_i$ 位于 $B_{i + 1}$ 的L、R、U、D四个方向之一。\n- 对于 $B_i$ 和 $B_j$ $(1 \\leq i < j \\leq m)$，$p(B_i) = (X_i, Y_i)$，$p(B_j) = (X_j,Y_j)$，需要满足 $X_i \\neq X_j$ 或 $Y_i \\neq Y_j$ 。也就是说，贪食蛇身体的任意一部分不能相交。\n\n食物：\n\n贪食蛇的活动区域内存在一些食物。每个食物位于一个允许进入的方格上，食物不会重叠。每个食物只能被吃一次。\n\n贪食蛇的运动：\n\n如果贪食蛇的头部 $B1$ 的L、R、U、D四个方向之一的 $A_{i, j}$ 能进入，且 $A_{i, j}$ 上不存在食物，则贪食蛇可以向该方向运动，新的头部位于 $A_{i, j}$ 上。记 $p'$ 为贪食蛇新的形态，则：\n\n- $p'(B_k) = p(B_{k - 1})$，当 $2 \\leq k \\leq m$。\n- $p'(B_k) = (i, j)$，当 $k = 1$。\n\n贪食蛇的进食：\n\n如果贪食蛇的头部 $B_1$ 的L、R、U、D四个方向之一的 $A_{i, j}$ 能进入，且 $A_{i,j}$ 上存在食物，则贪食蛇可以向该方向进食，新的头部位于 $A_{i, j}$ 上，蛇的新长度 $m'=m+1$。记 $p'$ 为贪食蛇新的位置，则：\n\n- $p'(B_k) = p(B_{k-1})$，当 $2 \\leq k \\leq m'$。\n- $p'(B_k) = (i,j)$，当 $k = 1$.\n\n注意：运动或进食后的贪食蛇形态，仅仅需要考虑变换后的形态是否满足限制，不需要考虑变换的过程。也就是说，原来形态合法的贪食蛇的头部可以运动到尾部的位置，因为在变换后头部和尾部仍不会重叠。\n\n运动或进食所需要的时间：\n\n贪食蛇运动或进食，需要消耗时间。设运动或进食前头部所在的方格是P，运动或进食后头部所在的方格是 $Q$，则此次运动或进食的所消耗的时间为 $|w(P) - w(Q)| + 1$。\n\n游戏的会在开始前给出贪食蛇的初始位置和所有食物的位置。你的任务是，以最少的时间令贪食蛇吃完所有食物。", "inputFormat": "第一行，两个正整数 $R, C$。\n\n接下来 $R$ 行，每行 $C$ 个没有空格分隔的数字。其中第 $i$ 行第 $j$ 个数字为 $w(A_{i, j})$。\n\n接下来 $4$ 行，每行 $2$ 个正整数。第 $i$ 行的两个整数 $X_i, Y_i$，表示 $p(B_i) = (X_i, Y_i)$。\n\n接下来一个正整数 $N$，表示食物的数量。\n\n接下来 $N$ 行，每行 $2$ 个正整数 $i, j$，表示 $A_{i, j}$上存在一个食物。", "outputFormat": "如果贪食蛇不能吃到所有的食物，输出 `No solution.`。\n\n否则，输出：\n\n第一行，一个整数，表示所需花费的时间；\n\n第二行，一个由 L、R、U、D 组成的字符串，表示贪食蛇前进的方案。如果存在多种可能，你只需输出任意一种。", "hint": "- 对于 $20\\%$ 的数据，$N \\leq 1$；\n- 对于 $30\\%$ 的数据，$R \\times C \\leq 36$；\n- 对于 $40\\%$ 的数据，$N \\leq 2$；\n- 对于 $60\\%$ 的数据，$N \\leq 3$；\n- 对于 $100\\%$ 的数据，$N \\leq 4$，$R \\leq 12$，$C \\leq 12$。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2011] Snake", "background": "", "description": "Everyone has probably played the Snake game. Now there is a modified version. As in the traditional Snake game, the snake moves within a play area and eats food, but this modified version has some special rules.\n\nPlay area:\n\nThe snake moves in an $R$-by-$C$ grid $A$ and may not leave this grid. The cell in row $i$, column $j$ is denoted $A_{i, j}$. Each cell has an integer weight $w(A_{i, j})$. $0 \\leq w(A_{i, j}) \\leq 8$. When $w(A_{i, j}) = 0$, $A_{i, j}$ is forbidden to enter; when $w(A_{i, j}) > 0$, $A_{i, j}$ is allowed to enter.\n\nDirections:\n\nFor $P = (X_0, Y_0)$ and $Q = (X_1, Y_1)$, there are four basic directions:\n\n- Left (L): if $X_0 = X_1$ and $Y_0 = Y_1 - 1$, then $P$ is to the left of $Q$.\n- Right (R): if $X_0 = X_1$ and $Y_0 = Y_1 + 1$, then $P$ is to the right of $Q$.\n- Up (U): if $X_0 = X_1 - 1$ and $Y_0 = Y_1$, then $P$ is above $Q$.\n- Down (D): if $X_0 = X_1 + 1$ and $Y_0 = Y_1$, then $P$ is below $Q$.\n\nSnake:\n\nThe snake $B$ is a shape occupying several cells. The number of occupied cells is the snake’s length, denoted $m$. From head to tail, the snake is $B_1, B_2, \\dots, B_m$. Let $p$ be the snake’s configuration. If $B_i$ is at row $X_i$, column $Y_i$, then $p(B_i) = (X_i, Y_i)$. Initially, $m = 4$, and during movement the following constraints must always hold:\n\n- For adjacent parts $B_i$ and $B_{i+1}$ ($1 \\leq i < m$), $B_i$ must be in one of the L, R, U, D directions relative to $B_{i+1}$.\n- For any $B_i$ and $B_j$ ($1 \\leq i < j \\leq m$), with $p(B_i) = (X_i, Y_i)$ and $p(B_j) = (X_j, Y_j)$, it must hold that $X_i \\neq X_j$ or $Y_i \\neq Y_j$. In other words, no two parts of the snake’s body may overlap.\n\nFood:\n\nThere is some food in the play area. Each piece of food is on a cell that is allowed to enter, and food pieces do not overlap. Each piece of food can be eaten at most once.\n\nSnake movement:\n\nIf one of the cells $A_{i, j}$ in the L, R, U, or D direction from the head $B_1$ is enterable and there is no food on $A_{i, j}$, the snake may move in that direction, and the new head will be at $A_{i, j}$. Let $p'$ be the new configuration of the snake. Then:\n\n- $p'(B_k) = p(B_{k - 1})$ for $2 \\leq k \\leq m$.\n- $p'(B_k) = (i, j)$ for $k = 1$.\n\nSnake eating:\n\nIf one of the cells $A_{i, j}$ in the L, R, U, or D direction from the head $B_1$ is enterable and there is food on $A_{i, j}$, the snake may move there to eat. The new head will be at $A_{i, j}$, and the new length is $m' = m + 1$. Let $p'$ be the new configuration. Then:\n\n- $p'(B_k) = p(B_{k - 1})$ for $2 \\leq k \\leq m'$.\n- $p'(B_k) = (i, j)$ for $k = 1$.\n\nNote: After moving or eating, you only need to check whether the resulting configuration satisfies the constraints; you do not need to consider the intermediate process. In other words, it is allowed for a snake whose current configuration is legal to move its head into the previous position of the tail, because the head and tail still do not overlap after the transformation.\n\nTime required for movement or eating:\n\nMovement or eating consumes time. Let $P$ be the cell of the head before the action, and let $Q$ be the cell of the head after the action. Then the time cost of this action is $|w(P) - w(Q)| + 1$.\n\nBefore the game begins, the snake’s initial position and all food positions are given. Your task is to make the snake eat all the food in the least possible time.", "inputFormat": "The first line contains two positive integers $R, C$.\n\nThen follow $R$ lines, each containing $C$ digits without spaces. In the $i$-th line, the $j$-th digit is $w(A_{i, j})$.\n\nThen follow $4$ lines, each containing $2$ positive integers. In the $i$-th of these lines, the two integers $X_i, Y_i$ indicate $p(B_i) = (X_i, Y_i)$.\n\nThen a positive integer $N$ follows, denoting the number of food items.\n\nThen follow $N$ lines, each containing $2$ positive integers $i, j$, indicating that there is a piece of food on $A_{i, j}$.", "outputFormat": "If the snake cannot eat all the food, output `No solution.`.\n\nOtherwise, output:\n- The first line contains an integer, the minimum total time required.\n- The second line contains a string consisting of characters L, R, U, and D, representing a movement plan for the snake. If multiple solutions exist, output any one of them.", "hint": "- For $20\\%$ of the testdata, $N \\leq 1$.\n- For $30\\%$ of the testdata, $R \\times C \\leq 36$.\n- For $40\\%$ of the testdata, $N \\leq 2$.\n- For $60\\%$ of the testdata, $N \\leq 3$.\n- For $100\\%$ of the testdata, $N \\leq 4$, $R \\leq 12$, $C \\leq 12$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2011] 贪食蛇", "background": "", "description": "\n相信大家都玩过贪食蛇游戏，现在有一个改版贪食蛇游戏，跟传统的贪食蛇游戏一样，贪食蛇在活动区域内运动，吃食物，但是这个改版的贪食蛇游戏有着一些特别的规则。\n\n活动区域：\n\n贪食蛇的活动区域是一个 $R$ 行 $C$ 列的网格 $A$，贪食蛇活动不能超过这个网格的范围。第 $i$ 行第 $j$ 列的方格用 $A_{i,j}$ 表示。每个方格有一个整数权值，记作 $w(A_{i,j})$。$0 \\leq w(A_{i,j}) \\leq 8$，$w(A_{i,j}) = 0$时，$A_{i,j}$ 禁止进入；$w(A_{i, j}) > 0$时，$A_{i, j}$ 允许进入。\n\n方向：\n\n对于 $P = (X_0, Y_0)$、$Q = (X_1, Y_1)$，有以下四种基本方向：\n\n- 正左(L)：$X_0 = X_1$ 且 $Y_0 = Y_1 - 1$，则称 $P$ 位于 $Q$ 的正左方向。\n- 正右(R)：$X_0 = X_1$ 且 $Y_0 = Y_1 + 1$，则称 $P$ 位于 $Q$ 的正右方向。\n- 正上(U)：$X_0 = X_1 - 1$ 且 $Y_0 = Y_1$，则称 $P$ 位于 $Q$ 的正上方向。\n- 正下(D)：$X_0 = X_1 + 1$ 且 $Y_0 = Y_1$，则称 $P$ 位于 $Q$ 的正下方向。\n\n贪食蛇：\n\n贪食蛇 $B$ 是占据若干方格的图形，占据的方格数为贪食蛇的长度，记为 $m$，则贪食蛇从头到尾，用 $B_1, B_2, \\dots, B_m$表示。记 $p$ 为贪食蛇的形态，若 $B_i$ 位于第 $X_i$ 行第 $Y_i$ 列，则 $p(B_i)=(X_i, Y_i)$。初始情况下，$m = 4$，且运动过程中始终需要满足以下限制：\n\n- 对于 $B_i$ 和 $B_{i + 1}$ $(1 \\leq i < m)$，就是贪食蛇的前、后相邻两部分，必须满足 $B_i$ 位于 $B_{i + 1}$ 的L、R、U、D四个方向之一。\n- 对于 $B_i$ 和 $B_j$ $(1 \\leq i < j \\leq m)$，$p(B_i) = (X_i, Y_i)$，$p(B_j) = (X_j,Y_j)$，需要满足 $X_i \\neq X_j$ 或 $Y_i \\neq Y_j$ 。也就是说，贪食蛇身体的任意一部分不能相交。\n\n食物：\n\n贪食蛇的活动区域内存在一些食物。每个食物位于一个允许进入的方格上，食物不会重叠。每个食物只能被吃一次。\n\n贪食蛇的运动：\n\n如果贪食蛇的头部 $B1$ 的L、R、U、D四个方向之一的 $A_{i, j}$ 能进入，且 $A_{i, j}$ 上不存在食物，则贪食蛇可以向该方向运动，新的头部位于 $A_{i, j}$ 上。记 $p'$ 为贪食蛇新的形态，则：\n\n- $p'(B_k) = p(B_{k - 1})$，当 $2 \\leq k \\leq m$。\n- $p'(B_k) = (i, j)$，当 $k = 1$。\n\n贪食蛇的进食：\n\n如果贪食蛇的头部 $B_1$ 的L、R、U、D四个方向之一的 $A_{i, j}$ 能进入，且 $A_{i,j}$ 上存在食物，则贪食蛇可以向该方向进食，新的头部位于 $A_{i, j}$ 上，蛇的新长度 $m'=m+1$。记 $p'$ 为贪食蛇新的位置，则：\n\n- $p'(B_k) = p(B_{k-1})$，当 $2 \\leq k \\leq m'$。\n- $p'(B_k) = (i,j)$，当 $k = 1$.\n\n注意：运动或进食后的贪食蛇形态，仅仅需要考虑变换后的形态是否满足限制，不需要考虑变换的过程。也就是说，原来形态合法的贪食蛇的头部可以运动到尾部的位置，因为在变换后头部和尾部仍不会重叠。\n\n运动或进食所需要的时间：\n\n贪食蛇运动或进食，需要消耗时间。设运动或进食前头部所在的方格是P，运动或进食后头部所在的方格是 $Q$，则此次运动或进食的所消耗的时间为 $|w(P) - w(Q)| + 1$。\n\n游戏的会在开始前给出贪食蛇的初始位置和所有食物的位置。你的任务是，以最少的时间令贪食蛇吃完所有食物。", "inputFormat": "第一行，两个正整数 $R, C$。\n\n接下来 $R$ 行，每行 $C$ 个没有空格分隔的数字。其中第 $i$ 行第 $j$ 个数字为 $w(A_{i, j})$。\n\n接下来 $4$ 行，每行 $2$ 个正整数。第 $i$ 行的两个整数 $X_i, Y_i$，表示 $p(B_i) = (X_i, Y_i)$。\n\n接下来一个正整数 $N$，表示食物的数量。\n\n接下来 $N$ 行，每行 $2$ 个正整数 $i, j$，表示 $A_{i, j}$上存在一个食物。", "outputFormat": "如果贪食蛇不能吃到所有的食物，输出 `No solution.`。\n\n否则，输出：\n\n第一行，一个整数，表示所需花费的时间；\n\n第二行，一个由 L、R、U、D 组成的字符串，表示贪食蛇前进的方案。如果存在多种可能，你只需输出任意一种。", "hint": "- 对于 $20\\%$ 的数据，$N \\leq 1$；\n- 对于 $30\\%$ 的数据，$R \\times C \\leq 36$；\n- 对于 $40\\%$ 的数据，$N \\leq 2$；\n- 对于 $60\\%$ 的数据，$N \\leq 3$；\n- 对于 $100\\%$ 的数据，$N \\leq 4$，$R \\leq 12$，$C \\leq 12$。", "locale": "zh-CN"}}}
{"pid": "P2494", "type": "P", "difficulty": 7, "samples": [["5 5\r\n5 1 10 1\r\n5 1 10 1\r\n5 2 9 1\r\n5 3 7 1\r\n5 4 8 1\r\n4 4\r\n1 2\r\n1 4\r\n3 2\r\n3 4", "17.0"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "各省省选", "网络流", "山东", "分数规划"], "title": "[SDOI2011] 保密", "background": "", "description": "现在，保密成为一个很重要也很困难的问题。如果没有做好，后果是严重的。比如，有个人没有自己去修电脑，又没有拆硬盘，后来的事大家都知道了。\n\n当然，对保密最需求的当然是军方，其次才是像那个人。为了应付现在天上飞来飞去的卫星，军事基地一般都会建造在地下。\n\n某 K 国的军事基地是这样子的：地面上两排大天井共 $n_1$ 个作为出入口，内部是许多除可以共享出入口外互不连通的空腔，每个空腔有且只有两个出入口，并且这两个出入口不会在同一排。为了方便起见，两排出入口分别编号为 $1, 3, 5, \\dots$ 和 $2, 4, 6, \\dots$ 并且最大的编号为 $n_1$。\n\n虽然上面扯了那么多关于保密的东西，但是其实解密也是一件很纠结的事情。但其实最简单直接暴力无脑的解密方法就是找个人去看看…\n\n我们有很牛 X 的特种部队，只需要派出一支特种部队到 K 国基地的某个出入口，那么和这个出入口直接相连的所有空腔都可以被探索，但也只有这些空腔可以被这支部队探索。现在有足够多的特种部队可以供你调遣，你必须使用他们调查完所有的 K 国基地内的空腔。\n\n当然，你的基地离 K 国基地不会太近，周边的地图将会给你，表示为 $n$ 个检查点和 $m$ 条连接这些点的道路，其中点 $1$ 到点 $n_1$ 就是 K 国基地的出入口，点 $n$ 是你的部队的出发点。对每条道路，有不同的通行时间 $t$ 和安全系数 $s$ 。因为情报部门只对单向的道路安全系数进行了评估，所以这些道路只允许单向通行，并且不会存在环。\n\n一支特种部队从你的基地出发，通过某条路径，到达某个 K 国基地出入口，此时这支部队的危险性表示为总时间和这条路径经过的所有道路的安全系数和的比值。整个行动的危险性表示为你派出的所有部队的危险性之和。你需要使这个值最小的情况下探索整个 K 国基地。\n\n快点完成这个任务，在 K 国的叫兽宣布你是 K 国人之前。", "inputFormat": "第一行 2 个正整数 $n, m$ 表示整个地区地图上的检查点和道路数。\n\n下面 $m$ 行，每行 4 个正整数 $a, b, t, s$ 表示一条从 $a$ 到 $b$ 的道路需时为 $t$，安全系数为 $s$。\n\n接下来 1 行 2 个正整数 $m_1$ 和 $n_1$, $m_1$ 表示 K 国基地空腔的个数，$n_1$ 表示 K 国基地出入口的个数。\n\n再接下来 $m_1$ 行，每行 2 个正整数 $u, v$，表示每个空腔的 $2$ 个出入口。", "outputFormat": "一行，最小的危险性，保留一位小数。或者输出 `-1` 表示此任务不可能完成。", "hint": "- 对 $30\\%$ 的数据，$n \\leq 30$；\n- 对 $60\\%$ 的数据，$n \\leq 300$；\n- 另外 $40\\%$ 的数据 $n_1 \\leq 20$。\n- 对于 $100\\%$ 的数据，$4 \\leq n \\leq 700$，$m \\leq 100000$，$a, b \\leq n$，$1 \\leq t, s \\leq 10$，$m_1 \\leq 40000$，$n_1 < \\min(n, 161)$，$u, v \\leq n_1$，$u$ 是奇数，$v$ 是偶数。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2011] Secrecy", "background": "", "description": "Nowadays, secrecy has become very important and also very difficult. If it is not done well, the consequences can be serious. For example, someone did not repair their computer themselves and did not remove the hard drive—what happened afterward is known to everyone.\n\nOf course, the military needs secrecy the most, more than ordinary people. To cope with satellites flying around in the sky, military bases are usually built underground.\n\nA certain base in country K is structured as follows: on the ground, there are two rows of large shafts serving as entrances and exits, with a total of $n_1$. Inside, there are many cavities that are mutually disconnected except that they can share entrances. Each cavity has exactly two entrances, and these two entrances are not in the same row. For convenience, the entrances in the two rows are numbered $1, 3, 5, \\dots$ and $2, 4, 6, \\dots$, and the largest index is $n_1$.\n\nAlthough we have talked so much about secrecy, decryption is also a tangled matter. In fact, the simplest brute-force decryption method is to send someone to have a look...\n\nWe have elite special forces. If you deploy one unit to some entrance of the base in country K, then all cavities directly connected to that entrance can be explored by that unit, and only those cavities can be explored by that unit. Now you have enough units at your disposal, and you must use them to explore all cavities inside the base in country K.\n\nYour base is not too close to the base in country K. You are given a map of the surrounding area, represented by $n$ checkpoints and $m$ roads connecting these points. Points $1$ through $n_1$ are the entrances to the base in country K, and point $n$ is the starting point of your units. For each road, there is a travel time $t$ and a safety factor $s$. Because the intelligence department assessed safety only for one-way roads, these roads are one-way only, and there are no cycles.\n\nA unit departs from your base, follows some path, and reaches an entrance of the base in country K. The risk of this unit is defined as the ratio of the total time to the sum of the safety factors of all roads along that path. The overall operation risk is the sum of the risks of all the units you dispatch. You need to explore the entire base in country K while minimizing this value.\n\nHurry up and finish this task before a certain professor in country K declares that you are from country K.", "inputFormat": "The first line contains two positive integers $n, m$, the number of checkpoints and roads on the map.\n\nEach of the next $m$ lines contains four positive integers $a, b, t, s$, indicating a one-way road from $a$ to $b$ with travel time $t$ and safety factor $s$.\n\nThe next line contains two positive integers $m_1$ and $n_1$, where $m_1$ is the number of cavities in the base in country K, and $n_1$ is the number of entrances.\n\nEach of the next $m_1$ lines contains two positive integers $u, v$, indicating the two entrances of each cavity.", "outputFormat": "Output one line with the minimum total risk, to one decimal place. Output -1 if the task is impossible.", "hint": "- For 30% of the testdata, $n \\leq 30$.\n- For 60% of the testdata, $n \\leq 300$.\n- For an additional 40% of the testdata, $n_1 \\leq 20$.\n- For 100% of the testdata: $4 \\leq n \\leq 700$, $m \\leq 100000$, $a, b \\leq n$, $1 \\leq t, s \\leq 10$, $m_1 \\leq 40000$, $n_1 < \\min(n, 161)$, $u, v \\leq n_1$, $u$ is odd, and $v$ is even.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2011] 保密", "background": "", "description": "现在，保密成为一个很重要也很困难的问题。如果没有做好，后果是严重的。比如，有个人没有自己去修电脑，又没有拆硬盘，后来的事大家都知道了。\n\n当然，对保密最需求的当然是军方，其次才是像那个人。为了应付现在天上飞来飞去的卫星，军事基地一般都会建造在地下。\n\n某 K 国的军事基地是这样子的：地面上两排大天井共 $n_1$ 个作为出入口，内部是许多除可以共享出入口外互不连通的空腔，每个空腔有且只有两个出入口，并且这两个出入口不会在同一排。为了方便起见，两排出入口分别编号为 $1, 3, 5, \\dots$ 和 $2, 4, 6, \\dots$ 并且最大的编号为 $n_1$。\n\n虽然上面扯了那么多关于保密的东西，但是其实解密也是一件很纠结的事情。但其实最简单直接暴力无脑的解密方法就是找个人去看看…\n\n我们有很牛 X 的特种部队，只需要派出一支特种部队到 K 国基地的某个出入口，那么和这个出入口直接相连的所有空腔都可以被探索，但也只有这些空腔可以被这支部队探索。现在有足够多的特种部队可以供你调遣，你必须使用他们调查完所有的 K 国基地内的空腔。\n\n当然，你的基地离 K 国基地不会太近，周边的地图将会给你，表示为 $n$ 个检查点和 $m$ 条连接这些点的道路，其中点 $1$ 到点 $n_1$ 就是 K 国基地的出入口，点 $n$ 是你的部队的出发点。对每条道路，有不同的通行时间 $t$ 和安全系数 $s$ 。因为情报部门只对单向的道路安全系数进行了评估，所以这些道路只允许单向通行，并且不会存在环。\n\n一支特种部队从你的基地出发，通过某条路径，到达某个 K 国基地出入口，此时这支部队的危险性表示为总时间和这条路径经过的所有道路的安全系数和的比值。整个行动的危险性表示为你派出的所有部队的危险性之和。你需要使这个值最小的情况下探索整个 K 国基地。\n\n快点完成这个任务，在 K 国的叫兽宣布你是 K 国人之前。", "inputFormat": "第一行 2 个正整数 $n, m$ 表示整个地区地图上的检查点和道路数。\n\n下面 $m$ 行，每行 4 个正整数 $a, b, t, s$ 表示一条从 $a$ 到 $b$ 的道路需时为 $t$，安全系数为 $s$。\n\n接下来 1 行 2 个正整数 $m_1$ 和 $n_1$, $m_1$ 表示 K 国基地空腔的个数，$n_1$ 表示 K 国基地出入口的个数。\n\n再接下来 $m_1$ 行，每行 2 个正整数 $u, v$，表示每个空腔的 $2$ 个出入口。", "outputFormat": "一行，最小的危险性，保留一位小数。或者输出 `-1` 表示此任务不可能完成。", "hint": "- 对 $30\\%$ 的数据，$n \\leq 30$；\n- 对 $60\\%$ 的数据，$n \\leq 300$；\n- 另外 $40\\%$ 的数据 $n_1 \\leq 20$。\n- 对于 $100\\%$ 的数据，$4 \\leq n \\leq 700$，$m \\leq 100000$，$a, b \\leq n$，$1 \\leq t, s \\leq 10$，$m_1 \\leq 40000$，$n_1 < \\min(n, 161)$，$u, v \\leq n_1$，$u$ 是奇数，$v$ 是偶数。", "locale": "zh-CN"}}}
{"pid": "P2495", "type": "P", "difficulty": 6, "samples": [["10\n1 5 13\n1 9 6\n2 1 19\n2 4 8\n2 3 91\n5 6 8\n7 5 4\n7 8 31\n10 7 9\n3\n2 10 6\n4 5 7 8 3\n3 9 4 6\n", "12\n32\n22\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [517120, 517120, 517120, 517120, 517120, 517120, 517120, 517120, 517120, 517120]}, "tags": ["2011", "各省省选", "山东", "最近公共祖先 LCA", "虚树", "栈", "动态 DP", "模板题"], "title": "【模板】虚树 / [SDOI2011] 消耗战", "background": "", "description": "在一场战争中，战场由 $n$ 个岛屿和 $n-1$ 个桥梁组成，保证每两个岛屿间有且仅有一条路径可达。现在，我军已经侦查到敌军的总部在编号为 $1$ 的岛屿，而且他们已经没有足够多的能源维系战斗，我军胜利在望。已知在其他 $k$ 个岛屿上有丰富能源，为了防止敌军获取能源，我军的任务是炸毁一些桥梁，使得敌军不能到达任何能源丰富的岛屿。由于不同桥梁的材质和结构不同，所以炸毁不同的桥梁有不同的代价，我军希望在满足目标的同时使得总代价最小。  \n\n侦查部门还发现，敌军有一台神秘机器。即使我军切断所有能源之后，他们也可以用那台机器。机器产生的效果不仅仅会修复所有我军炸毁的桥梁，而且会重新随机资源分布（但可以保证的是，资源不会分布到 $1$ 号岛屿上）。不过侦查部门还发现了这台机器只能够使用 $m$ 次，所以我们只需要把每次任务完成即可。", "inputFormat": "第一行一个整数 $n$，表示岛屿数量。  \n\n接下来 $n-1$ 行，每行三个整数 $u,v,w$ ，表示 $u$ 号岛屿和 $v$ 号岛屿由一条代价为 $w$ 的桥梁直接相连。  \n\n第 $n+1$ 行，一个整数 $m$ ，代表敌方机器能使用的次数。  \n\n接下来 $m$ 行，第 $i$ 行一个整数 $k_i$ ，代表第 $i$ 次后，有 $k_i$ 个岛屿资源丰富。接下来 $k_i$ 个整数 $h_1,h_2,..., h_{k_i}$ ，表示资源丰富岛屿的编号。", "outputFormat": "输出共 $m$ 行，表示每次任务的最小代价。", "hint": "#### 数据规模与约定\n\n- 对于 $10\\%$ 的数据，$n\\leq 10, m\\leq 5$ 。  \n- 对于 $20\\%$ 的数据，$n\\leq 100, m\\leq 100, 1\\leq k_i\\leq 10$ 。  \n- 对于 $40\\%$ 的数据，$n\\leq 1000, 1\\leq k_i\\leq 15$ 。  \n- 对于 $100\\%$ 的数据，$2\\leq n \\leq 2.5\\times 10^5, 1\\leq m\\leq 5\\times 10^5, \\sum k_i \\leq 5\\times 10^5, 1\\leq k_i< n, h_i\\neq 1, 1\\leq u,v\\leq n, 1\\leq w\\leq 10^5$ 。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Virtual Tree / [SDOI2011] War of Attrition", "background": "", "description": "In a war, the battlefield consists of $n$ islands connected by $n-1$ bridges, and there is exactly one simple path between any two islands. Our intelligence has located the enemy headquarters on island $1$. The enemy lacks sufficient energy to sustain combat, and victory is in sight. It is known that there are rich energy reserves on another $k$ islands. To prevent the enemy from obtaining energy, our task is to blow up some bridges so that the enemy cannot reach any energy-rich island from island $1$. Since different bridges have different materials and structures, the cost to destroy each bridge varies. We want to minimize the total cost while achieving the objective.\n\nIntelligence also found that the enemy has a mysterious machine. Even after we cut off all energy, they can use that machine. The machine will not only repair all bridges we blew up, but also randomly redistribute the energy (with the guarantee that no energy will be placed on island $1$). However, the machine can be used only $m$ times, so we only need to complete the task for each use.", "inputFormat": "The first line contains an integer $n$, the number of islands.\n\nThe next $n-1$ lines each contain three integers $u, v, w$, indicating that islands $u$ and $v$ are directly connected by a bridge with destruction cost $w$.\n\nThe $(n+1)$-th line contains an integer $m$, the number of times the enemy can use the machine.\n\nThen follow $m$ lines. On the $i$-th line, there is an integer $k_i$, meaning that after the $i$-th reset there are $k_i$ energy-rich islands, followed by $k_i$ integers $h_1, h_2, \\ldots, h_{k_i}$, which are the indices of the energy-rich islands.", "outputFormat": "Output $m$ lines. For each use of the machine, output the minimum total cost required to prevent the enemy from reaching any energy-rich island from island $1$.", "hint": "#### Constraints\n\n- For $10\\%$ of the testdata, $n \\leq 10$, $m \\leq 5$.\n- For $20\\%$ of the testdata, $n \\leq 100$, $m \\leq 100$, $1 \\leq k_i \\leq 10$.\n- For $40\\%$ of the testdata, $n \\leq 1000$, $1 \\leq k_i \\leq 15$.\n- For $100\\%$ of the testdata, $2 \\leq n \\leq 2.5\\times 10^5$, $1 \\leq m \\leq 5\\times 10^5$, $\\sum k_i \\leq 5\\times 10^5$, $1 \\leq k_i < n$, $h_i \\neq 1$, $1 \\leq u, v \\leq n$, $1 \\leq w \\leq 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】虚树 / [SDOI2011] 消耗战", "background": "", "description": "在一场战争中，战场由 $n$ 个岛屿和 $n-1$ 个桥梁组成，保证每两个岛屿间有且仅有一条路径可达。现在，我军已经侦查到敌军的总部在编号为 $1$ 的岛屿，而且他们已经没有足够多的能源维系战斗，我军胜利在望。已知在其他 $k$ 个岛屿上有丰富能源，为了防止敌军获取能源，我军的任务是炸毁一些桥梁，使得敌军不能到达任何能源丰富的岛屿。由于不同桥梁的材质和结构不同，所以炸毁不同的桥梁有不同的代价，我军希望在满足目标的同时使得总代价最小。  \n\n侦查部门还发现，敌军有一台神秘机器。即使我军切断所有能源之后，他们也可以用那台机器。机器产生的效果不仅仅会修复所有我军炸毁的桥梁，而且会重新随机资源分布（但可以保证的是，资源不会分布到 $1$ 号岛屿上）。不过侦查部门还发现了这台机器只能够使用 $m$ 次，所以我们只需要把每次任务完成即可。", "inputFormat": "第一行一个整数 $n$，表示岛屿数量。  \n\n接下来 $n-1$ 行，每行三个整数 $u,v,w$ ，表示 $u$ 号岛屿和 $v$ 号岛屿由一条代价为 $w$ 的桥梁直接相连。  \n\n第 $n+1$ 行，一个整数 $m$ ，代表敌方机器能使用的次数。  \n\n接下来 $m$ 行，第 $i$ 行一个整数 $k_i$ ，代表第 $i$ 次后，有 $k_i$ 个岛屿资源丰富。接下来 $k_i$ 个整数 $h_1,h_2,..., h_{k_i}$ ，表示资源丰富岛屿的编号。", "outputFormat": "输出共 $m$ 行，表示每次任务的最小代价。", "hint": "#### 数据规模与约定\n\n- 对于 $10\\%$ 的数据，$n\\leq 10, m\\leq 5$ 。  \n- 对于 $20\\%$ 的数据，$n\\leq 100, m\\leq 100, 1\\leq k_i\\leq 10$ 。  \n- 对于 $40\\%$ 的数据，$n\\leq 1000, 1\\leq k_i\\leq 15$ 。  \n- 对于 $100\\%$ 的数据，$2\\leq n \\leq 2.5\\times 10^5, 1\\leq m\\leq 5\\times 10^5, \\sum k_i \\leq 5\\times 10^5, 1\\leq k_i< n, h_i\\neq 1, 1\\leq u,v\\leq n, 1\\leq w\\leq 10^5$ 。", "locale": "zh-CN"}}}
{"pid": "P2496", "type": "P", "difficulty": 6, "samples": [["6 7\n109 827 100 530 10 826\n3 1 6 1\n2 2 6\n1 2 4\n1 2 3\n2 2 6\n1 2 6\n1 2 5", "722\n722\n722\n719"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "各省省选", "山东"], "title": "[SDOI2012] 体育课", "background": "", "description": "又是一节体育课的时间了，有 $n$ 个同学排成了一排。他们都很讨厌排在第一个位置的同学，于是后面的同学中比第一个高的都会产生一个高兴值，这个高兴值等于他的身高减去第一个同学的身高。当然比第一个同学矮的同学产生高兴值为 $0$。\n\n现在体育老师来了，他拥有神奇的魔法，现在他能做如下的三件事：\n\n1. 询问某段区间高兴值最大的那个是多少。\n\n2. 把某两个同学交换一下位置。\n\n3. 选取一段区间的人，把第一个人身高加上 $t$，第二个加上 $2t$，第三个加上 $3t$ 以此类推。\n\n但是体育老师不会数数，于是他找到你了，对于每一个询问，他要你帮他求出那个值。\n", "inputFormat": "第一行两个整数 $n,m$，表示有 $n$ 个人，有 $m$ 个操作。\n\n第二行 $n$ 个整数，顺序输入每个人的身高 $a_i$。\n\n接下来 $m$ 行，每行第一个数位一个 $type$ 表示是做哪一件事情。\n\n- 如果 $type=1$，那么接下来有两个整数 $l,r$，表示询问这段区间的最大的高兴值。\n- 如果 $type=2$，接下来两个整数 $a,b$，表示交换这两个位置的人。\n- 如果 $type=3$，接下来三个整数 $l,r,t$，表示把 $l$ 个人的升高增加 $t$,$l+1$ 个人增加 $2t$ ...第 $r$ 个人增加 $(r-l+1)t$。\n", "outputFormat": "对于每个询问按照顺序输出每个操作 $1$ 的答案。", "hint": "#### 数据规模与约定\n\n- 对于 $20\\%$ 的数据，保证 $1 \\le n,m \\le 5 \\times 10^3$。\n- 另有 $10\\%$ 的数据，没有第三种操作。\n- 另有 $20\\%$ 的数据，没有第二种操作。\n- 对于 $100\\%$ 的数据，$1 \\le n,m \\le 10^5$，$0 \\le t \\le 10^4$，$1 \\leq a_i \\leq 10^8$。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2012] Physical Education Class", "background": "", "description": "It is time for another PE class. There are $n$ students standing in a row. They all dislike the student at the first position. For any student behind the first one, if they are taller than the first student, they gain a happiness value equal to their height minus the height of the first student. If a student is shorter than the first student, their happiness value is $0$.\n\nNow the PE teacher comes with magical powers and can perform the following three operations:\n\n1. Query the maximum happiness value within a given interval.\n2. Swap two students.\n3. Select an interval and add $t$ to the first person in the interval, $2t$ to the second, $3t$ to the third, and so on.\n\nHowever, the teacher cannot count well, so he asks you to answer each query.\n\nFor clarity, for an interval $[l, r]$, define the happiness of position $i$ ($l \\le i \\le r$) as $\\max(0, a_i - a_l)$. Operation $1$ asks for the maximum of these values over $i \\in [l, r]$.", "inputFormat": "The first line contains two integers $n, m$, the number of students and the number of operations.\n\nThe second line contains $n$ integers, the heights $a_i$ of the students in order.\n\nEach of the following $m$ lines starts with an integer $type$ indicating the operation:\n\n- If $type = 1$, then two integers $l, r$ follow, asking for the maximum happiness value in interval $[l, r]$ as defined above.\n- If $type = 2$, then two integers $a, b$ follow, indicating to swap the students at positions $a$ and $b$.\n- If $type = 3$, then three integers $l, r, t$ follow, indicating that for every $i$ with $l \\le i \\le r$, add $(i - l + 1) \\times t$ to $a_i$.", "outputFormat": "For each query, output the answer to every operation $1$ in order.", "hint": "Constraints\n\n- For $20\\%$ of the testdata, $1 \\le n, m \\le 5 \\times 10^3$.\n- Additionally, in $10\\%$ of the testdata, there is no operation $3$.\n- Additionally, in $20\\%$ of the testdata, there is no operation $2$.\n- For $100\\%$ of the testdata, $1 \\le n, m \\le 10^5$, $0 \\le t \\le 10^4$, $1 \\le a_i \\le 10^8$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2012] 体育课", "background": "", "description": "又是一节体育课的时间了，有 $n$ 个同学排成了一排。他们都很讨厌排在第一个位置的同学，于是后面的同学中比第一个高的都会产生一个高兴值，这个高兴值等于他的身高减去第一个同学的身高。当然比第一个同学矮的同学产生高兴值为 $0$。\n\n现在体育老师来了，他拥有神奇的魔法，现在他能做如下的三件事：\n\n1. 询问某段区间高兴值最大的那个是多少。\n\n2. 把某两个同学交换一下位置。\n\n3. 选取一段区间的人，把第一个人身高加上 $t$，第二个加上 $2t$，第三个加上 $3t$ 以此类推。\n\n但是体育老师不会数数，于是他找到你了，对于每一个询问，他要你帮他求出那个值。\n", "inputFormat": "第一行两个整数 $n,m$，表示有 $n$ 个人，有 $m$ 个操作。\n\n第二行 $n$ 个整数，顺序输入每个人的身高 $a_i$。\n\n接下来 $m$ 行，每行第一个数位一个 $type$ 表示是做哪一件事情。\n\n- 如果 $type=1$，那么接下来有两个整数 $l,r$，表示询问这段区间的最大的高兴值。\n- 如果 $type=2$，接下来两个整数 $a,b$，表示交换这两个位置的人。\n- 如果 $type=3$，接下来三个整数 $l,r,t$，表示把 $l$ 个人的升高增加 $t$,$l+1$ 个人增加 $2t$ ...第 $r$ 个人增加 $(r-l+1)t$。\n", "outputFormat": "对于每个询问按照顺序输出每个操作 $1$ 的答案。", "hint": "#### 数据规模与约定\n\n- 对于 $20\\%$ 的数据，保证 $1 \\le n,m \\le 5 \\times 10^3$。\n- 另有 $10\\%$ 的数据，没有第三种操作。\n- 另有 $20\\%$ 的数据，没有第二种操作。\n- 对于 $100\\%$ 的数据，$1 \\le n,m \\le 10^5$，$0 \\le t \\le 10^4$，$1 \\leq a_i \\leq 10^8$。", "locale": "zh-CN"}}}
