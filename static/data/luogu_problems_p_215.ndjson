{"pid": "P5349", "type": "P", "difficulty": 6, "samples": [["1 499122177\n0 1", "2"], ["2 748683265\n0 0 1", "628524223"], ["3 713031681\n7 5 23 2", "257147786"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "幂", "background": "来到数学院劳动\n", "description": "$$\\text{求}\\ \\sum_{n=0}^{\\infty}f(n)\\ r^n\\ ,\\ f(n)\\text{为一个多项式},\\ r\\text{是一个}(0,1)\\text{内的有理数}$$\n\n若答案的最简分数为$\\frac{p}{q}$，你只需要输出$p\\times q^{-1}\\  \\mathrm{mod} \\ 998244353\\ $的值即可。", "inputFormat": "第一行两个整数$m,r$。$m$为多项式的次数。\n\n第二行$m+1$个整数，第$i$个为$x^{i-1}$的系数$a_{i-1}$。", "outputFormat": "仅一行一个数字，为答案。", "hint": "对于$10\\%$的数据，$m\\le 5$。\n\n对于$40\\%$的数据，$m\\le 2000$。\n\n对于$100\\%$的数据，$m\\le 10^5\\ ,\\ a_i\\in [0,998244353)$，保证$\\ a_{m}\\neq 0$\n\n**捆绑测试**\n\n----\n\n**样例1解释：**\n\n$499122177\\equiv \\frac{1}{2}\\ (\\mathrm{mod}\\ 998244353)$\n\n$\\sum_{n=0}^{\\infty}n\\ (\\frac{1}{2})^n=2$\n\n-----\n\n**样例2解释：**\n\n$748683265\\equiv \\frac{1}{4}\\ (\\mathrm{mod}\\ 998244353)$\n\n$\\sum_{n=0}^{\\infty}n^2\\ (\\frac{1}{4})^n=\\frac{20}{27}$\n\n-----\n\n**样例3解释：**\n\n$713031681\\equiv \\frac{2}{7}\\ (\\mathrm{mod}\\ 998244353)$\n\n$\\sum_{n=0}^{\\infty}(2n^3+23n^2+5n+7)\\ (\\frac{2}{7})^n=\\frac{25417}{625}$\n\n", "locale": "zh-CN", "translations": {"en": {"title": "Power", "background": "Came to the School of Mathematics to do labor.", "description": "$$\\text{Find}\\ \\sum_{n=0}^{\\infty}f(n)\\ r^n\\ ,\\ f(n)\\text{ is a polynomial},\\ r\\text{ is a rational number in }(0,1)$$\n\nIf the simplest fraction form of the answer is $\\frac{p}{q}$, you only need to output the value of $p\\times q^{-1}\\ \\mathrm{mod}\\ 998244353$.", "inputFormat": "The first line contains two integers $m, r$. $m$ is the degree of the polynomial.\n\nThe second line contains $m+1$ integers. The $i$-th integer is the coefficient $a_{i-1}$ of $x^{i-1}$.", "outputFormat": "Only one line with one number, which is the answer.", "hint": "For $10\\%$ of the testdata, $m\\le 5$.\n\nFor $40\\%$ of the testdata, $m\\le 2000$.\n\nFor $100\\%$ of the testdata, $m\\le 10^5\\ ,\\ a_i\\in [0,998244353)$, and it is guaranteed that $\\ a_{m}\\neq 0$.\n\n**Bundled Tests**\n\n----\n\n**Sample 1 Explanation:**\n\n$499122177\\equiv \\frac{1}{2}\\ (\\mathrm{mod}\\ 998244353)$.\n\n$\\sum_{n=0}^{\\infty}n\\ (\\frac{1}{2})^n=2$.\n\n-----\n\n**Sample 2 Explanation:**\n\n$748683265\\equiv \\frac{1}{4}\\ (\\mathrm{mod}\\ 998244353)$.\n\n$\\sum_{n=0}^{\\infty}n^2\\ (\\frac{1}{4})^n=\\frac{20}{27}$.\n\n-----\n\n**Sample 3 Explanation:**\n\n$713031681\\equiv \\frac{2}{7}\\ (\\mathrm{mod}\\ 998244353)$.\n\n$\\sum_{n=0}^{\\infty}(2n^3+23n^2+5n+7)\\ (\\frac{2}{7})^n=\\frac{25417}{625}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "幂", "background": "来到数学院劳动\n", "description": "$$\\text{求}\\ \\sum_{n=0}^{\\infty}f(n)\\ r^n\\ ,\\ f(n)\\text{为一个多项式},\\ r\\text{是一个}(0,1)\\text{内的有理数}$$\n\n若答案的最简分数为$\\frac{p}{q}$，你只需要输出$p\\times q^{-1}\\  \\mathrm{mod} \\ 998244353\\ $的值即可。", "inputFormat": "第一行两个整数$m,r$。$m$为多项式的次数。\n\n第二行$m+1$个整数，第$i$个为$x^{i-1}$的系数$a_{i-1}$。", "outputFormat": "仅一行一个数字，为答案。", "hint": "对于$10\\%$的数据，$m\\le 5$。\n\n对于$40\\%$的数据，$m\\le 2000$。\n\n对于$100\\%$的数据，$m\\le 10^5\\ ,\\ a_i\\in [0,998244353)$，保证$\\ a_{m}\\neq 0$\n\n**捆绑测试**\n\n----\n\n**样例1解释：**\n\n$499122177\\equiv \\frac{1}{2}\\ (\\mathrm{mod}\\ 998244353)$\n\n$\\sum_{n=0}^{\\infty}n\\ (\\frac{1}{2})^n=2$\n\n-----\n\n**样例2解释：**\n\n$748683265\\equiv \\frac{1}{4}\\ (\\mathrm{mod}\\ 998244353)$\n\n$\\sum_{n=0}^{\\infty}n^2\\ (\\frac{1}{4})^n=\\frac{20}{27}$\n\n-----\n\n**样例3解释：**\n\n$713031681\\equiv \\frac{2}{7}\\ (\\mathrm{mod}\\ 998244353)$\n\n$\\sum_{n=0}^{\\infty}(2n^3+23n^2+5n+7)\\ (\\frac{2}{7})^n=\\frac{25417}{625}$\n\n", "locale": "zh-CN"}}}
{"pid": "P5350", "type": "P", "difficulty": 6, "samples": [["10 10\n7 1 3 2 2 4 0 1 2 2 \n4 10 10 3 3\n3 4 10 5\n6 6 7\n6 9 10\n1 10 10\n5 9 10 6 7\n2 8 10 0\n5 4 4 5 5\n5 2 4 8 10\n3 3 9 0", "7\n7 0 0 0 7 7 7 1 2 7"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["平衡树", "颜色段均摊（珂朵莉树 ODT）", "洛谷原创", "可持久化"], "title": "序列", "background": "搬运序列", "description": "有一个序列 $a_{1\\sim n}$ 和若干操作。\n\n- $\\mathrm{1\\  l \\  r \\ }$：求 $a_l$ 到 $a_r$ 的和。\n- $\\mathrm{2\\  l \\  r \\ val \\ }$：将 $a_l$ 到 $a_r$ 赋值为 $\\mathrm{val}$。\n- $\\mathrm{3\\  l \\  r \\ val\\ }$：将 $a_l$ 到 $a_r$ 加上 $\\mathrm{val}$。\n- $\\mathrm{4\\  l_1 \\  r_1 \\  l_2 \\  r_2 }$：将 $a_{l_1}$ 到 $a_{r_1}$ 复制到 $a_{l_2}$ 到 $a_{r_2}$ 处。\n- $\\mathrm{5\\  l_1 \\  r_1 \\  l_2 \\  r_2 }$：将 $a_{l_1}$ 到 $a_{r_1}$ 与 $a_{l_2}$ 到 $a_{r_2}$ 交换。 \n- $\\mathrm{6\\  l \\  r \\ }$：将 $a_l$ 到 $a_r$ 翻转。", "inputFormat": "第一行两个数 $n$ 和 $m$，为序列长度和操作个数。\n\n第二行 $n$ 个数，为 $a_{1\\sim n}$。\n\n下面 $m$ 行，每行为操作种类和相应的若干整数。", "outputFormat": "若干行，对于每个 $1$ 操作，输出答案。\n\n由于答案可能过大，对 $10^9+7$ 取模。\n\n最后一行输出序列 $a_{1\\sim n}$。当然也要取模。", "hint": "**请注意常数优化。**\n\n对于 $4$ 和 $5$ 操作，保证 $r_1-l_1=r_2-l_2$ 且区间不重叠。\n\n\n保证数据随机。\n\n对于 $30\\%$ 的数据，保证 $\\ n,m\\le 10^3\\ $。\n\n对于 $50\\%$ 的数据，保证 $\\ n,m\\le 5\\times 10^4\\ $。\n\n对于 $70\\%$ 的数据，保证 $\\ n,m\\le 1.5\\times 10^5\\ $。\n\n对于 $100\\%$ 的数据，保证 $\\ n,m\\le 3\\times 10^5\\ $，$\\ 0\\le a_i,\\mathrm{val}< 10^9+7 $。", "locale": "zh-CN", "translations": {"en": {"title": "Sequence", "background": "Moving sequences.", "description": "There is a sequence $a_{1\\sim n}$ and several operations.\n\n- $\\mathrm{1\\  l \\  r \\ }$: Find the sum from $a_l$ to $a_r$.\n- $\\mathrm{2\\  l \\  r \\ val \\ }$: Assign $\\mathrm{val}$ to $a_l$ through $a_r$.\n- $\\mathrm{3\\  l \\  r \\ val\\ }$: Add $\\mathrm{val}$ to $a_l$ through $a_r$.\n- $\\mathrm{4\\  l_1 \\  r_1 \\  l_2 \\  r_2 }$: Copy $a_{l_1}$ through $a_{r_1}$ to the range $a_{l_2}$ through $a_{r_2}$.\n- $\\mathrm{5\\  l_1 \\  r_1 \\  l_2 \\  r_2 }$: Swap $a_{l_1}$ through $a_{r_1}$ with $a_{l_2}$ through $a_{r_2}$.\n- $\\mathrm{6\\  l \\  r \\ }$: Reverse $a_l$ through $a_r$.", "inputFormat": "The first line contains two numbers $n$ and $m$, the length of the sequence and the number of operations.\n\nThe second line contains $n$ numbers, which are $a_{1\\sim n}$.\n\nThe next $m$ lines each describe an operation type and several corresponding integers.", "outputFormat": "Print several lines. For each operation of type $1$, output the answer.\n\nSince the answer may be too large, take it modulo $10^9+7$.\n\nOn the last line, output the sequence $a_{1\\sim n}$. It should also be taken modulo.", "hint": "**Please pay attention to constant-factor optimizations.**\n\nFor operations $4$ and $5$, it is guaranteed that $r_1-l_1=r_2-l_2$ and the intervals do not overlap.\n\nThe testdata is guaranteed to be random.\n\nFor $30\\%$ of the testdata, $\\ n,m\\le 10^3\\ $.\n\nFor $50\\%$ of the testdata, $\\ n,m\\le 5\\times 10^4\\ $.\n\nFor $70\\%$ of the testdata, $\\ n,m\\le 1.5\\times 10^5\\ $.\n\nFor $100\\%$ of the testdata, $\\ n,m\\le 3\\times 10^5\\ $，$\\ 0\\le a_i,\\mathrm{val}< 10^9+7 $。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "序列", "background": "搬运序列", "description": "有一个序列 $a_{1\\sim n}$ 和若干操作。\n\n- $\\mathrm{1\\  l \\  r \\ }$：求 $a_l$ 到 $a_r$ 的和。\n- $\\mathrm{2\\  l \\  r \\ val \\ }$：将 $a_l$ 到 $a_r$ 赋值为 $\\mathrm{val}$。\n- $\\mathrm{3\\  l \\  r \\ val\\ }$：将 $a_l$ 到 $a_r$ 加上 $\\mathrm{val}$。\n- $\\mathrm{4\\  l_1 \\  r_1 \\  l_2 \\  r_2 }$：将 $a_{l_1}$ 到 $a_{r_1}$ 复制到 $a_{l_2}$ 到 $a_{r_2}$ 处。\n- $\\mathrm{5\\  l_1 \\  r_1 \\  l_2 \\  r_2 }$：将 $a_{l_1}$ 到 $a_{r_1}$ 与 $a_{l_2}$ 到 $a_{r_2}$ 交换。 \n- $\\mathrm{6\\  l \\  r \\ }$：将 $a_l$ 到 $a_r$ 翻转。", "inputFormat": "第一行两个数 $n$ 和 $m$，为序列长度和操作个数。\n\n第二行 $n$ 个数，为 $a_{1\\sim n}$。\n\n下面 $m$ 行，每行为操作种类和相应的若干整数。", "outputFormat": "若干行，对于每个 $1$ 操作，输出答案。\n\n由于答案可能过大，对 $10^9+7$ 取模。\n\n最后一行输出序列 $a_{1\\sim n}$。当然也要取模。", "hint": "**请注意常数优化。**\n\n对于 $4$ 和 $5$ 操作，保证 $r_1-l_1=r_2-l_2$ 且区间不重叠。\n\n\n保证数据随机。\n\n对于 $30\\%$ 的数据，保证 $\\ n,m\\le 10^3\\ $。\n\n对于 $50\\%$ 的数据，保证 $\\ n,m\\le 5\\times 10^4\\ $。\n\n对于 $70\\%$ 的数据，保证 $\\ n,m\\le 1.5\\times 10^5\\ $。\n\n对于 $100\\%$ 的数据，保证 $\\ n,m\\le 3\\times 10^5\\ $，$\\ 0\\le a_i,\\mathrm{val}< 10^9+7 $。", "locale": "zh-CN"}}}
{"pid": "P5351", "type": "P", "difficulty": 6, "samples": [["5 2 3\n1 2 2\n2 3 2\n3 4 4\n4 5 5", "40"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["O2优化"], "title": "Ruri Loves Maschera", "background": "琉璃最近沉迷于《Maschera》的二次创作。", "description": "琉璃小说中的世界有 $n$ 座城市，其中有 $n-1$ 条道路，不包含重边、自环。这 $n-1$ 条道路中，第 $i$ 条道路的魔力值为 $w_i$。\n\n琉璃作为夜魔女王，她决定要观光整个黑暗世界 。她每次会随机选一个城市为起点，经过不少于 $L$ 条且不多于 $R$ 条道路后在一个城市为终点结束。**她在观光的时候是不走回头路的**。若琉璃每次观光中经过道路的魔力值依次为 $v_1,v_2,...,v_k(L\\leq k\\leq R)$，那么她会获得 $\\max(v_1,v_2,...,v_k)$ 的魔力值。\n\n现在琉璃想知道，她尝试了所有合法的观光路线后，她所获得的魔力值总和为多少。\n\n**注意，$x$ 到 $y$ 的路径和 $y$ 到 $x$ 的路径视为两条路径。**", "inputFormat": "第一行三个数 $n,L,R$\n\n接下来 $n-1$ 行，每行三个数 $x,y,w$，表示 $x$ 结点和 $y$ 结点之间有一条魔力值为 $w$ 的道路。", "outputFormat": "输出她所获得的魔力值总和。", "hint": "数据范围：\n\n对于 $10\\%$ 的数据，$n\\leq 5000$\n\n另有 $10\\%$ 的数据，$\\min(x,y)=1$\n\n另有 $15\\%$ 的数据，$|x-y|=1$\n\n另有 $25\\%$ 的数据，$L=1,R=n-1$\n\n对于 $100\\%$ 的数据，$n\\leq 10^5,1\\leq L\\leq R\\leq n-1,1\\leq w_i\\leq 10^5$", "locale": "zh-CN", "translations": {"en": {"title": "Ruri Loves Maschera", "background": "Ruri has recently become obsessed with fan creations of *Maschera*.", "description": "The world in Ruri’s novel has $n$ cities and $n-1$ roads, with no multiple edges or self-loops. Among these $n-1$ roads, the magic value of the $i$-th road is $w_i$.\n\nAs the Queen of the Night Demons, Ruri decides to tour the entire dark world. Each time, she randomly chooses a city as the starting point, and ends at some city after passing through at least $L$ roads and at most $R$ roads. **She never goes back along the same road during the tour.** If the magic values of the roads she passes through in one tour are $v_1, v_2, ..., v_k$ $(L \\leq k \\leq R)$ in order, then she gains a magic value of $\\max(v_1, v_2, ..., v_k)$.\n\nNow Ruri wants to know: after trying all valid tour routes, what is the total sum of the magic values she gains?\n\n**Note that the path from $x$ to $y$ and the path from $y$ to $x$ are considered two different paths.**", "inputFormat": "The first line contains three integers $n, L, R$.\n\nThe next $n-1$ lines each contain three integers $x, y, w$, indicating that there is a road between node $x$ and node $y$ with magic value $w$.", "outputFormat": "Output the total sum of the magic values she gains.", "hint": "Constraints:\n\nFor $10\\%$ of the testdata, $n \\leq 5000$.\n\nFor another $10\\%$ of the testdata, $\\min(x, y) = 1$.\n\nFor another $15\\%$ of the testdata, $|x - y| = 1$.\n\nFor another $25\\%$ of the testdata, $L = 1, R = n - 1$.\n\nFor $100\\%$ of the testdata, $n \\leq 10^5$, $1 \\leq L \\leq R \\leq n - 1$, and $1 \\leq w_i \\leq 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Ruri Loves Maschera", "background": "琉璃最近沉迷于《Maschera》的二次创作。", "description": "琉璃小说中的世界有 $n$ 座城市，其中有 $n-1$ 条道路，不包含重边、自环。这 $n-1$ 条道路中，第 $i$ 条道路的魔力值为 $w_i$。\n\n琉璃作为夜魔女王，她决定要观光整个黑暗世界 。她每次会随机选一个城市为起点，经过不少于 $L$ 条且不多于 $R$ 条道路后在一个城市为终点结束。**她在观光的时候是不走回头路的**。若琉璃每次观光中经过道路的魔力值依次为 $v_1,v_2,...,v_k(L\\leq k\\leq R)$，那么她会获得 $\\max(v_1,v_2,...,v_k)$ 的魔力值。\n\n现在琉璃想知道，她尝试了所有合法的观光路线后，她所获得的魔力值总和为多少。\n\n**注意，$x$ 到 $y$ 的路径和 $y$ 到 $x$ 的路径视为两条路径。**", "inputFormat": "第一行三个数 $n,L,R$\n\n接下来 $n-1$ 行，每行三个数 $x,y,w$，表示 $x$ 结点和 $y$ 结点之间有一条魔力值为 $w$ 的道路。", "outputFormat": "输出她所获得的魔力值总和。", "hint": "数据范围：\n\n对于 $10\\%$ 的数据，$n\\leq 5000$\n\n另有 $10\\%$ 的数据，$\\min(x,y)=1$\n\n另有 $15\\%$ 的数据，$|x-y|=1$\n\n另有 $25\\%$ 的数据，$L=1,R=n-1$\n\n对于 $100\\%$ 的数据，$n\\leq 10^5,1\\leq L\\leq R\\leq n-1,1\\leq w_i\\leq 10^5$", "locale": "zh-CN"}}}
{"pid": "P5352", "type": "P", "difficulty": 6, "samples": [["4 10\n1 2 3 4\nL 1 2\nL 2 3\nL 2 4\nA 1 4\nU 3 4 2\nO 1 4\nC 2 4\nL 3 4\nX 1 4\nS 1 3", "0\n7\n6\n2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": [], "title": "Terrible Homework", "background": "“像糟糕的作业一样糟糕。”", "description": "$ben$同学最讨厌做作业了。\n\n现在，老师布置给了$ben$同学$n$份作业，每份作业有一个难度值$A_i$。\n\n一开始，每份作业都是独立的。有一些操作，每次在两份作业$x,y$间加一条边或删除一条边。\n\n由于老师喜怒无常，因此还有一些操作，是将两份作业$x,y$之间路径上的所有作业的难度值都$xor$上一个值。\n\n同时，为了满足$ben$同学的好奇心，你需要回答两份作业$x,y$之间的所有作业的难度$and$和、难度$or$和、难度$xor$和以及难度和。", "inputFormat": "第一行两个正整数$n,q$，分别表示作业份数和操作个数。\n\n接下来一行，$n$个自然数$A_1,...,A_n$，表示每份作业的难度值。\n\n接下来$q$行，每行一个操作：\n\n- $L\\ x\\ y$：在$x,y$两份作业之间连一条边。（保证不会形成环，即任何时候这张图都是一个森林）\n- $C\\ x\\ y$：删除$x,y$两份作业之间的边。（保证这条边存在且不会被删除多次）\n- $U\\ x\\ y\\ v$：将$x,y$两份作业之间路径上的所有作业的难度值都$xor$上$v$。（包括这两份作业，且保证联通，下同）\n- $A\\ x\\ y$：询问$x,y$两份作业之间的所有作业的难度$and$和。\n- $O\\ x\\ y$：询问$x,y$两份作业之间的所有作业的难度$or$和。\n- $X\\ x\\ y$：询问$x,y$两份作业之间的所有作业的难度$xor$和。\n- $S\\ x\\ y$：询问$x,y$两份作业之间的所有作业的难度和。", "outputFormat": "对于每一个$A,O,X,S$操作，输出答案。", "hint": "对于$10\\%$的数据，$n=100,m=100$。\n\n另有$10\\%$的数据，$n=5000,m=5000$。\n\n另有$20\\%$的数据，$n=10000,m=10000$。\n\n对于$100\\%$的数据，$2\\le n,m\\le100000,0\\le A_i<2^{30}$。", "locale": "zh-CN", "translations": {"en": {"title": "Terrible Homework", "background": "“As terrible as terrible homework.”", "description": "Student $ben$ hates doing homework the most.\n\nNow, the teacher has assigned $n$ homework tasks to $ben$. Each task has a difficulty value $A_i$.\n\nAt the beginning, every homework task is independent. There are some operations: each time, you add an edge between two tasks $x, y$ or delete an edge.\n\nBecause the teacher’s mood changes often, there are also operations that apply $xor$ with a value to the difficulty values of all tasks on the path between two tasks $x, y$.\n\nAlso, to satisfy $ben$’s curiosity, you need to answer, for all tasks on the path between $x, y$, the bitwise $and$ sum, bitwise $or$ sum, bitwise $xor$ sum, and the ordinary sum of difficulty values.", "inputFormat": "The first line contains two positive integers $n, q$, representing the number of homework tasks and the number of operations.\n\nThe next line contains $n$ non-negative integers $A_1, ..., A_n$, representing the difficulty value of each task.\n\nThen follow $q$ lines, each describing one operation:\n\n- $L\\ x\\ y$: Add an edge between tasks $x$ and $y$. (It is guaranteed that no cycle will be formed, i.e. the graph is always a forest.)\n- $C\\ x\\ y$: Delete the edge between $x$ and $y$. (It is guaranteed that this edge exists and will not be deleted more than once.)\n- $U\\ x\\ y\\ v$: Apply $xor$ with $v$ to the difficulty values of all tasks on the path between $x$ and $y$. (Including $x$ and $y$, and it is guaranteed that they are connected; the same applies below.)\n- $A\\ x\\ y$: Query the bitwise $and$ sum of the difficulty values of all tasks on the path between $x$ and $y$.\n- $O\\ x\\ y$: Query the bitwise $or$ sum of the difficulty values of all tasks on the path between $x$ and $y$.\n- $X\\ x\\ y$: Query the bitwise $xor$ sum of the difficulty values of all tasks on the path between $x$ and $y$.\n- $S\\ x\\ y$: Query the ordinary sum of the difficulty values of all tasks on the path between $x$ and $y$.", "outputFormat": "For each $A, O, X, S$ operation, output the answer.", "hint": "For $10\\%$ of the testdata, $n = 100, q = 100$.\n\nFor another $10\\%$ of the testdata, $n = 5000, q = 5000$.\n\nFor another $20\\%$ of the testdata, $n = 10000, q = 10000$.\n\nFor $100\\%$ of the testdata, $2 \\le n, q \\le 100000$, $0 \\le A_i < 2^{30}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Terrible Homework", "background": "“像糟糕的作业一样糟糕。”", "description": "$ben$同学最讨厌做作业了。\n\n现在，老师布置给了$ben$同学$n$份作业，每份作业有一个难度值$A_i$。\n\n一开始，每份作业都是独立的。有一些操作，每次在两份作业$x,y$间加一条边或删除一条边。\n\n由于老师喜怒无常，因此还有一些操作，是将两份作业$x,y$之间路径上的所有作业的难度值都$xor$上一个值。\n\n同时，为了满足$ben$同学的好奇心，你需要回答两份作业$x,y$之间的所有作业的难度$and$和、难度$or$和、难度$xor$和以及难度和。", "inputFormat": "第一行两个正整数$n,q$，分别表示作业份数和操作个数。\n\n接下来一行，$n$个自然数$A_1,...,A_n$，表示每份作业的难度值。\n\n接下来$q$行，每行一个操作：\n\n- $L\\ x\\ y$：在$x,y$两份作业之间连一条边。（保证不会形成环，即任何时候这张图都是一个森林）\n- $C\\ x\\ y$：删除$x,y$两份作业之间的边。（保证这条边存在且不会被删除多次）\n- $U\\ x\\ y\\ v$：将$x,y$两份作业之间路径上的所有作业的难度值都$xor$上$v$。（包括这两份作业，且保证联通，下同）\n- $A\\ x\\ y$：询问$x,y$两份作业之间的所有作业的难度$and$和。\n- $O\\ x\\ y$：询问$x,y$两份作业之间的所有作业的难度$or$和。\n- $X\\ x\\ y$：询问$x,y$两份作业之间的所有作业的难度$xor$和。\n- $S\\ x\\ y$：询问$x,y$两份作业之间的所有作业的难度和。", "outputFormat": "对于每一个$A,O,X,S$操作，输出答案。", "hint": "对于$10\\%$的数据，$n=100,m=100$。\n\n另有$10\\%$的数据，$n=5000,m=5000$。\n\n另有$20\\%$的数据，$n=10000,m=10000$。\n\n对于$100\\%$的数据，$2\\le n,m\\le100000,0\\le A_i<2^{30}$。", "locale": "zh-CN"}}}
{"pid": "P5353", "type": "P", "difficulty": 6, "samples": [["5\n1 1 3 2\nabbaa", "1 5 4 2 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["字符串", "倍增", "O2优化", "后缀数组 SA"], "title": "树上后缀排序", "background": "", "description": "给定一棵以 $1$ 为根包含 $n$ 个节点的树，保证对于 $2 \\sim n$ 的每个节点，其父亲的编号均小于自己的编号。\n\n每个节点上有一个的字符，一个节点所代表的字符串定义为从当前节点一直到根节点的简单路径上经过的所有字符连起来形成的字符串。\n\n请你给这些字符串按照字典序排序。\n\n特别地，如果两个节点所代表的字符串完全相同，它们的大小由它们父亲排名的大小决定，即谁的父亲排名大谁就更大；如果仍相同，则由它们编号的大小决定，即谁的编号大谁就更大。", "inputFormat": "第一行包含一个正整数 $n$。\n\n第二行包含 $n-1$ 个数 $f_{2 \\dots n}$，其中 $f_i$ 表示 $i$ 的父亲。\n\n第三行为一个包含 $n$ 个**小写字母**的字符串 $s$，其中 $s_i$ 表示编号为 $i$ 的节点上的字符。", "outputFormat": "输出一行 $n$ 个正整数，第 $i$ 个正整数表示代表**排名第 $i$ 的字符串**的节点编号。", "hint": "对于 $20\\%$ 的数据，$n \\le 10 ^ 3$。\n\n对于 $50\\%$ 的数据，$n \\le 10 ^ 5$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 5 \\times 10 ^ 5$。", "locale": "zh-CN", "translations": {"en": {"title": "Suffix Sorting on a Tree", "background": "", "description": "Given a tree rooted at $1$ with $n$ nodes, it is guaranteed that for every node from $2$ to $n$, the index of its parent is smaller than its own index.\n\nEach node has a character. The string represented by a node is defined as the string formed by concatenating all characters on the simple path from the current node up to the root.\n\nPlease sort these strings in lexicographical order.\n\nIn particular, if the strings represented by two nodes are exactly the same, their order is determined by the order of their parents: the one whose parent has a larger rank is considered larger. If they are still the same, then their order is determined by their node indices: the one with the larger index is considered larger.", "inputFormat": "The first line contains a positive integer $n$.\n\nThe second line contains $n - 1$ integers $f_{2 \\dots n}$, where $f_i$ denotes the parent of node $i$.\n\nThe third line contains a string $s$ of length $n$ consisting of **lowercase letters**, where $s_i$ is the character on node $i$.", "outputFormat": "Output one line with $n$ positive integers. The $i$-th integer denotes the node index that represents the **string ranked $i$-th**.", "hint": "For $20\\%$ of the testdata, $n \\le 10 ^ 3$.\n\nFor $50\\%$ of the testdata, $n \\le 10 ^ 5$.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 5 \\times 10 ^ 5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "树上后缀排序", "background": "", "description": "给定一棵以 $1$ 为根包含 $n$ 个节点的树，保证对于 $2 \\sim n$ 的每个节点，其父亲的编号均小于自己的编号。\n\n每个节点上有一个的字符，一个节点所代表的字符串定义为从当前节点一直到根节点的简单路径上经过的所有字符连起来形成的字符串。\n\n请你给这些字符串按照字典序排序。\n\n特别地，如果两个节点所代表的字符串完全相同，它们的大小由它们父亲排名的大小决定，即谁的父亲排名大谁就更大；如果仍相同，则由它们编号的大小决定，即谁的编号大谁就更大。", "inputFormat": "第一行包含一个正整数 $n$。\n\n第二行包含 $n-1$ 个数 $f_{2 \\dots n}$，其中 $f_i$ 表示 $i$ 的父亲。\n\n第三行为一个包含 $n$ 个**小写字母**的字符串 $s$，其中 $s_i$ 表示编号为 $i$ 的节点上的字符。", "outputFormat": "输出一行 $n$ 个正整数，第 $i$ 个正整数表示代表**排名第 $i$ 的字符串**的节点编号。", "hint": "对于 $20\\%$ 的数据，$n \\le 10 ^ 3$。\n\n对于 $50\\%$ 的数据，$n \\le 10 ^ 5$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 5 \\times 10 ^ 5$。", "locale": "zh-CN"}}}
{"pid": "P5354", "type": "P", "difficulty": 6, "samples": [["5 5 3\n1 7\n2 6\n3 7\n3 6\n3 1\n1 2\n2 3\n3 4\n1 5\n1 1 4 7\n1 1 3 5\n2 1 1 3\n2 3 3 3\n1 1 3 2", "7\n1\n5"], ["2 2 2\n2 2\n2 2\n1 2\n2 2 2 2\n1 2 2 2", "3"]], "limits": {"time": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2017", "线段树", "O2优化", "树链剖分", "动态树 LCT", "洛谷月赛", "Ynoi"], "title": "[Ynoi Easy Round 2017] 由乃的 OJ", "background": "![](https://cdn.luogu.com.cn/upload/pic/58221.png)", "description": "由乃正在做她的OJ。现在她在处理OJ上的用户排名问题。\n\nOJ 上注册了 $n$ 个用户，编号为 $1\\sim n$，一开始他们按照编号排名。由乃会按照心情对这些用户做以下四种操作，修改用户的排名和编号：然而由乃心情非常不好，因为 Deus 天天问她题。。。\n \n因为 Deus 天天问由乃 OI 题，所以由乃去学习了一下 OI，由于由乃智商挺高，所以 OI 学的特别熟练。\n\n她在 RBOI2016 中以第一名的成绩进入省队，参加了 NOI2016 获得了金牌保送。\n\nDeus：这个题怎么做呀？  \nyuno：这个不是 NOI2014 的水题吗。。。  \nDeus：那如果出到树上，多组链询问，带修改呢？  \nyuno：诶。。。？？？  \nDeus：这题叫做睡觉困难综合征哟~  \n\n虽然由乃 OI 很好，但是她基本上不会 DS，线段树都只会口胡，比如她 NOI2016 的分数就是 $100+100+100+0+100+100$。。。NOIP2017 的分数是 $100+0+100+100+0+100$。\n\n所以她还是只能找你帮她做了。。。\n\n给你一个有 $n$ 个点的树，每个点的包括一个位运算 $opt$ 和一个权值 $x$，位运算有`&`，`|`，`^` 三种，分别用 $1,2,3$ 表示。\n\n每次询问包含三个整数 $x,y,z$，初始选定一个数 $v$。然后 $v$ 依次经过从 $x$ 到 $y$ 的所有节点，每经过一个点 $i$，$v$ 就变成 $v\\ opt_i\\ x_i$，所以他想问你，最后到 $y$ 时，希望得到的值尽可能大，求最大值。给定的初始值 $v$ 必须是在 $[0,z]$ 之间。\n\n每次修改包含三个整数 $x,y,z$，意思是把 $x$ 点的操作修改为 $y$，数值改为 $z$。", "inputFormat": "第一行三个整数 $n,m,k$。$k$ 的意义是每个点上的数，以及询问中的数值 $z$ 都小于 $2^k$。\n\n之后 $n$ 行，每行两个整数 $x,y$ 表示该点的位运算编号以及数值。\n\n之后 $n - 1$ 行，每行两个数 $x,y$ 表示 $x$ 和 $y$ 之间有边相连。\n\n之后 $m$ 行，每行四个数，$Q,x,y,z$ 表示这次操作为 $Q$（$1$ 为询问，$2$ 为修改），$x,y,z$ 意义如题所述。", "outputFormat": "对于每个操作 $1$，输出到最后可以得到的最大值。", "hint": "Idea：f321dd，Solution：f321dd&nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n对于 $30\\%$ 的数据，$n,m\\leq 1$。\n\n对于另外 $20\\%$ 的数据，$k\\leq 5$。\n\n对于另外 $20\\%$ 的数据，位运算只会出现一种。\n\n对于 $100\\%$ 的数据，$0\\leq n,m \\leq 10^5$，$0\\leq k\\leq 64$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi Easy Round 2017] Yuno’s OJ", "background": "![](https://cdn.luogu.com.cn/upload/pic/58221.png)", "description": "Yuno is building her OJ. Now she is dealing with the user ranking problem.\n\nThere are $n$ users registered on the OJ, numbered $1\\sim n$. Initially, they are ranked by their indices. Yuno, depending on her mood, would like to perform the following four types of operations to modify users’ rankings and indices. However, Yuno is in a very bad mood because Deus keeps asking her problems...\n\nBecause Deus keeps asking Yuno OI problems, Yuno went to study OI. Since Yuno is quite smart, she learned OI very well.\n\nShe entered the provincial team with the first place at RBOI2016 and then won a gold medal and a direct recommendation at NOI2016.\n\nDeus: How do you solve this problem?  \nYuno: Isn’t this just an easy problem from NOI2014...  \nDeus: What if we put it on a tree, with multiple path queries, with modifications?  \nYuno: Eh...???  \nDeus: This problem is called “睡觉困难综合征”~\n\nAlthough Yuno is good at OI, she basically isn’t good at DS; she can only hand-wave segment trees. For example, her NOI2016 scores were $100+100+100+0+100+100$... and her NOIP2017 scores were $100+0+100+100+0+100$.\n\nSo she still has to ask you to help her...\n\nYou are given a tree with $n$ nodes. Each node has a bitwise operation $opt$ and a value $x$. The bitwise operations are `&`, `|`, `^`, represented by $1,2,3$ respectively.\n\nEach query consists of three integers $x,y,z$. You choose an initial number $v$. Then $v$ passes through all nodes on the path from $x$ to $y$ in order. Every time it passes a node $i$, $v$ becomes $v\\ opt_i\\ x_i$. She wants to know the maximum possible final value when reaching $y$. The initial value $v$ must be in $[0,z]$.\n\nEach modification consists of three integers $x,y,z$, meaning that the operation at node $x$ is changed to $y$ and its value is changed to $z$.", "inputFormat": "The first line contains three integers $n,m,k$. The meaning of $k$ is that each number on a node and each $z$ in the queries are less than $2^k$.\n\nThen $n$ lines follow. Each line contains two integers $x,y$, representing the operation ID and the value of that node.\n\nThen $n-1$ lines follow. Each line contains two integers $x,y$, indicating that there is an edge between $x$ and $y$.\n\nThen $m$ lines follow. Each line contains four integers $Q,x,y,z$. Here $Q$ indicates the type of operation ($1$ for query, $2$ for modification), and $x,y,z$ have the meanings described above.", "outputFormat": "For each operation of type $1$, output the maximum value that can be obtained at the end.", "hint": "Idea: f321dd, Solution: f321dd & nzhtl1477, Code: nzhtl1477, Data: nzhtl1477.\n\nFor $30\\%$ of the testdata, $n,m\\leq 1$.\n\nFor another $20\\%$ of the testdata, $k\\leq 5$.\n\nFor another $20\\%$ of the testdata, only one kind of bitwise operation appears.\n\nFor $100\\%$ of the testdata, $0\\leq n,m \\leq 10^5$, $0\\leq k\\leq 64$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi Easy Round 2017] 由乃的 OJ", "background": "![](https://cdn.luogu.com.cn/upload/pic/58221.png)", "description": "由乃正在做她的OJ。现在她在处理OJ上的用户排名问题。\n\nOJ 上注册了 $n$ 个用户，编号为 $1\\sim n$，一开始他们按照编号排名。由乃会按照心情对这些用户做以下四种操作，修改用户的排名和编号：然而由乃心情非常不好，因为 Deus 天天问她题。。。\n \n因为 Deus 天天问由乃 OI 题，所以由乃去学习了一下 OI，由于由乃智商挺高，所以 OI 学的特别熟练。\n\n她在 RBOI2016 中以第一名的成绩进入省队，参加了 NOI2016 获得了金牌保送。\n\nDeus：这个题怎么做呀？  \nyuno：这个不是 NOI2014 的水题吗。。。  \nDeus：那如果出到树上，多组链询问，带修改呢？  \nyuno：诶。。。？？？  \nDeus：这题叫做睡觉困难综合征哟~  \n\n虽然由乃 OI 很好，但是她基本上不会 DS，线段树都只会口胡，比如她 NOI2016 的分数就是 $100+100+100+0+100+100$。。。NOIP2017 的分数是 $100+0+100+100+0+100$。\n\n所以她还是只能找你帮她做了。。。\n\n给你一个有 $n$ 个点的树，每个点的包括一个位运算 $opt$ 和一个权值 $x$，位运算有`&`，`|`，`^` 三种，分别用 $1,2,3$ 表示。\n\n每次询问包含三个整数 $x,y,z$，初始选定一个数 $v$。然后 $v$ 依次经过从 $x$ 到 $y$ 的所有节点，每经过一个点 $i$，$v$ 就变成 $v\\ opt_i\\ x_i$，所以他想问你，最后到 $y$ 时，希望得到的值尽可能大，求最大值。给定的初始值 $v$ 必须是在 $[0,z]$ 之间。\n\n每次修改包含三个整数 $x,y,z$，意思是把 $x$ 点的操作修改为 $y$，数值改为 $z$。", "inputFormat": "第一行三个整数 $n,m,k$。$k$ 的意义是每个点上的数，以及询问中的数值 $z$ 都小于 $2^k$。\n\n之后 $n$ 行，每行两个整数 $x,y$ 表示该点的位运算编号以及数值。\n\n之后 $n - 1$ 行，每行两个数 $x,y$ 表示 $x$ 和 $y$ 之间有边相连。\n\n之后 $m$ 行，每行四个数，$Q,x,y,z$ 表示这次操作为 $Q$（$1$ 为询问，$2$ 为修改），$x,y,z$ 意义如题所述。", "outputFormat": "对于每个操作 $1$，输出到最后可以得到的最大值。", "hint": "Idea：f321dd，Solution：f321dd&nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n对于 $30\\%$ 的数据，$n,m\\leq 1$。\n\n对于另外 $20\\%$ 的数据，$k\\leq 5$。\n\n对于另外 $20\\%$ 的数据，位运算只会出现一种。\n\n对于 $100\\%$ 的数据，$0\\leq n,m \\leq 10^5$，$0\\leq k\\leq 64$。\n", "locale": "zh-CN"}}}
{"pid": "P5355", "type": "P", "difficulty": 6, "samples": [["5 5\n1 1 2 3 4\n4 1 1 1\n1 1 2 2\n3 1 1 1\n3 5 5 16\n1 2 3 4", "yuno\nyumi\nyuno\nyuno\nyumi"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2017", "O2优化", "Ynoi"], "title": "[Ynoi Easy Round 2017] 由乃的玉米田", "background": "![](https://cdn.luogu.com.cn/upload/pic/58222.png)", "description": "由乃在自己的农田边散步，她突然发现田里的一排玉米非常的不美。\n\n这排玉米一共有 $N$ 株，它们的高度参差不齐。\n\n由乃认为玉米田不美，所以她决定出个数据结构题\n \n这个题是这样的：\n\n给你一个序列 $a$，长度为 $n$，有 $m$ 次操作，每次询问一个区间是否可以选出两个数它们的差为 $x$，或者询问一个区间是否可以选出两个数它们的和为 $x$，或者询问一个区间是否可以选出两个数它们的乘积为 $x$ ，或者询问一个区间是否可以选出两个数它们的商为 $x$（没有余数） ，这四个操作分别为操作 $1,2,3,4$。\n\n选出的这两个数可以是同一个位置的数。", "inputFormat": "第一行两个数 $n,m$。\n\n后面一行 $n$ 个数表示 $a_i$。\n\n后面 $m$ 行每行四个数 $opt,l,r,x$。\n\n$opt$ 表示这个是第几种操作，$l,r$ 表示操作的区间，$x$ 表示这次操作的 $x$。", "outputFormat": "对于每个询问，如果可以，输出 `yuno`，否则输出 `yumi`。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477&mrsrz\n\n对于 $100\\%$ 的数据，所有输入的数在 $[0,10^5]$ 内，序列中的元素在 $[1,10^5]$ 内。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi Easy Round 2017] Yuno's Cornfield", "background": "![](https://cdn.luogu.com.cn/upload/pic/58222.png)", "description": "Yuno is taking a walk by her farmland. She suddenly finds that a row of corn in the field looks very ugly.\n\nThere are a total of $N$ corn plants in this row, and their heights are uneven.\n\nYuno thinks the cornfield is not beautiful, so she decides to make a data structure problem.\n\nThe problem is as follows:\n\nYou are given a sequence $a$ of length $n$, with $m$ operations. Each operation queries whether, in a given interval, you can pick two numbers whose difference is $x$, or queries whether, in a given interval, you can pick two numbers whose sum is $x$, or queries whether, in a given interval, you can pick two numbers whose product is $x$, or queries whether, in a given interval, you can pick two numbers whose quotient is $x$ (with no remainder). These four operations are numbered $1,2,3,4$, respectively.\n\nThe two chosen numbers may come from the same position.", "inputFormat": "The first line contains two integers $n,m$.\n\nThe next line contains $n$ integers representing $a_i$.\n\nThe next $m$ lines each contain four integers $opt,l,r,x$.\n\n$opt$ indicates which type of operation it is, $l,r$ specify the interval of the operation, and $x$ is the value $x$ for this operation.", "outputFormat": "For each query, if it is possible, output `yuno`; otherwise output `yumi`.", "hint": "Idea: nzhtl1477, Solution: nzhtl1477, Code: nzhtl1477, Data: nzhtl1477&mrsrz.\n\nFor $100\\%$ of the testdata, all input numbers are within $[0,10^5]$, and the elements in the sequence are within $[1,10^5]$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi Easy Round 2017] 由乃的玉米田", "background": "![](https://cdn.luogu.com.cn/upload/pic/58222.png)", "description": "由乃在自己的农田边散步，她突然发现田里的一排玉米非常的不美。\n\n这排玉米一共有 $N$ 株，它们的高度参差不齐。\n\n由乃认为玉米田不美，所以她决定出个数据结构题\n \n这个题是这样的：\n\n给你一个序列 $a$，长度为 $n$，有 $m$ 次操作，每次询问一个区间是否可以选出两个数它们的差为 $x$，或者询问一个区间是否可以选出两个数它们的和为 $x$，或者询问一个区间是否可以选出两个数它们的乘积为 $x$ ，或者询问一个区间是否可以选出两个数它们的商为 $x$（没有余数） ，这四个操作分别为操作 $1,2,3,4$。\n\n选出的这两个数可以是同一个位置的数。", "inputFormat": "第一行两个数 $n,m$。\n\n后面一行 $n$ 个数表示 $a_i$。\n\n后面 $m$ 行每行四个数 $opt,l,r,x$。\n\n$opt$ 表示这个是第几种操作，$l,r$ 表示操作的区间，$x$ 表示这次操作的 $x$。", "outputFormat": "对于每个询问，如果可以，输出 `yuno`，否则输出 `yumi`。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477&mrsrz\n\n对于 $100\\%$ 的数据，所有输入的数在 $[0,10^5]$ 内，序列中的元素在 $[1,10^5]$ 内。", "locale": "zh-CN"}}}
{"pid": "P5356", "type": "P", "difficulty": 6, "samples": [["1 1\n1\n1 1 1 1", "1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2017", "二分", "O2优化", "排序", "分块", "Ynoi"], "title": "[Ynoi Easy Round 2017] 由乃打扑克", "background": "![](https://cdn.luogu.com.cn/upload/pic/58223.png)", "description": "由乃不太会打扑克，\n\n所以她出了一个数据结构题。 \n\n给你一个长为 $n$ 的序列 $a$，需要支持 $m$ 次操作，操作有两种：\n\n1. 查询区间 $[l,r]$ 的第 $k$ 小值。\n2. 区间 $[l,r]$ 加上 $k$。", "inputFormat": "一行两个整数 $n,m$。\n\n接下来一行 $n$ 个整数，第 $i$ 个整数表示 $a_i$。\n\n接下来 $m$ 行，每行四个整数 $opt,l,r,k$，其中 $opt$ 代表是哪种操作。", "outputFormat": "对于每个询问输出一个数表示答案，如果无解输出 $-1$。", "hint": "Idea：nzhtl1477，\n\nSolution：nzhtl1477（$O(m\\sqrt{n}(\\Delta+\\log n))$）solution，ccz181078（$O(m\\sqrt{n\\log n})$）solution，\n\nCode：nzhtl1477（$O(m\\sqrt{n}(\\Delta+\\log n))$）code，ccz181078（$O(m\\sqrt{n\\log n})$）code，\n\nData：nzhtl1477。\n\n$1\\leq l\\leq r \\leq n\\leq 10^5$，$1 \\leq m \\leq 10^5$，$-2\\times 10^4\\leq a_i, k\\leq 2\\times 10^4$，$opt \\in \\{1, 2\\}$。\n\n---\n\n$\\text{upd 2022.8.18}$：新增加一组 Hack 数据。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi Easy Round 2017] Yuno Plays Poker", "background": "![](https://cdn.luogu.com.cn/upload/pic/58223.png)", "description": "Yuno is not very good at playing poker.\n\nSo she came up with a data structure problem.\n\nYou are given a sequence $a$ of length $n$. You need to support $m$ operations of two types:\n\n1. Query the $k$-th smallest value in the interval $[l, r]$.\n2. Add $k$ to every element in the interval $[l, r]$.", "inputFormat": "One line with two integers $n, m$.\n\nThe next line contains $n$ integers; the $i$-th integer represents $a_i$.\n\nThe next $m$ lines each contain four integers $opt, l, r, k$, where $opt$ indicates which type of operation it is.", "outputFormat": "For each query, output one number as the answer. If there is no solution, output $-1$.", "hint": "Idea: nzhtl1477.\n\nSolution: nzhtl1477 ($O(m\\sqrt{n}(\\Delta+\\log n))$) solution, ccz181078 ($O(m\\sqrt{n\\log n})$) solution.\n\nCode: nzhtl1477 ($O(m\\sqrt{n}(\\Delta+\\log n))$) code, ccz181078 ($O(m\\sqrt{n\\log n})$) code.\n\nData: nzhtl1477.\n\nConstraints: $1\\leq l\\leq r \\leq n\\leq 10^5$, $1 \\leq m \\leq 10^5$, $-2\\times 10^4\\leq a_i, k\\leq 2\\times 10^4$, $opt \\in \\{1, 2\\}$.\n\n---\n\n$\\text{upd 2022.8.18}$: A new set of hack testdata has been added.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi Easy Round 2017] 由乃打扑克", "background": "![](https://cdn.luogu.com.cn/upload/pic/58223.png)", "description": "由乃不太会打扑克，\n\n所以她出了一个数据结构题。 \n\n给你一个长为 $n$ 的序列 $a$，需要支持 $m$ 次操作，操作有两种：\n\n1. 查询区间 $[l,r]$ 的第 $k$ 小值。\n2. 区间 $[l,r]$ 加上 $k$。", "inputFormat": "一行两个整数 $n,m$。\n\n接下来一行 $n$ 个整数，第 $i$ 个整数表示 $a_i$。\n\n接下来 $m$ 行，每行四个整数 $opt,l,r,k$，其中 $opt$ 代表是哪种操作。", "outputFormat": "对于每个询问输出一个数表示答案，如果无解输出 $-1$。", "hint": "Idea：nzhtl1477，\n\nSolution：nzhtl1477（$O(m\\sqrt{n}(\\Delta+\\log n))$）solution，ccz181078（$O(m\\sqrt{n\\log n})$）solution，\n\nCode：nzhtl1477（$O(m\\sqrt{n}(\\Delta+\\log n))$）code，ccz181078（$O(m\\sqrt{n\\log n})$）code，\n\nData：nzhtl1477。\n\n$1\\leq l\\leq r \\leq n\\leq 10^5$，$1 \\leq m \\leq 10^5$，$-2\\times 10^4\\leq a_i, k\\leq 2\\times 10^4$，$opt \\in \\{1, 2\\}$。\n\n---\n\n$\\text{upd 2022.8.18}$：新增加一组 Hack 数据。", "locale": "zh-CN"}}}
{"pid": "P5357", "type": "P", "difficulty": 5, "samples": [["5\na\nbb\naa\nabaa\nabaaa\nabaaabaa\n", "6\n0\n3\n2\n1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["字符串", "AC 自动机", "模板题"], "title": "【模板】AC 自动机", "background": "本题原为“AC 自动机（二次加强版）”。完成本题前可以先完成 [AC 自动机（简单版）](https://www.luogu.com.cn/problem/P3808) 和 [AC 自动机（简单版 II）](https://www.luogu.com.cn/problem/P3796) 两道题，为 AC 自动机更简单的应用。", "description": "给你一个文本串 $S$ 和 $n$ 个模式串 $T_{1 \\sim n}$，请你分别求出每个模式串 $T_i$ 在 $S$ 中出现的次数。", "inputFormat": "第一行包含一个正整数 $n$ 表示模式串的个数。\n\n接下来 $n$ 行，第 $i$ 行包含一个由小写英文字母构成的非空字符串 $T_i$。\n\n最后一行包含一个由小写英文字母构成的非空字符串 $S$。\n\n**数据不保证任意两个模式串不相同**。", "outputFormat": "输出包含 $n$ 行，其中第 $i$ 行包含一个非负整数表示 $T_i$ 在 $S$ 中出现的次数。", "hint": "对于 $100 \\%$ 的数据，$1 \\le n \\le 2 \\times {10}^5$，$T_{1 \\sim n}$ 的长度总和不超过 $2 \\times {10}^5$，$S$ 的长度不超过 $2 \\times {10}^6$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Aho–Corasick Automaton.", "background": "This problem was originally called “Aho–Corasick Automaton (Second Enhanced Version)”. Before solving this problem, you may first solve [Aho–Corasick Automaton (Easy Version)](https://www.luogu.com.cn/problem/P3808) and [Aho–Corasick Automaton (Easy Version II)](https://www.luogu.com.cn/problem/P3796), which cover simpler applications of the Aho–Corasick automaton.", "description": "You are given a text string $S$ and $n$ pattern strings $T_{1 \\sim n}$. Please find, for each pattern string $T_i$, the number of times it appears in $S$.", "inputFormat": "The first line contains a positive integer $n$, representing the number of pattern strings.\n\nThe next $n$ lines each contain a non-empty string $T_i$ consisting of lowercase English letters, where the $i$-th line corresponds to $T_i$.\n\nThe last line contains a non-empty string $S$ consisting of lowercase English letters.\n\n**The testdata does not guarantee that any two pattern strings are different**.", "outputFormat": "Output $n$ lines. The $i$-th line contains a non-negative integer, representing the number of times $T_i$ appears in $S$.", "hint": "For $100\\%$ of the data, $1 \\le n \\le 2 \\times {10}^5$, the total length of $T_{1 \\sim n}$ is at most $2 \\times {10}^5$, and the length of $S$ is at most $2 \\times {10}^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】AC 自动机", "background": "本题原为“AC 自动机（二次加强版）”。完成本题前可以先完成 [AC 自动机（简单版）](https://www.luogu.com.cn/problem/P3808) 和 [AC 自动机（简单版 II）](https://www.luogu.com.cn/problem/P3796) 两道题，为 AC 自动机更简单的应用。", "description": "给你一个文本串 $S$ 和 $n$ 个模式串 $T_{1 \\sim n}$，请你分别求出每个模式串 $T_i$ 在 $S$ 中出现的次数。", "inputFormat": "第一行包含一个正整数 $n$ 表示模式串的个数。\n\n接下来 $n$ 行，第 $i$ 行包含一个由小写英文字母构成的非空字符串 $T_i$。\n\n最后一行包含一个由小写英文字母构成的非空字符串 $S$。\n\n**数据不保证任意两个模式串不相同**。", "outputFormat": "输出包含 $n$ 行，其中第 $i$ 行包含一个非负整数表示 $T_i$ 在 $S$ 中出现的次数。", "hint": "对于 $100 \\%$ 的数据，$1 \\le n \\le 2 \\times {10}^5$，$T_{1 \\sim n}$ 的长度总和不超过 $2 \\times {10}^5$，$S$ 的长度不超过 $2 \\times {10}^6$。", "locale": "zh-CN"}}}
{"pid": "P5358", "type": "P", "difficulty": 5, "samples": [["7\n28\n6\n4 -192321079\n3 418379342\n1 3 189801569\n3 -840249197\n4 -751917965\n3 649799919\n1 5 -92666141\n6\n4 451258008\n5 1\n4 696880327\n3 772574465\n6\n4 301010289\n3 480168068\n5 3\n5 2\n4 840536237\n5 5\n5 4\n1 7 -792284106\n2 604521872\n3 966540578\n2 -381646699\n3 -939378260\n2 -20129935\n6\n2\n0 1\n197 199", "2816930"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2019", "各省省选", "山东", "O2优化"], "title": "[SDOI2019] 快速查询", "background": "", "description": "给定一个长度为 $n$ 的整数数列，里面的元素依次编号为 $a_1,~a_2,~a_3,~\\dots,~a_n$。初始的时候，所有元素都为零。现在按照时间顺序提供了若干次关于这个数列的修改或询问，每一次修改或询问一定为以下六种情况之一：\n\n- **1 i val** ：将 $a_i$ 赋值为给定整数 $val$；\n\n- **2 val** ：将所有元素同时加上 $val$；\n\n- **3 val** ：将所有元素同时乘上 $val$；\n\n- **4 val** ：将所有元素同时赋值为 $val$；\n\n- **5 i** ：询问第 $i$ 个元素 $a_i$ 现在的值是多少；\n\n- **6** ：询问现在所有元素的和。", "inputFormat": "为了避免读入太大，输入文件采取如下的形式。\n\n第一行给定整数 $n$，表示给定数列长度为 $n$。\n 第二行给定整数 $q$，并且之后的 $q$ 行，每一行提供一个修改或询问，输入的格式与题目所述一致，请参见样例。\n 我们称上述给定的修改或询问为标准操作。\n 之后给定一个整数 $t$，并且之后的 $t$ 行每行给定两个正整数 $a_i$ 和 $b_i$，这里的下标 $i$ 依次记为 $1$ 到 $t$ 。\n\n你需要对初始值全为零的长度为 $n$ 的序列做总计 $t\\times q$ 次操作。\n 其中第 $\\Big((i-1)q+j\\Big)$ 次操作形如第 $\\Big((a_i + j b_i) \\mod{q} + 1\\Big)$ 个给定的标准操作（$1\\le i\\le t$ 且 $1\\le j\\le q$）。", "outputFormat": "输出一个整数，表示所有询问答案的累计和。\n\n因为答案可能很大，只要求输出其结果关于 $p=10^7+19$ 取模后的值。\n\n注意：若最终的累计和 ans 小于零，你应该输出 $\\big((ans \\mod{p})+p\\big)\\mod{p}$。", "hint": "子任务$1$：（$50$分）$1\\le  n\\le 500000$，$1\\le q\\le 10^5$ 且 $1\\le t\\le 5$，所有在输入中出现的$val$  满足$-10^9\\le val\\le 10^9$，所有$a_i$和$b_i$满足$0\\le a_i,b_i\\le 10^9$\n\n子任务$2$：（$50$分）$1\\le n\\le 10^9$，$1\\le q\\le 10^5$ 且 $1\\le~t~\\le~100$，所有在输入中出现的$val$ 满足$-10^9\\le val\\le  10^9$，所有$a_i$和$b_i$满足$0\\le a_i,b_i\\le 10^9$\n\n", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2019] Fast Queries", "background": "", "description": "Given an integer sequence of length $n$, whose elements are numbered in order as $a_1,~a_2,~a_3,~\\dots,~a_n$. Initially, all elements are zero. Then, in chronological order, a number of modifications or queries on this sequence are given. Each modification or query must be one of the following six types:\n\n- **1 i val**: Assign $a_i$ the given integer $val$.\n\n- **2 val**: Add $val$ to all elements at the same time.\n\n- **3 val**: Multiply all elements by $val$ at the same time.\n\n- **4 val**: Assign all elements to $val$ at the same time.\n\n- **5 i**: Query the current value of the $i$-th element $a_i$.\n\n- **6**: Query the current sum of all elements.", "inputFormat": "To avoid overly large input, the input file uses the following format.\n\nThe first line contains an integer $n$, denoting the length of the sequence.\n\nThe second line contains an integer $q$, and then the next $q$ lines each give one modification or query. The input format is the same as described above; see the sample.\n\nWe call the above modifications or queries the standard operations.\n\nAfter that, an integer $t$ is given, and then the next $t$ lines each contain two positive integers $a_i$ and $b_i$, where the index $i$ runs from $1$ to $t$.\n\nYou need to perform a total of $t\\times q$ operations on the sequence of length $n$ that is initially all zeros.\n\nThe $\\Big((i-1)q+j\\Big)$-th operation is the $\\Big((a_i + j b_i) \\mod{q} + 1\\Big)$-th given standard operation ($1\\le i\\le t$ and $1\\le j\\le q$).", "outputFormat": "Output one integer, representing the total sum of all query answers.\n\nSince the answer may be very large, you only need to output the result modulo $p=10^7+19$.\n\nNote: If the final accumulated sum $\\mathrm{ans}$ is negative, you should output $\\big((ans \\mod{p})+p\\big)\\mod{p}$.", "hint": "Subtask $1$ ($50$ points): $1\\le n\\le 500000$, $1\\le q\\le 10^5$, and $1\\le t\\le 5$. All $val$ appearing in the input satisfy $-10^9\\le val\\le 10^9$. All $a_i$ and $b_i$ satisfy $0\\le a_i,b_i\\le 10^9$.\n\nSubtask $2$ ($50$ points): $1\\le n\\le 10^9$, $1\\le q\\le 10^5$, and $1\\le~t~\\le~100$. All $val$ appearing in the input satisfy $-10^9\\le val\\le 10^9$. All $a_i$ and $b_i$ satisfy $0\\le a_i,b_i\\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2019] 快速查询", "background": "", "description": "给定一个长度为 $n$ 的整数数列，里面的元素依次编号为 $a_1,~a_2,~a_3,~\\dots,~a_n$。初始的时候，所有元素都为零。现在按照时间顺序提供了若干次关于这个数列的修改或询问，每一次修改或询问一定为以下六种情况之一：\n\n- **1 i val** ：将 $a_i$ 赋值为给定整数 $val$；\n\n- **2 val** ：将所有元素同时加上 $val$；\n\n- **3 val** ：将所有元素同时乘上 $val$；\n\n- **4 val** ：将所有元素同时赋值为 $val$；\n\n- **5 i** ：询问第 $i$ 个元素 $a_i$ 现在的值是多少；\n\n- **6** ：询问现在所有元素的和。", "inputFormat": "为了避免读入太大，输入文件采取如下的形式。\n\n第一行给定整数 $n$，表示给定数列长度为 $n$。\n 第二行给定整数 $q$，并且之后的 $q$ 行，每一行提供一个修改或询问，输入的格式与题目所述一致，请参见样例。\n 我们称上述给定的修改或询问为标准操作。\n 之后给定一个整数 $t$，并且之后的 $t$ 行每行给定两个正整数 $a_i$ 和 $b_i$，这里的下标 $i$ 依次记为 $1$ 到 $t$ 。\n\n你需要对初始值全为零的长度为 $n$ 的序列做总计 $t\\times q$ 次操作。\n 其中第 $\\Big((i-1)q+j\\Big)$ 次操作形如第 $\\Big((a_i + j b_i) \\mod{q} + 1\\Big)$ 个给定的标准操作（$1\\le i\\le t$ 且 $1\\le j\\le q$）。", "outputFormat": "输出一个整数，表示所有询问答案的累计和。\n\n因为答案可能很大，只要求输出其结果关于 $p=10^7+19$ 取模后的值。\n\n注意：若最终的累计和 ans 小于零，你应该输出 $\\big((ans \\mod{p})+p\\big)\\mod{p}$。", "hint": "子任务$1$：（$50$分）$1\\le  n\\le 500000$，$1\\le q\\le 10^5$ 且 $1\\le t\\le 5$，所有在输入中出现的$val$  满足$-10^9\\le val\\le 10^9$，所有$a_i$和$b_i$满足$0\\le a_i,b_i\\le 10^9$\n\n子任务$2$：（$50$分）$1\\le n\\le 10^9$，$1\\le q\\le 10^5$ 且 $1\\le~t~\\le~100$，所有在输入中出现的$val$ 满足$-10^9\\le val\\le  10^9$，所有$a_i$和$b_i$满足$0\\le a_i,b_i\\le 10^9$\n\n", "locale": "zh-CN"}}}
{"pid": "P5359", "type": "P", "difficulty": 7, "samples": [["3 5\n1 0 1\n0 0 0", "172"], ["5 7\n1 0 0 0 2\n0 0 3 0 0", "116370"], ["10 13\n0 2 0 0 1 0 2 0 0 3\n0 1 0 1 0 0 0 0 4 0", "770175525"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "2019", "线段树", "各省省选", "山东", "O2优化"], "title": "[SDOI2019] 染色", "background": "", "description": "给定 $2 \\times n$ 的格点图。其中一些结点有着已知的颜色，其余的结点还没有被染色。\n\n 一个合法的染色方案不允许相邻结点有相同的染色。\n\n现在一共有 $c$ 种不同的颜色，依次记为 $1$ 到 $c$。\n\n 请问有多少对未染色结点的合法染色方案？", "inputFormat": "第一行有两个整数$n$和$c$，分别描述了格点图的大小和总的颜色个数。\n\n之后两行，每行有$n$个整数：如果是 $0$ 则表示对应结点未被染色，否则一定是一个$1$到$c$的整数表示对应结点已经染了某一种颜色。", "outputFormat": "输出一个整数，为总的染色方案数对$10^9+9$取模后的值。", "hint": "子任务$1$：（$44$分）$1\\le n\\le 10000$ 且 $5\\le c\\le 10000$；不存在一列有$2$个已染色结点；被染色结点全部位于第一行；第一列和最后一列均有结点已被染色。\n\n子任务$2$：（$32$分）$1\\le n\\le 10000$ 且 $5\\le c\\le 10000$；不存在一列有$2$个已染色结点；第一列和最后一列均有结点已被染色。\n\n子任务$3$：（$12$分）$1\\le n\\le 10000$ 且 $5\\le c\\le 10000$；第一列和最后一列均有结点已被染色。\n\n子任务$4$：（$8$分）$1\\le n\\le 10000$ 且 $5\\le c\\le 10000$。\n\n子任务$5$：（$4$分）$1\\le n\\le 100000$ 且 $5\\le c\\le 100000$。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2019] Coloring", "background": "", "description": "Given a $2 \\times n$ grid graph. Some vertices already have known colors, and the remaining vertices are not colored yet.\n\nA valid coloring does not allow adjacent vertices to have the same color.\n\nThere are $c$ different colors in total, numbered from $1$ to $c$.\n\nHow many valid colorings are there for the uncolored vertices?", "inputFormat": "The first line contains two integers $n$ and $c$, describing the size of the grid graph and the total number of colors.\n\nThen there are two lines, each containing $n$ integers: if it is $0$, it means the corresponding vertex is uncolored; otherwise, it must be an integer from $1$ to $c$, meaning the vertex has already been colored with a certain color.", "outputFormat": "Output one integer: the total number of valid colorings modulo $10^9+9$.", "hint": "Subtask $1$ ($44$ points): $1 \\le n \\le 10000$ and $5 \\le c \\le 10000$; there is no column with $2$ colored vertices; all colored vertices are in the first row; both the first column and the last column have a colored vertex.\n\nSubtask $2$ ($32$ points): $1 \\le n \\le 10000$ and $5 \\le c \\le 10000$; there is no column with $2$ colored vertices; both the first column and the last column have a colored vertex.\n\nSubtask $3$ ($12$ points): $1 \\le n \\le 10000$ and $5 \\le c \\le 10000$; both the first column and the last column have a colored vertex.\n\nSubtask $4$ ($8$ points): $1 \\le n \\le 10000$ and $5 \\le c \\le 10000$.\n\nSubtask $5$ ($4$ points): $1 \\le n \\le 100000$ and $5 \\le c \\le 100000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2019] 染色", "background": "", "description": "给定 $2 \\times n$ 的格点图。其中一些结点有着已知的颜色，其余的结点还没有被染色。\n\n 一个合法的染色方案不允许相邻结点有相同的染色。\n\n现在一共有 $c$ 种不同的颜色，依次记为 $1$ 到 $c$。\n\n 请问有多少对未染色结点的合法染色方案？", "inputFormat": "第一行有两个整数$n$和$c$，分别描述了格点图的大小和总的颜色个数。\n\n之后两行，每行有$n$个整数：如果是 $0$ 则表示对应结点未被染色，否则一定是一个$1$到$c$的整数表示对应结点已经染了某一种颜色。", "outputFormat": "输出一个整数，为总的染色方案数对$10^9+9$取模后的值。", "hint": "子任务$1$：（$44$分）$1\\le n\\le 10000$ 且 $5\\le c\\le 10000$；不存在一列有$2$个已染色结点；被染色结点全部位于第一行；第一列和最后一列均有结点已被染色。\n\n子任务$2$：（$32$分）$1\\le n\\le 10000$ 且 $5\\le c\\le 10000$；不存在一列有$2$个已染色结点；第一列和最后一列均有结点已被染色。\n\n子任务$3$：（$12$分）$1\\le n\\le 10000$ 且 $5\\le c\\le 10000$；第一列和最后一列均有结点已被染色。\n\n子任务$4$：（$8$分）$1\\le n\\le 10000$ 且 $5\\le c\\le 10000$。\n\n子任务$5$：（$4$分）$1\\le n\\le 100000$ 且 $5\\le c\\le 100000$。", "locale": "zh-CN"}}}
{"pid": "P5360", "type": "P", "difficulty": 7, "samples": [["2 4 1 2 3 5\n3\n2 2\n2 3\n3 3", "9\n5\n13"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "山东", "O2优化"], "title": "[SDOI2019] 世界地图", "background": "", "description": "在遥远的艾莉芬特星球上，有着繁荣的艾莉芬特文明。和地球人一样，艾莉芬特人使用经纬度来标记星球上的每个位置。他们把艾莉芬特星球从北到南划分为$n$个纬度，从西到东划分为$m$个经度。在每条经线和纬线相交的地方都有一个国家，他们用$(i,j)$来表示纬度为$i$，经度为$j$的国家，显然一共有$n\\times  m$个国家。\n\n艾莉芬特人在任意两个经度或者纬度相邻的国家之间都修建了一条双向道路。\n\n考虑经度相邻的情况：对于任意一个国家$(i,j)(1\\leq i\\leq n,1\\leq j\\leq m)$，它和国家$(i,j+1)$之间都有一条道路，特别地当$j=m$时，$(i,m)$和$(i,1)$之间也有一条道路。\n\n考虑纬度相邻的情况：对于任意一个国家$(i,j)(1\\leq i<n,1\\leq j\\leq m)$，它和国家$(i+1,j)$之间都有一条道路。注意：南北极并不相邻。\n\n艾莉芬特星球并不和平，部分国家卷入了世界大战之中。在接下来$q$个世纪的第$i$个世纪里，经度在$[l_i,r_i]$之间的所有国家都卷入了该世纪发生的世界大战中。当世界大战发生时，被卷入战争的国家都很危险。如果一个国家未被卷入战争，那么它就是一个和平的国家；如果一条道路两端点都是和平的国家，那么它就是一条和平的道路。处于安全考虑，艾莉芬特联合政府会选择只开放一些和平的道路，使得任意两个和平的国家在战争期间都能仅通过这些开放的和平的道路直接或间接连通。\n\n对于任意一条道路，将它保留下来所需的安保代价都不尽相同。请写一个程序，帮助联合政府找到安保代价之和最少的方案。\n\n注意：一个世纪结束后，该世纪的世界大战将会结束，下一场战争的参战国与当前战争的参战国之间没有任何联系。", "inputFormat": "第一行包含 $6$ 个正整数 $n,m,SA,SB,SC,lim$，其中$n$表示纬度的范围，$m$ 表示经度的范围。\n\n为了减少输入量，每条道路的安保代价将由以下代码生成，其中 $\\texttt{addedge(a,b,c,d,w)}$ 表示$(a,b)$和$(c,d)$之间道路的安保代价为$w$：\n\n```cpp\nunsigned int SA, SB, SC;int lim;\nint getweight() {\n    SA ^= SA << 16;\n    SA ^= SA >> 5;\n    SA ^= SA << 1;\n    unsigned int t = SA;\n    SA = SB;\n    SB = SC;\n    SC^ = t ^ SA;\n    return SC % lim + 1;\n}\nvoid gen() {\n    scanf(\"%d%d%u%u%u%d\", &n, &m, &SA, &SB, &SC, &lim);\n    int i, j, w;\n    for(i = 1; i <= n; i++)\n        for(j = 1; j <= m; j++) {\n            w = getweight();\n            if (j < m) {\n                addedge(i, j, i, j + 1, w);\n            } else {\n                addedge(i, j, i, 1, w);\n            }\n        }\n    for(i = 1; i < n; i++)\n        for(j = 1; j <= m; j++) {\n            w = getweight();\n            addedge(i, j, i + 1, j, w);\n        }\n}\n```\n\n第二行包含一个正整数$q$，表示询问次数。\n\n接下来 $q$ 行，每行 $2$ 个正整数 $l_i,r_i$，依次表示每个询问。", "outputFormat": "输出 $q$ 行，每行一个整数，依次回答每个询问，即安保代价之和。", "hint": "## 样例解释：\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/58230.png )\n\n## 数据范围：\n\n对于$100\\%$的数据，$1<l_i\\leq r_i<m,1\\leq SA,SB,SC\\leq 10^9$。\n\n子任务 $1$:（$10$ 分）$n=m=lim=q=50$；\n\n子任务 $2$:（$20$ 分）$n=100,m=10000,lim=5,q=10000$；\n\n子任务 $3$:（$10$ 分）$n=1,m=10000,lim=10^9,q=300000$；\n\n子任务 $4$:（$20$ 分）$n=2,m=10000,lim=10^9,q=300000$；\n\n子任务 $4$:（$40$ 分）$n=100,m=10000,lim=10^9,q=10000$；", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2019] World Map", "background": "", "description": "On the distant planet Elephant, there is a prosperous Elephant civilization. Like humans on Earth, Elephants use latitude and longitude to mark every location on the planet. They divide the planet from north to south into $n$ latitudes, and from west to east into $m$ longitudes. At every intersection of a meridian and a parallel there is a country. They use $(i,j)$ to denote the country at latitude $i$ and longitude $j$. Clearly, there are $n \\times m$ countries in total.\n\nElephants build a bidirectional road between any two countries that are adjacent in longitude or latitude.\n\nConsider longitude adjacency: for any country $(i,j)$ $(1 \\leq i \\leq n, 1 \\leq j \\leq m)$, there is a road between it and country $(i,j+1)$. In particular, when $j=m$, there is also a road between $(i,m)$ and $(i,1)$.\n\nConsider latitude adjacency: for any country $(i,j)$ $(1 \\leq i < n, 1 \\leq j \\leq m)$, there is a road between it and country $(i+1,j)$. Note that the North Pole and the South Pole are not adjacent.\n\nThe Elephant planet is not peaceful, and some countries are involved in a world war. In the $i$-th century among the next $q$ centuries, all countries whose longitudes are in $[l_i, r_i]$ are involved in the world war of that century. When a world war happens, countries involved in the war are dangerous. If a country is not involved in the war, then it is a peaceful country. If both endpoints of a road are peaceful countries, then it is a peaceful road. For safety reasons, the Elephant United Government will choose to open only some peaceful roads, so that during the war, any two peaceful countries can be connected directly or indirectly using only these opened peaceful roads.\n\nFor any road, the security cost required to keep it is different. Please write a program to help the united government find a plan with the minimum total security cost.\n\nNote that after a century ends, the world war of that century will end. The participants of the next war have no relation to those of the current war.", "inputFormat": "The first line contains $6$ positive integers $n, m, SA, SB, SC, lim$, where $n$ is the range of latitudes and $m$ is the range of longitudes.\n\nTo reduce the input size, the security cost of each road is generated by the following code, where $\\texttt{addedge(a,b,c,d,w)}$ means that the security cost of the road between $(a,b)$ and $(c,d)$ is $w$:\n\n```cpp\nunsigned int SA, SB, SC;int lim;\nint getweight() {\n    SA ^= SA << 16;\n    SA ^= SA >> 5;\n    SA ^= SA << 1;\n    unsigned int t = SA;\n    SA = SB;\n    SB = SC;\n    SC^ = t ^ SA;\n    return SC % lim + 1;\n}\nvoid gen() {\n    scanf(\"%d%d%u%u%u%d\", &n, &m, &SA, &SB, &SC, &lim);\n    int i, j, w;\n    for(i = 1; i <= n; i++)\n        for(j = 1; j <= m; j++) {\n            w = getweight();\n            if (j < m) {\n                addedge(i, j, i, j + 1, w);\n            } else {\n                addedge(i, j, i, 1, w);\n            }\n        }\n    for(i = 1; i < n; i++)\n        for(j = 1; j <= m; j++) {\n            w = getweight();\n            addedge(i, j, i + 1, j, w);\n        }\n}\n```\n\nThe second line contains a positive integer $q$, indicating the number of queries.\n\nIn the next $q$ lines, each line contains $2$ positive integers $l_i, r_i$, describing each query in order.", "outputFormat": "Output $q$ lines. Each line contains one integer, answering the corresponding query, i.e. the total security cost.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2019] 世界地图", "background": "", "description": "在遥远的艾莉芬特星球上，有着繁荣的艾莉芬特文明。和地球人一样，艾莉芬特人使用经纬度来标记星球上的每个位置。他们把艾莉芬特星球从北到南划分为$n$个纬度，从西到东划分为$m$个经度。在每条经线和纬线相交的地方都有一个国家，他们用$(i,j)$来表示纬度为$i$，经度为$j$的国家，显然一共有$n\\times  m$个国家。\n\n艾莉芬特人在任意两个经度或者纬度相邻的国家之间都修建了一条双向道路。\n\n考虑经度相邻的情况：对于任意一个国家$(i,j)(1\\leq i\\leq n,1\\leq j\\leq m)$，它和国家$(i,j+1)$之间都有一条道路，特别地当$j=m$时，$(i,m)$和$(i,1)$之间也有一条道路。\n\n考虑纬度相邻的情况：对于任意一个国家$(i,j)(1\\leq i<n,1\\leq j\\leq m)$，它和国家$(i+1,j)$之间都有一条道路。注意：南北极并不相邻。\n\n艾莉芬特星球并不和平，部分国家卷入了世界大战之中。在接下来$q$个世纪的第$i$个世纪里，经度在$[l_i,r_i]$之间的所有国家都卷入了该世纪发生的世界大战中。当世界大战发生时，被卷入战争的国家都很危险。如果一个国家未被卷入战争，那么它就是一个和平的国家；如果一条道路两端点都是和平的国家，那么它就是一条和平的道路。处于安全考虑，艾莉芬特联合政府会选择只开放一些和平的道路，使得任意两个和平的国家在战争期间都能仅通过这些开放的和平的道路直接或间接连通。\n\n对于任意一条道路，将它保留下来所需的安保代价都不尽相同。请写一个程序，帮助联合政府找到安保代价之和最少的方案。\n\n注意：一个世纪结束后，该世纪的世界大战将会结束，下一场战争的参战国与当前战争的参战国之间没有任何联系。", "inputFormat": "第一行包含 $6$ 个正整数 $n,m,SA,SB,SC,lim$，其中$n$表示纬度的范围，$m$ 表示经度的范围。\n\n为了减少输入量，每条道路的安保代价将由以下代码生成，其中 $\\texttt{addedge(a,b,c,d,w)}$ 表示$(a,b)$和$(c,d)$之间道路的安保代价为$w$：\n\n```cpp\nunsigned int SA, SB, SC;int lim;\nint getweight() {\n    SA ^= SA << 16;\n    SA ^= SA >> 5;\n    SA ^= SA << 1;\n    unsigned int t = SA;\n    SA = SB;\n    SB = SC;\n    SC^ = t ^ SA;\n    return SC % lim + 1;\n}\nvoid gen() {\n    scanf(\"%d%d%u%u%u%d\", &n, &m, &SA, &SB, &SC, &lim);\n    int i, j, w;\n    for(i = 1; i <= n; i++)\n        for(j = 1; j <= m; j++) {\n            w = getweight();\n            if (j < m) {\n                addedge(i, j, i, j + 1, w);\n            } else {\n                addedge(i, j, i, 1, w);\n            }\n        }\n    for(i = 1; i < n; i++)\n        for(j = 1; j <= m; j++) {\n            w = getweight();\n            addedge(i, j, i + 1, j, w);\n        }\n}\n```\n\n第二行包含一个正整数$q$，表示询问次数。\n\n接下来 $q$ 行，每行 $2$ 个正整数 $l_i,r_i$，依次表示每个询问。", "outputFormat": "输出 $q$ 行，每行一个整数，依次回答每个询问，即安保代价之和。", "hint": "## 样例解释：\n\n![qwq](https://cdn.luogu.com.cn/upload/pic/58230.png )\n\n## 数据范围：\n\n对于$100\\%$的数据，$1<l_i\\leq r_i<m,1\\leq SA,SB,SC\\leq 10^9$。\n\n子任务 $1$:（$10$ 分）$n=m=lim=q=50$；\n\n子任务 $2$:（$20$ 分）$n=100,m=10000,lim=5,q=10000$；\n\n子任务 $3$:（$10$ 分）$n=1,m=10000,lim=10^9,q=300000$；\n\n子任务 $4$:（$20$ 分）$n=2,m=10000,lim=10^9,q=300000$；\n\n子任务 $4$:（$40$ 分）$n=100,m=10000,lim=10^9,q=10000$；", "locale": "zh-CN"}}}
{"pid": "P5361", "type": "P", "difficulty": 6, "samples": [["2\n6 15\n1 2\n1 3\n1 4\n1 5\n1 6\n2 3\n2 4\n2 5\n2 6\n3 4\n3 5\n3 6\n4 5\n4 6\n5 6\n8 11\n1 2\n2 3\n1 4\n3 7\n4 5\n5 2\n2 6\n6 7\n5 6\n5 8\n6 8", "6 1 2 3 4 5 6\n1 4\n8 1 2 3 4 5 6 7 8\n4 8 4 7 2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2019", "各省省选", "山东", "Special Judge", "O2优化"], "title": "[SDOI2019] 热闹的聚会与尴尬的聚会", "background": "小 Q 的生日快到了，他决定周末邀请一些朋友到他的新房子一起聚会！", "description": "他的联系薄上有 $n$ 位好友，他们两两之间或者互相认识，或者互相不认识。小 Q 希望在周六办一个热闹的聚会，再在周日办一个尴尬的聚会。\n\n- 一场热闹度为 $p$ 的聚会请来了任意多位好友，对于每一位到场的好友来说都有至少 $p$ 位他认识的好友也参加了聚会，且至少对于一位到场的好友来说现场恰好有 $p$ 位他认识的好友；\n- 一场尴尬度为 $q$ 的聚会请来了恰好 $q$ 位好友，且他们两两互不认识。\n\n两场聚会可能有重复的参与者，联系薄上也有可能有某些好友同时缺席了两场聚会。\n\n小 Q 喜欢周六聚会的热闹度 $p$ 与周日聚会的尴尬度 $q$ 之间满足：$\\left\\lfloor \\frac{n}{p+1} \\right\\rfloor\\! \\le q$ 且 $\\left\\lfloor \\frac{n}{q+1} \\right\\rfloor\\! \\le p$。\n\n请帮助小 Q 找出一个可行的邀请方案。", "inputFormat": "**输入含有多组测试数据**，并在第一行给定一个整数 $T$，表示总共有多少组测试数据。之后依次给出每一组数据。\n\n每一组测试数据第一行给定两个整数 $n$ 和 $m$，依次表示联系薄中好友的总数，以及有多少对互相认识的好友。\n\n之后 $m$ 行每行给定两个正整数 $u$ 和 $v$，满足 $1\\le u\\neq v\\le n$ ，表示第 $u$ 个好友与第 $v$ 个好友互相认识。", "outputFormat": "对于每一组数据输出两行，依次描述周六热闹的聚会的参加人员，与周日尴尬的聚会的参加人员列表：\n\n第一行先输出一个正整数表示总共邀请来了多少位好友参加周六的聚会，再之后输出若干个不同的整数，按照任意顺序描述被邀请的是哪些好友。\n\n第二行先输出一个正整数表示总共邀请来了多少位好友参加周日的聚会，再之后以任意顺序输出若干个不同的整数，同样描述了周日被邀请的好友。\n\n如果有多组方案，你可以输出其中任何一组。", "hint": "#### 数据规模与约定\n\n- 子任务 $1$（$10$ 分）：$1\\le n\\le 500$；  \n- 子任务 $2$（$10$ 分）：$1\\le n\\le 700$；  \n- 子任务 $3$（$10$ 分）：$1\\le n\\le 900$；  \n- 子任务 $4$（$10$ 分）：$1\\le n\\le 1.1 \\times {10}^3$；  \n- 子任务 $5$（$10$ 分）：$1\\le n\\le 2 \\times {10}^3$；  \n- 子任务 $6$（$10$ 分）：$1\\le n\\le 3 \\times {10}^3$；  \n- 子任务 $7$（$10$ 分）：$1\\le n\\le 4.5 \\times {10}^3$；  \n- 子任务 $8$（$10$ 分）：$1\\le n\\le 6 \\times {10}^3$；  \n- 子任务 $9$（$10$ 分）：$1\\le n\\le 8 \\times {10}^3$；  \n- 子任务 $10$（$10$ 分）：$1\\le n\\le {10}^4$。\n\n对于全部的测试点，满足 $1\\le T\\le 32$ 且 $1\\le m\\le 10^5$。\n\n---\n\n#### 提示\n\n本题读入量很大，请注意自己代码在读入上的所需时间。\n\n---\n#### 说明\n\n感谢 @[81179332\\_](/user/53994) 提供 spj！", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2019] Lively Party and Awkward Party", "background": "Xiao Q’s birthday is coming soon, and he decides to invite some friends to his new house for a party on the weekend.", "description": "There are $n$ friends in his contact list. Any two friends either know each other or do not know each other. Xiao Q wants to hold a lively party on Saturday, and then an awkward party on Sunday.\n\n- A party with liveliness $p$ invites any number of friends. For every friend who attends, there are at least $p$ friends that he knows also attending the party, and for at least one attending friend, there are exactly $p$ friends that he knows at the party.\n- A party with awkwardness $q$ invites exactly $q$ friends, and they are pairwise not acquainted with each other.\n\nThe two parties may have overlapping participants, and it is also possible that some friends in the contact list miss both parties.\n\nXiao Q likes the liveliness $p$ of Saturday’s party and the awkwardness $q$ of Sunday’s party to satisfy: $\\left\\lfloor \\frac{n}{p+1} \\right\\rfloor\\! \\le q$ and $\\left\\lfloor \\frac{n}{q+1} \\right\\rfloor\\! \\le p$.\n\nPlease help Xiao Q find a feasible invitation plan.", "inputFormat": "**The input contains multiple test cases.** The first line gives an integer $T$, which denotes the number of test cases. Then each test case follows.\n\nFor each test case, the first line gives two integers $n$ and $m$, which denote the total number of friends in the contact list, and the number of pairs of friends who know each other.\n\nThen $m$ lines follow. Each line gives two positive integers $u$ and $v$, satisfying $1\\le u\\neq v\\le n$, meaning that friend $u$ and friend $v$ know each other.", "outputFormat": "For each test case, output two lines, describing the participant list of Saturday’s lively party and Sunday’s awkward party, respectively.\n\nThe first line first outputs a positive integer, indicating how many friends are invited to the Saturday party, and then outputs several distinct integers in any order, describing which friends are invited.\n\nThe second line first outputs a positive integer, indicating how many friends are invited to the Sunday party, and then outputs several distinct integers in any order, also describing which friends are invited on Sunday.\n\nIf there are multiple valid solutions, you may output any one of them.", "hint": "#### Constraints\n\n- Subtask $1$ ($10$ points): $1\\le n\\le 500$.  \n- Subtask $2$ ($10$ points): $1\\le n\\le 700$.  \n- Subtask $3$ ($10$ points): $1\\le n\\le 900$.  \n- Subtask $4$ ($10$ points): $1\\le n\\le 1.1 \\times {10}^3$.  \n- Subtask $5$ ($10$ points): $1\\le n\\le 2 \\times {10}^3$.  \n- Subtask $6$ ($10$ points): $1\\le n\\le 3 \\times {10}^3$.  \n- Subtask $7$ ($10$ points): $1\\le n\\le 4.5 \\times {10}^3$.  \n- Subtask $8$ ($10$ points): $1\\le n\\le 6 \\times {10}^3$.  \n- Subtask $9$ ($10$ points): $1\\le n\\le 8 \\times {10}^3$.  \n- Subtask $10$ ($10$ points): $1\\le n\\le {10}^4$.\n\nFor all test points, it holds that $1\\le T\\le 32$ and $1\\le m\\le 10^5$.\n\n---\n\n#### Notes\n\nThe input size of this problem is very large. Please pay attention to the time needed for input in your code.\n\n---\n\n#### Explanation\n\nThanks to @[81179332\\_](/user/53994) for providing the spj!\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2019] 热闹的聚会与尴尬的聚会", "background": "小 Q 的生日快到了，他决定周末邀请一些朋友到他的新房子一起聚会！", "description": "他的联系薄上有 $n$ 位好友，他们两两之间或者互相认识，或者互相不认识。小 Q 希望在周六办一个热闹的聚会，再在周日办一个尴尬的聚会。\n\n- 一场热闹度为 $p$ 的聚会请来了任意多位好友，对于每一位到场的好友来说都有至少 $p$ 位他认识的好友也参加了聚会，且至少对于一位到场的好友来说现场恰好有 $p$ 位他认识的好友；\n- 一场尴尬度为 $q$ 的聚会请来了恰好 $q$ 位好友，且他们两两互不认识。\n\n两场聚会可能有重复的参与者，联系薄上也有可能有某些好友同时缺席了两场聚会。\n\n小 Q 喜欢周六聚会的热闹度 $p$ 与周日聚会的尴尬度 $q$ 之间满足：$\\left\\lfloor \\frac{n}{p+1} \\right\\rfloor\\! \\le q$ 且 $\\left\\lfloor \\frac{n}{q+1} \\right\\rfloor\\! \\le p$。\n\n请帮助小 Q 找出一个可行的邀请方案。", "inputFormat": "**输入含有多组测试数据**，并在第一行给定一个整数 $T$，表示总共有多少组测试数据。之后依次给出每一组数据。\n\n每一组测试数据第一行给定两个整数 $n$ 和 $m$，依次表示联系薄中好友的总数，以及有多少对互相认识的好友。\n\n之后 $m$ 行每行给定两个正整数 $u$ 和 $v$，满足 $1\\le u\\neq v\\le n$ ，表示第 $u$ 个好友与第 $v$ 个好友互相认识。", "outputFormat": "对于每一组数据输出两行，依次描述周六热闹的聚会的参加人员，与周日尴尬的聚会的参加人员列表：\n\n第一行先输出一个正整数表示总共邀请来了多少位好友参加周六的聚会，再之后输出若干个不同的整数，按照任意顺序描述被邀请的是哪些好友。\n\n第二行先输出一个正整数表示总共邀请来了多少位好友参加周日的聚会，再之后以任意顺序输出若干个不同的整数，同样描述了周日被邀请的好友。\n\n如果有多组方案，你可以输出其中任何一组。", "hint": "#### 数据规模与约定\n\n- 子任务 $1$（$10$ 分）：$1\\le n\\le 500$；  \n- 子任务 $2$（$10$ 分）：$1\\le n\\le 700$；  \n- 子任务 $3$（$10$ 分）：$1\\le n\\le 900$；  \n- 子任务 $4$（$10$ 分）：$1\\le n\\le 1.1 \\times {10}^3$；  \n- 子任务 $5$（$10$ 分）：$1\\le n\\le 2 \\times {10}^3$；  \n- 子任务 $6$（$10$ 分）：$1\\le n\\le 3 \\times {10}^3$；  \n- 子任务 $7$（$10$ 分）：$1\\le n\\le 4.5 \\times {10}^3$；  \n- 子任务 $8$（$10$ 分）：$1\\le n\\le 6 \\times {10}^3$；  \n- 子任务 $9$（$10$ 分）：$1\\le n\\le 8 \\times {10}^3$；  \n- 子任务 $10$（$10$ 分）：$1\\le n\\le {10}^4$。\n\n对于全部的测试点，满足 $1\\le T\\le 32$ 且 $1\\le m\\le 10^5$。\n\n---\n\n#### 提示\n\n本题读入量很大，请注意自己代码在读入上的所需时间。\n\n---\n#### 说明\n\n感谢 @[81179332\\_](/user/53994) 提供 spj！", "locale": "zh-CN"}}}
{"pid": "P5362", "type": "P", "difficulty": 7, "samples": [["5\n1001 3\n11001 10\n00111 10\n0011 20\n0 100", "3\n4\n0\n6\n164"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "山东", "O2优化"], "title": "[SDOI2019] 连续子序列", "background": null, "description": "我们定义 $\\textbf{T. M.}$ 序列 $\\{T_n\\}$ 为如下形式得布尔序列：\n\n- $T_0=0$；\n- $T_{2n}=T_n$;\n- $T_{2n+1}=1-T_n$。\n\n这里我们给出 $\\textbf{T. M.}$ 序列得前若干项：$01101001100101101001011001101001\\cdots$。\n\n$\\textbf{T. M.}$ 序列是一个无限长度的序列，它有很多连续子序列。\n 例如 $0$，$1$，$10100$，$10011$ 和 $011001$ 都是它的连续子序列，然而 $111$ 和 $1000$ 却不是它的连续子序列。\n\n现在给定一个布尔序列（01 字符串）$S$ 和一个非负整数 $k$，请统计一下一共有多少种 $\\textbf{T. M.}$ 序列的连续子序列 $T$ 满足：\n\n- $S$ 是 $T$ 的前缀；\n\n- $T$ 是由 $S$ 额外在右侧添加了恰好 $k$ 项形成的。", "inputFormat": "第一行给定一个整数 $T$，表示输入一共含有 $T$ 组数据。\n\n之后 $T$ 行，每一行给定一个 01 字符串 $S$（表示一个布尔序列）和一个非负正整数 $k$，为给定的一组数据。", "outputFormat": "对于每一组数据，输出一行并含有一个整数，表示满足条件的连续子序列个数。因为数值可能很大，请输出关于 $10^9+9$ 取模后的值。", "hint": "子任务 $1$：（$20$ 分）$1\\le T\\le 100$，给定布尔序列长度不超过 $100$，且 $0\\le k\\le 100$。\n\n子任务 $2$：（$20$ 分）$1\\le T\\le 100$，给定布尔序列长度不超过 $100$，且 $0\\le k\\le 50000$。\n\n子任务 $3$：（$60$ 分）$1\\le T\\le 100$，给定布尔序列长度不超过 $100$，且 $0\\le k\\le 10^{18}$", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2019] Consecutive Subsequences", "background": "", "description": "We define the $\\textbf{T. M.}$ sequence $\\{T_n\\}$ as a Boolean sequence of the following form:\n\n- $T_0=0$.\n- $T_{2n}=T_n$.\n- $T_{2n+1}=1-T_n$.\n\nHere are the first several terms of the $\\textbf{T. M.}$ sequence: $01101001100101101001011001101001\\cdots$.\n\nThe $\\textbf{T. M.}$ sequence is an infinite sequence, and it has many consecutive subsequences.  \nFor example, $0$, $1$, $10100$, $10011$, and $011001$ are all consecutive subsequences of it, while $111$ and $1000$ are not.\n\nNow you are given a Boolean sequence (a 01 string) $S$ and a non-negative integer $k$. Please count how many different consecutive subsequences $T$ of the $\\textbf{T. M.}$ sequence satisfy:\n\n- $S$ is a prefix of $T$.\n- $T$ is formed by appending exactly $k$ more terms to the right of $S$.", "inputFormat": "The first line contains an integer $T$, indicating that there are $T$ test cases.\n\nThen follow $T$ lines. Each line contains a 01 string $S$ (representing a Boolean sequence) and a non-negative integer $k$, describing one test case.", "outputFormat": "For each test case, output one line containing an integer, indicating the number of consecutive subsequences that satisfy the conditions. Since the value may be very large, output it modulo $10^9+9$.", "hint": "Subtask $1$ ($20$ points): $1\\le T\\le 100$, the length of the given Boolean sequence is at most $100$, and $0\\le k\\le 100$.\n\nSubtask $2$ ($20$ points): $1\\le T\\le 100$, the length of the given Boolean sequence is at most $100$, and $0\\le k\\le 50000$.\n\nSubtask $3$ ($60$ points): $1\\le T\\le 100$, the length of the given Boolean sequence is at most $100$, and $0\\le k\\le 10^{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2019] 连续子序列", "background": null, "description": "我们定义 $\\textbf{T. M.}$ 序列 $\\{T_n\\}$ 为如下形式得布尔序列：\n\n- $T_0=0$；\n- $T_{2n}=T_n$;\n- $T_{2n+1}=1-T_n$。\n\n这里我们给出 $\\textbf{T. M.}$ 序列得前若干项：$01101001100101101001011001101001\\cdots$。\n\n$\\textbf{T. M.}$ 序列是一个无限长度的序列，它有很多连续子序列。\n 例如 $0$，$1$，$10100$，$10011$ 和 $011001$ 都是它的连续子序列，然而 $111$ 和 $1000$ 却不是它的连续子序列。\n\n现在给定一个布尔序列（01 字符串）$S$ 和一个非负整数 $k$，请统计一下一共有多少种 $\\textbf{T. M.}$ 序列的连续子序列 $T$ 满足：\n\n- $S$ 是 $T$ 的前缀；\n\n- $T$ 是由 $S$ 额外在右侧添加了恰好 $k$ 项形成的。", "inputFormat": "第一行给定一个整数 $T$，表示输入一共含有 $T$ 组数据。\n\n之后 $T$ 行，每一行给定一个 01 字符串 $S$（表示一个布尔序列）和一个非负正整数 $k$，为给定的一组数据。", "outputFormat": "对于每一组数据，输出一行并含有一个整数，表示满足条件的连续子序列个数。因为数值可能很大，请输出关于 $10^9+9$ 取模后的值。", "hint": "子任务 $1$：（$20$ 分）$1\\le T\\le 100$，给定布尔序列长度不超过 $100$，且 $0\\le k\\le 100$。\n\n子任务 $2$：（$20$ 分）$1\\le T\\le 100$，给定布尔序列长度不超过 $100$，且 $0\\le k\\le 50000$。\n\n子任务 $3$：（$60$ 分）$1\\le T\\le 100$，给定布尔序列长度不超过 $100$，且 $0\\le k\\le 10^{18}$", "locale": "zh-CN"}}}
{"pid": "P5363", "type": "P", "difficulty": 6, "samples": [["10 3", "100"], ["199 43", "981535230"], ["99999 47", "39178973"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2019", "各省省选", "山东", "O2优化"], "title": "[SDOI2019] 移动金币", "background": "", "description": "Alice和Bob将要进行如下的一场游戏。二人轮流操作，且Alice先行。\n当轮到一个玩家的时候，他可以选择一枚金币，并将其向左移动任意多格，且至少移动一格。\n金币不能被移出棋盘，也不能越过其它金币。\n\n一个 $1\\times n$ 的棋盘上最初摆放有 $m$ 枚金币。其中每一枚金币占据了一个独立的格子，任意一个格子内最多只有一枚金币。\n\n如果轮到一个玩家的时候他已经无法做出任何有效操作了（显然这个时候$m$枚金币恰好落在最左侧的$m$个格子中），则被判定为输家。已经知道Alice和Bob都是极致聪明的人，他们在任何局面下总能做出最优的操作。那么有多少初始状态能保证Alice必胜呢？", "inputFormat": "输入仅有一行并包含两个正整数，依次为$n$和$m$，如题目所述。", "outputFormat": "输出一个整数，表示有多少初始状态可以保证Alice作为先手方能先手必胜。由于答案可能很大，请输出关于$10^9+9$取模后的值。", "hint": "子任务$1$：（$50$分）$1\\le n\\le 250$且$1\\le m\\le 50$。\n\n子任务$2$：（$50$分）$1\\le n\\le 150000$且$1\\le m\\le 50$。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2019] Moving Coins", "background": "", "description": "Alice and Bob are going to play the following game. They take turns, and Alice moves first.\n\nWhen it is a player's turn, they may choose one coin and move it any number of cells to the left, but at least $1$ cell.\nA coin cannot be moved out of the board, and it cannot pass over other coins.\n\nInitially, there are $m$ coins placed on a $1 \\times n$ board. Each coin occupies a distinct cell, and each cell contains at most one coin.\n\nIf, on a player's turn, they can no longer make any valid move (obviously, at this time the $m$ coins are exactly in the leftmost $m$ cells), then that player is judged to lose. It is known that Alice and Bob are both extremely smart, and they can always make the optimal move in any position. So, how many initial states can guarantee that Alice, as the first player, will win?", "inputFormat": "The input contains only one line with two positive integers, $n$ and $m$, in this order, as described in the statement.", "outputFormat": "Output one integer, the number of initial states that can guarantee Alice, as the first player, will win. Since the answer may be very large, output it modulo $10^9+9$.", "hint": "Subtask $1$ ($50$ points): $1 \\le n \\le 250$ and $1 \\le m \\le 50$.\n\nSubtask $2$ ($50$ points): $1 \\le n \\le 150000$ and $1 \\le m \\le 50$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2019] 移动金币", "background": "", "description": "Alice和Bob将要进行如下的一场游戏。二人轮流操作，且Alice先行。\n当轮到一个玩家的时候，他可以选择一枚金币，并将其向左移动任意多格，且至少移动一格。\n金币不能被移出棋盘，也不能越过其它金币。\n\n一个 $1\\times n$ 的棋盘上最初摆放有 $m$ 枚金币。其中每一枚金币占据了一个独立的格子，任意一个格子内最多只有一枚金币。\n\n如果轮到一个玩家的时候他已经无法做出任何有效操作了（显然这个时候$m$枚金币恰好落在最左侧的$m$个格子中），则被判定为输家。已经知道Alice和Bob都是极致聪明的人，他们在任何局面下总能做出最优的操作。那么有多少初始状态能保证Alice必胜呢？", "inputFormat": "输入仅有一行并包含两个正整数，依次为$n$和$m$，如题目所述。", "outputFormat": "输出一个整数，表示有多少初始状态可以保证Alice作为先手方能先手必胜。由于答案可能很大，请输出关于$10^9+9$取模后的值。", "hint": "子任务$1$：（$50$分）$1\\le n\\le 250$且$1\\le m\\le 50$。\n\n子任务$2$：（$50$分）$1\\le n\\le 150000$且$1\\le m\\le 50$。", "locale": "zh-CN"}}}
{"pid": "P5364", "type": "P", "difficulty": 5, "samples": [["4 2", "37"], ["2333333 2", "514898185"], ["1234567890000 3", "891659731"], ["66666666 10", "32306309"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "各省省选", "矩阵加速", "陕西", "线性代数", "线性递推", "拉格朗日插值法", "特征值"], "title": "[SNOI2017] 礼物", "background": "", "description": "热情好客的**小猴子**请森林中的朋友们吃饭，他的朋友被编号为 $1\\sim N$，每个到来的朋友都会带给他一些礼物：**大香蕉**。其中，第一个朋友会带给他 $1$ 个**大香蕉**，之后，每一个朋友到来以后，都会带给他之前所有人带来的礼物个数再加他的编号的 $K$ 次方那么多个。所以，假设 $K=2$，前几位朋友带来的礼物个数分别是：\n\n$1,5,15,37,83,\\ldots$\n\n假设 $K=3$，前几位朋友带来的礼物个数分别是：\n\n$1,9,37,111,\\ldots$\n\n现在，**小猴子**好奇自己到底能收到第 $N$ 个朋友多少礼物，因此拜托于你了。\n\n已知 $N,K$，请输出第 $N$ 个朋友送的礼物个数对 $10^9+7$ 取模的结果。", "inputFormat": "第一行，两个整数 $N,K$。", "outputFormat": "一个整数，表示第 $N$ 个朋友送的礼物个数对 $10^9+7$ 取模的结果。", "hint": "- $20\\%$ 的数据：$N \\le 10^6$；\n- 另外 $10\\%$ 的数据：$K=1$；\n- 另外 $20\\%$ 的数据：$K=2$；\n- 另外 $20\\%$ 的数据：$K=3$；\n- $100\\%$ 的数据：$N \\le 10^{18}$，$K \\le 10$。", "locale": "zh-CN", "translations": {"en": {"title": "[SNOI2017] Gifts", "background": "", "description": "The hospitable **little monkey** invites friends from the forest to dinner. His friends are numbered from $1$ to $N$. Each arriving friend will bring him some gifts: **big bananas**.\n\nThe first friend brings $1$ **big banana**. After that, when each friend arrives, they will bring the total number of gifts brought by all previous friends, plus their own index raised to the $K$-th power.\n\nSo, if $K=2$, the numbers of gifts brought by the first few friends are:\n\n$1,5,15,37,83,\\ldots$\n\nIf $K=3$, the numbers of gifts brought by the first few friends are:\n\n$1,9,37,111,\\ldots$\n\nNow, the **little monkey** is curious about how many gifts he will receive from the $N$-th friend, so he asks for your help.\n\nGiven $N$ and $K$, output the number of gifts brought by the $N$-th friend modulo $10^9+7$.", "inputFormat": "The first line contains two integers $N,K$.", "outputFormat": "Output one integer, representing the number of gifts brought by the $N$-th friend modulo $10^9+7$.", "hint": "- $20\\%$ of the testdata: $N \\le 10^6$.\n- Another $10\\%$ of the testdata: $K=1$.\n- Another $20\\%$ of the testdata: $K=2$.\n- Another $20\\%$ of the testdata: $K=3$.\n- $100\\%$ of the testdata: $N \\le 10^{18}$, $K \\le 10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SNOI2017] 礼物", "background": "", "description": "热情好客的**小猴子**请森林中的朋友们吃饭，他的朋友被编号为 $1\\sim N$，每个到来的朋友都会带给他一些礼物：**大香蕉**。其中，第一个朋友会带给他 $1$ 个**大香蕉**，之后，每一个朋友到来以后，都会带给他之前所有人带来的礼物个数再加他的编号的 $K$ 次方那么多个。所以，假设 $K=2$，前几位朋友带来的礼物个数分别是：\n\n$1,5,15,37,83,\\ldots$\n\n假设 $K=3$，前几位朋友带来的礼物个数分别是：\n\n$1,9,37,111,\\ldots$\n\n现在，**小猴子**好奇自己到底能收到第 $N$ 个朋友多少礼物，因此拜托于你了。\n\n已知 $N,K$，请输出第 $N$ 个朋友送的礼物个数对 $10^9+7$ 取模的结果。", "inputFormat": "第一行，两个整数 $N,K$。", "outputFormat": "一个整数，表示第 $N$ 个朋友送的礼物个数对 $10^9+7$ 取模的结果。", "hint": "- $20\\%$ 的数据：$N \\le 10^6$；\n- 另外 $10\\%$ 的数据：$K=1$；\n- 另外 $20\\%$ 的数据：$K=2$；\n- 另外 $20\\%$ 的数据：$K=3$；\n- $100\\%$ 的数据：$N \\le 10^{18}$，$K \\le 10$。", "locale": "zh-CN"}}}
{"pid": "P5365", "type": "P", "difficulty": 4, "samples": [["3 24\n4 4 4\n2 2 2", "18"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "各省省选", "背包 DP", "陕西"], "title": "[SNOI2017] 英雄联盟", "background": null, "description": "正在上大学的小皮球热爱英雄联盟这款游戏，而且打的很菜，被网友们戏称为「小学生」。\n\n现在，小皮球终于受不了网友们的嘲讽，决定变强了，他变强的方法就是：买皮肤！\n\n小皮球只会玩 $N$ 个英雄，因此，他也只准备给这 $N$ 个英雄买皮肤，并且决定，以后只玩有皮肤的英雄。\n\n这 $N$ 个英雄中，第 $i$ 个英雄有 $K_i$ 款皮肤，价格是每款 $C_i$ Q币（同一个英雄的皮肤价格相同）。\n\n为了让自己看起来高大上一些，小皮球决定给同学们展示一下自己的皮肤，展示的思路是这样的：对于有皮肤的每一个英雄，随便选一个皮肤给同学看。\n\n比如，小皮球共有 $5$ 个英雄，这 $5$ 个英雄分别有 $0,0,3,2,4$ 款皮肤，那么，小皮球就有 $3 \\times 2 \\times 4 = 24$ 种展示的策略。\n\n现在，小皮球希望自己的展示策略能够至少达到  $M$ 种，请问，小皮球至少要花多少钱呢？", "inputFormat": "第一行，两个整数 $N,M$。\n\n第二行，$N$ 个整数，表示每个英雄的皮肤数量 $K_i$。\n\n第三行，$N$ 个整数，表示每个英雄皮肤的价格 $C_i$。", "outputFormat": "一个整数，表示小皮球达到目标最少的花费。", "hint": "**样例解释**\n\n每一个英雄都只有 $4$ 款皮肤，每款皮肤 $2$ Q币，那么每个英雄买 $3$ 款皮肤，$3 \\times 3 \\times 3 \\ge 24$，共花费 $6 \\times 3$ Q币。\n\n**数据范围**\n\n共 $10$ 组数据，第 $i$ 组数据满足：$N \\le \\max(5, \\log_2^4{i})$\n\n$100\\%$ 的数据：$M \\le 10^{17}, 1 \\le K_i \\le 10, 1 \\le C_i \\le 199$。保证有解。", "locale": "zh-CN", "translations": {"en": {"title": "[SNOI2017] League of Legends", "background": "", "description": "Xiao Piqiu, who is in college, loves the game League of Legends, but he plays very poorly, so online players jokingly call him an “elementary school kid”.\n\nNow, Xiao Piqiu finally cannot stand the ridicule anymore and decides to become stronger. His way to become stronger is: buying skins.\n\nXiao Piqiu can only play $N$ champions, so he only plans to buy skins for these $N$ champions, and he decides that in the future he will only play champions that have skins.\n\nAmong these $N$ champions, the $i$-th champion has $K_i$ skins, and the price is $C_i$ Q-coins per skin (skins of the same champion have the same price).\n\nTo make himself look more impressive, Xiao Piqiu decides to show his skins to his classmates. The idea is: for each champion that has skins, randomly choose one skin to show.\n\nFor example, Xiao Piqiu has $5$ champions, and these $5$ champions have $0, 0, 3, 2, 4$ skins respectively. Then Xiao Piqiu has $3 \\times 2 \\times 4 = 24$ ways to show them.\n\nNow, Xiao Piqiu wants the number of his showing strategies to be at least $M$. How much money does he need to spend at least?", "inputFormat": "The first line contains two integers $N, M$.\n\nThe second line contains $N$ integers, representing the number of skins for each champion $K_i$.\n\nThe third line contains $N$ integers, representing the price of each champion’s skins $C_i$.", "outputFormat": "One integer, representing the minimum cost for Xiao Piqiu to reach the goal.", "hint": "**Sample Explanation**\n\nEach champion has $4$ skins, and each skin costs $2$ Q-coins. Then for each champion, buy $3$ skins: $3 \\times 3 \\times 3 \\ge 24$. The total cost is $6 \\times 3$ Q-coins.\n\n**Constraints**\n\nThere are $10$ test cases in total. For the $i$-th test case: $N \\le \\max(5, \\log_2^4{i})$.\n\nFor $100\\%$ of the testdata: $M \\le 10^{17}, 1 \\le K_i \\le 10, 1 \\le C_i \\le 199$. A solution is guaranteed to exist.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SNOI2017] 英雄联盟", "background": null, "description": "正在上大学的小皮球热爱英雄联盟这款游戏，而且打的很菜，被网友们戏称为「小学生」。\n\n现在，小皮球终于受不了网友们的嘲讽，决定变强了，他变强的方法就是：买皮肤！\n\n小皮球只会玩 $N$ 个英雄，因此，他也只准备给这 $N$ 个英雄买皮肤，并且决定，以后只玩有皮肤的英雄。\n\n这 $N$ 个英雄中，第 $i$ 个英雄有 $K_i$ 款皮肤，价格是每款 $C_i$ Q币（同一个英雄的皮肤价格相同）。\n\n为了让自己看起来高大上一些，小皮球决定给同学们展示一下自己的皮肤，展示的思路是这样的：对于有皮肤的每一个英雄，随便选一个皮肤给同学看。\n\n比如，小皮球共有 $5$ 个英雄，这 $5$ 个英雄分别有 $0,0,3,2,4$ 款皮肤，那么，小皮球就有 $3 \\times 2 \\times 4 = 24$ 种展示的策略。\n\n现在，小皮球希望自己的展示策略能够至少达到  $M$ 种，请问，小皮球至少要花多少钱呢？", "inputFormat": "第一行，两个整数 $N,M$。\n\n第二行，$N$ 个整数，表示每个英雄的皮肤数量 $K_i$。\n\n第三行，$N$ 个整数，表示每个英雄皮肤的价格 $C_i$。", "outputFormat": "一个整数，表示小皮球达到目标最少的花费。", "hint": "**样例解释**\n\n每一个英雄都只有 $4$ 款皮肤，每款皮肤 $2$ Q币，那么每个英雄买 $3$ 款皮肤，$3 \\times 3 \\times 3 \\ge 24$，共花费 $6 \\times 3$ Q币。\n\n**数据范围**\n\n共 $10$ 组数据，第 $i$ 组数据满足：$N \\le \\max(5, \\log_2^4{i})$\n\n$100\\%$ 的数据：$M \\le 10^{17}, 1 \\le K_i \\le 10, 1 \\le C_i \\le 199$。保证有解。", "locale": "zh-CN"}}}
{"pid": "P5366", "type": "P", "difficulty": 7, "samples": [["5 1 30\n5\n1 2 3 4 5", "1\n2\n2\n0\n2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "各省省选", "陕西"], "title": "[SNOI2017] 遗失的答案", "background": "", "description": "小皮球在计算出答案之后，买了一堆皮肤，他心里很开心，但是一不小心，就忘记自己买了哪些皮肤了。= =|||\n\n万幸的是，他还记得他把所有皮肤按照 $1 \\sim \\text{N}$ 来编号，他买来的那些皮肤的编号（他至少买了一款皮肤），最大公约数是 $\\text{G}$，最小公倍数是 $\\text{L}$。\n\n现在，有 $\\text{Q}$ 组询问，每组询问输入一个数字 $\\text{X}$，请你告诉小皮球，有多少种合法的购买方案中，购买了皮肤 $\\text{X}$？\n\n因为答案太大了，所以你只需要输出答案 $\\bmod{10^9+7}$ 即可。", "inputFormat": "第一行，三个数字 $\\text{N, G, L}$，如题意所示。\n\n第二行，一个数字 $\\text{Q}$，表示询问个数。\n\n第三行， $\\text{Q}$ 个数字，表示每个询问所问的 $\\text{X}$。", "outputFormat": "对于每一组询问，在一行中单独输出一个整数，表示这个询问的答案。", "hint": "$\\text{30}\\%$ 的数据：$\\text{N} \\le 20$\n\n$\\text{50}\\%$ 的数据：$\\text{N} \\le 1000$\n\n$\\text{70}\\%$ 的数据：$\\text{N} \\le 100000$\n\n$\\text{100}\\%$ 的数据：$\\text{N, G, L} \\le 10^8, \\text{Q} \\le 10^5, 1 \\le \\text{X} \\le 10^8$\n\n", "locale": "zh-CN", "translations": {"en": {"title": "[SNOI2017] Lost Answers", "background": "", "description": "After calculating the answer, Little Ball bought a bunch of skins. He was very happy, but by accident, he forgot which skins he had bought. = =|||\n\nFortunately, he still remembers that he numbered all skins from $1 \\sim \\text{N}$. Among the skins he bought (he bought at least one skin), the greatest common divisor is $\\text{G}$, and the least common multiple is $\\text{L}$.\n\nNow there are $\\text{Q}$ queries. Each query gives a number $\\text{X}$. Please tell Little Ball: among all valid purchase plans, how many of them include skin $\\text{X}$?\n\nBecause the answer is too large, you only need to output the answer $\\bmod{10^9+7}$.", "inputFormat": "The first line contains three integers $\\text{N, G, L}$, as described.\n\nThe second line contains one integer $\\text{Q}$, the number of queries.\n\nThe third line contains $\\text{Q}$ integers, each being the $\\text{X}$ asked in a query.", "outputFormat": "For each query, output one integer per line, representing the answer to this query.", "hint": "$30\\%$ of the testdata: $\\text{N} \\le 20$.\n\n$50\\%$ of the testdata: $\\text{N} \\le 1000$.\n\n$70\\%$ of the testdata: $\\text{N} \\le 100000$.\n\n$100\\%$ of the testdata: $\\text{N, G, L} \\le 10^8, \\text{Q} \\le 10^5, 1 \\le \\text{X} \\le 10^8$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SNOI2017] 遗失的答案", "background": "", "description": "小皮球在计算出答案之后，买了一堆皮肤，他心里很开心，但是一不小心，就忘记自己买了哪些皮肤了。= =|||\n\n万幸的是，他还记得他把所有皮肤按照 $1 \\sim \\text{N}$ 来编号，他买来的那些皮肤的编号（他至少买了一款皮肤），最大公约数是 $\\text{G}$，最小公倍数是 $\\text{L}$。\n\n现在，有 $\\text{Q}$ 组询问，每组询问输入一个数字 $\\text{X}$，请你告诉小皮球，有多少种合法的购买方案中，购买了皮肤 $\\text{X}$？\n\n因为答案太大了，所以你只需要输出答案 $\\bmod{10^9+7}$ 即可。", "inputFormat": "第一行，三个数字 $\\text{N, G, L}$，如题意所示。\n\n第二行，一个数字 $\\text{Q}$，表示询问个数。\n\n第三行， $\\text{Q}$ 个数字，表示每个询问所问的 $\\text{X}$。", "outputFormat": "对于每一组询问，在一行中单独输出一个整数，表示这个询问的答案。", "hint": "$\\text{30}\\%$ 的数据：$\\text{N} \\le 20$\n\n$\\text{50}\\%$ 的数据：$\\text{N} \\le 1000$\n\n$\\text{70}\\%$ 的数据：$\\text{N} \\le 100000$\n\n$\\text{100}\\%$ 的数据：$\\text{N, G, L} \\le 10^8, \\text{Q} \\le 10^5, 1 \\le \\text{X} \\le 10^8$\n\n", "locale": "zh-CN"}}}
{"pid": "P5367", "type": "P", "difficulty": 4, "samples": [["3\n2 1 3", "3"], ["4\n1 2 4 3", "2"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["线段树", "平衡树", "树状数组", "康托展开", "模板题"], "title": "【模板】康托展开", "background": null, "description": "求 $1\\sim N$ 的一个给定全排列在所有 $1\\sim N$ 全排列中的排名。结果对 $998244353$ 取模。", "inputFormat": "第一行一个正整数 $N$。\n\n第二行 $N$ 个正整数，表示 $1\\sim N$ 的一种全排列。", "outputFormat": "一行一个非负整数，表示答案对 $998244353$ 取模的值。", "hint": "对于 $10\\%$ 数据，$1\\le N\\le 10$。\n\n对于 $50\\%$ 数据，$1\\le N\\le 5000$。\n\n对于 $100\\%$ 数据，$1\\le N\\le 1000000$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Cantor Expansion", "background": "", "description": "Find the rank of a given permutation of $1\\sim N$ among all permutations of $1\\sim N$. Output the result modulo $998244353$.", "inputFormat": "The first line contains a positive integer $N$.\n\nThe second line contains $N$ positive integers, representing a permutation of $1\\sim N$.", "outputFormat": "Output one non-negative integer, the answer modulo $998244353$.", "hint": "For $10\\%$ of the testdata, $1\\le N\\le 10$.\n\nFor $50\\%$ of the testdata, $1\\le N\\le 5000$.\n\nFor $100\\%$ of the testdata, $1\\le N\\le 1000000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】康托展开", "background": null, "description": "求 $1\\sim N$ 的一个给定全排列在所有 $1\\sim N$ 全排列中的排名。结果对 $998244353$ 取模。", "inputFormat": "第一行一个正整数 $N$。\n\n第二行 $N$ 个正整数，表示 $1\\sim N$ 的一种全排列。", "outputFormat": "一行一个非负整数，表示答案对 $998244353$ 取模的值。", "hint": "对于 $10\\%$ 数据，$1\\le N\\le 10$。\n\n对于 $50\\%$ 数据，$1\\le N\\le 5000$。\n\n对于 $100\\%$ 数据，$1\\le N\\le 1000000$。", "locale": "zh-CN"}}}
{"pid": "P5368", "type": "P", "difficulty": 4, "samples": [["3 2\n1 2 3", "3\n1\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2018"], "title": "[PKUSC2018] 真实排名", "background": "", "description": "小 C 是某知名比赛的组织者，该比赛一共有 $n$ 名选手参加，每个选手的成绩是一个非负整数，定义一个选手的排名是：成绩不小于他的选手的数量（包括他自己）。例如如果 $3$ 位选手的成绩分别是 $[1 , 2 ,2]$ ，那么他们的排名分别是 $[3,2,2]$ 。\n\n拥有上帝视角的你知道所有选手的实力，所以在考试前就精准地估计了每个人的成绩，设你估计的第 $i$ 个选手的成绩为$A_i$，且由于你是上帝视角，所以如果不发生任何意外的话，你估计的成绩就是选手的最终成绩。\n\n但是在比赛当天发生了不可抗的事故（例如遭受到了外星人的攻击），导致有一些选手的成绩变成了最终成绩的两倍，即便是有上帝视角的你也不知道具体是哪些选手的成绩翻倍了，唯一知道的信息是这样的选手恰好有 $k$ 个。\n\n现在你需要计算，经过了不可抗事故后，对于第 $i$ 位选手，有多少种情况满足他的排名没有改变。\n\n由于答案可能过大，所以你只需要输出答案对 $998244353$ 取模的值即可。\n", "inputFormat": "第一行两个正整数 $n,k$。\n\n第二行 $n$ 个非负整数 $A_1, A _ 2, \\cdots, A_n$。\n", "outputFormat": "输出 $n$ 行，第 $i$ 行一个非负整数 $ans_i$，表示经过不可抗事故后，第 $i$ 位选手的排名没有发生改变的情况数。\n", "hint": "- 对于 $10\\%$ 的数据，有 $1\\leq n\\leq 15$；\n- 对于 $35\\%$ 的数据，有 $1\\leq n\\leq 10^3$；\n- 另有 $10\\%$ 的数据，满足每个人的成绩都互不相同；\n- 另有 $10\\%$ 的数据，满足 $0\\leq A_i\\leq 10^5$；\n- 另有 $10\\%$ 的数据，满足 $k=85$，$0\\leq A_i\\leq 600$；\n- 对于$100\\%$的数据，有$1\\leq k < n\\leq 10^5$，$0\\leq A_i\\leq 10^9$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[PKUSC2018] True Ranking", "background": "", "description": "Little C is the organizer of a well-known contest. There are $n$ contestants in total, and each contestant's score is a non-negative integer. Define a contestant's rank as: the number of contestants whose scores are not less than theirs (including themselves). For example, if the scores of $3$ contestants are $[1, 2, 2]$, then their ranks are $[3, 2, 2]$.\n\nWith a god's-eye view, you know all contestants' abilities, so before the contest you accurately estimated everyone's score. Let your estimated score for the $i$-th contestant be $A_i$. Since you have a god's-eye view, if nothing unexpected happens, your estimated scores will be the contestants' final scores.\n\nHowever, on the contest day an irresistible accident happened (for example, an alien attack), causing some contestants' scores to become twice their final scores. Even with a god's-eye view, you do not know exactly which contestants' scores were doubled. The only information you know is that there are exactly $k$ such contestants.\n\nNow you need to compute, after the accident, for the $i$-th contestant, how many scenarios make their rank unchanged.\n\nSince the answer may be too large, you only need to output the answer modulo $998244353$.", "inputFormat": "The first line contains two positive integers $n, k$.\n\nThe second line contains $n$ non-negative integers $A_1, A_2, \\cdots, A_n$.", "outputFormat": "Output $n$ lines. The $i$-th line contains a non-negative integer $ans_i$, representing the number of scenarios in which the $i$-th contestant's rank does not change after the accident.", "hint": "- For $10\\%$ of the testdata, $1 \\leq n \\leq 15$.\n- For $35\\%$ of the testdata, $1 \\leq n \\leq 10^3$.\n- Another $10\\%$ of the testdata satisfies that all scores are pairwise distinct.\n- Another $10\\%$ of the testdata satisfies $0 \\leq A_i \\leq 10^5$.\n- Another $10\\%$ of the testdata satisfies $k = 85$, $0 \\leq A_i \\leq 600$.\n- For $100\\%$ of the testdata, $1 \\leq k < n \\leq 10^5$, $0 \\leq A_i \\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[PKUSC2018] 真实排名", "background": "", "description": "小 C 是某知名比赛的组织者，该比赛一共有 $n$ 名选手参加，每个选手的成绩是一个非负整数，定义一个选手的排名是：成绩不小于他的选手的数量（包括他自己）。例如如果 $3$ 位选手的成绩分别是 $[1 , 2 ,2]$ ，那么他们的排名分别是 $[3,2,2]$ 。\n\n拥有上帝视角的你知道所有选手的实力，所以在考试前就精准地估计了每个人的成绩，设你估计的第 $i$ 个选手的成绩为$A_i$，且由于你是上帝视角，所以如果不发生任何意外的话，你估计的成绩就是选手的最终成绩。\n\n但是在比赛当天发生了不可抗的事故（例如遭受到了外星人的攻击），导致有一些选手的成绩变成了最终成绩的两倍，即便是有上帝视角的你也不知道具体是哪些选手的成绩翻倍了，唯一知道的信息是这样的选手恰好有 $k$ 个。\n\n现在你需要计算，经过了不可抗事故后，对于第 $i$ 位选手，有多少种情况满足他的排名没有改变。\n\n由于答案可能过大，所以你只需要输出答案对 $998244353$ 取模的值即可。\n", "inputFormat": "第一行两个正整数 $n,k$。\n\n第二行 $n$ 个非负整数 $A_1, A _ 2, \\cdots, A_n$。\n", "outputFormat": "输出 $n$ 行，第 $i$ 行一个非负整数 $ans_i$，表示经过不可抗事故后，第 $i$ 位选手的排名没有发生改变的情况数。\n", "hint": "- 对于 $10\\%$ 的数据，有 $1\\leq n\\leq 15$；\n- 对于 $35\\%$ 的数据，有 $1\\leq n\\leq 10^3$；\n- 另有 $10\\%$ 的数据，满足每个人的成绩都互不相同；\n- 另有 $10\\%$ 的数据，满足 $0\\leq A_i\\leq 10^5$；\n- 另有 $10\\%$ 的数据，满足 $k=85$，$0\\leq A_i\\leq 600$；\n- 对于$100\\%$的数据，有$1\\leq k < n\\leq 10^5$，$0\\leq A_i\\leq 10^9$。\n", "locale": "zh-CN"}}}
