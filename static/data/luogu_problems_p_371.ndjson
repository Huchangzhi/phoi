{"pid": "P8524", "type": "P", "difficulty": 6, "samples": [["10\n1 81 93 81 16 97 63 26 66 13\n10\n1 1 5 3\n3 5 6\n3 9 9\n3 1 3\n3 1 7\n2 1 3\n3 3 9\n1 5 6 6\n3 1 4\n3 3 9", "174\n66\n83\n354\n363\n121\n440"], ["10\n61 53 17 97 81 17 1 91 38 93\n10\n2 3 6\n2 1 8\n3 1 5\n3 1 1\n3 1 7\n3 3 5\n3 1 4\n2 2 10\n2 1 5\n3 5 5", "104\n30\n108\n48\n84\n5"]], "limits": {"time": [60000, 60000, 60000, 60000], "memory": [524288, 524288, 524288, 524288]}, "tags": ["O2优化", "Ynoi", "2078"], "title": "[Ynoi2078] 《A theory of consciousness from a theoretical computer scienceperspective: Insights from the Conscious Turing Machine》阅读报告（更新中...）", "background": "## 警告：滥用本题将被封号。", "description": "给定一个长度 $n$ 的序列 $a_1,\\dots,a_n$，需要进行 $m$ 次操作，操作共有三种类型：\n\n操作 1：给定 $l,r,x$，先新建一个数组 $b$ 满足 $b_i=a_i$，之后将 $a_x,\\dots,a_{x+r-l}$ 同时修改为 $b_l,\\dots,b_r$；\n\n操作 2：给定 $l,r$，将 $a_l,\\dots,a_r$ 同时修改为除以 $2$ 下取整后的值；\n\n操作 3：给定 $l,r$，求 $a_l,\\dots,a_r$ 的和。", "inputFormat": "第一行一个整数 $n$。\n\n接下来一行 $n$ 个整数表示序列 $a_1,\\dots,a_n$。\n\n接下来一行一个整数 $m$。\n\n接下来 $m$ 行，每行表示一个操作：\n\n`1 l r x` 表示操作 1；\n\n`2 l r` 表示操作 2；\n\n`3 l r` 表示操作 3。", "outputFormat": "对每个操作 3，输出一行，包含一个整数，表示答案。", "hint": "对于 $100\\%$ 的数据，满足 $1\\le n\\le 3\\cdot 10^6$，$1\\le m\\le 3\\cdot 10^6$。\n\n序列的初值满足 $1\\le a_i\\le 10^9。$\n\n对每个操作满足 $1\\le l\\le r\\le n$。\n\n对每个操作 1 满足 $1\\le x\\le x+r-l+1\\le n$。\n\n以上所有数值为整数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2078] 《A theory of consciousness from a theoretical computer scienceperspective: Insights from the Conscious Turing Machine》阅读报告（更新中...）", "background": "## 警告：滥用本题将被封号。", "description": "给定一个长度 $n$ 的序列 $a_1,\\dots,a_n$，需要进行 $m$ 次操作，操作共有三种类型：\n\n操作 1：给定 $l,r,x$，先新建一个数组 $b$ 满足 $b_i=a_i$，之后将 $a_x,\\dots,a_{x+r-l}$ 同时修改为 $b_l,\\dots,b_r$；\n\n操作 2：给定 $l,r$，将 $a_l,\\dots,a_r$ 同时修改为除以 $2$ 下取整后的值；\n\n操作 3：给定 $l,r$，求 $a_l,\\dots,a_r$ 的和。", "inputFormat": "第一行一个整数 $n$。\n\n接下来一行 $n$ 个整数表示序列 $a_1,\\dots,a_n$。\n\n接下来一行一个整数 $m$。\n\n接下来 $m$ 行，每行表示一个操作：\n\n`1 l r x` 表示操作 1；\n\n`2 l r` 表示操作 2；\n\n`3 l r` 表示操作 3。", "outputFormat": "对每个操作 3，输出一行，包含一个整数，表示答案。", "hint": "对于 $100\\%$ 的数据，满足 $1\\le n\\le 3\\cdot 10^6$，$1\\le m\\le 3\\cdot 10^6$。\n\n序列的初值满足 $1\\le a_i\\le 10^9。$\n\n对每个操作满足 $1\\le l\\le r\\le n$。\n\n对每个操作 1 满足 $1\\le x\\le x+r-l+1\\le n$。\n\n以上所有数值为整数。", "locale": "zh-CN"}}}
{"pid": "P8525", "type": "P", "difficulty": 7, "samples": [["10 6\n3 5 93 89 1 1 3 39\n3804 3800 3800 3791 3804 3807 3803 3720\n83 93 90 121 87 86 81 110\n298 291 302 383 298 296 303 266\n15768 15760 15818 15836 15768 15773 15773 15822\n204761 204753 204692 204781 204765 204765 204762 204678", "3805\n85\n299\n15769\n204763\n93"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["O2优化", "Ynoi", "2078"], "title": "[Ynoi2078] 《A Path Towards Autonomous Machine Intelligence》阅读报告（更新中...）", "background": "", "description": "你需要支持 $m$ 次操作，第 $i$ 次操作给出 $L_i,R_i,a_i,b_i,l_i,r_i,X_i,x_i$,\n\n相应的答案定义为：\n\n$(\\texttt{ans}_{i,0},\\texttt{ans}_{i,1}):=F_{i,r_i}(F_{i,r_i-1}(\\dots F_{i,l_i}(x_i,0)\\dots))$，\n\n其中\n\n若 $L_j\\le X_i\\le R_j$ 则 $F_{i,j}(x,y)=((a_jx+b_j)\\bmod 2677114440,\\max(b_j,y))$，\n\n其余情况 $F_{i,j}(x,y)=(x,y)$。\n\n你需要输出 $\\texttt{ans}_{i,0}$ 与 $\\texttt{ans}_{i,1}$ 的异或和。", "inputFormat": "第一行两个整数 $n,m$。\n\n接下来 $m$ 行，第 $i$ 行为 $L_i,R_i,a_i,b_i,l_i,r_i,X_i,x_i$ 表示第 $i$ 次操作。\n\n本题强制在线，对 $2\\le i\\le m$，第 $i$ 次操作的输入的每个数需要与第 $i-1$次操作的答案异或。", "outputFormat": "共 $m$ 行，每行一个整数，表示每个操作的答案。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n样例解释：\n\n在强制在线加密前，样例输入为：\n\n```\n10 6\n3 5 93 89 1 1 3 39\n1 5 5 18 1 2 6 85\n6 8 15 44 2 3 4 59\n1 8 5 84 1 3 4 33\n1 9 83 69 1 4 4 87\n2 10 79 54 6 6 1 93\n```\n\n### \n\n对于 $100\\%$ 的数据，满足：\n\n$1\\le n\\le 10^6$\n\n$1\\le m\\le 3\\times 10^5$\n\n对于 $1\\le i\\le m$：\n\n$1\\le L_i\\le R_i\\le n$\n\n$1\\le a_i\\le 10^6$\n\n$1\\le b_i\\le 10^6$\n\n$1\\le l_i\\le r_i\\le i$\n\n$1\\le X_i\\le n$\n\n$1\\le x_i\\le 10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2078] 《A Path Towards Autonomous Machine Intelligence》阅读报告（更新中...）", "background": "", "description": "你需要支持 $m$ 次操作，第 $i$ 次操作给出 $L_i,R_i,a_i,b_i,l_i,r_i,X_i,x_i$,\n\n相应的答案定义为：\n\n$(\\texttt{ans}_{i,0},\\texttt{ans}_{i,1}):=F_{i,r_i}(F_{i,r_i-1}(\\dots F_{i,l_i}(x_i,0)\\dots))$，\n\n其中\n\n若 $L_j\\le X_i\\le R_j$ 则 $F_{i,j}(x,y)=((a_jx+b_j)\\bmod 2677114440,\\max(b_j,y))$，\n\n其余情况 $F_{i,j}(x,y)=(x,y)$。\n\n你需要输出 $\\texttt{ans}_{i,0}$ 与 $\\texttt{ans}_{i,1}$ 的异或和。", "inputFormat": "第一行两个整数 $n,m$。\n\n接下来 $m$ 行，第 $i$ 行为 $L_i,R_i,a_i,b_i,l_i,r_i,X_i,x_i$ 表示第 $i$ 次操作。\n\n本题强制在线，对 $2\\le i\\le m$，第 $i$ 次操作的输入的每个数需要与第 $i-1$次操作的答案异或。", "outputFormat": "共 $m$ 行，每行一个整数，表示每个操作的答案。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n样例解释：\n\n在强制在线加密前，样例输入为：\n\n```\n10 6\n3 5 93 89 1 1 3 39\n1 5 5 18 1 2 6 85\n6 8 15 44 2 3 4 59\n1 8 5 84 1 3 4 33\n1 9 83 69 1 4 4 87\n2 10 79 54 6 6 1 93\n```\n\n### \n\n对于 $100\\%$ 的数据，满足：\n\n$1\\le n\\le 10^6$\n\n$1\\le m\\le 3\\times 10^5$\n\n对于 $1\\le i\\le m$：\n\n$1\\le L_i\\le R_i\\le n$\n\n$1\\le a_i\\le 10^6$\n\n$1\\le b_i\\le 10^6$\n\n$1\\le l_i\\le r_i\\le i$\n\n$1\\le X_i\\le n$\n\n$1\\le x_i\\le 10^6$。", "locale": "zh-CN"}}}
{"pid": "P8526", "type": "P", "difficulty": 7, "samples": [["5 2\n1 1 1 2 4\n1 5\n3 5\n", "3\n2"]], "limits": {"time": [7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000, 7000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "Ynoi", "2078"], "title": "[Ynoi2078] 《How to represent part-whole hierarchies in a neural network》阅读报告（更新中...）", "background": "", "description": "给定序列 $a_1,\\dots,a_n$，共 $m$ 次询问，每次询问给出 $l,r$，查询所有满足 $l\\le L\\le R\\le r$ 的 $(L,R)$ 的权值的按位异或和，二元组 $(L,R)$ 的权值是 $|\\{a_i\\mid L\\le i\\le R\\}|$。", "inputFormat": "第一行两个整数 $n\\ m$；\n\n接下来一行 $n$ 个整数 $a_1,\\dots,a_n$；\n\n接下来 $m$ 行，每行两个整数 $l\\ r$ 表示一次查询。", "outputFormat": "输出 $m$ 行，依次表示每个询问的答案。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n对于 $5\\%$ 的数据，满足 $1\\le n,m\\le 100$。\n\n对于 $10\\%$ 的数据，满足 $1\\le n,m\\le 5000$。\n\n对于 $20\\%$ 的数据，满足 $1\\le n,m\\le 10^5$。\n\n对于 $30\\%$ 的数据，满足 $1\\le n,m\\le 2\\times 10^5$。\n\n对于 $40\\%$ 的数据，满足 $1\\le n,m\\le 3\\times 10^5$。\n\n对于 $50\\%$ 的数据，满足 $1\\le n,m\\le 3.5\\times 10^5$。\n\n对于另外 $10\\%$ 的数据，满足 $m=n^2$。\n\n对于另外 $10\\%$ 的数据，满足对任意 $i=1\\cdots n$，$a_i\\le 2$。\n\n对于另外 $10\\%$ 的数据，满足对任意 $i=1\\cdots n$，$a_i\\le 10$。\n\n对于 $100\\%$ 的数据，满足 $1\\le n,m\\le 4\\times 10^5$，$1\\le a_i\\le n$，所有数值为整数。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2078] 《How to represent part-whole hierarchies in a neural network》阅读报告（更新中...）", "background": "", "description": "给定序列 $a_1,\\dots,a_n$，共 $m$ 次询问，每次询问给出 $l,r$，查询所有满足 $l\\le L\\le R\\le r$ 的 $(L,R)$ 的权值的按位异或和，二元组 $(L,R)$ 的权值是 $|\\{a_i\\mid L\\le i\\le R\\}|$。", "inputFormat": "第一行两个整数 $n\\ m$；\n\n接下来一行 $n$ 个整数 $a_1,\\dots,a_n$；\n\n接下来 $m$ 行，每行两个整数 $l\\ r$ 表示一次查询。", "outputFormat": "输出 $m$ 行，依次表示每个询问的答案。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n对于 $5\\%$ 的数据，满足 $1\\le n,m\\le 100$。\n\n对于 $10\\%$ 的数据，满足 $1\\le n,m\\le 5000$。\n\n对于 $20\\%$ 的数据，满足 $1\\le n,m\\le 10^5$。\n\n对于 $30\\%$ 的数据，满足 $1\\le n,m\\le 2\\times 10^5$。\n\n对于 $40\\%$ 的数据，满足 $1\\le n,m\\le 3\\times 10^5$。\n\n对于 $50\\%$ 的数据，满足 $1\\le n,m\\le 3.5\\times 10^5$。\n\n对于另外 $10\\%$ 的数据，满足 $m=n^2$。\n\n对于另外 $10\\%$ 的数据，满足对任意 $i=1\\cdots n$，$a_i\\le 2$。\n\n对于另外 $10\\%$ 的数据，满足对任意 $i=1\\cdots n$，$a_i\\le 10$。\n\n对于 $100\\%$ 的数据，满足 $1\\le n,m\\le 4\\times 10^5$，$1\\le a_i\\le n$，所有数值为整数。\n", "locale": "zh-CN"}}}
{"pid": "P8527", "type": "P", "difficulty": 6, "samples": [["3\n1 2 3\n1\n1 2 2", "0\n1\n2"]], "limits": {"time": [2000, 2000], "memory": [524288, 524288]}, "tags": ["2003", "O2优化", "Ynoi"], "title": "[Ynoi2003] 樋口円香", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/n2xd23kw.png)", "description": "给定两个序列 $a_1,\\dots,a_n$，$b_1,\\dots,b_n$，一开始 $b_i=0$；\n\n你需要进行 $m$ 次操作：\n\n每次操作，给出 $l,r,L$，需要对于$k\\in[l,r]$，将 $b_{L+k-l}$ 增加 $a_k$；\n\n最后输出经过所有操作后的序列 $b_1,\\dots,b_n$。\n\n", "inputFormat": "第一行一个整数 $n$；\n\n第二行 $n$ 个整数 $a_1,\\dots,a_n$；\n\n第三行一个整数 $m$；\n\n之后 $m$ 行每行三个整数 $l\\;r\\;L$，表示一个询问。", "outputFormat": "输出 $n$ 行，表示操作后的 $b_1,\\dots,b_n$。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n\n对于 $100\\%$ 的数据满足 $0\\le a_i\\le 1000$；$1\\le n\\le 10^5$；$1\\le m\\le 10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2003] 樋口円香", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/n2xd23kw.png)", "description": "给定两个序列 $a_1,\\dots,a_n$，$b_1,\\dots,b_n$，一开始 $b_i=0$；\n\n你需要进行 $m$ 次操作：\n\n每次操作，给出 $l,r,L$，需要对于$k\\in[l,r]$，将 $b_{L+k-l}$ 增加 $a_k$；\n\n最后输出经过所有操作后的序列 $b_1,\\dots,b_n$。\n\n", "inputFormat": "第一行一个整数 $n$；\n\n第二行 $n$ 个整数 $a_1,\\dots,a_n$；\n\n第三行一个整数 $m$；\n\n之后 $m$ 行每行三个整数 $l\\;r\\;L$，表示一个询问。", "outputFormat": "输出 $n$ 行，表示操作后的 $b_1,\\dots,b_n$。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n\n对于 $100\\%$ 的数据满足 $0\\le a_i\\le 1000$；$1\\le n\\le 10^5$；$1\\le m\\le 10^6$。", "locale": "zh-CN"}}}
{"pid": "P8528", "type": "P", "difficulty": 7, "samples": [["5 5\n2 5 1 3 4\n1\n2\n3\n4\n1 1\n1 4\n3 3\n2 2\n1 1", "1\n10\n1\n1\n1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2003", "O2优化", "Ynoi"], "title": "[Ynoi2003] 铃原露露", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/px0y070c.png)", "description": "给定一棵有根树，顶点编号为 $1,2,\\dots,n$，对 $2\\le i\\le n$ 有 $f_{i}$ 为 $i$ 的父亲。$a_1,\\dots,a_n$ 是 $1,\\dots,n$ 的排列。\n\n共 $m$ 次询问，每次询问给出 $l,r$，询问有多少个二元组 $L,R$，满足 $l\\le L\\le R\\le r$，且对任意 $L\\le a_x\\le a_y\\le R$，有 $x,y$ 在树上的最近公共祖先 $z$ 满足 $L\\le a_z\\le R$。\n\n以上所有数值为整数。", "inputFormat": "第一行两个整数 $n\\ m$；\n\n接下来一行，$n$ 个整数 $a_1,\\dots,a_n$；\n\n接下来 $n-1$ 行，依次为 $f_2,\\dots,f_n$；\n\n接下来 $m$ 行，每行 $l\\ r$ 表示一个询问。", "outputFormat": "对每个询问，输出一行，表示答案。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n对于 $100\\%$ 的数据，满足 $1\\le n,m\\le 2\\times 10^5$，$1\\le f_i\\le i-1$，$l\\le r$。\n\n对于 $25\\%$ 的数据，满足 $n,m\\le 100$。\n\n对于另外 $25\\%$ 的数据，满足 $n,m\\le 3000$。\n\n对于另外 $25\\%$ 的数据，满足 $l=1,\\;r=n,\\;m=1$。\n\n对于另外 $25\\%$ 的数据，无特殊限制。\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2003] 铃原露露", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/px0y070c.png)", "description": "给定一棵有根树，顶点编号为 $1,2,\\dots,n$，对 $2\\le i\\le n$ 有 $f_{i}$ 为 $i$ 的父亲。$a_1,\\dots,a_n$ 是 $1,\\dots,n$ 的排列。\n\n共 $m$ 次询问，每次询问给出 $l,r$，询问有多少个二元组 $L,R$，满足 $l\\le L\\le R\\le r$，且对任意 $L\\le a_x\\le a_y\\le R$，有 $x,y$ 在树上的最近公共祖先 $z$ 满足 $L\\le a_z\\le R$。\n\n以上所有数值为整数。", "inputFormat": "第一行两个整数 $n\\ m$；\n\n接下来一行，$n$ 个整数 $a_1,\\dots,a_n$；\n\n接下来 $n-1$ 行，依次为 $f_2,\\dots,f_n$；\n\n接下来 $m$ 行，每行 $l\\ r$ 表示一个询问。", "outputFormat": "对每个询问，输出一行，表示答案。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n对于 $100\\%$ 的数据，满足 $1\\le n,m\\le 2\\times 10^5$，$1\\le f_i\\le i-1$，$l\\le r$。\n\n对于 $25\\%$ 的数据，满足 $n,m\\le 100$。\n\n对于另外 $25\\%$ 的数据，满足 $n,m\\le 3000$。\n\n对于另外 $25\\%$ 的数据，满足 $l=1,\\;r=n,\\;m=1$。\n\n对于另外 $25\\%$ 的数据，无特殊限制。\n\n", "locale": "zh-CN"}}}
{"pid": "P8529", "type": "P", "difficulty": 7, "samples": [["5 3\n2021 700\n-9384 1031\n2201 2561\n4982 6255\n-1700 388\n-2151 1808 -4359815\n-2850 -1980 7147359\n-924 217 -8902828", "2\n1\n3"]], "limits": {"time": [20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000, 20000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2003", "Special Judge", "O2优化", "Ynoi"], "title": "[Ynoi2003] 赫露艾斯塔", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/1kgx165m.png)", "description": "给定 $n$ 个互不相同的点 $(x_i,y_i),\\;1\\le i\\le n$，$m$ 个集合 $S_j=\\{(x_i,y_i)\\mid A_jx_i+B_jy_i+C_j>0\\},\\;1\\le j\\le m$。\n\n你需要找出一个 $1,2,\\dots,m$ 的排列 $p_1,\\dots,p_m$，使得 $|S_{p_1}|+\\sum\\limits_{i=2}^m |S_{p_i}\\oplus S_{p_{i-1}}|\\le M$。\n\n$M$ 是给定的常数，$A\\oplus B$ 表示 $(A\\cup B)-(A\\cap B)$。", "inputFormat": "第一行两个整数 $n,m$；\n\n接下来 $n$ 行每行两个整数表示 $x_i,y_i$；\n\n接下来 $m$ 行每行三个整数表示 $A_j,B_j,C_j$。", "outputFormat": "输出 $m$ 行，依次表示 $p_1,\\dots,p_m$。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n对于 $100\\%$ 的数据，满足\n\n$1\\le n\\le 10^5$\n\n$1\\le m\\le 2\\times 10^5$\n\n$M=1.8\\times 10^8$\n\n$A_j^2+B_j^2>0$\n\n$-10^8\\le x_i,y_i,A_j,B_j,C_j\\le 10^8$。\n\n实际上数据是随机生成的。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2003] 赫露艾斯塔", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/1kgx165m.png)", "description": "给定 $n$ 个互不相同的点 $(x_i,y_i),\\;1\\le i\\le n$，$m$ 个集合 $S_j=\\{(x_i,y_i)\\mid A_jx_i+B_jy_i+C_j>0\\},\\;1\\le j\\le m$。\n\n你需要找出一个 $1,2,\\dots,m$ 的排列 $p_1,\\dots,p_m$，使得 $|S_{p_1}|+\\sum\\limits_{i=2}^m |S_{p_i}\\oplus S_{p_{i-1}}|\\le M$。\n\n$M$ 是给定的常数，$A\\oplus B$ 表示 $(A\\cup B)-(A\\cap B)$。", "inputFormat": "第一行两个整数 $n,m$；\n\n接下来 $n$ 行每行两个整数表示 $x_i,y_i$；\n\n接下来 $m$ 行每行三个整数表示 $A_j,B_j,C_j$。", "outputFormat": "输出 $m$ 行，依次表示 $p_1,\\dots,p_m$。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n对于 $100\\%$ 的数据，满足\n\n$1\\le n\\le 10^5$\n\n$1\\le m\\le 2\\times 10^5$\n\n$M=1.8\\times 10^8$\n\n$A_j^2+B_j^2>0$\n\n$-10^8\\le x_i,y_i,A_j,B_j,C_j\\le 10^8$。\n\n实际上数据是随机生成的。", "locale": "zh-CN"}}}
{"pid": "P8530", "type": "P", "difficulty": 7, "samples": [["9\n9 8 7 6 2 4 5 3 1\n1 1 4 5 1 4 1 9 1\n9 1 1 4 5 1 4 1 9\n9\n4 9 3 6\n2 9 1 8\n3 8 2 4\n3 9 2 7\n2 8 1 6\n1 9 1 9\n1 3 5 7\n2 3 3 3\n6 6 6 6", "27\n27\n22\n27\n27\n27\n4\n0\n0"]], "limits": {"time": [7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500, 7500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2003", "O2优化", "Ynoi"], "title": "[Ynoi2003] 博丽灵梦", "background": "", "description": "矩形颜色数，带权。\n\n给定一个有 $n$ 个点的二维平面，每个点坐标为 $(i,p_i)$ ，其有权值 $a$。\n\n给定一个长为 $n$ 的数组 $b$，其下标从 $1$ 到 $n$。\n\n有 $m$ 次查询，每次查询给定一个矩形 $l_1,r_1,l_2,r_2$，定义集合 $S=\\{a_i|l_1\\le i\\le r_1 \\land l_2\\le p_i\\le r_2\\}$，求对于集合 $S$ 中所有元素 $j$，$b_j$ 的和。", "inputFormat": "第一行一个整数 $n$。\n\n接下来一行 $n$ 个数，第 $i$ 个数表示 $p_i$。\n\n接下来一行 $n$ 个数，第 $i$ 个数表示 $a_i$。\n\n接下来一行 $n$ 个数，第 $i$ 个数表示 $b_i$。\n\n接下来一行一个整数 $m$。\n\n接下来 $m$ 行，每行 $4$ 个数分别表示 $l_1,r_1,l_2,r_2$，是一组询问。", "outputFormat": "对每个询问，输出一行，包含一个整数，表示答案，答案对 $2^{32}$ 进行取模后输出。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n### 样例解释\n\n对于答案为 $27$ 的询问，$S=\\{1,4,5,9\\}$，对应 $b_j=9,4,5,9$，和为 $27$。\n\n对于答案为 $22$ 的询问，$S=\\{1,4,9\\}$，对应 $b_j=9,4,9$，和为 $22$。\n\n对于答案为 $4$ 的询问， $S=\\{4\\}$，对应 $b_j=4$，和为 $4$。\n\n对于答案为 $0$ 的询问， $S=\\emptyset$，和为 $0$。\n\n### 数据范围\n\n每个测试点的具体限制见下表：\n\n| 测试点编号  |     $n\\le $      |     $m\\le $      |  特殊限制  |\n| :---------: | :--------------: | :--------------: | :--------: |\n|     $1$     |       $10$       |       $10$       |     无     |\n|     $2$     |  $5\\times 10^3$  |  $5\\times 10^3$  |     无     |\n|     $3$     | $2.5\\times 10^4$ |  $5\\times 10^4$  | $\\text{A}$ |\n|     $4$     |  $5\\times 10^4$  |      $10^5$      | $\\text{A}$ |\n|     $5$     | $7.5\\times 10^4$ | $1.5\\times 10^5$ | $\\text{A}$ |\n|     $6$     |      $10^5$      |  $2\\times 10^5$  | $\\text{A}$ |\n|     $7$     |  $2\\times 10^4$  |  $2\\times 10^4$  |     无     |\n|     $8$     |  $3\\times 10^4$  |  $6\\times 10^4$  |     无     |\n|     $9$     |  $4\\times 10^4$  |  $8\\times 10^4$  |     无     |\n|    $10$     |  $5\\times 10^4$  |      $10^5$      |     无     |\n|    $11$     |  $6\\times 10^4$  | $1.2\\times 10^5$ |     无     |\n|    $12$     |  $7\\times 10^4$  | $1.4\\times 10^5$ |     无     |\n| $13\\sim 15$ |      $10^5$      |  $2\\times 10^5$  | $\\text{C}$ |\n| $16\\sim 18$ |      $10^5$      |  $2\\times 10^5$  |     无     |\n|    $19$     |      $10^5$      |  $3\\times 10^5$  |     无     |\n|    $20$     |      $10^5$      |  $4\\times 10^5$  |     无     |\n|    $21$     |      $10^5$      |  $5\\times 10^5$  |     无     |\n|    $22$     |      $10^5$      |  $6\\times 10^5$  |     无     |\n|    $23$     |      $10^5$      |  $8\\times 10^5$  |     无     |\n|    $24$     |      $10^5$      |      $10^6$      |     无     |\n|    $25$     |      $10^5$      |      $10^6$      |     无     |\n\n为了方便，下面记 $(a, b) \\leq (c, d)$ 表示平面上两个点 $(a, b),(c, d)$ 满足 $a \\leq c, b \\leq d$。\n\n特殊限制 A：对于所有询问有 $l_2 = 1, r_2 = n$。\n\n特殊限制 B：这个特殊限制太容易造水了，不要了。\n\n特殊限制 C：最多有 $50$ 对二元组 $(i, j)(1 \\leq i < j \\leq n)$ 不满足 $(i, p_i) \\leq (j, p_j)$。\n\n对于所有测试点：$2 \\leq n \\leq 10^5$，$1 \\leq m \\leq 10^6$，$1 \\leq l_1\\le r_1 \\leq n$，$1 \\leq l_2\\le r_2 \\leq n$，保证 $p_i$ 为一个排列，保证 $1\\le p_i,a_i,b_i\\le n$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2003] 博丽灵梦", "background": "", "description": "矩形颜色数，带权。\n\n给定一个有 $n$ 个点的二维平面，每个点坐标为 $(i,p_i)$ ，其有权值 $a$。\n\n给定一个长为 $n$ 的数组 $b$，其下标从 $1$ 到 $n$。\n\n有 $m$ 次查询，每次查询给定一个矩形 $l_1,r_1,l_2,r_2$，定义集合 $S=\\{a_i|l_1\\le i\\le r_1 \\land l_2\\le p_i\\le r_2\\}$，求对于集合 $S$ 中所有元素 $j$，$b_j$ 的和。", "inputFormat": "第一行一个整数 $n$。\n\n接下来一行 $n$ 个数，第 $i$ 个数表示 $p_i$。\n\n接下来一行 $n$ 个数，第 $i$ 个数表示 $a_i$。\n\n接下来一行 $n$ 个数，第 $i$ 个数表示 $b_i$。\n\n接下来一行一个整数 $m$。\n\n接下来 $m$ 行，每行 $4$ 个数分别表示 $l_1,r_1,l_2,r_2$，是一组询问。", "outputFormat": "对每个询问，输出一行，包含一个整数，表示答案，答案对 $2^{32}$ 进行取模后输出。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n### 样例解释\n\n对于答案为 $27$ 的询问，$S=\\{1,4,5,9\\}$，对应 $b_j=9,4,5,9$，和为 $27$。\n\n对于答案为 $22$ 的询问，$S=\\{1,4,9\\}$，对应 $b_j=9,4,9$，和为 $22$。\n\n对于答案为 $4$ 的询问， $S=\\{4\\}$，对应 $b_j=4$，和为 $4$。\n\n对于答案为 $0$ 的询问， $S=\\emptyset$，和为 $0$。\n\n### 数据范围\n\n每个测试点的具体限制见下表：\n\n| 测试点编号  |     $n\\le $      |     $m\\le $      |  特殊限制  |\n| :---------: | :--------------: | :--------------: | :--------: |\n|     $1$     |       $10$       |       $10$       |     无     |\n|     $2$     |  $5\\times 10^3$  |  $5\\times 10^3$  |     无     |\n|     $3$     | $2.5\\times 10^4$ |  $5\\times 10^4$  | $\\text{A}$ |\n|     $4$     |  $5\\times 10^4$  |      $10^5$      | $\\text{A}$ |\n|     $5$     | $7.5\\times 10^4$ | $1.5\\times 10^5$ | $\\text{A}$ |\n|     $6$     |      $10^5$      |  $2\\times 10^5$  | $\\text{A}$ |\n|     $7$     |  $2\\times 10^4$  |  $2\\times 10^4$  |     无     |\n|     $8$     |  $3\\times 10^4$  |  $6\\times 10^4$  |     无     |\n|     $9$     |  $4\\times 10^4$  |  $8\\times 10^4$  |     无     |\n|    $10$     |  $5\\times 10^4$  |      $10^5$      |     无     |\n|    $11$     |  $6\\times 10^4$  | $1.2\\times 10^5$ |     无     |\n|    $12$     |  $7\\times 10^4$  | $1.4\\times 10^5$ |     无     |\n| $13\\sim 15$ |      $10^5$      |  $2\\times 10^5$  | $\\text{C}$ |\n| $16\\sim 18$ |      $10^5$      |  $2\\times 10^5$  |     无     |\n|    $19$     |      $10^5$      |  $3\\times 10^5$  |     无     |\n|    $20$     |      $10^5$      |  $4\\times 10^5$  |     无     |\n|    $21$     |      $10^5$      |  $5\\times 10^5$  |     无     |\n|    $22$     |      $10^5$      |  $6\\times 10^5$  |     无     |\n|    $23$     |      $10^5$      |  $8\\times 10^5$  |     无     |\n|    $24$     |      $10^5$      |      $10^6$      |     无     |\n|    $25$     |      $10^5$      |      $10^6$      |     无     |\n\n为了方便，下面记 $(a, b) \\leq (c, d)$ 表示平面上两个点 $(a, b),(c, d)$ 满足 $a \\leq c, b \\leq d$。\n\n特殊限制 A：对于所有询问有 $l_2 = 1, r_2 = n$。\n\n特殊限制 B：这个特殊限制太容易造水了，不要了。\n\n特殊限制 C：最多有 $50$ 对二元组 $(i, j)(1 \\leq i < j \\leq n)$ 不满足 $(i, p_i) \\leq (j, p_j)$。\n\n对于所有测试点：$2 \\leq n \\leq 10^5$，$1 \\leq m \\leq 10^6$，$1 \\leq l_1\\le r_1 \\leq n$，$1 \\leq l_2\\le r_2 \\leq n$，保证 $p_i$ 为一个排列，保证 $1\\le p_i,a_i,b_i\\le n$。\n", "locale": "zh-CN"}}}
{"pid": "P8531", "type": "P", "difficulty": 7, "samples": [["10\n1 3\n3 4\n1 2\n5 2\n5 6\n2 6\n3 4\n2 9\n2 1\n3 1\n5\n1 10\n9 10\n3 10\n1 7\n4 9", "4\n0\n3\n3\n1"]], "limits": {"time": [9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000, 9000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2003", "O2优化", "Ynoi"], "title": "[Ynoi2003] 戌亥彗星", "background": "", "description": "定义一个图为海胆， 如果它满足以下条件：\n\n1. 是一个连通图\n2. 包含恰好一个简单环\n3. 除了环以外的点每个点度数不超过 $2$\n\n有一张图，有 $n$ 个点，$n$ 条边，第 $i$ 条边连接 $u_i$ 和 $v_i$（不保证联通）。\n\n定义一张图的区间子图 $[l,r]$ 为 $(V',E'),E'=\\{(u_i,v_i)|l\\leq i\\leq r\\},V'=\\{u_i|l\\leq i\\leq r\\} \\cup \\{v_i|l\\leq i\\leq r\\}$，也就是说，这个区间子图包含且仅包含区间中的边和所有在区间中一条边上的点。\n\n现在有 $q$ 次询问，每次给定一个区间 $l,r$，求 $l,r$ 有多少个子区间 $[l',r'](l\\leq l'\\leq r'\\leq r)$ 满足原图的 $[l',r']$ 区间子图是个海胆。\n\n**对于条件 2 的补充说明：**\n\n1. 简单环的定义是 可以从任一点开始经过一些不重复的边回到起点，途中经过了至少一条边，且除了起点和终点相同以外不经过重复点，例如 $1-2-3-1$ 是简单环，两条 $1-2$ 的边是简单环，但只有一个点的时候不是, $1-2-3-4-5-3-1$ 也不是，（这里的环用某一个点开始的路径表示）。\n2. 条件 $2$ 要求除了环边以外不存在边两端都在这个环上。", "inputFormat": "第一行一个整数 $n$，表示点数和边数。\n\n接下来 $n$ 行，每行两个整数 $u_i,v_i$ 表示一条边。\n\n接下来一行一个整数 $q$。\n\n接下来 $q$ 行，每行两个整数 $l,r$ 表示一个询问。", "outputFormat": "$q$ 行，每行一个数表示这组询问的答案。", "hint": "Idea：lk&nzhtl1477，Solution：lk&ccz181078，Code：lk&ccz181078，Data：lk&ccz181078\n\n**数据保证不存在自环**\n\n\n| 子任务编号 | $n\\le$  | $q\\le$  |    特殊性质    | 分值  |\n| :--------: | :-----: | :-----: | :------------: | :---: |\n|    $1$     |  $100$  |  $100$  |       无       |  $5$  |\n|    $2$     |  $500$  |  $500$  |       无       | $15$  |\n|    $3$     | $5000$  | $5000$  |       无       | $15 $ |\n|    $4$     | $50000$ | $50000$ |       无       | $15$  |\n|    $5$     | $10^6$  |   $1$   |       无       | $15 $ |\n|    $6$     | $10^6$  | $10^6$  | 原图是一个海胆 | $15$  |\n|    $7$     | $10^6$  | $10^6$  |       无       | $20$  |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2003] 戌亥彗星", "background": "", "description": "定义一个图为海胆， 如果它满足以下条件：\n\n1. 是一个连通图\n2. 包含恰好一个简单环\n3. 除了环以外的点每个点度数不超过 $2$\n\n有一张图，有 $n$ 个点，$n$ 条边，第 $i$ 条边连接 $u_i$ 和 $v_i$（不保证联通）。\n\n定义一张图的区间子图 $[l,r]$ 为 $(V',E'),E'=\\{(u_i,v_i)|l\\leq i\\leq r\\},V'=\\{u_i|l\\leq i\\leq r\\} \\cup \\{v_i|l\\leq i\\leq r\\}$，也就是说，这个区间子图包含且仅包含区间中的边和所有在区间中一条边上的点。\n\n现在有 $q$ 次询问，每次给定一个区间 $l,r$，求 $l,r$ 有多少个子区间 $[l',r'](l\\leq l'\\leq r'\\leq r)$ 满足原图的 $[l',r']$ 区间子图是个海胆。\n\n**对于条件 2 的补充说明：**\n\n1. 简单环的定义是 可以从任一点开始经过一些不重复的边回到起点，途中经过了至少一条边，且除了起点和终点相同以外不经过重复点，例如 $1-2-3-1$ 是简单环，两条 $1-2$ 的边是简单环，但只有一个点的时候不是, $1-2-3-4-5-3-1$ 也不是，（这里的环用某一个点开始的路径表示）。\n2. 条件 $2$ 要求除了环边以外不存在边两端都在这个环上。", "inputFormat": "第一行一个整数 $n$，表示点数和边数。\n\n接下来 $n$ 行，每行两个整数 $u_i,v_i$ 表示一条边。\n\n接下来一行一个整数 $q$。\n\n接下来 $q$ 行，每行两个整数 $l,r$ 表示一个询问。", "outputFormat": "$q$ 行，每行一个数表示这组询问的答案。", "hint": "Idea：lk&nzhtl1477，Solution：lk&ccz181078，Code：lk&ccz181078，Data：lk&ccz181078\n\n**数据保证不存在自环**\n\n\n| 子任务编号 | $n\\le$  | $q\\le$  |    特殊性质    | 分值  |\n| :--------: | :-----: | :-----: | :------------: | :---: |\n|    $1$     |  $100$  |  $100$  |       无       |  $5$  |\n|    $2$     |  $500$  |  $500$  |       无       | $15$  |\n|    $3$     | $5000$  | $5000$  |       无       | $15 $ |\n|    $4$     | $50000$ | $50000$ |       无       | $15$  |\n|    $5$     | $10^6$  |   $1$   |       无       | $15 $ |\n|    $6$     | $10^6$  | $10^6$  | 原图是一个海胆 | $15$  |\n|    $7$     | $10^6$  | $10^6$  |       无       | $20$  |", "locale": "zh-CN"}}}
{"pid": "P8532", "type": "P", "difficulty": 7, "samples": [], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152, 2097152]}, "tags": ["2003", "交互题", "Special Judge", "O2优化", "Ynoi"], "title": "[Ynoi2003] 雾雨魔理沙", "background": "**这是一道交互题。**\n\n**在提交本题前请务必仔细阅读以下内容。**\n\n本题只支持 C++ 语言提交（建议使用 C++14，请不要使用 C++14 (GCC9)）。\n\n由于洛谷特殊的交互机制，在提交本题时，请去掉代码中的 ```#include \"count.h\"``` 语句，并将下发文件 **`count_.h`** （注意并不是 `count.zip` 里的 `count.h`）中的内容粘贴到代码最开头，然后提交。\n\n如果您无法打开 `count_.h`，那么可以复制下面的内容。\n\n```cpp\n#ifndef CIRCLE_H\n#define CIRCLE_H\n#include<vector>\nstruct info{\n  unsigned val;\n  unsigned poi[2];\n};\nconst info emptyinfo=info{0,(unsigned)-1,(unsigned)-1};\ninfo MR(info a,info b);\ninfo MC(info a,info b);\nvoid init(int T,int n,int q,std::vector<int>dad,std::vector<info>ve,int M);\nbool isempty(info a);\ninfo ask(int x,int d);\n\n#endif\n```\n\n如果您在提交本题时出现了任何意外的情况，请咨询管理员。", "description": "给出五元组 $(T, I, S_V, S_E, \\iota)$，其中：\n\n- $T$ 是一棵 $n$ 个点的有根树 $T = (V, E)$，其中 $V$ 为 $T$ 的点集，$E$ 为 $T$ 的边集。树的节点被编号为 $1, 2, \\ldots, n$，其中根节点编号为 $1$。\n- $I$ 是一个集合，集合中的元素称作**信息**。其中有两个不同的特殊元素：单位元 $\\epsilon$ 和不合法信息 $\\bot$。\n\n对于一般的信息，其都具有**点集合**和**边集合**两个属性。特别的，对于单位元，其只有边集合的属性，而对于不合法信息，其没有以上两种属性。\n\n- 对于信息 $o \\in I \\setminus \\{ \\epsilon, \\bot \\}$，$o$ 的**点集合**是 $V$ 的一个二元子集，记作 $S_V(o)$，满足 $S_V(o) \\subseteq V$ 且 $\\lvert S_V(o) \\rvert = 2$。其中，两个集合 $A, B$ 的差 $A \\setminus B$ 被定义为 $A \\setminus B = \\{ x \\in A \\hspace{3mu}\\vert\\hspace{3mu} x \\notin B \\}$。\n- 对于信息 $o \\in I \\setminus \\{ \\bot \\}$，$o$ 的**边集合**是 $E$ 的一个子集，记作 $S_E(o)$，满足 $S_E(o) \\subseteq E$。规定单位元的边集合为空，也即 $S_E(\\epsilon) = \\varnothing$。\n- 对于树上的任何一条边 $e \\in E$，记 $e = (u, v)$，存在一个关于 $e$ 的信息 $\\iota(e) \\in I$，它以其端点为点集合、自身为边集合，即 $S_V(\\iota(e)) = \\{ u, v \\}$、$S_E(\\iota(e)) = \\{ e \\}$。\n\n信息有两种合并的方式，分别记作 $R$ 和 $C$。对于 $\\forall a, b \\in I$，记 $r = R(a, b), c = C(a, b)$，满足 $r, c \\in I$，则：\n\n- 单位元和任何信息合并都得到对方。也即，如果 $a = \\epsilon$，那么 $r = c = b$；如果 $b = \\epsilon$，那么 $r = c = a$。\n- 不合法信息和任何信息合并都得到不合法信息。也即，如果 $a = \\bot$ 或者 $b = \\bot$，那么 $r = c = \\bot$。\n- 对于剩下的情况，如果两个信息的**边集合**的交集非空，或者**点集合**的交集的大小不为 $1$，则合并得到不合法信息。也即，如果 $S_E(a) \\cap S_E(b) \\ne \\varnothing$ 或 $\\lvert S_V(a) \\cap S_V(b) \\rvert \\ne 1$，则 $r = c = \\bot$。\n- 否则，有\n  $$ S_E(r) = S_E(c) = S_E(a) \\cup S_E(b) \\text{,} $$\n  $$ S_V(r) = S_V(a) \\text{,} $$\n  $$ S_V(c) = S_V(a) \\oplus S_V(b) \\text{,} $$\n  其中 $\\oplus$ 表示集合的对称差运算，也即 $A \\oplus B = (A \\cup B) \\setminus (A \\cap B)$。\n\n定义 $T$ 中两个点的树上距离为树上以两个点为端点的唯一简单路径经过的边数。\n\n给出评分参数 $M$ 和 $q$ 次询问，每次询问给出树上的一个点 $u$ 和一个非负整数 $d$。记点集 $X$ 为 $T$ 中所有与 $u$ 的树上距离不超过 $d$ 的点构成的集合，又记边集 $Y = \\{ (a, b) \\in E \\hspace{3mu}\\vert\\hspace{3mu} a, b \\in X \\}$ 为 $X$ 内部的边集。可以证明，从 $\\epsilon$ 和所有 $\\iota(e)$（$e \\in E$）出发，总是能通过有限次 $R, C$ 的调用得到信息 $o \\ne \\bot$ 满足 $S_E(o) = Y$。\n\n每组询问中，你需要在 $R$ 和 $C$ 的调用次数总和不超过 $M$ 的限制下构造出一个满足这样的要求的信息 $o$。特别地，如果 $d = 0$，则直接返回单位元 $\\epsilon$ 即可。\n\n----\n\n**【实现细节】**\n\n请确保你的程序开头有 `#include \"count.h\"`。\n\n头文件 `count.h` 中实现了如下内容：\n\n1. 定义了信息对应的数据类型 `info`；\n2. 定义了 $\\epsilon$ 所对应的 `info` 类型常量 `emptyinfo`，你可以在程序中直接使用。\n3. 定义并实现了以下两个信息合并函数，你可以在程序中直接调用：\n   \n   ```cpp\n   info MR(info a,info b);\n   info MC(info a,info b);\n   ```\n   \n   - 两个函数分别返回 $R(a, b)$ 与 $C(a, b)$ 对应的信息。\n   \n   **你需要保证调用 $\\boldsymbol{R(a, b)}$ 与 $\\boldsymbol{C(a, b)}$ 时结果不为 $\\boldsymbol{\\bot}$，否则程序可能会出现异常行为。**\n4. 定义并实现了判定一个信息是否为单位元的函数，你可以在程序中直接调用：\n   ```cpp\n   bool isempty(info a);\n   ```\n   - 这个函数返回真当且仅当 $a$ 为单位元。\n\n可以查看参考交互库了解更多实现细节。\n\n**你不需要，也不应该实现主函数。** 你需要实现如下几个函数：\n\n```cpp\nvoid init(int T, int n, int q, vector<int> fa, vector<info> e, int M);\n```\n\n- `T` 表示测试点编号，`n` 表示树的点数，`q` 表示询问数，`M` 表示该测试点的评分参数。\n- `fa` 和 `e` 的长度均为 $n - 1$。对于 $0 \\le i < n - 1$，$fa[i]$ 和 $i + 2$ 为第 $i$ 条边 $e_i$ 的两个端点，$e[i]$ 为题目描述中提到的 $\\iota(e_i)$ 所对应的 `info` 类型元素。数据保证 $fa[i]$ 小于 $i + 2$。\n\n```cpp\ninfo ask(int u, int d);\n```\n\n给出一个询问，参数的意义见题目描述。你需要在函数结束时返回一个满足题设条件的信息。\n\n最终测试时，在每个测试点，交互库会**恰好**调用一次 `init` 函数，随后调用 $q$ 次 `ask`函数。交互库会使用特殊的实现方式，单个 `info` 类型的变量会恒定消耗 $12$ 字节内存，**这与下发的参考交互库不同**。为保证程序运行时内存使用在题目限制内，你需要保证运行过程中没有过多的 `info` 类型变量同时存在。\n\n保证在满足调用次数限制且不进行 `isempty` 函数调用的情况下，最终测试的交互库运行所需的时间不超过 0.6 秒，交互库本身所消耗的内存不超过 16 MiB。保证在只执行 ${10}^8$ 次 `isempty` 函数调用的情况下，最终测试的交互库运行的时间不超过 0.25 秒。\n\n在下发文件中包含一个名为 `count.cpp` 的文件，作为示例程序，选手可以在此基础上继续实现本题。在下发文件中还额外包含一个名为 `count_backup.h` 的备份文件，我们保证其与 `count.h` 文件完全相同。\n\n----\n\n**【测试程序方式】**\n\n本题目录下提供了两个交互库的参考实现 `grader.o`、`checker.o`，其为两个不同的交互库编译产生的可链接文件。最终测试时所用的交互库实现与该实现有不同，因此选手的解法**不应依赖交互库的具体实现**，同时也不应该依赖 `count.h` 中 `info` 类型的具体实现。\n\n你需要修改下发的 `count.h` 来帮助进行链接。具体的，在将源代码 `count.cpp` 和程序 `grader.o` 进行链接的时候，你需要注释掉 `count.h` 代码的第 5 行，并保留第 4 行的代码。链接 `checker.o` 方法类似，需要注释掉 `count.h` 代码的第 4 行，并保留第 5 行的代码。选手可以对 `count.h` 的实现自行修改来实现不同程序的编译。\n\n修改后，选手可以在本题目录下使用如下命令编译得到可执行程序：\n\n```bash\ng++ count.cpp -c -O2 -std=c++14 -lm && g++ count.o grader.o -o count\ng++ count.cpp -c -O2 -std=c++14 -lm && g++ count.o checker.o -o count\n```\n\n其中第一行命令会编译当前 `count.cpp` 后与 `grader.o` 链接起来，生成可执行文件 `count`，第二行命令则会编译当前 `count.cpp` 后与 `checker.o` 链接起来，生成可执行文件 `count`。\n\n按上述方法编译得到的可执行文件 `count`，其运行方式如下：\n\n- 可执行文件将从标准输入读入以下格式的数据：\n  - 第一行四个整数 $id, n, q, M$，分别表示测试点编号、树的点数、询问数和评分参数；\n  - 第二行 $n - 1$ 个整数 $p_2, p_3, \\ldots, p_n$，分别表示 $2$ 至 $n$ 的父亲节点编号，在本地调试时你需要保证 $\\forall i \\in [2, n]$，$p_i < i$；\n  - 接下来 $q$ 行每行两个整数 $u, d$，描述一次询问。\n- 读入之后，交互库会进行测试。如果你的程序不满足交互库限制，其会在输出中返回对应的错误信息。否则，对于链接的可执行文件，其输出如下：\n  - 总共一行三个整数 $C_1, C_2, C_3$，其中：\n    - $C_1$ 表示程序在 `init` 函数中调用交互库函数的总次数；\n    - $C_2$ 表示程序在运行过程中调用交互库函数的总次数；\n    - $C_3$ 表示程序在 $q$ 次 `ask` 函数中调用交互库函数的次数的最大值。\n    - 对于上述三个统计量，我们只会计入 `MR`、`MC` 函数的调用次数，而不会计入 `isempty` 函数的调用次数。\n- 在链接不同文件的时候，其能够进行的检查也不同，具体地：\n  - `grader.o`：其在运行时不会检查 `ask` 函数返回的信息是否正确，但可以帮助选手判断交互操作是否符合要求。这份程序运行时间最接近评测时的交互库，因此选手可以利用该程序测试运行速度，但不保证程序正确性。\n  - `checker.o`：其在运行时会检查 `ask` 函数返回的信息是否正确，也可以帮助选手判断交互操作是否符合要求。同时其会检查 `ask` 函数返回的信息是否正确。这份程序可以进行答案正确性的检查。\n\n选手在调试时需要保证输入可执行文件 `count` 的数据满足上述输入格式，否则不保证输出结果正确。\n", "inputFormat": "见【测试程序方式】。", "outputFormat": "见【测试程序方式】。", "hint": "Idea：zx2003，Solution：zx2003，Code：zx2003，Data：zx2003\n\n**【评分方式】**\n\n最终评测**只会**收取 `count.cpp`，修改选手目录下其他文件不会对评测结果产生影响。**注意：**\n\n- **未初始化的 `info` 类型的变量不保证是 `emptyinfo`。**\n- **请不要尝试访问或修改 `info` 类型的成员变量，否则将被视为攻击交互库。**\n- **请不要在 `init` 函数调用之前调用 `MR` 和 `MC` 函数，否则可能会发生未定义行为。**\n- **你只能访问自己定义的变量和交互库返回的 `info` 类型变量，尝试访问其他空间将可能导致编译错误或运行时错误。**\n\n**本题首先会受到和传统题相同的限制**，例如编译错误会导致整道题目得 0 分，运行时错误、超过时间限制、超过空间限制等会导致相应测试点得 0 分等。\n\n在上述条件以外，在一个测试点中，若程序执行了非法的函数调用或询问操作中给出了错误回答，该测试点将会获得 0 分。否则，记 $C_1, C_3$ 分别表示你的程序在 `init` 函数中调用交互库函数的次数，和你的程序在所有 $q$ 次 `ask` 函数中调用交互库函数的次数的最大值。如果 $C_1 \\le 3 \\cdot {10}^7$ 且 $C_3$ 不超过该测试点的评分参数 $M$，你将获得该测试点的分数，否则你无法获得该测试点的分数。注意：计算 $C_1, C_3$ 时只会计入 `MR`、`MC` 函数的调用次数，而不会计入 `isempty` 函数的调用次数。\n\n----\n\n**【样例 \\#1】**\n\n见附件中的 `count/count1.in` 与 `count/count1.ans`。\n\n----\n\n**【样例 \\#2】**\n\n见附件中的 `count/count2.in` 与 `count/count2.ans`。\n\n该组样例满足数据范围中的特殊性质 A。\n\n----\n\n**【样例 \\#3】**\n\n见附件中的 `count/count3.in` 与 `count/count3.ans`。\n\n该组样例满足数据范围中的特殊性质 B。\n\n----\n\n**【样例 \\#4】**\n\n见附件中的 `count/count4.in` 与 `count/count4.ans`。\n\n----\n\n**【数据范围】**\n\n对于所有测试点，$1 \\le n \\le 2 \\times {10}^5$，$1 \\le q \\le {10}^6$；每组询问中，有 $1 \\le u \\le n$，$1 \\le d \\le n - 1$。\n\n| 测试点   | $n=$              | $q=$            | 特殊性质 | $M=$  |\n|:-----:|:-----------------:|:---------------:|:----:|:-----:|\n| $1$   | $1000$            | $10^4$          |      | $500$ |\n| $2$   | $2000$            | $10^4$          |      | $500$ |\n| $3,4$ | $10^5$            | $10^6$          | A    | $5$   |\n| $5,6$ | $6 \\times 10^4$   | $6\\times 10^4$  | B    | $50$  |\n| $7$   | $6 \\times 10^4$   | $6 \\times 10^4$ | B    | $5$   |\n| $8$   | $10^5$            | $10^5$          | B    | $5$   |\n| $9$   | $7500$            | $5 \\times 10^4$ | C    | $500$ |\n| $10$  | $10^4$            | $5 \\times 10^4$ |      | $500$ |\n| $11$  | $1.5 \\times 10^4$ | $5 \\times 10^4$ |      | $500$ |\n| $12$  | $2 \\times 10^4$   | $5 \\times 10^4$ |      | $50$  |\n| $13$  | $2.5 \\times 10^4$ | $5 \\times 10^4$ |      | $5$   |\n| $14$  | $3 \\times 10^4$   | $10^5$          |      | $5$   |\n| $15$  | $6 \\times 10^4$   | $10^6$          | D    | $5$   |\n| $16$  | $6 \\times 10^4$   | $10^6$          |      | $5$   |\n| $17$  | $8 \\times 10^4$   | $10^6$          |      | $5$   |\n| $18$  | $10^5$            | $10^6$          |      | $5$   |\n| $19$  | $1.5 \\times 10^5$ | $10^6$          |      | $5$   |\n| $20$  | $2 \\times 10^5$   | $10^6$          |      | $1$   |\n\n\n特殊性质 A：保证 $\\forall i \\in [1, n - 1]$，编号为 $i + 1$ 的点的父节点为 $i$。  \n特殊性质 B：保证所有询问均满足 $u = 1$。  \n特殊性质 C：保证所有询问均满足 $d \\le 100$。  \n特殊性质 D：保证所有询问均满足 $d \\ge 1000$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2003] 雾雨魔理沙", "background": "**这是一道交互题。**\n\n**在提交本题前请务必仔细阅读以下内容。**\n\n本题只支持 C++ 语言提交（建议使用 C++14，请不要使用 C++14 (GCC9)）。\n\n由于洛谷特殊的交互机制，在提交本题时，请去掉代码中的 ```#include \"count.h\"``` 语句，并将下发文件 **`count_.h`** （注意并不是 `count.zip` 里的 `count.h`）中的内容粘贴到代码最开头，然后提交。\n\n如果您无法打开 `count_.h`，那么可以复制下面的内容。\n\n```cpp\n#ifndef CIRCLE_H\n#define CIRCLE_H\n#include<vector>\nstruct info{\n  unsigned val;\n  unsigned poi[2];\n};\nconst info emptyinfo=info{0,(unsigned)-1,(unsigned)-1};\ninfo MR(info a,info b);\ninfo MC(info a,info b);\nvoid init(int T,int n,int q,std::vector<int>dad,std::vector<info>ve,int M);\nbool isempty(info a);\ninfo ask(int x,int d);\n\n#endif\n```\n\n如果您在提交本题时出现了任何意外的情况，请咨询管理员。", "description": "给出五元组 $(T, I, S_V, S_E, \\iota)$，其中：\n\n- $T$ 是一棵 $n$ 个点的有根树 $T = (V, E)$，其中 $V$ 为 $T$ 的点集，$E$ 为 $T$ 的边集。树的节点被编号为 $1, 2, \\ldots, n$，其中根节点编号为 $1$。\n- $I$ 是一个集合，集合中的元素称作**信息**。其中有两个不同的特殊元素：单位元 $\\epsilon$ 和不合法信息 $\\bot$。\n\n对于一般的信息，其都具有**点集合**和**边集合**两个属性。特别的，对于单位元，其只有边集合的属性，而对于不合法信息，其没有以上两种属性。\n\n- 对于信息 $o \\in I \\setminus \\{ \\epsilon, \\bot \\}$，$o$ 的**点集合**是 $V$ 的一个二元子集，记作 $S_V(o)$，满足 $S_V(o) \\subseteq V$ 且 $\\lvert S_V(o) \\rvert = 2$。其中，两个集合 $A, B$ 的差 $A \\setminus B$ 被定义为 $A \\setminus B = \\{ x \\in A \\hspace{3mu}\\vert\\hspace{3mu} x \\notin B \\}$。\n- 对于信息 $o \\in I \\setminus \\{ \\bot \\}$，$o$ 的**边集合**是 $E$ 的一个子集，记作 $S_E(o)$，满足 $S_E(o) \\subseteq E$。规定单位元的边集合为空，也即 $S_E(\\epsilon) = \\varnothing$。\n- 对于树上的任何一条边 $e \\in E$，记 $e = (u, v)$，存在一个关于 $e$ 的信息 $\\iota(e) \\in I$，它以其端点为点集合、自身为边集合，即 $S_V(\\iota(e)) = \\{ u, v \\}$、$S_E(\\iota(e)) = \\{ e \\}$。\n\n信息有两种合并的方式，分别记作 $R$ 和 $C$。对于 $\\forall a, b \\in I$，记 $r = R(a, b), c = C(a, b)$，满足 $r, c \\in I$，则：\n\n- 单位元和任何信息合并都得到对方。也即，如果 $a = \\epsilon$，那么 $r = c = b$；如果 $b = \\epsilon$，那么 $r = c = a$。\n- 不合法信息和任何信息合并都得到不合法信息。也即，如果 $a = \\bot$ 或者 $b = \\bot$，那么 $r = c = \\bot$。\n- 对于剩下的情况，如果两个信息的**边集合**的交集非空，或者**点集合**的交集的大小不为 $1$，则合并得到不合法信息。也即，如果 $S_E(a) \\cap S_E(b) \\ne \\varnothing$ 或 $\\lvert S_V(a) \\cap S_V(b) \\rvert \\ne 1$，则 $r = c = \\bot$。\n- 否则，有\n  $$ S_E(r) = S_E(c) = S_E(a) \\cup S_E(b) \\text{,} $$\n  $$ S_V(r) = S_V(a) \\text{,} $$\n  $$ S_V(c) = S_V(a) \\oplus S_V(b) \\text{,} $$\n  其中 $\\oplus$ 表示集合的对称差运算，也即 $A \\oplus B = (A \\cup B) \\setminus (A \\cap B)$。\n\n定义 $T$ 中两个点的树上距离为树上以两个点为端点的唯一简单路径经过的边数。\n\n给出评分参数 $M$ 和 $q$ 次询问，每次询问给出树上的一个点 $u$ 和一个非负整数 $d$。记点集 $X$ 为 $T$ 中所有与 $u$ 的树上距离不超过 $d$ 的点构成的集合，又记边集 $Y = \\{ (a, b) \\in E \\hspace{3mu}\\vert\\hspace{3mu} a, b \\in X \\}$ 为 $X$ 内部的边集。可以证明，从 $\\epsilon$ 和所有 $\\iota(e)$（$e \\in E$）出发，总是能通过有限次 $R, C$ 的调用得到信息 $o \\ne \\bot$ 满足 $S_E(o) = Y$。\n\n每组询问中，你需要在 $R$ 和 $C$ 的调用次数总和不超过 $M$ 的限制下构造出一个满足这样的要求的信息 $o$。特别地，如果 $d = 0$，则直接返回单位元 $\\epsilon$ 即可。\n\n----\n\n**【实现细节】**\n\n请确保你的程序开头有 `#include \"count.h\"`。\n\n头文件 `count.h` 中实现了如下内容：\n\n1. 定义了信息对应的数据类型 `info`；\n2. 定义了 $\\epsilon$ 所对应的 `info` 类型常量 `emptyinfo`，你可以在程序中直接使用。\n3. 定义并实现了以下两个信息合并函数，你可以在程序中直接调用：\n   \n   ```cpp\n   info MR(info a,info b);\n   info MC(info a,info b);\n   ```\n   \n   - 两个函数分别返回 $R(a, b)$ 与 $C(a, b)$ 对应的信息。\n   \n   **你需要保证调用 $\\boldsymbol{R(a, b)}$ 与 $\\boldsymbol{C(a, b)}$ 时结果不为 $\\boldsymbol{\\bot}$，否则程序可能会出现异常行为。**\n4. 定义并实现了判定一个信息是否为单位元的函数，你可以在程序中直接调用：\n   ```cpp\n   bool isempty(info a);\n   ```\n   - 这个函数返回真当且仅当 $a$ 为单位元。\n\n可以查看参考交互库了解更多实现细节。\n\n**你不需要，也不应该实现主函数。** 你需要实现如下几个函数：\n\n```cpp\nvoid init(int T, int n, int q, vector<int> fa, vector<info> e, int M);\n```\n\n- `T` 表示测试点编号，`n` 表示树的点数，`q` 表示询问数，`M` 表示该测试点的评分参数。\n- `fa` 和 `e` 的长度均为 $n - 1$。对于 $0 \\le i < n - 1$，$fa[i]$ 和 $i + 2$ 为第 $i$ 条边 $e_i$ 的两个端点，$e[i]$ 为题目描述中提到的 $\\iota(e_i)$ 所对应的 `info` 类型元素。数据保证 $fa[i]$ 小于 $i + 2$。\n\n```cpp\ninfo ask(int u, int d);\n```\n\n给出一个询问，参数的意义见题目描述。你需要在函数结束时返回一个满足题设条件的信息。\n\n最终测试时，在每个测试点，交互库会**恰好**调用一次 `init` 函数，随后调用 $q$ 次 `ask`函数。交互库会使用特殊的实现方式，单个 `info` 类型的变量会恒定消耗 $12$ 字节内存，**这与下发的参考交互库不同**。为保证程序运行时内存使用在题目限制内，你需要保证运行过程中没有过多的 `info` 类型变量同时存在。\n\n保证在满足调用次数限制且不进行 `isempty` 函数调用的情况下，最终测试的交互库运行所需的时间不超过 0.6 秒，交互库本身所消耗的内存不超过 16 MiB。保证在只执行 ${10}^8$ 次 `isempty` 函数调用的情况下，最终测试的交互库运行的时间不超过 0.25 秒。\n\n在下发文件中包含一个名为 `count.cpp` 的文件，作为示例程序，选手可以在此基础上继续实现本题。在下发文件中还额外包含一个名为 `count_backup.h` 的备份文件，我们保证其与 `count.h` 文件完全相同。\n\n----\n\n**【测试程序方式】**\n\n本题目录下提供了两个交互库的参考实现 `grader.o`、`checker.o`，其为两个不同的交互库编译产生的可链接文件。最终测试时所用的交互库实现与该实现有不同，因此选手的解法**不应依赖交互库的具体实现**，同时也不应该依赖 `count.h` 中 `info` 类型的具体实现。\n\n你需要修改下发的 `count.h` 来帮助进行链接。具体的，在将源代码 `count.cpp` 和程序 `grader.o` 进行链接的时候，你需要注释掉 `count.h` 代码的第 5 行，并保留第 4 行的代码。链接 `checker.o` 方法类似，需要注释掉 `count.h` 代码的第 4 行，并保留第 5 行的代码。选手可以对 `count.h` 的实现自行修改来实现不同程序的编译。\n\n修改后，选手可以在本题目录下使用如下命令编译得到可执行程序：\n\n```bash\ng++ count.cpp -c -O2 -std=c++14 -lm && g++ count.o grader.o -o count\ng++ count.cpp -c -O2 -std=c++14 -lm && g++ count.o checker.o -o count\n```\n\n其中第一行命令会编译当前 `count.cpp` 后与 `grader.o` 链接起来，生成可执行文件 `count`，第二行命令则会编译当前 `count.cpp` 后与 `checker.o` 链接起来，生成可执行文件 `count`。\n\n按上述方法编译得到的可执行文件 `count`，其运行方式如下：\n\n- 可执行文件将从标准输入读入以下格式的数据：\n  - 第一行四个整数 $id, n, q, M$，分别表示测试点编号、树的点数、询问数和评分参数；\n  - 第二行 $n - 1$ 个整数 $p_2, p_3, \\ldots, p_n$，分别表示 $2$ 至 $n$ 的父亲节点编号，在本地调试时你需要保证 $\\forall i \\in [2, n]$，$p_i < i$；\n  - 接下来 $q$ 行每行两个整数 $u, d$，描述一次询问。\n- 读入之后，交互库会进行测试。如果你的程序不满足交互库限制，其会在输出中返回对应的错误信息。否则，对于链接的可执行文件，其输出如下：\n  - 总共一行三个整数 $C_1, C_2, C_3$，其中：\n    - $C_1$ 表示程序在 `init` 函数中调用交互库函数的总次数；\n    - $C_2$ 表示程序在运行过程中调用交互库函数的总次数；\n    - $C_3$ 表示程序在 $q$ 次 `ask` 函数中调用交互库函数的次数的最大值。\n    - 对于上述三个统计量，我们只会计入 `MR`、`MC` 函数的调用次数，而不会计入 `isempty` 函数的调用次数。\n- 在链接不同文件的时候，其能够进行的检查也不同，具体地：\n  - `grader.o`：其在运行时不会检查 `ask` 函数返回的信息是否正确，但可以帮助选手判断交互操作是否符合要求。这份程序运行时间最接近评测时的交互库，因此选手可以利用该程序测试运行速度，但不保证程序正确性。\n  - `checker.o`：其在运行时会检查 `ask` 函数返回的信息是否正确，也可以帮助选手判断交互操作是否符合要求。同时其会检查 `ask` 函数返回的信息是否正确。这份程序可以进行答案正确性的检查。\n\n选手在调试时需要保证输入可执行文件 `count` 的数据满足上述输入格式，否则不保证输出结果正确。\n", "inputFormat": "见【测试程序方式】。", "outputFormat": "见【测试程序方式】。", "hint": "Idea：zx2003，Solution：zx2003，Code：zx2003，Data：zx2003\n\n**【评分方式】**\n\n最终评测**只会**收取 `count.cpp`，修改选手目录下其他文件不会对评测结果产生影响。**注意：**\n\n- **未初始化的 `info` 类型的变量不保证是 `emptyinfo`。**\n- **请不要尝试访问或修改 `info` 类型的成员变量，否则将被视为攻击交互库。**\n- **请不要在 `init` 函数调用之前调用 `MR` 和 `MC` 函数，否则可能会发生未定义行为。**\n- **你只能访问自己定义的变量和交互库返回的 `info` 类型变量，尝试访问其他空间将可能导致编译错误或运行时错误。**\n\n**本题首先会受到和传统题相同的限制**，例如编译错误会导致整道题目得 0 分，运行时错误、超过时间限制、超过空间限制等会导致相应测试点得 0 分等。\n\n在上述条件以外，在一个测试点中，若程序执行了非法的函数调用或询问操作中给出了错误回答，该测试点将会获得 0 分。否则，记 $C_1, C_3$ 分别表示你的程序在 `init` 函数中调用交互库函数的次数，和你的程序在所有 $q$ 次 `ask` 函数中调用交互库函数的次数的最大值。如果 $C_1 \\le 3 \\cdot {10}^7$ 且 $C_3$ 不超过该测试点的评分参数 $M$，你将获得该测试点的分数，否则你无法获得该测试点的分数。注意：计算 $C_1, C_3$ 时只会计入 `MR`、`MC` 函数的调用次数，而不会计入 `isempty` 函数的调用次数。\n\n----\n\n**【样例 \\#1】**\n\n见附件中的 `count/count1.in` 与 `count/count1.ans`。\n\n----\n\n**【样例 \\#2】**\n\n见附件中的 `count/count2.in` 与 `count/count2.ans`。\n\n该组样例满足数据范围中的特殊性质 A。\n\n----\n\n**【样例 \\#3】**\n\n见附件中的 `count/count3.in` 与 `count/count3.ans`。\n\n该组样例满足数据范围中的特殊性质 B。\n\n----\n\n**【样例 \\#4】**\n\n见附件中的 `count/count4.in` 与 `count/count4.ans`。\n\n----\n\n**【数据范围】**\n\n对于所有测试点，$1 \\le n \\le 2 \\times {10}^5$，$1 \\le q \\le {10}^6$；每组询问中，有 $1 \\le u \\le n$，$1 \\le d \\le n - 1$。\n\n| 测试点   | $n=$              | $q=$            | 特殊性质 | $M=$  |\n|:-----:|:-----------------:|:---------------:|:----:|:-----:|\n| $1$   | $1000$            | $10^4$          |      | $500$ |\n| $2$   | $2000$            | $10^4$          |      | $500$ |\n| $3,4$ | $10^5$            | $10^6$          | A    | $5$   |\n| $5,6$ | $6 \\times 10^4$   | $6\\times 10^4$  | B    | $50$  |\n| $7$   | $6 \\times 10^4$   | $6 \\times 10^4$ | B    | $5$   |\n| $8$   | $10^5$            | $10^5$          | B    | $5$   |\n| $9$   | $7500$            | $5 \\times 10^4$ | C    | $500$ |\n| $10$  | $10^4$            | $5 \\times 10^4$ |      | $500$ |\n| $11$  | $1.5 \\times 10^4$ | $5 \\times 10^4$ |      | $500$ |\n| $12$  | $2 \\times 10^4$   | $5 \\times 10^4$ |      | $50$  |\n| $13$  | $2.5 \\times 10^4$ | $5 \\times 10^4$ |      | $5$   |\n| $14$  | $3 \\times 10^4$   | $10^5$          |      | $5$   |\n| $15$  | $6 \\times 10^4$   | $10^6$          | D    | $5$   |\n| $16$  | $6 \\times 10^4$   | $10^6$          |      | $5$   |\n| $17$  | $8 \\times 10^4$   | $10^6$          |      | $5$   |\n| $18$  | $10^5$            | $10^6$          |      | $5$   |\n| $19$  | $1.5 \\times 10^5$ | $10^6$          |      | $5$   |\n| $20$  | $2 \\times 10^5$   | $10^6$          |      | $1$   |\n\n\n特殊性质 A：保证 $\\forall i \\in [1, n - 1]$，编号为 $i + 1$ 的点的父节点为 $i$。  \n特殊性质 B：保证所有询问均满足 $u = 1$。  \n特殊性质 C：保证所有询问均满足 $d \\le 100$。  \n特殊性质 D：保证所有询问均满足 $d \\ge 1000$。", "locale": "zh-CN"}}}
{"pid": "P8534", "type": "P", "difficulty": 1, "samples": [["5\n1 0\n1 314159265\n6 100\n3 20000001\n5 1", "2\n6\n4\n5\n4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["模拟", "洛谷原创", "O2优化", "洛谷月赛"], "title": "「Wdoi-2」比赤色更红的梦", "background": "这里是东之国的远离人类村落的山中。博丽神社，就存在于那样的边境。\n\n这座山，原本就没有人住，现在也是大部分人决不会踏足的地方。这里被人们称作幻想乡。\n\n-----\n\n一座洋馆，两次异变，揭开了幻想乡符卡战斗的序幕。\n\n这是 118 季的夏天，从红色的西洋馆中，无数的红雾从中喷发而出，幻想乡的天染成了绯红色。博丽的巫女博丽灵梦与西洋的魔法使雾雨魔理沙察觉这片妖雾后匆忙出发。迎接她们的，是第一次在符卡规则下的异变。伴随着巨大的阴阳玉从空中砸下，摧毁了整座红魔馆，红雾异变宣告收尾，这是昔日的二色莲花蝶与黑白魔法使的表演。\n\n但是这次，失去记忆的主角二人，遗忘了中途的种种事件，无论是那威严满满的吸血鬼，还是大图书馆中的那一串魔法阵。她们只知道，这是一次异变，急需她们解决。但是由于第一次异变的神秘性以及特殊性，她们希望你能告诉她们一共有多少个残机可以供她们挥霍。", "description": "《东方红魔乡》的游戏剧情共有六关，分别称为 $\\text{Stage 1}\\sim \\text{Stage 6}$。\n\n当分数达到（即大于等于）$1000$ 万，$2000$ 万，$4000$ 万，$6000$ 万，会分别地奖励主角一个残机（即一条命）。此外，在 $\\text{Stage 3}$ 和 $\\text{Stage 5}$ 的中途，会奖励主角一个残机。主角**一开始**有 $2$ 个残机。\n\n尽管灵梦和魔理沙二人失去了记忆，但是躲避弹幕的本能是不会被遗忘的，也就是说她们在游戏过程中不会消耗任何一个残机。现在主角**刚刚通关**了 $\\text{Stage }x$，主角的分数是 $s$，请问主角现在有多少个残机？", "inputFormat": "**本题含有多组数据。**\n\n- 第一行输入一个整数 $T$，表示数据组数。\n- 对于每组数据，输入一行两个整数 $x$ 和 $s$。", "outputFormat": "- 对于每组数据，输出一行一个整数，表示主角现在拥有的残机数量。", "hint": "### 样例解释\n\n- 对于第 $1$ 组数据，主角只通过了第一关，且得分零分。故只有初始时的两个残机。\n- 对于第 $2$ 组数据，主角通过了第一关，并且得到了非常多的分数，这足以让主角获得所有分数相关的残机奖励。答案为 $2$（初始时的残机）$+4$（得分奖励）$=6$ 个残机。\n- 对于第 $3$ 组数据，主角把游戏通关了，但是分数非常少。主角获得了初始的两个残机、$\\text{Stage 3}$ 中途的奖励残机和 $\\text{Stage 5}$ 中途的奖励残机共 $4$ 个。\n\n### 数据范围\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{x\\le} & \\bm{s\\le} & \\bm{T\\le} & \\textbf{分值}\\\\\\hline\n1 & 1 & 0 & 1 & 5\\\\\\hline\n2 & 6 & 0 & 100 & 10 \\\\\\hline\n3 & 6 & 10^9 & 10^4 & 10 \\\\\\hline\n4 & 6 & 10^{18} & 10^4 & 75 \\\\\\hline\n\\end{array}$$\n\n对于全部数据，满足 $1 \\le T \\le 10^4$，$1 \\le x \\le6$，$0 \\le s \\le 10^{18}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdoi-2」比赤色更红的梦", "background": "这里是东之国的远离人类村落的山中。博丽神社，就存在于那样的边境。\n\n这座山，原本就没有人住，现在也是大部分人决不会踏足的地方。这里被人们称作幻想乡。\n\n-----\n\n一座洋馆，两次异变，揭开了幻想乡符卡战斗的序幕。\n\n这是 118 季的夏天，从红色的西洋馆中，无数的红雾从中喷发而出，幻想乡的天染成了绯红色。博丽的巫女博丽灵梦与西洋的魔法使雾雨魔理沙察觉这片妖雾后匆忙出发。迎接她们的，是第一次在符卡规则下的异变。伴随着巨大的阴阳玉从空中砸下，摧毁了整座红魔馆，红雾异变宣告收尾，这是昔日的二色莲花蝶与黑白魔法使的表演。\n\n但是这次，失去记忆的主角二人，遗忘了中途的种种事件，无论是那威严满满的吸血鬼，还是大图书馆中的那一串魔法阵。她们只知道，这是一次异变，急需她们解决。但是由于第一次异变的神秘性以及特殊性，她们希望你能告诉她们一共有多少个残机可以供她们挥霍。", "description": "《东方红魔乡》的游戏剧情共有六关，分别称为 $\\text{Stage 1}\\sim \\text{Stage 6}$。\n\n当分数达到（即大于等于）$1000$ 万，$2000$ 万，$4000$ 万，$6000$ 万，会分别地奖励主角一个残机（即一条命）。此外，在 $\\text{Stage 3}$ 和 $\\text{Stage 5}$ 的中途，会奖励主角一个残机。主角**一开始**有 $2$ 个残机。\n\n尽管灵梦和魔理沙二人失去了记忆，但是躲避弹幕的本能是不会被遗忘的，也就是说她们在游戏过程中不会消耗任何一个残机。现在主角**刚刚通关**了 $\\text{Stage }x$，主角的分数是 $s$，请问主角现在有多少个残机？", "inputFormat": "**本题含有多组数据。**\n\n- 第一行输入一个整数 $T$，表示数据组数。\n- 对于每组数据，输入一行两个整数 $x$ 和 $s$。", "outputFormat": "- 对于每组数据，输出一行一个整数，表示主角现在拥有的残机数量。", "hint": "### 样例解释\n\n- 对于第 $1$ 组数据，主角只通过了第一关，且得分零分。故只有初始时的两个残机。\n- 对于第 $2$ 组数据，主角通过了第一关，并且得到了非常多的分数，这足以让主角获得所有分数相关的残机奖励。答案为 $2$（初始时的残机）$+4$（得分奖励）$=6$ 个残机。\n- 对于第 $3$ 组数据，主角把游戏通关了，但是分数非常少。主角获得了初始的两个残机、$\\text{Stage 3}$ 中途的奖励残机和 $\\text{Stage 5}$ 中途的奖励残机共 $4$ 个。\n\n### 数据范围\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{x\\le} & \\bm{s\\le} & \\bm{T\\le} & \\textbf{分值}\\\\\\hline\n1 & 1 & 0 & 1 & 5\\\\\\hline\n2 & 6 & 0 & 100 & 10 \\\\\\hline\n3 & 6 & 10^9 & 10^4 & 10 \\\\\\hline\n4 & 6 & 10^{18} & 10^4 & 75 \\\\\\hline\n\\end{array}$$\n\n对于全部数据，满足 $1 \\le T \\le 10^4$，$1 \\le x \\le6$，$0 \\le s \\le 10^{18}$。", "locale": "zh-CN"}}}
{"pid": "P8535", "type": "P", "difficulty": 2, "samples": [["5", "1"], ["13", "21"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["贪心", "洛谷原创", "O2优化", "洛谷月赛"], "title": "「Wdoi-2」森罗结界", "background": "119 季 5 月，明明本应是樱花盛开的春天，幻想乡却依然下着大雪。异变的主谋西行寺幽幽子在古书上看到，只要使妖樱西行妖满开便会有什么人复活，便出于兴趣命令妖梦收集幻想乡中的春度，一手策划成了这场异变。在收集春度的过程中散落的能量在西行妖的影响下化为樱点，散落在幻想乡各处。这一异变被称之为“春雪异变”。\n\n出发前往解决异变的三位主角——博丽灵梦、雾雨魔理沙、十六夜咲夜怀着不同的目的，踏上了寻找异变主谋的征途。在这一过程中，她们发现了一个叫做“森罗结界”的东西。收集齐一定程度的樱点，就会立即开出森罗结界。开出森罗结界后可以短暂地屏蔽一切攻击，并且获得相应的增益。\n\n然而，也许是因为世界秩序的 bug，如果森罗结界开得过多，数值显示将会产生问题，原本应该是一个数值的森罗结界信息会被汉字所替代。为了解决这些怪问题，她们找到了你，希望你能帮她们解决这个问题。", "description": "### 简要题意\n\n给定汉字的字符画，输入你能使用的 $\\texttt{*}$ 的个数，要求输出一个**最大**的汉字数字（**可以不全部用完**），不考虑“千”、“百”等数量单位。\n\n### 原始题意\n\n森罗结界的信息显示系统可以看作一个宽度为 $7$，长度为无限大的矩形系统，在上面仅仅有两个字符 $\\texttt{.}$ 与 $\\texttt{*}$。\n\n由于主角组失去了记忆，她们在解决异变的时候开了过多的森罗结界，使得原本应该显示数字的位置变成了汉字。在信息显示系统中，每个汉字（仅包含零、一、二到九）都以点阵字体的形式呈现。\n\n显然，阅读汉字比阅读单纯的数字困难了许多。不过，信息显示系统告诉了主角们在显示系统上有 $n$ 个 $\\texttt{*}$。主角们希望能够知道运用**不超过** $n$ 个 $\\texttt{*}$ 的情况下，显示系统上能表示的最大数字是多少，来帮助她们解决异变。\n\n为了评测和阅读的方便，您只需输出对应的整数即可。\n\n---\n\n如下分别给出了字符画的图片形式，以及文本形式。同时在下发文件里我们准备了每个数字对应的字符画的文本形式。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ocrxxti4.png)\n\n```plain\n.......  .......  .......  *******  .......  .......  .......  .......  ..*....  *******\n.......  .......  ..***..  *.*.*.*  *******  ...*...  ...*...  ..*.*..  ..*....  *.....*\n.......  ..***..  .......  *.*.*.*  ...*...  ...*...  ...*...  ..*.*..  *****..  *.....*\n.*****.  .......  .*****.  **...**  .******  .*****.  *******  ..*.*..  ..*.*..  *.....*\n.......  .......  .......  *.....*  ...*..*  ..*.*..  ...*...  .*...*.  ..*.*..  *.....*\n.......  .*****.  *******  *.....*  *******  .*...*.  ...*..*  *.....*  .*..*.*  *.....*\n.......  .......  .......  *******  .......  .......  ...****  .......  *...***  *******\n```", "inputFormat": "输入一个正整数 $n$，表示主角组拥有的 $\\texttt{*}$ 个数。", "outputFormat": "输出一个整数，表示最大能够拼出的数字。由于汉字不便输出，您只需输出汉字对应的整数。", "hint": "### 样例解释\n\n对于样例 $1$，显然只能拼出数字一，故输出 $1$ 即可。\n\n对于样例 $2$，可以拼出很多的数字如“一二”、“六”等，但是在这些数字中最大的数字是 $21$，且显然可以发现不存在更大的数字是可以被拼出的了。\n\n### 数据范围\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le} & \\textbf{分值}\\\\\\hline\n1 & 10 & 5\\\\\\hline\n2 & 100 & 15 \\\\\\hline\n3 & 10^3 & 20 \\\\\\hline\n4 & 10^6 & 60 \\\\\\hline\n\\end{array}$$\n\n对于全部数据，保证 $5 \\leq n \\leq 10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdoi-2」森罗结界", "background": "119 季 5 月，明明本应是樱花盛开的春天，幻想乡却依然下着大雪。异变的主谋西行寺幽幽子在古书上看到，只要使妖樱西行妖满开便会有什么人复活，便出于兴趣命令妖梦收集幻想乡中的春度，一手策划成了这场异变。在收集春度的过程中散落的能量在西行妖的影响下化为樱点，散落在幻想乡各处。这一异变被称之为“春雪异变”。\n\n出发前往解决异变的三位主角——博丽灵梦、雾雨魔理沙、十六夜咲夜怀着不同的目的，踏上了寻找异变主谋的征途。在这一过程中，她们发现了一个叫做“森罗结界”的东西。收集齐一定程度的樱点，就会立即开出森罗结界。开出森罗结界后可以短暂地屏蔽一切攻击，并且获得相应的增益。\n\n然而，也许是因为世界秩序的 bug，如果森罗结界开得过多，数值显示将会产生问题，原本应该是一个数值的森罗结界信息会被汉字所替代。为了解决这些怪问题，她们找到了你，希望你能帮她们解决这个问题。", "description": "### 简要题意\n\n给定汉字的字符画，输入你能使用的 $\\texttt{*}$ 的个数，要求输出一个**最大**的汉字数字（**可以不全部用完**），不考虑“千”、“百”等数量单位。\n\n### 原始题意\n\n森罗结界的信息显示系统可以看作一个宽度为 $7$，长度为无限大的矩形系统，在上面仅仅有两个字符 $\\texttt{.}$ 与 $\\texttt{*}$。\n\n由于主角组失去了记忆，她们在解决异变的时候开了过多的森罗结界，使得原本应该显示数字的位置变成了汉字。在信息显示系统中，每个汉字（仅包含零、一、二到九）都以点阵字体的形式呈现。\n\n显然，阅读汉字比阅读单纯的数字困难了许多。不过，信息显示系统告诉了主角们在显示系统上有 $n$ 个 $\\texttt{*}$。主角们希望能够知道运用**不超过** $n$ 个 $\\texttt{*}$ 的情况下，显示系统上能表示的最大数字是多少，来帮助她们解决异变。\n\n为了评测和阅读的方便，您只需输出对应的整数即可。\n\n---\n\n如下分别给出了字符画的图片形式，以及文本形式。同时在下发文件里我们准备了每个数字对应的字符画的文本形式。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ocrxxti4.png)\n\n```plain\n.......  .......  .......  *******  .......  .......  .......  .......  ..*....  *******\n.......  .......  ..***..  *.*.*.*  *******  ...*...  ...*...  ..*.*..  ..*....  *.....*\n.......  ..***..  .......  *.*.*.*  ...*...  ...*...  ...*...  ..*.*..  *****..  *.....*\n.*****.  .......  .*****.  **...**  .******  .*****.  *******  ..*.*..  ..*.*..  *.....*\n.......  .......  .......  *.....*  ...*..*  ..*.*..  ...*...  .*...*.  ..*.*..  *.....*\n.......  .*****.  *******  *.....*  *******  .*...*.  ...*..*  *.....*  .*..*.*  *.....*\n.......  .......  .......  *******  .......  .......  ...****  .......  *...***  *******\n```", "inputFormat": "输入一个正整数 $n$，表示主角组拥有的 $\\texttt{*}$ 个数。", "outputFormat": "输出一个整数，表示最大能够拼出的数字。由于汉字不便输出，您只需输出汉字对应的整数。", "hint": "### 样例解释\n\n对于样例 $1$，显然只能拼出数字一，故输出 $1$ 即可。\n\n对于样例 $2$，可以拼出很多的数字如“一二”、“六”等，但是在这些数字中最大的数字是 $21$，且显然可以发现不存在更大的数字是可以被拼出的了。\n\n### 数据范围\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le} & \\textbf{分值}\\\\\\hline\n1 & 10 & 5\\\\\\hline\n2 & 100 & 15 \\\\\\hline\n3 & 10^3 & 20 \\\\\\hline\n4 & 10^6 & 60 \\\\\\hline\n\\end{array}$$\n\n对于全部数据，保证 $5 \\leq n \\leq 10^6$。", "locale": "zh-CN"}}}
{"pid": "P8536", "type": "P", "difficulty": 2, "samples": [["3\n3\n111\n3\n101\n4\n0101", "1 2 3\n2 1 3\n1 3 2 4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["洛谷原创", "Special Judge", "O2优化", "构造", "洛谷月赛"], "title": "「Wdoi-2」幻胧月睨", "background": "**Problem Number:** $\\textit{39}$\n\n**背景与题目无关，选手可以直接看下面的「简要题意」。**\n\n那是在竹取物语之后的故事了，幻想乡距离与现实隔绝也已经过去了百年时光。\n\n地上人向月球发起了侵略战争之后，一只名叫**铃仙**的月兔舍弃了同伴，死里逃生，逃到了在幻想乡内的永远亭，来到了辉夜与永琳的身边，生活得安稳而舒适。\n\n又过了数十年，铃仙接收到了来自月球的使唤，被要求强制返回月球。辉夜与永琳商量了下，决定不将铃仙交还予月球。但为了避免造成麻烦，辉夜与永琳决定将满月消失在地上，只留下一轮虚假的月亮。\n\n-----\n\n为了方便调查异变，八云紫运用自己的能力，将整个幻想乡变成了永夜。\n\n被穿梭回异变发生当时的四组主角，共八人。除了依然留有记忆，可以来回穿梭在虚与实的境界的八云紫之外，其他的人缺乏了记忆，重新开始踏上夺回幻想乡的满月的征途。\n\n在慧音的指引之下，她们来到了迷途竹林，在她们的面前，是一只名叫铃仙的月兔。", "description": "### 简要题意\n\n给定一个长度为 $n$ 的 01 串 $b$，要求构造一个 $n$ 阶排列 $a$，满足，对于 $a_i(2\\le i\\le n)$，记 $m_i=\\max_{j=1}^{i-1}\\{a_j\\}$，则：\n  - 若 $b_i=1$，则 $a_i>m_i$;\n  - 否则 $a_i<m_i$。\n\n可以证明，总存在一个数列 $a$ 满足以上条件。\n\n**如果有多组解，输出任意一种。**\n\n同时注意到 $b_1$ 的取值是任意的，对数列 $a$ 没有影响。\n\n### 原始题意\n\n铃仙拥有操纵狂气程度的能力，换而言之，就是操纵物体的波长、振幅以及相位。这种能力为主角制造了种种障碍——例如操纵光波，会让弹幕虚虚实实，甚至会出现虚假的自我，对躲避弹幕造成极大的干扰。\n\n以符卡「幻胧月睨」为例。「幻胧月睨」中一共有 $n$ 个弹幕，每个弹幕都会有一个相位，相位非 $0$ 即 $1$。这些弹幕的相位会构成一个长度为 $n$ 的数列 $\\{b_i\\}$。\n\n铃仙会操纵这些弹幕的相位，将其变得千奇百怪。具体而言，被操纵了之后的弹幕的相位是一个长度为 $n$ 的**排列** $\\{a_i\\}$，即 $1 \\sim n$ 的数字都会**不重不漏**地出现在这个序列之中。\n\n为了加大主角躲避弹幕的难度，铃仙会设置一个阈值。对于每一个元素 $a_i$，阈值是其**前缀**的**最大**值，即 $a_1,a_2,\\dots,a_{i-1}$ 中的最大值。若原来的第 $i$ 个弹幕的相位为 $1$，则被操纵后的弹幕的相位要**大于**这个阈值，否则被操纵后的弹幕的相位要**小于**这个阈值。\n\n显然的是，根据铃仙的操纵规则，无论原本的弹幕的相位如何，都是存在可能的操纵方案的。由于主角们失去了记忆，而找回月亮的时间已经所剩不多了，而且弹幕战对时间的把控要求极高。她们找到了你，希望你能够对铃仙原本的弹幕相位，给出**任意一种**操作后的弹幕相位，来为她们的闪避弹幕进行准备。", "inputFormat": "**本题有多组数据。**\n\n第一行一个整数 $T$，表示数据组数。\n\n对于每组数据：\n\n- 第一行一个整数 $n$，意义如题述。\n- 第二行一个长度为 $n$ 的 01 串 $b$。", "outputFormat": "对于每组数据，输出一行 $n$ 个整数，即你构造的数列 $a$。\n\n**如果有多组解，输出任意一种。**", "hint": "### 样例解释\n\n- 对于数据 $1$，显然 $a_2>1,a_3>2$。\n- 对于数据 $2$，显然 $a_2<2,a_3>2$。\n- 对于数据 $3$，显然 $a_2>1,a_3<3,a_4>3$。\\\n  注意到 $a=\\{2,3,1,4\\}$ 同样满足要求。\n\n### 数据范围\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le} & \\textbf{特殊性质} & \\textbf{Subtask 依赖} & \\textbf{分值}\\\\\\hline\n1 & 10 & - & - & 5\\\\\\hline\n2 & 10^5 & \\textbf{A} & - & 5 \\\\\\hline\n3 & 10^5 & \\textbf{B} & - & 20 \\\\\\hline\n4 & 10^5 & - & 1,2,3 &70 \\\\\\hline\n\\end{array}$$\n\n- **特殊性质** $\\textbf{A}$：保证 $b_i$ 都相等。\n- **特殊性质** $\\textbf{B}$：存在整数 $p\\in[2,n]$，使得对于 $1\\le i<p$，有 $b_i=1$；对于 $n\\ge i\\ge p$，有 $b_i=0$。\n\n对于全部数据，满足 $1\\le T\\le 10^4$，$1\\le n\\le 10^5$，$\\forall i\\in[1,n],b_i\\in\\{0,1\\}$。\n\n保证单个测试点内 $\\sum n\\le 5\\times 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdoi-2」幻胧月睨", "background": "**Problem Number:** $\\textit{39}$\n\n**背景与题目无关，选手可以直接看下面的「简要题意」。**\n\n那是在竹取物语之后的故事了，幻想乡距离与现实隔绝也已经过去了百年时光。\n\n地上人向月球发起了侵略战争之后，一只名叫**铃仙**的月兔舍弃了同伴，死里逃生，逃到了在幻想乡内的永远亭，来到了辉夜与永琳的身边，生活得安稳而舒适。\n\n又过了数十年，铃仙接收到了来自月球的使唤，被要求强制返回月球。辉夜与永琳商量了下，决定不将铃仙交还予月球。但为了避免造成麻烦，辉夜与永琳决定将满月消失在地上，只留下一轮虚假的月亮。\n\n-----\n\n为了方便调查异变，八云紫运用自己的能力，将整个幻想乡变成了永夜。\n\n被穿梭回异变发生当时的四组主角，共八人。除了依然留有记忆，可以来回穿梭在虚与实的境界的八云紫之外，其他的人缺乏了记忆，重新开始踏上夺回幻想乡的满月的征途。\n\n在慧音的指引之下，她们来到了迷途竹林，在她们的面前，是一只名叫铃仙的月兔。", "description": "### 简要题意\n\n给定一个长度为 $n$ 的 01 串 $b$，要求构造一个 $n$ 阶排列 $a$，满足，对于 $a_i(2\\le i\\le n)$，记 $m_i=\\max_{j=1}^{i-1}\\{a_j\\}$，则：\n  - 若 $b_i=1$，则 $a_i>m_i$;\n  - 否则 $a_i<m_i$。\n\n可以证明，总存在一个数列 $a$ 满足以上条件。\n\n**如果有多组解，输出任意一种。**\n\n同时注意到 $b_1$ 的取值是任意的，对数列 $a$ 没有影响。\n\n### 原始题意\n\n铃仙拥有操纵狂气程度的能力，换而言之，就是操纵物体的波长、振幅以及相位。这种能力为主角制造了种种障碍——例如操纵光波，会让弹幕虚虚实实，甚至会出现虚假的自我，对躲避弹幕造成极大的干扰。\n\n以符卡「幻胧月睨」为例。「幻胧月睨」中一共有 $n$ 个弹幕，每个弹幕都会有一个相位，相位非 $0$ 即 $1$。这些弹幕的相位会构成一个长度为 $n$ 的数列 $\\{b_i\\}$。\n\n铃仙会操纵这些弹幕的相位，将其变得千奇百怪。具体而言，被操纵了之后的弹幕的相位是一个长度为 $n$ 的**排列** $\\{a_i\\}$，即 $1 \\sim n$ 的数字都会**不重不漏**地出现在这个序列之中。\n\n为了加大主角躲避弹幕的难度，铃仙会设置一个阈值。对于每一个元素 $a_i$，阈值是其**前缀**的**最大**值，即 $a_1,a_2,\\dots,a_{i-1}$ 中的最大值。若原来的第 $i$ 个弹幕的相位为 $1$，则被操纵后的弹幕的相位要**大于**这个阈值，否则被操纵后的弹幕的相位要**小于**这个阈值。\n\n显然的是，根据铃仙的操纵规则，无论原本的弹幕的相位如何，都是存在可能的操纵方案的。由于主角们失去了记忆，而找回月亮的时间已经所剩不多了，而且弹幕战对时间的把控要求极高。她们找到了你，希望你能够对铃仙原本的弹幕相位，给出**任意一种**操作后的弹幕相位，来为她们的闪避弹幕进行准备。", "inputFormat": "**本题有多组数据。**\n\n第一行一个整数 $T$，表示数据组数。\n\n对于每组数据：\n\n- 第一行一个整数 $n$，意义如题述。\n- 第二行一个长度为 $n$ 的 01 串 $b$。", "outputFormat": "对于每组数据，输出一行 $n$ 个整数，即你构造的数列 $a$。\n\n**如果有多组解，输出任意一种。**", "hint": "### 样例解释\n\n- 对于数据 $1$，显然 $a_2>1,a_3>2$。\n- 对于数据 $2$，显然 $a_2<2,a_3>2$。\n- 对于数据 $3$，显然 $a_2>1,a_3<3,a_4>3$。\\\n  注意到 $a=\\{2,3,1,4\\}$ 同样满足要求。\n\n### 数据范围\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le} & \\textbf{特殊性质} & \\textbf{Subtask 依赖} & \\textbf{分值}\\\\\\hline\n1 & 10 & - & - & 5\\\\\\hline\n2 & 10^5 & \\textbf{A} & - & 5 \\\\\\hline\n3 & 10^5 & \\textbf{B} & - & 20 \\\\\\hline\n4 & 10^5 & - & 1,2,3 &70 \\\\\\hline\n\\end{array}$$\n\n- **特殊性质** $\\textbf{A}$：保证 $b_i$ 都相等。\n- **特殊性质** $\\textbf{B}$：存在整数 $p\\in[2,n]$，使得对于 $1\\le i<p$，有 $b_i=1$；对于 $n\\ge i\\ge p$，有 $b_i=0$。\n\n对于全部数据，满足 $1\\le T\\le 10^4$，$1\\le n\\le 10^5$，$\\forall i\\in[1,n],b_i\\in\\{0,1\\}$。\n\n保证单个测试点内 $\\sum n\\le 5\\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P8537", "type": "P", "difficulty": 2, "samples": [["3\n1 2 3\n3 2 1", "1"], ["2\n3 1\n1 2", "2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["贪心", "洛谷原创", "O2优化", "洛谷月赛"], "title": "「Wdoi-2」花如幻想一般", "background": "冬的白色被春日的阳光所点缀，幻想乡完全取回了生机的颜色。但，樱花，向日葵，野菊花，桔梗……明明还是春天，全年的花却全都盛开了。\n\n六十年前（注：现实中的 1945 年）的大战，炮火声中、枪林弹雨中，无数的无辜的亡魂，在六十年后纷纷落于幻想之中，寄托于每一朵花上。\n\n每一朵花寄托着每一朵亡魂的灵魂本质。向日葵寄宿着开朗的人的灵魂。彼岸花寄宿了没有朋友的寂寞灵魂，紫色的樱树下满是持有罪恶的幽灵。由于是从有德的幽灵开始按顺序送往彼岸，留到最后的都将是樱花。\n\n外面的人类所看到的虚幻的彼岸，正回归于幻想的此岸。", "description": "### 简要题意\n\n有一个长度为 $n$ 的序列 $a$。可以进行两种操作：\n- 将整个序列翻转；\n- 将序列中的某个数加上某个**整数**。\n\n问：至少要用多少次操作可以将序列 $a$ 转化为序列 $b$。\n\n### 原始题意\n\n参与解决花之异变的十余位主角都并未年满 60 岁，并没有经历过上一次的花之异变。在万花丛中解决异变的紧迫性逐渐被消弭，取而代之的是用花朵来进行游戏。\n\n灵梦将 $n$ 个花朵排成了一排，第 $i$ 朵花都有其对应的美丽程度 $a_i$。而一旁的魔理沙作为一位魔法使，拥有两种能力。她可以进行若干次操作，每次操作可以**使得这 $\\bm n$ 朵花的位置完全翻转**，或者可以**将某一朵花的美丽程度加上或减去一个整数**。\n\n灵梦认为，如果能用魔理沙的操作，使得最后花朵的美丽程度可以变成序列 $b_i$，那么将会是很好的。为了解决异变顺利，魔理沙希望自己的操作次数尽可能少。那么请问魔理沙为了满足灵梦的愿望至少需要操作几次？\n\n---\n\n幻想乡的花儿渐落，新绿开始步向美丽的季节。经过六十年还不会被遗忘的记忆，可能是没有的吧。", "inputFormat": "- 第一行一个整数 $n$。  \n- 第二行 $n$ 个整数 $a_1,a_2,\\cdots,a_n$。\n- 第三行 $n$ 个整数 $b_1,b_2,\\cdots,b_n$。", "outputFormat": "- 输出一行一个整数，代表至少需要几次操作。", "hint": "### 样例解释 \\#1\n\n$$\n\\begin{array}{cccl}\n\\color{red}1&\\color{red}2&\\color{red}3&\\downarrow\\text{reverse}\\\\\n3&2&1&\n\\end{array}\n$$\n\n### 样例解释 \\#2\n\n$$\n\\begin{array}{ccl}\n\\color{red}3&\\color{red}1&\\downarrow\\text{reverse}\\\\\n1&\\color{red}3&\\downarrow\\text{add }-1\\\\\n1&2&\n\\end{array}\n$$\n\n### 数据范围\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le} & \\textbf{特殊性质} & \\textbf{分值}\\\\\\hline\n1 & 10 & - & 10\\\\\\hline\n2 & 10^3 & - & 30\\\\\\hline\n3 & 5\\times 10^5 & \\text{A} & 5 \\\\\\hline\n4 & 5\\times 10^5 & - & 55 \\\\\\hline\n\\end{array}$$\n\n- 特殊性质 $\\textbf{A}$：保证存在一种花费最小的方案，不需要执行第二种操作。\n\n对于全部数据，满足 $1 \\leq n \\leq 5\\times10^5$，\n$1 \\leq a_i,b_i \\leq 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdoi-2」花如幻想一般", "background": "冬的白色被春日的阳光所点缀，幻想乡完全取回了生机的颜色。但，樱花，向日葵，野菊花，桔梗……明明还是春天，全年的花却全都盛开了。\n\n六十年前（注：现实中的 1945 年）的大战，炮火声中、枪林弹雨中，无数的无辜的亡魂，在六十年后纷纷落于幻想之中，寄托于每一朵花上。\n\n每一朵花寄托着每一朵亡魂的灵魂本质。向日葵寄宿着开朗的人的灵魂。彼岸花寄宿了没有朋友的寂寞灵魂，紫色的樱树下满是持有罪恶的幽灵。由于是从有德的幽灵开始按顺序送往彼岸，留到最后的都将是樱花。\n\n外面的人类所看到的虚幻的彼岸，正回归于幻想的此岸。", "description": "### 简要题意\n\n有一个长度为 $n$ 的序列 $a$。可以进行两种操作：\n- 将整个序列翻转；\n- 将序列中的某个数加上某个**整数**。\n\n问：至少要用多少次操作可以将序列 $a$ 转化为序列 $b$。\n\n### 原始题意\n\n参与解决花之异变的十余位主角都并未年满 60 岁，并没有经历过上一次的花之异变。在万花丛中解决异变的紧迫性逐渐被消弭，取而代之的是用花朵来进行游戏。\n\n灵梦将 $n$ 个花朵排成了一排，第 $i$ 朵花都有其对应的美丽程度 $a_i$。而一旁的魔理沙作为一位魔法使，拥有两种能力。她可以进行若干次操作，每次操作可以**使得这 $\\bm n$ 朵花的位置完全翻转**，或者可以**将某一朵花的美丽程度加上或减去一个整数**。\n\n灵梦认为，如果能用魔理沙的操作，使得最后花朵的美丽程度可以变成序列 $b_i$，那么将会是很好的。为了解决异变顺利，魔理沙希望自己的操作次数尽可能少。那么请问魔理沙为了满足灵梦的愿望至少需要操作几次？\n\n---\n\n幻想乡的花儿渐落，新绿开始步向美丽的季节。经过六十年还不会被遗忘的记忆，可能是没有的吧。", "inputFormat": "- 第一行一个整数 $n$。  \n- 第二行 $n$ 个整数 $a_1,a_2,\\cdots,a_n$。\n- 第三行 $n$ 个整数 $b_1,b_2,\\cdots,b_n$。", "outputFormat": "- 输出一行一个整数，代表至少需要几次操作。", "hint": "### 样例解释 \\#1\n\n$$\n\\begin{array}{cccl}\n\\color{red}1&\\color{red}2&\\color{red}3&\\downarrow\\text{reverse}\\\\\n3&2&1&\n\\end{array}\n$$\n\n### 样例解释 \\#2\n\n$$\n\\begin{array}{ccl}\n\\color{red}3&\\color{red}1&\\downarrow\\text{reverse}\\\\\n1&\\color{red}3&\\downarrow\\text{add }-1\\\\\n1&2&\n\\end{array}\n$$\n\n### 数据范围\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le} & \\textbf{特殊性质} & \\textbf{分值}\\\\\\hline\n1 & 10 & - & 10\\\\\\hline\n2 & 10^3 & - & 30\\\\\\hline\n3 & 5\\times 10^5 & \\text{A} & 5 \\\\\\hline\n4 & 5\\times 10^5 & - & 55 \\\\\\hline\n\\end{array}$$\n\n- 特殊性质 $\\textbf{A}$：保证存在一种花费最小的方案，不需要执行第二种操作。\n\n对于全部数据，满足 $1 \\leq n \\leq 5\\times10^5$，\n$1 \\leq a_i,b_i \\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P8538", "type": "P", "difficulty": 3, "samples": [["6\n3 1 3 2 1 2", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "贪心", "洛谷原创", "O2优化", "洛谷月赛"], "title": "「Wdoi-2」灵山之上神风起", "background": "在天狗记者射命丸文的指（放）引（水）之下，灵梦一行人找到了山中的神社。\n\n“在妖怪之山上还真的存在其他的神社啊。”灵梦感慨道。她们看到了由树木建造的神社正殿，以及正殿前的参拜道上的一排御柱，而更远处则是一片湖——风神之湖。湖面非常开阔，波光粼粼，一碧万顷，远处似乎有群山环抱，让人心旷神怡。\n\n到达神社之时已经是傍晚了。正当灵梦和魔理沙感慨之时，见到在她们面前有一位白衣蓝裙的少女，东风谷早苗，拥有着引发奇迹程度的能力。为了找到守矢神社中的两位神灵，灵梦与魔理沙，向东风谷早苗产生了激烈的交战。\n\n“那就在现人神的力量洗礼中思索吧！这召唤奇迹的神明之力！”", "description": "### 简要题意\n\n给定一个长度为 $n$ 的正整数序列 $a$ 满足对于所有 $i\\in [1,n]$ 有 $a_i \\in \\{1,2,3\\}$。\n\n现在通过该序列构造一张含 $n$ 个节点，节点编号为 $1$ 到 $n$ 的图：对于数 $i$，如果 $a_i=1$，那么什么都不做；如果 $a_i=2$，那么向所有比 $i$ 小的数的节点连无向边；如果 $a_i=3$，那么向所有比 $i$ 大的数的节点连无向边。求出该图的最大独立集的大小。\n\n最大独立集，指的是原图中一个点数尽量多的点集，这些点在原图中两两之间没有边**直接**相连。\n\n### 原始题意\n\n然而，东风谷早苗（后称早苗）的弹幕密度相当之高，使人应接不暇，灵梦只得想个方法去减少她需要关注的弹幕数量。\n\n数个回合过后，她发现，早苗每次释放弹幕只会释放出 $n$ 个弹幕，分别编号为 $1,2,\\dots,n$，而她每释放一个弹幕，都会对应着产生一次神力波动。因而她的神力波动可以抽象为一个长度为 $n$ 的正整数数列 $\\{a_n\\}$。由于她的资历尚浅，只会使用三种神力，分别用 $1,2,3$ 表示，即 $\\forall i \\in [1,n]$，$a_i \\in \\{1,2,3\\}$。\n\n她发现，早苗的三种神力作用各不相同，具体而言如下：\n\n- 当 $a_i=1$ 时，她不会做任何事情。\n- 当 $a_i=2$ 时，早苗会让第 $i$ 个弹幕向所有弹幕编号**小于** $i$ 的弹幕建立神力输送通道。\n- 当 $a_i=3$ 时，早苗会让第 $i$ 个弹幕向所有弹幕编号**大于** $i$ 的弹幕建立神力输送通道。\n\n接着，在各种神力的交互配合之下，密集的弹幕将展开于灵梦的眼前。而一旁的魔理沙发现，若是从这些弹幕中挑选出**尽可能多的**一群弹幕，使得每个弹幕之间不存在直接相连的神力输送通道，那么这群弹幕会产生【引发奇迹程度的能力】，是不必关注的。\n\n由于【引发奇迹程度的能力】只能被触发**一次**，灵梦和魔理沙想要知道，**最多**有多少个弹幕是不必关注的。她们找到了你，希望你能帮她解答。", "inputFormat": "- 第一行，输入一个正整数 $n$，表示弹幕总数。\n- 第二行，输入 $n$ 个正整数表示 $a_i$，具体含义见题目描述。", "outputFormat": "- 共一行，输出一个正整数，表示**最多**有多少个弹幕是不必关注的。", "hint": "### 样例解释\n\n根据题意显然可以构造出如下的图。其中 $a_i=2$ 的用蓝色边表示，$a_i=3$ 的用红色边表示。\n\n显然选取第 $2,3$ 个弹幕（已用绿色填图）是最多的情况。实际上对于这个样例，选取弹幕的方案不止一种，但是不存在更多的情况了。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/99a854cu.png)\n\n### 数据范围\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le} & \\textbf{特殊性质} & \\textbf{分值}\\\\\\hline\n1 & 10 & - & 20\\\\\\hline\n2 & 10^5 & \\text{A} & 10\\\\\\hline\n3 & 10^5 & \\text{B} & 30 \\\\\\hline\n4 & 10^5 & - & 40 \\\\\\hline\n\\end{array}$$\n\n- 特殊性质 $\\text{A}$：所有的 $a_i=1$；\n- 特殊性质 $\\text{B}$：所有的 $a_i$ 不是 $1$ 就是 $2$。\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^5$，$a_i \\in \\{1,2,3\\}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdoi-2」灵山之上神风起", "background": "在天狗记者射命丸文的指（放）引（水）之下，灵梦一行人找到了山中的神社。\n\n“在妖怪之山上还真的存在其他的神社啊。”灵梦感慨道。她们看到了由树木建造的神社正殿，以及正殿前的参拜道上的一排御柱，而更远处则是一片湖——风神之湖。湖面非常开阔，波光粼粼，一碧万顷，远处似乎有群山环抱，让人心旷神怡。\n\n到达神社之时已经是傍晚了。正当灵梦和魔理沙感慨之时，见到在她们面前有一位白衣蓝裙的少女，东风谷早苗，拥有着引发奇迹程度的能力。为了找到守矢神社中的两位神灵，灵梦与魔理沙，向东风谷早苗产生了激烈的交战。\n\n“那就在现人神的力量洗礼中思索吧！这召唤奇迹的神明之力！”", "description": "### 简要题意\n\n给定一个长度为 $n$ 的正整数序列 $a$ 满足对于所有 $i\\in [1,n]$ 有 $a_i \\in \\{1,2,3\\}$。\n\n现在通过该序列构造一张含 $n$ 个节点，节点编号为 $1$ 到 $n$ 的图：对于数 $i$，如果 $a_i=1$，那么什么都不做；如果 $a_i=2$，那么向所有比 $i$ 小的数的节点连无向边；如果 $a_i=3$，那么向所有比 $i$ 大的数的节点连无向边。求出该图的最大独立集的大小。\n\n最大独立集，指的是原图中一个点数尽量多的点集，这些点在原图中两两之间没有边**直接**相连。\n\n### 原始题意\n\n然而，东风谷早苗（后称早苗）的弹幕密度相当之高，使人应接不暇，灵梦只得想个方法去减少她需要关注的弹幕数量。\n\n数个回合过后，她发现，早苗每次释放弹幕只会释放出 $n$ 个弹幕，分别编号为 $1,2,\\dots,n$，而她每释放一个弹幕，都会对应着产生一次神力波动。因而她的神力波动可以抽象为一个长度为 $n$ 的正整数数列 $\\{a_n\\}$。由于她的资历尚浅，只会使用三种神力，分别用 $1,2,3$ 表示，即 $\\forall i \\in [1,n]$，$a_i \\in \\{1,2,3\\}$。\n\n她发现，早苗的三种神力作用各不相同，具体而言如下：\n\n- 当 $a_i=1$ 时，她不会做任何事情。\n- 当 $a_i=2$ 时，早苗会让第 $i$ 个弹幕向所有弹幕编号**小于** $i$ 的弹幕建立神力输送通道。\n- 当 $a_i=3$ 时，早苗会让第 $i$ 个弹幕向所有弹幕编号**大于** $i$ 的弹幕建立神力输送通道。\n\n接着，在各种神力的交互配合之下，密集的弹幕将展开于灵梦的眼前。而一旁的魔理沙发现，若是从这些弹幕中挑选出**尽可能多的**一群弹幕，使得每个弹幕之间不存在直接相连的神力输送通道，那么这群弹幕会产生【引发奇迹程度的能力】，是不必关注的。\n\n由于【引发奇迹程度的能力】只能被触发**一次**，灵梦和魔理沙想要知道，**最多**有多少个弹幕是不必关注的。她们找到了你，希望你能帮她解答。", "inputFormat": "- 第一行，输入一个正整数 $n$，表示弹幕总数。\n- 第二行，输入 $n$ 个正整数表示 $a_i$，具体含义见题目描述。", "outputFormat": "- 共一行，输出一个正整数，表示**最多**有多少个弹幕是不必关注的。", "hint": "### 样例解释\n\n根据题意显然可以构造出如下的图。其中 $a_i=2$ 的用蓝色边表示，$a_i=3$ 的用红色边表示。\n\n显然选取第 $2,3$ 个弹幕（已用绿色填图）是最多的情况。实际上对于这个样例，选取弹幕的方案不止一种，但是不存在更多的情况了。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/99a854cu.png)\n\n### 数据范围\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le} & \\textbf{特殊性质} & \\textbf{分值}\\\\\\hline\n1 & 10 & - & 20\\\\\\hline\n2 & 10^5 & \\text{A} & 10\\\\\\hline\n3 & 10^5 & \\text{B} & 30 \\\\\\hline\n4 & 10^5 & - & 40 \\\\\\hline\n\\end{array}$$\n\n- 特殊性质 $\\text{A}$：所有的 $a_i=1$；\n- 特殊性质 $\\text{B}$：所有的 $a_i$ 不是 $1$ 就是 $2$。\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^5$，$a_i \\in \\{1,2,3\\}$。", "locale": "zh-CN"}}}
{"pid": "P8539", "type": "P", "difficulty": 4, "samples": [["7 2 3\n1 4 1 5 4 1 1\n3 3\n6 4", "7 7"], ["10 10 9\n14 91 84 13 97 92 23 64 31 10 \n5 2\n5 5\n9 1\n2 6\n9 1\n5 4\n3 5\n2 8\n8 2\n5 4\n", "245 1177\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "线段树", "洛谷原创", "O2优化", "洛谷月赛"], "title": "「Wdoi-2」来自地上的支援", "background": "波光粼粼的山顶湖与庄严神圣的神社之下，是一座复合型活火山。  \n沿幻想风穴而下，便能到达火山之下，废弃已久的地狱原址。   \n>在旧地狱中，有一座大都市。那里是旧地狱还是地狱的时候在那工作的众鬼们居住的地方，只有那里亡者们是无法踏入去的。后来地狱体制改革，机构搬离了这个地方。  \n因为这个缘故这块地狱变成了废墟，但却有一部分看上了那里的妖怪擅作主张占领了那里，于是就成了如今的旧地狱了。\n这里比地上更没有秩序可言。悍匪恶霸，特别是惹人类讨厌的家伙都喜欢搬到这边定居下来。\n\n自旧地狱喷泻而出的间歇泉，给妖怪之山带来了优良的温泉，也喷出了大量的怨灵。\n\n为了解决这次异变，乐园的巫女和普通的魔法使结伴而行，在来自地上的支援下，自幻想风穴直冲地底。\n\n先后结（bao）识（da）了黑暗洞窟中的明亮之网、地壳下的嫉妒心、人们所谈论的怪力乱神后，二人来到了遗址中心的洋馆，地灵殿。\n\n受这里主人的指引，二人来到了位于深处的间歇泉地下中心。", "description": "### 简要题意\n给定正整数 $n$、$v$ 和长度为 $n$ 的数组 $\\{A_i\\}$。\n\n有一个长度为 $n$ 的数组 $B$，初始值与 $A$ 相同。 \n执行 $n$ 次操作，第 $i$ 次操作在 $[1,i]$ 中按如下规则选取一个正整数 $j$，然后把 $B_j$ 变成 $B_j+v$：\n- 选取 $B_j$ 最大的 $j$。\n- $B_j$ 相同时选择 $A_j$ 最大的 $j$。\n- $A_j,B_j$ 均相同，选择较小的 $j$。\n\n我们称这是选中了一次 $j$。\n\n有 $m$ 次询问，每次询问给定 $x_i,k_i$。表示求最小的 $s$，使得**若**将 $A_{x_i}$ 的初始值改为 $s$（注意此时 $B_{x_i}$ 的初始值也会跟着改变），$x_i$ 至少被选中 $k_i$ 次，或报告不存在（**结果为** $0$）。请注意，$s$ 不存在最小值时也是报告不存在（**结果为** $0$）。\n\n询问之间互相独立，也就是每次询问不会对 $A_{x_i}$ 和 $B_{x_i}$ 产生实质性更改。\n\n### 原始题意\n\n到达控制中心之后，主角组和灵乌路空进行了激烈的狗斗大赛。负责技术维护的河童需要接受荷取来自地上指挥部的指令，保障生产安全。\n\n具体地，有 $n$ 个核反应机组依次排开，第 $i$ 个机组的活动强度为 $A_i$。为了维护平衡，控制系统依次操作 $n$ 次，第 $i$ 次操作会在前 $i$ 个机组中找到一个**当前活动度最高的**机组，进行一次调节平衡操作，并将其活动度增加 $v$。倘若有多个机组活动度最高，就应当选择初始活动度**最大**的，若还是无法比较，则取编号最小。\n\n为了在自动控制系统的基础上调节平衡，荷取会发出 $m$ 条指令，形如她每次会给出两个整数 $x_i,k_i$，表示她会修改第 $x_i$ 个机组的初始活动度。她希望通过修改（必须改成一个**非负整数** $s$）后，$x_i$ 号机组至少被平衡 $k_i$ 次。如果无论如何都无法达到要求，那么结果就是 $0$；否则请求出满足条件的**最小的** $s$。", "inputFormat": "- 第一行有三个整数 $n, m, v$。\n- 接下来一行，有 $n$ 个整数，描述 $a_i$。\n- 接下来 $m$ 行，每行有两个整数 $x_i,k_i$，描述一次询问。", "outputFormat": "- 一行，输出两个整数，表示所有结果的**异或和**与**加法和**。", "hint": "### 样例 1 解释\n\n对于第一次询问，我们将 $A_3$ 修改为 $7$。\n\n- 第一次操作选择了位置 $1$，于是 $B_1$ 变为 $4$。\n- 第二次操作选择了位置 $2$，于是 $B_2$ 变为 $7$。虽然操作前 $B_1=B_2$，但是 $A_2>A_1$，因此选择位置 $2$。\n- 第三次操作选择了位置 $3$，于是 $B_3$ 变为 $10$。\n- 第四次操作选择了位置 $3$，于是 $B_3$ 变为 $13$。\n- 第五次操作选择了位置 $3$，于是 $B_3$ 变为 $16$。\n- 第六次操作选择了位置 $3$，于是 $B_3$ 变为 $19$。\n- 第七次操作选择了位置 $3$，于是 $B_3$ 变为 $22$。\n\n于是位置 $3$ 一共被选择了 $5$ 次，满足题意。可以证明，如果把 $A_3$ 的初始值设为 $6$，无法达成要求。于是该询问结果为 $7$。\n\n对于第二个询问，容易发现不可能有 $4$ 次以上操作选择位置 $6$。因此该询问结果为 $0$。\n\n$7\\oplus 0=7$，$7+0=7$，因此输出 $7,7$。\n\n### 数据范围\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n,m\\le} & \\bm {a_i\\le } & \\bm{v\\le} & \\textbf{分值} \\cr\\hline\n1 & 10 & 100 & 10 & 10 \\cr\\hline\n2 & 100 & 5\\times 10^3 & 50 & 20 \\cr\\hline\n3 & 10^3 & 10^9 & 100 & 10 \\cr\\hline\n4 & 10^5 & 10^9 & 100 & 25 \\cr\\hline\n5 & 2\\times 10^6 & 10^9 & 100 & 35 \\cr\\hline\n\\end{array}$$\n\n对于全部数据，满足 $1 \\le n,m \\le 2\\times 10^6$，$1 \\le v \\le 100$，$1 \\le a_i \\le 10 ^ 9$，$1 \\le x,k \\le n$。\n\n**本题 IO 量较大，请选择合适的输入方式。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdoi-2」来自地上的支援", "background": "波光粼粼的山顶湖与庄严神圣的神社之下，是一座复合型活火山。  \n沿幻想风穴而下，便能到达火山之下，废弃已久的地狱原址。   \n>在旧地狱中，有一座大都市。那里是旧地狱还是地狱的时候在那工作的众鬼们居住的地方，只有那里亡者们是无法踏入去的。后来地狱体制改革，机构搬离了这个地方。  \n因为这个缘故这块地狱变成了废墟，但却有一部分看上了那里的妖怪擅作主张占领了那里，于是就成了如今的旧地狱了。\n这里比地上更没有秩序可言。悍匪恶霸，特别是惹人类讨厌的家伙都喜欢搬到这边定居下来。\n\n自旧地狱喷泻而出的间歇泉，给妖怪之山带来了优良的温泉，也喷出了大量的怨灵。\n\n为了解决这次异变，乐园的巫女和普通的魔法使结伴而行，在来自地上的支援下，自幻想风穴直冲地底。\n\n先后结（bao）识（da）了黑暗洞窟中的明亮之网、地壳下的嫉妒心、人们所谈论的怪力乱神后，二人来到了遗址中心的洋馆，地灵殿。\n\n受这里主人的指引，二人来到了位于深处的间歇泉地下中心。", "description": "### 简要题意\n给定正整数 $n$、$v$ 和长度为 $n$ 的数组 $\\{A_i\\}$。\n\n有一个长度为 $n$ 的数组 $B$，初始值与 $A$ 相同。 \n执行 $n$ 次操作，第 $i$ 次操作在 $[1,i]$ 中按如下规则选取一个正整数 $j$，然后把 $B_j$ 变成 $B_j+v$：\n- 选取 $B_j$ 最大的 $j$。\n- $B_j$ 相同时选择 $A_j$ 最大的 $j$。\n- $A_j,B_j$ 均相同，选择较小的 $j$。\n\n我们称这是选中了一次 $j$。\n\n有 $m$ 次询问，每次询问给定 $x_i,k_i$。表示求最小的 $s$，使得**若**将 $A_{x_i}$ 的初始值改为 $s$（注意此时 $B_{x_i}$ 的初始值也会跟着改变），$x_i$ 至少被选中 $k_i$ 次，或报告不存在（**结果为** $0$）。请注意，$s$ 不存在最小值时也是报告不存在（**结果为** $0$）。\n\n询问之间互相独立，也就是每次询问不会对 $A_{x_i}$ 和 $B_{x_i}$ 产生实质性更改。\n\n### 原始题意\n\n到达控制中心之后，主角组和灵乌路空进行了激烈的狗斗大赛。负责技术维护的河童需要接受荷取来自地上指挥部的指令，保障生产安全。\n\n具体地，有 $n$ 个核反应机组依次排开，第 $i$ 个机组的活动强度为 $A_i$。为了维护平衡，控制系统依次操作 $n$ 次，第 $i$ 次操作会在前 $i$ 个机组中找到一个**当前活动度最高的**机组，进行一次调节平衡操作，并将其活动度增加 $v$。倘若有多个机组活动度最高，就应当选择初始活动度**最大**的，若还是无法比较，则取编号最小。\n\n为了在自动控制系统的基础上调节平衡，荷取会发出 $m$ 条指令，形如她每次会给出两个整数 $x_i,k_i$，表示她会修改第 $x_i$ 个机组的初始活动度。她希望通过修改（必须改成一个**非负整数** $s$）后，$x_i$ 号机组至少被平衡 $k_i$ 次。如果无论如何都无法达到要求，那么结果就是 $0$；否则请求出满足条件的**最小的** $s$。", "inputFormat": "- 第一行有三个整数 $n, m, v$。\n- 接下来一行，有 $n$ 个整数，描述 $a_i$。\n- 接下来 $m$ 行，每行有两个整数 $x_i,k_i$，描述一次询问。", "outputFormat": "- 一行，输出两个整数，表示所有结果的**异或和**与**加法和**。", "hint": "### 样例 1 解释\n\n对于第一次询问，我们将 $A_3$ 修改为 $7$。\n\n- 第一次操作选择了位置 $1$，于是 $B_1$ 变为 $4$。\n- 第二次操作选择了位置 $2$，于是 $B_2$ 变为 $7$。虽然操作前 $B_1=B_2$，但是 $A_2>A_1$，因此选择位置 $2$。\n- 第三次操作选择了位置 $3$，于是 $B_3$ 变为 $10$。\n- 第四次操作选择了位置 $3$，于是 $B_3$ 变为 $13$。\n- 第五次操作选择了位置 $3$，于是 $B_3$ 变为 $16$。\n- 第六次操作选择了位置 $3$，于是 $B_3$ 变为 $19$。\n- 第七次操作选择了位置 $3$，于是 $B_3$ 变为 $22$。\n\n于是位置 $3$ 一共被选择了 $5$ 次，满足题意。可以证明，如果把 $A_3$ 的初始值设为 $6$，无法达成要求。于是该询问结果为 $7$。\n\n对于第二个询问，容易发现不可能有 $4$ 次以上操作选择位置 $6$。因此该询问结果为 $0$。\n\n$7\\oplus 0=7$，$7+0=7$，因此输出 $7,7$。\n\n### 数据范围\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n,m\\le} & \\bm {a_i\\le } & \\bm{v\\le} & \\textbf{分值} \\cr\\hline\n1 & 10 & 100 & 10 & 10 \\cr\\hline\n2 & 100 & 5\\times 10^3 & 50 & 20 \\cr\\hline\n3 & 10^3 & 10^9 & 100 & 10 \\cr\\hline\n4 & 10^5 & 10^9 & 100 & 25 \\cr\\hline\n5 & 2\\times 10^6 & 10^9 & 100 & 35 \\cr\\hline\n\\end{array}$$\n\n对于全部数据，满足 $1 \\le n,m \\le 2\\times 10^6$，$1 \\le v \\le 100$，$1 \\le a_i \\le 10 ^ 9$，$1 \\le x,k \\le n$。\n\n**本题 IO 量较大，请选择合适的输入方式。**", "locale": "zh-CN"}}}
{"pid": "P8540", "type": "P", "difficulty": 5, "samples": [["5 2 4", "1"], ["1000000000000000000 1000000000000000000 1000000000000000000", "262144"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "洛谷原创", "O2优化", "洛谷月赛", "分类讨论"], "title": "「Wdoi-2」夜空中的 UFO 恋曲", "background": "土地变得泥泞，曾被寒冰覆盖的大地上，万物开始复苏。  \n覆盖着幻想乡的少量积雪，封住了在这个冬天苏醒的地灵们，   \n也足以使妖精们的活动变得迟钝。这样安稳沉睡的季节也即将告一段落。\n\n博丽神社的巫女博丽灵梦从居住在森林里的魔法使那儿听到了一个传闻说，有人目击到云的缝隙中有不可思议的船在空中飞行。\n\n——船中空空如也。  \n曾在船中的金银财宝早已散佚，剩下的东西也散发着  \n陈年霉臭。  \n仅凭凛冽春风，仍不足以将那霉味吹散。  \n但是，只有那位大人留下的宝物，即使变成碎片也不会失去威力吧。\n\n只是那些碎片依旧以不可思议不可理解的形态飘在幻想乡各处，对扑簌迷离的真相加盖了疑问的迷雾。\n\n貌似有很深的原因。我们不知道的某种东西，在酝酿着什么。", "description": "### 简要题意\n给定正整数 $a,b,c$，满足 $a,b,c\\textcolor{red} > 1$。对于函数 $f_k$，给出如下定义：\n\n$$f_{k}(x)=\\begin{cases}\nx^{2c}\\oplus c & k = 1\\\\\nf_{k-1}(x^{2c}\\oplus c) & k > 1\n\\end{cases}$$\n\n其中 $\\oplus$ 表示二进制下的异或操作。\n\n现在要求计算出 $\\operatorname{lowbit}(f_{b}(a))$。其中 $\\operatorname{lowbit}(x)$ 表示二进制下 $x$ 最右侧的 $1$ 所在位置对应的二进制值，例如：\n\n$$\\operatorname{lowbit}(101101\\cdots 10\\textcolor{red}1\\underbrace{00\\cdots000}_{k\\text{ 个 }0})=2^k$$\n\n特别地，若 $x=0$，则 $\\operatorname{lowbit}(x)=0$。\n### 原始题意\n为了去除碎片上附加的「不明的因子」，主角组需要破开[【正体不明】](https://www.luogu.com.cn/user/35891)附加的法术。\n\n不明的因子是一种小蛇一般的飞行物，在不同人的眼中具有不同的形象。  \n当有人看到它时，会按照自己的常识，把它看成自己认识的、认为合理的东西。\n\n碎片的表面有一个由红蓝组成的长串，妖怪贤者发现，若将红看作 $0$，蓝看作 $1$，它就成了一个二进制数字 $x$。  \n碎片上一共有 $k$ 层不明因子，每破开一层都会使数字 $x$ 变为 $x^{2c}\\oplus c$（其中 $\\oplus$ 表示二进制下的异或操作）。  \n为了破解法术，主角组需要根据给定的常数 $c$，初始值 $a$ 和层数 $k=b$ 先破开所有的不明因子，然后计算剩下的数字所代表的串中， 最右侧的「蓝色」所在位置对应的二进制值。\n\n经过主角们一定的分析，她们发现了 $a,b,c\\textcolor{red} > 1$。\n\n紫把[式神计算机](https://www.luogu.com.cn/user/149196)搬了出来就回去睡觉了，把编制程序的任务交给了可怜的金发小女孩。你的任务就是帮她完成程序的编制，彻底肃清异变的影响，找回丢失的记忆。", "inputFormat": "第一行有三个正整数 $a,b,c$，含义如题面所示。\n\n再次强调，$a,b,c\\textcolor{red} > 1$。", "outputFormat": "输出共一行一个整数，表示 $\\operatorname{lowbit}(f_b(a))$ 的值。", "hint": "### 样例 1 解释\n\n- $f_{2}(5)=f_1(5^8\\oplus 4)=f_1(390{,}629)$；\n- $f_1(390{,}629)=390{,}629^8\\oplus 4=542{,}145{,}496{,}755{,} 385{,}548{,}075{,}315{,}235{,}215{,}044{,}149{,}100{,}456{,}165$；\n- 容易发现，$f_{2}(5)$ 的 $\\text{lowbit}$ 值为 $1$。\n\n### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{a,b,c\\le} & \\textbf{特殊性质} & \\textbf{分值} \\cr\\hline\n1 & 11 & - & 25 \\cr\\hline\n2 & 10^{18} & \\text{A} & 35 \\cr\\hline\n3 & 10^{18} & - & 40 \\cr\\hline\n\\end{array}$$\n\n- **特殊性质** $\\textbf{A}$：保证 $c$ 为偶数。\n\n对于全部数据，保证 $1 \\textcolor{red}< a,b,c\\le 10^{18}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdoi-2」夜空中的 UFO 恋曲", "background": "土地变得泥泞，曾被寒冰覆盖的大地上，万物开始复苏。  \n覆盖着幻想乡的少量积雪，封住了在这个冬天苏醒的地灵们，   \n也足以使妖精们的活动变得迟钝。这样安稳沉睡的季节也即将告一段落。\n\n博丽神社的巫女博丽灵梦从居住在森林里的魔法使那儿听到了一个传闻说，有人目击到云的缝隙中有不可思议的船在空中飞行。\n\n——船中空空如也。  \n曾在船中的金银财宝早已散佚，剩下的东西也散发着  \n陈年霉臭。  \n仅凭凛冽春风，仍不足以将那霉味吹散。  \n但是，只有那位大人留下的宝物，即使变成碎片也不会失去威力吧。\n\n只是那些碎片依旧以不可思议不可理解的形态飘在幻想乡各处，对扑簌迷离的真相加盖了疑问的迷雾。\n\n貌似有很深的原因。我们不知道的某种东西，在酝酿着什么。", "description": "### 简要题意\n给定正整数 $a,b,c$，满足 $a,b,c\\textcolor{red} > 1$。对于函数 $f_k$，给出如下定义：\n\n$$f_{k}(x)=\\begin{cases}\nx^{2c}\\oplus c & k = 1\\\\\nf_{k-1}(x^{2c}\\oplus c) & k > 1\n\\end{cases}$$\n\n其中 $\\oplus$ 表示二进制下的异或操作。\n\n现在要求计算出 $\\operatorname{lowbit}(f_{b}(a))$。其中 $\\operatorname{lowbit}(x)$ 表示二进制下 $x$ 最右侧的 $1$ 所在位置对应的二进制值，例如：\n\n$$\\operatorname{lowbit}(101101\\cdots 10\\textcolor{red}1\\underbrace{00\\cdots000}_{k\\text{ 个 }0})=2^k$$\n\n特别地，若 $x=0$，则 $\\operatorname{lowbit}(x)=0$。\n### 原始题意\n为了去除碎片上附加的「不明的因子」，主角组需要破开[【正体不明】](https://www.luogu.com.cn/user/35891)附加的法术。\n\n不明的因子是一种小蛇一般的飞行物，在不同人的眼中具有不同的形象。  \n当有人看到它时，会按照自己的常识，把它看成自己认识的、认为合理的东西。\n\n碎片的表面有一个由红蓝组成的长串，妖怪贤者发现，若将红看作 $0$，蓝看作 $1$，它就成了一个二进制数字 $x$。  \n碎片上一共有 $k$ 层不明因子，每破开一层都会使数字 $x$ 变为 $x^{2c}\\oplus c$（其中 $\\oplus$ 表示二进制下的异或操作）。  \n为了破解法术，主角组需要根据给定的常数 $c$，初始值 $a$ 和层数 $k=b$ 先破开所有的不明因子，然后计算剩下的数字所代表的串中， 最右侧的「蓝色」所在位置对应的二进制值。\n\n经过主角们一定的分析，她们发现了 $a,b,c\\textcolor{red} > 1$。\n\n紫把[式神计算机](https://www.luogu.com.cn/user/149196)搬了出来就回去睡觉了，把编制程序的任务交给了可怜的金发小女孩。你的任务就是帮她完成程序的编制，彻底肃清异变的影响，找回丢失的记忆。", "inputFormat": "第一行有三个正整数 $a,b,c$，含义如题面所示。\n\n再次强调，$a,b,c\\textcolor{red} > 1$。", "outputFormat": "输出共一行一个整数，表示 $\\operatorname{lowbit}(f_b(a))$ 的值。", "hint": "### 样例 1 解释\n\n- $f_{2}(5)=f_1(5^8\\oplus 4)=f_1(390{,}629)$；\n- $f_1(390{,}629)=390{,}629^8\\oplus 4=542{,}145{,}496{,}755{,} 385{,}548{,}075{,}315{,}235{,}215{,}044{,}149{,}100{,}456{,}165$；\n- 容易发现，$f_{2}(5)$ 的 $\\text{lowbit}$ 值为 $1$。\n\n### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{a,b,c\\le} & \\textbf{特殊性质} & \\textbf{分值} \\cr\\hline\n1 & 11 & - & 25 \\cr\\hline\n2 & 10^{18} & \\text{A} & 35 \\cr\\hline\n3 & 10^{18} & - & 40 \\cr\\hline\n\\end{array}$$\n\n- **特殊性质** $\\textbf{A}$：保证 $c$ 为偶数。\n\n对于全部数据，保证 $1 \\textcolor{red}< a,b,c\\le 10^{18}$。", "locale": "zh-CN"}}}
{"pid": "P8541", "type": "P", "difficulty": 6, "samples": [["1\n\n1\n\n1\n\n1\n\n1\n\n1\n\n0\n\n0\n\n1", "\n? 0\n\n? 1\n\n? 2\n\n? 3\n\n? 10\n\n? 100\n\n? 233\n\n? 1919810\n\n! 114514"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["倍增", "二分", "洛谷原创", "交互题", "Special Judge", "O2优化", "洛谷月赛"], "title": "「Wdoi-2」死亡之后愈发愉悦", "background": "落樱缤纷春不待，如果错过了这次机会，可能得等到紫藤绽放的春夏之际才能赏花了。  \n但是两人依然无心在樱花树下席地而宴。\n\n因为正体不明的灵体在两人面前倏现骤消的飘浮着。  \n后来才明白这些四处飘浮的正体不明灵体，既非普通幽灵，也不是前阵子出现的怨灵。  \n这些是神灵。本应超脱为神的灵体。\n\n一般而言，神灵多半居住在神社里，其实它们是随处可见的没有固定型态的灵体。  \n这些神灵让她们困惑不已。\n\n超乎常人的强烈人欲、想法、恐惧与情感，是神灵出现的原因。一般而言，神灵很少危害人类，如果没有强烈的欲望。例如祈求丰收，或是除厄避邪等，是不会产生神灵的……\n\n小神灵指引着灵梦与魔理沙深入命莲寺的地底，与千年复苏的敌人交手。从命莲寺墓地到莲池中央的梦殿大祀庙，从彷徨的亡灵到极具传说色彩的圣德太子，从欲望加速到小小的欲望星空，一切都显得那么不可思议。\n\n「死亡之后，才能得到更加绚烂的重生。」", "description": "**【这是一道交互题】**\n\n定义 $f(x)$ 表示严格大于 $x$ 的最小的完全平方数，定义 $g(x)$ 为小于等于 $x$ 的最大的完全平方数。例如，$f(1)=f(2)=g(4)=g(8)=4$。\n\n一个正整数是“可爱”的，当且仅当 $x-g(x)<f(x)-x$，例如，$1,5,11$ 是可爱的正整数，而 $3,8,15$ 不是。\n\n为了倾听小神灵的愿望，主角组需要向神子询问。小神灵有一个最喜欢的正整数 $a$，神子可以根据灵梦给出的 $x\\quad(x\\in[0,10^9])$，向小神灵询问，而小神灵只能回答她，$a+x$ 是不是可爱的正整数（$\\text{cute number}$）。\n\n请通过适当的询问找出 $a$。", "inputFormat": "第一行有一个正整数 $T$，表示数据组数。每一组之间互相独立。\n\n接下来，对于每一组数据，你将可以进行以下两种操作：\n\n- $\\verb!? x!$：询问 $a+x$ 是否是 $\\text{cute number}$。要注意，$x$ 的值应当在 $[0,10^9]$ 以内。对于正确的询问，交互库会返回一个数字 $1$ 或者 $0$，表示 $a+x$ 是/不是 $\\text{cute number}$。\n- $\\verb|! a|$：报告你发现的 $a$。如果你给出的 $a$ 正确，该组数据结束。注意：报告操作不计入询问操作的总次数。\n\n如果你的询问次数超过了 $100$，或者 $x$ 不符合数据范围，或者你报告的 $a$ 不正确，交互库会返回一个数字 $-1$。此时你应当立即结束程序，否则可能发生不可预知的错误。", "outputFormat": "", "hint": "### 样例解释\n\n样例当中的过程仅供参考。\n\n样例当中，$a=114514$，是 $\\text{cute number}$（因为 $338^2\\le 114514 <339^2$，而 $114514-338^2=270<339^2-114514=407$）。\n\n同样地，$a+0,a+1,a+2,a+3,a+10$ 均为 $\\text{cute number}$。而 $a+100=114614$ 不是 $\\text{cute number}$，因为 $338^2\\le 114614 <339^2$，而 $114614-338^2=370\\ge 339^2-114614=307$。\n\n### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{a\\le } & \\bm{T\\le} & \\textbf{特殊性质} & \\textbf{分值}\\\\\\hline\n1 & 100 & 100 & - & 10\\\\\\hline\n3 & 10^9 & 2\\times 10^3 & -  & 20\\\\\\hline\n2 & 10^{12} & 2\\times 10^3 & \\textbf{A}  & 30\\\\\\hline\n4 & 10^{12} & 2\\times 10^3 & -  & 40\\\\\\hline\n\\end{array}\n$$\n\n**特殊性质** $\\textbf{A}$：保证 $a$ 是 $\\text{cute number}$。\n\n对于全部数据，保证 $1\\le a\\le 10^{12}$。你发起的询问当中，$x$ 的值应当在 $[0,10^9]$ 以内。\n\n---\n\n此外，你每个测试点的得分还与该测试点所有询问次数的最大值有关。具体而言，设某个测试点你询问操作一共进行了 $\\text{max\\_count}$ 次。\n\n- 若 $\\text{max\\_count}< 64$，你将获得该测试点 $100\\%$ 的分数；\n- 若 $64\\le \\text{max\\_count}< 81$，你将获得该测试点 $50\\%$ 的分数；\n- 若 $81\\le \\text{max\\_count}< 100$，你将获得该测试点 $20\\%$ 的分数；\n- 若 $\\text{max\\_count}\\ge 100$，你将不能获得该测试点的分数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdoi-2」死亡之后愈发愉悦", "background": "落樱缤纷春不待，如果错过了这次机会，可能得等到紫藤绽放的春夏之际才能赏花了。  \n但是两人依然无心在樱花树下席地而宴。\n\n因为正体不明的灵体在两人面前倏现骤消的飘浮着。  \n后来才明白这些四处飘浮的正体不明灵体，既非普通幽灵，也不是前阵子出现的怨灵。  \n这些是神灵。本应超脱为神的灵体。\n\n一般而言，神灵多半居住在神社里，其实它们是随处可见的没有固定型态的灵体。  \n这些神灵让她们困惑不已。\n\n超乎常人的强烈人欲、想法、恐惧与情感，是神灵出现的原因。一般而言，神灵很少危害人类，如果没有强烈的欲望。例如祈求丰收，或是除厄避邪等，是不会产生神灵的……\n\n小神灵指引着灵梦与魔理沙深入命莲寺的地底，与千年复苏的敌人交手。从命莲寺墓地到莲池中央的梦殿大祀庙，从彷徨的亡灵到极具传说色彩的圣德太子，从欲望加速到小小的欲望星空，一切都显得那么不可思议。\n\n「死亡之后，才能得到更加绚烂的重生。」", "description": "**【这是一道交互题】**\n\n定义 $f(x)$ 表示严格大于 $x$ 的最小的完全平方数，定义 $g(x)$ 为小于等于 $x$ 的最大的完全平方数。例如，$f(1)=f(2)=g(4)=g(8)=4$。\n\n一个正整数是“可爱”的，当且仅当 $x-g(x)<f(x)-x$，例如，$1,5,11$ 是可爱的正整数，而 $3,8,15$ 不是。\n\n为了倾听小神灵的愿望，主角组需要向神子询问。小神灵有一个最喜欢的正整数 $a$，神子可以根据灵梦给出的 $x\\quad(x\\in[0,10^9])$，向小神灵询问，而小神灵只能回答她，$a+x$ 是不是可爱的正整数（$\\text{cute number}$）。\n\n请通过适当的询问找出 $a$。", "inputFormat": "第一行有一个正整数 $T$，表示数据组数。每一组之间互相独立。\n\n接下来，对于每一组数据，你将可以进行以下两种操作：\n\n- $\\verb!? x!$：询问 $a+x$ 是否是 $\\text{cute number}$。要注意，$x$ 的值应当在 $[0,10^9]$ 以内。对于正确的询问，交互库会返回一个数字 $1$ 或者 $0$，表示 $a+x$ 是/不是 $\\text{cute number}$。\n- $\\verb|! a|$：报告你发现的 $a$。如果你给出的 $a$ 正确，该组数据结束。注意：报告操作不计入询问操作的总次数。\n\n如果你的询问次数超过了 $100$，或者 $x$ 不符合数据范围，或者你报告的 $a$ 不正确，交互库会返回一个数字 $-1$。此时你应当立即结束程序，否则可能发生不可预知的错误。", "outputFormat": "", "hint": "### 样例解释\n\n样例当中的过程仅供参考。\n\n样例当中，$a=114514$，是 $\\text{cute number}$（因为 $338^2\\le 114514 <339^2$，而 $114514-338^2=270<339^2-114514=407$）。\n\n同样地，$a+0,a+1,a+2,a+3,a+10$ 均为 $\\text{cute number}$。而 $a+100=114614$ 不是 $\\text{cute number}$，因为 $338^2\\le 114614 <339^2$，而 $114614-338^2=370\\ge 339^2-114614=307$。\n\n### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{a\\le } & \\bm{T\\le} & \\textbf{特殊性质} & \\textbf{分值}\\\\\\hline\n1 & 100 & 100 & - & 10\\\\\\hline\n3 & 10^9 & 2\\times 10^3 & -  & 20\\\\\\hline\n2 & 10^{12} & 2\\times 10^3 & \\textbf{A}  & 30\\\\\\hline\n4 & 10^{12} & 2\\times 10^3 & -  & 40\\\\\\hline\n\\end{array}\n$$\n\n**特殊性质** $\\textbf{A}$：保证 $a$ 是 $\\text{cute number}$。\n\n对于全部数据，保证 $1\\le a\\le 10^{12}$。你发起的询问当中，$x$ 的值应当在 $[0,10^9]$ 以内。\n\n---\n\n此外，你每个测试点的得分还与该测试点所有询问次数的最大值有关。具体而言，设某个测试点你询问操作一共进行了 $\\text{max\\_count}$ 次。\n\n- 若 $\\text{max\\_count}< 64$，你将获得该测试点 $100\\%$ 的分数；\n- 若 $64\\le \\text{max\\_count}< 81$，你将获得该测试点 $50\\%$ 的分数；\n- 若 $81\\le \\text{max\\_count}< 100$，你将获得该测试点 $20\\%$ 的分数；\n- 若 $\\text{max\\_count}\\ge 100$，你将不能获得该测试点的分数。", "locale": "zh-CN"}}}
{"pid": "P8542", "type": "P", "difficulty": 7, "samples": [["4\n14\n13\n16\n3\n16", "1 1\n1 0\n0 1\n1 0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["洛谷原创", "Special Judge", "O2优化", "构造", "洛谷月赛"], "title": "「Wdoi-2」魔力的雷云", "background": "道具会自己活动，本来温顺的妖怪突然大闹起来原来都是因为万宝槌的影响。  \n唆使小人的天邪鬼虽然最后逃走了，但因为真正使用万宝槌的是小人，所以灵梦决定对其进行监视。但是总感觉也没再有什么不良企图的样子。  \n\n但就在那时，天空再次出现了诡异的云团。  \n是与逆城出现之时一样的，魔力风暴。\n\n“那不是我干的”，少名针妙丸这样解释着  \n到底，又是谁再次掀起了这样的风暴？  \n灵梦她们，为了调查清楚原因，再次冲进了风暴之中。\n\n小人的末裔、逆转的城、为反抗而反抗的天邪鬼。  \n这背后又隐藏着什么呢。", "description": "### 简要题意\n\n$n$ 块磁铁排列成了一个环。每块磁铁都有磁力，用 $4^{a_i}$ 表示。相邻两块磁铁**磁力大小不同**。磁铁大小一致，长度均为 $1$ 单位长度。摆放时分为北极朝左和北极朝右。当两块磁铁互相吸引时，它们会紧紧靠拢，互相排斥时，记这两块磁铁的磁力为 $u$ 和 $v$，那么它们会相距 $u+v$ 单位长度。\n\n目前已知**整个环**的长度（包括**每个**磁铁的长度，以及相邻磁铁之间的距离），记这个长度为 $d_0$ 个单位长度。对于第 $i$ 块磁铁，也已知若拿去这块磁铁，剩余磁铁组成的环的长度，记这个长度为 $d_i$ 个单位长度。\n\n找到找到任意一种可能的磁铁排列方法满足这些已知的数据，（也要满足相邻两块磁铁磁力大小不同），并且可以决定所用磁铁的磁力。保证有解。\n\n### 原始题意\n\n在堀川雷鼓引发的雷暴中，一架架周围附带着电磁场的鼓正随着节奏摇摆着。在强大的电磁干扰下，巫女和魔法使与地面失去了联系。\n\n这些尺寸完全相同（可以视作为单位长度 $1$）的带有磁力的鼓一共有 $n$ 架，它们排列成了一个环。为了让弹幕美观，第 $i$ 架鼓上带有的磁力是 $4^{a_i}$，而且相邻两架鼓带有的磁力大小不同。\n\n每一架鼓都有磁性上的南北两极，而且在摆放的时候有北极朝左和北极朝右的两种情况。若两架鼓相互吸引它们会紧紧靠拢；而若它们相互排斥，这两架鼓之间的距离就是它们的磁力之和的单位长度。\n\n灵梦记录下了整个环的长度 $d_0$，这包括了每架鼓的长度和相邻的鼓之间的距离，而魔理沙正在使用自己的火力击碎这些鼓。然而这些鼓的质量非常皮实，魔理沙一次只能击碎一个鼓，随后堀川雷鼓会用一个尺寸和磁力完全一致的鼓替代这个被击碎的鼓。但是在击碎第 $i$ 架鼓的时候，受到磁力的作用环的长度会发生变化，魔理沙会记录此时剩余的鼓组成的环的长度 $d_i$（假设磁力的作用是瞬间完成的）。\n\n在战斗的间隙，灵梦和魔理沙希望通过她们记录下的数据，找到任意一种鼓的排布情况满足这些数据。为了降低难度，她们可以自由决定每架鼓上的磁力多少。数据保证有解。\n\n尽快解出鼓的分布，从而结束这场异变吧！", "inputFormat": "- 第一行有一个整数 $n$，表示磁铁的总个数。\n- 接下来 $1$ 行一个整数，表示 $d_0$。\n- 接下来 $n$ 行每行一个整数，其中第 $i$ 行的整数表示 $d_i$。", "outputFormat": "- 输出共 $n$ 行。第 $i$ 行有两个整数 $f_i,a_i$，分别表示磁铁的方向与磁力。若 $f_i=0$ 则表示北极向左，否则若 $f_i=1$ 则表示北极向右。", "hint": "### 样例 1 解释\n\n一种合法的方案中，$c=\\{1,1,0,1\\}$，$a=\\{1,0,1,0\\}$。以下是这种方案的图解。\n\n初始时磁铁的状态如下图所示，磁铁上方的数字是它的磁力大小（即 $4^{a_i}$ 的值），磁铁上标记的 $\\textsf{N/S}$ 是它的磁极。由于笔者能力有限，无法还原出环形，只能用这种传送门的方式扭曲时空了。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tdbb4nqb.png)\n\n容易发现，总长度为 $14$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wmagcu24.png)\n\n拿掉第一块磁铁后的情形如图所示。容易发现，总长度为 $13$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/eipnbj08.png)\n\n拿掉第二块磁铁后的情形如图所示。由于缺少了第二块磁铁的阻挡，第一块和第三块磁铁直接相邻，产生了更大的间距。可以发现，总长度为 $16$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/830j9rz5.png)\n\n拿掉第三块磁铁后的情形如图所示。值得注意的是，所有磁铁北极方向相同，于是直接互相接触，总长度为 $3$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/afqw0jx4.png)\n\n拿掉第四块磁铁后的情形如图所示。由于第三块和第一块磁铁直接相邻（因为是形成了环。在图上则是扭曲后的空间里相邻），因此形成了这种模样。总长度为 $16$。\n\n### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le} & \\textbf{特殊性质} & \\textbf{分值} \\\\\\hline\n1 & 10 & - & 10 \\\\\\hline\n2 & 10^5 & - & 30 \\\\\\hline\n3 & 10^6 & \\text{A} & 5 \\\\\\hline\n4 & 10^6 & - & 55 \\\\\\hline\n\\end{array}$$\n\n**特殊性质** $\\textbf{A}$：保证存在一种方案，所有磁铁的方向一致。\n\n对于所有数据，保证 $1\\leq n\\leq 1\\times10^6$，存在至少一种合法方案。此外，保证 $d_i< 2^{63}$，你构造的 $a_i$ 大小应该在 $[0,10^9]$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdoi-2」魔力的雷云", "background": "道具会自己活动，本来温顺的妖怪突然大闹起来原来都是因为万宝槌的影响。  \n唆使小人的天邪鬼虽然最后逃走了，但因为真正使用万宝槌的是小人，所以灵梦决定对其进行监视。但是总感觉也没再有什么不良企图的样子。  \n\n但就在那时，天空再次出现了诡异的云团。  \n是与逆城出现之时一样的，魔力风暴。\n\n“那不是我干的”，少名针妙丸这样解释着  \n到底，又是谁再次掀起了这样的风暴？  \n灵梦她们，为了调查清楚原因，再次冲进了风暴之中。\n\n小人的末裔、逆转的城、为反抗而反抗的天邪鬼。  \n这背后又隐藏着什么呢。", "description": "### 简要题意\n\n$n$ 块磁铁排列成了一个环。每块磁铁都有磁力，用 $4^{a_i}$ 表示。相邻两块磁铁**磁力大小不同**。磁铁大小一致，长度均为 $1$ 单位长度。摆放时分为北极朝左和北极朝右。当两块磁铁互相吸引时，它们会紧紧靠拢，互相排斥时，记这两块磁铁的磁力为 $u$ 和 $v$，那么它们会相距 $u+v$ 单位长度。\n\n目前已知**整个环**的长度（包括**每个**磁铁的长度，以及相邻磁铁之间的距离），记这个长度为 $d_0$ 个单位长度。对于第 $i$ 块磁铁，也已知若拿去这块磁铁，剩余磁铁组成的环的长度，记这个长度为 $d_i$ 个单位长度。\n\n找到找到任意一种可能的磁铁排列方法满足这些已知的数据，（也要满足相邻两块磁铁磁力大小不同），并且可以决定所用磁铁的磁力。保证有解。\n\n### 原始题意\n\n在堀川雷鼓引发的雷暴中，一架架周围附带着电磁场的鼓正随着节奏摇摆着。在强大的电磁干扰下，巫女和魔法使与地面失去了联系。\n\n这些尺寸完全相同（可以视作为单位长度 $1$）的带有磁力的鼓一共有 $n$ 架，它们排列成了一个环。为了让弹幕美观，第 $i$ 架鼓上带有的磁力是 $4^{a_i}$，而且相邻两架鼓带有的磁力大小不同。\n\n每一架鼓都有磁性上的南北两极，而且在摆放的时候有北极朝左和北极朝右的两种情况。若两架鼓相互吸引它们会紧紧靠拢；而若它们相互排斥，这两架鼓之间的距离就是它们的磁力之和的单位长度。\n\n灵梦记录下了整个环的长度 $d_0$，这包括了每架鼓的长度和相邻的鼓之间的距离，而魔理沙正在使用自己的火力击碎这些鼓。然而这些鼓的质量非常皮实，魔理沙一次只能击碎一个鼓，随后堀川雷鼓会用一个尺寸和磁力完全一致的鼓替代这个被击碎的鼓。但是在击碎第 $i$ 架鼓的时候，受到磁力的作用环的长度会发生变化，魔理沙会记录此时剩余的鼓组成的环的长度 $d_i$（假设磁力的作用是瞬间完成的）。\n\n在战斗的间隙，灵梦和魔理沙希望通过她们记录下的数据，找到任意一种鼓的排布情况满足这些数据。为了降低难度，她们可以自由决定每架鼓上的磁力多少。数据保证有解。\n\n尽快解出鼓的分布，从而结束这场异变吧！", "inputFormat": "- 第一行有一个整数 $n$，表示磁铁的总个数。\n- 接下来 $1$ 行一个整数，表示 $d_0$。\n- 接下来 $n$ 行每行一个整数，其中第 $i$ 行的整数表示 $d_i$。", "outputFormat": "- 输出共 $n$ 行。第 $i$ 行有两个整数 $f_i,a_i$，分别表示磁铁的方向与磁力。若 $f_i=0$ 则表示北极向左，否则若 $f_i=1$ 则表示北极向右。", "hint": "### 样例 1 解释\n\n一种合法的方案中，$c=\\{1,1,0,1\\}$，$a=\\{1,0,1,0\\}$。以下是这种方案的图解。\n\n初始时磁铁的状态如下图所示，磁铁上方的数字是它的磁力大小（即 $4^{a_i}$ 的值），磁铁上标记的 $\\textsf{N/S}$ 是它的磁极。由于笔者能力有限，无法还原出环形，只能用这种传送门的方式扭曲时空了。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tdbb4nqb.png)\n\n容易发现，总长度为 $14$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wmagcu24.png)\n\n拿掉第一块磁铁后的情形如图所示。容易发现，总长度为 $13$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/eipnbj08.png)\n\n拿掉第二块磁铁后的情形如图所示。由于缺少了第二块磁铁的阻挡，第一块和第三块磁铁直接相邻，产生了更大的间距。可以发现，总长度为 $16$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/830j9rz5.png)\n\n拿掉第三块磁铁后的情形如图所示。值得注意的是，所有磁铁北极方向相同，于是直接互相接触，总长度为 $3$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/afqw0jx4.png)\n\n拿掉第四块磁铁后的情形如图所示。由于第三块和第一块磁铁直接相邻（因为是形成了环。在图上则是扭曲后的空间里相邻），因此形成了这种模样。总长度为 $16$。\n\n### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le} & \\textbf{特殊性质} & \\textbf{分值} \\\\\\hline\n1 & 10 & - & 10 \\\\\\hline\n2 & 10^5 & - & 30 \\\\\\hline\n3 & 10^6 & \\text{A} & 5 \\\\\\hline\n4 & 10^6 & - & 55 \\\\\\hline\n\\end{array}$$\n\n**特殊性质** $\\textbf{A}$：保证存在一种方案，所有磁铁的方向一致。\n\n对于所有数据，保证 $1\\leq n\\leq 1\\times10^6$，存在至少一种合法方案。此外，保证 $d_i< 2^{63}$，你构造的 $a_i$ 大小应该在 $[0,10^9]$。", "locale": "zh-CN"}}}
{"pid": "P8543", "type": "P", "difficulty": 6, "samples": [["10 10\n3 2 2 1 2 1 3 2 1 2 \n10 4 10 4 9 8 1 4 9 4 \n3 4\n3 9\n4 8\n3 6\n3 3\n9 10\n5 8\n5 8\n6 8\n5 8\n", "10\n4\n4\n9\n10\n9\n8\n8\n8\n8\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["线段树", "洛谷原创", "O2优化", "洛谷月赛"], "title": "「Wdoi-2」纯粹的复仇女神", "background": ">「因为，人类的历史与成长，就是战争的历史与成长。没有纷争，就没有成长。满足于现状，就等于人类放弃了生存。月之民每天都为地上人考虑着。地上人的历史，就是月之民创造的。」\n\n「我对月之民还是很了解的。这么说吧，她们在各式各样的异世界的居民中，属于最恶劣的那一类。超级排他，超级没自由，虚构的乐园，虽然擅长鄙视别人，但无法容忍自己被当成笨蛋。她们甚至认为其他世界的居民连杂菌都不如。」\n\n「最重要的问题是，月之民敌视着幻想乡，就是这样的。」 \n\n「没想到竟然会把地上人送到月面上来，之前丝毫没有过这种想法呢。那些眼里容不下一点沙子的月之民，竟然会使用这种不入流的手段。」\n\n「幻想乡被作为人质绑架了，可以这么认为吧？要是想拯救幻想乡的话，就不许对月之都动手，就是这种不人道的策略。」\n\n遥遥 $38$ 万公里航程之外，于此故乡之星倒映之海，打败不共戴天之敌，击碎永久不得醒之梦。\n\n> 不倶戴天の敵、$\\stackrel{じょうが}{嫦娥}$よ。見てるか！？    \n> 不共戴天之敌，嫦娥啊。你在看着吗！？", "description": "### 简要题意\n\n给定一个长度为 $n$ 的序列，序列中每个元素是一个二元组 $(c_i,a_i)$，分别表示颜色与权值。\n\n现在有 $q$ 次询问，每次给出一个区间 $[l,r]$，求：\n\n$$\\max\\limits_{k=1}^n \\left\\{\\min\\limits_{l\\le i \\le r,c_i=k} a_i\\right\\}$$\n\n特别地，如果 $[l,r]$ 内没有颜色为 $k$ 的值，后面的部分定义为 $0$。\n### 原始题意\n纯狐的能力是纯化，一旦灵梦身上的污秽被纯化，则必死无疑。\n\n灵梦携带了 $n$ 张一字排开的灵符用于转嫁污秽，但纯狐依旧可以纯化附着在上面的污秽，置灵梦于死地。\n\n具体地，每次纯狐命中一个区间 $[l_i,r_i]$ 中的所有灵符，灵梦需要在此之前净化这些灵符上面的污秽。  \n每张灵符有固定的颜色 $c_i$，经过激烈的战斗，每张灵符上沾染了 $a_i$ 单位的污秽。  \n同种颜色的灵符之间相互作用，净化区间内一批相同颜色的灵符，其灵力花费为这些灵符上污秽的最小值。  \n由于逸散的灵力可以为其他灵符所吸收，灵梦只需知道该区间内所有颜色的灵符净化花费的最大值，此为她净化一次的灵力花费。\n\n给定 $\\{c_i\\}$ 和 $\\{a_i\\}$，每次给出纯狐的一种可能的攻击 $l_i,r_i$，问灵梦净化一次的灵力花费。注意只是计算，每次给出答案后并不改变 $\\{c_i\\}$ 和 $\\{a_i\\}$。", "inputFormat": "第一行两个整数 $n,q$，表示序列长度与询问次数。\n\n第二行 $n$ 个整数，依次为 $c_1,c_2,\\cdots,c_n$。\n\n第三行 $n$ 个整数，依次为 $a_1,a_2,\\cdots,a_n$。\n\n接下来 $q$ 行，每行两个整数 $l,r$，表示每次询问给出的区间。", "outputFormat": "共 $q$ 行，每行一个整数，表示本次询问的答案。", "hint": "### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yu9grxjy.png)\n\n如图，数字代表权值，背景色代表颜色。\n\n- 对于区间 $[3,4]$，出现的两种颜色对应的权值最小值为 $10$ 和 $4$，取最大值答案为 $10$。\n- 对于区间 $[3,9]$，出现的三种颜色对应的权值最小值为 $1,4$ 和 $4$，取最大值答案为 $4$。\n- 对于区间 $[4,8]$，出现的三种颜色对应的权值最小值为 $1,4$ 和 $4$，取最大值答案为 $4$。\n- 对于区间 $[3,6]$，出现的两种颜色对应的权值最小值为 $9$ 和 $4$，取最大值答案为 $9$。\n- 对于区间 $[3,3]$，出现的一种颜色对应的权值最小值为 $10$。\n其余同理。\n\n### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le } & \\bm{q\\le} & \\textbf{特殊性质} & \\textbf{Subtask 依赖} & \\textbf{分值}\\\\\\hline\n1 & 100 & 100 & - & - & 10\\\\\\hline\n2 & 2 \\times 10^5 & 2\\times 10^5 & \\textbf A & - & 20\\\\\\hline\n3 & 2 \\times 10^5 & 2\\times 10^5 & - & 2 & 30\\\\\\hline\n4 & 2 \\times 10^5 & 10^6 & - & 1,3 & 40\\\\\\hline\n\\end{array}\n$$\n\n特殊性质 $\\textbf A$：所有的 $c_i \\leq 10$。\n\n对于全部数据，保证 $1 \\leq n \\leq 2\\times10^5$，$1 \\leq q \\leq 10^6$，$1 \\le c_i,a_i \\le n$，$l \\leq r$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdoi-2」纯粹的复仇女神", "background": ">「因为，人类的历史与成长，就是战争的历史与成长。没有纷争，就没有成长。满足于现状，就等于人类放弃了生存。月之民每天都为地上人考虑着。地上人的历史，就是月之民创造的。」\n\n「我对月之民还是很了解的。这么说吧，她们在各式各样的异世界的居民中，属于最恶劣的那一类。超级排他，超级没自由，虚构的乐园，虽然擅长鄙视别人，但无法容忍自己被当成笨蛋。她们甚至认为其他世界的居民连杂菌都不如。」\n\n「最重要的问题是，月之民敌视着幻想乡，就是这样的。」 \n\n「没想到竟然会把地上人送到月面上来，之前丝毫没有过这种想法呢。那些眼里容不下一点沙子的月之民，竟然会使用这种不入流的手段。」\n\n「幻想乡被作为人质绑架了，可以这么认为吧？要是想拯救幻想乡的话，就不许对月之都动手，就是这种不人道的策略。」\n\n遥遥 $38$ 万公里航程之外，于此故乡之星倒映之海，打败不共戴天之敌，击碎永久不得醒之梦。\n\n> 不倶戴天の敵、$\\stackrel{じょうが}{嫦娥}$よ。見てるか！？    \n> 不共戴天之敌，嫦娥啊。你在看着吗！？", "description": "### 简要题意\n\n给定一个长度为 $n$ 的序列，序列中每个元素是一个二元组 $(c_i,a_i)$，分别表示颜色与权值。\n\n现在有 $q$ 次询问，每次给出一个区间 $[l,r]$，求：\n\n$$\\max\\limits_{k=1}^n \\left\\{\\min\\limits_{l\\le i \\le r,c_i=k} a_i\\right\\}$$\n\n特别地，如果 $[l,r]$ 内没有颜色为 $k$ 的值，后面的部分定义为 $0$。\n### 原始题意\n纯狐的能力是纯化，一旦灵梦身上的污秽被纯化，则必死无疑。\n\n灵梦携带了 $n$ 张一字排开的灵符用于转嫁污秽，但纯狐依旧可以纯化附着在上面的污秽，置灵梦于死地。\n\n具体地，每次纯狐命中一个区间 $[l_i,r_i]$ 中的所有灵符，灵梦需要在此之前净化这些灵符上面的污秽。  \n每张灵符有固定的颜色 $c_i$，经过激烈的战斗，每张灵符上沾染了 $a_i$ 单位的污秽。  \n同种颜色的灵符之间相互作用，净化区间内一批相同颜色的灵符，其灵力花费为这些灵符上污秽的最小值。  \n由于逸散的灵力可以为其他灵符所吸收，灵梦只需知道该区间内所有颜色的灵符净化花费的最大值，此为她净化一次的灵力花费。\n\n给定 $\\{c_i\\}$ 和 $\\{a_i\\}$，每次给出纯狐的一种可能的攻击 $l_i,r_i$，问灵梦净化一次的灵力花费。注意只是计算，每次给出答案后并不改变 $\\{c_i\\}$ 和 $\\{a_i\\}$。", "inputFormat": "第一行两个整数 $n,q$，表示序列长度与询问次数。\n\n第二行 $n$ 个整数，依次为 $c_1,c_2,\\cdots,c_n$。\n\n第三行 $n$ 个整数，依次为 $a_1,a_2,\\cdots,a_n$。\n\n接下来 $q$ 行，每行两个整数 $l,r$，表示每次询问给出的区间。", "outputFormat": "共 $q$ 行，每行一个整数，表示本次询问的答案。", "hint": "### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yu9grxjy.png)\n\n如图，数字代表权值，背景色代表颜色。\n\n- 对于区间 $[3,4]$，出现的两种颜色对应的权值最小值为 $10$ 和 $4$，取最大值答案为 $10$。\n- 对于区间 $[3,9]$，出现的三种颜色对应的权值最小值为 $1,4$ 和 $4$，取最大值答案为 $4$。\n- 对于区间 $[4,8]$，出现的三种颜色对应的权值最小值为 $1,4$ 和 $4$，取最大值答案为 $4$。\n- 对于区间 $[3,6]$，出现的两种颜色对应的权值最小值为 $9$ 和 $4$，取最大值答案为 $9$。\n- 对于区间 $[3,3]$，出现的一种颜色对应的权值最小值为 $10$。\n其余同理。\n\n### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n\\le } & \\bm{q\\le} & \\textbf{特殊性质} & \\textbf{Subtask 依赖} & \\textbf{分值}\\\\\\hline\n1 & 100 & 100 & - & - & 10\\\\\\hline\n2 & 2 \\times 10^5 & 2\\times 10^5 & \\textbf A & - & 20\\\\\\hline\n3 & 2 \\times 10^5 & 2\\times 10^5 & - & 2 & 30\\\\\\hline\n4 & 2 \\times 10^5 & 10^6 & - & 1,3 & 40\\\\\\hline\n\\end{array}\n$$\n\n特殊性质 $\\textbf A$：所有的 $c_i \\leq 10$。\n\n对于全部数据，保证 $1 \\leq n \\leq 2\\times10^5$，$1 \\leq q \\leq 10^6$，$1 \\le c_i,a_i \\le n$，$l \\leq r$。", "locale": "zh-CN"}}}
{"pid": "P8544", "type": "P", "difficulty": 7, "samples": [["2 2 2\n9 9\n6 1", "252"], ["10 10 10\n2 8 10 10 10 2 5 8 9 3\n2 1 5 2 10 7 8 9 10 6\n", "8040\n"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "二分", "洛谷原创", "O2优化", "凸完全单调性（wqs 二分）", "洛谷月赛"], "title": "「Wdoi-2」禁断之门对面，是此世还是彼世", "background": "或许是后户之国轻易不与外界联系，或许是神职所限，又或许是性格喜好的原因，摩多罗作为最初建立幻想乡的几位贤者之一，和其他贤者之间的联系并不频繁。其他如八云紫、茨木华扇等贤者均亲身走在幻想乡之中，而摩多罗却置身之外。\n\n耗费神力发动全幻想乡级别的异变，看似规模宏大，其实并未对幻想乡造成真正的伤害，只是让一群笨蛋妖精狂躁了些而已。 \n\n谁也不知道门后的秘神心中真正的想法。", "description": "给定一场长度为 $n$ 的正整数序列 $a$ 和一个长度为 $m$ 的正整数序列 $b$。\n\n现在蓝根据序列 $a$ 与序列 $b$ 构造了一个 $n$ 行 $m$ 列的正整数矩阵 $A$ 满足 $A_{i,j}=a_ib_j$，你需要构造 $n+1$ 行 $t$ 列的正整数矩阵 $B$ 满足以下条件：\n\n- 矩阵的每个元素取值在 $[1,m]$ 间；\n- 矩阵同一行的元素**两两**不相同；\n- 矩阵的每列**相邻元素**不同；\n- 在所有满足上面三项要求的矩阵中**最小化**下式：\n$$f(B)=\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{t}\\sum\\limits_{k=\\min(B_{i,j},B_{i+1,j})}^{\\max(B_{i,j},B_{i+1,j})}A_{i,k}$$\n\n请输出构造出的 $B$ 矩阵的 $f(B)$ 的值模 $10^9+7$ 的结果。", "inputFormat": "第一行三个整数 $n,m,t$。\n\n接下来一行 $n$ 个整数 $a_1,a_2,\\cdots a_n$，含义如题面中所述。\n\n接下来一行 $m$ 个整数 $b_1,b_2,\\cdots b_m$，含义如题面中所述。\n\n", "outputFormat": "输出一行，表示构造出的 $B$ 矩阵的 $f(B)$ 的值模 $10^9+7$ 的结果。", "hint": "### 样例解释 1\n\n根据题意，可以构造出矩阵 $A=\\begin{bmatrix}54 & 9 \\\\ 54 & 9 \\end{bmatrix}$。\n\n你需要构造出的 $3$ 行 $2$ 列的矩阵 $B=\\begin{bmatrix}1 & 2 \\\\ 2 & 1 \\\\ 1 & 2 \\end{bmatrix}$，此时 $f(B)=252$ 为最小值\n\n可以证明 $f(B)=252$ 为所有情况中，$f(B)$ 的最小值。\n\n### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n \\le } & \\bm{m \\le } & \\bm{t \\le } & \\textbf{特殊性质} & \\textbf{分值}\\\\\\hline\n1 & 10 & 10 & 10 & - & 5 \\\\\\hline\n2 & 100 & 100 & 100 & - & 5 \\\\\\hline\n3 & 10^3 & 10^3 & 10^3 & - & 15 \\\\\\hline\n4 & 5\\times 10^4 & 5\\times 10^4 & 5\\times 10^4 & - & 30 \\\\\\hline\n5 & 5\\times 10^5 & 5\\times 10^5 & 5\\times 10^5 & \\textbf{A} & 10 \\\\\\hline\n6 & 5\\times 10^5 & 5\\times 10^5 & 5\\times 10^5 & \\textbf{B} & 10 \\\\\\hline\n7 & 5\\times 10^5 & 5\\times 10^5 & 5\\times 10^5 & - & 25 \\\\\\hline\n\\end{array}$$\n\n- **特殊性质** $\\textbf{A}$：保证 $a_i=1$；\n- **特殊性质** $\\textbf{B}$：保证 $m=t$。\n\n对于全部数据，保证 $1\\le a_i, b_i\\le 10^9$，$1\\le n, m, t\\le 5\\times 10^5 $，$t\\le m$。保证数据有解。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「Wdoi-2」禁断之门对面，是此世还是彼世", "background": "或许是后户之国轻易不与外界联系，或许是神职所限，又或许是性格喜好的原因，摩多罗作为最初建立幻想乡的几位贤者之一，和其他贤者之间的联系并不频繁。其他如八云紫、茨木华扇等贤者均亲身走在幻想乡之中，而摩多罗却置身之外。\n\n耗费神力发动全幻想乡级别的异变，看似规模宏大，其实并未对幻想乡造成真正的伤害，只是让一群笨蛋妖精狂躁了些而已。 \n\n谁也不知道门后的秘神心中真正的想法。", "description": "给定一场长度为 $n$ 的正整数序列 $a$ 和一个长度为 $m$ 的正整数序列 $b$。\n\n现在蓝根据序列 $a$ 与序列 $b$ 构造了一个 $n$ 行 $m$ 列的正整数矩阵 $A$ 满足 $A_{i,j}=a_ib_j$，你需要构造 $n+1$ 行 $t$ 列的正整数矩阵 $B$ 满足以下条件：\n\n- 矩阵的每个元素取值在 $[1,m]$ 间；\n- 矩阵同一行的元素**两两**不相同；\n- 矩阵的每列**相邻元素**不同；\n- 在所有满足上面三项要求的矩阵中**最小化**下式：\n$$f(B)=\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{t}\\sum\\limits_{k=\\min(B_{i,j},B_{i+1,j})}^{\\max(B_{i,j},B_{i+1,j})}A_{i,k}$$\n\n请输出构造出的 $B$ 矩阵的 $f(B)$ 的值模 $10^9+7$ 的结果。", "inputFormat": "第一行三个整数 $n,m,t$。\n\n接下来一行 $n$ 个整数 $a_1,a_2,\\cdots a_n$，含义如题面中所述。\n\n接下来一行 $m$ 个整数 $b_1,b_2,\\cdots b_m$，含义如题面中所述。\n\n", "outputFormat": "输出一行，表示构造出的 $B$ 矩阵的 $f(B)$ 的值模 $10^9+7$ 的结果。", "hint": "### 样例解释 1\n\n根据题意，可以构造出矩阵 $A=\\begin{bmatrix}54 & 9 \\\\ 54 & 9 \\end{bmatrix}$。\n\n你需要构造出的 $3$ 行 $2$ 列的矩阵 $B=\\begin{bmatrix}1 & 2 \\\\ 2 & 1 \\\\ 1 & 2 \\end{bmatrix}$，此时 $f(B)=252$ 为最小值\n\n可以证明 $f(B)=252$ 为所有情况中，$f(B)$ 的最小值。\n\n### 数据范围及约定\n\n$$\n\\def\\arraystretch{1.5}\n\\begin{array}{|c|c|c|c|c|c|}\\hline\n\\textbf{Subtask} & \\bm{n \\le } & \\bm{m \\le } & \\bm{t \\le } & \\textbf{特殊性质} & \\textbf{分值}\\\\\\hline\n1 & 10 & 10 & 10 & - & 5 \\\\\\hline\n2 & 100 & 100 & 100 & - & 5 \\\\\\hline\n3 & 10^3 & 10^3 & 10^3 & - & 15 \\\\\\hline\n4 & 5\\times 10^4 & 5\\times 10^4 & 5\\times 10^4 & - & 30 \\\\\\hline\n5 & 5\\times 10^5 & 5\\times 10^5 & 5\\times 10^5 & \\textbf{A} & 10 \\\\\\hline\n6 & 5\\times 10^5 & 5\\times 10^5 & 5\\times 10^5 & \\textbf{B} & 10 \\\\\\hline\n7 & 5\\times 10^5 & 5\\times 10^5 & 5\\times 10^5 & - & 25 \\\\\\hline\n\\end{array}$$\n\n- **特殊性质** $\\textbf{A}$：保证 $a_i=1$；\n- **特殊性质** $\\textbf{B}$：保证 $m=t$。\n\n对于全部数据，保证 $1\\le a_i, b_i\\le 10^9$，$1\\le n, m, t\\le 5\\times 10^5 $，$t\\le m$。保证数据有解。", "locale": "zh-CN"}}}
