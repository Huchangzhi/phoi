{"pid": "P4499", "type": "P", "difficulty": 7, "samples": [["3 1 3\n1 2 4\n1 2 5\n2 3 3\n3 3 1", "1.00"], ["1 1 1\n1 1 100\n1 1 1", "10.00"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "CTSC/CTS"], "title": "[CTSC2011] 无穷图的桥", "background": null, "description": "本题的目标是求一个点数无穷的无向图的桥。\n\n这个无向图具有如下性质：\n\n1. 这个图是一个连通图。\n\n2. 这个图的所有节点分为若干层，分别是第 $1$ 层、第 $2$ 层、第 $3$ 层 $\\cdots$ 共有无穷层，每层共有 $n$ 个节点。为了描述方便，以下用 $\\left(i, x\\right)$ 表示第 $i$ 层的 $x$ 号节点。\n\n3. 同一层内的节点可以相互连边，相邻两层的节点之间可以相互连边，除此之外，其他节点之间不能相互连边。\n\n4. 如果 $\\left(i, x\\right)$ 与 $\\left(i, y\\right)$ 之间有一条权值为 $d$ 的边，那么 $\\left(j, x\\right)$ 与 $\\left(j, y\\right)$ 之间也有一条边，它的权值为 $0.9^{j-i}d$，其中 $j$ 为任意正整数。\n\n5. 如果 $\\left(i, x\\right)$ 与 $\\left(i + 1, y\\right)$ 之间有一条权值为 $d$ 的边，那么 $\\left(j, x\\right)$ 与 $\\left(j+1, y\\right)$ 之间也有一条边，它的权值为 $0.9^{j-i}d$，其中 $j$ 为任意正整数。如下所示的无向图就符合上面的所有性质。\n\n\n一个点数无穷的无向图是连通的，当且仅当对于图中的任意两个节点都存在一条路径将它们连接起来。而一条边是桥，当且仅当这条边被删去后整个图不连通。\n\n![](https://cdn.luogu.com.cn/upload/pic/18051.png )\n\n请你编写程序读入这个点数无穷的连通图，求出其中所有桥的权值之和。例如，在上图中，粗线所示的边就是该图唯一的桥，因此上图中桥的权值之和为 $1$。", "inputFormat": "输入文件 infinite.in 第一行包括三个由空格隔开的非负数 $n$、$m_1$、$m_2$。从第 $2$ 行到第 $m_1+ 1$ 行，每行有三个正整数 $x$、$y$、$d$，表示 $\\left(1, x\\right)$ 与 $\\left(1, y\\right)$ 之间有一条权值为 $d$ 的边。\n\n从第 $m_1+ 2$ 行到第 $m_1+ m_2+ 1$ 行，每行有三个正整数 $x$、$y$、$d$，表示 $\\left(1, x\\right)$ 与 $\\left(2, y\\right)$ 之间有一条权值为 $d$ 的边。每行的三个整数之间都用一个空格隔开。\n\n图中两个点 $x$ 和 $y$ 之间可能有多于 $1$ 条边连接，一条边连接的两个节点可能相同。", "outputFormat": "输出文件 infinite.out 只有一行，包含一个实数，即所有桥的权值之和，四舍五入保留两位小数。", "hint": "## 【样例说明 1】\n\n这就是问题描述中所举的例子。\n\n## 【数据规模】\n\n::cute-table{tuack}\n\n| 数据编号 | $n$ | $m_1$ | $m_2$ |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| 1 | $\\leq10$ | $\\leq50$ | $\\leq50$ |\n| 2 | $\\leq10000$ | $\\leq40000$ | $\\leq40000$ |\n| 3 | $\\leq3 \\times 10^5$ | $\\leq5 \\times 10^5$ | $=1$ |\n| 4~7 | ^ | ^ | $\\leq500$ |\n| 8~10 | ^ | ^ | $\\leq500000$ |\n\n100% 的数据中，$d\\leq 100$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2011] Bridges of the Infinite Graph", "background": "", "description": "The goal is to find all bridges in an undirected graph with infinitely many nodes.\n\nThis undirected graph has the following properties:\n1. The graph is connected.\n2. All nodes are partitioned into infinitely many layers: layer $1$, layer $2$, layer $3$, $\\cdots$, with $n$ nodes in each layer. For convenience, we denote the $x$-th node in layer $i$ by $(i, x)$.\n3. Edges are allowed between nodes within the same layer, and between nodes in adjacent layers. No other edges are allowed.\n4. If there is an edge of weight $d$ between $(i, x)$ and $(i, y)$, then for any positive integer $j$, there is also an edge between $(j, x)$ and $(j, y)$ with weight $0.9^{j-i} d$, where $j$ is any positive integer.\n5. If there is an edge of weight $d$ between $(i, x)$ and $(i + 1, y)$, then for any positive integer $j$, there is also an edge between $(j, x)$ and $(j + 1, y)$ with weight $0.9^{j-i} d$, where $j$ is any positive integer. The undirected graph shown below satisfies all the properties above.\n\nAn undirected graph with infinitely many nodes is connected if and only if there exists a path between any pair of nodes in the graph. An edge is a bridge if and only if removing it makes the entire graph disconnected.\n\n![](https://cdn.luogu.com.cn/upload/pic/18051.png)\n\nPlease write a program to read this connected infinite graph and compute the sum of weights of all its bridges. For example, in the figure above, the bold edge is the unique bridge, so the sum of weights of bridges is $1$.", "inputFormat": "The input file infinite.in contains three space-separated non-negative integers on the first line: $n$, $m_1$, and $m_2$.  \nFrom line $2$ to line $m_1 + 1$, each line contains three positive integers $x$, $y$, and $d$, indicating that there is an edge of weight $d$ between $(1, x)$ and $(1, y)$.\n\nFrom line $m_1 + 2$ to line $m_1 + m_2 + 1$, each line contains three positive integers $x$, $y$, and $d$, indicating that there is an edge of weight $d$ between $(1, x)$ and $(2, y)$. Each line’s three integers are separated by a single space.\n\nThere may be more than one edge between nodes $x$ and $y$. Self-loops are allowed.", "outputFormat": "The output file infinite.out contains exactly one line with a real number: the sum of weights of all bridges, rounded to two decimal places.", "hint": "[Sample Explanation 1]  \nThis is the same as the example given in the problem statement.\n\nConstraints\n|||||\n| :----------- | :----------- | :----------- | :----------- |\n| Data ID | $n$ | $m_1$ | $m_2$ |\n| 1 | $\\leq 10$ | $\\leq 50$ | $\\leq 50$ |\n| 2 | $\\leq 10000$ | $\\leq 40000$ | $\\leq 40000$ |\n| 3 | $\\leq 300000$ | $\\leq 500000$ | $=1$ |\n| 4~7 | $\\leq 300000$ | $\\leq 500000$ | $\\leq 500$ |\n| 8~10 | $\\leq 300000$ | $\\leq 500000$ | $\\leq 500000$ |\n\nIn 100% of the testdata, $d \\leq 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2011] 无穷图的桥", "background": null, "description": "本题的目标是求一个点数无穷的无向图的桥。\n\n这个无向图具有如下性质：\n\n1. 这个图是一个连通图。\n\n2. 这个图的所有节点分为若干层，分别是第 $1$ 层、第 $2$ 层、第 $3$ 层 $\\cdots$ 共有无穷层，每层共有 $n$ 个节点。为了描述方便，以下用 $\\left(i, x\\right)$ 表示第 $i$ 层的 $x$ 号节点。\n\n3. 同一层内的节点可以相互连边，相邻两层的节点之间可以相互连边，除此之外，其他节点之间不能相互连边。\n\n4. 如果 $\\left(i, x\\right)$ 与 $\\left(i, y\\right)$ 之间有一条权值为 $d$ 的边，那么 $\\left(j, x\\right)$ 与 $\\left(j, y\\right)$ 之间也有一条边，它的权值为 $0.9^{j-i}d$，其中 $j$ 为任意正整数。\n\n5. 如果 $\\left(i, x\\right)$ 与 $\\left(i + 1, y\\right)$ 之间有一条权值为 $d$ 的边，那么 $\\left(j, x\\right)$ 与 $\\left(j+1, y\\right)$ 之间也有一条边，它的权值为 $0.9^{j-i}d$，其中 $j$ 为任意正整数。如下所示的无向图就符合上面的所有性质。\n\n\n一个点数无穷的无向图是连通的，当且仅当对于图中的任意两个节点都存在一条路径将它们连接起来。而一条边是桥，当且仅当这条边被删去后整个图不连通。\n\n![](https://cdn.luogu.com.cn/upload/pic/18051.png )\n\n请你编写程序读入这个点数无穷的连通图，求出其中所有桥的权值之和。例如，在上图中，粗线所示的边就是该图唯一的桥，因此上图中桥的权值之和为 $1$。", "inputFormat": "输入文件 infinite.in 第一行包括三个由空格隔开的非负数 $n$、$m_1$、$m_2$。从第 $2$ 行到第 $m_1+ 1$ 行，每行有三个正整数 $x$、$y$、$d$，表示 $\\left(1, x\\right)$ 与 $\\left(1, y\\right)$ 之间有一条权值为 $d$ 的边。\n\n从第 $m_1+ 2$ 行到第 $m_1+ m_2+ 1$ 行，每行有三个正整数 $x$、$y$、$d$，表示 $\\left(1, x\\right)$ 与 $\\left(2, y\\right)$ 之间有一条权值为 $d$ 的边。每行的三个整数之间都用一个空格隔开。\n\n图中两个点 $x$ 和 $y$ 之间可能有多于 $1$ 条边连接，一条边连接的两个节点可能相同。", "outputFormat": "输出文件 infinite.out 只有一行，包含一个实数，即所有桥的权值之和，四舍五入保留两位小数。", "hint": "## 【样例说明 1】\n\n这就是问题描述中所举的例子。\n\n## 【数据规模】\n\n::cute-table{tuack}\n\n| 数据编号 | $n$ | $m_1$ | $m_2$ |\n| :-----------: | :-----------: | :-----------: | :-----------: |\n| 1 | $\\leq10$ | $\\leq50$ | $\\leq50$ |\n| 2 | $\\leq10000$ | $\\leq40000$ | $\\leq40000$ |\n| 3 | $\\leq3 \\times 10^5$ | $\\leq5 \\times 10^5$ | $=1$ |\n| 4~7 | ^ | ^ | $\\leq500$ |\n| 8~10 | ^ | ^ | $\\leq500000$ |\n\n100% 的数据中，$d\\leq 100$。", "locale": "zh-CN"}}}
{"pid": "P4500", "type": "P", "difficulty": 7, "samples": [["2 2 998244353\n", "1"], ["3 2 998244353", "499122177"], ["4 2 998244353", "332748118"], ["10 2 998244353", "113919852"], ["50 233 998244353", "634280054"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "各省省选", "浙江"], "title": "[ZJOI2018] 树", "background": "", "description": "九条可怜是一个热爱出题的女孩子。\n\n虽然出题本身是一件非常有趣的事情，但是要把题目给出成正式比赛,就不是那么有趣了：造数据总是一件让人心力憔悴的事情。\n\n在 ZJOI2018 Day 1 中，可怜出了一道和树相关的非常有趣的题，她打算采用一种常用的方式随机生成一棵 $n$ 个节点的有根树：\n\n- 节点 1 作为树的根。\n- 对于 $i \\in [2, n]$ ，独立地从 $[1, i)$ 中等概率随机选取一个节点作为 $i$ 的父亲。\n\n可怜不是很想考虑这样随机出来的数据能不能卡掉暴力,毕竟乱搞也是 OI 比赛的一部分。\n\n可怜比较在意的是题目的区分度，以及是不是所有可能的分数都出现了。因此，可怜希望任何两个测试点的树是有区别的：这样就可能会有错误的程序能只通过其中一个点。\n\n因此，可怜想要计算，通过上面的方法独立的随机生成 $k$ 棵 $n$ 个节点的有根树 $T_1$ 至 $T_k$ ，他们两两同构的概率是多少。\n\n两棵 $n$ 个节点的有根树 $T_1$ 和 $T_2$ 同构当且仅当存在长度为 $n$ 的排列 $p$，满足 $p_1 = 1$ ，且对于 $\\forall i \\in [2, n]$ ，若 $i$ 在 $T_1$ 的父亲是 $f$ ，则 $p_i$ 在 $T_2$ 的父亲是 $p_f$ 。", "inputFormat": "第一行输入三个整数 $n, k, p$，表示节点个数，树的个数以及模数。输入保证 $10^8 \\leq p \\leq 10^9$ 且 $p$ 是质数。", "outputFormat": "输出一行一个整数，表示答案对 $p$ 取模后的值。即如果答案的最简分数表示为 $\\frac{a}{b}$ ，输出 $a \\times b ^{-1} \\bmod p$。\n", "hint": "### 样例解释\n\n在第一组数据中，能够生成的树是唯一的,因此生成的两棵树必定相同。\n\n在第二组数据中，能够生成的树只有两种,他们是不同构的。因此生成的两棵树同构的概率为 $\\frac{1}{2}$ ，在模 998244353 意义下为 499122177。\n\n在第三组数据中，能够生成的树有 6 种,如下图所示。其中第二、三、四棵(第一排中间三棵)是同构的,其余两两不同构。因此生成的两棵树同构的概率为 $\\frac{1}{3}$ ，在模998244353 意义下为 332748118。\n\n![](https://cdn.luogu.com.cn/upload/pic/18417.png)\n\n\n### 数据范围\n\n测试点|　$n$|　$k$|测试点|　$n$|　$k$\n-|-|-|-|-|-\n1|$\\le 5$|$=2$|6|$\\le 50$|$\\le 10^9$\n2|$\\le 10$|$=2$|7|$\\le 200$|$\\le 10^9$\n3|$\\le 20$|$=2$|8|$\\le 500$|$\\le 10^9$\n4|$\\le 50$|$=2$|9|$\\le 1000$|$\\le 10^9$\n5|$\\le 50$|$=2$|10|$\\le 2000$|$\\le 10^9$\n\n对于 100% 的数据,保证 $p$ 是质数且 $10^8 \\le p \\le 10^9 $。\n\n感谢 @Xeonacid 提供题面", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2018] Tree", "background": "", "description": "Jiutiao Kelian (pinyin) is a girl who loves to write problems.\n\nAlthough writing problems itself is very interesting, turning a problem into an official contest task is not so fun: generating testdata is always exhausting.\n\nIn ZJOI 2018 Day 1, Kelian set a very interesting problem about trees. She plans to use a common method to randomly generate a rooted tree with $n$ nodes:\n\n- Node $1$ is the root of the tree.\n- For $i \\in [2, n]$, independently and uniformly at random pick a node from $[1, i)$ as the parent of $i$.\n\nKelian does not really want to think about whether such randomly generated testdata can defeat brute force, since hacking around is also part of OI contests.\n\nWhat Kelian cares about more is the problem's discriminative power, and whether all possible scores appear. Therefore, she hopes that the trees in any two test points are different, so that an incorrect program might pass only one of them.\n\nThus, Kelian wants to compute the probability that, by independently generating $k$ rooted trees with $n$ nodes $T_1$ to $T_k$ using the method above, they are pairwise isomorphic.\n\nTwo rooted trees $T_1$ and $T_2$ with $n$ nodes are isomorphic if and only if there exists a permutation $p$ of length $n$, satisfying $p_1 = 1$, and for all $i \\in [2, n]$, if the parent of $i$ in $T_1$ is $f$, then the parent of $p_i$ in $T_2$ is $p_f$.", "inputFormat": "The first line contains three integers $n, k, p$, denoting the number of nodes, the number of trees, and the modulus. It is guaranteed that $10^8 \\leq p \\leq 10^9$ and $p$ is prime.", "outputFormat": "Output a single integer, the answer modulo $p$. That is, if the answer in lowest terms is $\\frac{a}{b}$, output $a \\times b ^{-1} \\bmod p$.", "hint": "Sample Explanation\n\nIn the first sample, the generated tree is unique, so the two generated trees are necessarily identical.\n\nIn the second sample, there are only two possible generated trees, and they are non-isomorphic. Therefore, the probability that the two generated trees are isomorphic is $\\frac{1}{2}$, which is $499122177$ modulo $998244353$.\n\nIn the third sample, there are $6$ possible generated trees, as shown below. Among them, the second, third, and fourth (the middle three in the first row) are isomorphic, and the remaining ones are pairwise non-isomorphic. Therefore, the probability that the two generated trees are isomorphic is $\\frac{1}{3}$, which is $332748118$ modulo $998244353$.\n\n![](https://cdn.luogu.com.cn/upload/pic/18417.png)\n\nConstraints\n\n测试点| $n$| $k$|测试点| $n$| $k$\n-|-|-|-|-|-\n1|$\\le 5$|$=2$|6|$\\le 50$|$\\le 10^9$\n2|$\\le 10$|$=2$|7|$\\le 200$|$\\le 10^9$\n3|$\\le 20$|$=2$|8|$\\le 500$|$\\le 10^9$\n4|$\\le 50$|$=2$|9|$\\le 1000$|$\\le 10^9$\n5|$\\le 50$|$=2$|10|$\\le 2000$|$\\le 10^9$\n\nFor $100\\%$ of the testdata, it is guaranteed that $p$ is prime and $10^8 \\le p \\le 10^9$.\n\nThanks to @Xeonacid for providing the statement.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2018] 树", "background": "", "description": "九条可怜是一个热爱出题的女孩子。\n\n虽然出题本身是一件非常有趣的事情，但是要把题目给出成正式比赛,就不是那么有趣了：造数据总是一件让人心力憔悴的事情。\n\n在 ZJOI2018 Day 1 中，可怜出了一道和树相关的非常有趣的题，她打算采用一种常用的方式随机生成一棵 $n$ 个节点的有根树：\n\n- 节点 1 作为树的根。\n- 对于 $i \\in [2, n]$ ，独立地从 $[1, i)$ 中等概率随机选取一个节点作为 $i$ 的父亲。\n\n可怜不是很想考虑这样随机出来的数据能不能卡掉暴力,毕竟乱搞也是 OI 比赛的一部分。\n\n可怜比较在意的是题目的区分度，以及是不是所有可能的分数都出现了。因此，可怜希望任何两个测试点的树是有区别的：这样就可能会有错误的程序能只通过其中一个点。\n\n因此，可怜想要计算，通过上面的方法独立的随机生成 $k$ 棵 $n$ 个节点的有根树 $T_1$ 至 $T_k$ ，他们两两同构的概率是多少。\n\n两棵 $n$ 个节点的有根树 $T_1$ 和 $T_2$ 同构当且仅当存在长度为 $n$ 的排列 $p$，满足 $p_1 = 1$ ，且对于 $\\forall i \\in [2, n]$ ，若 $i$ 在 $T_1$ 的父亲是 $f$ ，则 $p_i$ 在 $T_2$ 的父亲是 $p_f$ 。", "inputFormat": "第一行输入三个整数 $n, k, p$，表示节点个数，树的个数以及模数。输入保证 $10^8 \\leq p \\leq 10^9$ 且 $p$ 是质数。", "outputFormat": "输出一行一个整数，表示答案对 $p$ 取模后的值。即如果答案的最简分数表示为 $\\frac{a}{b}$ ，输出 $a \\times b ^{-1} \\bmod p$。\n", "hint": "### 样例解释\n\n在第一组数据中，能够生成的树是唯一的,因此生成的两棵树必定相同。\n\n在第二组数据中，能够生成的树只有两种,他们是不同构的。因此生成的两棵树同构的概率为 $\\frac{1}{2}$ ，在模 998244353 意义下为 499122177。\n\n在第三组数据中，能够生成的树有 6 种,如下图所示。其中第二、三、四棵(第一排中间三棵)是同构的,其余两两不同构。因此生成的两棵树同构的概率为 $\\frac{1}{3}$ ，在模998244353 意义下为 332748118。\n\n![](https://cdn.luogu.com.cn/upload/pic/18417.png)\n\n\n### 数据范围\n\n测试点|　$n$|　$k$|测试点|　$n$|　$k$\n-|-|-|-|-|-\n1|$\\le 5$|$=2$|6|$\\le 50$|$\\le 10^9$\n2|$\\le 10$|$=2$|7|$\\le 200$|$\\le 10^9$\n3|$\\le 20$|$=2$|8|$\\le 500$|$\\le 10^9$\n4|$\\le 50$|$=2$|9|$\\le 1000$|$\\le 10^9$\n5|$\\le 50$|$=2$|10|$\\le 2000$|$\\le 10^9$\n\n对于 100% 的数据,保证 $p$ 是质数且 $10^8 \\le p \\le 10^9 $。\n\n感谢 @Xeonacid 提供题面", "locale": "zh-CN"}}}
{"pid": "P4501", "type": "P", "difficulty": 6, "samples": [["5 5\n2 3 1 4\n1 2 2\n2 1 1 4 10\n3 1 1 3 1 5 1\n3 1 10 2 100 5 1\n5 1 1 2 1 3 1 4 1 5 1", "5\n8\n5\n8\n5"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2018", "线段树", "二分", "各省省选", "浙江", "ST 表"], "title": "[ZJOI2018] 胖", "background": "Cedyks 是九条可怜的好朋友（可能这场比赛公开以后就不是了），也是这题的主人公。", "description": "Cedyks 是一个富有的男孩子。他住在著名的 The Place（宫殿）中。\n\nCedyks 是一个努力的男孩子。他每天都做着不一样的题来锻炼他的 The Salt（灵魂）。\n\n这天，他打算在他的宫殿外围修筑一道城墙，城墙上有 $n$ 座瞭望塔。你可以把城墙看做一条线段，瞭望塔是线段上的 $n$ 个点，其中 $1$ 和 $n$ 分别为城墙的两个端点。其中第 $i$ 座瞭望塔和第 $i + 1$ 座瞭望塔的距离为 $w_i$，他们之间的道路是双向的。\n\n城墙很快就修建好了，现在 Cedyks 开始计划修筑他的宫殿到城墙的道路。因为这题的题目名称，Cedyks 打算用他的宫殿到每一个瞭望塔的最短道路之和来衡量一个修建计划。\n\n现在 Cedyks 手上有 $m$ 个设计方案，第 $k$ 个设计方案会在宫殿和瞭望塔之间修建 $T_k$ 条双向道路，第 $i$ 条道路连接着瞭望塔 $a_i$，长度为 $l_i$。\n\n计算到每一个瞭望塔的最短路之和是一个繁重的工程，本来 Cedyks 想用广为流传的 SPFA 算法来求解，但是因为他的 butter（缓冲区）实在是太小了，他只能转而用原始的贝尔福特曼算法来计算，算法的流程大概如下：\n\n1. 定义宫殿是 $0$ 号点，第 $i$ 个瞭望塔是 $i$ 号点，双向边 $(u_i, v_i, l_i)$ 为一条连接 $u_i$ 和 $v_i$ 的双向道路。令 $d$ 为距离数组，最开始 $d_0 = 0, d_i = 10^{18}(i ∈ [1, n])$。\n2. 令辅助数组 $c = d$。依次对于每一条边 $(u_i, v_i,w_i)$ 进行增广，$c_{u_i} = \\min(c_{u_i} , d_{v_i} + w_i)$，$c_{v_i} = \\min(c_{v_i} , d_{u_i} + w_i)$。\n3. 令 $t$ 为 $c$ 和 $d$ 中不一样的位置个数，即令 $S = \\{i|c_i≠d_i\\}$，则 $t = |S|$。若 $t = 0$，说明 $d$ 就是最终的最短路，算法结束。否则令 $d = c$，回到第二步。\n\n因为需要计算的设计方案实在是太多了，所以 Cedyks 雇佣了一些人来帮他进行计算。为了避免这些人用捏造出来的数据偷懒，他定义一个设计方案的校验值为在这个方案上运行贝尔福特曼算法每一次进入第三步 $t$ 的和。他会让好几个雇佣来的人计算同样的设计方案，并比对每一个人给出的校验值。\n\n你是 Cedyks 雇佣来的苦力之一，聪明的你发现在这个情形下计算最短路的长度的和是一件非常简单的事情。但是寄人篱下不得不低头，你不得不再计算出每一个方案的校验值来交差。", "inputFormat": "第一行输入两个整数 $n,m$，表示瞭望塔个数和设计方案个数。\n\n接下来一行 $n - 1$ 个数 $w_i$，表示瞭望塔 $i$ 和 $i + 1$ 之间道路的长度。\n\n接下来 $m$ 行，每行描述一个设计方案。第一个整数 $K$ 表示设计方案中的道路数量，接下来 $K$ 个数对 $(a_i, l_i)$ 为一条宫殿到瞭望塔的边。", "outputFormat": "对于每一个设计方案，输出一行一个整数表示校验值。", "hint": "### 样例解释\n\n对于第一个设计方案，每一个阶段 $d$ 的变化为：\n\n- $[0,10^{18},10^{18},10^{18},10^{18},10^{18}] \\rightarrow [0,10^{18},2,10^{18},10^{18},10^{18}] \\rightarrow$ $[0,4,2,5,10^{18},10^{18}] \\rightarrow [0,4,2,5,6,10^{18}] \\rightarrow [0,4,2,5,6,10]$。\n\n因此校验值为 $1+2+1+1=5$。\n\n对于第二个设计方案，每一个阶段 $d$ 的变化为：\n\n- $[0,10^{18},10^{18},10^{18},10^{18},10^{18}] \\rightarrow [0,1,10^{18},10^{18},10,10^{18}] \\rightarrow$ $[0,1,3,11,10,14] \\rightarrow [0,1,3,6,10,14] \\rightarrow [0,1,3,6,7,14] \\rightarrow [0,1,3,6,7,11]$。\n\n因此校验值为 $2+3+1+1+1=8$。\n\n对于第三个设计方案，每一个阶段 $d$ 的变化为：\n\n- $[0,10^{18},10^{18},10^{18},10^{18},10^{18}] \\rightarrow [0,1,10^{18},1,10^{18},1] \\rightarrow [0,1,3,1,2,1]$。\n\n因此校验值为 $3+1+1=5$。\n\n对于第四个设计方案，每一个阶段 $d$ 的变化为：\n\n- $[0,10^{18},10^{18},10^{18},10^{18},10^{18}] \\rightarrow [0,10,100,10^{18},10^{18},1] \\rightarrow$ $[0,10,12,103,5,1] \\rightarrow [0,10,12,6,5,1] \\rightarrow [0,10,9,5,1]$。\n\n因此校验值为 $3+3+1+1=8$。\n\n对于第五个设计方案，每一个阶段 $d$ 的变化为：\n\n- $[0,10^{18},10^{18},10^{18},10^{18},10^{18}] \\rightarrow [0,1,1,1,1,1]$\n\n因此校验值为 $5$。\n\n### 数据范围\n\n测试点|$n$|$m$|$K$|其他约定\n-|-|-|-|-\n1,2|$\\le 1000$|$\\le 1000$|$\\le 100$|无\n3,4|$\\le 2 \\times 10^5$|$\\le 2 \\times 10^5$|$\\le 100$|无\n5,6|$\\le 2 \\times 10^5$|$\\le 2 \\times 10^5$|$\\le 2 \\times 10^5$|$1 \\le w_i,l_i \\le 50$\n7,8,9,10|$\\le 2 \\times 10^5$|$\\le 2 \\times 10^5$|$\\le 2 \\times 10^5$|无\n\n\n对于 $100\\%$ 的数据，保证每个设计方案 $a_i$ 两两不同且 $1\\le a_i\\le n$。  \n对于 $100\\%$ 的数据，保证 $1\\le w_i,l_i\\le 10^9,1\\le\\sum K\\le 2\\times 10^5$。\n\n感谢 @Xeonacid 提供题面", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2018] Fat", "background": "Cedyks is the good friend of nine pitiful people (maybe not after this contest becomes public), and also the main character of this problem.", "description": "Cedyks is a rich boy. He lives in the famous The Place (palace).\n\nCedyks is a hard-working boy. Every day he solves different problems to train his The Salt (soul).\n\nOne day, he plans to build a wall around his palace. There are $n$ watchtowers on the wall. You can regard the wall as a line segment, and the watchtowers as $n$ points on the segment, where $1$ and $n$ are the two endpoints of the wall. The distance between watchtower $i$ and watchtower $i + 1$ is $w_i$, and the road between them is bidirectional.\n\nThe wall is built soon. Now Cedyks starts planning the roads from his palace to the wall. Because of the problem title, Cedyks decides to measure a construction plan by the sum of the shortest path lengths from his palace to every watchtower.\n\nNow Cedyks has $m$ design plans. In the $k$-th plan, $T_k$ bidirectional roads will be built between the palace and the watchtowers. The $i$-th road connects to watchtower $a_i$ and has length $l_i$.\n\nComputing the sum of shortest paths to every watchtower is heavy work. Originally, Cedyks wanted to use the well-known SPFA algorithm, but because his butter (buffer) is too small, he has to use the primitive Bellman-Ford algorithm instead. The process is roughly as follows:\n\n1. Define the palace as node $0$, and the $i$-th watchtower as node $i$. A bidirectional edge $(u_i, v_i, l_i)$ is a bidirectional road connecting $u_i$ and $v_i$. Let $d$ be the distance array. Initially, $d_0 = 0, d_i = 10^{18}(i ∈ [1, n])$.\n2. Let the auxiliary array $c = d$. For each edge $(u_i, v_i, w_i)$ in order, relax it: $c_{u_i} = \\min(c_{u_i} , d_{v_i} + w_i)$, $c_{v_i} = \\min(c_{v_i} , d_{u_i} + w_i)$.\n3. Let $t$ be the number of positions where $c$ and $d$ differ. That is, let $S = \\{i|c_i≠d_i\\}$, then $t = |S|$. If $t = 0$, it means $d$ is the final shortest path result, and the algorithm ends. Otherwise, set $d = c$ and go back to step 2.\n\nBecause there are too many design plans to compute, Cedyks hires some people to help. To prevent them from slacking off with made-up data, he defines the checksum value of a design plan as the sum of $t$ every time the Bellman-Ford algorithm enters step 3 when running on this plan. He will ask several hired people to compute the same plan and compare the checksum values they provide.\n\nYou are one of the laborers hired by Cedyks. Being smart, you find that in this situation, computing the sum of shortest path lengths is very easy. However, since you have to obey, you still need to compute the checksum value for each plan to report.", "inputFormat": "The first line contains two integers $n,m$, representing the number of watchtowers and the number of design plans.\n\nThe next line contains $n - 1$ numbers $w_i$, representing the length of the road between watchtower $i$ and watchtower $i + 1$.\n\nThen follow $m$ lines, each describing a design plan. The first integer $K$ is the number of roads in the plan. Then follow $K$ pairs $(a_i, l_i)$, each representing an edge from the palace to watchtower $a_i$ with length $l_i$.", "outputFormat": "For each design plan, output one line with one integer, representing the checksum value.", "hint": "### Sample Explanation\n\nFor the first design plan, the changes of $d$ at each stage are:\n\n- $[0,10^{18},10^{18},10^{18},10^{18},10^{18}] \\rightarrow [0,10^{18},2,10^{18},10^{18},10^{18}] \\rightarrow$ $[0,4,2,5,10^{18},10^{18}] \\rightarrow [0,4,2,5,6,10^{18}] \\rightarrow [0,4,2,5,6,10]$.\n\nSo the checksum value is $1+2+1+1=5$.\n\nFor the second design plan, the changes of $d$ at each stage are:\n\n- $[0,10^{18},10^{18},10^{18},10^{18},10^{18}] \\rightarrow [0,1,10^{18},10^{18},10,10^{18}] \\rightarrow$ $[0,1,3,11,10,14] \\rightarrow [0,1,3,6,10,14] \\rightarrow [0,1,3,6,7,14] \\rightarrow [0,1,3,6,7,11]$.\n\nSo the checksum value is $2+3+1+1+1=8$.\n\nFor the third design plan, the changes of $d$ at each stage are:\n\n- $[0,10^{18},10^{18},10^{18},10^{18},10^{18}] \\rightarrow [0,1,10^{18},1,10^{18},1] \\rightarrow [0,1,3,1,2,1]$。\n\nSo the checksum value is $3+1+1=5$.\n\nFor the fourth design plan, the changes of $d$ at each stage are:\n\n- $[0,10^{18},10^{18},10^{18},10^{18},10^{18}] \\rightarrow [0,10,100,10^{18},10^{18},1] \\rightarrow$ $[0,10,12,103,5,1] \\rightarrow [0,10,12,6,5,1] \\rightarrow [0,10,9,5,1]$。\n\nSo the checksum value is $3+3+1+1=8$.\n\nFor the fifth design plan, the changes of $d$ at each stage are:\n\n- $[0,10^{18},10^{18},10^{18},10^{18},10^{18}] \\rightarrow [0,1,1,1,1,1]$\n\nSo the checksum value is $5$.\n\n### Constraints\n\nTest point|$n$|$m$|$K$|Other constraints\n-|-|-|-|-\n1,2|$\\le 1000$|$\\le 1000$|$\\le 100$|None\n3,4|$\\le 2 \\times 10^5$|$\\le 2 \\times 10^5$|$\\le 100$|None\n5,6|$\\le 2 \\times 10^5$|$\\le 2 \\times 10^5$|$\\le 2 \\times 10^5$|$1 \\le w_i,l_i \\le 50$\n7,8,9,10|$\\le 2 \\times 10^5$|$\\le 2 \\times 10^5$|$\\le 2 \\times 10^5$|None\n\nFor $100\\%$ of the testdata, it is guaranteed that within each design plan, all $a_i$ are pairwise distinct and $1\\le a_i\\le n$.  \nFor $100\\%$ of the testdata, it is guaranteed that $1\\le w_i,l_i\\le 10^9,1\\le\\sum K\\le 2\\times 10^5$.\n\nThanks to @Xeonacid for providing the statement.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2018] 胖", "background": "Cedyks 是九条可怜的好朋友（可能这场比赛公开以后就不是了），也是这题的主人公。", "description": "Cedyks 是一个富有的男孩子。他住在著名的 The Place（宫殿）中。\n\nCedyks 是一个努力的男孩子。他每天都做着不一样的题来锻炼他的 The Salt（灵魂）。\n\n这天，他打算在他的宫殿外围修筑一道城墙，城墙上有 $n$ 座瞭望塔。你可以把城墙看做一条线段，瞭望塔是线段上的 $n$ 个点，其中 $1$ 和 $n$ 分别为城墙的两个端点。其中第 $i$ 座瞭望塔和第 $i + 1$ 座瞭望塔的距离为 $w_i$，他们之间的道路是双向的。\n\n城墙很快就修建好了，现在 Cedyks 开始计划修筑他的宫殿到城墙的道路。因为这题的题目名称，Cedyks 打算用他的宫殿到每一个瞭望塔的最短道路之和来衡量一个修建计划。\n\n现在 Cedyks 手上有 $m$ 个设计方案，第 $k$ 个设计方案会在宫殿和瞭望塔之间修建 $T_k$ 条双向道路，第 $i$ 条道路连接着瞭望塔 $a_i$，长度为 $l_i$。\n\n计算到每一个瞭望塔的最短路之和是一个繁重的工程，本来 Cedyks 想用广为流传的 SPFA 算法来求解，但是因为他的 butter（缓冲区）实在是太小了，他只能转而用原始的贝尔福特曼算法来计算，算法的流程大概如下：\n\n1. 定义宫殿是 $0$ 号点，第 $i$ 个瞭望塔是 $i$ 号点，双向边 $(u_i, v_i, l_i)$ 为一条连接 $u_i$ 和 $v_i$ 的双向道路。令 $d$ 为距离数组，最开始 $d_0 = 0, d_i = 10^{18}(i ∈ [1, n])$。\n2. 令辅助数组 $c = d$。依次对于每一条边 $(u_i, v_i,w_i)$ 进行增广，$c_{u_i} = \\min(c_{u_i} , d_{v_i} + w_i)$，$c_{v_i} = \\min(c_{v_i} , d_{u_i} + w_i)$。\n3. 令 $t$ 为 $c$ 和 $d$ 中不一样的位置个数，即令 $S = \\{i|c_i≠d_i\\}$，则 $t = |S|$。若 $t = 0$，说明 $d$ 就是最终的最短路，算法结束。否则令 $d = c$，回到第二步。\n\n因为需要计算的设计方案实在是太多了，所以 Cedyks 雇佣了一些人来帮他进行计算。为了避免这些人用捏造出来的数据偷懒，他定义一个设计方案的校验值为在这个方案上运行贝尔福特曼算法每一次进入第三步 $t$ 的和。他会让好几个雇佣来的人计算同样的设计方案，并比对每一个人给出的校验值。\n\n你是 Cedyks 雇佣来的苦力之一，聪明的你发现在这个情形下计算最短路的长度的和是一件非常简单的事情。但是寄人篱下不得不低头，你不得不再计算出每一个方案的校验值来交差。", "inputFormat": "第一行输入两个整数 $n,m$，表示瞭望塔个数和设计方案个数。\n\n接下来一行 $n - 1$ 个数 $w_i$，表示瞭望塔 $i$ 和 $i + 1$ 之间道路的长度。\n\n接下来 $m$ 行，每行描述一个设计方案。第一个整数 $K$ 表示设计方案中的道路数量，接下来 $K$ 个数对 $(a_i, l_i)$ 为一条宫殿到瞭望塔的边。", "outputFormat": "对于每一个设计方案，输出一行一个整数表示校验值。", "hint": "### 样例解释\n\n对于第一个设计方案，每一个阶段 $d$ 的变化为：\n\n- $[0,10^{18},10^{18},10^{18},10^{18},10^{18}] \\rightarrow [0,10^{18},2,10^{18},10^{18},10^{18}] \\rightarrow$ $[0,4,2,5,10^{18},10^{18}] \\rightarrow [0,4,2,5,6,10^{18}] \\rightarrow [0,4,2,5,6,10]$。\n\n因此校验值为 $1+2+1+1=5$。\n\n对于第二个设计方案，每一个阶段 $d$ 的变化为：\n\n- $[0,10^{18},10^{18},10^{18},10^{18},10^{18}] \\rightarrow [0,1,10^{18},10^{18},10,10^{18}] \\rightarrow$ $[0,1,3,11,10,14] \\rightarrow [0,1,3,6,10,14] \\rightarrow [0,1,3,6,7,14] \\rightarrow [0,1,3,6,7,11]$。\n\n因此校验值为 $2+3+1+1+1=8$。\n\n对于第三个设计方案，每一个阶段 $d$ 的变化为：\n\n- $[0,10^{18},10^{18},10^{18},10^{18},10^{18}] \\rightarrow [0,1,10^{18},1,10^{18},1] \\rightarrow [0,1,3,1,2,1]$。\n\n因此校验值为 $3+1+1=5$。\n\n对于第四个设计方案，每一个阶段 $d$ 的变化为：\n\n- $[0,10^{18},10^{18},10^{18},10^{18},10^{18}] \\rightarrow [0,10,100,10^{18},10^{18},1] \\rightarrow$ $[0,10,12,103,5,1] \\rightarrow [0,10,12,6,5,1] \\rightarrow [0,10,9,5,1]$。\n\n因此校验值为 $3+3+1+1=8$。\n\n对于第五个设计方案，每一个阶段 $d$ 的变化为：\n\n- $[0,10^{18},10^{18},10^{18},10^{18},10^{18}] \\rightarrow [0,1,1,1,1,1]$\n\n因此校验值为 $5$。\n\n### 数据范围\n\n测试点|$n$|$m$|$K$|其他约定\n-|-|-|-|-\n1,2|$\\le 1000$|$\\le 1000$|$\\le 100$|无\n3,4|$\\le 2 \\times 10^5$|$\\le 2 \\times 10^5$|$\\le 100$|无\n5,6|$\\le 2 \\times 10^5$|$\\le 2 \\times 10^5$|$\\le 2 \\times 10^5$|$1 \\le w_i,l_i \\le 50$\n7,8,9,10|$\\le 2 \\times 10^5$|$\\le 2 \\times 10^5$|$\\le 2 \\times 10^5$|无\n\n\n对于 $100\\%$ 的数据，保证每个设计方案 $a_i$ 两两不同且 $1\\le a_i\\le n$。  \n对于 $100\\%$ 的数据，保证 $1\\le w_i,l_i\\le 10^9,1\\le\\sum K\\le 2\\times 10^5$。\n\n感谢 @Xeonacid 提供题面", "locale": "zh-CN"}}}
{"pid": "P4502", "type": "P", "difficulty": 7, "samples": [["4\n0 0 1 1\n0 0\n2 0\n0 1\n1 1", "3.7853981633974474\n"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "各省省选", "浙江", "Special Judge"], "title": "[ZJOI2018] 保镖", "background": "", "description": "九条可怜是一个贪玩的女孩子。\n\n一个可爱的女孩子出门在外和朋友玩，难免会遇到危险，于是可怜的爸爸悄悄的安插了 $n$ 位保镖在暗中保护她。因为可怜是一个要强的女孩子，所以她的爸爸不想让她知道她的身边有这么多的保镖，因此保镖们必须通过定期的换岗来避免被可怜发现。\n\n一次理想的换岗是：距离可怜远的保镖被换到了较近的位置，距离可怜近的保镖被换到了较远的位置。经过一系列安排，保镖们会按照如下的方式进行换岗：\n\n换岗时，可怜和保镖们的位置可以被抽象成二维平面直角坐标系上的点。设可怜的位置为 $O$，保镖的位置为 $P_i$，换岗后的位置为 $P'_i$\n在换岗前后，保镖和可怜的相对位置不变。即对于 $\\forall i \\in [1,n]$，$P'_i$ 在射线 $OP_i$ 上。\n在换岗前后，保镖和可怜的距离变成了原来的倒数。即对于 $\\forall i \\in [1,n]$，$|OP_i||OP'_i|=1$。\n同时，保镖的位置决定了可怜的安全度。如果在外围的保镖越多，那么他们能观察到的信息就越多，可怜就越安全。因此，我们定义这些保镖的位置的凸包的**顶点个数**为可怜的安全度。\n\n然而，可怜的行踪总是神出鬼没的。这一天，保镖们跟丢了可怜，只知道可怜下次会在以 $(x_1,y_1)$ 为左下角，以 $(x_2,y_2)$ 为右上角的矩形区域内出现，具体的位置服从这个矩形区域内的均匀分布（可以理解为等概率随机）。因为保镖们已经有很长时间没有换岗了，于是他们打算在可怜下次出现的时候换岗。同时，在极小的概率下，可怜可能会出现在和某个保镖相同的位置上。这时这个保镖会被发现，从而他会保持位置不动，而其他的保镖还是会按照上述规则进行换岗。\n\n现在，可怜的爸爸想要计算，保镖们在换岗后，可怜的安全度的期望是多少。\n\n如果你对凸包不太熟悉，这儿给出凸包形式化的定义：\n\n对于一个简单多边形，它是凸多边形当且仅当它内部任意两点的连线在它的内部。\n对于一个点集 $P$，它的凸包为包含所有点面积最小的没有三个连续顶点共线的凸多边形。", "inputFormat": "第一行输入一个整数 $n$， 表示保镖的数量。\n\n第二行输入四个整数 $x_1,y_1,x_2,y_2$， 表示可怜可能出现的矩形区域。\n\n接下来 $n$ 行每行两个整数 $a,b$，表示一个保镖的坐标。保证保镖的坐标两两不同。", "outputFormat": "输出一行一个实数表示凸包节点数的期望。\n\n当你的答案与标准输出的绝对误差或相对误差在 $10^{-7}$ 内时，就会被视为正确。\n\n样例", "hint": "### 样例解释\n这儿画出可怜出现在 (1,0) 时的情况，如下图所示，1,2,4 号保镖的位置保持不变，分别为 $P_1,P_2,P_4$，3 号保镖从 $P_3$ 变到了 $P'_3$，坐标为 $(\\frac{1}{2},\\frac{1}{2})$。 \n\n![](https://cdn.luogu.com.cn/upload/pic/18418.png)\n\n这时四个保镖的位置 $P_1,P_2,P'_3,P_4$ 的凸包为三角形 $P_1,P_4,P_2$，因此可怜的安全度为 3。注意这时 $P'_3$ 正好落在边 $P_1P_4$ 上，但是根据凸包的定义，它不是顶点。\n\n### 数据范围\n\n测试点|　$n$|测试点|　$n$\n-|-|-|-\n1|$\\le 3$|6|$\\le 50$\n2|$\\le 4$|7|$\\le 350$\n3|$\\le 4$|8|$\\le 350$\n4|$\\le 50$|9|$\\le 2000$\n5|$\\le 50$|10|$\\le 2000$\n\n对于 100% 的数据，保证 $0 \\leq a,b,x_0,x_1,y_0,y_1 \\leq 10^5,x_0<x_1,y_0<y_1,n \\geq 3$。\n\n对于 100% 的数据，保证保镖的位置两两不同。\n\n同时为了避免可能出现的精度误差，在所有实际的测试数据以及大样例中，保证可怜可能出现的矩形区域的长宽都不小于 $10^3$，即 $x_1-x_0,y_1-y_0 \\geq 10^3$.", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2018] Bodyguards", "background": "", "description": "Jiutiao Kelian is a playful girl.\n\nWhen a cute girl goes out to play with friends, danger may arise. So Kelian’s father secretly stationed $n$ bodyguards to protect her from the shadows. Because Kelian is strong-willed, her father does not want her to notice the many bodyguards around her, so the bodyguards must regularly rotate their posts to avoid being discovered.\n\nAn ideal rotation is: the bodyguards far from Kelian are moved closer, and the ones close to Kelian are moved farther. After some planning, the bodyguards will rotate according to the following rules:\n\n- During rotation, Kelian and the bodyguards’ positions can be abstracted as points in a 2D Cartesian plane. Let Kelian’s position be $O$, a bodyguard’s position be $P_i$, and the position after rotation be $P'_i$.\n- Before and after rotation, the relative direction between each bodyguard and Kelian remains the same. That is, for $\\forall i \\in [1, n]$, $P'_i$ lies on the ray $OP_i$.\n- Before and after rotation, the distance between each bodyguard and Kelian becomes the reciprocal of the original. That is, for $\\forall i \\in [1, n]$, $|OP_i|\\,|OP'_i| = 1$.\n\nMeanwhile, Kelian’s safety level is determined by the bodyguards’ positions. The more bodyguards on the outside, the more information they can observe, and the safer Kelian is. Therefore, we define the number of vertices of the convex hull of the bodyguards’ positions as Kelian’s safety level.\n\nHowever, Kelian’s whereabouts are unpredictable. On this day, the bodyguards lost track of her and only know that next time she will appear inside the rectangle with lower-left corner $(x_1, y_1)$ and upper-right corner $(x_2, y_2)$, with a uniform distribution over this rectangle (i.e., equally likely). Since it has been a long time since the last rotation, they plan to rotate when Kelian appears next. Also, with a very small probability, Kelian may appear at exactly the same location as some bodyguard. In that case, that bodyguard will be discovered and will remain still, while the other bodyguards still rotate according to the rules above.\n\nNow, Kelian’s father wants to compute the expected value of Kelian’s safety level (the number of convex hull vertices) after the rotation.\n\nIf you are not familiar with convex hulls, here is a formal definition:\n\n- A simple polygon is a convex polygon if and only if the line segment between any two interior points lies entirely inside it.\n- For a point set $P$, its convex hull is the convex polygon of minimum area that contains all points and has no three consecutive vertices collinear.", "inputFormat": "- The first line contains an integer $n$, the number of bodyguards.\n- The second line contains four integers $x_1, y_1, x_2, y_2$, describing the rectangle where Kelian may appear.\n- Each of the next $n$ lines contains two integers $a, b$, the coordinates of a bodyguard. All bodyguards’ positions are pairwise distinct.", "outputFormat": "Output a single real number: the expected number of vertices of the convex hull.\n\nYour answer will be accepted if its absolute or relative error is within $10^{-7}$.", "hint": "Sample Explanation  \nHere we draw the situation when Kelian appears at $(1, 0)$, as shown below. Bodyguards 1, 2, and 4 keep their positions, denoted $P_1, P_2, P_4$. Bodyguard 3 moves from $P_3$ to $P'_3$ with coordinates $(\\frac{1}{2}, \\frac{1}{2})$.\n\n![](https://cdn.luogu.com.cn/upload/pic/18418.png)\n\nAt this moment, the convex hull of $P_1, P_2, P'_3, P_4$ is the triangle $P_1, P_4, P_2$, so Kelian’s safety level is 3. Note that $P'_3$ lies exactly on edge $P_1P_4$, but by the definition of the convex hull, it is not a vertex.\n\nConstraints\n\n测试点|　$n$|测试点|　$n$\n-|-|-|-\n1|$\\le 3$|6|$\\le 50$\n2|$\\le 4$|7|$\\le 350$\n3|$\\le 4$|8|$\\le 350$\n4|$\\le 50$|9|$\\le 2000$\n5|$\\le 50$|10|$\\le 2000$\n\nFor 100% of the testdata, it is guaranteed that $0 \\le a, b, x_1, y_1, x_2, y_2 \\le 10^5$, $x_1 < x_2$, $y_1 < y_2$, and $n \\ge 3$.\n\nFor 100% of the testdata, the bodyguards’ positions are pairwise distinct.\n\nTo avoid possible precision issues, in all actual testdata and large samples, the width and height of the rectangle where Kelian may appear are at least $10^3$, i.e., $x_2 - x_1, y_2 - y_1 \\ge 10^3$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2018] 保镖", "background": "", "description": "九条可怜是一个贪玩的女孩子。\n\n一个可爱的女孩子出门在外和朋友玩，难免会遇到危险，于是可怜的爸爸悄悄的安插了 $n$ 位保镖在暗中保护她。因为可怜是一个要强的女孩子，所以她的爸爸不想让她知道她的身边有这么多的保镖，因此保镖们必须通过定期的换岗来避免被可怜发现。\n\n一次理想的换岗是：距离可怜远的保镖被换到了较近的位置，距离可怜近的保镖被换到了较远的位置。经过一系列安排，保镖们会按照如下的方式进行换岗：\n\n换岗时，可怜和保镖们的位置可以被抽象成二维平面直角坐标系上的点。设可怜的位置为 $O$，保镖的位置为 $P_i$，换岗后的位置为 $P'_i$\n在换岗前后，保镖和可怜的相对位置不变。即对于 $\\forall i \\in [1,n]$，$P'_i$ 在射线 $OP_i$ 上。\n在换岗前后，保镖和可怜的距离变成了原来的倒数。即对于 $\\forall i \\in [1,n]$，$|OP_i||OP'_i|=1$。\n同时，保镖的位置决定了可怜的安全度。如果在外围的保镖越多，那么他们能观察到的信息就越多，可怜就越安全。因此，我们定义这些保镖的位置的凸包的**顶点个数**为可怜的安全度。\n\n然而，可怜的行踪总是神出鬼没的。这一天，保镖们跟丢了可怜，只知道可怜下次会在以 $(x_1,y_1)$ 为左下角，以 $(x_2,y_2)$ 为右上角的矩形区域内出现，具体的位置服从这个矩形区域内的均匀分布（可以理解为等概率随机）。因为保镖们已经有很长时间没有换岗了，于是他们打算在可怜下次出现的时候换岗。同时，在极小的概率下，可怜可能会出现在和某个保镖相同的位置上。这时这个保镖会被发现，从而他会保持位置不动，而其他的保镖还是会按照上述规则进行换岗。\n\n现在，可怜的爸爸想要计算，保镖们在换岗后，可怜的安全度的期望是多少。\n\n如果你对凸包不太熟悉，这儿给出凸包形式化的定义：\n\n对于一个简单多边形，它是凸多边形当且仅当它内部任意两点的连线在它的内部。\n对于一个点集 $P$，它的凸包为包含所有点面积最小的没有三个连续顶点共线的凸多边形。", "inputFormat": "第一行输入一个整数 $n$， 表示保镖的数量。\n\n第二行输入四个整数 $x_1,y_1,x_2,y_2$， 表示可怜可能出现的矩形区域。\n\n接下来 $n$ 行每行两个整数 $a,b$，表示一个保镖的坐标。保证保镖的坐标两两不同。", "outputFormat": "输出一行一个实数表示凸包节点数的期望。\n\n当你的答案与标准输出的绝对误差或相对误差在 $10^{-7}$ 内时，就会被视为正确。\n\n样例", "hint": "### 样例解释\n这儿画出可怜出现在 (1,0) 时的情况，如下图所示，1,2,4 号保镖的位置保持不变，分别为 $P_1,P_2,P_4$，3 号保镖从 $P_3$ 变到了 $P'_3$，坐标为 $(\\frac{1}{2},\\frac{1}{2})$。 \n\n![](https://cdn.luogu.com.cn/upload/pic/18418.png)\n\n这时四个保镖的位置 $P_1,P_2,P'_3,P_4$ 的凸包为三角形 $P_1,P_4,P_2$，因此可怜的安全度为 3。注意这时 $P'_3$ 正好落在边 $P_1P_4$ 上，但是根据凸包的定义，它不是顶点。\n\n### 数据范围\n\n测试点|　$n$|测试点|　$n$\n-|-|-|-\n1|$\\le 3$|6|$\\le 50$\n2|$\\le 4$|7|$\\le 350$\n3|$\\le 4$|8|$\\le 350$\n4|$\\le 50$|9|$\\le 2000$\n5|$\\le 50$|10|$\\le 2000$\n\n对于 100% 的数据，保证 $0 \\leq a,b,x_0,x_1,y_0,y_1 \\leq 10^5,x_0<x_1,y_0<y_1,n \\geq 3$。\n\n对于 100% 的数据，保证保镖的位置两两不同。\n\n同时为了避免可能出现的精度误差，在所有实际的测试数据以及大样例中，保证可怜可能出现的矩形区域的长宽都不小于 $10^3$，即 $x_1-x_0,y_1-y_0 \\geq 10^3$.", "locale": "zh-CN"}}}
{"pid": "P4503", "type": "P", "difficulty": 5, "samples": [["4 3 64\nFax\nfax\nmax\nmac", "4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["字符串", "2014", "哈希 hashing", "CTSC/CTS"], "title": "[CTSC2014] 企鹅 QQ", "background": "PenguinQQ 是中国最大、最具影响力的 SNS（Social Networking Services）网站，以实名制为基础，为用户提供日志、群、即时通讯、相册、集市等丰富强大的互联网功能体验，满足用户对社交、资讯、娱乐、交易等多方面的需求。", "description": "小 Q 是 PenguinQQ 网站的管理员，他最近在进行一项有趣的研究——哪些账户是同一个人注册的。经过长时间的分析，小 Q 发现同一个人注册的账户名称总是很相似的，例如 Penguin1，Penguin2，Penguin3……于是小 Q 决定先对这种相似的情形进行统计。\n\n小 Q 定义，若两个账户名称是相似的，当且仅当这两个字符串等长且恰好只有一位不同。例如“Penguin1”和“Penguin2”是相似的，但“Penguin1”和“2Penguin”不是相似的。而小 Q 想知道，在给定的 $n$ 个账户名称中，有多少对是相似的。\n\n为了简化你的工作，小 Q 给你的 $n$ 个字符串长度均等于$L$ ，且只包含大小写字母、数字、下划线以及‘@’共 $64$ 种字符，而且不存在两个相同的账户名称。", "inputFormat": "第一行包含三个正整数 $N,L,S$。其中 $N$ 表示账户名称数量，$L$ 表示账户名称长度，$S$ 用来表示字符集规模大小，它的值只可能为 $2$ 或 $64$。\n\n若 $S$ 等于 $2$，账户名称中只包含字符 `0` 和 `1` 共 $2$ 种字符；\n\n若 $S$ 等于 $64$，账户名称中可能包含大小写字母、数字、下划线以及 `@` 共 $64$ 种字符。\n\n随后 $N$ 行，每行一个长度为 $L$ 的字符串，用来描述一个账户名称。数据保证 $N$ 个字符串是两两不同的。", "outputFormat": "仅一行一个正整数，表示共有多少对相似的账户名称。", "hint": "$4$ 对相似的字符串分别为：Fax 与 fax，Fax 与 max，fax 与 max，max 与 mac。\n\n测试点编号|$N$|$L$|$S$\n:-:|:-:|:-:|:-:\n$1$|$50$|$10$|$64$\n$2$|$500$|$100$|$64$\n$3$|$3000$|$100$|$2$\n$4$|$3000$|$100$|$64$\n$5$|$30000$|$50$|$2$\n$6$|$30000$|$50$|$64$\n$7$|$30000$|$200$|$2$\n$8$|$30000$|$200$|$64$\n$9$|$30000$|$200$|$2$\n$10$|$30000$|$200$|$64$", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2014] Penguin QQ", "background": "PenguinQQ is China’s largest and most influential SNS (Social Networking Services) website. Based on a real-name system, it provides powerful and rich Internet features such as blogs, groups, instant messaging, photo albums, and a marketplace, meeting users’ needs in socializing, information, entertainment, and transactions.", "description": "Xiao Q (pinyin) is an administrator of the PenguinQQ website. He is studying an interesting question: which accounts were registered by the same person. After long analysis, Xiao Q found that accounts registered by the same person usually have very similar names, such as Penguin1, Penguin2, Penguin3... So he decides to first count such similar cases.\n\nXiao Q defines two account names to be similar if and only if the two strings have the same length and differ in exactly one position. For example, “Penguin1” and “Penguin2” are similar, while “Penguin1” and “2Penguin” are not. Given $n$ account names, he wants to know how many pairs are similar.\n\nTo simplify your work, the $n$ strings all have length $L$, and they contain only uppercase and lowercase letters, digits, the underscore, and `@` — a total of $64$ characters. Moreover, no two account names are identical.", "inputFormat": "The first line contains three positive integers $N, L, S$. Here $N$ is the number of account names, $L$ is the length of each account name, and $S$ is the alphabet size, whose value is either $2$ or $64$.\n\nIf $S$ equals $2$, account names contain only the characters `0` and `1`.\n\nIf $S$ equals $64$, account names may contain uppercase and lowercase letters, digits, the underscore, and `@` — a total of $64$ characters.\n\nThen $N$ lines follow, each containing a string of length $L$ that describes an account name. It is guaranteed that the $N$ strings are pairwise distinct.", "outputFormat": "Output a single integer on one line, the number of pairs of similar account names.", "hint": "The $4$ similar pairs are: Fax and fax, Fax and max, fax and max, max and mac.\n\n测试点编号|$N$|$L$|$S$\n:-:|:-:|:-:|:-:\n$1$|$50$|$10$|$64$\n$2$|$500$|$100$|$64$\n$3$|$3000$|$100$|$2$\n$4$|$3000$|$100$|$64$\n$5$|$30000$|$50$|$2$\n$6$|$30000$|$50$|$64$\n$7$|$30000$|$200$|$2$\n$8$|$30000$|$200$|$64$\n$9$|$30000$|$200$|$2$\n$10$|$30000$|$200$|$64$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2014] 企鹅 QQ", "background": "PenguinQQ 是中国最大、最具影响力的 SNS（Social Networking Services）网站，以实名制为基础，为用户提供日志、群、即时通讯、相册、集市等丰富强大的互联网功能体验，满足用户对社交、资讯、娱乐、交易等多方面的需求。", "description": "小 Q 是 PenguinQQ 网站的管理员，他最近在进行一项有趣的研究——哪些账户是同一个人注册的。经过长时间的分析，小 Q 发现同一个人注册的账户名称总是很相似的，例如 Penguin1，Penguin2，Penguin3……于是小 Q 决定先对这种相似的情形进行统计。\n\n小 Q 定义，若两个账户名称是相似的，当且仅当这两个字符串等长且恰好只有一位不同。例如“Penguin1”和“Penguin2”是相似的，但“Penguin1”和“2Penguin”不是相似的。而小 Q 想知道，在给定的 $n$ 个账户名称中，有多少对是相似的。\n\n为了简化你的工作，小 Q 给你的 $n$ 个字符串长度均等于$L$ ，且只包含大小写字母、数字、下划线以及‘@’共 $64$ 种字符，而且不存在两个相同的账户名称。", "inputFormat": "第一行包含三个正整数 $N,L,S$。其中 $N$ 表示账户名称数量，$L$ 表示账户名称长度，$S$ 用来表示字符集规模大小，它的值只可能为 $2$ 或 $64$。\n\n若 $S$ 等于 $2$，账户名称中只包含字符 `0` 和 `1` 共 $2$ 种字符；\n\n若 $S$ 等于 $64$，账户名称中可能包含大小写字母、数字、下划线以及 `@` 共 $64$ 种字符。\n\n随后 $N$ 行，每行一个长度为 $L$ 的字符串，用来描述一个账户名称。数据保证 $N$ 个字符串是两两不同的。", "outputFormat": "仅一行一个正整数，表示共有多少对相似的账户名称。", "hint": "$4$ 对相似的字符串分别为：Fax 与 fax，Fax 与 max，fax 与 max，max 与 mac。\n\n测试点编号|$N$|$L$|$S$\n:-:|:-:|:-:|:-:\n$1$|$50$|$10$|$64$\n$2$|$500$|$100$|$64$\n$3$|$3000$|$100$|$2$\n$4$|$3000$|$100$|$64$\n$5$|$30000$|$50$|$2$\n$6$|$30000$|$50$|$64$\n$7$|$30000$|$200$|$2$\n$8$|$30000$|$200$|$64$\n$9$|$30000$|$200$|$2$\n$10$|$30000$|$200$|$64$", "locale": "zh-CN"}}}
{"pid": "P4504", "type": "P", "difficulty": 7, "samples": [["3\n1\n6 7 1 \n4 1 8 \n8 3 3 \n2\n7 5 8 \n10 5 7 \n10 5 5 \n10\n1 3 1 2 2\n1 2 2 3 5\n2 3 2 2 2\n1 2 3 2 5\n1 3 1 2 3\n2 1 2 2 3\n1 3 2 1 2\n2 2 1 1 1\n1 2 1 2 5\n2 3 1 1 2", "0.083836\n0.095256\n0.078828\n0.146900"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2014", "Special Judge", "CTSC/CTS"], "title": "[CTSC2014] 插线板", "background": "", "description": "Allison有非常多的电子设备，比如iMac,iPod,iPhone和iPad。所以她准备购买插线板来给电子设备充电。在做了大量的网络调研后，Allison发现了一款美丽精巧的天翼牌排插（如左下图所示）。在见到这个插线板的第一眼，Allison就被它的精美造型所吸引，于是她一次性购买了n个这种型号的插线板。 \n\n可是问题也随之而来，Allison的家中只有一个插座，她需要通过插线板的连接将电一层一层地导出（如右上图所示）。 \n\n插线板的连接方式是树形结构的：每个插线板的插头插在另一个插线板的插空中（除了根节点），插线板的连接不允许构成环。 \n\n每个插线板有火线，零线，地线三根导线，随着插线板数量的增加、导线的磨损，电路中导线与导线之间接触产生的电阻已经到了不能被忽视的地步。\n \n如何来描述插线板的树形结构以及导线之间的电阻关系呢？Allison思考出来一个数学模型：用$a_i$代表第$i$个插线板的编号，$f_i$代表第$i$个插线板的插头所差的插线板（即$a_i$在树中的父亲），$1$代表火线，$2$代表零线，$3$代表地线，则整个网络的电阻可以用$R(a_i,f_i,x,y)(x,y∈\\{1,2,3\\})$来描述，它代表$a_i$的$x$线与$f_i$的$y$线之间的电阻值（在这个数学模型中，Allison认为火线和零线也是可能连接并且产生电阻的）下面是一个例子： \n\n![](https://cdn.luogu.com.cn/upload/pic/17985.png)\n\n由于时间的推移，导线与导线之间的电阻还可能发生变化。现在，Allison想知道在插线板树形电路中，当前时刻$a_i$插线板的$x$线和$a_j$插线板的$y$线之间的电阻是多少。规定插线板的树根节点不再插向其他插线板，且编号为$1$。 ", "inputFormat": "第一行包含一个正整数$n$，表示插线板的个数。 \n\n接下来$4(n-1)$行，每4行为一个块。 \n\n第$i$块的第一行为一个整数$f_i$【注：原题如此。实际应该是$f_{i+1}$，下同】，表示编号为$i+1$的插线板的父亲为$f_i$【注：同上】插线板。\n \n接下来一个$3\\times3$的矩阵$g_{xy}$，第$x$行第$y$个数表示编号为$i+1$的插线板的$x$线和$f_i$【注：同上】的$y$线之间的电阻的**倒数**。 \n\n接下来一个整数$q$，表示$q$个操作数。\n \n第一个整数位$k$，若$k=1$则接下来包含四个整数$a_i,x_i,x_j,g$，表示将$a_i$插线板的$x_i$线与$a_i$插线板的父亲$f_i$【注：原题如此。实际应该是$f_{a_i}$】的$x_j$线之间的电阻值改为$g$的倒数。保证$2≤a_i≤n$。\n \n若$k=2$，则接下来包含四个整数$a_i,x_i,a_j,x_j$，表示询问$a_i$插线板的$x_i$线与$a_j$插线板的$x_j$线之间的电阻大小。保证$a_i≠a_j$。 ", "outputFormat": "对每个询问，输出一行实数，表示两条线之间的电阻。 \n\n若|(选手输出-标准输出)/标准输出|$≤10^{-3}$，则被认为该电阻值正确，若所有电阻值皆正确，则可获得该测试点的得分。 ", "hint": "对于所有测试数据，输入保证是一棵树。$0<$输入中电阻的倒数$≤10$。 \n\n测试点编号| 特点\n:-:|:-:\n$1\\sim6$|$n≤100,q≤1000$，保证输入中只有查询没有修改\n$7\\sim10$|$n≤1000,q≤1000$，保证数据是一条链\n$11\\sim16$|$n≤10000,q≤10000$，保证树的高度不超过$30$\n$17\\sim20$|$n≤10000,q≤10000$", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2014] Power Strip", "background": "", "description": "Allison has a lot of electronic devices, such as an iMac, iPod, iPhone, and iPad. So she plans to buy power strips to charge them. After doing a lot of online research, Allison found a beautiful and delicate Tianyi-brand power strip (as shown in the lower-left picture). At first sight, Allison was attracted by its exquisite design, so she bought $n$ power strips of this model at once.\n\nBut then a problem arose: Allison’s home has only one wall socket. She needs to connect power strips so that electricity can be carried out layer by layer (as shown in the lower-right picture).\n\nThe connection of power strips forms a tree structure: the plug of each power strip is inserted into a socket of another power strip (except the root node), and the connections are not allowed to form a cycle.\n\nEach power strip has three wires: live, neutral, and ground. As the number of power strips increases and wires wear out, the contact resistance between wires in the circuit has become too significant to ignore.\n\nHow can we describe the tree structure of the power strips and the resistance relationships between wires? Allison came up with a mathematical model: use $a_i$ to denote the ID of the $i$-th power strip, and $f_i$ to denote the power strip into which the plug of the $i$-th power strip is inserted (i.e., the parent of $a_i$ in the tree). Let $1$ represent the live wire, $2$ the neutral wire, and $3$ the ground wire. Then the resistance of the whole network can be described by $R(a_i,f_i,x,y)(x,y∈\\{1,2,3\\})$, which represents the resistance between wire $x$ of $a_i$ and wire $y$ of $f_i$ (in this model, Allison assumes that the live wire and neutral wire may also be connected and produce resistance). An example is shown below:\n\n![](https://cdn.luogu.com.cn/upload/pic/17985.png)\n\nAs time passes, the resistance between wires may also change. Now Allison wants to know, in the current power-strip tree circuit, what the resistance is between wire $x$ of power strip $a_i$ and wire $y$ of power strip $a_j$. The root node of the tree is not plugged into any other power strip, and its ID is $1$.", "inputFormat": "The first line contains a positive integer $n$, the number of power strips.\n\nThe next $4(n-1)$ lines are divided into blocks, each block consisting of 4 lines.\n\nIn the $i$-th block, the first line contains an integer $f_{i+1}$, meaning that the parent of power strip $i+1$ is $f_{i+1}$.\n\nThen follows a $3\\times3$ matrix $g_{xy}$. The number in row $x$, column $y$ is the **reciprocal** of the resistance between wire $x$ of power strip $i+1$ and wire $y$ of power strip $f_{i+1}$.\n\nThen an integer $q$ is given, denoting the number of operations.\n\nEach operation starts with an integer $k$.\n\n- If $k=1$, then four integers $a_i,x_i,x_j,g$ follow, meaning to change the resistance between wire $x_i$ of power strip $a_i$ and wire $x_j$ of its parent $f_{a_i}$ to the reciprocal of $g$. It is guaranteed that $2≤a_i≤n$.\n- If $k=2$, then four integers $a_i,x_i,a_j,x_j$ follow, meaning to query the resistance between wire $x_i$ of power strip $a_i$ and wire $x_j$ of power strip $a_j$. It is guaranteed that $a_i≠a_j$.", "outputFormat": "For each query, output one line with a real number, representing the resistance between the two wires.\n\nIf $|(\\text{your output}-\\text{standard output})/\\text{standard output}|≤10^{-3}$, then the resistance value is considered correct. If all resistance values are correct, you will get the score for that test point.", "hint": "For all testdata, the input is guaranteed to be a tree. $0<$ the reciprocal of each resistance in the input $≤10$.\n\nTest point ID | Feature\n:-:|:-:\n$1\\sim6$ | $n≤100,q≤1000$, and the input contains only queries, no modifications\n$7\\sim10$ | $n≤1000,q≤1000$, and the tree is a chain\n$11\\sim16$ | $n≤10000,q≤10000$, and the height of the tree does not exceed $30$\n$17\\sim20$ | $n≤10000,q≤10000$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2014] 插线板", "background": "", "description": "Allison有非常多的电子设备，比如iMac,iPod,iPhone和iPad。所以她准备购买插线板来给电子设备充电。在做了大量的网络调研后，Allison发现了一款美丽精巧的天翼牌排插（如左下图所示）。在见到这个插线板的第一眼，Allison就被它的精美造型所吸引，于是她一次性购买了n个这种型号的插线板。 \n\n可是问题也随之而来，Allison的家中只有一个插座，她需要通过插线板的连接将电一层一层地导出（如右上图所示）。 \n\n插线板的连接方式是树形结构的：每个插线板的插头插在另一个插线板的插空中（除了根节点），插线板的连接不允许构成环。 \n\n每个插线板有火线，零线，地线三根导线，随着插线板数量的增加、导线的磨损，电路中导线与导线之间接触产生的电阻已经到了不能被忽视的地步。\n \n如何来描述插线板的树形结构以及导线之间的电阻关系呢？Allison思考出来一个数学模型：用$a_i$代表第$i$个插线板的编号，$f_i$代表第$i$个插线板的插头所差的插线板（即$a_i$在树中的父亲），$1$代表火线，$2$代表零线，$3$代表地线，则整个网络的电阻可以用$R(a_i,f_i,x,y)(x,y∈\\{1,2,3\\})$来描述，它代表$a_i$的$x$线与$f_i$的$y$线之间的电阻值（在这个数学模型中，Allison认为火线和零线也是可能连接并且产生电阻的）下面是一个例子： \n\n![](https://cdn.luogu.com.cn/upload/pic/17985.png)\n\n由于时间的推移，导线与导线之间的电阻还可能发生变化。现在，Allison想知道在插线板树形电路中，当前时刻$a_i$插线板的$x$线和$a_j$插线板的$y$线之间的电阻是多少。规定插线板的树根节点不再插向其他插线板，且编号为$1$。 ", "inputFormat": "第一行包含一个正整数$n$，表示插线板的个数。 \n\n接下来$4(n-1)$行，每4行为一个块。 \n\n第$i$块的第一行为一个整数$f_i$【注：原题如此。实际应该是$f_{i+1}$，下同】，表示编号为$i+1$的插线板的父亲为$f_i$【注：同上】插线板。\n \n接下来一个$3\\times3$的矩阵$g_{xy}$，第$x$行第$y$个数表示编号为$i+1$的插线板的$x$线和$f_i$【注：同上】的$y$线之间的电阻的**倒数**。 \n\n接下来一个整数$q$，表示$q$个操作数。\n \n第一个整数位$k$，若$k=1$则接下来包含四个整数$a_i,x_i,x_j,g$，表示将$a_i$插线板的$x_i$线与$a_i$插线板的父亲$f_i$【注：原题如此。实际应该是$f_{a_i}$】的$x_j$线之间的电阻值改为$g$的倒数。保证$2≤a_i≤n$。\n \n若$k=2$，则接下来包含四个整数$a_i,x_i,a_j,x_j$，表示询问$a_i$插线板的$x_i$线与$a_j$插线板的$x_j$线之间的电阻大小。保证$a_i≠a_j$。 ", "outputFormat": "对每个询问，输出一行实数，表示两条线之间的电阻。 \n\n若|(选手输出-标准输出)/标准输出|$≤10^{-3}$，则被认为该电阻值正确，若所有电阻值皆正确，则可获得该测试点的得分。 ", "hint": "对于所有测试数据，输入保证是一棵树。$0<$输入中电阻的倒数$≤10$。 \n\n测试点编号| 特点\n:-:|:-:\n$1\\sim6$|$n≤100,q≤1000$，保证输入中只有查询没有修改\n$7\\sim10$|$n≤1000,q≤1000$，保证数据是一条链\n$11\\sim16$|$n≤10000,q≤10000$，保证树的高度不超过$30$\n$17\\sim20$|$n≤10000,q≤10000$", "locale": "zh-CN"}}}
{"pid": "P4505", "type": "P", "difficulty": 5, "samples": [["2\n5\n3 2 1 3 2\n5\n1 1 1 1 1", "3\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "CTSC/CTS"], "title": "[CTSC2013] 组合子逻辑", "background": "", "description": "组合子逻辑是 Moses Schönfinkel 和 Haskell Curry 发明的一种符号系统，用于消除数理逻辑中对于变量的需要。本题考察一种与真实世界的组合子演算略有差别的组合子系统。\n\n一个组合子项是下列形式之一：\n\n$$P$$\n\n$$(E_1\\;E_2)$$\n\n其中 $P$ 表示一个基本函数，$E_1$以及$E_2$表示一个组合子项(可以相同)。不满足以上形式表达式均非组合子项。\n\n我们将一个组合子项 $E$ 的参数个数 $np(E)$如下：\n\n$np(P)$ = 基本函数 $P$ 的参数个数；\n\n$np((E_1\\;E_2)) = np(E_1) - 1$。\n\n本题中，我们用一个正整数同时表示一个基本函数，以及该基本函数的参数个数。\n\n对于一个组合子项 $E$，如果它和它包含的所有组合子项的参数个数 $np$ 均为正整数，那么我们称这个 $E$ 为范式。\n\n我们经常组合子项简化表示：如果一个组合子项$E$含有连续子序列$(… ((E_1\\;E_2)\\;E_3) …E_n)$ (其中 $n ≥ 3$)，其中$E_k$表示组合子项(可以是简化表示的)，那么将该部分替换为$(E_1\\;E_2\\;E_3 … E_n)$，其他部分不变，得到表达式 $E$ 的一个简化表示。一个组合子项可以被简化表示多次。\n\n给定一个基本函数序列，问至少需要添加多少对括号，才能使得该表达式成为一个范式的简化表示(即满足范式的性质)；如果无论如何怎样添加括号，均不能得到范式的简化表示，输出$-1$。", "inputFormat": "第一行包含一个正整数 $T$，表示有 $T$ 次询问。\n\n接下来 $2T$ 行。\n\n第 $2k$ 行有一个正整数$n_k$，表示第 $k$ 次询问的序列中基本函数的个数。\n\n第 $2k + 1$ 行有$n_k$个正整数，其中第 $i$ 个整数表示序列中第 $i$ 个基本函数。", "outputFormat": "输出 $T$ 行，每行一个整数，表示对应询问的输出结果。", "hint": "**【样例说明】**\n\n第一次询问：一个最优方案是(3 (2 1) (3 2))。可以证明不存在添加括号对数更少的方案。\n\n第二次询问：容易证明不存在合法方案。\n\n**【数据规模和约定】**\n\n令 $TN$ 表示输入中所有$n_k$的和。\n\n测试点编号|规模\n:-:|:-:\n1|$T ≤ 30,n_k ≤ 3$\n2|$T ≤ 30,n_k ≤ 15$\n3|$TN ≤ 100$\n4|$TN ≤ 500$\n5|$TN ≤ 2000$\n6|$TN ≤ 5000$\n7|$TN ≤ 5000$\n8|$TN ≤ 1000000$\n9|$TN ≤ 2000000$\n10|$TN ≤ 2000000$", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2013] Combinatory Logic", "background": "", "description": "Combinatory logic is a symbolic system invented by Moses Schönfinkel and Haskell Curry to eliminate the need for variables in mathematical logic. This problem considers a combinator system that slightly differs from the one in the real world.\n\nA combinator term is one of the following forms:\n\n$$P$$\n\n$$(E_1\\;E_2)$$\n\nHere $P$ denotes a primitive function, and $E_1$ and $E_2$ are combinator terms (they may be the same). Any expression not in the above forms is not a combinator term.\n\nWe define the number of arguments of a combinator term $E$, denoted $np(E)$, as follows:\n\n$np(P)$ equals the number of arguments (arity) of the primitive function $P$.\n\n$np((E_1\\;E_2)) = np(E_1) - 1$.\n\nIn this problem, we use a positive integer to denote both a primitive function and the arity of that primitive function.\n\nFor a combinator term $E$, if $np$ of $E$ and of all combinator subterms it contains are positive integers, we say that $E$ is in normal form.\n\nWe often use a simplified notation for combinator terms: if a combinator term $E$ contains a consecutive subsequence $(… ((E_1\\;E_2)\\;E_3) …E_n)$ (where $n ≥ 3$), where each $E_k$ denotes a combinator term (which may itself be in simplified notation), then we replace that part by $(E_1\\;E_2\\;E_3 … E_n)$ while keeping the rest unchanged, obtaining a simplified representation of $E$. A combinator term may be simplified in this way multiple times.\n\nGiven a sequence of primitive functions, determine the minimum number of pairs of parentheses that must be added to make the expression a simplified representation of a normal form (i.e., it satisfies the normal-form property). If it is impossible to obtain a simplified representation of a normal form no matter how you add parentheses, output $-1$.", "inputFormat": "The first line contains a positive integer $T$, the number of queries.\n\nThen follow $2T$ lines.\n\nLine $2k$ contains a positive integer $n_k$, the number of primitive functions in the sequence of the $k$-th query.\n\nLine $2k + 1$ contains $n_k$ positive integers, where the $i$-th integer denotes the $i$-th primitive function in the sequence.", "outputFormat": "Output $T$ lines, each containing one integer, the answer for the corresponding query.", "hint": "【Sample Explanation】\n\nFor the first query: an optimal plan is (3 (2 1) (3 2)). One can prove that there is no plan that uses fewer pairs of parentheses.\n\nFor the second query: it is easy to prove that no valid plan exists.\n\n【Constraints】\n\nLet $TN$ denote the sum of all $n_k$ in the input.\n\n测试点编号|规模\n:-:|:-:\n1|$T ≤ 30, n_k ≤ 3$\n2|$T ≤ 30, n_k ≤ 15$\n3|$TN ≤ 100$\n4|$TN ≤ 500$\n5|$TN ≤ 2000$\n6|$TN ≤ 5000$\n7|$TN ≤ 5000$\n8|$TN ≤ 1000000$\n9|$TN ≤ 2000000$\n10|$TN ≤ 2000000$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2013] 组合子逻辑", "background": "", "description": "组合子逻辑是 Moses Schönfinkel 和 Haskell Curry 发明的一种符号系统，用于消除数理逻辑中对于变量的需要。本题考察一种与真实世界的组合子演算略有差别的组合子系统。\n\n一个组合子项是下列形式之一：\n\n$$P$$\n\n$$(E_1\\;E_2)$$\n\n其中 $P$ 表示一个基本函数，$E_1$以及$E_2$表示一个组合子项(可以相同)。不满足以上形式表达式均非组合子项。\n\n我们将一个组合子项 $E$ 的参数个数 $np(E)$如下：\n\n$np(P)$ = 基本函数 $P$ 的参数个数；\n\n$np((E_1\\;E_2)) = np(E_1) - 1$。\n\n本题中，我们用一个正整数同时表示一个基本函数，以及该基本函数的参数个数。\n\n对于一个组合子项 $E$，如果它和它包含的所有组合子项的参数个数 $np$ 均为正整数，那么我们称这个 $E$ 为范式。\n\n我们经常组合子项简化表示：如果一个组合子项$E$含有连续子序列$(… ((E_1\\;E_2)\\;E_3) …E_n)$ (其中 $n ≥ 3$)，其中$E_k$表示组合子项(可以是简化表示的)，那么将该部分替换为$(E_1\\;E_2\\;E_3 … E_n)$，其他部分不变，得到表达式 $E$ 的一个简化表示。一个组合子项可以被简化表示多次。\n\n给定一个基本函数序列，问至少需要添加多少对括号，才能使得该表达式成为一个范式的简化表示(即满足范式的性质)；如果无论如何怎样添加括号，均不能得到范式的简化表示，输出$-1$。", "inputFormat": "第一行包含一个正整数 $T$，表示有 $T$ 次询问。\n\n接下来 $2T$ 行。\n\n第 $2k$ 行有一个正整数$n_k$，表示第 $k$ 次询问的序列中基本函数的个数。\n\n第 $2k + 1$ 行有$n_k$个正整数，其中第 $i$ 个整数表示序列中第 $i$ 个基本函数。", "outputFormat": "输出 $T$ 行，每行一个整数，表示对应询问的输出结果。", "hint": "**【样例说明】**\n\n第一次询问：一个最优方案是(3 (2 1) (3 2))。可以证明不存在添加括号对数更少的方案。\n\n第二次询问：容易证明不存在合法方案。\n\n**【数据规模和约定】**\n\n令 $TN$ 表示输入中所有$n_k$的和。\n\n测试点编号|规模\n:-:|:-:\n1|$T ≤ 30,n_k ≤ 3$\n2|$T ≤ 30,n_k ≤ 15$\n3|$TN ≤ 100$\n4|$TN ≤ 500$\n5|$TN ≤ 2000$\n6|$TN ≤ 5000$\n7|$TN ≤ 5000$\n8|$TN ≤ 1000000$\n9|$TN ≤ 2000000$\n10|$TN ≤ 2000000$", "locale": "zh-CN"}}}
{"pid": "P4506", "type": "P", "difficulty": 6, "samples": [["8x^7-258x^5+2112x^3-512x", "8(x-4)^2(x-1/2)x(x+1/2)(x+4)^2"], ["-x^2+2x-1", "-(x-1)^2"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2013", "CTSC/CTS"], "title": "[CTSC2013] 因式分解", "background": "", "description": "通过代数基本定理，我们知道若计算重根，一个 n 次的多项式在复数域内恰好有 n 个零点(函数值为 0 的点)。现给定一个整系数多项式 F[x]，它的 n 个零点恰好都是有理数(即可以写成两个整数相除的形式)；同时，若我们把它所有的非零零点(函数自变量不为 0，函数值为 0)去重，则可以得到 r 个互不相同的非零零点，其中第 i 个非零零点可以被表示成下式：\n\n$$sgn_i \\times \\frac{q_i}{p_i}$$\n\n式中$sgn_i$表示第 i 个零点的符号，$p_i$和$q_i$为互质的两个正整数。\n\n现在告诉你 F[x]，要求你输出将他因式分解后的形式。", "inputFormat": "输入只有一行，包含多项式 F[x]。\n\n多项式一定是如下的形式：\n\n$a_n x$^$n + a_{n-1}x$^${n - 1} + ⋯ a_1x + a_0$\n\n次数一定为从高到低，其中$a_i$为整数，并且若$a_i$为 0，则省略该项，若$a_i$为负数，则省略之前的加号，若$a_i$的绝对值为 1 且 i 不为 0，则不输出 1，并且保证$a_n$不为 0.\n\n详见样例输入。", "outputFormat": "输出一行，表示因式分解后的形式，格式如下：\n\n$a_n (x + u_1/v_1)$^$t_1(x + u_2/v_2)$^$t_2 … (x + u_s/v_s)$^$t_s$\n\n其中 u，v 互质，且 v 为正整数。\n\n其中$u_i/v_i$从大到小排列，若$u_i/v_i = 0$ 则该项为 $x$^$t_i$，若$u_i/v_i$为负数，则省略加号，若$v_i$为 $1$，则省略$/v_i$。\n\n若$t_i$为 $1$ 则省略^$t_i$。\n\n若$a_n$为$±1$ 则将 $1$ 省略。\n\n详见样例输出。", "hint": "测试点编号|多项式最高次数|互异零点数|系数范围(绝对值)\n:-:|:-:|:-:|:-:\n$1$|$2$|$2$|$≤ 10$\n$2$|$4$|$4$|$≤ 100$\n$3$|$7$|$7$|$≤ 10 ^ 6$\n$4$|$10$|$10$|$≤ 10 ^ 7$\n$5$|$12$|$12$|$≤ 10 ^ {16}$\n$6$|$35$|$5$|$≤ 10 ^ {24}$\n$7$|$39$|$5$|$≤ 10 ^ {68}$\n$8$|$46$|$4$|$≤ 10 ^ {104}$\n$9$|$80$|$2$|$≤ 10 ^ {12}$\n$10$|$50$|$1$|$≤ 10 ^ {316}$\n\n$p_i,q_i$满足：\n\n$$\\prod_{i=1}^rp_i≤10^6,\\prod_{i=1}^rq_i≤10^6$$", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2013] Factorization", "background": "", "description": "By the Fundamental Theorem of Algebra, counting multiplicity, a degree $n$ polynomial over the complex numbers has exactly $n$ zeros (points where the function value is $0$). You are given an integer-coefficient polynomial $F[x]$ whose $n$ zeros are all rational numbers (i.e., can be written as a ratio of two integers). If we deduplicate all nonzero zeros (the variable is not $0$ while the function value is $0$), we obtain $r$ distinct nonzero zeros, where the $i$-th nonzero zero can be written as:\n$$sgn_i \\times \\frac{q_i}{p_i}$$\nHere $sgn_i$ denotes the sign of the $i$-th zero, and $p_i$ and $q_i$ are two coprime positive integers.\n\nYou are given $F[x]$. Output its factorized form.", "inputFormat": "The input contains exactly one line: the polynomial $F[x]$.\n\nThe polynomial is always given in the following form:\n$ a_n x^n + a_{n-1} x^{n-1} + \\cdots + a_1 x + a_0 $\n\nThe terms are in descending degree. Each $a_i$ is an integer. If $a_i = 0$, that term is omitted. If $a_i$ is negative, the preceding plus sign is omitted. If $|a_i| = 1$ and $i \\ne 0$, the $1$ is not printed. It is guaranteed that $a_n \\ne 0$. See the sample input.", "outputFormat": "Output one line: the factorized form in the following format:\n$ a_n (x + u_1 / v_1)^{t_1} (x + u_2 / v_2)^{t_2} \\cdots (x + u_s / v_s)^{t_s} $\n\nHere $u$ and $v$ are coprime, and $v$ is a positive integer.\n\n$u_i / v_i$ are sorted from largest to smallest. If $u_i / v_i = 0$, that factor is $x^{t_i}$. If $u_i / v_i$ is negative, the plus sign is omitted. If $v_i = 1$, then $/ v_i$ is omitted.\n\nIf $t_i = 1$, the exponent is omitted.\n\nIf $a_n = \\pm 1$, the $1$ is omitted. See the sample output.", "hint": "测试点编号|多项式最高次数|互异零点数|系数范围(绝对值)\n:-:|:-:|:-:|:-:\n$1$|$2$|$2$|$\\le 10$\n$2$|$4$|$4$|$\\le 100$\n$3$|$7$|$7$|$\\le 10^6$\n$4$|$10$|$10$|$\\le 10^7$\n$5$|$12$|$12$|$\\le 10^{16}$\n$6$|$35$|$5$|$\\le 10^{24}$\n$7$|$39$|$5$|$\\le 10^{68}$\n$8$|$46$|$4$|$\\le 10^{104}$\n$9$|$80$|$2$|$\\le 10^{12}$\n$10$|$50$|$1$|$\\le 10^{316}$\n\n$p_i, q_i$ satisfy:\n$$\\prod_{i=1}^r p_i \\le 10^6, \\prod_{i=1}^r q_i \\le 10^6.$$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2013] 因式分解", "background": "", "description": "通过代数基本定理，我们知道若计算重根，一个 n 次的多项式在复数域内恰好有 n 个零点(函数值为 0 的点)。现给定一个整系数多项式 F[x]，它的 n 个零点恰好都是有理数(即可以写成两个整数相除的形式)；同时，若我们把它所有的非零零点(函数自变量不为 0，函数值为 0)去重，则可以得到 r 个互不相同的非零零点，其中第 i 个非零零点可以被表示成下式：\n\n$$sgn_i \\times \\frac{q_i}{p_i}$$\n\n式中$sgn_i$表示第 i 个零点的符号，$p_i$和$q_i$为互质的两个正整数。\n\n现在告诉你 F[x]，要求你输出将他因式分解后的形式。", "inputFormat": "输入只有一行，包含多项式 F[x]。\n\n多项式一定是如下的形式：\n\n$a_n x$^$n + a_{n-1}x$^${n - 1} + ⋯ a_1x + a_0$\n\n次数一定为从高到低，其中$a_i$为整数，并且若$a_i$为 0，则省略该项，若$a_i$为负数，则省略之前的加号，若$a_i$的绝对值为 1 且 i 不为 0，则不输出 1，并且保证$a_n$不为 0.\n\n详见样例输入。", "outputFormat": "输出一行，表示因式分解后的形式，格式如下：\n\n$a_n (x + u_1/v_1)$^$t_1(x + u_2/v_2)$^$t_2 … (x + u_s/v_s)$^$t_s$\n\n其中 u，v 互质，且 v 为正整数。\n\n其中$u_i/v_i$从大到小排列，若$u_i/v_i = 0$ 则该项为 $x$^$t_i$，若$u_i/v_i$为负数，则省略加号，若$v_i$为 $1$，则省略$/v_i$。\n\n若$t_i$为 $1$ 则省略^$t_i$。\n\n若$a_n$为$±1$ 则将 $1$ 省略。\n\n详见样例输出。", "hint": "测试点编号|多项式最高次数|互异零点数|系数范围(绝对值)\n:-:|:-:|:-:|:-:\n$1$|$2$|$2$|$≤ 10$\n$2$|$4$|$4$|$≤ 100$\n$3$|$7$|$7$|$≤ 10 ^ 6$\n$4$|$10$|$10$|$≤ 10 ^ 7$\n$5$|$12$|$12$|$≤ 10 ^ {16}$\n$6$|$35$|$5$|$≤ 10 ^ {24}$\n$7$|$39$|$5$|$≤ 10 ^ {68}$\n$8$|$46$|$4$|$≤ 10 ^ {104}$\n$9$|$80$|$2$|$≤ 10 ^ {12}$\n$10$|$50$|$1$|$≤ 10 ^ {316}$\n\n$p_i,q_i$满足：\n\n$$\\prod_{i=1}^rp_i≤10^6,\\prod_{i=1}^rq_i≤10^6$$", "locale": "zh-CN"}}}
{"pid": "P4507", "type": "P", "difficulty": 6, "samples": [["3 4\n0.50 0.60 0.40\n0.40 0.50 0.70\n0.60 0.30 0.50\n110\n011\n111\n000", "0.71304348\n0.66086957\n1.00000000\n0.00000000"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2013", "Special Judge", "CTSC/CTS"], "title": "[CTSC2013] 猴子大战", "background": "", "description": "小 Q 和小 M 最近发明了一种卡牌游戏，叫猴子大战。\n\n游戏最初小 Q 和小 M 各会取得一部分猴子牌。每局游戏，他们两个需要分别等概率地从自己的猴子牌中抽取一张进行战斗。获胜的一方将获得双方的猴子牌。如果一方获得了所有的猴子牌，则该方获得整场游戏的胜利。否则游戏将一直进行下去。\n\n在进行了若干场比赛以后，小 Q 和小 M 算出了一张胜率表，为每张猴子牌之间进行战斗双方获胜的概率。由于每场战斗一定会决出胜负，而且胜率不受先后顺序的影响，因此对于任意的两张猴子牌 A 和 B，A 战胜 B 的概率加 B 战胜 A 的概率为 $1$。\n\n由于自己老是输给小 M，小 Q 开始怀疑自己每次拿到的猴子牌是否能获得胜利。他希望求出自己拿到的每种猴子牌组合的获胜的概率。\n\n由于小 Q 接下来还有在 CD 市体育中心数以万计的运动计划，因此这个问题只能交给你来解决了。", "inputFormat": "输入的第一行包含两个正整数 $n$ 和 $m$，表示猴子牌的总张数和需要求的猴子牌组合的个数。\n\n接下来有 $n$ 行，每行包含 $n$ 个实数，每个实数保留了两位小数。这 $n$ 行中，其中第 $i$ 行第 $j$ 列的数为$P_{i,j}$，表示第 i 张猴子牌战胜第 $j$ 张猴子牌的概率。保证$P_{i,j} + P_{j,i} = 1$。特别地，$P_{i,i} = 0.5$，没有特殊意义。\n\n最后有 $m$ 行。每行包含一个长度为 $n$ 的无空格分隔的 $01$ 串，表示一个猴子牌的组合。其中第 $i$ 个字符如果为 $0$，表示最初第 $i$ 张牌在小 M 处，否则表示在小 Q 处。", "outputFormat": "输出 $m$ 行，每行一个实数，四舍五入保留八位小数（请强制输出八位浮点数），依次表示每个给定的猴子牌组合下小 Q 获胜的概率。", "hint": "**【评分方法】**\n\n你的答案的每一行如果与我们给定的参考答案的差别均不超过 $2 \\times 10^{-6}$，则获得该测试点的得分，否则不得分。\n\n参考答案保证与真实值的差别不超过 $10 ^ {-8}$，因此如果你输出的答案保证与真实值差别不超过 $2 \\times 10^{-6}\\sim 10 ^ {-8}$，才能保证正确。\n\n**【数据规模及约定】**\n\n对于每组数据，$n$ 的取值如下\n\n测试点编号|$n$|测试点编号|$n$\n:-:|:-:|:-:|:-:\n1|$n = 2$|6|$n = 20$\n2|$n = 5$|7|$n = 40$\n3|$n = 7$|8|$n = 60$\n4|$n = 8$|9|$n = 80$\n5|$n = 10$|10|$n = 100$\n\n对于 100%的数据，保证 $1 ≤ n ≤ 100$，$1 ≤ m ≤ n^2$。$0 ≤ P_{i,j} ≤ 1$，$P_{i,j}$恰好包含 $2$ 位小数，且 $P_{i,j} + P_{j,i} = 1$.表示猴子牌组合的 $01$ 串长度均为 $n$，且不含其他字符。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2013] Monkey War", "background": "", "description": "Xiao Q and Xiao M recently invented a card game called Monkey War.\n\nAt the start, Xiao Q and Xiao M each receive some monkey cards. In each round, the two players independently draw one card uniformly at random from their own current cards to fight. The winner takes both cards used in that round. If one player obtains all the monkey cards, that player wins the whole game; otherwise, the game continues.\n\nAfter several matches, Xiao Q and Xiao M computed a win-rate table that gives, for every pair of monkey cards, the probability that one card beats the other. Since every fight has a decisive outcome and the win rate does not depend on order, for any two cards A and B, the probability that A beats B plus the probability that B beats A is $1$.\n\nSince he keeps losing to Xiao M, Xiao Q starts to doubt whether the cards he gets can ever win overall. He wants the probability that he wins for every initial allocation of monkey cards he might receive.\n\nBecause Xiao Q has tens of thousands of sports plans coming up at the CD City Sports Center, this problem is left to you to solve.", "inputFormat": "The first line contains two positive integers $n$ and $m$, the total number of monkey cards and the number of initial allocations to query.\n\nThe next $n$ lines each contain $n$ real numbers with two decimal places. Among these $n$ lines, the number in row $i$, column $j$ is $P_{i,j}$, the probability that card $i$ beats card $j$. It is guaranteed that $P_{i,j} + P_{j,i} = 1$. In particular, $P_{i,i} = 0.5$, which has no special meaning.\n\nThe last $m$ lines each contain a length-$n$ 01 string with no spaces, representing an initial allocation of cards. If the $i$-th character is '0', then card $i$ initially belongs to Xiao M; otherwise it belongs to Xiao Q.", "outputFormat": "Output $m$ lines. Each line should contain a real number, rounded to 8 decimal places (print exactly 8 digits after the decimal point), representing Xiao Q’s probability of winning under the corresponding initial allocation.", "hint": "Scoring method:\n- If each line of your output differs from the reference answer by at most $2 \\times 10^{-6}$, you will receive credit for that test point; otherwise, you will receive no credit.\n- The reference answers differ from the true values by at most $10^{-8}$. Therefore, to be correct, your output should differ from the true values by at most $2 \\times 10^{-6} \\sim 10^{-8}$.\n\nConstraints:\n- For each set of testdata, $n$ takes the following values:\n\nTest point ID|$n$|Test point ID|$n$\n:-:|:-:|:-:|:-:\n1|$n = 2$|6|$n = 20$\n2|$n = 5$|7|$n = 40$\n3|$n = 7$|8|$n = 60$\n4|$n = 8$|9|$n = 80$\n5|$n = 10$|10|$n = 100$\n\n- For 100% of the testdata, $1 \\le n \\le 100$, $1 \\le m \\le n^2$. $0 \\le P_{i,j} \\le 1$, $P_{i,j}$ has exactly 2 decimal places, and $P_{i,j} + P_{j,i} = 1$. The 01 strings that represent initial allocations all have length $n$ and contain no other characters.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2013] 猴子大战", "background": "", "description": "小 Q 和小 M 最近发明了一种卡牌游戏，叫猴子大战。\n\n游戏最初小 Q 和小 M 各会取得一部分猴子牌。每局游戏，他们两个需要分别等概率地从自己的猴子牌中抽取一张进行战斗。获胜的一方将获得双方的猴子牌。如果一方获得了所有的猴子牌，则该方获得整场游戏的胜利。否则游戏将一直进行下去。\n\n在进行了若干场比赛以后，小 Q 和小 M 算出了一张胜率表，为每张猴子牌之间进行战斗双方获胜的概率。由于每场战斗一定会决出胜负，而且胜率不受先后顺序的影响，因此对于任意的两张猴子牌 A 和 B，A 战胜 B 的概率加 B 战胜 A 的概率为 $1$。\n\n由于自己老是输给小 M，小 Q 开始怀疑自己每次拿到的猴子牌是否能获得胜利。他希望求出自己拿到的每种猴子牌组合的获胜的概率。\n\n由于小 Q 接下来还有在 CD 市体育中心数以万计的运动计划，因此这个问题只能交给你来解决了。", "inputFormat": "输入的第一行包含两个正整数 $n$ 和 $m$，表示猴子牌的总张数和需要求的猴子牌组合的个数。\n\n接下来有 $n$ 行，每行包含 $n$ 个实数，每个实数保留了两位小数。这 $n$ 行中，其中第 $i$ 行第 $j$ 列的数为$P_{i,j}$，表示第 i 张猴子牌战胜第 $j$ 张猴子牌的概率。保证$P_{i,j} + P_{j,i} = 1$。特别地，$P_{i,i} = 0.5$，没有特殊意义。\n\n最后有 $m$ 行。每行包含一个长度为 $n$ 的无空格分隔的 $01$ 串，表示一个猴子牌的组合。其中第 $i$ 个字符如果为 $0$，表示最初第 $i$ 张牌在小 M 处，否则表示在小 Q 处。", "outputFormat": "输出 $m$ 行，每行一个实数，四舍五入保留八位小数（请强制输出八位浮点数），依次表示每个给定的猴子牌组合下小 Q 获胜的概率。", "hint": "**【评分方法】**\n\n你的答案的每一行如果与我们给定的参考答案的差别均不超过 $2 \\times 10^{-6}$，则获得该测试点的得分，否则不得分。\n\n参考答案保证与真实值的差别不超过 $10 ^ {-8}$，因此如果你输出的答案保证与真实值差别不超过 $2 \\times 10^{-6}\\sim 10 ^ {-8}$，才能保证正确。\n\n**【数据规模及约定】**\n\n对于每组数据，$n$ 的取值如下\n\n测试点编号|$n$|测试点编号|$n$\n:-:|:-:|:-:|:-:\n1|$n = 2$|6|$n = 20$\n2|$n = 5$|7|$n = 40$\n3|$n = 7$|8|$n = 60$\n4|$n = 8$|9|$n = 80$\n5|$n = 10$|10|$n = 100$\n\n对于 100%的数据，保证 $1 ≤ n ≤ 100$，$1 ≤ m ≤ n^2$。$0 ≤ P_{i,j} ≤ 1$，$P_{i,j}$恰好包含 $2$ 位小数，且 $P_{i,j} + P_{j,i} = 1$.表示猴子牌组合的 $01$ 串长度均为 $n$，且不含其他字符。", "locale": "zh-CN"}}}
{"pid": "P4508", "type": "P", "difficulty": 7, "samples": [["8 6 1\n0.0 0.0 0.0\n0.0 0.0 1.0\n0.0 1.0 1.0\n0.0 1.0 0.0\n1.0 0.0 0.0\n1.0 0.0 1.0\n1.0 1.0 1.0\n1.0 1.0 0.0\n4 2 3 7 6\n4 5 6 7 8\n4 1 2 3 4\n4 1 2 6 5\n4 4 3 7 8\n4 1 4 8 5\n2.0 0.33 0.25\n2.0 0.67 0.25\n2.0 0.33 0.75\n-1.0 0.0 0.0", "0.17"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "提交答案", "CTSC/CTS"], "title": "[CTSC2011] 杀菌计划", "background": "输入数据下发链接: https://pan.baidu.com/s/1ltIqAf8bdtnAFrFTnVtgHA", "description": "栋栋有一个凸多面体形状的漂亮盒子，这个盒子的每个面都由形状为凸多边形的透明玻璃薄壁组成。\n\n每隔一段时间，栋栋就要使用一个激光发射器给他的盒子杀菌。激光发射器能发射出一束激光，当激光照射到盒子的玻璃薄壁时，会把薄壁内外两面的细菌杀死，同时有大量光线透射过玻璃，少量光线被玻璃反射。透射过玻璃的光线沿原方向前进，反射的光线遵循光线的镜面反射定理，即在反射时反射光线、入射光线和镜面的法线在同一平面内，反射光线与入射光线分居法线两侧，反射角（反射光线与法线的夹角）等于入射角（入射光线与法线的夹角）。\n\n我们认为激光被玻璃反射k 次后的能量不足以杀死细菌（即使有多个这样的光线同时照射在玻璃薄壁上也不能杀死细菌），而k 次反射前激光照射到的细菌都会被杀死。\n\n激光发射器的发射口是三角形的，当发射激光时，整个发射口都会发出激光。\n\n给定盒子和激光发射器的位置，栋栋想知道，盒子的玻璃薄壁上有多大面积\n的细菌被杀死了。由于盒子的内外两面的细菌必然是同时被杀死或者同时不被杀死，所以只要算出外面被杀死的细菌面积即可。\n\n注意，激光或经过反射的激光可能与某些表面平行，但本题的数据保证激光或经过反射的激光不会照射到与之平行的表面。", "inputFormat": "本题是一道提交答案型试题，所有输入数据box1.in ~ box10.in 已放在了试题的目录下。每个输入数据满足下面的输入格式，每两个数之间用一个空格隔开：\n\n输入的第一行包含三个整数$n, m, k$，分别表示盒子的顶点数、盒子的面数和光线的反射次数。\n\n接下来$n$ 行，第$i$ 行包含三个实数$x_i, y_i, z_i$，表示盒子第$i$ 个顶点的坐标。\n\n接下来$m$ 行，每行描述盒子的一个表面，每行第一个数$t_j$，表示该表面的多边形的顶点个数，接下来$t_j$ 个整数，表示这$t_j$ 个顶点对应的盒子顶点的编号，这些编号按顶点在面上的顺时针或逆时针顺序给出。\n\n接下来三行，每行$3$ 个整数$x, y, z$，分别表示激光发射器发射口的坐标。\n\n接下来$1$ 行，包含3 个整数$Δx, Δy, Δz$，表示出射光线的方向是沿着向量$(Δx, Δy, Δz)$的方向。", "outputFormat": "针对给定的10 个输入文件box1.in ~ box10.in，你需要分别提交你的输出文\n件 box1.out ~ box10.out。每个输出文件包含一个实数，四舍五入保留两位小数，表示被杀死的细菌的面积。当一个表面被多次照射到时，这个表面的面积只计算一次。", "hint": "样例数据如下图所示，盒子是一个正方体的形状，激光从右边照射过来，照\n射到右侧面上，并透射过右侧面照射到左侧面上，将左右两侧面上的两个三角形区域的细菌杀死。在照射到左右侧面后激光都会发生反射，但由k=1，反射光线已不能将细菌杀死，所以不用考虑。\n\n![](https://cdn.luogu.com.cn/upload/pic/17995.png)", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2011] Sterilization Plan", "background": "Input data download link: https://pan.baidu.com/s/1ltIqAf8bdtnAFrFTnVtgHA.", "description": "Dongdong has a beautiful box shaped like a convex polyhedron. Each face of the box is a thin, transparent glass panel in the shape of a convex polygon.\n\nFrom time to time, Dongdong uses a laser emitter to sterilize his box. The emitter emits a laser beam. When the beam hits a glass panel, it kills the bacteria on both the inner and outer sides of that panel. A large portion of the light transmits through the glass, and a small portion is reflected. The transmitted light continues in the same direction. The reflected light obeys the law of specular reflection: at the point of reflection, the reflected ray, the incident ray, and the surface normal lie in the same plane; the reflected ray and the incident ray lie on opposite sides of the normal; and the angle of reflection (between the reflected ray and the normal) equals the angle of incidence (between the incident ray and the normal).\n\nWe assume that after being reflected $k$ times, the laser does not have enough energy to kill bacteria (even if multiple such rays hit a glass panel simultaneously, they still cannot kill bacteria). Before $k$ reflections, all bacteria illuminated by the laser are killed.\n\nThe emitter’s aperture is triangular, and when the laser is fired, the entire aperture emits light.\n\nGiven the box and the position of the laser emitter, Dongdong wants to know the total area of bacteria killed on the box’s glass panels. Since the bacteria on the inner and outer sides of a panel are either both killed or both not killed, it suffices to compute the area killed on the outside.\n\nNote: A laser ray or a reflected ray may be parallel to some surfaces, but the testdata guarantees that no ray will illuminate any surface that is parallel to it.", "inputFormat": "This is an answer-only problem. All input files box1.in ~ box10.in are provided in the problem directory. Each input file follows the format below, with a single space between any two numbers.\n\n- The first line contains three integers $n, m, k$, denoting the number of vertices of the box, the number of faces, and the reflection limit, respectively.\n- The next $n$ lines: line $i$ contains three real numbers $x_i, y_i, z_i$, which are the coordinates of vertex $i$ of the box.\n- The next $m$ lines: each line describes one face of the box. The first number is $t_j$, the number of vertices of this polygonal face, followed by $t_j$ integers giving the indices of the corresponding box vertices in clockwise or counterclockwise order along the face.\n- The next three lines: each contains $3$ integers $x, y, z$, giving the coordinates of the laser emitter’s triangular aperture (these are its three vertices).\n- The next one line contains $3$ integers $\\Delta x, \\Delta y, \\Delta z$, indicating that the emitted rays travel in the direction of the vector $(\\Delta x, \\Delta y, \\Delta z)$.", "outputFormat": "For the given 10 input files box1.in ~ box10.in, you must submit 10 corresponding output files box1.out ~ box10.out. Each output file contains a single real number, rounded to two decimal places, representing the total area of bacteria killed. If a face is illuminated multiple times, its area is counted only once.", "hint": "As shown in the sample figure, the box is a cube. The laser comes from the right, hits the right face, and, after transmitting through the right face, hits the left face, killing two triangular regions on the left and right faces. The rays also reflect at both faces, but since $k = 1$, the reflected rays can no longer kill bacteria, so they can be ignored.\n\n![](https://cdn.luogu.com.cn/upload/pic/17995.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2011] 杀菌计划", "background": "输入数据下发链接: https://pan.baidu.com/s/1ltIqAf8bdtnAFrFTnVtgHA", "description": "栋栋有一个凸多面体形状的漂亮盒子，这个盒子的每个面都由形状为凸多边形的透明玻璃薄壁组成。\n\n每隔一段时间，栋栋就要使用一个激光发射器给他的盒子杀菌。激光发射器能发射出一束激光，当激光照射到盒子的玻璃薄壁时，会把薄壁内外两面的细菌杀死，同时有大量光线透射过玻璃，少量光线被玻璃反射。透射过玻璃的光线沿原方向前进，反射的光线遵循光线的镜面反射定理，即在反射时反射光线、入射光线和镜面的法线在同一平面内，反射光线与入射光线分居法线两侧，反射角（反射光线与法线的夹角）等于入射角（入射光线与法线的夹角）。\n\n我们认为激光被玻璃反射k 次后的能量不足以杀死细菌（即使有多个这样的光线同时照射在玻璃薄壁上也不能杀死细菌），而k 次反射前激光照射到的细菌都会被杀死。\n\n激光发射器的发射口是三角形的，当发射激光时，整个发射口都会发出激光。\n\n给定盒子和激光发射器的位置，栋栋想知道，盒子的玻璃薄壁上有多大面积\n的细菌被杀死了。由于盒子的内外两面的细菌必然是同时被杀死或者同时不被杀死，所以只要算出外面被杀死的细菌面积即可。\n\n注意，激光或经过反射的激光可能与某些表面平行，但本题的数据保证激光或经过反射的激光不会照射到与之平行的表面。", "inputFormat": "本题是一道提交答案型试题，所有输入数据box1.in ~ box10.in 已放在了试题的目录下。每个输入数据满足下面的输入格式，每两个数之间用一个空格隔开：\n\n输入的第一行包含三个整数$n, m, k$，分别表示盒子的顶点数、盒子的面数和光线的反射次数。\n\n接下来$n$ 行，第$i$ 行包含三个实数$x_i, y_i, z_i$，表示盒子第$i$ 个顶点的坐标。\n\n接下来$m$ 行，每行描述盒子的一个表面，每行第一个数$t_j$，表示该表面的多边形的顶点个数，接下来$t_j$ 个整数，表示这$t_j$ 个顶点对应的盒子顶点的编号，这些编号按顶点在面上的顺时针或逆时针顺序给出。\n\n接下来三行，每行$3$ 个整数$x, y, z$，分别表示激光发射器发射口的坐标。\n\n接下来$1$ 行，包含3 个整数$Δx, Δy, Δz$，表示出射光线的方向是沿着向量$(Δx, Δy, Δz)$的方向。", "outputFormat": "针对给定的10 个输入文件box1.in ~ box10.in，你需要分别提交你的输出文\n件 box1.out ~ box10.out。每个输出文件包含一个实数，四舍五入保留两位小数，表示被杀死的细菌的面积。当一个表面被多次照射到时，这个表面的面积只计算一次。", "hint": "样例数据如下图所示，盒子是一个正方体的形状，激光从右边照射过来，照\n射到右侧面上，并透射过右侧面照射到左侧面上，将左右两侧面上的两个三角形区域的细菌杀死。在照射到左右侧面后激光都会发生反射，但由k=1，反射光线已不能将细菌杀死，所以不用考虑。\n\n![](https://cdn.luogu.com.cn/upload/pic/17995.png)", "locale": "zh-CN"}}}
{"pid": "P4509", "type": "P", "difficulty": 6, "samples": [["2 3 0\n0 0\n1 1\nH 0 1 0 -1 1\nH 1 0 1 1 1\nH 2 -1 -1 1 1", "1\n0\n1"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "CTSC/CTS"], "title": "[CTSC2015] 葱", "background": "", "description": "小葱和小绪是一对好朋友，自从小葱11连出了1UR2SR之后，小绪就觉得小葱的人品特别好，于是小绪给小葱出了一道题来测试小葱的人品。 \n\n小绪首先在平面上画了$N$个点，分别是$P_1,P_2,...,P_N$。\n\n小绪把这$N个点$顺次相连，即连接$(P_1,P_2),(P_2,P_3),...,(P_{N-1},P_N)$，得到$N-1$条线段。 \n\n之后小绪每次在平面上画出一条直线，然后问小葱这条直线与多少条线段相交。特别的，在线段端点处相交算作相交，直线完全覆盖线段时也算作相交。 这样的问题自然难不倒小葱，小葱只需要凭自己的人品用直觉就能给出正确的答案。 \n\n小绪想测试小葱的人品究竟有多好，于是他加大了问题的难度： 除了每次询问以外，小绪会不时地讲一个新的点$P$插入到$P_i$和$P_{i+1}$之间，然后按照顺序对所有的点重新标记下标，即在$P_i$之后的点的下标会依次增加，而点$P$会变成新的点$P_{i+1}$。\n\n特别的，点$P$也可以插入到第一个点之前或最后一个点之后。\n \n人品超级好的小葱依旧能够轻松的给出答案，于是小绪又进一步提高了难度： \n\n每次插入或提问之后，小绪都将操作后的所有线段记录了下来，称作一个历史版本。历史版本$T$表示在第$T$次操作后得到的历史版本。 \n\n插入新点的操作改为了在某一个历史版本$T$的基础上，插入一个点$P$，并得到一个新的历史版本。 \n\n小绪对小葱的提问改为了对于一个历史版本$T$，给出一条直线，询问这条直线会与多少条线段相交。 \n\n小葱虽然人品很好，但面对这样的问题却也束手无策了，他只好找到来参加CTSC的你，请你来帮他解决这个问题。 ", "inputFormat": "第一行两个整数$N,M,C$，表示一开始的点数和总共的操作数，以及数据是否加密。\n\n如果$C=1$，那么代表数据被加密过，每次询问操作中的$X_0,Y_0,X,Y$以及插入操作中的$X,Y$都是被加密过的数据，你需要将它们异或last_ans从而得到正确的数据，其中last_ans是上一次询问的答案，刚开始last_ans=0。 \n\n接下来$N$行每行两个整数，其中第$i$行的两个整数表示$P_i$的横坐标和纵坐标。 \n\n接下来$M$行，表示小绪的$M$次操作，其中第$i$行（从$1$开始标号）操作后得到的结果为历史版本$i$。\n \n对于每次操作，首先会有一个字母代表小绪的这次操作的操作类型。\n \n如果这个字母是$'H'$，代表本次操作为一次询问操作。接下来会有五个整数$T,X_0,Y_0,X,Y$，代表在历史版本$T$的情况下，小绪给出一条经过$(X_0,Y_0)$，方向为$(X,Y)$的直线，小葱要回答出它会和多少条直线相交。 \n\n如果这个字母是$'Z'$，代表本次操作为一次插入操作。接下来会有四个数$T,i,X,Y$，代表小绪在历史版本$T$的基础上，在$P_i$后面插入了一个坐标为$(X,Y)$的点。特别地，如果$i=0$，表示该点在$P_1$之前。 ", "outputFormat": "要求对每一次询问操作，输出一行一个整数代表小葱应该回答的正确答案。 ", "hint": "样例解释1： \n\n对于第三次询问，直线完全覆盖了线段，小绪会认为这也算相交。 \n\n\n数据规模和约定： \n\n保证每次询问操作的$T$一定小于等于当前操作的数量，所有输入数据均为整数。 \n\n有以下$4$类特殊数据，它们两两没有交集： \n\n1. 对于10%的数据，保证$1≤N,M≤1000$； \n\n2. 对于15%的数据，保证对于第$i$次操作，$T=i-1$； \n\n3. 对于15%的数据，保证$C=0$且不存在修改操作； \n\n4. 对于15%的数据，对于询问操作，保证$Y=0$（加密过的数据指解密后的$Y$），即给出的直线平行于$x$轴。 \n\n以上数据还保证$1≤N,M≤5*10^4$。 \n\n对于100%的数据，保证$1≤N,M≤10^5$，所有的坐标范围在$[-10^8,10^8]$内，且每组数据中所有询问的答案总和不超过$10^6$，插入操作的次数不会超过$5*10^4$。注意这些线段可能会互相相交。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2015] Onion", "background": "", "description": "Xiao Cong and Xiao Xu are good friends. Since Xiao Cong pulled 1 UR and 2 SR in an 11-roll, Xiao Xu felt that Xiao Cong is very lucky, so he gave him a problem to test his luck.\n\nXiao Xu first drew $N$ points on the plane, denoted as $P_1, P_2, ..., P_N$.\n\nHe connected these $N$ points in order, that is, he connected $(P_1, P_2), (P_2, P_3), ..., (P_{N-1}, P_N)$ to obtain $N-1$ line segments.\n\nThen, each time Xiao Xu drew a line on the plane and asked how many segments this line intersects. In particular, intersection at a segment endpoint counts as intersecting, and if the line completely covers a segment, it also counts as intersecting. Such a question is obviously easy for Xiao Cong; he can give the correct answer by intuition alone thanks to his luck.\n\nTo further test Xiao Cong’s luck, Xiao Xu increased the difficulty: in addition to each query, he would occasionally insert a new point $P$ between $P_i$ and $P_{i+1}$, then relabel all points in order; that is, the indices of points after $P_i$ increase by one, and point $P$ becomes the new point $P_{i+1}$.\n\nIn particular, point $P$ can also be inserted before the first point or after the last point.\n\nXiao Cong is still able to answer easily, so Xiao Xu raised the difficulty again:\n\nAfter each insertion or query, Xiao Xu recorded all the resulting segments and regarded them as a historical version. Historical version $T$ denotes the state after the $T$-th operation.\n\nThe insertion operation was changed to: based on a certain historical version $T$, insert a point $P$ to obtain a new historical version.\n\nThe query was changed to: for a historical version $T$, given a line, ask how many segments this line will intersect.\n\nAlthough Xiao Cong has great luck, he is helpless in the face of such a problem. He turns to you, a participant of CTSC, to help him solve it.", "inputFormat": "The first line contains three integers $N, M, C$, denoting the initial number of points, the total number of operations, and whether the data are encrypted.\n\nIf $C=1$, it means the data are encrypted. In each query operation, $X_0, Y_0, X, Y$ and in each insertion operation, $X, Y$ are encrypted; you need to XOR them with last_ans to obtain the correct data, where last_ans is the answer to the previous query. Initially, last_ans $= 0$.\n\nThe next $N$ lines each contain two integers; on the $i$-th line, the two integers denote the coordinates of $P_i$.\n\nThe next $M$ lines describe Xiao Xu’s $M$ operations. The result after the $i$-th operation (1-indexed) is historical version $i$.\n\nFor each operation, there is first a letter indicating the operation type.\n\n- If the letter is 'H', this is a query operation. Then five integers $T, X_0, Y_0, X, Y$ follow, meaning that under historical version $T$, Xiao Xu gives a line passing through $(X_0, Y_0)$ with direction $(X, Y)$, and Xiao Cong must answer how many segments it intersects.\n- If the letter is 'Z', this is an insertion operation. Then four numbers $T, i, X, Y$ follow, meaning that based on historical version $T$, Xiao Xu inserts a point with coordinates $(X, Y)$ after $P_i$. In particular, if $i=0$, it means the point is inserted before $P_1$.", "outputFormat": "For each query operation, output one line with one integer representing the correct answer Xiao Cong should give.", "hint": "Sample explanation 1:\n\nFor the third query, the line completely covers a segment, and Xiao Xu considers this as intersecting as well.\n\nConstraints and notes:\n\nAll operations satisfy that in each query operation, $T$ is less than or equal to the current number of operations, and all input numbers are integers.\n\nThere are the following 4 special testdata groups, which are pairwise disjoint:\n\n1. For 10% of the testdata, $1 \\le N, M \\le 1000$.\n2. For 15% of the testdata, for the $i$-th operation, $T = i - 1$.\n3. For 15% of the testdata, $C=0$ and there are no modification operations.\n4. For 15% of the testdata, for query operations, $Y=0$ (this refers to the decrypted data), i.e., the given line is parallel to the $x$-axis.\n\nThe above testdata also guarantee $1 \\le N, M \\le 5 \\times 10^4$.\n\nFor 100% of the testdata, $1 \\le N, M \\le 10^5$, all coordinates are within $[-10^8, 10^8]$, and within each dataset the sum of answers over all queries does not exceed $10^6$. The number of insertion operations does not exceed $5 \\times 10^4$. Note that these segments may intersect each other.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2015] 葱", "background": "", "description": "小葱和小绪是一对好朋友，自从小葱11连出了1UR2SR之后，小绪就觉得小葱的人品特别好，于是小绪给小葱出了一道题来测试小葱的人品。 \n\n小绪首先在平面上画了$N$个点，分别是$P_1,P_2,...,P_N$。\n\n小绪把这$N个点$顺次相连，即连接$(P_1,P_2),(P_2,P_3),...,(P_{N-1},P_N)$，得到$N-1$条线段。 \n\n之后小绪每次在平面上画出一条直线，然后问小葱这条直线与多少条线段相交。特别的，在线段端点处相交算作相交，直线完全覆盖线段时也算作相交。 这样的问题自然难不倒小葱，小葱只需要凭自己的人品用直觉就能给出正确的答案。 \n\n小绪想测试小葱的人品究竟有多好，于是他加大了问题的难度： 除了每次询问以外，小绪会不时地讲一个新的点$P$插入到$P_i$和$P_{i+1}$之间，然后按照顺序对所有的点重新标记下标，即在$P_i$之后的点的下标会依次增加，而点$P$会变成新的点$P_{i+1}$。\n\n特别的，点$P$也可以插入到第一个点之前或最后一个点之后。\n \n人品超级好的小葱依旧能够轻松的给出答案，于是小绪又进一步提高了难度： \n\n每次插入或提问之后，小绪都将操作后的所有线段记录了下来，称作一个历史版本。历史版本$T$表示在第$T$次操作后得到的历史版本。 \n\n插入新点的操作改为了在某一个历史版本$T$的基础上，插入一个点$P$，并得到一个新的历史版本。 \n\n小绪对小葱的提问改为了对于一个历史版本$T$，给出一条直线，询问这条直线会与多少条线段相交。 \n\n小葱虽然人品很好，但面对这样的问题却也束手无策了，他只好找到来参加CTSC的你，请你来帮他解决这个问题。 ", "inputFormat": "第一行两个整数$N,M,C$，表示一开始的点数和总共的操作数，以及数据是否加密。\n\n如果$C=1$，那么代表数据被加密过，每次询问操作中的$X_0,Y_0,X,Y$以及插入操作中的$X,Y$都是被加密过的数据，你需要将它们异或last_ans从而得到正确的数据，其中last_ans是上一次询问的答案，刚开始last_ans=0。 \n\n接下来$N$行每行两个整数，其中第$i$行的两个整数表示$P_i$的横坐标和纵坐标。 \n\n接下来$M$行，表示小绪的$M$次操作，其中第$i$行（从$1$开始标号）操作后得到的结果为历史版本$i$。\n \n对于每次操作，首先会有一个字母代表小绪的这次操作的操作类型。\n \n如果这个字母是$'H'$，代表本次操作为一次询问操作。接下来会有五个整数$T,X_0,Y_0,X,Y$，代表在历史版本$T$的情况下，小绪给出一条经过$(X_0,Y_0)$，方向为$(X,Y)$的直线，小葱要回答出它会和多少条直线相交。 \n\n如果这个字母是$'Z'$，代表本次操作为一次插入操作。接下来会有四个数$T,i,X,Y$，代表小绪在历史版本$T$的基础上，在$P_i$后面插入了一个坐标为$(X,Y)$的点。特别地，如果$i=0$，表示该点在$P_1$之前。 ", "outputFormat": "要求对每一次询问操作，输出一行一个整数代表小葱应该回答的正确答案。 ", "hint": "样例解释1： \n\n对于第三次询问，直线完全覆盖了线段，小绪会认为这也算相交。 \n\n\n数据规模和约定： \n\n保证每次询问操作的$T$一定小于等于当前操作的数量，所有输入数据均为整数。 \n\n有以下$4$类特殊数据，它们两两没有交集： \n\n1. 对于10%的数据，保证$1≤N,M≤1000$； \n\n2. 对于15%的数据，保证对于第$i$次操作，$T=i-1$； \n\n3. 对于15%的数据，保证$C=0$且不存在修改操作； \n\n4. 对于15%的数据，对于询问操作，保证$Y=0$（加密过的数据指解密后的$Y$），即给出的直线平行于$x$轴。 \n\n以上数据还保证$1≤N,M≤5*10^4$。 \n\n对于100%的数据，保证$1≤N,M≤10^5$，所有的坐标范围在$[-10^8,10^8]$内，且每组数据中所有询问的答案总和不超过$10^6$，插入操作的次数不会超过$5*10^4$。注意这些线段可能会互相相交。", "locale": "zh-CN"}}}
{"pid": "P4510", "type": "P", "difficulty": 7, "samples": [["3 2 6 2\nMMMFFF\n10000 200 10 10000 200 10\n1 2 3 \n4 5 6 \n2 5 20 0.1\n3 6 20 0.9\n", "360\n"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "2015", "网络流", "CTSC/CTS"], "title": "[CTSC2015] 性别改造计划", "background": "", "description": "21 世纪是生命科学的世纪。人类投入了大量人力物力研究生命科学，旨在对各类生物的生存机理产生更加深入的理解，以更好地了解人类自身，提高生活质量。Q 国政府首先在绵羊中开展了性别改造研究，希望通过基因重组改变性别的方式增强整个绵羊种群的生存能力。若此计划能够顺利研究成功，人类将掌握随意改变动物性别的黑科技，这将是生命科学研究史上一个重要的里程碑。\n\nQ 国政府从绵羊群中挑出 $M$ 只绵羊作为实验样本，这 $M$ 只绵羊中存在 $K$ 条长度为 $N$ 的单一性别的血缘链。所谓 “血缘链” 是指的一条由父（母）子（女）关系组成的链，比如 “爷爷 - 爸爸 - 儿子” 就是一条血缘链。“单一性别” 的意思是每条血缘链中所有个体的性别均一致，同为雄性或同为雌性。血缘链长度指的是一条血缘链中个体的数量，比如 “爷爷 - 爸爸 - 儿子” 是一条长度为 $3$ 的血缘链。这 $K$ 条血缘链并不相交。\n\n注意并不是每只绵羊都必须属于一条血缘链，有些绵羊可能不属于任何血缘链，因此 $N\\times K\\leq M$。除去血缘链外，同辈绵羊还会有 “繁衍关系” 的存在。两只异性绵羊如果曾经繁殖过后代，那么它们之间就会产生 “繁衍关系”。注意繁衍关系只会出现在同辈异性绵羊个体之间，这里 “同辈” 表示两只绵羊的辈份相同，即绵羊只会与它的兄弟姐妹辈产生 “繁衍关系”，而不会与父母或子女或其他更远的辈份之间产生 “繁衍关系”。\n\n对绵羊进行性别修改需要花费巨大的实验开销，修改绵羊 $i$ 的性别需要花费 $c_i$ 的修改代价。除此以外，修改绵羊性别还会对繁衍关系的稳定度产生影响：每对繁衍关系 $j$ 有初始稳定度 $b_j$ 和衰减系数 $d_j$，当所有的性别修改操作完成后，若双方性别均未改变，则此关系稳定度 $s_j = b_j$，若双方性别互换，则稳定度 $s_j = \\lfloor b_jd_j\\rfloor$，其他情况下稳定度 $s_j = 0$。\n\n给定每只绵羊的性别，性别修改代价，所有血缘链关系很繁衍关系，Q 国政府希望你来设计一套性别改造方案，使总收益最大。收益计算方式如下：\n\n$$\nP = \\lfloor 10 \\ln(1 + A) \\rfloor \\times S - C\n$$\n\n其中 $A$ 为改造后血缘链相邻两者为异性的情况数量，$S$ 为改造后繁衍关系稳定度之和，即 $S = \\sum\\limits_js_j$，$C$ 为修改绵羊性别带来的代价之和，即 $C = \\sum\\limits_ic_i$。", "inputFormat": "第一行包含四个非负整数 $N, K, M, P$，分别为血缘链的长度，血缘链的数量，实验样本中的总绵羊数和繁衍关系的数量。\n\n第二行为一个 $M$ 个字符的字符串，每个字符为 `M` 或 `F`，描述了这 $M$ 只绵羊的初始性别。`M` 表示雄性，`F` 表示雌性。\n\n第三行 $M$ 个正整数 $c_i$，表示修改每只绵羊性别的代价。\n\n下面 $K$ 行每行 $N$ 个整数，分别描述这 $K$ 个血缘链中绵羊编号（所有绵羊用 $1$ 到 $M$ 的整数编号），保证每条链中的绵羊均为同性，且链互不交叠。\n\n下面 $P$ 行每行三个整数 $x, y, b$ 和一个实数 $d$，表示绵羊 $x$ 与绵羊 $y$ 存在繁衍关系，且初始关系稳定度为 $b$，衰减系数为 $d$。\n\n保证 $x$ 与 $y$ 的初始性别不同，$x$ 和 $y$ 为同辈，同一条关系只会在数据中描述一次。", "outputFormat": "仅包含一行一个整数，表示改造计划的最大收益。", "hint": "**【样例解释】**\n\n改性别为 `MMFFFM`。收益为 $\\lfloor 10 \\ln(1 + 2) \\rfloor \\times(20 + 18) - (10 + 10) = 360$。$A = 2$ 是因为血缘链 $1 - 2 - 3$ 中 $2$ 与 $3$ 性别的不同，血缘链 $4 - 5 - 6$ 中 $5$ 与 $6$ 的性别不同。\n\n**【数据范围】**\n\n对于 $10\\%$ 的数据，满足 $M\\leq 20$。\n\n对于 $10\\%$ 的数据，满足 $d_j = 0$。\n\n对于 $10\\%$ 的数据，满足 $d_j = 0.5$。\n\n上述三类数据两两没有交集。 \n\n对于 $100\\%$ 的数据，$1\\leq N\\leq 50$，$1\\leq K\\leq 4$，$1\\leq M\\leq 10 ^ 3$，$1\\leq P\\leq 10 ^ 4$，$0 \\leq d_j\\leq 1$，$0\\leq b_j, c_i \\le 10 ^ 4$，$d_j$ 的小数位数不超过 $6$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2015] Gender Modification Plan", "background": "", "description": "The 21st century is the century of life sciences. Humanity has invested extensive manpower and resources into life science research, aiming for a deeper understanding of the survival mechanisms of various organisms, so as to better understand ourselves and improve quality of life. The government of Country Q first launched gender modification research in sheep, hoping to enhance the survival ability of the entire sheep population by changing gender through gene recombination. If this plan succeeds, humans will master the black technology of arbitrarily changing animal gender, which will be an important milestone in the history of life science research.\n\nThe government of Country Q selects $M$ sheep from the flock as experimental samples. Among these $M$ sheep, there exist $K$ bloodline chains of length $N$, each of a single gender. A “bloodline chain” is a chain consisting of parent–child relationships, e.g., “grandfather – father – son” is a bloodline chain. “Single gender” means that all individuals in each bloodline chain are of the same gender, either all male or all female. The length of a bloodline chain is the number of individuals in the chain, e.g., “grandfather – father – son” has length $3$. These $K$ bloodline chains do not intersect.\n\nNote that not every sheep must belong to a bloodline chain; some sheep might belong to none. Therefore, $N \\times K \\leq M$. Beyond the bloodline chains, there can also be “mating relationships” among same-generation sheep. Two opposite-sex sheep that have reproduced offspring form a “mating relationship.” Note that a mating relationship only occurs between opposite-sex individuals of the same generation. Here, “same generation” means they are of the same generation level, i.e., a sheep only forms mating relationships with its siblings’ generation, and never with its parents, children, or individuals of more distant generations.\n\nChanging a sheep’s gender incurs a large experimental cost: changing the gender of sheep $i$ costs $c_i$. Furthermore, changing genders affects the stability of mating relationships: for each mating relationship $j$, there is an initial stability $b_j$ and an attenuation factor $d_j$. After all gender modifications are completed, if neither side’s gender changed, the stability is $s_j = b_j$; if both sides’ genders were flipped, then $s_j = \\lfloor b_j d_j \\rfloor$; in all other cases, $s_j = 0$.\n\nGiven each sheep’s gender, the gender change cost, all bloodline chains, and all mating relationships, Country Q asks you to design a gender modification plan to maximize the total profit. The profit is computed as follows:\n$$\nP = \\lfloor 10 \\ln(1 + A) \\rfloor \\times S - C.\n$$\nHere $A$ is the number of adjacent pairs within the bloodline chains that are of opposite gender after modification, $S$ is the sum of the stabilities of all mating relationships after modification, i.e., $S = \\sum\\limits_j s_j$, and $C$ is the total cost of gender changes, i.e., $C = \\sum\\limits_i c_i$.", "inputFormat": "- The first line contains four non-negative integers $N$, $K$, $M$, $P$, denoting the length of each bloodline chain, the number of bloodline chains, the total number of sheep in the sample, and the number of mating relationships, respectively.\n- The second line is a string of $M$ characters, each being `M` or `F`, describing the initial gender of the $M$ sheep. `M` stands for male, `F` stands for female.\n- The third line contains $M$ positive integers $c_i$, the cost to change the gender of each sheep.\n- The next $K$ lines each contain $N$ integers, giving the indices (from $1$ to $M$) of the sheep in each of the $K$ bloodline chains. It is guaranteed that each chain is single-gender and that the chains are disjoint.\n- The next $P$ lines each contain three integers $x$, $y$, $b$ and a real number $d$, indicating that sheep $x$ and sheep $y$ have a mating relationship with initial stability $b$ and attenuation factor $d$.\n\nIt is guaranteed that the initial genders of $x$ and $y$ are different, $x$ and $y$ are of the same generation, and each relationship appears at most once in the input.", "outputFormat": "Output a single integer on one line, the maximum achievable profit under the modification plan.", "hint": "Sample explanation:\nChange genders to `MMFFFM`. The profit is $\\lfloor 10 \\ln(1 + 2) \\rfloor \\times (20 + 18) - (10 + 10) = 360$. Here $A = 2$ because in bloodline chain $1 - 2 - 3$, sheep $2$ and $3$ are of different genders, and in bloodline chain $4 - 5 - 6$, sheep $5$ and $6$ are of different genders.\n\nConstraints:\n- For $10\\%$ of the testdata, $M \\leq 20$.\n- For $10\\%$ of the testdata, $d_j = 0$.\n- For $10\\%$ of the testdata, $d_j = 0.5$. These three categories are pairwise disjoint.\n- For $100\\%$ of the testdata, $1 \\leq N \\leq 50$, $1 \\leq K \\leq 4$, $1 \\leq M \\leq 10^3$, $1 \\leq P \\leq 10^4$, $0 \\leq d_j \\leq 1$, $0 \\leq b_j, c_i \\leq 10^4$, and the number of decimal places of $d_j$ does not exceed $6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2015] 性别改造计划", "background": "", "description": "21 世纪是生命科学的世纪。人类投入了大量人力物力研究生命科学，旨在对各类生物的生存机理产生更加深入的理解，以更好地了解人类自身，提高生活质量。Q 国政府首先在绵羊中开展了性别改造研究，希望通过基因重组改变性别的方式增强整个绵羊种群的生存能力。若此计划能够顺利研究成功，人类将掌握随意改变动物性别的黑科技，这将是生命科学研究史上一个重要的里程碑。\n\nQ 国政府从绵羊群中挑出 $M$ 只绵羊作为实验样本，这 $M$ 只绵羊中存在 $K$ 条长度为 $N$ 的单一性别的血缘链。所谓 “血缘链” 是指的一条由父（母）子（女）关系组成的链，比如 “爷爷 - 爸爸 - 儿子” 就是一条血缘链。“单一性别” 的意思是每条血缘链中所有个体的性别均一致，同为雄性或同为雌性。血缘链长度指的是一条血缘链中个体的数量，比如 “爷爷 - 爸爸 - 儿子” 是一条长度为 $3$ 的血缘链。这 $K$ 条血缘链并不相交。\n\n注意并不是每只绵羊都必须属于一条血缘链，有些绵羊可能不属于任何血缘链，因此 $N\\times K\\leq M$。除去血缘链外，同辈绵羊还会有 “繁衍关系” 的存在。两只异性绵羊如果曾经繁殖过后代，那么它们之间就会产生 “繁衍关系”。注意繁衍关系只会出现在同辈异性绵羊个体之间，这里 “同辈” 表示两只绵羊的辈份相同，即绵羊只会与它的兄弟姐妹辈产生 “繁衍关系”，而不会与父母或子女或其他更远的辈份之间产生 “繁衍关系”。\n\n对绵羊进行性别修改需要花费巨大的实验开销，修改绵羊 $i$ 的性别需要花费 $c_i$ 的修改代价。除此以外，修改绵羊性别还会对繁衍关系的稳定度产生影响：每对繁衍关系 $j$ 有初始稳定度 $b_j$ 和衰减系数 $d_j$，当所有的性别修改操作完成后，若双方性别均未改变，则此关系稳定度 $s_j = b_j$，若双方性别互换，则稳定度 $s_j = \\lfloor b_jd_j\\rfloor$，其他情况下稳定度 $s_j = 0$。\n\n给定每只绵羊的性别，性别修改代价，所有血缘链关系很繁衍关系，Q 国政府希望你来设计一套性别改造方案，使总收益最大。收益计算方式如下：\n\n$$\nP = \\lfloor 10 \\ln(1 + A) \\rfloor \\times S - C\n$$\n\n其中 $A$ 为改造后血缘链相邻两者为异性的情况数量，$S$ 为改造后繁衍关系稳定度之和，即 $S = \\sum\\limits_js_j$，$C$ 为修改绵羊性别带来的代价之和，即 $C = \\sum\\limits_ic_i$。", "inputFormat": "第一行包含四个非负整数 $N, K, M, P$，分别为血缘链的长度，血缘链的数量，实验样本中的总绵羊数和繁衍关系的数量。\n\n第二行为一个 $M$ 个字符的字符串，每个字符为 `M` 或 `F`，描述了这 $M$ 只绵羊的初始性别。`M` 表示雄性，`F` 表示雌性。\n\n第三行 $M$ 个正整数 $c_i$，表示修改每只绵羊性别的代价。\n\n下面 $K$ 行每行 $N$ 个整数，分别描述这 $K$ 个血缘链中绵羊编号（所有绵羊用 $1$ 到 $M$ 的整数编号），保证每条链中的绵羊均为同性，且链互不交叠。\n\n下面 $P$ 行每行三个整数 $x, y, b$ 和一个实数 $d$，表示绵羊 $x$ 与绵羊 $y$ 存在繁衍关系，且初始关系稳定度为 $b$，衰减系数为 $d$。\n\n保证 $x$ 与 $y$ 的初始性别不同，$x$ 和 $y$ 为同辈，同一条关系只会在数据中描述一次。", "outputFormat": "仅包含一行一个整数，表示改造计划的最大收益。", "hint": "**【样例解释】**\n\n改性别为 `MMFFFM`。收益为 $\\lfloor 10 \\ln(1 + 2) \\rfloor \\times(20 + 18) - (10 + 10) = 360$。$A = 2$ 是因为血缘链 $1 - 2 - 3$ 中 $2$ 与 $3$ 性别的不同，血缘链 $4 - 5 - 6$ 中 $5$ 与 $6$ 的性别不同。\n\n**【数据范围】**\n\n对于 $10\\%$ 的数据，满足 $M\\leq 20$。\n\n对于 $10\\%$ 的数据，满足 $d_j = 0$。\n\n对于 $10\\%$ 的数据，满足 $d_j = 0.5$。\n\n上述三类数据两两没有交集。 \n\n对于 $100\\%$ 的数据，$1\\leq N\\leq 50$，$1\\leq K\\leq 4$，$1\\leq M\\leq 10 ^ 3$，$1\\leq P\\leq 10 ^ 4$，$0 \\leq d_j\\leq 1$，$0\\leq b_j, c_i \\le 10 ^ 4$，$d_j$ 的小数位数不超过 $6$。", "locale": "zh-CN"}}}
{"pid": "P4511", "type": "P", "difficulty": 6, "samples": [["5 10\nADD 1 5811\nADD 3 5032\nDEL 3 5032\nADD 3 5550\nADD 5 3486\nDEL 1 5811\nDEL 3 5550\nADD 4 5116\nADD 3 9563\nADD 5 94", "5811\n10843\n5811\n11361\n14847\n9036\n3486\n8602\n18165\n18259"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [233000, 233000, 233000, 233000, 233000, 233000, 233000, 233000, 233000, 233000, 233000, 233000, 233000, 233000, 233000, 233000, 233000, 233000, 233000, 233000]}, "tags": ["2015", "线段树", "线段树分治", "CTSC/CTS", "反悔贪心"], "title": "[CTSC2015] 日程管理", "background": "", "description": "幽香是幻想乡中一个非常有地位的人。她日理万机，事务繁多，反倒自己已经快管理不过来了。于是他决定开发一个日程管理软件来帮助自己管理任务。 \n\n对于每个任务 $i$ 有一个对应的截止日期 $t_i$ 以及收益 $p_i$，表示若幽香能在不晚于第 $t_i$ 天完成这个任务，便可以得到 $p_i$ 的收益。幽香办事的能力非常强，任何任务都可以用恰好一天的时间做完。但由于任务实在太多了，有时候并不能完成所有任务，于是幽香会想知道这个情况下，完成任务可以给她带来的最大的累积收益是多少。\n \n由于幻想乡的人们十分善变，任务总是不断发生着变化。幽香希望这个管理软件还能够支持插入一个任务，和删除一个任务的操作。 \n\n具体的说，幽香希望支持以下 $2$ 个操作： \n\n1. `ADD t p`：表示新添一个截止日期为 $t$，收益为 $p$ 的任务。 \n\n2. `DEL t p`：表示删除一个截止日期为 $t$，收益为 $p$ 的任务。如果有多个这样的任务，只删除一个。数据保证这样的任务一定存在。 \n\n在每次操作执行完毕后，你都需要输出能够完成的任务的最大收益和。 \n\n幽香一共有 $T$ 天需要安排，从第 $1$ 天到第 $T$ 天。你能帮助他写出这个高效率的软件吗？", "inputFormat": "第一行有两个整数 $T$ 和 $Q$，表示天数和操作的个数。 \n\n接下来 $Q$ 行，其中第 $i$ 行表示第 $i$ 个操作，形式为 `ADD t p` 或 `DEL t p`，其具体意义如题面所述。", "outputFormat": "对每一次操作，输出一个整数在执行完该操作后幽香能够获得的最大收益和。", "hint": "数据保证，$1\\le T,Q\\le 3\\times 10^5$。\n\n$\\text{Statement fixed by @Starrykiller.}$", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2015] Schedule Management", "background": "", "description": "Youxiang is a very influential person in Gensokyo. She handles a huge number of affairs every day, and it has become hard for her to manage them all. Therefore, she decides to develop a schedule management program to help manage her tasks.\n\nFor each task $i$, there is a deadline $t_i$ and a profit $p_i$. If Youxiang finishes this task no later than day $t_i$, she will obtain a profit of $p_i$. Youxiang is very capable and can finish any task in exactly one day. However, since there are so many tasks, she cannot always complete all of them. She wants to know, in such cases, what the maximum total profit she can obtain is.\n\nSince people in Gensokyo are fickle, tasks keep changing. Youxiang wants this management program to support inserting a task and deleting a task.\n\nSpecifically, the program should support the following 2 operations:\n\n1. `ADD t p`: Insert a new task with deadline $t$ and profit $p$.\n2. `DEL t p`: Delete one task with deadline $t$ and profit $p$. If multiple such tasks exist, delete exactly one. It is guaranteed that such a task exists.\n\nAfter each operation is executed, you need to output the maximum total profit achievable by completing tasks.\n\nYouxiang has $T$ days to schedule, from day $1$ to day $T$. Can you help her write this efficient program?", "inputFormat": "The first line contains two integers $T$ and $Q$, denoting the number of days and the number of operations.\n\nThe next $Q$ lines describe the operations. The $i$-th line is the $i$-th operation, in the form `ADD t p` or `DEL t p`, with meanings as described above.", "outputFormat": "For each operation, output one integer: the maximum total profit Youxiang can obtain after that operation is performed.", "hint": "It is guaranteed that $1 \\le T, Q \\le 3 \\times 10^5$.\n\n$\\text{Statement fixed by @Starrykiller.}$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2015] 日程管理", "background": "", "description": "幽香是幻想乡中一个非常有地位的人。她日理万机，事务繁多，反倒自己已经快管理不过来了。于是他决定开发一个日程管理软件来帮助自己管理任务。 \n\n对于每个任务 $i$ 有一个对应的截止日期 $t_i$ 以及收益 $p_i$，表示若幽香能在不晚于第 $t_i$ 天完成这个任务，便可以得到 $p_i$ 的收益。幽香办事的能力非常强，任何任务都可以用恰好一天的时间做完。但由于任务实在太多了，有时候并不能完成所有任务，于是幽香会想知道这个情况下，完成任务可以给她带来的最大的累积收益是多少。\n \n由于幻想乡的人们十分善变，任务总是不断发生着变化。幽香希望这个管理软件还能够支持插入一个任务，和删除一个任务的操作。 \n\n具体的说，幽香希望支持以下 $2$ 个操作： \n\n1. `ADD t p`：表示新添一个截止日期为 $t$，收益为 $p$ 的任务。 \n\n2. `DEL t p`：表示删除一个截止日期为 $t$，收益为 $p$ 的任务。如果有多个这样的任务，只删除一个。数据保证这样的任务一定存在。 \n\n在每次操作执行完毕后，你都需要输出能够完成的任务的最大收益和。 \n\n幽香一共有 $T$ 天需要安排，从第 $1$ 天到第 $T$ 天。你能帮助他写出这个高效率的软件吗？", "inputFormat": "第一行有两个整数 $T$ 和 $Q$，表示天数和操作的个数。 \n\n接下来 $Q$ 行，其中第 $i$ 行表示第 $i$ 个操作，形式为 `ADD t p` 或 `DEL t p`，其具体意义如题面所述。", "outputFormat": "对每一次操作，输出一个整数在执行完该操作后幽香能够获得的最大收益和。", "hint": "数据保证，$1\\le T,Q\\le 3\\times 10^5$。\n\n$\\text{Statement fixed by @Starrykiller.}$", "locale": "zh-CN"}}}
{"pid": "P4512", "type": "P", "difficulty": 6, "samples": [["5 1\n1 9 2 6 0 8\n1 7", "237340659 335104102 649004347 448191342 855638018\n760903695"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["快速数论变换 NTT", "模板题"], "title": "【模板】多项式除法", "background": "", "description": "给定一个 $n$ 次多项式 $F(x)$ 和一个 $m$ 次多项式  $G(x)$ ，请求出多项式 $Q(x)$, $R(x)$，满足以下条件：\n\n - $Q(x)$ 次数为 $n-m$，$R(x)$ 次数小于 $m$\n - $F(x) = Q(x) * G(x) + R(x)$\n\n所有的运算在模 $998244353$ 意义下进行。", "inputFormat": "第一行两个整数 $n$，$m$，意义如上。  \n第二行 $n+1$ 个整数，从低到高表示 $F(x)$ 的各个系数。  \n第三行 $m+1$ 个整数，从低到高表示 $G(x)$ 的各个系数。", "outputFormat": "第一行 $n-m+1$ 个整数，从低到高表示 $Q(x)$ 的各个系数。    \n第二行 $m$ 个整数，从低到高表示 $R(x)$ 的各个系数。    \n如果 $R(x)$ 不足 $m-1$ 次，多余的项系数补 $0$。", "hint": "对于所有数据，$1 \\le m < n \\le 10^5$，给出的系数均属于 $[0, 998244353) \\cap \\mathbb{Z}$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Polynomial Division", "background": "", "description": "Given an $n$-degree polynomial $F(x)$ and an $m$-degree polynomial $G(x)$, find polynomials $Q(x)$ and $R(x)$ such that:\n- $\\deg Q(x) = n - m$, and $\\deg R(x) < m$.\n- $F(x) = Q(x) * G(x) + R(x)$.\n\nAll operations are performed modulo $998244353$.", "inputFormat": "The first line contains two integers $n$ and $m$, as described above.  \nThe second line contains $n+1$ integers, giving the coefficients of $F(x)$ from low to high degree.  \nThe third line contains $m+1$ integers, giving the coefficients of $G(x)$ from low to high degree.", "outputFormat": "The first line contains $n - m + 1$ integers, giving the coefficients of $Q(x)$ from low to high degree.  \nThe second line contains $m$ integers, giving the coefficients of $R(x)$ from low to high degree.  \nIf $\\deg R(x) < m - 1$, pad the remaining coefficients with $0$.", "hint": "For all testdata, $1 \\le m < n \\le 10^5$, and the given coefficients belong to $[0, 998244353) \\cap \\mathbb{Z}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】多项式除法", "background": "", "description": "给定一个 $n$ 次多项式 $F(x)$ 和一个 $m$ 次多项式  $G(x)$ ，请求出多项式 $Q(x)$, $R(x)$，满足以下条件：\n\n - $Q(x)$ 次数为 $n-m$，$R(x)$ 次数小于 $m$\n - $F(x) = Q(x) * G(x) + R(x)$\n\n所有的运算在模 $998244353$ 意义下进行。", "inputFormat": "第一行两个整数 $n$，$m$，意义如上。  \n第二行 $n+1$ 个整数，从低到高表示 $F(x)$ 的各个系数。  \n第三行 $m+1$ 个整数，从低到高表示 $G(x)$ 的各个系数。", "outputFormat": "第一行 $n-m+1$ 个整数，从低到高表示 $Q(x)$ 的各个系数。    \n第二行 $m$ 个整数，从低到高表示 $R(x)$ 的各个系数。    \n如果 $R(x)$ 不足 $m-1$ 次，多余的项系数补 $0$。", "hint": "对于所有数据，$1 \\le m < n \\le 10^5$，给出的系数均属于 $[0, 998244353) \\cap \\mathbb{Z}$。", "locale": "zh-CN"}}}
{"pid": "P4513", "type": "P", "difficulty": 5, "samples": [["5 3\n1\n2\n-3\n4\n5\n1 2 3\n2 2 -1\n1 2 3", "2\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["线段树", "递归"], "title": "小白逛公园", "background": "小新经常陪小白去公园玩，也就是所谓的遛狗啦…", "description": "在小新家附近有一条“公园路”，路的一边从南到北依次排着 $n$ 个公园，小白早就看花了眼，自己也不清楚该去哪些公园玩了。\n\n一开始，小白就根据公园的风景给每个公园打了分。小新为了省事，每次遛狗的时候都会事先规定一个范围，小白只可以选择第 $a$ 个和第 $b$ 个公园之间（包括 $a, b$ 两个公园）选择连续的一些公园玩。小白当然希望选出的公园的分数总和尽量高咯。同时，由于一些公园的景观会有所改变，所以，小白的打分也可能会有一些变化。\n\n那么，就请你来帮小白选择公园吧。", "inputFormat": "第一行，两个整数 $n$ 和 $m$，分别表示表示公园的数量和操作（遛狗或者改变打分）总数。\n\n接下来 $n$ 行，每行一个整数，依次给出小白开始时对公园的打分。\n\n接下来 $m$ 行，每行三个整数。其中第一个整数 $k$ 为 $1$ 或 $2$。\n\n- $k=1$ 表示，小新要带小白出去玩，接下来的两个整数 $a$ 和 $b$ 给出了选择公园的范围 $(1 \\le a,b \\le n)$。测试数据可能会出现 $a > b$ 的情况，需要进行交换；\n- $k=2$ 表示，小白改变了对某个公园的打分，接下来的两个整数 $p$ 和 $s$，表示小白对第 $p$ 个公园的打分变成了 $s(1\\le |s|\\le 1000)$。", "outputFormat": "小白每出去玩一次，都对应输出一行，只包含一个整数，表示小白可以选出的公园得分和的最大值。", "hint": "### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 5 \\times 10^5$，$1 \\le m \\le 10^5$，所有打分都是绝对值不超过 $1000$ 的整数。", "locale": "zh-CN", "translations": {"en": {"title": "Xiaobai Strolls in the Park", "background": "Xiaoxin often takes Xiaobai to the park to play, also known as walking the dog....", "description": "Near Xiaoxin’s home there is a “Park Road,” along one side of which $n$ parks are lined up from south to north. Xiaobai is dazzled and is not sure which parks to visit.\n\nAt the beginning, Xiaobai assigns a score to each park based on its scenery. For convenience, every time they go for a walk, Xiaoxin specifies a range, and Xiaobai may choose a contiguous sequence of parks between the $a$-th and $b$-th parks (inclusive). Of course, Xiaobai wants the sum of the selected parks’ scores to be as large as possible. Meanwhile, as some parks’ landscapes change, Xiaobai’s scores may also change.\n\nSo please help Xiaobai choose the parks.", "inputFormat": "- The first line contains two integers $n$ and $m$, representing the number of parks and the total number of operations (walks or score changes).\n- The next $n$ lines each contain one integer, giving the initial score that Xiaobai assigns to each park in order.\n- The next $m$ lines each contain three integers. The first integer $k$ is $1$ or $2$.\n  - If $k = 1$, Xiaoxin is taking Xiaobai out to play. The next two integers $a$ and $b$ give the selectable range of parks $(1 \\le a, b \\le n)$. The testdata may contain cases where $a > b$, in which case you should swap them.\n  - If $k = 2$, Xiaobai changes the score of a park. The next two integers $p$ and $s$ mean the score of the $p$-th park becomes $s$ $(1 \\le |s| \\le 1000)$.", "outputFormat": "For each walk, output one line containing a single integer: the maximum possible sum of scores of the parks Xiaobai can select.", "hint": "### Constraints\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 5 \\times 10^5$, $1 \\le m \\le 10^5$, and all scores are integers with absolute value at most $1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小白逛公园", "background": "小新经常陪小白去公园玩，也就是所谓的遛狗啦…", "description": "在小新家附近有一条“公园路”，路的一边从南到北依次排着 $n$ 个公园，小白早就看花了眼，自己也不清楚该去哪些公园玩了。\n\n一开始，小白就根据公园的风景给每个公园打了分。小新为了省事，每次遛狗的时候都会事先规定一个范围，小白只可以选择第 $a$ 个和第 $b$ 个公园之间（包括 $a, b$ 两个公园）选择连续的一些公园玩。小白当然希望选出的公园的分数总和尽量高咯。同时，由于一些公园的景观会有所改变，所以，小白的打分也可能会有一些变化。\n\n那么，就请你来帮小白选择公园吧。", "inputFormat": "第一行，两个整数 $n$ 和 $m$，分别表示表示公园的数量和操作（遛狗或者改变打分）总数。\n\n接下来 $n$ 行，每行一个整数，依次给出小白开始时对公园的打分。\n\n接下来 $m$ 行，每行三个整数。其中第一个整数 $k$ 为 $1$ 或 $2$。\n\n- $k=1$ 表示，小新要带小白出去玩，接下来的两个整数 $a$ 和 $b$ 给出了选择公园的范围 $(1 \\le a,b \\le n)$。测试数据可能会出现 $a > b$ 的情况，需要进行交换；\n- $k=2$ 表示，小白改变了对某个公园的打分，接下来的两个整数 $p$ 和 $s$，表示小白对第 $p$ 个公园的打分变成了 $s(1\\le |s|\\le 1000)$。", "outputFormat": "小白每出去玩一次，都对应输出一行，只包含一个整数，表示小白可以选出的公园得分和的最大值。", "hint": "### 数据规模与约定\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 5 \\times 10^5$，$1 \\le m \\le 10^5$，所有打分都是绝对值不超过 $1000$ 的整数。", "locale": "zh-CN"}}}
{"pid": "P4514", "type": "P", "difficulty": 5, "samples": [["X 4 4\nL 1 1 3 3 2\nL 2 2 4 4 1\nk 2 2 3 3", "12"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["树状数组", "前缀和", "差分"], "title": "上帝造题的七分钟", "background": "裸体就意味着身体。", "description": "“第一分钟，X 说，要有矩阵，于是便有了一个里面写满了 $0$ 的 $n\\times m$ 矩阵。\n\n第二分钟，L 说，要能修改，于是便有了将左上角为 $(a,b)$，右下角为 $(c,d)$ 的一个矩形区域内的全部数字加上一个值的操作。\n\n第三分钟，k 说，要能查询，于是便有了求给定矩形区域内的全部数字和的操作。\n\n第四分钟，彩虹喵说，要基于二叉树的数据结构，于是便有了数据范围。\n\n第五分钟，和雪说，要有耐心，于是便有了时间限制。\n\n第六分钟，吃钢琴男说，要省点事，于是便有了保证运算过程中及最终结果均不超过 $32$ 位有符号整数类型的表示范围的限制。\n\n第七分钟，这道题终于造完了，然而，造题的神牛们再也不想写这道题的程序了。”。\n\n——《上帝造裸题的七分钟》。\n\n所以这个神圣的任务就交给你了。", "inputFormat": "输入数据的第一行为 `X n m`，代表矩阵大小为 $n\\times m$。  \n从输入数据的第二行开始到文件尾的每一行会出现以下两种操作：  \n-    `L a b c d delta` —— 代表将 $(a,b),(c,d)$ 为顶点的矩形区域内的所有数字加上 $delta$。  \n-    `k a b c d`     —— 代表求 $(a,b),(c,d)$ 为顶点的矩形区域内所有数字的和。  \n\n请注意，$k$ 为小写。  ", "outputFormat": "针对每个 $k$ 操作，在单独的一行输出答案。", "hint": "对于 $10\\%$ 的数据，$1 \\le n \\le 16$，$1 \\le m \\le 16$， 操作不超过 $200$ 个。\n\n对于 $60\\%$ 的数据，$1 \\le n \\le 512$，$1 \\le m \\le 512$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 2048$，$1 \\le m \\le 2048$，$-500 \\le delta \\le 500$，操作不超过 $2\\times 10^5$ 个，保证最终结果均不超过 $32$ 位带符号整数类型的表示范围，但不保证运算过程不超过该范围。", "locale": "zh-CN", "translations": {"en": {"title": "Seven Minutes of God Making a Problem", "background": "Being naked means having a body.", "description": "“Minute 1: X said, let there be a matrix, and so there was an $n\\times m$ matrix filled with $0$.\n\nMinute 2: L said, let it support modifications, and so there was an operation that adds a value to all numbers in a rectangular region whose top-left corner is $(a,b)$ and bottom-right corner is $(c,d)$.\n\nMinute 3: k said, let it support queries, and so there was an operation that computes the sum of all numbers in a given rectangular region.\n\nMinute 4: Rainbow Meow said, it should be based on a data structure related to binary trees, and so there were the Constraints.\n\nMinute 5: Hexue said, be patient, and so there was a time limit.\n\nMinute 6: The piano-eating guy said, save some trouble, and so there was a restriction that during the operations and in the final result, everything will not exceed the range of a 32-bit signed integer type.\n\nMinute 7: This problem was finally completed. However, the godlike problem setters no longer wanted to write the program for it.”.\n\n— “Seven Minutes of God Making a Naked Problem”.\n\nSo this sacred task is handed over to you.", "inputFormat": "The first line of the input is `X n m`, indicating that the matrix size is $n\\times m$.  \nFrom the second line to the end of the file, each line contains one of the following two operations:  \n- `L a b c d delta` — add $delta$ to all numbers in the rectangular region with vertices $(a,b)$ and $(c,d)$.  \n- `k a b c d` — compute the sum of all numbers in the rectangular region with vertices $(a,b)$ and $(c,d)$.  \n\nNote that $k$ is lowercase.", "outputFormat": "For each `k` operation, output the answer on a separate line.", "hint": "For $10\\%$ of the testdata, $1 \\le n \\le 16$, $1 \\le m \\le 16$, and there are no more than $200$ operations.\n\nFor $60\\%$ of the testdata, $1 \\le n \\le 512$, $1 \\le m \\le 512$.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 2048$, $1 \\le m \\le 2048$, $-500 \\le delta \\le 500$, and there are no more than $2\\times 10^5$ operations. It is guaranteed that the final results do not exceed the range of a 32-bit signed integer type, but it is not guaranteed that intermediate computations stay within this range.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "上帝造题的七分钟", "background": "裸体就意味着身体。", "description": "“第一分钟，X 说，要有矩阵，于是便有了一个里面写满了 $0$ 的 $n\\times m$ 矩阵。\n\n第二分钟，L 说，要能修改，于是便有了将左上角为 $(a,b)$，右下角为 $(c,d)$ 的一个矩形区域内的全部数字加上一个值的操作。\n\n第三分钟，k 说，要能查询，于是便有了求给定矩形区域内的全部数字和的操作。\n\n第四分钟，彩虹喵说，要基于二叉树的数据结构，于是便有了数据范围。\n\n第五分钟，和雪说，要有耐心，于是便有了时间限制。\n\n第六分钟，吃钢琴男说，要省点事，于是便有了保证运算过程中及最终结果均不超过 $32$ 位有符号整数类型的表示范围的限制。\n\n第七分钟，这道题终于造完了，然而，造题的神牛们再也不想写这道题的程序了。”。\n\n——《上帝造裸题的七分钟》。\n\n所以这个神圣的任务就交给你了。", "inputFormat": "输入数据的第一行为 `X n m`，代表矩阵大小为 $n\\times m$。  \n从输入数据的第二行开始到文件尾的每一行会出现以下两种操作：  \n-    `L a b c d delta` —— 代表将 $(a,b),(c,d)$ 为顶点的矩形区域内的所有数字加上 $delta$。  \n-    `k a b c d`     —— 代表求 $(a,b),(c,d)$ 为顶点的矩形区域内所有数字的和。  \n\n请注意，$k$ 为小写。  ", "outputFormat": "针对每个 $k$ 操作，在单独的一行输出答案。", "hint": "对于 $10\\%$ 的数据，$1 \\le n \\le 16$，$1 \\le m \\le 16$， 操作不超过 $200$ 个。\n\n对于 $60\\%$ 的数据，$1 \\le n \\le 512$，$1 \\le m \\le 512$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 2048$，$1 \\le m \\le 2048$，$-500 \\le delta \\le 500$，操作不超过 $2\\times 10^5$ 个，保证最终结果均不超过 $32$ 位带符号整数类型的表示范围，但不保证运算过程不超过该范围。", "locale": "zh-CN"}}}
{"pid": "P4515", "type": "P", "difficulty": 6, "samples": [["3\n1 1 2\n7 1 6\n5 3 4", "24.0"], ["5\n5 5 99\n5 5 99\n5 5 99\n5 5 99\n5 5 99", "4900.5"], ["4\n5 5 99\n5 5 99\n5 5 99\n5 5 99", "0.0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["计算几何", "2009", "容斥原理", "COCI（克罗地亚）"], "title": "[COCI 2009/2010 #6] XOR", "background": null, "description": "坐标系下有若干个等腰直角三角形，且每个等腰直角三角形的直角顶点都在左下方，两腰与坐标轴平行。被奇数个三角形覆盖的面积部分为灰色，被偶数个三角形覆盖的面积部分为白色，如下图所示。\n\n![](https://cdn.luogu.com.cn/upload/pic/18669.png)\n\n已知 $N$ 个等腰直角三角形的顶点坐标及腰长，求灰色部分面积。", "inputFormat": "输入第一行包含一个整数 $N$，表示等腰直角三角形数量。\n\n接下来 $N$ 行，每行三个整数 $X, Y, R$，分别表示等腰直角三角形的顶点坐标 $(X, Y)$ 与腰长 $R$。", "outputFormat": "输出包含一个实数，表示灰色部分面积。保留 $1$ 位小数。", "hint": "对于所有数据，$1 \\leq N \\leq 10$，$1 \\leq X, Y, R \\leq 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "[COCI 2009/2010 #6] XOR", "background": null, "description": "Mirko and Slavko have built their own LED display. The display is initially\nwhite. During each of the $N$ parts of the testing phase, Mirko attached three\nelectrodes to the display in such way that they formed a right isosceles\ntriangle. He noticed that, after attaching the electrodes, all pixels in the\nenclosing triangle are inverted (white pixels become black, and black pixels\nbecome white).\n\n![](https://cdn.luogu.com.cn/upload/pic/18669.png)\n\nWatching Mirko play with the electrodes, Slavko observed interesting shapes\nemerging on the screen. Mathematically inclined as he is, first thing that\ncrossed his mind was how to calculate total area covered by black pixels. Help\nhim by writing a program to do just that!", "inputFormat": "First line of input contains an integer $N~(1 \\leq N \\leq 10)$, number of triangles\nformed by Mirko's fiddling with electrodes. Each of the following $N$ lines\ncontains three integers $X, Y$ and $R~(1 \\leq X, Y, R \\leq 10^6)$, describing a triangle. $(X, Y)$ are the coordinates of the lower left corner of the triangle, while $R$ represents the length of the two sides of the triangle.", "outputFormat": "The first and only line of output should contain the area covered by black pixels, rounded to one decimal place.", "hint": "For all data, $1 \\leq N \\leq 10$, $1 \\leq X, Y, R \\leq 10^6$.", "locale": "en"}, "zh-CN": {"title": "[COCI 2009/2010 #6] XOR", "background": null, "description": "坐标系下有若干个等腰直角三角形，且每个等腰直角三角形的直角顶点都在左下方，两腰与坐标轴平行。被奇数个三角形覆盖的面积部分为灰色，被偶数个三角形覆盖的面积部分为白色，如下图所示。\n\n![](https://cdn.luogu.com.cn/upload/pic/18669.png)\n\n已知 $N$ 个等腰直角三角形的顶点坐标及腰长，求灰色部分面积。", "inputFormat": "输入第一行包含一个整数 $N$，表示等腰直角三角形数量。\n\n接下来 $N$ 行，每行三个整数 $X, Y, R$，分别表示等腰直角三角形的顶点坐标 $(X, Y)$ 与腰长 $R$。", "outputFormat": "输出包含一个实数，表示灰色部分面积。保留 $1$ 位小数。", "hint": "对于所有数据，$1 \\leq N \\leq 10$，$1 \\leq X, Y, R \\leq 10^6$。", "locale": "zh-CN"}}}
{"pid": "P4516", "type": "P", "difficulty": 6, "samples": [["5 3\n1 2\n2 3\n3 4\n4 5", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2018", "各省省选", "江苏", "背包 DP", "树形 DP"], "title": "[JSOI2018] 潜入行动", "background": "", "description": "外星人又双叒叕要攻打地球了，外星母舰已经向地球航行！这一次，``JYY`` 已经联系好了黄金舰队，打算联合所有 ``JSOIer`` 抵御外星人的进攻。\n\n在黄金舰队就位之前，``JYY`` 打算事先了解外星人的进攻计划。现在，携带了监听设备的特工已经秘密潜入了外星人的母舰，准备对外星人的通信实施监听。\n\n外星人的母舰可以看成是一棵 $n$ 个节点、 $n-1$ 条边的**无向树**，树上的节点用 $1,2,\\cdots,n$ 编号。``JYY`` 的特工已经装备了隐形模块，可以在外星人母舰中不受限制地活动，可以神不知鬼不觉地在节点上安装监听设备。\n\n如果在节点 $u$ 上安装监听设备，则 ``JYY`` 能够监听与 $u$ **直接相邻**所有的节点的通信。换言之，如果在节点 $u$ 安装监听设备，则对于树中每一条边 $(u,v)$ ，节点 $v$ 都会被监听。特别注意**放置在节点 $u$ 的监听设备并不监听 $u$ 本身的通信**，这是 ``JYY`` 特别为了防止外星人察觉部署的战术。\n\n``JYY`` 的特工一共携带了 $k$ 个监听设备，现在 ``JYY`` 想知道，有多少种不同的放置监听设备的方法，能够使得母舰上**所有节点**的通信都被监听？为了避免浪费，**每个节点至多只能安装一个监听设备，且监听设备必须被用完**。\n", "inputFormat": "输入第一行包含两个整数 $n,k$ ，表示母舰节点的数量 $n$ 和监听设备的数量 $k$ 。\n接下来 $n-1$ 行，每行两个整数 $u,v$ $(1\\le u,v\\le n)$，表示树中的一条边。", "outputFormat": "输出一行，表示满足条件的方案数。因为答案可能很大，你只需要输出答案 $\\text{mod 1,000,000,007}$ 的余数即可。", "hint": "**样例 1 解释**\n\n样例数据是一条链 $1-2-3-4-5$ 。首先，节点 $2$ 和 $4$ 必须放置监听设备，否则 $1,5$ 将无法被监听（放置的监听设备无法监听它所在的节点）。剩下一个设备必须放置在 $3$ 号节点以同时监听 $2,4$ 。因此在 $2,3,4$ 节点放置监听设备是唯一合法的方案。\n\n**数据范围**\n\n存在 $10\\%$ 的数据，$1 \\le n \\le 20$ ；\n\n存在另外 $10\\%$ 的数据，$1 \\le n \\le 100$ ；\n\n存在另外 $10\\%$ 的数据，$1 \\le k \\le 10$ ；\n\n存在另外 $10\\%$ 的数据，输入的树保证是一条链；\n\n对于所有数据，$1\\le n\\le 10^5$​ ，$1\\le k\\le \\min\\{n,100\\}$ 。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2018] Infiltration Operation", "background": "", "description": "The aliens are attacking Earth yet again, and the alien mothership is already en route to Earth. This time, `JYY` has contacted the Golden Fleet and plans to unite all `JSOIer` to resist the alien invasion.\n\nBefore the Golden Fleet takes position, `JYY` intends to first learn the aliens' plan. Now, an agent carrying listening devices has secretly infiltrated the alien mothership to eavesdrop on their communications.\n\nThe alien mothership can be regarded as an **undirected tree** with $n$ nodes and $n-1$ edges. The nodes on the tree are numbered $1,2,\\cdots,n$. The agent employed by `JYY` is equipped with a stealth module, allowing free movement within the mothership and the ability to install listening devices on nodes without being detected.\n\nIf a listening device is installed at node $u$, then `JYY` can monitor the communications of all nodes **directly adjacent** to $u$. In other words, if a device is placed at node $u$, then for every edge $(u,v)$ in the tree, node $v$ will be monitored. Note in particular that a device placed at node $u$ does not monitor the communications of $u$ itself; this is a tactic designed by `JYY` to avoid detection by the aliens.\n\nThe agent carries exactly $k$ listening devices. `JYY` wants to know how many different ways there are to place the devices so that the communications of **all nodes** on the mothership are monitored. To avoid waste, at most one device may be installed on each node, and all devices must be used.", "inputFormat": "The first line of input contains two integers $n,k$, representing the number of nodes $n$ of the mothership and the number of listening devices $k$.\nThe next $n-1$ lines each contain two integers $u,v$ $(1\\le u,v\\le n)$, representing an edge in the tree.", "outputFormat": "Output a single line containing the number of valid configurations. Since the answer may be large, you only need to output the remainder $\\text{mod 1,000,000,007}$.", "hint": "Explanation for Sample 1\n\nThe sample is a chain $1-2-3-4-5$. First, nodes $2$ and $4$ must have devices; otherwise $1$ and $5$ cannot be monitored (a device does not monitor the node it sits on). The remaining device must be placed on node $3$ to monitor both $2$ and $4$. Therefore, placing devices on nodes $2,3,4$ is the only valid configuration.\n\nConstraints\n\n- For $10\\%$ of the testdata, $1 \\le n \\le 20$.\n- For another $10\\%$ of the testdata, $1 \\le n \\le 100$.\n- For another $10\\%$ of the testdata, $1 \\le k \\le 10$.\n- For another $10\\%$ of the testdata, the input tree is a chain.\n- For all testdata, $1\\le n\\le 10^5$, $1\\le k\\le \\min\\{n,100\\}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2018] 潜入行动", "background": "", "description": "外星人又双叒叕要攻打地球了，外星母舰已经向地球航行！这一次，``JYY`` 已经联系好了黄金舰队，打算联合所有 ``JSOIer`` 抵御外星人的进攻。\n\n在黄金舰队就位之前，``JYY`` 打算事先了解外星人的进攻计划。现在，携带了监听设备的特工已经秘密潜入了外星人的母舰，准备对外星人的通信实施监听。\n\n外星人的母舰可以看成是一棵 $n$ 个节点、 $n-1$ 条边的**无向树**，树上的节点用 $1,2,\\cdots,n$ 编号。``JYY`` 的特工已经装备了隐形模块，可以在外星人母舰中不受限制地活动，可以神不知鬼不觉地在节点上安装监听设备。\n\n如果在节点 $u$ 上安装监听设备，则 ``JYY`` 能够监听与 $u$ **直接相邻**所有的节点的通信。换言之，如果在节点 $u$ 安装监听设备，则对于树中每一条边 $(u,v)$ ，节点 $v$ 都会被监听。特别注意**放置在节点 $u$ 的监听设备并不监听 $u$ 本身的通信**，这是 ``JYY`` 特别为了防止外星人察觉部署的战术。\n\n``JYY`` 的特工一共携带了 $k$ 个监听设备，现在 ``JYY`` 想知道，有多少种不同的放置监听设备的方法，能够使得母舰上**所有节点**的通信都被监听？为了避免浪费，**每个节点至多只能安装一个监听设备，且监听设备必须被用完**。\n", "inputFormat": "输入第一行包含两个整数 $n,k$ ，表示母舰节点的数量 $n$ 和监听设备的数量 $k$ 。\n接下来 $n-1$ 行，每行两个整数 $u,v$ $(1\\le u,v\\le n)$，表示树中的一条边。", "outputFormat": "输出一行，表示满足条件的方案数。因为答案可能很大，你只需要输出答案 $\\text{mod 1,000,000,007}$ 的余数即可。", "hint": "**样例 1 解释**\n\n样例数据是一条链 $1-2-3-4-5$ 。首先，节点 $2$ 和 $4$ 必须放置监听设备，否则 $1,5$ 将无法被监听（放置的监听设备无法监听它所在的节点）。剩下一个设备必须放置在 $3$ 号节点以同时监听 $2,4$ 。因此在 $2,3,4$ 节点放置监听设备是唯一合法的方案。\n\n**数据范围**\n\n存在 $10\\%$ 的数据，$1 \\le n \\le 20$ ；\n\n存在另外 $10\\%$ 的数据，$1 \\le n \\le 100$ ；\n\n存在另外 $10\\%$ 的数据，$1 \\le k \\le 10$ ；\n\n存在另外 $10\\%$ 的数据，输入的树保证是一条链；\n\n对于所有数据，$1\\le n\\le 10^5$​ ，$1\\le k\\le \\min\\{n,100\\}$ 。", "locale": "zh-CN"}}}
{"pid": "P4517", "type": "P", "difficulty": 6, "samples": [["3 2\n1 2\n2 3", "750000006"], ["6 6\n1 2\n2 3\n3 1\n1 4\n2 5\n3 6", "468750006"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2018", "各省省选", "江苏", "枚举", "前缀和", "概率论"], "title": "[JSOI2018] 防御网络", "background": "", "description": "虽然成功得到了外星人的进攻计划，但 ``JYY`` 意外地发现,外星母舰对地球的攻击竟然是随机的！必须尽快在地球上部署防御网络,抵御外星人母舰的攻击。\n地球上的防御网络由节点和节点之间的能量连接组成,防御网络可以看成是一个 $n$ 个点、 $m$ 条边的简单无向图 $G(V,E)$ ,每个防御节点对应 $V$ 中的一个节点、每个能量连接对应 $E$ 中的一条边。此外,在防御网络修建时考虑到能量传输效率，防御网络 $G$ 中**每个节点至多只包含在一个简单环中**。\n\n外星母舰的攻击是随机的，每次攻击开始后， ``JYY`` 都会本次攻击的情况选择一些防御节点 $S\\subseteq V$ ，并且用能量连接将这些防御节点连通，从而启动一个防御子网络。换言之， ``JYY`` 会选择 $G$ 中边集的一个子集 $H(S)\\subseteq E$ ,它满足:\n\n1.    (防御子网络**连通**) 如果我们建立新图 $G'(V,H(S))$ ，即用 $H(S)$ 中的边连接 $G$ 中的节点，则对于任意选择的防御节点 $x,y\\in S$ ，它们在 $G'$​​ 中都连通。\n\n2.    (防御子网络**最小**) 在满足条件 1 (防御子网络连通)的前提，选取的边数最小，即 $\\vert H(S)\\vert$ 最小。\n\n$H(S)$ 是点集 $S$ 在图 $G$ 生成的斯坦纳树 (Steiner Tree) ，而 $\\vert H(S)\\vert$ 则是启动防御子网络的最小代价。考虑到外星母舰随机攻击的方式， ``JYY`` 希望你计算启动防御子网络代价的**期望**:\n\n$$\\frac{1}{2^{\\vert V\\vert}}\\sum_{S\\subseteq V}\\vert H(S)\\vert$$", "inputFormat": "输入第一行两个整数 $n,m$ ，分别表示图中的节点数和边数。\n\n接下来 $m$ 行,每行两个整数 $u,v(1\\le u,v\\le n)$ ，表示图中的一条边。输入保证没有自环和重边，并且满足每个节点至多包含在一个简单环中。", "outputFormat": "输出一行，表示启动防御子网络的期望。\n\n假设期望写成最简分式 $P/Q$ 的形式, 则输出 $P⋅Q^{-1} \\text{mod 1,000,000,007}$ 的余数,其中 $Q^{-1}$​​ 为唯一的满足 $Q⋅Q^{-1} ≡ \\text{1 (mod 1,000,000,007)}$ 的整数。", "hint": "**样例解释**\n\n样例输入 1 是一条链，包含以下情况:\n\n1.    $\\{\\}, \\{1\\}, \\{2\\}, \\{3\\},\\vert H(S)\\vert = 0$ ;\n2.    $\\{1, 2\\}, \\{2, 3\\}, \\vert H(S)\\vert = 1$ ;\n3.    $\\{1, 3\\}, \\{1, 2, 3\\}, \\vert H(S)\\vert = 2$ 。\n\n因此 $P/Q=3/4$ ， $P\\cdot Q^{-1} = 750,000,006$ 。\n\n样例输入 2 中 $\\sum_{S\\subseteq V}\\vert H(S)\\vert = 174$ ，因此 $P/Q=87/32$ ， $P⋅Q^{-1}=468,750,006 \\text{ mod 1,000,000,007}$ 。\n\n**数据范围**\n\n对于 $20\\%$ 的数据,有 $1\\le n\\le 8$ 。\n\n对于 $40\\%$ 的数据,有 $1\\le n\\le 20$ 。\n\n对于 $100\\%$ 的数据,有 $1\\le n\\le 200$ 。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2018] Defense Network", "background": "", "description": "Although the attack plan of the aliens has been obtained, ``JYY`` unexpectedly finds that the alien mothership attacks Earth randomly. A defense network must be deployed on Earth as soon as possible to resist the mothership’s attack.\n\nThe defense network on Earth consists of nodes and energy links between nodes. The defense network can be regarded as a simple undirected graph $G(V, E)$ with $n$ vertices and $m$ edges. Each defense node corresponds to a vertex in $V$, and each energy link corresponds to an edge in $E$. In addition, considering energy transmission efficiency when building the defense network, in $G$ each vertex belongs to at most one simple cycle.\n\nSince the mothership’s attack is random, at the beginning of each attack, ``JYY`` will choose some defense nodes $S \\subseteq V$ according to the current attack and use energy links to connect these defense nodes to activate a defense subnetwork. In other words, ``JYY`` will choose a subset of edges $H(S) \\subseteq E$ in $G$, which satisfies:\n\n1. (Defense subnetwork connected) If we build a new graph $G'(V, H(S))$, i.e., connect the vertices in $G$ with the edges in $H(S)$, then for any selected defense vertices $x, y \\in S$, they are connected in $G'$.\n2. (Defense subnetwork minimal) Subject to condition 1 (defense subnetwork connected), the number of selected edges is minimal, i.e., $\\vert H(S)\\vert$ is minimal.\n\n$H(S)$ is the Steiner tree generated by the set $S$ in graph $G$, and $\\vert H(S)\\vert$ is the minimal cost to activate the defense subnetwork. Considering the randomness of the mothership’s attack, ``JYY`` wants you to compute the expectation of the activation cost:\n\n$$\\frac{1}{2^{\\vert V\\vert}}\\sum_{S\\subseteq V}\\vert H(S)\\vert.$$", "inputFormat": "The first line contains two integers $n, m$, denoting the number of vertices and edges in the graph.\n\nThe next $m$ lines each contain two integers $u, v$ $(1 \\le u, v \\le n)$, representing an edge. The input guarantees no self-loops or multiple edges, and that each vertex belongs to at most one simple cycle.", "outputFormat": "Output one line: the expected cost to activate the defense subnetwork.\n\nSuppose the expectation is written in irreducible fraction form $P/Q$. Output the remainder of $P \\cdot Q^{-1} \\text{ mod 1,000,000,007}$, where $Q^{-1}$ is the unique integer satisfying $Q \\cdot Q^{-1} \\equiv \\text{1 (mod 1,000,000,007)}$.", "hint": "Sample explanation.\n\nSample 1 is a path and includes the following cases:\n1. $\\{\\}, \\{1\\}, \\{2\\}, \\{3\\}, \\vert H(S)\\vert = 0$.\n2. $\\{1, 2\\}, \\{2, 3\\}, \\vert H(S)\\vert = 1$.\n3. $\\{1, 3\\}, \\{1, 2, 3\\}, \\vert H(S)\\vert = 2$.\n\nTherefore $P/Q = 3/4$, $P \\cdot Q^{-1} = 750,000,006$.\n\nIn sample input 2, $\\sum_{S\\subseteq V}\\vert H(S)\\vert = 174$, thus $P/Q = 87/32$, $P \\cdot Q^{-1} = 468,750,006 \\text{ mod 1,000,000,007}$.\n\nConstraints\n\n- For 20% of the testdata, $1 \\le n \\le 8$.\n- For 40% of the testdata, $1 \\le n \\le 20$.\n- For 100% of the testdata, $1 \\le n \\le 200$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2018] 防御网络", "background": "", "description": "虽然成功得到了外星人的进攻计划，但 ``JYY`` 意外地发现,外星母舰对地球的攻击竟然是随机的！必须尽快在地球上部署防御网络,抵御外星人母舰的攻击。\n地球上的防御网络由节点和节点之间的能量连接组成,防御网络可以看成是一个 $n$ 个点、 $m$ 条边的简单无向图 $G(V,E)$ ,每个防御节点对应 $V$ 中的一个节点、每个能量连接对应 $E$ 中的一条边。此外,在防御网络修建时考虑到能量传输效率，防御网络 $G$ 中**每个节点至多只包含在一个简单环中**。\n\n外星母舰的攻击是随机的，每次攻击开始后， ``JYY`` 都会本次攻击的情况选择一些防御节点 $S\\subseteq V$ ，并且用能量连接将这些防御节点连通，从而启动一个防御子网络。换言之， ``JYY`` 会选择 $G$ 中边集的一个子集 $H(S)\\subseteq E$ ,它满足:\n\n1.    (防御子网络**连通**) 如果我们建立新图 $G'(V,H(S))$ ，即用 $H(S)$ 中的边连接 $G$ 中的节点，则对于任意选择的防御节点 $x,y\\in S$ ，它们在 $G'$​​ 中都连通。\n\n2.    (防御子网络**最小**) 在满足条件 1 (防御子网络连通)的前提，选取的边数最小，即 $\\vert H(S)\\vert$ 最小。\n\n$H(S)$ 是点集 $S$ 在图 $G$ 生成的斯坦纳树 (Steiner Tree) ，而 $\\vert H(S)\\vert$ 则是启动防御子网络的最小代价。考虑到外星母舰随机攻击的方式， ``JYY`` 希望你计算启动防御子网络代价的**期望**:\n\n$$\\frac{1}{2^{\\vert V\\vert}}\\sum_{S\\subseteq V}\\vert H(S)\\vert$$", "inputFormat": "输入第一行两个整数 $n,m$ ，分别表示图中的节点数和边数。\n\n接下来 $m$ 行,每行两个整数 $u,v(1\\le u,v\\le n)$ ，表示图中的一条边。输入保证没有自环和重边，并且满足每个节点至多包含在一个简单环中。", "outputFormat": "输出一行，表示启动防御子网络的期望。\n\n假设期望写成最简分式 $P/Q$ 的形式, 则输出 $P⋅Q^{-1} \\text{mod 1,000,000,007}$ 的余数,其中 $Q^{-1}$​​ 为唯一的满足 $Q⋅Q^{-1} ≡ \\text{1 (mod 1,000,000,007)}$ 的整数。", "hint": "**样例解释**\n\n样例输入 1 是一条链，包含以下情况:\n\n1.    $\\{\\}, \\{1\\}, \\{2\\}, \\{3\\},\\vert H(S)\\vert = 0$ ;\n2.    $\\{1, 2\\}, \\{2, 3\\}, \\vert H(S)\\vert = 1$ ;\n3.    $\\{1, 3\\}, \\{1, 2, 3\\}, \\vert H(S)\\vert = 2$ 。\n\n因此 $P/Q=3/4$ ， $P\\cdot Q^{-1} = 750,000,006$ 。\n\n样例输入 2 中 $\\sum_{S\\subseteq V}\\vert H(S)\\vert = 174$ ，因此 $P/Q=87/32$ ， $P⋅Q^{-1}=468,750,006 \\text{ mod 1,000,000,007}$ 。\n\n**数据范围**\n\n对于 $20\\%$ 的数据,有 $1\\le n\\le 8$ 。\n\n对于 $40\\%$ 的数据,有 $1\\le n\\le 20$ 。\n\n对于 $100\\%$ 的数据,有 $1\\le n\\le 200$ 。", "locale": "zh-CN"}}}
{"pid": "P4518", "type": "P", "difficulty": 7, "samples": [["3 1\n0 0\n0 0\n0 0", "1.00000000"], ["3 10\n10 0\n0 10\n10 10", "12.17522858"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2018", "各省省选", "江苏", "Special Judge", "O2优化"], "title": "[JSOI2018] 绝地反击", "background": "", "description": "由于你的出色表现，外星人的进攻已经被成功化解了。现在， ``JYY`` 召集了强大的黄金舰队,准备一击摧毁外星人的母舰。\n\n黄金舰队共有 $n(n\\ge 3)$ 艘飞船,这些飞船能将能量汇聚到同一点（外星人母舰所在位置），从而对外星母舰进行毁灭性的打击。 ``JYY`` 计划将所有飞船同时折跃到母舰附近，瞬间发动攻击结束战斗。\n\n在黄金舰队折跃抵达后，由于各种不稳定因素，舰队中的各艘飞船并未进入最佳攻击位置，因此需要迅速对它们进行调整。现在，所有飞船已经同时完成了折跃，每个飞船都可以看做是平面上的一个点，第 $i(1\\le i\\le n)$ 艘飞船的坐标为 $(x_i,y_i)$ 。外星母舰位于坐标原点 $(0,0)$ 。\n\n为了实现最高效的打击，所有飞船都必须移动到攻击轨道上。攻击轨道是圆心在原点 $(0,0)$ 、半径为 $R$ 的圆。因为发射产生的能量实在太大， ``JYY`` 希望发射时飞船相互之间的距离尽可能大。具体来说， ``JYY`` 希望黄金舰队所有 $n$ 艘飞船均匀地排列在攻击轨道上（所有飞船均为同一型号，因此按任意顺序排列均可），即相邻飞船在攻击轨道（圆弧）上的距离相等且恰好等于 $\\frac{2\\pi R}{n}$​​ 。换言之， ``JYY`` 希望调整所有飞船的位置，使得所有飞船都位于攻击轨道上，且它们恰好位于正 $n$ 边形的 $n$个顶点。\n\n请你帮助 ``JYY`` 计算出打击开始的最短时间（即所有飞船移动到攻击轨道上并等距排列的最少时间）。飞船一单位时间可以在平面上移动一单位距离，且飞船的体积可以看成 $0$ 。因此在你设计的方案中，飞船在某个时刻 “相遇” 是允许的。此外，初始时飞船的坐标也允许重合。", "inputFormat": "输入第一行两个整数 $n,R$ ，表示飞船的数量和攻击轨道的半径。\n\n接下来 $n$ 行,每行两个整数 $(x_i,y_i)$ ，分别表示每一艘飞船的坐标。", "outputFormat": "输出一行，表示所有飞船就位的最短时间（请保留足够的小数位数）。如果你的输出和参考答案差距不超过 $10^{-6}$ 则认为正确。", "hint": "对于 $20\\%$ 的数据，有 $n=3$ 。\n\n对于 $50\\%$ 的数据，有 $n\\le 50$ 。\n\n对于 $100\\%$ 的数据，有 $3 \\le n\\le 200,0 \\le\\vert x_i\\vert,\\vert y_i\\vert,R\\le 100$ 。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2018] Counterattack", "background": "", "description": "Thanks to your excellent performance, the aliens’ attack has been successfully repelled. Now, ``JYY`` has assembled the powerful Golden Fleet, ready to destroy the alien mothership in a single strike.\n\nThe Golden Fleet has $n\\,(n\\ge 3)$ ships. These ships can focus their energy at a single point (the mothership’s location) to deliver a devastating blow. ``JYY`` plans to warp all ships near the mothership simultaneously and launch an attack instantly to end the battle.\n\nAfter the warp, due to various instabilities, the ships are not in optimal attack positions and must be adjusted quickly. Now all ships have completed the warp at the same time, and each ship can be viewed as a point on the plane. The $i$-th ($1\\le i\\le n$) ship is at coordinates $(x_i, y_i)$. The alien mothership is at the origin $(0, 0)$.\n\nTo achieve the most effective strike, all ships must move onto the attack orbit. The attack orbit is the circle centered at $(0, 0)$ with radius $R$. Because the energy released is extremely large, ``JYY`` wants the distances between ships at the moment of firing to be as large as possible. Specifically, ``JYY`` wants all $n$ ships of the Golden Fleet to be evenly arranged on the attack orbit (all ships are identical, so any order is acceptable), that is, the distances along the arc between adjacent ships on the attack orbit are equal and exactly $\\frac{2\\pi R}{n}$. In other words, ``JYY`` wants to adjust all ships so that they all lie on the attack orbit and are exactly at the $n$ vertices of a regular $n$-gon.\n\nPlease help ``JYY`` compute the minimum time to start the strike (i.e., the least time for all ships to move onto the attack orbit and be equally spaced). A ship can move one unit of distance per unit of time in the plane, and the volume of a ship can be considered $0$. Therefore, in your plan, it is allowed for ships to “meet” at some moment. Initially, ships’ coordinates are also allowed to coincide.", "inputFormat": "The first line contains two integers $n, R$, representing the number of ships and the radius of the attack orbit.\n\nThe next $n$ lines each contain two integers $(x_i, y_i)$, representing the coordinates of each ship.", "outputFormat": "Output one line: the minimum time for all ships to be in position (print with sufficient precision). Your answer is considered correct if the absolute error from the reference answer does not exceed $10^{-6}$.", "hint": "- For $20\\%$ of the testdata, $n = 3$.\n- For $50\\%$ of the testdata, $n \\le 50$.\n- For $100\\%$ of the testdata, $3 \\le n \\le 200$, $0 \\le \\lvert x_i \\rvert, \\lvert y_i \\rvert, R \\le 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2018] 绝地反击", "background": "", "description": "由于你的出色表现，外星人的进攻已经被成功化解了。现在， ``JYY`` 召集了强大的黄金舰队,准备一击摧毁外星人的母舰。\n\n黄金舰队共有 $n(n\\ge 3)$ 艘飞船,这些飞船能将能量汇聚到同一点（外星人母舰所在位置），从而对外星母舰进行毁灭性的打击。 ``JYY`` 计划将所有飞船同时折跃到母舰附近，瞬间发动攻击结束战斗。\n\n在黄金舰队折跃抵达后，由于各种不稳定因素，舰队中的各艘飞船并未进入最佳攻击位置，因此需要迅速对它们进行调整。现在，所有飞船已经同时完成了折跃，每个飞船都可以看做是平面上的一个点，第 $i(1\\le i\\le n)$ 艘飞船的坐标为 $(x_i,y_i)$ 。外星母舰位于坐标原点 $(0,0)$ 。\n\n为了实现最高效的打击，所有飞船都必须移动到攻击轨道上。攻击轨道是圆心在原点 $(0,0)$ 、半径为 $R$ 的圆。因为发射产生的能量实在太大， ``JYY`` 希望发射时飞船相互之间的距离尽可能大。具体来说， ``JYY`` 希望黄金舰队所有 $n$ 艘飞船均匀地排列在攻击轨道上（所有飞船均为同一型号，因此按任意顺序排列均可），即相邻飞船在攻击轨道（圆弧）上的距离相等且恰好等于 $\\frac{2\\pi R}{n}$​​ 。换言之， ``JYY`` 希望调整所有飞船的位置，使得所有飞船都位于攻击轨道上，且它们恰好位于正 $n$ 边形的 $n$个顶点。\n\n请你帮助 ``JYY`` 计算出打击开始的最短时间（即所有飞船移动到攻击轨道上并等距排列的最少时间）。飞船一单位时间可以在平面上移动一单位距离，且飞船的体积可以看成 $0$ 。因此在你设计的方案中，飞船在某个时刻 “相遇” 是允许的。此外，初始时飞船的坐标也允许重合。", "inputFormat": "输入第一行两个整数 $n,R$ ，表示飞船的数量和攻击轨道的半径。\n\n接下来 $n$ 行,每行两个整数 $(x_i,y_i)$ ，分别表示每一艘飞船的坐标。", "outputFormat": "输出一行，表示所有飞船就位的最短时间（请保留足够的小数位数）。如果你的输出和参考答案差距不超过 $10^{-6}$ 则认为正确。", "hint": "对于 $20\\%$ 的数据，有 $n=3$ 。\n\n对于 $50\\%$ 的数据，有 $n\\le 50$ 。\n\n对于 $100\\%$ 的数据，有 $3 \\le n\\le 200,0 \\le\\vert x_i\\vert,\\vert y_i\\vert,R\\le 100$ 。", "locale": "zh-CN"}}}
