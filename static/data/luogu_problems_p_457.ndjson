{"pid": "P10268", "type": "P", "difficulty": 6, "samples": [["4 4 4\n5 8 2 7 \n3 1\n1 4\n3 2\n1 4\n2 4\n1 2\n2 3\n3 3", "500000012\n833333349\n500000012\n666666674"], ["14 16 15\n1 2 7 3 2 4 6 2 5 7 2 4 3 3 \n5 12\n2 9\n2 10\n7 10\n6 12\n12 3\n11 1\n4 8\n1 13\n6 8\n6 10\n4 1\n1 10\n12 11\n3 5\n9 7\n14 14\n2 16\n5 6\n2 3\n5 10\n1 6\n5 16\n13 15\n1 2\n3 7\n3 4\n14 14\n3 7\n6 7\n11 14", "318681321\n263736277\n868131875\n725274731\n32967035\n384615390\n637362648\n780219786\n967032974\n406593411\n208791211\n318681321\n406593411\n945054952\n681318687"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["莫队", "并查集"], "title": "符卡对决", "background": "灵梦正在和魔理沙进行符卡对决。\n\n![Card](https://cdn.luogu.com.cn/upload/image_hosting/xu68nj8k.png)\n\n> 永夜の报い，Pixiv76062895，作者是 minusT，侵删。", "description": "灵梦一共有 $n$ 张符卡，每张卡都有一个能力值，对于第 $i$ 张卡，它的能力值为 $a_i$，现在她想从中选出两张符卡并使用它们，灵梦发现，如果她同时打出了两张符卡 $i, j$，这两张符卡造成的伤害将会是 $a_i\\times a_j$。\n\n这些符卡之间有能力的冲突，灵梦会告诉你这些符卡的兼容性，具体而言这些符卡之间有 $m$ 条关系，这些关系表明某两张符卡之间是兼容的，**注意**，如果符卡 $i, j$ 兼容且符卡 $j, k$ 兼容，那么符卡 $i, k$ 也是兼容的，如果打出的两张符卡之间不是兼容的，那么它们造成的伤害为 $0$。\n\n她很好奇符卡之间的兼容性会造成什么样的影响，所以她会询问你 $q$ 次，每次告诉你一对正整数 $l, r$，意味着只有编号在区间 $[l, r]$ 内的关系才会生效。\n\n灵梦不想把魔理沙虐得太惨，所以她会随机从所有符卡中选出两张**不同**的符卡来打出，她想知道每次询问造成的伤害的期望值对 $10^9 + 7$ 取模后是多少。", "inputFormat": "第一行三个整数 $n, m, q$ 分别表示符卡总数，符卡间的关系总数，灵梦的询问次数。\n\n接下来一行 $n$ 个正整数，第 $i$ 个表示 $a_i$。\n\n接下来 $m$ 行，每行两个正整数 $u_i, v_i$，表示第 $u_i$ 张符卡与第 $v_i$ 张符卡是兼容的。\n\n接下来 $q$ 行，每行两个正整数 $l_i, r_i$，表示灵梦询问的编号区间 $[l_i, r_i]$。", "outputFormat": "一共 $q$ 行，第 $i$ 行一个整数，表示第 $i$ 次询问中，随机选择两张**不同**的符卡，造成伤害的期望值对 $10^9 + 7$ 取模后的结果。", "hint": "#### 样例 1 解释\n\n对于第三组询问，只有 $(1, 4), (2, 3)$ 两对符卡之间是兼容的。\n\n如果选择的符卡是 $(1, 2)$，那么它们不兼容，伤害值为 $0$，这种情况的概率是 $\\dfrac16$。\n\n如果选择的符卡是 $(1, 3)$，那么它们不兼容，伤害值为 $0$，这种情况的概率是 $\\dfrac16$。\n\n如果选择的符卡是 $(1, 4)$，它们兼容，伤害值为 $a_1\\times a_4 = 35$，这种情况的概率是 $\\dfrac16$。\n\n如果选择的符卡是 $(2, 3)$，它们兼容，伤害值为 $a_2\\times a_3 = 16$，这种情况的概率是 $\\dfrac16$。\n\n如果选择的符卡是 $(2, 4)$，那么它们不兼容，伤害值为 $0$，这种情况的概率是 $\\dfrac16$。\n\n以此类推，最终的期望值是 $\\dfrac{17}{2}$，其在模 $10^9 + 7$ 意义下等于 $500000012$。\n\n#### 数据范围\n\n**本题采用捆绑测试。**\n\n对于所有数据，$1\\le n, q\\le 10^5, 1\\le m\\le 2n, 1\\le a_i\\le 10^9, 1\\le l_i\\le r_i\\le m, 1\\le u_i, v_i\\le n$。\n\n对于不同的子任务，我们如下约定：\n\n| 子任务编号 | $n$         | $q$         | 特殊性质 | 子任务分值 |\n| ---------- | ----------- | ----------- | -------- | ---------- |\n| $0$        | $\\le300$    | $\\le300$    | 无       | $5$        |\n| $1$        | $\\le 2000$  | $\\le 2000$  | A        | $10$       |\n| $2$        | $\\le 2000$  | $\\le 2000$  | B        | $5$       |\n| $3$        | $\\le 2000$  | $\\le 2000$  | 无       | $10$       |\n| $4$        | $\\le 30000$ | $\\le 30000$ | 无       | $10$       |\n| $5$        | $\\le 50000$ | $\\le 50000$ | A        | $10$       |\n| $6$        | $\\le 50000$ | $\\le 50000$ | B        | $10$       |\n| $7$        | $\\le 50000$ | $\\le 50000$ | 无       | $15$       |\n| $8$        | $\\le 10^5$  | $\\le 10^5$  | 无       | $25$       |\n\n- **特殊性质 A**：保证 $u_i = 1, v_i = i + 1, m = n - 1$。\n- **特殊性质 B**：保证 $l_i = 1$。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "符卡对决", "background": "灵梦正在和魔理沙进行符卡对决。\n\n![Card](https://cdn.luogu.com.cn/upload/image_hosting/xu68nj8k.png)\n\n> 永夜の报い，Pixiv76062895，作者是 minusT，侵删。", "description": "灵梦一共有 $n$ 张符卡，每张卡都有一个能力值，对于第 $i$ 张卡，它的能力值为 $a_i$，现在她想从中选出两张符卡并使用它们，灵梦发现，如果她同时打出了两张符卡 $i, j$，这两张符卡造成的伤害将会是 $a_i\\times a_j$。\n\n这些符卡之间有能力的冲突，灵梦会告诉你这些符卡的兼容性，具体而言这些符卡之间有 $m$ 条关系，这些关系表明某两张符卡之间是兼容的，**注意**，如果符卡 $i, j$ 兼容且符卡 $j, k$ 兼容，那么符卡 $i, k$ 也是兼容的，如果打出的两张符卡之间不是兼容的，那么它们造成的伤害为 $0$。\n\n她很好奇符卡之间的兼容性会造成什么样的影响，所以她会询问你 $q$ 次，每次告诉你一对正整数 $l, r$，意味着只有编号在区间 $[l, r]$ 内的关系才会生效。\n\n灵梦不想把魔理沙虐得太惨，所以她会随机从所有符卡中选出两张**不同**的符卡来打出，她想知道每次询问造成的伤害的期望值对 $10^9 + 7$ 取模后是多少。", "inputFormat": "第一行三个整数 $n, m, q$ 分别表示符卡总数，符卡间的关系总数，灵梦的询问次数。\n\n接下来一行 $n$ 个正整数，第 $i$ 个表示 $a_i$。\n\n接下来 $m$ 行，每行两个正整数 $u_i, v_i$，表示第 $u_i$ 张符卡与第 $v_i$ 张符卡是兼容的。\n\n接下来 $q$ 行，每行两个正整数 $l_i, r_i$，表示灵梦询问的编号区间 $[l_i, r_i]$。", "outputFormat": "一共 $q$ 行，第 $i$ 行一个整数，表示第 $i$ 次询问中，随机选择两张**不同**的符卡，造成伤害的期望值对 $10^9 + 7$ 取模后的结果。", "hint": "#### 样例 1 解释\n\n对于第三组询问，只有 $(1, 4), (2, 3)$ 两对符卡之间是兼容的。\n\n如果选择的符卡是 $(1, 2)$，那么它们不兼容，伤害值为 $0$，这种情况的概率是 $\\dfrac16$。\n\n如果选择的符卡是 $(1, 3)$，那么它们不兼容，伤害值为 $0$，这种情况的概率是 $\\dfrac16$。\n\n如果选择的符卡是 $(1, 4)$，它们兼容，伤害值为 $a_1\\times a_4 = 35$，这种情况的概率是 $\\dfrac16$。\n\n如果选择的符卡是 $(2, 3)$，它们兼容，伤害值为 $a_2\\times a_3 = 16$，这种情况的概率是 $\\dfrac16$。\n\n如果选择的符卡是 $(2, 4)$，那么它们不兼容，伤害值为 $0$，这种情况的概率是 $\\dfrac16$。\n\n以此类推，最终的期望值是 $\\dfrac{17}{2}$，其在模 $10^9 + 7$ 意义下等于 $500000012$。\n\n#### 数据范围\n\n**本题采用捆绑测试。**\n\n对于所有数据，$1\\le n, q\\le 10^5, 1\\le m\\le 2n, 1\\le a_i\\le 10^9, 1\\le l_i\\le r_i\\le m, 1\\le u_i, v_i\\le n$。\n\n对于不同的子任务，我们如下约定：\n\n| 子任务编号 | $n$         | $q$         | 特殊性质 | 子任务分值 |\n| ---------- | ----------- | ----------- | -------- | ---------- |\n| $0$        | $\\le300$    | $\\le300$    | 无       | $5$        |\n| $1$        | $\\le 2000$  | $\\le 2000$  | A        | $10$       |\n| $2$        | $\\le 2000$  | $\\le 2000$  | B        | $5$       |\n| $3$        | $\\le 2000$  | $\\le 2000$  | 无       | $10$       |\n| $4$        | $\\le 30000$ | $\\le 30000$ | 无       | $10$       |\n| $5$        | $\\le 50000$ | $\\le 50000$ | A        | $10$       |\n| $6$        | $\\le 50000$ | $\\le 50000$ | B        | $10$       |\n| $7$        | $\\le 50000$ | $\\le 50000$ | 无       | $15$       |\n| $8$        | $\\le 10^5$  | $\\le 10^5$  | 无       | $25$       |\n\n- **特殊性质 A**：保证 $u_i = 1, v_i = i + 1, m = n - 1$。\n- **特殊性质 B**：保证 $l_i = 1$。\n", "locale": "zh-CN"}}}
{"pid": "P10269", "type": "P", "difficulty": 6, "samples": [["4 4 998244353\n8 15 12 6\n2\n3\n4\n5", "1 19\n2 7\n1 1\n0 0"], ["6 4 19260817\n11 45 14 19 19 810\n2\n1\n2\n2", "12 78\n0 918\n12 78\n12 78"], ["8 3 19491001\n3 2 2 3 1 2 1 2\n5\n3\n4", "56 56\n52 60\n69 71"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1500, 1500, 1500, 1500, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数论", "素数判断,质数,筛法", "最大公约数 gcd", "莫比乌斯反演"], "title": "实力派", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/z8ednvb2.png)", "description": "来自全国各地的 $n$ 位 OIer 组成了一个名为“实力派”的团队，每个人有一个实力值 $a_i$。共有 $m$ 场比赛向他们发送了参赛邀请，其中第 $i$ 场比赛要求 $k_i$ 个人组成一个队伍参加。为了决定他们是否应该参加某场比赛，他们想出了如下两个衡量实力的数据：\n\n- 定义 $x$ 阶最低实力表示从这 $n$ 个人中选出 $x$ 个人，使得这 $x$ 个人实力值的 $\\gcd=1$ 的方案数；\n\n- 定义 $x$ 阶最高实力表示从这 $n$ 个人中选出 $x$ 个人，所有方案的 $x$ 个人的 $\\gcd$ 之和。\n\n请你对于每场比赛，告诉他们他们在这场比赛中的 $k_i$ 阶最低实力和最高实力。对了，为了不让别人听懂，你需要将答案对一个秘密模数 $p$ 取模。", "inputFormat": "第一行三个整数 $n,m,p$，分别表示团队人数，比赛场数及秘密模数；\n\n第二行 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个人的实力值 $a_i$。\n\n接下来 $m$ 行，第 $i$ 行一个整数 $k_i$，表示第 $i$ 场比赛的要求参赛人数。", "outputFormat": "输出共 $m$ 行，第 $i$ 行两个整数 $min_i,max_i$，分别表示他们在第 $i$ 场比赛中的最低实力和最高实力，答案对 $p$ 取模。", "hint": "**样例** $\\mathbf{1}$ **解释**\n\n第一场比赛要求选出 $2$ 人参加，仅有 $(8,15)$ 一种方案的 $\\gcd=1$，因此最低实力为 $1$；所有方案的 $\\gcd$ 之和为 $19$，因此最高实力为 $19$；\n\n第二场比赛要求选出 $3$ 人参加，有 $(8,15,12)$ 和 $(8,15,6)$ 两种 $\\gcd=1$ 的方案，因此最低实力为 $2$；所有方案的 $\\gcd$ 之和为 $7$，因此最高实力为 $7$。\n\n**数据范围**\n\n对于所有数据，$1\\leq n,m,k_i\\leq 2\\times 10^5$，$1\\leq a_i\\leq 10^6$，$10^7\\leq p\\leq 10^9$，$p\\in \\mathbb{P}$。\n\n本题共 $30$ 个测试点，**采用捆绑测试**，子任务及数据点分配如下：\n\n| 子任务编号 | 数据点编号 | 特殊性质 | 分值 | 时限 |\n| :-: | :-: | :-: | :-: | :-: |\n| $0$ | $1\\sim 4$ | $n\\leq 20$ | $10$ | $1s$ |\n| $1$ | $5\\sim 8$ | $n,a_i\\leq 300$ | $10$ | $1s$ | \n| $2$ | $9\\sim 12$ | $k_i\\leq 2$ | $20$ | $1.5s$ |\n| $3$ | $13\\sim 16$ | $a_i\\leq 3$ | $10$ | $1s$ |\n| $4$ | $17\\sim 22$ | $a_i\\leq 10^5$ | $20$ | $1s$ |\n| $5$ | $23\\sim 30$ | 无特殊性质 | $30$ | $1.5s$ |\n\n**提示**\n\n$\\mathbb{P}$ 表示全体质数集合，$\\gcd$ 表示最大公因数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "实力派", "background": "![](https://cdn.luogu.com.cn/upload/image_hosting/z8ednvb2.png)", "description": "来自全国各地的 $n$ 位 OIer 组成了一个名为“实力派”的团队，每个人有一个实力值 $a_i$。共有 $m$ 场比赛向他们发送了参赛邀请，其中第 $i$ 场比赛要求 $k_i$ 个人组成一个队伍参加。为了决定他们是否应该参加某场比赛，他们想出了如下两个衡量实力的数据：\n\n- 定义 $x$ 阶最低实力表示从这 $n$ 个人中选出 $x$ 个人，使得这 $x$ 个人实力值的 $\\gcd=1$ 的方案数；\n\n- 定义 $x$ 阶最高实力表示从这 $n$ 个人中选出 $x$ 个人，所有方案的 $x$ 个人的 $\\gcd$ 之和。\n\n请你对于每场比赛，告诉他们他们在这场比赛中的 $k_i$ 阶最低实力和最高实力。对了，为了不让别人听懂，你需要将答案对一个秘密模数 $p$ 取模。", "inputFormat": "第一行三个整数 $n,m,p$，分别表示团队人数，比赛场数及秘密模数；\n\n第二行 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个人的实力值 $a_i$。\n\n接下来 $m$ 行，第 $i$ 行一个整数 $k_i$，表示第 $i$ 场比赛的要求参赛人数。", "outputFormat": "输出共 $m$ 行，第 $i$ 行两个整数 $min_i,max_i$，分别表示他们在第 $i$ 场比赛中的最低实力和最高实力，答案对 $p$ 取模。", "hint": "**样例** $\\mathbf{1}$ **解释**\n\n第一场比赛要求选出 $2$ 人参加，仅有 $(8,15)$ 一种方案的 $\\gcd=1$，因此最低实力为 $1$；所有方案的 $\\gcd$ 之和为 $19$，因此最高实力为 $19$；\n\n第二场比赛要求选出 $3$ 人参加，有 $(8,15,12)$ 和 $(8,15,6)$ 两种 $\\gcd=1$ 的方案，因此最低实力为 $2$；所有方案的 $\\gcd$ 之和为 $7$，因此最高实力为 $7$。\n\n**数据范围**\n\n对于所有数据，$1\\leq n,m,k_i\\leq 2\\times 10^5$，$1\\leq a_i\\leq 10^6$，$10^7\\leq p\\leq 10^9$，$p\\in \\mathbb{P}$。\n\n本题共 $30$ 个测试点，**采用捆绑测试**，子任务及数据点分配如下：\n\n| 子任务编号 | 数据点编号 | 特殊性质 | 分值 | 时限 |\n| :-: | :-: | :-: | :-: | :-: |\n| $0$ | $1\\sim 4$ | $n\\leq 20$ | $10$ | $1s$ |\n| $1$ | $5\\sim 8$ | $n,a_i\\leq 300$ | $10$ | $1s$ | \n| $2$ | $9\\sim 12$ | $k_i\\leq 2$ | $20$ | $1.5s$ |\n| $3$ | $13\\sim 16$ | $a_i\\leq 3$ | $10$ | $1s$ |\n| $4$ | $17\\sim 22$ | $a_i\\leq 10^5$ | $20$ | $1s$ |\n| $5$ | $23\\sim 30$ | 无特殊性质 | $30$ | $1.5s$ |\n\n**提示**\n\n$\\mathbb{P}$ 表示全体质数集合，$\\gcd$ 表示最大公因数。", "locale": "zh-CN"}}}
{"pid": "P10270", "type": "P", "difficulty": 2, "samples": [["3 3\nabe\nbcx\nexy", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": [], "title": "好奇心宝贝", "background": "> 道路，由人亲手制造。\n>\n> 酒与面包，靠劳作取得。\n>\n> 幼小的新芽舒展叶片，\n>\n> 与成堆魔药中抵抗困意。\n>\n> 多一点，再多一点时间，\n>\n> 再看看书的下一页。", "description": "给出一个 $n\\times m$ 的矩阵，每个位置 $(i,j)$ 都是一个小写字母。\n\n定义一条路径对应的字符串为路径上字符顺次连接所形成的字符串。\n\n请找出两条从 $(1,1)$ 到 $(n,m)$ 的路径，要求只能向下或向右走，最小化两条路径对应字符串的最长公共前缀。\n\n", "inputFormat": "第一行两个数 $n,m$。\n\n接下来 $n$ 行，每行 $m$ 个字符，描述整个矩阵。", "outputFormat": "输出为一个数，即最短的最长公共前缀长度。", "hint": "### 样例一解释\n\n选择的两条路径分别为：\n\n- $(1,1)\\rightarrow (1,2)\\rightarrow (1,3)\\rightarrow (2,3)\\rightarrow (3,3):$ `abexy`。\n\n- $(1,1)\\rightarrow (1,2)\\rightarrow (2,2)\\rightarrow (2,3)\\rightarrow (3,3):$ `abcxy`。\n\n它们的最长公共前缀为 $2$。可以证明没有更优的方案。\n\n### 数据范围与约定\n\n对于 $30\\%$ 的数据，$1\\le n,m \\le 5$。\n\n对于 $50\\%$ 的数据，$1 \\le n,m \\le 50$。\n\n对于另外 $20\\%$ 的数据，矩阵随机生成且只含字母 `a,b`。\n\n对于 $100\\%$ 的数据，$1 \\le n,m \\le 2\\times 10^3$，输入均为整数和小写字母。\n\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "好奇心宝贝", "background": "> 道路，由人亲手制造。\n>\n> 酒与面包，靠劳作取得。\n>\n> 幼小的新芽舒展叶片，\n>\n> 与成堆魔药中抵抗困意。\n>\n> 多一点，再多一点时间，\n>\n> 再看看书的下一页。", "description": "给出一个 $n\\times m$ 的矩阵，每个位置 $(i,j)$ 都是一个小写字母。\n\n定义一条路径对应的字符串为路径上字符顺次连接所形成的字符串。\n\n请找出两条从 $(1,1)$ 到 $(n,m)$ 的路径，要求只能向下或向右走，最小化两条路径对应字符串的最长公共前缀。\n\n", "inputFormat": "第一行两个数 $n,m$。\n\n接下来 $n$ 行，每行 $m$ 个字符，描述整个矩阵。", "outputFormat": "输出为一个数，即最短的最长公共前缀长度。", "hint": "### 样例一解释\n\n选择的两条路径分别为：\n\n- $(1,1)\\rightarrow (1,2)\\rightarrow (1,3)\\rightarrow (2,3)\\rightarrow (3,3):$ `abexy`。\n\n- $(1,1)\\rightarrow (1,2)\\rightarrow (2,2)\\rightarrow (2,3)\\rightarrow (3,3):$ `abcxy`。\n\n它们的最长公共前缀为 $2$。可以证明没有更优的方案。\n\n### 数据范围与约定\n\n对于 $30\\%$ 的数据，$1\\le n,m \\le 5$。\n\n对于 $50\\%$ 的数据，$1 \\le n,m \\le 50$。\n\n对于另外 $20\\%$ 的数据，矩阵随机生成且只含字母 `a,b`。\n\n对于 $100\\%$ 的数据，$1 \\le n,m \\le 2\\times 10^3$，输入均为整数和小写字母。\n\n", "locale": "zh-CN"}}}
{"pid": "P10271", "type": "P", "difficulty": 5, "samples": [["9\nabbbabbba", "3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": [], "title": "漫长悄悄话", "background": "> 故事从哪一页起始？\n>\n> 小石头，红土地，遥远的火。\n>\n> 摸索的轮廓，夜空之中，扑火的人。\n>\n> 手与手的相握，心与心碰触。\n>\n> 涌动在喉咙深沉，我温暖的火。 ", "description": "一些前置定义：\n\n- $\\text{Rev}(S):$ $S_{|S|},S_{|S|-1},\\dots,S_1$ 顺次相连形成的字符串。即将 $S$ 翻转。\n\n- $\\text{lcp}(i,j):$ 第 $i$ 个位置开始的后缀与第 $j$ 个位置开始的后缀的最长公共前缀**对应的字符串**。\n\n- $\\text{lcs}(i,j):$ 第 $i$ 个位置结束的前缀与第 $j$ 个位置结束的前缀的最长公共后缀**对应的字符串**。\n\n- $\\text{LCP}(S,T):$ $S$ 和 $T$ 的最长公共前缀。\n----\n\n给出长度为 $n$ 的字符串 $S$，求：\n\n$$\\max\\limits_{1 \\le i < j \\le n}\\{\\text{LCP}(\\text{Rev}(\\text{lcs}(i,j)),\\text{lcp}(i,j))\\}$$", "inputFormat": "第一行一个整数 $n$。\n\n第二行一个长度为 $n$ 的字符串 $S$。", "outputFormat": "输出为一个数，即答案。", "hint": "### 样例一解释\n\n$\\text{lcp}(3,7):$ `bba`。\n\n$\\text{lcs}(3,7):$ `abb`。\n\n$\\text{LCP}(\\text{Rev}(\\texttt{\\color{blue}abb}),\\texttt{\\color{blue}bba}):$ `bba`。\n\n可以证明，没有比 $i=3,j=7$ 更优的方案。\n\n\n### 数据范围与约束\n\n对于 $30\\%$ 的数据，$1 \\le n \\le 2\\times 10^3$。\n\n对于 $60\\%$ 的数据，$1 \\le n \\le 10^5$。\n\n对于另外 $10\\%$ 的数据，$\\forall 1 \\le i \\le n-2,S_{i}\\not=S_{i+2}$。\n\n对于 $100\\%$ 的数据 $1 \\le n \\le 10^6$，输入均为整数和小写字母。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "漫长悄悄话", "background": "> 故事从哪一页起始？\n>\n> 小石头，红土地，遥远的火。\n>\n> 摸索的轮廓，夜空之中，扑火的人。\n>\n> 手与手的相握，心与心碰触。\n>\n> 涌动在喉咙深沉，我温暖的火。 ", "description": "一些前置定义：\n\n- $\\text{Rev}(S):$ $S_{|S|},S_{|S|-1},\\dots,S_1$ 顺次相连形成的字符串。即将 $S$ 翻转。\n\n- $\\text{lcp}(i,j):$ 第 $i$ 个位置开始的后缀与第 $j$ 个位置开始的后缀的最长公共前缀**对应的字符串**。\n\n- $\\text{lcs}(i,j):$ 第 $i$ 个位置结束的前缀与第 $j$ 个位置结束的前缀的最长公共后缀**对应的字符串**。\n\n- $\\text{LCP}(S,T):$ $S$ 和 $T$ 的最长公共前缀。\n----\n\n给出长度为 $n$ 的字符串 $S$，求：\n\n$$\\max\\limits_{1 \\le i < j \\le n}\\{\\text{LCP}(\\text{Rev}(\\text{lcs}(i,j)),\\text{lcp}(i,j))\\}$$", "inputFormat": "第一行一个整数 $n$。\n\n第二行一个长度为 $n$ 的字符串 $S$。", "outputFormat": "输出为一个数，即答案。", "hint": "### 样例一解释\n\n$\\text{lcp}(3,7):$ `bba`。\n\n$\\text{lcs}(3,7):$ `abb`。\n\n$\\text{LCP}(\\text{Rev}(\\texttt{\\color{blue}abb}),\\texttt{\\color{blue}bba}):$ `bba`。\n\n可以证明，没有比 $i=3,j=7$ 更优的方案。\n\n\n### 数据范围与约束\n\n对于 $30\\%$ 的数据，$1 \\le n \\le 2\\times 10^3$。\n\n对于 $60\\%$ 的数据，$1 \\le n \\le 10^5$。\n\n对于另外 $10\\%$ 的数据，$\\forall 1 \\le i \\le n-2,S_{i}\\not=S_{i+2}$。\n\n对于 $100\\%$ 的数据 $1 \\le n \\le 10^6$，输入均为整数和小写字母。", "locale": "zh-CN"}}}
{"pid": "P10272", "type": "P", "difficulty": 6, "samples": [["ababcab\n1 3", "39"], ["aa\n3 5", "59"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": [], "title": "在四方城外", "background": "> 柳花、青山与月光。\n>\n> 诗中的酒香与诗外的酒香。\n>\n> 城中的天空与城外的天空。\n>\n> 一字一句，一笔一划，所知晓的，尚懵懂的。\n>\n> \t看呀看，学呀学，世界正如浊酒，滋味饮酌方知。", "description": "定义字符串 $S$ 的**扩展**操作为：\n\n- 求出 $S$ 的最长 $\\text{border}$ $T$。\n\n- $S'\\leftarrow S+T$。\n\n**注意，本题的 $\\text{border}$ 指真 $\\text{border}$（即字符串本身不计入 $\\text{border}$）**。\n\n设**扩展**操作的权值为**扩展**后字符串的长度 $|S'|$，请求出字符串 $S$ 第 $L$  次**扩展**到第 $R$ 次**扩展**的权值之和。\n\n由于结果可能很大，请输出答案对 $998244353$ 取模的结果。", "inputFormat": "第一行一个字符串 $S$。\n\n第二行两个整数 $L,R$。", "outputFormat": "输出为一个数，即答案对 $998244353$ 取模的结果。", "hint": "### 样例一解释\n\n第 $1$ 次扩展操作：`ababcab[ab]`，权值为 $9$。\n\n第 $2$ 次扩展操作：`ababcabab[abab]`，权值为 $13$。\n\n第 $3$ 次扩展操作：`ababcabababab[abab]`，权值为 $17$。\n\n权值之和为 $9+13+17=39$。\n\n### 数据范围与约束\n\n对于 $30\\%$ 的数据，$1 \\le |S| \\le 100,1 \\le L,R \\le 10$。\n\n对于 $60\\%$ 的数据，$1 \\le L,R \\le 10^6$。\n\n对于另外 $10\\%$ 的数据，$\\text{border}_{S}=|S|-1$。\n\n对于 $100\\%$ 的数据，$1 \\le |S| \\le 10^6,1 \\le L \\le R \\le 10^9$，输入均为整数和小写字母。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "在四方城外", "background": "> 柳花、青山与月光。\n>\n> 诗中的酒香与诗外的酒香。\n>\n> 城中的天空与城外的天空。\n>\n> 一字一句，一笔一划，所知晓的，尚懵懂的。\n>\n> \t看呀看，学呀学，世界正如浊酒，滋味饮酌方知。", "description": "定义字符串 $S$ 的**扩展**操作为：\n\n- 求出 $S$ 的最长 $\\text{border}$ $T$。\n\n- $S'\\leftarrow S+T$。\n\n**注意，本题的 $\\text{border}$ 指真 $\\text{border}$（即字符串本身不计入 $\\text{border}$）**。\n\n设**扩展**操作的权值为**扩展**后字符串的长度 $|S'|$，请求出字符串 $S$ 第 $L$  次**扩展**到第 $R$ 次**扩展**的权值之和。\n\n由于结果可能很大，请输出答案对 $998244353$ 取模的结果。", "inputFormat": "第一行一个字符串 $S$。\n\n第二行两个整数 $L,R$。", "outputFormat": "输出为一个数，即答案对 $998244353$ 取模的结果。", "hint": "### 样例一解释\n\n第 $1$ 次扩展操作：`ababcab[ab]`，权值为 $9$。\n\n第 $2$ 次扩展操作：`ababcabab[abab]`，权值为 $13$。\n\n第 $3$ 次扩展操作：`ababcabababab[abab]`，权值为 $17$。\n\n权值之和为 $9+13+17=39$。\n\n### 数据范围与约束\n\n对于 $30\\%$ 的数据，$1 \\le |S| \\le 100,1 \\le L,R \\le 10$。\n\n对于 $60\\%$ 的数据，$1 \\le L,R \\le 10^6$。\n\n对于另外 $10\\%$ 的数据，$\\text{border}_{S}=|S|-1$。\n\n对于 $100\\%$ 的数据，$1 \\le |S| \\le 10^6,1 \\le L \\le R \\le 10^9$，输入均为整数和小写字母。", "locale": "zh-CN"}}}
{"pid": "P10273", "type": "P", "difficulty": 7, "samples": [["10 5\nabbaababaa\n0111111111\n1 5\n7 10\n1 3\n3 7\n4 8", "01111"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化"], "title": "大娱乐至上", "background": "> 闪光，黑洞，万众瞩目之星。\n>\n> 美丽的国度之中最美丽的梦。\n>\n> 她的发丝比金箔更贵，她的唇印可抵成捆钞票。\n>\n> 而她的心呀，心呀，心呀，\n>\n> 不值一枚金币，不值一枚金币，不值一瞧。", "description": "给出一个由小写字母组成、长度为 $n$ 的字符串 $S$ 和一个长度为 $n$ 的 $01$ 串 $b$，$b_i=1$ 表示 $S_i$ 是可修改的。\n\n给出 $m$ 个子串 $S_{[l,r]}$，定义一个子串 $str$ 是**非偏序**的，当且仅当可以通过修改 $S$ 的至多一个位置，使得 $m$ 个子串中原先 $<str$ 的子串都 $\\ge str$。\n\n形式化地说，一个二元组 $(l_i,r_i)$ 是**非偏序**的，当且仅当存在一个字符串 $T$（由 $S$ 修改至多一个字符得到），使得 $\\forall\\,1 \\le j \\le m,[S_{[l_j,r_j]}<S_{[l_i,r_i]}]+[T_{[l_j,r_j]}<T_{[l_i,r_i]}]\\not=2$。\n\n询问哪些子串是**非偏序**的。\n\n注意，修改后出现比 `a` 小或比 `z` 大的字符是**允许的**。\n\n", "inputFormat": "第一行两个数 $n,m$。\n\n第二行一个字符串 $S$。\n\n第三行一个 $01$ 串 $b$。\n\n接下来 $m$ 行，每行一个二元组 $(l_i,r_i)$。", "outputFormat": "输出为一个长度为 $m$ 的 $01$ 串 $ans$。$ans_i=1$ 表示 $(l_i,r_i)$ 是 `非偏序` 的，$ans_i=0$ 表示不是。", "hint": "### 样例一解释\n\n为了方便表述，钦定比 `a` 小的字符为 `#`，比 `z` 大的字符为 `*`。\n\n- $(1,5):$ 无论如何修改，恒有 $S_{[1,3]}<S_{[1,5]},T_{[1,3]}<T_{[1,5]}$。\n\n- $(7,10):$ $T$ 可以为 `abbcababaa`。\n\n- $(1,3):$ $T$ 可以为 `a#baababaa`。\n\n- $(3,7):$ $T$ 可以为 `ab#aababaa`。\n\n- $(4,8):$ $T$ 可以为 `abbaababaa`。\n\n### 数据范围与约定\n \n**本题采用捆绑测试**。\n\n$\\text{subtask1(10pt):}$ $1 \\le n,m \\le 100$。\n\n$\\text{subtask2(30pt):}$ $1 \\le n,m \\le 1000$。\n\n$\\text{subtask3(10pt):}$ $b_i=1$。\n\n$\\text{subtask4(50pt):}$ 无特殊限制。\n\n对于所有数据，$1\\le n,m \\le 2\\times 10^5,1 \\le l_i \\le r_i \\le n$，输入均为整数和小写字母。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "大娱乐至上", "background": "> 闪光，黑洞，万众瞩目之星。\n>\n> 美丽的国度之中最美丽的梦。\n>\n> 她的发丝比金箔更贵，她的唇印可抵成捆钞票。\n>\n> 而她的心呀，心呀，心呀，\n>\n> 不值一枚金币，不值一枚金币，不值一瞧。", "description": "给出一个由小写字母组成、长度为 $n$ 的字符串 $S$ 和一个长度为 $n$ 的 $01$ 串 $b$，$b_i=1$ 表示 $S_i$ 是可修改的。\n\n给出 $m$ 个子串 $S_{[l,r]}$，定义一个子串 $str$ 是**非偏序**的，当且仅当可以通过修改 $S$ 的至多一个位置，使得 $m$ 个子串中原先 $<str$ 的子串都 $\\ge str$。\n\n形式化地说，一个二元组 $(l_i,r_i)$ 是**非偏序**的，当且仅当存在一个字符串 $T$（由 $S$ 修改至多一个字符得到），使得 $\\forall\\,1 \\le j \\le m,[S_{[l_j,r_j]}<S_{[l_i,r_i]}]+[T_{[l_j,r_j]}<T_{[l_i,r_i]}]\\not=2$。\n\n询问哪些子串是**非偏序**的。\n\n注意，修改后出现比 `a` 小或比 `z` 大的字符是**允许的**。\n\n", "inputFormat": "第一行两个数 $n,m$。\n\n第二行一个字符串 $S$。\n\n第三行一个 $01$ 串 $b$。\n\n接下来 $m$ 行，每行一个二元组 $(l_i,r_i)$。", "outputFormat": "输出为一个长度为 $m$ 的 $01$ 串 $ans$。$ans_i=1$ 表示 $(l_i,r_i)$ 是 `非偏序` 的，$ans_i=0$ 表示不是。", "hint": "### 样例一解释\n\n为了方便表述，钦定比 `a` 小的字符为 `#`，比 `z` 大的字符为 `*`。\n\n- $(1,5):$ 无论如何修改，恒有 $S_{[1,3]}<S_{[1,5]},T_{[1,3]}<T_{[1,5]}$。\n\n- $(7,10):$ $T$ 可以为 `abbcababaa`。\n\n- $(1,3):$ $T$ 可以为 `a#baababaa`。\n\n- $(3,7):$ $T$ 可以为 `ab#aababaa`。\n\n- $(4,8):$ $T$ 可以为 `abbaababaa`。\n\n### 数据范围与约定\n \n**本题采用捆绑测试**。\n\n$\\text{subtask1(10pt):}$ $1 \\le n,m \\le 100$。\n\n$\\text{subtask2(30pt):}$ $1 \\le n,m \\le 1000$。\n\n$\\text{subtask3(10pt):}$ $b_i=1$。\n\n$\\text{subtask4(50pt):}$ 无特殊限制。\n\n对于所有数据，$1\\le n,m \\le 2\\times 10^5,1 \\le l_i \\le r_i \\le n$，输入均为整数和小写字母。\n", "locale": "zh-CN"}}}
{"pid": "P10274", "type": "P", "difficulty": 4, "samples": [["5 7\nfalse and true or true\n1 1 false\n1 3 true\n1 5 false\n3 3 true\n3 3 false\n5 5 false\n5 5 true", "NYYYNYY"], ["13 4\nfalse or true and false and false and true or true and false\n1 5 false\n3 11 true\n3 11 false\n13 13 true", "YNYY"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["模拟", "USACO", "2024", "分类讨论"], "title": "[USACO24OPEN] Logical Moos B", "background": "", "description": "Farmer John has a boolean statement that is $N$ keywords long ($1 \\leq N < 2 \\cdot 10^5$, $N$ odd). Only $\\texttt{true}$ or $\\texttt{false}$ appear in odd positions, while only $\\texttt{and}$ and $\\texttt{or}$ appear in even positions.  \n\nA phrase of the form $x\\text{ OPERATOR }y$, where $x$ and $y$ are either $\\texttt{true}$ or $\\texttt{false}$, and $\\text{OPERATOR}$ is $\\texttt{and}$ or $\\texttt{or}$, evaluates as follows:  \n\n\n- $x\\texttt{ and }y$: This evaluates to true if both $x$ and $y$ are true, and false otherwise.\n- $x\\texttt{ or }y$: This evaluates to true if either $x$ or $y$ is true, and false otherwise.  \n\nWhen evaluating the statement, FJ has to take the order of precedence in Moo Language into account. Similar to C++, $\\texttt{and}$ takes priority over $\\texttt{or}$. More specifically, to evaluate the statement, repeat the following step until the statement consists of only one keyword.  \n\n\n1. If the statement contains an $\\texttt{and}$, choose any of them and replace the phrase surrounding it with its evaluation.\n1. Otherwise, the statement contains an $\\texttt{or}$. Choose any of them and replace the phrase surrounding it with its evaluation.  \n\nIt may be proven that if multiple phrases can be evaluated during a given step, it does not matter which one is chosen; the statement will always evaluate to the same value.  \n\nFJ has $Q$ $(1 \\leq Q \\leq 2 \\cdot 10^5)$ queries. In each query, he gives you two integers $l$ and $r$ ($1 \\leq l \\leq r \\leq N$, $l$ and $r$ are both odd), and deletes the segment from keyword $l$ to keyword $r$ inclusive. In turn, he wishes to replace the segment he just deleted with just one simple $\\texttt{true}$ or $\\texttt{false}$ so that the whole statement evaluates to a certain boolean value. Help FJ determine if it's possible!", "inputFormat": "The first line contains $N$ and $Q$.  \n\nThe next line contains $N$ strings, a valid boolean statement.  \n\nThe following $Q$ lines contain two integers $l$ and $r$, and a string $\\texttt{true}$ or $\\texttt{false}$, denoting whether he wants the whole statement to evaluate to true or false.", "outputFormat": "Output a string of length $Q$, where the $i$'th character is Y if the $i$'th query is possible, otherwise N.", "hint": "##### For Sample 1:\nLet's analyze the first query:  \n\nIf we were to replace delete the segment $[1, 1]$ and replace it with $\\texttt{true}$, then the whole statement becomes:  \n```\ntrue and true or true\n```\n\n\nWe evaluate the $\\texttt{and}$ keyword from at position $2$ and obtain  \n```\ntrue or true\n```\n\n\nSince we have no $\\texttt{and}$ keywords left, we have to evaluate the $\\texttt{or}$ keyword. After evaluation, all that is left is  \n```\ntrue\n```\n\n\nIt can be shown that if we were to replace the segment with $\\texttt{false}$, the statement will still evaluate to $\\texttt{true}$, so we output N since the statement cannot possibly evaluate to $\\texttt{false}$.  \n\nFor the second query, we can replace the segment $[1, 3]$ with $\\texttt{true}$ and the whole statement will evaluate to $\\texttt{true}$, so we output Y.  \n\nFor the third query, since $[1, 5]$ is the whole statement, we can replace it with anything, so we output Y.  \n\n\n\n#### SCORING:\n\n- Inputs 3-5: $N,Q\\le 10^2$\n- Inputs 6-8: $N,Q\\le 10^3$\n- Inputs 9-26: No additional constraints.", "locale": "en", "translations": {"en": {"title": "[USACO24OPEN] Logical Moos B", "background": "", "description": "Farmer John has a boolean statement that is $N$ keywords long ($1 \\leq N < 2 \\cdot 10^5$, $N$ odd). Only $\\texttt{true}$ or $\\texttt{false}$ appear in odd positions, while only $\\texttt{and}$ and $\\texttt{or}$ appear in even positions.  \n\nA phrase of the form $x\\text{ OPERATOR }y$, where $x$ and $y$ are either $\\texttt{true}$ or $\\texttt{false}$, and $\\text{OPERATOR}$ is $\\texttt{and}$ or $\\texttt{or}$, evaluates as follows:  \n\n\n- $x\\texttt{ and }y$: This evaluates to true if both $x$ and $y$ are true, and false otherwise.\n- $x\\texttt{ or }y$: This evaluates to true if either $x$ or $y$ is true, and false otherwise.  \n\nWhen evaluating the statement, FJ has to take the order of precedence in Moo Language into account. Similar to C++, $\\texttt{and}$ takes priority over $\\texttt{or}$. More specifically, to evaluate the statement, repeat the following step until the statement consists of only one keyword.  \n\n\n1. If the statement contains an $\\texttt{and}$, choose any of them and replace the phrase surrounding it with its evaluation.\n1. Otherwise, the statement contains an $\\texttt{or}$. Choose any of them and replace the phrase surrounding it with its evaluation.  \n\nIt may be proven that if multiple phrases can be evaluated during a given step, it does not matter which one is chosen; the statement will always evaluate to the same value.  \n\nFJ has $Q$ $(1 \\leq Q \\leq 2 \\cdot 10^5)$ queries. In each query, he gives you two integers $l$ and $r$ ($1 \\leq l \\leq r \\leq N$, $l$ and $r$ are both odd), and deletes the segment from keyword $l$ to keyword $r$ inclusive. In turn, he wishes to replace the segment he just deleted with just one simple $\\texttt{true}$ or $\\texttt{false}$ so that the whole statement evaluates to a certain boolean value. Help FJ determine if it's possible!", "inputFormat": "The first line contains $N$ and $Q$.  \n\nThe next line contains $N$ strings, a valid boolean statement.  \n\nThe following $Q$ lines contain two integers $l$ and $r$, and a string $\\texttt{true}$ or $\\texttt{false}$, denoting whether he wants the whole statement to evaluate to true or false.", "outputFormat": "Output a string of length $Q$, where the $i$'th character is Y if the $i$'th query is possible, otherwise N.", "hint": "##### For Sample 1:\nLet's analyze the first query:  \n\nIf we were to replace delete the segment $[1, 1]$ and replace it with $\\texttt{true}$, then the whole statement becomes:  \n```\ntrue and true or true\n```\n\n\nWe evaluate the $\\texttt{and}$ keyword from at position $2$ and obtain  \n```\ntrue or true\n```\n\n\nSince we have no $\\texttt{and}$ keywords left, we have to evaluate the $\\texttt{or}$ keyword. After evaluation, all that is left is  \n```\ntrue\n```\n\n\nIt can be shown that if we were to replace the segment with $\\texttt{false}$, the statement will still evaluate to $\\texttt{true}$, so we output N since the statement cannot possibly evaluate to $\\texttt{false}$.  \n\nFor the second query, we can replace the segment $[1, 3]$ with $\\texttt{true}$ and the whole statement will evaluate to $\\texttt{true}$, so we output Y.  \n\nFor the third query, since $[1, 5]$ is the whole statement, we can replace it with anything, so we output Y.  \n\n\n\n#### SCORING:\n\n- Inputs 3-5: $N,Q\\le 10^2$\n- Inputs 6-8: $N,Q\\le 10^3$\n- Inputs 9-26: No additional constraints.", "locale": "en"}, "zh-CN": {"title": "[USACO24OPEN] Logical Moos B", "background": "", "description": "Farmer John 有一个布尔语句，包含 $N$ 个关键字（$1\\le N<2\\cdot 10^5$，$N$ 为奇数）。奇数位置仅出现 $\\texttt{true}$ 或 $\\texttt{false}$，偶数位置上仅出现 $\\texttt{and}$ 或 $\\texttt{or}$。\n\n一个 $x \\operatorname{OPERATOR} y$ 形式的短语，其中 $x$ 和 $y$ 为 $\\texttt{true}$ 或 $\\texttt{false}$，而 $\\operatorname{OPERATOR}$ 为 $\\texttt{and}$ 或 $\\texttt{or}$ ，按如下规则求值：\n\n- $x \\operatorname{and} y$：如果 $x$ 和 $y$ 均为 $\\texttt{true}$，则求值结果为 $\\texttt{true}$，否则为 $\\texttt{false}$。\n- $x \\operatorname{or} y$：如果 $x$ 或 $y$ 为 $\\texttt{true}$，则求值结果为 $\\texttt{true}$，否则为 $\\texttt{false}$。\n\n在求值该语句时，FJ 必须考虑 Moo 语言中的运算符优先级。与 C++ 类似，$\\operatorname{and}$ 优先级高于 $\\operatorname{or}$。更具体地说，在求值该语句时，重复以下步骤直至该语句仅包含一个关键字。\n\n1. 如果语句中包含 $\\operatorname{and}$，选择其中任意一个，并将其周围的短语替换为其求值结果。\n2. 否则，该语句包含 $\\operatorname{or}$。选择其中任意一个，并将其周围的短语替换为其求值结果。\n\n可以证明，如果在指定的一个步骤中可以求值多个短语，那么选择哪一个求值并不重要；该语句最终的求值结果将始终相同。\n\nFJ 有 $Q$（$1\\le Q\\le 2\\cdot 10^5$）个询问。在每个询问中，他给你两个整数 $l$ 和 $r$（$1\\le l\\le r\\le N$，$l$ 和 $r$ 均为奇数），并删除关键字 $l$ 到关键字 $r$ 之间的段。反过来，他希望用一个简单的 $\\texttt{true}$ 或 $\\texttt{false}$ 替换他刚刚删除的段，以使整个语句的求值结果为某个指定的布尔值。帮助 FJ 判断是否可行！ ", "inputFormat": "输入的第一行包含 $N$ 和 $Q$。\n\n下一行包含 $N$ 个字符串，为一个合法的布尔语句。\n\n以下 $Q$ 行，每行包含两个整数 $l$ 和 $r$，以及一个字符串 $\\texttt{true}$ 或 $\\texttt{false}$，表示他希望整个语句的求值结果为 $\\texttt{true}$ 还是 $\\texttt{false}$。 ", "outputFormat": "输出一个长度为 $Q$ 的字符串，其中如果第 $i$ 个询问的结果为可能，则第 $i$ 个字符为 `Y`，否则为 `N`。 ", "hint": "### 样例解释 1\n\n我们来分析第一个询问：\n\n如果我们删除段 $[1,1]$ 并替换为 $\\texttt{true}$，那么整个语句将变为：\n\n$\\texttt{true and true or true}$\n\n我们对位置 $2$ 处的 $\\texttt{and}$\n\n关键字求值，得到\n\n$\\texttt{true or true}$\n\n由于我们没有剩下的 $\\texttt{and}$ 关键字，我们必须求值 $\\texttt{or}$ 关键字。求值结束后，余下的是\n\n$\\texttt{true}$\n\n可以证明，如果我们用 $\\texttt{false}$ 替换该段，该语句仍将求值为 $\\texttt{true}$，因此我们输出 `N`，因为该语句不可能求值为 false。\n\n对于第二个询问，我们可以将段 $[1,3]$\n替换为 true，整个语句将求值为 $\\texttt{true}$，因此我们输出 `Y`。\n\n对于第三个询问，由于 $[1,5]$ 是整个语句，我们可以将其替换为任意内容，因此我们输出 `Y`。\n\n### 测试点性质\n\n- 测试点 $3-5$：$N,Q\\le 10^2$。\n- 测试点 $6-8$：$N,Q\\le 10^3$。\n- 测试点 $9-26$：没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P10275", "type": "P", "difficulty": 3, "samples": [["5 4\n0 0\n2 0\n2 2\n0 2\n0 0 0 2\n0 2 1 0\n2 1 0 2\n1 0 1 2\n1 2 1 0", "2\n3\n3\n4\n4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["模拟", "USACO", "2024"], "title": "[USACO24OPEN] Walking Along a Fence B", "background": "", "description": "Farmer John's $N$ cows ($1 \\leq N \\leq 10^5$) each like to take a daily walk around the fence enclosing his pasture.   \n\nThe fence consists of $P$ posts ($4 \\leq P \\leq 2\\cdot 10^5$, $P$ even), the location of each being a different 2D point $(x,y)$ on a map of FJ's farm ($0 \\leq x, y \\leq 1000$).  Each post is connected to the two adjacent posts by fences that are either vertical  or horizontal line segments, so the entire fence can be considered a polygon whose sides are parallel to the x or y axes (the last post connects back to the first post, ensuring the fence forms a closed loop that encloses the pasture).  The fence polygon is \"well-behaved\" in that fence segments only potentially overlap at their endpoints, each post aligns with exactly  two fence segment endpoints, and every two fence segments that meet at an endpoint are perpendicular.    \n\nEach cow has a preferred starting and ending position for her daily walk, each being points somewhere along the fence (possibly at posts, possibly not).  Each cow walks along the fence for her daily walks, starting from her starting position and ending at her ending position.  There are two routes that the cow could take, given that the fence forms a closed loop. Since cows are somewhat lazy creatures, each cow will walk in the direction around the fence that is shorter (if there is a tie, the cow may choose either direction).   \n\nDetermine the distance that each cow walks.", "inputFormat": "The first line of input contains $N$ and $P$. Each of the next $P$ lines contains two integers representing the positions of the fence posts in clockwise or counterclockwise order. Each of the next $N$ lines contains four integers $x_1$ $y_1$ $x_2$ $y_2$ representing the starting position $(x_1, y_1)$ and ending position $(x_2, y_2)$ of a cow.", "outputFormat": "Write $N$ integers as output, giving the distance that each cow walks.", "hint": "The first cow can walk directly from $(0,0)$ to $(0,2)$.  \n\nThe second cow can walk from $(0,2)$ to $(0,0)$ and then to $(1,0)$.  \n\nThe fourth cow has two possible routes with equal lengths: $(1,0)\\to (0,0)\\to (0,2)\\to (1,2)$ and $(1,0)\\to (2,0)\\to (2,2)\\to (1,2)$.  \n\n\n#### SCORING:\n\n- Inputs 2-6: $0\\le x,y \\le 100$ and $N\\le 100$\n- Inputs 7-11: No additional constraints.", "locale": "en", "translations": {"en": {"title": "[USACO24OPEN] Walking Along a Fence B", "background": "", "description": "Farmer John's $N$ cows ($1 \\leq N \\leq 10^5$) each like to take a daily walk around the fence enclosing his pasture.   \n\nThe fence consists of $P$ posts ($4 \\leq P \\leq 2\\cdot 10^5$, $P$ even), the location of each being a different 2D point $(x,y)$ on a map of FJ's farm ($0 \\leq x, y \\leq 1000$).  Each post is connected to the two adjacent posts by fences that are either vertical  or horizontal line segments, so the entire fence can be considered a polygon whose sides are parallel to the x or y axes (the last post connects back to the first post, ensuring the fence forms a closed loop that encloses the pasture).  The fence polygon is \"well-behaved\" in that fence segments only potentially overlap at their endpoints, each post aligns with exactly  two fence segment endpoints, and every two fence segments that meet at an endpoint are perpendicular.    \n\nEach cow has a preferred starting and ending position for her daily walk, each being points somewhere along the fence (possibly at posts, possibly not).  Each cow walks along the fence for her daily walks, starting from her starting position and ending at her ending position.  There are two routes that the cow could take, given that the fence forms a closed loop. Since cows are somewhat lazy creatures, each cow will walk in the direction around the fence that is shorter (if there is a tie, the cow may choose either direction).   \n\nDetermine the distance that each cow walks.", "inputFormat": "The first line of input contains $N$ and $P$. Each of the next $P$ lines contains two integers representing the positions of the fence posts in clockwise or counterclockwise order. Each of the next $N$ lines contains four integers $x_1$ $y_1$ $x_2$ $y_2$ representing the starting position $(x_1, y_1)$ and ending position $(x_2, y_2)$ of a cow.", "outputFormat": "Write $N$ integers as output, giving the distance that each cow walks.", "hint": "The first cow can walk directly from $(0,0)$ to $(0,2)$.  \n\nThe second cow can walk from $(0,2)$ to $(0,0)$ and then to $(1,0)$.  \n\nThe fourth cow has two possible routes with equal lengths: $(1,0)\\to (0,0)\\to (0,2)\\to (1,2)$ and $(1,0)\\to (2,0)\\to (2,2)\\to (1,2)$.  \n\n\n#### SCORING:\n\n- Inputs 2-6: $0\\le x,y \\le 100$ and $N\\le 100$\n- Inputs 7-11: No additional constraints.", "locale": "en"}, "zh-CN": {"title": "[USACO24OPEN] Walking Along a Fence B", "background": "", "description": "Farmer John 的 $N$ 头奶牛（$1\\le N\\le 10^5$）每头都喜欢日常沿围着牧场的栅栏散步。\n\n栅栏由 $P$ 根柱子组成（$4\\le P\\le 2\\cdot 10^5$，$P$ 为偶数），每根柱子的位置是 FJ 农场地图上的一个不同的二维坐标点 $(x,y)$（$0\\le x,y\\le 1000$）。每根柱子通过垂直或水平线段的栅栏连接到两根相邻的柱子，因此整个栅栏可以被视为各边平行于 $x$ 轴或 $y$ 轴的一个多边形（最后一根柱子连回第一根柱子，确保围栏形成一个包围牧场的闭环）。栅栏多边形是「规则的」，体现在栅栏段仅可能在其端点处重合，每根柱子恰好属于两个栅栏段，同时每两个在端点处相交的栅栏段都是垂直的。\n\n每头奶牛的日常散步都有一个偏好的起始和结束位置，均为沿栅栏的某个点（可能在柱子处，也可能不在）。每头奶牛日常散步时沿着栅栏行走，从起始位置开始，到结束位置结束。由于栅栏形成闭环，奶牛有两条路线可以选择。由于奶牛是一种有点懒的生物，每头奶牛都会选择距离较短的方向沿栅栏行走（如果并列，奶牛可以选择任一方向）。\n\n求每头奶牛行走的距离。 ", "inputFormat": "输入的第一行包含 $N$ 和 $P$。以下 $P$ 行的每一行包含两个整数，以顺时针或逆时针顺序表示栅栏柱子的位置。以下 $N$ 行的每一行包含四个整数 $x_1\\ y_1\\ x_2\\ y_2$，表示一头奶牛的起始位置 $(x_1,y_1)$ 和结束位置 $(x_2,y_2)$。 ", "outputFormat": "输出 $N$ 个整数，为每头奶牛行走的距离。 ", "hint": "### 样例解释\n\n第一头奶牛可以直接从 $(0,0)$ 走到 $(0,2)$。\n\n第二头奶牛可以从 $(0,2)$ 走到 $(0,0)$，然后走到 $(1,0)$。\n\n第四头奶牛有两条长度相等的可能路线：$(1,0)\\to (0,0)\\to (0,2)\\to (1,2)$ 和 $(1,0)\\to (2,0)\\to (2,2)\\to (1,2)$。\n\n### 测试点性质\n\n- 测试点 $2-6$：$0\\le x,y\\le 100$ 且 $N\\le 100$。\n- 测试点 $7-11$：没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P10276", "type": "P", "difficulty": 3, "samples": [["5\n2\n1\n2\n2\n4\n1 1 1\n4\n2 1 1\n4\n3 2 1", "1 2\n-1\n-1\n3 1 2 4\n1 2 3 4"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "USACO", "2024"], "title": "[USACO24OPEN] Farmer John's Favorite Permutation B", "background": "", "description": "Farmer John has a permutation $p$ of length $N$ ($2 \\leq N \\leq 10^5)$, containing each positive integer from $1$ to $N$ exactly once. However, Farmer Nhoj has broken into FJ's barn and disassembled $p$. To not be too cruel, FN has written some hints that will help FJ reconstruct $p$. While there is more than one element remaining in $p$, FN does the following:  \n\nLet the remaining elements of $p$ be $p'_1, p'_2, \\dots , p'_n$, \n-  If $p'_1 > p'_n$, he writes down $p'_2$ and removes $p'_1$ from the permutation.\n-  Otherwise, he writes down $p'_{n-1}$ and removes $p'_n$ from the permutation.  \n\nAt the end, Farmer Nhoj will have written down $N - 1$ integers $h_1, h_2, \\dots, h_{N-1}$, in that order. Given $h$, Farmer John wants to enlist your help to reconstruct the lexicographically minimum $p$ consistent with Farmer Nhoj's hints, or determine that Farmer Nhoj must have made a mistake.  Recall that if you are given two permutations $p$ and $p'$, $p$ is lexicographically smaller than $p'$ if $p_i < p'_i$ at the first position $i$ where the two differ.", "inputFormat": "Each input consists of $T$ independent test cases ($1\\le T\\le 10$). Each test case is described as follows:  \n\nThe first line contains $N$.  \n\nThe second line contains $N - 1$ integers $h_1, h_2, \\dots, h_{N-1}$ ($1\\le h_i\\le N$).", "outputFormat": "Output $T$ lines, one for each test case.  \n\nIf there is a permutation $p$ of $1\\dots N$ consistent with $h$, output the lexicographically smallest such $p$. If no such $p$ exists, output $-1$.", "hint": "For the fourth test case, if $p=[3,1,2,4]$ then FN will have written down $h=[2,1,1]$.  \n```text\np' = [3,1,2,4]\np_1' < p_n' -> h_1 = 2\np' = [3,1,2]\np_1' > p_n' -> h_2 = 1\np' = [1,2]\np_1' < p_n' -> h_3 = 1\np' = [1]\n```\n\n\nNote that the permutation $p=[4,2,1,3]$ would also produce the same $h$, but $[3,1,2,4]$ is lexiocgraphically smaller.  \n\nFor the second test case, there is no $p$ consistent with $h$; both $p=[1,2]$ and $p=[2,1]$ would produce $h=[1]$, not $h=[2]$.  \n\n\n#### SCORING:\n\n- Input 2: $N\\le 8$\n- Inputs 3-6: $N\\le 100$\n- Inputs 7-11: No additional constraints.", "locale": "en", "translations": {"en": {"title": "[USACO24OPEN] Farmer John's Favorite Permutation B", "background": "", "description": "Farmer John has a permutation $p$ of length $N$ ($2 \\leq N \\leq 10^5)$, containing each positive integer from $1$ to $N$ exactly once. However, Farmer Nhoj has broken into FJ's barn and disassembled $p$. To not be too cruel, FN has written some hints that will help FJ reconstruct $p$. While there is more than one element remaining in $p$, FN does the following:  \n\nLet the remaining elements of $p$ be $p'_1, p'_2, \\dots , p'_n$, \n-  If $p'_1 > p'_n$, he writes down $p'_2$ and removes $p'_1$ from the permutation.\n-  Otherwise, he writes down $p'_{n-1}$ and removes $p'_n$ from the permutation.  \n\nAt the end, Farmer Nhoj will have written down $N - 1$ integers $h_1, h_2, \\dots, h_{N-1}$, in that order. Given $h$, Farmer John wants to enlist your help to reconstruct the lexicographically minimum $p$ consistent with Farmer Nhoj's hints, or determine that Farmer Nhoj must have made a mistake.  Recall that if you are given two permutations $p$ and $p'$, $p$ is lexicographically smaller than $p'$ if $p_i < p'_i$ at the first position $i$ where the two differ.", "inputFormat": "Each input consists of $T$ independent test cases ($1\\le T\\le 10$). Each test case is described as follows:  \n\nThe first line contains $N$.  \n\nThe second line contains $N - 1$ integers $h_1, h_2, \\dots, h_{N-1}$ ($1\\le h_i\\le N$).", "outputFormat": "Output $T$ lines, one for each test case.  \n\nIf there is a permutation $p$ of $1\\dots N$ consistent with $h$, output the lexicographically smallest such $p$. If no such $p$ exists, output $-1$.", "hint": "For the fourth test case, if $p=[3,1,2,4]$ then FN will have written down $h=[2,1,1]$.  \n```text\np' = [3,1,2,4]\np_1' < p_n' -> h_1 = 2\np' = [3,1,2]\np_1' > p_n' -> h_2 = 1\np' = [1,2]\np_1' < p_n' -> h_3 = 1\np' = [1]\n```\n\n\nNote that the permutation $p=[4,2,1,3]$ would also produce the same $h$, but $[3,1,2,4]$ is lexiocgraphically smaller.  \n\nFor the second test case, there is no $p$ consistent with $h$; both $p=[1,2]$ and $p=[2,1]$ would produce $h=[1]$, not $h=[2]$.  \n\n\n#### SCORING:\n\n- Input 2: $N\\le 8$\n- Inputs 3-6: $N\\le 100$\n- Inputs 7-11: No additional constraints.", "locale": "en"}, "zh-CN": {"title": "[USACO24OPEN] Farmer John's Favorite Permutation B", "background": "", "description": "Farmer John 有一个长为 $N$（$2\\le N\\le 10^5$）的排列 $p$，包含从 $1$ 到 $N$ 的每个正整数恰好一次。然而，Farmer Nhoj 闯入了 FJ 的牛棚并拆散了 $p$。为了不至于太过残忍，FN 写了一些能够帮助 FJ 重建 $p$ 的提示。当 $p$ 中剩余多于一个元素时，FN 会执行以下操作：\n\n令 $p$ 的剩余元素为 $p_1^\\prime,p_2^\\prime,\\ldots,p_n^\\prime$，\n\n- 如果 $p_1^\\prime>p_n^\\prime$，他写下 $p_2^\\prime$ 并从排列中删除 $p_1^\\prime$。\n- 否则，他写下 $p_{n−1}^\\prime$ 并从排列中删除 $p_n^\\prime$。\n\n最终，Farmer Nhoj 将按顺序写下 $N−1$ 个整数 $h_1,h_2,\\ldots,h_{N−1}$。给定 $h$，Farmer John 希望得到你的帮助重建与 Farmer Nhoj 的提示相一致的最小字典序 $p$，或者判断 Farmer Nhoj 一定犯了错误。我们知道，给定两个排列 $p$ 和 $p^\\prime$，如果在第一个两者不同的位置 $i$ 处有 $p_i<p_i^\\prime$，则 $p$ 的字典序小于 $p^\\prime$。", "inputFormat": "每个测试点包含 $T$ 个独立的测试用例（$1\\le T\\le 10$）。每个测试用例的描述如下：\n\n第一行包含 $N$。\n\n第二行包含 $N−1$ 个整数 $h_1,h_2,\\ldots,h_{N−1}$（$1\\le h_i\\le N$）。", "outputFormat": "输出 $T$ 行，每个测试用例一行。\n\n如果存在与 $h$ 相一致的 $1\\ldots N$ 的排列 $p$，输出字典顺序最小的 $p$。如果不存在这样的 $p$，输出 $-1$。 ", "hint": "对于第四个测试用例，如果 $p=[3,1,2,4]$ 则 FN 将写下 $h=[2,1,1]$。\n\n```plain\np' = [3,1,2,4]\np_1' < p_n' -> h_1 = 2\np' = [3,1,2]\np_1' > p_n' -> h_2 = 1\np' = [1,2]\np_1' < p_n' -> h_3 = 1\np' = [1]\n```\n\n注意排列 $p=[4,2,1,3]$ 也会产生同样的 $h$，但 $[3,1,2,4]$ 字典序更小。\n\n对于第二个测试用例，不存在与 $h$ 相一致的 $p$；$p=[1,2]$ 和 $p=[2,1]$ 均会产生 $h=[1]$，并非 $h=[2]$。\n\n### 测试点性质\n\n- 测试点 $2$：$N\\le 8$。\n- 测试点 $3-6$：$N\\le 100$。\n- 测试点 $7-11$：没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P10277", "type": "P", "difficulty": 4, "samples": [["6 3\n3 1 4159 2 6 5", "8\n110"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["USACO", "堆", "2024", "图论建模"], "title": "[USACO24OPEN] Bessie's Interview S", "background": "", "description": "Bessie is looking for a new job! Fortunately, $K$ farmers are currently hiring and conducting interviews. Since jobs are highly competitive, the farmers have decided to number and interview cows in the order they applied. There are $N$ cows that applied before Bessie, so her number is $N+1$  ($1 \\leq K \\leq N \\leq 3 \\cdot 10^5$).  \n\nThe interview process will go as follows. At time $0$, farmer $i$ will start interviewing cow $i$ for each $1 \\leq i \\leq K$. Once a farmer finishes an interview, he will immediately begin interviewing the next cow in line. If multiple farmers finish at the same time, the next cow may choose to be interviewed by any of the available farmers, according to her preference.  \n\nFor each $1\\le i\\le N$, Bessie already knows that cow $i$'s interview will take exactly $t_i$ minutes ($1 \\leq t_i \\leq 10^9$). However, she doesn't know each cow's preference of farmers.  \n\nSince this job is very important to Bessie, she wants to carefully prepare for her interview. To do this, she needs to know when she will be interviewed and which farmers could potentially interview her. Help her find this information!", "inputFormat": "The first line of the input will contain two integers $N$ and $K$.  \n\nThe second line will contain $N$ integers $t_1 \\dots t_N$.", "outputFormat": "On the first line, print the time Bessie's interview will begin.  \n\nOn the second line, a bit string of length $K$, where the $i$-th bit is $1$ if farmer $i$ could interview Bessie and $0$ otherwise.", "hint": "There are $6$ cows aside from Bessie and $3$ farmers, and the interview process will go as follows:  \n\n\n1.  At time $t = 0$, farmer $1$ interviews cow $1$, farmer $2$ interviews cow $2$, and farmer $3$ interviews cow $3$.\n1.  At time $t = 1$, farmer $2$ finishes his interview with cow $2$ and starts interviewing cow $4$.\n1.  At time $t = 3$, both farmer $1$ and farmer $2$ finish their interviews, and there are two possibilities:   \n-  Farmer $1$ interviews cow $5$ and farmer $2$ interviews cow $6$. In this case, farmer $2$ would finish his interview at time $t = 8$ and start interviewing Bessie.\n-  Farmer $1$ interviews cow $6$ and farmer $2$ interviews cow $5$. In this case, farmer $1$ would finish his interview at time $t = 8$ and start interviewing Bessie.     \n\nThus, Bessie's interview will begin at time $t = 8$, and she could be interviewed by either farmer $1$ or farmer $2$.  \n\n\n#### SCORING:\n- Inputs 2-3: No two farmers finish at the same time.\n- Inputs 4-9: $N\\le 3\\cdot 10^3$.\n- Inputs 10-21: No additional constraints.", "locale": "en", "translations": {"en": {"title": "[USACO24OPEN] Bessie's Interview S", "background": "", "description": "Bessie is looking for a new job! Fortunately, $K$ farmers are currently hiring and conducting interviews. Since jobs are highly competitive, the farmers have decided to number and interview cows in the order they applied. There are $N$ cows that applied before Bessie, so her number is $N+1$  ($1 \\leq K \\leq N \\leq 3 \\cdot 10^5$).  \n\nThe interview process will go as follows. At time $0$, farmer $i$ will start interviewing cow $i$ for each $1 \\leq i \\leq K$. Once a farmer finishes an interview, he will immediately begin interviewing the next cow in line. If multiple farmers finish at the same time, the next cow may choose to be interviewed by any of the available farmers, according to her preference.  \n\nFor each $1\\le i\\le N$, Bessie already knows that cow $i$'s interview will take exactly $t_i$ minutes ($1 \\leq t_i \\leq 10^9$). However, she doesn't know each cow's preference of farmers.  \n\nSince this job is very important to Bessie, she wants to carefully prepare for her interview. To do this, she needs to know when she will be interviewed and which farmers could potentially interview her. Help her find this information!", "inputFormat": "The first line of the input will contain two integers $N$ and $K$.  \n\nThe second line will contain $N$ integers $t_1 \\dots t_N$.", "outputFormat": "On the first line, print the time Bessie's interview will begin.  \n\nOn the second line, a bit string of length $K$, where the $i$-th bit is $1$ if farmer $i$ could interview Bessie and $0$ otherwise.", "hint": "There are $6$ cows aside from Bessie and $3$ farmers, and the interview process will go as follows:  \n\n\n1.  At time $t = 0$, farmer $1$ interviews cow $1$, farmer $2$ interviews cow $2$, and farmer $3$ interviews cow $3$.\n1.  At time $t = 1$, farmer $2$ finishes his interview with cow $2$ and starts interviewing cow $4$.\n1.  At time $t = 3$, both farmer $1$ and farmer $2$ finish their interviews, and there are two possibilities:   \n-  Farmer $1$ interviews cow $5$ and farmer $2$ interviews cow $6$. In this case, farmer $2$ would finish his interview at time $t = 8$ and start interviewing Bessie.\n-  Farmer $1$ interviews cow $6$ and farmer $2$ interviews cow $5$. In this case, farmer $1$ would finish his interview at time $t = 8$ and start interviewing Bessie.     \n\nThus, Bessie's interview will begin at time $t = 8$, and she could be interviewed by either farmer $1$ or farmer $2$.  \n\n\n#### SCORING:\n- Inputs 2-3: No two farmers finish at the same time.\n- Inputs 4-9: $N\\le 3\\cdot 10^3$.\n- Inputs 10-21: No additional constraints.", "locale": "en"}, "zh-CN": {"title": "[USACO24OPEN] Bessie's Interview S", "background": "", "description": "Bessie 正在寻找新工作！幸运的是，$K$ 名农夫目前正在招聘并举行面试。由于工作竞争激烈，农夫们决定按申请的顺序对奶牛进行编号和面试。有 $N$ 头奶牛在 Bessie 之前申请，因此她的编号为 $N+1$（$1\\le K\\le N\\le 3\\cdot 10^5$）。\n\n面试过程如下。在时刻 $0$，对于每一个 $1\\le i\\le K$，农夫 $i$ 将开始面试奶牛 $i$。一旦一名农夫完成面试，他将立刻开始面试队列中的下一头奶牛。如果多名农夫同时完成，下一头奶牛可以根据自己的偏好选择接受任一此时空闲的农夫的面试。\n\n对于每一个 $1\\le i\\le N$，Bessie 已经知道奶牛 $i$ 的面试将恰好花费 $t_i$ 分钟（$1\\le t_i\\le 10^9$）。然而，她不知道每头奶牛对农夫的偏好。\n\n由于这份工作对 Bessie 来说非常重要，所以她想要认真准备面试。为此，她需要知道她会在何时接受面试，以及哪些农夫可能会面试她。帮助她求出这些信息！ ", "inputFormat": "输入的第一行包含两个整数 $N$ 和 $K$。\n\n第二行包含 $N$ 个整数 $t_1\\ldots t_N$。 ", "outputFormat": "输出的第一行包含 Bessie 的面试将开始的时刻。\n\n第二行包含一个长为 $K$ 的 `01` 字符串，其中如果农夫 $i$ 可能面试 Bessie 则第 $i$ 个字符为 `1`，否则为 `0`。 ", "hint": "### 样例解释 1\n\n除了 Bessie 之外有 $6$ 头奶牛，以及 $3$ 名农夫。面试过程将如下进行：\n\n1. 于时刻 $t=0$，农夫 $1$ 面试奶牛 $1$，农夫 $2$ 面试奶牛 $2$，农夫 $3$ 面试奶牛 $3$。\n2. 于时刻 $t=1$，农夫 $2$ 结束了对奶牛 $2$ 的面试并开始面试奶牛 $4$。\n3. 于时刻 $t=3$，农夫 $1$ 和农夫 $2$ 都完成了面试，从而有两种可能：\n    * 农夫 $1$ 面试奶牛 $5$，农夫 $2$ 面试奶牛 $6$。在这种情况下，农夫 $2$ 将于时刻 $t=8$ 完成面试并开始面试 Bessie。\n    * 农夫 $1$ 面试奶牛 $6$，农夫 $2$ 面试奶牛 $5$。在这种情况下，农夫 $1$ 将于时刻 $t=8$ 完成面试并开始面试 Bessie。\n\n从而，Bessie 的面试将于时刻 $t=8$ 开始，并且她可能会被农夫 $1$ 或农夫 $2$ 面试。\n\n### 测试点性质\n\n- 测试点 $2-3$：没有两名农夫同时完成面试。\n- 测试点 $4-9$：$N\\le 3\\cdot 10^3$。\n- 测试点 $10-21$：没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P10278", "type": "P", "difficulty": 5, "samples": [["5 4\n3 1\n1 5\n3 5\n1 1\n2 1 1 5\n1 5 3 4\n3 1 3 5\n2 1 2 1\n3 2 3 3", "1\n2\n2\n1"], ["2 8\n1 1\n1 2\n0 2\n0 3\n0 0\n0 1\n2 3\n2 0\n1 1 2 1\n1 0 1 3", "1\n0\n0\n0\n1\n1\n1\n2"], ["1 12\n0 0\n2 0\n2 1\n1 1\n1 2\n3 2\n3 3\n1 3\n1 4\n2 4\n2 5\n0 5\n2 2 0 2", "1\n1\n1\n1\n1\n0\n0\n0\n0\n0\n0\n0"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["USACO", "2024", "图论建模", "差分"], "title": "[USACO24OPEN] Painting Fence Posts S", "background": "", "description": "****Note: The time limit and memory limit for this problem are 3s and 512MB, which are 1.5x and 2x the normal amount, respectively.****  \n\nFarmer John's $N$ cows ($1 \\leq N \\leq 10^5$) each like to take a daily walk around the fence enclosing his pasture.  Unfortunately, whenever a cow walks past a fence post, she brushes up against it, requiring Farmer John to need to repaint the fence posts regularly.  \n\nThe fence consists of $P$ posts ($4 \\leq P \\leq 2\\cdot 10^5$, $P$ even), the location of each being a different 2D point $(x,y)$ on a map of FJ's farm ($0 \\leq x, y \\leq 10^9$).  Each post is connected to the two adjacent posts by fences that are either vertical  or horizontal line segments, so the entire fence can be considered a polygon whose sides are parallel to the x or y axes (the last post connects back to the first post, ensuring the fence forms a closed loop that encloses the pasture).  The fence polygon is \"well-behaved\" in that fence segments only potentially overlap at their endpoints, each post aligns with exactly  two fence segment endpoints, and every two fence segments that meet at an endpoint are perpendicular.   \n\nEach cow has a preferred starting and ending position for her daily walk, each being points somewhere along the fence (possibly at posts, possibly not).  Each cow walks along the fence for her daily walks, starting from her starting position and ending at her ending position.  There are two routes that the cow could take, given that the fence forms a closed loop.  Since cows are somewhat lazy creatures, each cow will walk in the direction around the fence that is shorter. Remarkably, this choice is always clear -- there are no ties!  \n\nA cow touches a fence post if she walks past it, or if the fence post is the starting or ending point of her walk.  Please help FJ calculate the number of daily touches experienced by each fence post, so he knows which post to repaint next.  \n\nIt can be shown that there is exactly one possibility for the fences given the locations of all of the posts.", "inputFormat": "The first line of input contains $N$ and $P$. Each of the next $P$ lines contains two integers representing the positions of the fence posts in no particular order. Each of the next $N$ lines contains four integers $x_1$ $y_1$ $x_2$ $y_2$ representing the starting position $(x_1, y_1)$ and ending position $(x_2, y_2)$ of a cow.", "outputFormat": "Write $P$ integers as output, giving the number of touches experienced by each fence post.", "hint": "##### For Sample 1:\nThe following posts are connected by fence segments:  \n\n$$(3,1)\\leftrightarrow (3, 5) \\leftrightarrow  (1,5) \\leftrightarrow (1,1) \\leftrightarrow (3,1)$$  \n\nThe posts touched by each cow are as follows:  \n\n1. Posts $2$ and $4$.\n1. Posts $2$ and $3$.\n1. Posts $1$ and $3$.\n1. No posts.\n1. No posts.  \n\n#### SCORING:\n- Inputs 4-6: $N,P\\le 1000$\n- Inputs 7-9: All locations satisfy $0\\le x, y\\le 1000$.\n- Inputs 10-15: No additional constraints.", "locale": "en", "translations": {"en": {"title": "[USACO24OPEN] Painting Fence Posts S", "background": "", "description": "****Note: The time limit and memory limit for this problem are 3s and 512MB, which are 1.5x and 2x the normal amount, respectively.****  \n\nFarmer John's $N$ cows ($1 \\leq N \\leq 10^5$) each like to take a daily walk around the fence enclosing his pasture.  Unfortunately, whenever a cow walks past a fence post, she brushes up against it, requiring Farmer John to need to repaint the fence posts regularly.  \n\nThe fence consists of $P$ posts ($4 \\leq P \\leq 2\\cdot 10^5$, $P$ even), the location of each being a different 2D point $(x,y)$ on a map of FJ's farm ($0 \\leq x, y \\leq 10^9$).  Each post is connected to the two adjacent posts by fences that are either vertical  or horizontal line segments, so the entire fence can be considered a polygon whose sides are parallel to the x or y axes (the last post connects back to the first post, ensuring the fence forms a closed loop that encloses the pasture).  The fence polygon is \"well-behaved\" in that fence segments only potentially overlap at their endpoints, each post aligns with exactly  two fence segment endpoints, and every two fence segments that meet at an endpoint are perpendicular.   \n\nEach cow has a preferred starting and ending position for her daily walk, each being points somewhere along the fence (possibly at posts, possibly not).  Each cow walks along the fence for her daily walks, starting from her starting position and ending at her ending position.  There are two routes that the cow could take, given that the fence forms a closed loop.  Since cows are somewhat lazy creatures, each cow will walk in the direction around the fence that is shorter. Remarkably, this choice is always clear -- there are no ties!  \n\nA cow touches a fence post if she walks past it, or if the fence post is the starting or ending point of her walk.  Please help FJ calculate the number of daily touches experienced by each fence post, so he knows which post to repaint next.  \n\nIt can be shown that there is exactly one possibility for the fences given the locations of all of the posts.", "inputFormat": "The first line of input contains $N$ and $P$. Each of the next $P$ lines contains two integers representing the positions of the fence posts in no particular order. Each of the next $N$ lines contains four integers $x_1$ $y_1$ $x_2$ $y_2$ representing the starting position $(x_1, y_1)$ and ending position $(x_2, y_2)$ of a cow.", "outputFormat": "Write $P$ integers as output, giving the number of touches experienced by each fence post.", "hint": "##### For Sample 1:\nThe following posts are connected by fence segments:  \n\n$$(3,1)\\leftrightarrow (3, 5) \\leftrightarrow  (1,5) \\leftrightarrow (1,1) \\leftrightarrow (3,1)$$  \n\nThe posts touched by each cow are as follows:  \n\n1. Posts $2$ and $4$.\n1. Posts $2$ and $3$.\n1. Posts $1$ and $3$.\n1. No posts.\n1. No posts.  \n\n#### SCORING:\n- Inputs 4-6: $N,P\\le 1000$\n- Inputs 7-9: All locations satisfy $0\\le x, y\\le 1000$.\n- Inputs 10-15: No additional constraints.", "locale": "en"}, "zh-CN": {"title": "[USACO24OPEN] Painting Fence Posts S", "background": "**注意：本题的时间限制和内存限制为 3 秒 和 512MB，分别为通常限制的 1.5 倍和 2 倍。**", "description": "Farmer John 的 $N$ 头奶牛（$1\\le N\\le 10^5$）每头都喜欢日常沿围着牧场的栅栏散步。不幸的是，每当一头奶牛走过栅栏柱子时，她就会碰到它，这要求 Farmer John 需要定期重新粉刷栅栏柱子。\n\n栅栏由 $P$ 根柱子组成（$4\\le P\\le 2\\cdot 10^5$，$P$ 为偶数），每根柱子的位置是 FJ 农场地图上的一个不同的二维坐标点 $(x,y)$（$0\\le x,y\\le 10^9$）。每根柱子通过垂直或水平线段的栅栏连接到两根相邻的柱子，因此整个栅栏可以被视为各边平行于 $x$ 轴或 $y$ 轴的一个多边形（最后一根柱子连回第一根柱子，确保围栏形成一个包围牧场的闭环）。栅栏多边形是「规则的」，体现在栅栏段仅可能在其端点处重合，每根柱子恰好属于两个栅栏段，同时每两个在端点处相交的栅栏段都是垂直的。\n\n每头奶牛的日常散步都有一个偏好的起始和结束位置，均为沿栅栏的某个点（可能在柱子处，也可能不在）。每头奶牛日常散步时沿着栅栏行走，从起始位置开始，到结束位置结束。由于栅栏形成闭环，奶牛有两条路线可以选择。由于奶牛是一种有点懒的生物，每头奶牛都会选择距离较短的方向沿栅栏行走。值得注意的是，这个选择总是明确的——不存在并列的情况！\n\n一头奶牛会触碰一根栅栏柱子，当她走过这根柱子，或者当这根栅栏柱子是她散步的起点或终点时。请帮助 FJ 计算每个栅栏柱子每天所经历的触碰次数，以便他知道接下来要重新粉刷哪根柱子。\n\n可以证明，给定所有柱子的位置，组成的栅栏仅有唯一的可能性。", "inputFormat": "输入的第一行包含 $N$ 和 $P$。以下 $P$ 行的每一行包含两个整数，表示栅栏柱子的位置，没有特定的顺序。以下 $N$ 行的每一行包含四个整数 $x_1\\ y_1\\ x_2\\ y_2$，表示一头奶牛的起始位置 $(x_1,y_1)$ 和结束位置 $(x_2,y_2)$。", "outputFormat": "输出 $P$ 个整数，包含每个栅栏柱子所经历的触碰次数。", "hint": "### 样例解释 1\n\n柱子以如下方式由栅栏段连接：\n\n$$\n(3,1)\\leftrightarrow(3,5)\\leftrightarrow(1,5)\\leftrightarrow(1,1)\\leftrightarrow(3,1)\n$$\n\n各奶牛接触的柱子如下：\n\n1. 柱子 $2$ 和 $4$。\n2. 柱子 $2$ 和 $3$。\n3. 柱子 $1$ 和 $3$。\n4. 无。\n5. 无。\n\n### 测试点性质\n\n- 测试点 $4-6$：$N,P\\le 1000$。\n- 测试点 $7-9$：所有位置均有 $0\\le x,y\\le 1000$。\n- 测试点 $10-15$：没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P10279", "type": "P", "difficulty": 5, "samples": [["8\nAGTCAACG", "11\n10\n5\n4\n2\n2\n1\n1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["USACO", "2024", "哈希 hashing", "单调栈"], "title": "[USACO24OPEN] The 'Winning' Gene S", "background": "", "description": "****Note: The memory limit for this problem is 512MB, twice the default.****  \n\nAfter years of hosting games and watching Bessie get first place over and over, Farmer John has realized that this can't be accidental. Instead, he concludes that Bessie must have winning coded into her DNA so he sets out to find this \"winning\" gene.  \n\nHe devises a process to identify possible candidates for this \"winning\" gene. He takes Bessie's genome, which is a string $S$ of length $N$ where $1 \\leq N \\leq 3000$. He picks some pair $(K,L)$ where $1 \\leq L \\leq K \\leq N$ representing that the \"winning\" gene candidates will have length $L$ and will be found within a larger $K$ length substring. To identify the gene, he takes all $K$ length substrings from $S$ which we will call a $k$-mer. For a given $k$-mer, he takes all length $L$ substrings, identifies the lexicographically minimal substring as a winning gene candidate (choosing the leftmost such substring if there is a tie),  and then writes down the $0$-indexed position $p_i$ where that substring starts in $S$ to a set $P$.   \n\nSince he hasn't picked $K$ and $L$ yet, he wants to know how many candidates there will be for every pair of $(K,L)$.  \n\nFor each $v$ in $1\\dots N$, help him determine the number of $(K,L)$ pairs with $|P|=v$.", "inputFormat": "$N$ representing the length of the string. $S$ representing the given string. All characters are guaranteed to be uppercase characters where $s_i \\in A-Z$ since bovine genetics are far more advanced than ours.", "outputFormat": "For each $v$ in $1\\dots N$, output the number of $(K,L)$ pairs with $|P|=v$, with each number on a separate line.", "hint": "In this test case, the third line of the output is 5 because we see that there are exactly 5 pairs of $K$ and $L$ that allow for three \"winning\" gene candidates.  These candidates are (where $p_i$ is $0$-indexed):  \n```text\n(4,2) -> P = [0,3,4]\n(5,3) -> P = [0,3,4]\n(6,4) -> P = [0,3,4]\n(6,5) -> P = [0,1,3]\n(6,6) -> P = [0,1,2]\n```\nTo see how (4,2) leads to these results, we take all $4$-mers \n```text\nAGTC\nGTCA\nTCAA\nCAAC\nAACG\n```\nFor each $4$-mer, we identify the lexicographically minimal length 2 substring \n```text\nAGTC -> AG\nGTCA -> CA\nTCAA -> AA\nCAAC -> AA\nAACG -> AA\n```\nWe take the positions of all these substrings in the original string and add them to a set $P$ to get $P = [0,3,4]$.  \n\nOn the other hand, if we focus on the pair $(4,1)$, we see that this only leads to $2$ total \"winning\" gene candidates. If we take all $4$-mers and identify the lexicographically minimum length $1$ substring (using A and A' and A* to distinguish the different As), we get \n```text\nAGTC -> A\nGTCA' -> A'\nTCA'A* -> A'\nCA'A*C -> A'\nA'A*CG -> A'\n```\nWhile both A' and A* are lexicographically minimal in the last 3 cases, the leftmost substring takes precedence so A' is counted as the only candidate in all of these cases. This means that $P = [0,4]$.  \n\n\n#### SCORING:\n\n- Inputs 2-4: $N \\leq 100$ \n- Inputs 5-7: $N \\leq 500$ \n- Inputs 8-16: No additional constraints.", "locale": "en", "translations": {"en": {"title": "[USACO24OPEN] The 'Winning' Gene S", "background": "", "description": "****Note: The memory limit for this problem is 512MB, twice the default.****  \n\nAfter years of hosting games and watching Bessie get first place over and over, Farmer John has realized that this can't be accidental. Instead, he concludes that Bessie must have winning coded into her DNA so he sets out to find this \"winning\" gene.  \n\nHe devises a process to identify possible candidates for this \"winning\" gene. He takes Bessie's genome, which is a string $S$ of length $N$ where $1 \\leq N \\leq 3000$. He picks some pair $(K,L)$ where $1 \\leq L \\leq K \\leq N$ representing that the \"winning\" gene candidates will have length $L$ and will be found within a larger $K$ length substring. To identify the gene, he takes all $K$ length substrings from $S$ which we will call a $k$-mer. For a given $k$-mer, he takes all length $L$ substrings, identifies the lexicographically minimal substring as a winning gene candidate (choosing the leftmost such substring if there is a tie),  and then writes down the $0$-indexed position $p_i$ where that substring starts in $S$ to a set $P$.   \n\nSince he hasn't picked $K$ and $L$ yet, he wants to know how many candidates there will be for every pair of $(K,L)$.  \n\nFor each $v$ in $1\\dots N$, help him determine the number of $(K,L)$ pairs with $|P|=v$.", "inputFormat": "$N$ representing the length of the string. $S$ representing the given string. All characters are guaranteed to be uppercase characters where $s_i \\in A-Z$ since bovine genetics are far more advanced than ours.", "outputFormat": "For each $v$ in $1\\dots N$, output the number of $(K,L)$ pairs with $|P|=v$, with each number on a separate line.", "hint": "In this test case, the third line of the output is 5 because we see that there are exactly 5 pairs of $K$ and $L$ that allow for three \"winning\" gene candidates.  These candidates are (where $p_i$ is $0$-indexed):  \n```text\n(4,2) -> P = [0,3,4]\n(5,3) -> P = [0,3,4]\n(6,4) -> P = [0,3,4]\n(6,5) -> P = [0,1,3]\n(6,6) -> P = [0,1,2]\n```\nTo see how (4,2) leads to these results, we take all $4$-mers \n```text\nAGTC\nGTCA\nTCAA\nCAAC\nAACG\n```\nFor each $4$-mer, we identify the lexicographically minimal length 2 substring \n```text\nAGTC -> AG\nGTCA -> CA\nTCAA -> AA\nCAAC -> AA\nAACG -> AA\n```\nWe take the positions of all these substrings in the original string and add them to a set $P$ to get $P = [0,3,4]$.  \n\nOn the other hand, if we focus on the pair $(4,1)$, we see that this only leads to $2$ total \"winning\" gene candidates. If we take all $4$-mers and identify the lexicographically minimum length $1$ substring (using A and A' and A* to distinguish the different As), we get \n```text\nAGTC -> A\nGTCA' -> A'\nTCA'A* -> A'\nCA'A*C -> A'\nA'A*CG -> A'\n```\nWhile both A' and A* are lexicographically minimal in the last 3 cases, the leftmost substring takes precedence so A' is counted as the only candidate in all of these cases. This means that $P = [0,4]$.  \n\n\n#### SCORING:\n\n- Inputs 2-4: $N \\leq 100$ \n- Inputs 5-7: $N \\leq 500$ \n- Inputs 8-16: No additional constraints.", "locale": "en"}, "zh-CN": {"title": "[USACO24OPEN] The 'Winning' Gene S", "background": "**注意：本题的内存限制为 512MB，通常限制的 2 倍。**", "description": "在多年举办比赛并看着 Bessie 一次又一次地获得第一名后，Farmer John 意识到这绝非偶然。他得出结论，Bessie 一定将胜利写进了 DNA，于是他开始寻找这种「胜利」基因。\n\n他设计了一个过程来识别这个「胜利」基因的可能候选。他获取了 Bessie 的基因组，为一个长为 $N$ 的字符串 $S$，其中 $1\\le N\\le 3000$。他选择某个数对 $(K,L)$，其中 $1\\le L\\le K\\le N$，表示「胜利」基因候选的长度将为 $L$，并且将在一个较大的 $K$ 长度子串中进行寻找。为了识别这一基因，他从 $S$ 中取出所有 $K$ 长度的子串，我们将称这样的子串为一个 $K$-mer。对于一个给定的 $K$-mer，他取出其所有长度为 $L$ 的子串，将字典序最小的子串识别为胜利基因候选（如果存在并列则选择其中最左边的子串），然后将该字串在 $S$ 中的起始位置 $p_i$（从 $0$ 开始索引）写入一个集合 $P$。\n\n由于他还没有选定 $K$ 和 $L$，他想知道每对 $(K,L)$ 将有多少个候选。\n\n对于 $1\\ldots N$ 中的每一个 $v$，帮助他求出满足 $|P|=v$ 的 $(K,L)$ 对的数量。 ", "inputFormat": "输入的第一行包含 $N$，为字符串的长度。第二行包含 $S$，为给定的字符串。输入保证所有字符均为大写字符，其中 $s_i\\in \\texttt A-\\texttt Z$，因为奶牛遗传学远比我们的高级。", "outputFormat": "对于 $1\\ldots N$ 中的每一个 $v$，输出满足 $|P|=v$ 的 $(K,L)$ 对的数量，每行输出一个数。\n", "hint": "### 样例解释 1\n\n在这个测试用例中，输出的第三行为 $5$ 是因为我们发现恰好有 $5$ 对 $K$ 和 $L$ 存在三个「胜利」基因候选。这些候选为（其中 $p_i$ 从 $0$ 开始索引）：\n\n```plain\n(4,2) -> P = [0,3,4]\n(5,3) -> P = [0,3,4]\n(6,4) -> P = [0,3,4]\n(6,5) -> P = [0,1,3]\n(6,6) -> P = [0,1,2]\n```\n\n为了了解 $(4,2)$ 如何得到这些结果，我们取出所有的 $4$-mer\n\n```plain\nAGTC\nGTCA\nTCAA\nCAAC\nAACG\n```\n\n对于每一个 $4$-mer，我们识别出字典序最小的长度为 $2$ 的子串\n\n```plain\nAGTC -> AG\nGTCA -> CA\nTCAA -> AA\nCAAC -> AA\nAACG -> AA\n```\n\n我们取出所有这些子串在原字符串中的位置并将它们添加到集合 $P$ 中，得到 $P=[0,3,4]$。\n\n另一方面，如果我们关注 $(4,1)$ 对，我们会发现这只会得到总共 $2$ 个「胜利」基因候选。如果我们取出所有的 $4$-mer 并识别字典序最小的长度为 $1$ 的子串（用 A，A' 和 A* 来区分不同的 A），我们得到\n\n```plain\nAGTC -> A\nGTCA' -> A'\nTCA'A* -> A'\nCA'A*C -> A'\nA'A*CG -> A'\n```\n\n尽管 A' 和 A* 在最后 3 种情况下字典序均为最小，但最左边的子串优先，因此仅有 A' 在所有这些情况中被视为候选。这意味着 $P=[0,4]$。\n\n### 测试点性质\n\n- 测试点 $2-4$：$N\\le 100$。\n- 测试点 $5-7$：$N\\le 500$。\n- 测试点 $8-16$：没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P10280", "type": "P", "difficulty": 5, "samples": [["4 1\n0111\n1110", "3"], ["5 2\n11000\n00011", "3"], ["5 4\n11000\n00011", "2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "贪心", "USACO", "2024"], "title": "[USACO24OPEN] Cowreography G", "background": "", "description": "The cows have formed a dance team, and Farmer John is their choreographer! The team's latest and greatest dance involves $N$ cows ($2 \\le N \\le 10^6$) standing in a line. Each move in the dance involves two cows, up to $K$ positions apart ($1 \\le K < N$), gracefully jumping and landing in each other's position.  \n\nThere are two types of cows in the line – Guernseys and Holsteins. As such, Farmer John has documented the dance as a sequence of **length-$N$ binary strings**, where a $0$ represents a Guernsey, a $1$ represents a Holstein, and the overall string represents how the cows are arranged in the line.  \n\nUnfortunately, Farmer Nhoj (who choreographs for a rival team) has sabotaged the dance and erased all but the first and last binary strings! With a big competition quickly approaching, Farmer John must waste no time in reconstructing the dance.  \n\nGiven these two binary strings, help Farmer John find the minimum number of moves in the dance!", "inputFormat": "The first line contains $N$ and $K$.  \n\nThe second line contains the first binary string.  \n\nThe third line contains the last binary string.  \n\nIt is guaranteed that both binary strings contain the same number of ones.", "outputFormat": "The minimum number of moves in the dance.", "hint": "##### For Sample 1:\nOne possible dance:  \n```text\n0111 -> 1011 -> 1101 -> 1110\n```\n##### For Sample 2:\nOne possible dance:  \n```text\n11000 -> 01100 -> 00110 -> 00011\n```\n##### For Sample 3:\nOne possible dance:  \n```text\n11000 -> 10010 -> 00011\n```\n\n#### SCORING:\n- Inputs 4-5: $K=1$.\n- Inputs 6-7: Both strings have at most $8$ ones.\n- Inputs 8-15: $N\\le 5000$.\n- Inputs 16-23: No additional constraints.", "locale": "en", "translations": {"en": {"title": "[USACO24OPEN] Cowreography G", "background": "", "description": "The cows have formed a dance team, and Farmer John is their choreographer! The team's latest and greatest dance involves $N$ cows ($2 \\le N \\le 10^6$) standing in a line. Each move in the dance involves two cows, up to $K$ positions apart ($1 \\le K < N$), gracefully jumping and landing in each other's position.  \n\nThere are two types of cows in the line – Guernseys and Holsteins. As such, Farmer John has documented the dance as a sequence of **length-$N$ binary strings**, where a $0$ represents a Guernsey, a $1$ represents a Holstein, and the overall string represents how the cows are arranged in the line.  \n\nUnfortunately, Farmer Nhoj (who choreographs for a rival team) has sabotaged the dance and erased all but the first and last binary strings! With a big competition quickly approaching, Farmer John must waste no time in reconstructing the dance.  \n\nGiven these two binary strings, help Farmer John find the minimum number of moves in the dance!", "inputFormat": "The first line contains $N$ and $K$.  \n\nThe second line contains the first binary string.  \n\nThe third line contains the last binary string.  \n\nIt is guaranteed that both binary strings contain the same number of ones.", "outputFormat": "The minimum number of moves in the dance.", "hint": "##### For Sample 1:\nOne possible dance:  \n```text\n0111 -> 1011 -> 1101 -> 1110\n```\n##### For Sample 2:\nOne possible dance:  \n```text\n11000 -> 01100 -> 00110 -> 00011\n```\n##### For Sample 3:\nOne possible dance:  \n```text\n11000 -> 10010 -> 00011\n```\n\n#### SCORING:\n- Inputs 4-5: $K=1$.\n- Inputs 6-7: Both strings have at most $8$ ones.\n- Inputs 8-15: $N\\le 5000$.\n- Inputs 16-23: No additional constraints.", "locale": "en"}, "zh-CN": {"title": "[USACO24OPEN] Cowreography G", "background": "", "description": "奶牛们组了一支舞蹈队，Farmer John 是她们的编舞！舞蹈队最新而最精彩的舞蹈有 $N$ 头奶牛（$2\\le N\\le 10^6$）排成一行。舞蹈中的每次动作都涉及两头奶牛，至多相距 $K$ 个位置（$1\\le K < N$），优雅地跳起并降落在对方的位置上。\n\n队伍中有两种奶牛——更赛牛（Guernsey）和荷斯坦牛（Holstein）。因此，Farmer John 将这一舞蹈记录为一系列**长为 $N$ 的 `01` 字符串**，其中 `0` 代表更赛牛，`1` 代表荷斯坦牛，整个字符串表示奶牛在这一行中是如何排列的。\n\n不幸的是，Farmer Nhoj（对手团队的编舞）蓄意破坏了这一舞蹈，并清除了除第一个和最后一个 `01` 字符串之外的所有内容！由于一场大型比赛即将开始，Farmer John 必须抓紧每一秒重建这一舞蹈。\n\n给定这两个 `01` 字符串，帮助 Farmer John 求出舞蹈中的最小动作数量！ ", "inputFormat": "输入的第一行包含 $N$ 和 $K$。\n\n第二行包含第一个 `01` 字符串。\n\n第三行包含最后一个 `01` 字符串。\n\n输入保证两个 `01` 字符串包含相同数量的 `1`。 ", "outputFormat": "输出舞蹈中的最小动作数量。", "hint": "### 样例解释 1\n\n一个可能的舞蹈：\n\n```plain\n0111 -> 1011 -> 1101 -> 1110\n```\n### 样例解释 2\n\n一个可能的舞蹈：\n\n```plain\n11000 -> 01100 -> 00110 -> 00011\n```\n\n### 样例解释 3\n\n一个可能的舞蹈：\n\n```plain\n11000 -> 10010 -> 00011\n```\n\n### 测试点性质\n\n- 测试点 $4-5$：$K=1$。\n- 测试点 $6-7$：两个字符串各至多包含 $8$ 个 $1$。\n- 测试点 $8-15$：$N\\le 5000$。\n- 测试点 $16-23$：没有额外限制。\n", "locale": "zh-CN"}}}
{"pid": "P10281", "type": "P", "difficulty": 6, "samples": [["2\n3 6 3\n4 7 2", "0\n1"], ["4\n3 6 1\n2 5 1\n4 10 1\n1 4 1", "3\n3\n2\n2"], ["5\n8 10 2\n4 9 2\n3 7 4\n5 7 1\n2 7 1", "0\n3\n1\n3\n3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["USACO", "2024", "cdq 分治"], "title": "[USACO24OPEN] Grass Segments G", "background": "", "description": "Bessie is planting some grass on the positive real line. She has $N$ ($2\\le N\\le 2\\cdot 10^5$) different cultivars of grass,  and will plant the $i$th cultivar on the interval $[\\ell_i, r_i]$ ($0 < \\ell_i < r_i \\leq 10^9$).  \n\nIn addition, cultivar $i$ grows better when there is some cultivar $j$ ($j\\neq i$) such that  cultivar $j$ and cultivar $i$ overlap with length at least $k_i$ ($0 < k_i \\leq r_i - \\ell_i$). Bessie wants to evaluate all of her cultivars.  For each $i$, compute the number of $j\\neq i$ such that $j$ and $i$ overlap with length at least $k_i$.", "inputFormat": "The first line contains $N$.  \n\nThe next $N$ lines each contain three space-separated integers $\\ell_i$, $r_i$, and $k_i$.", "outputFormat": "The answers for all cultivars on separate lines.", "hint": "##### For Sample 1:\nThe overlaps of the cultivars is $[4,6]$, which has length $2$, which is at least $2$ but not at least $3$.  \n\n#### SCORING:\n- Input 4-5: $N \\leq 5000$.\n- Inputs 6-11: $k$ is the same for all intervals.\n- Inputs 12-20: No additional constraints.  \n\nIn addition, for Inputs 5, 7, ..., 19, $r_i \\leq 2N$ for all $i$.", "locale": "en", "translations": {"en": {"title": "[USACO24OPEN] Grass Segments G", "background": "", "description": "Bessie is planting some grass on the positive real line. She has $N$ ($2\\le N\\le 2\\cdot 10^5$) different cultivars of grass,  and will plant the $i$th cultivar on the interval $[\\ell_i, r_i]$ ($0 < \\ell_i < r_i \\leq 10^9$).  \n\nIn addition, cultivar $i$ grows better when there is some cultivar $j$ ($j\\neq i$) such that  cultivar $j$ and cultivar $i$ overlap with length at least $k_i$ ($0 < k_i \\leq r_i - \\ell_i$). Bessie wants to evaluate all of her cultivars.  For each $i$, compute the number of $j\\neq i$ such that $j$ and $i$ overlap with length at least $k_i$.", "inputFormat": "The first line contains $N$.  \n\nThe next $N$ lines each contain three space-separated integers $\\ell_i$, $r_i$, and $k_i$.", "outputFormat": "The answers for all cultivars on separate lines.", "hint": "##### For Sample 1:\nThe overlaps of the cultivars is $[4,6]$, which has length $2$, which is at least $2$ but not at least $3$.  \n\n#### SCORING:\n- Input 4-5: $N \\leq 5000$.\n- Inputs 6-11: $k$ is the same for all intervals.\n- Inputs 12-20: No additional constraints.  \n\nIn addition, for Inputs 5, 7, ..., 19, $r_i \\leq 2N$ for all $i$.", "locale": "en"}, "zh-CN": {"title": "[USACO24OPEN] Grass Segments G", "background": "", "description": "Bessie 正在数轴的正半轴上种一些草。她有 $N$（$2\\le N\\le 2\\cdot 10^5$）个不同的栽培品种，并将把第 $i$ 个品种种植在区间 $[l_i,r_i]$（$0<l_i<r_i\\le 10^9$）内。\n\n此外，品种 $i$ 会在存在某个品种 $j$（$j\\neq i$）使得品种 $j$ 与品种 $i$ 重叠至少 $k_i$（$0<k_i\\le r_i-l_i$）长度时生长得更好。Bessie 想要评估她所有的品种。对于每一个 $i$，计算 $j\\neq i$ 的数量，使得 $j$ 与 $i$ 重叠至少 $k_i$ 长度。 ", "inputFormat": "输入的第一行包含 $N$。\n\n以下 $N$ 行每行包含三个空格分隔的整数 $l_i$，$r_i$ 和 $k_i$。 ", "outputFormat": "输出所有品种的答案，每种一行。", "hint": "### 样例解释 1\n\n两品种的重叠部分为 $[4,6]$，长度为 $2$，不小于 $2$ 但并非不小于 $3$。\n\n### 测试点性质\n\n- 测试点 $4-5$：$N\\le 5000$。\n- 测试点 $6-11$：$k$ 对于所有的区间均相同。\n- 测试点 $12-20$：没有额外限制。\n\n此外，对于测试点 $5$，$7$，……，$19$，对于所有 $i$ 有 $r_i\\le 2N$。 ", "locale": "zh-CN"}}}
{"pid": "P10282", "type": "P", "difficulty": 5, "samples": [["2\n1 2\n2 2", "2"], ["3\n1 3 2\n2 2 2", "3"], ["5\n2 5 1 3 2\n2 1 5 2 2", "1"], ["7\n3 5 2 3 4 4 1\n5 3 5 3 3 4 1", "140"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "USACO", "2024", "前缀和", "双指针 two-pointer"], "title": "[USACO24OPEN] Smaller Averages G", "background": "", "description": "Bessie has two arrays of length $N$ ($1 \\le N \\le 500$). The $i$-th element of the first array is $a_i$ ($1 \\le a_i \\le 10^6$) and the $i$-th element of the second array is $b_i$ ($1 \\le b_i \\le 10^6$).   \n\nBessie wants to split both arrays into **non-empty** subarrays such that the following is true. \n1. Every element belongs in exactly 1 subarray. \n2. Both arrays are split into the same number of subarrays. Let the number of subarrays the first and second array are split into be $k$ (i.e. the first array is split into exactly $k$ subarrays and the second array is split into exactly $k$ subarrays). \n3. For all $1 \\le i \\le k$, the average of the $i$-th subarray on the left of the first array is **less than or equal to** the average of the $i$-th subarray on the left of the second array.   \n\nCount how many ways she can split both arrays into non-empty subarrays while satisfying the constraints modulo $10^9+7$. Two ways are considered different if the number of subarrays are different or if some element belongs in a different subarray.", "inputFormat": "The first line contains $N$.  \n\nThe next line contains $a_1,a_2,...,a_N$.  \n\nThe next line contains $b_1,b_2,...,b_N$.", "outputFormat": "Output the number of ways she can split both arrays into non-empty subarrays while satisfying the constraints modulo $10^9+7$.", "hint": "##### For Sample 1:\nThe two valid ways are: \n1. Split the first array into $[1],[2]$ and the second array into $[2],[2]$.\n2. Split the first array into $[1,2]$ and the second array into $[2,2]$.\n\n##### For Sample 2:\nThe three valid ways are: \n1. Split the first array into $[1,3],[2]$ and the second array into $[2,2],[2]$.\n2. Split the first array into $[1,3],[2]$ and the second array into $[2],[2,2]$.\n3. Split the first array into $[1,3,2]$ and the second array into $[2,2,2]$.  \n\n\n##### For Sample 3:\nThe only valid way is to split the first array into $[2],[5,1,3],[2]$ and the  second array into $[2],[1,5],[2,2]$.  \n\n#### SCORING:\n- Inputs 5-6: $N \\le 10$\n- Inputs 7-9: $N \\le 80$ \n- Inputs 10-17: $N \\le 300$ \n- Inputs 18-20: $N \\le 500$", "locale": "en", "translations": {"en": {"title": "[USACO24OPEN] Smaller Averages G", "background": "", "description": "Bessie has two arrays of length $N$ ($1 \\le N \\le 500$). The $i$-th element of the first array is $a_i$ ($1 \\le a_i \\le 10^6$) and the $i$-th element of the second array is $b_i$ ($1 \\le b_i \\le 10^6$).   \n\nBessie wants to split both arrays into **non-empty** subarrays such that the following is true. \n1. Every element belongs in exactly 1 subarray. \n2. Both arrays are split into the same number of subarrays. Let the number of subarrays the first and second array are split into be $k$ (i.e. the first array is split into exactly $k$ subarrays and the second array is split into exactly $k$ subarrays). \n3. For all $1 \\le i \\le k$, the average of the $i$-th subarray on the left of the first array is **less than or equal to** the average of the $i$-th subarray on the left of the second array.   \n\nCount how many ways she can split both arrays into non-empty subarrays while satisfying the constraints modulo $10^9+7$. Two ways are considered different if the number of subarrays are different or if some element belongs in a different subarray.", "inputFormat": "The first line contains $N$.  \n\nThe next line contains $a_1,a_2,...,a_N$.  \n\nThe next line contains $b_1,b_2,...,b_N$.", "outputFormat": "Output the number of ways she can split both arrays into non-empty subarrays while satisfying the constraints modulo $10^9+7$.", "hint": "##### For Sample 1:\nThe two valid ways are: \n1. Split the first array into $[1],[2]$ and the second array into $[2],[2]$.\n2. Split the first array into $[1,2]$ and the second array into $[2,2]$.\n\n##### For Sample 2:\nThe three valid ways are: \n1. Split the first array into $[1,3],[2]$ and the second array into $[2,2],[2]$.\n2. Split the first array into $[1,3],[2]$ and the second array into $[2],[2,2]$.\n3. Split the first array into $[1,3,2]$ and the second array into $[2,2,2]$.  \n\n\n##### For Sample 3:\nThe only valid way is to split the first array into $[2],[5,1,3],[2]$ and the  second array into $[2],[1,5],[2,2]$.  \n\n#### SCORING:\n- Inputs 5-6: $N \\le 10$\n- Inputs 7-9: $N \\le 80$ \n- Inputs 10-17: $N \\le 300$ \n- Inputs 18-20: $N \\le 500$", "locale": "en"}, "zh-CN": {"title": "[USACO24OPEN] Smaller Averages G", "background": "", "description": "Bessie 有两个长度为 $N$ 的数组（$1\\le N\\le 500$）。第一个数组的第 $i$ 个元素为 $a_i$（$1\\le a_i\\le 10^6$），第二个数组的第 $i$ 个元素为 $b_i$（$1\\le b_i\\le 10^6$）。\n\nBessie 希望将两个数组均划分为若干**非空**子数组，使得以下条件成立。\n\n1. 每个元素恰属于 $1$ 个子数组。\n2. 两个数组划分为相同数量的子数组。令第一个和第二个数组被划分为的子数组数量为 $k$（即，第一个数组被划分为恰好 $k$ 个子数组，第二个数组被划分为恰好 $k$ 个子数组）。\n3. 对于所有 $1\\le i\\le k$，第一个数组左数第 $i$ 个子数组的平均值**小于或等于**第二个数组左数第 $i$ 个子数组的平均值。 \n\n计算她有多少种方式在满足限制的情况下将两个数组划分为非空子数组，对 $10^9+7$ 取模。两种划分方式被认为是不同的，如果子数组的数量不同或是某个元素属于不同的子数组。 ", "inputFormat": "输入的第一行包含 $N$。\n\n第二行包含 $a_1,a_2,\\ldots,a_N$。\n\n第三行包含 $b_1,b_2,\\ldots,b_N$。 ", "outputFormat": "输出在满足限制的情况下将两个数组划分为非空子数组的方法数模 $10^9+7$ 的余数。", "hint": "### 样例解释 1\n\n两种合法的方法为：\n\n1. 将第一个数组划分为 $[1],[2]$，第二个数组划分为 $[2],[2]$。\n2. 将第一个数组划分为 $[1,2]$，第二个数组划分为 $[2,2]$。\n\n### 样例解释 2\n\n三种合法的方法为：\n\n1. 将第一个数组划分为 $[1,3],[2]$，第二个数组划分为 $[2,2],[2]$。\n2. 将第一个数组划分为 $[1,3],[2]$，第二个数组划分为 $[2],[2,2]$。\n3. 将第一个数组划分为 $[1,3,2]$，第二个数组划分为 $[2,2,2]$。\n\n### 样例解释 3\n\n唯一合法的方法是将第一个数组划分为 $[2],[5,1,3],[2]$，第二个数组划分为 $[2],[1,5],[2,2]$。\n\n### 测试点性质\n\n- 测试点 $5-6$：$N\\le 10$。\n- 测试点 $7-9$：$N\\le 80$。\n- 测试点 $10-17$：$N\\le 300$。\n- 测试点 $18-20$：$N\\le 500$。", "locale": "zh-CN"}}}
{"pid": "P10283", "type": "P", "difficulty": 6, "samples": [["3\n1\n1\n1", "5"], ["3\n1\n11\n111", "2"], ["3\n1\n1\n11", "4"], ["5\n0\n01\n0011\n010\n01", "6"], ["14\n0\n1\n1\n0\n1\n0\n1\n1\n1\n1\n1\n0\n0\n1", "41"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["贪心", "USACO", "2024", "字典树 Trie", "启发式合并"], "title": "[USACO24OPEN] Identity Theft P", "background": "", "description": "****Note: The time limit and memory limit for this problem are 3s and 512MB, which are 1.5x and 2x the normal amount, respectively.****  \n\nFarmer John's $N$ ($1 \\leq N \\leq 10^5$) cows each have a Farm ID number in the form of a bitstring (a string consisting of the characters '0' and '1'). Bessie, the eldest cow, has the Farm ID numbers of all the cows memorized, and likes to go around and ask cows their ID numbers.  \n\nWhen a cow is asked their Farm ID number, they will start to say the correct bitstring, but may get confused and stop before finishing it. When Bessie hears the bitstring, if it is not the Farm ID number of any cow on the farm, then she will shrug and walk off. However, if it is the ID number of a different cow than the one she asked, then she will assume that identity theft has occurred and place the farm into lockdown. Note that this can happen even when the cow says their full Farm ID number.  \n\nFarmer John would like to prevent this from happening, and is willing to change the cows' Farm ID numbers by adding some more bits to them. In one second, he can add one bit to the end of the Farm ID number of any cow. Figure out the minimum amount of time it will take for him to prevent a lockdown from ever occurring.", "inputFormat": "The first line contains $N$, the number of cows on Farmer John's farm.  \n\nThen $N$ lines follow. The $k$th line contains a bitstring equal to the Farm ID number of the $k$th cow on Farmer John's farm.  \n\nNo cow's Farm ID number is empty, and the total length of all Farm ID numbers is at most $10^6$.", "outputFormat": "Output the minimum number of seconds Farmer John needs to spend to ensure that a lockdown will never occur.", "hint": "##### For Sample 1:\nThis sample satisfies the constraints for the first subtask.  \n\nWe can make a lockdown impossible in 5 seconds by adding '0' to the first Farm ID number, '10' to the second Farm ID number, and '11' to the third Farm ID number, making the Farm ID numbers '10', '110', and '111'.  \n\nYou can prove that this cannot be done in 4 or fewer seconds. For example, if you leave the Farm ID numbers as they are, then all 3 cows have the same Farm ID number '1', so when Bessie hears it it will always be the Farm ID number of another cow.  \n\nAs another example, if you spend just 2 seconds to add '0' to the second Farm ID number and '1' to the third Farm ID number, then the Farm ID numbers are '1', '10', and '11', and so the second and third cows, when saying their Farm ID numbers, might stop in the middle and just say '1', which would be the Farm ID number of the first cow.  \n\n##### For Sample 2:\nWe can make a lockdown impossible in 2 seconds by adding '0' to the first two Farm ID numbers, making the Farm ID numbers '10', '110', and '111' like before. You can prove that this cannot be done in 1 second.  \n\n##### For Sample 3:\nWe can make a lockdown impossible in 4 seconds by adding '00' to the first Farm ID number and '01' to the second Farm ID number. You can prove that this cannot be done in 3 or fewer seconds.  \n##### For Sample 5:\nThis sample satisfies the constraints for the first subtask. \n#### SCORING:\n-  Inputs 6-7: All Farm ID numbers have length exactly $1$.\n-  Inputs 8-15: $N\\le 10^2$ and the total length of the Farm ID numbers does not exceed $10^3$.\n- Inputs 16-25: No additional constraints.", "locale": "en", "translations": {"en": {"title": "[USACO24OPEN] Identity Theft P", "background": "", "description": "****Note: The time limit and memory limit for this problem are 3s and 512MB, which are 1.5x and 2x the normal amount, respectively.****  \n\nFarmer John's $N$ ($1 \\leq N \\leq 10^5$) cows each have a Farm ID number in the form of a bitstring (a string consisting of the characters '0' and '1'). Bessie, the eldest cow, has the Farm ID numbers of all the cows memorized, and likes to go around and ask cows their ID numbers.  \n\nWhen a cow is asked their Farm ID number, they will start to say the correct bitstring, but may get confused and stop before finishing it. When Bessie hears the bitstring, if it is not the Farm ID number of any cow on the farm, then she will shrug and walk off. However, if it is the ID number of a different cow than the one she asked, then she will assume that identity theft has occurred and place the farm into lockdown. Note that this can happen even when the cow says their full Farm ID number.  \n\nFarmer John would like to prevent this from happening, and is willing to change the cows' Farm ID numbers by adding some more bits to them. In one second, he can add one bit to the end of the Farm ID number of any cow. Figure out the minimum amount of time it will take for him to prevent a lockdown from ever occurring.", "inputFormat": "The first line contains $N$, the number of cows on Farmer John's farm.  \n\nThen $N$ lines follow. The $k$th line contains a bitstring equal to the Farm ID number of the $k$th cow on Farmer John's farm.  \n\nNo cow's Farm ID number is empty, and the total length of all Farm ID numbers is at most $10^6$.", "outputFormat": "Output the minimum number of seconds Farmer John needs to spend to ensure that a lockdown will never occur.", "hint": "##### For Sample 1:\nThis sample satisfies the constraints for the first subtask.  \n\nWe can make a lockdown impossible in 5 seconds by adding '0' to the first Farm ID number, '10' to the second Farm ID number, and '11' to the third Farm ID number, making the Farm ID numbers '10', '110', and '111'.  \n\nYou can prove that this cannot be done in 4 or fewer seconds. For example, if you leave the Farm ID numbers as they are, then all 3 cows have the same Farm ID number '1', so when Bessie hears it it will always be the Farm ID number of another cow.  \n\nAs another example, if you spend just 2 seconds to add '0' to the second Farm ID number and '1' to the third Farm ID number, then the Farm ID numbers are '1', '10', and '11', and so the second and third cows, when saying their Farm ID numbers, might stop in the middle and just say '1', which would be the Farm ID number of the first cow.  \n\n##### For Sample 2:\nWe can make a lockdown impossible in 2 seconds by adding '0' to the first two Farm ID numbers, making the Farm ID numbers '10', '110', and '111' like before. You can prove that this cannot be done in 1 second.  \n\n##### For Sample 3:\nWe can make a lockdown impossible in 4 seconds by adding '00' to the first Farm ID number and '01' to the second Farm ID number. You can prove that this cannot be done in 3 or fewer seconds.  \n##### For Sample 5:\nThis sample satisfies the constraints for the first subtask. \n#### SCORING:\n-  Inputs 6-7: All Farm ID numbers have length exactly $1$.\n-  Inputs 8-15: $N\\le 10^2$ and the total length of the Farm ID numbers does not exceed $10^3$.\n- Inputs 16-25: No additional constraints.", "locale": "en"}, "zh-CN": {"title": "[USACO24OPEN] Identity Theft P", "background": "**注意：本题的时间限制和内存限制为 3 秒 和 512MB，分别为通常限制的 1.5 倍和 2 倍。**", "description": "Farmer John 的 $N$（$1\\le N\\le 10^5$）头奶牛每头都有一个二进制字符串（由字符 `0` 和 `1` 组成的字符串）形式的农场证号。Bessie，最年长的奶牛，记住了所有奶牛的农场证号，还喜欢到处询问奶牛她们的农场证号。\n\n当一头奶牛被询问她的农场证号时，她们会开始报正确的二进制字符串，但有可能会感到困惑并在报完之前停下来。当 Bessie 听到该二进制字符串时，如果它不等于农场上任何一头奶牛的农场证号，她就会耸耸肩走开。然而，如果它等于不同于她所询问的奶牛的另一头奶牛的农场证号，那么她就会认为发生了身份盗用并封锁整个农场。注意，这种情况即使当奶牛报出完整的农场证号时也可能发生。\n\nFarmer John 希望防止这种情况发生，并愿意以添加更多二进制位的方式改变奶牛的农场证号。他可以在一秒钟内在任意一头牛的农场证号末尾添加一个二进制位。求出他所需要的最小时间以防止封锁发生。 ", "inputFormat": "输入的第一行包含 $N$，为 Farmer John 的农场上的奶牛数量。\n\n以下 $N$ 行，第 $k$ 行包含表示 Farmer John 的农场上第 $k$ 头奶牛的农场证号的二进制字符串。\n\n所有奶牛的农场证号均不为空，且所有农场证号的总长度不超过 $10^6$。 ", "outputFormat": "输出 Farmer John 需要花费的最小秒数以确保封锁不会发生。 ", "hint": "### 样例解释 1\n\n这一样例满足第一个子任务的性质。\n\n我们可以花费 5 秒使得封锁不可能发生，通过对第一个农场证号添加 `0`，对第二个农场证号添加 `10`，对第三个农场证号添加 `11`，使农场证号变为 `10`，`110` 和 `111`。\n\n你可以证明这不可能在 4 秒或更少的时间内完成。例如，如果你保持所有农场证号不变，则所有 3 头奶牛都具有相同的农场证号 `1`，因此当 Bessie 听到它时，它将始终等于另一头奶牛的农场证号。\n\n作为另一个例子，如果你仅花费 2 秒对第二个农场证号添加 `0`，对第三个农场证号添加 `1`，则农场证号变为 `1`，`10` 和 `11`，因此第二头和第三头奶牛在报她们的农场证号时，可能会停在中间只报出 `1`，而这将等于第一头奶牛的农场证号。\n\n### 样例解释 2\n\n我们可以在 2 秒内使得封锁不可能发生，通过对前两个农场证号添加 `0`，像之前一样使农场证号变为 `10`，`110` 和 `111`。你可以证明这不可能在 1 秒内完成。\n\n### 样例解释 3\n\n我们可以在 4 秒内使得封锁不可能发生，通过对第一个农场证号添加 `00`，对第二个农场证号添加 `01`。你可以证明这不可能在 3 秒或更少的时间内完成。\n\n### 样例解释 5\n\n这一样例满足第一个子任务的性质。\n\n### 测试点性质\n\n- 测试点 $6-7$：所有农场证号的长度均恰好为 $1$。\n- 测试点 $8-15$：$N\\le 10^2$，且所有农场证号的总长度不超过 $10^3$。\n- 测试点 $16-25$：没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P10284", "type": "P", "difficulty": 6, "samples": [["2\n3 1\n15\n1 1 -2\n1 1 -1\n1 1 0\n1 1 1\n1 1 2\n1 2 -2\n1 2 -1\n1 2 0\n1 2 1\n1 2 2\n2 2 -2\n2 2 -1\n2 2 0\n2 2 1\n2 2 2", "1\n2\n3\n-2\n-1\n0\n1\n2\n-1\n0\n-1\n0\n1\n0\n1"], ["5\n4 4 3 1 1\n7\n1 1 20\n1 2 20\n1 5 20\n1 1 0\n1 5 0\n1 4 0\n3 5 2", "16\n12\n7\n4\n1\n2\n1"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["USACO", "平衡树", "2024", "均摊分析"], "title": "[USACO24OPEN] Splitting Haybales P", "background": "", "description": "Farmer John wants to fairly split haybales between his two favorite cows Bessie and Elsie. He has $N$ ( $1\\le N\\le 2\\cdot 10^5$) haybales sorted in non-increasing order,  where the $i$-th haybale has $a_i$ units of hay ($2\\cdot 10^5\\ge a_1\\ge a_2 \\ge \\dots \\ge a_N \\ge 1$).  \n\nFarmer John is considering splitting a contiguous range of haybales $a_l, \\dots, a_r$ between Bessie and Elsie. He has decided to process the haybales in order from $l$ to $r$, and when processing the $i$-th haybale he will give it to the cow who currently has less hay (if it is a tie, he will give it to Bessie).  \n\nYou are given $Q$ ($1\\le Q\\le 2\\cdot 10^5$) queries, each with three integers $l,r,x$ ($1\\le l\\le r\\le N$, $|x|\\le 10^9$). For each query, output how many more units of hay Bessie will have than Elsie after processing haybales $l$ to $r$, if Bessie starts with $x$ more units than Elsie. Note that this value is negative if Elsie ends up with more haybales than Bessie.", "inputFormat": "First line contains $N$.  \n\nSecond line contains $a_1\\dots a_N$.  \n\nThird line contains $Q$.  \n\nNext $Q$ lines contain $l, r, x$.", "outputFormat": "Output $Q$ lines, containing the answer for each query.", "hint": "##### For Sample 1:\nFor the 1st query, Elsie starts with $2$ more hay than Bessie. Then, after processing haybale $1$, Bessie will receive $3$ hay, and Bessie will have $1$ more hay than Elsie.   \n\nFor the 3rd query, Elsie and Bessie start with the same number of hay. After processing haybale $1$, Bessie will receive $3$ hay, and Bessie will have $3$ more hay than Elsie.  \n\nFor the 9th query, Bessie starts with $1$ more hay than Elsie, then after processing the 1st haybale, has $2$ less hay than Elsie, and after processing the 2nd haybale, has $1$ less hay than Elsie. \n##### For Sample 2:\nIn the 5th query, there are $5$ haybales to process. Bessie receives $4$ hay, then Elsie receives $4$ hay, then Bessie receives $3$ hay, then Elsie receives $1$ hay, then Elsie receives $1$ hay.  \n\n#### SCORING:\n- Input 3: $Q\\le 100$.\n- Inputs 4-6: At most $100$ distinct $a_i$.\n- Inputs 7-22: No additional constraints.", "locale": "en", "translations": {"en": {"title": "[USACO24OPEN] Splitting Haybales P", "background": "", "description": "Farmer John wants to fairly split haybales between his two favorite cows Bessie and Elsie. He has $N$ ( $1\\le N\\le 2\\cdot 10^5$) haybales sorted in non-increasing order,  where the $i$-th haybale has $a_i$ units of hay ($2\\cdot 10^5\\ge a_1\\ge a_2 \\ge \\dots \\ge a_N \\ge 1$).  \n\nFarmer John is considering splitting a contiguous range of haybales $a_l, \\dots, a_r$ between Bessie and Elsie. He has decided to process the haybales in order from $l$ to $r$, and when processing the $i$-th haybale he will give it to the cow who currently has less hay (if it is a tie, he will give it to Bessie).  \n\nYou are given $Q$ ($1\\le Q\\le 2\\cdot 10^5$) queries, each with three integers $l,r,x$ ($1\\le l\\le r\\le N$, $|x|\\le 10^9$). For each query, output how many more units of hay Bessie will have than Elsie after processing haybales $l$ to $r$, if Bessie starts with $x$ more units than Elsie. Note that this value is negative if Elsie ends up with more haybales than Bessie.", "inputFormat": "First line contains $N$.  \n\nSecond line contains $a_1\\dots a_N$.  \n\nThird line contains $Q$.  \n\nNext $Q$ lines contain $l, r, x$.", "outputFormat": "Output $Q$ lines, containing the answer for each query.", "hint": "##### For Sample 1:\nFor the 1st query, Elsie starts with $2$ more hay than Bessie. Then, after processing haybale $1$, Bessie will receive $3$ hay, and Bessie will have $1$ more hay than Elsie.   \n\nFor the 3rd query, Elsie and Bessie start with the same number of hay. After processing haybale $1$, Bessie will receive $3$ hay, and Bessie will have $3$ more hay than Elsie.  \n\nFor the 9th query, Bessie starts with $1$ more hay than Elsie, then after processing the 1st haybale, has $2$ less hay than Elsie, and after processing the 2nd haybale, has $1$ less hay than Elsie. \n##### For Sample 2:\nIn the 5th query, there are $5$ haybales to process. Bessie receives $4$ hay, then Elsie receives $4$ hay, then Bessie receives $3$ hay, then Elsie receives $1$ hay, then Elsie receives $1$ hay.  \n\n#### SCORING:\n- Input 3: $Q\\le 100$.\n- Inputs 4-6: At most $100$ distinct $a_i$.\n- Inputs 7-22: No additional constraints.", "locale": "en"}, "zh-CN": {"title": "[USACO24OPEN] Splitting Haybales P", "background": "", "description": "Farmer John 想要将干草堆公平地分配给他最喜欢的两头奶牛 Bessie 和 Elsie。他有 $N$（$1\\le N\\le 2\\cdot 10^5$）个降序排序的干草堆，其中第 $i$ 个干草堆有 $a_i$ 单位干草（$2\\cdot 10^5\\ge a_1\\ge a_2\\ge \\cdots \\ge a_N\\ge 1$）。\n\nFarmer John 正在考虑将一个连续区间的干草堆 $a_l,\\ldots,a_r$ 分配给 Bessie 和 Elsie。他决定按从 $l$ 到 $r$ 的顺序处理干草堆，当处理第 $i$ 个干草堆时他会将其交给当前干草较少的奶牛（如果并列，他会将其交给 Bessie）。\n\n给定 $Q$（$1\\le Q\\le 2\\cdot 10^5$）个询问，每个询问包含三个整数 $l,r,x$（$1\\le l\\le r\\le N$，$|x|\\le 10^9$）。对于每个询问，输出如果 Bessie 初始时比 Elsie 多 $x$ 单位干草，在处理干草堆 $l$ 到 $r$ 后 Bessie 将比 Elsie 多多少单位的干草。注意如果 Elsie 最终获得的干草多于 Bessie 则该值为负。", "inputFormat": "输入的第一行包含 $N$。\n\n第二行包含 $a_1\\ldots a_N$。\n\n第三行包含 $Q$。\n\n以下 $Q$ 行包含 $l,r,x$。 ", "outputFormat": "输出 $Q$ 行，包含每个询问的答案。", "hint": "### 样例解释 1\n\n对于第 1 个询问，Elsie 初始时比 Bessie 多 2 单位干草。然后，在处理干草堆 1 后，Bessie 将收到 3 单位干草，从而 Bessie 将比 Elsie 多 1 单位干草。\n\n对于第 3 个询问，Elsie 和 Bessie 初始时有相同的干草数量。在处理干草堆 1 后，Bessie 将收到 3 单位干草，从而 Bessie 将比 Elsie 多 3 \n单位干草。\n\n对于第 9 个询问，Bessie 初始时比 Elsie 多 1 单位干草，然后在处理第 1 个干草堆后，比 Elsie 少 2 单位干草，处理第 2 个干草堆后，比 Elsie 少 1 单位干草。\n\n### 样例解释 2\n\n对于第 5 个询问，有 5 个干草堆需要处理。Bessie 收到 4 单位干草，然后 Elsie 收到 4 单位干草，然后 Bessie 收到 3 单位干草，然后 Elsie 收到 1 单位干草，然后 Elsie 收到 1 单位干草。\n\n### 测试点性质\n\n- 测试点 $3$：$Q\\le 100$。\n- 测试点 $4-6$：至多存在 $100$ 个不同的 $a_i$。\n- 测试点 $7-22$：没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P10285", "type": "P", "difficulty": 6, "samples": [["10 2 1 2\n6", "22"], ["10 2 1 2\n7", "4"], ["32 4 5 2\n0 23 12 5 11", "48"], ["24 3 1 2\n16", "48"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["二分", "USACO", "2024", "状压 DP"], "title": "[USACO24OPEN] Activating Robots P", "background": "", "description": "You and a single robot are initially at point $0$ on a circle with perimeter $L$ ($1 \\le L \\le 10^9$). You can move either counterclockwise or clockwise along the circle at $1$ unit per second. All movement in this problem is continuous.  \n\nYour goal is to place exactly $R-1$ robots such that at the end, every two consecutive robots are spaced $L/R$ away from each other ($2\\le R\\le 20$, $R$ divides $L$). There are $N$ ($1\\le N\\le 10^5$) activation points, the $i$th of which is located $a_i$ distance counterclockwise from $0$ ($0\\le a_i<L$). If you are currently at an activation point, you can instantaneously place a robot at that point. All robots (including the original) move counterclockwise at a rate of $1$ unit per $K$ seconds ($1\\leq K\\leq 10^6$).  \n\nCompute the minimum time required to achieve the goal.", "inputFormat": "The first line contains $L$, $R$, $N$, and $K$.  \n\nThe next line contains $N$ space-separated integers $a_1,a_2,\\dots,a_N$.", "outputFormat": "The minimum time required to achieve the goal.", "hint": "##### For Sample 1:\nWe can reach the activation point at $6$ in $4$ seconds by going clockwise. At this time, the initial robot will be located at $2$. Wait an additional $18$ seconds until the initial robot is located at $1$. Now we can place a robot to immediately win.  \n\n##### For Sample 2:\nWe can reach the activation point at $7$ in $3$ seconds by going clockwise. At this time, the initial robot will be located at $1.5$. Wait an additional second until the initial robot is located at $2$. Now we can place a robot to immediately win.  \n\n\n#### SCORING:\n- Inputs 5-6: $R=2$.\n- Inputs 7-12: $R\\le 10, N\\le 80$.\n- Inputs 13-20: $R\\le 16$.\n- Inputs 21-24: No additional constraints.", "locale": "en", "translations": {"en": {"title": "[USACO24OPEN] Activating Robots P", "background": "", "description": "You and a single robot are initially at point $0$ on a circle with perimeter $L$ ($1 \\le L \\le 10^9$). You can move either counterclockwise or clockwise along the circle at $1$ unit per second. All movement in this problem is continuous.  \n\nYour goal is to place exactly $R-1$ robots such that at the end, every two consecutive robots are spaced $L/R$ away from each other ($2\\le R\\le 20$, $R$ divides $L$). There are $N$ ($1\\le N\\le 10^5$) activation points, the $i$th of which is located $a_i$ distance counterclockwise from $0$ ($0\\le a_i<L$). If you are currently at an activation point, you can instantaneously place a robot at that point. All robots (including the original) move counterclockwise at a rate of $1$ unit per $K$ seconds ($1\\leq K\\leq 10^6$).  \n\nCompute the minimum time required to achieve the goal.", "inputFormat": "The first line contains $L$, $R$, $N$, and $K$.  \n\nThe next line contains $N$ space-separated integers $a_1,a_2,\\dots,a_N$.", "outputFormat": "The minimum time required to achieve the goal.", "hint": "##### For Sample 1:\nWe can reach the activation point at $6$ in $4$ seconds by going clockwise. At this time, the initial robot will be located at $2$. Wait an additional $18$ seconds until the initial robot is located at $1$. Now we can place a robot to immediately win.  \n\n##### For Sample 2:\nWe can reach the activation point at $7$ in $3$ seconds by going clockwise. At this time, the initial robot will be located at $1.5$. Wait an additional second until the initial robot is located at $2$. Now we can place a robot to immediately win.  \n\n\n#### SCORING:\n- Inputs 5-6: $R=2$.\n- Inputs 7-12: $R\\le 10, N\\le 80$.\n- Inputs 13-20: $R\\le 16$.\n- Inputs 21-24: No additional constraints.", "locale": "en"}, "zh-CN": {"title": "[USACO24OPEN] Activating Robots P", "background": "", "description": "你和一个机器人初始时位于周长为 $L$（$1\\le L\\le 10^9$）的圆上的点 $0$ 处。你可以以每秒 $1$ \n单位的速度沿圆周顺时针或逆时针移动。本题中的所有移动都是连续的。\n\n你的目标是放置恰好 $R-1$ 个机器人，使得最终每两个相邻的机器人彼此相距 $L/R$（$2\\le R\\le 20$，$R$ 整除 $L$）。有 $N$（$1\\le N\\le 10^5$）个激活点，其中第 $i$ 个激活点位于距点 $0$ 逆时针方向 $a_i$ 距离处（$0\\le a_i<L$）处。如果你当前位于一个激活点，你可以立刻在该点放置一个机器人。所有机器人（包括初始的）均以每 $K$ 秒 $1$ 单位的速度逆时针移动（$1\\le K\\le 10^6$）。\n\n计算达到目标所需要的最小时间。 ", "inputFormat": "输入的第一行包含 $L$，$R$，$N$ 和 $K$。\n\n第二行包含 $N$ 个空格分隔的整数 $a_1,a_2,\\ldots,a_N$。 ", "outputFormat": " 输出达到目标所需要的最小时间。", "hint": "### 样例解释 1\n\n我们可以通过顺时针移动在 $4$ 秒内到达点 $6$ 的激活点。此时，初始的机器人将位于点 $2$。再等待 $18$ 秒直到初始机器人位于点 $1$。现在我们可以放置一个机器人以立即获胜。 \n\n### 样例解释 2\n\n我们可以通过顺时针移动在 $3$ 秒内到达点 $7$ 的激活点。此时，初始的机器人将位于点 $1.5$。再等待一秒直到初始机器人位于点 $2$。现在我们可以放置一个机器人以立即获胜。 \n\n### 测试点性质\n\n- 测试点 $5-6$：$R=2$。\n- 测试点 $7-12$：$R\\le 10,N\\le 80$。\n- 测试点 $13-20$：$R\\le 16$。\n- 测试点 $21-24$：没有额外限制。", "locale": "zh-CN"}}}
{"pid": "P10286", "type": "P", "difficulty": 7, "samples": [["2 1\n1 1 1", "15"], ["3 2\n1 1 1 1", "40"], ["12 1\n1 1 4 5 1 4 1 9 1 9 8 1 0", "721168027"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "二分图", "生成函数", "快速数论变换 NTT"], "title": "「RiOI-03」A Journey to the Moonlight（加强版）", "background": "本题相较于 [P9919](/problem/P9919) 扩大了数据范围。", "description": "对于一个右部点为 $m$ 个的二分图 $G$，定义它的权值 $w(G)$ 如下：\n\n- 选择一种匹配方案，标记第一个已匹配的右部点。如果不存在这样的点，那么标记第一个未匹配的右部点。\n- 每次随机选择一个 $1,2,\\cdots,m$ 的排列，当未匹配的右部点与被标记的点 **按标号顺序作为一个子段出现在排列中时** 停止操作。\n- $w(G)$ 为在所有匹配方案中操作次数期望的 **最小值**。\n\n将这个二分图 $G$ 定义为 **$k$ 合法** 的，当且仅当：\n\n- 所有左部点的度数在 $k\\sim \\color{red}2$ 之间。\n- 没有任意两个左部点，与其相邻的点组成的集合相同。\n\n定义 $f(k,x)$ 为所有右部点 $x$ 个，左部点不进行区分的 $k$ 合法二分图 $G$ 的 $w(G)$ 之和。\n\n给定 $n,k,a_{0\\sim n}$，求 $\\sum\\limits^n_ia_if(k,i) \\bmod998244353$。", "inputFormat": "一行两个正整数，分别表示 $n,k$。\n\n第二行 $n+1$ 个非负整数，分别表示 $a_{0\\sim n}$。", "outputFormat": "一行一个非负整数，表示答案。", "hint": "约定一个左部点连接了编号为 $x,y$ 的右部点表示为 $(x,y)$。\n\n#### 【样例 1 解释】\n\n对于 $n=0,1$，答案显然为 $1,2$。\n\n对于 $n=2$，可能的二分图为（用每个左部点的邻接点组成的元组表示）：\n\n$()$\n\n$(1),(2),(1,2)$\n\n$\\{(1),(2)\\},\\{(1,2),(2)\\},\\{(1,2),(1)\\},\\{(1,2),(1),(2)\\}$\n\n期望相同的二分图被分为一组。答案为 $\\dfrac21+\\dfrac21\\times3+\\dfrac22\\times4=12$，输出 $1\\times1+1\\times2+1\\times12=15$。\n\n#### 【样例 2 解释】\n\n对于 $n=0,1,2$，答案为 $1,1,4$。\n\n对于 $n=3$，可能的二分图为（用每个左部点的邻接点组成的元组表示）：\n\n$()$\n\n$(1,2),(1,3),(2,3)$\n\n$\\{(1,2),(1,3)\\},\\{(1,2),(2,3)\\},\\{(1,3),(2,3)\\}$\n\n$\\{(1,2),(2,3),(1,3)\\}$\n\n答案为 $\\dfrac61+\\dfrac61\\times3+\\dfrac62\\times3+\\dfrac66=34$。\n\n#### 【数据范围】\n\n对于 $100\\%$ 的数据，$0\\le n\\le10^5$，$1\\le k\\le2$，$0\\le a_i<998244353$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「RiOI-03」A Journey to the Moonlight（加强版）", "background": "本题相较于 [P9919](/problem/P9919) 扩大了数据范围。", "description": "对于一个右部点为 $m$ 个的二分图 $G$，定义它的权值 $w(G)$ 如下：\n\n- 选择一种匹配方案，标记第一个已匹配的右部点。如果不存在这样的点，那么标记第一个未匹配的右部点。\n- 每次随机选择一个 $1,2,\\cdots,m$ 的排列，当未匹配的右部点与被标记的点 **按标号顺序作为一个子段出现在排列中时** 停止操作。\n- $w(G)$ 为在所有匹配方案中操作次数期望的 **最小值**。\n\n将这个二分图 $G$ 定义为 **$k$ 合法** 的，当且仅当：\n\n- 所有左部点的度数在 $k\\sim \\color{red}2$ 之间。\n- 没有任意两个左部点，与其相邻的点组成的集合相同。\n\n定义 $f(k,x)$ 为所有右部点 $x$ 个，左部点不进行区分的 $k$ 合法二分图 $G$ 的 $w(G)$ 之和。\n\n给定 $n,k,a_{0\\sim n}$，求 $\\sum\\limits^n_ia_if(k,i) \\bmod998244353$。", "inputFormat": "一行两个正整数，分别表示 $n,k$。\n\n第二行 $n+1$ 个非负整数，分别表示 $a_{0\\sim n}$。", "outputFormat": "一行一个非负整数，表示答案。", "hint": "约定一个左部点连接了编号为 $x,y$ 的右部点表示为 $(x,y)$。\n\n#### 【样例 1 解释】\n\n对于 $n=0,1$，答案显然为 $1,2$。\n\n对于 $n=2$，可能的二分图为（用每个左部点的邻接点组成的元组表示）：\n\n$()$\n\n$(1),(2),(1,2)$\n\n$\\{(1),(2)\\},\\{(1,2),(2)\\},\\{(1,2),(1)\\},\\{(1,2),(1),(2)\\}$\n\n期望相同的二分图被分为一组。答案为 $\\dfrac21+\\dfrac21\\times3+\\dfrac22\\times4=12$，输出 $1\\times1+1\\times2+1\\times12=15$。\n\n#### 【样例 2 解释】\n\n对于 $n=0,1,2$，答案为 $1,1,4$。\n\n对于 $n=3$，可能的二分图为（用每个左部点的邻接点组成的元组表示）：\n\n$()$\n\n$(1,2),(1,3),(2,3)$\n\n$\\{(1,2),(1,3)\\},\\{(1,2),(2,3)\\},\\{(1,3),(2,3)\\}$\n\n$\\{(1,2),(2,3),(1,3)\\}$\n\n答案为 $\\dfrac61+\\dfrac61\\times3+\\dfrac62\\times3+\\dfrac66=34$。\n\n#### 【数据范围】\n\n对于 $100\\%$ 的数据，$0\\le n\\le10^5$，$1\\le k\\le2$，$0\\le a_i<998244353$。", "locale": "zh-CN"}}}
{"pid": "P10287", "type": "P", "difficulty": 3, "samples": [["5 4\n2 10 6 3 1\n5 2\n2 3\n3 1\n1 4", "3"], ["6 11\n1 1 2 1 1 2\n3 2\n3 1\n5 3\n4 2\n2 6\n3 6\n1 6\n4 6\n1 2\n5 1\n5 4", "4"], ["6 11\n5 9 10 5 1 6\n5 4\n5 2\n4 2\n3 1\n5 3\n6 1\n4 1\n4 3\n5 1\n2 3\n2 1", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "拓扑排序", "GESP"], "title": "[GESP样题 七级] 最长不下降子序列", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1107>", "description": "小杨有个包含 $n$ 个节点 $m$ 条边的有向无环图，其中节点的编号为 $1$ 到 $n$。\n\n对于编号为 $i$ 的节点，其权值为 $A_i$。对于图中的一条路径，根据路径上的经过节点的先后顺序可以得到一个节点权值的序列，小杨想知道图中所有可能序列中最长不下降子序列的最大长度。\n\n注：给定一个序列 $S$，其最长不下降子序列 $S'$ 是原序列中的如下子序列：整个子序列 $S'$ 单调不降，并且是序列中最长的单调不降子序列。例如，给定序列 $S = [11,12,13,9,8,17,19]$，其最长不下降子序列为 $S'=[11,12,13,17,19]$，长度为 $5$。", "inputFormat": "第一行包含两个正整数 $n,m$，表示节点数和边数。 \n \n第二行包含 $n$ 个正整数 $A_1, A_2, \\dots A_n$，表示节点 $1$ 到 $n$ 的点权。  \n\n之后 $m$ 行每行包含两个正整数 $u_i, v_i$，表示第 $i$ 条边连接节点 $u_i$ 和 $v_i$，方向为从 $u_i$ 到 $v_i$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "### 数据规模与约定\n\n| 子任务 | 分值 | $n\\le$ | $A_i \\le$ | 特殊约定 |\n| :-: | :-: | :-: | :-: | :-:|\n| $1$ | $30$ | $10^3$ | $10$ | 输入的图是一条链 |\n| $2$ | $30$ | $10^5$ | $2$ | 无 |\n| $3$ | $40$ | $10^5$ | $10$ | 无|\n\n对全部的测试数据，保证 $1 \\leq n \\leq 10^5$，$1 \\leq m \\leq 10^5$，$1 \\leq A_i \\leq 10$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[GESP样题 七级] 最长不下降子序列", "background": "对应的选择、判断题：<https://ti.luogu.com.cn/problemset/1107>", "description": "小杨有个包含 $n$ 个节点 $m$ 条边的有向无环图，其中节点的编号为 $1$ 到 $n$。\n\n对于编号为 $i$ 的节点，其权值为 $A_i$。对于图中的一条路径，根据路径上的经过节点的先后顺序可以得到一个节点权值的序列，小杨想知道图中所有可能序列中最长不下降子序列的最大长度。\n\n注：给定一个序列 $S$，其最长不下降子序列 $S'$ 是原序列中的如下子序列：整个子序列 $S'$ 单调不降，并且是序列中最长的单调不降子序列。例如，给定序列 $S = [11,12,13,9,8,17,19]$，其最长不下降子序列为 $S'=[11,12,13,17,19]$，长度为 $5$。", "inputFormat": "第一行包含两个正整数 $n,m$，表示节点数和边数。 \n \n第二行包含 $n$ 个正整数 $A_1, A_2, \\dots A_n$，表示节点 $1$ 到 $n$ 的点权。  \n\n之后 $m$ 行每行包含两个正整数 $u_i, v_i$，表示第 $i$ 条边连接节点 $u_i$ 和 $v_i$，方向为从 $u_i$ 到 $v_i$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "### 数据规模与约定\n\n| 子任务 | 分值 | $n\\le$ | $A_i \\le$ | 特殊约定 |\n| :-: | :-: | :-: | :-: | :-:|\n| $1$ | $30$ | $10^3$ | $10$ | 输入的图是一条链 |\n| $2$ | $30$ | $10^5$ | $2$ | 无 |\n| $3$ | $40$ | $10^5$ | $10$ | 无|\n\n对全部的测试数据，保证 $1 \\leq n \\leq 10^5$，$1 \\leq m \\leq 10^5$，$1 \\leq A_i \\leq 10$。", "locale": "zh-CN"}}}
