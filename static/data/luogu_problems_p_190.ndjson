{"pid": "P4843", "type": "P", "difficulty": 6, "samples": [["8\n1 3\n1 7\n2 4 5\n1 8\n1 8\n0\n2 6 5\n0", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["网络流", "上下界网络流", "费用流"], "title": "清理雪道", "background": null, "description": "滑雪场坐落在 FJ 省西北部的若干座山上。\n\n从空中鸟瞰，滑雪场可以看作一个有向无环图，每条弧代表一个斜坡（即雪道），弧的方向代表斜坡下降的方向。\n\n你的团队负责每周定时清理雪道。你们拥有一架直升飞机，每次飞行可以从总部带一个人降落到滑雪场的某个地点，然后再飞回总部。从降落的地点出发，这个人可以顺着斜坡向下滑行，并清理他所经过的雪道。\n\n由于每次飞行的耗费是固定的，为了最小化耗费，你想知道如何用最少的飞行次数才能完成清理雪道的任务。", "inputFormat": "第一行一个整数 $n$ 代表滑雪场的地点的数量。\n\n接下来的 $n$ 行，描述 $1$ 到 $n$ 号地点出发的斜坡。第 $i$ 行的第一个数为 $m_i$，后面共有 $m_i$ 个整数，由空格隔开，每个整数 $a_{i,j}$ 互不相同，代表从地点 $i$ 下降到地点 $a_{i,j}$ 的斜坡。", "outputFormat": "一行一个整数，表示直升飞机的最少飞行次数。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$2 \\le  n \\le 100$，$0\\le m_i < n$，且每个地点至少有一个斜坡与之相连。", "locale": "zh-CN", "translations": {"en": {"title": "Clearing Ski Runs", "background": "", "description": "A ski resort is located on several mountains in the northwest of FJ Province.\n\nFrom an aerial view, the ski resort can be seen as a directed acyclic graph. Each arc represents a slope (i.e., a ski run), and the direction of the arc represents the downhill direction of the slope.\n\nYour team is responsible for regularly clearing the ski runs every week. You have a helicopter. In each flight, it can carry one person from the headquarters to land at some location in the ski resort, and then fly back to the headquarters. Starting from the landing location, this person can ski downhill along the slopes and clear the ski runs he passes through.\n\nSince the cost of each flight is fixed, to minimize the cost, you want to know the minimum number of flights needed to complete the task of clearing all ski runs.", "inputFormat": "The first line contains an integer $n$, representing the number of locations in the ski resort.\n\nThe next $n$ lines describe the slopes starting from locations $1$ to $n$. In the $i$-th line, the first number is $m_i$, followed by $m_i$ integers separated by spaces. Each integer $a_{i,j}$ is distinct, representing a slope from location $i$ down to location $a_{i,j}$.", "outputFormat": "Output one integer in a single line, representing the minimum number of helicopter flights.", "hint": "#### Constraints\n\nFor $100\\%$ of the testdata, $2 \\le n \\le 100$, $0 \\le m_i < n$, and each location is connected to at least one slope.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "清理雪道", "background": null, "description": "滑雪场坐落在 FJ 省西北部的若干座山上。\n\n从空中鸟瞰，滑雪场可以看作一个有向无环图，每条弧代表一个斜坡（即雪道），弧的方向代表斜坡下降的方向。\n\n你的团队负责每周定时清理雪道。你们拥有一架直升飞机，每次飞行可以从总部带一个人降落到滑雪场的某个地点，然后再飞回总部。从降落的地点出发，这个人可以顺着斜坡向下滑行，并清理他所经过的雪道。\n\n由于每次飞行的耗费是固定的，为了最小化耗费，你想知道如何用最少的飞行次数才能完成清理雪道的任务。", "inputFormat": "第一行一个整数 $n$ 代表滑雪场的地点的数量。\n\n接下来的 $n$ 行，描述 $1$ 到 $n$ 号地点出发的斜坡。第 $i$ 行的第一个数为 $m_i$，后面共有 $m_i$ 个整数，由空格隔开，每个整数 $a_{i,j}$ 互不相同，代表从地点 $i$ 下降到地点 $a_{i,j}$ 的斜坡。", "outputFormat": "一行一个整数，表示直升飞机的最少飞行次数。", "hint": "#### 数据规模与约定\n\n对于 $100\\%$ 的数据，$2 \\le  n \\le 100$，$0\\le m_i < n$，且每个地点至少有一个斜坡与之相连。", "locale": "zh-CN"}}}
{"pid": "P4844", "type": "P", "difficulty": 6, "samples": [["10", "3"], ["100", "43"], ["100000", "42139\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["数学", "枚举", "莫比乌斯反演"], "title": "LJJ爱数数", "background": "题解请查看 <https://www.cnblogs.com/Blog-of-Eden/p/9367521.html>。", "description": "PJY 某次翻阅杂志时，看到一道题：\n\n求出所有的 **正整数** 三元组 $(a,b,c)$，满足 $a,b,c \\leq n$，**$\\bold{a,b,c}$ 三个数的最大公约数为 $\\bold{1}$**，且 **$\\bold{\\frac{1}{a}+\\frac{1}{b}=\\frac{1}{c}}$**。\n\nPJY 嫌这道题太水，于是把它甩给了爱数数的 LJJ，并加上了数据范围 $\\bold{n \\leq 10^{12}}$，让 LJJ 数出 **有多少组满足条件的三元组 $\\bold{(a,b,c)}$**\n（注意当 $a \\not= b$ 时，$(a,b,c)$ 和 $(b,a,c)$ 是不同的三元组，要算两次）\n\nLJJ 数到一半，发现这个数量太大了，于是他把问题抛给了你。请你输出这个数量。", "inputFormat": "输入仅一行：一个正整数 $n(n\\leq 10^{12})$。", "outputFormat": "输出仅一行：一个整数，表示满足条件的三元组 $(a,b,c)$ 的数量。", "hint": "对于 $20\\%$ 的数据，$n \\leq 2 \\times 10^{3}$。\n\n对于 $40\\%$ 的数据，$n \\leq 10^{5}$。\n\n对于 $60\\%$ 的数据，$n \\leq 10^{7}$。\n\n对于 $80\\%$ 的数据，$n \\leq 10^{9}$。\n\n对于 $100\\%$ 的数据，$n \\leq 10^{12}$。", "locale": "zh-CN", "translations": {"en": {"title": "LJJ Loves Counting.", "background": "For the solution, please see <https://www.cnblogs.com/Blog-of-Eden/p/9367521.html>。", "description": "Once when reading a magazine, PJY saw a problem:\n\nFind all **positive integer** triples $(a,b,c)$ such that $a,b,c \\leq n$, the **greatest common divisor of the three numbers $\\bold{a,b,c}$ is $\\bold{1}$**, and **$\\bold{\\frac{1}{a}+\\frac{1}{b}=\\frac{1}{c}}$**.\n\nPJY thought this problem was too easy, so he threw it to LJJ, who loves counting, and added the Constraints $\\bold{n \\leq 10^{12}}$, asking LJJ to count **how many triples $\\bold{(a,b,c)}$** satisfy the conditions  \n(note that when $a \\not= b$, $(a,b,c)$ and $(b,a,c)$ are different triples and should be counted twice).\n\nHalfway through counting, LJJ found that the number was too large, so he passed the problem to you. Please output this number.", "inputFormat": "Only one line: a positive integer $n(n\\leq 10^{12})$。", "outputFormat": "Only one line: an integer, representing the number of triples $(a,b,c)$ that satisfy the conditions.", "hint": "For $20\\%$ of the testdata, $n \\leq 2 \\times 10^{3}$。\n\nFor $40\\%$ of the testdata, $n \\leq 10^{5}$。\n\nFor $60\\%$ of the testdata, $n \\leq 10^{7}$。\n\nFor $80\\%$ of the testdata, $n \\leq 10^{9}$。\n\nFor $100\\%$ of the testdata, $n \\leq 10^{12}$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "LJJ爱数数", "background": "题解请查看 <https://www.cnblogs.com/Blog-of-Eden/p/9367521.html>。", "description": "PJY 某次翻阅杂志时，看到一道题：\n\n求出所有的 **正整数** 三元组 $(a,b,c)$，满足 $a,b,c \\leq n$，**$\\bold{a,b,c}$ 三个数的最大公约数为 $\\bold{1}$**，且 **$\\bold{\\frac{1}{a}+\\frac{1}{b}=\\frac{1}{c}}$**。\n\nPJY 嫌这道题太水，于是把它甩给了爱数数的 LJJ，并加上了数据范围 $\\bold{n \\leq 10^{12}}$，让 LJJ 数出 **有多少组满足条件的三元组 $\\bold{(a,b,c)}$**\n（注意当 $a \\not= b$ 时，$(a,b,c)$ 和 $(b,a,c)$ 是不同的三元组，要算两次）\n\nLJJ 数到一半，发现这个数量太大了，于是他把问题抛给了你。请你输出这个数量。", "inputFormat": "输入仅一行：一个正整数 $n(n\\leq 10^{12})$。", "outputFormat": "输出仅一行：一个整数，表示满足条件的三元组 $(a,b,c)$ 的数量。", "hint": "对于 $20\\%$ 的数据，$n \\leq 2 \\times 10^{3}$。\n\n对于 $40\\%$ 的数据，$n \\leq 10^{5}$。\n\n对于 $60\\%$ 的数据，$n \\leq 10^{7}$。\n\n对于 $80\\%$ 的数据，$n \\leq 10^{9}$。\n\n对于 $100\\%$ 的数据，$n \\leq 10^{12}$。", "locale": "zh-CN"}}}
{"pid": "P4845", "type": "P", "difficulty": 7, "samples": [["2\n9 1 1\n2 2 2 2 2 3 4 3 4\n1 2\n1 3\n1 4\n1 5\n2 6\n6 7\n3 8\n8 9\n9 2 1\n2 2 2 2 2 3 4 3 4\n1 2\n1 3\n1 4\n1 5\n2 6\n6 7\n3 8\n8 9", "10\n18"], ["3\n10 1 1\n2 8 9 6 1 9 9 2 8 9 \n1 2\n2 3\n2 4\n4 5\n3 6\n2 7\n7 8\n4 9\n7 10\n10 2 1\n2 8 9 6 1 9 9 2 8 9 \n1 2\n2 3\n2 4\n4 5\n3 6\n2 7\n7 8\n4 9\n7 10\n10 3 1\n2 8 9 6 1 9 9 2 8 9 \n1 2\n2 3\n2 4\n4 5\n3 6\n2 7\n7 8\n4 9\n7 10", "34\n46\n61"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP"], "title": "LJJ 爱数树", "background": "", "description": "Eden 偶然间拿到了一张藏宝图，值得一提的是，这是张无向联通图，有 $n$ 个节点，$n-1$ 条长度为 $1$ 的边，即一颗树。每个节点上都标有该地点的宝藏数量 $w_i$。\n\n然而宝藏太多，不能一次性搬完，Eden 花费其所有积蓄买来 $k$ 个摄像头，每个摄像头能观测的距离范围是 $r$（我们规定树上任意两点距离为其最短路径的长度）。为了确保宝藏尽可能不被他人拿走，Eden 将要在这棵树上的至多 $k$ 个节点处布置摄像头（于是与该节点距离 $\\le r$ 的节点都能被观测到）。\n\nEden 想要使能被观测到的节点的宝藏数量（即 $w_i$）之和最大化，于是他把这个问题交给了爱数树的 LJJ。让 LJJ 枚举所有可能放置摄像头的情况，来筛选出最优的方案。\n\nLJJ 数到一半，发现这个方案数量太多了，于是他把问题抛给了你，\n请你输出能被观测到的节点的 $w_i$ 之和的最大值。", "inputFormat": "**本题有多组数据。**\n\n第 $1$ 行：一个正整数 $T$，表示有 $T$ 组数据。\n\n接下来每组数据：\\\n第 $1$ 行：$3$ 个用空格分隔开的正整数 $n, k, r$。\\\n第 $2$ 行：$n$ 个用空格分隔开的正整数，第 $i$ 个数表示 $w_i$。\\\n第 $3$ 至 $n+1$ 行：每行两个整数 $x,y$，表示 $x$ 到 $y$ 之间有一条边。", "outputFormat": "对于每组数据，一行输出一个整数，表示能被观测到的节点的 $w_i$ 之和的最大值。", "hint": "对于 $10\\%$ 的数据，保证 $n\\le20$，$r\\le 20$，$w_i\\le20$；\n\n对于 $40\\%$ 的数据，保证 $n\\le50$，$r\\le 50$，$w_i\\le50$；\n\n对于另外 $20\\%$ 的数据，保证 $k\\le2$；\n\n对于另外 $10\\%$ 的数据，保证给出的树是一条链。\n\n对于 $100\\%$ 的数据，保证 $1\\le k \\le n\\le10^3$，$1\\le r\\le 10^3$，$1\\le w_i\\le10^6$，$1\\le T\\le 5$，$1\\le x,y\\le n$。\n\n官方题解请查看 [https://www.cnblogs.com/Blog-of-Eden/p/9367521.html](https://www.cnblogs.com/Blog-of-Eden/p/9367521.html)。", "locale": "zh-CN", "translations": {"en": {"title": "LJJ Loves Counting Trees", "background": "", "description": "Eden accidentally obtained a treasure map. Notably, it is an undirected connected graph with $n$ nodes and $n-1$ edges of length $1$, i.e., a tree. Each node is labeled with the amount of treasure at that location, $w_i$.\n\nHowever, there is too much treasure to move all at once. Eden spent all his savings to buy $k$ cameras. Each camera has an observation range of $r$ (we define the distance between any two points on the tree as the length of their shortest path). To ensure that the treasure is not taken by others as much as possible, Eden will place cameras at at most $k$ nodes on the tree (so all nodes whose distance to that node is $\\le r$ can be observed).\n\nEden wants to maximize the sum of treasure amounts (i.e., $w_i$) of the nodes that can be observed, so he gave this problem to LJJ, who loves counting trees. He asked LJJ to enumerate all possible camera placements to find the best plan.\n\nHalfway through counting, LJJ realized there were far too many plans, so he threw the problem to you. Please output the maximum possible sum of $w_i$ over the nodes that can be observed.", "inputFormat": "**This problem contains multiple test cases.**\n\nLine $1$: a positive integer $T$, indicating there are $T$ test cases.\n\nFor each test case:\\\nLine $1$: three positive integers $n, k, r$ separated by spaces.\\\nLine $2$: $n$ positive integers separated by spaces; the $i$-th number denotes $w_i$.\\\nLines $3$ to $n+1$: each line contains two integers $x, y$, indicating there is an edge between $x$ and $y$.", "outputFormat": "For each test case, output one integer per line, indicating the maximum possible sum of $w_i$ of the nodes that can be observed.", "hint": "For $10\\%$ of the testdata, it is guaranteed that $n\\le20$, $r\\le 20$, $w_i\\le20$.\n\nFor $40\\%$ of the testdata, it is guaranteed that $n\\le50$, $r\\le 50$, $w_i\\le50$.\n\nFor another $20\\%$ of the testdata, it is guaranteed that $k\\le2$.\n\nFor another $10\\%$ of the testdata, it is guaranteed that the given tree is a chain.\n\nFor $100\\%$ of the testdata, it is guaranteed that $1\\le k \\le n\\le10^3$, $1\\le r\\le 10^3$, $1\\le w_i\\le10^6$, $1\\le T\\le 5$, $1\\le x,y\\le n$.\n\nFor the official editorial, please see [https://www.cnblogs.com/Blog-of-Eden/p/9367521.html](https://www.cnblogs.com/Blog-of-Eden/p/9367521.html).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "LJJ 爱数树", "background": "", "description": "Eden 偶然间拿到了一张藏宝图，值得一提的是，这是张无向联通图，有 $n$ 个节点，$n-1$ 条长度为 $1$ 的边，即一颗树。每个节点上都标有该地点的宝藏数量 $w_i$。\n\n然而宝藏太多，不能一次性搬完，Eden 花费其所有积蓄买来 $k$ 个摄像头，每个摄像头能观测的距离范围是 $r$（我们规定树上任意两点距离为其最短路径的长度）。为了确保宝藏尽可能不被他人拿走，Eden 将要在这棵树上的至多 $k$ 个节点处布置摄像头（于是与该节点距离 $\\le r$ 的节点都能被观测到）。\n\nEden 想要使能被观测到的节点的宝藏数量（即 $w_i$）之和最大化，于是他把这个问题交给了爱数树的 LJJ。让 LJJ 枚举所有可能放置摄像头的情况，来筛选出最优的方案。\n\nLJJ 数到一半，发现这个方案数量太多了，于是他把问题抛给了你，\n请你输出能被观测到的节点的 $w_i$ 之和的最大值。", "inputFormat": "**本题有多组数据。**\n\n第 $1$ 行：一个正整数 $T$，表示有 $T$ 组数据。\n\n接下来每组数据：\\\n第 $1$ 行：$3$ 个用空格分隔开的正整数 $n, k, r$。\\\n第 $2$ 行：$n$ 个用空格分隔开的正整数，第 $i$ 个数表示 $w_i$。\\\n第 $3$ 至 $n+1$ 行：每行两个整数 $x,y$，表示 $x$ 到 $y$ 之间有一条边。", "outputFormat": "对于每组数据，一行输出一个整数，表示能被观测到的节点的 $w_i$ 之和的最大值。", "hint": "对于 $10\\%$ 的数据，保证 $n\\le20$，$r\\le 20$，$w_i\\le20$；\n\n对于 $40\\%$ 的数据，保证 $n\\le50$，$r\\le 50$，$w_i\\le50$；\n\n对于另外 $20\\%$ 的数据，保证 $k\\le2$；\n\n对于另外 $10\\%$ 的数据，保证给出的树是一条链。\n\n对于 $100\\%$ 的数据，保证 $1\\le k \\le n\\le10^3$，$1\\le r\\le 10^3$，$1\\le w_i\\le10^6$，$1\\le T\\le 5$，$1\\le x,y\\le n$。\n\n官方题解请查看 [https://www.cnblogs.com/Blog-of-Eden/p/9367521.html](https://www.cnblogs.com/Blog-of-Eden/p/9367521.html)。", "locale": "zh-CN"}}}
{"pid": "P4846", "type": "P", "difficulty": 6, "samples": [["7 2\n8 8 8 0 8 8 8\n1 7 9\n3 5 17", "2\n16"], ["4 1\n5 3 8 2\n1 4 9", "8"], ["10 10\n7 7 6 5 5 2 8 5 0 3 \n1 8 11\n3 10 11\n4 7 12\n9 10 12\n3 5 10\n2 7 10\n7 9 10\n2 7 11\n1 4 11\n4 7 10\n", "12\n15\n9\n3\n5\n8\n5\n9\n6\n7\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 3000, 3000, 3000, 5000, 5000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["贪心", "二分"], "title": "LJJ爱数书", "background": "题解请查看 [https://www.cnblogs.com/Blog-of-Eden/p/9367521.html](https://www.cnblogs.com/Blog-of-Eden/p/9367521.html)。", "description": "LJJ 的家里有一本“数书”，也就是说里面全都是数字的书，LJJ 十分喜爱它。\n\n数书里有一个序列 $A$，每次操作可以使一段连续的区间加 $1$ 或减 $1$ 并对 $k$ 取模，我们定义和谐函数 $f (A,k)$ 表示最少的操作次数，使得序列的所有元素都变为 $0$。\n\n例如 $A=\\{3,3,2,3\\}$，$k= 4$ 时，通过把 $a$ 变成 $\\{0,0,3,0\\}$，再把 $a$ 变成 $\\{0,0,0,0\\}$ 就能达到要求，所以 $f(A,k)=2$。\n\n现在，输入长度为 $n$ 的序列 $A$，设 $A_{l,r}$ 表示序列 $A$ 第 $l$ 个位置到第 $r$ 个位置的连续子序列。\n有 $m$ 次询问，每次询问输入 $l,r,k$，求 $f (A_{l,r},k)$ 的值。", "inputFormat": "第 $1$ 行：两个整数 $n,m$，表示序列长度为 $n$，有 $m$ 次询问。\n\n第 $2$ 行：$n$ 个整数，第i个整数表示 $A[i]$\n第 $3$ 至 $m+2$ 行：每行三个整数 $l,r,k$。", "outputFormat": "共 $m$ 行：每行一个整数，表示每组询问的答案 $f(A_{l,r},k)$。", "hint": "数据保证每组询问的 $k>\\max_{i = 1}^{n}A_i$。\n\n对于 $100%$ 的数据：$n \\le 200000$，$m \\le 100000$，$k \\le 2^{30}$。", "locale": "zh-CN", "translations": {"en": {"title": "LJJ Loves a Number Book", "background": "Please refer to the solution article at [https://www.cnblogs.com/Blog-of-Eden/p/9367521.html](https://www.cnblogs.com/Blog-of-Eden/p/9367521.html).", "description": "LJJ has a “number book” at home, which means the book contains only numbers. LJJ loves it very much.\n\nIn the number book there is a sequence $A$. In each operation, you may add $1$ or subtract $1$ to a continuous interval, and then take modulo $k$. We define the harmony function $f(A,k)$ as the minimum number of operations needed to make all elements of the sequence become $0$.\n\nFor example, when $A=\\{3,3,2,3\\}$ and $k=4$, by changing $A$ into $\\{0,0,3,0\\}$, and then changing $A$ into $\\{0,0,0,0\\}$, the goal can be achieved, so $f(A,k)=2$.\n\nNow, given a sequence $A$ of length $n$, let $A_{l,r}$ denote the continuous subsequence of $A$ from position $l$ to position $r$.\nThere are $m$ queries. Each query gives $l,r,k$. You need to compute the value of $f(A_{l,r},k)$.", "inputFormat": "Line $1$: Two integers $n,m$, meaning the sequence length is $n$, and there are $m$ queries.\n\nLine $2$: $n$ integers, where the $i$-th integer represents $A[i]$.\n\nLines $3$ to $m+2$: Each line contains three integers $l,r,k$.", "outputFormat": "Output $m$ lines: each line contains one integer, representing the answer $f(A_{l,r},k)$ for each query.", "hint": "It is guaranteed that for each query, $k>\\max_{i = 1}^{n}A_i$.\n\nFor $100\\%$ of the testdata: $n \\le 200000$, $m \\le 100000$, $k \\le 2^{30}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "LJJ爱数书", "background": "题解请查看 [https://www.cnblogs.com/Blog-of-Eden/p/9367521.html](https://www.cnblogs.com/Blog-of-Eden/p/9367521.html)。", "description": "LJJ 的家里有一本“数书”，也就是说里面全都是数字的书，LJJ 十分喜爱它。\n\n数书里有一个序列 $A$，每次操作可以使一段连续的区间加 $1$ 或减 $1$ 并对 $k$ 取模，我们定义和谐函数 $f (A,k)$ 表示最少的操作次数，使得序列的所有元素都变为 $0$。\n\n例如 $A=\\{3,3,2,3\\}$，$k= 4$ 时，通过把 $a$ 变成 $\\{0,0,3,0\\}$，再把 $a$ 变成 $\\{0,0,0,0\\}$ 就能达到要求，所以 $f(A,k)=2$。\n\n现在，输入长度为 $n$ 的序列 $A$，设 $A_{l,r}$ 表示序列 $A$ 第 $l$ 个位置到第 $r$ 个位置的连续子序列。\n有 $m$ 次询问，每次询问输入 $l,r,k$，求 $f (A_{l,r},k)$ 的值。", "inputFormat": "第 $1$ 行：两个整数 $n,m$，表示序列长度为 $n$，有 $m$ 次询问。\n\n第 $2$ 行：$n$ 个整数，第i个整数表示 $A[i]$\n第 $3$ 至 $m+2$ 行：每行三个整数 $l,r,k$。", "outputFormat": "共 $m$ 行：每行一个整数，表示每组询问的答案 $f(A_{l,r},k)$。", "hint": "数据保证每组询问的 $k>\\max_{i = 1}^{n}A_i$。\n\n对于 $100%$ 的数据：$n \\le 200000$，$m \\le 100000$，$k \\le 2^{30}$。", "locale": "zh-CN"}}}
{"pid": "P4847", "type": "P", "difficulty": 6, "samples": [["5 10\n57770 55352 18768 21847 79100 \nM 1 4\nM 3 2\nQ 5 2\nM 3 4\nM 3 5\nM 4 4\nM 3 1\nD 1\nQ 2 2\nQ 2 1\n", "-1\n55352\n113122\n"], ["30 100\n2193 75245 24438 95450 96514 84854 15292 9488 37488 940 52991 15190 64052 17398 80379 77861 88717 34751 16783 88345 27612 21748 79776 43058 35590 49064 45012 37206 70870 30643 \nM 18 26\nM 28 27\nM 25 4\nM 12 22\nM 26 15\nM 3 1\nM 20 20\nM 7 21\nM 18 29\nM 21 26\nM 29 10\nM 27 23\nM 30 28\nM 22 10\nM 13 21\nM 1 23\nM 25 9\nM 29 27\nM 23 25\nM 11 12\nM 1 4\nM 26 14\nM 26 9\nD 4\nM 16 8\nM 16 20\nM 4 27\nM 9 20\nM 11 1\nM 19 8\nQ 12 7\nM 5 10\nD 20\nQ 29 2\nQ 9 15\nM 29 21\nD 5\nM 23 8\nM 6 6\nD 23\nD 6\nQ 4 8\nD 21\nQ 29 23\nQ 19 4\nM 21 21\nM 20 25\nM 27 29\nD 2\nQ 7 2\nM 7 15\nQ 11 18\nD 26\nQ 21 18\nM 22 11\nM 12 12\nM 20 15\nM 22 4\nD 20\nM 4 5\nM 12 2\nQ 27 20\nM 30 2\nM 28 9\nM 20 11\nM 10 21\nM 12 24\nQ 14 14\nM 6 29\nQ 13 18\nQ 10 3\nQ 23 3\nD 4\nM 27 13\nM 6 23\nM 7 14\nQ 12 17\nM 18 25\nQ 2 19\nD 3\nD 9\nQ 2 16\nQ 3 8\nQ 4 10\nD 24\nM 21 4\nQ 17 15\nQ 19 7\nQ 1 24\nQ 9 18\nD 12\nM 4 16\nM 27 21\nD 26\nM 5 14\nM 15 19\nM 21 26\nM 18 27\nQ 21 8\nQ 18 13\n", "52230\n-1\n-1\n254468\n291078\n112233\n-1\n231636\n62363\n-1\n17398\n178645\n25378\n219268\n-1\n419122\n347453\n-1\n-1\n-1\n274542\n-1\n269126\n-1\n178645\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["平衡树", "动态树 LCT"], "title": "银河英雄传说V2", "background": "小 H 昨天看到了 [luogu P1196](https://www.luogu.com.cn/problem/P1196) 这一题，触发了他内心中对英雄的感慨/雾。可是无奈他不会这一题，只好去请教小 W。在讲完那一题之后，小 W 灵机一动——不如改一下这道题吧。\n\n于是，一个很水的签到题出现了。", "description": "某 dalao：把题目说简单一点，方便让我一分钟 A 掉！\n\n于是小 W 只好把题意简化一下：\n\n给定 $n$ 个长度为 $1$ 的序列，第 $i$ 个序列中有一个元素，值为 $a_i$，接下来有三种操作：\n\n1. `M x y`，表示把 $x$ 所在的序列放到 $y$ 所在的序列之后。如果 $x,y$　已经在同一个序列，则不进行操作。\n2. `D x`，表示把 $x$ 所在的序列中从 $x$ 处断开，也就是把 $x$ 及 $x$ 之后的元素单独取出来作为一个序列。\n3. `Q x y`，表示查询 $x$ 到 $y$ 之间（包括x和y）所有元素的值之和。如果 $x$ 和 $y$ 不在同一个序列之中，输出 `-1`.", "inputFormat": "第一行为两个数 $n,m$，分别代表元素个数和操作次数。第二行有 $n$ 个数，为 $a_i$。\n接下来m行，每行包括三种情况：`M x y`，`D x` 或 `Q x y`，与题目描述对应。", "outputFormat": "对于每一个 `Q x y`，输出一个数，表示所有元素的值之和。", "hint": "（出题人非常良心地给了一个大一点的样例！）\n\n**【样例 $1$ 解释】**\n\n首先有 $5$ 个序列（一个横排为一个序列），排列如下：\n```\n1\n2\n3\n4\n5\n```\n\n第一个操作将 $1$ 放到 $4$ 的后面，变成\n```\n2\n3\n4,1\n5\n```\n\n第二个操作将 $3$ 放到 $2$ 后面，变成\n```\n2,3\n4,1\n5\n````\n\n然后查询第 $5$ 个元素到第 $2$ 个元素之间的和，由于不存在，输出 `-1`；\n\n将 $3$ 所在的序列加到 $4$ 所在的序列后面，变成\n```\n4,1,2,3\n5\n```\n\n接下来变成了 $5,4,1,2,3$，也就是所有元素都在 $1$ 个序列了，因此接下来的两个合并操作没有用了，然后把 $1$ 之后的数字删除，变成：\n\n```\n1,2,3\n5,4\n```\n\n查询 $2$ 到 $2$，输出 $a_2$，也就是 $55352$；\n\n查询 $2$ 到 $1$，输出 $a_2+a_1$，也就是 $113122$.\n\n**【数据范围】**\n\n![](https://cdn.luogu.com.cn/upload/pic/30577.png)\n\n~~为了避免某些乱搞（可能避免不了）~~，**前 $5$ 个点按照传统方式计分，每个测试点 $10$ 分；后五个点为 subtask 捆绑测试，必须全部通过才能得 $50$ 分，否则不得分。**\n\n对于所有数据，$1 \\le x,y \\le n，1 \\le a_i \\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "Galaxy Heroes Legend V2", "background": "Yesterday, Little H saw the problem [luogu P1196](https://www.luogu.com.cn/problem/P1196), which triggered his feelings about heroes (fog). However, he could not solve it, so he went to ask Little W for help. After explaining that problem, Little W had a sudden idea—why not modify this problem a bit?\n\nSo, a very easy “check-in” problem appeared.", "description": "Some dalao said: Make the statement simpler so I can get an AC in one minute!\n\nSo Little W had to simplify the meaning:\n\nGiven $n$ sequences of length $1$, the $i$-th sequence contains one element with value $a_i$. Then there are three types of operations:\n\n1. `M x y`: move the sequence containing $x$ to after the sequence containing $y$. If $x$ and $y$ are already in the same sequence, do nothing.\n2. `D x`: cut the sequence containing $x$ at position $x$. That is, take $x$ and all elements after $x$ out as a new sequence.\n3. `Q x y`: query the sum of values of all elements between $x$ and $y$ (including $x$ and $y$). If $x$ and $y$ are not in the same sequence, output `-1`.", "inputFormat": "The first line contains two integers $n,m$, representing the number of elements and the number of operations. The second line contains $n$ integers, which are $a_i$.\n\nThe next $m$ lines each describe one operation, in one of the following forms: `M x y`, `D x`, or `Q x y`, corresponding to the description.", "outputFormat": "For each `Q x y`, output one integer, the sum of the values of all elements in the queried range.", "hint": "(The problem setter kindly provided a larger sample!)\n\n**[Sample $1$ Explanation]**\n\nAt the beginning there are $5$ sequences (each row is one sequence), arranged as:\n```\n1\n2\n3\n4\n5\n```\n\nThe first operation puts $1$ after $4$, becoming:\n```\n2\n3\n4,1\n5\n```\n\nThe second operation puts $3$ after $2$, becoming:\n```\n2,3\n4,1\n5\n```\n\nThen query the sum between the $5$-th element and the $2$-nd element. Since it does not exist, output `-1`.\n\nAppend the sequence containing $3$ after the sequence containing $4$, becoming:\n```\n4,1,2,3\n5\n```\n\nNext it becomes $5,4,1,2,3$, i.e. all elements are in $1$ sequence, so the next two merge operations are useless. Then delete the numbers after $1$, becoming:\n```\n1,2,3\n5,4\n```\n\nQuery $2$ to $2$, output $a_2$, which is $55352$.\n\nQuery $2$ to $1$, output $a_2+a_1$, which is $113122$.\n\n**[Constraints]**\n\n![](https://cdn.luogu.com.cn/upload/pic/30577.png)\n\n~~To avoid some messy tricks (maybe it cannot be avoided anyway)~~, **the first $5$ points are scored in the traditional way, $10$ points per test point; the last five points are bundled as a subtask: you must pass all of them to get $50$ points, otherwise you get $0$ points.**\n\nFor all testdata, $1 \\le x,y \\le n$, $1 \\le a_i \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "银河英雄传说V2", "background": "小 H 昨天看到了 [luogu P1196](https://www.luogu.com.cn/problem/P1196) 这一题，触发了他内心中对英雄的感慨/雾。可是无奈他不会这一题，只好去请教小 W。在讲完那一题之后，小 W 灵机一动——不如改一下这道题吧。\n\n于是，一个很水的签到题出现了。", "description": "某 dalao：把题目说简单一点，方便让我一分钟 A 掉！\n\n于是小 W 只好把题意简化一下：\n\n给定 $n$ 个长度为 $1$ 的序列，第 $i$ 个序列中有一个元素，值为 $a_i$，接下来有三种操作：\n\n1. `M x y`，表示把 $x$ 所在的序列放到 $y$ 所在的序列之后。如果 $x,y$　已经在同一个序列，则不进行操作。\n2. `D x`，表示把 $x$ 所在的序列中从 $x$ 处断开，也就是把 $x$ 及 $x$ 之后的元素单独取出来作为一个序列。\n3. `Q x y`，表示查询 $x$ 到 $y$ 之间（包括x和y）所有元素的值之和。如果 $x$ 和 $y$ 不在同一个序列之中，输出 `-1`.", "inputFormat": "第一行为两个数 $n,m$，分别代表元素个数和操作次数。第二行有 $n$ 个数，为 $a_i$。\n接下来m行，每行包括三种情况：`M x y`，`D x` 或 `Q x y`，与题目描述对应。", "outputFormat": "对于每一个 `Q x y`，输出一个数，表示所有元素的值之和。", "hint": "（出题人非常良心地给了一个大一点的样例！）\n\n**【样例 $1$ 解释】**\n\n首先有 $5$ 个序列（一个横排为一个序列），排列如下：\n```\n1\n2\n3\n4\n5\n```\n\n第一个操作将 $1$ 放到 $4$ 的后面，变成\n```\n2\n3\n4,1\n5\n```\n\n第二个操作将 $3$ 放到 $2$ 后面，变成\n```\n2,3\n4,1\n5\n````\n\n然后查询第 $5$ 个元素到第 $2$ 个元素之间的和，由于不存在，输出 `-1`；\n\n将 $3$ 所在的序列加到 $4$ 所在的序列后面，变成\n```\n4,1,2,3\n5\n```\n\n接下来变成了 $5,4,1,2,3$，也就是所有元素都在 $1$ 个序列了，因此接下来的两个合并操作没有用了，然后把 $1$ 之后的数字删除，变成：\n\n```\n1,2,3\n5,4\n```\n\n查询 $2$ 到 $2$，输出 $a_2$，也就是 $55352$；\n\n查询 $2$ 到 $1$，输出 $a_2+a_1$，也就是 $113122$.\n\n**【数据范围】**\n\n![](https://cdn.luogu.com.cn/upload/pic/30577.png)\n\n~~为了避免某些乱搞（可能避免不了）~~，**前 $5$ 个点按照传统方式计分，每个测试点 $10$ 分；后五个点为 subtask 捆绑测试，必须全部通过才能得 $50$ 分，否则不得分。**\n\n对于所有数据，$1 \\le x,y \\le n，1 \\le a_i \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P4848", "type": "P", "difficulty": 7, "samples": [["10 7\n1 1 1 1\n1 2 2 3\n1 4 1 2\n1 3 4 4\n2 1 1 4 1 3\n2 2 2 3 5 4\n2 2 1 4 4 2", "NAIVE!ORZzyz.\nNAIVE!ORZzyz.\n3"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": [], "title": "崂山白花蛇草水", "background": null, "description": "神犇 Aleph 在 SDOI Round2 前立了一个 flag：如果进了省队，就现场直播喝崂山白花蛇草水。凭借着神犇 Aleph 的实力，他轻松地进了山东省省队，现在便是他履行诺言的时候了。蒟蒻 Bob 特地为他准备了 999,999,999,999,999,999 瓶崂山白花蛇草水，想要灌神犇 Aleph。神犇 Aleph 求（跪着的）蒟蒻 Bob 不要灌他，由于神犇 Aleph 是神犇，蒟蒻 Bob 最终答应了他的请求，但蒟蒻 Bob 决定将计就计，也让神犇 Aleph 回答一些问题。\n\n具体说来，蒟蒻 Bob 会在一个宽敞的广场上放置一些崂山白花蛇草水（可视为二维平面上的一些整点），然后询问神犇 Aleph 在矩形区域 $x_1\\le x\\le x_2,y_1\\le y\\le y_2$ 中，崂山白花蛇草水瓶数第 $k$ 多的是多少。为了避免麻烦，蒟蒻 Bob 不会在同一个位置放置两次或两次以上的崂山白花蛇草水，但蒟蒻 Bob 想为难一下神犇 Aleph，希望他能在每次询问时立刻回\n答出答案。\n\n神犇 Aleph 不屑于做这种问题，所以把这个问题交给了你。", "inputFormat": "输入的第一行为两个正整数 $n$，$q$，表示横纵坐标的范围和蒟蒻 Bob 的操作次数（包括放置次数和询问次数）。\n\n接下来 $q$ 行，每行代表蒟蒻 Bob 的一个操作，操作格式如下：  \n首先第一个数字 $\\mathrm{type}$，表示操作种类。$\\mathrm{type}=1$ 表示放置，$\\mathrm{type}=2$ 表示询问。  \n若 $\\mathrm{type}=1$，接下来会有三个正整数 $x, y, v$，表示在坐标整点 $(x, y)$ 放置 $v$ 瓶崂山白花蛇草水。  \n若 $\\mathrm{type}=2$，接下来会有五个正整数 $x_1, y_1, x_2, y_2, k$，表示询问矩形区域 $x_1\\le x\\le x_2,y_1\\le y\\le y_2$ 中，崂山白花蛇草水瓶数第 $k$ 多的是多少。\n\n为了体现程序的在线性，你需要将每次读入的数据（除了 $\\mathrm{type}$ 值）都异或 $\\mathrm{lastans}$，其中 $\\mathrm{lastans}$ 表示上次询问的答\n案。如果上次询问的答案为 `NAIVE!ORZzyz.`（见样例输出），则将 $\\mathrm{lastans}$ 置为 $0$。初始时的 $\\mathrm{lastans}$ 为 $0$。\n初始时平面上不存在崂山白花蛇草水。", "outputFormat": "对于每个 $\\mathrm{type}=2$ 的操作，一行输出崂山白花蛇草水瓶数第 $k$ 多的是多少。若不存在第 $k$ 多的瓶数，\n请输出 `NAIVE!ORZzyz.`。", "hint": "对于所有数据，$n\\le500000$，$q\\le100000$，$1\\le x, y\\le n$，$1\\le v\\le 10^9$，$1\\le x_1\\le x_2\\le n$，$1\\le y_1\\le y_2\\le n$，$1\\le k\\le q$。", "locale": "zh-CN", "translations": {"en": {"title": "Laoshan Baihua Shecao Water", "background": "", "description": "Ace (shenben, “神犇”) Aleph set a flag before SDOI Round 2: if he got into the provincial team, he would livestream himself drinking Laoshan Baihua Shecao Water. With his strength, Aleph easily made it into the Shandong provincial team, and now it is time for him to keep his promise. Rookie (juruo, “蒟蒻”) Bob specially prepared 999,999,999,999,999,999 bottles of Laoshan Baihua Shecao Water, hoping to force Ace Aleph to drink them. Ace Aleph begged (on his knees) rookie Bob not to do that. Since Ace Aleph is an ace, rookie Bob finally agreed, but Bob decided to play along and make Aleph answer some questions.\n\nMore specifically, rookie Bob will place some Laoshan Baihua Shecao Water on a spacious square (which can be seen as some integer grid points on a 2D plane), and then ask Ace Aleph: within the rectangular region $x_1\\le x\\le x_2,y_1\\le y\\le y_2$, what is the $k$-th largest bottle count. To avoid trouble, rookie Bob will not place Laoshan Baihua Shecao Water at the same position twice or more, but he still wants to make things difficult for Ace Aleph, hoping that Aleph can answer immediately for every query.\n\nAce Aleph does not care to solve such a problem, so he hands it to you.", "inputFormat": "The first line contains two positive integers $n$ and $q$, indicating the coordinate range on both axes and the number of operations by rookie Bob (including both placements and queries).\n\nThe next $q$ lines each describe one operation by rookie Bob, in the following format:  \nThe first number is $\\mathrm{type}$, indicating the operation type. $\\mathrm{type}=1$ means a placement, and $\\mathrm{type}=2$ means a query.  \nIf $\\mathrm{type}=1$, it is followed by three positive integers $x, y, v$, meaning that $v$ bottles of Laoshan Baihua Shecao Water are placed at the integer point $(x, y)$.  \nIf $\\mathrm{type}=2$, it is followed by five positive integers $x_1, y_1, x_2, y_2, k$, meaning a query in the rectangular region $x_1\\le x\\le x_2,y_1\\le y\\le y_2$: what is the $k$-th largest bottle count.\n\nTo reflect the online nature of the program, you must XOR every value you read (except the $\\mathrm{type}$ value) with $\\mathrm{lastans}$, where $\\mathrm{lastans}$ is the answer to the previous query. If the previous query answer is `NAIVE!ORZzyz.` (see the sample output), then set $\\mathrm{lastans}$ to $0$. Initially, $\\mathrm{lastans}$ is $0$. Initially, there is no Laoshan Baihua Shecao Water on the plane.", "outputFormat": "For each operation with $\\mathrm{type}=2$, output one line: the $k$-th largest bottle count. If the $k$-th largest bottle count does not exist, output `NAIVE!ORZzyz.`.", "hint": "Constraints: For all testdata, $n\\le500000$, $q\\le100000$, $1\\le x, y\\le n$, $1\\le v\\le 10^9$, $1\\le x_1\\le x_2\\le n$, $1\\le y_1\\le y_2\\le n$, $1\\le k\\le q$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "崂山白花蛇草水", "background": null, "description": "神犇 Aleph 在 SDOI Round2 前立了一个 flag：如果进了省队，就现场直播喝崂山白花蛇草水。凭借着神犇 Aleph 的实力，他轻松地进了山东省省队，现在便是他履行诺言的时候了。蒟蒻 Bob 特地为他准备了 999,999,999,999,999,999 瓶崂山白花蛇草水，想要灌神犇 Aleph。神犇 Aleph 求（跪着的）蒟蒻 Bob 不要灌他，由于神犇 Aleph 是神犇，蒟蒻 Bob 最终答应了他的请求，但蒟蒻 Bob 决定将计就计，也让神犇 Aleph 回答一些问题。\n\n具体说来，蒟蒻 Bob 会在一个宽敞的广场上放置一些崂山白花蛇草水（可视为二维平面上的一些整点），然后询问神犇 Aleph 在矩形区域 $x_1\\le x\\le x_2,y_1\\le y\\le y_2$ 中，崂山白花蛇草水瓶数第 $k$ 多的是多少。为了避免麻烦，蒟蒻 Bob 不会在同一个位置放置两次或两次以上的崂山白花蛇草水，但蒟蒻 Bob 想为难一下神犇 Aleph，希望他能在每次询问时立刻回\n答出答案。\n\n神犇 Aleph 不屑于做这种问题，所以把这个问题交给了你。", "inputFormat": "输入的第一行为两个正整数 $n$，$q$，表示横纵坐标的范围和蒟蒻 Bob 的操作次数（包括放置次数和询问次数）。\n\n接下来 $q$ 行，每行代表蒟蒻 Bob 的一个操作，操作格式如下：  \n首先第一个数字 $\\mathrm{type}$，表示操作种类。$\\mathrm{type}=1$ 表示放置，$\\mathrm{type}=2$ 表示询问。  \n若 $\\mathrm{type}=1$，接下来会有三个正整数 $x, y, v$，表示在坐标整点 $(x, y)$ 放置 $v$ 瓶崂山白花蛇草水。  \n若 $\\mathrm{type}=2$，接下来会有五个正整数 $x_1, y_1, x_2, y_2, k$，表示询问矩形区域 $x_1\\le x\\le x_2,y_1\\le y\\le y_2$ 中，崂山白花蛇草水瓶数第 $k$ 多的是多少。\n\n为了体现程序的在线性，你需要将每次读入的数据（除了 $\\mathrm{type}$ 值）都异或 $\\mathrm{lastans}$，其中 $\\mathrm{lastans}$ 表示上次询问的答\n案。如果上次询问的答案为 `NAIVE!ORZzyz.`（见样例输出），则将 $\\mathrm{lastans}$ 置为 $0$。初始时的 $\\mathrm{lastans}$ 为 $0$。\n初始时平面上不存在崂山白花蛇草水。", "outputFormat": "对于每个 $\\mathrm{type}=2$ 的操作，一行输出崂山白花蛇草水瓶数第 $k$ 多的是多少。若不存在第 $k$ 多的瓶数，\n请输出 `NAIVE!ORZzyz.`。", "hint": "对于所有数据，$n\\le500000$，$q\\le100000$，$1\\le x, y\\le n$，$1\\le v\\le 10^9$，$1\\le x_1\\le x_2\\le n$，$1\\le y_1\\le y_2\\le n$，$1\\le k\\le q$。", "locale": "zh-CN"}}}
{"pid": "P4849", "type": "P", "difficulty": 6, "samples": [["5 5\n1 1 1 1 5\n2 2 2 2 4\n1 1 2 2 3\n3 1 3 1 10\n5 5 5 5 1", "16\n1"], ["20 1000000000\n20204201 39958379 15138434 34289618 398078390\n85600475 39563639 66410111 36702766 611878653\n36702694 1628762 125746709 79172847 611878653\n103077330 79188107 6711555 56295346 611878653\n212677316 202221253 26717633 234187985 158044893\n297040787 198938585 43827694 296390944 158044893\n109256220 180224853 267561686 65767679 472347047\n167183048 72650618 4390517 30073538 471045792\n214834767 93996707 94416376 34549122 359059039\n89445418 135311221 266840392 213735818 398078390\n343357648 61588748 188180842 396968607 144378900\n285457193 157755350 336368020 572049737 472347047\n171728638 398663231 323772972 359470762 611878653\n234684711 226541116 270561472 376433946 229386389\n293174669 58119648 352134416 262971247 144378900\n182250938 623413311 303663331 506122949 611878653\n817319765 321076346 200801449 745136845 698518241\n26356940 295529493 725103952 845588002 533478406\n510252473 498314898 168621119 519205227 472347047\n947274653 288133984 692904616 340022215 611878653\n", "1696104353\n6"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["cdq 分治", "K-D Tree"], "title": "寻找宝藏", "background": "如果时光回到从前，或许，一切只是虚无……\n\n小 W 坐着时光穿梭机到达了一个四维时空，在这里，开始了他的寻宝之旅。", "description": "整个四维时空可以看做是一个四维的网格图，小 W 在 $(1,1,1,1)$ 这个位置，出口在 $(m,m,m,m)$。但由于小 W 毕竟是外来时空的人，他的行动在这里受到了一些限制。每次他只能使四个坐标中的一个加上 $1$。也就是说，他每次只能向右，向上，向前和向*（蒟蒻的出题人想不出来怎么形容了）走一步。\n\n这个时空中有 $n$ 个宝藏，第 $i$ 个宝藏的坐标是 $(a_i,b_i,c_i,d_i)$，价值为 $v_i$。\n\n小 W 想知道，他能够拿走宝藏的最大价值和是多少。由于小 W 也是一个喜欢未雨绸缪的人，他也希望能够找到多种不同的方案使它们都可以达到最大价值和的要求。不过这个数有可能很大，输出它对 $998244353$ 取模的结果即可。\n\n注意！两个方案不同当且仅当两个方案中至少有一个宝藏选择的不同（一个位置有多个宝藏只算一种方案），如果仅仅路线不同而最终都选择了相同的宝藏不算不同的方案。\n\n（小心两个宝藏待在相同的位置哦……）", "inputFormat": "第一行两个数 $n,m$，分别代表宝藏个数和网格坐标的最大值。\n\n接下来 $n$ 行，每行 $5$ 个数，分别是 $a_i,b_i,c_i,d_i,v_i$。", "outputFormat": "输出两行，第一行是最大价值和，第二行是满足条件的方案个数对 $998244353$ 取模的结果。", "hint": "对于样例 1，最好的办法是 $(1,1,1,1)$ 慢慢走到 $(3,1,3,1)$，再慢慢走到 $(5,5,5,5)$，获得 $16$ 的价值。最好的路径只有这 $1$ 条。\n\n![Luogu](https://cdn.luogu.com.cn/upload/pic/26057.png)\n\n对于所有数据，$1\\le a_i,b_i,c_i,d_i\\le m$，$1\\le v_i\\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "Treasure Hunt.", "background": "If time could go back to the past, perhaps everything would be nothing...\n\nLittle W takes a time machine to a four-dimensional spacetime, and begins his treasure-hunting journey there.", "description": "The entire four-dimensional spacetime can be seen as a four-dimensional grid graph. Little W starts at $(1,1,1,1)$, and the exit is at $(m,m,m,m)$. However, since Little W is a visitor to this spacetime, his movement is restricted in some ways. Each time, he can only increase one of the four coordinates by $1$. That is, each step he can only move one step to the right, upward, forward, or * (the weak/problemsetter could not think of how to describe it).\n\nThere are $n$ treasures in this spacetime. The coordinates of the $i$-th treasure are $(a_i,b_i,c_i,d_i)$, and its value is $v_i$.\n\nLittle W wants to know the maximum total value of treasures he can take. Since Little W also likes to plan ahead, he also hopes to find multiple different plans that can all achieve the maximum total value. This number may be very large, so output it modulo $998244353$.\n\nNote: Two plans are different if and only if there is at least one treasure choice that is different between them (multiple treasures at the same position count as only one plan). If only the route is different but the final chosen treasures are the same, then they are not considered different plans.\n\n(Be careful: two treasures may be at the same position.)", "inputFormat": "The first line contains two integers $n,m$, representing the number of treasures and the maximum grid coordinate value.\n\nThe next $n$ lines each contain $5$ integers, which are $a_i,b_i,c_i,d_i,v_i$.", "outputFormat": "Output two lines. The first line is the maximum total value. The second line is the number of plans that satisfy the requirement, modulo $998244353$.", "hint": "For Sample 1, the best way is to move from $(1,1,1,1)$ slowly to $(3,1,3,1)$, and then slowly to $(5,5,5,5)$, obtaining a value of $16$. There is only $1$ best path.\n\n![Luogu](https://cdn.luogu.com.cn/upload/pic/26057.png)\n\nFor all testdata, $1\\le a_i,b_i,c_i,d_i\\le m$, $1\\le v_i\\le 10^9$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "寻找宝藏", "background": "如果时光回到从前，或许，一切只是虚无……\n\n小 W 坐着时光穿梭机到达了一个四维时空，在这里，开始了他的寻宝之旅。", "description": "整个四维时空可以看做是一个四维的网格图，小 W 在 $(1,1,1,1)$ 这个位置，出口在 $(m,m,m,m)$。但由于小 W 毕竟是外来时空的人，他的行动在这里受到了一些限制。每次他只能使四个坐标中的一个加上 $1$。也就是说，他每次只能向右，向上，向前和向*（蒟蒻的出题人想不出来怎么形容了）走一步。\n\n这个时空中有 $n$ 个宝藏，第 $i$ 个宝藏的坐标是 $(a_i,b_i,c_i,d_i)$，价值为 $v_i$。\n\n小 W 想知道，他能够拿走宝藏的最大价值和是多少。由于小 W 也是一个喜欢未雨绸缪的人，他也希望能够找到多种不同的方案使它们都可以达到最大价值和的要求。不过这个数有可能很大，输出它对 $998244353$ 取模的结果即可。\n\n注意！两个方案不同当且仅当两个方案中至少有一个宝藏选择的不同（一个位置有多个宝藏只算一种方案），如果仅仅路线不同而最终都选择了相同的宝藏不算不同的方案。\n\n（小心两个宝藏待在相同的位置哦……）", "inputFormat": "第一行两个数 $n,m$，分别代表宝藏个数和网格坐标的最大值。\n\n接下来 $n$ 行，每行 $5$ 个数，分别是 $a_i,b_i,c_i,d_i,v_i$。", "outputFormat": "输出两行，第一行是最大价值和，第二行是满足条件的方案个数对 $998244353$ 取模的结果。", "hint": "对于样例 1，最好的办法是 $(1,1,1,1)$ 慢慢走到 $(3,1,3,1)$，再慢慢走到 $(5,5,5,5)$，获得 $16$ 的价值。最好的路径只有这 $1$ 条。\n\n![Luogu](https://cdn.luogu.com.cn/upload/pic/26057.png)\n\n对于所有数据，$1\\le a_i,b_i,c_i,d_i\\le m$，$1\\le v_i\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P4850", "type": "P", "difficulty": 5, "samples": [["2 3\n2 7 5\n1 9 5\n", "77\n"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["搜索", "2009", "IOI", "O2优化", "记忆化搜索", "前缀和"], "title": "[IOI 2009] Raisins", "background": "IOI2009 D1T4", "description": "普罗夫迪夫的著名巧克力大师 Bonny 需要切开一板带有葡萄干的巧克力。巧克力是一个包含许多相同的方形小块的矩形。小块沿着巧克力的边排列成 $N$ 行 $M$ 列，共有 $N\\times M$ 块。每个小块上有 $1$ 个或多个葡萄干，没有葡萄干在小块的边上或者跨过两个小块。\n\n最开始，巧克力是一整块。Bonny 需要把它切成上述的 $N\\times M$ 个独立的小块。因为 Bonny 很忙，她需要她的助手 Sly Peter 帮她切。\nPeter 只能从一端到另一端切直线，并且他要为他的每一刀得到报酬。Bonny 手头没有钱，但是她有足够的葡萄干，所以她提出用葡萄干付给 Peter。Sly Peter 同意接受葡萄干，但是有下面的条件：每次他把给定的一块巧克力切成两小块，他都要得到和那块给定的巧克力上葡萄干数目相同的葡萄干。\n\nBonny 想要付给 Peter 尽可能少的葡萄干。她知道这 $n\\times m$ 个小块中每一个小块上葡萄干的数目。她可以选择递给 Peter 的巧克力的顺序，也可以告诉 Peter 如何切（横切还是竖切）以及从哪里切。请告诉 Bonny 如何把巧克力切成一个个独立的小块，使她能够付给 Sly Peter 尽可能少的葡萄干。\n\n**任务**：编写一个程序，给定每个小块上葡萄干的数目，计算出 Bonny 要付给 Sly Peter 的最少的葡萄干的数目。", "inputFormat": "第一行两个由空格隔开的整数 $N, M$，分别表示巧克力的行数和列数。\n\n接下来 $N$ 行描述了每个小块上葡萄干的数目。其中第 $k$ 行描述了第 $k$ 行小块的巧克力。每行包含 $m$ 个整数，分别以一个空格隔开。这些整数描述了该行从左到右的小块。第 $k$ 行的第 $p$ 个整数表示位于第 $k$ 行第 $p$ 列的小块上的葡萄干数目 $R_{k, p}$。", "outputFormat": "一行一个整数，表示 Bonny 要付给 Sly Peter 的最少的葡萄干的数目。", "hint": "### 样例解释\n\n一种可能的代价为 $77$ 的切割方案如下所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zg74ypip.png)\n\n第一次切割将第三列和剩下来的巧克力分开了。Bonny 需要付给 Peter $29$ 个葡萄干。\n\n接下来 Bonny 把较小的那一块巧克力（有两小块，每一块都有 $5$ 个葡萄干）给 Peter，要求 Peter 切成两半并支付 $10$ 个葡萄干。\n\n在此之后，Bonny 给 Peter 剩下来的最大块（分别有 $2,  7, 1, 9$ 个葡萄干在它的四个小块上）。Bonny 要求 Peter 水平切割这一块，将第一行和第二行分开并付给他 $19$ 个葡萄干。\n\n此后 Bonny 给 Peter 左上角的块，支付 $9$ 个葡萄干。最后 Bonny 要求 Peter 将左下角的块分开，支付 $10$ 个葡萄干。\n\nBonny 的总代价是 $29 + 10 + 19 + 9 + 10 = 77$ 个葡萄干。没有其它安排切割的方案有更小的代价。\n\n### 数据范围与约定\n\n- 对于 $25\\%$ 的数据，$n,m\\leq 7$。\n- 对于 $100\\%$ 的数据，$1\\leq n,m\\leq 50$，$1\\leq R_{k, p}\\leq 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[IOI 2009] Raisins", "background": "IOI 2009 D1T4.", "description": "The famous chocolatier Bonny from Plovdiv needs to cut a chocolate bar with raisins. The chocolate is a rectangle made of many identical small square pieces. These pieces are arranged along the sides of the chocolate into $N$ rows and $M$ columns, for a total of $N\\times M$ pieces. Each small piece contains $1$ or more raisins, and no raisin lies on the border of a piece or crosses between two pieces.\n\nAt the beginning, the chocolate is one whole bar. Bonny needs to cut it into the $N\\times M$ individual pieces described above. Since Bonny is very busy, she asks her assistant Sly Peter to help with the cutting.\n\nPeter can only make straight cuts from one side to the other, and he must be paid for each cut. Bonny has no money, but she has enough raisins, so she offers to pay Peter with raisins. Sly Peter agrees to accept raisins, but with the following condition: each time he cuts a given piece of chocolate into two smaller pieces, he must receive a number of raisins equal to the total number of raisins in that given piece of chocolate.\n\nBonny wants to pay Peter as few raisins as possible. She knows the number of raisins on each of the $N\\times M$ small pieces. She can choose the order in which she gives pieces of chocolate to Peter, and she can tell Peter how to cut (horizontally or vertically) and where to cut. You must help Bonny cut the chocolate into individual pieces so that she pays Sly Peter as few raisins as possible.\n\n**Task**: Write a program that, given the number of raisins on each small piece, computes the minimum number of raisins Bonny must pay Sly Peter.", "inputFormat": "The first line contains two integers $N, M$ separated by spaces, representing the number of rows and columns of the chocolate.\n\nThe next $N$ lines describe the number of raisins on each small piece. The $k$-th line describes the $k$-th row of pieces. Each line contains $M$ integers separated by single spaces. These integers describe the pieces in that row from left to right. The $p$-th integer on the $k$-th line is the number of raisins $R_{k, p}$ on the piece in row $k$ and column $p$.", "outputFormat": "Output one integer on a single line, the minimum number of raisins Bonny must pay Sly Peter.", "hint": "### Sample Explanation\n\nOne possible cutting plan with a cost of $77$ is shown below:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zg74ypip.png)\n\nThe first cut separates the third column from the rest of the chocolate. Bonny needs to pay Peter $29$ raisins.\n\nNext, Bonny gives Peter the smaller piece of chocolate (which has two small pieces, each with $5$ raisins), asks Peter to cut it into two halves, and pays $10$ raisins.\n\nAfter that, Bonny gives Peter the remaining largest piece (its four small pieces contain $2, 7, 1, 9$ raisins). Bonny asks Peter to cut this piece horizontally, separating the first row from the second row, and pays him $19$ raisins.\n\nThen Bonny gives Peter the top-left piece and pays $9$ raisins. Finally, Bonny asks Peter to split the bottom-left piece and pays $10$ raisins.\n\nBonny’s total cost is $29 + 10 + 19 + 9 + 10 = 77$ raisins. No other cutting plan has a smaller total cost.\n\n### Constraints\n\n- For $25\\%$ of the testdata, $n,m\\leq 7$.\n- For $100\\%$ of the testdata, $1\\leq n,m\\leq 50$, $1\\leq R_{k, p}\\leq 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[IOI 2009] Raisins", "background": "IOI2009 D1T4", "description": "普罗夫迪夫的著名巧克力大师 Bonny 需要切开一板带有葡萄干的巧克力。巧克力是一个包含许多相同的方形小块的矩形。小块沿着巧克力的边排列成 $N$ 行 $M$ 列，共有 $N\\times M$ 块。每个小块上有 $1$ 个或多个葡萄干，没有葡萄干在小块的边上或者跨过两个小块。\n\n最开始，巧克力是一整块。Bonny 需要把它切成上述的 $N\\times M$ 个独立的小块。因为 Bonny 很忙，她需要她的助手 Sly Peter 帮她切。\nPeter 只能从一端到另一端切直线，并且他要为他的每一刀得到报酬。Bonny 手头没有钱，但是她有足够的葡萄干，所以她提出用葡萄干付给 Peter。Sly Peter 同意接受葡萄干，但是有下面的条件：每次他把给定的一块巧克力切成两小块，他都要得到和那块给定的巧克力上葡萄干数目相同的葡萄干。\n\nBonny 想要付给 Peter 尽可能少的葡萄干。她知道这 $n\\times m$ 个小块中每一个小块上葡萄干的数目。她可以选择递给 Peter 的巧克力的顺序，也可以告诉 Peter 如何切（横切还是竖切）以及从哪里切。请告诉 Bonny 如何把巧克力切成一个个独立的小块，使她能够付给 Sly Peter 尽可能少的葡萄干。\n\n**任务**：编写一个程序，给定每个小块上葡萄干的数目，计算出 Bonny 要付给 Sly Peter 的最少的葡萄干的数目。", "inputFormat": "第一行两个由空格隔开的整数 $N, M$，分别表示巧克力的行数和列数。\n\n接下来 $N$ 行描述了每个小块上葡萄干的数目。其中第 $k$ 行描述了第 $k$ 行小块的巧克力。每行包含 $m$ 个整数，分别以一个空格隔开。这些整数描述了该行从左到右的小块。第 $k$ 行的第 $p$ 个整数表示位于第 $k$ 行第 $p$ 列的小块上的葡萄干数目 $R_{k, p}$。", "outputFormat": "一行一个整数，表示 Bonny 要付给 Sly Peter 的最少的葡萄干的数目。", "hint": "### 样例解释\n\n一种可能的代价为 $77$ 的切割方案如下所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zg74ypip.png)\n\n第一次切割将第三列和剩下来的巧克力分开了。Bonny 需要付给 Peter $29$ 个葡萄干。\n\n接下来 Bonny 把较小的那一块巧克力（有两小块，每一块都有 $5$ 个葡萄干）给 Peter，要求 Peter 切成两半并支付 $10$ 个葡萄干。\n\n在此之后，Bonny 给 Peter 剩下来的最大块（分别有 $2,  7, 1, 9$ 个葡萄干在它的四个小块上）。Bonny 要求 Peter 水平切割这一块，将第一行和第二行分开并付给他 $19$ 个葡萄干。\n\n此后 Bonny 给 Peter 左上角的块，支付 $9$ 个葡萄干。最后 Bonny 要求 Peter 将左下角的块分开，支付 $10$ 个葡萄干。\n\nBonny 的总代价是 $29 + 10 + 19 + 9 + 10 = 77$ 个葡萄干。没有其它安排切割的方案有更小的代价。\n\n### 数据范围与约定\n\n- 对于 $25\\%$ 的数据，$n,m\\leq 7$。\n- 对于 $100\\%$ 的数据，$1\\leq n,m\\leq 50$，$1\\leq R_{k, p}\\leq 1000$。", "locale": "zh-CN"}}}
{"pid": "P4851", "type": "P", "difficulty": 2, "samples": [["9 7 46 6 114 50 17 6 18 11 9118", "7"]], "limits": {"time": [233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233, 233], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "贪心", "2018", "洛谷原创"], "title": "yyf hates ganhuodong", "background": "非酋yyf知道自己太非了，于是他开始爆肝活动。yyf终于成为了一名肝帝，但他还是想尽量节省 $\\mathrm{loveca}$ 的花费，不然的话如果花了太多 $\\mathrm{loveca}$，yyf会心疼的。", "description": "给你如下 $11$ 个正整数：\n\n$a$：完成一首歌曲所能获得的活动$\\mathrm{pt}$\n\n$b$：完成一首歌曲所需的 $\\mathrm{LP}$\n\n$c$：你开始肝活动时的 $\\mathrm{LP}$ 上限\n\n$d$：你开始肝活动时的 $\\mathrm{LP}$\n\n$e$：你开始肝活动时的经验值上限\n\n$f$：你开始肝活动时的经验值\n\n$g$：打一首歌能获得的经验值\n\n$h$：升一级增加的 $\\mathrm{LP}$ 上限\n\n$k$：升一级增加的经验值上限\n\n$x$：离活动结束的剩余时间（小时）\n\n$y$：你的目标活动$\\mathrm{pt}$\n\n假设yyf打歌不需要花费时间，每打一首歌需要花费一定的 $\\mathrm{LP}$ 来获取一定的活动$\\mathrm{pt}$ 以及一定的经验值。yyf的初始活动$\\mathrm{pt}$ 为 $0$\n\n$\\mathrm{LP}$ 每小时自动恢复 $1$ 点，$\\mathrm{LP}$ 达到上限后不会自动恢复（本题不需考虑这种情况），但可以通过后文所述方式超过上限。\n\n经验值达到上限后会升级，升级时会增加 $\\mathrm{LP}$上限并恢复“新的 $\\mathrm{LP}$上限”（增加后的）点 $\\mathrm{LP}$，恢复后的 $\\mathrm{LP}$ 可以超过 $\\mathrm{LP}$ 上限，且溢出的经验值会计入下一次升级，下一次升级所需要的经验值（经验值上限）会增加。\n\n可以随时耗费一个 $\\mathrm{loveca}$ 来获得当前 $\\mathrm{LP}$上限点 $\\mathrm{LP}$（可以超过上限）。\n\n你的目标是获得大于等于 $y$ 的活动$\\mathrm{pt}$，请求出最少需要耗费多少个 $\\mathrm{loveca}$。\n\n形式化地说，你初始的 $\\mathrm{LP}$ 可以视作 $d+x$，你有两种操作：\n\n1. 设你操作前的经验值为 $\\mathrm{exp}$，$\\mathrm{LP}$上限为 $\\mathrm{LPmax}$，$\\mathrm{LP}$ 值为 $l$（当且仅当 $l \\ge b$ 时能进行操作 $1$ ），经验值上限为 $\\mathrm{EXPmax}$，则在你操作后活动$\\mathrm{pt}$ 加上 $a$ 。\n- 若 $\\mathrm{exp+g \\ge EXPmax}$，则你的剩余 $\\mathrm{LP}$值为 $l-b+\\mathrm{LPmax}+h$，经验值为 \n $\\mathrm{(exp+g)\\bmod EXPmax}$，$\\mathrm{LP}$上限加上 $h$，经验值上限加上 $k$\n- 否则你的剩余 $\\mathrm{LP}$值为 $l-b$，经验值为 $\\mathrm{exp+g}$\n\n2. 设你操作前的 $\\mathrm{LP}$上限为 $\\mathrm{LPmax}$，$\\mathrm{LP}$值为 $l$ ，则你操作后的剩余 $\\mathrm{LP}$值为 $\\mathrm{LPmax}+l$\n\n你的目标为使你的活动$\\mathrm{pt}$ 大于等于 $y$ ，请求出最少需要的操作 $2$ 数量\n\n## 由于打歌不计时间可以在活动结束的瞬间打任意次歌，即进行任意次操作1，也就是初始LP可以视作d+x", "inputFormat": "共一行，为上述所有共 $11$ 个正整数，含义如上所述", "outputFormat": "一个正整数，代表最少需要耗费的 $\\mathrm{loveca}$ 数量", "hint": "$a∈[1,10]$\n\n$b∈[5,20]$\n\n$c∈[30,50]$\n\n$d∈[5,10]$\n\n$e∈[100,200]$\n\n$f∈[1,50]$\n\n$g∈[10,20]$\n\n$h∈[5,10]$\n\n$k∈[10,20]$\n\n$x∈[10,15]$\n\n$y∈[5000,10000]$", "locale": "zh-CN", "translations": {"en": {"title": "yyf hates ganhuodong", "background": "The unlucky guy (feiqiu) yyf knows he is too unlucky, so he starts grinding the event. yyf finally becomes a hardcore grinder (gandi), but he still wants to save as much $\\mathrm{loveca}$ as possible. Otherwise, if he spends too much $\\mathrm{loveca}$, yyf will feel very bad about it.", "description": "You are given the following $11$ positive integers:\n\n$a$: the event $\\mathrm{pt}$ gained by completing one song.\n\n$b$: the $\\mathrm{LP}$ required to complete one song.\n\n$c$: the initial $\\mathrm{LP}$ cap when you start grinding the event.\n\n$d$: the initial $\\mathrm{LP}$ when you start grinding the event.\n\n$e$: the initial experience cap when you start grinding the event.\n\n$f$: the initial experience when you start grinding the event.\n\n$g$: the experience gained from playing one song.\n\n$h$: the increase in the $\\mathrm{LP}$ cap when leveling up by one level.\n\n$k$: the increase in the experience cap when leveling up by one level.\n\n$x$: the remaining time until the event ends (in hours).\n\n$y$: your target event $\\mathrm{pt}$.\n\nAssume yyf can play songs without spending time. Each time you play a song, you need to spend some $\\mathrm{LP}$ to gain some event $\\mathrm{pt}$ and some experience. yyf starts with event $\\mathrm{pt}$ equal to $0$.\n\n$\\mathrm{LP}$ automatically recovers $1$ point per hour. When $\\mathrm{LP}$ reaches the cap, it will not recover automatically (you do not need to consider this situation in this problem), but it can exceed the cap using the method described later.\n\nWhen experience reaches the cap, you level up. When leveling up, your $\\mathrm{LP}$ cap increases and you recover “the new $\\mathrm{LP}$ cap” (after the increase) points of $\\mathrm{LP}$. The recovered $\\mathrm{LP}$ can exceed the $\\mathrm{LP}$ cap. Any overflow experience is carried over to the next level-up, and the required experience for the next level-up (the experience cap) will increase.\n\nYou can spend one $\\mathrm{loveca}$ at any time to gain $\\mathrm{LP}$ equal to your current $\\mathrm{LP}$ cap (this can exceed the cap).\n\nYour goal is to obtain event $\\mathrm{pt}$ greater than or equal to $y$. Find the minimum number of $\\mathrm{loveca}$ you need to spend.\n\nFormally, your initial $\\mathrm{LP}$ can be considered as $d+x$. You have two operations:\n\n1. Let the experience before the operation be $\\mathrm{exp}$, the $\\mathrm{LP}$ cap be $\\mathrm{LPmax}$, the current $\\mathrm{LP}$ be $l$ (you can perform operation $1$ if and only if $l \\ge b$), and the experience cap be $\\mathrm{EXPmax}$. After this operation, event $\\mathrm{pt}$ increases by $a$.\n- If $\\mathrm{exp+g \\ge EXPmax}$, then the remaining $\\mathrm{LP}$ becomes $l-b+\\mathrm{LPmax}+h$, the experience becomes $\\mathrm{(exp+g)\\bmod EXPmax}$, the $\\mathrm{LP}$ cap increases by $h$, and the experience cap increases by $k$.\n- Otherwise, the remaining $\\mathrm{LP}$ becomes $l-b$, and the experience becomes $\\mathrm{exp+g}$.\n\n2. Let the $\\mathrm{LP}$ cap before the operation be $\\mathrm{LPmax}$ and the current $\\mathrm{LP}$ be $l$. After this operation, the remaining $\\mathrm{LP}$ becomes $\\mathrm{LPmax}+l$.\n\nYour goal is to make your event $\\mathrm{pt}$ greater than or equal to $y$. Find the minimum number of times you need to perform operation $2$.\n\nSince playing songs does not take time, you can play any number of songs at the exact moment the event ends, i.e. you can perform operation $1$ any number of times. Therefore, the initial $\\mathrm{LP}$ can be considered as $d+x$.", "inputFormat": "A single line containing the above $11$ positive integers, with meanings as described above.", "outputFormat": "A single positive integer, representing the minimum number of $\\mathrm{loveca}$ that must be spent.", "hint": "$a∈[1,10]$\n\n$b∈[5,20]$\n\n$c∈[30,50]$\n\n$d∈[5,10]$\n\n$e∈[100,200]$\n\n$f∈[1,50]$\n\n$g∈[10,20]$\n\n$h∈[5,10]$\n\n$k∈[10,20]$\n\n$x∈[10,15]$\n\n$y∈[5000,10000]$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "yyf hates ganhuodong", "background": "非酋yyf知道自己太非了，于是他开始爆肝活动。yyf终于成为了一名肝帝，但他还是想尽量节省 $\\mathrm{loveca}$ 的花费，不然的话如果花了太多 $\\mathrm{loveca}$，yyf会心疼的。", "description": "给你如下 $11$ 个正整数：\n\n$a$：完成一首歌曲所能获得的活动$\\mathrm{pt}$\n\n$b$：完成一首歌曲所需的 $\\mathrm{LP}$\n\n$c$：你开始肝活动时的 $\\mathrm{LP}$ 上限\n\n$d$：你开始肝活动时的 $\\mathrm{LP}$\n\n$e$：你开始肝活动时的经验值上限\n\n$f$：你开始肝活动时的经验值\n\n$g$：打一首歌能获得的经验值\n\n$h$：升一级增加的 $\\mathrm{LP}$ 上限\n\n$k$：升一级增加的经验值上限\n\n$x$：离活动结束的剩余时间（小时）\n\n$y$：你的目标活动$\\mathrm{pt}$\n\n假设yyf打歌不需要花费时间，每打一首歌需要花费一定的 $\\mathrm{LP}$ 来获取一定的活动$\\mathrm{pt}$ 以及一定的经验值。yyf的初始活动$\\mathrm{pt}$ 为 $0$\n\n$\\mathrm{LP}$ 每小时自动恢复 $1$ 点，$\\mathrm{LP}$ 达到上限后不会自动恢复（本题不需考虑这种情况），但可以通过后文所述方式超过上限。\n\n经验值达到上限后会升级，升级时会增加 $\\mathrm{LP}$上限并恢复“新的 $\\mathrm{LP}$上限”（增加后的）点 $\\mathrm{LP}$，恢复后的 $\\mathrm{LP}$ 可以超过 $\\mathrm{LP}$ 上限，且溢出的经验值会计入下一次升级，下一次升级所需要的经验值（经验值上限）会增加。\n\n可以随时耗费一个 $\\mathrm{loveca}$ 来获得当前 $\\mathrm{LP}$上限点 $\\mathrm{LP}$（可以超过上限）。\n\n你的目标是获得大于等于 $y$ 的活动$\\mathrm{pt}$，请求出最少需要耗费多少个 $\\mathrm{loveca}$。\n\n形式化地说，你初始的 $\\mathrm{LP}$ 可以视作 $d+x$，你有两种操作：\n\n1. 设你操作前的经验值为 $\\mathrm{exp}$，$\\mathrm{LP}$上限为 $\\mathrm{LPmax}$，$\\mathrm{LP}$ 值为 $l$（当且仅当 $l \\ge b$ 时能进行操作 $1$ ），经验值上限为 $\\mathrm{EXPmax}$，则在你操作后活动$\\mathrm{pt}$ 加上 $a$ 。\n- 若 $\\mathrm{exp+g \\ge EXPmax}$，则你的剩余 $\\mathrm{LP}$值为 $l-b+\\mathrm{LPmax}+h$，经验值为 \n $\\mathrm{(exp+g)\\bmod EXPmax}$，$\\mathrm{LP}$上限加上 $h$，经验值上限加上 $k$\n- 否则你的剩余 $\\mathrm{LP}$值为 $l-b$，经验值为 $\\mathrm{exp+g}$\n\n2. 设你操作前的 $\\mathrm{LP}$上限为 $\\mathrm{LPmax}$，$\\mathrm{LP}$值为 $l$ ，则你操作后的剩余 $\\mathrm{LP}$值为 $\\mathrm{LPmax}+l$\n\n你的目标为使你的活动$\\mathrm{pt}$ 大于等于 $y$ ，请求出最少需要的操作 $2$ 数量\n\n## 由于打歌不计时间可以在活动结束的瞬间打任意次歌，即进行任意次操作1，也就是初始LP可以视作d+x", "inputFormat": "共一行，为上述所有共 $11$ 个正整数，含义如上所述", "outputFormat": "一个正整数，代表最少需要耗费的 $\\mathrm{loveca}$ 数量", "hint": "$a∈[1,10]$\n\n$b∈[5,20]$\n\n$c∈[30,50]$\n\n$d∈[5,10]$\n\n$e∈[100,200]$\n\n$f∈[1,50]$\n\n$g∈[10,20]$\n\n$h∈[5,10]$\n\n$k∈[10,20]$\n\n$x∈[10,15]$\n\n$y∈[5000,10000]$", "locale": "zh-CN"}}}
{"pid": "P4852", "type": "P", "difficulty": 6, "samples": [["3 3 3 3\n2 7 1 4 5 3 6 8 5 1 2 9", "36\n2 5 9"], ["2 5 2 2\n7 3 3 7 7 5 1 10 2", "41\n2 6 "]], "limits": {"time": [912, 912, 912, 912, 912, 912, 912, 912, 912, 912, 912], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "2018", "单调队列", "洛谷原创", "Special Judge", "凸完全单调性（wqs 二分）", "前缀和", "队列"], "title": "yyf hates choukapai", "background": "非酋 yyf 总是抽不到自己想要的卡，因此还十分讨厌抽卡。但玩 sif 不可能不抽卡，于是他去请教了一下欧皇 dew。dew 告诉了他关于抽卡的秘密，然而 yyf 还是不知道如何让自己欧气尽量地大，于是他找到了你。", "description": "dew 告诉 yyf，人在抽每张卡时欧气值都是固定的，第 $i$ 张卡的欧气值为 $a_i$，而在连抽时，欧气值等于第一张卡的欧气值。\n\n“每次抽卡的欧气之和”指每次单抽的欧气之和加上每次连抽的欧气之和，一次连抽的欧气不加权，只计算一次。\n\nyyf 想 $c$ 连抽（连续抽 $c$ 张卡）$n$ 次，单抽 $m$ 次，因为一直单抽太累，**yyf 不想连续单抽超过 $d$ 次（可以连续单抽恰好 $d$ 次）**。共有 $c\\times n+m$ 张卡，抽卡的顺序不能改变，每张卡都必须且只能抽一次，只能改变哪几张卡连抽、哪几张卡单抽。那么 yyf 每次抽卡的欧气之和最多能达到多少，又如何实现呢？", "inputFormat": "第 $1$ 行 $4$ 个正整数 $n,m,c,d$。\n\n第 $2$ 行 $c\\times n+m$ 个正整数，其中第 $i$ 个正整数 $a_i$ 代表第 $i$ 张卡的欧气值。", "outputFormat": "第 $1$ 行一个正整数代表 yyf 每次抽卡的欧气之和的最大值。\n\n第 $2$ 行 $n$ 个正整数代表每次连抽的第一张卡的编号，如果有多种方案满足要求任意输出一种（如果不会输出方案也请在第二行随意输出 $n$ 个整数，否则可能 $0$ 分）。\n\n方案请升序输出。", "hint": "$20\\%$ 的数据有 $1 \\le n \\le 5$，$1 \\le m \\le 5$，$2 \\le c \\le 5$。\n\n$50\\%$ 的数据有 $1 \\le n \\le 40$，$1 \\le m \\le 200$，$2 \\le c \\le 20$。\n\n另有 $20\\%$ 的数据有 $d=m$。\n\n$100\\%$ 的数据有 $1 \\le n \\le 40$，$1 \\le m \\le 80000$，$2 \\le c \\le 3000$，$1 \\le a_i \\le 10000$，$1 \\le d \\le m$，$d\\times (n+1) \\ge m$。\n\n共 $10$ 个测试点，每个测试点答案错误 $0$ 分，答案正确方案错误 $6$ 分，答案正确方案正确 $10$ 分。\n\n样例解释：输出的方案就是样例解释了 QAQ。\n\n样例一：单抽 $1$，连抽 $2\\sim 4$，连抽 $5\\sim 7$，单抽 $8$，连抽 $9\\sim 11$，单抽 $12$，欧气值总和为 $2+7+5+8+5+9=36$。\n\n样例二：单抽 $1$，连抽 $2\\sim 3$，单抽 $4$，单抽 $5$，连抽 $6\\sim 7$，单抽 $8$，单抽 $9$，欧气值总和为 $7+3+7+7+5+10+2=41$。\n\n可以证明在满足条件的情况下上述两种方案是欧气值总和最大的。", "locale": "zh-CN", "translations": {"en": {"title": "yyf hates choukapai", "background": "Unlucky yyf can never draw the cards he wants, so he also really hates drawing cards. But when playing sif, it is impossible to avoid drawing cards, so he went to consult the lucky dew. dew told him the secret of drawing cards, but yyf still did not know how to make his luck as high as possible, so he came to you.", "description": "dew tells yyf that when a person draws each card, the luck value is fixed. The luck value of the $i$-th card is $a_i$. When doing a consecutive draw, the luck value equals the luck value of the first card in that consecutive draw.\n\n“The sum of luck for each draw operation” means: the sum of luck from every single draw plus the sum of luck from every consecutive draw. For one consecutive draw, its luck is not weighted; it is counted only once.\n\nyyf wants to do $c$-card consecutive draws (draw $c$ consecutive cards) for $n$ times, and single draws for $m$ times. Because doing single draws all the time is too tiring, **yyf does not want to do more than $d$ consecutive single draws (doing exactly $d$ consecutive single draws is allowed)**. There are $c \\times n + m$ cards in total. The drawing order cannot be changed. Each card must be drawn exactly once. You may only change which cards are drawn as consecutive draws and which are drawn as single draws. Then, what is the maximum possible sum of luck for all draw operations, and how can it be achieved?", "inputFormat": "Line $1$ contains $4$ positive integers $n, m, c, d$.\n\nLine $2$ contains $c \\times n + m$ positive integers, where the $i$-th integer $a_i$ represents the luck value of the $i$-th card.", "outputFormat": "Line $1$ outputs one positive integer representing the maximum possible sum of luck for yyf’s draw operations.\n\nLine $2$ outputs $n$ positive integers representing the indices of the first card of each consecutive draw. If there are multiple valid solutions, output any one. (If you cannot output a solution, please still output any $n$ integers on the second line, otherwise you may get $0$ points.)\n\nOutput the indices in increasing order.", "hint": "For $20\\%$ of the testdata, $1 \\le n \\le 5$, $1 \\le m \\le 5$, $2 \\le c \\le 5$.\n\nFor $50\\%$ of the testdata, $1 \\le n \\le 40$, $1 \\le m \\le 200$, $2 \\le c \\le 20$.\n\nAnother $20\\%$ of the testdata has $d = m$.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 40$, $1 \\le m \\le 80000$, $2 \\le c \\le 3000$, $1 \\le a_i \\le 10000$, $1 \\le d \\le m$, $d \\times (n + 1) \\ge m$.\n\nThere are $10$ test points in total. For each test point: if the answer is wrong, you get $0$ points; if the answer is correct but the plan is wrong, you get $6$ points; if both the answer and the plan are correct, you get $10$ points.\n\nSample explanation: the output plan is exactly the sample explanation QAQ.\n\nSample 1: single draw $1$, consecutive draw $2 \\sim 4$, consecutive draw $5 \\sim 7$, single draw $8$, consecutive draw $9 \\sim 11$, single draw $12$. The total luck sum is $2 + 7 + 5 + 8 + 5 + 9 = 36$.\n\nSample 2: single draw $1$, consecutive draw $2 \\sim 3$, single draw $4$, single draw $5$, consecutive draw $6 \\sim 7$, single draw $8$, single draw $9$. The total luck sum is $7 + 3 + 7 + 7 + 5 + 10 + 2 = 41$.\n\nIt can be proven that, under the constraints, the above two plans achieve the maximum possible total luck sum.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "yyf hates choukapai", "background": "非酋 yyf 总是抽不到自己想要的卡，因此还十分讨厌抽卡。但玩 sif 不可能不抽卡，于是他去请教了一下欧皇 dew。dew 告诉了他关于抽卡的秘密，然而 yyf 还是不知道如何让自己欧气尽量地大，于是他找到了你。", "description": "dew 告诉 yyf，人在抽每张卡时欧气值都是固定的，第 $i$ 张卡的欧气值为 $a_i$，而在连抽时，欧气值等于第一张卡的欧气值。\n\n“每次抽卡的欧气之和”指每次单抽的欧气之和加上每次连抽的欧气之和，一次连抽的欧气不加权，只计算一次。\n\nyyf 想 $c$ 连抽（连续抽 $c$ 张卡）$n$ 次，单抽 $m$ 次，因为一直单抽太累，**yyf 不想连续单抽超过 $d$ 次（可以连续单抽恰好 $d$ 次）**。共有 $c\\times n+m$ 张卡，抽卡的顺序不能改变，每张卡都必须且只能抽一次，只能改变哪几张卡连抽、哪几张卡单抽。那么 yyf 每次抽卡的欧气之和最多能达到多少，又如何实现呢？", "inputFormat": "第 $1$ 行 $4$ 个正整数 $n,m,c,d$。\n\n第 $2$ 行 $c\\times n+m$ 个正整数，其中第 $i$ 个正整数 $a_i$ 代表第 $i$ 张卡的欧气值。", "outputFormat": "第 $1$ 行一个正整数代表 yyf 每次抽卡的欧气之和的最大值。\n\n第 $2$ 行 $n$ 个正整数代表每次连抽的第一张卡的编号，如果有多种方案满足要求任意输出一种（如果不会输出方案也请在第二行随意输出 $n$ 个整数，否则可能 $0$ 分）。\n\n方案请升序输出。", "hint": "$20\\%$ 的数据有 $1 \\le n \\le 5$，$1 \\le m \\le 5$，$2 \\le c \\le 5$。\n\n$50\\%$ 的数据有 $1 \\le n \\le 40$，$1 \\le m \\le 200$，$2 \\le c \\le 20$。\n\n另有 $20\\%$ 的数据有 $d=m$。\n\n$100\\%$ 的数据有 $1 \\le n \\le 40$，$1 \\le m \\le 80000$，$2 \\le c \\le 3000$，$1 \\le a_i \\le 10000$，$1 \\le d \\le m$，$d\\times (n+1) \\ge m$。\n\n共 $10$ 个测试点，每个测试点答案错误 $0$ 分，答案正确方案错误 $6$ 分，答案正确方案正确 $10$ 分。\n\n样例解释：输出的方案就是样例解释了 QAQ。\n\n样例一：单抽 $1$，连抽 $2\\sim 4$，连抽 $5\\sim 7$，单抽 $8$，连抽 $9\\sim 11$，单抽 $12$，欧气值总和为 $2+7+5+8+5+9=36$。\n\n样例二：单抽 $1$，连抽 $2\\sim 3$，单抽 $4$，单抽 $5$，连抽 $6\\sim 7$，单抽 $8$，单抽 $9$，欧气值总和为 $7+3+7+7+5+10+2=41$。\n\n可以证明在满足条件的情况下上述两种方案是欧气值总和最大的。", "locale": "zh-CN"}}}
{"pid": "P4853", "type": "P", "difficulty": 6, "samples": [["4 1 1\n3 70 3\n2 20 1\n2 2 1 1", "13.82"], ["5 0 2\n2 60 1\n2 10 2\n2 2 1 1 1", "19.084"], ["5 0 0\n2 1 0 2 2", "15"]], "limits": {"time": [666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666, 666], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "递推", "2018", "洛谷原创", "Special Judge", "期望"], "title": "yyf hates dagequ", "background": "非酋yyf在dew的指点下抽到了不错的卡，但他还是太非了，对于随机触发的技能，他总是无法触发。yyf想知道自己究竟有多非，所以他请你来计算他的期望得分，与自己的得分来比较。\n\n## 此题已放宽精度限制并显示错误答案和正确答案，请不要以此面向数据", "description": "给你一些卡牌的技能，技能分为$2$种类型：\n1. 加分，每连击$c$次有$p\\%$的概率加$s$分\n2. 改判，每连击$c$次有$p\\%$的概率触发强判定效果，持续$t$个节奏图标（设连击数为$c$的倍数时为第$i$个节奏图标，则强判定效果在第$[i+1,i+t]$个节奏图标被触发）\n\n这些技能在连击数为$c$的倍数且连击数不为$0$时有概率触发，多个技能可以同时触发\n\n其中，加分技能有 $\\mathrm{score}$ 个，改判技能有 $\\mathrm{judge}$ 个\n\n再给你$n$个节奏图标（yyf是按给出的顺序击打的）yyf击打的原始（相对于“强判定效果”修正后）结果，分为$2$，$1$，$0$三种\n\n在“强判定效果”的持续期间内所有的击打结果$1$会视作击打结果$2$，击打结果$0$仍视作击打结果$0$，击打结果$2$仍视作击打结果$2$ 。下文中的“击打结果”若无说明均指修正后的击打结果。\n\n“连击数”的定义为到目前为止连续的击打结果为$2$的次数（若这次的击打结果为$2$则这次击打也算入当前的连击数，否则当前的连击数为$0$）\n\n多个“强判定效果”可以重叠，但持续时间不会叠加（设当前“强判定效果”剩余时间为 $t_1$，此时同时触发两个“强判定效果”，持续时间分别为 $t_2$ 和 $t_3$ ，则下一次击打时的“强判定效果”剩余时间为 $\\max(t_1-1,t_2,t_3)$）。\n\n一次击打的得分为这次的击打结果乘以当前的连击数加一。即：设当前的击打结果为 $x$ ，当前的连击数为 $\\mathrm{combo}$ ，则这次击打的得分为 $\\mathrm{x*(combo+1)}$\n\n最终得分为每次（共$n$次）击打的得分之和加上加分技能的加分之和\n\n请求出yyf这次打歌的期望得分", "inputFormat": "第一行三个非负整数 $\\mathrm{n\\ score\\ judge}$\n\n下面的 $\\mathrm{score}$ 行，每行三个正整数 $c\\ p\\ s$，代表一个加分技能\n\n下面的 $\\mathrm{judge}$ 行，每行三个正整数 $c\\ p\\ t$，代表一个改判技能\n\n最后一行 $n$ 个整数，每个整数都∈$[0,2]$，第 $i$ 个整数代表第 $i$ 次击打的原始结果", "outputFormat": "共一行一个实数代表yyf的期望得分，与答案的相对误差在 $10^{-5}$ 内算对", "hint": "### 数据范围\n\n对于全部的测试点，有：$5 \\le n \\le 1000$，$0 \\le \\mathrm{score} \\le 1000$，$0 \\le \\mathrm{judge} \\le 1000$，$1 \\le c \\le 5$，$1 \\le p \\le 99$，$1 \\le s \\le 10$，$1 \\le t \\le 5$。\n\n| 测试点编号 | $n$ | $\\mathrm{score}$ | $\\mathrm{judge}$ | 特殊限制 | 测试点编号 | $n$ | $\\mathrm{score}$ | $\\mathrm{judge}$ | 特殊限制 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $1000$ | $\\ \\,0\\ \\,$ | $\\ \\,0\\ \\,$ | 所有 $a_i$ 均为 $2$ | $11$ | $1000$ | $\\ \\,0\\ \\,$ | $\\ \\,9\\ \\,$ | 无 |\n| $2$ | $1000$ | $0$ | $0$ | 无 | $12$ | $1000$ | $2$ | $2$ | 无 |\n| $3$ | $1000$ | $1$ | $0$ | 无 | $13$ | $1000$ | $3$ | $3$ | 无 |\n| $4$ | $1000$ | $9$ | $0$ | 无 | $14$ | $1000$ | $3$ | $6$ | 无 |\n| $5$ | $1000$ | $1000$ | $0$ | 无 | $15$ | $1000$ | $1$ | $8$ | 所有 $c$ 均为 $1$ |\n| $6$ | $50$ | $1$ | $1$ | 无 | $16$ | $1000$ | $0$ | $9$ | 所有 $c$ 均为 $1$ |\n| $7$ | $50$ | $2$ | $2$ | 无 | $17$ | $1000$ | $1000$ | $1000$ | 所有 $c$ 均为 $1$ |\n| $8$ | $50$ | $4$ | $4$ | 无 | $18$ | $1000$ | $1000$ | $1000$ | 所有 $c$ 均为 $1$ |\n| $9$ | $50$ | $0$ | $9$ | 无 | $19$ | $1000$ | $1000$ | $1000$ | 无 |\n| $10$ | $50$ | $4$ | $5$ | 无 | $20$ | $1000$ | $1000$ | $1000$ | 无 |\n\n### 样例1解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/lc16fxxt.png)\n\n### 样例2解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rd4khzu1.png)\n\n### 样例3解释\n\n第一次4分，第二次1分，第三次0分，第四次4分，第五次6分", "locale": "zh-CN", "translations": {"en": {"title": "yyf hates dagequ", "background": "The unlucky player yyf, guided by dew, drew some pretty good cards, but he is still too unlucky. For randomly triggered skills, he always fails to trigger them. yyf wants to know how unlucky he really is, so he asks you to compute his expected score and compare it with his actual score.\n\n## The precision limit for this problem has been relaxed, and both Wrong Answer and Correct Answer are shown. Please do not design solutions based on this.", "description": "You are given some card skills. There are $2$ types of skills:\n\n1. Bonus score: every time you reach a combo of $c$, there is a $p\\%$ chance to gain $s$ points.\n2. Judgment change: every time you reach a combo of $c$, there is a $p\\%$ chance to trigger a “strong judgment effect”, lasting for $t$ rhythm icons (suppose that when the combo count is a multiple of $c$, it corresponds to the $i$-th rhythm icon; then the strong judgment effect is applied on the $[i+1,i+t]$ rhythm icons).\n\nThese skills have a chance to trigger when the combo count is a multiple of $c$ and the combo count is not $0$. Multiple skills may trigger at the same time.\n\nAmong them, there are $\\mathrm{score}$ bonus-score skills and $\\mathrm{judge}$ judgment-change skills.\n\nYou are also given $n$ rhythm icons (yyf hits them in the given order). yyf’s original (relative to the result after applying the “strong judgment effect”) hit result for each icon is one of $2$, $1$, or $0$.\n\nDuring the duration of a “strong judgment effect”, all hit results $1$ are treated as hit results $2$. Hit result $0$ is still treated as $0$, and hit result $2$ is still treated as $2$. Unless otherwise stated, “hit result” below refers to the corrected hit result.\n\nThe definition of “combo count” is the number of consecutive hit results equal to $2$ so far (if the current hit result is $2$, then this hit is also counted into the current combo; otherwise, the current combo becomes $0$).\n\nMultiple “strong judgment effects” can overlap, but their durations do not stack. (Let the remaining time of the current “strong judgment effect” be $t_1$. If two “strong judgment effects” are triggered simultaneously now, with durations $t_2$ and $t_3$, then at the next hit, the remaining time becomes $\\max(t_1-1,t_2,t_3)$.)\n\nThe score of one hit equals the hit result multiplied by the current combo plus one. That is, let the current hit result be $x$ and the current combo be $\\mathrm{combo}$, then the score of this hit is $\\mathrm{x*(combo+1)}$.\n\nThe final score is the sum of the scores of all hits (a total of $n$ hits) plus the total bonus points gained from bonus-score skills.\n\nPlease compute the expected final score for yyf in this song.", "inputFormat": "The first line contains three non-negative integers $\\mathrm{n\\ score\\ judge}$.\n\nThe next $\\mathrm{score}$ lines each contain three positive integers $c\\ p\\ s$, describing a bonus-score skill.\n\nThe next $\\mathrm{judge}$ lines each contain three positive integers $c\\ p\\ t$, describing a judgment-change skill.\n\nThe last line contains $n$ integers, each in $[0,2]$. The $i$-th integer represents the original result of the $i$-th hit.", "outputFormat": "Output one real number in a single line, representing yyf’s expected score. Your answer is accepted if the relative error is within $10^{-5}$.", "hint": "### Constraints\n\nFor all test points: $5 \\le n \\le 1000$, $0 \\le \\mathrm{score} \\le 1000$, $0 \\le \\mathrm{judge} \\le 1000$, $1 \\le c \\le 5$, $1 \\le p \\le 99$, $1 \\le s \\le 10$, $1 \\le t \\le 5$.\n\n| Test Point ID | $n$ | $\\mathrm{score}$ | $\\mathrm{judge}$ | Special Constraint | Test Point ID | $n$ | $\\mathrm{score}$ | $\\mathrm{judge}$ | Special Constraint |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $1000$ | $\\ \\,0\\ \\,$ | $\\ \\,0\\ \\,$ | All $a_i$ are $2$ | $11$ | $1000$ | $\\ \\,0\\ \\,$ | $\\ \\,9\\ \\,$ | None |\n| $2$ | $1000$ | $0$ | $0$ | None | $12$ | $1000$ | $2$ | $2$ | None |\n| $3$ | $1000$ | $1$ | $0$ | None | $13$ | $1000$ | $3$ | $3$ | None |\n| $4$ | $1000$ | $9$ | $0$ | None | $14$ | $1000$ | $3$ | $6$ | None |\n| $5$ | $1000$ | $1000$ | $0$ | None | $15$ | $1000$ | $1$ | $8$ | All $c$ are $1$ |\n| $6$ | $50$ | $1$ | $1$ | None | $16$ | $1000$ | $0$ | $9$ | All $c$ are $1$ |\n| $7$ | $50$ | $2$ | $2$ | None | $17$ | $1000$ | $1000$ | $1000$ | All $c$ are $1$ |\n| $8$ | $50$ | $4$ | $4$ | None | $18$ | $1000$ | $1000$ | $1000$ | All $c$ are $1$ |\n| $9$ | $50$ | $0$ | $9$ | None | $19$ | $1000$ | $1000$ | $1000$ | None |\n| $10$ | $50$ | $4$ | $5$ | None | $20$ | $1000$ | $1000$ | $1000$ | None |\n\n### Sample 1 Explanation\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/lc16fxxt.png)\n\n### Sample 2 Explanation\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rd4khzu1.png)\n\n### Sample 3 Explanation\n\nThe first hit scores $4$ points, the second hit scores $1$ point, the third hit scores $0$ points, the fourth hit scores $4$ points, and the fifth hit scores $6$ points.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "yyf hates dagequ", "background": "非酋yyf在dew的指点下抽到了不错的卡，但他还是太非了，对于随机触发的技能，他总是无法触发。yyf想知道自己究竟有多非，所以他请你来计算他的期望得分，与自己的得分来比较。\n\n## 此题已放宽精度限制并显示错误答案和正确答案，请不要以此面向数据", "description": "给你一些卡牌的技能，技能分为$2$种类型：\n1. 加分，每连击$c$次有$p\\%$的概率加$s$分\n2. 改判，每连击$c$次有$p\\%$的概率触发强判定效果，持续$t$个节奏图标（设连击数为$c$的倍数时为第$i$个节奏图标，则强判定效果在第$[i+1,i+t]$个节奏图标被触发）\n\n这些技能在连击数为$c$的倍数且连击数不为$0$时有概率触发，多个技能可以同时触发\n\n其中，加分技能有 $\\mathrm{score}$ 个，改判技能有 $\\mathrm{judge}$ 个\n\n再给你$n$个节奏图标（yyf是按给出的顺序击打的）yyf击打的原始（相对于“强判定效果”修正后）结果，分为$2$，$1$，$0$三种\n\n在“强判定效果”的持续期间内所有的击打结果$1$会视作击打结果$2$，击打结果$0$仍视作击打结果$0$，击打结果$2$仍视作击打结果$2$ 。下文中的“击打结果”若无说明均指修正后的击打结果。\n\n“连击数”的定义为到目前为止连续的击打结果为$2$的次数（若这次的击打结果为$2$则这次击打也算入当前的连击数，否则当前的连击数为$0$）\n\n多个“强判定效果”可以重叠，但持续时间不会叠加（设当前“强判定效果”剩余时间为 $t_1$，此时同时触发两个“强判定效果”，持续时间分别为 $t_2$ 和 $t_3$ ，则下一次击打时的“强判定效果”剩余时间为 $\\max(t_1-1,t_2,t_3)$）。\n\n一次击打的得分为这次的击打结果乘以当前的连击数加一。即：设当前的击打结果为 $x$ ，当前的连击数为 $\\mathrm{combo}$ ，则这次击打的得分为 $\\mathrm{x*(combo+1)}$\n\n最终得分为每次（共$n$次）击打的得分之和加上加分技能的加分之和\n\n请求出yyf这次打歌的期望得分", "inputFormat": "第一行三个非负整数 $\\mathrm{n\\ score\\ judge}$\n\n下面的 $\\mathrm{score}$ 行，每行三个正整数 $c\\ p\\ s$，代表一个加分技能\n\n下面的 $\\mathrm{judge}$ 行，每行三个正整数 $c\\ p\\ t$，代表一个改判技能\n\n最后一行 $n$ 个整数，每个整数都∈$[0,2]$，第 $i$ 个整数代表第 $i$ 次击打的原始结果", "outputFormat": "共一行一个实数代表yyf的期望得分，与答案的相对误差在 $10^{-5}$ 内算对", "hint": "### 数据范围\n\n对于全部的测试点，有：$5 \\le n \\le 1000$，$0 \\le \\mathrm{score} \\le 1000$，$0 \\le \\mathrm{judge} \\le 1000$，$1 \\le c \\le 5$，$1 \\le p \\le 99$，$1 \\le s \\le 10$，$1 \\le t \\le 5$。\n\n| 测试点编号 | $n$ | $\\mathrm{score}$ | $\\mathrm{judge}$ | 特殊限制 | 测试点编号 | $n$ | $\\mathrm{score}$ | $\\mathrm{judge}$ | 特殊限制 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| $1$ | $1000$ | $\\ \\,0\\ \\,$ | $\\ \\,0\\ \\,$ | 所有 $a_i$ 均为 $2$ | $11$ | $1000$ | $\\ \\,0\\ \\,$ | $\\ \\,9\\ \\,$ | 无 |\n| $2$ | $1000$ | $0$ | $0$ | 无 | $12$ | $1000$ | $2$ | $2$ | 无 |\n| $3$ | $1000$ | $1$ | $0$ | 无 | $13$ | $1000$ | $3$ | $3$ | 无 |\n| $4$ | $1000$ | $9$ | $0$ | 无 | $14$ | $1000$ | $3$ | $6$ | 无 |\n| $5$ | $1000$ | $1000$ | $0$ | 无 | $15$ | $1000$ | $1$ | $8$ | 所有 $c$ 均为 $1$ |\n| $6$ | $50$ | $1$ | $1$ | 无 | $16$ | $1000$ | $0$ | $9$ | 所有 $c$ 均为 $1$ |\n| $7$ | $50$ | $2$ | $2$ | 无 | $17$ | $1000$ | $1000$ | $1000$ | 所有 $c$ 均为 $1$ |\n| $8$ | $50$ | $4$ | $4$ | 无 | $18$ | $1000$ | $1000$ | $1000$ | 所有 $c$ 均为 $1$ |\n| $9$ | $50$ | $0$ | $9$ | 无 | $19$ | $1000$ | $1000$ | $1000$ | 无 |\n| $10$ | $50$ | $4$ | $5$ | 无 | $20$ | $1000$ | $1000$ | $1000$ | 无 |\n\n### 样例1解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/lc16fxxt.png)\n\n### 样例2解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/rd4khzu1.png)\n\n### 样例3解释\n\n第一次4分，第二次1分，第三次0分，第四次4分，第五次6分", "locale": "zh-CN"}}}
{"pid": "P4854", "type": "P", "difficulty": 5, "samples": [["2 7\n1 2 1 14\n2 1 2 11\n2 2 1 18\n2 1 2 16\n2 1 2 12\n2 1 2 16\n2 1 3 13", "11"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "MloVtry的咸鱼树", "background": "签到~\n", "description": "俗话说种瓜得瓜，种豆得豆，MloVtry 把自己砍掉一半埋进了土里，于是它得到了一颗 $n$ 个点的咸鱼树。\n\n但是问题是由于 MloVtry 只舍得埋下一半的自己，所以这个咸鱼树是不完整的---甚至它碎裂成了 $m$ 条边。\n\n作为一条能够致癌的咸鱼，MloVtry 当然想要一颗咸鱼树来标榜自己的身份。\n\nMloVtry 大概估计出了连接两个点之间的代价，它想知道，最少需要多少代价才能拼出咸鱼树？\n\n值得注意的是，咸鱼树上的咸鱼边们对于 MloVtry 是很有意见的，所以每条边都会制定一个点集 $S$，只有 MloVtry 将 $S$ 这个特殊点集里的所有点都接入某个集合 $T$ 之后，这条边才可以被加入 $T$ 这个集合。\n\nMloVtry 把脑子埋进了地里，所以这个问题只能由你来解决了。\n", "inputFormat": "第一行 $2$ 个整数 $n,m$。\n\n接下来 $m$ 行，每行 $4$ 个整数 $u,v,S,l$，表示一条连接 $u$ 到 $v$ 的长为 $l$ 的双向边，要在已经选择了点集 $S$（这个集合用二进制数来表示，$1$ 号点对应第 $1$ 位，其余点同理）之后才能选择。\n", "outputFormat": "一行 $1$ 个整数，表示最小代价。当然，可能存在无解的情况，此时请输出 $-1$。\n", "hint": "$1\\le n\\le 15$，$1\\le m\\le n\\times (n+10)$。\n\n数据保证所有数值在 int 范围内。\n", "locale": "zh-CN", "translations": {"en": {"title": "MloVtry’s Salted Fish Tree", "background": "Sign-in~.", "description": "As the saying goes, you reap what you sow. MloVtry cut off half of itself and buried it in the ground, and thus obtained a “Salted Fish Tree” with $n$ vertices.\n\nHowever, because MloVtry only buried half of itself, this Salted Fish Tree is incomplete — it has even broken into $m$ edges.\n\nAs a salted fish that could cause cancer, MloVtry certainly wants a Salted Fish Tree to show its identity.\n\nMloVtry has roughly estimated the cost of connecting two vertices and wants to know the minimum total cost needed to assemble a Salted Fish Tree.\n\nNote that the edges on the Salted Fish Tree have strong opinions about MloVtry. Each edge specifies a vertex set $S$. Only after MloVtry has connected all vertices in this special set $S$ into some set $T$ can this edge be added to that set $T$.\n\nMloVtry buried its brain in the ground, so you have to solve this problem.", "inputFormat": "The first line contains $2$ integers $n, m$.\n\nThe next $m$ lines each contain $4$ integers $u, v, S, l$, denoting an undirected edge of length $l$ between $u$ and $v$, which can only be chosen after the vertex set $S$ has already been selected (this set is represented by a binary number; vertex $1$ corresponds to the first bit, and so on).", "outputFormat": "Output a single integer, the minimum total cost. If there is no solution, output $-1$.", "hint": "Constraints: $1 \\le n \\le 15$, $1 \\le m \\le n \\times (n+10)$.\n\nThe testdata guarantees that all values are within the range of a 32-bit int.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "MloVtry的咸鱼树", "background": "签到~\n", "description": "俗话说种瓜得瓜，种豆得豆，MloVtry 把自己砍掉一半埋进了土里，于是它得到了一颗 $n$ 个点的咸鱼树。\n\n但是问题是由于 MloVtry 只舍得埋下一半的自己，所以这个咸鱼树是不完整的---甚至它碎裂成了 $m$ 条边。\n\n作为一条能够致癌的咸鱼，MloVtry 当然想要一颗咸鱼树来标榜自己的身份。\n\nMloVtry 大概估计出了连接两个点之间的代价，它想知道，最少需要多少代价才能拼出咸鱼树？\n\n值得注意的是，咸鱼树上的咸鱼边们对于 MloVtry 是很有意见的，所以每条边都会制定一个点集 $S$，只有 MloVtry 将 $S$ 这个特殊点集里的所有点都接入某个集合 $T$ 之后，这条边才可以被加入 $T$ 这个集合。\n\nMloVtry 把脑子埋进了地里，所以这个问题只能由你来解决了。\n", "inputFormat": "第一行 $2$ 个整数 $n,m$。\n\n接下来 $m$ 行，每行 $4$ 个整数 $u,v,S,l$，表示一条连接 $u$ 到 $v$ 的长为 $l$ 的双向边，要在已经选择了点集 $S$（这个集合用二进制数来表示，$1$ 号点对应第 $1$ 位，其余点同理）之后才能选择。\n", "outputFormat": "一行 $1$ 个整数，表示最小代价。当然，可能存在无解的情况，此时请输出 $-1$。\n", "hint": "$1\\le n\\le 15$，$1\\le m\\le n\\times (n+10)$。\n\n数据保证所有数值在 int 范围内。\n", "locale": "zh-CN"}}}
{"pid": "P4855", "type": "P", "difficulty": 6, "samples": [["13 12 56\n10100 12208 11766 11872 11336 10815 10710 11872 11536 11988 10100 10908 10815 \n11 13\n1 3\n3 10\n1 7\n8 4\n7 11\n11 4\n5 2\n13 11\n13 6\n3 11\n11 10", "10044\n11932\n10918\n11280\n10044\n10759\n10827\n11874\n12152\n10759\n10044\n10713"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": [], "title": "MloVtry的idea", "background": "点击～\n", "description": "MloVtry是一个脑洞很大的人，它总会想出一些奇奇怪怪的idea。\n\n可问题是，MloVtry作为一个蒟蒻，很多时候都没办法解决自己提出的问题，所以MloVtry想出一套题的梦想一直被搁置。\n\n不过好在MloVtry有一些神犇朋友，他们强的没边，所以MloVtry一有机会就会向这些dalao们请教。\n\n现在MloVtry有n个idea，这n个idea在MloVtry二维的大脑里排成一列，每一个idea都有一个难度值，用a[i]表示，当然难度值越大越困难。\n\nMloVtry准备与q个神犇进行交♂易，但是MloVtry不想问一些过于简单的idea来降自己的B格，又不好意思用太难的、无法解决的idea来伤害自己与神犇之间的感情，所以它每次都会挑idea序列中的第k简单的idea来向神犇询问（也就是难度值第k小的那个idea）。\n\nMloVtry的脑子有坑，但是没关系，这个坑会反而会帮助MloVtry思考，不过这样数列的a[i]就会更新，具体的，设坑在第j个idea上，那么a[i]=a[i]-zz(i<=j);a[i]=i+a[i]-j(i>j)。\n\n如果仅仅如此MloVtry也不会感到迷茫，但关键的是这个坑还会不定时的跳跃，这就让MloVtry手足无措了---它不知道这个时候要问哪个问题了。\n\n现在MloVtry会给出你---它最好的朋友一些询问---一些二元组（at，k），表示脑洞位于at，且它想询问第k简单的idea，请你告诉MloVtry这个idea难度是多少。\n", "inputFormat": "第一行三个整数n,q,zz，含义见题面\n\n第二行n个整数a[1],a[2].....a[n]\n\n随后q行，每行两个整数表示at与k\n\n特别的，MloVtry是一个三维生物，所以它无法想象有人可以在时间轴上翻滚，所以at与k与上一个询问的答案的绝对值的异或值并对n取膜后再+1的值为本次的at和k。\n\n（也就是设lastans为上次询问答案，每一次at=(at^abs(lastans))%n+1,k=(k^abs(lastans))%n+1,并将lastans更新，初始lastans=0）\n", "outputFormat": "q行q个整数，表示对每个询问的回答\n", "hint": "各个值保证在int范围内。\n\n对于100%的数据，n,q<=6w。\n\n对于40%的数据，n,q<=1000。\n\nPS.可能有重复，例如\n\n1 1 1 1 1 0\n\n此时第1大、第2大....第5大的值都是1，第6大的值是0\n", "locale": "zh-CN", "translations": {"en": {"title": "MloVtry's Idea", "background": "Click ~.", "description": "MloVtry is very imaginative and often comes up with all kinds of strange ideas. However, as a \"jun ruo\" (noob), MloVtry often cannot solve the problems he proposes, so his dream of preparing a full problem set has been on hold.\n\nFortunately, MloVtry has some very strong friends (\"dalao\"), so he always asks them for help whenever he can.\n\nNow MloVtry has $n$ ideas arranged in a line in his 2D brain. Each idea has a difficulty value $a[i]$; larger values mean harder problems.\n\nMloVtry plans to consult $q$ experts, but he does not want to lower his standards by asking about ideas that are too easy, nor does he want to strain his relationships by asking about ideas that are too hard. Therefore, each time he will ask about the $k$-th easiest idea in the sequence (i.e., the idea with the $k$-th smallest difficulty).\n\nMloVtry has a “pit” in his brain. Oddly enough, this pit helps him think, but it causes the sequence $a[i]$ to be updated. Specifically, suppose the pit is at the $j$-th idea; then define a transformed array $b[i]$ by\n- if $i \\le j$, then $b[i] = a[i] - zz$;\n- if $i > j$, then $b[i] = i + a[i] - j$.\n\nIf that were all, MloVtry would not be confused. The problem is that the pit jumps unpredictably, so he does not know which idea to ask about at any given time.\n\nNow MloVtry gives you several queries—each is a pair $(at, k)$, meaning the pit is at position $at$, and he wants to ask about the $k$-th easiest idea. Please tell MloVtry what that idea’s difficulty is, i.e., the $k$-th smallest value in the transformed array $b$ defined by the current pit position.\n\nTo prevent “time-axis rolling,” the input $(at, k)$ for each query is obfuscated using the last answer. Let $lastans$ be the answer to the previous query (with $lastans = 0$ initially). For each query, before using $at$ and $k$, update them as follows:\n$at = ((at \\oplus |lastans|) \\bmod n) + 1$, \n$k = ((k \\oplus |lastans|) \\bmod n) + 1$,\nthen compute the answer and set $lastans$ to this answer.\n\nAll arrays are 1-indexed.", "inputFormat": "- The first line contains three integers $n$, $q$, $zz$.\n- The second line contains $n$ integers $a[1], a[2], \\dots, a[n]$.\n- The next $q$ lines each contain two integers $at$ and $k$. For each query, first transform the given $at$ and $k$ using $lastans$ as:\n  $at = ((at \\oplus |lastans|) \\bmod n) + 1$, \n  $k = ((k \\oplus |lastans|) \\bmod n) + 1$,\n  where $lastans$ is the previous query’s answer (with $lastans = 0$ initially).", "outputFormat": "Output $q$ lines, each containing one integer: the answer to each query.", "hint": "- All values fit in the 32-bit signed integer range.\n- For 100% of the testdata, $n, q \\le 60000$.\n- For 40% of the testdata, $n, q \\le 1000$.\n- There may be duplicate values. For example, for the array\n  1 1 1 1 1 0\n  the 1st smallest value is $0$, and the 2nd through 6th smallest values are all $1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "MloVtry的idea", "background": "点击～\n", "description": "MloVtry是一个脑洞很大的人，它总会想出一些奇奇怪怪的idea。\n\n可问题是，MloVtry作为一个蒟蒻，很多时候都没办法解决自己提出的问题，所以MloVtry想出一套题的梦想一直被搁置。\n\n不过好在MloVtry有一些神犇朋友，他们强的没边，所以MloVtry一有机会就会向这些dalao们请教。\n\n现在MloVtry有n个idea，这n个idea在MloVtry二维的大脑里排成一列，每一个idea都有一个难度值，用a[i]表示，当然难度值越大越困难。\n\nMloVtry准备与q个神犇进行交♂易，但是MloVtry不想问一些过于简单的idea来降自己的B格，又不好意思用太难的、无法解决的idea来伤害自己与神犇之间的感情，所以它每次都会挑idea序列中的第k简单的idea来向神犇询问（也就是难度值第k小的那个idea）。\n\nMloVtry的脑子有坑，但是没关系，这个坑会反而会帮助MloVtry思考，不过这样数列的a[i]就会更新，具体的，设坑在第j个idea上，那么a[i]=a[i]-zz(i<=j);a[i]=i+a[i]-j(i>j)。\n\n如果仅仅如此MloVtry也不会感到迷茫，但关键的是这个坑还会不定时的跳跃，这就让MloVtry手足无措了---它不知道这个时候要问哪个问题了。\n\n现在MloVtry会给出你---它最好的朋友一些询问---一些二元组（at，k），表示脑洞位于at，且它想询问第k简单的idea，请你告诉MloVtry这个idea难度是多少。\n", "inputFormat": "第一行三个整数n,q,zz，含义见题面\n\n第二行n个整数a[1],a[2].....a[n]\n\n随后q行，每行两个整数表示at与k\n\n特别的，MloVtry是一个三维生物，所以它无法想象有人可以在时间轴上翻滚，所以at与k与上一个询问的答案的绝对值的异或值并对n取膜后再+1的值为本次的at和k。\n\n（也就是设lastans为上次询问答案，每一次at=(at^abs(lastans))%n+1,k=(k^abs(lastans))%n+1,并将lastans更新，初始lastans=0）\n", "outputFormat": "q行q个整数，表示对每个询问的回答\n", "hint": "各个值保证在int范围内。\n\n对于100%的数据，n,q<=6w。\n\n对于40%的数据，n,q<=1000。\n\nPS.可能有重复，例如\n\n1 1 1 1 1 0\n\n此时第1大、第2大....第5大的值都是1，第6大的值是0\n", "locale": "zh-CN"}}}
{"pid": "P4856", "type": "P", "difficulty": 0, "samples": [["10 3\n1 1 1 1 1 1 1 1 1 1\n1 2\n1 8\n1 3\n3 6\n3 7\n6 10\n2 4\n2 5\n4 9\n0 1\n1 1 2\n0 1", "16/5\n5/2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [233000, 233000, 233000, 233000, 233000, 233000, 233000, 233000, 233000, 233000]}, "tags": [], "title": "MloVtry与jump ", "background": "浏览～\n", "description": "众所周知，MloVtry有很多纸片人老婆（我永远喜欢IA.jpg），不过很可惜，并不是所有人都是死宅，所以很多人无法理解MloVtry 的兴趣。\n\nVittorio就是一个坏文明，他十分喜欢刁难MloVtry。\n\n现在Vittorio构建了一个n个点的地图，MloVtry必须穿过这张图才能prpr到它的纸片人老婆。但是穿过地图听起来就太费力气了，于是MloVtry就咬住1号点狠狠一抖，把这张图甩成了一颗有根树。\n\nMloVtry是个好文明，它有一个高科技的设备---弹力装置---来帮助自己。具体的，如果MloVtry在i号点，这个装置会把它从当前点向下弹出a[i]（这个值被称为弹力值）个距离---我们认为1号点是在上方的，并且每条边的距离是1。不过问题是MloVtry并不能准确控制自己的落点，换言之降落在哪个位置是不确定的，但是MloVtry可以肯定的是降落的点一定可以让它不拐弯的走回出发的点（也就是只能落在子树内）---它一向认为自己是头耿直的生物。当然，由于a[i]是个正整数，所以它一定可以跳到它老婆的身旁。\n\n现在MloVtry有几个问题，它想知道假设它从x号点出发，赶到老婆身边的期望步数是多少，不过由于化图为树这个操作太耗费能量了，所以这个问题就只能交给它最好的好朋友---您这头神犇了。\n\n但是之前说过，Vittorio是个坏文明，他对弹力装置做了些手脚，每个弹力装置只有在没有树内的落点时才会跳出。并且他可能会偷偷更换掉一些节点上的弹力装置，这可能会带来一点难度，不过您一定没问题。\n", "inputFormat": "第1行两个整数n,q，表示这个图有n个节点，并且接下来有q个操作。\n\n第2行是一行整数，表示a[i]数组的初始值。\n\n接下来n-1行，每行两个整数u，v，表示有一条连接u，v的无向边。\n\n接下来q行，每行有3~2个整数，具体的：\n\n1  x  y   表示Vittorio将x号节点上的弹力装置换成了一个弹力值为y的弹力装置。\n\n0  x      表示MloVtry想知道从x号节点出发的期望步数是多少。\n", "outputFormat": "请对每个询问输出一个分数\n\n特别的，如果分母为1也请把它输出出来\n\n（如：2/1）\n", "hint": "样例解释\n\n第一个询问\n\n1-2-4-5-out\n\n1-2-5-out\n\n1-8-out\n\n1-3-6-10-out\n\n1-3-7-out\n\n总路径数为:5\n\n总跳跃次数为:16\n\n1-4-9-out\n\n1-5-out\n\n1-6-10-out\n\n1-7-out\n\n（由于存在树内的落点，所以1-out无法行走）\n\n\n总路径数为:4\n\n总跳跃次数为:10\n\n\nn<=100000 ,q<=200000\n\n不对a[i]的值做出保证\n\n对于30%的数据，有n<=1000\n\n对于50%的数据，有n<=10000\n\n\n特殊的\n\n对于20%的数据，有a[i]=1\n\n保证最后答案在2147483647的范围之内。\n\n数据保证在window环境下随机生成。\n", "locale": "zh-CN", "translations": {"en": {"title": "MloVtry and jump", "background": "Browsing~.", "description": "As we all know, MloVtry has many 2D waifus (I will always love IA.jpg). Unfortunately, not everyone is an otaku, so many people cannot understand MloVtry’s interests.\n\nVittorio is a “bad civilization” who loves to make things hard for MloVtry.\n\nNow Vittorio has built a map with $n$ nodes. MloVtry must traverse this map to prpr his 2D waifu. But traversing the map sounds too tiring, so MloVtry bites node $1$ and shakes hard, turning the map into a rooted tree with node $1$ at the top.\n\nMloVtry is a “good civilization” and has a high-tech device — a bounce device — to help. Specifically, if MloVtry is at node $i$, the device will bounce him downward by distance $a[i]$ (this value is called the bounce value). We consider node $1$ to be the root (on top), and each edge has length $1$. However, MloVtry cannot accurately control the landing point; in other words, where he lands is uncertain. What he can be sure of is that the landing node must allow him to walk straight back to the starting node without turning (that is, he can only land within the subtree of $i$). Since $a[i]$ is a positive integer, he will definitely be able to jump to his waifu’s side.\n\nMloVtry has a few questions: he wants to know, if he starts from node $x$, what is the expected number of steps to reach his waifu. Each jump counts as one step, and when there is more than one valid landing node inside the subtree of the current node at exact distance $a[i]$, the device chooses one uniformly at random. If there is no such node inside the tree, the jump goes “out”, and the process ends. Since transforming the graph into a tree consumes too much energy, this task can only be handed to his best friend — you.\n\nBut as mentioned earlier, Vittorio is a “bad civilization”. He has tampered with the bounce devices: a bounce device only jumps “out” when there is no landing node inside the tree. He may also secretly replace the bounce device at some nodes, which may add a bit of difficulty, but you will be fine.", "inputFormat": "- The first line contains two integers $n, q$, meaning the graph has $n$ nodes and there are $q$ operations.\n- The second line contains $n$ integers, the initial values of the array $a[i]$.\n- The next $n - 1$ lines each contain two integers $u, v$, indicating an undirected edge between $u$ and $v$.\n- The next $q$ lines each describe one operation, in one of the following formats:\n  - 1 x y: Vittorio replaces the bounce device at node $x$ with a new one whose bounce value is $y$, i.e., set $a[x] = y$.\n  - 0 x: MloVtry asks for the expected number of steps starting from node $x$.", "outputFormat": "For each query, output a fraction.\n\nIn particular, even if the denominator is $1$, you should still output it. For example: 2/1.", "hint": "Sample explanation.\n\nFirst query.\n\n1-2-4-5-out.\n\n1-2-5-out.\n\n1-8-out.\n\n1-3-6-10-out.\n\n1-3-7-out.\n\nTotal number of paths: 5.\n\nTotal number of jumps: 16.\n\nSecond query.\n\n1-4-9-out.\n\n1-5-out.\n\n1-6-10-out.\n\n1-7-out.\n\n(Since there exist landing nodes inside the tree, 1-out cannot occur.)\n\nTotal number of paths: 4.\n\nTotal number of jumps: 10.\n\nConstraints\n\n- $n \\le 100000$, $q \\le 200000$.\n- No bounds are guaranteed for $a[i]$.\n- For 30% of the testdata, $n \\le 1000$.\n- For 50% of the testdata, $n \\le 10000$.\n- Special: For 20% of the testdata, $a[i] = 1$.\n- It is guaranteed that the final answer is within the range of $2147483647$.\n- The testdata is randomly generated under the Windows environment.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "MloVtry与jump ", "background": "浏览～\n", "description": "众所周知，MloVtry有很多纸片人老婆（我永远喜欢IA.jpg），不过很可惜，并不是所有人都是死宅，所以很多人无法理解MloVtry 的兴趣。\n\nVittorio就是一个坏文明，他十分喜欢刁难MloVtry。\n\n现在Vittorio构建了一个n个点的地图，MloVtry必须穿过这张图才能prpr到它的纸片人老婆。但是穿过地图听起来就太费力气了，于是MloVtry就咬住1号点狠狠一抖，把这张图甩成了一颗有根树。\n\nMloVtry是个好文明，它有一个高科技的设备---弹力装置---来帮助自己。具体的，如果MloVtry在i号点，这个装置会把它从当前点向下弹出a[i]（这个值被称为弹力值）个距离---我们认为1号点是在上方的，并且每条边的距离是1。不过问题是MloVtry并不能准确控制自己的落点，换言之降落在哪个位置是不确定的，但是MloVtry可以肯定的是降落的点一定可以让它不拐弯的走回出发的点（也就是只能落在子树内）---它一向认为自己是头耿直的生物。当然，由于a[i]是个正整数，所以它一定可以跳到它老婆的身旁。\n\n现在MloVtry有几个问题，它想知道假设它从x号点出发，赶到老婆身边的期望步数是多少，不过由于化图为树这个操作太耗费能量了，所以这个问题就只能交给它最好的好朋友---您这头神犇了。\n\n但是之前说过，Vittorio是个坏文明，他对弹力装置做了些手脚，每个弹力装置只有在没有树内的落点时才会跳出。并且他可能会偷偷更换掉一些节点上的弹力装置，这可能会带来一点难度，不过您一定没问题。\n", "inputFormat": "第1行两个整数n,q，表示这个图有n个节点，并且接下来有q个操作。\n\n第2行是一行整数，表示a[i]数组的初始值。\n\n接下来n-1行，每行两个整数u，v，表示有一条连接u，v的无向边。\n\n接下来q行，每行有3~2个整数，具体的：\n\n1  x  y   表示Vittorio将x号节点上的弹力装置换成了一个弹力值为y的弹力装置。\n\n0  x      表示MloVtry想知道从x号节点出发的期望步数是多少。\n", "outputFormat": "请对每个询问输出一个分数\n\n特别的，如果分母为1也请把它输出出来\n\n（如：2/1）\n", "hint": "样例解释\n\n第一个询问\n\n1-2-4-5-out\n\n1-2-5-out\n\n1-8-out\n\n1-3-6-10-out\n\n1-3-7-out\n\n总路径数为:5\n\n总跳跃次数为:16\n\n1-4-9-out\n\n1-5-out\n\n1-6-10-out\n\n1-7-out\n\n（由于存在树内的落点，所以1-out无法行走）\n\n\n总路径数为:4\n\n总跳跃次数为:10\n\n\nn<=100000 ,q<=200000\n\n不对a[i]的值做出保证\n\n对于30%的数据，有n<=1000\n\n对于50%的数据，有n<=10000\n\n\n特殊的\n\n对于20%的数据，有a[i]=1\n\n保证最后答案在2147483647的范围之内。\n\n数据保证在window环境下随机生成。\n", "locale": "zh-CN"}}}
{"pid": "P4857", "type": "P", "difficulty": 4, "samples": [["10 3\n3 5 6\n", "10 9 7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "二分", "堆", "PA（波兰）"], "title": "[PA 2013] Konduktorzy", "background": "", "description": "一辆无限长的列车，有 $k$ 个检票员。每个检票员一次检验 $a_i$ 个车厢，初始时所有检票员在 $0$ 号车厢。\n\n列车长每次命令最靠左的编号最小的检票员向右走 $a_i$ 步，一共发出 $n$ 个命令，输出每个售票员走的最后一步是列车长的第几次命令。", "inputFormat": "第一行两个数 $n,k$。\n\n第二行 $k$ 个数，表示每个检票员一次检验的长度 $a_i$。", "outputFormat": "一行 $k$ 个整数，每个整数表示这个售票员走到最后一步是列车长的第几次命令。", "hint": "对于 $100\\%$ 的数据，$1\\le n\\le 2\\times 10^{13}$，$1\\le k\\le 10^5$，$k\\le n$，$1\\le a_i\\le 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2013] Konduktorzy", "background": "", "description": "一辆无限长的列车，有 $k$ 个检票员。每个检票员一次检验 $a_i$ 个车厢，初始时所有检票员在 $0$ 号车厢。\n\n列车长每次命令最靠左的编号最小的检票员向右走 $a_i$ 步，一共发出 $n$ 个命令，输出每个售票员走的最后一步是列车长的第几次命令。", "inputFormat": "第一行两个数 $n,k$。\n\n第二行 $k$ 个数，表示每个检票员一次检验的长度 $a_i$。", "outputFormat": "一行 $k$ 个整数，每个整数表示这个售票员走到最后一步是列车长的第几次命令。", "hint": "对于 $100\\%$ 的数据，$1\\le n\\le 2\\times 10^{13}$，$1\\le k\\le 10^5$，$k\\le n$，$1\\le a_i\\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P4858", "type": "P", "difficulty": 7, "samples": [["4 5\n_XXX_\nXXXX_\nXXXXX\n_XXXX", "2 3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2013", "PA（波兰）"], "title": "[PA 2013] Karty", "background": "", "description": "给定 $n\\times m$ 的矩形，每个点仅可能为 `_` 或 `X`， 选出一个最大的 $r\\times c$ 的矩形，使得多个 $r\\times c$ 的矩形能够(可以重叠的)覆盖全部 `X` 部分，不覆盖 `_` 部分。", "inputFormat": "第一行 $n,m$ 如题意所述。\n\n接下来 $n$ 行，每行一个长为 $m$ 的字符串描述这个矩阵。", "outputFormat": "输出一行，两个数 $r,c$，用空格隔开。\n\n同时有多个面积最大的要输出 $r$ 最小的那个。", "hint": "对于 $100\\%$ 的数据，$1\\le n,m\\le 2.5\\times 10^3$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2013] Karty", "background": "", "description": "给定 $n\\times m$ 的矩形，每个点仅可能为 `_` 或 `X`， 选出一个最大的 $r\\times c$ 的矩形，使得多个 $r\\times c$ 的矩形能够(可以重叠的)覆盖全部 `X` 部分，不覆盖 `_` 部分。", "inputFormat": "第一行 $n,m$ 如题意所述。\n\n接下来 $n$ 行，每行一个长为 $m$ 的字符串描述这个矩阵。", "outputFormat": "输出一行，两个数 $r,c$，用空格隔开。\n\n同时有多个面积最大的要输出 $r$ 最小的那个。", "hint": "对于 $100\\%$ 的数据，$1\\le n,m\\le 2.5\\times 10^3$。", "locale": "zh-CN"}}}
{"pid": "P4859", "type": "P", "difficulty": 6, "samples": [["4 2\n5 35 15 45\n40 20 10 30\n", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "数学", "组合数学", "排列组合", "二项式定理"], "title": "已经没有什么好害怕的了", "background": "", "description": "已经使 Madoka 有签订契约，和自己一起战斗的想法后，Mami 忽然感到自己不再是孤单一人了呢。\n\n于是，之前的谨慎的战斗作风也消失了，在对 Charlotte 的傀儡使用终曲——Tiro Finale 后，Mami 面临着即将被 Charlotte 的本体吃掉的局面。\n\n这时，已经多次面对过 Charlotte 的 Homura 告诉了学 OI 的你这样一个性质：Charlotte 的结界中有两种具有能量的元素，一种是“糖果”，另一种是“药片”，各有 $n$ 个。在 Charlotte 发动进攻前，“糖果”和“药片”会两两配对，若恰好糖果比药片能量大的组数比“药片”比“糖果”能量大的组数多 $k$ 组，则在这种局面下，Charlotte 的攻击会丟失，从而 Mami 仍有消灭 Charlotte 的可能。\n\n你必须根据 Homura 告诉你的“糖果”和“药片”的能量的信息迅速告诉 Homura 这种情况的个数.", "inputFormat": "第一行两个整数 $n,k$，含义如题目所描述。\n\n接下来一行 $n$ 个整数，第 $i$ 个数表示第 $i$ 个糖果的能量 $a_i$。\n\n接下来 $n$ 个整数，第 $j$ 个数表示第 $j$ 个药片的能量 $b_j$。\n\n保证上面两行不会有重复的数字。", "outputFormat": "一个答案，表示消灭 Charlotte 的情况个数，需要对 $10^9+9$ 取模。", "hint": "【样例解释】\n\n正确的组合为：\n\n(5-40,35-20,15-10,45-30)，    \n(5-40,45-20,15-10,35-30)，   \n(45-40,5-20,15-10,35-30)，   \n(45-40,35-20,15-10,5-30).   \n\n【数据范围】\n对于 $100\\%$ 的数据，$1 \\le n \\le 2000$，$0 \\le k \\le n$，$1\\le a_i,b_j\\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "There Is Nothing to Be Afraid of Anymore.", "background": "", "description": "After making Madoka want to sign a contract and fight together, Mami suddenly felt that she was no longer alone.\n\nSo her previously cautious fighting style disappeared. After using the finale—Tiro Finale—on Charlotte’s puppet, Mami ended up in a situation where she was about to be eaten by Charlotte’s true body.\n\nAt this moment, Homura, who has faced Charlotte many times, told you, who study OI, the following property: In Charlotte’s barrier, there are two kinds of energy-bearing elements: “candies” and “pills”, $n$ of each. Before Charlotte launches an attack, the “candies” and “pills” will be paired up one-to-one. If the number of pairs where the candy’s energy is greater than the pill’s energy is exactly $k$ more than the number of pairs where the pill’s energy is greater than the candy’s energy, then in this situation, Charlotte’s attack will miss, and Mami will still have a chance to destroy Charlotte.\n\nYou must, based on the energy information of the “candies” and “pills” that Homura tells you, quickly tell Homura how many such situations there are.", "inputFormat": "The first line contains two integers $n,k$, with meanings as described in the statement.\n\nThe next line contains $n$ integers. The $i$-th number represents the energy of the $i$-th candy.\n\nThe next line contains $n$ integers. The $j$-th number represents the energy of the $j$-th pill.\n\nIt is guaranteed that there are no duplicate numbers within each of the above two lines.", "outputFormat": "Output one integer, the number of situations in which Charlotte can be destroyed, modulo $10^9+9$.", "hint": "[Sample Explanation]\n\nThe correct matchings are:\n\n(5-40,35-20,15-10,45-30),  \n(5-40,45-20,15-10,35-30),  \n(45-40,5-20,15-10,35-30),  \n(45-40,35-20,15-10,5-30).\n\n[Constraints]  \nFor $100\\%$ of the testdata, $1 \\le n \\le 2000$, $0 \\le k \\le n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "已经没有什么好害怕的了", "background": "", "description": "已经使 Madoka 有签订契约，和自己一起战斗的想法后，Mami 忽然感到自己不再是孤单一人了呢。\n\n于是，之前的谨慎的战斗作风也消失了，在对 Charlotte 的傀儡使用终曲——Tiro Finale 后，Mami 面临着即将被 Charlotte 的本体吃掉的局面。\n\n这时，已经多次面对过 Charlotte 的 Homura 告诉了学 OI 的你这样一个性质：Charlotte 的结界中有两种具有能量的元素，一种是“糖果”，另一种是“药片”，各有 $n$ 个。在 Charlotte 发动进攻前，“糖果”和“药片”会两两配对，若恰好糖果比药片能量大的组数比“药片”比“糖果”能量大的组数多 $k$ 组，则在这种局面下，Charlotte 的攻击会丟失，从而 Mami 仍有消灭 Charlotte 的可能。\n\n你必须根据 Homura 告诉你的“糖果”和“药片”的能量的信息迅速告诉 Homura 这种情况的个数.", "inputFormat": "第一行两个整数 $n,k$，含义如题目所描述。\n\n接下来一行 $n$ 个整数，第 $i$ 个数表示第 $i$ 个糖果的能量 $a_i$。\n\n接下来 $n$ 个整数，第 $j$ 个数表示第 $j$ 个药片的能量 $b_j$。\n\n保证上面两行不会有重复的数字。", "outputFormat": "一个答案，表示消灭 Charlotte 的情况个数，需要对 $10^9+9$ 取模。", "hint": "【样例解释】\n\n正确的组合为：\n\n(5-40,35-20,15-10,45-30)，    \n(5-40,45-20,15-10,35-30)，   \n(45-40,5-20,15-10,35-30)，   \n(45-40,35-20,15-10,5-30).   \n\n【数据范围】\n对于 $100\\%$ 的数据，$1 \\le n \\le 2000$，$0 \\le k \\le n$，$1\\le a_i,b_j\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P4860", "type": "P", "difficulty": 3, "samples": [["3\n5\n7\n14", "October wins!\nOctober wins!\nOctober wins!"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["博弈论"], "title": "Roy&October之取石子II", "background": "Roy 和 October 两人在玩另一个取石子的游戏。（第一季请看 P4018）", "description": "游戏规则是这样的：共有 $n$ 个石子，两人每次都只能取 $p^k$ 个（$p$ 为质数，$k=0$ 或 $1$，且 $p^k$ 小于等于当前剩余石子数），谁取走最后一个石子，谁就赢了。\n\n现在 October 先取，问她有没有必胜策略。\n\n若她有必胜策略，输出一行 `October wins!` ；否则输出一行 `Roy wins!`。", "inputFormat": "第一行一个正整数 $T$，表示测试点组数。\n\n第 $2$ 行到第 $T+1$ 行，一行一个正整数 $n$，表示石子个数。", "outputFormat": "$T$ 行，每行分别为 `October wins!` 或 `Roy wins!`。\n", "hint": "对于 $30\\%$ 的数据，$1 \\le n \\le 30$；\n\n对于 $60\\%$ 的数据，$1 \\le n \\le 10^6$；\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 5 \\times 10^7，1 \\le T \\le 10^5$。\n\n花絮：由于出题人懒得造数据，就把 P4018 的输入直接拿来了 ovo", "locale": "zh-CN", "translations": {"en": {"title": "Roy & October’s Stone Taking II", "background": "Roy and October are playing another stone-taking game. (For Season 1, see P4018.)", "description": "The rules are as follows: there are $n$ stones in total. Each turn, a player can only take $p^k$ stones, where $p$ is a prime number, $k = 0$ or $1$, and $p^k$ is less than or equal to the number of stones currently remaining. Whoever takes the last stone wins.\n\nNow October moves first. Determine whether she has a winning strategy.\n\nIf she has a winning strategy, output one line `October wins!`; otherwise output one line `Roy wins!`.", "inputFormat": "The first line contains a positive integer $T$, the number of test cases.\n\nLines $2$ to $T+1$ each contain a positive integer $n$, the number of stones.", "outputFormat": "Output $T$ lines. Each line should be `October wins!` or `Roy wins!`.", "hint": "For $30\\%$ of the testdata, $1 \\le n \\le 30$.\n\nFor $60\\%$ of the testdata, $1 \\le n \\le 10^6$.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 5 \\times 10^7$, $1 \\le T \\le 10^5$.\n\nExtra: Since the problem setter was too lazy to generate testdata, they directly reused the input from P4018, ovo.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Roy&October之取石子II", "background": "Roy 和 October 两人在玩另一个取石子的游戏。（第一季请看 P4018）", "description": "游戏规则是这样的：共有 $n$ 个石子，两人每次都只能取 $p^k$ 个（$p$ 为质数，$k=0$ 或 $1$，且 $p^k$ 小于等于当前剩余石子数），谁取走最后一个石子，谁就赢了。\n\n现在 October 先取，问她有没有必胜策略。\n\n若她有必胜策略，输出一行 `October wins!` ；否则输出一行 `Roy wins!`。", "inputFormat": "第一行一个正整数 $T$，表示测试点组数。\n\n第 $2$ 行到第 $T+1$ 行，一行一个正整数 $n$，表示石子个数。", "outputFormat": "$T$ 行，每行分别为 `October wins!` 或 `Roy wins!`。\n", "hint": "对于 $30\\%$ 的数据，$1 \\le n \\le 30$；\n\n对于 $60\\%$ 的数据，$1 \\le n \\le 10^6$；\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 5 \\times 10^7，1 \\le T \\le 10^5$。\n\n花絮：由于出题人懒得造数据，就把 P4018 的输入直接拿来了 ovo", "locale": "zh-CN"}}}
{"pid": "P4861", "type": "P", "difficulty": 5, "samples": [["11 2", "10"], ["6 26", "Let's go Blue Jays!"]], "limits": {"time": [280, 280, 280, 280, 280, 280, 280, 280, 280, 280], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "枚举", "中国剩余定理 CRT"], "title": "按钮", "background": "Ada被关在了一个房间里。", "description": "房间的铁门上有一个按钮，还有一个显示屏显示着“1”。    \n旁边还有一行小字：“这是一个高精度M进制计算器，每按一次按钮，屏幕上的数便会乘以K。当个位数再次变为1时，门就开了。”    \n由于Ada急于出去，所以你要在1s之内求出她的最小按键次数。", "inputFormat": "一行，两个整数M和K。", "outputFormat": "一行一个数字，表示最小按键次数。   \n如果无论Ada按多少次都无法让门打开，输出\"Let's go Blue Jays!\"（不含引号）。", "hint": "对于30%的数据，$2\\leq M,K\\leq10^4$。    \n对于100%的数据，$2\\leq M,K\\leq2\\times 10^{9}$。  \nupdate：我们不认为个位为11,21,...为问题的解（例如，11在16进制下记为B）    ", "locale": "zh-CN", "translations": {"en": {"title": "Button", "background": "Ada has been locked in a room.", "description": "On the room’s iron door, there is a button and a display showing “1”.  \nNext to it, there is a line of small text: “This is a high-precision base-$M$ calculator. Each time you press the button, the number on the screen will be multiplied by $K$. When the last digit becomes 1 again, the door will open.”  \nSince Ada is eager to get out, you need to find the minimum number of button presses within 1 second.", "inputFormat": "One line with two integers $M$ and $K$.", "outputFormat": "Output one number on one line, the minimum number of button presses.  \nIf no matter how many times Ada presses the button the door cannot be opened, output \"Let's go Blue Jays!\" (without quotes).", "hint": "For 30% of the testdata, $2\\leq M,K\\leq10^4$.  \nFor 100% of the testdata, $2\\leq M,K\\leq2\\times 10^{9}$.  \nUpdate: we do not consider numbers whose last digit is 11, 21, ... as valid solutions (for example, 11 is written as B in base 16).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "按钮", "background": "Ada被关在了一个房间里。", "description": "房间的铁门上有一个按钮，还有一个显示屏显示着“1”。    \n旁边还有一行小字：“这是一个高精度M进制计算器，每按一次按钮，屏幕上的数便会乘以K。当个位数再次变为1时，门就开了。”    \n由于Ada急于出去，所以你要在1s之内求出她的最小按键次数。", "inputFormat": "一行，两个整数M和K。", "outputFormat": "一行一个数字，表示最小按键次数。   \n如果无论Ada按多少次都无法让门打开，输出\"Let's go Blue Jays!\"（不含引号）。", "hint": "对于30%的数据，$2\\leq M,K\\leq10^4$。    \n对于100%的数据，$2\\leq M,K\\leq2\\times 10^{9}$。  \nupdate：我们不认为个位为11,21,...为问题的解（例如，11在16进制下记为B）    ", "locale": "zh-CN"}}}
{"pid": "P4862", "type": "P", "difficulty": 5, "samples": [["2 1 2\n3\n6", "3\n5"], ["5 3 1\n3", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["递推", "Fibonacci 数列", "线性递推"], "title": "猜数", "background": "Iris 和 Beryl 两人在玩一个猜数的游戏。", "description": "游戏是这样进行的：给定一个正整数 $n$，Iris 在 $S=\\{1,2,...,n\\}$ 中选择一个数 $m$。  \n\n然后，Iris 要如实回答 Beryl 的若干个问题，这些问题的形式是：“$m$ 是集合 $A$ 中的元素吗？”其中 $A\\subseteq S$。   \n如果Iris回答“是”，则 Beryl 要给 Iris $a$ 元钱；否则，Beryl 要给 Iris $b$ 元钱。（数据保证 $a>b$）\n\n那么，Beryl 至少准备多少钱，就一定能确定 Iris 心中的数字呢？", "inputFormat": "第一行：两个正整数 $a$ 和 $b$ 以及数据组数 $t$。   \n接下来 $t$ 行，每行一个给定的正整数 $n$，意义如上所述。", "outputFormat": "$t$ 行，表示对于每一组数据，Beryl 需要准备的最小钱数。", "hint": "【样例1的第1组数据解释】 \n\nBeryl先对集合 $\\{1\\}$ 进行询问，若得到的答案是“是”，则已经确定 Iris 选的数为 $1$，需要 $2$ 元。若得到的答案是“否”，则再对集合 $\\{2\\}$ 进行询问，显然运气最差要再花 $2$ 元，共 $3$ 元，故答案为 $3$ 元。   \n\n----   \n\n【数据范围】  \n\n| 测试点编号 | $n$ |$t$| $a$,$b$ |\n| :----------- | :----------- | :----------- | :----------- |\n| 1 | $\\leq 20$ | $\\leq 10$ | $\\leq 20$ |\n| 2 | $\\leq 20$ | $\\leq 10$ | $\\leq 20$ |\n| 3 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 4 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 5 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 6 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n|7  | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 8 | $\\leq 10^{18}$ | $\\leq 200$ | $a=2$,$b=1$ |\n| 9 | $\\leq 10^{18}$ | $\\leq 200$ | $a=2$,$b=1$ |\n| 10 | $\\leq 10^{18}$ | $\\leq 200$ | $a=2$,$b=1$ |\n\n", "locale": "zh-CN", "translations": {"en": {"title": "Number Guessing.", "background": "Iris and Beryl are playing a number guessing game.", "description": "The game works as follows: given a positive integer $n$, Iris chooses a number $m$ from $S=\\{1,2,...,n\\}$.\n\nThen, Iris must answer Beryl’s questions truthfully. Each question is of the form: “Is $m$ an element of set $A$?” where $A\\subseteq S$.  \nIf Iris answers “Yes”, then Beryl must give Iris $a$ yuan; otherwise, Beryl must give Iris $b$ yuan. (The testdata guarantees $a>b$.)\n\nHow much money does Beryl need to prepare at least, to be sure that she can determine the number in Iris’s mind?", "inputFormat": "The first line contains two positive integers $a$ and $b$, and the number of test cases $t$.  \nThe next $t$ lines each contain a given positive integer $n$, with the meaning as described above.", "outputFormat": "Output $t$ lines. For each test case, output the minimum amount of money Beryl needs to prepare.", "hint": "[Explanation for the 1st test case of Sample 1]\n\nBeryl first asks about the set $\\{1\\}$. If the answer is “Yes”, then Iris’s number is confirmed to be $1$, and Beryl needs $2$ yuan. If the answer is “No”, then Beryl asks about the set $\\{2\\}$. Clearly, in the worst case she needs to spend another $2$ yuan, for a total of $3$ yuan, so the answer is $3$ yuan.\n\n----\n\n[Constraints]\n\n| Test Point ID | $n$ | $t$ | $a$,$b$ |\n| :----------- | :----------- | :----------- | :----------- |\n| 1 | $\\leq 20$ | $\\leq 10$ | $\\leq 20$ |\n| 2 | $\\leq 20$ | $\\leq 10$ | $\\leq 20$ |\n| 3 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 4 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 5 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 6 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 7 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 8 | $\\leq 10^{18}$ | $\\leq 200$ | $a=2$,$b=1$ |\n| 9 | $\\leq 10^{18}$ | $\\leq 200$ | $a=2$,$b=1$ |\n| 10 | $\\leq 10^{18}$ | $\\leq 200$ | $a=2$,$b=1$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "猜数", "background": "Iris 和 Beryl 两人在玩一个猜数的游戏。", "description": "游戏是这样进行的：给定一个正整数 $n$，Iris 在 $S=\\{1,2,...,n\\}$ 中选择一个数 $m$。  \n\n然后，Iris 要如实回答 Beryl 的若干个问题，这些问题的形式是：“$m$ 是集合 $A$ 中的元素吗？”其中 $A\\subseteq S$。   \n如果Iris回答“是”，则 Beryl 要给 Iris $a$ 元钱；否则，Beryl 要给 Iris $b$ 元钱。（数据保证 $a>b$）\n\n那么，Beryl 至少准备多少钱，就一定能确定 Iris 心中的数字呢？", "inputFormat": "第一行：两个正整数 $a$ 和 $b$ 以及数据组数 $t$。   \n接下来 $t$ 行，每行一个给定的正整数 $n$，意义如上所述。", "outputFormat": "$t$ 行，表示对于每一组数据，Beryl 需要准备的最小钱数。", "hint": "【样例1的第1组数据解释】 \n\nBeryl先对集合 $\\{1\\}$ 进行询问，若得到的答案是“是”，则已经确定 Iris 选的数为 $1$，需要 $2$ 元。若得到的答案是“否”，则再对集合 $\\{2\\}$ 进行询问，显然运气最差要再花 $2$ 元，共 $3$ 元，故答案为 $3$ 元。   \n\n----   \n\n【数据范围】  \n\n| 测试点编号 | $n$ |$t$| $a$,$b$ |\n| :----------- | :----------- | :----------- | :----------- |\n| 1 | $\\leq 20$ | $\\leq 10$ | $\\leq 20$ |\n| 2 | $\\leq 20$ | $\\leq 10$ | $\\leq 20$ |\n| 3 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 4 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 5 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 6 | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n|7  | $\\leq 2000$ | $\\leq 100$ | $\\leq 500$ |\n| 8 | $\\leq 10^{18}$ | $\\leq 200$ | $a=2$,$b=1$ |\n| 9 | $\\leq 10^{18}$ | $\\leq 200$ | $a=2$,$b=1$ |\n| 10 | $\\leq 10^{18}$ | $\\leq 200$ | $a=2$,$b=1$ |\n\n", "locale": "zh-CN"}}}
