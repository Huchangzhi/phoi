{"pid": "P3715", "type": "P", "difficulty": 6, "samples": [["4 2 10\nboom\noo\nooh\nbang\nob\nmo", "14"], ["3 1 3\na\nab\naba\naaa", "3"], ["3 1 14\nban\nan\nanalysis\nbanana", "15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "动态规划 DP", "2017", "各省省选", "北京", "矩阵加速", "矩阵乘法", "AC 自动机", "构造"], "title": "[BJOI2017] 魔法咒语", "background": "", "description": "Chandra 是一个魔法天才。\n\n从一岁时接受火之教会洗礼之后，Chandra 就显示出对火元素无与伦比的亲和力，轻而易举地学会种种晦涩难解的法术。这也多亏 Chandra 有着常人难以企及的语言天赋，让她能轻松流利地说出咒语中那些极其拗口的魔法词汇。\n\n直到十四岁，开始学习威力强大的禁咒法术时，Chandra 才遇到了障碍。\n\n根据火之魔法规则，禁咒的构成单位是 $N$ 个基本词汇。施法时只要凝聚精神力，说出一段用这些词语组成的长度恰好等于 $L$ 的语言，就能释放威力超乎想象的火法术。过去的魔法师们总结了几种表达起来最连贯的组合方式，方便施法者以最快语速完成法术。\n\n但具有魔法和语言双重天才的 Chandra 不满足于这几种流传下来的禁咒，因为她可以毫无困难地说出普通人几乎不可能表达的禁咒语句。然而，在实际施法时，Chandra 发现有些自创禁咒念出后不但没有预期效果，反而会使自己的精神力迅速枯竭，十分难受。\n\n这个问题令 Chandra 万分不解。她大量阅读典籍，到处走访魔法学者，并且不顾精神折磨一次又一次尝试新咒语，希望找出问题的答案。\n\n很多年过去了，在一次远古遗迹探险中，Chandra 意外闯进了火之神艾利克斯的不知名神殿。根据岩土特征分析，神殿应该有上万年的历史，这是极其罕见的。Chandra 小心翼翼地四处探索，沿着魔力流动来到一间密室。她看见密室中央悬浮着一本书籍。在魔法保护下书籍状况完好。精通上古语言的 Chandra 读过此书，终于解开了多年的困惑。\n\n\n禁咒法术之所以威力强大，是因为咒语借用了火之神艾利克斯的神力。这本书里记载了艾利克斯生平忌讳的 $M$ 个词语，比如情敌的名字、讨厌的植物等等。使用禁咒法术时，如果语言中含有任何忌讳词语，就会触怒神力而失效，施法者也一并遭受惩罚。\n\n例如，若 `banana` 是唯一的忌讳词语，`an`、`ban`、`analysis` 是基本词汇，禁咒长度须是 $11$，则 `bananalysis` 是无效法术，`analysisban`、`anbanbanban` 是两个有效法术。注意：一个基本词汇在禁咒法术中可以出现零次、一次或多次；只要组成方式不同就认为是不同的禁咒法术，即使书写形式相同。\n\n谜题破解，Chandra 心情大好。她决定计算一共有多少种有效的禁咒法术。\n\n由于答案可能很大，你只需要输出答案模 $10 ^ 9 + 7$ 的结果。\n", "inputFormat": "第一行，三个正整数 $N, M, L$。\n\n接下来 $N$ 行，每行一个只含小写英文字母的字符串，表示一个基本词汇。\n\n接下来 $M$ 行，每行一个只含小写英文字母的字符串，表示一个忌讳词语。\n", "outputFormat": "仅一行，一个整数，表示答案（模 $10^9+7$）。\n", "hint": "【样例解释 1】\n\n有效的禁咒法术共有 $14$ 种：`boom/bang/oo`，`oo/oo/oo/oo/oo`，`oo/oo/ooh/ooh`，`oo/ooh/oo/ooh`，`oo/ooh/ooh/oo`，`ooh/oo/oo/ooh`，`ooh/oo/ooh/oo`，`\nooh/ooh/boom`，`ooh/ooh/oo/oo`，`ooh/ooh/bang`，`ooh/bang/ooh`，`bang/oo/oo/oo`，`bang/ooh/ooh`，`bang/bang/oo`。\n\n【样例解释 2】\n\n有效的禁咒法术有 `a/ab`，`ab/a`，`aba` 共三种。注意，`ab/a` 和 `aba` 算成两种不同的禁咒法术。\n\n【数据规模与约定】\n\n本题一共有 $10$ 个测试点。\n\n下表是每个测试点的数据规模和约定：\n\n ![](https://cdn.luogu.com.cn/upload/pic/5191.png) \n\n对于 $100\\%$ 的数据，$1 \\le N, M \\le 50，1 \\le L \\le 10^8$，基本词汇的长度之和不超过 $100$，忌讳词语的长度之和不超过 $100$。保证基本词汇不重复，忌讳词语不重复。\n", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2017] Magic Incantations", "background": "", "description": "Chandra is a prodigy of magic.\n\nSince receiving the baptism of the Church of Fire at the age of one, Chandra has shown unparalleled affinity for the fire element and easily mastered various obscure spells. This also owes to Chandra’s extraordinary talent for languages, which lets her fluently pronounce the very awkward magical words in incantations.\n\nShe did not encounter obstacles until the age of fourteen, when she began studying powerful forbidden spells.\n\nAccording to the rules of fire magic, a forbidden spell is composed of $N$ basic words. During casting, as long as she concentrates and speaks an utterance of length exactly $L$ formed by these words, she can unleash a fire spell of unimaginable power. Magicians in the past summarized several of the most fluent composition methods to help the caster complete the spell at the fastest speaking speed.\n\nHowever, Chandra, a genius in both magic and language, was not satisfied with those handed‑down forbidden spells, because she could effortlessly speak forbidden utterances that ordinary people could hardly pronounce. Yet in actual casting, Chandra found that some of her self‑created forbidden spells not only failed to produce the expected effect after being chanted, but also rapidly drained her mental strength, causing great discomfort.\n\nThis problem puzzled Chandra greatly. She read many classics, consulted magic scholars everywhere, and, despite the mental torment, tried new incantations again and again, hoping to find the answer.\n\nMany years later, during an expedition to ancient ruins, Chandra accidentally entered an unknown shrine of the fire god Ailikesi (pinyin). Based on the geomorphic features, the shrine should be tens of thousands of years old, which is extremely rare. Chandra carefully explored, followed the flow of magic, and came to a secret chamber. She saw a book floating at the center of the chamber. Protected by magic, the book was in perfect condition. Proficient in ancient languages, Chandra read it and finally solved her years‑long confusion.\n\nForbidden spells are so powerful because the incantation borrows the divine power of the fire god Ailikesi. This book recorded $M$ taboo words that Ailikesi hated in life, such as the name of a rival in love, a disliked plant, and so on. When using a forbidden spell, if the utterance contains any taboo word, the divine power will be angered and the spell will fail, and the caster will suffer punishment as well.\n\nFor example, if `banana` is the only taboo word, `an`, `ban`, `analysis` are the basic words, and the forbidden spell length must be $11$, then `bananalysis` is an invalid spell, while `analysisban` and `anbanbanban` are two valid spells. Note: a basic word can appear zero, one, or multiple times in a forbidden spell; as long as the composition (sequence of basic words) is different, they are considered different forbidden spells, even if the written string is the same.\n\nWith the puzzle solved, Chandra was delighted. She decided to compute how many valid forbidden spells there are in total.\n\nSince the answer can be large, you only need to output the result modulo $10 ^ 9 + 7$.", "inputFormat": "The first line contains three positive integers $N, M, L$.\n\nThe next $N$ lines each contain a string consisting only of lowercase English letters, representing a basic word.\n\nThe next $M$ lines each contain a string consisting only of lowercase English letters, representing a taboo word.", "outputFormat": "A single line containing one integer, the answer (mod $10^9+7$).", "hint": "[Sample Explanation 1]\n\nThere are $14$ valid forbidden spells: `boom/bang/oo`, `oo/oo/oo/oo/oo`, `oo/oo/ooh/ooh`, `oo/ooh/oo/ooh`, `oo/ooh/ooh/oo`, `ooh/oo/oo/ooh`, `ooh/oo/ooh/oo`, `ooh/ooh/boom`, `ooh/ooh/oo/oo`, `ooh/ooh/bang`, `ooh/bang/ooh`, `bang/oo/oo/oo`, `bang/ooh/ooh`, `bang/bang/oo`.\n\n[Sample Explanation 2]\n\nThe valid forbidden spells are `a/ab`, `ab/a`, and `aba`, three in total. Note that `ab/a` and `aba` count as two different forbidden spells.\n\n[Constraints and Agreements]\n\nThis problem has $10$ test points.\n\nThe following table shows the data scale and agreements for each test point:\n\n ![](https://cdn.luogu.com.cn/upload/pic/5191.png) \n\nFor $100\\%$ of the testdata, $1 \\le N, M \\le 50$, $1 \\le L \\le 10^8$, the sum of lengths of the basic words does not exceed $100$, and the sum of lengths of the taboo words does not exceed $100$. It is guaranteed that the basic words are distinct and the taboo words are distinct.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2017] 魔法咒语", "background": "", "description": "Chandra 是一个魔法天才。\n\n从一岁时接受火之教会洗礼之后，Chandra 就显示出对火元素无与伦比的亲和力，轻而易举地学会种种晦涩难解的法术。这也多亏 Chandra 有着常人难以企及的语言天赋，让她能轻松流利地说出咒语中那些极其拗口的魔法词汇。\n\n直到十四岁，开始学习威力强大的禁咒法术时，Chandra 才遇到了障碍。\n\n根据火之魔法规则，禁咒的构成单位是 $N$ 个基本词汇。施法时只要凝聚精神力，说出一段用这些词语组成的长度恰好等于 $L$ 的语言，就能释放威力超乎想象的火法术。过去的魔法师们总结了几种表达起来最连贯的组合方式，方便施法者以最快语速完成法术。\n\n但具有魔法和语言双重天才的 Chandra 不满足于这几种流传下来的禁咒，因为她可以毫无困难地说出普通人几乎不可能表达的禁咒语句。然而，在实际施法时，Chandra 发现有些自创禁咒念出后不但没有预期效果，反而会使自己的精神力迅速枯竭，十分难受。\n\n这个问题令 Chandra 万分不解。她大量阅读典籍，到处走访魔法学者，并且不顾精神折磨一次又一次尝试新咒语，希望找出问题的答案。\n\n很多年过去了，在一次远古遗迹探险中，Chandra 意外闯进了火之神艾利克斯的不知名神殿。根据岩土特征分析，神殿应该有上万年的历史，这是极其罕见的。Chandra 小心翼翼地四处探索，沿着魔力流动来到一间密室。她看见密室中央悬浮着一本书籍。在魔法保护下书籍状况完好。精通上古语言的 Chandra 读过此书，终于解开了多年的困惑。\n\n\n禁咒法术之所以威力强大，是因为咒语借用了火之神艾利克斯的神力。这本书里记载了艾利克斯生平忌讳的 $M$ 个词语，比如情敌的名字、讨厌的植物等等。使用禁咒法术时，如果语言中含有任何忌讳词语，就会触怒神力而失效，施法者也一并遭受惩罚。\n\n例如，若 `banana` 是唯一的忌讳词语，`an`、`ban`、`analysis` 是基本词汇，禁咒长度须是 $11$，则 `bananalysis` 是无效法术，`analysisban`、`anbanbanban` 是两个有效法术。注意：一个基本词汇在禁咒法术中可以出现零次、一次或多次；只要组成方式不同就认为是不同的禁咒法术，即使书写形式相同。\n\n谜题破解，Chandra 心情大好。她决定计算一共有多少种有效的禁咒法术。\n\n由于答案可能很大，你只需要输出答案模 $10 ^ 9 + 7$ 的结果。\n", "inputFormat": "第一行，三个正整数 $N, M, L$。\n\n接下来 $N$ 行，每行一个只含小写英文字母的字符串，表示一个基本词汇。\n\n接下来 $M$ 行，每行一个只含小写英文字母的字符串，表示一个忌讳词语。\n", "outputFormat": "仅一行，一个整数，表示答案（模 $10^9+7$）。\n", "hint": "【样例解释 1】\n\n有效的禁咒法术共有 $14$ 种：`boom/bang/oo`，`oo/oo/oo/oo/oo`，`oo/oo/ooh/ooh`，`oo/ooh/oo/ooh`，`oo/ooh/ooh/oo`，`ooh/oo/oo/ooh`，`ooh/oo/ooh/oo`，`\nooh/ooh/boom`，`ooh/ooh/oo/oo`，`ooh/ooh/bang`，`ooh/bang/ooh`，`bang/oo/oo/oo`，`bang/ooh/ooh`，`bang/bang/oo`。\n\n【样例解释 2】\n\n有效的禁咒法术有 `a/ab`，`ab/a`，`aba` 共三种。注意，`ab/a` 和 `aba` 算成两种不同的禁咒法术。\n\n【数据规模与约定】\n\n本题一共有 $10$ 个测试点。\n\n下表是每个测试点的数据规模和约定：\n\n ![](https://cdn.luogu.com.cn/upload/pic/5191.png) \n\n对于 $100\\%$ 的数据，$1 \\le N, M \\le 50，1 \\le L \\le 10^8$，基本词汇的长度之和不超过 $100$，忌讳词语的长度之和不超过 $100$。保证基本词汇不重复，忌讳词语不重复。\n", "locale": "zh-CN"}}}
{"pid": "P3716", "type": "P", "difficulty": 5, "samples": [["2\n1 1\n5 5\n1 3 3 3\n6 2 8 4", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2000", "枚举", "广度优先搜索 BFS", "最短路", "CTSC/CTS"], "title": "[CTSC2000] 冰原探险", "background": "", "description": "传说中，南极有一片广阔的冰原，在冰原下藏有史前文明的遗址。整个冰原被横竖划分成了很多个大小相等的方格。在这个冰原上有 $N$ 个大小不等的矩形冰山，这些巨大的冰山有着和南极一样古老的历史。\n\n每个矩形冰山至少占据一个方格，且其必定完整地占据方格。冰山和冰山之间不会重叠，也不会有边或点相连。以下两种情况均是不可能出现的：\n\n![](https://cdn.luogu.com.cn/upload/pic/5096.png)\n\n$\\text{ACM}$ 探险队在经过多年准备之后决定在这个冰原上寻找遗址。根据他们掌握的资料，在这个冰原上一个大小为一格的深洞中，藏有一个由史前人类制作的开关。而唯一可以打开这个开关的是一个占据接近一格的可移动的小冰块。显然，在南极是不可能有这样小的独立冰块的，所以这块冰块也一定是史前文明的产物。他们在想办法把这个冰块推到洞里去，这样就可以打开一条通往冰原底部的通道，发掘史前文明的秘密。冰块的起始位置与深洞的位置均不和任何冰山相邻。\n\n这个冰原上的冰面和冰山都是完全光滑的，轻轻的推动冰块就可以使这个冰块向前滑行，直到撞到一座冰山就在它的边上停下来。冰块可以穿过冰面上所有没有冰山的区域，也可以从两座冰山之间穿过（见下图）。冰块只能沿网格方向推动。\n\n\n ![](https://cdn.luogu.com.cn/upload/pic/5097.png) \n\n请你帮助他们以最少的推动次数将冰块推入深洞中。\n", "inputFormat": "输入文件第一行为冰山的个数 $N$ ，第二行为冰块开始所在的方格坐标 $X_{1}$ , $Y_{1}$ ，第三行为深洞所在的方格坐标 $X_{2}, Y_{2}$ ，以下 $N$ 行每行有四个数，分别是每个冰山所占的格子左上角和右下角坐标 $X_{i_{1}}, Y_{i_{1}}, X_{i_{2}}, Y_{i_{2}}$ ", "outputFormat": "输出文件包含一个整数，为最少推动冰块的次数。如果无法将冰块推入深洞中，则输出 $0$ 。", "hint": "$1 \\leq N \\leq 4000$\n\n样例解释：移动方案如图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/y6sx7ya7.png)", "locale": "zh-CN", "translations": {"en": {"title": "[CTSC2000] Icefield Exploration", "background": "", "description": "Legend says there is a vast icefield in Antarctica, under which lie ruins of a prehistoric civilization. The entire icefield is divided into many equal-sized grid cells. On this icefield there are $N$ rectangular icebergs of different sizes, each as ancient as Antarctica itself.\n\nEach rectangular iceberg occupies at least one cell and always fully occupies cells. Icebergs neither overlap nor touch each other at edges or points. The following two cases cannot occur:\n\n![](https://cdn.luogu.com.cn/upload/pic/5096.png)\n\nAfter years of preparation, the $\\text{ACM}$ exploration team decided to search for the ruins on this icefield. According to their information, there is a one-cell-deep pit on the icefield that hides a switch made by prehistoric humans. The only thing that can activate this switch is a movable small ice block that is almost one cell in size. Obviously, such a small independent ice block could not naturally exist in Antarctica, so it must also be a product of the prehistoric civilization. They want to push this block into the pit to open a passage to the bottom of the icefield and excavate the secrets of the prehistoric civilization. Neither the starting position of the ice block nor the position of the deep pit is adjacent to any iceberg.\n\nBoth the ice surface and the icebergs are perfectly smooth. A gentle push makes the ice block slide forward until it hits an iceberg and stops next to its side. The ice block can slide through any area of the ice surface without icebergs and can pass between two icebergs (see the figure below). The ice block can only be pushed along the grid directions.\n\n![](https://cdn.luogu.com.cn/upload/pic/5097.png)\n\nPlease help them push the ice block into the deep pit with the minimum number of pushes.", "inputFormat": "The first line contains the number of icebergs $N$.  \nThe second line contains the coordinates of the starting cell of the ice block, $X_{1}, Y_{1}$.  \nThe third line contains the coordinates of the deep pit, $X_{2}, Y_{2}$.  \nEach of the next $N$ lines contains four integers, the coordinates of the upper-left and lower-right cells of an iceberg, $X_{i_{1}}, Y_{i_{1}}, X_{i_{2}}, Y_{i_{2}}$.", "outputFormat": "Output a single integer: the minimum number of pushes. If it is impossible to push the ice block into the deep pit, output 0.", "hint": "$1 \\leq N \\leq 4000$.\n\nSample explanation: The moving plan is shown in the figure.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/y6sx7ya7.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CTSC2000] 冰原探险", "background": "", "description": "传说中，南极有一片广阔的冰原，在冰原下藏有史前文明的遗址。整个冰原被横竖划分成了很多个大小相等的方格。在这个冰原上有 $N$ 个大小不等的矩形冰山，这些巨大的冰山有着和南极一样古老的历史。\n\n每个矩形冰山至少占据一个方格，且其必定完整地占据方格。冰山和冰山之间不会重叠，也不会有边或点相连。以下两种情况均是不可能出现的：\n\n![](https://cdn.luogu.com.cn/upload/pic/5096.png)\n\n$\\text{ACM}$ 探险队在经过多年准备之后决定在这个冰原上寻找遗址。根据他们掌握的资料，在这个冰原上一个大小为一格的深洞中，藏有一个由史前人类制作的开关。而唯一可以打开这个开关的是一个占据接近一格的可移动的小冰块。显然，在南极是不可能有这样小的独立冰块的，所以这块冰块也一定是史前文明的产物。他们在想办法把这个冰块推到洞里去，这样就可以打开一条通往冰原底部的通道，发掘史前文明的秘密。冰块的起始位置与深洞的位置均不和任何冰山相邻。\n\n这个冰原上的冰面和冰山都是完全光滑的，轻轻的推动冰块就可以使这个冰块向前滑行，直到撞到一座冰山就在它的边上停下来。冰块可以穿过冰面上所有没有冰山的区域，也可以从两座冰山之间穿过（见下图）。冰块只能沿网格方向推动。\n\n\n ![](https://cdn.luogu.com.cn/upload/pic/5097.png) \n\n请你帮助他们以最少的推动次数将冰块推入深洞中。\n", "inputFormat": "输入文件第一行为冰山的个数 $N$ ，第二行为冰块开始所在的方格坐标 $X_{1}$ , $Y_{1}$ ，第三行为深洞所在的方格坐标 $X_{2}, Y_{2}$ ，以下 $N$ 行每行有四个数，分别是每个冰山所占的格子左上角和右下角坐标 $X_{i_{1}}, Y_{i_{1}}, X_{i_{2}}, Y_{i_{2}}$ ", "outputFormat": "输出文件包含一个整数，为最少推动冰块的次数。如果无法将冰块推入深洞中，则输出 $0$ 。", "hint": "$1 \\leq N \\leq 4000$\n\n样例解释：移动方案如图所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/y6sx7ya7.png)", "locale": "zh-CN"}}}
{"pid": "P3717", "type": "P", "difficulty": 1, "samples": [["5 2 1\n3 3\n4 2", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "搜索", "2017", "安徽", "枚举", "差分"], "title": "[AHOI2017初中组] cover", "background": "以下为不影响题意的简化版题目。", "description": "一个 $n\\times n$ 的网格图（标号由 $1$ 开始）上有 $m$ 个探测器，每个探测器有个探测半径 $r$ ，问这 $n\\times n$ 个点中有多少个点能被探测到。", "inputFormat": "第一行 $3$ 个整数 $n,m,r$。\n\n接下来 $m$ 行，每行两个整数 $x,y$表示第 $i$ 个探测器的坐标。", "outputFormat": "能被探测到的点的个数。", "hint": "$1\\le n,m\\le 100$", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2017 Middle School Division] cover", "background": "The following is a simplified version that does not change the meaning of the problem.", "description": "On an $n\\times n$ grid (indexed from $1$), there are $m$ detectors, each with a detection radius $r$. Among these $n\\times n$ points, how many points can be detected.", "inputFormat": "The first line contains $3$ integers $n,m,r$.\nEach of the next $m$ lines contains two integers $x,y$, representing the coordinates of the $i$-th detector.", "outputFormat": "Output the number of points that can be detected.", "hint": "Constraints: $1\\le n,m\\le 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2017初中组] cover", "background": "以下为不影响题意的简化版题目。", "description": "一个 $n\\times n$ 的网格图（标号由 $1$ 开始）上有 $m$ 个探测器，每个探测器有个探测半径 $r$ ，问这 $n\\times n$ 个点中有多少个点能被探测到。", "inputFormat": "第一行 $3$ 个整数 $n,m,r$。\n\n接下来 $m$ 行，每行两个整数 $x,y$表示第 $i$ 个探测器的坐标。", "outputFormat": "能被探测到的点的个数。", "hint": "$1\\le n,m\\le 100$", "locale": "zh-CN"}}}
{"pid": "P3718", "type": "P", "difficulty": 4, "samples": [["8 1\nNNNFFNNN", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "贪心", "2017", "二分", "安徽", "枚举", "队列"], "title": "[AHOI2017初中组] alter", "background": "", "description": "有 $n$ 盏灯排成一列，其中有些灯开着，有些灯关着。小可可希望灯是错落有致的，他定义一列灯的状态的不优美度为这些灯中最长的连续的开着或关着的灯的个数。小可可最多可以按开关 $k$ 次，每次操作可以使该盏灯的状态取反：原来开着的就关着，反之开着。现在给出这些灯的状态，求操作后最小的不优美度。", "inputFormat": "第一行两个整数 $n,k$。\n\n第二行是一个长度为 $n$ 的字符串，其中有两种字符：`N` 和 `F`。其中 `N` 表示该灯开着，`F` 表示该灯关着。", "outputFormat": "最小的不优美度。", "hint": "$30\\%$ 的数据：$1\\le k \\le n\\le20$；\n\n$50\\%$ 的数据：$1\\le k \\le n\\le300$；\n\n另有 $15\\%$ 的数据：$1\\le k \\le n\\le 10^5$，字符串为全 `N` 或全 `F`；\n\n$100\\%$ 的数据：$1\\le k \\le n\\le 10^5$。\n\n本题已经加入 hack 数据。", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2017 Middle School Division] alter", "background": "", "description": "There are $n$ lamps in a row. Some lamps are on, and some are off. Keke wants the lamps to be alternating. He defines the ugliness of a row of lamps as the number of lamps in the longest consecutive segment that are all on or all off. Keke can press switches at most $k$ times. Each operation toggles the state of one lamp: if it was on, it becomes off; otherwise, it becomes on. Given the current states of the lamps, find the minimal ugliness after the operations.", "inputFormat": "The first line contains two integers $n, k$.\n\nThe second line is a string of length $n$ consisting of two characters: `N` and `F`. Here, `N` means the lamp is on, and `F` means the lamp is off.", "outputFormat": "Output the minimal ugliness.", "hint": "$30\\%$ of the testdata: $1\\le k \\le n\\le 20$.\n\n$50\\%$ of the testdata: $1\\le k \\le n\\le 300$.\n\nAnother $15\\%$ of the testdata: $1\\le k \\le n\\le 10^5$, and the string is all `N` or all `F`.\n\n$100\\%$ of the testdata: $1\\le k \\le n\\le 10^5$.\n\nThis problem includes hack testdata.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2017初中组] alter", "background": "", "description": "有 $n$ 盏灯排成一列，其中有些灯开着，有些灯关着。小可可希望灯是错落有致的，他定义一列灯的状态的不优美度为这些灯中最长的连续的开着或关着的灯的个数。小可可最多可以按开关 $k$ 次，每次操作可以使该盏灯的状态取反：原来开着的就关着，反之开着。现在给出这些灯的状态，求操作后最小的不优美度。", "inputFormat": "第一行两个整数 $n,k$。\n\n第二行是一个长度为 $n$ 的字符串，其中有两种字符：`N` 和 `F`。其中 `N` 表示该灯开着，`F` 表示该灯关着。", "outputFormat": "最小的不优美度。", "hint": "$30\\%$ 的数据：$1\\le k \\le n\\le20$；\n\n$50\\%$ 的数据：$1\\le k \\le n\\le300$；\n\n另有 $15\\%$ 的数据：$1\\le k \\le n\\le 10^5$，字符串为全 `N` 或全 `F`；\n\n$100\\%$ 的数据：$1\\le k \\le n\\le 10^5$。\n\n本题已经加入 hack 数据。", "locale": "zh-CN"}}}
{"pid": "P3719", "type": "P", "difficulty": 4, "samples": [["(aaa)aa|aa|(a(aa)a)", "5\n"], ["((a|aaa)|aa)|a", "3"], ["(a(aa|aaa)a|(a|aa))aa", "7"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "字符串", "2017", "递归", "安徽", "栈"], "title": "[AHOI2017初中组] rexp", "background": "为了解决形形色色的字符串匹配问题，正则表达式是一个强有力的工具。正则表达式通过定义一套符号体系，能够表示出需要查找的字符串所具有的性质。如 `a|aa` 能匹配 `a` 或 `aa`，`(a|b)c` 能匹配 `ac` 或 `bc`。\n", "description": "完整的正则表达式过于复杂，在这里我们只考虑由 `(`、`)`、`|` 和 `a` 组成的正则表达式。运算遵循下列法则：\n\n1. 有括号时，我们总是先算括号内的部分；\n\n2. 当两个字符串（或由括号定义的子串）间没有符号时，我们总把它们连起来作为一个整体；\n\n3. `|` 是或连接符，表示两边的字符串任取其一，若同一层里有多个或连接符，可以看作在这些或连接符所分开的若干字符串里任取其一。\n\n例如，`(aaa)aa|aa|(a(aa)a)`、`(aaaaa)|(aa)|aaaa` 和 `aaaaa|aaaa|aa` 是等价的，它们都能匹配长度为 $2,4$ 或 $5$ 的全 `a` 字符串。\n\n下面给定一个简化正则表达式，试编程计算它最多能匹配多长的全 `a` 字符串。", "inputFormat": "输入一行一个合法的简化正则表达式。\n", "outputFormat": "一行一个整数，表示能匹配的最长全 `a` 字符串长度。", "hint": "**【数据范围】**\n\n对于 $20\\%$ 数据，表达式长度不超过 $100$，且不存在括号。\n\n对于 $40\\%$ 数据，表达式长度不超过 $100$。\n\n对于 $70\\%$ 数据，表达式长度不超过 $2 \\times 10^3$。\n\n对于 $100\\%$ 的数据，表达式长度不超过 $10^5$。\n\n保证表达式合法（即 `|` 两端和括号内运算结果均非空字符串）。", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2017 Middle School Division] rexp", "background": "To solve various string matching problems, regular expressions are a powerful tool. By defining a system of symbols, regular expressions can describe the properties of the strings to be found. For example, `a|aa` can match `a` or `aa`, and `(a|b)c` can match `ac` or `bc`.", "description": "Full regular expressions are too complex. Here, we only consider regular expressions composed of `(`, `)`, `|`, and `a`. The operations follow the rules below:\n\n1. When there are parentheses, we always evaluate the part inside the parentheses first.\n2. When two strings (or substrings defined by parentheses) have no symbol between them, we concatenate them as a whole.\n3. `|` is the OR operator, meaning you can choose either string on its two sides. If there are multiple OR operators at the same level, it can be viewed as choosing any one of the strings separated by these OR operators.\n\nFor example, `(aaa)aa|aa|(a(aa)a)`, `(aaaaa)|(aa)|aaaa`, and `aaaaa|aaaa|aa` are equivalent. They all match all-`a` strings of length $2,4$ or $5$.\n\nGiven a simplified regular expression, write a program to compute the maximum length of an all-`a` string it can match.", "inputFormat": "One line containing a valid simplified regular expression.", "outputFormat": "One line containing an integer, which is the maximum length of an all-`a` string that can be matched.", "hint": "[Constraints]\n\nFor $20\\%$ of the testdata, the expression length does not exceed $100$, and there are no parentheses.\n\nFor $40\\%$ of the testdata, the expression length does not exceed $100$.\n\nFor $70\\%$ of the testdata, the expression length does not exceed $2 \\times 10^3$.\n\nFor $100\\%$ of the testdata, the expression length does not exceed $10^5$.\n\nThe expression is guaranteed to be valid (i.e., the results on both sides of `|` and inside parentheses are non-empty strings).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2017初中组] rexp", "background": "为了解决形形色色的字符串匹配问题，正则表达式是一个强有力的工具。正则表达式通过定义一套符号体系，能够表示出需要查找的字符串所具有的性质。如 `a|aa` 能匹配 `a` 或 `aa`，`(a|b)c` 能匹配 `ac` 或 `bc`。\n", "description": "完整的正则表达式过于复杂，在这里我们只考虑由 `(`、`)`、`|` 和 `a` 组成的正则表达式。运算遵循下列法则：\n\n1. 有括号时，我们总是先算括号内的部分；\n\n2. 当两个字符串（或由括号定义的子串）间没有符号时，我们总把它们连起来作为一个整体；\n\n3. `|` 是或连接符，表示两边的字符串任取其一，若同一层里有多个或连接符，可以看作在这些或连接符所分开的若干字符串里任取其一。\n\n例如，`(aaa)aa|aa|(a(aa)a)`、`(aaaaa)|(aa)|aaaa` 和 `aaaaa|aaaa|aa` 是等价的，它们都能匹配长度为 $2,4$ 或 $5$ 的全 `a` 字符串。\n\n下面给定一个简化正则表达式，试编程计算它最多能匹配多长的全 `a` 字符串。", "inputFormat": "输入一行一个合法的简化正则表达式。\n", "outputFormat": "一行一个整数，表示能匹配的最长全 `a` 字符串长度。", "hint": "**【数据范围】**\n\n对于 $20\\%$ 数据，表达式长度不超过 $100$，且不存在括号。\n\n对于 $40\\%$ 数据，表达式长度不超过 $100$。\n\n对于 $70\\%$ 数据，表达式长度不超过 $2 \\times 10^3$。\n\n对于 $100\\%$ 的数据，表达式长度不超过 $10^5$。\n\n保证表达式合法（即 `|` 两端和括号内运算结果均非空字符串）。", "locale": "zh-CN"}}}
{"pid": "P3720", "type": "P", "difficulty": 5, "samples": [["5 7 \n3 4 7 1\n1 3 2 20\n1 4 17 18\n4 5 25 3\n1 2 10 1\n3 5 4 14\n2 4 6 5", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2017", "安徽", "最短路"], "title": "[AHOI2017初中组] guide", "background": null, "description": "农场主 John 最近在网上买了一辆新车，在购买汽车配件时，John 不小心点了两次“提交”按钮。导致汽车上安装了两套 GPS 系统，更糟糕的是 John 在使用 GPS 导航时，两套系统常常给出不同的路线。从地图上看，John 居住的地区有 $N$（$2 \\le N \\le 10^5$）个十字路口和 $M$（$1 \\le M \\le 5 \\times 10^5$）条限定通行方向的道路。第 $i$ 条道路连接路口 $A_i$（$1 \\le A_i \\le N$）和 $B_i$（$1 \\le B_i \\le N$），两个路口之间可能连接有多条道路。允许双向通⾏的道路是将两条单向通⾏的道路隔开所形成的。\n\n\nJohn 的家在路口 $1$ 位置，农场在路口 $N$ 的位置。John 可以沿着⼀系列单向道路从家驾车到农场。所有 GPS 系统的底层地图信息都是⼀样的，区别仅在于对每一条道路的通⾏时间计算不同。对于第 $i$ 条道路第一套 GPS 系统计算通行时间为 $P_i$ 个单位时间，而第二套 GPS 系统则给出 $Q_i$ 个单位时间。（所有道路的通行时间都是范围在 $1$ 到 $10^5$ 之间的整数）John 想要驾车从家到农场。可是，一路上 GPS 系统总是不厌其烦的提醒 John（请从路口 $X$ 开往路口 $Y$），这是由于 John 选取了某套 GPS 系统建议的路径，而另一套 GPS 系统则认为这不是从路口 $X$ 到农场的最短路径。我们称之为 GPS 系统的抱怨。\n\n\n请你计算一下如果 John 选择合适的路径到达农场能听到的最少 GPS 系统的抱怨数。如果 John 经过某条道路两套 GPS 系统都发出抱怨，则抱怨总数加 $2$。", "inputFormat": "第一行，两个整数 $N$ 和 $M$。\n\n接下来 $M$ 行，其中第 $i$ 行描述了道路 $i$ 的信息：$A_i,B_i,P_i,Q_i$。", "outputFormat": "一个整数，表示 John 一路上能听到的最小抱怨数。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2017 Middle School] guide", "background": "", "description": "Farmer John recently bought a new car online. While ordering accessories, he accidentally clicked the “Submit” button twice, so the car was fitted with two GPS systems. Even worse, the two systems often suggest different routes during navigation. The region where John lives has $N$ ($2 \\le N \\le 10^5$) intersections and $M$ ($1 \\le M \\le 5 \\times 10^5$) directed roads. The $i$-th road goes from intersection $A_i$ ($1 \\le A_i \\le N$) to $B_i$ ($1 \\le B_i \\le N$). There may be multiple roads between the same pair of intersections. A bidirectional road can be modeled as two directed roads in opposite directions.\n\nJohn’s home is at intersection $1$, and the farm is at intersection $N$. John can drive from home to the farm along a sequence of directed roads. Both GPS systems share the same base map; the only difference is how they compute travel times for each road. For the $i$-th road, the first GPS estimates a travel time of $P_i$ units, and the second GPS estimates $Q_i$ units. All road travel times are integers in the range $1$ to $10^5$.\n\nJohn wants to drive from home to the farm. Along the way, the GPS systems keep nagging him with prompts like “Please go from intersection $X$ to intersection $Y$.” This happens because John follows the route recommended by one GPS, while the other GPS considers this not to be a shortest path from $X$ to the farm. We call each such event a complaint from a GPS.\n\nPlease compute the minimum total number of complaints John will hear if he chooses an appropriate route to the farm. If, on some road, both GPS systems complain, then the total number of complaints increases by $2$.", "inputFormat": "The first line contains two integers $N$ and $M$.\n\nThe next $M$ lines describe the roads. The $i$-th line contains $A_i, B_i, P_i, Q_i$.", "outputFormat": "Output a single integer, the minimum total number of complaints along John’s route.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2017初中组] guide", "background": null, "description": "农场主 John 最近在网上买了一辆新车，在购买汽车配件时，John 不小心点了两次“提交”按钮。导致汽车上安装了两套 GPS 系统，更糟糕的是 John 在使用 GPS 导航时，两套系统常常给出不同的路线。从地图上看，John 居住的地区有 $N$（$2 \\le N \\le 10^5$）个十字路口和 $M$（$1 \\le M \\le 5 \\times 10^5$）条限定通行方向的道路。第 $i$ 条道路连接路口 $A_i$（$1 \\le A_i \\le N$）和 $B_i$（$1 \\le B_i \\le N$），两个路口之间可能连接有多条道路。允许双向通⾏的道路是将两条单向通⾏的道路隔开所形成的。\n\n\nJohn 的家在路口 $1$ 位置，农场在路口 $N$ 的位置。John 可以沿着⼀系列单向道路从家驾车到农场。所有 GPS 系统的底层地图信息都是⼀样的，区别仅在于对每一条道路的通⾏时间计算不同。对于第 $i$ 条道路第一套 GPS 系统计算通行时间为 $P_i$ 个单位时间，而第二套 GPS 系统则给出 $Q_i$ 个单位时间。（所有道路的通行时间都是范围在 $1$ 到 $10^5$ 之间的整数）John 想要驾车从家到农场。可是，一路上 GPS 系统总是不厌其烦的提醒 John（请从路口 $X$ 开往路口 $Y$），这是由于 John 选取了某套 GPS 系统建议的路径，而另一套 GPS 系统则认为这不是从路口 $X$ 到农场的最短路径。我们称之为 GPS 系统的抱怨。\n\n\n请你计算一下如果 John 选择合适的路径到达农场能听到的最少 GPS 系统的抱怨数。如果 John 经过某条道路两套 GPS 系统都发出抱怨，则抱怨总数加 $2$。", "inputFormat": "第一行，两个整数 $N$ 和 $M$。\n\n接下来 $M$ 行，其中第 $i$ 行描述了道路 $i$ 的信息：$A_i,B_i,P_i,Q_i$。", "outputFormat": "一个整数，表示 John 一路上能听到的最小抱怨数。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P3721", "type": "P", "difficulty": 6, "samples": [["5\n1 2\n1 1\n1 3\n4 \n5", "1 \n2 \n2\n2 \n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "2017", "线段树", "各省省选", "离散化", "安徽", "湖南", "动态树 LCT"], "title": "[AHOI2017/HNOI2017] 单旋", "background": null, "description": "H 国是一个热爱写代码的国家，那里的人们很小去学校学习写各种各样的数据结构。伸展树（splay）是一种数据结构，因为代码好写，功能多，效率高，掌握这种数据结构成为了 H 国的必修技能。有一天，邪恶的“卡”带着他的邪恶的“常数” 来企图毁灭 H 国。“卡” 给 H 国的人洗脑说，splay 如果写成单旋的，将会更快。“卡”称“单旋 splay”为“spaly”。虽说他说的很没道理，但还是有 H 国的人相信了，小 H 就是其中之一，spaly 马上成为他的信仰。而 H 国的国王，自然不允许这样的风气蔓延，国王构造了一组数据，数据由 $m$（不超过 $10^5$）个操作构成，他知道这样的数据肯定打垮 spaly，但是国王还有很多很多其他的事情要做，所以统计每个操作所需要的实际代价的任务就交给你啦。\n\n数据中的操作分为 $5$ 种：\n\n1. 插入操作：向当前非空 spaly 中插入一个关键码为 $key$ 的新孤立节点。插入方法为，先让 $key$ 和根比较，如果 $key$ 比根小，则往左子树走，否则往右子树走，如此反复，直到某个时刻，$key$ 比当前子树根 $x$ 小，而 $x$ 的左子树为空，那就让 $key$ 成为 $x$ 的左孩子；或者 $key$ 比当前子树根 $x$ 大，而 $x$ 的右子树为空，那就让 $key$ 成为 $x$ 的右孩子。该操作的代价为：插入后，$key$ 的深度。特别地，若树为空，则直接让新节点成为一个单个节点的树。（各节点关键码互不相等。对于“深度” 的解释见末尾对 spaly 的描述。）\n\n2. 单旋最小值：将 spaly 中关键码最小的元素 $x \\min$ 单旋到根。操作代价为：单旋前 $x \\min$ 的深度。（对于单旋操作的解释见末尾对 spaly 的描述。）\n\n3. 单旋最大值：将 spaly 中关键码最大的元素 $x \\max$ 单旋到根。操作代价为：单旋前 $x \\max$ 的深度。\n\n4. 单旋删除最小值：先执行 $2$ 号操作，然后把根删除。由于 $2$ 号操作之后，根没有左子树，所以直接切断根和右子树的联系即可。（具体见样例解释）。操作代价同 $2$ 号操作。\n\n5. 单旋删除最大值：先执行 $3$ 号操作，然后把根删除。操作代价同 $3$ 号操作。\n\n![](https://cdn.luogu.com.cn/upload/pic/5106.png)\n\n对于不是 H 国的人，你可能需要了解一些 spaly 的知识，才能完成国王的任务：\n\n1. spaly 是一棵二叉树，满足对于任意一个节点 $x$，它如果有左孩子 $lx$，那么 $lx$ 的关键码小于 $x$ 的关键码。如果有右孩子 $rx$，那么 $rx$ 的关键码大于 $x$ 的关键码。\n\n2. 一个节点在 spaly 的深度定义为：从根节点到该节点的路径上一共有多少个节点（包括自己）。\n\n3. 单旋操作是对于一棵树上的节点 $x$ 来说的。一开始，设 $f$ 为 $x$ 在树上的父亲。如果 $x$ 为 $f$ 的左孩子，那么执行 $zig (x)$ 操作（如上图中，左边的树经过 $zig (x)$ 变为了右边的树）, 否则执行 $zag (x)$ 操作（在上图中，将右边的树经过 $zag (f)$ 就变成了左边的树）。每当执行一次 $zig (x)$ 或者 $zag (x)$,$x$ 的深度减小 $1$，如此反复，直到 $x$ 为根。总之，单旋 $x$ 就是通过反复执行 $zig$ 和 $zag$ 将 $x$ 变为根。", "inputFormat": "输入文件名为 ```splay.in```。\n\n第一行单独一个正整数 $m$ ($1 \\leq m \\leq 10^5$)。\n\n接下来 $m$ 行，每行描述一个操作：首先是一个操作编号 $c$（ $1 \\leq c \\leq 5$），既问题描述中给出的 $5$ 种操作中的编号，若 $c= 1$，则再输入一个非负整数 key，表示新插入节点的关键码。", "outputFormat": "输出文件名为 ```splay.out```。\n\n输出共 $m$ 行，每行一个整数，第 $i$ 行对应第 $i$ 个输入的操作的代价。", "hint": "$20 \\%$ 的数据满足： $1 \\leq m \\leq 1000$。\n\n另外 $30\\%$ 的数据满足：不存在 $4,5$ 操作。\n\n$100\\%$ 的数据满足：$1 \\leq m \\leq 10^5,1 \\leq key \\leq 10^9$。 所有出现的关键码互不相同。 任何一个非插入操作，一定保证树非空。 在未执行任何操作之前，树为空。", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2017/HNOI2017] Single Rotation", "background": "", "description": "The Kingdom of H is a nation passionate about coding. People there go to school from a young age to learn all kinds of data structures. The splay tree (splay) is a data structure that is easy to implement, feature-rich, and efficient; mastering it is a required skill in the Kingdom of H. One day, the evil \"Ka\" (Kǎ) came with his evil \"constant factor\" to try to destroy the kingdom. \"Ka\" brainwashed the people of H by saying that if a splay is implemented using only single rotations, it would be faster. \"Ka\" called this \"single-rotation splay\" a \"spaly\". Although this makes little sense, some people in H believed him—Little H was one of them—and \"spaly\" immediately became his faith. The king of H, of course, would not allow such a trend to spread. The king constructed a piece of testdata consisting of $m$ (no more than $10^5$) operations. He knows this testdata will surely defeat spaly, but the king has many other things to do, so the task of computing the actual cost of each operation is handed over to you.\n\nThere are $5$ types of operations in the testdata:\n\n1. Insert: Insert a new isolated node with key $key$ into the current non-empty spaly. The insertion method is: first compare $key$ with the root. If $key$ is smaller than the root, go to the left subtree; otherwise go to the right subtree. Repeat this until, at some point, $key$ is smaller than the current subtree root $x$ and $x$’s left subtree is empty—then make $key$ the left child of $x$; or $key$ is larger than the current subtree root $x$ and $x$’s right subtree is empty—then make $key$ the right child of $x$. The cost of this operation is: the depth of $key$ after insertion. In particular, if the tree is empty, directly make the new node the entire one-node tree. (All keys are distinct. For the definition of “depth,” see the spaly description at the end.)\n\n2. Single-rotate minimum: Single-rotate the element with the minimum key $x_{\\min}$ in the spaly to the root. The operation cost is: the depth of $x_{\\min}$ before the single rotation. (For single rotation, see the spaly description at the end.)\n\n3. Single-rotate maximum: Single-rotate the element with the maximum key $x_{\\max}$ in the spaly to the root. The operation cost is: the depth of $x_{\\max}$ before the single rotation.\n\n4. Single-rotate delete minimum: First perform operation 2, then delete the root. After operation 2, the root has no left subtree, so simply replace the root with its right subtree (see the sample explanation for details). The operation cost is the same as in operation 2.\n\n5. Single-rotate delete maximum: First perform operation 3, then delete the root. The operation cost is the same as in operation 3.\n\n![](https://cdn.luogu.com.cn/upload/pic/5106.png)\n\nIf you are not from the Kingdom of H, you may need to know some spaly knowledge to complete the king’s task:\n\n1. A spaly is a binary tree that satisfies: for any node $x$, if it has a left child $lx$, then the key of $lx$ is less than the key of $x$; if it has a right child $rx$, then the key of $rx$ is greater than the key of $x$.\n\n2. The depth of a node in a spaly is defined as: the number of nodes on the path from the root to that node (including itself).\n\n3. The single rotation operation is defined for a node $x$ in a tree. Initially, let $f$ be the parent of $x$ in the tree. If $x$ is the left child of $f$, then perform zig(x) (as in the figure above, the left tree becomes the right tree after zig(x)); otherwise perform zag(x) (in the figure above, applying zag(f) to the right tree turns it back into the left tree). Each time you perform zig(x) or zag(x), the depth of $x$ decreases by $1$. Repeat this until $x$ becomes the root. In short, single-rotating $x$ means repeatedly performing zig and zag to make $x$ the root.", "inputFormat": "The input file is named ```splay.in```.\n\nThe first line contains a single positive integer $m$ ($1 \\leq m \\leq 10^5$).\n\nThen follow $m$ lines, each describing an operation: first an operation code $c$ ($1 \\leq c \\leq 5$), which is one of the $5$ types above. If $c = 1$, then an additional non-negative integer $key$ is given, representing the key of the newly inserted node.", "outputFormat": "The output file is named ```splay.out```.\n\nOutput $m$ lines, one integer per line. The $i$-th line corresponds to the cost of the $i$-th input operation.", "hint": "$20\\%$ of the testdata satisfies: $1 \\leq m \\leq 1000$.\n\nAdditionally, $30\\%$ of the testdata satisfies: operations 4 and 5 do not appear.\n\n$100\\%$ of the testdata satisfies: $1 \\leq m \\leq 10^5$, $1 \\leq key \\leq 10^9$. All keys that appear are distinct. For any non-insert operation, the tree is guaranteed to be non-empty. Before any operation, the tree is empty.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2017/HNOI2017] 单旋", "background": null, "description": "H 国是一个热爱写代码的国家，那里的人们很小去学校学习写各种各样的数据结构。伸展树（splay）是一种数据结构，因为代码好写，功能多，效率高，掌握这种数据结构成为了 H 国的必修技能。有一天，邪恶的“卡”带着他的邪恶的“常数” 来企图毁灭 H 国。“卡” 给 H 国的人洗脑说，splay 如果写成单旋的，将会更快。“卡”称“单旋 splay”为“spaly”。虽说他说的很没道理，但还是有 H 国的人相信了，小 H 就是其中之一，spaly 马上成为他的信仰。而 H 国的国王，自然不允许这样的风气蔓延，国王构造了一组数据，数据由 $m$（不超过 $10^5$）个操作构成，他知道这样的数据肯定打垮 spaly，但是国王还有很多很多其他的事情要做，所以统计每个操作所需要的实际代价的任务就交给你啦。\n\n数据中的操作分为 $5$ 种：\n\n1. 插入操作：向当前非空 spaly 中插入一个关键码为 $key$ 的新孤立节点。插入方法为，先让 $key$ 和根比较，如果 $key$ 比根小，则往左子树走，否则往右子树走，如此反复，直到某个时刻，$key$ 比当前子树根 $x$ 小，而 $x$ 的左子树为空，那就让 $key$ 成为 $x$ 的左孩子；或者 $key$ 比当前子树根 $x$ 大，而 $x$ 的右子树为空，那就让 $key$ 成为 $x$ 的右孩子。该操作的代价为：插入后，$key$ 的深度。特别地，若树为空，则直接让新节点成为一个单个节点的树。（各节点关键码互不相等。对于“深度” 的解释见末尾对 spaly 的描述。）\n\n2. 单旋最小值：将 spaly 中关键码最小的元素 $x \\min$ 单旋到根。操作代价为：单旋前 $x \\min$ 的深度。（对于单旋操作的解释见末尾对 spaly 的描述。）\n\n3. 单旋最大值：将 spaly 中关键码最大的元素 $x \\max$ 单旋到根。操作代价为：单旋前 $x \\max$ 的深度。\n\n4. 单旋删除最小值：先执行 $2$ 号操作，然后把根删除。由于 $2$ 号操作之后，根没有左子树，所以直接切断根和右子树的联系即可。（具体见样例解释）。操作代价同 $2$ 号操作。\n\n5. 单旋删除最大值：先执行 $3$ 号操作，然后把根删除。操作代价同 $3$ 号操作。\n\n![](https://cdn.luogu.com.cn/upload/pic/5106.png)\n\n对于不是 H 国的人，你可能需要了解一些 spaly 的知识，才能完成国王的任务：\n\n1. spaly 是一棵二叉树，满足对于任意一个节点 $x$，它如果有左孩子 $lx$，那么 $lx$ 的关键码小于 $x$ 的关键码。如果有右孩子 $rx$，那么 $rx$ 的关键码大于 $x$ 的关键码。\n\n2. 一个节点在 spaly 的深度定义为：从根节点到该节点的路径上一共有多少个节点（包括自己）。\n\n3. 单旋操作是对于一棵树上的节点 $x$ 来说的。一开始，设 $f$ 为 $x$ 在树上的父亲。如果 $x$ 为 $f$ 的左孩子，那么执行 $zig (x)$ 操作（如上图中，左边的树经过 $zig (x)$ 变为了右边的树）, 否则执行 $zag (x)$ 操作（在上图中，将右边的树经过 $zag (f)$ 就变成了左边的树）。每当执行一次 $zig (x)$ 或者 $zag (x)$,$x$ 的深度减小 $1$，如此反复，直到 $x$ 为根。总之，单旋 $x$ 就是通过反复执行 $zig$ 和 $zag$ 将 $x$ 变为根。", "inputFormat": "输入文件名为 ```splay.in```。\n\n第一行单独一个正整数 $m$ ($1 \\leq m \\leq 10^5$)。\n\n接下来 $m$ 行，每行描述一个操作：首先是一个操作编号 $c$（ $1 \\leq c \\leq 5$），既问题描述中给出的 $5$ 种操作中的编号，若 $c= 1$，则再输入一个非负整数 key，表示新插入节点的关键码。", "outputFormat": "输出文件名为 ```splay.out```。\n\n输出共 $m$ 行，每行一个整数，第 $i$ 行对应第 $i$ 个输入的操作的代价。", "hint": "$20 \\%$ 的数据满足： $1 \\leq m \\leq 1000$。\n\n另外 $30\\%$ 的数据满足：不存在 $4,5$ 操作。\n\n$100\\%$ 的数据满足：$1 \\leq m \\leq 10^5,1 \\leq key \\leq 10^9$。 所有出现的关键码互不相同。 任何一个非插入操作，一定保证树非空。 在未执行任何操作之前，树为空。", "locale": "zh-CN"}}}
{"pid": "P3722", "type": "P", "difficulty": 6, "samples": [["10 5 2 3\n7 9 5 1 3 10 6 8 2 4\n1 7\n1 9\n1 3\n5 9\n1 5", "30\n39\n4\n13\n16"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "线段树", "各省省选", "安徽", "湖南", "排序", "栈"], "title": "[AHOI2017/HNOI2017] 影魔", "background": "影魔，奈文摩尔，据说有着一个诗人的灵魂。事实上，他吞噬的诗人灵魂早已成千上万。\n\n千百年来，他收集了各式各样的灵魂，包括诗人、牧师、帝王、乞丐、奴隶、罪人，当然，还有英雄。\n\n每一个灵魂，都有着自己的战斗力，而影魔，靠这些战斗力提升自己的攻击。", "description": "奈文摩尔有 $n$ 个灵魂，他们在影魔宽广的体内可以排成一排，从左至右标号 $1$ 到 $n$。第 $i$ 个灵魂的战斗力为 $k_i$，灵魂们以点对的形式为影魔提供攻击力。对于灵魂对 $i, j\\ (i<j)$ 来说，若不存在 $k_s\\ (i<s<j)$ 大于 $k_i$ 或者 $k_j$，则会为影魔提供 $p_1$ 的攻击力。另一种情况，令 $c$ 为 $k_{i + 1}, k_{i + 2}, \\cdots, k_{j -1}$ 的最大值，若 $c$ 满足：$k_i < c < k_j$，或者 $k_j < c < k_i$，则会为影魔提供 $p_2$ 的攻击力，当这样的 $c$ 不存在时，自然不会提供这 $p_2$ 的攻击力；其他情况的点对，均不会为影魔提供攻击力。\n\n影魔的挚友噬魂鬼在一天造访影魔体内时被这些灵魂吸引住了，他想知道，对于任意一段区间 $[a, b]$，位于这些区间中的灵魂对会为影魔提供多少攻击力，即考虑所有满足 $a\\le i<j\\le b$ 的灵魂对 $i, j$ 提供的攻击力之和。\n\n顺带一提，灵魂的战斗力组成一个 $1$ 到 $n$ 的排列：$k_1, k_2, \\cdots, k_n$。", "inputFormat": "第一行四个整数 $n,m,p_1,p_2$。  \n\n第二行 $n$ 个整数 $k_1, k_2,\\cdots, k_n$。\n\n接下来 $m$ 行,每行两个数 $a,b$，表示询问区间 $[a,b]$ 中的灵魂对会为影魔提供多少攻击力。", "outputFormat": "共输出 $m$ 行，每行一个答案，依次对应 $m$ 个询问。", "hint": "对于 $30\\%$ 的数据，$1\\le n, m\\le 500$。\n\n另有 $30\\%$ 的数据，$p_1 = 2p_2$。\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 200000, 1\\le p_1, p_2\\le 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2017/HNOI2017] Shadow Fiend", "background": "Shadow Fiend, Nevermore, is said to have the soul of a poet. In fact, the poet souls he has devoured already number in the tens of thousands.\n\nFor hundreds of years, he has collected all kinds of souls, including poets, priests, emperors, beggars, slaves, sinners, and of course, heroes.\n\nEach soul has its own combat power, and Shadow Fiend increases his attack power by relying on these combat powers.", "description": "Nevermore has $n$ souls. Inside the vast body of the Shadow Fiend, they can line up in a row, labeled from left to right $1$ to $n$. The $i$-th soul has combat power $k_i$, and souls provide attack power for the Shadow Fiend in the form of pairs. For a soul pair $i, j$ with $i < j$, if there is no $k_s$ with $i < s < j$ that is greater than $k_i$ or greater than $k_j$, then it provides $p_1$ attack power. In another case, let $c$ be the maximum of $k_{i + 1}, k_{i + 2}, \\cdots, k_{j - 1}$. If $c$ satisfies $k_i < c < k_j$, or $k_j < c < k_i$, then it provides $p_2$ attack power. When such a $c$ does not exist, it naturally does not provide this $p_2$ attack power. In all other cases, the pair does not provide any attack power.\n\nShadow Fiend’s close friend Lifestealer visited him one day and was captivated by these souls. He wants to know, for any interval $[a, b]$, how much attack power is provided by the soul pairs within these intervals, that is, consider the sum of the attack power provided by all soul pairs $i, j$ satisfying $a \\le i < j \\le b$.\n\nIncidentally, the souls’ combat powers form a permutation of $1$ to $n$: $k_1, k_2, \\cdots, k_n$.", "inputFormat": "The first line contains four integers $n, m, p_1, p_2$.\n\nThe second line contains $n$ integers $k_1, k_2, \\cdots, k_n$.\n\nThen there are $m$ lines. Each line contains two integers $a, b$, representing a query asking how much attack power is provided by the soul pairs within the interval $[a, b]$.", "outputFormat": "Output $m$ lines, each containing one answer, corresponding to the $m$ queries in order.", "hint": "For $30\\%$ of the testdata, $1 \\le n, m \\le 500$.\n\nFor another $30\\%$ of the testdata, $p_1 = 2 p_2$.\n\nFor $100\\%$ of the testdata, $1 \\le n, m \\le 200000$, $1 \\le p_1, p_2 \\le 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2017/HNOI2017] 影魔", "background": "影魔，奈文摩尔，据说有着一个诗人的灵魂。事实上，他吞噬的诗人灵魂早已成千上万。\n\n千百年来，他收集了各式各样的灵魂，包括诗人、牧师、帝王、乞丐、奴隶、罪人，当然，还有英雄。\n\n每一个灵魂，都有着自己的战斗力，而影魔，靠这些战斗力提升自己的攻击。", "description": "奈文摩尔有 $n$ 个灵魂，他们在影魔宽广的体内可以排成一排，从左至右标号 $1$ 到 $n$。第 $i$ 个灵魂的战斗力为 $k_i$，灵魂们以点对的形式为影魔提供攻击力。对于灵魂对 $i, j\\ (i<j)$ 来说，若不存在 $k_s\\ (i<s<j)$ 大于 $k_i$ 或者 $k_j$，则会为影魔提供 $p_1$ 的攻击力。另一种情况，令 $c$ 为 $k_{i + 1}, k_{i + 2}, \\cdots, k_{j -1}$ 的最大值，若 $c$ 满足：$k_i < c < k_j$，或者 $k_j < c < k_i$，则会为影魔提供 $p_2$ 的攻击力，当这样的 $c$ 不存在时，自然不会提供这 $p_2$ 的攻击力；其他情况的点对，均不会为影魔提供攻击力。\n\n影魔的挚友噬魂鬼在一天造访影魔体内时被这些灵魂吸引住了，他想知道，对于任意一段区间 $[a, b]$，位于这些区间中的灵魂对会为影魔提供多少攻击力，即考虑所有满足 $a\\le i<j\\le b$ 的灵魂对 $i, j$ 提供的攻击力之和。\n\n顺带一提，灵魂的战斗力组成一个 $1$ 到 $n$ 的排列：$k_1, k_2, \\cdots, k_n$。", "inputFormat": "第一行四个整数 $n,m,p_1,p_2$。  \n\n第二行 $n$ 个整数 $k_1, k_2,\\cdots, k_n$。\n\n接下来 $m$ 行,每行两个数 $a,b$，表示询问区间 $[a,b]$ 中的灵魂对会为影魔提供多少攻击力。", "outputFormat": "共输出 $m$ 行，每行一个答案，依次对应 $m$ 个询问。", "hint": "对于 $30\\%$ 的数据，$1\\le n, m\\le 500$。\n\n另有 $30\\%$ 的数据，$p_1 = 2p_2$。\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 200000, 1\\le p_1, p_2\\le 1000$。", "locale": "zh-CN"}}}
{"pid": "P3723", "type": "P", "difficulty": 6, "samples": [["5 6\n1 2 3 4 5\n6 3 3 4 5", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2017", "各省省选", "递归", "安徽", "湖南", "进制", "快速傅里叶变换 FFT"], "title": "[AHOI2017/HNOI2017] 礼物", "background": null, "description": "我的室友最近喜欢上了一个可爱的小女生。马上就要到她的生日了，他决定买一对情侣手环，一个留给自己，一个送给她。每个手环上各有 $n$ 个装饰物，并且每个装饰物都有一定的亮度。\n\n但是在她生日的前一天，我的室友突然发现他好像拿错了一个手环，而且已经没时间去更换它了！他只能使用一种特殊的方法，将其中一个手环中所有装饰物的亮度增加一个相同的非负整数 $c$。并且由于这个手环是一个圆，可以以任意的角度旋转它，但是由于上面装饰物的方向是固定的，所以手环不能翻转。需要在经过亮度改造和旋转之后，使得两个手环的差异值最小。\n\n在将两个手环旋转且装饰物对齐了之后，从对齐的某个位置开始逆时针方向对装饰物编号 $1 \\sim n$，其中 $n$ 为每个手环的装饰物个数， 第 $1$ 个手环的 $i$ 号位置装饰物亮度为 $x_i$，第 $2$ 个手环的 $i$ 号位置装饰物亮度为 $y_i$，两个手环之间的差异值为（参见输入输出样例和样例解释）：\n\n$$\\sum_{i=1}^{n} (x_i-y_i)^2$$\n\n麻烦你帮他计算一下，进行调整（亮度改造和旋转），使得两个手环之间的差异值最小，这个最小值是多少呢？", "inputFormat": "输入数据的第一行有两个数 $n,m$，代表每条手环的装饰物的数量为 $n$，每个装饰物的初始亮度小于等于 $m$。\n\n接下来两行，每行各有 $n$ 个数，分别代表第一条手环和第二条手环上从某个位置开始逆时针方向上各装饰物的亮度。", "outputFormat": "输出一个数，表示两个手环能产生的最小差异值。注意在将手环改造之后，装饰物的亮度可以大于 $m$。", "hint": "【样例解释】\n\n需要将第一个手环的亮度增加 $1$，第一个手环的亮度变为：$2,3,4,5,6$\n\n旋转一下第二个手环。对于该样例，是将第二个手环的亮度 $6,3,3,4,5$ 向左循环移动一个位置，使得第二手环的最终的亮度为：$3,3,4,5,6$。\n\n此时两个手环的亮度差异值为 $1$。\n\n【数据范围】\n\n对于 $30\\%$ 的数据，$n \\le 500$，$m \\le 10$；\n\n对于 $70\\%$ 的数据，$n \\le 5000$；\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 50000$, $1 \\le x_i,y_i \\le m \\le 100$。", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2017/HNOI2017] Gift", "background": "", "description": "My roommate recently fell for a cute girl. Her birthday is coming up, and he decided to buy a pair of couple bracelets: one for himself and one for her. Each bracelet has $n$ decorations, and each decoration has a certain brightness.\n\nHowever, on the day before her birthday, my roommate suddenly realized that he might have picked up the wrong bracelet, and there is no time to replace it. He can only use a special method: increase the brightness of all decorations on one of the bracelets by the same non-negative integer $c$. Since a bracelet is a circle, it can be rotated by any angle, but because the orientation of the decorations is fixed, the bracelet cannot be flipped. After applying the brightness modification and rotation, we want to minimize the difference value between the two bracelets.\n\nAfter rotating both bracelets and aligning the decorations, starting from some aligned position and numbering the decorations from $1$ to $n$ in counterclockwise order (where $n$ is the number of decorations on each bracelet), the brightness of the decoration at position $i$ on the first bracelet is $x_i$, and that on the second bracelet is $y_i$. The difference value between the two bracelets is:\n$$\\sum_{i=1}^{n} (x_i-y_i)^2$$\n\nPlease help compute the minimal possible difference value after applying the allowed brightness modification and rotation.", "inputFormat": "The first line contains two integers $n, m$, where each bracelet has $n$ decorations, and the initial brightness of each decoration is at most $m$.\n\nThe next two lines each contain $n$ integers, representing the brightness of the decorations on the first and second bracelets, respectively, listed in counterclockwise order starting from some position.", "outputFormat": "Output a single integer: the minimal difference value that can be achieved between the two bracelets. Note that after the modification, the brightness of decorations may exceed $m$.", "hint": "Sample explanation:\n\nIncrease the brightness of the first bracelet by $1$, making it $2, 3, 4, 5, 6$.\n\nRotate the second bracelet. In this sample, cyclically shift the second bracelet $6, 3, 3, 4, 5$ left by one position, making it $3, 3, 4, 5, 6$.\n\nThe difference value is $1$.\n\nConstraints:\n\n- For $30\\%$ of the testdata, $n \\le 500$, $m \\le 10$.\n- For $70\\%$ of the testdata, $n \\le 5000$.\n- For $100\\%$ of the testdata, $1 \\le n \\le 50000$, $1 \\le x_i, y_i \\le m \\le 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2017/HNOI2017] 礼物", "background": null, "description": "我的室友最近喜欢上了一个可爱的小女生。马上就要到她的生日了，他决定买一对情侣手环，一个留给自己，一个送给她。每个手环上各有 $n$ 个装饰物，并且每个装饰物都有一定的亮度。\n\n但是在她生日的前一天，我的室友突然发现他好像拿错了一个手环，而且已经没时间去更换它了！他只能使用一种特殊的方法，将其中一个手环中所有装饰物的亮度增加一个相同的非负整数 $c$。并且由于这个手环是一个圆，可以以任意的角度旋转它，但是由于上面装饰物的方向是固定的，所以手环不能翻转。需要在经过亮度改造和旋转之后，使得两个手环的差异值最小。\n\n在将两个手环旋转且装饰物对齐了之后，从对齐的某个位置开始逆时针方向对装饰物编号 $1 \\sim n$，其中 $n$ 为每个手环的装饰物个数， 第 $1$ 个手环的 $i$ 号位置装饰物亮度为 $x_i$，第 $2$ 个手环的 $i$ 号位置装饰物亮度为 $y_i$，两个手环之间的差异值为（参见输入输出样例和样例解释）：\n\n$$\\sum_{i=1}^{n} (x_i-y_i)^2$$\n\n麻烦你帮他计算一下，进行调整（亮度改造和旋转），使得两个手环之间的差异值最小，这个最小值是多少呢？", "inputFormat": "输入数据的第一行有两个数 $n,m$，代表每条手环的装饰物的数量为 $n$，每个装饰物的初始亮度小于等于 $m$。\n\n接下来两行，每行各有 $n$ 个数，分别代表第一条手环和第二条手环上从某个位置开始逆时针方向上各装饰物的亮度。", "outputFormat": "输出一个数，表示两个手环能产生的最小差异值。注意在将手环改造之后，装饰物的亮度可以大于 $m$。", "hint": "【样例解释】\n\n需要将第一个手环的亮度增加 $1$，第一个手环的亮度变为：$2,3,4,5,6$\n\n旋转一下第二个手环。对于该样例，是将第二个手环的亮度 $6,3,3,4,5$ 向左循环移动一个位置，使得第二手环的最终的亮度为：$3,3,4,5,6$。\n\n此时两个手环的亮度差异值为 $1$。\n\n【数据范围】\n\n对于 $30\\%$ 的数据，$n \\le 500$，$m \\le 10$；\n\n对于 $70\\%$ 的数据，$n \\le 5000$；\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 50000$, $1 \\le x_i,y_i \\le m \\le 100$。", "locale": "zh-CN"}}}
{"pid": "P3724", "type": "P", "difficulty": 7, "samples": [["30 20 30\n15 5 24 14 13 4 14 21 3 16 7 4 7 8 13 19 16 5 6 13 21 12 7 9 4 15 20 4 13 12\n22 21 15 16 17 1 21 19 11 8 3 28 7 10 19 3 27 17 28 3 26 4 22 28 15 5 26 9 5 26\n30\n10\n18\n29\n18\n29\n3\n12\n28\n11\n28\n6\n1\n6\n27\n27\n18\n11\n26\n1", "0\n1\n1\n0\n1\n0\n1\n1\n0\n0\n0\n1\n1\n1\n1\n1\n1\n0\n0\n1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "2017", "各省省选", "安徽", "湖南", "枚举", "栈"], "title": "[AHOI2017/HNOI2017] 大佬", "background": "", "description": "人们总是难免会碰到大佬。他们趾高气昂地谈论凡人不能理解的算法和数据结构，走到任何一个地方，大佬的气场就能让周围的人吓得瑟瑟发抖，不敢言语。你作为一个 OIer，面对这样的事情非常不开心，于是发表了对大佬不敬的言论。 大佬便对你开始了报复，你也不示弱，扬言要打倒大佬。现在给你讲解一下什么是大佬，大佬除了是神犇以外，还有着强大的自信心，自信程度可以被量化为一个正整数 $C$，想要打倒一个大佬的唯一方法是摧毁 Ta 的自信心，也就是让大佬的自信值**等于** $0$（恰好等于 $0$，不能小于 $0$）。由于你被大佬盯上了，所以你需要准备好 $n$ 天来和大佬较量，因为这 $n$ 天大佬只会嘲讽你动摇你的自信，到了第 $n+1$ 天，如果大佬发现你还不服，就会直接虐到你服，这样你就丧失斗争的能力了。\n\n你的自信程度同样也可以被量化，我们用 $\\mathrm{mc}$ 来表示你的自信值**上限**。在第 $i \\ (i\\ge 1)$ 天，大佬会对你发动一次嘲讽，使你的自信值减小 $a_i$，如果这个时刻你的自信值**小于** $0$ 了，那么你就丧失斗争能力，也就**失败**了（特别注意你的自信值为 $0$ 的时候还可以继续和大佬斗争）。 在这一天，大佬对你发动嘲讽之后，如果你的自信值仍大于等于 $0$，你**能且仅能**选择如下的行为**之一**：\n\n1. 还一句嘴，大佬会有点惊讶，导致大佬的自信值 $C$ 减小 $1$。\n2. 做一天的水题，使得自己的当前自信值增加 $w_i$，并将新自信值和自信值上限 $\\mathrm{mc}$ 比较，若新自信值大于 $\\mathrm{mc}$，则新自信值更新为 $\\mathrm{mc}$。例如，$\\mathrm{mc} = 50$，当前自信值为 $40$，若 $w_i = 5$，则新自信值为 $45$，若 $w_i = 11$，则新自信值为 $50$。\n3. 让自己的等级值 $L$ 加 $1$。\n4. 让自己的讽刺能力 $F$ 乘以自己当前等级 $L$，使讽刺能力 $F$ 更新为 $F\\cdot L$。\n5. 怼大佬，让大佬的自信值 $C$ 减小 $F$。并在怼完大佬之后，你自己的等级 $L$ 自动降为 $0$，讽刺能力 $F$ 降为 $1$。由于怼大佬比较掉人品，所以这个操作只能做**不超过两次**。\n\n**特别注意**的是，在任何时候，你**不能**让大佬的自信值**为负**，因为自信值为负，对大佬来说意味着屈辱，而大佬但凡遇到屈辱就会进化为更厉害的大佬直接虐飞你。在第 $1$ 天，在你被攻击之前，你的自信是满的（初始自信值等于自信值上限 $\\mathrm{mc}$），你的讽刺能力 $F$ 是 $1$，等级是 $0$。\n\n\n现在由于你得罪了大佬，你需要准备和大佬正面杠，你知道世界上一共有 $m$ 个大佬，他们的嘲讽时间都是 $n$ 天，而且第 $i$ 天的嘲讽值都是 $a_i$。不管和哪个大佬较量，你在第 $i$ 天做水题的自信回涨都是 $w_i$。这 $m$ 个大佬中**只会有一个**来和你较量（$n$ 天里都是这个大佬和你较量），但是作为你，你需要知道对于任意一个大佬，你是否能摧毁他的自信，也就是让他的自信值恰好等于 $0$。和某一个大佬较量时，其他大佬不会插手。", "inputFormat": "第一行三个正整数 $n,m,\\mathrm{mc}$。分别表示有 $n$ 天和 $m$ 个大佬，你的自信上限为 $\\mathrm{mc}$。\n\n接下来一行是用空格隔开的 $n$ 个数，其中第 $i(1\\le i\\le n)$ 个表示 $a_i$。\n\n接下来一行是用空格隔开的 $n$ 个数，其中第 $i(1\\le i\\le n)$ 个表示 $w_i$。\n\n接下来 $m$ 行，每行一个正整数，其中第 $k(1\\le k\\le m)$ 行的正整数 $C_k$ 表示第 $k$ 个大佬的初始自信值。", "outputFormat": "共 $m$ 行，如果能战胜第 $k$ 个大佬（让他的自信值恰好等于 0），那么第 $k$ 行输出 $1$，否则输出 $0$。", "hint": "- 对于 $20\\%$ 的数据，$1\\le n\\le 10$；\n- 另有 $20\\%$ 数据，$1\\le C_i,n,\\mathrm{mc}\\le 30$；\n- 对于 $100\\%$ 的数据，$1\\le n, \\mathrm{mc}\\le 100, 1\\le m\\le 20; 1\\le a_i, w_i\\le\\mathrm{mc}, 1\\le C_i\\le 10^8$。", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2017/HNOI2017] Dalao", "background": "", "description": "People inevitably run into “dalao.” They swagger around, talking about algorithms and data structures that ordinary folks cannot grasp. Wherever they go, their presence makes others tremble and fall silent. As an OIer, you are very unhappy about this and make some disrespectful remarks. The dalao starts to take revenge on you, and you refuse to back down, vowing to bring them down. Let us explain what a dalao is: besides being a “shen niu,” a dalao also has strong self-confidence, which can be quantified by a positive integer $C$. The only way to defeat a dalao is to destroy their self-confidence, i.e., make the dalao’s confidence value equal to $0$ (exactly $0$, not less than $0$). Since you are targeted, you must prepare for $n$ days to contend with the dalao: during these $n$ days the dalao will only mock you to shake your confidence. On day $n+1$, if the dalao finds you still unconvinced, they will crush you directly, and you will lose the ability to fight.\n\nYour confidence can also be quantified. Let $\\mathrm{mc}$ be your confidence upper bound. On day $i$ ($i \\ge 1$), the dalao taunts you once, decreasing your confidence by $a_i$. If at that moment your confidence becomes less than $0$, you lose the ability to fight and thus fail (note in particular that when your confidence is $0$, you can still continue to fight the dalao). On that day, after the dalao’s taunt, if your confidence is still at least $0$, you can and only can choose exactly one of the following actions:\n\n1. Talk back once. The dalao is a bit surprised, so the dalao’s confidence $C$ decreases by $1$.\n2. Solve easy problems for a day, increasing your current confidence by $w_i$, then compare the new confidence with the upper bound $\\mathrm{mc}$. If the new confidence exceeds $\\mathrm{mc}$, set it to $\\mathrm{mc}$. For example, if $\\mathrm{mc} = 50$, your current confidence is $40$, and $w_i = 5$, then the new confidence is $45$; if $w_i = 11$, then the new confidence is $50$.\n3. Increase your level $L$ by $1$.\n4. Multiply your taunt power $F$ by your current level $L$, i.e., update $F$ to $F \\cdot L$.\n5. Roast the dalao, decreasing the dalao’s confidence $C$ by $F$. After roasting the dalao, your level $L$ automatically drops to $0$, and your taunt power $F$ becomes $1$. Since roasting the dalao costs reputation, this operation can be performed at most twice.\n\nPay special attention: at any time, you must not make the dalao’s confidence negative. A negative confidence value is a humiliation to the dalao, and whenever humiliated, the dalao evolves into an even stronger dalao who instantly crushes you. On day $1$, before you are attacked, your confidence is full (initial confidence equals the upper bound $\\mathrm{mc}$), your taunt power $F$ is $1$, and your level $L$ is $0$.\n\nSince you have offended the dalao, you must prepare to confront them head-on. You know there are $m$ dalao in the world. Their taunting lasts $n$ days, and the taunt value on day $i$ is $a_i$. No matter which dalao you face, the confidence recovery from solving easy problems on day $i$ is $w_i$. Among these $m$ dalao, exactly one will fight you (the same one for all $n$ days). But you need to know, for each dalao, whether you can destroy their confidence, i.e., make their confidence value exactly $0$. When you fight one dalao, the others do not interfere.", "inputFormat": "The first line contains three positive integers $n, m, \\mathrm{mc}$, denoting that there are $n$ days and $m$ dalao, and your confidence upper bound is $\\mathrm{mc}$.\n\nThe next line contains $n$ integers separated by spaces. The $i$-th ($1 \\le i \\le n$) denotes $a_i$.\n\nThe next line contains $n$ integers separated by spaces. The $i$-th ($1 \\le i \\le n$) denotes $w_i$.\n\nThen follow $m$ lines, each containing one positive integer. On the $k$-th ($1 \\le k \\le m$) line, the integer $C_k$ denotes the initial confidence of the $k$-th dalao.", "outputFormat": "Output $m$ lines. If you can defeat the $k$-th dalao (make their confidence exactly $0$), output $1$ on the $k$-th line; otherwise, output $0$.", "hint": "- For $20\\%$ of the testdata, $1 \\le n \\le 10$.\n- For another $20\\%$ of the testdata, $1 \\le C_i, n, \\mathrm{mc} \\le 30$.\n- For $100\\%$ of the testdata, $1 \\le n, \\mathrm{mc} \\le 100$, $1 \\le m \\le 20$, $1 \\le a_i, w_i \\le \\mathrm{mc}$, $1 \\le C_i \\le 10^8$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2017/HNOI2017] 大佬", "background": "", "description": "人们总是难免会碰到大佬。他们趾高气昂地谈论凡人不能理解的算法和数据结构，走到任何一个地方，大佬的气场就能让周围的人吓得瑟瑟发抖，不敢言语。你作为一个 OIer，面对这样的事情非常不开心，于是发表了对大佬不敬的言论。 大佬便对你开始了报复，你也不示弱，扬言要打倒大佬。现在给你讲解一下什么是大佬，大佬除了是神犇以外，还有着强大的自信心，自信程度可以被量化为一个正整数 $C$，想要打倒一个大佬的唯一方法是摧毁 Ta 的自信心，也就是让大佬的自信值**等于** $0$（恰好等于 $0$，不能小于 $0$）。由于你被大佬盯上了，所以你需要准备好 $n$ 天来和大佬较量，因为这 $n$ 天大佬只会嘲讽你动摇你的自信，到了第 $n+1$ 天，如果大佬发现你还不服，就会直接虐到你服，这样你就丧失斗争的能力了。\n\n你的自信程度同样也可以被量化，我们用 $\\mathrm{mc}$ 来表示你的自信值**上限**。在第 $i \\ (i\\ge 1)$ 天，大佬会对你发动一次嘲讽，使你的自信值减小 $a_i$，如果这个时刻你的自信值**小于** $0$ 了，那么你就丧失斗争能力，也就**失败**了（特别注意你的自信值为 $0$ 的时候还可以继续和大佬斗争）。 在这一天，大佬对你发动嘲讽之后，如果你的自信值仍大于等于 $0$，你**能且仅能**选择如下的行为**之一**：\n\n1. 还一句嘴，大佬会有点惊讶，导致大佬的自信值 $C$ 减小 $1$。\n2. 做一天的水题，使得自己的当前自信值增加 $w_i$，并将新自信值和自信值上限 $\\mathrm{mc}$ 比较，若新自信值大于 $\\mathrm{mc}$，则新自信值更新为 $\\mathrm{mc}$。例如，$\\mathrm{mc} = 50$，当前自信值为 $40$，若 $w_i = 5$，则新自信值为 $45$，若 $w_i = 11$，则新自信值为 $50$。\n3. 让自己的等级值 $L$ 加 $1$。\n4. 让自己的讽刺能力 $F$ 乘以自己当前等级 $L$，使讽刺能力 $F$ 更新为 $F\\cdot L$。\n5. 怼大佬，让大佬的自信值 $C$ 减小 $F$。并在怼完大佬之后，你自己的等级 $L$ 自动降为 $0$，讽刺能力 $F$ 降为 $1$。由于怼大佬比较掉人品，所以这个操作只能做**不超过两次**。\n\n**特别注意**的是，在任何时候，你**不能**让大佬的自信值**为负**，因为自信值为负，对大佬来说意味着屈辱，而大佬但凡遇到屈辱就会进化为更厉害的大佬直接虐飞你。在第 $1$ 天，在你被攻击之前，你的自信是满的（初始自信值等于自信值上限 $\\mathrm{mc}$），你的讽刺能力 $F$ 是 $1$，等级是 $0$。\n\n\n现在由于你得罪了大佬，你需要准备和大佬正面杠，你知道世界上一共有 $m$ 个大佬，他们的嘲讽时间都是 $n$ 天，而且第 $i$ 天的嘲讽值都是 $a_i$。不管和哪个大佬较量，你在第 $i$ 天做水题的自信回涨都是 $w_i$。这 $m$ 个大佬中**只会有一个**来和你较量（$n$ 天里都是这个大佬和你较量），但是作为你，你需要知道对于任意一个大佬，你是否能摧毁他的自信，也就是让他的自信值恰好等于 $0$。和某一个大佬较量时，其他大佬不会插手。", "inputFormat": "第一行三个正整数 $n,m,\\mathrm{mc}$。分别表示有 $n$ 天和 $m$ 个大佬，你的自信上限为 $\\mathrm{mc}$。\n\n接下来一行是用空格隔开的 $n$ 个数，其中第 $i(1\\le i\\le n)$ 个表示 $a_i$。\n\n接下来一行是用空格隔开的 $n$ 个数，其中第 $i(1\\le i\\le n)$ 个表示 $w_i$。\n\n接下来 $m$ 行，每行一个正整数，其中第 $k(1\\le k\\le m)$ 行的正整数 $C_k$ 表示第 $k$ 个大佬的初始自信值。", "outputFormat": "共 $m$ 行，如果能战胜第 $k$ 个大佬（让他的自信值恰好等于 0），那么第 $k$ 行输出 $1$，否则输出 $0$。", "hint": "- 对于 $20\\%$ 的数据，$1\\le n\\le 10$；\n- 另有 $20\\%$ 数据，$1\\le C_i,n,\\mathrm{mc}\\le 30$；\n- 对于 $100\\%$ 的数据，$1\\le n, \\mathrm{mc}\\le 100, 1\\le m\\le 20; 1\\le a_i, w_i\\le\\mathrm{mc}, 1\\le C_i\\le 10^8$。", "locale": "zh-CN"}}}
{"pid": "P3725", "type": "P", "difficulty": 7, "samples": [["7 20 -5\n4 3 -2.875\n5 7 -1.314\n10 -2 0.666\n16 1 -1.571\n16 1 1.571\n23 -3 -2.130\n14 -5 3.073", "33.3380422500"], ["7 20 0\n5 2 1.155\n5 2 1.987\n5 2 -1.571\n11 -4 1.765\n11 -4 1.377\n15 -4 1.765\n15 -4 1.377", "24.2735704188"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2017", "各省省选", "安徽", "湖南", "Special Judge", "排序", "最短路", "队列"], "title": "[AHOI2017/HNOI2017] 队长快跑", "background": null, "description": "众所周知，在 P 国外不远处盘踞着巨龙大 Y。传说中，在远古时代，巨龙大 Y 将 P 国的镇国之宝窃走并藏在了其巢穴中，这吸引着整个 P 国的所有冒险家前去夺回，尤其是皇家卫士队的队长小 W。在 P 国量子科技实验室的帮助下，队长小 W 通过量子传输进入了巨龙大 Y 的藏宝室，并成功夺回了镇国之宝。但此时巨龙布下的攻击性防壁启动，将小 W 困在了美杜莎的迷宫当中。\n\n被困在迷宫 $(0,0)$ 处的队长小 W 快速观察了美杜莎的迷宫的构造，发现迷宫的出口位于 $(p,q)$ 处。巨龙大 Y 在迷宫当中布置了 $n$ 火焰吐息机关，每个机关可以用三个参数 $(x,y,\\theta)$ 表示，分别指明机关位于平面的坐标 $(x,y)$，以及火焰吐息的方向相对于 $x$ 正方向的倾角 $\\theta$。巨龙强大的力量使得火焰吐息有无穷长，且队长小  W 不能通过被火焰吐息覆盖的射线（注意，机关所处的坐标若没有被其他火焰吐息覆盖，则是可以通过的）。同时，迷宫在沿 $x$ 负方向无穷远的地方放置了美杜莎之眼，使得队长小 W 必须倾向于向 $x$ 正方向行动（即队长小 W 的移动方向在 $x$ 正方向上的投影必须为正，不能是负数或零），否则队长小 W 将被瞬间石化而无法逃离。\n\n心急如焚的队长小 W 需要趁着巨龙大 Y 还没将其抓住前逃离美杜莎的迷宫，所以他立马向 P 国智囊团求助，作为智囊团团长的你，一定可以帮队长小 W 找出安全逃至迷宫出口的最短道路。", "inputFormat": "第一行为三个整数 $n,p,q$ 分别表示火焰吐息机关总数以及出口坐标。\n\n接下来 $n$ 行，每行两个整数与一个实数 $(x,y,\\theta)$ 分别表示机关所处的坐标以及火焰吐息的关于 $x$ 正方向的倾角。", "outputFormat": "输出文件仅包含一行一个小数，表示最短道路的长度。当你的答案和标准答案的相对误差不超过 $10^{-8}$ 时（ 即 $\\frac{|a-o|}{a}\\leq10^{-8}$ 时， 其中 $a$ 是标准答案，$o$ 是输出）认为你的答案正确。", "hint": "【样例解释】\n\n ![](https://cdn.luogu.com.cn/upload/pic/5107.png) \n\n$30\\%$ 的数据满足 $n\\leq 300$；\n\n$60\\%$ 的数据满足 $n\\leq 2000$；\n\n$80\\%$ 的数据满足 $n\\leq 10^5$；\n\n$100\\%$ 的数据满足： $0 \\leq n,p, |q|, |x|, |y| \\leq 10^6； \\theta \\in [−\\pi, \\pi]$。\n数据保证至少存在一条合法路径，且起点和终点均不会被火焰路径覆盖。", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2017/HNOI2017] Captain, Run", "background": "", "description": "As is well known, not far from Country P lurks the great dragon Da Y. Legend has it that in ancient times, the great dragon Da Y stole Country P’s national treasure and hid it in its lair, attracting all adventurers of Country P to try to take it back—especially Captain Xiao W of the Royal Guards. With the help of Country P’s Quantum Technology Laboratory, Captain Xiao W used quantum teleportation to enter the dragon’s treasury and successfully retrieved the national treasure. But at that moment, the dragon’s offensive barrier activated and trapped Xiao W in Medusa’s Labyrinth.\n\nTrapped at $(0, 0)$, Captain Xiao W quickly examined the structure of Medusa’s Labyrinth and found that the exit is at $(p, q)$. The great dragon Da Y has placed $n$ flame-breath devices in the labyrinth. Each device is described by three parameters $(x, y, \\theta)$, indicating that the device is at coordinate $(x, y)$ on the plane, and that the direction of its breath has inclination angle $\\theta$ relative to the positive $x$-axis. Owing to the dragon’s power, each flame breath is an infinite ray, and Captain Xiao W may not pass through any ray covered by a flame breath (note that the device’s own coordinate is passable if it is not covered by other flame breath). Meanwhile, an Eye of Medusa is placed at negative infinity along the $x$-direction, which forces Captain Xiao W to always move “favoring” the positive $x$-direction (that is, the projection of his movement direction onto the positive $x$-direction must be strictly positive; it cannot be negative or zero), otherwise he will be instantly petrified and unable to escape.\n\nIn a panic, Captain Xiao W must escape Medusa’s Labyrinth before the great dragon Da Y catches him. He turns to the think tank of Country P for help. As the head of the think tank, you must find the shortest safe path to the exit of the labyrinth.", "inputFormat": "The first line contains three integers $n, p, q$, denoting the total number of flame-breath devices and the exit coordinates.\n\nEach of the next $n$ lines contains two integers and one real number $(x, y, \\theta)$, denoting the device’s coordinates and the inclination angle of its flame breath relative to the positive $x$-axis.", "outputFormat": "Output a single real number on one line, the length of the shortest path. Your answer is accepted if its relative error does not exceed $10^{-8}$ (i.e., if $\\frac{|a - o|}{a} \\le 10^{-8}$, where $a$ is the standard answer and $o$ is your output).", "hint": "[Sample Explanation]\n\n![](https://cdn.luogu.com.cn/upload/pic/5107.png)\n\n$30\\%$ of the testdata satisfy $n \\le 300$;\n$60\\%$ of the testdata satisfy $n \\le 2000$;\n$80\\%$ of the testdata satisfy $n \\le 10^5$;\n$100\\%$ of the testdata satisfy $0 \\le n, p, |q|, |x|, |y| \\le 10^6;\\ \\theta \\in [-\\pi, \\pi]$.\nIt is guaranteed that at least one valid path exists, and neither the start point nor the end point lies on any flame ray.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2017/HNOI2017] 队长快跑", "background": null, "description": "众所周知，在 P 国外不远处盘踞着巨龙大 Y。传说中，在远古时代，巨龙大 Y 将 P 国的镇国之宝窃走并藏在了其巢穴中，这吸引着整个 P 国的所有冒险家前去夺回，尤其是皇家卫士队的队长小 W。在 P 国量子科技实验室的帮助下，队长小 W 通过量子传输进入了巨龙大 Y 的藏宝室，并成功夺回了镇国之宝。但此时巨龙布下的攻击性防壁启动，将小 W 困在了美杜莎的迷宫当中。\n\n被困在迷宫 $(0,0)$ 处的队长小 W 快速观察了美杜莎的迷宫的构造，发现迷宫的出口位于 $(p,q)$ 处。巨龙大 Y 在迷宫当中布置了 $n$ 火焰吐息机关，每个机关可以用三个参数 $(x,y,\\theta)$ 表示，分别指明机关位于平面的坐标 $(x,y)$，以及火焰吐息的方向相对于 $x$ 正方向的倾角 $\\theta$。巨龙强大的力量使得火焰吐息有无穷长，且队长小  W 不能通过被火焰吐息覆盖的射线（注意，机关所处的坐标若没有被其他火焰吐息覆盖，则是可以通过的）。同时，迷宫在沿 $x$ 负方向无穷远的地方放置了美杜莎之眼，使得队长小 W 必须倾向于向 $x$ 正方向行动（即队长小 W 的移动方向在 $x$ 正方向上的投影必须为正，不能是负数或零），否则队长小 W 将被瞬间石化而无法逃离。\n\n心急如焚的队长小 W 需要趁着巨龙大 Y 还没将其抓住前逃离美杜莎的迷宫，所以他立马向 P 国智囊团求助，作为智囊团团长的你，一定可以帮队长小 W 找出安全逃至迷宫出口的最短道路。", "inputFormat": "第一行为三个整数 $n,p,q$ 分别表示火焰吐息机关总数以及出口坐标。\n\n接下来 $n$ 行，每行两个整数与一个实数 $(x,y,\\theta)$ 分别表示机关所处的坐标以及火焰吐息的关于 $x$ 正方向的倾角。", "outputFormat": "输出文件仅包含一行一个小数，表示最短道路的长度。当你的答案和标准答案的相对误差不超过 $10^{-8}$ 时（ 即 $\\frac{|a-o|}{a}\\leq10^{-8}$ 时， 其中 $a$ 是标准答案，$o$ 是输出）认为你的答案正确。", "hint": "【样例解释】\n\n ![](https://cdn.luogu.com.cn/upload/pic/5107.png) \n\n$30\\%$ 的数据满足 $n\\leq 300$；\n\n$60\\%$ 的数据满足 $n\\leq 2000$；\n\n$80\\%$ 的数据满足 $n\\leq 10^5$；\n\n$100\\%$ 的数据满足： $0 \\leq n,p, |q|, |x|, |y| \\leq 10^6； \\theta \\in [−\\pi, \\pi]$。\n数据保证至少存在一条合法路径，且起点和终点均不会被火焰路径覆盖。", "locale": "zh-CN"}}}
{"pid": "P3726", "type": "P", "difficulty": 7, "samples": [["2 1 9\n3 2 1", "000000004\n6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2017", "各省省选", "安徽", "湖南", "O2优化", "枚举", "中国剩余定理 CRT", "逆元"], "title": "[AHOI2017/HNOI2017] 抛硬币", "background": null, "description": "小 A 和小 B 是一对好朋友，他们经常一起愉快的玩耍。最近小 B 沉迷于**师手游，天天刷本，根本无心搞学习。但是已经入坑了几个月，却一次都没有抽到 SSR，让他非常怀疑人生。勤勉的小 A 为了劝说小 B 早日脱坑，认真学习，决定以抛硬币的形式让小 B 明白他是一个彻彻底底的非洲人，从而对这个游戏绝望。两个人同时抛 b 次硬币，如果小 A 的正面朝上的次数大于小 B 正面朝上的次数，则小 A 获胜。\n\n但事实上，小 A 也曾经沉迷过拉拉游戏，而且他一次 UR 也没有抽到过，所以他对于自己的运气也没有太大把握。所以他决定在小 B 没注意的时候作弊，悄悄地多抛几次硬币，当然，为了不让小 B 怀疑，他不会抛太多次。现在小 A 想问你，在多少种可能的情况下，他能够胜过小 B 呢？由于答案可能太大，所以你只需要输出答案在十进制表示下的最后 $k$ 位即可。", "inputFormat": "有多组数据，对于每组数据输入三个数 $a,b,k$，分别代表小 A 抛硬币的次数，小 B 抛硬币的次数，以及最终答案保留多少位整数。", "outputFormat": "对于每组数据，输出一个数，表示最终答案的最后 $k$ 位为多少，若不足 $k$ 位以 $0$ 补全。", "hint": "对于第一组数据，当小 A 抛 $2$ 次硬币，小 B 抛 $1$ 次硬币时，共有 $4$ 种方案使得小 A 正面朝上的次数比小 B 多。\n\n$(01,0), (10,0), (11,0), (11,1)$\n\n对于第二组数据，当小 A 抛 $3$ 次硬币，小 B 抛 $2$ 次硬币时，共有 $16$ 种方案使得小 A 正面朝上的次数比小 B 多。\n\n$(001,00), (010,00), (100,00), (011,00), (101,00), (110,00), (111,00), (011,01)$\n\n$(101,01), (110,01),(111,01), (011,10), (101,10), (110,10), (111,10), (111,11)$\n\n### 数据范围\n\n$10\\%$ 的数据满足 $a,b\\leq 20$。\n\n\n$30\\%$ 的数据满足 $a,b\\leq 100$。\n\n\n$70\\%$ 的数据满足 $a,b\\leq 10^5$，其中有 $20\\%$ 的数据满足 $a=b$。\n\n\n$100\\%$ 的数据满足 $1\\le a,b\\le 10^{15}$，$b\\le a\\le b+10^4$，$1\\le k\\le 9$，数据组数小于等于 $10$。", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2017/HNOI2017] Coin Tossing", "background": "", "description": "A and B are good friends who often play together. Recently, B has been addicted to a mobile gacha game, grinding every day and not studying at all. After several months, he has never drawn an SSR, which makes him doubt life. The diligent A wants to persuade B to quit the game and study, so he decides to use coin tossing to show B that he is thoroughly unlucky. They would toss coins at the same time; if the number of heads A gets is greater than the number of heads B gets, then A wins.\n\nHowever, A was also once addicted to a gacha game and has never drawn a UR, so he is not confident in his luck. He decides to cheat by secretly tossing a few extra times; to avoid suspicion, he will not toss too many extra times. Let $a$ be the total number of times A tosses, and $b$ be the total number of times B tosses. In how many possible outcomes can A defeat B? Since the answer can be large, you only need to output the last $k$ digits in decimal.", "inputFormat": "Multiple test cases. For each test case, input three integers $a, b, k$, representing the number of times A tosses, the number of times B tosses, and how many digits of the final answer to keep.", "outputFormat": "For each test case, output one number: the last $k$ digits of the answer. If it has fewer than $k$ digits, pad with leading zeros.", "hint": "For the first test case, when A tosses $2$ times and B tosses $1$ time, there are $4$ favorable outcomes in which A gets more heads than B.\n$(01, 0), (10, 0), (11, 0), (11, 1)$.\n\nFor the second test case, when A tosses $3$ times and B tosses $2$ times, there are $16$ favorable outcomes in which A gets more heads than B.\n$(001, 00), (010, 00), (100, 00), (011, 00), (101, 00), (110, 00), (111, 00), (011, 01)$\n$(101, 01), (110, 01), (111, 01), (011, 10), (101, 10), (110, 10), (111, 10), (111, 11)$.\n\nConstraints\n\n$10\\%$ of the testdata satisfies $a, b \\le 20$.\n\n$30\\%$ of the testdata satisfies $a, b \\le 100$.\n\n$70\\%$ of the testdata satisfies $a, b \\le 10^5$, among which $20\\%$ satisfies $a = b$.\n\n$100\\%$ of the testdata satisfies $1 \\le a, b \\le 10^{15}$, $b \\le a \\le b + 10^4$, $1 \\le k \\le 9$, and the number of test cases is at most $10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2017/HNOI2017] 抛硬币", "background": null, "description": "小 A 和小 B 是一对好朋友，他们经常一起愉快的玩耍。最近小 B 沉迷于**师手游，天天刷本，根本无心搞学习。但是已经入坑了几个月，却一次都没有抽到 SSR，让他非常怀疑人生。勤勉的小 A 为了劝说小 B 早日脱坑，认真学习，决定以抛硬币的形式让小 B 明白他是一个彻彻底底的非洲人，从而对这个游戏绝望。两个人同时抛 b 次硬币，如果小 A 的正面朝上的次数大于小 B 正面朝上的次数，则小 A 获胜。\n\n但事实上，小 A 也曾经沉迷过拉拉游戏，而且他一次 UR 也没有抽到过，所以他对于自己的运气也没有太大把握。所以他决定在小 B 没注意的时候作弊，悄悄地多抛几次硬币，当然，为了不让小 B 怀疑，他不会抛太多次。现在小 A 想问你，在多少种可能的情况下，他能够胜过小 B 呢？由于答案可能太大，所以你只需要输出答案在十进制表示下的最后 $k$ 位即可。", "inputFormat": "有多组数据，对于每组数据输入三个数 $a,b,k$，分别代表小 A 抛硬币的次数，小 B 抛硬币的次数，以及最终答案保留多少位整数。", "outputFormat": "对于每组数据，输出一个数，表示最终答案的最后 $k$ 位为多少，若不足 $k$ 位以 $0$ 补全。", "hint": "对于第一组数据，当小 A 抛 $2$ 次硬币，小 B 抛 $1$ 次硬币时，共有 $4$ 种方案使得小 A 正面朝上的次数比小 B 多。\n\n$(01,0), (10,0), (11,0), (11,1)$\n\n对于第二组数据，当小 A 抛 $3$ 次硬币，小 B 抛 $2$ 次硬币时，共有 $16$ 种方案使得小 A 正面朝上的次数比小 B 多。\n\n$(001,00), (010,00), (100,00), (011,00), (101,00), (110,00), (111,00), (011,01)$\n\n$(101,01), (110,01),(111,01), (011,10), (101,10), (110,10), (111,10), (111,11)$\n\n### 数据范围\n\n$10\\%$ 的数据满足 $a,b\\leq 20$。\n\n\n$30\\%$ 的数据满足 $a,b\\leq 100$。\n\n\n$70\\%$ 的数据满足 $a,b\\leq 10^5$，其中有 $20\\%$ 的数据满足 $a=b$。\n\n\n$100\\%$ 的数据满足 $1\\le a,b\\le 10^{15}$，$b\\le a\\le b+10^4$，$1\\le k\\le 9$，数据组数小于等于 $10$。", "locale": "zh-CN"}}}
{"pid": "P3727", "type": "P", "difficulty": 6, "samples": [["1\n3\n1 2\n2 3\n1 2 3\n1", "Mutalisk ride face how to lose?"], ["1\n3\n1 2\n2 3\n1 2 4\n1", "The commentary cannot go on!"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["点分治", "洛谷原创", "枚举", "分治", "深度优先搜索 DFS"], "title": "曼哈顿计划E", "background": "1942 年 6 月，美国开始实施利用核裂变反应来研制原子弹的计划，亦称曼哈顿计划。后来两颗原子弹在广岛和长崎爆炸，世界见证了核武器的威力，并在它的威胁下颤抖不已。2200 年，dedsec 组织利用美国军方的网络安全漏洞渗入了美国的和武器系统，并密谋使用隐藏在曼哈顿的核武器储备毁灭世界。然而 dedsec 的一名成员 Badboy17 反对这一计划，她把这一计划告知了艾登。为了拯救他的家人，避免地球变为废土，艾登不得不再次发挥他的黑客能力拯救世界。\n\n![](https://cdn.luogu.com.cn/upload/pic/5119.png)\n", "description": "艾登尝试黑入 dedsec 的系统并取得控制权，然而 dedsec 有所反应并予以反击。\n\ndedsec 的网络可以看做是一个 $n$ 个点 $n-1$ 条边的连通图（一棵树），每个节点有一个稳定值。\n\n艾登可以选择网络中上的一条链，并对那一条链上的节点进行破解（把这一条链从树上拆下来）。\n\n假设这一条链长度为 $m$，现在你会得到 $m$ 个节点。\n\n然后艾登要和 dedsec 开始攻防战，双方轮流行动，每次可以从任意一个稳定值大于 $0$ 的节点里依照计算规则进行一些操作，操作后，稳定值不能小于 $0$，否则计算机会爆炸，最后不能进行操作的一方算作失败\n\n由于 dedsec 占据了防守的地理优势，dedsec 先进行操作\n\n\n艾登虽然精于黑客技术，但他的手机没电了。现在他把这个消息告诉了你，希望你帮他拯救世界，所以你需要写一个程序，来帮你判断是否存在一种方式，艾登可以取胜。当然，dedsec 的防守可能完美无缺，艾登根本无法取胜，你只好跑到 shelter 里去当试验品。\n", "inputFormat": "输入包含多组测试数据，输入第一行包含一个整数 $T$，表示数据组数。\n\n对于每组测试数据，第一行一个整数 $n$，表示有 $n$ 个点。\n\n第二行至第 $n$ 行，每行两个整数 $u,v$，表示网络中有一条边连接 $u,v$。\n\n第 $n+1$ 行 $n$ 个整数 $w$，第 $w_i$ 表示 $i$ 号节点的稳定值。\n\n第 $n+2$ 行一个整数 $k$，描述操作的规则：\n\n- 如果 $k=1$，你可以减少任意正整数的稳定值。\n- 如果 $k=2$，接下来一行一个正整数 $s$，表示双方每次可以减少 $s$ 的非负整数幂的稳定值。\n- 如果 $k=3$，接下来一行一个正整数 $s$，表示双方每次可以减少大于等于 $s$ 的稳定值。\n- 如果 $k=4$，表示双方每次可以减少任意正整数的稳定值，或者把一个稳定值数量大于等于 $2$ 的节点分裂成两个，分开后的两个节点的稳定值之和等于原来的节点（比如 $7$ 分成 $3+4$）。\n- 如果 $k=5$，双方都不能进行操作。\n", "outputFormat": "对于每一组测试数据，输出一行：\n\n如果存在一种方式，你可以获胜，输出 `Mutalisk ride face how to lose?`。\n\n如果不存在一种方式可以取胜，输出 `The commentary cannot go on!`。\n", "hint": "|测试点|$n\\le$|$k$|$w_i\\le$|\n|:-:|:-:|:-:|:-:|\n|$1$|$50$|$1$|$10^3$|\n|$2$|$3\\times 10^4$|$1$|$10^3$|\n|$3$|$300$|$3$|$10^6$|\n|$4$|$10^3$|$4$|$10^6$|\n|$5$|$3\\times 10^4$|$1$|$10^9$|\n|$6$|$3\\times 10^4$|$2$|$10^9$|\n|$7$|$3\\times 10^4$|$3$|$10^9$|\n|$8$|$3\\times 10^4$|$3$|$10^9$|\n|$9$|$3\\times 10^4$|$4$|$10^9$|\n|$10$|$3\\times 10^4$|$4$|$10^9$|\n\n对于 $100\\%$ 的数据，$T\\le 5$。\n\n保证输入均为正整数\n", "locale": "zh-CN", "translations": {"en": {"title": "Manhattan Project E", "background": "In June 1942, the United States began the plan to develop an atomic bomb using nuclear fission reactions, also known as the Manhattan Project. Later, two atomic bombs exploded in Hiroshima and Nagasaki. The world witnessed the power of nuclear weapons and trembled under their threat. In the year 2200, the dedsec organization infiltrated the U.S. nuclear weapon system by exploiting cybersecurity vulnerabilities, plotting to use the nuclear stockpile hidden in Manhattan to destroy the world. However, a dedsec member, Badboy17, opposed the plan and informed Aiden. To save his family and prevent Earth from becoming a wasteland, Aiden had to once again use his hacking skills to save the world.\n\n![](https://cdn.luogu.com.cn/upload/pic/5119.png)", "description": "Aiden tries to hack into dedsec’s system and seize control, but dedsec responds and fights back.\n\nThe dedsec network can be regarded as a connected graph with $n$ nodes and $n-1$ edges (a tree). Each node has a stability value.\n\nAiden may choose a chain (a simple path) in the network and hack all nodes on that chain (i.e., detach that chain from the tree).\n\nSuppose the chain has length $m$ (i.e., it contains $m$ nodes). You will then obtain $m$ nodes, and the game is played only on these $m$ nodes.\n\nAiden and dedsec then start a battle of moves. They take turns. Each move, a player may choose any node with a stability value greater than $0$ and perform an operation according to the rules below. After the operation, the stability value of that node must not become less than $0$, otherwise the computer will explode. The player who cannot make a move loses.\n\nBecause dedsec has the advantage of defense, dedsec moves first.\n\nAlthough Aiden is skilled at hacking, his phone ran out of battery. He has sent this information to you, hoping you can help save the world. You need to write a program to determine whether there exists a way for Aiden to win. Of course, dedsec’s defense might be flawless, and Aiden may not be able to win at all—in that case, you’ll have to run to the shelter and become a test subject.", "inputFormat": "The input contains multiple test cases. The first line contains an integer $T$, the number of test cases.\n\nFor each test case:\n- The first line contains an integer $n$, the number of nodes.\n- The next $n-1$ lines each contain two integers $u, v$, indicating an edge between $u$ and $v$ in the network.\n- The next line contains $n$ integers $w_1, w_2, \\dots, w_n$, where $w_i$ denotes the stability value of node $i$.\n- The next line contains an integer $k$, describing the move rules:\n  - If $k=1$, you may decrease the stability by any positive integer.\n  - If $k=2$, the next line contains a positive integer $s$, and each move may decrease the stability by a non-negative integer power of $s$.\n  - If $k=3$, the next line contains a positive integer $s$, and each move may decrease the stability by any integer greater than or equal to $s$.\n  - If $k=4$, each move you may either decrease the stability by any positive integer, or split a node with stability at least $2$ into two nodes whose stability values sum to the original (for example, split $7$ into $3+4$).\n  - If $k=5$, neither player can make any move.", "outputFormat": "For each test case, output one line:\n\nIf there exists a way for you to win, output `Mutalisk ride face how to lose?`.\n\nIf there is no way to win, output `The commentary cannot go on!`.", "hint": "| Test point | $n \\le$ | $k$ | $w_i \\le$ |\n|:-:|:-:|:-:|:-:|\n| $1$ | $50$ | $1$ | $10^3$ |\n| $2$ | $3 \\times 10^4$ | $1$ | $10^3$ |\n| $3$ | $300$ | $3$ | $10^6$ |\n| $4$ | $10^3$ | $4$ | $10^6$ |\n| $5$ | $3 \\times 10^4$ | $1$ | $10^9$ |\n| $6$ | $3 \\times 10^4$ | $2$ | $10^9$ |\n| $7$ | $3 \\times 10^4$ | $3$ | $10^9$ |\n| $8$ | $3 \\times 10^4$ | $3$ | $10^9$ |\n| $9$ | $3 \\times 10^4$ | $4$ | $10^9$ |\n| $10$ | $3 \\times 10^4$ | $4$ | $10^9$ |\n\nFor $100\\%$ of the testdata, $T \\le 5$.\n\nAll inputs are positive integers.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "曼哈顿计划E", "background": "1942 年 6 月，美国开始实施利用核裂变反应来研制原子弹的计划，亦称曼哈顿计划。后来两颗原子弹在广岛和长崎爆炸，世界见证了核武器的威力，并在它的威胁下颤抖不已。2200 年，dedsec 组织利用美国军方的网络安全漏洞渗入了美国的和武器系统，并密谋使用隐藏在曼哈顿的核武器储备毁灭世界。然而 dedsec 的一名成员 Badboy17 反对这一计划，她把这一计划告知了艾登。为了拯救他的家人，避免地球变为废土，艾登不得不再次发挥他的黑客能力拯救世界。\n\n![](https://cdn.luogu.com.cn/upload/pic/5119.png)\n", "description": "艾登尝试黑入 dedsec 的系统并取得控制权，然而 dedsec 有所反应并予以反击。\n\ndedsec 的网络可以看做是一个 $n$ 个点 $n-1$ 条边的连通图（一棵树），每个节点有一个稳定值。\n\n艾登可以选择网络中上的一条链，并对那一条链上的节点进行破解（把这一条链从树上拆下来）。\n\n假设这一条链长度为 $m$，现在你会得到 $m$ 个节点。\n\n然后艾登要和 dedsec 开始攻防战，双方轮流行动，每次可以从任意一个稳定值大于 $0$ 的节点里依照计算规则进行一些操作，操作后，稳定值不能小于 $0$，否则计算机会爆炸，最后不能进行操作的一方算作失败\n\n由于 dedsec 占据了防守的地理优势，dedsec 先进行操作\n\n\n艾登虽然精于黑客技术，但他的手机没电了。现在他把这个消息告诉了你，希望你帮他拯救世界，所以你需要写一个程序，来帮你判断是否存在一种方式，艾登可以取胜。当然，dedsec 的防守可能完美无缺，艾登根本无法取胜，你只好跑到 shelter 里去当试验品。\n", "inputFormat": "输入包含多组测试数据，输入第一行包含一个整数 $T$，表示数据组数。\n\n对于每组测试数据，第一行一个整数 $n$，表示有 $n$ 个点。\n\n第二行至第 $n$ 行，每行两个整数 $u,v$，表示网络中有一条边连接 $u,v$。\n\n第 $n+1$ 行 $n$ 个整数 $w$，第 $w_i$ 表示 $i$ 号节点的稳定值。\n\n第 $n+2$ 行一个整数 $k$，描述操作的规则：\n\n- 如果 $k=1$，你可以减少任意正整数的稳定值。\n- 如果 $k=2$，接下来一行一个正整数 $s$，表示双方每次可以减少 $s$ 的非负整数幂的稳定值。\n- 如果 $k=3$，接下来一行一个正整数 $s$，表示双方每次可以减少大于等于 $s$ 的稳定值。\n- 如果 $k=4$，表示双方每次可以减少任意正整数的稳定值，或者把一个稳定值数量大于等于 $2$ 的节点分裂成两个，分开后的两个节点的稳定值之和等于原来的节点（比如 $7$ 分成 $3+4$）。\n- 如果 $k=5$，双方都不能进行操作。\n", "outputFormat": "对于每一组测试数据，输出一行：\n\n如果存在一种方式，你可以获胜，输出 `Mutalisk ride face how to lose?`。\n\n如果不存在一种方式可以取胜，输出 `The commentary cannot go on!`。\n", "hint": "|测试点|$n\\le$|$k$|$w_i\\le$|\n|:-:|:-:|:-:|:-:|\n|$1$|$50$|$1$|$10^3$|\n|$2$|$3\\times 10^4$|$1$|$10^3$|\n|$3$|$300$|$3$|$10^6$|\n|$4$|$10^3$|$4$|$10^6$|\n|$5$|$3\\times 10^4$|$1$|$10^9$|\n|$6$|$3\\times 10^4$|$2$|$10^9$|\n|$7$|$3\\times 10^4$|$3$|$10^9$|\n|$8$|$3\\times 10^4$|$3$|$10^9$|\n|$9$|$3\\times 10^4$|$4$|$10^9$|\n|$10$|$3\\times 10^4$|$4$|$10^9$|\n\n对于 $100\\%$ 的数据，$T\\le 5$。\n\n保证输入均为正整数\n", "locale": "zh-CN"}}}
{"pid": "P3728", "type": "P", "difficulty": 6, "samples": [["3 3\nabb\n", "abb\n"], ["3 5\nabb\n", "bb\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["洛谷原创", "有限状态自动机"], "title": "曼哈顿序列", "background": "为了研究**一类动态仙人掌图上基于完全可持久化后缀全局平衡树维护的按操作序分治的分支定界启发式带花树上下界最小费用流最后输出两点曼哈顿距离的问题**，will需要生成一些字母序列。\n\n\n在写生成器的过程中，因为will太弱了，他遇到了一些问题。现在，需要机智的你来帮他解决这些问题。\n", "description": "序列生成器的工作流程如下：\n\n\n- will先钦定了一个母序列，长度为N，序列里都是小写字母。\n\n- 子序列定义为：将母序列在任意位置删掉零或多个字符剩下的**非空**序列。例如：ab和ac是abc的子序列，但ca不是。\n\n- 显然，长度为N的序列有$2^N-1$个子序列。\n\n- 将这$2^N-1$个子序列按照字典序排列。will会按照字典序依次生成子序列。\n\n- will希望去掉重复的子序列，如果几个子序列重复（按照字典序大小相等），只生成一个。\n\n- 现在，他想知道，生成器第K次生成的子序列是什么？\n", "inputFormat": "- 第一行两个正整数N，K。N表示母序列长度，K表示询问；\n\n- 接下来一行N个小写字母，表示母序列；\n", "outputFormat": "- 一行若干个小写字母表示一个序列，为生成器第K次生成的序列。\n", "hint": "## 样例的解释\n\n对于母序列abb，有7个子序列，按字典序排列：\n\n\n- a\n- ab\n- ab\n- abb\n- b\n- b\n- bb\n\n去重后的第3个是abb；\n\n\n## 数据范围\n\n- 对于20%的数据，$N\\leq 15$；\n\n- 对于50%的数据，$N\\leq 1000$；\n\n- 对于80%的数据，$N\\leq 200000$；\n\n- 对于100%的数据，$N\\leq 1000000, K\\leq 10^9$，且保证存在第K次的输出；\n\n- 前80%数据的时限为1s，后20%的数据时限为2s。\n", "locale": "zh-CN", "translations": {"en": {"title": "Manhattan Sequence", "background": "To study the problem of computing the Manhattan distance between two points as the final output in a \"dynamic cactus graph\" using a branch-and-bound heuristic based on operation-order divide-and-conquer with blossom-tree bounds, maintained by a fully persistent suffix global balanced tree, will needs to generate some letter sequences.\n\nDuring the process of writing the generator, because will is too weak, he encountered some problems. Now, he needs your help to solve them.", "description": "The sequence generator works as follows:\n\n- will first fixes a mother sequence of length $N$, consisting of lowercase letters.\n- A subsequence is defined as a non-empty sequence obtained by deleting zero or more characters at arbitrary positions from the mother sequence. For example: \"a b\" and \"a c\" are subsequences of \"a b c\", but \"c a\" is not.\n- Obviously, a sequence of length $N$ has $2^N - 1$ subsequences.\n- Sort these $2^N - 1$ subsequences in lexicographical order. will will generate subsequences in this order.\n- will wants to remove duplicate subsequences. If several subsequences are identical (i.e., equal in lexicographical order), only one is generated.\n- Now, he wants to know: what is the subsequence generated on the $K$-th time?", "inputFormat": "- The first line contains two positive integers $N$, $K$. $N$ is the length of the mother sequence, and $K$ is the query.\n- The second line contains $N$ lowercase letters, representing the mother sequence.", "outputFormat": "Output one line consisting of lowercase letters: the subsequence generated on the $K$-th time.", "hint": "Sample Explanation:\n\nFor the mother sequence \"a b b\", there are 7 subsequences, sorted in lexicographical order:\n\n- a.\n- a b.\n- a b.\n- a b b.\n- b.\n- b.\n- b b.\n\nAfter removing duplicates, the 3rd one is \"a b b\".\n\nConstraints:\n\n- For 20% of the testdata, $N \\leq 15$.\n- For 50% of the testdata, $N \\leq 1000$.\n- For 80% of the testdata, $N \\leq 200000$.\n- For 100% of the testdata, $N \\leq 1000000$, $K \\leq 10^9$, and it is guaranteed that the $K$-th output exists.\n- The time limit for the first 80% of the testdata is 1 s, and for the last 20% of the testdata is 2 s.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "曼哈顿序列", "background": "为了研究**一类动态仙人掌图上基于完全可持久化后缀全局平衡树维护的按操作序分治的分支定界启发式带花树上下界最小费用流最后输出两点曼哈顿距离的问题**，will需要生成一些字母序列。\n\n\n在写生成器的过程中，因为will太弱了，他遇到了一些问题。现在，需要机智的你来帮他解决这些问题。\n", "description": "序列生成器的工作流程如下：\n\n\n- will先钦定了一个母序列，长度为N，序列里都是小写字母。\n\n- 子序列定义为：将母序列在任意位置删掉零或多个字符剩下的**非空**序列。例如：ab和ac是abc的子序列，但ca不是。\n\n- 显然，长度为N的序列有$2^N-1$个子序列。\n\n- 将这$2^N-1$个子序列按照字典序排列。will会按照字典序依次生成子序列。\n\n- will希望去掉重复的子序列，如果几个子序列重复（按照字典序大小相等），只生成一个。\n\n- 现在，他想知道，生成器第K次生成的子序列是什么？\n", "inputFormat": "- 第一行两个正整数N，K。N表示母序列长度，K表示询问；\n\n- 接下来一行N个小写字母，表示母序列；\n", "outputFormat": "- 一行若干个小写字母表示一个序列，为生成器第K次生成的序列。\n", "hint": "## 样例的解释\n\n对于母序列abb，有7个子序列，按字典序排列：\n\n\n- a\n- ab\n- ab\n- abb\n- b\n- b\n- bb\n\n去重后的第3个是abb；\n\n\n## 数据范围\n\n- 对于20%的数据，$N\\leq 15$；\n\n- 对于50%的数据，$N\\leq 1000$；\n\n- 对于80%的数据，$N\\leq 200000$；\n\n- 对于100%的数据，$N\\leq 1000000, K\\leq 10^9$，且保证存在第K次的输出；\n\n- 前80%数据的时限为1s，后20%的数据时限为2s。\n", "locale": "zh-CN"}}}
{"pid": "P3729", "type": "P", "difficulty": 6, "samples": [["4 5 3\n1 1 1 1\n1 2\n1 3\n2 3\n1 4\n2 4\n1\n3\n5", "nan\n2\nNuclear launch detected"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["洛谷原创", "枚举"], "title": "曼哈顿计划EX", "background": "- 曼哈顿计划EX， The X Makes It Sound Cool\n\n- 艾登黑进了dedsec的系统以后，发现核弹发射已经进入了倒计时，他必须停止核弹的发射进程。\n\n![](https://cdn.luogu.com.cn/upload/pic/5120.png)\n", "description": "- 艾登拥有一个计算机网络，每一台计算机都至少有着Intel Xeon E50 v40 + 40路GTX10800Titan的恐怖配置，并由无线网络直接或间接连接，这可以用一个无向连通图来表示。但是他的计算机网络有一个问题——不够安全，dedsec可能会攻击他的网络，切断一些无线连接，从而导致整个计算机网络不连通。为了避免这种情况，艾登决定从这些计算机中挑出一些计算机作为计算节点，其他计算机作为信息的中转站，进行停止核弹发射进程的任务。虽然台台都是顶配，但是艾登的计算机也会有从山寨厂买回的配件和原装正版配件的差别——每台电脑的工作能力是不同的，记为$ w_{i}$。现在艾登想知道，对于一个工作能力的要求，整个网络的安全系数最大是多少？\n\n\n- 设给出的图为$G = (V , E)$，其中$V$ = $V_{1}$（计算节点） + $V_{2}$（中转节点）\n\n- 我们定义安全系数k为：最大的k，使得任意两点$u,v\\in V_{1}$都至少有k条互不相交的u到v的链（互不相交定义为：没有重复的边，可以重复有重复的点）\n\n- 我们定义整个图的工作能力$W = \\sum_{v \\in V_{1}}{w_{v}}$\n", "inputFormat": "- 第1行，三个整数n,m,q表示有n台计算机，m个无线网络，q次询问\n\n- 第2行，n个整数，表示计算机的$w_{i}$\n\n- 第3行到m+2行，每行两个整数u,v，表示有u，v之间存在直接的无线网络，什么都不保证\n\n- 第m+3行到m+q+2行，每行一个整数k，表示一个询问\n", "outputFormat": "- 一共q行，每行一个整数，表示要达到k的工作能力的前提下，整个网络最大的安全系数，如果只用一台计算机就能满足要求，输出\"nan\"\n\n- 如果没有办法满足需求，输出\"Nuclear launch detected\"\n\n- 仅输出nan并不能得分\n", "hint": " ![](https://cdn.luogu.com.cn/upload/pic/5114.png) \n\n## 样例解释\n\n- 对于询问1，选择任何一台计算机作为计算节点都是一个合法答案\n\n- 对于询问2，至少要选择3台计算机，任选三个都是合法方案。选出的三个点构成三角形，对于任意两个点都有两种相互到达的方法（在三角形上顺时针和逆时针走），所以答案是2\n\n- 对于询问3，选择所有的计算机都不足以满足任务\n\n\n## 数据规模\n\n- 对于30%的数据，n<=20，保证 $qn^{4}$ 不大于1e8\n\n- 对于100%的数据，n<=550,m<=3000,q<=2017,询问以及$w_{i}$均不超过$10^{6}$\n\n- 所有数字均为正整数\n", "locale": "zh-CN", "translations": {"en": {"title": "Manhattan Project EX", "background": "- Manhattan Project EX, The X Makes It Sound Cool.\n- After Aiden hacked into DedSec’s system, he discovered that the nuclear launch had entered its countdown. He must stop the launch process.\n\n![](https://cdn.luogu.com.cn/upload/pic/5120.png)", "description": "- Aiden has a computer network. Each computer has an insane configuration of at least Intel Xeon E50 v40 + 40-way GTX10800Titan, and they are connected directly or indirectly by wireless links, which can be represented by an undirected connected graph. However, his network is not secure enough: DedSec may attack it and cut some wireless links, causing the network to become disconnected. To prevent this, Aiden decides to select some computers as computing nodes, and use the others as relay nodes, to carry out the task of stopping the nuclear launch. Although every machine is high-end, there are differences between knockoff parts and genuine parts—each computer has a different work capacity, denoted $ w_{i}$. Now Aiden wants to know: given a required work capacity, what is the maximum safety coefficient of the entire network?\n\n- Let the given graph be $G = (V , E)$, where $V$ = $V_{1}$ (computing nodes) + $V_{2}$ (relay nodes).\n\n- We define the safety coefficient $k$ as the largest $k$ such that for any two vertices $u, v \\in V_{1}$, there are at least $k$ edge-disjoint paths from $u$ to $v$ (edge-disjoint means no repeated edges; repeated vertices are allowed).\n\n- We define the total work capacity of the selected nodes as $W = \\sum_{v \\in V_{1}}{w_{v}}$.\n\n- Constraints:\n  - For 30% of the testdata, $qn^{4}$ is no greater than 1e8.\n  - For 100% of the testdata, $n \\le 550$, $m \\le 3000$, $q \\le 2017$, and each query and $w_{i}$ are no more than $10^{6}$.\n  - All numbers are positive integers.", "inputFormat": "- The first line contains three integers $n, m, q$, the number of computers, wireless links, and queries.\n- The second line contains $n$ integers, the $w_{i}$ of the computers.\n- Lines 3 to $m+2$: each line contains two integers $u, v$, indicating a direct wireless link between $u$ and $v$; no other guarantees.\n- Lines $m+3$ to $m+q+2$: each line contains one integer $K$, representing the required total work capacity for that query.", "outputFormat": "- Output $q$ lines. For each query, output one integer: under the requirement that the total work capacity is at least $K$, the maximum safety coefficient of the network. If the requirement can be met using only one computer, output \"nan\".\n- If it is impossible to meet the requirement, output \"Nuclear launch detected\".\n- Outputting only \"nan\" will not score.", "hint": "![](https://cdn.luogu.com.cn/upload/pic/5114.png)\n\n- For query 1, choosing any single computer as a computing node is a valid solution.\n- For query 2, at least three computers must be selected; any three form a valid solution. The three selected vertices form a triangle; for any two vertices there are two ways to reach each other (clockwise and counterclockwise along the triangle), so the answer is 2.\n- For query 3, selecting all computers is still insufficient.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "曼哈顿计划EX", "background": "- 曼哈顿计划EX， The X Makes It Sound Cool\n\n- 艾登黑进了dedsec的系统以后，发现核弹发射已经进入了倒计时，他必须停止核弹的发射进程。\n\n![](https://cdn.luogu.com.cn/upload/pic/5120.png)\n", "description": "- 艾登拥有一个计算机网络，每一台计算机都至少有着Intel Xeon E50 v40 + 40路GTX10800Titan的恐怖配置，并由无线网络直接或间接连接，这可以用一个无向连通图来表示。但是他的计算机网络有一个问题——不够安全，dedsec可能会攻击他的网络，切断一些无线连接，从而导致整个计算机网络不连通。为了避免这种情况，艾登决定从这些计算机中挑出一些计算机作为计算节点，其他计算机作为信息的中转站，进行停止核弹发射进程的任务。虽然台台都是顶配，但是艾登的计算机也会有从山寨厂买回的配件和原装正版配件的差别——每台电脑的工作能力是不同的，记为$ w_{i}$。现在艾登想知道，对于一个工作能力的要求，整个网络的安全系数最大是多少？\n\n\n- 设给出的图为$G = (V , E)$，其中$V$ = $V_{1}$（计算节点） + $V_{2}$（中转节点）\n\n- 我们定义安全系数k为：最大的k，使得任意两点$u,v\\in V_{1}$都至少有k条互不相交的u到v的链（互不相交定义为：没有重复的边，可以重复有重复的点）\n\n- 我们定义整个图的工作能力$W = \\sum_{v \\in V_{1}}{w_{v}}$\n", "inputFormat": "- 第1行，三个整数n,m,q表示有n台计算机，m个无线网络，q次询问\n\n- 第2行，n个整数，表示计算机的$w_{i}$\n\n- 第3行到m+2行，每行两个整数u,v，表示有u，v之间存在直接的无线网络，什么都不保证\n\n- 第m+3行到m+q+2行，每行一个整数k，表示一个询问\n", "outputFormat": "- 一共q行，每行一个整数，表示要达到k的工作能力的前提下，整个网络最大的安全系数，如果只用一台计算机就能满足要求，输出\"nan\"\n\n- 如果没有办法满足需求，输出\"Nuclear launch detected\"\n\n- 仅输出nan并不能得分\n", "hint": " ![](https://cdn.luogu.com.cn/upload/pic/5114.png) \n\n## 样例解释\n\n- 对于询问1，选择任何一台计算机作为计算节点都是一个合法答案\n\n- 对于询问2，至少要选择3台计算机，任选三个都是合法方案。选出的三个点构成三角形，对于任意两个点都有两种相互到达的方法（在三角形上顺时针和逆时针走），所以答案是2\n\n- 对于询问3，选择所有的计算机都不足以满足任务\n\n\n## 数据规模\n\n- 对于30%的数据，n<=20，保证 $qn^{4}$ 不大于1e8\n\n- 对于100%的数据，n<=550,m<=3000,q<=2017,询问以及$w_{i}$均不超过$10^{6}$\n\n- 所有数字均为正整数\n", "locale": "zh-CN"}}}
{"pid": "P3730", "type": "P", "difficulty": 6, "samples": [["4 4  \n2 3 3 3  \n1 4 1  \n1 4 2  \n1 3 2\n1 3 3", "1  \n3  \n2  \n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["莫队", "二分", "离散化", "洛谷原创", "分块"], "title": "曼哈顿交易", "background": "will 在曼哈顿开了一家交易所，每天，前来买卖股票的人络绎不绝。\n\n\n现在，will 想要了解持股的情况。由于来交♂易的人实在是太多了，需要你写一个程序来帮他完成这个任务。\n", "description": "- 前来交易的 $N$ 个人排成了一行，为了简便起见，每个人都只持有一种股票。\n- 不同的的人可能会持有相同的股票。\n- 定义一种股票的热度为持有该股票的人数。\n- 每次，will 会给出这样的询问：在一段连续区间的人之中，热度第 $k$ 小的股票的热度是多少？\n", "inputFormat": "- 第一行两个正整数 $N,M$，分别表示人数和询问的次数。\n- 接下来一行 $N$ 个正整数，表示每个人所持的股票 $a_i$。\n- 接下来 $M$ 行，每行三个正整数 $l,r,k$，表示询问区间 $[l, r]$ 中的第 $k$ 小的热度，保证 $l\\leq r$。\n", "outputFormat": "- 对于每个询问，输出一行一个数，表示区间 $[l, r]$ 中的第 $k$ 小的热度值。\n- 如果 $k$ 大于区间里股票的种类数，输出 $-1$。\n", "hint": "对于 $20\\%$ 的数据，$N,M\\leq 1000$。\n\n对于另外 $10\\%$ 的数据，所有的 $l=1, r=N$。\n\n对于 $100\\%$ 的数据，$1\\leq N, M\\leq 10^5$，$1\\leq a_i\\leq 10^9$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Manhattan Trading", "background": "Will opened an exchange in Manhattan. Every day, people come in a steady stream to buy and sell stocks.\n\nNow, Will wants to understand the stock holdings. Because there are simply too many people coming to trade, he needs you to write a program to help him with this task.", "description": "- $N$ people line up in a row. For simplicity, each person holds exactly one stock.\n- Different people may hold the same stock.\n- Define the popularity of a stock as the number of people who hold that stock.\n- Each time, Will will ask a query: among the people in a contiguous interval, what is the popularity of the stock with the $k$-th smallest popularity?", "inputFormat": "- The first line contains two positive integers $N,M$, representing the number of people and the number of queries.\n- The next line contains $N$ positive integers, where $a_i$ is the stock held by the $i$-th person.\n- The next $M$ lines each contain three positive integers $l,r,k$, representing a query asking for the $k$-th smallest popularity in the interval $[l, r]$. It is guaranteed that $l\\leq r$.", "outputFormat": "- For each query, output one integer on a separate line, which is the $k$-th smallest popularity value in the interval $[l, r]$.\n- If $k$ is greater than the number of distinct stocks in the interval, output $-1$.", "hint": "For $20\\%$ of the testdata, $N,M\\leq 1000$.\n\nFor another $10\\%$ of the testdata, all queries have $l=1, r=N$.\n\nFor $100\\%$ of the testdata, $1\\leq N, M\\leq 10^5$，$1\\leq a_i\\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "曼哈顿交易", "background": "will 在曼哈顿开了一家交易所，每天，前来买卖股票的人络绎不绝。\n\n\n现在，will 想要了解持股的情况。由于来交♂易的人实在是太多了，需要你写一个程序来帮他完成这个任务。\n", "description": "- 前来交易的 $N$ 个人排成了一行，为了简便起见，每个人都只持有一种股票。\n- 不同的的人可能会持有相同的股票。\n- 定义一种股票的热度为持有该股票的人数。\n- 每次，will 会给出这样的询问：在一段连续区间的人之中，热度第 $k$ 小的股票的热度是多少？\n", "inputFormat": "- 第一行两个正整数 $N,M$，分别表示人数和询问的次数。\n- 接下来一行 $N$ 个正整数，表示每个人所持的股票 $a_i$。\n- 接下来 $M$ 行，每行三个正整数 $l,r,k$，表示询问区间 $[l, r]$ 中的第 $k$ 小的热度，保证 $l\\leq r$。\n", "outputFormat": "- 对于每个询问，输出一行一个数，表示区间 $[l, r]$ 中的第 $k$ 小的热度值。\n- 如果 $k$ 大于区间里股票的种类数，输出 $-1$。\n", "hint": "对于 $20\\%$ 的数据，$N,M\\leq 1000$。\n\n对于另外 $10\\%$ 的数据，所有的 $l=1, r=N$。\n\n对于 $100\\%$ 的数据，$1\\leq N, M\\leq 10^5$，$1\\leq a_i\\leq 10^9$。\n", "locale": "zh-CN"}}}
{"pid": "P3731", "type": "P", "difficulty": 6, "samples": [["5 3\n1 5\n2 4\n2 5", "2\n1 5\n2 4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2017", "河南", "各省省选", "强连通分量", "二分图"], "title": "[HAOI2017] 新型城市化", "background": "", "description": "Anihc 国有 $n$ 座城市。城市之间存在一些贸易合作关系，如果城市 $x$ 与城市 $y$ 之间存在贸易协定，那么城市 $x$ 和城市 $y$ 则是一对贸易伙伴（注意： $(x,y)$ 和 $(y,x)$ 是同一对城市）。\n\n为了实现新型城市化，实现统筹城乡一体化以及发挥城市群辐射与带动作用，国家决定规划新型城市关系。一些城市能够被称为城市群的条件是：这些城市两两都是贸易伙伴。由于Anihc 国之前也一直很重视城市关系建设，所以可以保证在目前已存在的贸易合作关系的情况下 Anihc 的 $n$ 座城市可以恰好被划分为不超过两个城市群。\n\n为了建设新型城市关系 Anihc 国想要选出两个之前并不是贸易伙伴的城市，使这两个城市成为贸易伙伴，并且要求在这两个城市成为贸易伙伴之后，最大城市群的大小至少比他们成为贸易伙伴之前的最大城市群的大小增加 $1$。\n\nAnihc 国需要在下一次会议上讨论扩大建设新型城市关系的问题，所以要请你求出在哪些城市之间建立贸易伙伴关系可以使得这个条件成立，即建立此关系前后的最大城市群的大小至少相差 $1$。", "inputFormat": "第一行 $2$ 个整数 $n,m$，表示城市的个数，目前还没有建立贸易伙伴关系的城市的对数。\n\n接下来 $m$ 行，每行 $2$ 个整数 $x,y$ 表示城市 $x,y$ 之间目前还没有建立贸易伙伴关系。", "outputFormat": "第一行 $1$ 个整数 $\\text{ans}$，表示符合条件的城市的对数。\n\n接下来 $\\text{ans}$ 行，每行两个整数，表示一对可以选择来建立贸易伙伴关系的城市。对于一对城市 $x,y$，请先输出编号更小的那一个。最后城市对与城市对之间顺序请按照字典序从小到大输出。", "hint": "数据点 $1$：$n\\le 16$；\n\n数据点 $2$：$n\\le 16$；\n\n数据点 $3\\sim 5$：$n\\le 100$；\n\n数据点 $6$：$n\\le 500$；\n\n数据点 $7\\sim10$：$n\\le 10^4$。\n\n对于所有的数据保证： $n \\le 10^4,0 \\le m \\le \\min(1.5\\times 10^5,\\dfrac{n(n-1)}{2})$。保证输入的城市关系中不会出现 $(x,x)$ 这样的关系，同一对城市也不会出现两次（无重边，无自环）。", "locale": "zh-CN", "translations": {"en": {"title": "[HAOI2017] New-type Urbanization", "background": "", "description": "There are $n$ cities in Anihc. Some cities have trade cooperation relations: if there is a trade agreement between city $x$ and city $y$, then city $x$ and city $y$ are a pair of trade partners (note: $(x,y)$ and $(y,x)$ denote the same pair of cities).\n\nTo implement new-type urbanization, integrate urban and rural development, and leverage the radiation and driving role of city clusters, the country decides to plan new city relations. A set of cities can be called a city cluster if every pair among them are trade partners. Since Anihc has long attached importance to building city relations, it is guaranteed that, under the currently existing trade cooperation relations, the $n$ cities can be partitioned into at most two city clusters.\n\nTo build new city relations, Anihc wants to select two cities that are not yet trade partners, make them trade partners, and requires that after these two cities become trade partners, the size of the largest city cluster is at least $1$ larger than the size of the largest city cluster before they became partners.\n\nAnihc needs to discuss expanding the construction of new city relations at the next meeting, so you are asked to find all pairs of cities between which establishing a trade partnership would satisfy this condition, i.e., the size of the largest city cluster after establishing the partnership is at least $1$ greater than before.", "inputFormat": "The first line contains $2$ integers $n, m$, the number of cities and the number of unordered city pairs that have not yet established a trade partnership.\n\nThe next $m$ lines each contain $2$ integers $x, y$, indicating that cities $x$ and $y$ have not yet established a trade partnership.", "outputFormat": "Output one integer $\\text{ans}$ on the first line, the number of qualifying city pairs.\n\nThen output $\\text{ans}$ lines, each containing two integers, representing a pair of cities that can be chosen to establish a trade partnership. For a pair of cities $x, y$, output the smaller index first. Finally, sort the pairs in ascending lexicographic order.", "hint": "Test point $1$: $n \\le 16$.\n\nTest point $2$: $n \\le 16$.\n\nTest points $3 \\sim 5$: $n \\le 100$.\n\nTest point $6$: $n \\le 500$.\n\nTest points $7 \\sim 10$: $n \\le 10^4$.\n\nFor all testdata, it is guaranteed that $n \\le 10^4, 0 \\le m \\le \\min(1.5 \\times 10^5, \\dfrac{n(n-1)}{2})$. It is guaranteed that there is no relation of the form $(x, x)$ in the input, and no pair of cities appears twice (no multiple edges, no self-loops).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HAOI2017] 新型城市化", "background": "", "description": "Anihc 国有 $n$ 座城市。城市之间存在一些贸易合作关系，如果城市 $x$ 与城市 $y$ 之间存在贸易协定，那么城市 $x$ 和城市 $y$ 则是一对贸易伙伴（注意： $(x,y)$ 和 $(y,x)$ 是同一对城市）。\n\n为了实现新型城市化，实现统筹城乡一体化以及发挥城市群辐射与带动作用，国家决定规划新型城市关系。一些城市能够被称为城市群的条件是：这些城市两两都是贸易伙伴。由于Anihc 国之前也一直很重视城市关系建设，所以可以保证在目前已存在的贸易合作关系的情况下 Anihc 的 $n$ 座城市可以恰好被划分为不超过两个城市群。\n\n为了建设新型城市关系 Anihc 国想要选出两个之前并不是贸易伙伴的城市，使这两个城市成为贸易伙伴，并且要求在这两个城市成为贸易伙伴之后，最大城市群的大小至少比他们成为贸易伙伴之前的最大城市群的大小增加 $1$。\n\nAnihc 国需要在下一次会议上讨论扩大建设新型城市关系的问题，所以要请你求出在哪些城市之间建立贸易伙伴关系可以使得这个条件成立，即建立此关系前后的最大城市群的大小至少相差 $1$。", "inputFormat": "第一行 $2$ 个整数 $n,m$，表示城市的个数，目前还没有建立贸易伙伴关系的城市的对数。\n\n接下来 $m$ 行，每行 $2$ 个整数 $x,y$ 表示城市 $x,y$ 之间目前还没有建立贸易伙伴关系。", "outputFormat": "第一行 $1$ 个整数 $\\text{ans}$，表示符合条件的城市的对数。\n\n接下来 $\\text{ans}$ 行，每行两个整数，表示一对可以选择来建立贸易伙伴关系的城市。对于一对城市 $x,y$，请先输出编号更小的那一个。最后城市对与城市对之间顺序请按照字典序从小到大输出。", "hint": "数据点 $1$：$n\\le 16$；\n\n数据点 $2$：$n\\le 16$；\n\n数据点 $3\\sim 5$：$n\\le 100$；\n\n数据点 $6$：$n\\le 500$；\n\n数据点 $7\\sim10$：$n\\le 10^4$。\n\n对于所有的数据保证： $n \\le 10^4,0 \\le m \\le \\min(1.5\\times 10^5,\\dfrac{n(n-1)}{2})$。保证输入的城市关系中不会出现 $(x,x)$ 这样的关系，同一对城市也不会出现两次（无重边，无自环）。", "locale": "zh-CN"}}}
{"pid": "P3732", "type": "P", "difficulty": 6, "samples": [["6 3\n010110\n2 5\n1 6\n1 2", "4\n6\n0"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2017", "河南", "各省省选", "排序", "进制", "字典树 Trie"], "title": "[HAOI2017] 供给侧改革", "background": "", "description": "你调查了某个产业近来 $n$ 个时期的供求关系平衡情况，每个时期的情况都用 $0$ 或 $1$ 中的一个数字来表示。于是这就是—个长度为 $n$ 的 $\\texttt{01}$ 字符串 $S$。为了更好的了解这一些数据，你需要解决一些询问，我们令 $\\text{data}(L,R)$ 表示：在字符串 $S$ 中，起始位置在 $[L,R]$ 之间的这些后缀之中，具有最长公共前缀的两个后缀的最长公共前缀的长度。\n\n对于每一个询问 $L,R$，求：\n\n$$ans = \\sum_{L \\leqslant i < R} \\text{data}(i,R)$$\n\n数据范围保证，串 $S$ 中的每一位都是在 $0$ 和 $1$ 之间随机产生的。", "inputFormat": "第一行 $2$ 个整数 $n,Q$，表示字符串的长度，以及询问个数。\n\n接下来一行长度为 $n$ 的一个 $\\texttt{01}$ 串 $S$。\n\n接下来 $Q$ 行，每行 $2$ 个整数 $L,R$，一个询问 $L,R$。", "outputFormat": "\n共 $Q$ 行，每行一个整数，表示对应询问的答案。", "hint": "【数据规模与约定】\n\n|数据点|$n$ 的规模|$Q$ 的规模|\n|:-:|:-:|:-:|\n|$1,2$|$\\leqslant 20$|$\\leqslant 20$|\n|$3,4$|$\\leqslant 100$|$\\leqslant 100$|\n|$5,6$|$\\leqslant 5 \\times 10^3$|$\\leqslant 5 \\times 10^3$|\n|$7,8,9,10$|$\\leqslant 10^5$|$\\leqslant 10^5$|\n\n\n\n对于所有的数据保证：$n \\leqslant 10^5$，$Q \\leqslant 10^5$，$1 \\leqslant L < R \\leqslant n$，$\\texttt{01}$ 串随机生成。", "locale": "zh-CN", "translations": {"en": {"title": "[HAOI2017] Supply-side Reform", "background": "# Description\n\nYou investigated the supply-demand balance of an industry over the past $ n $ periods. Each period is represented by a single digit, either $ 0 $ or $ 1 $. Thus, this forms a $ \\texttt{01} $ string $ S $ of length $ n $. To better understand the data, you need to answer several queries. Let $ \\text{data}(L, R) $ denote: among all suffixes of $ S $ whose starting positions lie in $ [L, R] $, the length of the longest common prefix of the two suffixes that achieve the maximum common prefix.\n\nFor each query $ L, R $, compute:\n$$\nans = \\sum_{L \\leqslant i < R} \\text{data}(i, R).\n$$\n\nIt is guaranteed that each character of $ S $ is randomly generated as $ 0 $ or $ 1 $.", "description": "", "inputFormat": "", "outputFormat": "Output $ Q $ lines, each containing a single integer, the answer to the corresponding query.", "hint": "[Constraints and Notes]\n\n| Data Point | Scale of $ n $ | Scale of $ Q $ |\n|:-:|:-:|:-:|\n| $1, 2$ | $ \\leqslant 20 $ | $ \\leqslant 20 $ |\n| $3, 4$ | $ \\leqslant 100 $ | $ \\leqslant 100 $ |\n| $5, 6$ | $ \\leqslant 5 \\times 10^3 $ | $ \\leqslant 5 \\times 10^3 $ |\n| $7, 8, 9, 10$ | $ \\leqslant 10^5 $ | $ \\leqslant 10^5 $ |\n\nFor all testdata, it is guaranteed that $ n \\leqslant 10^5 $, $ Q \\leqslant 10^5 $, $ 1 \\leqslant L < R \\leqslant n $, and the $ \\texttt{01} $ string is randomly generated.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HAOI2017] 供给侧改革", "background": "", "description": "你调查了某个产业近来 $n$ 个时期的供求关系平衡情况，每个时期的情况都用 $0$ 或 $1$ 中的一个数字来表示。于是这就是—个长度为 $n$ 的 $\\texttt{01}$ 字符串 $S$。为了更好的了解这一些数据，你需要解决一些询问，我们令 $\\text{data}(L,R)$ 表示：在字符串 $S$ 中，起始位置在 $[L,R]$ 之间的这些后缀之中，具有最长公共前缀的两个后缀的最长公共前缀的长度。\n\n对于每一个询问 $L,R$，求：\n\n$$ans = \\sum_{L \\leqslant i < R} \\text{data}(i,R)$$\n\n数据范围保证，串 $S$ 中的每一位都是在 $0$ 和 $1$ 之间随机产生的。", "inputFormat": "第一行 $2$ 个整数 $n,Q$，表示字符串的长度，以及询问个数。\n\n接下来一行长度为 $n$ 的一个 $\\texttt{01}$ 串 $S$。\n\n接下来 $Q$ 行，每行 $2$ 个整数 $L,R$，一个询问 $L,R$。", "outputFormat": "\n共 $Q$ 行，每行一个整数，表示对应询问的答案。", "hint": "【数据规模与约定】\n\n|数据点|$n$ 的规模|$Q$ 的规模|\n|:-:|:-:|:-:|\n|$1,2$|$\\leqslant 20$|$\\leqslant 20$|\n|$3,4$|$\\leqslant 100$|$\\leqslant 100$|\n|$5,6$|$\\leqslant 5 \\times 10^3$|$\\leqslant 5 \\times 10^3$|\n|$7,8,9,10$|$\\leqslant 10^5$|$\\leqslant 10^5$|\n\n\n\n对于所有的数据保证：$n \\leqslant 10^5$，$Q \\leqslant 10^5$，$1 \\leqslant L < R \\leqslant n$，$\\texttt{01}$ 串随机生成。", "locale": "zh-CN"}}}
{"pid": "P3733", "type": "P", "difficulty": 6, "samples": [["4 4 3\n1 2 1110\n1 3 10\n2 4 1110\n2 3 100\nAdd 3 4 11\nChange 1 101\nCancel 1", "1000\n1001\n1111\n1000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2017", "河南", "线段树", "各省省选", "分治", "线性基", "线段树分治"], "title": "[HAOI2017] 八纵八横", "background": "", "description": "Anihc 国有 $n$ 个城市，这 $n$ 个城市从 $1$ 到 $n$ 编号，$1$ 号城市为首都。城市间初始时有 $m$ 条高速公路，每条高速公路都有一个非负整数的经济影响因子，每条高速公路的两端都是城市（可能两端是同一个城市），保证任意两个城市都可以通过高速公路互达。\n\n国正在筹划“八纵八横”的高铁建设计划，计划要修建一些高速铁路，每条高速铁路两端也都是城市（可能两端是同一个城市)，也都有一个非负整数的经济影响因子。国家还计划在“八纵八横”计划建成之后，将“一带一路”扩展为“一带一路一环”，增加“内陆城市经济环”即选择一条从首都出发沿若一系列高铁与高速公路走的路径，每条高铁或高速公路可以经过多次，每座城市也可以经过多次，最后路径又在首都结束。令“内陆城市经济环”的 GDP 为依次将这条路径上所经过的高铁或高速公路的经济影响因子异或起来（一条路经过多次则会被计算多次）。\n\n现在 Anihc 在会议上讨论“八纵八横”的建设计划方案，他们会不断地修改计划方案，希望你能实时反馈对于当前的“八纵八横”的建设计划的方案“内陆城市经济环”的最大是多少。\n\n初始时，八纵八横计划中不包含任何一条高铁，有以下 $3$ 种操作：\n\n`Add x y z`\n\n在计划中给在城市 $x$ 和城市 $y$ 之间建设一条高铁，其经济影响因子为 $z$，如果这是第 $k$ 个 `Add` 操作，则将这条高铁命名为 $k$ 号高铁。\n\n`Cancel k`\n\n将计划中的 $k$ 号高铁取消掉，保证此时 $k$ 号高铁一定存在。\n\n`Change k z`\n\n表示将第 $k$ 号高铁的经济影响因子更改为 $z$，保证此时 $k$ 号高铁一定存在。\n", "inputFormat": "第一行 $3$ 个整数 $n,m,Q$，表示城市个数，高速公路条数，操作个数。\n\n接下来 $m$ 行，每行 $3$ 个整数表示高速公路的信息。\n\n接下来 $Q$ 行，每行为一个操作。\n\n注意：输入的所有经济影响因子都将以二进制的形式从高位到低位给出。\n", "outputFormat": "第一行一个整数。表示如果不修建任何高铁，“内陆城市经济环”的 GDP 最大值。\n\n接下 $Q$ 行每行一个整数，表示进行了对应的每一个操作之后，对于当前的计划，“内陆城市经济环”的 GDP 最大值。\n\n注意：输出的答案也要以二进制的形式从高位到低位给出。\n", "hint": "### 数据规模与约定\n\n令所有的经济因子二进制表示的最多位数为 $len$。数据满足以下表格：\n\n| 数据点 | $n$ | $m$ | $Q$ | $len$ | 特殊性质 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| 1 | $\\leq 5$ | $\\leq 8$ | $0$ | $\\leq 31$ |  |\n| 2 | $\\leq 100$ | $=n + 1$ | $0$ | $\\leq 100$ |  |\n| 3 | $\\leq 100$ | $\\leq 100$ | $0$ | $\\leq 100$ |  |\n| 4 | $\\leq 500$ | $\\leq 500$ | $0$ | $\\leq 1000$ |  |\n| 5 |$\\leq 100$ | $\\leq 100$ | $\\leq 100$ | $\\leq 200$ | 只存在 `Add` 操作 |\n| 6 | $\\leq 500$ | $\\leq 500$ | $\\leq 200$ | $\\leq 1000$ |  |\n| 7 | $\\leq 100$ | $\\leq 100$ | $\\leq 1000$ | $\\leq 200$ |  |\n| 8 | $\\leq 500$ | $\\leq 500$ | $\\leq 1000$ | $\\leq 1000$ |  |\n| 9 | $\\leq 500$ | $\\leq 500$ | $\\leq 1000$ | $\\leq 1000$ |  |\n| 10 | $\\leq 500$ | $\\leq 500$ | $\\leq 1000$ | $\\leq 1000$ |  |\n\n对于所有的数据保证：$1\\leq n,m\\leq 500$，$0\\leq Q\\leq 1000$，$1\\leq len\\leq 1000$，$1\\leq x,y\\leq n$。且 `Add` 操作不超过 $550$ 个。两个城市之间可能有多条高速公路或高铁，高速公路或高铁的两端可能是同一个城市（即：有重边，有自环）。\n", "locale": "zh-CN", "translations": {"en": {"title": "[HAOI2017] Eight Verticals and Eight Horizontals", "background": "", "description": "The country of Anihc has $n$ cities, numbered from $1$ to $n$, with city $1$ being the capital. Initially, there are $m$ highways between cities. Each highway has a non-negative integer economic impact factor, and each highway connects two cities (the endpoints may be the same city). It is guaranteed that any two cities are mutually reachable via highways.\n\nThe country is planning the \"Eight Verticals and Eight Horizontals\" high-speed railway program, which will build some high-speed railways. Each railway also connects two cities (the endpoints may be the same city) and has a non-negative integer economic impact factor. After this program is completed, the country plans to extend the \"Belt and Road\" to \"Belt and Road and Ring\" by adding an \"Inland Cities Economic Ring,\" i.e., choosing a path that starts from the capital and follows a sequence of railways and highways, where each railway or highway may be traversed multiple times, and each city may be visited multiple times, finally returning to the capital. Let the GDP of the \"Inland Cities Economic Ring\" be the XOR of the economic impact factors of the railways and highways traversed along this path in order (an edge traversed multiple times is counted multiple times).\n\nAnihc is discussing the construction plan for \"Eight Verticals and Eight Horizontals\" and will keep modifying the plan. You are asked to report, in real time, the maximum possible GDP of the \"Inland Cities Economic Ring\" for the current plan.\n\nInitially, the plan contains no railways. There are the following $3$ types of operations:\n\n`Add x y z`\n\nAdd a high-speed railway between cities $x$ and $y$ with economic impact factor $z$. If this is the $k$-th `Add` operation, then this railway is named railway $k$.\n\n`Cancel k`\n\nCancel railway $k$ from the plan. It is guaranteed that railway $k$ exists at this moment.\n\n`Change k z`\n\nChange the economic impact factor of railway $k$ to $z$. It is guaranteed that railway $k$ exists at this moment.", "inputFormat": "The first line contains $3$ integers $n, m, Q$, denoting the number of cities, the number of highways, and the number of operations.\n\nThe next $m$ lines each contain $3$ integers, describing a highway.\n\nThe next $Q$ lines each contain one operation, in one of the following forms: `Add x y z`, `Cancel k`, or `Change k z`.\n\nNote: All economic impact factors in the input are given in binary, from the most significant bit to the least significant bit.", "outputFormat": "Output one integer on the first line: the maximum possible GDP of the \"Inland Cities Economic Ring\" if no railway is built.\n\nThen output $Q$ lines, each containing one integer, where the $i$-th line is the maximum possible GDP of the \"Inland Cities Economic Ring\" after performing the $i$-th operation with respect to the current plan.\n\nNote: All answers must be output in binary, from the most significant bit to the least significant bit.", "hint": "Constraints and Notes.\n\nLet $len$ be the maximum number of bits among the binary representations of all economic impact factors. The testdata satisfies the following table:\n\n| Data Point | $n$ | $m$ | $Q$ | $len$ | Special Property |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| 1 | $\\leq 5$ | $\\leq 8$ | $0$ | $\\leq 31$ |  |\n| 2 | $\\leq 100$ | $= n + 1$ | $0$ | $\\leq 100$ |  |\n| 3 | $\\leq 100$ | $\\leq 100$ | $0$ | $\\leq 100$ |  |\n| 4 | $\\leq 500$ | $\\leq 500$ | $0$ | $\\leq 1000$ |  |\n| 5 | $\\leq 100$ | $\\leq 100$ | $\\leq 100$ | $\\leq 200$ | Only `Add` operations |\n| 6 | $\\leq 500$ | $\\leq 500$ | $\\leq 200$ | $\\leq 1000$ |  |\n| 7 | $\\leq 100$ | $\\leq 100$ | $\\leq 1000$ | $\\leq 200$ |  |\n| 8 | $\\leq 500$ | $\\leq 500$ | $\\leq 1000$ | $\\leq 1000$ |  |\n| 9 | $\\leq 500$ | $\\leq 500$ | $\\leq 1000$ | $\\leq 1000$ |  |\n| 10 | $\\leq 500$ | $\\leq 500$ | $\\leq 1000$ | $\\leq 1000$ |  |\n\nFor all testdata it is guaranteed that $1 \\leq n, m \\leq 500$, $0 \\leq Q \\leq 1000$, $1 \\leq len \\leq 1000$, $1 \\leq x, y \\leq n$. Moreover, the number of `Add` operations does not exceed $550$. There may be multiple highways or railways between two cities, and an edge may have both endpoints at the same city (i.e., multiedges and self-loops).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HAOI2017] 八纵八横", "background": "", "description": "Anihc 国有 $n$ 个城市，这 $n$ 个城市从 $1$ 到 $n$ 编号，$1$ 号城市为首都。城市间初始时有 $m$ 条高速公路，每条高速公路都有一个非负整数的经济影响因子，每条高速公路的两端都是城市（可能两端是同一个城市），保证任意两个城市都可以通过高速公路互达。\n\n国正在筹划“八纵八横”的高铁建设计划，计划要修建一些高速铁路，每条高速铁路两端也都是城市（可能两端是同一个城市)，也都有一个非负整数的经济影响因子。国家还计划在“八纵八横”计划建成之后，将“一带一路”扩展为“一带一路一环”，增加“内陆城市经济环”即选择一条从首都出发沿若一系列高铁与高速公路走的路径，每条高铁或高速公路可以经过多次，每座城市也可以经过多次，最后路径又在首都结束。令“内陆城市经济环”的 GDP 为依次将这条路径上所经过的高铁或高速公路的经济影响因子异或起来（一条路经过多次则会被计算多次）。\n\n现在 Anihc 在会议上讨论“八纵八横”的建设计划方案，他们会不断地修改计划方案，希望你能实时反馈对于当前的“八纵八横”的建设计划的方案“内陆城市经济环”的最大是多少。\n\n初始时，八纵八横计划中不包含任何一条高铁，有以下 $3$ 种操作：\n\n`Add x y z`\n\n在计划中给在城市 $x$ 和城市 $y$ 之间建设一条高铁，其经济影响因子为 $z$，如果这是第 $k$ 个 `Add` 操作，则将这条高铁命名为 $k$ 号高铁。\n\n`Cancel k`\n\n将计划中的 $k$ 号高铁取消掉，保证此时 $k$ 号高铁一定存在。\n\n`Change k z`\n\n表示将第 $k$ 号高铁的经济影响因子更改为 $z$，保证此时 $k$ 号高铁一定存在。\n", "inputFormat": "第一行 $3$ 个整数 $n,m,Q$，表示城市个数，高速公路条数，操作个数。\n\n接下来 $m$ 行，每行 $3$ 个整数表示高速公路的信息。\n\n接下来 $Q$ 行，每行为一个操作。\n\n注意：输入的所有经济影响因子都将以二进制的形式从高位到低位给出。\n", "outputFormat": "第一行一个整数。表示如果不修建任何高铁，“内陆城市经济环”的 GDP 最大值。\n\n接下 $Q$ 行每行一个整数，表示进行了对应的每一个操作之后，对于当前的计划，“内陆城市经济环”的 GDP 最大值。\n\n注意：输出的答案也要以二进制的形式从高位到低位给出。\n", "hint": "### 数据规模与约定\n\n令所有的经济因子二进制表示的最多位数为 $len$。数据满足以下表格：\n\n| 数据点 | $n$ | $m$ | $Q$ | $len$ | 特殊性质 |\n| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |\n| 1 | $\\leq 5$ | $\\leq 8$ | $0$ | $\\leq 31$ |  |\n| 2 | $\\leq 100$ | $=n + 1$ | $0$ | $\\leq 100$ |  |\n| 3 | $\\leq 100$ | $\\leq 100$ | $0$ | $\\leq 100$ |  |\n| 4 | $\\leq 500$ | $\\leq 500$ | $0$ | $\\leq 1000$ |  |\n| 5 |$\\leq 100$ | $\\leq 100$ | $\\leq 100$ | $\\leq 200$ | 只存在 `Add` 操作 |\n| 6 | $\\leq 500$ | $\\leq 500$ | $\\leq 200$ | $\\leq 1000$ |  |\n| 7 | $\\leq 100$ | $\\leq 100$ | $\\leq 1000$ | $\\leq 200$ |  |\n| 8 | $\\leq 500$ | $\\leq 500$ | $\\leq 1000$ | $\\leq 1000$ |  |\n| 9 | $\\leq 500$ | $\\leq 500$ | $\\leq 1000$ | $\\leq 1000$ |  |\n| 10 | $\\leq 500$ | $\\leq 500$ | $\\leq 1000$ | $\\leq 1000$ |  |\n\n对于所有的数据保证：$1\\leq n,m\\leq 500$，$0\\leq Q\\leq 1000$，$1\\leq len\\leq 1000$，$1\\leq x,y\\leq n$。且 `Add` 操作不超过 $550$ 个。两个城市之间可能有多条高速公路或高铁，高速公路或高铁的两端可能是同一个城市（即：有重边，有自环）。\n", "locale": "zh-CN"}}}
{"pid": "P3734", "type": "P", "difficulty": 6, "samples": [["1 1 1\n0", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2017", "河南", "各省省选"], "title": "[HAOI2017] 方案数", "background": "", "description": "考虑定义非负整数间的“$ \\subseteq $”，如果 $ a \\subseteq b $，那么 $ a \\land b = a $，其中 $ \\land $ 表示二进制下的“与”操作。\n\n\n考虑现在有一个无限大的空间，现在你在 $ (0, 0, 0) $，有三种位移操作。\n\n\n一、$(x,y,z)\\to(x',y,z)$ if $x\\subseteq x'$  \n二、$(x,y,z)\\to(x,y',z)$ if $y\\subseteq y'$  \n三、$(x,y,z)\\to(x,y,z')$ if $z\\subseteq z'$  \n\n由于来自东方的神秘力量，有些点被屏蔽了，也就是不能经过了。现在问你到某个点 $ (n, m, r) $ 的方案数，答案对 $ 998244353 $ 取模。\n", "inputFormat": "第一行三个整数 $ n, m, r $。\n\n\n接下来一行一个整数 $ o $，表示障碍物的数量。\n\n\n接下来 $ o $ 行，每行三个整数 $ x, y, z $ 表示障碍物的坐标，$ 0 \\le x \\le n, 0 \\le y \\le m, 0 \\le z \\le r $，且障碍物不在 $ (0, 0, 0) $ 和 $ (n, m, r) $ 上，障碍物不会重复。\n\n", "outputFormat": "一行一个整数，代表要求的答案。\n", "hint": "【样例解释】\n\n有8种状态（0,0,0),(0,0,1),(0,1,0),(0,1,1),(1,0,0),(1,0,1),(1,1,0),(1,1,1),分别方案数为 1,1,1,2,1,2,2,6。\n\n【数据规模和约定】\n\n对于 $ 20\\% $ 的数据，满足：$ n, m, r \\le 100 $\n\n\n对于 $ 50\\% $ 的数据，满足：$ n, m, r \\le 10^6 $\n\n\n对于另外 $ 20\\% $ 的数据，满足：$ o \\le 10 $\n\n\n对于 $ 100\\% $ 的数据，满足：$ n, m, r \\le 10^{18}, o \\le 10^4 $\n", "locale": "zh-CN", "translations": {"en": {"title": "[HAOI2017] Number of Plans", "background": "", "description": "Define a relation $ \\subseteq $ on non-negative integers: if $ a \\subseteq b $, then $ a \\land b = a $, where $ \\land $ denotes the bitwise AND.\n\nConsider an infinite space. You start at $ (0, 0, 0) $, and you have three types of moves:\n\n1. $ (x, y, z) \\to (x', y, z) $ if $ x \\subseteq x' $.\n2. $ (x, y, z) \\to (x, y', z) $ if $ y \\subseteq y' $.\n3. $ (x, y, z) \\to (x, y, z') $ if $ z \\subseteq z' $.\n\nDue to a mysterious force, some points are blocked, i.e., you cannot pass through them. Find the number of ways to reach the point $ (n, m, r) $. Output the answer modulo $ 998244353 $.", "inputFormat": "The first line contains three integers $ n, m, r $.\n\nThe next line contains a single integer $ o $, the number of obstacles.\n\nEach of the next $ o $ lines contains three integers $ x, y, z $ giving the coordinates of an obstacle, where $ 0 \\le x \\le n $, $ 0 \\le y \\le m $, $ 0 \\le z \\le r $. No obstacle is at $ (0, 0, 0) $ or $ (n, m, r) $, and obstacles are pairwise distinct.", "outputFormat": "Output a single integer, the required answer.", "hint": "[Sample explanation]\n\nThere are 8 states: $ (0, 0, 0) $, $ (0, 0, 1) $, $ (0, 1, 0) $, $ (0, 1, 1) $, $ (1, 0, 0) $, $ (1, 0, 1) $, $ (1, 1, 0) $, $ (1, 1, 1) $. The corresponding numbers of ways are $ 1, 1, 1, 2, 1, 2, 2, 6 $.\n\n[Constraints]\n\n- For $ 20\\% $ of the testdata: $ n, m, r \\le 100 $.\n- For $ 50\\% $ of the testdata: $ n, m, r \\le 10^6 $.\n- For another $ 20\\% $ of the testdata: $ o \\le 10 $.\n- For $ 100\\% $ of the testdata: $ n, m, r \\le 10^{18} $, $ o \\le 10^4 $.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HAOI2017] 方案数", "background": "", "description": "考虑定义非负整数间的“$ \\subseteq $”，如果 $ a \\subseteq b $，那么 $ a \\land b = a $，其中 $ \\land $ 表示二进制下的“与”操作。\n\n\n考虑现在有一个无限大的空间，现在你在 $ (0, 0, 0) $，有三种位移操作。\n\n\n一、$(x,y,z)\\to(x',y,z)$ if $x\\subseteq x'$  \n二、$(x,y,z)\\to(x,y',z)$ if $y\\subseteq y'$  \n三、$(x,y,z)\\to(x,y,z')$ if $z\\subseteq z'$  \n\n由于来自东方的神秘力量，有些点被屏蔽了，也就是不能经过了。现在问你到某个点 $ (n, m, r) $ 的方案数，答案对 $ 998244353 $ 取模。\n", "inputFormat": "第一行三个整数 $ n, m, r $。\n\n\n接下来一行一个整数 $ o $，表示障碍物的数量。\n\n\n接下来 $ o $ 行，每行三个整数 $ x, y, z $ 表示障碍物的坐标，$ 0 \\le x \\le n, 0 \\le y \\le m, 0 \\le z \\le r $，且障碍物不在 $ (0, 0, 0) $ 和 $ (n, m, r) $ 上，障碍物不会重复。\n\n", "outputFormat": "一行一个整数，代表要求的答案。\n", "hint": "【样例解释】\n\n有8种状态（0,0,0),(0,0,1),(0,1,0),(0,1,1),(1,0,0),(1,0,1),(1,1,0),(1,1,1),分别方案数为 1,1,1,2,1,2,2,6。\n\n【数据规模和约定】\n\n对于 $ 20\\% $ 的数据，满足：$ n, m, r \\le 100 $\n\n\n对于 $ 50\\% $ 的数据，满足：$ n, m, r \\le 10^6 $\n\n\n对于另外 $ 20\\% $ 的数据，满足：$ o \\le 10 $\n\n\n对于 $ 100\\% $ 的数据，满足：$ n, m, r \\le 10^{18}, o \\le 10^4 $\n", "locale": "zh-CN"}}}
