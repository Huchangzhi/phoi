{"pid": "P2126", "type": "P", "difficulty": 3, "samples": [["5\n12\n0 2 15\n2 3 20\n3 5 13\n1 3 29\n0 1 30\n2 4 21\n0 3 23\n5 1 48\n0 4 17\n0 5 27\n1 2 43\n2 5 41\n", "94\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["图论", "贪心"], "title": "Mzc家中的男家丁", "background": "mzc 与 djn 的…还没有众人皆知，所以我们要来宣传一下。", "description": "mzc 家很有钱（开玩笑），他家有 $n$ 个男家丁，现在 mzc 要将他们全都聚集起来（干什么就不知道了）。现在知道 mzc 与男家丁们互相之间通信的时间，请算出把他们每个人叫到需要的总时间（要重复的哦）。保证能把他们每个人叫到。", "inputFormat": "第一行有一个数 $n$，表示有 $n$ 个男家丁。第二行一个数 $m$ 表示有 $m$ 条通信路线。之后 $m$ 行，每行三个数 $a_i,b_i,c_i$，表示第 $a_i$个男家丁（或 mzx）和第 $b_i$ 个男家丁（或 mzc）通信需要时间（双向）。$a_i$ 或 $b_i=0$ 表示 mzc。", "outputFormat": "一行，一个数 $sum$，表示把他们每个人叫到需要的总时间。", "hint": "$1\\le n\\leq2300$，$1\\le m\\leq4\\times10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "Male Servants in Mzc's Household", "background": "The thing between mzc and djn is not yet widely known, so we are going to spread the word.", "description": "mzc is very rich (just kidding). He has $n$ male servants. Now mzc wants to gather them all together (for reasons unknown). Given the communication times between mzc and the male servants, please compute the total time needed to call each of them (counting repeated uses). It is guaranteed that everyone can be called.", "inputFormat": "The first line contains a number $n$, indicating there are $n$ male servants.  \nThe second line contains a number $m$, indicating there are $m$ communication routes.  \nThen follow $m$ lines, each with three numbers $a_i, b_i, c_i$, meaning that the time needed for communication between the $a_i$-th male servant (or mzc) and the $b_i$-th male servant (or mzc) is $c_i$ (bidirectional). Here, $a_i$ or $b_i = 0$ denotes mzc.", "outputFormat": "One line with a single number $sum$, representing the total time required to call each of them.", "hint": "Constraints: $1\\le n\\leq2300$, $1\\le m\\leq4\\times10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Mzc家中的男家丁", "background": "mzc 与 djn 的…还没有众人皆知，所以我们要来宣传一下。", "description": "mzc 家很有钱（开玩笑），他家有 $n$ 个男家丁，现在 mzc 要将他们全都聚集起来（干什么就不知道了）。现在知道 mzc 与男家丁们互相之间通信的时间，请算出把他们每个人叫到需要的总时间（要重复的哦）。保证能把他们每个人叫到。", "inputFormat": "第一行有一个数 $n$，表示有 $n$ 个男家丁。第二行一个数 $m$ 表示有 $m$ 条通信路线。之后 $m$ 行，每行三个数 $a_i,b_i,c_i$，表示第 $a_i$个男家丁（或 mzx）和第 $b_i$ 个男家丁（或 mzc）通信需要时间（双向）。$a_i$ 或 $b_i=0$ 表示 mzc。", "outputFormat": "一行，一个数 $sum$，表示把他们每个人叫到需要的总时间。", "hint": "$1\\le n\\leq2300$，$1\\le m\\leq4\\times10^5$。", "locale": "zh-CN"}}}
{"pid": "P2127", "type": "P", "difficulty": 5, "samples": [["6\n8 4 5 3 2 7", "34"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "贪心", "离散化"], "title": "序列排序", "background": null, "description": "小 C 有一个 $N$ 个数的整数序列，这个序列的中的数两两不同。\n\n小 C 每次可以交换序列中的任意两个数，代价为这两个数之和。\n\n小 C 希望将整个序列升序排序，问小 C 需要的最小代价是多少？", "inputFormat": "第一行，一个整数 $N$。\n\n第二行，$N$ 个整数，表示小 C 的序列。", "outputFormat": "一行，一个整数，表示小 C 需要的最小代价。", "hint": "对于 $30\\%$ 的数据，$N\\le10$。\n\n对于 $100\\%$ 的数据，$1\\le N\\le10^5$，第二行的 $N$ 个整数均为不超过 $10^9$ 的正整数。", "locale": "zh-CN", "translations": {"en": {"title": "Sorting a Sequence", "background": "", "description": "Xiao C has an integer sequence of $N$ numbers, in which all numbers are pairwise distinct.\n\nEach time, Xiao C can swap any two numbers in the sequence, with a cost equal to the sum of those two numbers.\n\nXiao C wants to sort the entire sequence in ascending order. What is the minimal cost needed?", "inputFormat": "The first line contains an integer $N$.\n\nThe second line contains $N$ integers, representing Xiao C's sequence.", "outputFormat": "Output one line containing an integer, the minimal cost Xiao C needs.", "hint": "- For $30\\%$ of the testdata, $N\\le10$.\n- For $100\\%$ of the testdata, $1\\le N\\le10^5$, and the $N$ integers on the second line are positive integers not exceeding $10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "序列排序", "background": null, "description": "小 C 有一个 $N$ 个数的整数序列，这个序列的中的数两两不同。\n\n小 C 每次可以交换序列中的任意两个数，代价为这两个数之和。\n\n小 C 希望将整个序列升序排序，问小 C 需要的最小代价是多少？", "inputFormat": "第一行，一个整数 $N$。\n\n第二行，$N$ 个整数，表示小 C 的序列。", "outputFormat": "一行，一个整数，表示小 C 需要的最小代价。", "hint": "对于 $30\\%$ 的数据，$N\\le10$。\n\n对于 $100\\%$ 的数据，$1\\le N\\le10^5$，第二行的 $N$ 个整数均为不超过 $10^9$ 的正整数。", "locale": "zh-CN"}}}
{"pid": "P2128", "type": "P", "difficulty": 3, "samples": [["4 6\n100\n5000\n1000\n2000\n1 2\n1 3\n1 4\n2 3\n2 4\n3 4", "8100"], ["6 8\n1500\n1000\n100\n2000\n500\n300\n1 2\n1 3\n1 4\n2 4\n3 5\n4 5\n4 6\n5 6", "4500"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "数学"], "title": "赤壁之战", "background": "", "description": "赤壁之战，黄盖率舰满载薪草膏油诈降曹军。\n\n受庞统所授的连环计，曹军战船之间由铁索相连，没有两艘战船在同一位置，也没有铁索两两相交或穿过战船。每艘船都有其一定的战略价值。\n\n为了保证达到破坏效果，黄盖需要保证被点燃的曹军船只两两之间都有铁索连接。他希望找到一种方案点燃总价值尽可能大的战船。\n", "inputFormat": "第一行包含数字 $N$，$M$ ，表示战船的数量和铁索的数量。\n\n接下来包含 $N$ 行，每 $i$ 行包含 $1$ 个数字 $V_i$，表示第 $i$ 艘战船的战略价值。\n\n接下来包含 $M$ 行，每 $i$ 行包含 $2$ 个数字 $S_i$，$T_i$ ，表示铁索连接的两艘船只。\n\n数据保证这是一个可行的舰队安排。\n", "outputFormat": "输出一个数字，表示最多摧毁总价值多少的战船。\n", "hint": "#### 【数据规模】\n\n对于 $50\\%$ 的数据，保证 $N$，$M \\le 10$。\n\n对于 $100\\%$ 数据，保证 $N \\le 450$，$M \\le 900$，$V_i \\le 6000$。\n\n#### 【注意】\n\n题目中的每句话（除了第一段）都有作用。", "locale": "zh-CN", "translations": {"en": {"title": "The Battle of Red Cliffs", "background": "", "description": "At the Battle of Red Cliffs, Huang Gai (Huang Gai) pretended to defect to Cao Cao’s fleet with ships loaded with reeds and oil.\n\nUnder Pang Tong’s “chained ships” stratagem, Cao Cao’s warships were connected by iron chains. No two ships were at the same position, and no chains intersected one another or passed through any ship. Each ship had a given strategic value.\n\nTo ensure the destructive effect, Huang Gai must guarantee that every pair among the ignited Cao Cao ships is directly connected by an iron chain. He hopes to find a plan to ignite ships whose total value is as large as possible.", "inputFormat": "The first line contains numbers $N$, $M$, the number of warships and the number of iron chains.\n\nThe next $N$ lines, the $i$-th line contains $1$ number $V_i$, the strategic value of the $i$-th warship.\n\nThe next $M$ lines, the $i$-th line contains $2$ numbers $S_i$, $T_i$, indicating the two ships connected by an iron chain.\n\nIt is guaranteed that this is a valid fleet arrangement.", "outputFormat": "Output one number, the maximum total value of warships that can be destroyed.", "hint": "- Constraints\n  - For $50\\%$ of the testdata, $N$, $M \\le 10$.\n  - For $100\\%$ of the testdata, $N \\le 450$, $M \\le 900$, $V_i \\le 6000$.\n- Note\n  - Every sentence in the statement (except the first paragraph) is relevant.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "赤壁之战", "background": "", "description": "赤壁之战，黄盖率舰满载薪草膏油诈降曹军。\n\n受庞统所授的连环计，曹军战船之间由铁索相连，没有两艘战船在同一位置，也没有铁索两两相交或穿过战船。每艘船都有其一定的战略价值。\n\n为了保证达到破坏效果，黄盖需要保证被点燃的曹军船只两两之间都有铁索连接。他希望找到一种方案点燃总价值尽可能大的战船。\n", "inputFormat": "第一行包含数字 $N$，$M$ ，表示战船的数量和铁索的数量。\n\n接下来包含 $N$ 行，每 $i$ 行包含 $1$ 个数字 $V_i$，表示第 $i$ 艘战船的战略价值。\n\n接下来包含 $M$ 行，每 $i$ 行包含 $2$ 个数字 $S_i$，$T_i$ ，表示铁索连接的两艘船只。\n\n数据保证这是一个可行的舰队安排。\n", "outputFormat": "输出一个数字，表示最多摧毁总价值多少的战船。\n", "hint": "#### 【数据规模】\n\n对于 $50\\%$ 的数据，保证 $N$，$M \\le 10$。\n\n对于 $100\\%$ 数据，保证 $N \\le 450$，$M \\le 900$，$V_i \\le 6000$。\n\n#### 【注意】\n\n题目中的每句话（除了第一段）都有作用。", "locale": "zh-CN"}}}
{"pid": "P2129", "type": "P", "difficulty": 4, "samples": [["3 3\n0 0\n4 -3\n6 7\nx\nm -1 2\ny\n", "1 2\n-3 5\n-5 -5\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "数学", "矩阵运算", "矩阵乘法"], "title": "L 国的战斗续之多路出击", "background": "广而告之：背景见其他L国的战斗！！大家一起刷\n", "description": "这一次，L 国决定军队分成 $n$ 组，分布在各地，若以 L 国为原点，可以看作在一个直角坐标系内。但是他们都受统一的指挥，指令部共发出 $m$ 个命令。命令有移动、上下转移和左右转移，但是由于某些奇奇怪怪的原因，军队收到命令总是有延迟，为了方便，军方已经写好一个栈，所以你要处理的顺序，应该是从后往前。\n", "inputFormat": "输入包括 $n+m+1$ 行。\n\n第一行两个整数 $n,m$。\n\n接下来 $n$ 行，第 $i+1$ 行两个整数 $x_i,y_i$ 表示第 $i$ 支军队的位置。\n\n接下来 $m$ 行，每行首先是一个字符 $c$。\n- 若 $c$ 为 `m`，则后面再输入两个整数 $p,q$，表示把每支军队的位置从 $(x_i,y_i)$ 移到 $(x_i+p,y_i+q)$。\n- 若 $c$ 为 `x`，则表示把每支军队的位置从 $(x_i,y_i)$ 移到 $(-x_i,y_i)$。\n- 若 $c$ 为 `y`，则表示把每支军队的位置从 $(x_i,y_i)$ 移到 $(x_i,-y_i)$。", "outputFormat": "输出包含 $n$ 行，第 $i$ 行有两个整数 $x_i',y_i'$，表示第 $i$ 支军队移动后的位置。\n", "hint": "对于 $30\\%$ 的数据，$1\\leqslant n,m\\leqslant 1000$。\n\n对于 $100\\%$ 的数据，$1\\leqslant n,m\\leqslant 5\\times 10^5$，$x_i,y_i$ 在 `int` 范围内。", "locale": "zh-CN", "translations": {"en": {"title": "The Battle of Country L Continues: Multi-route Offensive", "background": "Public notice: see the background in other “The Battle of Country L” problems. Let’s solve them together.", "description": "This time, Country L decides to divide its army into $n$ groups distributed across various locations. Taking Country L as the origin, these positions can be viewed in a Cartesian coordinate system. All groups are under unified command, and the command center issues $m$ commands. Commands include translation, up-down flip, and left-right flip. However, due to some odd latency, the army always receives commands with a delay. For convenience, a stack has already been prepared, so you must process the commands from back to front.", "inputFormat": "The input consists of $n+m+1$ lines.\n\nThe first line contains two integers $n, m$.\n\nThe next $n$ lines: on the $(i+1)$-th line, two integers $x_i, y_i$ give the location of the $i$-th army group.\n\nThe next $m$ lines each start with a character $c$.\n- If $c$ is `m`, then two integers $p, q$ follow, meaning every group moves from $(x_i, y_i)$ to $(x_i + p, y_i + q)$.\n- If $c$ is `x`, then every group moves from $(x_i, y_i)$ to $(-x_i, y_i)$ (left-right flip, i.e., reflection across the $y$-axis).\n- If $c$ is `y`, then every group moves from $(x_i, y_i)$ to $(x_i, -y_i)$ (up-down flip, i.e., reflection across the $x$-axis).", "outputFormat": "Output $n$ lines. On the $i$-th line, print two integers $x_i', y_i'$, the final position of the $i$-th army group after all commands are applied (processed from last to first).", "hint": "For $30\\%$ of the testdata, $1 \\leqslant n, m \\leqslant 1000$.\n\nFor $100\\%$ of the testdata, $1 \\leqslant n, m \\leqslant 5 \\times 10^5$, and $x_i, y_i$ are within the `int` range.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "L 国的战斗续之多路出击", "background": "广而告之：背景见其他L国的战斗！！大家一起刷\n", "description": "这一次，L 国决定军队分成 $n$ 组，分布在各地，若以 L 国为原点，可以看作在一个直角坐标系内。但是他们都受统一的指挥，指令部共发出 $m$ 个命令。命令有移动、上下转移和左右转移，但是由于某些奇奇怪怪的原因，军队收到命令总是有延迟，为了方便，军方已经写好一个栈，所以你要处理的顺序，应该是从后往前。\n", "inputFormat": "输入包括 $n+m+1$ 行。\n\n第一行两个整数 $n,m$。\n\n接下来 $n$ 行，第 $i+1$ 行两个整数 $x_i,y_i$ 表示第 $i$ 支军队的位置。\n\n接下来 $m$ 行，每行首先是一个字符 $c$。\n- 若 $c$ 为 `m`，则后面再输入两个整数 $p,q$，表示把每支军队的位置从 $(x_i,y_i)$ 移到 $(x_i+p,y_i+q)$。\n- 若 $c$ 为 `x`，则表示把每支军队的位置从 $(x_i,y_i)$ 移到 $(-x_i,y_i)$。\n- 若 $c$ 为 `y`，则表示把每支军队的位置从 $(x_i,y_i)$ 移到 $(x_i,-y_i)$。", "outputFormat": "输出包含 $n$ 行，第 $i$ 行有两个整数 $x_i',y_i'$，表示第 $i$ 支军队移动后的位置。\n", "hint": "对于 $30\\%$ 的数据，$1\\leqslant n,m\\leqslant 1000$。\n\n对于 $100\\%$ 的数据，$1\\leqslant n,m\\leqslant 5\\times 10^5$，$x_i,y_i$ 在 `int` 范围内。", "locale": "zh-CN"}}}
{"pid": "P2130", "type": "P", "difficulty": 4, "samples": [["2 2\n$$\n.#", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["搜索", "线性数据结构"], "title": "狂奔的Wzf", "background": "众所周知，Wzf 一直想写作业。\n\n可是今天，它的作业被 WSD 抢了！！！\n\nWzf 很愤怒！！！\n\n他决定以最快的速度，冲向作业。\n\n在他面前是一个迷宫，作业就在其中！", "description": "现有一个 $n$ 行 $m$ 列的迷宫：\n\n|标识|含义|\n|:-:|:-:|\n|`$`|空地，能走上去|\n|`.`|也是空地，也能走上去|\n|`X`|障碍，不能走上去|\n|`#`|终点，这里有 Wzf 的作业|\n\nWzf 从迷宫左上角（第 $1$ 行第 $1$ 列）开始，每秒钟可以：\n\n1. 选中一个方向（上 / 下 / 左 / 右）。\n2. 选中一个非负整数 $k$。\n3. 向选中的方向跨一步，移动 $2^k$ 格：\n   - 中途**不可以**跨过障碍。\n   - 落脚点上不能有障碍。\n   - 不能走到迷宫之外。\n\n求 Wzf 至少需要多少秒才能走到终点。", "inputFormat": "第一行两个整数 $n,m\\ (1 \\le n,m \\le 1000)$。\n\n接下来 $n$ 行，每行 $m$ 个字符。\n\n**保证 `#` 有且只有一个。**\n\n**保证第 $\\bm 1$ 行第 $\\bm 1$ 列的标识不是 `X`。**", "outputFormat": "一行一个整数，表示 Wzf 至少需要多少秒才能走到终点。\n\n如果 Wzf 不可能走到终点，那么输出 $-1$。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "The Sprinting Wzf", "background": "As everyone knows, Wzf always wants to do homework.\n\nBut today, WSD snatched its homework!!!\n\nWzf is furious!!!\n\nIt decides to rush toward the homework at top speed.\n\nIn front of it is a maze, and the homework is inside!", "description": "There is a maze with $n$ rows and $m$ columns:\n\n|标识|含义|\n|:-:|:-:|\n|`$`|Empty cell, walkable.|\n|`.`|Also an empty cell, also walkable.|\n|`X`|Obstacle, not walkable.|\n|`#`|Goal; Wzf's homework is here.|\n\nWzf starts from the top-left corner of the maze (row $1$, column $1$). Each second, it can:\n\n1. Choose a direction (up / down / left / right).\n2. Choose a non-negative integer $m$.\n3. Take one step in the chosen direction, moving $2^m$ cells:\n   - It must not cross any obstacle along the way.\n   - The landing cell must not contain an obstacle.\n   - It cannot go outside the maze.\n\nFind the minimum number of seconds Wzf needs to reach the goal.", "inputFormat": "The first line contains two integers $n, m$ with $1 \\le n, m \\le 1000$.\n\nThe next $n$ lines each contain $m$ characters.\n\nIt is guaranteed that there is exactly one `#`.\n\nIt is guaranteed that the cell at row $\\bm 1$, column $\\bm 1$ is not `X`.", "outputFormat": "Output a single integer, the minimum number of seconds Wzf needs to reach the goal.\n\nIf Wzf cannot reach the goal, output $-1$.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "狂奔的Wzf", "background": "众所周知，Wzf 一直想写作业。\n\n可是今天，它的作业被 WSD 抢了！！！\n\nWzf 很愤怒！！！\n\n他决定以最快的速度，冲向作业。\n\n在他面前是一个迷宫，作业就在其中！", "description": "现有一个 $n$ 行 $m$ 列的迷宫：\n\n|标识|含义|\n|:-:|:-:|\n|`$`|空地，能走上去|\n|`.`|也是空地，也能走上去|\n|`X`|障碍，不能走上去|\n|`#`|终点，这里有 Wzf 的作业|\n\nWzf 从迷宫左上角（第 $1$ 行第 $1$ 列）开始，每秒钟可以：\n\n1. 选中一个方向（上 / 下 / 左 / 右）。\n2. 选中一个非负整数 $k$。\n3. 向选中的方向跨一步，移动 $2^k$ 格：\n   - 中途**不可以**跨过障碍。\n   - 落脚点上不能有障碍。\n   - 不能走到迷宫之外。\n\n求 Wzf 至少需要多少秒才能走到终点。", "inputFormat": "第一行两个整数 $n,m\\ (1 \\le n,m \\le 1000)$。\n\n接下来 $n$ 行，每行 $m$ 个字符。\n\n**保证 `#` 有且只有一个。**\n\n**保证第 $\\bm 1$ 行第 $\\bm 1$ 列的标识不是 `X`。**", "outputFormat": "一行一个整数，表示 Wzf 至少需要多少秒才能走到终点。\n\n如果 Wzf 不可能走到终点，那么输出 $-1$。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P2131", "type": "P", "difficulty": 5, "samples": [["((B)())", "0"], ["((((B)(B))((B)()))(B))", "impossible"], ["(()(((B)(B))(B)))", "1"]], "limits": {"time": [256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256, 256], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "树形数据结构"], "title": "彩球树", "background": "小 Z 是一个聪明的小学生，他用塑料管和橡皮泥搭成了一棵树，每个橡皮泥上都连接着一个向下的塑料管，有的连接着两根向上的塑料管，有的则连接着一些彩球。\n\n然而，这个工艺品很快因为不平衡倒了下来。于是，小 Z 请教了和他在同一个班上的妹子小 C。在百科全书上看到天平平衡原理的小 C 知道，如果任何一块橡皮泥向上连接的两根管子的载重量之差超过一个彩球的重量，工艺品就会不平衡倒下来。由于彩球比较重，橡皮泥和塑料管的重量可以忽略不计。\n\n由于移动彩球需要花时间拆卸和固定，小 C 希望移动最少次数彩球让这个工艺品平衡起来。你能帮助她吗？", "description": "给定一棵叶子带权值二叉树，保证每个非叶子结点都有两个儿子，权值只能是 $0$ 或 $1$。\n\n你可以进行以下操作若干次：选中两个叶子，交换它们的权值。\n\n定义一颗子树的权值为子树内所有叶子的权值之和。\n\n你希望通过以上操作使得任意非叶子结点的左子树权值和右子树权值相差不超过 $1$。\n\n求达成以上目标需要的最少操作次数。", "inputFormat": "一行一个字符串 $T$，以中序遍历的方式描述了这棵树，`B` 表示彩球。\n\n\n---\n\n\n形式化的，$T$ 的 CFG（上下文无关文法）定义为：\n\n```plain\n<T> := (<T><T>) | (B) | ()\n```\n\n\n\n|项目|含义|\n|:-:|:-:|\n|`(<T><T>)`|一个非叶子结点，两个 `<T>` 分别为它的左子树和右子树|\n|`(B)`|一个权值为 $1$ 的叶子结点|\n|`()`|一个权值为 $0$ 的叶子结点|", "outputFormat": "输出一个数字，表示最少移动多少个彩球就能使它平衡，或输出 `impossible`，表示如何移动多少个都无法平衡。\n\n\n---\n\n\n输出一个数字，表示至少需要多少次操作，或输出 `impossible`，表示不可能达成目标。", "hint": "【样例解释】\n\n![](https://cdn.luogu.com.cn/upload/pic/1259.png)\n\n【数据规模】\n\n设 $N$ 为字符串 $T$ 的长度。\n\n对于 $15\\%$ 的数据，$N \\le 25$。\n\n对于 $50\\%$ 的数据，$N \\le 250$。\n\n对于 $100\\%$ 的数据，$2 \\le N \\le 5000$。", "locale": "zh-CN", "translations": {"en": {"title": "Colored Ball Tree", "background": "Xiao Z is a smart primary school student. He built a tree using plastic tubes and clay. Each piece of clay is connected to one downward plastic tube; some are connected to two upward plastic tubes, while others are connected to some colored balls.\n\nHowever, the craft quickly toppled due to imbalance. So Xiao Z consulted his classmate Xiao C. Having read about the principle of balance on a scale in an encyclopedia, Xiao C knows that if, at any piece of clay, the load difference between the two upward tubes exceeds the weight of one ball, the craft will topple. Since the balls are heavy, the weight of the clay and plastic tubes can be ignored.\n\nBecause moving balls takes time to dismantle and fix, Xiao C wants to move as few balls as possible to balance the craft. Can you help her?", "description": "You are given a binary tree whose leaves have weights. Every internal node has exactly two children. Leaf weights are only $0$ or $1$.\n\nYou can perform the following operation any number of times: choose two leaves and swap their weights.\n\nDefine the weight of a subtree as the sum of the weights of all leaves in that subtree.\n\nYou want to make the difference between the weights of the left and right subtrees at every internal node be at most $1$ by using the operation above.\n\nFind the minimum number of operations needed to achieve this.", "inputFormat": "One line containing a string $T$ that describes the tree in a fully parenthesized form. The character `B` denotes a colored ball.\n\n---\n\nFormally, the CFG (context-free grammar) of $T$ is defined as:\n\n```plain\n<T> := (<T><T>) | (B) | ()\n```\n\n| Item | Meaning |\n|:-:|:-:|\n| `(<T><T>)` | An internal node; the two `<T>` are its left and right subtrees. |\n| `(B)` | A leaf node with weight $1$. |\n| `()` | A leaf node with weight $0$. |", "outputFormat": "Output a single integer: the minimum number of operations required, or output `impossible` if it is not achievable.", "hint": "Sample Explanation\n\n![](https://cdn.luogu.com.cn/upload/pic/1259.png)\n\nConstraints\n\nLet $N$ be the length of the string $T$.\n\n- For $15\\%$ of the testdata, $N \\le 25$.\n- For $50\\%$ of the testdata, $N \\le 250$.\n- For $100\\%$ of the testdata, $2 \\le N \\le 5000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "彩球树", "background": "小 Z 是一个聪明的小学生，他用塑料管和橡皮泥搭成了一棵树，每个橡皮泥上都连接着一个向下的塑料管，有的连接着两根向上的塑料管，有的则连接着一些彩球。\n\n然而，这个工艺品很快因为不平衡倒了下来。于是，小 Z 请教了和他在同一个班上的妹子小 C。在百科全书上看到天平平衡原理的小 C 知道，如果任何一块橡皮泥向上连接的两根管子的载重量之差超过一个彩球的重量，工艺品就会不平衡倒下来。由于彩球比较重，橡皮泥和塑料管的重量可以忽略不计。\n\n由于移动彩球需要花时间拆卸和固定，小 C 希望移动最少次数彩球让这个工艺品平衡起来。你能帮助她吗？", "description": "给定一棵叶子带权值二叉树，保证每个非叶子结点都有两个儿子，权值只能是 $0$ 或 $1$。\n\n你可以进行以下操作若干次：选中两个叶子，交换它们的权值。\n\n定义一颗子树的权值为子树内所有叶子的权值之和。\n\n你希望通过以上操作使得任意非叶子结点的左子树权值和右子树权值相差不超过 $1$。\n\n求达成以上目标需要的最少操作次数。", "inputFormat": "一行一个字符串 $T$，以中序遍历的方式描述了这棵树，`B` 表示彩球。\n\n\n---\n\n\n形式化的，$T$ 的 CFG（上下文无关文法）定义为：\n\n```plain\n<T> := (<T><T>) | (B) | ()\n```\n\n\n\n|项目|含义|\n|:-:|:-:|\n|`(<T><T>)`|一个非叶子结点，两个 `<T>` 分别为它的左子树和右子树|\n|`(B)`|一个权值为 $1$ 的叶子结点|\n|`()`|一个权值为 $0$ 的叶子结点|", "outputFormat": "输出一个数字，表示最少移动多少个彩球就能使它平衡，或输出 `impossible`，表示如何移动多少个都无法平衡。\n\n\n---\n\n\n输出一个数字，表示至少需要多少次操作，或输出 `impossible`，表示不可能达成目标。", "hint": "【样例解释】\n\n![](https://cdn.luogu.com.cn/upload/pic/1259.png)\n\n【数据规模】\n\n设 $N$ 为字符串 $T$ 的长度。\n\n对于 $15\\%$ 的数据，$N \\le 25$。\n\n对于 $50\\%$ 的数据，$N \\le 250$。\n\n对于 $100\\%$ 的数据，$2 \\le N \\le 5000$。", "locale": "zh-CN"}}}
{"pid": "P2132", "type": "P", "difficulty": 4, "samples": [["3\n3 2 1", "16"], ["5\n1 1 1 1 1 ", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP"], "title": "小Z的队伍排列", "background": "", "description": "小 Z 想给班里的同学拍一张合影，为此需要先让大家排好队伍。他希望大家站成 $k$ 排，并规定了每排的人数，保证每一排的人数都不多于后面一排的人数。\n\n这时小 Z 发现队伍看起来还是乱糟糟的，原因是大家的身高互不相同。于是，他希望排头对齐，每位同学都比自己正后方的同学以及排头方向的同学矮。\n\n排完以后，善于思考的小 Z 还想知道一共有多少种排法。\n\n例如，大家排成 $3$ 排，且从后往前每排分别是 $3$ 、 $2$ 、 $1$ 人，就有以下 $16$ 种排法（每个数代表将所有同学身高从高到低排序后该同学的排名）：\n\n$$\\begin{matrix}\n123 & 123 & 124 & 124 & 125 & 125 & 126 & 126 & 134 & 134 & 135 & 135 & 136 & 136 & 145 & 146 \\\\\n45 & 46 & 35 & 36 & 34 & 36 & 34 & 35 & 25 & 26 & 24 & 26 & 24 & 25 & 26 & 25 \\\\\n6 & 5 & 6 & 5 & 6 & 4 & 5 & 4 & 6 & 5 & 6 & 4 & 5 & 4 & 3 & 3\n\\end{matrix}$$\n\n可是班里一共有 $n$ 个人，小 Z 算不出来了，希望你帮帮他。", "inputFormat": "第一行包含一个整数 $k$。\n\n第二行包含 $k$ 个整数，表示从后往前每排的人数。\n", "outputFormat": "一行，包含一个整数，表示队伍排列的方案数。\n", "hint": "### 数据范围及约定\n\n对于 $30\\%$ 的数据，$n \\le 10$。\n\n对于另外 $30\\%$ 的数据，只有最后一排超过 $1$ 个人。\n\n对于 $100\\%$ 的数据，$1 \\le k \\le 5$，$1 \\le n \\le 30$，方案数小于 $2^{32}$。", "locale": "zh-CN", "translations": {"en": {"title": "Xiao Z's Team Lineup", "background": "", "description": "Xiao Z wants to take a class photo, so he needs everyone to line up first. He wants them to stand in $k$ rows, and he specifies the number of people in each row, ensuring that each row has no more people than the row behind it.\n\nHe then finds the lineup still looks messy because all heights are different. So he wants the row heads to be aligned (left-justified), and each student must be shorter than both the student directly behind them and the student toward the direction of the row head (if such students exist).\n\nAfter arranging, the thoughtful Xiao Z wants to know how many different lineups there are.\n\nFor example, if everyone stands in $3$ rows, and the row sizes from back to front are $3$, $2$, $1$, there are the following $16$ lineups (each number represents the rank of a student when all students are sorted by height from tallest to shortest):\n\n$$\\begin{matrix}\n123 & 123 & 124 & 124 & 125 & 125 & 126 & 126 & 134 & 134 & 135 & 135 & 136 & 136 & 145 & 146 \\\\\n45 & 46 & 35 & 36 & 34 & 36 & 34 & 35 & 25 & 26 & 24 & 26 & 24 & 25 & 26 & 25 \\\\\n6 & 5 & 6 & 5 & 6 & 4 & 5 & 4 & 6 & 5 & 6 & 4 & 5 & 4 & 3 & 3\n\\end{matrix}$$\n\nHowever, there are $n$ students in the class, and Xiao Z cannot compute it, so he asks you for help.", "inputFormat": "The first line contains an integer $k$.\n\nThe second line contains $k$ integers, giving the number of people in each row from back to front.", "outputFormat": "One line containing an integer, the number of possible lineups.", "hint": "Constraints\n\n- For $30\\%$ of the testdata, $n \\le 10$.\n- For another $30\\%$ of the testdata, only the last row has more than $1$ person.\n- For $100\\%$ of the testdata, $1 \\le k \\le 5$, $1 \\le n \\le 30$, and the number of lineups is less than $2^{32}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小Z的队伍排列", "background": "", "description": "小 Z 想给班里的同学拍一张合影，为此需要先让大家排好队伍。他希望大家站成 $k$ 排，并规定了每排的人数，保证每一排的人数都不多于后面一排的人数。\n\n这时小 Z 发现队伍看起来还是乱糟糟的，原因是大家的身高互不相同。于是，他希望排头对齐，每位同学都比自己正后方的同学以及排头方向的同学矮。\n\n排完以后，善于思考的小 Z 还想知道一共有多少种排法。\n\n例如，大家排成 $3$ 排，且从后往前每排分别是 $3$ 、 $2$ 、 $1$ 人，就有以下 $16$ 种排法（每个数代表将所有同学身高从高到低排序后该同学的排名）：\n\n$$\\begin{matrix}\n123 & 123 & 124 & 124 & 125 & 125 & 126 & 126 & 134 & 134 & 135 & 135 & 136 & 136 & 145 & 146 \\\\\n45 & 46 & 35 & 36 & 34 & 36 & 34 & 35 & 25 & 26 & 24 & 26 & 24 & 25 & 26 & 25 \\\\\n6 & 5 & 6 & 5 & 6 & 4 & 5 & 4 & 6 & 5 & 6 & 4 & 5 & 4 & 3 & 3\n\\end{matrix}$$\n\n可是班里一共有 $n$ 个人，小 Z 算不出来了，希望你帮帮他。", "inputFormat": "第一行包含一个整数 $k$。\n\n第二行包含 $k$ 个整数，表示从后往前每排的人数。\n", "outputFormat": "一行，包含一个整数，表示队伍排列的方案数。\n", "hint": "### 数据范围及约定\n\n对于 $30\\%$ 的数据，$n \\le 10$。\n\n对于另外 $30\\%$ 的数据，只有最后一排超过 $1$ 个人。\n\n对于 $100\\%$ 的数据，$1 \\le k \\le 5$，$1 \\le n \\le 30$，方案数小于 $2^{32}$。", "locale": "zh-CN"}}}
{"pid": "P2133", "type": "P", "difficulty": 4, "samples": [["123654\n123456", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索"], "title": "天作之合", "background": "生活就是一次 A\\*，你是我的第一个目标状态。——小明", "description": "在小明的学校中，有若干个女生。小明认为每个女生的特征可以抽象为一个 $6$ 位的数字串，其中不重复地包含 $1\\sim6$ 这 $6$ 个数码。\n\n在小明心中，有一个理想的女生，她的特征数字串为 $A$。如果串 $Y$ 是串 $X$ 交换两个连续的数码所得，那么我们认为特征数字串 $X$ 和 $Y$ 相似。首先，小明找到了他的同桌，她的特征数字串为 $S$。每次，小明会寻找一个特征数字串和当前串相似的女生，直到寻找到适合他的（即特征数字串和 $A$ 相同或相似的）。定义每个女生的合适程度为找到此人至少需要找女生的数量（包括他的同桌和此人自己）。显然，合适程度数值越小的女生越适合小明。\n\n然而，小明觉得老天不会轻易地让他找到，所以他认为合适程度第二小的才是他最合适的伴侣（也就是小红）。那么，请你帮他写一个程序，求出对于小明，小红的合适程度是多少。", "inputFormat": "第 $1$ 行，一个特征数字串 $A$。\n\n第 $2$ 行，一个特征数字串 $S$。", "outputFormat": "一行，一个非负整数表示小红的合适程度。", "hint": "样例解释：\n\n最短的两个「合适的数字串」分别是 $\\tt 454$ 和 $\\tt 545$，故答案为 $3$。\n\n---\n\n对于全部数据，保证串 $A$ 和 $S$ 合法，且保证能找到。", "locale": "zh-CN", "translations": {"en": {"title": "A Match Made in Heaven", "background": "Life is an A\\*; you are my first goal state. — Xiaoming.", "description": "At Xiaoming’s school, there are several girls. Xiaoming thinks each girl’s traits can be abstracted into a $6$-digit string that contains, without repetition, the digits $1\\sim6$.\n\nIn Xiaoming’s mind, there is an ideal girl whose trait string is $A$. If string $Y$ is obtained from string $X$ by swapping two consecutive digits, then we say that trait strings $X$ and $Y$ are similar. First, Xiaoming finds his deskmate, whose trait string is $S$. Each time, Xiaoming looks for a girl whose trait string is similar to the current string, until he finds one suitable for him (that is, a girl whose trait string is identical to $A$ or similar to $A$). Define each girl’s suitability degree as the minimum number of girls he needs to look for to reach this person (including his deskmate and this person herself). Clearly, the smaller the suitability degree, the more suitable the girl is for Xiaoming.\n\nHowever, Xiaoming feels that fate will not let him find her easily, so he believes that the second smallest suitability degree is actually his best match (that is, Xiaohong). Please write a program to compute Xiaohong’s suitability degree for Xiaoming.", "inputFormat": "The $1$st line: a trait string $A$.\n\nThe $2$nd line: a trait string $S$.", "outputFormat": "One line with a non-negative integer representing Xiaohong’s suitability degree.", "hint": "Sample explanation:\n\nThe two shortest “suitable strings” are $\\tt 454$ and $\\tt 545$, so the answer is $3$.\n\n---\n\nFor all testdata, it is guaranteed that strings $A$ and $S$ are valid, and that a solution exists.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "天作之合", "background": "生活就是一次 A\\*，你是我的第一个目标状态。——小明", "description": "在小明的学校中，有若干个女生。小明认为每个女生的特征可以抽象为一个 $6$ 位的数字串，其中不重复地包含 $1\\sim6$ 这 $6$ 个数码。\n\n在小明心中，有一个理想的女生，她的特征数字串为 $A$。如果串 $Y$ 是串 $X$ 交换两个连续的数码所得，那么我们认为特征数字串 $X$ 和 $Y$ 相似。首先，小明找到了他的同桌，她的特征数字串为 $S$。每次，小明会寻找一个特征数字串和当前串相似的女生，直到寻找到适合他的（即特征数字串和 $A$ 相同或相似的）。定义每个女生的合适程度为找到此人至少需要找女生的数量（包括他的同桌和此人自己）。显然，合适程度数值越小的女生越适合小明。\n\n然而，小明觉得老天不会轻易地让他找到，所以他认为合适程度第二小的才是他最合适的伴侣（也就是小红）。那么，请你帮他写一个程序，求出对于小明，小红的合适程度是多少。", "inputFormat": "第 $1$ 行，一个特征数字串 $A$。\n\n第 $2$ 行，一个特征数字串 $S$。", "outputFormat": "一行，一个非负整数表示小红的合适程度。", "hint": "样例解释：\n\n最短的两个「合适的数字串」分别是 $\\tt 454$ 和 $\\tt 545$，故答案为 $3$。\n\n---\n\n对于全部数据，保证串 $A$ 和 $S$ 合法，且保证能找到。", "locale": "zh-CN"}}}
{"pid": "P2134", "type": "P", "difficulty": 4, "samples": [["6 1 7", "20"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "贪心"], "title": "百日旅行", "background": "> 重要的不是去哪里，而是和你在一起。——小红\n\n对小明和小红来说，$2014$ 年 $7$ 月 $29$ 日是一个美好的日子。这一天是他们相识 $100$ 天的纪念日。\n\n（小明：小红，感谢你 $2$ 场大考时默默的支持，$100$ 个日夜的陪伴；感谢你照亮我 $100$ 个美好的日子，给我留下无数美好的回忆……在这个美好的日子里，我准备带你去旅行。）", "description": "小明和小红还剩下 $n$ 天的假期，小明可以安排旅行的计划。如果连续 $x$ 天旅游，小明需要花旅行费用  $p \\times x \\times x$ 元；如果连续 $x$ 天不旅游，小明需要请小红吃饭，花费为 $q \\times x$ 元（ $p,q$ 都是输入的常数）。\n\n请你帮小明写一个程序，计算出假期里他至少需要花费多少元。", "inputFormat": "输入只有一行，包含三个空格隔开的正整数 $n,p,q$。", "outputFormat": "一行，一个正整数表示小明至少需要花费多少元。", "hint": "#### 数据规模与约定\n\n- 对于 $20\\%$ 数据，$1 \\le n \\le 20$。\n- 对于 $90\\%$ 数据，$1 \\le n \\le 10^3$，$1 \\le p \\le 2 \\times 10^3$，$1 \\le q \\le 10^4$。\n- 对于 $100\\%$ 数据，$1 \\le n \\le 2 \\times 10^5$，$1 \\le p \\le q \\le 10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "Hundred-Day Journey", "background": "> What matters is not where to go, but being with you. — Xiaohong\n\nFor Xiaoming and Xiaohong, $2014$ year $7$ month $29$ day is a beautiful day. This day is the $100$-day anniversary of their acquaintance.\n\n(Xiaoming: Xiaohong, thank you for your silent support during the $2$ major exams and your companionship over $100$ days and nights; thank you for lighting up my $100$ beautiful days and leaving me countless wonderful memories... On this beautiful day, I plan to take you on a trip.)", "description": "Xiaoming and Xiaohong have $n$ days of vacation left, and Xiaoming can plan the trip. If they travel for $x$ consecutive days, Xiaoming needs to spend $p \\times x \\times x$ yuan. If they do not travel for $x$ consecutive days, Xiaoming needs to treat Xiaohong to meals, costing $q \\times x$ yuan ($p, q$ are constants given in the input).\n\nPlease help Xiaoming write a program to compute the minimum total amount he needs to spend during the vacation.", "inputFormat": "The input contains a single line with three space-separated positive integers $n, p, q$.", "outputFormat": "Output one line with a single positive integer, representing the minimum amount of money Xiaoming needs to spend.", "hint": "#### Constraints\n\n- For $20\\%$ of the testdata, $1 \\le n \\le 20$.\n- For $90\\%$ of the testdata, $1 \\le n \\le 10^3$, $1 \\le p \\le 2 \\times 10^3$, $1 \\le q \\le 10^4$.\n- For $100\\%$ of the testdata, $1 \\le n \\le 2 \\times 10^5$, $1 \\le p \\le q \\le 10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "百日旅行", "background": "> 重要的不是去哪里，而是和你在一起。——小红\n\n对小明和小红来说，$2014$ 年 $7$ 月 $29$ 日是一个美好的日子。这一天是他们相识 $100$ 天的纪念日。\n\n（小明：小红，感谢你 $2$ 场大考时默默的支持，$100$ 个日夜的陪伴；感谢你照亮我 $100$ 个美好的日子，给我留下无数美好的回忆……在这个美好的日子里，我准备带你去旅行。）", "description": "小明和小红还剩下 $n$ 天的假期，小明可以安排旅行的计划。如果连续 $x$ 天旅游，小明需要花旅行费用  $p \\times x \\times x$ 元；如果连续 $x$ 天不旅游，小明需要请小红吃饭，花费为 $q \\times x$ 元（ $p,q$ 都是输入的常数）。\n\n请你帮小明写一个程序，计算出假期里他至少需要花费多少元。", "inputFormat": "输入只有一行，包含三个空格隔开的正整数 $n,p,q$。", "outputFormat": "一行，一个正整数表示小明至少需要花费多少元。", "hint": "#### 数据规模与约定\n\n- 对于 $20\\%$ 数据，$1 \\le n \\le 20$。\n- 对于 $90\\%$ 数据，$1 \\le n \\le 10^3$，$1 \\le p \\le 2 \\times 10^3$，$1 \\le q \\le 10^4$。\n- 对于 $100\\%$ 数据，$1 \\le n \\le 2 \\times 10^5$，$1 \\le p \\le q \\le 10^4$。", "locale": "zh-CN"}}}
{"pid": "P2135", "type": "P", "difficulty": 6, "samples": [["4\r\n1 2 3 1\r\n1 3 4 1\r\n", "29\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "区间 DP"], "title": "方块消除", "background": "", "description": "Jimmy 最近迷上了一款叫做方块消除的游戏。游戏规则如下：$n$ 个带颜色方格排成一列，相同颜色的方块连成一个区域（如果两个相邻方块颜色相同，则这两个方块属于同一区域）。为简化题目，将连起来的同一颜色方块的数目用一个数表示。\n\n例如，`9 122233331` 表示为\n\n```plain\n4\n1 2 3 1\n1 3 4 1\n```\n\n游戏时，你可以任选一个区域消去。设这个区域包含的方块数为 $x$，则将得到 $x^2$ 个分值。方块消去之后，其余的方块就会竖直落到底部或其他方块上。而且当有一列方块被完全消去时，其右边的所有方块就会向左移一格。Jimmy 希望你能找出得最高分的最佳方案，你能帮助他吗？\n", "inputFormat": "第一行包含一个整数 $m$（$1 \\le m \\le 50$），表示同颜色方块区域的数目。  \n第二行包含 $m$ 个数，表示每个区域的颜色（$1$ 到 $m$ 之间的整数）。  \n第三行包含 $m$ 个数，表示每个区域包含的方块数（$1$ 到 $20$ 之间的整数）。", "outputFormat": "仅一个整数，即最高可能得分。\n", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "Block Elimination", "background": "", "description": "Jimmy has recently become obsessed with a game called Block Elimination. The rules are as follows: $n$ colored blocks are arranged in a row. Blocks of the same color that are contiguous form a region (if two adjacent blocks have the same color, then these two blocks belong to the same region). To simplify the problem, we represent the number of blocks in each contiguous region of the same color by a single number.\n\nFor example, `9 122233331` is represented as\n\n```plain\n4\n1 2 3 1\n1 3 4 1\n```\n\nDuring the game, you may choose any one region to remove. Suppose this region contains $x$ blocks; then you gain $x^2$ points. After removing a region, the remaining blocks close up from both sides to fill the gap. If blocks of the same color become adjacent due to this, they merge into a new single region. Jimmy wants to find the best strategy to achieve the highest score. Can you help him?", "inputFormat": "The first line contains an integer $m$ ($1 \\le m \\le 50$), the number of regions of the same color.  \nThe second line contains $m$ integers, the color of each region (integers between 1 and $m$).  \nThe third line contains $m$ integers, the number of blocks in each region (integers between 1 and 20).", "outputFormat": "Output a single integer: the highest possible score.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "方块消除", "background": "", "description": "Jimmy 最近迷上了一款叫做方块消除的游戏。游戏规则如下：$n$ 个带颜色方格排成一列，相同颜色的方块连成一个区域（如果两个相邻方块颜色相同，则这两个方块属于同一区域）。为简化题目，将连起来的同一颜色方块的数目用一个数表示。\n\n例如，`9 122233331` 表示为\n\n```plain\n4\n1 2 3 1\n1 3 4 1\n```\n\n游戏时，你可以任选一个区域消去。设这个区域包含的方块数为 $x$，则将得到 $x^2$ 个分值。方块消去之后，其余的方块就会竖直落到底部或其他方块上。而且当有一列方块被完全消去时，其右边的所有方块就会向左移一格。Jimmy 希望你能找出得最高分的最佳方案，你能帮助他吗？\n", "inputFormat": "第一行包含一个整数 $m$（$1 \\le m \\le 50$），表示同颜色方块区域的数目。  \n第二行包含 $m$ 个数，表示每个区域的颜色（$1$ 到 $m$ 之间的整数）。  \n第三行包含 $m$ 个数，表示每个区域包含的方块数（$1$ 到 $20$ 之间的整数）。", "outputFormat": "仅一个整数，即最高可能得分。\n", "hint": "", "locale": "zh-CN"}}}
{"pid": "P2136", "type": "P", "difficulty": 4, "samples": [["3 3\n1 2 3\n2 3 -1\n3 1 -10", "-2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["图论", "枚举", "负权环"], "title": "拉近距离", "background": "我是源点，你是终点。我们之间有负权环。 ——小明", "description": "在小明和小红的生活中，有 $N$ 个关键的节点。有 $M$ 个事件，记为一个三元组 $(S_i,T_i,W_i)$，表示从节点 $S_i$ 有一个事件可以转移到 $T_i$，事件的效果就是使他们之间的距离减少 $W_i$。\n\n这些节点构成了一个网络，其中节点 $1$ 和 $N$ 是特殊的，节点 $1$ 代表小明，节点 $N$ 代表小红，其他代表进展的阶段。所有事件可以自由选择是否进行，但每次只能进行当前节点邻接的。请你帮他们写一个程序，计算出他们之间可能的最短距离。", "inputFormat": "第一行，两个正整数 $N,M$。\n\n之后 $M$ 行，每行 $3$ 个空格隔开的整数 $S_i,T_i,W_i$。", "outputFormat": "一行，一个整数表示他们之间可能的最短距离。如果这个距离可以无限缩小，输出``Forever love``。", "hint": "对于 $20\\%$ 数据，$N \\le 10$，$M \\le 50$。\n\n对于 $50\\%$ 数据，$N \\le 300$，$M \\le 5000$。\n\n对于 $100\\%$ 数据，$1\\le N \\le 10^3$，$1\\le M \\le 10^4$，$|W_i|\\le 100$，保证从节点 $1$ 到 $2 \\dots N$ 有路径，从节点 $N$ 到 $1 \\dots N - 1$ 有路径。", "locale": "zh-CN", "translations": {"en": {"title": "Closing the Distance", "background": "I am the source, and you are the destination. There is a negative-weight cycle between us. — Xiao Ming.", "description": "In the lives of Xiao Ming and Xiao Hong, there are $N$ key nodes. There are $M$ events, denoted as a triplet $(S_i, T_i, W_i)$, meaning that from node $S_i$ there is an event that can move to $T_i$, and the effect of the event is to reduce the distance between them by $W_i$.\n\nThese nodes form a network, in which nodes $1$ and $N$ are special: node $1$ represents Xiao Ming, node $N$ represents Xiao Hong, and the others represent stages of progress. You may freely choose whether to perform each event, but at any step you may only perform an event that is outgoing from the current node. Please write a program to compute the shortest possible distance between them.", "inputFormat": "The first line contains two positive integers $N, M$.\n\nThen follow $M$ lines, each containing $3$ space-separated integers $S_i, T_i, W_i$.", "outputFormat": "Output one line with a single integer representing the shortest possible distance between them. If this distance can be decreased without bound, output ``Forever love``.", "hint": "For $20\\%$ of the testdata, $N \\le 10$, $M \\le 50$.\n\nFor $50\\%$ of the testdata, $N \\le 300$, $M \\le 5000$.\n\nFor $100\\%$ of the testdata, $1 \\le N \\le 10^3$, $1 \\le M \\le 10^4$, $|W_i| \\le 100$. It is guaranteed that there is a path from node $1$ to every node $2 \\dots N$, and from node $N$ to every node $1 \\dots N - 1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "拉近距离", "background": "我是源点，你是终点。我们之间有负权环。 ——小明", "description": "在小明和小红的生活中，有 $N$ 个关键的节点。有 $M$ 个事件，记为一个三元组 $(S_i,T_i,W_i)$，表示从节点 $S_i$ 有一个事件可以转移到 $T_i$，事件的效果就是使他们之间的距离减少 $W_i$。\n\n这些节点构成了一个网络，其中节点 $1$ 和 $N$ 是特殊的，节点 $1$ 代表小明，节点 $N$ 代表小红，其他代表进展的阶段。所有事件可以自由选择是否进行，但每次只能进行当前节点邻接的。请你帮他们写一个程序，计算出他们之间可能的最短距离。", "inputFormat": "第一行，两个正整数 $N,M$。\n\n之后 $M$ 行，每行 $3$ 个空格隔开的整数 $S_i,T_i,W_i$。", "outputFormat": "一行，一个整数表示他们之间可能的最短距离。如果这个距离可以无限缩小，输出``Forever love``。", "hint": "对于 $20\\%$ 数据，$N \\le 10$，$M \\le 50$。\n\n对于 $50\\%$ 数据，$N \\le 300$，$M \\le 5000$。\n\n对于 $100\\%$ 数据，$1\\le N \\le 10^3$，$1\\le M \\le 10^4$，$|W_i|\\le 100$，保证从节点 $1$ 到 $2 \\dots N$ 有路径，从节点 $N$ 到 $1 \\dots N - 1$ 有路径。", "locale": "zh-CN"}}}
{"pid": "P2137", "type": "P", "difficulty": 6, "samples": [["2\n1 2\n10 20\n1\n0 1 5\n", "2\n"], ["2\n1 2\n10 20\n1\n0 1 10\n", "1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["分块"], "title": "Gty的妹子树", "background": "我曾在弦歌之中听过你，\n\n\n檀板声碎，半出折子戏。\n\n\n舞榭歌台被风吹去，\n\n\n岁月深处尚有余音一缕……\n\n\n\nGty 神(xian)犇(chong)从来不缺妹子……\n\n\n他来到了一棵妹子树下，发现每个妹子有一个美丽度……\n\n\n由于Gty很哲♂学，他只对美丽度大于某个值的妹子感兴趣。\n\n\n他想知道某个子树中美丽度大于 $k$ 的妹子个数。\n\n\n某个妹子的美丽度可能发生变化……\n\n\n树上可能会出现一只新的妹子……\n", "description": "维护一棵初始有 $n$ 个节点的有根树（根节点为 $1$），树上节点编号为 $1 \\sim n$，每个点有一个权值 $w_i$。\n\n\n支持以下操作：\n\n- `0 u x` 询问以 $u$ 为根的子树中，严格大于 $x$ 的值的个数。\n\n- `1 u x`  把 $u$ 节点的权值改成 $x$。\n\n- `2 u x`  添加一个编号为“当前树中节点数+1”的节点，其父节点为 $u$，其权值为 $x$。\n\n**本题强制在线。**   \n所有输入的 $u,x$ 都需要异或 $\\text{last}$ 才是真正的输入。   \n其中 $\\text{last}$ 为上一次询问的答案，定义初始 $\\text{last} = 0$。", "inputFormat": "第一行一个正整数 $n$，表示初始节点数。 \n\n接下来 $n-1$ 行，每行两个整数 $u,v$，为树上的一条无向边。\n\n接下来一行 $n$ 个整数 $w_i$，表示初始时每个节点的权值。\n\n接着一行一个正整数 $m$，表示操作个数。\n\n接下来 $m$ 行，每行三个整数 $\\text{op},u,x$，表示一次操作。\n", "outputFormat": "对每个 $\\text{op}=0$ 的操作，输出一行，包括一个整数，意义见题目描述。\n", "hint": "【数据范围】  \n对于 $100\\%$ 的数据，$1\\le n,m \\le 30000$，$1\\le u \\le n$，$0 \\le w_i,x < 2^{31}$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Gty's Girl Tree", "background": "I once heard you amid the strings and songs.\n\nThe clapboard's sound shatters, half like a scene from an opera.\n\nDance pavilions and singing stages are blown away by the wind.\n\nDeep in the years, a wisp of lingering echo remains...\n\nGty shen (xian) ben (chong) has never lacked girls...\n\nHe came under a \"girl tree\" and found that each girl has a beauty value...\n\nBecause Gty is very philosophical, he is only interested in girls whose beauty value is greater than a certain number.\n\nHe wants to know how many girls in some subtree have beauty value greater than $k$.\n\nA girl's beauty value may change...\n\nA new girl may appear on the tree...", "description": "Maintain a rooted tree with $n$ nodes initially (the root is $1$), with node labels $1 \\sim n$, and each node has a weight $w_i$.\n\nSupport the following operations:\n- `0 u x` Query the number of values strictly greater than $x$ in the subtree rooted at $u$.\n- `1 u x` Set the weight of node $u$ to $x$.\n- `2 u x` Add a node whose index is \"current number of nodes in the tree + 1\", with parent $u$ and weight $x$.\n\nThis problem is strictly online.  \nAll input $u, x$ must be XORed with $\\text{last}$ to obtain the actual input.  \nHere $\\text{last}$ is the answer to the previous query, with initial $\\text{last} = 0$.", "inputFormat": "The first line contains a positive integer $n$, the initial number of nodes.\n\nThe next $n-1$ lines each contain two integers $u, v$, representing an undirected edge in the tree.\n\nThe next line contains $n$ integers $w_i$, the initial weight of each node.\n\nThe next line contains a positive integer $m$, the number of operations.\n\nThe next $m$ lines each contain three integers $\\text{op}, u, x$, describing one operation.", "outputFormat": "For each operation with $\\text{op} = 0$, output one line containing an integer, as described above.", "hint": "Constraints  \nFor $100\\%$ of the testdata, $1 \\le n, m \\le 30000$, $1 \\le u \\le n$, $0 \\le w_i, x < 2^{31}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Gty的妹子树", "background": "我曾在弦歌之中听过你，\n\n\n檀板声碎，半出折子戏。\n\n\n舞榭歌台被风吹去，\n\n\n岁月深处尚有余音一缕……\n\n\n\nGty 神(xian)犇(chong)从来不缺妹子……\n\n\n他来到了一棵妹子树下，发现每个妹子有一个美丽度……\n\n\n由于Gty很哲♂学，他只对美丽度大于某个值的妹子感兴趣。\n\n\n他想知道某个子树中美丽度大于 $k$ 的妹子个数。\n\n\n某个妹子的美丽度可能发生变化……\n\n\n树上可能会出现一只新的妹子……\n", "description": "维护一棵初始有 $n$ 个节点的有根树（根节点为 $1$），树上节点编号为 $1 \\sim n$，每个点有一个权值 $w_i$。\n\n\n支持以下操作：\n\n- `0 u x` 询问以 $u$ 为根的子树中，严格大于 $x$ 的值的个数。\n\n- `1 u x`  把 $u$ 节点的权值改成 $x$。\n\n- `2 u x`  添加一个编号为“当前树中节点数+1”的节点，其父节点为 $u$，其权值为 $x$。\n\n**本题强制在线。**   \n所有输入的 $u,x$ 都需要异或 $\\text{last}$ 才是真正的输入。   \n其中 $\\text{last}$ 为上一次询问的答案，定义初始 $\\text{last} = 0$。", "inputFormat": "第一行一个正整数 $n$，表示初始节点数。 \n\n接下来 $n-1$ 行，每行两个整数 $u,v$，为树上的一条无向边。\n\n接下来一行 $n$ 个整数 $w_i$，表示初始时每个节点的权值。\n\n接着一行一个正整数 $m$，表示操作个数。\n\n接下来 $m$ 行，每行三个整数 $\\text{op},u,x$，表示一次操作。\n", "outputFormat": "对每个 $\\text{op}=0$ 的操作，输出一行，包括一个整数，意义见题目描述。\n", "hint": "【数据范围】  \n对于 $100\\%$ 的数据，$1\\le n,m \\le 30000$，$1\\le u \\le n$，$0 \\le w_i,x < 2^{31}$。\n", "locale": "zh-CN"}}}
{"pid": "P2138", "type": "P", "difficulty": 3, "samples": [["abcdef\naxcyd", "1"], ["a\nb", "2"], ["abb\nbaa", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "字符串", "动态规划 DP"], "title": "小Z的关系距离", "background": "", "description": "小 Z 学习了辩证唯物主义，知道了联系具有普遍性。他看着草稿纸上的字符串，就想挖掘它们之间的关系。\n\n小 Z 认为，对于两个字符串 $a,b$，如果它们各自删除不超过其自身长度一半的字符能够相等，则称 $a,b$ 有距离为 $1$ 的关系。而如果存在另一个字符串 $c$，它和 $a$ 有距离为 $1$ 的关系，和 $b$ 有距离为 $n$ 的关系，则称 $a,b$ 有距离为 $n + 1$ 的关系。\n\n现在小 Z 随机挑选出了两个小写字母字符串 $a,b$，想知道它们之间关系的最小距离，希望你帮帮他。", "inputFormat": "第一行包含一个字符串 $a$。\n\n第二行包含一个字符串 $b$。", "outputFormat": "第一行包含一个整数，表示 $a,b$ 之间关系的最小距离。\n", "hint": "对于 $30\\%$ 的数据，$a,b$ 由同一字母构成。\n\n对于 $100\\%$ 的数据，$1 \\leq |a|,|b| \\leq 100$。", "locale": "zh-CN", "translations": {"en": {"title": "Xiao Z's Relationship Distance", "background": "", "description": "Xiao Z has studied dialectical materialism and learned that connections are universal. Looking at the strings on his scratch paper, he wants to explore the relationships between them.\n\nXiao Z believes that for two strings $a,b$, if each can delete no more than half of its own length of characters to become equal, then $a,b$ are said to have a relationship with distance $1$. If there exists another string $c$ that has a distance of $1$ with $a$ and a distance of $n$ with $b$, then $a,b$ are said to have a relationship with distance $n + 1$.\n\nNow Xiao Z randomly selects two lowercase letter strings $a,b$ and wants to know the minimal relationship distance between them. Please help him.", "inputFormat": "The first line contains a string $a$.\n\nThe second line contains a string $b$.", "outputFormat": "The first line contains an integer indicating the minimal relationship distance between $a,b$.", "hint": "For $30\\%$ of the testdata, $a,b$ are composed of the same letter.\n\nFor $100\\%$ of the testdata, $1 \\leq |a|,|b| \\leq 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小Z的关系距离", "background": "", "description": "小 Z 学习了辩证唯物主义，知道了联系具有普遍性。他看着草稿纸上的字符串，就想挖掘它们之间的关系。\n\n小 Z 认为，对于两个字符串 $a,b$，如果它们各自删除不超过其自身长度一半的字符能够相等，则称 $a,b$ 有距离为 $1$ 的关系。而如果存在另一个字符串 $c$，它和 $a$ 有距离为 $1$ 的关系，和 $b$ 有距离为 $n$ 的关系，则称 $a,b$ 有距离为 $n + 1$ 的关系。\n\n现在小 Z 随机挑选出了两个小写字母字符串 $a,b$，想知道它们之间关系的最小距离，希望你帮帮他。", "inputFormat": "第一行包含一个字符串 $a$。\n\n第二行包含一个字符串 $b$。", "outputFormat": "第一行包含一个整数，表示 $a,b$ 之间关系的最小距离。\n", "hint": "对于 $30\\%$ 的数据，$a,b$ 由同一字母构成。\n\n对于 $100\\%$ 的数据，$1 \\leq |a|,|b| \\leq 100$。", "locale": "zh-CN"}}}
{"pid": "P2139", "type": "P", "difficulty": 5, "samples": [["4\n6 4\n6 4\n6 4\n6 4\n1\n2 1\n", "0 1 1 0 0 1\n0 1 0 0 0 0"]], "limits": {"time": [1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000]}, "tags": ["模拟"], "title": "小Z的掷骰游戏", "background": "", "description": "小 Z 得到了一种奇特的骰子（如下图所示），想要用它进行掷骰游戏。\n\n![](https://cdn.luogu.com.cn/upload/pic/1263.png)\n\n游戏很简单，小 Z 每次都从同样的位置将一个骰子竖直抛下，当骰子落到平面或另一个骰子上时停下来。然而，由于这是一种奇特的骰子，它还会继续翻滚和下落。这种骰子有以下特性：\n\n- 普通骰子可能往四个方向翻滚，而这种骰子只能往 $4,5,6$ 这三个面的方向翻滚。在下图所示的情况中，这种骰子只能往两个方向翻滚；\n\n![](https://cdn.luogu.com.cn/upload/pic/1264.png)\n\n- 这种骰子只有在翻滚后会导致其下落时才会翻滚（如下图所示），当有多个方向可以翻滚时，它会往数字最大的面的方向翻滚；\n\n![](https://cdn.luogu.com.cn/upload/pic/1265.png)\n\n- 这种骰子翻滚恰好 $90^\\circ$ 后会竖直下落，当落到平面或另一个骰子上时停下来（如下图中的 $B$ 和 $C$ 所示），然后继续翻滚和下落的过程。\n\n![](https://cdn.luogu.com.cn/upload/pic/1266.png)\n\n上图就是将 $4$ 个骰子均以上面是 $6$ 前面是 $4$ 的状态依次抛下的过程。\n\n现在小 Z 抛了 $n$ 个骰子，他想知道游戏结束后从上面看每个数字分别出现了多少次（如下图所示），希望你帮帮他。\n\n![](https://cdn.luogu.com.cn/upload/pic/1267.png)", "inputFormat": "每次多组数据，每组数据格式如下：\n\n第 $1$ 行，一个整数 $n$，表示抛了 $n$ 个骰子；\n\n第 $2\\sim n+1$ 行，每行包含两个整数 $t,f$，表示一个骰子以上面是 $t$ 前面是 $f$ 的状态抛下。", "outputFormat": "对于每组数据，输出一行，每行包含六个整数，表示游戏结束后从上面看每个数字分别出现的次数。\n", "hint": "本题有 $4$ 个点，每个点 $25$ 分。\n\n对于 $25\\%$ 的数据，$n=1$。\n\n对于另外 $25\\%$ 的数据，$n=2$。\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 100$，不超过 $30$ 组数据。", "locale": "zh-CN", "translations": {"en": {"title": "Xiao Z's Dice-Throwing Game", "background": "", "description": "Xiao Z obtained a peculiar die (as shown below) and wants to play a dice game with it.\n\n![](https://cdn.luogu.com.cn/upload/pic/1263.png)\n\nThe game is simple: each time, Xiao Z drops one die vertically from the same position. The die stops when it lands on the plane or on top of another die. However, because this is a special die, it will continue to roll and fall. This die has the following properties:\n\n- A normal die might roll in four directions, but this die can only roll toward the faces numbered $4, 5, 6$. In the situation shown below, this die can only roll in two directions.\n\n![](https://cdn.luogu.com.cn/upload/pic/1264.png)\n\n- This die rolls only if rolling will cause it to descend (as shown below). When there are multiple directions available, it rolls toward the direction with the largest face number.\n\n![](https://cdn.luogu.com.cn/upload/pic/1265.png)\n\n- After rolling exactly $90^\\circ$, the die falls vertically. When it lands on the plane or on another die (as $B$ and $C$ in the figure below), it stops, and then continues the process of rolling and falling.\n\n![](https://cdn.luogu.com.cn/upload/pic/1266.png)\n\nThe figure above shows the process of dropping $4$ dice in sequence, each initially with top face $6$ and front face $4$.\n\nNow Xiao Z has dropped $n$ dice. He wants to know, after the game ends, how many times each number appears on the top when viewed from above (as shown below). Please help him.\n\n![](https://cdn.luogu.com.cn/upload/pic/1267.png)", "inputFormat": "There are multiple test cases. Each test case is formatted as follows:\n\n- Line $1$: an integer $n$, the number of dice dropped.\n- Lines $2$ to $n+1$: each line contains two integers $t, f$, meaning one die is dropped with top face $t$ and front face $f$.", "outputFormat": "For each test case, output one line containing six integers, representing how many times each number appears on the top after the game ends, when viewed from above.", "hint": "This problem has $4$ test points, each worth $25$ points.\n\nFor $25\\%$ of the testdata, $n = 1$.\n\nFor another $25\\%$ of the testdata, $n = 2$.\n\nFor $100\\%$ of the testdata, $1 \\leq n \\leq 100$, and there are at most $30$ test cases.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小Z的掷骰游戏", "background": "", "description": "小 Z 得到了一种奇特的骰子（如下图所示），想要用它进行掷骰游戏。\n\n![](https://cdn.luogu.com.cn/upload/pic/1263.png)\n\n游戏很简单，小 Z 每次都从同样的位置将一个骰子竖直抛下，当骰子落到平面或另一个骰子上时停下来。然而，由于这是一种奇特的骰子，它还会继续翻滚和下落。这种骰子有以下特性：\n\n- 普通骰子可能往四个方向翻滚，而这种骰子只能往 $4,5,6$ 这三个面的方向翻滚。在下图所示的情况中，这种骰子只能往两个方向翻滚；\n\n![](https://cdn.luogu.com.cn/upload/pic/1264.png)\n\n- 这种骰子只有在翻滚后会导致其下落时才会翻滚（如下图所示），当有多个方向可以翻滚时，它会往数字最大的面的方向翻滚；\n\n![](https://cdn.luogu.com.cn/upload/pic/1265.png)\n\n- 这种骰子翻滚恰好 $90^\\circ$ 后会竖直下落，当落到平面或另一个骰子上时停下来（如下图中的 $B$ 和 $C$ 所示），然后继续翻滚和下落的过程。\n\n![](https://cdn.luogu.com.cn/upload/pic/1266.png)\n\n上图就是将 $4$ 个骰子均以上面是 $6$ 前面是 $4$ 的状态依次抛下的过程。\n\n现在小 Z 抛了 $n$ 个骰子，他想知道游戏结束后从上面看每个数字分别出现了多少次（如下图所示），希望你帮帮他。\n\n![](https://cdn.luogu.com.cn/upload/pic/1267.png)", "inputFormat": "每次多组数据，每组数据格式如下：\n\n第 $1$ 行，一个整数 $n$，表示抛了 $n$ 个骰子；\n\n第 $2\\sim n+1$ 行，每行包含两个整数 $t,f$，表示一个骰子以上面是 $t$ 前面是 $f$ 的状态抛下。", "outputFormat": "对于每组数据，输出一行，每行包含六个整数，表示游戏结束后从上面看每个数字分别出现的次数。\n", "hint": "本题有 $4$ 个点，每个点 $25$ 分。\n\n对于 $25\\%$ 的数据，$n=1$。\n\n对于另外 $25\\%$ 的数据，$n=2$。\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 100$，不超过 $30$ 组数据。", "locale": "zh-CN"}}}
{"pid": "P2140", "type": "P", "difficulty": 4, "samples": [["3 3 33\n4 4 2\n2 9 6\n6 5 3", "4 1"], ["3 4 15\n1 2 1 2\n2 1 2 1\n1 2 1 2", "6 0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP"], "title": "小Z的电力管制", "background": "", "description": "小 Z 在供电公司找到了一份工作，刚上班就遇到了一个棘手的任务。\n\n小 Z 所在的城市可以看成一个 $n \\times m$ 的网格，第 $i$ 行第 $j$ 列的格子有电力需求 $a_{i,j}$ 。然而，供电公司能够供应的电力 $u$ 小于每格的电力需求之和。为此，供电公司不得不将城市划分成若干个区域，每个区域轮流断电，使得断电后剩余区域的电力需求之和不超过供电公司能够供应的电力。\n\n为了方便起见，划分区域的方式很简单，每次将大区域横向或纵向划分成两个小区域，递归进行。\n\n供电公司想尽可能减少市民的不满，因此需要小 Z 计算出最多能划分成多少个区域以及在此前提下能够剩余的最多电力（一种划分的剩余电力为每次断电后剩余电力的最小值），希望你帮帮他。\n\n\n", "inputFormat": "第一行包含三个整数 $n ,m ,u$ 。\n\n接下来 $n$ 行，每行包含 $m$ 个整数，第 $i$ 行第 $j$ 个整数为 $a_{i,j}$，含义见题目描述。", "outputFormat": "共一行，包含两个整数，分别表示最多能划分成的区域数和在此前提下能够剩余的最多电力。\n", "hint": "对于 $60\\%$ 的数据，$1\\leq n ,m \\leq 10$ 。\n\n对于 $100\\%$ 的数据， $1 \\leq n,m \\leq 32,1 \\leq a_{i,j} \\leq 100$ 。", "locale": "zh-CN", "translations": {"en": {"title": "Xiao Z's Power Control", "background": "", "description": "Xiao Z found a job at a power supply company and immediately encountered a tricky task.\n\nThe city where Xiao Z works can be modeled as an $n \\times m$ grid. The cell in row $i$ and column $j$ has a power demand $a_{i,j}$. However, the available supply $u$ from the company is less than the sum of the demands of all cells. Therefore, the company has to partition the city into several regions and rotate power outages across these regions, so that after cutting power to any one region, the sum of the demands of the remaining regions does not exceed the available supply.\n\nFor convenience, the partitioning is performed as follows: at each step, a (rectangular) region is split horizontally or vertically into two smaller (rectangular) regions, recursively.\n\nTo minimize public dissatisfaction, the company asks Xiao Z to compute:\n- the maximum possible number of regions, and\n- subject to achieving that maximum number of regions, the maximum possible remaining power, where for a given partition, its remaining power is defined as the minimum, over all outages, of $u$ minus the total demand of the regions that remain powered.", "inputFormat": "The first line contains three integers $n, m, u$.\n\nThe next $n$ lines each contain $m$ integers. On the $i$-th line, the $j$-th integer is $a_{i,j}$, as defined above.", "outputFormat": "Output one line containing two integers: the maximum number of regions and, subject to that, the maximum remaining power.", "hint": "Constraints:\n- For $60\\%$ of the testdata, $1 \\leq n, m \\leq 10$.\n- For $100\\%$ of the testdata, $1 \\leq n, m \\leq 32$, $1 \\leq a_{i,j} \\leq 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小Z的电力管制", "background": "", "description": "小 Z 在供电公司找到了一份工作，刚上班就遇到了一个棘手的任务。\n\n小 Z 所在的城市可以看成一个 $n \\times m$ 的网格，第 $i$ 行第 $j$ 列的格子有电力需求 $a_{i,j}$ 。然而，供电公司能够供应的电力 $u$ 小于每格的电力需求之和。为此，供电公司不得不将城市划分成若干个区域，每个区域轮流断电，使得断电后剩余区域的电力需求之和不超过供电公司能够供应的电力。\n\n为了方便起见，划分区域的方式很简单，每次将大区域横向或纵向划分成两个小区域，递归进行。\n\n供电公司想尽可能减少市民的不满，因此需要小 Z 计算出最多能划分成多少个区域以及在此前提下能够剩余的最多电力（一种划分的剩余电力为每次断电后剩余电力的最小值），希望你帮帮他。\n\n\n", "inputFormat": "第一行包含三个整数 $n ,m ,u$ 。\n\n接下来 $n$ 行，每行包含 $m$ 个整数，第 $i$ 行第 $j$ 个整数为 $a_{i,j}$，含义见题目描述。", "outputFormat": "共一行，包含两个整数，分别表示最多能划分成的区域数和在此前提下能够剩余的最多电力。\n", "hint": "对于 $60\\%$ 的数据，$1\\leq n ,m \\leq 10$ 。\n\n对于 $100\\%$ 的数据， $1 \\leq n,m \\leq 32,1 \\leq a_{i,j} \\leq 100$ 。", "locale": "zh-CN"}}}
{"pid": "P2141", "type": "P", "difficulty": 2, "samples": [["4\n1 2 3 4", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "2014", "NOIP 普及组", "枚举"], "title": "[NOIP 2014 普及组] 珠心算测验", "background": "NOIP2014 普及 T1", "description": "珠心算是一种通过在脑中模拟算盘变化来完成快速运算的一种计算技术。珠心算训练，既能够开发智力，又能够为日常生活带来很多便利，因而在很多学校得到普及。\n\n\n某学校的珠心算老师采用一种快速考察珠心算加法能力的测验方法。他随机生成一个正整数集合，集合中的数各不相同，然后要求学生回答：其中有多少个数，恰好等于集合中另外两个（不同的）数之和？\n\n\n最近老师出了一些测验题，请你帮忙求出答案。\n", "inputFormat": "共两行，第一行包含一个整数 $n$，表示测试题中给出的正整数个数。\n\n\n第二行有 $n$ 个正整数，每两个正整数之间用一个空格隔开，表示测试题中给出的正整数。\n", "outputFormat": "一个整数，表示测验题答案。\n", "hint": "【样例说明】\n\n\n由 $1+2=3,1+3=4$，故满足测试要求的答案为 $2$。  \n\n注意，加数和被加数必须是集合中的两个不同的数。\n\n\n【数据说明】\n\n\n对于 $100\\%$ 的数据，$3 \\leq n \\leq 100$，测验题给出的正整数大小不超过 $10,000$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[NOIP 2014 Junior] Mental Abacus Test", "background": "NOIP 2014 Junior T1.", "description": "Mental abacus is a calculation technique that performs fast computation by simulating abacus operations in the mind. Training in mental abacus can both develop intelligence and bring convenience to daily life, so it has become popular in many schools.\n\nA mental abacus teacher at a certain school uses a quick test method to assess addition skills. He randomly generates a set of positive integers, all distinct, and asks the students: how many numbers in the set are exactly equal to the sum of two other (different) numbers from the same set?\n\nRecently, the teacher prepared some test questions. Please help compute the answers.", "inputFormat": "There are two lines. The first line contains an integer $n$, the number of positive integers in the test.\n\nThe second line contains $n$ positive integers separated by single spaces, representing the given positive integers in the test.", "outputFormat": "Output a single integer, which is the answer to the test.", "hint": "[Sample Explanation]\n\nFrom $1+2=3,1+3=4$, so the number of values that meet the requirement is $2$.\n\nNote that the addends and the sum must be three numbers from the set, and the two addends must be different.\n\n[Constraints]\n\nFor $100\\%$ of the testdata, $3 \\leq n \\leq 100$, and each given positive integer does not exceed $10{,}000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOIP 2014 普及组] 珠心算测验", "background": "NOIP2014 普及 T1", "description": "珠心算是一种通过在脑中模拟算盘变化来完成快速运算的一种计算技术。珠心算训练，既能够开发智力，又能够为日常生活带来很多便利，因而在很多学校得到普及。\n\n\n某学校的珠心算老师采用一种快速考察珠心算加法能力的测验方法。他随机生成一个正整数集合，集合中的数各不相同，然后要求学生回答：其中有多少个数，恰好等于集合中另外两个（不同的）数之和？\n\n\n最近老师出了一些测验题，请你帮忙求出答案。\n", "inputFormat": "共两行，第一行包含一个整数 $n$，表示测试题中给出的正整数个数。\n\n\n第二行有 $n$ 个正整数，每两个正整数之间用一个空格隔开，表示测试题中给出的正整数。\n", "outputFormat": "一个整数，表示测验题答案。\n", "hint": "【样例说明】\n\n\n由 $1+2=3,1+3=4$，故满足测试要求的答案为 $2$。  \n\n注意，加数和被加数必须是集合中的两个不同的数。\n\n\n【数据说明】\n\n\n对于 $100\\%$ 的数据，$3 \\leq n \\leq 100$，测验题给出的正整数大小不超过 $10,000$。\n", "locale": "zh-CN"}}}
{"pid": "P2142", "type": "P", "difficulty": 2, "samples": [["2\n1", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "字符串", "高精度", "洛谷原创"], "title": "高精度减法", "background": "", "description": "给定两个正整数 $a,b$，求 $a-b$ 的值。", "inputFormat": "输入共两行，每行一个正整数，分别为 $a,b$。", "outputFormat": "输出一行一个整数，表示 $a-b$ 的值。\n\n如果 $a-b<0$，**请输出负号**。", "hint": "对于 $20\\%$ 的数据，$a,b$ 在`long long`类型的存储范围内；  \n对于 $100\\%$ 的数据，$0<a,b\\le 10^{10086}$。", "locale": "zh-CN", "translations": {"en": {"title": "High-Precision Subtraction", "background": "", "description": "High-precision subtraction.", "inputFormat": "Two integers $a,b$ (the second one may be larger than the first one).", "outputFormat": "The result (output a minus sign if it is negative).", "hint": "- $20\\%$ of the testdata: $a,b$ are within the range of long long.\n- $100\\%$ of the testdata: $0<a,b\\le 10^{10086}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "高精度减法", "background": "", "description": "给定两个正整数 $a,b$，求 $a-b$ 的值。", "inputFormat": "输入共两行，每行一个正整数，分别为 $a,b$。", "outputFormat": "输出一行一个整数，表示 $a-b$ 的值。\n\n如果 $a-b<0$，**请输出负号**。", "hint": "对于 $20\\%$ 的数据，$a,b$ 在`long long`类型的存储范围内；  \n对于 $100\\%$ 的数据，$0<a,b\\le 10^{10086}$。", "locale": "zh-CN"}}}
{"pid": "P2143", "type": "P", "difficulty": 6, "samples": [["4 6\r\n1 2 1\r\n1 3 1\r\n1 4 1\r\n2 3 2\r\n2 4 1\r\n3 4 1\r\n", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2010", "各省省选", "矩阵树定理", "江苏"], "title": "[JSOI2010] 巨额奖金", "background": "", "description": " NJ 市的快速发展得益于其便捷的交通。可是，随着经济的发展，大量的人进入 NJ 市， NJ 市的交通也承受着巨大的压力。现在， NJ 市正在筹划建设一个新型的交通枢纽，从而减轻交通的压力。\n\n NJ 市包含 $n$ 个区，有些区之间有双向的干道存在。新型交通枢纽建设在这些干道的基础上，将其中的部分干道改进为新型干道。改进后，干道能承受的压力可以比原来增加几十倍。为了和谐发展，在新型的交通枢纽建成后，要求任何两个区之间都可以只通过新型干道（直接或间接地）连接。政府已经预测出每条干道改进为新型干道的费用。政府希望建设新型交通枢纽的总费用最小，并以巨额奖金向市民征集方案。政府很快发现费用最小的方案不一定唯一，所以决定将奖金平分给每一种方案的第一个设计者，即如果一个人设计的费用是最小的而且前面没人和他设计出一模一样的方案，则他可获奖。\n\n Js08 被奖金深深的吸引，准备设计一种方案。可是，他发现方案可能会很多，如果最后获奖者太多，巨额的资金分到每个人头上的也不会太多。所以他决定先算一下可行的方案数是多少。\n", "inputFormat": "输入共 $m + 1$ 行。\n\n输入的第一行包含两个数 $n, m$，分别表示该市有多少个区和有多少条干道。\n\n接下来 $m$ 行，每行三个数 $a_i$、$b_i$、$c_i$，表示 $a_i$ 区和 $b_i$ 区之间有一条干道，如果改进需要 $c_i$ 的费用。", "outputFormat": "输出费用最小的方案有多少种。由于答案可能很大，你只要输出方案数除以 $31011$ 的模即可。", "hint": "### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 100$，$1 \\leq m \\leq 1000$，$1 \\leq a _ i, b _ i \\leq n$，$1 \\leq c _ i \\leq 10 ^ 9$。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2010] Massive Bonus", "background": "", "description": "The rapid development of NJ City benefits from its convenient transportation. However, as the economy grows, many people move into NJ City, and its transportation comes under heavy pressure. Now, NJ City is planning to build a new transportation hub to ease the pressure.\n\nNJ City contains $n$ districts, and some pairs of districts are connected by bidirectional trunk roads. The new transportation hub will be built on top of these trunk roads by upgrading some of them into new-type trunk roads. After the upgrade, a trunk road can bear dozens of times more pressure than before. For balanced development, once the new transportation hub is completed, any two districts must be connected using only new-type trunk roads (directly or indirectly). The government has estimated the cost of upgrading each trunk road into a new-type trunk road. It wants to minimize the total cost of building the new hub and solicits plans from citizens with a massive bonus. The government soon realized that minimum-cost plans may not be unique, so it will divide the bonus equally among the first proposer of each distinct plan; that is, if someone proposes a plan with minimum cost and nobody before them proposed exactly the same plan, they will receive a share.\n\nJs08 is deeply attracted by the bonus and prepares to design a plan. However, he finds there may be many plans, and if there are too many winners, the share for each person will not be much. So he decides to first compute how many feasible plans there are.", "inputFormat": "The input has $m + 1$ lines.\n\nThe first line contains two numbers $n, m$, representing how many districts the city has and how many trunk roads there are.\n\nThe next $m$ lines each contain three numbers $a _ i$, $b _ i$, $c _ i$, indicating that there is a trunk road between district $a _ i$ and district $b _ i$, and upgrading it costs $c _ i$.", "outputFormat": "Output how many minimum-cost plans there are. Since the answer may be large, output the number modulo $31011$.", "hint": "Constraints\n\nFor $100\\%$ of the testdata, it is guaranteed that $1 \\leq n \\leq 100$, $1 \\leq m \\leq 1000$, $1 \\leq a _ i, b _ i \\leq n$, $1 \\leq c _ i \\leq 10 ^ 9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2010] 巨额奖金", "background": "", "description": " NJ 市的快速发展得益于其便捷的交通。可是，随着经济的发展，大量的人进入 NJ 市， NJ 市的交通也承受着巨大的压力。现在， NJ 市正在筹划建设一个新型的交通枢纽，从而减轻交通的压力。\n\n NJ 市包含 $n$ 个区，有些区之间有双向的干道存在。新型交通枢纽建设在这些干道的基础上，将其中的部分干道改进为新型干道。改进后，干道能承受的压力可以比原来增加几十倍。为了和谐发展，在新型的交通枢纽建成后，要求任何两个区之间都可以只通过新型干道（直接或间接地）连接。政府已经预测出每条干道改进为新型干道的费用。政府希望建设新型交通枢纽的总费用最小，并以巨额奖金向市民征集方案。政府很快发现费用最小的方案不一定唯一，所以决定将奖金平分给每一种方案的第一个设计者，即如果一个人设计的费用是最小的而且前面没人和他设计出一模一样的方案，则他可获奖。\n\n Js08 被奖金深深的吸引，准备设计一种方案。可是，他发现方案可能会很多，如果最后获奖者太多，巨额的资金分到每个人头上的也不会太多。所以他决定先算一下可行的方案数是多少。\n", "inputFormat": "输入共 $m + 1$ 行。\n\n输入的第一行包含两个数 $n, m$，分别表示该市有多少个区和有多少条干道。\n\n接下来 $m$ 行，每行三个数 $a_i$、$b_i$、$c_i$，表示 $a_i$ 区和 $b_i$ 区之间有一条干道，如果改进需要 $c_i$ 的费用。", "outputFormat": "输出费用最小的方案有多少种。由于答案可能很大，你只要输出方案数除以 $31011$ 的模即可。", "hint": "### 数据规模与约定\n\n对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 100$，$1 \\leq m \\leq 1000$，$1 \\leq a _ i, b _ i \\leq n$，$1 \\leq c _ i \\leq 10 ^ 9$。", "locale": "zh-CN"}}}
{"pid": "P2144", "type": "P", "difficulty": 6, "samples": [["3\n", "16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "高精度", "递推", "2007", "各省省选", "福建"], "title": "[FJOI2007] 轮状病毒", "background": "", "description": "轮状病毒有很多变种。许多轮状病毒都是由一个轮状基产生。一个 $n$ 轮状基由圆环上 $n$ 个不同的基原子和圆心的一个核原子构成。$2$ 个原子之间的边表示这 $2$ 个原子之间的信息通道，如图 1 所示。\n\n$n$ 轮状病毒的产生规律是在 $n$ 轮状基中删除若干边，使各原子之间有唯一一条信息通道。例如，共有 $16$ 个不同的 $3$ 轮状病毒，如图 2 所示。\n\n给定 $n\\ (n\\le100)$，编程计算有多少个不同的 $n$ 轮状病毒。\n\n![](https://cdn.luogu.com.cn/upload/pic/1408.png)\n", "inputFormat": "第一行有 $1$ 个正整数 $n$。\n", "outputFormat": "共 $1$ 行，表示不同的 $n$ 轮状病毒数。\n", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[FJOI2007] Rotavirus", "background": "", "description": "There are many variants of rotaviruses. Many rotaviruses are generated from a wheel base. An $n$-wheel base consists of $n$ distinct base atoms on a circular ring and one core atom at the center. An edge between $2$ atoms represents the information channel between these $2$ atoms, as shown in Figure 1.\n\nThe generation rule of an $n$-rotavirus is to delete some edges in the $n$-wheel base so that there is a unique information path between any two atoms. For example, there are $16$ different $3$-rotaviruses, as shown in Figure 2.\n\nGiven $n\\ (n \\le 100)$, write a program to compute how many different $n$-rotaviruses there are.\n\n![](https://cdn.luogu.com.cn/upload/pic/1408.png)", "inputFormat": "The first line contains $1$ positive integer $n$.", "outputFormat": "Output $1$ line, the number of different $n$-rotaviruses.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[FJOI2007] 轮状病毒", "background": "", "description": "轮状病毒有很多变种。许多轮状病毒都是由一个轮状基产生。一个 $n$ 轮状基由圆环上 $n$ 个不同的基原子和圆心的一个核原子构成。$2$ 个原子之间的边表示这 $2$ 个原子之间的信息通道，如图 1 所示。\n\n$n$ 轮状病毒的产生规律是在 $n$ 轮状基中删除若干边，使各原子之间有唯一一条信息通道。例如，共有 $16$ 个不同的 $3$ 轮状病毒，如图 2 所示。\n\n给定 $n\\ (n\\le100)$，编程计算有多少个不同的 $n$ 轮状病毒。\n\n![](https://cdn.luogu.com.cn/upload/pic/1408.png)\n", "inputFormat": "第一行有 $1$ 个正整数 $n$。\n", "outputFormat": "共 $1$ 行，表示不同的 $n$ 轮状病毒数。\n", "hint": "", "locale": "zh-CN"}}}
{"pid": "P2145", "type": "P", "difficulty": 7, "samples": [["9\n1 1 2 2 3 3 2 1 1", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "2007", "各省省选", "江苏", "区间 DP"], "title": "[JSOI2007] 祖玛", "background": "管理员备注：本题可能是错题。\n\n2025.1.27 update：现在本题存在多项式解，但仍然无法在原数据范围下通过（UOJ941）。", "description": "这是一个流行在 Jsoi 的游戏，名称为祖玛。\n\n精致细腻的背景，外加神秘的印加音乐衬托，彷佛置身在古老的国度里面，进行一个神秘的游戏——这就是著名的祖玛游戏。祖玛游戏的主角是一只石青蛙，石青蛙会吐出各种颜色的珠子，珠子造型美丽，并且有着神秘的色彩。\n\n环绕着石青蛙的是载着珠子的轨道，各种颜色的珠子会沿着轨道往前滑动，石青蛙必需遏止珠子们滚进去轨道终点的洞里头，如何减少珠子呢？就得要靠石青蛙吐出的珠子与轨道上的珠子相结合，颜色相同者即可以消失得分！直到轨道上的珠子通通都被清干净为止。 或许你并不了解祖玛游戏。没关系。这里我们介绍一个简单版本的祖玛游戏规则。一条通道中有一些玻璃珠，每个珠子有各自的颜色，如图 1 所示。玩家可以做的是选择一种颜色的珠子（注意：颜色可以任选，这与真实游戏是不同的）射入某个位置。\n\n ![](https://cdn.luogu.com.cn/upload/pic/1446.png) \n\n图 2 中玩家选择一颗蓝色珠子，射入图示的位置，于是得到一个图 3 的局面。\n\n当玩家射入一颗珠子后，如果射入的珠子与其他珠子组成了三颗以上连续相同颜色的珠子，这些珠子就会消失。例如，将一颗白色珠子射入图 4 中的位置，就会产生三颗颜色相同的白色珠子。这三颗珠子就会消失，于是得到图 5 的局面。\n\n需要注意的一点是，图 4 中的三颗连续的黄色珠子不会消失，因为并没有珠子射入其中。 珠子的消失还会产生连锁反应。当一串连续相同颜色的珠子消失后，如果消失位置左右的珠子颜色相同，并且长度大于 2，则可以继续消失。例如，图 6 中，射入一颗红色珠子后，产生了三颗连续的红色珠子。当红色珠子消失后，它左右都是白色的珠子，并且一共有四颗，于是白色珠子也消失了。之后，消失位置的左右都是蓝色珠子，共有三颗，于是蓝色珠子也消失。最终得到图 7 的状态。注意，图 7 中的三颗黄色珠子不会消失，因为蓝色珠子消失的位置一边是紫色珠子，另一边是黄色珠子，颜色不同。\n\n除了上述的情况，没有其他的方法可以消去珠子。现在，我们有一排珠子，需要你去消除。对于每一轮，你可以自由选择不同颜色的珠子，射入任意的位置。你的任务是射出最少的珠子，将全部珠子消去。\n", "inputFormat": "第一行一个整数 $n(n \\le 500)$，表示珠子的个数 第二行 $n$ 个整数（32 位整数范围内），用空格分割，每个整数表示一种颜色的珠子。\n", "outputFormat": "一个整数，表示最少需要射出的珠子个数。\n", "hint": "\n\n------------\n2024/2/13 添加 2 组 hack 数据。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2007] Zuma", "background": "Admin note: This problem may be flawed.\n\n2025-01-27 update: A polynomial-time solution now exists, but it still cannot pass under the original constraints (UOJ941).", "description": "This is a game popular in JSOI, called Zuma.\n\nWith its delicate visuals and mysterious Inca-style music, Zuma feels like a mystical game set in an ancient land. The protagonist is a stone frog that spits colored beads. The beads are beautifully shaped and have mysterious colors.\n\nAround the stone frog is a track carrying beads of different colors that slide forward along the track. The stone frog must stop the beads from rolling into the hole at the end of the track. How can we reduce the beads? By letting the bead shot by the frog combine with the beads on the track: if the colors match, they disappear and score points! The goal is to clear all the beads on the track. If you are not familiar with Zuma, that is fine. Here we introduce a simplified version of the rules. There is a row of glass beads in a channel, each with its own color, as shown in Figure 1. The player can choose a bead of any color (note: the color can be chosen freely; this differs from the real game) and shoot it into any position.\n\n![](https://cdn.luogu.com.cn/upload/pic/1446.png)\n\nIn Figure 2, the player chooses a blue bead and shoots it into the indicated position, resulting in the situation in Figure 3.\n\nAfter a bead is shot, if the inserted bead forms a sequence of three or more consecutive beads of the same color, those beads disappear. For example, inserting a white bead at the position in Figure 4 creates three consecutive white beads. These three beads then disappear, leading to the situation in Figure 5.\n\nNote that the three consecutive yellow beads in Figure 4 do not disappear because no bead was inserted into them. Disappearance can trigger chain reactions. When a run of identical-colored beads disappears, if the beads immediately to the left and right of the vanished segment are of the same color and their combined length is greater than 2, they also disappear. For example, in Figure 6, after inserting a red bead, three consecutive red beads are formed. When the red beads disappear, both sides are white beads, four in total, so the white beads disappear as well. Afterwards, both sides are blue beads, three in total, so the blue beads also disappear. The final state is shown in Figure 7. Note that the three yellow beads in Figure 7 do not disappear because on the two sides of where the blue beads vanished there are purple beads on one side and yellow beads on the other, which are different colors.\n\nOther than the situations described above, there is no other way to eliminate beads. Now, given a row of beads, you need to clear them. On each move, you may freely choose the color of the bead and insert it at any position. Your task is to shoot the fewest number of beads to remove all beads.", "inputFormat": "The first line contains an integer $n(n \\le 500)$, the number of beads.  \nThe second line contains $n$ integers (within the 32-bit integer range), separated by spaces; each integer represents the color of a bead.", "outputFormat": "Output a single integer: the minimum number of beads that must be shot.", "hint": "------------  \n2024/2/13: Added 2 sets of hack testdata.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2007] 祖玛", "background": "管理员备注：本题可能是错题。\n\n2025.1.27 update：现在本题存在多项式解，但仍然无法在原数据范围下通过（UOJ941）。", "description": "这是一个流行在 Jsoi 的游戏，名称为祖玛。\n\n精致细腻的背景，外加神秘的印加音乐衬托，彷佛置身在古老的国度里面，进行一个神秘的游戏——这就是著名的祖玛游戏。祖玛游戏的主角是一只石青蛙，石青蛙会吐出各种颜色的珠子，珠子造型美丽，并且有着神秘的色彩。\n\n环绕着石青蛙的是载着珠子的轨道，各种颜色的珠子会沿着轨道往前滑动，石青蛙必需遏止珠子们滚进去轨道终点的洞里头，如何减少珠子呢？就得要靠石青蛙吐出的珠子与轨道上的珠子相结合，颜色相同者即可以消失得分！直到轨道上的珠子通通都被清干净为止。 或许你并不了解祖玛游戏。没关系。这里我们介绍一个简单版本的祖玛游戏规则。一条通道中有一些玻璃珠，每个珠子有各自的颜色，如图 1 所示。玩家可以做的是选择一种颜色的珠子（注意：颜色可以任选，这与真实游戏是不同的）射入某个位置。\n\n ![](https://cdn.luogu.com.cn/upload/pic/1446.png) \n\n图 2 中玩家选择一颗蓝色珠子，射入图示的位置，于是得到一个图 3 的局面。\n\n当玩家射入一颗珠子后，如果射入的珠子与其他珠子组成了三颗以上连续相同颜色的珠子，这些珠子就会消失。例如，将一颗白色珠子射入图 4 中的位置，就会产生三颗颜色相同的白色珠子。这三颗珠子就会消失，于是得到图 5 的局面。\n\n需要注意的一点是，图 4 中的三颗连续的黄色珠子不会消失，因为并没有珠子射入其中。 珠子的消失还会产生连锁反应。当一串连续相同颜色的珠子消失后，如果消失位置左右的珠子颜色相同，并且长度大于 2，则可以继续消失。例如，图 6 中，射入一颗红色珠子后，产生了三颗连续的红色珠子。当红色珠子消失后，它左右都是白色的珠子，并且一共有四颗，于是白色珠子也消失了。之后，消失位置的左右都是蓝色珠子，共有三颗，于是蓝色珠子也消失。最终得到图 7 的状态。注意，图 7 中的三颗黄色珠子不会消失，因为蓝色珠子消失的位置一边是紫色珠子，另一边是黄色珠子，颜色不同。\n\n除了上述的情况，没有其他的方法可以消去珠子。现在，我们有一排珠子，需要你去消除。对于每一轮，你可以自由选择不同颜色的珠子，射入任意的位置。你的任务是射出最少的珠子，将全部珠子消去。\n", "inputFormat": "第一行一个整数 $n(n \\le 500)$，表示珠子的个数 第二行 $n$ 个整数（32 位整数范围内），用空格分割，每个整数表示一种颜色的珠子。\n", "outputFormat": "一个整数，表示最少需要射出的珠子个数。\n", "hint": "\n\n------------\n2024/2/13 添加 2 组 hack 数据。", "locale": "zh-CN"}}}
