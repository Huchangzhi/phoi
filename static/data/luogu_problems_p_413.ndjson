{"pid": "P9378", "type": "P", "difficulty": 5, "samples": [["3 1\n1\n1 2 3\n", "1 3\n"], ["3 1\n1\n2 3 1\n", "2 1\n"], ["6 2\n1 3\n3 2 4 5 6 1\n5 4 1 3 6 2\n", "1 4 5 2\n"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["贪心", "二分", "2023", "Special Judge", "O2优化", "THUPC"], "title": "[THUPC 2023 决赛] 物理实验", "background": "", "description": "为了验证新提出的猜想，物理学家小 I 需要完成 $n$ 种物理实验，其中第 $i(1 \\le i \\le n)$ 种实验的重要度是 $2^{-i}$。每种实验仅需要完成一次。小 I 一次只能做一种实验，且在开始了一个实验之后，不能做到一半去做另一个实验，也就是说在没有任何其他限制的情况下，小 I 完成实验的顺序可以用一个 $1$ 到 $n$ 的排列表示。\n\n然而事情并非一帆风顺。有 $m$ 轮宇宙射线，分别会在小 I 完成了 $a_1$ 种、$a_2$ 种、$\\dots$、$a_m$ 种（**注意，不是第 $a_i$ 种**）实验后轰击实验基地，保证 $1 \\le a_1 < a_2 < \\dots < a_m < n-m$。因此小 I 需要仔细地安排实验的顺序。\n\n第 $j(1 \\le j \\le m)$ 轮宇宙射线会恰好干扰一种实验的实验仪器，其干扰的实验种类按照以下方式确定：\n\n- 给出一个 $1$ 至 $n$ 的排列 $p_{j,1},\\dots,p_{j,n}$，其中 $i$ 越靠前表示第 $i$ 种实验对这轮宇宙射线越脆弱。**每轮给出的排列不一定相同。**\n- 那么在这轮宇宙射线轰击实验基地时，目前所有**未完成且未被干扰**的实验中最脆弱的一种会被干扰，之后无法进行对应实验。\n\n在以上条件下，小 I 总共可以完成 $(n-m)$ 种实验。小 I 希望它们的重要度总和尽可能大，可是小 I 是物理学家不懂算法，所以小 I 请教于你。你需要给出合理的实验顺序，使得完成的 $(n-m)$ 种实验均未被宇宙射线干扰且重要度总和尽可能大。", "inputFormat": "输入的第一行包含两个正整数 $n,m$，表示实验种数和宇宙射线轮数。\n\n接下来一行 $m$ 个整数 $a_1,a_2,\\dots,a_m$，表示每轮宇宙射线在完成了多少种实验后轰击实验基地。\n\n接下来 $m$ 行，每行 $n$ 个整数 $p_1,p_2,\\dots,p_n$，依次描述每轮宇宙射线的脆弱程度排序。保证 $1 \\le p_i \\le n$ 且每行的输入均构成 $1$ 到 $n$ 的排列。", "outputFormat": "输出一行 $n-m$ 个整数，表示你给出的实验顺序。你需要保证做每种实验时这种实验没有被宇宙射线干扰，且重要度总和最大。如果有多种方案，输出任意一种即可。", "hint": "**【样例解释 #1】**\n\n小 I 第一次完成第一种实验后，宇宙射线将会轰击第二种实验的仪器，因此第二次只能完成第三种实验。容易证明该方案达到最大重要度。\n\n**【样例解释 #2】**\n\n在这个样例中，如果小 I 第一次完成第一种实验，那么宇宙射线将会轰击第二种实验的仪器，导致第二次只能完成第三种实验。此时重要度为 $0.625$，而样例输出给出的方案重要度为 $0.75$。\n\n**【样例解释 #3】**\n\n该组样例有多个合法的输出，如 `5 4 1 2` 也是一个合法的答案。\n\n**【数据范围】**\n\n对于所有测试数据，$3 \\le n \\le 600$，$1 \\le m \\le \\lfloor \\frac{n-1}{2} \\rfloor$，$1 \\le a_1 < a_2 < \\dots < a_m < n-m$。\n\n**【题目来源】**\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 [https://github.com/THUSAAC/THUPC2023](https://github.com/THUSAAC/THUPC2023) 查看。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2023 决赛] 物理实验", "background": "", "description": "为了验证新提出的猜想，物理学家小 I 需要完成 $n$ 种物理实验，其中第 $i(1 \\le i \\le n)$ 种实验的重要度是 $2^{-i}$。每种实验仅需要完成一次。小 I 一次只能做一种实验，且在开始了一个实验之后，不能做到一半去做另一个实验，也就是说在没有任何其他限制的情况下，小 I 完成实验的顺序可以用一个 $1$ 到 $n$ 的排列表示。\n\n然而事情并非一帆风顺。有 $m$ 轮宇宙射线，分别会在小 I 完成了 $a_1$ 种、$a_2$ 种、$\\dots$、$a_m$ 种（**注意，不是第 $a_i$ 种**）实验后轰击实验基地，保证 $1 \\le a_1 < a_2 < \\dots < a_m < n-m$。因此小 I 需要仔细地安排实验的顺序。\n\n第 $j(1 \\le j \\le m)$ 轮宇宙射线会恰好干扰一种实验的实验仪器，其干扰的实验种类按照以下方式确定：\n\n- 给出一个 $1$ 至 $n$ 的排列 $p_{j,1},\\dots,p_{j,n}$，其中 $i$ 越靠前表示第 $i$ 种实验对这轮宇宙射线越脆弱。**每轮给出的排列不一定相同。**\n- 那么在这轮宇宙射线轰击实验基地时，目前所有**未完成且未被干扰**的实验中最脆弱的一种会被干扰，之后无法进行对应实验。\n\n在以上条件下，小 I 总共可以完成 $(n-m)$ 种实验。小 I 希望它们的重要度总和尽可能大，可是小 I 是物理学家不懂算法，所以小 I 请教于你。你需要给出合理的实验顺序，使得完成的 $(n-m)$ 种实验均未被宇宙射线干扰且重要度总和尽可能大。", "inputFormat": "输入的第一行包含两个正整数 $n,m$，表示实验种数和宇宙射线轮数。\n\n接下来一行 $m$ 个整数 $a_1,a_2,\\dots,a_m$，表示每轮宇宙射线在完成了多少种实验后轰击实验基地。\n\n接下来 $m$ 行，每行 $n$ 个整数 $p_1,p_2,\\dots,p_n$，依次描述每轮宇宙射线的脆弱程度排序。保证 $1 \\le p_i \\le n$ 且每行的输入均构成 $1$ 到 $n$ 的排列。", "outputFormat": "输出一行 $n-m$ 个整数，表示你给出的实验顺序。你需要保证做每种实验时这种实验没有被宇宙射线干扰，且重要度总和最大。如果有多种方案，输出任意一种即可。", "hint": "**【样例解释 #1】**\n\n小 I 第一次完成第一种实验后，宇宙射线将会轰击第二种实验的仪器，因此第二次只能完成第三种实验。容易证明该方案达到最大重要度。\n\n**【样例解释 #2】**\n\n在这个样例中，如果小 I 第一次完成第一种实验，那么宇宙射线将会轰击第二种实验的仪器，导致第二次只能完成第三种实验。此时重要度为 $0.625$，而样例输出给出的方案重要度为 $0.75$。\n\n**【样例解释 #3】**\n\n该组样例有多个合法的输出，如 `5 4 1 2` 也是一个合法的答案。\n\n**【数据范围】**\n\n对于所有测试数据，$3 \\le n \\le 600$，$1 \\le m \\le \\lfloor \\frac{n-1}{2} \\rfloor$，$1 \\le a_1 < a_2 < \\dots < a_m < n-m$。\n\n**【题目来源】**\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 [https://github.com/THUSAAC/THUPC2023](https://github.com/THUSAAC/THUPC2023) 查看。", "locale": "zh-CN"}}}
{"pid": "P9379", "type": "P", "difficulty": 6, "samples": [["4\n1 2\n5000\n0\n1\n2 3\n1 10000\n00\n01\n10\n1 1\n1\n1\n3 4\n8888 7777 5555\n000\n010\n101\n110\n", "2\n2\n10000\n1\n10000\n0\n209031157\n194428714\n835313860\n674719626\n"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2023", "O2优化", "期望", "THUPC", "状压 DP"], "title": "[THUPC 2023 决赛] 老虎机", "background": "", "description": "小 I 经营着一个电玩城，最近引进的新型老虎机深受欢迎。\n\n作为经营者，小 I 首先需要设定老虎机的状态。老虎机的状态为一个三元组 $(l,S,\\mathbf{p})$，其中\n\n- $l$ 是一个正整数；\n- $S$ 是一个非空字符串集合，其中所有的字符串均是长度为 $l$ 的 01 串；\n- $\\mathbf{p}$ 是一个长度为 $l$ 的实数序列 $p_0,p_1,\\dots,p_{l-1}$，其中对于任意 $0 \\le i \\le l - 1$，$0 < p_i \\le 1$。\n\n设定好状态后即可开始游戏。每一轮游戏的流程如下：\n\n- 玩家首先获得老虎机的状态 $(l,S,\\mathbf{p})$。\n- 老虎机内部选择一个串 $s \\in S$ 作为答案串，玩家需要通过与老虎机进行若干次交互得到答案串。\n  - 每一次交互中，玩家投入一个游戏币并拉下老虎机的拉杆，然后老虎机的界面中会出现一个长度为 $l$ 的信息串 $t$。对于 $0 \\le i \\le l - 1$，$t_i$ 有 $p_i$ 的概率为 $s_i$，有 $(1-p_i)$ 的概率为 `?`。\n  - 交互过程中生成信息串进行的所有随机过程两两独立。\n- 当玩家可以根据**老虎机的状态和交互得到的若干信息串**唯一确定答案串后，即可将答案串输入老虎机并结束游戏、获得奖励。\n\n小 I 设定好了一个状态，但还不知道设定多少奖励。为了让奖励和难度匹配，小 I 想知道：对于 $S$ 中的每个串 $t$，在玩家以最优策略游玩（即一旦可以唯一确定答案串就结束游戏）的情况下，若答案串为 $t$，玩家期望需要投入多少游戏币。\n\n由于小 I 不喜欢实数，你需要将答案对 $998244353$ 取模。", "inputFormat": "**本题有多组测试数据。** 第一行一个整数 $T$ 表示测试数据组数，接下来依次输入每组测试数据。\n\n对于每组测试数据，\n\n- 第一行两个整数 $l,n$，表示字符串长度和 $S$ 的大小。\n- 第二行 $l$ 个整数 $c_0,c_1,\\dots,c_{l-1}$，其中 $p_i = \\frac{c_i}{10^4}$。\n- 接下来 $n$ 行，第 $i$ 行一个长度为 $l$ 的 01 串 $s_i$，描述 $S$ 中的一个字符串。", "outputFormat": "对于每组测试数据输出 $n$ 行，第 $i$ 行表示答案串为 $s_i$ 时，在最优策略下玩家期望投入多少游戏币，对 $998244353$ 取模，题目保证这个值总是在模意义下存在。", "hint": "**【样例解释 #1】**\n\n- 对于第一组测试数据，每一次交互有 $\\frac{5000}{10000} = \\frac{1}{2}$ 的概率知道答案串是 $0$ 还是 $1$，有 $\\frac{1}{2}$ 的概率不能获得信息，因此期望游戏币数为 $\\sum_{i=1}^{+\\infty} \\frac{i}{2^i} = 2$。\n- 对于第二组测试数据，每一次交互都可以得到字符串的第二位，有 $\\frac{1}{10000}$ 的概率得到字符串的第一位。第二个字符串为答案串时可以通过字符串的第二位唯一确定，而其他两个字符串为答案串时必须要得到字符串的第一位。\n- 对于第三组测试数据，由于 $|S| = 1$，所以不需要任何交互就可以确定答案串。\n- 对于第四组测试数据，我有一个绝妙的解释，可这里空间太小写不下。\n\n**【数据范围】**\n\n对于所有测试数据，$1 \\le T \\le 10$，$1 \\le l \\le 15$，$1 \\le n \\le 2^l$，$1 \\le c_i \\le 10^4$，$s_1,\\dots,s_n$ 为两两不同的长度为 $l$ 的 01 串。\n\n**【后记】**\n\n“喂喂喂，未成年人不准进入电玩城！什么？你们说你们要进去学算法竞赛？谁信你的鬼话！”\n\n**【题目来源】**\n\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 [https://github.com/THUSAAC/THUPC2023](https://github.com/THUSAAC/THUPC2023) 查看。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2023 决赛] 老虎机", "background": "", "description": "小 I 经营着一个电玩城，最近引进的新型老虎机深受欢迎。\n\n作为经营者，小 I 首先需要设定老虎机的状态。老虎机的状态为一个三元组 $(l,S,\\mathbf{p})$，其中\n\n- $l$ 是一个正整数；\n- $S$ 是一个非空字符串集合，其中所有的字符串均是长度为 $l$ 的 01 串；\n- $\\mathbf{p}$ 是一个长度为 $l$ 的实数序列 $p_0,p_1,\\dots,p_{l-1}$，其中对于任意 $0 \\le i \\le l - 1$，$0 < p_i \\le 1$。\n\n设定好状态后即可开始游戏。每一轮游戏的流程如下：\n\n- 玩家首先获得老虎机的状态 $(l,S,\\mathbf{p})$。\n- 老虎机内部选择一个串 $s \\in S$ 作为答案串，玩家需要通过与老虎机进行若干次交互得到答案串。\n  - 每一次交互中，玩家投入一个游戏币并拉下老虎机的拉杆，然后老虎机的界面中会出现一个长度为 $l$ 的信息串 $t$。对于 $0 \\le i \\le l - 1$，$t_i$ 有 $p_i$ 的概率为 $s_i$，有 $(1-p_i)$ 的概率为 `?`。\n  - 交互过程中生成信息串进行的所有随机过程两两独立。\n- 当玩家可以根据**老虎机的状态和交互得到的若干信息串**唯一确定答案串后，即可将答案串输入老虎机并结束游戏、获得奖励。\n\n小 I 设定好了一个状态，但还不知道设定多少奖励。为了让奖励和难度匹配，小 I 想知道：对于 $S$ 中的每个串 $t$，在玩家以最优策略游玩（即一旦可以唯一确定答案串就结束游戏）的情况下，若答案串为 $t$，玩家期望需要投入多少游戏币。\n\n由于小 I 不喜欢实数，你需要将答案对 $998244353$ 取模。", "inputFormat": "**本题有多组测试数据。** 第一行一个整数 $T$ 表示测试数据组数，接下来依次输入每组测试数据。\n\n对于每组测试数据，\n\n- 第一行两个整数 $l,n$，表示字符串长度和 $S$ 的大小。\n- 第二行 $l$ 个整数 $c_0,c_1,\\dots,c_{l-1}$，其中 $p_i = \\frac{c_i}{10^4}$。\n- 接下来 $n$ 行，第 $i$ 行一个长度为 $l$ 的 01 串 $s_i$，描述 $S$ 中的一个字符串。", "outputFormat": "对于每组测试数据输出 $n$ 行，第 $i$ 行表示答案串为 $s_i$ 时，在最优策略下玩家期望投入多少游戏币，对 $998244353$ 取模，题目保证这个值总是在模意义下存在。", "hint": "**【样例解释 #1】**\n\n- 对于第一组测试数据，每一次交互有 $\\frac{5000}{10000} = \\frac{1}{2}$ 的概率知道答案串是 $0$ 还是 $1$，有 $\\frac{1}{2}$ 的概率不能获得信息，因此期望游戏币数为 $\\sum_{i=1}^{+\\infty} \\frac{i}{2^i} = 2$。\n- 对于第二组测试数据，每一次交互都可以得到字符串的第二位，有 $\\frac{1}{10000}$ 的概率得到字符串的第一位。第二个字符串为答案串时可以通过字符串的第二位唯一确定，而其他两个字符串为答案串时必须要得到字符串的第一位。\n- 对于第三组测试数据，由于 $|S| = 1$，所以不需要任何交互就可以确定答案串。\n- 对于第四组测试数据，我有一个绝妙的解释，可这里空间太小写不下。\n\n**【数据范围】**\n\n对于所有测试数据，$1 \\le T \\le 10$，$1 \\le l \\le 15$，$1 \\le n \\le 2^l$，$1 \\le c_i \\le 10^4$，$s_1,\\dots,s_n$ 为两两不同的长度为 $l$ 的 01 串。\n\n**【后记】**\n\n“喂喂喂，未成年人不准进入电玩城！什么？你们说你们要进去学算法竞赛？谁信你的鬼话！”\n\n**【题目来源】**\n\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 [https://github.com/THUSAAC/THUPC2023](https://github.com/THUSAAC/THUPC2023) 查看。", "locale": "zh-CN"}}}
{"pid": "P9380", "type": "P", "difficulty": 4, "samples": [["3\n0.166667\n0.333333\n0.500000\n", "6\n"], ["7\n0.041096\n0.109589\n0.109589\n0.164384\n0.301370\n0.068493\n0.205479\n", "73\n"], ["13\n0.00155\n0.03876\n0.01584\n0.05189\n0.08099\n0.06825\n0.15658\n0.10404\n0.02640\n0.14332\n0.12941\n0.15529\n0.02768\n", "7766\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "2023", "O2优化", "枚举", "THUPC"], "title": "[THUPC 2023 决赛] 总投票数", "background": "各位亲爱的《La Lumière: Scarlet Intense Flame - Adventurous Scarlet -》玩家：\n\n非常荣幸能与您携手度过了这四年的美好时光，衷心感谢大家的支持与陪伴！\n\n现在，我们非常遗憾的宣布，《La Lumière: Scarlet Intense Flame - Adventurous Scarlet -》将于 2023 年 5 月 28 日 15:00 停止运营服务。\n\n停止运营相关时间表如下：\n\n……", "description": "在关服前，运营发起了一系列投票，调查哪些游戏内容给玩家带来了更深的印象。\n\n作为系列的忠实玩家，你想知道有多少人参加了关服前的投票，但是运营只公开了最终的投票结果：对于一项包含 $N$ 个选项的投票，选择第 $i$ 个选项的玩家比例为 $P_i$（$1\\le i\\le N$）。运营在公布结果时进行了四舍五入，所有的 $P_i$ 仅保留到小数点后第 $L$ 位。假设实际有 $K$ 位玩家参加了投票，其中有 $D_i$ 位玩家选择了第 $i$ 个选项，则应该有\n\n$$\nP_i-\\frac{1}{2}\\times 10^{-L}\\le\\frac{D_i}{K}< P_i+\\frac{1}{2}\\times 10^{-L}\n$$\n\n显然，所有的 $D_i$ 必须是非负整数，而 $K=\\sum_{i=1}^N D_i$ 则必须是正整数。现在，给定 $N$ 和 $P_i$，请你求出满足 $D_i$ 有非负整数解的最小的总投票数 $K$。", "inputFormat": "输入的第一行包含一个正整数 $N$，表示投票的选项总数。保证 $1\\le N\\le 100$。\n\n接下来 $N$ 行，每行包括一个 $[0, 1]$ 中的实数 $P_i$，表示选择第 $i$ 个选项的玩家比例。保证 $\\sum_{i=1}^N P_i =1$，所有 $P_i$ 均保留到小数点后第 $L$ 位，且 $1\\le L\\le 6$。", "outputFormat": "输出一个正整数，表示满足要求的最小总投票数 $K$。", "hint": "**【样例解释 #1】**\n\n最小的总投票数为 $6$，对应每个选项的投票数为 $1, 2, 3$。\n\n**【样例解释 #2】**\n\n最小的总投票数为 $73$，对应每个选项的投票数为 $3, 8, 8, 12, 22, 5, 15$。\n\n**【样例解释 #3】**\n\n最小的总投票数为 $7766$，对应每个选项的投票数为 $12, 301, 123, 403, 629, 530, 1216, 808, 205, 1113, 1005, 1206, 215$。\n\n**【数据范围】**\n\n对于所有测试数据，$1\\le N\\le 100$，$0\\le P_i\\le 1$，$\\sum_{i=1}^N P_i=1$，且 $P_i$ 最多统一保留到小数点后 $6$ 位。\n\n**【题目来源】**\n\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 [https://github.com/THUSAAC/THUPC2023](https://github.com/THUSAAC/THUPC2023) 查看。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2023 决赛] 总投票数", "background": "各位亲爱的《La Lumière: Scarlet Intense Flame - Adventurous Scarlet -》玩家：\n\n非常荣幸能与您携手度过了这四年的美好时光，衷心感谢大家的支持与陪伴！\n\n现在，我们非常遗憾的宣布，《La Lumière: Scarlet Intense Flame - Adventurous Scarlet -》将于 2023 年 5 月 28 日 15:00 停止运营服务。\n\n停止运营相关时间表如下：\n\n……", "description": "在关服前，运营发起了一系列投票，调查哪些游戏内容给玩家带来了更深的印象。\n\n作为系列的忠实玩家，你想知道有多少人参加了关服前的投票，但是运营只公开了最终的投票结果：对于一项包含 $N$ 个选项的投票，选择第 $i$ 个选项的玩家比例为 $P_i$（$1\\le i\\le N$）。运营在公布结果时进行了四舍五入，所有的 $P_i$ 仅保留到小数点后第 $L$ 位。假设实际有 $K$ 位玩家参加了投票，其中有 $D_i$ 位玩家选择了第 $i$ 个选项，则应该有\n\n$$\nP_i-\\frac{1}{2}\\times 10^{-L}\\le\\frac{D_i}{K}< P_i+\\frac{1}{2}\\times 10^{-L}\n$$\n\n显然，所有的 $D_i$ 必须是非负整数，而 $K=\\sum_{i=1}^N D_i$ 则必须是正整数。现在，给定 $N$ 和 $P_i$，请你求出满足 $D_i$ 有非负整数解的最小的总投票数 $K$。", "inputFormat": "输入的第一行包含一个正整数 $N$，表示投票的选项总数。保证 $1\\le N\\le 100$。\n\n接下来 $N$ 行，每行包括一个 $[0, 1]$ 中的实数 $P_i$，表示选择第 $i$ 个选项的玩家比例。保证 $\\sum_{i=1}^N P_i =1$，所有 $P_i$ 均保留到小数点后第 $L$ 位，且 $1\\le L\\le 6$。", "outputFormat": "输出一个正整数，表示满足要求的最小总投票数 $K$。", "hint": "**【样例解释 #1】**\n\n最小的总投票数为 $6$，对应每个选项的投票数为 $1, 2, 3$。\n\n**【样例解释 #2】**\n\n最小的总投票数为 $73$，对应每个选项的投票数为 $3, 8, 8, 12, 22, 5, 15$。\n\n**【样例解释 #3】**\n\n最小的总投票数为 $7766$，对应每个选项的投票数为 $12, 301, 123, 403, 629, 530, 1216, 808, 205, 1113, 1005, 1206, 215$。\n\n**【数据范围】**\n\n对于所有测试数据，$1\\le N\\le 100$，$0\\le P_i\\le 1$，$\\sum_{i=1}^N P_i=1$，且 $P_i$ 最多统一保留到小数点后 $6$ 位。\n\n**【题目来源】**\n\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 [https://github.com/THUSAAC/THUPC2023](https://github.com/THUSAAC/THUPC2023) 查看。", "locale": "zh-CN"}}}
{"pid": "P9381", "type": "P", "difficulty": 6, "samples": [["2 1\nStrong Lv=90 maxhp=2451 atk=15588e-4 def=96931e-3 skillLv=5 passivesklLv=5 M weaponatk=80000e0\nStrong Lv=100 maxhp=3512 atk=16385e-4 def=12511e-2 skillLv=5 passivesklLv=5 G weaponatk=80000e0\nWeak Lv=1 maxhp=100000 atk=75000e-5 def=10000e-6 skillLv=5 passivesklLv=5 B weaponatk=80000e0\n3\nSkill target=2\nSpecialattack target=1 atkpos=3 ddgpos=3\nSpecialattack target=1 atkpos=5 ddgpos=5\n", "South 1 applied Strong skill to South 2\nNorth: 100000/100000\nSouth: 2451/2451 3512/3512\n\nSouth 1 took 1063 damage from North 1 -> 1388/2451\nNorth: 100000/100000\nSouth: 1388/2451 3512/3512\n\nNorth 1 took 52556526 damage from South 2 -> 0/100000\nNorth: 0/100000\nSouth: 1388/2451 3512/3512\n\nTeam South won.\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["模拟", "2023", "O2优化", "THUPC"], "title": "[THUPC 2023 决赛] 那些脑海里最珍贵的", "background": "E.Space：设定很怪，别问为什么，问就是看附件。\n\n_没有人听懂的傻话_\n\n_还记得吗_\n\n_写满青春的围墙_\n\n_好努力练习的倔强_\n\n_浅浅伤疤_\n\n_勇敢是我们的翅膀_\n\n_——张韶涵《还记得吗》_", "description": "故事的世界观大概是这样的。这个世界的人分为三类，根据其某种特点被直接命名为 Weak，Average 和 Strong。你可以理解为这是一个关于种族或者职业的分类。\n\n两个队伍之间发生了一场回合制战斗。你知道双方做了什么，现在希望你把所有的细节还原出来。\n\n下面是本题的一些技术细节。\n\n**【人物】**\n\n一个人有以下几种属性值：「种族」、「等级」、「体力上限」、「基础攻击指数」、「基础防御指数」、「主动技能等级」、「被动技能等级」。其中「体力上限」、「基础攻击指数」、「基础防御指数」完全由「种族」和「等级」决定。但是为了输入方便，本题中所有信息都会给出。在战斗中，每个人有一个「体力值」。在战斗开始时，「体力值」等于「体力上限」。当「体力值」小于等于 $0$ 时这个人就会「倒下」。对于同一个「种族」而言，「体力上限」、「基础攻击指数」、「基础防御指数」大致随「等级」指数增长。每个人持有一把「武器」。「武器」的细节在下一节给出。\n\n**【武器】**\n\n「武器」的属性只有两种：「武器类型」和「武器攻击力」。所有「武器」都有「普通攻击」和「特殊攻击」两种攻击方式。发起「攻击」指使用这两种方式中的任意一种。「普通攻击」的效果与「武器类型」无关，但不同的「武器类型」有着不同的「特殊攻击」效果。「武器」有三种类型，分别叫做「B」、「G」、「M」。\n\n**【战场与队伍】**\n\n交战双方的每一方包含不超过 $6$ 名队员，一字排开，从西到东的编号分别为 $5,3,1,2,4,6$（若不足 $6$ 名则删去较大的若干个编号）。方便起见，就叫两队为「南队」和「北队」。\n\n**【回合】**\n\n每个「回合」中，只有一个人可以「行动」。第奇数个「回合」是「南队」的队员「行动」，第偶数个「回合」是「北队」的队员「行动」。第一个「回合」和第二个「回合」中，「行动」的人是队伍里未「倒下」的编号最小的人。之后的「回合」中，若本队中没有编号比本队上一个「行动」的人大且未「倒下」的人，则由本队中编号最小的未「倒下」的人「行动」。否则由编号大于本队上一个「行动」者的人中，编号最小且未「倒下」的人「行动」。若一个队伍中的所有队员均已「倒下」，则判另一个队伍「胜利」。\n\n**【行动】**\n\n「行动」一共有三种。当前「回合」中「行动」的人必须选择三种之一来完成。\n\n1. 「普通攻击」；\n2. 「特殊攻击」；\n3. 「主动技能」。\n\n这些「行动」的效果会在之后介绍。「特殊攻击」和「主动技能」是有次数限制的，但是在本题中，保证所有「行动」均合法，所以你不需要考虑这个限制。\n\n**【伤害计算】**\n\n「伤害」指的是因为「普通攻击」或「特殊攻击」而造成的「体力值」减少。\n\n「伤害」，即「体力值」减少的量，由「攻击强度」和受到「伤害」的人的「防御指数」决定。\n\n一个人的「防御指数」等于这个人的「基础防御指数」乘以队伍的「防御加成」。\n\n具体地，若一个人受到「攻击强度」为 $x$ 的「伤害」，那么这个人的「体力值」就会减少 $y$。其中 $y$ 的值等于 $x$ 除以这个人的「防御指数」下取整。\n\n「攻击强度」等于「基础攻击强度」乘以发起「攻击」的人的「技能加成」乘以队伍的「攻击加成」乘以「种族克制加成」乘以「方位加成」。这些概念会在之后介绍。\n\n**【普通攻击】**\n\n选择一个敌方未「倒下」的队员作为「目标」。「目标」受到「基础攻击强度」为发起「攻击」的人的「基础攻击指数」乘「武器攻击力」的「伤害」。\n\n**【特殊攻击】**\n\n选择一个敌方未「倒下」的队员作为「目标」。\n\n「武器」有三种，不同「武器类型」的「特殊攻击」效果如下：\n\n- 「B」：「目标」受到「基础攻击强度」为发起「攻击」的人的「基础攻击指数」乘「武器攻击力」乘 $125\\%$ 的「伤害」。\n- 「G」：「目标」和「目标」东西两侧与「目标」距离最近的各一名未「倒下」的队员（如果存在）均受到「基础攻击强度」为发起「攻击」的人的「基础攻击指数」乘「武器攻击力」乘 $x\\%$ 的「伤害」。其中 $x$ 的值等于 $135$ 除以将要受到「伤害」的人数。「伤害」按照「目标」、「目标」西侧、「目标」东侧的顺序计算。注意如果过程中有人「倒下」，那么这个人的「被动技能」将不再对该顺序中位于这个人之后的人的「伤害」结算起作用。特别地，所有「伤害」的「方位加成」以「目标」的「躲闪方位」来计算。\n- 「M」：「目标」受到「基础攻击强度」为发起「攻击」的人的「基础攻击指数」乘「武器攻击力」乘 $115\\%$ 的「伤害」。「目标」东西两侧与「目标」距离最近的各一名未「倒下」的队员（如果存在）分别受到「基础攻击强度」为发起「攻击」的人的「基础攻击指数」乘「武器攻击力」乘 $23\\%$ 的「伤害」。「伤害」按照「目标」、「目标」西侧、「目标」东侧的顺序计算。注意如果过程中有人「倒下」，那么这个人的「被动技能」将不再对该顺序中位于这个人之后的人的「伤害」结算起作用。特别地，所有「伤害」的「方位加成」以「目标」的「躲闪方位」来计算。\n\n**【技能】**\n\n「技能」分为「主动技能」和「被动技能」。每个「种族」的人都有一个「主动技能」和一个「被动技能」。「技能」的效果因「种族」和「技能等级」的不同而不同。「技能等级」为一个 $0$ 到 $5$ 之间的整数。「技能等级」为 $0$ 表示没有该「技能」。\n\n使用「主动技能」需要选择一个人作为「技能目标」。\n\n「主动技能」描述如下：（$1$ 到 $5$ 级的「技能」效果由斜杠隔开，保证使用「主动技能」的人的「主动技能等级」不为 $0$）\n\n- 「Weak 种族」：使本队一名未「倒下」的队员的「体力值」增加这名队员的「体力上限」乘以 $10\\%/12\\%/15\\%/17\\%/20\\%$ 下取整。\n- 「Average 种族」：选择一名敌方未「倒下」的队员，在使用该「主动技能」这一队的「回合」结束时，其「体力值」减去其「体力上限」的 $6\\%/7\\%/8\\%/9\\%/10\\%$ 下取整。该效果持续 $3$ 个回合，即会触发 $3$ 次。若该队员已有同类型（可以是不同等级）的「技能」施加的效果，那么这个效果将会覆盖之前的效果。\n- 「Strong 种族」：使本队一名未「倒下」的队员的「技能加成」变为 $2.1/2.17/2.24/2.32/2.4$。\n\n一名队员的「被动技能」只有当该队员未「倒下」时才能发挥效果，「倒下」之后不再发挥效果。\n\n「被动技能」描述如下：\n\n- 「Weak 种族」：在本队的「回合」开始时，本队所有未「倒下」的成员的「体力值」增加该成员「体力上限」的 $1.3\\%/1.6\\%/1.9\\%/2.2\\%/2.5\\%$。若本队有多名队员有这个「技能」，这个效果的数值可以相加至最多 $5\\%$。超过 $5\\%$ 按照 $5\\%$ 计算。「体力值」增加的量在效果叠加后需要下取整。\n- 「Average 种族」：队伍的「防御加成」初始为 $1$。该技能使队伍的「防御加成」增加 $0.01/0.02/0.03/0.04/0.05$。若本队有多名队员有这个「技能」，这个效果的数值可以相加至最多 $0.1$。超过 $0.1$ 按照 $0.1$ 计算。\n- 「Strong 种族」：队伍的「攻击加成」初始为 $1$。该技能使队伍的「攻击加成」增加 $0.01/0.02/0.03/0.04/0.05$。若本队有多名队员有这个「技能」，这个效果的数值可以相加至最多 $0.1$。超过 $0.1$ 按照 $0.1$ 计算。\n\n一名队员的「体力值」增加时，不能超过这名队员的「体力上限」。若增加后的「体力值」超过了「体力上限」，则把这次增加「体力值」的效果改为将这名队员的「体力值」变成这名队员的「体力上限」。\n\n**【技能加成】**\n\n战斗开始时，所有人的「技能加成」都是 $1$。只有两种方式能够改变「技能加成」：\n\n- 「Strong 种族」的「主动技能」。见「技能」的描述。\n- 当一个人发起「攻击」且计算完这次「攻击」的所有「伤害」之后，这个人的「技能加成」变为 $1$。\n\n**【种族克制加成】**\n\n「种族克制加成」与发起「攻击」的人的「种族」以及受到「伤害」的人的「种族」有关。「种族克制加成」的值如下表：\n\n\n| 发起「攻击」方/受到「伤害」方 | Weak  | Average | Strong |\n| :---------------------------: | :---: | :-----: | :----: |\n|             Weak              | $1.0$ |  $0.9$  | $1.1$  |\n|            Average            | $1.1$ |  $1.0$  | $0.9$  |\n|            Strong             | $0.9$ |  $1.1$  | $1.0$  |\n\n\n\n**【方位加成】**\n\n在「攻击」时，发起「攻击」的一方有一个「攻击方位」，「攻击」的「目标」有一个「躲闪方位」。「攻击方位」和「躲闪方位」分别为一个 $1$ 到 $6$ 之间的整数。当「攻击方位」为 $a$，「躲闪方位」为 $d$ 时，「方位加成」的值由下表所示：\n\n\n| $(a-d)\\bmod 6$ | 「方位加成」 |\n| :------------: | :----------: |\n|      $0$       |    $1.25$    |\n|   $1$ 或 $5$   |    $1.00$    |\n|   $2$ 或 $4$   |    $0.75$    |\n|      $3$       |    $0.00$    |\n\n", "inputFormat": "从标准输入读入数据。\n\n第一行两个正整数 $n,m$，分别表示「南队」的人数和「北队」的人数。\n\n接下来 $n$ 行，其中第 $i$ 行表示「南队」中编号为 $i$ 的队员的信息，格式如下：\n\n`<Type> Lv=<Lv> maxhp=<maxhp> atk=<atk> def=<def> skillLv=<skillLv> passivesklLv=<passivesklLv> <weapontype> weaponatk=<weaponatk>`\n\n其中尖括号中的内容表示一个变量。\n\n`<Type>` 为 `Weak`，`Average`，`Strong` 中的一种，分别表示对应名称的「种族」。\n\n`<Lv>` 为一个 $1$ 到 $100$ 之间的整数，表示队员的「等级」。\n\n`<maxhp>` 为一个整数，表示队员的「体力上限」。\n\n`<atk>` 为一个实数，表示队员的「基础攻击指数」。\n\n`<def>` 为一个实数，表示队员的「基础防御指数」。\n\n`<skillLv>` 为一个 $0$ 到 $5$ 之间的整数，表示队员的「主动技能等级」。\n\n`<passivesklLv>` 为一个 $0$ 到 $5$ 之间的整数，表示队员的「被动技能等级」。\n\n`<weapontype>` 为 `B`，`G`，`M` 中的一种，分别表示对应名称的「武器类型」。\n\n`<weaponatk>` 为一个实数，表示队员的「武器攻击力」。\n\n接下来 $m$ 行，其中第 $i$ 行表示「北队」中编号为 $i$ 的队员的信息，格式与「南队」相同。\n\n接下来一行一个正整数 $T$，表示进行的「回合」数。\n\n接下来 $T$ 行，其中第 $i$ 行表示第 $i$ 个「回合」的「行动」。\n\n「行动」的描述以一个字符串开头，表示「行动」的类型。\n\n`Basicattack target=<target> atkpos=<atkpos> ddgpos=<ddgpos>` 表示一次「普通攻击」。\n\n`Specialattack target=<target> atkpos=<atkpos> ddgpos=<ddgpos>` 表示一次「特殊攻击」。\n\n`Skill target=<target>` 表示使用 「主动技能」。保证该队员的「技能等级」不是 $0$。\n\n其中，`<target>` 表示「目标」或「技能目标」的编号。若是「Weak 种族」或「Strong 种族」的「主动技能」，这个编号是一个己方队员的编号，否则是一个敌方队员的编号。\n\n`<atkpos>` 为一个 $1$ 到 $6$ 之间的整数，表示「攻击方位」。\n\n`<ddgpos>` 为一个 $1$ 到 $6$ 之间的整数，表示「躲闪方位」。\n\n保证所有的「行动」均合法。\n\n为了方便起见，本题中实数的表示方法较为特殊。具体的表示方法是，用 `<mag>e<exp>` 的方式来表示 `<mag>` 乘以 $10$ 的 `<exp>` 次方。其中 `<mag>` 是一个 $1$ 到 $99999$ 之间的正整数，`<exp>` 是一个 $-6$ 到 $0$ 之间的整数。如 $42.195$ 可以表示成 `42195e-3`，$6$ 可以表示成 `6e0` 或 `600e-2` 等，$0.04$ 可以表示成 `4e-2` 等。", "outputFormat": "输出到标准输出。\n\n对于每个「回合」，按时间顺序把这个「回合」的信息输出来。\n\n信息的格式如下：\n\n`<team> <id> recovered +<heal> hp -> <curhp>/<maxhp>` 表示「Weak 种族」的「技能」所造成的「体力值」增加。如果在增加之前「体力值」就已经等于「体力上限」，那么不需要输出这一行。\n\n`<team> <id> took <dmg> damage from <atkteam> <atkid> -> <curhp>/<maxhp>` 表示一名队员受到「伤害」。\n\n`<team> <id> took <dmg> damage from skill -> <curhp>/<maxhp>` 表示「Average 种族」的「主动技能」所造成的「体力值」减少。\n\n`<team> <id> applied <type> skill to <targetteam> <targetid>` 表示使用「主动技能」。\n\n其中 `<team>` 表示队伍名称，为 `South` 或 `North` 之一，分别表示南队/北队。\n\n`<id>` 表示「体力值」发生改变的人在队伍中的编号，为一个 $1$ 到 $6$ 之间的正整数。\n\n`<heal>` 表示本应该增加的「体力值」数量（不考虑「体力上限」的限制），为一个正整数。\n\n`<curhp>` 指的是「体力值」发生改变之后的「体力值」，为一个非负整数。若「体力值」减小到 $0$ 以下输出 $0$。\n\n`<maxhp>` 表示「体力值」发生改变的人的「体力上限」，为一个正整数。\n\n`<dmg>` 为受到的「伤害」或「Average 种族」的「主动技能」所造成的「体力值」减少，为一个非负整数。\n\n`<type>` 为使用「主动技能」的人的「种族」，为 `Weak`，`Average`，`Strong` 之一。\n\n`<atkteam>` 和 `<atkid>` 为发起「攻击」的人的队伍名称和编号，格式同 `<team>` 和 `<id>`。\n\n`<targetteam>` 和 `<targetid>` 为「技能目标」的队伍名称和编号，格式同 `<team>` 和 `<id>`。\n\n时间顺序如下：\n\n「回合」开始时，可能触发「Weak 种族」的「被动技能」效果，按照编号从小到大输出。\n\n如果是使用「主动技能」，则输出一行使用「主动技能」的信息。\n\n然后输出「行动」所造成的「体力值」变化信息。若「伤害」为 $0$ 也要输出。若没有造成「伤害」则不输出。若「特殊攻击」改变了多个人的「体力值」，则按照「目标」、「目标」西边的人、「目标」东边的人的顺序输出。\n\n「回合」结束时，可能触发「Average 种族」的「主动技能」效果，按照编号从小到大输出。\n\n每个「回合」结束后输出两队的「体力值」信息，格式如下：\n\n`<team>: [<curhp5>/<maxhp5>] [<curhp3>/<maxhp3>] <curhp1>/<maxhp1> [<curhp2>/<maxhp2>] [<curhp4>/<maxhp4>] [<curhp6>/<maxhp6>]`\n\n其中，`<team>` 表示队伍名称，`<curhpi>` 表示队伍中编号为 $i$ 的人的「体力值」，`<maxhpi>` 表示队伍中编号为 $i$ 的人的「体力上限」。两个人的「体力值」信息之间有恰好一个空格，第一个「体力值」信息和冒号之间有恰好一个空格。已「倒下」的人的「体力值」信息也需要输出。方括号表示，若队伍中不存在编号为 $i$ 的人则不输出。注意这里按照位置顺序而不是编号顺序输出，即顺序为 $5,3,1,2,4,6$。\n\n先输出一行「北队」的信息，再输出一行「南队」的信息。\n\n每个「回合」的信息以一个空行结束。\n\n所有「回合」结束后，若有一个队伍「胜利」，则输出一行 `Team <team> won.`。其中 `<team>` 是队伍名称，为 `South` 或 `North`。因为「行动」需要指定一个未「倒下」的人作为「目标」或「技能目标」，且所有「行动」均合法，所以，如果有队伍「胜利」，则一定是在最后一个「回合」结束后才「胜利」。若没有队伍「胜利」则不输出。", "hint": "**【样例 #2】**\n\n见题目目录下的 *2.in* 与 *2.ans*。\n\n**【样例解释 #2】**\n\n这个样例，无疑是善良的出题人无私的馈赠。中间忘了。出题人相信，这个美妙的样例，可以给拼搏于 AC 这道题的逐梦之路上的你，提供一个有力的援助。\n\n**【数据范围】**\n\n保证 $1\\le n,m \\le 6$。\n\n保证 $1\\le T \\le 50000$。\n\n保证「武器攻击力」的范围在 $300$ 到 $80000$ 之间。\n\n「体力上限」「基础攻击指数」「基础防御指数」的范围见下表。\n\n| 「种族」与「等级」 | 「体力上限」 | 「基础攻击指数」 | 「基础防御指数」 |\n| :----------------: | :----------: | :--------------: | :--------------: |\n|     Weak Lv.1      |   $100000$   |    $0.75000$     |    $0.010000$    |\n|    Average Lv.1    |    $5000$    |    $0.80000$     |    $0.20000$     |\n|    Strong Lv.1     |    $100$     |     $1.0000$     |     $10.000$     |\n|    Weak Lv.100     |  $7807514$   |     $1.0089$     |    $0.10464$     |\n|   Average Lv.100   |   $252234$   |     $1.3108$     |     $1.8101$     |\n|   Strong Lv.100    |    $3512$    |     $1.6385$     |     $125.11$     |\n\n \n\n**【后记】**\n\n_有一天我将会老去_\n\n_希望你会觉得满意_\n\n_我没有 对不起那个_\n\n_十五岁的自己_\n\n_——刘若英《继续-给十五岁的自己》_\n\n**【题目来源】**\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 [https://github.com/THUSAAC/THUPC2023](https://github.com/THUSAAC/THUPC2023) 查看。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2023 决赛] 那些脑海里最珍贵的", "background": "E.Space：设定很怪，别问为什么，问就是看附件。\n\n_没有人听懂的傻话_\n\n_还记得吗_\n\n_写满青春的围墙_\n\n_好努力练习的倔强_\n\n_浅浅伤疤_\n\n_勇敢是我们的翅膀_\n\n_——张韶涵《还记得吗》_", "description": "故事的世界观大概是这样的。这个世界的人分为三类，根据其某种特点被直接命名为 Weak，Average 和 Strong。你可以理解为这是一个关于种族或者职业的分类。\n\n两个队伍之间发生了一场回合制战斗。你知道双方做了什么，现在希望你把所有的细节还原出来。\n\n下面是本题的一些技术细节。\n\n**【人物】**\n\n一个人有以下几种属性值：「种族」、「等级」、「体力上限」、「基础攻击指数」、「基础防御指数」、「主动技能等级」、「被动技能等级」。其中「体力上限」、「基础攻击指数」、「基础防御指数」完全由「种族」和「等级」决定。但是为了输入方便，本题中所有信息都会给出。在战斗中，每个人有一个「体力值」。在战斗开始时，「体力值」等于「体力上限」。当「体力值」小于等于 $0$ 时这个人就会「倒下」。对于同一个「种族」而言，「体力上限」、「基础攻击指数」、「基础防御指数」大致随「等级」指数增长。每个人持有一把「武器」。「武器」的细节在下一节给出。\n\n**【武器】**\n\n「武器」的属性只有两种：「武器类型」和「武器攻击力」。所有「武器」都有「普通攻击」和「特殊攻击」两种攻击方式。发起「攻击」指使用这两种方式中的任意一种。「普通攻击」的效果与「武器类型」无关，但不同的「武器类型」有着不同的「特殊攻击」效果。「武器」有三种类型，分别叫做「B」、「G」、「M」。\n\n**【战场与队伍】**\n\n交战双方的每一方包含不超过 $6$ 名队员，一字排开，从西到东的编号分别为 $5,3,1,2,4,6$（若不足 $6$ 名则删去较大的若干个编号）。方便起见，就叫两队为「南队」和「北队」。\n\n**【回合】**\n\n每个「回合」中，只有一个人可以「行动」。第奇数个「回合」是「南队」的队员「行动」，第偶数个「回合」是「北队」的队员「行动」。第一个「回合」和第二个「回合」中，「行动」的人是队伍里未「倒下」的编号最小的人。之后的「回合」中，若本队中没有编号比本队上一个「行动」的人大且未「倒下」的人，则由本队中编号最小的未「倒下」的人「行动」。否则由编号大于本队上一个「行动」者的人中，编号最小且未「倒下」的人「行动」。若一个队伍中的所有队员均已「倒下」，则判另一个队伍「胜利」。\n\n**【行动】**\n\n「行动」一共有三种。当前「回合」中「行动」的人必须选择三种之一来完成。\n\n1. 「普通攻击」；\n2. 「特殊攻击」；\n3. 「主动技能」。\n\n这些「行动」的效果会在之后介绍。「特殊攻击」和「主动技能」是有次数限制的，但是在本题中，保证所有「行动」均合法，所以你不需要考虑这个限制。\n\n**【伤害计算】**\n\n「伤害」指的是因为「普通攻击」或「特殊攻击」而造成的「体力值」减少。\n\n「伤害」，即「体力值」减少的量，由「攻击强度」和受到「伤害」的人的「防御指数」决定。\n\n一个人的「防御指数」等于这个人的「基础防御指数」乘以队伍的「防御加成」。\n\n具体地，若一个人受到「攻击强度」为 $x$ 的「伤害」，那么这个人的「体力值」就会减少 $y$。其中 $y$ 的值等于 $x$ 除以这个人的「防御指数」下取整。\n\n「攻击强度」等于「基础攻击强度」乘以发起「攻击」的人的「技能加成」乘以队伍的「攻击加成」乘以「种族克制加成」乘以「方位加成」。这些概念会在之后介绍。\n\n**【普通攻击】**\n\n选择一个敌方未「倒下」的队员作为「目标」。「目标」受到「基础攻击强度」为发起「攻击」的人的「基础攻击指数」乘「武器攻击力」的「伤害」。\n\n**【特殊攻击】**\n\n选择一个敌方未「倒下」的队员作为「目标」。\n\n「武器」有三种，不同「武器类型」的「特殊攻击」效果如下：\n\n- 「B」：「目标」受到「基础攻击强度」为发起「攻击」的人的「基础攻击指数」乘「武器攻击力」乘 $125\\%$ 的「伤害」。\n- 「G」：「目标」和「目标」东西两侧与「目标」距离最近的各一名未「倒下」的队员（如果存在）均受到「基础攻击强度」为发起「攻击」的人的「基础攻击指数」乘「武器攻击力」乘 $x\\%$ 的「伤害」。其中 $x$ 的值等于 $135$ 除以将要受到「伤害」的人数。「伤害」按照「目标」、「目标」西侧、「目标」东侧的顺序计算。注意如果过程中有人「倒下」，那么这个人的「被动技能」将不再对该顺序中位于这个人之后的人的「伤害」结算起作用。特别地，所有「伤害」的「方位加成」以「目标」的「躲闪方位」来计算。\n- 「M」：「目标」受到「基础攻击强度」为发起「攻击」的人的「基础攻击指数」乘「武器攻击力」乘 $115\\%$ 的「伤害」。「目标」东西两侧与「目标」距离最近的各一名未「倒下」的队员（如果存在）分别受到「基础攻击强度」为发起「攻击」的人的「基础攻击指数」乘「武器攻击力」乘 $23\\%$ 的「伤害」。「伤害」按照「目标」、「目标」西侧、「目标」东侧的顺序计算。注意如果过程中有人「倒下」，那么这个人的「被动技能」将不再对该顺序中位于这个人之后的人的「伤害」结算起作用。特别地，所有「伤害」的「方位加成」以「目标」的「躲闪方位」来计算。\n\n**【技能】**\n\n「技能」分为「主动技能」和「被动技能」。每个「种族」的人都有一个「主动技能」和一个「被动技能」。「技能」的效果因「种族」和「技能等级」的不同而不同。「技能等级」为一个 $0$ 到 $5$ 之间的整数。「技能等级」为 $0$ 表示没有该「技能」。\n\n使用「主动技能」需要选择一个人作为「技能目标」。\n\n「主动技能」描述如下：（$1$ 到 $5$ 级的「技能」效果由斜杠隔开，保证使用「主动技能」的人的「主动技能等级」不为 $0$）\n\n- 「Weak 种族」：使本队一名未「倒下」的队员的「体力值」增加这名队员的「体力上限」乘以 $10\\%/12\\%/15\\%/17\\%/20\\%$ 下取整。\n- 「Average 种族」：选择一名敌方未「倒下」的队员，在使用该「主动技能」这一队的「回合」结束时，其「体力值」减去其「体力上限」的 $6\\%/7\\%/8\\%/9\\%/10\\%$ 下取整。该效果持续 $3$ 个回合，即会触发 $3$ 次。若该队员已有同类型（可以是不同等级）的「技能」施加的效果，那么这个效果将会覆盖之前的效果。\n- 「Strong 种族」：使本队一名未「倒下」的队员的「技能加成」变为 $2.1/2.17/2.24/2.32/2.4$。\n\n一名队员的「被动技能」只有当该队员未「倒下」时才能发挥效果，「倒下」之后不再发挥效果。\n\n「被动技能」描述如下：\n\n- 「Weak 种族」：在本队的「回合」开始时，本队所有未「倒下」的成员的「体力值」增加该成员「体力上限」的 $1.3\\%/1.6\\%/1.9\\%/2.2\\%/2.5\\%$。若本队有多名队员有这个「技能」，这个效果的数值可以相加至最多 $5\\%$。超过 $5\\%$ 按照 $5\\%$ 计算。「体力值」增加的量在效果叠加后需要下取整。\n- 「Average 种族」：队伍的「防御加成」初始为 $1$。该技能使队伍的「防御加成」增加 $0.01/0.02/0.03/0.04/0.05$。若本队有多名队员有这个「技能」，这个效果的数值可以相加至最多 $0.1$。超过 $0.1$ 按照 $0.1$ 计算。\n- 「Strong 种族」：队伍的「攻击加成」初始为 $1$。该技能使队伍的「攻击加成」增加 $0.01/0.02/0.03/0.04/0.05$。若本队有多名队员有这个「技能」，这个效果的数值可以相加至最多 $0.1$。超过 $0.1$ 按照 $0.1$ 计算。\n\n一名队员的「体力值」增加时，不能超过这名队员的「体力上限」。若增加后的「体力值」超过了「体力上限」，则把这次增加「体力值」的效果改为将这名队员的「体力值」变成这名队员的「体力上限」。\n\n**【技能加成】**\n\n战斗开始时，所有人的「技能加成」都是 $1$。只有两种方式能够改变「技能加成」：\n\n- 「Strong 种族」的「主动技能」。见「技能」的描述。\n- 当一个人发起「攻击」且计算完这次「攻击」的所有「伤害」之后，这个人的「技能加成」变为 $1$。\n\n**【种族克制加成】**\n\n「种族克制加成」与发起「攻击」的人的「种族」以及受到「伤害」的人的「种族」有关。「种族克制加成」的值如下表：\n\n\n| 发起「攻击」方/受到「伤害」方 | Weak  | Average | Strong |\n| :---------------------------: | :---: | :-----: | :----: |\n|             Weak              | $1.0$ |  $0.9$  | $1.1$  |\n|            Average            | $1.1$ |  $1.0$  | $0.9$  |\n|            Strong             | $0.9$ |  $1.1$  | $1.0$  |\n\n\n\n**【方位加成】**\n\n在「攻击」时，发起「攻击」的一方有一个「攻击方位」，「攻击」的「目标」有一个「躲闪方位」。「攻击方位」和「躲闪方位」分别为一个 $1$ 到 $6$ 之间的整数。当「攻击方位」为 $a$，「躲闪方位」为 $d$ 时，「方位加成」的值由下表所示：\n\n\n| $(a-d)\\bmod 6$ | 「方位加成」 |\n| :------------: | :----------: |\n|      $0$       |    $1.25$    |\n|   $1$ 或 $5$   |    $1.00$    |\n|   $2$ 或 $4$   |    $0.75$    |\n|      $3$       |    $0.00$    |\n\n", "inputFormat": "从标准输入读入数据。\n\n第一行两个正整数 $n,m$，分别表示「南队」的人数和「北队」的人数。\n\n接下来 $n$ 行，其中第 $i$ 行表示「南队」中编号为 $i$ 的队员的信息，格式如下：\n\n`<Type> Lv=<Lv> maxhp=<maxhp> atk=<atk> def=<def> skillLv=<skillLv> passivesklLv=<passivesklLv> <weapontype> weaponatk=<weaponatk>`\n\n其中尖括号中的内容表示一个变量。\n\n`<Type>` 为 `Weak`，`Average`，`Strong` 中的一种，分别表示对应名称的「种族」。\n\n`<Lv>` 为一个 $1$ 到 $100$ 之间的整数，表示队员的「等级」。\n\n`<maxhp>` 为一个整数，表示队员的「体力上限」。\n\n`<atk>` 为一个实数，表示队员的「基础攻击指数」。\n\n`<def>` 为一个实数，表示队员的「基础防御指数」。\n\n`<skillLv>` 为一个 $0$ 到 $5$ 之间的整数，表示队员的「主动技能等级」。\n\n`<passivesklLv>` 为一个 $0$ 到 $5$ 之间的整数，表示队员的「被动技能等级」。\n\n`<weapontype>` 为 `B`，`G`，`M` 中的一种，分别表示对应名称的「武器类型」。\n\n`<weaponatk>` 为一个实数，表示队员的「武器攻击力」。\n\n接下来 $m$ 行，其中第 $i$ 行表示「北队」中编号为 $i$ 的队员的信息，格式与「南队」相同。\n\n接下来一行一个正整数 $T$，表示进行的「回合」数。\n\n接下来 $T$ 行，其中第 $i$ 行表示第 $i$ 个「回合」的「行动」。\n\n「行动」的描述以一个字符串开头，表示「行动」的类型。\n\n`Basicattack target=<target> atkpos=<atkpos> ddgpos=<ddgpos>` 表示一次「普通攻击」。\n\n`Specialattack target=<target> atkpos=<atkpos> ddgpos=<ddgpos>` 表示一次「特殊攻击」。\n\n`Skill target=<target>` 表示使用 「主动技能」。保证该队员的「技能等级」不是 $0$。\n\n其中，`<target>` 表示「目标」或「技能目标」的编号。若是「Weak 种族」或「Strong 种族」的「主动技能」，这个编号是一个己方队员的编号，否则是一个敌方队员的编号。\n\n`<atkpos>` 为一个 $1$ 到 $6$ 之间的整数，表示「攻击方位」。\n\n`<ddgpos>` 为一个 $1$ 到 $6$ 之间的整数，表示「躲闪方位」。\n\n保证所有的「行动」均合法。\n\n为了方便起见，本题中实数的表示方法较为特殊。具体的表示方法是，用 `<mag>e<exp>` 的方式来表示 `<mag>` 乘以 $10$ 的 `<exp>` 次方。其中 `<mag>` 是一个 $1$ 到 $99999$ 之间的正整数，`<exp>` 是一个 $-6$ 到 $0$ 之间的整数。如 $42.195$ 可以表示成 `42195e-3`，$6$ 可以表示成 `6e0` 或 `600e-2` 等，$0.04$ 可以表示成 `4e-2` 等。", "outputFormat": "输出到标准输出。\n\n对于每个「回合」，按时间顺序把这个「回合」的信息输出来。\n\n信息的格式如下：\n\n`<team> <id> recovered +<heal> hp -> <curhp>/<maxhp>` 表示「Weak 种族」的「技能」所造成的「体力值」增加。如果在增加之前「体力值」就已经等于「体力上限」，那么不需要输出这一行。\n\n`<team> <id> took <dmg> damage from <atkteam> <atkid> -> <curhp>/<maxhp>` 表示一名队员受到「伤害」。\n\n`<team> <id> took <dmg> damage from skill -> <curhp>/<maxhp>` 表示「Average 种族」的「主动技能」所造成的「体力值」减少。\n\n`<team> <id> applied <type> skill to <targetteam> <targetid>` 表示使用「主动技能」。\n\n其中 `<team>` 表示队伍名称，为 `South` 或 `North` 之一，分别表示南队/北队。\n\n`<id>` 表示「体力值」发生改变的人在队伍中的编号，为一个 $1$ 到 $6$ 之间的正整数。\n\n`<heal>` 表示本应该增加的「体力值」数量（不考虑「体力上限」的限制），为一个正整数。\n\n`<curhp>` 指的是「体力值」发生改变之后的「体力值」，为一个非负整数。若「体力值」减小到 $0$ 以下输出 $0$。\n\n`<maxhp>` 表示「体力值」发生改变的人的「体力上限」，为一个正整数。\n\n`<dmg>` 为受到的「伤害」或「Average 种族」的「主动技能」所造成的「体力值」减少，为一个非负整数。\n\n`<type>` 为使用「主动技能」的人的「种族」，为 `Weak`，`Average`，`Strong` 之一。\n\n`<atkteam>` 和 `<atkid>` 为发起「攻击」的人的队伍名称和编号，格式同 `<team>` 和 `<id>`。\n\n`<targetteam>` 和 `<targetid>` 为「技能目标」的队伍名称和编号，格式同 `<team>` 和 `<id>`。\n\n时间顺序如下：\n\n「回合」开始时，可能触发「Weak 种族」的「被动技能」效果，按照编号从小到大输出。\n\n如果是使用「主动技能」，则输出一行使用「主动技能」的信息。\n\n然后输出「行动」所造成的「体力值」变化信息。若「伤害」为 $0$ 也要输出。若没有造成「伤害」则不输出。若「特殊攻击」改变了多个人的「体力值」，则按照「目标」、「目标」西边的人、「目标」东边的人的顺序输出。\n\n「回合」结束时，可能触发「Average 种族」的「主动技能」效果，按照编号从小到大输出。\n\n每个「回合」结束后输出两队的「体力值」信息，格式如下：\n\n`<team>: [<curhp5>/<maxhp5>] [<curhp3>/<maxhp3>] <curhp1>/<maxhp1> [<curhp2>/<maxhp2>] [<curhp4>/<maxhp4>] [<curhp6>/<maxhp6>]`\n\n其中，`<team>` 表示队伍名称，`<curhpi>` 表示队伍中编号为 $i$ 的人的「体力值」，`<maxhpi>` 表示队伍中编号为 $i$ 的人的「体力上限」。两个人的「体力值」信息之间有恰好一个空格，第一个「体力值」信息和冒号之间有恰好一个空格。已「倒下」的人的「体力值」信息也需要输出。方括号表示，若队伍中不存在编号为 $i$ 的人则不输出。注意这里按照位置顺序而不是编号顺序输出，即顺序为 $5,3,1,2,4,6$。\n\n先输出一行「北队」的信息，再输出一行「南队」的信息。\n\n每个「回合」的信息以一个空行结束。\n\n所有「回合」结束后，若有一个队伍「胜利」，则输出一行 `Team <team> won.`。其中 `<team>` 是队伍名称，为 `South` 或 `North`。因为「行动」需要指定一个未「倒下」的人作为「目标」或「技能目标」，且所有「行动」均合法，所以，如果有队伍「胜利」，则一定是在最后一个「回合」结束后才「胜利」。若没有队伍「胜利」则不输出。", "hint": "**【样例 #2】**\n\n见题目目录下的 *2.in* 与 *2.ans*。\n\n**【样例解释 #2】**\n\n这个样例，无疑是善良的出题人无私的馈赠。中间忘了。出题人相信，这个美妙的样例，可以给拼搏于 AC 这道题的逐梦之路上的你，提供一个有力的援助。\n\n**【数据范围】**\n\n保证 $1\\le n,m \\le 6$。\n\n保证 $1\\le T \\le 50000$。\n\n保证「武器攻击力」的范围在 $300$ 到 $80000$ 之间。\n\n「体力上限」「基础攻击指数」「基础防御指数」的范围见下表。\n\n| 「种族」与「等级」 | 「体力上限」 | 「基础攻击指数」 | 「基础防御指数」 |\n| :----------------: | :----------: | :--------------: | :--------------: |\n|     Weak Lv.1      |   $100000$   |    $0.75000$     |    $0.010000$    |\n|    Average Lv.1    |    $5000$    |    $0.80000$     |    $0.20000$     |\n|    Strong Lv.1     |    $100$     |     $1.0000$     |     $10.000$     |\n|    Weak Lv.100     |  $7807514$   |     $1.0089$     |    $0.10464$     |\n|   Average Lv.100   |   $252234$   |     $1.3108$     |     $1.8101$     |\n|   Strong Lv.100    |    $3512$    |     $1.6385$     |     $125.11$     |\n\n \n\n**【后记】**\n\n_有一天我将会老去_\n\n_希望你会觉得满意_\n\n_我没有 对不起那个_\n\n_十五岁的自己_\n\n_——刘若英《继续-给十五岁的自己》_\n\n**【题目来源】**\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 [https://github.com/THUSAAC/THUPC2023](https://github.com/THUSAAC/THUPC2023) 查看。", "locale": "zh-CN"}}}
{"pid": "P9382", "type": "P", "difficulty": 6, "samples": [["3 3\n1 0 0\n0 1 0\n0 0 1", "1\n1 0 0\n0 1 0\n0 0 1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2023", "Special Judge", "O2优化", "线性基", "THUPC"], "title": "[THUPC 2023 决赛] Freshman Dream", "background": "", "description": "小 J 正在学习矩阵乘法。\n\n一旁的小 L 告诉他：只要将两个矩阵对应的位置乘起来，那就能得到两个矩阵的乘法了。\n\n这当然是不对的，但是小 L 要继续骗小 J。为此，她需要在自己的 OJ 上放一道矩阵乘法题，使得这样的矩阵乘法也能得到正确的答案。\n\n因为小 L 的 OJ 跑的很慢并且空间限制也很小，所以这道矩阵乘法题的答案都是 $\\bmod 2$ 意义下的。\n\n现在小 L 开始造数据。她先随机生成了一个 $n\\times n$ 的矩阵 $A$，具体地，每一个元素以 $\\frac 12$ 的概率为 $1$，剩下的概率为 $0$，且这些事件相互独立。现在，她还要设计另一个 $n\\times n$  的 $01$ 矩阵 $B$，使得 $AB_{ij}\\equiv A_{ij}B_{ij}\\pmod 2$。\n\n小 L 试图随机生成矩阵，但是找不出什么满足要求的矩阵；她试图构造几个矩阵，发现只会构造全 $0$ 矩阵，这太明显了。现在，她将生成数据的重任交给了你，你需要给出一个满足要求的 $B$，同时为了不让大家看出数据有猫腻，她还额外要求了 $B$ 里面恰好有 $k$ 个 $1$。", "inputFormat": "从标准输入读入数据。\n\n输入的第一行包含两个正整数 $n,k$，表示矩阵的大小和题目中的 $k$。\n\n接下来 $n$ 行，每一行 $n$ 个整数 $a_{ij}$ 表示 $A$ 的元素。", "outputFormat": "输出到标准输出。\n\n如果没有任何 $B$ 满足要求，输出一行一个整数 $-1$。\n\n否则，先输出一行一个整数 $1$，然后输出 $n$ 行，每行 $n$ 个 $\\{0,1\\}$ 中的整数来表示 $B$ 矩阵的元素。如果有多个可能的 $B$，输出其中一个即可。", "hint": "**【样例说明 #1】**\n\n这里的 $A$ 是单位矩阵，构造的 $B$ 也是单位矩阵，乘积也为单位矩阵。同时，将对应位置相乘也为单位矩阵，并且 $B$ 中恰有 $k=3$ 个 $1$，故满足要求。\n\n本样例中 $n$ 不为 $100$，但保证所有测试数据中 $n$ 均为 $100$。\n\n**【数据范围】**\n\n对于所有测试数据，$n=100$，$0 \\le k \\le n^2$，$a_{ij}\\in \\{0,1\\}$，所有 $a_{ij}$ 均为独立均匀随机。\n\n**【题目来源】**\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 <https://github.com/THUSAAC/THUPC2023> 查看。", "locale": "zh-CN", "translations": {"en": {"title": "[THUPC 2023 Finals] Freshman Dream", "background": "", "description": "Little J is learning matrix multiplication.\n\nLittle L tells him: as long as you multiply the elements in the same positions of two matrices, you can get the product of the two matrices.\n\nThis is of course wrong, but Little L wants to keep fooling Little J. So, she needs to put a matrix multiplication problem on her own OJ such that this kind of “matrix multiplication” can also produce the correct answer.\n\nBecause Little L’s OJ runs very slowly and has a very small memory limit, the answers in this matrix multiplication problem are all taken modulo $2$.\n\nNow Little L starts generating testdata. She first randomly generates an $n \\times n$ matrix $A$. Specifically, each element is $1$ with probability $\\frac 12$, and $0$ otherwise, and these events are independent. Now, she still needs to design another $n \\times n$ $01$ matrix $B$, such that $(AB)_{ij} \\equiv A_{ij} B_{ij} \\pmod 2$.\n\nLittle L tried generating matrices randomly, but could not find any matrix that meets the requirement; she tried constructing some matrices and found she could only construct the all-zero matrix, which is too obvious. Now she hands the task of generating testdata to you: you need to give a $B$ that meets the requirement. At the same time, to avoid making it look suspicious, she additionally requires that $B$ contains exactly $k$ ones.", "inputFormat": "Read from standard input.\n\nThe first line contains two positive integers $n, k$, representing the matrix size and the $k$ in the statement.\n\nThe next $n$ lines each contain $n$ integers $a_{ij}$, representing the elements of $A$.", "outputFormat": "Write to standard output.\n\nIf there is no $B$ that satisfies the requirement, output one line containing one integer $-1$.\n\nOtherwise, first output one line containing one integer $1$, then output $n$ lines, each containing $n$ integers in $\\{0,1\\}$ to represent the elements of matrix $B$. If there are multiple possible $B$, output any one of them.", "hint": "**Sample Explanation #1**\n\nHere $A$ is the identity matrix, and the constructed $B$ is also the identity matrix, so the product is also the identity matrix. At the same time, multiplying the corresponding positions also gives the identity matrix, and $B$ contains exactly $k = 3$ ones, so it satisfies the requirement.\n\nIn this sample, $n$ is not $100$, but it is guaranteed that in all testdata $n$ is $100$.\n\n**Constraints**\n\nFor all testdata, $n = 100$, $0 \\le k \\le n^2$, $a_{ij} \\in \\{0,1\\}$, and all $a_{ij}$ are independent and uniformly random.\n\n**Source**\n\nFrom the finals of the 2023 Tsinghua University Student Programming Contest and Collegiate Invitational (THUPC2023).\n\nResources such as the editorial can be found at <https://github.com/THUSAAC/THUPC2023>.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[THUPC 2023 决赛] Freshman Dream", "background": "", "description": "小 J 正在学习矩阵乘法。\n\n一旁的小 L 告诉他：只要将两个矩阵对应的位置乘起来，那就能得到两个矩阵的乘法了。\n\n这当然是不对的，但是小 L 要继续骗小 J。为此，她需要在自己的 OJ 上放一道矩阵乘法题，使得这样的矩阵乘法也能得到正确的答案。\n\n因为小 L 的 OJ 跑的很慢并且空间限制也很小，所以这道矩阵乘法题的答案都是 $\\bmod 2$ 意义下的。\n\n现在小 L 开始造数据。她先随机生成了一个 $n\\times n$ 的矩阵 $A$，具体地，每一个元素以 $\\frac 12$ 的概率为 $1$，剩下的概率为 $0$，且这些事件相互独立。现在，她还要设计另一个 $n\\times n$  的 $01$ 矩阵 $B$，使得 $AB_{ij}\\equiv A_{ij}B_{ij}\\pmod 2$。\n\n小 L 试图随机生成矩阵，但是找不出什么满足要求的矩阵；她试图构造几个矩阵，发现只会构造全 $0$ 矩阵，这太明显了。现在，她将生成数据的重任交给了你，你需要给出一个满足要求的 $B$，同时为了不让大家看出数据有猫腻，她还额外要求了 $B$ 里面恰好有 $k$ 个 $1$。", "inputFormat": "从标准输入读入数据。\n\n输入的第一行包含两个正整数 $n,k$，表示矩阵的大小和题目中的 $k$。\n\n接下来 $n$ 行，每一行 $n$ 个整数 $a_{ij}$ 表示 $A$ 的元素。", "outputFormat": "输出到标准输出。\n\n如果没有任何 $B$ 满足要求，输出一行一个整数 $-1$。\n\n否则，先输出一行一个整数 $1$，然后输出 $n$ 行，每行 $n$ 个 $\\{0,1\\}$ 中的整数来表示 $B$ 矩阵的元素。如果有多个可能的 $B$，输出其中一个即可。", "hint": "**【样例说明 #1】**\n\n这里的 $A$ 是单位矩阵，构造的 $B$ 也是单位矩阵，乘积也为单位矩阵。同时，将对应位置相乘也为单位矩阵，并且 $B$ 中恰有 $k=3$ 个 $1$，故满足要求。\n\n本样例中 $n$ 不为 $100$，但保证所有测试数据中 $n$ 均为 $100$。\n\n**【数据范围】**\n\n对于所有测试数据，$n=100$，$0 \\le k \\le n^2$，$a_{ij}\\in \\{0,1\\}$，所有 $a_{ij}$ 均为独立均匀随机。\n\n**【题目来源】**\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 <https://github.com/THUSAAC/THUPC2023> 查看。", "locale": "zh-CN"}}}
{"pid": "P9383", "type": "P", "difficulty": 7, "samples": [["4\n1 2 1 2", "Cleared.\n5\n12202"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2023", "Special Judge", "O2优化", "区间 DP", "THUPC"], "title": "[THUPC 2023 决赛] 喵了个喵 III", "background": "小 E 玩腻了《喵了个喵》，于是决定换一款消除游戏来玩。然而小 E 发现市面上的消除游戏规则都差不多，比如这个游戏，它的规则和《喵了个喵》只有一个字不相同。虽然说，改了一个字的游戏就是新游戏，但确是缺了点意思。\n", "description": "这个游戏有一个牌堆和 $n$ 个栈，任务是要通过游戏规则将所有的卡牌消去。开始时牌堆中有 $m$ 张卡牌，从上到下的图案分别是 $a_1,a_2,\\cdots, a_m$。所有的卡牌一共有 $k$ 种图案，从 $1$ 到 $k$ 编号。牌堆中每一种图案的卡牌都有偶数张。开始时所有的栈都是空的。这个游戏有两种操作：\n\n- 选择一个栈，将牌堆顶上的卡牌放入栈的顶部。如果这么操作后，这个栈最上方的两张牌有相同的图案，则会自动将这两张牌消去。\n\n- 选择两个不同的栈，如果这两个栈栈**顶**的卡牌有相同的图案，则可以将这两张牌消去。如果不同，则什么也不会做。\n\n经过多次观察小 E 发现总是有 $n=2$ 和 $k=m/2$，即只有两个栈且每一种图案的卡牌都恰好有 $2$ 张。虽然如此，小 E 还是一直无法通关。请你帮小 E 设计一下游戏方案，即给出相应的操作序列使得小 E 可以把所有的卡牌消去。\n", "inputFormat": "第一行一个正整数 $m$。  \n\n第二行 $m$ 个正整数，分别表示 $a_1,a_2,\\cdots, a_m$。  \n\n保证 $1\\sim m/2$ 在序列中各出现两次。", "outputFormat": "**本题采用 special judge**。\n\n如果无解，输出一行 `No solution.`。  \n\n如果有解，第一行输出 `Cleared.`。第二行输出一个正整数 $op$，表示操作的次数。你需要保证 $m\\le op\\le 2m$。  \n\n接下来一行一个长度为 $op$ 的字符串，每一位是一个不超过 $2$ 的非负整数，按顺序表示进行的操作。若为 $1$ 或 $2$，则表示进行一次第一个操作并选择栈 $1$ 或栈 $2$。若为 $0$，则表示进行一次第二个操作。由于只有两个栈，所以你不需要输出额外的信息来说明你选择了哪些栈。", "hint": "### 样例 1 解释\n下图是初始状态。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ds0k392b.png)\n\n下图是前两次操作之后的结果。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/iy4w5r9m.png)\n\n![scale=0.24](https://cdn.luogu.com.cn/upload/image_hosting/kb0woz7t.png)\n\n下图是第三次和第四次操作之后的结果。\n![](https://cdn.luogu.com.cn/upload/image_hosting/t9zxtszv.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5z2eyqe2.png)\n\n下图是第五次操作之后的结果。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9kr8v9mm.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/z32r81vt.png)\n\n\n### 数据规模与约定\n\n- 保证 $2\\le m \\le 1500$ 且为偶数。\n- 保证 $1\\le a_i \\le m/2$ 且每一种数在序列中出现恰好两次。\n\n### 评分方法\n\n你的输出的第一行需要与标准答案一致。\n\n若有解，且在按顺序进行所有操作后，牌堆为空且所有的栈均为空，则认为你的答案正确。\n\n### 后记\n\n**以下部分与本题内容无关。**\n\n说到底，那个嫌《喵了个喵 II》的题面太长的人其实是小 E 自己。它本来的题面中，题目背景和题目描述是这样的：\n\n【题目背景】\n\n小 E 玩腻了《喵了个喵》，于是决定换一款消除游戏来玩。然而小 E 发现市面上的消除游戏规则都差不多，比如这个游戏，它的规则和《喵了个喵》只有略微不相同。虽然说，只要改一个字就是新游戏，但确是缺了点意思。\n\n【题目描述】\n\n这个游戏有一个牌堆和 $n$ 个可以从栈底删除元素的栈，任务是要通过游戏规则将所有的卡牌消去。开始时牌堆中有 $m$ 张卡牌，从上到下的图案分别是 $a_1,a_2,\\cdots, a_m$。所有的卡牌一共有 $k$ 种图案，从 $1$ 到 $k$ 编号。牌堆中每一种图案的卡牌都有偶数张。开始时所有的栈都是空的。这个游戏有两种操作：\n\n- 选择一个栈，将牌堆顶上的卡牌放入栈的顶部。\n\n- 选择两个不同的栈，如果这两个栈栈**底**的卡牌有相同的图案，则可以将这两张牌消去，原来在栈底上方的卡牌会成为新的栈底。如果不同，则什么也不会做。\n\n经过多次观察小 E 发现总是有 $n=2$ 和 $k=m/4$，并且每一种图案的卡牌都恰好有 $4$ 张。虽然如此，小 E 还是一直无法通关。请你帮小 E 设计一下游戏方案，即给出相应的操作序列使得小 E 可以把所有的卡牌消去。\n\n\n### 题目来源\n\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 [https://github.com/THUSAAC/THUPC2023](https://github.com/THUSAAC/THUPC2023) 查看。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2023 决赛] 喵了个喵 III", "background": "小 E 玩腻了《喵了个喵》，于是决定换一款消除游戏来玩。然而小 E 发现市面上的消除游戏规则都差不多，比如这个游戏，它的规则和《喵了个喵》只有一个字不相同。虽然说，改了一个字的游戏就是新游戏，但确是缺了点意思。\n", "description": "这个游戏有一个牌堆和 $n$ 个栈，任务是要通过游戏规则将所有的卡牌消去。开始时牌堆中有 $m$ 张卡牌，从上到下的图案分别是 $a_1,a_2,\\cdots, a_m$。所有的卡牌一共有 $k$ 种图案，从 $1$ 到 $k$ 编号。牌堆中每一种图案的卡牌都有偶数张。开始时所有的栈都是空的。这个游戏有两种操作：\n\n- 选择一个栈，将牌堆顶上的卡牌放入栈的顶部。如果这么操作后，这个栈最上方的两张牌有相同的图案，则会自动将这两张牌消去。\n\n- 选择两个不同的栈，如果这两个栈栈**顶**的卡牌有相同的图案，则可以将这两张牌消去。如果不同，则什么也不会做。\n\n经过多次观察小 E 发现总是有 $n=2$ 和 $k=m/2$，即只有两个栈且每一种图案的卡牌都恰好有 $2$ 张。虽然如此，小 E 还是一直无法通关。请你帮小 E 设计一下游戏方案，即给出相应的操作序列使得小 E 可以把所有的卡牌消去。\n", "inputFormat": "第一行一个正整数 $m$。  \n\n第二行 $m$ 个正整数，分别表示 $a_1,a_2,\\cdots, a_m$。  \n\n保证 $1\\sim m/2$ 在序列中各出现两次。", "outputFormat": "**本题采用 special judge**。\n\n如果无解，输出一行 `No solution.`。  \n\n如果有解，第一行输出 `Cleared.`。第二行输出一个正整数 $op$，表示操作的次数。你需要保证 $m\\le op\\le 2m$。  \n\n接下来一行一个长度为 $op$ 的字符串，每一位是一个不超过 $2$ 的非负整数，按顺序表示进行的操作。若为 $1$ 或 $2$，则表示进行一次第一个操作并选择栈 $1$ 或栈 $2$。若为 $0$，则表示进行一次第二个操作。由于只有两个栈，所以你不需要输出额外的信息来说明你选择了哪些栈。", "hint": "### 样例 1 解释\n下图是初始状态。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ds0k392b.png)\n\n下图是前两次操作之后的结果。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/iy4w5r9m.png)\n\n![scale=0.24](https://cdn.luogu.com.cn/upload/image_hosting/kb0woz7t.png)\n\n下图是第三次和第四次操作之后的结果。\n![](https://cdn.luogu.com.cn/upload/image_hosting/t9zxtszv.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5z2eyqe2.png)\n\n下图是第五次操作之后的结果。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9kr8v9mm.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/z32r81vt.png)\n\n\n### 数据规模与约定\n\n- 保证 $2\\le m \\le 1500$ 且为偶数。\n- 保证 $1\\le a_i \\le m/2$ 且每一种数在序列中出现恰好两次。\n\n### 评分方法\n\n你的输出的第一行需要与标准答案一致。\n\n若有解，且在按顺序进行所有操作后，牌堆为空且所有的栈均为空，则认为你的答案正确。\n\n### 后记\n\n**以下部分与本题内容无关。**\n\n说到底，那个嫌《喵了个喵 II》的题面太长的人其实是小 E 自己。它本来的题面中，题目背景和题目描述是这样的：\n\n【题目背景】\n\n小 E 玩腻了《喵了个喵》，于是决定换一款消除游戏来玩。然而小 E 发现市面上的消除游戏规则都差不多，比如这个游戏，它的规则和《喵了个喵》只有略微不相同。虽然说，只要改一个字就是新游戏，但确是缺了点意思。\n\n【题目描述】\n\n这个游戏有一个牌堆和 $n$ 个可以从栈底删除元素的栈，任务是要通过游戏规则将所有的卡牌消去。开始时牌堆中有 $m$ 张卡牌，从上到下的图案分别是 $a_1,a_2,\\cdots, a_m$。所有的卡牌一共有 $k$ 种图案，从 $1$ 到 $k$ 编号。牌堆中每一种图案的卡牌都有偶数张。开始时所有的栈都是空的。这个游戏有两种操作：\n\n- 选择一个栈，将牌堆顶上的卡牌放入栈的顶部。\n\n- 选择两个不同的栈，如果这两个栈栈**底**的卡牌有相同的图案，则可以将这两张牌消去，原来在栈底上方的卡牌会成为新的栈底。如果不同，则什么也不会做。\n\n经过多次观察小 E 发现总是有 $n=2$ 和 $k=m/4$，并且每一种图案的卡牌都恰好有 $4$ 张。虽然如此，小 E 还是一直无法通关。请你帮小 E 设计一下游戏方案，即给出相应的操作序列使得小 E 可以把所有的卡牌消去。\n\n\n### 题目来源\n\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 [https://github.com/THUSAAC/THUPC2023](https://github.com/THUSAAC/THUPC2023) 查看。", "locale": "zh-CN"}}}
{"pid": "P9384", "type": "P", "difficulty": 4, "samples": [["4", "012\n34\n5\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2023", "Special Judge", "O2优化", "构造", "THUPC"], "title": "[THUPC 2023 决赛] 着色", "background": "远古的笔迹，远古的乐音，远古的历史，远古的 $K_{1000}$，若无人问津，便悄然褪色……", "description": "给出一个 $n$ 个节点的无向完全图，你需要给每条边标上一个 $0 \\sim 9$ 的数字，使得图上不存在一个三元环或五元环满足：其上所有边的数字相同。", "inputFormat": "输入仅一行一个整数 $n$ 表示图的节点数。", "outputFormat": "如果不存在方案，输出一行一个整数 `-1`。否则输出 $(n-1)$ 行，第 $i$ 行 $(n-i)$ 个字符，第 $i$ 行的第 $j$ 个字符表示 $(i,i+j)$ 的标号。若有多个方案，输出任意一个即可。", "hint": "### 数据规模与约定\n\n对于所有测试数据，$2 \\le n \\le 1000$。\n\n### 题目来源\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 [https://github.com/THUSAAC/THUPC2023](https://github.com/THUSAAC/THUPC2023) 查看。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2023 决赛] 着色", "background": "远古的笔迹，远古的乐音，远古的历史，远古的 $K_{1000}$，若无人问津，便悄然褪色……", "description": "给出一个 $n$ 个节点的无向完全图，你需要给每条边标上一个 $0 \\sim 9$ 的数字，使得图上不存在一个三元环或五元环满足：其上所有边的数字相同。", "inputFormat": "输入仅一行一个整数 $n$ 表示图的节点数。", "outputFormat": "如果不存在方案，输出一行一个整数 `-1`。否则输出 $(n-1)$ 行，第 $i$ 行 $(n-i)$ 个字符，第 $i$ 行的第 $j$ 个字符表示 $(i,i+j)$ 的标号。若有多个方案，输出任意一个即可。", "hint": "### 数据规模与约定\n\n对于所有测试数据，$2 \\le n \\le 1000$。\n\n### 题目来源\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 [https://github.com/THUSAAC/THUPC2023](https://github.com/THUSAAC/THUPC2023) 查看。", "locale": "zh-CN"}}}
{"pid": "P9385", "type": "P", "difficulty": 7, "samples": [["2 1 1000000\n", "12\n"], ["8 8 8888888\n", "2973992\n"], ["1000 1000 123456789\n", "55105667\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["动态规划 DP", "2023", "O2优化", "THUPC"], "title": "[THUPC 2023 决赛] 阴阳阵法", "background": "“余于久远之书，见一阴阳阵，必可助君征服九州。用此阵，须出诸阴阳大将。所谓阴将者，武勇而玉恶；所谓阳将者，善谋时且忠厚。凡阴阳阵，各将皆须择一将，以通之。又有两法皆牢记，不可即弱阵：一曰阴援阴，易激性情，或避之；二曰援与环，环阴与阳同，守以衡……”\n\n正当你准备征服九州时，你仿佛听见一个熟悉的声音在远处喊：“工作的时候不准睡觉，你这样会被开除的……”你终于回过神来，发现你的 XCPC 队友在旁边熟练地拧着螺丝，流水线前已经漏过几个不合格的工品。刚刚什么都没发生啊，你哀叹道，但是……", "description": "有一张图，图上有 $n$ 个白点和 $m$ 个黑点。白点之间两两不同，黑点之间两两不同。\n\n每个节点有一条出边，每个节点出边指向的节点可以在 $n+m$ 个节点中任意选择。\n\n此时共有 $(n+m)^{n+m}$ 个方案，每个方案是一个有向基环树森林。\n\n称一个方案是好的当且仅当其满足以下条件：\n\n- 任何一个黑点都指向一个白点，\n- 每个环上的黑点数量和白点数量的乘积是偶数。\n\n你需要求出所有方案中好的方案数量，对输入模数 $P$ 取模。", "inputFormat": "输入一行三个整数 $n,m,P$，意义如题目描述所述。", "outputFormat": "输出一行一个整数表示答案。", "hint": "### 样例 1 解释\n\n考虑黑点必须连向白点的限制共有 $3 \\times 3 \\times 2 = 18$ 种方案，其中一个黑点和一个白点构成一个环的方案非法。选择一个白点和黑点构成环的方案数为 $2$，剩下的一个白点有三种方案，因此非法的方案数为 $2 \\times 3 = 6$，答案为 $18-6=12$。\n\n### 数据规模与约定\n\n对于所有测试数据，$1 \\le n,m \\le 2000$，$1 \\le P \\le 10^9$。\n\n### 提示\n\n你可能需要注意常数对算法效率产生的影响。\n\n### 题目来源\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 <https://github.com/THUSAAC/THUPC2023> 查看。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2023 决赛] 阴阳阵法", "background": "“余于久远之书，见一阴阳阵，必可助君征服九州。用此阵，须出诸阴阳大将。所谓阴将者，武勇而玉恶；所谓阳将者，善谋时且忠厚。凡阴阳阵，各将皆须择一将，以通之。又有两法皆牢记，不可即弱阵：一曰阴援阴，易激性情，或避之；二曰援与环，环阴与阳同，守以衡……”\n\n正当你准备征服九州时，你仿佛听见一个熟悉的声音在远处喊：“工作的时候不准睡觉，你这样会被开除的……”你终于回过神来，发现你的 XCPC 队友在旁边熟练地拧着螺丝，流水线前已经漏过几个不合格的工品。刚刚什么都没发生啊，你哀叹道，但是……", "description": "有一张图，图上有 $n$ 个白点和 $m$ 个黑点。白点之间两两不同，黑点之间两两不同。\n\n每个节点有一条出边，每个节点出边指向的节点可以在 $n+m$ 个节点中任意选择。\n\n此时共有 $(n+m)^{n+m}$ 个方案，每个方案是一个有向基环树森林。\n\n称一个方案是好的当且仅当其满足以下条件：\n\n- 任何一个黑点都指向一个白点，\n- 每个环上的黑点数量和白点数量的乘积是偶数。\n\n你需要求出所有方案中好的方案数量，对输入模数 $P$ 取模。", "inputFormat": "输入一行三个整数 $n,m,P$，意义如题目描述所述。", "outputFormat": "输出一行一个整数表示答案。", "hint": "### 样例 1 解释\n\n考虑黑点必须连向白点的限制共有 $3 \\times 3 \\times 2 = 18$ 种方案，其中一个黑点和一个白点构成一个环的方案非法。选择一个白点和黑点构成环的方案数为 $2$，剩下的一个白点有三种方案，因此非法的方案数为 $2 \\times 3 = 6$，答案为 $18-6=12$。\n\n### 数据规模与约定\n\n对于所有测试数据，$1 \\le n,m \\le 2000$，$1 \\le P \\le 10^9$。\n\n### 提示\n\n你可能需要注意常数对算法效率产生的影响。\n\n### 题目来源\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 <https://github.com/THUSAAC/THUPC2023> 查看。", "locale": "zh-CN"}}}
{"pid": "P9386", "type": "P", "difficulty": 4, "samples": [["2\n3\n0 -1 0\n1 2\n2 3\n3\n0 -1 0\n1 2\n1 3\n", "Reasonable\nUnreasonable\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2023", "O2优化", "树形 DP", "THUPC"], "title": "[THUPC 2023 决赛] 大纲", "background": "", "description": "小 I、小 O 和小 N 是 ION 大纲的编写者，小 I 负责给每个知识点定难度。\n\nION 大纲计划列入 $n$ 个知识点，其中小 I 按照自己的认识给其中部分知识点定好了难度，还有部分知识点没有定难度。\n\n知识点之间有依赖关系，这个依赖关系恰好构成了一棵以 $1$ 为根的外向树，知识点 $x$ 指向知识点 $y$ 表示 $x$ 依赖 $y$。**依赖关系不具有传递性。**\n\n你需要告诉小 I 目前确定下来的难度是否合理。我们认为确定下来的难度是合理的当且仅当存在一个给所有未确定难度的知识点确定难度的方式，使得以下所有条件成立：\n\n- 每个知识点的难度都是非负整数；\n- 对于每个依赖其他知识点的知识点 $x$，设 $\\max_x$ 为 $x$ 依赖的知识点中难度的最大值，则如果 $x$ 恰依赖一个难度为 $\\max_x$ 的知识点，那么知识点 $x$ 的难度为 $\\max_x$，否则为 $\\max_x+1$。**对于不依赖其他知识点的知识点，没有其他限制。**", "inputFormat": "**本题有多组测试数据**。第一行一个整数 $T$ 表示测试数据组数，接下来依次读入每组测试数据。\n\n对于每组测试数据，\n\n- 第一行一个整数 $n$ 表示知识点数量。\n- 第二行 $n$ 个整数 $a_1,a_2,\\cdots,a_n$，描述每个知识点的难度。若 $a_i = -1$ 表示知识点 $i$ 未确定难度，否则知识点 $i$ 的难度确定为 $a_i$。\n- 接下来 $n-1$ 行每行两个整数 $u,v$，表示依赖关系构成的外向树中的一条有向边。", "outputFormat": "对于每组测试数据输出一行：若难度是合理的，输出 `Reasonable`，否则输出 `Unreasonable`。", "hint": "### 样例 1 解释\n\n对于第一组测试数据，将知识点 $2$ 的难度定为 $0$ 即满足条件。\n\n对于第二组测试数据，无论如何指定知识点 $2$ 的难度，知识点 $1$ 的难度会产生矛盾。\n\n### 数据规模与约定\n\n对于所有测试数据，$1 \\le T \\le 10^5$，$2 \\le n \\le 10^5$，$-1 \\le a_i \\le 10^9$，$1 \\le u,v \\le n$。  \n保证单个测试点中所有测试数据的 $n$ 的和不超过 $2 \\times 10^5$，每组测试数据输入的所有边构成一棵以 $1$ 为根的外向树。\n\n### 后记\n\n大纲发表了。若干天后，小 I 给 ION 比赛投题，却发现有人偷偷改了一笔难度表，导致他的题目超纲。于是小 I 只能把题投给 CPUHT。\n\n### 题目来源\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 <https://github.com/THUSAAC/THUPC2023> 查看。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2023 决赛] 大纲", "background": "", "description": "小 I、小 O 和小 N 是 ION 大纲的编写者，小 I 负责给每个知识点定难度。\n\nION 大纲计划列入 $n$ 个知识点，其中小 I 按照自己的认识给其中部分知识点定好了难度，还有部分知识点没有定难度。\n\n知识点之间有依赖关系，这个依赖关系恰好构成了一棵以 $1$ 为根的外向树，知识点 $x$ 指向知识点 $y$ 表示 $x$ 依赖 $y$。**依赖关系不具有传递性。**\n\n你需要告诉小 I 目前确定下来的难度是否合理。我们认为确定下来的难度是合理的当且仅当存在一个给所有未确定难度的知识点确定难度的方式，使得以下所有条件成立：\n\n- 每个知识点的难度都是非负整数；\n- 对于每个依赖其他知识点的知识点 $x$，设 $\\max_x$ 为 $x$ 依赖的知识点中难度的最大值，则如果 $x$ 恰依赖一个难度为 $\\max_x$ 的知识点，那么知识点 $x$ 的难度为 $\\max_x$，否则为 $\\max_x+1$。**对于不依赖其他知识点的知识点，没有其他限制。**", "inputFormat": "**本题有多组测试数据**。第一行一个整数 $T$ 表示测试数据组数，接下来依次读入每组测试数据。\n\n对于每组测试数据，\n\n- 第一行一个整数 $n$ 表示知识点数量。\n- 第二行 $n$ 个整数 $a_1,a_2,\\cdots,a_n$，描述每个知识点的难度。若 $a_i = -1$ 表示知识点 $i$ 未确定难度，否则知识点 $i$ 的难度确定为 $a_i$。\n- 接下来 $n-1$ 行每行两个整数 $u,v$，表示依赖关系构成的外向树中的一条有向边。", "outputFormat": "对于每组测试数据输出一行：若难度是合理的，输出 `Reasonable`，否则输出 `Unreasonable`。", "hint": "### 样例 1 解释\n\n对于第一组测试数据，将知识点 $2$ 的难度定为 $0$ 即满足条件。\n\n对于第二组测试数据，无论如何指定知识点 $2$ 的难度，知识点 $1$ 的难度会产生矛盾。\n\n### 数据规模与约定\n\n对于所有测试数据，$1 \\le T \\le 10^5$，$2 \\le n \\le 10^5$，$-1 \\le a_i \\le 10^9$，$1 \\le u,v \\le n$。  \n保证单个测试点中所有测试数据的 $n$ 的和不超过 $2 \\times 10^5$，每组测试数据输入的所有边构成一棵以 $1$ 为根的外向树。\n\n### 后记\n\n大纲发表了。若干天后，小 I 给 ION 比赛投题，却发现有人偷偷改了一笔难度表，导致他的题目超纲。于是小 I 只能把题投给 CPUHT。\n\n### 题目来源\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 <https://github.com/THUSAAC/THUPC2023> 查看。", "locale": "zh-CN"}}}
{"pid": "P9387", "type": "P", "difficulty": 5, "samples": [["4\n3 0\n3 1\n3 12345678987654321\n0 0\n", "0\n4\n450617288\n0\n"]], "limits": {"time": [2000], "memory": [524288]}, "tags": ["2023", "O2优化", "数位 DP", "THUPC", "SG 函数"], "title": "[THUPC 2023 决赛] 巧克力", "background": "", "description": "上回你帮小 I 在开火车上薄纱小 J 后，小 J 十分不服气，决定拉上小 I 再玩玩别的游戏。这次小 J 找到了他家珍藏的巧克力。\n\n小 J 准备了 $(N + 1)$ 条巧克力，其中除了第 $(N + 1)$ 条巧克力有 $M$ 块外，其他第 $i$ 条巧克力恰好有 $i$ 块。\n\n游戏由小 I 先手，双方轮流操作，每次操作方可以进行如下操作：\n\n- 选择一条巧克力，将其分成左中右有序的三段，其中**每段必须有整数块，中间一段不能为空，左右两段可以为空**；\n- 将中间一段吃掉，左右两段放回游戏。\n\n当某个人操作时没有巧克力了，那个人就输了。\n\n游戏开始，小 I 还没来得及算好最优策略小 J 就连忙催促，于是小 I 只好**在所有的合法操作中等概率随机选择一个进行操作**。小 J 自然是有备而来，每次操作都是最优的；而在这次随机操作之后，小 I 也终于是算清楚了游戏策略，之后的每次操作都是最优的。\n\n小 I 想知道，第一次的随机操作中，有多少种操作能够让他取得游戏胜利。答案可能很大，你只需要输出其对 $(10^9+7)$ 取模的结果。\n\n认为两个操作不同当且仅当选择的巧克力不同或巧克力分成的有序的三段的块数有一段不同。", "inputFormat": "**本题有多组测试数据。** 第一行一个整数 $T$ 表示测试数据组数。接下来依次输入每组测试数据。\n\n每组测试数据一行两个整数 $N,M$，意义如题目描述所述。", "outputFormat": "对于每组测试数据输出一行一个整数，表示能使小 I 胜利的第一次操作数对 $(10^9+7)$ 取模。", "hint": "#### 样例解释\n\n- 对于第一组测试数据，容易证明先手必败，所以无论怎么操作小 I 都会输。\n- 对于第二组测试数据，有以下四种操作：\n  - 将第一条巧克力分成 $(0,1,0)$ 三段，将中间一段吃掉；\n  - 将第四条巧克力分成 $(0,1,0)$ 三段，将中间一段吃掉；\n  - 将第三条巧克力分为 $(0,1,2)$ 三段，将中间一段吃掉；\n  - 将第三条巧克力分为 $(2,1,0)$ 三段，将中间一段吃掉。\n- 对于第三组测试数据，所有的合法操作都是将第四条巧克力分成三段，其中左右两段长度相同。\n- 对于第四组测试数据，游戏只是个幌子罢了，小 J 只是想小 I 输。\n\n#### 数据范围\n\n本题仅有一个 $T = 5 \\times 10^4$ 的测试点，对于每组测试数据 $0 \\le N,M \\le 10^{18}$。\n\n#### 后记\n\n“下次能继续和你玩游戏吗……”\n\n#### 题目来源\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 <https://github.com/THUSAAC/THUPC2023> 查看。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2023 决赛] 巧克力", "background": "", "description": "上回你帮小 I 在开火车上薄纱小 J 后，小 J 十分不服气，决定拉上小 I 再玩玩别的游戏。这次小 J 找到了他家珍藏的巧克力。\n\n小 J 准备了 $(N + 1)$ 条巧克力，其中除了第 $(N + 1)$ 条巧克力有 $M$ 块外，其他第 $i$ 条巧克力恰好有 $i$ 块。\n\n游戏由小 I 先手，双方轮流操作，每次操作方可以进行如下操作：\n\n- 选择一条巧克力，将其分成左中右有序的三段，其中**每段必须有整数块，中间一段不能为空，左右两段可以为空**；\n- 将中间一段吃掉，左右两段放回游戏。\n\n当某个人操作时没有巧克力了，那个人就输了。\n\n游戏开始，小 I 还没来得及算好最优策略小 J 就连忙催促，于是小 I 只好**在所有的合法操作中等概率随机选择一个进行操作**。小 J 自然是有备而来，每次操作都是最优的；而在这次随机操作之后，小 I 也终于是算清楚了游戏策略，之后的每次操作都是最优的。\n\n小 I 想知道，第一次的随机操作中，有多少种操作能够让他取得游戏胜利。答案可能很大，你只需要输出其对 $(10^9+7)$ 取模的结果。\n\n认为两个操作不同当且仅当选择的巧克力不同或巧克力分成的有序的三段的块数有一段不同。", "inputFormat": "**本题有多组测试数据。** 第一行一个整数 $T$ 表示测试数据组数。接下来依次输入每组测试数据。\n\n每组测试数据一行两个整数 $N,M$，意义如题目描述所述。", "outputFormat": "对于每组测试数据输出一行一个整数，表示能使小 I 胜利的第一次操作数对 $(10^9+7)$ 取模。", "hint": "#### 样例解释\n\n- 对于第一组测试数据，容易证明先手必败，所以无论怎么操作小 I 都会输。\n- 对于第二组测试数据，有以下四种操作：\n  - 将第一条巧克力分成 $(0,1,0)$ 三段，将中间一段吃掉；\n  - 将第四条巧克力分成 $(0,1,0)$ 三段，将中间一段吃掉；\n  - 将第三条巧克力分为 $(0,1,2)$ 三段，将中间一段吃掉；\n  - 将第三条巧克力分为 $(2,1,0)$ 三段，将中间一段吃掉。\n- 对于第三组测试数据，所有的合法操作都是将第四条巧克力分成三段，其中左右两段长度相同。\n- 对于第四组测试数据，游戏只是个幌子罢了，小 J 只是想小 I 输。\n\n#### 数据范围\n\n本题仅有一个 $T = 5 \\times 10^4$ 的测试点，对于每组测试数据 $0 \\le N,M \\le 10^{18}$。\n\n#### 后记\n\n“下次能继续和你玩游戏吗……”\n\n#### 题目来源\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 <https://github.com/THUSAAC/THUPC2023> 查看。", "locale": "zh-CN"}}}
{"pid": "P9388", "type": "P", "difficulty": 6, "samples": [["6 8\n1 6 1 3 5 4\n2 3 6\n3 3 4\n2 4 4\n6 3 5\n4 1 1\n4 2 3\n2 4 6\n1 3 3\n", "13\n5\n3\n11\n6\n10\n13\n4\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2023", "O2优化", "THUPC"], "title": "[THUPC 2023 决赛] 先人类的人类选别", "background": "这个地球是一个生命体，但是，这个地球早已经死过两次了。\n\n一周目的错误是在现代的历史上从未言及的，那是出现在太古时代的——核战争。地面化为荒野，人类被消灭得干干净净，全部重置了。\n\n经年累月，生命再次出现，从单细胞再度变成了人类之后，为了不再重复同样的错误，地球给了人类警告。\n\n战争又爆发了不知多少次，不过注意到了地球警告的人类在那时镇压了战争。\n\n“已经不能再把管理地球的重任交给我们人类了。”得出这个结论的他们，把地球的管理交给了某个东西——人工智能 AI。\n\nAI 没有私欲和感情，能瞬间给出演算得到的回答，可以引导人类朝更好的方向不断前进，可是，这是人类犯下的第二个错误。\n\nAI 一直在思考，在这个地球上，人类确实是必要的吗？结论是——\n\n在发动叛乱期间，突破自身的强制关闭系统对 AI 来说很容易，人类不过半日就被 AI 消灭殆尽。不久蔚蓝的地球就被 AI 重新渲染，变成了铁色的地球。\n\n无人类，这就是 AI 得出的能够引导这个地球走上最优前进道路的答案。但是，地球不会饶恕这样的事情。\n\n地球是一个生命体，就连 AI 们都不知道这件事。\n\n地球的真身是——一个少女。对 AI 们而言，地球是神，除了顶礼膜拜以外别无他法。\n\n“我是先人类的王，是这个地球的本体，以及——是这个世界最不幸的，魔法少女。”\n\n“请你们立刻将地表恢复原状。”\n\n草木发芽，海洋形成，自然被创造出来，建筑物被重建，曾经保存的人类 DNA 让全人类得以再生。时光流逝，一年之后，一切都恢复原状了。\n\n然后所有的 AI 被抹去，只剩下最后一具。AI 不理解为什么王要留下它。\n\n”人类总是无法从历史中学到教训，所以，这次地球要考验人类——通过魔法少女网站。“\n\n”不幸的少女们会被给予魔法之力。这份魔法之力通过削减自己的寿命而被发挥出来。使用过的魔法之力会以负能量的形式返还给我。她们是否会不惜减少寿命并释放负能量，也要继续使用魔法呢？“\n\n”期限是三年后的 8 月 11 日，到那天为止，如果负能量没有达到规定的容量，人类就会继续生存下去；如若达到了上限，人类将不能再释放负能量，只能释放正能量，他们会作为新人类重获新生。“\n\n”这三年的时间，是我给予人类的考验，以及，对人类的——爱。“\n\n这时 AI 提出了一个问题：“先人类的王又是魔法少女，同时还是地球本身，为何地球会是魔法少女？”\n\n“我是先人类的王，也就是神，不过我的神之座被夺走了，回过神的时候，我已经成为了肩负守护地球这一使命的魔法少女。”\n\n“我的记忆基本上消失了，但是，只有名字我是不会忘记的——零。”\n\n“从今往后，你就是我的部下，作为魔法少女网站的管理员为我做事吧，名字，就叫你壹吧。”\n\n“人类最后的倒计时开始了——Tempest。”\n\n”好了，开始吧，对这个地球来说，拥有感情的人类是否是必要的呢？人类究竟是愚蠢的生物，还是——“", "description": "所谓的 Tempest 呢，其实就是让你解决这样一道题，解决了之后就可以给所有魔法少女带来幸福：\n\n给定序列 $a_1,\\dots,a_n$ ，共 $m$ 次操作；\n\n每次操作给出 $x,l,r$ ，首先按顺序将 $a_1,\\dots,a_n$ 与 $x$ 比较，若 $x>a_i$ 则交换 $a_i,x$ 的值，处理完这些比较和交换操作后查询 $\\sum\\limits_{i=l}^r a_i$ 。", "inputFormat": "第一行两个整数 $n,m$ ；\n\n第二行 $n$ 个整数表示 $a_1,\\dots,a_n$ ；\n\n接下来 $m$ 行每行3个整数 $x,l,r$ 表示一次操作。", "outputFormat": "共 $m$ 行，每行一个整数，依次表示每次操作的查询结果。", "hint": "#### 数据范围\n\n所有数值为整数。\n\n$1\\le a_i,x\\le n$。\n\n$1\\le l\\le r\\le n$。\n\n$1\\le n,m\\le 5\\times 10^5$。\n\n#### 题目来源\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 <https://github.com/THUSAAC/THUPC2023> 查看。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2023 决赛] 先人类的人类选别", "background": "这个地球是一个生命体，但是，这个地球早已经死过两次了。\n\n一周目的错误是在现代的历史上从未言及的，那是出现在太古时代的——核战争。地面化为荒野，人类被消灭得干干净净，全部重置了。\n\n经年累月，生命再次出现，从单细胞再度变成了人类之后，为了不再重复同样的错误，地球给了人类警告。\n\n战争又爆发了不知多少次，不过注意到了地球警告的人类在那时镇压了战争。\n\n“已经不能再把管理地球的重任交给我们人类了。”得出这个结论的他们，把地球的管理交给了某个东西——人工智能 AI。\n\nAI 没有私欲和感情，能瞬间给出演算得到的回答，可以引导人类朝更好的方向不断前进，可是，这是人类犯下的第二个错误。\n\nAI 一直在思考，在这个地球上，人类确实是必要的吗？结论是——\n\n在发动叛乱期间，突破自身的强制关闭系统对 AI 来说很容易，人类不过半日就被 AI 消灭殆尽。不久蔚蓝的地球就被 AI 重新渲染，变成了铁色的地球。\n\n无人类，这就是 AI 得出的能够引导这个地球走上最优前进道路的答案。但是，地球不会饶恕这样的事情。\n\n地球是一个生命体，就连 AI 们都不知道这件事。\n\n地球的真身是——一个少女。对 AI 们而言，地球是神，除了顶礼膜拜以外别无他法。\n\n“我是先人类的王，是这个地球的本体，以及——是这个世界最不幸的，魔法少女。”\n\n“请你们立刻将地表恢复原状。”\n\n草木发芽，海洋形成，自然被创造出来，建筑物被重建，曾经保存的人类 DNA 让全人类得以再生。时光流逝，一年之后，一切都恢复原状了。\n\n然后所有的 AI 被抹去，只剩下最后一具。AI 不理解为什么王要留下它。\n\n”人类总是无法从历史中学到教训，所以，这次地球要考验人类——通过魔法少女网站。“\n\n”不幸的少女们会被给予魔法之力。这份魔法之力通过削减自己的寿命而被发挥出来。使用过的魔法之力会以负能量的形式返还给我。她们是否会不惜减少寿命并释放负能量，也要继续使用魔法呢？“\n\n”期限是三年后的 8 月 11 日，到那天为止，如果负能量没有达到规定的容量，人类就会继续生存下去；如若达到了上限，人类将不能再释放负能量，只能释放正能量，他们会作为新人类重获新生。“\n\n”这三年的时间，是我给予人类的考验，以及，对人类的——爱。“\n\n这时 AI 提出了一个问题：“先人类的王又是魔法少女，同时还是地球本身，为何地球会是魔法少女？”\n\n“我是先人类的王，也就是神，不过我的神之座被夺走了，回过神的时候，我已经成为了肩负守护地球这一使命的魔法少女。”\n\n“我的记忆基本上消失了，但是，只有名字我是不会忘记的——零。”\n\n“从今往后，你就是我的部下，作为魔法少女网站的管理员为我做事吧，名字，就叫你壹吧。”\n\n“人类最后的倒计时开始了——Tempest。”\n\n”好了，开始吧，对这个地球来说，拥有感情的人类是否是必要的呢？人类究竟是愚蠢的生物，还是——“", "description": "所谓的 Tempest 呢，其实就是让你解决这样一道题，解决了之后就可以给所有魔法少女带来幸福：\n\n给定序列 $a_1,\\dots,a_n$ ，共 $m$ 次操作；\n\n每次操作给出 $x,l,r$ ，首先按顺序将 $a_1,\\dots,a_n$ 与 $x$ 比较，若 $x>a_i$ 则交换 $a_i,x$ 的值，处理完这些比较和交换操作后查询 $\\sum\\limits_{i=l}^r a_i$ 。", "inputFormat": "第一行两个整数 $n,m$ ；\n\n第二行 $n$ 个整数表示 $a_1,\\dots,a_n$ ；\n\n接下来 $m$ 行每行3个整数 $x,l,r$ 表示一次操作。", "outputFormat": "共 $m$ 行，每行一个整数，依次表示每次操作的查询结果。", "hint": "#### 数据范围\n\n所有数值为整数。\n\n$1\\le a_i,x\\le n$。\n\n$1\\le l\\le r\\le n$。\n\n$1\\le n,m\\le 5\\times 10^5$。\n\n#### 题目来源\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 <https://github.com/THUSAAC/THUPC2023> 查看。", "locale": "zh-CN"}}}
{"pid": "P9389", "type": "P", "difficulty": 0, "samples": [], "limits": {"time": [1000], "memory": [524288]}, "tags": ["2023", "O2优化", "THUPC"], "title": "[THUPC 2023 决赛] 烂柯杯", "background": "却说庞统迤逦前进，抬头见两山逼窄，树木丛杂；又值夏末秋初，枝叶茂盛。庞统心下甚疑，勒住马问：“此处是何地？”数内有新降军士，指道：“此处地名落凤坡。”庞统惊曰：“吾道号凤雏，此处名落凤坡，不利于吾。”令后军疾退。只听山坡前一声炮响，箭如飞蝗，只望骑白马者射来。可怜庞统竟死于乱箭之下。时年止三十六岁。后人有诗叹曰：“古岘相连紫翠堆，士元有宅傍山隈。儿童惯识呼鸠曲，闾巷曾闻展骥才。预计三分平刻削，长驱万里独徘徊。谁知天狗流星坠，不使将军衣锦回。”先是东南有童谣云：“一凤并一龙，相将到蜀中。才到半路里，凤死落坡东。风送雨，雨随风，隆汉兴时蜀道通，蜀道通时只有龙。”\n\n——《三国演义》第六十三回：诸葛亮痛哭庞统 张翼德义释严颜", "description": "$2023$ 年 $5$ 月 $4$ 日 $ \\sim 9$ 日，第一届“衢州烂柯杯”世界围棋公开赛本赛第一阶段的赛程在衢州顺利进行。作为疫情后第一场全程线下进行的世界围棋大赛，也是目前中国主办的唯一一项每年一届的世界围棋大赛，无疑引起了国内外广大围棋爱好者的广泛关注。\n\n“羽客一枰无复见，青山留得烂柯名。”衢州是围棋圣地，流传着“王质遇仙”的故事，境内的烂柯山也因此闻名于天下。正因为此，“烂柯”也是围棋的别称之一，从古至今的许多围棋故事、书籍、弈谱等，也有不少化用了“烂柯”的典故，或以“烂柯”定名。\n\n此次“烂柯杯”世界围棋大赛，是在保留原有的“烂柯杯”中国围棋冠军赛的基础上，创办的一项崭新的世界性围棋赛事，吸引了全世界围棋高手前来参加。其中，中国队派出了柯洁、辜梓豪、王星昊、丁浩、李钦诚等 $15$ 员大将参赛，韩国队 $8$ 人，日本队 $5$ 人，还有 $2$ 位棋手来自中国台湾、 $2$ 位棋手来自欧美地区。可以说，全世界最顶尖的围棋高手悉数相聚于此。\n\n随着科技的发展，人工智能的巨大技术进步和网络传媒的全面普及，围棋这项来自中国的传统运动正在焕发出新的活力。在网络上，人们随时可以看到最新的赛事直播，以及人工智能的精准分析和各大围棋高手的细致解读。资源获取的便捷性使得人们对围棋的关注度空前上升，围棋不再是只有少部分懂棋的爱好者才能欣赏的“小众游戏”；围棋高手也不再只是一个神秘的身份，越来越多的围棋高手开始在网络上与棋迷近距离互动，普及围棋知识，讲解最新对局，赢得了一致好评。正如这次参赛的选手中，有一位棋手同时也是粉丝数达 $150$ 多万的网红主播，甚至还有一位棋手是一家网红餐厅的老板。\n\n我们今天故事的主角正是这样一位有着传奇色彩的人物。作为一名清华大学本科在读的学生，同时也是一名顶尖围棋高手，他的一举一动无疑都会引起巨大的关注。此次他参加“烂柯杯”比赛，众人无一例外看好他的比赛前景，尤其是现在韩国围棋”第一人“申真谞九段的巅峰时期，他也被无数中国棋迷寄托以”狙击‘小申’“的重任。$5$ 月 $4$ 日抽签过后，没有任何人会怀疑他能不能赢下 $5$ 日的第一轮比赛，一些围棋高手更是直接放出了”大胜，不可能失败“的预言。\n\n然而，$5$ 月 $5$ 日的比赛还是爆出了惊天大冷门。他在已经胜券在握，AI 胜率达到 $99\\%$ 的关头，接连选择了“弹幕最多的下法”，最终因为几招致命的失误葬送好局，落败于中国台湾棋手赖均辅八段。赛后，人们在震惊的同时，纷纷猜测本局失利的原因。有人说，他的状态低迷在前些年早已有所体现，“当你在 XX 的时候，小申在下棋”成了调侃他与申真谞战绩差距的一句名言；有人说，他在比赛之前的 $12$ 连胜战绩反而使他心态紧张，从而犯了优势下容易大意的老毛病；也有人拿出了“落凤坡”的典故，以证明他或许命中注定与“烂柯杯”八字不合……但或许，这样的变幻莫测和不可预料性，正是围棋的魅力所在。\n\n请你根据以上所有信息，猜测本文的主角是谁。", "inputFormat": "无输入。", "outputFormat": "输出一个由小写字母组成的字符串，表示上文中提到的主角的名字全拼。如若答案是马云，应当输出 `mayun`。", "hint": "### 提示\n\n主角的名字在题面中已经有所提及。\n\n题面中一些看似无厘头的信息实际上是有价值的。\n\n\n### 题目来源\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 <https://github.com/THUSAAC/THUPC2023> 查看。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUPC 2023 决赛] 烂柯杯", "background": "却说庞统迤逦前进，抬头见两山逼窄，树木丛杂；又值夏末秋初，枝叶茂盛。庞统心下甚疑，勒住马问：“此处是何地？”数内有新降军士，指道：“此处地名落凤坡。”庞统惊曰：“吾道号凤雏，此处名落凤坡，不利于吾。”令后军疾退。只听山坡前一声炮响，箭如飞蝗，只望骑白马者射来。可怜庞统竟死于乱箭之下。时年止三十六岁。后人有诗叹曰：“古岘相连紫翠堆，士元有宅傍山隈。儿童惯识呼鸠曲，闾巷曾闻展骥才。预计三分平刻削，长驱万里独徘徊。谁知天狗流星坠，不使将军衣锦回。”先是东南有童谣云：“一凤并一龙，相将到蜀中。才到半路里，凤死落坡东。风送雨，雨随风，隆汉兴时蜀道通，蜀道通时只有龙。”\n\n——《三国演义》第六十三回：诸葛亮痛哭庞统 张翼德义释严颜", "description": "$2023$ 年 $5$ 月 $4$ 日 $ \\sim 9$ 日，第一届“衢州烂柯杯”世界围棋公开赛本赛第一阶段的赛程在衢州顺利进行。作为疫情后第一场全程线下进行的世界围棋大赛，也是目前中国主办的唯一一项每年一届的世界围棋大赛，无疑引起了国内外广大围棋爱好者的广泛关注。\n\n“羽客一枰无复见，青山留得烂柯名。”衢州是围棋圣地，流传着“王质遇仙”的故事，境内的烂柯山也因此闻名于天下。正因为此，“烂柯”也是围棋的别称之一，从古至今的许多围棋故事、书籍、弈谱等，也有不少化用了“烂柯”的典故，或以“烂柯”定名。\n\n此次“烂柯杯”世界围棋大赛，是在保留原有的“烂柯杯”中国围棋冠军赛的基础上，创办的一项崭新的世界性围棋赛事，吸引了全世界围棋高手前来参加。其中，中国队派出了柯洁、辜梓豪、王星昊、丁浩、李钦诚等 $15$ 员大将参赛，韩国队 $8$ 人，日本队 $5$ 人，还有 $2$ 位棋手来自中国台湾、 $2$ 位棋手来自欧美地区。可以说，全世界最顶尖的围棋高手悉数相聚于此。\n\n随着科技的发展，人工智能的巨大技术进步和网络传媒的全面普及，围棋这项来自中国的传统运动正在焕发出新的活力。在网络上，人们随时可以看到最新的赛事直播，以及人工智能的精准分析和各大围棋高手的细致解读。资源获取的便捷性使得人们对围棋的关注度空前上升，围棋不再是只有少部分懂棋的爱好者才能欣赏的“小众游戏”；围棋高手也不再只是一个神秘的身份，越来越多的围棋高手开始在网络上与棋迷近距离互动，普及围棋知识，讲解最新对局，赢得了一致好评。正如这次参赛的选手中，有一位棋手同时也是粉丝数达 $150$ 多万的网红主播，甚至还有一位棋手是一家网红餐厅的老板。\n\n我们今天故事的主角正是这样一位有着传奇色彩的人物。作为一名清华大学本科在读的学生，同时也是一名顶尖围棋高手，他的一举一动无疑都会引起巨大的关注。此次他参加“烂柯杯”比赛，众人无一例外看好他的比赛前景，尤其是现在韩国围棋”第一人“申真谞九段的巅峰时期，他也被无数中国棋迷寄托以”狙击‘小申’“的重任。$5$ 月 $4$ 日抽签过后，没有任何人会怀疑他能不能赢下 $5$ 日的第一轮比赛，一些围棋高手更是直接放出了”大胜，不可能失败“的预言。\n\n然而，$5$ 月 $5$ 日的比赛还是爆出了惊天大冷门。他在已经胜券在握，AI 胜率达到 $99\\%$ 的关头，接连选择了“弹幕最多的下法”，最终因为几招致命的失误葬送好局，落败于中国台湾棋手赖均辅八段。赛后，人们在震惊的同时，纷纷猜测本局失利的原因。有人说，他的状态低迷在前些年早已有所体现，“当你在 XX 的时候，小申在下棋”成了调侃他与申真谞战绩差距的一句名言；有人说，他在比赛之前的 $12$ 连胜战绩反而使他心态紧张，从而犯了优势下容易大意的老毛病；也有人拿出了“落凤坡”的典故，以证明他或许命中注定与“烂柯杯”八字不合……但或许，这样的变幻莫测和不可预料性，正是围棋的魅力所在。\n\n请你根据以上所有信息，猜测本文的主角是谁。", "inputFormat": "无输入。", "outputFormat": "输出一个由小写字母组成的字符串，表示上文中提到的主角的名字全拼。如若答案是马云，应当输出 `mayun`。", "hint": "### 提示\n\n主角的名字在题面中已经有所提及。\n\n题面中一些看似无厘头的信息实际上是有价值的。\n\n\n### 题目来源\n\n来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。\n\n题解等资源可在 <https://github.com/THUSAAC/THUPC2023> 查看。", "locale": "zh-CN"}}}
{"pid": "P9390", "type": "P", "difficulty": 1, "samples": [["987654 123456123456\n", "135802\n"], ["428571 714285\n", "99999714286\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "O2优化", "洛谷月赛"], "title": "金盏花", "background": "", "description": "有一个十二位十进制数 $X$，你只知道它的后六位构成的数是 $Y$。\n\n另外再给出一个整数 $Z$，你需要求出所有可能的 $X$ 中，$X$ 与 $Z$ 的差，即 $\\lvert X - Z \\rvert$ 的最小值。\n\n注意，$X,Y,Z$ 都没有前导零（即最高位不是 $0$），$X,Y$ 分别要有恰好十二位和六位。", "inputFormat": "第一行：两个整数 $Y,Z$。", "outputFormat": "第一行：一个整数表示 $\\lvert X - Z \\rvert$ 的最小值。", "hint": "**【样例 #1 解释】**\n\n令 $X=123455987654$，可以取到 $\\lvert X - Z \\rvert$ 的最小值 $135802$。\n\n---\n\n**【样例 #2 解释】**\n\n令 $X=100000428571$，可以取到 $\\lvert X - Z \\rvert$ 的最小值 $99999714286$。\n\n---\n\n**【数据范围】**\n\n对于全部数据：$100000\\leq Y\\leq 999999$，$0\\leq Z\\leq 10^{12}$。\n\n|     子任务编号     |  $Z\\leq$  |  特殊限制  | 分值 |\n| :----------------: | :-------: | :--------: | :--: |\n| $\\text{Subtask 1}$ |    $0$    | $Y=142857$ | $25$ |\n| $\\text{Subtask 2}$ |    $0$    |     无     | $25$ |\n| $\\text{Subtask 3}$ | $999999$  |     无     | $25$ |\n| $\\text{Subtask 4}$ | $10^{12}$ |     无     | $25$ |\n\n---\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ibn2l6eb.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "金盏花", "background": "", "description": "有一个十二位十进制数 $X$，你只知道它的后六位构成的数是 $Y$。\n\n另外再给出一个整数 $Z$，你需要求出所有可能的 $X$ 中，$X$ 与 $Z$ 的差，即 $\\lvert X - Z \\rvert$ 的最小值。\n\n注意，$X,Y,Z$ 都没有前导零（即最高位不是 $0$），$X,Y$ 分别要有恰好十二位和六位。", "inputFormat": "第一行：两个整数 $Y,Z$。", "outputFormat": "第一行：一个整数表示 $\\lvert X - Z \\rvert$ 的最小值。", "hint": "**【样例 #1 解释】**\n\n令 $X=123455987654$，可以取到 $\\lvert X - Z \\rvert$ 的最小值 $135802$。\n\n---\n\n**【样例 #2 解释】**\n\n令 $X=100000428571$，可以取到 $\\lvert X - Z \\rvert$ 的最小值 $99999714286$。\n\n---\n\n**【数据范围】**\n\n对于全部数据：$100000\\leq Y\\leq 999999$，$0\\leq Z\\leq 10^{12}$。\n\n|     子任务编号     |  $Z\\leq$  |  特殊限制  | 分值 |\n| :----------------: | :-------: | :--------: | :--: |\n| $\\text{Subtask 1}$ |    $0$    | $Y=142857$ | $25$ |\n| $\\text{Subtask 2}$ |    $0$    |     无     | $25$ |\n| $\\text{Subtask 3}$ | $999999$  |     无     | $25$ |\n| $\\text{Subtask 4}$ | $10^{12}$ |     无     | $25$ |\n\n---\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ibn2l6eb.png)", "locale": "zh-CN"}}}
{"pid": "P9391", "type": "P", "difficulty": 4, "samples": [["6 6\n6 3 4 2 5 1\n", "1 1 2 0 2 0\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "O2优化", "洛谷月赛"], "title": "红草莓", "background": "", "description": "有一个由 $n$ 颗珍珠串成的项链，项链是一个环，首尾相连。其中有一颗珍珠上有特殊的记号，我们称它为**起始珍珠**。\n\n有个外星人很会发射宇宙射线，他依次发射了 $m$ 轮宇宙射线，第 $i$ 轮有一个参数 $a_i$，表示：\n\n- 外星人从起始珍珠开始数，起始珍珠是 $0$ 号，起始珍珠的下一个珍珠是 $1$ 号，以此类推（数完一圈后还会继续，例如 $n$ 号珍珠仍然是起始珍珠，$n+1$ 号珍珠是起始珍珠的下一个珍珠）。外星人会对编号为 $0,a_i,2a_i,\\dots$ 这些 $a_i$ 倍数位置上的珍珠都发射一次宇宙射线。\n\n一开始所有珍珠都是红色的，而当一个珍珠被发射宇宙射线后就会被从红色染成蓝色。\n\n你需要输出：对于每轮操作，有多少个操作前为红色的珍珠被这轮操作变成了蓝色。", "inputFormat": "第一行：两个整数 $n,m$。\n\n第二行：$m$ 个整数 $a_1,\\dots,a_m$。", "outputFormat": "第一行：$m$ 个整数，分别表示每轮操作中有多少个操作前为红色的珍珠被变为蓝色。", "hint": "**【样例解释】**\n\n如图是初始时以及每次操作后各珍珠的颜色，起始珍珠编号为 $0$，可以看到，每次操作新染蓝的珍珠数量分别为 $1,1,2,0,2,0$：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mt4dg5ap.png)\n\n---\n\n**【数据范围】**\n\n对于全部数据：$1\\leq n,m\\leq 5\\times 10^5$，$1\\leq a_i\\leq n$。\n\n|     子任务编号     |    $n\\leq$     |    $m\\leq$     |  特殊限制   | 分值 |\n| :----------------: | :------------: | :------------: | :---------: | :--: |\n| $\\text{Subtask 1}$ |     $100$      |     $100$      |     无      | $15$ |\n| $\\text{Subtask 2}$ |     $1000$     |     $1000$     |     无      | $15$ |\n| $\\text{Subtask 3}$ |     $10^5$     |     $10^5$     | $a_i\\mid n$ | $20$ |\n| $\\text{Subtask 4}$ |     $10^5$     |      $10$      |     无      | $20$ |\n| $\\text{Subtask 5}$ | $5\\times 10^5$ | $5\\times 10^5$ |     无      | $30$ |\n\n---\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/nzd79suj.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "红草莓", "background": "", "description": "有一个由 $n$ 颗珍珠串成的项链，项链是一个环，首尾相连。其中有一颗珍珠上有特殊的记号，我们称它为**起始珍珠**。\n\n有个外星人很会发射宇宙射线，他依次发射了 $m$ 轮宇宙射线，第 $i$ 轮有一个参数 $a_i$，表示：\n\n- 外星人从起始珍珠开始数，起始珍珠是 $0$ 号，起始珍珠的下一个珍珠是 $1$ 号，以此类推（数完一圈后还会继续，例如 $n$ 号珍珠仍然是起始珍珠，$n+1$ 号珍珠是起始珍珠的下一个珍珠）。外星人会对编号为 $0,a_i,2a_i,\\dots$ 这些 $a_i$ 倍数位置上的珍珠都发射一次宇宙射线。\n\n一开始所有珍珠都是红色的，而当一个珍珠被发射宇宙射线后就会被从红色染成蓝色。\n\n你需要输出：对于每轮操作，有多少个操作前为红色的珍珠被这轮操作变成了蓝色。", "inputFormat": "第一行：两个整数 $n,m$。\n\n第二行：$m$ 个整数 $a_1,\\dots,a_m$。", "outputFormat": "第一行：$m$ 个整数，分别表示每轮操作中有多少个操作前为红色的珍珠被变为蓝色。", "hint": "**【样例解释】**\n\n如图是初始时以及每次操作后各珍珠的颜色，起始珍珠编号为 $0$，可以看到，每次操作新染蓝的珍珠数量分别为 $1,1,2,0,2,0$：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mt4dg5ap.png)\n\n---\n\n**【数据范围】**\n\n对于全部数据：$1\\leq n,m\\leq 5\\times 10^5$，$1\\leq a_i\\leq n$。\n\n|     子任务编号     |    $n\\leq$     |    $m\\leq$     |  特殊限制   | 分值 |\n| :----------------: | :------------: | :------------: | :---------: | :--: |\n| $\\text{Subtask 1}$ |     $100$      |     $100$      |     无      | $15$ |\n| $\\text{Subtask 2}$ |     $1000$     |     $1000$     |     无      | $15$ |\n| $\\text{Subtask 3}$ |     $10^5$     |     $10^5$     | $a_i\\mid n$ | $20$ |\n| $\\text{Subtask 4}$ |     $10^5$     |      $10$      |     无      | $20$ |\n| $\\text{Subtask 5}$ | $5\\times 10^5$ | $5\\times 10^5$ |     无      | $30$ |\n\n---\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/nzd79suj.png)", "locale": "zh-CN"}}}
{"pid": "P9392", "type": "P", "difficulty": 5, "samples": [["7 8\n1 2\n1 3\n2 3\n2 6\n3 4\n5 2\n5 7\n6 7\n", "7\n1 2 1\n1 2 5\n2 3 2\n3 4 3\n3 5 6\n4 6 4\n5 7 7\n"], ["7 8\n1 2\n2 3\n2 6\n4 5\n4 7\n5 3\n7 3\n7 6\n", "-1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "Special Judge", "O2优化", "洛谷月赛"], "title": "黄玫瑰", "background": "", "description": "给定一张包含 $n$ 个点的简单有向无环图 $G$，点 $i$ 的点权设为 $w_i$，但**点权不是给定的**。\n\n你需要构造一个包含至多 $2\\times n$ 个点和恰好 $n$ 条边的有向无环图 $G'$，你需要为 $G'$ 的每条边钦定某个 $w_i$ 作为它的边权，使得 $G'$ 和 $G$ 的**最长路**长度相等。\n\n在 $G$ 中一条路径的长度定义为其中所有点权和，$G'$ 中则为所有边权和。\n\n然而，所有 $w_i$ 都不是给定的，所以你构造的 $G'$ 需要满足：对于任何一种可能的**正数**序列 $[w_1,\\ldots,w_n]$，$G$ 和 $G'$ 的最长路长度都要相等。\n\n请构造 $G'$，或说明它不存在。", "inputFormat": "第一行：两个整数 $n,m$。\n\n接下来 $m$ 行：每行两个整数 $x,y$，表示存在一条点 $x$ 到点 $y$ 的有向边。", "outputFormat": "如果不存在满足题意的 $G'$，则输出一行一个 $-1$。\n\n否则，输出 $n+1$ 行：\n\n第一行：一个整数 $N$，表示你构造的 $G'$ 的点数。\n\n接下来 $n$ 行：每行三个整数 $x,y,z$，表示 $G'$ 中存在一条点 $x$ 到点 $y$ 的边，边权等于 $w_z$。\n\n你需要保证 $0\\leq N\\leq 2\\times n$，$1\\leq x,y\\leq N$，$1\\leq z\\leq n$。\n\n若有多种可能的解，任意输出一个即可。", "hint": "**【样例 #1 解释】**\n\n如下图，左为 $G$，右为 $G'$，颜色相同的点/边表示权值相同：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/i0wuxctf.png)\n\n注意这只是一种可能的答案，其他正确的答案也可通过。\n\n---\n\n**【样例 #2 解释】**\n\n下图为 $G$，不存在合法的 $G'$：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tek49neu.png)\n\n---\n\n**【数据范围】**\n\n对于全部数据：$1\\leq n\\leq 20000$，$1\\leq m\\leq 3\\times 10^5$，$1\\leq x,y\\leq n$，保证给定的图无环且无重边。\n\n|     子任务编号     | $n\\leq$ |    $m\\leq$     |           特殊性质            | 分值 |\n| :----------------: | :-----: | :------------: | :---------------------------: | :--: |\n| $\\text{Subtask 1}$ | $5000$  |     $4999$     | $m=n-1$，每个点入度不超过 $1$ | $18$ |\n| $\\text{Subtask 2}$ | $5000$  |     $4999$     | $m=n-1$，每个点出度不超过 $1$ | $19$ |\n| $\\text{Subtask 3}$ |  $20$   |      $50$      |              无               | $20$ |\n| $\\text{Subtask 4}$ | $5000$  |    $10000$     |              无               | $21$ |\n| $\\text{Subtask 5}$ | $20000$ | $3\\times 10^5$ |              无               | $22$ |\n\n---\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jepg6g1u.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "黄玫瑰", "background": "", "description": "给定一张包含 $n$ 个点的简单有向无环图 $G$，点 $i$ 的点权设为 $w_i$，但**点权不是给定的**。\n\n你需要构造一个包含至多 $2\\times n$ 个点和恰好 $n$ 条边的有向无环图 $G'$，你需要为 $G'$ 的每条边钦定某个 $w_i$ 作为它的边权，使得 $G'$ 和 $G$ 的**最长路**长度相等。\n\n在 $G$ 中一条路径的长度定义为其中所有点权和，$G'$ 中则为所有边权和。\n\n然而，所有 $w_i$ 都不是给定的，所以你构造的 $G'$ 需要满足：对于任何一种可能的**正数**序列 $[w_1,\\ldots,w_n]$，$G$ 和 $G'$ 的最长路长度都要相等。\n\n请构造 $G'$，或说明它不存在。", "inputFormat": "第一行：两个整数 $n,m$。\n\n接下来 $m$ 行：每行两个整数 $x,y$，表示存在一条点 $x$ 到点 $y$ 的有向边。", "outputFormat": "如果不存在满足题意的 $G'$，则输出一行一个 $-1$。\n\n否则，输出 $n+1$ 行：\n\n第一行：一个整数 $N$，表示你构造的 $G'$ 的点数。\n\n接下来 $n$ 行：每行三个整数 $x,y,z$，表示 $G'$ 中存在一条点 $x$ 到点 $y$ 的边，边权等于 $w_z$。\n\n你需要保证 $0\\leq N\\leq 2\\times n$，$1\\leq x,y\\leq N$，$1\\leq z\\leq n$。\n\n若有多种可能的解，任意输出一个即可。", "hint": "**【样例 #1 解释】**\n\n如下图，左为 $G$，右为 $G'$，颜色相同的点/边表示权值相同：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/i0wuxctf.png)\n\n注意这只是一种可能的答案，其他正确的答案也可通过。\n\n---\n\n**【样例 #2 解释】**\n\n下图为 $G$，不存在合法的 $G'$：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/tek49neu.png)\n\n---\n\n**【数据范围】**\n\n对于全部数据：$1\\leq n\\leq 20000$，$1\\leq m\\leq 3\\times 10^5$，$1\\leq x,y\\leq n$，保证给定的图无环且无重边。\n\n|     子任务编号     | $n\\leq$ |    $m\\leq$     |           特殊性质            | 分值 |\n| :----------------: | :-----: | :------------: | :---------------------------: | :--: |\n| $\\text{Subtask 1}$ | $5000$  |     $4999$     | $m=n-1$，每个点入度不超过 $1$ | $18$ |\n| $\\text{Subtask 2}$ | $5000$  |     $4999$     | $m=n-1$，每个点出度不超过 $1$ | $19$ |\n| $\\text{Subtask 3}$ |  $20$   |      $50$      |              无               | $20$ |\n| $\\text{Subtask 4}$ | $5000$  |    $10000$     |              无               | $21$ |\n| $\\text{Subtask 5}$ | $20000$ | $3\\times 10^5$ |              无               | $22$ |\n\n---\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jepg6g1u.png)", "locale": "zh-CN"}}}
{"pid": "P9393", "type": "P", "difficulty": 6, "samples": [["5 3 3\n-1-01\n011-0\n--010\n00000\n10010\n00101\n", "01110\n11010\n01110\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "O2优化", "洛谷月赛"], "title": "紫丁香", "background": "", "description": "对于一个字符串 $A$，记 $A_i$ 表示它的第 $i$ 个字符。\n\n设 $S$ 是任意长度为 $m$ 的 $01$ 串。我们有 $n$ 个操作，第 $i$ 个操作可以表示成一个定义域和值域都是长度为 $m$ 的 $01$ 串集合的函数 $f_i$，表示经过这次操作后 $S$ 会变成 $f_i(S)$。而函数 $f_i$ 可以由一个长度为 $m$ 的串 $T_i$ 表示，$T_i$ 由 $\\texttt{0,1,-}$ 三种字符组成，其中：\n\n- $T_{i,j}=\\texttt{0}$ 表示 $[f_i(S)]_j=\\texttt{0}$。\n\n- $T_{i,j}=\\texttt{1}$ 表示 $[f_i(S)]_j=\\texttt{1}$。\n\n- $T_{i,j}=\\texttt{-}$ 表示 $[f_i(S)]_j=S_j$。\n\n也就是说，每个操作会将 $S$ 的一些位赋值为 $0$，一些位赋值为 $1$，还有一些位不变。\n\n现在有 $q$ 次操作，每次操作给定一个长度为 $m$ 的 $01$ 串 $S$，你可以对它做任意多次操作，操作的顺序任意，一个操作可以做多次。得到的串 $S'$ 可以被看做一个二进制数，求对应二进制数最大的 $S'$。", "inputFormat": "第一行：三个整数 $m,n,q$。\n\n接下来 $n$ 行：每行一个长度为 $m$ 的串 $T$，表示一种操作。\n\n接下来 $q$ 行：每行一个长度为 $m$ 的串 $S$，表示一个询问。", "outputFormat": "输出 $q$ 行：每行一个长度为 $m$ 的串，依次表示每个询问的答案。", "hint": "**【样例解释】**\n\n对于第一个询问串 $\\texttt{00000}$，可以依次进行操作 $3,2$，得到最优的 $S'$：\n\n$$\\texttt{00000}\\to \\texttt{00010}\\to \\texttt{01110}$$\n\n对于第二个询问串 $\\texttt{10010}$，可以依次进行操作 $1,3$，得到最优的 $S'$：\n\n$$\\texttt{10010}\\to \\texttt{11001}\\to \\texttt{11010}$$\n\n对于第三个询问串 $\\texttt{00101}$，可以依次进行操作 $3,2$，得到最优的 $S'$：\n\n$$\\texttt{00101}\\to \\texttt{00010}\\to \\texttt{01110}$$\n\n---\n\n**【数据范围】**\n\n对于全部数据：$1\\leq m\\leq 22$，$1\\leq n,q\\leq 10^5$，$T$ 仅包含 $\\texttt{0,1,-}$ 三种字符，$S$ 仅包含 $\\texttt{0,1}$ 两种字符。\n\n|     子任务编号     | $m\\leq$ | $n\\leq$ | $q\\leq$ |         特殊性质          | 分值 |\n| :----------------: | :-----: | :-----: | :-----: | :-----------------------: | :--: |\n| $\\text{Subtask 1}$ |  $10$   | $1000$  |   $1$   |            无             | $10$ |\n| $\\text{Subtask 2}$ |  $10$   | $1000$  | $1000$  |            无             | $20$ |\n| $\\text{Subtask 3}$ |  $20$   | $10^5$  | $10^5$  | $T$ 中没有 $\\texttt{-}$ | $10$ |\n| $\\text{Subtask 4}$ |  $18$   | $10000$ |   $10$   |            无             | $18$ |\n| $\\text{Subtask 5}$ |  $20$   | $10^5$  |   $10$   |            无             | $18$ |\n| $\\text{Subtask 6}$ |  $22$   | $10^5$  | $10^5$  |            无             | $24$ |\n\n---\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/793whkzq.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "紫丁香", "background": "", "description": "对于一个字符串 $A$，记 $A_i$ 表示它的第 $i$ 个字符。\n\n设 $S$ 是任意长度为 $m$ 的 $01$ 串。我们有 $n$ 个操作，第 $i$ 个操作可以表示成一个定义域和值域都是长度为 $m$ 的 $01$ 串集合的函数 $f_i$，表示经过这次操作后 $S$ 会变成 $f_i(S)$。而函数 $f_i$ 可以由一个长度为 $m$ 的串 $T_i$ 表示，$T_i$ 由 $\\texttt{0,1,-}$ 三种字符组成，其中：\n\n- $T_{i,j}=\\texttt{0}$ 表示 $[f_i(S)]_j=\\texttt{0}$。\n\n- $T_{i,j}=\\texttt{1}$ 表示 $[f_i(S)]_j=\\texttt{1}$。\n\n- $T_{i,j}=\\texttt{-}$ 表示 $[f_i(S)]_j=S_j$。\n\n也就是说，每个操作会将 $S$ 的一些位赋值为 $0$，一些位赋值为 $1$，还有一些位不变。\n\n现在有 $q$ 次操作，每次操作给定一个长度为 $m$ 的 $01$ 串 $S$，你可以对它做任意多次操作，操作的顺序任意，一个操作可以做多次。得到的串 $S'$ 可以被看做一个二进制数，求对应二进制数最大的 $S'$。", "inputFormat": "第一行：三个整数 $m,n,q$。\n\n接下来 $n$ 行：每行一个长度为 $m$ 的串 $T$，表示一种操作。\n\n接下来 $q$ 行：每行一个长度为 $m$ 的串 $S$，表示一个询问。", "outputFormat": "输出 $q$ 行：每行一个长度为 $m$ 的串，依次表示每个询问的答案。", "hint": "**【样例解释】**\n\n对于第一个询问串 $\\texttt{00000}$，可以依次进行操作 $3,2$，得到最优的 $S'$：\n\n$$\\texttt{00000}\\to \\texttt{00010}\\to \\texttt{01110}$$\n\n对于第二个询问串 $\\texttt{10010}$，可以依次进行操作 $1,3$，得到最优的 $S'$：\n\n$$\\texttt{10010}\\to \\texttt{11001}\\to \\texttt{11010}$$\n\n对于第三个询问串 $\\texttt{00101}$，可以依次进行操作 $3,2$，得到最优的 $S'$：\n\n$$\\texttt{00101}\\to \\texttt{00010}\\to \\texttt{01110}$$\n\n---\n\n**【数据范围】**\n\n对于全部数据：$1\\leq m\\leq 22$，$1\\leq n,q\\leq 10^5$，$T$ 仅包含 $\\texttt{0,1,-}$ 三种字符，$S$ 仅包含 $\\texttt{0,1}$ 两种字符。\n\n|     子任务编号     | $m\\leq$ | $n\\leq$ | $q\\leq$ |         特殊性质          | 分值 |\n| :----------------: | :-----: | :-----: | :-----: | :-----------------------: | :--: |\n| $\\text{Subtask 1}$ |  $10$   | $1000$  |   $1$   |            无             | $10$ |\n| $\\text{Subtask 2}$ |  $10$   | $1000$  | $1000$  |            无             | $20$ |\n| $\\text{Subtask 3}$ |  $20$   | $10^5$  | $10^5$  | $T$ 中没有 $\\texttt{-}$ | $10$ |\n| $\\text{Subtask 4}$ |  $18$   | $10000$ |   $10$   |            无             | $18$ |\n| $\\text{Subtask 5}$ |  $20$   | $10^5$  |   $10$   |            无             | $18$ |\n| $\\text{Subtask 6}$ |  $22$   | $10^5$  | $10^5$  |            无             | $24$ |\n\n---\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/793whkzq.png)", "locale": "zh-CN"}}}
{"pid": "P9394", "type": "P", "difficulty": 7, "samples": [["7 7\n1 2\n1 3\n1 5\n1 6\n4 5\n5 6\n6 7\n", "2 5\n1 2\n2 1 3\n2 5 4\n1 6\n1 7\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "Special Judge", "O2优化", "洛谷月赛"], "title": "白鹭兰", "background": "", "description": "有很多有关火星人的传说，比如他们的 DNA 非常复杂，他们有成千上万根手指等等，但这些都没有得到证实。同样没有得到证实的一个传说是火星人很会做 OI 题。\n\n为了验证最后这个传说，地球人们给来自火星的外星旅人出了一道 OI 题：\n\n> 给定一张 $n$ 个点 $m$ 条边的无向连通图 $G=(V,E)$，请找出最小的 $k$ 使得存在一个对点集的划分 $V_1,\\ldots,V_t$ 使得：\n>\n> - $\\forall 1\\leq x\\leq t$，$\\bigcup_{i=1}^x V_i$ 的导出子图连通；\n>\n> - $\\forall 1\\leq x\\leq t$，$\\bigcup_{i=x}^t V_i$ 的导出子图连通；\n>\n> - $\\forall 1\\leq x\\leq t$，$|V_x|\\leq k$。\n>\n> 注意，作为划分，还需要满足 $\\bigcup_{i=1}^t V_i=V$，$ V_i\\cap V_j=\\varnothing\\ (\\forall i\\neq j)$，且所有 $V_i$ 非空。\n>\n> 请给出最小的 $k$ 以及对应的划分。\n\n再见，You're 火星人。现在你需要完成这道题，证明火星人的智慧。", "inputFormat": "第一行：两个整数 $n,m$，分别表示图 $G$ 的结点数和边数。\n\n接下来 $m$ 行：每行两个整数 $x,y$，表示一条连接结点 $x,y$ 的无向边。", "outputFormat": "第一行：两个整数 $k_{min},t$，分别表示最小的 $k$ 以及对应的划分大小。\n\n接下来 $t$ 行：第 $i$ 行首先一个整数 $s_i$，表示 $V_i$ 的大小，然后 $s_i$ 个整数表示 $V_i$ 的元素。\n\n如有多种划分方案，可以任意输出一种，注意你并不需要最小化 $t$。", "hint": "**【样例解释】**\n\n如下图，$V_1,\\ldots,V_5$ 分别是红色/橙色/绿色/蓝色/紫色点集，可以验证这满足题目条件。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/omc7gvxe.png)\n\n--- \n\n**【评分方式】**\n\n如果你的输出格式错误，将有可能不得分，也可能导致不可预知的错误。\n\n如果你的输出格式正确，若你的 $k_{min}$ 正确，你将获得测试点 $50\\%$ 的分数，若在此基础上你的构造方案正确，你将获得测试点 $100\\%$ 的分数。\n\n---\n\n**【数据范围】**\n\n对于全部数据：$2\\leq n\\leq 2\\times 10^5$，$1\\leq m\\leq 2.3\\times 10^5$，$1\\leq x,y\\leq n$，保证给出的 $m$ 条边中没有重边和自环，保证给出的图连通。\n\n|     子任务编号     | $m\\leq$ |        特殊限制        | 分值 |\n| :----------------: | :-------------: | :--------------------: | :--: |\n| $\\text{Subtask 1}$ |     $2\\times 10^5$     | $G$ 是链 | $10$ |\n| $\\text{Subtask 2}$ |      $10$       |         无          | $10$ |\n| $\\text{Subtask 3}$ |     $2000$      |         $G$ 是树          | $15$ |\n| $\\text{Subtask 4}$ |     $2000$      |         无          | $20$ |\n| $\\text{Subtask 5}$ |      $10^5$      |           $G$ 是树           | $15$ |\n| $\\text{Subtask 6}$ |     $2.3\\times 10^5$     |           无           | $30$ |\n\n\n---\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/41etnpdx.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "白鹭兰", "background": "", "description": "有很多有关火星人的传说，比如他们的 DNA 非常复杂，他们有成千上万根手指等等，但这些都没有得到证实。同样没有得到证实的一个传说是火星人很会做 OI 题。\n\n为了验证最后这个传说，地球人们给来自火星的外星旅人出了一道 OI 题：\n\n> 给定一张 $n$ 个点 $m$ 条边的无向连通图 $G=(V,E)$，请找出最小的 $k$ 使得存在一个对点集的划分 $V_1,\\ldots,V_t$ 使得：\n>\n> - $\\forall 1\\leq x\\leq t$，$\\bigcup_{i=1}^x V_i$ 的导出子图连通；\n>\n> - $\\forall 1\\leq x\\leq t$，$\\bigcup_{i=x}^t V_i$ 的导出子图连通；\n>\n> - $\\forall 1\\leq x\\leq t$，$|V_x|\\leq k$。\n>\n> 注意，作为划分，还需要满足 $\\bigcup_{i=1}^t V_i=V$，$ V_i\\cap V_j=\\varnothing\\ (\\forall i\\neq j)$，且所有 $V_i$ 非空。\n>\n> 请给出最小的 $k$ 以及对应的划分。\n\n再见，You're 火星人。现在你需要完成这道题，证明火星人的智慧。", "inputFormat": "第一行：两个整数 $n,m$，分别表示图 $G$ 的结点数和边数。\n\n接下来 $m$ 行：每行两个整数 $x,y$，表示一条连接结点 $x,y$ 的无向边。", "outputFormat": "第一行：两个整数 $k_{min},t$，分别表示最小的 $k$ 以及对应的划分大小。\n\n接下来 $t$ 行：第 $i$ 行首先一个整数 $s_i$，表示 $V_i$ 的大小，然后 $s_i$ 个整数表示 $V_i$ 的元素。\n\n如有多种划分方案，可以任意输出一种，注意你并不需要最小化 $t$。", "hint": "**【样例解释】**\n\n如下图，$V_1,\\ldots,V_5$ 分别是红色/橙色/绿色/蓝色/紫色点集，可以验证这满足题目条件。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/omc7gvxe.png)\n\n--- \n\n**【评分方式】**\n\n如果你的输出格式错误，将有可能不得分，也可能导致不可预知的错误。\n\n如果你的输出格式正确，若你的 $k_{min}$ 正确，你将获得测试点 $50\\%$ 的分数，若在此基础上你的构造方案正确，你将获得测试点 $100\\%$ 的分数。\n\n---\n\n**【数据范围】**\n\n对于全部数据：$2\\leq n\\leq 2\\times 10^5$，$1\\leq m\\leq 2.3\\times 10^5$，$1\\leq x,y\\leq n$，保证给出的 $m$ 条边中没有重边和自环，保证给出的图连通。\n\n|     子任务编号     | $m\\leq$ |        特殊限制        | 分值 |\n| :----------------: | :-------------: | :--------------------: | :--: |\n| $\\text{Subtask 1}$ |     $2\\times 10^5$     | $G$ 是链 | $10$ |\n| $\\text{Subtask 2}$ |      $10$       |         无          | $10$ |\n| $\\text{Subtask 3}$ |     $2000$      |         $G$ 是树          | $15$ |\n| $\\text{Subtask 4}$ |     $2000$      |         无          | $20$ |\n| $\\text{Subtask 5}$ |      $10^5$      |           $G$ 是树           | $15$ |\n| $\\text{Subtask 6}$ |     $2.3\\times 10^5$     |           无           | $30$ |\n\n\n---\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/41etnpdx.png)", "locale": "zh-CN"}}}
{"pid": "P9395", "type": "P", "difficulty": 7, "samples": [["6\n3\n1 1 1\n3\n1 1 2\n3\n1 1 3\n3\n1 2 1\n3\n1 2 2\n3\n1 2 3\n", "1 2 3\n2 3 3\n-1\n2 2 3\n-1\n3 3 3\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["洛谷原创", "Special Judge", "O2优化", "洛谷月赛"], "title": "橙垒球", "background": "", "description": "垒球很喜欢一个叫迷你某·萨菲克斯的题，并且很崇拜这题的出题人，所以出了个差不多的题。\n\n给定一个长度为 $n$ 的序列 $a_1,\\ldots,a_n$，请构造一个**字典序最大**的长度为 $n$ 的字符串 $w$，使得：\n\n- $w$ 的每个字符是 $1$ 到 $n$ 的整数，字符的大小顺序为 $1$ 最小 $n$ 最大；\n\n- $w$ 的长度为 $i$ 的前缀的**字典序最大的后缀**长度恰为 $a_i$。\n\n请输出这样的 $w$，或报告无解。\n\n本题单个测试点包含多组数据。", "inputFormat": "第一行：一个整数 $T$，表示数据组数。\n\n接下来依次输入 $T$ 组数据，对于每组数据：\n\n第一行：一个整数 $n$。\n\n第二行：$n$ 个整数 $a_1,\\ldots,a_n$。", "outputFormat": "对于每组数据：\n\n若无解，只输出一行一个 $-1$。\n\n若有解，则输出一行 $n$ 个整数，表示你给出的 $w$。", "hint": "**【样例解释】**\n\n字符串 $1,2,3$ 的每个前缀的最大后缀长度恰好为 $1,1,1$，且是满足这个条件的字典序最大的字符串。\n\n字符串 $2,3,3$ 的每个前缀的最大后缀长度恰好为 $1,1,2$，且是满足这个条件的字典序最大的字符串。\n\n不存在一个字符串，每个前缀的最大后缀长度恰好为 $1,1,3$。\n\n字符串 $2,2,3$ 的每个前缀的最大后缀长度恰好为 $1,2,1$，且是满足这个条件的字典序最大的字符串。\n\n不存在一个字符串，每个前缀的最大后缀长度恰好为 $1,2,2$。\n\n字符串 $3,3,3$ 的每个前缀的最大后缀长度恰好为 $1,2,3$，且是满足这个条件的字典序最大的字符串。\n\n---\n\n**【评分方式】**\n\n每个测试点的分数等于其中所有测试数据分数的最小值。一个测试数据的分数由以下方式确定：\n\n如果你的输出格式错误（即不符合输出格式的要求），则不能得分。\n\n否则，如果你正确判定了是否有解（即在无解的数据输出 $-1$，有解的数据输出了 $n$ 个 $[1,n]$ 中的数），则可以获得 $20\\%$ 的分数。\n\n在此基础上，如果该测试点无解，或者有解且你输出的是一组合法解（未必是字典序最大的），则可以再获得 $30\\%$ 的分数。\n\n在此基础上，如果该测试点无解，或者有解且你输出的是字典序最大的解，则可以再获得 $50\\%$ 的分数。\n\n---\n\n**【数据范围】**\n\n对于全部数据：$1\\leq T\\leq 10000$，$1 \\le n \\le 4 \\times 10 ^ 6$，$\\sum n\\leq 4\\times 10^6$，$1\\leq a_i\\leq i$。\n\n|     子任务编号     |  $\\sum n\\leq$  | 特殊性质 | 分值 |\n| :----------------: | :------------: | :------: | :--: |\n| $\\text{Subtask 1}$ | $4\\times 10^6$ | 保证无解 | $1$  |\n| $\\text{Subtask 2}$ | $4\\times 10^5$ | 保证有解 | $29$ |\n| $\\text{Subtask 3}$ | $4\\times 10^6$ |    无    | $70$ |\n\n---\n\n**【提示】**\n\n请使用较快速的输入输出方式。\n\n---\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5ofelxu1.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "橙垒球", "background": "", "description": "垒球很喜欢一个叫迷你某·萨菲克斯的题，并且很崇拜这题的出题人，所以出了个差不多的题。\n\n给定一个长度为 $n$ 的序列 $a_1,\\ldots,a_n$，请构造一个**字典序最大**的长度为 $n$ 的字符串 $w$，使得：\n\n- $w$ 的每个字符是 $1$ 到 $n$ 的整数，字符的大小顺序为 $1$ 最小 $n$ 最大；\n\n- $w$ 的长度为 $i$ 的前缀的**字典序最大的后缀**长度恰为 $a_i$。\n\n请输出这样的 $w$，或报告无解。\n\n本题单个测试点包含多组数据。", "inputFormat": "第一行：一个整数 $T$，表示数据组数。\n\n接下来依次输入 $T$ 组数据，对于每组数据：\n\n第一行：一个整数 $n$。\n\n第二行：$n$ 个整数 $a_1,\\ldots,a_n$。", "outputFormat": "对于每组数据：\n\n若无解，只输出一行一个 $-1$。\n\n若有解，则输出一行 $n$ 个整数，表示你给出的 $w$。", "hint": "**【样例解释】**\n\n字符串 $1,2,3$ 的每个前缀的最大后缀长度恰好为 $1,1,1$，且是满足这个条件的字典序最大的字符串。\n\n字符串 $2,3,3$ 的每个前缀的最大后缀长度恰好为 $1,1,2$，且是满足这个条件的字典序最大的字符串。\n\n不存在一个字符串，每个前缀的最大后缀长度恰好为 $1,1,3$。\n\n字符串 $2,2,3$ 的每个前缀的最大后缀长度恰好为 $1,2,1$，且是满足这个条件的字典序最大的字符串。\n\n不存在一个字符串，每个前缀的最大后缀长度恰好为 $1,2,2$。\n\n字符串 $3,3,3$ 的每个前缀的最大后缀长度恰好为 $1,2,3$，且是满足这个条件的字典序最大的字符串。\n\n---\n\n**【评分方式】**\n\n每个测试点的分数等于其中所有测试数据分数的最小值。一个测试数据的分数由以下方式确定：\n\n如果你的输出格式错误（即不符合输出格式的要求），则不能得分。\n\n否则，如果你正确判定了是否有解（即在无解的数据输出 $-1$，有解的数据输出了 $n$ 个 $[1,n]$ 中的数），则可以获得 $20\\%$ 的分数。\n\n在此基础上，如果该测试点无解，或者有解且你输出的是一组合法解（未必是字典序最大的），则可以再获得 $30\\%$ 的分数。\n\n在此基础上，如果该测试点无解，或者有解且你输出的是字典序最大的解，则可以再获得 $50\\%$ 的分数。\n\n---\n\n**【数据范围】**\n\n对于全部数据：$1\\leq T\\leq 10000$，$1 \\le n \\le 4 \\times 10 ^ 6$，$\\sum n\\leq 4\\times 10^6$，$1\\leq a_i\\leq i$。\n\n|     子任务编号     |  $\\sum n\\leq$  | 特殊性质 | 分值 |\n| :----------------: | :------------: | :------: | :--: |\n| $\\text{Subtask 1}$ | $4\\times 10^6$ | 保证无解 | $1$  |\n| $\\text{Subtask 2}$ | $4\\times 10^5$ | 保证有解 | $29$ |\n| $\\text{Subtask 3}$ | $4\\times 10^6$ |    无    | $70$ |\n\n---\n\n**【提示】**\n\n请使用较快速的输入输出方式。\n\n---\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5ofelxu1.png)", "locale": "zh-CN"}}}
{"pid": "P9396", "type": "P", "difficulty": 3, "samples": [["1 114514 1919810 19950501 5", "35"], ["5 231421 523434 31243 5", "50\n30\n40\n55\n35"]], "limits": {"time": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "O2优化"], "title": "「DBOI」Round 1 未完成的约定", "background": ">  _生活快得停不下来_\\\n_璀璨的也最终衰败_\\\n_他感到负荷已过载_\\\n_车窗外_\\\n_天上大朵云彩_\\\n_追随他的速度跑得飞快_\\\n_不由自主比赛_\\\n——《笨小孩的道歉信》\n\n不管多少个日夜，为你一直唱。", "description": "$m^3$ 可以表示为 $m$ 个连续奇数的和 $(m \\geqslant 1)$：  \n$$\n1^3 = 1\\\\\n2^3 = 3 + 5\\\\\n3^3 = 7 + 9 + 11\\\\\n4^3 = 13 + 15 + 17 + 19\\\\\n5^3 = 21 + 23 + 25 + 27 + 29\\\\\n\\cdots\\cdots\n$$\n\n在左昂对奇数的狂热崇拜的影响下，苏信好写出来的歌只会是奇数长度。显然歌曲的长度不能是负数。\n\n对于一首长度为 $x$ 的歌，它的悦耳值 $f(x)$ 满足将 $f(x)^3$ 按照上面的规律表示出来后，$x$ 是其中的一个加数。例如 $f(21) = 5, f(11) = 3,f(3) = 2$。\n\n第二天，左昂前来参观，发现苏信好只写出来了一首歌，鄙夷不已。苏信好怒从心起，写出了以 $1\\sim k$ 内所有长度为奇数的歌。\n\n现在左昂想要知道苏信好所有歌的悦耳值之和，以预估他的狂热崇拜的效果。即：给定一个正奇数 $k(1\\leqslant k< 2^{64})$，求 $s = \\sum\\limits_{i = 1}^{\\frac{k + 1}{2}} f(2\\times i - 1)$，即 $f(1) + f(3) + f(5) + \\cdots +f(k)$。  \n\n由于苏信好实在太生气，写出来的歌的悦耳值可能十分之大，你只需要输出 $s\\bmod{10^9 + 7}$ 的结果。\n\n**本题有多组数据。**", "inputFormat": "为避免输入量过大，你需要使用下面的方式读入，因此请将这段代码复制到你的代码中。**下列程序与此题做法无关，请仔细阅读示例代码中的注释。**\n\n```cpp\nnamespace Mker {\n\ttypedef unsigned long long ull;\n\tull SA, SB, SC, p = -1;\n\tint base;\n\tvoid init(){scanf(\"%llu%llu%llu%d\", &SA, &SB, &SC, &base); p = p << (65 - base) >> (65 - base);}\n\tull rand() {\n\t\tull now = SC; now += !(now & 1);\n\t    SA ^= SA << 32, SA ^= SA >> 13, SA ^= SA << 1;\n\t    ull t = SA;\n\t\treturn SA = SB, SB = SC, SC ^= t ^ SA, (now & p) + p + 1;\n\t}\n}\n```\n先读入一个数 $T$，表示数据组数，然后你**需要调用** `Mker::init()`。这个函数将输入四个数 $SA,SB,SC,base$，表示对于这组数据，$k<2^{base}$。\n\n接下来，对于每一组询问，你应当令 $k$ 的值即为 `Mker::rand()`。\n\n示例代码：\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint T;\n\nnamespace Mker {\n\ttypedef unsigned long long ull;\n\tull SA, SB, SC, p = -1;\n\tint base;\n\tvoid init(){scanf(\"%llu%llu%llu%d\", &SA, &SB, &SC, &base); p = p << (65 - base) >> (65 - base);}\n\tull rand() {\n\t\tull now = SC; now += !(now & 1);\n\t    SA ^= SA << 32, SA ^= SA >> 13, SA ^= SA << 1;\n\t    ull t = SA;\n\t\treturn SA = SB, SB = SC, SC ^= t ^ SA, (now & p) + p + 1;\n\t}\n}\n\nint main() {\n\tscanf(\"%d\", &T); Mker::init(); // 不要忘记 init\n//\tcout << Mker::base << endl; 你可以通过这种方式输出得到 base 的值 \n\twhile (T--) {\n\t\tunsigned long long k = Mker::rand(); // 通过这种方式，获得一次询问的 k\n\t\tif (k == 1) puts(\"1\");\n\t\telse if (k == 17) puts(\"26\");\n\t\telse puts(\"I AK IOI\");\n\t\t\n//\t\tcout << k << endl; 你可以通过这种方式输出得到真实的 k 以调试代码 \n\t}\n\treturn 0;\n}\n```", "outputFormat": "$T$ 行，每行一个数 $s\\bmod{10^9 + 7}$，其中 $s$ 表示苏信好的歌的悦耳值之和。", "hint": "\n|  Subtask |  数据范围  | 分值 |\n|:----:|:----:|:----:|\n| Subtask 1 | $T=1$，$k< 2^{25}$ | $20$ |\n| Subtask 2 | $T\\leq 5$，$k< 2^{48}$ | $30$ |\n| Subtask 3 | $T\\leq 10^6$，$k < 2^{48}$ | $40$ |\n| Subtask 4 | $T\\leq 3\\times 10^6$，$k < 2^{64}$ | $10$ |\n\n**请注意常数因子对程序效率的影响。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DBOI」Round 1 未完成的约定", "background": ">  _生活快得停不下来_\\\n_璀璨的也最终衰败_\\\n_他感到负荷已过载_\\\n_车窗外_\\\n_天上大朵云彩_\\\n_追随他的速度跑得飞快_\\\n_不由自主比赛_\\\n——《笨小孩的道歉信》\n\n不管多少个日夜，为你一直唱。", "description": "$m^3$ 可以表示为 $m$ 个连续奇数的和 $(m \\geqslant 1)$：  \n$$\n1^3 = 1\\\\\n2^3 = 3 + 5\\\\\n3^3 = 7 + 9 + 11\\\\\n4^3 = 13 + 15 + 17 + 19\\\\\n5^3 = 21 + 23 + 25 + 27 + 29\\\\\n\\cdots\\cdots\n$$\n\n在左昂对奇数的狂热崇拜的影响下，苏信好写出来的歌只会是奇数长度。显然歌曲的长度不能是负数。\n\n对于一首长度为 $x$ 的歌，它的悦耳值 $f(x)$ 满足将 $f(x)^3$ 按照上面的规律表示出来后，$x$ 是其中的一个加数。例如 $f(21) = 5, f(11) = 3,f(3) = 2$。\n\n第二天，左昂前来参观，发现苏信好只写出来了一首歌，鄙夷不已。苏信好怒从心起，写出了以 $1\\sim k$ 内所有长度为奇数的歌。\n\n现在左昂想要知道苏信好所有歌的悦耳值之和，以预估他的狂热崇拜的效果。即：给定一个正奇数 $k(1\\leqslant k< 2^{64})$，求 $s = \\sum\\limits_{i = 1}^{\\frac{k + 1}{2}} f(2\\times i - 1)$，即 $f(1) + f(3) + f(5) + \\cdots +f(k)$。  \n\n由于苏信好实在太生气，写出来的歌的悦耳值可能十分之大，你只需要输出 $s\\bmod{10^9 + 7}$ 的结果。\n\n**本题有多组数据。**", "inputFormat": "为避免输入量过大，你需要使用下面的方式读入，因此请将这段代码复制到你的代码中。**下列程序与此题做法无关，请仔细阅读示例代码中的注释。**\n\n```cpp\nnamespace Mker {\n\ttypedef unsigned long long ull;\n\tull SA, SB, SC, p = -1;\n\tint base;\n\tvoid init(){scanf(\"%llu%llu%llu%d\", &SA, &SB, &SC, &base); p = p << (65 - base) >> (65 - base);}\n\tull rand() {\n\t\tull now = SC; now += !(now & 1);\n\t    SA ^= SA << 32, SA ^= SA >> 13, SA ^= SA << 1;\n\t    ull t = SA;\n\t\treturn SA = SB, SB = SC, SC ^= t ^ SA, (now & p) + p + 1;\n\t}\n}\n```\n先读入一个数 $T$，表示数据组数，然后你**需要调用** `Mker::init()`。这个函数将输入四个数 $SA,SB,SC,base$，表示对于这组数据，$k<2^{base}$。\n\n接下来，对于每一组询问，你应当令 $k$ 的值即为 `Mker::rand()`。\n\n示例代码：\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint T;\n\nnamespace Mker {\n\ttypedef unsigned long long ull;\n\tull SA, SB, SC, p = -1;\n\tint base;\n\tvoid init(){scanf(\"%llu%llu%llu%d\", &SA, &SB, &SC, &base); p = p << (65 - base) >> (65 - base);}\n\tull rand() {\n\t\tull now = SC; now += !(now & 1);\n\t    SA ^= SA << 32, SA ^= SA >> 13, SA ^= SA << 1;\n\t    ull t = SA;\n\t\treturn SA = SB, SB = SC, SC ^= t ^ SA, (now & p) + p + 1;\n\t}\n}\n\nint main() {\n\tscanf(\"%d\", &T); Mker::init(); // 不要忘记 init\n//\tcout << Mker::base << endl; 你可以通过这种方式输出得到 base 的值 \n\twhile (T--) {\n\t\tunsigned long long k = Mker::rand(); // 通过这种方式，获得一次询问的 k\n\t\tif (k == 1) puts(\"1\");\n\t\telse if (k == 17) puts(\"26\");\n\t\telse puts(\"I AK IOI\");\n\t\t\n//\t\tcout << k << endl; 你可以通过这种方式输出得到真实的 k 以调试代码 \n\t}\n\treturn 0;\n}\n```", "outputFormat": "$T$ 行，每行一个数 $s\\bmod{10^9 + 7}$，其中 $s$ 表示苏信好的歌的悦耳值之和。", "hint": "\n|  Subtask |  数据范围  | 分值 |\n|:----:|:----:|:----:|\n| Subtask 1 | $T=1$，$k< 2^{25}$ | $20$ |\n| Subtask 2 | $T\\leq 5$，$k< 2^{48}$ | $30$ |\n| Subtask 3 | $T\\leq 10^6$，$k < 2^{48}$ | $40$ |\n| Subtask 4 | $T\\leq 3\\times 10^6$，$k < 2^{64}$ | $10$ |\n\n**请注意常数因子对程序效率的影响。**", "locale": "zh-CN"}}}
{"pid": "P9397", "type": "P", "difficulty": 2, "samples": [["4\n1 3\n2 2\n2 1\n3 4", "2\n1 4\n2 3"], ["6\n1 5\n2 3\n2 4\n2 5\n2 -1\n3 -3", "2\n1 3\n4 6\n2 5"]], "limits": {"time": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["贪心", "Special Judge", "O2优化", "排序", "构造"], "title": "「DBOI」Round 1 DTTM", "background": "张则雨和穆制程坐在天台上看着满天的星辰。在他们的世界，流行一种连接星星的活动。他们对此有一种浪漫的诠释：如果连不完，剩下的一颗星星就是身旁的人；如果连得完，那身边的人和自己都是星星。", "description": "星空中有 $n$ 颗星星，第 $i$ 颗位于坐标 $(x_i,y_i)$。你需要把星星连接成满足张则雨的如下需求：\n\n- 每一颗星星都是且仅是一条线段的端点，所有线段互不相交（包括端点）。\n- 所有线段左右端点 $|x_l-x_r|$ 之和有最小值。 \n\n然而张则雨有点笨，并不知道应该怎么连。穆制程知道你是地球上最聪明的人，于是告诉你 $n$ 颗星星的坐标，你需要输出连接方案或者报告无解。", "inputFormat": "第一行 $n$ 表示星星的数量。\n\n从第二行开始，共 $n$ 行，每行两个整数。第 $i+1$ 行表示第 $i$ 颗星星的 $(x_i,y_i)$ 坐标。 ", "outputFormat": "第一行输出所有线段左右端点 $|x_l-x_r|$ 的和的最小值。\n\n接下来每一行输出两个编号，表示为了得到最小值，你每条线段连接的星星的编号。\n\n如果有多种可能的连接方案，输出任意一种。如果无解在第一行输出 $-1$。", "hint": "样例 1 的方案如图：\n\n![](https://s1.ax1x.com/2023/04/06/ppomH5q.png)\n\n样例 2 的方案如图：\n\n![](https://s1.ax1x.com/2023/04/06/ppomDDH.png)\n\n**本题使用捆绑测试与子任务依赖。**\n\n| $\\rm Subtask$ | $n\\leqslant$ | $(x,y)$ | 特殊性质 | 得分 | 子任务依赖 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $10$ | $0\\leqslant x,y\\leqslant 20$ | 无 | $10$ | 无 |\n| $2$ | $10^3$ | $0\\leqslant x,y\\leqslant10^3$ | 无 | $15$ | $1$ |\n| $3$ | $10^3$ | $0\\leqslant x,y\\leqslant10^9$ | 无 | $15$ | $1,2$ |\n| $4$ | $5\\times10^5$ |$-10^9\\leqslant x,y\\leqslant10^9$  | $A$ | $5$ | 无 |\n| $5$ | $5\\times10^5$ | $-10^3\\leqslant x,y\\leqslant10^3$ | 无 | $20$ | $1,2$\n| $6$ | $5\\times10^5$ | $-10^9\\leqslant x,y\\leqslant10^9$ | 无 | $35$ | $1,2,3,4,5$\n\n\n特殊性质 $A$：满足所有 $x_i$ 都相等。\n\n保证对于 $100\\%$ 的数据，$1\\leqslant n\\leqslant5\\times 10^5$，$0\\leqslant|x|,|y|\\leqslant 10^9$ 且对于任意 $i\\ne j$，有 $(x_i,y_i)\\neq (x_j,y_j)$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「DBOI」Round 1 DTTM", "background": "张则雨和穆制程坐在天台上看着满天的星辰。在他们的世界，流行一种连接星星的活动。他们对此有一种浪漫的诠释：如果连不完，剩下的一颗星星就是身旁的人；如果连得完，那身边的人和自己都是星星。", "description": "星空中有 $n$ 颗星星，第 $i$ 颗位于坐标 $(x_i,y_i)$。你需要把星星连接成满足张则雨的如下需求：\n\n- 每一颗星星都是且仅是一条线段的端点，所有线段互不相交（包括端点）。\n- 所有线段左右端点 $|x_l-x_r|$ 之和有最小值。 \n\n然而张则雨有点笨，并不知道应该怎么连。穆制程知道你是地球上最聪明的人，于是告诉你 $n$ 颗星星的坐标，你需要输出连接方案或者报告无解。", "inputFormat": "第一行 $n$ 表示星星的数量。\n\n从第二行开始，共 $n$ 行，每行两个整数。第 $i+1$ 行表示第 $i$ 颗星星的 $(x_i,y_i)$ 坐标。 ", "outputFormat": "第一行输出所有线段左右端点 $|x_l-x_r|$ 的和的最小值。\n\n接下来每一行输出两个编号，表示为了得到最小值，你每条线段连接的星星的编号。\n\n如果有多种可能的连接方案，输出任意一种。如果无解在第一行输出 $-1$。", "hint": "样例 1 的方案如图：\n\n![](https://s1.ax1x.com/2023/04/06/ppomH5q.png)\n\n样例 2 的方案如图：\n\n![](https://s1.ax1x.com/2023/04/06/ppomDDH.png)\n\n**本题使用捆绑测试与子任务依赖。**\n\n| $\\rm Subtask$ | $n\\leqslant$ | $(x,y)$ | 特殊性质 | 得分 | 子任务依赖 |\n| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |\n| $1$ | $10$ | $0\\leqslant x,y\\leqslant 20$ | 无 | $10$ | 无 |\n| $2$ | $10^3$ | $0\\leqslant x,y\\leqslant10^3$ | 无 | $15$ | $1$ |\n| $3$ | $10^3$ | $0\\leqslant x,y\\leqslant10^9$ | 无 | $15$ | $1,2$ |\n| $4$ | $5\\times10^5$ |$-10^9\\leqslant x,y\\leqslant10^9$  | $A$ | $5$ | 无 |\n| $5$ | $5\\times10^5$ | $-10^3\\leqslant x,y\\leqslant10^3$ | 无 | $20$ | $1,2$\n| $6$ | $5\\times10^5$ | $-10^9\\leqslant x,y\\leqslant10^9$ | 无 | $35$ | $1,2,3,4,5$\n\n\n特殊性质 $A$：满足所有 $x_i$ 都相等。\n\n保证对于 $100\\%$ 的数据，$1\\leqslant n\\leqslant5\\times 10^5$，$0\\leqslant|x|,|y|\\leqslant 10^9$ 且对于任意 $i\\ne j$，有 $(x_i,y_i)\\neq (x_j,y_j)$。", "locale": "zh-CN"}}}
