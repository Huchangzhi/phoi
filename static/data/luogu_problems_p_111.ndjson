{"pid": "P3249", "type": "P", "difficulty": 6, "samples": [["9 14 5\n0 0\n1 0\n2 0\n0 1\n1 1\n2 1\n0 2\n1 2\n2 2\n1 2\n2 3\n5 6\n7 8\n8 9\n1 4\n4 7\n5 8\n3 6\n6 9\n4 8\n1 5\n2 6\n6 8\n3 3 0 4 7 1 3 4 6 4 8 0 4 3 6 2 3 8 0 4 6 2 5 0 4 5 7 6 3", "1 1 \n1 2 \n1 1 \n9 10 \n3 4"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2016", "各省省选", "湖南", "枚举", "深度优先搜索 DFS", "生成树"], "title": "[HNOI2016] 矿区", "background": "", "description": "平面上的矿区划分成了若干个开发区域。\n\n简单地说，你可以将矿区看成一张连通的平面图，平面图划分为了若干平面块，每个平面块即为一个开发区域，平面块之间的边界必定由若干整点(坐标值为整数的点)和连接这些整点的线段组成。每个开发区域的矿量与该开发区域的面积有关：具体而言，面积为 $ s $ 的开发区域的矿量为 $ s^2 $。\n\n现在有 $ m $ 个开采计划。每个开采计划都指定了一个由若干开发区域组成的多边形，一个开采计划的优先度被规定为矿量的总和÷开发区域的面积和；例如，若某开采计划指定两个开发区域，面积分别为 $ a $ 和 $ b $，则优先度为 $ (a^2+b^2)/(a+b) $。由于平面图是按照划分开发区域边界的点和边给出的，因此每个开采计划也只说明了其指定多边形的边界，并未详细指明是哪些开发区域（但很明显，只要给出了多边形的边界就可以求出是些开发区域）。\n\n你的任务是求出每个开采计划的优先度。为了避免精度问题，你的答案必须按照分数的格式输出，即求出分子和分母，且必须是最简形式（分子和分母都为整数，而且都消除了最大公约数；例如，若矿量总和是 $ 1.5 $，面积和是 $ 2 $，那么分子应为 $ 3 $，分母应为 $ 4 $；又如，若矿量和是 $ 2 $，面积和是 $ 4 $，那么分子应为 \n $ 1 $，分母应为 $ 2 $）。\n\n由于某些原因，你必须依次对每个开采计划求解（即下一个开采计划会按一定格式加密，加密的方式与上一个开采计划的答案有关）。具体的加密方式见输入格式。", "inputFormat": "第一行三个正整数 $ n, m, k $，分别描述平面图中的点和边，以及开采计划的个数。  \n\n接下来 $ n $ 行，第 $ i $ 行 ( $ i = 1, 2, \\cdots , n $)有两个整数 $x_i, y_i$,  表示点 $ i $ 的坐标为 $(x_i, y_i)$。  \n\n接下来 $ m $ 行，第 $ i $ 行有两个正整数 $a, b$，表示点 $ a $ 和 $ b $ 之间有一条边。  \n\n接下来一行若干个整数，依次描述每个开采计划。每个开采计划的第一个数 $ c $ 指出该开采计划由开发区域组成的多边形边界上的点的个数为 $ d=(c+P) \\bmod n \\mathrel{+} 1 $；接下来 $ d $ 个整数，按逆时针方向描述边界上的每一个点：设其中第 $ i $ 个数为 $ z_i $，则第 $ i $ 个点的编号为 $(z_i+P)\\bmod n \\mathrel{+} 1$。其中 $ P $ 是上一个开采计划的答案中分子的值；对于第 $ 1 $ 个开采计划，$ P = 0 $。", "outputFormat": "对于每个开采计划，输出一行两个正整数，分别描述分子和分母。\n", "hint": "### 样例解释\n\n输入文件给出的 $9$ 个点和 $14$ 条边描述的平面图如下所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cg70enmo.png)\n\n第一个开采计划，输入的第 $1$ 个值为 $3$，所以该开采计划对应的多边形有 $(3+0)\\bmod 8+1=4$ 个点，将接下的 $4$ 个数 $3,0,4,7$，分别代入 $(z_i+0)\\bmod n+1$ 得到 $4$ 个点的编号为 $4,1,5,8$。计算出第一个开采计划的分子为 $1$，分母为 $1$。\n\n类似地，可计算出余下开采计划的多边形的点数和点的编号：第二个开采计划对应的多边形有 $3$ 个点，编号分别为 $5,6,8$。第三个开采计划对应的多边形有 $6$ 个点，编号分别为 $1,2,6,5,8,4$。第四个开采计划对应的多边形有 $5$ 个点，编号分别为 $1,2,6,8,4$。第五个开采计划对应的多边形有 $6$ 个点，编号分别为 $1,5,6,8,7,4$。\n\n### 数据范围及约定\n\n\n对于 $ 100 \\% $ 的数据，$ n, k \\leq 2 \\times 10^5, \\  m \\leq 3n-6, \\  |x_i|, |y_i| \\leq 3×10^4$。\n\n所有开采计划的 $ d $ 之和不超过 $2 \\times 10^6$。保证任何开采计划都包含至少一个开发区域，且这些开发区域构成一个连通块。\n\n保证所有开发区域的矿量和不超过 $ 2^{63}-1 $。\n\n保证平面图中没有多余的点和边。\n\n保证数据合法。由于输入数据量较大，建议使用读入优化。\n\n\n~~2025-06-03: 增加了一组 hack 数据~~这组 hack 数据有数据越界，于 2025.10.10 移除并且更新替换。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2016] Mining Area", "background": "", "description": "The mining area on the plane is divided into several development regions.\n\nSimply put, you can regard the mining area as a connected planar graph. The plane is partitioned into several faces, and each face is a development region. The boundaries between faces consist of integer points (points whose coordinates are integers) and line segments connecting these integer points. The mineral amount of each development region depends on its area: specifically, for a development region with area $ s $, its mineral amount is $ s^2 $.\n\nThere are $ m $ mining plans. Each plan specifies a polygon consisting of several development regions. The priority of a plan is defined as the total mineral amount divided by the total area of the selected regions. For example, if a plan specifies two regions of areas $ a $ and $ b $, then its priority is $ (a^2 + b^2)/(a + b) $. Since the planar graph is given by the points and edges that define the boundaries of development regions, each plan only specifies the boundary of its polygon, without explicitly listing which regions are included. However, once the polygon boundary is given, the included development regions are uniquely determined.\n\nYour task is to compute the priority for each mining plan. To avoid precision issues, your answer must be output as a fraction in irreducible form, i.e., output the numerator and denominator as integers with their greatest common divisor removed. For example, if the total mineral amount is $ 1.5 $ and the total area is $ 2 $, then the numerator should be $ 3 $ and the denominator should be $ 4 $. As another example, if the total mineral amount is $ 2 $ and the total area is $ 4 $, then the numerator should be $ 1 $ and the denominator should be $ 2 $.\n\nFor certain reasons, you must process each mining plan sequentially (the next plan is encoded based on the previous plan’s answer). The specific encoding is given in the input format.", "inputFormat": "The first line contains three positive integers $ n, m, k $, representing the number of vertices in the planar graph, the number of edges, and the number of mining plans, respectively.\n\nThe next $ n $ lines. In the $ i $-th line ($ i = 1, 2, \\cdots, n $), there are two integers $ x_i, y_i $, indicating that vertex $ i $ has coordinates $ (x_i, y_i) $.\n\nThe next $ m $ lines. In the $ i $-th line, there are two positive integers $ a, b $, indicating that there is an edge between vertices $ a $ and $ b $.\n\nThe next line contains several integers describing all mining plans in order. For each plan, the first number $ c $ determines the number of boundary vertices of the polygon formed by development regions as $ d = (c + P) \\bmod n \\mathrel{+} 1 $. Then $ d $ integers follow, giving the boundary vertices in counterclockwise order: let the $ i $-th number be $ z_i $, then the index of the $ i $-th vertex is $ (z_i + P) \\bmod n \\mathrel{+} 1 $. Here $ P $ is the numerator of the answer for the previous mining plan; for the first plan, $ P = 0 $.", "outputFormat": "For each mining plan, output one line with two positive integers, the numerator and the denominator, respectively.", "hint": "### Sample Explanation\n\nThe planar graph described by $ 9 $ points and $ 14 $ edges in the input is shown below:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cg70enmo.png)\n\nFor the first mining plan, the first value in the input is $ 3 $, so the polygon of this plan has $ (3 + 0) \\bmod 8 + 1 = 4 $ vertices. Substituting the next four numbers $ 3, 0, 4, 7 $ into $ (z_i + 0) \\bmod n + 1 $, the indices of the four vertices are $ 4, 1, 5, 8 $. The numerator of the first plan is $ 1 $, and the denominator is $ 1 $.\n\nSimilarly, the remaining polygons’ vertex counts and indices are: for the second plan, it has $ 3 $ vertices with indices $ 5, 6, 8 $. For the third plan, it has $ 6 $ vertices with indices $ 1, 2, 6, 5, 8, 4 $. For the fourth plan, it has $ 5 $ vertices with indices $ 1, 2, 6, 8, 4 $. For the fifth plan, it has $ 6 $ vertices with indices $ 1, 5, 6, 8, 7, 4 $.\n\n### Constraints\n\nFor $ 100\\% $ of the testdata, $ n, k \\leq 2 \\times 10^5 $, $ m \\leq 3n - 6 $, and $ |x_i|, |y_i| \\leq 3 \\times 10^4 $.\n\nThe sum of $ d $ over all mining plans does not exceed $ 2 \\times 10^6 $. It is guaranteed that each mining plan contains at least one development region, and these regions form a connected component.\n\nIt is guaranteed that the total mineral amount over all development regions does not exceed $ 2^{63} - 1 $.\n\nIt is guaranteed that there are no redundant vertices or edges in the planar graph.\n\nThe input is guaranteed to be valid. Because the input size is large, fast I/O is recommended.\n\n~~2025-06-03: Added a set of hack testdata~~ This set of hack testdata had out-of-bounds values. It was removed and replaced on 2025.10.10.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2016] 矿区", "background": "", "description": "平面上的矿区划分成了若干个开发区域。\n\n简单地说，你可以将矿区看成一张连通的平面图，平面图划分为了若干平面块，每个平面块即为一个开发区域，平面块之间的边界必定由若干整点(坐标值为整数的点)和连接这些整点的线段组成。每个开发区域的矿量与该开发区域的面积有关：具体而言，面积为 $ s $ 的开发区域的矿量为 $ s^2 $。\n\n现在有 $ m $ 个开采计划。每个开采计划都指定了一个由若干开发区域组成的多边形，一个开采计划的优先度被规定为矿量的总和÷开发区域的面积和；例如，若某开采计划指定两个开发区域，面积分别为 $ a $ 和 $ b $，则优先度为 $ (a^2+b^2)/(a+b) $。由于平面图是按照划分开发区域边界的点和边给出的，因此每个开采计划也只说明了其指定多边形的边界，并未详细指明是哪些开发区域（但很明显，只要给出了多边形的边界就可以求出是些开发区域）。\n\n你的任务是求出每个开采计划的优先度。为了避免精度问题，你的答案必须按照分数的格式输出，即求出分子和分母，且必须是最简形式（分子和分母都为整数，而且都消除了最大公约数；例如，若矿量总和是 $ 1.5 $，面积和是 $ 2 $，那么分子应为 $ 3 $，分母应为 $ 4 $；又如，若矿量和是 $ 2 $，面积和是 $ 4 $，那么分子应为 \n $ 1 $，分母应为 $ 2 $）。\n\n由于某些原因，你必须依次对每个开采计划求解（即下一个开采计划会按一定格式加密，加密的方式与上一个开采计划的答案有关）。具体的加密方式见输入格式。", "inputFormat": "第一行三个正整数 $ n, m, k $，分别描述平面图中的点和边，以及开采计划的个数。  \n\n接下来 $ n $ 行，第 $ i $ 行 ( $ i = 1, 2, \\cdots , n $)有两个整数 $x_i, y_i$,  表示点 $ i $ 的坐标为 $(x_i, y_i)$。  \n\n接下来 $ m $ 行，第 $ i $ 行有两个正整数 $a, b$，表示点 $ a $ 和 $ b $ 之间有一条边。  \n\n接下来一行若干个整数，依次描述每个开采计划。每个开采计划的第一个数 $ c $ 指出该开采计划由开发区域组成的多边形边界上的点的个数为 $ d=(c+P) \\bmod n \\mathrel{+} 1 $；接下来 $ d $ 个整数，按逆时针方向描述边界上的每一个点：设其中第 $ i $ 个数为 $ z_i $，则第 $ i $ 个点的编号为 $(z_i+P)\\bmod n \\mathrel{+} 1$。其中 $ P $ 是上一个开采计划的答案中分子的值；对于第 $ 1 $ 个开采计划，$ P = 0 $。", "outputFormat": "对于每个开采计划，输出一行两个正整数，分别描述分子和分母。\n", "hint": "### 样例解释\n\n输入文件给出的 $9$ 个点和 $14$ 条边描述的平面图如下所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/cg70enmo.png)\n\n第一个开采计划，输入的第 $1$ 个值为 $3$，所以该开采计划对应的多边形有 $(3+0)\\bmod 8+1=4$ 个点，将接下的 $4$ 个数 $3,0,4,7$，分别代入 $(z_i+0)\\bmod n+1$ 得到 $4$ 个点的编号为 $4,1,5,8$。计算出第一个开采计划的分子为 $1$，分母为 $1$。\n\n类似地，可计算出余下开采计划的多边形的点数和点的编号：第二个开采计划对应的多边形有 $3$ 个点，编号分别为 $5,6,8$。第三个开采计划对应的多边形有 $6$ 个点，编号分别为 $1,2,6,5,8,4$。第四个开采计划对应的多边形有 $5$ 个点，编号分别为 $1,2,6,8,4$。第五个开采计划对应的多边形有 $6$ 个点，编号分别为 $1,5,6,8,7,4$。\n\n### 数据范围及约定\n\n\n对于 $ 100 \\% $ 的数据，$ n, k \\leq 2 \\times 10^5, \\  m \\leq 3n-6, \\  |x_i|, |y_i| \\leq 3×10^4$。\n\n所有开采计划的 $ d $ 之和不超过 $2 \\times 10^6$。保证任何开采计划都包含至少一个开发区域，且这些开发区域构成一个连通块。\n\n保证所有开发区域的矿量和不超过 $ 2^{63}-1 $。\n\n保证平面图中没有多余的点和边。\n\n保证数据合法。由于输入数据量较大，建议使用读入优化。\n\n\n~~2025-06-03: 增加了一组 hack 数据~~这组 hack 数据有数据越界，于 2025.10.10 移除并且更新替换。", "locale": "zh-CN"}}}
{"pid": "P3250", "type": "P", "difficulty": 6, "samples": [["13 23\n1 2\n1 3\n2 4\n2 5\n3 6\n3 7\n4 8\n4 9\n6 10\n6 11\n7 12\n7 13\n2 1\n0 8 13 3\n0 9 12 5\n2 9\n2 8\n2 2\n0 10 12 1\n2 2\n1 3\n2 7\n2 1\n0 9 5 6\n2 4\n2 5\n1 7\n0 9 12 4\n0 10 5 7\n2 1\n2 4\n2 12\n1 2\n2 5\n2 3", "-1 \n3 \n5 \n-1 \n1 \n-1 \n1 \n1 \n3 \n6 \n7 \n7 \n4 \n6"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2016", "线段树", "各省省选", "湖南", "最近公共祖先 LCA", "树链剖分", "整体二分"], "title": "[HNOI2016] 网络", "background": "", "description": "一个简单的网络系统可以被描述成一棵无根树。每个节点为一个服务器。连接服务器与服务器的数据线则看做一条树边。两个服务器进行数据的交互时，数据会经过连接这两个服务器的路径上的所有服务器（包括这两个服务器自身）。\n\n由于这条路径是唯一的，当路径上的某个服务器出现故障，无法正常运行时，数据便无法交互。此外，每个数据交互请求都有一个重要度，越重要的请求显然需要得到越高的优先处理权。现在，你作为一个网络系统的管理员，要监控整个系统的运行状态。系统的运行也是很简单的，在每一个时刻，只有可能出现下列三种事件中的一种：\n\n1. 在某两个服务器之间出现一条新的数据交互请求；  \n2. 某个数据交互结束请求；\n3. 某个服务器出现故障。系统会在任何故障发生后立即修复。也就是在出现故障的时刻之后，这个服务器依然是正常的。但在服务器产生故障时依然会对需要经过该服务器的数据交互请求造成影响。\n\n你的任务是在每次出现故障时，维护未被影响的请求中重要度的最大值。注意，如果一个数据交互请求已经结束，则不将其纳入未被影响的请求范围。\n", "inputFormat": "第一行两个正整数 $n,m$，分别描述服务器和事件个数。服务器编号是从 $1$ 开始的，因此 $n$ 个服务器的编号依次是 $1,2,3,\\cdots,n$。\n\n接下来 $n-1$ 行，每行两个正整数 $u,v$，描述一条树边。$u$ 和 $v$ 是服务器的编号。\n\n接下来 $m$ 行，按发生时刻依次描述每一个事件；即第 $i$ 行（$i=1,2,3,...,m$）描述时刻 $i$ 发生的事件。每行的第一个数 $\\mathrm{type}$ 描述事件类型，共 $3$ 种类型：\n\n1. 若 $\\mathrm{type}=0$，之后有三个正整数 $a,b,v$，表示服务器 $a,b$ 之间出现一条重要度为 $v$ 的数据交互请求；\n2. 若 $\\mathrm{type}=1$，之后有一个正整数 $t$，表示时刻 $t$（也就是第 $t$ 个发生的事件）出现的数据交互请求结束；\n3. 若 $\\mathrm{type}=2$，之后有一个正整数 $x$，表示服务器 $x$ 在这一时刻出现了故障。\n\n对于每个 $\\mathrm{type}$ 为 $2$ 的事件，就是一次询问，即询问“当服务器 $x$ 发生故障时，未被影响的请求中重要度的最大值是多少？”注意可能有某个服务器自身与自身进行数据交互的情况。$2 \\le n \\le 10^5$，$1 \\le m \\le 2\\times 10^5$，其他的所有输入值不超过 $10^9$。\n", "outputFormat": "对于每个 $\\mathrm{type}=2$ 的事件，即服务器出现故障的事件，输出一行一个整数，描述未被影响的请求中重要度的最大值。如果此时没有任何请求，或者所有请求均被影响，则输出 $-1$。\n", "hint": "样例给出的树如下所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ka4zpxia.png)\n\n解释其中的部分询问；下面的解释中用 $(a,b;t,v)$ 表示在 $t$ 时刻出现的服务器 $a$ 和 $b$ 之间的重要度为 $v$ 的请求：\n\n对于第一个询问（在时刻 $1$），此时没有任何请求，输出 $-1$。\n\n对于第四个询问（在时刻 $6$），此时有两条交互$(8,13;2,3),(9,12;3,5)$，所有询问均经过 $2$ 号服务器，输出 $-1$。\n\n对于第五个询问（在时刻 $8$），此时有三条交互 $(8,13;2,3),(9,12;3,5),(10,12;7,1)$，只有交互 $(10,12;7,1)$ 没有经过 $2$ 号服务器，因此输出其重要度 $1$。\n\n对于最后一个询问（在时刻 $23$），此时有三条交互 $(9,5;12,6),(9,12;16,4),(10,5;17,7)$。当 $3$ 号服务器出现故障时，只有交互 $(9,5;12,6)$ 没有经过 $3$ 号服务器，因此输出 $6$。\n\n$\\text{upd 2016.5.20}$：新加一组 $\\text{Hack}$ 数据。", "locale": "zh-CN", "translations": {"en": {"title": "[HNOI2016] Network", "background": "", "description": "A simple network system can be described as an unrooted tree. Each node is a server. The data cable connecting servers is treated as a tree edge. When two servers exchange data, the data passes through all servers on the unique path connecting these two servers (including the two servers themselves).\n\nBecause this path is unique, if any server on the path fails and cannot operate normally, the data cannot be exchanged. In addition, each data exchange request has an importance value, and more important requests should clearly receive higher priority. Now, as the administrator of a network system, you need to monitor the system’s operating status. The system behavior is simple: at each time, exactly one of the following three events may occur:\n\n1. A new data exchange request appears between two servers.\n2. A data exchange request ends.\n3. A server fails. The system will repair it immediately after any failure. That is, right after the moment the failure occurs, this server is still normal. However, at the moment the failure occurs, it still affects data exchange requests that need to pass through this server.\n\nYour task is to maintain, for each failure, the maximum importance value among the requests that are not affected. Note that if a data exchange request has already ended, it is not considered among the unaffected requests.\n\nNote that a data exchange request may occur between a server and itself. $2 \\le n \\le 10^5$, $1 \\le m \\le 2\\times 10^5$, and all other input values do not exceed $10^9$.", "inputFormat": "The first line contains two positive integers $n,m$, denoting the numbers of servers and events, respectively. Server IDs start from $1$, so the $n$ servers are numbered $1,2,3,\\cdots,n$.\n\nThe next $n-1$ lines each contain two positive integers $u,v$, describing a tree edge. $u$ and $v$ are server IDs.\n\nThe next $m$ lines describe each event in chronological order; that is, the $i$-th line ($i=1,2,3,\\ldots,m$) describes the event that occurs at time $i$. The first number $\\mathrm{type}$ denotes the event type, with three types in total:\n\n1. If $\\mathrm{type}=0$, then three positive integers $a,b,v$ follow, meaning that a data exchange request with importance $v$ appears between servers $a$ and $b$.\n2. If $\\mathrm{type}=1$, then a positive integer $t$ follows, meaning that the data exchange request that appeared at time $t$ (i.e., the $t$-th event) ends.\n3. If $\\mathrm{type}=2$, then a positive integer $x$ follows, meaning that server $x$ fails at this moment.\n\nEach event with $\\mathrm{type}=2$ is a query, i.e., “When server $x$ fails, what is the maximum importance among the requests that are not affected?”", "outputFormat": "For each event with $\\mathrm{type}=2$ (i.e., a server failure), output one line with one integer, the maximum importance among the requests that are not affected. If there is currently no request, or all requests are affected, output $-1$.", "hint": "The tree given in the sample is shown below:\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ka4zpxia.png)\n\nExplanations for some queries; in the explanations below, $(a,b;t,v)$ denotes a request that appears at time $t$ between servers $a$ and $b$ with importance $v$:\n\nFor the first query (at time $1$), there is no request, so output $-1$.\n\nFor the fourth query (at time $6$), there are two requests $(8,13;2,3)$ and $(9,12;3,5)$. Both paths pass through server $2$, so output $-1$.\n\nFor the fifth query (at time $8$), there are three requests $(8,13;2,3)$, $(9,12;3,5)$, and $(10,12;7,1)$. Only the request $(10,12;7,1)$ does not pass through server $2$, so output its importance $1$.\n\nFor the last query (at time $23$), there are three requests $(9,5;12,6)$, $(9,12;16,4)$, and $(10,5;17,7)$. When server $3$ fails, only the request $(9,5;12,6)$ does not pass through server $3$, so output $6$.\n\n$\\text{upd 2016.5.20}$：Added one set of $\\text{Hack}$ testdata.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HNOI2016] 网络", "background": "", "description": "一个简单的网络系统可以被描述成一棵无根树。每个节点为一个服务器。连接服务器与服务器的数据线则看做一条树边。两个服务器进行数据的交互时，数据会经过连接这两个服务器的路径上的所有服务器（包括这两个服务器自身）。\n\n由于这条路径是唯一的，当路径上的某个服务器出现故障，无法正常运行时，数据便无法交互。此外，每个数据交互请求都有一个重要度，越重要的请求显然需要得到越高的优先处理权。现在，你作为一个网络系统的管理员，要监控整个系统的运行状态。系统的运行也是很简单的，在每一个时刻，只有可能出现下列三种事件中的一种：\n\n1. 在某两个服务器之间出现一条新的数据交互请求；  \n2. 某个数据交互结束请求；\n3. 某个服务器出现故障。系统会在任何故障发生后立即修复。也就是在出现故障的时刻之后，这个服务器依然是正常的。但在服务器产生故障时依然会对需要经过该服务器的数据交互请求造成影响。\n\n你的任务是在每次出现故障时，维护未被影响的请求中重要度的最大值。注意，如果一个数据交互请求已经结束，则不将其纳入未被影响的请求范围。\n", "inputFormat": "第一行两个正整数 $n,m$，分别描述服务器和事件个数。服务器编号是从 $1$ 开始的，因此 $n$ 个服务器的编号依次是 $1,2,3,\\cdots,n$。\n\n接下来 $n-1$ 行，每行两个正整数 $u,v$，描述一条树边。$u$ 和 $v$ 是服务器的编号。\n\n接下来 $m$ 行，按发生时刻依次描述每一个事件；即第 $i$ 行（$i=1,2,3,...,m$）描述时刻 $i$ 发生的事件。每行的第一个数 $\\mathrm{type}$ 描述事件类型，共 $3$ 种类型：\n\n1. 若 $\\mathrm{type}=0$，之后有三个正整数 $a,b,v$，表示服务器 $a,b$ 之间出现一条重要度为 $v$ 的数据交互请求；\n2. 若 $\\mathrm{type}=1$，之后有一个正整数 $t$，表示时刻 $t$（也就是第 $t$ 个发生的事件）出现的数据交互请求结束；\n3. 若 $\\mathrm{type}=2$，之后有一个正整数 $x$，表示服务器 $x$ 在这一时刻出现了故障。\n\n对于每个 $\\mathrm{type}$ 为 $2$ 的事件，就是一次询问，即询问“当服务器 $x$ 发生故障时，未被影响的请求中重要度的最大值是多少？”注意可能有某个服务器自身与自身进行数据交互的情况。$2 \\le n \\le 10^5$，$1 \\le m \\le 2\\times 10^5$，其他的所有输入值不超过 $10^9$。\n", "outputFormat": "对于每个 $\\mathrm{type}=2$ 的事件，即服务器出现故障的事件，输出一行一个整数，描述未被影响的请求中重要度的最大值。如果此时没有任何请求，或者所有请求均被影响，则输出 $-1$。\n", "hint": "样例给出的树如下所示：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ka4zpxia.png)\n\n解释其中的部分询问；下面的解释中用 $(a,b;t,v)$ 表示在 $t$ 时刻出现的服务器 $a$ 和 $b$ 之间的重要度为 $v$ 的请求：\n\n对于第一个询问（在时刻 $1$），此时没有任何请求，输出 $-1$。\n\n对于第四个询问（在时刻 $6$），此时有两条交互$(8,13;2,3),(9,12;3,5)$，所有询问均经过 $2$ 号服务器，输出 $-1$。\n\n对于第五个询问（在时刻 $8$），此时有三条交互 $(8,13;2,3),(9,12;3,5),(10,12;7,1)$，只有交互 $(10,12;7,1)$ 没有经过 $2$ 号服务器，因此输出其重要度 $1$。\n\n对于最后一个询问（在时刻 $23$），此时有三条交互 $(9,5;12,6),(9,12;16,4),(10,5;17,7)$。当 $3$ 号服务器出现故障时，只有交互 $(9,5;12,6)$ 没有经过 $3$ 号服务器，因此输出 $6$。\n\n$\\text{upd 2016.5.20}$：新加一组 $\\text{Hack}$ 数据。", "locale": "zh-CN"}}}
{"pid": "P3251", "type": "P", "difficulty": 6, "samples": [["0.5 0 1\n1\n0.5 1 2\n1 2", "1.000\n2.000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2012", "各省省选", "吉林"], "title": "[JLOI2012] 时间流逝", "background": null, "description": "生活可以很简单。可以探索水底世界的神秘，也可以去发现奇特新生物，亦或踏上一段新生的旅程。在必须要迎接挑战或跟周围的生物进行生存争夺之前，享受自由的飞翔。此时你会觉得生活是如此美好。\n\n像蛇喜欢吃浮游生物一样（哦，我好像忘记告诉你这个常识），每天，你可以吃一些你周围的基础生物，然后会在你的尾巴上得到一个能量圈。你将会有好多种不同的能量圈，每一个都会被赋予一个能量。你可以拥有多个同种的能量圈，但是对于新得到的相同的能量圈，它的能量不能大于你已拥有的任何一个能量圈。除了前面的规则，获得新的能量圈的种类的概率是一样的。一天天过去，你得到越来越多的能量，开始了进化演变。\n\n但是你也有自己的问题，有时你会面对邪恶的果冻鱼。它会追着你咬你，你不得不扔出最小能量值的能量圈然后赶忙逃跑。在这种情况下，你不会有任何的胃口了，因此这天你将不再得到任何能量圈。幸好，当你没有任何能量圈的时候，果冻鱼就算看见你也不会追着你，此时你可以好好地享用美食。\n\n你听说当你的总的能量值超过了某个阈值之后，可以进化成强大模式并能够吃掉果冻鱼。是时候反击了！下面是本题的问题：预计要过多少天你才能进化成强大模式？（第一天默认你没有任何能量圈）", "inputFormat": "输入包含多个测例。对每个测例会有两行。第一行是一个浮点数 $P$，一个整数 $T$ 和一个整数 $N$。$P$ 是每天遇到果冻鱼的概率，$T$ 是阈值。第二行是 $N$ 个不同的正整数，表示每一种能量圈的能量值。", "outputFormat": "对于每个测例，输出一行表示预计要过多少天你的能量值能够超过阈值，四舍五入到三位小数。", "hint": "对于所有数据，$0.1\\le P\\le0.9$，$1\\le T\\le50$，$1\\le N\\le50$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2012] The Passage of Time", "background": "", "description": "Life can be simple. You can explore the mysteries of the underwater world, discover strange new organisms, or embark on a fresh journey. Before you must face challenges or compete with nearby creatures for survival, enjoy the freedom of flight. At such moments, life feels wonderful.\n\nLike how snakes enjoy eating plankton (oh, I seem to have forgotten to tell you this common fact), each day you can eat some basic organisms around you and then gain an energy ring on your tail. You will have many different kinds of energy rings, each assigned an energy value. You can possess multiple rings of the same kind, but for a newly obtained ring of the same kind, its energy cannot be greater than that of any energy ring you already possess. Apart from the above rule, the probability of obtaining a new ring’s kind is uniform. Day by day, you accumulate more energy and begin to evolve.\n\nBut you have your own problems. Sometimes you face the evil jellyfish. It chases and bites you, so you must throw away the energy ring with the smallest energy value and then hurriedly escape. On such a day, you will have no appetite and thus will not gain any energy ring. Fortunately, when you have no energy rings, the jellyfish will not chase you even if it sees you, and you can then enjoy your meal.\n\nYou have heard that when your total energy exceeds a certain threshold, you can evolve into a powerful mode and even eat the jellyfish. It is time to fight back! Here is the question: how many days are expected to pass before you evolve into the powerful mode? (On the first day, you are assumed to have no energy rings.)", "inputFormat": "The input contains multiple test cases. Each test case consists of two lines.\n- The first line contains a floating-point number P, an integer T, and an integer N. P is the probability of encountering the jellyfish on a given day, and T is the threshold.\n- The second line contains N distinct positive integers, representing the energy value of each kind of energy ring.\n\nEach day proceeds independently. If you encounter the jellyfish and you currently have at least one ring, you discard the ring with the smallest energy and do not gain any ring that day. If you have no rings, the jellyfish will not chase you, and you proceed to gain one ring that day. When you gain a ring, its kind is chosen uniformly at random among the N kinds. You may obtain duplicates of the same kind.", "outputFormat": "For each test case, output one line with the expected number of days until your total energy strictly exceeds the threshold, rounded to three decimal places.", "hint": "Constraints: For all testdata, $0.1 \\le P \\le 0.9$, $1 \\le T \\le 50$, $1 \\le N \\le 50$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2012] 时间流逝", "background": null, "description": "生活可以很简单。可以探索水底世界的神秘，也可以去发现奇特新生物，亦或踏上一段新生的旅程。在必须要迎接挑战或跟周围的生物进行生存争夺之前，享受自由的飞翔。此时你会觉得生活是如此美好。\n\n像蛇喜欢吃浮游生物一样（哦，我好像忘记告诉你这个常识），每天，你可以吃一些你周围的基础生物，然后会在你的尾巴上得到一个能量圈。你将会有好多种不同的能量圈，每一个都会被赋予一个能量。你可以拥有多个同种的能量圈，但是对于新得到的相同的能量圈，它的能量不能大于你已拥有的任何一个能量圈。除了前面的规则，获得新的能量圈的种类的概率是一样的。一天天过去，你得到越来越多的能量，开始了进化演变。\n\n但是你也有自己的问题，有时你会面对邪恶的果冻鱼。它会追着你咬你，你不得不扔出最小能量值的能量圈然后赶忙逃跑。在这种情况下，你不会有任何的胃口了，因此这天你将不再得到任何能量圈。幸好，当你没有任何能量圈的时候，果冻鱼就算看见你也不会追着你，此时你可以好好地享用美食。\n\n你听说当你的总的能量值超过了某个阈值之后，可以进化成强大模式并能够吃掉果冻鱼。是时候反击了！下面是本题的问题：预计要过多少天你才能进化成强大模式？（第一天默认你没有任何能量圈）", "inputFormat": "输入包含多个测例。对每个测例会有两行。第一行是一个浮点数 $P$，一个整数 $T$ 和一个整数 $N$。$P$ 是每天遇到果冻鱼的概率，$T$ 是阈值。第二行是 $N$ 个不同的正整数，表示每一种能量圈的能量值。", "outputFormat": "对于每个测例，输出一行表示预计要过多少天你的能量值能够超过阈值，四舍五入到三位小数。", "hint": "对于所有数据，$0.1\\le P\\le0.9$，$1\\le T\\le50$，$1\\le N\\le50$。", "locale": "zh-CN"}}}
{"pid": "P3252", "type": "P", "difficulty": 3, "samples": [["3 3\n1 2 3\n1 2\n1 3", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "搜索", "2012", "各省省选", "吉林"], "title": "[JLOI2012] 树", "background": "", "description": "在这个问题中，给定一个值 $s$ 和一棵树。在树的每个节点有一个权值，第 $i$ 个点的权值为 $a_i$，问有多少条路径的节点权值总和为 $s$。路径中节点的深度必须是升序的。假设节点 $1$ 是根节点，根的深度是 $0$，它的儿子节点的深度为 $1$。路径不必一定从根节点开始。", "inputFormat": "第一行有两个整数 $n$ 和 $s$，其中 $n$ 是树的节点数。 \n\n第二行有 $n$ 个整数，第 $i$ 个整数 $a_i$ 表示节点 $i$ 的权值。\n\n接下来的 $(n-1)$ 行，每行有两个个整数 $x$ 和 $y$，表示 $y$ 是 $x$ 的儿子。", "outputFormat": "输出路径节点总和为 $s$ 的路径数量。\n", "hint": "#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 10^5$，$1 \\leq a_i, s \\leq 10^3$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2012] Tree", "background": "", "description": "In this problem, you are given a value $s$ and a tree. Each node has a weight; the $i$-th node has weight $a_i$. Count how many paths have a total sum of node weights equal to $s$. The depths of nodes along a path must be in strictly increasing order. Assume node $1$ is the root, its depth is $0$, and the depth of each of its children is $1$. A path does not have to start at the root.", "inputFormat": "The first line contains two integers $n$ and $s$, where $n$ is the number of nodes in the tree.\n\nThe second line contains $n$ integers; the $i$-th integer $a_i$ denotes the weight of node $i$.\n\nThe next $n - 1$ lines each contain two integers $x$ and $y$, indicating that $y$ is a child of $x$.", "outputFormat": "Output the number of paths whose total node weight equals $s$.", "hint": "Constraints\n\n- For $100\\%$ of the testdata, it holds that $1 \\leq n \\leq 10^5$, $1 \\leq a_i, s \\leq 10^3$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2012] 树", "background": "", "description": "在这个问题中，给定一个值 $s$ 和一棵树。在树的每个节点有一个权值，第 $i$ 个点的权值为 $a_i$，问有多少条路径的节点权值总和为 $s$。路径中节点的深度必须是升序的。假设节点 $1$ 是根节点，根的深度是 $0$，它的儿子节点的深度为 $1$。路径不必一定从根节点开始。", "inputFormat": "第一行有两个整数 $n$ 和 $s$，其中 $n$ 是树的节点数。 \n\n第二行有 $n$ 个整数，第 $i$ 个整数 $a_i$ 表示节点 $i$ 的权值。\n\n接下来的 $(n-1)$ 行，每行有两个个整数 $x$ 和 $y$，表示 $y$ 是 $x$ 的儿子。", "outputFormat": "输出路径节点总和为 $s$ 的路径数量。\n", "hint": "#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 10^5$，$1 \\leq a_i, s \\leq 10^3$。", "locale": "zh-CN"}}}
{"pid": "P3253", "type": "P", "difficulty": 5, "samples": [["3 3\n1\n4\n5\n2\n7\n3", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "2013", "各省省选", "树状数组", "吉林", "栈"], "title": "[JLOI2013] 删除物品", "background": "", "description": "箱子再分配问题需要解决如下问题：\n\n1. 一共有 $N$ 个物品，堆成 $M$ 堆。\n\n2. 所有物品都是一样的，但是它们有不同的优先级。\n\n3. 你只能够移动某堆中位于顶端的物品。\n\n4. 你可以把任意一堆中位于顶端的物品移动到其它某堆的顶端。若此物品是当前所有物品中优先级最高的，可以直接将之删除而不用移动。\n\n5. 求出将所有物品删除所需的最小步数。删除操作不计入步数之中。\n\n6. 这是一个比较难解决的问题，这里你只需要解决一个比较简单的版本：不会有两个物品有着相同的优先级，且 $M=2$。", "inputFormat": "第一行是包含两个整数 $N_1$, $N_2$ 分别表示两堆物品的个数。接下来有 $N_1$ 行整数按照从顶到底的顺序分别给出了第一堆物品中的优先级，数字越大，优先级越高。再接下来的 $N_2$ 行按照同样的格式给出了第二堆物品的优先级。", "outputFormat": "对于每个数据，请输出一个整数，即最小移动步数。", "hint": "$1\\leq N_1+N_2\\leq 100000$，优先级 $\\le 10^7$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2013] Deleting Items", "background": "", "description": "Consider the following box redistribution problem:\n\n1. There are $N$ items arranged into $M$ stacks.\n2. All items are identical, but they have different priorities.\n3. You may move only the top item of a stack.\n4. You may move the top item of any stack onto the top of another stack. If this item is currently the highest-priority among all items, you may delete it immediately instead of moving it.\n5. Find the minimum number of moves needed to delete all items. Deletions do not count toward the move count.\n6. This is a simplified version: no two items have the same priority, and $M = 2$.", "inputFormat": "The first line contains two integers $N_1$, $N_2$ denoting the numbers of items in the two stacks, respectively. Then $N_1$ lines follow, giving the priorities in the first stack from top to bottom; larger numbers indicate higher priority. Then $N_2$ lines follow in the same format for the second stack.", "outputFormat": "For the given testdata, output a single integer, the minimum number of moves.", "hint": "Constraints:\n$1 \\le N_1 + N_2 \\le 100000$, priorities $\\le 10^7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2013] 删除物品", "background": "", "description": "箱子再分配问题需要解决如下问题：\n\n1. 一共有 $N$ 个物品，堆成 $M$ 堆。\n\n2. 所有物品都是一样的，但是它们有不同的优先级。\n\n3. 你只能够移动某堆中位于顶端的物品。\n\n4. 你可以把任意一堆中位于顶端的物品移动到其它某堆的顶端。若此物品是当前所有物品中优先级最高的，可以直接将之删除而不用移动。\n\n5. 求出将所有物品删除所需的最小步数。删除操作不计入步数之中。\n\n6. 这是一个比较难解决的问题，这里你只需要解决一个比较简单的版本：不会有两个物品有着相同的优先级，且 $M=2$。", "inputFormat": "第一行是包含两个整数 $N_1$, $N_2$ 分别表示两堆物品的个数。接下来有 $N_1$ 行整数按照从顶到底的顺序分别给出了第一堆物品中的优先级，数字越大，优先级越高。再接下来的 $N_2$ 行按照同样的格式给出了第二堆物品的优先级。", "outputFormat": "对于每个数据，请输出一个整数，即最小移动步数。", "hint": "$1\\leq N_1+N_2\\leq 100000$，优先级 $\\le 10^7$。", "locale": "zh-CN"}}}
{"pid": "P3254", "type": "P", "difficulty": 5, "samples": [["4 5\n4 5 3 5\n3 5 2 6 4\n", "1\n1 2 4 5\n1 2 3 4 5\n2 4 5\n1 2 3 4 5\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["网络流", "Special Judge", "网络流与线性规划 24 题"], "title": "圆桌问题", "background": "", "description": "有来自 $m$ 个不同单位的代表参加一次国际会议。第 $i$ 个单位派出了 $r_i$ 个代表。\n\n会议的餐厅共有 $n$ 张餐桌，第 $i$ 张餐桌可容纳 $c_i$ 个代表就餐。\n\n为了使代表们充分交流，希望从同一个单位来的代表不在同一个餐桌就餐。请给出一个满足要求的代表就餐方案。", "inputFormat": "输入的第一行是用空格隔开的两个整数，分别代表单位的个数 $m$ 和餐桌的个数 $n$。  \n第二行有 $m$ 个用空格隔开的整数，第 $i$ 个整数代表第 $i$ 个单位的代表人数 $r_i$。  \n第三行有 $n$ 个用空格隔开的整数，第 $i$ 个整数代表第 $i$ 张餐桌能容纳的人数 $c_i$。", "outputFormat": "**本题存在 Special Judge**。  \n请输出是否存在满足要求的就餐方案，若存在，请给出任意一种可行的方案。  \n输出的第一行是一个非 $0$ 即 $1$ 的整数，若存在方案则输出 $1$，否则输出 $0$。  \n若存在方案，则对于第 $2$ 到第 $(m + 1)$ 行，在第 $(i + 1)$ 行输出 $r_i$ 个整数，代表第 $i$ 个单位的代表就餐的餐桌编号。", "hint": "**【数据规模与约定】**\n\n- 对于 $100\\%$ 的数据，保证 $1 \\leq m \\leq 150$，$1 \\leq n \\leq 270$，$1 \\leq r_i, c_i \\leq 10^3$。\n\n**【提示】**\n\n- 请注意输入的第一行先读入 $m$ 再读入 $n$。", "locale": "zh-CN", "translations": {"en": {"title": "Round Table Problem", "background": "", "description": "There are representatives from $m$ different units attending an international conference. The $i$-th unit sends $r_i$ representatives.\n\nThe conference restaurant has $n$ tables, and the $i$-th table can seat $c_i$ representatives.\n\nTo encourage communication, representatives from the same unit should not dine at the same table. Please provide a dining arrangement that satisfies this requirement.", "inputFormat": "The first line contains two integers separated by a space, representing the number of units $m$ and the number of tables $n$.\nThe second line contains $m$ integers separated by spaces, where the $i$-th integer represents the number of representatives $r_i$ in the $i$-th unit.\nThe third line contains $n$ integers separated by spaces, where the $i$-th integer represents the capacity $c_i$ of the $i$-th table.", "outputFormat": "This problem uses Special Judge.\nOutput whether a valid arrangement exists. If it exists, output any valid arrangement.\nThe first line contains a single integer, either $0$ or $1$. Output $1$ if a valid arrangement exists; otherwise, output $0$.\nIf it exists, then for lines $2$ to $(m + 1)$, on line $(i + 1)$ output $r_i$ integers, representing the table indices where the representatives of the $i$-th unit will dine.", "hint": "- Constraints:\n  - For $100\\%$ of the testdata, $1 \\leq m \\leq 150$, $1 \\leq n \\leq 270$, $1 \\leq r_i, c_i \\leq 10^3$.\n- Hint:\n  - Note that the first line of input reads $m$ first, then $n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "圆桌问题", "background": "", "description": "有来自 $m$ 个不同单位的代表参加一次国际会议。第 $i$ 个单位派出了 $r_i$ 个代表。\n\n会议的餐厅共有 $n$ 张餐桌，第 $i$ 张餐桌可容纳 $c_i$ 个代表就餐。\n\n为了使代表们充分交流，希望从同一个单位来的代表不在同一个餐桌就餐。请给出一个满足要求的代表就餐方案。", "inputFormat": "输入的第一行是用空格隔开的两个整数，分别代表单位的个数 $m$ 和餐桌的个数 $n$。  \n第二行有 $m$ 个用空格隔开的整数，第 $i$ 个整数代表第 $i$ 个单位的代表人数 $r_i$。  \n第三行有 $n$ 个用空格隔开的整数，第 $i$ 个整数代表第 $i$ 张餐桌能容纳的人数 $c_i$。", "outputFormat": "**本题存在 Special Judge**。  \n请输出是否存在满足要求的就餐方案，若存在，请给出任意一种可行的方案。  \n输出的第一行是一个非 $0$ 即 $1$ 的整数，若存在方案则输出 $1$，否则输出 $0$。  \n若存在方案，则对于第 $2$ 到第 $(m + 1)$ 行，在第 $(i + 1)$ 行输出 $r_i$ 个整数，代表第 $i$ 个单位的代表就餐的餐桌编号。", "hint": "**【数据规模与约定】**\n\n- 对于 $100\\%$ 的数据，保证 $1 \\leq m \\leq 150$，$1 \\leq n \\leq 270$，$1 \\leq r_i, c_i \\leq 10^3$。\n\n**【提示】**\n\n- 请注意输入的第一行先读入 $m$ 再读入 $n$。", "locale": "zh-CN"}}}
{"pid": "P3255", "type": "P", "difficulty": 6, "samples": [["2\n1 2\n2 2", "2 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "数学", "2013", "各省省选", "吉林", "组合数学"], "title": "[JLOI2013] 地形生成", "background": null, "description": "最近 IK 正在做关于地形建模的工作。其中一个工作阶段就是把一些山排列成一行。每座山都有各不相同的标号和高度。为了遵从一些设计上的要求，每座山都设置了一个关键数字，要求对于每座山，比它高且排列在它前面的其它山的数目必须少于它的关键数字。显然满足要求的排列会有很多个。\n\n对于每一个可能的排列，IK 生成一个对应的标号序列和等高线序列。标号序列就是按顺序写下每座山的标号。\n\n等高线序列就是按顺序写下它们的高度。例如有两座山，这两座山的一个合法排列的第一座山的标号和高度为 $1$ 和 $3$，而第二座山的标号和高度分别为 $2$ 和 $4$，那么这个排列的标号序列就是 $1$ $2$，而等高线序列就是 $3$ $4$.\n\n现在问题就是，给出所有山的信息，IK 希望知道一共有多少种不同的符合条件的标号序列和等高线序列。", "inputFormat": "输入第一行给出山的个数 $N$。接下来 $N$ 行每行有两个整数，按照标号从 $1$ 到 $N$ 的顺序分别给出一座山的高度和关键数。", "outputFormat": "输出两个用空格分隔开的数，第一个数是不同的标号序列的个数，第二个数是不同的等高线序列的个数。这两个答案都应该对 $2011$ 取模，即输出两个答案除以 $2011$ 取余数的结果", "hint": "对于所有的数据，有 $1\\leq N\\leq 1000$，所有的数字都是不大于 $10^9$ 的正整数。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2013] Terrain Generation", "background": "", "description": "Recently, IK has been working on terrain modeling. One stage of the work is to arrange several mountains in a line. Each mountain has a unique label and a height. To satisfy certain design requirements, each mountain is assigned a key number, requiring that for each mountain, the number of other mountains that are higher than it and placed before it must be less than its key number. Obviously, there can be many permutations that satisfy this requirement.\n\nFor every possible permutation, IK generates a corresponding label sequence and a height sequence. The label sequence is obtained by writing down the labels of the mountains in order.\n\nThe height sequence is obtained by writing down their heights in order. For example, if there are two mountains, and in one valid permutation the first mountain has label and height $1$ and $3$, and the second mountain has label and height $2$ and $4$, then the label sequence of this permutation is $1$ $2$, and the height sequence is $3$ $4$.\n\nNow, given all the information about the mountains, IK wants to know how many different valid label sequences and height sequences there are in total.", "inputFormat": "The first line contains the number of mountains $N$. The next $N$ lines each contain two integers. In the order of labels from $1$ to $N$, they give the height and the key number of each mountain.", "outputFormat": "Output two space-separated numbers. The first is the number of distinct label sequences, and the second is the number of distinct height sequences. Both answers should be taken modulo $2011$, that is, output the remainders of the two answers divided by $2011$.", "hint": "Constraints: For all testdata, $1 \\leq N \\leq 1000$, and all numbers are positive integers not exceeding $10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2013] 地形生成", "background": null, "description": "最近 IK 正在做关于地形建模的工作。其中一个工作阶段就是把一些山排列成一行。每座山都有各不相同的标号和高度。为了遵从一些设计上的要求，每座山都设置了一个关键数字，要求对于每座山，比它高且排列在它前面的其它山的数目必须少于它的关键数字。显然满足要求的排列会有很多个。\n\n对于每一个可能的排列，IK 生成一个对应的标号序列和等高线序列。标号序列就是按顺序写下每座山的标号。\n\n等高线序列就是按顺序写下它们的高度。例如有两座山，这两座山的一个合法排列的第一座山的标号和高度为 $1$ 和 $3$，而第二座山的标号和高度分别为 $2$ 和 $4$，那么这个排列的标号序列就是 $1$ $2$，而等高线序列就是 $3$ $4$.\n\n现在问题就是，给出所有山的信息，IK 希望知道一共有多少种不同的符合条件的标号序列和等高线序列。", "inputFormat": "输入第一行给出山的个数 $N$。接下来 $N$ 行每行有两个整数，按照标号从 $1$ 到 $N$ 的顺序分别给出一座山的高度和关键数。", "outputFormat": "输出两个用空格分隔开的数，第一个数是不同的标号序列的个数，第二个数是不同的等高线序列的个数。这两个答案都应该对 $2011$ 取模，即输出两个答案除以 $2011$ 取余数的结果", "hint": "对于所有的数据，有 $1\\leq N\\leq 1000$，所有的数字都是不大于 $10^9$ 的正整数。", "locale": "zh-CN"}}}
{"pid": "P3256", "type": "P", "difficulty": 6, "samples": [["4\n1 1 0 0\n15 16 10 20", "3\n1 2 4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "各省省选", "吉林", "枚举", "栈", "半平面交"], "title": "[JLOI2013] 赛车", "background": null, "description": "这里有一场赛车比赛正在进行，赛场上一共有 $n$ 辆车，分别称为 $g_1,g_2,...,g_n$。赛道是一条无限长的直线。最初，$g_i$ 处于起跑线前 $k_i$ 个单位的位置。比赛开始后，车辆 $g_i$ 将会以 $v_i$ 单位每秒的恒定速度行驶。在这个比赛过程中，如果一辆赛车曾经处于领跑位置（即没有其他的赛车跑在它的前面），这辆赛车最后就可以得奖，而且比赛过程中不用担心相撞的问题。现在给出所有赛车的起始位置和速度，你的任务就是算出哪些赛车将会得奖。", "inputFormat": "第一行有一个正整数 $n$，表示赛车的个数。\n\n接下来一行，包含 $n$ 个整数，按顺序给出 $n$ 辆赛车的起始位置。再接下来一行给出 $n$ 个整数，按顺序给出 $n$ 辆赛车的恒定速度。", "outputFormat": "输出包括两行，第一行为获奖的赛车个数。第二行按从小到大的顺序输出获奖赛车的编号，编号之间用空格隔开，注意最后一个编号后面不要加空格。", "hint": "#### 数据范围与约定\n\n- 对于 $100\\%$ 的数据，$1 \\le n \\le 10^4$，$0 \\le k_i \\le 10^9$，$0 \\le v_i \\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2013] Racing Cars", "background": "", "description": "There is a car race underway. There are $n$ cars on the track, named $g_1,g_2,...,g_n$. The track is an infinitely long straight line. Initially, $g_i$ is located $k_i$ units before the starting line. After the race starts, car $g_i$ travels at a constant speed of $v_i$ units per second. During the race, if a car has ever been in the lead (i.e., no other car is ahead of it), that car will win in the end, and collisions are not a concern. Given all cars’ starting positions and speeds, determine which cars will win.", "inputFormat": "The first line contains a positive integer $n$, the number of cars.\nThe next line contains $n$ integers, giving the starting positions $k_i$ of the $n$ cars in order. The following line contains $n$ integers, giving the constant speeds $v_i$ of the $n$ cars in order.", "outputFormat": "Output two lines. The first line contains the number of winning cars. The second line contains the indices of the winning cars in increasing order, separated by spaces, with no trailing space.", "hint": "Constraints\n- For 100% of the testdata, $1 \\le n \\le 10^4$, $0 \\le k_i \\le 10^9$, $0 \\le v_i \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2013] 赛车", "background": null, "description": "这里有一场赛车比赛正在进行，赛场上一共有 $n$ 辆车，分别称为 $g_1,g_2,...,g_n$。赛道是一条无限长的直线。最初，$g_i$ 处于起跑线前 $k_i$ 个单位的位置。比赛开始后，车辆 $g_i$ 将会以 $v_i$ 单位每秒的恒定速度行驶。在这个比赛过程中，如果一辆赛车曾经处于领跑位置（即没有其他的赛车跑在它的前面），这辆赛车最后就可以得奖，而且比赛过程中不用担心相撞的问题。现在给出所有赛车的起始位置和速度，你的任务就是算出哪些赛车将会得奖。", "inputFormat": "第一行有一个正整数 $n$，表示赛车的个数。\n\n接下来一行，包含 $n$ 个整数，按顺序给出 $n$ 辆赛车的起始位置。再接下来一行给出 $n$ 个整数，按顺序给出 $n$ 辆赛车的恒定速度。", "outputFormat": "输出包括两行，第一行为获奖的赛车个数。第二行按从小到大的顺序输出获奖赛车的编号，编号之间用空格隔开，注意最后一个编号后面不要加空格。", "hint": "#### 数据范围与约定\n\n- 对于 $100\\%$ 的数据，$1 \\le n \\le 10^4$，$0 \\le k_i \\le 10^9$，$0 \\le v_i \\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P3257", "type": "P", "difficulty": 6, "samples": [["7 4 6 10\n9 4 7 7 4 3 2\n18 8 9 4 15 12 4\n19 2 4 7 10 18 12\n8 1 13 14 16 0 14", "67 1 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "搜索", "2014", "各省省选", "吉林", "记忆化搜索"], "title": "[JLOI2014] 天天酷跑", "background": "", "description": "在游戏天天酷跑中，最爽的应该是超级奖励模式了吧，没有一切障碍，可以尽情的吃金币，现在请你控制游戏角色来获得尽可能多的分数。游戏界面离散为一个长度为 $1 \\sim n$，高度为 $1 \\sim m$（初始点为 $(0,1)$）的矩阵图。每个格子上都有收益 $(-1 \\sim 1000)$，$-1$ 表示该点不能通过。游戏角色从起点一路奔跑向终点，中途可以跳跃来获得更高的分数，在空中还能进行连跳。\n\n游戏开始前你可以设定跳跃的高度，以及能连跳的次数，初始跳跃高度为 $1$，连跳数为 $1$（最多为 $5$），升级跳跃高度和连跳都需要一定的花费。跳跃高度设定完后游戏角色每次跳跃高度都将固定，连跳必须在下落过程中可以使用。所有操作都将在整点上完成，需要保证设定完的跳跃高度及连跳数，无法跳出游戏高度上限。\n\n![](https://cdn.luogu.com.cn/upload/pic/17609.png) \n\n从 $(1,1)$ 点用一次跳跃，一次经过 $(2,2),(3,3),(4,2),(5,1)$。\n\n以下是连跳数为 $2$ 连跳，跳跃高度为 $2$ 的跳跃方案：\n\n![](https://cdn.luogu.com.cn/upload/pic/17610.png)\n\n从 $(1,1)$ 起跳，依次经过 $(2,2),(3,3),(4,2)$ 再使用连跳，经过 $(5,3),(6,4),(7,3),(8,2),(9,1)$。\n\n![](https://cdn.luogu.com.cn/upload/pic/17611.png)", "inputFormat": "第一行四个整数 $n,m,cost_1,cost_2$。$n,m$ 如题意所示，$cost_1,cost_2$ 分别表示每升一级跳跃高度，连跳数所需的花费。\n\n接下来 $m$ 行，每行 $n$ 个数。第 $i$ 行第 $j$ 个数表示地图中高度为 $i$，长度在第 $j$ 列处的收益。\n", "outputFormat": "如果无法跑出终点线，就输出 `mission failed`，否则输出一行三个数，分别表示最大收益；及最大收益时，最小的连跳数；最大收益，最小连跳数时，最小的跳跃高度。\n", "hint": "对于 $20 \\%$ 的数据，满足 $m=2$，$1 \\le n \\le 10 ^ 5$。\n\n对于另外 $80 \\%$ 的数据，$1 \\le n \\le 10000$，$2 < m \\le 20$，其中有 $20\\%$ 的数据保证 $2 < n \\le 10$，$1 \\le m \\le 10$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2014] Tiantian Cool Run", "background": "", "description": "In the game Tiantian Cool Run, the most exciting part is probably the Super Bonus mode, where there are no obstacles and you can freely collect coins. Now you are to control the character to obtain as high a score as possible. The game interface is discretized into a grid with length from $1$ to $n$ and height from $1$ to $m$ (the starting point is $(0,1)$). Every cell has a gain in the range $(-1 \\sim 1000)$, where $-1$ means the cell is impassable. The character runs from the start to the finish; along the way, they can jump to get a higher score, and can even perform consecutive jumps while in midair.\n\nBefore the game starts, you may set the jump height and the number of consecutive jumps. The initial jump height is $1$, and the initial number of consecutive jumps is $1$ (up to a maximum of $5$). Upgrading jump height and the number of consecutive jumps both require a certain cost. Once the jump height is set, every jump will use this fixed height. A consecutive jump can only be used while descending. All actions happen at integer time steps. You must ensure that with the set jump height and number of consecutive jumps, the character cannot jump above the top boundary of the game.\n\n![](https://cdn.luogu.com.cn/upload/pic/17609.png) \n\nFrom $(1,1)$, using one jump, the path passes through $(2,2),(3,3),(4,2),(5,1)$.\n\nBelow is a jumping plan with the number of consecutive jumps equal to $2$ and jump height equal to $2$:\n\n![](https://cdn.luogu.com.cn/upload/pic/17610.png)\n\nStarting to jump from $(1,1)$, the path goes through $(2,2),(3,3),(4,2)$, then uses a consecutive jump and passes through $(5,3),(6,4),(7,3),(8,2),(9,1)$.\n\n![](https://cdn.luogu.com.cn/upload/pic/17611.png)", "inputFormat": "The first line contains four integers $n,m,cost_1,cost_2$. Here $n,m$ are as described above, and $cost_1,cost_2$ respectively denote the cost to increase the jump height by $1$ level and the cost to increase the number of consecutive jumps by $1$.\n\nThen follow $m$ lines, each containing $n$ integers. The integer in the $i$-th row and $j$-th column gives the gain at height $i$ and length $j$ in the map.", "outputFormat": "If it is impossible to reach the finish line, output `mission failed`. Otherwise, output one line with three integers: the maximum gain; among all settings achieving the maximum gain, the minimum number of consecutive jumps; and among those, the minimum jump height.", "hint": "For $20\\%$ of the testdata, $m=2$ and $1 \\le n \\le 10^5$.\n\nFor the remaining $80\\%$ of the testdata, $1 \\le n \\le 10000$, $2 < m \\le 20$. Among them, for $20\\%$ of the testdata it is guaranteed that $2 < n \\le 10$, $1 \\le m \\le 10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2014] 天天酷跑", "background": "", "description": "在游戏天天酷跑中，最爽的应该是超级奖励模式了吧，没有一切障碍，可以尽情的吃金币，现在请你控制游戏角色来获得尽可能多的分数。游戏界面离散为一个长度为 $1 \\sim n$，高度为 $1 \\sim m$（初始点为 $(0,1)$）的矩阵图。每个格子上都有收益 $(-1 \\sim 1000)$，$-1$ 表示该点不能通过。游戏角色从起点一路奔跑向终点，中途可以跳跃来获得更高的分数，在空中还能进行连跳。\n\n游戏开始前你可以设定跳跃的高度，以及能连跳的次数，初始跳跃高度为 $1$，连跳数为 $1$（最多为 $5$），升级跳跃高度和连跳都需要一定的花费。跳跃高度设定完后游戏角色每次跳跃高度都将固定，连跳必须在下落过程中可以使用。所有操作都将在整点上完成，需要保证设定完的跳跃高度及连跳数，无法跳出游戏高度上限。\n\n![](https://cdn.luogu.com.cn/upload/pic/17609.png) \n\n从 $(1,1)$ 点用一次跳跃，一次经过 $(2,2),(3,3),(4,2),(5,1)$。\n\n以下是连跳数为 $2$ 连跳，跳跃高度为 $2$ 的跳跃方案：\n\n![](https://cdn.luogu.com.cn/upload/pic/17610.png)\n\n从 $(1,1)$ 起跳，依次经过 $(2,2),(3,3),(4,2)$ 再使用连跳，经过 $(5,3),(6,4),(7,3),(8,2),(9,1)$。\n\n![](https://cdn.luogu.com.cn/upload/pic/17611.png)", "inputFormat": "第一行四个整数 $n,m,cost_1,cost_2$。$n,m$ 如题意所示，$cost_1,cost_2$ 分别表示每升一级跳跃高度，连跳数所需的花费。\n\n接下来 $m$ 行，每行 $n$ 个数。第 $i$ 行第 $j$ 个数表示地图中高度为 $i$，长度在第 $j$ 列处的收益。\n", "outputFormat": "如果无法跑出终点线，就输出 `mission failed`，否则输出一行三个数，分别表示最大收益；及最大收益时，最小的连跳数；最大收益，最小连跳数时，最小的跳跃高度。\n", "hint": "对于 $20 \\%$ 的数据，满足 $m=2$，$1 \\le n \\le 10 ^ 5$。\n\n对于另外 $80 \\%$ 的数据，$1 \\le n \\le 10000$，$2 < m \\le 20$，其中有 $20\\%$ 的数据保证 $2 < n \\le 10$，$1 \\le m \\le 10$。", "locale": "zh-CN"}}}
{"pid": "P3258", "type": "P", "difficulty": 4, "samples": [["5\n1 4 5 3 2\n1 2\n2 4\n2 3\n4 5", "1\n2\n1\n2\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "线段树", "各省省选", "吉林", "最近公共祖先 LCA", "树链剖分", "差分"], "title": "[JLOI2014] 松鼠的新家", "background": null, "description": "松鼠的新家是一棵树，前几天刚刚装修了新家，新家有 $n$ 个房间，并且有 $n-1$ 根树枝连接，每个房间都可以相互到达，且俩个房间之间的路线都是唯一的。天哪，他居然真的住在“树”上。\n\n松鼠想邀请小熊维尼前来参观，并且还指定一份参观指南，他希望维尼能够按照他的指南顺序，先去 $a_1$，再去 $a_2$，……，最后到 $a_n$，去参观新家。可是这样会导致重复走很多房间，懒惰的维尼不停地推辞。可是松鼠告诉他，每走到一个房间，他就可以从房间拿一块糖果吃。\n\n维尼是个馋家伙，立马就答应了。现在松鼠希望知道为了保证维尼有糖果吃，他需要在每一个房间各放至少多少个糖果。\n\n因为松鼠参观指南上的最后一个房间 $a_n$ 是餐厅，餐厅里他准备了丰盛的大餐，所以当维尼在参观的最后到达餐厅时就不需要再拿糖果吃了。", "inputFormat": "第一行一个正整数 $n$，表示房间个数。第二行 $n$ 个正整数，依次描述 $a_1, a_2,\\cdots,a_n$。\n\n接下来 $n-1$ 行，每行两个正整数 $x,y$，表示标号 $x$ 和 $y$ 的两个房间之间有树枝相连。", "outputFormat": "一共 $n$ 行，第 $i$ 行输出标号为 $i$ 的房间至少需要放多少个糖果，才能让维尼有糖果吃。", "hint": "对于全部的数据，$2 \\le n \\le 3 \\times 10^5$，$1 \\le a_i \\le n$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2014] Squirrel’s New Home", "background": "", "description": "The squirrel’s new home is a tree. It was just renovated a few days ago. The new home has $n$ rooms and $n-1$ edges connecting them. Every pair of rooms is reachable, and the route between any two rooms is unique. Oh my, he really lives on a \"tree\".\n\nThe squirrel wants to invite Winnie the Pooh to visit and specifies a visiting itinerary. He hopes Winnie will visit in order: first $a_1$, then $a_2$, …, and finally $a_n$. However, this would cause revisiting many rooms, and the lazy Winnie keeps refusing. But the squirrel tells him that each time he arrives at a room, he can take one candy from that room.\n\nWinnie is a glutton, so he agrees at once. Now the squirrel wants to know, to ensure Winnie always has a candy to eat, how many candies at minimum he needs to place in each room.\n\nSince the last room $a_n$ in the itinerary is the dining room, where a feast has been prepared, when Winnie arrives at the dining room at the end of the tour, he does not need to take a candy there.", "inputFormat": "The first line contains a positive integer $n$, the number of rooms. The second line contains $n$ positive integers describing $a_1, a_2, \\cdots, a_n$ in order.\n\nThe next $n-1$ lines each contain two positive integers $x, y$, indicating that rooms labeled $x$ and $y$ are connected by an edge.", "outputFormat": "Output $n$ lines. On the $i$-th line, output the minimum number of candies that must be placed in the room labeled $i$ so that Winnie always has a candy to eat.", "hint": "For all testdata, $2 \\le n \\le 3 \\times 10^5$, $1 \\le a_i \\le n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2014] 松鼠的新家", "background": null, "description": "松鼠的新家是一棵树，前几天刚刚装修了新家，新家有 $n$ 个房间，并且有 $n-1$ 根树枝连接，每个房间都可以相互到达，且俩个房间之间的路线都是唯一的。天哪，他居然真的住在“树”上。\n\n松鼠想邀请小熊维尼前来参观，并且还指定一份参观指南，他希望维尼能够按照他的指南顺序，先去 $a_1$，再去 $a_2$，……，最后到 $a_n$，去参观新家。可是这样会导致重复走很多房间，懒惰的维尼不停地推辞。可是松鼠告诉他，每走到一个房间，他就可以从房间拿一块糖果吃。\n\n维尼是个馋家伙，立马就答应了。现在松鼠希望知道为了保证维尼有糖果吃，他需要在每一个房间各放至少多少个糖果。\n\n因为松鼠参观指南上的最后一个房间 $a_n$ 是餐厅，餐厅里他准备了丰盛的大餐，所以当维尼在参观的最后到达餐厅时就不需要再拿糖果吃了。", "inputFormat": "第一行一个正整数 $n$，表示房间个数。第二行 $n$ 个正整数，依次描述 $a_1, a_2,\\cdots,a_n$。\n\n接下来 $n-1$ 行，每行两个正整数 $x,y$，表示标号 $x$ 和 $y$ 的两个房间之间有树枝相连。", "outputFormat": "一共 $n$ 行，第 $i$ 行输出标号为 $i$ 的房间至少需要放多少个糖果，才能让维尼有糖果吃。", "hint": "对于全部的数据，$2 \\le n \\le 3 \\times 10^5$，$1 \\le a_i \\le n$。", "locale": "zh-CN"}}}
{"pid": "P3259", "type": "P", "difficulty": 6, "samples": [["5 8 1 100 10\nstart 0 0\nazhan 10 10\nxxgasxx 0 5\nbpoint 20 5\nend 0 100\nstart azhan sdf 30\nazhan xxgasxx ewfg 20\nstart end r3tg 200\nend azhan 1xq2 70\nazhan bpoint gg 10\nxxgasxx bpoint kk 30\nbpoint end dsg 40\nxxgasxx end t_s 100", "162.500"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2014", "各省省选", "吉林", "最短路"], "title": "[JLOI2014] 路径规划", "background": null, "description": "相信大家都用过地图上的路径规划功能，只要输入起点终点就能找出一条最优路线。现在告诉你一张地图的信息，请你找出最优路径（即最短路径）。考虑到实际情况，一辆车加满油能开的时间有限，**为 $limit$**，所以在地图上增加了几个加油站。\n\n地图由点和双向边构成，每个点代表一个路口，也有可能是加油站或起点终点。有些路口还装有红绿灯。由于经过太多的红绿灯会让人感到不爽，所以请求在经过不超过 $k$ 个红绿灯的情况下，最少平均花费多少时间能从起点到终点。保证起点终点和加油站没有红绿灯。（题目不考虑最坏情况下能否加到油，只考虑平均花费时间的前提下，车能否到达加油站加油）。\n\n\n注意：\n\n1. $limit$ 指的是车最多能走多长时间，可以看作车的油箱，是不能叠加的（比如不能连续经过多个加油站后剩余能走的时间 $>limit$）。\n2. 与上面类似，一个加油站最多只能加到 $limit$，不能累加。\n3. 不管在加油站加多少油，反正加一次耗费的时间都是 $cost$。\n4. 经过加油站可以不加油。", "inputFormat": "第一行输入 $5$ 个整数 $n,m,k,limit,cost$，表示有 $n$ 个点 $m$ 条边，车能开 $limit$ 长的时间，及加油所花时间 $cost$。\n\n接下来 $n$ 行输入每个点信息，包括点的名称（带 `gas` 的为加油站，`start` 为起点，`end` 为终点），及该点是否有红绿灯，用 $a,b$ 表示。（若为 $a=0$ 则表示没有，$a$ 表示红灯长，$b$ 表示绿灯长）。\n\n接下来 $m$ 行输入每条边信息，包括边的起点，终点，边的名称，通过该边所花时长。\n\n保证点和边名的长度不大于 $20$，只有大小写字母，数字及 `_` 组成。", "outputFormat": "一行输出最少平均花费时长，保留三位小数。", "hint": "共 $14$ 组数据。\n\n- 其中 $3$ 组数据，满足 $1 \\le n<10$，$1 \\le m<20$，$1 \\le k<5$。\n- 另有 $3$ 组没有红绿灯。\n\n所有数据满足 $1 \\le n \\le 10000$，$1 \\le m \\le 20000$，$1 \\le k \\le 10$，加油站 $\\le 50$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2014] Path Planning", "background": "# Description\n\nMost people have used the path planning feature on maps: as long as you enter the start and end, it can find an optimal route. Now you are given information about a map; please find the optimal path (i.e., the shortest path). Considering reality, a car with a full tank can run for a limited time, namely $limit$, so several gas stations are added on the map.\n\nThe map consists of vertices and bidirectional edges. Each vertex represents an intersection and may be a gas station or the start/end. Some intersections also have traffic lights. Since passing too many traffic lights is annoying, please find the minimal average time needed to travel from the start to the end while passing through no more than $k$ traffic lights. It is guaranteed that the start, the end, and gas stations have no traffic lights. (The problem does not consider whether refueling is possible in the worst case; it only considers whether, under average travel time, the car can reach a gas station to refuel.)\n\nNote:\n1. $limit$ is the maximum time the car can drive and can be viewed as the fuel tank; it cannot be accumulated (for example, after passing multiple gas stations in a row, the remaining drivable time cannot exceed $limit$).\n2. Similarly, a single refuel can only fill up to $limit$ and cannot be accumulated.\n3. No matter how much fuel is added at a gas station, the time cost for one refuel is always $cost$.\n4. Passing a gas station does not require refueling.", "description": "Most people have used the path planning feature on maps: as long as you enter the start and end, it can find an optimal route. Now you are given information about a map; please find the optimal path (i.e., the shortest path). Considering reality, a car with a full tank can run for a limited time, namely $limit$, so several gas stations are added on the map.\n\nThe map consists of vertices and bidirectional edges. Each vertex represents an intersection and may be a gas station or the start/end. Some intersections also have traffic lights. Since passing too many traffic lights is annoying, please find the minimal average time needed to travel from the start to the end while passing through no more than $k$ traffic lights. It is guaranteed that the start, the end, and gas stations have no traffic lights. (The problem does not consider whether refueling is possible in the worst case; it only considers whether, under average travel time, the car can reach a gas station to refuel.)\n\nNote:\n1. $limit$ is the maximum time the car can drive and can be viewed as the fuel tank; it cannot be accumulated (for example, after passing multiple gas stations in a row, the remaining drivable time cannot exceed $limit$).\n2. Similarly, a single refuel can only fill up to $limit$ and cannot be accumulated.\n3. No matter how much fuel is added at a gas station, the time cost for one refuel is always $cost$.\n4. Passing a gas station does not require refueling.\n\n# Description", "inputFormat": "The first line contains $5$ integers $n, m, k, limit, cost$, meaning there are $n$ vertices and $m$ edges, the car can run for time $limit$, and refueling costs time $cost$.\n\nThe next $n$ lines describe each vertex, including the vertex name (names containing `gas` are gas stations, `start` is the start, and `end` is the destination) and whether the vertex has a traffic light, represented by $a, b$. (If $a = 0$, it means there is no traffic light; otherwise, $a$ is the red duration and $b$ is the green duration.)\n\nThe next $m$ lines describe each edge, including the edge’s start, end, edge name, and the time to traverse this edge.\n\nThe lengths of vertex and edge names are no more than $20$ and consist only of letters, digits, and `_`.", "outputFormat": "Output one line: the minimal average time spent.", "hint": "There are $14$ sets of testdata.\n\n- Among them, $3$ sets satisfy $1 \\le n < 10$, $1 \\le m < 20$, $1 \\le k < 5$.\n- Another $3$ sets have no traffic lights.\n\nConstraints:\nFor all data, $1 \\le n \\le 10000$, $1 \\le m \\le 20000$, $1 \\le k \\le 10$, and the number of gas stations $\\le 50$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2014] 路径规划", "background": null, "description": "相信大家都用过地图上的路径规划功能，只要输入起点终点就能找出一条最优路线。现在告诉你一张地图的信息，请你找出最优路径（即最短路径）。考虑到实际情况，一辆车加满油能开的时间有限，**为 $limit$**，所以在地图上增加了几个加油站。\n\n地图由点和双向边构成，每个点代表一个路口，也有可能是加油站或起点终点。有些路口还装有红绿灯。由于经过太多的红绿灯会让人感到不爽，所以请求在经过不超过 $k$ 个红绿灯的情况下，最少平均花费多少时间能从起点到终点。保证起点终点和加油站没有红绿灯。（题目不考虑最坏情况下能否加到油，只考虑平均花费时间的前提下，车能否到达加油站加油）。\n\n\n注意：\n\n1. $limit$ 指的是车最多能走多长时间，可以看作车的油箱，是不能叠加的（比如不能连续经过多个加油站后剩余能走的时间 $>limit$）。\n2. 与上面类似，一个加油站最多只能加到 $limit$，不能累加。\n3. 不管在加油站加多少油，反正加一次耗费的时间都是 $cost$。\n4. 经过加油站可以不加油。", "inputFormat": "第一行输入 $5$ 个整数 $n,m,k,limit,cost$，表示有 $n$ 个点 $m$ 条边，车能开 $limit$ 长的时间，及加油所花时间 $cost$。\n\n接下来 $n$ 行输入每个点信息，包括点的名称（带 `gas` 的为加油站，`start` 为起点，`end` 为终点），及该点是否有红绿灯，用 $a,b$ 表示。（若为 $a=0$ 则表示没有，$a$ 表示红灯长，$b$ 表示绿灯长）。\n\n接下来 $m$ 行输入每条边信息，包括边的起点，终点，边的名称，通过该边所花时长。\n\n保证点和边名的长度不大于 $20$，只有大小写字母，数字及 `_` 组成。", "outputFormat": "一行输出最少平均花费时长，保留三位小数。", "hint": "共 $14$ 组数据。\n\n- 其中 $3$ 组数据，满足 $1 \\le n<10$，$1 \\le m<20$，$1 \\le k<5$。\n- 另有 $3$ 组没有红绿灯。\n\n所有数据满足 $1 \\le n \\le 10000$，$1 \\le m \\le 20000$，$1 \\le k \\le 10$，加油站 $\\le 50$。", "locale": "zh-CN"}}}
{"pid": "P3260", "type": "P", "difficulty": 7, "samples": [["1000 100\n6\n1 500 0 50\n2 10 10 20 100\n2 100 10 200 100\n2 300 10 400 100\n2 500 10 600 100\n2 700 0 800 100", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["计算几何", "2014", "各省省选", "吉林", "最小割"], "title": "[JLOI2014] 镜面通道", "background": "", "description": "在一个二维平面上，有一个镜面通道，由镜面 $AC, BD$ 组成，$AC, BD$ 长度相等，且都平行于 $x$ 轴，$B$ 位于 $(0,0)$。\n\n通道中有 $n$ 个外表面为镜面的光学元件，光学元件 $\\alpha$ 为圆形，光学元件 $\\beta$ 为矩形（这些元件可以与其他元件和通道有交集，具体看下图）。光线可以在 $AB$ 上任一点以任意角度射入通道，光线不会发生削弱。当出现元件与元件，元件和通道刚好接触的情况视为光线无法透过（比如两圆相切）。\n\n现在给出通道中所有元件的信息（$\\alpha$ 元件包括圆心坐标和半径 $x_i, y_i, r_i$，$\\beta$ 元件包括左下角和右上角坐标 $x_1, y_1, x_2, y_2$）\n\n![](https://cdn.luogu.com.cn/upload/pic/17612.png)\n\n如上图，$S$ 到 $T$ 便是一条合法线路。\n\n![](https://cdn.luogu.com.cn/upload/pic/17613.png)\n\n当然，显然存在光线无法透过的情况，现在交给你一个艰巨的任务，请求出至少拿走多少个光学元件后，存在一条光线线路可以从 $CD$ 射出。\n\n下面举例说明：\n\n![](https://cdn.luogu.com.cn/upload/pic/17614.png) \n\n现在假设，取走中间那个矩形，那么就可以构造出一条穿过通道的光路，如图中的 $S$ 到 $T$。\n", "inputFormat": "第一行包含两个整数，$x, y$，表示 $C$ 点坐标。\n\n第二行包含一个数字 $n$，表示有 $n$ 个光学元件。\n\n接下来 $n$ 行第一个数字如果是 $1$，表示元件 $\\alpha$，后面会有三个整数 $x_i, y_i, r_i$ 分别表示圆心坐标和半径。第一个数字如果是 $2$，表示元件 $\\beta$，后面会有四个整数 $x_1, y_1, x_2, y_2$ 分别表示左下角和右上角坐标。（矩形都平行，垂直于坐标轴）", "outputFormat": "输出包含一行，至少需要拿走的光学元件个数 $m$。\n", "hint": "$x\\leq 10^5$，$y\\leq 1000$，$n\\leq 300$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2014] Mirror Channel", "background": "", "description": "On a 2D plane, there is a mirror channel formed by mirrors $AC$ and $BD$. The lengths of $AC$ and $BD$ are equal, and both are parallel to the $x$-axis. $B$ is at (0, 0).\n\nInside the channel, there are $n$ optical elements whose outer surfaces are mirrors. Element $\\alpha$ is a circle, and element $\\beta$ is a rectangle (these elements may intersect with other elements and with the channel; see the figures). A light ray can enter the channel from any point on $AB$ at any angle, and the light ray does not attenuate. If an element just touches another element, or an element just touches the channel boundary, the light is considered unable to pass through at that contact (for example, two tangent circles).\n\nAll information about the elements in the channel is given ($\\alpha$ elements include the center coordinates and radius $x_i, y_i, r_i$; $\\beta$ elements include the lower-left and upper-right corner coordinates $x_1, y_1, x_2, y_2$).\n\nAs shown in the first figure, $S$ to $T$ is a valid path.\n\nOf course, there are cases where the light cannot pass through. Your task is to find the minimum number of optical elements that must be removed so that there exists a light path that can exit from $CD$.\n\nAn example is shown below: if the middle rectangle is removed, a light path passing through the channel can be constructed, as shown by $S$ to $T$.", "inputFormat": "- The first line contains two integers, $x, y$, denoting the coordinates of point $C$.\n- The second line contains an integer $n$, the number of optical elements.\n- Each of the next $n$ lines begins with a number. If it is $1$, it denotes an $\\alpha$ element, followed by three integers $x_i, y_i, r_i$ for the circle’s center and radius. If it is $2$, it denotes a $\\beta$ element, followed by four integers $x_1, y_1, x_2, y_2$ for the rectangle’s lower-left and upper-right corner coordinates (rectangles are axis-aligned).", "outputFormat": "Output one line containing a single integer $m$, the minimum number of optical elements that need to be removed.", "hint": "Constraints: $x \\leq 10^5$, $y \\leq 1000$, $n \\leq 300$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2014] 镜面通道", "background": "", "description": "在一个二维平面上，有一个镜面通道，由镜面 $AC, BD$ 组成，$AC, BD$ 长度相等，且都平行于 $x$ 轴，$B$ 位于 $(0,0)$。\n\n通道中有 $n$ 个外表面为镜面的光学元件，光学元件 $\\alpha$ 为圆形，光学元件 $\\beta$ 为矩形（这些元件可以与其他元件和通道有交集，具体看下图）。光线可以在 $AB$ 上任一点以任意角度射入通道，光线不会发生削弱。当出现元件与元件，元件和通道刚好接触的情况视为光线无法透过（比如两圆相切）。\n\n现在给出通道中所有元件的信息（$\\alpha$ 元件包括圆心坐标和半径 $x_i, y_i, r_i$，$\\beta$ 元件包括左下角和右上角坐标 $x_1, y_1, x_2, y_2$）\n\n![](https://cdn.luogu.com.cn/upload/pic/17612.png)\n\n如上图，$S$ 到 $T$ 便是一条合法线路。\n\n![](https://cdn.luogu.com.cn/upload/pic/17613.png)\n\n当然，显然存在光线无法透过的情况，现在交给你一个艰巨的任务，请求出至少拿走多少个光学元件后，存在一条光线线路可以从 $CD$ 射出。\n\n下面举例说明：\n\n![](https://cdn.luogu.com.cn/upload/pic/17614.png) \n\n现在假设，取走中间那个矩形，那么就可以构造出一条穿过通道的光路，如图中的 $S$ 到 $T$。\n", "inputFormat": "第一行包含两个整数，$x, y$，表示 $C$ 点坐标。\n\n第二行包含一个数字 $n$，表示有 $n$ 个光学元件。\n\n接下来 $n$ 行第一个数字如果是 $1$，表示元件 $\\alpha$，后面会有三个整数 $x_i, y_i, r_i$ 分别表示圆心坐标和半径。第一个数字如果是 $2$，表示元件 $\\beta$，后面会有四个整数 $x_1, y_1, x_2, y_2$ 分别表示左下角和右上角坐标。（矩形都平行，垂直于坐标轴）", "outputFormat": "输出包含一行，至少需要拿走的光学元件个数 $m$。\n", "hint": "$x\\leq 10^5$，$y\\leq 1000$，$n\\leq 300$。\n", "locale": "zh-CN"}}}
{"pid": "P3261", "type": "P", "difficulty": 6, "samples": [["5 5\n50 20 10 10 30\n1 1 2\n2 0 5\n2 0 -10\n1 0 10\n20 2\n10 3\n40 4\n20 4\n35 5", "2\n2\n0\n0\n0\n1\n1\n3\n1\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2015", "倍增", "各省省选", "吉林", "可并堆", "栈"], "title": "[JLOI2015] 城池攻占", "background": "", "description": "小铭铭最近获得了一副新的桌游，游戏中需要用 $m$ 个骑士攻占 $n$ 个城池。\n\n这 $n$ 个城池用 $1$ 到 $n$ 的整数表示。除 $1$ 号城池外，城池 $i$ 会受到另一座城池 $f_i$ 的管辖，其中 $f_i<i$。也就是说，所有城池构成了一棵有根树。 \n\n这 $m$ 个骑士用 $1$ 到 $m$ 的整数表示，其中第 $i$ 个骑士的初始战斗力为 $s_i$，第一个攻击的城池为 $c_i$。\n\n每个城池有一个防御值 $h_i$，如果一个骑士的战斗力大于等于城池的生命值，那么骑士就可以占领这座城池；否则占领失败，骑士将在这座城池牺牲。占领一个城池以后，骑士的战斗力将发生变化，然后继续攻击管辖这座城池的城池，直到占领 $1$ 号城池，或牺牲为止。\n\n除 $1$ 号城池外，每个城池 $i$ 会给出一个战斗力变化参数 $(a_i,v_i)$。若 $a_i=0$，攻占城池 $i$ 以后骑士战斗力会增加 $v_i$；若 $a_i=1$，攻占城池 $i$ 以后，战斗力会乘以 $v_i$。\n\n注意每个骑士是单独计算的。也就是说一个骑士攻击一座城池，不管结果如何，均不会影响其他骑士攻击这座城池的结果。\n\n现在的问题是，对于每个城池，输出有多少个骑士在这里牺牲；对于每个骑士，输出他攻占的城池数量。", "inputFormat": "第 $1$ 行包含两个正整数 $n,m$，表示城池的数量和骑士的数量。\n\n第 $2$ 行包含 $n$ 个整数，其中第 $i$ 个数为 $h_i$，表示城池 $i$ 的防御值。\n\n第 $3\\sim n+1$ 行，每行包含三个整数。其中第 $i+1$ 行的三个数为 $f_i,a_i,v_i$，分别表示管辖这座城池的城池编号和两个战斗力变化参数。\n\n第 $n+2\\sim n+m+1$ 行，每行包含两个整数。其中第 $n+i$ 行的两个数为 $s_i,c_i$，分别表示初始战斗力和第一个攻击的城池。\n", "outputFormat": "输出 $n+m$ 行，每行包含一个非负整数。其中前 $n$ 行分别表示在城池 $1$ 到 $n$ 牺牲的骑士数量，后 $m$ 行分别表示骑士 $1$ 到 $m$ 攻占的城池数量。", "hint": "对于 $100\\%$ 的数据，$1\\le n,m\\le 3\\times 10^5$，$\n-10^{18}\\le h_i,v_i,s_i\\le 10^{18}$，$1\\le f_i<i,1\\le c_i\\le n,a_i\\in\\{0,1\\}$，保证 $a_i=1$ 时，$v_i>0$，保证任何时候骑士战斗力值的绝对值不超过 $10^{18}$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2015] City Conquest", "background": "", "description": "Xiao Mingming recently got a new board game. In the game, you need to use $m$ knights to conquer $n$ cities.\n\nThe $n$ cities are numbered from $1$ to $n$. Except for city $1$, each city $i$ is governed by another city $f_i$ with $f_i<i$. In other words, all cities form a rooted tree.\n\nThe $m$ knights are numbered from $1$ to $m$, where knight $i$ has initial combat power $s_i$, and his first target city is $c_i$.\n\nEach city has a defense value $h_i$. If a knight's combat power is greater than or equal to the city's defense value, then the knight can capture that city; otherwise, the capture fails and the knight will fall at that city. After capturing a city, the knight's combat power will change, and then he continues to attack the city that governs this city (its parent), until he captures city $1$, or dies.\n\nExcept for city $1$, each city $i$ provides a combat-power change parameter $(a_i, v_i)$. If $a_i=0$, after capturing city $i$, the knight's combat power increases by $v_i$; if $a_i=1$, after capturing city $i$, the combat power is multiplied by $v_i$.\n\nNote that each knight is simulated independently. That is, when a knight attacks a city, regardless of the outcome, it does not affect the result of other knights attacking this city.\n\nNow the problem is: for each city, output how many knights die here; and for each knight, output how many cities he captures.", "inputFormat": "The first line contains two positive integers $n,m$, the numbers of cities and knights.\n\nThe second line contains $n$ integers, where the $i$-th number is $h_i$, the defense value of city $i$.\n\nLines $3$ to $n+1$: for each city $i$ from $2$ to $n$, line $i+1$ contains three integers $f_i,a_i,v_i$, denoting the governing (parent) city of city $i$ and the two combat-power change parameters.\n\nLines $n+2$ to $n+m+1$: for each knight $i$ from $1$ to $m$, line $n+1+i$ contains two integers $s_i,c_i$, the initial combat power and the first city to attack.", "outputFormat": "Output $n+m$ lines, each containing a nonnegative integer. The first $n$ lines give, for cities $1$ to $n$, the number of knights who die there; the last $m$ lines give, for knights $1$ to $m$, the number of cities they capture.", "hint": "For $100\\%$ of the testdata, $1\\le n,m\\le 3\\times 10^5$, $-10^{18}\\le h_i,v_i,s_i\\le 10^{18}$, $1\\le f_i<i$, $1\\le c_i\\le n$, $a_i\\in\\{0,1\\}$. It is guaranteed that when $a_i=1$, $v_i>0$, and that at any time the absolute value of a knight's combat power does not exceed $10^{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2015] 城池攻占", "background": "", "description": "小铭铭最近获得了一副新的桌游，游戏中需要用 $m$ 个骑士攻占 $n$ 个城池。\n\n这 $n$ 个城池用 $1$ 到 $n$ 的整数表示。除 $1$ 号城池外，城池 $i$ 会受到另一座城池 $f_i$ 的管辖，其中 $f_i<i$。也就是说，所有城池构成了一棵有根树。 \n\n这 $m$ 个骑士用 $1$ 到 $m$ 的整数表示，其中第 $i$ 个骑士的初始战斗力为 $s_i$，第一个攻击的城池为 $c_i$。\n\n每个城池有一个防御值 $h_i$，如果一个骑士的战斗力大于等于城池的生命值，那么骑士就可以占领这座城池；否则占领失败，骑士将在这座城池牺牲。占领一个城池以后，骑士的战斗力将发生变化，然后继续攻击管辖这座城池的城池，直到占领 $1$ 号城池，或牺牲为止。\n\n除 $1$ 号城池外，每个城池 $i$ 会给出一个战斗力变化参数 $(a_i,v_i)$。若 $a_i=0$，攻占城池 $i$ 以后骑士战斗力会增加 $v_i$；若 $a_i=1$，攻占城池 $i$ 以后，战斗力会乘以 $v_i$。\n\n注意每个骑士是单独计算的。也就是说一个骑士攻击一座城池，不管结果如何，均不会影响其他骑士攻击这座城池的结果。\n\n现在的问题是，对于每个城池，输出有多少个骑士在这里牺牲；对于每个骑士，输出他攻占的城池数量。", "inputFormat": "第 $1$ 行包含两个正整数 $n,m$，表示城池的数量和骑士的数量。\n\n第 $2$ 行包含 $n$ 个整数，其中第 $i$ 个数为 $h_i$，表示城池 $i$ 的防御值。\n\n第 $3\\sim n+1$ 行，每行包含三个整数。其中第 $i+1$ 行的三个数为 $f_i,a_i,v_i$，分别表示管辖这座城池的城池编号和两个战斗力变化参数。\n\n第 $n+2\\sim n+m+1$ 行，每行包含两个整数。其中第 $n+i$ 行的两个数为 $s_i,c_i$，分别表示初始战斗力和第一个攻击的城池。\n", "outputFormat": "输出 $n+m$ 行，每行包含一个非负整数。其中前 $n$ 行分别表示在城池 $1$ 到 $n$ 牺牲的骑士数量，后 $m$ 行分别表示骑士 $1$ 到 $m$ 攻占的城池数量。", "hint": "对于 $100\\%$ 的数据，$1\\le n,m\\le 3\\times 10^5$，$\n-10^{18}\\le h_i,v_i,s_i\\le 10^{18}$，$1\\le f_i<i,1\\le c_i\\le n,a_i\\in\\{0,1\\}$，保证 $a_i=1$ 时，$v_i>0$，保证任何时候骑士战斗力值的绝对值不超过 $10^{18}$。\n", "locale": "zh-CN"}}}
{"pid": "P3262", "type": "P", "difficulty": 6, "samples": [["3 4\n503 1082\n1271 369\n303 1135\n749 1289\n100 54\n837 826\n947 699\n216 389", "6701"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2015", "各省省选", "吉林", "枚举", "深度优先搜索 DFS"], "title": "[JLOI2015] 战争调度", "background": "", "description": "脸哥最近来到了一个神奇的王国，王国里的公民每个公民有两个下属或者没有下属，这种关系刚好组成一个 $n$ 层的完全二叉树。公民 $i$ 的下属是 $2i$ 和 $2i +1$。最下层的公民即叶子节点的公民是平民，平民没有下属，最上层的是国王，中间是各级贵族。\n\n现在这个王国爆发了战争，国王需要决定每一个平民是去种地以供应粮食还是参加战争，每一个贵族（包括国王自己）是去管理后勤还是领兵打仗。一个平民会对他的所有直系上司有贡献度，若一个平民 $i$ 参加战争，他的某个直系上司 $j$ 领兵打仗，那么这个平民对上司的作战贡献度为 $w_{ij}$。若一个平民 $i$ 种地，他的某个直系上司 $j$ 管理后勤，那么这个平民对上司的后勤贡献度为 $f_{ij}$，若 $i$ 和 $j$ 所参加的事务不同，则没有贡献度。为了战争需要保障后勤，国王还要求不多于 $m$ 个平民参加战争。\n\n国王想要使整个王国所有贵族得到的贡献度最大，并把这件事交给了脸哥。但不幸的是，脸哥还有很多 deadline 没有完成，他只能把这件事又转交给你。你能帮他安排吗？", "inputFormat": "第一行两个数 $n,m$。\n\n接下来 $2^{n-1}$ 行，每行 $n-1$ 个数，第 $i$ 行表示编号为 $2^{n-1}-1+ i$ 的平民对其 $n-1$ 个直系上司的作战贡献度，其中第一个数表示对第一级直系上司，即编号为 $\\frac{2^{n-1}-1+ i}{2}$ 的贵族的作战贡献度 $w_{ij}$，依次往上。\n\n接下来 $2^{n-1}$ 行，每行 $n-1$ 个数，第 $i$ 行表示编号为 $2^{n-1}-1+ i$ 的平民对其 $n-1$ 个直系上司的后勤贡献度，其中第一个数表示对第一级直系上司，即编号为 $\\frac{2^{n-1}-1+ i}{2}$ 的贵族的后勤贡献度 $f_{ij}$ ，依次往上。", "outputFormat": "一行一个数表示满足条件的最大贡献值。", "hint": "对于 $100 \\%$ 的数据，$2 \\leq n \\leq 10, \\ m \\leq 2^{n-1}, \\ 0 \\leq w_{ij}, f_{ij} \\leq 2000$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2015] War Scheduling", "background": "", "description": "Lian-ge (pinyin) recently arrived in a magical kingdom where each citizen has either two subordinates or no subordinates, and these relations form a complete binary tree with $n$ levels. The subordinates of citizen $i$ are $2i$ and $2i +1$. The citizens on the lowest level, i.e., the leaves, are commoners and have no subordinates; the topmost citizen is the king, and those in between are nobles of various ranks.\n\nA war has broken out in this kingdom. The king must decide whether each commoner should farm to supply food or join the war, and whether each noble (including the king) should manage logistics or lead troops in battle. A commoner contributes to all of their direct superiors. If a commoner $i$ joins the war and one of their direct superiors $j$ leads troops in battle, then the commoner’s combat contribution to that superior is $w_{ij}$. If a commoner $i$ farms and one of their direct superiors $j$ manages logistics, then the commoner’s logistics contribution to that superior is $f_{ij}$. If $i$ and $j$ engage in different affairs, then there is no contribution. To ensure logistics for the war, the king also requires that no more than $m$ commoners join the war.\n\nThe king wants to maximize the total contribution received by all nobles in the kingdom and has assigned this task to Lian-ge. Unfortunately, Lian-ge has many deadlines left unfinished and has passed this task on to you. Can you arrange it?", "inputFormat": "The first line contains two numbers $n, m$.\n\nThe next $2^{n-1}$ lines each contain $n-1$ numbers. The $i$-th of these lines gives the combat contributions from the commoner numbered $2^{n-1}-1+ i$ to their $n-1$ direct superiors. The first number is the combat contribution $w_{ij}$ to their first-level direct superior, i.e., the noble numbered $\\frac{2^{n-1}-1+ i}{2}$, and so on up the chain.\n\nThe next $2^{n-1}$ lines each contain $n-1$ numbers. The $i$-th of these lines gives the logistics contributions from the commoner numbered $2^{n-1}-1+ i$ to their $n-1$ direct superiors. The first number is the logistics contribution $f_{ij}$ to their first-level direct superior, i.e., the noble numbered $\\frac{2^{n-1}-1+ i}{2}$, and so on up the chain.", "outputFormat": "Output a single number: the maximum total contribution that satisfies the constraints.", "hint": "For $100 \\%$ of the testdata, $2 \\leq n \\leq 10, \\ m \\leq 2^{n-1}, \\ 0 \\leq w_{ij}, f_{ij} \\leq 2000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2015] 战争调度", "background": "", "description": "脸哥最近来到了一个神奇的王国，王国里的公民每个公民有两个下属或者没有下属，这种关系刚好组成一个 $n$ 层的完全二叉树。公民 $i$ 的下属是 $2i$ 和 $2i +1$。最下层的公民即叶子节点的公民是平民，平民没有下属，最上层的是国王，中间是各级贵族。\n\n现在这个王国爆发了战争，国王需要决定每一个平民是去种地以供应粮食还是参加战争，每一个贵族（包括国王自己）是去管理后勤还是领兵打仗。一个平民会对他的所有直系上司有贡献度，若一个平民 $i$ 参加战争，他的某个直系上司 $j$ 领兵打仗，那么这个平民对上司的作战贡献度为 $w_{ij}$。若一个平民 $i$ 种地，他的某个直系上司 $j$ 管理后勤，那么这个平民对上司的后勤贡献度为 $f_{ij}$，若 $i$ 和 $j$ 所参加的事务不同，则没有贡献度。为了战争需要保障后勤，国王还要求不多于 $m$ 个平民参加战争。\n\n国王想要使整个王国所有贵族得到的贡献度最大，并把这件事交给了脸哥。但不幸的是，脸哥还有很多 deadline 没有完成，他只能把这件事又转交给你。你能帮他安排吗？", "inputFormat": "第一行两个数 $n,m$。\n\n接下来 $2^{n-1}$ 行，每行 $n-1$ 个数，第 $i$ 行表示编号为 $2^{n-1}-1+ i$ 的平民对其 $n-1$ 个直系上司的作战贡献度，其中第一个数表示对第一级直系上司，即编号为 $\\frac{2^{n-1}-1+ i}{2}$ 的贵族的作战贡献度 $w_{ij}$，依次往上。\n\n接下来 $2^{n-1}$ 行，每行 $n-1$ 个数，第 $i$ 行表示编号为 $2^{n-1}-1+ i$ 的平民对其 $n-1$ 个直系上司的后勤贡献度，其中第一个数表示对第一级直系上司，即编号为 $\\frac{2^{n-1}-1+ i}{2}$ 的贵族的后勤贡献度 $f_{ij}$ ，依次往上。", "outputFormat": "一行一个数表示满足条件的最大贡献值。", "hint": "对于 $100 \\%$ 的数据，$2 \\leq n \\leq 10, \\ m \\leq 2^{n-1}, \\ 0 \\leq w_{ij}, f_{ij} \\leq 2000$。", "locale": "zh-CN"}}}
{"pid": "P3263", "type": "P", "difficulty": 6, "samples": [["3 13 5\n", "393\n"], ["5 29 114514\n", "4997196309027367968\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "各省省选", "吉林", "矩阵乘法", "线性递推"], "title": "[JLOI2015] 有意义的字符串", "background": "", "description": "B 君有两个好朋友，他们叫宁宁和冉冉。有一天，冉冉遇到了一个有趣的题目：输入三个非负整数 $b,d,n$，求\n\n$$\\left\\lfloor \\left ( \\frac{b+\\sqrt{d}}{2} \\right ) ^n \\right\\rfloor \\bmod p$$\n\n其中 $p=7,528,443,412,579,576,937$", "inputFormat": "一行三个非负整数 $b$，$d$，$n$。", "outputFormat": "一行一个数表示模 $7,528,443,412,579,576,937$ 之后的结果。", "hint": "保证 $0<b^2 \\le d<(b+1)^2 \\le 10^{18}$，$n \\le 10^{18}$，并且 $b\\equiv 1\\pmod 2$，$d\\equiv 1\\pmod 4$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2015] Meaningful String", "background": "", "description": "Mr. B has two good friends, named Ningning and Ranran. One day, Ranran encountered an interesting problem: given three non-negative integers $b,d,n$, compute\n$$\\left\\lfloor \\left ( \\frac{b+\\sqrt{d}}{2} \\right ) ^n \\right\\rfloor \\bmod p,$$\nwhere $p=7,528,443,412,579,576,937$.", "inputFormat": "One line containing three non-negative integers $b$, $d$, and $n$.", "outputFormat": "Output a single integer denoting the result modulo 7,528,443,412,579,576,937.", "hint": "It is guaranteed that $0<b^2 \\le d<(b+1)^2 \\le 10^{18}$, $n \\le 10^{18}$, and $b\\equiv 1\\pmod 2$, $d\\equiv 1\\pmod 4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2015] 有意义的字符串", "background": "", "description": "B 君有两个好朋友，他们叫宁宁和冉冉。有一天，冉冉遇到了一个有趣的题目：输入三个非负整数 $b,d,n$，求\n\n$$\\left\\lfloor \\left ( \\frac{b+\\sqrt{d}}{2} \\right ) ^n \\right\\rfloor \\bmod p$$\n\n其中 $p=7,528,443,412,579,576,937$", "inputFormat": "一行三个非负整数 $b$，$d$，$n$。", "outputFormat": "一行一个数表示模 $7,528,443,412,579,576,937$ 之后的结果。", "hint": "保证 $0<b^2 \\le d<(b+1)^2 \\le 10^{18}$，$n \\le 10^{18}$，并且 $b\\equiv 1\\pmod 2$，$d\\equiv 1\\pmod 4$。\n", "locale": "zh-CN"}}}
{"pid": "P3264", "type": "P", "difficulty": 6, "samples": [["5 8 4\n1 2 3\n1 3 2\n1 5 1\n2 4 2\n2 5 1\n3 4 3\n3 5 1\n4 5 1\n1 1\n1 2\n2 3\n2 4", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "各省省选", "吉林", "生成树", "状压 DP"], "title": "[JLOI2015] 管道连接", "background": "", "description": "小铭铭最近进入了某情报部门，该部门正在被如何建立安全的通道连接困扰。该部门有 $n$ 个情报站，用 $1$ 到 $n$ 的整数编号。给出 $m$ 对情报站 $(u_i,v_i)$ 和费用 $w_i$，表示情报站 $u_i$ 和 $v_i$ 之间可以花费 $w_i$ 单位资源建立通道。\n\n如果一个情报站经过若干个建立好的通道可以到达另外一个情报站，那么这两个情报站就建立了通道连接。形式化地，若 $u_i$ 和 $v_i$ 建立了通道，那么它们建立了通道连接；若 $u_i$ 和 $v_i$ 均与 $t_i$ 建立了通道连接，那么 $u_i$ 和 $v_i$ 也建立了通道连接。\n\n现在在所有的情报站中，有 $p$ 个重要情报站，其中每个情报站有一个特定的频道。小铭铭面临的问题是，需要花费最少的资源，使得任意相同频道的情报站之间都建立通道连接。", "inputFormat": "第一行包含三个整数 $n,m,p$，表示情报站的数量，可以建立的通道数量和重要情报站的数量。\n\n接下来 $m$ 行，每行包含三个整数 $u_i,v_i,w_i$，表示可以建立的通道。\n\n最后有 $p$ 行，每行包含两个整数 $c_i,d_i$，表示重要情报站的频道和情报站的编号。", "outputFormat": "输出一行一个整数，表示任意相同频道的情报站之间都建立通道连接所花费的最少资源总量。\n", "hint": "选择 $(1,5),(3,5),(2,5),(4,5)$ 这 $4$ 对情报站连接。\n\n对于 $100\\%$ 的数据，$1\\le c_i\\le p\\le10$，$1\\le u_i,v_i,d_i \\le n \\le 1000$，$0\\le m \\le 3000$，$0\\le w_i \\le2\\times 10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2015] Pipeline Connection", "background": "", "description": "Xiao Mingming recently joined an intelligence department, which is struggling with how to establish secure pipeline connections. The department has $n$ intelligence stations, numbered from $1$ to $n$. You are given $m$ pairs of stations $(u_i,v_i)$ with a cost $w_i$, meaning that a pipeline can be built between station $u_i$ and station $v_i$ at a resource cost of $w_i$.\n\nIf one station can reach another station through several built pipelines, then these two stations are considered connected. Formally, if a pipeline is built between $u_i$ and $v_i$, then they are connected; if $u_i$ and $v_i$ are both connected to $t_i$, then $u_i$ and $v_i$ are also connected.\n\nAmong all stations, there are $p$ important stations, and each of these stations has a specific channel. The task is to spend the minimum total amount of resources so that any two stations with the same channel are connected.", "inputFormat": "The first line contains three integers $n,m,p$, representing the number of stations, the number of possible pipelines, and the number of important stations.\n\nEach of the next $m$ lines contains three integers $u_i,v_i,w_i$, describing a possible pipeline.\n\nFinally, there are $p$ lines, each containing two integers $c_i,d_i$, representing the channel and the station index of an important station.", "outputFormat": "Output a single integer on one line, the minimum total amount of resources required so that any two stations with the same channel are connected.", "hint": "Choose $(1,5)$, $(3,5)$, $(2,5)$, $(4,5)$ to connect these $4$ pairs of stations.\n\nFor $100\\%$ of the testdata, $1\\le c_i\\le p\\le10$, $1\\le u_i,v_i,d_i \\le n \\le 1000$, $0\\le m \\le 3000$, $0\\le w_i \\le 2\\times 10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2015] 管道连接", "background": "", "description": "小铭铭最近进入了某情报部门，该部门正在被如何建立安全的通道连接困扰。该部门有 $n$ 个情报站，用 $1$ 到 $n$ 的整数编号。给出 $m$ 对情报站 $(u_i,v_i)$ 和费用 $w_i$，表示情报站 $u_i$ 和 $v_i$ 之间可以花费 $w_i$ 单位资源建立通道。\n\n如果一个情报站经过若干个建立好的通道可以到达另外一个情报站，那么这两个情报站就建立了通道连接。形式化地，若 $u_i$ 和 $v_i$ 建立了通道，那么它们建立了通道连接；若 $u_i$ 和 $v_i$ 均与 $t_i$ 建立了通道连接，那么 $u_i$ 和 $v_i$ 也建立了通道连接。\n\n现在在所有的情报站中，有 $p$ 个重要情报站，其中每个情报站有一个特定的频道。小铭铭面临的问题是，需要花费最少的资源，使得任意相同频道的情报站之间都建立通道连接。", "inputFormat": "第一行包含三个整数 $n,m,p$，表示情报站的数量，可以建立的通道数量和重要情报站的数量。\n\n接下来 $m$ 行，每行包含三个整数 $u_i,v_i,w_i$，表示可以建立的通道。\n\n最后有 $p$ 行，每行包含两个整数 $c_i,d_i$，表示重要情报站的频道和情报站的编号。", "outputFormat": "输出一行一个整数，表示任意相同频道的情报站之间都建立通道连接所花费的最少资源总量。\n", "hint": "选择 $(1,5),(3,5),(2,5),(4,5)$ 这 $4$ 对情报站连接。\n\n对于 $100\\%$ 的数据，$1\\le c_i\\le p\\le10$，$1\\le u_i,v_i,d_i \\le n \\le 1000$，$0\\le m \\le 3000$，$0\\le w_i \\le2\\times 10^4$。", "locale": "zh-CN"}}}
{"pid": "P3265", "type": "P", "difficulty": 6, "samples": [["3 3\n1 2 3\n3 4 5\n2 3 4\n1 1 2", "2 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "各省省选", "吉林", "高斯消元", "线性基", "向量"], "title": "[JLOI2015] 装备购买", "background": "", "description": "脸哥最近在玩一款神奇的游戏，这个游戏里有 $n$ 件装备，每件装备有 $m$ 个属性，用向量 $\\mathbf{z_i}=(a_1, \\ldots ,a_j, \\ldots , a_m)$ 表示 ($1 \\leq i \\leq n, \\ 1 \\leq j \\leq m$)，每个装备需要花费 $c_i$，现在脸哥想买一些装备，但是脸哥很穷，所以总是盘算着怎样才能花尽量少的钱买尽量多的装备。对于脸哥来说，如果一件装备的属性能用购买的其他装备组合出（也就是说脸哥可以利用手上的这些装备组合出这件装备的效果），那么这件装备就没有买的必要了。\n\n严格的定义是，如果脸哥买了 $\\mathbf{z_{i_1}}, \\ldots , \\mathbf{z_{i_p}}$这 $p$ 件装备，那么对于任意待决定的 $\\mathbf{z_h}$，不存在 $b_1, \\ldots ,b_p$使得 $b_1\\mathbf{z_{i_1}} + \\ldots + b_p\\mathbf{z_{i_p}} = \\mathbf{z_h}$\n​​ （$b_i$均是实数），那么脸哥就会买 $\\mathbf{z_h}$，否则 $\\mathbf{z_h}$ 对脸哥就是无用的了，自然不必购买。\n\n举个例子，$\\mathbf{z_1}=(1, 2, 3), \\ \\mathbf{z_2}=(3, 4, 5), \\ \\mathbf{z_h}=(2, 3, 4), \\ b_1 =\\frac{1}{2}, \\ b_2 =\\frac{1}{2}$，就有 $b_1\\mathbf{z_1} + b_2\\mathbf{z_2} = \\mathbf{z_h}$ ，那么如果脸哥买了 $\\mathbf{z_1}$和 $\\mathbf{z_2}$ 就不会再买 $\\mathbf{z_h}$了。\n\n脸哥想要在买下最多数量的装备的情况下花最少的钱，你能帮他算一下吗？", "inputFormat": "第一行两个数 $n,m$。接下来 $n$ 行，每行 $m$ 个数，其中第 $i$ 行描述装备 $i$ 的各项属性值。接下来一行 $n$ 个数，其中 $c_i$ 表示购买第 $i$ 件装备的花费。", "outputFormat": "一行两个数，第一个数表示能够购买的最多装备数量，第二个数表示在购买最多数量的装备的情况下的最小花费。", "hint": "如题目中描述，选择装备 $1$ 装备 $2$，装备 $1$ 装备 $3$，装备 $2$ 装备 $3$ 均可，但选择装备 $1$ 和装备 $2$ 的花费最小，为 $2$。\n\n对于 $100\\%$ 的数据 $,1 \\le n,m \\le 500$，$0 \\le a_j \\le 1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2015] Equipment Purchase", "background": "", "description": "Lian Ge is playing a magical game. There are $n$ pieces of equipment, each with $m$ attributes, represented by a vector $\\mathbf{z_i} = (a_1, \\ldots, a_j, \\ldots, a_m)$ ($1 \\le i \\le n$, $1 \\le j \\le m$). Each piece of equipment costs $c_i$. Lian Ge wants to buy some equipment, but he is poor, so he always tries to spend as little money as possible to buy as many pieces as possible. For him, if the attributes of one piece of equipment can be formed by a combination of other purchased equipment (that is, he can use the equipment he owns to reproduce the effect of this piece), then this piece is unnecessary to buy.\n\nThe strict definition is: if Lian Ge has bought $\\mathbf{z_{i_1}}, \\ldots, \\mathbf{z_{i_p}}$, then for any undecided $\\mathbf{z_h}$, if there do not exist $b_1, \\ldots, b_p$ such that $b_1 \\mathbf{z_{i_1}} + \\ldots + b_p \\mathbf{z_{i_p}} = \\mathbf{z_h}$ ($b_i$ are real numbers), then Lian Ge will buy $\\mathbf{z_h}$; otherwise, $\\mathbf{z_h}$ is useless to him and need not be purchased.\n\nFor example, let $\\mathbf{z_1} = (1, 2, 3)$, $\\mathbf{z_2} = (3, 4, 5)$, $\\mathbf{z_h} = (2, 3, 4)$, and $b_1 = \\frac{1}{2}$, $b_2 = \\frac{1}{2}$. Then $b_1 \\mathbf{z_1} + b_2 \\mathbf{z_2} = \\mathbf{z_h}$. In this case, if Lian Ge buys $\\mathbf{z_1}$ and $\\mathbf{z_2}$, he will not buy $\\mathbf{z_h}$.\n\nLian Ge wants to spend the minimum cost while buying the maximum number of pieces of equipment. Can you help him compute the result?", "inputFormat": "The first line contains two numbers $n, m$.  \nThe next $n$ lines each contain $m$ numbers; the $i$-th line describes the attribute values of equipment $i$.  \nThe next line contains $n$ numbers, where $c_i$ is the cost of buying the $i$-th piece of equipment.", "outputFormat": "Output one line with two numbers: the maximum number of pieces that can be purchased, and the minimum total cost under that maximum.", "hint": "As described in the problem, choosing equipment $1$ and $2$, equipment $1$ and $3$, or equipment $2$ and $3$ are all valid, but choosing equipment $1$ and $2$ has the minimum cost, which is $2$.\n\nFor $100\\%$ of the testdata, $1 \\le n, m \\le 500$, $0 \\le a_j \\le 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2015] 装备购买", "background": "", "description": "脸哥最近在玩一款神奇的游戏，这个游戏里有 $n$ 件装备，每件装备有 $m$ 个属性，用向量 $\\mathbf{z_i}=(a_1, \\ldots ,a_j, \\ldots , a_m)$ 表示 ($1 \\leq i \\leq n, \\ 1 \\leq j \\leq m$)，每个装备需要花费 $c_i$，现在脸哥想买一些装备，但是脸哥很穷，所以总是盘算着怎样才能花尽量少的钱买尽量多的装备。对于脸哥来说，如果一件装备的属性能用购买的其他装备组合出（也就是说脸哥可以利用手上的这些装备组合出这件装备的效果），那么这件装备就没有买的必要了。\n\n严格的定义是，如果脸哥买了 $\\mathbf{z_{i_1}}, \\ldots , \\mathbf{z_{i_p}}$这 $p$ 件装备，那么对于任意待决定的 $\\mathbf{z_h}$，不存在 $b_1, \\ldots ,b_p$使得 $b_1\\mathbf{z_{i_1}} + \\ldots + b_p\\mathbf{z_{i_p}} = \\mathbf{z_h}$\n​​ （$b_i$均是实数），那么脸哥就会买 $\\mathbf{z_h}$，否则 $\\mathbf{z_h}$ 对脸哥就是无用的了，自然不必购买。\n\n举个例子，$\\mathbf{z_1}=(1, 2, 3), \\ \\mathbf{z_2}=(3, 4, 5), \\ \\mathbf{z_h}=(2, 3, 4), \\ b_1 =\\frac{1}{2}, \\ b_2 =\\frac{1}{2}$，就有 $b_1\\mathbf{z_1} + b_2\\mathbf{z_2} = \\mathbf{z_h}$ ，那么如果脸哥买了 $\\mathbf{z_1}$和 $\\mathbf{z_2}$ 就不会再买 $\\mathbf{z_h}$了。\n\n脸哥想要在买下最多数量的装备的情况下花最少的钱，你能帮他算一下吗？", "inputFormat": "第一行两个数 $n,m$。接下来 $n$ 行，每行 $m$ 个数，其中第 $i$ 行描述装备 $i$ 的各项属性值。接下来一行 $n$ 个数，其中 $c_i$ 表示购买第 $i$ 件装备的花费。", "outputFormat": "一行两个数，第一个数表示能够购买的最多装备数量，第二个数表示在购买最多数量的装备的情况下的最小花费。", "hint": "如题目中描述，选择装备 $1$ 装备 $2$，装备 $1$ 装备 $3$，装备 $2$ 装备 $3$ 均可，但选择装备 $1$ 和装备 $2$ 的花费最小，为 $2$。\n\n对于 $100\\%$ 的数据 $,1 \\le n,m \\le 500$，$0 \\le a_j \\le 1000$。", "locale": "zh-CN"}}}
{"pid": "P3266", "type": "P", "difficulty": 6, "samples": [["3 3", "40"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "各省省选", "吉林", "组合数学", "容斥原理"], "title": "[JLOI2015] 骗我呢", "background": null, "description": "说起来，毕业之后 B 君也就见过 R 君两面而已。\n\nR 君有一个 $n\\times m$ 的数组 $x_{i,j}$。\n\n对于 $1\\le i\\le n,1\\le j\\le m$，满足 $0\\le x_{i,j}\\le m$。求可能的数组 $x_{i,j}$ 的个数。\n\nB 君觉得限制太宽松，还要求对于 $1\\le i\\le n,1\\le j<m$，满足 $x_{i,j}<x_{i,j+1}$；对于 $1<i\\le n,1\\le j<m$，满足 $x_{i,j}<x_{i-1,j+1}$。\n\nB 君认为 R 君可以直接 pwn 掉这个题。\n\nR 君说：「黑的实在逼真 =.=，你起码把答案模 $10^9+7$ 吧。」B 君觉得 R 君说的有道理，于是想让你求答案模 $10^9+7$ 的结果。", "inputFormat": "一行两个整数表示 $n,m$，含义如题目中所述。", "outputFormat": "一行一个数表示同时满足 B 君和 R 君的条件 $x_{i,j}$ 的个数，模 $10^9+7$ 的结果。", "hint": "对于 $100\\%$ 的数据，$1\\leq n,m\\leq10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2015] Are You Kidding Me", "background": "", "description": "Speaking of which, after graduation, B has only met R twice.\n\nR has an $n \\times m$ array $x_{i,j}$.\n\nFor $1 \\le i \\le n, 1 \\le j \\le m$, it holds that $0 \\le x_{i,j} \\le m$. Find the number of possible arrays $x_{i,j}$.\n\nB thinks the constraints are too loose and additionally requires that for $1 \\le i \\le n, 1 \\le j < m$, we have $x_{i,j} < x_{i,j+1}$; and for $1 < i \\le n, 1 \\le j < m$, we have $x_{i,j} < x_{i-1,j+1}$.\n\nB believes R can just pwn this problem.\n\nR says: \"This trolling is way too realistic =.=, at least take the answer modulo $10^9+7$.\" B thinks R makes sense, so he asks you to compute the answer modulo $10^9+7$.", "inputFormat": "A single line with two integers $n, m$, as described above.", "outputFormat": "A single line with a single number: the count of arrays $x_{i,j}$ that satisfy both B's and R's conditions, modulo $10^9+7$.", "hint": "For $100\\%$ of the testdata, $1 \\le n, m \\le 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2015] 骗我呢", "background": null, "description": "说起来，毕业之后 B 君也就见过 R 君两面而已。\n\nR 君有一个 $n\\times m$ 的数组 $x_{i,j}$。\n\n对于 $1\\le i\\le n,1\\le j\\le m$，满足 $0\\le x_{i,j}\\le m$。求可能的数组 $x_{i,j}$ 的个数。\n\nB 君觉得限制太宽松，还要求对于 $1\\le i\\le n,1\\le j<m$，满足 $x_{i,j}<x_{i,j+1}$；对于 $1<i\\le n,1\\le j<m$，满足 $x_{i,j}<x_{i-1,j+1}$。\n\nB 君认为 R 君可以直接 pwn 掉这个题。\n\nR 君说：「黑的实在逼真 =.=，你起码把答案模 $10^9+7$ 吧。」B 君觉得 R 君说的有道理，于是想让你求答案模 $10^9+7$ 的结果。", "inputFormat": "一行两个整数表示 $n,m$，含义如题目中所述。", "outputFormat": "一行一个数表示同时满足 B 君和 R 君的条件 $x_{i,j}$ 的个数，模 $10^9+7$ 的结果。", "hint": "对于 $100\\%$ 的数据，$1\\leq n,m\\leq10^6$。", "locale": "zh-CN"}}}
{"pid": "P3267", "type": "P", "difficulty": 5, "samples": [["12 2\n8 9 12 6 1 1 5 1 4 8 10 6\n10\n1 2 3 5 6 7 8 9 10 11\n1 3\n2 3\n3 4\n4 5\n4 6\n4 7\n7 8\n8 9\n9 10\n10 11\n11 12", "10"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "2016", "各省省选", "上海", "吉林"], "title": "[JLOI2016/SHOI2016] 侦察守卫", "background": "", "description": "小 R 和 B 神正在玩一款游戏。这款游戏的地图由 $N$ 个点和 $N-1$ 条无向边组成，每条无向边连接两个点，且地图是连通的。换句话说，游戏的地图是一棵有 $N$ 个节点的树。\n\n游戏中有一种道具叫做侦查守卫，当一名玩家在一个点上放置侦查守卫后，它可以监视这个点以及与这个点的距离在 $D$ 以内的所有点。这里两个点之间的距离定义为它们在树上的距离，也就是两个点之间唯一的简单路径上所经过边的条数。在一个点上放置侦查守卫需要付出一定的代价，在不同点放置守卫的代价可能不同。\n\n现在小 R 知道了所有 B 神可能会出现的位置，请你计算监视所有这些位置的最小代价。\n", "inputFormat": "第一行包含两个正整数 $N$ 和 $D$，分别表示地图上的点数和侦查守卫的视野范围。约定地图上的点用 $1$ 到 $N$ 的整数编号。\n\n第二行 $N$ 个正整数，第 $i$ 个正整数表示在编号为 $i$ 的点放置侦查守卫的代价 $W _ i$。保证 $W _ i \\le 1000$。\n\n第三行一个正整数 $M$，表示 B 神可能出现的点的数量。保证 $M \\le N$。\n\n第四行 $M$ 个正整数，分别表示每个 B 神可能出现的点的编号，从小到大不重复地给出。\n\n接下来 $N-1$ 行，每行包含两个正整数 $U,V$，表示在编号为 $U$ 的点和编号为 $V$ 的点之间有一条无向边。\n", "outputFormat": "仅一行一个整数，表示监视所有 B 神可能出现的点所需要的最小代价。\n", "hint": "对于所有的数据，$N \\le 5 \\times 10 ^ 5,D \\le 20$。", "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2016/SHOI2016] Scout Wards", "background": "", "description": "R and player B are playing a game. The game map consists of $N$ points and $N-1$ undirected edges, each connecting two points, and the map is connected. In other words, the map is a tree with $N$ nodes.\n\nThere is an item called a scout ward. When a player places a scout ward at a point, it can monitor that point and all points whose distance from it is within $D$. The distance between two points is defined as their distance on the tree, i.e., the number of edges on the unique simple path between them. Placing a scout ward at a point has a certain cost, and the cost may differ between points.\n\nNow R knows all the positions where player B may appear. Please compute the minimum total cost to monitor all these positions.", "inputFormat": "The first line contains two positive integers $N$ and $D$, denoting the number of points on the map and the vision range of a scout ward, respectively. Points are numbered from $1$ to $N$.\n\nThe second line contains $N$ positive integers. The $i$-th integer denotes the cost $W_i$ of placing a scout ward at point $i$. It is guaranteed that $W_i \\le 1000$.\n\nThe third line contains a positive integer $M$, denoting the number of points where player B may appear. It is guaranteed that $M \\le N$.\n\nThe fourth line contains $M$ positive integers, denoting the indices of the points where player B may appear, given in strictly increasing order without repetition.\n\nThe next $N-1$ lines each contain two positive integers $U, V$, indicating that there is an undirected edge between points $U$ and $V$.", "outputFormat": "Output a single integer on one line, the minimum total cost required to monitor all points where player B may appear.", "hint": "For all testdata, $N \\le 5 \\times 10^5$, $D \\le 20$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2016/SHOI2016] 侦察守卫", "background": "", "description": "小 R 和 B 神正在玩一款游戏。这款游戏的地图由 $N$ 个点和 $N-1$ 条无向边组成，每条无向边连接两个点，且地图是连通的。换句话说，游戏的地图是一棵有 $N$ 个节点的树。\n\n游戏中有一种道具叫做侦查守卫，当一名玩家在一个点上放置侦查守卫后，它可以监视这个点以及与这个点的距离在 $D$ 以内的所有点。这里两个点之间的距离定义为它们在树上的距离，也就是两个点之间唯一的简单路径上所经过边的条数。在一个点上放置侦查守卫需要付出一定的代价，在不同点放置守卫的代价可能不同。\n\n现在小 R 知道了所有 B 神可能会出现的位置，请你计算监视所有这些位置的最小代价。\n", "inputFormat": "第一行包含两个正整数 $N$ 和 $D$，分别表示地图上的点数和侦查守卫的视野范围。约定地图上的点用 $1$ 到 $N$ 的整数编号。\n\n第二行 $N$ 个正整数，第 $i$ 个正整数表示在编号为 $i$ 的点放置侦查守卫的代价 $W _ i$。保证 $W _ i \\le 1000$。\n\n第三行一个正整数 $M$，表示 B 神可能出现的点的数量。保证 $M \\le N$。\n\n第四行 $M$ 个正整数，分别表示每个 B 神可能出现的点的编号，从小到大不重复地给出。\n\n接下来 $N-1$ 行，每行包含两个正整数 $U,V$，表示在编号为 $U$ 的点和编号为 $V$ 的点之间有一条无向边。\n", "outputFormat": "仅一行一个整数，表示监视所有 B 神可能出现的点所需要的最小代价。\n", "hint": "对于所有的数据，$N \\le 5 \\times 10 ^ 5,D \\le 20$。", "locale": "zh-CN"}}}
{"pid": "P3268", "type": "P", "difficulty": 6, "samples": [["2\n0 0 1\n0 0 2", "3"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2016", "各省省选", "吉林"], "title": "[JLOI2016] 圆的异或并", "background": null, "description": "在平面直角坐标系中给定 $N$ 个圆。已知这些圆**两两没有交点**，即两圆的关系只存在相离和包含。求这些圆的异或面积并。\n\n异或面积并定义为：当一片区域在奇数个圆内，则计入其面积，否则，当一片区域在偶数个圆内则不计入其面积。", "inputFormat": "第一行包含一个正整数 $N$，代表圆的个数。\n\n接下来 $N$ 行，每行 $3$ 个整数 $x,y,r$，表示一个圆心在 $(x,y)$，半径为 $r$ 的圆。\n\n数据保证 $|x_i|,|y_i|\\le 10^8$，$0<r\\leq 10^6$，$1\\le N\\le 2\\times 10^5$。", "outputFormat": "仅一行一个整数，表示所有圆的异或面积并除以圆周率 $\\pi$ 的结果。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "[JLOI2016] XOR Area Union of Circles", "background": "", "description": "Given $N$ circles in the 2D Cartesian coordinate system. It is known that any two circles have no intersection points; that is, two circles are either disjoint or one contains the other. Compute the XOR area union of these circles.\n\nThe XOR area union is defined as follows: a region is counted if it lies inside an odd number of circles; otherwise, if it lies inside an even number of circles, it is not counted.", "inputFormat": "The first line contains a positive integer $N$, the number of circles.\n\nEach of the next $N$ lines contains $3$ integers $x,y,r$, representing a circle centered at $(x,y)$ with radius $r$.\n\nConstraints: $|x_i|,|y_i|\\le 10^8$, $0<r\\leq 10^6$, $1\\le N\\le 2\\times 10^5$.", "outputFormat": "Output a single integer on one line: the result of the XOR area union of all circles divided by $\\pi$.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JLOI2016] 圆的异或并", "background": null, "description": "在平面直角坐标系中给定 $N$ 个圆。已知这些圆**两两没有交点**，即两圆的关系只存在相离和包含。求这些圆的异或面积并。\n\n异或面积并定义为：当一片区域在奇数个圆内，则计入其面积，否则，当一片区域在偶数个圆内则不计入其面积。", "inputFormat": "第一行包含一个正整数 $N$，代表圆的个数。\n\n接下来 $N$ 行，每行 $3$ 个整数 $x,y,r$，表示一个圆心在 $(x,y)$，半径为 $r$ 的圆。\n\n数据保证 $|x_i|,|y_i|\\le 10^8$，$0<r\\leq 10^6$，$1\\le N\\le 2\\times 10^5$。", "outputFormat": "仅一行一个整数，表示所有圆的异或面积并除以圆周率 $\\pi$ 的结果。", "hint": null, "locale": "zh-CN"}}}
