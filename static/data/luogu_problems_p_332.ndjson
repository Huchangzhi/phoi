{"pid": "P7728", "type": "P", "difficulty": 7, "samples": [["4 10\n1 2\n2 3\n1 4\n", "1\n3\n4\n7\n9\n12\n16\n24\n32\n45\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": [], "title": "旧神归来（Return of Them）", "background": "随着虚影与暗影的决战、月岛祭坛的完工、天体风暴的出现、天界捍卫者的到来，一切月球与远古的秘密仿佛已经行至终局。\n\n旧神即将归来！", "description": "月岛上的一棵普通的树在月光侵蚀的影响下不断生长，随着月面风暴的来临变得更加无限制。\n\n具体地，生长规则如下：\n\n- 初始有一棵包含 $n$ 个结点的以 $1$ 为根的**有根树** $T_0$；\n\n- 在第 $i$ 天，树将从 $T_{i - 1}$ 生长为 $T_i$，生长规则为：令 $v$ 是 $T_{i - 1}$ 中**深度最小的叶结点**（若有多个则任意选择一个），以 $v$ 这个点替换成 $T_{i - 1}$ 本身。\n\n本题中一个结点的深度定义为它到根结点的简单路径所经过的**边数**，注意这可能与常规定义不同。\n\n下图展示了一个从 $T_{i-1}$ 生长到 $T_i$ 的例子：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xvm6j7po.png)\n\n除了面对天界捍卫者，对于环境效应的估计也是重要的，所以你需要计算：\n\n- 对于每个整数 $d \\in [1, m]$，求出 $S_d$ 表示最小的天数，满足 $T_{S_d}$ 中深度最小的叶结点深度**大于** $d$。\n\n答案对 $998244353$ 取模。", "inputFormat": "第一行，两个整数 $n, m$，分别表示 $T_0$ 的结点数和要求答案的深度范围。\n\n接下来 $n - 1$ 行，每行两个整数 $x, y$，表示 $T_0$ 中结点 $x, y$ 间有一条边。", "outputFormat": "输出 $m$ 行，第 $i$ 行输出一个整数表示 $S_i$。", "hint": "**【样例 1 解释】**\n\n如图展示了 $T_0$ 至 $T_3$ 的形态，最浅的叶子由红色标出，上一次生长出的部分用蓝色标出。\n\n可以看到，$T_1$ 中深度最小的叶子深度大于 $1$，$T_3$ 中深度最小的叶子深度大于 $2$，而再操作一次后得到的 $T_4$ 中深度最小的叶子深度就会大于 $3$（应为 $4$），这是对样例输出前三行的一个解释：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/n3lwnaol.png)\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n对于 $100 \\%$ 的数据：$2 \\le n, m \\le {10}^5$。\n\n| 子任务编号 | 分值 | $n, m \\le$ | 特殊限制 |\n|:-:|:-:|:-:|:-:|\n| $1$ | $12$ | $10$ | $T_0$ 为二叉树 |\n| $2$ | $8$ | ${10}^5$ | $T_0$ 为以 $1$ 为一端的链 |\n| $3$ | $25$ | ${10}^5$ | $T_0$ 为二叉树，且每个非叶结点都有两个子结点 |\n| $4$ | $10$ | $100$ | 无 |\n| $5$ | $12$ | $1000$ | 无 |\n| $6$ | $15$ | $30000$ | 无 |\n| $7$ | $18$ | ${10}^5$ | 无 |\n\n---\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qqzp89ei.png)", "locale": "zh-CN", "translations": {"zh-CN": {"title": "旧神归来（Return of Them）", "background": "随着虚影与暗影的决战、月岛祭坛的完工、天体风暴的出现、天界捍卫者的到来，一切月球与远古的秘密仿佛已经行至终局。\n\n旧神即将归来！", "description": "月岛上的一棵普通的树在月光侵蚀的影响下不断生长，随着月面风暴的来临变得更加无限制。\n\n具体地，生长规则如下：\n\n- 初始有一棵包含 $n$ 个结点的以 $1$ 为根的**有根树** $T_0$；\n\n- 在第 $i$ 天，树将从 $T_{i - 1}$ 生长为 $T_i$，生长规则为：令 $v$ 是 $T_{i - 1}$ 中**深度最小的叶结点**（若有多个则任意选择一个），以 $v$ 这个点替换成 $T_{i - 1}$ 本身。\n\n本题中一个结点的深度定义为它到根结点的简单路径所经过的**边数**，注意这可能与常规定义不同。\n\n下图展示了一个从 $T_{i-1}$ 生长到 $T_i$ 的例子：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xvm6j7po.png)\n\n除了面对天界捍卫者，对于环境效应的估计也是重要的，所以你需要计算：\n\n- 对于每个整数 $d \\in [1, m]$，求出 $S_d$ 表示最小的天数，满足 $T_{S_d}$ 中深度最小的叶结点深度**大于** $d$。\n\n答案对 $998244353$ 取模。", "inputFormat": "第一行，两个整数 $n, m$，分别表示 $T_0$ 的结点数和要求答案的深度范围。\n\n接下来 $n - 1$ 行，每行两个整数 $x, y$，表示 $T_0$ 中结点 $x, y$ 间有一条边。", "outputFormat": "输出 $m$ 行，第 $i$ 行输出一个整数表示 $S_i$。", "hint": "**【样例 1 解释】**\n\n如图展示了 $T_0$ 至 $T_3$ 的形态，最浅的叶子由红色标出，上一次生长出的部分用蓝色标出。\n\n可以看到，$T_1$ 中深度最小的叶子深度大于 $1$，$T_3$ 中深度最小的叶子深度大于 $2$，而再操作一次后得到的 $T_4$ 中深度最小的叶子深度就会大于 $3$（应为 $4$），这是对样例输出前三行的一个解释：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/n3lwnaol.png)\n\n---\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n对于 $100 \\%$ 的数据：$2 \\le n, m \\le {10}^5$。\n\n| 子任务编号 | 分值 | $n, m \\le$ | 特殊限制 |\n|:-:|:-:|:-:|:-:|\n| $1$ | $12$ | $10$ | $T_0$ 为二叉树 |\n| $2$ | $8$ | ${10}^5$ | $T_0$ 为以 $1$ 为一端的链 |\n| $3$ | $25$ | ${10}^5$ | $T_0$ 为二叉树，且每个非叶结点都有两个子结点 |\n| $4$ | $10$ | $100$ | 无 |\n| $5$ | $12$ | $1000$ | 无 |\n| $6$ | $15$ | $30000$ | 无 |\n| $7$ | $18$ | ${10}^5$ | 无 |\n\n---\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qqzp89ei.png)", "locale": "zh-CN"}}}
{"pid": "P7729", "type": "P", "difficulty": 7, "samples": [["3 3 0\n1 2\n2 3\n3 1\n", "4\n3\n"], ["5 6 0\n1 2\n2 3\n1 4\n4 3\n1 5\n5 3\n", "8\n30\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["Special Judge"], "title": "交通运输（Wormhole Transportation）", "background": "**本题数据点较多，请勿恶意提交。如发现恶意提交的，可能面临封号的处罚。**\n\n天体风暴过后，永恒大陆的交通急需重建。", "description": "永恒大陆上有 $n$ 个基地，基地编号为 $1, 2, \\ldots , n$。\n\n现在有 $m$ 条运输任务，第 $i$ 条形如：将货物从基地 $u_i$ 运输到基地 $v_i$。\n\n然而灾后交通并不发达，因此你决定使用虫洞：可以在任意两个不同基地 $x,y$ 之间建立一个虫洞：货物从虫洞的一端传输到虫洞的另一端只需要花费 $1$ 单位的时间。\n\n而且，**运输的方向是双向的**，也就是说，假设建立了一个连接了基地 $a, b$ 的虫洞，那么货物既可以从基地 $a$ 运输到基地 $b$，也可以从基地 $b$ 运输到基地 $a$。\n\n但建立虫洞的代价是昂贵的，你决定只建立**恰好** $\\boldsymbol{m - 1}$ 个虫洞，且不能有两个虫洞连接的两个基地完全相同。\n\n你想要知道，在所有的建造方案中， $m$ 条运输任务所花费的时间之和最小能是多少，此外，在花费的时间之和最小的情况下，有多少种建造虫洞的方案。\n\n由于第二个问题的答案可能很大，你只需要输出方案数对 ${10}^9 + 7$ 取模的结果。", "inputFormat": "第一行：三个整数 $n,m,t$，其中 $t$ 为子任务编号，对于样例来说 $t=0$。\n\n接下来 $m$ 行：每行两个整数 $u_i,v_i$。", "outputFormat": "第一行，一个整数，表示 $m$ 条运输任务所花费的时间之和的最小值。\n\n第二行，一个整数，表示建造虫洞的方案数对 ${10}^9 + 7$ 取模的结果。", "hint": "**【样例 1 解释】**\n\n有三种建造方案。\n\n其中一种是在城市 $1, 2$ 之间建立虫洞，在城市 $2, 3$ 之间建立虫洞，这样，前两条任务的时间都为 $1$，最后一条的时间为 $2$。\n\n另外两种方案是：在城市 $1, 2$ 和 $1, 3$ 之间建立虫洞，或在城市 $1, 3$ 和 $2, 3$ 之间建立虫洞。\n\n---\n\n**【数据范围】**\n\n对于所有数据，$2 \\le n \\le 2000$，$2 \\le n \\cdot m \\le 2 \\times {10}^7$，$1 \\le u_i, v_i \\le n$，$u_i\\ne v_i$。\n\n保证所有无序对 $(u_i, v_i)$ 两两不同，且至少存在一种合法的建造虫洞的方案。\n\n| 子任务编号 | 分值 | $n \\le$ | 特殊限制 | 部分分 |\n|:-:|:-:|:-:|:-:|:-:|\n| $1$ | $10$ | $6$ | 无 | $0$ |\n| $2$ | $12$ | $2000$ | $m=n$，且 $u_i=i,\\ v_i=i\\bmod n+1$ | $3$ |\n| $3$ | $12$ | $2000$ | 由所有 $(u_i,v_i)$ 为无向边构成的图为仙人掌森林 | $3$ |\n| $4$ | $25$ | $2000$ | 由所有 $(u_i,v_i)$ 为无向边构成的图为杏仁 | $8$ |\n| $5$ | $27$ | $300$ | $m\\leq 1000$ | $8$ |\n| $6$ | $14$ | $2000$ | 无 | $3$ |\n\n仙人掌森林：每条边在至多一个简单环中的无向图。\n\n杏仁：恰好存在两个度数大于 $2$ 的结点，其他结点度数都等于 $2$，且所有环都经过两个度数大于 $2$ 的结点的连通无向图。\n\n当你对于某个子任务的所有测试点，**第一问都回答正确，但第二问没有都回答正确**，你将获得这个子任务的部分分。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "交通运输（Wormhole Transportation）", "background": "**本题数据点较多，请勿恶意提交。如发现恶意提交的，可能面临封号的处罚。**\n\n天体风暴过后，永恒大陆的交通急需重建。", "description": "永恒大陆上有 $n$ 个基地，基地编号为 $1, 2, \\ldots , n$。\n\n现在有 $m$ 条运输任务，第 $i$ 条形如：将货物从基地 $u_i$ 运输到基地 $v_i$。\n\n然而灾后交通并不发达，因此你决定使用虫洞：可以在任意两个不同基地 $x,y$ 之间建立一个虫洞：货物从虫洞的一端传输到虫洞的另一端只需要花费 $1$ 单位的时间。\n\n而且，**运输的方向是双向的**，也就是说，假设建立了一个连接了基地 $a, b$ 的虫洞，那么货物既可以从基地 $a$ 运输到基地 $b$，也可以从基地 $b$ 运输到基地 $a$。\n\n但建立虫洞的代价是昂贵的，你决定只建立**恰好** $\\boldsymbol{m - 1}$ 个虫洞，且不能有两个虫洞连接的两个基地完全相同。\n\n你想要知道，在所有的建造方案中， $m$ 条运输任务所花费的时间之和最小能是多少，此外，在花费的时间之和最小的情况下，有多少种建造虫洞的方案。\n\n由于第二个问题的答案可能很大，你只需要输出方案数对 ${10}^9 + 7$ 取模的结果。", "inputFormat": "第一行：三个整数 $n,m,t$，其中 $t$ 为子任务编号，对于样例来说 $t=0$。\n\n接下来 $m$ 行：每行两个整数 $u_i,v_i$。", "outputFormat": "第一行，一个整数，表示 $m$ 条运输任务所花费的时间之和的最小值。\n\n第二行，一个整数，表示建造虫洞的方案数对 ${10}^9 + 7$ 取模的结果。", "hint": "**【样例 1 解释】**\n\n有三种建造方案。\n\n其中一种是在城市 $1, 2$ 之间建立虫洞，在城市 $2, 3$ 之间建立虫洞，这样，前两条任务的时间都为 $1$，最后一条的时间为 $2$。\n\n另外两种方案是：在城市 $1, 2$ 和 $1, 3$ 之间建立虫洞，或在城市 $1, 3$ 和 $2, 3$ 之间建立虫洞。\n\n---\n\n**【数据范围】**\n\n对于所有数据，$2 \\le n \\le 2000$，$2 \\le n \\cdot m \\le 2 \\times {10}^7$，$1 \\le u_i, v_i \\le n$，$u_i\\ne v_i$。\n\n保证所有无序对 $(u_i, v_i)$ 两两不同，且至少存在一种合法的建造虫洞的方案。\n\n| 子任务编号 | 分值 | $n \\le$ | 特殊限制 | 部分分 |\n|:-:|:-:|:-:|:-:|:-:|\n| $1$ | $10$ | $6$ | 无 | $0$ |\n| $2$ | $12$ | $2000$ | $m=n$，且 $u_i=i,\\ v_i=i\\bmod n+1$ | $3$ |\n| $3$ | $12$ | $2000$ | 由所有 $(u_i,v_i)$ 为无向边构成的图为仙人掌森林 | $3$ |\n| $4$ | $25$ | $2000$ | 由所有 $(u_i,v_i)$ 为无向边构成的图为杏仁 | $8$ |\n| $5$ | $27$ | $300$ | $m\\leq 1000$ | $8$ |\n| $6$ | $14$ | $2000$ | 无 | $3$ |\n\n仙人掌森林：每条边在至多一个简单环中的无向图。\n\n杏仁：恰好存在两个度数大于 $2$ 的结点，其他结点度数都等于 $2$，且所有环都经过两个度数大于 $2$ 的结点的连通无向图。\n\n当你对于某个子任务的所有测试点，**第一问都回答正确，但第二问没有都回答正确**，你将获得这个子任务的部分分。", "locale": "zh-CN"}}}
{"pid": "P7730", "type": "P", "difficulty": 6, "samples": [["3 3\n1 3 2\n- 1 10\n- 2 3\n+ 1 1", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["网络流", "二分图", "费用流"], "title": "[JDWOI-1] 蜀道难", "background": "蜀道难，难于上青天…… \n\n蜀道之所以难，就是因为山路崎岖不平。", "description": "小 K 和小 M 也模拟了蜀道难。在蜀道难中，有 $n$ 座山，每座山高度为 $h_i$。小 K 和小 M 有 $m$ 种魔法，每一次魔法可以把连续 $l_i$ 座山的高度抬高或压低 $1$，同时消耗 $c_i$ 点体力。\n\n现在，小 K 和小 M 想让蜀道难的 $n$ 座山的高度不下降，这样蜀道就不难了。请问他们最少需消耗多少体力？\n\n**注**：所有时候山的高度都不能为负。", "inputFormat": "第一行两个整数 $n,m$，表示山的数量和魔法数量。\n\n第二行 $n$ 个整数 $h_i$，表示山的高度。\n\n接下来 $m$ 行，每行一个字符和两个整数 $w_i, l_i, c_i$，描述一种魔法（如果 $w_i$ 为 $+$，代表抬高；如果 $w_i$ 为 $-$，代表压低）。", "outputFormat": "一行一个整数，表示最小消耗的体力。\n\n如果无解，输出 $-1$。", "hint": "### 样例解释\n\n使用 $1$ 体力值将第三座山升高 $1$。\n\n### 数据范围\n\n- 对于 $10\\%$ 的数据，$1\\leq n,m \\leq 10$；\n- 对于另外 $30\\%$ 的数据，$1\\leq n,m \\leq 20$；\n- 对于另外 $10\\%$ 的数据，$m=1$；\n- 对于所有的数据，$1\\leq n, m \\leq 200$，$1\\leq l_i \\leq n$，$1\\leq h_i, c_i \\leq 10^3$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JDWOI-1] 蜀道难", "background": "蜀道难，难于上青天…… \n\n蜀道之所以难，就是因为山路崎岖不平。", "description": "小 K 和小 M 也模拟了蜀道难。在蜀道难中，有 $n$ 座山，每座山高度为 $h_i$。小 K 和小 M 有 $m$ 种魔法，每一次魔法可以把连续 $l_i$ 座山的高度抬高或压低 $1$，同时消耗 $c_i$ 点体力。\n\n现在，小 K 和小 M 想让蜀道难的 $n$ 座山的高度不下降，这样蜀道就不难了。请问他们最少需消耗多少体力？\n\n**注**：所有时候山的高度都不能为负。", "inputFormat": "第一行两个整数 $n,m$，表示山的数量和魔法数量。\n\n第二行 $n$ 个整数 $h_i$，表示山的高度。\n\n接下来 $m$ 行，每行一个字符和两个整数 $w_i, l_i, c_i$，描述一种魔法（如果 $w_i$ 为 $+$，代表抬高；如果 $w_i$ 为 $-$，代表压低）。", "outputFormat": "一行一个整数，表示最小消耗的体力。\n\n如果无解，输出 $-1$。", "hint": "### 样例解释\n\n使用 $1$ 体力值将第三座山升高 $1$。\n\n### 数据范围\n\n- 对于 $10\\%$ 的数据，$1\\leq n,m \\leq 10$；\n- 对于另外 $30\\%$ 的数据，$1\\leq n,m \\leq 20$；\n- 对于另外 $10\\%$ 的数据，$m=1$；\n- 对于所有的数据，$1\\leq n, m \\leq 200$，$1\\leq l_i \\leq n$，$1\\leq h_i, c_i \\leq 10^3$。", "locale": "zh-CN"}}}
{"pid": "P7731", "type": "P", "difficulty": 2, "samples": [["1\n1 1 1 2\n50 -30", "0"], ["2\n1 2 2 2\n1 0\n2 0", "-1"], ["2\n1 -1 2 1\n1 0\n2 0", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "2021"], "title": "『PG1』[JDWOI-2] 猪猪大厦", "background": "", "description": "$ \\texttt{piggy} $ 建了一个巨大无比的 $\\texttt {PIG}$ 大厦，可以看做一个平面，在这个平面上有 $n$ 个无限长的不垂直或平行于地面的扶手电梯，可以看做一些一次函数，并且这些电梯方向均朝右即 $x$ 轴正方向。\n\n两个电梯的交汇点可以花 $1 \\ \\texttt{ZMB}$ 换乘。\n\n一个人想要给  $ \\texttt{piggy} $ 发短信让 $ \\texttt{piggy} $ 过去找他 。\n\n但是：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/m2hw7oer.png)\n\n于是只能走过去找 $ \\texttt{piggy} $。\n\n此时他站在第 $x_1$ 个电梯的横坐标为 $y_1$ 位置。\n\n$ \\texttt{piggy} $ 在第 $x_2$ 个电梯的横坐标为 $y_2$ 位置。\n\n请问他最少花多少 $\\texttt{ZMB}$ 才能过去？\n\n", "inputFormat": "第一行一个正整数 $n$。\n\n第二行四个整数 $x_1,y_1,x_2,y_2$。\n\n接下来 $n$ 行，第 $i$ 行两个数 $k_i,b_i$，表示电梯的解析式为 $y=k_ix+b_i$。", "outputFormat": "最少花多少 $\\texttt{ZMB}$？如果无法到达，输出 `-1`。", "hint": "**本题采用 Subtask。**\n\n$\\sf Subtask1(20pts)$：$1 \\le n \\le 10$；\n\n$\\sf Subtask2(30pts)$：$1 \\le n\\le 1000$；\n\n$\\sf Subtask3(50pts)$：$1 \\le x_1,x_2 \\le n\\le 10^5$，$-10^3 \\le y_1,y_2,k_i,b_i \\le 10^3$。\n\n**电梯的编号从 1 开始。**", "locale": "zh-CN", "translations": {"zh-CN": {"title": "『PG1』[JDWOI-2] 猪猪大厦", "background": "", "description": "$ \\texttt{piggy} $ 建了一个巨大无比的 $\\texttt {PIG}$ 大厦，可以看做一个平面，在这个平面上有 $n$ 个无限长的不垂直或平行于地面的扶手电梯，可以看做一些一次函数，并且这些电梯方向均朝右即 $x$ 轴正方向。\n\n两个电梯的交汇点可以花 $1 \\ \\texttt{ZMB}$ 换乘。\n\n一个人想要给  $ \\texttt{piggy} $ 发短信让 $ \\texttt{piggy} $ 过去找他 。\n\n但是：\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/m2hw7oer.png)\n\n于是只能走过去找 $ \\texttt{piggy} $。\n\n此时他站在第 $x_1$ 个电梯的横坐标为 $y_1$ 位置。\n\n$ \\texttt{piggy} $ 在第 $x_2$ 个电梯的横坐标为 $y_2$ 位置。\n\n请问他最少花多少 $\\texttt{ZMB}$ 才能过去？\n\n", "inputFormat": "第一行一个正整数 $n$。\n\n第二行四个整数 $x_1,y_1,x_2,y_2$。\n\n接下来 $n$ 行，第 $i$ 行两个数 $k_i,b_i$，表示电梯的解析式为 $y=k_ix+b_i$。", "outputFormat": "最少花多少 $\\texttt{ZMB}$？如果无法到达，输出 `-1`。", "hint": "**本题采用 Subtask。**\n\n$\\sf Subtask1(20pts)$：$1 \\le n \\le 10$；\n\n$\\sf Subtask2(30pts)$：$1 \\le n\\le 1000$；\n\n$\\sf Subtask3(50pts)$：$1 \\le x_1,x_2 \\le n\\le 10^5$，$-10^3 \\le y_1,y_2,k_i,b_i \\le 10^3$。\n\n**电梯的编号从 1 开始。**", "locale": "zh-CN"}}}
{"pid": "P7732", "type": "P", "difficulty": 5, "samples": [["2\n5\nRRBBR\n1 2\n1 3\n2 4\n2 5\nBRBRB\n5\nRRRRR\n1 2\n2 3\n3 4\n4 5\nBBBBB", "3\n3"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["O2优化", "状压 DP"], "title": "[JDWOI-2] 红黑树", "background": "小 M 迷上了画画，所以她用红色和黑色的画笔画出了一棵红黑树。", "description": "这棵树有 $n$ 个点，从 $1$ 开始标号，其中 $1$ 号点为树根。一开始，小 M 给这 $n$ 个点分别涂上了红色或黑色，第 $i$ 号点的颜色是 $a_i$（'R' 代表红色，'B' 代表黑色）。\n\n但可惜的是，小 M 对这棵树并不是非常满意，她希望第 $i$ 号点的颜色为 $b_i$。\n\n好在她的好朋友小 K 懂得一点点膜法。小 K 可以先选定一个点，然后把这个点的颜色反转（红变黑，黑变红）。但这个膜法太强大了，所以会把膜法传递下去，即在反转的一秒之后使当前点的父节点颜色也进行反转，如此传递，直到根节点为止。特殊的，如果在同一时刻有多个膜法作用在同一个点上，这些膜法会两两抵消，如果恰好抵消完了（即膜法的个数为偶数），则当前点不会变色，并且不会有膜法继续传递下去。注意此处抵消膜法不需要耗时间。\n\n但毕竟小 K 还是个新手，所以他在一秒之内只能最多对一个节点施展上述膜法。\n\n为了尽快让小 M 开心，小 K 想知道，至少经过多少秒才能让这棵红黑树初次出现小 M 的理想颜色状态？可以证明，总可以按题目要求变成理想颜色状态。", "inputFormat": "**本题多测**。\n\n第一行一个整数 $Q$，表示数据组数。\n\n**对于每组数据：**\n\n第一行一个整数 $n$，表示红黑树的节点数。\n\n第二行一个长度为 $n$ 的字符串 $a$，表示红黑树的初始颜色状态，其中仅含有 'R' 或 'B'。\n\n接下来 $n-1$ 行，每行两个整数 $x,y$，描述一条树边。\n\n最后一行一个长度为 $n$ 的字符串 $b$，表示红黑树的理想颜色状态，其中仅含有 'R' 或 'B'。", "outputFormat": "共 $Q$ 行每行一个整数，一组数据一行，表示答案，即最小耗时。", "hint": "**【样例解释】**\n\n第一组数据中，小 K 可以在第 $1$ 秒给 $4$ 号点膜法，整个树变为 RRBRR，在第 $2$ 秒给 $5$ 号点膜法，整个树变成 RBBRB，在第 $3$ 秒给 $1$ 号点膜法，整个树变成 BRBRB。\n\n第二组数据中，小 K 可以在第 $1$ 秒给 $5$ 号点膜法，在第二秒给 $2$ 号点膜法；或者在第 $1$ 秒给 $3$ 号点膜法，在第 $2$ 秒给 $5$ 号点膜法。\n\n**【数据范围】**\n\n对于 $10\\%$ 的数据，$1\\leq n\\leq 5$；\n\n对于 $30\\%$ 的数据，$1\\leq n\\leq 10$；\n\n对于另外 $20\\%$ 的数据，$\\forall a_i\\neq b_i$；\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 20$，$1\\leq Q\\leq 20$，树随机生成。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JDWOI-2] 红黑树", "background": "小 M 迷上了画画，所以她用红色和黑色的画笔画出了一棵红黑树。", "description": "这棵树有 $n$ 个点，从 $1$ 开始标号，其中 $1$ 号点为树根。一开始，小 M 给这 $n$ 个点分别涂上了红色或黑色，第 $i$ 号点的颜色是 $a_i$（'R' 代表红色，'B' 代表黑色）。\n\n但可惜的是，小 M 对这棵树并不是非常满意，她希望第 $i$ 号点的颜色为 $b_i$。\n\n好在她的好朋友小 K 懂得一点点膜法。小 K 可以先选定一个点，然后把这个点的颜色反转（红变黑，黑变红）。但这个膜法太强大了，所以会把膜法传递下去，即在反转的一秒之后使当前点的父节点颜色也进行反转，如此传递，直到根节点为止。特殊的，如果在同一时刻有多个膜法作用在同一个点上，这些膜法会两两抵消，如果恰好抵消完了（即膜法的个数为偶数），则当前点不会变色，并且不会有膜法继续传递下去。注意此处抵消膜法不需要耗时间。\n\n但毕竟小 K 还是个新手，所以他在一秒之内只能最多对一个节点施展上述膜法。\n\n为了尽快让小 M 开心，小 K 想知道，至少经过多少秒才能让这棵红黑树初次出现小 M 的理想颜色状态？可以证明，总可以按题目要求变成理想颜色状态。", "inputFormat": "**本题多测**。\n\n第一行一个整数 $Q$，表示数据组数。\n\n**对于每组数据：**\n\n第一行一个整数 $n$，表示红黑树的节点数。\n\n第二行一个长度为 $n$ 的字符串 $a$，表示红黑树的初始颜色状态，其中仅含有 'R' 或 'B'。\n\n接下来 $n-1$ 行，每行两个整数 $x,y$，描述一条树边。\n\n最后一行一个长度为 $n$ 的字符串 $b$，表示红黑树的理想颜色状态，其中仅含有 'R' 或 'B'。", "outputFormat": "共 $Q$ 行每行一个整数，一组数据一行，表示答案，即最小耗时。", "hint": "**【样例解释】**\n\n第一组数据中，小 K 可以在第 $1$ 秒给 $4$ 号点膜法，整个树变为 RRBRR，在第 $2$ 秒给 $5$ 号点膜法，整个树变成 RBBRB，在第 $3$ 秒给 $1$ 号点膜法，整个树变成 BRBRB。\n\n第二组数据中，小 K 可以在第 $1$ 秒给 $5$ 号点膜法，在第二秒给 $2$ 号点膜法；或者在第 $1$ 秒给 $3$ 号点膜法，在第 $2$ 秒给 $5$ 号点膜法。\n\n**【数据范围】**\n\n对于 $10\\%$ 的数据，$1\\leq n\\leq 5$；\n\n对于 $30\\%$ 的数据，$1\\leq n\\leq 10$；\n\n对于另外 $20\\%$ 的数据，$\\forall a_i\\neq b_i$；\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 20$，$1\\leq Q\\leq 20$，树随机生成。", "locale": "zh-CN"}}}
{"pid": "P7733", "type": "P", "difficulty": 5, "samples": [["4 3\n1 2\n2 3\n3 4\n1 4", "1"], ["6 7\n1 2\n2 3\n3 1\n4 5\n5 6\n6 4\n1 4\n1 4", "2"], ["15 14\n1 2\n2 3\n3 4\n4 5\n5 6\n6 7\n7 8\n8 9\n9 10\n3 11\n11 12\n12 13\n13 14\n14 15\n1 10", "6"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["O2优化", "最短路"], "title": "[JDWOI-2] 抢救实验数据", "background": "某大型实验中心的一个实验室发生了毒气泄露，现在实验员想要抢救实验数据。", "description": "实验中心可以看做一个 $n$ 个点 $m$ 条边的无向联通图。  \n所有实验员每秒可以走到一个相邻的实验室并**收集**其中的数据，毒气每秒会蔓延到所有的相邻实验室。\n当一个实验员**回到了大厅 $s$**，我们称他**抢救**了数据。  \n实验员不能进入有毒气的实验室（如果他和毒气在同一秒进入实验室也不行）。  \n**大厅周围有严格的保护措施，不会被毒气蔓延。（具体可以参考样例二）**  \n现在所有实验员都在大厅 $s$，毒气泄露的实验室为点 $t$。假如有**足够多**的实验员同时出发，请问最多能抢救多少个实验室的数据？", "inputFormat": "第一行两个正整数 $n,m$，表示实验中心的点数和边数。  \n第二至 $m+1$ 行每行两个正整数 $u,v$，代表 $u,v$ 实验室之间有一条边。  \n第 $m+2$ 行两个正整数 $s,t$，表示大厅和毒气泄露点。", "outputFormat": "一行一个整数，表示最多能抢救多少个的实验室的数据。", "hint": "**请注意常数因子带来的程序效率上的影响。**\n\n【样例解释一】  \n只有 2 号实验室可以到达并回来。\n\n【样例解释二】  \n因为大厅是坚不可摧的，所以 5,6 两个实验室会被毒气蔓延到，而 2,3 两个实验室永远不会被蔓延到。\n\n【样例解释三】  \n可以被抢救的点为：2,3,4,5,11,12。\n\n【数据范围】  \n**本题采用捆绑测试**。  \n对于 $10\\%$ 的数据，$2 \\leq n,m \\leq 20$；  \n对于 $30\\%$ 的数据，$2 \\leq n \\leq 2000,1 \\leq m \\leq 10000$；  \n对于 $70\\%$ 的数据，$2 \\leq n \\leq 2 \\times 10^5$；  \n对于 $100\\%$ 的数据，$2 \\leq n,m \\leq 5 \\times 10^6$。\n\n由于读入量很大，这里提供 std 使用的快读模板（提交时需要选择 C++11 及以上)\n```cpp\nchar gc() {\n  static char now[1 << 20], *S, *T;\n  if (T == S) {\n    T = (S = now) + std::fread(now, 1, 1 << 20, stdin);\n    if (T == S) return EOF;\n  }\n  return *S++;\n}\ntemplate <typename T>\nvoid Read(T &x) {\n  x = 0;\n  char c = gc();\n  while (c < '0' || c > '9') c = gc();\n  x = c - '0';\n  while ((c = gc()) >= '0' && c <= '9') x = x * 10 + c - '0';\n}\ntemplate <typename T, typename... Args>\nvoid Read(T &x, Args &... args) {\n  Read(x);\n  Read(args...);\n}\n```\n使用方法：`Read(n, m)` 或 `Read(x, y, z)` 等，可以读入任意个数，但是不能与 `std::cin` 和 `std::scanf` 一起使用。读入完成后 Windows 系统按 Ctrl+Z，Linux 系统按 Ctrl+D 结束。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JDWOI-2] 抢救实验数据", "background": "某大型实验中心的一个实验室发生了毒气泄露，现在实验员想要抢救实验数据。", "description": "实验中心可以看做一个 $n$ 个点 $m$ 条边的无向联通图。  \n所有实验员每秒可以走到一个相邻的实验室并**收集**其中的数据，毒气每秒会蔓延到所有的相邻实验室。\n当一个实验员**回到了大厅 $s$**，我们称他**抢救**了数据。  \n实验员不能进入有毒气的实验室（如果他和毒气在同一秒进入实验室也不行）。  \n**大厅周围有严格的保护措施，不会被毒气蔓延。（具体可以参考样例二）**  \n现在所有实验员都在大厅 $s$，毒气泄露的实验室为点 $t$。假如有**足够多**的实验员同时出发，请问最多能抢救多少个实验室的数据？", "inputFormat": "第一行两个正整数 $n,m$，表示实验中心的点数和边数。  \n第二至 $m+1$ 行每行两个正整数 $u,v$，代表 $u,v$ 实验室之间有一条边。  \n第 $m+2$ 行两个正整数 $s,t$，表示大厅和毒气泄露点。", "outputFormat": "一行一个整数，表示最多能抢救多少个的实验室的数据。", "hint": "**请注意常数因子带来的程序效率上的影响。**\n\n【样例解释一】  \n只有 2 号实验室可以到达并回来。\n\n【样例解释二】  \n因为大厅是坚不可摧的，所以 5,6 两个实验室会被毒气蔓延到，而 2,3 两个实验室永远不会被蔓延到。\n\n【样例解释三】  \n可以被抢救的点为：2,3,4,5,11,12。\n\n【数据范围】  \n**本题采用捆绑测试**。  \n对于 $10\\%$ 的数据，$2 \\leq n,m \\leq 20$；  \n对于 $30\\%$ 的数据，$2 \\leq n \\leq 2000,1 \\leq m \\leq 10000$；  \n对于 $70\\%$ 的数据，$2 \\leq n \\leq 2 \\times 10^5$；  \n对于 $100\\%$ 的数据，$2 \\leq n,m \\leq 5 \\times 10^6$。\n\n由于读入量很大，这里提供 std 使用的快读模板（提交时需要选择 C++11 及以上)\n```cpp\nchar gc() {\n  static char now[1 << 20], *S, *T;\n  if (T == S) {\n    T = (S = now) + std::fread(now, 1, 1 << 20, stdin);\n    if (T == S) return EOF;\n  }\n  return *S++;\n}\ntemplate <typename T>\nvoid Read(T &x) {\n  x = 0;\n  char c = gc();\n  while (c < '0' || c > '9') c = gc();\n  x = c - '0';\n  while ((c = gc()) >= '0' && c <= '9') x = x * 10 + c - '0';\n}\ntemplate <typename T, typename... Args>\nvoid Read(T &x, Args &... args) {\n  Read(x);\n  Read(args...);\n}\n```\n使用方法：`Read(n, m)` 或 `Read(x, y, z)` 等，可以读入任意个数，但是不能与 `std::cin` 和 `std::scanf` 一起使用。读入完成后 Windows 系统按 Ctrl+Z，Linux 系统按 Ctrl+D 结束。", "locale": "zh-CN"}}}
{"pid": "P7734", "type": "P", "difficulty": 6, "samples": [["1100..", "1\n1 5\n"], ["0101..", "-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["Special Judge", "构造"], "title": "[JDWOI-2] 01 串", "background": "小 K 和小 M 写了一个 01 串。", "description": "小 K 和小 M 写了一个 01 串 $S$，串的**结尾**包含 2 个连在一起的空格（用 `.` 表示）。\n\n小 M 定义一个 01 串是美观的，当且仅当串中没有逆序对，即没有 1 出现在 0 的前面。\n\n为了满足小 M 的上述要求，小 K 决定对这个 01 串进行一些修改。每一次修改，小 K 可以选择串中两个连续的非空格字符，并把他们移动到空格的位置，并且不改变相对位置。这样，被移动的字符处会变成空格，而原来的空格会被这两个字符填起来。\n\n小 K 为了尽快让字符串变美观，希望在 $10000$ 步以内完成。现在，请求出需要用多少步使得 01 串变美观，并输出方案。如果无法使串美观，或者步数必须超过 $10000$ ，请输出 `-1`。\n\n**注：你并不需要最小化修改步数，并且最终空格的位置随便。**", "inputFormat": "一行一个 01 字符串，保证输入符合题意。", "outputFormat": "第一行一个整数 $m$，表示修改的步数。  \n\n接下来 $m$ 行，每行两个整数 $x,y$，表示将 $(x,x+1)$ 位置上的两个数移动到 $(y,y+1)$。", "hint": "**本题采用 Special Judge 和子任务评测。**\n\n【样例解释 1】  \n\n$\\texttt{1100..} \\rightarrow \\texttt{..0011}$\n\n【样例解释 2】  \n\n可以发现无论如何移动都无法实现小 M 要求的 01 串。\n\n【数据范围和子任务分数】  \n\nSubtask1(20pts)：$3 \\leq |S| \\leq 10$；  \nSubtask2(30pts)：$3 \\leq |S| \\leq 100$；  \nSubtask3(50pts)：$3 \\leq |S| \\leq 2000$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[JDWOI-2] 01 串", "background": "小 K 和小 M 写了一个 01 串。", "description": "小 K 和小 M 写了一个 01 串 $S$，串的**结尾**包含 2 个连在一起的空格（用 `.` 表示）。\n\n小 M 定义一个 01 串是美观的，当且仅当串中没有逆序对，即没有 1 出现在 0 的前面。\n\n为了满足小 M 的上述要求，小 K 决定对这个 01 串进行一些修改。每一次修改，小 K 可以选择串中两个连续的非空格字符，并把他们移动到空格的位置，并且不改变相对位置。这样，被移动的字符处会变成空格，而原来的空格会被这两个字符填起来。\n\n小 K 为了尽快让字符串变美观，希望在 $10000$ 步以内完成。现在，请求出需要用多少步使得 01 串变美观，并输出方案。如果无法使串美观，或者步数必须超过 $10000$ ，请输出 `-1`。\n\n**注：你并不需要最小化修改步数，并且最终空格的位置随便。**", "inputFormat": "一行一个 01 字符串，保证输入符合题意。", "outputFormat": "第一行一个整数 $m$，表示修改的步数。  \n\n接下来 $m$ 行，每行两个整数 $x,y$，表示将 $(x,x+1)$ 位置上的两个数移动到 $(y,y+1)$。", "hint": "**本题采用 Special Judge 和子任务评测。**\n\n【样例解释 1】  \n\n$\\texttt{1100..} \\rightarrow \\texttt{..0011}$\n\n【样例解释 2】  \n\n可以发现无论如何移动都无法实现小 M 要求的 01 串。\n\n【数据范围和子任务分数】  \n\nSubtask1(20pts)：$3 \\leq |S| \\leq 10$；  \nSubtask2(30pts)：$3 \\leq |S| \\leq 100$；  \nSubtask3(50pts)：$3 \\leq |S| \\leq 2000$。", "locale": "zh-CN"}}}
{"pid": "P7735", "type": "P", "difficulty": 6, "samples": [["1\n7 7\n1 2\n1 3\n3 4\n3 5\n3 6\n6 7\n1 1 7\n2 1 4\n2 2 7\n1 1 5\n2 2 7\n1 2 1\n2 1 7", "1\n3\n2\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["线段树", "2021", "NOI", "O2优化", "树链剖分", "动态树 LCT"], "title": "[NOI2021] 轻重边", "background": "", "description": "小 W 有一棵 $n$ 个结点的树，树上的每一条边可能是轻边或者重边。接下来你需要对树进行 $m$ 次操作，在所有操作开始前，树上所有边都是轻边。操作有以下两种：\n1. 给定两个点 $a$ 和 $b$，首先对于 $a$ 到 $b$ 路径上的所有点 $x$（包含 $a$ 和 $b$），你要将与 $x$ 相连的所有边变为轻边。然后再将 $a$ 到 $b$ 路径上包含的所有边变为重边。\n2. 给定两个点 $a$ 和 $b$，你需要计算当前 $a$ 到 $b$ 的路径上一共包含多少条重边。\n", "inputFormat": "本题有多组数据，输入数据第一行一个正整数 $T$，表示数据组数。对于每组数据：\n\n第一行包含两个整数 $n$ 和 $m$，其中 $n$ 表示结点数量，$m$ 表示操作数量。\n\n接下来 $n - 1$ 行，每行包含两个整数 $u\\ v$，表示树上的一条边。\n\n接下来 $m$ 行，每行包含三个整数 ${\\mathit{op}}_i\\ a_i\\ b_i$，描述一个操作，其中 ${\\mathit{op}}_i = 1$ 表示第 $1$ 类操作，${\\mathit{op}}_i = 2$ 表示第 $2$ 类操作。\n\n数据保证 $a_i \\neq b_i$。", "outputFormat": "对于每一次第 $2$ 类操作，输出一行一个整数表示答案。", "hint": "**【样例解释 #1】**\n\n第 $1$ 次操作后，重边有：$(1, 3)$，$(3, 6)$，$(6, 7)$。\n\n第 $2$ 次操作，包含的重边有：$(1, 3)$。\n\n第 $3$ 次操作，包含的重边有：$(1, 3)$，$(3, 6)$，$(6, 7)$。\n\n第 $4$ 次操作，首先 $(1, 3)$，$(3, 6)$ 变为轻边，之后 $(1, 3)$，$(3, 5)$ 变为重边。\n\n第 $5$ 次操作，包含的重边有：$(1, 3)$，$(6, 7)$。\n\n第 $6$ 次操作，首先 $(1, 3)$ 变为轻边，之后 $(1, 2)$ 变为重边。\n\n第 $7$ 次操作，包含的重边有：$(6, 7)$。\n\n**【样例 #2】**\n\n见附件 `edge/edge2.in` 与 `edge/edge2.ans`。\n\n该样例约束与测试点 $3 \\sim 6$ 一致。\n\n**【样例 #3】**\n\n见附件 `edge/edge3.in` 与 `edge/edge3.ans`。\n\n该样例约束与测试点 $9 \\sim 10$ 一致。\n\n**【样例 #4】**\n\n见附件 `edge/edge4.in` 与 `edge/edge4.ans`。\n\n该样例约束与测试点 $11 \\sim 14$ 一致。\n\n**【样例 #5】**\n\n见附件 `edge/edge5.in` 与 `edge/edge5.ans`。\n\n该样例约束与测试点 $17 \\sim 20$ 一致。\n\n**【数据范围】**\n\n对于所有测试数据：$T \\le 3$，$1 \\le n, m \\le {10}^5$。\n\n| 测试点编号 | $n, m \\le $ | 特殊性质 |\n|:-:|:-:|:-:|\n| $1 \\sim 2$ | $10$ | 无 |\n| $3 \\sim 6$ | $5000$ | 无 |\n| $7 \\sim 8$ | ${10}^5$ | A，B |\n| $9 \\sim 10$ | ${10}^5$ | A |\n| $11 \\sim 14$ | ${10}^5$ | B |\n| $15 \\sim 16$ | $2\\times {10}^4$ | 无 |\n| $17 \\sim 20$ | ${10}^5$ | 无 |\n\n特殊性质 A：树的形态是一条链。\n\n特殊性质 B：第 $2$ 类操作给出的 $a_i$ 和 $b_i$ 之间有边直接相连。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI2021] 轻重边", "background": "", "description": "小 W 有一棵 $n$ 个结点的树，树上的每一条边可能是轻边或者重边。接下来你需要对树进行 $m$ 次操作，在所有操作开始前，树上所有边都是轻边。操作有以下两种：\n1. 给定两个点 $a$ 和 $b$，首先对于 $a$ 到 $b$ 路径上的所有点 $x$（包含 $a$ 和 $b$），你要将与 $x$ 相连的所有边变为轻边。然后再将 $a$ 到 $b$ 路径上包含的所有边变为重边。\n2. 给定两个点 $a$ 和 $b$，你需要计算当前 $a$ 到 $b$ 的路径上一共包含多少条重边。\n", "inputFormat": "本题有多组数据，输入数据第一行一个正整数 $T$，表示数据组数。对于每组数据：\n\n第一行包含两个整数 $n$ 和 $m$，其中 $n$ 表示结点数量，$m$ 表示操作数量。\n\n接下来 $n - 1$ 行，每行包含两个整数 $u\\ v$，表示树上的一条边。\n\n接下来 $m$ 行，每行包含三个整数 ${\\mathit{op}}_i\\ a_i\\ b_i$，描述一个操作，其中 ${\\mathit{op}}_i = 1$ 表示第 $1$ 类操作，${\\mathit{op}}_i = 2$ 表示第 $2$ 类操作。\n\n数据保证 $a_i \\neq b_i$。", "outputFormat": "对于每一次第 $2$ 类操作，输出一行一个整数表示答案。", "hint": "**【样例解释 #1】**\n\n第 $1$ 次操作后，重边有：$(1, 3)$，$(3, 6)$，$(6, 7)$。\n\n第 $2$ 次操作，包含的重边有：$(1, 3)$。\n\n第 $3$ 次操作，包含的重边有：$(1, 3)$，$(3, 6)$，$(6, 7)$。\n\n第 $4$ 次操作，首先 $(1, 3)$，$(3, 6)$ 变为轻边，之后 $(1, 3)$，$(3, 5)$ 变为重边。\n\n第 $5$ 次操作，包含的重边有：$(1, 3)$，$(6, 7)$。\n\n第 $6$ 次操作，首先 $(1, 3)$ 变为轻边，之后 $(1, 2)$ 变为重边。\n\n第 $7$ 次操作，包含的重边有：$(6, 7)$。\n\n**【样例 #2】**\n\n见附件 `edge/edge2.in` 与 `edge/edge2.ans`。\n\n该样例约束与测试点 $3 \\sim 6$ 一致。\n\n**【样例 #3】**\n\n见附件 `edge/edge3.in` 与 `edge/edge3.ans`。\n\n该样例约束与测试点 $9 \\sim 10$ 一致。\n\n**【样例 #4】**\n\n见附件 `edge/edge4.in` 与 `edge/edge4.ans`。\n\n该样例约束与测试点 $11 \\sim 14$ 一致。\n\n**【样例 #5】**\n\n见附件 `edge/edge5.in` 与 `edge/edge5.ans`。\n\n该样例约束与测试点 $17 \\sim 20$ 一致。\n\n**【数据范围】**\n\n对于所有测试数据：$T \\le 3$，$1 \\le n, m \\le {10}^5$。\n\n| 测试点编号 | $n, m \\le $ | 特殊性质 |\n|:-:|:-:|:-:|\n| $1 \\sim 2$ | $10$ | 无 |\n| $3 \\sim 6$ | $5000$ | 无 |\n| $7 \\sim 8$ | ${10}^5$ | A，B |\n| $9 \\sim 10$ | ${10}^5$ | A |\n| $11 \\sim 14$ | ${10}^5$ | B |\n| $15 \\sim 16$ | $2\\times {10}^4$ | 无 |\n| $17 \\sim 20$ | ${10}^5$ | 无 |\n\n特殊性质 A：树的形态是一条链。\n\n特殊性质 B：第 $2$ 类操作给出的 $a_i$ 和 $b_i$ 之间有边直接相连。", "locale": "zh-CN"}}}
{"pid": "P7736", "type": "P", "difficulty": 6, "samples": [["1\n3\n2 3 2\n4 4\n1 1 \n1 2\n2 1\n2 3\n1 2\n2 1\n3 1\n3 2", "1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2021", "LGV 引理", "NOI", "O2优化"], "title": "[NOI2021] 路径交点", "background": "", "description": "小 L 有一个有向图，图中的顶点可以分为 $k$ 层，第 $i$ 层有 $n_i$ 个顶点，第 $1$ 层与第 $k$ 层**顶点数相同**，即 $n_1 = n_k$，且对于第 $j$（$2 \\leq j \\leq k-1$）层，$n_1 \\leq n_j \\leq 2n_1$。对于第 $j$（$1 \\leq j < k$）层的顶点，以它们为起点的边只会连向第 $j + 1$ 层的顶点。没有边连向第 $1$ 层的顶点，第 $k$ 层的顶点不会向其他顶点连边。\n\n现在小 L 要从这个图中选出 $n_1$ 条路径，每条路径以第 $1$ 层顶点为起点，第 $k$ 层顶点为终点，并要求**图中的每个顶点至多出现在一条路径中**。更具体地，把每一层顶点按照 $1,2,\\ldots,n_i$ 进行编号，则每条路径可以写为一个 $k$ 元组 $(p_1,p_2,\\ldots,p_k)$，表示这条路径依次经过第 $j$ 层的 $p_j$（$1 \\leq p_j \\leq n_j$）号顶点，并且第 $j$（$1 \\leq j < k$）层的 $p_j$ 号顶点有一条边连向第 $j+1$ 层的第 $p_{j+1}$ 号顶点。\n\n小 L 把这些路径画在了纸上，发现它们会产生若干个交点。对于两条路径 $P,Q$，分别设它们在第 $j$ 层与第 $j+1$ 层之间的连边为 $(P_j,P_{j+1})$ 与 $(Q_j,Q_{j+1})$，若，\n\n$$(P_j-Q_j)\\times(P_{j+1}-Q_{j+1})<0$$\n\n则称它们在第 $j$ 层后产生了一个交点。两条路径的交点数为它们在第 $1, 2,\\ldots,k - 1$ 层后产生的交点总数。对于整个路径方案，它的交点数为**两两不同路径间交点数之和**。例如下图是一个 $3$ 条路径，共 $3$ 个交点的例子，其中红色点是交点。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pvr0iwkt.png)\n\n小 L 现在想知道有偶数个交点的路径方案数比有奇数个交点的路径方案数多多少个。两个路径方案被视为相同的，当且仅当它们的 $n_1$ 条路径按第一层起点编号顺序写下的 $k$ 元组能对应相同。由于最后的结果可能很大，请你输出它对 $998244353$（一个大质数）取模后的值。", "inputFormat": "本题有多组数据，输入数据第一行一个正整数 $T$ ，表示数据组数。对于每组数据：\n\n第一行一个正整数 $k$，表示一共有 $k$ 层顶点。\n\n第二行包含 $k$ 个整数 $n_1,n_2,\\ldots,n_k$，依次表示每一层的顶点数量。保证 $n_1=n_k$，且 $n_1 \\leq n_i \\leq 2n_1$（$2 \\leq i \\leq k-1$）。\n\n第三行包含 $k-1$ 个整数 $m_1,m_2,\\ldots,m_{k-1}$，依次表示第 $j$ 层顶点到第 $j+1$ 层顶点的边数。保证 $m_j \\leq n_j \\times n_{j+1}$。\n\n接下来有 $k-1$ 段输入。第 $j$（$1 \\leq j < k$）段输入包含 $m_j$ 行，每一行两个整数 $u,v$，表示第 $j$ 层的 $u$ 号顶点有一条边连向第 $j+1$ 层的 $v$ 号顶点。\n\n数据保证图中不会出现重边。", "outputFormat": "输出共 $T$ 行，每行一个整数，表示该组数据的答案对 $998244353$ 取模后的值。", "hint": "**【样例解释 #1】**\n\n偶数个交点的方案有 $2$ 个，奇数个交点的方案有 $1$ 个，所以答案为 $1$。\n\n将下表中路径 $1$ 和路径 $2$ 的方案交换，将会得到相同的方案，例如路径 $1$ 为 $(2, 3, 1)$ 且路径 $2$ 为 $(1, 1, 2)$ 的方案与方案 $1$ 是相同的方案，所以不会被计入答案。\n\n| 路径方案 | 路径 $1$  | 路径 $2$  | 交点总数 |\n| :------: | :-------: | :-------: | :------: |\n|   $1$    | $(1,1,2)$ | $(2,3,1)$ |   $1$    |\n|   $2$    | $(1,2,1)$ | $(2,1,2)$ |   $2$    |\n|   $3$    | $(1,2,1)$ | $(2,3,2)$ |   $0$    |\n\n**【样例 #2】**\n\n见附件 `xpath2.in` 与 `xpath2.ans`。\n\n该样例约束与测试点 $7 \\sim 8$ 一致。\n\n**【样例 #3】**\n\n见附件 `xpath3.in` 与 `xpath3.ans`。\n\n该样例约束与测试点 $9 \\sim 10$ 一致。\n\n**【样例 #4】**\n\n见附件 `xpath4.in` 与 `xpath4.ans`。\n\n该样例约束与测试点 $14 \\sim 15$ 一致。\n\n**【数据范围】**\n\n对于所有测试数据：$2 \\leq k \\leq 100$，$2 \\leq n_1 \\leq 100$，$1 \\leq T \\leq 5$。\n\n每个测试点中，保证 $n_1 > 10$ 的数据只有 $1$ 组。\n\n|  测试点编号  | $k=$  | $n_1 \\leq$ | 特殊性质 |\n| :----------: | :---: | :--------: | :------: |\n|  $1 \\sim 4$  |  $2$  |    $10$    |    无    |\n|  $5 \\sim 6$  | $10$  |    $10$    |   A，B    |\n|  $7 \\sim 8$  | $10$  |    $10$    |    A     |\n| $9 \\sim 10$  | $10$  |    $10$    |    无    |\n| $11 \\sim 13$ |  $2$  |   $100$    |    无    |\n| $14 \\sim 15$ | $100$ |   $100$    |   A，B    |\n| $16 \\sim 17$ | $100$ |   $100$    |    A     |\n| $18 \\sim 20$ | $100$ |   $100$    |    无    |\n\n特殊性质 A：对于所有 $i$（$2 \\leq i \\leq k-1$）满足 $n_i = n_1$。\n\n特殊性质 B：保证路径方案总数至多为 $1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI2021] 路径交点", "background": "", "description": "小 L 有一个有向图，图中的顶点可以分为 $k$ 层，第 $i$ 层有 $n_i$ 个顶点，第 $1$ 层与第 $k$ 层**顶点数相同**，即 $n_1 = n_k$，且对于第 $j$（$2 \\leq j \\leq k-1$）层，$n_1 \\leq n_j \\leq 2n_1$。对于第 $j$（$1 \\leq j < k$）层的顶点，以它们为起点的边只会连向第 $j + 1$ 层的顶点。没有边连向第 $1$ 层的顶点，第 $k$ 层的顶点不会向其他顶点连边。\n\n现在小 L 要从这个图中选出 $n_1$ 条路径，每条路径以第 $1$ 层顶点为起点，第 $k$ 层顶点为终点，并要求**图中的每个顶点至多出现在一条路径中**。更具体地，把每一层顶点按照 $1,2,\\ldots,n_i$ 进行编号，则每条路径可以写为一个 $k$ 元组 $(p_1,p_2,\\ldots,p_k)$，表示这条路径依次经过第 $j$ 层的 $p_j$（$1 \\leq p_j \\leq n_j$）号顶点，并且第 $j$（$1 \\leq j < k$）层的 $p_j$ 号顶点有一条边连向第 $j+1$ 层的第 $p_{j+1}$ 号顶点。\n\n小 L 把这些路径画在了纸上，发现它们会产生若干个交点。对于两条路径 $P,Q$，分别设它们在第 $j$ 层与第 $j+1$ 层之间的连边为 $(P_j,P_{j+1})$ 与 $(Q_j,Q_{j+1})$，若，\n\n$$(P_j-Q_j)\\times(P_{j+1}-Q_{j+1})<0$$\n\n则称它们在第 $j$ 层后产生了一个交点。两条路径的交点数为它们在第 $1, 2,\\ldots,k - 1$ 层后产生的交点总数。对于整个路径方案，它的交点数为**两两不同路径间交点数之和**。例如下图是一个 $3$ 条路径，共 $3$ 个交点的例子，其中红色点是交点。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/pvr0iwkt.png)\n\n小 L 现在想知道有偶数个交点的路径方案数比有奇数个交点的路径方案数多多少个。两个路径方案被视为相同的，当且仅当它们的 $n_1$ 条路径按第一层起点编号顺序写下的 $k$ 元组能对应相同。由于最后的结果可能很大，请你输出它对 $998244353$（一个大质数）取模后的值。", "inputFormat": "本题有多组数据，输入数据第一行一个正整数 $T$ ，表示数据组数。对于每组数据：\n\n第一行一个正整数 $k$，表示一共有 $k$ 层顶点。\n\n第二行包含 $k$ 个整数 $n_1,n_2,\\ldots,n_k$，依次表示每一层的顶点数量。保证 $n_1=n_k$，且 $n_1 \\leq n_i \\leq 2n_1$（$2 \\leq i \\leq k-1$）。\n\n第三行包含 $k-1$ 个整数 $m_1,m_2,\\ldots,m_{k-1}$，依次表示第 $j$ 层顶点到第 $j+1$ 层顶点的边数。保证 $m_j \\leq n_j \\times n_{j+1}$。\n\n接下来有 $k-1$ 段输入。第 $j$（$1 \\leq j < k$）段输入包含 $m_j$ 行，每一行两个整数 $u,v$，表示第 $j$ 层的 $u$ 号顶点有一条边连向第 $j+1$ 层的 $v$ 号顶点。\n\n数据保证图中不会出现重边。", "outputFormat": "输出共 $T$ 行，每行一个整数，表示该组数据的答案对 $998244353$ 取模后的值。", "hint": "**【样例解释 #1】**\n\n偶数个交点的方案有 $2$ 个，奇数个交点的方案有 $1$ 个，所以答案为 $1$。\n\n将下表中路径 $1$ 和路径 $2$ 的方案交换，将会得到相同的方案，例如路径 $1$ 为 $(2, 3, 1)$ 且路径 $2$ 为 $(1, 1, 2)$ 的方案与方案 $1$ 是相同的方案，所以不会被计入答案。\n\n| 路径方案 | 路径 $1$  | 路径 $2$  | 交点总数 |\n| :------: | :-------: | :-------: | :------: |\n|   $1$    | $(1,1,2)$ | $(2,3,1)$ |   $1$    |\n|   $2$    | $(1,2,1)$ | $(2,1,2)$ |   $2$    |\n|   $3$    | $(1,2,1)$ | $(2,3,2)$ |   $0$    |\n\n**【样例 #2】**\n\n见附件 `xpath2.in` 与 `xpath2.ans`。\n\n该样例约束与测试点 $7 \\sim 8$ 一致。\n\n**【样例 #3】**\n\n见附件 `xpath3.in` 与 `xpath3.ans`。\n\n该样例约束与测试点 $9 \\sim 10$ 一致。\n\n**【样例 #4】**\n\n见附件 `xpath4.in` 与 `xpath4.ans`。\n\n该样例约束与测试点 $14 \\sim 15$ 一致。\n\n**【数据范围】**\n\n对于所有测试数据：$2 \\leq k \\leq 100$，$2 \\leq n_1 \\leq 100$，$1 \\leq T \\leq 5$。\n\n每个测试点中，保证 $n_1 > 10$ 的数据只有 $1$ 组。\n\n|  测试点编号  | $k=$  | $n_1 \\leq$ | 特殊性质 |\n| :----------: | :---: | :--------: | :------: |\n|  $1 \\sim 4$  |  $2$  |    $10$    |    无    |\n|  $5 \\sim 6$  | $10$  |    $10$    |   A，B    |\n|  $7 \\sim 8$  | $10$  |    $10$    |    A     |\n| $9 \\sim 10$  | $10$  |    $10$    |    无    |\n| $11 \\sim 13$ |  $2$  |   $100$    |    无    |\n| $14 \\sim 15$ | $100$ |   $100$    |   A，B    |\n| $16 \\sim 17$ | $100$ |   $100$    |    A     |\n| $18 \\sim 20$ | $100$ |   $100$    |    无    |\n\n特殊性质 A：对于所有 $i$（$2 \\leq i \\leq k-1$）满足 $n_i = n_1$。\n\n特殊性质 B：保证路径方案总数至多为 $1$。", "locale": "zh-CN"}}}
{"pid": "P7737", "type": "P", "difficulty": 6, "samples": [["5 6 4 1\n1 2\n1 3\n1 4\n2 5\n4 5\n5 4\n1 4 5 1\n2 3 5 3\n1 2 5 2\n3 4 5 1\n", "4\n4\n4\n0\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2021", "NOI", "O2优化", "广度优先搜索 BFS", "拓扑排序", "Tarjan", "最近公共祖先 LCA", "虚树"], "title": "[NOI2021] 庆典", "background": "", "description": "C 国是一个繁荣昌盛的国家，它由 $n$ 座城市和 $m$ 条有向道路组成，城市从 $1$ 到 $n$ 编号。如果从 $x$ 号城市出发，经过若干条道路后能到达 $y$ 号城市，那么我们称 $x$ 号城市可到达 $y$ 号城市，记作 $x\\Rightarrow y$。C 国的道路有一个特点：对于三座城市 $x$，$y$，$z$，若 $x\\Rightarrow z$ 且 $y\\Rightarrow z$，那么有 $x\\Rightarrow y$ 或 $y\\Rightarrow x$。\n\n再过一个月就是 C 国成立的千年纪念日，所以 C 国的人民正在筹备盛大的游行庆典。目前 C 国得知接下来会有 $q$ 次游行计划，第 $i$ 次游行希望从城市 $s_i$ 出发，经过若干个城市后，在城市 $t_i$ 结束，且在游行过程中，**一个城市可以被经过多次**。为了增加游行的乐趣，每次游行还会**临时**修建出 $k$（$0 \\le k \\le 2$）条有向道路专门供本次游行使用，即其它游行计划不能通过本次游行修建的道路。\n\n现在 C 国想知道，每次游行计划可能会**经过多少座城市**。\n\n注意：临时修建出的道路**可以不满足 C 国道路原有的特点**。", "inputFormat": "第一行包含四个整数 $n,m,q,k$，分别表示城市数、道路数、游行计划数以及每次游行临时修建的道路数。\n\n接下来 $m$ 行，每行包含两个整数 $u,v$，表示一条有向道路 $u\\rightarrow v$。\n\n接下来 $q$ 行，每行前两个整数 $s_i,t_i$，表示每次游行的起点与终点；这行接下来有 $k$ 对整数 $a,b$，每对整数表示一条临时添加的有向道路 $a\\rightarrow b$。\n\n数据保证，将 C 国原有的有向道路视为无向道路后，所有城市可以互达。", "outputFormat": "对于每次询问，输出一行一个整数表示答案。如果一次游行从起点出发无法到达终点，输出 $0$ 即可。", "hint": "**【样例解释 #1】**\n\n第 $1$ 次计划，起点为 $1$ 号点，终点为 $4$ 号点，临时修建道路为 $5\\rightarrow1$，最终可能经过的城市编号为 $\\{1,2,4,5\\}$。\n\n第 $2$ 次计划，起点为 $2$ 号点，终点为 $3$ 号点，临时修建道路为 $5\\rightarrow3$，最终可能经过的城市编号为 $\\{2,3,4,5\\}$。\n\n第 $3$ 次计划，起点为 $1$ 号点，终点为 $2$ 号点，临时修建道路为 $5\\rightarrow2$，最终可能经过的城市编号为 $\\{1,2,4,5\\}$。\n\n第 $4$ 次计划，起点为 $3$ 号点，终点为 $4$ 号点，临时修建道路为 $5\\rightarrow1$，最终从 $3$ 号点出发无法到达 $4$ 号点。\n\n**【样例 #2】**\n\n见附件 `celebration/celebration2.in` 与 `celebration/celebration2.ans`。\n\n该样例约束与测试点 $5 \\sim 7$ 一致。\n\n**【样例 #3】**\n\n见附件 `celebration/celebration3.in` 与 `celebration/celebration3.ans`。\n\n该样例约束与测试点 $10 \\sim 11$ 一致。\n\n**【样例 #4】**\n\n见附件 `celebration/celebration4.in` 与 `celebration/celebration4.ans`。\n\n该样例约束与测试点 $15 \\sim 16$ 一致。\n\n**【样例 #5】**\n\n见附件 `celebration/celebration5.in` 与 `celebration/celebration5.ans`。\n\n该样例约束与测试点 $20 \\sim 25$ 一致。\n\n**【数据范围】**\n\n对于所有测试点，$1 \\le n,q \\le 3 \\times {10}^5$，$n - 1 \\le m \\le 6 \\times {10}^5$，$0 \\le k \\le 2$。\n\n| 测试点编号 | $n, q \\le$ | $k$ | 特殊性质 |\n|:-:|:-:|:-:|:-:|\n| $1 \\sim 4$ | $5$ | $= 0$ | 无 |\n| $5 \\sim 7$ | $1000$ | $\\le 2$ | 无 |\n| $8 \\sim 9$ | $3 \\times {10}^5$ | $= 0$ | $m = n - 1$ |\n| $10 \\sim 11$ | $3 \\times {10}^5$ | $= 1$ | $m = n - 1$ |\n| $12 \\sim 14$ | $3 \\times {10}^5$ | $= 2$ | $m = n - 1$ |\n| $15 \\sim 16$ | $3 \\times {10}^5$ | $= 0$ | 无 |\n| $17 \\sim 19$ | $3 \\times {10}^5$ | $= 1$ | 无 |\n| $20 \\sim 25$ | $3 \\times {10}^5$ | $= 2$ | 无 |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI2021] 庆典", "background": "", "description": "C 国是一个繁荣昌盛的国家，它由 $n$ 座城市和 $m$ 条有向道路组成，城市从 $1$ 到 $n$ 编号。如果从 $x$ 号城市出发，经过若干条道路后能到达 $y$ 号城市，那么我们称 $x$ 号城市可到达 $y$ 号城市，记作 $x\\Rightarrow y$。C 国的道路有一个特点：对于三座城市 $x$，$y$，$z$，若 $x\\Rightarrow z$ 且 $y\\Rightarrow z$，那么有 $x\\Rightarrow y$ 或 $y\\Rightarrow x$。\n\n再过一个月就是 C 国成立的千年纪念日，所以 C 国的人民正在筹备盛大的游行庆典。目前 C 国得知接下来会有 $q$ 次游行计划，第 $i$ 次游行希望从城市 $s_i$ 出发，经过若干个城市后，在城市 $t_i$ 结束，且在游行过程中，**一个城市可以被经过多次**。为了增加游行的乐趣，每次游行还会**临时**修建出 $k$（$0 \\le k \\le 2$）条有向道路专门供本次游行使用，即其它游行计划不能通过本次游行修建的道路。\n\n现在 C 国想知道，每次游行计划可能会**经过多少座城市**。\n\n注意：临时修建出的道路**可以不满足 C 国道路原有的特点**。", "inputFormat": "第一行包含四个整数 $n,m,q,k$，分别表示城市数、道路数、游行计划数以及每次游行临时修建的道路数。\n\n接下来 $m$ 行，每行包含两个整数 $u,v$，表示一条有向道路 $u\\rightarrow v$。\n\n接下来 $q$ 行，每行前两个整数 $s_i,t_i$，表示每次游行的起点与终点；这行接下来有 $k$ 对整数 $a,b$，每对整数表示一条临时添加的有向道路 $a\\rightarrow b$。\n\n数据保证，将 C 国原有的有向道路视为无向道路后，所有城市可以互达。", "outputFormat": "对于每次询问，输出一行一个整数表示答案。如果一次游行从起点出发无法到达终点，输出 $0$ 即可。", "hint": "**【样例解释 #1】**\n\n第 $1$ 次计划，起点为 $1$ 号点，终点为 $4$ 号点，临时修建道路为 $5\\rightarrow1$，最终可能经过的城市编号为 $\\{1,2,4,5\\}$。\n\n第 $2$ 次计划，起点为 $2$ 号点，终点为 $3$ 号点，临时修建道路为 $5\\rightarrow3$，最终可能经过的城市编号为 $\\{2,3,4,5\\}$。\n\n第 $3$ 次计划，起点为 $1$ 号点，终点为 $2$ 号点，临时修建道路为 $5\\rightarrow2$，最终可能经过的城市编号为 $\\{1,2,4,5\\}$。\n\n第 $4$ 次计划，起点为 $3$ 号点，终点为 $4$ 号点，临时修建道路为 $5\\rightarrow1$，最终从 $3$ 号点出发无法到达 $4$ 号点。\n\n**【样例 #2】**\n\n见附件 `celebration/celebration2.in` 与 `celebration/celebration2.ans`。\n\n该样例约束与测试点 $5 \\sim 7$ 一致。\n\n**【样例 #3】**\n\n见附件 `celebration/celebration3.in` 与 `celebration/celebration3.ans`。\n\n该样例约束与测试点 $10 \\sim 11$ 一致。\n\n**【样例 #4】**\n\n见附件 `celebration/celebration4.in` 与 `celebration/celebration4.ans`。\n\n该样例约束与测试点 $15 \\sim 16$ 一致。\n\n**【样例 #5】**\n\n见附件 `celebration/celebration5.in` 与 `celebration/celebration5.ans`。\n\n该样例约束与测试点 $20 \\sim 25$ 一致。\n\n**【数据范围】**\n\n对于所有测试点，$1 \\le n,q \\le 3 \\times {10}^5$，$n - 1 \\le m \\le 6 \\times {10}^5$，$0 \\le k \\le 2$。\n\n| 测试点编号 | $n, q \\le$ | $k$ | 特殊性质 |\n|:-:|:-:|:-:|:-:|\n| $1 \\sim 4$ | $5$ | $= 0$ | 无 |\n| $5 \\sim 7$ | $1000$ | $\\le 2$ | 无 |\n| $8 \\sim 9$ | $3 \\times {10}^5$ | $= 0$ | $m = n - 1$ |\n| $10 \\sim 11$ | $3 \\times {10}^5$ | $= 1$ | $m = n - 1$ |\n| $12 \\sim 14$ | $3 \\times {10}^5$ | $= 2$ | $m = n - 1$ |\n| $15 \\sim 16$ | $3 \\times {10}^5$ | $= 0$ | 无 |\n| $17 \\sim 19$ | $3 \\times {10}^5$ | $= 1$ | 无 |\n| $20 \\sim 25$ | $3 \\times {10}^5$ | $= 2$ | 无 |", "locale": "zh-CN"}}}
{"pid": "P7738", "type": "P", "difficulty": 6, "samples": [["见附件中的 qi/qi1.in", "见附件中的 qi/qi1.ans"], ["见附件中的 qi/qi2.in", "见附件中的 qi/qi2.ans"], ["见附件中的 qi/qi3.in", "见附件中的 qi/qi3.ans"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216, 393216]}, "tags": ["2021", "NOI", "O2优化", "鸽笼原理", "位运算", "bitset"], "title": "[NOI2021] 量子通信", "background": "由于评测性能差异，本题时限 +0.5s。", "description": "小 Z 正在自学量子计算机相关知识，最近他在研究量子通信章节，并遇到了一个有趣的问题。在该问题中，Alice 和 Bob 正在进行量子通信，它们的通信语言是一个大小为 $n$ 的字典 $S$，在该字典中，每一个单词 $s_i$（$1 \\le i \\le n$）都可以用一个 $\\boldsymbol{256}$ **位的** $\\boldsymbol{01}$ **串**来表示。在本题中 $s_i$ 可以通过调用函数 `gen` 来生成，选手可以在题目目录下的 `gen.cpp` 中查看，该函数的参数 `n`、`a1`、`a2` 将由输入数据给出。\n\nAlice 和 Bob 接下来要进行 $m$ 次通信，每次通信由 Alice 向 Bob 传输**恰好一个**字典中的单词。然而，两人使用的通信信道并不可靠，会受到噪音的干扰。更具体地，对于第 $i$ 次传输，记 Alice 传输的原单词为 $x_i$，该 $01$ 串会受噪音干扰而**翻转最多** $\\boldsymbol{k_i}$ **位**。换句话说，记 Bob 这次收到的 $01$ 串为 $y_i$，它与 $x_i$ 相比，可能有最多 $k_i$ 位是不同的，并且 $y_i$ 可能不在字典 $S$ 中出现。\n\n与此同时，Bob 得知坏人 Eve 也潜入了两人的通信信道，并准备干扰两人的通信。他的干扰方式是将 Bob 收到的 $01$ 串变为任意的 $256$ 位 $01$ 串，并且这个串可能不在字典 $S$ 中出现。Eve 非常狡猾，他**不一定**会对每次通信都进行干扰。\n\n现在 Bob 找来了你帮忙，对于接下来的每次通信，你需要根据 Bob 最终收到的 $01$ 串以及这次通信的噪音干扰阈值 $k_i$（$0 \\le k_i \\le 15$），判断这次通信是否有可能没有受到 Eve 的干扰（即 Bob 收到的 $01$ 串可以由字典中的某个单词翻转至多 $k_i$ 位后得到）。本次通信如果有可能没受到 Eve 干扰，请你输出 $1$，否则输出 $0$。Bob 很信任你的能力，所以你需要**在线地回答结果，具体要求见输入格式**。\n\n为了降低读入用时， Bob 收到的串将用**长度为** $\\boldsymbol{64}$ **的** $\\boldsymbol{16}$ **进制串**给出，$16$ 进制串中包含数字字符 $\\texttt{0} \\sim \\texttt{9}$ 与大写英文字母 $\\texttt{A} \\sim \\texttt{F}$，其中字符 $\\texttt{A} \\sim \\texttt{F}$ 依次表示数值 $10 \\sim 15$。\n\n$16$ 进制串可以逐位转化为 $01$ 串，例如：`5` 对应 `0101`，`A` 对应 `1010`，`C` 对应 `1100`。", "inputFormat": "输入数据第一行包含四个非负整数 $n, m, a_1, a_2$，分别表示字典大小，通信次数，以及 `gen` 函数中参数 `a1` 和 `a2` 的初始值。\n\n选手需要在自己的程序中调用题目描述中提到的 `gen` 函数生成单词表，选手可以复制并使用 `gen.cpp` 中的代码，程序中的布尔数组 `s[N+1][256]` 即为所有的单词。\n\n接下来 $m$ 行，每行包含一个长度为 $64$ 的 $16$ 进制串和一个非负整数 $k_i$，分别表示第 $i$ 次通信 Bob 最终收到的 $01$ 串和噪音干扰阈值。\n\n为了强制选手**在线地回答询问**，选手根据 $16$ 进制串还原出 $256$ 位 $01$ 串后，将 $01$ 串每一位异或上 ${\\mathit{lastans}}$ 才能得到这次通信中 Bob 收到的真实 $01$ 串，其中 ${\\mathit{lastans}} \\in \\{ 0, 1 \\}$ 表示上一次询问的答案，第一个询问前 ${\\mathit{lastans}}$ 初始值为 0。\n\n注意：使用 `scanf` 和 `printf` 函数读入或输出 `unsigned long long` 类型变量时，对应的占位符为 `llu`。", "outputFormat": "输出共 $m$ 行，每行一个整数 $0$ 或 $1$ 表示当前询问的答案。", "hint": "**【询问举例】**\n\n为了方便解释题意，我们使用了直接给出字典中单词、缩小单词长度为 $4$、允许离线地回答询问等方式，对简化的情况举例。\n\n考虑字典大小为 $n = 2$，单词有 `1010` 和 `0111`。\n\n对于询问 `B = 1011` 和 $k_1 = 1$，回答应该是 $1$，通过翻转 `1010` 的第 $4$ 位（从高位到低位，下同）得到。\n\n对于询问 `1 = 0001` 和 $k_2 = 2$，回答应该是 $1$，通过翻转 `0111` 的第 $2$、$3$ 位得到。\n\n对于询问 `1 = 0001` 和 $k_3 = 1$，回答应该是 $0$。\n\n- 翻转 `1010` 至多 $1$ 位可得 `1010`、`0010`、`1110`、`1000`、`1011`。\n- 翻转 `0111` 至多 $1$ 位可得 `0111`、`1111`、`0011`、`0101`、`0110`。\n- 无法得到 `1 = 0001`，它必定是由 Eve 干扰得到的。\n\n**【数据范围】**\n\n对于所有测试点：$1 \\le n \\le 4 \\times {10}^5$，$1 \\le m \\le 1.2 \\times {10}^5$，$0 \\le k_i \\le 15$，$a_1$ 和 $a_2$ 在 $[0, 2^{64} - 1]$ 之间均匀随机生成。\n\n| 测试点编号 | $n =$ | $m =$ | $k_i \\le$ | 特殊性质 |\n|:-:|:-:|:-:|:-:|:-:|\n| $1$ | $10$ | $10$ | $2$ | 无 |\n| $2$ | $500$ | $500$ | $15$ | 无 |\n| $3$ | $1000$ | $1000$ | $0$ | 无 |\n| $4$ | $2000$ | $2000$ | $2$ | 无 |\n| $5$ | $5000$ | $5000$ | $15$ | 无 |\n| $6$ | $10^4$ | $10^4$ | $15$ | 无 |\n| $7$ | $2\\times 10^4$ | $2\\times 10^4$ | $15$ | 无 |\n| $8$ | $10^5$ | $10^5$ | $1$ | 无 |\n| $9$ | $4\\times 10^5$ | $1.2\\times 10^5$ | $1$ | 无 |\n| $10$ | $5\\times 10^4$ | $5\\times 10^4$ | $2$ | 无 |\n| $11$ | $7\\times 10^4$ | $7\\times 10^4$ | $3$ | 无 |\n| $12$ | $10^5$ | $10^5$ | $2$ | 无 |\n| $13$ | $3\\times 10^4$ | $3\\times 10^4$ | $5$ | 无 |\n| $14$ | $6\\times 10^4$ | $6\\times 10^4$ | $4$ | 无 |\n| $15$ | $1.2\\times 10^5$ | $1.2\\times 10^5$ | $5$ | 无 |\n| $16$ | $6\\times 10^4$ | $6\\times 10^4$ | $8$ | 所有询问串随机生成 |\n| $17$ | $1.2\\times 10^5$ | $1.2\\times 10^5$ | $12$ | 所有询问串随机生成 |\n| $18$ | $4\\times 10^5$ | $10^5$ | $15$ | 所有询问串随机生成 |\n| $19$ | $3\\times 10^4$ | $3\\times 10^4$ | $7$ | 无 |\n| $20$ | $6\\times 10^4$ | $6\\times 10^4$ | $9$ | 无 |\n| $21$ | $9\\times 10^4$ | $9\\times 10^4$ | $11$ | 无 |\n| $22$ | $2\\times 10^5$ | $1.2\\times 10^5$ | $12$ | 无 |\n| $23$ | $4\\times 10^5$ | $8\\times 10^4$ | $15$ | 无 |\n| $24$ | $4\\times 10^5$ | $10^5$ | $15$ | 无 |\n| $25$ | $4\\times 10^5$ | $1.2\\times 10^5$ | $15$ | 无 |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI2021] 量子通信", "background": "由于评测性能差异，本题时限 +0.5s。", "description": "小 Z 正在自学量子计算机相关知识，最近他在研究量子通信章节，并遇到了一个有趣的问题。在该问题中，Alice 和 Bob 正在进行量子通信，它们的通信语言是一个大小为 $n$ 的字典 $S$，在该字典中，每一个单词 $s_i$（$1 \\le i \\le n$）都可以用一个 $\\boldsymbol{256}$ **位的** $\\boldsymbol{01}$ **串**来表示。在本题中 $s_i$ 可以通过调用函数 `gen` 来生成，选手可以在题目目录下的 `gen.cpp` 中查看，该函数的参数 `n`、`a1`、`a2` 将由输入数据给出。\n\nAlice 和 Bob 接下来要进行 $m$ 次通信，每次通信由 Alice 向 Bob 传输**恰好一个**字典中的单词。然而，两人使用的通信信道并不可靠，会受到噪音的干扰。更具体地，对于第 $i$ 次传输，记 Alice 传输的原单词为 $x_i$，该 $01$ 串会受噪音干扰而**翻转最多** $\\boldsymbol{k_i}$ **位**。换句话说，记 Bob 这次收到的 $01$ 串为 $y_i$，它与 $x_i$ 相比，可能有最多 $k_i$ 位是不同的，并且 $y_i$ 可能不在字典 $S$ 中出现。\n\n与此同时，Bob 得知坏人 Eve 也潜入了两人的通信信道，并准备干扰两人的通信。他的干扰方式是将 Bob 收到的 $01$ 串变为任意的 $256$ 位 $01$ 串，并且这个串可能不在字典 $S$ 中出现。Eve 非常狡猾，他**不一定**会对每次通信都进行干扰。\n\n现在 Bob 找来了你帮忙，对于接下来的每次通信，你需要根据 Bob 最终收到的 $01$ 串以及这次通信的噪音干扰阈值 $k_i$（$0 \\le k_i \\le 15$），判断这次通信是否有可能没有受到 Eve 的干扰（即 Bob 收到的 $01$ 串可以由字典中的某个单词翻转至多 $k_i$ 位后得到）。本次通信如果有可能没受到 Eve 干扰，请你输出 $1$，否则输出 $0$。Bob 很信任你的能力，所以你需要**在线地回答结果，具体要求见输入格式**。\n\n为了降低读入用时， Bob 收到的串将用**长度为** $\\boldsymbol{64}$ **的** $\\boldsymbol{16}$ **进制串**给出，$16$ 进制串中包含数字字符 $\\texttt{0} \\sim \\texttt{9}$ 与大写英文字母 $\\texttt{A} \\sim \\texttt{F}$，其中字符 $\\texttt{A} \\sim \\texttt{F}$ 依次表示数值 $10 \\sim 15$。\n\n$16$ 进制串可以逐位转化为 $01$ 串，例如：`5` 对应 `0101`，`A` 对应 `1010`，`C` 对应 `1100`。", "inputFormat": "输入数据第一行包含四个非负整数 $n, m, a_1, a_2$，分别表示字典大小，通信次数，以及 `gen` 函数中参数 `a1` 和 `a2` 的初始值。\n\n选手需要在自己的程序中调用题目描述中提到的 `gen` 函数生成单词表，选手可以复制并使用 `gen.cpp` 中的代码，程序中的布尔数组 `s[N+1][256]` 即为所有的单词。\n\n接下来 $m$ 行，每行包含一个长度为 $64$ 的 $16$ 进制串和一个非负整数 $k_i$，分别表示第 $i$ 次通信 Bob 最终收到的 $01$ 串和噪音干扰阈值。\n\n为了强制选手**在线地回答询问**，选手根据 $16$ 进制串还原出 $256$ 位 $01$ 串后，将 $01$ 串每一位异或上 ${\\mathit{lastans}}$ 才能得到这次通信中 Bob 收到的真实 $01$ 串，其中 ${\\mathit{lastans}} \\in \\{ 0, 1 \\}$ 表示上一次询问的答案，第一个询问前 ${\\mathit{lastans}}$ 初始值为 0。\n\n注意：使用 `scanf` 和 `printf` 函数读入或输出 `unsigned long long` 类型变量时，对应的占位符为 `llu`。", "outputFormat": "输出共 $m$ 行，每行一个整数 $0$ 或 $1$ 表示当前询问的答案。", "hint": "**【询问举例】**\n\n为了方便解释题意，我们使用了直接给出字典中单词、缩小单词长度为 $4$、允许离线地回答询问等方式，对简化的情况举例。\n\n考虑字典大小为 $n = 2$，单词有 `1010` 和 `0111`。\n\n对于询问 `B = 1011` 和 $k_1 = 1$，回答应该是 $1$，通过翻转 `1010` 的第 $4$ 位（从高位到低位，下同）得到。\n\n对于询问 `1 = 0001` 和 $k_2 = 2$，回答应该是 $1$，通过翻转 `0111` 的第 $2$、$3$ 位得到。\n\n对于询问 `1 = 0001` 和 $k_3 = 1$，回答应该是 $0$。\n\n- 翻转 `1010` 至多 $1$ 位可得 `1010`、`0010`、`1110`、`1000`、`1011`。\n- 翻转 `0111` 至多 $1$ 位可得 `0111`、`1111`、`0011`、`0101`、`0110`。\n- 无法得到 `1 = 0001`，它必定是由 Eve 干扰得到的。\n\n**【数据范围】**\n\n对于所有测试点：$1 \\le n \\le 4 \\times {10}^5$，$1 \\le m \\le 1.2 \\times {10}^5$，$0 \\le k_i \\le 15$，$a_1$ 和 $a_2$ 在 $[0, 2^{64} - 1]$ 之间均匀随机生成。\n\n| 测试点编号 | $n =$ | $m =$ | $k_i \\le$ | 特殊性质 |\n|:-:|:-:|:-:|:-:|:-:|\n| $1$ | $10$ | $10$ | $2$ | 无 |\n| $2$ | $500$ | $500$ | $15$ | 无 |\n| $3$ | $1000$ | $1000$ | $0$ | 无 |\n| $4$ | $2000$ | $2000$ | $2$ | 无 |\n| $5$ | $5000$ | $5000$ | $15$ | 无 |\n| $6$ | $10^4$ | $10^4$ | $15$ | 无 |\n| $7$ | $2\\times 10^4$ | $2\\times 10^4$ | $15$ | 无 |\n| $8$ | $10^5$ | $10^5$ | $1$ | 无 |\n| $9$ | $4\\times 10^5$ | $1.2\\times 10^5$ | $1$ | 无 |\n| $10$ | $5\\times 10^4$ | $5\\times 10^4$ | $2$ | 无 |\n| $11$ | $7\\times 10^4$ | $7\\times 10^4$ | $3$ | 无 |\n| $12$ | $10^5$ | $10^5$ | $2$ | 无 |\n| $13$ | $3\\times 10^4$ | $3\\times 10^4$ | $5$ | 无 |\n| $14$ | $6\\times 10^4$ | $6\\times 10^4$ | $4$ | 无 |\n| $15$ | $1.2\\times 10^5$ | $1.2\\times 10^5$ | $5$ | 无 |\n| $16$ | $6\\times 10^4$ | $6\\times 10^4$ | $8$ | 所有询问串随机生成 |\n| $17$ | $1.2\\times 10^5$ | $1.2\\times 10^5$ | $12$ | 所有询问串随机生成 |\n| $18$ | $4\\times 10^5$ | $10^5$ | $15$ | 所有询问串随机生成 |\n| $19$ | $3\\times 10^4$ | $3\\times 10^4$ | $7$ | 无 |\n| $20$ | $6\\times 10^4$ | $6\\times 10^4$ | $9$ | 无 |\n| $21$ | $9\\times 10^4$ | $9\\times 10^4$ | $11$ | 无 |\n| $22$ | $2\\times 10^5$ | $1.2\\times 10^5$ | $12$ | 无 |\n| $23$ | $4\\times 10^5$ | $8\\times 10^4$ | $15$ | 无 |\n| $24$ | $4\\times 10^5$ | $10^5$ | $15$ | 无 |\n| $25$ | $4\\times 10^5$ | $1.2\\times 10^5$ | $15$ | 无 |", "locale": "zh-CN"}}}
{"pid": "P7739", "type": "P", "difficulty": 7, "samples": [["2 3\nWE\nAPPEND E\nFLIP 1 2\nREVERSE 2 3\n", "2 3\n3 4\n5 3\n5 2\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["平衡树", "2021", "NOI", "O2优化", "矩阵乘法"], "title": "[NOI2021] 密码箱", "background": "", "description": "Yelekastee 是 U 国著名的考古学家。在最近的一次考古行动中，他发掘出了一个远古时期的密码箱。经过周密而严谨的考证，Yelekastee 得知密码箱的密码和某一个数列 $\\{ a_n \\}$ 相关。数列 $\\{ a_n \\}$ 可以用如下方式构造出来：\n\n1. 初始时数列长度为 $2$ 且有 $a_0 = 0, a_1 = 1$；\n2. 对数列依次进行若干次操作，其中每次操作是以下两种类型之一：\n  - `W` 类型：给数列的**最后一项**加 $1$。\n  - `E` 类型：若数列的**最后一项**为 $1$，则给倒数第二项加 $1$；否则先给数列的**最后一项**减 $1$，接着在数列尾再加两项，两项的值都是 $1$。\n\n受到技术限制，密码箱并没有办法完整检查整个数列，因此密码箱的密码设定为数列 $\\{ a_n \\}$ 经过函数 $f$ 作用后的值，其中 $f$ 的定义如下：\n\n$$ f(a_0, \\ldots , a_{k - 1}, a_k) = \\begin{cases} a_0, & k = 0 \\\\ f \\! \\left( a_0, a_1, \\ldots , a_{k - 2}, a_{k - 1} + \\frac{1}{a_k} \\right) \\! , & k \\ge 1 \\end{cases} $$\n\nYelekastee 并不擅长运算，因此他找到了你，希望你能根据他提供的操作序列计算出密码箱的密码。不幸的是，他的记性并不是很好，因此他会随时对提供的操作序列做出一些修改，这些修改包括以下三种：\n\n- `APPEND c`，在现有操作序列后追加一次 `c` 类型操作，其中 `c` 为字符 `W` 或 `E`。\n- `FLIP l r`，反转现有操作序列中第 $l$ 个至第 $r$ 个（下标从 $1$ 开始，修改包含端点 $l$ 和 $r$，下同）操作，即所有 `W` 变为 `E`，所有 `E` 变为 `W`。\n- `REVERSE l r`，翻转现有操作序列中第 $l$ 个至第 $r$ 个操作，也就是将这个区间中的操作逆序。", "inputFormat": "输入第一行包含两个正整数 $n, q$，分别表示初始的操作序列长度和修改的次数。\n\n第二行包含一个长为 $n$ 且仅包含大写字母 `W` 和 `E` 的字符串，表示初始操作序列。\n\n接下来 $q$ 行，每行表示一次修改。每种修改的格式如【题目描述】所述。", "outputFormat": "输出共 $q + 1$ 行，每行两个整数，其中第一行表示初始操作序列对应的密码，接下来 $q$ 行则分别输出每次修改之后的操作序列对应的密码。\n\n容易发现密码一定是正有理数。若真实的密码为 $\\frac{a}{b}$，其中 $a, b > 0$ 且 $\\gcd(a, b) = 1$，则你需要在对应的行内顺次输出 $a$ 和 $b$ 模 $998244353$ 后的余数。", "hint": "**【样例解释 #1】**\n\n| | 操作序列 | 数列 $\\{ a_n \\}$ | 密码 |\n|:-:|:-:|:-:|:-:|\n| 初始 | `WE` | $(0, 1, 1, 1)$ | $\\frac{2}{3}$ |\n| 第一次修改后 | `WEE` | $(0, 1, 2, 1)$ | $\\frac{3}{4}$ |\n| 第二次修改后 | `EWE` | $(1, 1, 1, 1)$ | $\\frac{5}{3}$ |\n| 第三次修改后 | `EEW` | $(2, 2)$ | $\\frac{5}{2}$ |\n\n**【样例 #2】**\n\n见附件 `code/code2.in` 与 `code/code2.ans`。\n\n该样例与测试数据 $1 \\sim 4$ 满足同样的约束条件。\n\n**【样例 #3】**\n\n见附件 `code/code3.in` 与 `code/code3.ans`。\n\n该样例与测试数据 $5 \\sim 7$ 满足同样的约束条件。\n\n**【样例 #4】**\n\n见附件 `code/code4.in` 与 `code/code4.ans`。\n\n该样例与测试数据 $8 \\sim 10$ 满足同样的约束条件。\n\n**【样例 #5】**\n\n见附件 `code/code5.in` 与 `code/code5.ans`。\n\n该样例与测试数据 $15 \\sim 20$ 满足同样的约束条件。\n\n**【数据范围】**\n\n对于所有测试点：$1 \\le n \\le {10}^5$，$1 \\le q \\le {10}^5$。\n\n对于 `APPEND` 修改，保证给出的 `c` 为大写英文字母 `W` 或 `E`。\n\n对于 `FLIP` 和 `REVERSE` 修改，保证 $1 \\le l \\le r \\le L$，其中 $L$ 是当前操作序列的长度。\n\n请注意由于有 `APPEND` 操作，操作序列的长度最大可能有 $2 \\times {10}^5$。\n\n| 测试点编号 | $n, q \\le$ | 特殊限制 |\n|:-:|:-:|:-:|\n| $1 \\sim 4$ | $2000$ | 无 |\n| $5 \\sim 7$ | ${10}^5$ | A |\n| $8 \\sim 10$ | ${10}^5$ | B，C |\n| $11 \\sim 14$ | ${10}^5$ | C |\n| $15 \\sim 20$ | ${10}^5$ | 无 |\n\n特殊限制 A：保证在任意时刻操作序列中不会出现连续相同的两个字符。\n\n特殊限制 B：保证没有 `FLIP` 修改。\n\n特殊限制 C：保证没有 `REVERSE` 修改。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI2021] 密码箱", "background": "", "description": "Yelekastee 是 U 国著名的考古学家。在最近的一次考古行动中，他发掘出了一个远古时期的密码箱。经过周密而严谨的考证，Yelekastee 得知密码箱的密码和某一个数列 $\\{ a_n \\}$ 相关。数列 $\\{ a_n \\}$ 可以用如下方式构造出来：\n\n1. 初始时数列长度为 $2$ 且有 $a_0 = 0, a_1 = 1$；\n2. 对数列依次进行若干次操作，其中每次操作是以下两种类型之一：\n  - `W` 类型：给数列的**最后一项**加 $1$。\n  - `E` 类型：若数列的**最后一项**为 $1$，则给倒数第二项加 $1$；否则先给数列的**最后一项**减 $1$，接着在数列尾再加两项，两项的值都是 $1$。\n\n受到技术限制，密码箱并没有办法完整检查整个数列，因此密码箱的密码设定为数列 $\\{ a_n \\}$ 经过函数 $f$ 作用后的值，其中 $f$ 的定义如下：\n\n$$ f(a_0, \\ldots , a_{k - 1}, a_k) = \\begin{cases} a_0, & k = 0 \\\\ f \\! \\left( a_0, a_1, \\ldots , a_{k - 2}, a_{k - 1} + \\frac{1}{a_k} \\right) \\! , & k \\ge 1 \\end{cases} $$\n\nYelekastee 并不擅长运算，因此他找到了你，希望你能根据他提供的操作序列计算出密码箱的密码。不幸的是，他的记性并不是很好，因此他会随时对提供的操作序列做出一些修改，这些修改包括以下三种：\n\n- `APPEND c`，在现有操作序列后追加一次 `c` 类型操作，其中 `c` 为字符 `W` 或 `E`。\n- `FLIP l r`，反转现有操作序列中第 $l$ 个至第 $r$ 个（下标从 $1$ 开始，修改包含端点 $l$ 和 $r$，下同）操作，即所有 `W` 变为 `E`，所有 `E` 变为 `W`。\n- `REVERSE l r`，翻转现有操作序列中第 $l$ 个至第 $r$ 个操作，也就是将这个区间中的操作逆序。", "inputFormat": "输入第一行包含两个正整数 $n, q$，分别表示初始的操作序列长度和修改的次数。\n\n第二行包含一个长为 $n$ 且仅包含大写字母 `W` 和 `E` 的字符串，表示初始操作序列。\n\n接下来 $q$ 行，每行表示一次修改。每种修改的格式如【题目描述】所述。", "outputFormat": "输出共 $q + 1$ 行，每行两个整数，其中第一行表示初始操作序列对应的密码，接下来 $q$ 行则分别输出每次修改之后的操作序列对应的密码。\n\n容易发现密码一定是正有理数。若真实的密码为 $\\frac{a}{b}$，其中 $a, b > 0$ 且 $\\gcd(a, b) = 1$，则你需要在对应的行内顺次输出 $a$ 和 $b$ 模 $998244353$ 后的余数。", "hint": "**【样例解释 #1】**\n\n| | 操作序列 | 数列 $\\{ a_n \\}$ | 密码 |\n|:-:|:-:|:-:|:-:|\n| 初始 | `WE` | $(0, 1, 1, 1)$ | $\\frac{2}{3}$ |\n| 第一次修改后 | `WEE` | $(0, 1, 2, 1)$ | $\\frac{3}{4}$ |\n| 第二次修改后 | `EWE` | $(1, 1, 1, 1)$ | $\\frac{5}{3}$ |\n| 第三次修改后 | `EEW` | $(2, 2)$ | $\\frac{5}{2}$ |\n\n**【样例 #2】**\n\n见附件 `code/code2.in` 与 `code/code2.ans`。\n\n该样例与测试数据 $1 \\sim 4$ 满足同样的约束条件。\n\n**【样例 #3】**\n\n见附件 `code/code3.in` 与 `code/code3.ans`。\n\n该样例与测试数据 $5 \\sim 7$ 满足同样的约束条件。\n\n**【样例 #4】**\n\n见附件 `code/code4.in` 与 `code/code4.ans`。\n\n该样例与测试数据 $8 \\sim 10$ 满足同样的约束条件。\n\n**【样例 #5】**\n\n见附件 `code/code5.in` 与 `code/code5.ans`。\n\n该样例与测试数据 $15 \\sim 20$ 满足同样的约束条件。\n\n**【数据范围】**\n\n对于所有测试点：$1 \\le n \\le {10}^5$，$1 \\le q \\le {10}^5$。\n\n对于 `APPEND` 修改，保证给出的 `c` 为大写英文字母 `W` 或 `E`。\n\n对于 `FLIP` 和 `REVERSE` 修改，保证 $1 \\le l \\le r \\le L$，其中 $L$ 是当前操作序列的长度。\n\n请注意由于有 `APPEND` 操作，操作序列的长度最大可能有 $2 \\times {10}^5$。\n\n| 测试点编号 | $n, q \\le$ | 特殊限制 |\n|:-:|:-:|:-:|\n| $1 \\sim 4$ | $2000$ | 无 |\n| $5 \\sim 7$ | ${10}^5$ | A |\n| $8 \\sim 10$ | ${10}^5$ | B，C |\n| $11 \\sim 14$ | ${10}^5$ | C |\n| $15 \\sim 20$ | ${10}^5$ | 无 |\n\n特殊限制 A：保证在任意时刻操作序列中不会出现连续相同的两个字符。\n\n特殊限制 B：保证没有 `FLIP` 修改。\n\n特殊限制 C：保证没有 `REVERSE` 修改。", "locale": "zh-CN"}}}
{"pid": "P7740", "type": "P", "difficulty": 7, "samples": [["2 1\n1R*\n", "9\n"], ["3 2\n1R0\n*\n", "1468\n"], ["见附件中的 robot/robot3.in", "见附件中的 robot/robot3.ans"], ["见附件中的 robot/robot4.in", "见附件中的 robot/robot4.ans"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2021", "NOI", "O2优化"], "title": "[NOI2021] 机器人游戏", "background": "", "description": "小 R 有 $m$（$1 \\le m \\le 1000$）个机器人和 $m$ 张纸带，第 $i$（$1 \\le i \\le m$）个机器人负责对第 $i$ 张纸带进行操作。对于每张纸带，它们都被从左到右分成了 $n$（$1 \\le n \\le 32$）个格子，依次编号为 $0, 1, \\ldots , n - 1$。每个格子有 $3$ 种状态：1. 格子上写有数字 $0$；2. 格子上写有数字 $1$；3. 格子是一个空格子。\n\n在任意时刻，机器人**必须**站在纸带上的一个格子中。在设定好机器人在纸带上的初始位置后，第 $i$ 个机器人会依次执行预先设定的操作序列 $S_i$，操作由 `R`、`0`、`1`、`*` 四种字符组成，其中：\n\n1. `R` 表示机器人向右走一格，如果右边没有格子，则机器人会原地爆炸；\n2. `0` 表示如果机器人所在格子非空，则将该格子上的数字改为 $0$，否则不修改；\n3. `1` 表示如果机器人所在格子非空，则将该格子上的数字改为 $1$，否则不修改；\n4. `*` 表示如果机器人所在格子非空，则将格子上的数字 $x$ 改为 $1 - x$，否则不修改。\n\n第 $i$ 张纸带的状态可以用一个长度为 $n$ 的序列表示，每个元素为 `0`、`1` 或 `-`（空格子），依次表示其每个格子的状态。第 $i$ 张纸带的初始状态称为机器人 $i$ 的输入 $X_i$，操作执行完成后纸带的状态称为机器人 $i$ 的输出 $Y_i$。注意，如果机器人爆炸了，那么这个机器人就没有输出。\n\n可以发现，如果一个格子为空，那么机器人永远不会修改它。所以每个机器人都有如下特性：如果第 $i$ 个机器人所在的纸带上的**所有格子**都为空，那么它就不会执行任何操作，它的输出即为所有格子都为空。\n\n现在小 R 给定了每一个机器人的输入 $X_i$（即每张纸带的初始状态）以及目标输出 $Y_i$。小 R 希望小 D 找到一个位置 $p$（$0 \\le p < n$），使得**所有机器人**都能以其所在纸带的第 $p$ 个格子为初始位置，在不爆炸的情况下执行完所有操作，并且满足第 $i$ 个机器人的输出为 $Y_i$。\n\n小 D 花了几毫秒解决了问题，现在他想知道，有多少个输入和输出的组合方式使得上述问题有解，即有多少种为每个机器人设定输入 $X_0, X_1, \\ldots , X_{m - 1}$ 和目标输出 $Y_0, Y_1, \\ldots , Y_{m - 1}$ 的方式，使得至少存在一个位置 $p$（$0 \\le p < n$），使得所有机器人都能以其所在纸带的第 $p$ 个格子为起点，在不爆炸的情况下执行完所有操作，且满足第 $i$ 个机器人的输出为 $Y_i$。请你帮助小 D 解决这个问题，由于最终的答案可能很大，请你输出答案对 ${10}^9 + 7$ 取模后的余数。\n\n两个组合方式不同当且仅当，存在至少一个机器人，它的输入或是目标输出在两个方式中不同。", "inputFormat": "第一行包含两个正整数 $n, m$，分别表示每张纸带上的格子数和纸带数量。\n\n接下来 $m$ 行，第 $i$ 行输入一个仅包含 `R` `0` `1` `*` 这四种字符的字符串 $S_i$，表示第 $i$ 个机器人的操作序列。", "outputFormat": "仅一行一个正整数，表示答案模 ${10}^9 + 7$ 后的余数。", "hint": "**【样例解释 #1】**\n\n| 方案编号 | 输入 $X_0$ | 目标输出 $Y_0$ | 可行初始位置 $p$ |\n|:-:|:-:|:-:|:-:|\n| $1$ | `--` | `--` | $0, 1$ |\n| $2$ | `0-` | `1-` | $0$ |\n| $3$ | `1-` | `1-` | $0$ |\n| $4$ | `-0` | `-1` | $0$ |\n| $5$ | `-1` | `-0` | $0$ |\n| $6$ | `00` | `11` | $0$ |\n| $7$ | `10` | `11` | $0$ |\n| $8$ | `01` | `10` | $0$ |\n| $9$ | `11` | `10` | $0$ |\n\n表中 `-` 表示空格子，注意方案 $1$ 中的输入和输出中有两个空格子。\n\n当输入全为空时，初始位置可以是 $0$ 或 $1$，因为根据题意，输入全为空时机器人不会执行任何操作。\n\n当输入不全为空时，初始位置只能为 $0$，如果初始位置为 $1$ 机器人一定会爆炸。所以此时实际执行的操作是将第一格的数字改为 $1$，并将第二格的数字 $x$ 改为 $1 - x$。\n\n**【样例解释 #2】**\n\n可以用容斥原理来计算这个样例。\n\n1. 初始位置 $p = 0$ 可以使得执行完所有操作后满足条件。那么第一个机器人的纸带 $0$ 号格子要么输入输出都是空，要么目标输出是 $1$（输入无所谓），所以有 $3$ 种方案；$1$ 号格子要么输入输出都是空，要么目标输出是 $0$，也是 $3$ 种方案；$2$ 号格子要么输入输出都是空，要么输入和目标输出相同（因为没有对该格子执行任何操作），同样是 $3$ 种方案，共 $27$ 种方案。第二个机器人的 $0$ 号格子要么输入输出都是空，要么输入和目标输出不同，是 $3$ 种方案，$1$ 号和 $2$ 号格子也都是 $3$ 种方案，共 $27$ 种方案。所以总共 $27 \\times 27 = 729$ 种方案。\n2. 初始位置 $p = 1$ 可以使得执行完所有操作后满足条件。那么第一个机器人的纸带三个格子都是 $3$ 种方案，其中 $0$ 号格子要么输入输出都为空，要么相同；$1$ 号格子要么输入输出都为空，要么目标输出是 $1$；$2$ 号格子的输入输出要么都为空，要么输出是 $0$，共 $27$ 种方案。第二个机器人的 $1$ 号格子要么输入输出都是空，要么输入和目标输出不同，是 $3$ 种方案；$0$ 号和 $2$ 号格子要么输入输出都为空，要么输入输出相同，也都是 $3$ 种方案，共 $27$ 种方案。总共 $27 \\times 27 = 729$ 种方案。\n3. 初始位置 $p = 2$ 可以使得执行完所有操作后满足条件。那么第一个机器人的纸带必须输入输出全为空（否则爆炸），只有 $1$ 种方案。第二个机器人是 $27$ 种方案，总共 $27$ 种方案。\n4. 初始位置 $p = 0, 1$ 都满足条件。这要求第一个机器人的 $1$ 号格子输入输出都为空；$0$ 号格子的输入输出都为空或都为 $1$；$2$ 号格子的输入输出都为空或都为 $0$，所以第一个机器人的纸带有 $4$ 种方案。第二个机器人 $0$ 号格子和 $1$ 号格子都为空，$2$ 号格子有 $3$ 种方案，第二个机器人的 $0$ 号和 $1$ 号格子必须都为空，$2$ 号格子要么输入输出都为空，要么输入和输出相同，有 $3$ 种方案。总共 $12$ 种方案。\n5. 初始位置 $p = 0, 2$ 都满足条件。那么第一个机器人的纸带必须输入输出全为空（否则爆炸），只有 $1$ 种方案。第二个机器人 $0$ 号和 $2$ 号格子都为空，$1$ 号格子有 $3$ 种方案。总共 $3$ 种方案。\n6. 初始位置 $p = 1, 2$ 都满足条件。那么第一个机器人的纸带必须输入输出全为空，只有 $1$ 种方案。第二个机器人 $1$ 号和 $2$ 号格子都为空，$0$ 号格子有 $3$ 种方案。总共 $3$ 种方案。\n7. 初始位置 $p = 0, 1, 2$ 都满足条件。那么两个机器人的输入输出必须都为空，总共 $1$ 种方案。\n\n根据容斥原理，最后的答案为 $729 + 729 + 27 - 12 - 3 - 3 + 1 = 1468$。\n\n**【数据范围】**\n\n对于所有测试点：$1 \\le n \\le 32$，$1 \\le m \\le 1000$，$1 \\le \\lvert S_i \\rvert \\le 100$。\n\n| 测试点编号 | $n \\le$ | $m \\le$ | 特殊限制 |\n|:-:|:-:|:-:|:-:|\n| $1 \\sim 2$ | $1$ | $1$ | 无 |\n| $3$ | $8$ | $1$ | 无 |\n| $4$ | $16$ | $1$ | 无 |\n| $5 \\sim 6$ | $32$ | $1$ | 无 |\n| $7$ | $16$ | $5$ | 无 |\n| $8 \\sim 10$ | $32$ | $5$ | 无 |\n| $11 \\sim 12$ | $16$ | $1000$ | 无 |\n| $13 \\sim 15$ | $32$ | $1000$ | A |\n| $16 \\sim 21$ | $32$ | $1000$ | B |\n| $22 \\sim 25$ | $32$ | $1000$ | 无 |\n\n特殊限制 A：操作序列中不存在 `R`。\n\n特殊限制 B：每个操作序列中，`R` 的数量至多 $15$ 个。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[NOI2021] 机器人游戏", "background": "", "description": "小 R 有 $m$（$1 \\le m \\le 1000$）个机器人和 $m$ 张纸带，第 $i$（$1 \\le i \\le m$）个机器人负责对第 $i$ 张纸带进行操作。对于每张纸带，它们都被从左到右分成了 $n$（$1 \\le n \\le 32$）个格子，依次编号为 $0, 1, \\ldots , n - 1$。每个格子有 $3$ 种状态：1. 格子上写有数字 $0$；2. 格子上写有数字 $1$；3. 格子是一个空格子。\n\n在任意时刻，机器人**必须**站在纸带上的一个格子中。在设定好机器人在纸带上的初始位置后，第 $i$ 个机器人会依次执行预先设定的操作序列 $S_i$，操作由 `R`、`0`、`1`、`*` 四种字符组成，其中：\n\n1. `R` 表示机器人向右走一格，如果右边没有格子，则机器人会原地爆炸；\n2. `0` 表示如果机器人所在格子非空，则将该格子上的数字改为 $0$，否则不修改；\n3. `1` 表示如果机器人所在格子非空，则将该格子上的数字改为 $1$，否则不修改；\n4. `*` 表示如果机器人所在格子非空，则将格子上的数字 $x$ 改为 $1 - x$，否则不修改。\n\n第 $i$ 张纸带的状态可以用一个长度为 $n$ 的序列表示，每个元素为 `0`、`1` 或 `-`（空格子），依次表示其每个格子的状态。第 $i$ 张纸带的初始状态称为机器人 $i$ 的输入 $X_i$，操作执行完成后纸带的状态称为机器人 $i$ 的输出 $Y_i$。注意，如果机器人爆炸了，那么这个机器人就没有输出。\n\n可以发现，如果一个格子为空，那么机器人永远不会修改它。所以每个机器人都有如下特性：如果第 $i$ 个机器人所在的纸带上的**所有格子**都为空，那么它就不会执行任何操作，它的输出即为所有格子都为空。\n\n现在小 R 给定了每一个机器人的输入 $X_i$（即每张纸带的初始状态）以及目标输出 $Y_i$。小 R 希望小 D 找到一个位置 $p$（$0 \\le p < n$），使得**所有机器人**都能以其所在纸带的第 $p$ 个格子为初始位置，在不爆炸的情况下执行完所有操作，并且满足第 $i$ 个机器人的输出为 $Y_i$。\n\n小 D 花了几毫秒解决了问题，现在他想知道，有多少个输入和输出的组合方式使得上述问题有解，即有多少种为每个机器人设定输入 $X_0, X_1, \\ldots , X_{m - 1}$ 和目标输出 $Y_0, Y_1, \\ldots , Y_{m - 1}$ 的方式，使得至少存在一个位置 $p$（$0 \\le p < n$），使得所有机器人都能以其所在纸带的第 $p$ 个格子为起点，在不爆炸的情况下执行完所有操作，且满足第 $i$ 个机器人的输出为 $Y_i$。请你帮助小 D 解决这个问题，由于最终的答案可能很大，请你输出答案对 ${10}^9 + 7$ 取模后的余数。\n\n两个组合方式不同当且仅当，存在至少一个机器人，它的输入或是目标输出在两个方式中不同。", "inputFormat": "第一行包含两个正整数 $n, m$，分别表示每张纸带上的格子数和纸带数量。\n\n接下来 $m$ 行，第 $i$ 行输入一个仅包含 `R` `0` `1` `*` 这四种字符的字符串 $S_i$，表示第 $i$ 个机器人的操作序列。", "outputFormat": "仅一行一个正整数，表示答案模 ${10}^9 + 7$ 后的余数。", "hint": "**【样例解释 #1】**\n\n| 方案编号 | 输入 $X_0$ | 目标输出 $Y_0$ | 可行初始位置 $p$ |\n|:-:|:-:|:-:|:-:|\n| $1$ | `--` | `--` | $0, 1$ |\n| $2$ | `0-` | `1-` | $0$ |\n| $3$ | `1-` | `1-` | $0$ |\n| $4$ | `-0` | `-1` | $0$ |\n| $5$ | `-1` | `-0` | $0$ |\n| $6$ | `00` | `11` | $0$ |\n| $7$ | `10` | `11` | $0$ |\n| $8$ | `01` | `10` | $0$ |\n| $9$ | `11` | `10` | $0$ |\n\n表中 `-` 表示空格子，注意方案 $1$ 中的输入和输出中有两个空格子。\n\n当输入全为空时，初始位置可以是 $0$ 或 $1$，因为根据题意，输入全为空时机器人不会执行任何操作。\n\n当输入不全为空时，初始位置只能为 $0$，如果初始位置为 $1$ 机器人一定会爆炸。所以此时实际执行的操作是将第一格的数字改为 $1$，并将第二格的数字 $x$ 改为 $1 - x$。\n\n**【样例解释 #2】**\n\n可以用容斥原理来计算这个样例。\n\n1. 初始位置 $p = 0$ 可以使得执行完所有操作后满足条件。那么第一个机器人的纸带 $0$ 号格子要么输入输出都是空，要么目标输出是 $1$（输入无所谓），所以有 $3$ 种方案；$1$ 号格子要么输入输出都是空，要么目标输出是 $0$，也是 $3$ 种方案；$2$ 号格子要么输入输出都是空，要么输入和目标输出相同（因为没有对该格子执行任何操作），同样是 $3$ 种方案，共 $27$ 种方案。第二个机器人的 $0$ 号格子要么输入输出都是空，要么输入和目标输出不同，是 $3$ 种方案，$1$ 号和 $2$ 号格子也都是 $3$ 种方案，共 $27$ 种方案。所以总共 $27 \\times 27 = 729$ 种方案。\n2. 初始位置 $p = 1$ 可以使得执行完所有操作后满足条件。那么第一个机器人的纸带三个格子都是 $3$ 种方案，其中 $0$ 号格子要么输入输出都为空，要么相同；$1$ 号格子要么输入输出都为空，要么目标输出是 $1$；$2$ 号格子的输入输出要么都为空，要么输出是 $0$，共 $27$ 种方案。第二个机器人的 $1$ 号格子要么输入输出都是空，要么输入和目标输出不同，是 $3$ 种方案；$0$ 号和 $2$ 号格子要么输入输出都为空，要么输入输出相同，也都是 $3$ 种方案，共 $27$ 种方案。总共 $27 \\times 27 = 729$ 种方案。\n3. 初始位置 $p = 2$ 可以使得执行完所有操作后满足条件。那么第一个机器人的纸带必须输入输出全为空（否则爆炸），只有 $1$ 种方案。第二个机器人是 $27$ 种方案，总共 $27$ 种方案。\n4. 初始位置 $p = 0, 1$ 都满足条件。这要求第一个机器人的 $1$ 号格子输入输出都为空；$0$ 号格子的输入输出都为空或都为 $1$；$2$ 号格子的输入输出都为空或都为 $0$，所以第一个机器人的纸带有 $4$ 种方案。第二个机器人 $0$ 号格子和 $1$ 号格子都为空，$2$ 号格子有 $3$ 种方案，第二个机器人的 $0$ 号和 $1$ 号格子必须都为空，$2$ 号格子要么输入输出都为空，要么输入和输出相同，有 $3$ 种方案。总共 $12$ 种方案。\n5. 初始位置 $p = 0, 2$ 都满足条件。那么第一个机器人的纸带必须输入输出全为空（否则爆炸），只有 $1$ 种方案。第二个机器人 $0$ 号和 $2$ 号格子都为空，$1$ 号格子有 $3$ 种方案。总共 $3$ 种方案。\n6. 初始位置 $p = 1, 2$ 都满足条件。那么第一个机器人的纸带必须输入输出全为空，只有 $1$ 种方案。第二个机器人 $1$ 号和 $2$ 号格子都为空，$0$ 号格子有 $3$ 种方案。总共 $3$ 种方案。\n7. 初始位置 $p = 0, 1, 2$ 都满足条件。那么两个机器人的输入输出必须都为空，总共 $1$ 种方案。\n\n根据容斥原理，最后的答案为 $729 + 729 + 27 - 12 - 3 - 3 + 1 = 1468$。\n\n**【数据范围】**\n\n对于所有测试点：$1 \\le n \\le 32$，$1 \\le m \\le 1000$，$1 \\le \\lvert S_i \\rvert \\le 100$。\n\n| 测试点编号 | $n \\le$ | $m \\le$ | 特殊限制 |\n|:-:|:-:|:-:|:-:|\n| $1 \\sim 2$ | $1$ | $1$ | 无 |\n| $3$ | $8$ | $1$ | 无 |\n| $4$ | $16$ | $1$ | 无 |\n| $5 \\sim 6$ | $32$ | $1$ | 无 |\n| $7$ | $16$ | $5$ | 无 |\n| $8 \\sim 10$ | $32$ | $5$ | 无 |\n| $11 \\sim 12$ | $16$ | $1000$ | 无 |\n| $13 \\sim 15$ | $32$ | $1000$ | A |\n| $16 \\sim 21$ | $32$ | $1000$ | B |\n| $22 \\sim 25$ | $32$ | $1000$ | 无 |\n\n特殊限制 A：操作序列中不存在 `R`。\n\n特殊限制 B：每个操作序列中，`R` 的数量至多 $15$ 个。", "locale": "zh-CN"}}}
{"pid": "P7741", "type": "P", "difficulty": 4, "samples": [["3 4\n1011\n1111\n1111", "10"], ["4 5\n10110\n01111\n11110\n10101", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2007", "各省省选", "安徽", "O2优化"], "title": "[AHOI2007] 石块地板", "background": "", "description": "小可可来到了宫殿的正厅中。大厅的地面是由一块块大小一致的正方形石块组成的，这些石块分为黑、白两色，组成了一个   $m×n$ 的矩形，在其中一个石块的下面就是通往藏宝库的通道。小可可不可能一个一个石块的尝试，因为有些石块安装了机关，一碰就会触发，整个宫殿也随之倒塌。根据藏宝图记载，通道在某一特定的区域中，这个区域是一个由数个石块组成的面积不为 $0$ 的小矩形，它的四条边与大厅地面的边平行。如果对整个大厅地面任意划分矩形，那么在所有矩形中，这个区域的黑色石块数目减去白色石块数目所得的差是最大的。\n\n小可可希望和你分工，由他来选择区域，你来计算黑、白两色石块的数目差 $S$ 。这样就能快速而准确的确认通道所在的区域。藏宝图上说这个区域中的石块都没有安装机关，只要确定了区域，就一定能找到通道。宝藏就在眼前了，加油吧！\n\n（假设用 $1$ 表示黑色石块，用 $0$ 表示白色石块）", "inputFormat": "输入文件的第一行为两个整数 $m,n$。\n\n以下 $m$ 行，每行 $n$ 个字符，每个字符都是 $0$ 或 $1$。", "outputFormat": "输出文件仅一个数，表示所有可能的区域中 $S$ 值（见前文描述）最大的一个，输出这个值即可。", "hint": "对于 $ 50\\%$ 的数据：$1 \\le m, n \\leq200$。\n\n对于 $100\\%$ 的数据：$1 \\le m, n \\leq400$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[AHOI2007] 石块地板", "background": "", "description": "小可可来到了宫殿的正厅中。大厅的地面是由一块块大小一致的正方形石块组成的，这些石块分为黑、白两色，组成了一个   $m×n$ 的矩形，在其中一个石块的下面就是通往藏宝库的通道。小可可不可能一个一个石块的尝试，因为有些石块安装了机关，一碰就会触发，整个宫殿也随之倒塌。根据藏宝图记载，通道在某一特定的区域中，这个区域是一个由数个石块组成的面积不为 $0$ 的小矩形，它的四条边与大厅地面的边平行。如果对整个大厅地面任意划分矩形，那么在所有矩形中，这个区域的黑色石块数目减去白色石块数目所得的差是最大的。\n\n小可可希望和你分工，由他来选择区域，你来计算黑、白两色石块的数目差 $S$ 。这样就能快速而准确的确认通道所在的区域。藏宝图上说这个区域中的石块都没有安装机关，只要确定了区域，就一定能找到通道。宝藏就在眼前了，加油吧！\n\n（假设用 $1$ 表示黑色石块，用 $0$ 表示白色石块）", "inputFormat": "输入文件的第一行为两个整数 $m,n$。\n\n以下 $m$ 行，每行 $n$ 个字符，每个字符都是 $0$ 或 $1$。", "outputFormat": "输出文件仅一个数，表示所有可能的区域中 $S$ 值（见前文描述）最大的一个，输出这个值即可。", "hint": "对于 $ 50\\%$ 的数据：$1 \\le m, n \\leq200$。\n\n对于 $100\\%$ 的数据：$1 \\le m, n \\leq400$。", "locale": "zh-CN"}}}
{"pid": "P7742", "type": "P", "difficulty": 2, "samples": [["3\nABC\nBLJTV1\nBLJTV2", "33"], ["4\nABC1\nABC02\nBLJTV2\nBLJTV1", "11144411144"], ["4\nABC1\nABC02\nBLJTV2\nBLJTV1", "33144413"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768]}, "tags": ["2011", "Special Judge", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #3] DIGITALNA", "background": "由于答案不唯一，**本题使用 SPJ 评测**。", "description": "不久前，Mirko 的祖父母不得不从模拟电视接收器切换到数字电视接收器。在他们的旧模拟电视接收器上，他们只能观看两个频道——BLJTV1 和 BLJTV2。换成数字接收器后，他们获得了几十个新的频道，但他们仍然想只看以前的两个频道。他们要求 Mirko 调整频道菜单，使 BLJTV1 在第一个频道，BLJTV2 在第二个频道上。开机后，数字接收器会创建一个可用频道的列表。所有的频道都是不同的，列表中总是包含 BLJTV1 和 BLJTV2。Mirko 找到了遥控器后开始调整菜单。菜单中包含了频道列表和一个标着当前选择频道的箭头。进入菜单后，箭头标志着列表中的第一个频道。菜单中有四种操作，每种操作在操作序列中用其前面的编号表示：\n\n1. 将箭头向下移动一个位置（从频道 $i$ 到频道 $i+1$）；\n2. 将箭头向上移动一个位置（从频道 $i$ 到频道 $i-1$）；\n3. 将箭头和选定的频道向下移动一个位置（频道 $i$ 和频道 $i+1$ 交换位置，箭头在频道 $i+1$ 的位置结束）；\n4. 将箭头和选定的通道向上移动一个位置（频道 $i$ 和频道 $i-1$ 交换位置，箭头在频道 $i-1$ 的位置结束）。\n\n菜单是稳定的，所以无效的命令（如将箭头移到频道列表之外的命令）都将被忽略。\n\n编写一个程序，给定一个频道列表，输出一个任何操作的序列，使其在执行后，BLJTV1 在频道列表的第一个位置，BLJTV2 在第二个位置。此外，该序列的长度应小于 $500$。所有其他频道的排序是**任意的**。", "inputFormat": "输入共 $n+1$ 行。\n\n第一行一个整数 $n$，表示频道个数。  \n随后 $n$ 行，每行一个字符串 $s$，表示频道的名字。\n\n输入数据保证所有频道中一定有 BLJTV1 和 BLJTV2 这两个频道，并且**一定存在至少一种**可行的操作序列。", "outputFormat": "输出仅一行，一个字符串，表示能够达到要求的操作序列。", "hint": "**【数据范围】**\n\n对于所有数据，$2\\leqslant n\\leqslant 100$，频道名字长度不超过 $10$，且仅包括大写英文字母和数字。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST 3](https://hsin.hr/coci/archive/2011_2012/contest3_tasks.pdf) T1 DIGITALNA_**，按照原题数据配置，满分 $50$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。\n\n感谢 [yzy1](https://www.luogu.com.cn/user/207996) 提供本题的 SPJ。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #3] DIGITALNA", "background": "由于答案不唯一，**本题使用 SPJ 评测**。", "description": "不久前，Mirko 的祖父母不得不从模拟电视接收器切换到数字电视接收器。在他们的旧模拟电视接收器上，他们只能观看两个频道——BLJTV1 和 BLJTV2。换成数字接收器后，他们获得了几十个新的频道，但他们仍然想只看以前的两个频道。他们要求 Mirko 调整频道菜单，使 BLJTV1 在第一个频道，BLJTV2 在第二个频道上。开机后，数字接收器会创建一个可用频道的列表。所有的频道都是不同的，列表中总是包含 BLJTV1 和 BLJTV2。Mirko 找到了遥控器后开始调整菜单。菜单中包含了频道列表和一个标着当前选择频道的箭头。进入菜单后，箭头标志着列表中的第一个频道。菜单中有四种操作，每种操作在操作序列中用其前面的编号表示：\n\n1. 将箭头向下移动一个位置（从频道 $i$ 到频道 $i+1$）；\n2. 将箭头向上移动一个位置（从频道 $i$ 到频道 $i-1$）；\n3. 将箭头和选定的频道向下移动一个位置（频道 $i$ 和频道 $i+1$ 交换位置，箭头在频道 $i+1$ 的位置结束）；\n4. 将箭头和选定的通道向上移动一个位置（频道 $i$ 和频道 $i-1$ 交换位置，箭头在频道 $i-1$ 的位置结束）。\n\n菜单是稳定的，所以无效的命令（如将箭头移到频道列表之外的命令）都将被忽略。\n\n编写一个程序，给定一个频道列表，输出一个任何操作的序列，使其在执行后，BLJTV1 在频道列表的第一个位置，BLJTV2 在第二个位置。此外，该序列的长度应小于 $500$。所有其他频道的排序是**任意的**。", "inputFormat": "输入共 $n+1$ 行。\n\n第一行一个整数 $n$，表示频道个数。  \n随后 $n$ 行，每行一个字符串 $s$，表示频道的名字。\n\n输入数据保证所有频道中一定有 BLJTV1 和 BLJTV2 这两个频道，并且**一定存在至少一种**可行的操作序列。", "outputFormat": "输出仅一行，一个字符串，表示能够达到要求的操作序列。", "hint": "**【数据范围】**\n\n对于所有数据，$2\\leqslant n\\leqslant 100$，频道名字长度不超过 $10$，且仅包括大写英文字母和数字。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST 3](https://hsin.hr/coci/archive/2011_2012/contest3_tasks.pdf) T1 DIGITALNA_**，按照原题数据配置，满分 $50$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。\n\n感谢 [yzy1](https://www.luogu.com.cn/user/207996) 提供本题的 SPJ。", "locale": "zh-CN"}}}
{"pid": "P7743", "type": "P", "difficulty": 2, "samples": [["235217\n3\nA 107382\nC 18059\nB 43265\n", "A 9\nB 4\nC 1"], ["245143\n4\nF 14845\nA 104516\nB 52652\nC 14161", "A 8\nB 4\nC 1\nF 1"], ["206278\n5\nD 44687\nA 68188\nC 7008\nB 48377\nG 9665", "A 6\nB 4\nD 4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2011", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #3] D’HONDT", "background": "$12$ 月初，某国举行议会选举。这个国家被分为十个选区，每个选区要选出 $14$ 名议会代表。每个选民都投票支持少数政党中的一个。投票后，选区代表用 D'Hondt 分配原理选出。", "description": "某一个选区里面有 $x$ 个选民，并有 $n$ 个政党参加议会选举。运用 D'Hondt 分配原理，我们先选出选票**至少占选民总数的 $5\\%$** 的政党。然后对于某一个政党的票数分别除以 $1,2,\\dots,14$，并将 $14$ 个除得的**实数**作为这个政党的分数分配给这个政党。然后，我们从拥有最高得分的政党中选出第一个代表，拥有第二高得分的政党中选出第二个代表，以此类推。注意，在本题中，我们默认**选举代表的方式总是唯一的，即所有分数都不相同。**\n\n现在，请你编写一个程序，给定选民的总数和每个政党得到的选票个数。请求出得到的选票至少占选民总数的 $5\\%$ 的所有政党中，每一个政党能够选出的代表数。", "inputFormat": "输入共 $n+2$ 行。\n\n第一行一个整数 $x$，表示选民的个数。  \n第二行一个整数 $n$，表示参加议会选举的政党数。  \n随后 $n$ 行，每行一个大写字母和一个整数 $g$，分别表示政党的标识符和该政党拥有的选票数。", "outputFormat": "输出若干行，每行一个大写字母和一个整数，分别代表一个得到的选票至少占选民总数的 $5\\%$ 的政党的标识符和能够选出的代表数。\n\n得到的选票至少占选民总数的 $5\\%$ 的所有政党按照标识符在字母表中的位置升序排列。", "hint": "**【数据范围】**\n\n对于 $30\\%$ 的数据，保证输入中所有政党拥有的票数都至少占选民总数的 $5\\%$。  \n对于所有数据，$1\\leqslant x\\leqslant 2.5\\times 10^6$，$0\\leqslant n\\leqslant 10$，$1\\leqslant g\\leqslant 2.5\\times 10^5$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST 3](https://hsin.hr/coci/archive/2011_2012/contest3_tasks.pdf) T2 D'HONDT_**，按照原题数据配置，满分 $80$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #3] D’HONDT", "background": "$12$ 月初，某国举行议会选举。这个国家被分为十个选区，每个选区要选出 $14$ 名议会代表。每个选民都投票支持少数政党中的一个。投票后，选区代表用 D'Hondt 分配原理选出。", "description": "某一个选区里面有 $x$ 个选民，并有 $n$ 个政党参加议会选举。运用 D'Hondt 分配原理，我们先选出选票**至少占选民总数的 $5\\%$** 的政党。然后对于某一个政党的票数分别除以 $1,2,\\dots,14$，并将 $14$ 个除得的**实数**作为这个政党的分数分配给这个政党。然后，我们从拥有最高得分的政党中选出第一个代表，拥有第二高得分的政党中选出第二个代表，以此类推。注意，在本题中，我们默认**选举代表的方式总是唯一的，即所有分数都不相同。**\n\n现在，请你编写一个程序，给定选民的总数和每个政党得到的选票个数。请求出得到的选票至少占选民总数的 $5\\%$ 的所有政党中，每一个政党能够选出的代表数。", "inputFormat": "输入共 $n+2$ 行。\n\n第一行一个整数 $x$，表示选民的个数。  \n第二行一个整数 $n$，表示参加议会选举的政党数。  \n随后 $n$ 行，每行一个大写字母和一个整数 $g$，分别表示政党的标识符和该政党拥有的选票数。", "outputFormat": "输出若干行，每行一个大写字母和一个整数，分别代表一个得到的选票至少占选民总数的 $5\\%$ 的政党的标识符和能够选出的代表数。\n\n得到的选票至少占选民总数的 $5\\%$ 的所有政党按照标识符在字母表中的位置升序排列。", "hint": "**【数据范围】**\n\n对于 $30\\%$ 的数据，保证输入中所有政党拥有的票数都至少占选民总数的 $5\\%$。  \n对于所有数据，$1\\leqslant x\\leqslant 2.5\\times 10^6$，$0\\leqslant n\\leqslant 10$，$1\\leqslant g\\leqslant 2.5\\times 10^5$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST 3](https://hsin.hr/coci/archive/2011_2012/contest3_tasks.pdf) T2 D'HONDT_**，按照原题数据配置，满分 $80$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7744", "type": "P", "difficulty": 3, "samples": [["3 2", "19"], ["3 4", "42"], ["737 296", "763532"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2011", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #3] POGODAK", "background": "Mirko 不喜欢拉丁文作业，所以他和 Slavko 打了个赌。输的人将在整个月内写他们两个人的作业。Mirko 想赢，所以他设计了这个问题用来打赌。", "description": "在他的桌子上，他发现了一个立方体，如图中所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/csekseld.png)\n\n在这个立方体中，两个对立面的点数之和等于 $7$。这意味着，$6$ 在 $1$ 的对面，$5$ 在 $2$ 的对面，$4$ 在 $3$ 的对面。Mirko 将立方体放在了一个 $r\\times c$ 的矩阵的左上方，最初立方体的方向是上侧显示 $1$，右侧显示 $3$。Mirko 现在依次重复以下动作：\n\n1. 向右滚动立方体，直到它到达最后一列；\n2. 向下滚动到下一行；\n3. 向左滚动立方体，直到它到达第一列；\n4. 像第二步一样，向下滚动到下一行。\n\nMirko 不停地重复这些步骤，直到立方体不能够再滚动为止。当一个立方体到达某一格时，Mirko 在这个格子中写下立方体的顶部的数字。最后他把他写的所有数字加起来。Mirko 与 Slavko 打了个赌，赌他能毫无差错地算出这个和。帮助 Slavko 算出这个和以验证 Mirko 的答案。 ", "inputFormat": "输入仅一行，两个整数 $r,c$，分别表示矩阵的行数和列数。", "outputFormat": "输出仅一行一个整数，表示最终矩阵里面填入的所有数字的和。", "hint": "**【样例 1 解释】**\n\n对于样例 $1$，最终矩阵里面填入的数字如下所示：\n\n| $1$ | $4$ |\n| :----------: | :----------: |\n| $1$ | $5$ |\n| $3$ | $5$ |\n\n因此最终的和为 $1+4+1+5+3+5=19$。\n\n**【数据范围】**\n\n对于 $50\\%$ 的数据，满足 $r,c\\leqslant 100$。  \n对于所有数据，$1\\leqslant r,c\\leqslant 10^5$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST 3](https://hsin.hr/coci/archive/2011_2012/contest3_tasks.pdf) T3 POGODAK_**，按照原题数据配置，满分 $100$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #3] POGODAK", "background": "Mirko 不喜欢拉丁文作业，所以他和 Slavko 打了个赌。输的人将在整个月内写他们两个人的作业。Mirko 想赢，所以他设计了这个问题用来打赌。", "description": "在他的桌子上，他发现了一个立方体，如图中所示。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/csekseld.png)\n\n在这个立方体中，两个对立面的点数之和等于 $7$。这意味着，$6$ 在 $1$ 的对面，$5$ 在 $2$ 的对面，$4$ 在 $3$ 的对面。Mirko 将立方体放在了一个 $r\\times c$ 的矩阵的左上方，最初立方体的方向是上侧显示 $1$，右侧显示 $3$。Mirko 现在依次重复以下动作：\n\n1. 向右滚动立方体，直到它到达最后一列；\n2. 向下滚动到下一行；\n3. 向左滚动立方体，直到它到达第一列；\n4. 像第二步一样，向下滚动到下一行。\n\nMirko 不停地重复这些步骤，直到立方体不能够再滚动为止。当一个立方体到达某一格时，Mirko 在这个格子中写下立方体的顶部的数字。最后他把他写的所有数字加起来。Mirko 与 Slavko 打了个赌，赌他能毫无差错地算出这个和。帮助 Slavko 算出这个和以验证 Mirko 的答案。 ", "inputFormat": "输入仅一行，两个整数 $r,c$，分别表示矩阵的行数和列数。", "outputFormat": "输出仅一行一个整数，表示最终矩阵里面填入的所有数字的和。", "hint": "**【样例 1 解释】**\n\n对于样例 $1$，最终矩阵里面填入的数字如下所示：\n\n| $1$ | $4$ |\n| :----------: | :----------: |\n| $1$ | $5$ |\n| $3$ | $5$ |\n\n因此最终的和为 $1+4+1+5+3+5=19$。\n\n**【数据范围】**\n\n对于 $50\\%$ 的数据，满足 $r,c\\leqslant 100$。  \n对于所有数据，$1\\leqslant r,c\\leqslant 10^5$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST 3](https://hsin.hr/coci/archive/2011_2012/contest3_tasks.pdf) T3 POGODAK_**，按照原题数据配置，满分 $100$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7745", "type": "P", "difficulty": 4, "samples": [["1 3\n0 -10\nISI", "11\n12\n13"], ["3 5\n0 0\n1 1\n1 -1\nSIJJZ", "5\n4\n3\n4\n5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [32768, 32768, 32768, 32768, 32768]}, "tags": ["2011", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #3] ROBOT", "background": "Mirko 创造了一个新的机器人，并决定在一个巨大的测试轨道上测试它。", "description": "我们不妨把测试轨道想象成一个二维坐标系。机器人从 $(0,0)$ 开始，接收一组由 `S`、`J`、`I`、`Z` 表示的指令，每一个指令都标志着机器人应该在哪个方向移动。具体地，如果机器人当前位于 $(x,y)$：\n\n- 指令 `S` 意味着它应该移动到 $(x,y+1)$。\n- 指令 `J` 意味着它应该移动到 $(x,y-1)$。\n- 指令 `I` 意味着它应该移动到 $(x+1,y)$。\n- 指令 `Z` 意味着它应该移动到 $(x-1,y)$。\n\n当机器人接受指令并在测试轨道上移动时，Mirko 以下列方式验证其位置：\n\n测试轨道上有 $n$ 个固定的控制点，每个控制点都会测量与机器人的**曼哈顿距离**，并将所有距离的和发送给 Mirko。假设机器人完全按照指令移动，请你计算执行每条指令后所有控制点距离机器人的曼哈顿距离之和。", "inputFormat": "输入共 $n+2$ 行。\n\n第一行，两个整数 $n,m$，分别表示控制点的数量和指令的数量。  \n第 $2\\sim n+1$ 行，每行两个整数 $(x_i,y_i)$，分别表示每个控制点的横坐标和纵坐标。  \n第 $n+2$ 行一个长度为 $m$ 的字符串，表示机器人将接收到的指令。", "outputFormat": "输出共 $m$ 行，每行一个整数，表示执行每条指令后所有控制点距离机器人的曼哈顿距离之和。", "hint": "**【前置知识】**\n\n- 曼哈顿距离：设有两个点 $(a,b)$ 和 $(c,d)$，则这两个点的曼哈顿距离为 $|a-c|+|b-d|$。\n\n**【数据范围】**\n\n对于所有数据，$1\\leqslant n\\leqslant 10^5$，$1\\leqslant m\\leqslant 3\\times 10^5$，$|x_i|,|y_i|\\leqslant 10^6$，指令仅包含 `S`、`I`、`J`、`Z` 四个字符中的一个。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST 3](https://hsin.hr/coci/archive/2011_2012/contest3_tasks.pdf) T4 ROBOT_**，按照原题数据配置，满分 $120$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #3] ROBOT", "background": "Mirko 创造了一个新的机器人，并决定在一个巨大的测试轨道上测试它。", "description": "我们不妨把测试轨道想象成一个二维坐标系。机器人从 $(0,0)$ 开始，接收一组由 `S`、`J`、`I`、`Z` 表示的指令，每一个指令都标志着机器人应该在哪个方向移动。具体地，如果机器人当前位于 $(x,y)$：\n\n- 指令 `S` 意味着它应该移动到 $(x,y+1)$。\n- 指令 `J` 意味着它应该移动到 $(x,y-1)$。\n- 指令 `I` 意味着它应该移动到 $(x+1,y)$。\n- 指令 `Z` 意味着它应该移动到 $(x-1,y)$。\n\n当机器人接受指令并在测试轨道上移动时，Mirko 以下列方式验证其位置：\n\n测试轨道上有 $n$ 个固定的控制点，每个控制点都会测量与机器人的**曼哈顿距离**，并将所有距离的和发送给 Mirko。假设机器人完全按照指令移动，请你计算执行每条指令后所有控制点距离机器人的曼哈顿距离之和。", "inputFormat": "输入共 $n+2$ 行。\n\n第一行，两个整数 $n,m$，分别表示控制点的数量和指令的数量。  \n第 $2\\sim n+1$ 行，每行两个整数 $(x_i,y_i)$，分别表示每个控制点的横坐标和纵坐标。  \n第 $n+2$ 行一个长度为 $m$ 的字符串，表示机器人将接收到的指令。", "outputFormat": "输出共 $m$ 行，每行一个整数，表示执行每条指令后所有控制点距离机器人的曼哈顿距离之和。", "hint": "**【前置知识】**\n\n- 曼哈顿距离：设有两个点 $(a,b)$ 和 $(c,d)$，则这两个点的曼哈顿距离为 $|a-c|+|b-d|$。\n\n**【数据范围】**\n\n对于所有数据，$1\\leqslant n\\leqslant 10^5$，$1\\leqslant m\\leqslant 3\\times 10^5$，$|x_i|,|y_i|\\leqslant 10^6$，指令仅包含 `S`、`I`、`J`、`Z` 四个字符中的一个。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST 3](https://hsin.hr/coci/archive/2011_2012/contest3_tasks.pdf) T4 ROBOT_**，按照原题数据配置，满分 $120$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
{"pid": "P7746", "type": "P", "difficulty": 4, "samples": [["2 3\n5\n3 1\np 1 5\nu 2\nu 1", "8\n5"], ["5 5\n4\n2 1\n6 1\n7 1\n3 4\nu 3\np 1 -1\nu 3\np 4 5\nu 5", "6\n5\n7"], ["6 7\n5\n4 1\n3 2\n7 3\n2 3\n3 5\np 3 2\np 2 4\nu 3\nu 6\np 5 -2\nu 6\nu 1", "7\n9\n7\n5"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2011", "树链剖分", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #3] PLAĆE", "background": "Mirko 喜欢汽车，他终于成功地开办了自己的汽车工厂。", "description": "工厂有 $n$ 个员工，每个人都有一个上司（除了 Mirko 默认为每个人的上司）。Mirko 用 $1$ 号表示，其余员工用 $2\\sim n$ 号表示。每个员工都可以提高或降低他所有下属（包括直接下属和等级树上的下属）的工资。Mirko 的职责是防止这种权力的滥用，所以他不时地想知道某个雇员的工资。他要求你写一个程序，给定一系列命令（见输入格式部分），帮助他监控工资的变化。注意：在任何时候，所有的工资都是正整数，并适合于标准的 $32$ 位整数类型（C/C++ 中的 `int`，Pascal 中的 `longint`）。", "inputFormat": "输入共 $n+m+1$ 行。\n\n第一行，两个整数 $n,m$，分别表示员工的总数和指令的个数。  \n第 $2\\sim n+1$ 行，第 $i$ 行两个整数分别表示第 $i-1$ 号员工的初始工资和他的直属上司（注意，Mirko 并没有上司，因此输入他的信息的那一行仅输入他的初始工资）。  \n第 $n+2\\sim n+m+1$ 行，每行先输入一个字符表示命令类型，接下来的输入如下所述：\n\n- 如果字符为 `p`，接下来两个整数 $a,x$，表示员工 $a$ 将它的所有下属（包括**直系下属**和**他能够间接控制到的所有下属**）的工资增加了 $x$（如果 $x$ 是负数则相当于减少工资）。\n- 如果字符为 `u`，接下来仅一个整数 $a$，表示 Mirko 想知道员工 $a$ 的工资。", "outputFormat": "对于每一个 `u` 操作，输出一行一个整数，表示被询问的员工的工资。", "hint": "**【数据范围】**\n\n对于所有数据，$1\\leqslant n,m\\leqslant 5\\times 10^5$，$1\\leqslant a\\leqslant n$，$-10^4\\leqslant x\\leqslant 10^4$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST 3](https://hsin.hr/coci/archive/2011_2012/contest3_tasks.pdf) T5 PLAĆE_**，按照原题数据配置，满分 $140$ 分。\n\n由 [Eason_AC](/user/112917) 翻译整理提供， [123asdf123](/user/576074) 微调。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #3] PLAĆE", "background": "Mirko 喜欢汽车，他终于成功地开办了自己的汽车工厂。", "description": "工厂有 $n$ 个员工，每个人都有一个上司（除了 Mirko 默认为每个人的上司）。Mirko 用 $1$ 号表示，其余员工用 $2\\sim n$ 号表示。每个员工都可以提高或降低他所有下属（包括直接下属和等级树上的下属）的工资。Mirko 的职责是防止这种权力的滥用，所以他不时地想知道某个雇员的工资。他要求你写一个程序，给定一系列命令（见输入格式部分），帮助他监控工资的变化。注意：在任何时候，所有的工资都是正整数，并适合于标准的 $32$ 位整数类型（C/C++ 中的 `int`，Pascal 中的 `longint`）。", "inputFormat": "输入共 $n+m+1$ 行。\n\n第一行，两个整数 $n,m$，分别表示员工的总数和指令的个数。  \n第 $2\\sim n+1$ 行，第 $i$ 行两个整数分别表示第 $i-1$ 号员工的初始工资和他的直属上司（注意，Mirko 并没有上司，因此输入他的信息的那一行仅输入他的初始工资）。  \n第 $n+2\\sim n+m+1$ 行，每行先输入一个字符表示命令类型，接下来的输入如下所述：\n\n- 如果字符为 `p`，接下来两个整数 $a,x$，表示员工 $a$ 将它的所有下属（包括**直系下属**和**他能够间接控制到的所有下属**）的工资增加了 $x$（如果 $x$ 是负数则相当于减少工资）。\n- 如果字符为 `u`，接下来仅一个整数 $a$，表示 Mirko 想知道员工 $a$ 的工资。", "outputFormat": "对于每一个 `u` 操作，输出一行一个整数，表示被询问的员工的工资。", "hint": "**【数据范围】**\n\n对于所有数据，$1\\leqslant n,m\\leqslant 5\\times 10^5$，$1\\leqslant a\\leqslant n$，$-10^4\\leqslant x\\leqslant 10^4$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST 3](https://hsin.hr/coci/archive/2011_2012/contest3_tasks.pdf) T5 PLAĆE_**，按照原题数据配置，满分 $140$ 分。\n\n由 [Eason_AC](/user/112917) 翻译整理提供， [123asdf123](/user/576074) 微调。", "locale": "zh-CN"}}}
{"pid": "P7747", "type": "P", "difficulty": 6, "samples": [["3 3\n2\n1\n1\n2\n1\n1", "11"], ["3 3\n2\n3\n3\n2\n1\n2", "29"], ["4 5\n3\n2\n2\n2\n3\n1\n2\n1\n2", "55"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2011", "斜率优化", "凸包", "COCI（克罗地亚）"], "title": "[COCI 2011/2012 #3] TRAKA", "background": "", "description": "Mirko 的工厂里面有 $n$ 个工人。他们以流水线方式在传送带上制造汽车。工人从左往右编号为 $1\\sim n$，其中工人 $1$ 即为 Mirko。汽车生产从工人 $1$（Mirko）开始，在他完成所有他的工作后，工人 $2$ 接手他的任务。之后工人 $3$ 再接手工人 $2$ 的任务，以此类推。当工人 $n$ 完成他的工作后，一辆汽车就生产完成了。\n\nMirko 和他的工人们必须生产 $m$ 辆汽车，且必须按 $1\\sim m$ 的顺序生产。对于第 $i$ 个工人，他完成他的工作的时间为 $t_i$。对于第 $j$ 辆汽车，它装配的复杂度为 $f_j$。工人 $i$ 在汽车 $j$ 上完成他的工作所需时间为 $t_i\\cdot f_j$。\n\n根据公司政策，一个工人完成他的工作后，他必须立即将工作交给下一个工人，不得拖延。因此，下一个工人此时不能够在其他汽车上工作。为了满足这个条件，Mirko 必须等到一个好的时机开始制造一辆新车。为了提高效率，他将等待最少的时间，直到他确定能够满足所有条件。\n\n编写一个程序，给定每个工人完成他的工作的时间和每辆车装配的复杂度，求生产所有汽车所需的总时间。", "inputFormat": "输入共 $n+m+2$ 行。\n\n第一行，两个整数 $n,m$，分别代表工人的个数和需要生产的汽车的辆数。  \n随后 $n$ 行，每行一个整数 $t_i$，表示第 $i$ 个工人完成他的工作的时间。  \n随后 $m$ 行，每行一个整数 $f_j$，表示第 $j$ 辆车装配的复杂度。", "outputFormat": "输出仅一行一个整数，表示生产所有汽车所需的总时间。", "hint": "**【样例 1 解释】**\n\n对于样例 $1$，$4$ 个单位的时间后，工人 $1$ 完成了第一辆车的工作。他可能会立即开始在第二辆车上工作，但这违反了汽车必须在完成后立即传递给下一个工人的条件（$7$ 个单位的时间后第二个工人将完成他在第二辆车上的工作，但是第三个工人不能接手，因为他仍然在第一辆车上工作）。因此，第二辆车在 $5$ 个单位的时间后才能开始生产。$7$ 个单位的时间后开始生产第三辆汽车。第一辆车在 $8$ 个单位的时间后完成，第二辆车在 $9$ 个单位的时间后完成，第三辆车在 $11$ 个单位的时间后完成。因此总时间是 $11$。\n\n**【数据范围】**\n\n对于 $40\\%$ 的数据，满足 $n,m\\leqslant 1000$。  \n对于所有数据，$1\\leqslant n,m\\leqslant 10^5$，$1\\leqslant t_i,f_j\\leqslant 10^4$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST 3](https://hsin.hr/coci/archive/2011_2012/contest3_tasks.pdf) T6 TRAKA_**，按照原题数据配置，满分 $160$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[COCI 2011/2012 #3] TRAKA", "background": "", "description": "Mirko 的工厂里面有 $n$ 个工人。他们以流水线方式在传送带上制造汽车。工人从左往右编号为 $1\\sim n$，其中工人 $1$ 即为 Mirko。汽车生产从工人 $1$（Mirko）开始，在他完成所有他的工作后，工人 $2$ 接手他的任务。之后工人 $3$ 再接手工人 $2$ 的任务，以此类推。当工人 $n$ 完成他的工作后，一辆汽车就生产完成了。\n\nMirko 和他的工人们必须生产 $m$ 辆汽车，且必须按 $1\\sim m$ 的顺序生产。对于第 $i$ 个工人，他完成他的工作的时间为 $t_i$。对于第 $j$ 辆汽车，它装配的复杂度为 $f_j$。工人 $i$ 在汽车 $j$ 上完成他的工作所需时间为 $t_i\\cdot f_j$。\n\n根据公司政策，一个工人完成他的工作后，他必须立即将工作交给下一个工人，不得拖延。因此，下一个工人此时不能够在其他汽车上工作。为了满足这个条件，Mirko 必须等到一个好的时机开始制造一辆新车。为了提高效率，他将等待最少的时间，直到他确定能够满足所有条件。\n\n编写一个程序，给定每个工人完成他的工作的时间和每辆车装配的复杂度，求生产所有汽车所需的总时间。", "inputFormat": "输入共 $n+m+2$ 行。\n\n第一行，两个整数 $n,m$，分别代表工人的个数和需要生产的汽车的辆数。  \n随后 $n$ 行，每行一个整数 $t_i$，表示第 $i$ 个工人完成他的工作的时间。  \n随后 $m$ 行，每行一个整数 $f_j$，表示第 $j$ 辆车装配的复杂度。", "outputFormat": "输出仅一行一个整数，表示生产所有汽车所需的总时间。", "hint": "**【样例 1 解释】**\n\n对于样例 $1$，$4$ 个单位的时间后，工人 $1$ 完成了第一辆车的工作。他可能会立即开始在第二辆车上工作，但这违反了汽车必须在完成后立即传递给下一个工人的条件（$7$ 个单位的时间后第二个工人将完成他在第二辆车上的工作，但是第三个工人不能接手，因为他仍然在第一辆车上工作）。因此，第二辆车在 $5$ 个单位的时间后才能开始生产。$7$ 个单位的时间后开始生产第三辆汽车。第一辆车在 $8$ 个单位的时间后完成，第二辆车在 $9$ 个单位的时间后完成，第三辆车在 $11$ 个单位的时间后完成。因此总时间是 $11$。\n\n**【数据范围】**\n\n对于 $40\\%$ 的数据，满足 $n,m\\leqslant 1000$。  \n对于所有数据，$1\\leqslant n,m\\leqslant 10^5$，$1\\leqslant t_i,f_j\\leqslant 10^4$。\n\n**【题目来源】**\n\n本题来源自 **_[COCI 2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST 3](https://hsin.hr/coci/archive/2011_2012/contest3_tasks.pdf) T6 TRAKA_**，按照原题数据配置，满分 $160$ 分。\n\n由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。", "locale": "zh-CN"}}}
