{"pid": "P5226", "type": "P", "difficulty": 6, "samples": [["5 8\n0 *\n0 *\n0 *\n0 *\n0 *\n2 0\n1 0 1 +\n1 2 1 +\n2 3\n1 1 1 +\n1 3 1 +\n1 4 1 +\n2 4\n", "0\n2\n-1\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2015", "四川", "线段树", "各省省选"], "title": "[SCOI2015] 小凸解密码", "background": "", "description": "小凸得到了一个密码盘，密码盘被等分成 $n$ 个扇形，每个扇形上有一个数字 $(0 \\sim 9)$，和一个符号 $($ `+` 或 `*` $)$。密码盘解密的方法如下：\n\n首先，选择一个位置开始，顺时针地将数字和符号分别记在数组 $A$ 和数组 $C$ 中。解密的方法如下：\n\n- $B_0 = A_0$\n- 当 $x > 0$ 时：\n  - 若 $C_x$ 为 `+`，$B_x = (A_x + A_{x - 1}) \\% 10$\n  - 若 $C_x$ 为 `*`，$B_x = (A_x \\times A_{x - 1}) \\% 10$\n\n操作完成后，可以得到一个长度为 $n$ 的数组 $B$，然后以 $B_0$ 为起点将 $B$ 数组顺时针写成一个环，解密就完成了，称得到的环为答案环。\n\n现在小凸得到了一份指令表，指令表上有 2 种操作。一种指令是修改操作，即改变原来密码盘上一个位置的数字和符号。另一种指令是询问操作，具体如下：\n\n- 首先从指令给出的位置开始完成解密，得到答案环。\n- 答案环上会有一些 $0$ 连在一起，将这些连在一起的 $0$ 称为零区间，找出其中距离 $B_0$ 最远的那个零区间，输出这个距离（零区间和 $B_0$ 的距离定义为：零区间内所有 $0$ 到 $B_0$ 距离中的最小值）。", "inputFormat": "第一行包含两个整数 $n, m$，代表密码盘大小和指令个数。\n\n接下来 $n$ 行，每行包含一个整数和一个字符，按顺时针顺序给出了密码盘上的数组和符号。\n\n接下来 $m$ 行，依次给出指令。每行第一个整数代表指令类型：\n\n- 若第一个整数为 `1`，代表本行对应指令为修改操作，之后依次有两个整数 $pos, num$ 和一个字符 $\\rm opt$，分别代表修改的位置，以及修改后该位置的数字和字符。\n- 若第一个整数为 `2`，代表本行对应指令位询问操作，之后有一个整数 $pos$，代表本次操作中解密的开始位置。\n\n密码盘上的位置标号为 $0$ 到 $n - 1$。\n\n数据保证合法，即数据中 $0 \\leq pos < n, 0 \\leq num \\leq 9$，$\\rm opt$ 为 `+` 或 `*`。", "outputFormat": "对于每个询问操作 $1$ 行，输出答案，若答案环上没有 $0$，输出 `−1`。", "hint": "**样例解释：**\n\n对于第 $1$ 个询问，答案环为 $\\{0, 0, 0, 0, 0\\}$，仅有 $1$ 个零区间，且 $B_0$ 在其中，所以距离是 $0$。  \n对于第 $2$ 个询问，答案环为 $\\{0, 0, 1, 0, 1\\}$，有 $2$ 个零区间，$[0, 1]$ 和 $B_0$ 距离是 $0$，$[3, 3]$ 和 $B_0$ 距离是 $2$，故答案为 $2$。  \n对于第 $3$ 个询问，答案环为 $\\{1, 2, 2, 2, 2\\}$，没有零区间，答案是 `−1`。\n\n**数据范围：**\n\n对于 $20 \\%$ 数据，$5 \\leq n \\leq 10^5, 5 \\leq m \\leq 1000$；  \n对于 $60 \\%$ 数据，$5 \\leq n \\leq 10^5, 5 \\leq m \\leq 10^4$；  \n对于 $100 \\%$ 数据，$5 \\leq n, m \\leq 10^5$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[SCOI2015] Xiao Tu Solves the Password", "background": "", "description": "Xiao Tu obtained a password dial. The dial is evenly divided into $n$ sectors. Each sector contains a digit $(0 \\sim 9)$ and a symbol ($+$ or $*$). The decryption method is as follows.\n\nFirst, choose a starting position, and record the digits and symbols clockwise into arrays $A$ and $C$, respectively. The decryption is done as follows:\n\n- $B_0 = A_0$.\n- When $x > 0$:\n  - If $C_x$ is `+`, then $B_x = (A_x + A_{x - 1}) \\% 10$.\n  - If $C_x$ is `*`, then $B_x = (A_x \\times A_{x - 1}) \\% 10$.\n\nAfter finishing the operations, you obtain an array $B$ of length $n$. Then, starting from $B_0$, write the array $B$ clockwise into a ring. The decryption is complete. The resulting ring is called the answer ring.\n\nNow Xiao Tu has an instruction list with 2 types of operations. One type is an update operation, which changes the digit and symbol at a position on the original dial. The other type is a query operation, described as follows:\n\n- First, start from the position given in the instruction and complete the decryption to obtain the answer ring.\n- On the answer ring, there may be some consecutive $0$’s. Such consecutive $0$’s are called a zero interval. Find the zero interval that is farthest from $B_0$, and output this distance (the distance between a zero interval and $B_0$ is defined as the minimum, among all $0$’s in the interval, of the distance from that $0$ to $B_0$).", "inputFormat": "The first line contains two integers $n, m$, representing the size of the password dial and the number of instructions.\n\nThe next $n$ lines each contain an integer and a character, giving the digit array and symbol array on the dial in clockwise order.\n\nThe next $m$ lines give the instructions in order. The first integer on each line indicates the instruction type:\n\n- If the first integer is `1`, this instruction is an update operation. It is followed by two integers $pos, num$ and a character $\\rm opt$, representing the position to modify, and the digit and character at that position after modification.\n- If the first integer is `2`, this instruction is a query operation. It is followed by an integer $pos$, representing the starting position for decryption in this operation.\n\nThe positions on the dial are numbered from $0$ to $n - 1$.\n\nThe testdata is guaranteed to be valid, i.e., $0 \\leq pos < n$, $0 \\leq num \\leq 9$, and $\\rm opt$ is `+` or `*`.", "outputFormat": "For each query operation, output one line with the answer. If there is no $0$ on the answer ring, output `−1`.", "hint": "**Sample Explanation:**\n\nFor the $1$st query, the answer ring is $\\{0, 0, 0, 0, 0\\}$. There is only $1$ zero interval, and $B_0$ is inside it, so the distance is $0$.  \nFor the $2$nd query, the answer ring is $\\{0, 0, 1, 0, 1\\}$. There are $2$ zero intervals. The distance between $[0, 1]$ and $B_0$ is $0$, and the distance between $[3, 3]$ and $B_0$ is $2$, so the answer is $2$.  \nFor the $3$rd query, the answer ring is $\\{1, 2, 2, 2, 2\\}$. There is no zero interval, so the answer is `−1`.\n\n**Constraints:**\n\nFor $20\\%$ of the testdata, $5 \\leq n \\leq 10^5$, $5 \\leq m \\leq 1000$.  \nFor $60\\%$ of the testdata, $5 \\leq n \\leq 10^5$, $5 \\leq m \\leq 10^4$.  \nFor $100\\%$ of the testdata, $5 \\leq n, m \\leq 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SCOI2015] 小凸解密码", "background": "", "description": "小凸得到了一个密码盘，密码盘被等分成 $n$ 个扇形，每个扇形上有一个数字 $(0 \\sim 9)$，和一个符号 $($ `+` 或 `*` $)$。密码盘解密的方法如下：\n\n首先，选择一个位置开始，顺时针地将数字和符号分别记在数组 $A$ 和数组 $C$ 中。解密的方法如下：\n\n- $B_0 = A_0$\n- 当 $x > 0$ 时：\n  - 若 $C_x$ 为 `+`，$B_x = (A_x + A_{x - 1}) \\% 10$\n  - 若 $C_x$ 为 `*`，$B_x = (A_x \\times A_{x - 1}) \\% 10$\n\n操作完成后，可以得到一个长度为 $n$ 的数组 $B$，然后以 $B_0$ 为起点将 $B$ 数组顺时针写成一个环，解密就完成了，称得到的环为答案环。\n\n现在小凸得到了一份指令表，指令表上有 2 种操作。一种指令是修改操作，即改变原来密码盘上一个位置的数字和符号。另一种指令是询问操作，具体如下：\n\n- 首先从指令给出的位置开始完成解密，得到答案环。\n- 答案环上会有一些 $0$ 连在一起，将这些连在一起的 $0$ 称为零区间，找出其中距离 $B_0$ 最远的那个零区间，输出这个距离（零区间和 $B_0$ 的距离定义为：零区间内所有 $0$ 到 $B_0$ 距离中的最小值）。", "inputFormat": "第一行包含两个整数 $n, m$，代表密码盘大小和指令个数。\n\n接下来 $n$ 行，每行包含一个整数和一个字符，按顺时针顺序给出了密码盘上的数组和符号。\n\n接下来 $m$ 行，依次给出指令。每行第一个整数代表指令类型：\n\n- 若第一个整数为 `1`，代表本行对应指令为修改操作，之后依次有两个整数 $pos, num$ 和一个字符 $\\rm opt$，分别代表修改的位置，以及修改后该位置的数字和字符。\n- 若第一个整数为 `2`，代表本行对应指令位询问操作，之后有一个整数 $pos$，代表本次操作中解密的开始位置。\n\n密码盘上的位置标号为 $0$ 到 $n - 1$。\n\n数据保证合法，即数据中 $0 \\leq pos < n, 0 \\leq num \\leq 9$，$\\rm opt$ 为 `+` 或 `*`。", "outputFormat": "对于每个询问操作 $1$ 行，输出答案，若答案环上没有 $0$，输出 `−1`。", "hint": "**样例解释：**\n\n对于第 $1$ 个询问，答案环为 $\\{0, 0, 0, 0, 0\\}$，仅有 $1$ 个零区间，且 $B_0$ 在其中，所以距离是 $0$。  \n对于第 $2$ 个询问，答案环为 $\\{0, 0, 1, 0, 1\\}$，有 $2$ 个零区间，$[0, 1]$ 和 $B_0$ 距离是 $0$，$[3, 3]$ 和 $B_0$ 距离是 $2$，故答案为 $2$。  \n对于第 $3$ 个询问，答案环为 $\\{1, 2, 2, 2, 2\\}$，没有零区间，答案是 `−1`。\n\n**数据范围：**\n\n对于 $20 \\%$ 数据，$5 \\leq n \\leq 10^5, 5 \\leq m \\leq 1000$；  \n对于 $60 \\%$ 数据，$5 \\leq n \\leq 10^5, 5 \\leq m \\leq 10^4$；  \n对于 $100 \\%$ 数据，$5 \\leq n, m \\leq 10^5$。\n", "locale": "zh-CN"}}}
{"pid": "P5227", "type": "P", "difficulty": 6, "samples": [["4 5\n1 2\n2 3\n3 4\n4 1\n2 4\n3\n1 5\n2 2 3\n2 1 2", "Connected\nDisconnected\nConnected"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2013", "并查集", "各省省选", "安徽", "O2优化", "动态树 LCT", "线段树分治"], "title": "[AHOI2013] 连通图", "background": null, "description": "给定一个无向连通图和若干个小集合，每个小集合包含一些边，对于每个集合，你需要确定将集合中的边删掉后改图是否保持联通。集合间的询问相互独立。\n\n定义一个图为联通的当且仅当对于任意的两个顶点，都存在一条路径连接它们。", "inputFormat": "第一行为两个整数 $n,m$，代表无向图的点数和边数。\n\n下面 $m$ 行，包含两个整数 $u,v$，代表该边连接点 $u,v$。第 $i + 1$ 行的边的编号为 $i$。保证不存在重边和自环。\n\n下面一行包含一个整数 $k$，表示集合个数。\n\n下面 $k$ 行每行描述一个集合，每行的第一个数为集合中边的个数 $c$，后面 $c$ 个数代表集合内的边。", "outputFormat": "对于每个集合，输出一行代表去掉该集合中的边后图是否联通，如果联通输出 ``Connected``，否则输出 ``Disconnected``。", "hint": "$1~\\leq~n,k~\\leq~10^5$，$1~\\leq~m~\\leq~2~\\times~10^5$，$1~\\leq~c~\\leq~4$。", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2013] Connected Graph", "background": "", "description": "Given an undirected connected graph and several small sets, each set contains some edges. For each set, you need to determine whether the graph remains connected after deleting the edges in this set. Queries for different sets are independent of each other.\n\nA graph is defined to be connected if and only if for any two vertices, there exists a path connecting them.", "inputFormat": "The first line contains two integers $n,m$, representing the number of vertices and edges in the undirected graph.\n\nThe next $m$ lines each contain two integers $u,v$, meaning this edge connects vertices $u,v$. The edge number of the line $i+1$ is $i$. It is guaranteed that there are no multiple edges or self-loops.\n\nThe next line contains an integer $k$, denoting the number of sets.\n\nThe next $k$ lines each describe a set. The first number in each line is $c$, the number of edges in the set, followed by $c$ numbers representing the edges in the set.", "outputFormat": "For each set, output one line indicating whether the graph is connected after removing the edges in the set. If it is connected, output ``Connected``; otherwise, output ``Disconnected``.", "hint": "$1~\\leq~n,k~\\leq~10^5$，$1~\\leq~m~\\leq~2~\\times~10^5$，$1~\\leq~c~\\leq~4$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2013] 连通图", "background": null, "description": "给定一个无向连通图和若干个小集合，每个小集合包含一些边，对于每个集合，你需要确定将集合中的边删掉后改图是否保持联通。集合间的询问相互独立。\n\n定义一个图为联通的当且仅当对于任意的两个顶点，都存在一条路径连接它们。", "inputFormat": "第一行为两个整数 $n,m$，代表无向图的点数和边数。\n\n下面 $m$ 行，包含两个整数 $u,v$，代表该边连接点 $u,v$。第 $i + 1$ 行的边的编号为 $i$。保证不存在重边和自环。\n\n下面一行包含一个整数 $k$，表示集合个数。\n\n下面 $k$ 行每行描述一个集合，每行的第一个数为集合中边的个数 $c$，后面 $c$ 个数代表集合内的边。", "outputFormat": "对于每个集合，输出一行代表去掉该集合中的边后图是否联通，如果联通输出 ``Connected``，否则输出 ``Disconnected``。", "hint": "$1~\\leq~n,k~\\leq~10^5$，$1~\\leq~m~\\leq~2~\\times~10^5$，$1~\\leq~c~\\leq~4$。", "locale": "zh-CN"}}}
{"pid": "P5228", "type": "P", "difficulty": 5, "samples": [["2\n25 102", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "贪心", "2013", "各省省选", "安徽", "O2优化"], "title": "[AHOI2013] 找硬币", "background": null, "description": "小蛇是金融部部长。最近她决定制造一系列新的货币。假设她要制造的货币的面值为 $x_1,x_2,x_3\\dots$，那么 $x_1$ 必须为 $1$，$x_b$ 必须为 $x_a$ 的正整数倍（$b>a$）。例如 $1,5,125,250$ 就是一组合法的硬币序列，而 $1,5,100,125$ 就不是。不知从哪一天开始，可爱的蛇爱上了一种萌物——兔纸！从此，小蛇便走上了遇上兔纸娃娃就买的不归路。某天，小蛇看到了 $N$ 只可爱的兔纸，假设这 $N$ 只兔纸的价钱分别是 $a_1,a_2\\dots a_N$。现在小蛇想知道，在哪一组合法的硬币序列下，买这 $N$ 只兔纸所需要的硬币数最少。买兔纸时不能找零。", "inputFormat": "第一行，一个整数 $N$，表示兔纸的个数\n第二行，$N$ 个用空格隔开的整数，分别为 $N$ 只兔纸的价钱", "outputFormat": "一行，一个整数，表示最少付的钱币数。", "hint": "$1\\leq N\\leq50$\n\n$1\\leq a_i\\leq10^5$", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2013] Finding Coins", "background": "", "description": "Little Snake is the minister of the finance department. Recently, she decided to create a series of new currencies. Suppose the denominations she will create are $x_1, x_2, x_3 \\dots$. Then $x_1$ must be $1$, and $x_b$ must be a positive integer multiple of $x_a$ ($b > a$). For example, $1, 5, 125, 250$ is a valid coin sequence, while $1, 5, 100, 125$ is not.\n\nStarting from some day, the lovely Snake fell in love with a cute thing—“rabbit dolls” (tu zi)! From then on, she took the one-way path of buying any rabbit doll she encountered. One day, she saw $N$ cute rabbit dolls. Suppose the prices of these $N$ rabbit dolls are $a_1, a_2 \\dots a_N$. Now she wants to know: under which valid coin sequence, the total number of coins needed to buy these $N$ rabbit dolls is the smallest. No change can be given when buying rabbit dolls.", "inputFormat": "The first line contains an integer $N$, representing the number of rabbit dolls.  \nThe second line contains $N$ integers separated by spaces, representing the prices of the $N$ rabbit dolls.", "outputFormat": "One line containing an integer, representing the minimum number of coins paid.", "hint": "$1 \\leq N \\leq 50$.\n\n$1 \\leq a_i \\leq 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2013] 找硬币", "background": null, "description": "小蛇是金融部部长。最近她决定制造一系列新的货币。假设她要制造的货币的面值为 $x_1,x_2,x_3\\dots$，那么 $x_1$ 必须为 $1$，$x_b$ 必须为 $x_a$ 的正整数倍（$b>a$）。例如 $1,5,125,250$ 就是一组合法的硬币序列，而 $1,5,100,125$ 就不是。不知从哪一天开始，可爱的蛇爱上了一种萌物——兔纸！从此，小蛇便走上了遇上兔纸娃娃就买的不归路。某天，小蛇看到了 $N$ 只可爱的兔纸，假设这 $N$ 只兔纸的价钱分别是 $a_1,a_2\\dots a_N$。现在小蛇想知道，在哪一组合法的硬币序列下，买这 $N$ 只兔纸所需要的硬币数最少。买兔纸时不能找零。", "inputFormat": "第一行，一个整数 $N$，表示兔纸的个数\n第二行，$N$ 个用空格隔开的整数，分别为 $N$ 只兔纸的价钱", "outputFormat": "一行，一个整数，表示最少付的钱币数。", "hint": "$1\\leq N\\leq50$\n\n$1\\leq a_i\\leq10^5$", "locale": "zh-CN"}}}
{"pid": "P5229", "type": "P", "difficulty": 6, "samples": [["1\n0 0 0 1 1 1", "6"], ["2 \n0 1 0 3 2 1\n1 0 0 2 3 1", "22"]], "limits": {"time": [700, 700, 700, 700, 700, 700, 700, 700, 700, 700, 700], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "各省省选", "安徽", "O2优化"], "title": "[AHOI2013] 立方体", "background": "", "description": "在一个三维空间中有 $N$个立方体，第 $i$ 个立方体占据 $x_{i_1},y_{i_1},z_{i_1}$ —— $x_{i_2}, y_{i_2}, z_{i_2}$的位置。这 $N$ 个立方体可能有相交，也可能重叠。他们构成了一个大的几何图形。现在求这个几何图形的外表面积", "inputFormat": "第一行，一个整数 $N$，表示立方体的个数。\n\n第二行至第 $N+1$ 行，每行 $6$ 个用空格隔开的整数，分别表示$x_1$,$y_1$,$z_1$,$x_2$,$y_2$,$z_2$. ", "outputFormat": "一行，一个整数，表示外表面积的大小。", "hint": "所有数据 $\\in~[0,200]$。\n\n$x_1~\\leq~x_2$\n\n$y_1~\\leq~y_2$\n\n$z_1~\\leq~z_2$\n", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2013] Cube", "background": "", "description": "In a three-dimensional space, there are $N$ cubes. The $i$-th cube occupies the region from $(x_{i_1}, y_{i_1}, z_{i_1})$ to $(x_{i_2}, y_{i_2}, z_{i_2})$. These $N$ cubes may intersect or overlap. Together, they form a large geometric shape. Now, find the outer surface area of this shape.", "inputFormat": "The first line contains an integer $N$, representing the number of cubes.\n\nLines $2$ to $N+1$ each contain $6$ integers separated by spaces, representing $x_1$, $y_1$, $z_1$, $x_2$, $y_2$, $z_2$.", "outputFormat": "Output one line containing an integer, representing the outer surface area.", "hint": "All testdata satisfy $\\in~[0,200]$.\n\n$x_1~\\leq~x_2$.\n\n$y_1~\\leq~y_2$.\n\n$z_1~\\leq~z_2$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2013] 立方体", "background": "", "description": "在一个三维空间中有 $N$个立方体，第 $i$ 个立方体占据 $x_{i_1},y_{i_1},z_{i_1}$ —— $x_{i_2}, y_{i_2}, z_{i_2}$的位置。这 $N$ 个立方体可能有相交，也可能重叠。他们构成了一个大的几何图形。现在求这个几何图形的外表面积", "inputFormat": "第一行，一个整数 $N$，表示立方体的个数。\n\n第二行至第 $N+1$ 行，每行 $6$ 个用空格隔开的整数，分别表示$x_1$,$y_1$,$z_1$,$x_2$,$y_2$,$z_2$. ", "outputFormat": "一行，一个整数，表示外表面积的大小。", "hint": "所有数据 $\\in~[0,200]$。\n\n$x_1~\\leq~x_2$\n\n$y_1~\\leq~y_2$\n\n$z_1~\\leq~z_2$\n", "locale": "zh-CN"}}}
{"pid": "P5230", "type": "P", "difficulty": 6, "samples": [["3 \nBBW\nBBW \nBWW ", "5"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2013", "各省省选", "安徽", "O2优化"], "title": "[AHOI2013] 好方的蛇", "background": "", "description": "有一天，可爱的蛇心花怒放，把自己变成了一个正方形！但是她改变的时候\n被induce了导致改变出了些问题.... \n \n按照预设，她应该变成一个 $N*N$ 的全黑正方形，但是这个正方形出现了一些白的格子...现在她的身体不幸出了些小反应，定义一个subsnake是一个至少有两格的全黑矩形。 \n\n![qwq](http://images.cnblogs.com/cnblogs_com/yifusuyi/1229574/o_1(1).jpg)\n\n现在蛇想让你帮忙求一下一共有多少对不相交的subsnake，答案模10007。", "inputFormat": "第一行一个整数 $N$,   接下来 $N$ 行，每行一个长度为 $N$ 的字符串，如果是 $B$，那么是黑的，如果是 $W$ 那么是白的。 ", "outputFormat": "一行一个整数，表示答案", "hint": "$1~\\leq~N~\\leq~1000$", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2013] The Very Square Snake", "background": "", "description": "One day, the cute snake was so happy that she turned herself into a square. But while transforming, she was induced, which caused some problems.\n\nAs planned, she should have become a completely black $N*N$ square, but some white cells appeared in this square. Now her body unfortunately had some small reactions: define a subsnake as an all-black rectangle with at least two cells.\n\n![qwq](http://images.cnblogs.com/cnblogs_com/yifusuyi/1229574/o_1(1).jpg)\n\nNow the snake wants you to help compute how many pairs of disjoint subsnakes there are. Output the answer modulo 10007.", "inputFormat": "The first line contains an integer $N$. Then follow $N$ lines, each a string of length $N$. If a character is $B$, the cell is black; if it is $W$, the cell is white.", "outputFormat": "Output one integer, the answer.", "hint": "$1~\\leq~N~\\leq~1000$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2013] 好方的蛇", "background": "", "description": "有一天，可爱的蛇心花怒放，把自己变成了一个正方形！但是她改变的时候\n被induce了导致改变出了些问题.... \n \n按照预设，她应该变成一个 $N*N$ 的全黑正方形，但是这个正方形出现了一些白的格子...现在她的身体不幸出了些小反应，定义一个subsnake是一个至少有两格的全黑矩形。 \n\n![qwq](http://images.cnblogs.com/cnblogs_com/yifusuyi/1229574/o_1(1).jpg)\n\n现在蛇想让你帮忙求一下一共有多少对不相交的subsnake，答案模10007。", "inputFormat": "第一行一个整数 $N$,   接下来 $N$ 行，每行一个长度为 $N$ 的字符串，如果是 $B$，那么是黑的，如果是 $W$ 那么是白的。 ", "outputFormat": "一行一个整数，表示答案", "hint": "$1~\\leq~N~\\leq~1000$", "locale": "zh-CN"}}}
{"pid": "P5231", "type": "P", "difficulty": 6, "samples": [["7 3\nSNNSSNS\nNNSS\nNNN\nWSEE\n", "4\n2\n0"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["字符串", "2012", "各省省选", "江苏", "后缀自动机 SAM", "O2优化", "AC 自动机", "后缀数组 SA"], "title": "[JSOI2012] 玄武密码", "background": "在美丽的玄武湖畔，鸡鸣寺边，鸡笼山前，有一块富饶而秀美的土地，人们唤作进香河。相传一日，一缕紫气从天而至，只一瞬间便消失在了进香河中。老人们说，这是玄武神灵将天书藏匿在此。 \n\n很多年后，人们终于在进香河地区发现了带有玄武密码的文字。更加神奇的是，这份带有玄武密码的文字，与玄武湖南岸台城的结构有微妙的关联。于是，漫长的破译工作开始了。", "description": " 经过分析，我们可以用东南西北四个方向来描述台城城砖的摆放，不妨用一个长度为 $n$ 的序列 $s$ 来描述，序列中的元素分别是 `E`，`S`，`W`，`N`，代表了东南西北四向，我们称之为母串。而神秘的玄武密码是由四象的图案描述而成的 $m$ 段文字。这里的四象，分别是东之青龙，西之白虎，南之朱雀，北之玄武，对东南西北四向相对应。 \n\n现在，考古工作者遇到了一个难题。对于每一段文字 $t$，求出其最长的前缀 $p$，满足 $p$ 是 $s$ 的子串。", "inputFormat": "第一行有两个整数，分别表示母串的长度 $n$ 和文字段的个数 $m$。\n\n第二行有一个长度为 $n$ 的字符串，表示母串 $s$。\n\n接下来 $m$ 行，每行一个字符串，表示一段带有玄武密码的文字 $t$。", "outputFormat": "对于每段文字，输出一行一个整数，表示最长的 $p$ 的长度。", "hint": "#### 数据规模与约定\n\n- 对于 $20\\%$ 的数据，保证 $n \\leq 100$，$m \\leq 50$。\n- 对于 $40\\%$ 的数据，保证 $n \\leq 2 \\times 10^4$，$m \\leq 2 \\times 10^3$。\n- 对于 $70\\%$ 的数据，保证 $n \\leq 10^6$，$m \\leq 2 \\times 10^4$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 10^7$，$1 \\leq m \\leq 10^5$，$1 \\leq |t| \\leq 100$，$s, t$ 中均只含字母 `E` `S` `W` `N`。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2012] Xuanwu Cipher", "background": "By the beautiful Xuanwu Lake, beside Jiming Temple and in front of Jilong Mountain, there is a rich and beautiful land called Jinxiang River. It is said that one day, a trace of purple aura came down from the sky, and in an instant it disappeared into the Jinxiang River. The elders said that this was the Xuanwu spirit hiding the heavenly book here.\n\nMany years later, people finally found writings with the Xuanwu cipher in the Jinxiang River area. Even more amazingly, these writings with the Xuanwu cipher have a subtle connection with the structure of Taicheng on the south bank of Xuanwu Lake. Thus, the long work of deciphering began.", "description": "After analysis, we can use the four directions east, south, west, and north to describe how the Taicheng bricks are arranged. Let a sequence $s$ of length $n$ describe it, where the elements are `E`, `S`, `W`, `N`, representing the four directions east, south, west, and north. We call this the main string.\n\nThe mysterious Xuanwu cipher is $m$ segments of text described by the patterns of the Four Symbols. The Four Symbols are the Azure Dragon of the east, the White Tiger of the west, the Vermilion Bird of the south, and the Xuanwu of the north, corresponding to the four directions east, south, west, and north.\n\nNow the archaeologists have met a difficult problem. For each text segment $t$, find its longest prefix $p$ such that $p$ is a substring of $s$.", "inputFormat": "The first line contains two integers, representing the length $n$ of the main string and the number $m$ of text segments.\n\nThe second line contains a string of length $n$, representing the main string $s$.\n\nThe next $m$ lines each contain a string, representing a text segment $t$ with the Xuanwu cipher.", "outputFormat": "For each text segment, output one integer per line, representing the length of the longest $p$.", "hint": "#### Constraints\n\n- For $20\\%$ of the data, $n \\leq 100$, $m \\leq 50$.\n- For $40\\%$ of the data, $n \\leq 2 \\times 10^4$, $m \\leq 2 \\times 10^3$.\n- For $70\\%$ of the data, $n \\leq 10^6$, $m \\leq 2 \\times 10^4$.\n- For $100\\%$ of the data, $1 \\leq n \\leq 10^7$, $1 \\leq m \\leq 10^5$, $1 \\leq |t| \\leq 100$, and both $s$ and $t$ contain only the letters `E` `S` `W` `N`.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2012] 玄武密码", "background": "在美丽的玄武湖畔，鸡鸣寺边，鸡笼山前，有一块富饶而秀美的土地，人们唤作进香河。相传一日，一缕紫气从天而至，只一瞬间便消失在了进香河中。老人们说，这是玄武神灵将天书藏匿在此。 \n\n很多年后，人们终于在进香河地区发现了带有玄武密码的文字。更加神奇的是，这份带有玄武密码的文字，与玄武湖南岸台城的结构有微妙的关联。于是，漫长的破译工作开始了。", "description": " 经过分析，我们可以用东南西北四个方向来描述台城城砖的摆放，不妨用一个长度为 $n$ 的序列 $s$ 来描述，序列中的元素分别是 `E`，`S`，`W`，`N`，代表了东南西北四向，我们称之为母串。而神秘的玄武密码是由四象的图案描述而成的 $m$ 段文字。这里的四象，分别是东之青龙，西之白虎，南之朱雀，北之玄武，对东南西北四向相对应。 \n\n现在，考古工作者遇到了一个难题。对于每一段文字 $t$，求出其最长的前缀 $p$，满足 $p$ 是 $s$ 的子串。", "inputFormat": "第一行有两个整数，分别表示母串的长度 $n$ 和文字段的个数 $m$。\n\n第二行有一个长度为 $n$ 的字符串，表示母串 $s$。\n\n接下来 $m$ 行，每行一个字符串，表示一段带有玄武密码的文字 $t$。", "outputFormat": "对于每段文字，输出一行一个整数，表示最长的 $p$ 的长度。", "hint": "#### 数据规模与约定\n\n- 对于 $20\\%$ 的数据，保证 $n \\leq 100$，$m \\leq 50$。\n- 对于 $40\\%$ 的数据，保证 $n \\leq 2 \\times 10^4$，$m \\leq 2 \\times 10^3$。\n- 对于 $70\\%$ 的数据，保证 $n \\leq 10^6$，$m \\leq 2 \\times 10^4$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 10^7$，$1 \\leq m \\leq 10^5$，$1 \\leq |t| \\leq 100$，$s, t$ 中均只含字母 `E` `S` `W` `N`。", "locale": "zh-CN"}}}
{"pid": "P5232", "type": "P", "difficulty": 6, "samples": [["2 3 \n0 0 1 \n1 1 0 \n7 4 \n1 1 7 \n0 2 3 \n0 3 4\t\n1 1 7", "0\n3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2012", "各省省选", "江苏", "O2优化"], "title": "[JSOI2012] 智者的考验", "background": "", "description": "公元$1371$年，太祖下令在北极阁上大建庙宇，短短几年，鸡笼山上便建成了帝王庙、关公庙、真武庙、功臣庙、蒋王庙、都城隍庙、卞壶庙、忠烈庙、刘越王庙、曹武惠王庙共十座庙宇，统称为“十庙”。 \n\n后来，为了方便人们来鸡笼山进香礼佛，太祖下令疏通了鸡笼山下已淤塞多年的潮沟。于是，便有了“进香河”。 \n\n然而并不是所有人都可以来鸡笼山的，太祖在进香河上修建了一座石桥，中间悬挂了一块高$Rx$宽$Ry$的机关格图（如下图所示）。所有格子都是活动可翻转的，一面是白色，一面是黑色，这里我们用$0$表示白色，用$1$表示黑色。初始情况下，所有格子都是白色面朝前的。有$Rx+Ry$个机关按钮，对应$Rx$行和$Ry$列。一个按钮一旦触发，就会引发对应的一行或一列的格子同时翻转。\n \n![](https://cdn.luogu.com.cn/upload/pic/52643.png)\n\n同时，善于识天象的谋臣刘基给出了一种黑白状态，称之为“厄运星”。每一位过往前去鸡笼山的人都需要触发且只触发一个按钮，触发后，如果来访者呈“厄运星”形状，则不允许通过。 \n\n每一天要来鸡笼山的人数$N$是事先就知道的，同时天朝神威浩荡，每一位来者一开始总是有很大概率触发编号为$1$的按钮，我们不妨用数列$A_1$,$A_2$,$\\dots$,$A_N$来表示，问题保证了初始时候的$A$数列全为$1$。同时在整个问题中，$A_i$满足$1 \\leq A_i \\leq Rx+Ry$。太祖很关心那些不允许去鸡笼山的人数。于是他时不时就会询问关于“某一段时间内会有多少人不能通过“厄运星”的考验”。然而那些前来鸡笼山的文人墨客并不愿意如此单一的操作。来访者有可能会突然决定修改自己的触发按钮。更麻烦的情况，结伴而来的连续若干人会突然决定修改触发按钮并且都去触发同一个按钮。 \n\n现在这麻烦的问题交给了你。 ", "inputFormat": "输入文件第一行有$2$个数字$Rx$和$Ry$表示机关格图的高和宽（如图所示）。之后$Rx$行每一行$Ry$个数字，描述了“厄运星”形状，每一个数字都满足非$0$即$1$。 \n\n之后一行有两个数字，分别为$N$和$M$，表示人数和询问修改的次数。 \n\n之后$M$行，对应$M$次询问或修改。每一行先有一个数字$t$： \n\n若$t$为$0$：之后有$2$个数字$d$和$x$，表明将$A_d$修改为$x$。\n \n若$t$为$1$：之后有$2$个数字$l$和$r$，表明询问第$l$个人到第$r$个人中有多少人触发按钮后会出现“厄运星”形状，从而无法通过。\n\n若$t$为$2$：之后有$3$个数字$l$,$r$和$x$，表明将$A_l$,$A_{l+1}$,$\\dots$,$A_{r-1}$,$A_r$都修改为$x$。 ", "outputFormat": "对于每一次询问(即$t$为$1$的情况)，输出单独一行，一个整数描述了在区间$[l,r]$中满足要求的人数。", "hint": "对于$40\\%$的数据，$N \\leq 5000$,$M \\leq 10000$。\n\n存在$70\\%$的数据，$N \\leq 130000$,$M \\leq 30000$。\n\n对于$100\\%$的数据，$N \\leq 1000000$，$M \\leq 120000$，$Rx \\leq 2$，$Ry \\leq 3$。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2012] The Wise One’s Trial", "background": "", "description": "In the year $1371$ AD, the Founding Emperor ordered the construction of large temples on Beijige. In just a few years, ten temples were built on Jilong Mountain: the Imperial Temple, Guan Gong Temple, Zhenwu Temple, Merit Officials Temple, Jiang Wang Temple, Capital City God Temple, Bian Hu Temple, Martyrs Temple, King Liu Yue Temple, and King Cao Wuhui Temple. Together, they were called the “Ten Temples”.\n\nLater, to make it easier for people to come to Jilong Mountain to burn incense and worship, the emperor ordered the clearing of the long-silted tidal ditch at the foot of Jilong Mountain. Thus, the “Incense River” came into being.\n\nHowever, not everyone was allowed to go to Jilong Mountain. The emperor built a stone bridge over the Incense River, and in the middle hung a mechanism grid of height $Rx$ and width $Ry$ (as shown in the figure below). All cells can be flipped; one side is white and the other side is black. Here we use $0$ to represent white and $1$ to represent black. Initially, all cells show the white side. There are $Rx+Ry$ mechanism buttons corresponding to the $Rx$ rows and the $Ry$ columns. Once a button is triggered, the cells in the corresponding row or column are flipped simultaneously.\n\n![](https://cdn.luogu.com.cn/upload/pic/52643.png)\n\nMeanwhile, the strategist Liu Ji, who was good at observing celestial phenomena, provided a black-and-white pattern called the “Misfortune Star”. Each person passing by and heading to Jilong Mountain must trigger exactly one button. After triggering, if the resulting pattern matches the “Misfortune Star”, the visitor is not allowed to pass.\n\nThe number of people coming to Jilong Mountain each day is known in advance and is $N$. Also, since the empire’s power is overwhelming, each visitor at the beginning always has a high probability of triggering button number $1$. We use a sequence $A_1, A_2, \\dots, A_N$ to represent this, and it is guaranteed that initially all elements of $A$ are $1$. Throughout the problem, $A_i$ satisfies $1 \\leq A_i \\leq Rx+Ry$. The emperor cares a lot about how many people are not allowed to go to Jilong Mountain. So from time to time, he asks: “During a certain period of time, how many people cannot pass the ‘Misfortune Star’ trial?”. However, the scholars and poets coming to Jilong Mountain do not want such a single kind of operation. A visitor may suddenly decide to change the button they will trigger. In an even more troublesome case, several consecutive people traveling together may suddenly decide to change their buttons and all trigger the same button.\n\nNow this troublesome problem is handed over to you.", "inputFormat": "The first line contains two integers $Rx$ and $Ry$, representing the height and width of the mechanism grid (as shown in the figure). Then follow $Rx$ lines, each containing $Ry$ digits, describing the “Misfortune Star” pattern. Each digit is either $0$ or $1$.\n\nThe next line contains two integers $N$ and $M$, representing the number of people and the number of queries/modifications.\n\nThen follow $M$ lines, each corresponding to one query or modification. Each line starts with an integer $t$:\n\nIf $t$ is $0$: then two integers $d$ and $x$ follow, meaning set $A_d$ to $x$.\n\nIf $t$ is $1$: then two integers $l$ and $r$ follow, meaning query how many people from the $l$-th to the $r$-th person will produce the “Misfortune Star” pattern after triggering their button, and thus cannot pass.\n\nIf $t$ is $2$: then three integers $l$, $r$, and $x$ follow, meaning set $A_l, A_{l+1}, \\dots, A_{r-1}, A_r$ all to $x$.", "outputFormat": "For each query (i.e., the case $t$ is $1$), output a single line containing one integer, describing the number of people in the interval $[l, r]$ that meet the requirement.", "hint": "For $40\\%$ of the testdata, $N \\leq 5000$, $M \\leq 10000$.\n\nFor $70\\%$ of the testdata, $N \\leq 130000$, $M \\leq 30000$.\n\nFor $100\\%$ of the testdata, $N \\leq 1000000$, $M \\leq 120000$, $Rx \\leq 2$, $Ry \\leq 3$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2012] 智者的考验", "background": "", "description": "公元$1371$年，太祖下令在北极阁上大建庙宇，短短几年，鸡笼山上便建成了帝王庙、关公庙、真武庙、功臣庙、蒋王庙、都城隍庙、卞壶庙、忠烈庙、刘越王庙、曹武惠王庙共十座庙宇，统称为“十庙”。 \n\n后来，为了方便人们来鸡笼山进香礼佛，太祖下令疏通了鸡笼山下已淤塞多年的潮沟。于是，便有了“进香河”。 \n\n然而并不是所有人都可以来鸡笼山的，太祖在进香河上修建了一座石桥，中间悬挂了一块高$Rx$宽$Ry$的机关格图（如下图所示）。所有格子都是活动可翻转的，一面是白色，一面是黑色，这里我们用$0$表示白色，用$1$表示黑色。初始情况下，所有格子都是白色面朝前的。有$Rx+Ry$个机关按钮，对应$Rx$行和$Ry$列。一个按钮一旦触发，就会引发对应的一行或一列的格子同时翻转。\n \n![](https://cdn.luogu.com.cn/upload/pic/52643.png)\n\n同时，善于识天象的谋臣刘基给出了一种黑白状态，称之为“厄运星”。每一位过往前去鸡笼山的人都需要触发且只触发一个按钮，触发后，如果来访者呈“厄运星”形状，则不允许通过。 \n\n每一天要来鸡笼山的人数$N$是事先就知道的，同时天朝神威浩荡，每一位来者一开始总是有很大概率触发编号为$1$的按钮，我们不妨用数列$A_1$,$A_2$,$\\dots$,$A_N$来表示，问题保证了初始时候的$A$数列全为$1$。同时在整个问题中，$A_i$满足$1 \\leq A_i \\leq Rx+Ry$。太祖很关心那些不允许去鸡笼山的人数。于是他时不时就会询问关于“某一段时间内会有多少人不能通过“厄运星”的考验”。然而那些前来鸡笼山的文人墨客并不愿意如此单一的操作。来访者有可能会突然决定修改自己的触发按钮。更麻烦的情况，结伴而来的连续若干人会突然决定修改触发按钮并且都去触发同一个按钮。 \n\n现在这麻烦的问题交给了你。 ", "inputFormat": "输入文件第一行有$2$个数字$Rx$和$Ry$表示机关格图的高和宽（如图所示）。之后$Rx$行每一行$Ry$个数字，描述了“厄运星”形状，每一个数字都满足非$0$即$1$。 \n\n之后一行有两个数字，分别为$N$和$M$，表示人数和询问修改的次数。 \n\n之后$M$行，对应$M$次询问或修改。每一行先有一个数字$t$： \n\n若$t$为$0$：之后有$2$个数字$d$和$x$，表明将$A_d$修改为$x$。\n \n若$t$为$1$：之后有$2$个数字$l$和$r$，表明询问第$l$个人到第$r$个人中有多少人触发按钮后会出现“厄运星”形状，从而无法通过。\n\n若$t$为$2$：之后有$3$个数字$l$,$r$和$x$，表明将$A_l$,$A_{l+1}$,$\\dots$,$A_{r-1}$,$A_r$都修改为$x$。 ", "outputFormat": "对于每一次询问(即$t$为$1$的情况)，输出单独一行，一个整数描述了在区间$[l,r]$中满足要求的人数。", "hint": "对于$40\\%$的数据，$N \\leq 5000$,$M \\leq 10000$。\n\n存在$70\\%$的数据，$N \\leq 130000$,$M \\leq 30000$。\n\n对于$100\\%$的数据，$N \\leq 1000000$，$M \\leq 120000$，$Rx \\leq 2$，$Ry \\leq 3$。", "locale": "zh-CN"}}}
{"pid": "P5233", "type": "P", "difficulty": 6, "samples": [["10 5 4", "1398595"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["数学", "2012", "各省省选", "数论", "江苏", "O2优化", "群论", "置换", "Pólya 定理"], "title": "[JSOI2012] 爱之项链", "background": null, "description": "在进香河，流传着这样一段美丽的故事。zyg 与 kzn 是两个生活在进香河的孩子，一天，他们两人闹矛盾了，于是 zyg 送给了 kzn 一条精美的爱之项链。从此他们幸福生活在一起。\n\n这则故事的真实性到今天已经没有意义了，然而我们关注的是那一条精美的爱之项链。这是一条由 $N$ 个精致的戒指与一块特殊纪念品相连而成的环形，如下图中的爱心符号正是一种特殊纪念品（据说是 2012 年情人节时 zyg 特意托人订制的）。上面的每一枚戒指又是由 $M$ 个带磁性的特殊彩色球状物组成的环形。也许你会认为，这所谓的戒指，更像是一条条小项链。\n\n下图给出了一种可行的方案，其中左边描述的是单一的一枚戒指，右图描述的是项链。\n\n![](https://cdn.luogu.com.cn/upload/pic/52648.png) \n\n这里，所有带磁性的特殊彩色球状物的颜色只有 $R$ 种，这里我们用 $1$ 到 $R$ 来表示。如果一枚戒指可以通过顺时针或逆时针的旋转后与另外一枚戒指相同，则认为这是两枚相同的戒指。 \n\n对于一条爱之项链，要求满足任何相邻两枚戒指必须是不相同的。同时，特殊纪念品左右两枚戒指也必须是不同的。 \n\n现在给定 $N$，$M$ 和 $R$，问究竟有多少种不同的爱之项链。 \n\n注意： \n\n1. 特殊纪念品的插入位置不同，也许会得到不同的爱之项链。\n 2. 这里我们只考虑旋转后是否相同，不考虑翻转操作，这一点不论是对于每一枚戒指，还是对于整条项链，都是这样的。", "inputFormat": "一行，三个正整数，分别是 $N$，$M$ 和 $R$。", "outputFormat": "一行，表示有多少种不同的爱之项链。你只需要将答案模 $3214567$。", "hint": "对于 $30\\%$ 的数据，$2\\leq N \\leq 10^3$，$M \\leq 3 \\times 10^2$，$R \\leq 10^2$。\n\n对于 $60\\%$ 的数据，$2\\leq N \\leq 3 \\times 10^4$，$M \\leq 2 \\times 10^3$，$R \\leq 10^5$。\n\n对于 $80\\%$ 的数据，$2\\leq N \\leq 10^7$，$M \\leq 10^6$，$R \\leq 10^6$。\n\n对于 $100\\%$ 的数据，$2\\leq N \\leq 10^{15}$，$M \\leq 10^9$，$R \\leq 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2012] Necklace of Love", "background": "", "description": "In Jingxiang River, there is a beautiful story. zyg and kzn are two children who live in Jingxiang River. One day, they had a quarrel, so zyg gave kzn an exquisite Necklace of Love. From then on, they lived happily together.\n\nWhether this story is true no longer matters today. What we care about is that exquisite Necklace of Love. It is a ring formed by connecting $N$ delicate rings and one special souvenir, as shown below. The heart symbol in the picture is one kind of special souvenir (it is said that zyg specially asked someone to customize it for Valentine’s Day in 2012). Each ring above is itself a ring made of $M$ magnetic special colored spherical objects. You may think that these so-called rings look more like small necklaces.\n\nThe picture below shows one feasible design. The left picture describes a single ring, and the right picture describes the whole necklace.\n\n![](https://cdn.luogu.com.cn/upload/pic/52648.png)\n\nHere, the magnetic special colored spherical objects have only $R$ possible colors, denoted by $1$ to $R$. If one ring can become identical to another ring by rotating it clockwise or counterclockwise, then these two rings are considered the same.\n\nFor a Necklace of Love, any two adjacent rings must be different. Also, the two rings on the left and right of the special souvenir must be different.\n\nNow given $N$, $M$, and $R$, determine how many different Necklaces of Love there are.\n\nNote:\n\n1. Different insertion positions of the special souvenir may produce different Necklaces of Love.\n2. Here we only consider whether they are the same under rotation, and we do not consider flipping. This applies both to each ring and to the whole necklace.", "inputFormat": "One line with three positive integers: $N$, $M$, and $R$.", "outputFormat": "One line, the number of different Necklaces of Love. You only need to output the answer modulo $3214567$.", "hint": "For $30\\%$ of the testdata, $2\\leq N \\leq 10^3$, $M \\leq 3 \\times 10^2$, $R \\leq 10^2$.\n\nFor $60\\%$ of the testdata, $2\\leq N \\leq 3 \\times 10^4$, $M \\leq 2 \\times 10^3$, $R \\leq 10^5$.\n\nFor $80\\%$ of the testdata, $2\\leq N \\leq 10^7$, $M \\leq 10^6$, $R \\leq 10^6$.\n\nFor $100\\%$ of the testdata, $2\\leq N \\leq 10^{15}$, $M \\leq 10^9$, $R \\leq 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2012] 爱之项链", "background": null, "description": "在进香河，流传着这样一段美丽的故事。zyg 与 kzn 是两个生活在进香河的孩子，一天，他们两人闹矛盾了，于是 zyg 送给了 kzn 一条精美的爱之项链。从此他们幸福生活在一起。\n\n这则故事的真实性到今天已经没有意义了，然而我们关注的是那一条精美的爱之项链。这是一条由 $N$ 个精致的戒指与一块特殊纪念品相连而成的环形，如下图中的爱心符号正是一种特殊纪念品（据说是 2012 年情人节时 zyg 特意托人订制的）。上面的每一枚戒指又是由 $M$ 个带磁性的特殊彩色球状物组成的环形。也许你会认为，这所谓的戒指，更像是一条条小项链。\n\n下图给出了一种可行的方案，其中左边描述的是单一的一枚戒指，右图描述的是项链。\n\n![](https://cdn.luogu.com.cn/upload/pic/52648.png) \n\n这里，所有带磁性的特殊彩色球状物的颜色只有 $R$ 种，这里我们用 $1$ 到 $R$ 来表示。如果一枚戒指可以通过顺时针或逆时针的旋转后与另外一枚戒指相同，则认为这是两枚相同的戒指。 \n\n对于一条爱之项链，要求满足任何相邻两枚戒指必须是不相同的。同时，特殊纪念品左右两枚戒指也必须是不同的。 \n\n现在给定 $N$，$M$ 和 $R$，问究竟有多少种不同的爱之项链。 \n\n注意： \n\n1. 特殊纪念品的插入位置不同，也许会得到不同的爱之项链。\n 2. 这里我们只考虑旋转后是否相同，不考虑翻转操作，这一点不论是对于每一枚戒指，还是对于整条项链，都是这样的。", "inputFormat": "一行，三个正整数，分别是 $N$，$M$ 和 $R$。", "outputFormat": "一行，表示有多少种不同的爱之项链。你只需要将答案模 $3214567$。", "hint": "对于 $30\\%$ 的数据，$2\\leq N \\leq 10^3$，$M \\leq 3 \\times 10^2$，$R \\leq 10^2$。\n\n对于 $60\\%$ 的数据，$2\\leq N \\leq 3 \\times 10^4$，$M \\leq 2 \\times 10^3$，$R \\leq 10^5$。\n\n对于 $80\\%$ 的数据，$2\\leq N \\leq 10^7$，$M \\leq 10^6$，$R \\leq 10^6$。\n\n对于 $100\\%$ 的数据，$2\\leq N \\leq 10^{15}$，$M \\leq 10^9$，$R \\leq 10^6$。", "locale": "zh-CN"}}}
{"pid": "P5234", "type": "P", "difficulty": 6, "samples": [["3 2\n1 2 1\n2 3 2", "-1"], ["4 3\n1 2 1\n1 3 2\n1 4 3", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2012", "各省省选", "江苏", "O2优化"], "title": "[JSOI2012] 越狱老虎桥", "background": "这里，是美丽的南京；这里，是秀美的进香河；这里是安逸的老虎桥。 \n\n如果说进香河的美，美在其秀美的风光，倒不如说是美在了那惬意的南京古典小巷式生活。如果说进香河的迷人，在其淳朴的民风，倒不如说是那被历史掩埋了的秘密吸引着人们好奇的心。 \n\n也许很多人都还记得，老虎桥监狱，北洋时期江南最大的监狱，在近一个世纪中，面对满清、北洋、民国、新中国几朝兴衰，名称屡次更替，沧桑尽显其中。 \n\n现在的人们，恐怕很难相信，到底有多少惊心动魄的事情曾经就在这里上演。 ", "description": "那是$1948$年的冬天，南京地下组织的一支小分队决定偷袭老虎桥监狱，救出被困的数百名人员。那时的老虎桥监狱，被$N$层电网围了起来，由内而外，依次编号为$1$,$2$,$\\dots$,$N$。第$1$层电网接有高压电。有$M$条高压线，连接了所有电网，其中第$i$条高压线连接了第$a_i$和$b_i$层电网，如果要破坏第$i$条高压线，需要至少动用$T_i$位特工。面对这么多层电网，偷袭小分队犯愁了。至少需要破坏一层电网，否则是无法偷袭成功的。\n \n然而，狡猾的间谍却知道了这件事情，为了破坏偷袭计划，敌人秘密地又增加了一条高压线，不让偷袭小分队的成员发现。 \n\n为了能够偷袭成功，不论新增的这一条秘密高压线是连接哪两层电网的，小分队都必须要破坏且仅破坏一条高压线，使得至少有一层电网不通电。注意，对于新增的高压线，我们并不知道需要多少位特工才能成功破坏。现在的问题是，偷袭小分队至少需要多少名特工呢？\n \n决战就在今夜！", "inputFormat": "第一行有$2$个整数，$N$和$M$，分别表示电网层数和高压线个数。 \n之后$M$行，每行$3$个整数，分别是$a_i$,$b_i$和$T_i$。", "outputFormat": "输出只有一行，包含一个整数，表示最少需要动用的特工人数。 \n如果计划必然失败，则输出$-1$。", "hint": "对于$30\\%$的数据，$N \\leq 200$，$M \\leq 250$。\n\n对于$70\\%$的数据，$N \\leq 50000$，$M \\leq 100000$。\n\n对于$100\\%$的数据，$N \\leq 500000$，$M \\leq 1000000$，$T \\leq 100000$。\n\n对于第二组样例，新增的高压线只有可能出现在$2$和$3$，$2$和$4$或$3$和$4$之间。\n\n如果出现在了$2$和$3$之间，则只能破坏$1$和$4$之间的高压线；如果出现在$2$和$4$之间，则只能破坏$1$和$3$之间的高压线；如果出现在$3$和$4$之间，则只能破坏$1$和$2$之间的高压线。\n\n所以，至少需要出动$3$位特工，才能应付所有可能情况。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2012] Prison Break: Laohuqiao", "background": "This is beautiful Nanjing. This is the graceful Jinxiang River. This is the cozy Laohuqiao.\n\nIf we say the beauty of the Jinxiang River lies in its pleasant scenery, it is better to say it lies in the relaxed, old-classical-alley style of life in Nanjing. If we say the Jinxiang River is charming because of its simple folk customs, it is better to say it is the secrets buried by history that attract people’s curiosity.\n\nPerhaps many people still remember Laohuqiao Prison, the largest prison in Jiangnan during the Beiyang period. Over nearly a century, through the rise and fall of several eras such as the Late Qing, Beiyang, the Republic of China, and New China, its name changed again and again, showing all its vicissitudes.\n\nPeople today may find it hard to believe how many thrilling events once took place right here.", "description": "It was the winter of $1948$. A small team from an underground organization in Nanjing decided to raid Laohuqiao Prison to rescue several hundred trapped people. At that time, Laohuqiao Prison was surrounded by $N$ layers of power grids, numbered from inside to outside as $1, 2, \\dots, N$. The $1$st layer of the power grid was connected to high-voltage electricity. There were $M$ high-voltage wires connecting all the grids. The $i$-th wire connected the $a_i$-th and $b_i$-th layers, and to destroy the $i$-th wire, at least $T_i$ agents were needed. Facing so many layers of grids, the raiding team was troubled. They must destroy at least one layer of the power grid, otherwise the raid cannot succeed.\n\nHowever, a cunning spy learned about this. To sabotage the raid plan, the enemy secretly added one more high-voltage wire without letting the team members discover it.\n\nTo ensure success, no matter which two layers this newly added secret high-voltage wire connects, the team must destroy exactly one high-voltage wire so that at least one layer of the power grid becomes unpowered. Note that for the newly added wire, we do not know how many agents are needed to destroy it successfully. The question is: what is the minimum number of agents the team must have?\n\nThe decisive battle is tonight!", "inputFormat": "The first line contains $2$ integers, $N$ and $M$, representing the number of grid layers and the number of high-voltage wires.\n\nThe next $M$ lines each contain $3$ integers: $a_i$, $b_i$, and $T_i$.", "outputFormat": "Output only one line containing one integer, which is the minimum number of agents needed.\n\nIf the plan is bound to fail, output $-1$.", "hint": "For $30\\%$ of the testdata, $N \\leq 200$, $M \\leq 250$.\n\nFor $70\\%$ of the testdata, $N \\leq 50000$, $M \\leq 100000$.\n\nFor $100\\%$ of the testdata, $N \\leq 500000$, $M \\leq 1000000$, $T \\leq 100000$.\n\nFor the second sample, the newly added high-voltage wire can only appear between $2$ and $3$, between $2$ and $4$, or between $3$ and $4$.\n\nIf it appears between $2$ and $3$, then the only wire that can be destroyed is the one between $1$ and $4$. If it appears between $2$ and $4$, then the only wire that can be destroyed is the one between $1$ and $3$. If it appears between $3$ and $4$, then the only wire that can be destroyed is the one between $1$ and $2$.\n\nTherefore, at least $3$ agents are needed to handle all possible cases.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2012] 越狱老虎桥", "background": "这里，是美丽的南京；这里，是秀美的进香河；这里是安逸的老虎桥。 \n\n如果说进香河的美，美在其秀美的风光，倒不如说是美在了那惬意的南京古典小巷式生活。如果说进香河的迷人，在其淳朴的民风，倒不如说是那被历史掩埋了的秘密吸引着人们好奇的心。 \n\n也许很多人都还记得，老虎桥监狱，北洋时期江南最大的监狱，在近一个世纪中，面对满清、北洋、民国、新中国几朝兴衰，名称屡次更替，沧桑尽显其中。 \n\n现在的人们，恐怕很难相信，到底有多少惊心动魄的事情曾经就在这里上演。 ", "description": "那是$1948$年的冬天，南京地下组织的一支小分队决定偷袭老虎桥监狱，救出被困的数百名人员。那时的老虎桥监狱，被$N$层电网围了起来，由内而外，依次编号为$1$,$2$,$\\dots$,$N$。第$1$层电网接有高压电。有$M$条高压线，连接了所有电网，其中第$i$条高压线连接了第$a_i$和$b_i$层电网，如果要破坏第$i$条高压线，需要至少动用$T_i$位特工。面对这么多层电网，偷袭小分队犯愁了。至少需要破坏一层电网，否则是无法偷袭成功的。\n \n然而，狡猾的间谍却知道了这件事情，为了破坏偷袭计划，敌人秘密地又增加了一条高压线，不让偷袭小分队的成员发现。 \n\n为了能够偷袭成功，不论新增的这一条秘密高压线是连接哪两层电网的，小分队都必须要破坏且仅破坏一条高压线，使得至少有一层电网不通电。注意，对于新增的高压线，我们并不知道需要多少位特工才能成功破坏。现在的问题是，偷袭小分队至少需要多少名特工呢？\n \n决战就在今夜！", "inputFormat": "第一行有$2$个整数，$N$和$M$，分别表示电网层数和高压线个数。 \n之后$M$行，每行$3$个整数，分别是$a_i$,$b_i$和$T_i$。", "outputFormat": "输出只有一行，包含一个整数，表示最少需要动用的特工人数。 \n如果计划必然失败，则输出$-1$。", "hint": "对于$30\\%$的数据，$N \\leq 200$，$M \\leq 250$。\n\n对于$70\\%$的数据，$N \\leq 50000$，$M \\leq 100000$。\n\n对于$100\\%$的数据，$N \\leq 500000$，$M \\leq 1000000$，$T \\leq 100000$。\n\n对于第二组样例，新增的高压线只有可能出现在$2$和$3$，$2$和$4$或$3$和$4$之间。\n\n如果出现在了$2$和$3$之间，则只能破坏$1$和$4$之间的高压线；如果出现在$2$和$4$之间，则只能破坏$1$和$3$之间的高压线；如果出现在$3$和$4$之间，则只能破坏$1$和$2$之间的高压线。\n\n所以，至少需要出动$3$位特工，才能应付所有可能情况。", "locale": "zh-CN"}}}
{"pid": "P5235", "type": "P", "difficulty": 7, "samples": [["5 6 3\n2 1\n4 5\n3 5\n3 4\n2 3\n1 3\n1 2 3 4 0\n0 1 2 3 4\n2 1 0 4 3\n4 3 0 1 2", "Yes\nYes\nNo"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000]}, "tags": ["2017", "WC"], "title": "[WC2017] 棋盘", "background": "", "description": "小 Z 在一块棋盘上玩游戏。这块棋盘是一个由 $n$ 个顶点和 $m$ 条边组成的无向连通图，图上的顶点编号为 $[1,n]$ 中的正整数。游戏开始时，每个顶点上都放有一个棋子，每个棋子上有一个 $[0,n-1]$ 中的整数，表示棋子的编号。不同棋子的编号互不相同。\n\n每次操作时，小 Z 需要先选择棋盘上的一条边，这条边的一个端点此时放有 $0$ 号棋子。然后，小 Z 将这条边两个端点上的棋子交换。\n\n现在你已经知道棋盘的模样，以及初始状态下每个顶点上的棋子编号。小 Z 想请你回答 $q$ 个询问。每个询问指定了棋盘的目标状态，你需要回答能否通过若干次操作，将棋盘由初始状态变为这个目标状态。", "inputFormat": "第一行输入三个正整数 $n,m,q$，分别表示图中的顶点数、边数，以及询问的个数。\n\n接下来 $m$ 行，每行两个整数 $u,v(1\\leq u,v\\leq n)$，表示图中有一条连接 $u,v$ 两顶点的无向边。保证 $u\\neq v$，即图中不存在自环。保证给出的图是连通图，即任意两个顶点都可以经过若干条边而相互到达。\n\n接下来一行有$n$ 个空格隔开的整数，其中第$i$ 个整数表示初始状态下 $i$ 号顶点上的棋子的编号，保证编号都为 $[0,n-1]$ 中的整数，且两两不同。\n\n接下来 $q$ 行，每行有 $n$ 个空格隔开的整数，表示一个询问，其中第 $i$ 个整数表示目标状态中第 ii 号顶点上的棋子的编号，保证编号都为 $[0,n-1]$ 中的整数，且两两不同。", "outputFormat": "输出 $q$ 行，每行一个字符串 ```Yes``` 或者 ```No``` 作为回答。```Yes``` 表示从棋子的初始状态可以经过若干次操作而达到询问中所指定的目标状态，```No``` 表示不存在这样的操作步骤。注意：```Yes``` 和 ```No``` 的首字母都是大写的。", "hint": "样例如图所示:\n\n![](http://img.uoj.ac/problem/287/sample.jpg)\n\n对于第一组询问，只要将 $0$ 号点沿着 $5-4-3-2-1$ 的路径移动。对于第二组询问，将 $0$ 号点沿着 $5-3-1-2-3$ 移动。对于第三组询问是无解的。\n\n所有数据均满足：$1 \\leq n \\leq 50$，$1 \\leq m \\leq 100$，$1 \\leq q \\leq 1000$。\n\n| 测试点编号 | $n$       | $m$         | 数据特性 |\n| :-----: | :---------: | :-----------: | :----: |\n| 1     | $\\leq 8$ | $\\leq 15$  | 无    |\n| 2     | $\\leq 8$  | $ = n-1 $   | 无    |\n| 3     | $\\leq 50$ | $ = n-1 $   | 无    |\n| 4     | $\\leq 50$ | $ =n $      | 无    |\n| 5     | $\\leq 50$ | $ =n $      | 特性 1  |\n| 6     | $\\leq 50$ | $ =n $      | 特性 1  |\n| 7     | $\\leq 50$ | $ =n $      | 无    |\n| 8     | $\\leq 50$ | $ =n $      | 无    |\n| 9     | $\\leq 50$ | $ \\leq 100$ | 特性 2  |\n| 10    | $\\leq 50$ | $ \\leq 100$ | 特性 2  |\n| 11    | $\\leq 50$ | $ \\leq 100$ | 特性 3  |\n| 12    | $\\leq 50$ | $ \\leq 100$ | 特性 3  |\n| 13    | $\\leq 50$ | $ \\leq 100$ | 特性 3  |\n| 14    | $\\leq 50$ | $ \\leq 100$ | 无    |\n| 15    | $\\leq 50$ | $ \\leq 100$ | 无    |\n| 16    | $\\leq 50$ | $ \\leq 100$ | 无    |\n| 17    | $\\leq 50$ | $ \\leq 100$ | 无    |\n| 18    | $\\leq 50$ | $ \\leq 100$ | 无    |\n| 19    | $\\leq 50$ | $ \\leq 100$ | 无    |\n| 20    | $\\leq 50$ | $ \\leq 100$ | 无    |\n\n- 特性 1：所有顶点的度数均为 $2$。\n- 特性 2：这个棋盘可以绘制在一个 $k \\times k$ 的矩形网格图上。其中 $k \\times k=n$ 且 $2k \\times (k-1)=m$。\n- 特性 3：每条边至多属于一个简单环。", "locale": "zh-CN", "translations": {"en": {"title": "[WC2017] Chessboard.", "background": "", "description": "Xiao Z is playing a game on a chessboard. This chessboard is an undirected connected graph with $n$ vertices and $m$ edges. The vertices are labeled with positive integers in $[1,n]$. At the beginning of the game, each vertex has one piece placed on it. Each piece has an integer in $[0,n-1]$, representing the piece’s label. All piece labels are distinct.\n\nIn each operation, Xiao Z must first choose an edge of the graph such that one endpoint of this edge currently has the piece labeled $0$. Then, Xiao Z swaps the pieces on the two endpoints of this edge.\n\nNow you are given the graph (the chessboard) and the initial label of the piece on each vertex. Xiao Z asks you to answer $q$ queries. Each query specifies a target state of the chessboard. You need to determine whether it is possible, using some number of operations, to transform the chessboard from the initial state into the target state.", "inputFormat": "The first line contains three positive integers $n,m,q$, representing the number of vertices, the number of edges, and the number of queries.\n\nThe next $m$ lines each contain two integers $u,v(1\\leq u,v\\leq n)$, indicating an undirected edge connecting vertices $u$ and $v$. It is guaranteed that $u\\neq v$, so there are no self-loops. It is guaranteed that the given graph is connected, i.e., any two vertices can reach each other through some edges.\n\nThe next line contains $n$ space-separated integers. The $i$-th integer denotes the label of the piece on vertex $i$ in the initial state. It is guaranteed that all labels are integers in $[0,n-1]$ and are pairwise distinct.\n\nThe next $q$ lines each contain $n$ space-separated integers describing one query. The $i$-th integer denotes the label of the piece on vertex $i$ in the target state. It is guaranteed that all labels are integers in $[0,n-1]$ and are pairwise distinct.", "outputFormat": "Output $q$ lines. Each line contains a string ```Yes``` or ```No```. ```Yes``` means the target state in the query can be reached from the initial state using some number of operations, and ```No``` means it is impossible. Note that the first letter of both ```Yes``` and ```No``` is uppercase.", "hint": "The samples are shown in the figure:\n\n![](http://img.uoj.ac/problem/287/sample.jpg)\n\nFor the first query, it is enough to move the piece labeled $0$ along the path $5-4-3-2-1$. For the second query, move the piece labeled $0$ along $5-3-1-2-3$. The third query has no solution.\n\nAll testdata satisfy: $1 \\leq n \\leq 50$, $1 \\leq m \\leq 100$, $1 \\leq q \\leq 1000$.\n\n| Test Point ID | $n$       | $m$         | Data Property |\n| :-----: | :---------: | :-----------: | :----: |\n| 1     | $\\leq 8$ | $\\leq 15$  | None    |\n| 2     | $\\leq 8$  | $ = n-1 $   | None    |\n| 3     | $\\leq 50$ | $ = n-1 $   | None    |\n| 4     | $\\leq 50$ | $ =n $      | None    |\n| 5     | $\\leq 50$ | $ =n $      | Property 1  |\n| 6     | $\\leq 50$ | $ =n $      | Property 1  |\n| 7     | $\\leq 50$ | $ =n $      | None    |\n| 8     | $\\leq 50$ | $ =n $      | None    |\n| 9     | $\\leq 50$ | $ \\leq 100$ | Property 2  |\n| 10    | $\\leq 50$ | $ \\leq 100$ | Property 2  |\n| 11    | $\\leq 50$ | $ \\leq 100$ | Property 3  |\n| 12    | $\\leq 50$ | $ \\leq 100$ | Property 3  |\n| 13    | $\\leq 50$ | $ \\leq 100$ | Property 3  |\n| 14    | $\\leq 50$ | $ \\leq 100$ | None    |\n| 15    | $\\leq 50$ | $ \\leq 100$ | None    |\n| 16    | $\\leq 50$ | $ \\leq 100$ | None    |\n| 17    | $\\leq 50$ | $ \\leq 100$ | None    |\n| 18    | $\\leq 50$ | $ \\leq 100$ | None    |\n| 19    | $\\leq 50$ | $ \\leq 100$ | None    |\n| 20    | $\\leq 50$ | $ \\leq 100$ | None    |\n\n- Property 1: The degree of every vertex is $2$.\n- Property 2: This chessboard can be drawn on a $k \\times k$ rectangular grid graph, where $k \\times k=n$ and $2k \\times (k-1)=m$.\n- Property 3: Each edge belongs to at most one simple cycle.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[WC2017] 棋盘", "background": "", "description": "小 Z 在一块棋盘上玩游戏。这块棋盘是一个由 $n$ 个顶点和 $m$ 条边组成的无向连通图，图上的顶点编号为 $[1,n]$ 中的正整数。游戏开始时，每个顶点上都放有一个棋子，每个棋子上有一个 $[0,n-1]$ 中的整数，表示棋子的编号。不同棋子的编号互不相同。\n\n每次操作时，小 Z 需要先选择棋盘上的一条边，这条边的一个端点此时放有 $0$ 号棋子。然后，小 Z 将这条边两个端点上的棋子交换。\n\n现在你已经知道棋盘的模样，以及初始状态下每个顶点上的棋子编号。小 Z 想请你回答 $q$ 个询问。每个询问指定了棋盘的目标状态，你需要回答能否通过若干次操作，将棋盘由初始状态变为这个目标状态。", "inputFormat": "第一行输入三个正整数 $n,m,q$，分别表示图中的顶点数、边数，以及询问的个数。\n\n接下来 $m$ 行，每行两个整数 $u,v(1\\leq u,v\\leq n)$，表示图中有一条连接 $u,v$ 两顶点的无向边。保证 $u\\neq v$，即图中不存在自环。保证给出的图是连通图，即任意两个顶点都可以经过若干条边而相互到达。\n\n接下来一行有$n$ 个空格隔开的整数，其中第$i$ 个整数表示初始状态下 $i$ 号顶点上的棋子的编号，保证编号都为 $[0,n-1]$ 中的整数，且两两不同。\n\n接下来 $q$ 行，每行有 $n$ 个空格隔开的整数，表示一个询问，其中第 $i$ 个整数表示目标状态中第 ii 号顶点上的棋子的编号，保证编号都为 $[0,n-1]$ 中的整数，且两两不同。", "outputFormat": "输出 $q$ 行，每行一个字符串 ```Yes``` 或者 ```No``` 作为回答。```Yes``` 表示从棋子的初始状态可以经过若干次操作而达到询问中所指定的目标状态，```No``` 表示不存在这样的操作步骤。注意：```Yes``` 和 ```No``` 的首字母都是大写的。", "hint": "样例如图所示:\n\n![](http://img.uoj.ac/problem/287/sample.jpg)\n\n对于第一组询问，只要将 $0$ 号点沿着 $5-4-3-2-1$ 的路径移动。对于第二组询问，将 $0$ 号点沿着 $5-3-1-2-3$ 移动。对于第三组询问是无解的。\n\n所有数据均满足：$1 \\leq n \\leq 50$，$1 \\leq m \\leq 100$，$1 \\leq q \\leq 1000$。\n\n| 测试点编号 | $n$       | $m$         | 数据特性 |\n| :-----: | :---------: | :-----------: | :----: |\n| 1     | $\\leq 8$ | $\\leq 15$  | 无    |\n| 2     | $\\leq 8$  | $ = n-1 $   | 无    |\n| 3     | $\\leq 50$ | $ = n-1 $   | 无    |\n| 4     | $\\leq 50$ | $ =n $      | 无    |\n| 5     | $\\leq 50$ | $ =n $      | 特性 1  |\n| 6     | $\\leq 50$ | $ =n $      | 特性 1  |\n| 7     | $\\leq 50$ | $ =n $      | 无    |\n| 8     | $\\leq 50$ | $ =n $      | 无    |\n| 9     | $\\leq 50$ | $ \\leq 100$ | 特性 2  |\n| 10    | $\\leq 50$ | $ \\leq 100$ | 特性 2  |\n| 11    | $\\leq 50$ | $ \\leq 100$ | 特性 3  |\n| 12    | $\\leq 50$ | $ \\leq 100$ | 特性 3  |\n| 13    | $\\leq 50$ | $ \\leq 100$ | 特性 3  |\n| 14    | $\\leq 50$ | $ \\leq 100$ | 无    |\n| 15    | $\\leq 50$ | $ \\leq 100$ | 无    |\n| 16    | $\\leq 50$ | $ \\leq 100$ | 无    |\n| 17    | $\\leq 50$ | $ \\leq 100$ | 无    |\n| 18    | $\\leq 50$ | $ \\leq 100$ | 无    |\n| 19    | $\\leq 50$ | $ \\leq 100$ | 无    |\n| 20    | $\\leq 50$ | $ \\leq 100$ | 无    |\n\n- 特性 1：所有顶点的度数均为 $2$。\n- 特性 2：这个棋盘可以绘制在一个 $k \\times k$ 的矩形网格图上。其中 $k \\times k=n$ 且 $2k \\times (k-1)=m$。\n- 特性 3：每条边至多属于一个简单环。", "locale": "zh-CN"}}}
{"pid": "P5236", "type": "P", "difficulty": 6, "samples": [["9 10 2\n1 2 1\n1 4 1\n3 4 1\n2 3 1\n3 7 1\n7 8 2\n7 9 2\n1 5 3\n1 6 4\n5 6 1\n1 9\n5 7", "5\n6"], ["9 10 3\n1 2 1\n2 3 1\n2 4 4\n3 4 2\n4 5 1\n5 6 1\n6 7 2\n7 8 2\n8 9 4\n5 9 2\n1 9\n5 8\n3 4", "7\n5\n2"]], "limits": {"time": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["图论", "强连通分量", "仙人掌", "树链剖分", "模板题"], "title": "【模板】静态仙人掌", "background": "这是一道静态仙人掌(Block Forest Data Structure)的模板题。   \n如果您不知道什么是仙人掌，那么此处给出无向仙人掌图的定义：  \n>任意一条边至多只出现在一条简单回路的无向连通图称为仙人掌。", "description": "给你一个有 $n$ 个点和 $m$ 条边的仙人掌图，和 $q$ 组询问  \n每次询问两个点 $u,v$，求两点之间的最短路。\n\n保证输入数据没有重边。", "inputFormat": "第一行三个正整数 $n,m,q$，意义如题目描述。  \n接下来 $m$ 行，每行三个正整数 $u,v,w$，表示 $u,v$ 之间有一条权值为 $w$ 的无向边。   \n然后 $q$ 行，每行两个正整数 $u,v$，询问 $u$ 到 $v$ 的最短路。", "outputFormat": "$q$ 行，每行一个正整数，对应一次询问的结果。", "hint": "**样例1解释：**  \n样例1中的仙人掌是这个样子的：  \n![](https://cdn.luogu.com.cn/upload/pic/52854.png)   \n询问有两个，分别是询问 $1\\rightarrow 9$ 和 $5\\rightarrow 7$ 的最短路  \n显然答案分别为 $5$ 和 $6$。\n\n**数据范围：**   \n$1\\le n,q \\le 10000$      \n$1\\le m \\le 20000$   \n$1\\le w \\le 10^5$     \n\n保证输入数据没有重边。\n\n请注意时限为 $300\\text{ms}$      \n", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Static Cactus", "background": "This is a template problem for the Static Cactus (Block Forest Data Structure).  \nIf you do not know what a cactus is, here is the definition of an undirected cactus graph:  \n> An undirected connected graph in which any edge appears in at most one simple cycle is called a cactus.", "description": "You are given a cactus graph with $n$ vertices and $m$ edges, and $q$ queries.  \nEach query gives two vertices $u, v$. Find the shortest path distance between them.\n\nThe input is guaranteed to have no multiple edges.", "inputFormat": "The first line contains three positive integers $n, m, q$, with the meanings as described above.  \nThe next $m$ lines each contain three positive integers $u, v, w$, indicating an undirected edge between $u$ and $v$ with weight $w$.  \nThen follow $q$ lines, each containing two positive integers $u, v$, asking for the shortest path from $u$ to $v$.", "outputFormat": "Output $q$ lines, each with one positive integer, the answer for the corresponding query.", "hint": "**Explanation for Sample 1:**  \nThe cactus in Sample 1 looks like this:  \n![](https://cdn.luogu.com.cn/upload/pic/52854.png)  \nThere are two queries: the shortest path for $1\\rightarrow 9$ and for $5\\rightarrow 7$.  \nObviously, the answers are $5$ and $6$.\n\n**Constraints:**  \n$1\\le n, q \\le 10000$  \n$1\\le m \\le 20000$  \n$1\\le w \\le 10^5$  \n\nThe input is guaranteed to have no multiple edges.\n\nNote that the time limit is $300\\text{ms}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】静态仙人掌", "background": "这是一道静态仙人掌(Block Forest Data Structure)的模板题。   \n如果您不知道什么是仙人掌，那么此处给出无向仙人掌图的定义：  \n>任意一条边至多只出现在一条简单回路的无向连通图称为仙人掌。", "description": "给你一个有 $n$ 个点和 $m$ 条边的仙人掌图，和 $q$ 组询问  \n每次询问两个点 $u,v$，求两点之间的最短路。\n\n保证输入数据没有重边。", "inputFormat": "第一行三个正整数 $n,m,q$，意义如题目描述。  \n接下来 $m$ 行，每行三个正整数 $u,v,w$，表示 $u,v$ 之间有一条权值为 $w$ 的无向边。   \n然后 $q$ 行，每行两个正整数 $u,v$，询问 $u$ 到 $v$ 的最短路。", "outputFormat": "$q$ 行，每行一个正整数，对应一次询问的结果。", "hint": "**样例1解释：**  \n样例1中的仙人掌是这个样子的：  \n![](https://cdn.luogu.com.cn/upload/pic/52854.png)   \n询问有两个，分别是询问 $1\\rightarrow 9$ 和 $5\\rightarrow 7$ 的最短路  \n显然答案分别为 $5$ 和 $6$。\n\n**数据范围：**   \n$1\\le n,q \\le 10000$      \n$1\\le m \\le 20000$   \n$1\\le w \\le 10^5$     \n\n保证输入数据没有重边。\n\n请注意时限为 $300\\text{ms}$      \n", "locale": "zh-CN"}}}
{"pid": "P5237", "type": "P", "difficulty": 7, "samples": [["11 23\n10 5 11 7 8 14 30 3 16 20 19\n1 1 2 5\n1 2 3 3\n1 3 4 7\n1 4 5 8\n1 2 6 10\n1 6 7 15\n1 4 7 3\n1 6 8 9\n1 6 8 6\n1 7 9 12\n1 9 11 10\n1 7 10 4\n1 9 10 8\n5 5 11\n5 2 10\n6 8 7\n3 8 5 100\n5 1 7\n6 8 7\n4 11 7 1000\n5 8 3\n4 3 2 2333\n5 1 5", "-2 -2\n5 73\n16 85\n5 263\n16 185\n1005 4233\n1011 9907\n"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "动态仙人掌 IV", "background": "模板题。", "description": "有 $n$ 个点，从 $1 \\sim n$ 编号，第 $i$ 个点有一个权值 $w_i$，初始没有边。\n\n有 $m$ 个操作，如果操作后，这个无向图的每个连通块都是个仙人掌，且不存在自环，那这个操作合法，否则不合法。不合法的操作忽略。一共有六种操作：\n\n1. 在结点 $v,u$ 间连一条权值为 $w$ 的边；\n\n2. 在结点 $v,u$ 间删掉一条权值为 $w$ 的边；\n\n3. 把结点 $v$ 到结点 $u$ 的最短路上的每一个结点的权值都加上 $d$；\n\n4. 把以结点 $v$ 为根，子仙人掌 $u$ 的每一个结点的权值都加上 $d$；\n\n5. 查询结点 $v$ 到结点 $u$ 的最短路信息。\n\n    输出两个用空格隔开的整数 $min,\\sigma$，分别代表最短路上点权的最小值、和。\n\n      如果没有路可到达则 $min=-1,\\sigma =-1$。\n    \n      如果最短路不唯一则 $min=-2,\\sigma =-2$。\n\n6. 查询以结点 $v$ 为根，子仙人掌$u$的信息。\n\n    输出两个用空格隔开的整数 $min,\\sigma$，分别代表子仙人掌 $u$ 中点权的最小值、和。\n\n    如果 $v,u$ 不连通则 $min=-1,\\sigma =-1$。\n\n以结点 $v$ 为根，子仙人掌 $u$ 的定义是，删掉 $v$ 到 $u$ 之间的所有简单路径上的边之后，$u$ 所在的连通块。", "inputFormat": "第一行两个用空格隔开的正整数 $n,m$ 表示一共有 $n$ 个结点，$m$ 个操作。\n\n接下来一行 $n$ 个正整数，第 $i$ 个正整数为 $w_i$。\n\n接下来 $m$ 行，每行代表一个操作，每行前三个整数：$opt_i,v_i,u_i$\n\n若 $opt_i \\in \\{ 1,2,3,4 \\}$ 则接下来再输入一个整数，否则此行结束。", "outputFormat": "对于操作 $5$、$6$，输出相应的结果。", "hint": "【数据范围】  \n对于 $100\\%$ 的数据，$1 \\leq n \\leq 50000, 1 \\leq m \\leq 250000$   \n\n保证操作 $1$、$2$ 中的 $w$ 满足 $1 \\leq w \\leq 10000$，所以关于边权的计算不会超出 $32$ 位有符号整数范围。\n\n保证初始的 $w_i$ 不超过 $10^9$，保证所有操作 $3$、$4$ 中的 $d$ 之和不超过 $10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "Dynamic Cactus IV", "background": "Template problem.", "description": "There are $n$ vertices, numbered from $1 \\sim n$. Vertex $i$ has a weight $w_i$. Initially, there are no edges.\n\nThere are $m$ operations. An operation is considered valid if, after applying it, every connected component of this undirected graph is a cactus, and there are no self-loops. Otherwise, the operation is invalid. Invalid operations are ignored. There are six types of operations:\n\n1. Add an edge of weight $w$ between vertices $v$ and $u$.\n\n2. Delete an edge of weight $w$ between vertices $v$ and $u$.\n\n3. Add $d$ to the weight of every vertex on the shortest path from vertex $v$ to vertex $u$.\n\n4. Add $d$ to the weight of every vertex in the sub-cactus $u$, rooted at vertex $v$.\n\n5. Query information about the shortest path from vertex $v$ to vertex $u$.\n\n   Output two integers $min,\\sigma$ separated by a space, representing the minimum vertex weight and the sum of vertex weights on the shortest path.\n\n   If there is no path reachable, then $min=-1,\\sigma =-1$.\n\n   If the shortest path is not unique, then $min=-2,\\sigma =-2$.\n\n6. Query information about the sub-cactus $u$, rooted at vertex $v$.\n\n   Output two integers $min,\\sigma$ separated by a space, representing the minimum vertex weight and the sum of vertex weights in sub-cactus $u$.\n\n   If $v$ and $u$ are not connected, then $min=-1,\\sigma =-1$.\n\nThe definition of the sub-cactus $u$ rooted at vertex $v$ is: after deleting the edges on all simple paths between $v$ and $u$, the connected component containing $u$.", "inputFormat": "The first line contains two positive integers $n,m$ separated by spaces, meaning there are $n$ vertices and $m$ operations in total.\n\nThe next line contains $n$ positive integers. The $i$-th positive integer is $w_i$.\n\nThe next $m$ lines each describe one operation. Each line starts with three integers: $opt_i,v_i,u_i$.\n\nIf $opt_i \\in \\{ 1,2,3,4 \\}$, then one more integer follows; otherwise, the line ends.", "outputFormat": "For operations $5$ and $6$, output the corresponding results.", "hint": "Constraints  \nFor $100\\%$ of the testdata, $1 \\leq n \\leq 50000, 1 \\leq m \\leq 250000$.\n\nIt is guaranteed that in operations $1$ and $2$, $w$ satisfies $1 \\leq w \\leq 10000$, so computations involving edge weights will not exceed the range of a 32-bit signed integer.\n\nIt is guaranteed that the initial $w_i$ does not exceed $10^9$, and that the sum of all $d$ in operations $3$ and $4$ does not exceed $10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "动态仙人掌 IV", "background": "模板题。", "description": "有 $n$ 个点，从 $1 \\sim n$ 编号，第 $i$ 个点有一个权值 $w_i$，初始没有边。\n\n有 $m$ 个操作，如果操作后，这个无向图的每个连通块都是个仙人掌，且不存在自环，那这个操作合法，否则不合法。不合法的操作忽略。一共有六种操作：\n\n1. 在结点 $v,u$ 间连一条权值为 $w$ 的边；\n\n2. 在结点 $v,u$ 间删掉一条权值为 $w$ 的边；\n\n3. 把结点 $v$ 到结点 $u$ 的最短路上的每一个结点的权值都加上 $d$；\n\n4. 把以结点 $v$ 为根，子仙人掌 $u$ 的每一个结点的权值都加上 $d$；\n\n5. 查询结点 $v$ 到结点 $u$ 的最短路信息。\n\n    输出两个用空格隔开的整数 $min,\\sigma$，分别代表最短路上点权的最小值、和。\n\n      如果没有路可到达则 $min=-1,\\sigma =-1$。\n    \n      如果最短路不唯一则 $min=-2,\\sigma =-2$。\n\n6. 查询以结点 $v$ 为根，子仙人掌$u$的信息。\n\n    输出两个用空格隔开的整数 $min,\\sigma$，分别代表子仙人掌 $u$ 中点权的最小值、和。\n\n    如果 $v,u$ 不连通则 $min=-1,\\sigma =-1$。\n\n以结点 $v$ 为根，子仙人掌 $u$ 的定义是，删掉 $v$ 到 $u$ 之间的所有简单路径上的边之后，$u$ 所在的连通块。", "inputFormat": "第一行两个用空格隔开的正整数 $n,m$ 表示一共有 $n$ 个结点，$m$ 个操作。\n\n接下来一行 $n$ 个正整数，第 $i$ 个正整数为 $w_i$。\n\n接下来 $m$ 行，每行代表一个操作，每行前三个整数：$opt_i,v_i,u_i$\n\n若 $opt_i \\in \\{ 1,2,3,4 \\}$ 则接下来再输入一个整数，否则此行结束。", "outputFormat": "对于操作 $5$、$6$，输出相应的结果。", "hint": "【数据范围】  \n对于 $100\\%$ 的数据，$1 \\leq n \\leq 50000, 1 \\leq m \\leq 250000$   \n\n保证操作 $1$、$2$ 中的 $w$ 满足 $1 \\leq w \\leq 10000$，所以关于边权的计算不会超出 $32$ 位有符号整数范围。\n\n保证初始的 $w_i$ 不超过 $10^9$，保证所有操作 $3$、$4$ 中的 $d$ 之和不超过 $10^9$。", "locale": "zh-CN"}}}
{"pid": "P5238", "type": "P", "difficulty": 3, "samples": [["-3 3 4\n0\n00\n-0\n100000000000000000000", "0\n1\n1\n2\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "字符串", "洛谷月赛"], "title": "整数校验器", "background": "", "description": "有些时候需要解决这样一类问题：判断一个数 $x$ 是否合法。\n\n$x$ 合法当且仅当其满足如下条件：\n\n- $x$ 格式合法，一个格式合法的整数要么是 $0$，要么由一个可加可不加的负号，一个 $1$ 到 $9$ 之间的数字，和若干个 $0$ 到 $9$ 之间的数字依次连接而成。\n- $x$ 在区间 $[l,r]$ 范围内（即 $l \\le x \\le r$）。\n\n你需要实现这样一个校验器，对于给定的 $l, r$，多次判断 $x$ 是否合法。", "inputFormat": "第一行三个整数 $l,r,T$，表示校验器的校验区间为 $[l,r]$，以及需要校验的 $x$ 的个数。\n\n接下来 $T$ 行，每行一个 $x$，表示要校验的数，保证 $x$ 长度至少为 $1$ 且仅由 '0'~'9' 及 '-' 构成，且 '-' 只会出现在第一个字符。", "outputFormat": "输出共 $T$ 行，每行一个整数，表示每个 $x$ 的校验结果。\n\n校验结果规定如下：$0$ 表示 $x$ 合法；$1$ 表示 $x$ 格式不合法；$2$ 表示 $x$ 格式合法且不在 $[l,r]$ 区间内。", "hint": "对于 $100\\%$ 的数据，$0 \\le T \\le 512$，$l,r$ 在 $64$ 位有符号整型范围内（即 $-2^{63}\\le l \\le r \\le 2^{63}-1$）。\n\n保证输入文件大小不超过 $\\text{128KB}$。数据在 linux 下生成，没有 '\\r' 字符。\n\n以下为部分特殊限制（互不包含）：\n\n- 有 $5\\%$ 的数据，$T=0$。\n- 有 $25\\%$ 的数据，保证 $x$ 格式一定合法。\n- 有 $30\\%$ 的数据，保证如果 $x$ 格式合法，那么 $x$ 一定在 $64$ 位有符号整形范围内。\n\n其中有一个不计分的hack测试点，用于考察long long边界数字的判断，如果是100分UnAC的话，那么可能是你没有考虑这一种情况。", "locale": "zh-CN", "translations": {"en": {"title": "Integer Validator", "background": "", "description": "Sometimes you need to solve this kind of problem: determine whether a number $x$ is valid.\n\n$x$ is valid if and only if it satisfies the following conditions:\n\n- The format of $x$ is valid. A valid integer is either $0$, or is formed by concatenating, in order, an optional minus sign, a digit from $1$ to $9$, and then some digits from $0$ to $9$.\n- $x$ is within the interval $[l, r]$ (i.e., $l \\le x \\le r$).\n\nYou need to implement such a validator. Given $l$ and $r$, you will check multiple times whether each $x$ is valid.", "inputFormat": "The first line contains three integers $l, r, T$, indicating that the validator checks the interval $[l, r]$, and there are $T$ values of $x$ to be checked.\n\nThe next $T$ lines each contain one $x$, the number to be checked. It is guaranteed that the length of $x$ is at least $1$ and it consists only of '0'~'9' and '-', and '-' appears only as the first character.", "outputFormat": "Output $T$ lines in total, each containing one integer representing the validation result for each $x$.\n\nThe results are defined as follows: $0$ means $x$ is valid; $1$ means the format of $x$ is invalid; $2$ means the format of $x$ is valid but $x$ is not within the interval $[l, r]$.", "hint": "For $100\\%$ of the testdata, $0 \\le T \\le 512$, and $l, r$ are within the range of 64-bit signed integers (i.e., $-2^{63} \\le l \\le r \\le 2^{63} - 1$).\n\nThe input file size is guaranteed to be no more than $\\text{128KB}$. The testdata is generated under Linux, and there is no '\\r' character.\n\nBelow are some special constraints (they do not include each other):\n\n- For $5\\%$ of the testdata, $T = 0$.\n- For $25\\%$ of the testdata, it is guaranteed that the format of $x$ is always valid.\n- For $30\\%$ of the testdata, it is guaranteed that if the format of $x$ is valid, then $x$ is within the range of 64-bit signed integers.\n\nThere is an unscored hack test point, intended to test the handling of long long boundary values. If you get UnAC with 100 points, it may be because you did not consider this case.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "整数校验器", "background": "", "description": "有些时候需要解决这样一类问题：判断一个数 $x$ 是否合法。\n\n$x$ 合法当且仅当其满足如下条件：\n\n- $x$ 格式合法，一个格式合法的整数要么是 $0$，要么由一个可加可不加的负号，一个 $1$ 到 $9$ 之间的数字，和若干个 $0$ 到 $9$ 之间的数字依次连接而成。\n- $x$ 在区间 $[l,r]$ 范围内（即 $l \\le x \\le r$）。\n\n你需要实现这样一个校验器，对于给定的 $l, r$，多次判断 $x$ 是否合法。", "inputFormat": "第一行三个整数 $l,r,T$，表示校验器的校验区间为 $[l,r]$，以及需要校验的 $x$ 的个数。\n\n接下来 $T$ 行，每行一个 $x$，表示要校验的数，保证 $x$ 长度至少为 $1$ 且仅由 '0'~'9' 及 '-' 构成，且 '-' 只会出现在第一个字符。", "outputFormat": "输出共 $T$ 行，每行一个整数，表示每个 $x$ 的校验结果。\n\n校验结果规定如下：$0$ 表示 $x$ 合法；$1$ 表示 $x$ 格式不合法；$2$ 表示 $x$ 格式合法且不在 $[l,r]$ 区间内。", "hint": "对于 $100\\%$ 的数据，$0 \\le T \\le 512$，$l,r$ 在 $64$ 位有符号整型范围内（即 $-2^{63}\\le l \\le r \\le 2^{63}-1$）。\n\n保证输入文件大小不超过 $\\text{128KB}$。数据在 linux 下生成，没有 '\\r' 字符。\n\n以下为部分特殊限制（互不包含）：\n\n- 有 $5\\%$ 的数据，$T=0$。\n- 有 $25\\%$ 的数据，保证 $x$ 格式一定合法。\n- 有 $30\\%$ 的数据，保证如果 $x$ 格式合法，那么 $x$ 一定在 $64$ 位有符号整形范围内。\n\n其中有一个不计分的hack测试点，用于考察long long边界数字的判断，如果是100分UnAC的话，那么可能是你没有考虑这一种情况。", "locale": "zh-CN"}}}
{"pid": "P5239", "type": "P", "difficulty": 3, "samples": [["5\n2 3\n1 4\n4 3\n2 5\n3 5", "10\n10\n11\n35\n50"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["排列组合", "前缀和", "洛谷月赛"], "title": "回忆京都", "background": "第十五届东方人气投票音乐部门 106 名\n\n第四次国内不知道东方的人对东方原曲的投票调查 51 名\n\n回忆京都副歌我 tm 吹爆，东方文花帖我 tm 吹爆！", "description": "射命丸文在取材中发现了一个好玩的东西，叫做组合数。\n\n组合数的定义如下：从 $n$ 个不同元素中，任取 $m(m \\leq n)$ 个元素并成一组，叫做从 $n$ 个不同元素中取出 $m$ 个元素的一个组合。所有组合的数量，就是组合数。\n\n组合数的计算公式如下：$\\mathrm C^m_n=\\dfrac{n!}{m! \\times (n-m)!}$，其中保证 $m \\leq n$，表示在 $n$ 个元素中选出 $m$ 个元素的组合数。\n\n为了方便理解，举一个例子：在 th16.5 秘封噩梦日记的第三周目中，每一天的战斗都有 $4$ 个角色两两组合出场，那么很显然就有 $\\mathrm C^2_4=6$ 种组合方式。\n\n关于这方面的更详细解释，请看样例说明。\n\n由于她对新事物都存在着好奇，因此她想要知道 $\\mathrm C^m_n$ 是多少。这对她来说是个很简单的事情，因此她看了一眼就秒了，因此她决定求出下列式子：\n\n$$\\sum_{i=1}^n \\sum_{j=1}^m \\mathrm C^i_j$$\n\n其中当 $i>j$ 的时候，钦定 $\\mathrm C^i_j$ 为 $0$。\n\n她也很快就算出来了，不过对自己的答案不是很充满信心，因此你决定帮助她。然而没事找事的她一下子算了 $q$ 次对于不同的 $n,m$ 的结果，因此这只能劳烦你了。由于你不打算真正地帮助她，你无需把答案对 $998244353$ 取模，也无需对 $64123$ 取模，只要告诉她对 $19260817$ 取模之后的答案即可。", "inputFormat": "第一行输入一个非负整数 $q$，表示有 $q$ 次询问。\n\n第二行开始，一共 $q$ 行，每行两个非负整数 $n,m$，意思如题所示。", "outputFormat": "一共 $q$ 行，对于每一个询问，都输出一个答案。", "hint": "| 测试点编号 | $q$ | $n$ | $m$ |\n|:-:|:-:|:-:|:-:|\n| $1$ | $=0$ | 不存在 | 不存在 |\n| $2\\sim 3$ | $\\le 10$ | $\\le 10$ | $\\le 10$ |\n| $4\\sim 6$ | $\\le 10$ | $\\le 10^3$ | $\\le 10^3$ |\n| $7\\sim 10$ | $\\le 10^4$ | $\\le 10^3$ | $\\le 10^3$ |\n\n关于组合数的样例说明。\n\n例如有蕾米莉亚、芙兰朵露、圣白莲、丰聪耳神子在这一天组合出场，会有六种情况：\n\n1. 蕾米莉亚 x 芙兰朵露 $\\text{\\color{white}背德组}$\n\n2. 丰聪耳神子 x 圣白莲 $\\text{\\color{white}宗教组}$\n\n3. 蕾米莉亚 x 丰聪耳神子\n\n4. 芙兰朵露 x 丰聪耳神子\n\n5. 蕾米莉亚 x 圣白莲\n\n6. 芙兰朵露 x 圣白莲", "locale": "zh-CN", "translations": {"en": {"title": "Recalling Kyoto.", "background": "106th place in the Music section of the 15th Touhou Popularity Poll.\n\n51st place in the 4th domestic poll survey of people who do not know Touhou voting on Touhou original tracks.\n\nThe chorus of Recalling Kyoto is so good, and Touhou Bunkachou is also so good.", "description": "While collecting materials, Shameimaru Aya discovered something interesting, called the binomial coefficient.\n\nThe definition of a binomial coefficient is as follows: from $n$ distinct elements, choose any $m$ elements $(m \\leq n)$ to form a group. This is called a combination of choosing $m$ elements from $n$ distinct elements. The number of all such combinations is the binomial coefficient.\n\nThe formula for computing the binomial coefficient is: $\\mathrm C^m_n=\\dfrac{n!}{m! \\times (n-m)!}$. It is guaranteed that $m \\leq n$, and it represents the number of ways to choose $m$ elements from $n$ elements.\n\nTo make it easier to understand, here is an example: in the third playthrough (week) of th16.5 Violet Detector, each day’s battle has $4$ characters appearing in pairs. Then clearly there are $\\mathrm C^2_4=6$ ways to form pairs.\n\nFor a more detailed explanation, please see the sample explanation.\n\nSince she is curious about new things, she wants to know what $\\mathrm C^m_n$ is. This is very easy for her, so she solved it instantly at a glance. Therefore, she decided to compute the following expression:\n\n$$\\sum_{i=1}^n \\sum_{j=1}^m \\mathrm C^i_j$$\n\nWhen $i>j$, $\\mathrm C^i_j$ is defined to be $0$.\n\nShe quickly computed it, but she is not very confident in her answer, so you decide to help her. However, she, being idle and looking for something to do, computed the result $q$ times for different $n,m$. So this can only be left to you. Since you do not plan to truly help her, you do not need to take the answer modulo $998244353$, nor modulo $64123$. You only need to tell her the answer modulo $19260817$.", "inputFormat": "The first line contains a non-negative integer $q$, indicating that there are $q$ queries.\n\nStarting from the second line, there are $q$ lines in total. Each line contains two non-negative integers $n,m$, with the meaning as described in the statement.", "outputFormat": "Output $q$ lines in total. For each query, output one answer.", "hint": "| Test Point ID | $q$ | $n$ | $m$ |\n|:-:|:-:|:-:|:-:|\n| $1$ | $=0$ | Does not exist | Does not exist |\n| $2\\sim 3$ | $\\le 10$ | $\\le 10$ | $\\le 10$ |\n| $4\\sim 6$ | $\\le 10$ | $\\le 10^3$ | $\\le 10^3$ |\n| $7\\sim 10$ | $\\le 10^4$ | $\\le 10^3$ | $\\le 10^3$ |\n\nSample explanation about binomial coefficients.\n\nFor example, if Remilia, Flandre, Hijiri Byakuren, and Toyosatomimi no Miko appear in combinations on that day, there will be six cases:\n\n1. Remilia x Flandre $\\text{\\color{white}背德组}$\n\n2. Toyosatomimi no Miko x Hijiri Byakuren $\\text{\\color{white}宗教组}$\n\n3. Remilia x Toyosatomimi no Miko.\n\n4. Flandre x Toyosatomimi no Miko.\n\n5. Remilia x Hijiri Byakuren.\n\n6. Flandre x Hijiri Byakuren.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "回忆京都", "background": "第十五届东方人气投票音乐部门 106 名\n\n第四次国内不知道东方的人对东方原曲的投票调查 51 名\n\n回忆京都副歌我 tm 吹爆，东方文花帖我 tm 吹爆！", "description": "射命丸文在取材中发现了一个好玩的东西，叫做组合数。\n\n组合数的定义如下：从 $n$ 个不同元素中，任取 $m(m \\leq n)$ 个元素并成一组，叫做从 $n$ 个不同元素中取出 $m$ 个元素的一个组合。所有组合的数量，就是组合数。\n\n组合数的计算公式如下：$\\mathrm C^m_n=\\dfrac{n!}{m! \\times (n-m)!}$，其中保证 $m \\leq n$，表示在 $n$ 个元素中选出 $m$ 个元素的组合数。\n\n为了方便理解，举一个例子：在 th16.5 秘封噩梦日记的第三周目中，每一天的战斗都有 $4$ 个角色两两组合出场，那么很显然就有 $\\mathrm C^2_4=6$ 种组合方式。\n\n关于这方面的更详细解释，请看样例说明。\n\n由于她对新事物都存在着好奇，因此她想要知道 $\\mathrm C^m_n$ 是多少。这对她来说是个很简单的事情，因此她看了一眼就秒了，因此她决定求出下列式子：\n\n$$\\sum_{i=1}^n \\sum_{j=1}^m \\mathrm C^i_j$$\n\n其中当 $i>j$ 的时候，钦定 $\\mathrm C^i_j$ 为 $0$。\n\n她也很快就算出来了，不过对自己的答案不是很充满信心，因此你决定帮助她。然而没事找事的她一下子算了 $q$ 次对于不同的 $n,m$ 的结果，因此这只能劳烦你了。由于你不打算真正地帮助她，你无需把答案对 $998244353$ 取模，也无需对 $64123$ 取模，只要告诉她对 $19260817$ 取模之后的答案即可。", "inputFormat": "第一行输入一个非负整数 $q$，表示有 $q$ 次询问。\n\n第二行开始，一共 $q$ 行，每行两个非负整数 $n,m$，意思如题所示。", "outputFormat": "一共 $q$ 行，对于每一个询问，都输出一个答案。", "hint": "| 测试点编号 | $q$ | $n$ | $m$ |\n|:-:|:-:|:-:|:-:|\n| $1$ | $=0$ | 不存在 | 不存在 |\n| $2\\sim 3$ | $\\le 10$ | $\\le 10$ | $\\le 10$ |\n| $4\\sim 6$ | $\\le 10$ | $\\le 10^3$ | $\\le 10^3$ |\n| $7\\sim 10$ | $\\le 10^4$ | $\\le 10^3$ | $\\le 10^3$ |\n\n关于组合数的样例说明。\n\n例如有蕾米莉亚、芙兰朵露、圣白莲、丰聪耳神子在这一天组合出场，会有六种情况：\n\n1. 蕾米莉亚 x 芙兰朵露 $\\text{\\color{white}背德组}$\n\n2. 丰聪耳神子 x 圣白莲 $\\text{\\color{white}宗教组}$\n\n3. 蕾米莉亚 x 丰聪耳神子\n\n4. 芙兰朵露 x 丰聪耳神子\n\n5. 蕾米莉亚 x 圣白莲\n\n6. 芙兰朵露 x 圣白莲", "locale": "zh-CN"}}}
{"pid": "P5240", "type": "P", "difficulty": 6, "samples": [["4\nx\n0 1\n9\n0 1\nx*(x^(1*8))\n0 1\n(3*(x^3))+((2*(x^2))+(12*x))\n0 1\n", "1 1\n0 0\n0 9\n12 25\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "树形 DP", "栈", "洛谷月赛", "欧拉降幂"], "title": "Derivation", "background": "", "description": "小 R 学会微积分中求导这一概念后，他的数学老师要求他开始做一部分导数的练习题加深自己的理解。\n\n但颖悟绝伦的小 R 对繁复的练习题并不感兴趣。他希望你帮他设计一个程序，计算一个给定函数 $f(x)$ 的导数。\n\n如果你对导数这一概念并不熟悉，请参阅【说明】中的内容。", "inputFormat": "第一行一个正整数 $T$，表示小 R 要完成的练习题数量，亦即测试数据的组数。\n\n每组测试数据的第一行是一个非空字符串，描述了输入的函数 $f(x)$。设 $p=998244353$。\n\n字符串中可能包含的元素有：\n\n1. 系数为 $1$ 的单项式，包括 $x^1,x^2,x^0$ 等，我们保证指数为非负整数（为 $1$ 时不省略）且不超过 $p-1$。所有幂号用 `^` 代替。\n2. 常数，如 $0,19260817$ 等；我们保证一切常数是非负整数且不超过 $p-1$。\n3. 复合函数。将以上两种函数组合的方式可以为加乘幂，括号等。数学中会省略乘号和括号，但我们保证任意情况下都不省略（也不会无意义冗余，即不存在 `((x)),(3)+(4)`）；保证任何指数都是常数，即不存在 $x^{g(x)}$ 的情况。\n\n经过以上规定，我们发现 $f(x)$ 求导后一定是一个多项式函数。如果你对数据的输入形式仍有不确定，可以观察附加样例文件。\n\n由于输出这样的函数存在技术困难，为确认你的输出是正确的，测试数据的第二行为两个整数，值在 $[0,p)$ 之间。你需要输出两个整数，表示这些整数代入导函数后的值模 $p$ 的结果。\n\n注意：本题中认为 $0^0=1$。", "outputFormat": "输出 $T$ 行，每行两个整数，已在【输入格式】中说明它们的意义。", "hint": "规定字符串长度不超过 $10^4$，字符串总长不超过 $5 \\times 10^5$。\n\n| 子任务编号 | 特殊性质                                                  | 分值 |\n| :----------: | :---------------------------------------------------------: | :----: |\n| 1          | $T \\le 10^4$，字符串长度不超过 $20$，出现的常数不超过 $9$ | 20   |\n| 2          | $T \\le 100$，输入是一个化简后的多项式                     | 15   |\n| 3          | $T \\le 100$，出现的常数不超过 $9$                         | 15   |\n| 4          | $T \\le 100$，不存在多项式求幂                             | 20   |\n| 5          | $T \\le 100$                                               | 30   |\n\n我们提供了 5 个附加样例文件，分别满足 5 个子任务的限制。\n\n链接: https://pan.baidu.com/s/1dVSy8tU3pqGoq1-7CFYtBw 提取码: ya2u\n\n**我们只保证以下定义在本题中适用。**\n\n$f(x)$ 的导数是一个函数 $f'(x)$，满足：\n\n$$ \\displaystyle \\lim_{h \\to 0} f'(x)=\\dfrac{f(x+h)-f(x)}{h} $$\n\n我们称 $\\displaystyle \\lim_{x \\to a}g(x)=L$ 当且仅当对于任何实数 $\\epsilon > 0$ 我们都可以找到一个实数 $\\delta > 0$ 使得 $\\lvert g(x)-L\\rvert < \\epsilon$ 若 $0 < \\lvert x - a \\rvert < \\delta$。\n\n你可能用到以下的求导公式：\n\n1. $f(x)=C,f'(x)=0$，其中 $C$ 是一常数。\n2. $f(x)=x^n,f'(x)=nx^{n-1}$，其中 $n$ 为非 $0$ 常数。\n3. $(f(x)+g(x))'=f'(x)+g'(x)$\n4. $(f(x)g(x))'=f'(x)g(x)+f(x)g'(x)$\n5. $(f(g(x)))'=f'(g(x))g'(x)$", "locale": "zh-CN", "translations": {"en": {"title": "Derivation", "background": "", "description": "After learning the concept of differentiation in calculus, Little R’s math teacher asked him to do some derivative exercises to deepen his understanding.\n\nHowever, the exceptionally smart Little R is not interested in complicated exercises. He wants you to help him design a program to compute the derivative of a given function $f(x)$.\n\nIf you are not familiar with the concept of derivatives, please refer to the content in the “Explanation”.", "inputFormat": "The first line contains a positive integer $T$, indicating the number of exercises Little R needs to finish, i.e., the number of testdata groups.\n\nFor each testdata group, the first line is a non-empty string describing the input function $f(x)$. Let $p=998244353$.\n\nThe string may contain the following elements:\n\n1. Monomials with coefficient $1$, including $x^1,x^2,x^0$, etc. We guarantee that the exponent is a non-negative integer (it is not omitted when it is $1$) and does not exceed $p-1$. All exponent symbols are written as `^`.\n2. Constants, such as $0,19260817$, etc. We guarantee that all constants are non-negative integers and do not exceed $p-1$.\n3. Composite functions. The above two kinds of functions can be combined by addition, multiplication, exponentiation, parentheses, etc. In mathematics, multiplication signs and parentheses may be omitted, but we guarantee that they are never omitted in any case (and there is no meaningless redundancy, i.e., there will be no `((x)),(3)+(4)`). We guarantee that any exponent is a constant, i.e., there is no case like $x^{g(x)}$.\n\nUnder the above rules, we find that after differentiating, $f(x)$ must be a polynomial function. If you are still uncertain about the input format, you can check the additional sample files.\n\nBecause outputting such a function directly is technically difficult, to verify whether your output is correct, the second line of each testdata group contains two integers in $[0,p)$. You need to output two integers: the values of the derivative function after substituting these integers, taken modulo $p$.\n\nNote: In this problem, we treat $0^0=1$.", "outputFormat": "Output $T$ lines. Each line contains two integers, whose meaning has been explained in the “Input Format”.", "hint": "It is guaranteed that the string length does not exceed $10^4$, and the total length of all strings does not exceed $5 \\times 10^5$.\n\n| Subtask ID | Special Properties                                             | Score |\n| :--------: | :------------------------------------------------------------: | :---: |\n| 1          | $T \\le 10^4$, string length does not exceed $20$, constants do not exceed $9$ | 20    |\n| 2          | $T \\le 100$, the input is a simplified polynomial              | 15    |\n| 3          | $T \\le 100$, constants do not exceed $9$                       | 15    |\n| 4          | $T \\le 100$, no polynomial exponentiation exists               | 20    |\n| 5          | $T \\le 100$                                                    | 30    |\n\nWe provide 5 additional sample files, each satisfying the restrictions of the 5 subtasks.\n\nLink: https://pan.baidu.com/s/1dVSy8tU3pqGoq1-7CFYtBw Extraction code: ya2u\n\n**We only guarantee that the following definitions apply in this problem.**\n\nThe derivative of $f(x)$ is a function $f'(x)$ such that:\n\n$$ \\displaystyle \\lim_{h \\to 0} f'(x)=\\dfrac{f(x+h)-f(x)}{h} $$\n\nWe say $\\displaystyle \\lim_{x \\to a}g(x)=L$ if and only if for any real number $\\epsilon > 0$ we can find a real number $\\delta > 0$ such that $\\lvert g(x)-L\\rvert < \\epsilon$ when $0 < \\lvert x - a \\rvert < \\delta$.\n\nYou may need the following differentiation formulas:\n\n1. $f(x)=C,f'(x)=0$, where $C$ is a constant.\n2. $f(x)=x^n,f'(x)=nx^{n-1}$, where $n$ is a non-zero constant.\n3. $(f(x)+g(x))'=f'(x)+g'(x)$.\n4. $(f(x)g(x))'=f'(x)g(x)+f(x)g'(x)$.\n5. $(f(g(x)))'=f'(g(x))g'(x)$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Derivation", "background": "", "description": "小 R 学会微积分中求导这一概念后，他的数学老师要求他开始做一部分导数的练习题加深自己的理解。\n\n但颖悟绝伦的小 R 对繁复的练习题并不感兴趣。他希望你帮他设计一个程序，计算一个给定函数 $f(x)$ 的导数。\n\n如果你对导数这一概念并不熟悉，请参阅【说明】中的内容。", "inputFormat": "第一行一个正整数 $T$，表示小 R 要完成的练习题数量，亦即测试数据的组数。\n\n每组测试数据的第一行是一个非空字符串，描述了输入的函数 $f(x)$。设 $p=998244353$。\n\n字符串中可能包含的元素有：\n\n1. 系数为 $1$ 的单项式，包括 $x^1,x^2,x^0$ 等，我们保证指数为非负整数（为 $1$ 时不省略）且不超过 $p-1$。所有幂号用 `^` 代替。\n2. 常数，如 $0,19260817$ 等；我们保证一切常数是非负整数且不超过 $p-1$。\n3. 复合函数。将以上两种函数组合的方式可以为加乘幂，括号等。数学中会省略乘号和括号，但我们保证任意情况下都不省略（也不会无意义冗余，即不存在 `((x)),(3)+(4)`）；保证任何指数都是常数，即不存在 $x^{g(x)}$ 的情况。\n\n经过以上规定，我们发现 $f(x)$ 求导后一定是一个多项式函数。如果你对数据的输入形式仍有不确定，可以观察附加样例文件。\n\n由于输出这样的函数存在技术困难，为确认你的输出是正确的，测试数据的第二行为两个整数，值在 $[0,p)$ 之间。你需要输出两个整数，表示这些整数代入导函数后的值模 $p$ 的结果。\n\n注意：本题中认为 $0^0=1$。", "outputFormat": "输出 $T$ 行，每行两个整数，已在【输入格式】中说明它们的意义。", "hint": "规定字符串长度不超过 $10^4$，字符串总长不超过 $5 \\times 10^5$。\n\n| 子任务编号 | 特殊性质                                                  | 分值 |\n| :----------: | :---------------------------------------------------------: | :----: |\n| 1          | $T \\le 10^4$，字符串长度不超过 $20$，出现的常数不超过 $9$ | 20   |\n| 2          | $T \\le 100$，输入是一个化简后的多项式                     | 15   |\n| 3          | $T \\le 100$，出现的常数不超过 $9$                         | 15   |\n| 4          | $T \\le 100$，不存在多项式求幂                             | 20   |\n| 5          | $T \\le 100$                                               | 30   |\n\n我们提供了 5 个附加样例文件，分别满足 5 个子任务的限制。\n\n链接: https://pan.baidu.com/s/1dVSy8tU3pqGoq1-7CFYtBw 提取码: ya2u\n\n**我们只保证以下定义在本题中适用。**\n\n$f(x)$ 的导数是一个函数 $f'(x)$，满足：\n\n$$ \\displaystyle \\lim_{h \\to 0} f'(x)=\\dfrac{f(x+h)-f(x)}{h} $$\n\n我们称 $\\displaystyle \\lim_{x \\to a}g(x)=L$ 当且仅当对于任何实数 $\\epsilon > 0$ 我们都可以找到一个实数 $\\delta > 0$ 使得 $\\lvert g(x)-L\\rvert < \\epsilon$ 若 $0 < \\lvert x - a \\rvert < \\delta$。\n\n你可能用到以下的求导公式：\n\n1. $f(x)=C,f'(x)=0$，其中 $C$ 是一常数。\n2. $f(x)=x^n,f'(x)=nx^{n-1}$，其中 $n$ 为非 $0$ 常数。\n3. $(f(x)+g(x))'=f'(x)+g'(x)$\n4. $(f(x)g(x))'=f'(x)g(x)+f(x)g'(x)$\n5. $(f(g(x)))'=f'(g(x))g'(x)$", "locale": "zh-CN"}}}
{"pid": "P5241", "type": "P", "difficulty": 6, "samples": [["3\n", "1 2 4 7 7 7\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 3500, 3500, 3500, 3500, 3500], "memory": [1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000, 1024000]}, "tags": ["动态规划 DP", "贪心", "强连通分量", "洛谷月赛"], "title": "序列", "background": null, "description": "构建一个 $N$ 个点的有向图 $G$，初始没有任何边。\n\n接下来构建一个长度为 $E$ 的边的序列 $A$，序列中每条边都是满足 $1\\le s,t\\le N$ 且 $s\\neq t$ 的有向边 $(s,t)$，且序列中的边互不相同。\n\n按照顺序把这些边加入到 $G$ 中，每次加入后计算当前图的强连通分量个数并记录下来，得到一个新的长度为 $E$ 的正整数序列 $B$。\n\n- 如果两个边的序列得到的 $B$ 相同则称它们 **本质相同**。\n\n请问有多少种本质不同的边的序列，你只要求出答案对 $10^9+7$ 取模后的结果。", "inputFormat": "输入一行，一个正整数 $N$ 表示有向图 $G$ 的点数。", "outputFormat": "输出一行 $N\\times(N-1)$ 个由空格隔开的整数，第 $i$ 个数表示当 $E=i$ 时的答案。", "hint": "Subtask 1 (5pts)：$N\\le 5$。\n\nSubtask 2 (10pts)：$N\\le 10$。\n\nSubtask 3 (15pts)：$N\\le 20$。\n\nSubtask 4 (15pts)：$N\\le 30$。\n\nSubtask 5 (15pts)：$N\\le 50$。\n\nSubtask 6 (20pts)：$N\\le 100$。\n\nSubtask 7 (20pts)：无特殊限制。\n\n对于全部数据：$N\\le 400$。\n\n前 $6$ 个子任务限时 $1\\text s$，第 $7$ 个 $3.5\\text s$。\n\n## 代码长度限制：10kb 超过这个限制赛后将会被标记为无效。", "locale": "zh-CN", "translations": {"en": {"title": "Sequence", "background": "", "description": "Build a directed graph $G$ with $N$ vertices, with no edges at the beginning.\n\nNext, build an edge sequence $A$ of length $E$. Each edge in the sequence is a directed edge $(s,t)$ satisfying $1 \\le s,t \\le N$ and $s \\ne t$, and all edges in the sequence are distinct.\n\nAdd these edges to $G$ in order. After each addition, compute and record the current number of strongly connected components in the graph, obtaining a new positive integer sequence $B$ of length $E$.\n\n- If two edge sequences produce the same $B$, then they are called **essentially the same**.\n\nHow many essentially different edge sequences are there? You only need to output the answer modulo $10^9+7$.", "inputFormat": "Input one line containing a positive integer $N$, which denotes the number of vertices in the directed graph $G$.", "outputFormat": "Output one line containing $N \\times (N-1)$ integers separated by spaces. The $i$-th number represents the answer when $E=i$.", "hint": "Subtask 1 (5pts): $N \\le 5$.\n\nSubtask 2 (10pts): $N \\le 10$.\n\nSubtask 3 (15pts): $N \\le 20$.\n\nSubtask 4 (15pts): $N \\le 30$.\n\nSubtask 5 (15pts): $N \\le 50$.\n\nSubtask 6 (20pts): $N \\le 100$.\n\nSubtask 7 (20pts): No special constraints.\n\nConstraints: For all data, $N \\le 400$.\n\nFor the first $6$ subtasks, the time limit is $1\\text s$, and for the $7$-th it is $3.5\\text s$.\n\nCode length limit: 10kb. If it exceeds this limit, it will be marked as invalid after the contest.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "序列", "background": null, "description": "构建一个 $N$ 个点的有向图 $G$，初始没有任何边。\n\n接下来构建一个长度为 $E$ 的边的序列 $A$，序列中每条边都是满足 $1\\le s,t\\le N$ 且 $s\\neq t$ 的有向边 $(s,t)$，且序列中的边互不相同。\n\n按照顺序把这些边加入到 $G$ 中，每次加入后计算当前图的强连通分量个数并记录下来，得到一个新的长度为 $E$ 的正整数序列 $B$。\n\n- 如果两个边的序列得到的 $B$ 相同则称它们 **本质相同**。\n\n请问有多少种本质不同的边的序列，你只要求出答案对 $10^9+7$ 取模后的结果。", "inputFormat": "输入一行，一个正整数 $N$ 表示有向图 $G$ 的点数。", "outputFormat": "输出一行 $N\\times(N-1)$ 个由空格隔开的整数，第 $i$ 个数表示当 $E=i$ 时的答案。", "hint": "Subtask 1 (5pts)：$N\\le 5$。\n\nSubtask 2 (10pts)：$N\\le 10$。\n\nSubtask 3 (15pts)：$N\\le 20$。\n\nSubtask 4 (15pts)：$N\\le 30$。\n\nSubtask 5 (15pts)：$N\\le 50$。\n\nSubtask 6 (20pts)：$N\\le 100$。\n\nSubtask 7 (20pts)：无特殊限制。\n\n对于全部数据：$N\\le 400$。\n\n前 $6$ 个子任务限时 $1\\text s$，第 $7$ 个 $3.5\\text s$。\n\n## 代码长度限制：10kb 超过这个限制赛后将会被标记为无效。", "locale": "zh-CN"}}}
{"pid": "P5242", "type": "P", "difficulty": 6, "samples": [["3\n300000\n400000\n350000\n", "470000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "USACO", "三分", "斜率优化"], "title": "[USACO19FEB] Cow Dating P", "background": "", "description": "由于目前可供奶牛们使用的约会网站并没有给 Farmer John 留下深刻印象，他决定推出一个基于新匹配算法的奶牛交友网站，该算法可基于公牛和母牛间的共同兴趣对公牛和母牛进行匹配。\n\nBessie 在寻找情人节 Barn Dance 的合作伙伴时，决定试用这个网站。在注册账户之后，FJ 的算法为他给出了一个长度为 $ N $（$1 \\leq N \\leq 10^6$） 的匹配列表，列表上每头公牛接受她舞蹈邀请的概率为 $ p $（$0 < p < 1$）。\n\nBessie 决定向列表中的一个连续区间内的奶牛发送邀请，但Bessie希望**恰好只有一个奶牛**接受邀请。请帮助 Bessie 求出**恰好只有一个奶牛**接受邀请的最大概率是多少。", "inputFormat": "第一行输入一个整数 $ N $ 。\n\n接下来 $ N $ 行，每行包含一个整数，它的含义是 $ p_i $ 乘以 $ 10^6 $ 后的结果。", "outputFormat": "请输出**恰好只有一个奶牛**接受邀请的最大概率乘以 $ 10^6 $ 后向下取整后的结果。", "hint": "样例的最优方案是向第二和第三只奶牛发送邀请。\n\n子任务：对于 $ 25\\% $ 的数据， $ N \\leq 4000 $ 。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19FEB] Cow Dating P", "background": "", "description": "Since the current dating websites available to the cows did not impress Farmer John, he decided to launch a cow dating website based on a new matching algorithm. This algorithm matches bulls and cows based on their shared interests.\n\nWhen Bessie was looking for a partner for the Valentine’s Day Barn Dance, she decided to try this website. After registering an account, FJ’s algorithm produced a matching list of length $N$ ($1 \\leq N \\leq 10^6$). For each bull on the list, the probability that he will accept her dance invitation is $p$ ($0 < p < 1$).\n\nBessie decides to send invitations to the cows in one continuous interval of the list, but she wants **exactly one cow** to accept the invitation. Please help Bessie find the maximum probability that **exactly one cow** accepts the invitation.", "inputFormat": "The first line contains an integer $N$.\n\nThe next $N$ lines each contain an integer, meaning the value of $p_i$ multiplied by $10^6$.", "outputFormat": "Output the result of taking the maximum probability that **exactly one cow** accepts the invitation, multiplying it by $10^6$, and then rounding down to an integer.", "hint": "In the sample, the optimal plan is to send invitations to the second and third cows.\n\nSubtasks: For $25\\%$ of the testdata, $N \\leq 4000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19FEB] Cow Dating P", "background": "", "description": "由于目前可供奶牛们使用的约会网站并没有给 Farmer John 留下深刻印象，他决定推出一个基于新匹配算法的奶牛交友网站，该算法可基于公牛和母牛间的共同兴趣对公牛和母牛进行匹配。\n\nBessie 在寻找情人节 Barn Dance 的合作伙伴时，决定试用这个网站。在注册账户之后，FJ 的算法为他给出了一个长度为 $ N $（$1 \\leq N \\leq 10^6$） 的匹配列表，列表上每头公牛接受她舞蹈邀请的概率为 $ p $（$0 < p < 1$）。\n\nBessie 决定向列表中的一个连续区间内的奶牛发送邀请，但Bessie希望**恰好只有一个奶牛**接受邀请。请帮助 Bessie 求出**恰好只有一个奶牛**接受邀请的最大概率是多少。", "inputFormat": "第一行输入一个整数 $ N $ 。\n\n接下来 $ N $ 行，每行包含一个整数，它的含义是 $ p_i $ 乘以 $ 10^6 $ 后的结果。", "outputFormat": "请输出**恰好只有一个奶牛**接受邀请的最大概率乘以 $ 10^6 $ 后向下取整后的结果。", "hint": "样例的最优方案是向第二和第三只奶牛发送邀请。\n\n子任务：对于 $ 25\\% $ 的数据， $ N \\leq 4000 $ 。", "locale": "zh-CN"}}}
{"pid": "P5243", "type": "P", "difficulty": 6, "samples": [["5 3 1 12\n1 2 3\n2 3 4\n4 5 6\n", "54"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2019", "USACO"], "title": "[USACO19FEB] Moorio Kart P", "background": "", "description": "Bessie 和 Farmer John 喜欢山羊卡丁车比赛。这个比赛非常类似于其他人喜欢的卡丁车比赛，除了卡丁车是由山羊拉动，以及赛道是由农田组成。农田由 $ N $ 个草地和 $ M $ 条道路组成，每条道路都连接着两个草地。\n\n定义农场是两个或更多草地的一个集合，同一农场中的每个草地都可以沿着一系列**唯一**的道路到达农场中其他任意一个草地。\n\n整个农田可能由多个农场组成，假设图中有 $ K $ 个农场。Bessie 希望通过添加长度为 $ X $ 的 $ K $ 条道路，连接所有 $ K $ 个农场来制作山羊卡丁车赛道。每个农场只应访问一次，并且每个农场内必须至少穿过一条道路。\n\n为了让选手们对赛道更有兴趣，赛道的长度至少应该为 $ Y $ 。Bessie 希望知道所有这些有趣赛道的赛道长度总和。如果一个赛道中有两个农场直接相连，但另外一个赛道中这两个农场没有直接相连的话，这两个赛道就是不同的。\n\n---\n\n形式化题意：\n\n给定 $K$ 个连通块的森林，边有边权。你需要加入 $K$ 条长为 $X$ 的边使得整张图变成一棵基环树。原来的每个连通块在环上至少有一条边，所有新加入的边都应该在环上。\n\n求所有环长 $\\ge Y$ 的合法方案的环长之和。", "inputFormat": "第一行包括四个整数 $ N,M,X,Y $（$1 \\leq N \\leq 1500,1 \\leq M \\leq N-1,0 \\leq X, Y \\leq 2500$）。\n\n接下来 $ M $ 行，每行包含三个整数： $ A_i,B_i,D_i $（$1 \\leq A_i, B_i \\leq N,0 \\leq D_i \\leq 2500$），代表 $ A_i $ 号草地和 $ B_i $ 号草地间有一条长度为 $ D_i $ 的道路。保证两个草地间最多只有一条道路直接相连，且不存在自环。", "outputFormat": "输出有趣赛道的赛道长度总和 $\\pmod {10^9+7}$ 后的结果。", "hint": "有 6 个合法的赛道方案：\n\n- 1 --> 2 --> 4 --> 5 --> 1 (长度 11)\n- 1 --> 2 --> 5 --> 4 --> 1 (长度 11)\n- 2 --> 3 --> 4 --> 5 --> 2 (长度 12)\n- 2 --> 3 --> 5 --> 4 --> 2 (长度 12)\n- 1 --> 2 --> 3 --> 4 --> 5 --> 1 (长度 15)\n- 1 --> 2 --> 3 --> 5 --> 4 --> 1 (长度 15)\n\n其中后 4 条赛道满足了赛道总长不低于 12 的条件，这几条赛道的长度总和为 54。\n\n子任务：对于 $ 70\\% $ 的数据， $ N,Y \\leq 1000 $ 。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19FEB] Moorio Kart P", "background": "", "description": "Bessie and Farmer John enjoy goat go-kart racing. This competition is very similar to the go-kart racing that other people like, except that the karts are pulled by goats, and the track consists of farmland. The farmland consists of $N$ pastures and $M$ roads, and each road connects two pastures.\n\nDefine a farm as a set of two or more pastures such that within the same farm, every pasture can reach any other pasture in the farm along a sequence of **unique** roads.\n\nThe entire farmland may consist of multiple farms. Suppose there are $K$ farms in the graph. Bessie wants to create a goat go-kart track by adding $K$ roads of length $X$ to connect all $K$ farms. Each farm should be visited only once, and within each farm, at least one road must be traversed.\n\nTo make the track more interesting for the contestants, the length of the track should be at least $Y$. Bessie wants to know the sum of track lengths of all such interesting tracks. If two farms are directly connected in one track, but those two farms are not directly connected in another track, then these two tracks are considered different.\n\n---\n\nFormal statement:\n\nYou are given a forest with $K$ connected components, with weighted edges. You need to add $K$ edges of length $X$ so that the entire graph becomes a unicyclic graph (a tree with exactly one cycle). Each original connected component must have at least one edge on the cycle, and all newly added edges must be on the cycle.\n\nFind the sum of the cycle lengths over all valid constructions whose cycle length is $\\ge Y$.", "inputFormat": "The first line contains four integers $N, M, X, Y$ ($1 \\leq N \\leq 1500, 1 \\leq M \\leq N-1, 0 \\leq X, Y \\leq 2500$).\n\nThe next $M$ lines each contain three integers: $A_i, B_i, D_i$ ($1 \\leq A_i, B_i \\leq N, 0 \\leq D_i \\leq 2500$), indicating that there is a road of length $D_i$ between pastures $A_i$ and $B_i$. It is guaranteed that there is at most one road directly connecting any two pastures, and there are no self-loops.", "outputFormat": "Output the sum of lengths of all interesting tracks modulo $10^9+7$.", "hint": "There are 6 valid track constructions:\n\n- 1 --> 2 --> 4 --> 5 --> 1 (length 11).\n- 1 --> 2 --> 5 --> 4 --> 1 (length 11).\n- 2 --> 3 --> 4 --> 5 --> 2 (length 12).\n- 2 --> 3 --> 5 --> 4 --> 2 (length 12).\n- 1 --> 2 --> 3 --> 4 --> 5 --> 1 (length 15).\n- 1 --> 2 --> 3 --> 5 --> 4 --> 1 (length 15).\n\nAmong them, the last 4 tracks satisfy the requirement that the total track length is at least 12, and the sum of their lengths is 54.\n\nSubtasks: For $70\\%$ of the testdata, $N, Y \\leq 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19FEB] Moorio Kart P", "background": "", "description": "Bessie 和 Farmer John 喜欢山羊卡丁车比赛。这个比赛非常类似于其他人喜欢的卡丁车比赛，除了卡丁车是由山羊拉动，以及赛道是由农田组成。农田由 $ N $ 个草地和 $ M $ 条道路组成，每条道路都连接着两个草地。\n\n定义农场是两个或更多草地的一个集合，同一农场中的每个草地都可以沿着一系列**唯一**的道路到达农场中其他任意一个草地。\n\n整个农田可能由多个农场组成，假设图中有 $ K $ 个农场。Bessie 希望通过添加长度为 $ X $ 的 $ K $ 条道路，连接所有 $ K $ 个农场来制作山羊卡丁车赛道。每个农场只应访问一次，并且每个农场内必须至少穿过一条道路。\n\n为了让选手们对赛道更有兴趣，赛道的长度至少应该为 $ Y $ 。Bessie 希望知道所有这些有趣赛道的赛道长度总和。如果一个赛道中有两个农场直接相连，但另外一个赛道中这两个农场没有直接相连的话，这两个赛道就是不同的。\n\n---\n\n形式化题意：\n\n给定 $K$ 个连通块的森林，边有边权。你需要加入 $K$ 条长为 $X$ 的边使得整张图变成一棵基环树。原来的每个连通块在环上至少有一条边，所有新加入的边都应该在环上。\n\n求所有环长 $\\ge Y$ 的合法方案的环长之和。", "inputFormat": "第一行包括四个整数 $ N,M,X,Y $（$1 \\leq N \\leq 1500,1 \\leq M \\leq N-1,0 \\leq X, Y \\leq 2500$）。\n\n接下来 $ M $ 行，每行包含三个整数： $ A_i,B_i,D_i $（$1 \\leq A_i, B_i \\leq N,0 \\leq D_i \\leq 2500$），代表 $ A_i $ 号草地和 $ B_i $ 号草地间有一条长度为 $ D_i $ 的道路。保证两个草地间最多只有一条道路直接相连，且不存在自环。", "outputFormat": "输出有趣赛道的赛道长度总和 $\\pmod {10^9+7}$ 后的结果。", "hint": "有 6 个合法的赛道方案：\n\n- 1 --> 2 --> 4 --> 5 --> 1 (长度 11)\n- 1 --> 2 --> 5 --> 4 --> 1 (长度 11)\n- 2 --> 3 --> 4 --> 5 --> 2 (长度 12)\n- 2 --> 3 --> 5 --> 4 --> 2 (长度 12)\n- 1 --> 2 --> 3 --> 4 --> 5 --> 1 (长度 15)\n- 1 --> 2 --> 3 --> 5 --> 4 --> 1 (长度 15)\n\n其中后 4 条赛道满足了赛道总长不低于 12 的条件，这几条赛道的长度总和为 54。\n\n子任务：对于 $ 70\\% $ 的数据， $ N,Y \\leq 1000 $ 。", "locale": "zh-CN"}}}
{"pid": "P5244", "type": "P", "difficulty": 7, "samples": [["5 20\n19 1\n2 6\n9 15\n10 3\n13 11", "117"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2019", "线段树", "USACO", "动态规划优化", "决策单调性"], "title": "[USACO19FEB] Mowing Mischief P", "background": null, "description": "Bessie 的表妹 Ella 和 Bella 正在参观农场。不幸的是，自从他们到达以来，他们一直在恶作剧。\n\n在他们的最新计划中，他们决定尽可能多地割草。农场的草地是 $ T \\times T $ 的正方形。左下角是 $ (0,0) $ ，右上角是 $ (T,T) $ 。因此，正方形包含 $ (T+1)^2 $ 个格点（具有整数坐标的点）。\n\nElla 和 Bella 计划从 $ (0,0) $ 开始并以每秒一个单位长度的速度运行到 $ (T,T) $ ，同时每只奶牛都握住非常锋利且非常有弹性的线的一端。任何被这根电线扫过的区域的草都会被切断。Ella 和 Bella 可能采取不同的路径，但她们只会向上或者向右移动，从一个格点移动到另一个格点。\n\nBessie 非常担心会切割太多的草，所以她发明了一个聪明的计划来限制 Ella 和 Bella 的路径。在整个草原上散布着 $ N $ 种花（ $ 1 \\leq N \\leq 2 \\times 10^5 $ ），每种花都在一个特定的格点上。 Bessie 将从这些花中挑选一个子集 $ S $ ， $ S $ 集合中的花 Ella 和 Bella 都需要经过（Ella 和 Bella 的路径都必须经过 $ S $ 中的所有花朵）。\n\nElla 和 Bella 将会切割面积尽可能大的草，请帮助Bessie确定集合 $ S $ 使得在 $ S $ 集合尽可能大的情况下被切割的草的**面积**最小。", "inputFormat": "输入第一行包括两个数 $ N,T $（$1 \\leq T \\leq 10^6$）。\n\n接下来 $ N $ 行每行包含两个数 $ x_i,y_i $ ，代表一种花的位置。\n\n保证 $ 1 \\leq x_i,y_i \\leq T-1 $，且不存在两朵花在同一条水平或竖直线上。", "outputFormat": "输出一个整数，即被切割的草的**面积**的最小值。", "hint": "选择 $ (10,3) $ 和 $ (13,11) $ 这两个位置上的花，可以使得被切割的草的面积最小。\n\n子任务：对于 $ 20\\% $ 的数据， $ N \\leq 3200 $ 。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO19FEB] Mowing Mischief P", "background": "", "description": "Bessie’s cousins, Ella and Bella, are visiting the farm. Unfortunately, ever since they arrived, they have been causing trouble.\n\nIn their latest scheme, they decide to mow as much grass as possible. The farm’s grassland is a $T \\times T$ square. The lower-left corner is $(0,0)$, and the upper-right corner is $(T,T)$. Therefore, the square contains $(T+1)^2$ lattice points (points with integer coordinates).\n\nElla and Bella plan to start from $(0,0)$ and run to $(T,T)$ at a speed of one unit length per second. At the same time, each cow holds one end of a very sharp and very elastic wire. Any area swept by this wire will have its grass cut. Ella and Bella may take different paths, but they will only move up or right, traveling from one lattice point to another.\n\nBessie is very worried that too much grass will be cut, so she comes up with a clever plan to restrict Ella and Bella’s paths. There are $N$ flowers scattered across the grassland ($1 \\leq N \\leq 2 \\times 10^5$), and each flower is located at a specific lattice point. Bessie will choose a subset $S$ of these flowers. Both Ella and Bella must pass through all flowers in $S$ (that is, both of their paths must go through every flower in $S$).\n\nElla and Bella will cut an area of grass as large as possible. Please help Bessie determine the set $S$ so that, while $S$ is as large as possible, the **area** of grass that gets cut is minimized.", "inputFormat": "The first line contains two integers $N, T$ ($1 \\leq T \\leq 10^6$).\n\nThe next $N$ lines each contain two integers $x_i, y_i$, representing the position of a flower.\n\nIt is guaranteed that $1 \\leq x_i, y_i \\leq T-1$, and no two flowers lie on the same horizontal or vertical line.", "outputFormat": "Output one integer: the minimum possible **area** of grass that gets cut.", "hint": "Choosing the flowers at positions $(10,3)$ and $(13,11)$ can minimize the area of grass that gets cut.\n\nSubtasks: For $20\\%$ of the testdata, $N \\leq 3200$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO19FEB] Mowing Mischief P", "background": null, "description": "Bessie 的表妹 Ella 和 Bella 正在参观农场。不幸的是，自从他们到达以来，他们一直在恶作剧。\n\n在他们的最新计划中，他们决定尽可能多地割草。农场的草地是 $ T \\times T $ 的正方形。左下角是 $ (0,0) $ ，右上角是 $ (T,T) $ 。因此，正方形包含 $ (T+1)^2 $ 个格点（具有整数坐标的点）。\n\nElla 和 Bella 计划从 $ (0,0) $ 开始并以每秒一个单位长度的速度运行到 $ (T,T) $ ，同时每只奶牛都握住非常锋利且非常有弹性的线的一端。任何被这根电线扫过的区域的草都会被切断。Ella 和 Bella 可能采取不同的路径，但她们只会向上或者向右移动，从一个格点移动到另一个格点。\n\nBessie 非常担心会切割太多的草，所以她发明了一个聪明的计划来限制 Ella 和 Bella 的路径。在整个草原上散布着 $ N $ 种花（ $ 1 \\leq N \\leq 2 \\times 10^5 $ ），每种花都在一个特定的格点上。 Bessie 将从这些花中挑选一个子集 $ S $ ， $ S $ 集合中的花 Ella 和 Bella 都需要经过（Ella 和 Bella 的路径都必须经过 $ S $ 中的所有花朵）。\n\nElla 和 Bella 将会切割面积尽可能大的草，请帮助Bessie确定集合 $ S $ 使得在 $ S $ 集合尽可能大的情况下被切割的草的**面积**最小。", "inputFormat": "输入第一行包括两个数 $ N,T $（$1 \\leq T \\leq 10^6$）。\n\n接下来 $ N $ 行每行包含两个数 $ x_i,y_i $ ，代表一种花的位置。\n\n保证 $ 1 \\leq x_i,y_i \\leq T-1 $，且不存在两朵花在同一条水平或竖直线上。", "outputFormat": "输出一个整数，即被切割的草的**面积**的最小值。", "hint": "选择 $ (10,3) $ 和 $ (13,11) $ 这两个位置上的花，可以使得被切割的草的面积最小。\n\n子任务：对于 $ 20\\% $ 的数据， $ N \\leq 3200 $ 。", "locale": "zh-CN"}}}
{"pid": "P5245", "type": "P", "difficulty": 6, "samples": [["9 18948465\n1 2 3 4 5 6 7 8 9", "1 37896930 597086012 720637306 161940419 360472177 560327751 446560856 524295016"], ["4 1\n1 1 0 0\n", "1 1 0 0"], ["4 2\n1 1 0 0\n", "1 2 1 0\n"], ["4 3\n1 1 0 0", "1 3 3 1"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["O2优化", "模板题"], "title": "【模板】多项式快速幂", "background": "[加强版传送门](https://www.luogu.com.cn/problem/P5273)\n\n模板题，无背景", "description": "给定一个 $n-1$ 次多项式 $A(x)$，求一个在 $\\bmod\\ x^n$ 意义下的多项式 $B(x)$，使得 $B(x) \\equiv (A(x))^k \\ (\\bmod\\ x^n)$。\n\n多项式的系数在 $\\bmod\\ 998244353$ 的意义下进行运算。", "inputFormat": "第一行两个整数 $n,k$。\n\n接下来 $n$ 个整数，依次表示 $A(x)$ 的系数 $a_0, a_1,...,a_{n-1}$。", "outputFormat": "输出 $n$ 个整数，依次表示 $B(x)$ 的前 $n$ 项系数 $b_0, b_1,...,b_{n-1}$ 在模 $998244353$ 意义下的最小自然数值。", "hint": "对于 $100\\%$ 的数据，$1 < n \\leq 10^5$，$0 < k \\leq 10^{10^5}$，$a_i \\in [0,998244352]$，$a_0=1$。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Fast Polynomial Exponentiation", "background": "[Enhanced version link](https://www.luogu.com.cn/problem/P5273)\n\nThis is a template problem, with no background.", "description": "Given a polynomial $A(x)$ of degree $n-1$, find a polynomial $B(x)$ modulo $x^n$ such that $B(x) \\equiv (A(x))^k \\ (\\bmod\\ x^n)$.\n\nThe coefficients of the polynomials are computed modulo $998244353$.", "inputFormat": "The first line contains two integers $n, k$.\n\nThe next line contains $n$ integers, representing the coefficients of $A(x)$ in order: $a_0, a_1, ..., a_{n-1}$.", "outputFormat": "Output $n$ integers, representing the first $n$ coefficients of $B(x)$ in order: $b_0, b_1, ..., b_{n-1}$. Each coefficient should be the smallest non-negative integer modulo $998244353$.", "hint": "For $100\\%$ of the testdata, $1 < n \\leq 10^5$, $0 < k \\leq 10^{10^5}$, $a_i \\in [0,998244352]$, and $a_0 = 1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】多项式快速幂", "background": "[加强版传送门](https://www.luogu.com.cn/problem/P5273)\n\n模板题，无背景", "description": "给定一个 $n-1$ 次多项式 $A(x)$，求一个在 $\\bmod\\ x^n$ 意义下的多项式 $B(x)$，使得 $B(x) \\equiv (A(x))^k \\ (\\bmod\\ x^n)$。\n\n多项式的系数在 $\\bmod\\ 998244353$ 的意义下进行运算。", "inputFormat": "第一行两个整数 $n,k$。\n\n接下来 $n$ 个整数，依次表示 $A(x)$ 的系数 $a_0, a_1,...,a_{n-1}$。", "outputFormat": "输出 $n$ 个整数，依次表示 $B(x)$ 的前 $n$ 项系数 $b_0, b_1,...,b_{n-1}$ 在模 $998244353$ 意义下的最小自然数值。", "hint": "对于 $100\\%$ 的数据，$1 < n \\leq 10^5$，$0 < k \\leq 10^{10^5}$，$a_i \\in [0,998244352]$，$a_0=1$。", "locale": "zh-CN"}}}
