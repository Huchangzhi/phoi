{"pid": "P3329", "type": "P", "difficulty": 6, "samples": [["1\n5 0\n1\n0", "10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "各省省选", "网络流", "浙江", "分治", "最小割"], "title": "[ZJOI2011] 最小割", "background": null, "description": "小白在图论课上学到了一个新的概念——最小割，下课后小白在笔记本上写下了如下这段话： \n\n对于一个图，某个对图中结点的划分将图中所有结点分成两个部分，如果结点 $s$ 和 $t$ 不在同一个部分中，则称这个划分是关于 $s,t$ 的割。对于带权图来说，将所有顶点处在不同部分的边的权值相加所得到的值定义为这个割的容量，而 $s,t$ 的最小割指的是在关于 $s,t$ 的割中容量最小的割。\n\n现给定一张无向图，小白有若干个形如“图中有多少个无序点对的最小割的容量不超过 $x$ ”的疑问，小蓝虽然很想回答这些问题，但小蓝最近忙着挖木块，于是作为小蓝的好友，你又有任务了。", "inputFormat": "**本题有多组测试数据。**\n\n第一行一个整数 $T$，表示测试数据组数。\n\n对于每组测试数据，第一行两个整数 $n,m$，表示图的点数和边数。\n\n接下来 $m$ 行，每行三个整数 $u,v,c$ 表示有一条权为 $c$ 的无向边 $(u,v)$。不保证图中无重边。\n\n接下来一行一个整数 $q$ 表示询问的个数，下面 $q$ 行每行一个整数 $x$ 描述一组询问。", "outputFormat": "对于每一组测试数据输出 $q$ 行，每行一个整数表示对应询问的答案。对于满足条件的点对 $(p,q)$ 和点对 $(q,p)$ 只应该在答案中统计一次。\n\n**在两组测试数据之间需要输出一行空行。**", "hint": "对于 $100 \\%$ 的数据，$1 \\leq T \\leq 10$，$1 \\leq n \\leq 150$，$0 \\leq m \\leq 3000$，$0 \\leq x \\leq 2^{31}-1$，$0 \\leq q \\leq 30$，$1\\leq u,v\\leq n$，$0\\leq c\\leq 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2011] Minimum Cut", "background": "", "description": "Xiaobai learned a new concept—minimum cut—in a graph theory class. After class, Xiaobai wrote the following in the notebook:\n\nFor a graph, a partition of the vertices divides all vertices into two parts. If vertices $s$ and $t$ are not in the same part, then this partition is called a cut with respect to $s,t$. For a weighted graph, the sum of the weights of all edges whose endpoints lie in different parts is defined as the capacity of this cut, and the minimum cut of $s,t$ is the cut with the minimum capacity among all cuts with respect to $s,t$.\n\nGiven an undirected graph, Xiaobai has several questions of the form “how many unordered pairs of vertices have minimum-cut capacity not exceeding $x$”. Xiaolan would like to answer these questions but is currently busy mining wooden blocks, so as Xiaolan’s friend, the task falls on you.", "inputFormat": "This problem contains multiple test cases.\n\nThe first line contains an integer $T$, the number of test cases.\n\nFor each test case, the first line contains two integers $n,m$, the number of vertices and edges.\n\nThe next $m$ lines each contain three integers $u,v,c$, indicating an undirected edge $(u,v)$ with weight $c$. Multiple edges are allowed.\n\nThen a line with an integer $q$ follows, the number of queries. Each of the next $q$ lines contains an integer $x$ describing one query.", "outputFormat": "For each test case, output $q$ lines, each containing one integer: the answer to the corresponding query. For a qualifying pair $(p,q)$ and the pair $(q,p)$, count only once.\n\nOutput one empty line between two consecutive test cases.", "hint": "For $100\\%$ of the testdata, $1 \\leq T \\leq 10$, $1 \\leq n \\leq 150$, $0 \\leq m \\leq 3000$, $0 \\leq x \\leq 2^{31}-1$, $0 \\leq q \\leq 30$, $1 \\leq u,v \\leq n$, $0 \\leq c \\leq 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2011] 最小割", "background": null, "description": "小白在图论课上学到了一个新的概念——最小割，下课后小白在笔记本上写下了如下这段话： \n\n对于一个图，某个对图中结点的划分将图中所有结点分成两个部分，如果结点 $s$ 和 $t$ 不在同一个部分中，则称这个划分是关于 $s,t$ 的割。对于带权图来说，将所有顶点处在不同部分的边的权值相加所得到的值定义为这个割的容量，而 $s,t$ 的最小割指的是在关于 $s,t$ 的割中容量最小的割。\n\n现给定一张无向图，小白有若干个形如“图中有多少个无序点对的最小割的容量不超过 $x$ ”的疑问，小蓝虽然很想回答这些问题，但小蓝最近忙着挖木块，于是作为小蓝的好友，你又有任务了。", "inputFormat": "**本题有多组测试数据。**\n\n第一行一个整数 $T$，表示测试数据组数。\n\n对于每组测试数据，第一行两个整数 $n,m$，表示图的点数和边数。\n\n接下来 $m$ 行，每行三个整数 $u,v,c$ 表示有一条权为 $c$ 的无向边 $(u,v)$。不保证图中无重边。\n\n接下来一行一个整数 $q$ 表示询问的个数，下面 $q$ 行每行一个整数 $x$ 描述一组询问。", "outputFormat": "对于每一组测试数据输出 $q$ 行，每行一个整数表示对应询问的答案。对于满足条件的点对 $(p,q)$ 和点对 $(q,p)$ 只应该在答案中统计一次。\n\n**在两组测试数据之间需要输出一行空行。**", "hint": "对于 $100 \\%$ 的数据，$1 \\leq T \\leq 10$，$1 \\leq n \\leq 150$，$0 \\leq m \\leq 3000$，$0 \\leq x \\leq 2^{31}-1$，$0 \\leq q \\leq 30$，$1\\leq u,v\\leq n$，$0\\leq c\\leq 10^6$。", "locale": "zh-CN"}}}
{"pid": "P3330", "type": "P", "difficulty": 6, "samples": [["3\n1 1\n2 1\n2 2", "1 1\n0 1\n3 4\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "高精度", "2011", "各省省选", "浙江", "组合数学"], "title": "[ZJOI2011] 看电影", "background": "", "description": "到了难得的假期，小白班上组织大家去看电影。但由于假期里看电影的人太多，很难做到让全班看上同一场电影。最后大家在一个偏僻的小胡同里找到了一家电影院，但这家电影院分配座位的方式很特殊，具体方式如下：\n\n电影院的座位共有 $K$ 个，并被标号为 $1 \\sim K$。每个人买完票后会被随机指定一个座位，具体来说是从 $1 \\sim K$ 中等概率随机选取一个正整数，设其为 $L$。\n\n如果编号 $L$ 的座位是空位，则这个座位就分配给此人，否则将 $L$ 加一，继续前面的步骤；如果不存在编号 $L$ 的座位，则该人只能站着看电影，即所谓的站票。\n\n小白班上共有 $N$ 人（包括小白自己），作为数学爱好者，小白想知道全班都能够有座位的概率是多少。\n", "inputFormat": "本题有多组数据。第一行一个整数 $T$ 表示数据组数，接下来 $T$ 行每行两个整数 $N,K$ 表示人数和电影院座位数。", "outputFormat": "对于每一组数据数据输出一行两个整数 $A,B$，表示答案为 $\\frac{A}{B}$。你需要保证 $\\gcd(A,B) = 1$。", "hint": "对于 $100 \\%$ 的数据，$1 \\leq T \\leq 50$，$1 \\leq N,K \\leq 200$。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2011] Watching a Movie", "background": "", "description": "During a rare holiday, Xiaobai’s (Xiaobai) class organizes a movie trip. However, because many people watch movies during holidays, it is hard to seat everyone in the same showing. Finally, they find a cinema in a remote alley, but its seating assignment is special, as follows:\n\nThe cinema has $K$ seats, labeled $1 \\sim K$. After buying a ticket, each person is randomly assigned a seat. Specifically, an integer is chosen uniformly at random from $1 \\sim K$, and let it be $L$.\n\nIf seat $L$ is empty, this seat is assigned to the person. Otherwise, increase $L$ by one and repeat the previous step; if there is no seat numbered $L$, then the person has to stand to watch the movie, i.e., a standing ticket.\n\nThere are $N$ people in Xiaobai’s class (including Xiaobai). As a math enthusiast, Xiaobai wants to know the probability that the whole class can get seats.", "inputFormat": "Multiple test cases. The first line contains an integer $T$ denoting the number of test cases. Then each of the next $T$ lines contains two integers $N,K$ denoting the number of people and the number of seats in the cinema.", "outputFormat": "For each test case, output two integers $A,B$ on one line, indicating that the answer is $\\frac{A}{B}$. You need to ensure $\\gcd(A,B) = 1$.", "hint": "For $100 \\%$ of the testdata, $1 \\leq T \\leq 50$, $1 \\leq N,K \\leq 200$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2011] 看电影", "background": "", "description": "到了难得的假期，小白班上组织大家去看电影。但由于假期里看电影的人太多，很难做到让全班看上同一场电影。最后大家在一个偏僻的小胡同里找到了一家电影院，但这家电影院分配座位的方式很特殊，具体方式如下：\n\n电影院的座位共有 $K$ 个，并被标号为 $1 \\sim K$。每个人买完票后会被随机指定一个座位，具体来说是从 $1 \\sim K$ 中等概率随机选取一个正整数，设其为 $L$。\n\n如果编号 $L$ 的座位是空位，则这个座位就分配给此人，否则将 $L$ 加一，继续前面的步骤；如果不存在编号 $L$ 的座位，则该人只能站着看电影，即所谓的站票。\n\n小白班上共有 $N$ 人（包括小白自己），作为数学爱好者，小白想知道全班都能够有座位的概率是多少。\n", "inputFormat": "本题有多组数据。第一行一个整数 $T$ 表示数据组数，接下来 $T$ 行每行两个整数 $N,K$ 表示人数和电影院座位数。", "outputFormat": "对于每一组数据数据输出一行两个整数 $A,B$，表示答案为 $\\frac{A}{B}$。你需要保证 $\\gcd(A,B) = 1$。", "hint": "对于 $100 \\%$ 的数据，$1 \\leq T \\leq 50$，$1 \\leq N,K \\leq 200$。", "locale": "zh-CN"}}}
{"pid": "P3331", "type": "P", "difficulty": 5, "samples": [["3 2 5\nPNNNN\nPNNNN\nNPPNP\nPNNNP\nNNNNP\nPPNNP", "24"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2011", "各省省选", "浙江"], "title": "[ZJOI2011] 礼物", "background": "", "description": "小白的生日就要到了，小蓝决定送一件自己亲手做的手工艺品使自己的礼物与众不同。具体来说，小蓝已经通过某种方式制作出了一个 $p\\times q\\times r$ 的木块（由 $pqr$ 个单位小木块组成）。\n\n但由于小蓝手艺不精，现在这个木块中的有些单位小木块是有问题的（有裂缝、里面是空心等等），这样的礼物小蓝是不可能直接送出去的。于是小蓝决定在这个木块中再挖出一个 $a\\times a\\times b$ 的子木块（即要求挖出的长方体木块存在两条长度相等的相邻边），当然这个子木块中是不能包含有问题的单位小木块的。\n\n为了使这个木块上能包含更多的图案，小蓝希望从所有可行的方案中挑取 $4ab$ 的值最大的方案。但小蓝光检测木块中哪些地方有问题就已经耗尽了体力，作为小蓝的好友，你能帮帮小蓝吗？\n", "inputFormat": "每个输入文件中仅包含一个测试数据。\n\n第一行包含三个由空格隔开的正整数，$p,q,r$。 \n\n接下来有 $pq$ 行，每行包含 $r$ 个字符，每个字符只可能是 `P`（Poor）或者 `N`（Nice），分别表示该单位小木块有问题或者没问题。具体的说，第 $1+(yp+x-p)$ 行的第 $z$ 个字符描述的是坐标为 $(x,y,z)$ 的小木块情况。\n", "outputFormat": "输出文件仅包含一个整数，表示最佳方案的 $4ab$ 的值。\n", "hint": "对于 $100\\%$ 的数据，$0<p,q,r\\le 150$，输入中至少包含一个 `N`。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2011] Gift", "background": "", "description": "Xiaolan wants to give a unique handmade present for Xiaobai’s upcoming birthday. Specifically, Xiaolan has somehow made a $p\\times q\\times r$ wooden block (composed of $p q r$ unit cubes).\n\nHowever, due to lack of skill, some unit cubes inside this block are defective (cracks, hollow inside, etc.), so Xiaolan cannot give it as-is. Xiaolan decides to carve out an $a\\times a\\times b$ sub-block from it (i.e., the carved rectangular block must have two adjacent edges of equal length). Of course, this sub-block must not contain any defective unit cubes.\n\nTo allow more patterns on the block, Xiaolan wants to choose, among all feasible plans, the one that maximizes the value of $4ab$. But Xiaolan is exhausted after checking which unit cubes are defective. As Xiaolan’s friend, can you help?", "inputFormat": "Each input file contains exactly one testdata.\n\nThe first line contains three positive integers $p, q, r$ separated by spaces.\n\nThen there are $p q$ lines, each containing $r$ characters. Each character is either `P` (Poor) or `N` (Nice), indicating whether the corresponding unit cube is defective or not. Specifically, in line number $1 + (y p + x - p)$, the $z$-th character describes the cube at coordinate $(x, y, z)$.", "outputFormat": "The output contains exactly one integer: the maximum possible value of $4ab$.", "hint": "For $100\\%$ of the testdata, $0 < p, q, r \\le 150$, and the input contains at least one `N`.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2011] 礼物", "background": "", "description": "小白的生日就要到了，小蓝决定送一件自己亲手做的手工艺品使自己的礼物与众不同。具体来说，小蓝已经通过某种方式制作出了一个 $p\\times q\\times r$ 的木块（由 $pqr$ 个单位小木块组成）。\n\n但由于小蓝手艺不精，现在这个木块中的有些单位小木块是有问题的（有裂缝、里面是空心等等），这样的礼物小蓝是不可能直接送出去的。于是小蓝决定在这个木块中再挖出一个 $a\\times a\\times b$ 的子木块（即要求挖出的长方体木块存在两条长度相等的相邻边），当然这个子木块中是不能包含有问题的单位小木块的。\n\n为了使这个木块上能包含更多的图案，小蓝希望从所有可行的方案中挑取 $4ab$ 的值最大的方案。但小蓝光检测木块中哪些地方有问题就已经耗尽了体力，作为小蓝的好友，你能帮帮小蓝吗？\n", "inputFormat": "每个输入文件中仅包含一个测试数据。\n\n第一行包含三个由空格隔开的正整数，$p,q,r$。 \n\n接下来有 $pq$ 行，每行包含 $r$ 个字符，每个字符只可能是 `P`（Poor）或者 `N`（Nice），分别表示该单位小木块有问题或者没问题。具体的说，第 $1+(yp+x-p)$ 行的第 $z$ 个字符描述的是坐标为 $(x,y,z)$ 的小木块情况。\n", "outputFormat": "输出文件仅包含一个整数，表示最佳方案的 $4ab$ 的值。\n", "hint": "对于 $100\\%$ 的数据，$0<p,q,r\\le 150$，输入中至少包含一个 `N`。", "locale": "zh-CN"}}}
{"pid": "P3332", "type": "P", "difficulty": 6, "samples": [["2 5\n1 1 2 1\n1 1 2 2\n2 1 1 2\n2 1 1 1\n2 1 2 3", "1\n2\n1"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2013", "线段树", "各省省选", "浙江", "树套树", "整体二分"], "title": "[ZJOI2013] K大数查询", "background": "", "description": "你需要维护 $n$ 个可重整数集，集合的编号从 $1$ 到 $n$。  \n这些集合初始都是空集，有 $m$ 个操作：  \n\n- `1 l r c`：表示将 $c$ 加入到编号在 $[l,r]$ 内的集合中  \n- `2 l r c`：表示查询编号在 $[l,r]$ 内的集合的并集中，第 $c$ 大的数是多少。  \n\n注意可重集的并是不去除重复元素的，如 $\\{1,1,4\\}\\cup\\{5,1,4\\}=\\{1,1,4,5,1,4\\}$。\n", "inputFormat": "第一行两个正整数 $n,m$，表示集合个数和操作个数。  \n接下来 $m$ 行，每行四个整数表示一次操作。\n", "outputFormat": "对于每个 $2$ 操作，输出一行一个整数表示答案。\n", "hint": "【样例说明】   \n第 $1$ 次操作在 $1,2$ 号集合中分别加入了一个  $1$。    \n第 $2$ 次操作在 $1,2$ 号集合中分别加入了一个 $2$。   \n第 $3$ 次操作查询 $1$ 号集合中第 $2$ 大的数，答案为 $1$。  \n第 $4$ 次操作查询 $1$ 号集合中第 $1$ 大的数，答案为 $2$。    \n第 $5$ 次操作查询 $1,2$ 号集合的并集 $\\{1,2,1,2\\}$ 中第 $3$ 大的数，答案为 $1$。\n\n【数据范围】  \n$1 \\le n,m \\le 5\\times 10^4$   \n$1\\le l,r \\le n$   \n$1$ 操作中 $|c|\\le n$   \n$2$ 操作中 $1\\le c < 2^{63}$，第 $c$ 大的数存在\n\n---\n\n$\\text{upd 2023.8.23}$：新增加一组 Hack 数据。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2013] K-th Largest Number Query", "background": "", "description": "You need to maintain $n$ multisets of integers, numbered from $1$ to $n$.  \nAll sets are initially empty. There are $m$ operations:\n\n- `1 l r c`: Add $c$ to every set with index in $[l,r]$.  \n- `2 l r c`: Query the $c$-th largest number in the union of all sets with indices in $[l,r]$.\n\nNote that the union of multisets does not remove duplicates, e.g., $\\{1,1,4\\}\\cup\\{5,1,4\\}=\\{1,1,4,5,1,4\\}$.", "inputFormat": "The first line contains two positive integers $n, m$, the number of sets and the number of operations.  \nEach of the next $m$ lines contains four integers describing one operation.", "outputFormat": "For each operation of type `2`, output one line with a single integer, the answer.", "hint": "[Sample Explanation]  \nThe 1st operation adds one $1$ to sets $1$ and $2$.  \nThe 2nd operation adds one $2$ to sets $1$ and $2$.  \nThe 3rd operation queries the 2nd largest number in set $1$, which is $1$.  \nThe 4th operation queries the 1st largest number in set $1$, which is $2$.  \nThe 5th operation queries the 3rd largest number in the union $\\{1,2,1,2\\}$ of sets $1$ and $2$, which is $1$.\n\nConstraints  \n$1 \\le n,m \\le 5\\times 10^4$  \n$1 \\le l,r \\le n$  \nIn operation `1`, $|c| \\le n$  \nIn operation `2`, $1 \\le c < 2^{63}$, and the $c$-th largest number exists.\n\n---\n\n$\\text{upd 2023.8.23}$：Added a new set of hack testdata.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2013] K大数查询", "background": "", "description": "你需要维护 $n$ 个可重整数集，集合的编号从 $1$ 到 $n$。  \n这些集合初始都是空集，有 $m$ 个操作：  \n\n- `1 l r c`：表示将 $c$ 加入到编号在 $[l,r]$ 内的集合中  \n- `2 l r c`：表示查询编号在 $[l,r]$ 内的集合的并集中，第 $c$ 大的数是多少。  \n\n注意可重集的并是不去除重复元素的，如 $\\{1,1,4\\}\\cup\\{5,1,4\\}=\\{1,1,4,5,1,4\\}$。\n", "inputFormat": "第一行两个正整数 $n,m$，表示集合个数和操作个数。  \n接下来 $m$ 行，每行四个整数表示一次操作。\n", "outputFormat": "对于每个 $2$ 操作，输出一行一个整数表示答案。\n", "hint": "【样例说明】   \n第 $1$ 次操作在 $1,2$ 号集合中分别加入了一个  $1$。    \n第 $2$ 次操作在 $1,2$ 号集合中分别加入了一个 $2$。   \n第 $3$ 次操作查询 $1$ 号集合中第 $2$ 大的数，答案为 $1$。  \n第 $4$ 次操作查询 $1$ 号集合中第 $1$ 大的数，答案为 $2$。    \n第 $5$ 次操作查询 $1,2$ 号集合的并集 $\\{1,2,1,2\\}$ 中第 $3$ 大的数，答案为 $1$。\n\n【数据范围】  \n$1 \\le n,m \\le 5\\times 10^4$   \n$1\\le l,r \\le n$   \n$1$ 操作中 $|c|\\le n$   \n$2$ 操作中 $1\\le c < 2^{63}$，第 $c$ 大的数存在\n\n---\n\n$\\text{upd 2023.8.23}$：新增加一组 Hack 数据。", "locale": "zh-CN"}}}
{"pid": "P3333", "type": "P", "difficulty": 6, "samples": [["xiang yao yi zhi ai zhe mou wu de hua yi yao guai zhi si lai shuo tai chang le xiang yao shi xian yi qie meng xiang de hua yi ren lei zhi sheng lai shuo tai duan le\nyao\ntai chang le yao\ntai duan le", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "贪心", "2013", "各省省选", "浙江", "哈希 hashing"], "title": "[ZJOI2013] 丽洁体", "background": null, "description": "平时的练习和考试中，我们经常会碰上这样的题：命题人给出一个例句，要我们类比着写句子。这种往往被称为仿写的题，不单单出现在小学生的考试中，也有时会出现在中考中。许多同学都喜欢做这种题，因为较其它题显得有趣。仿写的句子往往具有 `A__B__C` 的形式，其中 `A`，`B`，`C` 是给定的由一个或多个单词组成的短句，空的部分需要学生填写。当然，考试的时候空在那里也是可以的。例如，“其实天不暗阴云终要散，其实，其实，其实路不远一切会如愿，艰难困苦的日子里我为你祈祷，请你保重每一天”。再比如，“见了大海的汹涌，没见过大山的巍峨，真是遗憾；见了大山的巍峨，没见过，还是遗憾。出发吧，永远出发。 ，人有不老的心情。”\n\n由于现在是网络时代，我们不再只能仿写命题人命的题，我们可以仿写网上各种句子和段落。2011 年 3 月 26 日，某人在博客上发布了的消息就惹来了很多人的仿写。\n\n很难过吧。。。考得完爆了。。。\n\n。。。。。。其实也没什么可以说的。。。都是蒟蒻的借口罢了。。。\n\n。。。自己果然还只是半吊子水平呢。。。。\n\n。。。祝大家都能进省队。。。其实只要不要有遗憾就好了呢。。。\n\n虽然我很遗憾或许不能走下去了。。。。。\n\n886\n\n在网络上广泛流传的仿写，因为在某些地方有独到之处，大都被命名为“某某体”。打开人人，刷新微博，你也能发现这样和那样的体，比如，对不起体，\\*\\* 说明他爱你体等等。金先生注意到了这一现象，他敏锐地认为这是一个很有价值的研究课题，于是就其展开研究，打算发一篇 paper。由于在网上发消息，人们有了更大的灵活度，人们有时因为表达的需要，还往原本固定的 `A, B, C` 中添加一些修饰的词语。这就给辨别一个句子或段落是否是另一个句子或段落的仿写增加了困难。\n\n金先生现在研究一种形如“`A*B*C`”的体作品，其中 `A, B, C` 分别是某个由若干单词组成的短句，`*` 代表 $0$ 个或多个单词。他在网上找了大量的体作品，不过很多体作品不太合乎原作者的格式，也就是相当于在正规的体作品中插入了 0 个或多个单词。\n\n由于数据量太大，金先生无法一个一个看过去，于是想请你帮忙，去掉尽量少的单词，使它成为指定的体。", "inputFormat": "包含 $4$ 行。\n\n第一行是某个也许不规范的体作品 $T$，\n\n接下来三行分别代表 `A`, `B`, `C`。", "outputFormat": "仅一行，包含一个数，即最少的去除单词数。", "hint": "【样例说明】\n\n在上述样例中，不规范的体作品为：“想要一直爱着某物的话，以妖怪之死来说太长了；想要实现一切梦想的话，以人类之生来说太短了”。\n\n规范的体形如：“要 `*` 太长了要 `*` 太短了”。\n\n修改后的规范的体为：“要一直爱着某物的话，以妖怪之死来说太长了；要实现一切梦想的话，以人类之生来说太短了”。\n\n【数据规模与约定】\n\n对于 $20\\%$ 的数据，$1\\le|T|, |A|, |B|, |C|\\le10$。\n\n对于 $40\\%$ 的数据，$1\\le|T|, |A|, |B|, |C|\\le100$。\n\n对于 $70\\%$ 的数据，$1\\le|T|, |A|, |B|, |C|\\le1000$。\n\n对于 $100\\%$ 的数据，$1\\le|T|, |A|, |B|, |C|\\le50000$；所有单词长度不超过 $5$，出现次数不超过 $500$；数据保证答案总存在。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2013] Lijie Style", "background": "", "description": "In practice and exams, we often meet questions like this: the setter gives an example sentence, and we are asked to write a similar sentence by analogy. This kind of question, often called imitation writing, appears not only in elementary school exams but sometimes also in middle school entrance exams. Many students like such questions because they feel more interesting than others. The imitated sentence often has the form “A__B__C”, where A, B, and C are given short phrases made of one or more words, and the blank parts are to be filled by the student. Of course, in exams it is also acceptable to leave the blanks empty. For example: “In fact, the sky is not dark, the dark clouds will eventually scatter; in fact , in fact , in fact the road is not long, everything will go as wished. In the days of hardship and difficulty, I pray for you. Please take care every day.” Another example: “Having seen the surging sea but not the towering mountain is a pity; having seen the towering mountain but not the , it is still a pity. Set out, always set out. , people keep an ageless mood.”\n\nBecause we are in the internet era, we can imitate not only the setter’s prompts but also all kinds of sentences and paragraphs online. On March 26, 2011, someone posted a message on a blog that drew lots of imitations.\n\nSo sad... I totally bombed the test...\n\n...... Actually, there isn't much to say... It's all just excuses from a newbie (ju ruo, 蒟蒻)...\n\n... As expected, I'm still only half-baked...\n\n... I wish everyone can make the provincial team (sheng dui)... Actually, as long as there is no regret, it's fine...\n\nAlthough I regret that maybe I can't keep going...\n\n886 (bye-bye-bye)\n\nImitations that spread widely online are often named “X-style” (“XX ti”) because they have something unique in certain places. Open Renren, refresh Weibo, and you can find this and that style, for example, “Sorry style,” “It shows he loves you style,” and so on. Mr. Jin noticed this phenomenon and thought it would be a valuable research topic, so he began to study it and planned to publish a paper. Because posting messages online gives people more flexibility, sometimes for expression needs people also add some modifiers into the originally fixed $A$, $B$, $C$. This makes it harder to decide whether a sentence or paragraph is an imitation of another sentence or paragraph.\n\nMr. Jin now studies works of the form “$A$*$B$*$C$”, where $A$, $B$, $C$ are short phrases consisting of several words, and “*” stands for 0 or more words. He collected many such works online, but many do not strictly follow the original author’s format, which is equivalent to inserting 0 or more words into a standard work.\n\nBecause the data volume is too large, Mr. Jin cannot check them one by one. He asks you to remove as few words as possible to make it match the specified style.", "inputFormat": "Four lines.\n\nThe first line is a possibly non-standard work $T$.\n\nThe next three lines are $A$, $B$, and $C$, respectively.", "outputFormat": "A single line containing one integer: the minimum number of words to remove.", "hint": "Sample Explanation:\n\nIn the sample above, the non-standard work is: “If you want to keep loving something forever, then, speaking of a demon’s death, it is too long; if you want to realize all dreams, then, speaking of a human’s life, it is too short.”\n\nA standard work has the form: “yao*too long yao*too short” (“要*太长了要*太短了”).\n\nAfter modification, a valid standard work is: “If you want to keep loving something forever, then, speaking of a demon’s death, it is too long; if you want to realize all dreams, then, speaking of a human’s life, it is too short.”\n\nConstraints:\n\n- For 20% of the testdata, $1 \\le |T|, |A|, |B|, |C| \\le 10$.\n- For 40% of the testdata, $1 \\le |T|, |A|, |B|, |C| \\le 100$.\n- For 70% of the testdata, $1 \\le |T|, |A|, |B|, |C| \\le 1000$.\n- For 100% of the testdata, $1 \\le |T|, |A|, |B|, |C| \\le 50000$; all words have length at most $5$, and each distinct word appears at most $500$ times; the testdata guarantees that an answer always exists.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2013] 丽洁体", "background": null, "description": "平时的练习和考试中，我们经常会碰上这样的题：命题人给出一个例句，要我们类比着写句子。这种往往被称为仿写的题，不单单出现在小学生的考试中，也有时会出现在中考中。许多同学都喜欢做这种题，因为较其它题显得有趣。仿写的句子往往具有 `A__B__C` 的形式，其中 `A`，`B`，`C` 是给定的由一个或多个单词组成的短句，空的部分需要学生填写。当然，考试的时候空在那里也是可以的。例如，“其实天不暗阴云终要散，其实，其实，其实路不远一切会如愿，艰难困苦的日子里我为你祈祷，请你保重每一天”。再比如，“见了大海的汹涌，没见过大山的巍峨，真是遗憾；见了大山的巍峨，没见过，还是遗憾。出发吧，永远出发。 ，人有不老的心情。”\n\n由于现在是网络时代，我们不再只能仿写命题人命的题，我们可以仿写网上各种句子和段落。2011 年 3 月 26 日，某人在博客上发布了的消息就惹来了很多人的仿写。\n\n很难过吧。。。考得完爆了。。。\n\n。。。。。。其实也没什么可以说的。。。都是蒟蒻的借口罢了。。。\n\n。。。自己果然还只是半吊子水平呢。。。。\n\n。。。祝大家都能进省队。。。其实只要不要有遗憾就好了呢。。。\n\n虽然我很遗憾或许不能走下去了。。。。。\n\n886\n\n在网络上广泛流传的仿写，因为在某些地方有独到之处，大都被命名为“某某体”。打开人人，刷新微博，你也能发现这样和那样的体，比如，对不起体，\\*\\* 说明他爱你体等等。金先生注意到了这一现象，他敏锐地认为这是一个很有价值的研究课题，于是就其展开研究，打算发一篇 paper。由于在网上发消息，人们有了更大的灵活度，人们有时因为表达的需要，还往原本固定的 `A, B, C` 中添加一些修饰的词语。这就给辨别一个句子或段落是否是另一个句子或段落的仿写增加了困难。\n\n金先生现在研究一种形如“`A*B*C`”的体作品，其中 `A, B, C` 分别是某个由若干单词组成的短句，`*` 代表 $0$ 个或多个单词。他在网上找了大量的体作品，不过很多体作品不太合乎原作者的格式，也就是相当于在正规的体作品中插入了 0 个或多个单词。\n\n由于数据量太大，金先生无法一个一个看过去，于是想请你帮忙，去掉尽量少的单词，使它成为指定的体。", "inputFormat": "包含 $4$ 行。\n\n第一行是某个也许不规范的体作品 $T$，\n\n接下来三行分别代表 `A`, `B`, `C`。", "outputFormat": "仅一行，包含一个数，即最少的去除单词数。", "hint": "【样例说明】\n\n在上述样例中，不规范的体作品为：“想要一直爱着某物的话，以妖怪之死来说太长了；想要实现一切梦想的话，以人类之生来说太短了”。\n\n规范的体形如：“要 `*` 太长了要 `*` 太短了”。\n\n修改后的规范的体为：“要一直爱着某物的话，以妖怪之死来说太长了；要实现一切梦想的话，以人类之生来说太短了”。\n\n【数据规模与约定】\n\n对于 $20\\%$ 的数据，$1\\le|T|, |A|, |B|, |C|\\le10$。\n\n对于 $40\\%$ 的数据，$1\\le|T|, |A|, |B|, |C|\\le100$。\n\n对于 $70\\%$ 的数据，$1\\le|T|, |A|, |B|, |C|\\le1000$。\n\n对于 $100\\%$ 的数据，$1\\le|T|, |A|, |B|, |C|\\le50000$；所有单词长度不超过 $5$，出现次数不超过 $500$；数据保证答案总存在。", "locale": "zh-CN"}}}
{"pid": "P3334", "type": "P", "difficulty": 7, "samples": [["1 2\nHT", "4/1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "各省省选", "浙江"], "title": "[ZJOI2013] 抛硬币", "background": null, "description": "有一枚硬币，抛出正面 `H` 的概率为 $\\frac{a}{b}$，抛出反面 `T` 的概率为 $1-\\frac{a}{b}$。现在TT小朋友开始玩丢硬币的游戏，并且把每次抛出的结果记录下来，正面记为 `H`，反面记为 `T`，于是她得到了一个抛硬币序列 `HTHHT…`。她突然想到一个问题：在抛出正面和反面概率都是 $\\frac{1}{2}$ 的情况下，要使得抛出的序列出现目标序列 `HT`，期望要抛多少次。然而经过 $1$ 秒的思考以后她发现，若第一次抛出的是 `T`，那么还需要期望抛出 `HT` 的次数，如果第一次抛出的是 `H`，则期望只需要抛出 `T` 的次数，而期望抛出 `T` 的次数显然是 $2$。她设抛出 `HT` 的期望次数是 $x$，则得到了方程：\n$$\nx=1+\\left(\\frac{1}{2}\\times x+\\frac{1}{2}\\times 2\\right)\n$$\n解得 $x=4$，所以抛出 `HT` 的期望次数是 $4$ 次。\n\n她在解决了这个弱化很多的问题以后，开始思考对于一般情况下，抛出正反面的概率不一定相同，且抛出的目标序列不一定为 `HT` 时需要的期望步数。然而经过很长一段时间的苦思冥想仍然无果，于是她开始求助于你。", "inputFormat": "第一行两个数 $a,b$。意义如题目描述。\n\n接下来一行一个只包含 `H` 和 `T` 的字符串 $S$。表示要抛出的目标序列。", "outputFormat": "输出仅一行 $\\frac{p}{q}$，其中 $p$ 和 $q$ 均为正整数且互质，表示抛出目标序列 $S$ 所需要的期望步数。\n\n注意，若 $q$ 为 $1$ 时，不省略 `/1`。", "hint": "对于 $50\\%$ 的数据，$a=1,b=2,|S|\\le20$。\n\n对于 $100\\%$ 的数据，$a<b,b\\le100,|S|\\le1000$。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2013] Coin Tossing", "background": "", "description": "There is a coin, with the probability of getting heads `H` being $\\frac{a}{b}$, and the probability of getting tails `T` being $1-\\frac{a}{b}$. Now TT starts playing a coin-tossing game and records each result: heads as `H` and tails as `T`. Thus she obtains a coin-toss sequence like `HTHHT…`. She suddenly wonders: when both probabilities of heads and tails are $\\frac{1}{2}$, what is the expected number of tosses needed for the sequence to contain the target sequence `HT`. However, after thinking for $1$ second, she realizes that if the first toss is `T`, then she still expects to need the number of tosses to obtain `HT`; if the first toss is `H`, then she only needs the expected number of tosses to obtain `T`, which is clearly $2$. Let $x$ be the expected number of tosses to obtain `HT`, then we have:\n$$\nx=1+\\left(\\frac{1}{2}\\times x+\\frac{1}{2}\\times 2\\right)\n$$\nSolving gives $x=4$, so the expected number of tosses to obtain `HT` is $4$.\n\nAfter solving this much simpler problem, she begins to think about the general case, where the probabilities of heads and tails are not necessarily equal, and the target sequence is not necessarily `HT`. However, after a long time of hard thinking, she still gets nowhere, so she turns to you for help.", "inputFormat": "The first line contains two numbers $a, b$, as defined in the description.\n\nThe next line contains a string $S$ consisting only of `H` and `T`, representing the target sequence to obtain.", "outputFormat": "Output a single line $\\frac{p}{q}$, where $p$ and $q$ are positive integers and are coprime, representing the expected number of tosses needed to obtain the target sequence $S$.\n\nNote that if $q$ is $1$, do not omit `/1`.", "hint": "For $50\\%$ of the testdata, $a=1, b=2, |S|\\le 20$.\n\nFor $100\\%$ of the testdata, $a<b, b\\le 100, |S|\\le 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2013] 抛硬币", "background": null, "description": "有一枚硬币，抛出正面 `H` 的概率为 $\\frac{a}{b}$，抛出反面 `T` 的概率为 $1-\\frac{a}{b}$。现在TT小朋友开始玩丢硬币的游戏，并且把每次抛出的结果记录下来，正面记为 `H`，反面记为 `T`，于是她得到了一个抛硬币序列 `HTHHT…`。她突然想到一个问题：在抛出正面和反面概率都是 $\\frac{1}{2}$ 的情况下，要使得抛出的序列出现目标序列 `HT`，期望要抛多少次。然而经过 $1$ 秒的思考以后她发现，若第一次抛出的是 `T`，那么还需要期望抛出 `HT` 的次数，如果第一次抛出的是 `H`，则期望只需要抛出 `T` 的次数，而期望抛出 `T` 的次数显然是 $2$。她设抛出 `HT` 的期望次数是 $x$，则得到了方程：\n$$\nx=1+\\left(\\frac{1}{2}\\times x+\\frac{1}{2}\\times 2\\right)\n$$\n解得 $x=4$，所以抛出 `HT` 的期望次数是 $4$ 次。\n\n她在解决了这个弱化很多的问题以后，开始思考对于一般情况下，抛出正反面的概率不一定相同，且抛出的目标序列不一定为 `HT` 时需要的期望步数。然而经过很长一段时间的苦思冥想仍然无果，于是她开始求助于你。", "inputFormat": "第一行两个数 $a,b$。意义如题目描述。\n\n接下来一行一个只包含 `H` 和 `T` 的字符串 $S$。表示要抛出的目标序列。", "outputFormat": "输出仅一行 $\\frac{p}{q}$，其中 $p$ 和 $q$ 均为正整数且互质，表示抛出目标序列 $S$ 所需要的期望步数。\n\n注意，若 $q$ 为 $1$ 时，不省略 `/1`。", "hint": "对于 $50\\%$ 的数据，$a=1,b=2,|S|\\le20$。\n\n对于 $100\\%$ 的数据，$a<b,b\\le100,|S|\\le1000$。", "locale": "zh-CN"}}}
{"pid": "P3335", "type": "P", "difficulty": 6, "samples": [["2 5 2\n-1 -1 -1 -1 -1\n-1 -1 -1 -1 -1", "-8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2013", "各省省选", "浙江"], "title": "[ZJOI2013] 蚂蚁寻路", "background": "", "description": "在一个 $n \\times m$ 的棋盘上，每个格子有一个权值，初始时，在某个格子的顶点处一只面朝北的蚂蚁，我们只知道它的行走路线是如何转弯，却不知道每次转弯前走了多长。\n\n蚂蚁转弯是有一定特点的，即它的转弯序列一定是如下的形式：右转，右转，左转，左转，右转，右转…左转，左转，右转，右转，右转。即两次右转和两次左转交替出现的形式，最后两次右转（最后两次一定是右转）后再多加一次右转。我们还知道，蚂蚁不会在同一个位置连续旋转两次，并且蚂蚁行走的路径除了起点以外，不会到达同一个点多次，它最后一定是回到起点然后结束自己的行程，而且蚂蚁只会在棋盘格子的顶点处转弯。\n\n ![](https://cdn.luogu.com.cn/upload/pic/6217.png) \n\n现在已知棋盘大小、每个格子的权值以及左转次数除以 $2$ 的值，问蚂蚁走出的路径围出的封闭图形，权值之和最大可能是多少。\n", "inputFormat": "第一行三个数 $n,m,k$。意义如题目描述。\n\n接下来一个 $n$ 行 $m$ 列的整数矩阵，表示棋盘。\n", "outputFormat": "一个数，表示蚂蚁所走路径围出的图形可能的最大权值和。\n", "hint": "### 样例说明\n\n除了第一行的第二个和第一行的第四个都要围起来才至少合法。\n\n### 数据规模与约定\n\n- $10\\%$ 的数据所有格子中权值均非负。\n- 另 $20\\%$ 的数据 $n=2$。\n- 另 $30\\%$ 的数据 $k=0$。\n- $100\\%$ 的数据 $1 \\le n\\le 100$，$1 \\le m \\le 100$，$0 \\le k \\le 10$，保证存在合法路径，数据有梯度，格子中每个元素的值绝对值不超过 $10000$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2013] Ant Pathfinding", "background": "", "description": "On an $n \\times m$ board, each cell has a weight. Initially, there is an ant facing north at the vertex of some cell. We only know how its route turns, but we do not know how far it walks between consecutive turns.\n\nThe ant’s turning sequence has a specific pattern: right, right, left, left, right, right, …, left, left, right, right, right. That is, pairs of right turns and pairs of left turns appear alternately; after the final pair of right turns (the last two are necessarily right turns), one additional right turn is appended. We also know that the ant will not rotate twice consecutively at the same position, the ant’s path will not pass through the same point more than once except for the starting point, it will finally return to the starting point and end its journey, and the ant only turns at grid vertices.\n\n![](https://cdn.luogu.com.cn/upload/pic/6217.png)\n\nGiven the board size, each cell’s weight, and the value of the number of left turns divided by $2$, find the maximum possible sum of weights of the closed shape enclosed by the ant’s path.", "inputFormat": "The first line contains three integers $n, m, k$, as described above.\n\nThen follow an $n$-row, $m$-column integer matrix representing the board.", "outputFormat": "Output a single integer: the maximum possible total weight of the region enclosed by the ant’s path.", "hint": "Sample Explanation:\nAt minimum, both the second cell and the fourth cell in the first row must be enclosed for the path to be valid.\n\nConstraints:\n- $10\\%$ of the testdata have all cell weights nonnegative.\n- Another $20\\%$ of the testdata have $n=2$.\n- Another $30\\%$ of the testdata have $k=0$.\n- For $100\\%$ of the testdata, $1 \\le n\\le 100$, $1 \\le m \\le 100$, $0 \\le k \\le 10$, a valid path is guaranteed to exist, the testdata have gradient, and the absolute value of each cell’s weight does not exceed $10000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2013] 蚂蚁寻路", "background": "", "description": "在一个 $n \\times m$ 的棋盘上，每个格子有一个权值，初始时，在某个格子的顶点处一只面朝北的蚂蚁，我们只知道它的行走路线是如何转弯，却不知道每次转弯前走了多长。\n\n蚂蚁转弯是有一定特点的，即它的转弯序列一定是如下的形式：右转，右转，左转，左转，右转，右转…左转，左转，右转，右转，右转。即两次右转和两次左转交替出现的形式，最后两次右转（最后两次一定是右转）后再多加一次右转。我们还知道，蚂蚁不会在同一个位置连续旋转两次，并且蚂蚁行走的路径除了起点以外，不会到达同一个点多次，它最后一定是回到起点然后结束自己的行程，而且蚂蚁只会在棋盘格子的顶点处转弯。\n\n ![](https://cdn.luogu.com.cn/upload/pic/6217.png) \n\n现在已知棋盘大小、每个格子的权值以及左转次数除以 $2$ 的值，问蚂蚁走出的路径围出的封闭图形，权值之和最大可能是多少。\n", "inputFormat": "第一行三个数 $n,m,k$。意义如题目描述。\n\n接下来一个 $n$ 行 $m$ 列的整数矩阵，表示棋盘。\n", "outputFormat": "一个数，表示蚂蚁所走路径围出的图形可能的最大权值和。\n", "hint": "### 样例说明\n\n除了第一行的第二个和第一行的第四个都要围起来才至少合法。\n\n### 数据规模与约定\n\n- $10\\%$ 的数据所有格子中权值均非负。\n- 另 $20\\%$ 的数据 $n=2$。\n- 另 $30\\%$ 的数据 $k=0$。\n- $100\\%$ 的数据 $1 \\le n\\le 100$，$1 \\le m \\le 100$，$0 \\le k \\le 10$，保证存在合法路径，数据有梯度，格子中每个元素的值绝对值不超过 $10000$。\n", "locale": "zh-CN"}}}
{"pid": "P3336", "type": "P", "difficulty": 7, "samples": [["2 0", "1 1"], ["6 9\n4 2\n4 2\n2 0\n4 2\n6 0\n5 1\n2 0\n0 0\n0 0", "1 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "贪心", "2013", "各省省选", "浙江", "组合数学"], "title": "[ZJOI2013] 话旧", "background": "", "description": "小林跟着银河队选手去了一趟宇宙比赛，耳濡目染，变得学术起来。回来后，他发现世界大变样了。比丘兽究级进化，成了凤凰兽；金先生因为发了一篇 paper，一跃成为教授，也成为了银河队选拔委员会成员。\n\n一日，小林与金教授聊天。金教授回忆起过去的岁月，那些年他学过的电路原理。他曾经对一种三角波很感兴趣，并且进行了一些探究。小林感到很好奇，于是金教授就将课题形式化地说了一遍。\n\n有一定义在 $[0,N]$ 的连续函数 $f(x)$，其中 $N$ 是整数，满足 $f(0)=f(N)=0$，它的所有极值点在整数处取到，且 $f(x)$ 的**极小值**均是 $0$。对于任意的 $0$ 到 $N-1$ 间的整数 $I$，$f(x)$ 在 $(I, I+1)$ 上是斜率为 $1$ 或 $-1$ 的一次函数。\n\n金先生研究的是，若他知道其中 $K$ 个整点的函数值，那么：\n\n1. 有多少个函数满足条件？\n2. 满足条件的函数中，$f(x)$ 的最大值，最大能是多少？\n\n小林思考了一下，便想出了很好的算法。那么作为经过多年训练的你呢？", "inputFormat": "第一行包含两个用空格隔开的整数 $N,K$。接下来 $K$ 行，每行两个整数，表示 $x_i$ 和 $f(x_i)$。\n", "outputFormat": "一行两个整数，分别对应两个问题的答案。考虑到第一问答案可能很大，你只要输出它除以 $19940417$ 的余数。", "hint": "- 对于 $10\\%$ 的数据，$N \\leq 10$。\n- 对于 $20\\%$ 的数据，$N \\leq 50$。\n- 对于 $30\\%$ 的数据，$N \\leq 100$，$K \\leq 100$。\n- 对于 $50\\%$ 的数据，$N \\leq 10^3$，$K \\leq 10^3$。\n- 对于 $70\\%$ 的数据，$N \\leq 10^5$。\n- 另有 $10\\%$ 的数据，$K=0$。\n- 对于 $100\\%$ 的数据，$ 0 \\leq N \\leq 10^9$，$0 \\leq K \\leq 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2013] Reminiscence", "background": "", "description": "Kobayashi went with the Galaxy Team players to a space contest. Influenced by the experience, he became more academic. After returning, he found the world had changed a lot. Biyomon underwent ultimate evolution and became Phoenixmon; Mr. Jin published a paper, was promoted to professor, and joined the Galaxy Team selection committee.\n\nOne day, Kobayashi chatted with Professor Jin. The professor recalled the years when he studied circuit theory. He was once very interested in a certain triangular wave and explored it. Kobayashi grew curious, so Professor Jin formalized the topic.\n\nThere is a continuous function $f(x)$ defined on $[0,N]$, where $N$ is an integer, satisfying $f(0)=f(N)=0$. All its extrema occur at integer points, and every local minimum of $f(x)$ is $0$. For any integer $I$ between $0$ and $N-1$, on $(I, I+1)$, $f(x)$ is a linear function with slope $1$ or $-1$.\n\nWhat Mr. Jin studies is: if he knows the function values at $K$ integer points, then:\n\n1. How many functions satisfy the conditions?\n2. Among all functions that satisfy the conditions, what is the largest possible value of $\\max f(x)$?\n\nKobayashi thought for a moment and came up with a good algorithm. What about you?", "inputFormat": "The first line contains two integers $N, K$ separated by a space. The next $K$ lines each contain two integers, representing $x_i$ and $f(x_i)$.", "outputFormat": "Output two integers in one line, corresponding to the answers to the two questions. Since the answer to the first question can be large, output it modulo $19940417$.", "hint": "- For 10% of the testdata, $N \\leq 10$.\n- For 20% of the testdata, $N \\leq 50$.\n- For 30% of the testdata, $N \\leq 100$, $K \\leq 100$.\n- For 50% of the testdata, $N \\leq 10^3$, $K \\leq 10^3$.\n- For 70% of the testdata, $N \\leq 10^5$.\n- Additionally, for 10% of the testdata, $K=0$.\n- For 100% of the testdata, $0 \\leq N \\leq 10^9$, $0 \\leq K \\leq 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2013] 话旧", "background": "", "description": "小林跟着银河队选手去了一趟宇宙比赛，耳濡目染，变得学术起来。回来后，他发现世界大变样了。比丘兽究级进化，成了凤凰兽；金先生因为发了一篇 paper，一跃成为教授，也成为了银河队选拔委员会成员。\n\n一日，小林与金教授聊天。金教授回忆起过去的岁月，那些年他学过的电路原理。他曾经对一种三角波很感兴趣，并且进行了一些探究。小林感到很好奇，于是金教授就将课题形式化地说了一遍。\n\n有一定义在 $[0,N]$ 的连续函数 $f(x)$，其中 $N$ 是整数，满足 $f(0)=f(N)=0$，它的所有极值点在整数处取到，且 $f(x)$ 的**极小值**均是 $0$。对于任意的 $0$ 到 $N-1$ 间的整数 $I$，$f(x)$ 在 $(I, I+1)$ 上是斜率为 $1$ 或 $-1$ 的一次函数。\n\n金先生研究的是，若他知道其中 $K$ 个整点的函数值，那么：\n\n1. 有多少个函数满足条件？\n2. 满足条件的函数中，$f(x)$ 的最大值，最大能是多少？\n\n小林思考了一下，便想出了很好的算法。那么作为经过多年训练的你呢？", "inputFormat": "第一行包含两个用空格隔开的整数 $N,K$。接下来 $K$ 行，每行两个整数，表示 $x_i$ 和 $f(x_i)$。\n", "outputFormat": "一行两个整数，分别对应两个问题的答案。考虑到第一问答案可能很大，你只要输出它除以 $19940417$ 的余数。", "hint": "- 对于 $10\\%$ 的数据，$N \\leq 10$。\n- 对于 $20\\%$ 的数据，$N \\leq 50$。\n- 对于 $30\\%$ 的数据，$N \\leq 100$，$K \\leq 100$。\n- 对于 $50\\%$ 的数据，$N \\leq 10^3$，$K \\leq 10^3$。\n- 对于 $70\\%$ 的数据，$N \\leq 10^5$。\n- 另有 $10\\%$ 的数据，$K=0$。\n- 对于 $100\\%$ 的数据，$ 0 \\leq N \\leq 10^9$，$0 \\leq K \\leq 10^6$。", "locale": "zh-CN"}}}
{"pid": "P3337", "type": "P", "difficulty": 6, "samples": [["5 3\n1 5 6 3 4\n2 3 1\n1 5 4\n3 5 2", "11"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "各省省选", "浙江"], "title": "[ZJOI2013] 防守战线", "background": "", "description": "战线可以看作一个长度为 $n$ 的序列，现在需要在这个序列上建塔来防守敌兵，在序列第 $i$ 号位置上建一座塔有 $C_i$ 的花费，且一个位置可以建任意多的塔，费用累加计算。有 $m$ 个区间 $[L_1, R_1], [L_2, R_2], \\cdots, [L_m, R_m]$，在第 $i$ 个区间的范围内要建至少 $D_i$ 座塔。求最少花费。\n", "inputFormat": "第一行为两个数 $n, m$。\n\n接下来一行，有 $n$ 个数，描述 $C$ 数组。\n\n接下来 $m$ 行，每行三个数 $L_i,R_i,D_i$，描述一个区间。\n", "outputFormat": "仅包含一行，一个数，为最少花费。\n", "hint": "【样例说明】\n\n位置 $1$ 建 $2$ 个塔，位置 $3$ 建一个塔，位置 $4$ 建一个塔。花费 $1\\times 2+6+3=11$。\n\n【数据规模】\n\n对于 $20\\%$ 的数据，$n\\le 20$，$m\\le 20$。\n\n对于 $50\\%$ 的数据（包括上部分的数据），$D_i$ 全部为 $1$。\n\n对于 $70\\%$ 的数据（包括上部分的数据），$n\\le 100$，$m\\le 1000$。\n\n对于 $100\\%$ 的数据，$n\\le 1000$，$m\\le 10000$，$1\\le L_i\\le R_i\\le n$，其余数据均 $\\le 10000$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2013] Defensive Frontline", "background": "", "description": "The frontline can be viewed as a sequence of length $n$. We need to build towers on this sequence to defend against enemy troops. Building a tower at position $i$ costs $C_i$, and any number of towers can be built at the same position, with costs added together. There are $m$ intervals $[L_1, R_1], [L_2, R_2], \\cdots, [L_m, R_m]$, and within the $i$-th interval, at least $D_i$ towers must be built. Find the minimum cost.", "inputFormat": "The first line contains two numbers $n, m$.\n\nThe next line contains $n$ numbers, describing the $C$ array.\n\nThe next $m$ lines each contain three numbers $L_i, R_i, D_i$, describing an interval.", "outputFormat": "Output a single line with one number: the minimum cost.", "hint": "Sample explanation:\n\nBuild $2$ towers at position $1$, one tower at position $3$, and one tower at position $4$. The cost is $1\\times 2+6+3=11$.\n\nConstraints:\n\n- For $20\\%$ of the testdata, $n \\le 20$, $m \\le 20$.\n- For $50\\%$ of the testdata (including the above), all $D_i$ are $1$.\n- For $70\\%$ of the testdata (including the above), $n \\le 100$, $m \\le 1000$.\n- For $100\\%$ of the testdata, $n \\le 1000$, $m \\le 10000$, $1 \\le L_i \\le R_i \\le n$, and all other values are $\\le 10000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2013] 防守战线", "background": "", "description": "战线可以看作一个长度为 $n$ 的序列，现在需要在这个序列上建塔来防守敌兵，在序列第 $i$ 号位置上建一座塔有 $C_i$ 的花费，且一个位置可以建任意多的塔，费用累加计算。有 $m$ 个区间 $[L_1, R_1], [L_2, R_2], \\cdots, [L_m, R_m]$，在第 $i$ 个区间的范围内要建至少 $D_i$ 座塔。求最少花费。\n", "inputFormat": "第一行为两个数 $n, m$。\n\n接下来一行，有 $n$ 个数，描述 $C$ 数组。\n\n接下来 $m$ 行，每行三个数 $L_i,R_i,D_i$，描述一个区间。\n", "outputFormat": "仅包含一行，一个数，为最少花费。\n", "hint": "【样例说明】\n\n位置 $1$ 建 $2$ 个塔，位置 $3$ 建一个塔，位置 $4$ 建一个塔。花费 $1\\times 2+6+3=11$。\n\n【数据规模】\n\n对于 $20\\%$ 的数据，$n\\le 20$，$m\\le 20$。\n\n对于 $50\\%$ 的数据（包括上部分的数据），$D_i$ 全部为 $1$。\n\n对于 $70\\%$ 的数据（包括上部分的数据），$n\\le 100$，$m\\le 1000$。\n\n对于 $100\\%$ 的数据，$n\\le 1000$，$m\\le 10000$，$1\\le L_i\\le R_i\\le n$，其余数据均 $\\le 10000$。\n", "locale": "zh-CN"}}}
{"pid": "P3338", "type": "P", "difficulty": 6, "samples": [["5\n4006373.885184\n15375036.435759\n1717456.469144\n8514941.004912\n1410681.345880", "-16838672.693\n3439.793\n7509018.566\n4595686.886\n10903040.872"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2014", "各省省选", "浙江", "Special Judge", "快速傅里叶变换 FFT"], "title": "[ZJOI2014] 力", "background": "", "description": "给出 $n$ 个数 $q_1,q_2, \\dots q_n$，定义\n\n$$F_j~=~\\sum_{i = 1}^{j - 1} \\frac{q_i \\times q_j}{(i - j)^2}~-~\\sum_{i = j + 1}^{n} \\frac{q_i \\times q_j}{(i - j)^2}$$\n\n$$E_i~=~\\frac{F_i}{q_i}$$\n\n对 $1 \\leq i \\leq n$，求 $E_i$ 的值。\n", "inputFormat": "第一行输入一个整数 $n$。\n\n以下 $n$ 行，每行有一个实数。第 $i+1$ 行的数代表 $q_i$。\n", "outputFormat": "输出 $n$ 行每行一个实数，第 $i$ 行的数字代表 $E_i$。\n\n当你的输出与标准答案相差不超过 $10^{-2}$ 时即被认为正确。", "hint": "【数据范围】   \n对于 $30\\%$ 的数据，$n \\leq 1000$；   \n对于 $50\\%$ 的数据，$n \\leq 6 \\times 10^4$；   \n对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^5$，$0 < q_i < 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2014] Force", "background": "", "description": "Given $n$ numbers $q_1,q_2, \\dots q_n$, define\n\n$$F_j~=~\\sum_{i = 1}^{j - 1} \\frac{q_i \\times q_j}{(i - j)^2}~-~\\sum_{i = j + 1}^{n} \\frac{q_i \\times q_j}{(i - j)^2}$$\n\n$$E_i~=~\\frac{F_i}{q_i}$$\n\nFor $1 \\leq i \\leq n$, find the value of $E_i$.", "inputFormat": "The first line contains an integer $n$.\n\nEach of the following $n$ lines contains a real number. The number on the $(i+1)$-th line represents $q_i$.", "outputFormat": "Output $n$ lines, each containing a real number. The number on the $i$-th line represents $E_i$.\n\nYour output is considered correct if it differs from the standard answer by at most $10^{-2}$.", "hint": "Constraints  \nFor $30\\%$ of the testdata, $n \\leq 1000$.  \nFor $50\\%$ of the testdata, $n \\leq 6 \\times 10^4$.  \nFor $100\\%$ of the testdata, $1 \\leq n \\leq 10^5$, $0 < q_i < 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2014] 力", "background": "", "description": "给出 $n$ 个数 $q_1,q_2, \\dots q_n$，定义\n\n$$F_j~=~\\sum_{i = 1}^{j - 1} \\frac{q_i \\times q_j}{(i - j)^2}~-~\\sum_{i = j + 1}^{n} \\frac{q_i \\times q_j}{(i - j)^2}$$\n\n$$E_i~=~\\frac{F_i}{q_i}$$\n\n对 $1 \\leq i \\leq n$，求 $E_i$ 的值。\n", "inputFormat": "第一行输入一个整数 $n$。\n\n以下 $n$ 行，每行有一个实数。第 $i+1$ 行的数代表 $q_i$。\n", "outputFormat": "输出 $n$ 行每行一个实数，第 $i$ 行的数字代表 $E_i$。\n\n当你的输出与标准答案相差不超过 $10^{-2}$ 时即被认为正确。", "hint": "【数据范围】   \n对于 $30\\%$ 的数据，$n \\leq 1000$；   \n对于 $50\\%$ 的数据，$n \\leq 6 \\times 10^4$；   \n对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^5$，$0 < q_i < 10^9$。", "locale": "zh-CN"}}}
{"pid": "P3339", "type": "P", "difficulty": 7, "samples": [["2 \n1 1 \n1\n2 30 \n197943 \n249832", "Preempt.\nLeapfrog."]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["递推", "2014", "各省省选", "浙江", "进制", "Fibonacci 数列"], "title": "[ZJOI2014] 取石子游戏", "background": "", "description": "Roland. p Sprague 和 Patrick M. Grundy 都是组合游戏的狂热爱好者，但他们素未谋面。\n\n一天，Sprague 在写给 Grundy 的信中向他介绍了一个据称是来自东方的古老游戏一一取石子。\n\n取石子是一个双人博弈游戏。在游戏的一开始，桌面上有几堆石子堆。接下 来，游戏双方轮流进行操作：从桌面上选取一堆石子堆，然后从这一堆里面取走任意多个石子（但不能不取）。当某个人无法操作时则失败，另一方获得胜利。由于条件所限, Sprague 建议在纸上写一排自然数来代表各个石子堆的石子数目，然后两人轮流划数与数；Grundy 欣然应允。\n\n一个月过去了，在 Grundy 连续输了 $5$ 盘游戏之后，他怀疑 Sprague 要诈。经过几天的研究，Grundy 在某天下午发现假设游戏双方都足够聪明，那么给定一个初始状态（一排自然数），可以有很简单的方法来判定先手必胜还是后手必胜，并且可以给出必胜策略！于是 Grundy 决定要进行反击。\n\n翌日，Grundy 在写给 Sprague 的信中建议把游戏的规则改得更复杂一点：首先确定一个常数 $K$。然后，游戏双方的操作改为：每次选择一个数划掉。假设该数为 $x$，操作者可以任选一个正整数a，在划掉之后需要再写上 $x-a$，$x-2a $，$\\cdots$，$x-K \\times a$ 共 $K$ 个数，且 $a$ 需满足 $x-K\\times a \\geq 0$。若这样的 $a$ 不存在，那么操作者就不能划掉这个无。某一方失败的条件依然是他无法操作。\n\n碍于面子，Sprague 当然无法拒绝。不过他也不会坐以待毙，现在他已经得到了和写在纸上的个数。他把这些数据和这个游戏的规则都告诉了你一一一个正在研究如何使用一个尚不存在的机械（你将其命名为计算机）解决实际的数学、物理、经济学）的计算机科学家。\n\n", "inputFormat": "输入文件，第一行是一个正整数，表示数据组数 $T$（Sprague 向你询问的次数）。接下来依次输入 $T$ 组数据，每组数据占 $N + 2$ 行，格式如下：\n\n- 第 $1$ 行是一个空行。\n- 第 $2$ 行，两个正整数，按顺序表示 $N$ 和 $K$。\n- 接下来 $N$ 行，每行一个正整数，表示写在纸上的 $N$ 个数。", "outputFormat": "输出文件共有 $T$ 行。对每组数据，如果先手必胜（先进行操作的玩家拥有必胜策略），则输出 `Preempt.`。若后手必胜，则输出 `Leapfrog.`。若两者皆非，则输出 `Je suis un imbecile.`", "hint": "$10\\%$ 的数据满足：$N \\leq 5$，$K=1$，所有数均小等于 $5$。\n\n$20\\%$ 的数据满足：$N \\leq 100$，$K=1$，所有数均小等于 $10^9$。\n\n$10\\%$ 的数据满足：$N \\leq 100$，$K=2$，所有数均小等于 $10^9$。\n\n$20\\%$ 的数据满足：$N \\leq 100$，$K=2$，所有数均小等于 $10^{18}$。\n\n$20\\%$ 的数据满足：$N \\leq 100$，$K=10$，所有数均小等于 $10^{18}$。\n\n$40\\%$ 的数据满足：$N \\leq 100$，$K=30$，所有数均小等于 $10^{80}$。\n\n$100\\%$ 的数据满足：$T \\leq 10$", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2014] Take-Stones Game", "background": "", "description": "Roland P. Sprague and Patrick M. Grundy are both passionate enthusiasts of combinatorial games, but they have never met.\n\nOne day, in a letter to Grundy, Sprague introduced a supposedly ancient game from the East — Take-Stones.\n\nTake-Stones is a two-player impartial game. At the beginning of the game, there are several piles of stones on the table. Then the players take turns: choose one pile and remove any positive number of stones from that pile (but you must take at least one). The player who cannot make a move loses, and the other player wins. Due to practical constraints, Sprague suggested writing a row of natural numbers on paper to represent the sizes of the piles, and then the two would take turns crossing out and writing numbers; Grundy gladly agreed.\n\nA month passed, and after Grundy had lost $5$ games in a row, he suspected that Sprague was cheating. After several days of study, one afternoon Grundy discovered that if both players are clever enough, then given an initial position (a row of natural numbers), there is a very simple way to determine whether the first player or the second player has a forced win, and even to provide a winning strategy! So Grundy decided to strike back.\n\nThe next day, in a letter to Sprague, Grundy suggested making the rules a bit more complicated: first fix a constant $K$. Then each move is changed to: choose a number and cross it out. Suppose the chosen number is $x$. The player may choose any positive integer a; after crossing out $x$, they must write down $x-a$，$x-2a $，$\\cdots$，$x-K \\times a$ — a total of $K$ numbers — and $a$ must satisfy $x-K\\times a \\geq 0$. If no such a exists, then the player cannot cross out this number. A player still loses if and only if they have no legal move.\n\nFor the sake of pride, Sprague could not refuse. But he would not sit and wait for defeat either. He has already obtained the numbers written on the paper. He tells you this testdata and the rules of the game — you, a computer scientist studying how to use a not-yet-existing machine (which you name a “computer”) to solve practical problems in mathematics, physics, and economics.", "inputFormat": "In the input file, the first line is a positive integer representing the number of test cases $T$ (the number of times Sprague consults you). Then $T$ test cases follow, each occupying $N + 2$ lines, in the following format:\n\n- Line $1$: an empty line.\n- Line $2$: two positive integers, in order, representing $N$ and $K$.\n- The next $N$ lines: each line contains one positive integer, representing the $N$ numbers written on the paper.", "outputFormat": "The output file contains $T$ lines. For each test case, if the first player (the player who moves first) has a winning strategy, print `Preempt.`. If the second player has a winning strategy, print `Leapfrog.`. If neither of the above applies, print `Je suis un imbecile.`.", "hint": "$10\\%$ of the testdata satisfies: $N \\leq 5$, $K=1$, and all numbers are at most $5$.\n\n$20\\%$ of the testdata satisfies: $N \\leq 100$, $K=1$, and all numbers are at most $10^9$.\n\n$10\\%$ of the testdata satisfies: $N \\leq 100$, $K=2$, and all numbers are at most $10^9$.\n\n$20\\%$ of the testdata satisfies: $N \\leq 100$, $K=2$, and all numbers are at most $10^{18}$.\n\n$20\\%$ of the testdata satisfies: $N \\leq 100$, $K=10$, and all numbers are at most $10^{18}$.\n\n$40\\%$ of the testdata satisfies: $N \\leq 100$, $K=30$, and all numbers are at most $10^{80}$.\n\n$100\\%$ of the testdata satisfies: $T \\leq 10$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2014] 取石子游戏", "background": "", "description": "Roland. p Sprague 和 Patrick M. Grundy 都是组合游戏的狂热爱好者，但他们素未谋面。\n\n一天，Sprague 在写给 Grundy 的信中向他介绍了一个据称是来自东方的古老游戏一一取石子。\n\n取石子是一个双人博弈游戏。在游戏的一开始，桌面上有几堆石子堆。接下 来，游戏双方轮流进行操作：从桌面上选取一堆石子堆，然后从这一堆里面取走任意多个石子（但不能不取）。当某个人无法操作时则失败，另一方获得胜利。由于条件所限, Sprague 建议在纸上写一排自然数来代表各个石子堆的石子数目，然后两人轮流划数与数；Grundy 欣然应允。\n\n一个月过去了，在 Grundy 连续输了 $5$ 盘游戏之后，他怀疑 Sprague 要诈。经过几天的研究，Grundy 在某天下午发现假设游戏双方都足够聪明，那么给定一个初始状态（一排自然数），可以有很简单的方法来判定先手必胜还是后手必胜，并且可以给出必胜策略！于是 Grundy 决定要进行反击。\n\n翌日，Grundy 在写给 Sprague 的信中建议把游戏的规则改得更复杂一点：首先确定一个常数 $K$。然后，游戏双方的操作改为：每次选择一个数划掉。假设该数为 $x$，操作者可以任选一个正整数a，在划掉之后需要再写上 $x-a$，$x-2a $，$\\cdots$，$x-K \\times a$ 共 $K$ 个数，且 $a$ 需满足 $x-K\\times a \\geq 0$。若这样的 $a$ 不存在，那么操作者就不能划掉这个无。某一方失败的条件依然是他无法操作。\n\n碍于面子，Sprague 当然无法拒绝。不过他也不会坐以待毙，现在他已经得到了和写在纸上的个数。他把这些数据和这个游戏的规则都告诉了你一一一个正在研究如何使用一个尚不存在的机械（你将其命名为计算机）解决实际的数学、物理、经济学）的计算机科学家。\n\n", "inputFormat": "输入文件，第一行是一个正整数，表示数据组数 $T$（Sprague 向你询问的次数）。接下来依次输入 $T$ 组数据，每组数据占 $N + 2$ 行，格式如下：\n\n- 第 $1$ 行是一个空行。\n- 第 $2$ 行，两个正整数，按顺序表示 $N$ 和 $K$。\n- 接下来 $N$ 行，每行一个正整数，表示写在纸上的 $N$ 个数。", "outputFormat": "输出文件共有 $T$ 行。对每组数据，如果先手必胜（先进行操作的玩家拥有必胜策略），则输出 `Preempt.`。若后手必胜，则输出 `Leapfrog.`。若两者皆非，则输出 `Je suis un imbecile.`", "hint": "$10\\%$ 的数据满足：$N \\leq 5$，$K=1$，所有数均小等于 $5$。\n\n$20\\%$ 的数据满足：$N \\leq 100$，$K=1$，所有数均小等于 $10^9$。\n\n$10\\%$ 的数据满足：$N \\leq 100$，$K=2$，所有数均小等于 $10^9$。\n\n$20\\%$ 的数据满足：$N \\leq 100$，$K=2$，所有数均小等于 $10^{18}$。\n\n$20\\%$ 的数据满足：$N \\leq 100$，$K=10$，所有数均小等于 $10^{18}$。\n\n$40\\%$ 的数据满足：$N \\leq 100$，$K=30$，所有数均小等于 $10^{80}$。\n\n$100\\%$ 的数据满足：$T \\leq 10$", "locale": "zh-CN"}}}
{"pid": "P3340", "type": "P", "difficulty": 6, "samples": [["6 6\n3 4\n5 6\n1 3\n4 4\n3 3\n2 4\n1 2\n1 3\n2 3\n2 4\n3 5\n5 6\n3\n3 6\n2 4\n4 6", "0.66667 \n0.00000 \n1.67544"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "各省省选", "浙江", "Special Judge"], "title": "[ZJOI2014] 星系调查", "background": null, "description": "银河历 $59451$ 年，在银河系有许许多多已被人类殖民的星系。如果想要在行星系间往来，大家一般使用连接两个行星系的跳跃星门。一个跳跃星门可以把物质在它所连接的两个行星系中互相传送。露露、花花和萱萱被银河系星际联盟调查局任命调查商业巨擘 ZeusLeague+ 的不正当商业行为。\n\n在银河系有 $N$ 个已被 ZeusLeague+ 成功打入市场的行星系，不妨标号为 $1,2,...,N$。而 ZeusLeague+ 在这 $N$ 个行星系之间还拥有自己的 $M$ 个跳跃星门。使用这些跳跃星门，ZeusLeague+ 的物资就可以在这 $N$ 个行星系中两两任意互相传输。由于经费问题，跳跃星门的个数不会超过行星系的个数。\n\n露露在颇费周折之后得到了 ZeusLeague+ 在这 $N$ 个行星系中的各自的贸易总额 $C_i$。\n\n萱萱设计了一个经济学特征指标 $D_i$ 来度量这 $N$ 个行星系的经济学特征。于是，我们可以用二元组 $(C_i,D_i)$ 来表示第 $i$ 个行星系的 XP (Xuan's Position)。现在假设我们有 $k$ 个行星系的 XPs，把它们放置在二维平面上，然后我们用一条直线去拟合这些 XPs。定义一条直线与 XPs的相斥度为这条直线到各个 XP 的 Euclid 距离的平方之和。再令 XPs 的线性假设相斥度为所有直线与 XPs 的相斥度中的最小者。那么，这个值越小，ZeusLeague+ 在这 $k$ 个行星系中的相互贸易活动就越可疑，从而值得进一步调查。花花负责计算许多行星系对 $(u,v)$ 的非可疑度。一条跳跃星门航线的非可疑度被定义为它经过的所有行星系（包括起点和终点）的 XPs 的线性假设相斥度。而一个行星系对 $(u,v)$ 的非可疑度则被定义为所有以 $u$ 为起点，$v$ 为终点的跳跃星门航线的非可疑度中的最小值。一条跳跃星门航线是指从某个行星系开始，通过跳跃星门依次到达某些行星系，然后终止，并且中途不重复经过行星系，这样的一个过程。\n\n花花负责计算许多行星系对 $(u,v)$ 的非可疑度。一条跳跃星门航线的非可疑度被定义为它经过的所有行星系（包括起点和终点）的 XPs 的线性假设相斥度。而一个行星系对 $(u,v)$的非可疑度则被定义为所有以 $u$ 为起点，$v$ 为终点的跳跃星门航线的非可疑度中的最小值。一条跳跃星门航线是指从某个行星系开始，通过跳跃星门依次到达某些行星系，然后终止，并且中途不重复经过行星系，这样的一个过程。\n\n在花花数天夜以继日的工作之后，平行调查组的你——大名鼎鼎的计算机科学家 Hcceleration.Gerk.Gounce 不忍心看到她这样不眠不休，于是你在完成了手头的工作之后决定帮一帮她。", "inputFormat": "第一行是 $N,M$，分别表示这个银河系内的行星系的个数以及跳跃星门的个数。接下来 $N$ 行，每行2个正整数 $C_i,D_i$，表示第 $i$ 个行星系的 XP (Xuan's Position)。接下来的 $M$ 行来描述跳跃星门，每行两个正整数 $u_i,v_i$，表示有一个连接着行星系 $u_i$ 和 $v_i$ 的跳跃星门。注意这个连接是无向的。不会存在自己连向自己的情况。也不会存在重复连接的情况。接下来的一行，有一个正整数 $Q$，表示花花需要计算的非可疑度的行星对数。接下来的 $Q$ 行，每行两个正整数 $s_i,t_i$，表示花花需要计算从 $s_i$ 到 $t_i$ 的非可疑度。", "outputFormat": "总共 $Q$ 行，每一行一个实数，表示花花第 $i$ 次需要计算的答案。你的答案需要和标准答案的差不超过 $0.01$ 才能得分。", "hint": "$1\\leq N,M,Q\\leq 10^5,1\\leq u_i,v_i,s_i,t_i\\leq N,1\\leq C_i,D_i\\leq 100.$\n\n#### 简要题意（by yummy）\n\n在边数不超过结点数的简单无权无向连通图内，每个结点在平面直角坐标系内对应一个坐标。有 $Q$ 组询问，每次给一对结点，找出一条路径，并找出一条直线，使得该路径上结点对应的坐标到直线距离平方和最小，并输出最小值。\n\n[spj 0.01]", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2014] Galaxy Survey", "background": "", "description": "In Galactic Year $59451$, there are many star systems in the Milky Way that have been colonized by humans. To travel between planetary systems, people typically use jump gates that connect two planetary systems. A jump gate can transfer matter between the two planetary systems it connects. Lulu, Huahua, and Xuānxuān are appointed by the Galactic Interstellar Alliance Investigation Bureau to investigate the unfair business practices of the commercial giant ZeusLeague+.\n\nThere are $N$ planetary systems where ZeusLeague+ has successfully entered the market, labeled $1, 2, \\ldots, N$. ZeusLeague+ also owns $M$ jump gates among these $N$ planetary systems. Using these jump gates, ZeusLeague+ can transport goods between any pair of the $N$ planetary systems. Due to budget constraints, the number of jump gates does not exceed the number of planetary systems.\n\nAfter considerable effort, Lulu obtained the total trade volume $C_i$ of ZeusLeague+ in each of the $N$ planetary systems.\n\nXuānxuān designed an economic characteristic index $D_i$ to measure the economic features of these $N$ planetary systems. Thus, we can use the pair $(C_i, D_i)$ to denote the XP (Xuan's Position) of the $i$-th planetary system. Now suppose we have the XPs of $k$ planetary systems and place them on a 2D plane. We then fit a straight line to these XPs. Define the repulsiveness of a straight line with respect to the XPs as the sum of squared Euclidean distances from that line to each XP. Then define the linear-hypothesis repulsiveness of the XPs as the minimum repulsiveness over all straight lines. The smaller this value is, the more suspicious the mutual trade activities of ZeusLeague+ among these $k$ planetary systems are, and thus more deserving of further investigation.\n\nHuahua is responsible for computing the non-suspiciousness of many pairs of planetary systems $(u, v)$. The non-suspiciousness of a jump-gate route is defined as the linear-hypothesis repulsiveness of the XPs of all planetary systems it passes through (including the start and end). The non-suspiciousness of a pair of planetary systems $(u, v)$ is defined as the minimum, over all jump-gate routes starting at $u$ and ending at $v$, of the non-suspiciousness of those routes. A jump-gate route is a process that starts from some planetary system, visits some planetary systems in sequence via jump gates, and then terminates, without visiting any planetary system more than once.\n\nAfter days and nights of work by Huahua, you—the renowned computer scientist Hcceleration.Gerk.Gounce from the parallel investigation team—cannot bear to see her working without rest. Having completed your own tasks, you decide to help her.", "inputFormat": "The first line contains $N, M$, the number of planetary systems in the galaxy and the number of jump gates, respectively. The next $N$ lines each contain two positive integers $C_i, D_i$, representing the XP (Xuan's Position) of the $i$-th planetary system. The next $M$ lines describe the jump gates, each with two positive integers $u_i, v_i$, indicating there is a jump gate connecting planetary systems $u_i$ and $v_i$. Note that this connection is undirected. There are no self-loops and no multiple edges. The next line contains a positive integer $Q$, the number of pairs of planetary systems for which Huahua needs to compute the non-suspiciousness. The following $Q$ lines each contain two positive integers $s_i, t_i$, indicating that Huahua needs to compute the non-suspiciousness from $s_i$ to $t_i$.", "outputFormat": "Output $Q$ lines. Each line contains a real number, which is the answer to Huahua’s $i$-th query. Your answer must differ from the standard answer by no more than $0.01$ to receive credit.", "hint": "$1\\leq N, M, Q\\leq 10^5, 1\\leq u_i, v_i, s_i, t_i\\leq N, 1\\leq C_i, D_i\\leq 100.$\n\nBrief statement (by yummy): In a simple, unweighted, undirected, connected graph with the number of edges not exceeding the number of nodes, each node corresponds to a coordinate in the Cartesian plane. There are $Q$ queries. For each given pair of nodes, find a path and a straight line such that the sum of squared distances from the coordinates of nodes on that path to the line is minimized, and output the minimum value.\n\n[spj 0.01]\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2014] 星系调查", "background": null, "description": "银河历 $59451$ 年，在银河系有许许多多已被人类殖民的星系。如果想要在行星系间往来，大家一般使用连接两个行星系的跳跃星门。一个跳跃星门可以把物质在它所连接的两个行星系中互相传送。露露、花花和萱萱被银河系星际联盟调查局任命调查商业巨擘 ZeusLeague+ 的不正当商业行为。\n\n在银河系有 $N$ 个已被 ZeusLeague+ 成功打入市场的行星系，不妨标号为 $1,2,...,N$。而 ZeusLeague+ 在这 $N$ 个行星系之间还拥有自己的 $M$ 个跳跃星门。使用这些跳跃星门，ZeusLeague+ 的物资就可以在这 $N$ 个行星系中两两任意互相传输。由于经费问题，跳跃星门的个数不会超过行星系的个数。\n\n露露在颇费周折之后得到了 ZeusLeague+ 在这 $N$ 个行星系中的各自的贸易总额 $C_i$。\n\n萱萱设计了一个经济学特征指标 $D_i$ 来度量这 $N$ 个行星系的经济学特征。于是，我们可以用二元组 $(C_i,D_i)$ 来表示第 $i$ 个行星系的 XP (Xuan's Position)。现在假设我们有 $k$ 个行星系的 XPs，把它们放置在二维平面上，然后我们用一条直线去拟合这些 XPs。定义一条直线与 XPs的相斥度为这条直线到各个 XP 的 Euclid 距离的平方之和。再令 XPs 的线性假设相斥度为所有直线与 XPs 的相斥度中的最小者。那么，这个值越小，ZeusLeague+ 在这 $k$ 个行星系中的相互贸易活动就越可疑，从而值得进一步调查。花花负责计算许多行星系对 $(u,v)$ 的非可疑度。一条跳跃星门航线的非可疑度被定义为它经过的所有行星系（包括起点和终点）的 XPs 的线性假设相斥度。而一个行星系对 $(u,v)$ 的非可疑度则被定义为所有以 $u$ 为起点，$v$ 为终点的跳跃星门航线的非可疑度中的最小值。一条跳跃星门航线是指从某个行星系开始，通过跳跃星门依次到达某些行星系，然后终止，并且中途不重复经过行星系，这样的一个过程。\n\n花花负责计算许多行星系对 $(u,v)$ 的非可疑度。一条跳跃星门航线的非可疑度被定义为它经过的所有行星系（包括起点和终点）的 XPs 的线性假设相斥度。而一个行星系对 $(u,v)$的非可疑度则被定义为所有以 $u$ 为起点，$v$ 为终点的跳跃星门航线的非可疑度中的最小值。一条跳跃星门航线是指从某个行星系开始，通过跳跃星门依次到达某些行星系，然后终止，并且中途不重复经过行星系，这样的一个过程。\n\n在花花数天夜以继日的工作之后，平行调查组的你——大名鼎鼎的计算机科学家 Hcceleration.Gerk.Gounce 不忍心看到她这样不眠不休，于是你在完成了手头的工作之后决定帮一帮她。", "inputFormat": "第一行是 $N,M$，分别表示这个银河系内的行星系的个数以及跳跃星门的个数。接下来 $N$ 行，每行2个正整数 $C_i,D_i$，表示第 $i$ 个行星系的 XP (Xuan's Position)。接下来的 $M$ 行来描述跳跃星门，每行两个正整数 $u_i,v_i$，表示有一个连接着行星系 $u_i$ 和 $v_i$ 的跳跃星门。注意这个连接是无向的。不会存在自己连向自己的情况。也不会存在重复连接的情况。接下来的一行，有一个正整数 $Q$，表示花花需要计算的非可疑度的行星对数。接下来的 $Q$ 行，每行两个正整数 $s_i,t_i$，表示花花需要计算从 $s_i$ 到 $t_i$ 的非可疑度。", "outputFormat": "总共 $Q$ 行，每一行一个实数，表示花花第 $i$ 次需要计算的答案。你的答案需要和标准答案的差不超过 $0.01$ 才能得分。", "hint": "$1\\leq N,M,Q\\leq 10^5,1\\leq u_i,v_i,s_i,t_i\\leq N,1\\leq C_i,D_i\\leq 100.$\n\n#### 简要题意（by yummy）\n\n在边数不超过结点数的简单无权无向连通图内，每个结点在平面直角坐标系内对应一个坐标。有 $Q$ 组询问，每次给一对结点，找出一条路径，并找出一条直线，使得该路径上结点对应的坐标到直线距离平方和最小，并输出最小值。\n\n[spj 0.01]", "locale": "zh-CN"}}}
{"pid": "P3341", "type": "P", "difficulty": 6, "samples": [["4 4\n4\n1 1 1 4\n1 2 3 4\n1 3 3 2\n4 1 2 3\n6\n2 3 U R\n2 1 D R\n2 2 L R\n2 4 L D\n3 1 L R\n3 3 L U", "2\n4\n4 3 L U\n3 3 L U\n3 2 R U\n1 2 L R"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["模拟", "2014", "各省省选", "浙江", "Special Judge", "枚举", "队列"], "title": "[ZJOI2014] 消棋子", "background": "", "description": "消棋子是一个有趣的游戏。游戏在一个 $r \\times c$ 的棋盘上进行。棋盘的每个格子，要么是空，要么是一种颜色的棋子。同一种颜色的棋子恰好有两个。每一轮，玩家可以选择一个空格子 $(x, y)$，并选择上下左右四个方向中的两个方向，如果在这两个方向上均存在有棋子的格子，而且沿着这两个方向上第一个遇到的棋子颜色相同，那么，我们将这两个棋子拿走，并称之为合法的操作。否则称这个操作不合法，游戏不会处理这个操作。游戏的目的是消除尽量多的棋子。\n\n给出这样一个游戏和一个人的玩法。你需要： \n1. 指出此人能消去多少棋子。 \n2. 给出一种能消去最多棋子的方案。", "inputFormat": "第一行给出了整数 $r$，$c$。\n\n第二行给出了整数 $n$，表示不同颜色数。\n\n接下来 $n$ 行，第 $i$ 行含四个整数 $a_i, b_i, c_i, d_i$，表示颜色为 $i$ 的两个格子分别是 $(a_i, b_i),\\ (c_i, d_i)$。\n\n然后是一个整数 $m$，表示此人的操作数。接下来 $m$ 行，每行有两个整数和两个字母，代表了他选择的格子，以及两个方向。我们用 $\\texttt{UDLR}$ 分别表示上下左右。", "outputFormat": "第一行输出此人能消去多少棋子。\n\n第二行含一个整数 $k$，表示你给出的方案的操作数。\n\n接下来 $k$ 行，每行两个整数和两个字母，代表你选择的格子以及两个方向。", "hint": "对于所有数据，$1\\leq r,c,n \\leq 10^5$，数据保证答案的操作数 $0\\leq k \\leq 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2014] Remove Pieces", "background": "", "description": "Remove Pieces is an interesting game. The game is played on an $r \\times c$ board. Each cell of the board is either empty or contains a piece of some color. Each color appears exactly twice. In each round, the player can choose an empty cell $(x, y)$ and choose two directions among up, down, left, and right. If, in each of the two chosen directions, there exists a cell containing a piece, and the first piece encountered along each direction has the same color, then we take away those two pieces, and call this a legal move. Otherwise, the move is illegal and the game will not process this move. The goal is to remove as many pieces as possible.\n\nGiven such a game and a person's sequence of moves, you need to:\n1. State how many pieces this person can remove.\n2. Provide a sequence of moves that removes the maximum number of pieces.", "inputFormat": "The first line gives the integers $r$, $c$.\n\nThe second line gives the integer $n$, the number of different colors.\n\nThe next $n$ lines, the $i$-th line contains four integers $a_i, b_i, c_i, d_i$, meaning that the two cells of color $i$ are $(a_i, b_i),\\ (c_i, d_i)$.\n\nThen an integer $m$ follows, the number of this person’s moves. The next $m$ lines each contain two integers and two letters, representing the chosen cell and the two directions. We use $\\texttt{UDLR}$ to denote up, down, left, and right, respectively.", "outputFormat": "The first line outputs how many pieces this person can remove.\n\nThe second line contains an integer $k$, the number of moves in your sequence.\n\nThe next $k$ lines each contain two integers and two letters, representing your chosen cell and the two directions.", "hint": "For all testdata, $1 \\leq r, c, n \\leq 10^5$, and it is guaranteed that in the answer the number of operations satisfies $0 \\leq k \\leq 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2014] 消棋子", "background": "", "description": "消棋子是一个有趣的游戏。游戏在一个 $r \\times c$ 的棋盘上进行。棋盘的每个格子，要么是空，要么是一种颜色的棋子。同一种颜色的棋子恰好有两个。每一轮，玩家可以选择一个空格子 $(x, y)$，并选择上下左右四个方向中的两个方向，如果在这两个方向上均存在有棋子的格子，而且沿着这两个方向上第一个遇到的棋子颜色相同，那么，我们将这两个棋子拿走，并称之为合法的操作。否则称这个操作不合法，游戏不会处理这个操作。游戏的目的是消除尽量多的棋子。\n\n给出这样一个游戏和一个人的玩法。你需要： \n1. 指出此人能消去多少棋子。 \n2. 给出一种能消去最多棋子的方案。", "inputFormat": "第一行给出了整数 $r$，$c$。\n\n第二行给出了整数 $n$，表示不同颜色数。\n\n接下来 $n$ 行，第 $i$ 行含四个整数 $a_i, b_i, c_i, d_i$，表示颜色为 $i$ 的两个格子分别是 $(a_i, b_i),\\ (c_i, d_i)$。\n\n然后是一个整数 $m$，表示此人的操作数。接下来 $m$ 行，每行有两个整数和两个字母，代表了他选择的格子，以及两个方向。我们用 $\\texttt{UDLR}$ 分别表示上下左右。", "outputFormat": "第一行输出此人能消去多少棋子。\n\n第二行含一个整数 $k$，表示你给出的方案的操作数。\n\n接下来 $k$ 行，每行两个整数和两个字母，代表你选择的格子以及两个方向。", "hint": "对于所有数据，$1\\leq r,c,n \\leq 10^5$，数据保证答案的操作数 $0\\leq k \\leq 10^6$。", "locale": "zh-CN"}}}
{"pid": "P3342", "type": "P", "difficulty": 6, "samples": [["2\n0 7 2 3\n0 8 1 4\n4 5 4 1\n8 6 3 2\n16 3 6 7\n32 4 5 8\n1 1 8 5\n2 2 7 6", "0 12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1500], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "各省省选", "浙江", "枚举", "广度优先搜索 BFS", "图论建模"], "title": "[ZJOI2014] 璀灿光华", "background": "", "description": "金先生有一个女朋友没名字。她勤劳勇敢、智慧善良。金先生很喜欢她。为此，金先生用 $a^3$ 块 $1\\times 1 \\times 1$ 的独特的水晶制作了一个边长为 $a$ 的水晶立方体，他要将这个水晶立方体送给他见过最单纯善良的她。\n\n由于水晶立方体太太，不好运送，金先生还是将它拆开来送出。他相信拼好这个水晶立方难不倒聪明的她。\n\n没名字收到了礼物后果然不一会儿就根据说明将水晶立方体拼好了。没名字发现，有 $n$ 块水晶在漆黑安静的夜晚会随机以等概率向上下左右前后六个方向的一个发出穿透光。被光照到的水晶显得格外好看。没名字给每一块不会发光的水晶定义了一个好看程度。水晶立方体在夜晚中的好看程度就是每块被光照到的水晶的好看程度之和。没名字想知道，水晶立方体在夜晚中的好看程度的最小值和最大值。", "inputFormat": "第一行是 $a$，表示水晶立方体的边长。\n接下来 $a^3$ 行，每行若干整数。\n第一个数 $g_i$ 表示第 $i$ 块水晶的好看程度。如果 $g_i=0$，代表这块水晶会发光。接下来 $3\\sim 6$ 个整数，代表与这块水晶有共同面的水晶编号。", "outputFormat": "两个整数，代表水晶立方体在夜晚好看程度的最小值与最大值。", "hint": "对于所有数据，$1<a\\leq 70$，$g_i<10^6$，$n\\leq 8$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2014] Brilliant Light", "background": "", "description": "Mr. Jin has a girlfriend without a name. She is hardworking, brave, wise, and kind. Mr. Jin likes her very much. To this end, he used $a^3$ unique $1\\times 1 \\times 1$ crystal blocks to make a crystal cube with side length $a$. He wants to give this crystal cube to the purest and kindest girl he has ever met.\n\nBecause the crystal cube is too big to transport, Mr. Jin decided to take it apart before sending it. He believes that reassembling the crystal cube will not be difficult for her, since she is smart.\n\nAfter receiving the gift, the nameless girl quickly reassembled the crystal cube according to the instructions. She found that there are $n$ crystals which, in a dark and quiet night, randomly emit a penetrating beam in one of the six directions (up, down, left, right, front, back) with equal probability. Crystals that are illuminated by the beams look especially beautiful. For each crystal that does not emit light, she defined a beauty value. The beauty of the crystal cube at night is the sum of the beauty values of all illuminated crystals. She wants to know the minimum and maximum possible beauty of the crystal cube at night.", "inputFormat": "The first line contains $a$, the side length of the crystal cube.\nThen follow $a^3$ lines, each containing several integers.\nThe first number $g_i$ is the beauty value of the $i$‑th crystal. If $g_i = 0$, this crystal emits light. Then follow 3 to 6 integers, which are the indices of crystals that share a face with this crystal.", "outputFormat": "Output two integers: the minimum and the maximum possible beauty of the crystal cube at night.", "hint": "For all testdata, $1 < a \\leq 70$, $g_i < 10^6$, $n \\leq 8$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2014] 璀灿光华", "background": "", "description": "金先生有一个女朋友没名字。她勤劳勇敢、智慧善良。金先生很喜欢她。为此，金先生用 $a^3$ 块 $1\\times 1 \\times 1$ 的独特的水晶制作了一个边长为 $a$ 的水晶立方体，他要将这个水晶立方体送给他见过最单纯善良的她。\n\n由于水晶立方体太太，不好运送，金先生还是将它拆开来送出。他相信拼好这个水晶立方难不倒聪明的她。\n\n没名字收到了礼物后果然不一会儿就根据说明将水晶立方体拼好了。没名字发现，有 $n$ 块水晶在漆黑安静的夜晚会随机以等概率向上下左右前后六个方向的一个发出穿透光。被光照到的水晶显得格外好看。没名字给每一块不会发光的水晶定义了一个好看程度。水晶立方体在夜晚中的好看程度就是每块被光照到的水晶的好看程度之和。没名字想知道，水晶立方体在夜晚中的好看程度的最小值和最大值。", "inputFormat": "第一行是 $a$，表示水晶立方体的边长。\n接下来 $a^3$ 行，每行若干整数。\n第一个数 $g_i$ 表示第 $i$ 块水晶的好看程度。如果 $g_i=0$，代表这块水晶会发光。接下来 $3\\sim 6$ 个整数，代表与这块水晶有共同面的水晶编号。", "outputFormat": "两个整数，代表水晶立方体在夜晚好看程度的最小值与最大值。", "hint": "对于所有数据，$1<a\\leq 70$，$g_i<10^6$，$n\\leq 8$。\n", "locale": "zh-CN"}}}
{"pid": "P3343", "type": "P", "difficulty": 7, "samples": [["5 4\n1 2\n1 5\n4 3\n5 3", "0.800000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "各省省选", "浙江", "期望", "积分", "状压 DP"], "title": "[ZJOI2015] 地震后的幻想乡", "background": "", "description": "傲娇少女幽香是一个很萌很萌的妹子，而且她非常非常地有爱心，很喜欢为幻想乡的人们做一些自己力所能及的事情来帮助他们。 \n\n这不，幻想乡突然发生了地震，所有的道路都崩塌了。现在的首要任务是尽快让幻想乡的交通体系重新建立起来。幻想乡一共有 $n$ 个地方，那么最快的方法当然是修复 $n-1$ 条道路将这 $n$ 个地方都连接起来。 幻想乡这 $n$ 个地方本来是连通的，一共有 $m$ 条边。现在这 $m$ 条边由于地震的关系，全部都毁坏掉了。每条边都有一个修复它需要花费的时间，第 $i$ 条边所需要的时间为 $e_i$。地震发生以后，由于幽香是一位人生经验丰富，见得多了的长者，她根据以前的经验，知道每次地震以后，每个 $e_i$ 会是一个 $0$ 到 $1$ 之间均匀分布的随机实数。并且所有 $e_i$ 都是完全独立的。\n\n现在幽香要出发去帮忙修复道路了，她可以使用一个神奇的大魔法，能够选择需要的那 $n-1$ 条边，同时开始修复，那么修复完成的时间就是这 $n-1$ 条边的 $e_i$ 的最大值。当然幽香会先使用一个更加神奇的大魔法来观察出每条边 $e_i$ 的值，然后再选择完成时间最小的方案。 幽香在走之前，她想知道修复完成的时间的期望是多少呢？", "inputFormat": "第一行两个数 $n,m$，表示地方的数量和边的数量。其中点从 $1$ 到 $n$ 标号。\n\n接下来 $m$ 行，每行两个数 $a,b$，表示点 $a$ 和点 $b$ 之间原来有一条边。这个图不会有重边和自环。", "outputFormat": "一行输出答案，四舍五入保留 $6$ 位小数。\n", "hint": "### 样例解释\n\n对于第一个样例，由于只有四条边，幽香显然只能选择这四条，那么答案就是四条边的 $e_i$ 中最大的数的期望，由提示中的内容，可知答案为 $0.8$。\n\n### 提示 \n\n（以下内容与题意无关，对于解题也不是必要的。） \n\n对于 $n$ 个 $[0,1]$ 之间的随机变量 $x_1,x_2,...,x_n$，第 $k$ 小的那个的期望值是 $k/(n+1)$。  \n\n数据范围： \n\n对于所有数据：$n \\leq 10, \\ m \\leq n(n-1)/2, \\ n,m \\geq 1$。 \n\n对于 $15 \\%$ 的数据：$n \\leq 3$。 \n\n另有 $15 \\%$ 的数据：$n \\leq 10, m=n$。 \n\n另有 $10 \\%$ 的数据：$n \\leq 10, m=n(n-1)/2$。 \n\n另有 $20 \\%$ 的数据：$n \\leq 5$。 \n\n另有 $20 \\%$ 的数据：$n \\leq 8$。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2015] Gensokyo After the Earthquake", "background": "", "description": "The tsundere girl Yuuka is very cute and very kind, and she likes to help the people of Gensokyo with what she can.\n\nAn earthquake suddenly struck Gensokyo, and all the roads collapsed. The top priority now is to reestablish the transportation network as soon as possible. There are $n$ places in total, and the fastest way is of course to repair $n-1$ roads to connect all $n$ places. Originally, these $n$ places formed a connected graph with $m$ edges. Due to the earthquake, all $m$ edges were destroyed. Each edge has a repair time; the $i$-th edge requires time $e_i$. Based on past experience, Yuuka knows that after each earthquake, every $e_i$ is an independent random real number uniformly distributed in $[0,1]$, and all $e_i$ are mutually independent.\n\nYuuka is going to help repair the roads. She can use a magical spell to select the required $n-1$ edges and start repairing them simultaneously; the completion time is then the maximum of the $e_i$ on those $n-1$ edges. Of course, Yuuka will first use an even more magical spell to observe the value of each $e_i$, and then choose the plan that minimizes the completion time. Before she leaves, she wants to know the expected value of the completion time.", "inputFormat": "The first line contains two integers $n, m$, the number of places and the number of edges. The vertices are labeled from $1$ to $n$.\n\nThe next $m$ lines each contain two integers $a, b$, indicating that there was originally an edge between vertices $a$ and $b$. The graph has no multiple edges or self-loops.", "outputFormat": "Output one line with the answer, rounded to $6$ decimal places.", "hint": "### Sample Explanation\n\nFor the first sample, since there are only four edges, Yuuka can only choose these four. The answer is the expectation of the maximum among the four $e_i$. As noted in the hint below, the answer is $0.8$.\n\n### Hint\n\n(The following content is unrelated to the problem and is not necessary for solving it.)\n\nFor $n$ random variables $x_1,x_2,\\ldots,x_n$ uniformly distributed in $[0,1]$, the expected value of the $k$-th smallest is $k/(n+1)$.\n\nConstraints:\n\nFor all testdata: $n \\leq 10$, $m \\leq n(n-1)/2$, $n, m \\geq 1$.\n\nFor $15\\%$ of the testdata: $n \\leq 3$.\n\nAdditionally, for $15\\%$ of the testdata: $n \\leq 10$, $m = n$.\n\nAdditionally, for $10\\%$ of the testdata: $n \\leq 10$, $m = n(n-1)/2$.\n\nAdditionally, for $20\\%$ of the testdata: $n \\leq 5$.\n\nAdditionally, for $20\\%$ of the testdata: $n \\leq 8$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2015] 地震后的幻想乡", "background": "", "description": "傲娇少女幽香是一个很萌很萌的妹子，而且她非常非常地有爱心，很喜欢为幻想乡的人们做一些自己力所能及的事情来帮助他们。 \n\n这不，幻想乡突然发生了地震，所有的道路都崩塌了。现在的首要任务是尽快让幻想乡的交通体系重新建立起来。幻想乡一共有 $n$ 个地方，那么最快的方法当然是修复 $n-1$ 条道路将这 $n$ 个地方都连接起来。 幻想乡这 $n$ 个地方本来是连通的，一共有 $m$ 条边。现在这 $m$ 条边由于地震的关系，全部都毁坏掉了。每条边都有一个修复它需要花费的时间，第 $i$ 条边所需要的时间为 $e_i$。地震发生以后，由于幽香是一位人生经验丰富，见得多了的长者，她根据以前的经验，知道每次地震以后，每个 $e_i$ 会是一个 $0$ 到 $1$ 之间均匀分布的随机实数。并且所有 $e_i$ 都是完全独立的。\n\n现在幽香要出发去帮忙修复道路了，她可以使用一个神奇的大魔法，能够选择需要的那 $n-1$ 条边，同时开始修复，那么修复完成的时间就是这 $n-1$ 条边的 $e_i$ 的最大值。当然幽香会先使用一个更加神奇的大魔法来观察出每条边 $e_i$ 的值，然后再选择完成时间最小的方案。 幽香在走之前，她想知道修复完成的时间的期望是多少呢？", "inputFormat": "第一行两个数 $n,m$，表示地方的数量和边的数量。其中点从 $1$ 到 $n$ 标号。\n\n接下来 $m$ 行，每行两个数 $a,b$，表示点 $a$ 和点 $b$ 之间原来有一条边。这个图不会有重边和自环。", "outputFormat": "一行输出答案，四舍五入保留 $6$ 位小数。\n", "hint": "### 样例解释\n\n对于第一个样例，由于只有四条边，幽香显然只能选择这四条，那么答案就是四条边的 $e_i$ 中最大的数的期望，由提示中的内容，可知答案为 $0.8$。\n\n### 提示 \n\n（以下内容与题意无关，对于解题也不是必要的。） \n\n对于 $n$ 个 $[0,1]$ 之间的随机变量 $x_1,x_2,...,x_n$，第 $k$ 小的那个的期望值是 $k/(n+1)$。  \n\n数据范围： \n\n对于所有数据：$n \\leq 10, \\ m \\leq n(n-1)/2, \\ n,m \\geq 1$。 \n\n对于 $15 \\%$ 的数据：$n \\leq 3$。 \n\n另有 $15 \\%$ 的数据：$n \\leq 10, m=n$。 \n\n另有 $10 \\%$ 的数据：$n \\leq 10, m=n(n-1)/2$。 \n\n另有 $20 \\%$ 的数据：$n \\leq 5$。 \n\n另有 $20 \\%$ 的数据：$n \\leq 8$。", "locale": "zh-CN"}}}
{"pid": "P3344", "type": "P", "difficulty": 6, "samples": [["10 10 10000\n6743 2963\n3505 1986\n3565 7235\n1735 5522\n16877 5597\n11621 6\n3100 8243\n1750 6173\n5709 7671\n7915 3915\n14339 -438 3075\n4278 15210 8371\n13996 19000 6750\n17049 -4969 7788\n737 16339 2934\n904 14023 2322\n8982 14759 4311\n13102 11458 5554\n4135 12183 576\n5087 -2459 6787", "10\n10438"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2015", "各省省选", "浙江", "分治"], "title": "[ZJOI2015] 幻想乡 Wi-Fi 搭建计划", "background": "", "description": "傲娇少女幽香是一个很萌很萌的妹子。随着科技的进步，幻想乡的大家也开始使用手机了。这时幽香发现没人来她的太阳花田玩了，她感到很伤心，于是向别人打听了一下，才知道原来大家都嫌弃这里没有 Wi-Fi，手机上网还需要流量。\n\n怎么办呢？幽香决定赶快搭建几个 Wi-Fi 点，让所有人都能在太阳花田里畅快地上网。\n\n我们可以近似地把太阳花田看成一个 $y$ 轴在 $[0,R]$ 之间，$x$ 坐标在 $(-\\infty,+\\infty)$（也就是在 $x$ 轴上无限延伸）的无限长方形。\n\n太阳花田里面有 $n$ 个景点，是游客们经常光顾的，幽香认为只要让这些景点尽量被 Wi-Fi 覆盖，那么游客们就肯定心满意足了。\n\n八云紫表示她可以帮幽香架设 Wi-Fi 路由器。现在通用的路由器，每个的覆盖半径正好也是 $R$。八云紫扫视了一遍地图，发现在太阳花田外面，只有 $m$ 个有网络的地点，她只可以在那里架设路由器。如果你在点 $p$ 搭建了路由器，那么位于 $q$ 的地点，只要 $p$ 和 $q$ 的欧几里得距离小于等于 $R$，$q$ 点就会被 Wi-Fi 覆盖。\n\n同时八云紫表示，架设难度随着地点的不同而不同，所以收费也不一样，在第 $i$ 个位置架设需要 $c_i$ 的钱。\n\n现在幽香想要覆盖尽量多的景点，在这个前提下，幽香也想要尽量节省钱。你能帮助她吗？", "inputFormat": "输入第一行三个整数 $n,m,R$，分别表示景点的数量，网络架设地点的数量和太阳花田的宽度。\n\n接下来 $n$ 行，每行两个整数 $x,y$，满足 $|x|\\le 10^8,0\\le y\\le R$，表示一个景点。两个景点的位置不会重合。\n\n接下来 $m$ 行，每行三个整数 $x,y,c$，满足 $|x|\\le 10^9$，$-10^8\\lt y\\lt 0$ 或者 $R\\lt y\\lt 10^8$，表示一个网络架设点的位置和花费。两个网络架设点不会重合。", "outputFormat": "输出第一行表示最多覆盖的景点数。\n\n第二行表示在覆盖景点数最多的前提下，最少的花费。", "hint": "- 对于 $10\\%$ 的数据，$n,m\\le 20$；\n- 对于另 $30\\%$ 的数据，$n,m\\le 100$，所有网络架设点的 $y$ 坐标都大于 $R$；\n- 对于另 $60\\%$ 的数据，$n,m\\le 100$。\n\n对于全部数据，$1\\le R\\le 10^8,0\\le c\\le 10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2015] Gensokyo Wi-Fi Deployment Plan", "background": "", "description": "The tsundere girl Yuuka is a very cute girl. As technology advances, everyone in Gensokyo has started using mobile phones. Yuuka noticed that no one comes to her sunflower field anymore. Feeling sad, she asked around and learned that everyone dislikes the lack of Wi-Fi there, and mobile data is required to access the Internet.\n\nWhat should she do? Yuuka decides to quickly deploy several Wi-Fi hotspots so that everyone can surf the Internet freely in the sunflower field.\n\nWe can approximate the sunflower field as an infinitely long rectangle with the $y$ coordinate in $[0, R]$ and the $x$ coordinate in $(-\\infty, +\\infty)$ (i.e., extending infinitely along the $x$-axis).\n\nThere are $n$ scenic spots inside the sunflower field that tourists often visit. Yuuka thinks that as long as these spots are covered by Wi-Fi as much as possible, the visitors will be satisfied.\n\nYukari Yakumo says she can help Yuuka set up Wi-Fi routers. Each standard router has a coverage radius of exactly $R$. After surveying the map, Yukari finds that outside the sunflower field there are only $m$ locations with network access, and she can only install routers there. If you install a router at point $p$, then any location $q$ with Euclidean distance between $p$ and $q$ less than or equal to $R$ will be covered by Wi-Fi.\n\nAt the same time, Yukari says that installation difficulty varies by location, so the fee also differs. Installing at the $i$-th location costs $c_i$.\n\nNow Yuuka wants to cover as many scenic spots as possible. Under this condition, she also wants to minimize the total cost. Can you help her?", "inputFormat": "The first line contains three integers $n, m, R$, representing the number of scenic spots, the number of network installation locations, and the width of the sunflower field.\n\nThe next $n$ lines each contain two integers $x, y$, satisfying $|x| \\le 10^8, 0 \\le y \\le R$, describing a scenic spot. No two scenic spots share the same position.\n\nThe next $m$ lines each contain three integers $x, y, c$, satisfying $|x| \\le 10^9$, $-10^8 \\lt y \\lt 0$ or $R \\lt y \\lt 10^8$, describing a network installation location and its cost. No two network installation locations share the same position.", "outputFormat": "The first line outputs the maximum number of scenic spots that can be covered.\n\nThe second line outputs the minimum total cost under the condition that the number of covered scenic spots is maximized.", "hint": "- For $10\\%$ of the testdata, $n, m \\le 20$.\n- For another $30\\%$ of the testdata, $n, m \\le 100$, and all installation locations have $y$-coordinates greater than $R$.\n- For another $60\\%$ of the testdata, $n, m \\le 100$.\n\nFor all testdata, $1 \\le R \\le 10^8$, $0 \\le c \\le 10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2015] 幻想乡 Wi-Fi 搭建计划", "background": "", "description": "傲娇少女幽香是一个很萌很萌的妹子。随着科技的进步，幻想乡的大家也开始使用手机了。这时幽香发现没人来她的太阳花田玩了，她感到很伤心，于是向别人打听了一下，才知道原来大家都嫌弃这里没有 Wi-Fi，手机上网还需要流量。\n\n怎么办呢？幽香决定赶快搭建几个 Wi-Fi 点，让所有人都能在太阳花田里畅快地上网。\n\n我们可以近似地把太阳花田看成一个 $y$ 轴在 $[0,R]$ 之间，$x$ 坐标在 $(-\\infty,+\\infty)$（也就是在 $x$ 轴上无限延伸）的无限长方形。\n\n太阳花田里面有 $n$ 个景点，是游客们经常光顾的，幽香认为只要让这些景点尽量被 Wi-Fi 覆盖，那么游客们就肯定心满意足了。\n\n八云紫表示她可以帮幽香架设 Wi-Fi 路由器。现在通用的路由器，每个的覆盖半径正好也是 $R$。八云紫扫视了一遍地图，发现在太阳花田外面，只有 $m$ 个有网络的地点，她只可以在那里架设路由器。如果你在点 $p$ 搭建了路由器，那么位于 $q$ 的地点，只要 $p$ 和 $q$ 的欧几里得距离小于等于 $R$，$q$ 点就会被 Wi-Fi 覆盖。\n\n同时八云紫表示，架设难度随着地点的不同而不同，所以收费也不一样，在第 $i$ 个位置架设需要 $c_i$ 的钱。\n\n现在幽香想要覆盖尽量多的景点，在这个前提下，幽香也想要尽量节省钱。你能帮助她吗？", "inputFormat": "输入第一行三个整数 $n,m,R$，分别表示景点的数量，网络架设地点的数量和太阳花田的宽度。\n\n接下来 $n$ 行，每行两个整数 $x,y$，满足 $|x|\\le 10^8,0\\le y\\le R$，表示一个景点。两个景点的位置不会重合。\n\n接下来 $m$ 行，每行三个整数 $x,y,c$，满足 $|x|\\le 10^9$，$-10^8\\lt y\\lt 0$ 或者 $R\\lt y\\lt 10^8$，表示一个网络架设点的位置和花费。两个网络架设点不会重合。", "outputFormat": "输出第一行表示最多覆盖的景点数。\n\n第二行表示在覆盖景点数最多的前提下，最少的花费。", "hint": "- 对于 $10\\%$ 的数据，$n,m\\le 20$；\n- 对于另 $30\\%$ 的数据，$n,m\\le 100$，所有网络架设点的 $y$ 坐标都大于 $R$；\n- 对于另 $60\\%$ 的数据，$n,m\\le 100$。\n\n对于全部数据，$1\\le R\\le 10^8,0\\le c\\le 10^4$。", "locale": "zh-CN"}}}
{"pid": "P3345", "type": "P", "difficulty": 6, "samples": [["10 5\n1 2 1\n2 3 1\n2 4 1\n1 5 1\n2 6 1\n2 7 1\n5 8 1\n7 9 1\n1 10 1\n3 1\n2 1\n8 1\n3 1\n4 1", "0\n1\n4\n5\n6"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2015", "线段树", "各省省选", "点分治", "浙江"], "title": "[ZJOI2015] 幻想乡战略游戏", "background": "", "description": "傲娇少女幽香正在玩一个非常有趣的战略类游戏，本来这个游戏的地图其实还不算太大，幽香还能管得过来，但是不知道为什么现在的网游厂商把游戏的地图越做越大，以至于幽香一眼根本看不过来，更别说和别人打仗了。\n\n在打仗之前，幽香现在面临一个非常基本的管理问题需要解决。\n\n整个地图是一个树结构，一共有 $n$ 块空地，这些空地被 $n-1$ 条带权边连接起来，使得每两个点之间有一条唯一的路径将它们连接起来。\n\n在游戏中，幽香可能在空地上增加或者减少一些军队。同时，幽香可以在一个空地上放置一个补给站。如果补给站在点 $u$ 上，并且空地 $v$ 上有 $d_v$ 个单位的军队，那么幽香每天就要花费 $d_v \\times \\text{dist}(u,v)$ 的金钱来补给这些军队。由于幽香需要补给所有的军队，因此幽香总共就要花费为 $\\sum (d_v \\times \\text{dist}(u,v))$（其中 $1 \\leq v \\leq N$）的代价，$\\text{dist}(u,v)$ 表示 $u$ 和 $v$ 在树上的距离（唯一路径的权和）。\n\n因为游戏的规定，幽香只能选择一个空地作为补给站。在游戏的过程中，幽香可能会在某些空地上制造一些军队，也可能会减少某些空地上的军队，进行了这样的操作以后，出于经济上的考虑，幽香往往可以移动他的补给站从而省一些钱。但是由于这个游戏的地图是在太大了，幽香无法轻易的进行最优的安排，你能帮帮她吗？\n\n你可以假定一开始所有空地上都没有军队。", "inputFormat": "第一行两个数 $n$ 和 $Q$ 分别表示树的点数和幽香操作的个数，其中点从 $1$ 到 $n$ 标号。\n\n接下来 $n-1$ 行，每行三个正整数 $a,b,c$，表示 $a$ 和 $b$ 之间有一条边权为 $c$ 的边。\n\n接下来 $Q$ 行，每行两个数 $u,e$，表示幽香在点 $u$ 上放了 $e$ 单位个军队（如果 $e<0$，就相当于是幽香在 $u$ 上减少了 $|e|$ 单位个军队，说白了就是 $d_u←d_u+e$）。\n\n数据保证任何时刻每个点上的军队数量都是非负的。", "outputFormat": "对于幽香的每个操作，输出操作完成以后，每天的最小花费，也即如果幽香选择最优的补给点进行补给时的花费。\n", "hint": "对于所有数据，$1\\le c\\le 10^3$，$0\\le |e| \\le 10^3$，$1\\le n\\le10^5$，$ 1\\le Q\\le10^5$ 。\n\n非常神奇的是，对于所有数据，这棵树上的点的度数都不超过 $20$。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2015] Gensokyo Strategy Game", "background": "", "description": "The tsundere girl Yuuka is playing a very interesting strategy game. At first, the game map was not too large, and Yuuka could still manage it. But for some reason, the online game developers are making the map larger and larger, to the point that Yuuka can no longer take it all in at a glance, let alone fight others.\n\nBefore going to war, Yuuka needs to solve a very basic management problem.\n\nThe entire map is a tree with $n$ empty fields (nodes), connected by $n - 1$ weighted edges, so that there is a unique path between any two nodes.\n\nIn the game, Yuuka may increase or decrease troops on empty fields. At the same time, she can place one supply station on a node. If the supply station is at node $u$, and there are $d_v$ units of troops at node $v$, then Yuuka must spend $d_v \\times \\text{dist}(u,v)$ money per day to supply these troops. Since Yuuka needs to supply all troops, the total cost is $\\sum (d_v \\times \\text{dist}(u,v))$ (where $1 \\le v \\le n$). Here, $\\text{dist}(u,v)$ denotes the distance between $u$ and $v$ on the tree (the sum of weights along the unique path).\n\nDue to the game rules, Yuuka can choose only one node as the supply station. During the game, she may create troops on some nodes or reduce troops on some nodes. After such operations, for economic reasons, she may move the supply station to save money. However, since the map is just too large, Yuuka cannot easily make the optimal arrangement. Can you help her?\n\nYou may assume that initially all nodes have no troops.", "inputFormat": "The first line contains two integers $n$ and $Q$, denoting the number of nodes in the tree and the number of Yuuka’s operations, respectively. Nodes are labeled from $1$ to $n$.\n\nThe next $n - 1$ lines each contain three positive integers $a, b, c$, indicating that there is an edge between $a$ and $b$ with weight $c$.\n\nThe next $Q$ lines each contain two integers $u, e$, meaning Yuuka adds $e$ units of troops at node $u$ (if $e < 0$, that means Yuuka removes $|e|$ units at $u$; in other words, $d_u \\leftarrow d_u + e$).\n\nIt is guaranteed that at any time, the number of troops at each node is non-negative.", "outputFormat": "For each of Yuuka’s operations, output the minimal daily cost after the operation, i.e., the cost if Yuuka chooses the optimal supply station.", "hint": "For all testdata, $1 \\le c \\le 10^3$, $0 \\le |e| \\le 10^3$, $1 \\le n \\le 10^5$, $1 \\le Q \\le 10^5$.\n\nInterestingly, for all testdata, the degree of each node in the tree does not exceed $20$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2015] 幻想乡战略游戏", "background": "", "description": "傲娇少女幽香正在玩一个非常有趣的战略类游戏，本来这个游戏的地图其实还不算太大，幽香还能管得过来，但是不知道为什么现在的网游厂商把游戏的地图越做越大，以至于幽香一眼根本看不过来，更别说和别人打仗了。\n\n在打仗之前，幽香现在面临一个非常基本的管理问题需要解决。\n\n整个地图是一个树结构，一共有 $n$ 块空地，这些空地被 $n-1$ 条带权边连接起来，使得每两个点之间有一条唯一的路径将它们连接起来。\n\n在游戏中，幽香可能在空地上增加或者减少一些军队。同时，幽香可以在一个空地上放置一个补给站。如果补给站在点 $u$ 上，并且空地 $v$ 上有 $d_v$ 个单位的军队，那么幽香每天就要花费 $d_v \\times \\text{dist}(u,v)$ 的金钱来补给这些军队。由于幽香需要补给所有的军队，因此幽香总共就要花费为 $\\sum (d_v \\times \\text{dist}(u,v))$（其中 $1 \\leq v \\leq N$）的代价，$\\text{dist}(u,v)$ 表示 $u$ 和 $v$ 在树上的距离（唯一路径的权和）。\n\n因为游戏的规定，幽香只能选择一个空地作为补给站。在游戏的过程中，幽香可能会在某些空地上制造一些军队，也可能会减少某些空地上的军队，进行了这样的操作以后，出于经济上的考虑，幽香往往可以移动他的补给站从而省一些钱。但是由于这个游戏的地图是在太大了，幽香无法轻易的进行最优的安排，你能帮帮她吗？\n\n你可以假定一开始所有空地上都没有军队。", "inputFormat": "第一行两个数 $n$ 和 $Q$ 分别表示树的点数和幽香操作的个数，其中点从 $1$ 到 $n$ 标号。\n\n接下来 $n-1$ 行，每行三个正整数 $a,b,c$，表示 $a$ 和 $b$ 之间有一条边权为 $c$ 的边。\n\n接下来 $Q$ 行，每行两个数 $u,e$，表示幽香在点 $u$ 上放了 $e$ 单位个军队（如果 $e<0$，就相当于是幽香在 $u$ 上减少了 $|e|$ 单位个军队，说白了就是 $d_u←d_u+e$）。\n\n数据保证任何时刻每个点上的军队数量都是非负的。", "outputFormat": "对于幽香的每个操作，输出操作完成以后，每天的最小花费，也即如果幽香选择最优的补给点进行补给时的花费。\n", "hint": "对于所有数据，$1\\le c\\le 10^3$，$0\\le |e| \\le 10^3$，$1\\le n\\le10^5$，$ 1\\le Q\\le10^5$ 。\n\n非常神奇的是，对于所有数据，这棵树上的点的度数都不超过 $20$。", "locale": "zh-CN"}}}
{"pid": "P3346", "type": "P", "difficulty": 6, "samples": [["7 3\n0 2 1 2 1 0 0\n1 2\n3 4\n3 5\n4 6\n5 7\n2 5", "30"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["字符串", "2015", "各省省选", "浙江", "后缀自动机 SAM", "O2优化"], "title": "[ZJOI2015] 诸神眷顾的幻想乡", "background": null, "description": "幽香是全幻想乡里最受人欢迎的萌妹子，这天，是幽香的 $2600$ 岁生日，无数幽香的粉丝到了幽香家门前的太阳花田上来为幽香庆祝生日。\n\n粉丝们非常热情，自发组织表演了一系列节目给幽香看。幽香当然也非常高兴啦。\n\n这时幽香发现了一件非常有趣的事情，太阳花田有 $n$ 块空地。\n\n在过去，幽香为了方便，在这 $n$ 块空地之间修建了 $n-1$ 条边将它们连通起来。\n\n也就是说，这 $n$ 块空地形成了一个树的结构。\n\n有 $n$ 个粉丝来到了太阳花田上。\n\n为了表达对幽香生日的祝贺，他们选择了 $c$ 种颜色的衣服，每种颜色恰好可以用一个 $0$ 到 $c-1$ 之间的整数来表示。\n\n并且每个人都站在一个空地上，每个空地上也只有一个人。\n\n这样，整个太阳花田就花花绿绿了。幽香看到了，感觉也非常开心。\n\n粉丝们策划的一个节目是这样的，选中两个粉丝 $A$ 和 $B$（$A$ 和 $B$ 可以相同），然后 $A$ 所在的空地到 $B$ 所在的空地的路径上的粉丝依次跳起来（包括端点）。\n\n这样幽香就能看到一个长度为 $A$ 到 $B$ 之间路径上的所有粉丝的数目（包括 $A$ 和 $B$）的颜色序列。\n\n一开始大家打算让任意两个粉丝（注意：$A,B$ 和 $B,A$ 是不同的，他们形成的序列刚好相反）都来一次。\n\n但是有人指出这样可能会出现一些一模一样的颜色序列，会导致审美疲劳。\n\n于是他们想问，在这个树上，一共有多少可能的不同的颜色序列幽香可以看到呢？\n\n由于太阳花田的结构比较特殊，只与一个空地相邻的空地数量不超过 $20$ 个。", "inputFormat": "第一行两个正整数 $n,c$，表示空地数量和颜色数量。\n\n第二行有 $n$ 个 $0$ 到 $c-1$ 之间，由空格隔开的整数，依次表示第 $i$ 块空地上的粉丝的衣服颜色。\n\n接下来 $n-1$ 行，每行两个正整数 $u,v$，表示有一条连接空地 $u$ 和空地 $v$ 的边。", "outputFormat": "一行，输出一个整数，表示答案。", "hint": "#### 数据规模与约定\n\n- 对于 $15\\%$ 的数据，$n\\le2\\times 10^3$。\n- 另有 $5\\%$ 的数据，所有空地都至多与两个空地相邻。\n- 另有 $5\\%$ 的数据，除一块空地与三个空地相邻外，其他空地都分别至多与两个空地相邻。\n- 另有 $5\\%$ 的数据，除某两块空地与三个空地相邻外，其他空地都分别至多与两个空地相邻。\n- 对于 $100\\%$ 的数据，$1\\le n\\le10^5$，$1\\le c\\le10$，$1 \\leq u, v \\leq n$。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2015] The Fantasy Land Favored by the Gods", "background": "", "description": "Yuuka is the most popular cute girl in all of Gensokyo. Today is her $2600$-th birthday, and countless fans have come to the sunflower field in front of her house to celebrate.\n\nThe fans are very enthusiastic and spontaneously organized a series of performances for Yuuka. Of course, Yuuka is very happy.\n\nAt this moment, Yuuka notices something interesting: the sunflower field has $n$ empty plots.\n\nIn the past, for convenience, Yuuka built $n-1$ edges among these $n$ plots to connect them.\n\nThat is, these $n$ plots form a tree.\n\nThere are $n$ fans who have come to the sunflower field.\n\nTo express their congratulations for Yuuka’s birthday, they chose $c$ colors of clothing, and each color is represented by an integer between $0$ and $c-1$.\n\nEach person stands on exactly one plot, and each plot has exactly one person.\n\nThus, the entire sunflower field becomes colorful. Yuuka sees this and feels very happy.\n\nOne of the planned performances is as follows: select two fans A and B (A and B can be the same), then the fans on the path from A’s plot to B’s plot jump in order (including the endpoints).\n\nIn this way, Yuuka can see a color sequence whose length is the number of fans on the path between A and B (including A and B).\n\nAt first, everyone planned to try all pairs of fans. Note: A, B and B, A are different; the sequences they form are exactly reversed.\n\nHowever, someone pointed out that this might lead to some identical color sequences, causing aesthetic fatigue.\n\nSo they want to ask: on this tree, how many different color sequences can Yuuka possibly see in total?\n\nDue to the special structure of the sunflower field, the number of plots that are adjacent to exactly one plot does not exceed $20$.", "inputFormat": "The first line contains two positive integers $n, c$, denoting the number of plots and the number of colors.\n\nThe second line contains $n$ integers between $0$ and $c-1$, separated by spaces, where the $i$-th integer is the clothing color of the fan on the $i$-th plot.\n\nThe next $n-1$ lines each contain two positive integers $u, v$, indicating that there is an edge connecting plot $u$ and plot $v$.", "outputFormat": "Output a single line with one integer, denoting the answer.", "hint": "Constraints\n\n- For $15\\%$ of the testdata, $n \\le 2 \\times 10^3$.\n- For another $5\\%$ of the testdata, every plot is adjacent to at most two plots.\n- For another $5\\%$ of the testdata, except for one plot that is adjacent to three plots, every other plot is adjacent to at most two plots.\n- For another $5\\%$ of the testdata, except for two plots that are adjacent to three plots, every other plot is adjacent to at most two plots.\n- For $100\\%$ of the testdata, $1 \\le n \\le 10^5$, $1 \\le c \\le 10$, $1 \\le u, v \\le n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2015] 诸神眷顾的幻想乡", "background": null, "description": "幽香是全幻想乡里最受人欢迎的萌妹子，这天，是幽香的 $2600$ 岁生日，无数幽香的粉丝到了幽香家门前的太阳花田上来为幽香庆祝生日。\n\n粉丝们非常热情，自发组织表演了一系列节目给幽香看。幽香当然也非常高兴啦。\n\n这时幽香发现了一件非常有趣的事情，太阳花田有 $n$ 块空地。\n\n在过去，幽香为了方便，在这 $n$ 块空地之间修建了 $n-1$ 条边将它们连通起来。\n\n也就是说，这 $n$ 块空地形成了一个树的结构。\n\n有 $n$ 个粉丝来到了太阳花田上。\n\n为了表达对幽香生日的祝贺，他们选择了 $c$ 种颜色的衣服，每种颜色恰好可以用一个 $0$ 到 $c-1$ 之间的整数来表示。\n\n并且每个人都站在一个空地上，每个空地上也只有一个人。\n\n这样，整个太阳花田就花花绿绿了。幽香看到了，感觉也非常开心。\n\n粉丝们策划的一个节目是这样的，选中两个粉丝 $A$ 和 $B$（$A$ 和 $B$ 可以相同），然后 $A$ 所在的空地到 $B$ 所在的空地的路径上的粉丝依次跳起来（包括端点）。\n\n这样幽香就能看到一个长度为 $A$ 到 $B$ 之间路径上的所有粉丝的数目（包括 $A$ 和 $B$）的颜色序列。\n\n一开始大家打算让任意两个粉丝（注意：$A,B$ 和 $B,A$ 是不同的，他们形成的序列刚好相反）都来一次。\n\n但是有人指出这样可能会出现一些一模一样的颜色序列，会导致审美疲劳。\n\n于是他们想问，在这个树上，一共有多少可能的不同的颜色序列幽香可以看到呢？\n\n由于太阳花田的结构比较特殊，只与一个空地相邻的空地数量不超过 $20$ 个。", "inputFormat": "第一行两个正整数 $n,c$，表示空地数量和颜色数量。\n\n第二行有 $n$ 个 $0$ 到 $c-1$ 之间，由空格隔开的整数，依次表示第 $i$ 块空地上的粉丝的衣服颜色。\n\n接下来 $n-1$ 行，每行两个正整数 $u,v$，表示有一条连接空地 $u$ 和空地 $v$ 的边。", "outputFormat": "一行，输出一个整数，表示答案。", "hint": "#### 数据规模与约定\n\n- 对于 $15\\%$ 的数据，$n\\le2\\times 10^3$。\n- 另有 $5\\%$ 的数据，所有空地都至多与两个空地相邻。\n- 另有 $5\\%$ 的数据，除一块空地与三个空地相邻外，其他空地都分别至多与两个空地相邻。\n- 另有 $5\\%$ 的数据，除某两块空地与三个空地相邻外，其他空地都分别至多与两个空地相邻。\n- 对于 $100\\%$ 的数据，$1\\le n\\le10^5$，$1\\le c\\le10$，$1 \\leq u, v \\leq n$。", "locale": "zh-CN"}}}
{"pid": "P3347", "type": "P", "difficulty": 7, "samples": [["10 10\n0 2 3\n2 3 2\n3 1 3\n1 2 1\n1 0 1\n1 1 0\n3 3 0\n1 2 2\n3 1 1\n3 1 0\n3 1 2 2 3 1 1 2 2 0\n0 0 0 0 0 0 0 1 0 0\n0 0 0 0 0 0 0 0 0 0\n0 0 0 0 1 0 0 0 0 0\n0 0 0 1 0 0 0 0 0 0\n1 0 0 0 1 0 0 0 0 0\n1 0 1 0 0 0 0 1 1 0\n0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0\n0 0 1 0 0 0 1 0 0 0\n0 0 0 0 0 1 0 0 1 0", "8\n42/1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "二分", "各省省选", "网络流", "浙江"], "title": "[ZJOI2015] 醉熏熏的幻想乡", "background": null, "description": "傲娇少女幽香是一个很萌很萌的妹子，这些天幻想乡的大家都不知道为何还是拼命喝酒。很快酒就供不应求了，为了满足大家的需求，幽香决定在森林里酿酒。\n\n经过调查，幽香发现森林里面有一些地方非常适合酿酒，有一些地方则非常适合存酒。幽香把这些适合酿酒的地方称为酿酒点，不妨认为有 $n$ 个酿酒点，从 $1$ 到 $n$ 标号。同时也有 $m$ 个适合存酒的地方，幽香将它们称为存酒点，从 $1$ 到 $m$ 标号。在一些酿酒点和存酒点之间存在通道，如果酿酒点 $i$ 到存酒点 $j$ 之间存在通道，那么 $i$ 生产的酒就可以被运输到 $j$。\n\n但是在一个地方酿酒是需要消耗幽香的魔力的，由于存在管理上的因素，在酿酒点 $i$，制造 $x$ 升的酒，需要花费 $a_i\\cdot x^2+b_i\\cdot x$ 的魔力，注意 $x$ 不一定是一个非负整数，也可以是一个非负实数，同时在这个点最多只能制造 $c_i$ 升的酒。每个存酒点 $j$ 有一个容量 $d_j$，表示这个存酒点最多能存多少升的酒。\n\n幽香打算存尽量多的酒，那么她需要在一些酿酒点生产一些酒并且通过通道将酒运送到存酒点。当然幽香想要节省自己的魔力，所以想让你帮忙算出在满足要求的情况下，最少花费的魔力是多少？", "inputFormat": "第一行两个正整数 $n$，$m$，表示酿酒点和存酒点的数量。接下来 $n$ 行，第 $i$ 行三个数 $a_i$，$b_i$，$c_i$，表示在酿酒点 $i$ 制造酒的花费系数和上限。接下来一行 $m$ 个整数，一次为每个存酒点的 $d_i$ 值。接下来 $n$ 行，每行 $m$ 个数，其中第 $i$ 行第 $j$ 个表示酿酒点 $i$ 到存酒点 $j$ 有没有通道（$1$ 表示有，$0$ 表示没有）。", "outputFormat": "输出第一行表示幽香最多能存多少升酒（注意这肯定是个整数，直接输出即可）。\n\n输出第二行表示最小花费魔力，注意这肯定是一个有理数，化简后按照 $a/b$ 的形式输出（$0$输出 $0/1$）", "hint": "对于 $30\\%$ 的数据：所有 $a_i=0$。\n\n对于另 $30\\%$ 的数据：最终答案的分母 $\\leq 1000$。\n\n对于 $100\\%$ 的数据：$1\\leq n\\leq100$，$1\\leq m\\leq100$。\n\n对于所有数据，$0\\leq a_i,b_i,c_i,d_i\\leq3$ 且都是整数。同时对于每个 $i$，$a_i+b_i>0$ 的通道的数量不超过 $1000$ 条。\n\n非常神奇的是，对于所有数据存在一个正整数 $X\\leq10^7$，使得存在一个最优解，使得所有路径上运送的酒的体积都是 $1/X$ 的倍数。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2015] Tipsy Gensokyo", "background": "", "description": "The tsundere girl Yuuka is a very cute girl. Recently, for some reason, everyone in Gensokyo has been drinking like crazy. Soon the supply of alcohol cannot keep up with demand. To meet everyone’s needs, Yuuka decides to brew alcohol in the forest.\n\nAfter investigation, Yuuka finds that some places in the forest are very suitable for brewing, while others are very suitable for storage. She calls the places suitable for brewing the brewing sites. Assume there are $n$ brewing sites, numbered from $1$ to $n$. There are also $m$ storage sites, numbered from $1$ to $m$. There are channels between some brewing sites and storage sites. If there is a channel between brewing site $i$ and storage site $j$, then the alcohol produced at $i$ can be transported to $j$.\n\nBrewing at a site consumes Yuuka’s magic. Due to management factors, at brewing site $i$, producing $x$ liters of alcohol costs $a_i \\cdot x^2 + b_i \\cdot x$ magic. Note that $x$ does not have to be a nonnegative integer; it can be any nonnegative real number. Also, at this site at most $c_i$ liters can be produced. Each storage site $j$ has a capacity $d_j$, meaning this storage site can store at most $d_j$ liters of alcohol.\n\nYuuka plans to store as much alcohol as possible, so she will produce some alcohol at certain brewing sites and transport it through the channels to the storage sites. Of course, Yuuka wants to save her magic, so please help her compute, under the requirement of storing the maximum possible amount, what the minimum magic cost is.", "inputFormat": "The first line contains two positive integers $n$, $m$, the numbers of brewing sites and storage sites. The next $n$ lines, on the $i$-th line are three numbers $a_i$, $b_i$, $c_i$, representing the cost coefficients and the production upper bound at brewing site $i$. The next line contains $m$ integers, which are the values $d_j$ for each storage site in order. Then there are $n$ lines, each containing $m$ numbers. On the $i$-th line, the $j$-th number indicates whether there is a channel from brewing site $i$ to storage site $j$ ($1$ means there is, $0$ means there is not).", "outputFormat": "Output the first line as the maximum total liters of alcohol Yuuka can store (note that this is always an integer; just output the integer).\n\nOutput the second line as the minimum magic cost. This is always a rational number; after reduction, output it in the form $a/b$ (if it is $0$, output $0/1$).", "hint": "- For $30\\%$ of the testdata: all $a_i = 0$.\n- For another $30\\%$ of the testdata: the denominator of the final answer is $\\leq 1000$.\n- For $100\\%$ of the testdata: $1 \\leq n \\leq 100$, $1 \\leq m \\leq 100$.\n- For all testdata, $0 \\leq a_i, b_i, c_i, d_i \\leq 3$ and all are integers. Also, for each $i$, the number of channels with $a_i + b_i > 0$ does not exceed $1000$.\n- Interestingly, for all testdata there exists a positive integer $X \\leq 10^7$ such that there is an optimal solution where the amount transported on every path is a multiple of $1/X$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2015] 醉熏熏的幻想乡", "background": null, "description": "傲娇少女幽香是一个很萌很萌的妹子，这些天幻想乡的大家都不知道为何还是拼命喝酒。很快酒就供不应求了，为了满足大家的需求，幽香决定在森林里酿酒。\n\n经过调查，幽香发现森林里面有一些地方非常适合酿酒，有一些地方则非常适合存酒。幽香把这些适合酿酒的地方称为酿酒点，不妨认为有 $n$ 个酿酒点，从 $1$ 到 $n$ 标号。同时也有 $m$ 个适合存酒的地方，幽香将它们称为存酒点，从 $1$ 到 $m$ 标号。在一些酿酒点和存酒点之间存在通道，如果酿酒点 $i$ 到存酒点 $j$ 之间存在通道，那么 $i$ 生产的酒就可以被运输到 $j$。\n\n但是在一个地方酿酒是需要消耗幽香的魔力的，由于存在管理上的因素，在酿酒点 $i$，制造 $x$ 升的酒，需要花费 $a_i\\cdot x^2+b_i\\cdot x$ 的魔力，注意 $x$ 不一定是一个非负整数，也可以是一个非负实数，同时在这个点最多只能制造 $c_i$ 升的酒。每个存酒点 $j$ 有一个容量 $d_j$，表示这个存酒点最多能存多少升的酒。\n\n幽香打算存尽量多的酒，那么她需要在一些酿酒点生产一些酒并且通过通道将酒运送到存酒点。当然幽香想要节省自己的魔力，所以想让你帮忙算出在满足要求的情况下，最少花费的魔力是多少？", "inputFormat": "第一行两个正整数 $n$，$m$，表示酿酒点和存酒点的数量。接下来 $n$ 行，第 $i$ 行三个数 $a_i$，$b_i$，$c_i$，表示在酿酒点 $i$ 制造酒的花费系数和上限。接下来一行 $m$ 个整数，一次为每个存酒点的 $d_i$ 值。接下来 $n$ 行，每行 $m$ 个数，其中第 $i$ 行第 $j$ 个表示酿酒点 $i$ 到存酒点 $j$ 有没有通道（$1$ 表示有，$0$ 表示没有）。", "outputFormat": "输出第一行表示幽香最多能存多少升酒（注意这肯定是个整数，直接输出即可）。\n\n输出第二行表示最小花费魔力，注意这肯定是一个有理数，化简后按照 $a/b$ 的形式输出（$0$输出 $0/1$）", "hint": "对于 $30\\%$ 的数据：所有 $a_i=0$。\n\n对于另 $30\\%$ 的数据：最终答案的分母 $\\leq 1000$。\n\n对于 $100\\%$ 的数据：$1\\leq n\\leq100$，$1\\leq m\\leq100$。\n\n对于所有数据，$0\\leq a_i,b_i,c_i,d_i\\leq3$ 且都是整数。同时对于每个 $i$，$a_i+b_i>0$ 的通道的数量不超过 $1000$ 条。\n\n非常神奇的是，对于所有数据存在一个正整数 $X\\leq10^7$，使得存在一个最优解，使得所有路径上运送的酒的体积都是 $1/X$ 的倍数。", "locale": "zh-CN"}}}
{"pid": "P3348", "type": "P", "difficulty": 7, "samples": [["5 5\n0 1 5\n1 2 4 2\n0 1 4\n2 1 1 3\n2 2 1 3", "1\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2016", "各省省选", "浙江"], "title": "[ZJOI2016] 大森林", "background": "", "description": "小 Y 家里有一个大森林，里面有 $n$ 棵树，编号从 $1$ 到 $n$。一开始这些树都只是树苗，只有一个节点，标号为 $1$。这些树都有一个特殊的节点，我们称之为生长节点，这些节点有生长出子节点的能力。\n\n小 Y 掌握了一种魔法，能让第 $l$ 棵树到第 $r$ 棵树的生长节点长出一个子节点。同时她还能修改第 $l$ 棵树到第 $r$ 棵树的生长节点。她告诉了你她使用魔法的记录，你能不能管理她家的森林，并且回答她的询问呢？\n", "inputFormat": "第一行包含 $2$ 个正整数 $n,m$，共有 $n$ 棵树和 $m$ 个操作。\n\n接下来 $m$ 行，每行包含若干非负整数表示一个操作，操作格式为：\n\n`0 l r` 表示将第 $l$ 棵树到第 $r$ 棵树的生长节点下面长出一个子节点，子节点的标号为上一个 $0$ 号操作叶子标号加 $1$（例如，第一个 $0$ 号操作产生的子节点标号为 $2$）， $l$ 到 $r$ 之间的树长出的节点标号都相同。保证 $1\\leq l\\leq r\\leq n$ 。\n\n`1 l r x` 表示将第 $l$ 棵树到第 $r$ 棵树的生长节点改到标号为 $x$ 的节点。对于 $i$ ($l\\leq i\\leq r$) 这棵树，如果标号 $x$ 的点不在其中，那么这个操作对该树不产生影响。保证 $1\\leq l\\leq r\\leq n$，$x$ 不超过当前所有树中节点最大的标号。\n\n`2 x u v` 询问第 $x$ 棵树中节点 $u$ 到节点 $v$ 点的距离，也就是在第 $x$ 棵树中从节点 $u$ 和节点 $v$ 的最短路上边的数量。保证 $1\\leq x\\leq n$，这棵树中节点 $u$ 和节点 $v$ 存在。", "outputFormat": "输出包括若干行，按顺序对于每个小 Y 的询问输出答案。\n", "hint": "对于 $100\\%$ 的数据，$N\\leq 10^5,M\\leq 2\\times 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[ZJOI2016] The Great Forest", "background": "", "description": "Xiao Y has a great forest at home, containing $n$ trees numbered from $1$ to $n$. Initially, each tree is just a sapling with a single node labeled $1$. Each tree has a special node, called the growth node, which can grow a child node.\n\nXiao Y masters a kind of magic that can make the growth nodes of the $l$-th tree to the $r$-th tree each grow one child node. She can also modify the growth nodes of the $l$-th tree to the $r$-th tree. She told you the log of her magic operations. Can you manage her forest and answer her queries?", "inputFormat": "The first line contains $2$ positive integers $n, m$, meaning there are $n$ trees and $m$ operations.\n\nThen follow $m$ lines. Each line contains several non-negative integers describing one operation, in one of the following formats:\n\n`0 l r` Make each growth node of the $l$-th tree to the $r$-th tree grow one child. The label of the new child equals the label generated by the previous operation of type `0` plus $1$ (for example, the first operation of type `0` generates a child with label $2$). The trees from $l$ to $r$ all get a child with the same label. It is guaranteed that $1 \\leq l \\leq r \\leq n$.\n\n`1 l r x` Set the growth node of each tree from the $l$-th to the $r$-th to the node labeled $x$. For the $i$-th tree ($l \\leq i \\leq r$), if the node labeled $x$ is not in that tree, this operation has no effect on that tree. It is guaranteed that $1 \\leq l \\leq r \\leq n$, and $x$ does not exceed the current maximum label among all trees.\n\n`2 x u v` Query the distance between node $u$ and node $v$ in the $x$-th tree, i.e., the number of edges on the shortest path between $u$ and $v$ in the $x$-th tree. It is guaranteed that $1 \\leq x \\leq n$, and nodes $u$ and $v$ exist in this tree.", "outputFormat": "Output several lines. For each of Xiao Y’s queries, print the answer in order.", "hint": "For $100\\%$ of the testdata, $N \\leq 10^5, M \\leq 2 \\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[ZJOI2016] 大森林", "background": "", "description": "小 Y 家里有一个大森林，里面有 $n$ 棵树，编号从 $1$ 到 $n$。一开始这些树都只是树苗，只有一个节点，标号为 $1$。这些树都有一个特殊的节点，我们称之为生长节点，这些节点有生长出子节点的能力。\n\n小 Y 掌握了一种魔法，能让第 $l$ 棵树到第 $r$ 棵树的生长节点长出一个子节点。同时她还能修改第 $l$ 棵树到第 $r$ 棵树的生长节点。她告诉了你她使用魔法的记录，你能不能管理她家的森林，并且回答她的询问呢？\n", "inputFormat": "第一行包含 $2$ 个正整数 $n,m$，共有 $n$ 棵树和 $m$ 个操作。\n\n接下来 $m$ 行，每行包含若干非负整数表示一个操作，操作格式为：\n\n`0 l r` 表示将第 $l$ 棵树到第 $r$ 棵树的生长节点下面长出一个子节点，子节点的标号为上一个 $0$ 号操作叶子标号加 $1$（例如，第一个 $0$ 号操作产生的子节点标号为 $2$）， $l$ 到 $r$ 之间的树长出的节点标号都相同。保证 $1\\leq l\\leq r\\leq n$ 。\n\n`1 l r x` 表示将第 $l$ 棵树到第 $r$ 棵树的生长节点改到标号为 $x$ 的节点。对于 $i$ ($l\\leq i\\leq r$) 这棵树，如果标号 $x$ 的点不在其中，那么这个操作对该树不产生影响。保证 $1\\leq l\\leq r\\leq n$，$x$ 不超过当前所有树中节点最大的标号。\n\n`2 x u v` 询问第 $x$ 棵树中节点 $u$ 到节点 $v$ 点的距离，也就是在第 $x$ 棵树中从节点 $u$ 和节点 $v$ 的最短路上边的数量。保证 $1\\leq x\\leq n$，这棵树中节点 $u$ 和节点 $v$ 存在。", "outputFormat": "输出包括若干行，按顺序对于每个小 Y 的询问输出答案。\n", "hint": "对于 $100\\%$ 的数据，$N\\leq 10^5,M\\leq 2\\times 10^5$。", "locale": "zh-CN"}}}
