{"pid": "P12731", "type": "P", "difficulty": 7, "samples": [["1 4 2\n1 1 1\n1 3 1\n", "0\n"], ["5 6 12\n1 1 2\n1 2 2\n1 3 1\n1 5 2\n1 6 2\n3 1 1\n3 5 1\n4 1 2\n4 2 2\n4 5 2\n4 6 2\n5 3 1\n", "2\n"], ["6 6 14\n1 1 2\n1 2 2\n1 3 1\n1 5 2\n1 6 2\n3 1 1\n3 5 1\n4 1 1\n4 5 1\n5 1 2\n5 2 2\n5 5 2\n5 6 2\n6 3 1\n", "1\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": [], "title": "蒙德里安的噩梦", "background": "", "description": "小 Z 想用大小为 $1\\times2$ 的骨牌覆盖大小为 $n\\times m$ 的棋盘，要求棋盘上的每个位置都要被覆盖并且骨牌没有重叠。他认为两块骨牌的短边拼在一起是不好看的，所以他不允许这种情况出现。现在小 Z 已经把棋盘边缘的一圈骨牌放好了，请你求出用骨牌覆盖剩下的区域的方案数。答案可能很大，你只需要求出其对 $998244353$ 取模的结果。", "inputFormat": "第一行三个整数 $n,m,k$。其中 $k$ 表示小 Z 已经放置的骨牌数量。\n\n接下来 $k$ 行，每行三个整数 $x,y,t$。表示已经有一块被放置的骨牌左上角在棋盘的第 $x$ 行第 $y$ 列，如果 $t=1$ 则表示这块骨牌是横向放置的，如果 $t=2$ 则表示这块骨牌是纵向放置的。", "outputFormat": "输出一行一个整数即答案。", "hint": "### 样例解释\n\n在第一组样例中，小 Z 在棋盘上放置的骨牌如下图所示：\n\n![样例解释1.png](https://cdn.luogu.com.cn/upload/image_hosting/h6i4nzpq.png)\n\n放置的两块骨牌短边相接，是不合法的，所以方案数为 $0$。\n\n---\n\n在第二组样例中，小 Z 在棋盘上放置的骨牌如下图所示：\n\n![样例解释2-1.png](https://cdn.luogu.com.cn/upload/image_hosting/pu487u65.png)\n\n有以下两种合法的方案：\n\n![样例解释2-2.png](https://cdn.luogu.com.cn/upload/image_hosting/dswr4e5i.png)\n\n___\n\n在第三组样例中，小 Z 在棋盘上放置的骨牌如下图所示：\n\n![样例解释3-1.png](https://cdn.luogu.com.cn/upload/image_hosting/0hfaxys3.png)\n\n只有一种合法的方案：\n\n![样例解释3-2.png](https://cdn.luogu.com.cn/upload/image_hosting/3uyw9z4w.png)\n\n### 数据范围与约定\n\n**本题使用捆绑测试。**\n\n对于 $100\\%$ 的数据，保证 $1\\le n,m\\le5\\times10^5$，$\\frac{3}{2}(n+m-200)\\le k\\le2(n+m)$，已经放置的每块骨牌没有重叠且都在边缘上，边缘上的每个位置都被已经放置的骨牌覆盖。\n\n对于不同的子任务，作如下约定：\n\n**subtask1(5pts)**：$n\\le2$。\n\n**subtask2(10pts)**：$n,m\\le10$。\n\n**subtask3(20pts)**：$n,m\\le40$。\n\n**subtask4(15pts)**：$n,m\\le300$。\n\n**subtask5(20pts)**：$n,m\\le1500$。\n\n**subtask6(10pts)**：$k\\ge\\frac{3}{2}(n+m-3)$。\n\n**subtask7(20pts)**：无特殊限制。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "蒙德里安的噩梦", "background": "", "description": "小 Z 想用大小为 $1\\times2$ 的骨牌覆盖大小为 $n\\times m$ 的棋盘，要求棋盘上的每个位置都要被覆盖并且骨牌没有重叠。他认为两块骨牌的短边拼在一起是不好看的，所以他不允许这种情况出现。现在小 Z 已经把棋盘边缘的一圈骨牌放好了，请你求出用骨牌覆盖剩下的区域的方案数。答案可能很大，你只需要求出其对 $998244353$ 取模的结果。", "inputFormat": "第一行三个整数 $n,m,k$。其中 $k$ 表示小 Z 已经放置的骨牌数量。\n\n接下来 $k$ 行，每行三个整数 $x,y,t$。表示已经有一块被放置的骨牌左上角在棋盘的第 $x$ 行第 $y$ 列，如果 $t=1$ 则表示这块骨牌是横向放置的，如果 $t=2$ 则表示这块骨牌是纵向放置的。", "outputFormat": "输出一行一个整数即答案。", "hint": "### 样例解释\n\n在第一组样例中，小 Z 在棋盘上放置的骨牌如下图所示：\n\n![样例解释1.png](https://cdn.luogu.com.cn/upload/image_hosting/h6i4nzpq.png)\n\n放置的两块骨牌短边相接，是不合法的，所以方案数为 $0$。\n\n---\n\n在第二组样例中，小 Z 在棋盘上放置的骨牌如下图所示：\n\n![样例解释2-1.png](https://cdn.luogu.com.cn/upload/image_hosting/pu487u65.png)\n\n有以下两种合法的方案：\n\n![样例解释2-2.png](https://cdn.luogu.com.cn/upload/image_hosting/dswr4e5i.png)\n\n___\n\n在第三组样例中，小 Z 在棋盘上放置的骨牌如下图所示：\n\n![样例解释3-1.png](https://cdn.luogu.com.cn/upload/image_hosting/0hfaxys3.png)\n\n只有一种合法的方案：\n\n![样例解释3-2.png](https://cdn.luogu.com.cn/upload/image_hosting/3uyw9z4w.png)\n\n### 数据范围与约定\n\n**本题使用捆绑测试。**\n\n对于 $100\\%$ 的数据，保证 $1\\le n,m\\le5\\times10^5$，$\\frac{3}{2}(n+m-200)\\le k\\le2(n+m)$，已经放置的每块骨牌没有重叠且都在边缘上，边缘上的每个位置都被已经放置的骨牌覆盖。\n\n对于不同的子任务，作如下约定：\n\n**subtask1(5pts)**：$n\\le2$。\n\n**subtask2(10pts)**：$n,m\\le10$。\n\n**subtask3(20pts)**：$n,m\\le40$。\n\n**subtask4(15pts)**：$n,m\\le300$。\n\n**subtask5(20pts)**：$n,m\\le1500$。\n\n**subtask6(10pts)**：$k\\ge\\frac{3}{2}(n+m-3)$。\n\n**subtask7(20pts)**：无特殊限制。", "locale": "zh-CN"}}}
{"pid": "P12732", "type": "P", "difficulty": 1, "samples": [["3\n1 2 3\n3 1 2\n", "1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288]}, "tags": ["2025", "洛谷原创", "洛谷月赛"], "title": "外人", "background": "> 正因为实际体验过我才能这么说——义妹这种存在，只是单纯的外人。\\\n——浅村悠太", "description": "悠太和沙季有时会在学校遇到对方。由于班级不同，上课时也基本上在不同的地方，只会在课间换教室时见到。\n\n水星高中一天共有 $n-1$ 个课间，第 $i$ 个课间悠太会从第 $y_i$ 层走到第 $y_{i+1}$ 层，沙季会从第 $s_i$ 层走到第 $s_{i+1}$ 层。假设课间开始时刻为 $i$，结束时刻为 $i+1$，他们的行动可以看作以时间 $t$ 为横轴，以高度 $h$ 为纵轴的平面直角坐标系上点 $(i,y_i)$ 到 $(i+1,y_{i+1})$ 的线段与点 $(i,s_i)$ 到 $(i+1,s_{i+1})$ 的线段。\n\n如果他们同时间处于同一高度，也就是说如果上述两条线段有交点，那么两人就会互相见到。他们可以在两层之间的楼梯上见到，也可以在出发时或到达时见到。即交点坐标可以不是整数，也可以是线段的端点，具体地，如果悠太和沙季在同一层上课，即 $y_i=s_i$，则认为第 $i-1$ 个课间（若 $i\\ge2$）和第 $i$ 个课间（若 $i\\le n-1$）他们均会互相见到。\n\n他们想要知道今天一共会在几个课间互相见到。", "inputFormat": "第一行输入一个整数 $n$ 表示课程节数，课间数量为 $n-1$。\n\n第二行输入 $n$ 个整数表示 $y_1,\\dots,y_n$。\n\n第三行输入 $n$ 个整数表示 $s_1,\\dots,s_n$。", "outputFormat": "输出一行一个整数表示见面的课间数量。", "hint": "#### 样例解释\n\n第一个课间，悠太和沙季在第 $1,2$ 层之间的楼梯见面；\n\n第二个课间，两人没有见面。\n\n#### 数据范围与限制\n\n对于 $20\\%$ 的数据，满足 $y_i,s_i\\le2$。\n\n对于另外 $20\\%$ 的数据，满足所有 $y_i$ 均相等。\n\n对于另外 $20\\%$ 的数据，满足所有 $s_i$ 均相等。\n\n对于所有数据，满足 $2\\le n\\le10$，$1\\le y_i,s_i\\le10$。", "locale": "zh-CN", "translations": {"en": {"title": "Stranger", "background": "> I can confidently state the following because I have experienced this myself. A younger step-sister is nothing but a stranger.\\\n--Yuta Asamura", "description": "Yuta and Saki sometimes run into each other at school. Since they are in different classes, they are usually in different places during lessons and only see each other when changing classrooms at the breaks.\n\nAt Suisei High School, there are a total of $n-1$ breaks in a day. During the $i$-th break, Yuta moves from the $y_i$-th floor to the $y_{i+1}$-th floor, while Saki moves from the $s_i$-th floor to the $s_{i+1}$-th floor. Assuming the break starts at time $i$ and ends at time $i+1$, their movements can be represented as line segments on a Cartesian coordinate system with time $t$ on the horizontal axis and height $h$ on the vertical axis. Specifically, Yuta's path is the line segment from point $(i, y_i)$ to $(i+1, y_{i+1})$, and Saki's path is the line segment from point $(i, s_i)$ to $(i+1, s_{i+1})$.\n\nIf they are at the same height at the same time, meaning if the aforementioned two line segments intersect, then the two will see each other. They may see each other on the stairs between floors, or at the start or end of their journey. In other words, the coordinates of the intersection point does not have to be an integer, and the intersection point can be at the endpoints of the segments, that is, if Yuta and Saki are in the same floor for class, i.e., $y_i = s_i$, then it is considered that they will meet each other during both the $(i-1)$-th break (if $i \\ge 2$) and the $i$-th break (if $i \\le n-1$).\n\nThey want to know during how many breaks they will see each other in total today.", "inputFormat": "The first line contains an integer $n$ representing the number of class periods, with the number of breaks being $n-1$.\n\nThe second line is consisted of $n$ integers representing $y_1,\\dots,y_n$.\n\nThe third line is consisted of $n$ integers representing $s_1,\\dots,s_n$.", "outputFormat": "Output a single integer indicating the number of encounters.", "hint": "#### Sample Explanation\n\nDuring the first break, Yuta and Saki meet on the stairs between the $1$st and $2$nd floors.\n\nDuring the second break, the two do not meet.\n\n#### Constraints\n\nFor $20\\%$ of the testdata, $y_i,s_i\\leq2$.\n\nFor an additional $20\\%$ of the testdata, all $y_i$-s are the same.\n\nFor an additional $20\\%$ of the testdata, all $s_i$-s are the same.\n\nFor all of the testdata, $2\\leq n\\leq10$, $1\\leq y_i,s_i\\leq10$.", "locale": "en"}, "zh-CN": {"title": "外人", "background": "> 正因为实际体验过我才能这么说——义妹这种存在，只是单纯的外人。\\\n——浅村悠太", "description": "悠太和沙季有时会在学校遇到对方。由于班级不同，上课时也基本上在不同的地方，只会在课间换教室时见到。\n\n水星高中一天共有 $n-1$ 个课间，第 $i$ 个课间悠太会从第 $y_i$ 层走到第 $y_{i+1}$ 层，沙季会从第 $s_i$ 层走到第 $s_{i+1}$ 层。假设课间开始时刻为 $i$，结束时刻为 $i+1$，他们的行动可以看作以时间 $t$ 为横轴，以高度 $h$ 为纵轴的平面直角坐标系上点 $(i,y_i)$ 到 $(i+1,y_{i+1})$ 的线段与点 $(i,s_i)$ 到 $(i+1,s_{i+1})$ 的线段。\n\n如果他们同时间处于同一高度，也就是说如果上述两条线段有交点，那么两人就会互相见到。他们可以在两层之间的楼梯上见到，也可以在出发时或到达时见到。即交点坐标可以不是整数，也可以是线段的端点，具体地，如果悠太和沙季在同一层上课，即 $y_i=s_i$，则认为第 $i-1$ 个课间（若 $i\\ge2$）和第 $i$ 个课间（若 $i\\le n-1$）他们均会互相见到。\n\n他们想要知道今天一共会在几个课间互相见到。", "inputFormat": "第一行输入一个整数 $n$ 表示课程节数，课间数量为 $n-1$。\n\n第二行输入 $n$ 个整数表示 $y_1,\\dots,y_n$。\n\n第三行输入 $n$ 个整数表示 $s_1,\\dots,s_n$。", "outputFormat": "输出一行一个整数表示见面的课间数量。", "hint": "#### 样例解释\n\n第一个课间，悠太和沙季在第 $1,2$ 层之间的楼梯见面；\n\n第二个课间，两人没有见面。\n\n#### 数据范围与限制\n\n对于 $20\\%$ 的数据，满足 $y_i,s_i\\le2$。\n\n对于另外 $20\\%$ 的数据，满足所有 $y_i$ 均相等。\n\n对于另外 $20\\%$ 的数据，满足所有 $s_i$ 均相等。\n\n对于所有数据，满足 $2\\le n\\le10$，$1\\le y_i,s_i\\le10$。", "locale": "zh-CN"}}}
{"pid": "P12733", "type": "P", "difficulty": 3, "samples": [["3 2\n1 7 3\n10\n16\n", "2\n3\n"], ["10 3\n923 243 389 974 100 485 296 377 61 552\n2403\n5819\n0\n", "5\n6\n0\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["数学", "贪心", "二分", "2025", "洛谷原创", "排序", "前缀和", "洛谷月赛"], "title": "磨合", "background": "> 「能够像这样『磨合』，实在是帮了个大忙。」\\\n——绫濑沙季", "description": "悠太和沙季遇到了 $n$ 个问题，问题的难度分别为 $d_1,\\dots,d_n$。\n\n他们可以以任意顺序解决问题，对于准备解决的第 $i$ 个问题，每将难度减少 $1$，两人需要花费 $i$ 秒。将难度减少为 $0$ 时问题被解决，他们才可以继续解决下一个问题。\n\n如果他们正在解决第 $i$ 个问题（即难度尚未减少为 $0$），但剩余时间少于 $i$ 秒，他们就不能继续解决剩下的问题了，第 $i$ 个问题也没有解决。\n\n他们想要知道，如果共有 $t$ 秒，那么最多能解决多少个问题。由于他们可能面对很多种不同情况，所以会多次改变 $t$ 进行询问。", "inputFormat": "第一行输入两个整数 $n,q$ 表示问题总数和询问次数。\n\n第二行输入 $n$ 个整数，表示 $d_1,\\dots,d_n$。\n\n接下来 $q$ 行，每行输入一个整数表示询问的总时间 $t$。", "outputFormat": "对于每次询问输出一行一个整数表示最多能解决的问题数量。", "hint": "#### 样例 1 解释\n\n若 $t=10$，则第 $1$ 个解决难度为 $7$ 的问题，第 $2$ 个解决难度为 $1$ 的问题，花费的时间为 $1\\times7+2\\times1=9$ 秒。可以证明他们无法解决三个问题。\n\n若 $t=16$，则依次解决难度为 $7,3,1$ 的问题，花费的时间为 $1\\times7+2\\times3+3\\times1=16$ 秒。\n\n#### 数据范围与限制\n\n**本题采用捆绑测试，各 Subtask 的限制与分值如下。**\n\n| Subtask No. | $n\\le$ | $q\\le$ | $d_i\\le$ | $t\\le$ | 分值 | 依赖子任务 |\n| :-: | :-: | :-: | :-: | :-: | :-: | :-: |\n| $1$ | $10$ | $1$ | $10$ | $10^3$ | $13$ |  |\n| $2$ | $10^3$ | $1$ | $10^3$ | $10^9$ | $24$ | $1$ |\n| $3$ | $10^3$ | $10^6$ | $10^3$ | $10^9$ | $16$ | $1,2$ |\n| $4$ | $10^6$ | $1$ | $10^3$ | $10^{16}$ | $16$ | $1,2$ |\n| $5$ | $10^6$ | $10^6$ | $10^3$ | $10^{16}$ | $31$ | $1,2,3,4$ |\n\n对于所有数据，满足 $1\\le n,q\\le10^6$，$1\\le d_i\\le10^3$，$0\\le t\\le10^{16}$。", "locale": "zh-CN", "translations": {"en": {"title": "Adjust", "background": "> \"It really helps that we can 'adjust' so easily.\"\\\n--Saki Ayase", "description": "Yuta and Saki encountered $n$ problems, where the difficulty of the problems are $d_1,\\dots,d_n$.\n\nThey can solve the problems in any order. For the $i$-th problem they choose to solve, reducing the difficulty by $1$ will cost them $i$ seconds. Once the difficulty is reduced to $0$, the problem is considered solved, and they can move on to the next problem.\n\nIf they're solving the $i$-th problem (that is, the difficulty isn't reduced to $0$ yet) but the ramaining time is less than $i$ seconds, they cannot continue solving the remaining problems, and the $i$-th problem is also considered unsolved.\n\nThey want to know, if they have a total time of $t$ seconds, what is the maximum number of problems they can solve. Since they may face many different scenarios, they will repeatedly change the possible values of $t$ and ask this question.", "inputFormat": "The first line contains two integers, $n$ and $q$, representing the number of problems and the number of queries, respectively.\n\nThe second line is consisted of $n$ integers representing $d_1,\\dots,d_n$.\n\nThe following $q$ lines, each line contains an integer representing the total time $t$ for the query.", "outputFormat": "For each query, output a single integer on a line indicating the maximum number of problems that can be solved.", "hint": "#### Sample 1 Explanation\n\nIf $t=10$, they can solve the problem with a difficulty of $7$ first, then solve the problem with a difficulty of $1$, it will consume $1\\times7+2\\times1=9$ seconds. It can be proven that they cannot solve three problems.\n\nIf $t=16$,  then solving the problems with difficulty values of $7$, $3$, and $1$ in sequence would consume $1\\times7+2\\times3+3\\times1=16$ seconds.\n\n#### Constraints\n\n**This problem enables subtask scoring and subtask dependence, with the constraints and scores for each subtask as follows.**\n\n| Subtask No. | $n\\le$ | $q\\le$ | $d_i\\le$ | $t\\le$ | Score | Depends on Subtask |\n| :-: | :-: | :-: | :-: | :-: | :-: | :-: |\n| $1$ | $10$ | $1$ | $10$ | $10^3$ | $13$ |  |\n| $2$ | $10^3$ | $1$ | $10^3$ | $10^9$ | $24$ | $1$ |\n| $3$ | $10^3$ | $10^6$ | $10^3$ | $10^9$ | $16$ | $1,2$ |\n| $4$ | $10^6$ | $1$ | $10^3$ | $10^{16}$ | $16$ | $1,2$ |\n| $5$ | $10^6$ | $10^6$ | $10^3$ | $10^{16}$ | $31$ | $1,2,3,4$ |\n\nFor all of the testdata, $1\\le n,q\\le10^6$, $1\\le d_i\\le10^3$, $0\\le t\\le10^{16}$.", "locale": "en"}, "zh-CN": {"title": "磨合", "background": "> 「能够像这样『磨合』，实在是帮了个大忙。」\\\n——绫濑沙季", "description": "悠太和沙季遇到了 $n$ 个问题，问题的难度分别为 $d_1,\\dots,d_n$。\n\n他们可以以任意顺序解决问题，对于准备解决的第 $i$ 个问题，每将难度减少 $1$，两人需要花费 $i$ 秒。将难度减少为 $0$ 时问题被解决，他们才可以继续解决下一个问题。\n\n如果他们正在解决第 $i$ 个问题（即难度尚未减少为 $0$），但剩余时间少于 $i$ 秒，他们就不能继续解决剩下的问题了，第 $i$ 个问题也没有解决。\n\n他们想要知道，如果共有 $t$ 秒，那么最多能解决多少个问题。由于他们可能面对很多种不同情况，所以会多次改变 $t$ 进行询问。", "inputFormat": "第一行输入两个整数 $n,q$ 表示问题总数和询问次数。\n\n第二行输入 $n$ 个整数，表示 $d_1,\\dots,d_n$。\n\n接下来 $q$ 行，每行输入一个整数表示询问的总时间 $t$。", "outputFormat": "对于每次询问输出一行一个整数表示最多能解决的问题数量。", "hint": "#### 样例 1 解释\n\n若 $t=10$，则第 $1$ 个解决难度为 $7$ 的问题，第 $2$ 个解决难度为 $1$ 的问题，花费的时间为 $1\\times7+2\\times1=9$ 秒。可以证明他们无法解决三个问题。\n\n若 $t=16$，则依次解决难度为 $7,3,1$ 的问题，花费的时间为 $1\\times7+2\\times3+3\\times1=16$ 秒。\n\n#### 数据范围与限制\n\n**本题采用捆绑测试，各 Subtask 的限制与分值如下。**\n\n| Subtask No. | $n\\le$ | $q\\le$ | $d_i\\le$ | $t\\le$ | 分值 | 依赖子任务 |\n| :-: | :-: | :-: | :-: | :-: | :-: | :-: |\n| $1$ | $10$ | $1$ | $10$ | $10^3$ | $13$ |  |\n| $2$ | $10^3$ | $1$ | $10^3$ | $10^9$ | $24$ | $1$ |\n| $3$ | $10^3$ | $10^6$ | $10^3$ | $10^9$ | $16$ | $1,2$ |\n| $4$ | $10^6$ | $1$ | $10^3$ | $10^{16}$ | $16$ | $1,2$ |\n| $5$ | $10^6$ | $10^6$ | $10^3$ | $10^{16}$ | $31$ | $1,2,3,4$ |\n\n对于所有数据，满足 $1\\le n,q\\le10^6$，$1\\le d_i\\le10^3$，$0\\le t\\le10^{16}$。", "locale": "zh-CN"}}}
{"pid": "P12734", "type": "P", "difficulty": 5, "samples": [["2\n5 3 3\n0 1 1 0 3\n1 2 3 4 5\n0 1 1 0 2\n2 4 5\n5 3 2\n0 1 1 2 3\n1 2 3 4 5\n0 1 1 2 2\n2 4 5\n", "9\n8\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2025", "洛谷原创", "树形 DP", "洛谷月赛"], "title": "理解", "background": "**已添加此题大样例，请前往附件下载。其中 `sample2-4` 分别满足 Subtask 2-4 的特殊性质。**\n\n> 「浅村同学对于我……」\\\n「**理解得太深了。**」\\\n——绫濑沙季", "description": "沙季正在用悠太推荐的方法做现代文阅读练习。\n\n有 $n$ 个历史事件，编号为 $1$ 至 $n$，其中每个历史事件可能有一个编号比它更小的前置事件，也可能没有。形式化地，对于事件 $i$，用 $p_i$ 表示其前置事件的编号，满足 $p_i<i$，若 $p_i=0$ 则表示它没有前置事件。\n\n沙季有两种方式记起一个历史事件：回想和联想。如果她进行回想，那么她可以花费 $r_u$ 时间，直接记起任意一个历史事件 $u$；如果她进行联想，那么她可以选择任意一个已经记起来的事件 $u$，并花费 $t_v$ 时间记起一个满足 $p_v=u$ 的事件 $v$。\n\n但是她的脑容量有限，因此她最多只能同时记起 $k$ 个事件。她已经记起来的事件可以选择在任意时刻忘记，忘记事件不需要花费时间。为了防止记忆混乱，她不会再次记起任何曾经忘记过的事件。\n\n现在，她有 $m$ 道阅读题，解决其中的第 $i$ 道题需要她记起事件 $x_i$，她可以在记起事件 $x_i$ 的时候立刻解决第 $i$ 道题目，花费的时间忽略不计。她想要知道她至少需要花费多少时间才能解决所有题目。", "inputFormat": "第一行输入一个整数 $T$ 表示数据组数。\n\n对于每组数据，第一行输入三个整数 $n,m,k$ 表示历史事件数量，阅读题的数量和她最多能够同时记起的事件数量。\n\n第二行输入 $n$ 个整数，表示 $p_1,\\dots,p_n$。\n\n第三行输入 $n$ 个整数，表示 $r_1,\\dots,r_n$。\n\n第四行输入 $n$ 个整数，表示 $t_1,\\dots,t_n$。保证 $p_i=0$ 时有 $t_i=0$。\n\n第五行输入 $m$ 个整数，表示 $x_1,\\dots,x_m$。", "outputFormat": "对于每组数据，输出一行一个整数，表示为了解决所有问题至少需要花费的总时间。", "hint": "#### 样例解释\n\n对于第一组数据，历史事件之间的关系如下图：\n\n![pic](https://cdn.luogu.com.cn/upload/image_hosting/70kj9xfv.png)\n\n她可以进行以下的回忆过程：\n\n| 步骤 | 过程 | 用时 | 记起的事件集合 | 解决问题 |\n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | 回想起事件 $1$ | $1$ | $\\{1\\}$ |  |\n| $2$ | 联想起事件 $3$ | $1$ | $\\{1,3\\}$ |  |\n| $3$ | 联想起事件 $5$ | $2$ | $\\{1,3,5\\}$ | $3$ |\n| $4$ | 忘记事件 $3$ | $0$ | $\\{1,5\\}$ |  |\n| $5$ | 联想起事件 $2$ | $1$ | $\\{1,2,5\\}$ | $1$ |\n| $6$ | 忘记事件 $2$ | $0$ | $\\{1,5\\}$ |  |\n| $7$ | 回想起事件 $4$ | $4$ | $\\{1,4,5\\}$ | $2$ |\n\n总用时 $1+1+2+1+4=9$。\n\n#### 数据范围与限制\n\n**本题采用捆绑测试，各 Subtask 的限制与分值如下。**\n\n| Subtask No. | $n,m\\le$ | 特殊性质 | 分值 | 依赖子任务 |\n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | $10$ |  | $18$ |  |\n| $2$ | $10^5$ | A | $18$ |  |\n| $3$ | $10^5$ | B | $18$ |  |\n| $4$ | $10^5$ | C | $18$ |  |\n| $5$ | $10^5$ |  | $28$ | $1,2,3,4$ |\n\n特殊性质 A：保证 $p_i=0$ 或 $p_i=i-1$；\n\n特殊性质 B：保证 $p_i=\\lfloor\\frac i2\\rfloor$；\n\n特殊性质 C：保证 $p_i\\le1$。\n\n对于所有数据，满足 $1\\le T\\le5$，$1\\le n,m\\le10^5$，$1\\le k\\le10$，$0\\le p_i<i$，$0\\le r_i,t_i\\le10^9$，$1\\le x_i\\le n$。", "locale": "zh-CN", "translations": {"en": {"title": "Understand", "background": "**We've provided some greater samples of this problem, you can download `samples.zip`. The files `sample2-4` satify the constraints of Subtasks 2-4.**\n\n> \"Asamura-kun, you...\"\\\n\"**--You understand me too well.**\"\\\n--Saki Ayase", "description": "Saki is practicing modern literature reading conprehension using the method recommended by Yuta.\n\nThere are $n$ historical events, numbered from $1$ to $n$, where each event may have a prerequisite event with a smaller number, or it may have none. Formally, for event $i$, let $p_i$ denote the number of its prerequisite event, satisfying $p_i < i$. If $p_i = 0$, it means the event has no prerequisite.\n\nSaki has two ways to recall a historical event: recollection and association. If she recollects, she can spend $r_u$ time to recall event $u$. If she associates, she can choose any event $u$ that she has already recalled and spend $t_v$ time to recall an event $v$ where $p_v = u$.\n\nHowever, her brain capacity is limited, so she can only recall up to $k$ events simultaneously. She can choose to forget any event she has already recalled at any moment, and forgetting an event does not take any time. To prevent memory confusion, she will not recall any events she has previously forgotten.\n\nNow, she has $m$ reading questions, and the $i$-th question requires her to recall event $x_i$. She can solve the $i$-th problem immediately upon recalling event $x_i$, and the time taken is negligible. She wants to know the minimum amount of time she needs to spend to solve all the questions.", "inputFormat": "The first line contains an integer $T$, denoting the number of test cases.\n\nFor each test case, the first line contains three integers, $n,m$ and $k$, representing the number of historical events, the number of reading questions, respectively and the number of events that she can recall at the same time.\n\nThe second line is consisted of $n$ integers representing $p_1,\\dots,p_n$.\n\nThe third line is consisted of $n$ integers representing $r_1,\\dots,r_n$.\n\nThe fourth line is consisted of $n$ integers representing $t_1,\\dots,t_n$. It is guaranteed that when $p_i=0$, $t_i=0$.\n\nThe fifth line is consisted of $m$ integers representing $x_1,\\dots,x_m$.", "outputFormat": "For each test case, output a single integer on a line indicating the minimum amount of time she needs to spend to solve all the questions.", "hint": "#### Sample Explanation\n\nFor the first test case, the relationships between historical events form the graph as below:\n\n![pic](https://cdn.luogu.com.cn/upload/image_hosting/70kj9xfv.png)\n\nShe can perform the following recollection process:\n\n| Step | Process | Time Taken | Set of Recalled Events | Question Solved |\n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | Recollects Event $1$ | $1$ | $\\{1\\}$ |  |\n| $2$ | Associates Event $3$ | $1$ | $\\{1,3\\}$ |  |\n| $3$ | Associates Event $5$ | $2$ | $\\{1,3,5\\}$ | $3$ |\n| $4$ | Forgets Event $3$ | $0$ | $\\{1,5\\}$ |  |\n| $5$ | Associates Event $2$ | $1$ | $\\{1,2,5\\}$ | $1$ |\n| $6$ | Forgets Event $2$ | $0$ | $\\{1,5\\}$ |  |\n| $7$ | Recollects Event $4$ | $4$ | $\\{1,4,5\\}$ | $2$ |\n\nTotal time taken: $1+1+2+1+4=9$.\n\n#### Constraints\n\n**This problem enables subtask scoring, with the constraints and scores for each subtask as follows.**\n\n| Subtask No. | $n,m\\le$ | Special Constraint | Score | Depends on Subtask |\n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | $10$ |  | $18$ |  |\n| $2$ | $10^5$ | A | $18$ |  |\n| $3$ | $10^5$ | B | $18$ |  |\n| $4$ | $10^5$ | C | $18$ |  |\n| $5$ | $10^5$ |  | $28$ | $1,2,3,4$ |\n\nSpecial constraint A: $p_i=0$ or $p_i=i-1$;\n\nSpecial constraint B: $p_i=\\lfloor\\frac i2\\rfloor$;\n\nSpecial constraint C: $p_i\\le1$.\n\nFor all of the testdata, $1\\le T\\le5$, $1\\le n,m\\le10^5$, $1\\le k\\le10$, $0\\le p_i<i$, $0\\le r_i,t_i\\le10^9$, $1\\le x_i\\le n$.", "locale": "en"}, "zh-CN": {"title": "理解", "background": "**已添加此题大样例，请前往附件下载。其中 `sample2-4` 分别满足 Subtask 2-4 的特殊性质。**\n\n> 「浅村同学对于我……」\\\n「**理解得太深了。**」\\\n——绫濑沙季", "description": "沙季正在用悠太推荐的方法做现代文阅读练习。\n\n有 $n$ 个历史事件，编号为 $1$ 至 $n$，其中每个历史事件可能有一个编号比它更小的前置事件，也可能没有。形式化地，对于事件 $i$，用 $p_i$ 表示其前置事件的编号，满足 $p_i<i$，若 $p_i=0$ 则表示它没有前置事件。\n\n沙季有两种方式记起一个历史事件：回想和联想。如果她进行回想，那么她可以花费 $r_u$ 时间，直接记起任意一个历史事件 $u$；如果她进行联想，那么她可以选择任意一个已经记起来的事件 $u$，并花费 $t_v$ 时间记起一个满足 $p_v=u$ 的事件 $v$。\n\n但是她的脑容量有限，因此她最多只能同时记起 $k$ 个事件。她已经记起来的事件可以选择在任意时刻忘记，忘记事件不需要花费时间。为了防止记忆混乱，她不会再次记起任何曾经忘记过的事件。\n\n现在，她有 $m$ 道阅读题，解决其中的第 $i$ 道题需要她记起事件 $x_i$，她可以在记起事件 $x_i$ 的时候立刻解决第 $i$ 道题目，花费的时间忽略不计。她想要知道她至少需要花费多少时间才能解决所有题目。", "inputFormat": "第一行输入一个整数 $T$ 表示数据组数。\n\n对于每组数据，第一行输入三个整数 $n,m,k$ 表示历史事件数量，阅读题的数量和她最多能够同时记起的事件数量。\n\n第二行输入 $n$ 个整数，表示 $p_1,\\dots,p_n$。\n\n第三行输入 $n$ 个整数，表示 $r_1,\\dots,r_n$。\n\n第四行输入 $n$ 个整数，表示 $t_1,\\dots,t_n$。保证 $p_i=0$ 时有 $t_i=0$。\n\n第五行输入 $m$ 个整数，表示 $x_1,\\dots,x_m$。", "outputFormat": "对于每组数据，输出一行一个整数，表示为了解决所有问题至少需要花费的总时间。", "hint": "#### 样例解释\n\n对于第一组数据，历史事件之间的关系如下图：\n\n![pic](https://cdn.luogu.com.cn/upload/image_hosting/70kj9xfv.png)\n\n她可以进行以下的回忆过程：\n\n| 步骤 | 过程 | 用时 | 记起的事件集合 | 解决问题 |\n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | 回想起事件 $1$ | $1$ | $\\{1\\}$ |  |\n| $2$ | 联想起事件 $3$ | $1$ | $\\{1,3\\}$ |  |\n| $3$ | 联想起事件 $5$ | $2$ | $\\{1,3,5\\}$ | $3$ |\n| $4$ | 忘记事件 $3$ | $0$ | $\\{1,5\\}$ |  |\n| $5$ | 联想起事件 $2$ | $1$ | $\\{1,2,5\\}$ | $1$ |\n| $6$ | 忘记事件 $2$ | $0$ | $\\{1,5\\}$ |  |\n| $7$ | 回想起事件 $4$ | $4$ | $\\{1,4,5\\}$ | $2$ |\n\n总用时 $1+1+2+1+4=9$。\n\n#### 数据范围与限制\n\n**本题采用捆绑测试，各 Subtask 的限制与分值如下。**\n\n| Subtask No. | $n,m\\le$ | 特殊性质 | 分值 | 依赖子任务 |\n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | $10$ |  | $18$ |  |\n| $2$ | $10^5$ | A | $18$ |  |\n| $3$ | $10^5$ | B | $18$ |  |\n| $4$ | $10^5$ | C | $18$ |  |\n| $5$ | $10^5$ |  | $28$ | $1,2,3,4$ |\n\n特殊性质 A：保证 $p_i=0$ 或 $p_i=i-1$；\n\n特殊性质 B：保证 $p_i=\\lfloor\\frac i2\\rfloor$；\n\n特殊性质 C：保证 $p_i\\le1$。\n\n对于所有数据，满足 $1\\le T\\le5$，$1\\le n,m\\le10^5$，$1\\le k\\le10$，$0\\le p_i<i$，$0\\le r_i,t_i\\le10^9$，$1\\le x_i\\le n$。", "locale": "zh-CN"}}}
{"pid": "P12735", "type": "P", "difficulty": 6, "samples": [["4 2 1\n", "3\n"], ["678 12 34\n", "951781526\n"], ["1987 654 321\n", "27905503\n"], ["1000000 13 20\n", "912829543\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2025", "洛谷原创", "组合数学", "容斥原理", "快速数论变换 NTT", "洛谷月赛"], "title": "回报", "background": "> 在我看来，得到太多的人明明是我，反倒是我该思考怎么回报才对。\\\n——浅村悠太", "description": "悠太需要帮沙季找到合适的学习用音乐。\n\n他找到了一个包含 $n$ 首音乐的专辑，其中的音乐编号为从 $1$ 至 $n$，播放每首音乐均需要 $1$ 分钟。沙季有 A 和 B 两门需要学的课程，每次学习 A 和 B 分别需要花 $a,b$ 分钟。为了更好地帮助她，悠太打算将音乐的播放顺序重新排列。具体地，他要选择一个长为 $n$ 的排列 $p_1,\\dots,p_n$，使得其中存在两个长度分别为 $a,b$ 的循环 $A,B$，且 $A$ 中的任意一个元素小于 $B$ 中的任意一个元素。\n\n排列中的一个长为 $k$ 的循环 $C$ 是一个由不同整数组成的序列 $c_1,\\dots,c_k$，满足 $1\\le c_1\\le n$，$c_{i+1}=p_{c_i},i=1,\\dots,k-1$，且 $p_{c_k}=c_1$。\n\n悠太想要求出有多少满足要求的排列 $p$。由于答案可能很大，你只需要告诉他答案对 $998244353$ 取模的结果。", "inputFormat": "输入一行三个整数表示序列长度 $n$ 与 $a,b$。", "outputFormat": "输出一行一个整数，表示满足要求的排列的数量取模 $998244353$ 的结果。", "hint": "#### 样例 1 解释\n\n满足要求的排列有 $(2,1,3,4),(3,2,1,4),(1,3,2,4)$，共 $3$ 个。\n\n#### 数据范围与限制\n\n**本题采用捆绑测试，各 Subtask 的限制与分值如下。**\n\n| Subtask No. | $n\\le$ | 特殊性质 | 分值 | 依赖子任务 |\n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | $10$ | 有 | $7$ |  |\n| $2$ | $700$ | 有 | $10$ | $1$ |\n| $3$ | $700$ | 无 | $20$ | $1,2$ |\n| $4$ | $2000$ | 有 | $10$ | $1,2$ |\n| $5$ | $2000$ | 无 | $30$ | $1,2,3,4$ |\n| $6$ | $10^6$ | 有 | $20$ | $1,2,4$ |\n| $7$ | $10^6$ | 无 | $3$ | $1,2,3,4,5,6$ |\n\n特殊性质：$\\min(a,b)=1$。\n\n对于所有数据，$1\\le n\\le10^6$，$1\\le a,b<a+b\\le n$。", "locale": "zh-CN", "translations": {"en": {"title": "Repay", "background": "> From my point of view, I would have to come up with even more to really repay her for everything she's done.\\\n--Yuta Asamura", "description": "Yuta needs to help Saki find suitable study music.\n\nHe has found an album containing $n$ songs, numbered from $1$ to $n$. Playing each song takes exactly $1$ minute. Saki has two courses, A and B, that she needs to study, and each time she study for A and B takes $a$ and $b$ minutes, respectively. To better assist her, Yuta plans to rearrange the order in which the songs are played. Specifically, he wants to choose a permutation $p_1, \\dots, p_n$ of length $n$ such that there exist two cycles $A$ and $B$ of lengths $a$ and $b$, respectively, and every element in $A$ is less than every element in $B$.\n\nIn a permutation, a cycle $C$ of length $k$ is a sequence $c_1, \\dots, c_k$ composed of different integers, where $1 \\leq c_1 \\leq n$, $c_{i+1} = p_{c_i}$ for $i = 1, \\dots, k-1$, and $p_{c_k} = c_1$.\n\nYuta wants to determine how many such permutations $p$ exist. Since the answer could be very large, you only need to provide the result modulo $998244353$.", "inputFormat": "Input a single line containing three integers representing the sequence length $n$ and $a, b$.", "outputFormat": "Output a single integer on a line, indicating the number of permutations that satisfy the requirements, modulo $998244353$.", "hint": "#### Sample 1 Explanation\n\nThe permutations that satisfy the requirements are $(2,1,3,4)$, $(3,2,1,4)$, and $(1,3,2,4)$, totaling $3$ permutations.\n\n#### Constraints\n\n**This problem enables subtask scoring and subtask dependence, with the constraints and scores for each subtask as follows.**\n\n| Subtask No. | $n\\le$ | Special Constraint | Score | Depends on Subtask |\n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | $10$ | Yes | $7$ |  |\n| $2$ | $700$ | Yes | $10$ | $1$ |\n| $3$ | $700$ | No | $20$ | $1,2$ |\n| $4$ | $2000$ | Yes | $10$ | $1,2$ |\n| $5$ | $2000$ | No | $30$ | $1,2,3,4$ |\n| $6$ | $10^6$ | Yes | $20$ | $1,2,4$ |\n| $7$ | $10^6$ | No | $3$ | $1,2,3,4,5,6$ |\n\nSpecial constraint: $\\min(a,b)=1$.\n\nFor all of the testdata, $1\\le n\\le10^6$, $1\\le a,b<a+b\\le n$.", "locale": "en"}, "zh-CN": {"title": "回报", "background": "> 在我看来，得到太多的人明明是我，反倒是我该思考怎么回报才对。\\\n——浅村悠太", "description": "悠太需要帮沙季找到合适的学习用音乐。\n\n他找到了一个包含 $n$ 首音乐的专辑，其中的音乐编号为从 $1$ 至 $n$，播放每首音乐均需要 $1$ 分钟。沙季有 A 和 B 两门需要学的课程，每次学习 A 和 B 分别需要花 $a,b$ 分钟。为了更好地帮助她，悠太打算将音乐的播放顺序重新排列。具体地，他要选择一个长为 $n$ 的排列 $p_1,\\dots,p_n$，使得其中存在两个长度分别为 $a,b$ 的循环 $A,B$，且 $A$ 中的任意一个元素小于 $B$ 中的任意一个元素。\n\n排列中的一个长为 $k$ 的循环 $C$ 是一个由不同整数组成的序列 $c_1,\\dots,c_k$，满足 $1\\le c_1\\le n$，$c_{i+1}=p_{c_i},i=1,\\dots,k-1$，且 $p_{c_k}=c_1$。\n\n悠太想要求出有多少满足要求的排列 $p$。由于答案可能很大，你只需要告诉他答案对 $998244353$ 取模的结果。", "inputFormat": "输入一行三个整数表示序列长度 $n$ 与 $a,b$。", "outputFormat": "输出一行一个整数，表示满足要求的排列的数量取模 $998244353$ 的结果。", "hint": "#### 样例 1 解释\n\n满足要求的排列有 $(2,1,3,4),(3,2,1,4),(1,3,2,4)$，共 $3$ 个。\n\n#### 数据范围与限制\n\n**本题采用捆绑测试，各 Subtask 的限制与分值如下。**\n\n| Subtask No. | $n\\le$ | 特殊性质 | 分值 | 依赖子任务 |\n| :-: | :-: | :-: | :-: | :-: |\n| $1$ | $10$ | 有 | $7$ |  |\n| $2$ | $700$ | 有 | $10$ | $1$ |\n| $3$ | $700$ | 无 | $20$ | $1,2$ |\n| $4$ | $2000$ | 有 | $10$ | $1,2$ |\n| $5$ | $2000$ | 无 | $30$ | $1,2,3,4$ |\n| $6$ | $10^6$ | 有 | $20$ | $1,2,4$ |\n| $7$ | $10^6$ | 无 | $3$ | $1,2,3,4,5,6$ |\n\n特殊性质：$\\min(a,b)=1$。\n\n对于所有数据，$1\\le n\\le10^6$，$1\\le a,b<a+b\\le n$。", "locale": "zh-CN"}}}
{"pid": "P12736", "type": "P", "difficulty": 6, "samples": [["10 3\n1 6 3\n5 7 4\n3 8 1", "3"], ["4 2\n1 2 2\n2 3 2", "1"]], "limits": {"time": [4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500, 4500], "memory": [1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576, 1048576]}, "tags": ["2016", "倍增", "并查集", "POI（波兰）"], "title": "[POI 2016 R2] 圣诞灯链 Christmas chain", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5032)。", "description": "**题目译自 [XXIII Olimpiada Informatyczna — II etap](https://sio2.mimuw.edu.pl/c/oi23-2/dashboard/) [Świąteczny łańcuch](https://szkopul.edu.pl/problemset/problem/cSa80AKpjHR8FlWE4BCpLGT3/statement/)**\n\n每年圣诞节，Bajtazar 都会用五彩缤纷的灯链装点他的家。今年，他决定亲自挑选灯链的颜色，打造一串独一无二的装饰。他对灯链的美学有特定要求：某些灯链片段的颜色排列需与另一些片段完全相同。同时，他的妻子希望今年的灯链尽量丰富多彩，也就是说，灯链应包含尽可能多的不同颜色。请帮助 Bajtazar 计算，他需要购买多少种颜色的灯泡。", "inputFormat": "第一行包含两个整数 $n, m$ $(n \\geq 2, m \\geq 1)$，分别表示灯链中灯泡的数量和 Bajtazar 的美学要求数量。灯泡按顺序编号为 $1$ 至 $n$。\n\n接下来的 $m$ 行描述美学要求，每行包含三个整数 $a_i, b_i, l_i$ $(1 \\leq a_i, b_i, l_i; a_i \\neq b_i; a_i, b_i \\leq n - l_i + 1)$，表示灯链片段 $\\{a_i, \\ldots, a_i + l_i - 1\\}$ 和 $\\{b_i, \\ldots, b_i + l_i - 1\\}$ 应具有相同颜色。即，灯泡 $a_i$ 与 $b_i$ 颜色相同，$a_i + 1$ 与 $b_i + 1$ 颜色相同，依此类推，直至 $a_i + l_i - 1$ 与 $b_i + l_i - 1$。", "outputFormat": "输出一个正整数 $k$，表示满足所有美学要求时，灯链中可包含的最大不同颜色数。", "hint": "**样例 1 解释**\n\n设 $a, b, c$ 表示三种不同颜色的灯泡。一个满足 Bajtazar 及其妻子要求的灯链为 $\\texttt{abacbababa}$。\n\n**附加样例**\n\n1. $n=2000, m=2$，要求片段 $\\{1, \\ldots, 1000\\}$ 与 $\\{1001, \\ldots, 2000\\}$ 相同，$\\{1, \\ldots, 500\\}$ 与 $\\{501, \\ldots, 1000\\}$ 相同，最大颜色数为 $500$。\n2. $n=500000, m=499900$，第 $i$ 个要求为 $a_i=i, b_i=i+100, l_i=1$，最大颜色数为 $100$。\n3. $n=80000, m=79995$，第 $i$ 个要求为 $a_i=i, b_i=i+2, l_i=4$，最大颜色数为 $2$。\n4. $n=50000, m=25000$，第 $i$ 个要求为 $a_i=1, b_i=i+1, l_i=9$，灯链只能使用单一颜色。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $n, m \\leq 2000$         | $30$ |\n| $2$    | $n, m \\leq 500000$，所有 $l_i = 1$ | $20$ |\n| $3$    | $n, m \\leq 80000$        | $30$ |\n| $4$    | $n, m \\leq 500000$       | $20$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[POI 2016 R2] 圣诞灯链 Christmas chain", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5032)。", "description": "**题目译自 [XXIII Olimpiada Informatyczna — II etap](https://sio2.mimuw.edu.pl/c/oi23-2/dashboard/) [Świąteczny łańcuch](https://szkopul.edu.pl/problemset/problem/cSa80AKpjHR8FlWE4BCpLGT3/statement/)**\n\n每年圣诞节，Bajtazar 都会用五彩缤纷的灯链装点他的家。今年，他决定亲自挑选灯链的颜色，打造一串独一无二的装饰。他对灯链的美学有特定要求：某些灯链片段的颜色排列需与另一些片段完全相同。同时，他的妻子希望今年的灯链尽量丰富多彩，也就是说，灯链应包含尽可能多的不同颜色。请帮助 Bajtazar 计算，他需要购买多少种颜色的灯泡。", "inputFormat": "第一行包含两个整数 $n, m$ $(n \\geq 2, m \\geq 1)$，分别表示灯链中灯泡的数量和 Bajtazar 的美学要求数量。灯泡按顺序编号为 $1$ 至 $n$。\n\n接下来的 $m$ 行描述美学要求，每行包含三个整数 $a_i, b_i, l_i$ $(1 \\leq a_i, b_i, l_i; a_i \\neq b_i; a_i, b_i \\leq n - l_i + 1)$，表示灯链片段 $\\{a_i, \\ldots, a_i + l_i - 1\\}$ 和 $\\{b_i, \\ldots, b_i + l_i - 1\\}$ 应具有相同颜色。即，灯泡 $a_i$ 与 $b_i$ 颜色相同，$a_i + 1$ 与 $b_i + 1$ 颜色相同，依此类推，直至 $a_i + l_i - 1$ 与 $b_i + l_i - 1$。", "outputFormat": "输出一个正整数 $k$，表示满足所有美学要求时，灯链中可包含的最大不同颜色数。", "hint": "**样例 1 解释**\n\n设 $a, b, c$ 表示三种不同颜色的灯泡。一个满足 Bajtazar 及其妻子要求的灯链为 $\\texttt{abacbababa}$。\n\n**附加样例**\n\n1. $n=2000, m=2$，要求片段 $\\{1, \\ldots, 1000\\}$ 与 $\\{1001, \\ldots, 2000\\}$ 相同，$\\{1, \\ldots, 500\\}$ 与 $\\{501, \\ldots, 1000\\}$ 相同，最大颜色数为 $500$。\n2. $n=500000, m=499900$，第 $i$ 个要求为 $a_i=i, b_i=i+100, l_i=1$，最大颜色数为 $100$。\n3. $n=80000, m=79995$，第 $i$ 个要求为 $a_i=i, b_i=i+2, l_i=4$，最大颜色数为 $2$。\n4. $n=50000, m=25000$，第 $i$ 个要求为 $a_i=1, b_i=i+1, l_i=9$，灯链只能使用单一颜色。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $n, m \\leq 2000$         | $30$ |\n| $2$    | $n, m \\leq 500000$，所有 $l_i = 1$ | $20$ |\n| $3$    | $n, m \\leq 80000$        | $30$ |\n| $4$    | $n, m \\leq 500000$       | $20$ |", "locale": "zh-CN"}}}
{"pid": "P12737", "type": "P", "difficulty": 0, "samples": [["6 7\n1 2\n1 3\n2 4\n3 4\n4 5\n5 6\n6 5\n", "4\n1 4 5 6"]], "limits": {"time": [3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500, 3500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2016", "POI（波兰）"], "title": "[POI 2016 R2] 可变方向道路 Vari-directional Streets", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5033)。", "description": "**题目译自 [XXIII Olimpiada Informatyczna — II etap](https://sio2.mimuw.edu.pl/c/oi23-2/dashboard/) [Drogi zmiennokierunkowe](https://szkopul.edu.pl/problemset/problem/9TaxfuNdAv2FPpQ6PeB-vlti/statement/)**\n\nBajtazar 正考虑搬到巴厘城，计划在那里租一间公寓。巴厘城是一座充满魅力的城市，拥有诸多优点，但交通便利性却不在此列。城中有 $n$ 个路口，通过 $m$ 条略显杂乱的单行道连接。由于道路狭窄，出于实际需要，所有道路均为单向通行。然而，当地交通专家提出了一种巧妙的解决方案，无需拓宽道路即可实现双向通行：每天早晨，所有道路的通行方向都会切换。也就是说，在奇数日期，车辆按道路的原始方向行驶；而在偶数日期，所有道路方向反转。\n\nBajtazar 希望租住在一处交通便利的公寓，具体来说，他想选择一个路口，从那里出发，能在一天内（奇数日或偶数日）到达城内任意其他路口。他并不担心返程问题，因为他可以在次日返回。\n\n给定巴厘城的道路网络，请找出所有满足 Bajtazar 要求的路口。", "inputFormat": "第一行包含两个整数 $n, m$ $(n \\geq 2, m \\geq 1)$，分别表示巴厘城的路口数量和道路数量。路口编号为 $1$ 至 $n$。\n\n接下来的 $m$ 行，每行包含两个整数 $a_i, b_i$ $(1 \\leq a_i, b_i \\leq n, a_i \\neq b_i)$，表示存在一条单行道，在奇数日期从路口 $a_i$ 通向路口 $b_i$，在偶数日期从 $b_i$ 通向 $a_i$。每对有序对 $(a_i, b_i)$ 在输入中至多出现一次。", "outputFormat": "第一行输出一个整数 $k$，表示满足 Bajtazar 要求的路口数量。\n\n第二行输出 $k$ 个递增的整数，表示这些路口的编号，数字间用单个空格分隔。若 $k=0$，第二行应为空（可输出空行或省略）。", "hint": "**样例 1 解释**\n\n从路口 $1$ 出发，在奇数日期可到达所有其他路口。从路口 $5$ 和 $6$ 出发，在偶数日期可到达所有其他路口。从路口 $4$ 出发，在奇数日期可到达路口 $5$ 和 $6$，在偶数日期可到达路口 $1, 2, 3$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jeb2s74s.png)\n\n**附加样例**\n\n1. $n=10, m=9$，道路构成一条交替路径，每隔一条道路方向向左或向右，无路口满足要求。\n2. $n=100000, m=100000$，奇数日期从路口 $1$ 可直达所有其他路口，且从路口 $n$ 可直达路口 $1$，仅路口 $1$ 和 $n$ 满足要求。\n3. $n=500000, m=499999$，一条路径，所有路口均满足要求。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $n, m \\leq 5000$         | $28$ |\n| $2$    | $n \\leq 300000, m \\leq 1000000$，满足要求的路口在奇数日期可达所有其他路口 | $29$ |\n| $3$    | $n \\leq 500000, m \\leq 1000000$ | $43$ ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[POI 2016 R2] 可变方向道路 Vari-directional Streets", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5033)。", "description": "**题目译自 [XXIII Olimpiada Informatyczna — II etap](https://sio2.mimuw.edu.pl/c/oi23-2/dashboard/) [Drogi zmiennokierunkowe](https://szkopul.edu.pl/problemset/problem/9TaxfuNdAv2FPpQ6PeB-vlti/statement/)**\n\nBajtazar 正考虑搬到巴厘城，计划在那里租一间公寓。巴厘城是一座充满魅力的城市，拥有诸多优点，但交通便利性却不在此列。城中有 $n$ 个路口，通过 $m$ 条略显杂乱的单行道连接。由于道路狭窄，出于实际需要，所有道路均为单向通行。然而，当地交通专家提出了一种巧妙的解决方案，无需拓宽道路即可实现双向通行：每天早晨，所有道路的通行方向都会切换。也就是说，在奇数日期，车辆按道路的原始方向行驶；而在偶数日期，所有道路方向反转。\n\nBajtazar 希望租住在一处交通便利的公寓，具体来说，他想选择一个路口，从那里出发，能在一天内（奇数日或偶数日）到达城内任意其他路口。他并不担心返程问题，因为他可以在次日返回。\n\n给定巴厘城的道路网络，请找出所有满足 Bajtazar 要求的路口。", "inputFormat": "第一行包含两个整数 $n, m$ $(n \\geq 2, m \\geq 1)$，分别表示巴厘城的路口数量和道路数量。路口编号为 $1$ 至 $n$。\n\n接下来的 $m$ 行，每行包含两个整数 $a_i, b_i$ $(1 \\leq a_i, b_i \\leq n, a_i \\neq b_i)$，表示存在一条单行道，在奇数日期从路口 $a_i$ 通向路口 $b_i$，在偶数日期从 $b_i$ 通向 $a_i$。每对有序对 $(a_i, b_i)$ 在输入中至多出现一次。", "outputFormat": "第一行输出一个整数 $k$，表示满足 Bajtazar 要求的路口数量。\n\n第二行输出 $k$ 个递增的整数，表示这些路口的编号，数字间用单个空格分隔。若 $k=0$，第二行应为空（可输出空行或省略）。", "hint": "**样例 1 解释**\n\n从路口 $1$ 出发，在奇数日期可到达所有其他路口。从路口 $5$ 和 $6$ 出发，在偶数日期可到达所有其他路口。从路口 $4$ 出发，在奇数日期可到达路口 $5$ 和 $6$，在偶数日期可到达路口 $1, 2, 3$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jeb2s74s.png)\n\n**附加样例**\n\n1. $n=10, m=9$，道路构成一条交替路径，每隔一条道路方向向左或向右，无路口满足要求。\n2. $n=100000, m=100000$，奇数日期从路口 $1$ 可直达所有其他路口，且从路口 $n$ 可直达路口 $1$，仅路口 $1$ 和 $n$ 满足要求。\n3. $n=500000, m=499999$，一条路径，所有路口均满足要求。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $n, m \\leq 5000$         | $28$ |\n| $2$    | $n \\leq 300000, m \\leq 1000000$，满足要求的路口在奇数日期可达所有其他路口 | $29$ |\n| $3$    | $n \\leq 500000, m \\leq 1000000$ | $43$ ", "locale": "zh-CN"}}}
{"pid": "P12738", "type": "P", "difficulty": 4, "samples": [["7 9\n1 2 2 3 1 1 1\n2 4 2 3 1 2 4 1 1", "4"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768, 32768]}, "tags": ["2016", "POI（波兰）"], "title": "[POI 2016 R2] 口吃 Stutter", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5034)。", "description": "**题目译自 [XXIII Olimpiada Informatyczna — II etap](https://sio2.mimuw.edu.pl/c/oi23-2/dashboard/) [Zająknięcia](https://szkopul.edu.pl/problemset/problem/Orc2Z7ti1xLaUUQDT1a6RGR5/statement/)**\n\nBitek 最近患上了一种怪病：他说话严重口吃，而且只会说出数字。他的哥哥 Bajtek 却发现，Bitek 的口吃模式似乎有规律可循。Bajtek 怀疑弟弟在装病，借此逃学，偷偷在家玩电脑游戏。这让 Bajtek 无法专心学习编程，感到十分沮丧。于是，他决定揭穿弟弟的把戏，希望借此赢得充足的编程时间。\n\n让我们来正式描述 Bajtek 的猜想。假设有两个数字序列 $A$ 和 $B$，分别表示 Bitek 的两次发言：\n- 序列 $A$ 的子序列是通过从 $A$ 中删除任意元素后得到的序列。例如，$1,1,7,5$ 是 $1,3,1,7,6,6,5,5$ 的子序列。\n- 序列 $A$ 的“口吃序列”是一个子序列，由连续的成对相同元素组成。例如，$1,1,1,1,3,3$ 是 $1,2,1,2,1,2,1,3,3$ 的口吃序列。\n\n给定 Bitek 的两次发言序列 $A$ 和 $B$，请帮助 Bajtek 找出同时出现在两个序列中的最长口吃序列的长度。", "inputFormat": "第一行包含两个整数 $n, m$ $(n, m \\geq 2)$，分别表示序列 $A$ 和 $B$ 的长度。\n\n第二行包含 $n$ 个整数 $a_1, a_2, \\ldots, a_n$ $(1 \\leq a_i \\leq 10^9)$，表示序列 $A$ 的元素。\n\n第三行包含 $m$ 个整数 $b_1, b_2, \\ldots, b_m$ $(1 \\leq b_i \\leq 10^9)$，表示序列 $B$ 的元素。", "outputFormat": "输出一个非负整数，表示序列 $A$ 和 $B$ 的最长公共口吃序列的长度。若无公共口吃序列，输出 $0$。", "hint": "**样例 1 解释**\n\n最长公共口吃序列为 $2, 2, 1, 1$。\n\n**附加样例**\n\n1. $n=5, m=4$，所有数字均为 $42$。\n2. $n=9, m=13$，序列为 `OLIMPIADA` 和 `INFORMATYCZNA` 的 ASCII 编码。\n3. $n=15000, m=15000$，序列 $A$ 由成对递增数字组成（$1,1,2,2,3,3,\\ldots,7500,7500$），序列 $B$ 为 $A$ 的逆序。\n4. $n=10000, m=5000$，两序列由 $13$ 和 $37$ 的成对交替组成（$13,37,13,37,\\ldots$）。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $n, m \\leq 2000$         | $30$ |\n| $2$    | $n, m \\leq 15000$，每个数字在序列中至多出现两次 | $28$ |\n| $3$    | $n, m \\leq 15000$        | $42$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[POI 2016 R2] 口吃 Stutter", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5034)。", "description": "**题目译自 [XXIII Olimpiada Informatyczna — II etap](https://sio2.mimuw.edu.pl/c/oi23-2/dashboard/) [Zająknięcia](https://szkopul.edu.pl/problemset/problem/Orc2Z7ti1xLaUUQDT1a6RGR5/statement/)**\n\nBitek 最近患上了一种怪病：他说话严重口吃，而且只会说出数字。他的哥哥 Bajtek 却发现，Bitek 的口吃模式似乎有规律可循。Bajtek 怀疑弟弟在装病，借此逃学，偷偷在家玩电脑游戏。这让 Bajtek 无法专心学习编程，感到十分沮丧。于是，他决定揭穿弟弟的把戏，希望借此赢得充足的编程时间。\n\n让我们来正式描述 Bajtek 的猜想。假设有两个数字序列 $A$ 和 $B$，分别表示 Bitek 的两次发言：\n- 序列 $A$ 的子序列是通过从 $A$ 中删除任意元素后得到的序列。例如，$1,1,7,5$ 是 $1,3,1,7,6,6,5,5$ 的子序列。\n- 序列 $A$ 的“口吃序列”是一个子序列，由连续的成对相同元素组成。例如，$1,1,1,1,3,3$ 是 $1,2,1,2,1,2,1,3,3$ 的口吃序列。\n\n给定 Bitek 的两次发言序列 $A$ 和 $B$，请帮助 Bajtek 找出同时出现在两个序列中的最长口吃序列的长度。", "inputFormat": "第一行包含两个整数 $n, m$ $(n, m \\geq 2)$，分别表示序列 $A$ 和 $B$ 的长度。\n\n第二行包含 $n$ 个整数 $a_1, a_2, \\ldots, a_n$ $(1 \\leq a_i \\leq 10^9)$，表示序列 $A$ 的元素。\n\n第三行包含 $m$ 个整数 $b_1, b_2, \\ldots, b_m$ $(1 \\leq b_i \\leq 10^9)$，表示序列 $B$ 的元素。", "outputFormat": "输出一个非负整数，表示序列 $A$ 和 $B$ 的最长公共口吃序列的长度。若无公共口吃序列，输出 $0$。", "hint": "**样例 1 解释**\n\n最长公共口吃序列为 $2, 2, 1, 1$。\n\n**附加样例**\n\n1. $n=5, m=4$，所有数字均为 $42$。\n2. $n=9, m=13$，序列为 `OLIMPIADA` 和 `INFORMATYCZNA` 的 ASCII 编码。\n3. $n=15000, m=15000$，序列 $A$ 由成对递增数字组成（$1,1,2,2,3,3,\\ldots,7500,7500$），序列 $B$ 为 $A$ 的逆序。\n4. $n=10000, m=5000$，两序列由 $13$ 和 $37$ 的成对交替组成（$13,37,13,37,\\ldots$）。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $n, m \\leq 2000$         | $30$ |\n| $2$    | $n, m \\leq 15000$，每个数字在序列中至多出现两次 | $28$ |\n| $3$    | $n, m \\leq 15000$        | $42$ |", "locale": "zh-CN"}}}
{"pid": "P12739", "type": "P", "difficulty": 0, "samples": [["5 4 3\n2 3\n5 2\n3 3", "22"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2016", "POI（波兰）"], "title": "[POI 2016 R2] 快打砖块 Arkanoid", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5035)。", "description": "**题目译自 [XXIII Olimpiada Informatyczna — II etap](https://sio2.mimuw.edu.pl/c/oi23-2/dashboard/) [Arkanoid](https://szkopul.edu.pl/problemset/problem/O730xgZEVynTWBmscBinhMbD/statement/)**\n\nArkanoid 是一款经典的电脑游戏，玩家通过移动一块挡板，反弹在游戏区域内移动的小球，用以击碎区域中的砖块。目标是击碎所有砖块。熟悉这款游戏的玩家都知道，击碎最后几块砖块往往既耗时又令人抓狂。因此，编写一个程序，根据初始游戏区域布局，计算赢得游戏所需的时间，将大有裨益。为简化问题，我们假设玩家操作完美无瑕，总能用挡板中心精准反弹小球。\n\n游戏区域为长 $m$、高 $n$ 的矩形，其中 $m$ 为奇数，且 $m$ 与 $n$ 互质。区域上定义了一个直角坐标系：左下角为 $(0, 0)$，右上角为 $(m, n)$。为简化模型，假设小球尺寸可忽略，挡板厚度也可忽略。挡板沿直线 $y=0$ 水平移动，小球初始位于点 $\\left(\\frac{m}{2}, 0\\right)$，初始速度向量为 $\\left(-\\frac{1}{2}, \\frac{1}{2}\\right)$。\n\n当小球触碰到挡板、区域边界或任意砖块时，会发生完全弹性碰撞。此外，被触碰的砖块将被击碎并从区域中消失。请计算经过多少时间单位，所有砖块被击碎。", "inputFormat": "第一行包含三个整数 $m, n, k$ $(m, n, k \\geq 1, k \\leq n m - 1)$，分别表示游戏区域的宽度、高度和初始砖块数量。\n\n接下来的 $k$ 行描述砖块位置，第 $i$ 行包含两个整数 $x_i, y_i$ $(1 \\leq x_i \\leq m, 1 \\leq y_i \\leq n)$，表示存在一块砖块，其为对角顶点为 $(x_i - 1, y_i - 1)$ 和 $(x_i, y_i)$ 的矩形。保证位置 $(x_i = \\frac{m+1}{2}, y_i = 1)$ 处无砖块。", "outputFormat": "输出一行，包含一个整数，表示所有砖块被击碎所需的时间单位数。", "hint": "**样例 1 解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9i7mq4kl.png)\n\n**附加样例**\n\n1. $m=5, n=4, k=2$，答案较大。\n2. $m=11, n=10$，砖块构成不触碰区域边界的棋盘格布局。\n3. $m=99999, n=100000$，砖块位于 $\\left(\\frac{m-1}{2}, 2\\right), \\left(\\frac{m-5}{2}, 2\\right), \\left(\\frac{m-9}{2}, 2\\right), \\ldots$。\n4. $m=99999, n=100000$，仅一块砖块位于 $(1, 1)$，答案较大。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $m, n \\leq 100, k \\leq 1000$ | $25$ |\n| $2$    | $n, m \\leq 100000, k \\leq 50$ | $25$ |\n| $3$    | $m, n, k \\leq 100000$，砖块互不直接接触且不触碰区域边界 | $25$ |\n| $4$    | $m, n, k \\leq 100000$   | $25$ | ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[POI 2016 R2] 快打砖块 Arkanoid", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5035)。", "description": "**题目译自 [XXIII Olimpiada Informatyczna — II etap](https://sio2.mimuw.edu.pl/c/oi23-2/dashboard/) [Arkanoid](https://szkopul.edu.pl/problemset/problem/O730xgZEVynTWBmscBinhMbD/statement/)**\n\nArkanoid 是一款经典的电脑游戏，玩家通过移动一块挡板，反弹在游戏区域内移动的小球，用以击碎区域中的砖块。目标是击碎所有砖块。熟悉这款游戏的玩家都知道，击碎最后几块砖块往往既耗时又令人抓狂。因此，编写一个程序，根据初始游戏区域布局，计算赢得游戏所需的时间，将大有裨益。为简化问题，我们假设玩家操作完美无瑕，总能用挡板中心精准反弹小球。\n\n游戏区域为长 $m$、高 $n$ 的矩形，其中 $m$ 为奇数，且 $m$ 与 $n$ 互质。区域上定义了一个直角坐标系：左下角为 $(0, 0)$，右上角为 $(m, n)$。为简化模型，假设小球尺寸可忽略，挡板厚度也可忽略。挡板沿直线 $y=0$ 水平移动，小球初始位于点 $\\left(\\frac{m}{2}, 0\\right)$，初始速度向量为 $\\left(-\\frac{1}{2}, \\frac{1}{2}\\right)$。\n\n当小球触碰到挡板、区域边界或任意砖块时，会发生完全弹性碰撞。此外，被触碰的砖块将被击碎并从区域中消失。请计算经过多少时间单位，所有砖块被击碎。", "inputFormat": "第一行包含三个整数 $m, n, k$ $(m, n, k \\geq 1, k \\leq n m - 1)$，分别表示游戏区域的宽度、高度和初始砖块数量。\n\n接下来的 $k$ 行描述砖块位置，第 $i$ 行包含两个整数 $x_i, y_i$ $(1 \\leq x_i \\leq m, 1 \\leq y_i \\leq n)$，表示存在一块砖块，其为对角顶点为 $(x_i - 1, y_i - 1)$ 和 $(x_i, y_i)$ 的矩形。保证位置 $(x_i = \\frac{m+1}{2}, y_i = 1)$ 处无砖块。", "outputFormat": "输出一行，包含一个整数，表示所有砖块被击碎所需的时间单位数。", "hint": "**样例 1 解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/9i7mq4kl.png)\n\n**附加样例**\n\n1. $m=5, n=4, k=2$，答案较大。\n2. $m=11, n=10$，砖块构成不触碰区域边界的棋盘格布局。\n3. $m=99999, n=100000$，砖块位于 $\\left(\\frac{m-1}{2}, 2\\right), \\left(\\frac{m-5}{2}, 2\\right), \\left(\\frac{m-9}{2}, 2\\right), \\ldots$。\n4. $m=99999, n=100000$，仅一块砖块位于 $(1, 1)$，答案较大。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $m, n \\leq 100, k \\leq 1000$ | $25$ |\n| $2$    | $n, m \\leq 100000, k \\leq 50$ | $25$ |\n| $3$    | $m, n, k \\leq 100000$，砖块互不直接接触且不触碰区域边界 | $25$ |\n| $4$    | $m, n, k \\leq 100000$   | $25$ | ", "locale": "zh-CN"}}}
{"pid": "P12740", "type": "P", "difficulty": 6, "samples": [["2\n1 2", "7"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "博弈论", "2016", "POI（波兰）"], "title": "[POI 2016 R2] 不是 Nim 游戏 Not Nim", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5036)。", "description": "**题目译自 [XXIII Olimpiada Informatyczna — II etap](https://sio2.mimuw.edu.pl/c/oi23-2/dashboard/) [Wcale nie Nim](https://szkopul.edu.pl/problemset/problem/M5CruI5eCu8elnNFHuiXBrvV/statement/)**\n\nBajtoni 和他的弟弟 Bajtuś 经常玩 Nim 游戏。Bajtoni 曾向弟弟讲解过游戏的制胜策略，但 Bajtuś 总是难以掌握，常常输掉比赛。因此，他不断提出修改游戏规则的建议，希望让游戏变得更简单。\n\n最近，Bajtuś 提出了一个新玩法：游戏有 $n$ 对堆，每对中的两个堆初始各有 $a_i$ 个石头。两位玩家轮流行动。Bajtuś 在他的回合可以从任意一个堆中取走任意非零数量的石头。而 Bajtoni 在他的回合则从某对堆中选择一个堆，取走任意非零数量的石头，并将这些石头放入该对的另一个堆中。Bajtuś 率先行动。无法行动的玩家输掉游戏。\n\nBajtoni 很快发现，按照这样的规则，他几乎没有胜算。但为了不让弟弟失望，他同意试玩几局。然而，他暗自下定决心，要尽可能延长游戏时间，推迟不可避免的失败。请帮助 Bajtoni 编写程序，计算在双方都采取最优策略（Bajtuś 追求最快胜利，Bajtoni 追求最长游戏时间）的情况下，游戏最多能持续多少回合。", "inputFormat": "第一行包含一个正整数 $n$，表示堆对的数量。\n\n第二行包含 $n$ 个正整数 $a_1, a_2, \\ldots, a_n$，表示每对堆的初始石头数量。", "outputFormat": "输出一行，包含一个整数，表示在双方最优策略下，游戏结束前的总回合数。", "hint": "**样例 1 解释**\n\n最优游戏过程可能如下：\n\n$$\n1122 \\rightarrow 1120 \\rightarrow 1111 \\rightarrow 1110 \\rightarrow 1101 \\rightarrow 1100 \\rightarrow 2000 \\rightarrow 0000\n$$\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $n=1$                    | $10$ |\n| $2$    | $\\sum a_i \\leq 10$       | $10$ |\n| $3$    | $n \\leq 3$               | $20$ |\n| $4$    | $n \\leq 3000$            | $20$ |\n| $5$    | $n \\leq 500000$          | $40$ |\n\n对于所有子任务，$a_i \\leq 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[POI 2016 R2] 不是 Nim 游戏 Not Nim", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5036)。", "description": "**题目译自 [XXIII Olimpiada Informatyczna — II etap](https://sio2.mimuw.edu.pl/c/oi23-2/dashboard/) [Wcale nie Nim](https://szkopul.edu.pl/problemset/problem/M5CruI5eCu8elnNFHuiXBrvV/statement/)**\n\nBajtoni 和他的弟弟 Bajtuś 经常玩 Nim 游戏。Bajtoni 曾向弟弟讲解过游戏的制胜策略，但 Bajtuś 总是难以掌握，常常输掉比赛。因此，他不断提出修改游戏规则的建议，希望让游戏变得更简单。\n\n最近，Bajtuś 提出了一个新玩法：游戏有 $n$ 对堆，每对中的两个堆初始各有 $a_i$ 个石头。两位玩家轮流行动。Bajtuś 在他的回合可以从任意一个堆中取走任意非零数量的石头。而 Bajtoni 在他的回合则从某对堆中选择一个堆，取走任意非零数量的石头，并将这些石头放入该对的另一个堆中。Bajtuś 率先行动。无法行动的玩家输掉游戏。\n\nBajtoni 很快发现，按照这样的规则，他几乎没有胜算。但为了不让弟弟失望，他同意试玩几局。然而，他暗自下定决心，要尽可能延长游戏时间，推迟不可避免的失败。请帮助 Bajtoni 编写程序，计算在双方都采取最优策略（Bajtuś 追求最快胜利，Bajtoni 追求最长游戏时间）的情况下，游戏最多能持续多少回合。", "inputFormat": "第一行包含一个正整数 $n$，表示堆对的数量。\n\n第二行包含 $n$ 个正整数 $a_1, a_2, \\ldots, a_n$，表示每对堆的初始石头数量。", "outputFormat": "输出一行，包含一个整数，表示在双方最优策略下，游戏结束前的总回合数。", "hint": "**样例 1 解释**\n\n最优游戏过程可能如下：\n\n$$\n1122 \\rightarrow 1120 \\rightarrow 1111 \\rightarrow 1110 \\rightarrow 1101 \\rightarrow 1100 \\rightarrow 2000 \\rightarrow 0000\n$$\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $n=1$                    | $10$ |\n| $2$    | $\\sum a_i \\leq 10$       | $10$ |\n| $3$    | $n \\leq 3$               | $20$ |\n| $4$    | $n \\leq 3000$            | $20$ |\n| $5$    | $n \\leq 500000$          | $40$ |\n\n对于所有子任务，$a_i \\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P12741", "type": "P", "difficulty": 5, "samples": [["5 3 1\n2 3\n1 1 2 1 3\n1 2 3 1 1", "TAK"], ["3 3 1\n2 3\n1 2 3\n3 2 1", "NIE"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2016", "POI（波兰）"], "title": "[POI 2016 R3] 等价程序 Equivalent programs", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5037)。", "description": "**题目译自 [XXIII Olimpiada Informatyczna — III etap](https://sio2.mimuw.edu.pl/c/oi23-3/dashboard/) [Równoważne programy](https://szkopul.edu.pl/problemset/problem/SlqBmJqSmy7cVbTMEIVt3kyp/statement/)**\n\nByteasar 最近入手了一台新电脑，正热衷于学习编程。程序是由一系列指令组成的序列，指令共有 $k$ 种，为方便起见，编号为 $1$ 至 $k$。某些指令对具有交换性，即如果它们在程序中相邻（无论顺序），交换它们的位置会得到一个行为相同的等价程序。其余不具备此性质的指令对则称为**互斥**指令对。Byteasar 已经编写了两个包含 $n$ 个指令的程序，他很好奇这两个程序是否等价。请帮助他解答！", "inputFormat": "第一行包含三个整数 $n, k, m$，分别表示两个程序的指令数量、指令种类数和互斥指令对的数量。\n\n接下来的 $m$ 行描述互斥指令对，每行包含两个整数 $a_i, b_i$ $(1 \\leq a_i < b_i \\leq k)$，表示指令 $a_i$ 和 $b_i$ 构成互斥对。保证每对指令至多出现一次。\n\n最后两行描述两个程序，每行包含 $n$ 个整数 $c_1, c_2, \\ldots, c_n$ $(1 \\leq c_i \\leq k)$，表示程序中指令的编号序列指令的编号。", "outputFormat": "输出一行，包含一个单词：若输入的两个程序等价，输出 `TAK`；否则输出 `NIE`。", "hint": "**样例 1 解释**\n\n通过以下交换序列将第一个程序转换为第二个程序：$(2,3), (4,5), (3,4)$，其中 $(i, i+1)$ 表示交换当前序列中第 $i$ 和第 $i+1)$ 条指令。\n\n**附加样例**\n\n1. $n=50, k=50, m=1$，程序为 $(1,2, \\ldots, 49,50)$ 和 $(50,49, \\ldots, 2,1)$，答案为 `NIE`。\n2. $n=99999, k=3, m=1$，互斥指令为 $1$ 和 $2$，程序为 $(1,2,3,1,2,3, \\ldots)$ 和 $(3,1,2,3,1,2, \\ldots)$，答案为 `TAK`。\n3. $n=100000, k=1000, m=50000$，程序为 $(13,13, \\ldots,13)$ 和 $(37,37, \\ldots,37)$，答案为 `NIE`。\n\n所有测试数据满足 $1 \\leq n \\leq 100000, 1 \\leq k \\leq 1000, 0 \\leq m \\leq 50000$。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $n \\leq 5$               | $5$  |\n| $2$    | $k \\leq 2$               | $5$  |\n| $3$    | $n \\leq 1000$            | $25$ |\n| $4$    | 无附加限制               | $65$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[POI 2016 R3] 等价程序 Equivalent programs", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5037)。", "description": "**题目译自 [XXIII Olimpiada Informatyczna — III etap](https://sio2.mimuw.edu.pl/c/oi23-3/dashboard/) [Równoważne programy](https://szkopul.edu.pl/problemset/problem/SlqBmJqSmy7cVbTMEIVt3kyp/statement/)**\n\nByteasar 最近入手了一台新电脑，正热衷于学习编程。程序是由一系列指令组成的序列，指令共有 $k$ 种，为方便起见，编号为 $1$ 至 $k$。某些指令对具有交换性，即如果它们在程序中相邻（无论顺序），交换它们的位置会得到一个行为相同的等价程序。其余不具备此性质的指令对则称为**互斥**指令对。Byteasar 已经编写了两个包含 $n$ 个指令的程序，他很好奇这两个程序是否等价。请帮助他解答！", "inputFormat": "第一行包含三个整数 $n, k, m$，分别表示两个程序的指令数量、指令种类数和互斥指令对的数量。\n\n接下来的 $m$ 行描述互斥指令对，每行包含两个整数 $a_i, b_i$ $(1 \\leq a_i < b_i \\leq k)$，表示指令 $a_i$ 和 $b_i$ 构成互斥对。保证每对指令至多出现一次。\n\n最后两行描述两个程序，每行包含 $n$ 个整数 $c_1, c_2, \\ldots, c_n$ $(1 \\leq c_i \\leq k)$，表示程序中指令的编号序列指令的编号。", "outputFormat": "输出一行，包含一个单词：若输入的两个程序等价，输出 `TAK`；否则输出 `NIE`。", "hint": "**样例 1 解释**\n\n通过以下交换序列将第一个程序转换为第二个程序：$(2,3), (4,5), (3,4)$，其中 $(i, i+1)$ 表示交换当前序列中第 $i$ 和第 $i+1)$ 条指令。\n\n**附加样例**\n\n1. $n=50, k=50, m=1$，程序为 $(1,2, \\ldots, 49,50)$ 和 $(50,49, \\ldots, 2,1)$，答案为 `NIE`。\n2. $n=99999, k=3, m=1$，互斥指令为 $1$ 和 $2$，程序为 $(1,2,3,1,2,3, \\ldots)$ 和 $(3,1,2,3,1,2, \\ldots)$，答案为 `TAK`。\n3. $n=100000, k=1000, m=50000$，程序为 $(13,13, \\ldots,13)$ 和 $(37,37, \\ldots,37)$，答案为 `NIE`。\n\n所有测试数据满足 $1 \\leq n \\leq 100000, 1 \\leq k \\leq 1000, 0 \\leq m \\leq 50000$。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $n \\leq 5$               | $5$  |\n| $2$    | $k \\leq 2$               | $5$  |\n| $3$    | $n \\leq 1000$            | $25$ |\n| $4$    | 无附加限制               | $65$ |", "locale": "zh-CN"}}}
{"pid": "P12742", "type": "P", "difficulty": 6, "samples": [["5 7 10\n1 2\n2 3\n3 4\n4 5\n5 1\n2 4\n4 1\n2\n2 1 3\n5 3 6\n", "2\n1\n"]], "limits": {"time": [10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "2016", "POI（波兰）", "组合数学", "容斥原理"], "title": "[POI 2016 R3] 信使 Messenger", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5038)。", "description": "**题目译自 [XXIII Olimpiada Informatyczna — III etap](https://sio2.mimuw.edu.pl/c/oi23-3/dashboard/) [Posłaniec](https://szkopul.edu.pl/problemset/problem/Mk-9GNDtSal6h_8T4n9Ezq9M/statement/)**\n\n在统治拜托尼亚王国多年后，Byteasar 因疲惫不堪选择了退位。然而，很快他便怀念起宫廷的新闻、政策和阴谋。为了保持与王国的联系，他决定成为一名王室信使。\n\n上任第一天，Byteasar 便受命将一封紧急信件从一座城镇送往另一座。但他并未选择最快送达，而是决定借此机会游历全国，放松自己多年执政的疲惫。当然，他会小心行事，确保新国王不会察觉他行程的真正目的。\n\n拜托尼亚的所有道路均为单向，从一座城镇直达另一座。Byteasar 指定了他希望旅途中经过的道路段数，无论实际需要多少。为了不引起王室官员的怀疑，他要求起点和终点城镇各访问一次，而其他城镇可多次访问，同一道路也可重复经过。\n\n请帮助我们的英雄编写程序，计算满足他要求的路线数量，即从指定起点到终点、长度固定的不同路线数，其中起点和终点各访问一次。由于答案可能很大，只需返回其对 Byteasar 选择的除数取模的结果。", "inputFormat": "第一行包含三个整数 $n, m, z$ $(n \\geq 2, 0 \\leq m \\leq n(n-1), 2 \\leq z \\leq 1000000000)$，分别表示拜托尼亚的城镇数量、单向道路数量和 Byteasar 选择的除数。城镇编号为 $1$ 至 $n$。\n\n接下来的 $m$ 行，每行包含两个整数 $a, b$ $(1 \\leq a, b \\leq n, a \\neq b)$，表示存在一条从城镇 $a$ 到城镇 $b$ 的单向道路。每条道路在输入中至多出现一次。\n\n下一行包含一个正整数 $q$，表示 Byteasar 的查询数量。\n\n接下来的 $q$ 行，每行包含三个整数 $u_i, v_i, d_i$ $(1 \\leq u_i, v_i \\leq n, u_i \\neq v_i, 1 \\leq d_i \\leq 50)$，表示 Byteasar 希望从城镇 $u_i$ 旅行到城镇 $v_i$，恰好经过 $d_i$ 条道路。", "outputFormat": "输出 $q$ 行，第 $i$ 行包含一个整数，表示第 $i$ 个查询的路线数量对 $z$ 取模的结果。", "hint": "**样例 1 解释**\n\n第一个查询有两条满足条件的路线：$2 \\rightarrow 3 \\rightarrow 4 \\rightarrow 1$ 和 $2 \\rightarrow 4 \\rightarrow 5 \\rightarrow 1$；第二个查询仅有一条满足条件的路线：$5 \\rightarrow 1 \\rightarrow 2 \\rightarrow 4 \\rightarrow 1 \\rightarrow 2 \\rightarrow 3$。\n\n**附加样例**\n\n1. $n=6, q=10$，五个城镇两两之间均有双向道路，第六个城镇无任何道路连接。\n2. $n=20, q=100$，城镇呈环形排列，环上相邻城镇间均有双向道路。\n3. $n=100, q=500000$，拜托尼亚的地图呈三叉戟形状。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $n \\leq 20, q \\leq 100$  | $12$ |\n| $2$    | $n \\leq 100, m \\leq 500, q \\leq 100$ | $20$ |\n| $3$    | $n \\leq 100, q \\leq 10000$ | $38$ |\n| $4$    | $n \\leq 100, q \\leq 500000$ | $30$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[POI 2016 R3] 信使 Messenger", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5038)。", "description": "**题目译自 [XXIII Olimpiada Informatyczna — III etap](https://sio2.mimuw.edu.pl/c/oi23-3/dashboard/) [Posłaniec](https://szkopul.edu.pl/problemset/problem/Mk-9GNDtSal6h_8T4n9Ezq9M/statement/)**\n\n在统治拜托尼亚王国多年后，Byteasar 因疲惫不堪选择了退位。然而，很快他便怀念起宫廷的新闻、政策和阴谋。为了保持与王国的联系，他决定成为一名王室信使。\n\n上任第一天，Byteasar 便受命将一封紧急信件从一座城镇送往另一座。但他并未选择最快送达，而是决定借此机会游历全国，放松自己多年执政的疲惫。当然，他会小心行事，确保新国王不会察觉他行程的真正目的。\n\n拜托尼亚的所有道路均为单向，从一座城镇直达另一座。Byteasar 指定了他希望旅途中经过的道路段数，无论实际需要多少。为了不引起王室官员的怀疑，他要求起点和终点城镇各访问一次，而其他城镇可多次访问，同一道路也可重复经过。\n\n请帮助我们的英雄编写程序，计算满足他要求的路线数量，即从指定起点到终点、长度固定的不同路线数，其中起点和终点各访问一次。由于答案可能很大，只需返回其对 Byteasar 选择的除数取模的结果。", "inputFormat": "第一行包含三个整数 $n, m, z$ $(n \\geq 2, 0 \\leq m \\leq n(n-1), 2 \\leq z \\leq 1000000000)$，分别表示拜托尼亚的城镇数量、单向道路数量和 Byteasar 选择的除数。城镇编号为 $1$ 至 $n$。\n\n接下来的 $m$ 行，每行包含两个整数 $a, b$ $(1 \\leq a, b \\leq n, a \\neq b)$，表示存在一条从城镇 $a$ 到城镇 $b$ 的单向道路。每条道路在输入中至多出现一次。\n\n下一行包含一个正整数 $q$，表示 Byteasar 的查询数量。\n\n接下来的 $q$ 行，每行包含三个整数 $u_i, v_i, d_i$ $(1 \\leq u_i, v_i \\leq n, u_i \\neq v_i, 1 \\leq d_i \\leq 50)$，表示 Byteasar 希望从城镇 $u_i$ 旅行到城镇 $v_i$，恰好经过 $d_i$ 条道路。", "outputFormat": "输出 $q$ 行，第 $i$ 行包含一个整数，表示第 $i$ 个查询的路线数量对 $z$ 取模的结果。", "hint": "**样例 1 解释**\n\n第一个查询有两条满足条件的路线：$2 \\rightarrow 3 \\rightarrow 4 \\rightarrow 1$ 和 $2 \\rightarrow 4 \\rightarrow 5 \\rightarrow 1$；第二个查询仅有一条满足条件的路线：$5 \\rightarrow 1 \\rightarrow 2 \\rightarrow 4 \\rightarrow 1 \\rightarrow 2 \\rightarrow 3$。\n\n**附加样例**\n\n1. $n=6, q=10$，五个城镇两两之间均有双向道路，第六个城镇无任何道路连接。\n2. $n=20, q=100$，城镇呈环形排列，环上相邻城镇间均有双向道路。\n3. $n=100, q=500000$，拜托尼亚的地图呈三叉戟形状。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $n \\leq 20, q \\leq 100$  | $12$ |\n| $2$    | $n \\leq 100, m \\leq 500, q \\leq 100$ | $20$ |\n| $3$    | $n \\leq 100, q \\leq 10000$ | $38$ |\n| $4$    | $n \\leq 100, q \\leq 500000$ | $30$ |", "locale": "zh-CN"}}}
{"pid": "P12743", "type": "P", "difficulty": 0, "samples": [["3\n3 1 2", "6"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2016", "POI（波兰）"], "title": "[POI 2016 R3] 勤奋的约翰尼 Diligent Johny", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5039)。", "description": "**题目译自 [XXIII Olimpiada Informatyczna — III etap](https://sio2.mimuw.edu.pl/c/oi23-3/dashboard/) [Pracowity Jaś](https://szkopul.edu.pl/problemset/problem/_cVmDXXn2TjF0dF1rW6eazA0/statement/)**\n\n今天是小 Johny 的生日……但这是一道严肃的算法题，可怜的 Johny 没有收到玩具、游戏或电脑作为礼物。相反，他得到了一堆充满数字的长数组、树形结构、遍布隧道和立交桥的奇异地图，以及长达 1048576 个符号的 Fibonacci 和 Thue-Morse 序列前缀等教育礼物。在这些礼物中，他最喜欢的是一个包含 $1$ 到 $n$ 的正整数排列的数组。很快，Johny 开始思考这个排列的字典序前驱排列†是什么。聪明如他，很快解决了这个问题，并立即想到如何通过数组支持的唯一操作——交换任意两个单元的内容——将当前排列转换为其前驱。Johny 发现这个任务如此引人入胜，以至于他不断将每个排列转换为其字典序前驱。\n\n沉迷于排列变换的 Johny 完全忽略了生日派对的宾客。宾客们觉得这既有趣又有些失礼。很快，有人意识到 Johny 会在达到字典序最小的单位排列 $1,2,\\ldots,n$ 时停下来。问题在于，这需要多长时间？请帮助宾客们解答这个问题，假设每次交换耗时一秒。由于 Johny 极其勤奋，这个过程可能很长，宾客们只关心交换次数对 $10^9+7$ 取模的结果。他们可以每隔 $10^9+7$ 秒检查一次，看 Johny 是否终于完成了。\n\n$^\\dagger$对于排列 $P = (p_1, \\ldots, p_n)$ 和 $Q = (q_1, \\ldots, q_n)$，若在最小的满足 $p_j \\neq q_j$ 的索引 $j$ 处有 $p_j < q_j$，则称 $P$ 在字典序上小于 $Q$（记为 $P < Q$）。若 $P < Q$ 且不存在排列 $R$ 满足 $P < R < Q$，则称 $P$ 是 $Q$ 的字典序前驱。", "inputFormat": "第一行包含一个正整数 $n$，表示 Johny 收到的排列长度。\n\n第二行包含 $n$ 个互不相同的整数 $p_1, p_2, \\ldots, p_n$ $(1 \\leq p_i \\leq n)$，表示排列的元素。", "outputFormat": "输出一行，包含一个整数，表示 Johny 停止前进行的交换次数对 $10^9+7$ 取模的结果。", "hint": "**样例 1 解释**\n\nJohny 经历的字典序递减排列序列为 $(3,1,2), (2,3,1), (2,1,3), (1,3,2), (1,2,3)$。为此，他总共进行了 $2+1+2+1=6$ 次交换。\n\n**附加样例**\n\n1. $n=10$，排列为 $1,2,3,\\ldots,10$。\n2. $n=5$，一个随机 $5$ 元素的排列。\n3. $n=100$，排列为 $100,99,98,\\ldots,1$。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $n \\leq 10$              | $15$ |\n| $2$    | $n \\leq 5000$            | $37$ |\n| $3$    | $n \\leq 1000000$，排列为 $n, n-1, \\ldots, 1$ | $15$ |\n| $4$    | $n \\leq 1000000$         | $33$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[POI 2016 R3] 勤奋的约翰尼 Diligent Johny", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5039)。", "description": "**题目译自 [XXIII Olimpiada Informatyczna — III etap](https://sio2.mimuw.edu.pl/c/oi23-3/dashboard/) [Pracowity Jaś](https://szkopul.edu.pl/problemset/problem/_cVmDXXn2TjF0dF1rW6eazA0/statement/)**\n\n今天是小 Johny 的生日……但这是一道严肃的算法题，可怜的 Johny 没有收到玩具、游戏或电脑作为礼物。相反，他得到了一堆充满数字的长数组、树形结构、遍布隧道和立交桥的奇异地图，以及长达 1048576 个符号的 Fibonacci 和 Thue-Morse 序列前缀等教育礼物。在这些礼物中，他最喜欢的是一个包含 $1$ 到 $n$ 的正整数排列的数组。很快，Johny 开始思考这个排列的字典序前驱排列†是什么。聪明如他，很快解决了这个问题，并立即想到如何通过数组支持的唯一操作——交换任意两个单元的内容——将当前排列转换为其前驱。Johny 发现这个任务如此引人入胜，以至于他不断将每个排列转换为其字典序前驱。\n\n沉迷于排列变换的 Johny 完全忽略了生日派对的宾客。宾客们觉得这既有趣又有些失礼。很快，有人意识到 Johny 会在达到字典序最小的单位排列 $1,2,\\ldots,n$ 时停下来。问题在于，这需要多长时间？请帮助宾客们解答这个问题，假设每次交换耗时一秒。由于 Johny 极其勤奋，这个过程可能很长，宾客们只关心交换次数对 $10^9+7$ 取模的结果。他们可以每隔 $10^9+7$ 秒检查一次，看 Johny 是否终于完成了。\n\n$^\\dagger$对于排列 $P = (p_1, \\ldots, p_n)$ 和 $Q = (q_1, \\ldots, q_n)$，若在最小的满足 $p_j \\neq q_j$ 的索引 $j$ 处有 $p_j < q_j$，则称 $P$ 在字典序上小于 $Q$（记为 $P < Q$）。若 $P < Q$ 且不存在排列 $R$ 满足 $P < R < Q$，则称 $P$ 是 $Q$ 的字典序前驱。", "inputFormat": "第一行包含一个正整数 $n$，表示 Johny 收到的排列长度。\n\n第二行包含 $n$ 个互不相同的整数 $p_1, p_2, \\ldots, p_n$ $(1 \\leq p_i \\leq n)$，表示排列的元素。", "outputFormat": "输出一行，包含一个整数，表示 Johny 停止前进行的交换次数对 $10^9+7$ 取模的结果。", "hint": "**样例 1 解释**\n\nJohny 经历的字典序递减排列序列为 $(3,1,2), (2,3,1), (2,1,3), (1,3,2), (1,2,3)$。为此，他总共进行了 $2+1+2+1=6$ 次交换。\n\n**附加样例**\n\n1. $n=10$，排列为 $1,2,3,\\ldots,10$。\n2. $n=5$，一个随机 $5$ 元素的排列。\n3. $n=100$，排列为 $100,99,98,\\ldots,1$。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $n \\leq 10$              | $15$ |\n| $2$    | $n \\leq 5000$            | $37$ |\n| $3$    | $n \\leq 1000000$，排列为 $n, n-1, \\ldots, 1$ | $15$ |\n| $4$    | $n \\leq 1000000$         | $33$ |", "locale": "zh-CN"}}}
{"pid": "P12744", "type": "P", "difficulty": 0, "samples": [["4 5\nCCTT\nTTCT\nTCTT\nTTCT\nCCCTT\nTCCCT\nCTCTT", "12 10\nZ..Z\n..Z.\n.Z.Z\n..Z.\n.ZZ..\n.Z.Z.\nZ.Z.."]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2016", "POI（波兰）", "Special Judge"], "title": "[POI 2016 R3] 树篱 Hedge", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5040)。", "description": "**题目译自 [XXIII Olimpiada Informatyczna — III etap](https://sio2.mimuw.edu.pl/c/oi23-3/dashboard/) [Żywopłot](https://szkopul.edu.pl/problemset/problem/dABzva_j1-BvzKMsyxkuRoue/statement/)**\n\n王室园丁 Bajtazar 受命在王宫花园中打造一座树篱迷宫。花园可划分为 $m \\times n$ 个方格，周围环绕着一圈围墙，北墙和南墙的正中各有一入口。在每条分隔两个方格的边上，可以种植一段树篱——使用杜松或侧柏。国王更偏爱杜松，希望迷宫中尽可能多地使用杜松树篱。然而，杜松对土壤要求较高，无法在所有边上种植。\n\n要让树篱构成迷宫，必须满足一个额外条件：从任一入口出发，都能到达每个方格，且路径唯一（从一个方格可直接进入相邻方格，前提是分隔两者的边上没有树篱。两条路径若经过的方格集合不同，则视为不同路径）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/avlnk2y7.png)\n\n如上图所示，左侧展示了一个 $m=4, n=5$ 的示例花园，包含 $31$ 条边，其中 $13$ 条边可种植杜松树篱。\n\n右侧展示了一个示例迷宫，包含 $12$ 段树篱，其中 $10$ 段为杜松，$2$ 段为侧柏。这是杜松树篱数量最多的迷宫。你的任务是编写程序，帮助 Bajtazar 设计这样的迷宫。\n", "inputFormat": "第一行包含两个整数 $m, n$ $(2 \\leq m, n, n$ 为奇数$)$，表示花园的尺寸。\n\n接下来的 $m$ 行，每行包含 $n-1$ 个字符，描述垂直边（按行从左到右读取）。字符 `C` 表示该边可种植杜松树篱，`T` 表示可种植侧柏树篱。\n\n接下来的 $m-1$ 行，每行包含 $n$ 个字符，描述水平边（同样按行从左到右读取）。", "outputFormat": "第一行输出两个整数，分别表示构成迷宫的树篱段数和其中杜松树篱的最大数量。\n\n接下来的 $2m-1$ 行描述迷宫的边（按输入顺序）。若某边有树篱，输出 `Z`；否则输出 `.`。\n\n若存在多个满足国王要求的解，输出任意一个即可。", "hint": "**样例 1 解释**\n\n输入数据描述了图左侧的花园；输出结果描述了图右侧的迷宫。\n\n若程序仅正确输出第一行，而后续输出不正确，可获得该测试点 $52\\%$ 的分数。特别地，仅输出第一行也可获得 $52\\%$ 的分数。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $n \\cdot m \\leq 12$      | $25$ |\n| $2$    | $n, m \\leq 100$          | $25$ |\n| $3$    | $n, m \\leq 1000$         | $50$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[POI 2016 R3] 树篱 Hedge", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5040)。", "description": "**题目译自 [XXIII Olimpiada Informatyczna — III etap](https://sio2.mimuw.edu.pl/c/oi23-3/dashboard/) [Żywopłot](https://szkopul.edu.pl/problemset/problem/dABzva_j1-BvzKMsyxkuRoue/statement/)**\n\n王室园丁 Bajtazar 受命在王宫花园中打造一座树篱迷宫。花园可划分为 $m \\times n$ 个方格，周围环绕着一圈围墙，北墙和南墙的正中各有一入口。在每条分隔两个方格的边上，可以种植一段树篱——使用杜松或侧柏。国王更偏爱杜松，希望迷宫中尽可能多地使用杜松树篱。然而，杜松对土壤要求较高，无法在所有边上种植。\n\n要让树篱构成迷宫，必须满足一个额外条件：从任一入口出发，都能到达每个方格，且路径唯一（从一个方格可直接进入相邻方格，前提是分隔两者的边上没有树篱。两条路径若经过的方格集合不同，则视为不同路径）。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/avlnk2y7.png)\n\n如上图所示，左侧展示了一个 $m=4, n=5$ 的示例花园，包含 $31$ 条边，其中 $13$ 条边可种植杜松树篱。\n\n右侧展示了一个示例迷宫，包含 $12$ 段树篱，其中 $10$ 段为杜松，$2$ 段为侧柏。这是杜松树篱数量最多的迷宫。你的任务是编写程序，帮助 Bajtazar 设计这样的迷宫。\n", "inputFormat": "第一行包含两个整数 $m, n$ $(2 \\leq m, n, n$ 为奇数$)$，表示花园的尺寸。\n\n接下来的 $m$ 行，每行包含 $n-1$ 个字符，描述垂直边（按行从左到右读取）。字符 `C` 表示该边可种植杜松树篱，`T` 表示可种植侧柏树篱。\n\n接下来的 $m-1$ 行，每行包含 $n$ 个字符，描述水平边（同样按行从左到右读取）。", "outputFormat": "第一行输出两个整数，分别表示构成迷宫的树篱段数和其中杜松树篱的最大数量。\n\n接下来的 $2m-1$ 行描述迷宫的边（按输入顺序）。若某边有树篱，输出 `Z`；否则输出 `.`。\n\n若存在多个满足国王要求的解，输出任意一个即可。", "hint": "**样例 1 解释**\n\n输入数据描述了图左侧的花园；输出结果描述了图右侧的迷宫。\n\n若程序仅正确输出第一行，而后续输出不正确，可获得该测试点 $52\\%$ 的分数。特别地，仅输出第一行也可获得 $52\\%$ 的分数。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $n \\cdot m \\leq 12$      | $25$ |\n| $2$    | $n, m \\leq 100$          | $25$ |\n| $3$    | $n, m \\leq 1000$         | $50$ |", "locale": "zh-CN"}}}
{"pid": "P12745", "type": "P", "difficulty": 0, "samples": [["3\n0 5\n4 1\n3 6\n7 2\n", "0 5 7 2 6 3 1 4\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2016", "POI（波兰）", "Special Judge"], "title": "[POI 2016 R3] 俱乐部成员 Club members", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5041)。", "description": "**题目译自 [XXIII Olimpiada Informatyczna — III etap](https://sio2.mimuw.edu.pl/c/oi23-3/dashboard/) [Klubowicze](https://szkopul.edu.pl/problemset/problem/3Kqkgeapr-W-MBprNjUDGICL/statement/)**\n\n拜托尼亚讨论俱乐部堪称独一无二。俱乐部拥有 $2^n$ 名成员，每位成员都对 $n$ 个基本问题表达了观点。这些问题的具体表述并不重要，只需知道每个问题有两种回答选项。每位成员的观点可用一个二进制位串编码，转换为十进制后为 $0$ 至 $2^n-1$ 的整数。\n\n俱乐部中没有两位成员观点完全相同。若两位成员的观点仅在一个问题上不同，则称他们**几乎一致**。此外，俱乐部由 $2^{n-1}$ 名男士和 $2^{n-1}$ 名女士组成，配对形成 $2^{n-1}$ 对情侣。成员们围坐在圆桌上，需安排座位，使得每位成员旁坐着自己的伴侣，并且另一侧的邻座是与其**几乎一致**的人。", "inputFormat": "第一行包含一个整数 $n$，表示基本问题的数量。\n\n接下来的 $2^{n-1}$ 行描述成员情侣对，第 $i$ 行包含两个整数 $a_i, b_i$ $(0 \\leq a_i, b_i \\leq 2^n-1)$，表示观点为 $a_i$ 和 $b_i$ 的成员是一对情侣。每位成员的观点编号在输入中恰好出现一次。", "outputFormat": "若不存在满足条件的座位安排，输出一行一个字符串 `NIE`。\n\n若存在满足条件的座位安排，输出一行，包含 $2^n$ 个整数，表示圆桌上成员的正确座位顺序，数字间以单个空格分隔。\n\n若存在多个正确答案，输出任意一个即可。", "hint": "**附加样例**\n\n1. $n=4$，若 $i$ 为偶数，则编号 $i$ 和 $i+1$ 的成员为情侣。\n2. $n=10$，若 $i$ 为奇数，则编号 $i$ 和 $i+1$ 的成员为情侣，例外是编号 $2^n-1$ 与编号 $0$ 配对。\n3. $n=15$，随机样例，输入的情侣对按 $a_i$ 升序排列。\n\n测试数据分为 $18$ 组，每组 $5$ 或 $6$ 分。第 $k$ $(1\\leq k\\leq 18)$ 组仅包含 $n=k+1$ 的测试（即 $2 \\leq n \\leq 19$）。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[POI 2016 R3] 俱乐部成员 Club members", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5041)。", "description": "**题目译自 [XXIII Olimpiada Informatyczna — III etap](https://sio2.mimuw.edu.pl/c/oi23-3/dashboard/) [Klubowicze](https://szkopul.edu.pl/problemset/problem/3Kqkgeapr-W-MBprNjUDGICL/statement/)**\n\n拜托尼亚讨论俱乐部堪称独一无二。俱乐部拥有 $2^n$ 名成员，每位成员都对 $n$ 个基本问题表达了观点。这些问题的具体表述并不重要，只需知道每个问题有两种回答选项。每位成员的观点可用一个二进制位串编码，转换为十进制后为 $0$ 至 $2^n-1$ 的整数。\n\n俱乐部中没有两位成员观点完全相同。若两位成员的观点仅在一个问题上不同，则称他们**几乎一致**。此外，俱乐部由 $2^{n-1}$ 名男士和 $2^{n-1}$ 名女士组成，配对形成 $2^{n-1}$ 对情侣。成员们围坐在圆桌上，需安排座位，使得每位成员旁坐着自己的伴侣，并且另一侧的邻座是与其**几乎一致**的人。", "inputFormat": "第一行包含一个整数 $n$，表示基本问题的数量。\n\n接下来的 $2^{n-1}$ 行描述成员情侣对，第 $i$ 行包含两个整数 $a_i, b_i$ $(0 \\leq a_i, b_i \\leq 2^n-1)$，表示观点为 $a_i$ 和 $b_i$ 的成员是一对情侣。每位成员的观点编号在输入中恰好出现一次。", "outputFormat": "若不存在满足条件的座位安排，输出一行一个字符串 `NIE`。\n\n若存在满足条件的座位安排，输出一行，包含 $2^n$ 个整数，表示圆桌上成员的正确座位顺序，数字间以单个空格分隔。\n\n若存在多个正确答案，输出任意一个即可。", "hint": "**附加样例**\n\n1. $n=4$，若 $i$ 为偶数，则编号 $i$ 和 $i+1$ 的成员为情侣。\n2. $n=10$，若 $i$ 为奇数，则编号 $i$ 和 $i+1$ 的成员为情侣，例外是编号 $2^n-1$ 与编号 $0$ 配对。\n3. $n=15$，随机样例，输入的情侣对按 $a_i$ 升序排列。\n\n测试数据分为 $18$ 组，每组 $5$ 或 $6$ 分。第 $k$ $(1\\leq k\\leq 18)$ 组仅包含 $n=k+1$ 的测试（即 $2 \\leq n \\leq 19$）。", "locale": "zh-CN"}}}
{"pid": "P12746", "type": "P", "difficulty": 0, "samples": [["5 6\n1 2\n2 3\n3 1\n1 4\n4 5\n5 1", "TAK\n3 12"], ["12 14\n1 2\n2 4\n3 1\n4 3\n4 5\n5 6\n6 7\n7 8\n8 4\n7 9\n9 12\n12 11\n11 10\n10 6", "NIE"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2016", "POI（波兰）"], "title": "[POI 2016 R3] 非凡旅行 Amusing journeys", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5042)。", "description": "**题目译自 [XXIII Olimpiada Informatyczna — III etap](https://sio2.mimuw.edu.pl/c/oi23-3/dashboard/) [Niebanalne podróże](https://szkopul.edu.pl/problemset/problem/YY6-3ua-C1rt7q-97laWc0UP/statement/)**\n\nBajtazar 最近迷上了在拜托尼亚的旅行。拜托尼亚有 $n$ 座城市（为方便起见，编号为 $1$ 至 $n$），铁路系统提供 $m$ 条双向铁路连接部分城市对。借助这些铁路，Bajtazar 可到达每座城市（可能需要换乘）。\n\n他尤其钟情于一种**非凡旅行**：从某城市出发，最终返回起点，途中不重复访问任何城市，也不重复使用任何铁路。这种旅行他称之为**非凡**。\n\n在一次旅行中，Bajtazar 注意到，每次非凡旅行使用的铁路条数相同。他怀疑这是拜托尼亚铁路网络的普遍特性，请你帮助验证这一猜想。若猜想正确，他还想知道非凡旅行的数量。由于答案可能很大，他只需知道数量对 $10^9+7$ 取模的结果。\n\n旅行可用依次访问城市的编号序列描述。两条同等长度的旅行若存在某位置 $i$，其第 $i$ 个访问城市不同，则视为不同。旅行长度指使用的铁路条数。", "inputFormat": "第一行包含两个整数 $n, m$ $(n \\geq 1, m \\geq 0)$，分别表示拜托尼亚的城市数量和铁路连接数量。\n\n接下来的 $m$ 行描述铁路连接，第 $i$ 行包含两个整数 $a_i, b_i$ $(1 \\leq a_i, b_i \\leq n, a_i \\neq b_i)$，表示城市 $a_i$ 和 $b_i$ 间存在双向铁路。每对城市间至多有一条直接铁路。", "outputFormat": "若不存在任何非凡旅行，输出一行，包含字符串 `BRAK`。\n\n若存在非凡旅行，但长度不尽相同（即 Bajtazar 的猜想错误），输出一行一个字符串 `NIE`。\n\n若所有非凡旅行长度相同（即猜想正确），输出一行一个字符串 `TAK`；下一行输出两个整数，分别表示非凡旅行的长度和旅行数量对 $10^9+7$ 取模的结果。", "hint": "**样例 1 解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ayni2i0k.png)\n\n所有非凡旅行长度为 $3$，共 $12$ 条，依次为 $1-2-3-1, 1-3-2-1, 2-1-3-2, 2-3-1-2, 3-1-2-3, 3-2-1-3,$ $1-4-5-1, 1-5-4-1, 4-1-5-4, 4-5-1-4, 5-1-4-5, 5-4-1-5$。\n\n**样例 2 解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/q3rbo5po.png)\n\n**附加样例**\n\n1. $n=500000$，城市呈路径状，答案为 `BRAK`。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $n \\leq 18$              | $20$ |\n| $2$    | $n, m \\leq 2000$         | $40$ |\n| $3$    | $n \\leq 500000, m \\leq 1000000$ | $40$ ", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[POI 2016 R3] 非凡旅行 Amusing journeys", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5042)。", "description": "**题目译自 [XXIII Olimpiada Informatyczna — III etap](https://sio2.mimuw.edu.pl/c/oi23-3/dashboard/) [Niebanalne podróże](https://szkopul.edu.pl/problemset/problem/YY6-3ua-C1rt7q-97laWc0UP/statement/)**\n\nBajtazar 最近迷上了在拜托尼亚的旅行。拜托尼亚有 $n$ 座城市（为方便起见，编号为 $1$ 至 $n$），铁路系统提供 $m$ 条双向铁路连接部分城市对。借助这些铁路，Bajtazar 可到达每座城市（可能需要换乘）。\n\n他尤其钟情于一种**非凡旅行**：从某城市出发，最终返回起点，途中不重复访问任何城市，也不重复使用任何铁路。这种旅行他称之为**非凡**。\n\n在一次旅行中，Bajtazar 注意到，每次非凡旅行使用的铁路条数相同。他怀疑这是拜托尼亚铁路网络的普遍特性，请你帮助验证这一猜想。若猜想正确，他还想知道非凡旅行的数量。由于答案可能很大，他只需知道数量对 $10^9+7$ 取模的结果。\n\n旅行可用依次访问城市的编号序列描述。两条同等长度的旅行若存在某位置 $i$，其第 $i$ 个访问城市不同，则视为不同。旅行长度指使用的铁路条数。", "inputFormat": "第一行包含两个整数 $n, m$ $(n \\geq 1, m \\geq 0)$，分别表示拜托尼亚的城市数量和铁路连接数量。\n\n接下来的 $m$ 行描述铁路连接，第 $i$ 行包含两个整数 $a_i, b_i$ $(1 \\leq a_i, b_i \\leq n, a_i \\neq b_i)$，表示城市 $a_i$ 和 $b_i$ 间存在双向铁路。每对城市间至多有一条直接铁路。", "outputFormat": "若不存在任何非凡旅行，输出一行，包含字符串 `BRAK`。\n\n若存在非凡旅行，但长度不尽相同（即 Bajtazar 的猜想错误），输出一行一个字符串 `NIE`。\n\n若所有非凡旅行长度相同（即猜想正确），输出一行一个字符串 `TAK`；下一行输出两个整数，分别表示非凡旅行的长度和旅行数量对 $10^9+7$ 取模的结果。", "hint": "**样例 1 解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ayni2i0k.png)\n\n所有非凡旅行长度为 $3$，共 $12$ 条，依次为 $1-2-3-1, 1-3-2-1, 2-1-3-2, 2-3-1-2, 3-1-2-3, 3-2-1-3,$ $1-4-5-1, 1-5-4-1, 4-1-5-4, 4-5-1-4, 5-1-4-5, 5-4-1-5$。\n\n**样例 2 解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/q3rbo5po.png)\n\n**附加样例**\n\n1. $n=500000$，城市呈路径状，答案为 `BRAK`。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $n \\leq 18$              | $20$ |\n| $2$    | $n, m \\leq 2000$         | $40$ |\n| $3$    | $n \\leq 500000, m \\leq 1000000$ | $40$ ", "locale": "zh-CN"}}}
{"pid": "P12747", "type": "P", "difficulty": 4, "samples": [["8\n1 2\n2 3\n4 2\n5 2\n6 5\n5 7\n7 8\n", "5\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["动态规划 DP", "2016", "POI（波兰）", "树形 DP"], "title": "[POI 2016 R3] 巡游 Parade", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5043)。", "description": "**题目译自 [XXIII Olimpiada Informatyczna — III etap](https://sio2.mimuw.edu.pl/c/oi23-3/dashboard/) [Parada](https://szkopul.edu.pl/problemset/problem/1QaUWE_ePAmitZjgAszOVD1U/statement/)**\n\n每年春天，拜托城都会举办盛大的拜托尼亚春季巡游，迎接新季的到来。今年，国王 Bajtazar XVI 亲临现场，为巡游增添光彩。拜托城的路网由 $n$ 个路口通过 $n-1$ 条双向街道连接而成，确保从任一路口可到达其他任意路口。\n\n巡游的具体路线尚未确定，但已知它将从某路口出发，沿若干街道行进，最终在另一路口结束。为避免单调，巡游路线每条街道至多经过一次。\n\n为确保巡游参与者的安全，需在巡游经过的路口（包括起点和终点）处，对未被巡游使用的街道入口设置路障。请计算最多可能需要多少路障。", "inputFormat": "第一行包含一个整数 $n$ $(n \\geq 2)$，表示拜托城的路口数量。路口编号为 $1$ 至 $n$。\n\n接下来的 $n-1$ 行描述拜托城的路网，每行包含两个整数 $a, b$ $(1 \\leq a, b \\leq n, a \\neq b)$，表示路口 $a$ 和 $b$ 间存在一条双向街道。", "outputFormat": "输出一行，包含一个整数，表示保障巡游安全最多可能需要的路障数量。", "hint": "**样例 1 解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/nzhumxn8.png)\n\n若巡游从路口 $2$ 出发，至路口 $7$ 结束，需设置 $5$ 处路障（路口 $2$ 的 $3$ 个入口各一处，路口 $5$ 和 $7$ 各一处）。\n\n**附加样例**\n\n1. $n=20$，路网为路径。  \n2. $n=20$，路网为星形。  \n3. $n=1000$，随机样例，第 $i$ 条街道（$i=1, \\ldots, n-1$）连接路口 $i+1$ 与某编号更小的路口。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $n \\leq 20$              | $15$ |\n| $2$    | $n \\leq 300$             | $16$ |\n| $3$    | $n \\leq 3000$            | $22$ |\n| $4$    | $n \\leq 200000$          | $47$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[POI 2016 R3] 巡游 Parade", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5043)。", "description": "**题目译自 [XXIII Olimpiada Informatyczna — III etap](https://sio2.mimuw.edu.pl/c/oi23-3/dashboard/) [Parada](https://szkopul.edu.pl/problemset/problem/1QaUWE_ePAmitZjgAszOVD1U/statement/)**\n\n每年春天，拜托城都会举办盛大的拜托尼亚春季巡游，迎接新季的到来。今年，国王 Bajtazar XVI 亲临现场，为巡游增添光彩。拜托城的路网由 $n$ 个路口通过 $n-1$ 条双向街道连接而成，确保从任一路口可到达其他任意路口。\n\n巡游的具体路线尚未确定，但已知它将从某路口出发，沿若干街道行进，最终在另一路口结束。为避免单调，巡游路线每条街道至多经过一次。\n\n为确保巡游参与者的安全，需在巡游经过的路口（包括起点和终点）处，对未被巡游使用的街道入口设置路障。请计算最多可能需要多少路障。", "inputFormat": "第一行包含一个整数 $n$ $(n \\geq 2)$，表示拜托城的路口数量。路口编号为 $1$ 至 $n$。\n\n接下来的 $n-1$ 行描述拜托城的路网，每行包含两个整数 $a, b$ $(1 \\leq a, b \\leq n, a \\neq b)$，表示路口 $a$ 和 $b$ 间存在一条双向街道。", "outputFormat": "输出一行，包含一个整数，表示保障巡游安全最多可能需要的路障数量。", "hint": "**样例 1 解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/nzhumxn8.png)\n\n若巡游从路口 $2$ 出发，至路口 $7$ 结束，需设置 $5$ 处路障（路口 $2$ 的 $3$ 个入口各一处，路口 $5$ 和 $7$ 各一处）。\n\n**附加样例**\n\n1. $n=20$，路网为路径。  \n2. $n=20$，路网为星形。  \n3. $n=1000$，随机样例，第 $i$ 条街道（$i=1, \\ldots, n-1$）连接路口 $i+1$ 与某编号更小的路口。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $n \\leq 20$              | $15$ |\n| $2$    | $n \\leq 300$             | $16$ |\n| $3$    | $n \\leq 3000$            | $22$ |\n| $4$    | $n \\leq 200000$          | $47$ |", "locale": "zh-CN"}}}
{"pid": "P12748", "type": "P", "difficulty": 4, "samples": [["3\nN 2 3\nT 3\nN 2 1", "TAK\n2\n3\n1"], ["3\nN 2 1\nT 3\nN 2 1", "NIE\n2"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2017", "POI（波兰）", "图论建模"], "title": "[POI 2017 R2] 体育比赛 Sports competition", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5056)。", "description": "**题目译自 [XXIV Olimpiada Informatyczna — II etap](https://sio2.mimuw.edu.pl/c/oi24-2/dashboard/) [Zawody sportowe](https://szkopul.edu.pl/problemset/problem/fYzoFHo_2JRG4FQSt5UPRpn5/statement/)**\n\n在一次体育比赛中，来自 $n$ 个不同国家的 $n$ 名选手展开角逐。每位选手由本国的 $n$ 名记者之一进行报道，记者会说明自家选手的名次。然而，部分记者因情绪激动，未能准确记住选手的名次，只能提供选手可能的两个名次。\n\n请根据记者的报道，判断是否能唯一确定比赛的排名（不允许并列名次）。若可以，输出排名；否则，计算可能的排名数量。", "inputFormat": "第一行包含一个正整数 $n$，表示参赛国家的数量。\n\n接下来的 $n$ 行描述记者的报道，第 $i$ 行表示第 $i$ 国记者的报道：\n\n- 若记者确定选手名次，报道为字母 `T` 后跟一个整数 $a_i$ $(1 \\leq a_i \\leq n)$，表示第 $i$ 国选手的名次。  \n- 若记者不确定，报道为字母 `N` 后跟两个不同整数 $a_{i,1}, a_{i,2}$ $(1 \\leq a_{i,j} \\leq n)$，表示第 $i$ 国选手名次为 $a_{i,1}$ 或 $a_{i,2}$。", "outputFormat": "若记者报道能唯一确定比赛排名，输出第一行包含字符串 `TAK`，接下来的 $n$ 行每行一个整数，第 $i$ 行表示第 $i$ 国选手的名次。\n\n若报道矛盾或排名不唯一，输出第一行包含字符串 `NIE`，第二行输出可能排名的数量对 $1000000007$ 取模的结果。", "hint": "**附加样例**\n\n1. $n=5$，每位记者不确定，报道矛盾。\n2. $n=10$，每位记者不确定，有 $32$ 种可能排名。\n3. $n=1000000$，每位记者确定（$a_i=i$），答案为 `TAK`。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $n \\leq 10$              | $20$ |\n| $2$    | $n \\leq 2000$            | $30$ |\n| $3$    | $n \\leq 1000000$，排名唯一 | $20$ |\n| $4$    | $n \\leq 1000000$         | $30$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[POI 2017 R2] 体育比赛 Sports competition", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5056)。", "description": "**题目译自 [XXIV Olimpiada Informatyczna — II etap](https://sio2.mimuw.edu.pl/c/oi24-2/dashboard/) [Zawody sportowe](https://szkopul.edu.pl/problemset/problem/fYzoFHo_2JRG4FQSt5UPRpn5/statement/)**\n\n在一次体育比赛中，来自 $n$ 个不同国家的 $n$ 名选手展开角逐。每位选手由本国的 $n$ 名记者之一进行报道，记者会说明自家选手的名次。然而，部分记者因情绪激动，未能准确记住选手的名次，只能提供选手可能的两个名次。\n\n请根据记者的报道，判断是否能唯一确定比赛的排名（不允许并列名次）。若可以，输出排名；否则，计算可能的排名数量。", "inputFormat": "第一行包含一个正整数 $n$，表示参赛国家的数量。\n\n接下来的 $n$ 行描述记者的报道，第 $i$ 行表示第 $i$ 国记者的报道：\n\n- 若记者确定选手名次，报道为字母 `T` 后跟一个整数 $a_i$ $(1 \\leq a_i \\leq n)$，表示第 $i$ 国选手的名次。  \n- 若记者不确定，报道为字母 `N` 后跟两个不同整数 $a_{i,1}, a_{i,2}$ $(1 \\leq a_{i,j} \\leq n)$，表示第 $i$ 国选手名次为 $a_{i,1}$ 或 $a_{i,2}$。", "outputFormat": "若记者报道能唯一确定比赛排名，输出第一行包含字符串 `TAK`，接下来的 $n$ 行每行一个整数，第 $i$ 行表示第 $i$ 国选手的名次。\n\n若报道矛盾或排名不唯一，输出第一行包含字符串 `NIE`，第二行输出可能排名的数量对 $1000000007$ 取模的结果。", "hint": "**附加样例**\n\n1. $n=5$，每位记者不确定，报道矛盾。\n2. $n=10$，每位记者不确定，有 $32$ 种可能排名。\n3. $n=1000000$，每位记者确定（$a_i=i$），答案为 `TAK`。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $n \\leq 10$              | $20$ |\n| $2$    | $n \\leq 2000$            | $30$ |\n| $3$    | $n \\leq 1000000$，排名唯一 | $20$ |\n| $4$    | $n \\leq 1000000$         | $30$ |", "locale": "zh-CN"}}}
{"pid": "P12749", "type": "P", "difficulty": 4, "samples": [["7\n1 2\n2 3\n2 4\n4 5\n4 6\n6 7\n4\n2\n7\n4\n-2", "3\n3\n4\n3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2017", "POI（波兰）"], "title": "[POI 2017 R2] 罢工 Strikes", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5057)。", "description": "**题目译自 [XXIV Olimpiada Informatyczna — II etap](https://sio2.mimuw.edu.pl/c/oi24-2/dashboard/) [Strajki](https://szkopul.edu.pl/problemset/problem/lR_LabSUC2n7EMmDHpw-wk_b/statement/)**\n\n比特尼亚的居民以热情奔放和热爱民主著称，与崇尚君主制、平静安宁的拜托尼亚截然不同。当他们对政府决定（如增加字节位数）不满，或支持某理念（如内存与缓存平等）时，便会走上街头，发起罢工。\n\n比特尼亚有 $n$ 座城市。每座城市的居民独立决定是否发起或结束罢工。罢工期间，城市陷入瘫痪，无法进出。遗憾的是，国家的路网设计极简，任意两城市间仅有一条路径。这使得罢工成为非罢工城市居民的交通噩梦。罢工导致通信网络分裂为若干部分，只有同一部分的非罢工城市间可通达。\n\n作为比特尼亚的交通监察专员，你需编写程序，根据当前罢工信息，计算通信网络分裂成的部分数量。\n\n比特尼亚的所有道路均为双向，起点和终点均为城市。", "inputFormat": "第一行包含一个整数 $n$ $(n \\geq 2)$，表示比特尼亚的城市数量。城市编号为 $1$ 至 $n$。\n\n接下来的 $n-1$ 行描述道路，每行包含两个整数 $a, b$ $(1 \\leq a < b \\leq n)$，表示城市 $a$ 和 $b$ 间存在一条道路。任意两城市间存在一条由若干道路组成的路径。\n\n下一行包含一个整数 $m$ $(m \\geq 1)$，表示罢工信息的数量。\n\n接下来的 $m$ 行，每行包含一个整数 $z$ $(1 \\leq |z| \\leq n)$。若 $z > 0$，表示城市 $z$ 发起罢工；若 $z < 0$，表示城市 $-z$ 结束罢工。\n\n保证每座城市同时至多有一个罢工：若城市在罢工，不可再次发起；若未在罢工，不可结束。初始时无城市罢工。", "outputFormat": "输出 $m$ 行，第 $i$ $(1 \\leq i \\leq m)$ 行包含一个整数，表示第 $i$ 条罢工信息后，通信网络分裂成的部分数量。若所有城市均在罢工，输出 $0$。", "hint": "**样例 1 解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/u3sk77gn.png)\n\n图示为城市 $2$ 和 $7$ 发起罢工后的比特尼亚通信网络，网络分裂为三部分。\n\n**附加样例**\n\n1. $n=2, m=10$，两城市交替改变罢工状态。\n2. $n=1000, m=n$，路网为一条链，每城市依次发起罢工。  \n3. $n=500000$，路网为一条链，偶数编号城市依次发起罢工，随后按同顺序结束。\n\n路网为一条链，指对于 $a=1, \\ldots, n-1$，城市 $a$ 和 $a+1$ 相连。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $n, m \\leq 1000$         | $24$ |\n| $2$    | $n, m \\leq 500000$，路网为一条链 | $17$ |\n| $3$    | $n, m \\leq 500000$，输入全为正数 | $17$ |\n| $4$    | $n, m \\leq 500000$       | $42$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[POI 2017 R2] 罢工 Strikes", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5057)。", "description": "**题目译自 [XXIV Olimpiada Informatyczna — II etap](https://sio2.mimuw.edu.pl/c/oi24-2/dashboard/) [Strajki](https://szkopul.edu.pl/problemset/problem/lR_LabSUC2n7EMmDHpw-wk_b/statement/)**\n\n比特尼亚的居民以热情奔放和热爱民主著称，与崇尚君主制、平静安宁的拜托尼亚截然不同。当他们对政府决定（如增加字节位数）不满，或支持某理念（如内存与缓存平等）时，便会走上街头，发起罢工。\n\n比特尼亚有 $n$ 座城市。每座城市的居民独立决定是否发起或结束罢工。罢工期间，城市陷入瘫痪，无法进出。遗憾的是，国家的路网设计极简，任意两城市间仅有一条路径。这使得罢工成为非罢工城市居民的交通噩梦。罢工导致通信网络分裂为若干部分，只有同一部分的非罢工城市间可通达。\n\n作为比特尼亚的交通监察专员，你需编写程序，根据当前罢工信息，计算通信网络分裂成的部分数量。\n\n比特尼亚的所有道路均为双向，起点和终点均为城市。", "inputFormat": "第一行包含一个整数 $n$ $(n \\geq 2)$，表示比特尼亚的城市数量。城市编号为 $1$ 至 $n$。\n\n接下来的 $n-1$ 行描述道路，每行包含两个整数 $a, b$ $(1 \\leq a < b \\leq n)$，表示城市 $a$ 和 $b$ 间存在一条道路。任意两城市间存在一条由若干道路组成的路径。\n\n下一行包含一个整数 $m$ $(m \\geq 1)$，表示罢工信息的数量。\n\n接下来的 $m$ 行，每行包含一个整数 $z$ $(1 \\leq |z| \\leq n)$。若 $z > 0$，表示城市 $z$ 发起罢工；若 $z < 0$，表示城市 $-z$ 结束罢工。\n\n保证每座城市同时至多有一个罢工：若城市在罢工，不可再次发起；若未在罢工，不可结束。初始时无城市罢工。", "outputFormat": "输出 $m$ 行，第 $i$ $(1 \\leq i \\leq m)$ 行包含一个整数，表示第 $i$ 条罢工信息后，通信网络分裂成的部分数量。若所有城市均在罢工，输出 $0$。", "hint": "**样例 1 解释**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/u3sk77gn.png)\n\n图示为城市 $2$ 和 $7$ 发起罢工后的比特尼亚通信网络，网络分裂为三部分。\n\n**附加样例**\n\n1. $n=2, m=10$，两城市交替改变罢工状态。\n2. $n=1000, m=n$，路网为一条链，每城市依次发起罢工。  \n3. $n=500000$，路网为一条链，偶数编号城市依次发起罢工，随后按同顺序结束。\n\n路网为一条链，指对于 $a=1, \\ldots, n-1$，城市 $a$ 和 $a+1$ 相连。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $n, m \\leq 1000$         | $24$ |\n| $2$    | $n, m \\leq 500000$，路网为一条链 | $17$ |\n| $3$    | $n, m \\leq 500000$，输入全为正数 | $17$ |\n| $4$    | $n, m \\leq 500000$       | $42$ |", "locale": "zh-CN"}}}
{"pid": "P12750", "type": "P", "difficulty": 0, "samples": [["5 2 3\n2\n4\n1000000000000000000", "32\n104\nNIE"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2017", "POI（波兰）"], "title": "[POI 2017 R2] 数字之和 Sum of digits", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5058)。", "description": "**题目译自 [XXIV Olimpiada Informatyczna — II etap](https://sio2.mimuw.edu.pl/c/oi24-2/dashboard/) [Suma cyfr](https://szkopul.edu.pl/problemset/problem/Ng815bt4Fko9lj2-l7eVl3Aw/statement/)**\n\n编写程序，在所有正整数中，找出满足数字之和为 $s$ 且能被 $m$ 整除的第 $k$ 小数。若该数不存在或超过 $200$ 位，输出 `NIE`。", "inputFormat": "第一行包含三个正整数 $s, m, q$，分别表示数字之和、除数和测试数据组数。\n\n接下来的 $q$ 行每行描述一组测试数据，第 $i$ 行包含一个正整数 $k_i$，表示需找第 $k_i$ 小的满足条件的数。", "outputFormat": "输出 $q$ 行，每行对应一组测试数据的答案。第 $i$ 行输出满足数字之和为 $s$ 且可被 $m$ 整除的第 $k_i$ 小数，若该数不存在或超过 $200$ 位，输出 `NIE`。", "hint": "**样例 1 解释**\n\n满足数字之和为 $5$ 的数依次为：$5, 14, 23, 32, 41, 50, 104, 113, 122, \\ldots$  仅保留偶数，得到序列：$14, 32, 50, 104, 122, \\ldots$  第 $10^{18}$ 小的数超过 $200$ 位。\n\n**附加样例**\n\n1. $s=10, m=1, q=1, k_1=5$，答案 $55$。\n2. $s=200, m=200, q=1, k_1=1$，答案 $3999999999999999999999800$。\n3. $s=2, m=1, q=1, k_1=1000$，答案 `NIE`。\n4. $s=5, m=2, q=200, k_i=i$。\n5. $s=1, m=7, q=1, k_1=10^{18}$，答案 `NIE`。\n\n所有测试数据满足：$1 \\leq s \\leq 500, 1 \\leq m \\leq 500, 1 \\leq q \\leq 1000000, 1 \\leq k_i \\leq 10^{18}$。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $q \\leq 20$，答案不超过 $1000000$ | $5$ |\n| $2$    | $s=1$                    | $5$  |\n| $3$    | $k_i=1$                  | $10$ |\n| $4$    | $q=1, m=1, k_i \\leq 1000$ | $15$ |\n| $5$    | $q=1, m=1, k_i \\leq 1000000$ | $15$ |\n| $6$    | $q=1, m=1, k_i \\leq 10^9$ | $15$ |\n| $7$    | $m=1$                    | $15$ |\n| $8$    | 无附加限制              | $20$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[POI 2017 R2] 数字之和 Sum of digits", "background": "翻译来自于 [LibreOJ](https://loj.ac/p/5058)。", "description": "**题目译自 [XXIV Olimpiada Informatyczna — II etap](https://sio2.mimuw.edu.pl/c/oi24-2/dashboard/) [Suma cyfr](https://szkopul.edu.pl/problemset/problem/Ng815bt4Fko9lj2-l7eVl3Aw/statement/)**\n\n编写程序，在所有正整数中，找出满足数字之和为 $s$ 且能被 $m$ 整除的第 $k$ 小数。若该数不存在或超过 $200$ 位，输出 `NIE`。", "inputFormat": "第一行包含三个正整数 $s, m, q$，分别表示数字之和、除数和测试数据组数。\n\n接下来的 $q$ 行每行描述一组测试数据，第 $i$ 行包含一个正整数 $k_i$，表示需找第 $k_i$ 小的满足条件的数。", "outputFormat": "输出 $q$ 行，每行对应一组测试数据的答案。第 $i$ 行输出满足数字之和为 $s$ 且可被 $m$ 整除的第 $k_i$ 小数，若该数不存在或超过 $200$ 位，输出 `NIE`。", "hint": "**样例 1 解释**\n\n满足数字之和为 $5$ 的数依次为：$5, 14, 23, 32, 41, 50, 104, 113, 122, \\ldots$  仅保留偶数，得到序列：$14, 32, 50, 104, 122, \\ldots$  第 $10^{18}$ 小的数超过 $200$ 位。\n\n**附加样例**\n\n1. $s=10, m=1, q=1, k_1=5$，答案 $55$。\n2. $s=200, m=200, q=1, k_1=1$，答案 $3999999999999999999999800$。\n3. $s=2, m=1, q=1, k_1=1000$，答案 `NIE`。\n4. $s=5, m=2, q=200, k_i=i$。\n5. $s=1, m=7, q=1, k_1=10^{18}$，答案 `NIE`。\n\n所有测试数据满足：$1 \\leq s \\leq 500, 1 \\leq m \\leq 500, 1 \\leq q \\leq 1000000, 1 \\leq k_i \\leq 10^{18}$。\n\n详细子任务附加限制及分值如下表所示。\n\n| 子任务 | 附加限制 | 分值 |\n| :---: | :--: | :---: |\n| $1$    | $q \\leq 20$，答案不超过 $1000000$ | $5$ |\n| $2$    | $s=1$                    | $5$  |\n| $3$    | $k_i=1$                  | $10$ |\n| $4$    | $q=1, m=1, k_i \\leq 1000$ | $15$ |\n| $5$    | $q=1, m=1, k_i \\leq 1000000$ | $15$ |\n| $6$    | $q=1, m=1, k_i \\leq 10^9$ | $15$ |\n| $7$    | $m=1$                    | $15$ |\n| $8$    | 无附加限制              | $20$ |", "locale": "zh-CN"}}}
