{"pid": "P5672", "type": "P", "difficulty": 4, "samples": [["4 998244353\n1 2 3 4\nGPGG", "19"], ["3 998244353\n3 7 5\nPGG", "45"], ["10 998244353\n12345 23456 34567 45678 56789 67890 78901 89012 90123 101234\nGPPGPGGGPG", "104157290"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384]}, "tags": ["模拟"], "title": "「SWTR-2」Crystal Balls", "background": "$\\mathrm{Ethan}$ 有一些可以释放强大能量的水晶球，他将要用这些水晶球合成可以消灭敌人的魔法。\n\n- $a\\equiv b\\mathrm{\\ (mod\\ m)}$ 表示 $a$ 和 $b$ 对模 $m$ 同余，即 $(a-b)/m$ 为整数。", "description": "$\\mathrm{Ethan}$ 有 $n$ 个水晶球，现在他将这些水晶球排成一行，每一个水晶球上面有一个能量值，且**要么是绿色，要么是紫色**。\n\n- 下文中，$P$ 代表紫色，$G$ 代表绿色。\n\n$\\mathrm{Ethan}$ 现在要按以下方式取走这些水晶球：\n\n1. 取走**最左端**的水晶球。\n\n2. 假设取走的水晶球的颜色为 $c_1$，能值为 $x_1$，**剩余最左端**的水晶球的颜色为 $c_2$，能量为 $x_2$，取出水晶的次数为 $cnt$（包括这一次）。\n\n- 如果 $c_1=c_2$，那么 $\\mathrm{Ethan}$ 会将这两个水晶球合成为一个大水晶球（本次取出的水晶球仍计入答案总数内，详情见样例），颜色为 $c_1$，能量值为 $x_1 \\times x_2$，放在水晶球序列的**最左端**。\n\n- 如果，$c_1=P,c_2=G,cnt\\equiv 1\\mathrm{\\ (mod\\ 2)}$，那么 $\\mathrm{Ethan}$ 会将剩下的水晶球的**颜色反转**（即绿色变紫色，紫色变绿色）。\n\n- 如果仍不能满足上面的条件，那么 $\\mathrm{Ethan}$ 会将剩下的水晶球**序列翻转**。\n\n就这样，直到最后只剩下一个球，此时 $\\mathrm{Ethan}$ 会直接取走最后一个球，求取走的水晶球的**能量值之和**。\n\n由于答案很大，请对 $p$ 取模。", "inputFormat": "第一行，两个**正整数** $n,p$，分别表示水晶球的个数和模数。\n\n第二行，$n$ 个**正整数** $a_1,a_2,\\dots,a_n$，$a_i$ 表示第 $i$ 个水晶球的能量值。\n\n第三行，一个由字符 $P$ 和字符 $G$ 组成的字符串，如果第 $i$ 个字符为```P```，那么该水晶球是紫色，否则为绿色。", "outputFormat": "一个整数，表示取走的水晶球的能量值之和对 $p$ 取模的值。", "hint": "---\n\n### 样例说明\n\n**样例 $1$：**\n\n$\\mathrm{Ethan}$ 首先会取出最左端的水晶球，颜色为 ```G```，答案加上它上面所写上的数字，即 $1$，剩下的水晶球翻转，序列变为 $4\\ 3\\ 2$ ```GGP```。（因为 $c_1=G,c_2=P$，取出水晶球的次数为奇数，不满足条件 $1,2$，所以序列翻转）。\n\n再取出最左端的水晶球，颜色为 ```G```，答案加上 $4$，接着把剩下来最左端的水晶球与取走的水晶球合并成一个大的水晶球，写上的数字为 $12$，序列变为 $12\\ 2$ ```GP```。\n\n取出最左边的水晶球，颜色为 ```G```，答案加上 $12$，剩下的水晶球序列翻转，序列变为 $2$ ```P```。\n\n取出最后一个的水晶球，答案加上 $2$，最终答案为 $1+4+12+2=19$。\n\n**样例 $2$：**\n\n先取出 $3$，$c_1=P,c_2=G,cnt=1$，颜色翻转\n\n取出 $7$，$c_2=c_3=P$，将 $x_3$ 乘上 $x_2$，得到 $x_3=35$\n\n取出 $35$，最终答案为 $3+7+35=45$\n\n---\n\n### 数据范围与约定\n\n本题采用 $\\mathrm{Subtask}$ 制。\n\n$\\mathrm{Subtask}\\ 1:n\\leq 2000,a_i\\leq 10^9,p\\leq 10^9,15\\%$。\n\n$\\mathrm{Subtask}\\ 2:n\\leq 5\\times 10^4,a_i\\leq 10^9,p\\leq 10^9,15\\%$。\n\n$\\mathrm{Subtask}\\ 3:n\\leq 5\\times 10^4,a_i\\leq 10^{18},p\\leq 10^{18},20\\%$。\n\n$\\mathrm{Subtask}\\ 4:n\\leq 10^6,a_i\\leq 10^9,p\\leq 10^9,20\\%$。\n\n$\\mathrm{Subtask}\\ 5:n\\leq 10^6,a_i\\leq 10^{18},p\\leq 10^{18},30\\%$。\n\n---\n\n对于所有测试点，时间限制 $1s$，空间限制 $16MB$。", "locale": "zh-CN", "translations": {"en": {"title": "\"SWTR-2\" Crystal Balls", "background": "$\\mathrm{Ethan}$ has some crystal balls that can release powerful energy. He is going to use these crystal balls to combine magic that can destroy enemies.\n\n- $a\\equiv b\\mathrm{\\ (mod\\ m)}$ means that $a$ and $b$ are congruent modulo $m$, i.e., $(a-b)/m$ is an integer.", "description": "$\\mathrm{Ethan}$ has $n$ crystal balls. Now he arranges these crystal balls in a row. Each crystal ball has an energy value, and is **either green or purple**.\n\n- In the following, $P$ stands for purple, and $G$ stands for green.\n\n$\\mathrm{Ethan}$ will take away these crystal balls in the following way:\n\n1. Take away the **leftmost** crystal ball.\n\n2. Suppose the removed crystal ball has color $c_1$ and energy $x_1$, the **current leftmost** remaining crystal ball has color $c_2$ and energy $x_2$, and the number of times a crystal ball has been removed is $cnt$ (including this time).\n\n- If $c_1=c_2$, then $\\mathrm{Ethan}$ will combine these two crystal balls into one large crystal ball (the crystal ball removed this time is still counted in the total answer; see samples for details), with color $c_1$ and energy value $x_1 \\times x_2$, and put it at the **left end** of the crystal ball sequence.\n\n- If $c_1=P,c_2=G,cnt\\equiv 1\\mathrm{\\ (mod\\ 2)}$, then $\\mathrm{Ethan}$ will **flip the colors** of the remaining crystal balls (i.e., green becomes purple, and purple becomes green).\n\n- If the above conditions still cannot be satisfied, then $\\mathrm{Ethan}$ will **reverse the remaining sequence** of crystal balls.\n\nHe keeps doing this until only one ball remains. Then $\\mathrm{Ethan}$ will directly take away the last ball. Find the **sum of the energy values** of all removed crystal balls.\n\nSince the answer can be very large, take it modulo $p$.", "inputFormat": "The first line contains two **positive integers** $n,p$, representing the number of crystal balls and the modulus.\n\nThe second line contains $n$ **positive integers** $a_1,a_2,\\dots,a_n$, where $a_i$ is the energy value of the $i$-th crystal ball.\n\nThe third line contains a string consisting of characters $P$ and $G$. If the $i$-th character is ```P```, then the crystal ball is purple; otherwise it is green.", "outputFormat": "Output one integer, the sum of the energy values of the removed crystal balls modulo $p$.", "hint": "---\n\n### Sample Explanation\n\n**Sample $1$:**\n\n$\\mathrm{Ethan}$ first removes the leftmost crystal ball, whose color is ```G```. Add the number written on it to the answer, i.e., $1$. Then the remaining crystal balls are reversed, and the sequence becomes $4\\ 3\\ 2$ ```GGP```. (Because $c_1=G,c_2=P$, and the removal count is odd, it does not satisfy conditions 1 or 2, so the sequence is reversed.)\n\nThen remove the leftmost crystal ball, whose color is ```G```. Add $4$ to the answer. Next, combine the current leftmost remaining crystal ball with the removed one into a large crystal ball with number $12$. The sequence becomes $12\\ 2$ ```GP```.\n\nRemove the leftmost crystal ball, whose color is ```G```. Add $12$ to the answer. Reverse the remaining sequence, which becomes $2$ ```P```.\n\nRemove the last crystal ball. Add $2$ to the answer. The final answer is $1+4+12+2=19$.\n\n**Sample $2$:**\n\nFirst remove $3$, $c_1=P,c_2=G,cnt=1$, so flip the colors.\n\nRemove $7$, $c_2=c_3=P$, multiply $x_3$ by $x_2$, getting $x_3=35$.\n\nRemove $35$, and the final answer is $3+7+35=45$.\n\n---\n\n### Constraints and Notes\n\nThis problem uses $\\mathrm{Subtask}$.\n\n$\\mathrm{Subtask}\\ 1:n\\leq 2000,a_i\\leq 10^9,p\\leq 10^9,15\\%$.\n\n$\\mathrm{Subtask}\\ 2:n\\leq 5\\times 10^4,a_i\\leq 10^9,p\\leq 10^9,15\\%$.\n\n$\\mathrm{Subtask}\\ 3:n\\leq 5\\times 10^4,a_i\\leq 10^{18},p\\leq 10^{18},20\\%$.\n\n$\\mathrm{Subtask}\\ 4:n\\leq 10^6,a_i\\leq 10^9,p\\leq 10^9,20\\%$.\n\n$\\mathrm{Subtask}\\ 5:n\\leq 10^6,a_i\\leq 10^{18},p\\leq 10^{18},30\\%$.\n\n---\n\nFor all testdata, the time limit is $1s$, and the memory limit is $16MB$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「SWTR-2」Crystal Balls", "background": "$\\mathrm{Ethan}$ 有一些可以释放强大能量的水晶球，他将要用这些水晶球合成可以消灭敌人的魔法。\n\n- $a\\equiv b\\mathrm{\\ (mod\\ m)}$ 表示 $a$ 和 $b$ 对模 $m$ 同余，即 $(a-b)/m$ 为整数。", "description": "$\\mathrm{Ethan}$ 有 $n$ 个水晶球，现在他将这些水晶球排成一行，每一个水晶球上面有一个能量值，且**要么是绿色，要么是紫色**。\n\n- 下文中，$P$ 代表紫色，$G$ 代表绿色。\n\n$\\mathrm{Ethan}$ 现在要按以下方式取走这些水晶球：\n\n1. 取走**最左端**的水晶球。\n\n2. 假设取走的水晶球的颜色为 $c_1$，能值为 $x_1$，**剩余最左端**的水晶球的颜色为 $c_2$，能量为 $x_2$，取出水晶的次数为 $cnt$（包括这一次）。\n\n- 如果 $c_1=c_2$，那么 $\\mathrm{Ethan}$ 会将这两个水晶球合成为一个大水晶球（本次取出的水晶球仍计入答案总数内，详情见样例），颜色为 $c_1$，能量值为 $x_1 \\times x_2$，放在水晶球序列的**最左端**。\n\n- 如果，$c_1=P,c_2=G,cnt\\equiv 1\\mathrm{\\ (mod\\ 2)}$，那么 $\\mathrm{Ethan}$ 会将剩下的水晶球的**颜色反转**（即绿色变紫色，紫色变绿色）。\n\n- 如果仍不能满足上面的条件，那么 $\\mathrm{Ethan}$ 会将剩下的水晶球**序列翻转**。\n\n就这样，直到最后只剩下一个球，此时 $\\mathrm{Ethan}$ 会直接取走最后一个球，求取走的水晶球的**能量值之和**。\n\n由于答案很大，请对 $p$ 取模。", "inputFormat": "第一行，两个**正整数** $n,p$，分别表示水晶球的个数和模数。\n\n第二行，$n$ 个**正整数** $a_1,a_2,\\dots,a_n$，$a_i$ 表示第 $i$ 个水晶球的能量值。\n\n第三行，一个由字符 $P$ 和字符 $G$ 组成的字符串，如果第 $i$ 个字符为```P```，那么该水晶球是紫色，否则为绿色。", "outputFormat": "一个整数，表示取走的水晶球的能量值之和对 $p$ 取模的值。", "hint": "---\n\n### 样例说明\n\n**样例 $1$：**\n\n$\\mathrm{Ethan}$ 首先会取出最左端的水晶球，颜色为 ```G```，答案加上它上面所写上的数字，即 $1$，剩下的水晶球翻转，序列变为 $4\\ 3\\ 2$ ```GGP```。（因为 $c_1=G,c_2=P$，取出水晶球的次数为奇数，不满足条件 $1,2$，所以序列翻转）。\n\n再取出最左端的水晶球，颜色为 ```G```，答案加上 $4$，接着把剩下来最左端的水晶球与取走的水晶球合并成一个大的水晶球，写上的数字为 $12$，序列变为 $12\\ 2$ ```GP```。\n\n取出最左边的水晶球，颜色为 ```G```，答案加上 $12$，剩下的水晶球序列翻转，序列变为 $2$ ```P```。\n\n取出最后一个的水晶球，答案加上 $2$，最终答案为 $1+4+12+2=19$。\n\n**样例 $2$：**\n\n先取出 $3$，$c_1=P,c_2=G,cnt=1$，颜色翻转\n\n取出 $7$，$c_2=c_3=P$，将 $x_3$ 乘上 $x_2$，得到 $x_3=35$\n\n取出 $35$，最终答案为 $3+7+35=45$\n\n---\n\n### 数据范围与约定\n\n本题采用 $\\mathrm{Subtask}$ 制。\n\n$\\mathrm{Subtask}\\ 1:n\\leq 2000,a_i\\leq 10^9,p\\leq 10^9,15\\%$。\n\n$\\mathrm{Subtask}\\ 2:n\\leq 5\\times 10^4,a_i\\leq 10^9,p\\leq 10^9,15\\%$。\n\n$\\mathrm{Subtask}\\ 3:n\\leq 5\\times 10^4,a_i\\leq 10^{18},p\\leq 10^{18},20\\%$。\n\n$\\mathrm{Subtask}\\ 4:n\\leq 10^6,a_i\\leq 10^9,p\\leq 10^9,20\\%$。\n\n$\\mathrm{Subtask}\\ 5:n\\leq 10^6,a_i\\leq 10^{18},p\\leq 10^{18},30\\%$。\n\n---\n\n对于所有测试点，时间限制 $1s$，空间限制 $16MB$。", "locale": "zh-CN"}}}
{"pid": "P5673", "type": "P", "difficulty": 5, "samples": [["6 11 3\n1 1 1 2 1 3\n7 3 8 9 6 5\n1 1\n1 2\n1 3\n1 4\n1 5\n1 6\n2 6\n3 6\n4 6\n5 6\n6 6", "7\n10\n11\n20\n23\n28\n28\n28\n20\n11\n5"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 750, 750, 750, 750, 750, 750, 750, 750, 750, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["树状数组"], "title": "「SWTR-2」Picking Gifts", "background": "$\\mathrm{Sunny}$ 有个 $npy$ 叫做小 $\\mathrm{b}$。\n\n小 $\\mathrm{b}$ 的生日就要到了，$\\mathrm{Sunny}$ 想给她买一些礼物。", "description": "商店里摆着琳琅满目的商品，每个商品都有：\n\n- 编号，**从左到右**依次为 $1,2,\\dots n$。\n\n- 种类，分别为 $p_1,p_2,\\dots p_n$。\n\n- 价值，分别为 $v_1,v_2,\\dots v_n$。\n\n$\\mathrm{Sunny}$ 想从中挑选一个区间，将这个区间里的所有礼物买下来送给小 $\\mathrm{b}$。\n\n小 $\\mathrm{b}$ 会**从右往左**依次查看 $\\mathrm{Sunny}$ 送给他的礼物，如果她看到同一种类的礼物出现了 $k$ 次，那么她就不会再去查看这种礼物（包括第 $k$ 个），当然，这些礼物也就失去了原本的价值。\n\n现在，$\\mathrm{Sunny}$ 给你了 $m$ 个区间，想让你求出在小 $\\mathrm{b}$ 眼中，这个区间的价值。\n\n具体的价值计算见样例。", "inputFormat": "第一行由空格隔开的三个正整数 $n,m,k$。\n\n第二行 $n$ 个由空格隔开的正整数，第 $i$ 个数代表 $p_i$。\n\n第三行 $n$ 个由空格隔开的正整数，第 $i$ 个数代表 $v_i$。\n\n接下来 $m$ 行，第 $i$ 行两个正整数 $l_i,r_i$，表示第 $i$ 次询问的区间。", "outputFormat": "输出 $m$ 行，对于每一个询问，输出一行一个整数 $v$，为这个区间在小 $\\mathrm{b}$ 眼中的价值。", "hint": "---\n\n### 样例说明\n\n$[1,1]:7$。\n\n$[1,2]:3+7=10$。\n\n$[1,3]:8+3=11$，因为编号为 $1$ 的礼物种类为 $1$，这是种类 $1$ 出现的第 $k(k=3)$ 次，所以她不会再看这种礼物（包括这个）。\n\n$[1,4]:9+8+3=20$。\n\n$[2,6]:5+6+9+8=28$。\n\n$[3,6]:5+6+9+8=28$。\n\n---\n\n### 数据范围与约定\n\n测试点 $1-4:n\\leq 100,m\\leq 100$。\n\n测试点 $5-6:n\\leq 5000,m\\leq 5000$。\n\n测试点 $7-10:n\\leq 2\\times 10^4,m\\leq 10^4$。\n\n测试点 $11-15:n\\leq 2\\times 10^5,m\\leq 2\\times 10^5$。\n\n测试点 $16-20:n\\leq 10^6,m\\leq 5\\times 10^5$。\n\n对于测试点 $1,2,7,8,11,12,16,17$，有 $k=n$，其余测试点有 $2\\leq k<n$。\n\n对于所有测试点，有 $1\\leq p_i\\leq n,1\\leq v_i\\leq 2000,1\\leq l \\leq r \\leq n$。\n\n---\n\n对于测试点 $1-10$，每个 $3$ 分。\n\n对于测试点 $11-20$ 中 $k=n$ 的，每个 $4$ 分。\n\n其余测试点每个 $9$ 分。\n\n---\n\n对于测试点 $1-6$，时间限制 $500\\rm ms$。\n\n对于测试点 $7-15$，时间限制 $750\\rm ms$。\n\n对于测试点 $16-20$，时间限制 $1.5\\rm s$。\n\n\n---\n\n当然了，SWTR-02 的出题人们是不可能有 girlfriends 的。", "locale": "zh-CN", "translations": {"en": {"title": "\"SWTR-2\" Picking Gifts", "background": "$\\mathrm{Sunny}$ has an $npy$ called little $\\mathrm{b}$.\n\nLittle $\\mathrm{b}$'s birthday is coming soon, and $\\mathrm{Sunny}$ wants to buy her some gifts.", "description": "There are many items in the shop. Each item has:\n\n- An index, from left to right as $1,2,\\dots,n$.\n\n- A category, as $p_1,p_2,\\dots,p_n$.\n\n- A value, as $v_1,v_2,\\dots,v_n$.\n\n$\\mathrm{Sunny}$ wants to choose an interval and buy all gifts in this interval to give to little $\\mathrm{b}$.\n\nLittle $\\mathrm{b}$ will check the gifts from right to left. If she sees that gifts of the same category have appeared $k$ times, then she will not check this category anymore (including the $k$-th one). Of course, those gifts will then lose their original value.\n\nNow, $\\mathrm{Sunny}$ gives you $m$ intervals and wants you to compute, in little $\\mathrm{b}$'s view, the value of each interval.\n\nSee the sample for the detailed value calculation.", "inputFormat": "The first line contains three positive integers $n,m,k$ separated by spaces.\n\nThe second line contains $n$ positive integers separated by spaces, where the $i$-th number represents $p_i$.\n\nThe third line contains $n$ positive integers separated by spaces, where the $i$-th number represents $v_i$.\n\nThe next $m$ lines each contain two positive integers $l_i,r_i$, representing the interval of the $i$-th query.", "outputFormat": "Output $m$ lines. For each query, output one integer $v$ in one line, the value of this interval in little $\\mathrm{b}$'s view.", "hint": "---\n\n### Sample Explanation\n\n$[1,1]:7$.\n\n$[1,2]:3+7=10$.\n\n$[1,3]:8+3=11$, because the category of the gift with index $1$ is $1$, and this is the $k(k=3)$-th time category $1$ appears, so she will not check this category anymore (including this one).\n\n$[1,4]:9+8+3=20$.\n\n$[2,6]:5+6+9+8=28$.\n\n$[3,6]:5+6+9+8=28$.\n\n---\n\n### Constraints and Notes\n\nTestdata $1-4$: $n\\leq 100,m\\leq 100$.\n\nTestdata $5-6$: $n\\leq 5000,m\\leq 5000$.\n\nTestdata $7-10$: $n\\leq 2\\times 10^4,m\\leq 10^4$.\n\nTestdata $11-15$: $n\\leq 2\\times 10^5,m\\leq 2\\times 10^5$.\n\nTestdata $16-20$: $n\\leq 10^6,m\\leq 5\\times 10^5$.\n\nFor testdata $1,2,7,8,11,12,16,17$, $k=n$. For the other testdata, $2\\leq k<n$.\n\nFor all testdata, $1\\leq p_i\\leq n,1\\leq v_i\\leq 2000,1\\leq l \\leq r \\leq n$.\n\n---\n\nFor testdata $1-10$, each is worth $3$ points.\n\nFor testdata $11-20$ where $k=n$, each is worth $4$ points.\n\nAll other testdata are worth $9$ points each.\n\n---\n\nFor testdata $1-6$, the time limit is $500\\rm ms$.\n\nFor testdata $7-15$, the time limit is $750\\rm ms$.\n\nFor testdata $16-20$, the time limit is $1.5\\rm s$.\n\n---\n\nOf course, the setters of SWTR-02 cannot possibly have girlfriends.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「SWTR-2」Picking Gifts", "background": "$\\mathrm{Sunny}$ 有个 $npy$ 叫做小 $\\mathrm{b}$。\n\n小 $\\mathrm{b}$ 的生日就要到了，$\\mathrm{Sunny}$ 想给她买一些礼物。", "description": "商店里摆着琳琅满目的商品，每个商品都有：\n\n- 编号，**从左到右**依次为 $1,2,\\dots n$。\n\n- 种类，分别为 $p_1,p_2,\\dots p_n$。\n\n- 价值，分别为 $v_1,v_2,\\dots v_n$。\n\n$\\mathrm{Sunny}$ 想从中挑选一个区间，将这个区间里的所有礼物买下来送给小 $\\mathrm{b}$。\n\n小 $\\mathrm{b}$ 会**从右往左**依次查看 $\\mathrm{Sunny}$ 送给他的礼物，如果她看到同一种类的礼物出现了 $k$ 次，那么她就不会再去查看这种礼物（包括第 $k$ 个），当然，这些礼物也就失去了原本的价值。\n\n现在，$\\mathrm{Sunny}$ 给你了 $m$ 个区间，想让你求出在小 $\\mathrm{b}$ 眼中，这个区间的价值。\n\n具体的价值计算见样例。", "inputFormat": "第一行由空格隔开的三个正整数 $n,m,k$。\n\n第二行 $n$ 个由空格隔开的正整数，第 $i$ 个数代表 $p_i$。\n\n第三行 $n$ 个由空格隔开的正整数，第 $i$ 个数代表 $v_i$。\n\n接下来 $m$ 行，第 $i$ 行两个正整数 $l_i,r_i$，表示第 $i$ 次询问的区间。", "outputFormat": "输出 $m$ 行，对于每一个询问，输出一行一个整数 $v$，为这个区间在小 $\\mathrm{b}$ 眼中的价值。", "hint": "---\n\n### 样例说明\n\n$[1,1]:7$。\n\n$[1,2]:3+7=10$。\n\n$[1,3]:8+3=11$，因为编号为 $1$ 的礼物种类为 $1$，这是种类 $1$ 出现的第 $k(k=3)$ 次，所以她不会再看这种礼物（包括这个）。\n\n$[1,4]:9+8+3=20$。\n\n$[2,6]:5+6+9+8=28$。\n\n$[3,6]:5+6+9+8=28$。\n\n---\n\n### 数据范围与约定\n\n测试点 $1-4:n\\leq 100,m\\leq 100$。\n\n测试点 $5-6:n\\leq 5000,m\\leq 5000$。\n\n测试点 $7-10:n\\leq 2\\times 10^4,m\\leq 10^4$。\n\n测试点 $11-15:n\\leq 2\\times 10^5,m\\leq 2\\times 10^5$。\n\n测试点 $16-20:n\\leq 10^6,m\\leq 5\\times 10^5$。\n\n对于测试点 $1,2,7,8,11,12,16,17$，有 $k=n$，其余测试点有 $2\\leq k<n$。\n\n对于所有测试点，有 $1\\leq p_i\\leq n,1\\leq v_i\\leq 2000,1\\leq l \\leq r \\leq n$。\n\n---\n\n对于测试点 $1-10$，每个 $3$ 分。\n\n对于测试点 $11-20$ 中 $k=n$ 的，每个 $4$ 分。\n\n其余测试点每个 $9$ 分。\n\n---\n\n对于测试点 $1-6$，时间限制 $500\\rm ms$。\n\n对于测试点 $7-15$，时间限制 $750\\rm ms$。\n\n对于测试点 $16-20$，时间限制 $1.5\\rm s$。\n\n\n---\n\n当然了，SWTR-02 的出题人们是不可能有 girlfriends 的。", "locale": "zh-CN"}}}
{"pid": "P5674", "type": "P", "difficulty": 6, "samples": [["7 1000000007 0\n3 7\n1 10\n1 1048576\n20180815 20180830\n20180632 20180639\n123456789 987654321\n123456789987654321 123456789987654321123456789987654321", "10 24\n17 96\n10485761 64327945\n255 803716286\n124 290111979\n996409842 54001814\n253678327 263109263"]], "limits": {"time": [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["高精度", "数位 DP"], "title": "「SWTR-2」Magical Gates", "background": "小 $\\mathrm{A}$ 找到了一张藏宝图。\n\n他顺着藏宝图上的路线来到了一扇古老的大门前，门上有六芒星的图案。\n\n他把手轻轻地放在六芒星上……\n\n霎时间，六芒星光芒大放，四周亮如白昼。\n\n（新增一组大样例）", "description": "小 $\\mathrm{A}$ 面前出现了 $10^{1000}$ 扇门，每个门上都写着它自己的编号，分别为 $1,2,3,\\dots,10^{1000}$。\n\n这时，守门人小 $\\mathrm{M}$  向小 $\\mathrm{A}$ 走来。\n\n“这些门，并不普通，它有魔力。”\n\n“我会给你一些区间 $l,r$，请你求出区间 $[l,r]$ 里所有门的魔力值之**和**与魔力值之**积**。”\n\n“因为结果可能很大，请你将结果 $mod\\ p$。 ”\n\n“如果你正确地回答了所有询问，你将会拥有这扇门后的所有宝藏。”\n\n“哦，对了，一扇门的魔力值就是其在二进制下 $1$ 的个数。”\n\n简单来说，记第 $i$ 扇门的魔力值为 $d_i$，给定的区间为 $[l,r]$，请求出：\n\n$$\\sum_{l}^{r}d_i\\bmod\\ p \\quad \\prod_{l}^{r}d_i\\bmod\\ p$$\n\n由于门的数量实在太多，小 $\\mathrm{A}$ 决定向你请求帮助。", "inputFormat": "第一行三个正整数 $T,p,n$（$n$ 会在数据范围中说明）。\n\n接下来 $T$ 行，第 $i$ 行两个**正整数** $l_i,r_i$。", "outputFormat": "输出 $T$ 行，每行 $2$ 个数，由空格隔开，第 $i$ 行分别为：\n\n$$\\sum_{l}^{r}d_i\\bmod\\ p \\quad \\prod_{l}^{r}d_i\\bmod\\ p$$", "hint": "---\n\n### 样例说明\n\n数据 $1$：\n\n$$\\sum_{3}^{7}d_i=2+1+2+2+3=10$$\n\n$$\\prod_{3}^{7}d_i=2\\times 1\\times 2\\times 2\\times 3=24$$\n\n数据 $2$：\n\n$$\\sum_{1}^{10}d_i=1+1+2+1+2+2+3+1+2+2=17$$\n\n$$\\prod_{1}^{10}d_i=1\\times 1\\times 2\\times 1\\times 2\\times 2\\times 3\\times 1\\times 2\\times 2=96$$\n\n---\n\n### 数据范围与约定\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zv6ppsk4.png)\n\n为了方便拿部分分，输入格式中的 $n$ 为**该测试点的编号**。\n\n所有具有特殊性质的测试点一共 $31\\%$。\n\n对于 $100\\%$ 的数据，有 $1\\leq n\\leq 27,1\\leq T \\leq 10,10^9 \\leq p \\leq 1.001\\times 10^9,1\\leq l\\leq r\\leq 10^{1000}$，**保证 $p$ 为质数**。\n\n---\n\n对于测试点 $1-20$，时限 $300ms$，剩下的 $7$ 个测试点时限 $2s$。\n\n对于所有测试点，空间限制 $256MB$\n\n---\n\n“吱嘎”一声，封尘千年的大门缓缓打开。\n\n刺眼的金光照了出来……", "locale": "zh-CN", "translations": {"en": {"title": "\"SWTR-2\" Magical Gates", "background": "Little $\\mathrm{A}$ found a treasure map.\n\nFollowing the route on the map, he arrived at an ancient gate with a hexagram pattern on it.\n\nHe gently placed his hand on the hexagram...\n\nIn an instant, the hexagram shone brightly, and the surroundings became as bright as day.\n\n(One new large sample has been added.)", "description": "In front of Little $\\mathrm{A}$ appeared $10^{1000}$ gates. Each gate has its own index written on it, namely $1,2,3,\\dots,10^{1000}$.\n\nAt this moment, the gatekeeper Little $\\mathrm{M}$ walked up to Little $\\mathrm{A}$.\n\n\"These gates are not ordinary. They have magic.\"\n\n\"I will give you some intervals $l,r$. Please find the **sum** and the **product** of the magic values of all gates in the interval $[l,r]$.\"\n\n\"Since the result may be very large, output the result $mod\\ p$.\"\n\n\"If you answer all queries correctly, you will own all the treasure behind this gate.\"\n\n\"Oh, right. The magic value of a gate is the number of $1$ bits in its binary representation.\"\n\nIn short, let the magic value of the $i$-th gate be $d_i$. Given an interval $[l,r]$, compute:\n\n$$\\sum_{l}^{r}d_i\\bmod\\ p \\quad \\prod_{l}^{r}d_i\\bmod\\ p$$\n\nBecause there are far too many gates, Little $\\mathrm{A}$ decided to ask you for help.", "inputFormat": "The first line contains three positive integers $T,p,n$ ($n$ will be explained in Constraints).\n\nThe next $T$ lines: on the $i$-th line there are two **positive integers** $l_i,r_i$.", "outputFormat": "Output $T$ lines. Each line contains $2$ numbers separated by a space. The $i$-th line should be:\n\n$$\\sum_{l}^{r}d_i\\bmod\\ p \\quad \\prod_{l}^{r}d_i\\bmod\\ p$$", "hint": "---\n\n### Sample Explanation\n\nTestdata 1:\n\n$$\\sum_{3}^{7}d_i=2+1+2+2+3=10$$\n\n$$\\prod_{3}^{7}d_i=2\\times 1\\times 2\\times 2\\times 3=24$$\n\nTestdata 2:\n\n$$\\sum_{1}^{10}d_i=1+1+2+1+2+2+3+1+2+2=17$$\n\n$$\\prod_{1}^{10}d_i=1\\times 1\\times 2\\times 1\\times 2\\times 2\\times 3\\times 1\\times 2\\times 2=96$$\n\n---\n\n### Constraints and Notes\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zv6ppsk4.png)\n\nTo make it easier to get partial scores, the $n$ in the input format is the **index of the current test point**.\n\nAll test points with special properties take up a total of $31\\%$.\n\nFor $100\\%$ of the data, $1\\leq n\\leq 27,1\\leq T \\leq 10,10^9 \\leq p \\leq 1.001\\times 10^9,1\\leq l\\leq r\\leq 10^{1000}$, and **$p$ is guaranteed to be prime**.\n\n---\n\nFor test points $1-20$, the time limit is $300ms$, and for the remaining $7$ test points the time limit is $2s$.\n\nFor all test points, the memory limit is $256MB$.\n\n---\n\nWith a \"creak\", the dust-covered gate that had been sealed for a thousand years slowly opened.\n\nA dazzling golden light shone out...\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「SWTR-2」Magical Gates", "background": "小 $\\mathrm{A}$ 找到了一张藏宝图。\n\n他顺着藏宝图上的路线来到了一扇古老的大门前，门上有六芒星的图案。\n\n他把手轻轻地放在六芒星上……\n\n霎时间，六芒星光芒大放，四周亮如白昼。\n\n（新增一组大样例）", "description": "小 $\\mathrm{A}$ 面前出现了 $10^{1000}$ 扇门，每个门上都写着它自己的编号，分别为 $1,2,3,\\dots,10^{1000}$。\n\n这时，守门人小 $\\mathrm{M}$  向小 $\\mathrm{A}$ 走来。\n\n“这些门，并不普通，它有魔力。”\n\n“我会给你一些区间 $l,r$，请你求出区间 $[l,r]$ 里所有门的魔力值之**和**与魔力值之**积**。”\n\n“因为结果可能很大，请你将结果 $mod\\ p$。 ”\n\n“如果你正确地回答了所有询问，你将会拥有这扇门后的所有宝藏。”\n\n“哦，对了，一扇门的魔力值就是其在二进制下 $1$ 的个数。”\n\n简单来说，记第 $i$ 扇门的魔力值为 $d_i$，给定的区间为 $[l,r]$，请求出：\n\n$$\\sum_{l}^{r}d_i\\bmod\\ p \\quad \\prod_{l}^{r}d_i\\bmod\\ p$$\n\n由于门的数量实在太多，小 $\\mathrm{A}$ 决定向你请求帮助。", "inputFormat": "第一行三个正整数 $T,p,n$（$n$ 会在数据范围中说明）。\n\n接下来 $T$ 行，第 $i$ 行两个**正整数** $l_i,r_i$。", "outputFormat": "输出 $T$ 行，每行 $2$ 个数，由空格隔开，第 $i$ 行分别为：\n\n$$\\sum_{l}^{r}d_i\\bmod\\ p \\quad \\prod_{l}^{r}d_i\\bmod\\ p$$", "hint": "---\n\n### 样例说明\n\n数据 $1$：\n\n$$\\sum_{3}^{7}d_i=2+1+2+2+3=10$$\n\n$$\\prod_{3}^{7}d_i=2\\times 1\\times 2\\times 2\\times 3=24$$\n\n数据 $2$：\n\n$$\\sum_{1}^{10}d_i=1+1+2+1+2+2+3+1+2+2=17$$\n\n$$\\prod_{1}^{10}d_i=1\\times 1\\times 2\\times 1\\times 2\\times 2\\times 3\\times 1\\times 2\\times 2=96$$\n\n---\n\n### 数据范围与约定\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/zv6ppsk4.png)\n\n为了方便拿部分分，输入格式中的 $n$ 为**该测试点的编号**。\n\n所有具有特殊性质的测试点一共 $31\\%$。\n\n对于 $100\\%$ 的数据，有 $1\\leq n\\leq 27,1\\leq T \\leq 10,10^9 \\leq p \\leq 1.001\\times 10^9,1\\leq l\\leq r\\leq 10^{1000}$，**保证 $p$ 为质数**。\n\n---\n\n对于测试点 $1-20$，时限 $300ms$，剩下的 $7$ 个测试点时限 $2s$。\n\n对于所有测试点，空间限制 $256MB$\n\n---\n\n“吱嘎”一声，封尘千年的大门缓缓打开。\n\n刺眼的金光照了出来……", "locale": "zh-CN"}}}
{"pid": "P5675", "type": "P", "difficulty": 5, "samples": [["3\n2 4 5", "5"], ["3\n1 2 2", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "博弈论", "2017", "各省省选", "O2优化", "贵州"], "title": "[GZOI2017] 取石子游戏", "background": "GZOI2017 D1T1", "description": "Alice 和 Bob 在玩一个古老的游戏。现在有若干堆石子，Alice 和 Bob 轮流取，每次可以选择其中某一堆的石子中取出任意颗石子，但不能不取，谁先取完使得另一个人不能取了算赢。\n\n现在场地上有 $N$ 堆石子，编号为 $1$ 至 $N$。Alice 很快发现了这个游戏存在一些固定的策略。阴险的 Alice 想赢得这场比赛就来找到主办方你，希望你在这 $N$ 堆石子中选出若干堆石子作为最后游戏用的石子堆并使得 Alice 能获得胜利。你自然不想让 Alice 得逞，所以你提出了一个条件：Alice 在这个游戏中第一次取的那堆石子的编号需要你来指定（仅指定取的石子堆编号，不指定第一次取多少个，这个指定的石子堆必然包含在最后游戏用的石子堆中）。\n\n现在你很好奇，你想算算有多少种方案让 Alice 不能获胜。注意，即使选出的石子堆的编号的集合完全相同，指定第一次取的石子堆的编号不同，也认为方案是不同的。", "inputFormat": "第一行，一个正整数 $N$，表示石子堆数。\n\n第二行，$N$ 个正整数，表示各堆石子的数量，按编号 $1$ 至 $N$ 依次给出。", "outputFormat": "一行，表示方案数。答案对 $10^9+7$ 取模。", "hint": "【样例 $1$ 解释】\n\n第一种：选编号 $1$ 和编号 $2$，指定编号 $1$。\n\n第二种：选编号 $1$ 和编号 $3$，指定编号 $1$。\n\n第三种：选编号 $1$、编号 $2$ 和编号 $3$，指定编号 $2$。\n\n第四种：选编号 $1$、编号 $2$ 和编号 $3$，指定编号 $3$。\n\n第五种：选编号 $2$ 和编号 $3$，指定编号 $2$。\n\n【数据约束】\n\n| 数据编号 | $N$ | 每堆石子数量 |\n| :-: | :-: | :-: |\n| $1$ | $\\le 5$ | $\\le 5$ |\n| $2$ | $\\le 10$ | $\\le 10$ |\n| $3$ | $\\le 100$ | $\\le 100$ |\n| $4$ | $\\le 200$ | $\\le 200$ |\n| $5$ | $\\le 200$ | $\\le 200$ |", "locale": "zh-CN", "translations": {"en": {"title": "[GZOI2017] Stone Taking Game", "background": "GZOI2017 D1T1", "description": "Alice and Bob are playing an ancient game. There are several piles of stones. Alice and Bob take turns to take stones. Each time, a player may choose one pile and take any number of stones from it, but they must take at least one stone. Whoever takes the last stone so that the other player cannot move wins.\n\nNow there are $N$ piles of stones on the field, numbered from $1$ to $N$. Alice quickly discovered that this game has some fixed strategies. Cunning Alice wants to win this match, so she comes to you, the organizer, and asks you to select some piles from these $N$ piles as the piles used in the final game, such that Alice can win. Of course you do not want Alice to succeed, so you propose a condition: the pile that Alice takes from in her first move must be designated by you (you only designate the pile index, not how many stones she takes). This designated pile must be included among the piles chosen for the final game.\n\nNow you are curious and want to compute how many different plans make it impossible for Alice to win. Note that even if the set of chosen pile indices is exactly the same, plans are still considered different if the designated pile index for the first move is different.", "inputFormat": "The first line contains a positive integer $N$, denoting the number of piles.\n\nThe second line contains $N$ positive integers, denoting the number of stones in each pile, given in order from pile $1$ to pile $N$.", "outputFormat": "Output one line containing the number of plans. The answer should be taken modulo $10^9+7$.", "hint": "[Sample $1$ Explanation]\n\nThe first plan: choose piles $1$ and $2$, and designate pile $1$.\n\nThe second plan: choose piles $1$ and $3$, and designate pile $1$.\n\nThe third plan: choose piles $1$, $2$, and $3$, and designate pile $2$.\n\nThe fourth plan: choose piles $1$, $2$, and $3$, and designate pile $3$.\n\nThe fifth plan: choose piles $2$ and $3$, and designate pile $2$.\n\n[Constraints]\n\n| Testdata ID | $N$ | Stones in each pile |\n| :-: | :-: | :-: |\n| $1$ | $\\le 5$ | $\\le 5$ |\n| $2$ | $\\le 10$ | $\\le 10$ |\n| $3$ | $\\le 100$ | $\\le 100$ |\n| $4$ | $\\le 200$ | $\\le 200$ |\n| $5$ | $\\le 200$ | $\\le 200$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[GZOI2017] 取石子游戏", "background": "GZOI2017 D1T1", "description": "Alice 和 Bob 在玩一个古老的游戏。现在有若干堆石子，Alice 和 Bob 轮流取，每次可以选择其中某一堆的石子中取出任意颗石子，但不能不取，谁先取完使得另一个人不能取了算赢。\n\n现在场地上有 $N$ 堆石子，编号为 $1$ 至 $N$。Alice 很快发现了这个游戏存在一些固定的策略。阴险的 Alice 想赢得这场比赛就来找到主办方你，希望你在这 $N$ 堆石子中选出若干堆石子作为最后游戏用的石子堆并使得 Alice 能获得胜利。你自然不想让 Alice 得逞，所以你提出了一个条件：Alice 在这个游戏中第一次取的那堆石子的编号需要你来指定（仅指定取的石子堆编号，不指定第一次取多少个，这个指定的石子堆必然包含在最后游戏用的石子堆中）。\n\n现在你很好奇，你想算算有多少种方案让 Alice 不能获胜。注意，即使选出的石子堆的编号的集合完全相同，指定第一次取的石子堆的编号不同，也认为方案是不同的。", "inputFormat": "第一行，一个正整数 $N$，表示石子堆数。\n\n第二行，$N$ 个正整数，表示各堆石子的数量，按编号 $1$ 至 $N$ 依次给出。", "outputFormat": "一行，表示方案数。答案对 $10^9+7$ 取模。", "hint": "【样例 $1$ 解释】\n\n第一种：选编号 $1$ 和编号 $2$，指定编号 $1$。\n\n第二种：选编号 $1$ 和编号 $3$，指定编号 $1$。\n\n第三种：选编号 $1$、编号 $2$ 和编号 $3$，指定编号 $2$。\n\n第四种：选编号 $1$、编号 $2$ 和编号 $3$，指定编号 $3$。\n\n第五种：选编号 $2$ 和编号 $3$，指定编号 $2$。\n\n【数据约束】\n\n| 数据编号 | $N$ | 每堆石子数量 |\n| :-: | :-: | :-: |\n| $1$ | $\\le 5$ | $\\le 5$ |\n| $2$ | $\\le 10$ | $\\le 10$ |\n| $3$ | $\\le 100$ | $\\le 100$ |\n| $4$ | $\\le 200$ | $\\le 200$ |\n| $5$ | $\\le 200$ | $\\le 200$ |", "locale": "zh-CN"}}}
{"pid": "P5676", "type": "P", "difficulty": 4, "samples": [["5\n1\n100000\n100000\n5\n1 2 6 15 35\n5 7 9 2 3\n5\n2 3 5 35 21\n7 11 7 3 2\n10\n6 15 77 12 24 37 35 99 55 42\n4 2 5 7 11 3 6 8 9 10\n10\n6540 5604 567 57065 60 670 6870 1230 465 6540\n12 5 37 3 34 13 17 18 10 12", "1\n3\n3\n8\n5"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["图论", "2017", "各省省选", "O2优化", "贵州", "Tarjan"], "title": "[GZOI2017] 小z玩游戏", "background": "GZOI2017 D1T2", "description": "小 z 很无聊。\n\n小 z 要玩游戏。\n\n小 z 有 $N$ 个新游戏，第 $i$ 个游戏看上去的有趣程度为 $w_i$。\n\n小 z 很挑，他只会玩看上去的有趣程度是自己兴奋程度整数倍的游戏。\n\n由于游戏实际上有好玩的也有不好玩的，玩完第 $i$ 个游戏后，小 z 的兴奋程度会变为 $e_i$。\n\n已知小 z 初始兴奋程度为 $1$，请问小 z 有多少个游戏可能会玩两次？", "inputFormat": "第一行一个正整数 $T$，表示测试数据组数，最多 $10$ 组。\n\n对于每组测试数据：\n\n- 第一行一个正整数 $N$，表示游戏的个数。\n- 第二行 $N$ 个正整数，第 $i$ 个数 $w_i$，表示第 $i$ 个游戏看上去的有趣程度为 $w_i$。\n- 第三行 $N$ 个正整数，第 $i$ 个数 $e_i$，表示小 z 玩完第 $i$ 个游戏后，小 z 的兴奋程度会变为 $e_i$。", "outputFormat": "共 $T$ 行。\n\n每行一个正整数，表示对应测试数据，小 z 可能会玩两次的游戏数量。", "hint": "### 样例 2 解释\n\n数字代表游戏编号，箭头表示下一个。\n\n- 情况 $1$：$2\\to 5\\to 4\\to 2$；\n- 情况 $2$：$5\\to 4\\to 2\\to 5$；\n- 情况 $3$：$4\\to 2\\to 5\\to 4$。\n\n所以小 z 可能玩 $2,4,5$ 两次。\n\n小 z 无论如何都不能玩 $1$ 或 $3$ 两次。\n\n### 数据范围及约定\n\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/s757wplh.png)", "locale": "zh-CN", "translations": {"en": {"title": "[GZOI2017] Little z Plays Games", "background": "GZOI2017 D1T2.", "description": "Little z is very bored.\n\nLittle z wants to play games.\n\nLittle z has $N$ new games. The apparent fun level of the $i$-th game is $w_i$.\n\nLittle z is picky. He will only play a game whose apparent fun level is an integer multiple of his excitement level.\n\nSince some games are actually fun and some are not, after finishing the $i$-th game, Little z’s excitement level will become $e_i$.\n\nIt is known that Little z’s initial excitement level is $1$. Please determine how many games Little z might play twice.", "inputFormat": "The first line contains a positive integer $T$, indicating the number of testdata groups, up to $10$ groups.\n\nFor each group of testdata:\n\n- The first line contains a positive integer $N$, indicating the number of games.\n- The second line contains $N$ positive integers. The $i$-th number $w_i$ indicates that the apparent fun level of the $i$-th game is $w_i$.\n- The third line contains $N$ positive integers. The $i$-th number $e_i$ indicates that after Little z finishes the $i$-th game, his excitement level will become $e_i$.", "outputFormat": "Output $T$ lines in total.\n\nEach line contains one positive integer, indicating for the corresponding testdata group, the number of games that Little z might play twice.", "hint": "### Explanation for Sample 2\n\nNumbers represent game indices, and arrows indicate the next one.\n\n- Case $1$: $2\\to 5\\to 4\\to 2$.\n- Case $2$: $5\\to 4\\to 2\\to 5$.\n- Case $3$: $4\\to 2\\to 5\\to 4$.\n\nSo Little z might play games $2,4,5$ twice.\n\nNo matter what, Little z cannot play game $1$ or $3$ twice.\n\n### Constraints\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/s757wplh.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[GZOI2017] 小z玩游戏", "background": "GZOI2017 D1T2", "description": "小 z 很无聊。\n\n小 z 要玩游戏。\n\n小 z 有 $N$ 个新游戏，第 $i$ 个游戏看上去的有趣程度为 $w_i$。\n\n小 z 很挑，他只会玩看上去的有趣程度是自己兴奋程度整数倍的游戏。\n\n由于游戏实际上有好玩的也有不好玩的，玩完第 $i$ 个游戏后，小 z 的兴奋程度会变为 $e_i$。\n\n已知小 z 初始兴奋程度为 $1$，请问小 z 有多少个游戏可能会玩两次？", "inputFormat": "第一行一个正整数 $T$，表示测试数据组数，最多 $10$ 组。\n\n对于每组测试数据：\n\n- 第一行一个正整数 $N$，表示游戏的个数。\n- 第二行 $N$ 个正整数，第 $i$ 个数 $w_i$，表示第 $i$ 个游戏看上去的有趣程度为 $w_i$。\n- 第三行 $N$ 个正整数，第 $i$ 个数 $e_i$，表示小 z 玩完第 $i$ 个游戏后，小 z 的兴奋程度会变为 $e_i$。", "outputFormat": "共 $T$ 行。\n\n每行一个正整数，表示对应测试数据，小 z 可能会玩两次的游戏数量。", "hint": "### 样例 2 解释\n\n数字代表游戏编号，箭头表示下一个。\n\n- 情况 $1$：$2\\to 5\\to 4\\to 2$；\n- 情况 $2$：$5\\to 4\\to 2\\to 5$；\n- 情况 $3$：$4\\to 2\\to 5\\to 4$。\n\n所以小 z 可能玩 $2,4,5$ 两次。\n\n小 z 无论如何都不能玩 $1$ 或 $3$ 两次。\n\n### 数据范围及约定\n\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/s757wplh.png)", "locale": "zh-CN"}}}
{"pid": "P5677", "type": "P", "difficulty": 5, "samples": [["3 2\n2 1 3\n1 2\n1 3", "10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2017", "各省省选", "树状数组", "O2优化", "排序", "贵州"], "title": "[GZOI2017] 配对统计", "background": "GZOI2017 D1T3", "description": "给定 $n$ 个数 $a_1,\\cdots,a_n$。\n\n对于一组配对 $(x,y)$，若对于所有的 $i=1,2,\\cdots,n$，满足 $|a_x-a_y|\\le|a_x-a_i|(i\\not=x)$，则称 $(x,y)$ 为一组好的配对（$|x|$ 表示 $x$ 的绝对值）。\n\n给出若干询问，每次询问区间 $[l,r]$ 中含有多少组好的配对。\n\n即，取 $x,y$（$l\\le x,y\\le r$ 且 $x\\not=y$），问有多少组 $(x,y)$ 是好的配对。", "inputFormat": "第一行两个正整数 $n,m$。\n\n第二行 $n$ 个数 $a_1,\\cdots,a_n$。\n\n接下来 $m$ 行，每行给出两个数 $l,r$。", "outputFormat": "$Ans_i$ 表示第 $i$ 次询问的答案，输出 $\\sum_{i=1}^m\\limits Ans_i\\times i$ 即可。", "hint": "**【样例解释】**\n\n第一次询问好的配对有：$(1,2)(2,1)$；\n\n第二次询问好的配对有：$(1,2)(2,1),(1,3)(3,1)$；\n\n答案 $=2\\times 1+4\\times 2=10$。\n\n**【数据约束】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/32ms79n8.png)", "locale": "zh-CN", "translations": {"en": {"title": "[GZOI2017] Pairing Statistics", "background": "GZOI2017 D1T3", "description": "Given $n$ numbers $a_1,\\cdots,a_n$.\n\nFor a pair $(x,y)$, if for all $i=1,2,\\cdots,n$, it satisfies $|a_x-a_y|\\le|a_x-a_i|(i\\not=x)$, then $(x,y)$ is called a good pair ($|x|$ denotes the absolute value of $x$).\n\nYou are given several queries. For each query, ask how many good pairs are contained in the interval $[l,r]$.\n\nThat is, choose $x,y$ ($l\\le x,y\\le r$ and $x\\not=y$), and ask how many pairs $(x,y)$ are good pairs.", "inputFormat": "The first line contains two positive integers $n,m$.\n\nThe second line contains $n$ numbers $a_1,\\cdots,a_n$.\n\nIn the next $m$ lines, each line gives two numbers $l,r$.", "outputFormat": "Let $Ans_i$ be the answer to the $i$-th query. Output $\\sum_{i=1}^m\\limits Ans_i\\times i$.", "hint": "**Sample Explanation**\n\nIn the first query, the good pairs are: $(1,2)(2,1)$.\n\nIn the second query, the good pairs are: $(1,2)(2,1),(1,3)(3,1)$.\n\nThe answer $=2\\times 1+4\\times 2=10$.\n\n**Constraints**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/32ms79n8.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[GZOI2017] 配对统计", "background": "GZOI2017 D1T3", "description": "给定 $n$ 个数 $a_1,\\cdots,a_n$。\n\n对于一组配对 $(x,y)$，若对于所有的 $i=1,2,\\cdots,n$，满足 $|a_x-a_y|\\le|a_x-a_i|(i\\not=x)$，则称 $(x,y)$ 为一组好的配对（$|x|$ 表示 $x$ 的绝对值）。\n\n给出若干询问，每次询问区间 $[l,r]$ 中含有多少组好的配对。\n\n即，取 $x,y$（$l\\le x,y\\le r$ 且 $x\\not=y$），问有多少组 $(x,y)$ 是好的配对。", "inputFormat": "第一行两个正整数 $n,m$。\n\n第二行 $n$ 个数 $a_1,\\cdots,a_n$。\n\n接下来 $m$ 行，每行给出两个数 $l,r$。", "outputFormat": "$Ans_i$ 表示第 $i$ 次询问的答案，输出 $\\sum_{i=1}^m\\limits Ans_i\\times i$ 即可。", "hint": "**【样例解释】**\n\n第一次询问好的配对有：$(1,2)(2,1)$；\n\n第二次询问好的配对有：$(1,2)(2,1),(1,3)(3,1)$；\n\n答案 $=2\\times 1+4\\times 2=10$。\n\n**【数据约束】**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/32ms79n8.png)", "locale": "zh-CN"}}}
{"pid": "P5678", "type": "P", "difficulty": 5, "samples": [["10 5\n2 3 5 7 12\n23 45 2 4 8", "15"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["数学", "2017", "各省省选", "O2优化", "贵州", "矩阵乘法"], "title": "[GZOI2017] 河神", "background": "GZOI2017 D2T1\n\n终于忍受不了苦 X 的搬砖生活, Shlw 把手里的板砖扔进了河里.\n\n不出意料地, 河神冒了出来.\n\nShlw 说: “我掉了金砖, 快给我金砖!”\n\n“!!! 你已经知道套路了吗,”河神说道, “但是你要金砖的话, 我就不给你2017 彩虹小马大电影的资源了哦. 如果你说实话的话, 我还可以考虑一下.”\n\nShlw 发现事情并不简单, 在金钱和信仰面前, 难以抉择.\n\n突然, Shlw 不理会河神, 自顾自的地跑走了.\n\n“唉, 现在的年轻人啊... 真不知道在想什么.”Pinkie Pie 感叹, 卸下了河神伪装.", "description": "Shlw 从河神给的选择中, 获得了一道当年挂掉的代数题的灵感.\n\n但现在他希望你来帮忙解答, 因为他自己忙着去搜小马资源去了.\n\n给出数列 $\\{a_n\\}$ 和 $\\{b_n\\}$ 以及 $\\{A_n\\}$ 的递推关系, 试求出数列 $\\{A_n\\}$ 第 $N$ 项.\n\n递推关系为:\n\n$$A_n=\\begin{cases}a_n  &  0 \\le n < K \\\\ \\bigoplus_{0 \\le t < K} (A_{n-K+t} \\otimes b_t) & n \\ge K \\end{cases}$$\n\n其中，$\\otimes$ 表示与操作，$\\oplus$ 表示或操作。", "inputFormat": "第一行两个正整数 $N$ 和 $K$ 。\n\n第二行 $K$ 个空格隔开的非负整数, 表示 $\\{a_n\\}$。\n\n第三行 $K$ 个空格隔开的非负整数, 表示 $\\{b_n\\}$。", "outputFormat": "一行, 一个整数, 表示$\\{A_n\\}$。", "hint": "【样例解释】\n\n从 $A_0$ 至 $A_{10}$ 分别为: $2, 3, 5, 7, 12, 15, 15, 13, 15, 15, 15$\n\n【数据约束】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/16mwbo3z.png)\n\n【后记】\n\n后来, Pinkie Pie 偷偷来到 Shlw 家里, 她把这题拿回去考 Apple Jack, 于是 Apple Jack就有了狂吃苹果来畅游多重宇宙的本领.", "locale": "zh-CN", "translations": {"en": {"title": "[GZOI2017] River God", "background": "GZOI2017 D2T1.\n\nFinally unable to endure the hard brick-carrying life of Worker X, Shlw threw the brick in his hand into the river.\n\nAs expected, the River God appeared.\n\nShlw said: “I dropped a gold brick. Give me the gold brick now!”\n\n“!!! You already know the trick?” said the River God. “But if you want the gold brick, then I won’t give you the resources for the 2017 *My Little Pony* movie. If you tell the truth, I can still consider it.”\n\nShlw realized this was not simple. Faced with money and faith, it was hard to choose.\n\nSuddenly, Shlw ignored the River God and ran away on his own.\n\n“Sigh, young people these days... I really don’t know what they are thinking.” Pinkie Pie sighed and took off the River God disguise.", "description": "From the choices given by the River God, Shlw got inspiration for an algebra problem that he failed back then.\n\nBut now he hopes you can help solve it, because he is busy searching for pony resources.\n\nGiven the recurrence relations of sequences $\\{a_n\\}$, $\\{b_n\\}$, and $\\{A_n\\}$, find the $N$-th term of the sequence $\\{A_n\\}$.\n\nThe recurrence is:\n\n$$A_n=\\begin{cases}a_n  &  0 \\le n < K \\\\ \\bigoplus_{0 \\le t < K} (A_{n-K+t} \\otimes b_t) & n \\ge K \\end{cases}$$\n\nHere, $\\otimes$ denotes the AND operation, and $\\oplus$ denotes the OR operation.", "inputFormat": "The first line contains two positive integers $N$ and $K$.\n\nThe second line contains $K$ non-negative integers separated by spaces, representing $\\{a_n\\}$.\n\nThe third line contains $K$ non-negative integers separated by spaces, representing $\\{b_n\\}$.", "outputFormat": "One line with one integer, representing $\\{A_n\\}$.", "hint": "【Sample Explanation】\n\nFrom $A_0$ to $A_{10}$, they are respectively: $2, 3, 5, 7, 12, 15, 15, 13, 15, 15, 15$.\n\n【Constraints】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/16mwbo3z.png)\n\n【Postscript】\n\nLater, Pinkie Pie secretly came to Shlw’s home. She took this problem back to test Apple Jack, so Apple Jack gained the ability to travel the multiverse by eating apples like crazy.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[GZOI2017] 河神", "background": "GZOI2017 D2T1\n\n终于忍受不了苦 X 的搬砖生活, Shlw 把手里的板砖扔进了河里.\n\n不出意料地, 河神冒了出来.\n\nShlw 说: “我掉了金砖, 快给我金砖!”\n\n“!!! 你已经知道套路了吗,”河神说道, “但是你要金砖的话, 我就不给你2017 彩虹小马大电影的资源了哦. 如果你说实话的话, 我还可以考虑一下.”\n\nShlw 发现事情并不简单, 在金钱和信仰面前, 难以抉择.\n\n突然, Shlw 不理会河神, 自顾自的地跑走了.\n\n“唉, 现在的年轻人啊... 真不知道在想什么.”Pinkie Pie 感叹, 卸下了河神伪装.", "description": "Shlw 从河神给的选择中, 获得了一道当年挂掉的代数题的灵感.\n\n但现在他希望你来帮忙解答, 因为他自己忙着去搜小马资源去了.\n\n给出数列 $\\{a_n\\}$ 和 $\\{b_n\\}$ 以及 $\\{A_n\\}$ 的递推关系, 试求出数列 $\\{A_n\\}$ 第 $N$ 项.\n\n递推关系为:\n\n$$A_n=\\begin{cases}a_n  &  0 \\le n < K \\\\ \\bigoplus_{0 \\le t < K} (A_{n-K+t} \\otimes b_t) & n \\ge K \\end{cases}$$\n\n其中，$\\otimes$ 表示与操作，$\\oplus$ 表示或操作。", "inputFormat": "第一行两个正整数 $N$ 和 $K$ 。\n\n第二行 $K$ 个空格隔开的非负整数, 表示 $\\{a_n\\}$。\n\n第三行 $K$ 个空格隔开的非负整数, 表示 $\\{b_n\\}$。", "outputFormat": "一行, 一个整数, 表示$\\{A_n\\}$。", "hint": "【样例解释】\n\n从 $A_0$ 至 $A_{10}$ 分别为: $2, 3, 5, 7, 12, 15, 15, 13, 15, 15, 15$\n\n【数据约束】\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/16mwbo3z.png)\n\n【后记】\n\n后来, Pinkie Pie 偷偷来到 Shlw 家里, 她把这题拿回去考 Apple Jack, 于是 Apple Jack就有了狂吃苹果来畅游多重宇宙的本领.", "locale": "zh-CN"}}}
{"pid": "P5679", "type": "P", "difficulty": 5, "samples": [["3\n4\n4 3 2 1\n2\n1 100\n5\n1 17 9 18 17", "YES\nNO\nYES"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072]}, "tags": ["2017", "各省省选", "O2优化", "枚举", "贵州"], "title": "[GZOI2017] 等差子序列", "background": "GZOI2017 D2T2", "description": "给出一个长度为 $N$ 的正整数序列，问是否存在一个长度不小于三的等差子序列。", "inputFormat": "第一行一个正整数 $T$，表示数据组数。\n\n接下来 $T$ 组数据，每组数据第一行一个正整数 $N$，表示序列长度，接下来第二行有 $N$ 个正整数，依次表示序列中的数。", "outputFormat": "对于每组数据，输出单独的一行 `YES` 或 `NO`。", "hint": "【数据约束】\n\n对于 $20\\%$的数据：$N\\le 100$。\n\n对于 $40\\%$的数据：$N\\le 10^3$。\n\n对于 $100\\%$的数据：$1\\le T \\le 10$，$1\\le N\\le 2\\times 10^4$，序列中的数 $\\le 2\\times 10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "[GZOI2017] Arithmetic Progression Subsequence", "background": "GZOI2017 D2T2", "description": "Given a positive integer sequence of length $N$, determine whether there exists an arithmetic progression subsequence with length at least three.", "inputFormat": "The first line contains a positive integer $T$, indicating the number of test cases.\n\nThen follow $T$ test cases. For each test case, the first line contains a positive integer $N$, indicating the length of the sequence. The second line contains $N$ positive integers, in order, representing the numbers in the sequence.", "outputFormat": "For each test case, output a separate line containing `YES` or `NO`.", "hint": "Constraints\n\nFor $20\\%$ of the testdata: $N \\le 100$.\n\nFor $40\\%$ of the testdata: $N \\le 10^3$.\n\nFor $100\\%$ of the testdata: $1 \\le T \\le 10$, $1 \\le N \\le 2 \\times 10^4$, and each number in the sequence is $\\le 2 \\times 10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[GZOI2017] 等差子序列", "background": "GZOI2017 D2T2", "description": "给出一个长度为 $N$ 的正整数序列，问是否存在一个长度不小于三的等差子序列。", "inputFormat": "第一行一个正整数 $T$，表示数据组数。\n\n接下来 $T$ 组数据，每组数据第一行一个正整数 $N$，表示序列长度，接下来第二行有 $N$ 个正整数，依次表示序列中的数。", "outputFormat": "对于每组数据，输出单独的一行 `YES` 或 `NO`。", "hint": "【数据约束】\n\n对于 $20\\%$的数据：$N\\le 100$。\n\n对于 $40\\%$的数据：$N\\le 10^3$。\n\n对于 $100\\%$的数据：$1\\le T \\le 10$，$1\\le N\\le 2\\times 10^4$，序列中的数 $\\le 2\\times 10^4$。", "locale": "zh-CN"}}}
{"pid": "P5680", "type": "P", "difficulty": 6, "samples": [["6 6 1 4\n1 2 3\n2 3 2\n2 4 4\n3 6 4\n1 5 5\n5 6 3\n0 3 3 4 6\n1 3 4 5 6\n0 1 3\n1 4 3 4 5 6", "10\n6"], ["12 11 4 5\n4 1 32\n4 6 42\n1 3 29\n7 1 17\n7 10 23\n9 7 21\n5 6 16\n2 6 28\n5 8 14\n8 11 11\n8 12 17\n1 11 1 2 3 5 6 7 8 9 10 11 12\n0 4 3 11 5 2\n1 4 10 9 6 11\n0 4 7 8 12 11\n1 4 11 2 9 10", "-1\n41\n77"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["动态规划 DP", "2017", "各省省选", "树形 DP", "贵州", "虚树"], "title": "[GZOI2017] 共享单车", "background": "GZOI2017 D2T3", "description": "某校校内有 A 公司与 B 公司两家共享单车公司相互竞争。A 公司为了尽可能提升自己在校园内的占有率，会设法阻碍 B 公司的回收行动。\n\n整个校园由 $N$ 个区域和 $M$ 条道路组成，每条道路连接两个区域。校园有一个区域 $K$ 是 B 公司的大本营，所有的单车回收行动从该区域 **出发**。B 公司为了减少成本，回收时从区域 $K$ 到任何一个区域 $X$ 都选择长度 **最短** 的路径，如果有多条到某一个区域的最短路径，则选择所有最短路径中该区域的前一区域 **编号最小** 的一条路径，称这条路径为 $K$ 到 $X$ 的 **回收路线**。所有的 **回收路线** 组成一棵树状结构，称之为 **回收路线树**。如下图中，绿色的边构成的就是一棵 **回收路线树**。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x0cksrjz.png)\n\nB 公司每次会回收若干个区域的单车，称这些区域为 **回收区域**。B 公司还将某些区域设为 **投放区域**，称其余区域为 **非投放区域**。在 **回收路线树** 上，标记出区域 $K$，标记出所有的 **回收区域**，以及标记出任意两个 **回收区域** 在 **回收路线树** 上的最近公共祖先。\n\n如下图，假设 $4$ 与 $6$ 号区域是 **投放区域**，$4, 5, 6$ 号区域是**回收区域**，则被标记的区域有 $1, 4, 5, 6$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mdwo6dcn.png)\n\nA 公司对 B 公司的回收行动造成了阻碍，**当且仅当** 对任意一个 $K$ 以外的被标记的 **投放区域** $X$，从区域 $K$ 到 $X$ 的 **回收路线上** 都存在两个被标记的区域，它们之间 **所有道路**（回收路线树上两点路径）被阻碍。\n\n阻碍一条道路的代价为该道路的长度。上图中 A 公司选择阻碍 $1 \\rightsquigarrow  4$，$5 \\rightsquigarrow 6$ 两条路径，代价为 $3+4+3=10$。\n\n你的任务是帮助 A 公司计算如何以最小的代价，阻碍 B 公司的回收行动。", "inputFormat": "第一行四个整数 $N, M, K, Q$ 分别表示 X 校校园内区域数量、道路数量以及 B 公司大本营的编号 $K$ 和操作数量。\n\n第二到第 $M + 1$ 行描述道路，每行三个整数 $S,T,Len$ 表示有一条从 $S$ 出发 $T$ 结束的长度为 $Len$ 双向道路。\n\n接下来第 $M + 2$ 行到第 $M + Q + 1$ 行，每行第一个整数表示操作类型，$0$ 表示 B 公司会改变**投放区域**，$1$ 表示 B 公司的一次回收行动。\n\n操作类型为 $0$时，后接一个整数 $num$，表示 B 公司改变的区域数目，紧接着 $num$ 个数字分别表示区域编号。对于一个被改变的区域，如果它是 **投放区域**，把它改为 **非投放区域**；如果它是 **非投放区域**，把它改为 **投放区域**；\n\n操作类型为 $1$ 时，后接一个整数 $num$ 表示 **回收区域** 数目，紧接着 $num$ 个整数表示 B 公司的 **回收区域** 编号。每次需要在 **回收路线树** 上重新标记。", "outputFormat": "对于每一次回收行动，输出一行表示 A 公司对 B 公司造成阻碍的最小代价。注意，如果没有被标记的 **投放区域**，输出 $-1$。", "hint": "【数据约束】\n\n对于 $30\\%$ 的数据，$N\\le 200$，$Q\\le 200$；\n\n对于 $60\\%$ 的数据，保证每次 **回收区域** 数量恒为 $N-1$；\n\n对于 $80\\%$ 的数据，$N\\le 20000$，$M=N-1$，$Q\\le 1000$，$num\\le 200$；\n\n对于 $100\\%$ 的数据，$N\\le 50000$，$M\\le 100000$，$Q\\le 1500$，$num\\le 500$。\n\n所有数据保证道路无自环，所有道路长度小于 $2000$，且区域 $K$ 任意时刻均非**投放区域**。", "locale": "zh-CN", "translations": {"en": {"title": "[GZOI2017] Shared Bicycles", "background": "GZOI2017 D2T3", "description": "There are two shared bicycle companies, Company A and Company B, competing on a campus. To increase its market share on campus as much as possible, Company A will try to interfere with Company B’s recycling operations.\n\nThe whole campus consists of $N$ areas and $M$ roads, where each road connects two areas. There is an area $K$ that is Company B’s base. All recycling operations **start** from this area. To reduce costs, when recycling, for going from area $K$ to any area $X$, Company B always chooses a **shortest** path. If there are multiple shortest paths to some area, it chooses, among all shortest paths, the one whose previous area on the path has the **smallest index**. This path is called the **recycling route** from $K$ to $X$. All **recycling routes** form a tree structure, called the **recycling route tree**. In the figure below, the green edges form a **recycling route tree**.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x0cksrjz.png)\n\nEach time, Company B recycles bicycles from several areas; these areas are called **recycling areas**. Company B also designates some areas as **deployment areas**, and the remaining areas are called **non-deployment areas**. On the **recycling route tree**, mark area $K$, mark all **recycling areas**, and also mark the lowest common ancestor on the **recycling route tree** of any two **recycling areas**.\n\nIn the figure below, suppose areas $4$ and $6$ are **deployment areas**, and areas $4, 5, 6$ are **recycling areas**. Then the marked areas are $1, 4, 5, 6$.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mdwo6dcn.png)\n\nCompany A interferes with Company B’s recycling operation **if and only if** for every marked **deployment area** $X$ other than $K$, on the **recycling route** from area $K$ to $X$, there exist two marked areas such that **all roads** (the path between the two nodes on the recycling route tree) between them are blocked.\n\nThe cost to block a road is the length of that road. In the figure above, Company A chooses to block the two paths $1 \\rightsquigarrow 4$ and $5 \\rightsquigarrow 6$, and the cost is $3+4+3=10$.\n\nYour task is to help Company A compute how to block Company B’s recycling operation with the minimum total cost.", "inputFormat": "The first line contains four integers $N, M, K, Q$, representing the number of areas on campus, the number of roads, the index $K$ of Company B’s base, and the number of operations.\n\nLines $2$ to $M + 1$ describe the roads. Each line contains three integers $S, T, Len$, meaning there is an undirected road of length $Len$ between $S$ and $T$.\n\nThen, lines $M + 2$ to $M + Q + 1$ describe the operations. The first integer of each line indicates the operation type: $0$ means Company B changes the **deployment areas**, and $1$ means one recycling operation by Company B.\n\nFor an operation of type $0$, it is followed by an integer $num$, meaning the number of areas to be changed, and then $num$ integers giving the area indices. For each changed area, if it is a **deployment area**, change it to a **non-deployment area**; if it is a **non-deployment area**, change it to a **deployment area**.\n\nFor an operation of type $1$, it is followed by an integer $num$, meaning the number of **recycling areas**, and then $num$ integers giving the indices of Company B’s **recycling areas**. Each time, you need to remark nodes on the **recycling route tree**.", "outputFormat": "For each recycling operation, output one line with the minimum cost for Company A to interfere with Company B. Note that if there is no marked **deployment area**, output $-1$.", "hint": "【Constraints】\n\nFor $30\\%$ of the testdata, $N\\le 200$, $Q\\le 200$.\n\nFor $60\\%$ of the testdata, it is guaranteed that in each operation, the number of **recycling areas** is always $N-1$.\n\nFor $80\\%$ of the testdata, $N\\le 20000$, $M=N-1$, $Q\\le 1000$, $num\\le 200$.\n\nFor $100\\%$ of the testdata, $N\\le 50000$, $M\\le 100000$, $Q\\le 1500$, $num\\le 500$.\n\nAll testdata guarantee that there are no self-loops. All road lengths are less than $2000$, and area $K$ is never a **deployment area** at any time.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[GZOI2017] 共享单车", "background": "GZOI2017 D2T3", "description": "某校校内有 A 公司与 B 公司两家共享单车公司相互竞争。A 公司为了尽可能提升自己在校园内的占有率，会设法阻碍 B 公司的回收行动。\n\n整个校园由 $N$ 个区域和 $M$ 条道路组成，每条道路连接两个区域。校园有一个区域 $K$ 是 B 公司的大本营，所有的单车回收行动从该区域 **出发**。B 公司为了减少成本，回收时从区域 $K$ 到任何一个区域 $X$ 都选择长度 **最短** 的路径，如果有多条到某一个区域的最短路径，则选择所有最短路径中该区域的前一区域 **编号最小** 的一条路径，称这条路径为 $K$ 到 $X$ 的 **回收路线**。所有的 **回收路线** 组成一棵树状结构，称之为 **回收路线树**。如下图中，绿色的边构成的就是一棵 **回收路线树**。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/x0cksrjz.png)\n\nB 公司每次会回收若干个区域的单车，称这些区域为 **回收区域**。B 公司还将某些区域设为 **投放区域**，称其余区域为 **非投放区域**。在 **回收路线树** 上，标记出区域 $K$，标记出所有的 **回收区域**，以及标记出任意两个 **回收区域** 在 **回收路线树** 上的最近公共祖先。\n\n如下图，假设 $4$ 与 $6$ 号区域是 **投放区域**，$4, 5, 6$ 号区域是**回收区域**，则被标记的区域有 $1, 4, 5, 6$。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mdwo6dcn.png)\n\nA 公司对 B 公司的回收行动造成了阻碍，**当且仅当** 对任意一个 $K$ 以外的被标记的 **投放区域** $X$，从区域 $K$ 到 $X$ 的 **回收路线上** 都存在两个被标记的区域，它们之间 **所有道路**（回收路线树上两点路径）被阻碍。\n\n阻碍一条道路的代价为该道路的长度。上图中 A 公司选择阻碍 $1 \\rightsquigarrow  4$，$5 \\rightsquigarrow 6$ 两条路径，代价为 $3+4+3=10$。\n\n你的任务是帮助 A 公司计算如何以最小的代价，阻碍 B 公司的回收行动。", "inputFormat": "第一行四个整数 $N, M, K, Q$ 分别表示 X 校校园内区域数量、道路数量以及 B 公司大本营的编号 $K$ 和操作数量。\n\n第二到第 $M + 1$ 行描述道路，每行三个整数 $S,T,Len$ 表示有一条从 $S$ 出发 $T$ 结束的长度为 $Len$ 双向道路。\n\n接下来第 $M + 2$ 行到第 $M + Q + 1$ 行，每行第一个整数表示操作类型，$0$ 表示 B 公司会改变**投放区域**，$1$ 表示 B 公司的一次回收行动。\n\n操作类型为 $0$时，后接一个整数 $num$，表示 B 公司改变的区域数目，紧接着 $num$ 个数字分别表示区域编号。对于一个被改变的区域，如果它是 **投放区域**，把它改为 **非投放区域**；如果它是 **非投放区域**，把它改为 **投放区域**；\n\n操作类型为 $1$ 时，后接一个整数 $num$ 表示 **回收区域** 数目，紧接着 $num$ 个整数表示 B 公司的 **回收区域** 编号。每次需要在 **回收路线树** 上重新标记。", "outputFormat": "对于每一次回收行动，输出一行表示 A 公司对 B 公司造成阻碍的最小代价。注意，如果没有被标记的 **投放区域**，输出 $-1$。", "hint": "【数据约束】\n\n对于 $30\\%$ 的数据，$N\\le 200$，$Q\\le 200$；\n\n对于 $60\\%$ 的数据，保证每次 **回收区域** 数量恒为 $N-1$；\n\n对于 $80\\%$ 的数据，$N\\le 20000$，$M=N-1$，$Q\\le 1000$，$num\\le 200$；\n\n对于 $100\\%$ 的数据，$N\\le 50000$，$M\\le 100000$，$Q\\le 1500$，$num\\le 500$。\n\n所有数据保证道路无自环，所有道路长度小于 $2000$，且区域 $K$ 任意时刻均非**投放区域**。", "locale": "zh-CN"}}}
{"pid": "P5681", "type": "P", "difficulty": 1, "samples": [["5 4 6", "Alice"], ["7 5 10", "Bob"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2019", "江西", "CSP-J 入门级"], "title": "[CSP-J 2019 江西] 面积", "background": "", "description": "Alice 有一个边长为 $a$ 的正方形，Bob 有一个长宽分别为 $b,c$ 的矩形，请你告诉他们俩谁的图形面积更大。", "inputFormat": "仅一行三个正整数 $a,b,c$", "outputFormat": "输出仅一行一个字符串，若正方形面积大则输出 `Alice`，否则输出 `Bob`。", "hint": "【数据范围】   \n对于 $30\\%$ 的数据，$1 \\le a,b,c \\le 100$，$b=c$；  \n对于 $80\\%$ 的数据，$1\\le a,b,c \\le 10^4$；  \n对于 $100\\%$ 的数据，$1\\le a,b,c \\le 10^9$。\n\n【样例 $1$ 解释】  \n正方形面积为  $25$，矩形面积为 $24$。  \n\n【样例 $2$ 解释】  \n正方形面积为  $49$，矩形面积为 $50$。  ", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-J 2019 Jiangxi] Area", "background": "", "description": "Alice has a square with side length $a$, and Bob has a rectangle with length and width $b, c$. Please tell them whose shape has a larger area.", "inputFormat": "Only one line with three positive integers $a, b, c$.", "outputFormat": "Output only one line with a string. If the square’s area is larger, output `Alice`; otherwise, output `Bob`.", "hint": "【Constraints】  \nFor $30\\%$ of the testdata, $1 \\le a, b, c \\le 100$, and $b = c$;  \nFor $80\\%$ of the testdata, $1 \\le a, b, c \\le 10^4$;  \nFor $100\\%$ of the testdata, $1 \\le a, b, c \\le 10^9$.\n\n【Sample $1$ Explanation】  \nThe square’s area is $25$, and the rectangle’s area is $24$.\n\n【Sample $2$ Explanation】  \nThe square’s area is $49$, and the rectangle’s area is $50$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-J 2019 江西] 面积", "background": "", "description": "Alice 有一个边长为 $a$ 的正方形，Bob 有一个长宽分别为 $b,c$ 的矩形，请你告诉他们俩谁的图形面积更大。", "inputFormat": "仅一行三个正整数 $a,b,c$", "outputFormat": "输出仅一行一个字符串，若正方形面积大则输出 `Alice`，否则输出 `Bob`。", "hint": "【数据范围】   \n对于 $30\\%$ 的数据，$1 \\le a,b,c \\le 100$，$b=c$；  \n对于 $80\\%$ 的数据，$1\\le a,b,c \\le 10^4$；  \n对于 $100\\%$ 的数据，$1\\le a,b,c \\le 10^9$。\n\n【样例 $1$ 解释】  \n正方形面积为  $25$，矩形面积为 $24$。  \n\n【样例 $2$ 解释】  \n正方形面积为  $49$，矩形面积为 $50$。  ", "locale": "zh-CN"}}}
{"pid": "P5682", "type": "P", "difficulty": 3, "samples": [["4\n4 5 5 6", "4"], ["4\n1 1 1 1", "-1"], ["7\n12 3 8 5 7 20 15", "12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2019", "排序", "江西", "CSP-J 入门级"], "title": "[CSP-J 2019 江西] 次大值", "background": "", "description": "Alice 有 $n$ 个正整数，数字从 $1 \\sim n$ 编号，分别为 $a_1,a_2, \\dots , a_n$。  \nBob 刚学习取模运算，于是便拿这 $n$ 个数进行练习，他写下了所有 \n\n$$a_i \\bmod a_j (1 \\le i,j \\le n \\wedge i \\neq j)$$  \n\n的值，其中 $\\bmod$ 表示取模运算。  \n\nAlice 想知道所有的结果中，严格次大值是多少。将取模后得到的所有值进行去重，即相同的结果数值只保留一个，剩余数中第二大的值就称为严格次大值。", "inputFormat": "第一行一个正整数 $n$，表示数字个数。  \n第二行 $n$ 个正整数表示 $a_i$。", "outputFormat": "仅一行一个整数表示答案。  \n若取模结果去重后剩余数字不足两个，则输出 $-1$。", "hint": "【数据范围】  \n对于 $40\\%$ 的数据，$1\\le n,a_i \\le 100$；  \n对于 $70\\%$ 的数据，$1\\le n \\le 3000$，$1\\le a_i \\le 10^5$；  \n对于 $100\\%$ 的数据，$3 \\le n \\le 2\\times 10^5$，$1\\le a_i \\le 10^9$。\n\n【样例 $1$ 解释】  \n所有取模的结果为 $\\{4,4,4,1,0,5,1,0,5,2,1,1\\}$。  \n去重后有：$\\{0,1,2,4,5 \\}$，结果为 $4$。", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-J 2019 Jiangxi] Second Largest Value", "background": "", "description": "Alice has $n$ positive integers, numbered from $1 \\sim n$, which are $a_1, a_2, \\dots, a_n$.  \nBob has just learned the modulo operation, so he uses these $n$ numbers to practice. He wrote down all values of\n\n$$a_i \\bmod a_j (1 \\le i,j \\le n \\wedge i \\neq j)$$\n\nwhere $\\bmod$ denotes the modulo operation.\n\nAlice wants to know the strict second largest value among all results. Deduplicate all values obtained after modulo, meaning that identical results are kept only once. The second largest value among the remaining numbers is called the strict second largest value.", "inputFormat": "The first line contains a positive integer $n$, representing the number of integers.  \nThe second line contains $n$ positive integers $a_i$.", "outputFormat": "Output one integer in a single line, representing the answer.  \nIf there are fewer than two numbers left after deduplicating the modulo results, output $-1$.", "hint": "【Constraints】  \nFor $40\\%$ of the testdata, $1 \\le n, a_i \\le 100$;  \nFor $70\\%$ of the testdata, $1 \\le n \\le 3000$, $1 \\le a_i \\le 10^5$;  \nFor $100\\%$ of the testdata, $3 \\le n \\le 2 \\times 10^5$, $1 \\le a_i \\le 10^9$.\n\n【Sample $1$ Explanation】  \nAll modulo results are $\\{4,4,4,1,0,5,1,0,5,2,1,1\\}$.  \nAfter deduplication, we have $\\{0,1,2,4,5\\}$, so the result is $4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-J 2019 江西] 次大值", "background": "", "description": "Alice 有 $n$ 个正整数，数字从 $1 \\sim n$ 编号，分别为 $a_1,a_2, \\dots , a_n$。  \nBob 刚学习取模运算，于是便拿这 $n$ 个数进行练习，他写下了所有 \n\n$$a_i \\bmod a_j (1 \\le i,j \\le n \\wedge i \\neq j)$$  \n\n的值，其中 $\\bmod$ 表示取模运算。  \n\nAlice 想知道所有的结果中，严格次大值是多少。将取模后得到的所有值进行去重，即相同的结果数值只保留一个，剩余数中第二大的值就称为严格次大值。", "inputFormat": "第一行一个正整数 $n$，表示数字个数。  \n第二行 $n$ 个正整数表示 $a_i$。", "outputFormat": "仅一行一个整数表示答案。  \n若取模结果去重后剩余数字不足两个，则输出 $-1$。", "hint": "【数据范围】  \n对于 $40\\%$ 的数据，$1\\le n,a_i \\le 100$；  \n对于 $70\\%$ 的数据，$1\\le n \\le 3000$，$1\\le a_i \\le 10^5$；  \n对于 $100\\%$ 的数据，$3 \\le n \\le 2\\times 10^5$，$1\\le a_i \\le 10^9$。\n\n【样例 $1$ 解释】  \n所有取模的结果为 $\\{4,4,4,1,0,5,1,0,5,2,1,1\\}$。  \n去重后有：$\\{0,1,2,4,5 \\}$，结果为 $4$。", "locale": "zh-CN"}}}
{"pid": "P5683", "type": "P", "difficulty": 4, "samples": [["5 6\n1 2\n2 3\n1 3\n3 4\n4 5\n3 5\n5 3 4 3", "3"], ["3 2\n1 2\n2 3\n2 2 3 1", "-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "广度优先搜索 BFS", "最短路", "江西", "CSP-J 入门级"], "title": "[CSP-J 2019 江西] 道路拆除", "background": "", "description": "A 国有 $n$ 座城市，从 $1 \\sim n$ 编号。$1$ 号城市是 A 国的首都。城市间由 $m$ 条双向道路连通，通过每一条道路所花费的时间均为 $1$ 单位时间。  \n\n现在 A 国打算拆除一些不实用的道路以减小维护的开支，但 A 国也需要保证主要线路不受影响。因此 A 国希望道路拆除完毕后，利用剩余未被拆除的道路，从 A 国首都出发，能到达 $s_1$ 号与 $s_2$ 号城市，且所要花费的最短时间分别不超过 $t_1$ 与 $t_2$（注意这是两个独立的条件，互相之间没有关联，即不需要先到 $s_1$ 再到 $s_2$）。\n\nA 国想请你帮他们算算，在满足上述条件的情况下，他们最多能拆除多少条道路。 若上述条件永远无法满足，则输出 $-1$。", "inputFormat": "第一行两个正整数 $n,m$，表示城市数与道路数。  \n\n接下来 $m$ 行，每行两个正整数 $x,y$，表示一条连接 $x$ 号点与 $y$ 号点的道路。\n\n最后一行四个整数，分别为 $s_1,t_1,s_2,t_2$。", "outputFormat": "仅一行一个整数，表示答案。", "hint": "【数据范围】  \n对于 $30\\%$ 的数据，$n,m \\le 15$；   \n另有 $20\\%$ 的数据，$n \\le 100$，$m = n-1$；   \n另有 $30\\%$ 的数据，$s_1 = s_2$；  \n对于 $100\\%$ 的数据，$2 \\le n,m \\le 3000$，$1\\le x,y \\le n$，$2 \\le s_1,s_2 \\le n$，$0 \\le t_1,t_2 \\le n$。  \n\n【样例 $1$ 解释】  \n拆除 $(1,2),(2,3),(3,4)$ 三条边。  \n注意：不需要令首都与除了 $s_1,s_2$ 外的点在拆除之后依然连通。\n\n【样例 $2$ 解释】  \n即使一条边都不拆除，首都到 $3$ 号点的最短时间也都达到了 $2$ 单位时间。\n\ntestdata by @DYH060310 ", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-J 2019 Jiangxi] Road Removal", "background": "", "description": "Country A has $n$ cities, numbered from $1 \\sim n$. City $1$ is the capital of Country A. The cities are connected by $m$ undirected roads, and the time to travel along each road is $1$ unit of time.\n\nNow Country A plans to remove some impractical roads to reduce maintenance costs, but it also needs to ensure that the main routes are not affected. Therefore, after the road removals, using the remaining roads, starting from the capital of Country A, it must be possible to reach city $s_1$ and city $s_2$, and the shortest times required must be no more than $t_1$ and $t_2$, respectively (note that these are two independent conditions with no relation to each other; that is, you do not need to go to $s_1$ first and then to $s_2$).\n\nCountry A asks you to compute, under the above conditions, the maximum number of roads that can be removed. If the above conditions can never be satisfied, output $-1$.", "inputFormat": "The first line contains two positive integers $n, m$, representing the number of cities and the number of roads.\n\nThe next $m$ lines each contain two positive integers $x, y$, representing a road connecting node $x$ and node $y$.\n\nThe last line contains four integers, which are $s_1, t_1, s_2, t_2$.", "outputFormat": "Only one line containing one integer, representing the answer.", "hint": "Constraints  \nFor $30\\%$ of the testdata, $n, m \\le 15$.  \nFor another $20\\%$ of the testdata, $n \\le 100$ and $m = n - 1$.  \nFor another $30\\%$ of the testdata, $s_1 = s_2$.  \nFor $100\\%$ of the testdata, $2 \\le n, m \\le 3000$, $1 \\le x, y \\le n$, $2 \\le s_1, s_2 \\le n$, $0 \\le t_1, t_2 \\le n$.\n\nExplanation of Sample $1$  \nRemove three edges: $(1,2)$, $(2,3)$, $(3,4)$.  \nNote: It is not necessary to keep the capital connected to nodes other than $s_1, s_2$ after the removal.\n\nExplanation of Sample $2$  \nEven if not a single edge is removed, the shortest time from the capital to node $3$ is already $2$ units of time.\n\ntestdata by @DYH060310\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-J 2019 江西] 道路拆除", "background": "", "description": "A 国有 $n$ 座城市，从 $1 \\sim n$ 编号。$1$ 号城市是 A 国的首都。城市间由 $m$ 条双向道路连通，通过每一条道路所花费的时间均为 $1$ 单位时间。  \n\n现在 A 国打算拆除一些不实用的道路以减小维护的开支，但 A 国也需要保证主要线路不受影响。因此 A 国希望道路拆除完毕后，利用剩余未被拆除的道路，从 A 国首都出发，能到达 $s_1$ 号与 $s_2$ 号城市，且所要花费的最短时间分别不超过 $t_1$ 与 $t_2$（注意这是两个独立的条件，互相之间没有关联，即不需要先到 $s_1$ 再到 $s_2$）。\n\nA 国想请你帮他们算算，在满足上述条件的情况下，他们最多能拆除多少条道路。 若上述条件永远无法满足，则输出 $-1$。", "inputFormat": "第一行两个正整数 $n,m$，表示城市数与道路数。  \n\n接下来 $m$ 行，每行两个正整数 $x,y$，表示一条连接 $x$ 号点与 $y$ 号点的道路。\n\n最后一行四个整数，分别为 $s_1,t_1,s_2,t_2$。", "outputFormat": "仅一行一个整数，表示答案。", "hint": "【数据范围】  \n对于 $30\\%$ 的数据，$n,m \\le 15$；   \n另有 $20\\%$ 的数据，$n \\le 100$，$m = n-1$；   \n另有 $30\\%$ 的数据，$s_1 = s_2$；  \n对于 $100\\%$ 的数据，$2 \\le n,m \\le 3000$，$1\\le x,y \\le n$，$2 \\le s_1,s_2 \\le n$，$0 \\le t_1,t_2 \\le n$。  \n\n【样例 $1$ 解释】  \n拆除 $(1,2),(2,3),(3,4)$ 三条边。  \n注意：不需要令首都与除了 $s_1,s_2$ 外的点在拆除之后依然连通。\n\n【样例 $2$ 解释】  \n即使一条边都不拆除，首都到 $3$ 号点的最短时间也都达到了 $2$ 单位时间。\n\ntestdata by @DYH060310 ", "locale": "zh-CN"}}}
{"pid": "P5684", "type": "P", "difficulty": 4, "samples": [["3\naba", "4"], ["8\naabbbbcc", "39168"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2019", "江西", "组合数学", "CSP-J 入门级"], "title": "[CSP-J 2019 江西] 非回文串", "background": "", "description": "Alice 有 $n$ 个字符，它们都是英文小写字母，从 $1 \\sim n$ 编号，分别为 $c_1,c_2, \\dots , c_n$。  \nBob 准备将这些字符重新排列，组成一个字符串 $S$。Bob 知道 Alice 有强迫症，所以他打算将 $S$ 组成一个非回文串来折磨 Alice。  \n\n现在 Bob 想知道他共有多少种不同的排列字符的方案，能使得 $S$ 是个非回文串。一种排列字符的方案指的是一个 $1 \\sim n$ 的排列 $p_i$，它所组成的 $S = c_{p_1}c_{p_2} \\dots c_{p_n}$。\n\n一个字符串是非回文串，当且仅当它的逆序串与原串不同。例如 `abcda` 的逆序串为 `adcba`，与原串不同，故 `abcda` 是非回文串。而 `abcba` 的逆序串与原串相同，是回文串。\n\n由于最后的结果可能很大，你只需要告诉 Bob 总方案数对 $10^9+7$ 取模后的值。", "inputFormat": "第一行一个正整数 $n$ 表示字符个数。   \n第二行 $n$ 个英文小写字母 $c_i$。", "outputFormat": "仅一行一个整数表示答案。答案对 $10^9+7$ 取模。", "hint": "【数据范围】  \n对于 $20\\%$ 的数据，$n \\le 8$；  \n对于 $50\\%$ 的数据，$n \\le 20$；  \n另有 $30\\%$ 的数据，字符只包含 `a` 和 `b`；  \n对于 $100\\%$ 的数据，$3 \\le n \\le 2000$。", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-J 2019 Jiangxi] Non-palindromic String", "background": "", "description": "Alice has $n$ characters, all of which are lowercase English letters, numbered from $1 \\sim n$, namely $c_1,c_2, \\dots , c_n$.  \nBob plans to rearrange these characters to form a string $S$. Bob knows that Alice has OCD, so he plans to make $S$ a non-palindromic string to annoy Alice.\n\nNow Bob wants to know how many different ways of rearranging the characters there are such that $S$ is a non-palindromic string. A rearrangement plan means a permutation $p_i$ of $1 \\sim n$, and it forms $S = c_{p_1}c_{p_2} \\dots c_{p_n}$.\n\nA string is non-palindromic if and only if its reversed string is different from the original string. For example, the reversed string of `abcda` is `adcba`, which is different from the original string, so `abcda` is a non-palindromic string. However, the reversed string of `abcba` is the same as the original string, so it is a palindromic string.\n\nSince the final result may be very large, you only need to tell Bob the value of the total number of plans modulo $10^9+7$.", "inputFormat": "The first line contains a positive integer $n$, which represents the number of characters.  \nThe second line contains $n$ lowercase English letters $c_i$.", "outputFormat": "Only one line containing an integer representing the answer. The answer is taken modulo $10^9+7$.", "hint": "Constraints  \nFor $20\\%$ of the testdata, $n \\le 8$;  \nFor $50\\%$ of the testdata, $n \\le 20$;  \nFor the other $30\\%$ of the testdata, the characters only include `a` and `b`;  \nFor $100\\%$ of the testdata, $3 \\le n \\le 2000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-J 2019 江西] 非回文串", "background": "", "description": "Alice 有 $n$ 个字符，它们都是英文小写字母，从 $1 \\sim n$ 编号，分别为 $c_1,c_2, \\dots , c_n$。  \nBob 准备将这些字符重新排列，组成一个字符串 $S$。Bob 知道 Alice 有强迫症，所以他打算将 $S$ 组成一个非回文串来折磨 Alice。  \n\n现在 Bob 想知道他共有多少种不同的排列字符的方案，能使得 $S$ 是个非回文串。一种排列字符的方案指的是一个 $1 \\sim n$ 的排列 $p_i$，它所组成的 $S = c_{p_1}c_{p_2} \\dots c_{p_n}$。\n\n一个字符串是非回文串，当且仅当它的逆序串与原串不同。例如 `abcda` 的逆序串为 `adcba`，与原串不同，故 `abcda` 是非回文串。而 `abcba` 的逆序串与原串相同，是回文串。\n\n由于最后的结果可能很大，你只需要告诉 Bob 总方案数对 $10^9+7$ 取模后的值。", "inputFormat": "第一行一个正整数 $n$ 表示字符个数。   \n第二行 $n$ 个英文小写字母 $c_i$。", "outputFormat": "仅一行一个整数表示答案。答案对 $10^9+7$ 取模。", "hint": "【数据范围】  \n对于 $20\\%$ 的数据，$n \\le 8$；  \n对于 $50\\%$ 的数据，$n \\le 20$；  \n另有 $30\\%$ 的数据，字符只包含 `a` 和 `b`；  \n对于 $100\\%$ 的数据，$3 \\le n \\le 2000$。", "locale": "zh-CN"}}}
{"pid": "P5685", "type": "P", "difficulty": 6, "samples": [["PUPPY\nPUPPUP\n", "17"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "2013", "各省省选", "江苏", "后缀自动机 SAM", "回文自动机 PAM"], "title": "[JSOI2013] 快乐的 JYY", "background": "JYY 在 JSOI 有很多很多的好朋友，比如 PUPPY，KFC 还有 PUPPUP 。因为\n有了这么多的好朋友，所以 JYY 每天都很快乐。某天，JYY 发现好朋友之间关\n系的好坏和名字有很大的关系，比如 PUPPY 和 PUPPUP 的关系就特别好，但是和 KFC 的关系就很一般。JYY 苦思冥想终于发现了其中的规律，现在 JYY 想知道两个朋友之间关系的好坏，你能帮助 JYY 么？", "description": "给定两个字符串 $A$ 和 $B$，表示 JYY 的两个朋友的名字。我们用 $A(i,\\,j)$ 表示 $A$ \n字符串中从第 $i$ 个字母到第 $j$ 个字母所组成的子串。同样的，我们也可以定义 $B(x,\\,y)$ 。\n\nJYY 发现两个朋友关系的紧密程度，等于同时满足如下条件的四元组 $(i,\\,j,\\,x,\\,y)$\n的个数：\n1. $1\\leq i\\leq j\\leq |A|$\n2. $1\\leq x\\leq y\\leq |B|$\n3. $A(i,\\,j)=B(x,\\,y)$\n4. $A(i,\\,j)$ 是回文串\n\n$|A|$ 表示字符串 $A$ 的长度。\n\nJYY 希望你帮助他计算出这两个朋友之间关系的紧密程度。", "inputFormat": "数据包行两行由大写字母组成的字符串 $A$ 和 $B$ 。\n", "outputFormat": "包含一行一个整数，表示紧密程度，也就是满足要求的 $4$ 元组个数", "hint": "$1\\leq |A|,\\,|B|\\leq 50000$", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2013] Happy JYY", "background": "JYY has many, many good friends in JSOI, such as PUPPY, KFC, and PUPPUP. With so many friends, JYY is happy every day. One day, JYY found that how well friends get along is closely related to their names. For example, PUPPY and PUPPUP get along especially well, but their relationship with KFC is just average. After thinking hard for a long time, JYY finally discovered the pattern. Now JYY wants to know how close the relationship is between two friends. Can you help JYY?", "description": "Given two strings $A$ and $B$, representing the names of two of JYY's friends. Let $A(i,\\,j)$ denote the substring of $A$ formed by the $i$-th letter through the $j$-th letter. Similarly, we define $B(x,\\,y)$.\n\nJYY found that the closeness of the relationship between two friends is equal to the number of quadruples $(i,\\,j,\\,x,\\,y)$ that satisfy all of the following conditions:\n1. $1\\leq i\\leq j\\leq |A|$.\n2. $1\\leq x\\leq y\\leq |B|$.\n3. $A(i,\\,j)=B(x,\\,y)$.\n4. $A(i,\\,j)$ is a palindrome string.\n\nHere, $|A|$ denotes the length of string $A$.\n\nJYY hopes you can help him compute the closeness of the relationship between these two friends.", "inputFormat": "The input consists of two lines, each containing a string $A$ and $B$ made up of uppercase letters.", "outputFormat": "Output one line containing one integer, representing the closeness, i.e., the number of valid quadruples.", "hint": "Constraints: $1\\leq |A|,\\,|B|\\leq 50000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2013] 快乐的 JYY", "background": "JYY 在 JSOI 有很多很多的好朋友，比如 PUPPY，KFC 还有 PUPPUP 。因为\n有了这么多的好朋友，所以 JYY 每天都很快乐。某天，JYY 发现好朋友之间关\n系的好坏和名字有很大的关系，比如 PUPPY 和 PUPPUP 的关系就特别好，但是和 KFC 的关系就很一般。JYY 苦思冥想终于发现了其中的规律，现在 JYY 想知道两个朋友之间关系的好坏，你能帮助 JYY 么？", "description": "给定两个字符串 $A$ 和 $B$，表示 JYY 的两个朋友的名字。我们用 $A(i,\\,j)$ 表示 $A$ \n字符串中从第 $i$ 个字母到第 $j$ 个字母所组成的子串。同样的，我们也可以定义 $B(x,\\,y)$ 。\n\nJYY 发现两个朋友关系的紧密程度，等于同时满足如下条件的四元组 $(i,\\,j,\\,x,\\,y)$\n的个数：\n1. $1\\leq i\\leq j\\leq |A|$\n2. $1\\leq x\\leq y\\leq |B|$\n3. $A(i,\\,j)=B(x,\\,y)$\n4. $A(i,\\,j)$ 是回文串\n\n$|A|$ 表示字符串 $A$ 的长度。\n\nJYY 希望你帮助他计算出这两个朋友之间关系的紧密程度。", "inputFormat": "数据包行两行由大写字母组成的字符串 $A$ 和 $B$ 。\n", "outputFormat": "包含一行一个整数，表示紧密程度，也就是满足要求的 $4$ 元组个数", "hint": "$1\\leq |A|,\\,|B|\\leq 50000$", "locale": "zh-CN"}}}
{"pid": "P5686", "type": "P", "difficulty": 3, "samples": [["3\n2 3 4\n3 4 5", "244"], ["5\n11 22 33 44 55\n12 34 56 78 90", "201542"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "递推", "2019", "数论", "江西", "前缀和", "CSP-S 提高级"], "title": "[CSP-S 2019 江西] 和积和", "background": "JXCSP-S T2", "description": "给定两个下标从 $1$ 到 $n$ 编号的序列 $a_i,b_i$，定义函数 $S(l,r)(1\\le l\\le r\\le n)$ 为：\n\n$$\\sum_{i=l}^r a_i\\times \\sum_{i=l}^r b_i$$\n\n请你求出下列式子的值：\n\n$$\\sum_{l=1}^n \\sum_{r=l}^n S(l,r)$$\n\n由于答案可能很大，你只需要给出答案模 $10^9+7$ 后的结果。", "inputFormat": "第一行一个正整数 $n$ 表示序列长度。  \n第二行 $n$ 个正整数表示 $a_i$。  \n第三行 $n$ 个正整数表示 $b_i$。", "outputFormat": "仅一行一个整数表示答案模 $10^9+7$  后的结果。", "hint": "【数据范围】   \n对于 $20\\%$  的数据：$n\\le 10$ , $a_i,b_i\\le 10$；   \n对于 $40\\%$  的数据：$n\\le 200$ , $a_i,b_i\\le 100$；    \n对于 $70\\%$  的数据：$n\\le 3000$ , $a_i,b_i\\le 10^5$；    \n对于 $100\\%$  的数据：$3\\le n\\le 5\\times 10^5$ , $1\\le a_i,b_i\\le 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-S 2019 Jiangxi] Sum of Product of Sums.", "background": "JXCSP-S T2", "description": "Given two sequences $a_i, b_i$ indexed from $1$ to $n$, define the function $S(l, r)$ $(1 \\le l \\le r \\le n)$ as:\n\n$$\\sum_{i=l}^r a_i \\times \\sum_{i=l}^r b_i$$\n\nPlease compute the value of the following expression:\n\n$$\\sum_{l=1}^n \\sum_{r=l}^n S(l,r)$$\n\nSince the answer may be very large, you only need to output the result modulo $10^9 + 7$.", "inputFormat": "The first line contains a positive integer $n$ indicating the length of the sequences.  \nThe second line contains $n$ positive integers representing $a_i$.  \nThe third line contains $n$ positive integers representing $b_i$.", "outputFormat": "Output a single integer, the result modulo $10^9 + 7$.", "hint": "Constraints  \nFor $20\\%$ of the testdata: $n \\le 10$, $a_i, b_i \\le 10$.  \nFor $40\\%$ of the testdata: $n \\le 200$, $a_i, b_i \\le 100$.  \nFor $70\\%$ of the testdata: $n \\le 3000$, $a_i, b_i \\le 10^5$.  \nFor $100\\%$ of the testdata: $3 \\le n \\le 5 \\times 10^5$, $1 \\le a_i, b_i \\le 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-S 2019 江西] 和积和", "background": "JXCSP-S T2", "description": "给定两个下标从 $1$ 到 $n$ 编号的序列 $a_i,b_i$，定义函数 $S(l,r)(1\\le l\\le r\\le n)$ 为：\n\n$$\\sum_{i=l}^r a_i\\times \\sum_{i=l}^r b_i$$\n\n请你求出下列式子的值：\n\n$$\\sum_{l=1}^n \\sum_{r=l}^n S(l,r)$$\n\n由于答案可能很大，你只需要给出答案模 $10^9+7$ 后的结果。", "inputFormat": "第一行一个正整数 $n$ 表示序列长度。  \n第二行 $n$ 个正整数表示 $a_i$。  \n第三行 $n$ 个正整数表示 $b_i$。", "outputFormat": "仅一行一个整数表示答案模 $10^9+7$  后的结果。", "hint": "【数据范围】   \n对于 $20\\%$  的数据：$n\\le 10$ , $a_i,b_i\\le 10$；   \n对于 $40\\%$  的数据：$n\\le 200$ , $a_i,b_i\\le 100$；    \n对于 $70\\%$  的数据：$n\\le 3000$ , $a_i,b_i\\le 10^5$；    \n对于 $100\\%$  的数据：$3\\le n\\le 5\\times 10^5$ , $1\\le a_i,b_i\\le 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5687", "type": "P", "difficulty": 4, "samples": [["3 3\n2 4 3\n1 3 2", "16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2019", "江西", "生成树", "CSP-S 提高级"], "title": "[CSP-S 2019 江西] 网格图", "background": "JXCSP-S T3", "description": "给定一个 $n\\times m$ 的网格图，行从 $1\\sim n$ 编号，列从 $1\\sim m$ 编号，每个点可用它所在的行编号 $r$ 与所在的列编号 $c$ 表示为 $(r, c)$。\n\n点 $(i,j)$ 与 $(i,j+1)$ 间连有一条权值为 $a_i$ 的边，其中 $1\\le i\\le n, 1\\le j<m$。\n\n点 $(i, j)$ 与 $(i+1,j)$ 间连有一条权值为 $b_j$ 的边，其中 $1\\le i< n, 1\\le j \\le m$。\n\n请你求出这个网格图的最小生成树。", "inputFormat": "第一行两个正整数 $n, m$ 表示行数与列数。\n\n第二行 $n$ 个正整数表示 $a_i$。\n\n第三行 $m$ 个正整数表示 $b_j$。", "outputFormat": "仅一行一个整数表示答案。", "hint": "#### 【输入输出样例 1 说明】\n最小生成树中的边包括：第一行上的所有边，第一列、第二列、第三列上的所有边。\n\n#### 【数据规模与约定】\n\n对于 $20\\%$ 的数据，$n, m\\le 3$，$a_i, b_j \\le 10$；\n\n对于 $40\\%$ 的数据，$n, m\\le 20$，$a_i, b_j\\le 100$；\n\n对于 $64\\%$ 的数据，$n, m\\le 300$，$a_i, b_j\\le 1000$；\n\n对于 $100\\%$ 的数据：$3\\le n, m \\le 3\\times 10^5$，$1 \\le a_i, b_j\\le 10^5$。 ", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-S 2019 Jiangxi] Grid Graph", "background": "JXCSP-S T3", "description": "Given an $n\\times m$ grid graph, rows are numbered from $1\\sim n$ and columns are numbered from $1\\sim m$. Each point can be represented by its row number $r$ and column number $c$ as $(r, c)$.\n\nThere is an edge with weight $a_i$ between points $(i,j)$ and $(i,j+1)$, where $1\\le i\\le n, 1\\le j<m$.\n\nThere is an edge with weight $b_j$ between points $(i, j)$ and $(i+1,j)$, where $1\\le i< n, 1\\le j \\le m$.\n\nPlease find the minimum spanning tree of this grid graph.", "inputFormat": "The first line contains two positive integers $n, m$, representing the number of rows and columns.\n\nThe second line contains $n$ positive integers, representing $a_i$.\n\nThe third line contains $m$ positive integers, representing $b_j$.", "outputFormat": "Output a single integer in one line, representing the answer.", "hint": "#### Explanation of Sample Input/Output 1\nThe edges in the minimum spanning tree include: all edges in the first row, and all edges in the first, second, and third columns.\n\n#### Constraints\n\nFor $20\\%$ of the testdata, $n, m\\le 3$, $a_i, b_j \\le 10$.\n\nFor $40\\%$ of the testdata, $n, m\\le 20$, $a_i, b_j\\le 100$.\n\nFor $64\\%$ of the testdata, $n, m\\le 300$, $a_i, b_j\\le 1000$.\n\nFor $100\\%$ of the testdata, $3\\le n, m \\le 3\\times 10^5$, $1 \\le a_i, b_j\\le 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-S 2019 江西] 网格图", "background": "JXCSP-S T3", "description": "给定一个 $n\\times m$ 的网格图，行从 $1\\sim n$ 编号，列从 $1\\sim m$ 编号，每个点可用它所在的行编号 $r$ 与所在的列编号 $c$ 表示为 $(r, c)$。\n\n点 $(i,j)$ 与 $(i,j+1)$ 间连有一条权值为 $a_i$ 的边，其中 $1\\le i\\le n, 1\\le j<m$。\n\n点 $(i, j)$ 与 $(i+1,j)$ 间连有一条权值为 $b_j$ 的边，其中 $1\\le i< n, 1\\le j \\le m$。\n\n请你求出这个网格图的最小生成树。", "inputFormat": "第一行两个正整数 $n, m$ 表示行数与列数。\n\n第二行 $n$ 个正整数表示 $a_i$。\n\n第三行 $m$ 个正整数表示 $b_j$。", "outputFormat": "仅一行一个整数表示答案。", "hint": "#### 【输入输出样例 1 说明】\n最小生成树中的边包括：第一行上的所有边，第一列、第二列、第三列上的所有边。\n\n#### 【数据规模与约定】\n\n对于 $20\\%$ 的数据，$n, m\\le 3$，$a_i, b_j \\le 10$；\n\n对于 $40\\%$ 的数据，$n, m\\le 20$，$a_i, b_j\\le 100$；\n\n对于 $64\\%$ 的数据，$n, m\\le 300$，$a_i, b_j\\le 1000$；\n\n对于 $100\\%$ 的数据：$3\\le n, m \\le 3\\times 10^5$，$1 \\le a_i, b_j\\le 10^5$。 ", "locale": "zh-CN"}}}
{"pid": "P5688", "type": "P", "difficulty": 6, "samples": [["3 2 5\n2\n2 1\n0 1\n1 3\n0 4", "3"], ["3 2 5\n2 \n1 1\n0 0 \n0 2 \n0 1", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["搜索", "2019", "线段树", "江西", "CSP-S 提高级"], "title": "[CSP-S 2019 江西] 散步", "background": "JXCSP-S T4", "description": "公园内有 $n$ 个人正在散步，随着天色渐晚，所有人准备回家离开公园。公园的结构是一个首尾相连的环形图，它共有 $m$ 个出口，为了方便叙述，我们将人从 $1\\sim n$ 编号，将出口按逆时针顺序从 $1\\sim m$ 编号。\n\n公园总长 $L$ 米，我们令 $1$ 号出口所在的位置为 $0$ 米，则 编号为 $i\\ (2\\le i\\le m)$ 的出口在 $1$ 号出口逆时针方向 $a_i$ 米的位置上，其中 $a_i$ 严格递增 ，即 $i\\ (1\\le i < m)$ 号出口与 $i+1$ 号出口相邻，由于公园是环形图，故 $m$ 号出口与 $1$ 号出口也相邻。每个出口还有一个通行限制 $l_i$，表示最多有 $l_i$ 个人能从 $i$ 号出口离开。\n\n所有人回家时将按自己的朝向，可能是顺时针方向，也可能是逆时针方向不断前行，当他们走到一个还能离开的出口时，将从该出口离开公园。特别地，当两个人同时走到一个只能允许 $1$ 个人离开的出口时，编号小的那个人能从该出口离开，编号较大的人将继续前进。\n\n现在给定 $n$ 个人所在的起始位置与他们的前进方向，请你求出每个人从哪个出口离开，若编号为 $i$ 的 人从 $k_i$ 号出口离开，你只需要给出 $i\\times k_i$ 的异或和，即：\n\n$$ (1\\times k_1) \\operatorname{xor} (2\\times k_2) \\operatorname{xor}\\cdots \\operatorname{xor} (n\\times k_n) $$\n\n其中 $\\operatorname{xor}$ 是位异或运算。特别地若一个人最后无法离开，则他的 $k_i = 0$。", "inputFormat": "第一行三个正整数 $n, m, L$，意义见题目描述。\n\n第二行 $m - 1$ 个正整数 $a_i\\ (2\\le i \\le m)$ 表示出口位置。保证 $a_i$ 严格递增。\n\n第三行 $m$ 个正整数 $l_i$ 表示出口的人数限制。\n\n接下来 $n$ 行每行两个整数 $s_i,b_i\\ (1 \\le i \\le n)$。若 $s_i$ 为 $0$ 表示编号为 $i$ 的人前进方向是逆时针方向，为 $1$ 表示是顺时针方向。 $b_i$ 表示编号为 $i$ 的人的起始位置为：离 $1$ 号出口逆时针方向 $b_i$ 米的位置。", "outputFormat": "仅一行一个整数表示答案。", "hint": "#### 【输入输出样例 1 说明】\n编号为 $1 ,2, 3$ 的人分别从 $2, 1, 1$ 号出口离开。\n\n#### 【输入输出样例 2 说明】\n编号为 $1,2$ 的人分别从 $1 ,2$ 号出口离开，编号为 $3$ 的人无法离开公园。\n\n#### 【数据规模与约定】\n对于 $12\\%$ 的数据：$n, m, L \\le 10$；   \n\n对于 $32\\%$ 的数据：$n, m \\le 100$，$L \\le 1000$；\n\n对于 $52\\%$ 的数据：$n, m \\le 1000$；  \n\n另有 $20\\%$ 的数据：$n, m \\le 10000$，所有 $s_i = 0$；   \n\n对于 $100\\%$ 的数据：$1 \\le n,m \\le 2 \\times 10^5 $，$2 \\le L \\le 10^9$，$1\\le a_i <L$，$1\\le l_i \\le n$，$s_i\\in\\{0,1\\}$，$0\\le b_i<L$。", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-S 2019 Jiangxi] Walking", "background": "JXCSP-S T4", "description": "There are $n$ people taking a walk in a park. As it gets late, everyone is ready to go home and leave the park. The park is a circular graph (a ring) with $m$ exits. For convenience, we number the people from $1$ to $n$, and number the exits from $1$ to $m$ in counterclockwise order.\n\nThe total length of the park is $L$ meters. We define the position of exit $1$ as $0$ meters. Then for exit $i\\ (2\\le i\\le m)$, it is located $a_i$ meters counterclockwise from exit $1$. The sequence $a_i$ is strictly increasing, so exits $i\\ (1\\le i < m)$ and $i+1$ are adjacent. Since the park is a ring, exit $m$ and exit $1$ are also adjacent. Each exit also has a capacity limit $l_i$, meaning that at most $l_i$ people can leave through exit $i$.\n\nWhen going home, each person will keep moving in their own direction, either clockwise or counterclockwise. When they reach an exit that still allows someone to leave, they will leave the park through that exit. In particular, if two people arrive at an exit that can allow only $1$ person to leave at the same time, the person with the smaller index leaves through that exit, and the person with the larger index continues moving.\n\nNow you are given the initial position and moving direction of each of the $n$ people. Please determine which exit each person leaves from. If person $i$ leaves from exit $k_i$, you only need to output the XOR sum of $i\\times k_i$, that is:\n\n$$ (1\\times k_1) \\operatorname{xor} (2\\times k_2) \\operatorname{xor}\\cdots \\operatorname{xor} (n\\times k_n) $$\n\nwhere $\\operatorname{xor}$ is the bitwise XOR operation. In particular, if a person cannot leave in the end, then $k_i = 0$.", "inputFormat": "The first line contains three positive integers $n, m, L$, as described above.\n\nThe second line contains $m - 1$ positive integers $a_i\\ (2\\le i \\le m)$, representing the exit positions. It is guaranteed that $a_i$ is strictly increasing.\n\nThe third line contains $m$ positive integers $l_i$, representing the capacity limit of each exit.\n\nThe next $n$ lines each contain two integers $s_i, b_i\\ (1 \\le i \\le n)$. If $s_i$ is $0$, it means person $i$ moves counterclockwise; if $s_i$ is $1$, it means person $i$ moves clockwise. $b_i$ means the starting position of person $i$ is the point $b_i$ meters counterclockwise from exit $1$.", "outputFormat": "Output one integer in a single line, representing the answer.", "hint": "#### Explanation of Sample 1\nPeople $1, 2, 3$ leave through exits $2, 1, 1$, respectively.\n\n#### Explanation of Sample 2\nPeople $1, 2$ leave through exits $1, 2$, respectively, and person $3$ cannot leave the park.\n\n#### Constraints\nFor $12\\%$ of the testdata: $n, m, L \\le 10$.\n\nFor $32\\%$ of the testdata: $n, m \\le 100$, $L \\le 1000$.\n\nFor $52\\%$ of the testdata: $n, m \\le 1000$.\n\nFor another $20\\%$ of the testdata: $n, m \\le 10000$, and all $s_i = 0$.\n\nFor $100\\%$ of the testdata: $1 \\le n,m \\le 2 \\times 10^5$, $2 \\le L \\le 10^9$, $1\\le a_i < L$, $1\\le l_i \\le n$, $s_i\\in\\{0,1\\}$, $0\\le b_i < L$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-S 2019 江西] 散步", "background": "JXCSP-S T4", "description": "公园内有 $n$ 个人正在散步，随着天色渐晚，所有人准备回家离开公园。公园的结构是一个首尾相连的环形图，它共有 $m$ 个出口，为了方便叙述，我们将人从 $1\\sim n$ 编号，将出口按逆时针顺序从 $1\\sim m$ 编号。\n\n公园总长 $L$ 米，我们令 $1$ 号出口所在的位置为 $0$ 米，则 编号为 $i\\ (2\\le i\\le m)$ 的出口在 $1$ 号出口逆时针方向 $a_i$ 米的位置上，其中 $a_i$ 严格递增 ，即 $i\\ (1\\le i < m)$ 号出口与 $i+1$ 号出口相邻，由于公园是环形图，故 $m$ 号出口与 $1$ 号出口也相邻。每个出口还有一个通行限制 $l_i$，表示最多有 $l_i$ 个人能从 $i$ 号出口离开。\n\n所有人回家时将按自己的朝向，可能是顺时针方向，也可能是逆时针方向不断前行，当他们走到一个还能离开的出口时，将从该出口离开公园。特别地，当两个人同时走到一个只能允许 $1$ 个人离开的出口时，编号小的那个人能从该出口离开，编号较大的人将继续前进。\n\n现在给定 $n$ 个人所在的起始位置与他们的前进方向，请你求出每个人从哪个出口离开，若编号为 $i$ 的 人从 $k_i$ 号出口离开，你只需要给出 $i\\times k_i$ 的异或和，即：\n\n$$ (1\\times k_1) \\operatorname{xor} (2\\times k_2) \\operatorname{xor}\\cdots \\operatorname{xor} (n\\times k_n) $$\n\n其中 $\\operatorname{xor}$ 是位异或运算。特别地若一个人最后无法离开，则他的 $k_i = 0$。", "inputFormat": "第一行三个正整数 $n, m, L$，意义见题目描述。\n\n第二行 $m - 1$ 个正整数 $a_i\\ (2\\le i \\le m)$ 表示出口位置。保证 $a_i$ 严格递增。\n\n第三行 $m$ 个正整数 $l_i$ 表示出口的人数限制。\n\n接下来 $n$ 行每行两个整数 $s_i,b_i\\ (1 \\le i \\le n)$。若 $s_i$ 为 $0$ 表示编号为 $i$ 的人前进方向是逆时针方向，为 $1$ 表示是顺时针方向。 $b_i$ 表示编号为 $i$ 的人的起始位置为：离 $1$ 号出口逆时针方向 $b_i$ 米的位置。", "outputFormat": "仅一行一个整数表示答案。", "hint": "#### 【输入输出样例 1 说明】\n编号为 $1 ,2, 3$ 的人分别从 $2, 1, 1$ 号出口离开。\n\n#### 【输入输出样例 2 说明】\n编号为 $1,2$ 的人分别从 $1 ,2$ 号出口离开，编号为 $3$ 的人无法离开公园。\n\n#### 【数据规模与约定】\n对于 $12\\%$ 的数据：$n, m, L \\le 10$；   \n\n对于 $32\\%$ 的数据：$n, m \\le 100$，$L \\le 1000$；\n\n对于 $52\\%$ 的数据：$n, m \\le 1000$；  \n\n另有 $20\\%$ 的数据：$n, m \\le 10000$，所有 $s_i = 0$；   \n\n对于 $100\\%$ 的数据：$1 \\le n,m \\le 2 \\times 10^5 $，$2 \\le L \\le 10^9$，$1\\le a_i <L$，$1\\le l_i \\le n$，$s_i\\in\\{0,1\\}$，$0\\le b_i<L$。", "locale": "zh-CN"}}}
{"pid": "P5689", "type": "P", "difficulty": 4, "samples": [["5 6\n1 1 0\n1 2 0\n2 1\n1 3 1\n1 2 0\n2 4", "2\n8\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "并查集", "江西", "组合数学", "逆元", "CSP-S 提高级"], "title": "[CSP-S 2019 江西] 多叉堆", "background": "JXCSP-S T5", "description": "多叉堆是一种树形数据结构，本题中我们只考虑小根堆，它满足除了根以外的结点，每个点的权值都不小于父亲的权值。除了叶结点，每个点有至少一个子结点。\n\n初始时有 $n$ 个结点，编号分别为 $0 \\sim n - 1$，每个结点都是一棵以自身为根的单点树。接下来按顺序有 $q$ 次操作，每次操作有以下两种：\n\n* `1 x y`：选择不在同一棵树里的结点 $x$ 和 $y$，将 $x$ 所在树的根直接接在 $y$ 所在树的根之下，此时 $x$ 和 $y$ 所在树将合并为同一棵树。\n\n* `2 x`：选择结点 $x$，设 $x$ 当前所在树的结点数为 $size$。你需要计算将 $0 \\sim size - 1$ 这 $size$ 个数分别填入 $x$ 所在树的结点中，能够产生多少种不同的多叉堆。两种堆不同当且仅当存在某个结点填入的值不同。由于答案可能很大，你只需要求出答案模 $10^9+7$ 后的结果。", "inputFormat": "第一行两个整数 $n,q$，具体含义见题目描述。\n\n接下来 $q$ 行每行可能是下面两种格式之一：\n\n* `1 x' y'`：你需要通过计算 $x=(x'+ans) \\bmod n , y=(y'+ans) \\bmod n$ 来得到真正的 $x$ 和 $y$，输入保证 $x$ 和 $y$ 所在树不同。\n\n* `2 x'`：你需要通过计算 $x=(x'+ans) \\bmod n$ 来得到真正的 $x$。\n\n其中 $ans$ 表示上一次 $2$ 操作的输出结果，初始时 $ans=0$。", "outputFormat": "对于每次 $2$ 操作输出一行一个整数表示答案。", "hint": "#### 【输入输出样例 1 说明】\n\n第 $1$ 次操作时，将 $1$ 所在树的根 $1$ 接在 $0$ 所在树的根 $0$ 下。 \n\n第 $2$ 次操作时，将 $2$ 所在树的根 $2$ 接在 $0$ 所在树的根 $0$ 下。   \n\n第 $3$ 次操作时，$1$ 所在树如图 $1$，在 $0,1,2$ 中分别填入 $[0,1,2]$ 和 $[0,2,1]$ 可以产生 $2$ 种不同的堆。    \n\n第 $4$ 次操作时 $x=(3+2) \\bmod 5=0$，$y=(1+2) \\bmod 5=3$，将 $0$ 所在树的根 $0$ 接在 $3$ 所在树的根 $3$ 下。   \n\n第 $5$ 次操作 时，$x=(2+2) \\bmod 5=4$，$y=(0+2) \\bmod 5=2$，将 $4$ 所在树的根 $4$ 接在 $2$ 所在树的根 $3$ 下。    \n\n第 $6$ 次操作 时，$x=(4+2) \\bmod 5=1$，$1$ 所在树如图 $2$，在 $0\\sim 4$ 中分别填入 $[1,2,3,0,4]$，$[1,3,2,0,4]$，$[1,2,4,0,3]$，$[1,4,2,0,3]$，$[1,3,4,0,2]$，$[1,4,3,0,2]$，$[2,4,3,0,1]$，$[2,3,4,0,1]$ 可以产生 $8$ 种不同的堆。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mqsr3nri.png)\n\n#### 【数据规模与约定】\n\n对于 $100\\%$ 的数据，$0\\le x',y' <n \\le 3\\times 10^5$，$1\\le q\\le 3\\times 10^5$。\n\n对于不同测试点，我们约定\n\n::cute-table{tuack}\n\n\n|测试点编号|$n\\le$|$q\\le$|特殊性质 $1$|特殊性质 $2$|\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$10$|$20$|是|否|\n|$2$|^|^|否|是|\n|$3$|^|^|^|否|\n|$4$|^|^|^|^|\n|$5$|$300$|$600$|是|^|\n|$6$|^|^|否|是|\n|$7$|^|^|^|否|\n|$8$|$2000$|$4000$|是|^|\n|$9$|^|^|否|是|\n|$10$|^|^|^|否|\n|$11$|$5\\times10^4$|$10^5$|是|^|\n|$12$|^|^|否|是|\n|$13$|^|^|^|否|\n|$14$|^|^|^|^|\n|$15$|^|^|^|^|\n|$16$|$3\\times10^5$|$3\\times10^5$|是|^|\n|$17$|^|^|否|是|\n|$18$|^|^|^|否|\n|$19$|^|^|^|^|\n|$20$|^|^|^|^|\n\n\n特殊性质 $1$：存在 $1\\le i<n $，前 $i$ 次操作均为 $1$ 操作，之后全是 $2$ 操作。\n\n特殊性质 $2$：对于所有输入 $x$ 和 $y$ 本身即是其所在树的根。\n\n感谢 @Fairicle 提供的数据。", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-S 2019 Jiangxi] D-ary Heap", "background": "JXCSP-S T5.", "description": "A d-ary heap is a tree-structured data structure. In this problem, we only consider the min-heap, which satisfies that for every node except the root, the weight of the node is not less than the weight of its parent. Except for leaf nodes, every node has at least one child.\n\nInitially, there are $n$ nodes, numbered $0 \\sim n - 1$. Each node is a single-node tree rooted at itself. Then there are $q$ operations in order, and each operation is one of the following two types:\n\n* `1 x y`: Choose nodes $x$ and $y$ that are not in the same tree. Attach the root of the tree containing $x$ directly under the root of the tree containing $y$. Then the trees containing $x$ and $y$ merge into one tree.\n\n* `2 x`: Choose a node $x$, and let the number of nodes in the tree containing $x$ be $size$. You need to compute how many different d-ary heaps can be produced by filling the $size$ numbers $0 \\sim size - 1$ into the nodes of the tree containing $x$. Two heaps are different if and only if there exists a node whose filled value is different. Since the answer may be very large, you only need to output the result modulo $10^9+7$.", "inputFormat": "The first line contains two integers $n,q$, whose meanings are described above.\n\nIn the next $q$ lines, each line is in one of the following formats:\n\n* `1 x' y'`: You need to compute $x=(x'+ans) \\bmod n , y=(y'+ans) \\bmod n$ to get the actual $x$ and $y$. The input guarantees that the trees containing $x$ and $y$ are different.\n\n* `2 x'`: You need to compute $x=(x'+ans) \\bmod n$ to get the actual $x$.\n\nHere, $ans$ denotes the output of the previous type $2$ operation, and initially $ans=0$.", "outputFormat": "For each type $2$ operation, output one line with one integer representing the answer.", "hint": "#### Sample 1 Explanation\n\nIn the 1st operation, attach the root $1$ of the tree containing $1$ under the root $0$ of the tree containing $0$.\n\nIn the 2nd operation, attach the root $2$ of the tree containing $2$ under the root $0$ of the tree containing $0$.\n\nIn the 3rd operation, the tree containing $1$ is shown in Figure 1. Filling $0,1,2$ with $[0,1,2]$ and $[0,2,1]$ can produce $2$ different heaps.\n\nIn the 4th operation, $x=(3+2) \\bmod 5=0$, $y=(1+2) \\bmod 5=3$. Attach the root $0$ of the tree containing $0$ under the root $3$ of the tree containing $3$.\n\nIn the 5th operation, $x=(2+2) \\bmod 5=4$, $y=(0+2) \\bmod 5=2$. Attach the root $4$ of the tree containing $4$ under the root $3$ of the tree containing $2$.\n\nIn the 6th operation, $x=(4+2) \\bmod 5=1$. The tree containing $1$ is shown in Figure 2. Filling $0\\sim 4$ with $[1,2,3,0,4]$, $[1,3,2,0,4]$, $[1,2,4,0,3]$, $[1,4,2,0,3]$, $[1,3,4,0,2]$, $[1,4,3,0,2]$, $[2,4,3,0,1]$, $[2,3,4,0,1]$ can produce $8$ different heaps.\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mqsr3nri.png)\n\n#### Constraints and Conventions\n\nFor $100\\%$ of the data, $0\\le x',y' <n \\le 3\\times 10^5$, $1\\le q\\le 3\\times 10^5$.\n\nFor different test points, we define:\n\n::cute-table{tuack}\n\n\n|Test Point ID|$n\\le$|$q\\le$|Special Property $1$|Special Property $2$|\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$10$|$20$|Yes|No|\n|$2$|^|^|No|Yes|\n|$3$|^|^|^|No|\n|$4$|^|^|^|^|\n|$5$|$300$|$600$|Yes|^|\n|$6$|^|^|No|Yes|\n|$7$|^|^|^|No|\n|$8$|$2000$|$4000$|Yes|^|\n|$9$|^|^|No|Yes|\n|$10$|^|^|^|No|\n|$11$|$5\\times10^4$|$10^5$|Yes|^|\n|$12$|^|^|No|Yes|\n|$13$|^|^|^|No|\n|$14$|^|^|^|^|\n|$15$|^|^|^|^|\n|$16$|$3\\times10^5$|$3\\times10^5$|Yes|^|\n|$17$|^|^|No|Yes|\n|$18$|^|^|^|No|\n|$19$|^|^|^|^|\n|$20$|^|^|^|^|\n\nSpecial Property $1$: There exists $1\\le i<n $, such that the first $i$ operations are all type $1$ operations, and all the remaining operations are type $2$ operations.\n\nSpecial Property $2$: For all inputs, $x$ and $y$ themselves are the roots of their respective trees.\n\nThanks to @Fairicle for providing the testdata.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-S 2019 江西] 多叉堆", "background": "JXCSP-S T5", "description": "多叉堆是一种树形数据结构，本题中我们只考虑小根堆，它满足除了根以外的结点，每个点的权值都不小于父亲的权值。除了叶结点，每个点有至少一个子结点。\n\n初始时有 $n$ 个结点，编号分别为 $0 \\sim n - 1$，每个结点都是一棵以自身为根的单点树。接下来按顺序有 $q$ 次操作，每次操作有以下两种：\n\n* `1 x y`：选择不在同一棵树里的结点 $x$ 和 $y$，将 $x$ 所在树的根直接接在 $y$ 所在树的根之下，此时 $x$ 和 $y$ 所在树将合并为同一棵树。\n\n* `2 x`：选择结点 $x$，设 $x$ 当前所在树的结点数为 $size$。你需要计算将 $0 \\sim size - 1$ 这 $size$ 个数分别填入 $x$ 所在树的结点中，能够产生多少种不同的多叉堆。两种堆不同当且仅当存在某个结点填入的值不同。由于答案可能很大，你只需要求出答案模 $10^9+7$ 后的结果。", "inputFormat": "第一行两个整数 $n,q$，具体含义见题目描述。\n\n接下来 $q$ 行每行可能是下面两种格式之一：\n\n* `1 x' y'`：你需要通过计算 $x=(x'+ans) \\bmod n , y=(y'+ans) \\bmod n$ 来得到真正的 $x$ 和 $y$，输入保证 $x$ 和 $y$ 所在树不同。\n\n* `2 x'`：你需要通过计算 $x=(x'+ans) \\bmod n$ 来得到真正的 $x$。\n\n其中 $ans$ 表示上一次 $2$ 操作的输出结果，初始时 $ans=0$。", "outputFormat": "对于每次 $2$ 操作输出一行一个整数表示答案。", "hint": "#### 【输入输出样例 1 说明】\n\n第 $1$ 次操作时，将 $1$ 所在树的根 $1$ 接在 $0$ 所在树的根 $0$ 下。 \n\n第 $2$ 次操作时，将 $2$ 所在树的根 $2$ 接在 $0$ 所在树的根 $0$ 下。   \n\n第 $3$ 次操作时，$1$ 所在树如图 $1$，在 $0,1,2$ 中分别填入 $[0,1,2]$ 和 $[0,2,1]$ 可以产生 $2$ 种不同的堆。    \n\n第 $4$ 次操作时 $x=(3+2) \\bmod 5=0$，$y=(1+2) \\bmod 5=3$，将 $0$ 所在树的根 $0$ 接在 $3$ 所在树的根 $3$ 下。   \n\n第 $5$ 次操作 时，$x=(2+2) \\bmod 5=4$，$y=(0+2) \\bmod 5=2$，将 $4$ 所在树的根 $4$ 接在 $2$ 所在树的根 $3$ 下。    \n\n第 $6$ 次操作 时，$x=(4+2) \\bmod 5=1$，$1$ 所在树如图 $2$，在 $0\\sim 4$ 中分别填入 $[1,2,3,0,4]$，$[1,3,2,0,4]$，$[1,2,4,0,3]$，$[1,4,2,0,3]$，$[1,3,4,0,2]$，$[1,4,3,0,2]$，$[2,4,3,0,1]$，$[2,3,4,0,1]$ 可以产生 $8$ 种不同的堆。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mqsr3nri.png)\n\n#### 【数据规模与约定】\n\n对于 $100\\%$ 的数据，$0\\le x',y' <n \\le 3\\times 10^5$，$1\\le q\\le 3\\times 10^5$。\n\n对于不同测试点，我们约定\n\n::cute-table{tuack}\n\n\n|测试点编号|$n\\le$|$q\\le$|特殊性质 $1$|特殊性质 $2$|\n|:-:|:-:|:-:|:-:|:-:|\n|$1$|$10$|$20$|是|否|\n|$2$|^|^|否|是|\n|$3$|^|^|^|否|\n|$4$|^|^|^|^|\n|$5$|$300$|$600$|是|^|\n|$6$|^|^|否|是|\n|$7$|^|^|^|否|\n|$8$|$2000$|$4000$|是|^|\n|$9$|^|^|否|是|\n|$10$|^|^|^|否|\n|$11$|$5\\times10^4$|$10^5$|是|^|\n|$12$|^|^|否|是|\n|$13$|^|^|^|否|\n|$14$|^|^|^|^|\n|$15$|^|^|^|^|\n|$16$|$3\\times10^5$|$3\\times10^5$|是|^|\n|$17$|^|^|否|是|\n|$18$|^|^|^|否|\n|$19$|^|^|^|^|\n|$20$|^|^|^|^|\n\n\n特殊性质 $1$：存在 $1\\le i<n $，前 $i$ 次操作均为 $1$ 操作，之后全是 $2$ 操作。\n\n特殊性质 $2$：对于所有输入 $x$ 和 $y$ 本身即是其所在树的根。\n\n感谢 @Fairicle 提供的数据。", "locale": "zh-CN"}}}
{"pid": "P5690", "type": "P", "difficulty": 2, "samples": [["03-32", "1"], ["02-39", "1"], ["67-89", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["贪心", "2019", "枚举", "江西", "CSP-S 提高级", "分类讨论"], "title": "[CSP-S 2019 江西] 日期", "background": "CSP-SJX2019 T1", "description": "Alice 在纸上写下了一个日期，形式为 $\\text{MM-DD}$，其中 $\\text{MM}$ 与 $\\text{DD}$ 都是两位数字，分别表示月和天，然而这个日期并不一定存在。 Alice 找来了 Bob 要他更改若干位上的数字，使得这个日期存在。请你帮 Bob 算算他最少需要更改几位数字。\n\n本题中我们认为 $2$ 月固定为 $28$ 天。", "inputFormat": "仅一行一个五个字符的字符串，表示 $\\text{MM-DD}$ 。", "outputFormat": "仅一行一个整数，表示答案。", "hint": "【输入输出样例 1 说明】\n\n更改方式不止一种，其中一种方式是改为： $\\text{03-22}$。\n\n【输入输出样例 2 说明】\n\n一种更改方式为：$\\text{02-09}$。\n\n【输入输出样例 3 说明】\n\n一种更改方式为：$\\text{07-09}$。\n\n【数据规模与约定】\n对于 $100\\%$ 的数据：$\\text{MM}$ 与 $\\text{DD}$ 一定为 $4$ 个数字。\n\n**update: 2024/07/04 增加 hack 一组。**", "locale": "zh-CN", "translations": {"en": {"title": "[CSP-S 2019 Jiangxi] Date", "background": "CSP-SJX2019 T1", "description": "Alice wrote a date on paper in the form $\\text{MM-DD}$, where $\\text{MM}$ and $\\text{DD}$ are both two-digit numbers representing the month and the day, respectively. However, this date may not actually exist. Alice asked Bob to change the digits in some positions so that the date becomes valid. Please help Bob compute the minimum number of digits he needs to change.\n\nIn this problem, February is fixed to have $28$ days.", "inputFormat": "A single line containing a string of five characters, representing $\\text{MM-DD}$.", "outputFormat": "A single line containing one integer, representing the answer.", "hint": "[Explanation for Sample Input/Output 1]\n\nThere is more than one way to change it. One possible result is: $\\text{03-22}$.\n\n[Explanation for Sample Input/Output 2]\n\nOne possible result is: $\\text{02-09}$.\n\n[Explanation for Sample Input/Output 3]\n\nOne possible result is: $\\text{07-09}$.\n\n[Constraints]\n\nFor $100\\%$ of the testdata, $\\text{MM}$ and $\\text{DD}$ are guaranteed to be $4$ digits.\n\n**update: 2024/07/04 Added one hack case.**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CSP-S 2019 江西] 日期", "background": "CSP-SJX2019 T1", "description": "Alice 在纸上写下了一个日期，形式为 $\\text{MM-DD}$，其中 $\\text{MM}$ 与 $\\text{DD}$ 都是两位数字，分别表示月和天，然而这个日期并不一定存在。 Alice 找来了 Bob 要他更改若干位上的数字，使得这个日期存在。请你帮 Bob 算算他最少需要更改几位数字。\n\n本题中我们认为 $2$ 月固定为 $28$ 天。", "inputFormat": "仅一行一个五个字符的字符串，表示 $\\text{MM-DD}$ 。", "outputFormat": "仅一行一个整数，表示答案。", "hint": "【输入输出样例 1 说明】\n\n更改方式不止一种，其中一种方式是改为： $\\text{03-22}$。\n\n【输入输出样例 2 说明】\n\n一种更改方式为：$\\text{02-09}$。\n\n【输入输出样例 3 说明】\n\n一种更改方式为：$\\text{07-09}$。\n\n【数据规模与约定】\n对于 $100\\%$ 的数据：$\\text{MM}$ 与 $\\text{DD}$ 一定为 $4$ 个数字。\n\n**update: 2024/07/04 增加 hack 一组。**", "locale": "zh-CN"}}}
{"pid": "P5691", "type": "P", "difficulty": 4, "samples": [["3\n150\n1 2\n-1 2\n1 2", "178"]], "limits": {"time": [6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "2001", "NOI", "折半搜索 meet in the middle"], "title": "[NOI2001] 方程的解数", "background": null, "description": "已知一个 $n$ 元高次方程：         \n$$\\sum\\limits_{i=1}^n k_ix_i^{p_i} = 0$$\n其中：$x_1, x_2, \\dots ,x_n$ 是未知数，$k_1,k_2, \\dots ,k_n$ 是系数，$p_1,p_2,…p_n$ 是指数。且方程中的所有数均为整数。\n\n假设未知数 $x_i \\in [1,m] \\space ( i \\in [1,n])$，求这个方程的整数解的个数。", "inputFormat": "第一行一个正整数 $n$，表示未知数个数。  \n第二行一个正整数 $m$。\n接下来 $n$ 行，每行两个整数 $k_i,p_i$。", "outputFormat": "输出一行一个整数，表示方程解的个数。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le n \\le 6$，$1\\le m \\le 150$，且\n$$\\sum\\limits_{i=1}^n |k_im^{p_i}| < 2^{31}$$  \n答案不超过 $2^{31}-1$，$p_i \\in \\mathbb N^*\\cap[0,2^{31})$。", "locale": "zh-CN", "translations": {"en": {"title": "[NOI2001] Number of Solutions of an Equation", "background": "", "description": "Given an $n$-variable higher-degree equation:\n$$\\sum\\limits_{i=1}^n k_ix_i^{p_i} = 0$$\nwhere $x_1, x_2, \\dots, x_n$ are the unknowns, $k_1, k_2, \\dots, k_n$ are the coefficients, and $p_1, p_2, \\dots, p_n$ are the exponents. All numbers in the equation are integers.\n\nAssume the unknowns satisfy $x_i \\in [1,m] \\space ( i \\in [1,n])$. Find the number of integer solutions to this equation.", "inputFormat": "The first line contains a positive integer $n$, the number of unknowns.  \nThe second line contains a positive integer $m$.  \nThe next $n$ lines each contain two integers $k_i, p_i$.", "outputFormat": "Output one line with one integer, the number of solutions of the equation.", "hint": "**【Constraints】**\n\nFor $100\\%$ of the testdata, $1\\le n \\le 6$, $1\\le m \\le 150$, and\n$$\\sum\\limits_{i=1}^n |k_im^{p_i}| < 2^{31}$$  \nThe answer does not exceed $2^{31}-1$, and $p_i \\in \\mathbb N^*\\cap[0,2^{31})$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[NOI2001] 方程的解数", "background": null, "description": "已知一个 $n$ 元高次方程：         \n$$\\sum\\limits_{i=1}^n k_ix_i^{p_i} = 0$$\n其中：$x_1, x_2, \\dots ,x_n$ 是未知数，$k_1,k_2, \\dots ,k_n$ 是系数，$p_1,p_2,…p_n$ 是指数。且方程中的所有数均为整数。\n\n假设未知数 $x_i \\in [1,m] \\space ( i \\in [1,n])$，求这个方程的整数解的个数。", "inputFormat": "第一行一个正整数 $n$，表示未知数个数。  \n第二行一个正整数 $m$。\n接下来 $n$ 行，每行两个整数 $k_i,p_i$。", "outputFormat": "输出一行一个整数，表示方程解的个数。", "hint": "**【数据范围】**\n\n对于 $100\\%$ 的数据，$1\\le n \\le 6$，$1\\le m \\le 150$，且\n$$\\sum\\limits_{i=1}^n |k_im^{p_i}| < 2^{31}$$  \n答案不超过 $2^{31}-1$，$p_i \\in \\mathbb N^*\\cap[0,2^{31})$。", "locale": "zh-CN"}}}
