{"pid": "P4924", "type": "P", "difficulty": 2, "samples": [["5 4\n2 2 1 0\n3 3 1 1\n4 4 1 0\n3 3 2 1", "5 10 3 18 15\n4 19 8 17 20\n1 14 23 24 25\n6 9 2 7 22\n11 12 13 16 21"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "递归", "枚举", "洛谷月赛"], "title": "[1007] 魔法少女小Scarlet", "background": null, "description": "Scarlet 最近学会了一个数组魔法，她会在 $n\\times n$ 二维数组上将一个奇数阶方阵按照顺时针或者逆时针旋转 $90^\\circ$。\n\n首先，Scarlet 会把 $1$ 到 $n^2$ 的正整数按照从左往右，从上至下的顺序填入初始的二维数组中，然后她会施放一些简易的魔法。\n\nScarlet 既不会什么分块特技，也不会什么 Splay 套 Splay，她现在提供给你她的魔法执行顺序，想让你来告诉她魔法按次执行完毕后的二维数组。", "inputFormat": "第一行两个整数 $n,m$，表示方阵大小和魔法施放次数。\n\n接下来 $m$ 行，每行 $4$ 个整数 $x,y,r,z$，表示在这次魔法中，Scarlet 会把以第 $x$ 行第 $y$ 列为中心的 $2r+1$ 阶矩阵按照某种时针方向旋转，其中 $z=0$ 表示顺时针，$z=1$ 表示逆时针。", "outputFormat": "输出 $n$ 行，每行 $n$ 个用空格隔开的数，表示最终所得的矩阵。", "hint": "对于 $50\\%$ 的数据，满足 $r=1$；\n\n对于 $100\\%$ 的数据，满足 $1\\leq n,m\\leq500$，$1\\leq x-r\\leq x+r\\leq n$，$1\\leq y-r\\leq y+r\\leq n$。", "locale": "zh-CN", "translations": {"en": {"title": "[1007] Magical Girl Scarlet", "background": "", "description": "Scarlet has recently learned an array magic. On an $n \\times n$ 2D array, she can rotate an odd-order square submatrix by $90^\\circ$ clockwise or counterclockwise.\n\nFirst, Scarlet fills the initial 2D array with the positive integers from $1$ to $n^2$ in order from left to right and from top to bottom, and then she casts some simple magic.\n\nScarlet does not know any block decomposition tricks, nor any Splay-on-Splay. She now gives you the order in which she performs her magic, and she wants you to tell her what the 2D array looks like after all the operations are performed in order.", "inputFormat": "The first line contains two integers $n, m$, representing the size of the square matrix and the number of magic operations.\n\nThe next $m$ lines each contain $4$ integers $x, y, r, z$, meaning that in this operation, Scarlet rotates the $(2r+1)$-order matrix centered at row $x$, column $y$ by $90^\\circ$ in a certain direction, where $z=0$ means clockwise and $z=1$ means counterclockwise.", "outputFormat": "Output $n$ lines, each containing $n$ numbers separated by spaces, representing the final matrix.", "hint": "For $50\\%$ of the testdata, $r=1$.\n\nFor $100\\%$ of the testdata, $1 \\leq n, m \\leq 500$, $1 \\leq x-r \\leq x+r \\leq n$, $1 \\leq y-r \\leq y+r \\leq n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[1007] 魔法少女小Scarlet", "background": null, "description": "Scarlet 最近学会了一个数组魔法，她会在 $n\\times n$ 二维数组上将一个奇数阶方阵按照顺时针或者逆时针旋转 $90^\\circ$。\n\n首先，Scarlet 会把 $1$ 到 $n^2$ 的正整数按照从左往右，从上至下的顺序填入初始的二维数组中，然后她会施放一些简易的魔法。\n\nScarlet 既不会什么分块特技，也不会什么 Splay 套 Splay，她现在提供给你她的魔法执行顺序，想让你来告诉她魔法按次执行完毕后的二维数组。", "inputFormat": "第一行两个整数 $n,m$，表示方阵大小和魔法施放次数。\n\n接下来 $m$ 行，每行 $4$ 个整数 $x,y,r,z$，表示在这次魔法中，Scarlet 会把以第 $x$ 行第 $y$ 列为中心的 $2r+1$ 阶矩阵按照某种时针方向旋转，其中 $z=0$ 表示顺时针，$z=1$ 表示逆时针。", "outputFormat": "输出 $n$ 行，每行 $n$ 个用空格隔开的数，表示最终所得的矩阵。", "hint": "对于 $50\\%$ 的数据，满足 $r=1$；\n\n对于 $100\\%$ 的数据，满足 $1\\leq n,m\\leq500$，$1\\leq x-r\\leq x+r\\leq n$，$1\\leq y-r\\leq y+r\\leq n$。", "locale": "zh-CN"}}}
{"pid": "P4925", "type": "P", "difficulty": 4, "samples": [["3 3 233\n1 1", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "数学", "洛谷月赛"], "title": "[1007] Scarlet的字符串不可能这么可爱", "background": "", "description": "Scarlet妄图构造字符集为$k$，长度为$L$的字符串，满足没有任何一个长度超过$1$的回文连续子串。\n\n看起来这样的字符串太多了，Scarlet随手加了个限制：她指定了字符串的第$s$位为$w$。\n\n这下Scarlet不会做了，请你来帮她计算究竟有多少满足条件的字符串。按照套路，你只要求出答案对$p$取模后的结果。", "inputFormat": "第一行三个整数$k,L$和$p$，分别表示构造的字符串的的字符集、长度和模数。\n\n第二行两个整数$s,w$，描述Scarlet给的限制。\n\n**注意：$s=0$表示该数据点中Scarlet十分良心地没有添加限制**", "outputFormat": "一行一个整数，表示答案对$p$的取模后的结果。", "hint": "字符集：一个字符串中不同字符的数量。例如，字符集是3的话，你可以认为字符串仅由“A”、“B”、“C”三个字母组成。\n\n样例解释：第一个字符固定A，那么符合要求的字符串是ABC,ACB。而AAB字符串包括AA这个回文子串，ACA本身就是回文串，一次类推。\n\n对于50%的数据，$k\\leq5,L\\leq10$\n\n对于另30%的数据，$s=0$\n\n对于100%的数据$1\\leq k,L\\leq 10^{18},0\\leq s\\leq L,1\\leq w\\leq k,1\\leq p\\leq 10^9$\n", "locale": "zh-CN", "translations": {"en": {"title": "[1007] Scarlet’s Strings Can’t Be This Cute", "background": "", "description": "Scarlet wants to construct a string with an alphabet size of $k$ and length $L$, such that it has no palindromic contiguous substring with length greater than $1$.\n\nIt seems there are too many such strings, so Scarlet casually adds a restriction: she fixes the $s$-th character of the string to be $w$.\n\nNow Scarlet cannot solve it. Please help her compute how many strings satisfy the conditions. As usual, you only need to output the answer modulo $p$.", "inputFormat": "The first line contains three integers $k, L$ and $p$, representing the alphabet size, the string length, and the modulus.\n\nThe second line contains two integers $s, w$, describing the restriction given by Scarlet.\n\n**Note: $s=0$ means that in this test case Scarlet kindly did not add any restriction.**", "outputFormat": "Output one integer in a single line, representing the number of valid strings modulo $p$.", "hint": "Alphabet size: the number of distinct characters in a string. For example, if the alphabet size is $3$, you may assume the string consists only of the three letters “A”, “B”, and “C”.\n\nSample explanation: if the first character is fixed to A, then the valid strings are ABC and ACB. The string AAB contains the palindromic substring AA, and ACA itself is a palindrome, and so on.\n\nConstraints for $50\\%$ of the testdata: $k\\leq5, L\\leq10$.\n\nConstraints for another $30\\%$ of the testdata: $s=0$.\n\nConstraints for $100\\%$ of the testdata: $1\\leq k, L\\leq 10^{18}, 0\\leq s\\leq L, 1\\leq w\\leq k, 1\\leq p\\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[1007] Scarlet的字符串不可能这么可爱", "background": "", "description": "Scarlet妄图构造字符集为$k$，长度为$L$的字符串，满足没有任何一个长度超过$1$的回文连续子串。\n\n看起来这样的字符串太多了，Scarlet随手加了个限制：她指定了字符串的第$s$位为$w$。\n\n这下Scarlet不会做了，请你来帮她计算究竟有多少满足条件的字符串。按照套路，你只要求出答案对$p$取模后的结果。", "inputFormat": "第一行三个整数$k,L$和$p$，分别表示构造的字符串的的字符集、长度和模数。\n\n第二行两个整数$s,w$，描述Scarlet给的限制。\n\n**注意：$s=0$表示该数据点中Scarlet十分良心地没有添加限制**", "outputFormat": "一行一个整数，表示答案对$p$的取模后的结果。", "hint": "字符集：一个字符串中不同字符的数量。例如，字符集是3的话，你可以认为字符串仅由“A”、“B”、“C”三个字母组成。\n\n样例解释：第一个字符固定A，那么符合要求的字符串是ABC,ACB。而AAB字符串包括AA这个回文子串，ACA本身就是回文串，一次类推。\n\n对于50%的数据，$k\\leq5,L\\leq10$\n\n对于另30%的数据，$s=0$\n\n对于100%的数据$1\\leq k,L\\leq 10^{18},0\\leq s\\leq L,1\\leq w\\leq k,1\\leq p\\leq 10^9$\n", "locale": "zh-CN"}}}
{"pid": "P4926", "type": "P", "difficulty": 5, "samples": [["3 5 1\n1 2 1 2\n1 3 2 2\n1 3 1 4\n2 1 2 2\n2 1 3 4\n1 1", "-1"], ["3 2 3\n1 2 1 10\n2 2 3 6\n1 1\n2 6\n3 9", "3.9999993984"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["二分", "Special Judge", "最短路", "差分约束", "洛谷月赛"], "title": "[1007] 倍杀测量者", "background": "", "description": "今天 Scarlet 在机房有幸目睹了一场别开生面的 OI 训练。因为一些奇妙的 SPJ，比赛中所有选手的得分都是正实数（甚至没有上限）。\n\n当一位选手 A 的分数不小于选手 B 的分数 $k$（$k>0$）倍时，我们称选手 A **$k$ 倍杀** 了选手 B，选手 B **被** 选手 A **$k$ 倍杀** 了。\n\n更奇妙也更激动人心的是，训练前有不少选手立下了诸如 “我没 $k$ 倍杀选手 X，我就吃顿好的”，“选手 Y 把我 $k$ 倍杀，我就吃顿好的” 的 Flag。\n\n知道真相的良心教练 Patchouli 为了维持机房秩序，避免吃的太好导致身体健康程度下滑，放宽了选手们的 Flag 限制。Patchouli 设定了一个 **正** 常数 $T$，立下 “我没 $k$ 倍杀选手 X 就吃顿好的” 的选手只要成功 $k - T$ 倍杀了选手 X，就不需要吃顿好的。同样的，立下 “选手 Y 把我 $k$ 倍杀我就吃顿好的” 的选手只要没有成功被选手 Y $k+T$ 倍杀，也不需要吃顿好的。\n\n提前知道了某些选手分数和具体 Flag 的 Scarlet 实在不忍心看到这么一次精彩比赛却没人吃顿好的，为了方便和 Patchouli 交易，Scarlet 想要确定最大的实数 $T$ 使得赛后一定有选手收 Flag 吃顿好的。", "inputFormat": "第一行三个整数 $n,s,t$，分别表示机房内选手人数，选手立下的 Flag 总数和 Scarlet 已知的选手分数的数量。$n$ 位选手从 $1$ 开始编号至 $n$，编号为 $k$ 的选手被称为选手 $k$。\n\n接下来 $s$ 行，每行四个整数 $o,A,B,k$。其中 $o=1$ 表示选手 A 立下了 “我没 $k$ 倍杀选手 B 就吃顿好的” 的 Flag，$o=2$ 表示选手 A 立下了 “选手 B 把我 $k$ 倍杀我就吃顿好的” 的 Flag。\n\n接下来 $t$ 行，每行两个整数 $C,x$，表示 Scarlet 已知选手 $C$ 的分数为 $x$。", "outputFormat": "若存在能保证赛后有选手吃顿好的的最大的 $T$，则输出 $T$，只有当输出与答案的绝对误差不超过 $10^{-4}$ 时才被视作正确输出。\n\n若不存在，输出 `-1`。", "hint": "- 对于 $30\\%$ 的数据，$n\\leq5$，$s\\leq 2$；\n- 对于另 $40\\%$ 的数据，保证 $t=n$；\n- 对于 $100\\%$ 的数据，$1\\leq n,s\\leq 1000$，$1\\leq A,B,C,t\\leq n$，$1\\leq k\\leq 10$，$1\\leq x\\leq 10^9$。保证输入中的 $C$ 两两不同。", "locale": "zh-CN", "translations": {"en": {"title": "[1007] Double-Kill Meter", "background": "", "description": "Today, Scarlet was lucky enough to witness a unique OI training session in the computer lab. Because of some strange SPJ, every contestant’s score in the contest was a positive real number (and it even has no upper limit).\n\nWhen contestant A’s score is at least $k$ ($k>0$) times contestant B’s score, we say contestant A **$k$-double-killed** contestant B, and contestant B **was $k$-double-killed** by contestant A.\n\nEven more strangely (and more excitingly), before the training, many contestants made Flags such as “If I don’t $k$-double-kill contestant X, I’ll eat something good,” or “If contestant Y $k$-double-kills me, I’ll eat something good.”\n\nCoach Patchouli, who knows the truth and still has a conscience, in order to keep order in the lab and avoid people eating too well and hurting their health, relaxed the Flag requirements. Patchouli set a **positive** constant $T$. A contestant who made the Flag “If I don’t $k$-double-kill contestant X, I’ll eat something good” will not need to eat something good as long as they successfully $k-T$-double-kill contestant X. Similarly, a contestant who made the Flag “If contestant Y $k$-double-kills me, I’ll eat something good” will not need to eat something good as long as they are not successfully $k+T$-double-killed by contestant Y.\n\nScarlet, who already knows the scores of some contestants and the exact Flags, really cannot bear to see such a wonderful contest end with nobody eating something good. To make it easier to negotiate with Patchouli, Scarlet wants to determine the largest real number $T$ such that, after the contest, there will definitely be at least one contestant who has to fulfill their Flag and eat something good.", "inputFormat": "The first line contains three integers $n,s,t$, representing the number of contestants in the lab, the total number of Flags made by contestants, and the number of contestants’ scores known by Scarlet. The $n$ contestants are numbered from $1$ to $n$. The contestant with number $k$ is called contestant $k$.\n\nThe next $s$ lines each contain four integers $o,A,B,k$. Here, $o=1$ means contestant A made the Flag “If I don’t $k$-double-kill contestant B, I’ll eat something good,” and $o=2$ means contestant A made the Flag “If contestant B $k$-double-kills me, I’ll eat something good.”\n\nThe next $t$ lines each contain two integers $C,x$, meaning Scarlet knows that contestant $C$ has score $x$.", "outputFormat": "If there exists a largest $T$ that can guarantee that, after the contest, there will be a contestant who eats something good, output $T$. Your output is considered correct if the absolute error from the answer does not exceed $10^{-4}$.\n\nIf it does not exist, output `-1`.", "hint": "- For $30\\%$ of the testdata, $n\\leq 5$, $s\\leq 2$.\n- For another $40\\%$ of the testdata, it is guaranteed that $t=n$.\n- For $100\\%$ of the testdata, $1\\leq n,s\\leq 1000$, $1\\leq A,B,C,t\\leq n$, $1\\leq k\\leq 10$, $1\\leq x\\leq 10^9$. It is guaranteed that all input $C$ are pairwise distinct.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[1007] 倍杀测量者", "background": "", "description": "今天 Scarlet 在机房有幸目睹了一场别开生面的 OI 训练。因为一些奇妙的 SPJ，比赛中所有选手的得分都是正实数（甚至没有上限）。\n\n当一位选手 A 的分数不小于选手 B 的分数 $k$（$k>0$）倍时，我们称选手 A **$k$ 倍杀** 了选手 B，选手 B **被** 选手 A **$k$ 倍杀** 了。\n\n更奇妙也更激动人心的是，训练前有不少选手立下了诸如 “我没 $k$ 倍杀选手 X，我就吃顿好的”，“选手 Y 把我 $k$ 倍杀，我就吃顿好的” 的 Flag。\n\n知道真相的良心教练 Patchouli 为了维持机房秩序，避免吃的太好导致身体健康程度下滑，放宽了选手们的 Flag 限制。Patchouli 设定了一个 **正** 常数 $T$，立下 “我没 $k$ 倍杀选手 X 就吃顿好的” 的选手只要成功 $k - T$ 倍杀了选手 X，就不需要吃顿好的。同样的，立下 “选手 Y 把我 $k$ 倍杀我就吃顿好的” 的选手只要没有成功被选手 Y $k+T$ 倍杀，也不需要吃顿好的。\n\n提前知道了某些选手分数和具体 Flag 的 Scarlet 实在不忍心看到这么一次精彩比赛却没人吃顿好的，为了方便和 Patchouli 交易，Scarlet 想要确定最大的实数 $T$ 使得赛后一定有选手收 Flag 吃顿好的。", "inputFormat": "第一行三个整数 $n,s,t$，分别表示机房内选手人数，选手立下的 Flag 总数和 Scarlet 已知的选手分数的数量。$n$ 位选手从 $1$ 开始编号至 $n$，编号为 $k$ 的选手被称为选手 $k$。\n\n接下来 $s$ 行，每行四个整数 $o,A,B,k$。其中 $o=1$ 表示选手 A 立下了 “我没 $k$ 倍杀选手 B 就吃顿好的” 的 Flag，$o=2$ 表示选手 A 立下了 “选手 B 把我 $k$ 倍杀我就吃顿好的” 的 Flag。\n\n接下来 $t$ 行，每行两个整数 $C,x$，表示 Scarlet 已知选手 $C$ 的分数为 $x$。", "outputFormat": "若存在能保证赛后有选手吃顿好的的最大的 $T$，则输出 $T$，只有当输出与答案的绝对误差不超过 $10^{-4}$ 时才被视作正确输出。\n\n若不存在，输出 `-1`。", "hint": "- 对于 $30\\%$ 的数据，$n\\leq5$，$s\\leq 2$；\n- 对于另 $40\\%$ 的数据，保证 $t=n$；\n- 对于 $100\\%$ 的数据，$1\\leq n,s\\leq 1000$，$1\\leq A,B,C,t\\leq n$，$1\\leq k\\leq 10$，$1\\leq x\\leq 10^9$。保证输入中的 $C$ 两两不同。", "locale": "zh-CN"}}}
{"pid": "P4927", "type": "P", "difficulty": 5, "samples": [["4 3\n1 2 3 4\n2\n1 1 3 1\n2", "399297760\n844668322"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["线段树", "概率论", "期望", "洛谷月赛"], "title": "[1007] 梦美与线段树", "background": "欢迎大家光临星象馆\n\n这里有着无论何时永远不会消失\n\n美丽的无穷光辉\n\n满天的星星等候着大家的到来", "description": "梦美为了研究星象馆的星星，用巨型投影机——耶拿将星星排成了一个序列，接着梦美将这个星星序列建成了一棵线段树。\n\n这是一棵维护区间和的线段树，每个节点的权值是该节点所对应的区间中，所有星星的权值和。有的时候梦美会从这棵线段树的根节点开始在星空游历。当她要进入子节点的时候，假设左右子树对应区间的权值和分别为 $sum_l$  和 $sum_r$，当前节点的权值为 $sum_{cur}$ ，梦美会以 $\\frac{sum_l}{sum_{cur}}$ 的概率进入左子树，否则进入右子树。\n\n游历的时候，梦美会把她经过的节点的权值累加起来，现在她希望您帮她设计一个算法求出这个权值期望下是多少。\n\n当然，如果星星都是不变的梦美会觉得很没有意思，因此她会发出一些指令，每个指令是，对下标在 $[l,r]$ 的星星，权值加上 $v$ 。不过由于馆里的工作人员全都离开了，因此没有人教梦美在线段树上维护懒标记，所以梦美的每次指令都会实时更新所有的线段树节点。\n\n为了解决线段树写法不一的问题，此处给出梦美维护这个问题时的部分代码：\n```cpp\nconst int N = 100010, MOD = 998244353;\nint a[N], sum[N << 2];\n#define lson (o << 1)\n#define rson (o << 1 | 1)\nvoid pushup(int o) {\n\tsum[o] = (sum[lson] + sum[rson]) % MOD;\n}\nvoid build(int o, int l, int r) {\n\tif (l == r) {\n\t\tsum[o] = a[l];\n\t} else {\n\t\tint mid = (l + r) >> 1;\n\t\tbuild(lson, l, mid);\n\t\tbuild(rson, mid + 1, r);\n\t\tpushup(o);\n\t}\n}\nvoid change(int o, int l, int r, int q, int v) {\n\tif (l == r) {\n\t\tsum[o] = (sum[o] + v) % MOD;\n\t\treturn;\n\t}\n\tint mid = (l + r) >> 1;\n\tif (q <= mid) change(lson, l, mid, q, v);\n\telse change(rson, mid + 1, r, q, v);\n\tpushup(o);\n}\nvoid add_to_interval(int l, int r, int v) {\n\tfor (int i = l; i <= r; i ++) {\n\t\tchange(1, 1, n, i, v);\n\t}\n}\n```\n其中 `a` 数组表示每个星星的权值，`sum` 数组表示每个线段树节点的权值，`add_to_interval` 函数表示一次操作。", "inputFormat": "第一行两个整数 $n,m$，表示序列长度和操作次数。\n\n第二行 $n$ 个整数，表示这个序列。\n\n接下来 $m$ 行，每行为\n\n$1 \\ l \\ r \\ v$，表示区间 $[l,r]$ 的节点加上了 $v$；\n\n$2$ ，表示一次询问。", "outputFormat": "对于每一个 $2$ 操作，输出一个答案。令答案化成最简分数为 $\\frac{p}{q}$（保证 $q$ 不是 $998244353$ 的倍数），则输出 $p\\cdot q^{-1}\\mod 998244353$。", "hint": "对于 $30\\%$ 的数据，保证 $1 \\leq n,m\\leq 100$；\n\n对于另外 $20\\%$ 的数据，满足所有操作 1 中 $l=r$；\n\n对于 $100\\%$ 的数据，保证 $1\\leq n,m \\leq 10^5,1 \\leq a_i,v \\leq 10^9,1\\le l\\le r\\le n$。\n\n样例答案实际是 $\\frac{94}{5}$ 和 $\\frac{303}{13}$。", "locale": "zh-CN", "translations": {"en": {"title": "[1007] Mengmei and the Segment Tree", "background": "Welcome to the Planetarium.\n\nHere, there is beautiful infinite radiance that never disappears at any time.\n\nThe sky full of stars is waiting for everyone to come.", "description": "To study the stars in the Planetarium, Mengmei used a giant projector—Yena—to arrange the stars into a sequence, and then built a segment tree on this star sequence.\n\nThis is a segment tree that maintains interval sums. The weight of each node is the sum of the weights of all stars in the interval corresponding to that node. Sometimes Mengmei starts a journey in the starry sky from the root node of this segment tree. When she is about to enter a child node, suppose the sums of weights of the intervals corresponding to the left and right subtrees are $sum_l$ and $sum_r$, and the weight of the current node is $sum_{cur}$. Mengmei will enter the left subtree with probability $\\frac{sum_l}{sum_{cur}}$, otherwise she enters the right subtree.\n\nDuring the journey, Mengmei adds up the weights of the nodes she passes through. Now she wants you to design an algorithm to compute the expected value of this accumulated weight.\n\nOf course, if the stars never change, Mengmei would find it very boring. So she will issue some commands. Each command is: for the stars with indices in $[l,r]$, increase their weights by $v$. However, since all the staff in the museum have left, no one taught Mengmei how to maintain lazy tags on the segment tree, so each of her commands will update all segment tree nodes in real time.\n\nTo avoid differences in segment tree implementations, here is part of the code Mengmei uses to maintain this problem:\n```cpp\nconst int N = 100010, MOD = 998244353;\nint a[N], sum[N << 2];\n#define lson (o << 1)\n#define rson (o << 1 | 1)\nvoid pushup(int o) {\n\tsum[o] = (sum[lson] + sum[rson]) % MOD;\n}\nvoid build(int o, int l, int r) {\n\tif (l == r) {\n\t\tsum[o] = a[l];\n\t} else {\n\t\tint mid = (l + r) >> 1;\n\t\tbuild(lson, l, mid);\n\t\tbuild(rson, mid + 1, r);\n\t\tpushup(o);\n\t}\n}\nvoid change(int o, int l, int r, int q, int v) {\n\tif (l == r) {\n\t\tsum[o] = (sum[o] + v) % MOD;\n\t\treturn;\n\t}\n\tint mid = (l + r) >> 1;\n\tif (q <= mid) change(lson, l, mid, q, v);\n\telse change(rson, mid + 1, r, q, v);\n\tpushup(o);\n}\nvoid add_to_interval(int l, int r, int v) {\n\tfor (int i = l; i <= r; i ++) {\n\t\tchange(1, 1, n, i, v);\n\t}\n}\n```\nHere, the array `a` represents the weight of each star, the array `sum` represents the weight of each segment tree node, and the function `add_to_interval` represents one operation.", "inputFormat": "The first line contains two integers $n,m$, representing the sequence length and the number of operations.\n\nThe second line contains $n$ integers, representing this sequence.\n\nNext, there are $m$ lines, each being one of the following:\n\n$1 \\ l \\ r \\ v$, meaning that all nodes in the interval $[l,r]$ are increased by $v$;\n\n$2$, meaning one query.", "outputFormat": "For each operation $2$, output one answer. Let the answer in lowest terms be $\\frac{p}{q}$ (it is guaranteed that $q$ is not a multiple of $998244353$), then output $p\\cdot q^{-1}\\mod 998244353$.", "hint": "For $30\\%$ of the testdata, it is guaranteed that $1 \\leq n,m\\leq 100$.\n\nFor another $20\\%$ of the testdata, all operations of type 1 satisfy $l=r$.\n\nFor $100\\%$ of the testdata, it is guaranteed that $1\\leq n,m \\leq 10^5,1 \\leq a_i,v \\leq 10^9,1\\le l\\le r\\le n$.\n\nThe sample answers are actually $\\frac{94}{5}$ and $\\frac{303}{13}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[1007] 梦美与线段树", "background": "欢迎大家光临星象馆\n\n这里有着无论何时永远不会消失\n\n美丽的无穷光辉\n\n满天的星星等候着大家的到来", "description": "梦美为了研究星象馆的星星，用巨型投影机——耶拿将星星排成了一个序列，接着梦美将这个星星序列建成了一棵线段树。\n\n这是一棵维护区间和的线段树，每个节点的权值是该节点所对应的区间中，所有星星的权值和。有的时候梦美会从这棵线段树的根节点开始在星空游历。当她要进入子节点的时候，假设左右子树对应区间的权值和分别为 $sum_l$  和 $sum_r$，当前节点的权值为 $sum_{cur}$ ，梦美会以 $\\frac{sum_l}{sum_{cur}}$ 的概率进入左子树，否则进入右子树。\n\n游历的时候，梦美会把她经过的节点的权值累加起来，现在她希望您帮她设计一个算法求出这个权值期望下是多少。\n\n当然，如果星星都是不变的梦美会觉得很没有意思，因此她会发出一些指令，每个指令是，对下标在 $[l,r]$ 的星星，权值加上 $v$ 。不过由于馆里的工作人员全都离开了，因此没有人教梦美在线段树上维护懒标记，所以梦美的每次指令都会实时更新所有的线段树节点。\n\n为了解决线段树写法不一的问题，此处给出梦美维护这个问题时的部分代码：\n```cpp\nconst int N = 100010, MOD = 998244353;\nint a[N], sum[N << 2];\n#define lson (o << 1)\n#define rson (o << 1 | 1)\nvoid pushup(int o) {\n\tsum[o] = (sum[lson] + sum[rson]) % MOD;\n}\nvoid build(int o, int l, int r) {\n\tif (l == r) {\n\t\tsum[o] = a[l];\n\t} else {\n\t\tint mid = (l + r) >> 1;\n\t\tbuild(lson, l, mid);\n\t\tbuild(rson, mid + 1, r);\n\t\tpushup(o);\n\t}\n}\nvoid change(int o, int l, int r, int q, int v) {\n\tif (l == r) {\n\t\tsum[o] = (sum[o] + v) % MOD;\n\t\treturn;\n\t}\n\tint mid = (l + r) >> 1;\n\tif (q <= mid) change(lson, l, mid, q, v);\n\telse change(rson, mid + 1, r, q, v);\n\tpushup(o);\n}\nvoid add_to_interval(int l, int r, int v) {\n\tfor (int i = l; i <= r; i ++) {\n\t\tchange(1, 1, n, i, v);\n\t}\n}\n```\n其中 `a` 数组表示每个星星的权值，`sum` 数组表示每个线段树节点的权值，`add_to_interval` 函数表示一次操作。", "inputFormat": "第一行两个整数 $n,m$，表示序列长度和操作次数。\n\n第二行 $n$ 个整数，表示这个序列。\n\n接下来 $m$ 行，每行为\n\n$1 \\ l \\ r \\ v$，表示区间 $[l,r]$ 的节点加上了 $v$；\n\n$2$ ，表示一次询问。", "outputFormat": "对于每一个 $2$ 操作，输出一个答案。令答案化成最简分数为 $\\frac{p}{q}$（保证 $q$ 不是 $998244353$ 的倍数），则输出 $p\\cdot q^{-1}\\mod 998244353$。", "hint": "对于 $30\\%$ 的数据，保证 $1 \\leq n,m\\leq 100$；\n\n对于另外 $20\\%$ 的数据，满足所有操作 1 中 $l=r$；\n\n对于 $100\\%$ 的数据，保证 $1\\leq n,m \\leq 10^5,1 \\leq a_i,v \\leq 10^9,1\\le l\\le r\\le n$。\n\n样例答案实际是 $\\frac{94}{5}$ 和 $\\frac{303}{13}$。", "locale": "zh-CN"}}}
{"pid": "P4928", "type": "P", "difficulty": 5, "samples": [["2 5\n5 10\n1 1\n2 4 3 5 2", "125"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2018", "洛谷原创", "O2优化", "枚举", "进制", "状压 DP"], "title": "[MtOI2018] 衣服？身外之物！", "background": "gcd 有许多件衣服，每件衣服有不同的颜色。", "description": "gcd 共有 $n$ 件衣服，编号为 $A_1,A_2,\\cdots A_n$。\n\n每一件衣服分别拥有颜色值和清洗时间，他在每一件衣服穿完以后都会将其送去清洗，而这件衣服当天所拥有的舒适感取决于当天的天气与他的衣服颜色值的乘积，天气值存在负数。\n\n现给出共 $m$ 天的天气情况，求最大舒适值。\n\n如果**必定**有一天 gcd 没有衣服穿，输出 \"gcd loves her clothes!\"（不含引号）。      \n", "inputFormat": "输出共 $4$ 行。\n\n第 $1$ 行输入 $n,m$。\n\n第 $2$ 行输入 $x_1,x_2\\cdots x_n$表示衣服的颜色值。     \n   \n第 $3$ 行输入 $y_1,y_2\\cdots y_n$表示衣服的清洗时间。 \n  \n第 $4$ 行输入 $z_1,z_2\\cdots z_m$表示当天的天气值。  ", "outputFormat": "输出共 $1$ 行，输出 $m$ 天穿衣的最大舒适值或输出 \"gcd loves her clothes!\"。", "hint": "#### 样例解释 $1$\n\n$A_1:Day_1,Day_3,Day_5$\n\n$A_2:Day_2,Day_4$\n\n### 子任务\n\n对于 $30\\%$ 的数据，$n=2$，$m=100$。\n\n对于 $50\\%$ 的数据，$n\\leq 3$，$m\\leq 1000$。\n\n对于 $100\\% $的数据，$n\\leq 4$，$n\\neq 1$，$m\\leq 2000$，$y_i\\leq 6$，$Maxy<m$，$|z_i|\\leq 10^8$。\n\n### 题目来源\n\n[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T3\n\n出题人：b2019dy\n\n78488", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2018] Clothes? Mere External Things!", "background": "gcd has many pieces of clothing, and each piece has a different color.", "description": "gcd has a total of $n$ pieces of clothing, numbered $A_1, A_2, \\cdots A_n$.\n\nEach piece of clothing has a color value and a washing time. After wearing a piece of clothing, he will send it to be washed. The comfort value of that day depends on the product of the day's weather value and the clothing's color value, and the weather value can be negative.\n\nGiven the weather for $m$ days, find the maximum total comfort value.\n\nIf it is **certain** that there exists a day when gcd has no clothes to wear, output \"gcd loves her clothes!\" (without quotes).", "inputFormat": "The input consists of $4$ lines.\n\nLine $1$ contains $n, m$.\n\nLine $2$ contains $x_1, x_2 \\cdots x_n$, representing the color values of the clothes.\n\nLine $3$ contains $y_1, y_2 \\cdots y_n$, representing the washing times of the clothes.\n\nLine $4$ contains $z_1, z_2 \\cdots z_m$, representing the weather value of each day.", "outputFormat": "Output $1$ line: the maximum total comfort value over $m$ days of wearing clothes, or output \"gcd loves her clothes!\".", "hint": "#### Sample Explanation $1$\n\n$A_1:Day_1,Day_3,Day_5$\n\n$A_2:Day_2,Day_4$\n\n### Subtasks\n\nFor $30\\%$ of the testdata, $n = 2$, $m = 100$.\n\nFor $50\\%$ of the testdata, $n \\leq 3$, $m \\leq 1000$.\n\nFor $100\\%$ of the testdata, $n \\leq 4$, $n \\neq 1$, $m \\leq 2000$, $y_i \\leq 6$, $Maxy < m$, $|z_i| \\leq 10^8$.\n\n### Source\n\n[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T3\n\nProblem setter: b2019dy\n\n78488\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2018] 衣服？身外之物！", "background": "gcd 有许多件衣服，每件衣服有不同的颜色。", "description": "gcd 共有 $n$ 件衣服，编号为 $A_1,A_2,\\cdots A_n$。\n\n每一件衣服分别拥有颜色值和清洗时间，他在每一件衣服穿完以后都会将其送去清洗，而这件衣服当天所拥有的舒适感取决于当天的天气与他的衣服颜色值的乘积，天气值存在负数。\n\n现给出共 $m$ 天的天气情况，求最大舒适值。\n\n如果**必定**有一天 gcd 没有衣服穿，输出 \"gcd loves her clothes!\"（不含引号）。      \n", "inputFormat": "输出共 $4$ 行。\n\n第 $1$ 行输入 $n,m$。\n\n第 $2$ 行输入 $x_1,x_2\\cdots x_n$表示衣服的颜色值。     \n   \n第 $3$ 行输入 $y_1,y_2\\cdots y_n$表示衣服的清洗时间。 \n  \n第 $4$ 行输入 $z_1,z_2\\cdots z_m$表示当天的天气值。  ", "outputFormat": "输出共 $1$ 行，输出 $m$ 天穿衣的最大舒适值或输出 \"gcd loves her clothes!\"。", "hint": "#### 样例解释 $1$\n\n$A_1:Day_1,Day_3,Day_5$\n\n$A_2:Day_2,Day_4$\n\n### 子任务\n\n对于 $30\\%$ 的数据，$n=2$，$m=100$。\n\n对于 $50\\%$ 的数据，$n\\leq 3$，$m\\leq 1000$。\n\n对于 $100\\% $的数据，$n\\leq 4$，$n\\neq 1$，$m\\leq 2000$，$y_i\\leq 6$，$Maxy<m$，$|z_i|\\leq 10^8$。\n\n### 题目来源\n\n[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T3\n\n出题人：b2019dy\n\n78488", "locale": "zh-CN"}}}
{"pid": "P4929", "type": "P", "difficulty": 6, "samples": [["3 3\n0 0 1\n1 0 0\n0 1 0\n", "2 1 3\n"], ["3 3\n1 0 1\n1 1 0\n0 1 1\n", "No Solution!\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "Special Judge", "剪枝", "Dancing Links", "模板题"], "title": "【模板】舞蹈链（DLX）", "background": "本题是舞蹈链模板——精确覆盖问题", "description": "给定一个 $N$ 行 $M$ 列的矩阵，矩阵中每个元素要么是 $1$，要么是 $0$。\n\n你需要在矩阵中挑选出若干行，使得对于矩阵的每一列 $j$，在你挑选的这些行中，有且仅有一行的第 $j$ 个元素为 $1$。\n", "inputFormat": "第一行两个数 $N,M$。\n\n接下来 $N$ 行，每行 $M$ 个数字 $0$ 或 $1$，表示这个矩阵。\n", "outputFormat": "一行输出若干个数表示答案，两个数之间用空格隔开，输出任一可行方案均可，顺序随意。\n\n若无解，输出 `No Solution!`。\n", "hint": "对于 $100\\%$ 的数据，$N,M\\leq 500$，保证矩阵中 $1$ 的数量不超过 $5000$ 个。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Dancing Links (DLX).", "background": "This problem is a Dancing Links template for the Exact Cover problem.", "description": "Given a matrix with $N$ rows and $M$ columns, each element in the matrix is either $1$ or $0$.\n\nYou need to select some rows from the matrix so that for every column $j$ of the matrix, among the selected rows, there is one and only one row whose $j$-th element is $1$.", "inputFormat": "The first line contains two integers $N, M$.\n\nThe next $N$ lines each contain $M$ digits $0$ or $1$, representing the matrix.", "outputFormat": "Output one line containing several integers representing the answer. Separate numbers with spaces. Any feasible solution is acceptable, and the order can be arbitrary.\n\nIf there is no solution, output `No Solution!`.", "hint": "For $100\\%$ of the testdata, $N, M \\leq 500$, and the number of $1$ in the matrix is guaranteed to be at most $5000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】舞蹈链（DLX）", "background": "本题是舞蹈链模板——精确覆盖问题", "description": "给定一个 $N$ 行 $M$ 列的矩阵，矩阵中每个元素要么是 $1$，要么是 $0$。\n\n你需要在矩阵中挑选出若干行，使得对于矩阵的每一列 $j$，在你挑选的这些行中，有且仅有一行的第 $j$ 个元素为 $1$。\n", "inputFormat": "第一行两个数 $N,M$。\n\n接下来 $N$ 行，每行 $M$ 个数字 $0$ 或 $1$，表示这个矩阵。\n", "outputFormat": "一行输出若干个数表示答案，两个数之间用空格隔开，输出任一可行方案均可，顺序随意。\n\n若无解，输出 `No Solution!`。\n", "hint": "对于 $100\\%$ 的数据，$N,M\\leq 500$，保证矩阵中 $1$ 的数量不超过 $5000$ 个。", "locale": "zh-CN"}}}
{"pid": "P4930", "type": "P", "difficulty": 5, "samples": [["4\n8\n10\n13\n6", "5\n15 16 20 24 30\n2\n11 22\n0\n\n4\n7 9 14 18"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["搜索", "2013", "PA（波兰）"], "title": "[PA 2013] Euler", "background": "", "description": "给定 $n$ 求所有满足 $\\varphi(x)=n$ 的 $x$。", "inputFormat": "第一行一个数 $T$。\n\n接下来 $T$ 行，每行一个数 $n$。", "outputFormat": "输出共 $2\\times T$ 行。\n\n每组一个数 $m$ 表示满足的个数。\n\n接下来一行升序输出 $m$ 个数 $x_i$，若 $m$ 为 $0$ 则输出一个空行。", "hint": "对于 $100\\%$ 的数据，$1\\le T\\le 5$，$1\\le n\\le 10^{10}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2013] Euler", "background": "", "description": "给定 $n$ 求所有满足 $\\varphi(x)=n$ 的 $x$。", "inputFormat": "第一行一个数 $T$。\n\n接下来 $T$ 行，每行一个数 $n$。", "outputFormat": "输出共 $2\\times T$ 行。\n\n每组一个数 $m$ 表示满足的个数。\n\n接下来一行升序输出 $m$ 个数 $x_i$，若 $m$ 为 $0$ 则输出一个空行。", "hint": "对于 $100\\%$ 的数据，$1\\le T\\le 5$，$1\\le n\\le 10^{10}$。", "locale": "zh-CN"}}}
{"pid": "P4931", "type": "P", "difficulty": 7, "samples": [["5\n1 1\n2 0\n2 2\n2333 666\n2333333 1000000\n", "2\n16\n8\n798775522\n300377435\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["递推", "2018", "洛谷原创", "组合数学", "生成函数", "逆元"], "title": "[MtOI2018] 情侣？给我烧了！（加强版）", "background": "FFF\n\n本题原版：[P4921](https://www.luogu.com.cn/problem/P4921)", "description": "有 $n$ 对情侣来到电影院观看电影。在电影院，恰好留有 $n$ 排座位，每排包含 $2$ 个座位，共 $2n$ 个座位。\n\n现在，每个人将会随机坐在某一个位置上，且恰好将这 $2n$ 个座位坐满。\n\n如果一对情侣坐在了同一排的座位上，那么我们称这对情侣是和睦的。\n\n你的任务是求出共有多少种不同的就坐方案满足**恰好**有 *k* 对情侣是和睦的。\n\n两种就坐方案不同当且仅当存在一个人在两种方案中坐在了不同的位置。不难发现，一共会有 $(2n)!$ 种不同的就坐方案。\n\n由于结果可能较大，因此输出对 $998244353$ 取模的结果。", "inputFormat": "输入包含多组数据。\n\n输入的第 $1$ 行包含 $1$ 个正整数 $T$，表示数据的组数。\n\n接下来 $T$ 行，每行包含 $2$ 个正整数 $n,k$。", "outputFormat": "输出共 $T$ 行。\n\n对于每组输入数据，输出共 $1$ 行，包含 $1$ 个整数，表示恰好有 $k$ 对情侣和睦的就坐方案数。", "hint": "### 子任务\n\n对于 $10 \\%$ 的数据，满足 $1 \\leq T \\leq 10, 1 \\leq n \\leq 5$。\n\n对于 $40 \\%$ 的数据，满足 $1 \\leq n \\leq 3 \\times 10^3$。\n\n对于 $100 \\%$ 的数据，满足 $1 \\leq T \\leq 2 \\times 10^5, 1 \\leq n \\leq 5 \\times 10^6, 0 \\leq k \\leq n$。\n\n### 题目来源\n\n[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T2 加强版\n\n出题人：Imagine\n\n50167", "locale": "zh-CN", "translations": {"en": {"title": "[MtOI2018] Couples? Burn Them for Me! (Enhanced Version)", "background": "FFF.\n\nOriginal version of this problem: [P4921](https://www.luogu.com.cn/problem/P4921).", "description": "There are $n$ couples who come to a cinema to watch a movie. In the cinema, there are exactly $n$ rows of seats, and each row contains $2$ seats, so there are $2n$ seats in total.\n\nNow, everyone will randomly sit in one seat, and exactly all $2n$ seats will be occupied.\n\nIf a couple sits in the same row, then we call this couple harmonious.\n\nYour task is to find how many different seating arrangements satisfy that **exactly** $k$ couples are harmonious.\n\nTwo seating arrangements are different if and only if there exists at least one person who sits in a different seat in the two arrangements. It is not hard to see that there are $(2n)!$ different seating arrangements in total.\n\nSince the answer may be large, output it modulo $998244353$.", "inputFormat": "The input contains multiple test cases.\n\nThe first line contains one positive integer $T$, the number of test cases.\n\nThe next $T$ lines each contain two positive integers $n, k$.", "outputFormat": "Output $T$ lines.\n\nFor each test case, output one line containing one integer, the number of seating arrangements in which exactly $k$ couples are harmonious.", "hint": "### Subtasks\n\nFor $10\\%$ of the testdata, $1 \\leq T \\leq 10$ and $1 \\leq n \\leq 5$.\n\nFor $40\\%$ of the testdata, $1 \\leq n \\leq 3 \\times 10^3$.\n\nFor $100\\%$ of the testdata, $1 \\leq T \\leq 2 \\times 10^5$, $1 \\leq n \\leq 5 \\times 10^6$, and $0 \\leq k \\leq n$.\n\n### Source\n\n[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T2 Enhanced Version.\n\nProblem setter: Imagine.\n\n50167.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[MtOI2018] 情侣？给我烧了！（加强版）", "background": "FFF\n\n本题原版：[P4921](https://www.luogu.com.cn/problem/P4921)", "description": "有 $n$ 对情侣来到电影院观看电影。在电影院，恰好留有 $n$ 排座位，每排包含 $2$ 个座位，共 $2n$ 个座位。\n\n现在，每个人将会随机坐在某一个位置上，且恰好将这 $2n$ 个座位坐满。\n\n如果一对情侣坐在了同一排的座位上，那么我们称这对情侣是和睦的。\n\n你的任务是求出共有多少种不同的就坐方案满足**恰好**有 *k* 对情侣是和睦的。\n\n两种就坐方案不同当且仅当存在一个人在两种方案中坐在了不同的位置。不难发现，一共会有 $(2n)!$ 种不同的就坐方案。\n\n由于结果可能较大，因此输出对 $998244353$ 取模的结果。", "inputFormat": "输入包含多组数据。\n\n输入的第 $1$ 行包含 $1$ 个正整数 $T$，表示数据的组数。\n\n接下来 $T$ 行，每行包含 $2$ 个正整数 $n,k$。", "outputFormat": "输出共 $T$ 行。\n\n对于每组输入数据，输出共 $1$ 行，包含 $1$ 个整数，表示恰好有 $k$ 对情侣和睦的就坐方案数。", "hint": "### 子任务\n\n对于 $10 \\%$ 的数据，满足 $1 \\leq T \\leq 10, 1 \\leq n \\leq 5$。\n\n对于 $40 \\%$ 的数据，满足 $1 \\leq n \\leq 3 \\times 10^3$。\n\n对于 $100 \\%$ 的数据，满足 $1 \\leq T \\leq 2 \\times 10^5, 1 \\leq n \\leq 5 \\times 10^6, 0 \\leq k \\leq n$。\n\n### 题目来源\n\n[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T2 加强版\n\n出题人：Imagine\n\n50167", "locale": "zh-CN"}}}
{"pid": "P4932", "type": "P", "difficulty": 4, "samples": [["8 98 24 20 100 44\n", "12\n"], ["1000 952537 601907 686180 1000000 673601\n", "249711\n"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "进制", "位运算", "洛谷月赛"], "title": "浏览器", "background": "\\_\\_stdcall 在用 Edge 玩 slay 的时候，鼠标会经常失灵，这让她十分痛苦，因此她决定也要让你们感受一下 Edge 制造的痛苦。", "description": "\\_\\_stdcall 给了你 $n$ 个点，第 $i$ 个点有权值 $x_i$，对于两个点 $u$ 和 $v$，如果 $x_u \\operatorname{xor}x_v$ 的结果在二进制表示下有奇数个 $1$，那么在 $u$ 和 $v$ 之间连接一个 Edge，现在 \\_\\_stdcall 想让你求出一共有多少个 Edge。\n\n如果你没能成功完成任务，那么 \\_\\_stdcall 会让你痛苦一下，你这个测试点就没分了。", "inputFormat": "一行六个整数，$n$，$a$，$b$，$c$，$d$，$x_0$。\n\n$n$ 是点的个数，每个点的权值需要用如下的方式生成。\n\n你需要使用 $a$，$b$，$c$，$d$ 和 $x_0$ 生成一个数组x，生成方式是这样的。\n\n$$x_i = (ax_{i-1}^2 + bx_{i-1} + c) \\bmod d$$\n\n$x_i$ 就是第 $i$ 个点的权值，点的标号是 $1$ 到 $n$。", "outputFormat": "输出一个整数，表示一共有多少个 Edge。", "hint": "我们用 $v$ 表示权值中的最大值。\n\n对于前 $20\\%$ 的数据，$n \\le 10$。\n\n对于前 $40\\%$ 的数据，$n \\le 100$。\n\n对于前 $60\\%$ 的数据，$n \\le 1000$。\n\n对于前 $80\\%$ 的数据，$n \\le 1 \\times 10^6$。\n\n对于前 $90\\%$ 的数据，$v \\le 1 \\times 10^6$。\n\n对于 $100\\%$ 的数据，$n \\le 1 \\times 10^7，v \\le 1 \\times 10^9$。\n\n保证 $a$，$b$，$c$，$d$，$x_0$ 都是 `int` 内的非负整数。", "locale": "zh-CN", "translations": {"en": {"title": "Browser", "background": "When playing Slay the Spire on Edge, __stdcall often finds that the mouse stops working, which makes her very upset. Therefore, she decided to let you experience the pain caused by Edge as well.", "description": "__stdcall gives you $n$ points. The $i$-th point has weight $x_i$. For two points $u$ and $v$, if the result of $x_u \\operatorname{xor}x_v$ has an odd number of $1$'s in its binary representation, then connect an Edge between $u$ and $v$. Now __stdcall wants you to find how many Edges there are in total.\n\nIf you fail to complete the task, then __stdcall will make you suffer a bit, and you will get no score for this test case.", "inputFormat": "One line with six integers: $n$, $a$, $b$, $c$, $d$, $x_0$.\n\n$n$ is the number of points. The weight of each point needs to be generated in the following way.\n\nYou need to use $a$, $b$, $c$, $d$, and $x_0$ to generate an array x. The generation method is:\n\n$$x_i = (ax_{i-1}^2 + bx_{i-1} + c) \\bmod d$$\n\n$x_i$ is the weight of the $i$-th point. The point indices are from $1$ to $n$.", "outputFormat": "Output one integer, representing the total number of Edges.", "hint": "Let $v$ denote the maximum value among the weights.\n\nFor the first $20\\%$ of the data, $n \\le 10$.\n\nFor the first $40\\%$ of the data, $n \\le 100$.\n\nFor the first $60\\%$ of the data, $n \\le 1000$.\n\nFor the first $80\\%$ of the data, $n \\le 1 \\times 10^6$.\n\nFor the first $90\\%$ of the data, $v \\le 1 \\times 10^6$.\n\nFor $100\\%$ of the data, $n \\le 1 \\times 10^7，v \\le 1 \\times 10^9$.\n\nIt is guaranteed that $a$, $b$, $c$, $d$, and $x_0$ are all non-negative integers within `int`.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "浏览器", "background": "\\_\\_stdcall 在用 Edge 玩 slay 的时候，鼠标会经常失灵，这让她十分痛苦，因此她决定也要让你们感受一下 Edge 制造的痛苦。", "description": "\\_\\_stdcall 给了你 $n$ 个点，第 $i$ 个点有权值 $x_i$，对于两个点 $u$ 和 $v$，如果 $x_u \\operatorname{xor}x_v$ 的结果在二进制表示下有奇数个 $1$，那么在 $u$ 和 $v$ 之间连接一个 Edge，现在 \\_\\_stdcall 想让你求出一共有多少个 Edge。\n\n如果你没能成功完成任务，那么 \\_\\_stdcall 会让你痛苦一下，你这个测试点就没分了。", "inputFormat": "一行六个整数，$n$，$a$，$b$，$c$，$d$，$x_0$。\n\n$n$ 是点的个数，每个点的权值需要用如下的方式生成。\n\n你需要使用 $a$，$b$，$c$，$d$ 和 $x_0$ 生成一个数组x，生成方式是这样的。\n\n$$x_i = (ax_{i-1}^2 + bx_{i-1} + c) \\bmod d$$\n\n$x_i$ 就是第 $i$ 个点的权值，点的标号是 $1$ 到 $n$。", "outputFormat": "输出一个整数，表示一共有多少个 Edge。", "hint": "我们用 $v$ 表示权值中的最大值。\n\n对于前 $20\\%$ 的数据，$n \\le 10$。\n\n对于前 $40\\%$ 的数据，$n \\le 100$。\n\n对于前 $60\\%$ 的数据，$n \\le 1000$。\n\n对于前 $80\\%$ 的数据，$n \\le 1 \\times 10^6$。\n\n对于前 $90\\%$ 的数据，$v \\le 1 \\times 10^6$。\n\n对于 $100\\%$ 的数据，$n \\le 1 \\times 10^7，v \\le 1 \\times 10^9$。\n\n保证 $a$，$b$，$c$，$d$，$x_0$ 都是 `int` 内的非负整数。", "locale": "zh-CN"}}}
{"pid": "P4933", "type": "P", "difficulty": 4, "samples": [["8\n13 14 6 20 27 34 34 41 \n", "50\n"], ["100\n90 1004 171 99 1835 108 81 117 141 126 135 144 81 153 193 81 962 162 1493 171 1780 864 297 180 532 1781 189 1059 198 333 1593 824 207 1877 216 270 225 1131 336 1875 362 234 81 288 1550 243 463 1755 252 406 261 270 279 288 1393 261 1263 297 135 333 872 234 881 180 198 81 225 306 180 90 315 81 81 198 252 81 297 1336 1140 1238 81 198 297 661 81 1372 469 1132 81 126 324 333 342 81 351 481 279 1770 1225 549 \n", "11153\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "O2优化", "枚举", "洛谷月赛"], "title": "大师", "background": "建筑大师最近在跟着数学大师 ljt12138 学数学，今天他学了等差数列，ljt12138 决定给他留一道练习题。", "description": "ljt12138 首先建了 $n$ 个特斯拉电磁塔，这些电塔排成一排，从左到右依次标号为 $1$ 到 $n$，第 $i$ 个电塔的高度为 $h[i]$。\n\n建筑大师需要从中选出一些电塔，然后这些电塔就会缩到地下去。这时候，如果留在地上的电塔的高度，从左向右构成了一个等差数列，那么这个选择方案就会被认为是美观的。\n\n建筑大师需要求出，一共有多少种美观的选择方案，答案模 $998244353$。\n\n注意，如果地上只留了一个或者两个电塔，那么这种方案也是美观的。地上没有电塔的方案被认为是不美观的。\n\n同时也要注意，等差数列的公差也可以为负数。", "inputFormat": "第一行一个正整数 $n$。\n\n第二行 $n$ 个非负整数，第 $i$ 个整数是第 $i$ 个电塔的高度 $h[i]$。", "outputFormat": "输出一个整数，表示美观的方案数模 $998244353$ 的值。\n", "hint": "设 $v$ 为最高的电塔高度。\n\n对于前 $30\\%$ 的数据，$n \\le 20 $。\n\n对于前 $60\\%$ 的数据，$n \\le 100$，$v \\le 2 \\times 10^3$。\n\n对于另外 $20\\%$ 的数据，所有电塔的高度构成一个等差数列。\n\n对于 $100\\%$ 的数据，$n \\le 10^3$，$v \\leq2 \\times 10^4$。", "locale": "zh-CN", "translations": {"en": {"title": "Master.", "background": "The architecture master has recently been learning math from the math master ljt12138. Today, he learned arithmetic sequences, and ljt12138 decided to leave him an exercise.", "description": "ljt12138 first built $n$ Tesla electromagnetic towers. These towers are arranged in a line and numbered from left to right from $1$ to $n$. The height of the $i$-th tower is $h[i]$.\n\nThe architecture master needs to choose some towers, and the chosen towers will shrink underground. At this time, if the heights of the towers that remain above ground form an arithmetic sequence from left to right, then this selection plan is considered beautiful.\n\nThe architecture master needs to find how many beautiful selection plans there are in total, and output the answer modulo $998244353$.\n\nNote that if only one or two towers remain above ground, this plan is also considered beautiful. A plan where no tower remains above ground is considered not beautiful.\n\nAlso note that the common difference of the arithmetic sequence can be negative.", "inputFormat": "The first line contains a positive integer $n$.\n\nThe second line contains $n$ non-negative integers. The $i$-th integer is the height $h[i]$ of the $i$-th tower.", "outputFormat": "Output one integer, representing the number of beautiful plans modulo $998244353$.", "hint": "Let $v$ be the maximum tower height.\n\nFor the first $30\\%$ of the testdata, $n \\le 20$.\n\nFor the first $60\\%$ of the testdata, $n \\le 100$, $v \\le 2 \\times 10^3$.\n\nFor the other $20\\%$ of the testdata, the heights of all towers form an arithmetic sequence.\n\nFor $100\\%$ of the testdata, $n \\le 10^3$, $v \\leq 2 \\times 10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "大师", "background": "建筑大师最近在跟着数学大师 ljt12138 学数学，今天他学了等差数列，ljt12138 决定给他留一道练习题。", "description": "ljt12138 首先建了 $n$ 个特斯拉电磁塔，这些电塔排成一排，从左到右依次标号为 $1$ 到 $n$，第 $i$ 个电塔的高度为 $h[i]$。\n\n建筑大师需要从中选出一些电塔，然后这些电塔就会缩到地下去。这时候，如果留在地上的电塔的高度，从左向右构成了一个等差数列，那么这个选择方案就会被认为是美观的。\n\n建筑大师需要求出，一共有多少种美观的选择方案，答案模 $998244353$。\n\n注意，如果地上只留了一个或者两个电塔，那么这种方案也是美观的。地上没有电塔的方案被认为是不美观的。\n\n同时也要注意，等差数列的公差也可以为负数。", "inputFormat": "第一行一个正整数 $n$。\n\n第二行 $n$ 个非负整数，第 $i$ 个整数是第 $i$ 个电塔的高度 $h[i]$。", "outputFormat": "输出一个整数，表示美观的方案数模 $998244353$ 的值。\n", "hint": "设 $v$ 为最高的电塔高度。\n\n对于前 $30\\%$ 的数据，$n \\le 20 $。\n\n对于前 $60\\%$ 的数据，$n \\le 100$，$v \\le 2 \\times 10^3$。\n\n对于另外 $20\\%$ 的数据，所有电塔的高度构成一个等差数列。\n\n对于 $100\\%$ 的数据，$n \\le 10^3$，$v \\leq2 \\times 10^4$。", "locale": "zh-CN"}}}
{"pid": "P4934", "type": "P", "difficulty": 6, "samples": [["5 3\n0 4 7 1 6 \n", "1\n4\n1 0\n2 1 4\n1 6\n1 7 "]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["Special Judge", "O2优化", "枚举", "排序", "拓扑排序", "洛谷月赛"], "title": "礼物", "background": "由于你出色的完成了前面两道题目，善良的 __stdcall 决定给你一个小礼物，给拼搏在 AK 这套题之路上的你，一个有力的援助。", "description": "__stdcall 决定给你 $n$ 个礼物，每个礼物有一个魔力值 $a_i$。\n\n这些礼物的魔力值都是独一无二的，两两互不相同。这些礼物都有着神奇的魔力，如果两个礼物 $i, j$ 的魔力值满足 $a_i \\operatorname{bitand} a_j \\ge \\min(a_i, a_j)$，那么这两个礼物的魔力将会相互抵消，因此它们不能放在一个箱子里。\n\n这里的 $\\operatorname{bitand}$ 表示按位与运算，如果你对这一运算不够了解，请参考：<https://baike.baidu.com/item/%E6%8C%89%E4%BD%8D%E4%B8%8E/9601818>。\n\n作为发礼物苦力的 ljt12138 的箱子并不多，不过幸运的是，每个箱子都足够大。现在他请求你帮助他合理分配，用**尽可能少**的箱子装下所有礼物。换言之，使得每个礼物都被恰好装入一个箱子中，且同一个箱子中的礼物魔力不会相互抵消。如果有多种合法的方案，你只需要给出**任意一种**。\n\nljt12138 十分善良，如果你只能求出所需要的箱子数，也可以获得该测试点 $60\\%$ 的分数，关于这一点，请参考下面的提示与说明。", "inputFormat": "- 第一行两个数 $n$ 和 $k$，$n$ 为礼物总数，$k$ 为一个参数，方便你进行计算。\n- 第二行 $n$ 个两两不同的数$a_i$，满足 $0\\le a_i < 2^k$，表示礼物的魔力值。", "outputFormat": "- 第一行输出一个数。如果你不希望输出方案，请输出0；如果你希望输出方案，请输出 $1$。**如果你在这一行输出了不符合要求的信息，将被判为 WA**。\n- 第二行一个数 $m$，表示你将礼物装到了 $m$ 个箱子里。\n- 如果你在第一行输出了 $1$，接下来 $m$ 行，每行表示一个箱子：首先一个数 $s_i$，表示当前箱子中礼物的个数；接下来 $s_i$ 个数，表示当前子集。", "hint": "### 附加样例\n\n你可以在  <https://pan.baidu.com/s/1A8_ZA4yXXi5y6771x9JKUw> 下载附加样例。\n\n### 关于输出方案\n\n- 如果你在第一行输出了 $0$，而正确回答了最小所需的箱子数，将获得测试点 $60\\%$ 的分数。\n- 如果你在第一行输出了 $1$，正确回答了最小所需的箱子数，但没有给出正确的方案，也将获得该测试点 $60\\%$ 的分数。\n- 如果你没有正确回答最小所需的箱子数，将不会获得该测试点的分数。\n- 请选手注意，如果你未按照上述格式输出答案，将无法获得任何分数。\n\n数据 $n, k$ 的关系由下面的表格给出：\n\n|数据编号| $n$ | $k$ |\n|:----:|:----:|:----:|\n|$1$|$5$|$3$|\n|$2$|$6$|$3$|\n|$3$|$7$|$10$|\n|$4$|$8$|$10$|\n|$5$|$16$|$7$|\n|$6$|$17$|$8$|\n|$7$|$17$|$9$|\n|$8$|$17$|$20$|\n|$9$|$2\\times 10^3$|$17$|\n|$10$|$2.5\\times 10^3$|$18$|\n|$11$|$3\\times 10^3$|$19$|\n|$12$|$3\\times 10^3$|$20$|\n|$13$|$2.5\\times 10^4$|$15$|\n|$14$|$2.5\\times 10^4$|$15$|\n|$15$|$5\\times 10^4$|$16$|\n|$16$|$5\\times 10^4$|$16$|\n|$17$|$2.5\\times 10^5$|$18$|\n|$18$|$5\\times 10^5$|$19$|\n|$19$|$10^6$|$20$|\n|$20$|$10^6$|$20$|", "locale": "zh-CN", "translations": {"en": {"title": "Gift", "background": "Because you did an excellent job on the previous two problems, the kind __stdcall decided to give you a small gift, providing strong support for you who are striving to AK this problem set.", "description": "__stdcall decided to give you $n$ gifts. Each gift has a magic value $a_i$.\n\nAll magic values are unique, i.e., pairwise distinct. These gifts have magical power: if for two gifts $i, j$, their magic values satisfy $a_i \\operatorname{bitand} a_j \\ge \\min(a_i, a_j)$, then their magic will cancel each other out, so they cannot be put into the same box.\n\nHere $\\operatorname{bitand}$ denotes the bitwise AND operation. If you are not familiar with it, please refer to: <https://baike.baidu.com/item/%E6%8C%89%E4%BD%8D%E4%B8%8E/9601818>.\n\nAs the gift delivery worker, ljt12138 does not have many boxes, but luckily each box is large enough. Now he asks you to help him distribute the gifts properly, using **as few** boxes as possible. In other words, make sure every gift is placed into exactly one box, and the gifts in the same box will not cancel each other out. If there are multiple valid solutions, you only need to output **any one**.\n\nljt12138 is very kind: if you can only compute the required number of boxes, you can still get $60\\%$ of the score for that test point. For details, see the hints and explanations below.", "inputFormat": "- The first line contains two numbers $n$ and $k$, where $n$ is the total number of gifts, and $k$ is a parameter to help you compute.\n- The second line contains $n$ pairwise distinct numbers $a_i$, satisfying $0 \\le a_i < 2^k$, representing the magic values of the gifts.", "outputFormat": "- Output one number on the first line. If you do not want to output an assignment, output $0$; if you want to output an assignment, output $1$. **If you output invalid information on this line, you will be judged as WA**.\n- Output one number $m$ on the second line, indicating that you packed the gifts into $m$ boxes.\n- If you output $1$ on the first line, then output the next $m$ lines, each describing one box: first a number $s_i$, the number of gifts in the current box; then $s_i$ numbers describing the current subset.", "hint": "### Additional Samples\n\nYou can download additional samples at <https://pan.baidu.com/s/1A8_ZA4yXXi5y6771x9JKUw>.\n\n### About Outputting an Assignment\n\n- If you output $0$ on the first line and correctly answer the minimum number of boxes needed, you will get $60\\%$ of the score for that test point.\n- If you output $1$ on the first line, correctly answer the minimum number of boxes needed, but do not provide a correct assignment, you will also get $60\\%$ of the score for that test point.\n- If you do not correctly answer the minimum number of boxes needed, you will not get the score for that test point.\n- Please note that if you do not output in the format above, you will not receive any score.\n\nThe relationship between $n$ and $k$ is given by the table below:\n\n|Data ID| $n$ | $k$ |\n|:----:|:----:|:----:|\n|$1$|$5$|$3$|\n|$2$|$6$|$3$|\n|$3$|$7$|$10$|\n|$4$|$8$|$10$|\n|$5$|$16$|$7$|\n|$6$|$17$|$8$|\n|$7$|$17$|$9$|\n|$8$|$17$|$20$|\n|$9$|$2\\times 10^3$|$17$|\n|$10$|$2.5\\times 10^3$|$18$|\n|$11$|$3\\times 10^3$|$19$|\n|$12$|$3\\times 10^3$|$20$|\n|$13$|$2.5\\times 10^4$|$15$|\n|$14$|$2.5\\times 10^4$|$15$|\n|$15$|$5\\times 10^4$|$16$|\n|$16$|$5\\times 10^4$|$16$|\n|$17$|$2.5\\times 10^5$|$18$|\n|$18$|$5\\times 10^5$|$19$|\n|$19$|$10^6$|$20$|\n|$20$|$10^6$|$20$|\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "礼物", "background": "由于你出色的完成了前面两道题目，善良的 __stdcall 决定给你一个小礼物，给拼搏在 AK 这套题之路上的你，一个有力的援助。", "description": "__stdcall 决定给你 $n$ 个礼物，每个礼物有一个魔力值 $a_i$。\n\n这些礼物的魔力值都是独一无二的，两两互不相同。这些礼物都有着神奇的魔力，如果两个礼物 $i, j$ 的魔力值满足 $a_i \\operatorname{bitand} a_j \\ge \\min(a_i, a_j)$，那么这两个礼物的魔力将会相互抵消，因此它们不能放在一个箱子里。\n\n这里的 $\\operatorname{bitand}$ 表示按位与运算，如果你对这一运算不够了解，请参考：<https://baike.baidu.com/item/%E6%8C%89%E4%BD%8D%E4%B8%8E/9601818>。\n\n作为发礼物苦力的 ljt12138 的箱子并不多，不过幸运的是，每个箱子都足够大。现在他请求你帮助他合理分配，用**尽可能少**的箱子装下所有礼物。换言之，使得每个礼物都被恰好装入一个箱子中，且同一个箱子中的礼物魔力不会相互抵消。如果有多种合法的方案，你只需要给出**任意一种**。\n\nljt12138 十分善良，如果你只能求出所需要的箱子数，也可以获得该测试点 $60\\%$ 的分数，关于这一点，请参考下面的提示与说明。", "inputFormat": "- 第一行两个数 $n$ 和 $k$，$n$ 为礼物总数，$k$ 为一个参数，方便你进行计算。\n- 第二行 $n$ 个两两不同的数$a_i$，满足 $0\\le a_i < 2^k$，表示礼物的魔力值。", "outputFormat": "- 第一行输出一个数。如果你不希望输出方案，请输出0；如果你希望输出方案，请输出 $1$。**如果你在这一行输出了不符合要求的信息，将被判为 WA**。\n- 第二行一个数 $m$，表示你将礼物装到了 $m$ 个箱子里。\n- 如果你在第一行输出了 $1$，接下来 $m$ 行，每行表示一个箱子：首先一个数 $s_i$，表示当前箱子中礼物的个数；接下来 $s_i$ 个数，表示当前子集。", "hint": "### 附加样例\n\n你可以在  <https://pan.baidu.com/s/1A8_ZA4yXXi5y6771x9JKUw> 下载附加样例。\n\n### 关于输出方案\n\n- 如果你在第一行输出了 $0$，而正确回答了最小所需的箱子数，将获得测试点 $60\\%$ 的分数。\n- 如果你在第一行输出了 $1$，正确回答了最小所需的箱子数，但没有给出正确的方案，也将获得该测试点 $60\\%$ 的分数。\n- 如果你没有正确回答最小所需的箱子数，将不会获得该测试点的分数。\n- 请选手注意，如果你未按照上述格式输出答案，将无法获得任何分数。\n\n数据 $n, k$ 的关系由下面的表格给出：\n\n|数据编号| $n$ | $k$ |\n|:----:|:----:|:----:|\n|$1$|$5$|$3$|\n|$2$|$6$|$3$|\n|$3$|$7$|$10$|\n|$4$|$8$|$10$|\n|$5$|$16$|$7$|\n|$6$|$17$|$8$|\n|$7$|$17$|$9$|\n|$8$|$17$|$20$|\n|$9$|$2\\times 10^3$|$17$|\n|$10$|$2.5\\times 10^3$|$18$|\n|$11$|$3\\times 10^3$|$19$|\n|$12$|$3\\times 10^3$|$20$|\n|$13$|$2.5\\times 10^4$|$15$|\n|$14$|$2.5\\times 10^4$|$15$|\n|$15$|$5\\times 10^4$|$16$|\n|$16$|$5\\times 10^4$|$16$|\n|$17$|$2.5\\times 10^5$|$18$|\n|$18$|$5\\times 10^5$|$19$|\n|$19$|$10^6$|$20$|\n|$20$|$10^6$|$20$|", "locale": "zh-CN"}}}
{"pid": "P4935", "type": "P", "difficulty": 7, "samples": [["2 3 3", "15"], ["4 7 5", "2845"], ["70 43 22", "992103136"], ["500 2011 999980895", "767094932"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "素数判断,质数,筛法", "生成函数", "洛谷月赛"], "title": "口袋里的纸飞机", "background": "现在我来到自己的故事难以用语言描绘的中心。文字的匮乏感从现在开始体现出来，因为描绘任何事物都要以交谈者共有的认知为前提，而我所经历的是比任何生活都更上一层的体验。先贤们在向普罗大众描绘世界之外的事物时往往运用宏大的概念。中国的道学家说天有九霄。《吠陀经》提到我们生存的土地只是千万重复制中的一个。爱斯基摩人则认为万物由一枚巨卵孵化而出。一个更恰当的比喻是所谓狄拉克之海，也即是全部空间和时间的上方和外部。虽然用有限的话语不可能描述一个无限的实体，但我记住了它的一部分，或许是最重要的一部分：\n\n\n我看见无限宽阔的海面和无限广袤的天穹，两者在无穷远处的地平线相接。视野的最中央站着一个紫色长发的女孩。我的身份和她不同：我是受她邀请而来的访客，海上的女孩才是这里的居民，或者说囚徒。正如我们不能随意造访世界之上的世界，她也永远不能和我们的生活有任何一点的交集。我明白自己在这里不会待上太久，而她把我招来只能为了一个理由。于是我听见了自己的声音在海面上回响，消散进虚无之中：\n\n\n“我会记住你。”\n\n\n她对我露出笑容。白色的光芒再一次亮起，女孩的身影好似被无形的火焰灼烧一样逐渐消散。我明白自己留不住这一刻，于是我哭了。使我哭泣的并不只是永恒的离别，还有对这个曾经在无尽的时间中陪伴过我们的孩子的怜惜和忏悔。\n我感到无限崇敬，无限悲哀。\n\n\n——西酱《口袋》", "description": "一个大小为$n$的数列$\\{a_i\\}$，每个数都在范围$[1,R]$中\n\n对于每种数列，可以生成一个$n\\times n$的网格，其中格子$(i,j)$中的数为$a_i\\times a_j \\mod P$\n\n比如，如果数列是$\\{1,2,3\\},P=5$，则生成的网格为\n```\n1 2 3\n2 4 1\n3 1 4(因为2*3%5=1,3*3%5=4)\n```\n\n对于一个网格，定义法法值为其中不同的数个数，比如上面那个就是4个数，即$\\{1,2,3,4\\}$。\n\n现在你需要对所有数列的法法值的和对$10^9+7$取模", "inputFormat": "第一行输入正整数$n,P,R$", "outputFormat": "输出答案对$10^9+7$取模", "hint": "样例1解释：\n```\n{ai}={1,1}:\n1 1\n1 1\n(ans=1)\n{ai}={1,2}:\n1 2\n2 1\n(ans=2)\n{ai}={1,3}:\n1 0\n0 0\n(ans=2)\n{ai}={2,1}:\n1 2\n2 1\n(ans=2)\n{ai}={2,2}:\n1 1\n1 1\n(ans=1)\n{ai}={2,3}:\n1 0\n0 0\n(ans=2)\n{ai}={3,1}:\n0 0\n0 1\n(ans=2)\n{ai}={3,2}:\n0 0\n0 1\n(ans=2)\n{ai}={3,3}:\n0 0\n0 0\n(ans=1)\n一共为15\n```\n\n\n保证$P$为大于等于3的质数\n\n|测试点|N|R|P|\n|---|---|---|---|\n|1,2|$N\\leq 5$|$R\\leq 5$|$R\\times R<P\\leq 20$|\n|3,4,5,6|$N\\leq 15$|$R\\leq 10$|$R\\times R<P\\leq 200$|\n|7,8|$N\\leq 30$| |$R\\times R<P\\leq 500$|\n|9,10,11,12|$N\\leq 100$| |$R\\times R<P\\leq 500$|\n|13,14,15,16|$N\\leq 300$|$R\\leq 10^9$|$P\\leq 1000$|\n|17,18,19,20|$N\\leq 500$|$R\\leq 10^9$|$P\\leq 5000$|\n\n对于所有数据，$n\\leq 500,P\\leq 5000,R\\leq 10^9$", "locale": "zh-CN", "translations": {"en": {"title": "Paper Airplane in the Pocket", "background": "Now I have come to the center of my own story, which is hard to describe with words. From this moment on, the lack of language begins to show, because describing anything depends on shared understanding between speakers, and what I experienced was an experience beyond any ordinary life. When the sages described things beyond this world to the public, they often used grand concepts. Chinese Taoist scholars say the heavens have nine layers. The Vedas mention that the land we live on is only one of countless copies. The Eskimos believe that everything hatched from a giant egg. A more suitable metaphor is the so-called Dirac sea, that is, above and outside all space and time. Although it is impossible to describe an infinite entity with limited words, I remembered a part of it, perhaps the most important part:\n\nI saw an infinitely wide sea and an infinitely vast sky, meeting at the horizon infinitely far away. At the very center of my view stood a girl with long purple hair. My identity was different from hers: I was a visitor invited by her, while the girl on the sea was the resident here, or rather, a prisoner. Just as we cannot freely visit a world above our world, she can never have even the slightest intersection with our life. I understood that I would not stay here for long, and she could only have called me here for one reason. Then I heard my own voice echo over the sea, fading into the void:\n\n“I will remember you.”\n\nShe smiled at me. The white light lit up once again, and the girl’s figure gradually dissipated as if scorched by invisible flames. I understood that I could not keep this moment, so I cried. What made me cry was not only the eternal farewell, but also pity and remorse for this child who had once accompanied us through endless time.  \nI felt infinite reverence, infinite sorrow.\n\n— Xi Jiang, “Pocket”.", "description": "Given a sequence of length $n$, $\\{a_i\\}$, where each number is in the range $[1,R]$.\n\nFor each sequence, you can generate an $n\\times n$ grid, where the value in cell $(i,j)$ is $a_i\\times a_j \\bmod P$.\n\nFor example, if the sequence is $\\{1,2,3\\}$ and $P=5$, then the generated grid is\n```\n1 2 3\n2 4 1\n3 1 4(因为2*3%5=1,3*3%5=4)\n```\n\nFor a grid, define its “fafa value” as the number of distinct values appearing in it. For the grid above, it is $4$, i.e. $\\{1,2,3,4\\}$.\n\nNow you need to compute the sum of the fafa values over all sequences, and take it modulo $10^9+7$.", "inputFormat": "The first line contains positive integers $n,P,R$.", "outputFormat": "Output the answer modulo $10^9+7$.", "hint": "Explanation for Sample 1:\n```\n{ai}={1,1}:\n1 1\n1 1\n(ans=1)\n{ai}={1,2}:\n1 2\n2 1\n(ans=2)\n{ai}={1,3}:\n1 0\n0 0\n(ans=2)\n{ai}={2,1}:\n1 2\n2 1\n(ans=2)\n{ai}={2,2}:\n1 1\n1 1\n(ans=1)\n{ai}={2,3}:\n1 0\n0 0\n(ans=2)\n{ai}={3,1}:\n0 0\n0 1\n(ans=2)\n{ai}={3,2}:\n0 0\n0 1\n(ans=2)\n{ai}={3,3}:\n0 0\n0 0\n(ans=1)\nTotal is 15.\n```\n\nIt is guaranteed that $P$ is a prime number with $P\\geq 3$.\n\n## Constraints\n\n|Test Point|$N$|$R$|$P$|\n|---|---|---|---|\n|1,2|$N\\leq 5$|$R\\leq 5$|$R\\times R<P\\leq 20$|\n|3,4,5,6|$N\\leq 15$|$R\\leq 10$|$R\\times R<P\\leq 200$|\n|7,8|$N\\leq 30$| |$R\\times R<P\\leq 500$|\n|9,10,11,12|$N\\leq 100$| |$R\\times R<P\\leq 500$|\n|13,14,15,16|$N\\leq 300$|$R\\leq 10^9$|$P\\leq 1000$|\n|17,18,19,20|$N\\leq 500$|$R\\leq 10^9$|$P\\leq 5000$|\n\nFor all data, $n\\leq 500,P\\leq 5000,R\\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "口袋里的纸飞机", "background": "现在我来到自己的故事难以用语言描绘的中心。文字的匮乏感从现在开始体现出来，因为描绘任何事物都要以交谈者共有的认知为前提，而我所经历的是比任何生活都更上一层的体验。先贤们在向普罗大众描绘世界之外的事物时往往运用宏大的概念。中国的道学家说天有九霄。《吠陀经》提到我们生存的土地只是千万重复制中的一个。爱斯基摩人则认为万物由一枚巨卵孵化而出。一个更恰当的比喻是所谓狄拉克之海，也即是全部空间和时间的上方和外部。虽然用有限的话语不可能描述一个无限的实体，但我记住了它的一部分，或许是最重要的一部分：\n\n\n我看见无限宽阔的海面和无限广袤的天穹，两者在无穷远处的地平线相接。视野的最中央站着一个紫色长发的女孩。我的身份和她不同：我是受她邀请而来的访客，海上的女孩才是这里的居民，或者说囚徒。正如我们不能随意造访世界之上的世界，她也永远不能和我们的生活有任何一点的交集。我明白自己在这里不会待上太久，而她把我招来只能为了一个理由。于是我听见了自己的声音在海面上回响，消散进虚无之中：\n\n\n“我会记住你。”\n\n\n她对我露出笑容。白色的光芒再一次亮起，女孩的身影好似被无形的火焰灼烧一样逐渐消散。我明白自己留不住这一刻，于是我哭了。使我哭泣的并不只是永恒的离别，还有对这个曾经在无尽的时间中陪伴过我们的孩子的怜惜和忏悔。\n我感到无限崇敬，无限悲哀。\n\n\n——西酱《口袋》", "description": "一个大小为$n$的数列$\\{a_i\\}$，每个数都在范围$[1,R]$中\n\n对于每种数列，可以生成一个$n\\times n$的网格，其中格子$(i,j)$中的数为$a_i\\times a_j \\mod P$\n\n比如，如果数列是$\\{1,2,3\\},P=5$，则生成的网格为\n```\n1 2 3\n2 4 1\n3 1 4(因为2*3%5=1,3*3%5=4)\n```\n\n对于一个网格，定义法法值为其中不同的数个数，比如上面那个就是4个数，即$\\{1,2,3,4\\}$。\n\n现在你需要对所有数列的法法值的和对$10^9+7$取模", "inputFormat": "第一行输入正整数$n,P,R$", "outputFormat": "输出答案对$10^9+7$取模", "hint": "样例1解释：\n```\n{ai}={1,1}:\n1 1\n1 1\n(ans=1)\n{ai}={1,2}:\n1 2\n2 1\n(ans=2)\n{ai}={1,3}:\n1 0\n0 0\n(ans=2)\n{ai}={2,1}:\n1 2\n2 1\n(ans=2)\n{ai}={2,2}:\n1 1\n1 1\n(ans=1)\n{ai}={2,3}:\n1 0\n0 0\n(ans=2)\n{ai}={3,1}:\n0 0\n0 1\n(ans=2)\n{ai}={3,2}:\n0 0\n0 1\n(ans=2)\n{ai}={3,3}:\n0 0\n0 0\n(ans=1)\n一共为15\n```\n\n\n保证$P$为大于等于3的质数\n\n|测试点|N|R|P|\n|---|---|---|---|\n|1,2|$N\\leq 5$|$R\\leq 5$|$R\\times R<P\\leq 20$|\n|3,4,5,6|$N\\leq 15$|$R\\leq 10$|$R\\times R<P\\leq 200$|\n|7,8|$N\\leq 30$| |$R\\times R<P\\leq 500$|\n|9,10,11,12|$N\\leq 100$| |$R\\times R<P\\leq 500$|\n|13,14,15,16|$N\\leq 300$|$R\\leq 10^9$|$P\\leq 1000$|\n|17,18,19,20|$N\\leq 500$|$R\\leq 10^9$|$P\\leq 5000$|\n\n对于所有数据，$n\\leq 500,P\\leq 5000,R\\leq 10^9$", "locale": "zh-CN"}}}
{"pid": "P4936", "type": "P", "difficulty": 3, "samples": [["3", "5"], ["6", "129"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["O2优化"], "title": "Agent1", "background": "2018年11月17日，中国香港将会迎来一场`XM大战`，是世界各地的`ENLIGHTENED`与`RESISTANCE`开战的地点，某地 的`ENLIGHTENED总部`也想派`Agent`去参加这次的`XM大战`，与世界其他地方的`ENLIGHTENED`并肩作战。", "description": "某地的`ENLIGHTENED总部`总部有$N$个`Agent`，每个`Agent`的能力值互不相同，现在`ENLIGHTENED行动指挥`想要派出$A,B$两队`Agent`去参加`XM大战`。但是参加大战的两个队伍要满足两个要求：\n\n1. $A$队中能力最大的`Agent`的能力值要小于$B$队能力最弱的`Agent`的能力值。\n2. $A,B$两队都要有人参战。\n\n并不一定所有的`Agent`都要去参加`XM大战`的，心急的`ENLIGHTENED行动指挥`想知道有多少种安排`Agent`参加大战的方案。由于答案可能很大，所以只需要你求出答案模$(10^9+7)$的值就可以了。", "inputFormat": "输入仅一行，为一个整数$N$。", "outputFormat": "输出答案模$(10^9+7)$的值。", "hint": "对于$20\\%$的数据 $N \\leq 10$\n\n对于$40\\%$的数据 $N \\leq 10^3$\n\n对于$60\\%$的数据 $N \\leq 10^5$\n\n对于$100\\%$的数据 $N \\leq 10^9$", "locale": "zh-CN", "translations": {"en": {"title": "Agent1", "background": "On November 17, 2018, Hong Kong, China will host an `XM war`, where `ENLIGHTENED` and `RESISTANCE` from all over the world will fight. An `ENLIGHTENED headquarters` in some place also wants to send `Agents` to join this `XM war`, fighting side by side with `ENLIGHTENED` from other places.", "description": "An `ENLIGHTENED headquarters` in some place has $N$ `Agents`, and each `Agent` has a different ability value. Now the `ENLIGHTENED operation commander` wants to send two teams of `Agents`, Team $A$ and Team $B$, to take part in the `XM war`. However, the two teams must satisfy two requirements:\n\n1. The ability value of the strongest `Agent` in Team $A$ must be less than the ability value of the weakest `Agent` in Team $B$.\n2. Both Team $A$ and Team $B$ must have at least one person.\n\nNot all `Agents` must go to the `XM war`. The impatient `ENLIGHTENED operation commander` wants to know how many different ways there are to arrange `Agents` to join the war. Since the answer may be very large, you only need to output the value of the answer modulo $(10^9+7)$.", "inputFormat": "The input contains only one line, an integer $N$.", "outputFormat": "Output the answer modulo $(10^9+7)$.", "hint": "For $20\\%$ of the testdata, $N \\leq 10$.\n\nFor $40\\%$ of the testdata, $N \\leq 10^3$.\n\nFor $60\\%$ of the testdata, $N \\leq 10^5$.\n\nFor $100\\%$ of the testdata, $N \\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Agent1", "background": "2018年11月17日，中国香港将会迎来一场`XM大战`，是世界各地的`ENLIGHTENED`与`RESISTANCE`开战的地点，某地 的`ENLIGHTENED总部`也想派`Agent`去参加这次的`XM大战`，与世界其他地方的`ENLIGHTENED`并肩作战。", "description": "某地的`ENLIGHTENED总部`总部有$N$个`Agent`，每个`Agent`的能力值互不相同，现在`ENLIGHTENED行动指挥`想要派出$A,B$两队`Agent`去参加`XM大战`。但是参加大战的两个队伍要满足两个要求：\n\n1. $A$队中能力最大的`Agent`的能力值要小于$B$队能力最弱的`Agent`的能力值。\n2. $A,B$两队都要有人参战。\n\n并不一定所有的`Agent`都要去参加`XM大战`的，心急的`ENLIGHTENED行动指挥`想知道有多少种安排`Agent`参加大战的方案。由于答案可能很大，所以只需要你求出答案模$(10^9+7)$的值就可以了。", "inputFormat": "输入仅一行，为一个整数$N$。", "outputFormat": "输出答案模$(10^9+7)$的值。", "hint": "对于$20\\%$的数据 $N \\leq 10$\n\n对于$40\\%$的数据 $N \\leq 10^3$\n\n对于$60\\%$的数据 $N \\leq 10^5$\n\n对于$100\\%$的数据 $N \\leq 10^9$", "locale": "zh-CN"}}}
{"pid": "P4937", "type": "P", "difficulty": 5, "samples": [["3\n5 6 5\n1 8 2\n2 7 3\n", "7\n2\n1 2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["Special Judge"], "title": "Portal1", "background": "Agent 获取资源有很多种方式，HACK 就是其中的一种，侵入 Portal 可以获得很多有用的资源。\n\nENLIGHTENED 总部因为参加 XM 大战，只剩下一点点可用资源了，所以 ENLIGHTENED 行动指挥想要进行 HACK 活动，尽量增加库存。", "description": "地图上有 $n$ 个可以被 HACK 的 Portal，编号为 $1\\sim n$。HACK 第 $i$ 号 Portal 需要时间 $t_i$ 秒，可以 HACK 出 $c_i$ 库存的资源。可是只有有能量的 Portal 才可以 HACK 出资源。第 $i$ 号 Portal 在第 $d_i$ 秒时，能量就会消失殆尽。ENLIGHTEDED 想知道，最多可以增加多少库存，并且按编号小到大输出需要 HACK 的 Portal 的编号。", "inputFormat": "第一行输入一个整数 $n$。\n\n下接 $n$ 行，每行三个整数 $t_i$，$d_i$，$c_i$。", "outputFormat": "输出第一行为一个整数，最多可以增加多少库存。\n\n第二行为一个整数，代表需要 HACK 多少个 Portal。\n\n第三行按编号小到大输出需要 HACK 的 Portal 的编号，若有多种 HACK 的方案输出其中一种即可。", "hint": "对于 $20\\%$ 的数据，$n\\leq5$，$t_i\\leq 5$，$c_i\\leq 5$，$d_i\\leq10$。\n\n对于 $40\\%$ 的数据，$n\\leq 20$，$t_i\\leq 10$，$c_i\\leq 10$，$d_i\\leq 100$。\n\n对于 $60\\%$ 的数据，$n\\leq50$，$t_i\\leq15$，$c_i\\leq15$，$d_i\\leq1000$。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 100$，$1 \\leq t_i \\leq 20$，$1\\leq c_i \\leq 20$，$1 \\leq d_i \\leq 2000$。", "locale": "zh-CN", "translations": {"en": {"title": "Portal1", "background": "There are many ways for an Agent to obtain resources, and HACK is one of them. By breaking into a Portal, you can get many useful resources.\n\nBecause the ENLIGHTENED headquarters joined the XM war, there are only a small amount of usable resources left. Therefore, the ENLIGHTENED operation commander wants to carry out HACK activities to increase the inventory as much as possible.", "description": "There are $n$ Portals on the map that can be HACKed, numbered from $1$ to $n$. HACKing Portal $i$ takes $t_i$ seconds and can produce $c_i$ resources to add to the inventory. However, only Portals with energy can produce resources when HACKed. For Portal $i$, its energy will be completely depleted at time $d_i$ seconds. ENLIGHTENED wants to know the maximum amount the inventory can be increased, and also output the indices of the Portals that need to be HACKed in increasing order.", "inputFormat": "The first line contains an integer $n$.\n\nThe next $n$ lines each contain three integers $t_i$, $d_i$, $c_i$.", "outputFormat": "The first line outputs an integer: the maximum amount the inventory can be increased.\n\nThe second line outputs an integer: how many Portals need to be HACKed.\n\nThe third line outputs the indices of the Portals to be HACKed in increasing order. If there are multiple valid HACK plans, output any one of them.", "hint": "For $20\\%$ of the data, $n\\leq5$, $t_i\\leq 5$, $c_i\\leq 5$, $d_i\\leq10$.\n\nFor $40\\%$ of the data, $n\\leq 20$, $t_i\\leq 10$, $c_i\\leq 10$, $d_i\\leq 100$.\n\nFor $60\\%$ of the data, $n\\leq50$, $t_i\\leq15$, $c_i\\leq15$, $d_i\\leq1000$.\n\nFor $100\\%$ of the data, $1\\leq n\\leq 100$, $1 \\leq t_i \\leq 20$, $1\\leq c_i \\leq 20$, $1 \\leq d_i \\leq 2000$。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Portal1", "background": "Agent 获取资源有很多种方式，HACK 就是其中的一种，侵入 Portal 可以获得很多有用的资源。\n\nENLIGHTENED 总部因为参加 XM 大战，只剩下一点点可用资源了，所以 ENLIGHTENED 行动指挥想要进行 HACK 活动，尽量增加库存。", "description": "地图上有 $n$ 个可以被 HACK 的 Portal，编号为 $1\\sim n$。HACK 第 $i$ 号 Portal 需要时间 $t_i$ 秒，可以 HACK 出 $c_i$ 库存的资源。可是只有有能量的 Portal 才可以 HACK 出资源。第 $i$ 号 Portal 在第 $d_i$ 秒时，能量就会消失殆尽。ENLIGHTEDED 想知道，最多可以增加多少库存，并且按编号小到大输出需要 HACK 的 Portal 的编号。", "inputFormat": "第一行输入一个整数 $n$。\n\n下接 $n$ 行，每行三个整数 $t_i$，$d_i$，$c_i$。", "outputFormat": "输出第一行为一个整数，最多可以增加多少库存。\n\n第二行为一个整数，代表需要 HACK 多少个 Portal。\n\n第三行按编号小到大输出需要 HACK 的 Portal 的编号，若有多种 HACK 的方案输出其中一种即可。", "hint": "对于 $20\\%$ 的数据，$n\\leq5$，$t_i\\leq 5$，$c_i\\leq 5$，$d_i\\leq10$。\n\n对于 $40\\%$ 的数据，$n\\leq 20$，$t_i\\leq 10$，$c_i\\leq 10$，$d_i\\leq 100$。\n\n对于 $60\\%$ 的数据，$n\\leq50$，$t_i\\leq15$，$c_i\\leq15$，$d_i\\leq1000$。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 100$，$1 \\leq t_i \\leq 20$，$1\\leq c_i \\leq 20$，$1 \\leq d_i \\leq 2000$。", "locale": "zh-CN"}}}
{"pid": "P4938", "type": "P", "difficulty": 6, "samples": [["3 2 \n1 2 3\n0 0 6\n1 3\n2 3\n", "YES\n0 0 1\n0 0 2\n0 0 3 "], ["3 2 \n1 2 3\n0 0 7\n1 3\n2 3", "NO"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["网络流", "Special Judge"], "title": "War1", "background": "`XM` 大战来临之际，`ENLIGHTENED` 总部为了抵御 `RESISTANCE` 的进攻，调整了某地 `Portal` 的能量值，使得其可以经受更多的打击。", "description": "`ENLIGHTENED` 总部有 $N$ 个 `Portal`，编号为 $1\\sim N$，编号为 $i$ 的`Portal`初始能量值为 $A_i$，在 `Portal` 之间有 $M$ 条 `LINK`，每条 `LINK` 着连接着两个不同 `Portal`，被连接着的两个 `Portal` 可以相互传输能量，每个 `Portal` 最多总共只能向其连接着的 `Portal` 传输 $A_i$ 点能量，现在 `ENLIGHTENED` 行动指挥想让每第 $i$ 个 `Portal` 的能量值变为至少 $B_i$，但他不知道着可不可行，所以找到了你，如果可行的话，需要你求出一种可行的能量传输方案。\n\n**能量只能直接传输不能间接传输**", "inputFormat": "第一行数两个个整数 $N,M$。\n\n第二行有 $N$ 个整数，第 $i$ 个整数代表 $A_i$。\n\n第三行有 $N$ 个整数，第 $i$ 个整数代表 $B_i$。\n\n下接 $M$ 行，每行输入两个整数 $X,Y$，代表编号为 $X$ 的 `Portal` 到编号为 $Y$ 的 `Portal` 有一条 `LINK`。", "outputFormat": "若有可行方案输出 `YES`，并且下接 $N$ 行，每行 $N$ 个整数，第 $i$ 行第 $j$ 个数代表代表编号为 $i$ 的 `Portal` 向编号为 $j$ 的 `Portal` 传输的能量值。若 $i=j$ 输出第 $i$ 个 `Portal` 传输后留下的能量值。若有多种可行方案输出其中一种即可。\n\n若无可行方案输出 `NO`。", "hint": "对于 $20\\%$ 的数据 $N \\leq 10$。\n\n对于 $40\\%$ 的数据 $N\\leq 25$。\n\n对于 $60\\%$ 的数据 $N\\leq 50$。\n\n对于 $100\\%$ 的数据 $N \\leq 100,M \\leq 2*N,0 \\leq A_i,B_i \\leq 100$。", "locale": "zh-CN", "translations": {"en": {"title": "War1", "background": "As the `XM` war is approaching, the `ENLIGHTENED` headquarters, in order to withstand the attack from `RESISTANCE`, adjusted the energy value of a `Portal` in some place so that it can take more hits.", "description": "`ENLIGHTENED` headquarters has $N$ `Portal`s, numbered from $1$ to $N$. The initial energy value of `Portal` $i$ is $A_i$. There are $M$ `LINK`s between the `Portal`s. Each `LINK` connects two different `Portal`s. The two connected `Portal`s can transfer energy to each other. Each `Portal` can transfer at most a total of $A_i$ energy to the `Portal`s connected to it.\n\nNow, the `ENLIGHTENED` operation commander wants the energy value of each `Portal` $i$ to become at least $B_i$, but he does not know whether this is possible, so he asked you. If it is possible, you need to find one feasible energy transfer plan.\n\n**Energy can only be transferred directly, not indirectly.**", "inputFormat": "The first line contains two integers $N, M$.\n\nThe second line contains $N$ integers, where the $i$-th integer represents $A_i$.\n\nThe third line contains $N$ integers, where the $i$-th integer represents $B_i$.\n\nThen follow $M$ lines. Each line contains two integers $X, Y$, indicating that there is a `LINK` between `Portal` $X$ and `Portal` $Y$.", "outputFormat": "If there is a feasible plan, output `YES`, followed by $N$ lines, each containing $N$ integers. The number in row $i$ and column $j$ represents the amount of energy transferred from `Portal` $i$ to `Portal` $j$. If $i = j$, output the amount of energy remaining in `Portal` $i$ after transfers. If there are multiple feasible plans, output any one of them.\n\nIf there is no feasible plan, output `NO`.", "hint": "For $20\\%$ of the testdata, $N \\leq 10$.\n\nFor $40\\%$ of the testdata, $N \\leq 25$.\n\nFor $60\\%$ of the testdata, $N \\leq 50$.\n\nFor $100\\%$ of the testdata, $N \\leq 100$, $M \\leq 2 * N$, and $0 \\leq A_i, B_i \\leq 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "War1", "background": "`XM` 大战来临之际，`ENLIGHTENED` 总部为了抵御 `RESISTANCE` 的进攻，调整了某地 `Portal` 的能量值，使得其可以经受更多的打击。", "description": "`ENLIGHTENED` 总部有 $N$ 个 `Portal`，编号为 $1\\sim N$，编号为 $i$ 的`Portal`初始能量值为 $A_i$，在 `Portal` 之间有 $M$ 条 `LINK`，每条 `LINK` 着连接着两个不同 `Portal`，被连接着的两个 `Portal` 可以相互传输能量，每个 `Portal` 最多总共只能向其连接着的 `Portal` 传输 $A_i$ 点能量，现在 `ENLIGHTENED` 行动指挥想让每第 $i$ 个 `Portal` 的能量值变为至少 $B_i$，但他不知道着可不可行，所以找到了你，如果可行的话，需要你求出一种可行的能量传输方案。\n\n**能量只能直接传输不能间接传输**", "inputFormat": "第一行数两个个整数 $N,M$。\n\n第二行有 $N$ 个整数，第 $i$ 个整数代表 $A_i$。\n\n第三行有 $N$ 个整数，第 $i$ 个整数代表 $B_i$。\n\n下接 $M$ 行，每行输入两个整数 $X,Y$，代表编号为 $X$ 的 `Portal` 到编号为 $Y$ 的 `Portal` 有一条 `LINK`。", "outputFormat": "若有可行方案输出 `YES`，并且下接 $N$ 行，每行 $N$ 个整数，第 $i$ 行第 $j$ 个数代表代表编号为 $i$ 的 `Portal` 向编号为 $j$ 的 `Portal` 传输的能量值。若 $i=j$ 输出第 $i$ 个 `Portal` 传输后留下的能量值。若有多种可行方案输出其中一种即可。\n\n若无可行方案输出 `NO`。", "hint": "对于 $20\\%$ 的数据 $N \\leq 10$。\n\n对于 $40\\%$ 的数据 $N\\leq 25$。\n\n对于 $60\\%$ 的数据 $N\\leq 50$。\n\n对于 $100\\%$ 的数据 $N \\leq 100,M \\leq 2*N,0 \\leq A_i,B_i \\leq 100$。", "locale": "zh-CN"}}}
{"pid": "P4939", "type": "P", "difficulty": 4, "samples": [["5 5\n0 1 2\n0 1 5\n1 1\n0 3 5\n1 5", "2\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["树状数组", "O2优化", "差分"], "title": "Agent2", "background": "炎炎夏日还没有过去，Agent 们没有一个想出去外面搞事情的。每当 ENLIGHTENED 总部组织活动时，人人都说有空，结果到了活动日，却一个接着一个咕咕咕了。只有不咕鸟 `Lyn_king` 一个人冒着太阳等了半个多小时，然后居然看到连 ENLIGHTENED 行动参谋都咕咕咕了，果然咕咕咕是人类的本性啊。", "description": "作为一个 ENLIGHTENED 行动指挥，自然不想看到这一点，于是他偷取到了那些经常咕咕咕的 Agent 的在下来 $N$ 天的 `活动安排表`，并且叫上了你来整理。在整理过程中，ENLIGHTENED 行动指挥对你说了 $M$ 条命令，命令操作如下。\n1. 输入 $0,a,b$，这代表在第 $a$ 天到第 $b$ 天，有一名 Agent 要咕咕咕。\n2. 输入 $1$ $a$，这代表 ENLIGHTENED 行动指挥询问你根据目前的信息，在第 $a$ 天有多少名 Agent 会咕咕咕。\n\n作为同是不咕鸟的你，也想要惩戒那些经常咕咕咕的人，所以，请协助完成 ENLIGHTENED 行动指挥完成整理，并且在他每次询问时，输出正确的答案。", "inputFormat": "第一行输入两个整数 $N,M$，接下来 $M$ 行,每行输入一个命令，命令格式见题目描述。", "outputFormat": "对于每一次询问的操作，都要输出询问的答案。答案之间用换行隔开。", "hint": "对于 $20\\%$ 的数据 $N,M \\leq 10$；\n\n对于 $40\\%$ 的数据 $N,M \\leq 10^3$；\n\n对于 $60\\%$ 的数据 $N,M \\leq 10^5$；\n\n对于 $100\\%$ 的数据 $1 \\leq a,b \\leq N \\leq 10^7,M \\leq 4\\times 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "Agent2", "background": "The scorching summer has not ended yet, and none of the Agents want to go outside to do anything. Whenever ENLIGHTENED headquarters organizes an event, everyone says they are free, but when the event day arrives, they “gu gu gu” (cancel) one after another. Only the “never-cancel bird” `Lyn_king` waited under the sun for more than half an hour, and then even saw that the ENLIGHTENED operations staff also “gu gu gu”. Sure enough, “gu gu gu” is human nature.", "description": "As an ENLIGHTENED operations commander, he naturally does not want to see this happen. So he secretly obtained the `event schedule` of those Agents who often “gu gu gu”, for the next $N$ days, and asked you to help organize it. During the organizing process, the ENLIGHTENED operations commander gave you $M$ commands. The commands are as follows.\n\n1. Input $0,a,b$, which means that from day $a$ to day $b$, one Agent will “gu gu gu”.\n2. Input $1$ $a$, which means that the ENLIGHTENED operations commander asks you, based on the current information, how many Agents will “gu gu gu” on day $a$.\n\nAs someone who is also a “never-cancel bird”, you also want to punish those who often “gu gu gu”. Therefore, please help the ENLIGHTENED operations commander finish the organizing, and each time he asks, output the correct answer.", "inputFormat": "The first line contains two integers $N, M$. The next $M$ lines each contain one command. The command format is given in the Description.", "outputFormat": "For each query operation, output the answer to the query. Separate answers by newlines.", "hint": "For $20\\%$ of the testdata, $N, M \\leq 10$.\n\nFor $40\\%$ of the testdata, $N, M \\leq 10^3$.\n\nFor $60\\%$ of the testdata, $N, M \\leq 10^5$.\n\nFor $100\\%$ of the testdata, $1 \\leq a, b \\leq N \\leq 10^7$, $M \\leq 4 \\times 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Agent2", "background": "炎炎夏日还没有过去，Agent 们没有一个想出去外面搞事情的。每当 ENLIGHTENED 总部组织活动时，人人都说有空，结果到了活动日，却一个接着一个咕咕咕了。只有不咕鸟 `Lyn_king` 一个人冒着太阳等了半个多小时，然后居然看到连 ENLIGHTENED 行动参谋都咕咕咕了，果然咕咕咕是人类的本性啊。", "description": "作为一个 ENLIGHTENED 行动指挥，自然不想看到这一点，于是他偷取到了那些经常咕咕咕的 Agent 的在下来 $N$ 天的 `活动安排表`，并且叫上了你来整理。在整理过程中，ENLIGHTENED 行动指挥对你说了 $M$ 条命令，命令操作如下。\n1. 输入 $0,a,b$，这代表在第 $a$ 天到第 $b$ 天，有一名 Agent 要咕咕咕。\n2. 输入 $1$ $a$，这代表 ENLIGHTENED 行动指挥询问你根据目前的信息，在第 $a$ 天有多少名 Agent 会咕咕咕。\n\n作为同是不咕鸟的你，也想要惩戒那些经常咕咕咕的人，所以，请协助完成 ENLIGHTENED 行动指挥完成整理，并且在他每次询问时，输出正确的答案。", "inputFormat": "第一行输入两个整数 $N,M$，接下来 $M$ 行,每行输入一个命令，命令格式见题目描述。", "outputFormat": "对于每一次询问的操作，都要输出询问的答案。答案之间用换行隔开。", "hint": "对于 $20\\%$ 的数据 $N,M \\leq 10$；\n\n对于 $40\\%$ 的数据 $N,M \\leq 10^3$；\n\n对于 $60\\%$ 的数据 $N,M \\leq 10^5$；\n\n对于 $100\\%$ 的数据 $1 \\leq a,b \\leq N \\leq 10^7,M \\leq 4\\times 10^5$。", "locale": "zh-CN"}}}
{"pid": "P4940", "type": "P", "difficulty": 4, "samples": [["PUSH 0 10\nPUSH 0 20\nPUSH 0 30\nPUSH 0 40\nPUSH 1 50\nPUSH 1 60\nADD 0\nADD 0\nADD 0\nEND", "SUCCESS\nSUCCESS\nSUCCESS\nSUCCESS\nSUCCESS\nSUCCESS\nSUCCESS\nSUCCESS\nUNSUCCESS\nSUCCESS\n150 30 20 10\nNONE"], ["PUSH 0 10\nPUSH 0 20\nPUSH 0 30\nPUSH 0 40\nPUSH 1 50\nPUSH 1 60\nMOVE 0 1\nEND", "SUCCESS\nSUCCESS\nSUCCESS\nSUCCESS\nSUCCESS\nSUCCESS\nSUCCESS\nSUCCESS\n50 60 40 30 20 10\nNONE"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["O2优化", "枚举", "栈", "启发式合并"], "title": "Portal 2", "background": "某地 ENLIGHTENED 的“XM 研究所”正在研究 Portal 的处理法则，想要揭示“XM 能量”的来源以及应用“XM 能量”。ENLIGHTENED 的首席科学家 Jacks 发现其能量的运算法则以及运算方法，但是方法十分复杂，仅靠人手工计算是很难算出答案的，所以它需要你协助他完成计算。", "description": "Portal 计算“XM 能量”是通过个 $2$ 个栈（$0$ 号栈、$1$ 号栈）实现的，它把对“XM 能量”的操作如下：\n\n- `PUSH X NUM`：把 $NUM$ 加入到 $X$ 号栈的栈顶。\n\n- `POP X`：把 $X$ 号栈的栈顶元素**删除**。\n\n- `ADD X`：**取出** $0$ 号栈和 $1$ 号栈的元素各一个，并且把它的和放入 $X$ 号栈。\n\n- `SUB X`：**取出** $0$ 号栈和 $1$ 号栈的元素各一个，并且把它的差的绝对值放入 $X$ 号栈。\n \n- `DEL X`：**清空** $X$ 号栈中所有元素不管栈是否为空。\n\n- `MOVE X Y`：循环操作直到 $Y$ 号栈为空，把 $Y$ 号栈的栈顶元素加入到 $X$ 号栈，删除 $Y$ 号栈的栈顶元素（**数据保证 $X$ 和 $Y$ 不相同**）。\n\n- `SWAP`：将两个栈的所有元素调换。\n\n- `END`：代表命令结束，并且分两行分别输出 $0$ 号栈和 $1$ 号栈由栈顶到栈底的元素的值，若栈内无元素，输出 `NONE`。数据保证指令以 `END` 结束且仅有一个 `END`，并且也需要输出 `SUCCESS`。\n\n- ~~`AKNOI` 等为无效操作，**无效操作后不接数字**。~~**更正不会有类似无效操作**。\n\n对于每一行指令，若当前指令成功执行输出 `SUCCESS`，若**取出**或**删除**元素时栈内为空或者没有对应指令输出 `UNSUCCESS` 并且不执行该行指令。", "inputFormat": "输入若干行指令，以 `END` 指令结束。", "outputFormat": "对于每一次操作，都要对应输出 `SUCCESS` 或者 `UNSUCCESS`，对于 `END` 根据指令描述输出栈内元素。", "hint": "设命令总数为 $n$。\n\n对于 $20\\%$ 的数据，数据保证不会出现 `MOVE,SWAP` 操作，$1\\le n \\leq 100$；\n\n对于 $40\\%$ 的数据，$1\\le n \\leq 1000$；\n\n对于 $60\\%$ 的数据，数据保证 `MOVE,SWAP` 的操作次数不会超过 $10000$ 次，$1\\leq n \\leq 10^5$；\n\n对于 $100\\%$ 的数据，$0 \\leq X,Y \\leq 1,1\\leq n \\leq 10^6$；\n\n**数据保证无论任何情况，栈中元素的值 $X$ 满足 $0 \\leq X \\leq 2^{63}-1$。**\n\n[题目创意来源 OIERBBS](https://www.oierbbs.cn)。", "locale": "zh-CN", "translations": {"en": {"title": "Portal 2", "background": "The “XM Institute” of ENLIGHTENED in a certain place is studying the processing rules of Portals, trying to reveal the source of “XM energy” and how to use it. ENLIGHTENED’s chief scientist Jacks has found the rules and methods for computing this energy, but the method is very complex. It is hard to get the answer by manual calculation, so he needs your help to finish the computation.", "description": "Portal computes “XM energy” using $2$ stacks (stack $0$ and stack $1$). The operations on “XM energy” are as follows:\n\n- `PUSH X NUM`: Push $NUM$ onto the top of stack $X$.\n\n- `POP X`: **Delete** the top element of stack $X$.\n\n- `ADD X`: **Take out** one element from stack $0$ and one element from stack $1$, and push their sum onto stack $X$.\n\n- `SUB X`: **Take out** one element from stack $0$ and one element from stack $1$, and push the absolute value of their difference onto stack $X$.\n\n- `DEL X`: **Clear** all elements in stack $X$, regardless of whether the stack is empty.\n\n- `MOVE X Y`: Repeat until stack $Y$ is empty: push the top element of stack $Y$ onto stack $X$, then delete the top element of stack $Y$ (**the testdata guarantees that $X$ and $Y$ are different**).\n\n- `SWAP`: Swap all elements of the two stacks.\n\n- `END`: Indicates the end of commands. Then output, on two separate lines, the values in stack $0$ and stack $1$ from top to bottom. If a stack has no elements, output `NONE`. The testdata guarantees that the commands end with `END` and there is only one `END`. You also need to output `SUCCESS`.\n\n- ~~`AKNOI` and so on are invalid operations, and **invalid operations are not followed by numbers**.~~ **Correction: there will be no such invalid operations.**\n\nFor each command line: if the current command is executed successfully, output `SUCCESS`. If, when **taking out** or **deleting** elements, the required stack is empty, or if there is no corresponding command, output `UNSUCCESS` and do not execute that command line.", "inputFormat": "Input several lines of commands, ending with the `END` command.", "outputFormat": "For each operation, output `SUCCESS` or `UNSUCCESS` accordingly. For `END`, output the stack elements as described in the command description.", "hint": "Let the total number of commands be $n$.\n\nFor $20\\%$ of the testdata, it is guaranteed that there will be no `MOVE` or `SWAP` operations, and $1\\le n \\leq 100$.\n\nFor $40\\%$ of the testdata, $1\\le n \\leq 1000$.\n\nFor $60\\%$ of the testdata, it is guaranteed that the number of `MOVE` and `SWAP` operations will not exceed $10000$, and $1\\leq n \\leq 10^5$.\n\nFor $100\\%$ of the testdata, $0 \\leq X,Y \\leq 1,1\\leq n \\leq 10^6$.\n\n**The testdata guarantees that in all cases, the value $X$ of any element in the stacks satisfies $0 \\leq X \\leq 2^{63}-1$.**\n\n[Problem idea source: OIERBBS](https://www.oierbbs.cn)。\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Portal 2", "background": "某地 ENLIGHTENED 的“XM 研究所”正在研究 Portal 的处理法则，想要揭示“XM 能量”的来源以及应用“XM 能量”。ENLIGHTENED 的首席科学家 Jacks 发现其能量的运算法则以及运算方法，但是方法十分复杂，仅靠人手工计算是很难算出答案的，所以它需要你协助他完成计算。", "description": "Portal 计算“XM 能量”是通过个 $2$ 个栈（$0$ 号栈、$1$ 号栈）实现的，它把对“XM 能量”的操作如下：\n\n- `PUSH X NUM`：把 $NUM$ 加入到 $X$ 号栈的栈顶。\n\n- `POP X`：把 $X$ 号栈的栈顶元素**删除**。\n\n- `ADD X`：**取出** $0$ 号栈和 $1$ 号栈的元素各一个，并且把它的和放入 $X$ 号栈。\n\n- `SUB X`：**取出** $0$ 号栈和 $1$ 号栈的元素各一个，并且把它的差的绝对值放入 $X$ 号栈。\n \n- `DEL X`：**清空** $X$ 号栈中所有元素不管栈是否为空。\n\n- `MOVE X Y`：循环操作直到 $Y$ 号栈为空，把 $Y$ 号栈的栈顶元素加入到 $X$ 号栈，删除 $Y$ 号栈的栈顶元素（**数据保证 $X$ 和 $Y$ 不相同**）。\n\n- `SWAP`：将两个栈的所有元素调换。\n\n- `END`：代表命令结束，并且分两行分别输出 $0$ 号栈和 $1$ 号栈由栈顶到栈底的元素的值，若栈内无元素，输出 `NONE`。数据保证指令以 `END` 结束且仅有一个 `END`，并且也需要输出 `SUCCESS`。\n\n- ~~`AKNOI` 等为无效操作，**无效操作后不接数字**。~~**更正不会有类似无效操作**。\n\n对于每一行指令，若当前指令成功执行输出 `SUCCESS`，若**取出**或**删除**元素时栈内为空或者没有对应指令输出 `UNSUCCESS` 并且不执行该行指令。", "inputFormat": "输入若干行指令，以 `END` 指令结束。", "outputFormat": "对于每一次操作，都要对应输出 `SUCCESS` 或者 `UNSUCCESS`，对于 `END` 根据指令描述输出栈内元素。", "hint": "设命令总数为 $n$。\n\n对于 $20\\%$ 的数据，数据保证不会出现 `MOVE,SWAP` 操作，$1\\le n \\leq 100$；\n\n对于 $40\\%$ 的数据，$1\\le n \\leq 1000$；\n\n对于 $60\\%$ 的数据，数据保证 `MOVE,SWAP` 的操作次数不会超过 $10000$ 次，$1\\leq n \\leq 10^5$；\n\n对于 $100\\%$ 的数据，$0 \\leq X,Y \\leq 1,1\\leq n \\leq 10^6$；\n\n**数据保证无论任何情况，栈中元素的值 $X$ 满足 $0 \\leq X \\leq 2^{63}-1$。**\n\n[题目创意来源 OIERBBS](https://www.oierbbs.cn)。", "locale": "zh-CN"}}}
{"pid": "P4941", "type": "P", "difficulty": 5, "samples": [["3 2 1\n1 1 1\n1 2 3", "5"], ["4 3 2\n1 1 1 1\n4 3 2\n3 2 1", "6"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["O2优化"], "title": "War2", "background": "`XM大战`如期而至，`Agent`们齐聚一地，展开最后的对决。对战有很多种方式，有些复杂的方式可以获得更高的分数。可惜`ENLIGHTENED`的人并不怎么聪明，只会简单的`hack`，所以`ENLIGHTENED行动指挥`找到了你来做他们的总参谋。", "description": "地图上有$N$个`Portal`，现在某一名`Agent`的任务是占领该地图上的$M$个`Portal`，这名`Agent`占领第$i$个`Portal`可以得到的分数为$A[i]$，除了直接占领，还有其他的$K$种加分方式，对于着$N$个`Portal`，在占领完第$X[i]$个`Portal`后占领第$Y[i]$个`Portal`可以获得$B[i]$的加分，加分可能会有重复。`Agent`希望他可以为团队争取更多的分数，所以请求作为大战参谋的你来帮助他。", "inputFormat": "第一行是输入三个整数$N,M,K$\n第二行输入是$N$个数，第$i$个数代表$A[i]$的值。\n下面$K$行每行有3个整数$X[i],Y[i],C[i]$，表示在占领完第$X[i]$个`Portal`后占领第$Y[i]$个`Portal`可以获得$B[i]$的加分", "outputFormat": "输出仅一行一个整数，为该名`Agent`可以获得的最大分数值。", "hint": "对于$20\\%$的数据 $1 \\leq M \\leq N \\leq 4,0 \\leq A[i],B[i] \\leq 10^3$\n\n对于$40\\%$的数据 $1 \\leq M \\leq N \\leq 8,0 \\leq A[i],B[i] \\leq 10^5$\n\n对于$60\\%$的数据 $1 \\leq M \\leq N \\leq 12,0 \\leq A[i],B[i] \\leq 10^7$\n\n对于$100\\%$的数据 $1 \\leq M,X[i],Y[i] \\leq N \\leq 18,0 \\leq K \\leq N^2−N,0 \\leq A[i],B[i] \\leq 10^9$", "locale": "zh-CN", "translations": {"en": {"title": "War2", "background": "The `XM Battle` is arriving as scheduled. The `Agents` gather together for the final showdown. There are many ways to fight, and some complicated methods can earn higher scores. Unfortunately, the people from `ENLIGHTENED` are not very smart and only know simple `hack`, so the `ENLIGHTENED operation commander` asked you to be their chief strategist.", "description": "There are $N$ `Portals` on the map. Now an `Agent`'s task is to capture $M$ `Portals` on this map. The score gained by capturing the $i$-th `Portal` is $A[i]$. Besides capturing directly, there are also $K$ other bonus-scoring methods. For these $N$ `Portals`, after capturing the $X[i]$-th `Portal`, capturing the $Y[i]$-th `Portal` will grant an additional bonus of $B[i]$. Bonus rules may be duplicated. The `Agent` wants to earn more points for the team, so he asks you, the battle strategist, to help him.", "inputFormat": "The first line contains three integers $N, M, K$.\nThe second line contains $N$ numbers, where the $i$-th number represents $A[i]$.\nThe next $K$ lines each contain three integers $X[i], Y[i], C[i]$, indicating that after capturing the $X[i]$-th `Portal`, capturing the $Y[i]$-th `Portal` will grant an additional bonus of $B[i]$.", "outputFormat": "Output only one line with one integer, the maximum score this `Agent` can obtain.", "hint": "For $20\\%$ of the data: $1 \\leq M \\leq N \\leq 4, 0 \\leq A[i], B[i] \\leq 10^3$.\n\nFor $40\\%$ of the data: $1 \\leq M \\leq N \\leq 8, 0 \\leq A[i], B[i] \\leq 10^5$.\n\nFor $60\\%$ of the data: $1 \\leq M \\leq N \\leq 12, 0 \\leq A[i], B[i] \\leq 10^7$.\n\nFor $100\\%$ of the data: $1 \\leq M, X[i], Y[i] \\leq N \\leq 18, 0 \\leq K \\leq N^2-N, 0 \\leq A[i], B[i] \\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "War2", "background": "`XM大战`如期而至，`Agent`们齐聚一地，展开最后的对决。对战有很多种方式，有些复杂的方式可以获得更高的分数。可惜`ENLIGHTENED`的人并不怎么聪明，只会简单的`hack`，所以`ENLIGHTENED行动指挥`找到了你来做他们的总参谋。", "description": "地图上有$N$个`Portal`，现在某一名`Agent`的任务是占领该地图上的$M$个`Portal`，这名`Agent`占领第$i$个`Portal`可以得到的分数为$A[i]$，除了直接占领，还有其他的$K$种加分方式，对于着$N$个`Portal`，在占领完第$X[i]$个`Portal`后占领第$Y[i]$个`Portal`可以获得$B[i]$的加分，加分可能会有重复。`Agent`希望他可以为团队争取更多的分数，所以请求作为大战参谋的你来帮助他。", "inputFormat": "第一行是输入三个整数$N,M,K$\n第二行输入是$N$个数，第$i$个数代表$A[i]$的值。\n下面$K$行每行有3个整数$X[i],Y[i],C[i]$，表示在占领完第$X[i]$个`Portal`后占领第$Y[i]$个`Portal`可以获得$B[i]$的加分", "outputFormat": "输出仅一行一个整数，为该名`Agent`可以获得的最大分数值。", "hint": "对于$20\\%$的数据 $1 \\leq M \\leq N \\leq 4,0 \\leq A[i],B[i] \\leq 10^3$\n\n对于$40\\%$的数据 $1 \\leq M \\leq N \\leq 8,0 \\leq A[i],B[i] \\leq 10^5$\n\n对于$60\\%$的数据 $1 \\leq M \\leq N \\leq 12,0 \\leq A[i],B[i] \\leq 10^7$\n\n对于$100\\%$的数据 $1 \\leq M,X[i],Y[i] \\leq N \\leq 18,0 \\leq K \\leq N^2−N,0 \\leq A[i],B[i] \\leq 10^9$", "locale": "zh-CN"}}}
{"pid": "P4942", "type": "P", "difficulty": 2, "samples": [["2\n2 5\n8 12", "5\n5"], ["3\n1 999\n123 456\n13579 24680", "0\n6\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["模拟", "数学", "高精度", "逆元"], "title": "小凯的数字", "background": "NOIP2018 原创模拟题 T1\n\nNOIP DAY1 T1 or DAY2 T1 难度\n\n是否发现与 NOIP2017 DAY1 T1 有异曲同工之妙", "description": "小凯有一天突发奇想，写下了一串数字：$\\overline{l(l+1)(l+2)...(r-1)r}$。\n\n例如：$l=2,r=5$ 时，数字为：$2345$。\n\n$l=8,r=12$ 时数字为：$89101112$。\n\n小凯很喜欢数字 $9$，所以他想问你他写下的数字除以 $9$ 的余数是多少？\n\n例如：$l=2,r=5$ 时，$2345\\bmod9 = 5$。", "inputFormat": "第一行为数字 $Q$,表示小凯有 $Q$ 个问题。\n\n第 $2$ 到 $Q+1$ 行，每行两个数字 $l,r$ 表示数字范围。", "outputFormat": "对于每行的问题输出一行，一个数字，表示小凯问题的回答。", "hint": "样例 1 解释：$2345\\bmod9 = 5$，$89101112\\bmod9 = 5$。\n\n对于 $30\\%$ 数据满足：$Q\\leq10;l,r\\leq100$。\n\n对于 $50\\%$ 数据满足：$Q\\leq100;l,r\\leq10000$。\n\n对于 $70\\%$ 数据满足：$Q\\leq1000;l,r\\leq10^6$。\n\n对于 $100\\%$ 数据满足：$Q\\leq10000;0<l,r\\leq10^{12}$ 且 $l\\leq r$。", "locale": "zh-CN", "translations": {"en": {"title": "Xiao Kai’s Number", "background": "NOIP 2018 original mock contest problem T1.\n\nDifficulty: similar to NOIP Day 1 T1 or Day 2 T1.\n\nDid you notice that it is somewhat similar in spirit to NOIP 2017 Day 1 T1.", "description": "One day, Xiao Kai had a sudden idea and wrote down a sequence of numbers:\n$\\overline{l(l+1)(l+2)...(r-1)r}$.\n\nFor example, when $l=2, r=5$, the number is $2345$.\n\nWhen $l=8, r=12$, the number is $89101112$.\n\nXiao Kai really likes the digit $9$, so he wants to ask you: what is the remainder when the number he wrote is divided by $9$?\n\nFor example, when $l=2, r=5$, $2345 \\bmod 9 = 5$.", "inputFormat": "The first line contains an integer $Q$, meaning Xiao Kai has $Q$ queries.\n\nLines $2$ to $Q+1$ each contain two integers $l, r$, representing the range of numbers.", "outputFormat": "For each query, output one line with one integer, which is the answer to Xiao Kai’s query.", "hint": "Explanation of Sample 1: $2345 \\bmod 9 = 5$, and $89101112 \\bmod 9 = 5$.\n\nFor $30\\%$ of the testdata: $Q \\leq 10$, and $l, r \\leq 100$.\n\nFor $50\\%$ of the testdata: $Q \\leq 100$, and $l, r \\leq 10000$.\n\nFor $70\\%$ of the testdata: $Q \\leq 1000$, and $l, r \\leq 10^6$.\n\nFor $100\\%$ of the testdata: $Q \\leq 10000$, $0 < l, r \\leq 10^{12}$, and $l \\leq r$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小凯的数字", "background": "NOIP2018 原创模拟题 T1\n\nNOIP DAY1 T1 or DAY2 T1 难度\n\n是否发现与 NOIP2017 DAY1 T1 有异曲同工之妙", "description": "小凯有一天突发奇想，写下了一串数字：$\\overline{l(l+1)(l+2)...(r-1)r}$。\n\n例如：$l=2,r=5$ 时，数字为：$2345$。\n\n$l=8,r=12$ 时数字为：$89101112$。\n\n小凯很喜欢数字 $9$，所以他想问你他写下的数字除以 $9$ 的余数是多少？\n\n例如：$l=2,r=5$ 时，$2345\\bmod9 = 5$。", "inputFormat": "第一行为数字 $Q$,表示小凯有 $Q$ 个问题。\n\n第 $2$ 到 $Q+1$ 行，每行两个数字 $l,r$ 表示数字范围。", "outputFormat": "对于每行的问题输出一行，一个数字，表示小凯问题的回答。", "hint": "样例 1 解释：$2345\\bmod9 = 5$，$89101112\\bmod9 = 5$。\n\n对于 $30\\%$ 数据满足：$Q\\leq10;l,r\\leq100$。\n\n对于 $50\\%$ 数据满足：$Q\\leq100;l,r\\leq10000$。\n\n对于 $70\\%$ 数据满足：$Q\\leq1000;l,r\\leq10^6$。\n\n对于 $100\\%$ 数据满足：$Q\\leq10000;0<l,r\\leq10^{12}$ 且 $l\\leq r$。", "locale": "zh-CN"}}}
{"pid": "P4943", "type": "P", "difficulty": 4, "samples": [["6 8 1\n5\n1 2 3\n2 3 2\n1 3 4\n3 4 1\n4 6 5\n5 6 2\n1 6 6\n1 5 3\n4 6", "5"], ["10 13 3\n3 4 10\n1 2 1\n2 3 2\n3 4 3\n4 5 4\n5 6 5\n6 7 10\n7 8 5\n8 9 10\n9 10 3\n10 1 2\n1 9 6\n3 8 10\n4 6 3\n6 8", "16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["图论", "最短路"], "title": "密室", "background": "NOIP2018 原创模拟题 T2\n\nNOIP DAY1 T2 or DAY2 T2 难度\n\n题目背景改编自小说《哈利波特与密室》。", "description": "**密室被打开了。**\n\n哈利与罗恩进入了密室，他们发现密室由 $n$ 个小室组成，所有小室编号分别为：$1,2,...,n$。所有小室之间有 $m$ 条通道，对任意两个不同小室最多只有一条通道连接，而每通过一条通道都需要 $C_i$ 的时间。\n\n开始时哈利与罗恩都在编号为 $1$ 的小室里，他们的目标是拯救金妮和寻找日记，但是他们发现金妮和日记可能在两个不同的小室里，为了尽快发现真相，他们决定以最少的时间到达两个目标小室。但是某些小室只有会与蛇对话的人才能进入，也就是只有哈利一个人可以进入。\n\n现在，哈利告诉你密室的结构，请你计算他们到达两个目标小室的最短时间。", "inputFormat": "第一行 $n,m,k$ 表示有 $n$ 个小室 $m$ 条通道，$k$ 间小室只有哈利可以进入。\n\n第二行 $k$ 个数，表示只有哈利可以进入的小室的编号。（若 $k=0$，不包含该行）\n\n接下来 $m$ 行，每行 $3$ 个数：$a,b,c$ 表示 $a$ 小室与 $b$ 小室之间有一条需要花费 $c$ 时间的通道。\n\n最后一行，两个数 $x,y$ 表示哈利与罗恩需要去的小室的编号。", "outputFormat": "一行，输出一个数，表示到达两个密室的最短时间。", "hint": "**样例解释：**\n\n**样例一：**\n\n哈利：$1 \\to 5 \\to 6$ 花费时间为 $5$。\n\n罗恩：$1 \\to 3 \\to 4$ 花费时间为 $5$。\n\n所以最短时间为 $5$。\n\n**样例二：**\n\n![图1](https://cdn.luogu.com.cn/upload/pic/31438.png)\n\n如图，橙色表示目标小室，绿色只有哈利可以通过。\n\n哈利：$1 \\to 2 \\to 3 \\to 4 \\to 6$ 花费时间为 $9$。\n\n罗恩：$1 \\to 9 \\to 8$ 花费时间为 $16$。\n\n所以最短时间为 $16$。\n\n**数据范围：**\n\n$10\\%$ 数据满足：$n\\leq 5$。\n\n$30\\%$ 数据满足：$n\\leq 20$。\n\n$50\\%$ 数据满足：$n\\leq 1000$。\n\n$70\\%$ 数据满足：$n\\leq 10000$。\n\n$100\\%$ 数据满足：$n\\leq 50000$；$a,b,k\\leq n$；$c\\leq 1000$；$m\\leq 100000$，保证罗恩可以在密室 $1$。\n\n**特殊约定：**\n\n$30\\%$ 数据满足：$k=0$。", "locale": "zh-CN", "translations": {"en": {"title": "Chamber of Secrets", "background": "NOIP 2018 original mock problem T2.\n\nDifficulty similar to NOIP Day 1 T2 or Day 2 T2.\n\nThe background is adapted from the novel *Harry Potter and the Chamber of Secrets*.", "description": "**The Chamber of Secrets has been opened.**\n\nHarry and Ron enter the chamber. They find that the chamber consists of $n$ rooms, numbered $1,2,\\ldots,n$. There are $m$ passages between the rooms. For any two different rooms, there is at most one passage connecting them. Passing through the $i$-th passage takes $C_i$ time.\n\nAt the beginning, both Harry and Ron are in room $1$. Their goals are to rescue Ginny and find the diary, but Ginny and the diary may be in two different rooms. To uncover the truth as quickly as possible, they decide to reach the two target rooms in the least time. However, some rooms can only be entered by someone who can talk to snakes, meaning only Harry can enter them.\n\nNow, Harry tells you the structure of the chamber. Please compute the shortest time for them to reach the two target rooms.", "inputFormat": "The first line contains $n,m,k$, meaning there are $n$ rooms, $m$ passages, and $k$ rooms that only Harry can enter.\n\nThe second line contains $k$ numbers, giving the indices of the rooms that only Harry can enter. (If $k=0$, this line is omitted.)\n\nThe next $m$ lines each contain $3$ numbers $a,b,c$, meaning there is a passage between room $a$ and room $b$ with time cost $c$.\n\nThe last line contains two numbers $x,y$, indicating the two rooms that Harry and Ron need to go to.", "outputFormat": "Output one number in a single line, representing the minimum time to reach the two target rooms.", "hint": "**Explanation of the samples:**\n\n**Sample 1:**\n\nHarry: $1 \\to 5 \\to 6$, time cost is $5$.\n\nRon: $1 \\to 3 \\to 4$, time cost is $5$.\n\nSo the minimum time is $5$.\n\n**Sample 2:**\n\n![Figure 1](https://cdn.luogu.com.cn/upload/pic/31438.png)\n\nAs shown, orange marks the target rooms, and green marks rooms that only Harry can pass through.\n\nHarry: $1 \\to 2 \\to 3 \\to 4 \\to 6$, time cost is $9$.\n\nRon: $1 \\to 9 \\to 8$, time cost is $16$.\n\nSo the minimum time is $16$.\n\n**Constraints:**\n\nFor $10\\%$ of the testdata: $n\\leq 5$.\n\nFor $30\\%$ of the testdata: $n\\leq 20$.\n\nFor $50\\%$ of the testdata: $n\\leq 1000$.\n\nFor $70\\%$ of the testdata: $n\\leq 10000$.\n\nFor $100\\%$ of the testdata: $n\\leq 50000$; $a,b,k\\leq n$; $c\\leq 1000$; $m\\leq 100000$. It is guaranteed that Ron can be in room $1$.\n\n**Special note:**\n\nFor $30\\%$ of the testdata: $k=0$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "密室", "background": "NOIP2018 原创模拟题 T2\n\nNOIP DAY1 T2 or DAY2 T2 难度\n\n题目背景改编自小说《哈利波特与密室》。", "description": "**密室被打开了。**\n\n哈利与罗恩进入了密室，他们发现密室由 $n$ 个小室组成，所有小室编号分别为：$1,2,...,n$。所有小室之间有 $m$ 条通道，对任意两个不同小室最多只有一条通道连接，而每通过一条通道都需要 $C_i$ 的时间。\n\n开始时哈利与罗恩都在编号为 $1$ 的小室里，他们的目标是拯救金妮和寻找日记，但是他们发现金妮和日记可能在两个不同的小室里，为了尽快发现真相，他们决定以最少的时间到达两个目标小室。但是某些小室只有会与蛇对话的人才能进入，也就是只有哈利一个人可以进入。\n\n现在，哈利告诉你密室的结构，请你计算他们到达两个目标小室的最短时间。", "inputFormat": "第一行 $n,m,k$ 表示有 $n$ 个小室 $m$ 条通道，$k$ 间小室只有哈利可以进入。\n\n第二行 $k$ 个数，表示只有哈利可以进入的小室的编号。（若 $k=0$，不包含该行）\n\n接下来 $m$ 行，每行 $3$ 个数：$a,b,c$ 表示 $a$ 小室与 $b$ 小室之间有一条需要花费 $c$ 时间的通道。\n\n最后一行，两个数 $x,y$ 表示哈利与罗恩需要去的小室的编号。", "outputFormat": "一行，输出一个数，表示到达两个密室的最短时间。", "hint": "**样例解释：**\n\n**样例一：**\n\n哈利：$1 \\to 5 \\to 6$ 花费时间为 $5$。\n\n罗恩：$1 \\to 3 \\to 4$ 花费时间为 $5$。\n\n所以最短时间为 $5$。\n\n**样例二：**\n\n![图1](https://cdn.luogu.com.cn/upload/pic/31438.png)\n\n如图，橙色表示目标小室，绿色只有哈利可以通过。\n\n哈利：$1 \\to 2 \\to 3 \\to 4 \\to 6$ 花费时间为 $9$。\n\n罗恩：$1 \\to 9 \\to 8$ 花费时间为 $16$。\n\n所以最短时间为 $16$。\n\n**数据范围：**\n\n$10\\%$ 数据满足：$n\\leq 5$。\n\n$30\\%$ 数据满足：$n\\leq 20$。\n\n$50\\%$ 数据满足：$n\\leq 1000$。\n\n$70\\%$ 数据满足：$n\\leq 10000$。\n\n$100\\%$ 数据满足：$n\\leq 50000$；$a,b,k\\leq n$；$c\\leq 1000$；$m\\leq 100000$，保证罗恩可以在密室 $1$。\n\n**特殊约定：**\n\n$30\\%$ 数据满足：$k=0$。", "locale": "zh-CN"}}}
