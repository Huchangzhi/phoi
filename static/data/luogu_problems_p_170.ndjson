{"pid": "P4439", "type": "P", "difficulty": 1, "samples": [["3\nC\nZ\nP\n", "4"], ["6\nC\nC\nP\nC\nZ\nZ", "5"], ["6\nB\nB\nB\nB\nB\nB", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["2017", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #3] Aron", "background": "", "description": "The holiday season is near! Aron wants to get gifts for his friends in Zagreb, so in order to get them on time, he visited a famous toy store in London. After picking out the gifts, he went to the register and discovered that there were already N people in line. Luckily, he noticed that there were groups of people standing in line, in addition to individual customers. A group of people consists of a customer and their friends waiting for them to complete the purchase.\nThe moment when the customer is done, they and their friends leave the line.\n\nThe people considered a group are standing one behind the other and are wearing shirts of matching colour. Two adjacent groups, adjacent individuals or adjacent individual and a group, will never be wearing shirts of the same colour.\n\nWrite a program that will, given the data on the people standing in line, output which person in line Aron is.\n", "inputFormat": "The first line of input contains the positive integer N (1 ≤ N ≤ 25) from the task.\nEach of the following N lines contains a single character, an uppercase letter of the English alphabet that represents the shirt colour of the $i^{th}$ person in line.\n", "outputFormat": "You must output the required number from the task.\n", "hint": "**Clarification​ ​of​ ​the​ ​second​ ​test​ ​case:**\n\nFirst in line is the group consisting of two people in red shirts. Second in line is an individual in the blue shirt, third in line is an individual in the red shirt, and fourth in line is a group in green shirts. This makes Aron fifth in line.", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #3] Aron", "background": "", "description": "The holiday season is near! Aron wants to get gifts for his friends in Zagreb, so in order to get them on time, he visited a famous toy store in London. After picking out the gifts, he went to the register and discovered that there were already N people in line. Luckily, he noticed that there were groups of people standing in line, in addition to individual customers. A group of people consists of a customer and their friends waiting for them to complete the purchase.\nThe moment when the customer is done, they and their friends leave the line.\n\nThe people considered a group are standing one behind the other and are wearing shirts of matching colour. Two adjacent groups, adjacent individuals or adjacent individual and a group, will never be wearing shirts of the same colour.\n\nWrite a program that will, given the data on the people standing in line, output which person in line Aron is.\n", "inputFormat": "The first line of input contains the positive integer N (1 ≤ N ≤ 25) from the task.\nEach of the following N lines contains a single character, an uppercase letter of the English alphabet that represents the shirt colour of the $i^{th}$ person in line.\n", "outputFormat": "You must output the required number from the task.\n", "hint": "**Clarification​ ​of​ ​the​ ​second​ ​test​ ​case:**\n\nFirst in line is the group consisting of two people in red shirts. Second in line is an individual in the blue shirt, third in line is an individual in the red shirt, and fourth in line is a group in green shirts. This makes Aron fifth in line.", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #3] Aron", "background": null, "description": "节日季节快到了！Aron 想为他在 Zagreb 的朋友们准备礼物，为了及时拿到礼物，他去了伦敦的一家著名玩具店。在挑选好礼物后，他来到收银台，发现已经有 N 个人在排队。幸运的是，他注意到除了单独的顾客外，还有一群人站在队伍中。一群人由一位顾客及其朋友组成，他们在等待顾客完成购买。当顾客完成购买时，他们和他们的朋友就会离开队伍。\n\n被认为是一组的人是一个接一个站着的，并且穿着颜色相同的衬衫。相邻的两组、相邻的个人或相邻的个人和一组，永远不会穿着相同颜色的衬衫。\n\n编写一个程序，给定排队人群的数据，输出 Aron 在队伍中的位置。", "inputFormat": "输入的第一行包含一个正整数 $N$（$1 \\le N \\le 25$），表示任务中的人数。接下来的 $N$ 行中的每一行包含一个大写字母，表示第 $i^{th}$ 个人的衬衫颜色。", "outputFormat": "你必须输出任务中要求的号码。", "hint": "**第二个测试用例的说明：**\n\n排在第一的是由两名穿红色衬衫的人组成的组。第二个是穿蓝色衬衫的个人，第三个是穿红色衬衫的个人，第四个是穿绿色衬衫的组。这使得 Aron 排在第五。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P4440", "type": "P", "difficulty": 2, "samples": [["kileanimal\n2\n2 2 7 7\n1 4 6 7\n", "DA\nNE"], ["abababba\n2\n3 5 1 3\n1 2 7 8\n", "DA\nDA\n"], ["vodevovode\n2\n5 8 3 6\n2 5 3 6\n", "NE\nDA\n"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["2017", "枚举", "前缀和", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #3] Programiranje", "background": "", "description": "Little Leticija is preparing for a programming exam. Even though she has solved a lot of tasks, there’s one still left unsolved, so she is asking you for help. You are given the word S and Q queries. In each query, you are given positive integers A, B, C and D. Let’s say that word X consists of letters between positions A and B in word S, and word Y from letters between positions C and D in word S. For each query, you must answer if it is possible to somehow rearrange the letters in word Y and obtain word X.\n", "inputFormat": "The first line of input contains the word S (1 ≤ |S| ≤ 50 000). |S| denotes the number of characters in word S, which consists of lowercase letters of the English alphabet. The second line of input contains the positive integer Q (1 ≤ Q ≤ 50 000).\n\nEach of the following Q lines contains four integers A, B, C i D (1 ≤ A ≤ B ≤ |S| and 1 ≤ C ≤ D ≤ |S| ) from the task.\n", "outputFormat": "For each query, output “DA” (Croatian for yes) if it is possible, and “NE” (Croatian for no) if it is not.\n", "hint": "In test cases worth 50% of total points, it will hold: 1 ≤ |S| ≤ 1000 and 1 ≤ Q ≤ 1000.\n\n**Clarification​ ​of​ ​the​ ​third​ ​test​ ​case:**\n\nIn the first query, X=”vovo”, and Y=”devo”. In the second query, X=”odev”, and Y=”devo”.", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #3] Programiranje", "background": "", "description": "Little Leticija is preparing for a programming exam. Even though she has solved a lot of tasks, there’s one still left unsolved, so she is asking you for help. You are given the word S and Q queries. In each query, you are given positive integers A, B, C and D. Let’s say that word X consists of letters between positions A and B in word S, and word Y from letters between positions C and D in word S. For each query, you must answer if it is possible to somehow rearrange the letters in word Y and obtain word X.\n", "inputFormat": "The first line of input contains the word S (1 ≤ |S| ≤ 50 000). |S| denotes the number of characters in word S, which consists of lowercase letters of the English alphabet. The second line of input contains the positive integer Q (1 ≤ Q ≤ 50 000).\n\nEach of the following Q lines contains four integers A, B, C i D (1 ≤ A ≤ B ≤ |S| and 1 ≤ C ≤ D ≤ |S| ) from the task.\n", "outputFormat": "For each query, output “DA” (Croatian for yes) if it is possible, and “NE” (Croatian for no) if it is not.\n", "hint": "In test cases worth 50% of total points, it will hold: 1 ≤ |S| ≤ 1000 and 1 ≤ Q ≤ 1000.\n\n**Clarification​ ​of​ ​the​ ​third​ ​test​ ​case:**\n\nIn the first query, X=”vovo”, and Y=”devo”. In the second query, X=”odev”, and Y=”devo”.", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #3] Programiranje", "background": "", "description": "Little Leticija 正在准备编程考试。虽然她已经解决了很多任务，但还有一个任务尚未解决，于是她向你寻求帮助。\n\n有一个单词 $S$ 和 $Q$ 次询问。在每次询问中，给出正整数 $A$、$B$、$C$ 和 $D$。假设单词 $X$ 由单词 $S$ 中位置 $A$ 和 $B$ 及其之间的字母组成，而单词 $Y$ 由位置 $C$ 和 $D$ 及其之间的字母组成。您需要回答是否能以某种方式**重新排列单词 $Y$ 中的字母得到单词 $X$**。", "inputFormat": "第一行输入包含单词 $S$（$1\\le\\lvert S\\rvert\\le50000$）。$\\lvert S\\rvert$ 表示单词 $S$ 中的字符数。$S$ 完全由英文小写字母组成。\n\n第二行输入包含正整数 $Q$（$1\\le Q\\le50000$）。\n以下 $Q$ 行中的每一行包含四个整数 $A$、$B$、$C$ 和 $D$（$1\\le A\\le B\\le\\lvert S\\rvert$ 且 $1\\le C\\le D\\le\\lvert S\\rvert$）。", "outputFormat": "对于每次询问，如果可能，输出`DA`（即克罗地亚语的“是”），如果不可能，则输出`NE`（克语的“否”）。", "hint": "对于 $50\\%$ 的测试点，有 $1\\le\\lvert S\\rvert\\le1000$ 且 $1\\le Q\\le1000$。\n\n对于 $100\\%$ 的测试点，有 $1\\le\\lvert S\\rvert\\le50000$，$1\\le Q\\le50000$，$1\\le A\\le B\\le\\lvert S\\rvert$ 且 $1\\le C\\le D\\le\\lvert S\\rvert$。\n\n样例 #3 的解释：在第一次询问中，$X=\\tt vovo$，$Y=\\tt devo$。在第二次询问中，$X=\\tt odev$，$Y=\\tt devo$。", "locale": "zh-CN"}}}
{"pid": "P4441", "type": "P", "difficulty": 5, "samples": [["5 4\n..).\n.)(.\n(.)*\n*(.*\n..M.\n", "4\n(())\n"], ["6 3\n)(.\n*..\n(**\n)()\n().\nM..\n", "4\n()()\n"], ["6 3\n((.\n*..\n(**\n)()\n().\nM..\n", "2\n()"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #3] Retro", "background": "", "description": "Little Mirko got a video game console for Christmas. It wasn’t a Playstation 4 or an Xbox one, but Atari 2600, and it came with one free game. The protagonist of the game is standing on the bottom of the screen, and there are various objects dispersed on the rest of the screen, falling towards the bottom.\n\nMore precisely, the screen can be represented as a grid of RxS pixels arranged in R rows and S columns. The protagonist takes up one pixel of the lowest line and is marked with ‘M’. The rest of the pixels are marked with some of the characters: ‘.’ (empty space), ‘*’ (bomb), ‘(‘ (open bracket) or ‘)’ (closed bracket).\n\nThe protagonist can move one pixel to the left or to the right in a single move, but doesn’t need to, whereas the rest of the objects simultaneously move one pixel down (possibly out of the screen). When the protagonist finds himself at the same position as one of the brackets, we say that he picked up that bracket and added it at the end of his array of acquired brackets. The protagonist’s goal is to acquire the longest possible **valid** bracket\nexpression.\n\nA valid bracket expression is defined inductively in the following way:\n\n- “()” is a valid expression\n- If **a​** is a valid expression, then “(**a**​)” is a valid expression as well\n- If **a​** and **b​** are valid expressions, then “**ab**​” is a valid expression as well\n\nThe game ends when the protagonist finds himself at the same position as the bomb, or when all the objects fall out of the screen.\n", "inputFormat": "The first line of input contains the positive integers R ​and S ​(1 ≤ R, S ≤ 300) that represent the dimensions of the screen.\n\nEach of the following R lines contains S characters ‘M’, ‘.’, ‘*’, ‘(‘ or ‘)’ that represent the initial state of the screen.\n\nTest data will be such that there will always exist at least one valid bracket expression that is possible to acquire. ", "outputFormat": "In the first line, you must output the length of the longest valid bracket expression that Mirko can acquire.\n\nIn the second line, output that expression. If there are multiple longest valid expressions, output the **lexicographically​ ​smallest​** one.", "hint": "In test cases worth 25% of total points, it will hold 1 ≤ R ≤ 15.\n\nIn test cases worth 50% of total points, it will hold 1 ≤ R ≤ 100.\n\nIf you output the correct length, but the wrong expression, you will be awarded 40% of points for that test case. In any case, in order to score points, your output must consist of two non-empty lines. ~~(但我并不会做spj，所以这话屁用没有)~~\n\n**Clarification​ ​of​ ​the​ ​first​ ​test​ ​case**:​ ​The protagonist’s moves are: left, left, right right.\n\n**Clarification​ ​of​ ​the​ ​second​ ​test​ ​case**:​ ​The protagonist’s moves are: stay still, stay still, stay still, right, left.\n\n**Clarification​ ​of​ ​the​ ​third​ ​test​ ​case**:​ ​The protagonist’s moves are: stay still, stay still, right.", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #3] Retro", "background": "", "description": "Little Mirko got a video game console for Christmas. It wasn’t a Playstation 4 or an Xbox one, but Atari 2600, and it came with one free game. The protagonist of the game is standing on the bottom of the screen, and there are various objects dispersed on the rest of the screen, falling towards the bottom.\n\nMore precisely, the screen can be represented as a grid of RxS pixels arranged in R rows and S columns. The protagonist takes up one pixel of the lowest line and is marked with ‘M’. The rest of the pixels are marked with some of the characters: ‘.’ (empty space), ‘*’ (bomb), ‘(‘ (open bracket) or ‘)’ (closed bracket).\n\nThe protagonist can move one pixel to the left or to the right in a single move, but doesn’t need to, whereas the rest of the objects simultaneously move one pixel down (possibly out of the screen). When the protagonist finds himself at the same position as one of the brackets, we say that he picked up that bracket and added it at the end of his array of acquired brackets. The protagonist’s goal is to acquire the longest possible **valid** bracket\nexpression.\n\nA valid bracket expression is defined inductively in the following way:\n\n- “()” is a valid expression\n- If **a​** is a valid expression, then “(**a**​)” is a valid expression as well\n- If **a​** and **b​** are valid expressions, then “**ab**​” is a valid expression as well\n\nThe game ends when the protagonist finds himself at the same position as the bomb, or when all the objects fall out of the screen.\n", "inputFormat": "The first line of input contains the positive integers R ​and S ​(1 ≤ R, S ≤ 300) that represent the dimensions of the screen.\n\nEach of the following R lines contains S characters ‘M’, ‘.’, ‘*’, ‘(‘ or ‘)’ that represent the initial state of the screen.\n\nTest data will be such that there will always exist at least one valid bracket expression that is possible to acquire. ", "outputFormat": "In the first line, you must output the length of the longest valid bracket expression that Mirko can acquire.\n\nIn the second line, output that expression. If there are multiple longest valid expressions, output the **lexicographically​ ​smallest​** one.", "hint": "In test cases worth 25% of total points, it will hold 1 ≤ R ≤ 15.\n\nIn test cases worth 50% of total points, it will hold 1 ≤ R ≤ 100.\n\nIf you output the correct length, but the wrong expression, you will be awarded 40% of points for that test case. In any case, in order to score points, your output must consist of two non-empty lines. ~~(但我并不会做spj，所以这话屁用没有)~~\n\n**Clarification​ ​of​ ​the​ ​first​ ​test​ ​case**:​ ​The protagonist’s moves are: left, left, right right.\n\n**Clarification​ ​of​ ​the​ ​second​ ​test​ ​case**:​ ​The protagonist’s moves are: stay still, stay still, stay still, right, left.\n\n**Clarification​ ​of​ ​the​ ​third​ ​test​ ​case**:​ ​The protagonist’s moves are: stay still, stay still, right.", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #3] Retro", "background": "", "description": "小 Mirko 在圣诞节得到了一个视频游戏机。它不是 Playstation 4 或 Xbox one，而是 Atari 2600，并且附带了一个免费游戏。游戏的主角站在屏幕的底部，屏幕上其他地方有各种物体向底部掉落。\n\n更确切地说，屏幕可以表示为一个由 R 行 S 列像素组成的网格。主角占据最底行的一个像素，并用 'M' 标记。其余像素用以下字符之一标记：'.'（空格）、'*'（炸弹）、'('（左括号）或 ')'（右括号）。\n\n主角可以在一次移动中向左或向右移动一个像素，但不需要移动，而其他物体同时向下移动一个像素（可能移出屏幕）。当主角与一个括号处于同一位置时，我们说他拾取了该括号并将其添加到他已获得的括号数组的末尾。主角的目标是获得尽可能长的**有效**括号表达式。\n\n有效的括号表达式通过以下方式递归定义：\n\n- \"()\" 是一个有效的表达式。\n- 如果 **a** 是一个有效的表达式，那么 \"(**a**)\" 也是一个有效的表达式。\n- 如果 **a** 和 **b** 是有效的表达式，那么 \"**ab**\" 也是一个有效的表达式。\n\n当主角与炸弹处于同一位置时，或者当所有物体都掉出屏幕时，游戏结束。", "inputFormat": "输入的第一行包含正整数 R 和 S（1 ≤ R, S ≤ 300），表示屏幕的尺寸。\n\n接下来的 R 行中的每一行包含 S 个字符 'M'、'.'、'*'、'(' 或 ')'，表示屏幕的初始状态。\n\n测试数据将保证总是存在至少一个可以获得的有效括号表达式。", "outputFormat": "在第一行，你必须输出 Mirko 可以获得的最长有效括号表达式的长度。\n\n在第二行，输出该表达式。如果存在多个最长的有效表达式，输出**字典序最小**的那个。", "hint": "在价值 25% 总分的测试用例中，将满足 1 ≤ R ≤ 15。\n\n在价值 50% 总分的测试用例中，将满足 1 ≤ R ≤ 100。\n\n如果你输出了正确的长度，但表达式错误，你将获得该测试用例 40% 的分数。无论如何，为了得分，你的输出必须包含两行非空内容。\n\n**第一个测试用例的说明**：主角的移动是：左，左，右，右。\n\n**第二个测试用例的说明**：主角的移动是：保持不动，保持不动，保持不动，右，左。\n\n**第三个测试用例的说明**：主角的移动是：保持不动，保持不动，右。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P4442", "type": "P", "difficulty": 5, "samples": [["4 4\n####\n#.F#\n#C.#\n####\n", "2"], ["6 8\n########\n#.##..F#\n#C.##..#\n#..#...#\n#.....##\n########\n", "4"], ["4 5\n#####\n#C#.#\n###F#\n#####\n", "nemoguce\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["贪心", "2017", "最短路", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #3] Portal", "background": "", "description": "The protagonist of this task, Chell, must solve a new puzzle GLaDOS has come up with.\n\nChell is in a room whose layout that can be represented as a matrix of dimensions N rows and M columns. Each field can be one of the following:\n\n- Obstructed field - there is a wall in it (denoted as ‘#’),\n- The field where Chell is initially (denoted as ‘C’),\n- The field where Chell must get to in order to solve the puzzle (denoted as ‘F’), or\n- An empty field (denoted as ‘.’).\n\nChell is carrying a so-called portal gun, a gun with which you can create portals in the walls.\n\nIn each move, she can do one of the following:\n- Move to an adjacent field using one move up, down, left or right (she cannot move to the field with a wall in it). This move lasts one unit of time.\n- Create a portal in the wall by turning towards a wall, not necessarily an adjacent one, in the direction up, down, left or right and shooting. The portal will be created only on the side of the wall it was hit from. In each moment, **at most two portals can be active**​. If a new portal is being created in the moment when two portals are already active, the one that was created earlier will disappear. It is not possible to create a new portal at the position of another existing portal. This move lasts a negligible\namount of time, i.e. zero amounts of time.\n- If she’s at a field that is adjacent to a wall and there’s a portal on her side of the wall, she can step into the portal and exit to a non-obstructed field with another portal. This move is possible if there are two active portals and lasts one unit of time.\n\nChell wants to know the minimal amount of time it takes for her to solve the puzzle, i.e. to reach the field denoted as ‘F’.\n\n**Please note**: The room will always have walls on the sides, and letters ‘C’ and ‘F’ will appear only once in the matrix.\n", "inputFormat": "The first line of input contains the positive integers N and M (4 ≤ N, M ≤ 500), the numbers from the task.\n\nEach of the following N lines contains M characters that describe the layout of the room.\n", "outputFormat": "You must output the minimal amount of time it takes to solve the puzzle, or “nemoguce” (without quotation marks, Croatian for impossible) if it is not possible to solve it.\n", "hint": "In test cases worth 50% of total points, it will hold 4 ≤ N, M ≤ 15.\n\n**Clarification​ ​of​ ​the​ ​second​ ​test​ ​case:**\n\nThe puzzle can be solved in 8 moves, illustrated in the pictures below.\n\nIn the first move, we turn towards the left wall, shoot and create a portal that appears on the wall in the $3^{rd}$ row and $1^{st}$ column (coordinates (3,1)) from the right side.\n\nIn the second move, we create a portal from the upper side of the wall at coordinates (6,2).\n\nIn the third move, we step into the portal at coordinates (3,1) and exit at coordinates (5,2) - a\nnon-obstructed field with the second portal.\n\nIn the fourth move, we turn right and create a portal from the left side of the wall at coordinates (5,7).\nSince there are already two portals, the one at field (3,1) disappears.\n\nIn the fifth move, we step into the portal at coordinates (6,2) and exit at coordinates (5,6) with the\nsecond portal.\n\nIn the sixth move, we create a new portal from the lower side of the wall at coordinates (1,6), making\nthe portal at coordinates (6,2) disappear.\n\nIn the seventh move, we step into the portal at coordinates (5,7) and exit at coordinates (2,6).\nFinally, in the eighth move, we move one place to the right to end the game.\n\nThe portal creation in moves 1, 2, 4 and 6 lasts zero amounts of time, whereas the rest of the move\nlast one unit of time, so the total time needed to solve the puzzle is 4 units of time.\n\n![](https://cdn.luogu.com.cn/upload/pic/17512.png)", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #3] Portal", "background": "", "description": "The protagonist of this task, Chell, must solve a new puzzle GLaDOS has come up with.\n\nChell is in a room whose layout that can be represented as a matrix of dimensions N rows and M columns. Each field can be one of the following:\n\n- Obstructed field - there is a wall in it (denoted as ‘#’),\n- The field where Chell is initially (denoted as ‘C’),\n- The field where Chell must get to in order to solve the puzzle (denoted as ‘F’), or\n- An empty field (denoted as ‘.’).\n\nChell is carrying a so-called portal gun, a gun with which you can create portals in the walls.\n\nIn each move, she can do one of the following:\n- Move to an adjacent field using one move up, down, left or right (she cannot move to the field with a wall in it). This move lasts one unit of time.\n- Create a portal in the wall by turning towards a wall, not necessarily an adjacent one, in the direction up, down, left or right and shooting. The portal will be created only on the side of the wall it was hit from. In each moment, **at most two portals can be active**​. If a new portal is being created in the moment when two portals are already active, the one that was created earlier will disappear. It is not possible to create a new portal at the position of another existing portal. This move lasts a negligible\namount of time, i.e. zero amounts of time.\n- If she’s at a field that is adjacent to a wall and there’s a portal on her side of the wall, she can step into the portal and exit to a non-obstructed field with another portal. This move is possible if there are two active portals and lasts one unit of time.\n\nChell wants to know the minimal amount of time it takes for her to solve the puzzle, i.e. to reach the field denoted as ‘F’.\n\n**Please note**: The room will always have walls on the sides, and letters ‘C’ and ‘F’ will appear only once in the matrix.\n", "inputFormat": "The first line of input contains the positive integers N and M (4 ≤ N, M ≤ 500), the numbers from the task.\n\nEach of the following N lines contains M characters that describe the layout of the room.\n", "outputFormat": "You must output the minimal amount of time it takes to solve the puzzle, or “nemoguce” (without quotation marks, Croatian for impossible) if it is not possible to solve it.\n", "hint": "In test cases worth 50% of total points, it will hold 4 ≤ N, M ≤ 15.\n\n**Clarification​ ​of​ ​the​ ​second​ ​test​ ​case:**\n\nThe puzzle can be solved in 8 moves, illustrated in the pictures below.\n\nIn the first move, we turn towards the left wall, shoot and create a portal that appears on the wall in the $3^{rd}$ row and $1^{st}$ column (coordinates (3,1)) from the right side.\n\nIn the second move, we create a portal from the upper side of the wall at coordinates (6,2).\n\nIn the third move, we step into the portal at coordinates (3,1) and exit at coordinates (5,2) - a\nnon-obstructed field with the second portal.\n\nIn the fourth move, we turn right and create a portal from the left side of the wall at coordinates (5,7).\nSince there are already two portals, the one at field (3,1) disappears.\n\nIn the fifth move, we step into the portal at coordinates (6,2) and exit at coordinates (5,6) with the\nsecond portal.\n\nIn the sixth move, we create a new portal from the lower side of the wall at coordinates (1,6), making\nthe portal at coordinates (6,2) disappear.\n\nIn the seventh move, we step into the portal at coordinates (5,7) and exit at coordinates (2,6).\nFinally, in the eighth move, we move one place to the right to end the game.\n\nThe portal creation in moves 1, 2, 4 and 6 lasts zero amounts of time, whereas the rest of the move\nlast one unit of time, so the total time needed to solve the puzzle is 4 units of time.\n\n![](https://cdn.luogu.com.cn/upload/pic/17512.png)", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #3] Portal", "background": "", "description": "本任务的主角 Chell 必须解决 GLaDOS 提出的新谜题。\n\nChell 处于一个房间中，该房间的布局可以表示为一个 N 行 M 列的矩阵。每个格子可以是以下几种之一：\n\n- 障碍格子 - 其中有一面墙（用 '#' 表示），\n- Chell 的起始位置（用 'C' 表示），\n- Chell 必须到达以解决谜题的格子（用 'F' 表示），或者\n- 空格子（用 '.' 表示）。\n\nChell 携带一个所谓的传送枪，可以用来在墙上创建传送门。\n\n在每次移动中，她可以执行以下操作之一：\n- 向相邻的格子移动，方向可以是上、下、左或右（她不能移动到有墙的格子）。此移动耗时一个单位时间。\n- 通过转向一个方向（不一定是相邻的）朝墙射击来在墙上创建一个传送门。传送门只会在被击中的墙的一侧创建。在任何时刻，**最多只能有两个传送门是激活的**。如果在已有两个激活传送门的情况下创建新的传送门，最早创建的那个将消失。不能在已有传送门的位置创建新的传送门。此操作耗时可忽略不计，即零时间。\n- 如果她在一个与墙相邻的格子并且墙的这一侧有传送门，她可以进入传送门并从另一个传送门出来到一个非障碍格子。此操作在有两个激活传送门时才可能，并且耗时一个单位时间。\n\nChell 想知道解决谜题的最少时间，即到达标记为 'F' 的格子的时间。\n\n**请注意**：房间的四周总是有墙，并且字母 'C' 和 'F' 在矩阵中只出现一次。", "inputFormat": "输入的第一行包含正整数 N 和 M (4 ≤ N, M ≤ 500)，即任务中的数字。\n\n接下来的 N 行中的每一行包含 M 个字符，描述房间的布局。", "outputFormat": "你必须输出解决谜题所需的最少时间，或者如果无法解决则输出“nemoguce”（不带引号，克罗地亚语表示不可能）。", "hint": "在总分的 50% 的测试用例中，将满足 4 ≤ N, M ≤ 15。\n\n**第二个测试用例的说明**：\n\n该谜题可以在 8 步内解决，如下图所示。\n\n在第一步中，我们转向左侧墙壁，射击并创建一个传送门，该传送门出现在第 3 行第 1 列（坐标 (3,1)）的墙的右侧。\n\n在第二步中，我们从墙的上侧在坐标 (6,2) 创建一个传送门。\n\n在第三步中，我们进入坐标 (3,1) 的传送门并在坐标 (5,2) 出口——一个有第二个传送门的非障碍格子。\n\n在第四步中，我们向右转并从墙的左侧在坐标 (5,7) 创建一个传送门。由于已经有两个传送门，位于 (3,1) 的传送门消失。\n\n在第五步中，我们进入坐标 (6,2) 的传送门并在坐标 (5,6) 出口。\n\n在第六步中，我们从墙的下侧在坐标 (1,6) 创建一个新传送门，使得坐标 (6,2) 的传送门消失。\n\n在第七步中，我们进入坐标 (5,7) 的传送门并在坐标 (2,6) 出口。最后，在第八步中，我们向右移动一格以结束游戏。\n\n第 1、2、4 和 6 步中的传送门创建耗时为零，而其余移动耗时一个单位时间，因此解决谜题总共需要 4 个单位时间。\n\n![](https://cdn.luogu.com.cn/upload/pic/17512.png)\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P4443", "type": "P", "difficulty": 6, "samples": [["2\n0 1 2 3\n", "9"], ["3\n3 7 0 4 6 1 5 2\n", "33"], ["4\n13 0 15 12 4 8 7 3\n11 14 6 10 1 5 9 2\n", "133"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2017", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #3] Dojave", "background": "原题每个点4s，但我改不了= =，不过标程1s不到就过了。", "description": "The biggest event of the year ended tragically for Croatian teams. The most influential theoretician of CERC of all time, the founder of the popular page CERC Tips, and in his free time an outstanding bass player, in his most recent performance failed to get his team to the finals.\n\nIn order to get over his existential troubles, our subject is spending time playing games of chance. He is especially interested in the following game:\n\nYou are given a positive integer M. Our protagonist sees in front of him a **permutation** of an array of numbers 0, 1, 2, ..., $2^M$- 1.\n\nThe computer chooses a **nonempty contiguous subsequence** of the given permutation, which it then lights up over a capital city of one of the countries in Southeastern Europe.\n\nOur confidant, after fighting off tears caused by memories of old times, **must** choose two distinct elements of the permutation and **swap their places**​. Our man of the hour wins if and only if the **bitwise XOR** of the numbers in the lit up subsequence after the substitution is **precisely**​ $2^M$- 1.\n\nOur hero wants to know **the number of contiguous subsequences** ​the computer can light up so that he can win.\n\nHelp our hero overcome his (id)entity crisis so our favourite page can be fully active again.\n", "inputFormat": "The first line of input contains the integer M (1 ≤ M ≤ 20),\n\nThe following line contains $2^M$ space-separated numbers that make up a permutation of the array 0, 1, 2, ..., $2^M$- 1.\n", "outputFormat": "You must output the total number of contiguous subsequences that a computer can light up so our hero can win.\n", "hint": "In test cases worth 50% of total points, it will hold 1 ≤ M ≤ 14.\n\n**Clarification​ ​of​ ​the​ ​test​ ​cases:**\n\nIn the first test case, if the computer chooses the subsequence [1 2 3], our hero can replace the numbers 0 and 3. In this case, he can actually win for every chosen contiguous subsequence, except the entire array.\n\nIn the second test case, if the computer chooses the entire array [3 7 0 4 6 1 5 2] as the lit up subsequence, our hero can’t change the XOR of the subsequence (which is 0), no matter which two elements are swapped.", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #3] Dojave", "background": "原题每个点4s，但我改不了= =，不过标程1s不到就过了。", "description": "The biggest event of the year ended tragically for Croatian teams. The most influential theoretician of CERC of all time, the founder of the popular page CERC Tips, and in his free time an outstanding bass player, in his most recent performance failed to get his team to the finals.\n\nIn order to get over his existential troubles, our subject is spending time playing games of chance. He is especially interested in the following game:\n\nYou are given a positive integer M. Our protagonist sees in front of him a **permutation** of an array of numbers 0, 1, 2, ..., $2^M$- 1.\n\nThe computer chooses a **nonempty contiguous subsequence** of the given permutation, which it then lights up over a capital city of one of the countries in Southeastern Europe.\n\nOur confidant, after fighting off tears caused by memories of old times, **must** choose two distinct elements of the permutation and **swap their places**​. Our man of the hour wins if and only if the **bitwise XOR** of the numbers in the lit up subsequence after the substitution is **precisely**​ $2^M$- 1.\n\nOur hero wants to know **the number of contiguous subsequences** ​the computer can light up so that he can win.\n\nHelp our hero overcome his (id)entity crisis so our favourite page can be fully active again.\n", "inputFormat": "The first line of input contains the integer M (1 ≤ M ≤ 20),\n\nThe following line contains $2^M$ space-separated numbers that make up a permutation of the array 0, 1, 2, ..., $2^M$- 1.\n", "outputFormat": "You must output the total number of contiguous subsequences that a computer can light up so our hero can win.\n", "hint": "In test cases worth 50% of total points, it will hold 1 ≤ M ≤ 14.\n\n**Clarification​ ​of​ ​the​ ​test​ ​cases:**\n\nIn the first test case, if the computer chooses the subsequence [1 2 3], our hero can replace the numbers 0 and 3. In this case, he can actually win for every chosen contiguous subsequence, except the entire array.\n\nIn the second test case, if the computer chooses the entire array [3 7 0 4 6 1 5 2] as the lit up subsequence, our hero can’t change the XOR of the subsequence (which is 0), no matter which two elements are swapped.", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #3] Dojave", "background": null, "description": "这一年最大的事件对于克罗地亚队来说以悲剧告终。CERC 有史以来最具影响力的理论家、热门页面 CERC Tips 的创始人，同时也是一位杰出的贝斯手，在他最近的一次表演中未能将他的团队带入决赛。\n\n为了克服他的存在主义困扰，我们的主角正在通过玩几率游戏来消磨时间。他对以下游戏特别感兴趣：\n\n给定一个正整数 $M$。我们的主角面前有一个数组 $0, 1, 2, \\dots, 2^M-1$ 的**排列**。\n\n计算机选择给定排列中的一个**非空连续子序列**，然后将其点亮在东南欧某国的首都上空。\n\n我们的知己，在摆脱旧时记忆带来的泪水后，**必须**选择排列中的两个不同元素并**交换它们的位置**。只有当替换后的点亮子序列的**按位异或**结果**恰好**为 $2^M-1$ 时，我们的主角才会获胜。\n\n我们的英雄想知道计算机可以点亮的**连续子序列的数量**，以便他能够获胜。\n\n帮助我们的英雄克服他的身份危机，以便我们喜爱的页面能够再次全面活跃。", "inputFormat": "输入的第一行包含整数 $M$。\n\n接下来的行包含 $2^M$ 个以空格分隔的数字，这些数字构成了数组 $0, 1, 2, \\dots, 2^M-1$ 的一个排列。", "outputFormat": "你必须输出计算机可以点亮以使我们的英雄获胜的连续子序列的总数。", "hint": "对于 $50\\%$ 的数据，$1 \\leq M \\leq 14$。\n\n对于 $100\\%$ 的数据，$1 \\leq M \\leq 20$。\n\n**测试用例的说明：**\n\n在第一个测试用例中，如果计算机选择子序列 $[1\\ 2\\ 3]$，我们的英雄可以替换数字 $0$ 和 $3$。在这种情况下，他实际上可以在每个选择的连续子序列中获胜，除了整个数组。\n\n在第二个测试用例中，如果计算机选择整个数组 $[3\\ 7\\ 0\\ 4\\ 6\\ 1\\ 5\\ 2]$ 作为点亮的子序列，我们的英雄无论如何交换两个元素都无法改变子序列的异或结果（结果为 $0$）。\n\n题面翻译由 ChatGPT-4o 提供。", "locale": "zh-CN"}}}
{"pid": "P4444", "type": "P", "difficulty": 6, "samples": [["3 1\n2\n", "1"], ["6 2\n2 3\n", "2"], ["123456789 3\n5 6 9\n", "10973937\n"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["2017", "COCI（克罗地亚）"], "title": "[COCI 2017/2018 #3] Sažetak", "background": "", "description": "An unknown array x consists of N integers. The K-summary of that array is obtained by dividing the array into segments of length K and summing up the elements in each segment.\nIf N is not divisible by K, the last segment of the division will have less than K elements.\n\nIn other words, the K-summary is an array where the elements are, respectively: (x[1] + … + x[K]), (x[K+1] + … + x[2K]), and so on, where the last sum that contains x[N] can have less than K summands. For example, the 5-summary of an array of 13 elements has three elements (sum of elements 1.-5., sum of elements 6.-10., sum of elements 11.-13.).\n\nIt is clear that we cannot reconstruct the elements of the original array from the K-summary, but that might be possible if we knew several K-summaries for different Ks. Write a program that will, given length N and set $K_1$, $K_2$\n, …, $K_M$ , predict how many elements of the original array we would be able to uniquely determine if we knew all the $K_i$ -summaries of the array.\n(It is not difficult to show that the number of reconstructed elements is independent of the content of the summaries.)\n", "inputFormat": "The first line contains the integers N and M (3 <= N <= $10^9$\n, 1 <= M <= 10), the array length and the number of K-summaries.\n\nThe second line contains distinct integers$K_1$, $K_2$ , …, $K_M$\n(2 <= $K_i$ < N) from the task.", "outputFormat": "You must output the required number of reconstructed elements", "hint": "In test cases worth 40% of total points, it will hold N <= 5 000 000.\n\n**Clarification​ ​of​ ​the​ ​first​ ​example**:​ ​We can determine one element: x[3].\n\n**Clarification​ ​of​ ​the​ ​second​ ​example**:​ ​We can determine x[3] and x[4].", "locale": "en", "translations": {"en": {"title": "[COCI 2017/2018 #3] Sažetak", "background": "", "description": "An unknown array x consists of N integers. The K-summary of that array is obtained by dividing the array into segments of length K and summing up the elements in each segment.\nIf N is not divisible by K, the last segment of the division will have less than K elements.\n\nIn other words, the K-summary is an array where the elements are, respectively: (x[1] + … + x[K]), (x[K+1] + … + x[2K]), and so on, where the last sum that contains x[N] can have less than K summands. For example, the 5-summary of an array of 13 elements has three elements (sum of elements 1.-5., sum of elements 6.-10., sum of elements 11.-13.).\n\nIt is clear that we cannot reconstruct the elements of the original array from the K-summary, but that might be possible if we knew several K-summaries for different Ks. Write a program that will, given length N and set $K_1$, $K_2$\n, …, $K_M$ , predict how many elements of the original array we would be able to uniquely determine if we knew all the $K_i$ -summaries of the array.\n(It is not difficult to show that the number of reconstructed elements is independent of the content of the summaries.)\n", "inputFormat": "The first line contains the integers N and M (3 <= N <= $10^9$\n, 1 <= M <= 10), the array length and the number of K-summaries.\n\nThe second line contains distinct integers$K_1$, $K_2$ , …, $K_M$\n(2 <= $K_i$ < N) from the task.", "outputFormat": "You must output the required number of reconstructed elements", "hint": "In test cases worth 40% of total points, it will hold N <= 5 000 000.\n\n**Clarification​ ​of​ ​the​ ​first​ ​example**:​ ​We can determine one element: x[3].\n\n**Clarification​ ​of​ ​the​ ​second​ ​example**:​ ​We can determine x[3] and x[4].", "locale": "en"}, "zh-CN": {"title": "[COCI 2017/2018 #3] Sažetak", "background": "", "description": "有一个长度为 $N$ 的未知数组 $x$。这个数组的 $K$-总和定义为将该数组分割为若干长度为 $K$ 的区间，并对每个区间中的元素分别求和的结果。如果 $N$ 不能被 $K$ 整除，则最后一个区间的元素数将少于 $K$。\n\n换言之，$K$-总和指的是一个数组，其中的元素分别为：$(x_1+\\dots+x_K)$，$(x_{K+1}+\\dots+x_{2K})$，以此类推；其中包含了 $x_N$ 的元素，即最后一个元素，可以由少于 $K$ 个部分组成。例如，一个含有十三个元素的数组的 $5$-总和有三个元素（第一到第五项之和，第六到第十项之和，第十一到第十三项之和）\n\n可以发现我们无法通过一个 $K$-总和来重现原数组，但当我们知道几个 $K$ 值不同的 $K$-总和时就有可能做到这一点。给定 $N$ 和 $K_1,K_2,\\dots,K_M$，请您编写一条程序，计算在已知一个长为 $N$ 的数组的 $K_i$-总和的前提下，有多少原数组的元素可以被唯一确定（不难发现唯一确定的元素数与 $K_i$-总和的内容无关）。", "inputFormat": "第一行包含两个整数 $N$ 和 $M$，$N$ 为原数组大小，$M$ 为已知 $K$-总和的数量。\n\n第二行包含 $M$ 个整数，分别为 $K_1,K_2,\\dots,K_M$，如题所述。", "outputFormat": "您需要输出唯一确定的元素数。", "hint": "对于 $40\\%$ 的数据，$N\\le5\\times10^6$。\n\n对于 $100\\%$ 的数据，$3\\le N\\le10^9$，$1\\le M\\le10$，$2\\le K_i<N$。\n\n### 样例解释\n\n对于第一个样例：我们可以确定 $x_3$。\n\n对于第二个样例：我们可以确定 $x_3$ 和 $x_4$。\n\n翻译来自于 @阿丑", "locale": "zh-CN"}}}
{"pid": "P4445", "type": "P", "difficulty": 1, "samples": [["3\n3 1 2", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2018", "安徽"], "title": "[AHOI2018初中组] 报名签到", "background": "", "description": "$n$ 位同学（编号从 $1$ 到 $n$）同时来到体育馆报名签到，领取准考证和参赛资料。为了有序报名，这 $n$ 位同学需要按编号次序（编号为 $1$ 的同学站在最前面）从前往后排成一条直线。然而每一位同学都不喜欢拥挤，对于第 $i$ 位同学，如果有另外一位同学距离他/她的距离小于 $a_i$，那么就会发生冲突。小可可想知道如果要不发生任何冲突的情况下，这 $n$ 位同学排队的队列最短长度是多少。", "inputFormat": "第一行一个整数 $n$ ，表示报名签到的同学人数。\n\n第二行有 $n$ 个整数，第 $i$ 个整数 $a_i$ 表示第 $i$ 个同学必须与其他同学保持的距离。", "outputFormat": "输出一行，包括一个整数，表示这 $n$ 位同学排队队列的最小长度。\n\n注意： $n$ 位同学要按 $1$ 到 $n$ 的次序从前往后排队。", "hint": "对于 $20\\%$ 的数据满足：$1\\le n\\le 20$。\n\n对于 $70\\%$ 的数据满足：$1\\le n\\le 10^4$。\n\n对于 $100\\%$ 的数据满足：$1\\le n\\le 10^5$，$1\\le a_i\\le 10^5$。", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2018 Middle School Division] Registration Check-in", "background": "", "description": "$n$ students (numbered from $1$ to $n$) arrive at the gym at the same time to register and check in, and to receive their admission tickets and contest materials. To keep the registration orderly, these $n$ students must line up in a straight line from front to back in increasing order of their numbers (the student with number $1$ stands at the very front). However, each student dislikes crowding: for the $i$-th student, if there is another student whose distance to him/her is less than $a_i$, a conflict occurs. Xiao Keke wants to know, under the condition that no conflicts occur, what is the minimum possible length of the queue formed by these $n$ students.", "inputFormat": "The first line contains an integer $n$, the number of students.\n\nThe second line contains $n$ integers. The $i$-th integer $a_i$ denotes the distance that the $i$-th student must keep from other students.", "outputFormat": "Output one line with a single integer, the minimum possible length of the queue formed by these $n$ students.\n\nNote: The $n$ students must line up from front to back in the order $1$ to $n$.", "hint": "For $20\\%$ of the testdata: $1\\le n\\le 20$.\n\nFor $70\\%$ of the testdata: $1\\le n\\le 10^4$.\n\nFor $100\\%$ of the testdata: $1\\le n\\le 10^5$，$1\\le a_i\\le 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2018初中组] 报名签到", "background": "", "description": "$n$ 位同学（编号从 $1$ 到 $n$）同时来到体育馆报名签到，领取准考证和参赛资料。为了有序报名，这 $n$ 位同学需要按编号次序（编号为 $1$ 的同学站在最前面）从前往后排成一条直线。然而每一位同学都不喜欢拥挤，对于第 $i$ 位同学，如果有另外一位同学距离他/她的距离小于 $a_i$，那么就会发生冲突。小可可想知道如果要不发生任何冲突的情况下，这 $n$ 位同学排队的队列最短长度是多少。", "inputFormat": "第一行一个整数 $n$ ，表示报名签到的同学人数。\n\n第二行有 $n$ 个整数，第 $i$ 个整数 $a_i$ 表示第 $i$ 个同学必须与其他同学保持的距离。", "outputFormat": "输出一行，包括一个整数，表示这 $n$ 位同学排队队列的最小长度。\n\n注意： $n$ 位同学要按 $1$ 到 $n$ 的次序从前往后排队。", "hint": "对于 $20\\%$ 的数据满足：$1\\le n\\le 20$。\n\n对于 $70\\%$ 的数据满足：$1\\le n\\le 10^4$。\n\n对于 $100\\%$ 的数据满足：$1\\le n\\le 10^5$，$1\\le a_i\\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P4446", "type": "P", "difficulty": 4, "samples": [["3\n125 81 52", "5\n3\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2018", "安徽", "枚举", "素数判断,质数,筛法"], "title": "[AHOI2018初中组] 根式化简", "background": null, "description": "小可可在学习“立方根”的知识时碰到这样的问题：\n\n将下面根式化简为最简根式：\n\n(1) $\\sqrt[3]{125}$ (2) $\\sqrt[3]{81}$ (3) $\\sqrt[3]{52}$\n\n这个问题对于小可可来说太简单了，他很快就算出了答案：\n\n(1) $5$ (2) $3\\sqrt[3]{3}$ (3) $\\sqrt[3]{52}$\n\n小可可知道任意形如 $\\sqrt[3]{x}$ 的根式，化简后一定可以被写成形如 $a\\sqrt[3]{b}$ 的最简根式。他觉得这很有趣，就仿照出了不少题，但没一会儿就被密密麻麻的根式绕晕了，于是他向你求助：\n\n给定 $n$ 个形如 $\\sqrt[3]{x}$ 的根式，请你将它们化简为形如 $a\\sqrt[3]{b}$ 的最简形式，为了方便，你只需要输出其中的 $a$ 即可。\n\n如果你没有学过这部分数学知识，你可以认为题意是：给你 $n$ 个正整数 $x$，对于每一个 $x$，你需要求出整数 $a,b$ 使得 $a^3 \\times b = x$，输出最大的整数 $a$ 即可。", "inputFormat": "输入有两行：\n\n第一行一个整数 $n$，表示有 $n$ 个形如 $\\sqrt[3]{x}$ 的根式；  \n第二行 $n$ 个正整数，依次给出每个$x$。", "outputFormat": "输出 $n$ 行，每行一个正整数，第 $i$ 行正整数表示你对输入中第 $i$ 个 $x$ 给出的答案。", "hint": "对于 $100\\%$ 的数据满足：$1 \\le n \\le 10000$，$1 \\le x \\le 10^{18}$。\n\n本题共 10 个测试点，编号为1 \\~ 10，每个测试点额外保证如下：\n \n1 \\~ 2： $n \\le 10, x \\le 10^6$   \n3 \\~ 4： $n \\le 10, x \\le 10^9$  \n5 \\~ 6： $n \\le 100, x \\le 10^{18}$ 且 $x$ 为完全立方数  \n7 \\~ 8： $n \\le 500, x \\le 10^{18}$  \n9 \\~ 10： $n \\le 10000, x \\le 10^{18}$", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2018 Middle School] Radical Simplification", "background": "", "description": "While learning about cube roots, Keke encountered the following problem:\n\nSimplify the following radicals to their simplest forms:\n\n(1) $\\sqrt[3]{125}$ (2) $\\sqrt[3]{81}$ (3) $\\sqrt[3]{52}$\n\nThis was too easy for Keke, and he quickly got the answers:\n\n(1) $5$ (2) $3\\sqrt[3]{3}$ (3) $\\sqrt[3]{52}$\n\nKeke knows that any radical of the form $\\sqrt[3]{x}$ can be simplified to the simplest form $a\\sqrt[3]{b}$. He found this interesting and created many similar problems, but soon got overwhelmed, so he asked you for help:\n\nGiven $n$ radicals of the form $\\sqrt[3]{x}$, simplify each to the simplest form $a\\sqrt[3]{b}$. For convenience, you only need to output $a$.\n\nIf you have not learned this topic, you can think of it as: given $n$ positive integers $x$, for each $x$, find integers $a, b$ such that $a^3 \\times b = x$, and output the largest integer $a$.", "inputFormat": "The input has two lines:\n\n- The first line contains an integer $n$, the number of radicals of the form $\\sqrt[3]{x}$.\n- The second line contains $n$ positive integers, giving each $x$ in order.", "outputFormat": "Output $n$ lines, each with a positive integer. The $i$-th line contains the answer for the $i$-th $x$ in the input.", "hint": "For $100\\%$ of the testdata: $1 \\le n \\le 10000$, $1 \\le x \\le 10^{18}$.\n\nThere are 10 test points, numbered $1 \\sim 10$, with the following additional guarantees:\n\n1 ~ 2: $n \\le 10$, $x \\le 10^6$.  \n3 ~ 4: $n \\le 10$, $x \\le 10^9$.  \n5 ~ 6: $n \\le 100$, $x \\le 10^{18}$ and $x$ is a perfect cube.  \n7 ~ 8: $n \\le 500$, $x \\le 10^{18}$.  \n9 ~ 10: $n \\le 10000$, $x \\le 10^{18}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2018初中组] 根式化简", "background": null, "description": "小可可在学习“立方根”的知识时碰到这样的问题：\n\n将下面根式化简为最简根式：\n\n(1) $\\sqrt[3]{125}$ (2) $\\sqrt[3]{81}$ (3) $\\sqrt[3]{52}$\n\n这个问题对于小可可来说太简单了，他很快就算出了答案：\n\n(1) $5$ (2) $3\\sqrt[3]{3}$ (3) $\\sqrt[3]{52}$\n\n小可可知道任意形如 $\\sqrt[3]{x}$ 的根式，化简后一定可以被写成形如 $a\\sqrt[3]{b}$ 的最简根式。他觉得这很有趣，就仿照出了不少题，但没一会儿就被密密麻麻的根式绕晕了，于是他向你求助：\n\n给定 $n$ 个形如 $\\sqrt[3]{x}$ 的根式，请你将它们化简为形如 $a\\sqrt[3]{b}$ 的最简形式，为了方便，你只需要输出其中的 $a$ 即可。\n\n如果你没有学过这部分数学知识，你可以认为题意是：给你 $n$ 个正整数 $x$，对于每一个 $x$，你需要求出整数 $a,b$ 使得 $a^3 \\times b = x$，输出最大的整数 $a$ 即可。", "inputFormat": "输入有两行：\n\n第一行一个整数 $n$，表示有 $n$ 个形如 $\\sqrt[3]{x}$ 的根式；  \n第二行 $n$ 个正整数，依次给出每个$x$。", "outputFormat": "输出 $n$ 行，每行一个正整数，第 $i$ 行正整数表示你对输入中第 $i$ 个 $x$ 给出的答案。", "hint": "对于 $100\\%$ 的数据满足：$1 \\le n \\le 10000$，$1 \\le x \\le 10^{18}$。\n\n本题共 10 个测试点，编号为1 \\~ 10，每个测试点额外保证如下：\n \n1 \\~ 2： $n \\le 10, x \\le 10^6$   \n3 \\~ 4： $n \\le 10, x \\le 10^9$  \n5 \\~ 6： $n \\le 100, x \\le 10^{18}$ 且 $x$ 为完全立方数  \n7 \\~ 8： $n \\le 500, x \\le 10^{18}$  \n9 \\~ 10： $n \\le 10000, x \\le 10^{18}$", "locale": "zh-CN"}}}
{"pid": "P4447", "type": "P", "difficulty": 4, "samples": [["7\n4 5 2 3 -4 -3 -5", "3\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "2018", "二分", "安徽", "队列"], "title": "[AHOI2018初中组] 分组", "background": null, "description": "小可可的学校信息组总共有 $n$ 个队员，每个人都有一个实力值 $a_i$。现在，一年一度的编程大赛就要到了，小可可的学校获得了若干个参赛名额，教练决定把学校信息组的 $n$ 个队员分成若干个小组去参加这场比赛。\n\n但是每个队员都不会愿意与实力跟自己过于悬殊的队员组队，于是要求分成的每个小组的队员实力值连续，同时，一个队不需要两个实力相同的选手。举个例子：$[1, 2, 3, 4, 5]$ 是合法的分组方案，因为实力值连续；$[1, 2, 3, 5]$ 不是合法的分组方案，因为实力值不连续；$[0, 1, 1, 2]$ 同样不是合法的分组方案，因为出现了两个实力值为 $1$ 的选手。\n\n如果有小组内人数太少，就会因为时间不够而无法获得高分，于是小可可想让你给出一个合法的分组方案，满足所有人都恰好分到一个小组，使得人数最少的组人数最多，输出人数最少的组人数的最大值。\n\n注意：实力值可能是负数，分组的数量没有限制。", "inputFormat": "输入有两行：\n\n第一行一个正整数 $n$，表示队员数量。  \n\n第二行有 $n$ 个整数，第 $i$ 个整数 $a_i$ 表示第 $i$ 个队员的实力。", "outputFormat": "输出一行，包括一个正整数，表示人数最少的组的人数最大值。", "hint": "### 样例解释\n\n分为 $2$ 组，一组的队员实力值是 $[4, 5, 2, 3]$，一组是 $[-4, -3, -5]$，其中最小的组人数为 $3$，可以发现没有比 $3$ 更优的分法了。\n\n### 数据范围\n\n对于 $100\\%$ 的数据满足：$1\\leq n\\leq 10^5$，$|a_i|\\leq10^9$。\n\n本题共 $10$ 个测试点，编号为 $1\\sim10$，每个测试点额外保证如下：\n| 测试点编号 | 数据限制 |\n| :-----------: | :-----------: |\n| $1\\sim2$ | $n\\leq 6, 1\\leq a_i \\leq 100$ |\n| $3\\sim4$ | $n\\leq 1000, 1\\leq a_i\\leq 10^5$ 且 $a_i$ 互不相同 |\n| $5\\sim6$ | $n\\leq 10^5$，$a_i$ 互不相同 |\n| $7\\sim8$ | $n\\leq 10^5, 1\\leq a_i \\leq10^5$ |\n| $9\\sim 10$ | $n\\leq 10^5, -10^9 \\leq a_i \\leq 10^9$ |", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2018 Junior High Division] Grouping", "background": "", "description": "There are $n$ members in Coco's school's informatics team, and each person has a strength value $a_i$. The annual programming contest is coming, and the school has obtained several participation slots. The coach decides to divide the $n$ team members into several groups to participate in the contest.\n\nHowever, no one wants to team up with someone whose strength differs too much from their own, so each group must consist of members whose strength values form a consecutive sequence. Also, no two players in the same group may have the same strength value. For example: $[1, 2, 3, 4, 5]$ is a valid grouping because the strengths are consecutive; $[1, 2, 3, 5]$ is not valid because the strengths are not consecutive; $[0, 1, 1, 2]$ is also not valid because two players have the same strength value $1$.\n\nIf a group is too small, it will not have enough time to score well. Therefore, Coco wants you to give a valid grouping that assigns everyone to exactly one group and maximizes the size of the smallest group. Output the maximum possible size of the smallest group.\n\nNote: Strength values can be negative, and there is no limit on the number of groups.", "inputFormat": "Two lines:\n\nThe first line contains a positive integer $n$, the number of team members.\n\nThe second line contains $n$ integers. The $i$-th integer $a_i$ denotes the strength of the $i$-th player.", "outputFormat": "Output one line containing a single positive integer: the maximum possible size of the smallest group.", "hint": "### Sample Explanation\n\nDivide into $2$ groups: one group has strengths $[4, 5, 2, 3]$, and the other has $[-4, -3, -5]$. The smallest group size is $3$, and there is no better grouping than $3$.\n\n### Constraints\n\nFor $100\\%$ of the testdata: $1 \\leq n \\leq 10^5$, $|a_i| \\leq 10^9$.\n\nThis problem has $10$ test points, numbered $1 \\sim 10$, each with additional guarantees as follows:\n| Test point ID | Constraints |\n| :-----------: | :-----------: |\n| $1 \\sim 2$ | $n \\leq 6$, $1 \\leq a_i \\leq 100$ |\n| $3 \\sim 4$ | $n \\leq 1000$, $1 \\leq a_i \\leq 10^5$ and $a_i$ are all distinct |\n| $5 \\sim 6$ | $n \\leq 10^5$, $a_i$ are all distinct |\n| $7 \\sim 8$ | $n \\leq 10^5$, $1 \\leq a_i \\leq 10^5$ |\n| $9 \\sim 10$ | $n \\leq 10^5$, $-10^9 \\leq a_i \\leq 10^9$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2018初中组] 分组", "background": null, "description": "小可可的学校信息组总共有 $n$ 个队员，每个人都有一个实力值 $a_i$。现在，一年一度的编程大赛就要到了，小可可的学校获得了若干个参赛名额，教练决定把学校信息组的 $n$ 个队员分成若干个小组去参加这场比赛。\n\n但是每个队员都不会愿意与实力跟自己过于悬殊的队员组队，于是要求分成的每个小组的队员实力值连续，同时，一个队不需要两个实力相同的选手。举个例子：$[1, 2, 3, 4, 5]$ 是合法的分组方案，因为实力值连续；$[1, 2, 3, 5]$ 不是合法的分组方案，因为实力值不连续；$[0, 1, 1, 2]$ 同样不是合法的分组方案，因为出现了两个实力值为 $1$ 的选手。\n\n如果有小组内人数太少，就会因为时间不够而无法获得高分，于是小可可想让你给出一个合法的分组方案，满足所有人都恰好分到一个小组，使得人数最少的组人数最多，输出人数最少的组人数的最大值。\n\n注意：实力值可能是负数，分组的数量没有限制。", "inputFormat": "输入有两行：\n\n第一行一个正整数 $n$，表示队员数量。  \n\n第二行有 $n$ 个整数，第 $i$ 个整数 $a_i$ 表示第 $i$ 个队员的实力。", "outputFormat": "输出一行，包括一个正整数，表示人数最少的组的人数最大值。", "hint": "### 样例解释\n\n分为 $2$ 组，一组的队员实力值是 $[4, 5, 2, 3]$，一组是 $[-4, -3, -5]$，其中最小的组人数为 $3$，可以发现没有比 $3$ 更优的分法了。\n\n### 数据范围\n\n对于 $100\\%$ 的数据满足：$1\\leq n\\leq 10^5$，$|a_i|\\leq10^9$。\n\n本题共 $10$ 个测试点，编号为 $1\\sim10$，每个测试点额外保证如下：\n| 测试点编号 | 数据限制 |\n| :-----------: | :-----------: |\n| $1\\sim2$ | $n\\leq 6, 1\\leq a_i \\leq 100$ |\n| $3\\sim4$ | $n\\leq 1000, 1\\leq a_i\\leq 10^5$ 且 $a_i$ 互不相同 |\n| $5\\sim6$ | $n\\leq 10^5$，$a_i$ 互不相同 |\n| $7\\sim8$ | $n\\leq 10^5, 1\\leq a_i \\leq10^5$ |\n| $9\\sim 10$ | $n\\leq 10^5, -10^9 \\leq a_i \\leq 10^9$ |", "locale": "zh-CN"}}}
{"pid": "P4448", "type": "P", "difficulty": 6, "samples": [["4\n2 2 3 4", "12\n"], ["9\n2 4 8 9 12 4 3 6 11", "99360"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2018", "安徽", "容斥原理"], "title": "[AHOI2018初中组] 球球的排列", "background": "", "description": "小可可是一个有着特殊爱好的人。他特别喜欢收集各种各样的球球，至今已经收集了$n$ 个球球。\n\n小可可又是一个有着特殊想法的人。他将他的所有球球从 1 到$n$ 编号，并每天都把球球排成一个全新的排列。\n\n小可可又是一个有着特殊情怀的人。他将每个球球的特点用$a[i]$来表示（注意这里不同的球$a[i]$可能相同）。\n\n小可可又是一个爱恨分明的人。他十分讨厌平方数，所以他规定：一个排列$p$，对于所有的$1 ≤ i < n$，$a[p_i]\\times a[p_{i+1}]$ 不是一个平方数，这样的排列$p$ 才是合法的。\n\n小可可一直坚持每天排一个全新的合法的排列。有一天，他心血来潮，想知道所有合法排列的个数。小可可十分强，他当然知道怎么算。不过，他想用这个题来考考身在考场的你。这个数可能太大了，所以你只需要告诉小可可合法排列个数对$10^9+7$ 取模的结果就可以了。\n\n你能正确回答小可可的问题吗？如果能的话，他说不定会送个球球给你呢……", "inputFormat": "输入有两行：\n\n第一行一个正整数$n$，表示小可可拥有的球球个数。  \n第二行有$n$ 个整数，第$i$ 个整数$a[i]$表示编号为$i$ 的球球的特点。", "outputFormat": "输出一行，包括一个正整数，表示合法排列个数对$10^9+7$（即1000000007）取模的结果。", "hint": "【样例1 解释】\n12 种合法的排列分别为：\n```\n1,3,2,4\n2,3,1,4\n3,1,4,2\n3,2,4,1\n1,3,4,2\n2,3,4,1\n1,4,2,3\n2,4,1,3\n4,1,3,2\n4,2,3,1\n1,4,3,2\n2,4,3,1\n```\n\n【数据范围】\n\n对于100%的数据满足：$1≤n≤300$，$1≤a[i]≤10^9$。\n\n本题共10 个测试点，编号为1~10，每个测试点额外保证如下：\n\n测试点编号| n的范围|a[i]的范围\n-|-|-\n1~2|$n≤10$|$a[i]≤10^9$\n3~5|$n≤300$|$1≤a[i]≤2$\n6~8|-|$a[i]≤10^9$且都是质数\n9~10|-|$a[i]≤10^9$", "locale": "zh-CN", "translations": {"en": {"title": "[AHOI2018 Junior] Arrangement of Balls", "background": "", "description": "Xiao Keke is a person with special hobbies. He especially likes collecting all kinds of balls, and has collected $n$ balls so far.\n\nXiao Keke also has special ideas. He numbers all his balls from 1 to $n$, and arranges the balls into a brand-new permutation every day.\n\nXiao Keke also has special feelings. He represents the attribute of each ball by $a[i]$ (note that $a[i]$ can be the same for different balls).\n\nXiao Keke is a person of clear likes and dislikes. He hates perfect squares, so he stipulates: for a permutation $p$, for all $1 \\le i < n$, $a[p_i] \\times a[p_{i+1}]$ is not a perfect square; only such a permutation $p$ is valid.\n\nHe keeps arranging a brand-new valid permutation every day. One day, on a whim, he wants to know the number of all valid permutations. Xiao Keke is very strong and certainly knows how to compute it. However, he wants to test you with this problem. This number can be very large, so you only need to tell him the number of valid permutations modulo $10^9+7$.\n\nCan you answer Xiao Keke’s question correctly? If you can, he might even give you a ball.", "inputFormat": "The input has two lines:\n- The first line contains a positive integer $n$, the number of balls that Xiao Keke has.\n- The second line contains $n$ integers; the $i$-th integer $a[i]$ denotes the attribute of the ball with index $i$.", "outputFormat": "Output one line containing a single positive integer, the number of valid permutations modulo $10^9+7$ (i.e., 1000000007).", "hint": "[Sample 1 Explanation]  \nThere are 12 valid permutations:\n```\n1,3,2,4\n2,3,1,4\n3,1,4,2\n3,2,4,1\n1,3,4,2\n2,3,4,1\n1,4,2,3\n2,4,1,3\n4,1,3,2\n4,2,3,1\n1,4,3,2\n2,4,3,1\n```\n\nConstraints\n\nFor 100% of the testdata: $1 \\le n \\le 300$, $1 \\le a[i] \\le 10^9$.\n\nThis problem has 10 test points, numbered 1-10; each test point additionally guarantees the following:\n\nTest point id | Range of n | Range of $a[i]$\n-|-|-\n1-2 | $n \\le 10$ | $a[i] \\le 10^9$\n3-5 | $n \\le 300$ | $1 \\le a[i] \\le 2$\n6-8 | - | $a[i] \\le 10^9$ and all are primes\n9-10 | - | $a[i] \\le 10^9$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[AHOI2018初中组] 球球的排列", "background": "", "description": "小可可是一个有着特殊爱好的人。他特别喜欢收集各种各样的球球，至今已经收集了$n$ 个球球。\n\n小可可又是一个有着特殊想法的人。他将他的所有球球从 1 到$n$ 编号，并每天都把球球排成一个全新的排列。\n\n小可可又是一个有着特殊情怀的人。他将每个球球的特点用$a[i]$来表示（注意这里不同的球$a[i]$可能相同）。\n\n小可可又是一个爱恨分明的人。他十分讨厌平方数，所以他规定：一个排列$p$，对于所有的$1 ≤ i < n$，$a[p_i]\\times a[p_{i+1}]$ 不是一个平方数，这样的排列$p$ 才是合法的。\n\n小可可一直坚持每天排一个全新的合法的排列。有一天，他心血来潮，想知道所有合法排列的个数。小可可十分强，他当然知道怎么算。不过，他想用这个题来考考身在考场的你。这个数可能太大了，所以你只需要告诉小可可合法排列个数对$10^9+7$ 取模的结果就可以了。\n\n你能正确回答小可可的问题吗？如果能的话，他说不定会送个球球给你呢……", "inputFormat": "输入有两行：\n\n第一行一个正整数$n$，表示小可可拥有的球球个数。  \n第二行有$n$ 个整数，第$i$ 个整数$a[i]$表示编号为$i$ 的球球的特点。", "outputFormat": "输出一行，包括一个正整数，表示合法排列个数对$10^9+7$（即1000000007）取模的结果。", "hint": "【样例1 解释】\n12 种合法的排列分别为：\n```\n1,3,2,4\n2,3,1,4\n3,1,4,2\n3,2,4,1\n1,3,4,2\n2,3,4,1\n1,4,2,3\n2,4,1,3\n4,1,3,2\n4,2,3,1\n1,4,3,2\n2,4,3,1\n```\n\n【数据范围】\n\n对于100%的数据满足：$1≤n≤300$，$1≤a[i]≤10^9$。\n\n本题共10 个测试点，编号为1~10，每个测试点额外保证如下：\n\n测试点编号| n的范围|a[i]的范围\n-|-|-\n1~2|$n≤10$|$a[i]≤10^9$\n3~5|$n≤300$|$1≤a[i]≤2$\n6~8|-|$a[i]≤10^9$且都是质数\n9~10|-|$a[i]≤10^9$", "locale": "zh-CN"}}}
{"pid": "P4449", "type": "P", "difficulty": 6, "samples": [["1 2\n3 3", "20"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [268000, 268000, 268000, 268000, 268000, 268000, 268000, 268000, 268000, 268000]}, "tags": ["数学", "素数判断,质数,筛法", "莫比乌斯反演", "前缀和"], "title": "于神之怒加强版", "background": "", "description": "给定 $n,m,k$，计算\n\n$$\\sum_{i=1}^n \\sum_{j=1}^m \\gcd(i,j)^k$$\n\n对 $10^9 + 7$ 取模的结果。", "inputFormat": "**本题单测试点内有多组测试数据**。\n\n第一行有两个整数，分别表示数据组数 $T$ 和给定的 $k$。\n\n接下来 $T$ 行，每行两个整数，表示一组数据的 $n$ 和 $m$。", "outputFormat": "对于每组数据，输出一行一个整数表示答案。", "hint": "#### 数据规模与约定\n\n对于全部的测试点，保证 $1 \\leq T \\leq 2 \\times 10^3$，$1 \\leq n, m, k \\leq 5 \\times 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "Yu Shen's Fury Enhanced Edition", "background": "", "description": "Given $n, m, k$, compute\n$$\\sum_{i=1}^n \\sum_{j=1}^m \\gcd(i,j)^k$$\nand output the result modulo $10^9 + 7$.", "inputFormat": "**There are multiple test cases in a single test file.**\n\nThe first line contains two integers, the number of test cases $T$ and the given $k$.\n\nThe next $T$ lines each contain two integers, $n$ and $m$, for one test case.", "outputFormat": "For each test case, output one line with a single integer representing the answer.", "hint": "Constraints\n\nFor all test points, it is guaranteed that $1 \\leq T \\leq 2 \\times 10^3$, $1 \\leq n, m, k \\leq 5 \\times 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "于神之怒加强版", "background": "", "description": "给定 $n,m,k$，计算\n\n$$\\sum_{i=1}^n \\sum_{j=1}^m \\gcd(i,j)^k$$\n\n对 $10^9 + 7$ 取模的结果。", "inputFormat": "**本题单测试点内有多组测试数据**。\n\n第一行有两个整数，分别表示数据组数 $T$ 和给定的 $k$。\n\n接下来 $T$ 行，每行两个整数，表示一组数据的 $n$ 和 $m$。", "outputFormat": "对于每组数据，输出一行一个整数表示答案。", "hint": "#### 数据规模与约定\n\n对于全部的测试点，保证 $1 \\leq T \\leq 2 \\times 10^3$，$1 \\leq n, m, k \\leq 5 \\times 10^6$。", "locale": "zh-CN"}}}
{"pid": "P4450", "type": "P", "difficulty": 5, "samples": [["5 5 2\n", "3"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000, 64000]}, "tags": ["数学", "莫比乌斯反演", "整除分块"], "title": "双亲数", "background": null, "description": "小 D 是一名数学爱好者，他对数字的着迷到了疯狂的程度。\n\n我们以 $d = \\gcd(a, b)$ 表示 $a, b$ 的最大公约数，小 D 执著的认为，这样亲密的关系足可以用双亲来描述，此时，我们称**有序**数对 $(a, b)$ 为 $d$ 的双亲数。\n\n与正常双亲不太相同的是，对于同一个 $d$，他的双亲太多了。\n\n比如，$(4, 6)$，$(6, 4)$，$(2, 100)$ 都是 $2$ 的双亲数。  \n\n于是一个这样的问题摆在眼前，对于 $1 \\leq a \\leq A$，$1 \\leq b \\leq B$，有多少**有序**数对 $(a, b)$ 是 $d$ 的双亲数？", "inputFormat": "输入只有一行三个整数，分别表示 $A, B, d$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "#### 样例 1 解释\n\n共有三对双亲数：$(2, 2)$，$(2, 4)$，$(4, 2)$。\n\n#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，保证 $1 \\leq A, B \\leq 10^6$，$1 \\leq d \\leq \\min(A, B)$。", "locale": "zh-CN", "translations": {"en": {"title": "Parent Pairs", "background": "", "description": "Xiao D is a math enthusiast, and his obsession with numbers has reached a crazy level.\n\nWe use $d = \\gcd(a, b)$ to denote the greatest common divisor of $a$ and $b$. Xiao D insists that such a close relationship can be described as parents. In this case, we call the **ordered** pair $(a, b)$ a parent pair of $d$.\n\nUnlike normal parents, for the same $d$, it has too many parents.\n\nFor example, $(4, 6)$, $(6, 4)$, $(2, 100)$ are all parent pairs of $2$.  \nThus the following question arises: for $1 \\leq a \\leq A$, $1 \\leq b \\leq B$, how many **ordered** pairs $(a, b)$ are parent pairs of $d$?", "inputFormat": "The input contains a single line with three integers, representing $A$, $B$, and $d$.", "outputFormat": "Output a single integer on one line representing the answer.", "hint": "Sample 1 Explanation\n\nThere are three parent pairs: $(2, 2)$, $(2, 4)$, $(4, 2)$.\n\nConstraints\n\n- For $100\\%$ of the testdata, it is guaranteed that $1 \\leq A, B \\leq 10^6$, $1 \\leq d \\leq \\min(A, B)$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "双亲数", "background": null, "description": "小 D 是一名数学爱好者，他对数字的着迷到了疯狂的程度。\n\n我们以 $d = \\gcd(a, b)$ 表示 $a, b$ 的最大公约数，小 D 执著的认为，这样亲密的关系足可以用双亲来描述，此时，我们称**有序**数对 $(a, b)$ 为 $d$ 的双亲数。\n\n与正常双亲不太相同的是，对于同一个 $d$，他的双亲太多了。\n\n比如，$(4, 6)$，$(6, 4)$，$(2, 100)$ 都是 $2$ 的双亲数。  \n\n于是一个这样的问题摆在眼前，对于 $1 \\leq a \\leq A$，$1 \\leq b \\leq B$，有多少**有序**数对 $(a, b)$ 是 $d$ 的双亲数？", "inputFormat": "输入只有一行三个整数，分别表示 $A, B, d$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "#### 样例 1 解释\n\n共有三对双亲数：$(2, 2)$，$(2, 4)$，$(4, 2)$。\n\n#### 数据规模与约定\n\n- 对于 $100\\%$ 的数据，保证 $1 \\leq A, B \\leq 10^6$，$1 \\leq d \\leq \\min(A, B)$。", "locale": "zh-CN"}}}
{"pid": "P4451", "type": "P", "difficulty": 6, "samples": [["3", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["递推", "2011", "集训队互测", "Fibonacci 数列", "生成函数", "线性递推"], "title": "[国家集训队] 整数的lqp拆分", "background": "来源：2011中国国家集训队命题答辩", "description": "lqp在为出题而烦恼，他完全没有头绪，好烦啊…\n\n他首先想到了整数拆分。整数拆分是个很有趣的问题。给你一个正整数 $N$ ，对于N的一个整数拆分就是满足任意 $m>0$，$a_1 ,a_2 ,a_3…a_m>0$，且 $a_1+a_2+a_3+\\cdots+a_m=n$ 的一个有序集合。通过长时间的研究我们发现了计算对于 $n$ 的整数拆分的总数有一个很简单的递推式，但是因为这个递推式实在太简单了，如果出这样的题目，大家会对比赛毫无兴趣的。  \n\n然后 lqp 又想到了斐波那契数。定义 $F_0=0,F_1=1,F_n=F_{n-1}+F_{n-2}(n>1)$，$F_n$ 就是斐波那契数的第 $n$ 项。但是求出第 $n$ 项斐波那契数似乎也不怎么困难…\n\nlqp 为了增加选手们比赛的欲望，于是绞尽脑汁，想出了一个有趣的整数拆分，我们暂且叫它：整数的 lqp 拆分。\n\n和一般的整数拆分一样，整数的 lqp 拆分是满足任意 $m>0$，$a_1 ,a_2 ,a_3,\\cdots,a_m>0$，且 $a_1+a_2+a_3+\\cdots+a_m=n$ 的一个有序集合。但是整数的 lqp 拆分要求的不是拆分总数，相对更加困难一些。\n\n对于每个拆分，lqp 定义这个拆分的权值 $F_{a_1}F_{a_2}\\cdots F_{a_m}$，他想知道对于所有的拆分，他们的权值之和是多少？\n\n简单来说，就是求  \n$$\n\\sum_{\\substack{m>0\\\\a_1,\\cdots,a_m>0\\\\a_1+\\cdots+a_m=n}}\\prod_{i=1}^mF_{a_i}\n$$\n由于答案可能非常大，所以要对 $10^9 + 7$ 取模。", "inputFormat": "输入的第一行包含一个整数 $n$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "【数据范围】  \n对于 $60\\%$ 的数据，$1\\le n \\le 10^9$。  \n对于 $100\\%$ 的数据，$1\\le n \\le 10^{10000}$。\n\n【样例解释】  \n$F_0=0,F_1=1,F_2=1,F_3=2$。\n\n对于 $n=3$，有这样几种 lqp 拆分：\n\n$3=1+1+1$，权值是 $F_1\\times F_1\\times F_1=1\\times1\\times1=1$。\n\n$3=1+2$，权值是 $F_1\\times F_2=1\\times1=1$。\n\n$3=2+1$，权值是 $F_2\\times F_1=1\\times1=1$。\n\n$3=3$，权值是 $F_3=2$。\n\n所以答案是 $1+1+1+2=5$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTT] lqp Decomposition of Integers", "background": "Source: 2011 China CTT Problem Defense.", "description": "lqp is struggling to write problems and has no clue, which is frustrating.\n\nHe first thought of integer decompositions. Integer decomposition is an interesting problem. Given a positive integer $n$, an integer decomposition of $n$ is an ordered sequence such that for any $m>0$, $a_1,a_2,a_3,\\cdots,a_m>0$, and $a_1+a_2+a_3+\\cdots+a_m=n$. After long study, we found a very simple recurrence to count the total number of integer decompositions of $n$, but because that recurrence is too simple, if he gave such a problem, nobody would be interested.\n\nThen lqp thought of Fibonacci numbers. Define $F_0=0,F_1=1,F_n=F_{n-1}+F_{n-2}(n>1)$; $F_n$ is the $n$-th Fibonacci number. But computing the $n$-th Fibonacci number does not seem very hard either.\n\nTo make the contest more appealing, lqp racked his brain and came up with an interesting integer decomposition; let us call it: the lqp decomposition of an integer.\n\nLike ordinary integer decompositions, an lqp decomposition of an integer is an ordered sequence with $m>0$, $a_1,a_2,a_3,\\cdots,a_m>0$, and $a_1+a_2+a_3+\\cdots+a_m=n$. However, instead of asking for the total number of decompositions, the lqp decomposition asks for something a bit harder.\n\nFor each decomposition, lqp defines its weight as $F_{a_1}F_{a_2}\\cdots F_{a_m}$. He wants to know the sum of the weights over all decompositions.\n\nIn short, compute\n$$\n\\sum_{\\substack{m>0\\\\a_1,\\cdots,a_m>0\\\\a_1+\\cdots+a_m=n}}\\prod_{i=1}^mF_{a_i}\n$$\nSince the answer can be very large, output it modulo $10^9 + 7$.", "inputFormat": "The first line of input contains an integer $n$.", "outputFormat": "Output one line with a single integer representing the answer.", "hint": "Constraints:  \nFor $60\\%$ of the testdata, $1 \\le n \\le 10^9$.  \nFor $100\\%$ of the testdata, $1 \\le n \\le 10^{10000}$.\n\nSample explanation:  \n$F_0=0,F_1=1,F_2=1,F_3=2$.\n\nFor $n=3$, there are the following lqp decompositions:\n\n$3=1+1+1$, the weight is $F_1\\times F_1\\times F_1=1\\times1\\times1=1$.\n\n$3=1+2$, the weight is $F_1\\times F_2=1\\times1=1$.\n\n$3=2+1$, the weight is $F_2\\times F_1=1\\times1=1$.\n\n$3=3$, the weight is $F_3=2$.\n\nTherefore, the answer is $1+1+1+2=5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[国家集训队] 整数的lqp拆分", "background": "来源：2011中国国家集训队命题答辩", "description": "lqp在为出题而烦恼，他完全没有头绪，好烦啊…\n\n他首先想到了整数拆分。整数拆分是个很有趣的问题。给你一个正整数 $N$ ，对于N的一个整数拆分就是满足任意 $m>0$，$a_1 ,a_2 ,a_3…a_m>0$，且 $a_1+a_2+a_3+\\cdots+a_m=n$ 的一个有序集合。通过长时间的研究我们发现了计算对于 $n$ 的整数拆分的总数有一个很简单的递推式，但是因为这个递推式实在太简单了，如果出这样的题目，大家会对比赛毫无兴趣的。  \n\n然后 lqp 又想到了斐波那契数。定义 $F_0=0,F_1=1,F_n=F_{n-1}+F_{n-2}(n>1)$，$F_n$ 就是斐波那契数的第 $n$ 项。但是求出第 $n$ 项斐波那契数似乎也不怎么困难…\n\nlqp 为了增加选手们比赛的欲望，于是绞尽脑汁，想出了一个有趣的整数拆分，我们暂且叫它：整数的 lqp 拆分。\n\n和一般的整数拆分一样，整数的 lqp 拆分是满足任意 $m>0$，$a_1 ,a_2 ,a_3,\\cdots,a_m>0$，且 $a_1+a_2+a_3+\\cdots+a_m=n$ 的一个有序集合。但是整数的 lqp 拆分要求的不是拆分总数，相对更加困难一些。\n\n对于每个拆分，lqp 定义这个拆分的权值 $F_{a_1}F_{a_2}\\cdots F_{a_m}$，他想知道对于所有的拆分，他们的权值之和是多少？\n\n简单来说，就是求  \n$$\n\\sum_{\\substack{m>0\\\\a_1,\\cdots,a_m>0\\\\a_1+\\cdots+a_m=n}}\\prod_{i=1}^mF_{a_i}\n$$\n由于答案可能非常大，所以要对 $10^9 + 7$ 取模。", "inputFormat": "输入的第一行包含一个整数 $n$。", "outputFormat": "输出一行一个整数表示答案。", "hint": "【数据范围】  \n对于 $60\\%$ 的数据，$1\\le n \\le 10^9$。  \n对于 $100\\%$ 的数据，$1\\le n \\le 10^{10000}$。\n\n【样例解释】  \n$F_0=0,F_1=1,F_2=1,F_3=2$。\n\n对于 $n=3$，有这样几种 lqp 拆分：\n\n$3=1+1+1$，权值是 $F_1\\times F_1\\times F_1=1\\times1\\times1=1$。\n\n$3=1+2$，权值是 $F_1\\times F_2=1\\times1=1$。\n\n$3=2+1$，权值是 $F_2\\times F_1=1\\times1=1$。\n\n$3=3$，权值是 $F_3=2$。\n\n所以答案是 $1+1+1+2=5$。", "locale": "zh-CN"}}}
{"pid": "P4452", "type": "P", "difficulty": 6, "samples": [["2 1 1 10\n0 5\n5 0\n0 5\n5 0\n0 1 0 5 10", "5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2012", "集训队互测", "网络流", "费用流"], "title": "[国家集训队] 航班安排", "background": "1. wqs 爱好模拟飞行。\n2. clj 开了一家神犇航空，由于 clj 还要玩游戏，所以公司的事务由你来打理。\n\n注意：题目中只是用了这样一个背景，并不与真实 / 模拟飞行相符。", "description": "神犇航空有 $K$ 架飞机，为了简化问题，我们认为每架飞机都是相同的。神犇航空的世界中有 $N$ 个机场，以 $0\\cdots N-1$ 编号，其中 $0$ 号为基地机场，每天 $0$ 时刻起飞机才可以从该机场起飞，并不晚于 $T$ 时刻回到该机场。\n\n一天，神犇航空接到了 $M$ 个包机请求，每个请求为在 $s$ 时刻从 $a$ 机场起飞，在恰好 $t$ 时刻到达 $b$ 机场，可以净获利 $c$。换言之，你只需要在 $s$ 时刻在 $a$ 机场选择提供一架飞机给请求方，那么这架飞机就会在 $t$ 时刻准时出现在 $b$ 机场，并且你将获得 $c$ 的净利润。\n\n设计一种方案，使得总收益最大。", "inputFormat": "第一行，$4$ 个正整数 $N,M,K,T$，如题目描述中所述；\n\n以下 $N$ 行，每行 $N$ 个整数，描述一个 $N\\times N$ 的矩阵 $t$，$t_{i,j}$ 表示从机场 $i$ 空载飞至机场 $j$，需要时间 $t_{i,j}$；\n\n以下 $N$ 行，每行 $N$ 个整数，描述一个 $N\\times N$ 的矩阵 $f$，$f_{i,j}$ 表示从机场 $i$ 空载飞至机场 $j$，需要费用 $f_{i,j}$；\n\n以下 $M$ 行，每行 $5$ 个整数描述一个请求，依次为 $a,b,s,t,c$。", "outputFormat": "　　仅一行，一个整数，表示最大收益。", "hint": "对于 $10\\%$ 的测试数据，$K=1$；\n\n另有 $20\\%$ 的测试数据，$K=2$；\n\n对于全部的测试数据，$1\\le N,M\\le 200$，$1\\le K\\le 10$，$1\\le T\\le 3000$，$1\\le t_{i,j}\\le 200$，$f_{i,j}\\le 2\\times 10^3$，$0\\le a,b<N$，$0\\le s\\le t\\le T$，$0\\le c\\le 10000$，$t_{i,i}=f_{i,i}=0$，$t_{ij}\\le t_{i,k}+t_{k,j}$，$f_{i,j}\\le f_{i,k}+f_{k,j}$。", "locale": "zh-CN", "translations": {"en": {"title": "[CTT] Flight Scheduling", "background": "1. wqs enjoys flight simulation.\n2. clj founded Shenniu Airlines. Because clj still wants to play games, you are in charge of running the company.\n\nNote: This background is only used for the problem and does not correspond to real or simulated flight.", "description": "Shenniu Airlines has $K$ airplanes. To simplify the problem, assume all airplanes are identical. In the world of Shenniu Airlines, there are $N$ airports, numbered $0 \\cdots N-1$, where airport $0$ is the base. All $K$ airplanes are at airport $0$ at time $0$, may take off starting from time $0$, and must return to airport $0$ no later than time $T$.\n\nDuring one day, the company receives $M$ charter requests. Each request is: depart from airport $a$ at time $s$, arrive at airport $b$ exactly at time $t$, and earn a net profit of $c$. In other words, if you assign an airplane at time $s$ at airport $a$ to this request, that airplane will appear at airport $b$ at time $t$, and you will gain a net profit of $c$.\n\nDesign a plan to maximize the total profit.", "inputFormat": "- The first line contains $4$ positive integers $N, M, K, T$, as described above.\n- The next $N$ lines each contain $N$ integers, describing an $N \\times N$ matrix $t$, where $t_{i,j}$ is the time needed to ferry (empty flight) from airport $i$ to airport $j$.\n- The next $N$ lines each contain $N$ integers, describing an $N \\times N$ matrix $f$, where $f_{i,j}$ is the cost to ferry from airport $i$ to airport $j$.\n- The next $M$ lines each describe one request with $5$ integers: $a, b, s, t, c$.", "outputFormat": "Output a single line with one integer: the maximum profit.", "hint": "- For $10\\%$ of the testdata, $K = 1$.\n- For another $20\\%$ of the testdata, $K = 2$.\n- For all the testdata: $1 \\le N, M \\le 200$, $1 \\le K \\le 10$, $1 \\le T \\le 3000$, $1 \\le t_{i,j} \\le 200$, $f_{i,j} \\le 2 \\times 10^3$, $0 \\le a, b < N$, $0 \\le s \\le t \\le T$, $0 \\le c \\le 10000$, $t_{i,i} = f_{i,i} = 0$, $t_{i,j} \\le t_{i,k} + t_{k,j}$, $f_{i,j} \\le f_{i,k} + f_{k,j}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[国家集训队] 航班安排", "background": "1. wqs 爱好模拟飞行。\n2. clj 开了一家神犇航空，由于 clj 还要玩游戏，所以公司的事务由你来打理。\n\n注意：题目中只是用了这样一个背景，并不与真实 / 模拟飞行相符。", "description": "神犇航空有 $K$ 架飞机，为了简化问题，我们认为每架飞机都是相同的。神犇航空的世界中有 $N$ 个机场，以 $0\\cdots N-1$ 编号，其中 $0$ 号为基地机场，每天 $0$ 时刻起飞机才可以从该机场起飞，并不晚于 $T$ 时刻回到该机场。\n\n一天，神犇航空接到了 $M$ 个包机请求，每个请求为在 $s$ 时刻从 $a$ 机场起飞，在恰好 $t$ 时刻到达 $b$ 机场，可以净获利 $c$。换言之，你只需要在 $s$ 时刻在 $a$ 机场选择提供一架飞机给请求方，那么这架飞机就会在 $t$ 时刻准时出现在 $b$ 机场，并且你将获得 $c$ 的净利润。\n\n设计一种方案，使得总收益最大。", "inputFormat": "第一行，$4$ 个正整数 $N,M,K,T$，如题目描述中所述；\n\n以下 $N$ 行，每行 $N$ 个整数，描述一个 $N\\times N$ 的矩阵 $t$，$t_{i,j}$ 表示从机场 $i$ 空载飞至机场 $j$，需要时间 $t_{i,j}$；\n\n以下 $N$ 行，每行 $N$ 个整数，描述一个 $N\\times N$ 的矩阵 $f$，$f_{i,j}$ 表示从机场 $i$ 空载飞至机场 $j$，需要费用 $f_{i,j}$；\n\n以下 $M$ 行，每行 $5$ 个整数描述一个请求，依次为 $a,b,s,t,c$。", "outputFormat": "　　仅一行，一个整数，表示最大收益。", "hint": "对于 $10\\%$ 的测试数据，$K=1$；\n\n另有 $20\\%$ 的测试数据，$K=2$；\n\n对于全部的测试数据，$1\\le N,M\\le 200$，$1\\le K\\le 10$，$1\\le T\\le 3000$，$1\\le t_{i,j}\\le 200$，$f_{i,j}\\le 2\\times 10^3$，$0\\le a,b<N$，$0\\le s\\le t\\le T$，$0\\le c\\le 10000$，$t_{i,i}=f_{i,i}=0$，$t_{ij}\\le t_{i,k}+t_{k,j}$，$f_{i,j}\\le f_{i,k}+f_{k,j}$。", "locale": "zh-CN"}}}
{"pid": "P4453", "type": "P", "difficulty": 0, "samples": [["3 2 5\n0 1 10 10\n1 2 20 10", "114"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2012", "集训队互测"], "title": "[国家集训队] 飞行计划", "background": "1. wqs喜欢模拟飞行。\n\n2. clj开了一家神犇航空，由于clj还要玩游戏，所以公司的事务由你来打理。\n\n注意：题目中只是用了这样一个背景，并不与真实/模拟飞行相符", "description": "神犇航空有一架航班从$A$地飞往$B$地，需要规划一条最经济的飞行线路。为了简化问题，我们认为地面是一个平面，高度为$0$，上有$N$个航路点，有$M$条双向航线，每条航线连接两个航路点，有两个参数$H$和$W$，表示以$h$高度通过这条航路，费用为$(H-h)2+W$。在每个航路点可以爬升/下降高度，每爬升一个高度需要费用$C$，而下降不需要费用。航路点$0$为$A$地，$N-1$为$B$地。", "inputFormat": "第一行3个正整数，$N,M$和$C$，含义如题目所述；\n\n以下$M$行，每行4个整数，$u,v,H,W$，表示$u,v$之间有一条航线，$H,W$为描述中的两个参数。", "outputFormat": "仅一行，一个整数，表示$A$地到$B$地的最小费用。", "hint": "对于10%的数据，$N,M<=5$，$H<=200$；\n\n另有20%的数据，$N<=100$，$M<=500$，$H<=100$；\n\n对于全部的测试数据，$N<=2000$，$M<=10000$，$C<=10$，$0<=u,v<N$，$0<=H<=10^5$，$0<=W<=2\\times 10^5$；输入保证答案不超出32位有符号整型。", "locale": "zh-CN", "translations": {"en": {"title": "[CTT] Flight Plan", "background": "1. wqs likes flight simulation.\n2. clj started an airline named Shenben Airlines (Shénbén). Since clj also wants to play games, you are in charge of running the company.\n\nNote: This is only a thematic background and does not correspond to real/simulated flight.", "description": "Shenben Airlines has a flight from $A$ to $B$ and needs to plan the most economical route. To simplify, we assume the ground is a plane at height $0$, with $N$ waypoints and $M$ bidirectional airways. Each airway connects two waypoints and has two parameters $H$ and $W$, meaning that traversing this airway at altitude $h$ costs $(H - h)^2 + W$. At each waypoint you may climb or descend; each unit of climb costs $C$, while descending is free. Waypoint $0$ is $A$, and waypoint $N - 1$ is $B$.", "inputFormat": "The first line contains 3 positive integers $N$, $M$, and $C$, as described above.\nThe next $M$ lines each contain 4 integers $u, v, H, W$, indicating there is an airway between $u$ and $v$ with parameters $H$ and $W$.", "outputFormat": "Output a single line with one integer, the minimum cost from $A$ to $B$.", "hint": "Constraints:\n- For 10% of the testdata: $N, M \\le 5$, $H \\le 200$.\n- Additionally, for 20% of the testdata: $N \\le 100$, $M \\le 500$, $H \\le 100$.\n- For all testdata: $N \\le 2000$, $M \\le 10000$, $C \\le 10$, $0 \\le u, v < N$, $0 \\le H \\le 10^5$, $0 \\le W \\le 2 \\times 10^5$. The input guarantees the answer does not exceed a 32-bit signed integer.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[国家集训队] 飞行计划", "background": "1. wqs喜欢模拟飞行。\n\n2. clj开了一家神犇航空，由于clj还要玩游戏，所以公司的事务由你来打理。\n\n注意：题目中只是用了这样一个背景，并不与真实/模拟飞行相符", "description": "神犇航空有一架航班从$A$地飞往$B$地，需要规划一条最经济的飞行线路。为了简化问题，我们认为地面是一个平面，高度为$0$，上有$N$个航路点，有$M$条双向航线，每条航线连接两个航路点，有两个参数$H$和$W$，表示以$h$高度通过这条航路，费用为$(H-h)2+W$。在每个航路点可以爬升/下降高度，每爬升一个高度需要费用$C$，而下降不需要费用。航路点$0$为$A$地，$N-1$为$B$地。", "inputFormat": "第一行3个正整数，$N,M$和$C$，含义如题目所述；\n\n以下$M$行，每行4个整数，$u,v,H,W$，表示$u,v$之间有一条航线，$H,W$为描述中的两个参数。", "outputFormat": "仅一行，一个整数，表示$A$地到$B$地的最小费用。", "hint": "对于10%的数据，$N,M<=5$，$H<=200$；\n\n另有20%的数据，$N<=100$，$M<=500$，$H<=100$；\n\n对于全部的测试数据，$N<=2000$，$M<=10000$，$C<=10$，$0<=u,v<N$，$0<=H<=10^5$，$0<=W<=2\\times 10^5$；输入保证答案不超出32位有符号整型。", "locale": "zh-CN"}}}
{"pid": "P4454", "type": "P", "difficulty": 5, "samples": [["3 31\n3\n27 16\n21 3\n9 26", "4\n21\n25"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "重庆", "各省省选", "枚举", "素数判断,质数,筛法", "逆元"], "title": "[CQOI2018] 破解D-H协议", "background": "Diffie-Hellman 密钥交换协议是一种简单有效的密钥交换方法。它可以让通讯双方在没有事先约定**密钥**的情况下，通过**不安全**（可能被窃听）**的信道**确定一个**安全的密钥** $K$，用于加密之后的通讯内容。", "description": "假定通讯双方名为 Alice 和 Bob，协议的工作过程描述如下（其中 $\\bmod$ 表示取模运算）：\n\n1. 协议规定一个**固定的**质数 $P$，以及模 $P$ 的一个原根 $g$。**$\\boldsymbol P$ 和 $\\boldsymbol g$ 的数值都是公开的，无需保密。**\n\n2. Alice 生成一个随机数 $a$，并计算 $A=g^a\\bmod P$，将 $A$ 通过不安全信道发送给 Bob。\n\n3. Bob 生成一个随机数 $b$，并计算 $B=g^b\\bmod P$，将 $B$ 通过不安全信道发送给 Alice。\n\n4. Bob 根据收到的 $A$ 计算出**密钥** $K=A^b \\bmod P$，而 Alice 根据收到的 $B$ 计算出 $K=B^a\\bmod P$。\n\n5. 双方得到了相同的 $K$，即 $g^{ab} \\bmod P$。$K$ 即之后通讯的加密密钥。\n\n可见，这个过程中可能被窃听的只有 $A,B$，而 $a,b,K$ 是保密的。并且根据 $A,B,P,g$ 这 $4$ 个数，不能轻易计算出 $K$，因此 $K$ 可以作为一个安全的密钥。\n\n当然安全是相对的，该协议的安全性取决于数值的大小，通常 $a,b,P$ 都选取数百位以上的大整数以避免被破解。然而如果 Alice 和 Bob 编程时偷懒，为了避免实现大数运算，选择的数值都小于 $2^{31}$，那么破解他们的密钥就比较容易了。\n\n$T$ 次给定窃听得到的 $A,B$，你需要尝试破解出**密钥** $K$。\n", "inputFormat": "输入文件第一行包含两个空格分开的正整数 $g$ 和 $P$。\n\n第二行为一个正整数 $n$，表示 Alice 和 Bob 共进行了 $n$ 次连接（即运行了 $n$ 次协议）。\n\n接下来 $n$ 行，每行包含两个空格分开的正整数 $A$ 和 $B$，表示某次连接中，被窃听的 $A,B$ 的数值。", "outputFormat": "输出包含 $n$ 行，每行 $1$ 个正整数 $K$，为每次连接你破解得到的密钥。", "hint": "对于 $30\\%$ 的数据，$2\\le A,B,P\\le 1000$；\n\n对于 $100\\%$ 的数据，$2\\le A,B<P<2^{31}，2\\le g<20，1\\le n\\le 20$。\n\n$\\text{Statement fixed by @Starrykiller.}$", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2018] Cracking the D-H Protocol", "background": "The Diffie-Hellman key exchange protocol is a simple and effective method for key exchange. It allows two parties to agree on a secure key $K$ over an insecure (possibly eavesdropped) channel without a pre-shared key, and then use it to encrypt subsequent communication.", "description": "Assume the two parties are named Alice and Bob. The protocol works as follows (where $\\bmod$ denotes the modulo operation):\n\n1. The protocol specifies a fixed prime $P$ and a primitive root modulo $P$, $g$. The values $\\boldsymbol P$ and $\\boldsymbol g$ are public and do not need to be kept secret.\n\n2. Alice generates a random number $a$, computes $A=g^a \\bmod P$, and sends $A$ to Bob over the insecure channel.\n\n3. Bob generates a random number $b$, computes $B=g^b \\bmod P$, and sends $B$ to Alice over the insecure channel.\n\n4. Bob computes the key $K=A^b \\bmod P$ from the received $A$, and Alice computes $K=B^a \\bmod P$ from the received $B$.\n\n5. Both parties obtain the same $K$, namely $g^{ab} \\bmod P$. $K$ is the encryption key for later communication.\n\nIn this process, only $A$ and $B$ can be eavesdropped, while $a$, $b$, and $K$ remain secret. Given the four numbers $A$, $B$, $P$, and $g$, it is not easy to compute $K$, so $K$ can serve as a secure key.\n\nOf course, security is relative. The security of the protocol depends on the sizes of the values. Typically, $a$, $b$, and $P$ are chosen as large integers with hundreds of bits to prevent compromise. However, if Alice and Bob are lazy in programming and, to avoid implementing big-integer arithmetic, choose values less than $2^{31}$, then cracking their key becomes relatively easy.\n\nGiven $n$ pairs of eavesdropped $A$ and $B$, you need to try to crack the key $K$.", "inputFormat": "The first line contains two space-separated positive integers $g$ and $P$.\n\nThe second line contains a positive integer $n$, indicating that Alice and Bob performed $n$ sessions (i.e., ran the protocol $n$ times).\n\nThen follow $n$ lines. Each line contains two space-separated positive integers $A$ and $B$, representing the eavesdropped values $A$ and $B$ for one session.", "outputFormat": "Output $n$ lines. Each line contains a single positive integer $K$, which is the key you cracked for that session.", "hint": "For $30\\%$ of the testdata, $2\\le A,B,P\\le 1000$.\n\nFor $100\\%$ of the testdata, $2\\le A,B<P<2^{31}$, $2\\le g<20$, $1\\le n\\le 20$.\n\nStatement fixed by @Starrykiller.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2018] 破解D-H协议", "background": "Diffie-Hellman 密钥交换协议是一种简单有效的密钥交换方法。它可以让通讯双方在没有事先约定**密钥**的情况下，通过**不安全**（可能被窃听）**的信道**确定一个**安全的密钥** $K$，用于加密之后的通讯内容。", "description": "假定通讯双方名为 Alice 和 Bob，协议的工作过程描述如下（其中 $\\bmod$ 表示取模运算）：\n\n1. 协议规定一个**固定的**质数 $P$，以及模 $P$ 的一个原根 $g$。**$\\boldsymbol P$ 和 $\\boldsymbol g$ 的数值都是公开的，无需保密。**\n\n2. Alice 生成一个随机数 $a$，并计算 $A=g^a\\bmod P$，将 $A$ 通过不安全信道发送给 Bob。\n\n3. Bob 生成一个随机数 $b$，并计算 $B=g^b\\bmod P$，将 $B$ 通过不安全信道发送给 Alice。\n\n4. Bob 根据收到的 $A$ 计算出**密钥** $K=A^b \\bmod P$，而 Alice 根据收到的 $B$ 计算出 $K=B^a\\bmod P$。\n\n5. 双方得到了相同的 $K$，即 $g^{ab} \\bmod P$。$K$ 即之后通讯的加密密钥。\n\n可见，这个过程中可能被窃听的只有 $A,B$，而 $a,b,K$ 是保密的。并且根据 $A,B,P,g$ 这 $4$ 个数，不能轻易计算出 $K$，因此 $K$ 可以作为一个安全的密钥。\n\n当然安全是相对的，该协议的安全性取决于数值的大小，通常 $a,b,P$ 都选取数百位以上的大整数以避免被破解。然而如果 Alice 和 Bob 编程时偷懒，为了避免实现大数运算，选择的数值都小于 $2^{31}$，那么破解他们的密钥就比较容易了。\n\n$T$ 次给定窃听得到的 $A,B$，你需要尝试破解出**密钥** $K$。\n", "inputFormat": "输入文件第一行包含两个空格分开的正整数 $g$ 和 $P$。\n\n第二行为一个正整数 $n$，表示 Alice 和 Bob 共进行了 $n$ 次连接（即运行了 $n$ 次协议）。\n\n接下来 $n$ 行，每行包含两个空格分开的正整数 $A$ 和 $B$，表示某次连接中，被窃听的 $A,B$ 的数值。", "outputFormat": "输出包含 $n$ 行，每行 $1$ 个正整数 $K$，为每次连接你破解得到的密钥。", "hint": "对于 $30\\%$ 的数据，$2\\le A,B,P\\le 1000$；\n\n对于 $100\\%$ 的数据，$2\\le A,B<P<2^{31}，2\\le g<20，1\\le n\\le 20$。\n\n$\\text{Statement fixed by @Starrykiller.}$", "locale": "zh-CN"}}}
{"pid": "P4455", "type": "P", "difficulty": 6, "samples": [["4\n7\n2 1\n3 1\n1 3\n2 3\n3 2\n4 3\n4 2\n", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2018", "重庆", "各省省选", "矩阵树定理", "生成树", "向量", "构造", "行列式"], "title": "[CQOI2018] 社交网络", "background": "当今社会，在社交网络上看朋友的消息已经成为许多人生活的一部分。通常，一个用户在社交网络上发布一条消息后，他的好友们也可以看见这条消息，并可能转发。转发的消息还可以继续被人转发，进而扩散到整个社交网络中。", "description": "在一个实验性的小规模社交网络中我们发现，有时一条热门消息最终会被所有人转发。为了研究这一现象发生的过程，我们希望计算一条消息所有可能的转发途径有多少种。为了编程方便，我们将初始消息发送者编号为 $1$，其他用户编号依次递增。\n\n该社交网络上的所有好友关系是已知的，也就是说对于 $a, b$ 两个用户，我们知道 $a$ 用户可以看到 $b$ 用户发送的消息。注意可能存在单向的好友关系，即 $a$ 能看到 $b$ 的消息，但 $b$ 不能看到 $a$ 的消息。\n\n还有一个假设是，如果某用户看到他的多个好友转发了同一条消息，他只会选择从其中一个转发，最多转发一次消息。从不同好友的转发，被视为不同的情况。\n\n如果用箭头表示好友关系，下图展示了某个社交网络中消息转发的所有可能情况。（初始消息是用户 $1$ 发送的，加粗箭头表示一次消息转发）\n\n![](https://cdn.luogu.com.cn/upload/pic/17549.png)\n![](https://cdn.luogu.com.cn/upload/pic/17550.png)\n![](https://cdn.luogu.com.cn/upload/pic/17551.png)\n![](https://cdn.luogu.com.cn/upload/pic/17552.png)\n![](https://cdn.luogu.com.cn/upload/pic/17553.png)\n![](https://cdn.luogu.com.cn/upload/pic/17554.png)\n\n答案对 $10^4 + 7$ 取模。", "inputFormat": "第一行有一个整数，表示用户的数量 $n$。  \n第二行有一个整数，表示好友关系数目 $m$。  \n接下来 $m$ 行，每行两个整数 $a, b$，表示一组好友关系，即用户 $a$ 可以看到用户 $b$ 发送的信息。", "outputFormat": "输出一行一个整数表示答案对 $10^4 + 7$ 取模的结果。", "hint": "#### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，保证 $n \\leq 10$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 250$，$1 \\leq m \\leq n \\times (n - 1)$，$1 \\leq a, b \\leq n$。", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2018] Social Network", "background": "In today's society, checking friends' posts on social networks has become part of many people's lives. Usually, after a user posts a message on a social network, their friends can also see it and may forward it. The forwarded message can continue to be forwarded, spreading through the entire social network.", "description": "In a small experimental social network, we found that sometimes a popular message is eventually forwarded by everyone. To study how this happens, we want to compute how many possible forwarding paths there are for a single message. For convenience, we number the initial sender as user $1$, and number the other users in increasing order.\n\nAll friend relations on this social network are known. That is, for two users $a$ and $b$, we know that user $a$ can see messages sent by user $b$. Note that one-way friend relations may exist; that is, $a$ can see $b$'s messages, but $b$ cannot see $a$'s.\n\nAnother assumption is that if a user sees that multiple friends forwarded the same message, they will choose exactly one of them to forward from, and will forward at most once. Forwarding from different friends is considered different cases.\n\nIf we use arrows to represent friend relations, the figures below show all possible forwarding situations in a certain social network. (The initial message is sent by user $1$, and bold arrows indicate a single forwarding.)\n\n![](https://cdn.luogu.com.cn/upload/pic/17549.png)\n![](https://cdn.luogu.com.cn/upload/pic/17550.png)\n![](https://cdn.luogu.com.cn/upload/pic/17551.png)\n![](https://cdn.luogu.com.cn/upload/pic/17552.png)\n![](https://cdn.luogu.com.cn/upload/pic/17553.png)\n![](https://cdn.luogu.com.cn/upload/pic/17554.png)\n\nOutput the answer modulo $10^4 + 7$.", "inputFormat": "The first line contains an integer $n$, the number of users.  \nThe second line contains an integer $m$, the number of friend relations.  \nEach of the next $m$ lines contains two integers $a, b$, indicating a friend relation, i.e., user $a$ can see messages sent by user $b$.", "outputFormat": "Output a single line with one integer: the answer modulo $10^4 + 7$.", "hint": "Constraints:\n\n- For $30\\%$ of the testdata, $n \\leq 10$.\n- For $100\\%$ of the testdata, $1 \\leq n \\leq 250$, $1 \\leq m \\leq n \\times (n - 1)$, $1 \\leq a, b \\leq n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2018] 社交网络", "background": "当今社会，在社交网络上看朋友的消息已经成为许多人生活的一部分。通常，一个用户在社交网络上发布一条消息后，他的好友们也可以看见这条消息，并可能转发。转发的消息还可以继续被人转发，进而扩散到整个社交网络中。", "description": "在一个实验性的小规模社交网络中我们发现，有时一条热门消息最终会被所有人转发。为了研究这一现象发生的过程，我们希望计算一条消息所有可能的转发途径有多少种。为了编程方便，我们将初始消息发送者编号为 $1$，其他用户编号依次递增。\n\n该社交网络上的所有好友关系是已知的，也就是说对于 $a, b$ 两个用户，我们知道 $a$ 用户可以看到 $b$ 用户发送的消息。注意可能存在单向的好友关系，即 $a$ 能看到 $b$ 的消息，但 $b$ 不能看到 $a$ 的消息。\n\n还有一个假设是，如果某用户看到他的多个好友转发了同一条消息，他只会选择从其中一个转发，最多转发一次消息。从不同好友的转发，被视为不同的情况。\n\n如果用箭头表示好友关系，下图展示了某个社交网络中消息转发的所有可能情况。（初始消息是用户 $1$ 发送的，加粗箭头表示一次消息转发）\n\n![](https://cdn.luogu.com.cn/upload/pic/17549.png)\n![](https://cdn.luogu.com.cn/upload/pic/17550.png)\n![](https://cdn.luogu.com.cn/upload/pic/17551.png)\n![](https://cdn.luogu.com.cn/upload/pic/17552.png)\n![](https://cdn.luogu.com.cn/upload/pic/17553.png)\n![](https://cdn.luogu.com.cn/upload/pic/17554.png)\n\n答案对 $10^4 + 7$ 取模。", "inputFormat": "第一行有一个整数，表示用户的数量 $n$。  \n第二行有一个整数，表示好友关系数目 $m$。  \n接下来 $m$ 行，每行两个整数 $a, b$，表示一组好友关系，即用户 $a$ 可以看到用户 $b$ 发送的信息。", "outputFormat": "输出一行一个整数表示答案对 $10^4 + 7$ 取模的结果。", "hint": "#### 数据规模与约定\n\n- 对于 $30\\%$ 的数据，保证 $n \\leq 10$。\n- 对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 250$，$1 \\leq m \\leq n \\times (n - 1)$，$1 \\leq a, b \\leq n$。", "locale": "zh-CN"}}}
{"pid": "P4456", "type": "P", "difficulty": 5, "samples": [["3 1 2 1009", "10"], ["4 3 2 1009", "204"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "2018", "重庆", "各省省选", "矩阵加速", "二项式定理", "矩阵乘法"], "title": "[CQOI2018] 交错序列", "background": null, "description": "我们称一个仅由 $0,1$ 构成的序列为“交错序列”，当且仅当序列中没有相邻的 $1$（可以有相邻的 $0$）。例如，`000`、`001`、`101` 都是交错序列，而 `110` 则不是。\n\n对于一个长度为 $n$ 的交错序列，统计其中 $0$ 和 $1$ 出现的次数，分别记为 $x$ 和 $y$。给定参数 $a,b$，定义一个交错序列的特征值为 $x^ay^b$。注意这里规定任何整数的 $0$ 次幂都等于 $1$（包括 $0^0=1$）。\n\n显然长度为 $n$ 的交错序列可能有多个。我们想要知道，所有长度为 $n$ 的交错序列的特征值的和除以 $m$ 的余数（$m$ 是一个给定的质数）。\n\n例如，全部长度为 $3$ 的交错串为：`000`、`001`、`010`、`100`、`101`。当 $a=1,b=2$ 时，可计算：$3^1\\times0^2+2^1\\times1^2+2^1\\times1^2+2^1\\times1^2+1^1\\times2^2=10$。", "inputFormat": "输入文件共一行，包含三个空格分开的整数 $n,a,b,m$。", "outputFormat": "输出文件共一行，为计算结果 $\\bmod{m}$ 的值。", "hint": "对于 $30\\%$ 的数据，$1 \\le n\\le 15$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^7$，$1 \\le a,b \\le 45$，$10^7 \\le m < 10^8$。", "locale": "zh-CN", "translations": {"en": {"title": "[CQOI2018] Alternating Sequence", "background": "", "description": "We call a sequence consisting only of $0,1$ an \"alternating sequence\" if and only if there are no adjacent $1$'s (adjacent $0$'s are allowed). For example, `000`, `001`, `101` are alternating sequences, while `110` is not.\n\nFor an alternating sequence of length $n$, let the counts of $0$ and $1$ be $x$ and $y$, respectively. Given parameters $a,b$, define the characteristic value of a sequence as $x^a y^b$. Note that any integer to the $0$-th power equals $1$ (including $0^0 = 1$).\n\nObviously there may be multiple alternating sequences of length $n$. We want to know the remainder modulo $m$ (where $m$ is a given prime) of the sum of characteristic values over all alternating sequences of length $n$.\n\nFor example, all alternating sequences of length $3$ are: `000`, `001`, `010`, `100`, `101`. When $a = 1, b = 2$, we can compute: $3^1 \\times 0^2 + 2^1 \\times 1^2 + 2^1 \\times 1^2 + 2^1 \\times 1^2 + 1^1 \\times 2^2 = 10$.", "inputFormat": "The input contains one line with four space-separated integers $n,a,b,m$.", "outputFormat": "Output one line containing the result $\\bmod m$.", "hint": "For $30\\%$ of the testdata, $1 \\le n \\le 15$.\n\nFor $100\\%$ of the testdata, $1 \\le n \\le 10^7$, $1 \\le a,b \\le 45$, $10^7 \\le m < 10^8$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CQOI2018] 交错序列", "background": null, "description": "我们称一个仅由 $0,1$ 构成的序列为“交错序列”，当且仅当序列中没有相邻的 $1$（可以有相邻的 $0$）。例如，`000`、`001`、`101` 都是交错序列，而 `110` 则不是。\n\n对于一个长度为 $n$ 的交错序列，统计其中 $0$ 和 $1$ 出现的次数，分别记为 $x$ 和 $y$。给定参数 $a,b$，定义一个交错序列的特征值为 $x^ay^b$。注意这里规定任何整数的 $0$ 次幂都等于 $1$（包括 $0^0=1$）。\n\n显然长度为 $n$ 的交错序列可能有多个。我们想要知道，所有长度为 $n$ 的交错序列的特征值的和除以 $m$ 的余数（$m$ 是一个给定的质数）。\n\n例如，全部长度为 $3$ 的交错串为：`000`、`001`、`010`、`100`、`101`。当 $a=1,b=2$ 时，可计算：$3^1\\times0^2+2^1\\times1^2+2^1\\times1^2+2^1\\times1^2+1^1\\times2^2=10$。", "inputFormat": "输入文件共一行，包含三个空格分开的整数 $n,a,b,m$。", "outputFormat": "输出文件共一行，为计算结果 $\\bmod{m}$ 的值。", "hint": "对于 $30\\%$ 的数据，$1 \\le n\\le 15$。\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^7$，$1 \\le a,b \\le 45$，$10^7 \\le m < 10^8$。", "locale": "zh-CN"}}}
{"pid": "P4457", "type": "P", "difficulty": 7, "samples": [["2\n2 1 1 1\n2 2 1 1", "6\n8"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["递推", "2018", "各省省选", "北京", "O2优化", "期望", "高斯消元"], "title": "[BJOI2018] 治疗之雨", "background": "（没玩过《炉石传说》的人可以跳过这一段）今天我们来探讨下《炉石传说》中“治疗之雨”（恢复 $12$ 点生命值，随机分配到所有友方角色上）和“暗影打击装甲”（每当一个角色获得治疗，便对随机敌人造成 $1$点伤害）这两张卡牌之间的互动效果。假设你场上有 $m$个剩余生命值无限大且生命值上限减去剩余生命值也无限大的随从，而对方的场上有 $k$个暗影打击装甲，你的英雄剩余生命值为 $p$、生命值上限为 $n$，现在你使用了一张可以恢复无限多（而不是 $12$ 点）生命值的治疗之雨，问治疗之雨期望总共恢复了几点生命值以后你的英雄会死亡（生命值降为 $0$；治疗之雨的判定机制使得在此后再也不会为英雄恢复生命值）。\n\n注：题目背景与题目描述有冲突的地方请以题目描述为准\n\n下面让我们再形式化地描述一遍问题。", "description": "**题目更新：鉴于很多人反映看不懂题，但是出于尊重原题面的原则不进行大幅度更改。您可以将最小值和最大值理解为下限和上限，类似于题目背景中的血量。**\n\n\n你现在有 $m+1$ 个数：第一个为 $p$，最小值为 $0$，最大值为 $n$；剩下 $m$个都是无穷，没有最小值或最大值。你可以进行任意多轮操作，每轮操作如下：\n\n在不为最大值的数中等概率随机选择一个（如果没有则不操作），把它加一；\n\n进行 $k$次这个步骤：在不为最小值的数中等概率随机选择一个（如果没有则不操作），把它减一。 \n\n现在问期望进行多少轮操作以后第一个数会变为最小值 $0$。", "inputFormat": "输入包含多组数据。\n输入第一行包含一个正整数 $T$，表示数据组数。\n接下来 $T$行 ，每行 4个非负整数 $n$、$p$、$m$、$k$（含义见题目描述），表示一次询问。", "outputFormat": "输出 $T$行，每行一个整数，表示一次询问的答案。\n\n如果无论进行多少轮操作，第一个数都不会变为最小值 $0$，那么输出```-1```；\n\n否则，可以证明答案一定为有理数，那么请输出答案模 $10^9+7$ 的余数，即设答案为 $\\frac{a}{b}$（$a$、$b$为互质的正整数 ），你输出的整数为 $x$，那么你需要保证 $0 \\leq x < 10^9+7$ 且 $a \\equiv bx (\\mod 10^9+7)$。", "hint": "###数据范围\n\n对于 $10\\%$ 的数据， $n \\leq 3$ ，$m, k \\leq 2$ 。\n\n对于 $20\\%$ 的数据， $n, m, k \\leq 5$ 。\n\n对于 $30\\%$ 的数据， $n, m, k \\leq 30$ 。\n\n对于 $40\\%$ 的数据， $n, m, k \\leq 50$ 。\n\n对于 $50\\%$ 的数据， $n, m, k \\leq 200$ 。\n\n对于 $70\\%$ 的数据， $n \\leq 200$ 。\n\n对于 $80\\%$ 的数据， $n \\leq 500$ 。\n\n对于 $100\\%$ 的数据， $1 \\leq T \\leq 100$，$1 \\leq p \\leq n \\leq 1500$ ，$0 \\leq m, k \\leq 10^9$。\n\n保证不存在 $n=p=k=1$, $m=0$ 的情况（因为出题人判错了）\n\n保证不存在答案的分母是 $10^9+7$ 的倍数的情况（因为出题人没想到）", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2018] Healing Rain", "background": "(Players who have not played Hearthstone can skip this paragraph.) Today we discuss the interaction between “Healing Rain” (restore $12$ Health, randomly distributed among all friendly characters) and “Shadowstrike Armor” (whenever a character is healed, deal $1$ damage to a random enemy). Suppose you have $m$ minions on your side with infinite remaining Health and infinite missing Health (i.e., no upper or lower bounds), and your opponent has $k$ copies of Shadowstrike Armor on the board. Your hero has current Health $p$ and maximum Health $n$. Now you cast a Healing Rain that can restore infinitely many Health (instead of $12$). What is the expected total amount of Health restored by Healing Rain before your hero dies (Health drops to $0$; due to Healing Rain’s targeting rules, the hero will no longer be healed afterward).\n\nNote: If the background conflicts with the problem statement, follow the problem statement.\n\nBelow is the formal description of the problem.", "description": "Problem update: Since many people reported difficulty understanding the statement, but to respect the original wording we will not make large changes. You may interpret “minimum” and “maximum” as lower bound and upper bound, similar to the Health in the background.\n\nYou now have $m+1$ numbers: the first is $p$, with minimum $0$ and maximum $n$; the remaining $m$ are all infinite, with no minimum or maximum. You may perform any number of rounds. In each round, do the following:\n\n- Uniformly at random choose one number among those that are not at their maximum (if none, do nothing), and add $1$ to it.\n- Then perform this step $k$ times: uniformly at random choose one number among those that are not at their minimum (if none, do nothing), and subtract $1$ from it.\n\nWhat is the expected number of rounds until the first number becomes its minimum $0$.", "inputFormat": "The input contains multiple test cases.\nThe first line contains a positive integer $T$, the number of test cases.\nThe next $T$ lines each contain four non-negative integers $n$, $p$, $m$, $k$ (as defined above), representing one query.", "outputFormat": "Output $T$ lines, each with one integer, the answer for that query.\n\nIf the first number never becomes the minimum $0$ no matter how many rounds, output ```-1```.\n\nOtherwise, it can be proved that the answer is a rational number. Output the answer modulo $10^9+7$, i.e., suppose the answer is $\\frac{a}{b}$ (where $a$ and $b$ are coprime positive integers). You must output an integer $x$ such that $0 \\le x < 10^9+7$ and $a \\equiv b x \\pmod{10^9+7}$.", "hint": "### Constraints\n\n- For $10\\%$ of the testdata, $n \\le 3$, $m, k \\le 2$.\n- For $20\\%$ of the testdata, $n, m, k \\le 5$.\n- For $30\\%$ of the testdata, $n, m, k \\le 30$.\n- For $40\\%$ of the testdata, $n, m, k \\le 50$.\n- For $50\\%$ of the testdata, $n, m, k \\le 200$.\n- For $70\\%$ of the testdata, $n \\le 200$.\n- For $80\\%$ of the testdata, $n \\le 500$.\n- For $100\\%$ of the testdata, $1 \\le T \\le 100$, $1 \\le p \\le n \\le 1500$, $0 \\le m, k \\le 10^9$.\n\nIt is guaranteed that the case $n = p = k = 1$, $m = 0$ does not exist (because the author judged it wrong).\n\nIt is guaranteed that the denominator of the answer is not a multiple of $10^9+7$ (because the author did not think of it).\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2018] 治疗之雨", "background": "（没玩过《炉石传说》的人可以跳过这一段）今天我们来探讨下《炉石传说》中“治疗之雨”（恢复 $12$ 点生命值，随机分配到所有友方角色上）和“暗影打击装甲”（每当一个角色获得治疗，便对随机敌人造成 $1$点伤害）这两张卡牌之间的互动效果。假设你场上有 $m$个剩余生命值无限大且生命值上限减去剩余生命值也无限大的随从，而对方的场上有 $k$个暗影打击装甲，你的英雄剩余生命值为 $p$、生命值上限为 $n$，现在你使用了一张可以恢复无限多（而不是 $12$ 点）生命值的治疗之雨，问治疗之雨期望总共恢复了几点生命值以后你的英雄会死亡（生命值降为 $0$；治疗之雨的判定机制使得在此后再也不会为英雄恢复生命值）。\n\n注：题目背景与题目描述有冲突的地方请以题目描述为准\n\n下面让我们再形式化地描述一遍问题。", "description": "**题目更新：鉴于很多人反映看不懂题，但是出于尊重原题面的原则不进行大幅度更改。您可以将最小值和最大值理解为下限和上限，类似于题目背景中的血量。**\n\n\n你现在有 $m+1$ 个数：第一个为 $p$，最小值为 $0$，最大值为 $n$；剩下 $m$个都是无穷，没有最小值或最大值。你可以进行任意多轮操作，每轮操作如下：\n\n在不为最大值的数中等概率随机选择一个（如果没有则不操作），把它加一；\n\n进行 $k$次这个步骤：在不为最小值的数中等概率随机选择一个（如果没有则不操作），把它减一。 \n\n现在问期望进行多少轮操作以后第一个数会变为最小值 $0$。", "inputFormat": "输入包含多组数据。\n输入第一行包含一个正整数 $T$，表示数据组数。\n接下来 $T$行 ，每行 4个非负整数 $n$、$p$、$m$、$k$（含义见题目描述），表示一次询问。", "outputFormat": "输出 $T$行，每行一个整数，表示一次询问的答案。\n\n如果无论进行多少轮操作，第一个数都不会变为最小值 $0$，那么输出```-1```；\n\n否则，可以证明答案一定为有理数，那么请输出答案模 $10^9+7$ 的余数，即设答案为 $\\frac{a}{b}$（$a$、$b$为互质的正整数 ），你输出的整数为 $x$，那么你需要保证 $0 \\leq x < 10^9+7$ 且 $a \\equiv bx (\\mod 10^9+7)$。", "hint": "###数据范围\n\n对于 $10\\%$ 的数据， $n \\leq 3$ ，$m, k \\leq 2$ 。\n\n对于 $20\\%$ 的数据， $n, m, k \\leq 5$ 。\n\n对于 $30\\%$ 的数据， $n, m, k \\leq 30$ 。\n\n对于 $40\\%$ 的数据， $n, m, k \\leq 50$ 。\n\n对于 $50\\%$ 的数据， $n, m, k \\leq 200$ 。\n\n对于 $70\\%$ 的数据， $n \\leq 200$ 。\n\n对于 $80\\%$ 的数据， $n \\leq 500$ 。\n\n对于 $100\\%$ 的数据， $1 \\leq T \\leq 100$，$1 \\leq p \\leq n \\leq 1500$ ，$0 \\leq m, k \\leq 10^9$。\n\n保证不存在 $n=p=k=1$, $m=0$ 的情况（因为出题人判错了）\n\n保证不存在答案的分母是 $10^9+7$ 的倍数的情况（因为出题人没想到）", "locale": "zh-CN"}}}
{"pid": "P4458", "type": "P", "difficulty": 6, "samples": [["5 5\n1 1 1 1 1\n2 5 5\n2 1 2\n1 1 2 2\n2 1 1\n1 1 5 3", "5\n13\n9"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2018", "线段树", "各省省选", "北京", "枚举", "前缀和", "差分"], "title": "[BJOI2018] 链上二次求和", "background": "", "description": "有一条长度为 $n$ 的链（ $\\forall 1 \\leq i < n$ ，点 $i$ 与点 $i+1$ 之间有一条边的无向图）， 每个点有一个整数权值，第 $i$ 个点的权值是 $a_i$ 。现在有 $m$ 个操作，每个操作如下：\n\n操作 1（修改）：给定链上两个节点 $u,v$ 和一个整数 $d$，表示将链上 $u$ 到 $v$ 唯一的简单路径上每个点权值都加上 $d$。\n\n操作 2（询问）：给定两个正整数 $l,r$，表示求链上所有节点个数大于等于 $l$ 且小于等于 $r$ 的简单路径节点权值和之和。由于答案很大，只用输出对质数 $1000000007$ 取模的结果即可。\n\n一条节点个数为 $k$ 的简单路径节点权值和为这条上所有 $k$ 个节点（包括端点）的权值之和，而本题中要求是对所有满足要求的简单路径，求这一权值和的和。\n\n由于是无向图，路径也是无向的，即点 $1$ 到点 $2$ 的路径与点 $2$ 到点 $1$ 的路径是同一条，不要重复计算。", "inputFormat": "输入第一行包含两个正整数 $n,m$，分别表示节点个数和操作次数。\n\n第二行包含 $n$ 个整数，其中第 $i$ 个数 $a_i$ 为第 $i$ 个点的初始权值。\n\n接下来 $m$ 行，每行为 ```1 u v d```或 ```2 l r```的形式，分别表示进行一次操作 1（修改）或操作 2（询问）。 ", "outputFormat": "对于每次询问，输出一行一个整数，表示答案对 $1000000007$ 取模的余数。", "hint": "### 样例解释：\n节点个数为 $5$ 的简单路径只有 $1$ 条，权值和为 $5$，故第1次询问输出 $5$。\n\n节点个数为 $1$ 的简单路径有 $5$ 条，每条权值和都是 $1$；节点个数为 $2$ 的简单路径有 $4$ 条，每条权值和都是 $2$，故第2次询问输出 $13 $。\n\n在将点 $1$ 和点 $2$ 的权值加 $2$ 后， $5$ 条节点个数为 $1$ 的简单路径权值和分别为 $3$、$3$、$1$、$1$、$1$，故第 3 次询问输出 $9$。\n\n### 数据范围：\n记操作 1（修改）的次数为 $m^\\prime$。\n\n对于全部数据， 保证 $n \\leq 200000$，$m \\leq 500000$，$ m^\\prime \\leq 100000$，$ 0 \\leq a_i < 1000000007$。\n\n$1 \\leq u \\leq n$，$ 1\\leq v \\leq n$，$ 0 \\leq d < 1000000007$，$l \\leq r \\leq n$。\n\n对于每个数据点的详细规模与约定见下表。\n\n![pic](https://cdn.luogu.com.cn/upload/pic/17580.png)", "locale": "zh-CN", "translations": {"en": {"title": "[BJOI2018] Quadratic Sum on a Chain", "background": "", "description": "There is a chain of length $n$ (an undirected graph where $\\forall 1 \\leq i < n$, there is an edge between node $i$ and node $i+1$). Each node has an integer weight; the weight of the $i$-th node is $a_i$. There are $m$ operations, each as follows:\n\nOperation 1 (modify): Given two nodes $u, v$ on the chain and an integer $d$, add $d$ to the weight of every node on the unique simple path from $u$ to $v$ on the chain.\n\nOperation 2 (query): Given two positive integers $l, r$, compute the sum of node-weight sums over all simple paths whose number of nodes is at least $l$ and at most $r$. Since the answer can be very large, output the result modulo the prime $1000000007$.\n\nThe node-weight sum of a simple path with $k$ nodes is the sum of the weights of all $k$ nodes (including endpoints) on that path. In this problem, you need to compute the sum of this value over all simple paths that meet the requirement.\n\nSince the graph is undirected, paths are undirected as well; that is, the path from node $1$ to node $2$ is the same as the path from node $2$ to node $1$, so do not double count.", "inputFormat": "The first line contains two positive integers $n, m$, denoting the number of nodes and the number of operations.\n\nThe second line contains $n$ integers; the $i$-th number $a_i$ is the initial weight of the $i$-th node.\n\nEach of the next $m$ lines is in the form ```1 u v d``` or ```2 l r```, indicating an Operation 1 (modify) or Operation 2 (query), respectively.", "outputFormat": "For each query, output one line with one integer, which is the answer modulo $1000000007$.", "hint": "### Sample Explanation:\nThere is exactly $1$ simple path with $5$ nodes, and its node-weight sum is $5$, so the first query outputs $5$.\n\nThere are $5$ simple paths with $1$ node, each with node-weight sum $1$; there are $4$ simple paths with $2$ nodes, each with node-weight sum $2$, so the second query outputs $13$.\n\nAfter adding $2$ to the weights of nodes $1$ and $2$, the $5$ simple paths with $1$ node have node-weight sums $3$, $3$, $1$, $1$, $1$, so the third query outputs $9$.\n\n### Constraints:\nLet the number of Operation 1 (modify) be $m^\\prime$.\n\nFor all testdata, it is guaranteed that $n \\leq 200000$, $m \\leq 500000$, $m^\\prime \\leq 100000$, $0 \\leq a_i < 1000000007$.\n\n$1 \\leq u \\leq n$, $1 \\leq v \\leq n$, $0 \\leq d < 1000000007$, $l \\leq r \\leq n$.\n\nFor the detailed scale and conventions of each test point, see the table below.\n\n![pic](https://cdn.luogu.com.cn/upload/pic/17580.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[BJOI2018] 链上二次求和", "background": "", "description": "有一条长度为 $n$ 的链（ $\\forall 1 \\leq i < n$ ，点 $i$ 与点 $i+1$ 之间有一条边的无向图）， 每个点有一个整数权值，第 $i$ 个点的权值是 $a_i$ 。现在有 $m$ 个操作，每个操作如下：\n\n操作 1（修改）：给定链上两个节点 $u,v$ 和一个整数 $d$，表示将链上 $u$ 到 $v$ 唯一的简单路径上每个点权值都加上 $d$。\n\n操作 2（询问）：给定两个正整数 $l,r$，表示求链上所有节点个数大于等于 $l$ 且小于等于 $r$ 的简单路径节点权值和之和。由于答案很大，只用输出对质数 $1000000007$ 取模的结果即可。\n\n一条节点个数为 $k$ 的简单路径节点权值和为这条上所有 $k$ 个节点（包括端点）的权值之和，而本题中要求是对所有满足要求的简单路径，求这一权值和的和。\n\n由于是无向图，路径也是无向的，即点 $1$ 到点 $2$ 的路径与点 $2$ 到点 $1$ 的路径是同一条，不要重复计算。", "inputFormat": "输入第一行包含两个正整数 $n,m$，分别表示节点个数和操作次数。\n\n第二行包含 $n$ 个整数，其中第 $i$ 个数 $a_i$ 为第 $i$ 个点的初始权值。\n\n接下来 $m$ 行，每行为 ```1 u v d```或 ```2 l r```的形式，分别表示进行一次操作 1（修改）或操作 2（询问）。 ", "outputFormat": "对于每次询问，输出一行一个整数，表示答案对 $1000000007$ 取模的余数。", "hint": "### 样例解释：\n节点个数为 $5$ 的简单路径只有 $1$ 条，权值和为 $5$，故第1次询问输出 $5$。\n\n节点个数为 $1$ 的简单路径有 $5$ 条，每条权值和都是 $1$；节点个数为 $2$ 的简单路径有 $4$ 条，每条权值和都是 $2$，故第2次询问输出 $13 $。\n\n在将点 $1$ 和点 $2$ 的权值加 $2$ 后， $5$ 条节点个数为 $1$ 的简单路径权值和分别为 $3$、$3$、$1$、$1$、$1$，故第 3 次询问输出 $9$。\n\n### 数据范围：\n记操作 1（修改）的次数为 $m^\\prime$。\n\n对于全部数据， 保证 $n \\leq 200000$，$m \\leq 500000$，$ m^\\prime \\leq 100000$，$ 0 \\leq a_i < 1000000007$。\n\n$1 \\leq u \\leq n$，$ 1\\leq v \\leq n$，$ 0 \\leq d < 1000000007$，$l \\leq r \\leq n$。\n\n对于每个数据点的详细规模与约定见下表。\n\n![pic](https://cdn.luogu.com.cn/upload/pic/17580.png)", "locale": "zh-CN"}}}
