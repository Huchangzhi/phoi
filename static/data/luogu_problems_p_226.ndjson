{"pid": "P5571", "type": "P", "difficulty": 6, "samples": [["4 3\n2 3\n3 4\n4 3\n3 1", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 2000, 2000, 2000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["计算几何"], "title": "[CmdOI2019] 高塔与晶石", "background": "**温馨提示 : 请注意常数因子对程序效率带来的影响 + 本题特殊的空间限制**\n\n几何王国之中，矗立着$n$座古老的高塔，传说，它们是这片净土的守护者。\n\n随着几何学日新月异的发展，王国的繁荣引来了烈炎深处的恐怖：动点P。\n\n驯服动点恶龙的英雄笛卡尔尚未出现，几何王国的领主决定固守静态几何的阵地。\n\n", "description": "他得到了静态几何的三颗智慧晶石(里面当然是神级数学题啦)，并且可以把它们安放在高塔之中。\n\n三颗安放着晶石的高塔，可以保护其围成的三角形内部不受侵入。\n\n但是，如果晶石围成的三角型面积太大，防线将会十分容易被击破。\n\n如果三角型面积太小，其中能够产生的几何能量又不足以维持晶石的运作。\n\n经过几天的推算，领主在认为， $\\binom{n}{3}$ 种做法中,面积第 $k$ **小**的方案是最合适的。\n\n(三角形面积可以为 $0$)\n\n他对这个结果很不放心，于是拜托单手虐爆无数几何题的你,来帮他计算这个面积具体是多少。", "inputFormat": "第一行两个整数$n,k$，意义如题目所述。\n\n后 $n$ 行，第 $i$ 行有两个数 $x_i,y_i$ ，表示 $i$ 号高塔的坐标。", "outputFormat": "输出面积第 $k$ **小**方案对应面积的**2倍**，容易证明这一定是个整数。", "hint": "| subtask编号 | 　n　 | 备注 | 分值 | 时限 |\n| :--: | :--: | :--: | :--: | :--: |\n| 1 | 200 | - | 15 | 1S |\n| 2 | 500 | $k\\leq10$ | 20 | 1S |\n| 3 | 500 | $k\\leq10000$ | 15 | 1S |\n| 4 | 800 | - | 50 | 2S |\n\n$1\\leq x_i,y_i \\leq 10^6$ , 所有坐标都是正整数 , 高塔的坐标不会重复。\n\n**样例解释:**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/y3is3hxv.png)", "locale": "zh-CN", "translations": {"en": {"title": "[CmdOI2019] Towers and Crystals", "background": "**Warm reminder: Please pay attention to the impact of constant factors on program efficiency + the special memory limit of this problem.**\n\nIn the Kingdom of Geometry, there stand $n$ ancient towers. Legend says they are the guardians of this pure land.\n\nAs geometry develops rapidly day by day, the kingdom’s prosperity attracts a terror from the depths of blazing flames: the moving point $P$.\n\nBefore the hero Descartes, who can tame the “moving-point dragon,” appears, the lord of the Kingdom of Geometry decides to hold the line in the field of static geometry.", "description": "He obtained three “wisdom crystals” of static geometry (of course, they contain god-level math problems), and he can place them into the towers.\n\nThree towers with crystals placed can protect the interior of the triangle they form from invasion.\n\nHowever, if the area of the triangle formed by the crystals is too large, the defense line will be very easy to break.\n\nIf the area of the triangle is too small, the geometric energy generated inside will not be enough to keep the crystals running.\n\nAfter several days of calculation, the lord believes that among the $\\binom{n}{3}$ possible choices, the plan with the $k$-th **smallest** area is the most suitable.\n\n(The triangle area can be $0$.)\n\nHe is still not confident about this result, so he asks you—who can crush countless geometry problems with one hand—to help him compute the exact value of this area.", "inputFormat": "The first line contains two integers $n,k$, with the meanings as described in the statement.\n\nThe next $n$ lines: the $i$-th line contains two numbers $x_i,y_i$, representing the coordinates of tower $i$.", "outputFormat": "Output **twice** the area corresponding to the plan with the $k$-th **smallest** area. It is easy to prove that this must be an integer.", "hint": "| subtask ID | 　n　 | Notes | Score | Time Limit |\n| :--: | :--: | :--: | :--: | :--: |\n| 1 | 200 | - | 15 | 1S |\n| 2 | 500 | $k\\leq10$ | 20 | 1S |\n| 3 | 500 | $k\\leq10000$ | 15 | 1S |\n| 4 | 800 | - | 50 | 2S |\n\nConstraints: $1\\leq x_i,y_i \\leq 10^6$, all coordinates are positive integers, and no two towers share the same coordinates.\n\n**Sample explanation:**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/y3is3hxv.png)\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CmdOI2019] 高塔与晶石", "background": "**温馨提示 : 请注意常数因子对程序效率带来的影响 + 本题特殊的空间限制**\n\n几何王国之中，矗立着$n$座古老的高塔，传说，它们是这片净土的守护者。\n\n随着几何学日新月异的发展，王国的繁荣引来了烈炎深处的恐怖：动点P。\n\n驯服动点恶龙的英雄笛卡尔尚未出现，几何王国的领主决定固守静态几何的阵地。\n\n", "description": "他得到了静态几何的三颗智慧晶石(里面当然是神级数学题啦)，并且可以把它们安放在高塔之中。\n\n三颗安放着晶石的高塔，可以保护其围成的三角形内部不受侵入。\n\n但是，如果晶石围成的三角型面积太大，防线将会十分容易被击破。\n\n如果三角型面积太小，其中能够产生的几何能量又不足以维持晶石的运作。\n\n经过几天的推算，领主在认为， $\\binom{n}{3}$ 种做法中,面积第 $k$ **小**的方案是最合适的。\n\n(三角形面积可以为 $0$)\n\n他对这个结果很不放心，于是拜托单手虐爆无数几何题的你,来帮他计算这个面积具体是多少。", "inputFormat": "第一行两个整数$n,k$，意义如题目所述。\n\n后 $n$ 行，第 $i$ 行有两个数 $x_i,y_i$ ，表示 $i$ 号高塔的坐标。", "outputFormat": "输出面积第 $k$ **小**方案对应面积的**2倍**，容易证明这一定是个整数。", "hint": "| subtask编号 | 　n　 | 备注 | 分值 | 时限 |\n| :--: | :--: | :--: | :--: | :--: |\n| 1 | 200 | - | 15 | 1S |\n| 2 | 500 | $k\\leq10$ | 20 | 1S |\n| 3 | 500 | $k\\leq10000$ | 15 | 1S |\n| 4 | 800 | - | 50 | 2S |\n\n$1\\leq x_i,y_i \\leq 10^6$ , 所有坐标都是正整数 , 高塔的坐标不会重复。\n\n**样例解释:**\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/y3is3hxv.png)", "locale": "zh-CN"}}}
{"pid": "P5572", "type": "P", "difficulty": 7, "samples": [["5\n10 10\n20 20\n30 30\n40 40\n50 50\n", "768\n13312\n16218\n7160\n9031"], ["3\n5 4\n20 15\n100 88", "52\n7572\n21475"]], "limits": {"time": [1000, 1000, 1000, 1000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "数论", "莫比乌斯反演", "分块", "根号分治", "整除分块", "欧拉函数"], "title": "[CmdOI2019] 简单的数论题", "background": "", "description": "给出 $n,m$ 求下列式子的值 ：\n\n$$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m \\varphi\\left(\\dfrac{{\\rm lcm}(i,j)}{\\gcd(i,j)}\\right) \\bmod 23333$$", "inputFormat": "第一行一个整数 $T$，表示询问数。\n\n后 $T$ 行每行两个整数 $n,m$ ,表示一个询问。", "outputFormat": "对于每个询问，输出一行一个整数，表示答案。", "hint": "对于所有测试点， $T\\leq 3\\times 10^4,\\ m\\leq n\\leq 5\\times 10^4$。\n\n| 测试点编号 | $n,m\\leq $ | $T$ | 时限 | 特殊性质 | \n| :--: | :--: | :--: | :--: | :--: |\n| #1~2 | $100$ | $100$ | $\\texttt{1s}$ |  |\n| #3~4 | $2000$ | $3\\times 10^4$ | $\\texttt{1s}$ |  |\n| #5~6 | $3\\times 10^4$ | $5000$ | $\\texttt{2s}$ |  |\n| #7~8 | $5\\times 10^4$ | $3\\times 10^4$ | $\\texttt{2s}$ | $n=m$ |\n| #9~10 | $5\\times 10^4$ | $3\\times 10^4$ | $\\texttt{2s}$ |  |", "locale": "zh-CN", "translations": {"en": {"title": "[CmdOI2019] Simple Number Theory Problem", "background": "", "description": "Given $n,m$, find the value of the following expression:\n\n$$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m \\varphi\\left(\\dfrac{{\\rm lcm}(i,j)}{\\gcd(i,j)}\\right) \\bmod 23333$$", "inputFormat": "The first line contains an integer $T$, which denotes the number of queries.\n\nThe next $T$ lines each contain two integers $n,m$, representing one query.", "outputFormat": "For each query, output one integer per line, which is the answer.", "hint": "For all test cases, $T\\leq 3\\times 10^4,\\ m\\leq n\\leq 5\\times 10^4$.\n\n| Test Point ID | $n,m\\leq$ | $T$ | Time Limit | Special Property |\n| :--: | :--: | :--: | :--: | :--: |\n| #1~2 | $100$ | $100$ | $\\texttt{1s}$ |  |\n| #3~4 | $2000$ | $3\\times 10^4$ | $\\texttt{1s}$ |  |\n| #5~6 | $3\\times 10^4$ | $5000$ | $\\texttt{2s}$ |  |\n| #7~8 | $5\\times 10^4$ | $3\\times 10^4$ | $\\texttt{2s}$ | $n=m$ |\n| #9~10 | $5\\times 10^4$ | $3\\times 10^4$ | $\\texttt{2s}$ |  |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CmdOI2019] 简单的数论题", "background": "", "description": "给出 $n,m$ 求下列式子的值 ：\n\n$$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m \\varphi\\left(\\dfrac{{\\rm lcm}(i,j)}{\\gcd(i,j)}\\right) \\bmod 23333$$", "inputFormat": "第一行一个整数 $T$，表示询问数。\n\n后 $T$ 行每行两个整数 $n,m$ ,表示一个询问。", "outputFormat": "对于每个询问，输出一行一个整数，表示答案。", "hint": "对于所有测试点， $T\\leq 3\\times 10^4,\\ m\\leq n\\leq 5\\times 10^4$。\n\n| 测试点编号 | $n,m\\leq $ | $T$ | 时限 | 特殊性质 | \n| :--: | :--: | :--: | :--: | :--: |\n| #1~2 | $100$ | $100$ | $\\texttt{1s}$ |  |\n| #3~4 | $2000$ | $3\\times 10^4$ | $\\texttt{1s}$ |  |\n| #5~6 | $3\\times 10^4$ | $5000$ | $\\texttt{2s}$ |  |\n| #7~8 | $5\\times 10^4$ | $3\\times 10^4$ | $\\texttt{2s}$ | $n=m$ |\n| #9~10 | $5\\times 10^4$ | $3\\times 10^4$ | $\\texttt{2s}$ |  |", "locale": "zh-CN"}}}
{"pid": "P5573", "type": "P", "difficulty": 7, "samples": [["3 3\n1 2 3\n3 2 1\n4 2 2\n5 1 2 2 3 3\n3 3 3 3 3 3\n6 3 5 2 3 1", "2\n2\n1"], ["10 10\n43 24 8 66 96 25 43 87 62 8 \n80 25 94 72 43 18 94 96 11 54 \n19 25 92 87 76 36 89 91 69 22 \n82 2 82 5 82 3\n70 10 96 8 70 8\n52 7 23 5 52 10\n85 1 62 4 85 5\n1 5 49 7 1 6\n32 7 54 8 32 9\n6 1 89 4 6 10\n82 10 38 5 82 7\n87 2 1 10 87 2\n12 3 77 5 12 8", "10\n7\n0\n5\n0\n1\n1\n5\n1\n1"]], "limits": {"time": [1000, 1000, 1000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["生成树", "字典树 Trie"], "title": "[CmdOI2019] 星际kfc篮球赛", "background": "公元 $3100$ 年，地球联盟的银河系内 $N$ 个星球已经完成了道路大建设，从原来的 $N-1$ 条双向时空隧道变成了**无向完全图**。\n\nLouis Paosen 是一个星际旅行家，上次你~~虐队的时候~~顺便帮他解决了难题，于是他又来请求你帮忙啦。", "description": "仍然是出于资金的考虑，地球联盟没能将所有的道路都建造得尽善尽美。通过某条道路**对于飞船的性能有一定的要求**。\n\nLouis Paosen 在联盟内举办了盛大的 kfc 三人篮球赛，一时间，许多来自不同星球的选手纷纷赶来参赛。\n\n整个地球联盟的内部正在热卖三种飞船 (A/B/C 类)，由于收了广告费的缘故，组队的时候要求 $3$ 人中第一人使用 A，第二人使用 B，第三人使用 C (这样可以获得加分)。\n\n现在有许许多多个三人小组准备参赛，他们准备好了飞船(符合加分条件)，但是他们可能来自不同的星球，由于飞船性能的限制，他们可能无法一起到达某个星球。\n\n由于这三家公司制造工艺大相径庭，飞船对同一条道路环境的耐受力区别很大，而有奇怪的规律。\n\n点 $u$ 有三组系数 $P_A[u],P_B[u],P_C[u]$ ，边 $u\\leftrightarrow v$ 的通过难度为:\n\n$$\\begin{cases}\\text{A形飞船通过难度}=P_A[u]\\ {\\rm xor}\\ P_A[v]\\\\\\text{B形飞船通过难度}=P_B[u]\\ {\\rm xor}\\ P_B[v]\\\\\\text{C形飞船通过难度}=P_C[u]\\ {\\rm xor}\\ P_C[v]\\end{cases}$$\n\n当一个飞船的性能指数不低于某条边对应种类的通过难度时,这个飞船才能够通过 (具体见样例解释)。\n\nLouis Paosen 在每个星球上都准备了比赛点，所以你只要对每个三人小组，给出其可行的集合点个数就好了。", "inputFormat": "第一行：$n,q$。\n\n第 2~4 行：$P_A[1\\sim n],P_B[1\\sim n],P_C[1\\sim n]$。\n\n后 $q$ 行：每行六个数 $h_A,u_A,h_B,u_B,h_C,u_C$ ，表示一个三人小队中每个人的飞船性能以及出发星球编号。", "outputFormat": "对于每个三人小队，输出一行一个数，回答可行的集合点个数。", "hint": "| 　编号　 | 　　n　　 | 　　q　　 | ① | ② | ③ |\n| :--: | :--: | :--: | :--: | :--: | :--: |\n| #1-3 | $100$ | $100$ | - | - | - |\n| #4 | $4\\times 10^4$ | $4\\times 10^4$ | * | * | * |\n| #5 | $4\\times 10^4$ | $4\\times 10^4$ | * | * | - |\n| #6 | $4\\times 10^4$ | $4\\times 10^4$ | * | - | * |\n| #7 | $4\\times 10^4$ | $4\\times 10^4$ | * | - | - |\n| #8 | $4\\times 10^4$ | $4\\times 10^4$ | - | - | - |\n| #9 | $4\\times 10^4$ | $8\\times 10^4$ | - | - | * |\n| #10~13 | $4\\times 10^4$ | $8\\times 10^4$ | - | - | - |\n\n- 性质①：$P_C[1\\sim n]$ 都相等；\n- 性质②：$P_B[1\\sim n]$ 都相等；\n- 性质③：$P_A[1\\sim n], P_B[1\\sim n], P_C[1\\sim n]\\in \\{0,1\\}$。\n\n（#1~#9 每个 $6$ 分，#10~#13 共 $46$ 分；#1~#7 空间限制为 500MB，其余测试点空间限制为 125MB）。\n\n所有输入中的数都是 $[0,10^8]$ 内的整数。\n\n### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/gn9va8wd.png)\n\n三张性能图如上。\n\n如 A 图，$\\begin{cases}(1,2)=P_A[1]\\ {\\rm xor}\\ P_A[2]=3;\\\\(1,3)=P_A[1]\\ {\\rm xor}\\ P_A[3]=2;\\\\(2,3)=P_A[1]\\ {\\rm xor}\\ P_A[2]=1;\\end{cases}$\n\n(边的产生方式就是根据三个数组异或)\n\n第一组人:\n\n- 从 $1$ 出发的 A 飞船性能高达 $5$，能到达所有的星球。\n- 从 $2$ 出发的 B 飞船性能仅为 $2$，不能经过$(3,2)=3$，但是还能到达所有的星球。\n- 从 $3$ 出发的 B 飞船性能仅为 $3$，只能经过$(2,3)=0$，能到达 $2,3$ 号星球。\n- 综上，第一组所有人都能到达的星球有 $2$ 个。", "locale": "zh-CN", "translations": {"en": {"title": "[CmdOI2019] Interstellar KFC 3-on-3 Basketball Tournament", "background": "In the year $3100$, the Earth Federation’s galaxy contains $N$ planets that have completed a massive road construction project, upgrading from the original $N-1$ bidirectional spacetime tunnels to an **undirected complete graph**.\n\nLouis Paosen is an interstellar traveler. Last time you helped him solve a difficult problem (when you ~~were crushing teams~~), so he has come to ask for your help again.", "description": "Still due to funding concerns, the Earth Federation could not build every road perfectly. Traveling through a road **requires certain ship performance**.\n\nLouis Paosen is hosting a grand KFC 3-on-3 basketball tournament within the federation. For a time, many players from different planets rushed to participate.\n\nThree kinds of ships (types A/B/C) are being heavily promoted inside the Earth Federation. Because they took advertising money, team formation requires that among the $3$ people: the first uses type A, the second uses type B, and the third uses type C (so they can get bonus points).\n\nNow there are many 3-person teams preparing to join. They have their ships ready (meeting the bonus condition), but they may come from different planets. Due to ship performance limits, they may not be able to gather together on some planet.\n\nBecause the manufacturing processes of these three companies are very different, ships have very different tolerance to the environment of the same road, following a strange rule.\n\nNode $u$ has three sets of coefficients $P_A[u],P_B[u],P_C[u]$. The passing difficulty of edge $u\\leftrightarrow v$ is:\n\n$$\\begin{cases}\\text{Type A ship passing difficulty}=P_A[u]\\ {\\rm xor}\\ P_A[v]\\\\\\text{Type B ship passing difficulty}=P_B[u]\\ {\\rm xor}\\ P_B[v]\\\\\\text{Type C ship passing difficulty}=P_C[u]\\ {\\rm xor}\\ P_C[v]\\end{cases}$$\n\nA ship can pass an edge only when its performance index is not less than the passing difficulty of that edge for the corresponding type (see the sample explanation for details).\n\nLouis Paosen has prepared a match venue on every planet, so for each 3-person team, you only need to output the number of feasible gathering planets.", "inputFormat": "The first line: $n,q$.\n\nLines 2 to 4: $P_A[1\\sim n],P_B[1\\sim n],P_C[1\\sim n]$.\n\nThe next $q$ lines: each line contains six numbers $h_A,u_A,h_B,u_B,h_C,u_C$, representing the ship performance and the starting planet index for each of the three members of a team.", "outputFormat": "For each 3-person team, output one line with one number: the number of feasible gathering planets.", "hint": "| ID | $n$ | $q$ | ① | ② | ③ |\n| :--: | :--: | :--: | :--: | :--: | :--: |\n| #1-3 | $100$ | $100$ | - | - | - |\n| #4 | $4\\times 10^4$ | $4\\times 10^4$ | * | * | * |\n| #5 | $4\\times 10^4$ | $4\\times 10^4$ | * | * | - |\n| #6 | $4\\times 10^4$ | $4\\times 10^4$ | * | - | * |\n| #7 | $4\\times 10^4$ | $4\\times 10^4$ | * | - | - |\n| #8 | $4\\times 10^4$ | $4\\times 10^4$ | - | - | - |\n| #9 | $4\\times 10^4$ | $8\\times 10^4$ | - | - | * |\n| #10~13 | $4\\times 10^4$ | $8\\times 10^4$ | - | - | - |\n\n- Property ①: $P_C[1\\sim n]$ are all equal.\n- Property ②: $P_B[1\\sim n]$ are all equal.\n- Property ③: $P_A[1\\sim n], P_B[1\\sim n], P_C[1\\sim n]\\in \\{0,1\\}$.\n\n(#1~#9 are $6$ points each, #10~#13 are $46$ points total; #1~#7 have a memory limit of 500MB, and the remaining test points have a memory limit of 125MB).\n\nAll numbers in the input are integers within $[0,10^8]$.\n\n### Sample 1 Explanation\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/gn9va8wd.png)\n\nThe three performance graphs are shown above.\n\nFor the A graph, $\\begin{cases}(1,2)=P_A[1]\\ {\\rm xor}\\ P_A[2]=3;\\\\(1,3)=P_A[1]\\ {\\rm xor}\\ P_A[3]=2;\\\\(2,3)=P_A[1]\\ {\\rm xor}\\ P_A[2]=1;\\end{cases}$\n\n(The edges are generated by XOR-ing the three arrays.)\n\nThe first team:\n\n- The type A ship starting from $1$ has performance as high as $5$, and can reach all planets.\n- The type B ship starting from $2$ has performance only $2$, cannot pass $(3,2)=3$, but can still reach all planets.\n- The type B ship starting from $3$ has performance only $3$, can only pass $(2,3)=0$, and can reach planets $2,3$.\n- Therefore, the number of planets that all members of the first team can reach is $2$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CmdOI2019] 星际kfc篮球赛", "background": "公元 $3100$ 年，地球联盟的银河系内 $N$ 个星球已经完成了道路大建设，从原来的 $N-1$ 条双向时空隧道变成了**无向完全图**。\n\nLouis Paosen 是一个星际旅行家，上次你~~虐队的时候~~顺便帮他解决了难题，于是他又来请求你帮忙啦。", "description": "仍然是出于资金的考虑，地球联盟没能将所有的道路都建造得尽善尽美。通过某条道路**对于飞船的性能有一定的要求**。\n\nLouis Paosen 在联盟内举办了盛大的 kfc 三人篮球赛，一时间，许多来自不同星球的选手纷纷赶来参赛。\n\n整个地球联盟的内部正在热卖三种飞船 (A/B/C 类)，由于收了广告费的缘故，组队的时候要求 $3$ 人中第一人使用 A，第二人使用 B，第三人使用 C (这样可以获得加分)。\n\n现在有许许多多个三人小组准备参赛，他们准备好了飞船(符合加分条件)，但是他们可能来自不同的星球，由于飞船性能的限制，他们可能无法一起到达某个星球。\n\n由于这三家公司制造工艺大相径庭，飞船对同一条道路环境的耐受力区别很大，而有奇怪的规律。\n\n点 $u$ 有三组系数 $P_A[u],P_B[u],P_C[u]$ ，边 $u\\leftrightarrow v$ 的通过难度为:\n\n$$\\begin{cases}\\text{A形飞船通过难度}=P_A[u]\\ {\\rm xor}\\ P_A[v]\\\\\\text{B形飞船通过难度}=P_B[u]\\ {\\rm xor}\\ P_B[v]\\\\\\text{C形飞船通过难度}=P_C[u]\\ {\\rm xor}\\ P_C[v]\\end{cases}$$\n\n当一个飞船的性能指数不低于某条边对应种类的通过难度时,这个飞船才能够通过 (具体见样例解释)。\n\nLouis Paosen 在每个星球上都准备了比赛点，所以你只要对每个三人小组，给出其可行的集合点个数就好了。", "inputFormat": "第一行：$n,q$。\n\n第 2~4 行：$P_A[1\\sim n],P_B[1\\sim n],P_C[1\\sim n]$。\n\n后 $q$ 行：每行六个数 $h_A,u_A,h_B,u_B,h_C,u_C$ ，表示一个三人小队中每个人的飞船性能以及出发星球编号。", "outputFormat": "对于每个三人小队，输出一行一个数，回答可行的集合点个数。", "hint": "| 　编号　 | 　　n　　 | 　　q　　 | ① | ② | ③ |\n| :--: | :--: | :--: | :--: | :--: | :--: |\n| #1-3 | $100$ | $100$ | - | - | - |\n| #4 | $4\\times 10^4$ | $4\\times 10^4$ | * | * | * |\n| #5 | $4\\times 10^4$ | $4\\times 10^4$ | * | * | - |\n| #6 | $4\\times 10^4$ | $4\\times 10^4$ | * | - | * |\n| #7 | $4\\times 10^4$ | $4\\times 10^4$ | * | - | - |\n| #8 | $4\\times 10^4$ | $4\\times 10^4$ | - | - | - |\n| #9 | $4\\times 10^4$ | $8\\times 10^4$ | - | - | * |\n| #10~13 | $4\\times 10^4$ | $8\\times 10^4$ | - | - | - |\n\n- 性质①：$P_C[1\\sim n]$ 都相等；\n- 性质②：$P_B[1\\sim n]$ 都相等；\n- 性质③：$P_A[1\\sim n], P_B[1\\sim n], P_C[1\\sim n]\\in \\{0,1\\}$。\n\n（#1~#9 每个 $6$ 分，#10~#13 共 $46$ 分；#1~#7 空间限制为 500MB，其余测试点空间限制为 125MB）。\n\n所有输入中的数都是 $[0,10^8]$ 内的整数。\n\n### 样例 1 解释\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/gn9va8wd.png)\n\n三张性能图如上。\n\n如 A 图，$\\begin{cases}(1,2)=P_A[1]\\ {\\rm xor}\\ P_A[2]=3;\\\\(1,3)=P_A[1]\\ {\\rm xor}\\ P_A[3]=2;\\\\(2,3)=P_A[1]\\ {\\rm xor}\\ P_A[2]=1;\\end{cases}$\n\n(边的产生方式就是根据三个数组异或)\n\n第一组人:\n\n- 从 $1$ 出发的 A 飞船性能高达 $5$，能到达所有的星球。\n- 从 $2$ 出发的 B 飞船性能仅为 $2$，不能经过$(3,2)=3$，但是还能到达所有的星球。\n- 从 $3$ 出发的 B 飞船性能仅为 $3$，只能经过$(2,3)=0$，能到达 $2,3$ 号星球。\n- 综上，第一组所有人都能到达的星球有 $2$ 个。", "locale": "zh-CN"}}}
{"pid": "P5574", "type": "P", "difficulty": 6, "samples": [["5 1\n1 5 4 2 3", "5"], ["5 2\n1 5 4 2 3", "1"], ["8 3\n1 3 5 2 7 4 8 6", "4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "O2优化", "分治", "凸完全单调性（wqs 二分）"], "title": "[CmdOI2019] 任务分配问题", "background": "挖矿的时候踢断电源线是一种怎样的体验?", "description": "在某台有 $k$ 个 CPU 的计算机中，有 $n$ 个计算任务等待执行。\n\n$a_i$ 为第 $i$ 个任务的优先级，方便起见， $a$ 为一个排列。\n\n现在，要将这些任务分配给 CPU 去解决。\n\n由于内存等原因，一个 CPU 只能负责连续一段的任务，并且要按 (从左到右的) 顺序执行。\n\n**在某个 CPU 内**，无序度定义为：前者先执行，而后者优先级高的任务对的个数。\n\n请最小化每个 CPU 的无序度之和。", "inputFormat": "第一行两个整数 $n,k$ ，分别表示任务个数和 CPU 个数。\n\n第二行 $n$ 个整数，表示 $a_{1\\sim n}$ 。", "outputFormat": "输出一个整数，表示最小的无序度之和。", "hint": "### 样例说明\n\n- **样例 #1**\n\n  此时只能把所有任务交给单独的一个 CPU。\n\n  第一个任务和其他所有任务都形成无序任务对；最后两个任务也形成无序任务对，共 $5$ 个。\n\n- **样例 #2**\n\n  第一个 CPU 单独处理任务 $1$ ，无序度为 $0$；\n  \n  第二个 CPU 处理 $\\{5,4,2,3\\}$ 无序度为 $1$。\n  \n### 限制与约定\n\n对于所有测试数据，保证 $1\\leq n\\leq 2.5\\times 10^4$，$1\\leq k\\leq 25$，$a\\leq n$。\n\n| 测试点编号 | $n$ | $k$ |\n| :--: | :--: | :--: |\n| $1\\sim 2$ | $2.5\\times 10^4$ | $1$ |\n| $3$ | $2.5\\times 10^4$ | $2$ |\n| $4\\sim 5$ | $1000$ | $10$ |\n| $6\\sim 10$ | $2.5\\times 10^4$ | $25$ |", "locale": "zh-CN", "translations": {"en": {"title": "[CmdOI2019] Task Assignment Problem", "background": "What does it feel like to kick off the power cable while mining?", "description": "On a computer with $k$ CPUs, there are $n$ computing tasks waiting to be executed.\n\nLet $a_i$ be the priority of the $i$-th task. For convenience, $a$ is a permutation.\n\nNow, these tasks need to be assigned to the CPUs to be processed.\n\nDue to reasons such as memory limits, one CPU can only handle one continuous segment of tasks, and it must execute them in order (from left to right).\n\n**Within a single CPU**, the disorder is defined as the number of pairs of tasks where the former is executed earlier, but the latter has a higher priority.\n\nMinimize the sum of disorders over all CPUs.", "inputFormat": "The first line contains two integers $n, k$, representing the number of tasks and the number of CPUs.\n\nThe second line contains $n$ integers, representing $a_{1\\sim n}$.", "outputFormat": "Output one integer, representing the minimum possible sum of disorders.", "hint": "### Sample Explanation\n\n- **Sample #1**\n\n  In this case, all tasks can only be assigned to a single CPU.\n\n  The first task forms disorder pairs with all other tasks; the last two tasks also form a disorder pair, for a total of $5$.\n\n- **Sample #2**\n\n  The first CPU processes task $1$ alone, with disorder $0$.\n\n  The second CPU processes $\\{5,4,2,3\\}$, with disorder $1$.\n\n### Constraints and Notes\n\nFor all testdata, it is guaranteed that $1\\leq n\\leq 2.5\\times 10^4$, $1\\leq k\\leq 25$, $a\\leq n$.\n\n| Test Point ID | $n$ | $k$ |\n| :--: | :--: | :--: |\n| $1\\sim 2$ | $2.5\\times 10^4$ | $1$ |\n| $3$ | $2.5\\times 10^4$ | $2$ |\n| $4\\sim 5$ | $1000$ | $10$ |\n| $6\\sim 10$ | $2.5\\times 10^4$ | $25$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CmdOI2019] 任务分配问题", "background": "挖矿的时候踢断电源线是一种怎样的体验?", "description": "在某台有 $k$ 个 CPU 的计算机中，有 $n$ 个计算任务等待执行。\n\n$a_i$ 为第 $i$ 个任务的优先级，方便起见， $a$ 为一个排列。\n\n现在，要将这些任务分配给 CPU 去解决。\n\n由于内存等原因，一个 CPU 只能负责连续一段的任务，并且要按 (从左到右的) 顺序执行。\n\n**在某个 CPU 内**，无序度定义为：前者先执行，而后者优先级高的任务对的个数。\n\n请最小化每个 CPU 的无序度之和。", "inputFormat": "第一行两个整数 $n,k$ ，分别表示任务个数和 CPU 个数。\n\n第二行 $n$ 个整数，表示 $a_{1\\sim n}$ 。", "outputFormat": "输出一个整数，表示最小的无序度之和。", "hint": "### 样例说明\n\n- **样例 #1**\n\n  此时只能把所有任务交给单独的一个 CPU。\n\n  第一个任务和其他所有任务都形成无序任务对；最后两个任务也形成无序任务对，共 $5$ 个。\n\n- **样例 #2**\n\n  第一个 CPU 单独处理任务 $1$ ，无序度为 $0$；\n  \n  第二个 CPU 处理 $\\{5,4,2,3\\}$ 无序度为 $1$。\n  \n### 限制与约定\n\n对于所有测试数据，保证 $1\\leq n\\leq 2.5\\times 10^4$，$1\\leq k\\leq 25$，$a\\leq n$。\n\n| 测试点编号 | $n$ | $k$ |\n| :--: | :--: | :--: |\n| $1\\sim 2$ | $2.5\\times 10^4$ | $1$ |\n| $3$ | $2.5\\times 10^4$ | $2$ |\n| $4\\sim 5$ | $1000$ | $10$ |\n| $6\\sim 10$ | $2.5\\times 10^4$ | $25$ |", "locale": "zh-CN"}}}
{"pid": "P5575", "type": "P", "difficulty": 7, "samples": [["5 4 3\n50 50 50 50 50\n1 2\n2 3\n2 4\n2 5", "19"], ["6 5 2\n20 30 40 50 60 70\n1 2\n2 3\n2 4\n2 5\n4 6", "397301258"], ["10 10 2\n39 76 71 86 36 38 36 44 63 37 \n4 5\n2 10\n6 10\n1 8\n5 10\n8 10\n7 10\n3 10\n10 9\n5 3", "361859252"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "期望"], "title": "[CmdOI2019] 黑白图", "background": "你看见了一张奇怪的图。", "description": "有一张 $n$ 个点，$m$ 条边的简单无向连通图，点可以染上黑色或者白色。\n\n这个图比较稀疏，具体来讲有两种情况。\n\n- $m=n-1$ ，此时是一棵树。\n\n- $m=n$ ，此时是一颗基环树。\n\n我们定义一张黑白图的权值为：其黑色**连通块大小**的 $k$ 次方和。\n\n现在图的形态已经确定，但是每个点上的颜色尚未确定，对于第 $i$ 个点。其有**百分之** $p_i$ 的可能是黑色，反之则是白色。\n\n求图的期望权值对 $998244353$ 取模的结果。", "inputFormat": "第一行包括三个正整数 $n,m,k$ ，意义如题面所述。\n\n接下来一行 $n$ 个数依次表示 $p_{1\\sim n}$。\n\n后 $m$ 行，每行两个数 $f,t$ ，表示图的一条无向边 $f\\leftrightarrow t$ 。", "outputFormat": "输出一个整数，表示图的期望权值对 $998244353$ 取模的结果。", "hint": "| 数据点编号 | $n$ | 　$m$　 | 　$k$　 | 性质1 | 性质2 | 分数 |\n| :--: | :--: | :--: | :--: | :--: | :--: | :--: |\n| 1 | $16$ | $n-1$ | $5$ | $\\sqrt{}$ | - | $5$ |\n| 2 | $50$ | $n-1$ | $3$ | $\\sqrt{}$ | $\\sqrt{}$ | $5$ |\n| 3 | $50$ | $n-1$ | $5$ | $\\sqrt{}$ | - | $5$ |\n| 4 | $500$ | $n-1$ | $1$ | - | - | $5$ |\n| 5 | $2\\times 10^5$ | $n-1$ | $3$ | $\\sqrt{}$ | $\\sqrt{}$ | $5$ |\n| 6 | $2\\times 10^5$ | $n-1$ | $2$ | - | $\\sqrt{}$ | $5$ |\n| 7 | $2\\times 10^5$ | $n-1$ | $4$ | - | - | $10$ |\n| 8 | $16$ | $n$ | $3$ | - | - | $10$ |\n| 9 | $500$ | $n$ | $3$ | - | - | $10$ |\n| 10 | $50000$ | $n$ | $2$ | - | - | $10$ |\n| 11 | $2\\times 10^5$ | $n$ | $4$ | $\\sqrt{}$ | - | $10$ |\n| 12 | $2\\times 10^5$ | $n$ | $5$ | - | - | $10$ |\n| 13 | $2\\times 10^5$ | $n$ | $5$ | - | - | $10$ |\n\n特殊性质 $1$ ：$p_i=50$。\n\n特殊性质 $2$ ：图退化成一条链，其中 $i$ 向 $i+1$ 连边。", "locale": "zh-CN", "translations": {"en": {"title": "[CmdOI2019] Black and White Graph", "background": "You saw a strange graph.", "description": "There is a simple undirected connected graph with $n$ vertices and $m$ edges. Each vertex can be colored black or white.\n\nThis graph is relatively sparse. Specifically, there are two cases.\n\n- $m=n-1$, in which case it is a tree.\n\n- $m=n$, in which case it is a unicyclic graph (a tree with one extra edge).\n\nWe define the value of a black-and-white graph as follows: the sum of the $k$-th powers of the sizes of its black connected components.\n\nNow the shape of the graph is fixed, but the color of each vertex is not fixed. For the $i$-th vertex, it has a probability of **$p_i$ percent** to be black; otherwise it is white.\n\nCompute the expected value of the graph, modulo $998244353$.", "inputFormat": "The first line contains three positive integers $n,m,k$, with meanings as described above.\n\nThe next line contains $n$ numbers, which are $p_{1\\sim n}$ in order.\n\nThe next $m$ lines each contain two numbers $f,t$, indicating an undirected edge $f\\leftrightarrow t$ in the graph.", "outputFormat": "Output one integer, the expected value of the graph modulo $998244353$.", "hint": "| Test Point ID | $n$ | 　$m$　 | 　$k$　 | Property 1 | Property 2 | Score |\n| :--: | :--: | :--: | :--: | :--: | :--: | :--: |\n| 1 | $16$ | $n-1$ | $5$ | $\\sqrt{}$ | - | $5$ |\n| 2 | $50$ | $n-1$ | $3$ | $\\sqrt{}$ | $\\sqrt{}$ | $5$ |\n| 3 | $50$ | $n-1$ | $5$ | $\\sqrt{}$ | - | $5$ |\n| 4 | $500$ | $n-1$ | $1$ | - | - | $5$ |\n| 5 | $2\\times 10^5$ | $n-1$ | $3$ | $\\sqrt{}$ | $\\sqrt{}$ | $5$ |\n| 6 | $2\\times 10^5$ | $n-1$ | $2$ | - | $\\sqrt{}$ | $5$ |\n| 7 | $2\\times 10^5$ | $n-1$ | $4$ | - | - | $10$ |\n| 8 | $16$ | $n$ | $3$ | - | - | $10$ |\n| 9 | $500$ | $n$ | $3$ | - | - | $10$ |\n| 10 | $50000$ | $n$ | $2$ | - | - | $10$ |\n| 11 | $2\\times 10^5$ | $n$ | $4$ | $\\sqrt{}$ | - | $10$ |\n| 12 | $2\\times 10^5$ | $n$ | $5$ | - | - | $10$ |\n| 13 | $2\\times 10^5$ | $n$ | $5$ | - | - | $10$ |\n\nSpecial Property $1$: $p_i=50$.\n\nSpecial Property $2$: The graph degenerates into a single chain, where there is an edge between $i$ and $i+1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CmdOI2019] 黑白图", "background": "你看见了一张奇怪的图。", "description": "有一张 $n$ 个点，$m$ 条边的简单无向连通图，点可以染上黑色或者白色。\n\n这个图比较稀疏，具体来讲有两种情况。\n\n- $m=n-1$ ，此时是一棵树。\n\n- $m=n$ ，此时是一颗基环树。\n\n我们定义一张黑白图的权值为：其黑色**连通块大小**的 $k$ 次方和。\n\n现在图的形态已经确定，但是每个点上的颜色尚未确定，对于第 $i$ 个点。其有**百分之** $p_i$ 的可能是黑色，反之则是白色。\n\n求图的期望权值对 $998244353$ 取模的结果。", "inputFormat": "第一行包括三个正整数 $n,m,k$ ，意义如题面所述。\n\n接下来一行 $n$ 个数依次表示 $p_{1\\sim n}$。\n\n后 $m$ 行，每行两个数 $f,t$ ，表示图的一条无向边 $f\\leftrightarrow t$ 。", "outputFormat": "输出一个整数，表示图的期望权值对 $998244353$ 取模的结果。", "hint": "| 数据点编号 | $n$ | 　$m$　 | 　$k$　 | 性质1 | 性质2 | 分数 |\n| :--: | :--: | :--: | :--: | :--: | :--: | :--: |\n| 1 | $16$ | $n-1$ | $5$ | $\\sqrt{}$ | - | $5$ |\n| 2 | $50$ | $n-1$ | $3$ | $\\sqrt{}$ | $\\sqrt{}$ | $5$ |\n| 3 | $50$ | $n-1$ | $5$ | $\\sqrt{}$ | - | $5$ |\n| 4 | $500$ | $n-1$ | $1$ | - | - | $5$ |\n| 5 | $2\\times 10^5$ | $n-1$ | $3$ | $\\sqrt{}$ | $\\sqrt{}$ | $5$ |\n| 6 | $2\\times 10^5$ | $n-1$ | $2$ | - | $\\sqrt{}$ | $5$ |\n| 7 | $2\\times 10^5$ | $n-1$ | $4$ | - | - | $10$ |\n| 8 | $16$ | $n$ | $3$ | - | - | $10$ |\n| 9 | $500$ | $n$ | $3$ | - | - | $10$ |\n| 10 | $50000$ | $n$ | $2$ | - | - | $10$ |\n| 11 | $2\\times 10^5$ | $n$ | $4$ | $\\sqrt{}$ | - | $10$ |\n| 12 | $2\\times 10^5$ | $n$ | $5$ | - | - | $10$ |\n| 13 | $2\\times 10^5$ | $n$ | $5$ | - | - | $10$ |\n\n特殊性质 $1$ ：$p_i=50$。\n\n特殊性质 $2$ ：图退化成一条链，其中 $i$ 向 $i+1$ 连边。", "locale": "zh-CN"}}}
{"pid": "P5576", "type": "P", "difficulty": 7, "samples": [["3 3\n10111\n1111010111\n010111111101\n1 3\n1 2\n2 3", "5\n5\n6"], ["10 10\n00\n010\n1000000001\n1000000110000001\n00010100110101001011000110100001\n10111001001010100100000011011\n101110010010101001000000101011\n1011100100101010010010000111011\n1011100100101010011010000101011\n0001101001101011\n1 4\n6 10\n5 6\n4 6\n9 10\n7 10\n2 10\n1 5\n1 8\n4 7", "1\n6\n9\n6\n10\n6\n2\n1\n1\n5"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["后缀自动机 SAM", "分治", "后缀数组 SA", "整体二分", "根号分治", "线段树合并", "启发式合并"], "title": "[CmdOI2019] 口头禅", "background": "**温馨提示** : 请注意本题特殊的时空限制。\n\n（若您认为使用了复杂度正确的算法但被卡常，可以联系出题人）\n\n一个悠闲的午后，机房里的大佬们都在水群。", "description": "蒟蒻出题人收集了某位大佬的 $n$ 条语录，并按时间为序编号为 $1...n$ 。\n\n他发现这位大佬的口头禅是随着时间而变化的，而且里面有些看不懂的内容。\n\n在请教了群 DS 带师之后，他得到了某种 hash 方法，把这些语录都变成了 01 串，这样似乎好懂一些。\n\n为了研究水群的奥秘，他进行了多次询问 : $[l,r]$ **之间的所有语录，最长公共子串的长度是多少**?\n\n出题人知道这并不是一个简单的问题，所以他并不急于即时得知每个询问的答案。", "inputFormat": "第一行两个整数 $n,m$ ，表示语录的条数和询问个数。\n\n对于后 $n$ 行，第 $i$ 行表示第 $i$ 条语录，保证字符集为 $\\{0,1\\}$。\n\n后 $m$ 行，每行两个整数 $l,r(1\\leq l<r \\leq n)$ ，表示一个询问。", "outputFormat": "对于每个询问，输出 $[l,r]$ 之间的所有语录最长公共子串的长度。", "hint": "| subtask编号 | 　$\\bf n$　 | 　$\\bf m$　 | 语录总长 | 分值 |\n| :--: | :--: | :--: | :--: | :--: |\n| 1 | $50$ | $50$ | $500$ | $10$ |\n| 2 | $50$ | $50$ | $8\\times 10^4$ | $15$ |\n| 3 | $2000$ | $10^4$ | $1.6\\times 10^5$ | $15$ |\n| 4 | $2\\times 10^4$ | $10^5$ | $4\\times 10^5$ | $15$ |\n| 5 | $2\\times 10^4$ | $10^5$ | $4\\times 10^5$ | $45$ |\n\n对于subtask**4** : 语录生成后，**之间**的顺序经过随机打乱。\n\n对于subtask**5** : 空间限制为$\\texttt{128Mb}$，其他的数据为$\\texttt{500Mb}$。", "locale": "zh-CN", "translations": {"en": {"title": "[CmdOI2019] Catchphrase", "background": "**Friendly reminder**: Please note the special time and memory limits of this problem.\n\n(If you believe you used an algorithm with the correct complexity but it fails due to constant factors, you can contact the problem setter.)\n\nOn a leisurely afternoon, the experts in the computer room are all chatting in groups.", "description": "The newbie problem setter collected $n$ quotes from a certain expert, and numbered them by time as $1...n$.\n\nHe found that this expert’s catchphrase changes over time, and there is also some content that is hard to understand.\n\nAfter asking the group “DS” master (can also be left as “DS” in pinyin), he got a certain hash method that turns these quotes into binary strings, which seems easier to understand.\n\nTo study the secrets of group chatting, he asked many queries: **among all quotes between** $[l,r]$, **what is the length of the longest common substring**?\n\nThe problem setter knows this is not an easy problem, so he is not in a hurry to get the answer to each query immediately.", "inputFormat": "The first line contains two integers $n,m$, representing the number of quotes and the number of queries.\n\nIn the next $n$ lines, the $i$-th line describes the $i$-th quote. The alphabet is guaranteed to be $\\{0,1\\}$.\n\nIn the following $m$ lines, each line contains two integers $l,r(1\\leq l<r \\leq n)$, representing a query.", "outputFormat": "For each query, output the length of the longest common substring among all quotes between $[l,r]$.", "hint": "| Subtask ID | $\\bf n$ | $\\bf m$ | Total quote length | Score |\n| :--: | :--: | :--: | :--: | :--: |\n| 1 | $50$ | $50$ | $500$ | $10$ |\n| 2 | $50$ | $50$ | $8\\times 10^4$ | $15$ |\n| 3 | $2000$ | $10^4$ | $1.6\\times 10^5$ | $15$ |\n| 4 | $2\\times 10^4$ | $10^5$ | $4\\times 10^5$ | $15$ |\n| 5 | $2\\times 10^4$ | $10^5$ | $4\\times 10^5$ | $45$ |\n\nFor subtask **4**: after the quotes are generated, the order **between them** is randomly shuffled.\n\nFor subtask **5**: the memory limit is $\\texttt{128Mb}$, and for the other testdata it is $\\texttt{500Mb}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CmdOI2019] 口头禅", "background": "**温馨提示** : 请注意本题特殊的时空限制。\n\n（若您认为使用了复杂度正确的算法但被卡常，可以联系出题人）\n\n一个悠闲的午后，机房里的大佬们都在水群。", "description": "蒟蒻出题人收集了某位大佬的 $n$ 条语录，并按时间为序编号为 $1...n$ 。\n\n他发现这位大佬的口头禅是随着时间而变化的，而且里面有些看不懂的内容。\n\n在请教了群 DS 带师之后，他得到了某种 hash 方法，把这些语录都变成了 01 串，这样似乎好懂一些。\n\n为了研究水群的奥秘，他进行了多次询问 : $[l,r]$ **之间的所有语录，最长公共子串的长度是多少**?\n\n出题人知道这并不是一个简单的问题，所以他并不急于即时得知每个询问的答案。", "inputFormat": "第一行两个整数 $n,m$ ，表示语录的条数和询问个数。\n\n对于后 $n$ 行，第 $i$ 行表示第 $i$ 条语录，保证字符集为 $\\{0,1\\}$。\n\n后 $m$ 行，每行两个整数 $l,r(1\\leq l<r \\leq n)$ ，表示一个询问。", "outputFormat": "对于每个询问，输出 $[l,r]$ 之间的所有语录最长公共子串的长度。", "hint": "| subtask编号 | 　$\\bf n$　 | 　$\\bf m$　 | 语录总长 | 分值 |\n| :--: | :--: | :--: | :--: | :--: |\n| 1 | $50$ | $50$ | $500$ | $10$ |\n| 2 | $50$ | $50$ | $8\\times 10^4$ | $15$ |\n| 3 | $2000$ | $10^4$ | $1.6\\times 10^5$ | $15$ |\n| 4 | $2\\times 10^4$ | $10^5$ | $4\\times 10^5$ | $15$ |\n| 5 | $2\\times 10^4$ | $10^5$ | $4\\times 10^5$ | $45$ |\n\n对于subtask**4** : 语录生成后，**之间**的顺序经过随机打乱。\n\n对于subtask**5** : 空间限制为$\\texttt{128Mb}$，其他的数据为$\\texttt{500Mb}$。", "locale": "zh-CN"}}}
{"pid": "P5577", "type": "P", "difficulty": 7, "samples": [["3 5 1\n1 2 3", "2\n2\n1\n2\n1"], ["5 6 1\n1 1 4 5 1 4", "8\n7\n4\n2\n4\n7"]], "limits": {"time": [600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["快速沃尔什变换 FWT"], "title": "[CmdOI2019] 算力训练", "background": "最近，出题人快乐地学习了如何解一元二次方程。\n\n晚上在宿舍里，出题人梦见了一个使用 $k$ 进制的国度，入乡随俗嘛，出题人在这里也使用 $k$ 进制。\n\n当然，这个国度里面的人也懂数学，所以解不出一元二次方程的出题人并没有逃掉算力训练。", "description": "出题人在纸条上写了 $n$ 个 $k$ 进制自然数，由于他很懒，这些数的位数不会太多，都不会超过 $m$ 位。\n\n为了训练算力，他每次会**随意取出一个子序列** (允许一个数都不选) ，然后把这些数都加起来。\n\n他又觉得进位太麻烦了，干脆规定**加法不进位**。\n\n算了几次之后，他突然很想知道自己得到每个数的方案数是多少，可是他太菜了，又不会算。冥思苦想一番之后,突然被起床铃拉出了梦境。\n\n他觉得这个问题很有趣，只好求助于单手虐暴无数代数题的你，来帮忙计算一下。\n\n**形式化题意** ： 对于一个序列 $A$ ，定义其权值 $W(A)$ 为 $A$ 中元素做 $k$ 进制不进位加法的和。\n\n给出 $m,k$ 和一个长为 $n$ 的序列 $S$。保证 $S\\subseteq [0,k^m)∩Z$。\n\n对于 $t=0,1,2,...,k^m-1$ ，分别求出下列式子的值 ：\n\n$${\\rm Ans}[t]=\\sum\\limits_{\\text{R 是 S 的子序列}}\\big[W(R)=t\\big]$$\n\n注 ：根据正确的题意可推知 $\\sum\\limits_{t=0}^{k^m-1}{\\rm Ans}[t]=2^n$。", "inputFormat": "第一行三个整数 $n,k,m$ ，意义为题目中所述。\n\n第二行 $n$ 个整数，之间用空格隔开，表示纸条上的数字。\n\n(**注意**，纸条上的数均为 $k$ 进制数)", "outputFormat": "共 $k^m$ 行,你需要在第 $i$ 行输出得到数 $i-1$ 的方案数，答案对 $998244353$ 取模。", "hint": "### 样例解释\n\n对于样例#1，共有 $2^3=8$ 种选取子序列的方法：\n\n1. 什么都不选，和为 $0$\n2. 选 $1$ ，和为 $1$\n3. 选 $2$ ，和为 $2$\n4. 选 $3$ ，和为 $3$\n5. 选 $1+2$ ，和为 $3$\n6. 选 $1+3$ ，和为 $4$\n7. 选 $2+3$ ，和为 $0$ （由于是 $5$ 进制，本来要变成 $10$ 的，但是不进位就只剩下 $0$ 了）\n8. 选 $1+2+3$，和为 $1$\n\n综上，得到 `0,1,2,3,4` 的方案数分别是 `2,2,1,2,1` 。\n\n### 数据范围和约定\n\n| 测试点编号 | 　n　 | 　k　 | 　m　 | 总分数 |\n| :--: | :--: | :--: | :--: | :--: |\n| #1 | $20$ | $5$ | $4$ | $5$ |\n| #2 | $1000$ | $5$ | $4$ | $5$ |\n| #3~4 | $10^6$ | $5$ | $5$ | $10$ |\n| #5 | $10^6$ | $5$ | $6$ | $10$ |\n| #6~7 | $10^6$ | $5$ | $7$ | $20$ |\n| #8 | $20$ | $6$ | $4$ | $5$ |\n| #9 | $1000$ | $6$ | $4$ | $5$ |\n| #10~11 | $10^6$ | $6$ | $4$ | $10$ |\n| #12~14 | $10^6$ | $6$ | $6$ | $30$ |", "locale": "zh-CN", "translations": {"en": {"title": "[CmdOI2019] Computing Power Training", "background": "Recently, the problem setter happily learned how to solve a quadratic equation in one variable.\n\nAt night in the dorm, the problem setter dreamed of a country that uses base $k$. When in Rome, do as the Romans do, so the problem setter also used base $k$ there.\n\nOf course, people in that country also know mathematics, so the problem setter, who still could not solve a quadratic equation in one variable, did not escape computing power training.", "description": "The problem setter wrote down $n$ base-$k$ natural numbers on a slip of paper. Because he is lazy, these numbers will not have too many digits, and none of them exceeds $m$ digits.\n\nTo train computing power, each time he will **randomly pick a subsequence** (it is allowed to pick none), and then add all the chosen numbers together.\n\nHe also felt carrying was too troublesome, so he simply规定 that **addition is done without carry**.\n\nAfter computing a few times, he suddenly wanted to know how many ways he can obtain each number, but he is too weak and cannot compute it. After thinking hard, he was suddenly pulled out of the dream by the wake-up bell.\n\nHe found this problem interesting, so he had to ask you, who can crush countless algebra problems with one hand, to help compute it.\n\n**Formal statement**: For a sequence $A$, define its weight $W(A)$ as the sum of the elements in $A$ using base-$k$ addition without carry.\n\nGiven $m$, $k$, and a sequence $S$ of length $n$. It is guaranteed that $S\\subseteq [0,k^m)∩Z$.\n\nFor $t=0,1,2,...,k^m-1$, compute the value of:\n\n$${\\rm Ans}[t]=\\sum\\limits_{\\text{R is a subsequence of S}}\\big[W(R)=t\\big]$$\n\nNote: From the correct statement, we can infer that $\\sum\\limits_{t=0}^{k^m-1}{\\rm Ans}[t]=2^n$.", "inputFormat": "The first line contains three integers $n,k,m$, with the meaning described in the statement.\n\nThe second line contains $n$ integers separated by spaces, representing the numbers on the slip of paper.\n\n(**Note**: the numbers on the slip of paper are all base-$k$ numbers.)", "outputFormat": "There are $k^m$ lines. On the $i$-th line, output the number of ways to obtain the number $i-1$. Output the answer modulo $998244353$.", "hint": "### Sample Explanation\n\nFor Sample #1, there are $2^3=8$ ways to choose a subsequence:\n\n1. Choose nothing, the sum is $0$.\n2. Choose $1$, the sum is $1$.\n3. Choose $2$, the sum is $2$.\n4. Choose $3$, the sum is $3$.\n5. Choose $1+2$, the sum is $3$.\n6. Choose $1+3$, the sum is $4$.\n7. Choose $2+3$, the sum is $0$ (since it is base $5$, it should become $10$, but without carry it becomes only $0$).\n8. Choose $1+2+3$, the sum is $1$.\n\nIn summary, the numbers of ways to obtain `0,1,2,3,4` are `2,2,1,2,1`, respectively.\n\n### Constraints and Conventions\n\n| Test Point ID | 　n　 | 　k　 | 　m　 | Total Score |\n| :--: | :--: | :--: | :--: | :--: |\n| #1 | $20$ | $5$ | $4$ | $5$ |\n| #2 | $1000$ | $5$ | $4$ | $5$ |\n| #3~4 | $10^6$ | $5$ | $5$ | $10$ |\n| #5 | $10^6$ | $5$ | $6$ | $10$ |\n| #6~7 | $10^6$ | $5$ | $7$ | $20$ |\n| #8 | $20$ | $6$ | $4$ | $5$ |\n| #9 | $1000$ | $6$ | $4$ | $5$ |\n| #10~11 | $10^6$ | $6$ | $4$ | $10$ |\n| #12~14 | $10^6$ | $6$ | $6$ | $30$ |\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[CmdOI2019] 算力训练", "background": "最近，出题人快乐地学习了如何解一元二次方程。\n\n晚上在宿舍里，出题人梦见了一个使用 $k$ 进制的国度，入乡随俗嘛，出题人在这里也使用 $k$ 进制。\n\n当然，这个国度里面的人也懂数学，所以解不出一元二次方程的出题人并没有逃掉算力训练。", "description": "出题人在纸条上写了 $n$ 个 $k$ 进制自然数，由于他很懒，这些数的位数不会太多，都不会超过 $m$ 位。\n\n为了训练算力，他每次会**随意取出一个子序列** (允许一个数都不选) ，然后把这些数都加起来。\n\n他又觉得进位太麻烦了，干脆规定**加法不进位**。\n\n算了几次之后，他突然很想知道自己得到每个数的方案数是多少，可是他太菜了，又不会算。冥思苦想一番之后,突然被起床铃拉出了梦境。\n\n他觉得这个问题很有趣，只好求助于单手虐暴无数代数题的你，来帮忙计算一下。\n\n**形式化题意** ： 对于一个序列 $A$ ，定义其权值 $W(A)$ 为 $A$ 中元素做 $k$ 进制不进位加法的和。\n\n给出 $m,k$ 和一个长为 $n$ 的序列 $S$。保证 $S\\subseteq [0,k^m)∩Z$。\n\n对于 $t=0,1,2,...,k^m-1$ ，分别求出下列式子的值 ：\n\n$${\\rm Ans}[t]=\\sum\\limits_{\\text{R 是 S 的子序列}}\\big[W(R)=t\\big]$$\n\n注 ：根据正确的题意可推知 $\\sum\\limits_{t=0}^{k^m-1}{\\rm Ans}[t]=2^n$。", "inputFormat": "第一行三个整数 $n,k,m$ ，意义为题目中所述。\n\n第二行 $n$ 个整数，之间用空格隔开，表示纸条上的数字。\n\n(**注意**，纸条上的数均为 $k$ 进制数)", "outputFormat": "共 $k^m$ 行,你需要在第 $i$ 行输出得到数 $i-1$ 的方案数，答案对 $998244353$ 取模。", "hint": "### 样例解释\n\n对于样例#1，共有 $2^3=8$ 种选取子序列的方法：\n\n1. 什么都不选，和为 $0$\n2. 选 $1$ ，和为 $1$\n3. 选 $2$ ，和为 $2$\n4. 选 $3$ ，和为 $3$\n5. 选 $1+2$ ，和为 $3$\n6. 选 $1+3$ ，和为 $4$\n7. 选 $2+3$ ，和为 $0$ （由于是 $5$ 进制，本来要变成 $10$ 的，但是不进位就只剩下 $0$ 了）\n8. 选 $1+2+3$，和为 $1$\n\n综上，得到 `0,1,2,3,4` 的方案数分别是 `2,2,1,2,1` 。\n\n### 数据范围和约定\n\n| 测试点编号 | 　n　 | 　k　 | 　m　 | 总分数 |\n| :--: | :--: | :--: | :--: | :--: |\n| #1 | $20$ | $5$ | $4$ | $5$ |\n| #2 | $1000$ | $5$ | $4$ | $5$ |\n| #3~4 | $10^6$ | $5$ | $5$ | $10$ |\n| #5 | $10^6$ | $5$ | $6$ | $10$ |\n| #6~7 | $10^6$ | $5$ | $7$ | $20$ |\n| #8 | $20$ | $6$ | $4$ | $5$ |\n| #9 | $1000$ | $6$ | $4$ | $5$ |\n| #10~11 | $10^6$ | $6$ | $4$ | $10$ |\n| #12~14 | $10^6$ | $6$ | $6$ | $30$ |", "locale": "zh-CN"}}}
{"pid": "P5578", "type": "P", "difficulty": 4, "samples": [["3 2 1\n2 3 4\n1 2\n3 2\n2 3", "6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2014", "PA（波兰）"], "title": "[PA 2014] Fiolki", "background": "", "description": "化学家吉丽想要配置一种神奇的药水来拯救世界。\n\n吉丽有 $n$ 种不同的液体物质，和 $n$ 个药瓶（均从 $1$ 到 $n$ 编号）。初始时，第 $i$ 个瓶内装着 $g_i$ 克的第 $i$ 种物质。\n\n吉丽需要执行一定的步骤来配置药水，第 $i$ 个步骤是将第 $a_i$ 个瓶子内的所有液体倒入第 $b_i$ 个瓶子，此后第 $a_i$ 个瓶子不会再被用到。瓶子的容量可以视作是无限的。\n\n吉丽知道某几对液体物质在一起时会发生反应产生沉淀，具体反应是 $1$ 克 $c_i$ 物质和 $1$ 克 $d_i$ 物质生成 $2$ 克沉淀，一直进行直到某一反应物耗尽。生成的沉淀不会和任何物质反应。\n\n当有多于一对可以发生反应的物质在一起时，吉丽知道它们的反应顺序。每次倾倒完后，吉丽会等到反应结束后再执行下一步骤。\n\n吉丽想知道配置过程中总共产生多少沉淀。", "inputFormat": "第一行三个整数 $n,m,k$，分别表示药瓶的个数（即物质的种数），操作步数，可以发生的反应数量。\n\n第二行有 $n$ 个整数 $g_1,g_2,…,g_n$，表示初始时每个瓶内物质的质量。\n\n接下来 $m$ 行，每行两个整数 $a_i,b_i$，表示第 $i$ 个步骤。保证 $a_i$ 在以后的步骤中不再出现。\n\n接下来 $k$ 行，每行是一对可以发生反应的物质 $c_i,d_i$，按照反应的优先顺序给出。同一个反应不会重复出现。", "outputFormat": "输出总共产生的沉淀质量。", "hint": "对于 $100\\%$ 的数据，$0\\le m<n\\le 2\\times 10^5$，$0\\le k\\le 5\\times 10^5$，$1\\le g_i\\le 10^9$，$1\\le a_i,b_i,c_i,d_i\\le n$，$a_i\\ne b_i$，$c_i\\ne d_i$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2014] Fiolki", "background": "", "description": "化学家吉丽想要配置一种神奇的药水来拯救世界。\n\n吉丽有 $n$ 种不同的液体物质，和 $n$ 个药瓶（均从 $1$ 到 $n$ 编号）。初始时，第 $i$ 个瓶内装着 $g_i$ 克的第 $i$ 种物质。\n\n吉丽需要执行一定的步骤来配置药水，第 $i$ 个步骤是将第 $a_i$ 个瓶子内的所有液体倒入第 $b_i$ 个瓶子，此后第 $a_i$ 个瓶子不会再被用到。瓶子的容量可以视作是无限的。\n\n吉丽知道某几对液体物质在一起时会发生反应产生沉淀，具体反应是 $1$ 克 $c_i$ 物质和 $1$ 克 $d_i$ 物质生成 $2$ 克沉淀，一直进行直到某一反应物耗尽。生成的沉淀不会和任何物质反应。\n\n当有多于一对可以发生反应的物质在一起时，吉丽知道它们的反应顺序。每次倾倒完后，吉丽会等到反应结束后再执行下一步骤。\n\n吉丽想知道配置过程中总共产生多少沉淀。", "inputFormat": "第一行三个整数 $n,m,k$，分别表示药瓶的个数（即物质的种数），操作步数，可以发生的反应数量。\n\n第二行有 $n$ 个整数 $g_1,g_2,…,g_n$，表示初始时每个瓶内物质的质量。\n\n接下来 $m$ 行，每行两个整数 $a_i,b_i$，表示第 $i$ 个步骤。保证 $a_i$ 在以后的步骤中不再出现。\n\n接下来 $k$ 行，每行是一对可以发生反应的物质 $c_i,d_i$，按照反应的优先顺序给出。同一个反应不会重复出现。", "outputFormat": "输出总共产生的沉淀质量。", "hint": "对于 $100\\%$ 的数据，$0\\le m<n\\le 2\\times 10^5$，$0\\le k\\le 5\\times 10^5$，$1\\le g_i\\le 10^9$，$1\\le a_i,b_i,c_i,d_i\\le n$，$a_i\\ne b_i$，$c_i\\ne d_i$。", "locale": "zh-CN"}}}
{"pid": "P5579", "type": "P", "difficulty": 5, "samples": [["4 4\n1 2 4 3\n1 1\n2 2\n3 0\n4 4", "6\n6\n18\n0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "PA（波兰）"], "title": "[PA 2015] Siano", "background": "", "description": "农夫 Byteasar 买了一片 $n$ 亩的土地，他要在这上面种草。\n\n他在每一亩土地上都种植了一种独一无二的草，其中，第 $i$ 亩土地的草每天会长高 $a_i$ 厘米。\n\nByteasar 一共会进行 $m$ 次收割，其中第 $i$ 次收割在第 $d_i$ 天，并把所有高度大于等于 $b_i$ 的部分全部割去。\n\nByteasar 想知道，每次收割得到的草的高度总和是多少，你能帮帮他吗？", "inputFormat": "第一行包含两个正整数 $n,m$，分别表示亩数和收割次数。\n\n第二行包含 $n$ 个正整数，其中第 $i$ 个数为 $a_i$，依次表示每亩种植的草的生长能力。\n\n接下来 $m$ 行，每行包含两个整数 $d_i,b_i$，依次描述每次收割。\n\n", "outputFormat": "输出 $m$ 行，每行一个整数，依次回答每次收割能得到的草的高度总和。", "hint": "对于 $100\\%$ 的数据，$1\\le n,m\\le 5\\times 10^5$，$1\\le a_i\\le 10^6$，$1\\le d_i\\le 10^{12}$，$0\\le b_i\\le 10^{12}$。\n\n数据保证 $d_1<d_2<...<d_m$，并且任何时刻没有任何一亩草的高度超过 $10^{12}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2015] Siano", "background": "", "description": "农夫 Byteasar 买了一片 $n$ 亩的土地，他要在这上面种草。\n\n他在每一亩土地上都种植了一种独一无二的草，其中，第 $i$ 亩土地的草每天会长高 $a_i$ 厘米。\n\nByteasar 一共会进行 $m$ 次收割，其中第 $i$ 次收割在第 $d_i$ 天，并把所有高度大于等于 $b_i$ 的部分全部割去。\n\nByteasar 想知道，每次收割得到的草的高度总和是多少，你能帮帮他吗？", "inputFormat": "第一行包含两个正整数 $n,m$，分别表示亩数和收割次数。\n\n第二行包含 $n$ 个正整数，其中第 $i$ 个数为 $a_i$，依次表示每亩种植的草的生长能力。\n\n接下来 $m$ 行，每行包含两个整数 $d_i,b_i$，依次描述每次收割。\n\n", "outputFormat": "输出 $m$ 行，每行一个整数，依次回答每次收割能得到的草的高度总和。", "hint": "对于 $100\\%$ 的数据，$1\\le n,m\\le 5\\times 10^5$，$1\\le a_i\\le 10^6$，$1\\le d_i\\le 10^{12}$，$0\\le b_i\\le 10^{12}$。\n\n数据保证 $d_1<d_2<...<d_m$，并且任何时刻没有任何一亩草的高度超过 $10^{12}$。", "locale": "zh-CN"}}}
{"pid": "P5580", "type": "P", "difficulty": 5, "samples": [["025", "1525"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2015", "Special Judge", "PA（波兰）"], "title": "[PA 2015] Fibonacci", "background": "更新：输出任意满足条件的 $k$ 即可，感谢 @[Karry5307](https://www.luogu.com.cn/user/60990) 的修正和 spj。", "description": "众所周知，斐波那契数列 $F$ 满足：\n$$F_0=0,F_1=1,F_m=F_{m-1}+F_{m-2}(2\\le m)$$\n现在给出一个数字串 $S$，请找到一个**最小**的 $k$ 使得 $F_k$ 以 $S$ 为结尾。", "inputFormat": "包含一行一个数字串 $S$。", "outputFormat": "输出满足条件的最小数字 $k$。\n\n若无解，输出 `NIE`。\n\n", "hint": "对于 $100\\%$ 的数据，$S$ 的长度不超过 $18$，$0\\le k<10^{100}$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2015] Fibonacci", "background": "更新：输出任意满足条件的 $k$ 即可，感谢 @[Karry5307](https://www.luogu.com.cn/user/60990) 的修正和 spj。", "description": "众所周知，斐波那契数列 $F$ 满足：\n$$F_0=0,F_1=1,F_m=F_{m-1}+F_{m-2}(2\\le m)$$\n现在给出一个数字串 $S$，请找到一个**最小**的 $k$ 使得 $F_k$ 以 $S$ 为结尾。", "inputFormat": "包含一行一个数字串 $S$。", "outputFormat": "输出满足条件的最小数字 $k$。\n\n若无解，输出 `NIE`。\n\n", "hint": "对于 $100\\%$ 的数据，$S$ 的长度不超过 $18$，$0\\le k<10^{100}$。", "locale": "zh-CN"}}}
{"pid": "P5581", "type": "P", "difficulty": 5, "samples": [["4\n2 3 2 1\n3\nWPP", "12"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "PA（波兰）"], "title": "[PA 2015] Hazard", "background": "~~赌博有害健康请不要模仿。~~", "description": "有 $n$ 个人在轮流玩赌博机，一开始编号为 $i$ 的人有 $a_i$ 元钱。赌博机可以抽象为一个长度为 $m$ 的仅包含 $1$ 和 $-1$ 的序列，若抽到 $1$，那么你将得到 $1$ 块钱；若抽到 $-1$，你将输掉 $1$ 块钱。\n\n第 $1$ 局，第 $1$ 个人会抽到序列中的第 $1$ 项；第 $2$ 局，第 $2$ 个人会抽到序列中的第 $2$ 项；第 $3$ 局，第 $3$ 个人会抽到序列中的第 $3$ 项......即：第 $i$ 个人抽完后轮到第 $i+1$ 个人去抽，特别地，第 $n$ 个人抽完后轮到第 $1$ 个人去抽。序列第 $i$ 项被抽到之后，下一个被抽到的将会是第 $i+1$ 项，特别地，序列第 $m$ 项被抽到之后，下一个被抽到的将会是第 $1$ 项。\n\n如果在某一轮，有个人输光了所有的钱，那么这场赌博游戏就会结束，请求出游戏在哪一轮结束，或者判断这个游戏会永远进行下去。", "inputFormat": "第一行包含一个正整数 $n$，表示玩家的个数。\n\n第二行包含 $n$ 个正整数 $a_1,a_2,...,a_n$，依次表示每个玩家一开始持有的钱数。\n\n第一行包含一个正整数 $m$，表示序列的长度。\n\n第四行包含一个长度为 $m$ 的仅包含 `W` 和 `P` 的字符串，表示这个序列，其中 `W` 表示 $1$，`P` 表示 $-1$。", "outputFormat": "若游戏会永远进行下去，输出 `-1`。否则输出游戏在哪一轮结束。", "hint": "对于 $100\\%$ 的数据，$1\\le n\\le 10^6$，$1\\le a_i\\le 10^6$，$1\\le m\\le 10^6$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[PA 2015] Hazard", "background": "~~赌博有害健康请不要模仿。~~", "description": "有 $n$ 个人在轮流玩赌博机，一开始编号为 $i$ 的人有 $a_i$ 元钱。赌博机可以抽象为一个长度为 $m$ 的仅包含 $1$ 和 $-1$ 的序列，若抽到 $1$，那么你将得到 $1$ 块钱；若抽到 $-1$，你将输掉 $1$ 块钱。\n\n第 $1$ 局，第 $1$ 个人会抽到序列中的第 $1$ 项；第 $2$ 局，第 $2$ 个人会抽到序列中的第 $2$ 项；第 $3$ 局，第 $3$ 个人会抽到序列中的第 $3$ 项......即：第 $i$ 个人抽完后轮到第 $i+1$ 个人去抽，特别地，第 $n$ 个人抽完后轮到第 $1$ 个人去抽。序列第 $i$ 项被抽到之后，下一个被抽到的将会是第 $i+1$ 项，特别地，序列第 $m$ 项被抽到之后，下一个被抽到的将会是第 $1$ 项。\n\n如果在某一轮，有个人输光了所有的钱，那么这场赌博游戏就会结束，请求出游戏在哪一轮结束，或者判断这个游戏会永远进行下去。", "inputFormat": "第一行包含一个正整数 $n$，表示玩家的个数。\n\n第二行包含 $n$ 个正整数 $a_1,a_2,...,a_n$，依次表示每个玩家一开始持有的钱数。\n\n第一行包含一个正整数 $m$，表示序列的长度。\n\n第四行包含一个长度为 $m$ 的仅包含 `W` 和 `P` 的字符串，表示这个序列，其中 `W` 表示 $1$，`P` 表示 $-1$。", "outputFormat": "若游戏会永远进行下去，输出 `-1`。否则输出游戏在哪一轮结束。", "hint": "对于 $100\\%$ 的数据，$1\\le n\\le 10^6$，$1\\le a_i\\le 10^6$，$1\\le m\\le 10^6$。", "locale": "zh-CN"}}}
{"pid": "P5582", "type": "P", "difficulty": 3, "samples": [["3\n5 4\n1 2 3 4\n5 4\n1 2 4 5\n6 3\n1 3 5", "-1\n5\n-1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000], "memory": [25600, 25600, 25600, 25600, 25600, 25600]}, "tags": ["2019"], "title": "「SWTR-1」Escape", "background": "有一天，当 $\\mathrm{Sunny}$ 闲逛的时候，发现了一个按钮。\n\n好奇心驱使他按下了这个按钮。\n\n突然间，天旋地转 $\\dots$", "description": "醒来之后，$\\mathrm{Sunny}$ 发现自己站在一个奇怪的地方。\n\n这个地方有 $n$ 个平台，**形成了一个环**。\n\n这时，$\\mathrm{Ethan}$ 的声音响起：\n\n“哈哈哈哈哈哈，恭喜你，你是第一个来到**死亡之地**的人。”\n\n“正如你所看到的，这个地方有 $n$ 个平台，你现在站在 $0$ 号平台上。”\n\n“剩余平台按顺时针编号 $1,2,3\\dots n-1$，也就是说，你身后的那个平台就是 $n-1$ 号平台。”\n\n“你每次能够**顺时针**跳 $i$ 个平台，$i\\in[1,n]$，每次的 $i$ 可以不一样。”\n\n“如果你能够经过所有平台（初始 $0$ 号位置不算），那你就能逃出**死亡之地**了。”\n\n（这里指的是一开始的 $0$ 号位置不算经过，需要再次经过 $0$ 号位置）\n\n“不过，这样太简单了，我会给你一些数 $a_j$，表示你**不能一次顺时针跳 $a_j$ 个平台**。”\n\n“还有，你必须要用**最少**的跳跃次数完成我的任务。”\n\n“如果你不能满足我的上面两个要求，所有平台就会消失，你将会掉入下面的岩浆之中。”\n\n现在，$\\mathrm{Sunny}$ 想知道他是否可能逃出这个地方。\n\n如果不行，输出```-1```，否则输出他最少所需的跳跃次数。\n\n因为 $\\mathrm{Sunny}$ 觉得死亡之地实在是太有趣了，所以他决定多玩几次，**多组数据**。", "inputFormat": "第一行，一个正整数 $T$，代表数据组数。\n\n接下来 $2\\times T$ 行，共 $T$ 组数据：\n\n第 $2\\times i-1$ 行，两个整数 $n,k$，$k$ 代表该组数据 $a_j$ 的个数。\n\n第 $2\\times i$ 行，$k$ 个数，第 $j$ 个数表示 $a_j$。", "outputFormat": "$T$ 行，第 $i$ 行表示第 $i$ 组数据的输出。", "hint": "---\n\n### 样例说明\n\n第一组数据：\n\n$\\mathrm{Sunny}$ 每次只能顺时针跳 $5$ 个平台，易知不可能完成。\n\n第二组数据：\n\n$\\mathrm{Sunny}$ 每次只能顺时针跳 $3$ 个平台，跳 $5$ 次即可。\n\n---\n\n### 数据范围与约定\n\n$0\\leq k\\leq n\\leq 10^6,1\\leq n$。\n\n保证 $\\sum{n_i}\\leq 3*10^6,a_j\\leq n$，且**互不相同**。\n\n测试点 $1:5\\%,n=1$。\n\n测试点 $2:5\\%,n\\leq5$。\n\n测试点 $3:10\\%,n\\leq15$。\n\n测试点 $4:15\\%,n\\leq300$。\n\n测试点 $5:25\\%,n\\leq5000$。\n\n测试点 $6:40\\%,n\\leq10^6$。\n\n---\n\n梦醒了……", "locale": "zh-CN", "translations": {"en": {"title": "\"SWTR-1\" Escape", "background": "One day, when $\\mathrm{Sunny}$ was strolling around, he found a button.\n\nCuriosity drove him to press the button.\n\nSuddenly, the world spun $\\dots$", "description": "After waking up, $\\mathrm{Sunny}$ found himself standing in a strange place.\n\nThis place has $n$ platforms, **forming a ring**.\n\nAt this moment, $\\mathrm{Ethan}$'s voice sounded:\n\n\"Ha ha ha ha ha, congratulations. You are the first person to come to the **Land of Death**.\"\n\n\"As you can see, this place has $n$ platforms, and you are now standing on platform $0$.\"\n\n\"The remaining platforms are numbered clockwise as $1,2,3\\dots n-1$. That is, the platform behind you is platform $n-1$.\"\n\n\"Each time, you can jump **clockwise** by $i$ platforms, where $i\\in[1,n]$, and $i$ may be different each time.\"\n\n\"If you can visit all platforms (the initial position $0$ does not count), then you can escape from the **Land of Death**.\"\n\n(Here, the initial position $0$ does not count as visited; you need to visit platform $0$ again.)\n\n\"However, that is too easy. I will give you some numbers $a_j$, meaning you **cannot jump clockwise by $a_j$ platforms in one move**.\"\n\n\"Also, you must complete my task using the **minimum** number of jumps.\"\n\n\"If you cannot satisfy the above two requirements, all platforms will disappear, and you will fall into the lava below.\"\n\nNow, $\\mathrm{Sunny}$ wants to know whether it is possible for him to escape this place.\n\nIf not, output ```-1```. Otherwise, output the minimum number of jumps he needs.\n\nBecause $\\mathrm{Sunny}$ thinks the Land of Death is really interesting, he decided to play a few more times, **multiple test cases**.", "inputFormat": "The first line contains a positive integer $T$, which represents the number of test cases.\n\nIn the next $2\\times T$ lines, there are $T$ test cases in total:\n\nLine $2\\times i-1$ contains two integers $n,k$, where $k$ is the number of $a_j$ in this test case.\n\nLine $2\\times i$ contains $k$ numbers, and the $j$-th number is $a_j$.", "outputFormat": "Output $T$ lines. The $i$-th line is the answer for the $i$-th test case.", "hint": "---\n\n### Sample Explanation\n\nThe first test case:\n\n$\\mathrm{Sunny}$ can only jump clockwise by $5$ platforms each time, so it is clearly impossible to complete the task.\n\nThe second test case:\n\n$\\mathrm{Sunny}$ can only jump clockwise by $3$ platforms each time, and he can do it in $5$ jumps.\n\n---\n\n### Constraints and Notes\n\n$0\\leq k\\leq n\\leq 10^6,1\\leq n$。\n\nIt is guaranteed that $\\sum{n_i}\\leq 3*10^6,a_j\\leq n$, and they are **pairwise distinct**.\n\nTest point $1:5\\%,n=1$.\n\nTest point $2:5\\%,n\\leq5$.\n\nTest point $3:10\\%,n\\leq15$.\n\nTest point $4:15\\%,n\\leq300$.\n\nTest point $5:25\\%,n\\leq5000$.\n\nTest point $6:40\\%,n\\leq10^6$.\n\n---\n\nThe dream woke up……\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「SWTR-1」Escape", "background": "有一天，当 $\\mathrm{Sunny}$ 闲逛的时候，发现了一个按钮。\n\n好奇心驱使他按下了这个按钮。\n\n突然间，天旋地转 $\\dots$", "description": "醒来之后，$\\mathrm{Sunny}$ 发现自己站在一个奇怪的地方。\n\n这个地方有 $n$ 个平台，**形成了一个环**。\n\n这时，$\\mathrm{Ethan}$ 的声音响起：\n\n“哈哈哈哈哈哈，恭喜你，你是第一个来到**死亡之地**的人。”\n\n“正如你所看到的，这个地方有 $n$ 个平台，你现在站在 $0$ 号平台上。”\n\n“剩余平台按顺时针编号 $1,2,3\\dots n-1$，也就是说，你身后的那个平台就是 $n-1$ 号平台。”\n\n“你每次能够**顺时针**跳 $i$ 个平台，$i\\in[1,n]$，每次的 $i$ 可以不一样。”\n\n“如果你能够经过所有平台（初始 $0$ 号位置不算），那你就能逃出**死亡之地**了。”\n\n（这里指的是一开始的 $0$ 号位置不算经过，需要再次经过 $0$ 号位置）\n\n“不过，这样太简单了，我会给你一些数 $a_j$，表示你**不能一次顺时针跳 $a_j$ 个平台**。”\n\n“还有，你必须要用**最少**的跳跃次数完成我的任务。”\n\n“如果你不能满足我的上面两个要求，所有平台就会消失，你将会掉入下面的岩浆之中。”\n\n现在，$\\mathrm{Sunny}$ 想知道他是否可能逃出这个地方。\n\n如果不行，输出```-1```，否则输出他最少所需的跳跃次数。\n\n因为 $\\mathrm{Sunny}$ 觉得死亡之地实在是太有趣了，所以他决定多玩几次，**多组数据**。", "inputFormat": "第一行，一个正整数 $T$，代表数据组数。\n\n接下来 $2\\times T$ 行，共 $T$ 组数据：\n\n第 $2\\times i-1$ 行，两个整数 $n,k$，$k$ 代表该组数据 $a_j$ 的个数。\n\n第 $2\\times i$ 行，$k$ 个数，第 $j$ 个数表示 $a_j$。", "outputFormat": "$T$ 行，第 $i$ 行表示第 $i$ 组数据的输出。", "hint": "---\n\n### 样例说明\n\n第一组数据：\n\n$\\mathrm{Sunny}$ 每次只能顺时针跳 $5$ 个平台，易知不可能完成。\n\n第二组数据：\n\n$\\mathrm{Sunny}$ 每次只能顺时针跳 $3$ 个平台，跳 $5$ 次即可。\n\n---\n\n### 数据范围与约定\n\n$0\\leq k\\leq n\\leq 10^6,1\\leq n$。\n\n保证 $\\sum{n_i}\\leq 3*10^6,a_j\\leq n$，且**互不相同**。\n\n测试点 $1:5\\%,n=1$。\n\n测试点 $2:5\\%,n\\leq5$。\n\n测试点 $3:10\\%,n\\leq15$。\n\n测试点 $4:15\\%,n\\leq300$。\n\n测试点 $5:25\\%,n\\leq5000$。\n\n测试点 $6:40\\%,n\\leq10^6$。\n\n---\n\n梦醒了……", "locale": "zh-CN"}}}
{"pid": "P5583", "type": "P", "difficulty": 4, "samples": [["5 7 4\n1 3 4 5\n3 3 4 6 5\n4 2 1 5\n2 3 1 7 3\n5 2 2 4\n6 6 3 5 4 6 1 7", "2 4"], ["2 3 2\n1 2\n4 1 1\n4 2 1 3", "-1"], ["4 3 2\n1 2\n1 1 3\n1 2 1 2\n1 1 2\n1 3 1 2 3", "2 3"]], "limits": {"time": [300, 300, 300, 300, 300, 300, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 300, 1000, 1000, 300, 300, 1000, 300, 300], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["2019", "Special Judge"], "title": "「SWTR-1」Ethan and Sets", "background": "", "description": "$\\mathrm{Ethan}$ 有 $n$ 个数字集合，每个集合有如下属性：\n\n编号：第 $i$ 个集合编号为 $i$。\n\n大小：第 $i$ 个集合大小为 $num_i$。\n\n魔力：第 $i$ 个集合魔力为 $t_i$。\n\n数字：第 $i$ 个集合中含有数字 $c_{i,1},c_{i,2},\\dots,c_{i,num_i}$。\n\n在 $\\mathrm{Ethan}$ 的世界中，一共只有 $m+1$ 个数：$0$ 到 $m$。\n\n$\\mathrm{Ethan}$ 对数字有奇特的感情，在这 $m+1$ 个数中，有 $d$ 个数是他喜欢的，分别是 $p_1,p_2,\\dots,p_d$ ，剩下 $m-d+1$ 个是他不喜欢的。\n\n现在 $\\mathrm{Ethan}$ 要删除一些集合，准确来说，他要选择一段区间 $[L,R]$，**删除所有编号在这个区间以外的集合**。\n\n- 他想要使得在剩余的集合中，包含**所有**他喜欢的数。\n\n- 并且在剩余的集合中，他**不喜欢的数的个数尽可能小**（注：这里的个数是指出现的次数，即如果 $1$ 是 $\\mathrm{Ethan}$ 不喜欢的数，并且剩余的集合中出现了 $3$ 个 $1$，那么算 $3$ 个不喜欢的数）。\n\n- 如果有多个满足条件的区间，他想要使得剩余集合的**魔力之和尽可能大**。\n\n求出满足要求的 $[L,R]$，如果无解输出 $-1$，如果有多解，输出任意一解。", "inputFormat": "第一行三个整数 $n,m,d$。\n\n第二行 $d$ 个整数 $p_1,p_2,\\dots,p_d$。\n\n第三行至第 $n+2$ 行：每行先是两个整数 $t_i,num_i$，随后 $num_i$ 个整数 $c_{i,1},c_{i,2},\\dots,c_{i,num_i}$。", "outputFormat": "一行，如果无解输出 $-1$，否则输出两个整数 $L,R$。", "hint": "---\n\n### 样例解释：\n\n在样例 $1$ 中，$\\mathrm{Ethan}$  可以选择 $[2,4]$，这样在剩余的集合中包含了所有他喜欢的数，且只有 $2$ 个他不喜欢的数在这些集合中出现。\n\n在样例 $2$ 中，不存在合法的解。\n\n---\n\n### 数据范围：\n\n本题使用 subtask。\n\nsubtask 1，$1 \\leq n,m \\leq 100$，$20\\%$。\n\nsubtask 2，$1 \\leq n,m \\leq 500$，$30\\%$。\n\nsubtask 3，$1 \\leq n \\leq 3000, 1 \\leq m \\leq 1000, 1 \\leq t_i \\leq 10^9$，$50\\%$。", "locale": "zh-CN", "translations": {"en": {"title": "\"SWTR-1\" Ethan and Sets", "background": "", "description": "$\\mathrm{Ethan}$ has $n$ sets of numbers. Each set has the following properties:\n\nID: The ID of the $i$-th set is $i$.\n\nSize: The size of the $i$-th set is $num_i$.\n\nMagic power: The magic power of the $i$-th set is $t_i$.\n\nNumbers: The $i$-th set contains numbers $c_{i,1},c_{i,2},\\dots,c_{i,num_i}$.\n\nIn Ethan's world, there are only $m+1$ numbers in total: from $0$ to $m$.\n\n$\\mathrm{Ethan}$ has special feelings about numbers. Among these $m+1$ numbers, there are $d$ numbers that he likes, namely $p_1,p_2,\\dots,p_d$. The remaining $m-d+1$ numbers are those he does not like.\n\nNow $\\mathrm{Ethan}$ wants to delete some sets. More precisely, he wants to choose an interval $[L,R]$ and **delete all sets whose IDs are outside this interval**.\n\n- He wants the remaining sets to contain **all** the numbers he likes.\n\n- Also, among the remaining sets, the **total count of numbers he does not like** should be as small as possible (note: this count means occurrences. For example, if $1$ is a number that $\\mathrm{Ethan}$ does not like, and there are $3$ occurrences of $1$ in the remaining sets, then it counts as $3$ disliked numbers).\n\n- If there are multiple intervals that satisfy the above, he wants the **sum of magic power** of the remaining sets to be as large as possible.\n\nFind an interval $[L,R]$ that meets the requirements. If there is no solution, output $-1$. If there are multiple solutions, output any one.", "inputFormat": "The first line contains three integers $n,m,d$.\n\nThe second line contains $d$ integers $p_1,p_2,\\dots,p_d$.\n\nLines $3$ to $n+2$: each line starts with two integers $t_i,num_i$, followed by $num_i$ integers $c_{i,1},c_{i,2},\\dots,c_{i,num_i}$.", "outputFormat": "Output one line. If there is no solution, output $-1$. Otherwise, output two integers $L,R$.", "hint": "---\n\n### Sample Explanation:\n\nIn sample $1$, $\\mathrm{Ethan}$ can choose $[2,4]$. Then the remaining sets contain all the numbers he likes, and there are only $2$ occurrences of numbers he does not like in these sets.\n\nIn sample $2$, there is no valid solution.\n\n---\n\n### Constraints:\n\nThis problem uses subtasks.\n\nSubtask 1: $1 \\leq n,m \\leq 100$, $20\\%$.\n\nSubtask 2: $1 \\leq n,m \\leq 500$, $30\\%$.\n\nSubtask 3: $1 \\leq n \\leq 3000, 1 \\leq m \\leq 1000, 1 \\leq t_i \\leq 10^9$, $50\\%$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「SWTR-1」Ethan and Sets", "background": "", "description": "$\\mathrm{Ethan}$ 有 $n$ 个数字集合，每个集合有如下属性：\n\n编号：第 $i$ 个集合编号为 $i$。\n\n大小：第 $i$ 个集合大小为 $num_i$。\n\n魔力：第 $i$ 个集合魔力为 $t_i$。\n\n数字：第 $i$ 个集合中含有数字 $c_{i,1},c_{i,2},\\dots,c_{i,num_i}$。\n\n在 $\\mathrm{Ethan}$ 的世界中，一共只有 $m+1$ 个数：$0$ 到 $m$。\n\n$\\mathrm{Ethan}$ 对数字有奇特的感情，在这 $m+1$ 个数中，有 $d$ 个数是他喜欢的，分别是 $p_1,p_2,\\dots,p_d$ ，剩下 $m-d+1$ 个是他不喜欢的。\n\n现在 $\\mathrm{Ethan}$ 要删除一些集合，准确来说，他要选择一段区间 $[L,R]$，**删除所有编号在这个区间以外的集合**。\n\n- 他想要使得在剩余的集合中，包含**所有**他喜欢的数。\n\n- 并且在剩余的集合中，他**不喜欢的数的个数尽可能小**（注：这里的个数是指出现的次数，即如果 $1$ 是 $\\mathrm{Ethan}$ 不喜欢的数，并且剩余的集合中出现了 $3$ 个 $1$，那么算 $3$ 个不喜欢的数）。\n\n- 如果有多个满足条件的区间，他想要使得剩余集合的**魔力之和尽可能大**。\n\n求出满足要求的 $[L,R]$，如果无解输出 $-1$，如果有多解，输出任意一解。", "inputFormat": "第一行三个整数 $n,m,d$。\n\n第二行 $d$ 个整数 $p_1,p_2,\\dots,p_d$。\n\n第三行至第 $n+2$ 行：每行先是两个整数 $t_i,num_i$，随后 $num_i$ 个整数 $c_{i,1},c_{i,2},\\dots,c_{i,num_i}$。", "outputFormat": "一行，如果无解输出 $-1$，否则输出两个整数 $L,R$。", "hint": "---\n\n### 样例解释：\n\n在样例 $1$ 中，$\\mathrm{Ethan}$  可以选择 $[2,4]$，这样在剩余的集合中包含了所有他喜欢的数，且只有 $2$ 个他不喜欢的数在这些集合中出现。\n\n在样例 $2$ 中，不存在合法的解。\n\n---\n\n### 数据范围：\n\n本题使用 subtask。\n\nsubtask 1，$1 \\leq n,m \\leq 100$，$20\\%$。\n\nsubtask 2，$1 \\leq n,m \\leq 500$，$30\\%$。\n\nsubtask 3，$1 \\leq n \\leq 3000, 1 \\leq m \\leq 1000, 1 \\leq t_i \\leq 10^9$，$50\\%$。", "locale": "zh-CN"}}}
{"pid": "P5584", "type": "P", "difficulty": 5, "samples": [["5 4\n1 4 2 4 5", "2\n4 2"], ["5 2\n1 2 2 2 2", "4\n2 3 4 5"], ["5 8\n6 10 4 7 8", "2\n4 5"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2019", "线段树", "Special Judge", "O2优化"], "title": "「SWTR-1」Sunny's Crystals", "background": "小 $\\mathrm{S}$ 喜欢收集水晶。", "description": "小 $\\mathrm{S}$ 有 $n$ 个水晶，每个水晶有一个属性 $d_i$ ，为这个水晶的**价值**。\n\n有一天，小 $\\mathrm{A}$ 来到了 小 $\\mathrm{S}$ 家，让 小 $\\mathrm{S}$ 把他的水晶排成一个序列，并且摧毁所有价值为 $w$ 的水晶。\n\n但是，由于这个序列的特殊性，你的每次摧毁必须要满足：\n\n- 该水晶在序列里的位置**必须要是 $2$ 的次幂**，即你只能摧毁在 $2^x$ 这个位置上的水晶，$0\\leq x \\leq \\log_2 y$ 且为整数，其中 $y$ 为现在序列里水晶的个数。\n\n摧毁后，**所有在该水晶后面的水晶都会向前移动一格**。\n\n例如，水晶价值序列 $6\\  10\\  4\\  7\\  8$，你只能摧毁位置为 $1,2,4$ 上的水晶。\n\n如果摧毁 $2$ 号水晶，序列就会变成 $6\\  4\\  7\\  8$。\n\n为了节省时间，小 $\\mathrm{S}$ 想知道**最少**多少次可以摧毁所有价值为 $w$ 的水晶，且第 $i$ 次摧毁的水晶初始位置是什么。\n\n**本题使用 Special Judge**，如果有多种答案，任意输出一种即可。", "inputFormat": "第一行两个整数 $n,w$。\n\n第二行，$n$ 个正整数 $d_i$。", "outputFormat": "第一行一个整数 $m$，表示最少可以摧毁所有 $w$ 的次数。\n\n接下来一行 $m$ 个数，第 $i$ 个数表示 第 $i$ 次摧毁时被摧毁的水晶的**初始位置**是什么，**用空格隔开**。\n", "hint": "---\n\n### 样例说明\n\n样例 $1$：\n\n先摧毁后面的 $4$，初始位置为 $4$，**价值**序列变成： $1\\  4\\  2\\  5$。\n\n再摧毁前面的 $4$，初始位置为 $2$。\n\n总次数是 $2$ 次。\n\n样例 $2$：\n\n先摧毁第 $1$ 个 $2$，初始位置为 $2$，序列变成：$1\\  2\\  2\\  2$。\n\n再摧毁剩下的第 $1$ 个 $2$，初始位置为 $3$，序列变成：$1\\  2\\  2$。\n\n再摧毁第一个 $2$，初始位置为 $4$，序列变成：$1\\  2$。\n\n再摧毁第一个 $2$，初始位置为 $5$。\n\n总次数是 $4$ 次。\n\n---\n\n### 数据范围与约定\n\n对于 $15\\%$ 的数据，有 $n\\leq5$。\n\n对于 $25\\%$ 的数据，有 $n\\leq20$。\n\n对于 $30\\%$ 的数据，有 $n\\leq1000$。\n\n对于 $35\\%$ 的数据，有 $n\\leq10000$。\n\n对于 $50\\%$ 的数据，有 $n\\leq3\\times 10^5$。\n\n对于 $80\\%$ 的数据，有 $n\\leq10^6$。\n\n对于 $100\\%$ 的数据，有 $1\\leq n\\leq3\\times 10^6,1\\leq d_i\\leq 40000$，保证 $w$ 的个数不大于 $1.5\\times 10^6$。\n\n---\n\n碎掉的水晶在阳光下闪闪发光……", "locale": "zh-CN", "translations": {"en": {"title": "\"SWTR-1\" Sunny's Crystals", "background": "Little $\\mathrm{S}$ likes collecting crystals.", "description": "Little $\\mathrm{S}$ has $n$ crystals. Each crystal has an attribute $d_i$, which is the **value** of this crystal.\n\nOne day, Little $\\mathrm{A}$ came to Little $\\mathrm{S}$'s home and asked Little $\\mathrm{S}$ to arrange the crystals into a sequence, and destroy all crystals whose value is $w$.\n\nHowever, due to the special property of this sequence, each destruction must satisfy:\n\n- The crystal's position in the sequence **must be a power of $2$**. That is, you can only destroy crystals at position $2^x$, where $0 \\leq x \\leq \\log_2 y$ and $x$ is an integer, and $y$ is the current number of crystals in the sequence.\n\nAfter destroying one crystal, **all crystals after it move forward by one position**.\n\nFor example, for the value sequence $6\\  10\\  4\\  7\\  8$, you can only destroy crystals at positions $1,2,4$.\n\nIf you destroy the crystal at position $2$, the sequence becomes $6\\  4\\  7\\  8$.\n\nTo save time, Little $\\mathrm{S}$ wants to know the **minimum** number of destructions needed to destroy all crystals with value $w$, and what the initial position of the destroyed crystal is for the $i$-th destruction.\n\n**This problem uses Special Judge**. If there are multiple answers, you may output any one of them.", "inputFormat": "The first line contains two integers $n,w$.\n\nThe second line contains $n$ positive integers $d_i$.", "outputFormat": "The first line contains an integer $m$, meaning the minimum number of destructions needed to destroy all crystals with value $w$.\n\nThe next line contains $m$ numbers. The $i$-th number indicates the **initial position** of the crystal destroyed in the $i$-th destruction, **separated by spaces**.", "hint": "---\n\n### Sample Explanation\n\nSample $1$:\n\nFirst destroy the later $4$, whose initial position is $4$. The **value** sequence becomes: $1\\  4\\  2\\  5$.\n\nThen destroy the earlier $4$, whose initial position is $2$.\n\nThe total number of destructions is $2$.\n\nSample $2$:\n\nFirst destroy the first $2$, whose initial position is $2$, and the sequence becomes: $1\\  2\\  2\\  2$.\n\nThen destroy the remaining first $2$, whose initial position is $3$, and the sequence becomes: $1\\  2\\  2$.\n\nThen destroy the first $2$, whose initial position is $4$, and the sequence becomes: $1\\  2$.\n\nThen destroy the first $2$, whose initial position is $5$.\n\nThe total number of destructions is $4$.\n\n---\n\n### Constraints and Notes\n\nFor $15\\%$ of the testdata, $n \\leq 5$.\n\nFor $25\\%$ of the testdata, $n \\leq 20$.\n\nFor $30\\%$ of the testdata, $n \\leq 1000$.\n\nFor $35\\%$ of the testdata, $n \\leq 10000$.\n\nFor $50\\%$ of the testdata, $n \\leq 3 \\times 10^5$.\n\nFor $80\\%$ of the testdata, $n \\leq 10^6$.\n\nFor $100\\%$ of the testdata, $1 \\leq n \\leq 3 \\times 10^6, 1 \\leq d_i \\leq 40000$. It is guaranteed that the number of $w$ is no more than $1.5 \\times 10^6$.\n\n---\n\nThe shattered crystals sparkle under the sunlight...\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「SWTR-1」Sunny's Crystals", "background": "小 $\\mathrm{S}$ 喜欢收集水晶。", "description": "小 $\\mathrm{S}$ 有 $n$ 个水晶，每个水晶有一个属性 $d_i$ ，为这个水晶的**价值**。\n\n有一天，小 $\\mathrm{A}$ 来到了 小 $\\mathrm{S}$ 家，让 小 $\\mathrm{S}$ 把他的水晶排成一个序列，并且摧毁所有价值为 $w$ 的水晶。\n\n但是，由于这个序列的特殊性，你的每次摧毁必须要满足：\n\n- 该水晶在序列里的位置**必须要是 $2$ 的次幂**，即你只能摧毁在 $2^x$ 这个位置上的水晶，$0\\leq x \\leq \\log_2 y$ 且为整数，其中 $y$ 为现在序列里水晶的个数。\n\n摧毁后，**所有在该水晶后面的水晶都会向前移动一格**。\n\n例如，水晶价值序列 $6\\  10\\  4\\  7\\  8$，你只能摧毁位置为 $1,2,4$ 上的水晶。\n\n如果摧毁 $2$ 号水晶，序列就会变成 $6\\  4\\  7\\  8$。\n\n为了节省时间，小 $\\mathrm{S}$ 想知道**最少**多少次可以摧毁所有价值为 $w$ 的水晶，且第 $i$ 次摧毁的水晶初始位置是什么。\n\n**本题使用 Special Judge**，如果有多种答案，任意输出一种即可。", "inputFormat": "第一行两个整数 $n,w$。\n\n第二行，$n$ 个正整数 $d_i$。", "outputFormat": "第一行一个整数 $m$，表示最少可以摧毁所有 $w$ 的次数。\n\n接下来一行 $m$ 个数，第 $i$ 个数表示 第 $i$ 次摧毁时被摧毁的水晶的**初始位置**是什么，**用空格隔开**。\n", "hint": "---\n\n### 样例说明\n\n样例 $1$：\n\n先摧毁后面的 $4$，初始位置为 $4$，**价值**序列变成： $1\\  4\\  2\\  5$。\n\n再摧毁前面的 $4$，初始位置为 $2$。\n\n总次数是 $2$ 次。\n\n样例 $2$：\n\n先摧毁第 $1$ 个 $2$，初始位置为 $2$，序列变成：$1\\  2\\  2\\  2$。\n\n再摧毁剩下的第 $1$ 个 $2$，初始位置为 $3$，序列变成：$1\\  2\\  2$。\n\n再摧毁第一个 $2$，初始位置为 $4$，序列变成：$1\\  2$。\n\n再摧毁第一个 $2$，初始位置为 $5$。\n\n总次数是 $4$ 次。\n\n---\n\n### 数据范围与约定\n\n对于 $15\\%$ 的数据，有 $n\\leq5$。\n\n对于 $25\\%$ 的数据，有 $n\\leq20$。\n\n对于 $30\\%$ 的数据，有 $n\\leq1000$。\n\n对于 $35\\%$ 的数据，有 $n\\leq10000$。\n\n对于 $50\\%$ 的数据，有 $n\\leq3\\times 10^5$。\n\n对于 $80\\%$ 的数据，有 $n\\leq10^6$。\n\n对于 $100\\%$ 的数据，有 $1\\leq n\\leq3\\times 10^6,1\\leq d_i\\leq 40000$，保证 $w$ 的个数不大于 $1.5\\times 10^6$。\n\n---\n\n碎掉的水晶在阳光下闪闪发光……", "locale": "zh-CN"}}}
{"pid": "P5585", "type": "P", "difficulty": 5, "samples": [["30 4\n3\n5 3 8\n3 2 2\n8 4 4", "4 2"], ["100 3\n2\n3 2 8\n2 1 5", "8 57"]], "limits": {"time": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 1000, 1000, 1000, 1000, 1000], "memory": [8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192, 262144, 262144, 262144, 262144, 262144, 8192, 8192, 8192, 8192, 8192]}, "tags": ["动态规划 DP", "2019"], "title": "「SWTR-1」Doing Homework", "background": "小 $\\mathrm{A}$ 每天都有很多作业要写。", "description": "每天，小 $\\mathrm{A}$ 都要写至少 $w$ 吨的作业，如果他达不到目标，就会受到小 $\\mathrm{S}$ 制裁并且当场去世。\n\n小 $\\mathrm{A}$ 有 $x$ 点精力，每次写作业都会降低小 $\\mathrm{A}$ 的精力，且**不可逆**，小 $\\mathrm{A}$ 的精力不可以降为负数。\n\n现在，有 $n$ 种作业给小 $\\mathrm{A}$ 选。\n\n每种作业有如下的属性：\n\n$x_i:$ 消耗的精力，即写一份这种作业需要 $x_i$ 的精力。\n\n$w_i:$ 重量，即这种作业一份有 $w_i$ 吨。\n\n$t_i:$ 截止日期，即从今天过了 $t_i$ 天之后，这个作业不可以再写。\n\n**每种作业都有无限个。**\n\n因为他的作业实在是多得写不完，所以请你为他安排一种写作业的方案，**最大化**他能存活的天数，当存活天数已最大化时，最大化他剩余的精力。", "inputFormat": "第一行两个正整数 $x,w$ ，即小 $\\mathrm{A}$ 的精力和每天的目标。\n\n接下来一行一个正整数 $n$ ，表示作业的种数。\n\n接下来 $n$ 行，每行三个整数 $x_i,w_i,t_i$。", "outputFormat": "输出两个由空格隔开的数，分别表示小 $\\mathrm{A}$ 最多能活多少天，以及剩余的精力。", "hint": "---\n\n### 样例说明\n\n第一天，小 $\\mathrm{A}$ 选择写 $2$ 份第二种作业，重量为 $2 * 2=4$，剩余精力为 $30-2 * 3=24$。\n\n第二天，小 $\\mathrm{A}$ 选择写 $2$ 份第二种作业，重量为 $2 * 2=4$，剩余精力为 $24-2 * 3=18$。\n\n至此，不可以再写第二种作业 $(t_2=2)$。\n\n第三天，小 $\\mathrm{A}$ 选择写 $1$ 份第三种作业，重量为 $4$，剩余精力为 $18-8=10$。\n\n第四天，小 $\\mathrm{A}$ 选择写 $1$ 份第三种作业，重量为 $4$，剩余精力为 $10-8=2$。\n\n至此，不可以再写第三种作业 $(t_3=4)$。\n\n小 $\\mathrm{A}$ 没有精力再去写别的作业了，所以他最多能活 $4$ 天，剩余精力为 $2$。\n\n可以证明，找不到比该方案更优的方案了。\n\n---\n\n### 数据范围\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/meko5h7g.png)\n\n---\n\n对于 $n \\leq 5000$ 中 $25\\%$ 的数据，有时间限制 $1s$，空间限制 $256MB$。\n\n其余测试点时间限制 $400ms$，空间限制 $8MB$。", "locale": "zh-CN", "translations": {"en": {"title": "“SWTR-1” Doing Homework", "background": "Little $\\mathrm{A}$ has a lot of homework to do every day.", "description": "Every day, Little $\\mathrm{A}$ must do at least $w$ tons of homework. If he fails to reach the goal, he will be punished by Little $\\mathrm{S}$ and die on the spot.\n\nLittle $\\mathrm{A}$ has $x$ energy points. Each time he does homework, Little $\\mathrm{A}$’s energy decreases, and this is **irreversible**. Little $\\mathrm{A}$’s energy cannot drop below $0$.\n\nNow, there are $n$ types of homework for Little $\\mathrm{A}$ to choose from.\n\nEach type of homework has the following attributes:\n\n$x_i$: energy cost, i.e., doing one copy of this type of homework requires $x_i$ energy.\n\n$w_i$: weight, i.e., one copy of this type of homework weighs $w_i$ tons.\n\n$t_i$: deadline, i.e., after $t_i$ days from today, this homework can no longer be done.\n\n**There are infinitely many copies of each type of homework.**\n\nSince he has too much homework to ever finish, please arrange a homework plan for him to **maximize** the number of days he can survive. When the number of surviving days is maximized, maximize his remaining energy.", "inputFormat": "The first line contains two positive integers $x, w$, representing Little $\\mathrm{A}$’s energy and the daily goal.\n\nThe next line contains one positive integer $n$, indicating the number of types of homework.\n\nThe next $n$ lines each contain three integers $x_i, w_i, t_i$.", "outputFormat": "Output two numbers separated by a space, representing the maximum number of days Little $\\mathrm{A}$ can survive, and his remaining energy.", "hint": "---\n\n### Sample Explanation\n\nOn day $1$, Little $\\mathrm{A}$ chooses to do $2$ copies of the second type of homework. The weight is $2 * 2 = 4$, and the remaining energy is $30 - 2 * 3 = 24$.\n\nOn day $2$, Little $\\mathrm{A}$ chooses to do $2$ copies of the second type of homework. The weight is $2 * 2 = 4$, and the remaining energy is $24 - 2 * 3 = 18$.\n\nAt this point, he can no longer do the second type of homework $(t_2 = 2)$.\n\nOn day $3$, Little $\\mathrm{A}$ chooses to do $1$ copy of the third type of homework. The weight is $4$, and the remaining energy is $18 - 8 = 10$.\n\nOn day $4$, Little $\\mathrm{A}$ chooses to do $1$ copy of the third type of homework. The weight is $4$, and the remaining energy is $10 - 8 = 2$.\n\nAt this point, he can no longer do the third type of homework $(t_3 = 4)$.\n\nLittle $\\mathrm{A}$ has no energy left to do any other homework, so he can survive at most $4$ days, with $2$ energy remaining.\n\nIt can be proven that no better plan than this one can be found.\n\n---\n\n### Constraints\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/meko5h7g.png)\n\n---\n\nFor $25\\%$ of the testdata with $n \\leq 5000$, the time limit is $1\\ \\mathrm{s}$ and the memory limit is $256\\ \\mathrm{MB}$.\n\nFor the remaining test points, the time limit is $400\\ \\mathrm{ms}$ and the memory limit is $8\\ \\mathrm{MB}$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "「SWTR-1」Doing Homework", "background": "小 $\\mathrm{A}$ 每天都有很多作业要写。", "description": "每天，小 $\\mathrm{A}$ 都要写至少 $w$ 吨的作业，如果他达不到目标，就会受到小 $\\mathrm{S}$ 制裁并且当场去世。\n\n小 $\\mathrm{A}$ 有 $x$ 点精力，每次写作业都会降低小 $\\mathrm{A}$ 的精力，且**不可逆**，小 $\\mathrm{A}$ 的精力不可以降为负数。\n\n现在，有 $n$ 种作业给小 $\\mathrm{A}$ 选。\n\n每种作业有如下的属性：\n\n$x_i:$ 消耗的精力，即写一份这种作业需要 $x_i$ 的精力。\n\n$w_i:$ 重量，即这种作业一份有 $w_i$ 吨。\n\n$t_i:$ 截止日期，即从今天过了 $t_i$ 天之后，这个作业不可以再写。\n\n**每种作业都有无限个。**\n\n因为他的作业实在是多得写不完，所以请你为他安排一种写作业的方案，**最大化**他能存活的天数，当存活天数已最大化时，最大化他剩余的精力。", "inputFormat": "第一行两个正整数 $x,w$ ，即小 $\\mathrm{A}$ 的精力和每天的目标。\n\n接下来一行一个正整数 $n$ ，表示作业的种数。\n\n接下来 $n$ 行，每行三个整数 $x_i,w_i,t_i$。", "outputFormat": "输出两个由空格隔开的数，分别表示小 $\\mathrm{A}$ 最多能活多少天，以及剩余的精力。", "hint": "---\n\n### 样例说明\n\n第一天，小 $\\mathrm{A}$ 选择写 $2$ 份第二种作业，重量为 $2 * 2=4$，剩余精力为 $30-2 * 3=24$。\n\n第二天，小 $\\mathrm{A}$ 选择写 $2$ 份第二种作业，重量为 $2 * 2=4$，剩余精力为 $24-2 * 3=18$。\n\n至此，不可以再写第二种作业 $(t_2=2)$。\n\n第三天，小 $\\mathrm{A}$ 选择写 $1$ 份第三种作业，重量为 $4$，剩余精力为 $18-8=10$。\n\n第四天，小 $\\mathrm{A}$ 选择写 $1$ 份第三种作业，重量为 $4$，剩余精力为 $10-8=2$。\n\n至此，不可以再写第三种作业 $(t_3=4)$。\n\n小 $\\mathrm{A}$ 没有精力再去写别的作业了，所以他最多能活 $4$ 天，剩余精力为 $2$。\n\n可以证明，找不到比该方案更优的方案了。\n\n---\n\n### 数据范围\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/meko5h7g.png)\n\n---\n\n对于 $n \\leq 5000$ 中 $25\\%$ 的数据，有时间限制 $1s$，空间限制 $256MB$。\n\n其余测试点时间限制 $400ms$，空间限制 $8MB$。", "locale": "zh-CN"}}}
{"pid": "P5586", "type": "P", "difficulty": 6, "samples": [["10 10\n7 1 3 2 2 4 0 1 2 2 \n4 10 10 3 3\n3 4 10 5\n6 6 7\n6 9 10\n1 10 10\n5 14 13 1 0\n2 15 13 7\n5 3 3 2 2\n5 5 3 15 13\n3 4 14 7", "7\n7 0 0 0 7 7 7 1 2 7"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144]}, "tags": ["平衡树", "洛谷原创", "O2优化", "可持久化"], "title": "[P5350] 序列 (加强版)", "background": "本题为 [P5350](https://www.luogu.org/problem/P5350) 的加强版。  \n本题很良心，不卡空间！", "description": "有一个序列 $a_n$ 和 $q$ 次操作。\n\n- `1 l r` 求区间 $[l,r]$ 的和  \n- `2 l r k` 区间 $[l,r]$ 赋值为 $k$  \n- `3 l r k` 区间 $[l,r]$ 加上 $k$  \n- `4 l1 r1 l2 r2` 将区间 $[l_1,r_1]$ 复制到 $[l_2,r_2]$ 处  \n- `5 l1 r1 l2 r2` 将区间 $[l_1,r_1]$ 与 $[l_2,r_2]$ 交换  \n- `6 l r` 翻转区间 $[l,r]$\n\n最后还要输出整个序列，所有输出都要对 $10^9+7$ 取模。\n\n为了卡掉某些乱搞做法，**本题强制在线**。  \n\n每次操作中，除了输入第一个数，其它所有数都需要异或 $\\text{last}$ 才是实际的操作。  \n$\\text{last}$ 为上一次 $1$ 操作的答案 $\\pmod{10^9 +7}$，定义初始 $\\text{last} = 0$。", "inputFormat": "第一行两个正整数 $n,q$，表示序列长度与操作个数。  \n第二行 $n$ 个正整数，表示序列 $a$  \n接下来 $q$ 行，每行表示一次操作。", "outputFormat": "对于每次操作，输出一行一个整数表示答案。  \n最后一行输出 $n$ 个整数，表示最终的序列 $a$。", "hint": "【数据范围】   \n$1\\le n,q \\le 3\\times 10^5$  \n$0\\le a_i,k \\le 10^9$   \n对于 $4,5$ 操作，保证 $r_1-l_1 = r_2-l_2$ 且 $[l_1,r_1] \\cap [l_2,r_2] = \\varnothing$\n\n**不保证数据随机** 且 **没有梯度**   \n想交 ODT 的就算了吧！", "locale": "zh-CN", "translations": {"en": {"title": "[P5350] Sequence (Enhanced Version)", "background": "This problem is an enhanced version of [P5350](https://www.luogu.org/problem/P5350).  \nThis problem is quite friendly and does not try to restrict memory usage.", "description": "There is a sequence $a_n$ and $q$ operations.\n\n- `1 l r` Query the sum of the interval $[l,r]$.  \n- `2 l r k` Assign all values in the interval $[l,r]$ to $k$.  \n- `3 l r k` Add $k$ to all values in the interval $[l,r]$.  \n- `4 l1 r1 l2 r2` Copy the interval $[l_1,r_1]$ to $[l_2,r_2]$.  \n- `5 l1 r1 l2 r2` Swap the intervals $[l_1,r_1]$ and $[l_2,r_2]$.  \n- `6 l r` Reverse the interval $[l,r]$.  \n\nIn the end, you also need to output the entire sequence. All outputs should be taken modulo $10^9+7$.\n\nTo block some brute-force or hacky solutions, **this problem is strictly online**.\n\nIn each operation, except for the first number, all other numbers must be XORed with $\\text{last}$ to obtain the actual operation.  \n$\\text{last}$ is the answer of the previous type $1$ operation $\\pmod{10^9 + 7}$, and initially $\\text{last} = 0$.", "inputFormat": "The first line contains two positive integers $n,q$, representing the sequence length and the number of operations.  \nThe second line contains $n$ positive integers, representing the sequence $a$.  \nThe next $q$ lines each describe one operation.", "outputFormat": "For each type $1$ operation, output one integer per line as the answer.  \nIn the last line, output $n$ integers, representing the final sequence $a$.", "hint": "Constraints  \n$1\\le n,q \\le 3\\times 10^5$  \n$0\\le a_i,k \\le 10^9$  \nFor operations $4$ and $5$, it is guaranteed that $r_1-l_1 = r_2-l_2$ and $[l_1,r_1] \\cap [l_2,r_2] = \\varnothing$.\n\n**The testdata is not guaranteed to be random**, and there is **no grading by subtasks**.  \nIf you want to submit ODT, just forget it.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[P5350] 序列 (加强版)", "background": "本题为 [P5350](https://www.luogu.org/problem/P5350) 的加强版。  \n本题很良心，不卡空间！", "description": "有一个序列 $a_n$ 和 $q$ 次操作。\n\n- `1 l r` 求区间 $[l,r]$ 的和  \n- `2 l r k` 区间 $[l,r]$ 赋值为 $k$  \n- `3 l r k` 区间 $[l,r]$ 加上 $k$  \n- `4 l1 r1 l2 r2` 将区间 $[l_1,r_1]$ 复制到 $[l_2,r_2]$ 处  \n- `5 l1 r1 l2 r2` 将区间 $[l_1,r_1]$ 与 $[l_2,r_2]$ 交换  \n- `6 l r` 翻转区间 $[l,r]$\n\n最后还要输出整个序列，所有输出都要对 $10^9+7$ 取模。\n\n为了卡掉某些乱搞做法，**本题强制在线**。  \n\n每次操作中，除了输入第一个数，其它所有数都需要异或 $\\text{last}$ 才是实际的操作。  \n$\\text{last}$ 为上一次 $1$ 操作的答案 $\\pmod{10^9 +7}$，定义初始 $\\text{last} = 0$。", "inputFormat": "第一行两个正整数 $n,q$，表示序列长度与操作个数。  \n第二行 $n$ 个正整数，表示序列 $a$  \n接下来 $q$ 行，每行表示一次操作。", "outputFormat": "对于每次操作，输出一行一个整数表示答案。  \n最后一行输出 $n$ 个整数，表示最终的序列 $a$。", "hint": "【数据范围】   \n$1\\le n,q \\le 3\\times 10^5$  \n$0\\le a_i,k \\le 10^9$   \n对于 $4,5$ 操作，保证 $r_1-l_1 = r_2-l_2$ 且 $[l_1,r_1] \\cap [l_2,r_2] = \\varnothing$\n\n**不保证数据随机** 且 **没有梯度**   \n想交 ODT 的就算了吧！", "locale": "zh-CN"}}}
{"pid": "P5587", "type": "P", "difficulty": 3, "samples": [["hello world.\naaabbbb\nx\nEOF\nheelo world.\naaacbbbb\ny<x\nEOF\n60", "18"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["字符串", "栈", "洛谷月赛"], "title": "打字练习", "background": "", "description": "R 君在练习打字。\n\n有这样一个打字练习网站，给定一个范文和输入框，会根据你的输入计算准确率和打字速度。可以输入的字符有小写字母、空格和 `.`（英文句号），输入字符后，光标也会跟着移动。\n\n输入的文本有多行，R 君可以通过换行键来换行，换行后光标移动到下一行的开头。\n\nR 君也可以按退格键（为了方便，退格键用 `<` 表示），以删除上一个打的字符，并将光标回移一格。特殊的，如果此时光标已经在一行的开头，则不能继续退格（即忽略此时输入的退格键）。\n\n网站的比较方式遵循以下两个原则：\n\n- 逐行比较，即对于范文和输入的每一行依次比较，不同行之间不会产生影响，多余的行会被忽略。\n- 逐位比较，即对于两行的每一个字符依次比较，当且仅当字符相同时才会被算作一次正确，否则会被算作错误。计算答案时，只统计相同的字符个数。\n\n需要注意的是，回车键不会被计入正确的字符个数。\n\nR 君看到网站上显示他花了 $T$ 秒完成了这次的打字游戏，请你计算出他的 KPM（Keys per minutes，每分钟输入的字符个数），答案四舍五入保留整数部分。\n", "inputFormat": "R 君会依次告诉你网站的范文，他的输入和花费的时间。\n\n其中范文和输入将会这样读入：给定若干行字符串，以单独的一行 `EOF` 结束，其中 `EOF` 不算入输入的文本。\n\n最后一行一个整数 $T$，表示他打字花费了 $T$ 秒。\n\n可以参考样例输入输出文件和样例解释辅助理解。", "outputFormat": "一行一个整数，表示 KPM。", "hint": "#### 样例解释\n\n第一行的正确字符数为 11。  \n第二行的正确字符数为 6，错误的字符 `c` 仍会占据一个位置。  \n第三行的正确字符数为 1，R 君使用退格键删除了被打错的字符 `y`\n\n#### 数据范围\n\n对于 $20\\%$ 的数据，不存在换行键。  \n对于 $40\\%$ 的数据，不存在退格键。  \n对于 $100\\%$ 的数据，$T \\leq 10^3$，保证每个文本段的总字符数（包括换行）不超过 $10^5$ 个且总行数不超过 $10^4$。\n", "locale": "zh-CN", "translations": {"en": {"title": "Typing Practice.", "background": "", "description": "Mr. R is practicing typing.\n\nThere is a typing practice website. Given a reference text and an input box, it will calculate your accuracy and typing speed based on what you type. The characters you can type are lowercase letters, spaces, and `.` (a period). After you type a character, the cursor moves accordingly.\n\nThe typed text has multiple lines. Mr. R can press the Enter key to start a new line, and after that the cursor moves to the beginning of the next line.\n\nMr. R can also press the Backspace key (for convenience, we use `<` to represent Backspace) to delete the previously typed character and move the cursor back by one position. In particular, if the cursor is already at the beginning of a line, you cannot backspace anymore (i.e., ignore this Backspace input).\n\nThe website compares texts according to the following two rules:\n\n- Compare line by line: compare each line of the reference text and the input in order. Different lines do not affect each other, and extra lines are ignored.\n- Compare position by position: for each character position in a line, compare in order. A character is counted as correct if and only if the characters are the same; otherwise it is counted as wrong. When computing the result, only the number of matching characters is counted.\n\nNote that the Enter key is not included in the number of correct characters.\n\nMr. R sees that the website shows he spent $T$ seconds to finish this typing game. Please compute his KPM (Keys per minutes, the number of characters entered per minute). Round the answer to the nearest integer.", "inputFormat": "Mr. R will provide you with the reference text, his input, and the time spent, in this order.\n\nThe reference text and the input are read as follows: given several lines of strings, ending with a single line `EOF`. The line `EOF` is not part of the text.\n\nThe last line is an integer $T$, meaning he spent $T$ seconds typing.\n\nYou may refer to the sample input/output files and the sample explanation for better understanding.", "outputFormat": "Output one integer on a single line, representing the KPM.", "hint": "#### Sample Explanation\n\nThe number of correct characters in the first line is 11.  \nThe number of correct characters in the second line is 6. The wrong character `c` still takes up one position.  \nThe number of correct characters in the third line is 1. Mr. R used Backspace to delete the incorrectly typed character `y`.\n\n#### Constraints\n\nFor $20\\%$ of the testdata, there is no Enter key.  \nFor $40\\%$ of the testdata, there is no Backspace key.  \nFor $100\\%$ of the testdata, $T \\leq 10^3$, and the total number of characters (including newlines) in each text block is at most $10^5$, and the total number of lines is at most $10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "打字练习", "background": "", "description": "R 君在练习打字。\n\n有这样一个打字练习网站，给定一个范文和输入框，会根据你的输入计算准确率和打字速度。可以输入的字符有小写字母、空格和 `.`（英文句号），输入字符后，光标也会跟着移动。\n\n输入的文本有多行，R 君可以通过换行键来换行，换行后光标移动到下一行的开头。\n\nR 君也可以按退格键（为了方便，退格键用 `<` 表示），以删除上一个打的字符，并将光标回移一格。特殊的，如果此时光标已经在一行的开头，则不能继续退格（即忽略此时输入的退格键）。\n\n网站的比较方式遵循以下两个原则：\n\n- 逐行比较，即对于范文和输入的每一行依次比较，不同行之间不会产生影响，多余的行会被忽略。\n- 逐位比较，即对于两行的每一个字符依次比较，当且仅当字符相同时才会被算作一次正确，否则会被算作错误。计算答案时，只统计相同的字符个数。\n\n需要注意的是，回车键不会被计入正确的字符个数。\n\nR 君看到网站上显示他花了 $T$ 秒完成了这次的打字游戏，请你计算出他的 KPM（Keys per minutes，每分钟输入的字符个数），答案四舍五入保留整数部分。\n", "inputFormat": "R 君会依次告诉你网站的范文，他的输入和花费的时间。\n\n其中范文和输入将会这样读入：给定若干行字符串，以单独的一行 `EOF` 结束，其中 `EOF` 不算入输入的文本。\n\n最后一行一个整数 $T$，表示他打字花费了 $T$ 秒。\n\n可以参考样例输入输出文件和样例解释辅助理解。", "outputFormat": "一行一个整数，表示 KPM。", "hint": "#### 样例解释\n\n第一行的正确字符数为 11。  \n第二行的正确字符数为 6，错误的字符 `c` 仍会占据一个位置。  \n第三行的正确字符数为 1，R 君使用退格键删除了被打错的字符 `y`\n\n#### 数据范围\n\n对于 $20\\%$ 的数据，不存在换行键。  \n对于 $40\\%$ 的数据，不存在退格键。  \n对于 $100\\%$ 的数据，$T \\leq 10^3$，保证每个文本段的总字符数（包括换行）不超过 $10^5$ 个且总行数不超过 $10^4$。\n", "locale": "zh-CN"}}}
{"pid": "P5588", "type": "P", "difficulty": 5, "samples": [["4\n1 2 2 3\n1 2\n2 3\n3 4", "3\n4\n3\n6"], ["10\n9 7 4 2 3 4 4 5 8 5\n2 1\n3 2\n4 2\n5 2\n6 4\n7 4\n8 1\n9 4\n10 4", "45\n35\n9\n0\n1\n45\n34\n9\n17\n45"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000]}, "tags": ["树的遍历", "洛谷月赛"], "title": "小猪佩奇爬树", "background": null, "description": "佩奇和乔治在爬♂树。\n\n\n给定 $n$ 个节点的树 $T(V,E)$，第 $i$ 个节点的颜色为 $w_i$，保证有 $1 \\leq w_i \\leq n$。\n\n对于 $1 \\leq i \\leq n$，分别输出有多少对点对 $(u,v)$，满足 $u<v$，且恰好经过**所有**颜色为 $i$ 的节点，对于节点颜色不为 $i$ 的其他节点，经过或不经过均可。\n\n树上路径 $(u,v)$ 定义为序列 $\\{f\\}$，满足 $f_1=u,f_{|f|}=v$，且 $\\forall 1 \\leq i < |f|$，$T$ 中均存在边 $(f_i,f_{i+1})$，且 $\\{f\\}$ 中无重复元素，能够证明对于任意点对 $(u,v)$，其树上路径唯一。", "inputFormat": "第一行 $1$ 个正整数，表示 $n$ 。\n\n第二行 $n$ 个正整数，第 $i$ 个正整数表示 $w_i$。\n\n之后 $n-1$ 行，每行 $2$ 个正整数 $u,v$，表示 $T$ 中存在边 $(u,v)$。", "outputFormat": "共 $n$ 行，每行 $1$ 个正整数，第 $i$ 行输出包含所有颜色为 $i$ 的节点的路径个数。", "hint": "![](https://i.loli.net/2019/10/06/H9LuWl7GSXfs4M6.png)\n\n对于第一组样例而言。\n\n对于颜色 $1$，点对 $(1,2),(1,3),(1,4)$ 满足条件。\n\n对于颜色 $2$，点对 $(1,3),(1,4),(2,3),(2,4)$ 满足条件。\n\n对于颜色 $3$，点对 $(1,4),(2,4),(3,4)$ 满足条件。\n\n对于颜色 $4$，由于图中没有颜色为 $4$ 的节点，所以所有点对均满足条件。\n### 数据范围\n\n对于 $40\\%$ 的数据，$n \\leq 10^2$。\n\n对于 $60\\%$ 的数据，$n \\leq 10^3$。\n\n对于 $100\\%$ 的数据，$n \\leq 10^6$。", "locale": "zh-CN", "translations": {"en": {"title": "Peppa Pig Climbs a Tree", "background": "", "description": "Peppa and George are climbing a tree.\n\nGiven a tree $T(V,E)$ with $n$ nodes, the color of node $i$ is $w_i$, and it is guaranteed that $1 \\leq w_i \\leq n$.\n\nFor each $1 \\leq i \\leq n$, output how many pairs $(u,v)$ satisfy $u<v$, and the path from $u$ to $v$ passes through **all** nodes whose color is $i$. For other nodes whose color is not $i$, the path may pass through them or not.\n\nA tree path $(u,v)$ is defined as a sequence $\\{f\\}$ such that $f_1=u$, $f_{|f|}=v$, and for all $1 \\leq i < |f|$, there is an edge $(f_i,f_{i+1})$ in $T$, and there are no repeated elements in $\\{f\\}$. It can be proven that for any pair $(u,v)$, the tree path is unique.", "inputFormat": "The first line contains one positive integer $n$.\n\nThe second line contains $n$ positive integers, where the $i$-th integer is $w_i$.\n\nThe next $n-1$ lines each contain two positive integers $u,v$, indicating that there is an edge $(u,v)$ in $T$.", "outputFormat": "Output $n$ lines, each containing one positive integer. On the $i$-th line, output the number of paths that contain all nodes whose color is $i$.", "hint": "![](https://i.loli.net/2019/10/06/H9LuWl7GSXfs4M6.png)\n\nFor the first sample.\n\nFor color $1$, the pairs $(1,2),(1,3),(1,4)$ satisfy the condition.\n\nFor color $2$, the pairs $(1,3),(1,4),(2,3),(2,4)$ satisfy the condition.\n\nFor color $3$, the pairs $(1,4),(2,4),(3,4)$ satisfy the condition.\n\nFor color $4$, since there is no node with color $4$ in the graph, all pairs satisfy the condition.\n\n### Constraints\n\nFor $40\\%$ of the testdata, $n \\leq 10^2$.\n\nFor $60\\%$ of the testdata, $n \\leq 10^3$.\n\nFor $100\\%$ of the testdata, $n \\leq 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小猪佩奇爬树", "background": null, "description": "佩奇和乔治在爬♂树。\n\n\n给定 $n$ 个节点的树 $T(V,E)$，第 $i$ 个节点的颜色为 $w_i$，保证有 $1 \\leq w_i \\leq n$。\n\n对于 $1 \\leq i \\leq n$，分别输出有多少对点对 $(u,v)$，满足 $u<v$，且恰好经过**所有**颜色为 $i$ 的节点，对于节点颜色不为 $i$ 的其他节点，经过或不经过均可。\n\n树上路径 $(u,v)$ 定义为序列 $\\{f\\}$，满足 $f_1=u,f_{|f|}=v$，且 $\\forall 1 \\leq i < |f|$，$T$ 中均存在边 $(f_i,f_{i+1})$，且 $\\{f\\}$ 中无重复元素，能够证明对于任意点对 $(u,v)$，其树上路径唯一。", "inputFormat": "第一行 $1$ 个正整数，表示 $n$ 。\n\n第二行 $n$ 个正整数，第 $i$ 个正整数表示 $w_i$。\n\n之后 $n-1$ 行，每行 $2$ 个正整数 $u,v$，表示 $T$ 中存在边 $(u,v)$。", "outputFormat": "共 $n$ 行，每行 $1$ 个正整数，第 $i$ 行输出包含所有颜色为 $i$ 的节点的路径个数。", "hint": "![](https://i.loli.net/2019/10/06/H9LuWl7GSXfs4M6.png)\n\n对于第一组样例而言。\n\n对于颜色 $1$，点对 $(1,2),(1,3),(1,4)$ 满足条件。\n\n对于颜色 $2$，点对 $(1,3),(1,4),(2,3),(2,4)$ 满足条件。\n\n对于颜色 $3$，点对 $(1,4),(2,4),(3,4)$ 满足条件。\n\n对于颜色 $4$，由于图中没有颜色为 $4$ 的节点，所以所有点对均满足条件。\n### 数据范围\n\n对于 $40\\%$ 的数据，$n \\leq 10^2$。\n\n对于 $60\\%$ 的数据，$n \\leq 10^3$。\n\n对于 $100\\%$ 的数据，$n \\leq 10^6$。", "locale": "zh-CN"}}}
{"pid": "P5589", "type": "P", "difficulty": 5, "samples": [["5\n4\n8\n16\n32\n100", "3.50000000\n7.00000000\n13.83333333\n28.33333333\n93.41666667"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "数论", "Special Judge", "期望", "洛谷月赛"], "title": "小猪佩奇玩游戏", "background": "", "description": "佩奇和乔治玩游♂戏。\n\n佩奇在黑板上写下数字 $\\{1,2,\\cdots,n\\}$ ，每次他们会等概率地报出黑板上的一个数字 $x$ ,并删除所有 $x$ 的正整数次幂。\n\n形式化地,给定数列 $\\{1,2,\\cdots,n\\}$ ，每次等概率选出数列中存在的 $1$ 个数字 $x$ ，并将形如 $\\{x^k,k \\in Z^{+}\\}$ 的数字删除。\n\n他们玩了整整一个下午，游戏还是没有结束，所以他们想知道，该游戏期望在多少轮后会结束。\n\n如果你的答案与正确答案的绝对误差在 $10^{-4} $以内，则被判定为正确。", "inputFormat": "第一行 $1$ 个正整数 $t$,表示佩奇和乔治打算玩 $t$ 轮游戏。\n\n之后 $t$ 行,每行 $1$ 个正整数 $n$,表示佩奇在黑板上写下了数字 $\\{1,2,\\cdots,n\\}$ 并将进行游戏。", "outputFormat": "一共 $t$ 行，每行 $1$ 个小数,表示答案，答案保留小数。\n\n如果你的答案与正确答案的绝对误差在 $10^{-4}$以内，则被判定为正确。", "hint": "对于 $n=4$，\n\n若删除的顺序为 $\\{1,2,3\\},\\{3,2,1\\}$, 那么概率为$\\frac{1}{4} \\times \\frac{1}{3} \\times \\frac{1}{1}=\\frac{1}{12}$\n\n若删除的顺序为 $\\{1,3,2\\},\\{3,1,2\\}$, 那么概率为$\\frac{1}{4} \\times \\frac{1}{3} \\times \\frac{1}{2}=\\frac{1}{24}$\n\n若删除的顺序为 $\\{2,1,3\\},\\{2,3,1\\}$, 那么概率为$\\frac{1}{4} \\times \\frac{1}{2} \\times \\frac{1}{1}=\\frac{1}{8}$\n\n对于剩余的 $12$ 种删除了 $4$ 次的序列，概率为$\\frac{1}{4} \\times \\frac{1}{3} \\times \\frac{1}{2} \\times \\frac{1}{1}=\\frac{1}{24}$\n\n容易发现答案即为\n$\\frac{2 \\times 3}{12} + \\frac{2 \\times 3}{24}+\\frac{2 \\times 3}{8} + \\frac{12 \\times 4}{24}=\\frac{7}{2}=3.50000$\n\n### 数据范围\n\n对于 $20\\%$ 的数据, $n \\leq 10$\n\n对于 $60\\%$ 的数据, $n \\leq 10^5$\n\n对于 $100\\%$ 的数据, $n \\leq 10^9,t \\leq 100$\n\n### 出题人善意的提醒\n\n对于 C++ 选手，若对于正整数 $n,k$，希望得到 $\\sqrt[k] n$，请尽量不要使用 C++ 自带的 $\\operatorname{pow}$ 函数，以免可能产生不必要的精度误差。", "locale": "zh-CN", "translations": {"en": {"title": "Peppa Pig Plays a Game", "background": "", "description": "Peppa and George are playing a game.\n\nPeppa writes the numbers $\\{1,2,\\cdots,n\\}$ on the blackboard. Each round, they will choose a number $x$ that is currently on the blackboard uniformly at random, and then delete all positive integer powers of $x$.\n\nFormally, given the sequence $\\{1,2,\\cdots,n\\}$, each time they uniformly select $1$ number $x$ that exists in the sequence, and delete all numbers of the form $\\{x^k,k \\in Z^{+}\\}$.\n\nThey played for a whole afternoon, but the game still did not end, so they want to know: after how many rounds is the game expected to end.\n\nIf the absolute error between your answer and the correct answer is within $10^{-4}$, then it will be judged as correct.", "inputFormat": "The first line contains $1$ positive integer $t$, meaning Peppa and George plan to play $t$ games.\n\nThen follow $t$ lines, each with $1$ positive integer $n$, meaning Peppa wrote the numbers $\\{1,2,\\cdots,n\\}$ on the blackboard and will start the game.", "outputFormat": "Output a total of $t$ lines, each containing $1$ decimal number, representing the answer. Keep the decimals.\n\nIf the absolute error between your answer and the correct answer is within $10^{-4}$, then it will be judged as correct.", "hint": "For $n=4$,\n\nIf the deletion order is $\\{1,2,3\\},\\{3,2,1\\}$, then the probability is $\\frac{1}{4} \\times \\frac{1}{3} \\times \\frac{1}{1}=\\frac{1}{12}$.\n\nIf the deletion order is $\\{1,3,2\\},\\{3,1,2\\}$, then the probability is $\\frac{1}{4} \\times \\frac{1}{3} \\times \\frac{1}{2}=\\frac{1}{24}$.\n\nIf the deletion order is $\\{2,1,3\\},\\{2,3,1\\}$, then the probability is $\\frac{1}{4} \\times \\frac{1}{2} \\times \\frac{1}{1}=\\frac{1}{8}$.\n\nFor the remaining $12$ sequences that delete $4$ times, the probability is $\\frac{1}{4} \\times \\frac{1}{3} \\times \\frac{1}{2} \\times \\frac{1}{1}=\\frac{1}{24}$.\n\nIt is easy to see that the answer is\n$\\frac{2 \\times 3}{12} + \\frac{2 \\times 3}{24}+\\frac{2 \\times 3}{8} + \\frac{12 \\times 4}{24}=\\frac{7}{2}=3.50000$.\n\n### Constraints\n\nFor $20\\%$ of the testdata, $n \\leq 10$.\n\nFor $60\\%$ of the testdata, $n \\leq 10^5$.\n\nFor $100\\%$ of the testdata, $n \\leq 10^9,t \\leq 100$.\n\n### A Friendly Reminder from the Problem Setter\n\nFor C++ users, for positive integers $n,k$, if you want to compute $\\sqrt[k] n$, please try not to use the built-in C++ function $\\operatorname{pow}$, in order to avoid possible unnecessary precision errors.\n\n# Input Format\n\nThe first line contains $1$ positive integer $t$, meaning Peppa and George plan to play $t$ games.\n\nThen follow $t$ lines, each with $1$ positive integer $n$, meaning Peppa wrote the numbers $\\{1,2,\\cdots,n\\}$ on the blackboard and will start the game.\n\n# Output Format\n\nOutput a total of $t$ lines, each containing $1$ decimal number, representing the answer. Keep the decimals.\n\nIf the absolute error between your answer and the correct answer is within $10^{-4}$, then it will be judged as correct.\n\n# Hint\n\nFor $n=4$,\n\nIf the deletion order is $\\{1,2,3\\},\\{3,2,1\\}$, then the probability is $\\frac{1}{4} \\times \\frac{1}{3} \\times \\frac{1}{1}=\\frac{1}{12}$.\n\nIf the deletion order is $\\{1,3,2\\},\\{3,1,2\\}$, then the probability is $\\frac{1}{4} \\times \\frac{1}{3} \\times \\frac{1}{2}=\\frac{1}{24}$.\n\nIf the deletion order is $\\{2,1,3\\},\\{2,3,1\\}$, then the probability is $\\frac{1}{4} \\times \\frac{1}{2} \\times \\frac{1}{1}=\\frac{1}{8}$.\n\nFor the remaining $12$ sequences that delete $4$ times, the probability is $\\frac{1}{4} \\times \\frac{1}{3} \\times \\frac{1}{2} \\times \\frac{1}{1}=\\frac{1}{24}$.\n\nIt is easy to see that the answer is\n$\\frac{2 \\times 3}{12} + \\frac{2 \\times 3}{24}+\\frac{2 \\times 3}{8} + \\frac{12 \\times 4}{24}=\\frac{7}{2}=3.50000$\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "小猪佩奇玩游戏", "background": "", "description": "佩奇和乔治玩游♂戏。\n\n佩奇在黑板上写下数字 $\\{1,2,\\cdots,n\\}$ ，每次他们会等概率地报出黑板上的一个数字 $x$ ,并删除所有 $x$ 的正整数次幂。\n\n形式化地,给定数列 $\\{1,2,\\cdots,n\\}$ ，每次等概率选出数列中存在的 $1$ 个数字 $x$ ，并将形如 $\\{x^k,k \\in Z^{+}\\}$ 的数字删除。\n\n他们玩了整整一个下午，游戏还是没有结束，所以他们想知道，该游戏期望在多少轮后会结束。\n\n如果你的答案与正确答案的绝对误差在 $10^{-4} $以内，则被判定为正确。", "inputFormat": "第一行 $1$ 个正整数 $t$,表示佩奇和乔治打算玩 $t$ 轮游戏。\n\n之后 $t$ 行,每行 $1$ 个正整数 $n$,表示佩奇在黑板上写下了数字 $\\{1,2,\\cdots,n\\}$ 并将进行游戏。", "outputFormat": "一共 $t$ 行，每行 $1$ 个小数,表示答案，答案保留小数。\n\n如果你的答案与正确答案的绝对误差在 $10^{-4}$以内，则被判定为正确。", "hint": "对于 $n=4$，\n\n若删除的顺序为 $\\{1,2,3\\},\\{3,2,1\\}$, 那么概率为$\\frac{1}{4} \\times \\frac{1}{3} \\times \\frac{1}{1}=\\frac{1}{12}$\n\n若删除的顺序为 $\\{1,3,2\\},\\{3,1,2\\}$, 那么概率为$\\frac{1}{4} \\times \\frac{1}{3} \\times \\frac{1}{2}=\\frac{1}{24}$\n\n若删除的顺序为 $\\{2,1,3\\},\\{2,3,1\\}$, 那么概率为$\\frac{1}{4} \\times \\frac{1}{2} \\times \\frac{1}{1}=\\frac{1}{8}$\n\n对于剩余的 $12$ 种删除了 $4$ 次的序列，概率为$\\frac{1}{4} \\times \\frac{1}{3} \\times \\frac{1}{2} \\times \\frac{1}{1}=\\frac{1}{24}$\n\n容易发现答案即为\n$\\frac{2 \\times 3}{12} + \\frac{2 \\times 3}{24}+\\frac{2 \\times 3}{8} + \\frac{12 \\times 4}{24}=\\frac{7}{2}=3.50000$\n\n### 数据范围\n\n对于 $20\\%$ 的数据, $n \\leq 10$\n\n对于 $60\\%$ 的数据, $n \\leq 10^5$\n\n对于 $100\\%$ 的数据, $n \\leq 10^9,t \\leq 100$\n\n### 出题人善意的提醒\n\n对于 C++ 选手，若对于正整数 $n,k$，希望得到 $\\sqrt[k] n$，请尽量不要使用 C++ 自带的 $\\operatorname{pow}$ 函数，以免可能产生不必要的精度误差。", "locale": "zh-CN"}}}
{"pid": "P5590", "type": "P", "difficulty": 5, "samples": [["10 10\n1 2\n2 3\n3 4\n4 5\n5 6\n6 7\n7 8\n8 9\n9 10\n1 10", "10 10\n1 2 1\n2 3 1\n3 4 1\n4 5 1\n5 6 1\n6 7 1\n7 8 1\n8 9 1\n9 10 1\n1 10 9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["Special Judge", "差分约束", "洛谷月赛"], "title": "赛车游戏", "background": "", "description": "R 君和小伙伴打算一起玩赛车。但他们被老司机 mocania 骗去了秋名山。\n\n秋名山上有 $n$ 个点和 $m$ 条边，R 君和他的小伙伴要从点 $1$ 出发开往点 $n$，每条边都有一个初始的方向。老司机 mocania 拿到了秋名山的地图但却不知道每条路有多长。显然，为了赛车游戏的公平，每条 $1$ 到 $n$ 的路径应当是等长的。mocania 想，我就随便给边标上一个 $1...9$ 的长度，反正傻傻的 R 君也看不出来。\n\n可 mocania 的数学不大好，不知道怎么给边标长度，只能跑来请教你这个 OI 高手了。\n\n", "inputFormat": "第一行两个整数 $n,m$。\n\n接下来 $m$ 行，每行两个整数 $u,v$，表示一条从 $u$ 到 $v$ 的有向边。", "outputFormat": "如果无解或者不存在 $1$ 到 $n$ 的路径直接输出一个 $-1$。\n\n如果有解第一行输出两个数 $n,m$，和输入文件中给出的相同。\n\n接下来 $m$ 行，每行三个整数 $u,v,w$，表示把从 $u$ 到 $v$ 的路径的长度设置为 $w$，其中 $w$ 是一个 $1\\sim 9$ 的整数。要求所有边的出现顺序和题目中给出的相同。", "hint": "#### 数据范围\n\n**本题启用 Special Judge 和 Subtask。**\n\nSubtask #1（$30$ 分）：$n \\leq 10$，$m \\leq 20$；  \nSubtask #2（$30$ 分）：$n \\leq 100$，$m \\leq 200$；  \nSubtask #3（$40$ 分）：$n \\leq 1000$，$m \\leq 2000$。\n\n保证数据中不会出现重边，自环。", "locale": "zh-CN", "translations": {"en": {"title": "Racing Game", "background": "", "description": "Mr. R and his friends plan to play a racing game, but they were tricked by the experienced driver mocania into going to Mount Akina.\n\nOn Mount Akina, there are $n$ nodes and $m$ edges. Mr. R and his friends need to start from node $1$ and drive to node $n$. Each edge has an initial direction. The experienced driver mocania got the map of Mount Akina, but does not know how long each road is. Obviously, for fairness in the racing game, every path from $1$ to $n$ should have the same total length. mocania thinks: “I will just assign each edge a length from $1...9$. Anyway, the silly Mr. R will not be able to tell.”\n\nHowever, mocania is not very good at math and does not know how to assign lengths to the edges, so he comes to ask you, an OI expert, for help.", "inputFormat": "The first line contains two integers $n, m$.\n\nThe next $m$ lines each contain two integers $u, v$, indicating a directed edge from $u$ to $v$.", "outputFormat": "If there is no solution, or if there is no path from $1$ to $n$, output $-1$.\n\nIf there is a solution, output two numbers $n, m$ on the first line, the same as in the input file.\n\nThen output $m$ lines. Each line contains three integers $u, v, w$, meaning the length of the edge from $u$ to $v$ is set to $w$, where $w$ is an integer in $1\\sim 9$. The order of all edges must be the same as in the problem statement.", "hint": "#### Constraints\n\n**This problem uses Special Judge and Subtask.**\n\nSubtask #1 ($30$ points): $n \\leq 10$, $m \\leq 20$.  \nSubtask #2 ($30$ points): $n \\leq 100$, $m \\leq 200$.  \nSubtask #3 ($40$ points): $n \\leq 1000$, $m \\leq 2000$.\n\nIt is guaranteed that there are no multiple edges or self-loops in the testdata.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "赛车游戏", "background": "", "description": "R 君和小伙伴打算一起玩赛车。但他们被老司机 mocania 骗去了秋名山。\n\n秋名山上有 $n$ 个点和 $m$ 条边，R 君和他的小伙伴要从点 $1$ 出发开往点 $n$，每条边都有一个初始的方向。老司机 mocania 拿到了秋名山的地图但却不知道每条路有多长。显然，为了赛车游戏的公平，每条 $1$ 到 $n$ 的路径应当是等长的。mocania 想，我就随便给边标上一个 $1...9$ 的长度，反正傻傻的 R 君也看不出来。\n\n可 mocania 的数学不大好，不知道怎么给边标长度，只能跑来请教你这个 OI 高手了。\n\n", "inputFormat": "第一行两个整数 $n,m$。\n\n接下来 $m$ 行，每行两个整数 $u,v$，表示一条从 $u$ 到 $v$ 的有向边。", "outputFormat": "如果无解或者不存在 $1$ 到 $n$ 的路径直接输出一个 $-1$。\n\n如果有解第一行输出两个数 $n,m$，和输入文件中给出的相同。\n\n接下来 $m$ 行，每行三个整数 $u,v,w$，表示把从 $u$ 到 $v$ 的路径的长度设置为 $w$，其中 $w$ 是一个 $1\\sim 9$ 的整数。要求所有边的出现顺序和题目中给出的相同。", "hint": "#### 数据范围\n\n**本题启用 Special Judge 和 Subtask。**\n\nSubtask #1（$30$ 分）：$n \\leq 10$，$m \\leq 20$；  \nSubtask #2（$30$ 分）：$n \\leq 100$，$m \\leq 200$；  \nSubtask #3（$40$ 分）：$n \\leq 1000$，$m \\leq 2000$。\n\n保证数据中不会出现重边，自环。", "locale": "zh-CN"}}}
