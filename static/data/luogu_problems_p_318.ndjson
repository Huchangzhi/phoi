{"pid": "P7440", "type": "P", "difficulty": 7, "samples": [["3 2\n0 1", "0 1 2"], ["6 4\n11 43 27 7", "0 88 176 1311 7332 53070"], ["6 4\n9 72 22 7", "0 110 220 1551 8580 60990"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["动态规划 DP", "数学", "递推", "矩阵运算", "O2优化", "矩阵加速", "置换", "组合数学", "排列组合", "生成函数", "线性代数", "矩阵乘法", "线性递推", "微积分", "导数", "快速傅里叶变换 FFT", "快速数论变换 NTT"], "title": "「KrOI2021」Feux Follets", "background": "Note：$\\sigma(5307)=7440$，且在所有满足 $\\sigma(x)=7440$ 的 $x$ 中这是唯一一个模 10 余 7 的数。", "description": "设 $\\text{cyc}_\\pi$ 将长为 $n$ 的排列 $\\pi$ 当成置换时所能分解成的循环个数。给定两个整数 $n,k$ 和一个 $k-1$ 次多项式，对 $1\\leq m\\leq n$ 求：\n\n$$\n\\sum\\limits_{\\pi}F(\\text{cyc}_{\\pi})\n$$\n\n其中 $\\pi$ 是长度为 $m$ 且不存在位置 $i$ 使得 $\\pi_i=i$ 的排列。", "inputFormat": "第一行两个整数，表示 $n$ 和 $k$。\n\n第二行 $k$ 个整数，从低到高给出多项式的系数。", "outputFormat": "一行 $n$ 个整数，表示答案对 $998244353$ 取模的值。", "hint": "### 数据范围\n\n对于 $100\\%$ 的数据，$1\\leq n,k\\leq 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「KrOI2021」Feux Follets", "background": "Note：$\\sigma(5307)=7440$，且在所有满足 $\\sigma(x)=7440$ 的 $x$ 中这是唯一一个模 10 余 7 的数。", "description": "设 $\\text{cyc}_\\pi$ 将长为 $n$ 的排列 $\\pi$ 当成置换时所能分解成的循环个数。给定两个整数 $n,k$ 和一个 $k-1$ 次多项式，对 $1\\leq m\\leq n$ 求：\n\n$$\n\\sum\\limits_{\\pi}F(\\text{cyc}_{\\pi})\n$$\n\n其中 $\\pi$ 是长度为 $m$ 且不存在位置 $i$ 使得 $\\pi_i=i$ 的排列。", "inputFormat": "第一行两个整数，表示 $n$ 和 $k$。\n\n第二行 $k$ 个整数，从低到高给出多项式的系数。", "outputFormat": "一行 $n$ 个整数，表示答案对 $998244353$ 取模的值。", "hint": "### 数据范围\n\n对于 $100\\%$ 的数据，$1\\leq n,k\\leq 10^5$。", "locale": "zh-CN"}}}
{"pid": "P7441", "type": "P", "difficulty": 2, "samples": [["2\n2 3 10\n2 4 11", "3\n2"], ["1\n0 0 1", "0"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["数学", "O2优化", "二分图", "洛谷月赛"], "title": "「EZEC-7」Erinnerung", "background": "", "description": "小 Y 和小 Z 都是生活在 Arcaea Offline 的精灵。小 Y 有无数片落叶，其中第 $i$ 片落叶的价值为 $C_i$。小 Z 有无数片雪花，其中第 $i$ 片雪花的价值为 $E_i$。经过小 X 的仔细观察，他发现 $C$ 和 $E$ 满足特殊的条件：\n\n$$\nC_i=\n\\begin{cases}\nx\\times i& (x\\times i\\le K)\\\\\n-K& \\text{otherwise}\n\\end{cases}\n$$\n$$\nE_i=\n\\begin{cases}\ny\\times i& (y\\times i\\le K)\\\\\n-K& \\text{otherwise}\n\\end{cases}\n$$\n\n小 Y 和小 Z 可以对这些落叶和雪花进行一些操作。每次，他们会选择满足价值之和 $\\ge K$ 的一片落叶和一片雪花，然后让把它们一同组成一段彩色的回忆（Erinnerung）。之后，这片雪花和这片落叶就消失不见了，之后的操作也不能再用到这片雪花和落叶了。\n\n小 X 想知道，他们最多能进行多少次操作。", "inputFormat": "**本题有多组数据。**\n\n第一行一个整数 $T$，表示数据的组数。\n\n接下来 $T$ 行，每行三个非负整数 $x,y,K$。", "outputFormat": "对于每组数据，输出一个整数，代表最多能有多少次操作。每组数据的答案用一个换行符隔开。", "hint": "**【样例解释】**\n\n对于样例 1 的第一组数据，落叶的价值为 $2,4,6,8,10,-10,-10\\dots$ ，雪花的价值为 $3,6,9,-10,-10\\dots$ 。第一次操作选取第 $4$ 片落叶和第 $1$ 片雪花，价值和为 $11$。第二次操作选取第 $2$ 片落叶和第 $2$ 片雪花，价值和为 $10$。第三次操作选取第 $5$ 片落叶和第 $3$ 片雪花，价值和为 $19$。如是，可以进行 $3$ 次操作。容易证明不存在更优的解。\n\n对于第二组数据，进行的两次操作可以为：选取第 $4$ 片落叶和第 $1$ 片雪花，以及选取第 $2$ 片落叶和第 $2$ 片雪花。\n\n对于样例 2，所有的雪花和落叶的价值都为 $0$，不可能找到落叶和雪花使其和 $\\ge 1$。\n\n---\n\n**【数据范围】**\n\n-  Subtask 1（30 points）：$x,y,K,T\\le 10$。\n-  Subtask 2（70 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，满足 $0\\le x,y\\le 10^{10}$，$1\\le K\\le 10^{10}$，$1\\le T\\le 10^5$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-7」Erinnerung", "background": "", "description": "小 Y 和小 Z 都是生活在 Arcaea Offline 的精灵。小 Y 有无数片落叶，其中第 $i$ 片落叶的价值为 $C_i$。小 Z 有无数片雪花，其中第 $i$ 片雪花的价值为 $E_i$。经过小 X 的仔细观察，他发现 $C$ 和 $E$ 满足特殊的条件：\n\n$$\nC_i=\n\\begin{cases}\nx\\times i& (x\\times i\\le K)\\\\\n-K& \\text{otherwise}\n\\end{cases}\n$$\n$$\nE_i=\n\\begin{cases}\ny\\times i& (y\\times i\\le K)\\\\\n-K& \\text{otherwise}\n\\end{cases}\n$$\n\n小 Y 和小 Z 可以对这些落叶和雪花进行一些操作。每次，他们会选择满足价值之和 $\\ge K$ 的一片落叶和一片雪花，然后让把它们一同组成一段彩色的回忆（Erinnerung）。之后，这片雪花和这片落叶就消失不见了，之后的操作也不能再用到这片雪花和落叶了。\n\n小 X 想知道，他们最多能进行多少次操作。", "inputFormat": "**本题有多组数据。**\n\n第一行一个整数 $T$，表示数据的组数。\n\n接下来 $T$ 行，每行三个非负整数 $x,y,K$。", "outputFormat": "对于每组数据，输出一个整数，代表最多能有多少次操作。每组数据的答案用一个换行符隔开。", "hint": "**【样例解释】**\n\n对于样例 1 的第一组数据，落叶的价值为 $2,4,6,8,10,-10,-10\\dots$ ，雪花的价值为 $3,6,9,-10,-10\\dots$ 。第一次操作选取第 $4$ 片落叶和第 $1$ 片雪花，价值和为 $11$。第二次操作选取第 $2$ 片落叶和第 $2$ 片雪花，价值和为 $10$。第三次操作选取第 $5$ 片落叶和第 $3$ 片雪花，价值和为 $19$。如是，可以进行 $3$ 次操作。容易证明不存在更优的解。\n\n对于第二组数据，进行的两次操作可以为：选取第 $4$ 片落叶和第 $1$ 片雪花，以及选取第 $2$ 片落叶和第 $2$ 片雪花。\n\n对于样例 2，所有的雪花和落叶的价值都为 $0$，不可能找到落叶和雪花使其和 $\\ge 1$。\n\n---\n\n**【数据范围】**\n\n-  Subtask 1（30 points）：$x,y,K,T\\le 10$。\n-  Subtask 2（70 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，满足 $0\\le x,y\\le 10^{10}$，$1\\le K\\le 10^{10}$，$1\\le T\\le 10^5$。", "locale": "zh-CN"}}}
{"pid": "P7442", "type": "P", "difficulty": 4, "samples": [["2 7\n2 0\n1 0\n2 1\n1 1\n2 2\n1 0\n2 3", "0\n2\n0\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["位运算", "洛谷月赛"], "title": "「EZEC-7」维护序列", "background": "[![](https://cdn.luogu.com.cn/upload/image_hosting/lo9tuyl9.png)](https://www.luogu.com.cn/paste/tdqr0sto)\n\n可怜的 dead_X 收不了歌，于是他出了个水题并给参赛者送了 $100$ 分。\n\n2022 Update: 已经收了，很水。", "description": "你需要维护一个序列。\n\n这个序列开始时有 $2^n$ 个数，下标从 $0$ 开始。第 $i$ 个数初始值为 $i$，需要支持以下三种操作：\n\n* 定义 $a$ 为所有下标为偶数的数组成的子序列，$b$ 为所有下标为奇数的数组成的子序列，将 $a,b$ 连接，构成新的序列。\n* 定义 $a$ 为所有下标为奇数的数组成的子序列，$b$ 为所有下标为偶数的数组成的子序列，将 $a,b$ 连接，构成新的序列。\n* 查询下标为 $x$ 的数。\n\n总共将进行 $m$ 次操作。", "inputFormat": "第一行输入两个正整数 $n,m$。\n\n接下来输入 $m$ 行，每行输入两个非负整数 $op,x$，代表一次操作。\n\n如果 $op=1$，若 $x=0$，代表第一种操作，若 $x=1$，代表第二种操作。\n\n如果 $op=2$，代表第三种操作，参数 $x$ 即为输入的 $x$。", "outputFormat": "对于每个 $op=2$ 输出一行，即对应的数。", "hint": "**【样例解释】**\n\n所有操作前后的序列从左至右的数如下：\n$$\\{0,1,2,3\\}$$\n下标为 $0$ 的数为 $0$。\n$$\\{0,2\\},\\{1,3\\}$$\n$$\\{0,2,1,3\\}$$\n下标为 $1$ 的数为 $2$。\n$$\\{2,3\\},\\{0,1\\}$$\n$$\\{2,3,0,1\\}$$\n下标为 $2$ 的数为 $0$。\n$$\\{2,0\\},\\{3,1\\}$$\n$$\\{2,0,3,1\\}$$\n下标为 $3$ 的数为 $1$。\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（10 points）：不存在 $op=1$ 的操作。\n- Subtask 2（10 points）：$n\\leq 10，m\\leq 10^3$。\n- Subtask 3（20 points）：$n\\leq 10$。\n- Subtask 4（20 points）：$m\\leq 10^3$。\n- Subtask 5（20 points）：对于 $op=1$ 的操作，$x=0$。\n- Subtask 6（20 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 32$，$1\\leq m\\leq 10^6$。\n\n若 $op=1$，$x\\in\\{0,1\\}$，若 $op=2$，$0\\leq x<2^n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-7」维护序列", "background": "[![](https://cdn.luogu.com.cn/upload/image_hosting/lo9tuyl9.png)](https://www.luogu.com.cn/paste/tdqr0sto)\n\n可怜的 dead_X 收不了歌，于是他出了个水题并给参赛者送了 $100$ 分。\n\n2022 Update: 已经收了，很水。", "description": "你需要维护一个序列。\n\n这个序列开始时有 $2^n$ 个数，下标从 $0$ 开始。第 $i$ 个数初始值为 $i$，需要支持以下三种操作：\n\n* 定义 $a$ 为所有下标为偶数的数组成的子序列，$b$ 为所有下标为奇数的数组成的子序列，将 $a,b$ 连接，构成新的序列。\n* 定义 $a$ 为所有下标为奇数的数组成的子序列，$b$ 为所有下标为偶数的数组成的子序列，将 $a,b$ 连接，构成新的序列。\n* 查询下标为 $x$ 的数。\n\n总共将进行 $m$ 次操作。", "inputFormat": "第一行输入两个正整数 $n,m$。\n\n接下来输入 $m$ 行，每行输入两个非负整数 $op,x$，代表一次操作。\n\n如果 $op=1$，若 $x=0$，代表第一种操作，若 $x=1$，代表第二种操作。\n\n如果 $op=2$，代表第三种操作，参数 $x$ 即为输入的 $x$。", "outputFormat": "对于每个 $op=2$ 输出一行，即对应的数。", "hint": "**【样例解释】**\n\n所有操作前后的序列从左至右的数如下：\n$$\\{0,1,2,3\\}$$\n下标为 $0$ 的数为 $0$。\n$$\\{0,2\\},\\{1,3\\}$$\n$$\\{0,2,1,3\\}$$\n下标为 $1$ 的数为 $2$。\n$$\\{2,3\\},\\{0,1\\}$$\n$$\\{2,3,0,1\\}$$\n下标为 $2$ 的数为 $0$。\n$$\\{2,0\\},\\{3,1\\}$$\n$$\\{2,0,3,1\\}$$\n下标为 $3$ 的数为 $1$。\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n- Subtask 1（10 points）：不存在 $op=1$ 的操作。\n- Subtask 2（10 points）：$n\\leq 10，m\\leq 10^3$。\n- Subtask 3（20 points）：$n\\leq 10$。\n- Subtask 4（20 points）：$m\\leq 10^3$。\n- Subtask 5（20 points）：对于 $op=1$ 的操作，$x=0$。\n- Subtask 6（20 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\leq n\\leq 32$，$1\\leq m\\leq 10^6$。\n\n若 $op=1$，$x\\in\\{0,1\\}$，若 $op=2$，$0\\leq x<2^n$。", "locale": "zh-CN"}}}
{"pid": "P7443", "type": "P", "difficulty": 5, "samples": [["4\n3 1 2 7\n1 1\n4 3 2\n3 1 2 7\n1 2\n4 3 2\n3 0 2 7\n1 2\n4 3 2\n9 1 523 182\n1 1 2 2 2 3 3 1\n3 23 18 293 162 483 574 384 109", "-1\n0\n22\n86491"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["树形数据结构", "博弈论", "O2优化", "洛谷月赛"], "title": "「EZEC-7」加边", "background": "> 暴力怎么做？暴力是不是，加边！加边！加边！然后，并查集查询！\n\nAlice 不喜欢并查集，但是她喜欢加边。", "description": "给定一棵 $n$ 个节点的树，节点从 $1$ 开始编号，$1$ 号节点是根节点，每条边的方向是从父亲到儿子。每个点有一个点权 $a_i$。Alice 和 Bob 在玩游戏，他们在根节点上放了一个棋子，Alice 和 Bob 轮流将棋子沿边移动，谁不能移动谁输。\n\n已知 Alice 是先手或是后手。在游戏开始前，Alice 可以在树上添加一条有向边 $u\\to v$（$1\\le u,v\\le n$），然后和 Bob 在形成的图上玩这个游戏，她希望自己存在必胜策略。**她也可以选择不加边。如果无法决出胜负则不算胜利。**\n\n给定正整数 $A,B$，Alice 添加边 $u\\to v$ 的代价是 $A\\times a_u+B\\times  a_v$。选择不加边的代价为 $0$。\n\nAlice 要最小化她的代价。如果她怎么加边都不满足要求，输出 $-1$。\n\nAlice 会做出 $T$ 次询问，你需要对每个询问输出答案。", "inputFormat": "**本题有多组数据。**\n\n第一行输入一个正整数 $T$，表示询问次数。\n\n对于每组询问，第一行输入四个正整数 $n,t,A,B$，其中 $n$ 表示树的节点数，$t$ 表示操作顺序，$t=0$ 表示 Alice 先手，$t=1$ 表示 Alice 后手。\n\n接下来一行 $n-1$ 个正整数，第 $i$ 个数表示节点 $i+1$ 的父亲编号 $f_{i+1}$。\n\n接下来一行 $n$ 个正整数，第 $i$ 个表示 $a_i$ 的值。", "outputFormat": "对于每个询问，输出一行一个整数，表示 Alice 的最小代价。如果她怎么加边都不满足要求，输出 $-1$。", "hint": "**【样例解释】**\n\n在第 $1$ 组询问中，Alice 是后手，她无论怎么添加边都无法拥有必胜策略，所以输出 $-1$。  \n在第 $2$ 组询问中，Alice 是后手，她不需要添加边就拥有必胜策略，所以代价为 $0$。  \n在第 $3$ 组询问中，Alice 是先手，她只能添加一条 $1\\to 3$ 的边使自己必胜，此时代价为 $2\\times 4+7\\times 2=22$。  \n在第 $4$ 组询问中，Alice 是后手，她可以添加一条 $9\\to 5$ 的边使自己必胜，此时代价为 $523\\times 109+182\\times 162=86491$。她还有其他使自己必胜的方法，但是可以发现 $86491$ 是最小代价。  \n\n------------\n\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n\n- Subtask 1（10 points）：$n\\le 10$，$T=1$；\n- Subtask 2（15 points）：$\\sum n\\le 200$；\n- Subtask 3（15 points）：$\\sum n\\le 2000$；\n- Subtask 4（10 points）：$f_i=i-1$；\n- Subtask 5（10 points）：$f_i=1$；\n- Subtask 6（20 points）：$\\sum n\\le 5\\times 10^5$；\n- Subtask 7（20 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，满足 $1\\le T\\le 2\\times10^3$，$2\\le n\\le2\\times 10^5$，$\\sum n\\le 5\\times 10^6$，$1\\le a_i,A,B\\le 10^9$，$f_i<i$，$t\\in\\{0,1\\}$。\n\n\n------------\n**【提示】**\n\n请使用较快的输入方式。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-7」加边", "background": "> 暴力怎么做？暴力是不是，加边！加边！加边！然后，并查集查询！\n\nAlice 不喜欢并查集，但是她喜欢加边。", "description": "给定一棵 $n$ 个节点的树，节点从 $1$ 开始编号，$1$ 号节点是根节点，每条边的方向是从父亲到儿子。每个点有一个点权 $a_i$。Alice 和 Bob 在玩游戏，他们在根节点上放了一个棋子，Alice 和 Bob 轮流将棋子沿边移动，谁不能移动谁输。\n\n已知 Alice 是先手或是后手。在游戏开始前，Alice 可以在树上添加一条有向边 $u\\to v$（$1\\le u,v\\le n$），然后和 Bob 在形成的图上玩这个游戏，她希望自己存在必胜策略。**她也可以选择不加边。如果无法决出胜负则不算胜利。**\n\n给定正整数 $A,B$，Alice 添加边 $u\\to v$ 的代价是 $A\\times a_u+B\\times  a_v$。选择不加边的代价为 $0$。\n\nAlice 要最小化她的代价。如果她怎么加边都不满足要求，输出 $-1$。\n\nAlice 会做出 $T$ 次询问，你需要对每个询问输出答案。", "inputFormat": "**本题有多组数据。**\n\n第一行输入一个正整数 $T$，表示询问次数。\n\n对于每组询问，第一行输入四个正整数 $n,t,A,B$，其中 $n$ 表示树的节点数，$t$ 表示操作顺序，$t=0$ 表示 Alice 先手，$t=1$ 表示 Alice 后手。\n\n接下来一行 $n-1$ 个正整数，第 $i$ 个数表示节点 $i+1$ 的父亲编号 $f_{i+1}$。\n\n接下来一行 $n$ 个正整数，第 $i$ 个表示 $a_i$ 的值。", "outputFormat": "对于每个询问，输出一行一个整数，表示 Alice 的最小代价。如果她怎么加边都不满足要求，输出 $-1$。", "hint": "**【样例解释】**\n\n在第 $1$ 组询问中，Alice 是后手，她无论怎么添加边都无法拥有必胜策略，所以输出 $-1$。  \n在第 $2$ 组询问中，Alice 是后手，她不需要添加边就拥有必胜策略，所以代价为 $0$。  \n在第 $3$ 组询问中，Alice 是先手，她只能添加一条 $1\\to 3$ 的边使自己必胜，此时代价为 $2\\times 4+7\\times 2=22$。  \n在第 $4$ 组询问中，Alice 是后手，她可以添加一条 $9\\to 5$ 的边使自己必胜，此时代价为 $523\\times 109+182\\times 162=86491$。她还有其他使自己必胜的方法，但是可以发现 $86491$ 是最小代价。  \n\n------------\n\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n\n- Subtask 1（10 points）：$n\\le 10$，$T=1$；\n- Subtask 2（15 points）：$\\sum n\\le 200$；\n- Subtask 3（15 points）：$\\sum n\\le 2000$；\n- Subtask 4（10 points）：$f_i=i-1$；\n- Subtask 5（10 points）：$f_i=1$；\n- Subtask 6（20 points）：$\\sum n\\le 5\\times 10^5$；\n- Subtask 7（20 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，满足 $1\\le T\\le 2\\times10^3$，$2\\le n\\le2\\times 10^5$，$\\sum n\\le 5\\times 10^6$，$1\\le a_i,A,B\\le 10^9$，$f_i<i$，$t\\in\\{0,1\\}$。\n\n\n------------\n**【提示】**\n\n请使用较快的输入方式。", "locale": "zh-CN"}}}
{"pid": "P7444", "type": "P", "difficulty": 6, "samples": [["4\n4 3 1 1", "2"], ["4\n4 0 3 2", "0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["动态规划 DP", "2021", "洛谷原创", "O2优化", "动态规划优化", "前缀和", "逆元", "洛谷月赛"], "title": "「EZEC-7」猜排列", "background": "Update：数据已经经过加强。", "description": "Alice 手上有一个长度为 $n$ 的排列 $a$，排列中的数为 $0,1,2,\\cdots,n-1$。\n\nBob 闲来无事，想去猜它。但 Alice 不想让他轻易猜到。\n\n于是他抛给了 Bob 一些条件，让他来猜这个排列。\n\n我们定义 $f(l,r)=\\text{mex}\\{a_l,a_{l+1},\\cdots,a_r\\}$，其中 $\\text{mex}$ 函数代表一个可重集中**没有出现过**的最小**非负整数**。\n\n而 Alice 说出的条件包含 $n$ 个数，第 $i$ 个数代表着满足 $1 \\leq l \\leq r \\leq n$ 且 $f(l,r)=i-1$ 的二元组 $(l,r)$ 的个数。\n\nBob 一下就知道这并不能确认整个排列了，因此他想知道符合已有条件的排列数量。", "inputFormat": "第一行，一个正整数 $n$，代表 Alice 手中排列的长度。\n\n第二行，$n$ 个非负整数，第 $i$ 个数 $c_i$ 代表着满足 $l \\leq r $ 且 $f(l,r)=i-1$ 的二元组 $(l,r)$ 的个数。", "outputFormat": "输出符合已有条件的排列数量对 $998244353$ 取模的值。", "hint": "**【样例解释】**\n\n第一个样例中存在两个满足条件的排列，分别为：\n\n$\\{1,0,2,3\\}$ 和 $\\{3,2,0,1\\}$ 。\n\n第二个样例可以通过枚举发现没有符合题意的解。\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n* Subtask 1（4 points）：$n\\leq 8$。\n* Subtask 2（8 points）：$n\\leq 20$。\n* Subtask 3（16 points）：$n\\leq 100$。\n* Subtask 4（32 points）：$n\\leq 2\\times 10^3$。\n* Subtask 5（20 points）：$n\\leq 10^5$。\n* Subtask 6（20 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le n\\le5\\times10^5 $，$c_i \\ge 0$，保证 $\\sum^{n}_{i=1}c_i=\\frac{n(n+1)}{2}-1$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-7」猜排列", "background": "Update：数据已经经过加强。", "description": "Alice 手上有一个长度为 $n$ 的排列 $a$，排列中的数为 $0,1,2,\\cdots,n-1$。\n\nBob 闲来无事，想去猜它。但 Alice 不想让他轻易猜到。\n\n于是他抛给了 Bob 一些条件，让他来猜这个排列。\n\n我们定义 $f(l,r)=\\text{mex}\\{a_l,a_{l+1},\\cdots,a_r\\}$，其中 $\\text{mex}$ 函数代表一个可重集中**没有出现过**的最小**非负整数**。\n\n而 Alice 说出的条件包含 $n$ 个数，第 $i$ 个数代表着满足 $1 \\leq l \\leq r \\leq n$ 且 $f(l,r)=i-1$ 的二元组 $(l,r)$ 的个数。\n\nBob 一下就知道这并不能确认整个排列了，因此他想知道符合已有条件的排列数量。", "inputFormat": "第一行，一个正整数 $n$，代表 Alice 手中排列的长度。\n\n第二行，$n$ 个非负整数，第 $i$ 个数 $c_i$ 代表着满足 $l \\leq r $ 且 $f(l,r)=i-1$ 的二元组 $(l,r)$ 的个数。", "outputFormat": "输出符合已有条件的排列数量对 $998244353$ 取模的值。", "hint": "**【样例解释】**\n\n第一个样例中存在两个满足条件的排列，分别为：\n\n$\\{1,0,2,3\\}$ 和 $\\{3,2,0,1\\}$ 。\n\n第二个样例可以通过枚举发现没有符合题意的解。\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n* Subtask 1（4 points）：$n\\leq 8$。\n* Subtask 2（8 points）：$n\\leq 20$。\n* Subtask 3（16 points）：$n\\leq 100$。\n* Subtask 4（32 points）：$n\\leq 2\\times 10^3$。\n* Subtask 5（20 points）：$n\\leq 10^5$。\n* Subtask 6（20 points）：无特殊限制。\n\n对于 $100\\%$ 的数据，$1\\le n\\le5\\times10^5 $，$c_i \\ge 0$，保证 $\\sum^{n}_{i=1}c_i=\\frac{n(n+1)}{2}-1$。", "locale": "zh-CN"}}}
{"pid": "P7445", "type": "P", "difficulty": 7, "samples": [["2 1 0\n", "166374059\n"], ["2 2 1\n", "813384288\n"], ["3 2 1\n", "462150164\n"], ["100 114 514\n", "718571152\n"]], "limits": {"time": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 2000, 2000, 2000, 2000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["O2优化", "生成函数", "期望", "快速傅里叶变换 FFT", "快速数论变换 NTT", "洛谷月赛"], "title": "「EZEC-7」线段树", "background": "Bob 喜欢线段树。\n", "description": "如果你不知道线段树，可以看 提示说明 中的定义。\n\nBob 得到了一个长度为 $n$ 的序列 $a_{1,2,\\cdots,n}$，初始全为 $0$。\n\n接着 Bob 进行了 $m$ 次区间加操作，每次操作会等概率地从 $[1,n]$ 的所有 $\\dfrac{n(n+1)}{2}$ 个子区间中随机选择一个进行操作，每次加的数是 $[-1,V]$ 之间等概率随机的整数。\n\n$m$ 次操作完之后要求出每一个位置的值。\n\n由于 Bob 喜欢线段树，他熟练地打出一颗 $[1,n]$ 上的线段树来解决这个问题，使用懒惰标记来解决区间加的问题。\n\n打代码的过程中 Bob 忽然想到了两个减小 $\\mathrm{Pushdown}$（下传懒惰标记）次数的方法：\n\n+ 修改的时候不 $\\mathrm{Pushdown}$，最后一次性 $\\mathrm{Pushdown}$（即 $\\mathrm{Pushall}$ 函数）。\n\n+ $\\mathrm{Pushall}$ 到一个节点的时候，如果这个节点的懒惰标记为 $0$ 那么不 $\\mathrm{Pushdown}$。\n\n现在 Bob 想知道期望 $\\mathrm{Pushdown}$ 次数，可是他不会算，于是来问你。\n\n下面是 Bob 写的线段树伪代码（其中 `tag` 数组为懒惰标记）：\n\n$\n\\displaystyle\n\\begin{array}{l}\n\\mathrm{pushdown\\_counter}\\leftarrow 0\\\\\n\\\\\n\\textbf{function }\\mathrm{Update(Node},l,r,ql,qr,Delta)\\\\\n\\qquad \\textbf{if } [l,r]\\cap [ql,qr] = \\varnothing \\textbf{ then}\\\\\n\\qquad \\qquad \\textbf{return}\\\\\n\\qquad \\textbf{end if}\\\\\n\\qquad \\textbf{if }[l,r] \\subseteq [ql,qr] \\textbf{ then}\\\\\n\\qquad \\qquad \\mathrm{tag[Node]\\leftarrow tag[Node]}+Delta\\\\\n\\qquad \\qquad \\textbf{return}\\\\\n\\qquad \\textbf{end if}\\\\\n\\qquad mid\\leftarrow \\lfloor\\dfrac{l+r}{2}\\rfloor\\\\\n\\qquad \\mathrm{Update(LeftChild},l,mid,ql,qr,Delta)\\\\\n\\qquad \\mathrm{Update(RightChild},mid+1,r,ql,qr,Delta)\\\\\n\\textbf{end function}\\\\\n\\\\\n\\textbf{function }\\mathrm{Pushdown(Node)} \\\\\n\\qquad \\mathrm{tag[LeftChild]\\leftarrow tag[LeftChild]+tag[Node]}\\\\\n\\qquad \\mathrm{tag[RightChild]\\leftarrow tag[RightChild]+tag[Node]}\\\\\n\\qquad \\mathrm{pushdown\\_counter}\\leftarrow \\mathrm{pushdown\\_counter}+1\\\\\n\\textbf{end function}\\\\\n\\\\\n\\textbf{function }\\mathrm{Pushall(Node},l,r)\\\\\n\\qquad \\textbf{if } \\mathrm{Node\\ is\\ Leaf} \\textbf{ then}\\\\\n\\qquad \\qquad \\textbf{return}\\\\\n\\qquad \\textbf{end if}\\\\\n\\qquad \\textbf{if } \\mathrm{tag[Node] \\not= 0} \\textbf{ then}\\\\\n\\qquad \\qquad \\mathrm{Pushdown(Node)}\\\\\n\\qquad \\textbf{end if}\\\\\n\\qquad mid\\leftarrow \\lfloor\\dfrac{l+r}{2}\\rfloor\\\\\n\\qquad \\mathrm{Pushall(LeftChild},l,mid)\\\\\n\\qquad \\mathrm{Pushall(RightChild},mid+1,r)\\\\\n\\textbf{end function}\n\\end{array}\n$\n\n\n换句话说，你要帮 Bob 求出 `pushdown_counter` 的期望值。\n\n答案对 $998244353$ 取模。\n", "inputFormat": "一行三个整数 $n,m,V$。", "outputFormat": "一个整数，期望 $\\mathrm{Pushdown}$ 次数对 $998244353$ 取模的结果。", "hint": "**【样例解释 #1】**\n\n整颗线段树只有 $3$ 个节点：$[1,2],[1,1],[2,2]$。\n\n只有节点 $[1,2]$ 可能 $\\mathrm{Pushdown}$。\n\n当操作为 $\\mathrm{Update(1,2,-1)}$ 的时候，根节点的懒惰标记为 $-1$， $\\mathrm{Pushall}$ 在根号节点会 $\\mathrm{Pushdown}$；而 $\\mathrm{Update(1,2,0)}$ 之后，由于根节点懒惰标记为 $0$ 不 $\\mathrm{Pushdown}$。\n\n其余 $4$ 种操作均把懒惰标记打在叶子节点，即 $\\mathrm{Update(1,1,-1)},\\mathrm{Update(1,1,0)},\\mathrm{Update(2,2,-1)},\\mathrm{Update(2,2,0)}$，不会 $\\mathrm{Pushdown}$。\n\n所以，总共 $6$ 种情况，能 $\\mathrm{Pushdown}$ 的只有 $1$ 种，期望次数为 $\\dfrac{1}{6}$。\n\n**【样例解释 #2】**\n\n由于情况过多，不一一解释，只解释一种情况。\n\n如果执行的 $2$ 次操作分别为 $\\mathrm{Update(1,2,-1)},\\mathrm{Update(1,2,1)}$，由于这时候根节点的懒惰标记为 $0$，在 $\\mathrm{Pushall}$ 的时候仍然不会 $\\mathrm{Pushdown}$。\n\n---------\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | $n\\le$       | $m\\le$       | $V$               | 分值 | 时间限制$\\text{ / ms}$ |\n| :----: | :------------: | :------------: | :-----------------: | :----: | :--------: |\n| $1$        | $4$  | $4$   | $\\le 2$         | $3$  | $500$    |\n| $2$        | $300$ | $300$ | $\\le 300$       | $7$  | $500$    |\n| $3$        | $1000$ | $1000$ | $\\le 1000$      | $10$ | $500$    |\n| $4$       | $300$  | $10^5$ | $=1000$          | $15$ | $2000$   |\n| $5$        | $10^5$ | $10^5$ | $\\le 0$         | $10$ | $3000$   |\n| $6$        | $10^5$ | $10^5$ | $=1000$          | $15$ | $3000$   |\n| $7$        | $10^5$ | $10^5$ | $\\le 998244350$ | $40$ | $3000$   |\n\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^5$，$1 \\le m \\le 10^5$，$-1 \\le V \\le 998244350$。\n\n----------\n\n**【线段树定义】**\n\n线段树是一棵每个节点上都记录了一个线段的二叉树。根节点记录的线段是 $[1, n]$。对于每个节点，若它记录的线段是 $[l, r]$ 且 $l\\not= r$，取 $m = \\lfloor \\dfrac{l+r}{2} \\rfloor$，则它的左右儿子节点记录的线段分别是 $[l, m]$ 和 $[m+1,r]$；若 $l=r$，则它是叶子节点。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "「EZEC-7」线段树", "background": "Bob 喜欢线段树。\n", "description": "如果你不知道线段树，可以看 提示说明 中的定义。\n\nBob 得到了一个长度为 $n$ 的序列 $a_{1,2,\\cdots,n}$，初始全为 $0$。\n\n接着 Bob 进行了 $m$ 次区间加操作，每次操作会等概率地从 $[1,n]$ 的所有 $\\dfrac{n(n+1)}{2}$ 个子区间中随机选择一个进行操作，每次加的数是 $[-1,V]$ 之间等概率随机的整数。\n\n$m$ 次操作完之后要求出每一个位置的值。\n\n由于 Bob 喜欢线段树，他熟练地打出一颗 $[1,n]$ 上的线段树来解决这个问题，使用懒惰标记来解决区间加的问题。\n\n打代码的过程中 Bob 忽然想到了两个减小 $\\mathrm{Pushdown}$（下传懒惰标记）次数的方法：\n\n+ 修改的时候不 $\\mathrm{Pushdown}$，最后一次性 $\\mathrm{Pushdown}$（即 $\\mathrm{Pushall}$ 函数）。\n\n+ $\\mathrm{Pushall}$ 到一个节点的时候，如果这个节点的懒惰标记为 $0$ 那么不 $\\mathrm{Pushdown}$。\n\n现在 Bob 想知道期望 $\\mathrm{Pushdown}$ 次数，可是他不会算，于是来问你。\n\n下面是 Bob 写的线段树伪代码（其中 `tag` 数组为懒惰标记）：\n\n$\n\\displaystyle\n\\begin{array}{l}\n\\mathrm{pushdown\\_counter}\\leftarrow 0\\\\\n\\\\\n\\textbf{function }\\mathrm{Update(Node},l,r,ql,qr,Delta)\\\\\n\\qquad \\textbf{if } [l,r]\\cap [ql,qr] = \\varnothing \\textbf{ then}\\\\\n\\qquad \\qquad \\textbf{return}\\\\\n\\qquad \\textbf{end if}\\\\\n\\qquad \\textbf{if }[l,r] \\subseteq [ql,qr] \\textbf{ then}\\\\\n\\qquad \\qquad \\mathrm{tag[Node]\\leftarrow tag[Node]}+Delta\\\\\n\\qquad \\qquad \\textbf{return}\\\\\n\\qquad \\textbf{end if}\\\\\n\\qquad mid\\leftarrow \\lfloor\\dfrac{l+r}{2}\\rfloor\\\\\n\\qquad \\mathrm{Update(LeftChild},l,mid,ql,qr,Delta)\\\\\n\\qquad \\mathrm{Update(RightChild},mid+1,r,ql,qr,Delta)\\\\\n\\textbf{end function}\\\\\n\\\\\n\\textbf{function }\\mathrm{Pushdown(Node)} \\\\\n\\qquad \\mathrm{tag[LeftChild]\\leftarrow tag[LeftChild]+tag[Node]}\\\\\n\\qquad \\mathrm{tag[RightChild]\\leftarrow tag[RightChild]+tag[Node]}\\\\\n\\qquad \\mathrm{pushdown\\_counter}\\leftarrow \\mathrm{pushdown\\_counter}+1\\\\\n\\textbf{end function}\\\\\n\\\\\n\\textbf{function }\\mathrm{Pushall(Node},l,r)\\\\\n\\qquad \\textbf{if } \\mathrm{Node\\ is\\ Leaf} \\textbf{ then}\\\\\n\\qquad \\qquad \\textbf{return}\\\\\n\\qquad \\textbf{end if}\\\\\n\\qquad \\textbf{if } \\mathrm{tag[Node] \\not= 0} \\textbf{ then}\\\\\n\\qquad \\qquad \\mathrm{Pushdown(Node)}\\\\\n\\qquad \\textbf{end if}\\\\\n\\qquad mid\\leftarrow \\lfloor\\dfrac{l+r}{2}\\rfloor\\\\\n\\qquad \\mathrm{Pushall(LeftChild},l,mid)\\\\\n\\qquad \\mathrm{Pushall(RightChild},mid+1,r)\\\\\n\\textbf{end function}\n\\end{array}\n$\n\n\n换句话说，你要帮 Bob 求出 `pushdown_counter` 的期望值。\n\n答案对 $998244353$ 取模。\n", "inputFormat": "一行三个整数 $n,m,V$。", "outputFormat": "一个整数，期望 $\\mathrm{Pushdown}$ 次数对 $998244353$ 取模的结果。", "hint": "**【样例解释 #1】**\n\n整颗线段树只有 $3$ 个节点：$[1,2],[1,1],[2,2]$。\n\n只有节点 $[1,2]$ 可能 $\\mathrm{Pushdown}$。\n\n当操作为 $\\mathrm{Update(1,2,-1)}$ 的时候，根节点的懒惰标记为 $-1$， $\\mathrm{Pushall}$ 在根号节点会 $\\mathrm{Pushdown}$；而 $\\mathrm{Update(1,2,0)}$ 之后，由于根节点懒惰标记为 $0$ 不 $\\mathrm{Pushdown}$。\n\n其余 $4$ 种操作均把懒惰标记打在叶子节点，即 $\\mathrm{Update(1,1,-1)},\\mathrm{Update(1,1,0)},\\mathrm{Update(2,2,-1)},\\mathrm{Update(2,2,0)}$，不会 $\\mathrm{Pushdown}$。\n\n所以，总共 $6$ 种情况，能 $\\mathrm{Pushdown}$ 的只有 $1$ 种，期望次数为 $\\dfrac{1}{6}$。\n\n**【样例解释 #2】**\n\n由于情况过多，不一一解释，只解释一种情况。\n\n如果执行的 $2$ 次操作分别为 $\\mathrm{Update(1,2,-1)},\\mathrm{Update(1,2,1)}$，由于这时候根节点的懒惰标记为 $0$，在 $\\mathrm{Pushall}$ 的时候仍然不会 $\\mathrm{Pushdown}$。\n\n---------\n\n**【数据范围】**\n\n**本题采用捆绑测试。**\n\n| 子任务编号 | $n\\le$       | $m\\le$       | $V$               | 分值 | 时间限制$\\text{ / ms}$ |\n| :----: | :------------: | :------------: | :-----------------: | :----: | :--------: |\n| $1$        | $4$  | $4$   | $\\le 2$         | $3$  | $500$    |\n| $2$        | $300$ | $300$ | $\\le 300$       | $7$  | $500$    |\n| $3$        | $1000$ | $1000$ | $\\le 1000$      | $10$ | $500$    |\n| $4$       | $300$  | $10^5$ | $=1000$          | $15$ | $2000$   |\n| $5$        | $10^5$ | $10^5$ | $\\le 0$         | $10$ | $3000$   |\n| $6$        | $10^5$ | $10^5$ | $=1000$          | $15$ | $3000$   |\n| $7$        | $10^5$ | $10^5$ | $\\le 998244350$ | $40$ | $3000$   |\n\n\n对于 $100\\%$ 的数据，$1 \\le n \\le 10^5$，$1 \\le m \\le 10^5$，$-1 \\le V \\le 998244350$。\n\n----------\n\n**【线段树定义】**\n\n线段树是一棵每个节点上都记录了一个线段的二叉树。根节点记录的线段是 $[1, n]$。对于每个节点，若它记录的线段是 $[l, r]$ 且 $l\\not= r$，取 $m = \\lfloor \\dfrac{l+r}{2} \\rfloor$，则它的左右儿子节点记录的线段分别是 $[l, m]$ 和 $[m+1,r]$；若 $l=r$，则它是叶子节点。\n", "locale": "zh-CN"}}}
{"pid": "P7446", "type": "P", "difficulty": 6, "samples": [["6 4\n1 2 3 3 4\n2 3 4\n1 1 0 2\n2 6 5\n2 1 0\n", "3\n3\n1"]], "limits": {"time": [1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2007", "O2优化", "Ynoi"], "title": "[Ynoi2007] rfplca", "background": null, "description": "给定一棵大小为 $n$ 的 $1$ 为根节点的树，树用如下方式给出：输入 $a_2,a_3,\\dots,a_n$，保证 $1\\leq a_i<i$，将 $a_i$ 与 $i$ 连边形成一棵树。\n\n接下来有 $m$ 次操作，操作有两种：\n- `1 l r x` 令 $a_i=\\max(a_i-x,1)(l\\leq i\\leq r)$。\n- `2 u v` 查询在当前的 $a$ 数组构成的树上 $u,v$ 的 LCA。", "inputFormat": "第一行包含两个数 $n$，$m$。\n\n之后一行 $n-1$ 个数，表示 $a_2,...,a_n$。\n\n之后 $m$ 行，每行三个或四个数，表示一次操作。\n\n**本题强制在线，所有输入的 $l,r,x,u,v$ 均需要异或 $lastans$，其定义为上一次询问操作得到的答案，若之前没有询问操作，则为 $0$。**", "outputFormat": "对于每个 $2$ 操作，输出一行一个数表示答案。", "hint": "Idea：Ynoi，Solution：Ynoi，Code：Ynoi，Data：Ynoi&nzhtl1477\n\n对于 $100\\%$ 的数据，满足\n$2\\leq n,m\\leq 4\\times 10^5$，$2\\leq l\\leq r\\leq n$，$1\\leq x\\leq 4\\times 10^5$，$1\\leq u,v\\leq n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2007] rfplca", "background": null, "description": "给定一棵大小为 $n$ 的 $1$ 为根节点的树，树用如下方式给出：输入 $a_2,a_3,\\dots,a_n$，保证 $1\\leq a_i<i$，将 $a_i$ 与 $i$ 连边形成一棵树。\n\n接下来有 $m$ 次操作，操作有两种：\n- `1 l r x` 令 $a_i=\\max(a_i-x,1)(l\\leq i\\leq r)$。\n- `2 u v` 查询在当前的 $a$ 数组构成的树上 $u,v$ 的 LCA。", "inputFormat": "第一行包含两个数 $n$，$m$。\n\n之后一行 $n-1$ 个数，表示 $a_2,...,a_n$。\n\n之后 $m$ 行，每行三个或四个数，表示一次操作。\n\n**本题强制在线，所有输入的 $l,r,x,u,v$ 均需要异或 $lastans$，其定义为上一次询问操作得到的答案，若之前没有询问操作，则为 $0$。**", "outputFormat": "对于每个 $2$ 操作，输出一行一个数表示答案。", "hint": "Idea：Ynoi，Solution：Ynoi，Code：Ynoi，Data：Ynoi&nzhtl1477\n\n对于 $100\\%$ 的数据，满足\n$2\\leq n,m\\leq 4\\times 10^5$，$2\\leq l\\leq r\\leq n$，$1\\leq x\\leq 4\\times 10^5$，$1\\leq u,v\\leq n$。", "locale": "zh-CN"}}}
{"pid": "P7447", "type": "P", "difficulty": 7, "samples": [["5 5\n2 4 5 1 3\n1 2 4 3\n2 1 5\n2 10 12\n1 7 3 7\n2 5 3", "9 1 3\n6 1 3\n4 1 2"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000, 6000], "memory": [65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536, 65536]}, "tags": ["2007", "线段树", "倍增", "O2优化", "分块", "洛谷月赛", "Ynoi"], "title": "[Ynoi2007] rgxsxrs", "background": "本题读入量约 15 MB，输出量约 13 MB，请选择合适的输入输出方法。", "description": "给定一个长为 $n$ 的序列 $a$，需要实现 $m$ 次操作：\n\n`1 l r x`：表示将区间 $[l,r]$ 中所有 $>x$ 的元素减去 $x$。\n\n`2 l r`：表示询问区间 $[l,r]$ 的和，最小值，最大值。", "inputFormat": "第一行两个正整数 $n,m$。\n\n第二行 $n$ 个正整数表示序列 $a$。\n\n之后 $m$ 行每行 $3$ 或 $4$ 个正整数表示一次操作。\n\n**本题强制在线，所有输入的 $l,r,x$ 均需要异或 $lastans$，其定义为上一次询问操作得到的区间和对 $2^{20}$ 取模后的值，若之前没有询问操作，则为 $0$。**", "outputFormat": "对于每个操作 $2$ ，输出一行三个用空格分隔的数表示答案。", "hint": "Idea：wangziji&花花，Solution：wangziji&花花，Code：ccz181078，Data：wangziji&花花&ccz181078\n\n注意：本题采用**捆绑测试**，只有当你通过一个 subtask 中的所有测试点后，你才能拿到这个 subtask 的分数。\n\n对于 $1\\%$ 的数据，$n,m\\leq 1000$，时限为 3s。\n\n对于另外 $14\\%$ 的数据，$a_i\\leq 10$，$n,m\\leq 2\\times10^5$，时限为 3s。\n\n对于另外 $19\\%$ 的数据，$a_i\\leq 1000$，$n,m\\leq 2\\times10^5$，时限为 3s。\n\n对于另外 $19\\%$ 的数据，$a_i\\leq 2\\times 10^5$，$n,m\\leq 2\\times10^5$，时限为 3s。\n\n\n对于 $100\\%$ 的数据，$1\\le n,m\\leq 5\\times 10^5$，$1\\leq a_i,x\\leq 10^9$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2007] rgxsxrs", "background": "本题读入量约 15 MB，输出量约 13 MB，请选择合适的输入输出方法。", "description": "给定一个长为 $n$ 的序列 $a$，需要实现 $m$ 次操作：\n\n`1 l r x`：表示将区间 $[l,r]$ 中所有 $>x$ 的元素减去 $x$。\n\n`2 l r`：表示询问区间 $[l,r]$ 的和，最小值，最大值。", "inputFormat": "第一行两个正整数 $n,m$。\n\n第二行 $n$ 个正整数表示序列 $a$。\n\n之后 $m$ 行每行 $3$ 或 $4$ 个正整数表示一次操作。\n\n**本题强制在线，所有输入的 $l,r,x$ 均需要异或 $lastans$，其定义为上一次询问操作得到的区间和对 $2^{20}$ 取模后的值，若之前没有询问操作，则为 $0$。**", "outputFormat": "对于每个操作 $2$ ，输出一行三个用空格分隔的数表示答案。", "hint": "Idea：wangziji&花花，Solution：wangziji&花花，Code：ccz181078，Data：wangziji&花花&ccz181078\n\n注意：本题采用**捆绑测试**，只有当你通过一个 subtask 中的所有测试点后，你才能拿到这个 subtask 的分数。\n\n对于 $1\\%$ 的数据，$n,m\\leq 1000$，时限为 3s。\n\n对于另外 $14\\%$ 的数据，$a_i\\leq 10$，$n,m\\leq 2\\times10^5$，时限为 3s。\n\n对于另外 $19\\%$ 的数据，$a_i\\leq 1000$，$n,m\\leq 2\\times10^5$，时限为 3s。\n\n对于另外 $19\\%$ 的数据，$a_i\\leq 2\\times 10^5$，$n,m\\leq 2\\times10^5$，时限为 3s。\n\n\n对于 $100\\%$ 的数据，$1\\le n,m\\leq 5\\times 10^5$，$1\\leq a_i,x\\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P7448", "type": "P", "difficulty": 7, "samples": [["5\n2 1 3 2 1\n4\n2 4\n1 5\n3 5\n2 2", "1\n3\n3\n0"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2007", "O2优化", "Ynoi"], "title": "[Ynoi2007] rdiq", "background": "", "description": "给定一个长为 $n$ 的序列 $a$。\n\n有 $m$ 次询问，每次询问给定一个区间 $[l,r]$，求 $|\\{(a_i,a_j) : l\\le i<j\\le r \\wedge a_i>a_j\\}|$。", "inputFormat": "第一行一个数 $n$。\n\n第二行 $n$ 个数，其中第 $i$ 个数 $a_i$ 表示序列第 $i$ 个位置的值。\n\n第三行一个数 $m$。\n\n之后 $m$ 行，每行用两个空格隔开的数，分别表示 $l,r$，表示一次询问，保证 $l\\le r$。", "outputFormat": "输出 $m$ 行，第 $i$ 行输出一行一个整数，表示第 $i$ 次询问的答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477&ccz181078，Code：ccz181078，Data：w33z8kqrqk8zzzx33&nzhtl1477\n\n对于第一次询问，集合为 $\\{(3,2)\\}$。\n\n对于第二次与第三次询问，集合为 $\\{(2,1),(3,1),(3,2)\\}$。\n\n对于第四次询问，集合为空集。\n\n对于 $100\\%$ 的数据，满足 $1\\le n\\le 10^5$，$1\\le m\\le 5\\times 10^5$，$1\\le a_i\\le n$。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi2007] rdiq", "background": "", "description": "给定一个长为 $n$ 的序列 $a$。\n\n有 $m$ 次询问，每次询问给定一个区间 $[l,r]$，求 $|\\{(a_i,a_j) : l\\le i<j\\le r \\wedge a_i>a_j\\}|$。", "inputFormat": "第一行一个数 $n$。\n\n第二行 $n$ 个数，其中第 $i$ 个数 $a_i$ 表示序列第 $i$ 个位置的值。\n\n第三行一个数 $m$。\n\n之后 $m$ 行，每行用两个空格隔开的数，分别表示 $l,r$，表示一次询问，保证 $l\\le r$。", "outputFormat": "输出 $m$ 行，第 $i$ 行输出一行一个整数，表示第 $i$ 次询问的答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477&ccz181078，Code：ccz181078，Data：w33z8kqrqk8zzzx33&nzhtl1477\n\n对于第一次询问，集合为 $\\{(3,2)\\}$。\n\n对于第二次与第三次询问，集合为 $\\{(2,1),(3,1),(3,2)\\}$。\n\n对于第四次询问，集合为空集。\n\n对于 $100\\%$ 的数据，满足 $1\\le n\\le 10^5$，$1\\le m\\le 5\\times 10^5$，$1\\le a_i\\le n$。", "locale": "zh-CN"}}}
{"pid": "P7449", "type": "P", "difficulty": 7, "samples": [["3\n0 0 0 100\n0 100 100 100\n100 100 0 0", "4\n0 0\n0 100\n100 100\n0 0"], ["3\n0 0 0 100\n1 51 1 49\n0 100 0 0", "5\n0 0\n0 100\n1 51\n1 49\n0 100"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2016", "提交答案", "Special Judge", "随机化", "构造", "THUSC"], "title": "[THUSC 2016] 星露谷物语", "background": "", "description": "最近，小葱为了忘记城市的喧嚣，来到了星露谷开始种地发家致富。但是，由于小葱把钱都拿去抽卡了，所以小葱并没有足够的钱来买种子。为了搜集足够的钱来养猪，小葱必须开始大规模的搜寻野菜工作。\n\n星露谷是一个无限大的二维平面，你可以在这个二维平面内任意移动。小葱可能在星露谷的 $n$ 条线段上找到野菜，但是这些线段是有向的，小葱必须沿着线段的方向移动才能找到野菜。为了找到更多的野菜，小葱希望自己能把星露谷中所有可能出现野菜的地方全部走一遍。换句话说，对于每条线段，小葱都需要沿着该线段的方向将这条线段的每个点都经过一遍。当然，小葱可以选择分多次走一条线段，具体地讲，小葱可以在这条线段的任意位置离开这条线段，再从任意位置进入这条线段，只要保证路径的并集覆盖了这条有向线段即可。\n\n小葱希望找到一条尽量短的路径，这条路径应该由 $m$ 条线段组成，并且覆盖了星露谷中的 $n$ 条有向线段。小葱可以选择星露谷的任意一个点作为路径的起点，同时它也必须是路径的终点，即小葱最终必须回到出发的位置。\n\n现在，小葱要去写四子棋大作业了，他不知道该怎么规划自己的行走方案使得自己移动的距离尽量短，所以就把这个艰巨的任务交给聪明的你了。\n\n**注意：如果有两条线段的某部分重合且方向相同，那么你在走过这一段的时候我们认为这两条线段的这部分都被走过了。**", "inputFormat": "第一行包含一个整数 $n$，代表图中有向线段的数量。\n\n接下来 $n$ 行，每行四个整数  $x_1,y_1,x_2,y_2$，代表这条线段是一条从 $(x_1,y_1)$ 到 $(x_2,y_2)$ 的有向线段。", "outputFormat": "第一行应包含一个整数 $m$，代表小葱所走的折线路径中点的数量，需要满足 $m\\le\\min(5n^2,5\\times 10^6)$。 接下来 $m$ 行，按照路径的顺序依次输出路径上的点。每行应包含两个浮点数 $x,y$，用来描述一个点的横、纵坐标。其中，$x,y$ 请保留不超过 $5$ 位小数。", "hint": "**本题为提交答案题，输入与 checker 将会在附件给出**\n\n对于每组测试数据，如果你的输出格式不符合题目要求，或者你输出的路径并没有走完给定的条 $n$ 有向线段，那么该测试点得 $0$ 分。否则，我们会计算你给出路径的长度 $d$，并根据 $10$ 个评分参数 $a_1\\ge a_2\\ge...\\ge a_{10}$ 计算你的得分：\n$$\\max\\{i|d\\le a_i,1\\le i\\le 10\\}$$\n\n数据保证 $a_1$ 足够大，以确保一个合法的方案至少可以得到 $1$ 分。\n#### 样例解释\n对于样例 $1$，小葱总共移动了 $200+100\\sqrt2$ 的距离，这也是这组样例的最优解。\n\n对于样例 $2$，在该组解中，小葱一共移动了 $202+\\sqrt{2402}+\\sqrt{2602}$ 的距离，但这并不是这组数据的最优解。\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUSC 2016] 星露谷物语", "background": "", "description": "最近，小葱为了忘记城市的喧嚣，来到了星露谷开始种地发家致富。但是，由于小葱把钱都拿去抽卡了，所以小葱并没有足够的钱来买种子。为了搜集足够的钱来养猪，小葱必须开始大规模的搜寻野菜工作。\n\n星露谷是一个无限大的二维平面，你可以在这个二维平面内任意移动。小葱可能在星露谷的 $n$ 条线段上找到野菜，但是这些线段是有向的，小葱必须沿着线段的方向移动才能找到野菜。为了找到更多的野菜，小葱希望自己能把星露谷中所有可能出现野菜的地方全部走一遍。换句话说，对于每条线段，小葱都需要沿着该线段的方向将这条线段的每个点都经过一遍。当然，小葱可以选择分多次走一条线段，具体地讲，小葱可以在这条线段的任意位置离开这条线段，再从任意位置进入这条线段，只要保证路径的并集覆盖了这条有向线段即可。\n\n小葱希望找到一条尽量短的路径，这条路径应该由 $m$ 条线段组成，并且覆盖了星露谷中的 $n$ 条有向线段。小葱可以选择星露谷的任意一个点作为路径的起点，同时它也必须是路径的终点，即小葱最终必须回到出发的位置。\n\n现在，小葱要去写四子棋大作业了，他不知道该怎么规划自己的行走方案使得自己移动的距离尽量短，所以就把这个艰巨的任务交给聪明的你了。\n\n**注意：如果有两条线段的某部分重合且方向相同，那么你在走过这一段的时候我们认为这两条线段的这部分都被走过了。**", "inputFormat": "第一行包含一个整数 $n$，代表图中有向线段的数量。\n\n接下来 $n$ 行，每行四个整数  $x_1,y_1,x_2,y_2$，代表这条线段是一条从 $(x_1,y_1)$ 到 $(x_2,y_2)$ 的有向线段。", "outputFormat": "第一行应包含一个整数 $m$，代表小葱所走的折线路径中点的数量，需要满足 $m\\le\\min(5n^2,5\\times 10^6)$。 接下来 $m$ 行，按照路径的顺序依次输出路径上的点。每行应包含两个浮点数 $x,y$，用来描述一个点的横、纵坐标。其中，$x,y$ 请保留不超过 $5$ 位小数。", "hint": "**本题为提交答案题，输入与 checker 将会在附件给出**\n\n对于每组测试数据，如果你的输出格式不符合题目要求，或者你输出的路径并没有走完给定的条 $n$ 有向线段，那么该测试点得 $0$ 分。否则，我们会计算你给出路径的长度 $d$，并根据 $10$ 个评分参数 $a_1\\ge a_2\\ge...\\ge a_{10}$ 计算你的得分：\n$$\\max\\{i|d\\le a_i,1\\le i\\le 10\\}$$\n\n数据保证 $a_1$ 足够大，以确保一个合法的方案至少可以得到 $1$ 分。\n#### 样例解释\n对于样例 $1$，小葱总共移动了 $200+100\\sqrt2$ 的距离，这也是这组样例的最优解。\n\n对于样例 $2$，在该组解中，小葱一共移动了 $202+\\sqrt{2402}+\\sqrt{2602}$ 的距离，但这并不是这组数据的最优解。\n", "locale": "zh-CN"}}}
{"pid": "P7450", "type": "P", "difficulty": 7, "samples": [["1\n5 4 5\n3 4 3 4\n5 5 -1 5\n-1 4 5 5\n5 5 4 2\n1 -1 2 4\n1 3 1 1\n3 2 3 3\n4 4 4 5\n8 9 9 5\n7 2 6 3", "9 5"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["动态规划 DP", "2017", "二分", "Special Judge", "随机化", "THUSC"], "title": "[THUSC 2017] 巧克力", "background": "", "description": "「人生就像一盒巧克力，你永远不知道吃到的下一块是什么味道。」\n\n明明收到了一大块巧克力，里面有若干小块，排成 $n$ 行 $m$ 列。每一小块都有自己特别的图案 ，它们有的是海星，有的是贝壳，有的是海螺……其中还有一些因为挤压，已经分辨不出是什么图案了。明明给每一小块巧克力标上了一个美味值 $a_{i,j}$（$0\\le a_{i,j}\\le 10^6$），这个值越大，表示这一小块巧克力越美味。\n\n正当明明咽了咽口水，准备享用美味时，舟舟神奇地出现了。看到舟舟恳求的目光，明明决定从中选出一些小块与舟舟一同分享。\n\n舟舟希望这些被选出的巧克力是连通的（两块巧克力连通当且仅当他们有公共边），而且这些巧克力要包含至少 $k$（$1\\le k\\le 5$）种。而那些被挤压过的巧克力则是不能被选中的。\n\n明明想满足舟舟的愿望，但他又有点「抠」，想将美味尽可能多地留给自己。所以明明希望选出的巧克力块数能够尽可能地少。如果在选出的块数最少的前提下，美味值的中位数（我们定义 $n$ 个数的中位数为第 $\\left\\lfloor\\frac{n+1}{2}\\right\\rfloor$ 小的数）能够达到最小就更好了。\n\n你能帮帮明明吗？", "inputFormat": "每个测试点包含多组测试数据。\n\n输入第一行包含一个正整数 $T$（$1\\le T\\le 5$），表示测试数据组数。\n\n对于每组测试数据：\n\n输入第一行包含三个正整数 $n,m$ 和 $k$；\n\n接下来 $n$ 行，每行 $m$ 个整数，表示每小块的图案 $c_{i,j}$。若 $c_{i,j}=-1$ 表示这一小块受到过挤压，不能被选中；\n\n接下来 $n$ 行，每行 $m$ 个整数，表示每个小块的美味值 $a_{i,j}$。", "outputFormat": "输出共包括 $T$ 行，每行包含两个整数，用空格隔开，即最少的块数和最小的美味值中位数。\n\n若对于某组测试数据，不存在任意一种合法的选取方案，请在对应行输出两个 $-1$。", "hint": "| 测试点编号 | $n,m$ 的限制 | $c_{i,j}$ 的限制 | 部分分说明 |\n| :----------: | :----------: | :----------: | :----------: |\n| 1 | $n=1,1\\le m\\le233$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le n\\times m$ | $\\text{A}$ |\n| 2 | $1\\le n\\times m\\le 20$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le n\\times m$ | $\\text{A}$ |\n| 3~4 | $n=2,m=15$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le n\\times m$ | $\\text{A}$ |\n| 5~6 | $1\\le n\\times m\\le 30$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le n\\times m$ | $\\text{A}$ |\n| 7~9 | $1\\le n\\times m\\le 50$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le8$ | $\\text{A}$ |\n| 10 | $1\\le n\\times m\\le 233$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le8$ | $\\text{A}$ |\n| 11~12 | $1\\le n\\times m\\le 233$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le8$ | $\\text{B}$ |\n| 13~15 | $1\\le n\\times m\\le 233$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le14$ | $\\text{B}$ |\n| 16~20 | $1\\le n\\times m\\le 233$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le n\\times m$ | $\\text{B}$ |\n| 21 | $1\\le n\\times m\\le 233$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le n\\times m$ | 该测试点不计分。 |\n\n$\\text{A}$:若输出的最少块数均正确，但最小中位数存在错误，选手可以获得该测试点 $80\\%$ 的分数。\\\n$\\text{B}$:若输出的最少块数均正确，但最小中位数存在错误，选手可以获得该测试点 $60\\%$ 的分数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUSC 2017] 巧克力", "background": "", "description": "「人生就像一盒巧克力，你永远不知道吃到的下一块是什么味道。」\n\n明明收到了一大块巧克力，里面有若干小块，排成 $n$ 行 $m$ 列。每一小块都有自己特别的图案 ，它们有的是海星，有的是贝壳，有的是海螺……其中还有一些因为挤压，已经分辨不出是什么图案了。明明给每一小块巧克力标上了一个美味值 $a_{i,j}$（$0\\le a_{i,j}\\le 10^6$），这个值越大，表示这一小块巧克力越美味。\n\n正当明明咽了咽口水，准备享用美味时，舟舟神奇地出现了。看到舟舟恳求的目光，明明决定从中选出一些小块与舟舟一同分享。\n\n舟舟希望这些被选出的巧克力是连通的（两块巧克力连通当且仅当他们有公共边），而且这些巧克力要包含至少 $k$（$1\\le k\\le 5$）种。而那些被挤压过的巧克力则是不能被选中的。\n\n明明想满足舟舟的愿望，但他又有点「抠」，想将美味尽可能多地留给自己。所以明明希望选出的巧克力块数能够尽可能地少。如果在选出的块数最少的前提下，美味值的中位数（我们定义 $n$ 个数的中位数为第 $\\left\\lfloor\\frac{n+1}{2}\\right\\rfloor$ 小的数）能够达到最小就更好了。\n\n你能帮帮明明吗？", "inputFormat": "每个测试点包含多组测试数据。\n\n输入第一行包含一个正整数 $T$（$1\\le T\\le 5$），表示测试数据组数。\n\n对于每组测试数据：\n\n输入第一行包含三个正整数 $n,m$ 和 $k$；\n\n接下来 $n$ 行，每行 $m$ 个整数，表示每小块的图案 $c_{i,j}$。若 $c_{i,j}=-1$ 表示这一小块受到过挤压，不能被选中；\n\n接下来 $n$ 行，每行 $m$ 个整数，表示每个小块的美味值 $a_{i,j}$。", "outputFormat": "输出共包括 $T$ 行，每行包含两个整数，用空格隔开，即最少的块数和最小的美味值中位数。\n\n若对于某组测试数据，不存在任意一种合法的选取方案，请在对应行输出两个 $-1$。", "hint": "| 测试点编号 | $n,m$ 的限制 | $c_{i,j}$ 的限制 | 部分分说明 |\n| :----------: | :----------: | :----------: | :----------: |\n| 1 | $n=1,1\\le m\\le233$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le n\\times m$ | $\\text{A}$ |\n| 2 | $1\\le n\\times m\\le 20$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le n\\times m$ | $\\text{A}$ |\n| 3~4 | $n=2,m=15$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le n\\times m$ | $\\text{A}$ |\n| 5~6 | $1\\le n\\times m\\le 30$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le n\\times m$ | $\\text{A}$ |\n| 7~9 | $1\\le n\\times m\\le 50$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le8$ | $\\text{A}$ |\n| 10 | $1\\le n\\times m\\le 233$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le8$ | $\\text{A}$ |\n| 11~12 | $1\\le n\\times m\\le 233$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le8$ | $\\text{B}$ |\n| 13~15 | $1\\le n\\times m\\le 233$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le14$ | $\\text{B}$ |\n| 16~20 | $1\\le n\\times m\\le 233$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le n\\times m$ | $\\text{B}$ |\n| 21 | $1\\le n\\times m\\le 233$ | $c_{i,j}=-1$ 或 $1\\le c_{i,j}\\le n\\times m$ | 该测试点不计分。 |\n\n$\\text{A}$:若输出的最少块数均正确，但最小中位数存在错误，选手可以获得该测试点 $80\\%$ 的分数。\\\n$\\text{B}$:若输出的最少块数均正确，但最小中位数存在错误，选手可以获得该测试点 $60\\%$ 的分数。", "locale": "zh-CN"}}}
{"pid": "P7451", "type": "P", "difficulty": 7, "samples": [["3\n1 8\n12 24\n1 1000000", "16\n16\n947158782"], ["6\n3761870 4957871\n2262774 4279409\n3027437 5896884\n3884310 5021632\n3373244 5464739\n5063504 5368121", "953622420\n551347610\n583188135\n582472626\n190680894\n268824018"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "分治", "线性基", "分块", "THUSC"], "title": "[THUSC 2017] 杜老师", "background": "", "description": "杜老师可是要打 $+∞$ 年 World Final 的男人，虽然规则不允许，但是可以改啊！\n\n但是今年 WF 跟 THUSC 的时间这么近，所以他造了一个 idea 就扔下不管了……\n\n给定 $L,R$，求从 $L$ 到 $R$ 的这 $R-L+1$ 个数中能选出多少个不同的子集，满足子集中所有的数的乘积是一个完全平方数。特别地，空集也算一种选法，定义其乘积为 $1$。\n\n由于杜老师忙于跟陈老师和鏼老师一起打 ACM 竞赛，所以，你能帮帮杜老师写写标算吗？", "inputFormat": "从标准输入读入数据。\n\n每个测试点包含多组测试数据。\n\n输入第一行包含一个正整数 $T$（$1\\le T\\le 100$），表示测试数据组数。\n\n接下来 $T$ 行，第 $i+1$ 行两个正整数 $L_i,R_i$ 表示第 $i$ 组测试数据的 $L,R$，保证 $\\le L_i\\le R_i\\le10^7$。", "outputFormat": "输出到标准输出。\n\n输出 $T$ 行，每行一个非负整数，表示一共可以选出多少个满足条件的子集，答案对 $998244353$ 取模。", "hint": "对于 $L=1,R=8$，对应的 $16$ 种选法为：\n\n1. 空集\n1. $4$\n1. $3,6,8$\n1. $3,4,6,8$\n1. $2,8$\n1. $2,4,8$\n1. $2,3,6$\n1. $2,3,4,6$\n1. $1$\n1. $1,4$\n1. $1,3,6,8$\n1. $1,3,4,6,8$\n1. $1,2,8$\n1. $1,2,4,8$\n1. $1,2,3,6$\n1. $1,2,3,4,6$\n\n| 测试点 $\\operatorname*{Id}$ | $R_i\\le$ | $T\\le$ | $\\sum R_i-L_i+1\\le$ | 特殊约束 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| 1~2 | $30$ | $10$ | $10^3$ | 无特殊约束 |\n| 3 | $100$ | $10$ | $10^3$ | 保证答案不超过 $5\\times 10^6$ |\n| 4 | $100$ | $10$ | $10^3$ | 无特殊约束 |\n| 5~6 | $10^3$ | $10$ | $10^3$ | $R-L\\le22$ |\n| 7~8 | $10^3$ | $10$ | $10^3$ | 保证答案不超过 $2\\times 10^6$ |\n| 9~10 | $10^3$ | $10$ | $5\\times10^3$ | 无特殊约束 |\n| 11~12 | $10^6$ | $10$ | $10^7$ | $R-L\\ge999990$ |\n| 13~14 | $10^6$ | $10$ | $10^7$ | 无特殊约束 |\n| 15~20 | $10^7$ | $100$ | $(\\operatorname*{Id}-14)\\times 10^7$ | 无特殊约束 |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUSC 2017] 杜老师", "background": "", "description": "杜老师可是要打 $+∞$ 年 World Final 的男人，虽然规则不允许，但是可以改啊！\n\n但是今年 WF 跟 THUSC 的时间这么近，所以他造了一个 idea 就扔下不管了……\n\n给定 $L,R$，求从 $L$ 到 $R$ 的这 $R-L+1$ 个数中能选出多少个不同的子集，满足子集中所有的数的乘积是一个完全平方数。特别地，空集也算一种选法，定义其乘积为 $1$。\n\n由于杜老师忙于跟陈老师和鏼老师一起打 ACM 竞赛，所以，你能帮帮杜老师写写标算吗？", "inputFormat": "从标准输入读入数据。\n\n每个测试点包含多组测试数据。\n\n输入第一行包含一个正整数 $T$（$1\\le T\\le 100$），表示测试数据组数。\n\n接下来 $T$ 行，第 $i+1$ 行两个正整数 $L_i,R_i$ 表示第 $i$ 组测试数据的 $L,R$，保证 $\\le L_i\\le R_i\\le10^7$。", "outputFormat": "输出到标准输出。\n\n输出 $T$ 行，每行一个非负整数，表示一共可以选出多少个满足条件的子集，答案对 $998244353$ 取模。", "hint": "对于 $L=1,R=8$，对应的 $16$ 种选法为：\n\n1. 空集\n1. $4$\n1. $3,6,8$\n1. $3,4,6,8$\n1. $2,8$\n1. $2,4,8$\n1. $2,3,6$\n1. $2,3,4,6$\n1. $1$\n1. $1,4$\n1. $1,3,6,8$\n1. $1,3,4,6,8$\n1. $1,2,8$\n1. $1,2,4,8$\n1. $1,2,3,6$\n1. $1,2,3,4,6$\n\n| 测试点 $\\operatorname*{Id}$ | $R_i\\le$ | $T\\le$ | $\\sum R_i-L_i+1\\le$ | 特殊约束 |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n| 1~2 | $30$ | $10$ | $10^3$ | 无特殊约束 |\n| 3 | $100$ | $10$ | $10^3$ | 保证答案不超过 $5\\times 10^6$ |\n| 4 | $100$ | $10$ | $10^3$ | 无特殊约束 |\n| 5~6 | $10^3$ | $10$ | $10^3$ | $R-L\\le22$ |\n| 7~8 | $10^3$ | $10$ | $10^3$ | 保证答案不超过 $2\\times 10^6$ |\n| 9~10 | $10^3$ | $10$ | $5\\times10^3$ | 无特殊约束 |\n| 11~12 | $10^6$ | $10$ | $10^7$ | $R-L\\ge999990$ |\n| 13~14 | $10^6$ | $10$ | $10^7$ | 无特殊约束 |\n| 15~20 | $10^7$ | $100$ | $(\\operatorname*{Id}-14)\\times 10^7$ | 无特殊约束 |", "locale": "zh-CN"}}}
{"pid": "P7452", "type": "P", "difficulty": 6, "samples": [["2 4\n0 1 1 0\n1 0 1 0\n0 1 1 0\n1 0 1 0", "10"], ["2 4\n0 0 0 0\n0 0 0 0\n0 0 0 0\n0 0 0 0", "no solution"], ["2 10\n0 0 1 1 0 0 0 1 0 0\n1 1 1 0 0 1 0 0 0 0\n1 0 1 1 1 0 1 1 1 1\n1 1 1 1 1 1 0 0 1 0", "22"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "线段树", "费用流", "THUSC"], "title": "[THUSC 2017] 换桌", "background": "", "description": "班级聚会的时候，班主任为了方便管理，规定吃饭的时候同一个寝室的同学必须坐在一起；但是吃完饭后，到了娱乐时间，喜欢不同游戏的同学会聚到一起；在这个过程中就涉及到了座位分配的问题。\n\n有 $n$ 张圆桌排成一排（从左到右依次编号为 $0$ 到 $n-1$），每张桌子有 $m$ 个座位（按照逆时针依次编号为 $0$ 到 $m-1$），在吃饭时每个座位上都有一个人；在吃完饭后的时候，每个人都需要选择一个新的座位（新座位可能和原来的座位是同一个），具体来说，第 $i$ 桌第 $j$ 个人的新座位只能在第 $L_{i,j}$ 桌到第 $R_{i,j}$ 桌中选，可以是这些桌中的任何一个座位。确定好新座位之后，大家开始移动，移动的体力消耗按照如下规则计算：\n\n移动座位过程分为两步：\n\n1. 从起始桌移动到目标桌**对应座位**，这个过程中的体力消耗为**两桌距离的两倍**，即从第 $i$ 桌移动到第 $j$ 桌对应座位的体力消耗为 $2\\times |i-j|$；\n1. 从目标桌的对应座位绕着桌子移动到目标座位，由于桌子是圆的，所以客人会选择**最近的方向**移动，体力消耗为**移动距离的一倍**，即从编号为 $x$ 的座位移动的编号为 $y$ 的座位的体力消耗为 $\\min(|x-y|,m-|x-y|)$；\n\n详情如下图：\n![pic1](https://i.loli.net/2019/01/16/5c3f2f01e0336.png)\n现在，给定每个客人的限制（即每个人的新座位所在的区间），需要你设计一个方案，**使得所有客人消耗的体力和最小；本题中假设客人在移动的时候互不影响。**", "inputFormat": "从标准输入读入数据。\n\n第一行输入两个数 $n$ 和 $m$；\n\n接下来输入 $n$ 行，每行 $m$ 个空格隔开的整数描述矩阵 $L$：其中，第 $i$ 行的第 $j$ 个数表示 $L_{i,j}$；\n\n接下来输入 $n$ 行，每行 $m$ 个空格隔开的整数描述矩阵 $R$：其中，第 $i$ 行的第 $j$ 个数表示 $R_{i,j}$；\n\n数据是随机生成的，生成数据的伪代码如下：\n```cpp\nfor i <- 0 to n-1\n    for j <- 0 to m-1\n        L[i,j] <- 独立等概率地得到 0 到 n-1 中的一个整数\n        R[i,j] <- 独立等概率地得到 0 到 n-1 中的一个整数\n        if L[i,j] > R[i,j] then\n            tmp <- L[i,j]\n            L[i,j] <- R[i,j]\n            R[i,j] <- tmp\n```\n", "outputFormat": "输出到标准输出。\n\n输出总体力消耗的最小值，如果没有合法的方案输出 `no solution`。", "hint": "#### 样例解释\n对于样例 $1$，\n![pic2](https://i.loli.net/2019/01/16/5c3f2f01d91ae.png)\n\n第 $0$ 桌的 $0$ 和 $3$ 号，以及第 $1$ 桌的 $0$ 号和 $2$ 号都被限制为只能坐在他们原来的桌子（可以不是原来的座位），其他人分别需要换到第 $1$ 桌和第 $0$ 桌；\n\n可以发现，最优方案如上图，总体力消耗为 $10$。\n\n对于样例 $2$，所有人都想坐到第 $0$ 桌，所以没有合法的方案。\n\n对于全部数据：$1\\le n\\le 300$，$1\\le m\\le 10$，$0\\le L_i\\le R_i\\le n-1$ 。\n| 测试点 | $n\\le$ |\n| :----------: | :----------: |\n| 1~2 | $2$ |  |\n| 3~8 | $40$ |  |\n| 9~14 | $100$ |  |\n| 15~20 | $300$ |  |\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUSC 2017] 换桌", "background": "", "description": "班级聚会的时候，班主任为了方便管理，规定吃饭的时候同一个寝室的同学必须坐在一起；但是吃完饭后，到了娱乐时间，喜欢不同游戏的同学会聚到一起；在这个过程中就涉及到了座位分配的问题。\n\n有 $n$ 张圆桌排成一排（从左到右依次编号为 $0$ 到 $n-1$），每张桌子有 $m$ 个座位（按照逆时针依次编号为 $0$ 到 $m-1$），在吃饭时每个座位上都有一个人；在吃完饭后的时候，每个人都需要选择一个新的座位（新座位可能和原来的座位是同一个），具体来说，第 $i$ 桌第 $j$ 个人的新座位只能在第 $L_{i,j}$ 桌到第 $R_{i,j}$ 桌中选，可以是这些桌中的任何一个座位。确定好新座位之后，大家开始移动，移动的体力消耗按照如下规则计算：\n\n移动座位过程分为两步：\n\n1. 从起始桌移动到目标桌**对应座位**，这个过程中的体力消耗为**两桌距离的两倍**，即从第 $i$ 桌移动到第 $j$ 桌对应座位的体力消耗为 $2\\times |i-j|$；\n1. 从目标桌的对应座位绕着桌子移动到目标座位，由于桌子是圆的，所以客人会选择**最近的方向**移动，体力消耗为**移动距离的一倍**，即从编号为 $x$ 的座位移动的编号为 $y$ 的座位的体力消耗为 $\\min(|x-y|,m-|x-y|)$；\n\n详情如下图：\n![pic1](https://i.loli.net/2019/01/16/5c3f2f01e0336.png)\n现在，给定每个客人的限制（即每个人的新座位所在的区间），需要你设计一个方案，**使得所有客人消耗的体力和最小；本题中假设客人在移动的时候互不影响。**", "inputFormat": "从标准输入读入数据。\n\n第一行输入两个数 $n$ 和 $m$；\n\n接下来输入 $n$ 行，每行 $m$ 个空格隔开的整数描述矩阵 $L$：其中，第 $i$ 行的第 $j$ 个数表示 $L_{i,j}$；\n\n接下来输入 $n$ 行，每行 $m$ 个空格隔开的整数描述矩阵 $R$：其中，第 $i$ 行的第 $j$ 个数表示 $R_{i,j}$；\n\n数据是随机生成的，生成数据的伪代码如下：\n```cpp\nfor i <- 0 to n-1\n    for j <- 0 to m-1\n        L[i,j] <- 独立等概率地得到 0 到 n-1 中的一个整数\n        R[i,j] <- 独立等概率地得到 0 到 n-1 中的一个整数\n        if L[i,j] > R[i,j] then\n            tmp <- L[i,j]\n            L[i,j] <- R[i,j]\n            R[i,j] <- tmp\n```\n", "outputFormat": "输出到标准输出。\n\n输出总体力消耗的最小值，如果没有合法的方案输出 `no solution`。", "hint": "#### 样例解释\n对于样例 $1$，\n![pic2](https://i.loli.net/2019/01/16/5c3f2f01d91ae.png)\n\n第 $0$ 桌的 $0$ 和 $3$ 号，以及第 $1$ 桌的 $0$ 号和 $2$ 号都被限制为只能坐在他们原来的桌子（可以不是原来的座位），其他人分别需要换到第 $1$ 桌和第 $0$ 桌；\n\n可以发现，最优方案如上图，总体力消耗为 $10$。\n\n对于样例 $2$，所有人都想坐到第 $0$ 桌，所以没有合法的方案。\n\n对于全部数据：$1\\le n\\le 300$，$1\\le m\\le 10$，$0\\le L_i\\le R_i\\le n-1$ 。\n| 测试点 | $n\\le$ |\n| :----------: | :----------: |\n| 1~2 | $2$ |  |\n| 3~8 | $40$ |  |\n| 9~14 | $100$ |  |\n| 15~20 | $300$ |  |\n", "locale": "zh-CN"}}}
{"pid": "P7453", "type": "P", "difficulty": 5, "samples": [["2\n2 3 3\n6 6 6\n4\n7 1 2\n1 1 2\n4 1 2 3\n7 1 2", "8 9 9\n23 9 9"]], "limits": {"time": [5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000, 5000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "线段树", "O2优化", "矩阵乘法", "THUSC"], "title": "[THUSC 2017] 大魔法师", "background": null, "description": "大魔法师小 L 制作了 $n$ 个魔力水晶球，每个水晶球有水、火、土三个属性的能量值。小 L 把这 $n$ 个水晶球在地上从前向后排成一行，然后开始今天的魔法表演。\n\n我们用 $A_i,B_i,C_i$ 分别表示从前向后第 $i$ 个水晶球（下标从 $1$ 开始）的水、火、土的能量值。\n\n小 L 计划施展 $m$ 次魔法。每次，他会选择一个区间 $[l,r]$，然后施展以下 $3$ 大类、$7$ 种魔法之一：\n\n1. 魔力激发：令区间里每个水晶球中**特定属性**的能量爆发，从而使另一个**特定属性**的能量增强。具体来说，有以下三种可能的表现形式：\n\n\t- 火元素激发水元素能量：令 $A_i=A_i+B_i$。\n\t- 土元素激发火元素能量：令 $B_i=B_i+C_i$。\n\t- 水元素激发土元素能量：令 $C_i=C_i+A_i$。\n\t\n    **需要注意的是，增强一种属性的能量并不会改变另一种属性的能量，例如 $A_i=A_i+B_i$ 并不会使 $B_i$ 增加或减少。**\n\n2. 魔力增强：小 L 挥舞法杖，消耗自身 $v$ 点法力值，来改变区间里每个水晶球的**特定属性**的能量。具体来说，有以下三种可能的表现形式：\n\n\t- 水元素能量定值增强：令 $A_i=A_i+v$。\n\t- 火元素能量翻倍增强：令 $B_i=B_i\\times v$。\n\t- 土元素能量吸收融合：令 $C_i=v$。\n3. 魔力释放：小 L 将区间里所有水晶球的能量聚集在一起，融合成一个新的水晶球，然后送给场外观众。生成的水晶球每种属性的能量值等于区间内所有水晶球对应能量值的代数和。**需要注意的是，魔力释放的过程不会真正改变区间内水晶球的能量。**\n\n值得一提的是，小 L 制造和融合的水晶球的原材料都是定制版的 OI 工厂水晶，所以这些水晶球有一个能量阈值 $998244353$。当水晶球中某种属性的能量值大于等于这个阈值时，能量值会自动对阈值取模，从而避免水晶球爆炸。\n\n小 W 为小 L（唯一的）观众，围观了整个表演，并且收到了小 L 在表演中融合的每个水晶球。小 W 想知道，这些水晶球蕴涵的三种属性的能量值分别是多少。", "inputFormat": "从标准输入读入数据。\n\n我们将上述的 $7$ 种魔法，从上到下依次标号为 $1\\sim7$。\n\n输入的第一行包含一个整数 $n$（$1\\le n\\le 2.5\\times 10^5$），表示水晶球个数。\n\n接下来 $n$ 行，每行空格隔开的 $3$ 个整数，其中第 $i$ 行的三个数依次表示 $A_i,B_i,C_i$。\n\n接下来一行包含一个整数 $m$（$1\\le m\\le2.5\\times 10^5$），表示施展魔法的次数。\n\n接下来 $m$ 行，每行 $3$ 或 $4$ 个数，格式为 `opt l r (v)`。其中 `opt` 表示魔法的编号，$l,r$ 表示施展魔法的区间（保证有 $l\\le r$）。特别地，如果施展 $4\\sim6$ 号魔法（魔力增强），则还有一个整数 $v$，表示小 L 消耗的法力值。", "outputFormat": "输出到标准输出。\n\n对每个 $7$ 号魔法（魔力释放），输出一行、空格隔开的 $3$ 个整数 `a b c`，分别表示此次融合得到的水晶球的水、火、土元素能量值。", "hint": "对 $100\\%$ 的数据，$1\\le n,m\\le2.5\\times 10^5,0\\le A_i,B_i,C_i,v<998244353$。\n\n1. $10\\%$ 的数据，$n\\times m\\le10^7$。\n1. 另外 $10\\%$ 的数据，每次魔法的区间均为 $[1,n]$。\n1. 另外 $10\\%$ 的数据，每次非询问魔法的影响区间均为 $[1,n]$，所有修改在询问之前。\n1. 另外 $10\\%$ 的数据，$\\operatorname{opt}\\in\\{4,5,6,7\\}$。\n1. 另外 $15\\%$ 的数据，$\\operatorname{opt}\\in\\{1,2,7\\}$。\n  1. 另外 $15\\%$ 的数据，$\\operatorname{opt}\\in\\{1,2,3,5,7\\}$。\n1. 另外 $15\\%$ 的数据，$n,m\\le 10^5$。\n1. 其他数据，无特殊约定。\n#### 样例解释\n以下展示每次施展魔法后，两个水晶球内的能量：\n```\n(2, 3, 3) (6, 6, 6)\n(5, 3, 3) (12, 6, 6)\n(8, 3, 3) (15, 6, 6)\n(8, 3, 3) (15, 6, 6)\n```", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUSC 2017] 大魔法师", "background": null, "description": "大魔法师小 L 制作了 $n$ 个魔力水晶球，每个水晶球有水、火、土三个属性的能量值。小 L 把这 $n$ 个水晶球在地上从前向后排成一行，然后开始今天的魔法表演。\n\n我们用 $A_i,B_i,C_i$ 分别表示从前向后第 $i$ 个水晶球（下标从 $1$ 开始）的水、火、土的能量值。\n\n小 L 计划施展 $m$ 次魔法。每次，他会选择一个区间 $[l,r]$，然后施展以下 $3$ 大类、$7$ 种魔法之一：\n\n1. 魔力激发：令区间里每个水晶球中**特定属性**的能量爆发，从而使另一个**特定属性**的能量增强。具体来说，有以下三种可能的表现形式：\n\n\t- 火元素激发水元素能量：令 $A_i=A_i+B_i$。\n\t- 土元素激发火元素能量：令 $B_i=B_i+C_i$。\n\t- 水元素激发土元素能量：令 $C_i=C_i+A_i$。\n\t\n    **需要注意的是，增强一种属性的能量并不会改变另一种属性的能量，例如 $A_i=A_i+B_i$ 并不会使 $B_i$ 增加或减少。**\n\n2. 魔力增强：小 L 挥舞法杖，消耗自身 $v$ 点法力值，来改变区间里每个水晶球的**特定属性**的能量。具体来说，有以下三种可能的表现形式：\n\n\t- 水元素能量定值增强：令 $A_i=A_i+v$。\n\t- 火元素能量翻倍增强：令 $B_i=B_i\\times v$。\n\t- 土元素能量吸收融合：令 $C_i=v$。\n3. 魔力释放：小 L 将区间里所有水晶球的能量聚集在一起，融合成一个新的水晶球，然后送给场外观众。生成的水晶球每种属性的能量值等于区间内所有水晶球对应能量值的代数和。**需要注意的是，魔力释放的过程不会真正改变区间内水晶球的能量。**\n\n值得一提的是，小 L 制造和融合的水晶球的原材料都是定制版的 OI 工厂水晶，所以这些水晶球有一个能量阈值 $998244353$。当水晶球中某种属性的能量值大于等于这个阈值时，能量值会自动对阈值取模，从而避免水晶球爆炸。\n\n小 W 为小 L（唯一的）观众，围观了整个表演，并且收到了小 L 在表演中融合的每个水晶球。小 W 想知道，这些水晶球蕴涵的三种属性的能量值分别是多少。", "inputFormat": "从标准输入读入数据。\n\n我们将上述的 $7$ 种魔法，从上到下依次标号为 $1\\sim7$。\n\n输入的第一行包含一个整数 $n$（$1\\le n\\le 2.5\\times 10^5$），表示水晶球个数。\n\n接下来 $n$ 行，每行空格隔开的 $3$ 个整数，其中第 $i$ 行的三个数依次表示 $A_i,B_i,C_i$。\n\n接下来一行包含一个整数 $m$（$1\\le m\\le2.5\\times 10^5$），表示施展魔法的次数。\n\n接下来 $m$ 行，每行 $3$ 或 $4$ 个数，格式为 `opt l r (v)`。其中 `opt` 表示魔法的编号，$l,r$ 表示施展魔法的区间（保证有 $l\\le r$）。特别地，如果施展 $4\\sim6$ 号魔法（魔力增强），则还有一个整数 $v$，表示小 L 消耗的法力值。", "outputFormat": "输出到标准输出。\n\n对每个 $7$ 号魔法（魔力释放），输出一行、空格隔开的 $3$ 个整数 `a b c`，分别表示此次融合得到的水晶球的水、火、土元素能量值。", "hint": "对 $100\\%$ 的数据，$1\\le n,m\\le2.5\\times 10^5,0\\le A_i,B_i,C_i,v<998244353$。\n\n1. $10\\%$ 的数据，$n\\times m\\le10^7$。\n1. 另外 $10\\%$ 的数据，每次魔法的区间均为 $[1,n]$。\n1. 另外 $10\\%$ 的数据，每次非询问魔法的影响区间均为 $[1,n]$，所有修改在询问之前。\n1. 另外 $10\\%$ 的数据，$\\operatorname{opt}\\in\\{4,5,6,7\\}$。\n1. 另外 $15\\%$ 的数据，$\\operatorname{opt}\\in\\{1,2,7\\}$。\n  1. 另外 $15\\%$ 的数据，$\\operatorname{opt}\\in\\{1,2,3,5,7\\}$。\n1. 另外 $15\\%$ 的数据，$n,m\\le 10^5$。\n1. 其他数据，无特殊约定。\n#### 样例解释\n以下展示每次施展魔法后，两个水晶球内的能量：\n```\n(2, 3, 3) (6, 6, 6)\n(5, 3, 3) (12, 6, 6)\n(8, 3, 3) (15, 6, 6)\n(8, 3, 3) (15, 6, 6)\n```", "locale": "zh-CN"}}}
{"pid": "P7454", "type": "P", "difficulty": 7, "samples": [["6 3", "44"], ["120 6", "615888898"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["数学", "2017", "线性递推", "THUSC", "状压 DP"], "title": "[THUSC 2017] 如果奇迹有颜色", "background": "法本公司曾经是世界最大的化工企业，他们生产的染料颜色非常丰富，有清华紫，心灵黄，原谅绿，会议蓝，高级黑，北大红，相簿白等。", "description": "现在 B 君有一个由 $n$ 个区域组成的环，B 君要用 $m$ 种颜色来染这 $n$ 个区域。\n\nB 君不希望在这 $n$ 个区域中存在连续 $m$ 个区域恰好出现所有 $m$ 个颜色。换句话说，对于任意连续 $m$ 个区域，都不能恰好出现所有 $m$ 个颜色。\n\n如果两个方案通过旋转可以变得一模一样，那么我们认为他们是本质相同的；\n\n但是如果两个方案需要通过翻转才能变得一模一样，我们不认为他们是本质相同的。\n\n比如如果 $n=4,m=4$；\n\n我们认为 $1,2,3,4$ 和 $3,4,1,2$ 是本质相同的方案；\n\n我们认为 $1,2,3,4$ 和 $4,3,2,1$ 是本质不同的方案；\n\n我们认为 $1,2,1,2$ 和 $2,1,2,1$ 是本质相同的方案；\n\nB 君希望知道满足条件，本质不同的方案数，输出答案对 $10^9+7$ 取模。", "inputFormat": "从标准输入读入数据。\n\n输入一行包含两个整数 $n,m$，其中 $n$ 表示环的长度，$m$ 表示颜色数。", "outputFormat": "输出到标准输出。\n\n输出一行一个整数，表示答案对 $10^9+7$ 取模的结果。", "hint": "对于 $100\\%$ 的测试点，$1\\le n\\le 10^9,2\\le m\\le7$ 。\n| 数据点编号 $\\operatorname*{Id}$ | $n$ | $m$ |\n| :----------: | :----------: | :----------: |\n| 1~2 | $n\\le10$ | $m=\\operatorname*{Id}+2$ |\n| 3~8 | $n\\le 10^5,n$ 是质数 | $m=\\operatorname*{Id}-1$ |\n| 9~14 | $n$ 是质数 | $m=\\operatorname*{Id}-7$ |\n| 15~19 | 无特殊约束 | $m=\\operatorname*{Id}-13$ |\n| 20 | $n=635,643,090$ | $m=7$ |", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUSC 2017] 如果奇迹有颜色", "background": "法本公司曾经是世界最大的化工企业，他们生产的染料颜色非常丰富，有清华紫，心灵黄，原谅绿，会议蓝，高级黑，北大红，相簿白等。", "description": "现在 B 君有一个由 $n$ 个区域组成的环，B 君要用 $m$ 种颜色来染这 $n$ 个区域。\n\nB 君不希望在这 $n$ 个区域中存在连续 $m$ 个区域恰好出现所有 $m$ 个颜色。换句话说，对于任意连续 $m$ 个区域，都不能恰好出现所有 $m$ 个颜色。\n\n如果两个方案通过旋转可以变得一模一样，那么我们认为他们是本质相同的；\n\n但是如果两个方案需要通过翻转才能变得一模一样，我们不认为他们是本质相同的。\n\n比如如果 $n=4,m=4$；\n\n我们认为 $1,2,3,4$ 和 $3,4,1,2$ 是本质相同的方案；\n\n我们认为 $1,2,3,4$ 和 $4,3,2,1$ 是本质不同的方案；\n\n我们认为 $1,2,1,2$ 和 $2,1,2,1$ 是本质相同的方案；\n\nB 君希望知道满足条件，本质不同的方案数，输出答案对 $10^9+7$ 取模。", "inputFormat": "从标准输入读入数据。\n\n输入一行包含两个整数 $n,m$，其中 $n$ 表示环的长度，$m$ 表示颜色数。", "outputFormat": "输出到标准输出。\n\n输出一行一个整数，表示答案对 $10^9+7$ 取模的结果。", "hint": "对于 $100\\%$ 的测试点，$1\\le n\\le 10^9,2\\le m\\le7$ 。\n| 数据点编号 $\\operatorname*{Id}$ | $n$ | $m$ |\n| :----------: | :----------: | :----------: |\n| 1~2 | $n\\le10$ | $m=\\operatorname*{Id}+2$ |\n| 3~8 | $n\\le 10^5,n$ 是质数 | $m=\\operatorname*{Id}-1$ |\n| 9~14 | $n$ 是质数 | $m=\\operatorname*{Id}-7$ |\n| 15~19 | 无特殊约束 | $m=\\operatorname*{Id}-13$ |\n| 20 | $n=635,643,090$ | $m=7$ |", "locale": "zh-CN"}}}
{"pid": "P7455", "type": "P", "difficulty": 7, "samples": [["见附加文件中的 0.in", "见附加文件中的 0.ans"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["计算几何", "2017", "提交答案", "Special Judge", "高斯消元", "THUSC"], "title": "[THUSC 2017] 宇宙广播", "background": "", "description": "威摄纪元公元 2233 年，人类掌握了一项新的科技：基于量子力学原理，在地球表面上的宇宙广播能够超光速地将信号传播到这个点坐标所在的、与地球相切的平面中。\n\n自从万有引力号广播了坐标之后，它带着人类文明的种子，远离太阳系飞向了宇宙深处。\n\nDX3906 星系黑域纪元公元 3333 年，万有引力号找到了一个十分庞大的 X 星系，直径数光年，其中有 3 个适合人类居住的星球，分布在 X 星系不同的角落中。经过商讨之后，万有引力号的部分成员选择留在这三个星球上定居。\n\n对于定居的人类而言，实时通讯是十分必要的，因此一千一百年前发明的那套装置在这时候就派上了用场。显然，三个星球能够互相通讯，当且仅当三个宇宙广播的工作切平面完全重合。\n\n现在，星球球长阿米巴找到了善于编程的你，希望你能够通过编程计算得出所有能够建立宇宙广播的方案。\n\n在你承担了这个任务之后，你在心里说了一句，「这算啥，我 ygg 分分钟搞定」，然而善于读心的阿米巴马上把你叫了回来，语重心长的跟你说，人类文明还要延续，把 $K$ 维空间的 $K$ 个星球的建站方案一起解决了。球长也没太为难你，只要你求 $K\\le10$ 的情况，这是因为宇宙加上时间维之后是 $11$ 维的。\n\n当你用 $3$ 分钟写完程序之后，阿米巴看了看，送给你一张二向箔——因为你没有在程序里考虑到这个情况。\n\n给定坐标维数 $K\\ge2$，以及在 $K$ 维坐标下的 $K$ 个球（**可退化成点**，即半径可以为零），求出这 $K$ 个球的**所有公切面**。\n\n数据保证不会出现无解或无穷多组解的情况，但不保证所有球都是相离的。\n\n以下是一些定义：\n\n- 距离：在 $K$ 维空间中，设有两个点 $A(a_0,a_1,...,a_{K-1}),B(b_0,b_1,...,b_{K-1})$，则 $AB$ 之间的距离 $|AB|=\\sqrt{\\sum_{i=0}^{K-1}(a_i-b_i)^2}$；\n\n- 球：在 $K$ 维空间中，与定点 $A$ 的距离为常数 $r$ 的点集，并同时称点 $A$ 为球心，$r$ 为该球半径；\n\n  当 $K=2$ 时，即为大家在中学所熟知的圆。\n\n- 超平面：到 $K$ 维空间中某两个点 $A,B$ 距离相等的点集；在 $K$ 维空间中，超平面的维数为 $K-1$；\n\n\t当 $K=2$ 时，即为大家在中学所熟知的直线（垂直平分线）。\n\n- 球的切平面：一个超平面 $P$ 与球 $A$ 有且仅有一个交点；\n\n- 球的公切面：一个超平面 $P$ 是所有球的切平面。", "inputFormat": "这是一道提交答案题，共有8组输入数据，这些数据命名为 1.in ~ 8.in。\n\n每个测试点中包含多组数据。对于每个测试点：\n\n- 第一行：测试点包含的数据组数 $T$，保证 $T\\le10$。\n- 对于每组数据：\n\t- 第一行：坐标维数 $K$，保证 $2\\le K\\le10$。\n\t- 接下来 $K$ 行，每行 $K+1$ 个实数。第 $i$ 行的前 $K$ 个数代表第 $i$ 个球的球心所在的坐标，第 $K+1$ 个数代表第 $i$ 个球的半径。", "outputFormat": "对于每组输入数据，你需要提交相应的输出文件 1.out ~ 8.out。\n\n对于每个测试点的每组数据：\n\n- 第一行，一个正整数  $S$，表示在这组数据中你总共找到了 $S$ 组切平面。如果没找到任何一组解，**请务必输出 $0$，否则将会影响后续数据的评分，造成的后果由选手自行承担**；\n- 接下来 $S\\times K$ 行，每行 $K$ 个小数，对于相对的第 $S(i-1)+j$ 行，表示在输出的第 $i$ 个解中，**对应输入**的第 $j$ 个球上的切点坐标；\n- 最后一行，输出一个空行；\n\n**在输出文件的最后，你可以添加任意内容，这不会影响你的得分。我们建议你在此处写一些有意义的内容（如简要方法），以便于我们在考后进行统计分析。单个输出文件大小不得超过 4M。**", "hint": "#### 评分标准\n- 解的输出顺序没有要求。在一组解中，记输出答案为 $A(a_0,a_1,...,a_{K-1})$，如果存在一组标准答案 $B(b_0,b_1,...,b_{K-1})$，满足 $\\sum_{i=0}^{K-1}|A_iB_i|^2\\le10^{-12}$，那么这一组输出答案将会被判定为正确。\n- 在每个测试点的同一组数据中，我们会统计被匹配上的标准答案的公切面的个数，每个标准答案只会被匹配至多一次，输出重复的公切面不倒扣分。第 $i$ 组数据回答正确的比例为被匹配上的标准答案的个数除以标准答案的总个数，记为 $rate_i$。\n- 对于每个测试点的评分方式：\n\t1. 如果你的输出格式不合法，或者参数不符合题目约定，或者某一组的答案个数超过该组标准答案个数的两倍以上（不含两倍），则得0分；\n      1. 在不违背上述条件的情况下，算对其中任何一组数据的任何一个解就至少有一分；并且所有的答案都算对了，才能得\n      1. 在不违背上述条件的情况下，记共有 $T$ 组数据，$rate_i$ 为第 $i$ 组数据回答正确的比例，$score$ 为这个测试点的分值，则 $Yourscore=\\frac{score}{T}\\times\\sum_{i=1}^T\\sqrt{rate_i}$ 在不违背以上原则的情况下四舍五入输出，即 $Yourscore\\in[1,score-1]$。\n各测试点分值不同，具体如下表所示：\n\n| 测试点 | $K\\le$ | 分值 |\n| :----------: | :----------: | :----------: |\n| 1 | $2$ | $5$ |\n| 2 | $2$ | $15$ |\n| 3 | $3$ | $11$ |\n| 4 | $3$ | $14$ |\n| 5 | $3$ | $16$ |\n| 6 | $4$ | $7$ |\n| 7 | $4$ | $9$ |\n| 8 | $10$ | $23$ |\n", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[THUSC 2017] 宇宙广播", "background": "", "description": "威摄纪元公元 2233 年，人类掌握了一项新的科技：基于量子力学原理，在地球表面上的宇宙广播能够超光速地将信号传播到这个点坐标所在的、与地球相切的平面中。\n\n自从万有引力号广播了坐标之后，它带着人类文明的种子，远离太阳系飞向了宇宙深处。\n\nDX3906 星系黑域纪元公元 3333 年，万有引力号找到了一个十分庞大的 X 星系，直径数光年，其中有 3 个适合人类居住的星球，分布在 X 星系不同的角落中。经过商讨之后，万有引力号的部分成员选择留在这三个星球上定居。\n\n对于定居的人类而言，实时通讯是十分必要的，因此一千一百年前发明的那套装置在这时候就派上了用场。显然，三个星球能够互相通讯，当且仅当三个宇宙广播的工作切平面完全重合。\n\n现在，星球球长阿米巴找到了善于编程的你，希望你能够通过编程计算得出所有能够建立宇宙广播的方案。\n\n在你承担了这个任务之后，你在心里说了一句，「这算啥，我 ygg 分分钟搞定」，然而善于读心的阿米巴马上把你叫了回来，语重心长的跟你说，人类文明还要延续，把 $K$ 维空间的 $K$ 个星球的建站方案一起解决了。球长也没太为难你，只要你求 $K\\le10$ 的情况，这是因为宇宙加上时间维之后是 $11$ 维的。\n\n当你用 $3$ 分钟写完程序之后，阿米巴看了看，送给你一张二向箔——因为你没有在程序里考虑到这个情况。\n\n给定坐标维数 $K\\ge2$，以及在 $K$ 维坐标下的 $K$ 个球（**可退化成点**，即半径可以为零），求出这 $K$ 个球的**所有公切面**。\n\n数据保证不会出现无解或无穷多组解的情况，但不保证所有球都是相离的。\n\n以下是一些定义：\n\n- 距离：在 $K$ 维空间中，设有两个点 $A(a_0,a_1,...,a_{K-1}),B(b_0,b_1,...,b_{K-1})$，则 $AB$ 之间的距离 $|AB|=\\sqrt{\\sum_{i=0}^{K-1}(a_i-b_i)^2}$；\n\n- 球：在 $K$ 维空间中，与定点 $A$ 的距离为常数 $r$ 的点集，并同时称点 $A$ 为球心，$r$ 为该球半径；\n\n  当 $K=2$ 时，即为大家在中学所熟知的圆。\n\n- 超平面：到 $K$ 维空间中某两个点 $A,B$ 距离相等的点集；在 $K$ 维空间中，超平面的维数为 $K-1$；\n\n\t当 $K=2$ 时，即为大家在中学所熟知的直线（垂直平分线）。\n\n- 球的切平面：一个超平面 $P$ 与球 $A$ 有且仅有一个交点；\n\n- 球的公切面：一个超平面 $P$ 是所有球的切平面。", "inputFormat": "这是一道提交答案题，共有8组输入数据，这些数据命名为 1.in ~ 8.in。\n\n每个测试点中包含多组数据。对于每个测试点：\n\n- 第一行：测试点包含的数据组数 $T$，保证 $T\\le10$。\n- 对于每组数据：\n\t- 第一行：坐标维数 $K$，保证 $2\\le K\\le10$。\n\t- 接下来 $K$ 行，每行 $K+1$ 个实数。第 $i$ 行的前 $K$ 个数代表第 $i$ 个球的球心所在的坐标，第 $K+1$ 个数代表第 $i$ 个球的半径。", "outputFormat": "对于每组输入数据，你需要提交相应的输出文件 1.out ~ 8.out。\n\n对于每个测试点的每组数据：\n\n- 第一行，一个正整数  $S$，表示在这组数据中你总共找到了 $S$ 组切平面。如果没找到任何一组解，**请务必输出 $0$，否则将会影响后续数据的评分，造成的后果由选手自行承担**；\n- 接下来 $S\\times K$ 行，每行 $K$ 个小数，对于相对的第 $S(i-1)+j$ 行，表示在输出的第 $i$ 个解中，**对应输入**的第 $j$ 个球上的切点坐标；\n- 最后一行，输出一个空行；\n\n**在输出文件的最后，你可以添加任意内容，这不会影响你的得分。我们建议你在此处写一些有意义的内容（如简要方法），以便于我们在考后进行统计分析。单个输出文件大小不得超过 4M。**", "hint": "#### 评分标准\n- 解的输出顺序没有要求。在一组解中，记输出答案为 $A(a_0,a_1,...,a_{K-1})$，如果存在一组标准答案 $B(b_0,b_1,...,b_{K-1})$，满足 $\\sum_{i=0}^{K-1}|A_iB_i|^2\\le10^{-12}$，那么这一组输出答案将会被判定为正确。\n- 在每个测试点的同一组数据中，我们会统计被匹配上的标准答案的公切面的个数，每个标准答案只会被匹配至多一次，输出重复的公切面不倒扣分。第 $i$ 组数据回答正确的比例为被匹配上的标准答案的个数除以标准答案的总个数，记为 $rate_i$。\n- 对于每个测试点的评分方式：\n\t1. 如果你的输出格式不合法，或者参数不符合题目约定，或者某一组的答案个数超过该组标准答案个数的两倍以上（不含两倍），则得0分；\n      1. 在不违背上述条件的情况下，算对其中任何一组数据的任何一个解就至少有一分；并且所有的答案都算对了，才能得\n      1. 在不违背上述条件的情况下，记共有 $T$ 组数据，$rate_i$ 为第 $i$ 组数据回答正确的比例，$score$ 为这个测试点的分值，则 $Yourscore=\\frac{score}{T}\\times\\sum_{i=1}^T\\sqrt{rate_i}$ 在不违背以上原则的情况下四舍五入输出，即 $Yourscore\\in[1,score-1]$。\n各测试点分值不同，具体如下表所示：\n\n| 测试点 | $K\\le$ | 分值 |\n| :----------: | :----------: | :----------: |\n| 1 | $2$ | $5$ |\n| 2 | $2$ | $15$ |\n| 3 | $3$ | $11$ |\n| 4 | $3$ | $14$ |\n| 5 | $3$ | $16$ |\n| 6 | $4$ | $7$ |\n| 7 | $4$ | $9$ |\n| 8 | $10$ | $23$ |\n", "locale": "zh-CN"}}}
{"pid": "P7456", "type": "P", "difficulty": 6, "samples": [["3\naaaaa\na\naa\naaa", "2"], ["5\nabecedadabra\nabec\nab\nceda\ndad\nra", "5"], ["9\nicpcontesticpc\ninternational\ncollegiate\nprogramming\ncontest\ncentral\neurope\nregional\ncontest\nicpc", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["字符串", "2018", "哈希 hashing", "AC 自动机", "KMP 算法", "后缀数组 SA", "ICPC", "CERC"], "title": "[CERC2018] The ABCD Murderer", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [The ABCD Murderer](https://contest.felk.cvut.cz/18cerc/solved/abcd.pdf)**\n\nOscar 特别喜欢看犯罪电影。他钦佩那些罪犯，因为他们富有创造力。他也想展示他的创造力。但很可惜的是，他没什么经验，也想不出来什么原创伎俩。所以他想从已有的招数中寻找灵感。他一直喜欢看罪犯从报纸上剪下字母，然后用这些字母拼勒索信的桥段。然而 Oscar 根本不想抄袭，所以他自己想了一个这种方法的变体。他觉得把字母一个一个拼成文本既无聊又费时间。所以他决定通过剪下一整个单词的方式拼出自己的勒索信。\n\nOscar 买来一些主流报纸，这样他几乎就有了无限的单词库。他可以多次剪出任意特定的单词。然而，他还是被报纸中出现的的单词集限制。问题是一些单词根本没在报纸中出现。为了让这项工作更简单，他决定去除勒索信中所有的标点符号和空格并且忽略字母的大小写。他同时允许剪出的单词互相重叠，只需要重叠部分相同。现在 Oscar 想知道他至少要剪下多少次单词才能拼成他想要的勒索信。", "inputFormat": "第一行包含一个整数 $L$，表示在报纸中发现的单词数；\n\n下一行包含勒索信的内容 $s$。保证内容非空并且只包含小写英文字母。\n\n接下来 $L$ 行，每行包含一个在报纸中出现的单词 $a_i$，保证只出现小写英文字母。这些单词中没有空串，也没有比勒索信长的单词。所有报纸中单词在输入中出现至少一次。", "outputFormat": "输出 Oscar 最少要从报纸中剪下多少次单词才能组成勒索信、如果不能组成，输出 $-1$ 。每个单词都要被记实际从报纸剪下那么多次。", "hint": "$1≤L,|s|,∑|a_i|≤3×10^5$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CERC2018] The ABCD Murderer", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [The ABCD Murderer](https://contest.felk.cvut.cz/18cerc/solved/abcd.pdf)**\n\nOscar 特别喜欢看犯罪电影。他钦佩那些罪犯，因为他们富有创造力。他也想展示他的创造力。但很可惜的是，他没什么经验，也想不出来什么原创伎俩。所以他想从已有的招数中寻找灵感。他一直喜欢看罪犯从报纸上剪下字母，然后用这些字母拼勒索信的桥段。然而 Oscar 根本不想抄袭，所以他自己想了一个这种方法的变体。他觉得把字母一个一个拼成文本既无聊又费时间。所以他决定通过剪下一整个单词的方式拼出自己的勒索信。\n\nOscar 买来一些主流报纸，这样他几乎就有了无限的单词库。他可以多次剪出任意特定的单词。然而，他还是被报纸中出现的的单词集限制。问题是一些单词根本没在报纸中出现。为了让这项工作更简单，他决定去除勒索信中所有的标点符号和空格并且忽略字母的大小写。他同时允许剪出的单词互相重叠，只需要重叠部分相同。现在 Oscar 想知道他至少要剪下多少次单词才能拼成他想要的勒索信。", "inputFormat": "第一行包含一个整数 $L$，表示在报纸中发现的单词数；\n\n下一行包含勒索信的内容 $s$。保证内容非空并且只包含小写英文字母。\n\n接下来 $L$ 行，每行包含一个在报纸中出现的单词 $a_i$，保证只出现小写英文字母。这些单词中没有空串，也没有比勒索信长的单词。所有报纸中单词在输入中出现至少一次。", "outputFormat": "输出 Oscar 最少要从报纸中剪下多少次单词才能组成勒索信、如果不能组成，输出 $-1$ 。每个单词都要被记实际从报纸剪下那么多次。", "hint": "$1≤L,|s|,∑|a_i|≤3×10^5$", "locale": "zh-CN"}}}
{"pid": "P7457", "type": "P", "difficulty": 6, "samples": [["6 15\n0 1 2 1\n2 1 4\n2 1 5\n0 2 3 2\n2 1 4\n2 1 5\n0 3 4 3\n2 1 4\n2 1 5\n0 4 5 4\n2 1 4\n2 1 5\n1 4 5\n2 1 4\n2 1 5", "-1\n-1\n-1\n-1\n3\n-1\n3\n4\n3\n-1"], ["6 6\n0 2 0 4\n0 3 4 3\n0 0 4 1\n0 2 5 4\n2 3 2\n2 4 2", "4\n4"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2018", "ICPC", "线段树分治", "CERC"], "title": "[CERC2018] The Bridge on the River Kawaii", "background": null, "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/)[ The Bridge on the River Kawaii](https://contest.felk.cvut.cz/18cerc/solved/bridge.pdf)**\n\n在遥远的 Midsommer ，有一条叫 delta 的小河，河里无法游泳。这条河周围有一些小岛，小岛之间有桥连接。每座桥都有一个危险系数，表示通过这座桥有多危险。危险系数越高，通过这座桥就越危险。\n\n一位叫做 Richard Hradecki 的侦探兼悬疑小说作家追查案件时需要经过这些桥。每次追查案件，他会在所有可能的路径中选择最安全的一条，也就是经过桥的最大危险系数最低的一条路径。\n\n每次调查案件时，Richard 会从一个岛屿前往要调查的岛屿。他希望你帮他找到最安全的路径。同时，桥的存在情况也会变化。具体的，你需要处理以下三种事件：\n- 当地人在两座岛屿之间建了一座新桥；\n- 一只酸性的毛茸茸的大粉熊 Lug 摧毁了一座桥；\n- Richard 要求你找两个岛屿之间最安全的路线。", "inputFormat": "第一行包含两个整数 $N,Q$。$N$  是岛屿数（岛屿用 $0…N-1$ 标号），$Q$ 是需要处理的事件数。\n\n接下来 $Q$ 行，每行表示一个事件，包含三或四个整数，说明如下（保证 $X,Y$ 为两个不相同的合法的岛屿）：\n\n- `0 X Y V`：在 $X$ 岛与 $Y$ 岛之间建成一座危险系数为 $V$ 的桥；\n- `1 X Y`：连接 $X,Y$ 两岛的桥被摧毁；\n- `2 X Y`：Richard 询问从 $X$ 到 $Y$ 的最安全路径。\n\n保证任意两个岛屿之间最多只存在一座直达的桥，且每次要被摧毁的桥在被摧毁前是存在的（即，保证输入数据合法）。", "outputFormat": "对于每个种类为 $2$ 的事件，输出 $X$ 到 $Y$ 最安全路径上经过的最危险的桥的危险系数。如果 $X$ 与 $Y$ 之间没有路径，输出 $-1$。", "hint": "$2\\le N\\le 10^5,1\\le Q\\le 10^5,0\\le V\\le 10,0\\le X,Y<N,X\\neq Y$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CERC2018] The Bridge on the River Kawaii", "background": null, "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/)[ The Bridge on the River Kawaii](https://contest.felk.cvut.cz/18cerc/solved/bridge.pdf)**\n\n在遥远的 Midsommer ，有一条叫 delta 的小河，河里无法游泳。这条河周围有一些小岛，小岛之间有桥连接。每座桥都有一个危险系数，表示通过这座桥有多危险。危险系数越高，通过这座桥就越危险。\n\n一位叫做 Richard Hradecki 的侦探兼悬疑小说作家追查案件时需要经过这些桥。每次追查案件，他会在所有可能的路径中选择最安全的一条，也就是经过桥的最大危险系数最低的一条路径。\n\n每次调查案件时，Richard 会从一个岛屿前往要调查的岛屿。他希望你帮他找到最安全的路径。同时，桥的存在情况也会变化。具体的，你需要处理以下三种事件：\n- 当地人在两座岛屿之间建了一座新桥；\n- 一只酸性的毛茸茸的大粉熊 Lug 摧毁了一座桥；\n- Richard 要求你找两个岛屿之间最安全的路线。", "inputFormat": "第一行包含两个整数 $N,Q$。$N$  是岛屿数（岛屿用 $0…N-1$ 标号），$Q$ 是需要处理的事件数。\n\n接下来 $Q$ 行，每行表示一个事件，包含三或四个整数，说明如下（保证 $X,Y$ 为两个不相同的合法的岛屿）：\n\n- `0 X Y V`：在 $X$ 岛与 $Y$ 岛之间建成一座危险系数为 $V$ 的桥；\n- `1 X Y`：连接 $X,Y$ 两岛的桥被摧毁；\n- `2 X Y`：Richard 询问从 $X$ 到 $Y$ 的最安全路径。\n\n保证任意两个岛屿之间最多只存在一座直达的桥，且每次要被摧毁的桥在被摧毁前是存在的（即，保证输入数据合法）。", "outputFormat": "对于每个种类为 $2$ 的事件，输出 $X$ 到 $Y$ 最安全路径上经过的最危险的桥的危险系数。如果 $X$ 与 $Y$ 之间没有路径，输出 $-1$。", "hint": "$2\\le N\\le 10^5,1\\le Q\\le 10^5,0\\le V\\le 10,0\\le X,Y<N,X\\neq Y$", "locale": "zh-CN"}}}
{"pid": "P7458", "type": "P", "difficulty": 3, "samples": [["1010", "1"], ["100110000", "3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2018", "ICPC", "CERC"], "title": "[CERC2018] Clockwork ||ange", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [Clockwork ||ange](https://contest.felk.cvut.cz/18cerc/solved/clockwork.pdf)**\n\n据百度百科，兔是哺乳类兔形目兔科下属所有的属的总称。毋庸置疑的是，这段文字不是无聊的，因为它们是原始的，并且组织良好。我们农场的兔子生活在有保护的畜栏里，畜栏的边界装饰有精美的花卉装饰品。畜栏里生长着数十个可爱的橙色胡萝卜。兔子繁殖很快（这很正常，每年都有成千上万的兔子出生），我们的导师希望不费力地把它们安置在畜栏里。\n\n畜栏规则地形成一排。在第一个繁殖季开始时，一些畜栏里可能没有兔子。每个繁殖季结束时，都会进行一次精心策划过的兔子搬迁。搬迁遵循一条简单的公式，这个公式取决于一个正整数 $K$，不同的繁殖季 $K$ 值不一定相同。对于所有畜栏，搬迁工作同时进行。在每个畜栏中，大约有一半的兔子被移到这个畜栏右边第 $K$ 个畜栏里。目标畜栏里原来有没有兔子都没有关系。\n\n如果畜栏离这一排最后一个畜栏太近（即离最后一个畜栏的距离小于 $K$ ），那么这个畜栏中的所有兔子都留在原畜栏，不会进行搬迁。\n\n每个畜栏都可以容纳无限只兔子，并且非空的畜栏中总有足够多能够成功繁殖的兔子。\n\n给定第一个繁殖季开始时畜栏被占用的情况。请求出使得所有畜栏中都有兔子的最少搬迁次数。", "inputFormat": "输入仅有一行，包含一个长度为 $b$ 的字符串，每个字符表示一个畜栏。字符只有 $0$（空畜栏）和 $1$（有兔子的畜栏）两种。第一个字符表示这一排的第一个畜栏。", "outputFormat": "输出使得所有畜栏中都有兔子的最少搬迁次数。如果没有任何一种搬迁方案使得每个畜栏中都有兔子，输出 $-1$。", "hint": "$1≤b≤40$", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CERC2018] Clockwork ||ange", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [Clockwork ||ange](https://contest.felk.cvut.cz/18cerc/solved/clockwork.pdf)**\n\n据百度百科，兔是哺乳类兔形目兔科下属所有的属的总称。毋庸置疑的是，这段文字不是无聊的，因为它们是原始的，并且组织良好。我们农场的兔子生活在有保护的畜栏里，畜栏的边界装饰有精美的花卉装饰品。畜栏里生长着数十个可爱的橙色胡萝卜。兔子繁殖很快（这很正常，每年都有成千上万的兔子出生），我们的导师希望不费力地把它们安置在畜栏里。\n\n畜栏规则地形成一排。在第一个繁殖季开始时，一些畜栏里可能没有兔子。每个繁殖季结束时，都会进行一次精心策划过的兔子搬迁。搬迁遵循一条简单的公式，这个公式取决于一个正整数 $K$，不同的繁殖季 $K$ 值不一定相同。对于所有畜栏，搬迁工作同时进行。在每个畜栏中，大约有一半的兔子被移到这个畜栏右边第 $K$ 个畜栏里。目标畜栏里原来有没有兔子都没有关系。\n\n如果畜栏离这一排最后一个畜栏太近（即离最后一个畜栏的距离小于 $K$ ），那么这个畜栏中的所有兔子都留在原畜栏，不会进行搬迁。\n\n每个畜栏都可以容纳无限只兔子，并且非空的畜栏中总有足够多能够成功繁殖的兔子。\n\n给定第一个繁殖季开始时畜栏被占用的情况。请求出使得所有畜栏中都有兔子的最少搬迁次数。", "inputFormat": "输入仅有一行，包含一个长度为 $b$ 的字符串，每个字符表示一个畜栏。字符只有 $0$（空畜栏）和 $1$（有兔子的畜栏）两种。第一个字符表示这一排的第一个畜栏。", "outputFormat": "输出使得所有畜栏中都有兔子的最少搬迁次数。如果没有任何一种搬迁方案使得每个畜栏中都有兔子，输出 $-1$。", "hint": "$1≤b≤40$", "locale": "zh-CN"}}}
{"pid": "P7459", "type": "P", "difficulty": 5, "samples": [["1 2 160 20 6 40", "31.92569589"], ["1 2 160 10 6 40", "21.65591118"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2018", "Special Judge", "ICPC", "CERC"], "title": "[CERC2018] Reservoir Dog", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [Reservoir Dog](https://contest.felk.cvut.cz/18cerc/solved/dog.pdf)**\n\n你带你的狗来到你家旁边的一个水库玩。你的狗喜欢玩飞盘，但因为你已经厌烦和你的狗玩飞盘了，所以你很好奇从你扔出飞盘到你的狗捡回飞盘回到你这里的总共用时。所以你把狗牵到你身边，然后开始计时。$T_f$ 毫秒这个时刻，你从高度 $H_f$ 毫米的位置以 $V_f$ 毫米每毫秒的初速度水平丢出飞盘。由于重力，在竖直方向对飞盘的加速度为 $1$ 毫米每二次方毫秒。\n\n在 $T_d$ 毫秒这个时刻，你释放了狗，狗的水平速度最大为 $V_d$ 。狗跑在一个理想平面上，并且它足够聪明，知道如何最小化接飞盘并把它带回你这里的时间。为了达到这个目的，狗可以跳 $H_d$ 毫米高，竖直起跳不影响水平速度。狗接到飞盘后，它就会立刻全速跑向你。当狗跑回你的位置时，你停止计时。注意即使你的狗在空中也要停止计时，也就是说狗位于初始位置上方的时候也停止计时。\n\n你的狗很特殊，因为它可以瞬间获得水平速度（无加速或减速过程的），并且即使在空中也可以改变水平速度大小或反转水平速度方向。由于重力，在竖直方向对你的狗的加速度为 $3$ 毫米每二次方毫秒。\n\n为了简便，假设飞盘和你的狗的大小不计。并且本题中可能用到物体位移公式 $s(t)=s_0+v_0t+0.5at^2$，当然如何使用取决于你。", "inputFormat": "输入包含一行六个整数 $T_f,V_f,H_f,T_d,V_d,H_d$。", "outputFormat": "输出你测得的时间（单位：毫秒），如果你的答案与标准答案的绝对误差不超过 $10^{-4}$ 即视为正确。", "hint": "$1≤T_f;V_f,H_f,T_d,V_d,H_d≤10^6,H_d<H_f,T_f<T_d$\n\nClarifications\n\nQ：狗的跳跃过程是怎样的？\n\nA：狗瞬间获得能够跳到 $H_d$ 高度的竖直速度。\n\nQ：当飞盘落在地面上时会继续运动吗？\n\nA：当飞盘落在地面上时瞬间停止运动。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[CERC2018] Reservoir Dog", "background": "", "description": "**译自[ [CERC2018]](https://contest.felk.cvut.cz/18cerc/) [Reservoir Dog](https://contest.felk.cvut.cz/18cerc/solved/dog.pdf)**\n\n你带你的狗来到你家旁边的一个水库玩。你的狗喜欢玩飞盘，但因为你已经厌烦和你的狗玩飞盘了，所以你很好奇从你扔出飞盘到你的狗捡回飞盘回到你这里的总共用时。所以你把狗牵到你身边，然后开始计时。$T_f$ 毫秒这个时刻，你从高度 $H_f$ 毫米的位置以 $V_f$ 毫米每毫秒的初速度水平丢出飞盘。由于重力，在竖直方向对飞盘的加速度为 $1$ 毫米每二次方毫秒。\n\n在 $T_d$ 毫秒这个时刻，你释放了狗，狗的水平速度最大为 $V_d$ 。狗跑在一个理想平面上，并且它足够聪明，知道如何最小化接飞盘并把它带回你这里的时间。为了达到这个目的，狗可以跳 $H_d$ 毫米高，竖直起跳不影响水平速度。狗接到飞盘后，它就会立刻全速跑向你。当狗跑回你的位置时，你停止计时。注意即使你的狗在空中也要停止计时，也就是说狗位于初始位置上方的时候也停止计时。\n\n你的狗很特殊，因为它可以瞬间获得水平速度（无加速或减速过程的），并且即使在空中也可以改变水平速度大小或反转水平速度方向。由于重力，在竖直方向对你的狗的加速度为 $3$ 毫米每二次方毫秒。\n\n为了简便，假设飞盘和你的狗的大小不计。并且本题中可能用到物体位移公式 $s(t)=s_0+v_0t+0.5at^2$，当然如何使用取决于你。", "inputFormat": "输入包含一行六个整数 $T_f,V_f,H_f,T_d,V_d,H_d$。", "outputFormat": "输出你测得的时间（单位：毫秒），如果你的答案与标准答案的绝对误差不超过 $10^{-4}$ 即视为正确。", "hint": "$1≤T_f;V_f,H_f,T_d,V_d,H_d≤10^6,H_d<H_f,T_f<T_d$\n\nClarifications\n\nQ：狗的跳跃过程是怎样的？\n\nA：狗瞬间获得能够跳到 $H_d$ 高度的竖直速度。\n\nQ：当飞盘落在地面上时会继续运动吗？\n\nA：当飞盘落在地面上时瞬间停止运动。", "locale": "zh-CN"}}}
