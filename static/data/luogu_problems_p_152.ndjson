{"pid": "P4078", "type": "P", "difficulty": 6, "samples": [["10 10\n+1 +1 +1 +1 +1 -1 -1 -1 -1 -1\n-1 -1 +1 +1 +1 -1 -1 -1 -1 -1\n-1 -1 +1 +1 +1 +1 +1 +1 +1 +1\n+1 +1 +1 +1 -1 -1 -1 -1 -1 +1\n+1 -1 -1 +1 -1 -1 -1 -1 -1 +1\n+1 +1 +1 +1 -1 -1 -1 -1 -1 +1\n+1 +1 +1 +1 +1 +1 +1 +1 +1 +1\n+1 -1 -1 -1 -1 -1 -1 -1 -1 -1\n+1 +1 +1 +1 -1 +1 +1 +1 +1 +1\n-1 -1 -1 +1 +1 +1 -1 -1 -1 +1", "53"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2016", "各省省选", "山东"], "title": "[SDOI2016] 探险路线", "background": "", "description": "你所面对的丛林，可以被刻画为n行m列的格点图，其中第i行第j列的格子代表了一块区域，每个格子有整数权值v(i,j)（可能为负），表明了访问这一块区域的收益或代价。每一个格子最多只能被访问一次，且不可走出地图的边界，你被要求从第一行第一列出发，到第n行第m列结束，你的目标是最大化途经的所有格子的权值和。\n\n因为一些缘故，你的探险路线受到了一些限制。起初你在起点，之后每一天的行动中，首先你需要选择上下左右中的某一个方向，沿着这个方向走0步（也就是不走）或任意步；之后重新选择一个方向（可以与原来方向相同，也可以是不同的方向），沿着这个方向一直走下去，走到地图的某个边界位置结束这一天的探险。探险可以有任意多天，每一天探险结束的边界位置就是第二天的起点位置，除非这一天就是探险的结束。注意，因为每一块格子只能被访问一次，且你最终的结束点必须是第n行第m列的位置，所以你需要谨慎计划每一天的路线。\n\n你希望知道最优方案下，整个探险之旅的收益有多大，即你可以获得的权值和最大是多少。\n", "inputFormat": "第一行输入两个整数，分别表示总行数n与总列数m。之后n行，每行有m个整数，。其中第i行第j列的整数对应了访问第i行第j列区域的收益或代价。\n", "outputFormat": "输出一个整数，表示最优探险路线中所有被访问格子的权值和。\n", "hint": "对于所有数据3<=n<=800且3<=m<=800，保证收益代价绝对值在100000以内\n", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2016] Expedition Route", "background": "", "description": "The jungle you face can be modeled as a grid with $n$ rows and $m$ columns. The cell in row $i$ and column $j$ represents a region. Each cell has an integer weight $v(i,j)$ (possibly negative), representing the gain or cost of visiting that region. Each cell can be visited at most once, and you may not go outside the grid. You are required to start from the cell in the first row and first column, and finish at the cell in the $n$-th row and $m$-th column. Your goal is to maximize the sum of the weights of all visited cells.\n\nBecause of certain reasons, your expedition route is subject to some restrictions. Initially you are at the start. Then, on each day, you must first choose one direction among up, down, left, and right, and move $0$ steps (i.e., do not move) or any number of steps along this direction; after that, choose a direction again (it can be the same as before or different), and keep moving along that direction until you reach some boundary position of the grid, ending that day's expedition. The expedition can last for any number of days. The boundary position where a day's expedition ends will be the starting position of the next day, unless that day is the end of the expedition. Note that, because each cell can be visited at most once and your final ending point must be at position $(n,m)$, you need to plan each day's route carefully.\n\nYou want to know, under the optimal plan, how large the total gain of the entire expedition can be, that is, the maximum possible sum of the weights of all visited cells.", "inputFormat": "The first line contains two integers, representing the total number of rows $n$ and the total number of columns $m$. Then follow $n$ lines, each containing $m$ integers. The integer in row $i$ and column $j$ corresponds to the gain or cost of visiting the region at row $i$ and column $j$.", "outputFormat": "Output a single integer, the sum of the weights of all visited cells in an optimal expedition route.", "hint": "Constraints: For all testdata, $3 \\le n \\le 800$ and $3 \\le m \\le 800$. The absolute value of each gain or cost is at most $100000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2016] 探险路线", "background": "", "description": "你所面对的丛林，可以被刻画为n行m列的格点图，其中第i行第j列的格子代表了一块区域，每个格子有整数权值v(i,j)（可能为负），表明了访问这一块区域的收益或代价。每一个格子最多只能被访问一次，且不可走出地图的边界，你被要求从第一行第一列出发，到第n行第m列结束，你的目标是最大化途经的所有格子的权值和。\n\n因为一些缘故，你的探险路线受到了一些限制。起初你在起点，之后每一天的行动中，首先你需要选择上下左右中的某一个方向，沿着这个方向走0步（也就是不走）或任意步；之后重新选择一个方向（可以与原来方向相同，也可以是不同的方向），沿着这个方向一直走下去，走到地图的某个边界位置结束这一天的探险。探险可以有任意多天，每一天探险结束的边界位置就是第二天的起点位置，除非这一天就是探险的结束。注意，因为每一块格子只能被访问一次，且你最终的结束点必须是第n行第m列的位置，所以你需要谨慎计划每一天的路线。\n\n你希望知道最优方案下，整个探险之旅的收益有多大，即你可以获得的权值和最大是多少。\n", "inputFormat": "第一行输入两个整数，分别表示总行数n与总列数m。之后n行，每行有m个整数，。其中第i行第j列的整数对应了访问第i行第j列区域的收益或代价。\n", "outputFormat": "输出一个整数，表示最优探险路线中所有被访问格子的权值和。\n", "hint": "对于所有数据3<=n<=800且3<=m<=800，保证收益代价绝对值在100000以内\n", "locale": "zh-CN"}}}
{"pid": "P4079", "type": "P", "difficulty": 5, "samples": [["2\n3 3\n1 2 3 5\n2 3 5 -7\n1 3 3 -7\n3 3\n1 2 3 5\n2 3 5 -7\n1 3 3 7", "Case #1: Yes\nCase #2: No"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["搜索", "2016", "并查集", "各省省选", "山东", "逆元"], "title": "[SDOI2016] 齿轮", "background": null, "description": "现有一个传动系统，包含了 $N$ 个组合齿轮和 $M$ 个链条。每一个链条连接了两个组合齿轮 $u$ 和 $v$，并提供了一个传动比 $x:y$，即如果只考虑这两个组合齿轮，编号为 $u$ 的齿轮转动 $x$ 圈，编号为 $v$ 的齿轮会转动 $y$ 圈。传动比为正表示若编号为 $u$ 的齿轮顺时针转动，则编号为 $v$ 的齿轮也顺时针转动。传动比为负表示若编号为 $u$ 的齿轮顺时针转动，则编号为 $v$ 的齿轮会逆时针转动。若不同链条的传动比不相容，则有些齿轮无法转动。我们希望知道，系统中的这 $N$ 个组合齿轮能否同时转动。\n\n**这个传动系统可能不连通。** 也就是说，不保证任意两个齿轮都被链条直接或间接地连接。", "inputFormat": "有多组数据。\n\n第一行给定整数 $T$，表示总的数据组数，之后依次给出 $T$ 组数据。\n\n每一组数据的第一行给定整数 $N$ 和 $M$，表示齿轮总数和链条总数。\n\n之后有 $M$ 行，依次描述了每一个链条，其中每一行给定四个整数 $u,v,x,y$，表示只考虑这一组联动关系的情况下，编号为 $u$ 的齿轮转动 $x$ 圈，编号为 $v$ 的齿轮会转动 $y$ 圈。保证 $x$ 为正整数，而 $y$ 为非零整数。**请注意 $y$ 有可能为负数。**", "outputFormat": "输出 $T$ 行，每行对应一组数据。首先应该输出标识这是第几组数据，参见样例输出。之后输出判定结果，如果 $N$ 个组合齿轮可以同时正常运行，则输出 `Yes`，否则输出 `No`。", "hint": "### 数据范围\n\n* $1\\leq T\\leq 32$；\n* $1\\leq N\\leq 1000$；\n* $1\\leq M\\leq 10^4$；\n* $1\\leq x,|y|\\leq 100$。", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2016] Gears", "background": "", "description": "There is a transmission system consisting of $N$ compound gears and $M$ chains. Each chain connects two compound gears $u$ and $v$, and provides a transmission ratio $x:y$, meaning that if we consider only these two gears, when gear $u$ turns $x$ turns, gear $v$ will turn $y$ turns. A positive ratio means that if gear $u$ turns clockwise, then gear $v$ also turns clockwise. A negative ratio means that if gear $u$ turns clockwise, then gear $v$ turns counterclockwise. If the transmission ratios provided by different chains are incompatible, some gears cannot turn. We want to know whether all $N$ compound gears in the system can rotate simultaneously.\n\n**This transmission system might be disconnected.** That is, it is not guaranteed that any two gears are connected directly or indirectly by chains.", "inputFormat": "There are multiple test cases.\n\nThe first line contains an integer $T$, the total number of test cases, followed by $T$ test cases.\n\nFor each test case, the first line contains two integers $N$ and $M$, the number of gears and the number of chains.\n\nThen there are $M$ lines, each describing one chain. Each line contains four integers $u, v, x, y$, meaning that, considering only this linkage, when gear $u$ turns $x$ turns, gear $v$ will turn $y$ turns. It is guaranteed that $x$ is a positive integer and $y$ is a nonzero integer. **Note that $y$ can be negative.**", "outputFormat": "Output $T$ lines, one for each test case. First, output an identifier indicating the test case index, as shown in the sample output. Then output the decision: if all $N$ compound gears can run simultaneously, output `Yes`; otherwise, output `No`.", "hint": "Constraints\n\n- $1\\leq T\\leq 32$.\n- $1\\leq N\\leq 1000$.\n- $1\\leq M\\leq 10^4$.\n- $1\\leq x,|y|\\leq 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2016] 齿轮", "background": null, "description": "现有一个传动系统，包含了 $N$ 个组合齿轮和 $M$ 个链条。每一个链条连接了两个组合齿轮 $u$ 和 $v$，并提供了一个传动比 $x:y$，即如果只考虑这两个组合齿轮，编号为 $u$ 的齿轮转动 $x$ 圈，编号为 $v$ 的齿轮会转动 $y$ 圈。传动比为正表示若编号为 $u$ 的齿轮顺时针转动，则编号为 $v$ 的齿轮也顺时针转动。传动比为负表示若编号为 $u$ 的齿轮顺时针转动，则编号为 $v$ 的齿轮会逆时针转动。若不同链条的传动比不相容，则有些齿轮无法转动。我们希望知道，系统中的这 $N$ 个组合齿轮能否同时转动。\n\n**这个传动系统可能不连通。** 也就是说，不保证任意两个齿轮都被链条直接或间接地连接。", "inputFormat": "有多组数据。\n\n第一行给定整数 $T$，表示总的数据组数，之后依次给出 $T$ 组数据。\n\n每一组数据的第一行给定整数 $N$ 和 $M$，表示齿轮总数和链条总数。\n\n之后有 $M$ 行，依次描述了每一个链条，其中每一行给定四个整数 $u,v,x,y$，表示只考虑这一组联动关系的情况下，编号为 $u$ 的齿轮转动 $x$ 圈，编号为 $v$ 的齿轮会转动 $y$ 圈。保证 $x$ 为正整数，而 $y$ 为非零整数。**请注意 $y$ 有可能为负数。**", "outputFormat": "输出 $T$ 行，每行对应一组数据。首先应该输出标识这是第几组数据，参见样例输出。之后输出判定结果，如果 $N$ 个组合齿轮可以同时正常运行，则输出 `Yes`，否则输出 `No`。", "hint": "### 数据范围\n\n* $1\\leq T\\leq 32$；\n* $1\\leq N\\leq 1000$；\n* $1\\leq M\\leq 10^4$；\n* $1\\leq x,|y|\\leq 100$。", "locale": "zh-CN"}}}
{"pid": "P4080", "type": "P", "difficulty": 7, "samples": [["8 6\n1 0 0\n1 1 0\n1 0 1\n1 1 1\n0 0 0\n0 1 0\n0 0 1\n0 1 1\n4 1 2 4 3\n4 2 6 8 4\n4 6 5 7 8\n4 5 1 3 7\n4 3 4 8 7\n4 1 5 6 2", "0.1666667\n0.1666667\n0.1666667\n0.1666667\n0.1666667\n0.1666667"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2016", "各省省选", "山东", "向量"], "title": "[SDOI2016] 平凡的骰子", "background": "", "description": "这是一枚平凡的骰子。它是一个均质凸多面体，表面有n个端点，有f个面，每一面是一个凸多边形，且任意两面不共面。将这枚骰子抛向空中，骰子落地的时候不会发生二次弹跳（这是一种非常理想的情况）。\n\n你希望知道最终每一面着地的概率。每一面着地的概率可以用如下的方法计算：我们假设O为骰子的重心，并以O为球心，做半径为1的单位球面（记为S）。\n\n我们知道S的表面积即单位球的表面积，为4\\*pi，这里pi为圆周率。对于骰子的某一面C来说，球面S上存在一块区域T满足：当下落时若骰子所受重力方向与S的交点落在T中，则C就是最终着地的一面。那么C着地的概率为区域T的面积除以4\\*pi。\n\n为了能更好地辅助计算球面上一块区域的面积，我们给出单位球面S上三角形的面积计算公式。考虑单位球面S上的三个两两相交的大圆，交点依次为A，B和C。则曲面三角形ABC的面积为 $\\text{Area}(ABC)=\\alpha+\\beta+\\gamma-\\pi$，其中 $\\alpha,\\beta , \\gamma$ 分别对应了三个二面角的大小。如下图所示。\n\n ![](https://cdn.luogu.com.cn/upload/pic/12756.png) \n\n我们保证：每一面着地的时候，重心的垂心都恰好在这一面内。也就是说不会出现摆不稳的情况。\n", "inputFormat": "第一行输入两个整数，分别表示端点总数n与表面总数f，分别从1开始编号。\n\n之后n行，每行有三个浮点数x，y和z，给出了每一个端点的坐标。\n\n之后f行依次描述了每一块表面，首先给出不小于3的整数d，表示这一面的端点个数，之后d个整数按照逆时针方向（视角在骰子的外面）给出了每一个端点的编号。\n", "outputFormat": "输出f行，第i行有一个浮点数，表示第i个面着地的概率。本题中您的输出应该保留距离答案最近的7位小数，即在需要保留7位小数的前提之下与标准答案最接近。数据保证可以避免对小数点后第八位四舍五入后产生的精度误差\n", "hint": "对于所有数据，4<=n<=50且4<=m<=50，所有坐标的绝对值都在10000以内\n", "locale": "zh-CN", "translations": {"en": {"title": "[SDOI2016] Ordinary Die", "background": "# Description\n\nThis is an ordinary die. It is a homogeneous convex polyhedron with $n$ vertices and $f$ faces. Each face is a convex polygon, and any two faces are not coplanar. When the die is thrown into the air, it will not bounce a second time upon landing (an idealized assumption).\n\nYou want to know the probability that each face ends up on the ground. The probability for each face can be computed as follows: let $O$ be the center of mass of the die, and let $S$ be the unit sphere of radius $1$ centered at $O$.\n\nThe surface area of $S$ is the surface area of the unit sphere, namely $4\\pi$, where $\\pi$ is the circle constant. For a face $C$ of the die, there exists a region $T$ on the sphere $S$ such that: when the die falls, if the direction of gravity intersects $S$ at a point within $T$, then $C$ is the face that ultimately lands on the ground. Therefore, the probability that $C$ lands is the area of region $T$ divided by $4\\pi$.\n\nTo better assist in computing areas of regions on the sphere, we provide the area formula for a spherical triangle on the unit sphere $S$. Consider three pairwise intersecting great circles on $S$, with intersection points $A$, $B$, and $C$ in order. Then the area of the spherical triangle $ABC$ is $\\text{Area}(ABC)=\\alpha+\\beta+\\gamma-\\pi$, where $\\alpha,\\beta , \\gamma$ are the three angles. See the figure below.\n\n![](https://cdn.luogu.com.cn/upload/pic/12756.png)\n\nWe guarantee that whenever a face lands on the ground, the orthogonal projection of the center of mass onto that face lies strictly inside the face. In other words, the die will not wobble unstably.", "description": "This is an ordinary die. It is a homogeneous convex polyhedron with $n$ vertices and $f$ faces. Each face is a convex polygon, and any two faces are not coplanar. When the die is thrown into the air, it will not bounce a second time upon landing (an idealized assumption).\n\nYou want to know the probability that each face ends up on the ground. The probability for each face can be computed as follows: let $O$ be the center of mass of the die, and let $S$ be the unit sphere of radius $1$ centered at $O$.\n\nThe surface area of $S$ is the surface area of the unit sphere, namely $4\\pi$, where $\\pi$ is the circle constant. For a face $C$ of the die, there exists a region $T$ on the sphere $S$ such that: when the die falls, if the direction of gravity intersects $S$ at a point within $T$, then $C$ is the face that ultimately lands on the ground. Therefore, the probability that $C$ lands is the area of region $T$ divided by $4\\pi$.\n\nTo better assist in computing areas of regions on the sphere, we provide the area formula for a spherical triangle on the unit sphere $S$. Consider three pairwise intersecting great circles on $S$, with intersection points $A$, $B$, and $C$ in order. Then the area of the spherical triangle $ABC$ is $\\text{Area}(ABC)=\\alpha+\\beta+\\gamma-\\pi$, where $\\alpha,\\beta , \\gamma$ are the three angles. See the figure below.\n\n![](https://cdn.luogu.com.cn/upload/pic/12756.png)\n\nWe guarantee that whenever a face lands on the ground, the orthogonal projection of the center of mass onto that face lies strictly inside the face. In other words, the die will not wobble unstably.\n\n# Description", "inputFormat": "The first line contains two integers, the total number of vertices $n$ and the total number of faces $f$. Vertex indices are $1$-indexed.\n\nThe next $n$ lines each contain three floating-point numbers $x$, $y$, and $z$, giving the coordinates of each vertex.\n\nThe next $f$ lines each describe one face. Each line begins with an integer $d \\ge 3$ indicating the number of vertices on that face, followed by $d$ integers giving, in counterclockwise order as seen from outside the die, the indices of the vertices.", "outputFormat": "Output $f$ lines. The $i$-th line contains a floating-point number, which is the probability that the $i$-th face lands on the ground. Your output should keep 7 digits after the decimal and be the value closest to the reference answer under the constraint of keeping 7 decimal places. The testdata guarantees that there is no precision ambiguity caused by rounding at the 8th decimal place.", "hint": "Constraints:\n- For all testdata, $4 \\le n \\le 50$ and $4 \\le f \\le 50$.\n- The absolute value of each coordinate is at most $10000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[SDOI2016] 平凡的骰子", "background": "", "description": "这是一枚平凡的骰子。它是一个均质凸多面体，表面有n个端点，有f个面，每一面是一个凸多边形，且任意两面不共面。将这枚骰子抛向空中，骰子落地的时候不会发生二次弹跳（这是一种非常理想的情况）。\n\n你希望知道最终每一面着地的概率。每一面着地的概率可以用如下的方法计算：我们假设O为骰子的重心，并以O为球心，做半径为1的单位球面（记为S）。\n\n我们知道S的表面积即单位球的表面积，为4\\*pi，这里pi为圆周率。对于骰子的某一面C来说，球面S上存在一块区域T满足：当下落时若骰子所受重力方向与S的交点落在T中，则C就是最终着地的一面。那么C着地的概率为区域T的面积除以4\\*pi。\n\n为了能更好地辅助计算球面上一块区域的面积，我们给出单位球面S上三角形的面积计算公式。考虑单位球面S上的三个两两相交的大圆，交点依次为A，B和C。则曲面三角形ABC的面积为 $\\text{Area}(ABC)=\\alpha+\\beta+\\gamma-\\pi$，其中 $\\alpha,\\beta , \\gamma$ 分别对应了三个二面角的大小。如下图所示。\n\n ![](https://cdn.luogu.com.cn/upload/pic/12756.png) \n\n我们保证：每一面着地的时候，重心的垂心都恰好在这一面内。也就是说不会出现摆不稳的情况。\n", "inputFormat": "第一行输入两个整数，分别表示端点总数n与表面总数f，分别从1开始编号。\n\n之后n行，每行有三个浮点数x，y和z，给出了每一个端点的坐标。\n\n之后f行依次描述了每一块表面，首先给出不小于3的整数d，表示这一面的端点个数，之后d个整数按照逆时针方向（视角在骰子的外面）给出了每一个端点的编号。\n", "outputFormat": "输出f行，第i行有一个浮点数，表示第i个面着地的概率。本题中您的输出应该保留距离答案最近的7位小数，即在需要保留7位小数的前提之下与标准答案最接近。数据保证可以避免对小数点后第八位四舍五入后产生的精度误差\n", "hint": "对于所有数据，4<=n<=50且4<=m<=50，所有坐标的绝对值都在10000以内\n", "locale": "zh-CN"}}}
{"pid": "P4081", "type": "P", "difficulty": 6, "samples": [["3\namy\ntommy\nbessie", "3\n11\n19"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["字符串", "2017", "USACO", "后缀自动机 SAM", "后缀数组 SA"], "title": "[USACO17DEC] Standing Out from the Herd P", "background": "", "description": "Just like humans, cows often appreciate feeling they are unique in some way. Since Farmer John's cows all come from the same breed and look quite similar, they want to measure uniqueness in their names.\n\nEach cow's name has some number of substrings. For example, \"amy\" has substrings {a, m, y, am, my, amy}, and \"tommy\" would have the following substrings: {t, o, m, y, to, om, mm, my, tom, omm, mmy, tomm, ommy, tommy}.\n\nA cow name has a \"uniqueness factor\" which is the number of substrings of that name not shared with any other cow. For example, If amy was in a herd by herself, her uniqueness factor would be 6. If tommy was in a herd by himself, his uniqueness factor would be 14. If they were in a herd together, however, amy's uniqueness factor would be 3 and tommy's would be 11.\n\nGiven a herd of cows, please determine each cow's uniqueness factor.", "inputFormat": "The first line of input will contain $N$ ($1 \\le N \\le 10^5$). The following $N$ lines will each contain the name of a cow in the herd. Each name will contain only lowercase characters a-z. The total length of all names will not exceed $10^5$.\n", "outputFormat": "Output $N$ numbers, one per line, describing the uniqueness factor of each cow.\n", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO17DEC] Standing Out from the Herd P", "background": "", "description": "Just like humans, cows often appreciate feeling they are unique in some way. Since Farmer John's cows all come from the same breed and look quite similar, they want to measure uniqueness in their names.\n\nEach cow's name has some number of substrings. For example, \"amy\" has substrings {a, m, y, am, my, amy}, and \"tommy\" would have the following substrings: {t, o, m, y, to, om, mm, my, tom, omm, mmy, tomm, ommy, tommy}.\n\nA cow name has a \"uniqueness factor\" which is the number of substrings of that name not shared with any other cow. For example, If amy was in a herd by herself, her uniqueness factor would be 6. If tommy was in a herd by himself, his uniqueness factor would be 14. If they were in a herd together, however, amy's uniqueness factor would be 3 and tommy's would be 11.\n\nGiven a herd of cows, please determine each cow's uniqueness factor.", "inputFormat": "The first line of input will contain $N$ ($1 \\le N \\le 10^5$). The following $N$ lines will each contain the name of a cow in the herd. Each name will contain only lowercase characters a-z. The total length of all names will not exceed $10^5$.\n", "outputFormat": "Output $N$ numbers, one per line, describing the uniqueness factor of each cow.\n", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO17DEC] Standing Out from the Herd P", "background": "", "description": "就像人类一样，奶牛也常常希望在某些方面感到自己与众不同。由于 Farmer John 的奶牛都来自同一品种且外观非常相似，它们希望通过名字来衡量独特性。\n\n每头奶牛的名字都有一些子字符串。例如，\"amy\" 的子字符串为 {a, m, y, am, my, amy}，而 \"tommy\" 的子字符串为 {t, o, m, y, to, om, mm, my, tom, omm, mmy, tomm, ommy, tommy}。\n\n一头奶牛的名字有一个“独特性因子”，即该名字中不与任何其他奶牛共享的子字符串的数量。例如，如果 amy 独自在一个牛群中，她的独特性因子为 6。如果 tommy 独自在一个牛群中，他的独特性因子为 14。然而，如果它们在一个牛群中，amy 的独特性因子为 3，而 tommy 的独特性因子为 11。\n\n给定一个牛群，请计算每头奶牛的独特性因子。", "inputFormat": "输入的第一行包含 $N$（$1 \\le N \\le 10^5$）。接下来的 $N$ 行每行包含牛群中一头奶牛的名字。每个名字仅包含小写字母 a-z。所有名字的总长度不超过 $10^5$。", "outputFormat": "输出 $N$ 个数字，每行一个，表示每头奶牛的独特性因子。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4082", "type": "P", "difficulty": 7, "samples": [["5 5 4\n##.##\n##.##\nA.B..\n##.##\n##.##\n3 2\n3 5\n1 3\n5 3", "NO\nYES\nNO\nNO"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2017", "USACO", "广度优先搜索 BFS", "深度优先搜索 DFS"], "title": "[USACO17DEC] Push a Box P", "background": null, "description": "**题目译自 [USACO 2017 December Contest, Platinum](http://usaco.org/index.php?page=dec17results) Problem 2. [Push a Box](http://usaco.org/index.php?page=viewproblem2&cpid=769)**\n\n一个谷仓是一个 $N \\times M$ 的矩形网格，有一些网格里有干草。 Bessie 站在其中一个格子内，还有一个格子里有一个大木箱。 Bessie 不能和大木箱在一个格子里，也不能和干草在一个格子里。\n\n如果她不与干草在同一个格子，她就可以往自己旁边的四个方向（东西南北）移动，如果她想移动到有木箱的格子里，那个木箱就会被她推一格（只要木箱的那个方向还有空间），如果没有空间，那 Bessie 就不能移动了。\n\n给你谷仓的布局（空格子，干草以及木箱位置）以及 Bessie 的出发位置和箱子要被推到的位置，请你帮忙计算 Bessie 能不能把木箱推到指定位置。", "inputFormat": "第一行有三个数 $N,M,Q$，其中 $N$ 是谷仓的行数，$M$ 是列数，$Q$ 是询问数。\n\n接下来 $N$ 行是谷仓的初始布局，其中 `.` 代表空格子， `#` 代表干草格子， `A` 代表 Bessie 的初始位置， `B` 是木箱的初始位置。\n\n接下来 $Q$ 行，每行一个坐标 $(R,C)$ ，代表第 $R$ 行第 $C$ 列。对于每行，你要输出 Bessie 是否有可能把箱子推到这个位置。", "outputFormat": "$Q$ 行，每行一个答案，如果 Bessie 能走到，输出 `YES` ，否则输出 `NO` 。", "hint": "对于 $100\\%$ 的数据，保证 $1\\leq N,M \\leq 1500$，$1\\leq Q\\leq 50000$。", "locale": "zh-CN", "translations": {"en": {"title": "[USACO17DEC] Push a Box P", "background": "", "description": "Translated from [USACO 2017 December Contest, Platinum](http://usaco.org/index.php?page=dec17results) Problem 2: [Push a Box](http://usaco.org/index.php?page=viewproblem2&cpid=769).\n\nA barn is an $N \\times M$ rectangular grid, and some cells contain hay bales. Bessie stands in one cell, and a large crate occupies another cell. Bessie cannot be in the same cell as the crate, nor in the same cell as a hay bale.\n\nFrom any empty cell, she may move to any of its four orthogonally adjacent cells (north, south, east, west). If she attempts to move into the cell containing the crate, the crate is pushed one cell further in the same direction, provided the next cell in that direction is within bounds and empty (i.e., not a hay bale or outside the grid); otherwise, the move is not allowed. After a successful push, Bessie occupies the crate’s previous cell.\n\nGiven the barn layout (empty cells, hay bales, and the crate), along with Bessie’s starting position and the target positions for the crate, determine whether Bessie can push the crate to each specified target cell.", "inputFormat": "The first line contains three integers $N, M, Q$, where $N$ is the number of rows, $M$ is the number of columns, and $Q$ is the number of queries.\n\nThe next $N$ lines describe the initial layout of the barn, where `.` denotes an empty cell, `#` denotes a hay bale, `A` denotes Bessie’s initial position, and `B` denotes the crate’s initial position.\n\nThe next $Q$ lines each contain a coordinate $(R, C)$, representing row $R$ and column $C$. For each line, determine whether Bessie can push the crate to this cell.", "outputFormat": "Output $Q$ lines. For each query, print `YES` if Bessie can push the crate to the specified cell; otherwise, print `NO`.", "hint": "For $100\\%$ of the testdata, it is guaranteed that $1 \\leq N, M \\leq 1500$ and $1 \\leq Q \\leq 50000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[USACO17DEC] Push a Box P", "background": null, "description": "**题目译自 [USACO 2017 December Contest, Platinum](http://usaco.org/index.php?page=dec17results) Problem 2. [Push a Box](http://usaco.org/index.php?page=viewproblem2&cpid=769)**\n\n一个谷仓是一个 $N \\times M$ 的矩形网格，有一些网格里有干草。 Bessie 站在其中一个格子内，还有一个格子里有一个大木箱。 Bessie 不能和大木箱在一个格子里，也不能和干草在一个格子里。\n\n如果她不与干草在同一个格子，她就可以往自己旁边的四个方向（东西南北）移动，如果她想移动到有木箱的格子里，那个木箱就会被她推一格（只要木箱的那个方向还有空间），如果没有空间，那 Bessie 就不能移动了。\n\n给你谷仓的布局（空格子，干草以及木箱位置）以及 Bessie 的出发位置和箱子要被推到的位置，请你帮忙计算 Bessie 能不能把木箱推到指定位置。", "inputFormat": "第一行有三个数 $N,M,Q$，其中 $N$ 是谷仓的行数，$M$ 是列数，$Q$ 是询问数。\n\n接下来 $N$ 行是谷仓的初始布局，其中 `.` 代表空格子， `#` 代表干草格子， `A` 代表 Bessie 的初始位置， `B` 是木箱的初始位置。\n\n接下来 $Q$ 行，每行一个坐标 $(R,C)$ ，代表第 $R$ 行第 $C$ 列。对于每行，你要输出 Bessie 是否有可能把箱子推到这个位置。", "outputFormat": "$Q$ 行，每行一个答案，如果 Bessie 能走到，输出 `YES` ，否则输出 `NO` 。", "hint": "对于 $100\\%$ 的数据，保证 $1\\leq N,M \\leq 1500$，$1\\leq Q\\leq 50000$。", "locale": "zh-CN"}}}
{"pid": "P4083", "type": "P", "difficulty": 6, "samples": [["2 1\n1 1\n5 0\n4 2\n1 4", "3\n1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2017", "二分", "USACO", "并查集", "图论建模", "最短路"], "title": "[USACO17DEC] A Pie for a Pie G", "background": "", "description": "Bessie and Elsie have each baked $N$ pies ($1 \\leq N \\leq 10^5$). Each of the $2N$ pies has a tastiness value according to Bessie and a (possibly different) tastiness value according to Elsie.\n\nBessie is thinking about giving one of her pies to Elsie. If Elsie receives a pie from Bessie, she will feel obligated to give one of her pies to Bessie. So as to not appear stingy nor flamboyant, Elsie will try to pick a pie that is at least as tasty (in Elsie's eyes) as the pie she received, but no more than $D$ units tastier ($0 \\leq D \\leq 10^9$). Such a pie may not exist, in which case Elsie will adopt a pseudonym and exile herself to Japan.\n\n\nBut if Elsie does give Bessie a pie in return, Bessie will similarly try to give Elsie a pie which is at least as tasty but no more than $D$ units tastier (in Bessie's eyes) as the pie Elsie just gave her. Should this be impossible, Bessie too will exile herself. Otherwise she will give her chosen pie to Elsie. This cycle will continue until one of the cows is exiled, an unhappy outcome, or one of the cows receives a pie which she accords a tastiness value of $0$, in which case the gift exchange will end and both cows will be happy.\n\n\nNote that a pie may not be gifted twice, nor can either cow return a pie gifted to her.\n\n\nFor each of the $N$ pies Bessie could select as her initial gift to Elsie, determine the minimum number of pies that could possibly be gifted in the resulting exchange before the cows are happy.\n", "inputFormat": "The first line contains the two integers $N$ and $D$.\n\nThe next $2N$ lines contain two space-separated integers each, respectively denoting the value of a particular pie according to Bessie, and the value of that pie according to Elsie.\n\n\nThe first $N$ lines refer to Bessie's pies, and the remaining $N$ lines refer to Elsie's pies.\n\n\nIt is guaranteed that all tastiness values are in the range $[0,10^9]$.\n", "outputFormat": "There should be $N$ lines in the output. Line $i$ should contain a single integer: the minimum number of pies that could be gifted in a happy gift exchange started with Bessie's pie $i$. If no gift exchange starting with pie $i$ is happy, then line $i$ should contain the single integer $-1$ instead.\n", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO17DEC] A Pie for a Pie G", "background": "", "description": "Bessie and Elsie have each baked $N$ pies ($1 \\leq N \\leq 10^5$). Each of the $2N$ pies has a tastiness value according to Bessie and a (possibly different) tastiness value according to Elsie.\n\nBessie is thinking about giving one of her pies to Elsie. If Elsie receives a pie from Bessie, she will feel obligated to give one of her pies to Bessie. So as to not appear stingy nor flamboyant, Elsie will try to pick a pie that is at least as tasty (in Elsie's eyes) as the pie she received, but no more than $D$ units tastier ($0 \\leq D \\leq 10^9$). Such a pie may not exist, in which case Elsie will adopt a pseudonym and exile herself to Japan.\n\n\nBut if Elsie does give Bessie a pie in return, Bessie will similarly try to give Elsie a pie which is at least as tasty but no more than $D$ units tastier (in Bessie's eyes) as the pie Elsie just gave her. Should this be impossible, Bessie too will exile herself. Otherwise she will give her chosen pie to Elsie. This cycle will continue until one of the cows is exiled, an unhappy outcome, or one of the cows receives a pie which she accords a tastiness value of $0$, in which case the gift exchange will end and both cows will be happy.\n\n\nNote that a pie may not be gifted twice, nor can either cow return a pie gifted to her.\n\n\nFor each of the $N$ pies Bessie could select as her initial gift to Elsie, determine the minimum number of pies that could possibly be gifted in the resulting exchange before the cows are happy.\n", "inputFormat": "The first line contains the two integers $N$ and $D$.\n\nThe next $2N$ lines contain two space-separated integers each, respectively denoting the value of a particular pie according to Bessie, and the value of that pie according to Elsie.\n\n\nThe first $N$ lines refer to Bessie's pies, and the remaining $N$ lines refer to Elsie's pies.\n\n\nIt is guaranteed that all tastiness values are in the range $[0,10^9]$.\n", "outputFormat": "There should be $N$ lines in the output. Line $i$ should contain a single integer: the minimum number of pies that could be gifted in a happy gift exchange started with Bessie's pie $i$. If no gift exchange starting with pie $i$ is happy, then line $i$ should contain the single integer $-1$ instead.\n", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO17DEC] A Pie for a Pie G", "background": "", "description": "Bessie 和 Elsie 各自烤了 $N$ 个派（$1 \\leq N \\leq 10^5$）。这 $2N$ 个派中的每一个都有一个由 Bessie 评定的美味值和一个（可能不同的）由 Elsie 评定的美味值。\n\nBessie 正在考虑将她的一只派送给 Elsie。如果 Elsie 收到了 Bessie 的派，她会觉得有义务回赠 Bessie 一只派。为了既不显得吝啬也不显得炫耀，Elsie 会尝试选择一只在她看来至少与收到的派一样美味，但不超过 $D$ 单位更美味的派（$0 \\leq D \\leq 10^9$）。如果这样的派不存在，Elsie 将采用一个化名并自我流放到日本。\n\n但如果 Elsie 确实回赠了 Bessie 一只派，Bessie 也会类似地尝试送给 Elsie 一只在她看来至少与 Elsie 刚送给她的派一样美味，但不超过 $D$ 单位更美味的派。如果这不可能，Bessie 也会自我流放。否则，她会将她选择的派送给 Elsie。这个循环将继续，直到其中一头奶牛被流放（一个不愉快的结果），或者其中一头奶牛收到一只她评定美味值为 $0$ 的派，在这种情况下，礼物交换将结束，两头奶牛都会感到高兴。\n\n请注意，一只派不能被赠送两次，任何一头奶牛也不能回赠她收到的派。\n\n对于 Bessie 可以选择作为初始礼物送给 Elsie 的每一只派，确定在奶牛们感到高兴之前，可能被赠送的派的最小数量。", "inputFormat": "第一行包含两个整数 $N$ 和 $D$。\n\n接下来的 $2N$ 行每行包含两个用空格分隔的整数，分别表示某只派由 Bessie 评定的美味值和由 Elsie 评定的美味值。\n\n前 $N$ 行描述 Bessie 的派，剩下的 $N$ 行描述 Elsie 的派。\n\n保证所有美味值都在 $[0,10^9]$ 范围内。", "outputFormat": "输出应包含 $N$ 行。第 $i$ 行应包含一个整数：如果以 Bessie 的第 $i$ 只派开始的礼物交换是高兴的，则输出可能被赠送的派的最小数量；否则输出 $-1$。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4084", "type": "P", "difficulty": 4, "samples": [["4 1\n1 2\n1 3\n1 4\n4 3", "8"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "2017", "USACO", "树形 DP"], "title": "[USACO17DEC] Barn Painting G", "background": "", "description": "Farmer John has a large farm with $N$ barns ($1 \\le N \\le 10^5$), some of which are already painted and some not yet painted. Farmer John wants to paint these remaining barns so that all the barns are painted, but he only has three paint colors available. Moreover, his prize cow Bessie becomes confused if two barns that are directly reachable from one another are the same color, so he wants to make sure this situation does not happen.\n\nIt is guaranteed that the connections between the $N$ barns do not form any 'cycles'. That is, between any two barns, there is at most one sequence of connections that will lead from one to the other.\n\n\nHow many ways can Farmer John paint the remaining yet-uncolored barns?\n", "inputFormat": "The first line contains two integers $N$ and $K$ ($0 \\le K \\le N$), respectively the number of barns on the farm and the number of barns that have already been painted.\n\n\nThe next $N-1$ lines each contain two integers $x$ and $y$ ($1 \\le x, y \\le N, x \\neq y$) describing a path directly connecting barns $x$ and $y$.\n\n\nThe next $K$ lines each contain two integers $b$ and $c$ ($1 \\le b \\le N$, $1 \\le c \\le 3$) indicating that barn $b$ is painted with color $c$.\n", "outputFormat": "Compute the number of valid ways to paint the remaining barns, modulo $10^9 + 7$, such that no two barns which are directly connected are the same color.\n", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO17DEC] Barn Painting G", "background": "", "description": "Farmer John has a large farm with $N$ barns ($1 \\le N \\le 10^5$), some of which are already painted and some not yet painted. Farmer John wants to paint these remaining barns so that all the barns are painted, but he only has three paint colors available. Moreover, his prize cow Bessie becomes confused if two barns that are directly reachable from one another are the same color, so he wants to make sure this situation does not happen.\n\nIt is guaranteed that the connections between the $N$ barns do not form any 'cycles'. That is, between any two barns, there is at most one sequence of connections that will lead from one to the other.\n\n\nHow many ways can Farmer John paint the remaining yet-uncolored barns?\n", "inputFormat": "The first line contains two integers $N$ and $K$ ($0 \\le K \\le N$), respectively the number of barns on the farm and the number of barns that have already been painted.\n\n\nThe next $N-1$ lines each contain two integers $x$ and $y$ ($1 \\le x, y \\le N, x \\neq y$) describing a path directly connecting barns $x$ and $y$.\n\n\nThe next $K$ lines each contain two integers $b$ and $c$ ($1 \\le b \\le N$, $1 \\le c \\le 3$) indicating that barn $b$ is painted with color $c$.\n", "outputFormat": "Compute the number of valid ways to paint the remaining barns, modulo $10^9 + 7$, such that no two barns which are directly connected are the same color.\n", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO17DEC] Barn Painting G", "background": "", "description": "Farmer John 有一个大农场，农场上有 $N$ 个谷仓（$1 \\le N \\le 10^5$），其中一些已经涂色，另一些尚未涂色。Farmer John 想要为这些剩余的谷仓涂色，使得所有谷仓都被涂色，但他只有三种可用的油漆颜色。此外，他的获奖奶牛 Bessie 如果发现两个直接相连的谷仓颜色相同，会感到困惑，因此他希望确保这种情况不会发生。\n\n保证 $N$ 个谷仓之间的连接不会形成任何“环”。也就是说，任意两个谷仓之间最多只有一条连接路径。\n\nFarmer John 有多少种方式可以为剩余的未涂色谷仓涂色？", "inputFormat": "第一行包含两个整数 $N$ 和 $K$（$0 \\le K \\le N$），分别表示农场上的谷仓数量和已经涂色的谷仓数量。\n\n接下来的 $N-1$ 行每行包含两个整数 $x$ 和 $y$（$1 \\le x, y \\le N, x \\neq y$），描述直接连接谷仓 $x$ 和 $y$ 的路径。\n\n接下来的 $K$ 行每行包含两个整数 $b$ 和 $c$（$1 \\le b \\le N$, $1 \\le c \\le 3$），表示谷仓 $b$ 已经被涂成颜色 $c$。", "outputFormat": "计算为剩余谷仓涂色的有效方式数量，模 $10^9 + 7$，要求任何两个直接相连的谷仓颜色不同。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4085", "type": "P", "difficulty": 3, "samples": [["5 10\n4 10\n6 15\n3 5\n4 9\n3 6", "9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2017", "线段树", "二分", "USACO", "单调队列", "前缀和", "ST 表", "双指针 two-pointer", "单调栈"], "title": "[USACO17DEC] Haybale Feast G", "background": "", "description": "Farmer John is preparing a delicious meal for his cows! In his barn, he has $N$ haybales ($1 \\le N \\le 100,000$). The $i$th haybale has a certain flavor $F_i$ ($1 \\le F_i \\le 10^9$) and a certain spiciness $S_i$ ($1 \\le S_i \\le 10^9$).\n\nThe meal will consist of a single course, being a contiguous interval containing one or more consecutive haybales (Farmer John cannot change the order of the haybales). The total flavor of the meal is the sum of the flavors in the interval. The spiciness of the meal is the maximum spiciness of all haybales in the interval.\n\n\nFarmer John would like to determine the minimum spiciness his single-course meal could achieve, given that it must have a total flavor of at least $M$ ($1 \\le M \\le 10^{18}$).\n", "inputFormat": "The first line contains the integers $N$ and $M$, the number of haybales and the minimum total flavor the meal must have, respectively. The next $N$ lines describe the $N$ haybales with two integers per line, first the flavor $F$ and then the spiciness $S$.\n", "outputFormat": "Please output the minimum spiciness in a single course meal that satisfies the minimum flavor requirement. There will always be at least one single-course meal that satisfies the flavor requirement.\n", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO17DEC] Haybale Feast G", "background": "", "description": "Farmer John is preparing a delicious meal for his cows! In his barn, he has $N$ haybales ($1 \\le N \\le 100,000$). The $i$th haybale has a certain flavor $F_i$ ($1 \\le F_i \\le 10^9$) and a certain spiciness $S_i$ ($1 \\le S_i \\le 10^9$).\n\nThe meal will consist of a single course, being a contiguous interval containing one or more consecutive haybales (Farmer John cannot change the order of the haybales). The total flavor of the meal is the sum of the flavors in the interval. The spiciness of the meal is the maximum spiciness of all haybales in the interval.\n\n\nFarmer John would like to determine the minimum spiciness his single-course meal could achieve, given that it must have a total flavor of at least $M$ ($1 \\le M \\le 10^{18}$).\n", "inputFormat": "The first line contains the integers $N$ and $M$, the number of haybales and the minimum total flavor the meal must have, respectively. The next $N$ lines describe the $N$ haybales with two integers per line, first the flavor $F$ and then the spiciness $S$.\n", "outputFormat": "Please output the minimum spiciness in a single course meal that satisfies the minimum flavor requirement. There will always be at least one single-course meal that satisfies the flavor requirement.\n", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO17DEC] Haybale Feast G", "background": "", "description": "农夫约翰正在为他的奶牛准备一顿美味的晚餐！在他的谷仓里，他有 $N$ 个干草捆 $(1 \\le N \\le 10^5)$ 。第 $i$ 个干草捆有一定的风味 $F_i(1 \\le F_i \\le 10^9)$ 和一定的辣度 $S_i(1 \\le S_i \\le 10^9)$ 。\n\n这顿饭将由一道菜组成，是一个连续的区间，包含一个或多个连续的干草捆(农夫约翰不能改变干草捆的顺序)。这顿饭的总体的风味是这段区间里风味的总和。这顿饭的总体辣度是区间中所有草包的最大辣度。\n\n农夫约翰想确定他的这道菜所能达到的最小辣度，但是这道菜的总风味必须至少为 $M(1 \\le M \\le 10^{18})$ 。", "inputFormat": "第一行包含两个整数 $N$ 和 $M$ ，分别是干草包的数量和这顿饭必须有的最小风味之和。\n\n接下来的 $N$ 行，每行两个整数描述这 $N$ 个草包，首先是风味 $F_i$，然后是辣度 $S_i$。", "outputFormat": "请输出这道菜中在满足最低风味时的最低辣度。保证至少有一顿单道菜的饭能满足风味的要求。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4086", "type": "P", "difficulty": 3, "samples": [["5\n3 1 9 2 7", "2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["递推", "2017", "线段树", "USACO", "枚举", "前缀和"], "title": "[USACO17DEC] My Cow Ate My Homework S", "background": "", "description": "In your bovine history class, you have been given a rather long homework assignment with $N$ questions ($3 \\leq N \\leq 100,000$), each graded with an integer score in the range 0...10,000. As is often customary, your teacher plans to assign a final grade by discarding a question on which you received the lowest score and then averaging the remaining scores together. Unfortunately, your pet cow Bessie has just eaten your answers to the first $K$ questions! ($K$ could be as small as 1 or as large as $N-2$).\n\nAfter copious explanation, your teacher finally believes your story, and agrees to grade the remaining non-eaten part of the assignment the same way as before -- by removing the lowest-scoring question (or one such question, in the event of a tie) and averaging the rest.\n\n\nPlease output all values of $K$ which would have earned you the maximum possible score according to this grading scheme, in sorted order.\n\n", "inputFormat": "The first line of input contains $N$, and the next line contains the scores on the $N$ homework questions.\n", "outputFormat": "Please output, one value per line, all values of $K$ which would have earned you the maximum possible score.\n", "hint": "If Bessie eats the first two questions, then the remaining scores are 9, 2, and 7. Removing the minimum and averaging, we get a final grade of 8, which is the highest possible.\n", "locale": "en", "translations": {"en": {"title": "[USACO17DEC] My Cow Ate My Homework S", "background": "", "description": "In your bovine history class, you have been given a rather long homework assignment with $N$ questions ($3 \\leq N \\leq 100,000$), each graded with an integer score in the range 0...10,000. As is often customary, your teacher plans to assign a final grade by discarding a question on which you received the lowest score and then averaging the remaining scores together. Unfortunately, your pet cow Bessie has just eaten your answers to the first $K$ questions! ($K$ could be as small as 1 or as large as $N-2$).\n\nAfter copious explanation, your teacher finally believes your story, and agrees to grade the remaining non-eaten part of the assignment the same way as before -- by removing the lowest-scoring question (or one such question, in the event of a tie) and averaging the rest.\n\n\nPlease output all values of $K$ which would have earned you the maximum possible score according to this grading scheme, in sorted order.\n\n", "inputFormat": "The first line of input contains $N$, and the next line contains the scores on the $N$ homework questions.\n", "outputFormat": "Please output, one value per line, all values of $K$ which would have earned you the maximum possible score.\n", "hint": "If Bessie eats the first two questions, then the remaining scores are 9, 2, and 7. Removing the minimum and averaging, we get a final grade of 8, which is the highest possible.\n", "locale": "en"}, "zh-CN": {"title": "[USACO17DEC] My Cow Ate My Homework S", "background": null, "description": "在你的牛历史课上，你被布置了一份相当长的作业，包含 $N$ 个问题（$3 \\leq N \\leq 100,000$），每个问题的得分是一个在 0 到 10,000 之间的整数。按照惯例，你的老师计划通过去掉你得分最低的一个问题，然后对剩余问题的得分取平均来给出最终成绩。不幸的是，你的宠物奶牛 Bessie 刚刚吃掉了你前 $K$ 个问题的答案！（$K$ 可能小到 $1$，也可能大到 $N-2$）。\n\n经过多次解释，你的老师终于相信了你的说法，并同意按照之前的方式对剩余的未被吃掉的部分作业进行评分——即去掉得分最低的问题（或在得分相同的情况下去掉其中一个），然后对剩余问题取平均。\n\n请输出所有能够使你获得最高可能成绩的 $K$ 值，并按升序排列。", "inputFormat": "输入的第一行包含 $N$，第二行包含 $N$ 个作业问题的得分。", "outputFormat": "请逐行输出所有能够使你获得最高可能成绩的 $K$ 值。", "hint": "如果 Bessie 吃掉了前两个问题，那么剩余的得分是 $9$、$2$ 和 $7$。去掉最低分并取平均后，最终成绩为 $8$，这是可能的最高成绩。", "locale": "zh-CN"}}}
{"pid": "P4087", "type": "P", "difficulty": 5, "samples": [["4 10\n7 3 +3\n4 2 -1\n9 3 -1\n1 1 +2", "3\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2017", "线段树", "USACO", "离散化"], "title": "[USACO17DEC] Milk Measurement S", "background": "", "description": "Each of Farmer John's cows initially produces $G$ gallons of milk per day ($1 \\leq G \\leq 10^9$). Since the milk output of a cow is known to potentially change over time, Farmer John decides to take periodic measurements of milk output and write these down in a log book. Entries in his log look like this:\n\n35 1234 -2\n\n14 2345 +3\n\nThe first entry indicates that on day 35, cow #1234's milk output was 2 gallons lower than it was when last measured. The next entry indicates that on day 14, cow #2345's milk output increased by 3 gallons from when it was last measured. Farmer John has only enough time to make at most one measurement on any given day. Unfortunately, he is a bit disorganized, and doesn't necessarily write down his measurements in chronological order.\n\n\nTo keep his cows motivated, Farmer John proudly displays on the wall of his barn the picture of whichever cow currently has the highest milk output (if several cows tie for the highest milk output, he displays all of their pictures). Please determine the number of days on which Farmer John would have needed to change this display.\n\n\nNote that Farmer John has a very large herd of cows, so although some of them are noted in his log book as changing their milk production, there are always plenty of other cows around whose milk output level remains at $G$ gallons.", "inputFormat": "The first line of input contains the number of measurements $N$ that Farmer John makes ($1 \\leq N \\leq 100,000$), followed by $G$. Each of the next $N$ lines contains one measurement, in the format above, specifying a day (an integer in the range $1 \\ldots 10^6$), the integer ID of a cow (in the range $1 \\ldots 10^9$), and the change in her milk output since it was last measured (a nonzero integer). Each cow's milk output will always be in the range $0 \\ldots 10^9$.", "outputFormat": "Please output the number of days on which Farmer John needs to adjust his motivational display.", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO17DEC] Milk Measurement S", "background": "", "description": "Each of Farmer John's cows initially produces $G$ gallons of milk per day ($1 \\leq G \\leq 10^9$). Since the milk output of a cow is known to potentially change over time, Farmer John decides to take periodic measurements of milk output and write these down in a log book. Entries in his log look like this:\n\n35 1234 -2\n\n14 2345 +3\n\nThe first entry indicates that on day 35, cow #1234's milk output was 2 gallons lower than it was when last measured. The next entry indicates that on day 14, cow #2345's milk output increased by 3 gallons from when it was last measured. Farmer John has only enough time to make at most one measurement on any given day. Unfortunately, he is a bit disorganized, and doesn't necessarily write down his measurements in chronological order.\n\n\nTo keep his cows motivated, Farmer John proudly displays on the wall of his barn the picture of whichever cow currently has the highest milk output (if several cows tie for the highest milk output, he displays all of their pictures). Please determine the number of days on which Farmer John would have needed to change this display.\n\n\nNote that Farmer John has a very large herd of cows, so although some of them are noted in his log book as changing their milk production, there are always plenty of other cows around whose milk output level remains at $G$ gallons.", "inputFormat": "The first line of input contains the number of measurements $N$ that Farmer John makes ($1 \\leq N \\leq 100,000$), followed by $G$. Each of the next $N$ lines contains one measurement, in the format above, specifying a day (an integer in the range $1 \\ldots 10^6$), the integer ID of a cow (in the range $1 \\ldots 10^9$), and the change in her milk output since it was last measured (a nonzero integer). Each cow's milk output will always be in the range $0 \\ldots 10^9$.", "outputFormat": "Please output the number of days on which Farmer John needs to adjust his motivational display.", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO17DEC] Milk Measurement S", "background": "", "description": "Farmer John 的每头奶牛最初每天生产 $G$ 加仑牛奶（$1 \\leq G \\leq 10^9$）。由于奶牛的产奶量可能会随时间变化，Farmer John 决定定期测量产奶量并将这些记录在日志中。日志中的条目如下所示：\n\n```\n35 1234 -2  \n14 2345 +3  \n```\n\n第一条记录表示在第 35 天，奶牛 #1234 的产奶量比上次测量时减少了 2 加仑。第二条记录表示在第 14 天，奶牛 #2345 的产奶量比上次测量时增加了 3 加仑。Farmer John 每天最多只能进行一次测量。不幸的是，他有点混乱，记录的测量结果不一定按时间顺序排列。\n\n为了激励他的奶牛，Farmer John 自豪地在谷仓的墙上展示当前产奶量最高的奶牛的照片（如果有多头奶牛产奶量并列最高，他会展示所有奶牛的照片）。请确定 Farmer John 需要更改展示的天数。\n\n请注意，Farmer John 的牛群非常庞大，因此尽管日志中记录了一些奶牛产奶量的变化，但总有许多其他奶牛的产奶量保持在 $G$ 加仑不变。", "inputFormat": "输入的第一行包含 Farmer John 进行的测量次数 $N$（$1 \\leq N \\leq 100,000$）和初始产奶量 $G$。接下来的 $N$ 行每行包含一条测量记录，格式如上所述，指定一个天数（范围为 $1 \\ldots 10^6$）、奶牛的整数 ID（范围为 $1 \\ldots 10^9$）以及自上次测量以来产奶量的变化量（一个非零整数）。每头奶牛的产奶量始终在 $0 \\ldots 10^9$ 范围内。", "outputFormat": "请输出 Farmer John 需要调整激励展示的天数。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4088", "type": "P", "difficulty": 6, "samples": [["2 3\n0 10 1\n13 8 2\n1 12\n5 2\n20 7", "4\n3\n10"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2018", "线段树", "USACO", "枚举", "树套树"], "title": "[USACO18FEB] Slingshot P", "background": "", "description": "One of the farming chores Farmer John dislikes the most is hauling around lots of cow manure. In order to streamline this process, he comes up with an intriguing idea: instead of hauling manure between two points in a cart behind his tractor, why not shoot it through the air with a giant manure slingshot? (indeed, what could possibly go wrong...)\nFarmer John's farm is built along a single long straight road, so any location on his farm can be described simply using its position along this road (effectively a point on the number line). FJ builds $N$ slingshots ($1 \\leq N \\leq 10^5$), where the $i$th slingshot is described by three integers $x_i$, $y_i$, and $t_i$, specifying that this slingshot can shoot manure from position $x_i$ to position $y_i$ in only $t_i$ total units of time.\n\nFJ has $M$ piles of manure to transport ($1 \\leq M \\leq 10^5$). The $j$th such pile needs to be moved from position $a_j$ to position $b_j$. Hauling manure with the tractor for a distance of $d$ takes $d$ units of time. FJ is hoping to reduce this by allowing up to one use of any slingshot for transporting each pile of manure. Time FJ spends moving his tractor without manure in it does not count.\n\nFor each of the $M$ manure piles, please help FJ determine the minimum possible transportation time, given that FJ can use up to one slingshot during the process.", "inputFormat": "The first line of input contains $N$ and $M$. The next $N$ lines each describe a single slingshot in terms of integers $x_i$, $y_i$, and $t_i$ ($0 \\leq x_i, y_i, t_i \\leq 10^9$). The final $M$ lines describe piles of manure that need to be moved, in terms of integers $a_j$ and $b_j$.", "outputFormat": "Print $M$ lines of output, one for each manure pile, indicating the minimum time needed to transport it.", "hint": "Here, the first pile of manure needs to move from position 1 to position 12. Without using an slingshot, this would take 11 units of time. However, using the first slingshot, it takes 1 unit of time to move to position 0 (the slingshot source), 1 unit of time to fling the manure through the air to land at position 10 (the slingshot destination), and then 2 units of time to move the manure to position 12. The second pile of manure is best moved without any slingshot, and the third pile of manure should be moved using the second slingshot.\n\nProblem credits: Brian Dean", "locale": "en", "translations": {"en": {"title": "[USACO18FEB] Slingshot P", "background": "", "description": "One of the farming chores Farmer John dislikes the most is hauling around lots of cow manure. In order to streamline this process, he comes up with an intriguing idea: instead of hauling manure between two points in a cart behind his tractor, why not shoot it through the air with a giant manure slingshot? (indeed, what could possibly go wrong...)\nFarmer John's farm is built along a single long straight road, so any location on his farm can be described simply using its position along this road (effectively a point on the number line). FJ builds $N$ slingshots ($1 \\leq N \\leq 10^5$), where the $i$th slingshot is described by three integers $x_i$, $y_i$, and $t_i$, specifying that this slingshot can shoot manure from position $x_i$ to position $y_i$ in only $t_i$ total units of time.\n\nFJ has $M$ piles of manure to transport ($1 \\leq M \\leq 10^5$). The $j$th such pile needs to be moved from position $a_j$ to position $b_j$. Hauling manure with the tractor for a distance of $d$ takes $d$ units of time. FJ is hoping to reduce this by allowing up to one use of any slingshot for transporting each pile of manure. Time FJ spends moving his tractor without manure in it does not count.\n\nFor each of the $M$ manure piles, please help FJ determine the minimum possible transportation time, given that FJ can use up to one slingshot during the process.", "inputFormat": "The first line of input contains $N$ and $M$. The next $N$ lines each describe a single slingshot in terms of integers $x_i$, $y_i$, and $t_i$ ($0 \\leq x_i, y_i, t_i \\leq 10^9$). The final $M$ lines describe piles of manure that need to be moved, in terms of integers $a_j$ and $b_j$.", "outputFormat": "Print $M$ lines of output, one for each manure pile, indicating the minimum time needed to transport it.", "hint": "Here, the first pile of manure needs to move from position 1 to position 12. Without using an slingshot, this would take 11 units of time. However, using the first slingshot, it takes 1 unit of time to move to position 0 (the slingshot source), 1 unit of time to fling the manure through the air to land at position 10 (the slingshot destination), and then 2 units of time to move the manure to position 12. The second pile of manure is best moved without any slingshot, and the third pile of manure should be moved using the second slingshot.\n\nProblem credits: Brian Dean", "locale": "en"}, "zh-CN": {"title": "[USACO18FEB] Slingshot P", "background": "", "description": "Farmer John 最不喜欢的农活之一就是到处搬运牛粪。为了简化这一过程，他想出了一个有趣的主意：与其用拖拉机后面的拖车搬运牛粪，为什么不通过一个巨大的牛粪弹弓将其射到空中呢？（确实，可能会出什么问题呢……）\n\nFarmer John 的农场建在一条笔直的长路上，因此农场上的任何位置都可以简单地用其在这条路上的位置来描述（实际上就是数轴上的一个点）。FJ 建造了 $N$ 个弹弓（$1 \\leq N \\leq 10^5$），其中第 $i$ 个弹弓由三个整数 $x_i$、$y_i$ 和 $t_i$ 描述，表示这个弹弓可以将牛粪从位置 $x_i$ 射到位置 $y_i$，仅需 $t_i$ 个单位时间。\n\nFJ 有 $M$ 堆牛粪需要搬运（$1 \\leq M \\leq 10^5$）。第 $j$ 堆牛粪需要从位置 $a_j$ 搬运到位置 $b_j$。用拖拉机搬运牛粪，每移动距离 $d$ 需要 $d$ 个单位时间。FJ 希望通过允许每堆牛粪最多使用一次弹弓来减少搬运时间。FJ 在没有牛粪的情况下移动拖拉机的时间不计入搬运时间。\n\n对于每堆牛粪，请帮助 FJ 确定在最多使用一次弹弓的情况下，搬运所需的最少时间。", "inputFormat": "输入的第一行包含 $N$ 和 $M$。接下来的 $N$ 行每行描述一个弹弓，包含三个整数 $x_i$、$y_i$ 和 $t_i$（$0 \\leq x_i, y_i, t_i \\leq 10^9$）。最后的 $M$ 行描述需要搬运的牛粪堆，每行包含两个整数 $a_j$ 和 $b_j$。", "outputFormat": "输出 $M$ 行，每行对应一堆牛粪，表示搬运所需的最少时间。", "hint": "在这里，第一堆牛粪需要从位置 $1$ 搬运到位置 $12$。如果不使用弹弓，这将花费 $11$ 个单位时间。然而，使用第一个弹弓，花费 $1$ 个单位时间将牛粪移动到位置 $0$（弹弓的起点），$1$ 个单位时间将牛粪射到位置 $10$（弹弓的终点），然后花费 $2$ 个单位时间将牛粪移动到位置 $12$。第二堆牛粪最好不使用弹弓搬运，而第三堆牛粪应使用第二个弹弓搬运。\n\n题目来源：Brian Dean", "locale": "zh-CN"}}}
{"pid": "P4089", "type": "P", "difficulty": 3, "samples": [["4\n3 2 1 3", "3\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2017", "USACO", "拓扑排序"], "title": "[USACO17DEC] The Bovine Shuffle S", "background": "", "description": "Convinced that happy cows generate more milk, Farmer John has installed a giant disco ball in his barn and plans to teach his cows to dance!\n\nLooking up popular cow dances, Farmer John decides to teach his cows the \"Bovine Shuffle\". The Bovine Shuffle consists of his $N$ cows ($1 \\leq N \\leq 100,000$) lining up in a row in some order, then performing successive \"shuffles\", each of which potentially re-orders the cows. To make it easier for his cows to locate themselves, Farmer John marks the locations for his line of cows with positions $1 \\ldots N$, so the first cow in the lineup will be in position 1, the next in position 2, and so on, up to position $N$.\n\n\nA shuffle is described with $N$ numbers, $a_1 \\ldots a_N$, where a cow in position $i$ moves to position $a_i$ during the shuffle (and so, each $a_i$ is in the range $1 \\ldots N$). Every cow moves to its new location during the shuffle. Unfortunately, all the $a_i$'s are not necessarily distinct, so multiple cows might try to move to the same position during a shuffle, after which they will move together for all remaining shuffles.\n\n\nFarmer John notices that some positions in his lineup contain cows in them no matter how many shuffles take place. Please help him count the number of such positions.\n\n", "inputFormat": "The first line of input contains $N$, the number of cows. The next line contains the $N$ integers $a_1 \\ldots a_N$.\n", "outputFormat": "Please output the number of positions that will always contain cows, no matter how many shuffles take place.\n", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO17DEC] The Bovine Shuffle S", "background": "", "description": "Convinced that happy cows generate more milk, Farmer John has installed a giant disco ball in his barn and plans to teach his cows to dance!\n\nLooking up popular cow dances, Farmer John decides to teach his cows the \"Bovine Shuffle\". The Bovine Shuffle consists of his $N$ cows ($1 \\leq N \\leq 100,000$) lining up in a row in some order, then performing successive \"shuffles\", each of which potentially re-orders the cows. To make it easier for his cows to locate themselves, Farmer John marks the locations for his line of cows with positions $1 \\ldots N$, so the first cow in the lineup will be in position 1, the next in position 2, and so on, up to position $N$.\n\n\nA shuffle is described with $N$ numbers, $a_1 \\ldots a_N$, where a cow in position $i$ moves to position $a_i$ during the shuffle (and so, each $a_i$ is in the range $1 \\ldots N$). Every cow moves to its new location during the shuffle. Unfortunately, all the $a_i$'s are not necessarily distinct, so multiple cows might try to move to the same position during a shuffle, after which they will move together for all remaining shuffles.\n\n\nFarmer John notices that some positions in his lineup contain cows in them no matter how many shuffles take place. Please help him count the number of such positions.\n\n", "inputFormat": "The first line of input contains $N$, the number of cows. The next line contains the $N$ integers $a_1 \\ldots a_N$.\n", "outputFormat": "Please output the number of positions that will always contain cows, no matter how many shuffles take place.\n", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO17DEC] The Bovine Shuffle S", "background": "", "description": "Farmer John 坚信快乐的奶牛能产更多的奶，因此他在谷仓里安装了一个巨大的迪斯科球，并计划教他的奶牛跳舞！\n\n在查阅了流行的奶牛舞蹈后，Farmer John 决定教他的奶牛“Bovine Shuffle”。Bovine Shuffle 包括他的 $N$ 头奶牛（$1 \\leq N \\leq 100,000$）以某种顺序排成一行，然后进行连续的“洗牌”，每次洗牌可能会重新排列奶牛的顺序。为了让奶牛更容易找到自己的位置，Farmer John 为他的奶牛队伍标记了位置 $1 \\ldots N$，因此队伍中的第一头奶牛位于位置 1，第二头位于位置 2，依此类推，直到位置 $N$。\n\n一次洗牌由 $N$ 个数字 $a_1 \\ldots a_N$ 描述，其中位于位置 $i$ 的奶牛在洗牌期间移动到位置 $a_i$（因此，每个 $a_i$ 都在 $1 \\ldots N$ 范围内）。每头奶牛在洗牌期间都会移动到它的新位置。不幸的是，所有的 $a_i$ 不一定互不相同，因此多只奶牛可能会在洗牌期间尝试移动到同一位置，之后它们将在所有剩余的洗牌中一起移动。\n\nFarmer John 注意到，无论进行多少次洗牌，他的队伍中某些位置始终会有奶牛。请帮助他计算这样的位置数量。", "inputFormat": "输入的第一行包含 $N$，表示奶牛的数量。第二行包含 $N$ 个整数 $a_1 \\ldots a_N$。", "outputFormat": "请输出无论进行多少次洗牌，始终会有奶牛的位置数量。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4090", "type": "P", "difficulty": 5, "samples": [["3\n1 2 0", "1\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["贪心", "2017", "二分", "USACO"], "title": "[USACO17DEC] Greedy Gift Takers P", "background": "", "description": "Farmer John's nemesis, Farmer Nhoj, has $N$ cows ($1 \\leq N \\leq 10^5$), conveniently numbered $1 \\dots N$. They have unexpectedly turned up at Farmer John's farm, so the unfailingly polite Farmer John is attempting to give them gifts.\n\nTo this end, Farmer John has brought out his infinite supply of gifts, and Nhoj's cows have queued up in front of him, with cow $1$ at the head of the queue and cow $N$ at the tail. Farmer John was expecting that at every timestep, the cow at the head of the queue would take a gift from Farmer John and go to the tail of the queue. However, he has just realized that Nhoj's cows are not that polite! After receiving her gift, each cow may not go to the tail of the queue, but rather may cut some number of cows at the tail, and insert herself in front of them. Specifically, cow $i$ will always cut exactly $c_i$ cows ($0 \\leq c_i \\leq N-1$).\n\n\nFarmer John knows that some cows might receive multiple gifts; as he has an infinite supply, this does not worry him. But he is worried that some cows might become unhappy if they do not get any gifts.\n\n\nHelp Farmer John find the number of cows who never receive any gifts, no matter how many gifts are handed out.", "inputFormat": "The first line contains a single integer, $N$.\n\nThe second line contains $N$ space-separated integers $c_1, c_2, \\dots, c_N$.\n", "outputFormat": "Please output the number of cows who cannot receive any gifts.\n", "hint": "", "locale": "en", "translations": {"en": {"title": "[USACO17DEC] Greedy Gift Takers P", "background": "", "description": "Farmer John's nemesis, Farmer Nhoj, has $N$ cows ($1 \\leq N \\leq 10^5$), conveniently numbered $1 \\dots N$. They have unexpectedly turned up at Farmer John's farm, so the unfailingly polite Farmer John is attempting to give them gifts.\n\nTo this end, Farmer John has brought out his infinite supply of gifts, and Nhoj's cows have queued up in front of him, with cow $1$ at the head of the queue and cow $N$ at the tail. Farmer John was expecting that at every timestep, the cow at the head of the queue would take a gift from Farmer John and go to the tail of the queue. However, he has just realized that Nhoj's cows are not that polite! After receiving her gift, each cow may not go to the tail of the queue, but rather may cut some number of cows at the tail, and insert herself in front of them. Specifically, cow $i$ will always cut exactly $c_i$ cows ($0 \\leq c_i \\leq N-1$).\n\n\nFarmer John knows that some cows might receive multiple gifts; as he has an infinite supply, this does not worry him. But he is worried that some cows might become unhappy if they do not get any gifts.\n\n\nHelp Farmer John find the number of cows who never receive any gifts, no matter how many gifts are handed out.", "inputFormat": "The first line contains a single integer, $N$.\n\nThe second line contains $N$ space-separated integers $c_1, c_2, \\dots, c_N$.\n", "outputFormat": "Please output the number of cows who cannot receive any gifts.\n", "hint": "", "locale": "en"}, "zh-CN": {"title": "[USACO17DEC] Greedy Gift Takers P", "background": "", "description": "Farmer John 的死对头 Farmer Nhoj 有 $N$ 头奶牛（$1 \\leq N \\leq 10^5$），编号为 $1 \\dots N$。它们意外地出现在 Farmer John 的农场，因此一贯礼貌的 Farmer John 试图给它们送礼物。\n\n为此，Farmer John 拿出了他无限的礼物供应，Nhoj 的奶牛在他面前排成一队，奶牛 $1$ 在队首，奶牛 $N$ 在队尾。Farmer John 原本以为，在每一时刻，队首的奶牛会从 Farmer John 那里拿走一份礼物，然后走到队尾。然而，他刚刚意识到 Nhoj 的奶牛并不那么礼貌！每头奶牛在收到礼物后，可能不会走到队尾，而是可能会插队到队尾的某些奶牛前面。具体来说，奶牛 $i$ 总是会插队到恰好 $c_i$ 头奶牛前面（$0 \\leq c_i \\leq N-1$）。\n\nFarmer John 知道有些奶牛可能会收到多份礼物；由于他有无限的礼物供应，这并不让他担心。但他担心的是，如果有些奶牛没有收到任何礼物，它们可能会变得不开心。\n\n请帮助 Farmer John 找出无论送出多少礼物，都无法收到任何礼物的奶牛数量。", "inputFormat": "第一行包含一个整数 $N$。\n\n第二行包含 $N$ 个用空格分隔的整数 $c_1, c_2, \\dots, c_N$。", "outputFormat": "请输出无法收到任何礼物的奶牛数量。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P4091", "type": "P", "difficulty": 6, "samples": [["3", "87"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "2016", "各省省选", "河北", "枚举", "容斥原理", "快速傅里叶变换 FFT", "快速数论变换 NTT", "天津"], "title": "[HEOI2016/TJOI2016] 求和", "background": "", "description": "在2016年，佳媛姐姐刚刚学习了第二类斯特林数，非常开心。\n\n现在他想计算这样一个函数的值:\n\n$$f(n)=\\sum_{i=0}^n\\sum_{j=0}^i S(i,j)\\times 2^j \\times (j!)$$\n\nS(i, j)表示第二类斯特林数，递推公式为:\n\n$S(i, j) = j \\times S(i - 1, j) + S(i - 1, j - 1), 1 \\le j \\le i - 1$。\n\n边界条件为：$S(i, i) = 1(0 \\le i), S(i, 0) = 0(1 \\le i)$\n\n你能帮帮他吗?\n", "inputFormat": "输入只有一个正整数 $n$。", "outputFormat": "输出 $f(n)$。由于结果会很大，输出 $f(n)$ 对 998244353 ($7 \\times 17 \\times 2^{23} + 1$) 取模的结果即可。\n", "hint": "对于 $50\\%$ 的数据，$1\\leq n \\leq5\\times10^3$。\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^5$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[HEOI2016/TJOI2016] Summation", "background": "", "description": "In 2016, Sister Jiayuan had just learned about the Stirling numbers of the second kind and was very happy.\n\nNow she wants to compute the value of the following function:\n\n$$f(n)=\\sum_{i=0}^n\\sum_{j=0}^i S(i,j)\\times 2^j \\times (j!)$$\n\n$S(i, j)$ denotes the Stirling numbers of the second kind, with the recurrence:\n$S(i, j) = j \\times S(i - 1, j) + S(i - 1, j - 1), 1 \\le j \\le i - 1$.\n\nBoundary conditions: $S(i, i) = 1 (0 \\le i)$, $S(i, 0) = 0 (1 \\le i)$.\n\nCan you help her?", "inputFormat": "The input contains a single positive integer $n$.", "outputFormat": "Output $f(n)$. Since the result can be large, output $f(n)$ modulo 998244353 ($7 \\times 17 \\times 2^{23} + 1$).", "hint": "For 50% of the testdata, $1 \\le n \\le 5 \\times 10^3$.\nFor 100% of the testdata, $1 \\le n \\le 10^5$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HEOI2016/TJOI2016] 求和", "background": "", "description": "在2016年，佳媛姐姐刚刚学习了第二类斯特林数，非常开心。\n\n现在他想计算这样一个函数的值:\n\n$$f(n)=\\sum_{i=0}^n\\sum_{j=0}^i S(i,j)\\times 2^j \\times (j!)$$\n\nS(i, j)表示第二类斯特林数，递推公式为:\n\n$S(i, j) = j \\times S(i - 1, j) + S(i - 1, j - 1), 1 \\le j \\le i - 1$。\n\n边界条件为：$S(i, i) = 1(0 \\le i), S(i, 0) = 0(1 \\le i)$\n\n你能帮帮他吗?\n", "inputFormat": "输入只有一个正整数 $n$。", "outputFormat": "输出 $f(n)$。由于结果会很大，输出 $f(n)$ 对 998244353 ($7 \\times 17 \\times 2^{23} + 1$) 取模的结果即可。\n", "hint": "对于 $50\\%$ 的数据，$1\\leq n \\leq5\\times10^3$。\n\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 10^5$。\n", "locale": "zh-CN"}}}
{"pid": "P4092", "type": "P", "difficulty": 5, "samples": [["5 5 \n1 2 \n1 3 \n2 4 \n2 5 \nQ 2 \nC 2 \nQ 2 \nQ 5 \nQ 3", "1\n2\n2\n1"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["搜索", "2016", "线段树", "并查集", "各省省选", "河北", "树链剖分", "天津"], "title": "[HEOI2016/TJOI2016] 树", "background": null, "description": "在 2016 年，佳媛姐姐刚刚学习了树，非常开心。现在她想解决这样一个问题：给定一颗有根树，根为 $1$，有以下两种操作：\n\n1. 标记操作：对某个结点打上标记。（在最开始，只有结点 $1$ 有标记，其他结点均无标记，而且对于某个结点，可以打多次标记。）\n\n2. 询问操作：询问某个结点最近的一个打了标记的祖先（这个结点本身也算自己的祖先）。\n\n你能帮帮她吗？", "inputFormat": "第一行两个正整数 $N$ 和 $Q$ 分别表示节点个数和操作次数。\n\n接下来 $N-1$ 行，每行两个正整数 $u,v$（$1 \\leqslant u,v \\leqslant n$）表示 $u$ 到 $v$ 有一条有向边。\n\n接下来 $Q$ 行，形如 `oper num`，`oper` 为 `C` 时表示这是一个标记操作，`oper` 为 `Q` 时表示这是一个询问操作。", "outputFormat": "对于每个询问操作，输出一行，一个正整数，表示结果。", "hint": "- $30\\%$ 的数据，$1 \\leqslant N, Q \\leqslant 1000$；\n\n- $70\\%$ 的数据，$1 \\leqslant N, Q \\leqslant 10000$；\n\n- $100\\%$ 的数据，$1 \\leqslant N, Q \\leqslant 100000$。", "locale": "zh-CN", "translations": {"en": {"title": "[HEOI2016/TJOI2016] Tree", "background": "", "description": "In 2016, Jiayuan jiejie had just learned about trees and was very happy. Now she wants to solve the following problem: given a rooted tree with root $1$, there are two types of operations:\n\n1. Mark operation: put a mark on some node. (At the very beginning, only node $1$ is marked, and all other nodes are unmarked. You may mark the same node multiple times.)\n\n2. Query operation: ask for the nearest marked ancestor of some node (the node itself also counts as its own ancestor).\n\nCan you help her?", "inputFormat": "The first line contains two positive integers $N$ and $Q$, denoting the number of nodes and the number of operations.\n\nThe next $N-1$ lines each contain two positive integers $u, v$ ($1 \\leqslant u, v \\leqslant N$) indicating a directed edge from $u$ to $v$. These edges form a rooted tree with root $1$, and edges are directed from parent to child.\n\nThe next $Q$ lines are of the form `oper num`. When `oper` is `C`, it denotes a mark operation on node `num`. When `oper` is `Q`, it denotes a query operation on node `num`.", "outputFormat": "For each query operation, output one integer: the nearest marked ancestor of the given node (including the node itself). Print each answer on its own line.", "hint": "- 30% of the testdata: $1 \\leqslant N, Q \\leqslant 1000$.\n- 70% of the testdata: $1 \\leqslant N, Q \\leqslant 10000$.\n- 100% of the testdata: $1 \\leqslant N, Q \\leqslant 100000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HEOI2016/TJOI2016] 树", "background": null, "description": "在 2016 年，佳媛姐姐刚刚学习了树，非常开心。现在她想解决这样一个问题：给定一颗有根树，根为 $1$，有以下两种操作：\n\n1. 标记操作：对某个结点打上标记。（在最开始，只有结点 $1$ 有标记，其他结点均无标记，而且对于某个结点，可以打多次标记。）\n\n2. 询问操作：询问某个结点最近的一个打了标记的祖先（这个结点本身也算自己的祖先）。\n\n你能帮帮她吗？", "inputFormat": "第一行两个正整数 $N$ 和 $Q$ 分别表示节点个数和操作次数。\n\n接下来 $N-1$ 行，每行两个正整数 $u,v$（$1 \\leqslant u,v \\leqslant n$）表示 $u$ 到 $v$ 有一条有向边。\n\n接下来 $Q$ 行，形如 `oper num`，`oper` 为 `C` 时表示这是一个标记操作，`oper` 为 `Q` 时表示这是一个询问操作。", "outputFormat": "对于每个询问操作，输出一行，一个正整数，表示结果。", "hint": "- $30\\%$ 的数据，$1 \\leqslant N, Q \\leqslant 1000$；\n\n- $70\\%$ 的数据，$1 \\leqslant N, Q \\leqslant 10000$；\n\n- $100\\%$ 的数据，$1 \\leqslant N, Q \\leqslant 100000$。", "locale": "zh-CN"}}}
{"pid": "P4093", "type": "P", "difficulty": 6, "samples": [["3 4 \n1 2 3 \n1 2 \n2 3 \n2 1 \n3 4", "3\n"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2016", "线段树", "各省省选", "河北", "cdq 分治", "O2优化", "树套树", "天津"], "title": "[HEOI2016/TJOI2016] 序列", "background": null, "description": "佳媛姐姐过生日的时候，她的小伙伴从某宝上买了一个有趣的玩具送给她。\n\n玩具上有一个数列，数列中某些项的值可能会变化，但同一个时刻最多只有一个值发生变化。现在佳媛姐姐已经研究出了所有变化的可能性，她想请教你，能否选出一个子序列，使得在**任意一种变化和原序列**中，这个子序列都是不降的？请你告诉她这个子序列的最长长度即可。", "inputFormat": "输入的第一行有两个正整数 $n,m$，分别表示序列的长度和变化的个数。\n\n接下来一行有 $n$ 个整数，表示这个数列原始的状态。\n\n接下来 $m$ 行，每行有 $2$ 个整数 $x,y$，表示数列的第 $x$ 项可以变化成 $y$ 这个值。", "outputFormat": "输出一个整数，表示对应的答案。", "hint": "注意：每种变化最多只有一个值发生变化。\n\n在样例输入中，所有的变化是：\n```plain\n1 2 3\n2 2 3\n1 3 3\n1 1 3\n1 2 4\n```\n选择子序列为原序列，即在任意一种变化中均为不降子序列。\n\n对于 $20\\%$ 数据，所有数均为正整数，且小于等于 $300$。\n\n对于 $50\\%$ 数据，所有数均为正整数，且小于等于 $3000$。\n\n对于 $100\\%$ 数据，所有数均为正整数，且小于等于 $10^5$。$1\\le x\\le n$。", "locale": "zh-CN", "translations": {"en": {"title": "[HEOI2016/TJOI2016] Sequence", "background": "", "description": "On Jiayuan’s birthday, her friend bought an interesting toy from an online marketplace and gave it to her.\n\nThere is a sequence on the toy. The values of some elements in the sequence may change, but at any time at most one value changes. Jiayuan has already figured out all possible changes. She wants to ask you whether it is possible to choose a subsequence that is nondecreasing in the original sequence and under any single change. Please tell her the maximum possible length of such a subsequence.", "inputFormat": "The first line contains two positive integers $n, m$, representing the length of the sequence and the number of changes.\n\nThe next line contains $n$ integers, representing the original state of the sequence.\n\nThe next $m$ lines each contain $2$ integers $x, y$, meaning the $x$-th element of the sequence can change to the value $y$.", "outputFormat": "Output a single integer, representing the answer.", "hint": "Note: In each scenario, at most one value changes.\n\nIn the sample input, all changed sequences are:\n```plain\n1 2 3\n2 2 3\n1 3 3\n1 1 3\n1 2 4\n```\nChoosing the entire original sequence as the subsequence works; it remains nondecreasing under any single change.\n\nFor $20\\%$ of the testdata, all numbers are positive integers and at most $300$.\n\nFor $50\\%$ of the testdata, all numbers are positive integers and at most $3000$.\n\nFor $100\\%$ of the testdata, all numbers are positive integers and at most $10^5$. $1 \\le x \\le n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HEOI2016/TJOI2016] 序列", "background": null, "description": "佳媛姐姐过生日的时候，她的小伙伴从某宝上买了一个有趣的玩具送给她。\n\n玩具上有一个数列，数列中某些项的值可能会变化，但同一个时刻最多只有一个值发生变化。现在佳媛姐姐已经研究出了所有变化的可能性，她想请教你，能否选出一个子序列，使得在**任意一种变化和原序列**中，这个子序列都是不降的？请你告诉她这个子序列的最长长度即可。", "inputFormat": "输入的第一行有两个正整数 $n,m$，分别表示序列的长度和变化的个数。\n\n接下来一行有 $n$ 个整数，表示这个数列原始的状态。\n\n接下来 $m$ 行，每行有 $2$ 个整数 $x,y$，表示数列的第 $x$ 项可以变化成 $y$ 这个值。", "outputFormat": "输出一个整数，表示对应的答案。", "hint": "注意：每种变化最多只有一个值发生变化。\n\n在样例输入中，所有的变化是：\n```plain\n1 2 3\n2 2 3\n1 3 3\n1 1 3\n1 2 4\n```\n选择子序列为原序列，即在任意一种变化中均为不降子序列。\n\n对于 $20\\%$ 数据，所有数均为正整数，且小于等于 $300$。\n\n对于 $50\\%$ 数据，所有数均为正整数，且小于等于 $3000$。\n\n对于 $100\\%$ 数据，所有数均为正整数，且小于等于 $10^5$。$1\\le x\\le n$。", "locale": "zh-CN"}}}
{"pid": "P4094", "type": "P", "difficulty": 7, "samples": [["5 5\naaaaa\n1 1 1 5\n1 5 1 1\n2 3 2 3\n2 4 2 3\n2 3 2 4", "1\n1\n2\n2\n2"]], "limits": {"time": [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2016", "线段树", "二分", "各省省选", "河北", "后缀自动机 SAM", "O2优化", "可持久化线段树", "后缀数组 SA", "天津"], "title": "[HEOI2016/TJOI2016] 字符串", "background": "", "description": "佳媛姐姐过生日的时候，她的小伙伴从某东上买了一个生日礼物。生日礼物放在一个神奇的箱子中。箱子外边写了一个长为 $n$ 的字符串 $s$，和 $m$ 个问题。佳媛姐姐必须正确回答这 $m$ 个问题，才能打开箱子拿到礼物，升职加薪，出任 CEO，嫁给高富帅，走上人生巅峰。\n\n每个问题均有 $a,b,c,d$ 四个参数，问你子串 $s[a..b]$ 的所有子串和 $s[c..d]$ 的最长公共前缀的长度的最大值是多少？佳媛姐姐并不擅长做这样的问题，所以她向你求助，你该如何帮助她呢？\n", "inputFormat": "输入的第一行有两个正整数 $n,m$，分别表示字符串的长度和询问的个数。\n\n接下来一行是一个长为 $n$ 的字符串。接下来 $m$ 行，每行有 $4$ 个数 $a,b,c,d$，表示询问 $s[a..b]$ 的所有子串和 $s[c..d]$ 的最长公共前缀的最大值。\n", "outputFormat": "对于每一次询问，输出答案。\n", "hint": "对于 $10\\%$ 的数据，$1\\le n,m\\le 300$。\n\n对于 $40\\%$ 的数据，$1\\le n,m\\le 3,000$，字符串中仅有 `a`,`b`。\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 100,000$，字符串中仅有小写英文字母，$a\\le b$，$c\\le d$，$1\\le a,b,c,d\\le n$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[HEOI2016/TJOI2016] String", "background": "", "description": "On Jiayuan’s birthday, her friends bought her a birthday gift from an online store. The gift is placed in a magic box. On the outside of the box there is a string $s$ of length $n$, and $m$ questions. Jiayuan must answer these $m$ questions correctly to open the box and get the gift, get promoted and receive a raise, become the CEO, marry a rich and handsome man, and reach the pinnacle of life.\n\nEach question has four parameters $a,b,c,d$. Among all substrings of $s[a..b]$, what is the maximum possible length of the longest common prefix with $s[c..d]$? Jiayuan is not good at such problems, so she asks you for help. How would you help her?", "inputFormat": "The first line contains two positive integers $n,m$, denoting the length of the string and the number of queries.\n\nThe next line contains a string of length $n$. Then there are $m$ lines, each containing four integers $a,b,c,d$, representing a query asking for the maximum length of the longest common prefix between any substring of $s[a..b]$ and $s[c..d]$.", "outputFormat": "For each query, output the answer.", "hint": "For $10\\%$ of the testdata, $1 \\le n,m \\le 300$.\n\nFor $40\\%$ of the testdata, $1 \\le n,m \\le 3{,}000$, and the string contains only `a`, `b`.\n\nFor $100\\%$ of the testdata, $1 \\le n,m \\le 100{,}000$, the string contains only lowercase English letters, $a \\le b$, $c \\le d$, and $1 \\le a,b,c,d \\le n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HEOI2016/TJOI2016] 字符串", "background": "", "description": "佳媛姐姐过生日的时候，她的小伙伴从某东上买了一个生日礼物。生日礼物放在一个神奇的箱子中。箱子外边写了一个长为 $n$ 的字符串 $s$，和 $m$ 个问题。佳媛姐姐必须正确回答这 $m$ 个问题，才能打开箱子拿到礼物，升职加薪，出任 CEO，嫁给高富帅，走上人生巅峰。\n\n每个问题均有 $a,b,c,d$ 四个参数，问你子串 $s[a..b]$ 的所有子串和 $s[c..d]$ 的最长公共前缀的长度的最大值是多少？佳媛姐姐并不擅长做这样的问题，所以她向你求助，你该如何帮助她呢？\n", "inputFormat": "输入的第一行有两个正整数 $n,m$，分别表示字符串的长度和询问的个数。\n\n接下来一行是一个长为 $n$ 的字符串。接下来 $m$ 行，每行有 $4$ 个数 $a,b,c,d$，表示询问 $s[a..b]$ 的所有子串和 $s[c..d]$ 的最长公共前缀的最大值。\n", "outputFormat": "对于每一次询问，输出答案。\n", "hint": "对于 $10\\%$ 的数据，$1\\le n,m\\le 300$。\n\n对于 $40\\%$ 的数据，$1\\le n,m\\le 3,000$，字符串中仅有 `a`,`b`。\n\n对于 $100\\%$ 的数据，$1\\le n,m\\le 100,000$，字符串中仅有小写英文字母，$a\\le b$，$c\\le d$，$1\\le a,b,c,d\\le n$。\n", "locale": "zh-CN"}}}
{"pid": "P4095", "type": "P", "difficulty": 5, "samples": [["5 \n2 3 4 \n1 2 1 \n4 1 2 \n2 1 1 \n3 2 3 \n5 \n1 10 \n2 7 \n3 4 \n4 8 \n0 5", "13 \n11 \n6 \n12 \n4 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2013", "各省省选", "河北", "枚举", "背包 DP", "进制"], "title": "[HEOI2013] Eden 的新背包问题", "background": "“ 寄 没 有 地 址 的 信 ，这 样 的 情 绪 有 种 距 离 ，你 放 着 谁 的 歌 曲 ，是 怎 样 的 心 情 。 能 不 能 说 给 我 听 。”", "description": "失忆的 Eden 总想努力地回忆起过去，然而总是只能清晰地记得那种思念的感觉，却不能回忆起她的音容笑貌。\n\n记忆中，她总是喜欢给 Eden 出谜题：在 valentine's day 的夜晚，两人在闹市中闲逛时，望着礼品店里精巧玲珑的各式玩偶，她突发奇想，问了 Eden 这样的一个问题：有 $n$ 个玩偶，每个玩偶有对应的价值、价钱，每个玩偶都可以被买有限次，在携带的价钱 $m$ 固定的情况下，如何选择买哪些玩偶以及每个玩偶买多少个，才能使得选择的玩偶总价钱不超过 $m$，且价值和最大。\n\n众所周知的，这是一个很经典的多重背包问题，Eden 很快解决了，不过她似乎因为自己的问题被飞快解决感到了一丝不高兴，于是她希望把问题加难：多次询问，每次询问都将给出新的总价钱，并且会去掉某个玩偶（即这个玩偶不能被选择），再问此时的多重背包的答案（即前一段所叙述的问题）。\n\n这下 Eden 犯难了，不过 Eden 不希望自己被难住，你能帮帮他么？", "inputFormat": "第一行有一个整数，代表玩偶的个数 $n$，玩偶从 $0$ 开始编号。\n\n第二行开始后面的 $n$ 行，每行三个整数，第 $(i + 2)$ 行的整数  $a_i, b_i, c_i$，分别表示买一个第 $i$ 个玩偶需要的价钱，获得的价值以及第 $i$ 个玩偶的限购次数。\n\n接下来的一行有一个整数 $q$，表示询问次数。\n\n接下来 $q$ 行，每行两个整数 $d_i, e_i$，表示每个询问去掉的是哪个玩偶（注意玩偶从 $0$ 开始编号）以及该询问对应的新的总价钱数。（去掉操作不保留，即不同询问互相独立）。", "outputFormat": "输出 $q$ 行，第 $i$ 行输出对于第 $i$ 个询问的答案。", "hint": "#### 样例解释\n\n一共五种玩偶，分别的价钱价值和限购次数为 $(2,3,4)$， $(1,2,1)$， $(4,1,2)$， $(2,1,1)$， $(3,2,3)$。\n\n五个询问，以第一个询问为例。\n\n第一个询问表示的是去掉编号为 $1$ 的玩偶， 且拥有的钱数为 $10$ 时可以获得的最大价值，则此时剩余玩偶为 $(2,3,4$)，$(4,1,2)$， $(2,1,1)$，$(3,2,3)$，若把编号为 $0$ 的玩偶买 $4$ 个（即全买了），然后编号为 $3$ 的玩偶 买一个，则刚好把 $10$ 元全部花完，且总价值为 $13$。可以证明没有更优的方案了。\n\n注意买某种玩偶不一定要买光。\n\n---\n\n#### 数据规模与约定\n\n- 对于 $10\\%$ 的数据，保证 $n \\leq 10$。\n- 另外存在 $20\\%$ 的数据，保证  $n \\leq 100$，$c_i = 1$，$q \\leq 100$。\n- 另外存在 $20\\%$ 的数据，保证 $n \\leq 100$，$q \\leq 100$。\n- 另外存在 $30\\%$ 的数据，保证 $c_i = 1$。\n- 对于 $100\\%$ 的数据，保证  $1 \\leq n \\leq 1000$，$1 \\leq q \\leq 3\\times 10^5$， $1 \\leq a_i,b_i,c_i \\leq 100$，$0 \\leq d_i < n$，$0 \\leq e_i \\leq 1000$。\n\n", "locale": "zh-CN", "translations": {"en": {"title": "[HEOI2013] Eden's New Knapsack Problem", "background": "\"Sending a letter without an address, such a feeling has a kind of distance; whose song are you playing, and what mood is it? Could you tell me?\".", "description": "The amnesiac Eden keeps trying to recall the past, yet he can only clearly remember the feeling of longing, not her face or smile.\n\nIn his memory, she always liked giving Eden puzzles. On Valentine's Day night, while the two were strolling through a bustling street and gazing at the delicate dolls in a gift shop, she suddenly asked Eden a question: there are $n$ dolls. Each doll has a cost and a value, and each doll can be bought a limited number of times. With a fixed budget $m$, how should one choose which dolls to buy and how many copies of each, so that the total cost does not exceed $m$ and the total value is maximized.\n\nAs is well known, this is a classic multiple knapsack problem. Eden solved it quickly, but she seemed a bit unhappy that her problem was answered so fast. So she made it harder: there will be multiple queries. In each query, a new budget is given and one doll is removed (i.e., that doll cannot be chosen). Then the answer to the multiple knapsack under this condition is asked (i.e., the problem described above).\n\nNow Eden is in trouble, but he does not want to be stumped. Can you help him?.", "inputFormat": "- The first line contains an integer $n$, the number of dolls. Dolls are indexed starting from $0$.\n- The next $n$ lines, each line contains three integers. On line $i + 2$, the integers $a_i, b_i, c_i$ denote the cost of one copy of doll $i$, the value obtained, and the purchase limit of doll $i$, respectively.\n- The next line contains an integer $q$, the number of queries.\n- The next $q$ lines, each contains two integers $d_i, e_i$, indicating which doll is removed (note that dolls are indexed from $0$) and the new budget for this query. The removal does not persist, i.e., different queries are independent.", "outputFormat": "Output $q$ lines. On the $i$-th line, output the answer for the $i$-th query.", "hint": "Sample Explanation.\n\nThere are five types of dolls. Their costs, values, and purchase limits are $(2,3,4)$, $(1,2,1)$, $(4,1,2)$, $(2,1,1)$, $(3,2,3)$.\n\nThere are five queries. Take the first query as an example.\n\nThe first query removes the doll with index $1$, and asks for the maximum value when the budget is $10$. The remaining dolls are $(2,3,4)$, $(4,1,2)$, $(2,1,1)$, $(3,2,3)$. If you buy $4$ copies of doll $0$ (i.e., all of them), and then buy one copy of doll $3$, you spend exactly $10$ and the total value is $13$. It can be proved that there is no better solution.\n\nNote that you do not have to buy all available copies of a doll.\n\nConstraints.\n\n- For $10\\%$ of the testdata, it is guaranteed that $n \\leq 10$.\n- Additionally, for $20\\%$ of the testdata, it is guaranteed that $n \\leq 100$, $c_i = 1$, $q \\leq 100$.\n- Additionally, for $20\\%$ of the testdata, it is guaranteed that $n \\leq 100$, $q \\leq 100$.\n- Additionally, for $30\\%$ of the testdata, it is guaranteed that $c_i = 1$.\n- For $100\\%$ of the testdata, it is guaranteed that $1 \\leq n \\leq 1000$, $1 \\leq q \\leq 3\\times 10^5$, $1 \\leq a_i,b_i,c_i \\leq 100$, $0 \\leq d_i < n$, $0 \\leq e_i \\leq 1000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HEOI2013] Eden 的新背包问题", "background": "“ 寄 没 有 地 址 的 信 ，这 样 的 情 绪 有 种 距 离 ，你 放 着 谁 的 歌 曲 ，是 怎 样 的 心 情 。 能 不 能 说 给 我 听 。”", "description": "失忆的 Eden 总想努力地回忆起过去，然而总是只能清晰地记得那种思念的感觉，却不能回忆起她的音容笑貌。\n\n记忆中，她总是喜欢给 Eden 出谜题：在 valentine's day 的夜晚，两人在闹市中闲逛时，望着礼品店里精巧玲珑的各式玩偶，她突发奇想，问了 Eden 这样的一个问题：有 $n$ 个玩偶，每个玩偶有对应的价值、价钱，每个玩偶都可以被买有限次，在携带的价钱 $m$ 固定的情况下，如何选择买哪些玩偶以及每个玩偶买多少个，才能使得选择的玩偶总价钱不超过 $m$，且价值和最大。\n\n众所周知的，这是一个很经典的多重背包问题，Eden 很快解决了，不过她似乎因为自己的问题被飞快解决感到了一丝不高兴，于是她希望把问题加难：多次询问，每次询问都将给出新的总价钱，并且会去掉某个玩偶（即这个玩偶不能被选择），再问此时的多重背包的答案（即前一段所叙述的问题）。\n\n这下 Eden 犯难了，不过 Eden 不希望自己被难住，你能帮帮他么？", "inputFormat": "第一行有一个整数，代表玩偶的个数 $n$，玩偶从 $0$ 开始编号。\n\n第二行开始后面的 $n$ 行，每行三个整数，第 $(i + 2)$ 行的整数  $a_i, b_i, c_i$，分别表示买一个第 $i$ 个玩偶需要的价钱，获得的价值以及第 $i$ 个玩偶的限购次数。\n\n接下来的一行有一个整数 $q$，表示询问次数。\n\n接下来 $q$ 行，每行两个整数 $d_i, e_i$，表示每个询问去掉的是哪个玩偶（注意玩偶从 $0$ 开始编号）以及该询问对应的新的总价钱数。（去掉操作不保留，即不同询问互相独立）。", "outputFormat": "输出 $q$ 行，第 $i$ 行输出对于第 $i$ 个询问的答案。", "hint": "#### 样例解释\n\n一共五种玩偶，分别的价钱价值和限购次数为 $(2,3,4)$， $(1,2,1)$， $(4,1,2)$， $(2,1,1)$， $(3,2,3)$。\n\n五个询问，以第一个询问为例。\n\n第一个询问表示的是去掉编号为 $1$ 的玩偶， 且拥有的钱数为 $10$ 时可以获得的最大价值，则此时剩余玩偶为 $(2,3,4$)，$(4,1,2)$， $(2,1,1)$，$(3,2,3)$，若把编号为 $0$ 的玩偶买 $4$ 个（即全买了），然后编号为 $3$ 的玩偶 买一个，则刚好把 $10$ 元全部花完，且总价值为 $13$。可以证明没有更优的方案了。\n\n注意买某种玩偶不一定要买光。\n\n---\n\n#### 数据规模与约定\n\n- 对于 $10\\%$ 的数据，保证 $n \\leq 10$。\n- 另外存在 $20\\%$ 的数据，保证  $n \\leq 100$，$c_i = 1$，$q \\leq 100$。\n- 另外存在 $20\\%$ 的数据，保证 $n \\leq 100$，$q \\leq 100$。\n- 另外存在 $30\\%$ 的数据，保证 $c_i = 1$。\n- 对于 $100\\%$ 的数据，保证  $1 \\leq n \\leq 1000$，$1 \\leq q \\leq 3\\times 10^5$， $1 \\leq a_i,b_i,c_i \\leq 100$，$0 \\leq d_i < n$，$0 \\leq e_i \\leq 1000$。\n\n", "locale": "zh-CN"}}}
{"pid": "P4096", "type": "P", "difficulty": 5, "samples": [["7 \n1 \n1 \n2 \n2 \n3 \n3", "4 4 0 \n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["动态规划 DP", "博弈论", "2013", "各省省选", "河北", "博弈树"], "title": "[HEOI2013] Eden 的博弈树", "background": "", "description": "对于有两个玩家的，状态透明且状态转移确定的博弈游戏，博弈树是常用的分析工具。博弈树是一棵有根树，其中的节点为游戏的状态。若节点 B 的父亲是 A，则说明状态 A 能通过一次决策转移到状态 B。每个状态都有一个唯一的决策方，即这个状态下应该由哪一方做出决策。我们规定双方在任何时候都是轮流做出决策的，即树上相邻节点的决策方总是不相同的。\n\n在这个问题中，我们只关心两个玩家的胜负情况，且规定游戏不会出现平局。\n\n我们称两个玩家分别为黑方和白方，其中根节点的决策方为黑方。显然每个节点只有两个状态：黑方胜和白方胜。若某内节点（即存在后继节点的节点）的决策方为黑方，则该节点为黑方胜的充要条件为它的儿子中存在黑方胜的节点，反之亦然。求解博弈树即为判明博弈树根节点的状态。\n\n如果我们得知了所有叶节点（即无后继节点的节点）的状态，那么博弈树就很容易求解了。但是现在的情况是所有叶节点的状态均为未知的，需要进一步的计算。对于一个由叶节点构成的集合 $S$，如果 $S$ 中的节点均被判明为黑方胜，就可以断言根节点为黑方胜的话，则称 $S$ 为一个黑方胜集合。对于黑方胜集合 $S$， 如果对于任意的黑方胜集合 $S'$ 均满足 $|S| \\le |S'|$（$|S|$ 表示集合 $S$ 中的元素数目）， 则称 $S$ 为一个最小黑方胜集合。同样地，也可以定义白方胜集合和最小白方胜集合。\n\nEden 最近在研究博弈树问题。他发现，如果一个叶节点既属于某一个最小黑方胜集合，又属于一个最小白方胜集合，那么求解这个节点的状态显然最有益于求解根节点的状态。像这样的叶节点就称之为关键叶节点。对于一棵给定的博弈树，Eden 想要知道哪些叶节点是关键叶节点。\n", "inputFormat": "每个测试点包含一组测试数据。\n\n测试数据的第一行包含一个正整数 $n$，表示博弈树的节点数目。节点从 $1$ 到 $n$ 编号，且 $1$ 号节点为根节点。\n\n之后 $n - 1$ 行，每行包含一个正整数。第 $i$ 行的正整数表示节点 $i$ 的父节点的编号。\n", "outputFormat": "在一行内输出三个空格分隔的正整数，分别是编号最小的关键叶节点的编号，关键叶节点的数目和所有关键叶节点的编号的异或和。\n", "hint": "【样例说明】\n\n  ![](https://cdn.luogu.com.cn/upload/pic/13130.png) \n\n如图所示，黑色节点表示决策方为黑方的节点，反之亦然\n\n所有的最小黑方胜集合为 $\\{4, 5\\}$ 和 $\\{6, 7\\}$。\n\n所有的最小白方胜集合为 $\\{4, 6\\}$，$\\{4, 7\\}$，$\\{5, 6\\}$ 和 $\\{5, 7\\}$。\n\n所以关键叶节点的集合为 $\\{4, 5, 6, 7\\}$。\n\n- 对于 $30\\%$ 的数据，$n \\le 100$；\n- 对于 $40\\%$ 的数据，$n \\le 1000$；\n- 对于 $50\\%$ 的数据，$n \\le 10 ^ 4$，且树是随机生成的；\n- 对于 $100\\%$ 的数据，$1 \\le n \\le 2\\times 10 ^ 5$，且对于节点 $i$（$i \\ne 1$），其父节点的编号小于 $i$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[HEOI2013] Eden's Game Tree", "background": "# Description\n\nFor a two-player, perfect-information, deterministic game, a game tree is a common analysis tool. A game tree is a rooted tree whose nodes are game states. If node B’s parent is A, then state A can transition to state B with a single decision. Each state has a unique player to move, i.e., exactly one side should make the move at that state. We assume the two players alternate moves at all times, meaning adjacent nodes in the tree always have different players to move.\n\nIn this problem, we only care about which player wins, and we assume the game cannot end in a draw.\n\nWe call the two players Black and White, and the root’s player to move is Black. Clearly, each node has exactly two possible outcomes: Black wins or White wins. If an internal node (i.e., a node that has children) is a Black-to-move node, then this node is winning for Black if and only if at least one of its children is winning for Black; conversely for a White-to-move node. Solving the game tree means determining the outcome at the root.\n\nIf we already knew the outcomes of all leaves (nodes without children), the game tree would be easy to solve. However, here the outcomes of all leaves are unknown and need further computation. For a set of leaves $S$, if knowing that every node in $S$ is a win for Black is sufficient to assert that the root is a win for Black, then $S$ is called a Black-winning set. Among Black-winning sets $S$, if for any other Black-winning set $S'$ it holds that $|S| \\le |S'|$ (where $|S|$ denotes the number of elements in $S$), then $S$ is a minimal Black-winning set. Similarly, we can define White-winning sets and minimal White-winning sets.\n\nEden is studying game trees. He noticed that if a leaf belongs to some minimal Black-winning set and also to some minimal White-winning set, then determining this leaf’s outcome is clearly most helpful for determining the root’s outcome. Such leaves are called critical leaf nodes. For a given game tree, Eden wants to know which leaves are critical leaf nodes.", "description": "", "inputFormat": "", "outputFormat": "Print three space-separated positive integers on a single line: the index of the critical leaf node with the smallest index, the number of critical leaf nodes, and the bitwise XOR of the indices of all critical leaf nodes.", "hint": "[Sample explanation]\n\n  ![](https://cdn.luogu.com.cn/upload/pic/13130.png) \n\nAs shown, black nodes indicate Black-to-move nodes, and white nodes indicate White-to-move nodes.\n\nAll minimal Black-winning sets are $\\{4, 5\\}$ and $\\{6, 7\\}$.\n\nAll minimal White-winning sets are $\\{4, 6\\}$, $\\{4, 7\\}$, $\\{5, 6\\}$, and $\\{5, 7\\}$.\n\nTherefore, the set of critical leaf nodes is $\\{4, 5, 6, 7\\}$.\n\n- For $30\\%$ of the testdata, $n \\le 100$.\n- For $40\\%$ of the testdata, $n \\le 1000$.\n- For $50\\%$ of the testdata, $n \\le 10 ^ 4$, and the tree is randomly generated.\n- For $100\\%$ of the testdata, $1 \\le n \\le 2\\times 10 ^ 5$, and for node $i$ ($i \\ne 1$), the index of its parent is less than $i$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[HEOI2013] Eden 的博弈树", "background": "", "description": "对于有两个玩家的，状态透明且状态转移确定的博弈游戏，博弈树是常用的分析工具。博弈树是一棵有根树，其中的节点为游戏的状态。若节点 B 的父亲是 A，则说明状态 A 能通过一次决策转移到状态 B。每个状态都有一个唯一的决策方，即这个状态下应该由哪一方做出决策。我们规定双方在任何时候都是轮流做出决策的，即树上相邻节点的决策方总是不相同的。\n\n在这个问题中，我们只关心两个玩家的胜负情况，且规定游戏不会出现平局。\n\n我们称两个玩家分别为黑方和白方，其中根节点的决策方为黑方。显然每个节点只有两个状态：黑方胜和白方胜。若某内节点（即存在后继节点的节点）的决策方为黑方，则该节点为黑方胜的充要条件为它的儿子中存在黑方胜的节点，反之亦然。求解博弈树即为判明博弈树根节点的状态。\n\n如果我们得知了所有叶节点（即无后继节点的节点）的状态，那么博弈树就很容易求解了。但是现在的情况是所有叶节点的状态均为未知的，需要进一步的计算。对于一个由叶节点构成的集合 $S$，如果 $S$ 中的节点均被判明为黑方胜，就可以断言根节点为黑方胜的话，则称 $S$ 为一个黑方胜集合。对于黑方胜集合 $S$， 如果对于任意的黑方胜集合 $S'$ 均满足 $|S| \\le |S'|$（$|S|$ 表示集合 $S$ 中的元素数目）， 则称 $S$ 为一个最小黑方胜集合。同样地，也可以定义白方胜集合和最小白方胜集合。\n\nEden 最近在研究博弈树问题。他发现，如果一个叶节点既属于某一个最小黑方胜集合，又属于一个最小白方胜集合，那么求解这个节点的状态显然最有益于求解根节点的状态。像这样的叶节点就称之为关键叶节点。对于一棵给定的博弈树，Eden 想要知道哪些叶节点是关键叶节点。\n", "inputFormat": "每个测试点包含一组测试数据。\n\n测试数据的第一行包含一个正整数 $n$，表示博弈树的节点数目。节点从 $1$ 到 $n$ 编号，且 $1$ 号节点为根节点。\n\n之后 $n - 1$ 行，每行包含一个正整数。第 $i$ 行的正整数表示节点 $i$ 的父节点的编号。\n", "outputFormat": "在一行内输出三个空格分隔的正整数，分别是编号最小的关键叶节点的编号，关键叶节点的数目和所有关键叶节点的编号的异或和。\n", "hint": "【样例说明】\n\n  ![](https://cdn.luogu.com.cn/upload/pic/13130.png) \n\n如图所示，黑色节点表示决策方为黑方的节点，反之亦然\n\n所有的最小黑方胜集合为 $\\{4, 5\\}$ 和 $\\{6, 7\\}$。\n\n所有的最小白方胜集合为 $\\{4, 6\\}$，$\\{4, 7\\}$，$\\{5, 6\\}$ 和 $\\{5, 7\\}$。\n\n所以关键叶节点的集合为 $\\{4, 5, 6, 7\\}$。\n\n- 对于 $30\\%$ 的数据，$n \\le 100$；\n- 对于 $40\\%$ 的数据，$n \\le 1000$；\n- 对于 $50\\%$ 的数据，$n \\le 10 ^ 4$，且树是随机生成的；\n- 对于 $100\\%$ 的数据，$1 \\le n \\le 2\\times 10 ^ 5$，且对于节点 $i$（$i \\ne 1$），其父节点的编号小于 $i$。\n", "locale": "zh-CN"}}}
{"pid": "P4097", "type": "P", "difficulty": 6, "samples": [["6 \n1 8 5 10 8 \n1 6 7 2 6 \n0 2 \n0 9 \n1 4 7 6 7 \n0 5", "2 \n0 \n3"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["贪心", "2013", "线段树", "各省省选", "递归", "河北", "李超线段树", "模板题"], "title": "【模板】李超线段树 / [HEOI2013] Segment", "background": "", "description": "要求在平面直角坐标系下维护两个操作：\n\n1. 在平面上加入一条线段。记第 $i$ 条被插入的线段的标号为 $i$。\n2. 给定一个数 $k$，询问与直线 $x = k$ 相交的线段中，交点纵坐标最大的线段的编号。", "inputFormat": "**本题输入强制在线**。\n\n输入的第一行是一个整数 $n$，代表操作的个数。\n\n接下来 $n$ 行，每行若干个用空格隔开的整数，第 $i + 1$ 行的第一个整数为 $op$，代表第 $i$ 次操作的类型。\n\n若 $op = 0$，则后跟一个整数 $k$，代表本次操作为查询所所有与直线 $x = (k + lastans - 1) \\bmod 39989 + 1$ 相交的线段中，交点纵坐标最大的线段编号。\n\n若 $op = 1$，则后跟四个整数 $x_0, y_0, x_1, y_1$，记 $x_i' = (x_i + lastans - 1) \\bmod 39989 + 1$，$y_i' = (y_i + lastans - 1) \\bmod 10^9 + 1$。本次操作为插入一条两端点分别为 $(x_0', y_0')$，$(x_1',y_1')$ 的线段。\n\n其中 $lastans$ 为上次询问的答案，初始时，$lastans = 0$。", "outputFormat": "对于每次查询，输出一行一个整数，代表交点纵坐标最大的线段的编号。若不存在任何一条线段与查询直线有交，则输出 $0$；若有多条线段与查询直线的交点纵坐标都是最大的，则输出编号最小的线段，同时 $lastans$ 也应更新为编号最小的一条线段。", "hint": "### 样例 $1$ 解释\n\n对于第一次操作，解密后为 `1 8 5 10 8`。\n\n对于第二次操作，解密后为 `1 6 7 2 6`。\n\n对于第三次操作，解密后为 `0 2`，此时 $lastans$ 被更新为 $2$。\n\n对于第四次操作，解密后为 `0 11`，此时 $lastans$ 被更新为 $0$。\n\n对于第五次操作，解密后为 `1 4 7 6 7`。\n\n对于第六次操作，解密后为 `0 5`。\n\n### 数据范围与约定\n\n对于 $30\\%$ 的数据，保证 $n \\leq 10^3$。\n\n对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 10^5$，$1 \\leq k, x_0, x_1 \\leq 39989$，$1 \\leq y_0, y_1 \\leq 10^9$。\n\n### 提示\n\n不保证 $x_0 \\neq x_1$。对于一条 $x_0' = x_1'$ 的线段，认为其与 $x = x_0'$ 的交点为其两端点中纵坐标较大的端点。", "locale": "zh-CN", "translations": {"en": {"title": "[Template] Li Chao Segment Tree / [HEOI2013] Segment", "background": "", "description": "Maintain two operations in the 2D Cartesian coordinate system:\n\n1. Insert a line segment into the plane. The index of the i-th inserted segment is $i$.\n2. Given a number $k$, query among all segments that intersect the line $x = k$, and return the index of the segment whose intersection point has the largest $y$-coordinate.", "inputFormat": "This problem enforces online input.\n\nThe first line contains an integer $n$, the number of operations.\n\nThen $n$ lines follow. On each line there are several integers separated by spaces. On the $(i + 1)$-th line, the first integer is $op$, indicating the type of the $i$-th operation.\n\n- If $op = 0$, then it is followed by an integer $k$. This operation queries among all segments that intersect the line $x = (k + lastans - 1) \\bmod 39989 + 1$, and returns the index of the segment whose intersection point has the largest $y$-coordinate.\n- If $op = 1$, then it is followed by four integers $x_0, y_0, x_1, y_1$. Define $x_i' = (x_i + lastans - 1) \\bmod 39989 + 1$, $y_i' = (y_i + lastans - 1) \\bmod 10^9 + 1$. This operation inserts a segment with endpoints $(x_0', y_0')$ and $(x_1', y_1')$.\n\nHere $lastans$ is the answer to the previous query. Initially, $lastans = 0$.", "outputFormat": "For each query, output one line containing a single integer: the index of the segment whose intersection point has the largest $y$-coordinate. If no segment intersects the query line, output $0$. If multiple segments have the same maximum intersection $y$-coordinate, output the smallest index among them, and $lastans$ should also be updated to this smallest index.", "hint": "### Explanation for Sample $1$\n\nFor the first operation, after decoding it becomes `1 8 5 10 8`.\n\nFor the second operation, after decoding it becomes `1 6 7 2 6`.\n\nFor the third operation, after decoding it becomes `0 2`, and $lastans$ is updated to $2$.\n\nFor the fourth operation, after decoding it becomes `0 11`, and $lastans$ is updated to $0$.\n\nFor the fifth operation, after decoding it becomes `1 4 7 6 7`.\n\nFor the sixth operation, after decoding it becomes `0 5`.\n\n### Constraints\n\nFor $30\\%$ of the testdata, $n \\leq 10^3$ is guaranteed.\n\nFor $100\\%$ of the testdata, it is guaranteed that $1 \\leq n \\leq 10^5$, $1 \\leq k, x_0, x_1 \\leq 39989$, $1 \\leq y_0, y_1 \\leq 10^9$.\n\n### Notes\n\nIt is not guaranteed that $x_0 \\neq x_1$. For a segment with $x_0' = x_1'$, its intersection with $x = x_0'$ is defined to be the endpoint with the larger $y$-coordinate.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【模板】李超线段树 / [HEOI2013] Segment", "background": "", "description": "要求在平面直角坐标系下维护两个操作：\n\n1. 在平面上加入一条线段。记第 $i$ 条被插入的线段的标号为 $i$。\n2. 给定一个数 $k$，询问与直线 $x = k$ 相交的线段中，交点纵坐标最大的线段的编号。", "inputFormat": "**本题输入强制在线**。\n\n输入的第一行是一个整数 $n$，代表操作的个数。\n\n接下来 $n$ 行，每行若干个用空格隔开的整数，第 $i + 1$ 行的第一个整数为 $op$，代表第 $i$ 次操作的类型。\n\n若 $op = 0$，则后跟一个整数 $k$，代表本次操作为查询所所有与直线 $x = (k + lastans - 1) \\bmod 39989 + 1$ 相交的线段中，交点纵坐标最大的线段编号。\n\n若 $op = 1$，则后跟四个整数 $x_0, y_0, x_1, y_1$，记 $x_i' = (x_i + lastans - 1) \\bmod 39989 + 1$，$y_i' = (y_i + lastans - 1) \\bmod 10^9 + 1$。本次操作为插入一条两端点分别为 $(x_0', y_0')$，$(x_1',y_1')$ 的线段。\n\n其中 $lastans$ 为上次询问的答案，初始时，$lastans = 0$。", "outputFormat": "对于每次查询，输出一行一个整数，代表交点纵坐标最大的线段的编号。若不存在任何一条线段与查询直线有交，则输出 $0$；若有多条线段与查询直线的交点纵坐标都是最大的，则输出编号最小的线段，同时 $lastans$ 也应更新为编号最小的一条线段。", "hint": "### 样例 $1$ 解释\n\n对于第一次操作，解密后为 `1 8 5 10 8`。\n\n对于第二次操作，解密后为 `1 6 7 2 6`。\n\n对于第三次操作，解密后为 `0 2`，此时 $lastans$ 被更新为 $2$。\n\n对于第四次操作，解密后为 `0 11`，此时 $lastans$ 被更新为 $0$。\n\n对于第五次操作，解密后为 `1 4 7 6 7`。\n\n对于第六次操作，解密后为 `0 5`。\n\n### 数据范围与约定\n\n对于 $30\\%$ 的数据，保证 $n \\leq 10^3$。\n\n对于 $100\\%$ 的数据，保证 $1 \\leq n \\leq 10^5$，$1 \\leq k, x_0, x_1 \\leq 39989$，$1 \\leq y_0, y_1 \\leq 10^9$。\n\n### 提示\n\n不保证 $x_0 \\neq x_1$。对于一条 $x_0' = x_1'$ 的线段，认为其与 $x = x_0'$ 的交点为其两端点中纵坐标较大的端点。", "locale": "zh-CN"}}}
