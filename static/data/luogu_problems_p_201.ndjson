{"pid": "P5066", "type": "P", "difficulty": 7, "samples": [["5 5\n0 1 0 0 1\n3 2 5\n5 2 5\n2 2 2\n6 1 5\n7 1 5", "1"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 8000, 8000, 8000, 8000, 8000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2014", "平衡树", "颜色段均摊（珂朵莉树 ODT）", "O2优化", "Ynoi"], "title": "[Ynoi Easy Round 2014] 人人本着正义之名", "background": "那是什么？  \n【不是第六兽，是新的兽？】  \n【我从来没见过那种玩意啊】  \n![](https://cdn.luogu.com.cn/upload/pic/45515.png)    \n【全员退避】  \n【现已确认出现预料之外的兽】  \n【根据这一事态，将作战确认为失败，放弃15号岛】  \n怎么会...  \n![](https://cdn.luogu.com.cn/upload/pic/45516.png)   \n我和他约好了的  \n绝对要活着回去  \n![](https://cdn.luogu.com.cn/upload/pic/45517.png)   \n对他说“我回来了”，然后品尝黄油蛋糕  \n所以，要是世界终结的话我会很伤脑筋的  \n![](https://cdn.luogu.com.cn/upload/pic/45518.png)   \n融没于晨雾之中的树林  \n啊...？  \n![](https://cdn.luogu.com.cn/upload/pic/45519.png)  \n【牛奶迹.耀眼花瓣.狂风气团】  \n【挂于墙上的鲱鱼.倒立的刺猬.袋中的风琴】  \n这是什么...？  \n![](https://cdn.luogu.com.cn/upload/pic/45520.png)  \n你其实...很想战斗的对吧  \n虽然我不知道你有什么打算，但是已经够了  \n![](https://cdn.luogu.com.cn/upload/pic/45521.png)  \n你已经不用战斗了  \n因为你的战斗，已经由我，由我们继承下来了  \n【其实我很感激你】  \n【一直以来，我心里就只想着死】  \n![](https://cdn.luogu.com.cn/upload/pic/45523.png)  \n【渴望去往那些等着我回去的家伙身边，这是我唯一的愿望】  \n【但是遇见你们之后，我有了一些改变】  \n【我又开始渴望获得一个容身之处了】  \n【遇见你之后，我得到了一些救赎】  \n【能够等到你平安归来，我现在...】  \n【嗯，可以说，感受到了一丝幸福】  \n啊...？   \n![](https://cdn.luogu.com.cn/upload/pic/45524.png)  \n【不...等一下，你别这么露骨地和我拉开距离啊】  \n【也别露出一副“这个不知廉耻的生物是怎样”的表情啊】   \n【不过话说回来，你观察我观察地很仔细啊】  \n哈哈...  \n因为喜欢上了嘛~   \n![](https://cdn.luogu.com.cn/upload/pic/45525.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45526.png)  \n【由不得我啊】  \n你要去的话我会生气的，我会大发雷霆的  \n【珂朵莉...】   \n![](https://cdn.luogu.com.cn/upload/pic/45527.png)  \n【对不起】\n![](https://cdn.luogu.com.cn/upload/pic/45528.png)  \n我等你  \n![](https://cdn.luogu.com.cn/upload/pic/45529.png)  \n我会等着你的，所以一定要回来哦   \n![](https://cdn.luogu.com.cn/upload/pic/45530.png)  \n【我保证，一定会回来的】  \n嗯  \n说好了哦~   \n![](https://cdn.luogu.com.cn/upload/pic/45531.png)   ", "description": "你需要帮珂朵莉维护一个长为 $n$ 的 `01`序列 $a$，有 $m$ 个操作：  \n- `1 l r`：把区间 $[l,r]$ 的数变成 $0$。\n- `2 l r`：把区间 $[l,r]$ 的数变成 $1$。\n- `3 l r`：$[l,r-1]$ 内所有数 $a_i$，变为 $a_i$ 与 $a_{i+1}$ 按位或的值，这些数同时进行这个操作。\n- `4 l r`：$[l+1,r]$ 内所有数 $a_i$，变为 $a_i$ 与 $a_{i-1}$ 按位或的值，这些数同时进行这个操作。\n- `5 l r`：$[l,r-1]$ 内所有数 $a_i$，变为 $a_i$ 与 $a_{i+1}$ 按位与的值，这些数同时进行这个操作。\n- `6 l r`：$[l+1,r]$ 内所有数 $a_i$，变为 $a_i$ 与 $a_{i-1}$ 按位与的值，这些数同时进行这个操作。\n- `7 l r`：查询区间 $[l,r]$ 的和。\n\n本题强制在线，每次的 $l,r$ 需要与上次答案做 $\\operatorname{xor}$ 运算，如果之前没有询问，则上次答案为 $0$。", "inputFormat": "第一行两个整数表示 $n$ 和 $m$。\n\n第二行 $n$ 个整数表示序列 $a$。\n\n之后 $m$ 行，每行三个整数 $opt,l,r$，表示是哪一种操作以及操作对应的区间。\n", "outputFormat": "对于每个查询操作输出一行一个数表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n序列每次的样子：\n$$0\\ 1\\ 0\\ 0\\ 1$$\n$$0\\ 1\\ 0\\ 1\\ 1$$\n$$0\\ 0\\ 0\\ 1\\ 1$$\n$$0\\ 1\\ 0\\ 1\\ 1$$\n$$0\\ 0\\ 0\\ 0\\ 1$$\n$$0\\ 0\\ 0\\ 0\\ 1$$\n\n对于 $30\\%$ 的数据，$n,m\\leq 1000$。\n\n对于 $50\\%$ 的数据，$n,m\\leq 10^5$。\n\n对于另外 $30\\%$ 的数据，操作和序列均随机生成。\n\n对于另外 $10\\%$ 的数据，$n,m\\leq 10^6$。\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 3 \\times 10^6$，$0\\leq a_i\\leq 1$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi Easy Round 2014] Everyone in the Name of Justice.", "background": "What is that?  \n【Not the Sixth Beast, but a new beast?】  \n【I have never seen that thing before.】  \n![](https://cdn.luogu.com.cn/upload/pic/45515.png)    \n【All personnel retreat.】  \n【An unexpected beast has been confirmed.】  \n【Based on this situation, confirm the operation as a failure and abandon Island No. 15.】  \nHow could this be...  \n![](https://cdn.luogu.com.cn/upload/pic/45516.png)   \nI made a promise with him.  \nWe must come back alive, no matter what.  \n![](https://cdn.luogu.com.cn/upload/pic/45517.png)   \nI will tell him, “I’m back,” and then taste the butter cake.  \nSo if the world ends, I will be in big trouble.  \n![](https://cdn.luogu.com.cn/upload/pic/45518.png)   \nA forest melting into the morning mist.  \nAh...?  \n![](https://cdn.luogu.com.cn/upload/pic/45519.png)  \n【Milk traces, dazzling petals, a whirlwind air mass.】  \n【A herring hung on the wall, an upside-down hedgehog, an organ in a bag.】  \nWhat is this...?  \n![](https://cdn.luogu.com.cn/upload/pic/45520.png)  \nActually... you really want to fight, right?  \nAlthough I do not know what you are planning, it is enough already.  \n![](https://cdn.luogu.com.cn/upload/pic/45521.png)  \nYou do not need to fight anymore.  \nBecause your fight has already been inherited by me, by us.  \n【Actually, I am very grateful to you.】  \n【All this time, all I could think about was dying.】  \n![](https://cdn.luogu.com.cn/upload/pic/45523.png)  \n【Longing to go back to those guys waiting for me, that was my only wish.】  \n【But after meeting you, I changed a little.】  \n【I started longing for a place to belong again.】  \n【After meeting you, I found some salvation.】  \n【Being able to wait until you return safely, right now I...】  \n【Well, you could say I feel a bit of happiness.】  \nAh...?  \n![](https://cdn.luogu.com.cn/upload/pic/45524.png)  \n【N-no... wait, do not distance yourself from me so directly.】  \n【And do not make that face like “what is this shameless creature doing.”】  \n【But then again, you observed me very carefully.】  \nHaha...  \nBecause I fell for you~  \n![](https://cdn.luogu.com.cn/upload/pic/45525.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45526.png)  \n【I cannot help it.】  \nIf you go, I will be angry, I will rage.  \n【Chtholly...】  \n![](https://cdn.luogu.com.cn/upload/pic/45527.png)  \n【Sorry.】  \n![](https://cdn.luogu.com.cn/upload/pic/45528.png)  \nI will wait for you.  \n![](https://cdn.luogu.com.cn/upload/pic/45529.png)  \nI will wait for you, so you must come back.  \n![](https://cdn.luogu.com.cn/upload/pic/45530.png)  \n【I promise, I will definitely come back.】  \nMm.  \nIt is a promise~  \n![](https://cdn.luogu.com.cn/upload/pic/45531.png)", "description": "You need to help Chtholly maintain a `01` sequence $a$ of length $n$. There are $m$ operations:  \n- `1 l r`: Set all numbers in interval $[l,r]$ to $0$.  \n- `2 l r`: Set all numbers in interval $[l,r]$ to $1$.  \n- `3 l r`: For all $a_i$ in $[l,r-1]$, change it to the bitwise OR of $a_i$ and $a_{i+1}$. These changes are performed simultaneously.  \n- `4 l r`: For all $a_i$ in $[l+1,r]$, change it to the bitwise OR of $a_i$ and $a_{i-1}$. These changes are performed simultaneously.  \n- `5 l r`: For all $a_i$ in $[l,r-1]$, change it to the bitwise AND of $a_i$ and $a_{i+1}$. These changes are performed simultaneously.  \n- `6 l r`: For all $a_i$ in $[l+1,r]$, change it to the bitwise AND of $a_i$ and $a_{i-1}$. These changes are performed simultaneously.  \n- `7 l r`: Query the sum over interval $[l,r]$.  \n\nThis problem is forced online. Each $l,r$ needs to be XORed with the previous answer using $\\operatorname{xor}$. If there has been no query before, then the previous answer is $0$.", "inputFormat": "The first line contains two integers $n$ and $m$.  \n\nThe second line contains $n$ integers representing the sequence $a$.  \n\nThen follow $m$ lines, each containing three integers $opt,l,r$, indicating which operation it is and the interval it applies to.", "outputFormat": "For each query operation, output one line with one number as the answer.", "hint": "Idea: nzhtl1477, Solution: nzhtl1477, Code: nzhtl1477, Data: nzhtl1477.\n\nThe sequence after each step:\n$$0\\ 1\\ 0\\ 0\\ 1$$\n$$0\\ 1\\ 0\\ 1\\ 1$$\n$$0\\ 0\\ 0\\ 1\\ 1$$\n$$0\\ 1\\ 0\\ 1\\ 1$$\n$$0\\ 0\\ 0\\ 0\\ 1$$\n$$0\\ 0\\ 0\\ 0\\ 1$$\n\nFor $30\\%$ of the testdata, $n,m\\leq 1000$.  \n\nFor $50\\%$ of the testdata, $n,m\\leq 10^5$.  \n\nFor another $30\\%$ of the testdata, both the operations and the sequence are generated randomly.  \n\nFor another $10\\%$ of the testdata, $n,m\\leq 10^6$.  \n\nConstraints: for $100\\%$ of the testdata, $1\\leq n,m\\leq 3 \\times 10^6$, $0\\leq a_i\\leq 1$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi Easy Round 2014] 人人本着正义之名", "background": "那是什么？  \n【不是第六兽，是新的兽？】  \n【我从来没见过那种玩意啊】  \n![](https://cdn.luogu.com.cn/upload/pic/45515.png)    \n【全员退避】  \n【现已确认出现预料之外的兽】  \n【根据这一事态，将作战确认为失败，放弃15号岛】  \n怎么会...  \n![](https://cdn.luogu.com.cn/upload/pic/45516.png)   \n我和他约好了的  \n绝对要活着回去  \n![](https://cdn.luogu.com.cn/upload/pic/45517.png)   \n对他说“我回来了”，然后品尝黄油蛋糕  \n所以，要是世界终结的话我会很伤脑筋的  \n![](https://cdn.luogu.com.cn/upload/pic/45518.png)   \n融没于晨雾之中的树林  \n啊...？  \n![](https://cdn.luogu.com.cn/upload/pic/45519.png)  \n【牛奶迹.耀眼花瓣.狂风气团】  \n【挂于墙上的鲱鱼.倒立的刺猬.袋中的风琴】  \n这是什么...？  \n![](https://cdn.luogu.com.cn/upload/pic/45520.png)  \n你其实...很想战斗的对吧  \n虽然我不知道你有什么打算，但是已经够了  \n![](https://cdn.luogu.com.cn/upload/pic/45521.png)  \n你已经不用战斗了  \n因为你的战斗，已经由我，由我们继承下来了  \n【其实我很感激你】  \n【一直以来，我心里就只想着死】  \n![](https://cdn.luogu.com.cn/upload/pic/45523.png)  \n【渴望去往那些等着我回去的家伙身边，这是我唯一的愿望】  \n【但是遇见你们之后，我有了一些改变】  \n【我又开始渴望获得一个容身之处了】  \n【遇见你之后，我得到了一些救赎】  \n【能够等到你平安归来，我现在...】  \n【嗯，可以说，感受到了一丝幸福】  \n啊...？   \n![](https://cdn.luogu.com.cn/upload/pic/45524.png)  \n【不...等一下，你别这么露骨地和我拉开距离啊】  \n【也别露出一副“这个不知廉耻的生物是怎样”的表情啊】   \n【不过话说回来，你观察我观察地很仔细啊】  \n哈哈...  \n因为喜欢上了嘛~   \n![](https://cdn.luogu.com.cn/upload/pic/45525.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45526.png)  \n【由不得我啊】  \n你要去的话我会生气的，我会大发雷霆的  \n【珂朵莉...】   \n![](https://cdn.luogu.com.cn/upload/pic/45527.png)  \n【对不起】\n![](https://cdn.luogu.com.cn/upload/pic/45528.png)  \n我等你  \n![](https://cdn.luogu.com.cn/upload/pic/45529.png)  \n我会等着你的，所以一定要回来哦   \n![](https://cdn.luogu.com.cn/upload/pic/45530.png)  \n【我保证，一定会回来的】  \n嗯  \n说好了哦~   \n![](https://cdn.luogu.com.cn/upload/pic/45531.png)   ", "description": "你需要帮珂朵莉维护一个长为 $n$ 的 `01`序列 $a$，有 $m$ 个操作：  \n- `1 l r`：把区间 $[l,r]$ 的数变成 $0$。\n- `2 l r`：把区间 $[l,r]$ 的数变成 $1$。\n- `3 l r`：$[l,r-1]$ 内所有数 $a_i$，变为 $a_i$ 与 $a_{i+1}$ 按位或的值，这些数同时进行这个操作。\n- `4 l r`：$[l+1,r]$ 内所有数 $a_i$，变为 $a_i$ 与 $a_{i-1}$ 按位或的值，这些数同时进行这个操作。\n- `5 l r`：$[l,r-1]$ 内所有数 $a_i$，变为 $a_i$ 与 $a_{i+1}$ 按位与的值，这些数同时进行这个操作。\n- `6 l r`：$[l+1,r]$ 内所有数 $a_i$，变为 $a_i$ 与 $a_{i-1}$ 按位与的值，这些数同时进行这个操作。\n- `7 l r`：查询区间 $[l,r]$ 的和。\n\n本题强制在线，每次的 $l,r$ 需要与上次答案做 $\\operatorname{xor}$ 运算，如果之前没有询问，则上次答案为 $0$。", "inputFormat": "第一行两个整数表示 $n$ 和 $m$。\n\n第二行 $n$ 个整数表示序列 $a$。\n\n之后 $m$ 行，每行三个整数 $opt,l,r$，表示是哪一种操作以及操作对应的区间。\n", "outputFormat": "对于每个查询操作输出一行一个数表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n序列每次的样子：\n$$0\\ 1\\ 0\\ 0\\ 1$$\n$$0\\ 1\\ 0\\ 1\\ 1$$\n$$0\\ 0\\ 0\\ 1\\ 1$$\n$$0\\ 1\\ 0\\ 1\\ 1$$\n$$0\\ 0\\ 0\\ 0\\ 1$$\n$$0\\ 0\\ 0\\ 0\\ 1$$\n\n对于 $30\\%$ 的数据，$n,m\\leq 1000$。\n\n对于 $50\\%$ 的数据，$n,m\\leq 10^5$。\n\n对于另外 $30\\%$ 的数据，操作和序列均随机生成。\n\n对于另外 $10\\%$ 的数据，$n,m\\leq 10^6$。\n\n对于 $100\\%$ 的数据，$1\\leq n,m\\leq 3 \\times 10^6$，$0\\leq a_i\\leq 1$。", "locale": "zh-CN"}}}
{"pid": "P5067", "type": "P", "difficulty": 7, "samples": [["5 12\n2*(3)\n2 1 1\n2 4 4\n2 1 5\n1 3 2\n2 1 5\n2 1 4\n2 1 3\n2 2 3\n1 1 (\n1 2 5\n1 3 +\n2 1 5", "2\n3\n6\n-1\n46\n4\n-1\n8"]], "limits": {"time": [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2014", "O2优化", "Ynoi"], "title": "[Ynoi Easy Round 2014] 长存不灭的过去、逐渐消逝的未来", "background": "![](https://cdn.luogu.com.cn/upload/pic/45532.png)  \n【她遵守了约定哦...】  \n【从不可能存活的战场上】  \n【一心想着要见到技官...想要向技官撒娇...】  \n【才保留下了一点点寿命...平安回来了哦...】  \n没错...她遵守了约定...  \n可我却什么都没能和她说  \n什么都没能为她做  \n什么都...  \n![](https://cdn.luogu.com.cn/upload/pic/45534.png)  \n......  \n珂朵莉......  \n![](https://cdn.luogu.com.cn/upload/pic/45535.png)  \n以前我碰上他人的悲剧或是不幸这种无可奈何的事情时  \n总是设法想去改变什么  \n但是我的力量一直过于渺小...  \n![](https://cdn.luogu.com.cn/upload/pic/45536.png)  \n到最后什么忙都没帮上...  \n我应该已经有深切体会了才对...  \n我想让珂朵莉幸福...  \n真受不了那个家伙...  \n像我这样的男人，到底有什么地方能让她看上啊...  \n![](https://cdn.luogu.com.cn/upload/pic/45537.png)  \n【你连这点事情都想不明白吗？】  \n【因为你...是让我见识了许许多的第一次的人...】  \n【在露天摊贩街上，是你第一次救了我】  \n【是你第一次带我去视野开阔的地方眺望风景】  \n【是你让我第一次产生了各种各样的感情】  \n【你是第一个让我依赖的人，也是第一个将我击败的对手】  \n![](https://cdn.luogu.com.cn/upload/pic/45538.png)  \n【啊...真要数起来根本数不完...】  \n【所以，我第一个喜欢上的人是你，是理所当然的事情】  \n![](https://cdn.luogu.com.cn/upload/pic/45539.png)  \n【这点小事你好歹得察觉到啊，笨~蛋】  \n【我...究竟是怎么了？】  \n【我记得我回到仓库，做了奇怪的梦】  \n![](https://cdn.luogu.com.cn/upload/pic/45540.png)    \n【你久久不回来...】  \n【你怎么了，露出这种表情？】  \n欢迎回来...珂朵莉  \n![](https://cdn.luogu.com.cn/upload/pic/45541.png)  \n欢迎回来...  \n![](https://cdn.luogu.com.cn/upload/pic/45542.png)  ", "description": "珂朵莉定义项为指若干个（$\\ge1$）数字（$0\\cdots 9$）相连得到的字符串（如 `123` `000` 是合法的项，`** *-1 +5` 是不合法的项）。一个合法的表达式可以为一个项（如 `233`）、两个表达式以 `+ -*` 相连（如`2*3+5*5` `6-6*6`）、一个表达式在左右添一对括号（如 (`2*3*3`)）。\n\n注意：空串不是一个合法的表达式。\n\n在一开始，你会得到一个长为 $n$ 的字符串，之后会给定 $m$ 个操作。 有两种操作：\n\n`1 x y` 表示将位置 $x$ 的字符改成 $y$。\n\n`2 l r` 表示询问 $[l,r]$ 的字符串作为表达式求值在 $\\bmod (10^9+7)$ 意义下的结果。若该串不是一个合法的表达式，结果为 $-1$。", "inputFormat": "第一行有两个整数 $n,m$。\n\n第二行有一个长为 $n$ 的字符串。\n\n接下来 $m$ 行，每行为 `1 x y` 或 `2 l r`，分别表示两种操作。\n", "outputFormat": "对所有 $2$ 的操作，输出一行，包含一个整数，表示答案。", "hint": "Idea：mcfx，Solution：mcfx，Code：mcfx，Data：mcfx\n\n$1\\leq n,m \\leq 10^5$，$1 \\leq l\\leq r\\leq n$，$1\\leq x\\leq n$。\n\n字符集为 `0 1 2 3 4 5 6 7 8 9 + - * ( )`\n\n若将 `(` 作为 $1$，`)` 作为 $-1$，其他字符作为 $0$，则保证在任意时刻，该串的任意前缀和的绝对值不超过 $50$。  ", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi Easy Round 2014] The Past That Lasts Forever, The Future That Gradually Fades Away", "background": "![](https://cdn.luogu.com.cn/upload/pic/45532.png)  \n【She kept the promise...】  \n【From a battlefield where no one could possibly survive】  \n【Only thinking of meeting the technician officer... wanting to act cute to the technician officer...】  \n【That was why she managed to preserve just a tiny bit of lifespan... and came back safely...】  \nThat’s right... she kept the promise...  \nBut I couldn’t say anything to her.  \nI couldn’t do anything for her.  \nNothing...  \n![](https://cdn.luogu.com.cn/upload/pic/45534.png)  \n......  \nChtholly......  \n![](https://cdn.luogu.com.cn/upload/pic/45535.png)  \nIn the past, whenever I ran into helpless things like other people’s tragedies or misfortunes,  \nI always tried to change something.  \nBut my power has always been far too small...  \n![](https://cdn.luogu.com.cn/upload/pic/45536.png)  \nIn the end, I couldn’t help at all...  \nI should have already understood that deeply...  \nI want Chtholly to be happy...  \nI really can’t stand that guy...  \nA man like me, what on earth is there that she could fall for...  \n![](https://cdn.luogu.com.cn/upload/pic/45537.png)  \n【You can’t even figure out something this simple?】  \n【Because you... are the person who let me experience so, so many firsts...】  \n【On the open-air street stalls, you saved me for the first time】  \n【You were the first to take me to a place with a wide view to look at the scenery】  \n【You made me feel all kinds of emotions for the first time】  \n【You were the first person I relied on, and also the first opponent who defeated me】  \n![](https://cdn.luogu.com.cn/upload/pic/45538.png)  \n【Ah... if I really start counting, I can’t even finish counting...】  \n【So, it’s only natural that the first person I fell in love with was you】  \n![](https://cdn.luogu.com.cn/upload/pic/45539.png)  \n【At least you should have noticed something this small, you i-di-ot】  \n【I... what is wrong with me?】  \n【I remember I went back to the warehouse, and had a strange dream】  \n![](https://cdn.luogu.com.cn/upload/pic/45540.png)  \n【You didn’t come back for a long time...】  \n【What’s wrong, why are you making that face?】  \nWelcome back... Chtholly.  \n![](https://cdn.luogu.com.cn/upload/pic/45541.png)  \nWelcome back...  \n![](https://cdn.luogu.com.cn/upload/pic/45542.png)", "description": "Chtholly defines a *term* as a string formed by concatenating several ($\\ge 1$) digits ($0\\cdots 9$) (for example, `123` and `000` are valid terms, while `** *-1 +5` are invalid terms). A valid expression can be:\n\n- A term (e.g. `233`).\n- Two expressions connected by `+ - *` (e.g. `2*3+5*5`, `6-6*6`).\n- An expression with a pair of parentheses added to its left and right (e.g. (`2*3*3`)).\n\nNote: the empty string is not a valid expression.\n\nInitially, you are given a string of length $n$. Then $m$ operations are given. There are two types of operations:\n\n- `1 x y`: change the character at position $x$ to $y$.\n- `2 l r`: query the value of the substring $[l, r]$ as an expression modulo $\\bmod (10^9+7)$. If the substring is not a valid expression, the result is $-1$.", "inputFormat": "The first line contains two integers $n, m$.\n\nThe second line contains a string of length $n$.\n\nThe next $m$ lines each contain `1 x y` or `2 l r`, representing the two types of operations.", "outputFormat": "For every operation of type `2`, output one line containing one integer, which is the answer.", "hint": "Idea: mcfx, Solution: mcfx, Code: mcfx, Data: mcfx.\n\nConstraints: $1\\leq n, m \\leq 10^5$, $1 \\leq l \\leq r \\leq n$, $1 \\leq x \\leq n$.\n\nThe character set is `0 1 2 3 4 5 6 7 8 9 + - * ( )`.\n\nIf we treat `(` as $1$, `)` as $-1$, and other characters as $0$, then it is guaranteed that at any moment, for any prefix of the string, the absolute value of the prefix sum is at most $50$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi Easy Round 2014] 长存不灭的过去、逐渐消逝的未来", "background": "![](https://cdn.luogu.com.cn/upload/pic/45532.png)  \n【她遵守了约定哦...】  \n【从不可能存活的战场上】  \n【一心想着要见到技官...想要向技官撒娇...】  \n【才保留下了一点点寿命...平安回来了哦...】  \n没错...她遵守了约定...  \n可我却什么都没能和她说  \n什么都没能为她做  \n什么都...  \n![](https://cdn.luogu.com.cn/upload/pic/45534.png)  \n......  \n珂朵莉......  \n![](https://cdn.luogu.com.cn/upload/pic/45535.png)  \n以前我碰上他人的悲剧或是不幸这种无可奈何的事情时  \n总是设法想去改变什么  \n但是我的力量一直过于渺小...  \n![](https://cdn.luogu.com.cn/upload/pic/45536.png)  \n到最后什么忙都没帮上...  \n我应该已经有深切体会了才对...  \n我想让珂朵莉幸福...  \n真受不了那个家伙...  \n像我这样的男人，到底有什么地方能让她看上啊...  \n![](https://cdn.luogu.com.cn/upload/pic/45537.png)  \n【你连这点事情都想不明白吗？】  \n【因为你...是让我见识了许许多的第一次的人...】  \n【在露天摊贩街上，是你第一次救了我】  \n【是你第一次带我去视野开阔的地方眺望风景】  \n【是你让我第一次产生了各种各样的感情】  \n【你是第一个让我依赖的人，也是第一个将我击败的对手】  \n![](https://cdn.luogu.com.cn/upload/pic/45538.png)  \n【啊...真要数起来根本数不完...】  \n【所以，我第一个喜欢上的人是你，是理所当然的事情】  \n![](https://cdn.luogu.com.cn/upload/pic/45539.png)  \n【这点小事你好歹得察觉到啊，笨~蛋】  \n【我...究竟是怎么了？】  \n【我记得我回到仓库，做了奇怪的梦】  \n![](https://cdn.luogu.com.cn/upload/pic/45540.png)    \n【你久久不回来...】  \n【你怎么了，露出这种表情？】  \n欢迎回来...珂朵莉  \n![](https://cdn.luogu.com.cn/upload/pic/45541.png)  \n欢迎回来...  \n![](https://cdn.luogu.com.cn/upload/pic/45542.png)  ", "description": "珂朵莉定义项为指若干个（$\\ge1$）数字（$0\\cdots 9$）相连得到的字符串（如 `123` `000` 是合法的项，`** *-1 +5` 是不合法的项）。一个合法的表达式可以为一个项（如 `233`）、两个表达式以 `+ -*` 相连（如`2*3+5*5` `6-6*6`）、一个表达式在左右添一对括号（如 (`2*3*3`)）。\n\n注意：空串不是一个合法的表达式。\n\n在一开始，你会得到一个长为 $n$ 的字符串，之后会给定 $m$ 个操作。 有两种操作：\n\n`1 x y` 表示将位置 $x$ 的字符改成 $y$。\n\n`2 l r` 表示询问 $[l,r]$ 的字符串作为表达式求值在 $\\bmod (10^9+7)$ 意义下的结果。若该串不是一个合法的表达式，结果为 $-1$。", "inputFormat": "第一行有两个整数 $n,m$。\n\n第二行有一个长为 $n$ 的字符串。\n\n接下来 $m$ 行，每行为 `1 x y` 或 `2 l r`，分别表示两种操作。\n", "outputFormat": "对所有 $2$ 的操作，输出一行，包含一个整数，表示答案。", "hint": "Idea：mcfx，Solution：mcfx，Code：mcfx，Data：mcfx\n\n$1\\leq n,m \\leq 10^5$，$1 \\leq l\\leq r\\leq n$，$1\\leq x\\leq n$。\n\n字符集为 `0 1 2 3 4 5 6 7 8 9 + - * ( )`\n\n若将 `(` 作为 $1$，`)` 作为 $-1$，其他字符作为 $0$，则保证在任意时刻，该串的任意前缀和的绝对值不超过 $50$。  ", "locale": "zh-CN"}}}
{"pid": "P5068", "type": "P", "difficulty": 6, "samples": [["10 10\n2 7 9\n1 6\n2 7 10\n1 10\n1 7\n2 7 10\n1 7\n1 1\n2 6 7\n1 4", "3\n8\n11\n6"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144, 262144]}, "tags": ["2015", "O2优化", "Ynoi"], "title": "[Ynoi Easy Round 2015] 我回来了", "background": "我遵守了...  \n约...约定  \n![](https://cdn.luogu.com.cn/upload/pic/45543.png)  \n【你非常努力啊】  \n我非常非常努力哦...  \n![](https://cdn.luogu.com.cn/upload/pic/45545.png)  \n【虽然昨天也说过这句话了...】   \n【欢迎回来，珂朵莉】  \n![](https://cdn.luogu.com.cn/upload/pic/45546.png)  \n我回来了...  \n终于说出口了...  \n【是啊，我终于听见了】  \n红色的头发，会不会奇怪？  \n【很漂亮的颜色，和你很搭哦】   \n是吗...  \n我...我已经没事了  \n【真的吗？身体状况没问题吗？】   \n【要是硬撑的话，我可不会饶过你啊】  \n没事的，做饭啊洗衣服啊，还留着很多活要干呢   \n【可别太拼了哦】  \n![](https://cdn.luogu.com.cn/upload/pic/45547.png)  \n哼，你就做好心理准备等着吧  \n![](https://cdn.luogu.com.cn/upload/pic/45548.png)  ", "description": "珂朵莉在玩炉石传说的时候总是打不出教科书般的亵渎，于是他重新写了一个炉石传说’，并且将亵渎的描述改为：“等概率随机在 $[L,R]$ 中选出一个整数作为伤害值 $d$，对所有随从造成 $d$ 点伤害，如果有随从死亡，则再次施放该法术，但伤害值不重新随机；如果没有随从死亡，则停止释放”，还去掉了场面上随从上限和亵渎最多触发14次的限制。\n\n珂朵莉不知道这个改版亵渎的效果怎么样，于是他打算进行一些测试，其中共进行 $m$ 次如下类型的操作：\n\n1. 在场面上加入一个血量为 $h$ 的随从，这里随从的血量都不能超过 $n$；\n2. 给定 $L, R$，询问亵渎期望触发多少次；\n\n珂朵莉只会做操作1，于是他就把操作2交给你啦。", "inputFormat": "第一行两个由空格分隔的整数 $n\\;m$；\n\n接下来 $m$ 行，每行表示一次操作，操作1表示为 $1\\;h$，操作2表示为 $2\\;L\\;R$；\n", "outputFormat": "为避免输出小数，对每次操作2，输出一个整数表示期望值与 $(R-L+1)$ 的乘积。", "hint": "Idea：oscar，Solution：ccz181078，Code：ccz181078，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，保证：\n$1\\le n\\le 10^5$，每次1操作有 $1\\le h\\le n$，每次2操作有 $1\\le L\\le R\\le n$；\n$1\\le m\\le 10^6$；\n以上所有数值均为整数。", "locale": "zh-CN", "translations": {"zh-CN": {"title": "[Ynoi Easy Round 2015] 我回来了", "background": "我遵守了...  \n约...约定  \n![](https://cdn.luogu.com.cn/upload/pic/45543.png)  \n【你非常努力啊】  \n我非常非常努力哦...  \n![](https://cdn.luogu.com.cn/upload/pic/45545.png)  \n【虽然昨天也说过这句话了...】   \n【欢迎回来，珂朵莉】  \n![](https://cdn.luogu.com.cn/upload/pic/45546.png)  \n我回来了...  \n终于说出口了...  \n【是啊，我终于听见了】  \n红色的头发，会不会奇怪？  \n【很漂亮的颜色，和你很搭哦】   \n是吗...  \n我...我已经没事了  \n【真的吗？身体状况没问题吗？】   \n【要是硬撑的话，我可不会饶过你啊】  \n没事的，做饭啊洗衣服啊，还留着很多活要干呢   \n【可别太拼了哦】  \n![](https://cdn.luogu.com.cn/upload/pic/45547.png)  \n哼，你就做好心理准备等着吧  \n![](https://cdn.luogu.com.cn/upload/pic/45548.png)  ", "description": "珂朵莉在玩炉石传说的时候总是打不出教科书般的亵渎，于是他重新写了一个炉石传说’，并且将亵渎的描述改为：“等概率随机在 $[L,R]$ 中选出一个整数作为伤害值 $d$，对所有随从造成 $d$ 点伤害，如果有随从死亡，则再次施放该法术，但伤害值不重新随机；如果没有随从死亡，则停止释放”，还去掉了场面上随从上限和亵渎最多触发14次的限制。\n\n珂朵莉不知道这个改版亵渎的效果怎么样，于是他打算进行一些测试，其中共进行 $m$ 次如下类型的操作：\n\n1. 在场面上加入一个血量为 $h$ 的随从，这里随从的血量都不能超过 $n$；\n2. 给定 $L, R$，询问亵渎期望触发多少次；\n\n珂朵莉只会做操作1，于是他就把操作2交给你啦。", "inputFormat": "第一行两个由空格分隔的整数 $n\\;m$；\n\n接下来 $m$ 行，每行表示一次操作，操作1表示为 $1\\;h$，操作2表示为 $2\\;L\\;R$；\n", "outputFormat": "为避免输出小数，对每次操作2，输出一个整数表示期望值与 $(R-L+1)$ 的乘积。", "hint": "Idea：oscar，Solution：ccz181078，Code：ccz181078，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，保证：\n$1\\le n\\le 10^5$，每次1操作有 $1\\le h\\le n$，每次2操作有 $1\\le L\\le R\\le n$；\n$1\\le m\\le 10^6$；\n以上所有数值均为整数。", "locale": "zh-CN"}}}
{"pid": "P5069", "type": "P", "difficulty": 6, "samples": [["4\n3\n6\n6\n4\n3\n4 4\n3 5\n1 8", "10\n10\n13"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["2015", "线段树", "O2优化", "Ynoi", "STL"], "title": "[Ynoi Easy Round 2015] 纵使日薄西山", "background": "【你好像很开心嘛】  \n因为很少有机会和你单独出来走动嘛  \n应该说，好像以前一直没有吧？   \n【我们第一次见面的时候，不就一起逛过很多地方吗？】 \n![](https://cdn.luogu.com.cn/upload/pic/45549.png)  \n诶？啊...对  \n但是那个...总觉得和现在的感觉不太一样嘛  \n好吧，快点走吧！   \n【珂朵莉...】   \n![](https://cdn.luogu.com.cn/upload/pic/45550.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45551.png)  \n真是的，别发出那种像是快哭的声音啦，你是大人吧  \n我没事，你看  \n诶...  \n啊，这...这孩子也没事  \n![](https://cdn.luogu.com.cn/upload/pic/45552.png)  \n【要是出现什么意外，我...】  \n【我还以为自己又会在这么近的地方失去你...】   \n![](https://cdn.luogu.com.cn/upload/pic/45553.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45554.png)  \n红色头发的少女  \n在  \n看着这里  ", "description": "珂朵莉想让你维护一个长度为 $n$ 的正整数序列 $a_1,a_2,\\ldots,a_n$，支持修改序列中某个位置的值。\n\n每次修改后问对序列重复进行以下操作，需要进行几次操作才能使序列变为全 $0$（询问后序列和询问前相同，不会变为全 $0$）：\n\n选出序列中最大值的出现位置，若有多个最大值则选位置标号最小的一个，设位置为 $x$，则将 $a_{x-1},a_x,a_{x+1}$ 的值减 $1$，如果序列中存在小于 $0$ 的数，则把对应的数改为 $0$。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行一个整数 $a_i$。\n\n接下来一行一个整数 $q$。\n\n接下来 $q$ 行，每行两个用空格分隔的整数 $x_i,y_i$，表示把 $a_{x_i}$ 修改为 $y_i$。  \n", "outputFormat": "$q$ 行，每行一个整数表示答案。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n$1\\leq n,q\\leq 10^5$，$1\\leq x_i\\leq n$，$1\\leq a_i,y_i\\leq 10^9$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi Easy Round 2015] Even as the Sun Sets in the West", "background": "【You seem very happy.】  \nBecause I rarely get a chance to go out alone with you.  \nOr rather, it seems like we never really had before, right?  \n【Didn’t we go to lots of places together when we first met?】  \n![](https://cdn.luogu.com.cn/upload/pic/45549.png)  \nHuh? Ah... right.  \nBut, well... it just feels kind of different from now.  \nAlright, hurry up, let’s go!  \n【Chtholly...】  \n![](https://cdn.luogu.com.cn/upload/pic/45550.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45551.png)  \nSeriously, don’t make a sound like you’re about to cry. You’re an adult, aren’t you?  \nI’m fine, look.  \nEh...  \nAh, th-this kid is also fine.  \n![](https://cdn.luogu.com.cn/upload/pic/45552.png)  \n【If anything unexpected happens, I...】  \n【I thought I would lose you again, this close...】  \n![](https://cdn.luogu.com.cn/upload/pic/45553.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45554.png)  \nA red-haired girl.  \nIs  \nWatching here.", "description": "Chtholly wants you to maintain a positive integer sequence of length $n$, $a_1,a_2,\\ldots,a_n$, supporting updates that modify the value at some position.\n\nAfter each update, you are asked: if we repeatedly perform the following operation on the sequence, how many operations are needed to make the sequence become all $0$ (after the query, the sequence is the same as before the query; it will not actually become all $0$)?\n\nChoose a position where the maximum value in the sequence occurs. If there are multiple maximum values, choose the one with the smallest index. Let the position be $x$. Then decrease $a_{x-1},a_x,a_{x+1}$ by $1$. If there exists a number less than $0$ in the sequence, change that number to $0$.", "inputFormat": "The first line contains an integer $n$.\n\nThe next $n$ lines each contain one integer $a_i$.\n\nThe next line contains an integer $q$.\n\nThe next $q$ lines each contain two integers $x_i,y_i$ separated by a space, meaning to modify $a_{x_i}$ to $y_i$.", "outputFormat": "Output $q$ lines, each containing one integer representing the answer.", "hint": "Idea: ccz181078, Solution: ccz181078, Code: ccz181078, Data: ccz181078\n\nConstraints: $1\\leq n,q\\leq 10^5$, $1\\leq x_i\\leq n$, $1\\leq a_i,y_i\\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi Easy Round 2015] 纵使日薄西山", "background": "【你好像很开心嘛】  \n因为很少有机会和你单独出来走动嘛  \n应该说，好像以前一直没有吧？   \n【我们第一次见面的时候，不就一起逛过很多地方吗？】 \n![](https://cdn.luogu.com.cn/upload/pic/45549.png)  \n诶？啊...对  \n但是那个...总觉得和现在的感觉不太一样嘛  \n好吧，快点走吧！   \n【珂朵莉...】   \n![](https://cdn.luogu.com.cn/upload/pic/45550.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45551.png)  \n真是的，别发出那种像是快哭的声音啦，你是大人吧  \n我没事，你看  \n诶...  \n啊，这...这孩子也没事  \n![](https://cdn.luogu.com.cn/upload/pic/45552.png)  \n【要是出现什么意外，我...】  \n【我还以为自己又会在这么近的地方失去你...】   \n![](https://cdn.luogu.com.cn/upload/pic/45553.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45554.png)  \n红色头发的少女  \n在  \n看着这里  ", "description": "珂朵莉想让你维护一个长度为 $n$ 的正整数序列 $a_1,a_2,\\ldots,a_n$，支持修改序列中某个位置的值。\n\n每次修改后问对序列重复进行以下操作，需要进行几次操作才能使序列变为全 $0$（询问后序列和询问前相同，不会变为全 $0$）：\n\n选出序列中最大值的出现位置，若有多个最大值则选位置标号最小的一个，设位置为 $x$，则将 $a_{x-1},a_x,a_{x+1}$ 的值减 $1$，如果序列中存在小于 $0$ 的数，则把对应的数改为 $0$。", "inputFormat": "第一行一个整数 $n$。\n\n接下来 $n$ 行，每行一个整数 $a_i$。\n\n接下来一行一个整数 $q$。\n\n接下来 $q$ 行，每行两个用空格分隔的整数 $x_i,y_i$，表示把 $a_{x_i}$ 修改为 $y_i$。  \n", "outputFormat": "$q$ 行，每行一个整数表示答案。", "hint": "Idea：ccz181078，Solution：ccz181078，Code：ccz181078，Data：ccz181078\n\n$1\\leq n,q\\leq 10^5$，$1\\leq x_i\\leq n$，$1\\leq a_i,y_i\\leq 10^9$。", "locale": "zh-CN"}}}
{"pid": "P5070", "type": "P", "difficulty": 6, "samples": [["8 9\n2 3 3 3 3 6 6 6\n1 8\n2 3\n4 5\n6 8\n1 2\n3 4\n5 6\n3 8\n5 5", "1100000000\n1000000000\n1000000000\n1000000000\n0100000000\n1000000000\n2000000000\n2000000000\n1000000000"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "O2优化", "Ynoi"], "title": "[Ynoi Easy Round 2015] 即便看不到未来", "background": "![](https://cdn.luogu.com.cn/upload/pic/45556.png)  \n我不会再闷闷不乐了  \n那撕裂胸口的悲伤  \n还有快流下来的眼泪  \n全都是塑造出现在的我的东西  \n![](https://cdn.luogu.com.cn/upload/pic/45557.png)  \n烦恼  \n灰心  \n痛苦  \n喜悦  \n全部不可或缺  \n现在站在这里的不是别人  \n![](https://cdn.luogu.com.cn/upload/pic/45558.png)  \n毫无疑问是我自己，是珂朵莉   \n对，至少现在如此  \n![](https://cdn.luogu.com.cn/upload/pic/45559.png)  \n记忆慢慢地缺失  \n人格在逐渐崩坏   \n抱歉  \n你们当中   \n已经有一半的人我不记得了...   \n忘记的名字还可以重新记住  \n但是失去的记忆却无可挽回   \n这个将要崩坏的自己，还能被称作珂朵莉吗...？  \n![](https://cdn.luogu.com.cn/upload/pic/45560.png)  \n可即便这样的感情，我也想要毫无保留地去珍惜   \n因为如果连这种感情都失去的时候  \n我大概就会...彻底消失吧   ", "description": "珂朵莉给了你一个序列，每次查询一段区间中长度为 $1,2,\\ldots,10$ 的极长值域连续段个数。\n定义值域连续段为：\n\n* 把区间里面所有数排序后去重，设排序后得到的序列为 $b$。\n* 如果对于二元组 $(l,r)$ 满足 $b_l,b_{l+1},\\ldots,b_r$ 中每个数为前一个数 $+1$。\n* 而且对于二元组 $(l,r+1)$，$(l-1,r)$ 均不满足，我们称 $(l,r)$ 为一个长度为 $r-l+1$ 的极长值域连续段。", "inputFormat": "第一行两个整数 $n,m$，表示序列的长度和查询的次数。\n\n之后一行 $n$ 个整数表示这个序列。\n\n之后 $m$ 行每行两个整数 $l,r$ 表示查询的区间。\n", "outputFormat": "对于每次询问，输出一个长度为 $10$ 的字符串，第 $i$ 个字符表示长度为 $i$ 的极长连续段个数 $\\bmod 10$的结果。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：mcfx，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\leq n,m,a_i\\leq10^6$，$1\\leq l\\leq r\\leq n$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi Easy Round 2015] Even If I Cannot See the Future", "background": "![](https://cdn.luogu.com.cn/upload/pic/45556.png)  \nI will not be depressed anymore.  \nThat sadness that tears open my chest,  \nand the tears that are about to fall,  \nare all things that shaped who I am now.  \n![](https://cdn.luogu.com.cn/upload/pic/45557.png)  \nWorries,  \ndiscouragement,  \npain,  \njoy,  \nnone of them can be missing.  \nThe one standing here now is not someone else.  \n![](https://cdn.luogu.com.cn/upload/pic/45558.png)  \nWithout a doubt, it is me myself, it is Ke Duoli (pinyin: Kē Duō Lí).  \nYes, at least for now.  \n![](https://cdn.luogu.com.cn/upload/pic/45559.png)  \nMy memories are slowly disappearing,  \nand my personality is gradually falling apart.  \nSorry.  \nAmong you,  \nthere are already half of you that I cannot remember...  \nForgotten names can be remembered again,  \nbut lost memories can never be recovered.  \nCan this self that is about to collapse still be called Ke Duoli...?  \n![](https://cdn.luogu.com.cn/upload/pic/45560.png)  \nBut even with feelings like this, I still want to cherish them without holding anything back.  \nBecause if I lose even this kind of feeling,  \nI will probably... disappear completely.", "description": "Ke Duoli gives you a sequence. For each query, you need to count, in a given interval, the number of maximal consecutive value-range segments of lengths $1,2,\\ldots,10$.\n\nA consecutive value-range segment is defined as follows:\n\n* Sort all numbers in the interval and remove duplicates. Let the resulting sequence be $b$.\n* For a pair $(l,r)$, if every number in $b_l,b_{l+1},\\ldots,b_r$ is equal to the previous number $+1$.\n* And for the pairs $(l,r+1)$ and $(l-1,r)$, neither satisfies the condition above, then we call $(l,r)$ a maximal consecutive value-range segment, with length $r-l+1$.", "inputFormat": "The first line contains two integers $n,m$, representing the length of the sequence and the number of queries.\n\nThe next line contains $n$ integers representing the sequence.\n\nThen follow $m$ lines, each containing two integers $l,r$, representing the query interval.", "outputFormat": "For each query, output a string of length $10$. The $i$-th character represents the number of maximal consecutive segments of length $i$ modulo $10$.", "hint": "Idea: nzhtl1477, Solution: nzhtl1477, Code: mcfx, Data: nzhtl1477.\n\nFor $100\\%$ of the testdata, $1\\leq n,m,a_i\\leq10^6$, $1\\leq l\\leq r\\leq n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi Easy Round 2015] 即便看不到未来", "background": "![](https://cdn.luogu.com.cn/upload/pic/45556.png)  \n我不会再闷闷不乐了  \n那撕裂胸口的悲伤  \n还有快流下来的眼泪  \n全都是塑造出现在的我的东西  \n![](https://cdn.luogu.com.cn/upload/pic/45557.png)  \n烦恼  \n灰心  \n痛苦  \n喜悦  \n全部不可或缺  \n现在站在这里的不是别人  \n![](https://cdn.luogu.com.cn/upload/pic/45558.png)  \n毫无疑问是我自己，是珂朵莉   \n对，至少现在如此  \n![](https://cdn.luogu.com.cn/upload/pic/45559.png)  \n记忆慢慢地缺失  \n人格在逐渐崩坏   \n抱歉  \n你们当中   \n已经有一半的人我不记得了...   \n忘记的名字还可以重新记住  \n但是失去的记忆却无可挽回   \n这个将要崩坏的自己，还能被称作珂朵莉吗...？  \n![](https://cdn.luogu.com.cn/upload/pic/45560.png)  \n可即便这样的感情，我也想要毫无保留地去珍惜   \n因为如果连这种感情都失去的时候  \n我大概就会...彻底消失吧   ", "description": "珂朵莉给了你一个序列，每次查询一段区间中长度为 $1,2,\\ldots,10$ 的极长值域连续段个数。\n定义值域连续段为：\n\n* 把区间里面所有数排序后去重，设排序后得到的序列为 $b$。\n* 如果对于二元组 $(l,r)$ 满足 $b_l,b_{l+1},\\ldots,b_r$ 中每个数为前一个数 $+1$。\n* 而且对于二元组 $(l,r+1)$，$(l-1,r)$ 均不满足，我们称 $(l,r)$ 为一个长度为 $r-l+1$ 的极长值域连续段。", "inputFormat": "第一行两个整数 $n,m$，表示序列的长度和查询的次数。\n\n之后一行 $n$ 个整数表示这个序列。\n\n之后 $m$ 行每行两个整数 $l,r$ 表示查询的区间。\n", "outputFormat": "对于每次询问，输出一个长度为 $10$ 的字符串，第 $i$ 个字符表示长度为 $i$ 的极长连续段个数 $\\bmod 10$的结果。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：mcfx，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\leq n,m,a_i\\leq10^6$，$1\\leq l\\leq r\\leq n$。", "locale": "zh-CN"}}}
{"pid": "P5071", "type": "P", "difficulty": 6, "samples": [["5 5\n64 2 18 9 100\n1 5\n2 4\n2 3\n1 4\n3 4", "165\n15\n9\n45\n10"]], "limits": {"time": [2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500, 2500], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": ["2015", "莫队", "O2优化", "素数判断,质数,筛法", "Ynoi"], "title": "[Ynoi Easy Round 2015] 此时此刻的光辉", "background": "难道说...  \n这么说来...给珂朵莉她们...  \n正给珂朵莉带来痛苦的是...  \n![](https://cdn.luogu.com.cn/upload/pic/45561.png)  \n【威廉？】  \n【威廉，说真的，你到底怎么了？】  \n【出什么事了？】  \n【啊...】 \n![](https://cdn.luogu.com.cn/upload/pic/45562.png)   \n你不慌张吗  \n【别看我这样，其实我心脏确实有在猛跳】  \n【但是呢，虽然我不知道发生了什么事】  \n![](https://cdn.luogu.com.cn/upload/pic/45563.png)  \n【可一直爱逞强的你，难得会对我露出软弱的一面嘛~】   \n【高兴的心情，还有希望你打起精神的心情加在一起】  \n【要远远胜过惊慌的情绪】  \n![](https://cdn.luogu.com.cn/upload/pic/45564.png)  \n你...  \n【你刚才，流露着一副要是没人管你就会自己消失的表情哦？】  \n【虽然非常难为情，但我实在不能撇下你】  \n![](https://cdn.luogu.com.cn/upload/pic/45565.png)  \n你是个...好女人啊...  \n![](https://cdn.luogu.com.cn/upload/pic/45567.png)  \n【抱歉，我没有听清楚，再说一遍】  \n没什么啦...  \n![](https://cdn.luogu.com.cn/upload/pic/45568.png)  \n【啊...你还死撑】  \n【再说一遍，再说一遍就好】  \n和我结婚吧  \n![](https://cdn.luogu.com.cn/upload/pic/45569.png)  \n【不对...嗯？】  \n我终于找到了  \n找到了渴望去保护的人  \n找到了渴望回去的归宿  \n觉得自己还可以继续生存下去  \n总算真切地认识到自己还有继续生存的价值和资格  \n所以...  \n我要给你幸福  \n![](https://cdn.luogu.com.cn/upload/pic/45570.png)  \n【嗯】  \n【我也不会离开你身边的】  \n【永远，永远和你在一起哦】   ", "description": "珂朵莉给你了一个长为 $n$ 的序列，有 $m$ 次查询，每次查询一段区间的乘积的约数个数 $\\bmod 19260817$ 的值。", "inputFormat": "第一行两个整数 $n,m$。  \n\n第二行 $n$ 个整数表示这个序列 $a_i$。\n\n之后 $m$ 行，每行两个整数 $l,r$ 表示查询的区间  \n", "outputFormat": "$m$ 行，每行输出一个整数表示答案", "hint": "Idea：will7101，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n$1\\leq n,m\\leq 10^5$，$1 \\leq a_i \\leq10^9$。\n", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi Easy Round 2015] The Glory of This Moment", "background": "Could it be...  \nSo that means... for Chtholly and the others...  \nWhat is bringing Chtholly pain is...  \n![](https://cdn.luogu.com.cn/upload/pic/45561.png)  \n【William?】  \n【William, seriously, what happened to you?】  \n【What’s wrong?】  \n【Ah...】  \n![](https://cdn.luogu.com.cn/upload/pic/45562.png)  \nAren’t you panicking?  \n【Don’t be fooled by how I look, my heart is indeed pounding】  \n【But, even though I don’t know what happened】  \n![](https://cdn.luogu.com.cn/upload/pic/45563.png)  \n【You, who always like to act tough, are finally showing me a weak side for once~】  \n【The happiness, and the feeling of wanting you to cheer up, added together】  \n【Far outweigh the feeling of panic】  \n![](https://cdn.luogu.com.cn/upload/pic/45564.png)  \nYou...  \n【Just now, you had this look like you’d disappear by yourself if nobody cared about you, you know?】  \n【Although it’s very embarrassing, I really can’t just leave you alone】  \n![](https://cdn.luogu.com.cn/upload/pic/45565.png)  \nYou are... a good woman...  \n![](https://cdn.luogu.com.cn/upload/pic/45567.png)  \n【Sorry, I didn’t hear clearly. Say that again.】  \nIt’s nothing...  \n![](https://cdn.luogu.com.cn/upload/pic/45568.png)  \n【Ah... you’re still forcing yourself】  \n【Say it again. Just say it again.】  \nMarry me.  \n![](https://cdn.luogu.com.cn/upload/pic/45569.png)  \n【No... huh?】  \nI finally found it.  \nI found someone I long to protect.  \nI found a home I long to return to.  \nI feel like I can keep living.  \nAt last, I truly realized that I still have the value and the right to keep living.  \nSo...  \nI will give you happiness.  \n![](https://cdn.luogu.com.cn/upload/pic/45570.png)  \n【Mm.】  \n【I won’t leave your side either.】  \n【Forever, forever, I’ll be with you.】", "description": "Chtholly gives you a sequence of length $n$. There are $m$ queries. For each query, you need to compute the number of divisors of the product of a subarray, taken $\\bmod 19260817$.", "inputFormat": "The first line contains two integers $n, m$.  \n\nThe second line contains $n$ integers, representing the sequence $a_i$.  \n\nThen follow $m$ lines, each containing two integers $l, r$, representing the queried interval.", "outputFormat": "Output $m$ lines. Each line contains one integer, the answer to the corresponding query.", "hint": "Idea: will7101, Solution: nzhtl1477, Code: nzhtl1477, Data: nzhtl1477.  \n\nConstraints: $1 \\leq n, m \\leq 10^5$, $1 \\leq a_i \\leq 10^9$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi Easy Round 2015] 此时此刻的光辉", "background": "难道说...  \n这么说来...给珂朵莉她们...  \n正给珂朵莉带来痛苦的是...  \n![](https://cdn.luogu.com.cn/upload/pic/45561.png)  \n【威廉？】  \n【威廉，说真的，你到底怎么了？】  \n【出什么事了？】  \n【啊...】 \n![](https://cdn.luogu.com.cn/upload/pic/45562.png)   \n你不慌张吗  \n【别看我这样，其实我心脏确实有在猛跳】  \n【但是呢，虽然我不知道发生了什么事】  \n![](https://cdn.luogu.com.cn/upload/pic/45563.png)  \n【可一直爱逞强的你，难得会对我露出软弱的一面嘛~】   \n【高兴的心情，还有希望你打起精神的心情加在一起】  \n【要远远胜过惊慌的情绪】  \n![](https://cdn.luogu.com.cn/upload/pic/45564.png)  \n你...  \n【你刚才，流露着一副要是没人管你就会自己消失的表情哦？】  \n【虽然非常难为情，但我实在不能撇下你】  \n![](https://cdn.luogu.com.cn/upload/pic/45565.png)  \n你是个...好女人啊...  \n![](https://cdn.luogu.com.cn/upload/pic/45567.png)  \n【抱歉，我没有听清楚，再说一遍】  \n没什么啦...  \n![](https://cdn.luogu.com.cn/upload/pic/45568.png)  \n【啊...你还死撑】  \n【再说一遍，再说一遍就好】  \n和我结婚吧  \n![](https://cdn.luogu.com.cn/upload/pic/45569.png)  \n【不对...嗯？】  \n我终于找到了  \n找到了渴望去保护的人  \n找到了渴望回去的归宿  \n觉得自己还可以继续生存下去  \n总算真切地认识到自己还有继续生存的价值和资格  \n所以...  \n我要给你幸福  \n![](https://cdn.luogu.com.cn/upload/pic/45570.png)  \n【嗯】  \n【我也不会离开你身边的】  \n【永远，永远和你在一起哦】   ", "description": "珂朵莉给你了一个长为 $n$ 的序列，有 $m$ 次查询，每次查询一段区间的乘积的约数个数 $\\bmod 19260817$ 的值。", "inputFormat": "第一行两个整数 $n,m$。  \n\n第二行 $n$ 个整数表示这个序列 $a_i$。\n\n之后 $m$ 行，每行两个整数 $l,r$ 表示查询的区间  \n", "outputFormat": "$m$ 行，每行输出一个整数表示答案", "hint": "Idea：will7101，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n$1\\leq n,m\\leq 10^5$，$1 \\leq a_i \\leq10^9$。\n", "locale": "zh-CN"}}}
{"pid": "P5072", "type": "P", "difficulty": 6, "samples": [["5 5\n1 2 2 3 4\n1 2 233333\n2 3 333333\n1 5 5\n3 5 15\n2 4 8", "6\n6\n1\n6\n0"]], "limits": {"time": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000], "memory": [524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["2015", "莫队", "O2优化", "分块", "Ynoi", "链表"], "title": "[Ynoi Easy Round 2015] 盼君勿忘", "background": "说起来，幸福本身就是因人而异的  \n有些人认为只要能混口饭吃就行了  \n有些人只要有书读就能满足  \n![](https://cdn.luogu.com.cn/upload/pic/45571.png)  \n有些人认为只有全力地生存才是最重要的  \n有些人只要得到克服某种目标的瞬间就能满足  \n有些人只要某个人得到幸福，自己就会跟着幸福  \n也有些人则令人伤透脑筋地刚好相反  \n![](https://cdn.luogu.com.cn/upload/pic/45572.png)\n但是，大部分人都没有自觉  \n他们不知道究竟什么能给自己带来幸福  \n但是，他们会异口同声地表示想要获得幸福  \n那样的人即使能察觉到幸福  \n也没办法变得幸福  \n最重要的是要敢于正视自己的内心  \n![](https://cdn.luogu.com.cn/upload/pic/45573.png)  \n【珂朵莉已经基本上不剩什么了】  \n![](https://cdn.luogu.com.cn/upload/pic/45574.png)  \n【心灵和身体，珂朵莉基本上快要全部失去了】  \n![](https://cdn.luogu.com.cn/upload/pic/45575.png)  \n【全部被我替换了】  \n![](https://cdn.luogu.com.cn/upload/pic/45576.png)  \n【幸好你在失去一切之前，回到了这里】  \n【喜悦和悲伤】  \n【还有喜欢某个人的情绪】  \n【现在依旧还残存着一些吧？】  \n嗯...  \n确实还有那么一丝...  \n【那就没问题了】  \n【珂朵莉你，依旧是珂朵莉】  \n![](https://cdn.luogu.com.cn/upload/pic/45578.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45579.png)  \n威...廉...？   \n![](https://cdn.luogu.com.cn/upload/pic/45580.png)  \n", "description": "珂朵莉给了你一个序列，每次查询一个区间 $[l,r]$ 中所有子序列分别去重后的和 $\\bmod\\ p$。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示这个序列。\n\n之后 $m$ 行，每行三个整数 $l,r,p$ 表示查询的区间与模数。\n", "outputFormat": "$m$ 行，每行输出一个整数表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\leq n,m,a_i \\leq 10^5$，$1\\leq p\\leq 10^9$，$1\\leq l\\leq r\\leq n$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi Easy Round 2015] Please Do Not Forget", "background": "Generally speaking, happiness itself differs from person to person.  \nSome people think it is enough as long as they can get something to eat.  \nSome people are satisfied as long as they can read books.  \n![](https://cdn.luogu.com.cn/upload/pic/45571.png)  \nSome people think that surviving with all their strength is the most important thing.  \nSome people are satisfied the moment they overcome some goal.  \nSome people feel happy as long as someone else becomes happy, and they become happy along with them.  \nAnd there are also people who are, to make you rack your brain, exactly the opposite.  \n![](https://cdn.luogu.com.cn/upload/pic/45572.png)  \nHowever, most people are not aware of themselves.  \nThey do not know what exactly can bring them happiness.  \nBut they will say in unison that they want to obtain happiness.  \nEven if such people can notice happiness,  \nthey still cannot become happy.  \nThe most important thing is to dare to face your own heart directly.  \n![](https://cdn.luogu.com.cn/upload/pic/45573.png)  \n【Chtholly basically has almost nothing left】  \n![](https://cdn.luogu.com.cn/upload/pic/45574.png)  \n【In mind and body, Chtholly has basically almost lost everything】  \n![](https://cdn.luogu.com.cn/upload/pic/45575.png)  \n【I replaced all of it】  \n![](https://cdn.luogu.com.cn/upload/pic/45576.png)  \n【Luckily, before you lost everything, you came back here】  \n【Joy and sorrow】  \n【And the feeling of liking someone】  \n【There are still some of them left now, right?】  \nMm...  \nThere is indeed just a little bit left...  \n【Then there is no problem】  \n【Chtholly, you are still Chtholly】  \n![](https://cdn.luogu.com.cn/upload/pic/45578.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45579.png)  \nWi... llem...?  \n![](https://cdn.luogu.com.cn/upload/pic/45580.png)", "description": "Chtholly gives you a sequence. For each query, compute the sum of all subsequences in the interval $[l,r]$ after removing duplicates within each subsequence, and output the result $\\bmod\\ p$.", "inputFormat": "The first line contains two integers $n,m$.\n\nThe second line contains $n$ integers representing the sequence.\n\nThen follow $m$ lines, each containing three integers $l,r,p$, describing the queried interval and the modulus.", "outputFormat": "Output $m$ lines. Each line contains one integer, the answer.", "hint": "Idea: nzhtl1477, Solution: nzhtl1477, Code: nzhtl1477, Data: nzhtl1477.\n\nConstraints: For $100\\%$ of the testdata, $1\\leq n,m,a_i \\leq 10^5$, $1\\leq p\\leq 10^9$, $1\\leq l\\leq r\\leq n$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi Easy Round 2015] 盼君勿忘", "background": "说起来，幸福本身就是因人而异的  \n有些人认为只要能混口饭吃就行了  \n有些人只要有书读就能满足  \n![](https://cdn.luogu.com.cn/upload/pic/45571.png)  \n有些人认为只有全力地生存才是最重要的  \n有些人只要得到克服某种目标的瞬间就能满足  \n有些人只要某个人得到幸福，自己就会跟着幸福  \n也有些人则令人伤透脑筋地刚好相反  \n![](https://cdn.luogu.com.cn/upload/pic/45572.png)\n但是，大部分人都没有自觉  \n他们不知道究竟什么能给自己带来幸福  \n但是，他们会异口同声地表示想要获得幸福  \n那样的人即使能察觉到幸福  \n也没办法变得幸福  \n最重要的是要敢于正视自己的内心  \n![](https://cdn.luogu.com.cn/upload/pic/45573.png)  \n【珂朵莉已经基本上不剩什么了】  \n![](https://cdn.luogu.com.cn/upload/pic/45574.png)  \n【心灵和身体，珂朵莉基本上快要全部失去了】  \n![](https://cdn.luogu.com.cn/upload/pic/45575.png)  \n【全部被我替换了】  \n![](https://cdn.luogu.com.cn/upload/pic/45576.png)  \n【幸好你在失去一切之前，回到了这里】  \n【喜悦和悲伤】  \n【还有喜欢某个人的情绪】  \n【现在依旧还残存着一些吧？】  \n嗯...  \n确实还有那么一丝...  \n【那就没问题了】  \n【珂朵莉你，依旧是珂朵莉】  \n![](https://cdn.luogu.com.cn/upload/pic/45578.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45579.png)  \n威...廉...？   \n![](https://cdn.luogu.com.cn/upload/pic/45580.png)  \n", "description": "珂朵莉给了你一个序列，每次查询一个区间 $[l,r]$ 中所有子序列分别去重后的和 $\\bmod\\ p$。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个整数表示这个序列。\n\n之后 $m$ 行，每行三个整数 $l,r,p$ 表示查询的区间与模数。\n", "outputFormat": "$m$ 行，每行输出一个整数表示答案。", "hint": "Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477\n\n对于 $100\\%$ 的数据，$1\\leq n,m,a_i \\leq 10^5$，$1\\leq p\\leq 10^9$，$1\\leq l\\leq r\\leq n$。", "locale": "zh-CN"}}}
{"pid": "P5073", "type": "P", "difficulty": 7, "samples": [["5 7\n-10 -3 -2 -4 -5\n2 2 4\n1 5\n2 2 4\n1 3\n2 1 5\n1 2\n2 3 5", "0\n6\n18\n19"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072, 131072]}, "tags": ["2015", "O2优化", "Ynoi"], "title": "[Ynoi Easy Round 2015] 世上最幸福的女孩", "background": "我有一个请求  \n最后的请求  \n我感觉自己好像跟他有过约定  \n说好了那个人以后不必再战斗  \n说好了那个人的战斗全部由我来继承   \n而且我还有话想对他说，所以拜托你了  \n![](https://cdn.luogu.com.cn/upload/pic/45581.png)  \n【无论如何都要？】  \n嗯，无论如何都要  \n【但是，如果再来一次，珂朵莉就会彻底消失了哦？】  \n【不光是回忆，包括那所有珍贵的情感】  \n【全都会彻底消失的哦！？】  \n那还挺让人受不了的呢  \n但是呢，比起消失，我更加讨厌就这么结束啊  \n【珂朵莉...】  \n所以，拜托你了  \n让我再一次，回到那个地方吧   \n![](https://cdn.luogu.com.cn/upload/pic/45582.png)  \n“珂朵莉，加油”  \n![](https://cdn.luogu.com.cn/upload/pic/45583.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45584.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45585.png)  \n威廉…  \n谢谢你…", "description": "在最后的最后，珂朵莉给了你一个长为 $n$ 的序列，有 $m$ 个操作：\n\n1. 全局加（即序列的所有数加）。\n2. 查询区间最大子段和。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个数表示这个序列。\n\n之后 $m$ 行，每行一个操作。\n\n* $1\\ x$ : 所有数都加上 $x$。\n* $2\\ l\\ r$ : 查询区间 $[l,r]$ 内的最大子段和（可以不选数，此时最大子段和是 $0$）。", "outputFormat": "对于每个询问，输出一个数表示答案。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：nzhtl1477&w33z8kqrqk8zzzx33，Data：nzhtl1477\n\n$1\\leq n \\leq 3\\times 10^5$，$1 \\leq m \\leq 6\\times 10^5$，序列中的数绝对值 $\\leq 2\\times 10^9$，$1$ 操作中的 $x$ 的绝对值 $\\leq 5\\times 10^7$。", "locale": "zh-CN", "translations": {"en": {"title": "[Ynoi Easy Round 2015] The Happiest Girl in the World.", "background": "I have a request.  \nThe final request.  \nI feel like I once made a promise with him.  \nWe agreed that person would not have to fight anymore in the future.  \nWe agreed that I would inherit all of that person’s battles.  \nAnd I still have something I want to say to him, so please.  \n![](https://cdn.luogu.com.cn/upload/pic/45581.png)  \n【No matter what, you must?】  \nYes, no matter what.  \n【But if you do it again, Ctholly will disappear completely.】  \n【Not only the memories, but also all those precious feelings.】  \n【All of them will disappear completely!?】  \nThat would be pretty unbearable.  \nBut compared to disappearing, I hate even more that it ends like this.  \n【Ctholly...】  \nSo, please.  \nLet me return to that place once again.  \n![](https://cdn.luogu.com.cn/upload/pic/45582.png)  \n“Ctholly, you can do it.”  \n![](https://cdn.luogu.com.cn/upload/pic/45583.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45584.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45585.png)  \nWillem...  \nThank you...", "description": "At the very end, Ctholly gives you a sequence of length $n$, with $m$ operations:\n\n1. Global add (i.e., add to all numbers in the sequence).\n2. Query the maximum subarray sum in an interval.", "inputFormat": "The first line contains two integers $n,m$.\n\nThe second line contains $n$ numbers representing the sequence.\n\nThen follow $m$ lines, each describing one operation.\n\n* $1\\ x$ : Add $x$ to all numbers.\n* $2\\ l\\ r$ : Query the maximum subarray sum in the interval $[l,r]$ (you may choose no elements; in this case the maximum subarray sum is $0$).", "outputFormat": "For each query, output one number as the answer.", "hint": "Idea: nzhtl1477, Solution: ccz181078, Code: nzhtl1477&w33z8kqrqk8zzzx33, Data: nzhtl1477.\n\nConstraints: $1\\leq n \\leq 3\\times 10^5$, $1 \\leq m \\leq 6\\times 10^5$, the absolute value of numbers in the sequence $\\leq 2\\times 10^9$, and the absolute value of $x$ in operation $1$ is $\\leq 5\\times 10^7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[Ynoi Easy Round 2015] 世上最幸福的女孩", "background": "我有一个请求  \n最后的请求  \n我感觉自己好像跟他有过约定  \n说好了那个人以后不必再战斗  \n说好了那个人的战斗全部由我来继承   \n而且我还有话想对他说，所以拜托你了  \n![](https://cdn.luogu.com.cn/upload/pic/45581.png)  \n【无论如何都要？】  \n嗯，无论如何都要  \n【但是，如果再来一次，珂朵莉就会彻底消失了哦？】  \n【不光是回忆，包括那所有珍贵的情感】  \n【全都会彻底消失的哦！？】  \n那还挺让人受不了的呢  \n但是呢，比起消失，我更加讨厌就这么结束啊  \n【珂朵莉...】  \n所以，拜托你了  \n让我再一次，回到那个地方吧   \n![](https://cdn.luogu.com.cn/upload/pic/45582.png)  \n“珂朵莉，加油”  \n![](https://cdn.luogu.com.cn/upload/pic/45583.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45584.png)  \n![](https://cdn.luogu.com.cn/upload/pic/45585.png)  \n威廉…  \n谢谢你…", "description": "在最后的最后，珂朵莉给了你一个长为 $n$ 的序列，有 $m$ 个操作：\n\n1. 全局加（即序列的所有数加）。\n2. 查询区间最大子段和。", "inputFormat": "第一行两个整数 $n,m$。\n\n第二行 $n$ 个数表示这个序列。\n\n之后 $m$ 行，每行一个操作。\n\n* $1\\ x$ : 所有数都加上 $x$。\n* $2\\ l\\ r$ : 查询区间 $[l,r]$ 内的最大子段和（可以不选数，此时最大子段和是 $0$）。", "outputFormat": "对于每个询问，输出一个数表示答案。", "hint": "Idea：nzhtl1477，Solution：ccz181078，Code：nzhtl1477&w33z8kqrqk8zzzx33，Data：nzhtl1477\n\n$1\\leq n \\leq 3\\times 10^5$，$1 \\leq m \\leq 6\\times 10^5$，序列中的数绝对值 $\\leq 2\\times 10^9$，$1$ 操作中的 $x$ 的绝对值 $\\leq 5\\times 10^7$。", "locale": "zh-CN"}}}
{"pid": "P5074", "type": "P", "difficulty": 6, "samples": [["2\n6 3\n1 1 1\n1 0 1\n1 1 1\n1 1 1\n1 0 1\n1 1 1\n2 4\n1 1 1 1\n1 1 1 1", "3\n2"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["2018", "轮廓线 DP"], "title": "Eat the Trees", "background": "HDU1693：Eat the Trees", "description": "给出 $n \\times m$ 的方格，有些格子不能铺线，其它格子必须铺，可以形成多个闭合回路。问有多少种铺法？", "inputFormat": "每个测试点多组数据。第一行一个正整数 $T$，表示有 $T$ 组数据。\n\n对于每组数据：\n\n第 $1$ 行，两个整数 $n,m\\ (2 \\le n,m \\le 12)$。\n\n从第 $2$ 行到第 $n+1$ 行，每行 $m$ 个数字（$1$ 或者 $0$），$1$ 表铺线，$0$ 表不铺线。", "outputFormat": "每组数据输出一个整数，表示方案数。保证答案小于 $2^{63}$。", "hint": null, "locale": "zh-CN", "translations": {"en": {"title": "Eat the Trees", "background": "HDU1693: Eat the Trees", "description": "Given an $n \\times m$ grid, some cells cannot be filled with lines, and all other cells must be filled. Multiple closed loops can be formed. Ask how many different ways there are to fill the grid?", "inputFormat": "Multiple test cases per input file. The first line contains a positive integer $T$, meaning there are $T$ test cases.\n\nFor each test case:\n\nLine $1$: two integers $n, m\\ (2 \\le n, m \\le 12)$.\n\nLines $2$ to $n + 1$: each line contains $m$ digits ($1$ or $0$). $1$ means this cell must be filled with lines, and $0$ means this cell is not filled with lines.", "outputFormat": "For each test case, output one integer, representing the number of valid ways. It is guaranteed that the answer is less than $2^{63}$.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Eat the Trees", "background": "HDU1693：Eat the Trees", "description": "给出 $n \\times m$ 的方格，有些格子不能铺线，其它格子必须铺，可以形成多个闭合回路。问有多少种铺法？", "inputFormat": "每个测试点多组数据。第一行一个正整数 $T$，表示有 $T$ 组数据。\n\n对于每组数据：\n\n第 $1$ 行，两个整数 $n,m\\ (2 \\le n,m \\le 12)$。\n\n从第 $2$ 行到第 $n+1$ 行，每行 $m$ 个数字（$1$ 或者 $0$），$1$ 表铺线，$0$ 表不铺线。", "outputFormat": "每组数据输出一个整数，表示方案数。保证答案小于 $2^{63}$。", "hint": null, "locale": "zh-CN"}}}
{"pid": "P5075", "type": "P", "difficulty": 7, "samples": [["4 100\n4\n1\n0\n0\n", "63\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["动态规划 DP", "2012", "各省省选", "江苏", "O2优化", "快速傅里叶变换 FFT"], "title": "[JSOI2012] 分零食", "background": "", "description": "这里是欢乐的进香河，这里是欢乐的幼儿园。\n\n今天是 2 月 14 日，星期二。在这个特殊的日子里，老师带着同学们欢乐地跳着，笑着。校长从幼儿园旁边的小吃店买了大量的零食决定分给同学们。听到这个消息，所有同学都安安静静地排好了队，大家都知道，校长不喜欢调皮的孩子。\n\n同学们依次排成了一列，其中有 $A$ 位小朋友，有三个共同的欢乐系数 $O$，$S$ 和 $U$。如果有一位小朋友得到了 $x$ 个糖果，那么她的欢乐程度就是 $f(x)=Ox^2+Sx+U$。\n\n现在校长开始分糖果了，一共有 $M$ 个糖果。有些小朋友可能得不到糖果，对于那些得不到糖果的小朋友来说，欢乐程度就是 $1$。如果一位小朋友得不到糖果，那么在她身后的小朋友们也都得不到糖果（即这一列得不到糖果的小朋友一定是最后的连续若干位）。\n\n所有分糖果的方案都是等概率的。现在问题是：期望情况下，所有小朋友的欢乐程度的乘积是多少？呆呆同学很快就有了一个思路，只要知道总的方案个数 $T$ 和所有方案下欢乐程度乘积的总和 $S$，就可以得到答案 $ans=\\frac{S}{T}$。现在他已经求出来了 $T$ 的答案，但是 $S$ 怎么求呢？他就不知道了。你能告诉他么？\n\n因为答案很大，你只需要告诉他 $S$ 对 $P$ 取模后的结果。\n\n后记：\n\n虽然大家都知道，即便知道了 $T$，知道了 $S$ 对 $P$ 取模后的结果，也没有办法知道期望情况下，所有小朋友欢乐程度的乘积。但是，当呆呆想到这一点的时候，已经彻底绝望了。", "inputFormat": "第一行有两个整数，分别是 $M$ 和 $P$。\n\n第二行有一个整数 $A$。\n\n第三行有一个整数 $O$。\n\n第四行有一个整数 $S$。\n\n第五行有一个整数 $U$。", "outputFormat": "一个整数 $S$，因为答案可能很大，你只需要输出 $S$ 对 $P$ 取模后的结果。", "hint": "**样例解释：**\n\n函数 $f(x)=x^2$。一共有 $4$ 份零食，$4$ 位同学。如果只有第一个同学得到，欢乐程度为 $16$，若前两位同学得到，欢乐程度的所有可能依次为 $9, 9, 16$，若有三位同学得到，欢乐程度有 $4, 4, 4$，最后一种情况，每一个同学都得到了零食，欢乐程度为 $1$。相加后得到 $S=63$。\n\n**数据范围：**\n\n对于 $40 \\%$ 的数据，$M \\leq 150$。  \n对于 $60 \\%$ 的数据，$M \\leq 2000$。  \n对于 $80 \\%$ 的数据，$M \\leq 6000$。  \n对于 $100 \\%$ 的数据，$M \\leq 10000, P \\leq 255, A \\leq 10^8, O \\leq 4, S \\leq 300, U \\leq 100$。", "locale": "zh-CN", "translations": {"en": {"title": "[JSOI2012] Distributing Snacks", "background": "", "description": "This is the joyful Jingxiang River, and this is a joyful kindergarten.\n\nToday is February 14, Tuesday. On this special day, the teacher leads the children to dance and laugh happily. The principal bought a large amount of snacks from a snack shop next to the kindergarten and decided to give them to the children. Hearing this news, all the children quietly lined up. Everyone knows that the principal does not like naughty kids.\n\nThe children stand in a single line in order. There are $A$ children, and there are three shared joy coefficients $O$, $S$, and $U$. If a child receives $x$ candies, then her happiness is $f(x)=Ox^2+Sx+U$.\n\nNow the principal starts handing out candies. There are $M$ candies in total. Some children may receive no candies. For those children who receive no candies, the happiness is $1$. If a child receives no candies, then all children behind her also receive no candies (that is, the children who receive no candies must form a consecutive suffix at the end of the line).\n\nAll candy-distribution plans are equally likely. The question is: in expectation, what is the product of the happiness values of all children? Student Daidai quickly came up with an idea: as long as he knows the total number of plans $T$ and the sum $S$ of the happiness-product over all plans, he can get the answer $ans=\\frac{S}{T}$. He has already computed $T$, but he does not know how to compute $S$. Can you tell him?\n\nBecause the answer is very large, you only need to output $S \\bmod P$.\n\nPostscript:\n\nAlthough everyone knows that even if you know $T$ and $S \\bmod P$, there is still no way to know the expected product of the happiness values of all children. However, when Daidai realized this, he was already completely hopeless.", "inputFormat": "The first line contains two integers, $M$ and $P$.\n\nThe second line contains an integer $A$.\n\nThe third line contains an integer $O$.\n\nThe fourth line contains an integer $S$.\n\nThe fifth line contains an integer $U$.", "outputFormat": "Output one integer $S$. Since the answer may be very large, you only need to output $S \\bmod P$.", "hint": "**Sample Explanation:**\n\nThe function is $f(x)=x^2$. There are $4$ snacks and $4$ students. If only the first student receives candies, the happiness is $16$. If the first two students receive candies, then the possible happiness values (for all distributions) are $9, 9, 16$ in order. If three students receive candies, the happiness values are $4, 4, 4$. In the last case, every student receives snacks, and the happiness is $1$. Adding them up gives $S=63$.\n\n**Constraints:**\n\nFor $40\\%$ of the testdata, $M \\leq 150$.  \nFor $60\\%$ of the testdata, $M \\leq 2000$.  \nFor $80\\%$ of the testdata, $M \\leq 6000$.  \nFor $100\\%$ of the testdata, $M \\leq 10000, P \\leq 255, A \\leq 10^8, O \\leq 4, S \\leq 300, U \\leq 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "[JSOI2012] 分零食", "background": "", "description": "这里是欢乐的进香河，这里是欢乐的幼儿园。\n\n今天是 2 月 14 日，星期二。在这个特殊的日子里，老师带着同学们欢乐地跳着，笑着。校长从幼儿园旁边的小吃店买了大量的零食决定分给同学们。听到这个消息，所有同学都安安静静地排好了队，大家都知道，校长不喜欢调皮的孩子。\n\n同学们依次排成了一列，其中有 $A$ 位小朋友，有三个共同的欢乐系数 $O$，$S$ 和 $U$。如果有一位小朋友得到了 $x$ 个糖果，那么她的欢乐程度就是 $f(x)=Ox^2+Sx+U$。\n\n现在校长开始分糖果了，一共有 $M$ 个糖果。有些小朋友可能得不到糖果，对于那些得不到糖果的小朋友来说，欢乐程度就是 $1$。如果一位小朋友得不到糖果，那么在她身后的小朋友们也都得不到糖果（即这一列得不到糖果的小朋友一定是最后的连续若干位）。\n\n所有分糖果的方案都是等概率的。现在问题是：期望情况下，所有小朋友的欢乐程度的乘积是多少？呆呆同学很快就有了一个思路，只要知道总的方案个数 $T$ 和所有方案下欢乐程度乘积的总和 $S$，就可以得到答案 $ans=\\frac{S}{T}$。现在他已经求出来了 $T$ 的答案，但是 $S$ 怎么求呢？他就不知道了。你能告诉他么？\n\n因为答案很大，你只需要告诉他 $S$ 对 $P$ 取模后的结果。\n\n后记：\n\n虽然大家都知道，即便知道了 $T$，知道了 $S$ 对 $P$ 取模后的结果，也没有办法知道期望情况下，所有小朋友欢乐程度的乘积。但是，当呆呆想到这一点的时候，已经彻底绝望了。", "inputFormat": "第一行有两个整数，分别是 $M$ 和 $P$。\n\n第二行有一个整数 $A$。\n\n第三行有一个整数 $O$。\n\n第四行有一个整数 $S$。\n\n第五行有一个整数 $U$。", "outputFormat": "一个整数 $S$，因为答案可能很大，你只需要输出 $S$ 对 $P$ 取模后的结果。", "hint": "**样例解释：**\n\n函数 $f(x)=x^2$。一共有 $4$ 份零食，$4$ 位同学。如果只有第一个同学得到，欢乐程度为 $16$，若前两位同学得到，欢乐程度的所有可能依次为 $9, 9, 16$，若有三位同学得到，欢乐程度有 $4, 4, 4$，最后一种情况，每一个同学都得到了零食，欢乐程度为 $1$。相加后得到 $S=63$。\n\n**数据范围：**\n\n对于 $40 \\%$ 的数据，$M \\leq 150$。  \n对于 $60 \\%$ 的数据，$M \\leq 2000$。  \n对于 $80 \\%$ 的数据，$M \\leq 6000$。  \n对于 $100 \\%$ 的数据，$M \\leq 10000, P \\leq 255, A \\leq 10^8, O \\leq 4, S \\leq 300, U \\leq 100$。", "locale": "zh-CN"}}}
{"pid": "P5076", "type": "P", "difficulty": 4, "samples": [["7\n5 1\n5 3\n5 5\n1 3\n2 2\n3 3\n4 3", "2\n3\n1\n5\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000], "memory": [524288, 524288, 524288, 524288, 524288, 524288]}, "tags": ["模拟", "树形数据结构", "平衡树"], "title": "【深基16.例7】普通二叉树（简化版）", "background": "", "description": "您需要写一种数据结构，来维护一些数（都是绝对值 $10^9$ 以内的数）的集合，最开始时集合是空的。其中需要提供以下操作，操作次数 $q$ 不超过 $10^4$：\n\n1. 定义数 $x$ 的排名为集合中小于 $x$ 的数的个数 $+1$。查询数 $x$ 的排名。**注意 $x$ 不一定在集合里**。\n2. 查询排名为 $x(x\\ge 1)$ 的数。**保证集合里至少有 $x$ 个数**。\n3. 求 $x$ 的前驱（前驱定义为小于 $x$，且最大的数）。若不存在则输出 $-2147483647$。\n4. 求 $x$ 的后继（后继定义为大于 $x$，且最小的数）。若不存在则输出 $2147483647$。\n5. 插入一个数 $x$，本题的数据保证插入前 $x$ 不在集合中。\n\n保证执行 $1,3,4$ 操作时，集合中有至少一个元素。", "inputFormat": "第一行是一个整数 $q$，表示操作次数。\n\n接下来 $q$ 行，每行两个整数 $op,x$，分别表示操作序号以及操作的参数 $x$。", "outputFormat": "输出有若干行。对于操作 $1,2,3,4$，输出一个整数，表示该操作的结果。", "hint": "", "locale": "zh-CN", "translations": {"en": {"title": "[Shenji 16. Example 7] Ordinary Binary Tree (Simplified Version).", "background": "", "description": "You need to implement a data structure to maintain a set of numbers (all numbers have absolute value within $10^9$). The set is initially empty. You need to support the following operations, and the number of operations $q$ does not exceed $10^4$:\n\n1. Define the rank of a number $x$ as the number of elements in the set that are less than $x$, plus $1$. Query the rank of $x$. **Note that $x$ may not be in the set**.\n2. Query the number whose rank is $x$ ($x \\ge 1$). **It is guaranteed that the set contains at least $x$ numbers**.\n3. Find the predecessor of $x$ (the predecessor is defined as the largest number that is less than $x$). If it does not exist, output $-2147483647$.\n4. Find the successor of $x$ (the successor is defined as the smallest number that is greater than $x$). If it does not exist, output $2147483647$.\n5. Insert a number $x$. The testdata guarantees that before insertion, $x$ is not in the set.\n\nIt is guaranteed that when performing operations $1$, $3$, and $4$, the set contains at least one element.", "inputFormat": "The first line contains an integer $q$, indicating the number of operations.\n\nIn the next $q$ lines, each line contains two integers $op, x$, representing the operation index and the parameter $x$.", "outputFormat": "Output several lines. For operations $1$, $2$, $3$, and $4$, output one integer representing the result of the operation.", "hint": "\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "【深基16.例7】普通二叉树（简化版）", "background": "", "description": "您需要写一种数据结构，来维护一些数（都是绝对值 $10^9$ 以内的数）的集合，最开始时集合是空的。其中需要提供以下操作，操作次数 $q$ 不超过 $10^4$：\n\n1. 定义数 $x$ 的排名为集合中小于 $x$ 的数的个数 $+1$。查询数 $x$ 的排名。**注意 $x$ 不一定在集合里**。\n2. 查询排名为 $x(x\\ge 1)$ 的数。**保证集合里至少有 $x$ 个数**。\n3. 求 $x$ 的前驱（前驱定义为小于 $x$，且最大的数）。若不存在则输出 $-2147483647$。\n4. 求 $x$ 的后继（后继定义为大于 $x$，且最小的数）。若不存在则输出 $2147483647$。\n5. 插入一个数 $x$，本题的数据保证插入前 $x$ 不在集合中。\n\n保证执行 $1,3,4$ 操作时，集合中有至少一个元素。", "inputFormat": "第一行是一个整数 $q$，表示操作次数。\n\n接下来 $q$ 行，每行两个整数 $op,x$，分别表示操作序号以及操作的参数 $x$。", "outputFormat": "输出有若干行。对于操作 $1,2,3,4$，输出一个整数，表示该操作的结果。", "hint": "", "locale": "zh-CN"}}}
{"pid": "P5077", "type": "P", "difficulty": 3, "samples": [["9", "2 4"], ["16", "16 16"], ["1000000007", "500000003 500000004"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": [], "title": "Tweetuzki 爱等差数列", "background": "", "description": "Tweetuzki 特别喜欢等差数列。尤其是公差为 $1$ 且全为正整数的等差数列。\n\n显然，对于每一个数 $s$，都能找到一个对应的公差为 $1$ 且全为正整数的等差数列各项之和为 $s$。这时，Tweetuzki 想知道，满足这样条件的等差数列，最小的首项是多少。\n\n由于 Tweetuzki 的数学非常差，尤其是因式分解，所以请你告诉他结果。", "inputFormat": "输入仅包含一行一个整数 $s$ $(1 \\le s \\le 10^{12})$.", "outputFormat": "输出两个正整数，分别表示这个等差数列的首项和末项。请注意输出最小的首项。", "hint": "**样例解释 1**\n\n$2 + 3 + 4 = 9$\n\n**样例解释 2**\n\n$16 = 16$\n\n## 数据范围\n\n对于 $10\\%$ 的数据，$s \\le 10^6$。  \n对于 $100\\%$ 的数据，$1 \\le s \\le 10^{12}$。\n\n## 提示\n\n若有一个数列 $a$，每一项 $a_i$ 都满足 $a_i \\in \\mathbb{N_{+}}$ 且 $a_i - a_{i - 1} = a_{i + 1} - a_i = 1$，则称这个数列为一个公差为 $1$ 且全为正整数的等差数列。", "locale": "zh-CN", "translations": {"en": {"title": "Tweetuzki Loves Arithmetic Progressions", "background": "", "description": "Tweetuzki especially likes arithmetic progressions. In particular, he likes arithmetic progressions with common difference $1$ and all terms being positive integers.\n\nObviously, for every number $s$, we can find an arithmetic progression with common difference $1$ and all terms being positive integers such that the sum of its terms is $s$. Now, Tweetuzki wants to know: among all such arithmetic progressions, what is the smallest possible first term.\n\nSince Tweetuzki is very bad at math, especially at factoring, please tell him the answer.", "inputFormat": "The input contains only one line with an integer $s$ $(1 \\le s \\le 10^{12})$.", "outputFormat": "Output two positive integers, representing the first term and the last term of the arithmetic progression. Note that you must output the smallest possible first term.", "hint": "**Sample Explanation 1**\n\n$2 + 3 + 4 = 9$\n\n**Sample Explanation 2**\n\n$16 = 16$\n\n## Constraints\n\nFor $10\\%$ of the testdata, $s \\le 10^6$.  \nFor $100\\%$ of the testdata, $1 \\le s \\le 10^{12}$.\n\nIf there is a sequence $a$ where each term $a_i$ satisfies $a_i \\in \\mathbb{N_{+}}$ and $a_i - a_{i - 1} = a_{i + 1} - a_i = 1$, then this sequence is called an arithmetic progression with common difference $1$ and all terms being positive integers.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Tweetuzki 爱等差数列", "background": "", "description": "Tweetuzki 特别喜欢等差数列。尤其是公差为 $1$ 且全为正整数的等差数列。\n\n显然，对于每一个数 $s$，都能找到一个对应的公差为 $1$ 且全为正整数的等差数列各项之和为 $s$。这时，Tweetuzki 想知道，满足这样条件的等差数列，最小的首项是多少。\n\n由于 Tweetuzki 的数学非常差，尤其是因式分解，所以请你告诉他结果。", "inputFormat": "输入仅包含一行一个整数 $s$ $(1 \\le s \\le 10^{12})$.", "outputFormat": "输出两个正整数，分别表示这个等差数列的首项和末项。请注意输出最小的首项。", "hint": "**样例解释 1**\n\n$2 + 3 + 4 = 9$\n\n**样例解释 2**\n\n$16 = 16$\n\n## 数据范围\n\n对于 $10\\%$ 的数据，$s \\le 10^6$。  \n对于 $100\\%$ 的数据，$1 \\le s \\le 10^{12}$。\n\n## 提示\n\n若有一个数列 $a$，每一项 $a_i$ 都满足 $a_i \\in \\mathbb{N_{+}}$ 且 $a_i - a_{i - 1} = a_{i + 1} - a_i = 1$，则称这个数列为一个公差为 $1$ 且全为正整数的等差数列。", "locale": "zh-CN"}}}
{"pid": "P5078", "type": "P", "difficulty": 5, "samples": [["5\n7 8 1 2 5", "87\n1 2 5 8 7"], ["5\n7 99 1 5 2", "530\n7 1 2 5 99"], ["8\n1 9 2 6 0 8 1 7", "206\n1 2 0 1 7 8 6 9"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": ["贪心"], "title": "Tweetuzki 爱军训", "background": "", "description": "Tweetuzki 仍然记得，初一军训的时候，有关他们班的教官的一些事儿。\n\nTweetuzki 所在的班级有 $n$ 名学生，座号从 $1$ 到 $n$。有一次，教官命令班上的 $n$ 名学生按照座号顺序从左到右排成一排站好军姿，其中 $1$ 号学生在最左边，$n$ 号学生在最右边。\n\n由于同学们站了很久，怨声载道，仁慈的教官又不希望大家一起解散导致混乱的局面，于是想了一个办法：教官从最左边——也就是 $1$ 号学生身旁出发，走到 $n$ 号学生右边后，再折返回到 $1$ 号同学旁边。在教官在从 $1$ 号同学走到 $n$ 号同学这段路上，当走到某位同学身边时，他可以选择让这位同学出列，也可以等到折返的时候再使这名同学出列。\n\n但是有一些同学在军训过程中表现极坏，因此教官希望他们晚一些出列休息。对于 $i$ 号同学，定义他的“坏值”为 $w_i$。教官希望在一次往返过程中，使得所有学生出列，且最大化 $\\sum_{i = 1}^n r_i \\times w_i$ 的值，其中 $r_i$ 表示 $i$ 号同学是第 $r_i$ 位出列的学生。机智的教官一下子就想出了这个方案，Tweetuzki 大为惊讶，于是他去请教教官如何做到。可是他的胆子很小而且“坏值”很大，教官可能不会告诉他，所以他就找到了你。", "inputFormat": "第一行一个整数 $n$ ( $5 \\le n \\le 10^6$ )。  \n第二行包含 $n$ 个整数，描述这 $n$ 个同学的坏值 $w_1, w_2, w_3, …, w_n$ $(0 \\le w_i \\le 10^6)$。", "outputFormat": "第一行一个整数，表示最大值。  \n接下来一行包含 $n$ 个这个数，描述一个合理的出列顺序，输出的是对应同学的“坏值”，详见样例。如果有多个满足条件的出列顺序，请输出出列的人序号字典序最小的。", "hint": "### 样例解释 1\n\n在去的路上让 $3, 4, 5$ 号同学出列，回来时让 $2, 1$ 号同学出列。总的值为 $5 \\times 7 + 4 \\times 8 + 1 \\times 1 + 2 \\times 2 + 3 \\times 5 = 87$，可以证明没有使得答案大于 $87$ 的方案。\n\n### 数据范围\n\n本题共设 $20$ 组测试点，每组测试数据 $5$ 分。\n\n对于 $10\\%$ 的数据，$n \\le 8$。  \n对于 $30\\%$ 的数据，$n \\le 20$。  \n对于 $60\\%$ 的数据，$n \\le 1000$。  \n对于 $100\\%$ 的数据，$5 \\le n \\le 10^6$，$0 \\le w_i \\le 10^6$。  ", "locale": "zh-CN", "translations": {"en": {"title": "Tweetuzki Loves Military Training.", "background": "", "description": "Tweetuzki still remembers some things about the instructor of their class during the military training in Grade 7.\n\nThere are $n$ students in Tweetuzki’s class, with seat numbers from $1$ to $n$. Once, the instructor ordered the $n$ students to stand in a line from left to right in increasing seat number, where student $1$ is on the far left and student $n$ is on the far right.\n\nSince the students had been standing for a long time and complained a lot, the kind instructor also did not want everyone to be dismissed at the same time and cause chaos, so he came up with a method: the instructor starts from the far left (next to student $1$), walks to the right side of student $n$, then turns back and returns to student $1$. During the trip from student $1$ to student $n$, when the instructor reaches a student, he may choose to dismiss this student from the line, or wait until the return trip to dismiss the student.\n\nHowever, some students behaved very badly during the training, so the instructor wants them to rest later. For student $i$, define their “badness value” as $w_i$. The instructor wants, within one round trip, to have all students dismissed, and maximize the value of $\\sum_{i = 1}^n r_i \\times w_i$, where $r_i$ means student $i$ is the $r_i$-th student to be dismissed. The clever instructor immediately found a plan, and Tweetuzki was amazed, so he asked the instructor how to do it. But he is timid and has a large “badness value”, so the instructor might not tell him, and thus he came to you.", "inputFormat": "The first line contains an integer $n$ ( $5 \\le n \\le 10^6$ ).  \nThe second line contains $n$ integers describing the badness values $w_1, w_2, w_3, …, w_n$ ( $0 \\le w_i \\le 10^6$ ).", "outputFormat": "The first line contains an integer, the maximum value.  \nThe next line contains $n$ integers describing a valid dismissal order. Output the corresponding students’ “badness values”; see the sample for details. If there are multiple valid dismissal orders, output the one with the lexicographically smallest sequence of dismissed student indices.", "hint": "### Sample Explanation 1\n\nOn the way there, dismiss students $3, 4, 5$. On the way back, dismiss students $2, 1$. The total value is $5 \\times 7 + 4 \\times 8 + 1 \\times 1 + 2 \\times 2 + 3 \\times 5 = 87$, and it can be proven that no plan can achieve a value greater than $87$.\n\n### Constraints\n\nThis problem has $20$ test points, and each group of testdata is worth $5$ points.\n\nFor $10\\%$ of the data, $n \\le 8$.  \nFor $30\\%$ of the data, $n \\le 20$.  \nFor $60\\%$ of the data, $n \\le 1000$.  \nFor $100\\%$ of the data, $5 \\le n \\le 10^6$, $0 \\le w_i \\le 10^6$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Tweetuzki 爱军训", "background": "", "description": "Tweetuzki 仍然记得，初一军训的时候，有关他们班的教官的一些事儿。\n\nTweetuzki 所在的班级有 $n$ 名学生，座号从 $1$ 到 $n$。有一次，教官命令班上的 $n$ 名学生按照座号顺序从左到右排成一排站好军姿，其中 $1$ 号学生在最左边，$n$ 号学生在最右边。\n\n由于同学们站了很久，怨声载道，仁慈的教官又不希望大家一起解散导致混乱的局面，于是想了一个办法：教官从最左边——也就是 $1$ 号学生身旁出发，走到 $n$ 号学生右边后，再折返回到 $1$ 号同学旁边。在教官在从 $1$ 号同学走到 $n$ 号同学这段路上，当走到某位同学身边时，他可以选择让这位同学出列，也可以等到折返的时候再使这名同学出列。\n\n但是有一些同学在军训过程中表现极坏，因此教官希望他们晚一些出列休息。对于 $i$ 号同学，定义他的“坏值”为 $w_i$。教官希望在一次往返过程中，使得所有学生出列，且最大化 $\\sum_{i = 1}^n r_i \\times w_i$ 的值，其中 $r_i$ 表示 $i$ 号同学是第 $r_i$ 位出列的学生。机智的教官一下子就想出了这个方案，Tweetuzki 大为惊讶，于是他去请教教官如何做到。可是他的胆子很小而且“坏值”很大，教官可能不会告诉他，所以他就找到了你。", "inputFormat": "第一行一个整数 $n$ ( $5 \\le n \\le 10^6$ )。  \n第二行包含 $n$ 个整数，描述这 $n$ 个同学的坏值 $w_1, w_2, w_3, …, w_n$ $(0 \\le w_i \\le 10^6)$。", "outputFormat": "第一行一个整数，表示最大值。  \n接下来一行包含 $n$ 个这个数，描述一个合理的出列顺序，输出的是对应同学的“坏值”，详见样例。如果有多个满足条件的出列顺序，请输出出列的人序号字典序最小的。", "hint": "### 样例解释 1\n\n在去的路上让 $3, 4, 5$ 号同学出列，回来时让 $2, 1$ 号同学出列。总的值为 $5 \\times 7 + 4 \\times 8 + 1 \\times 1 + 2 \\times 2 + 3 \\times 5 = 87$，可以证明没有使得答案大于 $87$ 的方案。\n\n### 数据范围\n\n本题共设 $20$ 组测试点，每组测试数据 $5$ 分。\n\n对于 $10\\%$ 的数据，$n \\le 8$。  \n对于 $30\\%$ 的数据，$n \\le 20$。  \n对于 $60\\%$ 的数据，$n \\le 1000$。  \n对于 $100\\%$ 的数据，$5 \\le n \\le 10^6$，$0 \\le w_i \\le 10^6$。  ", "locale": "zh-CN"}}}
{"pid": "P5079", "type": "P", "difficulty": 3, "samples": [["6 10\n# . . . . . # . . #\n# . . . # . # . . #\n# . . . # . # . . #\n# . . . # . # . . #\n# . . . # . # . . #\n. . . . # . . . . .", "1111"], ["8 37\n. . . # # # . . . . . . . . . . . . . . . . . . # # # . # . . . . . . . .\n. # . # . # . . . . . . . . # # # . . . . . . . # . # . # . . . . . . . .\n. # . # # # . . . . . . . . # . . . # # # . . . # # # . # . . # # # . . .\n. # . . . # . . . # # # . . # # # . # . # . . . # . # . # . . . . # . . .\n. # . # # # . . . . . # . . # . # . # . # . . . # # # . # . . . . # . . .\n. # . . . . . . . # # # . . # # # . # . # . . . . . . . . . . . . # . . .\n. . . . . . . . . # . . . . . . . . # # # . . . . . . . . . . . . # . . .\n. . . . . . . . . # # # . . . . . . . . . . . . . . . . . . . . . . . . .\n", "19260817"], ["9 94\n# # # . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . # # # . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n# . # . . . . . . . . . . . . . . . . . . . . . . . . # . # . . . . . . . . . . # . . . . . . . . . . . # # # . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n# . # . . . # . . . . . . . . . . . . . . . # # # . . # . # . . . . . . . . . . # # # . . . . . . . . . # . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n# . # . . . # . . # # # . . . . . . . . . . . . # . . # # # . . . . . . . . . . . . # . . . . . . . . . # # # . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .\n# # # . . . # . . . . # . . . . . . . . . . # # # . . . . # . . . . . . . . . . # # # . . . . . . . . . # . # . . . . . . . # # # . . . . . . # # # . . . . . . . . . # # # . . . . . . . .\n. . . . . . # . . # # # . . . . . . . . . . . . # . . . . # . . . . . . . . . . . . . . . . . . . . . . # # # . . . . . . . . . # . . . . . . # . # . . . . . . . . . # . # . . . . . . . .\n. . . . . . # . . # . . . . . . . . . . . . # # # . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . # . . . . . . # # # . . . . . . . . . # # # . . . . . . . .\n. . . . . . . . . # # # . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . # . . . . . . # . # . . . . . . . . . . . # . . . . . . . .\n. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . # . . . . . . # # # . . . . . . . . . # # # . . . . . . . .\n", "0123456789\n"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": [], "title": "Tweetuzki 爱伊图", "background": "Tweetuzki 的教练最近常常在群里发有关「伊图科技」的文章。「伊图科技」是一家专注于计算机视觉技术的上海创业公司，其人脸识别技术在世界处于领先地位。2018 年 6 月，在全球工业界黄金标准 FRVT 测试中，依图在千万分之一误报下识别准确率接近 $99\\%$，是全球工业界在此项指标下的最好水平，这是依图科技连续第二年摘得此项竞赛的冠军，也是首个夺得此项竞赛冠军的中国团队。2018 年 11 月 16 日，美国国家标准与技术研究院（NIST）公布了全球权威人脸识别比赛（FRVT）最新报告，依图算法继续保持第一，在千万分之一误报下的识别准确率超过 $99\\%$，是目前全球人脸识别技术的最好水平。\n\n更重要的是，伊图科技的创始人，是附中的毕业生——Tweetuzki 的学长呢！人脸识别真的好难呢！Tweetuzki 常常幻想，要是自己的程序能有学长们的亿万分之一厉害，那就很好了呢！", "description": "Tweetuzki 希望设计出一个程序，这个程序应当能识别输入矩阵中隐藏的数字。\n\n输入的是一个 $r \\times c$ 的字符矩阵，矩阵中的元素只有 `. `或 `#`。其中 `#` 可以构成一些数字。输入的矩阵将严格遵守以下规则：\n\n- 除 $1$ 占 $5 \\times 1$ 的长方形区域外，其余数字均占 $5 \\times 3$ 的长方形区域。\n\n- 相邻两个数字间至少有一列 `.`，即**数字不会贴在一块儿**；且数字**只会左右排放**，不会上下排放。这两点综合起来可以表述为：对于两个数字 $A$ 和 $B$（$A$ 在 $B$ 的左侧），若它们在横向上延伸的区间分别为 $[l_A, r_A]$ 和 $[l_B, r_B]$，那么一定满足 $l_B \\ge r_A + 2$。\n\n- 数字的组成严格按照如下所列：\n\n  ```plain\n  数字的组成方式：\n  #   # # #   # # #   # . #   # # #   # # #   # # #   # # #   # # #   # # # \n  #   . . #   . . #   # . #   # . .   # . .   . . #   # . #   # . #   # . # \n  #   # # #   # # #   # # #   # # #   # # #   . . #   # # #   # # #   # . # \n  #   # . .   . . #   . . #   . . #   # . #   . . #   # . #   . . #   # . # \n  #   # # #   # # #   . . #   # # #   # # #   . . #   # # #   # # #   # # # \n  \n  所代表的数字：\n  1     2       3       4       5       6       7       8       9       0\n  ```\n\n  **数字不会倾斜、放大或缩小。**具体可见样例。\n\n- 除构成数字的长方形区域外，其余位置皆由 `.` 填充。保证所有的 `#` 的连通块一定都能够组成数字，且一定满足上述规则。\n\n由于 Tweetuzki 太弱了，于是向你求助，聪明的你，能不能帮助 Tweetuzki 解决这个问题呢？", "inputFormat": "第一行两个正整数 $r, c$ $(5 \\le r \\le 10, 3 \\le c \\le 10^5)$，表示矩阵的行数和列数。  \n接下来 $r$ 行，每行输入 $c$ 个字符，用空格隔开，保证只含有 `.` 和 `#` 两种字符。输入矩阵保证合法且一定含有隐藏数字。", "outputFormat": "输出仅包含一行一个只含数字的字符串，**按照顺序**输出这个矩阵中隐藏的数字。", "hint": "### 样例解释\n\n建议复制进记事本（或各种 IDE）中用等宽字体查看。 \n\n###  子任务\n\n**_Subtask_ #1 _(30 points)_**：矩阵中仅有数字 $1$。  \n**_Subtask_ #2 _(30 points)_**：矩阵中不含有数字 $1$ 和 $4$。  \n**_Subtask_ #3 _(40 points)_**：无特殊性质。", "locale": "zh-CN", "translations": {"en": {"title": "Tweetuzki Loves Yitu.", "background": "Tweetuzki’s coach has recently often shared articles about “Yitu Technology” in the group chat. “Yitu Technology” is a Shanghai startup focusing on computer vision technology, and its face recognition technology is at a leading level worldwide. In June 2018, in the global industry gold-standard FRVT test, with a false positive rate of one in ten million, Yitu’s recognition accuracy was close to $99\\%$, reaching the best level in the global industry under this metric. This was the second year in a row that Yitu Technology won the championship of this competition, and it was also the first Chinese team to win this competition. On November 16, 2018, the U.S. National Institute of Standards and Technology (NIST) released the latest report of the world’s authoritative face recognition competition (FRVT). Yitu’s algorithm continued to rank first, and with a false positive rate of one in ten million, its recognition accuracy exceeded $99\\%$, which is currently the best level of face recognition technology in the world.\n\nMore importantly, the founder of Yitu Technology is a graduate of the affiliated high school, and also Tweetuzki’s senior! Face recognition is really hard! Tweetuzki often imagines that if their own program could be even one hundred-millionth as powerful as their seniors’, that would be great.", "description": "Tweetuzki wants to design a program that can recognize the digits hidden in the input matrix.\n\nThe input is a $r \\times c$ character matrix. Each element is either `.` or `#`. The `#` symbols can form some digits. The input matrix will strictly follow the rules below:\n\n- Except for digit $1$, which occupies a $5 \\times 1$ rectangular area, all other digits occupy a $5 \\times 3$ rectangular area.\n\n- There is at least one column of `.` between two adjacent digits, meaning **digits will not stick together**. Also, digits are **only placed left to right**, never stacked vertically. Combining these two points: for two digits $A$ and $B$ (with $A$ to the left of $B$), if their horizontal spans are $[l_A, r_A]$ and $[l_B, r_B]$, then it must hold that $l_B \\ge r_A + 2$.\n\n- Digits are composed exactly as listed below:\n\n  ```plain\n  Digit patterns:\n  #   # # #   # # #   # # #   # . #   # # #   # # #   # # #   # # #   # # # \n  #   . . #   . . #   # . #   # . #   # . .   # . .   . . #   # . #   # . # \n  #   # # #   # # #   # # #   # # #   # # #   # # #   . . #   # # #   # . # \n  #   # . .   . . #   . . #   . . #   # . #   # . #   . . #   # . #   # . # \n  #   # # #   # # #   . . #   # # #   # # #   # # #   . . #   # # #   # # # \n  \n  Digits represented:\n  1     2       3       4       5       6       7       8       9       0\n  ```\n\n  **Digits will not be slanted, enlarged, or reduced.** See the samples for details.\n\n- Except for the rectangular areas that form digits, all other positions are filled with `.`. It is guaranteed that every connected component of `#` can form a digit and that all the rules above are satisfied.\n\nSince Tweetuzki is too weak, they ask you for help. Can you, the smart one, help Tweetuzki solve this problem?", "inputFormat": "The first line contains two positive integers $r, c$ $(5 \\le r \\le 10, 3 \\le c \\le 10^5)$, representing the number of rows and columns of the matrix.  \nNext come $r$ lines. Each line contains $c$ characters separated by spaces, and they are guaranteed to be only `.` and `#`. The input matrix is guaranteed to be valid and must contain hidden digits.", "outputFormat": "Output exactly one line containing a string consisting only of digits, outputting the hidden digits in this matrix **in order**.", "hint": "### Sample Explanation\n\nIt is recommended to copy it into Notepad (or various IDEs) and view it with a monospaced font.\n\n### Subtasks\n\n**_Subtask_ #1 _(30 points)_**: The matrix contains only digit $1$.  \n**_Subtask_ #2 _(30 points)_**: The matrix contains no digit $1$ or $4$.  \n**_Subtask_ #3 _(40 points)_**: No special properties.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Tweetuzki 爱伊图", "background": "Tweetuzki 的教练最近常常在群里发有关「伊图科技」的文章。「伊图科技」是一家专注于计算机视觉技术的上海创业公司，其人脸识别技术在世界处于领先地位。2018 年 6 月，在全球工业界黄金标准 FRVT 测试中，依图在千万分之一误报下识别准确率接近 $99\\%$，是全球工业界在此项指标下的最好水平，这是依图科技连续第二年摘得此项竞赛的冠军，也是首个夺得此项竞赛冠军的中国团队。2018 年 11 月 16 日，美国国家标准与技术研究院（NIST）公布了全球权威人脸识别比赛（FRVT）最新报告，依图算法继续保持第一，在千万分之一误报下的识别准确率超过 $99\\%$，是目前全球人脸识别技术的最好水平。\n\n更重要的是，伊图科技的创始人，是附中的毕业生——Tweetuzki 的学长呢！人脸识别真的好难呢！Tweetuzki 常常幻想，要是自己的程序能有学长们的亿万分之一厉害，那就很好了呢！", "description": "Tweetuzki 希望设计出一个程序，这个程序应当能识别输入矩阵中隐藏的数字。\n\n输入的是一个 $r \\times c$ 的字符矩阵，矩阵中的元素只有 `. `或 `#`。其中 `#` 可以构成一些数字。输入的矩阵将严格遵守以下规则：\n\n- 除 $1$ 占 $5 \\times 1$ 的长方形区域外，其余数字均占 $5 \\times 3$ 的长方形区域。\n\n- 相邻两个数字间至少有一列 `.`，即**数字不会贴在一块儿**；且数字**只会左右排放**，不会上下排放。这两点综合起来可以表述为：对于两个数字 $A$ 和 $B$（$A$ 在 $B$ 的左侧），若它们在横向上延伸的区间分别为 $[l_A, r_A]$ 和 $[l_B, r_B]$，那么一定满足 $l_B \\ge r_A + 2$。\n\n- 数字的组成严格按照如下所列：\n\n  ```plain\n  数字的组成方式：\n  #   # # #   # # #   # . #   # # #   # # #   # # #   # # #   # # #   # # # \n  #   . . #   . . #   # . #   # . .   # . .   . . #   # . #   # . #   # . # \n  #   # # #   # # #   # # #   # # #   # # #   . . #   # # #   # # #   # . # \n  #   # . .   . . #   . . #   . . #   # . #   . . #   # . #   . . #   # . # \n  #   # # #   # # #   . . #   # # #   # # #   . . #   # # #   # # #   # # # \n  \n  所代表的数字：\n  1     2       3       4       5       6       7       8       9       0\n  ```\n\n  **数字不会倾斜、放大或缩小。**具体可见样例。\n\n- 除构成数字的长方形区域外，其余位置皆由 `.` 填充。保证所有的 `#` 的连通块一定都能够组成数字，且一定满足上述规则。\n\n由于 Tweetuzki 太弱了，于是向你求助，聪明的你，能不能帮助 Tweetuzki 解决这个问题呢？", "inputFormat": "第一行两个正整数 $r, c$ $(5 \\le r \\le 10, 3 \\le c \\le 10^5)$，表示矩阵的行数和列数。  \n接下来 $r$ 行，每行输入 $c$ 个字符，用空格隔开，保证只含有 `.` 和 `#` 两种字符。输入矩阵保证合法且一定含有隐藏数字。", "outputFormat": "输出仅包含一行一个只含数字的字符串，**按照顺序**输出这个矩阵中隐藏的数字。", "hint": "### 样例解释\n\n建议复制进记事本（或各种 IDE）中用等宽字体查看。 \n\n###  子任务\n\n**_Subtask_ #1 _(30 points)_**：矩阵中仅有数字 $1$。  \n**_Subtask_ #2 _(30 points)_**：矩阵中不含有数字 $1$ 和 $4$。  \n**_Subtask_ #3 _(40 points)_**：无特殊性质。", "locale": "zh-CN"}}}
{"pid": "P5080", "type": "P", "difficulty": 5, "samples": [["6\n4 8 6 3 12 9\n", "6\n9 3 6 12 4 8 \n"], ["4\n42 28 84 126\n", "4\n126 42 84 28 \n"], ["5\n4 8 16 12 24", "4\n12 24 8 16"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["Special Judge"], "title": "Tweetuzki 爱序列", "background": "本题为改编题", "description": "Tweetuzki 有一个长度为 $n$ 的序列 $a_1, a_2, \\cdots, a_n$。\n\n他希望找出一个最大的 $k$，满足在原序列中存在一些数 $b_1, b_2, \\cdots, b_k$（可打散在原序列中的顺序），满足对于任意的 $i(1 \\le i < k)$，$b_i \\div 3 = b_{i+1}$（这时 $b_i$ 必须能够被 $3$ 整除）或 $b_i \\times 2 = b_{i+1}$。并输出这个序列。", "inputFormat": "第一行一个正整数 $n(2 \\le n \\le 10^5)$，表示序列的长度。  \n第二行包含 $n$ 个正整数，$a_1, a_2, \\cdots, a_n(1 \\le a_i \\le 3 \\times 10^{18})$，描述这个数列。", "outputFormat": "第一行一个正整数 $k$，表示最大的 $k$。  \n第二行 $k$ 个正整数 $b_1, b_2, \\cdots, b_n$，描述你选择的数。", "hint": "**_Subtask_ #1 _(20 points)_：$2 \\le n \\le 8$；**  \n**_Subtask_ #2 _(30 points)_：$2 \\le n \\le 100, 1 \\le a_i \\le 7 \\times 10^8$；**  \n**_Subtask_ #3 _(20 points)_：$2 \\le n \\le 1000, 1 \\le a_i \\le 1000$；**  \n**_Subtask_ #4 _(30 points)_：$2 \\le n \\le 10^5, 1 \\le a_i \\le 3 \\times 10^{18}$。**", "locale": "zh-CN", "translations": {"en": {"title": "Tweetuzki Loves Sequences", "background": "This problem is an adapted problem.", "description": "Tweetuzki has a sequence $a_1, a_2, \\cdots, a_n$ of length $n$.\n\nHe wants to find the maximum $k$ such that there exist some numbers $b_1, b_2, \\cdots, b_k$ in the original sequence (not necessarily in the same order as in the original sequence), satisfying that for any $i(1 \\le i < k)$, either $b_i \\div 3 = b_{i+1}$ (in this case, $b_i$ must be divisible by $3$) or $b_i \\times 2 = b_{i+1}$. Output this sequence as well.", "inputFormat": "The first line contains a positive integer $n(2 \\le n \\le 10^5)$, representing the length of the sequence.  \nThe second line contains $n$ positive integers $a_1, a_2, \\cdots, a_n(1 \\le a_i \\le 3 \\times 10^{18})$, describing the sequence.", "outputFormat": "The first line contains a positive integer $k$, representing the maximum $k$.  \nThe second line contains $k$ positive integers $b_1, b_2, \\cdots, b_k$, describing the numbers you chose.", "hint": "**_Subtask_ #1 _(20 points)_：$2 \\le n \\le 8$；**  \n**_Subtask_ #2 _(30 points)_：$2 \\le n \\le 100, 1 \\le a_i \\le 7 \\times 10^8$；**  \n**_Subtask_ #3 _(20 points)_：$2 \\le n \\le 1000, 1 \\le a_i \\le 1000$；**  \n**_Subtask_ #4 _(30 points)_：$2 \\le n \\le 10^5, 1 \\le a_i \\le 3 \\times 10^{18}$。**\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Tweetuzki 爱序列", "background": "本题为改编题", "description": "Tweetuzki 有一个长度为 $n$ 的序列 $a_1, a_2, \\cdots, a_n$。\n\n他希望找出一个最大的 $k$，满足在原序列中存在一些数 $b_1, b_2, \\cdots, b_k$（可打散在原序列中的顺序），满足对于任意的 $i(1 \\le i < k)$，$b_i \\div 3 = b_{i+1}$（这时 $b_i$ 必须能够被 $3$ 整除）或 $b_i \\times 2 = b_{i+1}$。并输出这个序列。", "inputFormat": "第一行一个正整数 $n(2 \\le n \\le 10^5)$，表示序列的长度。  \n第二行包含 $n$ 个正整数，$a_1, a_2, \\cdots, a_n(1 \\le a_i \\le 3 \\times 10^{18})$，描述这个数列。", "outputFormat": "第一行一个正整数 $k$，表示最大的 $k$。  \n第二行 $k$ 个正整数 $b_1, b_2, \\cdots, b_n$，描述你选择的数。", "hint": "**_Subtask_ #1 _(20 points)_：$2 \\le n \\le 8$；**  \n**_Subtask_ #2 _(30 points)_：$2 \\le n \\le 100, 1 \\le a_i \\le 7 \\times 10^8$；**  \n**_Subtask_ #3 _(20 points)_：$2 \\le n \\le 1000, 1 \\le a_i \\le 1000$；**  \n**_Subtask_ #4 _(30 points)_：$2 \\le n \\le 10^5, 1 \\le a_i \\le 3 \\times 10^{18}$。**", "locale": "zh-CN"}}}
{"pid": "P5081", "type": "P", "difficulty": 5, "samples": [["1", "1"], ["2", "3"], ["3", "10020162"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000, 256000]}, "tags": [], "title": "Tweetuzki 爱取球", "background": "本题为被指出的改编题……~~害怕被爆破~~", "description": "Tweetuzki 有一个袋子，袋子中有 $N$ 个无差别的球。Tweetuzki 每次随机取出一个球后放回。求取遍所有球的期望次数。\n\n取遍是指，袋子中所有球都被取出来过至少一次。", "inputFormat": "一行一个整数 $N$ $(1 \\le N \\le 10^7)$。", "outputFormat": "一行一个整数，表示期望次数。由于这个数可能很大，输出对 $20040313$ （是个质数）取模。", "hint": "### 样例解释 1\n\n第一次取出一个球即可取遍所有球。\n\n### 样例解释 2\n\n两次就取遍所有球的概率为 $\\frac{1}{2}$，三次取遍所有球的概率为 $\\frac{1}{4}$，四次取遍所有球的概率为 $\\frac{1}{8}$，……，$k$ 次取遍所有球的概率为 $\\frac{1}{2^{k-1}}$。故：\n\n$$E(2) = \\frac{2}{2} + \\frac{3}{4} + \\frac{4}{8} + \\frac{5}{16} + \\cdots = 3$$\n\n### 样例解释 3\n\n通过试验及计算可得：\n\n$$E(3) = \\frac{11}{2}$$\n\n对 $20040313$ 取模后答案为 $10020162$。\n\n## 数据范围及约定\n\n对于 $30\\%$ 的数据，$N \\le 5$。  \n对于 $70\\%$ 的数据，$N \\le 10^5$。  \n对于 $100\\%$ 的数据，$1 \\le N \\le 10^7$。", "locale": "zh-CN", "translations": {"en": {"title": "Tweetuzki Loves Drawing Balls", "background": "This problem is an adaptation that got called out… ~~afraid of getting blasted~~.", "description": "Tweetuzki has a bag with $N$ indistinguishable balls. Each time, Tweetuzki randomly draws one ball and then puts it back. Find the expected number of draws needed to have drawn every ball at least once.\n\n“Having drawn all balls” means that every ball in the bag has been drawn at least once.", "inputFormat": "One line with one integer $N$ $(1 \\le N \\le 10^7)$.", "outputFormat": "Output one integer on one line, representing the expected number of draws. Since this number may be very large, output it modulo $20040313$ (a prime).", "hint": "### Sample Explanation 1\n\nDrawing one ball the first time is enough to have drawn all balls.\n\n### Sample Explanation 2\n\nThe probability of having drawn all balls in two draws is $\\frac{1}{2}$, in three draws is $\\frac{1}{4}$, in four draws is $\\frac{1}{8}$, …, and in $k$ draws is $\\frac{1}{2^{k-1}}$. Therefore:\n\n$$E(2) = \\frac{2}{2} + \\frac{3}{4} + \\frac{4}{8} + \\frac{5}{16} + \\cdots = 3$$\n\n### Sample Explanation 3\n\nBy experiments and calculation, we get:\n\n$$E(3) = \\frac{11}{2}$$\n\nAfter taking modulo $20040313$, the answer is $10020162$.\n\n## Constraints\n\nFor $30\\%$ of the testdata, $N \\le 5$.  \nFor $70\\%$ of the testdata, $N \\le 10^5$.  \nFor $100\\%$ of the testdata, $1 \\le N \\le 10^7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "Tweetuzki 爱取球", "background": "本题为被指出的改编题……~~害怕被爆破~~", "description": "Tweetuzki 有一个袋子，袋子中有 $N$ 个无差别的球。Tweetuzki 每次随机取出一个球后放回。求取遍所有球的期望次数。\n\n取遍是指，袋子中所有球都被取出来过至少一次。", "inputFormat": "一行一个整数 $N$ $(1 \\le N \\le 10^7)$。", "outputFormat": "一行一个整数，表示期望次数。由于这个数可能很大，输出对 $20040313$ （是个质数）取模。", "hint": "### 样例解释 1\n\n第一次取出一个球即可取遍所有球。\n\n### 样例解释 2\n\n两次就取遍所有球的概率为 $\\frac{1}{2}$，三次取遍所有球的概率为 $\\frac{1}{4}$，四次取遍所有球的概率为 $\\frac{1}{8}$，……，$k$ 次取遍所有球的概率为 $\\frac{1}{2^{k-1}}$。故：\n\n$$E(2) = \\frac{2}{2} + \\frac{3}{4} + \\frac{4}{8} + \\frac{5}{16} + \\cdots = 3$$\n\n### 样例解释 3\n\n通过试验及计算可得：\n\n$$E(3) = \\frac{11}{2}$$\n\n对 $20040313$ 取模后答案为 $10020162$。\n\n## 数据范围及约定\n\n对于 $30\\%$ 的数据，$N \\le 5$。  \n对于 $70\\%$ 的数据，$N \\le 10^5$。  \n对于 $100\\%$ 的数据，$1 \\le N \\le 10^7$。", "locale": "zh-CN"}}}
{"pid": "P5082", "type": "P", "difficulty": 1, "samples": [["3\n10 10 10\n5 5 5", "4.000000"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": ["模拟", "2018"], "title": "成绩", "background": "小奔的score\n\n题解：https://blog.csdn.net/kkkksc03/article/details/84928268\n\n说一句：本题已放开空间范围（不过真的貌似不用开数组就可以A呀", "description": "小奔的期末考试结束了。\n\n他的成绩不久之后就会发下来。\n\n给出一个考试成绩表格，例如：\n\n| 科目/分值种类 | 语文 | 数学|英语  |\n| :----------: | :----------: | :----------: | :----------: |\n|  满分| $100$ |$120$  |$150$  |\n| 实际得分 |  $99$|$73$  |$100$  |\n\n当然。学校的老师认为如果录入如此多的成绩不好算分，于是他想要你的综合成绩评定\n\n综合成绩评定指：(每一科的满分之和\\*3-每一科的实际得分之和\\*2)÷每科所扣除分数的和。\n\n小奔想请你给出他的综合成绩，你能做到吗？", "inputFormat": "第一行给出一个整数$n$，表示科目的总数。\n第二行$n$个整数$a_i$,表示第$i$门课程的满分。\n第三行$n$个整数$b_i$,表示第$i$门课程小奔的实际得分。", "outputFormat": "一行一个数，表示他的综合成绩。结果保留$6$位小数", "hint": "对于$20$%的数据，数据为样例\n\n对于$100$%的数据，$n<=1e7$", "locale": "zh-CN", "translations": {"en": {"title": "Grades", "background": "Xiao Ben’s score.\n\nSolution: https://blog.csdn.net/kkkksc03/article/details/84928268\n\nOne note: the memory limit for this problem has been relaxed (but it seems you can get AC without even using arrays).", "description": "Xiao Ben’s final exams have ended.\n\nHis grades will be released soon.\n\nYou are given an exam score table, for example:\n\n| Subject / Score Type | Chinese | Math | English |\n| :------------------: | :-----: | :--: | :-----: |\n| Full score | $100$ | $120$ | $150$ |\n| Actual score | $99$ | $73$ | $100$ |\n\nOf course, the teachers at school think that entering so many grades makes it hard to calculate, so they want you to compute a comprehensive grade evaluation.\n\nThe comprehensive grade evaluation is defined as: $(\\text{sum of full scores} \\times 3 - \\text{sum of actual scores} \\times 2) \\div \\text{sum of points deducted for each subject}$.\n\nXiao Ben wants you to output his comprehensive grade. Can you do it?", "inputFormat": "The first line contains an integer $n$, the total number of subjects.  \nThe second line contains $n$ integers $a_i$, where $a_i$ is the full score of the $i$-th subject.  \nThe third line contains $n$ integers $b_i$, where $b_i$ is Xiao Ben’s actual score in the $i$-th subject.", "outputFormat": "Output one number in a single line, representing his comprehensive grade. Keep $6$ digits after the decimal point.", "hint": "For $20$% of the testdata, the data is the sample.\n\nFor $100$% of the testdata, $n \\le 1e7$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "成绩", "background": "小奔的score\n\n题解：https://blog.csdn.net/kkkksc03/article/details/84928268\n\n说一句：本题已放开空间范围（不过真的貌似不用开数组就可以A呀", "description": "小奔的期末考试结束了。\n\n他的成绩不久之后就会发下来。\n\n给出一个考试成绩表格，例如：\n\n| 科目/分值种类 | 语文 | 数学|英语  |\n| :----------: | :----------: | :----------: | :----------: |\n|  满分| $100$ |$120$  |$150$  |\n| 实际得分 |  $99$|$73$  |$100$  |\n\n当然。学校的老师认为如果录入如此多的成绩不好算分，于是他想要你的综合成绩评定\n\n综合成绩评定指：(每一科的满分之和\\*3-每一科的实际得分之和\\*2)÷每科所扣除分数的和。\n\n小奔想请你给出他的综合成绩，你能做到吗？", "inputFormat": "第一行给出一个整数$n$，表示科目的总数。\n第二行$n$个整数$a_i$,表示第$i$门课程的满分。\n第三行$n$个整数$b_i$,表示第$i$门课程小奔的实际得分。", "outputFormat": "一行一个数，表示他的综合成绩。结果保留$6$位小数", "hint": "对于$20$%的数据，数据为样例\n\n对于$100$%的数据，$n<=1e7$", "locale": "zh-CN"}}}
{"pid": "P5083", "type": "P", "difficulty": 6, "samples": [["5 6\n1 1\n1 223", "11\n2\n224"]], "limits": {"time": [2000, 200, 2000, 2000, 2000, 2000, 2000, 2000, 200, 200], "memory": [512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000, 512000]}, "tags": [], "title": "函数", "background": "", "description": "小奔有一个二元函数 $f(a,b)$。\n\n如果 $a<2$ 或 $b<2$ 返回 $a+b$。\n\n其他情况则返回以下四个式子的最大值（除号均为整除）：\n\n$$a+b$$\n\n$$g(a/2)+g(a/3)+g(a/8)+g(a/9)+b$$\n\n$$g(b/2)+g(b/3)+g(b/8)+g(b/9)+a$$\n\n$$g(b/2)+g(b/3)+g(b/8)+g(b/9)+g(a/2)+g(a/3)+g(a/8)+g(a/9)$$\n\n其中，$g(n)$ 返回 $\\max(g(n/2)+g(n/3)+g(n/8)+g(n/9),n)$，当 $n=0$ 时返回 $0$。\n\n当然，白痴都想得到可以记忆化求出较小的 $f(a,b)$，所以小奔才不会考你那么简单的题呢。\n\n他想问你当 $a,b$ 都小于 $10^{16}$ 时，$f(a,b)$ 的值。\n", "inputFormat": "包含多组数据。\n\n每组数据，包含一行，两个正整数 $a,b$。", "outputFormat": "每组数据输出一行，即 $f(a,b)$ 的值。\n", "hint": "对于 $40\\%$ 的数据，$a,b<10^7$。\n\n对于 $70\\%$ 的数据，时间限制 $2$ 秒。\n\n对于 $100\\%$ 的数据，$a,b<10^{16}$。数据组数不超过 $10^4$ 组。", "locale": "zh-CN", "translations": {"en": {"title": "Function", "background": "", "description": "Xiaoben has a binary function $f(a,b)$.\n\nIf $a<2$ or $b<2$, it returns $a+b$.\n\nOtherwise, it returns the maximum of the following four expressions (all divisions are integer divisions):\n\n$$a+b$$\n\n$$g(a/2)+g(a/3)+g(a/8)+g(a/9)+b$$\n\n$$g(b/2)+g(b/3)+g(b/8)+g(b/9)+a$$\n\n$$g(b/2)+g(b/3)+g(b/8)+g(b/9)+g(a/2)+g(a/3)+g(a/8)+g(a/9)$$\n\nHere, $g(n)$ returns $\\max(g(n/2)+g(n/3)+g(n/8)+g(n/9),n)$, and it returns $0$ when $n=0$.\n\nOf course, even an idiot can figure out that you can use memoization to compute smaller values of $f(a,b)$, so Xiaoben will not test you with such an easy problem.\n\nHe wants you to find the value of $f(a,b)$ when both $a$ and $b$ are less than $10^{16}$.", "inputFormat": "The input contains multiple test cases.\n\nEach test case consists of one line with two positive integers $a,b$.", "outputFormat": "For each test case, output one line containing the value of $f(a,b)$.", "hint": "For $40\\%$ of the testdata, $a,b<10^7$.\n\nFor $70\\%$ of the testdata, the time limit is $2$ seconds.\n\nFor $100\\%$ of the testdata, $a,b<10^{16}$. The number of test cases does not exceed $10^4$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "函数", "background": "", "description": "小奔有一个二元函数 $f(a,b)$。\n\n如果 $a<2$ 或 $b<2$ 返回 $a+b$。\n\n其他情况则返回以下四个式子的最大值（除号均为整除）：\n\n$$a+b$$\n\n$$g(a/2)+g(a/3)+g(a/8)+g(a/9)+b$$\n\n$$g(b/2)+g(b/3)+g(b/8)+g(b/9)+a$$\n\n$$g(b/2)+g(b/3)+g(b/8)+g(b/9)+g(a/2)+g(a/3)+g(a/8)+g(a/9)$$\n\n其中，$g(n)$ 返回 $\\max(g(n/2)+g(n/3)+g(n/8)+g(n/9),n)$，当 $n=0$ 时返回 $0$。\n\n当然，白痴都想得到可以记忆化求出较小的 $f(a,b)$，所以小奔才不会考你那么简单的题呢。\n\n他想问你当 $a,b$ 都小于 $10^{16}$ 时，$f(a,b)$ 的值。\n", "inputFormat": "包含多组数据。\n\n每组数据，包含一行，两个正整数 $a,b$。", "outputFormat": "每组数据输出一行，即 $f(a,b)$ 的值。\n", "hint": "对于 $40\\%$ 的数据，$a,b<10^7$。\n\n对于 $70\\%$ 的数据，时间限制 $2$ 秒。\n\n对于 $100\\%$ 的数据，$a,b<10^{16}$。数据组数不超过 $10^4$ 组。", "locale": "zh-CN"}}}
{"pid": "P5084", "type": "P", "difficulty": 6, "samples": [["2 2\n9 18", "45"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000, 128000]}, "tags": ["数学", "递推"], "title": "轮换式", "background": null, "description": "小奔发现，对于任意的 $n$ 个字母，他们构成的轮换式，都表示成 $n$ 个基本 \n$1\\sim n$ 次基本轮换式的线性和。\n\n一元的基本轮换式：$a$；\n\n二元：$a+b,ab$；\n\n三元：$a+b+c,ab+ac+bc,abc$；\n\n四元：$a+b+c+d,ab+ac+bc+ad+bd+cd,abc+abd+acd+bcd,abcd$；\n\n………………\n\n同样的，对于任意的 $n$ 个字母，给出他们的几个基本轮换式，都可以求出这几个字母的值。\n\n但是小奔突然大发慈悲，他只需要你求出这些字母的 $m$ 次方和模 $10^7+29$ 的值。", "inputFormat": "第一行是字母个数 $n$，次数 $m$。\n\n接下来一行 $n$ 个正整数，第 $i$ 个为 $a_i$ $(0<a_i\\le 10000)$，从左到右分别是 $1\\sim n$ 次 $n$ 元基本轮换式的值。", "outputFormat": "一个数，要求的答案。", "hint": "本题共有 $3$ 个子任务。\n\nSubtask 1（12 pts）：$n\\le 2$；\n\nSubtask 2（28 pts）：$n=3$；\n\nSubtask 3（60 pts）：$n=4$。\n\n对于所有数据，$0\\le m\\le 100000$。", "locale": "zh-CN", "translations": {"en": {"title": "Rotational Form", "background": "", "description": "Xiao Ben found that, for any $n$ letters, the “rotational form” they form can always be expressed as a linear combination of the $n$ basic rotational forms of degrees $1 \\sim n$.\n\nUnary basic rotational form: $a$.\n\nBinary: $a+b,ab$.\n\nTernary: $a+b+c,ab+ac+bc,abc$.\n\nQuaternary: $a+b+c+d,ab+ac+bc+ad+bd+cd,abc+abd+acd+bcd,abcd$.\n\nAnd so on.\n\nSimilarly, for any $n$ letters, if you are given several of their basic rotational forms, you can determine the values of these letters.\n\nHowever, Xiao Ben suddenly showed mercy: he only asks you to compute the sum of the $m$-th powers of these letters modulo $10^7+29$.", "inputFormat": "The first line contains the number of letters $n$ and the exponent $m$.\n\nThe next line contains $n$ positive integers. The $i$-th number is $a_i$ $(0<a_i\\le 10000)$, which from left to right are the values of the $n$-variable basic rotational forms of degrees $1 \\sim n$.", "outputFormat": "Output one number, the required answer.", "hint": "This problem has $3$ subtasks.\n\nSubtask 1 (12 pts): $n\\le 2$.\n\nSubtask 2 (28 pts): $n=3$.\n\nSubtask 3 (60 pts): $n=4$.\n\nFor all data, $0\\le m\\le 100000$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "轮换式", "background": null, "description": "小奔发现，对于任意的 $n$ 个字母，他们构成的轮换式，都表示成 $n$ 个基本 \n$1\\sim n$ 次基本轮换式的线性和。\n\n一元的基本轮换式：$a$；\n\n二元：$a+b,ab$；\n\n三元：$a+b+c,ab+ac+bc,abc$；\n\n四元：$a+b+c+d,ab+ac+bc+ad+bd+cd,abc+abd+acd+bcd,abcd$；\n\n………………\n\n同样的，对于任意的 $n$ 个字母，给出他们的几个基本轮换式，都可以求出这几个字母的值。\n\n但是小奔突然大发慈悲，他只需要你求出这些字母的 $m$ 次方和模 $10^7+29$ 的值。", "inputFormat": "第一行是字母个数 $n$，次数 $m$。\n\n接下来一行 $n$ 个正整数，第 $i$ 个为 $a_i$ $(0<a_i\\le 10000)$，从左到右分别是 $1\\sim n$ 次 $n$ 元基本轮换式的值。", "outputFormat": "一个数，要求的答案。", "hint": "本题共有 $3$ 个子任务。\n\nSubtask 1（12 pts）：$n\\le 2$；\n\nSubtask 2（28 pts）：$n=3$；\n\nSubtask 3（60 pts）：$n=4$。\n\n对于所有数据，$0\\le m\\le 100000$。", "locale": "zh-CN"}}}
{"pid": "P5085", "type": "P", "difficulty": 7, "samples": [["5 7 50 2 1\n1 2\n3 2", "5 1 1 0 0"]], "limits": {"time": [1000, 1000, 1000, 1000, 1000], "memory": [128000, 128000, 128000, 128000, 128000]}, "tags": [], "title": "大奔的方案", "background": "题解：https://blog.csdn.net/kkkksc03/article/details/83188325\n\n五个海盗抢到了 $100$ 个金币，每一颗都一样的大小和价值连城。\n\n他们决定这么分： \n\n1. 抽签决定自己的号 $[1, 2, 3, 4, 5]$；\n2. 首先，由 $1$ 号提出分配方案，然后大家 $5$ 人进行表决，当且仅当不少于半数的人同意时，按照他的提案进行分配，否则将被扔入大海喂鲨鱼。\n3. 如果 $1$ 号死后，再由 $2$ 号提出分配方案，然后大家 $4$ 人进行表决，当且仅当不少于半数的人同意时，按照他的提案进行分配，否则将被扔入大海喂鲨鱼。 \n4. 以此类推……\n\n每个海盗都是很聪明的人，他们遵循如下原则：\n\n1. 保命；\n2. 如果满足条件 $1$，那么想办法获得更多的钱；\n3. 如果满足条件 $1, 2$，那么想办法杀更多的人。\n\n那么最终的分配方案会是怎样的呢？\n\n海盗们让小奔求出：若是 $N$ 个海盗抢到了 $M$ 个金币，并且要不少于 $P\\%$ 的人投赞成票，他们会如何分配呢？\n\n请你给出 $N$ 个海盗分 $M$ 个金币且要不少于 $P\\%$ 的人投赞成票的解法，并保证结果号码较小的分到的金币尽可能的多。\n\n**但是**，现实中并不会那么过于残忍，每个海盗也拥有自己的帮派，同一个帮派的人会互相投赞成票。\n\n作为友情的代价，那个人必须分自己帮派里的每个人一定的金币，如果有一个人（不包括自己）没有被满足，那么整个帮派的人会同时投反对票。\n\n新的结果又会是如何呢？", "description": "如果 A 和 B 是朋友，B 和 C 也是朋友，那么说 A、B、C 都是同一个帮派里的。\n\n现给出 $x$ 个兄弟关系，请你弄清其中的帮派关系，再求出 $n$ 个海盗分 $m$ 个金币的最新方法。\n\n毒瘤预警：\n\n**当然，你仍然需要保证结果号码较小的分到的金币尽可能的多，哪怕破坏帮派之间的关系。（自行理解）**", "inputFormat": "第一行，五个数 $n, m, p, x, k$ 之间用空格隔开，分别表示强盗数目，金币数目，最低赞成百分比，兄弟关系总数以及所谓的友情所需要的代价。\n\n接下来 $X$ 行，每行两个数，$i, j$，表示 $i$ 和 $j$ 是兄弟关系（或是说在同一个帮派）。", "outputFormat": "只有一行，$N$ 个数之间用空格隔开，表示最后的结果。\n\n如果某个海盗死了，输出 $-1$ 代替。", "hint": "### 数据范围及约定\n\n对于100%的数据：$1\\le n\\le 1000$，$0\\le m\\le 10^5$，$1\\le p\\le 100$，$1\\le x\\le 500$，$1\\le k\\le 100$。", "locale": "zh-CN", "translations": {"en": {"title": "Big Ben’s Plan.", "background": "Solution: https://blog.csdn.net/kkkksc03/article/details/83188325.\n\nFive pirates have seized $100$ gold coins, each of the same size and extremely valuable.\n\nThey decide to distribute them as follows:\n\n1. Draw lots to decide their numbers $[1, 2, 3, 4, 5]$.\n2. First, pirate $1$ proposes a distribution plan. Then all $5$ pirates vote. If and only if no fewer than half of them agree, the distribution is carried out according to his proposal; otherwise, he will be thrown into the sea to feed the sharks.\n3. If pirate $1$ dies, then pirate $2$ proposes a distribution plan. Then all $4$ remaining pirates vote. If and only if no fewer than half of them agree, the distribution is carried out according to his proposal; otherwise, he will be thrown into the sea to feed the sharks.\n4. And so on...\n\nEach pirate is very smart and follows these rules:\n\n1. Stay alive.\n2. If rule $1$ is satisfied, try to get as many coins as possible.\n3. If rules $1, 2$ are satisfied, try to kill as many people as possible.\n\nSo what will the final distribution plan be?\n\nThe pirates ask Xiao Ben to compute: if there are $N$ pirates who seized $M$ gold coins, and at least $P\\%$ of the voters must vote in favor, how will they distribute the coins?\n\nPlease give a method for $N$ pirates to split $M$ coins with at least $P\\%$ votes in favor, and ensure that pirates with smaller numbers receive as many coins as possible.\n\n**However**, in reality it will not be so cruel. Each pirate also has their own gang, and people in the same gang will vote in favor of each other.\n\nAs the price of friendship, the proposer must give every other person in their gang a certain number of coins. If any one person (excluding the proposer themself) is not satisfied, then everyone in that gang will vote against at the same time.\n\nWhat will the new result be?", "description": "If A and B are friends, and B and C are also friends, then A, B, and C are all in the same gang.\n\nNow you are given $x$ brotherhood relations. Please determine the gang relationships, and then find the new method for $n$ pirates to split $m$ coins.\n\nWarning: toxic problem.\n\n**Of course, you still need to ensure that pirates with smaller numbers receive as many coins as possible, even if it breaks relationships between gangs. (Figure it out yourself.)**", "inputFormat": "The first line contains five integers $n, m, p, x, k$ separated by spaces, representing the number of pirates, the number of coins, the minimum approval percentage, the total number of brotherhood relations, and the so-called friendship cost.\n\nThe next $X$ lines each contain two integers $i, j$, meaning $i$ and $j$ have a brotherhood relation (that is, they are in the same gang).", "outputFormat": "Only one line containing $N$ integers separated by spaces, representing the final result.\n\nIf a pirate dies, output $-1$ instead.", "hint": "### Constraints and Notes\n\nFor $100\\%$ of the testdata: $1\\le n\\le 1000$, $0\\le m\\le 10^5$, $1\\le p\\le 100$, $1\\le x\\le 500$, $1\\le k\\le 100$.\n\nTranslated by ChatGPT 5", "locale": "en"}, "zh-CN": {"title": "大奔的方案", "background": "题解：https://blog.csdn.net/kkkksc03/article/details/83188325\n\n五个海盗抢到了 $100$ 个金币，每一颗都一样的大小和价值连城。\n\n他们决定这么分： \n\n1. 抽签决定自己的号 $[1, 2, 3, 4, 5]$；\n2. 首先，由 $1$ 号提出分配方案，然后大家 $5$ 人进行表决，当且仅当不少于半数的人同意时，按照他的提案进行分配，否则将被扔入大海喂鲨鱼。\n3. 如果 $1$ 号死后，再由 $2$ 号提出分配方案，然后大家 $4$ 人进行表决，当且仅当不少于半数的人同意时，按照他的提案进行分配，否则将被扔入大海喂鲨鱼。 \n4. 以此类推……\n\n每个海盗都是很聪明的人，他们遵循如下原则：\n\n1. 保命；\n2. 如果满足条件 $1$，那么想办法获得更多的钱；\n3. 如果满足条件 $1, 2$，那么想办法杀更多的人。\n\n那么最终的分配方案会是怎样的呢？\n\n海盗们让小奔求出：若是 $N$ 个海盗抢到了 $M$ 个金币，并且要不少于 $P\\%$ 的人投赞成票，他们会如何分配呢？\n\n请你给出 $N$ 个海盗分 $M$ 个金币且要不少于 $P\\%$ 的人投赞成票的解法，并保证结果号码较小的分到的金币尽可能的多。\n\n**但是**，现实中并不会那么过于残忍，每个海盗也拥有自己的帮派，同一个帮派的人会互相投赞成票。\n\n作为友情的代价，那个人必须分自己帮派里的每个人一定的金币，如果有一个人（不包括自己）没有被满足，那么整个帮派的人会同时投反对票。\n\n新的结果又会是如何呢？", "description": "如果 A 和 B 是朋友，B 和 C 也是朋友，那么说 A、B、C 都是同一个帮派里的。\n\n现给出 $x$ 个兄弟关系，请你弄清其中的帮派关系，再求出 $n$ 个海盗分 $m$ 个金币的最新方法。\n\n毒瘤预警：\n\n**当然，你仍然需要保证结果号码较小的分到的金币尽可能的多，哪怕破坏帮派之间的关系。（自行理解）**", "inputFormat": "第一行，五个数 $n, m, p, x, k$ 之间用空格隔开，分别表示强盗数目，金币数目，最低赞成百分比，兄弟关系总数以及所谓的友情所需要的代价。\n\n接下来 $X$ 行，每行两个数，$i, j$，表示 $i$ 和 $j$ 是兄弟关系（或是说在同一个帮派）。", "outputFormat": "只有一行，$N$ 个数之间用空格隔开，表示最后的结果。\n\n如果某个海盗死了，输出 $-1$ 代替。", "hint": "### 数据范围及约定\n\n对于100%的数据：$1\\le n\\le 1000$，$0\\le m\\le 10^5$，$1\\le p\\le 100$，$1\\le x\\le 500$，$1\\le k\\le 100$。", "locale": "zh-CN"}}}
